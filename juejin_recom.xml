<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[ä¸€æ®µJavaScriptä»£ç æ˜¯å¦‚ä½•è¿è¡Œçš„ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7603201727715917876</link>    <guid>https://juejin.cn/post/7603201727715917876</guid>    <pubDate>2026-02-06T02:04:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603201727715917876" data-draft-id="7602488966609928230" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ®µJavaScriptä»£ç æ˜¯å¦‚ä½•è¿è¡Œçš„ï¼Ÿ"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯,Node.js"/> <meta itemprop="datePublished" content="2026-02-06T02:04:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="libokaifa"/> <meta itemprop="url" content="https://juejin.cn/user/676954894018808"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ®µJavaScriptä»£ç æ˜¯å¦‚ä½•è¿è¡Œçš„ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/676954894018808/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    libokaifa
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T02:04:20.000Z" title="Fri Feb 06 2026 02:04:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body cache result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä¼—æ‰€å‘¨çŸ¥JavaScript æ˜¯è§£é‡Šå‹è¯­è¨€ï¼Œè§£é‡Šå‹è¯­è¨€éƒ½æœ‰ç¼–è¯‘å™¨ï¼Œé€šè¿‡è°·æ­Œæµè§ˆå™¨çš„ç¼–è¯‘å™¨æ˜¯V8å¼•æ“ ç”Ÿæˆå­—èŠ‚ç å¹¶è¢«è®¡ç®—æœºè®¤è¯†å¹¶æ‰§è¡Œã€‚</p>
</blockquote>
<blockquote>
<p>V8å¼•æ“ä¸»è¦è¿è¡Œä»£ç è¡Œä¸ºæ˜¯ï¼š æºä»£ç (.js æ–‡ä»¶)--&gt;è¯æ³•åˆ†æ(è§£æå™¨ï¼ˆparser)--&gt;AST(è¯­æ³•åˆ†æ)--&gt;å­—èŠ‚ç ï¼ˆIgnition ç”Ÿæˆï¼‰-ã€‹æ‰§è¡Œï¼ˆï¼‰</p>
</blockquote>
<h2 data-id="heading-0">è¯æ³•åˆ†æ</h2>
<pre><code class="hljs language-ini" lang="ini">// æˆ‘æ˜¯æ³¨é‡Š
var <span class="hljs-attr">answer</span> = <span class="hljs-number">6</span> * <span class="hljs-number">7</span><span class="hljs-comment">;</span>
</code></pre>
<p>åƒä¸Šé¢ä¸€æ®µä»£ç </p>
<p>ä¼šè¢«V8å¼•æ“å»é™¤æ— ç”¨çš„çš„æ³¨é‡Šç­‰é€šè¿‡è§£æå™¨ï¼ˆparserï¼‰åˆ†è§£ä¸ºæœ€å°çš„è¯æ³•å•å…ƒtoken(<a href="https://link.juejin.cn?target=https%3A%2F%2Fesprima.org%2Fdemo%2Fparse.html%23" target="_blank" title="https://esprima.org/demo/parse.html#" ref="nofollow noopener noreferrer">parser</a>)ï¼Œ
ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŒ¹é…å‡ºæœ€å°å•å…ƒçš„Tokenï¼Œè®©V8æ›´å¿«çš„æ‰«æå¹¶è¿›è¡Œè§£æ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d99c847362a546d29e6163c26ed08bb6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbGlib2thaWZh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770948262&amp;x-signature=BqrSgY69sJYiGvxVfT9y9AZMZ7U%3D" alt="image.png" loading="lazy"/>
è¿™æ®µä»£ç è¢«æ‹†è§£ä¸ºï¼štoken æ•°ç»„ï¼Œå¹¶æ ‡è¯†äº†typeç±»å‹å’Œvalue</p>
<h2 data-id="heading-1">è¯­æ³•åˆ†æAST</h2>
<p>ä¼—æ‰€å‘¨çŸ¥ æ˜¯é™æ€è¯­éŸ³ï¼Œç±»ä¼¼VsCode ç¼–è¾‘å™¨è™½ç„¶ä¹Ÿä¼šå¯¹ä»£ç ç¼–å†™æ—¶çš„è¯­æ³•çš„é™æ€æ£€æŸ¥ï¼Œä½†æ˜¯æ˜¯éå¸¸è½»é‡çº§ï¼Œå¹¶ä¸”ä¸æ¶‰åŠåˆ°ç¼–è¯‘çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥åœ¨è¯æ³•åˆ†æçš„ä¸‹ä¸€æ­¥è¿›è¡Œç¼–è¯‘é˜¶æ®µçš„è¯­æ³•åˆ†æASTä»¥ä¿è¯ä»£ç è¯­æ³•ç»“æ„çš„æ­£ç¡®æ€§ï¼ŒåŒæ—¶ä¸ºåç»­çš„è¯­ä¹‰åˆ†æç­‰æä¾›ç»“æ„æ€§çš„æ•°æ®ã€‚ä¸‹é¢æ˜¯ä¸€æ®µä»£ç AST ç»“æ„å›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ae24281cd8044026b7fea10ef979ac4d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbGlib2thaWZh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770948262&amp;x-signature=L8LsB4p75a07akfb1hbkv6m6Etc%3D" alt="image.png" loading="lazy"/>
ä¸Šå›¾æ˜¯æ ¹æ®ä¸Šä¸€æ­¥çš„è¯æ³•åˆ†æTokenæ•°ç»„ç”Ÿäº§çš„Jsonæ ‘çŠ¶ç»“æ„æ ‘ï¼Œå…¶ä¸»è¦åŒ…å«çš„ä¿¡æ¯æœ‰ï¼š<code>"VariableDeclaration"</code>ï¼ˆå˜é‡å£°æ˜ï¼‰<code>"BinaryExpression"</code>ï¼ˆè®¡ç®—çš„äºŒå…ƒè¡¨è¾¾å¼ï¼‰,<code>"name"</code>(æ ‡è¯†ç¬¦çš„åç§°),<code>"value"</code>(å­—é¢é‡çš„å€¼)ï¼Œ<code>"operato"</code>(è¡¨è¾¾å¼çš„æ“ä½œç¬¦)ç­‰ã€‚åœ¨è¿™ä¸€é˜¶æ®µå¦‚æœå‘ç”Ÿé”™è¯¯ä»£ç åŠ è½½ä¼šåœ¨è¿™æ­¥åœæ­¢å¹¶æŠ›å‡ºå¼‚å¸¸å¦‚ï¼š<code> è¾“å‡º: Unexpected token at line 1, column 5</code></p>
<h2 data-id="heading-2">ç”Ÿæˆå­—èŠ‚ç </h2>
<p>JS å­—èŠ‚ç  çš„ç”Ÿæˆæ˜¯ç”±V8ï¼ˆIgnition è§£é‡Šå™¨å®Œæˆï¼‰ï¼Œç†Ÿæ‚‰Java çš„éƒ½çŸ¥é“ï¼ŒJavaçš„å­—èŠ‚ç  ç»è¿‡AOTå­˜åœ¨.classæ–‡ä»¶ä¸­ï¼Œä½†JavaScript ä¸ºäº†å¿«é€Ÿæ‰§è¡ŒæŠŠå­—èŠ‚ç å­˜åœ¨äº†å†…å­˜ä¸­ï¼Œç„¶åç»è¿‡JIT ç”Ÿæˆæœºå™¨ç ã€‚åˆ°è¿™é‡Œæˆ‘ä»¬å‘ç°ä¸ºä»€ä¹ˆå¤§éƒ¨åˆ†è¯­è¨€éƒ½æ˜¯å…ˆæ˜¯ç”Ÿæˆå­—èŠ‚ç å†ç”Ÿæˆæœºå™¨ç å‘¢ã€‚å…¶å®æ—©æœŸV8 å¼•æ“ä¹Ÿæ˜¯ç›´æ¥ç”Ÿæˆæœºå™¨ç ï¼Œç”¨ç©ºé—´æ¢æ—¶é—´ï¼Œæ‰§è¡Œæ•ˆç‡é«˜ï¼Œä½†åŒæ—¶ä¹Ÿå¸¦æ¥å¦ä¸€ä¸ªé—®é¢˜ï¼Œå½“å†…å­˜ä¸è¶³æ—¶ï¼Œå°±ä¼šé€ æˆå¤±è´¥å’Œå¡é¡¿ã€‚æœ‰äº†å­—èŠ‚ç ä»¥ååšäº†ä¸­é—´æµç¨‹å,å¼•æ“å¯ä»¥æ£€æµ‹çƒ­ç‚¹ï¼ˆhot codeï¼‰ä»£ç ï¼Œç”±TurboFan ç¼–è¯‘å™¨å†ç”Ÿæˆæœºå™¨ç ï¼Œæå‡è¿è¡Œæ—¶æ•ˆç‡ï¼Œéçƒ­ç‚¹ä»£ç çš„å­—èŠ‚ç å¯ä»¥ç«‹å³æ‰§è¡Œï¼Œå¹¶ä¸”ç”Ÿæˆå­—èŠ‚ç çš„é€Ÿåº¦è¿œå¤§äºç”Ÿäº§æœºå™¨ç çš„é€Ÿåº¦ï¼Œè¿™æ ·çš„ä¸€é¡¿æ“ä½œåV8å°±å¯ä»¥å¹³è¡¡ä»£ç è¿è¡Œæ—¶çš„æ—¶é—´å’Œç©ºé—´çš„å¤æ‚åº¦ã€‚
ä¸‹é¢æ˜¯æ¨¡æ‹Ÿå­—èŠ‚ç å’Œæœºå™¨ç è¿è¡Œçš„æµ‹è¯•ä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è®¡ç®—å¯†é›†å‹å‡½æ•°ï¼ˆæ¨¡æ‹Ÿçƒ­ç‚¹ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">computeIntensive</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000000</span>; i++) {  <span class="hljs-comment">// å¢åŠ å¾ªç¯æ¬¡æ•°ä»¥æ”¾å¤§å·®è·</span>
    result += <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(i) * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>(i);
  }
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-comment">// å†·å¯åŠ¨æµ‹è¯•ï¼šç¬¬ä¸€æ¬¡æ‰§è¡Œï¼ˆä¸»è¦ä½¿ç”¨å­—èŠ‚ç ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'Cold Start (Bytecode)'</span>);
<span class="hljs-title function_">computeIntensive</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'Cold Start (Bytecode)'</span>);

<span class="hljs-comment">// çƒ­å¯åŠ¨æµ‹è¯•ï¼šå¤šæ¬¡æ‰§è¡Œåï¼ˆè§¦å‘ JITï¼Œæœºå™¨ç ä¼˜åŒ–ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'Hot Start (Machine Code)'</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
  <span class="hljs-title function_">computeIntensive</span>();  <span class="hljs-comment">// é‡å¤æ‰§è¡Œï¼ŒV8 ä¼šä¼˜åŒ–æˆæœºå™¨ç </span>
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'Hot Start (Machine Code)'</span>);
</code></pre>
<p>åœ¨ç»ˆç«¯è¿è¡Œï¼š<code>node --trace-opt  test.js</code>(<strong>Node.js</strong>ï¼šæ˜¯ä¸€ä¸ªåŸºäº V8 JavaScript å¼•æ“çš„è¿è¡Œæ—¶ç¯å¢ƒ),æ‰§è¡Œç»“æœå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c75243a0251451f885b0abe5fcdcd7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbGlib2thaWZh:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770948262&amp;x-signature=t3rCcKROxtGDQJnhRe0aoc4wJe8%3D" alt="image.png" loading="lazy"/>
å†·å¯åŠ¨çš„æ—¶å€™æ‰§è¡Œäº†ï¼Œè€—æ—¶ï¼š1.486s ,ä½†ä»£ç ç«‹å³æ‰§è¡Œäº†ä¸€æ¬¡ã€‚
Hot Codeçƒ­å¯åŠ¨ è€—æ—¶ï¼š14.955sï¼Œä½†æ‰§è¡Œäº†100,000,000æ¬¡ï¼Œå¯ä»¥çœ‹å‡ºV8 é€šè¿‡åˆ†å±‚æ‰§è¡Œå­—èŠ‚ç å’Œæœºå™¨ç ä»¥ä¿è¯ä»£ç æ‰§è¡Œçš„æ•ˆç‡ï¼›</p>
<h2 data-id="heading-3">æ‰§è¡Œ</h2>
<p>ç”Ÿæˆåçš„æœºå™¨ç å’Œå­—èŠ‚ç å…¨éƒ¨å­˜åœ¨å†…å­˜é‡Œï¼Œå½“ä¸€ä¸ªæ‰§è¡Œå‘½ä»¤æ‰§è¡Œåˆ°ä¸€ä¸ªå‡½æ•°åï¼ŒV8 runtime ä¼šæ£€æµ‹æ˜¯è°ƒå–æœºå™¨ç è¿˜æ˜¯å­—èŠ‚ç ï¼Œå¹¶æŠŠåœ°å€ä¿¡æ¯ç»™åˆ°Cpuï¼Œæ¥æ‰§è¡Œè¯¥åœ°å€çš„æŒ‡ä»¤</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆšåˆšï¼ŒClaude Opus 4.6 å’Œ GPT-5.3-Codex åŒæ—¶ç‚¸åœºï¼AI ç¼–ç¨‹è¦å˜å¤©äº†]]></title>    <link>https://juejin.cn/post/7603263490341945353</link>    <guid>https://juejin.cn/post/7603263490341945353</guid>    <pubDate>2026-02-06T02:39:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603263490341945353" data-draft-id="7603263490341814281" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆšåˆšï¼ŒClaude Opus 4.6 å’Œ GPT-5.3-Codex åŒæ—¶ç‚¸åœºï¼AI ç¼–ç¨‹è¦å˜å¤©äº†"/> <meta itemprop="keywords" content="AIç¼–ç¨‹,ç¨‹åºå‘˜,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-02-06T02:39:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜é±¼çš®"/> <meta itemprop="url" content="https://juejin.cn/user/2444938365386621"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆšåˆšï¼ŒClaude Opus 4.6 å’Œ GPT-5.3-Codex åŒæ—¶ç‚¸åœºï¼AI ç¼–ç¨‹è¦å˜å¤©äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2444938365386621/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜é±¼çš®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T02:39:54.000Z" title="Fri Feb 06 2026 02:39:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ç¨‹åºå‘˜é±¼çš®ã€‚</p>
<p>ä»Šå¤©å‡Œæ™¨ï¼ŒAI åœˆåˆåŒå’ç‚¸äº†ã€‚Anthropic å’Œ OpenAI å‡ ä¹åŒæ—¶å‘å¸ƒäº†è‡ªå®¶çš„æœ€æ–°å¤§æ¨¡å‹ â€”â€” Claude Opus 4.6 å’Œ GPT-5.3-Codexï¼Œä¸­é—¨å¯¹ç‹™ï¼Œç«è¯å‘³åè¶³ã€‚</p>
<p><img src="https://pic.yupi.icu/1/image-20260206092008146.png" alt="" loading="lazy"/></p>
<p>è¿™æ¬¡ä¸¤å®¶æ˜¯çœŸå¾€ç¼–ç¨‹å’Œå®é™…å·¥ä½œèƒ½åŠ›ä¸Šå·äº†ï¼Œä¸æ˜¯é‚£ç§ â€œè·‘åˆ†å‡äº† 2 ä¸ªç‚¹â€ å°±å‘ç¯‡åšå®¢çš„æ•·è¡æ›´æ–°ã€‚</p>
<p>ä¸‹é¢æˆ‘å¸¦å¤§å®¶å¿«é€Ÿäº†è§£ä¸€ä¸‹ï¼Œè¿™ä¸¤ä¸ªæ¨¡å‹åˆ°åº•æ›´æ–°äº†ä»€ä¹ˆï¼Ÿå¯¹æˆ‘ä»¬ç¨‹åºå‘˜å’Œ AI ç©å®¶æ¥è¯´æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</p>
<h2 data-id="heading-0">Claude Opus 4.6ï¼šæ›´èªæ˜ã€æ›´èƒ½å¹²ã€æ›´æŒä¹…</h2>
<p>å…ˆè¯´ Anthropic è¿™è¾¹ã€‚Claude Opus 4.6 æ˜¯ç›®å‰ Claude å®¶æ—æœ€å¼ºçš„æ¨¡å‹ï¼Œä¹‹å‰ç”¨ Claude Opus 4.5 ç¼–ç¨‹å°±å·²ç»è®©æˆ‘æ„Ÿè§‰ â€œAI å†™ä»£ç æ— æ‰€ä¸èƒ½â€ äº†ï¼Œè€Œè¿™æ¬¡çš„ Opus 4.6 åœ¨å¤šé¡¹è¯„ä¼°ä¸­å‡å¤„äºæœ€å…ˆè¿›æ°´å¹³ï¼ŒåŒ…æ‹¬æ™ºèƒ½ç¼–ç ã€å¤šå­¦ç§‘æ¨ç†ã€çŸ¥è¯†å·¥ä½œå’Œæ™ºèƒ½æœç´¢ç­‰ã€‚</p>
<p>å…‰çœ‹è¿™ä¸ªè·‘åˆ†æˆ‘å°±è´¼æ¿€åŠ¨äº†ï¼</p>
<p><img src="https://pic.yupi.icu/1/1770339059467-24cdc13f-957e-4ff8-bee2-7b8625d0c4a6.png" alt="" loading="lazy"/></p>
<p>å®é™…ä¸Šæ‰‹åï¼Œæˆ‘æœ€ç›´è§‚çš„æ„Ÿå—å°±æ˜¯ï¼š<strong>å¹²æ´»æ›´é è°±äº†</strong>ã€‚</p>
<p>å…·ä½“æ›´æ–°äº†è¿™äº›ï¼š</p>
<p>1ï¼‰ç¼–ç¨‹èƒ½åŠ›å¤§å¹…æå‡ï¼šOpus 4.6 èƒ½æ›´å¥½åœ°åœ¨å¤§å‹ä»£ç åº“ä¸­å·¥ä½œï¼Œè°ƒè¯•å’Œä»£ç å®¡æŸ¥èƒ½åŠ›å¢å¼ºï¼Œå†™å®Œä»£ç è¿˜èƒ½è‡ªå·±æ£€æŸ¥é”™è¯¯ã€‚</p>
<p>æˆ‘å®æµ‹äº†ä¸€æ³¢ï¼Œè®©ä¹‹å‰çš„ Opus 4.5 å’Œæ–°å‡ºçš„ Opus 4.6 åŒæ—¶å¼€å‘ä¸€ä¸ªã€Œèšåˆæœç´¢å¼•æ“ã€é¡¹ç›®ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">è¯·ä½ å¸®æˆ‘å¼€å‘ä¸€ä¸ªèšåˆæœç´¢ç½‘ç«™ï¼ŒåŒ…å«å®Œæ•´çš„å‰ç«¯å’Œåç«¯ï¼Œèƒ½å¤ŸåŒæ—¶ä»å¤šä¸ªä¸åŒçš„æœç´¢å¼•æ“æœç´¢å’Œèšåˆç»“æœã€‚
åº”è¯¥å…ˆåš MVP æœ€å°å¯è¡Œäº§å“ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸éœ€è¦å‘æˆ‘ç¡®è®¤ã€ä¸éœ€è¦æˆ‘æä¾› API Keyï¼Œä½ å¿…é¡»ç¡®ä¿åŠŸèƒ½æ­£å¸¸å¯ç”¨ã€‚

</code></pre>
<p><img src="https://pic.yupi.icu/1/image-20260206095821042.png" alt="" loading="lazy"/></p>
<p>å‡ åˆ†é’Ÿåï¼ŒäºŒè€…éƒ½å®Œæˆäº†ä»»åŠ¡ï¼š</p>
<p><img src="https://pic.yupi.icu/1/image-20260206100013366.png" alt="" loading="lazy"/></p>
<p>ä½†æ˜¯å¯¹æ¯”ä¸€ä¸‹å®é™…æœç´¢æ•ˆæœï¼ŒOpus 4.5 å®Œè´¥ï¼Œçœ‹åˆ°è¿™æˆ‘å°±æ”¾å¿ƒäº†ï¼Œä»¥åæˆ‘ç”¨ AI ç¼–ç¨‹ä¼°è®¡ Bug æ›´å°‘äº†~</p>
<p><img src="https://pic.yupi.icu/1/image-20260206100155670.png" alt="" loading="lazy"/></p>
<p>2ï¼‰100 ä¸‡ token ä¸Šä¸‹æ–‡çª—å£ã€‚Opus ç³»åˆ—ç¬¬ä¸€æ¬¡æ”¯æŒè¿™ä¹ˆé•¿çš„ä¸Šä¸‹æ–‡ï¼Œç®€å•æ¥è¯´å°±æ˜¯ä½ å¯ä»¥ä¸€æ¬¡æ€§ç»™å®ƒä¸¢ä¸€å¤§å †æ–‡ä»¶å’Œä»£ç ï¼Œå®ƒéƒ½èƒ½è®°ä½å¹¶ç†è§£ï¼Œä¸ä¼šåƒä»¥å‰é‚£æ ·èŠç€èŠç€å°±å¤±å¿†äº†ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯æˆ‘æœ€æœ€æœ€æœŸå¾…çš„ç‰¹æ€§ï¼Œå¤æ‚çš„å‰åç«¯é¡¹ç›®ä¹Ÿå¯ä»¥åœ¨åŒä¸€å¯¹è¯æ¡†ä¸­ä¸€æŠŠæ¢­äº†ï¼ä¸ç”¨æ¥æ¥å›å›æ€»ç»“ä¸Šä¸‹æ–‡å’Œæ–°å¼€å¯¹è¯æ¡†ã€‚</p>
<p>èµ£ï¼Œå‡†å¤‡å˜å˜çƒ§ Tokens äº†ã€‚</p>
<p>3ï¼‰128k è¾“å‡º tokenã€‚è¾“å‡ºé•¿åº¦ç¿»å€ï¼Œæ„å‘³ç€ Claude å¯ä»¥ä¸€æ¬¡æ€§ç”Ÿæˆæ›´é•¿çš„ä»£ç å’Œæ–‡æ¡£ï¼Œä¸ç”¨å†æ‹†æˆå¥½å‡ æ¬¡è¯·æ±‚äº†ã€‚</p>
<p>4ï¼‰è‡ªé€‚åº”æ€è€ƒã€‚ä»¥å‰å¼€å‘è€…åªèƒ½æ‰‹é€‰å¼€å¯æˆ–å…³é—­æ·±åº¦æ¨ç†ï¼Œç°åœ¨ Claude ä¼šè‡ªåŠ¨åˆ¤æ–­è¿™ä¸ªé—®é¢˜éœ€ä¸éœ€è¦æ·±åº¦æ€è€ƒã€‚ç®€å•é—®é¢˜ç§’å›ï¼Œå¤æ‚é—®é¢˜æ…¢æ…¢æƒ³ï¼Œæ™ºèƒ½è°ƒèŠ‚ï¼Œçœæ—¶çœé’±ã€‚</p>
<p>5ï¼‰ä¸Šä¸‹æ–‡å‹ç¼©ã€‚ä»¥å‰è·‘é•¿ä»»åŠ¡çš„æ—¶å€™ï¼ŒAI ç»å¸¸ä¼šæ’åˆ°ä¸Šä¸‹æ–‡é•¿åº¦çš„å¤©èŠ±æ¿ã€‚ç°åœ¨ Claude èƒ½è‡ªåŠ¨å‹ç¼©å’Œæ€»ç»“ä¹‹å‰çš„å¯¹è¯å†…å®¹ï¼Œè®©é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ä¸ä¼šä¸­é€”ç¿»è½¦ã€‚æ­é… 100 ä¸‡ token ä¸Šä¸‹æ–‡ï¼Œä¸æ•¢æƒ³è±¡æœ‰å¤šæŒä¹…ï¼</p>
<p>6ï¼‰Claude Code æ”¯æŒå¤šæ™ºèƒ½ä½“åä½œã€‚ä½ å¯ä»¥åŒæ—¶å¯åŠ¨å¤šä¸ª AI Agent å¹¶è¡Œå·¥ä½œï¼Œæ¯”å¦‚è®©å‡ ä¸ª Agent åŒæ—¶å®¡æŸ¥ä»£ç åº“çš„ä¸åŒéƒ¨åˆ†ï¼Œæ•ˆç‡ç›´æ¥ç¿»å€ã€‚</p>
<p>7ï¼‰Claude in Excel å¤§å‡çº§ã€‚ç°åœ¨èƒ½å¤„ç†æ›´å¤æ‚çš„é•¿æ—¶é—´ä»»åŠ¡ï¼Œæ”¯æŒæ•°æ®é€è§†è¡¨ã€å›¾è¡¨ä¿®æ”¹ã€æ¡ä»¶æ ¼å¼ã€æ•°æ®éªŒè¯ç­‰ï¼Œè¿˜èƒ½ä¸€æ¬¡æ€§å¤„ç†å¤šæ­¥éª¤æ“ä½œã€‚</p>
<p><img src="https://pic.yupi.icu/1/6984ae18765ce9ada0768cfc_ClaudeExcel-Blog-Hero-Desktop.png" alt="" loading="lazy"/></p>
<p>8ï¼‰Claude in PowerPoint ä¸Šçº¿ã€‚èƒ½è¯»å–ä½ å·²æœ‰çš„æ¨¡æ¿ã€å­—ä½“å’Œæ¯ç‰ˆï¼Œä¿æŒå“ç‰Œé£æ ¼ä¸€è‡´ï¼Œç„¶åç›´æ¥å¸®ä½ ç”Ÿæˆå®Œæ•´çš„ PPTã€‚</p>
<p><img src="https://pic.yupi.icu/1/1770339189972-c3c8b2e7-234b-4089-8b69-d172b523d5d4.png" alt="" loading="lazy"/></p>
<p>å¤§å®¶å¯¹ Opus 4.6 ä¹Ÿæ˜¯ä¸€è‡´å¥½è¯„ï¼Œä¸å°‘æ—©æœŸæµ‹è¯•çš„å…¬å¸éƒ½è¡¨ç¤º â€œç”¨äº†å›ä¸å»â€ï¼ŒCursor å®˜æ–¹è¯´ Opus 4.6 æ˜¯ä»–ä»¬å†…éƒ¨é•¿ä»»åŠ¡æµ‹è¯•ä¸­çš„æœ€å¼ºæ¨¡å‹ï¼ŒReplit è¯´å®ƒçš„ä»»åŠ¡æ‹†è§£å’Œå¹¶è¡Œè§„åˆ’èƒ½åŠ›æœ‰äº†å·¨å¤§é£è·ƒã€‚</p>
<h2 data-id="heading-1">GPT-5.3-Codexï¼šOpenAI çš„ç¼–ç¨‹æ€æ‰‹é”</h2>
<p>å†çœ‹ OpenAI è¿™è¾¹ã€‚è¿™æ¬¡å‘å¸ƒçš„ GPT-5.3-Codexï¼Œå‰‘æŒ‡ <strong>æœ€å¼ºç¼–ç¨‹ Agent</strong>ï¼Œè€Œä¸”ä¸åªæ˜¯å†™ä»£ç ï¼Œè¿˜èƒ½åƒä½ çš„åŒäº‹ä¸€æ ·è¾¹å¹²æ´»è¾¹å’Œä½ æ²Ÿé€šã€‚</p>
<p>ç›¸æ¯” Claude å®˜æ–¹è¿å‘å¥½å‡ ä¸ªå¸–å­ä»‹ç»è‡ªå®¶æ–°æ¨¡å‹ï¼ŒOpenAI å®˜æ–¹è¿™è¾¹åˆ™ä½è°ƒä¸å°‘ã€‚Sam Altman äº²è‡ªåœ¨ X ä¸Šå–Šè¯ï¼š</p>
<p><img src="https://pic.yupi.icu/1/1770340355704-c9569d19-a5f5-4e46-98c4-b6b75dab01bc-20260206093449865.png" alt="" loading="lazy"/></p>
<p>æ¥çœ‹çœ‹å…·ä½“æœ‰ä»€ä¹ˆï¼š</p>
<p>1ï¼‰ç¼–ç¨‹è·‘åˆ†å…¨é¢é¢†å…ˆã€‚SWE-Bench Pro 57% å’Œ TerminalBench 2.0 77%ï¼Œç¼–ç¨‹ç›¸å…³åŸºå‡†éƒ½åˆ›äº†æ–°é«˜ã€‚å°¤å…¶æ˜¯ OSWorldï¼ˆæµ‹è¯• AI åœ¨çœŸå®æ¡Œé¢ç¯å¢ƒä¸­å®Œæˆä»»åŠ¡çš„èƒ½åŠ›ï¼‰ç›´æ¥ä»ä¸Šä¸€ä»£çš„ 38.2% é£™åˆ° 64.7%ï¼Œè¿™ä¸ªæå‡å¹…åº¦ç›¸å½“ç‚¸è£‚ã€‚</p>
<p><img src="https://pic.yupi.icu/1/image-20260206094035858.png" alt="" loading="lazy"/></p>
<p>2ï¼‰é€Ÿåº¦æ›´å¿«ã€æ›´çœé’±ã€‚å®ŒæˆåŒæ ·çš„ä»»åŠ¡ï¼Œtoken æ¶ˆè€—é‡ä¸åˆ°ä¸Šä¸€ä»£ï¼ˆ5.2-Codexï¼‰çš„ä¸€åŠï¼Œè€Œä¸”æ¯ä¸ª token å¤„ç†é€Ÿåº¦è¿˜å¿«äº† 25%ã€‚åˆå¿«åˆçœï¼Œè¿™æ‰æ˜¯å®å®åœ¨åœ¨çš„ä½“éªŒæå‡ã€‚</p>
<p>3ï¼‰è¾¹å¹²æ´»è¾¹æ±‡æŠ¥ã€‚ä»¥å‰ä½ ä¸¢ä¸€ä¸ªä»»åŠ¡ç»™ AIï¼Œåªèƒ½å¹²ç­‰ç»“æœã€‚ç°åœ¨ GPT-5.3-Codex ä¼šåœ¨å·¥ä½œè¿‡ç¨‹ä¸­å®æ—¶å‘Šè¯‰ä½ å®ƒåœ¨åšä»€ä¹ˆã€åšåˆ°å“ªäº†ï¼Œä½ éšæ—¶å¯ä»¥æ’å˜´è°ƒæ•´æ–¹å‘ï¼Œå°±åƒçœŸçš„åœ¨å’Œä¸€ä¸ªåŒäº‹åä½œä¸€æ ·ã€‚</p>
<p>4ï¼‰è¶…å¼ºçš„å‰ç«¯å¼€å‘èƒ½åŠ›ã€‚å®˜æ–¹ç›´æ¥å±•ç¤ºäº†è®©å®ƒåšèµ›è½¦æ¸¸æˆå’Œæ½œæ°´æ¸¸æˆçš„æ•ˆæœï¼Œå®Œæ•´åº¦é«˜å¾—ç¦»è°±ï¼Œæœ‰å¤šä¸ªåœ°å›¾ã€é“å…·ç³»ç»Ÿå’Œå®Œæ•´çš„æ¸¸æˆé€»è¾‘ã€‚</p>
<p><img src="https://pic.yupi.icu/1/image-20260206094133069.png" alt="" loading="lazy"/></p>
<p>ç”Ÿæˆæ™®é€šç½‘é¡µæ—¶ AI ä¹Ÿæ›´æ‡‚ä½ çš„æ„å›¾äº†ï¼Œé»˜è®¤å°±èƒ½ç»™ä½ åšå‡ºåŠŸèƒ½æ›´ä¸°å¯Œã€è®¾è®¡æ›´åˆç†çš„é¡µé¢ã€‚</p>
<p>5ï¼‰ç”µè„‘æ“ä½œèƒ½åŠ›å¢å¼ºã€‚ä¸åªæ˜¯å†™ä»£ç ï¼Œå®ƒè¿˜èƒ½åƒäººä¸€æ ·æ“ä½œç”µè„‘å®Œæˆå„ç§ä»»åŠ¡ï¼Œæ¯”å¦‚åš PPTã€åˆ†ææ•°æ®ã€å¤„ç†è¡¨æ ¼ï¼ŒæŠŠç¼–ç¨‹ Agent çš„è¾¹ç•Œæ‰©å±•åˆ°äº†å…¨èƒ½æ‰“å·¥ Agentã€‚</p>
<p>6ï¼‰è‡ªå·±è®­ç»ƒè‡ªå·±ã€‚OpenAI å›¢é˜Ÿè¯´ GPT-5.3-Codex æ˜¯ç¬¬ä¸€ä¸ª <strong>å‚ä¸äº†è‡ªèº«åˆ›é€ </strong> çš„æ¨¡å‹ã€‚å›¢é˜Ÿç”¨å®ƒçš„æ—©æœŸç‰ˆæœ¬æ¥è°ƒè¯•è®­ç»ƒè¿‡ç¨‹ã€ç®¡ç†éƒ¨ç½²ã€åˆ†ææµ‹è¯•ç»“æœã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒAI åœ¨åŠ é€Ÿ AI è‡ªèº«çš„è¿›åŒ–ï¼Œä»¥åçš„è¿›åŒ–é€Ÿåº¦è‚¯å®šä¼šè¶Šæ¥è¶Šå¿«ã€‚</p>
<p>7ï¼‰ç½‘ç»œå®‰å…¨èƒ½åŠ›å¤§å¹…å¢å¼ºã€‚è¿™æ˜¯ç¬¬ä¸€ä¸ªè¢« OpenAI å½’ç±»ä¸ºé«˜èƒ½åŠ›ç½‘ç»œå®‰å…¨æ¨¡å‹çš„ç‰ˆæœ¬ï¼Œèƒ½ä¸»åŠ¨å‘ç°ä»£ç æ¼æ´ã€‚OpenAI åŒæ—¶æ‰¿è¯ºæŠ•å…¥ 1000 ä¸‡ç¾å…ƒ API é¢åº¦æ”¯æŒç½‘ç»œé˜²å¾¡ç ”ç©¶ã€‚</p>
<h2 data-id="heading-2">æˆ‘çš„çœ‹æ³•</h2>
<p>è¿™æ¬¡ä¸¤å®¶å·¨å¤´åŒæ—¶å‘å¸ƒæ–°æ¨¡å‹ï¼Œäº’ç›¸è´´è„¸å¼€å¤§ï¼Œå¯¹æˆ‘ä»¬ç”¨æˆ·æ¥è¯´æ˜¯å¥½äº‹ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸¤ä¸ªæ¨¡å‹éƒ½åœ¨å¾€ <strong>å®ç”¨æ–¹å‘</strong> çŒ›å·ï¼Œæ˜¯çœŸçš„æƒ³è®©ä½ æ—¥å¸¸å·¥ä½œä¸­ç”¨å¾—ä¸Šã€‚</p>
<p>è¿™ä¸¤ä¸ªå¤§æ¨¡å‹åº”è¯¥å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿ</p>
<p>ç®€å•å¯¹æ¯”ä¸€ä¸‹ï¼š</p>
<ul>
<li>Claude Opus 4.6 æ˜¯å…­è¾¹å½¢æˆ˜å£«ï¼Œç¼–ç¨‹ã€åŠå…¬ã€ç ”ç©¶æ ·æ ·è¡Œï¼Œç‰¹åˆ«æ˜¯åœ¨ Excelã€PowerPoint è¿™äº›åŠå…¬åœºæ™¯é‡Œåšäº†å¾ˆæ·±çš„æ•´åˆã€‚</li>
<li>GPT-5.3-Codex æŠŠç¼–ç¨‹èƒ½åŠ›æ‹‰æ»¡ï¼Œåœ¨ä»£ç ç”Ÿæˆã€ä»»åŠ¡æ‰§è¡Œå’Œäººæœºåä½œä¸Šæ‰“å‡ºäº†å·®å¼‚åŒ–ä¼˜åŠ¿ã€‚</li>
</ul>
<p>ä¸è¿‡æˆ‘ä¼°è®¡ç½‘ç»œå’Œä»·æ ¼å°±å·²ç»åŠé€€ä¸€å¤§æ³¢å›½å†…ç”¨æˆ·äº†ï¼Œå¦‚æœä½ åªæ˜¯æ—¥å¸¸å­¦ä¹ ã€æˆ–è€…åšåšå·¥å…·ç±»å°é¡¹ç›®ï¼Œä¹Ÿä¸å¿…ç›²ç›®è¿½æ±‚å›½å¤–çš„å¤§æ¨¡å‹ã€‚å¾ˆå¿« DeepSeek V4 ç­‰ä¸€ç³»åˆ—å›½äº§å¤§æ¨¡å‹åº”è¯¥å°±è¦å‡ºæ¥äº†ï¼ŒæœŸå¾…ä¸€æ³¢~</p>
<h2 data-id="heading-3">æ›´å¤š</h2>
<p>ğŸ’» ç¼–ç¨‹å­¦ä¹ äº¤æµï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fliyupi%2Fcode-nav" target="_blank" title="https://github.com/liyupi/code-nav" ref="nofollow noopener noreferrer">ç¼–ç¨‹å¯¼èˆª</a><br/>
ğŸ“ƒ ç®€å†å¿«é€Ÿåˆ¶ä½œï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fliyupi%2Flaoyujianli" target="_blank" title="https://github.com/liyupi/laoyujianli" ref="nofollow noopener noreferrer">è€é±¼ç®€å†</a><br/>
âœï¸ é¢è¯•åˆ·é¢˜ç¥å™¨ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fliyupi%2Fmianshiya" target="_blank" title="https://github.com/liyupi/mianshiya" ref="nofollow noopener noreferrer">é¢è¯•é¸­</a><br/>
ğŸ“– AI å­¦ä¹ æŒ‡å—ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fliyupi%2Fai-guide" target="_blank" title="https://github.com/liyupi/ai-guide" ref="nofollow noopener noreferrer">é±¼çš® AI å¯¼èˆª</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kotlin 2.2.20 æŠ€æœ¯å‰ç»ï¼šWebAssembly æ”¯æŒçš„æ·±åº¦è§£æä¸æœªæ¥å›¾æ™¯]]></title>    <link>https://juejin.cn/post/7603352061468246058</link>    <guid>https://juejin.cn/post/7603352061468246058</guid>    <pubDate>2026-02-05T16:54:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603352061468246058" data-draft-id="7603352061468229674" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kotlin 2.2.20 æŠ€æœ¯å‰ç»ï¼šWebAssembly æ”¯æŒçš„æ·±åº¦è§£æä¸æœªæ¥å›¾æ™¯"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-05T16:54:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°ç å“¥_å¸¸"/> <meta itemprop="url" content="https://juejin.cn/user/705230023172650"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kotlin 2.2.20 æŠ€æœ¯å‰ç»ï¼šWebAssembly æ”¯æŒçš„æ·±åº¦è§£æä¸æœªæ¥å›¾æ™¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/705230023172650/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°ç å“¥_å¸¸
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T16:54:20.000Z" title="Thu Feb 05 2026 16:54:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><em>æ³¨ï¼šæœ¬æ–‡ä¸ºæŠ€æœ¯å‰ç»æ€§åˆ†æã€‚æˆªè‡³2024å¹´ä¸­ï¼ŒKotlin å®˜æ–¹æœ€æ–°ç¨³å®šç‰ˆä¸º 1.9.20ï¼ŒKotlin 2.0.0 å°šæœªå‘å¸ƒã€‚æ‰€è°“â€œ2.2.20"ç³»åŸºäº Kotlin/Wasm å½“å‰å®éªŒè¿›å±•ï¼ˆKotlin 1.8.20+ï¼‰ä¸ JetBrains è·¯çº¿å›¾çš„åˆç†æ¨æ¼”ï¼Œæ—¨åœ¨æ¢è®¨ Kotlin æ·±åº¦é›†æˆ WebAssembly çš„æŠ€æœ¯è·¯å¾„ä¸ç”Ÿæ€ä»·å€¼ã€‚å®é™…åŠŸèƒ½è¯·ä»¥ JetBrains å®˜æ–¹å‘å¸ƒä¸ºå‡†ã€‚</em></p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä½• Kotlin éœ€è¦ WebAssemblyï¼Ÿâ€”â€” æˆ˜ç•¥èƒŒæ™¯</h2>
<p>WebAssemblyï¼ˆWasmï¼‰å·²ä»â€œæµè§ˆå™¨è¡¥å……æŠ€æœ¯â€æ¼”è¿›ä¸ºè·¨å¹³å°è¿è¡Œæ—¶åŸºçŸ³ï¼ˆWASIã€Serverlessã€è¾¹ç¼˜è®¡ç®—ï¼‰ã€‚å¯¹ Kotlin è€Œè¨€ï¼š</p>
<ul>
<li><strong>çªç ´ JavaScript æ€§èƒ½ç“¶é¢ˆ</strong>ï¼šè®¡ç®—å¯†é›†å‹åœºæ™¯ï¼ˆå›¾åƒå¤„ç†ã€æ¸¸æˆé€»è¾‘ã€ç§‘å­¦è®¡ç®—ï¼‰éœ€æ¥è¿‘åŸç”Ÿçš„æ‰§è¡Œæ•ˆç‡</li>
<li><strong>ç»Ÿä¸€å¤šå¹³å°æˆ˜ç•¥</strong>ï¼šKotlin Multiplatformï¼ˆKMPï¼‰éœ€è¦†ç›– Web ç«¯é«˜æ€§èƒ½åœºæ™¯ï¼Œè¡¥å…¨â€œKotlin/JSï¼ˆå…¼å®¹æ€§ï¼‰ + Kotlin/Wasmï¼ˆæ€§èƒ½ï¼‰â€åŒè½¨æ–¹æ¡ˆ</li>
<li><strong>æ‹¥æŠ±ç°ä»£ Web æ ‡å‡†</strong>ï¼šWasm GC Proposalï¼ˆ2023å¹´åº•è¿›å…¥ Phase 4ï¼‰ä¸ºå¸¦ GC è¯­è¨€ï¼ˆå¦‚ Kotlinï¼‰æä¾›åŸç”Ÿå¯¹è±¡æ¨¡å‹æ”¯æŒï¼Œæ¶ˆé™¤ JS äº’æ“ä½œå¼€é”€</li>
</ul>
<blockquote>
<p>ğŸ’¡ å…³é”®è½¬æŠ˜ï¼šKotlin 1.8.20 é¦–æ¬¡å¼•å…¥å®éªŒæ€§ <code>wasm</code> ç›®æ ‡ï¼›1.9.20 ä¼˜åŒ–å†…å­˜ç®¡ç†ä¸ JS äº’æ“ä½œã€‚æœ¬æ–‡å‡è®¾åœ¨â€œ2.2.20"ä¸­ï¼ŒKotlin/Wasm è¾¾åˆ° <strong>Production-Ready</strong> çº§åˆ«ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">äºŒã€æ ¸å¿ƒæŠ€æœ¯æ·±åº¦è§£æï¼ˆåŸºäºå½“å‰è·¯çº¿å›¾æ¨æ¼”ï¼‰</h2>
<h3 data-id="heading-2">1. ç¼–è¯‘å™¨æ¶æ„ï¼šä» IR åˆ° Wasm GC</h3>
<ul>
<li><strong>ç»Ÿä¸€ä¸­é—´è¡¨ç¤ºï¼ˆIRï¼‰</strong>ï¼šKotlin ç¼–è¯‘å™¨å‰ç«¯ç”Ÿæˆå¹³å°æ— å…³ IRï¼Œåç«¯é’ˆå¯¹ Wasm GC ç”Ÿæˆé«˜æ•ˆå­—èŠ‚ç </li>
<li><strong>Wasm GC æ·±åº¦é›†æˆ</strong>ï¼š
<ul>
<li>Kotlin å¯¹è±¡ â†’ Wasm Struct/Arrayï¼ˆéçº¿æ€§å†…å­˜æ¨¡æ‹Ÿï¼‰</li>
<li>åç¨‹çŠ¶æ€æœº â†’ Wasm å¼•ç”¨ç±»å‹ï¼ˆé¿å… JS å †æ‹·è´ï¼‰</li>
<li>æ ‡å‡†åº“ç²¾ç®€ï¼šä»…ä¿ç•™ <code>kotlin.wasm</code> æ¨¡å—å¿…è¦ APIï¼Œä½“ç§¯è¾ƒ Kotlin/JS å‡å°‘ 40%+</li>
</ul>
</li>
<li><strong>åŒæ¨¡å¼è¾“å‡º</strong>ï¼š
<ul>
<li><code>wasm32-unknown-wasi</code>ï¼šæœåŠ¡ç«¯/è¾¹ç¼˜è®¡ç®—åœºæ™¯</li>
<li><code>wasm32-unknown-emscripten</code>ï¼šæµè§ˆå™¨ç¯å¢ƒï¼ˆå« JS èƒ¶æ°´ä»£ç ä¼˜åŒ–ï¼‰</li>
</ul>
</li>
</ul>
<h3 data-id="heading-3">2. å†…å­˜ä¸å¹¶å‘æ¨¡å‹é©æ–°</h3>






























<table><thead><tr><th>ç‰¹æ€§</th><th>Kotlin/JS</th><th>Kotlin/Wasmï¼ˆæ¨æ¼”ï¼‰</th></tr></thead><tbody><tr><td><strong>å†…å­˜ç®¡ç†</strong></td><td>ä¾èµ– JS GC</td><td>ç›´æ¥ä½¿ç”¨ Wasm GCï¼ˆä¸å®¿ä¸»éš”ç¦»ï¼‰</td></tr><tr><td><strong>åç¨‹è°ƒåº¦</strong></td><td>åŸºäº JS Promise</td><td>åŸç”Ÿ Wasm å¼‚æ­¥ï¼ˆ<code>asyncify</code> ä¼˜åŒ–ï¼‰</td></tr><tr><td><strong>çº¿ç¨‹æ”¯æŒ</strong></td><td>æ— ï¼ˆå•çº¿ç¨‹ï¼‰</td><td>Wasm Threads Proposalï¼ˆSharedArrayBufferï¼‰</td></tr><tr><td><strong>å¯åŠ¨å»¶è¿Ÿ</strong></td><td>é«˜ï¼ˆJS è§£æï¼‰</td><td>ä½ï¼ˆäºŒè¿›åˆ¶é¢„ç¼–è¯‘ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-4">3. æ— ç¼äº’æ“ä½œè®¾è®¡</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Kotlin ä»£ç ï¼ˆç¼–è¯‘ä¸º Wasm æ¨¡å—ï¼‰</span>
<span class="hljs-meta">@WasmExport</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processImage</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">ByteArray</span>)</span></span>: ByteArray {
    <span class="hljs-comment">// é«˜æ€§èƒ½å›¾åƒå¤„ç†ï¼ˆç›´æ¥æ“ä½œ Wasm çº¿æ€§å†…å­˜ï¼‰</span>
    <span class="hljs-keyword">return</span> applyFilter(<span class="hljs-keyword">data</span>)
}

<span class="hljs-meta">@WasmImport(<span class="hljs-string">"env"</span>, <span class="hljs-string">"logMessage"</span>)</span>
<span class="hljs-keyword">external</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">log</span><span class="hljs-params">(msg: <span class="hljs-type">String</span>)</span></span>

<span class="hljs-comment">// JS è°ƒç”¨ç¤ºä¾‹ï¼ˆæµè§ˆå™¨ï¼‰</span>
<span class="hljs-keyword">const</span> module = await WebAssembly.instantiateStreaming(fetch(<span class="hljs-string">'app.wasm'</span>));
module.exports.processImage(imageBuffer); <span class="hljs-comment">// é›¶æ‹·è´ä¼ é€’ ArrayBuffer</span>
</code></pre>
<ul>
<li><strong>æ™ºèƒ½èƒ¶æ°´å±‚</strong>ï¼šç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆæœ€å°åŒ– JS èƒ¶æ°´ä»£ç ï¼ˆè¾ƒ Emscripten å‡å°‘ 70%ï¼‰</li>
<li><strong>ç±»å‹å®‰å…¨æ¡¥æ¥</strong>ï¼šKotlin <code>String</code> â†” Wasm UTF-8 ç¼–ç ï¼Œé›†åˆç±»å‹è‡ªåŠ¨è½¬æ¢</li>
<li><strong>å¼‚å¸¸ä¼ é€’</strong>ï¼šKotlin å¼‚å¸¸ â†’ Wasm Exception Handling Proposalï¼ˆé¿å… fatal abortï¼‰</li>
</ul>
<h3 data-id="heading-5">4. å·¥å…·é“¾ä¸å¼€å‘è€…ä½“éªŒ</h3>
<ul>
<li><strong>Gradle æ’ä»¶å¢å¼º</strong>ï¼š
<pre><code class="hljs language-gradle" lang="gradle">kotlin {
    wasm("wasmBrowser") {
        browser()
        binaries.executable() // ç”Ÿæˆ .wasm + .js èƒ¶æ°´
    }
}
</code></pre>
</li>
<li><strong>è°ƒè¯•æ”¯æŒ</strong>ï¼šSource Map æ˜ å°„è‡³ Kotlin æºç ï¼ŒChrome DevTools ç›´æ¥æ–­ç‚¹è°ƒè¯•</li>
<li><strong>æ€§èƒ½åˆ†æ</strong>ï¼šé›†æˆ Wasm Profilerï¼Œå¯è§†åŒ–åç¨‹è°ƒåº¦ä¸å†…å­˜åˆ†é…çƒ­ç‚¹</li>
</ul>
<hr/>
<h2 data-id="heading-6">ä¸‰ã€å®æˆ˜ä»·å€¼ï¼šä½•æ—¶é€‰æ‹© Kotlin/Wasmï¼Ÿ</h2>
<p>âœ… <strong>æ¨èåœºæ™¯</strong></p>
<ul>
<li>æ¸¸æˆå¼•æ“é€»è¾‘ï¼ˆGodot æ’ä»¶ã€WebGL æ¸²æŸ“åç«¯ï¼‰</li>
<li>éŸ³è§†é¢‘ç¼–è§£ç ï¼ˆFFmpeg Kotlin å°è£…ï¼‰</li>
<li>åŠ å¯†/åŒºå—é“¾è®¡ç®—ï¼ˆæ•æ„Ÿé€»è¾‘éš”ç¦»æ‰§è¡Œï¼‰</li>
<li>KMP å…±äº«ä¸šåŠ¡é€»è¾‘ï¼ˆç§»åŠ¨ç«¯ + Web é«˜æ€§èƒ½æ¨¡å—ç»Ÿä¸€ï¼‰</li>
</ul>
<p>âŒ <strong>æš‚ä¸é€‚ç”¨</strong></p>
<ul>
<li>ç®€å• DOM æ“ä½œï¼ˆKotlin/JS æ›´è½»é‡ï¼‰</li>
<li>é‡åº¦ä¾èµ–æµè§ˆå™¨ API çš„åº”ç”¨ï¼ˆéœ€ç­‰å¾… Wasm Interface Types æ™®åŠï¼‰</li>
<li>ä½é…è®¾å¤‡ï¼ˆWasm GC æµè§ˆå™¨æ”¯æŒéœ€ Chromium 119+ / Firefox 115+ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-7">å››ã€æŒ‘æˆ˜ä¸ç¤¾åŒºæ¼”è¿›</h2>

























<table><thead><tr><th>æŒ‘æˆ˜</th><th>åº”å¯¹è·¯å¾„ï¼ˆJetBrains ç¤¾åŒºåŠ¨æ€ï¼‰</th></tr></thead><tbody><tr><td><strong>æµè§ˆå™¨æ”¯æŒç¢ç‰‡åŒ–</strong></td><td>æä¾›é™çº§æ–¹æ¡ˆï¼šWasm æ¨¡å— + Kotlin/JS å›é€€</td></tr><tr><td><strong>è°ƒè¯•ä½“éªŒå¾…ä¼˜åŒ–</strong></td><td>ä¸ Chrome DevTools å›¢é˜Ÿåˆä½œå¢å¼º Source Map æ”¯æŒ</td></tr><tr><td><strong>ç”Ÿæ€åº“è¿ç§»</strong></td><td>kotlinx-wasm æ ‡å‡†åº“æ‰©å±•ï¼ˆåç¨‹ã€åºåˆ—åŒ–ä¸“é¡¹ä¼˜åŒ–ï¼‰</td></tr><tr><td><strong>æ„å»ºä½“ç§¯</strong></td><td>Tree-shaking æ·±åº¦ä¼˜åŒ– + æŒ‰éœ€åŠ è½½æ¨¡å—</td></tr></tbody></table>
<blockquote>
<p>ğŸŒ ç¤¾åŒºåŠ¨æ€ï¼šKotlin/Wasm å·²åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FJetBrains%2Fkotlin-wasm-showcase" target="_blank" title="https://github.com/JetBrains/kotlin-wasm-showcase" ref="nofollow noopener noreferrer">kotlin-wasm-showcase</a> æä¾›å›¾åƒæ»¤é•œã€ç‰©ç†å¼•æ“ç­‰ Demoï¼›Compose Multiplatform æœªæ¥æˆ–æ”¯æŒ Wasm æ¸²æŸ“åç«¯ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-8">äº”ã€ç»“è¯­ï¼šä¸æ­¢äºâ€œç¼–è¯‘åˆ° Wasmâ€</h2>
<p>Kotlin å¯¹ WebAssembly çš„æ‹¥æŠ±ï¼Œæœ¬è´¨æ˜¯ <strong>â€œç”¨å·¥ç¨‹åŒ–æ€ç»´é‡æ„ Web æ€§èƒ½è¾¹ç•Œâ€</strong>ï¼š</p>
<ul>
<li>å¯¹å¼€å‘è€…ï¼šä¿ç•™ Kotlin çš„ç©ºå®‰å…¨ã€åç¨‹ç­‰ç”Ÿäº§åŠ›ç‰¹æ€§ï¼Œæ— ç¼åˆ‡å…¥é«˜æ€§èƒ½åœºæ™¯</li>
<li>å¯¹ç”Ÿæ€ï¼šå¼ºåŒ– Kotlin Multiplatform â€œä¸€æ¬¡ç¼–å†™ï¼Œå…¨ç«¯é«˜æ€§èƒ½è¿è¡Œâ€çš„æ„¿æ™¯</li>
<li>å¯¹è¡Œä¸šï¼šæ¨åŠ¨ Wasm ä»â€œC/Rust ä¸“å±â€èµ°å‘ä¸»æµ JVM è¯­è¨€å‹å¥½ç”Ÿæ€</li>
</ul>
<blockquote>
<p>ğŸ“Œ <strong>è¡ŒåŠ¨å»ºè®®</strong>ï¼š</p>
<ol>
<li>å…³æ³¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.jetbrains.com%2Fkotlin%2F" target="_blank" title="https://blog.jetbrains.com/kotlin/" ref="nofollow noopener noreferrer">Kotlin Blog</a> çš„ Wasm ä¸“é¢˜</li>
<li>å°è¯• Kotlin 1.9.20+ çš„å®éªŒæ€§ <code>wasm</code> ç›®æ ‡ï¼ˆéœ€å¯ç”¨ <code>-Xwasm-enable</code>ï¼‰</li>
<li>å‚ä¸ kotlinx-wasm ç¤¾åŒºè®¨è®ºï¼Œè´¡çŒ®ç”¨ä¾‹ä¸åé¦ˆ</li>
</ol>
</blockquote>
<p>æŠ€æœ¯æ¼”è¿›ä»æ— å¦é€”ï¼Œä½†å½“ Kotlin çš„ä¼˜é›…ä¸ WebAssembly çš„é”‹èŠ’ç›¸é‡ï¼Œæˆ‘ä»¬æ­£ç«™åœ¨ä¸‹ä¸€ä»£å…¨æ ˆå¼€å‘çš„é—¨æ§›ä¸Šã€‚ä¿æŒå¥½å¥‡ï¼Œç†æ€§æœŸå¾…â€”â€”çœŸæ­£çš„ 2.2.20 æ—¶ä»£ï¼Œå€¼å¾—æ¯ä¸€ä½ Kotlin å¼€å‘è€…å…±åŒå¡‘é€ ã€‚</p>
<blockquote>
<p>ğŸ“Œ <strong>è½¬è½½æé†’</strong>ï¼š<br/>
æœ¬æ–‡æœ€æ—©å‘å¸ƒäº<a href="https://link.juejin.cn?target=https%3A%2F%2Fmake.dxmwl.com%2F" target="_blank" title="https://make.dxmwl.com/" ref="nofollow noopener noreferrer">ç å®¢</a><br/>
æ–‡ç« åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmake.dxmwl.com%2Fp%2F67" target="_blank" title="https://make.dxmwl.com/p/67" ref="nofollow noopener noreferrer">make.dxmwl.com/p/67</a><br/>
è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼Œå¹¶ä¸ä½œè€…è¿›è¡Œè”ç³»</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[3. iOSå¼€å‘ä¸­ä½¿ç”¨atomicï¼Œæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7603185231802564634</link>    <guid>https://juejin.cn/post/7603185231802564634</guid>    <pubDate>2026-02-05T18:22:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603185231802564634" data-draft-id="7603185231802548250" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="3. iOSå¼€å‘ä¸­ä½¿ç”¨atomicï¼Œæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ"/> <meta itemprop="keywords" content="iOS"/> <meta itemprop="datePublished" content="2026-02-05T18:22:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="iOSåœ¨å…¥é—¨"/> <meta itemprop="url" content="https://juejin.cn/user/4037062426627758"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            3. iOSå¼€å‘ä¸­ä½¿ç”¨atomicï¼Œæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4037062426627758/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    iOSåœ¨å…¥é—¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T18:22:52.000Z" title="Thu Feb 05 2026 18:22:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    13
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å€ŸåŠ©AIè¾…åŠ©ã€‚</p>
</blockquote>
<h3 data-id="heading-0">1. æ ¸å¿ƒç»“è®º</h3>
<p><strong>åœ¨ iOS å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å‡ ä¹æ€»æ˜¯ä½¿ç”¨ <code>nonatomic</code>ï¼Œæå°‘ä½¿ç”¨ <code>atomic</code>ã€‚</strong></p>
<p>ä½¿ç”¨ <code>atomic</code> å­˜åœ¨ä¸¤ä¸ªä¸»è¦é—®é¢˜ï¼š</p>
<ol>
<li><strong>æ€§èƒ½æŸè€—</strong>ï¼š<code>atomic</code> ä¼šåœ¨ setter/getter æ–¹æ³•ä¸­åŠ é”ï¼Œé¢‘ç¹è®¿é—®æ—¶ä¼šä¸¥é‡æ‹–æ…¢æ€§èƒ½ã€‚</li>
<li><strong>è™šå‡çš„çº¿ç¨‹å®‰å…¨</strong>ï¼š<code>atomic</code> åªèƒ½ä¿è¯å±æ€§çš„<strong>è¯»å†™æ“ä½œï¼ˆAccessorsï¼‰<strong>æ˜¯åŸå­çš„ï¼Œä½†</strong>ä¸èƒ½ä¿è¯å¯¹è±¡çš„æ“ä½œé€»è¾‘</strong>æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-1">2. æ·±åº¦è§£æï¼šä¸ºä»€ä¹ˆè¯´å®ƒæ˜¯â€œè™šå‡â€çš„çº¿ç¨‹å®‰å…¨ï¼Ÿ</h3>
<p><code>atomic</code> ä¿è¯çš„æ˜¯ï¼šå½“ä¸€ä¸ªçº¿ç¨‹åœ¨å†™æ•°æ®ï¼ˆSetterï¼‰æ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹æ— æ³•åŒæ—¶å»å†™ï¼Œä¹Ÿæ— æ³•åŒæ—¶å»è¯»ï¼ˆGetterï¼‰ã€‚å®ƒä¿è¯äº†ä½ è¯»åˆ°çš„æ•°æ®è¦ä¹ˆæ˜¯â€œä¿®æ”¹å‰â€çš„ï¼Œè¦ä¹ˆæ˜¯â€œä¿®æ”¹åâ€çš„ï¼Œä¸ä¼šè¯»åˆ°â€œå†™äº†ä¸€åŠâ€çš„è„æ•°æ®ã€‚</p>
<p><strong>ä½†æ˜¯ï¼å®ƒä¸ç®¡åç»­çš„æ“ä½œã€‚</strong></p>
<p><strong>ä¸¾ä¸ªä¾‹å­ï¼š</strong>
å‡è®¾ä½ æœ‰ä¸€ä¸ª <code>atomic</code> çš„æ•°ç»„å±æ€§ <code>self.dataArray</code>ã€‚</p>
<pre><code class="hljs language-objective-c" lang="objective-c">@property (atomic, strong) NSMutableArray *dataArray;
</code></pre>
<p><strong>åœºæ™¯ï¼š</strong> çº¿ç¨‹ A åœ¨è¯»å–æ•°ç»„çš„ç¬¬ 0 ä¸ªå…ƒç´ ï¼Œçº¿ç¨‹ B åŒæ—¶åœ¨æ¸…ç©ºæ•°ç»„ã€‚</p>
<pre><code class="hljs language-objective-c" lang="objective-c">// çº¿ç¨‹ A
id obj = [self.dataArray objectAtIndex:0]; 

// çº¿ç¨‹ B
[self.dataArray removeAllObjects];
</code></pre>
<p><strong>ç»“æœï¼š</strong> ä¾ç„¶ä¼šå´©æºƒï¼ˆCrashï¼‰ã€‚</p>
<p><strong>åŸå› ï¼š</strong></p>
<ul>
<li><code>[self.dataArray]</code> è¿™ä¸ªè¯»å–æ“ä½œæ˜¯åŸå­çš„ï¼ˆå®‰å…¨çš„ï¼‰ï¼Œä½ ç¡®å®æ‹¿åˆ°äº†æ•°ç»„å¯¹è±¡ã€‚</li>
<li>ä½†æ˜¯åœ¨ä½ æ‹¿åˆ°æ•°ç»„åï¼Œç´§æ¥ç€è°ƒç”¨ <code>objectAtIndex:0</code> æ—¶ï¼Œçº¿ç¨‹ B å¯èƒ½åˆšå¥½æŠŠæ•°ç»„æ¸…ç©ºäº†ã€‚</li>
<li><code>atomic</code> é”ä¸ä½ <code>objectAtIndex:</code> å’Œ <code>removeAllObjects</code> è¿™äº›æ–¹æ³•è°ƒç”¨ã€‚å®ƒåªç®¡ <code>self.dataArray = ...</code> (setter) å’Œ <code>... = self.dataArray</code> (getter)ã€‚</li>
</ul>
<p><strong>ç»“è®ºï¼š</strong> è¦æƒ³çœŸæ­£å®ç°çº¿ç¨‹å®‰å…¨ï¼Œä½ éœ€è¦ä½¿ç”¨æ›´é«˜å±‚çº§çš„é”ï¼ˆå¦‚ <code>@synchronized</code>, <code>NSLock</code>, <code>dispatch_semaphore</code> æˆ–ä¸²è¡Œé˜Ÿåˆ—ï¼‰æ¥åŒ…è£¹ä½æ•´æ®µé€»è¾‘ä»£ç ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¾èµ–å±æ€§çš„ <code>atomic</code>ã€‚</p>
<hr/>
<h3 data-id="heading-2">3. æ€§èƒ½é—®é¢˜ï¼ˆåº•å±‚å®ç°ï¼‰</h3>
<p><code>atomic</code> çš„åº•å±‚å®ç°å¤§è‡´å¦‚ä¸‹ï¼ˆä¼ªä»£ç ï¼‰ï¼š</p>
<pre><code class="hljs language-objective-c" lang="objective-c">- (void)setName:(NSString *)name {
    // è‡ªåŠ¨åŠ é”
    [self.internalLock lock];
    _name = name;
    [self.internalLock unlock];
}

- (NSString *)name {
    // è‡ªåŠ¨åŠ é”
    [self.internalLock lock];
    NSString *result = [[_name retain] autorelease];
    [self.internalLock unlock];
    return result;
}
</code></pre>
<p>æ¯æ¬¡è®¿é—®å±æ€§éƒ½è¦ç»å† <code>lock</code> -&gt; <code>unlock</code> çš„è¿‡ç¨‹ã€‚åœ¨ UI æ¸²æŸ“æˆ–é«˜é¢‘è®¡ç®—ç­‰å¯¹æ€§èƒ½æ•æ„Ÿçš„åœºæ™¯ä¸‹ï¼Œè¿™ç§å¼€é”€æ˜¯ä¸å¯æ¥å—çš„ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ<code>nonatomic</code> ç›´æ¥è®¿é—®å†…å­˜ï¼Œé€Ÿåº¦å¿«å¾—å¤šã€‚</p>
<hr/>
<h3 data-id="heading-3">4. ä»€ä¹ˆæ—¶å€™çœŸæ­£éœ€è¦ç”¨ atomicï¼Ÿ</h3>
<p>è™½ç„¶å¾ˆå°‘ï¼Œä½†ä¹Ÿä¸æ˜¯å®Œå…¨æ²¡æœ‰ã€‚</p>
<ul>
<li>å¦‚æœä½ å¼€å‘çš„ä¸æ˜¯ Appï¼Œè€Œæ˜¯ä¸€ä¸ª<strong>ç¬¬ä¸‰æ–¹ SDK</strong> æˆ– <strong>åº•å±‚åº“</strong>ã€‚</li>
<li>å¹¶ä¸”ä½ ç¡®å®šè¯¥å±æ€§ä»…ä»…æ˜¯ä¿å­˜ä¸€ä¸ªç®€å•çš„å€¼ï¼ˆæ¯”å¦‚ä¸€ä¸ªæ•´æ•°é…ç½®é¡¹ï¼Œæˆ–è€…ä¸€ä¸ªæŒ‡é’ˆï¼‰ï¼Œä¸æ¶‰åŠå¤æ‚çš„é›†åˆæ“ä½œæˆ–é€»è¾‘ä¾èµ–ã€‚</li>
<li>æ­¤æ—¶ä¸ºäº†é˜²æ­¢å¤–éƒ¨è°ƒç”¨è€…åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è¯»åˆ°è„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ <code>atomic</code> ä½œä¸ºä¸€ç§å…œåº•çš„é˜²æŠ¤æ‰‹æ®µã€‚</li>
</ul>
<h3 data-id="heading-4">å‚è€ƒæ–‡ç« </h3>
<ol>
<li><a href="https://juejin.cn/post/6844903748997758983?searchId=202602061058580880844DB6A443C7B232" target="_blank" title="https://juejin.cn/post/6844903748997758983?searchId=202602061058580880844DB6A443C7B232">å…³äºIOS å±æ€§atomicï¼ˆåŸå­æ€§ï¼‰çš„ç†è§£</a></li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¢«AIå‘äº†3æ¬¡åï¼Œæˆ‘ç»ˆäºå­¦ä¼šç”¨Gitæ•‘å‘½]]></title>    <link>https://juejin.cn/post/7603185231802449946</link>    <guid>https://juejin.cn/post/7603185231802449946</guid>    <pubDate>2026-02-05T16:06:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603185231802449946" data-draft-id="7602965400810176562" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¢«AIå‘äº†3æ¬¡åï¼Œæˆ‘ç»ˆäºå­¦ä¼šç”¨Gitæ•‘å‘½"/> <meta itemprop="keywords" content="GitHub"/> <meta itemprop="datePublished" content="2026-02-05T16:06:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·54881731631"/> <meta itemprop="url" content="https://juejin.cn/user/3625533074849658"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¢«AIå‘äº†3æ¬¡åï¼Œæˆ‘ç»ˆäºå­¦ä¼šç”¨Gitæ•‘å‘½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3625533074849658/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·54881731631
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T16:06:56.000Z" title="Thu Feb 05 2026 16:06:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸš€ Git + GitHub + VSCode é›¶åŸºç¡€ä¿å§†çº§å…¥é˜ŸæŒ‡å—</h2>
<h3 data-id="heading-1">å¼•è¨€ï¼šAIç¼–ç¨‹çš„æ•‘å‘½ç¨»è‰â€”â€”Git</h3>
<blockquote>
<p>åŒå­¦ï¼Œä½ å¯èƒ½åœ¨æƒ³ï¼šâ€œgitæ˜¯ä»€ä¹ˆ æˆ‘ä»¬æ˜¯å†™ä»£ç çš„ ä¸ºä»€ä¹ˆè¦å®‰è£…è¿™ä¸ªä¸œè¥¿ï¼Ÿâ€</p>
<p><strong>å›ç­”</strong>ï¼šå› ä¸ºæˆ‘ä»¬æ˜¯AIç¼–ç¨‹ï¼ŒAIæœ‰æ—¶å€™â€œå‘ç¥ç»â€ä¼šæŠŠä½ çš„é¡¹ç›®æ”¹çš„ä¸‘ä¸æ‹‰å‡  æ— æ³•è¿è¡Œ æ”¹çš„åœ°æ–¹å¤ªå¤šäº†åˆä¸å¥½æ’¤å› è¿™æ˜¯æˆ‘çš„çœŸå®ç»å† ï¼š</p>
</blockquote>
<p><strong>çœŸå®æ•…äº‹</strong>ï¼šæˆ‘ä¹‹å‰ç”¨Trae AIæ”¹ä»£ç ï¼Œä¼˜åŒ–æˆ‘ä»¬çš„é—®å·ç½‘é¡µçš„æ—¶å€™ã€‚æˆ‘ä¸€æ¬¡æ€§å·´æ‹‰å·´æ‹‰è¾“å‡ºäº†5ä¸ªéœ€æ±‚ã€‚æµ‹è¯•ä¸€ä¸‹è¿™ä¸ªçš„èƒ½åŠ›ä¸Šé™ã€‚<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62f1c992e89349a680ad2c98662d4812~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=BMX2a4FGW%2FVJl2AZLEBpDnNpNnM%3D" alt="æˆ‘æäº†5ä¸ªéœ€æ±‚çœ‹Traeèƒ½ä¸èƒ½ä¸€æ¬¡æ€§å®Œæˆ" loading="lazy"/>
æˆ‘å½“æ—¶å…´å†²å†²åœ°æ‰“å¼€ç½‘é¡µï¼Œç»“æœç½‘é¡µä¸ä»…ä¸‘ä¸æ‹‰å‡ è¿˜çªç„¶è¿è¡Œä¸äº†äº†ï¼Œæ°”æ­»æˆ‘äº†ã€‚æˆ‘å½“æ—¶è¿˜æ‰‹è´±åœ¨ç¼–è¾‘å™¨é‡Œæƒ³ä¿®æ”¹ä¸€ä¸‹ï¼Œç„¶åè¿˜ç‚¹å‡»äº†ç¡®è®¤ã€‚æ— æ•Œäº†
<strong>å¹¸å¥½æˆ‘ä¹‹å‰å¬äº†aiçš„å»ºè®®å…ˆè£…äº†Git</strong>ï¼Œä¸€æ¡å‘½ä»¤æŠŠä»£ç æ¢å¤åˆ°ä¹‹å‰æ­£å¸¸çš„çŠ¶æ€ã€‚å¦‚æœæ²¡æœ‰Gitï¼Œæˆ‘ä»¬è¿™ä¸ªé¡¹ç›®å¯èƒ½åŸåœ°è§£æ•£äº†å“ˆå“ˆ
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/194addbcdb86466aacd85a41963ba24e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=k2J%2Byo2hq0GauLhP1eCbixt2w9c%3D" alt="å›é€€ç‰ˆæœ¬" loading="lazy"/></p>
<p><strong>è¿™å°±æ˜¯Gitçš„ä½œç”¨</strong>ï¼šä»£ç çš„â€œæ—¶å…‰æœºâ€å’Œâ€œåæ‚”è¯â€ã€‚</p>
<h4 data-id="heading-2">Git vs GitHubï¼šå®ƒä»¬æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ</h4>























<table><thead><tr><th>å·¥å…·</th><th>æ˜¯ä»€ä¹ˆï¼Ÿ</th><th>ä½œç”¨</th><th>ç±»æ¯”</th></tr></thead><tbody><tr><td><strong>Git</strong></td><td>ç‰ˆæœ¬æ§åˆ¶è½¯ä»¶ï¼ˆèåˆåˆ°ä½ çš„å‘½ä»¤è¡Œé‡Œé¢å»ï¼‰</td><td>è®°å½•æ¯æ¬¡ä»£ç ä¿®æ”¹ï¼Œå¯ä»¥éšæ—¶å›åˆ°ä½ æäº¤è¿‡çš„å†å²ç‰ˆæœ¬</td><td>å°±åƒç©æ¸¸æˆçš„â€œå­˜æ¡£â€ä¸€æ ·ï¼Œè¿™ä¸ªæ¡£æ‰“åºŸäº†å¯ä»¥è¯»æ¡£</td></tr><tr><td><strong>GitHub</strong></td><td>ä»£ç æ‰˜ç®¡å¹³å°ï¼ˆç½‘ç«™ï¼Œå…è´¹çš„ä»£ç äº‘ç«¯å­˜å‚¨åº“ï¼‰</td><td>1. å¤‡ä»½ä½ çš„ä»£ç åˆ°äº‘ç«¯ï¼Œæ°¸ä¸ä¸¢å¤±<br/>2. å¤šäººåä½œï¼Œåˆå¹¶ä»£ç <br/>3. å±•ç¤ºä½ çš„é¡¹ç›®ï¼ˆç®€å†é‡Œæ”¾ä¸ªé¡¹ç›®é‚£ä¸æ˜¯nb?(doge)ï¼‰</td><td>å°±åƒä»£ç çš„â€œç½‘ç›˜+æœ‹å‹åœˆâ€</td></tr></tbody></table>
<p><strong>æ ¸å¿ƒæ¯”å–»</strong>ï¼š</p>
<ul>
<li><strong>Git</strong> = ä½ ç”µè„‘ä¸Šçš„â€œå­˜æ¡£è½¯ä»¶â€ï¼ˆæƒ³è¦å­˜æ¡£çš„æ—¶å€™3è¡Œå‘½ä»¤å°±è¡Œäº†ï¼‰</li>
<li><strong>GitHub</strong> = æŠŠâ€œå­˜æ¡£â€è¿‡çš„è®°å½•ä¸Šä¼ åˆ°äº‘ç«¯ï¼ˆå¤‡ä»½+åä½œï¼‰</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆå¿…é¡»ç”¨ï¼Ÿ</strong></p>
<ol>
<li><strong>é˜²AIå‘ç¥ç»</strong>ï¼šAIæ”¹ä»£ç æŠŠé¡¹ç›®æ”¹åäº†ï¼Œä¸€é”®æ¢å¤</li>
<li><strong>é˜²æ‰‹æ®‹</strong>ï¼šè‡ªå·±æ”¹é”™äº†ï¼Œä¸€é”®æ¢å¤</li>
<li><strong>å›¢é˜Ÿåä½œ</strong>ï¼šå››ä¸ªäººåŒæ—¶æ”¹ä»£ç ï¼Œè‡ªåŠ¨åˆå¹¶ï¼Œä¸ä¼šäº’ç›¸è¦†ç›–</li>
<li><strong>ä»£ç å¤‡ä»½</strong>ï¼šç”µè„‘åäº†ã€ä¸¢äº†ï¼Œä»£ç éƒ½åœ¨äº‘ç«¯</li>
</ol>
<hr/>
<h3 data-id="heading-3">ç¬¬ä¸€ç« ï¼šæ³¨å†ŒGitHubè´¦å·ï¼ˆç”µè„‘ç‰ˆå…¨æµç¨‹ï¼‰</h3>
<h4 data-id="heading-4">1.1 ä¸ºä»€ä¹ˆå…ˆæ³¨å†ŒGitHubï¼Ÿ</h4>
<p>å› ä¸ºæˆ‘ä»¬è¦æŠŠä»£ç å­˜åˆ°äº‘ç«¯ï¼Œéœ€è¦å…ˆæœ‰ä¸ªè´¦æˆ·ã€‚GitHubæ˜¯å…¨çƒæœ€å¤§çš„ä»£ç æ‰˜ç®¡å¹³å°ï¼Œä¹Ÿæ˜¯ç¨‹åºå‘˜çš„â€œç¤¾äº¤ç½‘ç»œâ€ã€‚</p>
<h4 data-id="heading-5">1.2 æ³¨å†Œæ­¥éª¤ï¼ˆæ¯ä¸ªæ­¥éª¤éƒ½éœ€è¦æˆªå›¾ï¼ï¼‰</h4>
<p><strong>æ­¥éª¤1ï¼šæ‰“å¼€GitHubå®˜ç½‘</strong>ï¼ˆéœ€è¦æ¢¯å­ ç„¶åæœ€å¥½æœ‰ä¸€ä¸ªç¿»è¯‘çš„æ’ä»¶ å¤–å›½ç½‘ç«™ é™¤éä½ çš„è‹±æ–‡ç‰¹åˆ«å¥½ ä¸ç„¶è¿˜æ˜¯ç¿»è¯‘ä¸€ä¸‹ è¿™æ˜¯æˆ‘ç”¨çš„ edgeæ’ä»¶å•†åº—é‡Œæœä¸€ä¸‹å°±è¡Œäº†ï¼‰ <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12449694e8f9492b918a8c5575c4c636~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=UmOixH50s0u1Fzosovq2U7ra0Jg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<ul>
<li><strong>ç½‘å€</strong>ï¼š<code>https://github.com</code> æŠŠä½ çš„é‚®ç®±å¡«è¿›å»ï¼ˆå¸¸ç”¨çš„ qqé‚®ç®±å°±è¡Œï¼‰
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9a0e908c3a7349829c4324b9d4af6987~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=gnfFvZan%2BdoIQmQThBkzcHuBXiE%3D" alt="githubå®˜ç½‘" loading="lazy"/></li>
</ul>
<p><strong>æ­¥éª¤2ï¼šç‚¹å‡»â€œSign upåå¡«å†™ä¿¡æ¯â€</strong></p>
<ul>
<li>ã€é…å›¾2ã€‘ç‚¹å‡»åçš„æ³¨å†Œé¡µé¢æˆªå›¾
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a1d244a5b0234322b06172f8af0ee2c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=e6aod28%2FDRzQQpK13O0nvAegHc0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
ç‚¹å‡»â€œCreate accountâ€</li>
</ul>
<p>tips:ç”¨æˆ·åä¸è¦å¤ªæŠ½è±¡å“ˆå“ˆ Hrå¯èƒ½ä¼šçœ‹
âœ”ï¸ æ¥æ”¶äº§å“æ›´æ–°ï¼ˆå¯é€‰ï¼‰
<strong>æ­¥éª¤3ï¼šäººæœºéªŒè¯</strong>
6é“å˜æ€çš„äººæœºéªŒè¯é¢˜ç›®ï¼ˆæˆ‘çš„æ˜¯è¿çº¿é¢˜ç›®)</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5d22b3813da40a1a362d8e7892d054f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=XHcPJFguaVhHudBMOpVC%2B3LHyQQ%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ç„¶ågithubä¼šç»™ä½ çš„é‚®ç®±å‘ä¸€ä¸ªéªŒè¯ç  å¡«å…¥å°±è¡Œäº† è¿›å…¥ä½ çš„é‚®ç®±</p>
<p><strong>æ­¥éª¤4ï¼šå®Œæˆæ³¨å†Œ</strong>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2cda9c012f1f4298808676fd9378f6c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=NZX3oc2cyr5emFp%2BibZKF%2BKfG3M%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p><strong>é‡è¦æç¤º</strong>ï¼š</p>
<ul>
<li>âœ… æ³¨å†Œå<strong>ç«‹å³ç™»å½•ä¸€æ¬¡</strong>ï¼Œç¡®è®¤æˆåŠŸ</li>
<li>âœ… æŠŠç”¨æˆ·åå’Œå¯†ç è®°åœ¨æ‰‹æœºå¤‡å¿˜å½•</li>
<li>âœ… é˜Ÿå‹é—´äº’ç›¸åŠ å¥½å‹ï¼ˆåé¢æ•™ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-6">ç¬¬äºŒç« ï¼šå®‰è£…Gitï¼ˆWindows/MacåŒç‰ˆæœ¬ï¼‰</h3>
<h4 data-id="heading-7">2.1 å®‰è£…Gitçš„ç›®çš„</h4>
<p>Gitæ˜¯è¿è¡Œåœ¨ä½ ç”µè„‘ä¸Šçš„â€œå‘½ä»¤è¡Œå­˜æ¡£è½¯ä»¶â€ï¼Œåªæœ‰å®‰è£…äº†Gitï¼Œæ‰èƒ½ä½¿ç”¨GitHubçš„äº‘ç«¯åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-8">2.2 Windowsç”¨æˆ·å®‰è£…æ­¥éª¤</h4>
<p><strong>æ­¥éª¤1ï¼šä¸‹è½½Git</strong></p>
<ul>
<li><strong>ç½‘å€</strong>ï¼š<code>https://git-scm.com/download/win</code>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c70ae7df05f4415c8ca5abc9f4d93595~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=gRsXCGveCsrpNuWKD5pSwTTto8Q%3D" alt="" loading="lazy"/>
å°±è¿™ç¬¬ä¸€ä¸ª çœ‹ä½ ç”µè„‘ ä¸€èˆ¬éƒ½æ˜¯x64 æœ€æ–°ç‰ˆçš„</li>
</ul>
<p><strong>æ­¥éª¤2ï¼šè¿è¡Œå®‰è£…ç¨‹åº</strong>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92e03341206045feae07b9aed9c2aec0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=vxmX0DN7evWZCxp0OOUNhwIDTYI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p><strong>æ­¥éª¤3ï¼šé€‰æ‹©å®‰è£…ä½ç½®</strong></p>
<ul>
<li>é»˜è®¤Cç›˜å³å¯ï¼Œç‚¹Next</li>
</ul>
<p><strong>æ­¥éª¤4ï¼šé€‰æ‹©ç»„ä»¶ï¼ˆï¼‰</strong></p>
<pre><code class="hljs">è¿™ä¸ªä¹Ÿé»˜è®¤å°±è¡Œ

</code></pre>
<p><strong>æ­¥éª¤5ï¼šå…¶ä»–è®¾ç½®</strong></p>
<ul>
<li>ä¸€è·¯Nextï¼Œéƒ½ç”¨é»˜è®¤è®¾ç½®</li>
<li>æœ€åç‚¹Install</li>
</ul>
<p><strong>æ­¥éª¤6ï¼šéªŒè¯å®‰è£…</strong></p>
<ul>
<li>
<p>æŒ‰<code>Win + R</code>ï¼Œè¾“å…¥<code>cmd</code>å›è½¦
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f23dd4d133274c85ab2c11b905cd2832~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=F7FdBqh4MvnfdJp4u6OeLE2AmXI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
</li>
<li>
<p>è¾“å…¥<code>git --version</code>ï¼ˆæ³¨æ„æœ‰ä¸ªç©ºæ ¼ï¼‰</p>
</li>
<li>
<p>çœ‹åˆ°ç‰ˆæœ¬å·å°±æˆåŠŸäº†ï¼
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6baf4fb2894746179afd94c26fd8a9a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=MbD4hLkRcvm9N15zRn5MOKCqqag%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
</li>
</ul>
<hr/>
<h3 data-id="heading-9">ç¬¬å››ç« ï¼šè¿æ¥Gitå’ŒGitHubï¼ˆå…³é”®ï¼ï¼‰</h3>
<h4 data-id="heading-10">4.1 é…ç½®Gitç”¨æˆ·ä¿¡æ¯ï¼ˆä¸€æ¬¡æ€§ï¼‰</h4>
<ul>
<li>æ‰“å¼€ç»ˆç«¯ï¼ˆWindowsç”¨CMDï¼‰ï¼ˆvscodeé‡Œé¢çš„ç»ˆç«¯ä¹Ÿè¡Œï¼‰</li>
<li>è¾“å…¥ä»¥ä¸‹ä¸¤è¡Œå‘½ä»¤ï¼ˆç»¿è‰²çš„å­—æ›¿æ¢æˆä½ çš„ä¿¡æ¯ï¼‰ï¼š</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">git config --global user.name <span class="hljs-string">"ä½ çš„GitHubç”¨æˆ·å"</span>
git config --global user.email <span class="hljs-string">"ä½ çš„GitHubæ³¨å†Œé‚®ç®±"</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ec07cdb19db4b77a6e9f9c7e7a545fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=545pAE0m%2BndMdaaF1x6ZGfet7Ss%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
ï¼ˆä¸¤è¡Œåˆ†å¼€è¾“å…¥ ä¸ç„¶å°±ä¼šæŠ¥é”™
gitåªè®¤è¯†ä¸€è¡Œå‘½ä»¤ï¼‰</p>
<h4 data-id="heading-11">4.2 ç»™Git æŒ‚è½½ä»£ç†</h4>
<p>ã€åŸå› ã€‘git é»˜è®¤ä¸ä¼šèµ°æ¢¯å­ å¾—å‘Šè¯‰ä»–èµ°è¿™ä¸ªæ¢¯å­</p>
<ul>
<li>åŠ¨ä½œï¼šåœ¨ç»ˆç«¯è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼ˆå‘Šè¯‰ Git èµ° 7890 é€šé“ï¼‰ï¼š
ã€ç«¯å£å°±æ˜¯æ¢¯å­é…ç½®çš„ç«¯å£ é»˜è®¤éƒ½æ˜¯7890ã€‘</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">git config --global http.proxy http://127.0.0.1:7890
</code></pre>
<hr/>
<h3 data-id="heading-12">ç¬¬äº”ç« ï¼šå¯ä»¥éƒ¨ç½²ä¸€ä¸ªçš„githubçš„é¡¹ç›®</h3>
<h4 data-id="heading-13">5.1 è¿™æ˜¯æˆ‘ä»¬å›¢é˜Ÿçš„åšçš„ä¸€ä¸ªé—®å·ç½‘ç«™çš„é¡¹ç›® ä½ ä»¬å¯ä»¥å°è¯•éƒ¨ç½²è¿™ä¸ªä½œä¸ºç»ƒä¹ </h4>
<p>ç½‘å€ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">https:<span class="hljs-comment">//github.com/hhh-dahah/CyberTCM.git</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/860152143bfe4dae9b8ba67c4fca2526~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=UXmLsfTZ%2BGFdFwuMBCdCosoOnOo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-14">5.2 å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°</h4>
<p><strong>æ­¥éª¤1ï¼šé€‰æ‹©å­˜æ”¾ä½ç½®</strong></p>
<ul>
<li>å»ºè®®æ”¾æ¡Œé¢æˆ–Dç›˜ï¼Œè·¯å¾„ä¸è¦æœ‰ä¸­æ–‡</li>
</ul>
<p><strong>æ­¥éª¤2ï¼šç”¨VS Codeå…‹éš†</strong></p>
<ol>
<li>
<p>æ‰“å¼€VS Code</p>
</li>
<li>
<p>æŒ‰<code>Ctrl+Shift+P</code></p>
</li>
<li>
<p>è¾“å…¥â€œGit: Cloneâ€</p>
</li>
<li>
<p>ç²˜è´´é¡¹ç›®åœ°å€ ï¼ˆæˆ‘ä¸Šé¢ç»™çš„ç½‘å€ï¼‰
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/081a6d1f0e0b432d8a81e04a6a15ecd9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=HIDv0E3OFexNg6JpBvJig6rXOgY%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
</li>
<li>
<p>é€‰æ‹©å­˜æ”¾æ–‡ä»¶å¤¹ <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8aaee337fd874cf9bbcf364201c9bb2c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=f4aF7CPlrP9XCI%2BrBLsPNhcyABE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
</li>
</ol>
<p><strong>æ­¥éª¤3ï¼šæ‰“å¼€é¡¹ç›®</strong></p>
<ul>
<li>å…‹éš†å®Œæˆåï¼ŒVS Codeä¼šæç¤ºæ‰“å¼€</li>
<li>ç‚¹å‡»â€œOpenâ€
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7e3a1700d33d412ca1b9b6444ec61373~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=Qw2LfGO%2FKxg1BzpZczftZeGYjM4%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></li>
</ul>
<hr/>
<h3 data-id="heading-15">ç¬¬å…­ç« ï¼šè¿è¡Œé¡¹ç›®ï¼ˆéªŒè¯ä¸€åˆ‡æ­£å¸¸ï¼‰</h3>
<h4 data-id="heading-16">6.1 ç¬¬ä¸€æ¬¡è¿è¡Œå‰æ£€æŸ¥</h4>
<p><strong>æ£€æŸ¥1ï¼šæ–‡ä»¶å¤¹ç»“æ„</strong></p>
<ul>
<li>å·¦è¾¹æ åº”è¯¥çœ‹åˆ°è¿™äº›æ–‡ä»¶ï¼š</li>
</ul>

<pre><code class="hljs language-erlang" lang="erlang">CyberTCM/
â”œâ”€â”€ app.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ assets/
â””â”€â”€ ...
</code></pre>
<p><strong>æ£€æŸ¥2ï¼šæ‰“å¼€ç»ˆç«¯</strong></p>
<ul>
<li>VS Codeé¡¶éƒ¨èœå•ï¼šæŸ¥çœ‹ â†’ ç»ˆç«¯</li>
<li>ç¡®è®¤è·¯å¾„æ­£ç¡®ï¼ˆç»“å°¾æ˜¯<code>/CyberTCM&gt;</code>ï¼‰
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/66a686a6dbbc4458ba76b616ab37805d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=1nzC6BdQSC5tw%2FjmW6a9JvCI0zw%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></li>
</ul>
<h4 data-id="heading-17">6.2 å®‰è£…Pythonä¾èµ–</h4>
<pre><code class="hljs language-bash" lang="bash">pip install -r requirements.txt
</code></pre>
<ul>
<li>æˆ‘æŠŠä¾èµ–å…¨éƒ¨å†™åœ¨requirement è¿™ä¸ªæ–‡ä»¶é‡Œäº†æ‰€ä»¥ç›´æ¥è¿è¡Œè¿™ä¸ªå‘½ä»¤å°±è¡Œäº†<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a80926b120e4eedb6f4b358bf25ca55~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=xCLQJGGWlYT5qz%2FJDyUOUtKXonE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>æˆ‘è¿™å·²ç»å®‰è£…è¿‡äº†ï¼ˆå®‰è£…è¿‡ç¨‹å¼€æ¢¯å­ ä¸ç„¶å¾ˆæ…¢ï¼‰</li>
</ul>
<h4 data-id="heading-18">6.3 è¿è¡Œé¡¹ç›®</h4>
<p>-å‘½ä»¤è¡Œè¾“å…¥</p>
<pre><code class="hljs language-bash" lang="bash">streamlit run app.py
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23f32c31819448a19e150f140e467648~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=N3nPuHoScoMilXSjBjRxZsYJYT0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
-å¦‚æœæ²¡æœ‰è‡ªåŠ¨æ‰“å¼€ç½‘é¡µå°±æŒ‰ä½ctrl é¼ æ ‡ç‚¹ä¸€ä¸‹ä¸‹é¢é‚£ä¸ªLocal URLå°±å¯ä»¥æ‰“å¼€ç½‘é¡µ å°±è¿™æ · ï¼ˆè¯„è®ºåŒºæˆªå›¾äº¤ä½œä¸šå•Šhh)
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0cce7f0ed02547b0854b2bb5d41414e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTQ4ODE3MzE2MzE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770912416&amp;x-signature=sIb1kU4%2FpKRzt7SS%2BX4%2Fdn5dXsc%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-19">ç¬¬ä¸ƒç« ï¼šæ—¥å¸¸åä½œæµç¨‹ï¼ˆç®€åŒ–ç‰ˆSOPï¼‰</h3>
<h4 data-id="heading-20">7.1 æ¯å¤©å¼€å§‹å·¥ä½œå‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ‹‰å–æœ€æ–°ä»£ç ï¼ˆåŒæ­¥é˜Ÿå‹çš„ä¿®æ”¹ï¼‰</span>
git pull origin master

<span class="hljs-comment"># 2. è¿è¡Œé¡¹ç›®</span>
streamlit run app.py
</code></pre>
<h4 data-id="heading-21">7.2 å†™å®Œä»£ç åä¿å­˜</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ·»åŠ æ‰€æœ‰ä¿®æ”¹</span>
git add .  ã€æ³¨æ„åé¢æœ‰ä¸ªç©ºæ ¼å’Œä¸€ä¸ªç‚¹ã€‘

<span class="hljs-comment"># 2. å†™æäº¤ä¿¡æ¯ï¼ˆå¿…é¡»ï¼ï¼‰</span>
git commit -m <span class="hljs-string">"ä½ çš„åå­—: åšäº†ä»€ä¹ˆ"</span>
<span class="hljs-comment"># ç¤ºä¾‹ï¼šgit commit -m "å¼ ä¸‰: ä¿®å¤äº†ç™»å½•æŒ‰é’®bug"</span>

<span class="hljs-comment"># 3. æ¨é€åˆ°GitHub ã€å¼€æ¢¯å­ã€‘</span>
git push origin master
</code></pre>
<h4 data-id="heading-22">7.3 è®°ä½è¿™3ä¸ªå‘½ä»¤å°±å¤Ÿç”¨</h4>
<pre><code class="hljs language-sql" lang="sql">æ¯å¤©å¼€å§‹ï¼šgit pull
ä¿®æ”¹åï¼šgit <span class="hljs-keyword">add</span> . â†’ git <span class="hljs-keyword">commit</span> <span class="hljs-operator">-</span>m "æè¿°" â†’ git push
</code></pre>
<hr/>
<h3 data-id="heading-23">ç¬¬å…«ç« ï¼šå¸¸è§é—®é¢˜è§£å†³ï¼ˆQ&amp;Aï¼‰</h3>
<h4 data-id="heading-24">Q1ï¼šå‘½ä»¤è¾“é”™äº†æ€ä¹ˆåŠï¼Ÿ</h4>
<p><strong>A</strong>ï¼šæŒ‰<code>Ctrl+C</code>å¯ä»¥ä¸­æ–­å½“å‰å‘½ä»¤ã€‚</p>
<h4 data-id="heading-25">Q2ï¼šç»ˆç«¯æ˜¾ç¤ºä¸€å †çœ‹ä¸æ‡‚çš„è‹±æ–‡ï¼Ÿ</h4>
<p><strong>A</strong>ï¼šç›´æ¥å¤åˆ¶é—®ai è®©å®ƒè§£å†³</p>
<hr/>
<h3 data-id="heading-26">ç¬¬ä¹ç« ï¼šå›¢é˜ŸéªŒæ”¶ä»»åŠ¡æ¸…å•</h3>
<p>æ¯ä¸ªé˜Ÿå‘˜å®Œæˆä»¥ä¸‹ä»»åŠ¡å<strong>åœ¨ç¾¤é‡Œæ‰“å¡</strong>ï¼š</p>
<h4 data-id="heading-27">âœ… ä»»åŠ¡æ¸…å•</h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ³¨å†ŒGitHubè´¦å·ï¼ŒæŠŠç”¨æˆ·åå‘ç¾¤é‡Œ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å®‰è£…VS Codeï¼Œæˆªå›¾ä¸»ç•Œé¢</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å…‹éš†é¡¹ç›®ï¼Œæˆªå›¾æ–‡ä»¶ç»“æ„</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> è¿è¡Œé¡¹ç›®ï¼Œæˆªå›¾æµè§ˆå™¨æ‰“å¼€çš„ç½‘é¡µ</li>
</ul>
<h4 data-id="heading-28">ğŸ† å®Œæˆå¥–åŠ±</h4>
<ul>
<li>å…¨é˜Ÿå®Œæˆï¼šè¯·æˆ‘å–å¥¶èŒ¶</li>
<li>å‰ä¸‰åå®Œæˆï¼šç»™æˆ‘å‘çº¢åŒ…</li>
<li>å¸®åŠ©é˜Ÿå‹è§£å†³é—®é¢˜ï¼šå›¢é˜Ÿè´¡çŒ®åŠ åˆ†</li>
</ul>
<hr/>
<h3 data-id="heading-29">ç¬¬åç« ï¼šä¸‹ä¸€æ­¥å­¦ä¹ è®¡åˆ’</h3>
<p>å®Œæˆè¿™ä¸ªæŒ‡å—åï¼Œæˆ‘ä»¬æŒ‰è¿™ä¸ªé¡ºåºå­¦ä¹ ï¼š</p>
<h4 data-id="heading-30">å­¦ä¹ è·¯çº¿å›¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[GitåŸºç¡€] --&gt; B[Traeç†Ÿç»ƒä½¿ç”¨]
    B --&gt; C[Dockerç¯å¢ƒç»Ÿä¸€]
    C --&gt; D[Dockerç¯å¢ƒç»Ÿä¸€]
    
    D --&gt; F[é¡¹ç›®éƒ¨ç½²ä¸Šçº¿]
</code></pre>
<h4 data-id="heading-31">é¢„è®¡æ—¶é—´</h4>
<ul>
<li>æœ¬å‘¨ï¼šå®ŒæˆGitåŸºç¡€ï¼ˆè¿™ä¸ªæŒ‡å—ï¼‰</li>
<li>ä¸‹å‘¨ï¼šé¡¹ç›®å¼€å‘è§„èŒƒ</li>
<li>ä¸‹ä¸‹å‘¨ï¼šDockerå…¥é—¨</li>
<li>ä¸€ä¸ªæœˆåï¼šæˆ‘ä»¬çš„AIé¡¹ç›®ä¸­çº§ç‰ˆå®Œæˆï¼</li>
</ul>
<hr/>
<p>é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œéšæ—¶åœ¨ç¾¤é‡Œ@æˆ‘ï¼Œæˆ–è€…ç›´æ¥æ‰“æˆ‘çš„ç”µè¯ã€‚</p>
<p><strong>è®°ä½</strong>ï¼šæˆ‘ä»¬æ˜¯ä¸€ä¸ªå›¢é˜Ÿï¼Œä½ çš„é—®é¢˜å°±æ˜¯å›¢é˜Ÿçš„é—®é¢˜ã€‚æ²¡æœ‰äººä¼šç¬‘ä½ é—®â€œè ¢é—®é¢˜â€ï¼Œå› ä¸ºæ¯ä¸ªäººéƒ½æ˜¯ä»é›¶å¼€å§‹çš„ã€‚</p>
<p>ç°åœ¨ï¼Œå¼€å§‹ç¬¬ä¸€æ­¥å§ï¼ä»æ‰“å¼€<code>github.com</code>å¼€å§‹ã€‚</p>
<hr/>
<h3 data-id="heading-32">ğŸ“ é™„å½•ï¼šæ‰€æœ‰é“¾æ¥æ±‡æ€»</h3>
<h4 data-id="heading-33">å¿…å¤‡ç½‘ç«™</h4>
<ol>
<li>GitHubæ³¨å†Œï¼š<code>https://github.com</code></li>
<li>Gitä¸‹è½½ï¼š<code>https://git-scm.com/downloads</code></li>
<li>VS Codeä¸‹è½½ï¼š<code>https://code.visualstudio.com</code></li>
</ol>
<h4 data-id="heading-34">å›¢é˜Ÿèµ„æº</h4>
<ol>
<li>é¡¹ç›®åœ°å€ï¼š<code>https://github.com/hhh-dahah/CyberTCM.git</code></li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[spring-ai mcp-serverå…¥é—¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7603261102794686490</link>    <guid>https://juejin.cn/post/7603261102794686490</guid>    <pubDate>2026-02-06T02:44:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603261102794686490" data-draft-id="7587779957675262003" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="spring-ai mcp-serverå…¥é—¨æŒ‡å—"/> <meta itemprop="keywords" content="Spring Boot,MCP"/> <meta itemprop="datePublished" content="2026-02-06T02:44:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜µç§°ä¸ºç©ºC"/> <meta itemprop="url" content="https://juejin.cn/user/1267096172897005"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            spring-ai mcp-serverå…¥é—¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1267096172897005/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜µç§°ä¸ºç©ºC
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T02:44:04.000Z" title="Fri Feb 06 2026 02:44:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ‘˜è¦ï¼šæœ¬æ–‡ä¸»è¦ä»‹ç»<code>springboot3</code>+ <code>spring ai</code>å®ç°<code>mcp-server</code>æ¥å¢åŠ æˆ‘ä»¬çš„ç”Ÿäº§åŠ›ï¼›ä¸‹æ–‡ç”¨ä¸€ä¸ªæ¸©åº¦çš„æŸ¥è¯¢å’Œæ•°æ®åº“æŸ¥è¯¢çš„æ¡ˆä¾‹æ¥å®ç°å¼€å‘æ­¥éª¤ã€‚</p>
<h2 data-id="heading-0">æ ¸å¿ƒæ¦‚å¿µ</h2>
<blockquote>
<p>Spring AI æä¾›äº†ä¸ <strong>Model Context Protocol (MCP)</strong> â€‹ çš„é›†æˆï¼Œè¿™æ˜¯ä¸€ä¸ªæ–°å…´çš„åè®®ï¼Œæ—¨åœ¨ä¸º AI åº”ç”¨æä¾›æ ‡å‡†åŒ–å·¥å…·å’Œä¸Šä¸‹æ–‡ç®¡ç†æ–¹å¼ã€‚</p>
</blockquote>
<p><strong>MCP</strong>â€‹ æ˜¯ä¸€ä¸ªå¼€æ”¾åè®®ï¼Œè®© AI æ¨¡å‹èƒ½å¤Ÿï¼š</p>
<ul>
<li>å‘ç°å’Œä½¿ç”¨å·¥å…·</li>
<li>è®¿é—®å„ç§æ•°æ®æº</li>
<li>ç®¡ç†ä¸Šä¸‹æ–‡ä¿¡æ¯</li>
<li>ä»¥æ ‡å‡†åŒ–æ–¹å¼ä¸å¤–éƒ¨ç³»ç»Ÿäº¤äº’</li>
</ul>
<h2 data-id="heading-1">å®æˆ˜æ¡ˆä¾‹</h2>
<h3 data-id="heading-2"><code>pom.xml</code></h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.9<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span> <span class="hljs-comment">&lt;!-- lookup parent from repository --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.example<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>sp3-mcp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>sp3-mcp<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>sp3-mcp<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">url</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">licenses</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">license</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">licenses</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">developers</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">developer</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">developers</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">scm</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">connection</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">developerConnection</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">tag</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">url</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">scm</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">java.version</span>&gt;</span>21<span class="hljs-tag">&lt;/<span class="hljs-name">java.version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>21<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>21<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-starter-mcp-server-webmvc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.0.33<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-bom<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3"><code>application.properties</code></h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># spring.main.web-application-type=none</span>

<span class="hljs-comment"># <span class="hljs-doctag">NOTE:</span> You must disable the banner and the console logging </span>
<span class="hljs-comment"># to allow the STDIO transport to work !!!</span>
<span class="hljs-attr">spring.main.banner-mode</span>=<span class="hljs-literal">off</span>
<span class="hljs-comment"># logging.pattern.console=</span>

<span class="hljs-comment"># spring.ai.mcp.server.stdio=false</span>

<span class="hljs-attr">spring.ai.mcp.server.name</span>=mcp-weather-server
<span class="hljs-attr">spring.ai.mcp.server.request-timeout</span>=<span class="hljs-number">1</span>h

<span class="hljs-attr">spring.ai.mcp.server.protocol</span>=sse

<span class="hljs-attr">logging.file.name</span>=./mcp-weather-server/target/server.log
</code></pre>
<h3 data-id="heading-4"><code>Application.java</code></h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sp3McpApplication</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[] args</span>) {
        <span class="hljs-title class_">SpringApplication</span>.<span class="hljs-title function_">run</span>(<span class="hljs-title class_">Sp3McpApplication</span>.<span class="hljs-property">class</span>, args);
    }

}
</code></pre>
<h3 data-id="heading-5"><code>WeatherService.java</code></h3>
<blockquote>
<p>æä¾›çš„æ¸©åº¦æŸ¥è¯¢çš„å·¥å…·</p>
</blockquote>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Service</span>
public class WeatherService {

    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">final</span> <span class="hljs-selector-tag">RestClient</span> <span class="hljs-selector-tag">restClient</span> = <span class="hljs-selector-tag">RestClient</span><span class="hljs-selector-class">.create</span>();

    <span class="hljs-comment">/**
     * The response format from the Open-Meteo API
     */</span>
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">record</span> <span class="hljs-selector-tag">WeatherResponse</span>(Current current) {
        <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">record</span> <span class="hljs-selector-tag">Current</span>(LocalDateTime time, int interval, double temperature_2m) {
        }
    }

    <span class="hljs-variable">@McpTool</span>(description = <span class="hljs-string">"Get the temperature (in celsius) for a specific location"</span>)
    public String <span class="hljs-built_in">getTemperature</span>(McpSyncServerExchange exchange,
                                 <span class="hljs-variable">@McpToolParam</span>(description = <span class="hljs-string">"The location latitude"</span>) double latitude,
                                 <span class="hljs-variable">@McpToolParam</span>(description = <span class="hljs-string">"The location longitude"</span>) double longitude,
                                 <span class="hljs-variable">@McpProgressToken</span> String progressToken) {

        <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.loggingNotification</span>(LoggingMessageNotification.<span class="hljs-built_in">builder</span>()
                .<span class="hljs-built_in">level</span>(LoggingLevel.DEBUG)
                .<span class="hljs-built_in">data</span>(<span class="hljs-string">"Call getTemperature Tool with latitude: "</span> + latitude + <span class="hljs-string">" and longitude: "</span> + longitude)
                .<span class="hljs-built_in">meta</span>(Map.<span class="hljs-built_in">of</span>()) <span class="hljs-comment">// non null meata as a workaround for <span class="hljs-doctag">bug:</span> ...</span>
                .<span class="hljs-built_in">build</span>());

        <span class="hljs-comment">// 0% progress</span>
        <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"Retrieving weather forecast"</span>));

        <span class="hljs-selector-tag">WeatherResponse</span> <span class="hljs-selector-tag">weatherResponse</span> = <span class="hljs-selector-tag">restClient</span><span class="hljs-selector-class">.get</span>()
                <span class="hljs-selector-class">.uri</span>(<span class="hljs-string">"https://api.open-meteo.com/v1/forecast?latitude={latitude}&amp;longitude={longitude}&amp;current=temperature_2m"</span>,
                        latitude, longitude)
                <span class="hljs-selector-class">.retrieve</span>()
                <span class="hljs-selector-class">.body</span>(WeatherResponse.class);

        <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">epicPoem</span> = "<span class="hljs-selector-tag">MCP</span> <span class="hljs-selector-tag">client</span> <span class="hljs-selector-tag">doesn</span>'<span class="hljs-selector-tag">t</span> <span class="hljs-selector-tag">provide</span> <span class="hljs-selector-tag">sampling</span> <span class="hljs-selector-tag">capability</span>.";

        <span class="hljs-selector-tag">if</span> (exchange.<span class="hljs-built_in">getClientCapabilities</span>().<span class="hljs-built_in">sampling</span>() != null) {

            <span class="hljs-comment">// 50% progress</span>
            <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">0.5</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"Start sampling"</span>));

            <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">samplingMessage</span> = """
                <span class="hljs-selector-tag">For</span> <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">weather</span> <span class="hljs-selector-tag">forecast</span> (temperature is in Celsius): %<span class="hljs-selector-tag">s</span>.
                <span class="hljs-selector-tag">At</span> <span class="hljs-selector-tag">location</span> <span class="hljs-selector-tag">with</span> <span class="hljs-selector-tag">latitude</span>: %<span class="hljs-selector-tag">s</span> <span class="hljs-selector-tag">and</span> <span class="hljs-selector-tag">longitude</span>: %<span class="hljs-selector-tag">s</span>.
                <span class="hljs-selector-tag">Please</span> <span class="hljs-selector-tag">write</span> <span class="hljs-selector-tag">an</span> <span class="hljs-selector-tag">epic</span> <span class="hljs-selector-tag">poem</span> <span class="hljs-selector-tag">about</span> <span class="hljs-selector-tag">this</span> <span class="hljs-selector-tag">forecast</span> <span class="hljs-selector-tag">using</span> <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">Shakespearean</span> <span class="hljs-selector-tag">style</span>.
                """<span class="hljs-selector-class">.formatted</span>(weatherResponse.<span class="hljs-built_in">current</span>().<span class="hljs-built_in">temperature_2m</span>(), latitude, longitude);

            <span class="hljs-selector-tag">CreateMessageResult</span> <span class="hljs-selector-tag">samplingResponse</span> = <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.createMessage</span>(CreateMessageRequest.<span class="hljs-built_in">builder</span>()
                    .<span class="hljs-built_in">systemPrompt</span>(<span class="hljs-string">"You are a poet!"</span>)
                    .<span class="hljs-built_in">messages</span>(List.<span class="hljs-built_in">of</span>(new <span class="hljs-built_in">SamplingMessage</span>(Role.USER, new <span class="hljs-built_in">TextContent</span>(samplingMessage))))
                    .<span class="hljs-built_in">modelPreferences</span>(ModelPreferences.<span class="hljs-built_in">builder</span>().<span class="hljs-built_in">addHint</span>(<span class="hljs-string">"anthropic"</span>).<span class="hljs-built_in">build</span>())
                    .<span class="hljs-built_in">build</span>());

            <span class="hljs-selector-tag">epicPoem</span> = ((TextContent) samplingResponse.<span class="hljs-built_in">content</span>())<span class="hljs-selector-class">.text</span>();

        }

        <span class="hljs-comment">// 100% progress</span>
        <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"Task completed"</span>));

        <span class="hljs-selector-tag">return</span> """
             <span class="hljs-selector-tag">Weather</span> <span class="hljs-selector-tag">Poem2</span>: %<span class="hljs-selector-tag">s</span>
             <span class="hljs-selector-tag">about</span> <span class="hljs-selector-tag">the</span> <span class="hljs-selector-tag">weather</span>: %<span class="hljs-selector-tag">s</span>Â°<span class="hljs-selector-tag">C</span> <span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">location</span> <span class="hljs-selector-tag">with</span> <span class="hljs-selector-tag">latitude</span>: %<span class="hljs-selector-tag">s</span> <span class="hljs-selector-tag">and</span> <span class="hljs-selector-tag">longitude</span>: %<span class="hljs-selector-tag">s</span>
             """<span class="hljs-selector-class">.formatted</span>(epicPoem, weatherResponse.<span class="hljs-built_in">current</span>().<span class="hljs-built_in">temperature_2m</span>(), latitude, longitude);
    }

}
</code></pre>
<h3 data-id="heading-6"><code>DatabaseService.java</code></h3>
<blockquote>
<p>æ•°æ®åº“æŸ¥è¯¢å·¥å…·</p>
</blockquote>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Service</span>
public class DatabaseService {

    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">Connection</span> <span class="hljs-selector-tag">connection</span>;
    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">final</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">jdbcUrl</span>;
    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">final</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">username</span>;
    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">final</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">password</span>;

    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">DatabaseService</span>() {
        <span class="hljs-comment">// ä»ç¯å¢ƒå˜é‡è¯»å–æ•°æ®åº“é…ç½®</span>
        <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">host</span> = "<span class="hljs-number">192.168</span><span class="hljs-selector-class">.8</span><span class="hljs-selector-class">.134</span>";
        <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">port</span> = "<span class="hljs-number">30635</span>";
        <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">database</span> = "<span class="hljs-selector-tag">test_1</span>";
        <span class="hljs-selector-tag">this</span><span class="hljs-selector-class">.username</span> = "<span class="hljs-selector-tag">root</span>";
        <span class="hljs-selector-tag">this</span><span class="hljs-selector-class">.password</span> = "<span class="hljs-selector-tag">xxxx</span>";
        
        <span class="hljs-selector-tag">this</span><span class="hljs-selector-class">.jdbcUrl</span> = <span class="hljs-selector-tag">String</span><span class="hljs-selector-class">.format</span>(<span class="hljs-string">"jdbc:mysql://%s:%s/%s?useSSL=false&amp;allowPublicKeyRetrieval=true&amp;serverTimezone=UTC"</span>, 
                                   host, port, database);
        
        <span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®åº“è¿æ¥</span>
        <span class="hljs-selector-tag">initializeConnection</span>();
    }

    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">getEnvOrDefault</span>(String key, String defaultValue) {
        <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">value</span> = <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.getenv</span>(key);
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">value</span> != <span class="hljs-selector-tag">null</span> ? <span class="hljs-selector-tag">value</span> : <span class="hljs-selector-tag">defaultValue</span>;
    }

    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">getRequiredEnv</span>(String key) {
        <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">value</span> = <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.getenv</span>(key);
        <span class="hljs-selector-tag">if</span> (value == null || value.<span class="hljs-built_in">trim</span>().<span class="hljs-built_in">isEmpty</span>()) {
            <span class="hljs-selector-tag">throw</span> <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">IllegalArgumentException</span>(<span class="hljs-string">"Required environment variable "</span> + key + <span class="hljs-string">" is not set"</span>);
        }
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">value</span>;
    }

    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">initializeConnection</span>() {
        <span class="hljs-selector-tag">try</span> {
            <span class="hljs-selector-tag">Class</span><span class="hljs-selector-class">.forName</span>(<span class="hljs-string">"com.mysql.cj.jdbc.Driver"</span>);
            <span class="hljs-selector-tag">this</span><span class="hljs-selector-class">.connection</span> = <span class="hljs-selector-tag">DriverManager</span><span class="hljs-selector-class">.getConnection</span>(jdbcUrl, username, password);
        } <span class="hljs-selector-tag">catch</span> (ClassNotFoundException | SQLException e) {
            <span class="hljs-selector-tag">throw</span> <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">RuntimeException</span>(<span class="hljs-string">"Failed to initialize database connection: "</span> + e.<span class="hljs-built_in">getMessage</span>(), e);
        }
    }

    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">Connection</span> <span class="hljs-selector-tag">getConnection</span>() <span class="hljs-selector-tag">throws</span> <span class="hljs-selector-tag">SQLException</span> {
        <span class="hljs-selector-tag">if</span> (connection == null || connection.<span class="hljs-built_in">isClosed</span>()) {
            <span class="hljs-selector-tag">initializeConnection</span>();
        }
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">connection</span>;
    }

    @<span class="hljs-selector-tag">McpTool</span>(description = <span class="hljs-string">"æ‰§è¡ŒMySQLæŸ¥è¯¢è¯­å¥(SELECT)"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">executeQuery</span>(McpSyncServerExchange exchange,
                              <span class="hljs-variable">@McpToolParam</span>(description = <span class="hljs-string">"è¦æ‰§è¡Œçš„SQLæŸ¥è¯¢è¯­å¥"</span>) String sql,
                              <span class="hljs-variable">@McpProgressToken</span> String progressToken) {

        <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.loggingNotification</span>(LoggingMessageNotification.<span class="hljs-built_in">builder</span>()
                .<span class="hljs-built_in">level</span>(LoggingLevel.DEBUG)
                .<span class="hljs-built_in">data</span>(<span class="hljs-string">"Executing query: "</span> + sql)
                .<span class="hljs-built_in">meta</span>(Map.<span class="hljs-built_in">of</span>())
                .<span class="hljs-built_in">build</span>());

        <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"å¼€å§‹æ‰§è¡ŒæŸ¥è¯¢"</span>));

        <span class="hljs-selector-tag">try</span> (Connection conn = <span class="hljs-built_in">getConnection</span>();
             Statement stmt = conn.<span class="hljs-built_in">createStatement</span>();
             ResultSet rs = stmt.<span class="hljs-built_in">executeQuery</span>(sql)) {

            <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">0.5</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"å¤„ç†æŸ¥è¯¢ç»“æœ"</span>));

            <span class="hljs-selector-tag">ResultSetMetaData</span> <span class="hljs-selector-tag">metaData</span> = <span class="hljs-selector-tag">rs</span><span class="hljs-selector-class">.getMetaData</span>();
            <span class="hljs-selector-tag">int</span> <span class="hljs-selector-tag">columnCount</span> = <span class="hljs-selector-tag">metaData</span><span class="hljs-selector-class">.getColumnCount</span>();

            <span class="hljs-selector-tag">StringBuilder</span> <span class="hljs-selector-tag">result</span> = <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">StringBuilder</span>();
            <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">"æŸ¥è¯¢æ‰§è¡ŒæˆåŠŸ!\n\n"</span>);
            <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">"åˆ—ä¿¡æ¯:\n"</span>);
            <span class="hljs-selector-tag">for</span> (int i = <span class="hljs-number">1</span>; i &lt;= columnCount; i++) {
                <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(String.<span class="hljs-built_in">format</span>(<span class="hljs-string">"  %s (%s)\n"</span>, 
                    metaData.<span class="hljs-built_in">getColumnName</span>(i), 
                    metaData.<span class="hljs-built_in">getColumnTypeName</span>(i)));
            }
            <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">"\næŸ¥è¯¢ç»“æœ:\n"</span>);

            <span class="hljs-selector-tag">int</span> <span class="hljs-selector-tag">rowCount</span> = <span class="hljs-number">0</span>;
            <span class="hljs-selector-tag">while</span> (rs.<span class="hljs-built_in">next</span>()) {
                <span class="hljs-selector-tag">rowCount</span>++;
                <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">"è¡Œ "</span>)<span class="hljs-selector-class">.append</span>(rowCount)<span class="hljs-selector-class">.append</span>(<span class="hljs-string">": "</span>);
                <span class="hljs-selector-tag">for</span> (int i = <span class="hljs-number">1</span>; i &lt;= columnCount; i++) {
                    <span class="hljs-selector-tag">Object</span> <span class="hljs-selector-tag">value</span> = <span class="hljs-selector-tag">rs</span><span class="hljs-selector-class">.getObject</span>(i);
                    <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(metaData.<span class="hljs-built_in">getColumnName</span>(i))<span class="hljs-selector-class">.append</span>(<span class="hljs-string">"="</span>)<span class="hljs-selector-class">.append</span>(value);
                    <span class="hljs-selector-tag">if</span> (i &lt; columnCount) <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">", "</span>);
                }
                <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">"\n"</span>);
            }

            <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"æŸ¥è¯¢å®Œæˆ"</span>));
            
            <span class="hljs-selector-tag">if</span> (rowCount == <span class="hljs-number">0</span>) {
                <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">"(æŸ¥è¯¢æœªè¿”å›ä»»ä½•è¡Œ)"</span>);
            } <span class="hljs-selector-tag">else</span> {
                <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">"\næ€»è®¡: "</span>)<span class="hljs-selector-class">.append</span>(rowCount)<span class="hljs-selector-class">.append</span>(<span class="hljs-string">" è¡Œ"</span>);
            }

            <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.toString</span>();

        } <span class="hljs-selector-tag">catch</span> (SQLException e) {
            <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"æŸ¥è¯¢å¤±è´¥"</span>));
            <span class="hljs-selector-tag">return</span> "æŸ¥è¯¢æ‰§è¡Œå¤±è´¥: " + <span class="hljs-selector-tag">e</span><span class="hljs-selector-class">.getMessage</span>();
        }
    }

    @<span class="hljs-selector-tag">McpTool</span>(description = <span class="hljs-string">"æ‰§è¡ŒMySQLæ›´æ–°è¯­å¥(INSERT, UPDATE, DELETE)"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">executeUpdate</span>(McpSyncServerExchange exchange,
                               <span class="hljs-variable">@McpToolParam</span>(description = <span class="hljs-string">"è¦æ‰§è¡Œçš„SQLæ›´æ–°è¯­å¥"</span>) String sql,
                               <span class="hljs-variable">@McpProgressToken</span> String progressToken) {

        <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.loggingNotification</span>(LoggingMessageNotification.<span class="hljs-built_in">builder</span>()
                .<span class="hljs-built_in">level</span>(LoggingLevel.DEBUG)
                .<span class="hljs-built_in">data</span>(<span class="hljs-string">"Executing update: "</span> + sql)
                .<span class="hljs-built_in">meta</span>(Map.<span class="hljs-built_in">of</span>())
                .<span class="hljs-built_in">build</span>());

        <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"å¼€å§‹æ‰§è¡Œæ›´æ–°"</span>));

        <span class="hljs-selector-tag">try</span> (Connection conn = <span class="hljs-built_in">getConnection</span>();
             Statement stmt = conn.<span class="hljs-built_in">createStatement</span>()) {

            <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">0.5</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"æ‰§è¡Œæ›´æ–°è¯­å¥"</span>));

            <span class="hljs-selector-tag">int</span> <span class="hljs-selector-tag">affectedRows</span> = <span class="hljs-selector-tag">stmt</span><span class="hljs-selector-class">.executeUpdate</span>(sql);

            <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"æ›´æ–°å®Œæˆ"</span>));

            <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">String</span><span class="hljs-selector-class">.format</span>(<span class="hljs-string">"æ›´æ–°æ‰§è¡ŒæˆåŠŸ! å½±å“äº† %d è¡Œã€‚"</span>, affectedRows);

        } <span class="hljs-selector-tag">catch</span> (SQLException e) {
            <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"æ›´æ–°å¤±è´¥"</span>));
            <span class="hljs-selector-tag">return</span> "æ›´æ–°æ‰§è¡Œå¤±è´¥: " + <span class="hljs-selector-tag">e</span><span class="hljs-selector-class">.getMessage</span>();
        }
    }

    @<span class="hljs-selector-tag">McpTool</span>(description = <span class="hljs-string">"æ‰§è¡Œä»»æ„MySQLè¯­å¥"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">executeSql</span>(McpSyncServerExchange exchange,
                            <span class="hljs-variable">@McpToolParam</span>(description = <span class="hljs-string">"è¦æ‰§è¡Œçš„SQLè¯­å¥"</span>) String sql,
                            <span class="hljs-variable">@McpProgressToken</span> String progressToken) {

        <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.loggingNotification</span>(LoggingMessageNotification.<span class="hljs-built_in">builder</span>()
                .<span class="hljs-built_in">level</span>(LoggingLevel.DEBUG)
                .<span class="hljs-built_in">data</span>(<span class="hljs-string">"Executing SQL: "</span> + sql)
                .<span class="hljs-built_in">meta</span>(Map.<span class="hljs-built_in">of</span>())
                .<span class="hljs-built_in">build</span>());

        <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"å¼€å§‹æ‰§è¡ŒSQL"</span>));

        <span class="hljs-selector-tag">try</span> (Connection conn = <span class="hljs-built_in">getConnection</span>();
             Statement stmt = conn.<span class="hljs-built_in">createStatement</span>()) {

            <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">0.5</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"æ‰§è¡ŒSQLè¯­å¥"</span>));

            <span class="hljs-selector-tag">boolean</span> <span class="hljs-selector-tag">isResultSet</span> = <span class="hljs-selector-tag">stmt</span><span class="hljs-selector-class">.execute</span>(sql);

            <span class="hljs-selector-tag">StringBuilder</span> <span class="hljs-selector-tag">result</span> = <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">StringBuilder</span>();

            <span class="hljs-selector-tag">if</span> (isResultSet) {
                <span class="hljs-comment">// å¤„ç†æŸ¥è¯¢ç»“æœ</span>
                <span class="hljs-selector-tag">try</span> (ResultSet rs = stmt.<span class="hljs-built_in">getResultSet</span>()) {
                    <span class="hljs-selector-tag">ResultSetMetaData</span> <span class="hljs-selector-tag">metaData</span> = <span class="hljs-selector-tag">rs</span><span class="hljs-selector-class">.getMetaData</span>();
                    <span class="hljs-selector-tag">int</span> <span class="hljs-selector-tag">columnCount</span> = <span class="hljs-selector-tag">metaData</span><span class="hljs-selector-class">.getColumnCount</span>();

                    <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">"SQLæ‰§è¡ŒæˆåŠŸ - æŸ¥è¯¢ç»“æœ:\n\n"</span>);
                    <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">"åˆ—ä¿¡æ¯:\n"</span>);
                    <span class="hljs-selector-tag">for</span> (int i = <span class="hljs-number">1</span>; i &lt;= columnCount; i++) {
                        <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(String.<span class="hljs-built_in">format</span>(<span class="hljs-string">"  %s (%s)\n"</span>, 
                            metaData.<span class="hljs-built_in">getColumnName</span>(i), 
                            metaData.<span class="hljs-built_in">getColumnTypeName</span>(i)));
                    }
                    <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">"\næ•°æ®:\n"</span>);

                    <span class="hljs-selector-tag">int</span> <span class="hljs-selector-tag">rowCount</span> = <span class="hljs-number">0</span>;
                    <span class="hljs-selector-tag">while</span> (rs.<span class="hljs-built_in">next</span>()) {
                        <span class="hljs-selector-tag">rowCount</span>++;
                        <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">"è¡Œ "</span>)<span class="hljs-selector-class">.append</span>(rowCount)<span class="hljs-selector-class">.append</span>(<span class="hljs-string">": "</span>);
                        <span class="hljs-selector-tag">for</span> (int i = <span class="hljs-number">1</span>; i &lt;= columnCount; i++) {
                            <span class="hljs-selector-tag">Object</span> <span class="hljs-selector-tag">value</span> = <span class="hljs-selector-tag">rs</span><span class="hljs-selector-class">.getObject</span>(i);
                            <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(metaData.<span class="hljs-built_in">getColumnName</span>(i))<span class="hljs-selector-class">.append</span>(<span class="hljs-string">"="</span>)<span class="hljs-selector-class">.append</span>(value);
                            <span class="hljs-selector-tag">if</span> (i &lt; columnCount) <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">", "</span>);
                        }
                        <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">"\n"</span>);
                    }

                    <span class="hljs-selector-tag">if</span> (rowCount == <span class="hljs-number">0</span>) {
                        <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">"(æŸ¥è¯¢æœªè¿”å›ä»»ä½•è¡Œ)"</span>);
                    } <span class="hljs-selector-tag">else</span> {
                        <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">"\næ€»è®¡: "</span>)<span class="hljs-selector-class">.append</span>(rowCount)<span class="hljs-selector-class">.append</span>(<span class="hljs-string">" è¡Œ"</span>);
                    }
                }
            } <span class="hljs-selector-tag">else</span> {
                <span class="hljs-comment">// å¤„ç†æ›´æ–°ç»“æœ</span>
                <span class="hljs-selector-tag">int</span> <span class="hljs-selector-tag">affectedRows</span> = <span class="hljs-selector-tag">stmt</span><span class="hljs-selector-class">.getUpdateCount</span>();
                <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.append</span>(<span class="hljs-string">"SQLæ‰§è¡ŒæˆåŠŸ - æ›´æ–°äº† "</span>)<span class="hljs-selector-class">.append</span>(affectedRows)<span class="hljs-selector-class">.append</span>(<span class="hljs-string">" è¡Œã€‚"</span>);
            }

            <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"SQLæ‰§è¡Œå®Œæˆ"</span>));
            <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">result</span><span class="hljs-selector-class">.toString</span>();

        } <span class="hljs-selector-tag">catch</span> (SQLException e) {
            <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"SQLæ‰§è¡Œå¤±è´¥"</span>));
            <span class="hljs-selector-tag">return</span> "<span class="hljs-selector-tag">SQL</span>æ‰§è¡Œå¤±è´¥: " + <span class="hljs-selector-tag">e</span><span class="hljs-selector-class">.getMessage</span>();
        }
    }

    @<span class="hljs-selector-tag">McpTool</span>(description = <span class="hljs-string">"è·å–æ•°æ®åº“è¡¨åˆ—è¡¨"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">getTables</span>(McpSyncServerExchange exchange,
                           <span class="hljs-variable">@McpProgressToken</span> String progressToken) {

        <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.loggingNotification</span>(LoggingMessageNotification.<span class="hljs-built_in">builder</span>()
                .<span class="hljs-built_in">level</span>(LoggingLevel.DEBUG)
                .<span class="hljs-built_in">data</span>(<span class="hljs-string">"Getting database tables"</span>)
                .<span class="hljs-built_in">meta</span>(Map.<span class="hljs-built_in">of</span>())
                .<span class="hljs-built_in">build</span>());

        <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"è·å–è¡¨åˆ—è¡¨"</span>));

        <span class="hljs-selector-tag">try</span> {
            <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">executeQuery</span>(exchange, <span class="hljs-string">"SHOW TABLES"</span>, progressToken);
        } <span class="hljs-selector-tag">catch</span> (Exception e) {
            <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"è·å–è¡¨åˆ—è¡¨å¤±è´¥"</span>));
            <span class="hljs-selector-tag">return</span> "è·å–è¡¨åˆ—è¡¨å¤±è´¥: " + <span class="hljs-selector-tag">e</span><span class="hljs-selector-class">.getMessage</span>();
        }
    }

    @<span class="hljs-selector-tag">McpTool</span>(description = <span class="hljs-string">"è·å–æŒ‡å®šè¡¨çš„ç»“æ„ä¿¡æ¯"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">getTableStructure</span>(McpSyncServerExchange exchange,
                                  <span class="hljs-variable">@McpToolParam</span>(description = <span class="hljs-string">"è¡¨å"</span>) String tableName,
                                  <span class="hljs-variable">@McpProgressToken</span> String progressToken) {

        <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.loggingNotification</span>(LoggingMessageNotification.<span class="hljs-built_in">builder</span>()
                .<span class="hljs-built_in">level</span>(LoggingLevel.DEBUG)
                .<span class="hljs-built_in">data</span>(<span class="hljs-string">"Getting table structure: "</span> + tableName)
                .<span class="hljs-built_in">meta</span>(Map.<span class="hljs-built_in">of</span>())
                .<span class="hljs-built_in">build</span>());

        <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"è·å–è¡¨ç»“æ„"</span>));

        <span class="hljs-selector-tag">try</span> {
            <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">sql</span> = "<span class="hljs-selector-tag">DESCRIBE</span> " + <span class="hljs-selector-tag">tableName</span>;
            <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">executeQuery</span>(exchange, sql, progressToken);
        } <span class="hljs-selector-tag">catch</span> (Exception e) {
            <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"è·å–è¡¨ç»“æ„å¤±è´¥"</span>));
            <span class="hljs-selector-tag">return</span> "è·å–è¡¨ç»“æ„å¤±è´¥: " + <span class="hljs-selector-tag">e</span><span class="hljs-selector-class">.getMessage</span>();
        }
    }

    @<span class="hljs-selector-tag">McpTool</span>(description = <span class="hljs-string">"æµ‹è¯•æ•°æ®åº“è¿æ¥"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">testConnection</span>(McpSyncServerExchange exchange,
                                <span class="hljs-variable">@McpProgressToken</span> String progressToken) {

        <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.loggingNotification</span>(LoggingMessageNotification.<span class="hljs-built_in">builder</span>()
                .<span class="hljs-built_in">level</span>(LoggingLevel.DEBUG)
                .<span class="hljs-built_in">data</span>(<span class="hljs-string">"Testing database connection"</span>)
                .<span class="hljs-built_in">meta</span>(Map.<span class="hljs-built_in">of</span>())
                .<span class="hljs-built_in">build</span>());

        <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">0.5</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"æµ‹è¯•è¿æ¥"</span>));

        <span class="hljs-selector-tag">try</span> {
            <span class="hljs-selector-tag">Connection</span> <span class="hljs-selector-tag">conn</span> = <span class="hljs-selector-tag">getConnection</span>();
            <span class="hljs-selector-tag">if</span> (conn != null &amp;&amp; !conn.<span class="hljs-built_in">isClosed</span>()) {
                <span class="hljs-selector-tag">DatabaseMetaData</span> <span class="hljs-selector-tag">metaData</span> = <span class="hljs-selector-tag">conn</span><span class="hljs-selector-class">.getMetaData</span>();
                <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">result</span> = <span class="hljs-selector-tag">String</span><span class="hljs-selector-class">.format</span>(
                    <span class="hljs-string">"æ•°æ®åº“è¿æ¥æµ‹è¯•æˆåŠŸ!\n"</span> +
                    <span class="hljs-string">"æ•°æ®åº“äº§å“: %s\n"</span> +
                    <span class="hljs-string">"æ•°æ®åº“ç‰ˆæœ¬: %s\n"</span> +
                    <span class="hljs-string">"é©±åŠ¨åç§°: %s\n"</span> +
                    <span class="hljs-string">"é©±åŠ¨ç‰ˆæœ¬: %s\n"</span> +
                    <span class="hljs-string">"è¿æ¥URL: %s"</span>,
                    metaData.<span class="hljs-built_in">getDatabaseProductName</span>(),
                    metaData.<span class="hljs-built_in">getDatabaseProductVersion</span>(),
                    metaData.<span class="hljs-built_in">getDriverName</span>(),
                    metaData.<span class="hljs-built_in">getDriverVersion</span>(),
                    jdbcUrl
                );
                
                <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"è¿æ¥æµ‹è¯•å®Œæˆ"</span>));
                <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">result</span>;
            } <span class="hljs-selector-tag">else</span> {
                <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"è¿æ¥æµ‹è¯•å¤±è´¥"</span>));
                <span class="hljs-selector-tag">return</span> "æ•°æ®åº“è¿æ¥å¤±è´¥: è¿æ¥æ— æ•ˆæˆ–å·²å…³é—­";
            }
        } <span class="hljs-selector-tag">catch</span> (SQLException e) {
            <span class="hljs-selector-tag">exchange</span><span class="hljs-selector-class">.progressNotification</span>(new <span class="hljs-built_in">ProgressNotification</span>(progressToken, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-string">"è¿æ¥æµ‹è¯•å¤±è´¥"</span>));
            <span class="hljs-selector-tag">return</span> "æ•°æ®åº“è¿æ¥æµ‹è¯•å¤±è´¥: " + <span class="hljs-selector-tag">e</span><span class="hljs-selector-class">.getMessage</span>();
        }
    }
}
</code></pre>
<h3 data-id="heading-7">å¯åŠ¨æ—¥å¿—</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2dd5cfa04c174e6cbee133123875d69d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pi156ew5Li656m6Qw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950644&amp;x-signature=vIPeZpuKRufhVZWTM38s2tFybUM%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-8">å®¢æˆ·ç«¯é…ç½®<code>MCP</code></h2>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"mcpServers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"å¤©æ°”æœåŠ¡"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"disabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"disabledTools"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://localhost:8080/sse"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed1be6cc19d6443b9f26d1675b210f92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pi156ew5Li656m6Qw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950644&amp;x-signature=lb9zyr7ruQZBJonK95LY4du39u0%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>ç„¶åå°±å¯ä»¥æ„‰å¿«ä½¿ç”¨äº†</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBootå®ç°å…¬æ­£æœ‰è¶£å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7603294029530890291</link>    <guid>https://juejin.cn/post/7603294029530890291</guid>    <pubDate>2026-02-06T02:43:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603294029530890291" data-draft-id="7603283691456626698" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBootå®ç°å…¬æ­£æœ‰è¶£å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-06T02:43:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜é‡‘è€…é˜¿è±ª"/> <meta itemprop="url" content="https://juejin.cn/user/4073055974333608"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBootå®ç°å…¬æ­£æœ‰è¶£å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4073055974333608/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜é‡‘è€…é˜¿è±ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T02:43:55.000Z" title="Fri Feb 06 2026 02:43:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">SpringBootå®ç°å…¬æ­£æœ‰è¶£å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿ</h2>
<h3 data-id="heading-1">ä¸€ã€é¡¹ç›®èƒŒæ™¯ä¸è®¾è®¡æ€è·¯</h3>
<p>å¹´ä¼šæŠ½å¥–æ˜¯æ¯ä¸ªä¼ä¸šå¹´æœ«çš„é‡è¦æ´»åŠ¨ï¼Œä½†ä¼ ç»Ÿçš„æŠ½å¥–æ–¹å¼å¾€å¾€å­˜åœ¨å…¬å¹³æ€§ä¸è¶³ã€äº’åŠ¨æ€§å·®çš„é—®é¢˜ã€‚æœ¬æ–‡å°†åŸºäºSpringBootæ¡†æ¶ï¼Œè®¾è®¡å¹¶å®ç°ä¸€ä¸ªå…¬æ­£ã€æœ‰è¶£ã€å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿï¼Œç¡®ä¿æŠ½å¥–è¿‡ç¨‹çš„é€æ˜æ€§å’Œéšæœºæ€§ï¼ŒåŒæ—¶å¢åŠ å¤šç§äº’åŠ¨åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-2">ç³»ç»Ÿæ ¸å¿ƒè®¾è®¡åŸåˆ™ï¼š</h4>
<ol>
<li><strong>å…¬æ­£æ€§</strong>ï¼šä½¿ç”¨åŠ å¯†éšæœºç®—æ³•ï¼Œç¡®ä¿ç»“æœä¸å¯é¢„æµ‹</li>
<li><strong>è¶£å‘³æ€§</strong>ï¼šå¤šç§æŠ½å¥–æ¨¡å¼ï¼ŒåŠ¨ç”»æ•ˆæœï¼Œå®æ—¶äº’åŠ¨</li>
<li><strong>å¯é æ€§</strong>ï¼šé«˜å¹¶å‘æ”¯æŒï¼Œæ•°æ®æŒä¹…åŒ–ï¼Œæ“ä½œæ—¥å¿—</li>
<li><strong>æ˜“ç”¨æ€§</strong>ï¼šç®€æ´çš„Webç•Œé¢ï¼Œæ˜“äºéƒ¨ç½²å’Œç®¡ç†</li>
</ol>
<h3 data-id="heading-3">äºŒã€æŠ€æœ¯æ ˆé€‰å‹</h3>
<ul>
<li><strong>åç«¯æ¡†æ¶</strong>ï¼šSpringBoot 2.7.x</li>
<li><strong>å‰ç«¯æŠ€æœ¯</strong>ï¼šThymeleaf + Bootstrap 5 + jQuery</li>
<li><strong>æ•°æ®åº“</strong>ï¼šMySQL 8.0 + Redis 7.0</li>
<li><strong>å®æ—¶é€šä¿¡</strong>ï¼šWebSocket</li>
<li><strong>å®‰å…¨æ¡†æ¶</strong>ï¼šSpring Security</li>
<li><strong>æ„å»ºå·¥å…·</strong>ï¼šMaven 3.8+</li>
</ul>
<h3 data-id="heading-4">ä¸‰ã€é¡¹ç›®ç»“æ„è®¾è®¡</h3>
<pre><code class="hljs language-bash" lang="bash">lottery-system/
â”œâ”€â”€ src/main/java/com/lottery/
â”‚   â”œâ”€â”€ config/          <span class="hljs-comment"># é…ç½®ç±»</span>
â”‚   â”œâ”€â”€ controller/      <span class="hljs-comment"># æ§åˆ¶å™¨å±‚</span>
â”‚   â”œâ”€â”€ service/         <span class="hljs-comment"># ä¸šåŠ¡é€»è¾‘å±‚</span>
â”‚   â”œâ”€â”€ repository/      <span class="hljs-comment"># æ•°æ®è®¿é—®å±‚</span>
â”‚   â”œâ”€â”€ model/          <span class="hljs-comment"># å®ä½“ç±»</span>
â”‚   â”œâ”€â”€ utils/          <span class="hljs-comment"># å·¥å…·ç±»</span>
â”‚   â”œâ”€â”€ aspect/         <span class="hljs-comment"># AOPåˆ‡é¢</span>
â”‚   â””â”€â”€ security/       <span class="hljs-comment"># å®‰å…¨é…ç½®</span>
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ static/         <span class="hljs-comment"># é™æ€èµ„æº</span>
â”‚   â””â”€â”€ templates/      <span class="hljs-comment"># æ¨¡æ¿æ–‡ä»¶</span>
â””â”€â”€ pom.xml
</code></pre>
<h3 data-id="heading-5">å››ã€æ•°æ®åº“è®¾è®¡</h3>
<h4 data-id="heading-6">4.1 æ ¸å¿ƒè¡¨ç»“æ„</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å‘˜å·¥è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> employee (
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    employee_id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">UNIQUE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    department <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>),
    avatar_url <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">500</span>),
    is_attended <span class="hljs-type">BOOLEAN</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">false</span>,
    created_time DATETIME <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>
);

<span class="hljs-comment">-- å¥–å“è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> prize (
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    level <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'å¥–å“ç­‰çº§ï¼š1-ç‰¹ç­‰å¥–ï¼Œ2-ä¸€ç­‰å¥–ï¼Œ3-äºŒç­‰å¥–...'</span>,
    total_count <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    remain_count <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    image_url <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">500</span>),
    description TEXT,
    created_time DATETIME <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>
);

<span class="hljs-comment">-- ä¸­å¥–è®°å½•è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> winning_record (
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    employee_id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    prize_id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    draw_time DATETIME <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
    draw_method <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) COMMENT <span class="hljs-string">'æŠ½å¥–æ–¹å¼'</span>,
    <span class="hljs-keyword">FOREIGN</span> KEY (employee_id) <span class="hljs-keyword">REFERENCES</span> employee(employee_id),
    <span class="hljs-keyword">FOREIGN</span> KEY (prize_id) <span class="hljs-keyword">REFERENCES</span> prize(id)
);

<span class="hljs-comment">-- æŠ½å¥–æ´»åŠ¨è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> lottery_event (
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    start_time DATETIME,
    end_time DATETIME,
    status <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'NOT_STARTED'</span>,
    settings JSON COMMENT <span class="hljs-string">'æ´»åŠ¨é…ç½®'</span>
);
</code></pre>
<h3 data-id="heading-7">äº”ã€æ ¸å¿ƒåŠŸèƒ½å®ç°</h3>
<h4 data-id="heading-8">5.1 é¡¹ç›®ä¾èµ–é…ç½®</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- pom.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Spring Boot Starter --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-websocket<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- æ•°æ®åº“ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- å·¥å…·ç±» --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.commons<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-lang3<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.12.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.google.guava<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>guava<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>31.1-jre<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- JSONå¤„ç† --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jackson-databind<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h4 data-id="heading-9">5.2 å‘˜å·¥å®ä½“ç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "employee")</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@NoArgsConstructor</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;
    
    <span class="hljs-meta">@Column(name = "employee_id", unique = true, nullable = false)</span>
    <span class="hljs-keyword">private</span> String employeeId;
    
    <span class="hljs-meta">@Column(nullable = false)</span>
    <span class="hljs-keyword">private</span> String name;
    
    <span class="hljs-keyword">private</span> String department;
    <span class="hljs-keyword">private</span> String avatarUrl;
    
    <span class="hljs-meta">@Column(name = "is_attended")</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">Boolean</span> <span class="hljs-variable">isAttended</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-meta">@CreationTimestamp</span>
    <span class="hljs-meta">@Column(name = "created_time", updatable = false)</span>
    <span class="hljs-keyword">private</span> LocalDateTime createdTime;
    
    <span class="hljs-meta">@Transient</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">Boolean</span> <span class="hljs-variable">isWinner</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<h4 data-id="heading-10">5.3 æŠ½å¥–æœåŠ¡æ ¸å¿ƒå®ç°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotteryService</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> EmployeeRepository employeeRepository;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> PrizeRepository prizeRepository;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> WinningRecordRepository winningRecordRepository;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> StringRedisTemplate redisTemplate;
    
    <span class="hljs-comment">/**
     * æ ¸å¿ƒæŠ½å¥–ç®—æ³• - ä½¿ç”¨åŠ å¯†å®‰å…¨çš„éšæœºæ•°
     */</span>
    <span class="hljs-keyword">public</span> LotteryResult <span class="hljs-title function_">drawPrize</span><span class="hljs-params">(Long prizeId, String drawMethod)</span> {
        <span class="hljs-type">Prize</span> <span class="hljs-variable">prize</span> <span class="hljs-operator">=</span> prizeRepository.findById(prizeId)
            .orElseThrow(() -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å¥–å“ä¸å­˜åœ¨"</span>));
            
        <span class="hljs-keyword">if</span> (prize.getRemainCount() &lt;= <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è¯¥å¥–å“å·²æŠ½å®Œ"</span>);
        }
        
        <span class="hljs-comment">// è·å–æ‰€æœ‰æœªä¸­å¥–çš„å‚ä¼šå‘˜å·¥</span>
        List&lt;Employee&gt; candidates = employeeRepository.findByIsAttendedTrueAndIsWinnerFalse();
        <span class="hljs-keyword">if</span> (candidates.isEmpty()) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æŠ½å¥–äººå‘˜"</span>);
        }
        
        <span class="hljs-comment">// ä½¿ç”¨SecureRandomç¡®ä¿éšæœºæ€§</span>
        <span class="hljs-type">SecureRandom</span> <span class="hljs-variable">secureRandom</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecureRandom</span>();
        <span class="hljs-type">byte</span>[] randomBytes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">32</span>];
        secureRandom.nextBytes(randomBytes);
        
        <span class="hljs-comment">// åŸºäºå“ˆå¸Œå€¼é€‰æ‹©ä¸­å¥–è€…</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> Math.abs(Arrays.hashCode(randomBytes)) % candidates.size();
        <span class="hljs-type">Employee</span> <span class="hljs-variable">winner</span> <span class="hljs-operator">=</span> candidates.get(index);
        
        <span class="hljs-comment">// ä¿å­˜ä¸­å¥–è®°å½•</span>
        <span class="hljs-type">WinningRecord</span> <span class="hljs-variable">record</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WinningRecord</span>();
        record.setEmployeeId(winner.getEmployeeId());
        record.setPrizeId(prizeId);
        record.setDrawMethod(drawMethod);
        record.setDrawTime(LocalDateTime.now());
        winningRecordRepository.save(record);
        
        <span class="hljs-comment">// æ›´æ–°å¥–å“å‰©ä½™æ•°é‡</span>
        prize.setRemainCount(prize.getRemainCount() - <span class="hljs-number">1</span>);
        prizeRepository.save(prize);
        
        <span class="hljs-comment">// æ ‡è®°å‘˜å·¥ä¸ºä¸­å¥–çŠ¶æ€ï¼ˆå®é™…ä¸­å¯èƒ½éœ€è¦æ›´å¤æ‚çš„é€»è¾‘ï¼‰</span>
        markEmployeeAsWinner(winner.getId());
        
        <span class="hljs-comment">// å‘é€WebSocketé€šçŸ¥</span>
        sendWinningNotification(winner, prize);
        
        <span class="hljs-keyword">return</span> LotteryResult.builder()
                .winner(winner)
                .prize(prize)
                .drawTime(LocalDateTime.now())
                .drawId(record.getId())
                .build();
    }
    
    <span class="hljs-comment">/**
     * æ‰¹é‡å¯¼å…¥å‘˜å·¥
     */</span>
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">importEmployees</span><span class="hljs-params">(MultipartFile file)</span> {
        <span class="hljs-keyword">try</span> {
            List&lt;Employee&gt; employees = parseEmployeeFile(file);
            employeeRepository.saveAll(employees);
            log.info(<span class="hljs-string">"æˆåŠŸå¯¼å…¥{}åå‘˜å·¥"</span>, employees.size());
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å¯¼å…¥å‘˜å·¥å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å¯¼å…¥å¤±è´¥: "</span> + e.getMessage());
        }
    }
    
    <span class="hljs-comment">/**
     * å¤šç§æŠ½å¥–æ¨¡å¼
     */</span>
    <span class="hljs-keyword">public</span> LotteryResult <span class="hljs-title function_">drawWithMode</span><span class="hljs-params">(Prize prize, DrawMode mode)</span> {
        <span class="hljs-keyword">switch</span> (mode) {
            <span class="hljs-keyword">case</span> RANDOM:
                <span class="hljs-keyword">return</span> randomDraw(prize);
            <span class="hljs-keyword">case</span> LUCKY_NUMBER:
                <span class="hljs-keyword">return</span> luckyNumberDraw(prize);
            <span class="hljs-keyword">case</span> ROULETTE:
                <span class="hljs-keyword">return</span> rouletteDraw(prize);
            <span class="hljs-keyword">case</span> GRID:
                <span class="hljs-keyword">return</span> gridDraw(prize);
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">return</span> randomDraw(prize);
        }
    }
    
    <span class="hljs-comment">/**
     * è½®ç›˜æŠ½å¥–ç®—æ³•
     */</span>
    <span class="hljs-keyword">private</span> LotteryResult <span class="hljs-title function_">rouletteDraw</span><span class="hljs-params">(Prize prize)</span> {
        List&lt;Employee&gt; candidates = getValidCandidates();
        
        <span class="hljs-comment">// ä¸ºæ¯ä¸ªå€™é€‰äººåˆ†é…æƒé‡ï¼ˆè¿™é‡Œç®€å•æŒ‰éƒ¨é—¨åˆ†é…ä¸åŒæƒé‡ï¼‰</span>
        Map&lt;Employee, Double&gt; weights = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        <span class="hljs-keyword">for</span> (Employee emp : candidates) {
            <span class="hljs-type">double</span> <span class="hljs-variable">weight</span> <span class="hljs-operator">=</span> getDepartmentWeight(emp.getDepartment());
            weights.put(emp, weight);
        }
        
        <span class="hljs-comment">// è½®ç›˜é€‰æ‹©</span>
        <span class="hljs-type">Employee</span> <span class="hljs-variable">winner</span> <span class="hljs-operator">=</span> rouletteSelect(weights);
        <span class="hljs-keyword">return</span> createLotteryResult(winner, prize, <span class="hljs-string">"ROULETTE"</span>);
    }
    
    <span class="hljs-keyword">private</span> Employee <span class="hljs-title function_">rouletteSelect</span><span class="hljs-params">(Map&lt;Employee, Double&gt; weights)</span> {
        <span class="hljs-type">double</span> <span class="hljs-variable">totalWeight</span> <span class="hljs-operator">=</span> weights.values().stream().mapToDouble(Double::doubleValue).sum();
        <span class="hljs-type">double</span> <span class="hljs-variable">random</span> <span class="hljs-operator">=</span> Math.random() * totalWeight;
        
        <span class="hljs-type">double</span> <span class="hljs-variable">cumulativeWeight</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.0</span>;
        <span class="hljs-keyword">for</span> (Map.Entry&lt;Employee, Double&gt; entry : weights.entrySet()) {
            cumulativeWeight += entry.getValue();
            <span class="hljs-keyword">if</span> (random &lt;= cumulativeWeight) {
                <span class="hljs-keyword">return</span> entry.getKey();
            }
        }
        
        <span class="hljs-keyword">return</span> weights.keySet().iterator().next();
    }
}
</code></pre>
<h4 data-id="heading-11">5.4 WebSocketå®æ—¶é€šä¿¡</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@EnableWebSocket</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebSocketConfigurer</span> {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerWebSocketHandlers</span><span class="hljs-params">(WebSocketHandlerRegistry registry)</span> {
        registry.addHandler(lotteryWebSocketHandler(), <span class="hljs-string">"/ws/lottery"</span>)
                .setAllowedOrigins(<span class="hljs-string">"*"</span>)
                .withSockJS();
    }
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> WebSocketHandler <span class="hljs-title function_">lotteryWebSocketHandler</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LotteryWebSocketHandler</span>();
    }
}

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotteryWebSocketHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">TextWebSocketHandler</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;String, WebSocketSession&gt; sessions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterConnectionEstablished</span><span class="hljs-params">(WebSocketSession session)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">sessionId</span> <span class="hljs-operator">=</span> session.getId();
        sessions.put(sessionId, session);
        
        <span class="hljs-comment">// å‘é€æ¬¢è¿æ¶ˆæ¯</span>
        sendMessage(session, <span class="hljs-string">"æ¬¢è¿åŠ å…¥å¹´ä¼šæŠ½å¥–ï¼"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleTextMessage</span><span class="hljs-params">(WebSocketSession session, TextMessage message)</span> {
        <span class="hljs-comment">// å¤„ç†å®¢æˆ·ç«¯æ¶ˆæ¯</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> message.getPayload();
        <span class="hljs-comment">// å¤„ç†ä¸šåŠ¡é€»è¾‘...</span>
    }
    
    <span class="hljs-comment">/**
     * å¹¿æ’­ä¸­å¥–æ¶ˆæ¯
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">broadcastWinningMessage</span><span class="hljs-params">(Employee winner, Prize prize)</span> {
        Map&lt;String, Object&gt; message = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        message.put(<span class="hljs-string">"type"</span>, <span class="hljs-string">"WINNING_NOTIFICATION"</span>);
        message.put(<span class="hljs-string">"winner"</span>, winner.getName());
        message.put(<span class="hljs-string">"prize"</span>, prize.getName());
        message.put(<span class="hljs-string">"department"</span>, winner.getDepartment());
        message.put(<span class="hljs-string">"time"</span>, LocalDateTime.now().format(DateTimeFormatter.ISO_LOCAL_TIME));
        
        <span class="hljs-type">String</span> <span class="hljs-variable">jsonMessage</span> <span class="hljs-operator">=</span> JSON.toJSONString(message);
        
        sessions.values().forEach(session -&gt; {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">if</span> (session.isOpen()) {
                    session.sendMessage(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TextMessage</span>(jsonMessage));
                }
            } <span class="hljs-keyword">catch</span> (IOException e) {
                log.error(<span class="hljs-string">"å‘é€WebSocketæ¶ˆæ¯å¤±è´¥"</span>, e);
            }
        });
    }
}
</code></pre>
<h4 data-id="heading-12">5.5 æŠ½å¥–æ§åˆ¶å™¨</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Controller</span>
<span class="hljs-meta">@RequestMapping("/lottery")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotteryController</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> LotteryService lotteryService;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> LotteryWebSocketHandler webSocketHandler;
    
    <span class="hljs-comment">/**
     * æŠ½å¥–é¡µé¢
     */</span>
    <span class="hljs-meta">@GetMapping("/draw")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">drawPage</span><span class="hljs-params">(Model model)</span> {
        List&lt;Prize&gt; availablePrizes = lotteryService.getAvailablePrizes();
        List&lt;Employee&gt; attendees = lotteryService.getAttendees();
        
        model.addAttribute(<span class="hljs-string">"prizes"</span>, availablePrizes);
        model.addAttribute(<span class="hljs-string">"attendees"</span>, attendees);
        model.addAttribute(<span class="hljs-string">"totalAttendees"</span>, attendees.size());
        
        <span class="hljs-keyword">return</span> <span class="hljs-string">"lottery/draw"</span>;
    }
    
    <span class="hljs-comment">/**
     * æ‰§è¡ŒæŠ½å¥–
     */</span>
    <span class="hljs-meta">@PostMapping("/execute")</span>
    <span class="hljs-meta">@ResponseBody</span>
    <span class="hljs-keyword">public</span> ApiResponse&lt;LotteryResult&gt; <span class="hljs-title function_">executeDraw</span><span class="hljs-params">(
            <span class="hljs-meta">@RequestParam</span> Long prizeId,
            <span class="hljs-meta">@RequestParam(defaultValue = "RANDOM")</span> String mode)</span> {
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">LotteryResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> lotteryService.drawWithMode(prizeId, mode);
            
            <span class="hljs-comment">// å‘é€å®æ—¶é€šçŸ¥</span>
            webSocketHandler.broadcastWinningMessage(
                result.getWinner(), 
                result.getPrize()
            );
            
            <span class="hljs-keyword">return</span> ApiResponse.success(result);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">return</span> ApiResponse.error(e.getMessage());
        }
    }
    
    <span class="hljs-comment">/**
     * å¤§å±å¹•æ˜¾ç¤º
     */</span>
    <span class="hljs-meta">@GetMapping("/screen")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">bigScreen</span><span class="hljs-params">(Model model)</span> {
        List&lt;WinningRecord&gt; recentWinners = lotteryService.getRecentWinners(<span class="hljs-number">10</span>);
        model.addAttribute(<span class="hljs-string">"winners"</span>, recentWinners);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"lottery/screen"</span>;
    }
    
    <span class="hljs-comment">/**
     * æ•°æ®ç»Ÿè®¡
     */</span>
    <span class="hljs-meta">@GetMapping("/statistics")</span>
    <span class="hljs-meta">@ResponseBody</span>
    <span class="hljs-keyword">public</span> ApiResponse&lt;Statistics&gt; <span class="hljs-title function_">getStatistics</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Statistics</span> <span class="hljs-variable">stats</span> <span class="hljs-operator">=</span> lotteryService.getLotteryStatistics();
        <span class="hljs-keyword">return</span> ApiResponse.success(stats);
    }
}
</code></pre>
<h4 data-id="heading-13">5.6 å‰ç«¯æŠ½å¥–é¡µé¢å®ç°</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">"http://www.thymeleaf.org"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>å¹´ä¼šæŠ½å¥–ç³»ç»Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- Bootstrap CSS --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-class">.lottery-container</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#667eea</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#764ba2</span> <span class="hljs-number">100%</span>);
            <span class="hljs-attribute">min-height</span>: <span class="hljs-number">100vh</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
        }
        
        <span class="hljs-selector-class">.prize-card</span> {
            <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;
            <span class="hljs-attribute">cursor</span>: pointer;
        }
        
        <span class="hljs-selector-class">.prize-card</span><span class="hljs-selector-pseudo">:hover</span> {
            <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">5px</span>);
            <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">20px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.2</span>);
        }
        
        <span class="hljs-selector-class">.lottery-wheel</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">500px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">500px</span>;
            <span class="hljs-attribute">position</span>: relative;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;
        }
        
        <span class="hljs-selector-class">.wheel-canvas</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
        }
        
        <span class="hljs-selector-class">.winner-display</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0.9</span>);
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">animation</span>: slideIn <span class="hljs-number">0.5s</span> ease;
        }
        
        <span class="hljs-keyword">@keyframes</span> slideIn {
            <span class="hljs-selector-tag">from</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">50px</span>); <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; }
            <span class="hljs-selector-tag">to</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0</span>); <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; }
        }
        
        <span class="hljs-selector-class">.confetti</span> {
            <span class="hljs-attribute">position</span>: fixed;
            <span class="hljs-attribute">width</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f00</span>;
            <span class="hljs-attribute">top</span>: -<span class="hljs-number">10px</span>;
            <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
        }
        
        <span class="hljs-keyword">@keyframes</span> confetti-fall {
            <span class="hljs-number">0%</span> { <span class="hljs-attribute">top</span>: -<span class="hljs-number">10px</span>; <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; }
            <span class="hljs-number">100%</span> { <span class="hljs-attribute">top</span>: <span class="hljs-number">100vh</span>; <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; }
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lottery-container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- æ ‡é¢˜åŒºåŸŸ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-center text-white mb-5"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"display-3 fw-bold"</span>&gt;</span>ğŸ‰ å¹´ä¼šå¹¸è¿å¤§æŠ½å¥– ğŸ‰<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lead"</span>&gt;</span>æ¢¦æƒ³æˆçœŸï¼Œå¹¸è¿é™ä¸´<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            
            <span class="hljs-comment">&lt;!-- æŠ½å¥–ä¸»åŒºåŸŸ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"row"</span>&gt;</span>
                <span class="hljs-comment">&lt;!-- å·¦ä¾§ï¼šå¥–å“é€‰æ‹© --&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-md-4"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-header bg-primary text-white"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-0"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-gift"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> å¥–å“åˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-body"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"prizeList"</span>&gt;</span>
                            <span class="hljs-comment">&lt;!-- å¥–å“åˆ—è¡¨åŠ¨æ€åŠ è½½ --&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    
                    <span class="hljs-comment">&lt;!-- æŠ½å¥–æ§åˆ¶ --&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card mt-3"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-body"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-3"</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-label"</span>&gt;</span>æŠ½å¥–æ¨¡å¼<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-select"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"drawMode"</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"RANDOM"</span>&gt;</span>éšæœºæŠ½å¥–<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"ROULETTE"</span>&gt;</span>å¹¸è¿è½®ç›˜<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"GRID"</span>&gt;</span>ä¹å®«æ ¼æŠ½å¥–<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"LUCKY_NUMBER"</span>&gt;</span>å¹¸è¿æ•°å­—<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
                                <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-danger btn-lg w-100"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"drawButton"</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-play"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> å¼€å§‹æŠ½å¥–
                            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                
                <span class="hljs-comment">&lt;!-- ä¸­é—´ï¼šæŠ½å¥–åŠ¨ç”» --&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-md-4"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lottery-wheel"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"wheelCanvas"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"wheel-canvas"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-center mt-3"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"winner-display"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"winnerDisplay"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display:none;"</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">h4</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-success"</span>&gt;</span>ğŸŠ æ­å–œä¸­å¥–ï¼ ğŸŠ<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"winnerName"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fw-bold"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è·å¾—ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"prizeName"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-primary"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                
                <span class="hljs-comment">&lt;!-- å³ä¾§ï¼šä¸­å¥–åå• --&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-md-4"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-header bg-success text-white"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-0"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-trophy"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> ä¸­å¥–åå•<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-body"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"winnerList"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"list-group"</span>&gt;</span>
                                <span class="hljs-comment">&lt;!-- ä¸­å¥–åå•åŠ¨æ€åŠ è½½ --&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    
                    <span class="hljs-comment">&lt;!-- ç»Ÿè®¡æ•°æ® --&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card mt-3"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-body"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">h6</span>&gt;</span>æŠ½å¥–ç»Ÿè®¡<span class="hljs-tag">&lt;/<span class="hljs-name">h6</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"row text-center"</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-6"</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"display-6"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"totalAttendees"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>å‚ä¼šäººæ•°<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span>
                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-6"</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"display-6"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"totalWinners"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>å·²ä¸­å¥–äººæ•°<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span>
                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- WebSocketè¿æ¥ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/stomp.js/2.3.3/stomp.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotterySystem</span> {
            <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">stompClient</span> = <span class="hljs-literal">null</span>;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentPrizeId</span> = <span class="hljs-literal">null</span>;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">false</span>;
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
            }
            
            <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadPrizes</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadWinners</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadStatistics</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">connectWebSocket</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">bindEvents</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initWheel</span>();
            }
            
            <span class="hljs-title function_">connectWebSocket</span>(<span class="hljs-params"/>) {
                <span class="hljs-keyword">const</span> socket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SockJS</span>(<span class="hljs-string">'/ws/lottery'</span>);
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">stompClient</span> = <span class="hljs-title class_">Stomp</span>.<span class="hljs-title function_">over</span>(socket);
                
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">stompClient</span>.<span class="hljs-title function_">connect</span>({}, <span class="hljs-function">(<span class="hljs-params">frame</span>) =&gt;</span> {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Connected: '</span> + frame);
                    
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stompClient</span>.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">'/topic/winners'</span>, <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> {
                        <span class="hljs-keyword">const</span> notification = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(message.<span class="hljs-property">body</span>);
                        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showWinningNotification</span>(notification);
                        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadWinners</span>();
                        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadStatistics</span>();
                    });
                });
            }
            
            <span class="hljs-title function_">loadPrizes</span>(<span class="hljs-params"/>) {
                $.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/lottery/prizes'</span>, <span class="hljs-function">(<span class="hljs-params">prizes</span>) =&gt;</span> {
                    <span class="hljs-keyword">const</span> container = $(<span class="hljs-string">'#prizeList'</span>);
                    container.<span class="hljs-title function_">empty</span>();
                    
                    prizes.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">prize</span> =&gt;</span> {
                        <span class="hljs-keyword">const</span> card = <span class="hljs-string">`
                            &lt;div class="card prize-card mb-2" data-prize-id="<span class="hljs-subst">${prize.id}</span>"&gt;
                                &lt;div class="card-body"&gt;
                                    &lt;h6 class="card-title"&gt;<span class="hljs-subst">${prize.name}</span>&lt;/h6&gt;
                                    &lt;p class="card-text text-muted small"&gt;å‰©ä½™: <span class="hljs-subst">${prize.remainCount}</span>/<span class="hljs-subst">${prize.totalCount}</span>&lt;/p&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                        `</span>;
                        container.<span class="hljs-title function_">append</span>(card);
                    });
                    
                    <span class="hljs-comment">// ç»‘å®šé€‰æ‹©äº‹ä»¶</span>
                    $(<span class="hljs-string">'.prize-card'</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
                        $(<span class="hljs-string">'.prize-card'</span>).<span class="hljs-title function_">removeClass</span>(<span class="hljs-string">'border-primary'</span>);
                        $(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">addClass</span>(<span class="hljs-string">'border-primary border-3'</span>);
                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentPrizeId</span> = $(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">data</span>(<span class="hljs-string">'prize-id'</span>);
                    });
                });
            }
            
            <span class="hljs-title function_">loadWinners</span>(<span class="hljs-params"/>) {
                $.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/lottery/recent-winners'</span>, <span class="hljs-function">(<span class="hljs-params">winners</span>) =&gt;</span> {
                    <span class="hljs-keyword">const</span> container = $(<span class="hljs-string">'#winnerList'</span>);
                    container.<span class="hljs-title function_">empty</span>();
                    
                    winners.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">record</span> =&gt;</span> {
                        <span class="hljs-keyword">const</span> item = <span class="hljs-string">`
                            &lt;div class="list-group-item"&gt;
                                &lt;div class="d-flex w-100 justify-content-between"&gt;
                                    &lt;h6 class="mb-1"&gt;<span class="hljs-subst">${record.employeeName}</span>&lt;/h6&gt;
                                    &lt;small&gt;<span class="hljs-subst">${record.department}</span>&lt;/small&gt;
                                &lt;/div&gt;
                                &lt;p class="mb-1"&gt;<span class="hljs-subst">${record.prizeName}</span>&lt;/p&gt;
                                &lt;small class="text-muted"&gt;<span class="hljs-subst">${record.drawTime}</span>&lt;/small&gt;
                            &lt;/div&gt;
                        `</span>;
                        container.<span class="hljs-title function_">prepend</span>(item);
                    });
                });
            }
            
            <span class="hljs-title function_">loadStatistics</span>(<span class="hljs-params"/>) {
                $.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/lottery/statistics'</span>, <span class="hljs-function">(<span class="hljs-params">stats</span>) =&gt;</span> {
                    $(<span class="hljs-string">'#totalAttendees'</span>).<span class="hljs-title function_">text</span>(stats.<span class="hljs-property">totalAttendees</span>);
                    $(<span class="hljs-string">'#totalWinners'</span>).<span class="hljs-title function_">text</span>(stats.<span class="hljs-property">totalWinners</span>);
                });
            }
            
            <span class="hljs-title function_">bindEvents</span>(<span class="hljs-params"/>) {
                $(<span class="hljs-string">'#drawButton'</span>).<span class="hljs-title function_">click</span>(<span class="hljs-function">() =&gt;</span> {
                    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentPrizeId</span>) {
                        <span class="hljs-title function_">alert</span>(<span class="hljs-string">'è¯·å…ˆé€‰æ‹©å¥–å“ï¼'</span>);
                        <span class="hljs-keyword">return</span>;
                    }
                    
                    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span>) {
                        <span class="hljs-title function_">alert</span>(<span class="hljs-string">'æ­£åœ¨æŠ½å¥–ä¸­ï¼Œè¯·ç¨å€™...'</span>);
                        <span class="hljs-keyword">return</span>;
                    }
                    
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">true</span>;
                    $(<span class="hljs-string">'#drawButton'</span>).<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">true</span>).<span class="hljs-title function_">html</span>(<span class="hljs-string">'&lt;i class="fas fa-spinner fa-spin"&gt;&lt;/i&gt; æŠ½å¥–ä¸­...'</span>);
                    
                    <span class="hljs-keyword">const</span> drawMode = $(<span class="hljs-string">'#drawMode'</span>).<span class="hljs-title function_">val</span>();
                    
                    <span class="hljs-comment">// å¼€å§‹æŠ½å¥–åŠ¨ç”»</span>
                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startWheelAnimation</span>();
                    
                    <span class="hljs-comment">// å‘é€æŠ½å¥–è¯·æ±‚</span>
                    $.<span class="hljs-title function_">ajax</span>({
                        <span class="hljs-attr">url</span>: <span class="hljs-string">'/lottery/execute'</span>,
                        <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
                        <span class="hljs-attr">data</span>: {
                            <span class="hljs-attr">prizeId</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentPrizeId</span>,
                            <span class="hljs-attr">mode</span>: drawMode
                        },
                        <span class="hljs-attr">success</span>: <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
                            <span class="hljs-keyword">if</span> (response.<span class="hljs-property">success</span>) {
                                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showWinner</span>(response.<span class="hljs-property">data</span>);
                                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createConfetti</span>();
                                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">false</span>;
                                    $(<span class="hljs-string">'#drawButton'</span>).<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">false</span>).<span class="hljs-title function_">html</span>(<span class="hljs-string">'&lt;i class="fas fa-play"&gt;&lt;/i&gt; å¼€å§‹æŠ½å¥–'</span>);
                                }, <span class="hljs-number">3000</span>);
                            } <span class="hljs-keyword">else</span> {
                                <span class="hljs-title function_">alert</span>(response.<span class="hljs-property">message</span>);
                                <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">false</span>;
                                $(<span class="hljs-string">'#drawButton'</span>).<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">false</span>).<span class="hljs-title function_">html</span>(<span class="hljs-string">'&lt;i class="fas fa-play"&gt;&lt;/i&gt; å¼€å§‹æŠ½å¥–'</span>);
                            }
                        },
                        <span class="hljs-attr">error</span>: <span class="hljs-function">() =&gt;</span> {
                            <span class="hljs-title function_">alert</span>(<span class="hljs-string">'æŠ½å¥–å¤±è´¥ï¼Œè¯·é‡è¯•ï¼'</span>);
                            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">false</span>;
                            $(<span class="hljs-string">'#drawButton'</span>).<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">false</span>).<span class="hljs-title function_">html</span>(<span class="hljs-string">'&lt;i class="fas fa-play"&gt;&lt;/i&gt; å¼€å§‹æŠ½å¥–'</span>);
                        }
                    });
                });
            }
            
            <span class="hljs-title function_">startWheelAnimation</span>(<span class="hljs-params"/>) {
                <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'wheelCanvas'</span>);
                <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>);
                <span class="hljs-keyword">const</span> centerX = canvas.<span class="hljs-property">width</span> / <span class="hljs-number">2</span>;
                <span class="hljs-keyword">const</span> centerY = canvas.<span class="hljs-property">height</span> / <span class="hljs-number">2</span>;
                <span class="hljs-keyword">const</span> radius = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(centerX, centerY) - <span class="hljs-number">10</span>;
                
                <span class="hljs-keyword">let</span> rotation = <span class="hljs-number">0</span>;
                
                <span class="hljs-keyword">const</span> <span class="hljs-title function_">animate</span> = (<span class="hljs-params"/>) =&gt; {
                    ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>);
                    
                    <span class="hljs-comment">// ç»˜åˆ¶è½¬ç›˜</span>
                    rotation += <span class="hljs-number">0.1</span>;
                    
                    <span class="hljs-comment">// ç»˜åˆ¶æ‰‡å½¢</span>
                    <span class="hljs-keyword">const</span> segments = <span class="hljs-number">12</span>;
                    <span class="hljs-keyword">const</span> segmentAngle = (<span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>) / segments;
                    
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; segments; i++) {
                        <span class="hljs-keyword">const</span> startAngle = segmentAngle * i + rotation;
                        <span class="hljs-keyword">const</span> endAngle = segmentAngle * (i + <span class="hljs-number">1</span>) + rotation;
                        
                        ctx.<span class="hljs-title function_">beginPath</span>();
                        ctx.<span class="hljs-title function_">moveTo</span>(centerX, centerY);
                        ctx.<span class="hljs-title function_">arc</span>(centerX, centerY, radius, startAngle, endAngle);
                        ctx.<span class="hljs-title function_">closePath</span>();
                        
                        <span class="hljs-comment">// äº¤æ›¿é¢œè‰²</span>
                        ctx.<span class="hljs-property">fillStyle</span> = i % <span class="hljs-number">2</span> === <span class="hljs-number">0</span> ? <span class="hljs-string">'#FF6B6B'</span> : <span class="hljs-string">'#4ECDC4'</span>;
                        ctx.<span class="hljs-title function_">fill</span>();
                        
                        <span class="hljs-comment">// ç»˜åˆ¶æ–‡å­—</span>
                        ctx.<span class="hljs-title function_">save</span>();
                        ctx.<span class="hljs-title function_">translate</span>(centerX, centerY);
                        ctx.<span class="hljs-title function_">rotate</span>(startAngle + segmentAngle / <span class="hljs-number">2</span>);
                        ctx.<span class="hljs-property">textAlign</span> = <span class="hljs-string">'right'</span>;
                        ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">'white'</span>;
                        ctx.<span class="hljs-property">font</span> = <span class="hljs-string">'bold 14px Arial'</span>;
                        ctx.<span class="hljs-title function_">fillText</span>(<span class="hljs-string">'å¹¸è¿'</span>, radius - <span class="hljs-number">20</span>, <span class="hljs-number">10</span>);
                        ctx.<span class="hljs-title function_">restore</span>();
                    }
                    
                    <span class="hljs-comment">// ç»˜åˆ¶æŒ‡é’ˆ</span>
                    ctx.<span class="hljs-title function_">beginPath</span>();
                    ctx.<span class="hljs-title function_">moveTo</span>(centerX, centerY - <span class="hljs-number">20</span>);
                    ctx.<span class="hljs-title function_">lineTo</span>(centerX, centerY - radius + <span class="hljs-number">20</span>);
                    ctx.<span class="hljs-title function_">lineTo</span>(centerX + <span class="hljs-number">10</span>, centerY - radius);
                    ctx.<span class="hljs-title function_">lineTo</span>(centerX - <span class="hljs-number">10</span>, centerY - radius);
                    ctx.<span class="hljs-title function_">closePath</span>();
                    ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">'#FFD93D'</span>;
                    ctx.<span class="hljs-title function_">fill</span>();
                    
                    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span>) {
                        <span class="hljs-title function_">requestAnimationFrame</span>(animate);
                    }
                };
                
                canvas.<span class="hljs-property">width</span> = <span class="hljs-number">500</span>;
                canvas.<span class="hljs-property">height</span> = <span class="hljs-number">500</span>;
                <span class="hljs-title function_">animate</span>();
            }
            
            <span class="hljs-title function_">showWinner</span>(<span class="hljs-params">result</span>) {
                $(<span class="hljs-string">'#winnerName'</span>).<span class="hljs-title function_">text</span>(result.<span class="hljs-property">winner</span>.<span class="hljs-property">name</span>);
                $(<span class="hljs-string">'#prizeName'</span>).<span class="hljs-title function_">text</span>(result.<span class="hljs-property">prize</span>.<span class="hljs-property">name</span>);
                $(<span class="hljs-string">'#winnerDisplay'</span>).<span class="hljs-title function_">fadeIn</span>();
                
                <span class="hljs-comment">// æ’­æ”¾éŸ³æ•ˆ</span>
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">playSound</span>(<span class="hljs-string">'winning'</span>);
            }
            
            <span class="hljs-title function_">showWinningNotification</span>(<span class="hljs-params">notification</span>) {
                <span class="hljs-comment">// æ˜¾ç¤ºå®æ—¶é€šçŸ¥</span>
                <span class="hljs-keyword">const</span> notificationHtml = <span class="hljs-string">`
                    &lt;div class="toast show" role="alert"&gt;
                        &lt;div class="toast-header bg-success text-white"&gt;
                            &lt;strong class="me-auto"&gt;ğŸ‰ æ­å–œä¸­å¥–ï¼&lt;/strong&gt;
                            &lt;small&gt;åˆšåˆš&lt;/small&gt;
                        &lt;/div&gt;
                        &lt;div class="toast-body"&gt;
                            &lt;strong&gt;<span class="hljs-subst">${notification.winner}</span>&lt;/strong&gt; è·å¾— &lt;strong&gt;<span class="hljs-subst">${notification.prize}</span>&lt;/strong&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                `</span>;
                
                $(<span class="hljs-string">'.toast-container'</span>).<span class="hljs-title function_">remove</span>();
                $(<span class="hljs-string">'body'</span>).<span class="hljs-title function_">append</span>(<span class="hljs-string">`&lt;div class="toast-container position-fixed top-0 end-0 p-3"&gt;<span class="hljs-subst">${notificationHtml}</span>&lt;/div&gt;`</span>);
                
                <span class="hljs-comment">// 5ç§’åè‡ªåŠ¨ç§»é™¤</span>
                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                    $(<span class="hljs-string">'.toast-container'</span>).<span class="hljs-title function_">remove</span>();
                }, <span class="hljs-number">5000</span>);
            }
            
            <span class="hljs-title function_">createConfetti</span>(<span class="hljs-params"/>) {
                <span class="hljs-keyword">const</span> colors = [<span class="hljs-string">'#FF6B6B'</span>, <span class="hljs-string">'#4ECDC4'</span>, <span class="hljs-string">'#FFD93D'</span>, <span class="hljs-string">'#6BCF7F'</span>];
                
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
                    <span class="hljs-keyword">const</span> confetti = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
                    confetti.<span class="hljs-property">className</span> = <span class="hljs-string">'confetti'</span>;
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">100</span> + <span class="hljs-string">'vw'</span>;
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = colors[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * colors.<span class="hljs-property">length</span>)];
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span> + <span class="hljs-number">5</span> + <span class="hljs-string">'px'</span>;
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span> + <span class="hljs-number">5</span> + <span class="hljs-string">'px'</span>;
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">animation</span> = <span class="hljs-string">`confetti-fall <span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span> + <span class="hljs-number">2</span>}</span>s linear forwards`</span>;
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">animationDelay</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">1</span> + <span class="hljs-string">'s'</span>;
                    
                    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(confetti);
                    
                    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                        confetti.<span class="hljs-title function_">remove</span>();
                    }, <span class="hljs-number">5000</span>);
                }
            }
            
            <span class="hljs-title function_">playSound</span>(<span class="hljs-params">type</span>) {
                <span class="hljs-keyword">const</span> audio = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Audio</span>();
                <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'winning'</span>) {
                    audio.<span class="hljs-property">src</span> = <span class="hljs-string">'/sound/winning.mp3'</span>;
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'draw'</span>) {
                    audio.<span class="hljs-property">src</span> = <span class="hljs-string">'/sound/draw.mp3'</span>;
                }
                audio.<span class="hljs-title function_">play</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'éŸ³é¢‘æ’­æ”¾å¤±è´¥:'</span>, e));
            }
            
            <span class="hljs-title function_">initWheel</span>(<span class="hljs-params"/>) {
                <span class="hljs-comment">// åˆå§‹åŒ–æŠ½å¥–è½¬ç›˜</span>
                <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'wheelCanvas'</span>);
                <span class="hljs-keyword">if</span> (canvas.<span class="hljs-property">getContext</span>) {
                    <span class="hljs-comment">// å·²ç»åœ¨ä¸Šé¢çš„startWheelAnimationä¸­åˆå§‹åŒ–äº†</span>
                }
            }
        }
        
        <span class="hljs-comment">// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–</span>
        $(<span class="hljs-variable language_">document</span>).<span class="hljs-title function_">ready</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">window</span>.<span class="hljs-property">lotterySystem</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LotterySystem</span>();
        });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h3 data-id="heading-14">å…­ã€ç³»ç»Ÿç‰¹è‰²åŠŸèƒ½</h3>
<h4 data-id="heading-15">6.1 å¤šç§æŠ½å¥–æ¨¡å¼</h4>
<ol>
<li><strong>éšæœºæŠ½å¥–</strong>ï¼šå®Œå…¨éšæœºï¼Œç¡®ä¿å…¬å¹³</li>
<li><strong>å¹¸è¿è½®ç›˜</strong>ï¼šè§†è§‰å†²å‡»åŠ›å¼ºï¼Œå¢åŠ è¶£å‘³æ€§</li>
<li><strong>ä¹å®«æ ¼æŠ½å¥–</strong>ï¼šäº’åŠ¨æ€§å¼ºï¼Œé€‚åˆå°å›¢é˜Ÿ</li>
<li><strong>å¹¸è¿æ•°å­—</strong>ï¼šä¸å‘˜å·¥å·¥å·å…³è”ï¼Œå¢åŠ å‚ä¸æ„Ÿ</li>
</ol>
<h4 data-id="heading-16">6.2 å®æ—¶äº’åŠ¨åŠŸèƒ½</h4>
<ul>
<li><strong>WebSocketå®æ—¶é€šçŸ¥</strong>ï¼šä¸­å¥–ç»“æœå®æ—¶æ¨é€åˆ°æ‰€æœ‰å®¢æˆ·ç«¯</li>
<li><strong>å¤§å±å¹•æ˜¾ç¤º</strong>ï¼šä¸“é—¨ä¸ºä¸­å¥–å±•ç¤ºè®¾è®¡çš„å…¨å±ç•Œé¢</li>
<li><strong>å¼¹å¹•äº’åŠ¨</strong>ï¼šå‘˜å·¥å¯ä»¥å‘é€ç¥ç¦å¼¹å¹•</li>
<li><strong>å€’è®¡æ—¶åŠŸèƒ½</strong>ï¼šå¢åŠ ç´§å¼ æ°›å›´</li>
</ul>
<h4 data-id="heading-17">6.3 é˜²ä½œå¼Šæœºåˆ¶</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotterySecurityService</span> {
    
    <span class="hljs-comment">/**
     * éªŒè¯æŠ½å¥–è¯·æ±‚çš„åˆæ³•æ€§
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validateDrawRequest</span><span class="hljs-params">(String sessionId, Long prizeId)</span> {
        <span class="hljs-comment">// é˜²æ­¢é¢‘ç¹è¯·æ±‚</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-string">"draw:limit:"</span> + sessionId;
        <span class="hljs-type">Long</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> redisTemplate.opsForValue().increment(key, <span class="hljs-number">1</span>);
        
        <span class="hljs-keyword">if</span> (count == <span class="hljs-number">1</span>) {
            redisTemplate.expire(key, <span class="hljs-number">10</span>, TimeUnit.SECONDS);
        }
        
        <span class="hljs-keyword">return</span> count &lt;= <span class="hljs-number">3</span>; <span class="hljs-comment">// 10ç§’å†…æœ€å¤šè¯·æ±‚3æ¬¡</span>
    }
    
    <span class="hljs-comment">/**
     * éªŒè¯å‘˜å·¥èµ„æ ¼
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validateEmployeeEligibility</span><span class="hljs-params">(String employeeId)</span> {
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å·²ç­¾åˆ°</span>
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å·²ä¸­å¥–ï¼ˆé™åˆ¶æ¯äººæœ€å¤šä¸­å¥–æ¬¡æ•°ï¼‰</span>
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ç¬¦åˆç‰¹å®šå¥–å“è¦æ±‚</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-comment">/**
     * ç”ŸæˆæŠ½å¥–è¿‡ç¨‹å®¡è®¡æ—¥å¿—
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">auditDrawProcess</span><span class="hljs-params">(LotteryResult result, String operator)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">auditLog</span> <span class="hljs-operator">=</span> String.format(
            <span class="hljs-string">"æŠ½å¥–å®¡è®¡ - æ“ä½œäºº:%s, å¥–å“:%s, ä¸­å¥–äºº:%s, æ—¶é—´:%s, éšæœºç§å­:%s"</span>,
            operator,
            result.getPrize().getName(),
            result.getWinner().getName(),
            LocalDateTime.now(),
            generateRandomSeed()
        );
        
        log.info(auditLog);
        saveToBlockchain(auditLog); <span class="hljs-comment">// å¯é€‰ï¼šä¿å­˜åˆ°åŒºå—é“¾ç¡®ä¿ä¸å¯ç¯¡æ”¹</span>
    }
}
</code></pre>
<h4 data-id="heading-18">6.4 æ•°æ®ç»Ÿè®¡ä¸åˆ†æ</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StatisticsService</span> {
    
    <span class="hljs-keyword">public</span> LotteryStatistics <span class="hljs-title function_">getStatistics</span><span class="hljs-params">()</span> {
        <span class="hljs-type">LotteryStatistics</span> <span class="hljs-variable">stats</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LotteryStatistics</span>();
        
        <span class="hljs-comment">// åŸºç¡€ç»Ÿè®¡</span>
        stats.setTotalAttendees(employeeRepository.countByIsAttendedTrue());
        stats.setTotalWinners(winningRecordRepository.count());
        stats.setTotalPrizes(prizeRepository.count());
        
        <span class="hljs-comment">// éƒ¨é—¨ä¸­å¥–åˆ†å¸ƒ</span>
        Map&lt;String, Long&gt; deptDistribution = winningRecordRepository
            .getDepartmentDistribution();
        stats.setDepartmentDistribution(deptDistribution);
        
        <span class="hljs-comment">// æ—¶é—´æ®µåˆ†æ</span>
        List&lt;HourlyDraw&gt; hourlyDraws = winningRecordRepository
            .getHourlyDrawCount();
        stats.setHourlyDraws(hourlyDraws);
        
        <span class="hljs-comment">// å¥–å“çƒ­åº¦</span>
        List&lt;PrizePopularity&gt; prizePopularity = winningRecordRepository
            .getPrizePopularity();
        stats.setPrizePopularity(prizePopularity);
        
        <span class="hljs-keyword">return</span> stats;
    }
    
    <span class="hljs-comment">/**
     * ç”ŸæˆæŠ½å¥–æŠ¥å‘Š
     */</span>
    <span class="hljs-keyword">public</span> Report <span class="hljs-title function_">generateReport</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Report</span> <span class="hljs-variable">report</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Report</span>();
        
        <span class="hljs-comment">// æ€»ä½“æƒ…å†µ</span>
        report.setSummary(getSummary());
        
        <span class="hljs-comment">// è¯¦ç»†æ•°æ®</span>
        report.setDetails(getDetailedData());
        
        <span class="hljs-comment">// å›¾è¡¨æ•°æ®</span>
        report.setCharts(getChartData());
        
        <span class="hljs-comment">// åˆ†æç»“è®º</span>
        report.setAnalysis(getAnalysis());
        
        <span class="hljs-keyword">return</span> report;
    }
}
</code></pre>
<h3 data-id="heading-19">ä¸ƒã€éƒ¨ç½²ä¸é…ç½®</h3>
<h4 data-id="heading-20">7.1 åº”ç”¨é…ç½®</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># application.yml</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
  
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">datasource:</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/lottery_db?useSSL=false&amp;serverTimezone=UTC</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">lottery_admin</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">lottery_password</span>
    <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span>
    
  <span class="hljs-attr">jpa:</span>
    <span class="hljs-attr">hibernate:</span>
      <span class="hljs-attr">ddl-auto:</span> <span class="hljs-string">update</span>
    <span class="hljs-attr">show-sql:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">properties:</span>
      <span class="hljs-attr">hibernate:</span>
        <span class="hljs-attr">format_sql:</span> <span class="hljs-literal">true</span>
        
  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">6379</span>
    <span class="hljs-attr">password:</span> 
    <span class="hljs-attr">timeout:</span> <span class="hljs-string">5000ms</span>
    
  <span class="hljs-attr">thymeleaf:</span>
    <span class="hljs-attr">cache:</span> <span class="hljs-literal">false</span>
    <span class="hljs-attr">mode:</span> <span class="hljs-string">HTML</span>
    <span class="hljs-attr">encoding:</span> <span class="hljs-string">UTF-8</span>
    
<span class="hljs-attr">lottery:</span>
  <span class="hljs-attr">security:</span>
    <span class="hljs-attr">admin-username:</span> <span class="hljs-string">admin</span>
    <span class="hljs-attr">admin-password:</span> <span class="hljs-string">${ADMIN_PASSWORD:admin123}</span>
    <span class="hljs-attr">jwt-secret:</span> <span class="hljs-string">${JWT_SECRET:lottery-secret-key}</span>
    
  <span class="hljs-attr">draw:</span>
    <span class="hljs-attr">max-attempts-per-minute:</span> <span class="hljs-number">10</span>
    <span class="hljs-attr">cooldown-seconds:</span> <span class="hljs-number">5</span>
    
  <span class="hljs-attr">ui:</span>
    <span class="hljs-attr">title:</span> <span class="hljs-string">å¹´ä¼šå¹¸è¿å¤§æŠ½å¥–</span>
    <span class="hljs-attr">theme:</span> <span class="hljs-string">gradient-blue</span>
    <span class="hljs-attr">animation-enabled:</span> <span class="hljs-literal">true</span>
</code></pre>
<h4 data-id="heading-21">7.2 Dockeréƒ¨ç½²</h4>
<pre><code class="hljs language-dockerfile" lang="dockerfile"># Dockerfile
FROM openjdk:11-jre-slim

WORKDIR /app

COPY target/lottery-system-1.0.0.jar app.jar

RUN mkdir -p /app/logs /app/uploads

ENV TZ=Asia/Shanghai
ENV JAVA_OPTS="-Xmx512m -Xms256m"

EXPOSE 8080

ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar app.jar"]
</code></pre>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># docker-compose.yml</span>
<span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-attr">mysql:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:8.0</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">root_password</span>
      <span class="hljs-attr">MYSQL_DATABASE:</span> <span class="hljs-string">lottery_db</span>
      <span class="hljs-attr">MYSQL_USER:</span> <span class="hljs-string">lottery_admin</span>
      <span class="hljs-attr">MYSQL_PASSWORD:</span> <span class="hljs-string">lottery_password</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"3306:3306"</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">mysql_data:/var/lib/mysql</span>
      
  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">redis:7-alpine</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"6379:6379"</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">redis_data:/data</span>
      
  <span class="hljs-attr">lottery-app:</span>
    <span class="hljs-attr">build:</span> <span class="hljs-string">.</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"8080:8080"</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">SPRING_DATASOURCE_URL:</span> <span class="hljs-string">jdbc:mysql://mysql:3306/lottery_db</span>
      <span class="hljs-attr">SPRING_REDIS_HOST:</span> <span class="hljs-string">redis</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">mysql</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">redis</span>
      
<span class="hljs-attr">volumes:</span>
  <span class="hljs-attr">mysql_data:</span>
  <span class="hljs-attr">redis_data:</span>
</code></pre>
<h3 data-id="heading-22">å…«ã€ç³»ç»Ÿä¼˜åŒ–ä¸æ‰©å±•</h3>
<h4 data-id="heading-23">8.1 æ€§èƒ½ä¼˜åŒ–</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotteryOptimizationService</span> {
    
    <span class="hljs-comment">/**
     * ä½¿ç”¨Redisç¼“å­˜çƒ­é—¨æ•°æ®
     */</span>
    <span class="hljs-meta">@Cacheable(value = "prizes", key = "'available'")</span>
    <span class="hljs-keyword">public</span> List&lt;Prize&gt; <span class="hljs-title function_">getAvailablePrizes</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> prizeRepository.findByRemainCountGreaterThan(<span class="hljs-number">0</span>);
    }
    
    <span class="hljs-comment">/**
     * æ‰¹é‡å¤„ç†ä¼˜åŒ–
     */</span>
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">batchProcessWinners</span><span class="hljs-params">(List&lt;Long&gt; winnerIds, Long prizeId)</span> {
        <span class="hljs-comment">// ä½¿ç”¨æ‰¹é‡æ’å…¥æé«˜æ€§èƒ½</span>
        List&lt;WinningRecord&gt; records = winnerIds.stream()
            .map(employeeId -&gt; {
                <span class="hljs-type">WinningRecord</span> <span class="hljs-variable">record</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WinningRecord</span>();
                record.setEmployeeId(employeeId.toString());
                record.setPrizeId(prizeId);
                <span class="hljs-keyword">return</span> record;
            })
            .collect(Collectors.toList());
            
        winningRecordRepository.saveAll(records);
    }
    
    <span class="hljs-comment">/**
     * å¼‚æ­¥å¤„ç†éæ ¸å¿ƒä¸šåŠ¡
     */</span>
    <span class="hljs-meta">@Async</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">asyncSendNotification</span><span class="hljs-params">(WinningRecord record)</span> {
        <span class="hljs-comment">// å‘é€é‚®ä»¶é€šçŸ¥</span>
        emailService.sendWinningEmail(record);
        
        <span class="hljs-comment">// å‘é€çŸ­ä¿¡é€šçŸ¥</span>
        smsService.sendWinningSMS(record);
        
        <span class="hljs-comment">// è®°å½•æ—¥å¿—</span>
        auditService.logWinningEvent(record);
    }
}
</code></pre>
<h4 data-id="heading-24">8.2 æ‰©å±•åŠŸèƒ½</h4>
<ol>
<li><strong>å¾®ä¿¡å°ç¨‹åºæ¥å…¥</strong>ï¼šå‘˜å·¥æ‰«ç å‚ä¸</li>
<li><strong>äººè„¸è¯†åˆ«ç­¾åˆ°</strong>ï¼šé˜²æ­¢ä»£ç­¾</li>
<li><strong>è™šæ‹Ÿç¤¼ç‰©ç³»ç»Ÿ</strong>ï¼šå‘˜å·¥äº’é€ç¥ç¦</li>
<li><strong>æŠ½å¥–ç­–ç•¥å¼•æ“</strong>ï¼šå¯é…ç½®çš„æŠ½å¥–è§„åˆ™</li>
<li><strong>å¤šä¼šåœºæ”¯æŒ</strong>ï¼šåˆ†å¸ƒå¼æŠ½å¥–åŒæ­¥</li>
</ol>
<h3 data-id="heading-25">ä¹ã€æµ‹è¯•ä¸éªŒè¯</h3>
<h4 data-id="heading-26">9.1 å•å…ƒæµ‹è¯•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-meta">@AutoConfigureMockMvc</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LotteryServiceTest</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> MockMvc mockMvc;
    
    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testRandomDraw</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æµ‹è¯•éšæœºæŠ½å¥–çš„å…¬å¹³æ€§</span>
        Map&lt;Long, Integer&gt; winCount = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        <span class="hljs-type">int</span> <span class="hljs-variable">totalTests</span> <span class="hljs-operator">=</span> <span class="hljs-number">10000</span>;
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; totalTests; i++) {
            <span class="hljs-type">LotteryResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> lotteryService.drawPrize(<span class="hljs-number">1L</span>, <span class="hljs-string">"RANDOM"</span>);
            <span class="hljs-type">Long</span> <span class="hljs-variable">winnerId</span> <span class="hljs-operator">=</span> result.getWinner().getId();
            winCount.put(winnerId, winCount.getOrDefault(winnerId, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);
        }
        
        <span class="hljs-comment">// éªŒè¯åˆ†å¸ƒæ˜¯å¦å‡åŒ€</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">expectedFrequency</span> <span class="hljs-operator">=</span> totalTests / <span class="hljs-number">100.0</span>; <span class="hljs-comment">// å‡è®¾æœ‰100ä¸ªå€™é€‰äºº</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">chiSquare</span> <span class="hljs-operator">=</span> calculateChiSquare(winCount, expectedFrequency);
        
        assertTrue(chiSquare &lt; <span class="hljs-number">15.0</span>, <span class="hljs-string">"æŠ½å¥–åˆ†å¸ƒä¸å‡åŒ€"</span>);
    }
    
    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testConcurrentDraw</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-comment">// æµ‹è¯•å¹¶å‘æŠ½å¥–</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">threadCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;
        <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(threadCount);
        <span class="hljs-type">CountDownLatch</span> <span class="hljs-variable">latch</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CountDownLatch</span>(threadCount);
        
        List&lt;Future&lt;LotteryResult&gt;&gt; futures = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; threadCount; i++) {
            Future&lt;LotteryResult&gt; future = executor.submit(() -&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">return</span> lotteryService.drawPrize(<span class="hljs-number">1L</span>, <span class="hljs-string">"RANDOM"</span>);
                } <span class="hljs-keyword">finally</span> {
                    latch.countDown();
                }
            });
            futures.add(future);
        }
        
        latch.await(<span class="hljs-number">10</span>, TimeUnit.SECONDS);
        
        <span class="hljs-comment">// éªŒè¯æ²¡æœ‰é‡å¤ä¸­å¥–</span>
        Set&lt;Long&gt; winnerIds = futures.stream()
            .map(f -&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">return</span> f.get().getWinner().getId();
                } <span class="hljs-keyword">catch</span> (Exception e) {
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
                }
            })
            .filter(Objects::nonNull)
            .collect(Collectors.toSet());
            
        assertEquals(threadCount, winnerIds.size(), <span class="hljs-string">"å­˜åœ¨é‡å¤ä¸­å¥–æƒ…å†µ"</span>);
    }
}
</code></pre>
<h3 data-id="heading-27">åã€æ€»ç»“</h3>
<p>æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨SpringBoot + Javaæ„å»ºä¸€ä¸ªå…¬æ­£ã€æœ‰è¶£ã€å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿã€‚ç³»ç»Ÿå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ol>
<li><strong>å…¬æ­£æ€§ä¿éšœ</strong>ï¼šä½¿ç”¨åŠ å¯†å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆç®—æ³•ï¼Œæ‰€æœ‰æ“ä½œéƒ½æœ‰å®¡è®¡æ—¥å¿—</li>
<li><strong>è¶£å‘³æ€§ä½“éªŒ</strong>ï¼šå¤šç§æŠ½å¥–æ¨¡å¼ï¼Œç‚«é…·çš„åŠ¨ç”»æ•ˆæœï¼Œå®æ—¶äº’åŠ¨åŠŸèƒ½</li>
<li><strong>é«˜å¯é æ€§</strong>ï¼šæ”¯æŒé«˜å¹¶å‘ï¼Œæ•°æ®æŒä¹…åŒ–ï¼Œå®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶</li>
<li><strong>æ˜“äºæ‰©å±•</strong>ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ–¹ä¾¿æ·»åŠ æ–°åŠŸèƒ½å’ŒæŠ½å¥–æ¨¡å¼</li>
<li><strong>éƒ¨ç½²ç®€å•</strong>ï¼šæ”¯æŒDockerå®¹å™¨åŒ–éƒ¨ç½²ï¼Œä¸€é”®å¯åŠ¨</li>
</ol>
<p>ç³»ç»Ÿä¸ä»…æ»¡è¶³äº†åŸºæœ¬çš„æŠ½å¥–éœ€æ±‚ï¼Œè¿˜é€šè¿‡WebSocketå®æ—¶é€šä¿¡ã€å¤šç§æŠ½å¥–æ¨¡å¼ã€æ•°æ®ç»Ÿè®¡åˆ†æç­‰åŠŸèƒ½ï¼Œå¤§å¤§æå‡äº†å¹´ä¼šçš„äº’åŠ¨æ€§å’Œè¶£å‘³æ€§ã€‚ä¼ä¸šå¯ä»¥æ ¹æ®è‡ªèº«éœ€æ±‚ï¼Œè¿›ä¸€æ­¥æ‰©å±•åŠŸèƒ½ï¼Œå¦‚é›†æˆä¼ä¸šå¾®ä¿¡ã€æ·»åŠ æ›´å¤šäº’åŠ¨æ¸¸æˆç­‰ï¼Œæ‰“é€ ç‹¬ä¸€æ— äºŒçš„å¹´ä¼šæŠ½å¥–ä½“éªŒã€‚</p>
<p>é€šè¿‡æœ¬ç³»ç»Ÿçš„å®æ–½ï¼Œä¼ä¸šå¯ä»¥ç¡®ä¿æŠ½å¥–æ´»åŠ¨çš„å…¬å¹³å…¬æ­£ï¼ŒåŒæ—¶æå‡å‘˜å·¥çš„å‚ä¸æ„Ÿå’Œæ»¡æ„åº¦ï¼Œä¸ºå¹´ä¼šå¢æ·»æ›´å¤šæ¬¢ä¹å’ŒæƒŠå–œã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç‰ˆæœ¬æ›´æ–°ä¸ç¼“å­˜æ¸…é™¤]]></title>    <link>https://juejin.cn/post/7603261102794719258</link>    <guid>https://juejin.cn/post/7603261102794719258</guid>    <pubDate>2026-02-06T02:45:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603261102794719258" data-draft-id="7599630795804491822" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç‰ˆæœ¬æ›´æ–°ä¸ç¼“å­˜æ¸…é™¤"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-06T02:45:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è€€è€€åˆ‡å…‹é—¹ç¬"/> <meta itemprop="url" content="https://juejin.cn/user/1781681116679854"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç‰ˆæœ¬æ›´æ–°ä¸ç¼“å­˜æ¸…é™¤
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1781681116679854/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è€€è€€åˆ‡å…‹é—¹ç¬
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T02:45:02.000Z" title="Fri Feb 06 2026 02:45:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>update-version.js</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-meta">#!/usr/bin/env node</span>

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@FileDesc</span>: éƒ¨ç½²å‰è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·è„šæœ¬
 * <span class="hljs-doctag">@Usage</span>: åœ¨package.jsonçš„buildè„šæœ¬ä¸­è°ƒç”¨
 * ä¾‹å¦‚: "build": "node scripts/update-version.js &amp;&amp; vite build"
 */</span>
#!<span class="hljs-regexp">/usr/</span>bin/env node

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@FileDesc</span>: éƒ¨ç½²å‰è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·è„šæœ¬
 * <span class="hljs-doctag">@Usage</span>: åœ¨package.jsonçš„buildè„šæœ¬ä¸­è°ƒç”¨
 * ä¾‹å¦‚: "build": "node scripts/update-version.js &amp;&amp; vite build"
 */</span>

<span class="hljs-keyword">import</span> { readFileSync, writeFileSync, existsSync, mkdirSync } <span class="hljs-keyword">from</span> <span class="hljs-string">"fs"</span>
<span class="hljs-keyword">import</span> { resolve, join } <span class="hljs-keyword">from</span> <span class="hljs-string">"path"</span>
<span class="hljs-keyword">import</span> { fileURLToPath } <span class="hljs-keyword">from</span> <span class="hljs-string">"url"</span>

<span class="hljs-comment">// è·å–å½“å‰æ–‡ä»¶çš„ç›®å½•</span>
<span class="hljs-keyword">const</span> __filename = <span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>)
<span class="hljs-keyword">const</span> __dirname = <span class="hljs-title function_">resolve</span>(__filename, <span class="hljs-string">".."</span>)

<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// è·å–é¡¹ç›®æ ¹ç›®å½•</span>
    <span class="hljs-keyword">const</span> projectRoot = <span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">"../"</span>)
    <span class="hljs-keyword">const</span> packageJsonPath = <span class="hljs-title function_">join</span>(projectRoot, <span class="hljs-string">"package.json"</span>)
    <span class="hljs-keyword">const</span> versionJsonPath = <span class="hljs-title function_">join</span>(projectRoot, <span class="hljs-string">"public/version.json"</span>)

    <span class="hljs-comment">// ç¡®ä¿ public ç›®å½•å­˜åœ¨</span>
    <span class="hljs-keyword">const</span> publicDir = <span class="hljs-title function_">join</span>(projectRoot, <span class="hljs-string">"public"</span>)
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">existsSync</span>(publicDir)) {
        <span class="hljs-title function_">mkdirSync</span>(publicDir, { <span class="hljs-attr">recursive</span>: <span class="hljs-literal">true</span> })
    }

    <span class="hljs-comment">// ä» package.json è·å–ç‰ˆæœ¬å·</span>
    <span class="hljs-keyword">const</span> packageJsonContent = <span class="hljs-title function_">readFileSync</span>(packageJsonPath, <span class="hljs-string">"utf-8"</span>)
    <span class="hljs-keyword">const</span> packageJson = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(packageJsonContent)
    <span class="hljs-keyword">const</span> version = packageJson.<span class="hljs-property">version</span> || <span class="hljs-string">"1.0.0"</span>

    <span class="hljs-comment">// è·å–å½“å‰æ—¶é—´ï¼ˆISO 8601æ ¼å¼ï¼‰</span>
    <span class="hljs-keyword">const</span> buildTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()

    <span class="hljs-comment">// åˆ›å»º version.json å†…å®¹</span>
    <span class="hljs-keyword">const</span> versionInfo = {
        version,
        buildTime
    }

    <span class="hljs-comment">// å†™å…¥ version.json æ–‡ä»¶</span>
    <span class="hljs-title function_">writeFileSync</span>(versionJsonPath, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(versionInfo, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>))

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"âœ… ç‰ˆæœ¬æ–‡ä»¶å·²æ›´æ–°:"</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`   ç‰ˆæœ¬å·: <span class="hljs-subst">${version}</span>`</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`   æ„å»ºæ—¶é—´: <span class="hljs-subst">${buildTime}</span>`</span>)
} <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"âŒ ç‰ˆæœ¬æ–‡ä»¶æ›´æ–°å¤±è´¥:"</span>, error.<span class="hljs-property">message</span>)
    process.<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>)
}

</code></pre>
<p>version.ts</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/*
 * @FileDesc: ç‰ˆæœ¬ç®¡ç†å’Œæ›´æ–°æ£€æµ‹å·¥å…·
 */</span>

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Toast</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"antd-mobile"</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Dialog</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"antd-mobile"</span>

<span class="hljs-comment">/** å£°æ˜å…¨å±€å˜é‡ */</span>
declare <span class="hljs-keyword">const</span> <span class="hljs-attr">__BUILD_TIME__</span>: string | <span class="hljs-literal">undefined</span>

<span class="hljs-comment">/** ç‰ˆæœ¬æ£€æŸ¥ç›¸å…³å¸¸é‡ */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">VERSION_CHECK_CONFIG</span> = {
    <span class="hljs-comment">// ç‰ˆæœ¬æ£€æŸ¥çš„localStorage key - å­˜å‚¨ buildTimeï¼Œç”¨äºæ£€æµ‹æ›´æ–°</span>
    <span class="hljs-attr">STORAGE_KEY_VERSION</span>: <span class="hljs-string">"APP_BUILD_TIME"</span>,
    <span class="hljs-comment">// ç‰ˆæœ¬æ£€æŸ¥é—´éš”ï¼ˆæ¯«ç§’ï¼‰ï¼Œ5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡</span>
    <span class="hljs-attr">CHECK_INTERVAL</span>: <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>,
    <span class="hljs-comment">// ç‰ˆæœ¬APIæ¥å£</span>
    <span class="hljs-attr">VERSION_URL</span>: <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">import</span>.meta.env.VITE_BASE_PATH || <span class="hljs-string">"/"</span>}</span>version.json`</span>
}

<span class="hljs-comment">/** ç‰ˆæœ¬ä¿¡æ¯æ¥å£ */</span>
<span class="hljs-keyword">export</span> interface <span class="hljs-title class_">IVersionInfo</span> {
    <span class="hljs-attr">version</span>: string
    <span class="hljs-attr">buildTime</span>: string
}

<span class="hljs-comment">/**
 * è·å–å½“å‰åº”ç”¨ç‰ˆæœ¬
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getCurrentVersion = (): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> buildTime = <span class="hljs-keyword">typeof</span> __BUILD_TIME__ !== <span class="hljs-string">"undefined"</span> ? __BUILD_TIME__ : <span class="hljs-string">""</span>
    <span class="hljs-keyword">return</span> buildTime || <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-variable constant_">VERSION_CHECK_CONFIG</span>.<span class="hljs-property">STORAGE_KEY_VERSION</span>) || <span class="hljs-string">"0.0.0"</span>
}

<span class="hljs-comment">/**
 * è·å–è¿œç«¯ç‰ˆæœ¬ä¿¡æ¯
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> fetchRemoteVersion = <span class="hljs-keyword">async</span> (): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">IVersionInfo</span> | <span class="hljs-literal">null</span>&gt; =&gt; {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-variable constant_">VERSION_CHECK_CONFIG</span>.<span class="hljs-property">VERSION_URL</span>, {
            <span class="hljs-attr">cache</span>: <span class="hljs-string">"no-cache"</span>
        })

        <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
        }

        <span class="hljs-keyword">const</span> <span class="hljs-attr">data</span>: <span class="hljs-title class_">IVersionInfo</span> = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>()
        <span class="hljs-keyword">return</span> data
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è·å–è¿œç«¯ç‰ˆæœ¬å¤±è´¥:"</span>, error)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
    }
}

<span class="hljs-comment">/**
 * æ¸…é™¤æ‰€æœ‰ç¼“å­˜å’Œæœ¬åœ°æ•°æ®ï¼ˆé™¤äº†ç‰ˆæœ¬ä¿¡æ¯ï¼‰
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">clearAllCaches</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// âš ï¸ å…³é”®ï¼šä¿å­˜ç‰ˆæœ¬ä¿¡æ¯ï¼Œé˜²æ­¢æ¸…é™¤åä¸¢å¤±</span>
        <span class="hljs-keyword">const</span> versionBuildTime = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-variable constant_">VERSION_CHECK_CONFIG</span>.<span class="hljs-property">STORAGE_KEY_VERSION</span>)

        <span class="hljs-comment">// æ¸…é™¤Service Workerç¼“å­˜</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-string">"caches"</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">window</span>) {
            <span class="hljs-keyword">const</span> cacheNames = <span class="hljs-keyword">await</span> caches.<span class="hljs-title function_">keys</span>()
            <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(cacheNames.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">cacheName</span> =&gt;</span> caches.<span class="hljs-title function_">delete</span>(cacheName)))
        }

        <span class="hljs-comment">// æ¸…é™¤localStorageå’ŒsessionStorage</span>
        <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">clear</span>()
        sessionStorage.<span class="hljs-title function_">clear</span>()

        <span class="hljs-comment">// å¦‚æœå­˜åœ¨IndexedDBï¼Œä¹Ÿæ¸…é™¤æ‰</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-string">"indexedDB"</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">window</span>) {
            <span class="hljs-keyword">const</span> databases = <span class="hljs-keyword">await</span> indexedDB.<span class="hljs-title function_">databases</span>()
            databases.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">db</span> =&gt;</span> {
                <span class="hljs-keyword">if</span> (db.<span class="hljs-property">name</span>) {
                    indexedDB.<span class="hljs-title function_">deleteDatabase</span>(db.<span class="hljs-property">name</span>)
                }
            })
        }

        <span class="hljs-comment">// æ¢å¤ç‰ˆæœ¬ä¿¡æ¯ï¼Œé˜²æ­¢é‡å¤æ£€æµ‹</span>
        <span class="hljs-keyword">if</span> (versionBuildTime) {
            <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-variable constant_">VERSION_CHECK_CONFIG</span>.<span class="hljs-property">STORAGE_KEY_VERSION</span>, versionBuildTime)
        }
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"æ¸…é™¤ç¼“å­˜å¤±è´¥:"</span>, error)
    }
}

<span class="hljs-comment">/**
 * æ¸…é™¤ç™»å½•çŠ¶æ€
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">clearLoginState</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// æ¸…é™¤ä¸ç™»å½•ç›¸å…³çš„localStorageæ•°æ®</span>
        <span class="hljs-keyword">const</span> loginRelatedKeys = [<span class="hljs-string">"xczzH5Token"</span>, <span class="hljs-string">"applyStatus"</span>]

        loginRelatedKeys.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {
            <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(key)
            sessionStorage.<span class="hljs-title function_">removeItem</span>(key)
        })
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"æ¸…é™¤ç™»å½•çŠ¶æ€å¤±è´¥:"</span>, error)
    }
}

<span class="hljs-comment">/**
 * å¤„ç†åº”ç”¨æ›´æ–°
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleAppUpdate</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">newBuildTime?: string</span>) =&gt; {
    <span class="hljs-comment">// æ˜¾ç¤ºæ›´æ–°æç¤ºå¯¹è¯æ¡†</span>
    <span class="hljs-title class_">Dialog</span>.<span class="hljs-title function_">show</span>({
        <span class="hljs-attr">title</span>: <span class="hljs-string">"å‘ç°æ–°ç‰ˆæœ¬"</span>,
        <span class="hljs-attr">content</span>: <span class="hljs-string">"åº”ç”¨å·²æ›´æ–°ï¼Œè¯·é‡æ–°ç™»å½•ä»¥è·å–æœ€æ–°åŠŸèƒ½"</span>,
        <span class="hljs-attr">closeOnAction</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">actions</span>: [
            {
                <span class="hljs-attr">key</span>: <span class="hljs-string">"confirm"</span>,
                <span class="hljs-attr">text</span>: <span class="hljs-string">"é‡æ–°ç™»å½•"</span>,
                <span class="hljs-attr">onClick</span>: <span class="hljs-keyword">async</span> () =&gt; {
                    <span class="hljs-keyword">const</span> toastHandler = <span class="hljs-title class_">Toast</span>.<span class="hljs-title function_">show</span>({
                        <span class="hljs-attr">content</span>: <span class="hljs-string">"æ­£åœ¨æ¸…é™¤ç¼“å­˜..."</span>,
                        <span class="hljs-attr">duration</span>: <span class="hljs-number">0</span>
                    })

                    <span class="hljs-comment">// å…ˆæ›´æ–°ç‰ˆæœ¬å·ï¼Œå†æ¸…é™¤ç¼“å­˜</span>
                    <span class="hljs-keyword">if</span> (newBuildTime) {
                        <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-variable constant_">VERSION_CHECK_CONFIG</span>.<span class="hljs-property">STORAGE_KEY_VERSION</span>, newBuildTime)
                    }

                    <span class="hljs-comment">// æ¸…é™¤æ‰€æœ‰ç¼“å­˜å’Œç™»å½•çŠ¶æ€</span>
                    <span class="hljs-keyword">await</span> <span class="hljs-title function_">clearAllCaches</span>()
                    <span class="hljs-keyword">await</span> <span class="hljs-title function_">clearLoginState</span>()

                    <span class="hljs-keyword">if</span> (toastHandler) {
                        toastHandler.<span class="hljs-title function_">close</span>()
                    }

                    <span class="hljs-comment">// é‡å®šå‘åˆ°ç™»å½•é¡µ</span>
                    <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">import</span>.meta.env.VITE_BASE_PATH || <span class="hljs-string">"/"</span>}</span>login`</span>
                }
            }
        ]
    })
}

<span class="hljs-comment">/**
 * æ£€æŸ¥åº”ç”¨ç‰ˆæœ¬å¹¶å¤„ç†æ›´æ–°
 * âš ï¸ å…³é”®æ”¹è¿›ï¼š
 * 1. æ·»åŠ å»é‡æ ‡å¿—ï¼Œé˜²æ­¢é‡å¤å¼¹çª—
 * 2. æ·»åŠ è¯¦ç»†æ—¥å¿—è¿½è¸ª
 * 3. æ·»åŠ å¼‚å¸¸å¤„ç†
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">checkAndHandleUpdate</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// è·å–æœ¬åœ°è®°å½•çš„æ„å»ºæ—¶é—´</span>
        <span class="hljs-keyword">const</span> storedBuildTime = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-variable constant_">VERSION_CHECK_CONFIG</span>.<span class="hljs-property">STORAGE_KEY_VERSION</span>)

        <span class="hljs-comment">// è·å–è¿œç«¯ç‰ˆæœ¬</span>
        <span class="hljs-keyword">const</span> remoteVersion = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchRemoteVersion</span>()

        <span class="hljs-keyword">if</span> (!remoteVersion) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">"âš ï¸ æ— æ³•è·å–è¿œç«¯ç‰ˆæœ¬ä¿¡æ¯"</span>)
            <span class="hljs-keyword">return</span>
        }

        <span class="hljs-comment">// æ·»åŠ è¯¦ç»†æ—¥å¿—</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸ“Š ç‰ˆæœ¬æ£€æŸ¥è¯¦æƒ…:"</span>, {
            <span class="hljs-string">"è¿œç«¯ buildTime"</span>: remoteVersion.<span class="hljs-property">buildTime</span>,
            <span class="hljs-string">"æœ¬åœ° buildTime"</span>: storedBuildTime || <span class="hljs-string">"æœªè®°å½•ï¼ˆé¦–æ¬¡è®¿é—®ï¼‰"</span>,
            ç‰ˆæœ¬å·: remoteVersion.<span class="hljs-property">version</span>,
            éœ€è¦æ›´æ–°: !!storedBuildTime &amp;&amp; storedBuildTime !== remoteVersion.<span class="hljs-property">buildTime</span>
        })

        <span class="hljs-keyword">if</span> (storedBuildTime &amp;&amp; storedBuildTime !== remoteVersion.<span class="hljs-property">buildTime</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ”„ æ£€æµ‹åˆ°ç‰ˆæœ¬æ›´æ–°ï¼`</span>)
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`   æ—§ç‰ˆæœ¬: <span class="hljs-subst">${storedBuildTime}</span>`</span>)
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`   æ–°ç‰ˆæœ¬: <span class="hljs-subst">${remoteVersion.buildTime}</span>`</span>)

            <span class="hljs-comment">// ä¼ é€’æ–°çš„ buildTimeï¼Œåœ¨ç”¨æˆ·ç¡®è®¤åæ›´æ–°</span>
            <span class="hljs-keyword">await</span> <span class="hljs-title function_">handleAppUpdate</span>(remoteVersion.<span class="hljs-property">buildTime</span>)
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!storedBuildTime) {
            <span class="hljs-comment">// ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œè®°å½•å½“å‰ç‰ˆæœ¬</span>
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ“ é¦–æ¬¡è®¿é—®ï¼Œè®°å½• buildTime: <span class="hljs-subst">${remoteVersion.buildTime}</span>`</span>)
            <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-variable constant_">VERSION_CHECK_CONFIG</span>.<span class="hljs-property">STORAGE_KEY_VERSION</span>, remoteVersion.<span class="hljs-property">buildTime</span>)
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"âœ… ç‰ˆæœ¬æ— æ›´æ–°ï¼Œåº”ç”¨ä¸ºæœ€æ–°ç‰ˆæœ¬"</span>)
        }
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"âŒ ç‰ˆæœ¬æ£€æŸ¥å‡ºé”™:"</span>, error)
    }
}

<span class="hljs-comment">/**
 * å¯åŠ¨ç‰ˆæœ¬æ£€æŸ¥ï¼ˆå®šæ—¶æ£€æŸ¥ï¼‰
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">startVersionCheck</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸš€ ç‰ˆæœ¬æ£€æŸ¥å·²å¯åŠ¨"</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ“‹ æ£€æŸ¥é—´éš”: <span class="hljs-subst">${VERSION_CHECK_CONFIG.CHECK_INTERVAL / <span class="hljs-number">1000</span>}</span> ç§’`</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ”— ç‰ˆæœ¬ API: <span class="hljs-subst">${VERSION_CHECK_CONFIG.VERSION_URL}</span>`</span>)

    <span class="hljs-comment">// ç«‹å³æ£€æŸ¥ä¸€æ¬¡</span>
    <span class="hljs-title function_">checkAndHandleUpdate</span>()

    <span class="hljs-comment">// å®šæ—¶æ£€æŸ¥</span>
    <span class="hljs-keyword">const</span> intervalId = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`â° [<span class="hljs-subst">${<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toLocaleTimeString()}</span>] æ‰§è¡Œå®šæ—¶ç‰ˆæœ¬æ£€æŸ¥...`</span>)
        <span class="hljs-title function_">checkAndHandleUpdate</span>()
    }, <span class="hljs-variable constant_">VERSION_CHECK_CONFIG</span>.<span class="hljs-property">CHECK_INTERVAL</span>)

    <span class="hljs-comment">// æš´éœ²åˆ°å…¨å±€ä½œç”¨åŸŸï¼Œæ–¹ä¾¿è°ƒè¯•</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span> !== <span class="hljs-string">"undefined"</span>) {
        ;(<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> any).<span class="hljs-property">__versionCheckUtils__</span> = {
            <span class="hljs-comment">// æ‰‹åŠ¨æ£€æŸ¥ç‰ˆæœ¬</span>
            <span class="hljs-attr">checkNow</span>: <span class="hljs-function">() =&gt;</span> {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸ” æ‰‹åŠ¨è§¦å‘ç‰ˆæœ¬æ£€æŸ¥..."</span>)
                <span class="hljs-title function_">checkAndHandleUpdate</span>()
            },
            <span class="hljs-comment">// æ¸…ç©ºç‰ˆæœ¬è®°å½•ï¼Œä¸‹æ¬¡è®¿é—®ä¼šé‡æ–°è®°å½•</span>
            <span class="hljs-attr">resetVersion</span>: <span class="hljs-function">() =&gt;</span> {
                <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-variable constant_">VERSION_CHECK_CONFIG</span>.<span class="hljs-property">STORAGE_KEY_VERSION</span>)
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"âœ… ç‰ˆæœ¬è®°å½•å·²æ¸…ç©ºï¼Œåˆ·æ–°é¡µé¢åä¼šé‡æ–°è®°å½•"</span>)
            },
            <span class="hljs-comment">// æŸ¥çœ‹å½“å‰ç‰ˆæœ¬ä¿¡æ¯</span>
            <span class="hljs-attr">getVersionInfo</span>: <span class="hljs-function">() =&gt;</span> {
                <span class="hljs-keyword">return</span> {
                    <span class="hljs-string">"æœ¬åœ° buildTime"</span>: <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-variable constant_">VERSION_CHECK_CONFIG</span>.<span class="hljs-property">STORAGE_KEY_VERSION</span>),
                    <span class="hljs-string">"å­˜å‚¨ key"</span>: <span class="hljs-variable constant_">VERSION_CHECK_CONFIG</span>.<span class="hljs-property">STORAGE_KEY_VERSION</span>,
                    <span class="hljs-string">"API åœ°å€"</span>: <span class="hljs-variable constant_">VERSION_CHECK_CONFIG</span>.<span class="hljs-property">VERSION_URL</span>,
                    <span class="hljs-string">"æ£€æŸ¥é—´éš”(ç§’)"</span>: <span class="hljs-variable constant_">VERSION_CHECK_CONFIG</span>.<span class="hljs-property">CHECK_INTERVAL</span> / <span class="hljs-number">1000</span>
                }
            },
            <span class="hljs-comment">// è·å–è¿œç«¯ç‰ˆæœ¬</span>
            <span class="hljs-attr">getRemoteVersion</span>: <span class="hljs-keyword">async</span> () =&gt; {
                <span class="hljs-keyword">const</span> version = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchRemoteVersion</span>()
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸŒ è¿œç«¯ç‰ˆæœ¬:"</span>, version)
                <span class="hljs-keyword">return</span> version
            },
            <span class="hljs-comment">// æµ‹è¯•æ¸…é™¤ç¼“å­˜</span>
            <span class="hljs-attr">testClearCache</span>: <span class="hljs-keyword">async</span> () =&gt; {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸ§¹ æµ‹è¯•æ¸…é™¤ç¼“å­˜..."</span>)
                <span class="hljs-keyword">await</span> <span class="hljs-title function_">clearAllCaches</span>()
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"âœ… ç¼“å­˜æ¸…é™¤å®Œæˆ"</span>)
            },
            <span class="hljs-comment">// é—´éš” ID</span>
            intervalId
        }

        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸ’¡ è°ƒè¯•å·¥å…·å·²åŠ è½½ï¼Œå¯åœ¨æ§åˆ¶å°ä½¿ç”¨ window.__versionCheckUtils__"</span>)
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"   - checkNow()        æ‰‹åŠ¨æ£€æŸ¥ç‰ˆæœ¬"</span>)
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"   - resetVersion()    æ¸…ç©ºç‰ˆæœ¬è®°å½•"</span>)
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"   - getVersionInfo()  æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯"</span>)
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"   - getRemoteVersion()è·å–è¿œç«¯ç‰ˆæœ¬"</span>)
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"   - testClearCache()  æµ‹è¯•æ¸…é™¤ç¼“å­˜"</span>)
    }
}

</code></pre>
<h2 data-id="heading-0">ç‰ˆæœ¬æ›´æ–°ä¸ç¼“å­˜æ¸…é™¤</h2>
<hr/>
<h3 data-id="heading-1">ğŸ¯ æ ¸å¿ƒåŠŸèƒ½</h3>
<h4 data-id="heading-2">1. è‡ªåŠ¨ç‰ˆæœ¬æ£€æµ‹</h4>
<ul>
<li>åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥ <code>/version.json</code></li>
<li>æ¯5åˆ†é’Ÿå®šæ—¶æ£€æŸ¥ä¸€æ¬¡</li>
<li>æ¯”å¯¹æ„å»ºæ—¶é—´ï¼ˆbuildTimeï¼‰æ£€æµ‹æ–°ç‰ˆæœ¬</li>
</ul>
<h4 data-id="heading-3">2. ç¼“å­˜æ¸…é™¤</h4>
<ul>
<li>Service Worker ç¼“å­˜</li>
<li>localStorage / sessionStorage</li>
<li>IndexedDB æ•°æ®åº“</li>
<li>æ‰€æœ‰ç™»å½•ç›¸å…³æ•°æ®</li>
</ul>
<h4 data-id="heading-4">3. å¼ºåˆ¶é‡æ–°ç™»å½•</h4>
<ul>
<li>æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬æ—¶æ˜¾ç¤º"å‘ç°æ–°ç‰ˆæœ¬"æç¤º</li>
<li>ç‚¹å‡»"é‡æ–°ç™»å½•"æ¸…é™¤ç¼“å­˜å¹¶è·³è½¬åˆ°ç™»å½•é¡µ</li>
<li>ç”¨æˆ·é‡æ–°ç™»å½•åè·å–æœ€æ–°ç‰ˆæœ¬ä»£ç </li>
</ul>
<hr/>
<h3 data-id="heading-5">ğŸ“ æ–‡ä»¶ç»“æ„</h3>
<pre><code class="hljs language-csharp" lang="csharp">src/
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ version.ts                    <span class="hljs-meta"># æ ¸å¿ƒç‰ˆæœ¬æ£€æŸ¥å·¥å…·</span>
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ update/
â”‚       â””â”€â”€ useVersionCheck.ts        <span class="hljs-meta"># ç‰ˆæœ¬æ£€æŸ¥ Hook</span>
â”œâ”€â”€ stores/
â”‚   â””â”€â”€ userInfo.ts                   <span class="hljs-meta"># å·²é›†æˆ logout æ–¹æ³•ï¼ˆæ¸…é™¤ç¼“å­˜ï¼‰</span>
â””â”€â”€ App.tsx                           <span class="hljs-meta"># å·²é›†æˆ useVersionCheck Hook</span>

<span class="hljs-keyword">public</span>/
â””â”€â”€ version.json                      <span class="hljs-meta"># ç‰ˆæœ¬ä¿¡æ¯æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰</span>

scripts/
â”œâ”€â”€ update-version.js                 <span class="hljs-meta"># è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬è„šæœ¬</span>
â”œâ”€â”€ update-version.sh                 <span class="hljs-meta"># Linux/Mac ç‰ˆæœ¬è„šæœ¬</span>
â””â”€â”€ update-version.bat                <span class="hljs-meta"># Windows ç‰ˆæœ¬è„šæœ¬</span>

package.json                          <span class="hljs-meta"># build è„šæœ¬</span>
</code></pre>
<hr/>
<h3 data-id="heading-6">ğŸš€ ä½¿ç”¨æ–¹å¼</h3>
<h4 data-id="heading-7">1. å¼€å‘ç¯å¢ƒ</h4>
<pre><code class="hljs language-bash" lang="bash">pnpm start
</code></pre>
<h4 data-id="heading-8">2. æ„å»ºé¡¹ç›®</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å¹¶æ„å»º</span>
pnpm build

<span class="hljs-comment"># æµ‹è¯•äº‘æ„å»º</span>
pnpm build:testcloud

<span class="hljs-comment"># ç”Ÿäº§äº‘æ„å»º</span>
pnpm build:prodcloud
</code></pre>
<h4 data-id="heading-9">3. æ‰‹åŠ¨æ›´æ–°ç‰ˆæœ¬ï¼ˆå¯é€‰ï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash">pnpm update-version
</code></pre>
<hr/>
<h3 data-id="heading-10">ğŸ”„ å·¥ä½œæµç¨‹</h3>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> æ‰§è¡Œ pnpm build
   â†“
<span class="hljs-bullet">2.</span> è¿è¡Œ update-version.js è„šæœ¬
   â†“
<span class="hljs-bullet">3.</span> è¯»å– package.json ä¸­çš„ç‰ˆæœ¬å·
   â†“
<span class="hljs-bullet">4.</span> ç”Ÿæˆå½“å‰æ„å»ºæ—¶é—´ï¼ˆISO 8601ï¼‰
   â†“
<span class="hljs-bullet">5.</span> ç”Ÿæˆ/æ›´æ–° public/version.json
   â†“
<span class="hljs-bullet">6.</span> Vite æ„å»ºåº”ç”¨
   â†“
<span class="hljs-bullet">7.</span> éƒ¨ç½²åˆ°æœåŠ¡å™¨
   â†“
<span class="hljs-bullet">8.</span> ç”¨æˆ·è®¿é—®åº”ç”¨
   â†“
<span class="hljs-bullet">9.</span> useVersionCheck Hook å¯åŠ¨
   â†“
<span class="hljs-bullet">10.</span> å®šæ—¶æ£€æŸ¥ /version.json
<span class="hljs-code">    â†“
11. ç‰ˆæœ¬ä¸åŒ â†’ æ˜¾ç¤ºæ›´æ–°æç¤º â†’ æ¸…é™¤ç¼“å­˜ â†’ é‡æ–°ç™»å½•
</span></code></pre>
<hr/>
<h3 data-id="heading-11">ğŸ› ï¸ éƒ¨ç½²é…ç½®</h3>
<h4 data-id="heading-12">Nginx é…ç½®ï¼ˆé‡è¦ï¼‰</h4>
<p><strong>å¿…é¡»ç¦ç”¨ version.json çš„ç¼“å­˜ï¼Œå¦åˆ™æ›´æ–°æ£€æµ‹æ— æ³•ç”Ÿæ•ˆï¼š</strong></p>
<pre><code class="hljs language-nginx" lang="nginx"># ç‰ˆæœ¬æ£€æŸ¥æ–‡ä»¶ - ç¦ç”¨ç¼“å­˜
location /version.json {
    add_header Cache-Control "no-cache, no-store, must-revalidate";
    add_header Pragma "no-cache";
    add_header Expires "0";
}

# å…¶ä»–èµ„æº - é•¿æœŸç¼“å­˜
location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
}

# HTML æ–‡ä»¶
location ~* \.html$ {
    add_header Cache-Control "no-cache, no-store, must-revalidate";
}
</code></pre>
<hr/>
<h3 data-id="heading-13">ğŸ“Š ç‰ˆæœ¬ä¿¡æ¯æ–‡ä»¶æ ¼å¼</h3>
<p><code>public/version.json</code> å†…å®¹ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.4.3"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"buildTime"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2026-01-27T10:30:00Z"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-14">è‡ªåŠ¨ç”Ÿæˆè¯´æ˜</h4>
<ul>
<li><code>version</code>ï¼šä» <code>package.json</code> ä¸­è¯»å–</li>
<li><code>buildTime</code>ï¼šæ„å»ºæ—¶çš„å½“å‰æ—¶é—´ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-15">ğŸ§ª æµ‹è¯•ç‰ˆæœ¬æ›´æ–°</h3>
<h4 data-id="heading-16">æœ¬åœ°æµ‹è¯•æ­¥éª¤</h4>
<ol>
<li>
<p><strong>ä¿®æ”¹ç‰ˆæœ¬å·</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¾‘ package.jsonï¼Œæ”¹å˜ version å­—æ®µ</span>
<span class="hljs-comment"># ä¾‹å¦‚ï¼š1.4.3 -&gt; 1.4.4</span>
</code></pre>
</li>
<li>
<p><strong>é‡æ–°æ„å»º</strong></p>
<pre><code class="hljs language-bash" lang="bash">pnpm build
pnpm preview
</code></pre>
</li>
<li>
<p><strong>éªŒè¯åŠŸèƒ½</strong></p>
<ul>
<li>æ‰“å¼€åº”ç”¨</li>
<li>æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·</li>
<li>ç¼–è¾‘ <code>public/version.json</code>ï¼Œæ”¹å˜ buildTime</li>
<li>åˆ·æ–°é¡µé¢</li>
<li>åº”è¯¥ä¼šå¼¹å‡º"å‘ç°æ–°ç‰ˆæœ¬"æç¤º</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-17">ğŸ” è°ƒè¯•</h3>
<h4 data-id="heading-18">æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯</h4>
<p>åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è·å–è¿œç«¯ç‰ˆæœ¬</span>
<span class="hljs-title function_">fetch</span>(<span class="hljs-string">"/version.json"</span>)
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-title function_">json</span>())
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"è¿œç«¯ç‰ˆæœ¬:"</span>, data))

<span class="hljs-comment">// æ£€æŸ¥æœ¬åœ°ç‰ˆæœ¬è®°å½•</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æœ¬åœ°ç‰ˆæœ¬:"</span>, <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">"APP_VERSION"</span>))
</code></pre>
<h4 data-id="heading-19">æŸ¥çœ‹ç¼“å­˜</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Service Worker ç¼“å­˜</span>
caches.<span class="hljs-title function_">keys</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">names</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¼“å­˜åˆ—è¡¨:"</span>, names))

<span class="hljs-comment">// localStorage</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"localStorage:"</span>, <span class="hljs-variable language_">localStorage</span>)

<span class="hljs-comment">// sessionStorage</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"sessionStorage:"</span>, sessionStorage)
</code></pre>
<h4 data-id="heading-20">æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { clearAllCaches, clearLoginState } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/utils/version"</span>

<span class="hljs-comment">// æ¸…é™¤æ‰€æœ‰ç¼“å­˜</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">clearAllCaches</span>()
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¼“å­˜å·²æ¸…é™¤"</span>)

<span class="hljs-comment">// æ¸…é™¤ç™»å½•çŠ¶æ€</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">clearLoginState</span>()
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç™»å½•çŠ¶æ€å·²æ¸…é™¤"</span>)
</code></pre>
<hr/>
<h3 data-id="heading-21">âš™ï¸ é…ç½®è°ƒæ•´</h3>
<h4 data-id="heading-22">ä¿®æ”¹æ£€æŸ¥é—´éš”</h4>
<p>ç¼–è¾‘ <code>src/utils/version.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">VERSION_CHECK_CONFIG</span> = {
    <span class="hljs-comment">// æ”¹ä¸º 10 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡</span>
    <span class="hljs-attr">CHECK_INTERVAL</span>: <span class="hljs-number">10</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>
    <span class="hljs-comment">// ...å…¶ä»–é…ç½®</span>
}
</code></pre>
<h4 data-id="heading-23">ç¦ç”¨ç‰ˆæœ¬æ£€æŸ¥</h4>
<p>åœ¨ <code>src/App.tsx</code> ä¸­æ³¨é‡Šæ‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// useVersionCheck() // æ³¨é‡Šæ‰è¿™è¡Œ</span>
</code></pre>
<h4 data-id="heading-24">è‡ªå®šä¹‰æ›´æ–°æç¤º</h4>
<p>ç¼–è¾‘ <code>src/utils/version.ts</code> ä¸­çš„ <code>handleAppUpdate()</code> å‡½æ•°</p>
<hr/>
<h3 data-id="heading-25">ğŸ“š æ›´å¤šèµ„æº</h3>
<p>è¯¦ç»†éƒ¨ç½²æŒ‡å—è¯·æŸ¥çœ‹ <a href="https://link.juejin.cn?target=..%2FDEPLOYMENT_GUIDE.md" target="_blank" title="../DEPLOYMENT_GUIDE.md" ref="nofollow noopener noreferrer">DEPLOYMENT_GUIDE.md</a></p>
<hr/>
<h3 data-id="heading-26">ğŸ’¡ å…³é”®è¦ç‚¹</h3>
<p>âœ… <strong>ä¸€å®šè¦åšçš„äº‹ï¼š</strong></p>
<ol>
<li>åœ¨ Nginx/Apache ä¸­ç¦ç”¨ version.json çš„ç¼“å­˜</li>
<li>ç¡®ä¿ Service Worker æ­£å¸¸æ³¨å†Œ</li>
<li>æ¯æ¬¡éƒ¨ç½²å‰è¿è¡Œ <code>pnpm build</code>ï¼ˆä¼šè‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬ï¼‰</li>
</ol>
<p>âŒ <strong>ä¸è¦åšçš„äº‹ï¼š</strong></p>
<ol>
<li>æ‰‹åŠ¨ä¿®æ”¹ public/version.jsonï¼ˆä¼šè¢«è¦†ç›–ï¼‰</li>
<li>å¯ç”¨ version.json çš„ç¼“å­˜</li>
<li>åœ¨éƒ¨ç½²å‰å¿˜è®°æ„å»ºé¡¹ç›®</li>
</ol>
<hr/>
<h3 data-id="heading-27">ğŸ“ å¸¸è§é—®é¢˜</h3>
<p><strong>Q: ç”¨æˆ·æ›´æ–°åä»çœ‹åˆ°æ—§ç‰ˆæœ¬ï¼Ÿ</strong>
A: æ£€æŸ¥ Nginx ç¼“å­˜é…ç½®ï¼Œç¡®ä¿ç¦ç”¨äº† version.json çš„ç¼“å­˜</p>
<p><strong>Q: ç‰ˆæœ¬æ–‡ä»¶æœªç”Ÿæˆï¼Ÿ</strong>
A: æ£€æŸ¥æ˜¯å¦æœ‰å†™å…¥ public ç›®å½•çš„æƒé™</p>
<p><strong>Q: å¦‚ä½•å¼ºåˆ¶æ‰€æœ‰ç”¨æˆ·æ›´æ–°ï¼Ÿ</strong>
A: ä¿®æ”¹ version.json ä¸­çš„ buildTime å­—æ®µ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ•°æ®åº“å·¡æ£€è¿›å…¥æ™ºèƒ½æ—¶ä»£ï¼šå¼‚å¸¸æ£€æµ‹ç®—æ³•çš„è½åœ°å®è·µ]]></title>    <link>https://juejin.cn/post/7603288778678255651</link>    <guid>https://juejin.cn/post/7603288778678255651</guid>    <pubDate>2026-02-06T02:44:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603288778678255651" data-draft-id="7603054272158777394" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ•°æ®åº“å·¡æ£€è¿›å…¥æ™ºèƒ½æ—¶ä»£ï¼šå¼‚å¸¸æ£€æµ‹ç®—æ³•çš„è½åœ°å®è·µ"/> <meta itemprop="keywords" content="æ•°æ®åº“,è¿ç»´,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-02-06T02:44:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å»å“ªå„¿æŠ€æœ¯æ²™é¾™"/> <meta itemprop="url" content="https://juejin.cn/user/2251436075786791"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ•°æ®åº“å·¡æ£€è¿›å…¥æ™ºèƒ½æ—¶ä»£ï¼šå¼‚å¸¸æ£€æµ‹ç®—æ³•çš„è½åœ°å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2251436075786791/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å»å“ªå„¿æŠ€æœ¯æ²™é¾™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T02:44:42.000Z" title="Fri Feb 06 2026 02:44:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆä¼ ç»Ÿå·¡æ£€ä¸å¤Ÿç”¨ï¼Ÿ</h2>
<p>ä¼ ç»Ÿçš„å·¡æ£€ç³»ç»Ÿéƒ½æ˜¯åŸºäºå›ºå®šé˜ˆå€¼æ¥åˆ¤å®šæŒ‡æ ‡æ˜¯å¦å¼‚å¸¸ï¼Œä¸€èˆ¬ä¸ºäº†é˜²æ­¢äº§ç”Ÿè¿‡å¤šçš„æŒ‡æ ‡å¼‚å¸¸ä¿¡æ¯ï¼Œè¿™ç§é˜ˆå€¼è®¾ç½®çš„éƒ½åé«˜ã€‚è™½ç„¶è¿™ç§æ–¹å¼ä¹Ÿèƒ½å‘ç°å¼‚å¸¸ï¼Œä½†æ˜¯åœºæ™¯è¿‡äºå•ä¸€ï¼Œæ— æ³•æ„ŸçŸ¥æŒ‡æ ‡çš„åŠ¨æ€å˜åŒ–ï¼Œä¾‹å¦‚åœ¨ä¸šåŠ¡é€æ¸è¿›å…¥é«˜å³°æœŸæ—¶ï¼Œæ•°æ®åº“çš„QPSã€è´Ÿè½½æˆ–è€…æ•°æ®ä½“é‡ä¹Ÿéƒ½æ˜¯é€æ¸å‡é«˜çš„ï¼Œç­‰è¾¾åˆ°æ—¥å¸¸çš„å¼‚å¸¸é˜ˆå€¼å†å¤„ç†ï¼Œæ—¶é—´ä¸Šä¼šæ¯”è¾ƒç´§å¼ ï¼Œè€Œå¦‚æœèƒ½æå‰å‘ç°æ•°æ®åº“æ ¸å¿ƒæŒ‡æ ‡çš„å˜åŒ–ä»¥åŠå˜åŒ–å¹…åº¦ï¼Œé‚£DBAå°±èƒ½æå‰ä»‹å…¥åˆ†æå’Œå¤„ç†ï¼Œä¹Ÿå‡å°äº†å› ä¸ºè´Ÿè½½è¿‡é«˜æˆ–è€…å®¹é‡ç´§å¼ å¸¦æ¥çš„ä¸šåŠ¡å¼‚å¸¸çš„å¯èƒ½æ€§ã€‚</p>
<h2 data-id="heading-1">äºŒã€å¼‚å¸¸æ£€æµ‹ï¼šå·¡æ£€çš„â€œç¬¬äºŒåŒçœ¼ç›â€</h2>
<p>è¿‘å¹´æ¥ï¼Œæœºå™¨å­¦ä¹ å’Œäººå·¥æ™ºèƒ½æŠ€æœ¯å¿«é€Ÿå‘å±•ä¸ºæ—¶åºç›‘æ§æä¾›äº†æ–°æ€è·¯ï¼Œæœºå™¨å­¦ä¹ å¯ä»¥ä»å†å²æ•°æ®ä¸­æ‰¾åˆ°è‡ªèº«çš„è§„å¾‹ï¼Œè¯†åˆ«å‡ºå¸¸è§„ä¹‹å¤–çš„è¡Œä¸ºã€‚å»å“ªå„¿ç½‘DBAå°†æ—¶åºç›‘æ§æ•°æ®çš„å¼‚å¸¸æ£€æµ‹è¿ç”¨åˆ°æ—¥å¸¸å·¡æ£€ä¸­ï¼Œé€šè¿‡æ™ºèƒ½åˆ†ææ¥å‘ç°æ•°æ®åº“æŒ‡æ ‡çš„åŠ¨æ€å˜åŒ–å¼‚å¸¸ã€‚</p>
<p>æ•´ä½“æ€è·¯å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a9dbf0e417b4f108eacfdc084af82cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=uoPE%2BmPZXQetGrkVWW%2B0746GZgE%3D" alt="" loading="lazy"/></p>
<ol>
<li>
<p>ç‰¹å¾åˆ†æï¼šæœ‰äº›å®ä¾‹çš„æŒ‡æ ‡å…·æœ‰å‘¨æœŸæ€§çš„å˜åŒ–è§„å¾‹ï¼Œåœ¨å‘¨æœŸå†…å¯èƒ½ä¼šå‡ºç°å¿«é€Ÿçš„ä¸Šæ¶¨æˆ–ä¸‹é™ï¼Œè¿™ç§ç¬¦åˆå‘¨æœŸæ€§å˜åŒ–çš„åœºæ™¯ä¸åº”è¯¥ç®—ä½œå¼‚å¸¸ï¼Œä¾‹å¦‚éƒ¨åˆ†Rediså†…å­˜çš„ä½¿ç”¨é‡ä¼šåœ¨å¤œé—´å¿«é€Ÿçš„é™ä½è€Œåœ¨æ—©ä¸Šåˆå¿«é€Ÿçš„ä¸Šæ¶¨ï¼Œéœ€è¦æŠŠè¿™ç§å…·æœ‰å‘¨æœŸæ€§è§„å¾‹çš„å®ä¾‹æå–å‡ºæ¥ï¼Œè¿›è¡Œå‘¨æœŸæ€§æ£€æµ‹ã€‚è€Œæœ‰äº›å®ä¾‹çš„æŒ‡æ ‡æˆ–è®¸æ˜¯æŒç»­å¹³ç¨³ä¸Šæ¶¨çš„ï¼Œå¦‚MySQLæœåŠ¡å™¨ç£ç›˜ä½¿ç”¨é‡ä¸€èˆ¬æ˜¯å¹³ç¨³å¢é•¿çš„ï¼Œå¦‚æœçŸ­æ—¶é—´å†…ä¸Šæ¶¨å¾ˆå¤šï¼Œé‚£ä¹ˆå°±å¯èƒ½æœ‰å¼‚å¸¸ã€‚æ‰€ä»¥ç¬¬ä¸€æ­¥æˆ‘ä»¬éœ€è¦æŠŠå®ä¾‹æŒ‡æ ‡çš„å‘¨æœŸæ€§ï¼Œå¹³ç¨³æ€§ç­‰å˜åŒ–ç‰¹å¾è¿›è¡Œæå–ã€‚</p>
</li>
<li>
<p>ç®—æ³•é€‰æ‹©ï¼šæ ¹æ®ä¸åŒç‰¹å¾éœ€æ±‚ï¼Œä½¿ç”¨ä¸åŒçš„è½¬æ¢ç®—æ³•æˆ–å¼‚å¸¸æ£€æµ‹ç®—æ³•è¿›è¡Œå¤„ç†ã€‚é€šè¿‡æ»‘åŠ¨çª—å£æ³•å°†ç›‘æ§æ•°æ®è½¬æ¢ç”Ÿæˆæ–°çš„æ›²çº¿ï¼›é€šè¿‡å››åˆ†ä½è·æ³•è¿›è¡Œå¼‚å¸¸ç‚¹çš„æ£€æµ‹ï¼›é€šè¿‡å‘¨æœŸæ£€æµ‹ç®—æ³•å°†æœ‰å‘¨æœŸæ€§è§„å¾‹çš„æŒ‡æ ‡è¯†åˆ«å‡ºæ¥å¹¶ä¸”è·å¾—å‘¨æœŸé•¿åº¦ï¼Œæ£€æµ‹å‡ºä¸ç¬¦åˆå‘¨æœŸè§„å¾‹çš„æƒ…å†µï¼›é€šè¿‡æ°´ä½æ£€æµ‹è¯†åˆ«å‡ºæŒ‡æ ‡æ°´ä½çªç„¶ä¸Šå‡çš„æƒ…å†µç­‰ç­‰ã€‚</p>
</li>
<li>
<p>è°ƒä¼˜ï¼šé€šè¿‡ç®—æ³•è¯†åˆ«å‡ºæ¥çš„å¼‚å¸¸ç‚¹ä¸ä¸€å®šæ˜¯çœŸå®ä¸šåŠ¡åœºæ™¯çš„å¼‚å¸¸ç‚¹ï¼Œå› ä¸ºå¼‚å¸¸ç®—æ³•åªæ˜¯ä»æ•°å­¦çš„è§’åº¦è¿›è¡Œçš„æ£€æµ‹ï¼Œå³ä½¿è€ƒè™‘åˆ°å†å²è§„å¾‹ç‰¹æ€§ï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹çš„ç®—æ³•è¯†åˆ«çš„å¼‚å¸¸ç‚¹æˆ‘ä»¬å¹¶ä¸éœ€è¦å¤„ç†ï¼Œæ‰€ä»¥æœ€ç»ˆç»“æœéœ€è¦é€šè¿‡åŠ¨æ€é˜ˆå€¼å’Œé™æ€é˜ˆå€¼å‚æ•°ç›¸ç»“åˆã€‚æœºå™¨å­¦ä¹ å¯ä»¥é€šè¿‡å†å²æ•°æ®è‡ªåŠ¨è®¡ç®—å‡ºåŠ¨æ€é˜ˆå€¼ï¼Œå¯ä»¥é€šè¿‡çª—å£å¤§å°ã€çµæ•åº¦ç­‰ç®—æ³•å‚æ•°å½±å“åŠ¨æ€é˜ˆå€¼çš„å˜åŒ–ï¼Œä½†æœ‰äº›åœºæ™¯è¿˜éœ€è¦é™æ€é˜ˆå€¼ç»™äºˆè¾…åŠ©åˆ¤æ–­ï¼Œä¾‹å¦‚ç£ç›˜ç©ºé—´è™½ç„¶å¿«é€Ÿä¸Šæ¶¨ï¼Œå¦‚æœä½¿ç”¨ç‡è¿˜å¾ˆä½ï¼Œè¿™ç§åœºæ™¯æˆ‘ä»¬æš‚æ—¶ä¸éœ€è¦åšä»»ä½•å¤„ç†ï¼Œä¹Ÿå°±ä¸éœ€è¦æŠŠå®ƒè¯†åˆ«æˆå¼‚å¸¸ç‚¹ï¼Œæ‰€ä»¥éœ€è¦è®¾ç½®ä¸€ä¸ªä¸Šè¾¹ç•Œé˜ˆå€¼ã€‚é€šè¿‡ä¸€äº›ç‰¹å®šçš„å‚æ•°å’Œé™æ€é˜ˆå€¼ï¼Œå¯¹ä¸åŒçš„æŒ‡æ ‡ï¼Œä¸åŒçš„é›†ç¾¤èµ‹äºˆä¸€äº›ç‰¹æ®Šçš„æ„ä¹‰ï¼Œæˆ‘ä»¬å¸Œæœ›æœ€ç»ˆæš´éœ²å‡ºæ¥çš„å¼‚å¸¸ç‚¹éƒ½æ˜¯æˆ‘ä»¬éœ€è¦å¤„ç†çš„åœºæ™¯ã€‚å¦å¤–ä¸€äº›å·²çŸ¥å¹²æ‰°é¡¹ï¼Œä¾‹å¦‚èŠ‚ç‚¹è¿ç§»ï¼Œæ”¹è¡¨å·¥å•ï¼Œå‚æ•°é…ç½®ä¸åˆç†ç­‰ä¹Ÿéœ€è¦è€ƒè™‘è¿›ç®—æ³•ä¸­ã€‚</p>
</li>
<li>
<p>æŠ¥è­¦æ”¶æ•›ï¼šä¸ºé¿å…åŒä¸€æ¶ˆæ¯å‘é€å¾ˆå¤šæ¬¡ï¼Œä»ä¸€ä¸ªæŠ¥è­¦ç¬¬ä¸€æ¬¡å‘é€å¼€å§‹è®¡æ—¶ï¼ŒåŒä¸€ä¸ªæ¶ˆæ¯åœ¨è¿‘nä¸ªå°æ—¶åªå‘é€ä¸€æ¬¡æ¶ˆæ¯ï¼Œå‰©ä¸‹çš„æŠ¥è­¦åœ¨åŸæ¶ˆæ¯çš„å†…å®¹ä¸Šæ›´æ–°ï¼Œåªæ˜¾ç¤ºæœ€æ–°çš„æ£€æµ‹å†…å®¹ã€‚å¦å¤–ä¸€ä¸ªé›†ç¾¤çš„å¤šä¸ªå®ä¾‹åŒæ—¶æŠ¥è­¦æ”¶æ•›ä¸ºä¸€ä¸ªæ¶ˆæ¯ï¼Œä¸€ç»„é›†ç¾¤åŒæ—¶æŠ¥è­¦æ”¶æ•›ä¸ºä¸€ä¸ªæ¶ˆæ¯ï¼Œè¿™æ ·å¤§å¤§å‡å°‘äº†æŠ¥è­¦æ•°é‡,å¯ä»¥é¿å…ç”±äºæ¥æ”¶åˆ°å¤§é‡çš„ç›¸åŒæ¶ˆæ¯è€ŒæŠŠå…¶å®ƒéœ€è¦å…³æ³¨çš„æ¶ˆæ¯å¿½ç•¥æ‰ã€‚</p>
</li>
</ol>
<h2 data-id="heading-2">ä¸‰ã€ä¸‰å¤§å…¸å‹åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-3">3.1 å¹³ç¨³è¶‹åŠ¿å¼‚å¸¸æ£€æµ‹</h3>
<p>MySQLæœåŠ¡å™¨ç£ç›˜ä½¿ç”¨é‡ã€æœåŠ¡å™¨å†…å­˜ä½¿ç”¨é‡ã€Rediså†…å­˜ä½¿ç”¨é‡ç­‰ç»å¤§éƒ¨åˆ†ç›‘æ§æŒ‡æ ‡çš„ç›‘æ§æ›²çº¿ç‰¹å¾åŸºæœ¬æ˜¯ç›¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯æ­£å¸¸æƒ…å†µä¸‹è¶‹åŠ¿å¹³ç¨³ï¼ˆå¹³ç¨³ä¸Šå‡/ä¸‹é™ï¼Œæˆ–è€…å˜åŒ–è¶‹åŠ¿ä¸æ˜æ˜¾ï¼‰ï¼Œè¿™ç±»ç›‘æ§æŒ‡æ ‡åœ¨åº•å±‚å¯ä»¥å…±ç”¨ä¸€å¥—å¼‚å¸¸æ£€æµ‹é€»è¾‘ï¼Œé€šè¿‡ä¸åŒçš„å‚æ•°æ¥è°ƒæ•´å„è‡ªçš„ç‰¹å¾ã€‚ä¸Šé¢å†å°è£…ä¸€å±‚ä¸åŒçš„ä¸šåŠ¡æ£€æµ‹é€»è¾‘è¿›è¡Œå®šåˆ¶åŒ–ï¼Œå‡å°‘è¯¯æŠ¥ã€‚æœ¬ç« èŠ‚ä»¥MySQLç£ç›˜ä½¿ç”¨ç‡æ£€æµ‹ä¸ºä¾‹è¿›è¡Œä»‹ç»ã€‚</p>
<p><strong>3.1.1 åœºæ™¯åˆ†æ</strong></p>
<p>MySQLç£ç›˜ä½¿ç”¨ç‡ä¸€èˆ¬éƒ½æ˜¯å‡åŒ€ä¸Šæ¶¨çš„ï¼Œå¦‚ä¸‹é¢ç›‘æ§æ›²çº¿å±•ç¤ºï¼Œåœ¨çº¢æ¡†æ ‡è¯†çš„èŒƒå›´ä¹‹å‰ï¼Œä½¿ç”¨ç‡å˜åŒ–éå¸¸å¹³ç¨³ï¼Œå¯¹äºè¿™ç§åœºæ™¯ï¼Œå¦‚æœä½¿ç”¨ç‡çªç„¶å¢åŠ å¯è§†ä¸ºå¼‚å¸¸ï¼Œå¦‚çº¢æ¡†èŒƒå›´å†…çš„æ•°æ®ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30e0010bb88f41e9ba4599fbd4e1ce4d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=ODfRP3ABxFmA27gMh9vYWaONJhQ%3D" alt="" loading="lazy"/></p>
<p>æŠ¥è­¦ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d7bcc45226a4f55b1ad4021ed3d1ed3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=xnkpBMeZTommH1k1f0%2FWS0y7RBo%3D" alt="" loading="lazy"/></p>
<p><strong>3.1.2 å¹³ç¨³è¶‹åŠ¿å¼‚å¸¸æ£€æµ‹å®ç°</strong></p>
<p>å¹³ç¨³è¶‹åŠ¿å¼‚å¸¸æ£€æµ‹ä½¿ç”¨çš„DoubleRollingAggregateç®—æ³•ï¼Œæ˜¯ä¸€ç§çª—å£æ£€æµ‹ç®—æ³•ï¼Œå…¶ä¸»è¦åŸç†å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5449c60359834396ba802a8c4bb36461~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=eTxPKrZ63c2GXeimtoG9Y%2B9Psrs%3D" alt="" loading="lazy"/></p>
<p>åœ¨ç›‘æ§æ›²çº¿ä¸Šåˆ›å»ºä¸¤ä¸ªæ»‘åŠ¨çª—å£ï¼Œæ¯ä¸ªçª—å£è¦†ç›–nä¸ªç›‘æ§ç‚¹ï¼ˆå¯è®¾ç½®ï¼‰ï¼Œä¸¤ä¸ªçª—å£ä¾æ¬¡ä»å·¦å‘å³æ»‘åŠ¨ï¼Œå³çª—å£çš„å¹³å‡å€¼-å·¦çª—å£çš„å¹³å‡å€¼çš„ç»“æœç”Ÿæˆä¸€æ¡æ–°çš„æ›²çº¿ï¼Œä¹Ÿå¯ä»¥æ ¹æ®éœ€æ±‚è®¡ç®—æ¯ä¸ªçª—å£çš„ä¸­ä½æ•°/æœ€å¤§å€¼/IQRç­‰æŒ‡æ ‡ï¼Œå¾—åˆ°çš„æ•°æ®æ›²çº¿å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a99676e45cdf4b7994b026f8195bdcbf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=YnZl06PHdRYLQWSU4uK6dIrwP%2Bg%3D" alt="" loading="lazy"/></p>
<p>æ–°æ›²çº¿å°äº0çš„ç‚¹è¯´æ˜æ˜¯åŸæ›²çº¿åœ¨ä¸‹é™ï¼Œæ–°æ›²çº¿å¤§äº0çš„ç‚¹è¯´æ˜æ˜¯åŸæ›²çº¿åœ¨ä¸Šå‡ï¼Œæ›²çº¿ä¸Šç»å¯¹å€¼è¶Šå¤§ï¼Œé‚£ä¹ˆå˜åŒ–ï¼ˆä¸Šå‡/ä¸‹é™ï¼‰çš„å¹…åº¦å°±è¶Šå¤§ã€‚</p>
<p>å¯ä»¥æ ¹æ®æ–°æ›²çº¿å¤§äº0/å°äº0çš„ç‚¹çš„ä¸ªæ•°å æ€»ç‚¹æ•°çš„æ¯”ä¾‹ï¼Œæ¥åˆ¤æ–­æ•´ä½“è¶‹åŠ¿ä¸Šå‡æˆ–ä¸‹é™çš„ç¨‹åº¦ã€‚</p>
<p>çª—å£å¤§å°å¯è°ƒèŠ‚ï¼Œçª—å£è¶Šå¤§ï¼Œç»“æœè¶Šå¹³ç¼“ï¼ŒIQRæ£€æµ‹æ—¶è¶Šèƒ½æ¶ˆé™¤å™ªéŸ³ï¼Œè´Ÿé¢å½±å“å°±æ˜¯å¯èƒ½æ¼æ‰ä¸€äº›å¼‚å¸¸ç‚¹ã€‚</p>
<p><strong>3.1.3 æ£€æµ‹è°ƒä¼˜</strong></p>
<p>æ ¹æ®ç£ç›˜å¢é•¿çš„ç‰¹æ€§ï¼Œæ£€æµ‹é€»è¾‘å¦‚ä¸‹:</p>
<ul>
<li>
<p>é¦–å…ˆå¯¹ä¸»æœºè¿›è¡Œç­›é€‰ï¼Œä¾‹å¦‚å¯¹äºç£ç›˜ä½¿ç”¨ç‡å°äº50%çš„ä¸»æœºä¸è¿›è¡Œæ£€æµ‹ã€‚</p>
</li>
<li>
<p>å¢é•¿å¹…åº¦å¤§äºè®¾å®šé˜ˆå€¼ï¼Œè¯´æ˜å¢é•¿è¿‡å¿«ï¼Œåˆ™åˆ¤å®šä¸ºå¼‚å¸¸ã€‚</p>
</li>
<li>
<p>æœ€è¿‘ä½¿ç”¨ç‡å¤§äºè®¾å®šé˜ˆå€¼ï¼Œåˆ™åˆ¤å®šä¸ºå¼‚å¸¸ï¼ˆå’Œæ™®é€šçš„å›ºå®šé˜ˆå€¼å¼‚å¸¸æ£€æµ‹ç›¸ç»“åˆï¼‰ã€‚</p>
</li>
<li>
<p>å’Œå…·ä½“åœºæ™¯ç»“åˆï¼š</p>
</li>
</ul>
<p>a.åœ¨ç£ç›˜ä½¿ç”¨ç‡å°äºè®¾å®šé˜ˆå€¼æ—¶æ£€æµ‹åˆ°æœ‰å˜åŒ–å¼‚å¸¸ï¼Œä½†æ˜¯å¼‚å¸¸æ—¶é—´èŒƒå›´å†…æœ‰å¯¹åº”å®ä¾‹ä¸­çš„è¡¨åœ¨æ‰§è¡ŒDDLæ“ä½œåŠŸèƒ½ï¼Œä¸”å·¥å•æ‰§è¡Œæ—¶é—´èŒƒå›´å’Œå¼‚å¸¸æ—¶é—´èŒƒå›´å»åˆåº¦è¾ƒé«˜ï¼Œåˆ™ä¸è®°ä¸ºéœ€è¦å…³æ³¨çš„å¼‚å¸¸ç°è±¡ã€‚</p>
<p>b.åœ¨ç£ç›˜ä½¿ç”¨ç‡å°äºè®¾å®šé˜ˆå€¼æ—¶æ£€æµ‹åˆ°æœ‰å˜åŒ–å¼‚å¸¸ï¼Œä½†æ˜¯æœ‰æ•°æ®åœ¨å¾€å…¶ä¸»æœºä¸Šè¿›è¡Œè¿ç§»ï¼Œè¿ç§»æ‰§è¡Œæ—¶é—´èŒƒå›´å’Œå¼‚å¸¸æ—¶é—´èŒƒå›´å»åˆåº¦è¾ƒé«˜ï¼Œåˆ™ä¸è®°ä¸ºéœ€è¦å…³æ³¨çš„å¼‚å¸¸ç°è±¡ã€‚</p>
<ul>
<li>ä¸»æœºç£ç›˜ä½¿ç”¨è¾…åŠ©æŠ¥è¡¨</li>
</ul>
<p>æœ‰äº›å®ä¾‹æ²¡æœ‰è®¾ç½®max_binlog_fileså‚æ•°ï¼Œåªè®¾ç½®äº†ä¿ç•™7å¤©çš„binlogï¼Œåœ¨æœ‰å½’æ¡£ä»»åŠ¡æ—¶å¯èƒ½ä¼šäº§ç”Ÿå‡ ç™¾Gçš„binlogï¼Œå¯¼è‡´ç£ç›˜å¼‚å¸¸ä¸Šæ¶¨ï¼Œè¿™ç§åœºæ™¯ä¼šæŠŠè¿™å°æœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰å®ä¾‹ä¿¡æ¯å±•ç¤ºå‡ºæ¥ï¼ŒåŒ…æ‹¬å‚æ•°é…ç½®ï¼Œbinlogå¤§å°ç­‰ä¿¡æ¯ï¼Œæ–¹ä¾¿å¿«é€Ÿå®šä½é—®é¢˜ã€‚æ‰€ä»¥åœ¨ç£ç›˜ä½¿ç”¨é‡å¼‚å¸¸æŠ¥è­¦æ¶ˆæ¯ä¸­å¢åŠ äº†ä¸€ä¸ªè¾…åŠ©æŠ¥è¡¨ååŠ©DBAå®šä½ç£ç›˜ä½¿ç”¨å¼‚å¸¸çš„åŸå› ã€‚æŠ¥è¡¨å†…å®¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80d87b243f644e9d9dcf4abeb85a0320~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=hHzXZRR82fP52h2emevJsZYmkd0%3D" alt="" loading="lazy"/></p>
<p><strong>3.1.4 ç¨³å®šæ€§ç®—æ³•å»¶ä¼¸</strong></p>
<p>ç¨³å®šæ€§ç®—æ³•é€šè¿‡è°ƒæ•´ä¸€äº›å‚æ•°å°±å¯ä»¥æ£€æµ‹åˆ°é•¿æœŸç¼“æ…¢å¢æ¶¨çš„åœºæ™¯ï¼Œä¾‹å¦‚ä¸‹é¢ç›‘æ§å›¾æ˜¯MySQLæ‰«æè¡Œæ•°çš„ç›‘æ§å›¾ï¼Œç”±äºä¸šåŠ¡æ–°ä¸Šçº¿äº†ä¸€ä¸ªsqlï¼Œéšç€è¡¨æ•°æ®é‡å¢åŠ å’Œæ‰§è¡Œé¢‘ç‡å¢åŠ ï¼Œå¯¼è‡´å®ä¾‹æ‰«æè¡Œæ•°é•¿æœŸç¼“æ…¢ä¸Šæ¶¨ï¼Œï¼Œåœ¨é€ æˆä¸¥é‡çš„æ…¢æŸ¥è¯¢å‰éœ€è¦æ£€æµ‹å‡ºè¿™ç§å¼‚å¸¸æ¥ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02cf71f27cab4197a58110fc1ca247d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=TwblYmQLaIu4IoDpMIFxZV1VlXU%3D" alt="" loading="lazy"/></p>
<p>å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p>
<p>å…ˆè¿‡æ»¤å‡ºè¿‘ä¸€å¤©æœ€å¤§æ‰«æè¡Œæ•°å¤§äºè®¾å®šé˜ˆå€¼çš„å®ä¾‹ã€‚å¯¹äºè¿™ç§é•¿æœŸå¢é•¿çš„æ£€æµ‹å¯ä»¥ç®€åŒ–ä¸ºå¯¹æ¯”æ¯å¤©é«˜å³°æœŸæ—¶é—´æ‰«æè¡Œæ•°å¼‚å¸¸å˜åŒ–çš„æ£€æµ‹ï¼Œå–æ¯å¤©é«˜å³°æ—¶é—´å†…çš„ä¸€ä¸ªç›‘æ§ç‚¹ï¼Œè¿ç»­å–è¿‘30å¤©çš„ç›‘æ§æ•°æ®ï¼Œç„¶åå¯¹è¿™30ä¸ªç›‘æ§ç‚¹è¿›è¡Œå¹³ç¨³æ€§å¼‚å¸¸æ£€æµ‹ï¼Œå¦‚è®¾ç½®çª—å£å¤§å°ä¸º5ï¼Œæ¯ä¸ªçª—å£å–æœ€å¤§å€¼ï¼Œè®¡ç®—ä¸¤ä¸ªçª—å£çš„å·®ï¼Œé€šè¿‡åˆ¤æ–­æ–°æ›²çº¿æ­£å€¼çš„æ¯”ä¾‹ï¼Œå³å¯åˆ¤æ–­å‡ºè¿™ç§å¢é•¿å¼‚å¸¸ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¸ç®€å•çš„ä½¿ç”¨æ‰«æè¡Œæ•°å¤§äºæŸä¸ªé˜ˆå€¼å°±è§†ä¸ºå¼‚å¸¸å‘¢ï¼Ÿé¦–å…ˆå„ä¸ªå®ä¾‹å¯¹åº”ä¸šåŠ¡åœºæ™¯ä¸åŒï¼Œé˜ˆå€¼çš„è®¾å®šæ— æ³•è¿›è¡Œè¾ƒå¥½çš„ç»Ÿä¸€ï¼Œè®¾ç½®è¾ƒä½å‘Šè­¦ä¿¡æ¯å¤ªå¤šï¼Œè®¾ç½®è¾ƒé«˜ä¼šå¯¼è‡´æ¼æŠ¥ã€‚å¦‚æœå’Œè¶‹åŠ¿åˆ¤æ–­ç»“åˆï¼Œå°±èƒ½å¼¥è¡¥å›ºå®šé˜ˆå€¼æ£€æµ‹å¯¼è‡´çš„æ¼æŠ¥é—®é¢˜ï¼Œå¹¶ä¸”å¯ä»¥æå‰å‘ç°é£é™©è¿›è¡Œä»‹å…¥å¤„ç†ã€‚</p>
<h3 data-id="heading-4">3.2 å‘¨æœŸæ€§å˜åŒ–å¼‚å¸¸æ£€æµ‹</h3>
<p>å¯¹äºå®ä¾‹çš„QPSï¼ŒMySQLçš„æ‰«æè¡Œæ•°ï¼ŒRediså†…å­˜ä½¿ç”¨è¿™äº›æŒ‡æ ‡ï¼Œæœ‰äº›ä¸šåŠ¡åœºæ™¯ä¸‹æ˜¯å…·æœ‰å‘¨æœŸæ€§å˜åŒ–è§„å¾‹çš„ã€‚ä½†æ˜¯æœ€è¿‘ä¸€æ®µæ—¶é—´çªç„¶è„±ç¦»äº†å‘¨æœŸæ€§çš„å˜åŒ–èŒƒå›´æˆ–å¹…åº¦ï¼Œè¿™ç§å¼‚å¸¸æƒ…å†µä¹Ÿéœ€è¦è¿›è¡Œè¯†åˆ«ï¼Œæœ¬ç« èŠ‚ä»¥Rediså‘¨æœŸæ€§å†…å­˜ä½¿ç”¨é‡å¼‚å¸¸æ£€æµ‹ä»‹ç»ç¬¦åˆå‘¨æœŸæ€§å˜åŒ–ç‰¹å¾çš„å¼‚å¸¸æ£€æµ‹ã€‚</p>
<p><strong>3.2.1 åœºæ™¯åˆ†æ</strong></p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªRediså®ä¾‹å†…å­˜ä½¿ç”¨ç‡ç›‘æ§æ•°æ®:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/310e3296d90947cc8891562f8dc73dc6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=Fooo8p4Es4JLmdsuTI8xC5ztr%2B8%3D" alt="" loading="lazy"/></p>
<p>ä»ç›‘æ§å›¾ä¸Šå¯ä»¥çœ‹å‡ºè¯¥Rediså®ä¾‹çš„å†…å­˜ä½¿ç”¨æœ‰ä¸¤ä¸ªæ˜æ˜¾ç‰¹ç‚¹ï¼š</p>
<ul>
<li>
<p>å†…å­˜ä½¿ç”¨é‡å‘ˆç°ä»¥ä¸€å¤©ä¸ºå‘¨æœŸçš„å˜åŒ–è§„å¾‹ã€‚</p>
</li>
<li>
<p>åœ¨å‘¨æœŸå†…Redisä½¿ç”¨é‡å…·æœ‰æ³¢åŠ¨æ€§ã€‚</p>
</li>
</ul>
<p>å¯¹äºè¿™ç§æƒ…å†µæˆ‘ä»¬é‡ç‚¹å…³æ³¨çš„æ˜¯è¿ç»­å‘¨æœŸçš„å˜åŒ–è¶‹åŠ¿æ˜¯ä¸æ˜¯ä¸€è‡´çš„ï¼Œæœ€è¿‘çš„å˜åŒ–å’Œä¹‹å‰çš„åŒå‘¨æœŸå˜åŒ–æœ‰æ— è¾ƒå¤§å·®å¼‚ï¼Œè€Œå¯¹äºå•ä¸ªå‘¨æœŸå†…çš„å¢å‡å˜åŒ–ä¸äºˆä»¥é‡ç‚¹å…³æ³¨ã€‚é€šè¿‡å‘¨æœŸæ€§å¼‚å¸¸æ£€æµ‹ç®—æ³•æ£€æµ‹ç»“æœå¦‚ä¸‹ï¼Œçº¢è‰²çš„ç›‘æ§ç‚¹æ˜¯æ£€æµ‹å‡ºæ¥çš„å¼‚å¸¸ç‚¹ã€‚å¯ä»¥çœ‹å‡ºæœ€è¿‘ä¸€ä¸ªå‘¨æœŸçš„å˜åŒ–é‡æ˜æ˜¾é«˜äºå‰é¢çš„ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a6c22cd6a77414690bd46d18eb905dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=Dq1TLji7MzhkRT0IXGqRovB%2Fagw%3D" alt="" loading="lazy"/></p>
<p>æŠ¥è­¦æ¶ˆæ¯å¦‚ä¸‹:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3118fbffc76940f1a5053e87b51f9f95~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=1oY6Pr5LUrWMLLjDpqfv%2BBQwCLY%3D" alt="" loading="lazy"/></p>
<p><strong>3.2.2 å‘¨æœŸæ€§å¼‚å¸¸æ£€æµ‹ç®—æ³•å®ç°åŸç†</strong></p>
<p>å‘¨æœŸæ€§æ£€æµ‹é€šè¿‡SeasonalADç®—æ³•å®ç°ï¼Œæ­¤ç®—æ³•é€šè¿‡pipenetè¿æ¥å¤šä¸ªæ•°æ®è½¬æ¢å™¨å’Œå¼‚å¸¸æ£€æµ‹å™¨æ¥æ£€æµ‹å‡ºå¼‚å¸¸ç‚¹ï¼Œå…·ä½“æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1ed4c2d8f234320b23831429f7d4f3a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=c31Hl9CEfc8WthfrsX5mTy6MzUw%3D" alt="" loading="lazy"/></p>
<p>a.æ•°æ®è½¬æ¢å™¨deseasonal_residual: deseasonal_residualé€šè¿‡ClassicSeasonalDecompositionç®—æ³•å»é™¤å‘¨æœŸæ€§çš„è§„å¾‹ç‰¹æ€§ã€‚åŸºäºè‡ªç›¸å…³å‡½æ•°(ACF)è·å–å‘¨æœŸé•¿åº¦ï¼Œç»å…¸çš„å‘¨æœŸæ€§åˆ†è§£å‡è®¾æ—¶é—´åºåˆ—æ˜¯ç”±è¶‹åŠ¿é¡¹ (trend)ã€å­£èŠ‚é¡¹ (seasonal pattern) å’Œå™ªå£°ï¼ˆå³æ®‹å·®ï¼‰ ä¸‰éƒ¨åˆ†åŠ å’Œè€Œæˆçš„ã€‚æ­¤æ­¥éª¤é€šè¿‡ç§»åŠ¨å¹³å‡è®¡ç®—å¹¶ç§»é™¤è¶‹åŠ¿æˆåˆ†ï¼Œé€šè¿‡è®¡ç®—å»è¶‹åŠ¿åŒ–ååºåˆ—åœ¨å¤šä¸ªå­£èŠ‚å‘¨æœŸä¸Šçš„å¹³å‡å€¼æ¥æå–å­£èŠ‚æ¨¡å¼ï¼Œæœ€ç»ˆè¿”å›æ®‹å·®åºåˆ—ã€‚ è¿”å›çš„ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c1b5c45949b463db2c8b0c27f3fa9cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=TdGO0oW%2FaIhi4jwvc0zagAaCXcE%3D" alt="" loading="lazy"/></p>
<p>b. å¼‚å¸¸åˆ†æï¼šå¼‚å¸¸åˆ†æé€šè¿‡ç”±ä¸¤æ¡æ£€æµ‹é“¾è·¯è¿›è¡Œæ£€æµ‹ï¼Œç„¶åå–ä¸¤ä¸ªé“¾è·¯ç»“æœäº¤é›†ã€‚</p>
<p>é“¾è·¯1 sin_checkï¼šç”¨äºæ£€æµ‹ä¸Šå‡çš„å¼‚å¸¸æˆ–æ£€æµ‹ä¸‹é™çš„å¼‚å¸¸ï¼Œæˆ–è€…éƒ½æ£€æµ‹ï¼Œé€šè¿‡å‚æ•°sideè®¾ç½®ã€‚ä¾‹å¦‚side = "positive"ï¼Œé‚£ä¹ˆsin_checkè¾“å‡ºçš„å¼‚å¸¸ç‚¹æ˜¯æ‰€æœ‰deseasonal_residualå¤§äº0çš„ç‚¹ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5efb2c93745a496bb0f5d17a450da77e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=1Uo7BYGd1yNGvNIchTZHsgttzNM%3D" alt="" loading="lazy"/></p>
<p>è¿™æ ·å†å’Œé“¾è·¯2çš„iqr_adæ±‚äº¤é›†åï¼Œå°±åªå‰©ä¸‹iqr_adä¸Šæ¶¨çš„å¼‚å¸¸ç‚¹äº†ã€‚</p>
<p>é“¾è·¯2ä¸­æœ‰ä¸¤ä¸ªç®—æ³•ï¼Œé¦–å…ˆæ˜¯abs_residualï¼Œç”¨äºè®¡ç®—deseasonal_residualç»“æœçš„ç»å¯¹å€¼ï¼Œè½¬åŒ–ä¸ºç»å¯¹å€¼æ˜¯ä¸ºäº†åœ¨ä½¿ç”¨å››åˆ†ä½è·æ³•æ£€æµ‹å¼‚å¸¸æ—¶ä¾¿äºè®¡ç®—ï¼Œè½¬åŒ–ä¸ºç»å¯¹å€¼åçš„ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7455717ff94e45029a7bcd56c38fe51d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=jXBhWEt5YtU%2Fd2%2FqmP0SFlPQX2k%3D" alt="" loading="lazy"/></p>
<p>é€šè¿‡abs_residualè½¬æ¢çš„ç»“æœå†é€šè¿‡iqr_ad(InterQuartileRangeAD)çš„å››åˆ†ä½è·æ³•è®¡ç®—ç¦»ç¾¤ç‚¹ï¼Œæ£€æµ‹ç»“æœå¦‚ä¸‹ï¼Œå…¶ä¸­çº¢è‰²ä¸ºç¦»ç¾¤ç‚¹ï¼ˆå¼‚å¸¸ç‚¹ï¼‰:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9156b46472074b98b14713523e02cfd5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=OFutuxPvWad9XDKmkFX7uDg2T%2Fs%3D" alt="" loading="lazy"/></p>
<p>æœ€åå°†é“¾è·¯1 sign_checkæ£€æµ‹å‡ºæ¥çš„å¼‚å¸¸ç‚¹å’Œé“¾è·¯2 æ£€æµ‹å‡ºæ¥çš„å¼‚å¸¸ç‚¹æ±‚äº¤é›†ï¼Œå¾—åˆ°æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼Œå…¶ä¸­çº¢è‰²éƒ¨åˆ†ä¸ºæˆ‘ä»¬éœ€è¦å…³æ³¨çš„å¼‚å¸¸ç‚¹:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29f52818a23446468534ab9dc4430df5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=AMEJ16wKMfQBii%2BoiPgkqGsYFrM%3D" alt="" loading="lazy"/></p>
<p>åœ¨åŸå§‹ç›‘æ§å›¾æ ‡è¯†å‡ºä¸Šé¢æ£€æµ‹åˆ°çš„å¼‚å¸¸ç‚¹ï¼Œå¾—åˆ°çš„æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9d8e6740e2c47d58b00a87f7e268158~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=LTMydq2VUat%2B2zJu6%2BMeTQRvPOc%3D" alt="" loading="lazy"/></p>
<p><strong>3.2.3 æ£€æµ‹è°ƒä¼˜</strong></p>
<p>åœ¨ä½¿ç”¨å‘¨æœŸæ€§å˜åŒ–å¼‚å¸¸æ£€æµ‹ä¹‹å‰ï¼Œé¦–å…ˆè¦è¯†åˆ«å‡ºè¦æ£€æµ‹çš„æŒ‡æ ‡æ˜¯å¦å…·æœ‰å‘¨æœŸæ€§å˜åŒ–çš„è§„å¾‹ï¼Œé€šè¿‡æœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒï¼Œå¯¹è¿‘nå¤©çš„ç›‘æ§æ•°æ®è¿›è¡Œåˆ†è§£å‘¨æœŸç‰¹å¾ï¼Œè®¡ç®—è‡ªç›¸å…³æ€§æ¥è·å¾—å‘¨æœŸä¿¡æ¯ã€‚ä¸€èˆ¬æƒ…å†µä¸‹è¿™ç§å‘¨æœŸæ€§è§„å¾‹ä¸ä¼šæœ‰å¾ˆå¤§çš„å˜åŒ–ï¼Œæ‰€ä»¥åœ¨åˆå§‹èŠ‚ç‚¹å°†éœ€è¦è¿›è¡Œæ£€æµ‹çš„æŒ‡æ ‡å…¨éƒ¨éå†æ£€æµ‹ä¸€éï¼Œç„¶åå°†ç¬¦åˆå‘¨æœŸæ€§çš„é›†ç¾¤ä¿¡æ¯è®°å½•åˆ°å…ƒæ•°æ®åº“ä¸­ï¼Œåé¢å†å®šæ—¶æ›´æ–°ç›¸å…³å…ƒæ•°æ®ã€‚åœ¨è¿›è¡Œå‘¨æœŸæ€§å˜åŒ–å¼‚å¸¸æ£€æµ‹æ—¶åªæ£€æµ‹æ•°æ®åº“ä¸­æœ‰ç›¸åº”è®°å½•çš„é›†ç¾¤å³å¯ã€‚å¦å¤–å¯¹äºæœ‰å‘¨æœŸæ€§å˜åŒ–è§„å¾‹çš„é›†ç¾¤æŒ‡æ ‡ï¼Œåœ¨è¿›è¡Œå¹³ç¨³æ€§å¼‚å¸¸æ£€æµ‹æ—¶å¯ä»¥å¾ˆå¥½çš„è¿›è¡Œè¿‡æ»¤æˆ–è€…è®¾ç½®ç‰¹æ®Šçš„é˜ˆå€¼ã€‚</p>
<p>åœ¨ä½¿ç”¨å‘¨æœŸæ€§å˜åŒ–å¼‚å¸¸æ£€æµ‹æ—¶è¿˜éœ€è¦æœ‰å…¶ä»–æ£€æµ‹æ ‡å‡†è¿›è¡Œè”åˆåˆ¤æ–­ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´å¾ˆå¤šæ— æ•ˆçš„å¼‚å¸¸ä¿¡æ¯ï¼Œåœ¨æ»¡è¶³ä¸‹åˆ—å…¶ä¸­ä¸€é¡¹æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œå¯¹äºRediså†…å­˜ä½¿ç”¨é‡æ£€æµ‹ï¼Œå³ä½¿å‘¨æœŸæ€§å˜åŒ–ç›‘æµ‹åˆ°æœ‰å¼‚å¸¸è¡Œä¸ºä¹Ÿè¢«è§†ä¸ºå®‰å…¨èŒƒå›´å†…çš„å¼‚å¸¸æ³¢åŠ¨ï¼Œä¸éœ€è¦å…³æ³¨å’Œè¿›è¡Œæ¶ˆæ¯æé†’ï¼š</p>
<ul>
<li>
<p>æ£€æµ‹æ—¶é—´èŒƒå›´å†…å¦‚æœRediså†…å­˜ä½¿ç”¨é‡æˆ–ä½¿ç”¨ç‡å°äºä¸€å®šé˜ˆå€¼ã€‚</p>
</li>
<li>
<p>å®é™…ä½¿ç”¨å†…å­˜æœ€å¤§å€¼-æœ€å°å€¼çš„å·®å°äºè®¾å®šé˜ˆå€¼(æ³¢åŠ¨å°)ã€‚</p>
</li>
<li>
<p>åœ¨ä¸€å®šæ—¶é—´æ®µå†…å¼‚å¸¸ç‚¹çš„æ•°é‡å°äºè®¾å®šé˜ˆå€¼ã€‚</p>
</li>
</ul>
<h3 data-id="heading-5">3.3 çªå˜å¼‚å¸¸æ£€æµ‹</h3>
<p>è¿™ç§æƒ…å†µæ˜¯æŒ‡åœ¨å¾ˆçŸ­æ—¶é—´èŒƒå›´(ç¬æ—¶)å†…ï¼Œç›‘æ§æŒ‡æ ‡çªç„¶å‘ç”Ÿè¾ƒå¤§å¹…åº¦çš„å˜åŒ–ï¼Œä¸‹é¢ä»¥MySQLæœåŠ¡å™¨CPUæ°´ä½å˜åŒ–æ£€æµ‹å’ŒQPSå¼‚å¸¸æ£€æµ‹ä¸ºä¾‹åˆ†åˆ«ä»‹ç»ã€‚</p>
<p><strong>3.3.1 MySQLæœåŠ¡å™¨CPUæ°´ä½å˜åŒ–</strong></p>
<h4 data-id="heading-6">3.3.1.1 åœºæ™¯åˆ†æ</h4>
<p>æ­£å¸¸æƒ…å†µä¸‹ï¼ŒMySQLçš„CPUæ°´ä½åœ¨20%ä»¥ä¸‹ï¼Œå¸¸è§„æŠ¥è­¦é˜ˆå€¼è®¾ç½®ä¸º50%ï¼Œåœ¨è¾¾åˆ°æŠ¥è­¦é˜ˆå€¼ä¹‹å‰ï¼Œå¦‚æœcpuæ°´ä½çªç„¶ä¸Šæ¶¨å¹¶æŒç»­ä¸€æ®µæ—¶é—´ï¼Œè¯´æ˜ä¸šåŠ¡æœ‰ä¸åˆç†çš„è¯·æ±‚ï¼Œéœ€è¦å…³æ³¨ã€‚ å¦‚ä¸‹é¢æ‰€ç¤ºçš„ç›‘æ§æ›²çº¿ï¼Œåœ¨16:25æ—¶é—´ç‚¹çªç„¶ä¸Šæ¶¨çº¦ä¸€å€çš„é‡ï¼Œå¹¶ä¸€ç›´æŒç»­ä¿æŒåœ¨30%çš„ä½¿ç”¨ç‡ï¼Œå¯¹äºè¿™ç§ç¬æ—¶çªå˜çš„åœºæ™¯åº”è§†ä¸ºå¼‚å¸¸ç°è±¡:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14d4fde974364168a9fa3b744742e38d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=vZpG6h%2FgClyShmVXgfKmedg2HlQ%3D" alt="" loading="lazy"/></p>
<p>æŠ¥è­¦ä¿¡æ¯ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bc1df50b9e8844a7b79333c37beb9757~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=9JwKp%2B%2FxGv%2Bil4k%2BsyAmhNjkwNM%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-7">3.3.1.2 æ°´ä½ç›‘æµ‹å®ç°åŸç†</h4>
<p>æ°´ä½çªå˜æ£€æµ‹ä½¿ç”¨LevelShiftADæ£€æµ‹ç®—æ³•ï¼Œå®ƒä½¿ç”¨äº†å¤šä¸ªè½¬æ¢å™¨å’Œæ£€æµ‹å™¨ï¼Œé€šè¿‡pipenetè¿æ¥èµ·æ¥ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe8d8f518cf94131a3b2c63e74dc7d45~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=R%2Bh7ViXzKhrZMkGzhYmpuSAxRqk%3D" alt="" loading="lazy"/></p>
<p>é“¾è·¯1å…ˆç”¨DoubleRollingAggregate(diff_abs)ç®—æ³•è¿›è¡Œæ•°æ®è½¬æ¢,åŒæ—¶ä½¿ç”¨ä¸¤ä¸ªæ»‘åŠ¨çª—å£ä»å·¦å‘å³æ»‘åŠ¨ï¼Œè®¡ç®—ä¸¤ä¸ªæ»‘åŠ¨çª—å£çš„ä¸­ä½æ•°çš„ç»å¯¹å·®å€¼(Absolute difference)ï¼Œäº§ç”Ÿä¸€ç»„æ–°çš„æ—¶é—´åºåˆ—ã€‚å†é€šè¿‡InterQuartileRangeAD(iqr_ads)å››åˆ†ä½è·æ³•è®¡ç®—ç¦»ç¾¤ç‚¹ã€‚</p>
<p>diff_abså°†å›¾4-1-1ç›‘æ§æ•°æ®è½¬æ¢æˆæ–°çš„æ—¶é—´åºåˆ—ï¼Œå½¢æˆçš„æ›²çº¿ç»“æœå¦‚ä¸‹:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0532832ab35d4dfd887b58ad5575a6c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=4lIWvc7nmuu4R6lWUkAmSi22bS8%3D" alt="" loading="lazy"/></p>
<p>å°†diff_absè½¬åŒ–åçš„æ—¶é—´åºåˆ—ä½œä¸ºiqr_adsçš„è¾“å…¥ï¼Œé€šè¿‡iqrè®¡ç®—å‡ºå¼‚å¸¸ç‚¹,å¼‚å¸¸æ£€æµ‹ä¹‹åçš„å›¾ç¤ºç»“æœå¦‚ä¸‹ï¼Œçº¢è‰²ç‚¹æ˜¯å¼‚å¸¸ç‚¹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41658950370b4a9b836f16dac7f906fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=UCB5CDf31xNlmefrKT%2FaghqXWVA%3D" alt="" loading="lazy"/></p>
<p>é“¾è·¯2åŒæ ·å…ˆé€šè¿‡DoubleRollingAggregate(diff)ç®—æ³•è¿›è¡Œæ•°æ®è½¬æ¢ï¼Œä¸åŒçš„æ˜¯è¿™æ¬¡æ˜¯è®¡ç®—çš„ä¸¤ä¸ªçª—å£ä¸­ä½æ•°çš„å·®å€¼ï¼Œäº§ç”Ÿå¦ä¸€ç»„æ–°çš„æ—¶é—´åºåˆ—ï¼Œå½¢æˆçš„æ›²çº¿å¦‚ä¸‹ã€‚ç„¶åå†é€šè¿‡ThresholdAD(sign_check)ç®—æ³•æ£€æµ‹å¼‚å¸¸ç‚¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c648e5b1b4f4e00bad5de3cf9b38ce3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=id3%2Bb42vPOebV7SJHptF82vKeX0%3D" alt="" loading="lazy"/></p>
<p>sign_checkä½œç”¨å’Œå‘¨æœŸæ€§æ£€æµ‹ä¸­çš„sign_checkä¸€æ ·,ç”¨äºåŒºåˆ†æ–¹å‘æ€§ï¼Œè¿™é‡Œåªæ£€æµ‹æ°´ä½ä¸Šå‡ï¼Œæ‰€ä»¥æ‰€æœ‰æ­£æ•°éƒ½æ˜¯å¼‚å¸¸ç‚¹ã€‚ å›¾ç¤ºç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b1f8f226a63143e3967fb49000f5ae97~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=A8%2FtPps7zpv%2B8VY%2BuTqFa16JnBY%3D" alt="" loading="lazy"/></p>
<p>é“¾è·¯1å’Œé“¾è·¯2çš„æ£€æµ‹ç»“æœæ±‚äº¤é›†ï¼Œè·å¾—æœ€åçš„ç»“æœï¼Œæ£€æµ‹å‡ºæ°´ä½çªç„¶ä¸Šå‡çš„è¾¹ç¼˜ï¼Œå›¾ç¤ºå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6925143a10024d8ea996a9131617382e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=LXV95a7DpAeVE3t%2B4Rm5WSr6Hbw%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-8">3.3.1.3 æ£€æµ‹è°ƒä¼˜</h4>
<p>é€šè¿‡é™æ€å‚æ•°è¿‡æ»¤æ‰ä¸€äº›æ²¡æœ‰å¿…è¦çš„æŠ¥è­¦ï¼Œä¾‹å¦‚å¦‚æœcpuçš„æœ€å¤§å€¼å°äºé˜ˆå€¼ï¼Œåˆ™ä¸ç®—å¼‚å¸¸ã€‚å¦‚æœæœ€è¿‘å‡ ä¸ªç‚¹çš„å¹³å‡å€¼å°äºé˜ˆå€¼ï¼Œåˆ™ä¸ç®—å¼‚å¸¸ï¼Œå› ä¸ºå·²ç»æ¢å¤äº†ï¼Œæ²¡å¿…è¦é‡å¤æŠ¥è­¦ã€‚ä¸€äº›BIç±»ä¸šåŠ¡è®¾ç½®é«˜é˜ˆå€¼ã€‚</p>
<p><strong>3.3.2 QPSå¼‚å¸¸è´Ÿå¢é•¿æ£€æµ‹</strong></p>
<p>QPSè™½ç„¶æ³¢åŠ¨å¾ˆå¤§ï¼Œä½†ä¸€èˆ¬éƒ½æ˜¯å‘ä¸Šçªå¢ï¼Œå³ä½¿æœ‰å‘ä¸‹çš„æ³¢åŠ¨å…¶å˜åŒ–å¹…åº¦ä¹Ÿä¸åº”è¯¥å¾ˆå¤§ã€‚å¦‚æœä¸€ä¸ªå®ä¾‹çš„QPSçªç„¶é™ä½åˆ°å‡ ä¹ä¸ºé›¶ï¼Œç„¶ååˆå¿«é€Ÿæ¢å¤ï¼Œé‚£è¿™ç§æƒ…å†µæ˜¯å­˜åœ¨å¼‚å¸¸çš„ã€‚æœ¬ç« èŠ‚ä»‹ç»æ£€æµ‹QPSæ‰0çš„åœºæ™¯ã€‚æ³¨æ„è¿™é‡Œè¯´çš„æ‰0æ˜¯çªç„¶é™ä½åˆ°å¾ˆä½çš„æ°´å¹³ï¼Œä¸ä¸€å®šå…¨æ˜¯0ã€‚</p>
<h4 data-id="heading-9">3.3.2.1 åœºæ™¯åˆ†æ</h4>
<p>åœ¨å¤§äº‹åŠ¡æäº¤æ—¶ï¼Œç”±äºå†™binlogè€—æ—¶é•¿ï¼Œå°†Binlog Eventså†™å…¥Binlogæ–‡ä»¶çš„è¿‡ç¨‹å¿…é¡»è¦ä¸²è¡Œæ‰§è¡Œï¼Œåªæœ‰ä¸€ä¸ªäº‹åŠ¡å†™å®Œäº†ï¼Œå¦å¤–ä¸€ä¸ªäº‹åŠ¡æ‰èƒ½æ‰§è¡Œï¼Œè¿™æ—¶å¯èƒ½å¯¼è‡´å†™æ“ä½œæ‰0ã€‚ä½ç‰ˆæœ¬çš„MySQLæ˜¯å•çº¿ç¨‹å¤åˆ¶ï¼Œä»èŠ‚ç‚¹åº”ç”¨å¤§äº‹åŠ¡æ—¶ï¼Œä¹Ÿä¼šå¯¼è‡´ä»èŠ‚ç‚¹QPSæ‰0ï¼Œå¹¶ä¼´æœ‰ä¸»ä»å»¶è¿Ÿã€‚å¦‚ä¸‹ç›‘æ§æ‰€ç¤ºï¼Œåœ¨çº¦16:30æ—¶åˆ»QPSçªç„¶å¤§å¹…åº¦é™ä½ï¼Œç„¶ååˆå¿«é€Ÿæ¢å¤ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bf12f8d055b84f509051715fa0d07a62~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=m7KE85B13EgzltNFNwPlzJ0JSTM%3D" alt="" loading="lazy"/></p>
<p>é€šè¿‡å¼‚å¸¸æ£€æµ‹ç®—æ³•æ£€æµ‹å‡ºæ¥çš„æ•ˆæœå¦‚ä¸‹(çº¢è‰²ç‚¹æ˜¯å¼‚å¸¸ç‚¹)ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36cd07bfa09e401d9939b3064e5243fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=9ZVXf6eLQBmkwwBJGHHcRPkUseA%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-10">3.3.2.2 ç®—æ³•å®ç°åŸç†</h4>
<p>è¿™ç§æŒ‡æ ‡çªç„¶æ‰0çš„å¼‚å¸¸æƒ…å†µä½¿ç”¨IQRï¼ˆInterquartile Rangeï¼Œå››åˆ†ä½è·ï¼‰æ£€æµ‹å¯ä»¥å¿«é€Ÿåœ°æŠŠå¼‚å¸¸å€¼ç­›é€‰å‡ºæ¥ã€‚IQRæ˜¯ç»Ÿè®¡å­¦ä¸­è¡¡é‡æ•°æ®åˆ†æ•£ç¨‹åº¦çš„æŒ‡æ ‡ï¼Œç‰¹åˆ«é€‚åˆå¤„ç†éæ­£æ€åˆ†å¸ƒæˆ–å­˜åœ¨å¼‚å¸¸å€¼çš„æ•°æ®ã€‚é€šè¿‡èšç„¦æ•°æ®ä¸­é—´50%çš„åˆ†å¸ƒèŒƒå›´ï¼Œè§„é¿æç«¯å€¼å¹²æ‰°ï¼Œæ˜¯æ•°æ®åˆ†æä¸­ç¨³å¥çš„ç¦»æ•£åº¦åº¦é‡å·¥å…·ã€‚</p>
<p>å¾ˆå¤šå¼‚å¸¸æ£€æµ‹éƒ½æ˜¯æŠŠåŸå§‹æ•°æ®è½¬æ¢åï¼Œé€šè¿‡IQRè¿›è¡Œçš„ç¦»ç¾¤ç‚¹æ£€æµ‹ï¼Œæ˜¯ä¸€ç§åŸºæœ¬çš„ç¦»ç¾¤ç‚¹æ£€æµ‹ç®—æ³•ã€‚</p>
<p>IQR æè¿°çš„æ˜¯æ•°æ®é›†ä¸­â€œä¸­é—´50%â€çš„æ•°æ®èŒƒå›´ï¼Œè¯¦ç»†æ¦‚å¿µå¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p>å°†æ•°æ®ä»å°åˆ°å¤§æ’åºåï¼Œå¹³å‡åˆ†æˆ4æ®µï¼š</p>
</li>
<li>
<p>Q1ï¼ˆç¬¬1å››åˆ†ä½æ•°ï¼‰ï¼šæ’ååœ¨å‰25%ä½ç½®çš„æ•°å€¼ï¼ˆä¾‹ï¼šç­çº§è€ƒè¯•ç¬¬25åçš„åˆ†æ•°ï¼‰</p>
</li>
<li>
<p>Q3ï¼ˆç¬¬3å››åˆ†ä½æ•°ï¼‰ï¼šæ’ååœ¨å‰75%ä½ç½®çš„æ•°å€¼ï¼ˆä¾‹ï¼šç­çº§è€ƒè¯•ç¬¬75åçš„åˆ†æ•°ï¼‰</p>
</li>
<li>
<p>IQR = Q3 - Q1 ,å³ä¸­é—´50%æ•°æ®çš„è·¨åº¦ï¼ˆå¦‚ä¸‹å›¾ç¤ºï¼‰</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c779a00f8d84c9b955c06b6b388541c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=dZpRg%2BUfZ%2BltDejDfGRE%2Fr%2Fzy1c%3D" alt="" loading="lazy"/></p>
<p>è‹¥æ•°æ®è¶…å‡º [ğ‘„1âˆ’ğ‘1 * ğ¼ğ‘„ğ‘… , ğ‘„3+ğ‘2 * ğ¼ğ‘„ğ‘…] èŒƒå›´ï¼Œåˆ™è§†ä¸ºå¼‚å¸¸å€¼ã€‚</p>
<p>ä¸¾ä¾‹è¯´æ˜ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æŠŠç›‘æ§æ•°æ®ä»å°åˆ°å¤§æ’åºåï¼Œæ•°æ®å¦‚ä¸‹</span>
data = [<span class="hljs-number">5</span>,<span class="hljs-number">7</span>,<span class="hljs-number">10</span>,<span class="hljs-number">15</span>,<span class="hljs-number">19</span>,<span class="hljs-number">21</span>,<span class="hljs-number">21</span>,<span class="hljs-number">22</span>,<span class="hljs-number">22</span>,<span class="hljs-number">23</span>,<span class="hljs-number">23</span>,<span class="hljs-number">23</span>,<span class="hljs-number">23</span>,<span class="hljs-number">23</span>,<span class="hljs-number">24</span>,<span class="hljs-number">24</span>,<span class="hljs-number">24</span>,<span class="hljs-number">24</span>,<span class="hljs-number">25</span>]
<span class="hljs-built_in">len</span>(data) <span class="hljs-comment"># 19 </span>
<span class="hljs-comment"># æ•£åˆ—å›¾</span>
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
plt.scatter(<span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)),data)
<span class="hljs-comment"># ç›´æ–¹å›¾ æ˜¯é¢‘ç‡åˆ†å¸ƒ</span>
plt.hist(data)
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ffc94cc24d446ed8eea3bff8f6d4bc0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=BqwTpr6UVTM4gCxqiTo43YM2Cqw%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/542c6579566e4bb3b86218e8b7be0a41~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=0%2FAx9uiw1iDXz4mpZBjZ4jKTrZQ%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç¬¬ä¸€ä¸ªå››åˆ†ä½æ•°</span>
<span class="hljs-attr">Q1</span> = df.number.quantile(<span class="hljs-number">0.25</span>,interpolation=<span class="hljs-string">'nearest'</span>)
Q1 <span class="hljs-comment"># 19</span>
<span class="hljs-comment"># ç¬¬ä¸‰ä¸ªå››åˆ†ä½æ•°</span>
<span class="hljs-attr">Q3</span> = df.number.quantile(<span class="hljs-number">0.75</span>,interpolation=<span class="hljs-string">'nearest'</span>)
Q3 <span class="hljs-comment"># 24</span>
<span class="hljs-comment">#å››åˆ†ä½é—´è·</span>
<span class="hljs-attr">IQR</span> = Q3-Q1
IQR <span class="hljs-comment"># 5</span>
<span class="hljs-comment"># å‡è®¾c1è®¾ä¸º1.5ï¼Œç¬¬ä¸€ä¸ªå››åˆ†ä½æ•°ä»¥ä¸‹ï¼Œå¹¶æ£€æŸ¥è¾ƒä½çš„ç¦»ç¾¤å€¼ã€‚å°äºè¿™ä¸ªå€¼çš„æ•°ä¸ºå¼‚å¸¸ç‚¹</span>
Q1 - 1.5*IQR <span class="hljs-comment">#11.5</span>

<span class="hljs-comment"># å‡è®¾c2è®¾ä¸º1.5,ç¬¬ä¸‰ä¸ªå››åˆ†ä½æ•°ä»¥ä¸Šï¼Œå¹¶æ£€æŸ¥è¾ƒé«˜çš„ç¦»ç¾¤å€¼ã€‚å¤§äºè¿™ä¸ªå€¼çš„æ•°ä¸ºå¼‚å¸¸ç‚¹</span>
Q3 + 1.5*IQR <span class="hljs-comment"># 31.5</span>
</code></pre>
<p>æ­£å¸¸èŒƒå›´æ˜¯ [ğ‘„1âˆ’ğ‘1 * ğ¼ğ‘„ğ‘… , ğ‘„3+ğ‘2 * ğ¼ğ‘„ğ‘…] = [11.5,31.5]</p>
<p>æ‰€ä»¥è¶…å‡º[11.5,31.5]èŒƒå›´çš„ç‚¹è®¤ä¸ºæ˜¯å¼‚å¸¸ç‚¹ï¼Œ5ï¼Œ7ï¼Œ10è¿™3ä¸ªç‚¹æ˜¯å°äºä¸‹é™ç‚¹å¼‚å¸¸ç‚¹ï¼Œæ²¡æœ‰å¤§äºä¸Šé™çš„å¼‚å¸¸ç‚¹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1486cd45a0949abae38388c77f79328~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=FlfykD6dTSXQp%2FFtJ7psnS10Vqk%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-11">3.3.2.3 æ£€æµ‹è°ƒä¼˜</h4>
<p>åœ¨å®é™…åœºæ™¯ä¸­å¾ˆå¤šé›†ç¾¤çš„QPSæ³¢åŠ¨å¹…åº¦å¾ˆå¤§ï¼Œä¸”æ²¡æœ‰æ˜æ˜¾çš„è§„å¾‹æ€§ï¼Œä»æ•°å­¦æ„ä¹‰ä¸Šçš„ç¦»ç¾¤ç‚¹ä¸­è¿‡æ»¤å‡ºæˆ‘ä»¬éœ€è¦å…³å¿ƒçš„å¼‚å¸¸ç‚¹æ˜¯æ­¤æ£€æµ‹é¡¹ä¸­çš„é‡ç‚¹ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ˜ç¡®ï¼Œè¿™ç§åœºæ™¯ä¸‹æˆ‘ä»¬åªæƒ³æ£€æµ‹å‡ºçªç„¶æ‰ä¸º0çš„è¿™ç§å˜åŒ–æ¯”è¾ƒæç«¯çš„æƒ…å†µï¼Œæ‰€ä»¥c2è®¾ä¸€ä¸ªå¾ˆå¤§å€¼ï¼Œä¸æ£€æŸ¥çªå¢çš„å¼‚å¸¸ç‚¹ï¼Œc1è®¾ä¸€ä¸ªåˆç†å€¼ï¼Œè¿™æ ·å¯ä»¥æ£€æµ‹å‡ºçªç„¶æ‰0çš„å¼‚å¸¸ç‚¹ã€‚</p>
<p>å› ä¸ºè¿™ç§æ‰0çš„æƒ…å†µæŒç»­å¾ˆçŸ­ï¼Œæ£€æµ‹ç›‘æ§ç‚¹çš„æ—¶é—´èŒƒå›´ä¸€èˆ¬ä¸èƒ½å¤ªé•¿ï¼Œå¦åˆ™å®¹æ˜“ä¸¢æ‰å¼‚å¸¸æˆ–è€…æœ‰è¯¯åˆ¤ï¼Œæ‰€ä»¥ä»prometheusè·å–ç›‘æ§æ•°æ®çš„stepè®¾ä¸ºäº†15sï¼Œæé«˜é‡‡é›†ç²¾åº¦ã€‚å¦‚æœç”±äºæ•…éšœå¯¼è‡´QPSé•¿æ—¶é—´æ‰0ï¼Œé‚£ä¹ˆå…¶ä»–æ ¸å¿ƒæŒ‡æ ‡ä¹Ÿä¼šå‡ºç°å¼‚å¸¸ï¼Œæ•°æ®åº“æŠ¥è­¦ä¼šå‘ç°è¿™ç§æƒ…å†µè¿›è¡ŒæŠ¥è­¦ï¼Œè¿™ç§æƒ…å†µä¸åœ¨è¯¥å¼‚å¸¸æ£€æµ‹åœºæ™¯ä¸­ã€‚</p>
<p>åœ¨åšè¿™ç§çªç„¶æ‰ä¸º0çš„æç«¯å˜åŒ–å¼‚å¸¸æ£€æµ‹æ—¶ï¼Œè¿˜éœ€è¦è€ƒè™‘å‘¨æœŸæ€§å’Œå…ˆçªå¢åˆçªé™çš„æƒ…å†µï¼š</p>
<p>a.å‘¨æœŸæ€§ä¸‹é™</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58a674b559b84cefa1209bdcfb170802~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=DcYAwUsAkw4zuGWLNkAeNzd40hM%3D" alt="" loading="lazy"/></p>
<p>ä¸Šå›¾è¿™ç§å‘¨æœŸæ€§æ‰0çš„æƒ…å†µä¸åº”è¯¥ç®—åšå¼‚å¸¸ï¼Œéœ€è¦å‰”é™¤æ‰ã€‚æ£€æµ‹æ€è·¯å¦‚ä¸‹ï¼š</p>
<p>è®¡ç®—è¿‘ä¸€æ®µæ—¶é—´æ˜¯å¦å…·æœ‰å‘¨æœŸæ€§è§„å¾‹ï¼Œå¦‚æœæœ‰å‘¨æœŸæ€§è§„å¾‹ï¼Œè®¡ç®—å‡ºä¸€ä¸ªå‘¨æœŸçš„é•¿åº¦n(ä¸€ä¸ªå‘¨æœŸé‡Œæœ‰nä¸ªç›‘æ§ç‚¹)ï¼Œè®¡ç®—æœ€è¿‘è¿ç»­çš„2ä¸ªä½æ°´ä½çš„å¼‚å¸¸ç‚¹çš„å¹³å‡å€¼aï¼Œè·å¾—è¿™2ä¸ªç‚¹å¯¹åº”çš„å‰ä¸€ä¸ªå‘¨æœŸåŒä¸€æ—¶åˆ»çš„ç›‘æ§å¹³å‡å€¼bå’Œå‰ä¸¤ä¸ªå‘¨æœŸå¯¹åº”åŒä¸€æ—¶åˆ»çš„ç›‘æ§å¹³å‡å€¼cï¼Œå¯¹æ¯”aå’Œbçš„ç»å¯¹å€¼ï¼Œaå’Œcçš„ç»å¯¹å€¼ï¼Œå› ä¸ºæ­£å¸¸æƒ…å†µä¸‹å¼‚å¸¸ç‚¹çš„å€¼éƒ½å¾ˆå°ï¼Œæ‰€ä»¥è¿™é‡Œç”¨ç»å¯¹å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæ²¡æœ‰ç”¨æ¯”ä¾‹ã€‚å¦‚æœç»å¯¹å€¼å·®åˆ«ä¸å¤§ï¼Œè¯´æ˜æ­¤æ¬¡æ‰0æ˜¯å…·æœ‰å‘¨æœŸæ€§çš„ï¼Œä¸ç®—åšå¼‚å¸¸ã€‚</p>
<p>ä»å†å²æ›²çº¿ä¸­è®¡ç®—å‡ºå‘¨æœŸé•¿åº¦çš„æ€è·¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p>å› ä¸ºéç­‰é—´éš”é‡‡æ ·ä¼šç ´åè‡ªç›¸å…³è®¡ç®—çš„åŸºç¡€,éœ€è¦å…ˆæ£€æµ‹è¾“å…¥çš„ç›‘æ§ç‚¹æ˜¯å¦è¿ç»­ï¼Œç›¸é‚»çš„æ—¶é—´æˆ³çš„å·®æ˜¯å¦ç›¸ç­‰ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨è‡ªç›¸å…³å‡½æ•°ACFè®¡ç®—è‡ªç›¸å…³æ€§,è·å¾—è‡ªç›¸å…³ç³»æ•°ï¼Œå¯»æ‰¾æœ‰æ•ˆè‡ªç›¸å…³èµ·ç‚¹ã€‚</p>
</li>
<li>
<p>æ£€æµ‹æ˜¾è‘—å³°å€¼ã€‚</p>
</li>
<li>
<p>å¦‚æœæœ‰å¤šä¸ªå€™é€‰å³°å€¼ï¼Œè·å¾—è‡ªç›¸å…³å€¼æœ€å¤§çš„ä½ç½®ï¼Œè¿”å›å‘¨æœŸé•¿åº¦ã€‚</p>
</li>
</ul>
<p>å¯¹å‘¨æœŸæ€§ä¸‹é™æ£€æµ‹å¤„ç†åçš„ç»“æœå¦‚ä¸‹ï¼Œè¿™ç§ä¸ä¼šå‘é€å·¡æ£€å¼‚å¸¸æ¶ˆæ¯ï¼Œè¿™é‡Œä¸ºäº†å±•ç¤ºå¤„ç†æ•ˆæœã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27747ab56a3f4e2c8e6a74a9a064bbcc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=YnRfdGw9IGOxSd%2B4o5jKIBu3MmE%3D" alt="" loading="lazy"/></p>
<p>b.æ°´ä½ä¸Šå‡ç„¶åä¸‹é™</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bbc05f65e9d94a7a807e8efe1ae18ea3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=hAFDFsO2zfiur4VjNEWpfFbrJ9E%3D" alt="" loading="lazy"/></p>
<p>ä¸Šå›¾è¿™ç§ä¸‹é™åæŒç»­ä¿æŒä½ä½ï¼Œå¯èƒ½æ˜¯æœ‰ä»»åŠ¡å¯¼è‡´çš„ï¼ŒIQRæ£€æµ‹æ—¶å–çš„è¿‘30åˆ†é’Ÿçš„æ•°æ®ï¼Œä½†å®šæ—¶ä»»åŠ¡å¯èƒ½æ‰§è¡Œå¾ˆé•¿æ—¶é—´ï¼Œæ‰€ä»¥è¿™é‡Œå–è¿‘10ä¸ªå°æ—¶çš„ç›‘æ§æ•°æ®ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62a9324006454f88acf13c20639d0736~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=%2Fc76gJaBCdY84oaHs4FEj%2Fj1t70%3D" alt="" loading="lazy"/></p>
<p>éœ€è¦æŠŠè¿™ç§æ°´ä½ä¸Šå‡ä¹‹å‰qpsæœ¬æ¥å°±å¾ˆä½çš„åœºæ™¯è¯†åˆ«å‡ºæ¥ï¼Œè¿™ç§åœºæ™¯ä¸åº”è¯¥ç®—ä½œå¼‚å¸¸ã€‚æ°´ä½å¼‚å¸¸å˜åŒ–çš„åœºæ™¯åŸºäºLevelShiftADç®—æ³•æ£€æµ‹,å’ŒMySQLæœåŠ¡å™¨CPUæ°´ä½æ£€æµ‹ç®—æ³•ä¸€æ ·ï¼Œæ£€æµ‹ç»“æœå¦‚ä¸‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b450088821484050aaf985ac345e1638~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=ICJISzPoiUqD%2F0skM44CPpXIa0c%3D" alt="" loading="lazy"/></p>
<p>è¿™æ ·å°±è·å¾—äº†levelshiftå˜åŒ–çš„å¼‚å¸¸ç‚¹ï¼Œä½†è¿™ç§å¼‚å¸¸ç‚¹æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚ä¸Šå›¾ä¸­æ°´ä½é«˜çš„è¿™éƒ¨åˆ†ä¸­åˆæœ‰ä¸€ä¸ªå³°å€¼(qpså¤§äº1000çš„è¿™éƒ¨åˆ†)ï¼Œéœ€è¦è¿›è¡Œå¤„ç†ã€‚</p>
<p>ä»iqrè¿”å›çš„å¼‚å¸¸ç‚¹ä¸­è·å–æœ€è¿‘ä¸€æ®µè¿ç»­çš„å¼‚å¸¸ç‚¹ï¼Œæ±‚æœ€å°å€¼min_iqrï¼Œè¿™ä¸ªå€¼å°±æ˜¯æœ€è¿‘çš„qpsæ‰0æ—¶çš„å€¼ã€‚</p>
<p>ä»levelshiftè¿”å›åˆ°å¼‚å¸¸ç‚¹ä¸­ä»å³å‘å·¦éå†ï¼Œè·å–æ¯ç»„è¿ç»­çš„å¼‚å¸¸ç‚¹ï¼Œå‰”é™¤æœ€å³è¾¹çš„ä¸€ç»„(è¿™ç»„æ˜¯qpsä¸‹é™çš„ç‚¹),è·å–å‰©ä¸‹çš„å¼‚å¸¸ç‚¹çš„å€¼ï¼Œå› ä¸ºçª—å£æ³•æ»‘åŠ¨æ—¶æœ‰æ»åæ€§ï¼Œæ‰€ä»¥è¿˜è¦è·å¾—æ¯ä¸ªå¼‚å¸¸ç‚¹å·¦è¾¹çš„windowä¸ªç‚¹çš„å€¼(windowä¸ºä¸€ä¸ªçª—å£è¦†ç›–å¤šå°‘ä¸ªç‚¹)ï¼Œæ±‚æœ€å°å€¼min_ls,æ¯”è¾ƒmin_iqrå’Œmin_lsçš„ç»å¯¹å€¼ï¼Œå¦‚æœæ°´ä½å¢é•¿å‰çš„ç‚¹å’Œiqræœ€è¿‘çš„å¼‚å¸¸ç‚¹çš„å·®å€¼åœ¨å¾ˆå°çš„ä¸€ä¸ªèŒƒå›´å†…ï¼Œæˆ–è€…min_lsæ¯”min_iqrè¿˜å°ï¼Œåˆ™è®¤ä¸ºæ°´ä½å‰åçš„qpsä¸€æ ·ï¼Œä¸ç®—åšå¼‚å¸¸ã€‚</p>
<p>ä¸ºäº†è°ƒè¯•æ–¹ä¾¿ï¼ŒæŠŠè¯¦ç»†è¿‡ç¨‹å‘é€åˆ°æ¶ˆæ¯é‡Œ:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/15d2151016b7470fbfb0f6d6992f4d99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=M78fYr7%2Bc1JTs5r7%2BMGZm0aD5po%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-12">å››ã€å®æˆ˜ç»éªŒä¸è°ƒä¼˜</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/33aba3da26054b538fa9de70066fce3c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950682&amp;x-signature=se%2FC4QMr0y7g8%2BNo0d5PHQ9KoRI%3D" alt="" loading="lazy"/></p>
<p>ç›®å‰æˆ‘ä»¬å·²ç»åœ¨çº¿ä¸ŠæˆåŠŸéƒ¨ç½²äº†CPU/ç£ç›˜/å†…å­˜/è¡¨å¤§å°/QPS/æ‰«æè¡Œæ•°ç­‰åå‡ ä¸ªå…³é”®æŒ‡æ ‡æ£€æµ‹é¡¹ï¼Œç³»ç»ŸæŠ¥è­¦å‡†ç¡®ç‡åœ¨80%ä»¥ä¸Šï¼Œæ˜¾è‘—æé«˜äº†å·¡æ£€æ•ˆç‡ï¼Œå¹¶æœ‰æ•ˆå‡å°‘äº†å¸¸è§„æŠ¥è­¦æ•°é‡ã€‚</p>
<p>åœ¨ç®—æ³•ç­–ç•¥æ–¹é¢ï¼Œ æˆ‘ä»¬è®¤è¯†åˆ°ä¸åŒæŒ‡æ ‡å…·æœ‰å„è‡ªçš„æ•°æ®ç‰¹å¾ï¼Œæ— æ³•ä¾èµ–å•ä¸€ç®—æ³•è¦†ç›–æ‰€æœ‰åœºæ™¯ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é€šè¿‡å¯¹æŒ‡æ ‡è¿›è¡Œç›¸ä¼¼ç‰¹å¾å½’ç±»ï¼Œæå–å…¶æ•°å­¦æ„ä¹‰ä¸Šçš„å…±æ€§ï¼Œå¯¹åŒä¸€ç±»æŒ‡æ ‡é‡‡ç”¨é€‚é…çš„ç®—æ³•ä½“ç³»ã€‚ç›®å‰é€šç”¨ç®—æ³•å·²è¦†ç›–çº¦ 80% çš„æ£€æµ‹éœ€æ±‚ï¼Œå…¶ä½™éƒ¨åˆ†åˆ™é€šè¿‡å®šåˆ¶åŒ–é€»è¾‘ç²¾å‡†è¡¥å……ã€‚</p>
<p>æˆ‘ä»¬å°†ç®—æ³•ä¸ä¸šåŠ¡åœºæ™¯æ·±åº¦ç»“åˆï¼Œä¸»åŠ¨è¯†åˆ«å¹¶è¿‡æ»¤ç”± DDL å·¥å•æ‰§è¡Œã€æ•°æ®è¿ç§»ç­‰ä¸å®šæœŸæ“ä½œå¼•èµ·çš„æŒ‡æ ‡æ³¢åŠ¨ã€‚è¿™ç±»ä¸šåŠ¡è¡Œä¸ºå±äºæ­£å¸¸èŒƒç•´ï¼Œä¸åº”è§¦å‘å¼‚å¸¸æŠ¥è­¦ï¼Œä»è€Œæœ‰æ•ˆé™ä½è¯¯æŠ¥ç‡ã€‚</p>
<p>åœ¨é˜ˆå€¼ç®¡ç†æ–¹é¢ï¼Œé‡‡ç”¨åŠ¨æ€ä¸é™æ€ç›¸ç»“åˆçš„ç­–ç•¥ï¼šåŠ¨æ€é˜ˆå€¼é€šè¿‡æœºå™¨å­¦ä¹ è‡ªåŠ¨å­¦ä¹ æŒ‡æ ‡å†å²è§„å¾‹ï¼Œå®ç°æ•æ„Ÿåº¦çš„è‡ªé€‚åº”è°ƒæ•´ï¼›é™æ€é˜ˆå€¼åˆ™ä½œä¸ºç¡¬æ€§è¾¹ç•Œï¼Œæä¾›å…œåº•ä¿æŠ¤ï¼Œé˜²æ­¢æç«¯æƒ…å†µä¸‹çš„æ¼æŠ¥ã€‚</p>
<p>é’ˆå¯¹æŠ¥è­¦é€šçŸ¥ï¼Œæˆ‘ä»¬å®æ–½äº†å¤šç»´æ”¶æ•›æœºåˆ¶ï¼šçºµå‘æ”¶æ•›åŸºäºæ—¶é—´çª—å£ï¼Œå¯¹è¿ç»­å‡ºç°çš„åŒä¸€æŠ¥è­¦è¿›è¡Œåˆå¹¶ä¸æ¶ˆæ¯æ›´æ–°ï¼›æ¨ªå‘æ”¶æ•›ä¾æ‰˜å…³è”åˆ†æï¼Œå¯¹åŒä¸€é›†ç¾¤ä¸‹å¤šä¸ªå®ä¾‹çš„ç›¸åŒæŠ¥è­¦ï¼Œæˆ–åŒä¸€ä¸šåŠ¡ç»„å†…å¤šä¸ªé›†ç¾¤çš„åŒç±»æŠ¥è­¦è¿›è¡Œèšåˆå¤„ç†ï¼Œä»æ ¹æºä¸Šé¿å…å‘Šè­¦é£æš´ï¼Œæå‡å‘Šè­¦å¯è¯»æ€§å’Œå¯æ“ä½œæ€§ã€‚</p>
<h2 data-id="heading-13">äº”ã€æœªæ¥å±•æœ›</h2>
<p>åœ¨æ¨è¿›æ™ºèƒ½å¼‚å¸¸æ£€æµ‹ç³»ç»Ÿæ¼”è¿›çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åšæŒç”±ç®€å…¥ç¹ã€å¾ªåºæ¸è¿›çš„ç­–ç•¥ï¼šé¦–å…ˆä»å•æŒ‡æ ‡å¼‚å¸¸æ£€æµ‹å…¥æ‰‹ï¼Œé€æ­¥æ‹“å±•åˆ°å¤šæŒ‡æ ‡è”åˆåˆ†æï¼Œæœ€ç»ˆå®ç°è‡ªåŠ¨åŒ–çš„æ ¹å› å®šä½ã€‚ç›®å‰ï¼Œå»å“ªå„¿ç½‘DBAå›¢é˜Ÿå·²åœ¨å•æŒ‡æ ‡æ£€æµ‹æ–¹é¢è¦†ç›–ç»å¤§å¤šæ•°è¿ç»´åœºæ™¯ï¼Œå¹¶é’ˆå¯¹ç‰¹å®šé›†ç¾¤å’Œä¸šåŠ¡éœ€æ±‚å®Œæˆäº†å®šåˆ¶åŒ–å¤„ç†ï¼Œæœ‰æ•ˆæå‡äº†æ£€æµ‹çš„é€‚ç”¨æ€§ä¸å‡†ç¡®æ€§ã€‚</p>
<p>å½“å‰ï¼Œæˆ‘ä»¬æ­£ç¨³æ­¥æ¨è¿›å¤šæŒ‡æ ‡è”åˆå¼‚å¸¸æ£€æµ‹çš„æ¢ç´¢ä¸å®è·µï¼Œæ—¨åœ¨é€šè¿‡æŒ‡æ ‡é—´çš„å…³è”åˆ†æè¿›ä¸€æ­¥æå‡æ£€æµ‹è¦†ç›–ç‡å’Œç²¾å‡†åº¦ã€‚æœªæ¥ï¼Œç³»ç»Ÿå°†é€æ­¥æ‰¿æ‹…æ›´å¤šè‡ªåŠ¨åŒ–è¯Šæ–­å·¥ä½œï¼Œå¸®åŠ©DBAå‡å°‘é‡å¤æ€§å·¡æ£€è´Ÿæ‹…ï¼Œä½¿å…¶èƒ½å¤Ÿå°†ç²¾åŠ›èšç„¦äºæ›´é«˜ä»·å€¼çš„æŠ€æœ¯ä¼˜åŒ–ä¸ç´§æ€¥æ•…éšœå¤„ç½®ä¸­ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…³äºnpmåŒ…è°ƒç”¨ä¸ç¯å¢ƒå…¼å®¹é—®é¢˜çš„è§£ç­”]]></title>    <link>https://juejin.cn/post/7603252259561062436</link>    <guid>https://juejin.cn/post/7603252259561062436</guid>    <pubDate>2026-02-06T01:49:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603252259561062436" data-draft-id="7603252259561046052" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…³äºnpmåŒ…è°ƒç”¨ä¸ç¯å¢ƒå…¼å®¹é—®é¢˜çš„è§£ç­”"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2026-02-06T01:49:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘å«é»‘å¤§å¸…"/> <meta itemprop="url" content="https://juejin.cn/user/1678295463898875"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…³äºnpmåŒ…è°ƒç”¨ä¸ç¯å¢ƒå…¼å®¹é—®é¢˜çš„è§£ç­”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1678295463898875/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘å«é»‘å¤§å¸…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T01:49:59.000Z" title="Fri Feb 06 2026 01:49:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å…³äºnpmåŒ…è°ƒç”¨ä¸ç¯å¢ƒå…¼å®¹é—®é¢˜çš„è§£ç­”</h2>
<p>åœ¨å‰ç«¯å¼€å‘å’ŒNode.jsåº”ç”¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¾ˆå¤šæ–°æ‰‹ä¼šé‡åˆ°ä¸¤ä¸ªæ ¸å¿ƒç–‘é—®ï¼šä¸€æ˜¯ä¸ºä»€ä¹ˆNode.jsä¸­ç”¨JavaScriptï¼ˆJSï¼‰ç¼–å†™çš„npmåŒ…ï¼Œç”¨TypeScriptï¼ˆTSï¼‰ä»£ç èƒ½æˆåŠŸè°ƒç”¨ï¼ŸäºŒæ˜¯ä¸ºä»€ä¹ˆæœ‰äº›npmåŒ…èƒ½åœ¨Vue3ä¸­ä½¿ç”¨ï¼Œæœ‰äº›å´åªèƒ½åœ¨Node.jsä¸­ä½¿ç”¨ï¼Ÿæœ¬æ–‡å°†ç»“åˆåŸºç¡€åŸç†å’Œå®é™…åœºæ™¯ï¼Œç”¨é€šä¿—æ˜“æ‡‚çš„æ–¹å¼ä¸ºå¤§å®¶æ¢³ç†æ¸…æ¥šè¿™ä¸¤ä¸ªé—®é¢˜ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€TSä¸ºä½•èƒ½æˆåŠŸè°ƒç”¨JSç¼–å†™çš„npmåŒ…ï¼Ÿ</h3>
<p>è¦ææ‡‚è¿™ä¸ªé—®é¢˜ï¼Œæ ¸å¿ƒè¦æŠ“ä½ä¸€ä¸ªå…³é”®å‰æï¼šTypeScriptæœ¬èº«å¹¶ä¸èƒ½è¢«æµè§ˆå™¨æˆ–Node.jsç›´æ¥è¿è¡Œï¼Œå®ƒæœ€ç»ˆä¸€å®šä¼šè¢«ç¼–è¯‘æˆæ ‡å‡†çš„JavaScriptä»£ç ã€‚è¿™æ˜¯TSèƒ½è°ƒç”¨JSåŒ…çš„åŸºç¡€ï¼Œå…·ä½“å¯ä»¥ä»â€œæ‰§è¡Œå±‚é¢â€å’Œâ€œç±»å‹å±‚é¢â€ä¸¤ä¸ªç»´åº¦æ‹†è§£ã€‚</p>
<h4 data-id="heading-2">1. æ‰§è¡Œå±‚é¢ï¼šTSæœ€ç»ˆä¼šè½¬ä¸ºJSè¿è¡Œ</h4>
<p>Node.jså’Œæµè§ˆå™¨çš„è¿è¡Œæ—¶ç¯å¢ƒï¼Œåªè®¤è¯†JavaScriptä»£ç ï¼Œå¯¹TSä»£ç æ˜¯â€œæ— æ„ŸçŸ¥â€çš„ã€‚æˆ‘ä»¬åœ¨å¼€å‘æ—¶ç¼–å†™çš„TSä»£ç ï¼Œæ— è®ºæ˜¯å¼•å…¥JSåŒ…è¿˜æ˜¯ç¼–å†™ä¸šåŠ¡é€»è¾‘ï¼Œæœ€ç»ˆéƒ½éœ€è¦é€šè¿‡TSç¼–è¯‘å™¨ï¼ˆtscï¼‰æˆ–æ„å»ºå·¥å…·ï¼ˆå¦‚Viteã€Webpackï¼‰ç¼–è¯‘ï¼Œè½¬æ¢æˆçº¯JSä»£ç åæ‰èƒ½è¿è¡Œã€‚</p>
<p>ä¸¾ä¸ªå®é™…çš„ä¾‹å­ï¼šå‡è®¾æˆ‘ä»¬å¼•å…¥ä¸€ä¸ªçº¯JSç¼–å†™çš„npmåŒ…ï¼ˆæ¯”å¦‚åä¸ºjs-written-packageï¼‰ï¼Œç¼–å†™çš„TSä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç¼–å†™çš„TSä»£ç ï¼ˆindex.tsï¼‰</span>
<span class="hljs-keyword">import</span> { sum } <span class="hljs-keyword">from</span> <span class="hljs-string">'js-written-package'</span>; <span class="hljs-comment">// å¼•å…¥JSç¼–å†™çš„npmåŒ…</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">sum</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)); <span class="hljs-comment">// è°ƒç”¨åŒ…ä¸­çš„sumå‡½æ•°</span>
</code></pre>
<p>ç»è¿‡ç¼–è¯‘åï¼Œä¼šç”ŸæˆNode.jsèƒ½ç›´æ¥è¿è¡Œçš„JSä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç¼–è¯‘åçš„JSä»£ç ï¼ˆindex.jsï¼‰</span>
<span class="hljs-keyword">const</span> { sum } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'js-written-package'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">sum</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>));
</code></pre>
<p>ä»è¿™ä¸ªè¿‡ç¨‹å¯ä»¥çœ‹å‡ºï¼ŒNode.jså®é™…è¿è¡Œçš„æ˜¯ç¼–è¯‘åçš„JSä»£ç ï¼Œå®ƒæ ¹æœ¬ä¸çŸ¥é“æˆ‘ä»¬çš„æºç æ˜¯ç”¨TSå†™çš„ï¼Œè‡ªç„¶èƒ½æ­£å¸¸è°ƒç”¨JSç¼–å†™çš„npmåŒ…â€”â€”æœ¬è´¨ä¸Šè¿˜æ˜¯JSä¸JSä¹‹é—´çš„è°ƒç”¨ã€‚</p>
<h4 data-id="heading-3">2. ç±»å‹å±‚é¢ï¼šç±»å‹å£°æ˜æ–‡ä»¶è§£å†³TSç±»å‹æ ¡éªŒé—®é¢˜</h4>
<p>TSçš„æ ¸å¿ƒä»·å€¼æ˜¯â€œç±»å‹æ£€æŸ¥â€ï¼Œå®ƒä¼šåœ¨å¼€å‘é˜¶æ®µæ ¡éªŒå˜é‡ç±»å‹ã€å‡½æ•°å‚æ•°ã€è¿”å›å€¼ç­‰ï¼Œé¿å…ç±»å‹é”™è¯¯ã€‚ä½†çº¯JSç¼–å†™çš„npmåŒ…ï¼Œæœ¬èº«æ²¡æœ‰ä»»ä½•ç±»å‹ä¿¡æ¯ï¼Œç›´æ¥åœ¨TSä¸­å¼•å…¥æ—¶ï¼ŒTSç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼ˆæç¤ºâ€œæ‰¾ä¸åˆ°æ¨¡å—çš„ç±»å‹å£°æ˜æ–‡ä»¶â€ï¼‰ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç¤¾åŒºå’ŒåŒ…ä½œè€…æä¾›äº†ä¸‰ç§ä¸»æµæ–¹æ¡ˆï¼Œç¡®ä¿TSèƒ½â€œè®¤è¯†â€JSåŒ…çš„ç±»å‹ï¼š</p>
<ul>
<li>
<p><strong>æ–¹æ¡ˆ1ï¼šåŒ…è‡ªå¸¦ç±»å‹å£°æ˜æ–‡ä»¶ï¼ˆ.d.tsæ–‡ä»¶ï¼‰</strong>ï¼šå¾ˆå¤šä¸»æµJSåŒ…ï¼ˆå¦‚axiosã€dayjsï¼‰åœ¨å‘å¸ƒæ—¶ï¼Œä¼šç‰¹æ„é™„å¸¦åç¼€ä¸º.d.tsçš„ç±»å‹å£°æ˜æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œé€»è¾‘ï¼Œåªè´Ÿè´£å‘TSç¼–è¯‘å™¨æè¿°ï¼šè¿™ä¸ªåŒ…æœ‰å“ªäº›å‡½æ•°ã€å‡½æ•°çš„å‚æ•°ç±»å‹æ˜¯ä»€ä¹ˆã€è¿”å›å€¼ç±»å‹æ˜¯ä»€ä¹ˆã€æœ‰å“ªäº›å±æ€§ç­‰ã€‚TSç¼–è¯‘å™¨è¯»å–è¿™ä¸ªæ–‡ä»¶åï¼Œå°±èƒ½å®Œæˆç±»å‹æ ¡éªŒï¼Œä¸ä¼šå†æŠ¥é”™ã€‚</p>
</li>
<li>
<p><strong>æ–¹æ¡ˆ2ï¼šç¤¾åŒºå…¬å…±ç±»å‹åº“ï¼ˆ@types/xxxï¼‰</strong>ï¼šå¯¹äºä¸€äº›è€æ—§çš„JSåŒ…ï¼Œä½œè€…å¯èƒ½æ²¡æœ‰æä¾›è‡ªå¸¦çš„ç±»å‹å£°æ˜æ–‡ä»¶ï¼Œè¿™æ—¶ç¤¾åŒºä¼šåœ¨@typeså‘½åç©ºé—´ä¸‹ç»´æŠ¤å…¬å…±çš„ç±»å‹å£°æ˜ã€‚æˆ‘ä»¬åªéœ€è¦é€šè¿‡npmå®‰è£…å¯¹åº”çš„@typesåŒ…ï¼ŒTSå°±èƒ½è¯†åˆ«è¯¥JSåŒ…çš„ç±»å‹ã€‚æ¯”å¦‚ä½¿ç”¨lodashï¼ˆçº¯JSåŒ…ï¼‰æ—¶ï¼Œå®‰è£…ç±»å‹å£°æ˜åŒ…ï¼š<code>npm install @types/lodash -D</code>ï¼Œå®‰è£…åTSå°±èƒ½æ­£å¸¸æ ¡éªŒlodashçš„ç±»å‹äº†ã€‚</p>
</li>
<li>
<p><strong>æ–¹æ¡ˆ3ï¼šå¿½ç•¥ç±»å‹æ ¡éªŒï¼ˆå…œåº•æ–¹æ¡ˆï¼‰</strong>ï¼šå¦‚æœæŸä¸ªJSåŒ…æ—¢æ²¡æœ‰è‡ªå¸¦ç±»å‹å£°æ˜ï¼Œä¹Ÿæ²¡æœ‰ç¤¾åŒºç»´æŠ¤çš„@typesåŒ…ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡é…ç½®tsconfig.jsonæ–‡ä»¶ï¼Œå…³é—­ä¸¥æ ¼ç±»å‹æ£€æŸ¥ï¼ˆæ¯”å¦‚è®¾ç½®"strict": falseï¼‰ï¼Œè¿™æ—¶TSä¼šæŠŠè¯¥JSåŒ…å½“ä½œanyç±»å‹ï¼ˆä»»æ„ç±»å‹ï¼‰å¤„ç†ï¼Œç¼–è¯‘è¿‡ç¨‹ä¾ç„¶èƒ½æ­£å¸¸é€šè¿‡ï¼Œåªæ˜¯å¤±å»äº†TSçš„ç±»å‹æ ¡éªŒåŠŸèƒ½ã€‚</p>
</li>
</ul>
<h4 data-id="heading-4">3. æ€»ç»“ï¼šTSè°ƒç”¨JSåŒ…çš„å®Œæ•´æµç¨‹</h4>
<ol>
<li>
<p>å¼€å‘è€…ç¼–å†™TSä»£ç ï¼Œå¼•å…¥çº¯JSç¼–å†™çš„npmåŒ…ï¼›</p>
</li>
<li>
<p>TSç¼–è¯‘å™¨é€šè¿‡.d.tsç±»å‹å£°æ˜æ–‡ä»¶ï¼ˆè‡ªå¸¦æˆ–@typesæä¾›ï¼‰è·å–åŒ…çš„ç±»å‹ä¿¡æ¯ï¼Œå®Œæˆç±»å‹æ ¡éªŒï¼›</p>
</li>
<li>
<p>TSä»£ç è¢«ç¼–è¯‘ä¸ºæ ‡å‡†çš„JavaScriptä»£ç ï¼›</p>
</li>
<li>
<p>Node.jsï¼ˆæˆ–æµè§ˆå™¨ï¼‰è¿è¡Œç¼–è¯‘åçš„JSä»£ç ï¼Œæ­£å¸¸è°ƒç”¨npmåŒ…çš„JSé€»è¾‘ã€‚</p>
</li>
</ol>
<h3 data-id="heading-5">äºŒã€ä¸ºä»€ä¹ˆæœ‰äº›npmåŒ…é€‚é…Vue3ï¼Œæœ‰äº›åªé€‚é…Node.jsï¼Ÿ</h3>
<p>è¿™ä¸ªé—®é¢˜çš„æ ¸å¿ƒç­”æ¡ˆçš„æ˜¯ï¼šnpmåŒ…çš„é€‚ç”¨åœºæ™¯ï¼Œç”±å®ƒæ‰€ä¾èµ–çš„â€œè¿è¡Œç¯å¢ƒAPIâ€å†³å®šã€‚Vue3é¡¹ç›®å’ŒNode.jsçš„è¿è¡Œç¯å¢ƒå®Œå…¨ä¸åŒï¼ŒäºŒè€…æ”¯æŒçš„åº•å±‚APIä¸äº’é€šï¼Œè¿™å°±å¯¼è‡´äº†åŒ…çš„å…¼å®¹æ€§å·®å¼‚ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬æ˜ç¡®ä¸¤ä¸ªæ ¸å¿ƒè¿è¡Œç¯å¢ƒçš„åŒºåˆ«ï¼š</p>























<table><thead><tr><th>è¿è¡Œç¯å¢ƒ</th><th>æ ¸å¿ƒè½½ä½“</th><th>ä¸“å±APIæ¥æº</th><th>æ ¸å¿ƒç‰¹å¾</th></tr></thead><tbody><tr><td>æµè§ˆå™¨ç¯å¢ƒï¼ˆVue3å‰ç«¯ï¼‰</td><td>Chromeã€Edgeç­‰æµè§ˆå™¨</td><td>DOM APIï¼ˆdocumentã€elementï¼‰ã€BOM APIï¼ˆwindowã€locationï¼‰</td><td>ç”¨äºé¡µé¢æ¸²æŸ“ã€ç”¨æˆ·äº¤äº’ï¼Œæ— æ–‡ä»¶ç³»ç»Ÿã€æœåŠ¡ç«¯èƒ½åŠ›</td></tr><tr><td>Node.jsç¯å¢ƒ</td><td>Node.jsè¿è¡Œæ—¶ï¼ˆç‹¬ç«‹ç¨‹åºï¼‰</td><td>å†…ç½®æ¨¡å—APIï¼ˆfsæ–‡ä»¶ç³»ç»Ÿã€pathè·¯å¾„ã€httpæœåŠ¡ï¼‰</td><td>ç”¨äºæœåŠ¡ç«¯å¼€å‘ã€å·¥å…·æ„å»ºï¼Œæ— DOMã€BOMå¯¹è±¡</td></tr></tbody></table>
<blockquote>
<p>éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼šVue3é¡¹ç›®å¹¶éå®Œå…¨è„±ç¦»Node.jsâ€”â€”å¼€å‘å’Œæ„å»ºé˜¶æ®µï¼ˆæ¯”å¦‚è¿è¡Œnpm run devã€npm run buildï¼‰ï¼ŒVue3çš„é…ç½®æ–‡ä»¶ï¼ˆå¦‚vite.config.tsã€vue.config.jsï¼‰æ˜¯è¿è¡Œåœ¨Node.jsç¯å¢ƒä¸­çš„ï¼›ä½†Vue3çš„é¡µé¢ä»£ç ï¼ˆå¦‚.vueæ–‡ä»¶ä¸­çš„è„šæœ¬ã€ç»„ä»¶ï¼‰ï¼Œæœ€ç»ˆä¼šè¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ã€‚è¿™ä¹Ÿæ˜¯å¾ˆå¤šäººæ··æ·†åŒ…é€‚é…åœºæ™¯çš„å…³é”®ã€‚</p>
</blockquote>
<h4 data-id="heading-6">1. å››ç±»npmåŒ…çš„é€‚é…åœºæ™¯è§£æ</h4>
<p>æ ¹æ®ä¾èµ–çš„APIä¸åŒï¼ŒnpmåŒ…ä¸»è¦åˆ†ä¸ºå››ç±»ï¼Œé€‚é…åœºæ™¯å„æœ‰å·®å¼‚ï¼š</p>
<h5 data-id="heading-7">ï¼ˆ1ï¼‰çº¯å·¥å…·å‡½æ•°åŒ…ï¼šå…¨ç¯å¢ƒé€šç”¨ï¼ˆVue3å’ŒNode.jséƒ½èƒ½ç”¨ï¼‰</h5>
<p>è¿™ç±»åŒ…çš„æ ¸å¿ƒç‰¹ç‚¹æ˜¯ï¼šä¸ä¾èµ–ä»»ä½•ç¯å¢ƒä¸“å±APIï¼Œåªåšçº¯é€»è¾‘è®¡ç®—ï¼ˆæ¯”å¦‚æ•°å­¦è¿ç®—ã€å­—ç¬¦ä¸²å¤„ç†ã€æ•°æ®æ ¼å¼åŒ–ã€æ—¥æœŸå¤„ç†ç­‰ï¼‰ï¼Œä»£ç æœ¬èº«æ˜¯â€œç¯å¢ƒæ— å…³â€çš„ï¼Œå› æ­¤å¯ä»¥åœ¨ä»»ä½•JSè¿è¡Œæ—¶ä¸­æ‰§è¡Œã€‚</p>
<p>å…¸å‹ä¾‹å­ï¼šlodashï¼ˆé€šç”¨å·¥å…·å‡½æ•°åº“ï¼‰ã€dayjsï¼ˆè½»é‡æ—¥æœŸå¤„ç†åº“ï¼‰ã€axiosï¼ˆè¯·æ±‚åº“ï¼Œå…¼å®¹åŒç¯å¢ƒï¼‰ã€momentï¼ˆæ—¥æœŸå¤„ç†ï¼Œå·²é€æ­¥è¢«dayjsæ›¿ä»£ï¼‰ã€‚</p>
<p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. Node.jsä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">import</span> _ <span class="hljs-keyword">from</span> <span class="hljs-string">'lodash'</span>;
_.<span class="hljs-title function_">debounce</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å»¶è¿Ÿæ‰§è¡Œ'</span>), <span class="hljs-number">1000</span>); <span class="hljs-comment">// é˜²æŠ–å‡½æ•°</span>

<span class="hljs-comment">// 2. Vue3é¡¹ç›®ä¸­ä½¿ç”¨ï¼ˆ&lt;script setup&gt;è¯­æ³•ï¼‰</span>
<span class="hljs-keyword">import</span> _ <span class="hljs-keyword">from</span> <span class="hljs-string">'lodash'</span>;
<span class="hljs-keyword">const</span> handleClick = _.<span class="hljs-title function_">throttle</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'èŠ‚æµç‚¹å‡»'</span>);
}, <span class="hljs-number">500</span>);
</code></pre>
<h5 data-id="heading-8">ï¼ˆ2ï¼‰Node.jsä¸“å±åŒ…ï¼šä»…Node.jså¯ç”¨ï¼ˆVue3å‰ç«¯ä»£ç ä¸å¯ç”¨ï¼‰</h5>
<p>è¿™ç±»åŒ…çš„ä»£ç ä¸­ï¼Œç›´æ¥è°ƒç”¨äº†Node.jsçš„å†…ç½®æ¨¡å—APIï¼ˆæ¯”å¦‚fsæ–‡ä»¶è¯»å†™ã€pathè·¯å¾„å¤„ç†ã€httpåˆ›å»ºæœåŠ¡ã€child_processå­è¿›ç¨‹ç­‰ï¼‰ã€‚ç”±äºæµè§ˆå™¨ç¯å¢ƒä¸­æ²¡æœ‰è¿™äº›APIï¼Œä¸€æ—¦åœ¨Vue3çš„å‰ç«¯é¡µé¢ä»£ç ä¸­å¼•å…¥å¹¶è°ƒç”¨ï¼Œæµè§ˆå™¨ä¼šç›´æ¥æŠ¥é”™ï¼ˆæ¯”å¦‚â€œfs is not definedâ€â€œrequire is not definedâ€ï¼‰ã€‚</p>
<p>å…¸å‹ä¾‹å­ï¼šexpressï¼ˆNode.jsæœåŠ¡ç«¯æ¡†æ¶ï¼‰ã€koaï¼ˆè½»é‡æœåŠ¡ç«¯æ¡†æ¶ï¼‰ã€multerï¼ˆæ–‡ä»¶ä¸Šä¼ å¤„ç†åº“ï¼‰ã€fs-extraï¼ˆæ–‡ä»¶ç³»ç»Ÿå¢å¼ºåº“ï¼‰ã€dotenvï¼ˆç¯å¢ƒå˜é‡é…ç½®åº“ï¼‰ã€‚</p>
<p>è¡¥å……è¯´æ˜ï¼šè¿™ç±»åŒ…è™½ç„¶ä¸èƒ½ç”¨åœ¨Vue3çš„å‰ç«¯é¡µé¢ä»£ç ä¸­ï¼Œä½†å¯ä»¥ç”¨åœ¨Vue3çš„å¼€å‘æ„å»ºé…ç½®ä¸­ï¼ˆæ¯”å¦‚vite.config.tsï¼‰ï¼Œå› ä¸ºé…ç½®æ–‡ä»¶æ˜¯è¿è¡Œåœ¨Node.jsç¯å¢ƒä¸­çš„ã€‚</p>
<p>é”™è¯¯ç¤ºä¾‹ï¼ˆVue3å‰ç«¯ä»£ç ä¸­å¼•å…¥Nodeä¸“å±åŒ…ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">&lt;script setup&gt;
<span class="hljs-comment">// é”™è¯¯ï¼šåœ¨Vue3å‰ç«¯ä»£ç ä¸­å¼•å…¥fs-extraï¼ˆNodeä¸“å±åŒ…ï¼‰</span>
<span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">'fs-extra'</span>;
fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">'./test.txt'</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data); <span class="hljs-comment">// æµè§ˆå™¨ä¼šæŠ¥é”™ï¼šfs is not defined</span>
});
&lt;/script&gt;
</code></pre>
<h5 data-id="heading-9">ï¼ˆ3ï¼‰æµè§ˆå™¨ä¸“å±åŒ…ï¼šä»…Vue3/å‰ç«¯å¯ç”¨ï¼ˆNode.jsä¸å¯ç”¨ï¼‰</h5>
<p>è¿™ç±»åŒ…ä¾èµ–æµè§ˆå™¨ç‹¬æœ‰çš„APIï¼ˆæ¯”å¦‚windowå¯¹è±¡ã€documentå¯¹è±¡ã€DOMæ“ä½œã€Canvasç»˜å›¾ã€CSSæ ·å¼æ“ä½œç­‰ï¼‰ï¼ŒNode.jsç¯å¢ƒä¸­æ²¡æœ‰è¿™äº›å¯¹è±¡å’ŒAPIï¼Œå› æ­¤æ— æ³•åœ¨Node.jsä¸­ç›´æ¥è¿è¡Œï¼Œè°ƒç”¨æ—¶ä¼šæŠ¥é”™ï¼ˆæ¯”å¦‚â€œwindow is not definedâ€â€œdocument is not definedâ€ï¼‰ã€‚</p>
<p>å…¸å‹ä¾‹å­ï¼šelement-plusï¼ˆVue3 UIç»„ä»¶åº“ï¼‰ã€vuetifyï¼ˆVue3ç»„ä»¶åº“ï¼‰ã€chart.jsï¼ˆå›¾è¡¨åº“ï¼‰ã€swiperï¼ˆè½®æ’­ç»„ä»¶åº“ï¼‰ã€dom-to-imageï¼ˆDOMè½¬å›¾ç‰‡åº“ï¼‰ã€‚</p>
<p>é”™è¯¯ç¤ºä¾‹ï¼ˆNode.jsä¸­å¼•å…¥æµè§ˆå™¨ä¸“å±åŒ…ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é”™è¯¯ï¼šåœ¨Node.jsä¸­å¼•å…¥element-plusï¼ˆæµè§ˆå™¨ä¸“å±åŒ…ï¼‰</span>
<span class="hljs-keyword">const</span> { <span class="hljs-title class_">ElButton</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'element-plus'</span>);
<span class="hljs-comment">// Node.jsä¼šæŠ¥é”™ï¼šwindow is not defined</span>
</code></pre>
<h5 data-id="heading-10">ï¼ˆ4ï¼‰æ¡†æ¶ä¸“å±ç»‘å®šåŒ…ï¼šä»…å¯¹åº”æ¡†æ¶å¯ç”¨</h5>
<p>è¿™ç±»åŒ…æ˜¯ä¸ºç‰¹å®šå‰ç«¯æ¡†æ¶ï¼ˆå¦‚Vue3ã€Reactï¼‰ä¸“é—¨å°è£…çš„ï¼Œä¾èµ–æ¡†æ¶çš„æ ¸å¿ƒAPIï¼ˆæ¯”å¦‚Vue3çš„ç»„åˆå¼APIã€Reactçš„Hooks APIï¼‰ï¼Œåªèƒ½åœ¨å¯¹åº”æ¡†æ¶çš„é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œåœ¨å…¶ä»–ç¯å¢ƒæˆ–æ¡†æ¶ä¸­æ— æ³•æ­£å¸¸å·¥ä½œã€‚</p>
<p>å…¸å‹ä¾‹å­ï¼š@vueuse/coreï¼ˆVue3ç»„åˆå¼å·¥å…·åº“ï¼‰ã€vue-routerï¼ˆVue3è·¯ç”±åº“ï¼‰ã€piniaï¼ˆVue3çŠ¶æ€ç®¡ç†åº“ï¼‰ã€react-router-domï¼ˆReactè·¯ç”±åº“ï¼‰ã€‚</p>
<h4 data-id="heading-11">2. å¿«é€Ÿåˆ¤æ–­npmåŒ…é€‚é…ç¯å¢ƒçš„3ä¸ªæ–¹æ³•</h4>
<p>å¼€å‘ä¸­é‡åˆ°ä¸€ä¸ªæ–°åŒ…ï¼Œæƒ³å¿«é€ŸçŸ¥é“å®ƒèƒ½åœ¨ä»€ä¹ˆç¯å¢ƒä¸­ä½¿ç”¨ï¼Œåªéœ€è®°ä½3ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li>
<p><strong>çœ‹npmå®˜ç½‘æ–‡æ¡£</strong>ï¼šåŒ…çš„ä»‹ç»é¡µï¼ˆæ¯”å¦‚npmjs.comä¸Šçš„åŒ…è¯¦æƒ…ï¼‰ä¼šæ˜ç¡®æ ‡æ³¨é€‚ç”¨ç¯å¢ƒï¼ˆæ¯”å¦‚â€œBrowser &amp; Node.jsâ€â€œNode.js onlyâ€â€œVue3â€ï¼‰ï¼Œè¿™æ˜¯æœ€å‡†ç¡®çš„æ–¹å¼ã€‚</p>
</li>
<li>
<p><strong>çœ‹ä¾èµ–çš„API</strong>ï¼šæŸ¥çœ‹åŒ…çš„æºç æˆ–æ–‡æ¡£ï¼Œè‹¥ä¾èµ–fsã€pathã€httpç­‰ â†’ ä»…Node.jså¯ç”¨ï¼›è‹¥ä¾èµ–windowã€documentã€DOM â†’ ä»…æµè§ˆå™¨/Vue3å¯ç”¨ï¼›è‹¥ä¸ä¾èµ–ä»»ä½•ä¸“å±API â†’ å…¨ç¯å¢ƒé€šç”¨ã€‚</p>
</li>
<li>
<p><strong>çœ‹åŒ…çš„åˆ†ç±»</strong>ï¼šUIç»„ä»¶åº“ã€å‰ç«¯äº¤äº’å·¥å…· â†’ æµè§ˆå™¨/Vue3ä¸“ç”¨ï¼›æœåŠ¡ç«¯æ¡†æ¶ã€æ–‡ä»¶å¤„ç†å·¥å…· â†’ Node.jsä¸“ç”¨ï¼›é€šç”¨å·¥å…·å‡½æ•° â†’ å…¨ç¯å¢ƒé€šç”¨ã€‚</p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[javaåŸºç¡€-8ï¼šæ·±å…¥äº†è§£synchronizedåº•å±‚æœºåˆ¶å’Œå®Œæ•´ä½¿ç”¨æŒ‡å—ï¼ˆJDK 17+ ä¸“é¡¹ç‰ˆï¼‰]]></title>    <link>https://juejin.cn/post/7603261102794735642</link>    <guid>https://juejin.cn/post/7603261102794735642</guid>    <pubDate>2026-02-06T02:48:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603261102794735642" data-draft-id="7603227363821944858" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="javaåŸºç¡€-8ï¼šæ·±å…¥äº†è§£synchronizedåº•å±‚æœºåˆ¶å’Œå®Œæ•´ä½¿ç”¨æŒ‡å—ï¼ˆJDK 17+ ä¸“é¡¹ç‰ˆï¼‰"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2026-02-06T02:48:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="beata"/> <meta itemprop="url" content="https://juejin.cn/user/1839900247461280"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            javaåŸºç¡€-8ï¼šæ·±å…¥äº†è§£synchronizedåº•å±‚æœºåˆ¶å’Œå®Œæ•´ä½¿ç”¨æŒ‡å—ï¼ˆJDK 17+ ä¸“é¡¹ç‰ˆï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1839900247461280/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    beata
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T02:48:21.000Z" title="Fri Feb 06 2026 02:48:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡åŸºäº <strong>OpenJDK 17+</strong> æ·±åº¦è§£æ <code>synchronized</code> åº•å±‚æœºåˆ¶ï¼Œé‡ç‚¹é˜æ˜<strong>é”å‡çº§è®¾è®¡å“²å­¦</strong>ã€<strong>JDK 17+ å…³é”®å˜æ›´</strong>ã€<strong>æ˜ç¡®ç¦ç”¨åœºæ™¯</strong>ï¼ŒåŠ©ä½ ç²¾å‡†é©¾é©­å¹¶å‘ç¼–ç¨‹ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€å¼€ç¯‡ï¼šä¸ºä½•åœ¨ JDK 17+ ä»éœ€ç²¾é€š synchronizedï¼Ÿ</h2>
<p>å°½ç®¡ç°ä»£å¹¶å‘å·¥å…·æ—¥ç›Šä¸°å¯Œï¼Œ<code>synchronized</code> ä»æ˜¯ Java å¹¶å‘ä½“ç³»çš„<strong>åŸºçŸ³çº§å­˜åœ¨</strong>ï¼š</p>
<ul>
<li>âœ… <strong>é›¶å¤±è¯¯å®‰å…¨</strong>ï¼šç¼–è¯‘å™¨è‡ªåŠ¨é‡Šæ”¾é”ï¼Œæœç»â€œå¿˜ unlockâ€æ­»é”</li>
<li>âœ… <strong>JVM æ·±åº¦ä¼˜åŒ–</strong>ï¼šé”æ¶ˆé™¤/ç²—åŒ–ç­‰ JIT ä¼˜åŒ–ä»…å¯¹ synchronized ç”Ÿæ•ˆ</li>
<li>âœ… <strong>è¯Šæ–­å‹å¥½</strong>ï¼š<code>jstack</code>/JFR ç›´æ¥è¯†åˆ«é”çŠ¶æ€</li>
<li>âš ï¸ <strong>ä½†éœ€æ¸…é†’è®¤çŸ¥</strong>ï¼šJDK 17+ å·²ç§»é™¤åå‘é”ï¼Œé”å‡çº§è·¯å¾„ç®€åŒ–ï¼›ä¸”å­˜åœ¨æ˜ç¡®ä¸é€‚ç”¨åœºæ™¯</li>
</ul>
<p><strong>æœ¬æ–‡èšç„¦ JDK 17+ çœŸå®ç¯å¢ƒï¼Œæ‹’ç»è¿‡æ—¶çŸ¥è¯†ï¼Œç›´å‡»å®æˆ˜ç—›ç‚¹ã€‚</strong></p>
<hr/>
<h2 data-id="heading-1">äºŒã€åº•å±‚åŸç†ï¼šé”å‡çº§çš„â€œä¸ºä»€ä¹ˆâ€ä¸â€œæ€ä¹ˆåšâ€ï¼ˆJDK 17+ æ ¸å¿ƒï¼‰</h2>
<h3 data-id="heading-2">2.1 ä¸ºä»€ä¹ˆéœ€è¦é”å‡çº§ï¼Ÿâ€”â€” è®¾è®¡å“²å­¦æ·±åº¦è§£æ</h3>
<p><strong>æ ¸å¿ƒé—®é¢˜</strong>ï¼šä¸ºä½•ä¸ç›´æ¥ä½¿ç”¨é‡é‡çº§é”ï¼Ÿä¸ºä½•è¦â€œé€æ­¥å‡çº§â€ï¼Ÿ</p>

































<table><thead><tr><th>é”æ–¹æ¡ˆ</th><th>æ— ç«äº‰å¼€é”€</th><th>ä½ç«äº‰å¼€é”€</th><th>é«˜ç«äº‰å¼€é”€</th><th>CPU/OS èµ„æºæ¶ˆè€—</th></tr></thead><tbody><tr><td><strong>é‡é‡çº§é”</strong></td><td>æé«˜ï¼ˆ~1500nsï¼‰</td><td>é«˜</td><td>ä¸­</td><td>çº¿ç¨‹æŒ‚èµ·/å”¤é†’ï¼ˆä¸Šä¸‹æ–‡åˆ‡æ¢ï¼‰</td></tr><tr><td><strong>è½»é‡çº§é”</strong></td><td>ä½ï¼ˆ~50nsï¼‰</td><td>ä¸­</td><td>æé«˜ï¼ˆè‡ªæ—‹ç©ºè½¬ï¼‰</td><td>CPU æŒç»­å ç”¨</td></tr><tr><td><strong>æ— é”</strong></td><td>0</td><td>0</td><td>ä¸é€‚ç”¨</td><td>æ— </td></tr></tbody></table>
<p><strong>é”å‡çº§çš„æœ¬è´¨æ˜¯â€œåŠ¨æ€æˆæœ¬æœ€ä¼˜ç­–ç•¥â€</strong>ï¼š</p>
<ol>
<li><strong>é¿å…â€œæ€é¸¡ç”¨ç‰›åˆ€â€</strong><br/>
æ— ç«äº‰åœºæ™¯ä¸‹ï¼Œé‡é‡çº§é”çš„ç³»ç»Ÿè°ƒç”¨ã€çº¿ç¨‹çŠ¶æ€åˆ‡æ¢å¼€é”€è¿œè¶…ä¸šåŠ¡é€»è¾‘æœ¬èº«ã€‚è½»é‡çº§é”é€šè¿‡ CAS + æ ˆå¸§å­˜å‚¨ï¼Œå°†å¼€é”€é™è‡³çº³ç§’çº§ã€‚</li>
<li><strong>é˜²æ­¢â€œç¡¬æ‰›è€—èµ„æºâ€</strong><br/>
é«˜ç«äº‰æ—¶è‹¥åšæŒè‡ªæ—‹ï¼ˆè½»é‡çº§é”ï¼‰ï¼ŒCPU ä¼šæŒç»­ç©ºè½¬ï¼ˆ100% å ç”¨ï¼‰ï¼Œå¯¼è‡´ç³»ç»Ÿååå´©å¡Œã€‚å‡çº§é‡é‡çº§é”è®©å‡º CPUï¼Œä¿éšœç³»ç»Ÿæ•´ä½“ç¨³å®šæ€§ã€‚</li>
<li><strong>è‡ªé€‚åº”æ™ºèƒ½å†³ç­–</strong><br/>
JVM é€šè¿‡<strong>å†å²ç«äº‰æ•°æ®</strong>åŠ¨æ€è°ƒæ•´ï¼š
<ul>
<li>è‡ªæ—‹æ¬¡æ•°ï¼ˆ<code>-XX:PreBlockSpin</code>ï¼‰</li>
<li>å‡çº§é˜ˆå€¼ï¼ˆå¦‚è¿ç»­å¤±è´¥æ¬¡æ•°ï¼‰<br/>
<em>å®ç°â€œä½ç«äº‰æ—¶è½»é‡é«˜æ•ˆï¼Œé«˜ç«äº‰æ—¶ç¨³ä½å¤§å±€â€</em></li>
</ul>
</li>
</ol>
<blockquote>
<p>ğŸ’¡ <strong>å…³é”®æ´è§</strong>ï¼šé”å‡çº§ä¸æ˜¯â€œåŠŸèƒ½å †ç Œâ€ï¼Œè€Œæ˜¯ JVM å¯¹ <strong>â€œæ—¶é—´æˆæœ¬â€ vs â€œCPU èµ„æºæˆæœ¬â€</strong> çš„ç²¾å¯†æƒè¡¡ã€‚ç°ä»£åº”ç”¨å¤šä¸ºçŸ­ä¸´ç•ŒåŒºã€ä½ç«äº‰åœºæ™¯ï¼Œè½»é‡çº§é”æˆä¸º JDK 17+ ä¸»åŠ›ã€‚</p>
</blockquote>
<h3 data-id="heading-3">2.2 JDK 17+ é”å‡çº§è·¯å¾„ï¼ˆé‡å¤§å˜æ›´ï¼ï¼‰</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8cf3050665a242429eeee745c0e63ac7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYmVhdGE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770950901&amp;x-signature=VXWHSVUSJkxvMppfmH82D%2FHqmz8%3D" alt="synchronized-lock.png" loading="lazy"/></p>
<h4 data-id="heading-4">ğŸ”‘ JDK 17+ å…³é”®å˜æ›´ï¼ˆJEP 420ï¼‰</h4>





























<table><thead><tr><th>ç‰¹æ€§</th><th>JDK â‰¤14</th><th>JDK 15~16</th><th><strong>JDK 17+</strong></th></tr></thead><tbody><tr><td>åå‘é”</td><td>é»˜è®¤å¯ç”¨</td><td>é»˜è®¤ç¦ç”¨ï¼ˆJEP 374ï¼‰</td><td><strong>å½»åº•ç§»é™¤</strong>ï¼ˆJEP 420ï¼‰</td></tr><tr><td>å‡çº§è·¯å¾„</td><td>æ— é”â†’åå‘â†’è½»é‡â†’é‡é‡</td><td>åŒå·¦ï¼ˆä½†åå‘é”ä¸ç”Ÿæ•ˆï¼‰</td><td><strong>æ— é”â†’è½»é‡â†’é‡é‡</strong></td></tr><tr><td>åŸå› </td><td>å•çº¿ç¨‹ä¼˜åŒ–</td><td>æ’¤é”€æˆæœ¬é«˜ï¼Œæ”¶ç›Šä½</td><td>ç°ä»£åº”ç”¨å¤šçº¿ç¨‹ç«äº‰ä¸ºä¸»ï¼Œç»´æŠ¤æˆæœ¬ &gt; æ”¶ç›Š</td></tr></tbody></table>
<blockquote>
<p>ğŸ“Œ <strong>å®è·µæç¤º</strong>ï¼š</p>
<ul>
<li>æ— éœ€å†é…ç½® <code>-XX:-UseBiasedLocking</code>ï¼ˆJDK 17+ è¯¥å‚æ•°å·²å¤±æ•ˆï¼‰</li>
<li>ä»£ç ä¸­é¿å…ä¾èµ–â€œåå‘é”ä¼˜åŒ–â€ï¼Œæ‰€æœ‰åŒæ­¥å‡æŒ‰â€œè½»é‡çº§é”èµ·ç‚¹â€è®¾è®¡</li>
</ul>
</blockquote>
<h3 data-id="heading-5">2.3 åº•å±‚æµè½¬è¯¦è§£ï¼ˆJDK 17+ ç®€åŒ–ç‰ˆï¼‰</h3>
<ol>
<li><strong>è½»é‡çº§é”</strong>
<ul>
<li>çº¿ç¨‹æ ˆåˆ›å»º <code>Lock Record</code></li>
<li>CAS å°†å¯¹è±¡å¤´ Mark Word æ›¿æ¢ä¸ºæŒ‡å‘ Lock Record çš„æŒ‡é’ˆ</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šæ— ç³»ç»Ÿè°ƒç”¨ï¼Œå¤±è´¥è‡ªæ—‹ï¼ˆé¿å…ç«‹å³é˜»å¡ï¼‰</li>
<li><strong>è§¦å‘å‡çº§</strong>ï¼šCAS å¤±è´¥ + è‡ªæ—‹è¶…é™ï¼ˆç”± JVM åŠ¨æ€è®¡ç®—ï¼‰</li>
</ul>
</li>
<li><strong>é‡é‡çº§é”</strong>
<ul>
<li>å¯¹è±¡å¤´æŒ‡å‘ <code>ObjectMonitor</code></li>
<li>ç«äº‰çº¿ç¨‹è¿›å…¥ <code>_EntryList</code> é˜»å¡ï¼ˆOS çº§æŒ‚èµ·ï¼‰</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šé‡Šæ”¾ CPU èµ„æºï¼Œé¿å…ç©ºè½¬</li>
<li><strong>ä»£ä»·</strong>ï¼šçº¿ç¨‹å”¤é†’éœ€ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆ~1000ns+ï¼‰</li>
</ul>
</li>
</ol>
<h3 data-id="heading-6">2.4 JIT ä¼˜åŒ–ï¼ˆJDK 17+ ä¾ç„¶ç”Ÿæ•ˆï¼‰</h3>
<ul>
<li><strong>é”æ¶ˆé™¤</strong>ï¼šé€ƒé€¸åˆ†æç¡®è®¤é”å¯¹è±¡ä¸é€ƒé€¸ â†’ ç§»é™¤åŒæ­¥
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// JIT å¯æ¶ˆé™¤é”ï¼ˆsb ä¸ºå±€éƒ¨å˜é‡ï¼Œæ— é€ƒé€¸ï¼‰</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">concat</span><span class="hljs-params">()</span> {
    <span class="hljs-type">StringBuffer</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>(); <span class="hljs-comment">// å†…éƒ¨ synchronized append</span>
    sb.append(<span class="hljs-string">"a"</span>).append(<span class="hljs-string">"b"</span>);
    <span class="hljs-keyword">return</span> sb.toString();
}
</code></pre>
</li>
<li><strong>é”ç²—åŒ–</strong>ï¼šç´§å‡‘åŒæ­¥å—åˆå¹¶ï¼Œå‡å°‘ monitorenter/exit æ¬¡æ•°</li>
</ul>
<hr/>
<h2 data-id="heading-7">ä¸‰ã€é«˜é¢‘é™·é˜±ä¸é¿å‘æŒ‡å—ï¼ˆJDK 17+ éªŒè¯ï¼‰</h2>
<h3 data-id="heading-8">âš ï¸ é”å¯¹è±¡è‡´å‘½è¯¯åŒºï¼ˆé™„ JDK 17 éªŒè¯ä»£ç ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é™·é˜±1ï¼šé”å­—ç¬¦ä¸²å­—é¢é‡ï¼ˆå­—ç¬¦ä¸²é©»ç•™å¯¼è‡´å…¨å±€é”ï¼‰</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">LOCK</span> <span class="hljs-operator">=</span> <span class="hljs-string">"config"</span>;
<span class="hljs-keyword">synchronized</span>(LOCK) { ... } <span class="hljs-comment">// æ‰€æœ‰æ¨¡å—ä½¿ç”¨"config"å¤„äº’æ–¥ï¼</span>

<span class="hljs-comment">// âŒ é™·é˜±2ï¼šé”è‡ªåŠ¨æ‹†è£…ç®±å¯¹è±¡ï¼ˆé”å¯¹è±¡å˜æ›´ï¼‰</span>
<span class="hljs-type">Integer</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">synchronized</span>(count) {
    count++; <span class="hljs-comment">// count æŒ‡å‘æ–° Integer å¯¹è±¡ï¼åç»­åŒæ­¥å¤±æ•ˆ</span>
}

<span class="hljs-comment">// âœ… JDK 17+ æ¨èå†™æ³•</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>(); <span class="hljs-comment">// final ç¡®ä¿å¼•ç”¨ä¸å˜</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">safeMethod</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">synchronized</span>(lock) {
        <span class="hljs-comment">// ä¸´ç•ŒåŒºé€»è¾‘</span>
    }
}
</code></pre>
<h3 data-id="heading-9">âš ï¸ wait/notify æ ‡å‡†æ¨¡æ¿ï¼ˆé˜²è™šå‡å”¤é†’ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">synchronized</span>(lock) {
    <span class="hljs-keyword">while</span> (!conditionMet) { <span class="hljs-comment">// å¿…é¡»ç”¨ whileï¼</span>
        lock.wait(); <span class="hljs-comment">// é‡Šæ”¾é”ï¼Œè¿›å…¥ WaitSet</span>
    }
    <span class="hljs-comment">// æ‰§è¡Œä¸šåŠ¡</span>
    lock.notifyAll(); <span class="hljs-comment">// ä¼˜å…ˆ notifyAll é¿å…é—æ¼</span>
}
</code></pre>
<h3 data-id="heading-10">âš ï¸ å…¶ä»–é«˜å±é™·é˜±</h3>

























<table><thead><tr><th>é™·é˜±</th><th>é£é™©</th><th>JDK 17+ è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>é™æ€/å®ä¾‹æ–¹æ³•æ··ç”¨</td><td>é”å¯¹è±¡ä¸åŒï¼ˆClass vs thisï¼‰</td><td>æ˜¾å¼æ³¨é‡Šé”èŒƒå›´ï¼Œç»Ÿä¸€è§„èŒƒ</td></tr><tr><td>å­ç±»è¦†ç›–æœªåŠ é”</td><td>çˆ¶ç±»åŒæ­¥é€»è¾‘è¢«ç»•è¿‡</td><td>å­ç±»æ–¹æ³•æ˜¾å¼æ·»åŠ  synchronized</td></tr><tr><td>é”å†…æ‰§è¡Œè€—æ—¶ I/O</td><td>é˜»å¡çº¿ç¨‹æ± ï¼Œååéª¤é™</td><td>æå‰æ ¡éªŒï¼Œé”å¤–æ‰§è¡Œ I/O</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-11">å››ã€ä½•æ—¶ç»å¯¹ä¸èƒ½ä½¿ç”¨ synchronizedï¼Ÿï¼ˆå…³é”®å†³ç­–æ¸…å•ï¼‰</h2>
<h3 data-id="heading-12">ğŸš« æ˜ç¡®ç¦ç”¨åœºæ™¯ï¼ˆé™„æ›¿ä»£æ–¹æ¡ˆï¼‰</h3>



























































<table><thead><tr><th>åœºæ™¯</th><th>ä¸ºä»€ä¹ˆä¸èƒ½ç”¨ synchronized</th><th>æ¨èæ–¹æ¡ˆ</th><th>åŸå› è¯´æ˜</th></tr></thead><tbody><tr><td><strong>éœ€è¦ä¸­æ–­ç­‰å¾…</strong></td><td>wait å¯ä¸­æ–­ï¼Œä½†<strong>é”ç­‰å¾…ä¸å¯ä¸­æ–­</strong></td><td><code>ReentrantLock.lockInterruptibly()</code></td><td>é•¿æ—¶é—´é˜»å¡éœ€å“åº”å–æ¶ˆä¿¡å·</td></tr><tr><td><strong>éœ€è¶…æ—¶è·å–é”</strong></td><td>æ— è¶…æ—¶æœºåˆ¶ï¼Œæ˜“æ­»é”</td><td><code>ReentrantLock.tryLock(timeout)</code></td><td>é¿å…çº¿ç¨‹æ°¸ä¹…æŒ‚èµ·</td></tr><tr><td><strong>éœ€å…¬å¹³é”ç­–ç•¥</strong></td><td>å§‹ç»ˆéå…¬å¹³ï¼Œå¯èƒ½çº¿ç¨‹é¥¥é¥¿</td><td><code>new ReentrantLock(true)</code></td><td>ä¿éšœè¯·æ±‚é¡ºåºï¼ˆå¦‚äº¤æ˜“ç³»ç»Ÿï¼‰</td></tr><tr><td><strong>å¤šæ¡ä»¶å˜é‡åŒæ­¥</strong></td><td>ä»…1ä¸ª wait set</td><td><code>ReentrantLock + å¤š Condition</code></td><td>ç”Ÿäº§è€…-æ¶ˆè´¹è€…ç­‰å¤æ‚æ¨¡å‹</td></tr><tr><td><strong>è¯»å¤šå†™å°‘ä¸”è¯»å†™åˆ†ç¦»</strong></td><td>è¯»å†™äº’æ–¥ï¼Œååç“¶é¢ˆ</td><td><code>ReentrantReadWriteLock</code></td><td>è¯»æ“ä½œå¹¶å‘æå‡ 5-10 å€</td></tr><tr><td><strong>åˆ†å¸ƒå¼ç³»ç»Ÿè·¨ JVM</strong></td><td>ä»…é™å• JVM å†…éƒ¨</td><td>Redisson / ZooKeeper é”</td><td>æœåŠ¡é›†ç¾¤éœ€å…¨å±€åè°ƒ</td></tr><tr><td><strong>é«˜æ€§èƒ½è®¡æ•°å™¨ï¼ˆé«˜ç«äº‰ï¼‰</strong></td><td>é‡é‡çº§é”å¼€é”€å¤§</td><td><code>LongAdder</code> / <code>Striped64</code></td><td>æ— é”åˆ†æ®µç´¯åŠ ï¼Œååæå‡ç™¾å€</td></tr><tr><td><strong>éœ€é”çŠ¶æ€ç›‘æ§åŸ‹ç‚¹</strong></td><td>æ— æ³•è·å–æŒæœ‰è€…/ç­‰å¾…é˜Ÿåˆ—ä¿¡æ¯</td><td><code>ReentrantLock.getQueueLength()</code></td><td>è¿ç»´ç›‘æ§ã€åŠ¨æ€é™çº§éœ€æ±‚</td></tr></tbody></table>
<h3 data-id="heading-13">ğŸ’¡ å†³ç­–å¿ƒæ³•</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¼ªä»£ç ï¼šé€‰æ‹©é€»è¾‘</span>
<span class="hljs-keyword">if</span> (éœ€è¦ä¸­æ–­ || éœ€è¦è¶…æ—¶ || éœ€è¦å…¬å¹³é” || å¤šæ¡ä»¶å˜é‡) {
    é€‰ ReentrantLock;
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (è¯» &gt;&gt; å†™ &amp;&amp; è¯»å†™å¯åˆ†ç¦») {
    é€‰ ReadWriteLock;
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (å•å˜é‡åŸå­æ“ä½œ) {
    é€‰ AtomicXXX / LongAdder;
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (è·¨ JVM) {
    é€‰åˆ†å¸ƒå¼é”;
} <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// âœ… 90% åœºæ™¯ï¼šé€‰ synchronizedï¼ˆå®‰å…¨ã€ç®€æ´ã€JVM ä¼˜åŒ–å‹å¥½ï¼‰</span>
    <span class="hljs-keyword">synchronized</span>(lock) { ... }
}
</code></pre>
<hr/>
<h2 data-id="heading-14">äº”ã€synchronized vs å…¶ä»–æœºåˆ¶ï¼ˆJDK 17+ å¯¹æ¯”ï¼‰</h2>









































<table><thead><tr><th><strong>ç»´åº¦</strong></th><th><strong>synchronized</strong></th><th><strong>ReentrantLock</strong></th><th><strong>Atomic/LongAdder</strong></th></tr></thead><tbody><tr><td><strong>è‡ªåŠ¨é‡Šæ”¾</strong></td><td>âœ…ï¼ˆç¼–è¯‘å™¨ä¿éšœï¼‰</td><td>âŒï¼ˆéœ€ finally unlockï¼‰</td><td>N/A</td></tr><tr><td><strong>JVM ä¼˜åŒ–</strong></td><td>âœ…ï¼ˆé”æ¶ˆé™¤/ç²—åŒ–ï¼‰</td><td>âŒ</td><td>âœ…ï¼ˆ intrinsic ä¼˜åŒ–ï¼‰</td></tr><tr><td><strong>è¯Šæ–­å‹å¥½åº¦</strong></td><td>âœ…ï¼ˆjstack/JFR ç›´æ¥å¯è§ï¼‰</td><td>âš ï¸ï¼ˆéœ€ä»£ç åŸ‹ç‚¹ï¼‰</td><td>âœ…</td></tr><tr><td><strong>é«˜ç«äº‰åå</strong></td><td>ä¸­ï¼ˆé‡é‡çº§é”å¼€é”€ï¼‰</td><td>ä¸­ï¼ˆå¯è°ƒä¼˜ï¼‰</td><td><strong>æé«˜</strong>ï¼ˆLongAdder åˆ†æ®µï¼‰</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>é€šç”¨åŒæ­¥ã€ä½ç«äº‰ã€ä»£ç ç®€æ´ä¼˜å…ˆ</td><td>éœ€é«˜çº§ç‰¹æ€§ã€é«˜ç«äº‰ç²¾ç»†æ§åˆ¶</td><td>è®¡æ•°å™¨ã€çŠ¶æ€æ ‡å¿—</td></tr></tbody></table>
<blockquote>
<p>ğŸ“Š <strong>JDK 17+ æ€§èƒ½å®æµ‹å‚è€ƒ</strong>ï¼ˆæ— ç«äº‰åœºæ™¯ï¼‰ï¼š<br/>
<code>synchronized</code> â‰ˆ <code>ReentrantLock</code>ï¼ˆçº³ç§’çº§å·®å¼‚ï¼‰<br/>
<strong>ç»“è®º</strong>ï¼šæ— ç‰¹æ®Šéœ€æ±‚æ—¶ï¼Œsynchronized å› â€œé›¶å¤±è¯¯å®‰å…¨â€æˆä¸ºé¦–é€‰ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-15">å…­ã€JDK 17+ æœ€ä½³å®è·µä¸è¯Šæ–­</h2>
<h3 data-id="heading-16">âœ… é»„é‡‘å‡†åˆ™</h3>
<ol>
<li><strong>é”å¯¹è±¡</strong>ï¼š<code>private final Object lock = new Object();</code>ï¼ˆæœç»é final å¼•ç”¨ï¼‰</li>
<li><strong>é”ç²’åº¦</strong>ï¼šä»…åŒ…è£¹ä¸´ç•ŒåŒºï¼ŒI/Oã€RPCã€è€—æ—¶è®¡ç®—ç§»è‡³é”å¤–</li>
<li><strong>ä¼˜å…ˆå·¥å…·ç±»</strong>ï¼š<code>ConcurrentHashMap</code>ã€<code>CopyOnWriteArrayList</code>ã€<code>LongAdder</code></li>
<li><strong>wait æ¨¡æ¿</strong>ï¼š<code>while</code> åˆ¤æ–­ + <code>notifyAll</code></li>
</ol>
<h3 data-id="heading-17">ğŸ” JDK 17+ è¯Šæ–­åˆ©å™¨</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ­»é”æ£€æµ‹ï¼ˆç›´æ¥å®šä½ï¼‰</span>
jstack &lt;pid&gt; | grep -A 20 <span class="hljs-string">"deadlock"</span>

<span class="hljs-comment"># 2. JFRï¼ˆJava Flight Recorderï¼‰ç›‘æ§é”ç«äº‰</span>
java -XX:+FlightRecorder -XX:StartFlightRecording=duration=60s,filename=recording.jfr MyApp
<span class="hljs-comment"># ä½¿ç”¨ JDK Mission Control åˆ†æ "Java Monitor Blocked" äº‹ä»¶</span>

<span class="hljs-comment"># 3. é”ç²—åŒ–æ•ˆæœéªŒè¯ï¼ˆéœ€å¼€å¯ï¼‰</span>
-XX:+PrintEliminateLocks  <span class="hljs-comment"># è§‚å¯Ÿé”æ¶ˆé™¤æ—¥å¿—</span>
</code></pre>
<h3 data-id="heading-18">ğŸŒ JDK 17+ ç‰ˆæœ¬æ³¨æ„äº‹é¡¹</h3>

























<table><thead><tr><th>é¡¹ç›®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>åå‘é”</td><td><strong>å·²å½»åº•ç§»é™¤</strong>ï¼Œæ— éœ€å…³æ³¨ç›¸å…³é…ç½®ä¸è¡Œä¸º</td></tr><tr><td>é”å‡çº§èµ·ç‚¹</td><td>æ‰€æœ‰åŒæ­¥æ“ä½œèµ·ç‚¹ä¸º<strong>è½»é‡çº§é”</strong></td></tr><tr><td>æ¨è JVM å‚æ•°</td><td>æ— éœ€ç‰¹æ®Šé…ç½®ï¼›é«˜å¹¶å‘æœåŠ¡å¯å¾®è°ƒ <code>-XX:PreBlockSpin</code>ï¼ˆé»˜è®¤è‡ªé€‚åº”ï¼‰</td></tr><tr><td>é€ƒé€¸åˆ†æ</td><td>ä¾ç„¶ç”Ÿæ•ˆï¼Œåˆç†ç¼–å†™ä»£ç å¯è§¦å‘é”æ¶ˆé™¤ï¼ˆå±€éƒ¨å¯¹è±¡åŒæ­¥ï¼‰</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-19">ä¸ƒã€æ€»ç»“ï¼šJDK 17+ ä¸‹çš„ synchronized ä½¿ç”¨å¿ƒæ³•</h2>
<h3 data-id="heading-20">ğŸŒŸ ä¸‰å¤§æ ¸å¿ƒè®¤çŸ¥</h3>
<ol>
<li>
<p><strong>é”å‡çº§æ˜¯â€œæˆæœ¬åŠ¨æ€å¹³è¡¡æœ¯â€</strong><br/>
è½»é‡çº§é”ï¼ˆä½å¼€é”€ï¼‰ä¸é‡é‡çº§é”ï¼ˆä¿ç³»ç»Ÿï¼‰çš„æ™ºèƒ½åˆ‡æ¢ï¼Œæ˜¯ JVM å¯¹å¹¶å‘åœºæ™¯çš„æ·±åº¦ç†è§£ã€‚<strong>æ— éœ€æ‰‹åŠ¨å¹²é¢„ï¼Œä¿¡ä»» JVM è‡ªé€‚åº”æœºåˆ¶</strong>ã€‚</p>
</li>
<li>
<p><strong>synchronized æ˜¯â€œå®‰å…¨ç½‘â€ï¼Œéâ€œä¸‡èƒ½é”¤â€</strong></p>
<ul>
<li>âœ… ç”¨å®ƒï¼šé€šç”¨åŒæ­¥ã€ä»£ç ç®€æ´æ€§ä¼˜å…ˆã€é¿å…äººä¸ºå¤±è¯¯</li>
<li>âŒ ä¸ç”¨å®ƒï¼šéœ€ä¸­æ–­/è¶…æ—¶/å…¬å¹³é”/åˆ†å¸ƒå¼/è¯»å†™åˆ†ç¦»ç­‰æ˜ç¡®åœºæ™¯ï¼ˆè§ç¬¬å››ç« æ¸…å•ï¼‰</li>
</ul>
</li>
<li>
<p><strong>JDK 17+ æ˜¯æ–°èµ·ç‚¹</strong><br/>
åå‘é”ç§»é™¤æ ‡å¿—ç€ JVM å‘â€œç°ä»£å¤šçº¿ç¨‹åº”ç”¨â€å…¨é¢å¯¹é½ã€‚<strong>èšç„¦è½»é‡çº§é”ä¼˜åŒ–é€»è¾‘ï¼Œæ‘’å¼ƒè¿‡æ—¶è®¤çŸ¥</strong>ã€‚</p>
</li>
</ol>
<h3 data-id="heading-21">ğŸ’¬ æœ€åå¿ å‘Š</h3>
<blockquote>
<p>â€œä¸è¦å› ä¸º ReentrantLock æœ‰æ›´å¤šåŠŸèƒ½å°±æ»¥ç”¨å®ƒã€‚<br/>
synchronized çš„è‡ªåŠ¨é‡Šæ”¾ç‰¹æ€§ï¼Œæ˜¯æ— æ•°ç”Ÿäº§äº‹æ•…çš„â€˜éšå½¢å®ˆæŠ¤è€…â€™ã€‚â€<br/>
â€”â€” æºè‡ªå¤šå¹´çº¿ä¸Šæ•…éšœå¤ç›˜</p>
</blockquote>
<p><strong>æ­£ç¡®å§¿åŠ¿</strong>ï¼š<br/>
1ï¸âƒ£ ä¼˜å…ˆç”¨ synchronized ä¿è¯é€»è¾‘æ­£ç¡®<br/>
2ï¸âƒ£ é€šè¿‡ JFR/Arthas <strong>å®æµ‹</strong>é”ç«äº‰çƒ­ç‚¹<br/>
3ï¸âƒ£ ä»…åœ¨<strong>æ˜ç¡®éœ€æ±‚+æ•°æ®æ”¯æ’‘</strong>ä¸‹æ›¿æ¢ä¸ºé«˜çº§é”</p>
<blockquote>
<p>æœ¬æ–‡æ‰€æœ‰ç»“è®ºå‡åŸºäº OpenJDK 17.0.10+ éªŒè¯ã€‚<br/>
ä»£ç æœ‰è¾¹ç•Œï¼Œè®¤çŸ¥éœ€è¿­ä»£ â€”â€” æ„¿ä½ çš„å¹¶å‘ä¹‹è·¯ï¼Œç¨³å¦‚ Monitorï¼Œå¿«å¦‚ CASã€‚</p>
</blockquote>
<blockquote>
<p><strong>ä½œè€…</strong>ï¼šæ¶æ„å¸ˆBeata<br/>
<strong>æ—¥æœŸ</strong>ï¼š2026å¹´2æœˆ5æ—¥
<strong>å£°æ˜</strong>ï¼šæœ¬æ–‡åŸºäºç”Ÿäº§å®è·µä¸æºç åˆ†æï¼Œå¦‚æœ‰ç–æ¼ï¼Œæ¬¢è¿æŒ‡æ­£ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚<br/>
<strong>äº’åŠ¨</strong>ï¼šä½ åœ¨ä½¿ç”¨synchronizedæ—¶é‡åˆ°è¿‡å“ªäº›å‘ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[APISIX ç½‘å…³å¦‚ä½•å®ç°éªŒç­¾]]></title>    <link>https://juejin.cn/post/7603267434502340623</link>    <guid>https://juejin.cn/post/7603267434502340623</guid>    <pubDate>2026-02-06T02:53:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603267434502340623" data-draft-id="7603238967291379764" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="APISIX ç½‘å…³å¦‚ä½•å®ç°éªŒç­¾"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-02-06T02:53:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æµ·å°”æ™ºæ…§å®¶æŠ€æœ¯å¹³å°"/> <meta itemprop="url" content="https://juejin.cn/user/3848721122725016"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            APISIX ç½‘å…³å¦‚ä½•å®ç°éªŒç­¾
            <!----> <!----></h1> <div class="container team-follow" data-v-d326b38e="" data-v-61fb5e44=""><div class="left" data-v-d326b38e=""><a href="/team/7156434854350389283/posts" data-v-d326b38e=""><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a4176c1a2e0b4e1b986f105126840cc9~tplv-k3u1fbpfcp-watermark.image?" class="icon" data-v-d326b38e=""/></a> <div class="content" data-v-d326b38e=""><div style="display: flex" data-v-d326b38e=""><a href="/team/7156434854350389283/posts" data-v-d326b38e=""><p class="title-line" data-v-d326b38e=""><span title="ä¸‰ç¿¼é¸Ÿæ•°å­—åŒ–æŠ€æœ¯å›¢é˜Ÿ" class="title" data-v-d326b38e="">ä¸‰ç¿¼é¸Ÿæ•°å­—åŒ–æŠ€æœ¯å›¢é˜Ÿ</span> <img src="//lf-web-assets.juejin.cn/obj/juejin-web/xitu_juejin_web/255e400027b783cbad76dc41527e7695.svg" alt="team icon" class="team-icon" data-v-d326b38e=""/></p></a></div> <div class="meta-box team" data-v-d326b38e="" data-v-61fb5e44=""><time datetime="2026-02-06T02:53:19.000Z" title="Fri Feb 06 2026 02:53:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-d326b38e="" data-v-61fb5e44="">
                2026-02-06
              </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-d326b38e="" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/></svg> <span class="views-count" style="display:none;" data-v-d326b38e="" data-v-61fb5e44="">
                0
              </span> <span class="read-time" data-v-d326b38e="" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-d326b38e="" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-d326b38e="" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-d326b38e="" data-v-61fb5e44=""/></svg>
                é˜…è¯»10åˆ†é’Ÿ
              </span> <!----> <!----></div></div></div> <button class="jj-follow-button follow-btn" style="display:none;" data-v-b60b2868="" data-v-d326b38e=""><span data-v-b60b2868="" data-v-d326b38e=""><i class="byte-icon byte-icon--plus" data-v-d326b38e=""><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 48 48"><path fill="none" d="M0 0h48v48H0z"/><path d="M24.7 4c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8V22h16.7c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8v1.4c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1H26v16.7c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1h-1.4c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8V26H5.3c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8v-1.4c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1H22V5.3c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1h1.4z"/></svg></i>
        å…³æ³¨
      </span></button></div> <div class="team-user block-hidden" data-v-61fb5e44=""><div class="avatar jj-avatar avatar" data-v-03256cc6="" data-v-61fb5e44=""><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="avatar" class="lazy avatar-img" data-v-5244ef91="" data-v-03256cc6=""/> </div> <!----> <span class="position ellipsis" data-v-61fb5e44="">
              @æµ·å°”ä¼˜å®¶æ™ºèƒ½ç§‘æŠ€ï¼ˆåŒ—äº¬ï¼‰æœ‰é™å…¬å¸
            </span></div> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ APISIXï¼ˆäº‘åŸç”Ÿ API ç½‘å…³ï¼‰ä¸­å®ç°<strong>æ¥å£éªŒç­¾é€»è¾‘</strong>ï¼Œæ ¸å¿ƒæ˜¯é€šè¿‡å…¶<strong>æ’ä»¶æœºåˆ¶</strong>å®Œæˆ â€”â€” åˆ©ç”¨ APISIX å†…ç½®çš„éªŒç­¾ç›¸å…³æ’ä»¶ï¼ˆå¦‚<code>hmac-auth</code>ã€<code>jwt-auth</code>ï¼‰æˆ–è‡ªå®šä¹‰ Lua æ’ä»¶ï¼Œæ‹¦æˆªè¯·æ±‚å¹¶æ‰§è¡Œç­¾åéªŒè¯æµç¨‹ï¼Œç¡®ä¿è¯·æ±‚æ¥æºåˆæ³•ã€æ•°æ®æœªè¢«ç¯¡æ”¹ã€‚</p>
<h2 data-id="heading-0">1. APISIX éªŒç­¾çš„æ ¸å¿ƒåŸç†</h2>
<p>APISIX çš„è¯·æ±‚å¤„ç†æµç¨‹ä¸ºï¼š<code>è¯·æ±‚è¿›å…¥ â†’ æ’ä»¶æ‰§è¡Œï¼ˆé¡ºåºå¯é…ç½®ï¼‰ â†’ è½¬å‘è‡³ä¸Šæ¸¸æœåŠ¡</code>ã€‚éªŒç­¾é€»è¾‘æœ¬è´¨æ˜¯åœ¨<strong>æ’ä»¶æ‰§è¡Œé˜¶æ®µ</strong>ï¼Œé€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°ï¼š</p>
<ol>
<li><strong>æå–</strong> <strong>ç­¾å</strong> <strong>ç›¸å…³å‚æ•°</strong>ï¼šä»è¯·æ±‚å¤´ï¼ˆå¦‚<code>X-Signature</code>ã€<code>Authorization</code>ï¼‰ã€è¯·æ±‚å‚æ•°æˆ– Body ä¸­ï¼Œæå–ç­¾åå€¼ã€æ—¶é—´æˆ³ã€éšæœºä¸²ã€AccessKey ç­‰éªŒç­¾å¿…éœ€ä¿¡æ¯ã€‚</li>
<li><strong>ç”Ÿæˆå¾…éªŒç­¾ä¸²</strong>ï¼šæŒ‰ç…§ä¸šåŠ¡çº¦å®šçš„è§„åˆ™ï¼ˆå¦‚ â€œå‚æ•°æŒ‰ ASCII æ’åº + æ‹¼æ¥æ—¶é—´æˆ³ + å¯†é’¥â€ï¼‰ï¼Œé‡ç»„è¯·æ±‚ä¸­çš„å…³é”®æ•°æ®ï¼ˆå¦‚è¯·æ±‚å‚æ•°ã€Bodyã€æ—¶é—´æˆ³ï¼‰ï¼Œç”Ÿæˆ â€œå¾…éªŒç­¾å­—ç¬¦ä¸²â€ã€‚</li>
<li><strong>æ‰§è¡Œ</strong> <strong>ç­¾å</strong> <strong>éªŒè¯</strong>ï¼šä½¿ç”¨ä¸å®¢æˆ·ç«¯çº¦å®šçš„ç®—æ³•ï¼ˆå¦‚ HMAC-SHA256ã€RSAï¼‰ï¼Œç»“åˆé¢„è®¾çš„å¯†é’¥ï¼ˆæˆ–å…¬é’¥ï¼‰å¯¹ â€œå¾…éªŒç­¾ä¸²â€ è¿›è¡Œç­¾åï¼Œå¯¹æ¯”ç”Ÿæˆçš„ç­¾åä¸è¯·æ±‚ä¸­æå–çš„ç­¾åæ˜¯å¦ä¸€è‡´ã€‚</li>
<li><strong>æ‹¦æˆªæˆ–æ”¾è¡Œ</strong>ï¼šéªŒè¯é€šè¿‡åˆ™ç»§ç»­è½¬å‘è¯·æ±‚è‡³ä¸Šæ¸¸ï¼›éªŒè¯å¤±è´¥ï¼ˆå¦‚ç­¾åä¸åŒ¹é…ã€æ—¶é—´æˆ³è¿‡æœŸï¼‰åˆ™ç›´æ¥è¿”å› 401/403 é”™è¯¯ï¼Œæ‹¦æˆªè¯·æ±‚ã€‚</li>
</ol>
<h2 data-id="heading-1">2. APISIX å®ç°éªŒç­¾çš„ 3 ç§å¸¸è§æ–¹å¼</h2>
<p>æ ¹æ®ä¸šåŠ¡åœºæ™¯ï¼ˆå¦‚æ˜¯å¦éœ€è¦è‡ªå®šä¹‰éªŒç­¾è§„åˆ™ã€ç­¾åç®—æ³•ç±»å‹ï¼‰ï¼ŒAPISIX æä¾›äº† â€œå†…ç½®æ’ä»¶â€â€œè‡ªå®šä¹‰ Lua æ’ä»¶â€â€œé›†æˆå¤–éƒ¨æœåŠ¡â€ ä¸‰ç§å®ç°æ–¹å¼ï¼Œä»¥ä¸‹è¯¦ç»†è¯´æ˜ï¼š</p>
<h3 data-id="heading-2">æ–¹å¼ 1ï¼šä½¿ç”¨ APISIX å†…ç½®éªŒç­¾æ’ä»¶ï¼ˆæ¨èï¼Œæ— éœ€ç¼–ç ï¼‰</h3>
<p>APISIX æä¾›äº†å¤šä¸ªæˆç†Ÿçš„å†…ç½®æ’ä»¶ï¼Œè¦†ç›–ä¸»æµéªŒç­¾åœºæ™¯ï¼ˆå¦‚ HMAC å¯¹ç§°åŠ å¯†ã€JWT ä»¤ç‰Œã€Basic Authï¼‰ï¼Œæ— éœ€ç¼–å†™ä»£ç ï¼Œä»…éœ€é€šè¿‡é…ç½®å³å¯å¯ç”¨ã€‚</p>
<h4 data-id="heading-3">1.1 HMAC å¯¹ç§°åŠ å¯†éªŒç­¾ï¼ˆ<code>hmac-auth</code>æ’ä»¶ï¼‰</h4>
<p>é€‚ç”¨äº<strong>å®¢æˆ·ç«¯ä¸</strong> <strong>ç½‘å…³</strong> <strong>å…±äº«</strong> <strong>å¯†é’¥</strong>çš„åœºæ™¯ï¼ˆå¦‚å†…éƒ¨æœåŠ¡é—´è°ƒç”¨ï¼‰ï¼ŒåŸºäº HMAC ç®—æ³•ï¼ˆå¦‚ HMAC-SHA256ï¼‰éªŒè¯ç­¾åï¼Œæ”¯æŒé˜²é‡æ”¾ï¼ˆé€šè¿‡æ—¶é—´æˆ³ + nonceï¼‰ã€‚</p>
<p>æ ¸å¿ƒé…ç½®æ­¥éª¤ï¼š</p>
<p><strong>ï¼ˆ1ï¼‰åˆ›å»º Consumerï¼ˆæ¶ˆè´¹è€…ï¼Œå³å®¢æˆ·ç«¯èº«ä»½ï¼‰</strong> ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯é…ç½®å”¯ä¸€çš„<code>access_key</code>ï¼ˆæ ‡è¯†å®¢æˆ·ç«¯ï¼‰å’Œ<code>secret_key</code>ï¼ˆå¯¹ç§°å¯†é’¥ï¼Œéœ€å®¢æˆ·ç«¯ä¸ç½‘å…³ä¸€è‡´ï¼‰ï¼Œå¹¶ç»‘å®š<code>hmac-auth</code>æ’ä»¶ã€‚ç¤ºä¾‹ï¼ˆé€šè¿‡ APISIX Admin API é…ç½®ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºConsumerå¹¶å¯ç”¨hmac-authæ’ä»¶curl http://apisix-admin:9180/apisix/admin/consumers -X PUT -d '</span>
{
  <span class="hljs-string">"username"</span>: <span class="hljs-string">"client_001"</span>,  <span class="hljs-comment"># Consumeråç§°ï¼ˆè‡ªå®šä¹‰ï¼‰</span>
  <span class="hljs-string">"plugins"</span>: {
    <span class="hljs-string">"hmac-auth"</span>: {
      <span class="hljs-string">"access_key"</span>: <span class="hljs-string">"AK123456"</span>,  <span class="hljs-comment"># å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†ï¼ˆå®¢æˆ·ç«¯éœ€æºå¸¦ï¼‰</span>
      <span class="hljs-string">"secret_key"</span>: <span class="hljs-string">"SKabcdef123456"</span>,  <span class="hljs-comment"># å¯¹ç§°å¯†é’¥ï¼ˆå®¢æˆ·ç«¯ä¸ç½‘å…³å…±äº«ï¼Œéœ€ä¿å¯†ï¼‰</span>
      <span class="hljs-string">"sign_header"</span>: <span class="hljs-string">"X-HMAC-Signature"</span>,  <span class="hljs-comment"># è¯·æ±‚å¤´ä¸­ç­¾åçš„å­—æ®µå</span>
      <span class="hljs-string">"clock_skew"</span>: 300,  <span class="hljs-comment"># å…è®¸çš„æ—¶é—´æˆ³åå·®ï¼ˆç§’ï¼Œé˜²é‡æ”¾ï¼‰</span>
      <span class="hljs-string">"nonce_header"</span>: <span class="hljs-string">"X-HMAC-Nonce"</span>,  <span class="hljs-comment"># è¯·æ±‚å¤´ä¸­éšæœºä¸²çš„å­—æ®µå</span>
      <span class="hljs-string">"timestamp_header"</span>: <span class="hljs-string">"X-HMAC-Timestamp"</span>  <span class="hljs-comment"># è¯·æ±‚å¤´ä¸­æ—¶é—´æˆ³çš„å­—æ®µå</span>
    }
  }
}<span class="hljs-string">'
</span></code></pre>
<p><strong>ï¼ˆ2ï¼‰ä¸º Route/</strong> <strong>Service</strong> <strong>ç»‘å®š</strong> <strong><code>hmac-auth</code></strong> <strong>æ’ä»¶</strong>å°†æ’ä»¶åº”ç”¨åˆ°éœ€è¦éªŒç­¾çš„è·¯ç”±ï¼ˆRouteï¼‰æˆ–æœåŠ¡ï¼ˆServiceï¼‰ï¼Œç¡®ä¿è¯¥è·¯ç”±çš„æ‰€æœ‰è¯·æ±‚éƒ½å¿…é¡»é€šè¿‡ HMAC éªŒç­¾ã€‚ç¤ºä¾‹ï¼ˆä¸º Route é…ç½®ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸ºRoute 1ç»‘å®šhmac-authæ’ä»¶curl http://apisix-admin:9180/apisix/admin/routes/1 -X PUT -d '</span>
{
  <span class="hljs-string">"uri"</span>: <span class="hljs-string">"/api/v1/order/*"</span>,  <span class="hljs-comment"># éœ€éªŒç­¾çš„æ¥å£è·¯å¾„</span>
  <span class="hljs-string">"upstream"</span>: {
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"roundrobin"</span>,
    <span class="hljs-string">"nodes"</span>: {<span class="hljs-string">"192.168.1.100:8080"</span>: 1}  <span class="hljs-comment"># ä¸Šæ¸¸æœåŠ¡åœ°å€</span>
  },
  <span class="hljs-string">"plugins"</span>: {
    <span class="hljs-string">"hmac-auth"</span>: {}  <span class="hljs-comment"># å¯ç”¨æ’ä»¶ï¼ˆæ— éœ€é¢å¤–é…ç½®ï¼Œå¤ç”¨Consumerçš„æ’ä»¶å‚æ•°ï¼‰</span>
  }
}<span class="hljs-string">'
</span></code></pre>
<p><strong>ï¼ˆ3ï¼‰å®¢æˆ·ç«¯è¯·æ±‚ç¤ºä¾‹</strong></p>
<p>Â Â å®¢æˆ·ç«¯éœ€æŒ‰ä»¥ä¸‹è§„åˆ™ç”Ÿæˆç­¾åå¹¶æºå¸¦è¯·æ±‚å¤´ï¼š</p>
<ul>
<li>ç”Ÿæˆ<code>nonce</code>ï¼ˆéšæœºä¸²ï¼Œå¦‚<code>abc123</code>ï¼‰ã€<code>timestamp</code>ï¼ˆå½“å‰æ—¶é—´æˆ³ï¼Œå¦‚<code>1690000000</code>ï¼‰ï¼›</li>
<li>å¾…éªŒç­¾ä¸²è§„åˆ™ï¼š<code>method + uri + timestamp + nonce + body</code>ï¼ˆå…·ä½“è§„åˆ™å¯é€šè¿‡æ’ä»¶å‚æ•°<code>sign_params</code>è‡ªå®šä¹‰ï¼‰ï¼›</li>
<li>ä½¿ç”¨<code>secret_key</code>å¯¹ â€œå¾…éªŒç­¾ä¸²â€ è¿›è¡Œ HMAC-SHA256 åŠ å¯†ï¼Œå¾—åˆ°ç­¾åå€¼ï¼›</li>
<li>è¯·æ±‚å¤´æºå¸¦ï¼š<code>X-HMAC-AccessKey: AK123456</code>ã€<code>X-HMAC-Timestamp: 1690000000</code>ã€<code>X-HMAC-Nonce: abc123</code>ã€<code>X-HMAC-Signature: ç­¾åå€¼</code>ã€‚</li>
</ul>
<h4 data-id="heading-4">1.2 JWT ä»¤ç‰ŒéªŒç­¾ï¼ˆ<code>jwt-auth</code>æ’ä»¶ï¼‰</h4>
<p>é€‚ç”¨äº<strong>åˆ†å¸ƒå¼</strong> <strong>ç³»ç»Ÿã€ç”¨æˆ·è®¤è¯</strong>åœºæ™¯ï¼Œå®¢æˆ·ç«¯å…ˆé€šè¿‡ç™»å½•æ¥å£è·å– JWT ä»¤ç‰Œï¼Œåç»­è¯·æ±‚æºå¸¦ä»¤ç‰Œï¼Œç½‘å…³é€šè¿‡å…¬é’¥éªŒè¯ä»¤ç‰Œæœ‰æ•ˆæ€§ï¼ˆæ”¯æŒå¯¹ç§° / éå¯¹ç§°åŠ å¯†ï¼‰ã€‚</p>
<p>æ ¸å¿ƒé…ç½®æ­¥éª¤ï¼š</p>
<p><strong>ï¼ˆ1ï¼‰åˆ›å»º Consumer å¹¶é…ç½®</strong> <strong>JWT</strong> <strong>å‚æ•°</strong>ç¤ºä¾‹ï¼ˆå¯¹ç§°åŠ å¯†ï¼Œä½¿ç”¨<code>secret</code>éªŒè¯ï¼›éå¯¹ç§°åŠ å¯†éœ€é…ç½®<code>public_key</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">curl http:<span class="hljs-comment">//apisix-admin:9180/apisix/admin/consumers -X PUT -d '</span>
{
  <span class="hljs-string">"username"</span>: <span class="hljs-string">"user_001"</span>,
  <span class="hljs-string">"plugins"</span>: {
    <span class="hljs-string">"jwt-auth"</span>: {
      <span class="hljs-string">"secret"</span>: <span class="hljs-string">"jwt_secret_123"</span>,  <span class="hljs-meta"># å¯¹ç§°å¯†é’¥ï¼ˆéå¯¹ç§°åŠ å¯†ç”¨public_keyæ›¿ä»£ï¼‰</span>
      <span class="hljs-string">"algorithm"</span>: <span class="hljs-string">"HS256"</span>,  <span class="hljs-meta"># ç®—æ³•ï¼ˆHS256=å¯¹ç§°ï¼ŒRS256=éå¯¹ç§°ï¼‰</span>
      <span class="hljs-string">"exp"</span>: <span class="hljs-number">3600</span>,  <span class="hljs-meta"># ä»¤ç‰Œè¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰</span>
      <span class="hljs-string">"token_header"</span>: <span class="hljs-string">"Authorization"</span>,  <span class="hljs-meta"># æºå¸¦ä»¤ç‰Œçš„è¯·æ±‚å¤´ï¼ˆå¦‚Bearer Tokenï¼‰</span>
      <span class="hljs-string">"token_prefix"</span>: <span class="hljs-string">"Bearer "</span>  <span class="hljs-meta"># ä»¤ç‰Œå‰ç¼€ï¼ˆå¦‚"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."ï¼‰</span>
    }
  }
}<span class="hljs-string">'
</span></code></pre>
<p><strong>ï¼ˆ2ï¼‰ä¸º Route ç»‘å®š</strong> <strong><code>jwt-auth</code></strong> <strong>æ’ä»¶</strong>ç¡®ä¿è¯·æ±‚éœ€æºå¸¦æœ‰æ•ˆ JWT ä»¤ç‰Œæ‰èƒ½è®¿é—®ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">curl http://apisix-admin:<span class="hljs-number">9180</span>/apisix/admin/routes/<span class="hljs-number">2</span> -X PUT -d <span class="hljs-comment">'</span>
{
  <span class="hljs-string">"uri"</span>: <span class="hljs-string">"/api/v1/user/*"</span>,
  <span class="hljs-string">"upstream"</span>: {<span class="hljs-string">"nodes"</span>: {<span class="hljs-string">"192.168.1.101:8080"</span>: <span class="hljs-number">1</span>}},
  <span class="hljs-string">"plugins"</span>: {<span class="hljs-string">"jwt-auth"</span>: {}}
}<span class="hljs-comment">'</span>
</code></pre>
<p><strong>ï¼ˆ3ï¼‰å®¢æˆ·ç«¯è¯·æ±‚ç¤ºä¾‹</strong></p>
<ul>
<li>ç™»å½•è·å– JWT ä»¤ç‰Œï¼šå®¢æˆ·ç«¯é€šè¿‡ç™»å½•æ¥å£ï¼ˆå¦‚<code>/login</code>ï¼‰æäº¤è´¦å·å¯†ç ï¼Œä¸Šæ¸¸æœåŠ¡ç”Ÿæˆ JWT ä»¤ç‰Œï¼ˆä½¿ç”¨<code>secret</code>ç­¾åï¼‰è¿”å›ç»™å®¢æˆ·ç«¯ï¼›</li>
<li>åç»­è¯·æ±‚æºå¸¦ä»¤ç‰Œï¼šè¯·æ±‚å¤´æ·»åŠ <code>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</code>ï¼ŒAPISIX éªŒè¯ä»¤ç‰Œç­¾ååŠè¿‡æœŸæ—¶é—´ã€‚</li>
</ul>
<h3 data-id="heading-5">æ–¹å¼ 2ï¼šè‡ªå®šä¹‰ Lua æ’ä»¶ï¼ˆé€‚åˆå¤æ‚è‡ªå®šä¹‰éªŒç­¾è§„åˆ™ï¼‰</h3>
<p>è‹¥å†…ç½®æ’ä»¶æ— æ³•æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ï¼ˆå¦‚ç‰¹æ®Šç­¾åç®—æ³•ã€å¤æ‚éªŒç­¾é€»è¾‘ï¼‰ï¼Œå¯åŸºäº APISIX çš„<strong>Lua æ’ä»¶å¼€å‘æ¡†æ¶</strong>ç¼–å†™è‡ªå®šä¹‰éªŒç­¾æ’ä»¶ï¼Œå®Œå…¨æ§åˆ¶éªŒç­¾æµç¨‹ã€‚</p>
<p>æ ¸å¿ƒå¼€å‘æ­¥éª¤ï¼š</p>
<p><strong>ï¼ˆ1ï¼‰åˆ›å»ºæ’ä»¶ç›®å½•ä¸æ–‡ä»¶</strong>APISIX æ’ä»¶é»˜è®¤å­˜æ”¾åœ¨<code>/usr/local/apisix/plugins/</code>ç›®å½•ï¼Œæ–°å»ºè‡ªå®šä¹‰æ’ä»¶æ–‡ä»¶ï¼ˆå¦‚<code>custom-sign.lua</code>ï¼‰ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰ç¼–å†™æ’ä»¶æ ¸å¿ƒé€»è¾‘</strong>æ’ä»¶éœ€å®ç°<code>rewrite</code>ï¼ˆè¯·æ±‚è½¬å‘å‰æ‰§è¡Œï¼‰æˆ–<code>access</code>ï¼ˆæƒé™æ ¡éªŒé˜¶æ®µï¼‰æ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­ç¼–å†™éªŒç­¾é€»è¾‘ã€‚ç¤ºä¾‹ï¼ˆè‡ªå®šä¹‰ HMAC éªŒç­¾æ’ä»¶æ ¸å¿ƒä»£ç ï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">local <span class="hljs-attr">core</span> = require(<span class="hljs-string">"apisix.core"</span>)local hmac = require(<span class="hljs-string">"resty.hmac"</span>)-- æ’ä»¶Schemaï¼ˆå®šä¹‰é…ç½®å‚æ•°ï¼Œå¦‚secret_keyã€sign_headerï¼‰local schema = {
  <span class="hljs-attr">type</span> = <span class="hljs-string">"object"</span>,
  <span class="hljs-attr">properties</span> = {
    <span class="hljs-attr">secret_key</span> = {type = <span class="hljs-string">"string"</span>},  -- å¯¹ç§°å¯†é’¥
    <span class="hljs-attr">sign_header</span> = {type = <span class="hljs-string">"string"</span>, default = <span class="hljs-string">"X-Custom-Sign"</span>},  -- ç­¾åè¯·æ±‚å¤´
    <span class="hljs-attr">timestamp_header</span> = {type = <span class="hljs-string">"string"</span>, default = <span class="hljs-string">"X-Custom-Timestamp"</span>}  -- æ—¶é—´æˆ³è¯·æ±‚å¤´},
  <span class="hljs-attr">required</span> = {<span class="hljs-string">"secret_key"</span>}}-- æ’ä»¶ä¸»é€»è¾‘ï¼ˆaccessé˜¶æ®µæ‰§è¡Œï¼‰local function access(conf, ctx)-- <span class="hljs-number">1</span>. æå–è¯·æ±‚ä¸­çš„éªŒç­¾å‚æ•°local req_sign = core.request.header(ctx, conf.sign_header)local req_timestamp = core.request.header(ctx, conf.timestamp_header)local req_method = core.request.get_method(ctx)local req_uri = ctx.var.uri
  local <span class="hljs-attr">req_body</span> = core.request.get_body(ctx)  -- éœ€å¼€å¯bodyè¯»å–ï¼ˆåœ¨APISIXé…ç½®ä¸­è®¾ç½®ï¼‰-- <span class="hljs-number">2</span>. æ ¡éªŒå¿…è¦å‚æ•°æ˜¯å¦å­˜åœ¨if not req_sign or not req_timestamp thenreturn <span class="hljs-number">401</span>, {message = <span class="hljs-string">"missing sign or timestamp"</span>}end-- <span class="hljs-number">3</span>. æ ¡éªŒæ—¶é—´æˆ³ï¼ˆé˜²é‡æ”¾ï¼Œå…è®¸<span class="hljs-number">5</span>åˆ†é’Ÿåå·®ï¼‰local current_ts = ngx.time()if math.abs(current_ts - tonumber(req_timestamp)) &gt; <span class="hljs-number">300</span> thenreturn <span class="hljs-number">401</span>, {message = <span class="hljs-string">"timestamp expired"</span>}end-- <span class="hljs-number">4</span>. ç”Ÿæˆå¾…éªŒç­¾ä¸²ï¼ˆæŒ‰ä¸šåŠ¡è§„åˆ™æ‹¼æ¥ï¼‰local sign_str = string.format(<span class="hljs-string">"%s%s%s%s"</span>, req_method, req_uri, req_timestamp, req_body or <span class="hljs-string">""</span>)-- <span class="hljs-number">5</span>. è®¡ç®—HMACç­¾åå¹¶å¯¹æ¯”local hmac_obj = hmac:new(conf.secret_key, hmac.ALGOS.SHA256)local computed_sign = hmac_obj:final(sign_str, <span class="hljs-literal">true</span>)  -- <span class="hljs-literal">true</span>è¡¨ç¤ºè¿”å›hexæ ¼å¼if computed_sign ~= req_sign thenreturn <span class="hljs-number">403</span>, {message = <span class="hljs-string">"invalid signature"</span>}end-- <span class="hljs-number">6</span>. éªŒç­¾é€šè¿‡ï¼Œç»§ç»­è½¬å‘è¯·æ±‚returnend-- æ³¨å†Œæ’ä»¶return {
  <span class="hljs-attr">version</span> = <span class="hljs-number">0.1</span>,
  <span class="hljs-attr">priority</span> = <span class="hljs-number">2000</span>,  -- æ’ä»¶æ‰§è¡Œä¼˜å…ˆçº§ï¼ˆæ•°å€¼è¶Šå¤§è¶Šå…ˆæ‰§è¡Œï¼‰
  <span class="hljs-attr">name</span> = <span class="hljs-string">"custom-sign"</span>,  -- æ’ä»¶åç§°
  <span class="hljs-attr">schema</span> = schema,
  <span class="hljs-attr">access</span> = access  -- ç»‘å®šaccessé˜¶æ®µæ‰§è¡Œ}
</code></pre>
<p><strong>ï¼ˆ3ï¼‰å¯ç”¨è‡ªå®šä¹‰æ’ä»¶</strong></p>
<ul>
<li>åœ¨ APISIX é…ç½®æ–‡ä»¶ï¼ˆ<code>config.yaml</code>ï¼‰ä¸­æ·»åŠ æ’ä»¶åˆ°<code>plugins</code>åˆ—è¡¨ï¼Œç¡®ä¿ APISIX åŠ è½½æ’ä»¶ï¼š</li>
</ul>
<pre><code class="hljs language-markdown" lang="markdown">plugins:
<span class="hljs-bullet">  -</span> custom-sign  # æ·»åŠ è‡ªå®šä¹‰æ’ä»¶åç§°
<span class="hljs-bullet">  -</span> hmac-auth
<span class="hljs-bullet">  -</span> jwt-auth
</code></pre>
<ul>
<li>é‡å¯ APISIXï¼š<code>apisix restart</code>ï¼›</li>
<li>ä¸º Consumer å’Œ Route ç»‘å®š<code>custom-sign</code>æ’ä»¶ï¼ˆåŒå†…ç½®æ’ä»¶é…ç½®æ–¹å¼ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-6">æ–¹å¼ 3ï¼šé›†æˆå¤–éƒ¨éªŒç­¾æœåŠ¡ï¼ˆé€‚åˆéªŒç­¾é€»è¾‘ç‹¬ç«‹éƒ¨ç½²ï¼‰</h3>
<p>è‹¥éªŒç­¾é€»è¾‘å¤æ‚ï¼ˆå¦‚ä¾èµ–æ•°æ®åº“æŸ¥è¯¢å¯†é’¥ã€å¤šç³»ç»Ÿå…±äº«éªŒç­¾æœåŠ¡ï¼‰ï¼Œå¯é€šè¿‡ APISIX çš„<code>ext-plugin</code>ï¼ˆå¤–éƒ¨æ’ä»¶ï¼‰æˆ–<code>http-logger</code>+<code>request-validator</code>ï¼Œå°†éªŒç­¾è¯·æ±‚è½¬å‘åˆ°å¤–éƒ¨æœåŠ¡ï¼ˆå¦‚ Java/Python ç¼–å†™çš„éªŒç­¾æœåŠ¡ï¼‰ï¼Œç”±å¤–éƒ¨æœåŠ¡è¿”å›éªŒç­¾ç»“æœï¼ŒAPISIX æ ¹æ®ç»“æœå†³å®šæ˜¯å¦æ”¾è¡Œã€‚</p>
<p>æ ¸å¿ƒå®ç°æ€è·¯ï¼š</p>
<p><strong>ï¼ˆ1ï¼‰éƒ¨ç½²å¤–éƒ¨éªŒç­¾æœåŠ¡</strong></p>
<p>å¼€å‘ä¸€ä¸ªéªŒç­¾ APIï¼ˆå¦‚<code>http://sign-service:8080/verify</code>ï¼‰ï¼Œæ¥æ”¶ APISIX è½¬å‘çš„è¯·æ±‚å‚æ•°ï¼ˆå¦‚è¯·æ±‚å¤´ã€Bodyã€è·¯å¾„ï¼‰ï¼Œæ‰§è¡ŒéªŒç­¾é€»è¾‘ï¼Œè¿”å›<code>{"success": true/false, "message": "..."}</code>ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰APISIX é…ç½®è½¬å‘ä¸ç»“æœåˆ¤æ–­</strong>ä½¿ç”¨<code>ext-plugin</code>çš„<code>pre-req</code>ï¼ˆè¯·æ±‚å‰è°ƒç”¨å¤–éƒ¨æœåŠ¡ï¼‰åŠŸèƒ½ï¼Œæˆ–é€šè¿‡<code>proxy-rewrite</code>å°†è¯·æ±‚è½¬å‘åˆ°éªŒç­¾æœåŠ¡ï¼Œå†é€šè¿‡<code>response-rewrite</code>åˆ¤æ–­ç»“æœï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-comment"># ç¤ºä¾‹ï¼šä¸ºRouteé…ç½®å¤–éƒ¨éªŒç­¾æœåŠ¡curl http://apisix-admin:9180/apisix/admin/routes/3 -X PUT -d '</span>
{
  <span class="hljs-string">"uri"</span>: <span class="hljs-string">"/api/v1/pay/*"</span>,
  <span class="hljs-string">"plugins"</span>: {
    <span class="hljs-string">"ext-plugin-pre-req"</span>: {
      <span class="hljs-string">"conf"</span>: [
        {
          <span class="hljs-string">"name"</span>: <span class="hljs-string">"ext-plugin-http"</span>,  <span class="hljs-comment"># è°ƒç”¨å¤–éƒ¨HTTPæœåŠ¡çš„æ’ä»¶</span>
          <span class="hljs-string">"value"</span>: '{<span class="hljs-string">"uri"</span>:<span class="hljs-string">"http://sign-service:8080/verify"</span>,<span class="hljs-string">"method"</span>:<span class="hljs-string">"POST"</span>,<span class="hljs-string">"timeout"</span>:500}'
        }
      ]
    }
  },
  <span class="hljs-string">"upstream"</span>: {<span class="hljs-string">"nodes"</span>: {<span class="hljs-string">"192.168.1.102:8080"</span>: 1}}
}'
</code></pre>
<p>å¤–éƒ¨éªŒç­¾æœåŠ¡è¿”å›<code>success: false</code>æ—¶ï¼ŒAPISIX ç›´æ¥æ‹¦æˆªè¯·æ±‚å¹¶è¿”å›é”™è¯¯ã€‚</p>
<h2 data-id="heading-7">3. éªŒç­¾é…ç½®çš„æœ€ä½³å®è·µ</h2>
<ol>
<li>
<p><strong>å¯†é’¥ç®¡ç†</strong></p>
<ol>
<li>å¯¹ç§°å¯†é’¥ï¼ˆå¦‚<code>hmac-auth</code>çš„<code>secret_key</code>ï¼‰éœ€é€šè¿‡ APISIX çš„<strong>é…ç½®ä¸­å¿ƒ</strong>ï¼ˆå¦‚ etcdã€Nacosï¼‰ç®¡ç†ï¼Œé¿å…ç¡¬ç¼–ç ï¼›</li>
<li>éå¯¹ç§°åŠ å¯†ï¼ˆå¦‚ JWT RS256ï¼‰éœ€å®šæœŸè½®æ¢å…¬é’¥ / ç§é’¥ï¼Œç¡®ä¿å¯†é’¥å®‰å…¨ã€‚</li>
</ol>
</li>
<li>
<p><strong>é˜²é‡æ”¾æ”»å‡»</strong></p>
<ol>
<li>å¿…é¡»åŠ å…¥ â€œæ—¶é—´æˆ³ + nonceâ€ æœºåˆ¶ï¼ˆå¦‚<code>hmac-auth</code>çš„<code>clock_skew</code>å’Œ<code>nonce_header</code>ï¼‰ï¼Œé˜²æ­¢æ”»å‡»è€…å¤ç”¨æ—§ç­¾åï¼›</li>
<li>å¯é€šè¿‡ APISIX çš„<code>redis</code>æ’ä»¶ç¼“å­˜å·²ä½¿ç”¨çš„<code>nonce</code>ï¼Œé¿å…é‡å¤ä½¿ç”¨ã€‚</li>
</ol>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong></p>
<ol>
<li>è‡ªå®šä¹‰æ’ä»¶ä¸­é¿å…é¢‘ç¹ IO æ“ä½œï¼ˆå¦‚æ•°æ®åº“æŸ¥è¯¢ï¼‰ï¼Œå¯å°†å¯†é’¥ç¼“å­˜åˆ° APISIX æœ¬åœ°ï¼ˆå¦‚<code>core.lrucache</code>ï¼‰ï¼›</li>
<li>å¯¹äºå¤§ Body è¯·æ±‚ï¼ŒéªŒç­¾æ—¶å¯ä»…å¯¹ Body çš„å“ˆå¸Œå€¼ï¼ˆå¦‚ MD5ï¼‰è¿›è¡Œç­¾åï¼Œå‡å°‘æ•°æ®å¤„ç†é‡ã€‚</li>
</ol>
</li>
<li>
<p><strong>æ—¥å¿—ä¸ç›‘æ§</strong></p>
<ol>
<li>å¯ç”¨ APISIX çš„<code>error-log-logger</code>å’Œ<code>access-logger</code>ï¼Œè®°å½•éªŒç­¾å¤±è´¥æ—¥å¿—ï¼ˆå¦‚ç­¾åä¸åŒ¹é…ã€æ—¶é—´æˆ³è¿‡æœŸï¼‰ï¼›</li>
<li>é€šè¿‡ APISIX çš„ç›‘æ§æ’ä»¶ï¼ˆå¦‚<code>prometheus</code>ï¼‰ç»Ÿè®¡éªŒç­¾æˆåŠŸç‡ï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸è¯·æ±‚ã€‚</li>
</ol>
</li>
</ol>
<h2 data-id="heading-8">4. å¸¸è§é—®é¢˜æ’æŸ¥</h2>
<ol>
<li>
<p><strong>éªŒç­¾å¤±è´¥ä½†å®¢æˆ·ç«¯ç¡®è®¤</strong> <strong>ç­¾å</strong> <strong>æ­£ç¡®</strong></p>
<ol>
<li>æ£€æŸ¥ â€œå¾…éªŒç­¾ä¸²â€ çš„æ‹¼æ¥è§„åˆ™æ˜¯å¦ä¸å®¢æˆ·ç«¯ä¸€è‡´ï¼ˆå¦‚å‚æ•°æ’åºã€æ˜¯å¦åŒ…å« Bodyã€å¤§å°å†™æ•æ„Ÿï¼‰ï¼›</li>
<li>ç¡®è®¤ APISIX æ˜¯å¦æ­£ç¡®è¯»å–è¯·æ±‚ Bodyï¼ˆéœ€åœ¨<code>config.yaml</code>ä¸­è®¾ç½®<code>proxy_body_temp_path</code>ï¼Œå¹¶ç¡®ä¿æ’ä»¶å¯ç”¨ Body è¯»å–ï¼‰ã€‚</li>
</ol>
</li>
<li>
<p><strong>JWT ä»¤ç‰ŒéªŒè¯å¤±è´¥</strong></p>
<ol>
<li>æ£€æŸ¥<code>algorithm</code>æ˜¯å¦åŒ¹é…ï¼ˆå¦‚å®¢æˆ·ç«¯ç”¨ HS256ï¼Œç½‘å…³é…ç½® RS256ï¼‰ï¼›</li>
<li>ç¡®è®¤ä»¤ç‰Œæœªè¿‡æœŸï¼ˆ<code>exp</code>å­—æ®µï¼‰ï¼Œä¸”<code>secret</code>/<code>public_key</code>ä¸å®¢æˆ·ç«¯ç­¾åæ—¶ä½¿ç”¨çš„å¯†é’¥ä¸€è‡´ã€‚</li>
</ol>
</li>
<li>
<p><strong>è‡ªå®šä¹‰æ’ä»¶ä¸ç”Ÿæ•ˆ</strong></p>
<ol>
<li>æ£€æŸ¥æ’ä»¶æ˜¯å¦æ·»åŠ åˆ° APISIX çš„<code>plugins</code>åˆ—è¡¨ä¸­ï¼›</li>
<li>é€šè¿‡ APISIX æ—¥å¿—ï¼ˆ<code>/usr/local/apisix/logs/error.log</code>ï¼‰æŸ¥çœ‹æ’ä»¶æ‰§è¡ŒæŠ¥é”™ä¿¡æ¯ã€‚</li>
</ol>
</li>
</ol>
<h2 data-id="heading-9">5.å›¢é˜Ÿä»‹ç»</h2>
<p>ã€Œ<strong>æ™ºæ…§å®¶æŠ€æœ¯å¹³å°-åº”ç”¨è½¯ä»¶æ¡†æ¶å¼€å‘</strong>ã€ä¸»è¦è´Ÿè´£è®¾è®¡å·¥å…·çš„ç ”å‘ï¼ŒåŒ…æ‹¬è¥é”€è®¾è®¡å·¥å…·ã€å®¶ç”µVRè®¾è®¡å’Œå±•ç¤ºã€æ°´ç”µæš–é€šå‰ç½®è®¾è®¡èƒ½åŠ›ï¼Œç ”å‘å¹¶æ²‰æ·€ç´ æåº“ï¼Œæ„å»ºå®¶å±…å®¶è£…ç´ æåº“ï¼Œé›†æˆæˆ·å‹åº“ã€å…¨å“ç±»äº§å“åº“ã€è®¾è®¡æ–¹æ¡ˆåº“ã€ç”Ÿäº§å·¥è‰ºæ¨¡å‹ï¼Œæ‰“é€ åŸºäºæˆ·å‹å’Œé£æ ¼çš„AIè®¾è®¡èƒ½åŠ›ï¼Œå¿«é€Ÿç”Ÿæˆç®—é‡å’ŒæŠ¥ä»·ï¼›åŒæ—¶ç ”å‘äº†é—¨åº—è®¾è®¡å¸ˆä¸­å¿ƒå’Œé¡¹ç›®ä¸­å¿ƒï¼ŒåŒ…æ‹¬è®¾è®¡å¸ˆç®¡ç†èƒ½åŠ›å’Œé¡¹ç›®ç»ç†ç®¡ç†èƒ½åŠ›ã€‚å®ç°äº†åœºæ™¯å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒåŒæ—¶ä¸ºæ°´ï¼Œç©ºæ°”ï¼Œå¨æˆ¿ç­‰äº§ä¸šæä¾›å•†æœºç®¡ç†å·¥å…·ï¼Œä»è€Œå®ç°äº†ä»¥åœºæ™¯è´¯ç©¿çš„Bç«¯Cç«¯å…¨æµç¨‹ç³»ç»Ÿã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»å›è°ƒå‡½æ•°åˆ°Promise]]></title>    <link>https://juejin.cn/post/7603246733318144054</link>    <guid>https://juejin.cn/post/7603246733318144054</guid>    <pubDate>2026-02-06T02:50:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603246733318144054" data-draft-id="7603282168137023507" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»å›è°ƒå‡½æ•°åˆ°Promise"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,ECMAScript 6"/> <meta itemprop="datePublished" content="2026-02-06T02:50:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤œå°½ä¸¶"/> <meta itemprop="url" content="https://juejin.cn/user/3263006244342062"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»å›è°ƒå‡½æ•°åˆ°Promise
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3263006244342062/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤œå°½ä¸¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T02:50:15.000Z" title="Fri Feb 06 2026 02:50:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»21åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘åœ¨é¢è¯•ä¸­é‡åˆ°äº†å¾ˆå¤šå…³äº <code>Promise</code> çš„é—®é¢˜ï¼Œå› ä¸ºä»¥å‰çš„ä¸šåŠ¡åœ¨è¯·æ±‚æ–¹é¢å¹¶ä¸å¤æ‚ï¼Œå¤šæ•°æ—¶å€™éƒ½æ˜¯åœ¨ç”¨ <code>async/await</code>ï¼Œå¯¹ <code>Promise</code> çš„ç†è§£è¿˜æ˜¯æœ‰æ‰€æ¬ ç¼ºï¼Œæœ€è¿‘é‡æ–°å­¦ä¹ äº†ä¸€ä¸‹ <code>Promise</code>ï¼Œå°½é‡é¿å…å†™æˆAPIå¼çš„æ–‡ç« ï¼Œä¸»è¦è¿˜æ˜¯ç»“åˆè‡ªå·±çš„ä¸€äº›ç†è§£å’Œæ€è€ƒæ¥æ•´ç†ä¸€ä¸‹ã€‚</p>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Promise</h2>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒJavaScript çš„ä¸»çº¿ç¨‹æ˜¯å•çº¿ç¨‹æ‰§è¡Œçš„ï¼Œæ‰€æœ‰çš„åŒæ­¥ä»£ç éƒ½æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œå½“é‡åˆ°ä¸€äº›è€—æ—¶æ“ä½œæ—¶ï¼ˆæ¯”å¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å–ç­‰ï¼‰ï¼Œå¦‚æœé‡‡ç”¨åŒæ­¥çš„æ–¹å¼å»å¤„ç†è¿™äº›æ“ä½œï¼Œå°±ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œå¯¼è‡´é¡µé¢å¡é¡¿ï¼Œç”¨æˆ·ä½“éªŒå˜å·®ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å‘æ˜äº†å¼‚æ­¥ç¼–ç¨‹ï¼Œæœ€æ—©çš„å¼‚æ­¥ç¼–ç¨‹æ–¹å¼æ˜¯å›è°ƒå‡½æ•°ï¼ˆCallbackï¼‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">getX, getY, finalCallback</span>) {
  <span class="hljs-keyword">var</span> x, y;
  <span class="hljs-title function_">getX</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">xVal</span>) {
    x = xVal;
    <span class="hljs-keyword">if</span> (y !== <span class="hljs-literal">undefined</span>) {
      <span class="hljs-title function_">finalCallback</span>(x + y);
    }
  });

  <span class="hljs-title function_">getY</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">yVal</span>) {
    y = yVal;
    <span class="hljs-keyword">if</span> (x !== <span class="hljs-literal">undefined</span>) {
      <span class="hljs-title function_">finalCallback</span>(x + y);
    }
  });
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchX</span>(<span class="hljs-params">xCallback</span>) {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-title function_">xCallback</span>(<span class="hljs-number">2</span>);
  }, <span class="hljs-number">1000</span>);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchY</span>(<span class="hljs-params">yCallback</span>) {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-title function_">yCallback</span>(<span class="hljs-number">3</span>);
  }, <span class="hljs-number">1000</span>);
}

<span class="hljs-title function_">add</span>(fetchX, fetchY, <span class="hljs-keyword">function</span> (<span class="hljs-params">sum</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Sum is: "</span> + sum);
});
</code></pre>
<p><code>fetchX</code> å’Œ <code>fetchY</code> æ˜¯ä¸¤ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œåˆ†åˆ«æ¨¡æ‹Ÿä»æœåŠ¡å™¨è·å–æ•°æ®çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬è¦è¿›è¡Œ <code>x+y</code> çš„è®¡ç®—ï¼Œå¦‚æœå®ƒä»¬ä¸­çš„ä»»ä½•ä¸€ä¸ªè¿˜æ²¡æœ‰å‡†å¤‡å¥½ï¼Œå°±ç­‰å¾…ä¸¤è€…éƒ½å‡†å¤‡å¥½ã€‚æˆ‘ä»¬é€æ­¥æ‹†è§£è¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<ol>
<li>
<p>è°ƒç”¨ <code>add</code> å‡½æ•°ï¼Œä¼ å…¥ <code>fetchX</code>ã€<code>fetchY</code> å’Œå›è°ƒå‡½æ•°ã€‚</p>
</li>
<li>
<p>åœ¨ <code>add</code> å‡½æ•°å†…éƒ¨ï¼Œè°ƒç”¨ <code>getX</code>ï¼ˆå³ <code>fetchX</code>ï¼‰ï¼Œä¼ å…¥ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚</p>
</li>
</ol>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> (<span class="hljs-params">xVal</span>) {
  x = xVal;
  <span class="hljs-keyword">if</span> (y !== <span class="hljs-literal">undefined</span>) {
    <span class="hljs-title function_">finalCallback</span>(x + y);
  }
}
</code></pre>
<ol start="3">
<li>
<p><code>fetchX</code> å¼€å§‹æ‰§è¡Œï¼Œç»è¿‡1ç§’é’Ÿåï¼Œè°ƒç”¨ä¼ å…¥çš„å›è°ƒå‡½æ•°ï¼ˆ<code>xCallback</code>ï¼‰ï¼Œå°† <code>2</code> ä½œä¸ºå‚æ•°ä¼ é€’è¿›å»ã€‚</p>
</li>
<li>
<p>å›è°ƒå‡½æ•°æ‰§è¡Œï¼Œ<code>x</code> è¢«èµ‹å€¼ä¸º <code>2</code>ï¼Œç„¶åæ£€æŸ¥ <code>y</code> æ˜¯å¦å·²ç»å‡†å¤‡å¥½ï¼ˆå³ <code>y</code> æ˜¯å¦ä¸ä¸º <code>undefined</code>ï¼‰ã€‚æ­¤æ—¶ <code>y</code> è¿˜æ²¡æœ‰å‡†å¤‡å¥½ï¼Œæ‰€ä»¥ä¸ä¼šè°ƒç”¨æœ€ç»ˆçš„ <code>finalCallback</code>ã€‚</p>
</li>
<li>
<p>åŒæ ·çš„è¿‡ç¨‹å‘ç”Ÿåœ¨ <code>getY</code>ï¼ˆå³ <code>fetchY</code>ï¼‰ä¸Šï¼Œç»è¿‡1ç§’é’Ÿåï¼Œ<code>y</code> è¢«èµ‹å€¼ä¸º <code>3</code>ï¼Œç„¶åæ£€æŸ¥ <code>x</code> æ˜¯å¦å·²ç»å‡†å¤‡å¥½ã€‚æ­¤æ—¶ <code>x</code> å·²ç»å‡†å¤‡å¥½äº†ï¼ˆ<code>x=2</code>ï¼‰ï¼Œæ‰€ä»¥è°ƒç”¨ <code>finalCallback</code>ï¼Œè®¡ç®—å‡ºæœ€ç»ˆçš„ç»“æœ <code>5</code>ï¼Œå¹¶æ‰“å°å‡ºæ¥ã€‚</p>
</li>
</ol>
<p>ä»è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ˜¯å¦èƒ½çœ‹å‡ºä½¿ç”¨å›è°ƒå‡½æ•°æ¥å¤„ç†å¼‚æ­¥æ“ä½œå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Ÿé¦–å…ˆï¼Œä¹Ÿè®¸è¿™ä¸ªæ€è·¯å¾ˆå·§å¦™ï¼Œä½†æ˜¯ä»£ç å¾ˆå¤æ‚ï¼Œæˆ‘åœ¨é€æ­¥æ‹†è§£å‰å¾ˆéš¾ç›´æ¥ç†è§£è¿™ä¸ªè¿‡ç¨‹ã€‚å…¶æ¬¡ï¼Œå¦‚æœæœ‰æ›´å¤šçš„å¼‚æ­¥æ“ä½œéœ€è¦å¤„ç†ï¼Œä»£ç ä¼šå˜å¾—æ›´åŠ å¤æ‚ï¼Œéš¾ä»¥ç»´æŠ¤ï¼Œè¿™å°±æ˜¯è‘—åçš„â€œå›è°ƒåœ°ç‹±â€é—®é¢˜ã€‚</p>
<p>å›æƒ³æˆ‘åˆšä¸Šç­æ—¶ï¼Œä½¿ç”¨çš„è¿˜æ˜¯ jQueryï¼ŒjQuery çš„ Ajax è¯·æ±‚å°±æ˜¯åŸºäºå›è°ƒå‡½æ•°çš„ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">$.<span class="hljs-title function_">ajax</span>({
  <span class="hljs-attr">url</span>: <span class="hljs-string">"https://api.example.com/data"</span>,
  <span class="hljs-attr">method</span>: <span class="hljs-string">"GET"</span>,
  <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Data received:"</span>, data);
    $.<span class="hljs-title function_">ajax</span>({
      <span class="hljs-attr">url</span>: <span class="hljs-string">"https://api.example.com/more-data"</span>,
      <span class="hljs-attr">method</span>: <span class="hljs-string">"GET"</span>,
      <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">moreData</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"More data received:"</span>, moreData);
        <span class="hljs-comment">// ç»§ç»­åµŒå¥—æ›´å¤šçš„å›è°ƒ...</span>
      },
      <span class="hljs-attr">error</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Error fetching more data:"</span>, err);
      },
    });
  },
  <span class="hljs-attr">error</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Error fetching data:"</span>, err);
  },
});
</code></pre>
<p>æ˜¾ç„¶ï¼Œéšç€åµŒå¥—å±‚çº§çš„å¢åŠ ï¼Œä»£ç å˜å¾—è¶Šæ¥è¶Šéš¾ä»¥é˜…è¯»å’Œç»´æŠ¤ï¼Œè€Œä¸”é”™è¯¯å¤„ç†ä¹Ÿå˜å¾—å¤æ‚ã€‚æ‰€ä»¥å›æ”¶è¿™ä¸€èŠ‚çš„æ ‡é¢˜ï¼Œå› ä¸ºç”¨å›è°ƒå‡½æ•°æ¥å¤„ç†å¼‚æ­¥æ“ä½œç¡®å®å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š</p>
<ol>
<li>å¯è¯»æ€§å·®ï¼šåµŒå¥—çš„å›è°ƒå‡½æ•°ä½¿ä»£ç éš¾ä»¥ç†è§£ã€‚</li>
<li>é”™è¯¯å¤„ç†å¤æ‚ï¼šæ¯ä¸ªå›è°ƒå‡½æ•°éƒ½éœ€è¦å•ç‹¬å¤„ç†é”™è¯¯ï¼Œå¯¼è‡´ä»£ç å†—é•¿ã€‚</li>
<li>æ§åˆ¶æµå›°éš¾ï¼šç®¡ç†å¤šä¸ªå¼‚æ­¥æ“ä½œçš„é¡ºåºå’Œä¾èµ–å…³ç³»å˜å¾—å¤æ‚ã€‚</li>
</ol>
<p>ç­‰è®²å®Œ <code>Promise</code> ä¹‹åæˆ‘ä»¬çœ‹ä¸‹ <code>Promise</code> æ˜¯å¦èƒ½è§£å†³è¿™äº›é—®é¢˜ã€‚</p>
<h2 data-id="heading-1">Promise</h2>
<h3 data-id="heading-2">æ˜¯ä»€ä¹ˆ</h3>
<p>é€šä¿—çš„è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ <code>Promise</code> ç†è§£æˆä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„ä»£ç†ï¼Œå®ƒæ˜¯å¼‚æ­¥æ“ä½œçš„è¿”å›å€¼ï¼ŒåŸæœ¬åªæœ‰åŒæ­¥æ“ä½œæ‰èƒ½æœ‰è¿”å›å€¼ï¼Œå¼‚æ­¥æ“ä½œåªèƒ½ä½¿ç”¨æˆ‘ä»¬ä¸Šé¢æ‰€è¯´çš„å›è°ƒå‡½æ•°åµŒå¥—æ¥è·å¾—ç»“æœã€‚</p>
<blockquote>
<p>å¼‚æ­¥æ–¹æ³•ä¸ä¼šç«‹å³è¿”å›æœ€ç»ˆå€¼ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ª <code>Promise</code>ï¼Œä»¥ä¾¿åœ¨å°†æ¥çš„æŸä¸ªæ—¶é—´ç‚¹æä¾›è¯¥å€¼ã€‚</p>
</blockquote>
<p><code>Promise</code> çš„åŸºæœ¬ç”¨æ³•åº”è¯¥éƒ½å¾ˆç†Ÿæ‚‰äº†ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª <code>Promise</code> çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ES6 åŸç”Ÿ Promise</span>
<span class="hljs-keyword">const</span> asyncTask = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-comment">// æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œï¼ˆæ¯”å¦‚æ¥å£è¯·æ±‚ã€æ–‡ä»¶è¯»å–ï¼‰</span>
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> success = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (success) {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-string">"æ“ä½œæˆåŠŸ"</span>); <span class="hljs-comment">// æˆåŠŸå›è°ƒ</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title function_">reject</span>(<span class="hljs-string">"æ“ä½œå¤±è´¥"</span>); <span class="hljs-comment">// å¤±è´¥å›è°ƒ</span>
    }
  }, <span class="hljs-number">1000</span>);
});

<span class="hljs-comment">// è°ƒç”¨ Promise</span>
asyncTask
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result)) <span class="hljs-comment">// è¾“å‡ºï¼šæ“ä½œæˆåŠŸ</span>
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error))
  .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ“ä½œå®Œæˆ"</span>));
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æŠŠå¼‚æ­¥æ“ä½œ <code>setTimeout</code> åŒ…è£…åœ¨ <code>Promise</code> ä¸­ï¼Œç„¶åé€šè¿‡ <code>then</code>ã€<code>catch</code> å’Œ <code>finally</code> æ¥å¤„ç†ç»“æœå’Œé”™è¯¯ï¼Œ<code>setTimeout</code> å¯ä»¥æ˜¯ä»»æ„å¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å–ç­‰ã€‚</p>
<p>éšè—åœ¨è¿™äº› API ä¹‹ä¸‹çš„è¿˜æœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¸€ä¸ª <code>Promise</code> å¿…ç„¶å¤„äºä»¥ä¸‹ä¸‰ç§çŠ¶æ€ä¹‹ä¸€ï¼š</p>
<ul>
<li><strong><code>Pending</code>ï¼ˆè¿›è¡Œä¸­ï¼‰</strong>ï¼šåˆå§‹çŠ¶æ€ï¼Œæ—¢ä¸æ˜¯æˆåŠŸï¼Œä¹Ÿä¸æ˜¯å¤±è´¥ã€‚</li>
<li><strong><code>Fulfilled</code>ï¼ˆå·²æˆåŠŸï¼‰</strong>ï¼šæ“ä½œæˆåŠŸå®Œæˆã€‚</li>
<li><strong><code>Rejected</code>ï¼ˆå·²å¤±è´¥ï¼‰</strong>ï¼šæ“ä½œå¤±è´¥ã€‚</li>
</ul>
<p>è¿™ä¸€éƒ¨åˆ†å†…å®¹å¯ä»¥å‚è€ƒ MDN çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FPromise" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise" ref="nofollow noopener noreferrer">Promise - JavaScript | MDN</a>ï¼Œè®²å¾—å¾ˆæ¸…æ¥šã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b269d2a441e45aa830d1b733b54fc08~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSc5bC95Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770951014&amp;x-signature=KYxb7aLlIptL2lma5P%2B3xxGzSzM%3D" alt="" loading="lazy"/></p>
<p>å‚è€ƒè¿™å¼ å›¾ï¼Œ<code>Pending</code> çŠ¶æ€é€šå‘ä¸¤ä¸ªç»“æœï¼š<code>Fulfilled</code> å’Œ <code>Rejected</code>ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å•å‘ä¸å¯é€†çš„ï¼Œä¸€æ—¦çŠ¶æ€æ”¹å˜ï¼Œå°±ä¼šæ°¸ä¹…ä¿æŒè¯¥çŠ¶æ€ã€‚å½“ä»»æ„ä¸€ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼Œ<code>then</code> æ–¹æ³•æ³¨å†Œçš„å›è°ƒå‡½æ•°å°±ä¼šè¢«è°ƒç”¨ï¼Œå³ä¸å†å¤„äº"å¾…å®š"ï¼ˆ<code>Pending</code>ï¼‰çŠ¶æ€ï¼Œç§°ä¹‹ä¸º"å·²æ•²å®š"ï¼ˆ<code>Settled</code>ï¼‰ã€‚</p>
<h4 data-id="heading-3">Rejected</h4>
<p>æˆ‘ä»¬å…ˆçœ‹ <code>Rejected</code> çš„æƒ…å†µï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// catch</span>
<span class="hljs-keyword">const</span> failedTask = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">reject</span>(<span class="hljs-string">"æ“ä½œå¤±è´¥"</span>); <span class="hljs-comment">// å¤±è´¥å›è°ƒ</span>
  }, <span class="hljs-number">1000</span>);
});

failedTask
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result))
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error)) <span class="hljs-comment">// è¾“å‡ºï¼šæ“ä½œå¤±è´¥</span>
  .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ“ä½œå®Œæˆ"</span>));

<span class="hljs-comment">// then ç¬¬äºŒä¸ªå‚æ•°</span>
<span class="hljs-keyword">const</span> anotherFailedTask = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">reject</span>(<span class="hljs-string">"æ“ä½œå¤±è´¥"</span>); <span class="hljs-comment">// å¤±è´¥å›è°ƒ</span>
  }, <span class="hljs-number">1000</span>);
});

anotherFailedTask
  .<span class="hljs-title function_">then</span>(
    <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æˆåŠŸï¼š"</span> + result),
    <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å¤±è´¥ï¼š"</span> + error),
  ) <span class="hljs-comment">// è¾“å‡ºï¼šæ“ä½œå¤±è´¥</span>
  .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ“ä½œå®Œæˆ"</span>));
</code></pre>
<p>æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥æ•è· <code>Promise</code> çš„æ‹’ç»çŠ¶æ€ï¼šä¸€ç§æ˜¯ä½¿ç”¨ <code>catch</code> æ–¹æ³•ï¼Œå¦ä¸€ç§æ˜¯å°†é”™è¯¯å¤„ç†å‡½æ•°ä½œä¸º <code>then</code> æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ã€‚ä¸¤ç§æ–¹å¼éƒ½èƒ½æœ‰æ•ˆåœ°å¤„ç† <code>Promise</code> çš„æ‹’ç»çŠ¶æ€ï¼Œå¦‚æœä¸è¿›è¡Œé”™è¯¯å¤„ç†ï¼Œæœªæ•è·çš„æ‹’ç»ä¼šå¯¼è‡´æœªå¤„ç†çš„ <code>Promise</code> æ‹’ç»è­¦å‘Šã€‚æ›´è¯¦ç»†çš„è¯´æ˜æˆ‘ä»¬åé¢å†èŠï¼Œè¿™é‡Œåªçœ‹ç”¨æ³•ã€‚</p>
<h4 data-id="heading-4">Fulfilled</h4>
<p>åœ¨æ„é€ å™¨ <code>Promise(..)</code> ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨ä¸¤ä¸ªå›è°ƒå‡½æ•°æ¥è¡¨ç¤ºæˆåŠŸå’Œå¤±è´¥çš„æƒ…å†µï¼Œè¿™ä¸¤ä¸ªå‡½æ•°çš„å‘½åå¹¶ä¸å›ºå®šï¼Œé€šå¸¸æˆ‘ä»¬ä½¿ç”¨ <code>resolve</code> å’Œ <code>reject</code>ï¼Œ<code>reject</code> å¾ˆæ¸…æ¥šåœ°è¡¨ç¤ºå¤±è´¥ï¼Œå¹¶ä¸”ä»£è¡¨ <code>Promise</code> è¿›å…¥ <code>Rejected</code> çŠ¶æ€ï¼Œè€ŒæˆåŠŸçš„å›è°ƒå‡½æ•° <code>resolve</code>ï¼ˆå†³è®®ï¼‰ï¼Œå®ƒè¡¨ç¤º <code>Promise</code> è¿›å…¥ <code>Fulfilled</code> çŠ¶æ€ï¼Œè¿™é‡Œç”¨ ES6 è§„èŒƒä¸­çš„å›è°ƒå‘½åæ¥è¯´æ˜ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">myPromise.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> onFulfilled, onRejected)
</code></pre>
<h4 data-id="heading-5">é“¾å¼è°ƒç”¨</h4>
<p>åœ¨æåˆ° <code>Promise</code> æ—¶ï¼Œé“¾å¼è°ƒç”¨æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ° <code>Promise</code> å¯¹è±¡å¯ä»¥è°ƒç”¨ <code>then</code> æ–¹æ³•ï¼Œè€Œ <code>then</code> æ–¹æ³•åˆå¯ä»¥è°ƒç”¨ <code>catch</code> å’Œ <code>finally</code> æ–¹æ³•ï¼Œå› ä¸º <code>then</code> æ–¹æ³•è¿”å›çš„ä»ç„¶æ˜¯ä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼Œè€Œ <code>catch</code> å’Œ <code>finally</code> æ–¹æ³•å†…åœ¨å†…éƒ¨è°ƒç”¨çš„ä¹Ÿæ˜¯ <code>then</code> æ–¹æ³•ï¼Œè¿™æ ·å®ƒä»¬å°±å¯ä»¥é“¾å¼è°ƒç”¨ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// Promise.resolveè¿™ç§å†™æ³•æˆ‘ä»¬ä¹‹åè®¨è®º</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'ç¬¬ä¸€æ­¥ç»“æœ'</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res); <span class="hljs-comment">// æ‰“å°ï¼šç¬¬ä¸€æ­¥ç»“æœ</span>
    <span class="hljs-comment">// return æ™®é€šå€¼ â†’ æ–° Promise çŠ¶æ€ä¸º fulfilled</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">'ç¬¬äºŒæ­¥ç»“æœ'</span>;
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res); <span class="hljs-comment">// æ‰“å°ï¼šç¬¬äºŒæ­¥ç»“æœ</span>
    <span class="hljs-comment">// return æ–° Promise â†’ æ–° Promise è·Ÿéšè¯¥ Promise çš„çŠ¶æ€</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'ç¬¬ä¸‰æ­¥ç»“æœ'</span>);
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res); <span class="hljs-comment">// æ‰“å°ï¼šç¬¬ä¸‰æ­¥ç»“æœ</span>
  });
</code></pre>
<p>é€šè¿‡ä¾‹å­å¯ä»¥çœ‹åˆ°ï¼Œé“¾å¼è°ƒç”¨å¯ä»¥å°†å¤šä¸ªå¼‚æ­¥æ“ä½œä¸²è”èµ·æ¥ï¼Œæ¯ä¸ª <code>then</code> æ–¹æ³•å¤„ç†ä¸Šä¸€ä¸ª <code>Promise</code> çš„ç»“æœï¼Œè¿™å°±è§£å†³äº†æˆ‘ä»¬æœ€å¼€å§‹æåˆ°çš„å›è°ƒåœ°ç‹±é—®é¢˜ï¼Œä½¿ä»£ç æ›´åŠ æ¸…æ™°å’Œæ˜“äºç»´æŠ¤ã€‚</p>
<p>è¿™ä¸ªä¾‹å­ä¸­è¿˜æœ‰ä¸€ä¸ªç»†èŠ‚ï¼Œåœ¨ <code>then</code> æ–¹æ³•ä¸­é€šè¿‡ <code>return</code> æ¥ä¼ é€’å€¼ï¼Œå½“ä½¿ç”¨ <code>return</code> è¿”å›ä¸€ä¸ªæ™®é€šå€¼æ—¶ï¼Œæ–°çš„ <code>Promise</code> ä¼šè¿›å…¥ <code>Fulfilled</code> çŠ¶æ€ï¼Œä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ªæ–°çš„ <code>Promise</code> å¯¹è±¡ï¼Œè¿™æ ·æ–°çš„ <code>Promise</code> ä¼šè·Ÿéšè¯¥ <code>Promise</code> çš„çŠ¶æ€ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ª <code>thenable</code> å¯¹è±¡ï¼ˆå…·æœ‰ <code>then</code> æ–¹æ³•çš„å¯¹è±¡ï¼‰ï¼Œ<code>Promise</code> ä¹Ÿä¼šç­‰å¾…è¯¥å¯¹è±¡è§£å†³ï¼Œè¿™ä½¿å¾— <code>Promise</code> å¯ä»¥ä¸å…¶ä»–å®ç°äº†ç±» <code>Promise</code> æ¥å£çš„åº“è¿›è¡Œäº’æ“ä½œã€‚</p>
<p>å¤§ä½“ä¸Šæˆ‘ä»¬äº†è§£äº† <code>Promise</code> çš„ç”¨æ³•ï¼Œæˆ‘ä»¬ç”¨ <code>Promise</code> æ¥å®ç°åµŒå¥—å¼‚æ­¥æ“ä½œï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getFirstData</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// è¿”å›ä¸€ä¸ª Promiseï¼Œç”¨ setTimeout æ¨¡æ‹Ÿå¼‚æ­¥</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">const</span> data = <span class="hljs-string">"ç¬¬ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœ"</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Data received:"</span>, data);
      <span class="hljs-comment">// å¼‚æ­¥æˆåŠŸï¼Œä¼ é€’ç»“æœç»™ä¸‹ä¸€ä¸ª .then()</span>
      <span class="hljs-title function_">resolve</span>(data);
    }, <span class="hljs-number">1000</span>);
  });
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">getSecondData</span>(<span class="hljs-params">prevData</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">const</span> moreData = <span class="hljs-string">`ç¬¬äºŒä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœï¼ˆåŸºäºä¸Šä¸€æ­¥ï¼š<span class="hljs-subst">${prevData}</span>ï¼‰`</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"More data received:"</span>, moreData);
      <span class="hljs-title function_">resolve</span>(moreData); <span class="hljs-comment">// å¯é€‰ï¼šç»§ç»­ä¼ é€’ç»“æœç»™åç»­é“¾å¼è°ƒç”¨</span>
    }, <span class="hljs-number">1000</span>);
  });
}

<span class="hljs-comment">// é“¾å¼è°ƒç”¨</span>
<span class="hljs-title function_">getFirstData</span>()
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-comment">// ç¬¬ä¸€ä¸ªå¼‚æ­¥æˆåŠŸåï¼Œæ‰§è¡Œç¬¬äºŒä¸ªå¼‚æ­¥</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">getSecondData</span>(data);
  })
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-comment">// ç»Ÿä¸€æ•è·æ‰€æœ‰å¼‚æ­¥æ“ä½œçš„é”™è¯¯</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"å¼‚æ­¥æ“ä½œå‡ºé”™ï¼š"</span>, err);
  });
</code></pre>
<h3 data-id="heading-6">Promise è§£å†³äº†ä»€ä¹ˆé—®é¢˜</h3>
<p>é€šè¿‡è¿™ä¸ªä¾‹å­å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¸€å¼€å§‹æå‡ºçš„å›è°ƒå‡½æ•°çš„ä¸‰ä¸ªé—®é¢˜å¾—åˆ°äº†ä¸åŒç¨‹åº¦çš„è§£å†³ï¼š</p>
<ol>
<li><strong>å¯è¯»æ€§æå‡</strong>ï¼šé€šè¿‡é“¾å¼è°ƒç”¨ï¼Œä»£ç ç»“æ„æ›´åŠ æ¸…æ™°ï¼Œæ¯ä¸ªå¼‚æ­¥æ“ä½œéƒ½åœ¨è‡ªå·±çš„ <code>then</code> å—ä¸­å¤„ç†ï¼Œé¿å…äº†åµŒå¥—å›è°ƒçš„å¤æ‚æ€§ã€‚</li>
<li><strong>ç»Ÿä¸€é”™è¯¯å¤„ç†</strong>ï¼šä½¿ç”¨ <code>catch</code> æ–¹æ³•å¯ä»¥ç»Ÿä¸€æ•è·æ‰€æœ‰å¼‚æ­¥æ“ä½œçš„é”™è¯¯ï¼Œç®€åŒ–äº†é”™è¯¯å¤„ç†é€»è¾‘ã€‚</li>
<li><strong>æ§åˆ¶æµç®€åŒ–</strong>ï¼šé€šè¿‡é“¾å¼è°ƒç”¨ï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°ç®¡ç†å¤šä¸ªå¼‚æ­¥æ“ä½œçš„é¡ºåºå’Œä¾èµ–å…³ç³»ï¼Œä½¿ä»£ç æ›´æ˜“äºç†è§£ã€‚</li>
</ol>
<p>è¿™é‡Œæœ‰ç‚¹åƒä¸€ç§ <code>if</code> è¯­å¥çš„æ›¿ä»£å†™æ³•ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">if</span> (condition1) {
  <span class="hljs-comment">// do something</span>
  <span class="hljs-keyword">if</span> (condition2) {
    <span class="hljs-comment">// do something</span>
    <span class="hljs-keyword">if</span> (condition3) {
      <span class="hljs-comment">// do something</span>
    }
  }
}

<span class="hljs-comment">// å¯ä»¥æ”¹å†™ä¸ºï¼š</span>

<span class="hljs-keyword">if</span>(!condition1) <span class="hljs-keyword">return</span>;
<span class="hljs-comment">// do something</span>
<span class="hljs-keyword">if</span>(!condition2) <span class="hljs-keyword">return</span>;
<span class="hljs-comment">// do something</span>
<span class="hljs-keyword">if</span>(!condition3) <span class="hljs-keyword">return</span>;
<span class="hljs-comment">// do something</span>

</code></pre>
<p>æ¢ä¸ªæ€è·¯ï¼Œä½œç”¨ç›¸åŒï¼Œä½†ä»£ç çš„å¯è¯»æ€§ä¼šå˜é«˜ï¼Œä¸è¿‡ <code>Promise</code> è¦å¤æ‚å¾—å¤šï¼Œæˆ‘æ²¡æœ‰ç›´æ¥ä½¿ç”¨ä¸€å¼€å§‹çš„å›è°ƒå‡½æ•°ç‰ˆæœ¬æ¥å¯¹æ¯”ï¼Œå¹¶éåšä¸åˆ°ï¼Œè€Œæ˜¯æ¶‰åŠäº†æ–°çš„çŸ¥è¯†ç‚¹ï¼Œéœ€è¦ç”¨åˆ° <code>Promise</code> çš„ä¸€äº› APIï¼Œæˆ‘æ‰“ç®—æ¢ä¸€ç§è§’åº¦æ¥ç†è§£ï¼Œç„¶åæˆ‘ä»¬å†å›å¤´çœ‹è¿™ä¸ªå¯¹æ¯”ã€‚</p>
<h3 data-id="heading-7">Promise çš„ API ä¸åŸå‹</h3>
<p><code>Promise</code> æ˜¯ ES6ï¼ˆES2015ï¼‰å¼•å…¥çš„ä¸€ç§ç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œçš„<strong>å¯¹è±¡</strong>ï¼Œæœ€è¿‘åˆšå†™äº†ä¸€ç¯‡å…³äºåŸå‹çš„æ–‡ç« ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cnblogs.com%2FLFeather%2Fp%2F19312203" target="_blank" title="https://www.cnblogs.com/LFeather/p/19312203" ref="nofollow noopener noreferrer">å¯¹äºåŸå‹ã€åŸå‹é“¾å’Œç»§æ‰¿çš„ç†è§£</a>ï¼Œè¿™é‡Œå°±æ˜¯æƒ³ä»åŸå‹å’Œé¢å‘å¯¹è±¡çš„è§’åº¦æ¥åŠ æ·±ä¸€ä¸‹ç†è§£ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨å‰é¢çš„ä¾‹å­ï¼Œåˆ†æ­¥æ‹†è§£ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ES6 åŸç”Ÿ Promise</span>
<span class="hljs-keyword">const</span> asyncTask = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-comment">// æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œï¼ˆæ¯”å¦‚æ¥å£è¯·æ±‚ã€æ–‡ä»¶è¯»å–ï¼‰</span>
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> success = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (success) {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-string">"æ“ä½œæˆåŠŸ"</span>); <span class="hljs-comment">// æˆåŠŸå›è°ƒ</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title function_">reject</span>(<span class="hljs-string">"æ“ä½œå¤±è´¥"</span>); <span class="hljs-comment">// å¤±è´¥å›è°ƒ</span>
    }
  }, <span class="hljs-number">1000</span>);
});

<span class="hljs-comment">// è°ƒç”¨ Promise</span>
asyncTask
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result)) <span class="hljs-comment">// è¾“å‡ºï¼šæ“ä½œæˆåŠŸ</span>
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error))
  .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ“ä½œå®Œæˆ"</span>));
</code></pre>
<h4 data-id="heading-8">æ„é€ å‡½æ•° Promise()</h4>
<p>å…ˆä»æ ¸å¿ƒè¯­å¥è¯´èµ·ï¼Œ <code>new Promise((resolve, reject) =&gt; { ... })</code> è¿™é‡Œäº‹å…³ä¸¤ä¸ªæ¦‚å¿µï¼šæ„é€ å‡½æ•°å’Œ <code>new</code>ã€‚</p>
<p><code>Promise()</code> æ˜¯ä¸€ä¸ªæ„é€ å™¨ï¼ˆConstructorï¼‰æˆ–è€…è¯´æ„é€ å‡½æ•°ï¼Œç”¨äºåˆ›å»º <code>Promise</code> å¯¹è±¡ã€‚</p>
<p>ä½¿ç”¨æ„é€ å‡½æ•°çš„å½¢å¼æ¥åˆ›å»ºå¯¹è±¡æœ‰å‡ ä¸ªå¥½å¤„ï¼š</p>
<ol>
<li>
<p><strong>å°è£…åˆå§‹åŒ–é€»è¾‘</strong>ï¼š<code>Promise</code> æ„é€ å‡½æ•°å†…éƒ¨å°è£…äº†åˆå§‹åŒ– <code>Promise</code> å¯¹è±¡æ‰€éœ€çš„é€»è¾‘ï¼Œæ¯”å¦‚è®¾ç½®åˆå§‹çŠ¶æ€ï¼ˆ<code>pending</code>ï¼‰ã€è®¾ç½®å›è°ƒå‡½æ•°ï¼ˆ<code>resolve</code> å’Œ <code>reject</code>ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å…±äº«æ–¹æ³•</strong>ï¼šé€šè¿‡æ„é€ å‡½æ•°åˆ›å»ºçš„å¯¹è±¡å®ä¾‹å¯ä»¥å…±äº«åŸå‹ä¸Šçš„æ–¹æ³•ï¼ˆå¦‚ <code>then</code>ã€<code>catch</code>ã€<code>finally</code>ï¼‰ï¼Œé¿å…æ¯ä¸ªå®ä¾‹éƒ½åˆ›å»ºä¸€ä»½ç›¸åŒçš„æ–¹æ³•ï¼ŒèŠ‚çœå†…å­˜ã€‚</p>
</li>
<li>
<p><strong>ç«‹å³æ‰§è¡Œ</strong>ï¼šå½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Promise</code> å®ä¾‹æ—¶ï¼Œä¼ å…¥çš„æ‰§è¡Œå™¨å‡½æ•°ï¼ˆexecutor functionï¼‰ä¼šç«‹å³æ‰§è¡Œï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»º <code>Promise</code> çš„åŒæ—¶å¼€å§‹å¼‚æ­¥æ“ä½œã€‚</p>
</li>
</ol>
<p>è€Œ <code>new</code> å…³é”®å­—ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡å®ä¾‹ï¼Œå¹¶å°†å…¶åŸå‹é“¾æ¥åˆ°æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ä¸Šï¼Œä¹Ÿå°±æ˜¯è®©æ–°åˆ›å»ºçš„å¯¹è±¡ç»§æ‰¿æ„é€ å‡½æ•°åŸå‹ä¸Šçš„æ–¹æ³•å’Œå±æ€§ï¼Œç»“åˆä¸Šé¢çš„ä¾‹å­å°±æ˜¯è¯´æˆ‘ä»¬åˆ›å»ºçš„ <code>asyncTask</code> å¯¹è±¡ä¼šç»§æ‰¿ <code>Promise.prototype</code> ä¸Šçš„æ–¹æ³•ï¼Œæ¯”å¦‚ <code>then</code>ã€<code>catch</code> å’Œ <code>finally</code>ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ <code>asyncTask</code> ä¸Šè°ƒç”¨è¿™äº›æ–¹æ³•ï¼Œä»¥åŠè¿›è¡Œå‰é¢æ‰€è¯´çš„é“¾å¼è°ƒç”¨ã€‚</p>
<p>è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œæ‰§è¡Œå™¨å‡½æ•°çš„è¿”å›å€¼å¯¹ <code>Promise</code> çš„å½±å“æœ‰é™ï¼Œåœ¨ <code>then</code> æ–¹æ³•ä¸­æˆ‘ä»¬é€šè¿‡ <code>return</code> æ¥ä¼ é€’å€¼ï¼Œä½†åœ¨æ‰§è¡Œå™¨å‡½æ•°ä¸­ <code>return</code> è¯­å¥ä»…å½±å“æ§åˆ¶æµç¨‹ï¼Œå¹¶ä¸ä¼šç›´æ¥æ”¹å˜ <code>Promise</code> çš„çŠ¶æ€ï¼Œ<code>Promise</code> çš„çŠ¶æ€åªèƒ½é€šè¿‡è°ƒç”¨ <code>resolve</code> æˆ– <code>reject</code> æ¥æ”¹å˜ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> myPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-comment">// ä¸€äº›å¼‚æ­¥æ“ä½œ</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-comment">/* æ“ä½œæˆåŠŸ */</span>) {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">"æˆåŠŸç»“æœ"</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">reject</span>(<span class="hljs-string">"å¤±è´¥åŸå› "</span>);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-string">"è¿™ä¸ªè¿”å›å€¼ä¸ä¼šå½±å“ Promise çš„çŠ¶æ€"</span>;
});
</code></pre>
<h4 data-id="heading-9">å…¥å‚ (resolve, reject) =&gt; { ... }</h4>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹æ„é€ å‡½æ•°çš„å…¥å‚ <code>(resolve, reject) =&gt; { ... }</code> ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œå™¨å‡½æ•°ï¼ˆexecutor functionï¼‰ï¼Œå®ƒä¼šåœ¨ <code>Promise</code> å®ä¾‹åˆ›å»ºæ—¶ç«‹å³æ‰§è¡Œï¼Œè¿™ä¸ªä¸Šé¢è¯´è¿‡äº†ã€‚ä½¿ç”¨ <code>Promise</code> æ—¶ï¼Œæˆ‘ä»¬ä¸ä¼šå…³æ³¨æ‰§è¡Œå™¨å‡½æ•°ï¼Œä¸»è¦æ˜¯ä½¿ç”¨è¿™ä¸ªå‡½æ•°çš„å…¥å‚ <code>resolve</code> å’Œ <code>reject</code> ç”¨æ¥æ”¹å˜ <code>Promise</code> çš„çŠ¶æ€ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">executor</span>(<span class="hljs-params">resolveFunc, rejectFunc</span>) {
  <span class="hljs-comment">// é€šå¸¸ï¼Œ`executor` å‡½æ•°ç”¨äºå°è£…æŸäº›æ¥å—å›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°çš„å¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚ä¸Šé¢çš„ `setTimeout` å‡½æ•°</span>
}
</code></pre>
<p>å½“è°ƒç”¨ <code>resolve</code> æˆ– <code>reject</code> æ—¶ï¼Œ<code>Promise</code> çš„çŠ¶æ€ä¼šç«‹å³æ”¹å˜ï¼Œä» <code>pending</code> å˜ä¸º <code>fulfilled</code> æˆ– <code>rejected</code>ï¼Œç„¶åæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°å°±æ˜¯æˆ‘ä»¬é€šè¿‡ <code>then</code> æ–¹æ³•æ³¨å†Œçš„å‡½æ•°ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1. æ‰§è¡Œå™¨å‡½æ•°ç«‹å³æ‰§è¡Œ'</span>);
  <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æˆåŠŸ'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'2. resolve è°ƒç”¨å®Œæˆï¼ˆåŒæ­¥ï¼‰'</span>);
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'3. Promise åˆ›å»ºå®Œæˆ'</span>);

p.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'5. then å›è°ƒæ‰§è¡Œ:'</span>, value);
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'4. then æ–¹æ³•è°ƒç”¨å®Œæˆ'</span>);

<span class="hljs-comment">// è¾“å‡ºé¡ºåºï¼š</span>
<span class="hljs-comment">// 1. æ‰§è¡Œå™¨å‡½æ•°ç«‹å³æ‰§è¡Œ</span>
<span class="hljs-comment">// 2. resolve è°ƒç”¨å®Œæˆï¼ˆåŒæ­¥ï¼‰</span>
<span class="hljs-comment">// 3. Promise åˆ›å»ºå®Œæˆ</span>
<span class="hljs-comment">// 4. then æ–¹æ³•è°ƒç”¨å®Œæˆ</span>
<span class="hljs-comment">// 5. then å›è°ƒæ‰§è¡Œ: æˆåŠŸ</span>
</code></pre>
<p>ä½†æˆ‘ä»¬ç”¨åˆ° <code>Promise</code> æ—¶ä¸»è¦è¿˜æ˜¯ç”¨äºå¼‚æ­¥ä»»åŠ¡ï¼Œ<code>then</code> æ–¹æ³•æ˜¯å…¸å‹çš„å¾®ä»»åŠ¡ï¼ˆmicrotaskï¼‰ï¼Œå¦‚æœ <code>then</code> æ–¹æ³•å…ˆæ‰§è¡Œï¼Œé‡Œé¢çš„å›è°ƒå‡½æ•°ä¼šè¢«æ”¾å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œç­‰å¾…å½“å‰å®ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åå†æ‰§è¡Œã€‚</p>
<p>å¯¹äºæ›´ç»†è‡´çš„æ‰§è¡Œé¡ºåºï¼Œä¹‹å‰æœ‰å†™è¿‡ä¸€ç¯‡å…³äºäº‹ä»¶å¾ªç¯çš„æ–‡ç« ï¼Œåˆšå¥½æ˜¯ç”¨ <code>Promise</code> ä¸¾ä¾‹ï¼Œå¯ä»¥å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cnblogs.com%2FLFeather%2Fp%2F16139014.html" target="_blank" title="https://www.cnblogs.com/LFeather/p/16139014.html" ref="nofollow noopener noreferrer">æœ‰å…³ JavaScript äº‹ä»¶å¾ªç¯çš„è‹¥å¹²ç–‘é—®æ¢ç©¶</a>ã€‚</p>
<p><code>Promise</code> å†…éƒ¨çš„å¤§è‡´é€»è¾‘æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// Promise å†…éƒ¨ç®€åŒ–å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyPromise</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">executor</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">'pending'</span>;           <span class="hljs-comment">// çŠ¶æ€</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">undefined</span>;           <span class="hljs-comment">// ç»“æœå€¼</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledCallbacks</span> = [];   <span class="hljs-comment">// â† å­˜å‚¨ then çš„æˆåŠŸå›è°ƒ</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedCallbacks</span> = [];    <span class="hljs-comment">// â† å­˜å‚¨ then çš„å¤±è´¥å›è°ƒ</span>

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">resolve</span> = (<span class="hljs-params">value</span>) =&gt; {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> === <span class="hljs-string">'pending'</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">'fulfilled'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;
        <span class="hljs-comment">// â† å…³é”®ï¼šéå†å›è°ƒé˜Ÿåˆ—ï¼Œå°†æ‰€æœ‰å›è°ƒåŠ å…¥å¾®ä»»åŠ¡</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledCallbacks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">callback</span> =&gt;</span> {
          <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">callback</span>(value));
        });
      }
    };

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">reject</span> = (<span class="hljs-params">reason</span>) =&gt; {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> === <span class="hljs-string">'pending'</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-string">'rejected'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = reason;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedCallbacks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">callback</span> =&gt;</span> {
          <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">callback</span>(reason));
        });
      }
    };

    <span class="hljs-title function_">executor</span>(resolve, reject);
  }

  <span class="hljs-title function_">then</span>(<span class="hljs-params">onFulfilled, onRejected</span>) {
    <span class="hljs-comment">// å¦‚æœ Promise è¿˜æ˜¯ pendingï¼Œå°±æŠŠå›è°ƒå­˜èµ·æ¥</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> === <span class="hljs-string">'pending'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledCallbacks</span>.<span class="hljs-title function_">push</span>(onFulfilled);  <span class="hljs-comment">// â† å­˜å‚¨å›è°ƒ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedCallbacks</span>.<span class="hljs-title function_">push</span>(onRejected);
    }
    <span class="hljs-comment">// å¦‚æœ Promise å·²ç» fulfilledï¼Œç«‹å³å°†å›è°ƒåŠ å…¥å¾®ä»»åŠ¡</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> === <span class="hljs-string">'fulfilled'</span>) {
      <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">onFulfilled</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>));
    }
    <span class="hljs-comment">// å¦‚æœ Promise å·²ç» rejected</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> === <span class="hljs-string">'rejected'</span>) {
      <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">onRejected</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>));
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyPromise</span>(<span class="hljs-function">() =&gt;</span> {}); <span class="hljs-comment">// ç®€åŒ–ï¼Œå®é™…æ›´å¤æ‚</span>
  }
}
</code></pre>
<p>æ‰€ä»¥ <code>then</code> ä¸­çš„å›è°ƒå‡½æ•°è¢«æ‰§è¡Œçš„å‰ææ˜¯ <code>resolve</code> æˆ– <code>reject</code> è¢«è°ƒç”¨å¹¶ä¸” <code>then</code> æ–¹æ³•ä¹Ÿè¢«è°ƒç”¨ï¼Œè¿™ä¹Ÿæ˜¯ <code>Promise</code> èƒ½å¤„ç†å¼‚æ­¥æ“ä½œçš„å…³é”®ã€‚</p>
<h4 data-id="heading-10">é™æ€æ–¹æ³•</h4>
<p>ç®€å•æä¸€ä¸‹ï¼Œé™æ€æ–¹æ³•æ˜¯ç›´æ¥æŒ‚è½½åœ¨æ„é€ å‡½æ•°ä¸Šçš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯å®ä¾‹å¯¹è±¡ä¸Šï¼Œä»¥å‰é¢çš„ä¾‹å­æ¥è¯´ï¼Œ<code>asyncTask</code> æ˜¯ <code>Promise</code> çš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œè€Œ <code>Promise.all(..)</code> å’Œ <code>Promise.resolve(..)</code> è¿™ç§åˆ™æ˜¯ <code>Promise</code> æ„é€ å‡½æ•°çš„ä¸€ä¸ªé™æ€æ–¹æ³•ã€‚</p>
<p>åŸºäºä¸Šé¢çš„ç®€å•ä¾‹å­ï¼Œ<code>Promise</code> å¤§ä½“ä¸Šçš„ç”¨æ³•æˆ‘ä»¬å·²ç»äº†è§£äº†ï¼Œä½†è¿˜æœ‰å¾ˆå¤š API æ²¡æœ‰æ¶‰åŠåˆ°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰“å° <code>Promise</code> çš„åŸå‹æ¥æŸ¥çœ‹ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Promise</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/138aaa75ea604f16b7318d83fe94cdde~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSc5bC95Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770951014&amp;x-signature=2LOlRGlB9OqcoDn2%2FskbksmcKJg%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>then</code>ã€<code>catch</code> å’Œ <code>finally</code> æ–¹æ³•éƒ½åœ¨ <code>Promise.prototype</code> ä¸Šï¼Œè¿™äº›æ–¹æ³•æ˜¯å®ä¾‹æ–¹æ³•ï¼Œæ„å‘³ç€å®ƒä»¬å¯ä»¥è¢«ä»»ä½• <code>Promise</code> å®ä¾‹è°ƒç”¨ã€‚</p>
<p>ç”±äºå®‰å…¨æœºåˆ¶ï¼Œç›´æ¥æ‰“å° <code>Promise</code> æœ¬èº«æ˜¯çœ‹ä¸åˆ°åŸç”Ÿä»£ç çš„ï¼Œæˆ‘ä»¬æ¢ä¸€ç§æ–¹å¼ï¼Œåªéœ€è¦å¾—åˆ°é™æ€æ–¹æ³•åå°±è¡Œï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyNames</span>(<span class="hljs-title class_">Promise</span>));

<span class="hljs-comment">// è¾“å‡ºï¼š['length', 'name', 'prototype', 'all', 'allSettled', 'any', 'race', 'resolve', 'reject', 'withResolvers', 'try']</span>
</code></pre>
<p>è¾“å‡ºç»“æœä¸­æœ‰çš„ç†Ÿæ‚‰æœ‰çš„ä¸ç†Ÿæ‚‰ï¼Œå› ä¸ºæˆ‘ä¹‹å‰å¯¹ <code>Promise</code> ä»…åœç•™åœ¨ä¼šç”¨çš„å±‚é¢ï¼Œæ‰€ä»¥æœ‰äº›æˆ‘ç”šè‡³æ˜¯ç¬¬ä¸€æ¬¡çŸ¥é“ï¼Œä½†æ²¡å…³ç³»ï¼Œé€šè¿‡åŸå‹å†å¯¹ç…§ MDN æ–‡æ¡£ï¼Œé€ä¸ªå­¦ä¹ ä¸€ä¸‹ã€‚ <code>length</code>ã€<code>name</code> å’Œ <code>prototype</code> æ˜¯å‡½æ•°å¯¹è±¡çš„é»˜è®¤å±æ€§ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨å…¶ä»–çš„é™æ€æ–¹æ³•ï¼š</p>
<ol>
<li><code>Promise.resolve(..)</code> å’Œ <code>Promise.reject(..)</code></li>
</ol>
<p>è¿™ä¸¤ä¸ªæ–¹æ³•åº”è¯¥æ˜¯æœ€å¸¸è§çš„äº†ï¼Œä¸Šé¢çš„ä¾‹å­ä¸­ä¹Ÿç”¨åˆ°è¿‡ï¼Œ<code>reject</code> æ¯”è¾ƒç®€å•ï¼Œè¿”å›ä¸€ä¸ªæ‹’ç»çŠ¶æ€çš„ <code>Promise</code> å¯¹è±¡ï¼Œå…¥å‚å°±æ˜¯æ‹’ç»çš„åŸå› ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> promiseReject = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"å¤±è´¥åŸå› "</span>));
promiseReject.<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reason.<span class="hljs-property">message</span>);
  <span class="hljs-comment">// Expected output: å¤±è´¥åŸå› </span>
});

<span class="hljs-comment">// æˆ–è€…</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">resolved</span>(<span class="hljs-params">result</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Resolved"</span>);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">rejected</span>(<span class="hljs-params">result</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Rejected:"</span>, result);
}

<span class="hljs-keyword">const</span> promiseReject2 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-string">"å¤±è´¥åŸå› "</span>);
promiseReject2.<span class="hljs-title function_">then</span>(resolved, rejected);
</code></pre>
<p><code>resolve</code> æ–¹æ³•åˆ™æ¯”è¾ƒå¤æ‚ä¸€äº›ï¼Œå®ƒæœ‰ä¸¤ç§è¿”å›å½¢å¼ï¼š1. å¦‚æœå…¥å‚æ˜¯ä¸€ä¸ªæ™®é€šå€¼ï¼ˆé <code>Promise</code> å¯¹è±¡ï¼‰ï¼Œåˆ™è¿”å›ä¸€ä¸ªä»¥è¯¥å€¼ä¸ºç»“æœçš„å·²è§£å†³ï¼ˆ<code>fulfilled</code>ï¼‰çŠ¶æ€çš„ <code>Promise</code> å¯¹è±¡ï¼Œè¿™ä¸€ç‚¹ä¸ <code>reject</code> å¯¹åº”ï¼›2. å¦‚æœå…¥å‚æ˜¯ä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼Œåˆ™è¿”å›è¯¥ <code>Promise</code> å¯¹è±¡æœ¬èº«ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// å…¥å‚æ˜¯æ™®é€šå€¼</span>
<span class="hljs-keyword">const</span> promise1 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">123</span>);

promise1.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value);
  <span class="hljs-comment">// Expected output: 123</span>
});

<span class="hljs-comment">// å…¥å‚æ˜¯ Promise å¯¹è±¡</span>
<span class="hljs-keyword">const</span> originalPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">"åŸå§‹ Promise ç»“æœ"</span>);
  }, <span class="hljs-number">1000</span>);
});

<span class="hljs-keyword">const</span> promise2 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(originalPromise);
promise2.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value);
  <span class="hljs-comment">// Expected output: åŸå§‹ Promise ç»“æœ</span>
});
</code></pre>
<ol start="2">
<li><code>Promise.all(..)</code>ã€<code>Promise.race(..)</code>ã€<code>Promise.allSettled(..)</code> å’Œ <code>Promise.any(..)</code></li>
</ol>
<p>è¿™å››ä¸ªæˆ‘è§‰å¾—å¯ä»¥æ”¾ä¸€èµ·ä»‹ç»ï¼Œå®ƒä»¬éƒ½æ˜¯ç”¨äºå¤„ç†å¤šä¸ª <code>Promise</code> å¯¹è±¡çš„é™æ€æ–¹æ³•ï¼Œå…¥å‚éƒ½æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼ˆé€šå¸¸æ˜¯æ•°ç»„ï¼‰ï¼ŒåŒ…å«å¤šä¸ª <code>Promise</code> å¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ <code>Promise</code> å¯¹è±¡ï¼Œå…¶ä»–çš„åŒºåˆ«ç”¨ä¸€å¼ è¡¨æ ¼æ¥è¯´æ˜ï¼š</p>






























<table><thead><tr><th>æ–¹æ³•</th><th>æè¿°</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>Promise.all(..)</code></td><td>å…¨æˆåŠŸæ‰æˆåŠŸï¼Œä¸€å¤±è´¥å°±å¤±è´¥ã€‚</td><td>æˆåŠŸæ—¶è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰ç»“æœçš„æ•°ç»„ï¼Œå¤±è´¥æ—¶è¿”å›ç¬¬ä¸€ä¸ªå¤±è´¥çš„åŸå› ã€‚</td></tr><tr><td><code>Promise.allSettled(..)</code></td><td>ç­‰æ‰€æœ‰å®Œæˆï¼Œæ— è®ºæˆè´¥ã€‚</td><td>ç»“æœæ˜¯ä¸€ä¸ªåŒ…å«æ¯ä¸ª <code>Promise</code> ç»“æœçŠ¶æ€çš„æ•°ç»„ã€‚</td></tr><tr><td><code>Promise.any(..)</code></td><td>ä¸€æˆåŠŸå°±æˆåŠŸï¼Œå…¨å¤±è´¥æ‰å¤±è´¥ã€‚</td><td>æˆåŠŸæ—¶è¿”å›ç¬¬ä¸€ä¸ªæˆåŠŸçš„ç»“æœï¼Œå¤±è´¥æ—¶è¿”å›ä¸€ä¸ª <code>AggregateError</code>ï¼ŒåŒ…å«æ‰€æœ‰å¤±è´¥çš„åŸå› ã€‚</td></tr><tr><td><code>Promise.race(..)</code></td><td>è°å…ˆå®Œæˆï¼ˆæˆè´¥å‡å¯ï¼‰ï¼Œå°±ç”¨è°çš„ç»“æœã€‚</td><td>ç»“æœæ˜¯ç¬¬ä¸€ä¸ªè§£å†³æˆ–æ‹’ç»çš„ <code>Promise</code> çš„ç»“æœæˆ–åŸå› ã€‚</td></tr></tbody></table>
<p>å…³äº <code>Promise.all(..)</code> çš„åº”ç”¨ï¼Œæˆ‘ä»¬æœ€å¼€å§‹çš„å›è°ƒå‡½æ•°å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥é‡å†™ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchX</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-number">2</span>);
    }, <span class="hljs-number">1000</span>);
  });
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchY</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-number">3</span>);
    }, <span class="hljs-number">1000</span>);
  });
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([<span class="hljs-title function_">fetchX</span>(), <span class="hljs-title function_">fetchY</span>()]).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">[x, y]</span>) =&gt;</span> x + y);
}

<span class="hljs-title function_">add</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">sum</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Sum is: "</span> + sum); <span class="hljs-comment">// è¾“å‡ºï¼šSum is: 5</span>
});
</code></pre>
<p>å¦‚æœæœ‰ä¸‰ä¸ªå¼‚æ­¥æ“ä½œï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchZ</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">resolve</span>(<span class="hljs-number">4</span>);
    }, <span class="hljs-number">1000</span>);
  });
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">addThree</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([<span class="hljs-title function_">fetchX</span>(), <span class="hljs-title function_">fetchY</span>(), <span class="hljs-title function_">fetchZ</span>()]).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">[x, y, z]</span>) =&gt;</span> x + y + z);
}
</code></pre>
<p>MDNä¸Šçš„ <code>Promise.allSettled(..)</code> ä¾‹å­ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">allSettled</span>([
  <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">33</span>),
  <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-number">66</span>), <span class="hljs-number">0</span>)),
  <span class="hljs-number">99</span>,
  <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"ä¸€ä¸ªé”™è¯¯"</span>)),
]).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">values</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(values));

<span class="hljs-comment">// [</span>
<span class="hljs-comment">//   { status: 'fulfilled', value: 33 },</span>
<span class="hljs-comment">//   { status: 'fulfilled', value: 66 },</span>
<span class="hljs-comment">//   { status: 'fulfilled', value: 99 },</span>
<span class="hljs-comment">//   { status: 'rejected', reason: Error: ä¸€ä¸ªé”™è¯¯ }</span>
<span class="hljs-comment">// ]</span>
</code></pre>
<p>è¿™é‡Œçš„è¿”å›å€¼æœ‰äº›ä¸åŒï¼Œæ˜¯ä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼Œæ¯ä¸ªå¯¹è±¡è¡¨ç¤ºå¯¹åº” <code>Promise</code> çš„çŠ¶æ€å’Œç»“æœã€‚</p>
<p><code>Promise.any(..)</code> çš„è¿”å›å€¼æ˜¯ç¬¬ä¸€ä¸ªæˆåŠŸçš„ç»“æœï¼Œå¦‚æœæ‰€æœ‰ <code>Promise</code> éƒ½å¤±è´¥äº†ï¼Œåˆ™è¿”å›ä¸€ä¸ª <code>AggregateError</code>ï¼Œå®ƒåŒ…å«æ‰€æœ‰å¤±è´¥çš„åŸå› ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> promiseA = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-string">"å¤±è´¥åŸå›  A"</span>);
<span class="hljs-keyword">const</span> promiseB = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-string">"å¤±è´¥åŸå›  B"</span>);

<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">any</span>([promiseA, promiseB])
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value);
  })
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error);
  });

<span class="hljs-comment">// è¾“å‡ºï¼šAggregateError: All promises were rejected</span>
</code></pre>
<p>ä¸å…¶ä»–ä¸‰ä¸ªæ–¹æ³•ä¸åŒï¼Œ<code>Promise.race(..)</code> è¿”å›çš„ <code>Promise</code> çŠ¶æ€çš„æ•²å®šæ€»æ˜¯å¼‚æ­¥çš„ï¼Œå‰é¢çš„ä¸‰ç§æ–¹æ³•å…¥å‚çš„ <code>Promise</code> æ•°ç»„ä¸­æœ‰ä¸€ä¸ªç”šè‡³å¤šä¸ªæ˜¯å·²ç»è§£å†³ï¼ˆ<code>fulfilled</code>ï¼‰æˆ–æ‹’ç»ï¼ˆ<code>rejected</code>ï¼‰çš„ <code>Promise</code> å¯¹è±¡ï¼ˆç®€å•æ¥è¯´ï¼Œå’Œä¸Šé¢çš„å¤§éƒ¨åˆ†ä¾‹å­ä¸€æ ·ï¼Œæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªç¡®å®šçš„å€¼è€Œä¸æ˜¯å¼‚æ­¥æ–¹æ³•ï¼‰ï¼Œé‚£ä¹ˆ <code>Promise.all(..)</code>ã€<code>Promise.allSettled(..)</code> å’Œ <code>Promise.any(..)</code> ä¼šç«‹å³è¿”å›ç»“æœï¼Œè€Œ <code>Promise.race(..)</code> çš„è¿”å›å€¼åˆ™æ˜¯å¼‚æ­¥çš„ã€‚</p>
<p>MDN é’ˆå¯¹æ¯ä¸ªæ–¹æ³•çš„è¿”å›å€¼éƒ½æœ‰è¯¦ç»†çš„è¯´æ˜ï¼Œæ¯”å¦‚è¯´ <code>Promise.all(..)</code> ï¼Œå¦‚æœä¼ å…¥çš„å‚æ•°ä¸ºç©ºï¼Œåˆ™å®ƒçš„çŠ¶æ€ä¼šç«‹å³å˜ä¸º <strong>å·²è§£å†³ï¼ˆ<code>fulfilled</code>ï¼‰</strong> å¦å¤–ä¸¤ç§è¿”å›çŠ¶æ€åˆ™ä¸º <strong>å¼‚æ­¥å…‘ç°ï¼ˆasynchronously fulfilledï¼‰</strong> å’Œ <strong>å¼‚æ­¥æ‹’ç»ï¼ˆasynchronously rejectedï¼‰</strong> ï¼Œè€Œ <code>Promise.any(..)</code> åˆ™æ˜¯ç›¸åçš„ï¼Œå¦‚æœä¼ å…¥çš„å‚æ•°ä¸ºç©ºï¼Œåˆ™å®ƒçš„çŠ¶æ€ä¼šç«‹å³å˜ä¸º <strong>å·²æ‹’ç»ï¼ˆ<code>rejected</code>ï¼‰</strong>ï¼Œå…¶ä»–æƒ…å†µéƒ½æ˜¯å¼‚æ­¥çš„ã€‚</p>
<p>å‘ <code>Promise.race(..)</code> ä¼ å…¥ä¸€ä¸ªç©ºçš„å¯è¿­ä»£å¯¹è±¡ä¼šå¯¼è‡´è¿”å›çš„ <code>Promise</code> æ°¸è¿œå¤„äºæŒ‚èµ·çŠ¶æ€ï¼ˆ<code>pending</code>ï¼‰ï¼Œå› ä¸ºæ²¡æœ‰ä»»ä½• <code>Promise</code> å¯ä»¥å…‘ç°æˆ–æ‹’ç»ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> foreverPendingPromise = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>([]);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(foreverPendingPromise);
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å †æ ˆç°åœ¨ä¸ºç©º"</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(foreverPendingPromise);
});

<span class="hljs-comment">// æŒ‰é¡ºåºæ‰“å°ï¼š</span>
<span class="hljs-comment">// Promise { &lt;state&gt;: "pending" }</span>
<span class="hljs-comment">// å †æ ˆç°åœ¨ä¸ºç©º</span>
<span class="hljs-comment">// Promise { &lt;state&gt;: "pending" }</span>
</code></pre>
<p><code>Promise.race(..)</code> çš„å¼‚æ­¥æ€§æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç½‘ç»œè¯·æ±‚æ“ä½œï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ä¸€å®šæ—¶é—´å†…è·å¾—å“åº”ï¼Œå¦åˆ™å°±æ”¾å¼ƒè¯·æ±‚ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>Promise.race(..)</code> æ¥å®ç°è¶…æ—¶æ§åˆ¶ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> data = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>([
  <span class="hljs-title function_">fetch</span>(<span class="hljs-string">"/api"</span>),
  <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-comment">// 5 ç§’åæ‹’ç»</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"è¯·æ±‚è¶…æ—¶"</span>)), <span class="hljs-number">5000</span>);
  }),
])
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> res.<span class="hljs-title function_">json</span>())
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-title function_">displayError</span>(err));
</code></pre>
<ol start="3">
<li><code>Promise.try()</code></li>
</ol>
<blockquote>
<p><code>Promise.try()</code> é™æ€æ–¹æ³•æ¥å—ä¸€ä¸ªä»»æ„ç±»å‹çš„å›è°ƒå‡½æ•°ï¼ˆæ— è®ºå…¶æ˜¯åŒæ­¥æˆ–å¼‚æ­¥ï¼Œè¿”å›ç»“æœæˆ–æŠ›å‡ºå¼‚å¸¸ï¼‰ï¼Œå¹¶å°†å…¶ç»“æœå°è£…æˆä¸€ä¸ª <code>Promise</code>ã€‚</p>
</blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªæˆªæ­¢åˆ°ç›®å‰ï¼ˆ2026å¹´2æœˆï¼‰ä»åœ¨ææ¡ˆé˜¶æ®µçš„ APIï¼Œåœ¨ä¸€äº›ç°ä»£æµè§ˆå™¨å’Œ Node.js æœ€æ–°ç‰ˆæœ¬ä¸­å·²ç»å¯ä»¥ä½¿ç”¨ï¼Œä½œç”¨ç±»ä¼¼äº <code>async</code> å‡½æ•°ï¼Œå¯ä»¥å°†åŒæ­¥ä»£ç å’Œå¼‚æ­¥ä»£ç ç»Ÿä¸€å¤„ç†ä¸º <code>Promise</code> å¯¹è±¡ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">try</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// è¿™é‡Œå¯ä»¥æ˜¯åŒæ­¥ä»£ç </span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">synchronousFunction</span>();
  <span class="hljs-keyword">return</span> result;
})
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"åŒæ­¥ç»“æœ:"</span>, value);
  })
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"é”™è¯¯:"</span>, error);
  });
<span class="hljs-comment">// ä¹Ÿå¯ä»¥æ˜¯å¼‚æ­¥ä»£ç </span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">try</span>(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">asynchronousFunction</span>();
  <span class="hljs-keyword">return</span> result;
})
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å¼‚æ­¥ç»“æœ:"</span>, value);
  })
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"é”™è¯¯:"</span>, error);
  });
</code></pre>
<ol start="4">
<li><code>Promise.withResolvers()</code></li>
</ol>
<blockquote>
<p><code>Promise.withResolvers()</code> é™æ€æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶åŒ…å«ä¸€ä¸ªæ–°çš„ <code>Promise</code> å¯¹è±¡å’Œä¸¤ä¸ªå‡½æ•°ï¼Œç”¨äºè§£å†³æˆ–æ‹’ç»å®ƒï¼Œå¯¹åº”äºä¼ å…¥ç»™ <code>Promise()</code> æ„é€ å‡½æ•°æ‰§è¡Œå™¨çš„ä¸¤ä¸ªå‚æ•°ã€‚</p>
</blockquote>
<p>å®ƒå®Œå…¨ç­‰ä»·äºä¸‹é¢çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">let</span> resolve, reject;
<span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">res, rej</span>) =&gt;</span> {
  resolve = res;
  reject = rej;
});
</code></pre>
<p>å®ƒçš„ä½œç”¨æ˜¯ç®€åŒ–åˆ›å»ºä¸€ä¸ªå¯æ§çš„ <code>Promise</code> å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¤–éƒ¨è°ƒç”¨ <code>resolve</code> å’Œ <code>reject</code> æ¥æ”¹å˜ <code>Promise</code> çš„çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> { promise, resolve, reject } = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">withResolvers</span>();
<span class="hljs-comment">// æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> success = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">if</span> (success) {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">"æ“ä½œæˆåŠŸ"</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">reject</span>(<span class="hljs-string">"æ“ä½œå¤±è´¥"</span>);
  }
}, <span class="hljs-number">1000</span>);
promise
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result))
  .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error))
  .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ“ä½œå®Œæˆ"</span>));
</code></pre>
<p>è¿™ä¸ª API çš„ä½¿ç”¨åœºæ™¯æ¯”è¾ƒå°‘è§ï¼Œç›®å‰æˆ‘è¿˜ä¸èƒ½å®Œå…¨ç†è§£å®ƒçš„ä½œç”¨ï¼Œæ„Ÿå…´è¶£å¯ä»¥åˆ° MDN ä¸ŠæŸ¥çœ‹ã€‚</p>
<h2 data-id="heading-11">async/await ä¸ Promise</h2>
<p>æœ€å¼€å§‹å°±è¯´åˆ° <code>async/await</code> äº†ï¼Œæˆ‘æ˜¯å…ˆæ¥è§¦åˆ° <code>async/await</code> è¿™ç§å†™æ³•çš„ï¼Œç„¶åæ‰äº†è§£åˆ°å®ƒæ˜¯åŸºäº <code>Promise</code> çš„è¯­æ³•ç³–ï¼Œä¸ªäººç†è§£æ¥è¯´ï¼Œ<code>async/await</code> è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥æ›´åƒåŒæ­¥ä»£ç ï¼Œä¸»è¦æ˜¯æé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œå°±åƒ <code>Promise</code> ä¹‹äºå›è°ƒå‡½æ•°ä¸€æ ·ã€‚</p>
<p>åœ¨ä½¿ç”¨ä¸Šï¼Œ<code>async/await</code> çš„äº‰è®®é›†ä¸­åœ¨æ˜¯å¦è¦ä½¿ç”¨ <code>try/catch</code> æ¥å¤„ç†é”™è¯¯ï¼Œæˆ‘ä¹‹å‰çš„å¤„ç†æ–¹å¼æ˜¯åœ¨è¯·æ±‚çš„å°è£…é‡Œä½¿ç”¨ <code>try/catch</code> æ¥æ•è·é”™è¯¯ï¼Œè°ƒç”¨æ—¶æ­£å¸¸ä½¿ç”¨ <code>async/await</code> ï¼Œå…¶ä»–åœ°æ–¹å¤„ç†å¼‚æ­¥æ“ä½œè¿˜æ˜¯ç›´æ¥ä½¿ç”¨ <code>Promise</code>ã€‚ä»¥å‰å…¶å®æ²¡æœ‰å¤ªæ·±å…¥è€ƒè™‘è¿‡åˆç†æ€§çš„é—®é¢˜ï¼Œåœ¨æ–°å…¬å¸çœ‹ä»£ç è§„èŒƒæ—¶å‘ç°ä»–ä»¬æœ‰é’ˆå¯¹è¿™ä¸ªé—®é¢˜è®¨è®ºè¿‡ï¼Œæ‰æ„è¯†åˆ°è¿™ä¸ªé—®é¢˜çš„é‡è¦æ€§ã€‚å…³äºè¿™ä¸ªé—®é¢˜äº‰è®®æ¯”è¾ƒå¤§ï¼Œè€Œä¸”å…³äº <code>async/await</code> å®Œå…¨å¯ä»¥å•ç‹¬å†™ä¸€ç¯‡ï¼Œè¿™ç¯‡ä¸»è¦è¿˜æ˜¯é’ˆå¯¹ <code>Promise</code> çš„å­¦ä¹ è®°å½•ï¼Œå†å†™ä¸‹å»ä¹Ÿæœ‰äº›è¶…ç¯‡å¹…äº†ï¼Œä¹‹åå­¦ä¹ æ—¶åº”è¯¥è¿˜ä¼šå†èŠåˆ°ã€‚</p>
<h2 data-id="heading-12">ç¼ºé™·</h2>
<p>è¿™ä¸ªéƒ¨åˆ†å¯¹äºæˆ‘æ¥è¯´è¿˜æ˜¯æœ‰äº›è¶…çº²äº†ï¼Œä½†ä¹Ÿæœ‰å‚è€ƒèµ„æ–™ï¼Œåˆ—ä¸€ä¸‹ã€Šä½ ä¸çŸ¥é“çš„JavaScriptã€‹ä¸­å·æåˆ°çš„å‡ ä¸ªç¼ºé™·ï¼Œä¸è¿‡è¿™äº›çº¸è´¨ä¹¦æœ‰ä¸€å®šçš„æ—¶ä»£æ€§ï¼Œå†…å®¹ä»…ä¾›å‚è€ƒï¼š</p>
<ol>
<li><strong>é¡ºåºé”™è¯¯å¤„ç†</strong>ï¼š å¦‚æœæ„å»ºäº†ä¸€ä¸ªæ²¡æœ‰é”™è¯¯å¤„ç†å‡½æ•°çš„Promiseé“¾ï¼Œé“¾ä¸­åç»­çš„ <code>then</code> ä»ç„¶ä¼šè¢«æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´é”™è¯¯è¢«å¿½ç•¥æˆ–å¤„ç†ä¸å½“ã€‚</li>
<li><strong>å•ä¸€å€¼</strong>ï¼š <code>Promise</code> åªèƒ½å¤„ç†å•ä¸€å€¼çš„ä¼ é€’ï¼Œæ— æ³•ç›´æ¥å¤„ç†å¤šä¸ªå€¼æˆ–å¤æ‚çš„æ•°æ®ç»“æ„ï¼ˆå¯ä»¥ä¼ é€’å°è£…çš„å¯¹è±¡ï¼Œä½†å¦‚æœåœ¨é“¾ä¸­çš„æ¯ä¸€æ­¥éƒ½è¿›è¡Œå°è£…å’Œè§£å°ï¼Œå°±æœ‰äº›ç¬¨é‡äº†ï¼‰ã€‚</li>
<li><strong>å•å†³è®®</strong>ï¼š <code>Promise</code> ä¸€æ—¦è¢«è§£å†³ï¼ˆ<code>fulfilled</code>ï¼‰æˆ–æ‹’ç»ï¼ˆ<code>rejected</code>ï¼‰ï¼Œå…¶çŠ¶æ€å°±ä¸èƒ½å†æ”¹å˜ï¼Œæ— æ³•é‡æ–°è§£å†³æˆ–æ‹’ç»ã€‚</li>
<li><strong>æƒ¯æ€§</strong>ï¼š æ—¶ä»£æ€§çš„ä½“ç°ï¼Œè€ƒè™‘å½“æ—¶çš„ç¯å¢ƒ <code>Promise</code> è¿˜æœªæ™®åŠï¼Œç°åœ¨åº”è¯¥å¯ä»¥å¿½ç•¥è¿™ä¸€ç‚¹äº†ã€‚</li>
<li><strong>ä¸å¯å–æ¶ˆ</strong>ï¼š ä¸€æ—¦åˆ›å»ºï¼Œ<code>Promise</code> å°±ä¼šä¸€ç›´æ‰§è¡Œï¼Œæ— æ³•å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„å¼‚æ­¥æ“ä½œã€‚è¿™ä¸ªä¹Ÿæœ‰äº›æ—¶ä»£æ€§äº†ï¼Œç°åœ¨æœ‰ <code>AbortController</code> å¯ä»¥é…åˆ <code>fetch</code> æ¥å®ç°å–æ¶ˆè¯·æ±‚çš„åŠŸèƒ½ã€‚</li>
<li><strong>æ€§èƒ½</strong>ï¼š ç›¸è¾ƒäºå›è°ƒå‡½æ•°ï¼Œ<code>Promise</code> åœ¨åˆ›å»ºå’Œç®¡ç†çŠ¶æ€æ–¹é¢æœ‰ä¸€å®šçš„æ€§èƒ½å¼€é”€ï¼Œä½†ä¸ªäººè®¤ä¸ºè¿™åœ¨é€šå¸¸çš„åº”ç”¨åœºæ™¯ä¸­å½±å“ä¸å¤§ã€‚</li>
</ol>
<h2 data-id="heading-13">æ€»ç»“</h2>
<p>è¯´å®è¯åŠ¨ç¬”ä¹‹å‰å°±æ˜¯è§‰å¾—åº”è¯¥å†™ä¸€ç¯‡å…³äº <code>Promise</code> çš„ï¼Œä½†å¼€å§‹å†™ä¹‹åå‘ç°æ²¡ä»€ä¹ˆæ–¹å‘ï¼Œç›¸å…³èµ„æ–™ä¹Ÿæ˜¯æµ©å¦‚çƒŸæµ·ï¼Œå†™è¿™ç¯‡è€—è´¹äº†éå¸¸å¤šçš„æ—¶é—´ï¼Œå¼€å§‹ä¸æ–­åœ°æ·±æŒ–ç»†èŠ‚åæ„Ÿè§‰æœ‰æ— ç©·æ— å°½çš„é—®é¢˜ï¼Œå¥½åœ¨ç°åœ¨é€šè¿‡ AI è‡³å°‘å¯ä»¥æŠŠè¿™äº›é—®é¢˜å¤§è‡´ç†æ¸…æ¥šï¼Œ"å¤§è‡´"ç†è§£è¯´æ˜è¿˜æœ‰å¾ˆå¤šå†…å®¹æ²¡æœ‰æ¶‰åŠï¼Œä¹‹ååœ¨é¡¹ç›®ä¸­åº”è¯¥ä¼šæ›´åŠ æ³¨æ„ <code>Promise</code> çš„åº”ç”¨ï¼Œç„¶åæŠŠã€Šä½ ä¸çŸ¥é“çš„JavaScriptã€‹çš„ç›¸å…³å†…å®¹çœ‹å®Œç»“åˆä¸€ä¸‹åº”è¯¥è¿˜å¯ä»¥å†æ°´ä¸€ç¯‡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaç¨‹åºå‘˜å¿…åšé¡¹ç›®ï¼åŸºäºLangChainå®ç°çš„ReActæ™ºèƒ½ä½“é¡¹ç›®ã€‚åŠ©ä½ æ‹¿offerï¼ï¼ˆç¬¬ä¸‰æœŸï¼‰]]></title>    <link>https://juejin.cn/post/7603238967290986548</link>    <guid>https://juejin.cn/post/7603238967290986548</guid>    <pubDate>2026-02-06T02:20:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603238967290986548" data-draft-id="7603238967290921012" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaç¨‹åºå‘˜å¿…åšé¡¹ç›®ï¼åŸºäºLangChainå®ç°çš„ReActæ™ºèƒ½ä½“é¡¹ç›®ã€‚åŠ©ä½ æ‹¿offerï¼ï¼ˆç¬¬ä¸‰æœŸï¼‰"/> <meta itemprop="keywords" content="åç«¯,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-02-06T02:20:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ„Ÿæ€§çš„ç¨‹åºå‘˜å°ç‹"/> <meta itemprop="url" content="https://juejin.cn/user/1915806770272506"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaç¨‹åºå‘˜å¿…åšé¡¹ç›®ï¼åŸºäºLangChainå®ç°çš„ReActæ™ºèƒ½ä½“é¡¹ç›®ã€‚åŠ©ä½ æ‹¿offerï¼ï¼ˆç¬¬ä¸‰æœŸï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1915806770272506/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ„Ÿæ€§çš„ç¨‹åºå‘˜å°ç‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T02:20:24.000Z" title="Fri Feb 06 2026 02:20:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">4ã€æ–‡æ¡£æ£€ç´¢bugä¿®å¤</h4>
<p>å¯ä»¥çœ‹åˆ°ï¼Œllmæ ¹æ®çŸ¥è¯†åº“æ–‡æ¡£æ£€ç´¢å‡ºäº†å†…å®¹å¹¶ç»™å‡ºäº†ç­”æ¡ˆï¼Œä½†æ˜¯ä¼šå‘ç°ï¼Œä¸ºä»€ä¹ˆæ£€ç´¢çš„å››ç¯‡ç›¸å…³çš„æ–‡æ¡£éƒ½æ˜¯åŒä¸€ç‰‡æ–‡æ¡£å‘¢ï¼Ÿ</p>
<p>æ ¹æœ¬åŸå› å°±åœ¨äºï¼šæ ¹æœ¬åŸå› åœ¨äºï¼š</p>
<blockquote>
<p><strong>æˆ‘ä»¬çš„æ–‡æ¡£åœ¨åˆ†å—ï¼ˆtext splittingï¼‰æ—¶ï¼Œè¢«åˆ‡æˆäº†å¤šä¸ªé‡å æˆ–é«˜åº¦ç›¸ä¼¼çš„ chunkï¼Œè€Œè¿™äº› chunk éƒ½è¢«å‘é‡åŒ–å¹¶å­˜å…¥äº†å‘é‡æ•°æ®åº“ã€‚æ£€ç´¢æ—¶ï¼Œå®ƒä»¬éƒ½ä¸æŸ¥è¯¢é«˜åº¦ç›¸ä¼¼ï¼Œå› æ­¤éƒ½è¢«è¿”å›äº†ã€‚</strong></p>
</blockquote>
<p>æˆ‘ä»¬çš„<code>java-thread-pool.md</code> æ–‡ä»¶å¼€å¤´æ˜¯ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># Java çº¿ç¨‹æ± æœ€ä½³å®è·µ Â </span>
<span class="hljs-section">## åœºæ™¯ä¸ç›®æ ‡ Â </span>
<span class="hljs-bullet">-</span> ç»Ÿä¸€ç®¡ç†çº¿ç¨‹... Â 
<span class="hljs-bullet">-</span> æ§åˆ¶å¹¶å‘åº¦... Â 
<span class="hljs-section">## æ ¸å¿ƒå‚æ•°ä¸å«ä¹‰ Â </span>
<span class="hljs-bullet">-</span> æ ¸å¿ƒçº¿ç¨‹æ•° corePoolSize...
</code></pre>
<p>è¿™ç§<strong>æ ‡é¢˜ + åˆ—è¡¨</strong>çš„ç»“æ„ï¼Œåœ¨åˆ†å—æ—¶å®¹æ˜“å¯¼è‡´å¤šä¸ª chunk éƒ½åŒ…å«ç›¸åŒçš„å¼€å¤´éƒ¨åˆ†ï¼ˆå°¤å…¶æ˜¯å½“ chunk_size ä¸å¤Ÿå¤§æ—¶ï¼‰ã€‚</p>
<p>è€Œæˆ‘ä»¬çš„åˆ†å—ç­–ç•¥æ˜¯**<code>CharacterTextSplitter</code> çš„åˆ†å—ç­–ç•¥**</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">text_splitter</span> = CharacterTextSplitter(
 Â  Â <span class="hljs-attr">separator</span>=<span class="hljs-string">"\n\n"</span>, 
 Â  Â <span class="hljs-attr">chunk_size</span>=<span class="hljs-number">500</span>, 
 Â  Â <span class="hljs-attr">chunk_overlap</span>=<span class="hljs-number">80</span>
)
</code></pre>
<ul>
<li><code>separator="\n\n"</code>ï¼šæŒ‰<strong>ç©ºè¡Œ</strong>åˆ‡åˆ†</li>
<li>ä½†å¦‚æœæ–‡æ¡£ä¸­<strong>æ®µè½å¾ˆé•¿</strong>ï¼Œæˆ–è€…<strong>å¼€å¤´æ²¡æœ‰ç©ºè¡Œ</strong>ï¼Œå®ƒä¼š fallback åˆ°æŒ‰å­—ç¬¦åˆ‡ï¼ˆæ¯ 500 å­—åˆ‡ä¸€æ¬¡ï¼‰</li>
<li><code>chunk_overlap=80</code>ï¼šå‰åå—é‡å  80 å­—ç¬¦ â†’ è¿›ä¸€æ­¥å¢åŠ é‡å¤</li>
<li>ç»“æœï¼šæ–‡ä»¶å¼€å¤´çš„å¤§æ®µå†…å®¹è¢«åˆ‡æˆå¤šä¸ªâ€œå‡ ä¹ä¸€æ ·â€çš„ chunkã€‚</li>
</ul>
<p><strong>Chroma é»˜è®¤è¿”å› top-k ä¸ªæœ€ç›¸ä¼¼ç»“æœ</strong></p>
<p>æˆ‘ä»¬è®¾ç½®äº† <code>search_kwargs={"k": 4}</code>ï¼Œæ‰€ä»¥å³ä½¿ 4 ä¸ª chunk å†…å®¹é«˜åº¦é‡å¤ï¼Œåªè¦å®ƒä»¬çš„ embedding ç›¸ä¼¼åº¦éƒ½æ’å‰ 4ï¼Œå°±ä¼šå…¨éƒ¨è¿”å›ã€‚</p>
<p>é‚£æˆ‘ä»¬æ€ä¹ˆå»è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Œæœ€ç®€å•çš„æ˜¯ä½¿ç”¨ä¸“ä¸šçš„<strong>MarkdownTextSplitter</strong>ï¼Œè¿™æ˜¯langchainä¸­ä¸“é—¨åˆ†å‰²mdæ–‡æ¡£çš„åˆ†å‰²å™¨ï¼Œè¿˜æœ‰å°±æ˜¯è°ƒæ•´æˆ‘ä»¬çš„åˆ†å‰²ç­–ç•¥ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">text_splitter</span> = CharacterTextSplitter(
 Â  Â <span class="hljs-attr">separator</span>=<span class="hljs-string">"\n## "</span>, Â <span class="hljs-comment"># åœ¨äºŒçº§æ ‡é¢˜å¤„åˆ†å‰²</span>
 Â  Â <span class="hljs-attr">chunk_size</span>=<span class="hljs-number">800</span>, Â  Â  <span class="hljs-comment"># å¢å¤§å—å¤§å°ï¼Œå‡å°‘ç¢ç‰‡</span>
 Â  Â <span class="hljs-attr">chunk_overlap</span>=<span class="hljs-number">100</span>,
 Â  Â <span class="hljs-attr">length_function</span>=len,
 Â  Â <span class="hljs-attr">is_separator_regex</span>=<span class="hljs-literal">False</span>
)
</code></pre>
<p>æˆ‘ä»¬è¿™é‡Œå‘¢å°±ä½¿ç”¨<strong>MarkdownTextSplitter</strong>,ä¿®æ”¹å¯¹åº”çš„æ–‡æ¡£åˆ†å‰²å™¨ä»£ç </p>
<pre><code class="hljs language-ini" lang="ini">from langchain.text_splitter import MarkdownTextSplitter
â€‹
<span class="hljs-comment"># å¦‚æœä¸»è¦æ˜¯ .md æ–‡ä»¶</span>
<span class="hljs-attr">text_splitter</span> = MarkdownTextSplitter(
 Â  Â <span class="hljs-attr">chunk_size</span>=<span class="hljs-number">500</span>,
 Â  Â <span class="hljs-attr">chunk_overlap</span>=<span class="hljs-number">50</span>
)
</code></pre>
<p>ç„¶ååœ¨è¿è¡Œä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">0it [<span class="hljs-number">00</span>:<span class="hljs-number">00</span>, ?it/s]
<span class="hljs-number">100</span>%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| <span class="hljs-number">8</span>/<span class="hljs-number">8</span> [<span class="hljs-number">00</span>:<span class="hljs-number">00</span>&lt;<span class="hljs-number">00</span>:<span class="hljs-number">00</span>, <span class="hljs-number">5464.</span>00it/s]
0it [<span class="hljs-number">00</span>:<span class="hljs-number">00</span>, ?it/s]
/<span class="hljs-title class_">Users</span>/fenghuanwang/<span class="hljs-title class_">PythonProject</span>/langchain-test/agent/ai_client.<span class="hljs-property">py</span>:<span class="hljs-number">75</span>: <span class="hljs-title class_">LangChainDeprecationWarning</span>: <span class="hljs-title class_">The</span> <span class="hljs-keyword">class</span> <span class="hljs-string">`Chroma`</span> was deprecated <span class="hljs-keyword">in</span> <span class="hljs-title class_">LangChain</span> <span class="hljs-number">0.2</span><span class="hljs-number">.9</span> and will be removed <span class="hljs-keyword">in</span> <span class="hljs-number">1.0</span>. <span class="hljs-title class_">An</span> updated version <span class="hljs-keyword">of</span> the <span class="hljs-keyword">class</span> <span class="hljs-title class_">exists</span> <span class="hljs-keyword">in</span> the :<span class="hljs-attr">class</span>:<span class="hljs-string">`~langchain-chroma package and should be used instead. To use it run `</span>pip install -U :<span class="hljs-attr">class</span>:<span class="hljs-string">`~langchain-chroma`</span> and <span class="hljs-keyword">import</span> <span class="hljs-keyword">as</span> <span class="hljs-string">`from :class:`</span>~langchain_chroma <span class="hljs-keyword">import</span> <span class="hljs-title class_">Chroma</span><span class="hljs-string">``</span>.
  vectorstore = <span class="hljs-title class_">Chroma</span>(
æ–°å¢ <span class="hljs-number">23</span> ä¸ªæ–‡æ¡£ç‰‡æ®µ
<span class="hljs-variable constant_">RAG</span> é“¾åˆå§‹åŒ–å®Œæˆ
â€‹
âœ… å‘é‡æ•°æ®åº“æ£€ç´¢åˆ° <span class="hljs-number">4</span> ç¯‡ç›¸å…³æ–‡æ¡£ï¼š
  ğŸ“„ [<span class="hljs-number">1</span>] æ¥æº: <span class="hljs-regexp">/Users/</span>fenghuanwang/<span class="hljs-title class_">PythonProject</span>/langchain-test/doc/java-thread-pool.<span class="hljs-property">md</span> | é¢„è§ˆ: <span class="hljs-string">"# Java çº¿ç¨‹æ± æœ€ä½³å®è·µ  ## åœºæ™¯ä¸ç›®æ ‡ - ç»Ÿä¸€ç®¡ç†çº¿ç¨‹ï¼Œé¿å…é¢‘ç¹åˆ›å»º/é”€æ¯çš„å¼€é”€ - æ§åˆ¶å¹¶å‘åº¦ä¸ä»»åŠ¡æ’é˜Ÿç­–ç•¥ï¼ŒåŒ¹é…ä¸šåŠ¡å³°è°·  ## æ ¸å¿ƒå‚æ•°ä¸å«ä¹‰ - æ ¸å¿ƒçº¿ç¨‹æ•° corePoolSizeï¼šå¸¸é©»çº¿ç¨‹æ•°é‡ - æœ€å¤§çº¿ç¨‹æ•° maximumPoolSizeï¼šå³°å€¼å¹¶å‘ä¸Šé™ - å­˜æ´»æ—¶é—´ kee..."</span>
  ğŸ“„ [<span class="hljs-number">2</span>] æ¥æº: <span class="hljs-regexp">/Users/</span>fenghuanwang/<span class="hljs-title class_">PythonProject</span>/langchain-test/doc/java-thread-pool.<span class="hljs-property">md</span> | é¢„è§ˆ: <span class="hljs-string">"```  ## ç›‘æ§ä¸é™çº§ - æŒ‡æ ‡ï¼šæ´»è·ƒçº¿ç¨‹ã€é˜Ÿåˆ—é•¿åº¦ã€ä»»åŠ¡è€—æ—¶åˆ†ä½ã€æ‹’ç»æ¬¡æ•° - é™çº§ï¼šé™æµ/ä¸¢å¼ƒéå…³é”®ä»»åŠ¡/é™çº§åŠŸèƒ½å¼€å…³  ## å¸¸è§å‘ - ä½¿ç”¨ Executors å·¥å…·ç±»é»˜è®¤é…ç½®å¯èƒ½å¯¼è‡´ OOMï¼ˆæ— ç•Œé˜Ÿåˆ—/æœ€å¤§çº¿ç¨‹æ•°ä¸å—æ§ï¼‰ - çº¿ç¨‹æ³„æ¼ï¼šä»»åŠ¡å¼‚å¸¸æœªæ•è·ï¼Œçº¿ç¨‹æ­»é” - ä»»åŠ¡ä¸å¯ä¸­æ–­ï¼šIO..."</span>
  ğŸ“„ [<span class="hljs-number">3</span>] æ¥æº: <span class="hljs-regexp">/Users/</span>fenghuanwang/<span class="hljs-title class_">PythonProject</span>/langchain-test/doc/java-thread-pool.<span class="hljs-property">md</span> | é¢„è§ˆ: <span class="hljs-string">"## å…¸å‹æ„é€  ```java ExecutorService pool = new ThreadPoolExecutor( Â  Â  corePoolSize, Â  Â  maximumPoolSize, Â  Â  60L, TimeUnit.SECONDS, Â  Â  new LinkedBlockin..."</span>
  ğŸ“„ [<span class="hljs-number">4</span>] æ¥æº: <span class="hljs-regexp">/Users/</span>fenghuanwang/<span class="hljs-title class_">PythonProject</span>/langchain-test/doc/java-concurrency.<span class="hljs-property">md</span> | é¢„è§ˆ: <span class="hljs-string">"## åœºæ™¯ç¤ºä¾‹ - é«˜å¹¶å‘è®¡æ•°ï¼šLongAdder - é«˜è¯»ä½å†™ç¼“å­˜ï¼šReadWriteLock æˆ– Caffeine - ä»»åŠ¡ç¼–æ’ï¼šCompletableFuture å¹¶è¡Œæ‹‰å– + è¶…æ—¶å…œåº•..."</span>
â€‹
è‡ªå®šä¹‰çº¿ç¨‹æ± éœ€è®¾ç½®æ ¸å¿ƒçº¿ç¨‹æ•°ã€æœ€å¤§çº¿ç¨‹æ•°ã€ç©ºé—²å­˜æ´»æ—¶é—´ã€ä»»åŠ¡é˜Ÿåˆ—ï¼ˆå»ºè®®æœ‰ç•Œï¼‰ã€çº¿ç¨‹å·¥å‚ï¼ˆå‘½åè§„èŒƒï¼‰å’Œæ‹’ç»ç­–ç•¥ã€‚æ ¹æ®ä¸šåŠ¡ç±»å‹é€‰æ‹©å‚æ•°ï¼š<span class="hljs-variable constant_">CPU</span>å¯†é›†å‹ç”¨è¾ƒå°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œ<span class="hljs-variable constant_">IO</span>å¯†é›†å‹é€‚å½“å¢åŠ ã€‚é¿å…ä½¿ç”¨<span class="hljs-title class_">Executors</span>é»˜è®¤æ— ç•Œé˜Ÿåˆ—ï¼Œé˜²æ­¢<span class="hljs-variable constant_">OOM</span>ã€‚å»ºè®®ç›‘æ§é˜Ÿåˆ—é•¿åº¦å’Œæ‹’ç»æ¬¡æ•°ï¼ŒåŠ¨æ€è°ƒæ•´ã€‚
<span class="hljs-title class_">Process</span> finished <span class="hljs-keyword">with</span> exit code <span class="hljs-number">0</span>
</code></pre>
<p>è¿™æ—¶å€™å››ç¯‡æ–‡ç« å°±ä¸ä¼šæ˜¯ç›¸åŒçš„äº†ï¼Œ</p>
<p>psï¼šå¦‚æœæ²¡æœ‰æ”¹å˜çš„è¯ï¼Œæ˜¯å› ä¸ºå­˜åœ¨ä¹‹å‰è¿è¡Œä»£ç æ‰€ç¼“å­˜çš„å‘é‡æ•°æ®ï¼ŒæŠŠå­˜å‚¨å‘é‡æ•°æ®çš„æ–‡ä»¶å¤¹å†…çš„æ‰€æœ‰æ–‡ä»¶éƒ½åˆ äº†å°±å¥½äº†ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œå¦‚æœæˆ‘ä»¬åœ¨é—®å®Œä¸€ä¸ªé—®é¢˜ä¹‹åï¼Œåœ¨æƒ³æ¥ç€è¯¢é—®çš„æ—¶å€™llmä¸çŸ¥é“æˆ‘ä»¬å†è¯´ä»€ä¹ˆï¼Œä¹Ÿå°±æ˜¯llmæ²¡æœ‰æŠŠä¹‹å‰çš„å¯¹è¯ä½œä¸ºä¸Šä¸‹æ–‡ã€‚ä¸“ä¸šçš„è¯´å°±æ˜¯ï¼Œç°åœ¨æˆ‘ä»¬æ‰€å¼€å‘çš„llmè¿˜æ²¡æœ‰å¯¹è¯è®°å¿†çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆä¸‹é¢ï¼Œæˆ‘ä»¬å°±æ¥å®ç°ä¸€ä¸‹ã€‚</p>
<h4 data-id="heading-1">5ã€å¯¹è¯è®°å¿†å®ç°ï¼ˆåŸºäºå†…å­˜ï¼‰</h4>
<p>è¦æƒ³å®ç°å¯¹è¯è®°å¿†ï¼Œåˆå¾ˆå¤šæ–¹å¼ï¼ŒåŒ…æ‹¬åŸºäºå†…å­˜çš„å¯¹è¯å­˜å‚¨ï¼ŒåŸºäºredisçš„ï¼Œmysqlçš„ï¼Œsqlliteçš„ä»¥åŠå‘é‡å­˜å‚¨ç­‰è¯¸å¤šæ–¹å¼ã€‚é‚£ä¹ˆæˆ‘ä»¬å…ˆæ¥å°è¯•å®ç°ä¸€ä¸‹åŸºäºå†…å­˜çš„è®°å¿†ï¼š</p>
<p>é¦–å…ˆå‘¢ï¼Œåœ¨langchainçš„<strong>langchain.memory</strong>åŒ…ä¸‹é¢çš„<strong>ChatMessageHistory</strong>,æä¾›äº†ä¸€äº›æ–¹ä¾¿çš„å‡½æ•°ï¼Œå¯ä»¥ä¿å­˜äººç±»çš„æ¶ˆæ¯llmçš„æ¶ˆæ¯ã€‚ä½†æ˜¯å‘¢ï¼Œè¿™ä¸ªåªæ˜¯åº•å±‚çš„å­˜å‚¨ç»“æ„ï¼Œåªç®¡å­˜æ¶ˆæ¯ã€‚æˆ‘ä»¬çœŸæ­£ä½¿ç”¨çš„æ—¶å€™ï¼Œä½¿ç”¨çš„æ˜¯<strong>ConversationBufferMemory</strong>è¿™ä¸ªæ˜¯ä¸€ä¸ªé«˜å±‚çš„è®°å¿†ç»„å»ºï¼Œå†…éƒ¨é»˜è®¤ä½¿ç”¨çš„<strong>ChatMessageHistory</strong>æ¥å­˜å‚¨æ¶ˆæ¯ï¼Œå¹¶æä¾›äº†ä¸langchainé“¾é›†æˆçš„æ¥å£ï¼ˆä½†æ˜¯ä»–è¿˜æ˜¯ä¸èƒ½åµŒå…¥åˆ°æ–°å¼çš„Runnableä¸­ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨ç±»ä¼¼äºUnixç®¡é“ç¬¦çš„æ–¹å¼ä¸€å±‚ä¸€å±‚çš„å‘ä¸‹ä¼ é€’å¤„ç†å¥½çš„ä¿¡æ¯ï¼‰ï¼Œç”±äºæˆ‘ä»¬ç°åœ¨æ‰€ä½¿ç”¨çš„æ˜¯æ–°å¼çš„Runnable,æ‰€ä»¥æˆ‘ä»¬ä¸ä½¿ç”¨è¿™ä¸ªæ–¹å¼ã€‚æˆ‘ä»¬æ¥ä½¿ç”¨**<code>RunnableWithMessageHistory</code>**ã€‚</p>
<p>å®ƒæ˜¯ LangChain ä¸º <strong>æ–°æ—¶ä»£ <code>Runnable</code></strong> ä¸“é—¨è®¾è®¡çš„<strong>è®°å¿†åŒ…è£…å™¨</strong>ï¼Œåº•å±‚å¯ä»¥æ¥ï¼š</p>
<ul>
<li><code>ChatMessageHistory</code>ï¼ˆå†…å­˜ï¼‰</li>
<li><code>RedisChatMessageHistory</code>ï¼ˆRedisï¼‰</li>
<li>æˆ–ä»»ä½• <code>BaseChatMessageHistory</code> å­ç±»</li>
</ul>
<p>å®ƒ<strong>ä¸ä¾èµ– <code>ConversationBufferMemory</code></strong>ï¼Œè€Œæ˜¯ç›´æ¥æ“ä½œ <code>ChatMessageHistory</code>ï¼Œæ›´è½»é‡ã€æ›´ç¬¦åˆ <code>Runnable</code> èŒƒå¼ã€‚</p>
<p>æˆ‘ä»¬å¯¼å…¥æ‰€éœ€è¦çš„åŒ…ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">from</span> langchain.<span class="hljs-property">memory</span> <span class="hljs-keyword">import</span> <span class="hljs-title class_">ChatMessageHistory</span>
<span class="hljs-keyword">from</span> langchain_core.<span class="hljs-property">runnables</span>.<span class="hljs-property">history</span> <span class="hljs-keyword">import</span> <span class="hljs-title class_">RunnableWithMessageHistory</span>
<span class="hljs-keyword">from</span> langchain_core.<span class="hljs-property">messages</span> <span class="hljs-keyword">import</span> <span class="hljs-title class_">HumanMessage</span>
</code></pre>
<p>ç„¶ååˆå§‹åŒ–ä¸€ä¸ªä¼šè¯å†å²å­˜å‚¨å™¨ï¼Œæ¥å®ç°å•ç”¨æˆ·çš„å¤šè½®å¯¹è¯</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å†…å­˜ä¸­çš„ä¼šè¯å­˜å‚¨ï¼šsession_id -&gt; ChatMessageHistory</span>
<span class="hljs-comment"># ç›®å‰æˆ‘ä»¬åªç”¨ä¸€ä¸ªå›ºå®š session_idï¼Œå®ç°å•ç”¨æˆ·å¤šè½®å¯¹è¯</span>
<span class="hljs-attr">store</span> = {}

def get_session_history(session_id: str) -&gt; ChatMessageHistory:
    if session_id not in store:
        store<span class="hljs-section">[session_id]</span> = ChatMessageHistory()
    return store<span class="hljs-section">[session_id]</span>
</code></pre>
<p>è¯´æ˜ï¼š</p>
<ul>
<li><code>store</code> æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œæ¨¡æ‹Ÿå¤šç”¨æˆ·ï¼ˆè™½ç„¶æˆ‘ä»¬ç°åœ¨åªç”¨ä¸€ä¸ªï¼‰ï¼›</li>
<li><code>get_session_history("user1")</code> ä¼šè¿”å›è¯¥ç”¨æˆ·çš„å¯¹è¯å†å²å¯¹è±¡ï¼›</li>
<li>æ‰€æœ‰æ¶ˆæ¯ï¼ˆHuman/AIï¼‰éƒ½å­˜åœ¨ <code>ChatMessageHistory.messages</code> åˆ—è¡¨ä¸­ã€‚</li>
</ul>
<p>è¿™ç§å†™æ³•æ˜¯</p>
<p>ç„¶åä¿®æ”¹åŸæ¥çš„ç³»ç»Ÿæç¤ºè¯</p>
<pre><code class="hljs language-swift" lang="swift">system_prompt <span class="hljs-operator">=</span> (
    <span class="hljs-string">"ä½ æ˜¯ä¸€åèµ„æ·± Java å¼€å‘ä¸“å®¶ï¼Œç²¾é€š JDK 8-17ã€Spring ç”Ÿæ€ã€å¹¶å‘ã€JVM è°ƒä¼˜ç­‰ã€‚<span class="hljs-subst">\n</span>"</span>
    <span class="hljs-string">"è¯·åŸºäºä»¥ä¸‹æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡å’Œä¹‹å‰çš„å¯¹è¯å†å²å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚<span class="hljs-subst">\n</span>"</span>
    <span class="hljs-string">"å¦‚æœä¸Šä¸‹æ–‡ä¸ç›¸å…³ï¼Œè¯·ä»…åŸºäºä½ çš„çŸ¥è¯†å›ç­”ï¼Œä¸è¦ç¼–é€ ã€‚<span class="hljs-subst">\n</span><span class="hljs-subst">\n</span>"</span>
    <span class="hljs-string">"ä¸Šä¸‹æ–‡ï¼š<span class="hljs-subst">\n</span>{context}<span class="hljs-subst">\n</span><span class="hljs-subst">\n</span>"</span>
    <span class="hljs-string">"å¯¹è¯å†å²ï¼š<span class="hljs-subst">\n</span>{chat_history}"</span>
)
</code></pre>
<p>æ¥ç€ï¼Œä¿®æ”¹æç¤ºè¯æ¨¡æ¿ä¸­çš„ç”¨æˆ·è¾“å…¥å˜é‡ä¸º<strong>input</strong></p>
<pre><code class="hljs language-swift" lang="swift">from langchain_core.prompts <span class="hljs-keyword">import</span> MessagesPlaceholder

prompt <span class="hljs-operator">=</span> <span class="hljs-type">ChatPromptTemplate</span>.from_messages([
    (<span class="hljs-string">"system"</span>, 
     <span class="hljs-string">"ä½ æ˜¯ä¸€åèµ„æ·± Java å¼€å‘ä¸“å®¶ï¼Œç²¾é€š JDK 8-17ã€Spring ç”Ÿæ€ã€å¹¶å‘ã€JVM è°ƒä¼˜ç­‰ã€‚<span class="hljs-subst">\n</span>"</span>
     <span class="hljs-string">"è¯·åŸºäºä»¥ä¸‹æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚<span class="hljs-subst">\n</span>"</span>
     <span class="hljs-string">"å¦‚æœä¸Šä¸‹æ–‡ä¸ç›¸å…³ï¼Œè¯·ä»…åŸºäºä½ çš„çŸ¥è¯†å›ç­”ï¼Œä¸è¦ç¼–é€ ã€‚<span class="hljs-subst">\n</span><span class="hljs-subst">\n</span>"</span>
     <span class="hljs-string">"ä¸Šä¸‹æ–‡ï¼š<span class="hljs-subst">\n</span>{context}"</span>
    ),
  # å†å²æ¶ˆæ¯å ä½
    <span class="hljs-type">MessagesPlaceholder</span>(variable_name<span class="hljs-operator">=</span><span class="hljs-string">"chat_history"</span>),  # <span class="hljs-operator">â†</span> è‡ªåŠ¨æ’å…¥å†å²
    (<span class="hljs-string">"human"</span>, <span class="hljs-string">"{input}"</span>)
])
</code></pre>
<p>ä¸ºä»€ä¹ˆå¿…é¡»è¦ç”¨<strong>input</strong> å‘¢ï¼Œè¿™æ˜¯å› ä¸º<code>RunnableWithMessageHistory</code> é»˜è®¤ä»è¾“å…¥ä¸­å– <code>"input"</code> å­—æ®µä½œä¸ºç”¨æˆ·æ¶ˆæ¯ã€‚</p>
<p>ç„¶åï¼Œé‡æ„ragé“¾ï¼ˆä¸å¸¦æœ‰åº•å±‚è®°å¿†ï¼Œåªä¼šå¤„ç†ä¸€æ¬¡é—®ç­”ï¼‰,åç»­å‘¢æˆ‘ä»¬ä¼šæŠŠä»–å‡çº§æˆæ”¯æŒå¯¹è¯è®°å¿†çš„é“¾ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å•æ¬¡é—®ç­”çš„ RAG é“¾ï¼ˆæ— è®°å¿†ï¼‰</span>
from langchain_core.runnables import RunnablePassthrough

<span class="hljs-comment"># å•æ¬¡é—®ç­”é“¾ï¼ˆï¼‰</span>
<span class="hljs-attr">rag_chain</span> = (
    RunnablePassthrough.assign(<span class="hljs-attr">context</span>=itemgetter(<span class="hljs-string">"input"</span>) | retriever | format_docs)
    | prompt
    | llm
    | StrOutputParser()
)
</code></pre>
<p>å‡çº§é“¾ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¸¦è®°å¿†çš„å®Œæ•´ RAG é“¾</span>
<span class="hljs-attr">rag_with_history</span> = RunnableWithMessageHistory(
    rag_chain,
    get_session_history,
    <span class="hljs-attr">input_messages_key</span>=<span class="hljs-string">"input"</span>,        <span class="hljs-comment"># ç”¨æˆ·è¾“å…¥å­—æ®µ</span>
    <span class="hljs-attr">history_messages_key</span>=<span class="hljs-string">"chat_history"</span> <span class="hljs-comment"># å†å²æ¶ˆæ¯å­—æ®µï¼ˆå¯¹åº” MessagesPlaceholderï¼‰</span>
)
</code></pre>
<ul>
<li><code>get_session_history</code>ï¼šå‘Šè¯‰å®ƒå¦‚ä½•æ ¹æ® <code>session_id</code> è·å–å†å²ï¼›</li>
<li><code>input_messages_key="input"</code>ï¼šç”¨æˆ·è¾“å…¥åœ¨å­—å…¸ä¸­çš„ keyï¼›</li>
<li><code>history_messages_key="chat_history"</code>ï¼šè¿™ä¸ªå€¼ä¼šè¢«è‡ªåŠ¨æ³¨å…¥åˆ° prompt çš„ <code>{chat_history}</code> ä¸­ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯æ”¹é€ å®Œæˆä¹‹åçš„å®Œæ•´çš„ä»£ç ï¼ˆåŒ…å«æµ‹è¯•ç”¨ä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ai_client.py</span>
import os
from langchain_community.chat_models import ChatTongyi
from langchain_community.document_loaders import DirectoryLoader, TextLoader, PyPDFLoader
from langchain_community.embeddings import DashScopeEmbeddings
from langchain_community.vectorstores import Chroma
from langchain.text_splitter import CharacterTextSplitter
from langchain_core.output_parsers import StrOutputParser
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.prompts import MessagesPlaceholder
from langchain.memory import ChatMessageHistory
from langchain_core.runnables import RunnablePassthrough
from langchain_core.runnables.history import RunnableWithMessageHistory
from operator import itemgetter
â€‹
import config
â€‹
<span class="hljs-comment"># æ³¨å…¥ DashScope API Key</span>
if config.DASHSCOPE_API_KEY:
 Â  Â os.environ<span class="hljs-section">["DASHSCOPE_API_KEY"]</span> = config.DASHSCOPE_API_KEY
â€‹
<span class="hljs-comment"># åˆå§‹åŒ– LLM</span>
<span class="hljs-attr">llm</span> = ChatTongyi(
 Â  Â <span class="hljs-attr">model</span>=config.MODEL,
 Â  Â <span class="hljs-attr">temperature</span>=config.TEMPERATURE,
)
â€‹
<span class="hljs-comment"># ========== åŠ è½½æ–‡æ¡£ ==========</span>
<span class="hljs-attr">all_docs</span> = []
try:
 Â  Â <span class="hljs-attr">txt_docs</span> = DirectoryLoader(
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.txt"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=TextLoader,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
 Â  Â <span class="hljs-attr">md_docs</span> = DirectoryLoader(
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.md"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=TextLoader,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
 Â  Â <span class="hljs-attr">pdf_docs</span> = DirectoryLoader(
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.pdf"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
 Â  Â <span class="hljs-attr">all_docs</span> = (txt_docs or []) + (md_docs or []) + (pdf_docs or [])
except Exception as e:
 Â  Â print(f"âš ï¸ æ–‡æ¡£åŠ è½½å¤±è´¥: {e}")
 Â  Â <span class="hljs-attr">all_docs</span> = []
â€‹
<span class="hljs-comment"># åˆ†å—</span>
<span class="hljs-attr">text_splitter</span> = CharacterTextSplitter(separator=<span class="hljs-string">"\n\n"</span>, chunk_size=<span class="hljs-number">500</span>, chunk_overlap=<span class="hljs-number">80</span>)
<span class="hljs-attr">texts</span> = text_splitter.split_documents(all_docs) if all_docs else []
â€‹
<span class="hljs-comment"># åˆå§‹åŒ– Embeddings</span>
<span class="hljs-attr">embeddings</span> = DashScopeEmbeddings(model=<span class="hljs-string">"text-embedding-v2"</span>)
â€‹
<span class="hljs-comment"># åˆå§‹åŒ–å‘é‡æ•°æ®åº“ï¼ˆChromaï¼‰</span>
if texts:
 Â  Â <span class="hljs-attr">vectorstore</span> = Chroma.from_documents(
 Â  Â  Â  Â <span class="hljs-attr">documents</span>=texts,
 Â  Â  Â  Â <span class="hljs-attr">embedding</span>=embeddings,
 Â  Â  Â  Â <span class="hljs-attr">persist_directory</span>=config.EMBEDDINGS_DIR
 Â   )
 Â  Â vectorstore.persist()
else:
 Â  Â <span class="hljs-comment"># å¦‚æœæ²¡æœ‰æ–‡æ¡£ï¼Œå°è¯•ä»å·²æœ‰æ•°æ®åº“åŠ è½½ï¼ˆé¿å…æŠ¥é”™ï¼‰</span>
 Â  Â try:
 Â  Â  Â  Â <span class="hljs-attr">vectorstore</span> = Chroma(
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">persist_directory</span>=config.EMBEDDINGS_DIR,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">embedding_function</span>=embeddings
 Â  Â  Â   )
 Â  Â except Exception as e:
 Â  Â  Â  Â print("âš ï¸ æ— æ–‡æ¡£ä¸”æ— æ³•åŠ è½½å‘é‡åº“ï¼Œå°†ä½¿ç”¨çº¯ LLM æ¨¡å¼ï¼ˆæ— æ£€ç´¢ï¼‰")
 Â  Â  Â  Â <span class="hljs-attr">vectorstore</span> = None
â€‹
<span class="hljs-comment"># åˆå§‹åŒ–æ£€ç´¢å™¨</span>
if vectorstore:
 Â  Â <span class="hljs-attr">retriever</span> = vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">3</span>})
else:
 Â  Â <span class="hljs-comment"># æ— æ£€ç´¢å™¨æ—¶ï¼Œè¿”å›ç©ºåˆ—è¡¨</span>
 Â  Â <span class="hljs-attr">retriever</span> = lambda query: []
â€‹
<span class="hljs-comment"># æ ¼å¼åŒ–æ£€ç´¢ç»“æœ</span>
def format_docs(docs):
 Â  Â return "\n\n".join(doc.page_content for doc in docs)
â€‹
<span class="hljs-comment"># ========== æ„å»ºå¸¦è®°å¿†çš„ RAG é“¾ ==========</span>
â€‹
<span class="hljs-comment"># Step 1: ä¿®æ”¹ Promptï¼ŒåŠ å…¥èŠå¤©å†å²</span>
<span class="hljs-attr">system_prompt</span> = (
 Â  Â "ä½ æ˜¯ä¸€åèµ„æ·± Java å¼€å‘ä¸“å®¶ï¼Œç²¾é€š JDK 8-17ã€Spring ç”Ÿæ€ã€å¹¶å‘ã€JVM è°ƒä¼˜ç­‰ã€‚\n"
 Â  Â "è¯·åŸºäºä»¥ä¸‹æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡å’Œä¹‹å‰çš„å¯¹è¯å†å²å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚\n"
 Â  Â "å¦‚æœä¸Šä¸‹æ–‡ä¸ç›¸å…³ï¼Œè¯·ä»…åŸºäºä½ çš„çŸ¥è¯†å›ç­”ï¼Œä¸è¦ç¼–é€ ã€‚\n\n"
 Â  Â "ä¸Šä¸‹æ–‡ï¼š\n{context}\n\n"
 Â  Â "å¯¹è¯å†å²ï¼š\n{chat_history}"
)
â€‹
<span class="hljs-attr">prompt</span> = ChatPromptTemplate.from_messages([
 Â   (<span class="hljs-string">"system"</span>,
 Â  Â  <span class="hljs-string">"ä½ æ˜¯ä¸€åèµ„æ·± Java å¼€å‘ä¸“å®¶ï¼Œç²¾é€š JDK 8-17ã€Spring ç”Ÿæ€ã€å¹¶å‘ã€JVM è°ƒä¼˜ç­‰ã€‚\n"</span>
 Â  Â  <span class="hljs-string">"è¯·åŸºäºä»¥ä¸‹æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚\n"</span>
 Â  Â  <span class="hljs-string">"å¦‚æœä¸Šä¸‹æ–‡ä¸ç›¸å…³ï¼Œè¯·ä»…åŸºäºä½ çš„çŸ¥è¯†å›ç­”ï¼Œä¸è¦ç¼–é€ ã€‚\n\n"</span>
 Â  Â  <span class="hljs-string">"ä¸Šä¸‹æ–‡ï¼š\n{context}"</span>
 Â   ),
 Â <span class="hljs-comment"># å†å²æ¶ˆæ¯å ä½</span>
 Â  Â MessagesPlaceholder(variable_name=<span class="hljs-string">"chat_history"</span>), Â <span class="hljs-comment"># â† è‡ªåŠ¨æ’å…¥å†å²</span>
 Â   (<span class="hljs-string">"human"</span>, <span class="hljs-string">"{input}"</span>)
])
â€‹
<span class="hljs-comment"># Step 2: å•æ¬¡é—®ç­” RAG é“¾ï¼ˆæ— è®°å¿†ï¼‰</span>
<span class="hljs-attr">rag_chain</span> = (
 Â  Â RunnablePassthrough.assign(<span class="hljs-attr">context</span>=itemgetter(<span class="hljs-string">"input"</span>) | retriever | format_docs)
 Â  Â | prompt
 Â  Â | llm
 Â  Â | StrOutputParser()
)
<span class="hljs-comment"># Step 3: å†…å­˜ä¸­çš„ä¼šè¯å†å²å­˜å‚¨</span>
<span class="hljs-attr">store</span> = {}
â€‹
def get_session_history(session_id: str) -&gt; ChatMessageHistory:
 Â  Â if session_id not in store:
 Â  Â  Â  Â store<span class="hljs-section">[session_id]</span> = ChatMessageHistory()
 Â  Â return store<span class="hljs-section">[session_id]</span>
â€‹
<span class="hljs-comment"># Step 4: ç”¨ RunnableWithMessageHistory åŒ…è£…ï¼Œè‡ªåŠ¨ç®¡ç†å†å²</span>
<span class="hljs-attr">rag_with_history</span> = RunnableWithMessageHistory(
 Â  Â rag_chain,
 Â  Â get_session_history,
 Â  Â <span class="hljs-attr">input_messages_key</span>=<span class="hljs-string">"input"</span>, Â  Â  Â  Â <span class="hljs-comment"># ç”¨æˆ·è¾“å…¥å­—æ®µ</span>
 Â  Â <span class="hljs-attr">history_messages_key</span>=<span class="hljs-string">"chat_history"</span> <span class="hljs-comment"># å†å²æ¶ˆæ¯å­—æ®µï¼ˆå¯¹åº” MessagesPlaceholderï¼‰</span>
)
â€‹
<span class="hljs-comment"># ========== å¤šè½®å¯¹è¯æµ‹è¯• ==========</span>
if <span class="hljs-attr">__name__</span> == <span class="hljs-string">"__main__"</span>:
 Â  Â <span class="hljs-attr">SESSION_ID</span> = <span class="hljs-string">"user_session_1"</span> Â <span class="hljs-comment"># å›ºå®šä¼šè¯ IDï¼Œå®ç°å•ç”¨æˆ·å¤šè½®</span>
â€‹
 Â  Â print("ğŸ’¬ æ¬¢è¿ä½¿ç”¨ Java ä¸“å®¶é—®ç­”ç³»ç»Ÿï¼ˆæ”¯æŒå¤šè½®å¯¹è¯ï¼‰\n")
â€‹
 Â  Â <span class="hljs-comment"># ç¬¬ä¸€è½®</span>
 Â  Â <span class="hljs-attr">question1</span> = <span class="hljs-string">"æ€ä¹ˆè‡ªå®šä¹‰çº¿ç¨‹æ± ,ä¸ç”¨ç»™æˆ‘ä»£ç ï¼Œç®€å•è¯´ä¸è¶…è¿‡200ä¸ªå­—"</span>
 Â  Â print(f"ğŸ‘¤ ç”¨æˆ·: {question1}")
 Â  Â print("ğŸ¤– AI: ", <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
 Â  Â for chunk in rag_with_history.stream(
 Â  Â  Â   {"input": question1},
 Â  Â  Â  Â <span class="hljs-attr">config</span>={<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"session_id"</span>: SESSION_ID}}
 Â   ):
 Â  Â  Â  Â print(chunk, <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
 Â  Â print("\n")
â€‹
 Â  Â <span class="hljs-comment"># ç¬¬äºŒè½®</span>
 Â  Â <span class="hljs-attr">question2</span> = <span class="hljs-string">"é‚£æ ¸å¿ƒçº¿ç¨‹æ•°ä¸€èˆ¬è®¾å¤šå°‘ï¼Ÿ"</span>
 Â  Â print(f"\nğŸ‘¤ ç”¨æˆ·: {question2}")
 Â  Â print("ğŸ¤– AI: ", <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
 Â  Â for chunk in rag_with_history.stream(
 Â  Â  Â   {"input": question2},
 Â  Â  Â  Â <span class="hljs-attr">config</span>={<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"session_id"</span>: SESSION_ID}}
 Â   ):
 Â  Â  Â  Â print(chunk, <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
 Â  Â print("\n")
â€‹
 Â  Â <span class="hljs-comment"># ç¬¬ä¸‰è½®</span>
 Â  Â <span class="hljs-attr">question3</span> = <span class="hljs-string">"å¦‚æœä»»åŠ¡å¾ˆå¤šï¼Œé˜Ÿåˆ—ä¼šæ»¡å—ï¼Ÿ"</span>
 Â  Â print(f"\nğŸ‘¤ ç”¨æˆ·: {question3}")
 Â  Â print("ğŸ¤– AI: ", <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
 Â  Â for chunk in rag_with_history.stream(
 Â  Â  Â   {"input": question3},
 Â  Â  Â  Â <span class="hljs-attr">config</span>={<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"session_id"</span>: SESSION_ID}}
 Â   ):
 Â  Â  Â  Â print(chunk, <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
 Â  Â print("\n")
â€‹
 Â  Â print("\nâœ… å¤šè½®å¯¹è¯æµ‹è¯•å®Œæˆï¼")
</code></pre>
<p>llmçš„å›å¤å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9929b35a8aa449e9b6652775bea44ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770949326&amp;x-signature=4F2exKDlBBVHFQgSFl9%2B%2F0rhEB4%3D" alt="image-20251018143506520" loading="lazy"/></p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬çš„aiåº”ç”¨å·²ç»æ”¯æŒåŸºäºæœ¬åœ°å†…å­˜çš„å¤šè½®ä¼šè¯äº†ï¼ï¼ï¼</p>
<h4 data-id="heading-2">6ã€å¯¹è¯è®°å¿†å®ç°ï¼ˆåŸºäºRedisï¼‰</h4>
<p>é‚£æˆ‘ä»¬æ¥ç€æ¥æ€è€ƒä¸€ä¸‹ï¼Œä»…ä»…æ˜¯åŸºäºæœ¬åœ°å†…å­˜åˆæœ‰ä»€ä¹ˆå¼Šç«¯å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬çš„æœåŠ¡å¦‚æœæ˜¯éƒ¨ç½²åœ¨å¤šä¸ªæœåŠ¡å™¨ä¸Šå‘¢ï¼Œå¦‚æœæˆ‘ä»¬çš„æœåŠ¡å™¨å†…å­˜ä¸è¶³å‘¢ï¼Œé‚£ä¹ˆé—®é¢˜ç«‹é©¬å°±æš´éœ²å‡ºæ¥äº†ï¼Œå¦‚æœéƒ¨ç½²åœ¨å¤šå°æœåŠ¡å™¨ä¸Šçš„è¯ï¼Œç”¨æˆ·Aç¬¬ä¸€æ¬¡çš„è¯·æ±‚è¢«nginxè´Ÿè½½å‡è¡¡ç®—æ³•è½¬å‘åˆ°äº†æœåŠ¡å™¨Aï¼Œé‚£å¦‚æœè¿˜æ˜¯ç”¨æˆ·Aï¼Œç¬¬äºŒæ¬¡è¯·æ±‚è¢«è½¬å‘åˆ°äº†æœåŠ¡å™¨Bå‘¢ï¼Œè¿™æ—¶å€™æœåŠ¡å™¨Bçš„å†…å­˜ä¸­æ˜¯æ²¡æœ‰ç”¨æˆ·Aä¸Šä¸€æ¬¡çš„ä¼šè¯è®°å¿†çš„ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªç±»ä¼¼äºæˆ‘ä»¬çš„å¤šè½®ä¼šè¯å¤±æ•ˆäº†çš„ç°è±¡ã€‚</p>
<p>å¥½ï¼Œé—®é¢˜æ—¢ç„¶å·²ç»å‘ç°äº†ï¼Œé‚£æ€ä¹ˆå»è§£å†³å‘¢ï¼Œå…¶å®åœ¨ä¸Šé¢æˆ‘ä»¬æåˆ°äº†ï¼ŒLangChainä¸ä»…ä»…æä¾›äº†åŸºäºæœ¬åœ°å†…å­˜çš„ä¼šè¯è®°å¿†ï¼Œè€Œä¸”æä¾›äº†åŸºäºRedisçš„ä¼šè¯è®°å¿†ã€‚æƒ³å¿…Rediså¤§å®¶éƒ½åº”è¯¥å¬è¿‡å§ï¼Œå°¤å…¶æ˜¯åšJavaåç«¯å¼€å‘çš„åŒå­¦ï¼Œä»€ä¹ˆç¼“å­˜å‡»ç©¿ï¼Œç¼“å­˜é›ªå´©ï¼Œç¼“å­˜ç©¿é€å•Šï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬ç”¨ä¸åˆ°è¿™äº›ğŸ˜„ã€‚å› ä¸ºæˆ‘ä»¬å°±æ˜¯æŠŠå¯¹è¯è®°å½•åœ¨æœ¬åœ°å†…å­˜å­˜å‚¨çš„æ–¹å¼æ¢æˆäº†å­˜åˆ°Redisä¸­ï¼ŒRedisæ˜¯å•çº¿ç¨‹(ä¸è¿‡è·Ÿå’±ä»¬ç°åœ¨è¿™ä¸ªé¡¹ç›®æ²¡å…³ç³»)çš„ï¼Œå¹¶ä¸”å¯ä»¥æ­å»ºé›†ç¾¤ï¼ŒåŒæ—¶å‘¢Rediså¯ä»¥æŠŠå¯¹è¯é€šè¿‡ç”Ÿæˆrdbæ–‡ä»¶çš„æ–¹å¼æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œä¸ç®¡æˆ‘ä»¬éƒ¨ç½²äº†å¤šå°‘ä¸ªAIåº”ç”¨æœåŠ¡ï¼Œéƒ¨ç½²äº†å¤šå°‘å°æœåŠ¡å™¨ï¼Œéƒ½å¯ä»¥å»Redisä¸­æŸ¥è¯¢å¯¹è¯è®°å½•ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬è¦å®‰è£…Redisï¼Œåœ¨è¿™é‡Œï¼Œç”±äºæˆ‘ç°åœ¨ä½¿ç”¨çš„æ˜¯macOSï¼Œæ‰€ä»¥å°±ç”¨dockerçš„æ–¹å¼å®‰è£…Redisäº†ã€‚winå¹³å°çš„å¯ä»¥è‡ªè¡Œå»ç½‘ä¸Šæœç´¢å®‰è£…æ–¹å¼</p>
<pre><code class="hljs language-lua" lang="lua">docker run -d \
 Â <span class="hljs-comment">--name my-redis \</span>
 Â -p <span class="hljs-number">6379</span>:<span class="hljs-number">6379</span> \
 Â -v redis-data:/data \
 Â <span class="hljs-comment">--restart unless-stopped \</span>
  redis:<span class="hljs-number">7.0</span> redis-server <span class="hljs-comment">--appendonly yes</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61191a0318764ff39a28ec46032a1c81~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770949326&amp;x-signature=lSg5SPmnGXzoHYeVDgNHCHmoadA%3D" alt="image-20251019163743463" loading="lazy"/></p>
<p>å‡ºç°è¿™ä¸ªç•Œé¢ï¼Œå°±ä»£è¡¨Redis dockerå®¹å™¨æˆåŠŸè¿è¡Œäº†</p>
<p>ç„¶åä½¿ç”¨ä¸€æ¬¾å¯è§†åŒ–çš„Redisç®¡ç†å·¥å…·:<strong>Another Redis Desktop Manager</strong> è¿æ¥åˆ°æœ¬åœ°çš„Rediså®ä¾‹é»˜è®¤6379ç«¯å£</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab9f92fa9ba84583b2218561e7854573~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770949326&amp;x-signature=e8K4k83QKKID8hVtLG%2B2jGizNN8%3D" alt="image-20251019163718402" loading="lazy"/></p>
<p>å®‰è£…å¥½Rediså®ä¾‹ä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨LangChainå»æ“ä½œredisï¼Œå°±éœ€è¦åœ¨é¡¹ç›®ä¸­å®‰è£…<strong>langchain-redis</strong>,ä½¿ç”¨pipå‘½ä»¤ï¼Œæˆ–è€…ä½¿ç”¨PyCharmå¯è§†åŒ–å®‰è£…ï¼š</p>
<p>è¿™é‡Œæˆ‘å°±ä½¿ç”¨pipå‘½ä»¤å®‰è£…äº†,è¿›å…¥åˆ°å½“å‰é¡¹ç›®çš„è·¯å¾„ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥ï¼š</p>
<pre><code class="hljs">pip install langchain-redis
</code></pre>
<p>å¥½äº†ï¼Œæˆ‘ä»¬å›åˆ°<strong>ai_client.py</strong>,å¯¼å…¥æ‰€éœ€è¦çš„åŒ…ï¼š<strong>RedisChatMessageHistory</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">from</span> langchain_community.<span class="hljs-property">chat_message_histories</span> <span class="hljs-keyword">import</span> <span class="hljs-title class_">RedisChatMessageHistory</span>
</code></pre>
<p>åˆ é™¤åŸæ¥çš„soreå’Œå‡½æ•°<strong>get_session_history</strong>,æ”¹ä¸ºä¸‹é¢çš„ä»£ç </p>
<pre><code class="hljs language-ini" lang="ini">def get_session_history(session_id: str) -&gt; RedisChatMessageHistory:
    return RedisChatMessageHistory(
        <span class="hljs-attr">session_id</span>=session_id,
        <span class="hljs-attr">url</span>=config.REDIS_URL,          <span class="hljs-comment"># e.g., "redis://localhost:6379/0"</span>
        <span class="hljs-attr">ttl</span>=config.REDIS_TTL           <span class="hljs-comment"># å¯é€‰ï¼šè¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰ï¼Œå¦‚ 3600</span>
    )
</code></pre>
<p>è¯´æ˜ï¼š</p>
<ul>
<li>æ¯æ¬¡è°ƒç”¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ªç»‘å®šåˆ°<code>session_id</code>çš„Rediså†å²å¯¹è±¡</li>
<li>LangChainä¼šè‡ªåŠ¨åœ¨Redisä¸­ä»¥<code>message_store:{session_id}</code>ä¸ºkeyå­˜å‚¨æ¶ˆæ¯</li>
<li>ttlï¼Œä¹Ÿå°±æ˜¯å­˜æ´»æ—¶é—´ï¼Œå¯ä»¥è‡ªåŠ¨æ¸…ç†è¿‡æœŸçš„ä¼šè¯ï¼Œé¿å…å ç”¨è¿‡å¤šçš„å†…å­˜</li>
</ul>
<p>åœ¨<strong>config.py</strong>ä¸­æ·»åŠ ä¸‹é¢çš„é…ç½®ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># redisè¿æ¥åœ°å€</span>
<span class="hljs-attr">REDIS_URL</span> = <span class="hljs-string">"redis://localhost:6379/0"</span>
<span class="hljs-comment"># redis keyè¿‡æœŸæ—¶é—´</span>
<span class="hljs-attr">REDIS_TTL</span> = <span class="hljs-number">10000000</span>
</code></pre>
<p>ä¿æŒragé“¾ä¸å˜ï¼Œ</p>
<p>ä¿®æ”¹ä¹‹åå®Œæ•´çš„ä»£ç å¦‚ä¸‹ï¼ˆåŒ…å«æµ‹è¯•ç”¨ä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ai_client.py</span>
import os
from langchain_community.chat_models import ChatTongyi
from langchain_community.document_loaders import DirectoryLoader, TextLoader, PyPDFLoader
from langchain_community.embeddings import DashScopeEmbeddings
from langchain_community.vectorstores import Chroma
from langchain.text_splitter import CharacterTextSplitter
from langchain_core.output_parsers import StrOutputParser
from langchain_core.prompts import ChatPromptTemplate, MessagesPlaceholder
from langchain_core.runnables import RunnablePassthrough
from langchain_core.runnables.history import RunnableWithMessageHistory
from langchain_community.chat_message_histories import RedisChatMessageHistory
from operator import itemgetter
â€‹
import config
â€‹
<span class="hljs-comment"># è®¾ç½® API Key</span>
if config.DASHSCOPE_API_KEY:
 Â  Â os.environ<span class="hljs-section">["DASHSCOPE_API_KEY"]</span> = config.DASHSCOPE_API_KEY
â€‹
<span class="hljs-comment"># åˆå§‹åŒ– LLM</span>
<span class="hljs-attr">llm</span> = ChatTongyi(
 Â  Â <span class="hljs-attr">model</span>=config.MODEL,
 Â  Â <span class="hljs-attr">temperature</span>=config.TEMPERATURE,
)
â€‹
<span class="hljs-comment"># ========== åŠ è½½æ–‡æ¡£ ==========</span>
<span class="hljs-attr">all_docs</span> = []
try:
 Â  Â <span class="hljs-attr">txt_docs</span> = DirectoryLoader(
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.txt"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=TextLoader,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
 Â  Â <span class="hljs-attr">md_docs</span> = DirectoryLoader(
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.md"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=TextLoader,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
 Â  Â <span class="hljs-attr">pdf_docs</span> = DirectoryLoader(
 Â  Â  Â  Â config.DOC_DIR,
 Â  Â  Â  Â <span class="hljs-attr">glob</span>=<span class="hljs-string">"**/*.pdf"</span>,
 Â  Â  Â  Â <span class="hljs-attr">loader_cls</span>=PyPDFLoader,
 Â  Â  Â  Â <span class="hljs-attr">show_progress</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">use_multithreading</span>=<span class="hljs-literal">True</span>,
 Â  Â  Â  Â <span class="hljs-attr">silent_errors</span>=<span class="hljs-literal">True</span>
 Â   ).load()
 Â  Â <span class="hljs-attr">all_docs</span> = (txt_docs or []) + (md_docs or []) + (pdf_docs or [])
except Exception as e:
 Â  Â print(f"âš ï¸ æ–‡æ¡£åŠ è½½å¤±è´¥: {e}")
 Â  Â <span class="hljs-attr">all_docs</span> = []
â€‹
<span class="hljs-comment"># åˆ†å—</span>
<span class="hljs-attr">text_splitter</span> = CharacterTextSplitter(separator=<span class="hljs-string">"\n\n"</span>, chunk_size=<span class="hljs-number">500</span>, chunk_overlap=<span class="hljs-number">80</span>)
<span class="hljs-attr">texts</span> = text_splitter.split_documents(all_docs) if all_docs else []
â€‹
<span class="hljs-comment"># åˆå§‹åŒ– Embeddings</span>
<span class="hljs-attr">embeddings</span> = DashScopeEmbeddings(model=<span class="hljs-string">"text-embedding-v2"</span>)
â€‹
<span class="hljs-comment"># åˆå§‹åŒ–å‘é‡æ•°æ®åº“</span>
if texts:
 Â  Â <span class="hljs-attr">vectorstore</span> = Chroma.from_documents(
 Â  Â  Â  Â <span class="hljs-attr">documents</span>=texts,
 Â  Â  Â  Â <span class="hljs-attr">embedding</span>=embeddings,
 Â  Â  Â  Â <span class="hljs-attr">persist_directory</span>=config.DB_PATH
 Â   )
 Â  Â vectorstore.persist()
else:
 Â  Â try:
 Â  Â  Â  Â <span class="hljs-attr">vectorstore</span> = Chroma(
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">persist_directory</span>=config.DB_PATH,
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">embedding_function</span>=embeddings
 Â  Â  Â   )
 Â  Â except Exception as e:
 Â  Â  Â  Â print("âš ï¸ æ— æ–‡æ¡£ä¸”æ— æ³•åŠ è½½å‘é‡åº“ï¼Œå°†ä½¿ç”¨çº¯ LLM æ¨¡å¼")
 Â  Â  Â  Â <span class="hljs-attr">vectorstore</span> = None
â€‹
<span class="hljs-comment"># åˆå§‹åŒ–æ£€ç´¢å™¨</span>
if vectorstore:
 Â  Â <span class="hljs-attr">retriever</span> = vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">3</span>})
else:
 Â  Â <span class="hljs-attr">retriever</span> = lambda query: []
â€‹
<span class="hljs-comment"># æ ¼å¼åŒ–æ£€ç´¢ç»“æœ</span>
def format_docs(docs):
 Â  Â return "\n\n".join(doc.page_content for doc in docs)
â€‹
<span class="hljs-comment"># ========== æ„å»º Prompt ==========</span>
<span class="hljs-attr">prompt</span> = ChatPromptTemplate.from_messages([
 Â   (<span class="hljs-string">"system"</span>,
 Â  Â  <span class="hljs-string">"ä½ æ˜¯ä¸€åèµ„æ·± Java å¼€å‘ä¸“å®¶ï¼Œç²¾é€š JDK 8-17ã€Spring ç”Ÿæ€ã€å¹¶å‘ã€JVM è°ƒä¼˜ç­‰ã€‚\n"</span>
 Â  Â  <span class="hljs-string">"è¯·åŸºäºä»¥ä¸‹æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚\n"</span>
 Â  Â  <span class="hljs-string">"å¦‚æœä¸Šä¸‹æ–‡ä¸ç›¸å…³ï¼Œè¯·ä»…åŸºäºä½ çš„çŸ¥è¯†å›ç­”ï¼Œä¸è¦ç¼–é€ ã€‚\n\n"</span>
 Â  Â  <span class="hljs-string">"ä¸Šä¸‹æ–‡ï¼š\n{context}"</span>
 Â   ),
 Â  Â MessagesPlaceholder(variable_name=<span class="hljs-string">"chat_history"</span>), Â <span class="hljs-comment"># è‡ªåŠ¨æ’å…¥å†å²æ¶ˆæ¯</span>
 Â   (<span class="hljs-string">"human"</span>, <span class="hljs-string">"{input}"</span>)
])
â€‹
<span class="hljs-comment"># ========== æ„å»º RAG é“¾ ==========</span>
<span class="hljs-attr">rag_chain</span> = (
 Â  Â RunnablePassthrough.assign(
 Â  Â  Â  Â <span class="hljs-attr">context</span>=itemgetter(<span class="hljs-string">"input"</span>) | retriever | format_docs
 Â   )
 Â  Â | prompt
 Â  Â | llm
 Â  Â | StrOutputParser()
)
â€‹
<span class="hljs-comment"># ========== Redis ä¼šè¯å†å² ==========</span>
def get_session_history(session_id: str):
 Â  Â return RedisChatMessageHistory(
 Â  Â  Â  Â <span class="hljs-attr">session_id</span>=session_id,
 Â  Â  Â  Â <span class="hljs-attr">url</span>=config.REDIS_URL,
 Â  Â  Â  Â <span class="hljs-attr">ttl</span>=config.REDIS_TTL Â <span class="hljs-comment"># è‡ªåŠ¨è¿‡æœŸï¼ˆç§’ï¼‰</span>
 Â   )
â€‹
<span class="hljs-comment"># ========== å¸¦è®°å¿†çš„å®Œæ•´é“¾ ==========</span>
<span class="hljs-attr">rag_with_history</span> = RunnableWithMessageHistory(
 Â  Â rag_chain,
 Â  Â get_session_history,
 Â  Â <span class="hljs-attr">input_messages_key</span>=<span class="hljs-string">"input"</span>,
 Â  Â <span class="hljs-attr">history_messages_key</span>=<span class="hljs-string">"chat_history"</span>
)
â€‹
<span class="hljs-comment"># ========== æµ‹è¯•å¤šè½®å¯¹è¯ ==========</span>
if <span class="hljs-attr">__name__</span> == <span class="hljs-string">"__main__"</span>:
 Â  Â <span class="hljs-attr">SESSION_ID</span> = <span class="hljs-string">"user_12345"</span> Â <span class="hljs-comment"># å®é™…é¡¹ç›®ä¸­å¯ç”¨ç”¨æˆ·IDæˆ–UUID</span>
â€‹
 Â  Â print("ğŸ’¬ Java ä¸“å®¶é—®ç­”ç³»ç»Ÿï¼ˆRedis å¤šè½®å¯¹è¯ï¼‰\n")
â€‹
 Â  Â <span class="hljs-comment"># ç¬¬ä¸€è½®</span>
 Â  Â <span class="hljs-attr">q1</span> = <span class="hljs-string">"Java ä¸­å¦‚ä½•åˆ›å»ºä¸€ä¸ªå›ºå®šå¤§å°çš„çº¿ç¨‹æ± ï¼Ÿ"</span>
 Â  Â print(f"ğŸ‘¤ ç”¨æˆ·: {q1}")
 Â  Â print("ğŸ¤– AI: ", <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
 Â  Â for chunk in rag_with_history.stream(
 Â  Â  Â   {"input": q1},
 Â  Â  Â  Â <span class="hljs-attr">config</span>={<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"session_id"</span>: SESSION_ID}}
 Â   ):
 Â  Â  Â  Â print(chunk, <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
 Â  Â print("\n")
â€‹
 Â  Â <span class="hljs-comment"># ç¬¬äºŒè½®</span>
 Â  Â <span class="hljs-attr">q2</span> = <span class="hljs-string">"é‚£å®ƒå’Œ cachedThreadPool æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"</span>
 Â  Â print(f"\nğŸ‘¤ ç”¨æˆ·: {q2}")
 Â  Â print("ğŸ¤– AI: ", <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
 Â  Â for chunk in rag_with_history.stream(
 Â  Â  Â   {"input": q2},
 Â  Â  Â  Â <span class="hljs-attr">config</span>={<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"session_id"</span>: SESSION_ID}}
 Â   ):
 Â  Â  Â  Â print(chunk, <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
 Â  Â print("\n")
â€‹
 Â  Â <span class="hljs-comment"># ç¬¬ä¸‰è½®</span>
 Â  Â <span class="hljs-attr">q3</span> = <span class="hljs-string">"å¦‚æœä»»åŠ¡æŠ›å¼‚å¸¸ï¼Œçº¿ç¨‹æ± ä¼šæ€æ ·ï¼Ÿ"</span>
 Â  Â print(f"\nğŸ‘¤ ç”¨æˆ·: {q3}")
 Â  Â print("ğŸ¤– AI: ", <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
 Â  Â for chunk in rag_with_history.stream(
 Â  Â  Â   {"input": q3},
 Â  Â  Â  Â <span class="hljs-attr">config</span>={<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"session_id"</span>: SESSION_ID}}
 Â   ):
 Â  Â  Â  Â print(chunk, <span class="hljs-attr">end</span>=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>)
 Â  Â print("\n")
â€‹
 Â  Â print("âœ… å¯¹è¯å·²æŒä¹…åŒ–åˆ° Redisï¼")
</code></pre>
<p>è¿è¡Œä»£ç æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2457e519170452ea0642c2b23599e53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770949326&amp;x-signature=SpCEsM%2Fzma7J%2FFw2duX8YMhK0Os%3D" alt="image-20251019165928716" loading="lazy"/></p>
<p>Redisä¸­å·²ç»æˆåŠŸå­˜å‚¨äº†å¯¹è¯</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3863cf51c4554ceeb3e792b4ba51b389~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770949326&amp;x-signature=obrkvZ60T5JDtVWFbBrVULlQnh0%3D" alt="image-20251019170037803" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/926e07388b074e5dad3f631ab176dc4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oSf5oCn55qE56iL5bqP5ZGY5bCP546L:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770949326&amp;x-signature=hPqFJ6tUO9PZNEwEfR5o0FVo168%3D" alt="image-20251019170111468" loading="lazy"/></p>
<p>è‡³æ­¤ï¼ŒåŸºäºRedisçš„å¤šè½®å¯¹è¯è®°å¿†å¼€å‘å®Œæ¯•ï¼ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[promise-logic v2.8 æ›´æ–°]]></title>    <link>https://juejin.cn/post/7603263490341584905</link>    <guid>https://juejin.cn/post/7603263490341584905</guid>    <pubDate>2026-02-06T01:36:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603263490341584905" data-draft-id="7603227363821502490" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="promise-logic v2.8 æ›´æ–°"/> <meta itemprop="keywords" content="JavaScript,å¼€æº"/> <meta itemprop="datePublished" content="2026-02-06T01:36:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xier123456"/> <meta itemprop="url" content="https://juejin.cn/user/546930955651113"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            promise-logic v2.8 æ›´æ–°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/546930955651113/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xier123456
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T01:36:39.000Z" title="Fri Feb 06 2026 01:36:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä¸»è¦æ›´æ–°å†…å®¹</h2>
<h3 data-id="heading-1">1. allFulfilled &amp; allRejected æ€§èƒ½ä¼˜åŒ–</h3>
<h4 data-id="heading-2">éš¾ç‚¹åˆ†æï¼š</h4>
<ul>
<li>éœ€å…¼é¡¾â€œå³æ—¶è¿”å›ç»“æœâ€ä¸â€œä¿æŒè¾“å…¥é¡ºåºâ€çš„åŒé‡éœ€æ±‚</li>
<li>é¿å…å› ç­‰å¾…æ‰€æœ‰ Promise å®Œæˆå¯¼è‡´çš„æ€§èƒ½æŸè€—</li>
<li>ç¡®ä¿é«˜å¹¶å‘åœºæ™¯ä¸‹çš„ç»“æœä¸€è‡´æ€§</li>
</ul>
<h4 data-id="heading-3">è§£å†³æ–¹æ¡ˆï¼š</h4>
<ul>
<li>åº•å±‚é‡æ„å®ç°é€»è¾‘ï¼Œé‡‡ç”¨â€œå¢é‡æ”¶é›†+é¡ºåºæ ¡å‡†â€æœºåˆ¶</li>
<li>å•ä¸ª Promise å®Œæˆåç«‹å³è¿”å›å½“å‰å·²æ”¶é›†ç»“æœï¼Œæ— éœ€ç­‰å¾…å…¨éƒ¨å®Œæˆ</li>
<li>æœ€ç»ˆç»“æœä¸¥æ ¼éµå¾ªè¾“å…¥é¡ºåºæ’åˆ—ï¼Œä¸å— Promise å®Œæˆé¡ºåºå½±å“</li>
</ul>
<h4 data-id="heading-4">ç¤ºä¾‹ï¼š</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">PromiseLogic</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'promise-logic'</span>;

<span class="hljs-comment">// å¿«æ…¢ Promise æ··åˆåœºæ™¯</span>
<span class="hljs-keyword">const</span> operations = [
  <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'slowSuccess'</span>), <span class="hljs-number">100</span>)),
  <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-string">'error'</span>),
  <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'fastSuccess'</span>), <span class="hljs-number">10</span>))
];

<span class="hljs-comment">// 10ms æ—¶è¿”å› ['fastSuccess']ï¼Œ100ms æ—¶è¿”å› ['slowSuccess', 'fastSuccess']</span>
<span class="hljs-title class_">PromiseLogic</span>.<span class="hljs-title function_">allFulfilled</span>(operations).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">results</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¼˜åŒ–åç»“æœ:'</span>, results);
});
</code></pre>
<h3 data-id="heading-5">2. maxTimer é“¾å¼è¶…æ—¶å¢å¼º</h3>
<h4 data-id="heading-6">éš¾ç‚¹åˆ†æï¼š</h4>
<ul>
<li>éœ€æ”¯æŒè‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯ï¼Œæ»¡è¶³ä¸åŒä¸šåŠ¡åœºæ™¯çš„æŠ¥é”™éœ€æ±‚</li>
<li>ä¿æŒè¶…æ—¶é€»è¾‘çš„ä¸­æ–­ç‰¹æ€§ï¼ŒåŒæ—¶å…¼å®¹é“¾å¼è°ƒç”¨</li>
<li>ç¡®ä¿é”™è¯¯ç±»å‹ä¸åŸæœ‰é”™è¯¯ä½“ç³»ä¸€è‡´</li>
</ul>
<h4 data-id="heading-7">è§£å†³æ–¹æ¡ˆï¼š</h4>
<ul>
<li>æ‰©å±•  maxTimer  æ–¹æ³•å‚æ•°ï¼Œæ”¯æŒä¼ å…¥è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯</li>
<li>è¶…æ—¶åç«‹å³ä¸­æ–­ Promise é“¾ï¼Œè·³è½¬è‡³é”™è¯¯å¤„ç†é€»è¾‘</li>
<li>é”™è¯¯ç±»å‹ç»Ÿä¸€å½’ç±»ä¸º  PromiseLogicError ï¼Œé€šè¿‡  error.type  æ ‡è¯†è¶…æ—¶ç±»å‹</li>
</ul>
<h4 data-id="heading-8">ç¤ºä¾‹ï¼š</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">PromiseLogic</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'promise-logic'</span>;

<span class="hljs-title class_">PromiseLogic</span>.<span class="hljs-title function_">and</span>([
  <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>),
  <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">3000</span>)), <span class="hljs-comment">// 3ç§’ä»»åŠ¡</span>
  <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">3</span>)
])
.<span class="hljs-title function_">maxTimer</span>(<span class="hljs-number">2000</span>, <span class="hljs-string">'æ¥å£è¯·æ±‚è¶…æ—¶ï¼š2ç§’å†…æœªå®Œæˆæ‰€æœ‰æ“ä½œ'</span>) <span class="hljs-comment">// è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯</span>
.<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error.<span class="hljs-property">message</span>); <span class="hljs-comment">// è¾“å‡ºè‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯</span>
});
</code></pre>
<h3 data-id="heading-9">3. TypeScript ç±»å‹ä¿®å¤</h3>
<h4 data-id="heading-10">éš¾ç‚¹åˆ†æï¼š</h4>
<ul>
<li>è§£å†³ TypeScript ç‰ˆæœ¬ä¸­ç±»å‹æ¨æ–­ä¸å‡†ç¡®çš„é—®é¢˜</li>
<li>æ”¯æŒæ˜¾å¼ç±»å‹æ–­è¨€ä¸è‡ªåŠ¨ç±»å‹æ¨æ–­åŒæ¨¡å¼</li>
<li>ç¡®ä¿æ‰€æœ‰é€»è¾‘é—¨æ–¹æ³•çš„ç±»å‹å®šä¹‰ä¸€è‡´æ€§</li>
</ul>
<h4 data-id="heading-11">è§£å†³æ–¹æ¡ˆï¼š</h4>
<ul>
<li>é‡æ„ TypeScript ç±»å‹å£°æ˜æ–‡ä»¶ï¼Œä¼˜åŒ–æ³›å‹çº¦æŸ</li>
<li>ä¸ºæ‰€æœ‰æ ¸å¿ƒæ–¹æ³•æ·»åŠ æ³›å‹æ”¯æŒï¼Œæ”¯æŒæ˜¾å¼æŒ‡å®šè¿”å›ç±»å‹</li>
<li>ä¿®å¤  majority ã€ allFulfilled  ç­‰æ–¹æ³•çš„ç±»å‹æ¨æ–­æ¼æ´</li>
</ul>
<h4 data-id="heading-12">ç¤ºä¾‹ï¼š</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">PromiseLogic</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'promise-logic/typescript'</span>;

<span class="hljs-comment">// æ˜¾å¼ç±»å‹æ–­è¨€</span>
<span class="hljs-title class_">PromiseLogic</span>.<span class="hljs-title function_">majority</span>([<span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api1'</span>), <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api2'</span>)])
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">results: Response[]</span>) =&gt;</span> { <span class="hljs-comment">/* ç±»å‹å®‰å…¨ */</span> });

<span class="hljs-comment">// è‡ªåŠ¨ç±»å‹æ¨æ–­</span>
<span class="hljs-title class_">PromiseLogic</span>.<span class="hljs-title function_">and</span>([<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>), <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">2</span>)])
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">results: number[]</span>) =&gt;</span> { <span class="hljs-comment">/* è‡ªåŠ¨æ¨æ–­ä¸ºnumberæ•°ç»„ */</span> });
</code></pre>
<h2 data-id="heading-13">äºŒã€é¡¹ç›®æ›´æ–°å†…å®¹</h2>
<ol>
<li>æ€§èƒ½ä¼˜åŒ–ï¼šåº•å±‚é‡æ„  allFulfilled ã€ allRejected  å®ç°ï¼Œå…¼é¡¾å³æ—¶è¿”å›ä¸é¡ºåºä¸€è‡´æ€§</li>
<li>è¶…æ—¶åŠŸèƒ½å¢å¼ºï¼š maxTimer  æ–¹æ³•æ”¯æŒè‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯ï¼Œé”™è¯¯ç±»å‹æ ‡å‡†åŒ–</li>
<li>TypeScript æ”¯æŒï¼šä¿®å¤ç±»å‹å£°æ˜é—®é¢˜ï¼Œå®Œå–„æ³›å‹æ”¯æŒï¼Œæ”¯æŒæ˜¾å¼/è‡ªåŠ¨ç±»å‹æ¨æ–­</li>
<li>æµ‹è¯•è¦†ç›–ï¼šæ–°å¢  allFulfilled ã€ allRejected ã€ maxTimer  å®Œæ•´å•å…ƒæµ‹è¯•ï¼Œè¦†ç›–ç‡100%</li>
<li>ä»£ç é‡æ„ï¼šä¼˜åŒ–é¡¹ç›®ç»“æ„ï¼Œæ‹†åˆ†é€»è¾‘æ¨¡å—ï¼Œæå‡å¯ç»´æŠ¤æ€§</li>
</ol>
<h2 data-id="heading-14">ä¸‰ã€ç‰ˆæœ¬æ›´æ–°è¯´æ˜</h2>
<ul>
<li>è‹±æ–‡ï¼š v2.8.0_Performance optimization for allFulfilled/allRejected, add custom error messages for maxTimer, fix TypeScript type issues, complete test cases, refactor code structure</li>
<li>ä¸­æ–‡ï¼š v2.8.0_ä¼˜åŒ– allFulfilled/allRejected æ€§èƒ½ï¼ŒmaxTimer æ”¯æŒè‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯ï¼Œä¿®å¤ TypeScript ç±»å‹é—®é¢˜ï¼Œå®Œå–„æµ‹è¯•ç”¨ä¾‹ï¼Œé‡æ„ä»£ç ç»“æ„</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[iOS æ¨¡æ‹Ÿå™¨ç®¡ç†å®Œå…¨æŒ‡å—ï¼šxcrun simctl ä»å…¥é—¨åˆ°ç²¾é€š]]></title>    <link>https://juejin.cn/post/7603238967290822708</link>    <guid>https://juejin.cn/post/7603238967290822708</guid>    <pubDate>2026-02-06T02:05:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603238967290822708" data-draft-id="7603043152673570831" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="iOS æ¨¡æ‹Ÿå™¨ç®¡ç†å®Œå…¨æŒ‡å—ï¼šxcrun simctl ä»å…¥é—¨åˆ°ç²¾é€š "/> <meta itemprop="keywords" content="iOS,Apple"/> <meta itemprop="datePublished" content="2026-02-06T02:05:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="wangruofeng"/> <meta itemprop="url" content="https://juejin.cn/user/712139266070296"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            iOS æ¨¡æ‹Ÿå™¨ç®¡ç†å®Œå…¨æŒ‡å—ï¼šxcrun simctl ä»å…¥é—¨åˆ°ç²¾é€š 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/712139266070296/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    wangruofeng
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T02:05:59.000Z" title="Fri Feb 06 2026 02:05:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p>æœ¬æ–‡æ•´ç†äº†å¼€å‘è¿‡ç¨‹ä¸­å¸¸ç”¨çš„ <code>xcrun simctl</code> å‘½ä»¤ï¼Œç”¨äºç®¡ç† iOS æ¨¡æ‹Ÿå™¨å’Œè¿è¡Œæ—¶ç¯å¢ƒã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f41d40c96854ecb85d63ea2bd410ccf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2FuZ3J1b2Zlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770948360&amp;x-signature=G%2FzqrPfrVQj4C4Mby1cMWtGbvxk%3D" alt="iOS æ¨¡æ‹Ÿå™¨ç®¡ç†å®Œå…¨æŒ‡å—å°é¢_compressed.webp" loading="lazy"/></p>
<p><code>xcrun</code> æ˜¯ macOS ä¸Šçš„ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºåœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œ Xcode å¼€å‘å·¥å…·é“¾ä¸­çš„å„ç§å·¥å…·å’Œå®ç”¨ç¨‹åºï¼Œè€Œæ— éœ€ç›´æ¥æŒ‡å®šå…¶å®Œæ•´è·¯å¾„ã€‚è¿™ä½¿å¾—åœ¨ç»ˆç«¯ä¸­æ›´è½»æ¾åœ°è°ƒç”¨å’Œç®¡ç† Xcode ç›¸å…³çš„å·¥å…·ã€‚</p>
<h2 data-id="heading-0">è¿è¡Œæ—¶ç®¡ç†</h2>
<h3 data-id="heading-1">åˆ—å‡ºæ‰€æœ‰è¿è¡Œæ—¶</h3>
<pre><code class="hljs language-bash" lang="bash">xcrun simctl list runtimes
</code></pre>
<p><strong>è¯´æ˜</strong>ï¼šæ˜¾ç¤ºæ‰€æœ‰å·²å®‰è£…çš„ iOSã€watchOSã€tvOS ç­‰è¿è¡Œæ—¶ç¯å¢ƒï¼ŒåŒ…æ‹¬è¿è¡Œæ—¶ç‰ˆæœ¬ã€æ„å»ºå·å’Œå”¯ä¸€æ ‡è¯†ç¬¦ã€‚</p>
<h3 data-id="heading-2">åˆ—å‡ºå¯ç”¨çš„è¿è¡Œæ—¶</h3>
<pre><code class="hljs language-bash" lang="bash">xcrun simctl list runtimes available
</code></pre>
<p><strong>è¯´æ˜</strong>ï¼šä»…æ˜¾ç¤ºå½“å‰å¯ç”¨çš„è¿è¡Œæ—¶ï¼Œè¿‡æ»¤æ‰ä¸å¯ç”¨çš„ç‰ˆæœ¬ã€‚</p>
<h3 data-id="heading-3">JSON æ ¼å¼è¾“å‡º</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¾“å‡ºä¸º JSON æ ¼å¼ï¼ˆé€‚åˆè„šæœ¬å¤„ç†ï¼‰</span>
xcrun simctl list runtimes -j
xcrun simctl runtime list --json
</code></pre>
<h3 data-id="heading-4">æ·»åŠ è¿è¡Œæ—¶</h3>
<pre><code class="hljs language-bash" lang="bash">xcrun simctl runtime add <span class="hljs-string">"path/to/Simulator_Runtime.dmg"</span>
</code></pre>
<p><strong>è¯´æ˜</strong>ï¼šå®‰è£…æŒ‡å®šçš„è¿è¡Œæ—¶ç¯å¢ƒã€‚éœ€è¦ä» Apple å¼€å‘è€…ç½‘ç«™ä¸‹è½½å¯¹åº”çš„ <code>.dmg</code> æ–‡ä»¶ã€‚</p>
<h3 data-id="heading-5">åˆ é™¤è¿è¡Œæ—¶</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ¨èæ–¹å¼</span>
xcrun simctl runtime delete com.apple.CoreSimulator.SimRuntime.iOS-18-2

<span class="hljs-comment"># åˆ é™¤æŒ‡å®šå¤©æ•°æœªä½¿ç”¨çš„è¿è¡Œæ—¶</span>
xcrun simctl runtime delete --notUsedSinceDays 30

<span class="hljs-comment"># é¢„è§ˆå°†è¦åˆ é™¤çš„å†…å®¹ï¼ˆä¸å®é™…åˆ é™¤ï¼‰</span>
xcrun simctl runtime delete com.apple.CoreSimulator.SimRuntime.iOS-18-2 --dry-run
</code></pre>
<p><strong>å¸¸è§è¿è¡Œæ—¶æ ‡è¯†ç¬¦</strong>ï¼š</p>
<ul>
<li><code>com.apple.CoreSimulator.SimRuntime.iOS-18-2</code></li>
<li><code>com.apple.CoreSimulator.SimRuntime.iOS-17-5</code></li>
<li><code>com.apple.CoreSimulator.SimRuntime.tvOS-18-1</code></li>
</ul>
<hr/>
<h2 data-id="heading-6">è®¾å¤‡ç®¡ç†</h2>
<h3 data-id="heading-7">åˆ—å‡ºå’Œç­›é€‰è®¾å¤‡</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ—å‡ºè®¾å¤‡å’Œè¿è¡Œæ—¶</span>
xcrun simctl list devices
xcrun simctl list runtimes

<span class="hljs-comment"># åˆ—å‡ºè®¾å¤‡ç±»å‹ï¼ˆé»˜è®¤è¡Œä¸ºï¼‰</span>
xcrun simctl list

<span class="hljs-comment"># è¾“å‡ºä¸º JSON æ ¼å¼</span>
xcrun simctl list devices --json

<span class="hljs-comment"># è·å–æ‰€æœ‰çš„è®¾å¤‡ï¼ˆåŒ…å«çœŸæœºï¼‰ä½¿ç”¨ xctrace</span>
xcrun xctrace list devices

<span class="hljs-comment"># ç­›é€‰ç‰¹å®šç‰ˆæœ¬çš„è®¾å¤‡</span>
xcrun simctl list devices | grep -A 20 <span class="hljs-string">"iOS 18.2"</span>

<span class="hljs-comment"># åˆ—å‡ºè®¾å¤‡ç±»å‹</span>
xcrun simctl list devicetypes
</code></pre>
<p><strong>è¯´æ˜</strong>ï¼š</p>
<ul>
<li>ä¸å¸¦å‚æ•°çš„ <code>list</code> é»˜è®¤æ˜¾ç¤ºè®¾å¤‡ç±»å‹</li>
<li>ä½¿ç”¨ <code>list devices</code> æ˜¾ç¤ºå·²åˆ›å»ºçš„æ¨¡æ‹Ÿå™¨è®¾å¤‡</li>
<li>ä½¿ç”¨ <code>list runtimes</code> æ˜¾ç¤ºè¿è¡Œæ—¶ç¯å¢ƒ</li>
<li>ä½¿ç”¨ <code>grep</code> ç­›é€‰ç‰¹å®š iOS ç‰ˆæœ¬çš„è®¾å¤‡ï¼Œ<code>-A 20</code> è¡¨ç¤ºæ˜¾ç¤ºåŒ¹é…è¡ŒåŠåç»­ 20 è¡Œ</li>
</ul>
<h3 data-id="heading-8">è®¾å¤‡æ“ä½œ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ é™¤ä¸å¯ç”¨çš„è®¾å¤‡</span>
xcrun simctl delete unavailable

<span class="hljs-comment"># åˆ›å»ºæ–°è®¾å¤‡</span>
xcrun simctl create <span class="hljs-string">"My iPhone 15"</span> <span class="hljs-string">"iPhone 15"</span> <span class="hljs-string">"iOS18.2"</span>

<span class="hljs-comment"># å…‹éš†ç°æœ‰è®¾å¤‡</span>
xcrun simctl <span class="hljs-built_in">clone</span> &lt;sourceUDID&gt; <span class="hljs-string">"New Device Name"</span>

<span class="hljs-comment"># é‡å‘½åè®¾å¤‡</span>
xcrun simctl rename &lt;UDID&gt; <span class="hljs-string">"New Device Name"</span>

<span class="hljs-comment"># å‡çº§è®¾å¤‡åˆ°æ–°è¿è¡Œæ—¶</span>
xcrun simctl upgrade &lt;UDID&gt; &lt;runtime_identifier&gt;
</code></pre>
<h3 data-id="heading-9">è®¾å¤‡æ§åˆ¶</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ‰“å¼€ä¸Šæ¬¡å¯åŠ¨çš„æ¨¡æ‹Ÿå™¨</span>
open -a simulator

<span class="hljs-comment"># å¯åŠ¨æŒ‡å®šæ¨¡æ‹Ÿå™¨</span>
xcrun simctl boot &lt;UDID&gt;

<span class="hljs-comment"># å…³é—­æŒ‡å®šæ¨¡æ‹Ÿå™¨</span>
xcrun simctl shutdown &lt;UDID&gt;

<span class="hljs-comment"># é‡ç½®æŒ‡å®šæ¨¡æ‹Ÿå™¨</span>
xcrun simctl erase &lt;UDID&gt;

<span class="hljs-comment"># æ¸…é™¤æ‰€æœ‰ iOS æ¨¡æ‹Ÿå™¨ç¼“å­˜</span>
xcrun simctl erase all

<span class="hljs-comment"># åˆ‡æ¢ä¸»é¢˜æ¨¡å¼</span>
xcrun simctl ui &lt;UDID&gt; appearance light  <span class="hljs-comment"># æµ…è‰²ä¸»é¢˜</span>
xcrun simctl ui &lt;UDID&gt; appearance dark   <span class="hljs-comment"># æ·±è‰²ä¸»é¢˜</span>
</code></pre>
<hr/>
<h2 data-id="heading-10">åº”ç”¨å’Œæ•°æ®ç®¡ç†</h2>
<h3 data-id="heading-11">åº”ç”¨å®‰è£…å’Œå¯åŠ¨</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…åº”ç”¨</span>
xcrun simctl install &lt;UDID&gt; &lt;path/to/app.app&gt;

<span class="hljs-comment"># å¯åŠ¨æŒ‡å®šåº”ç”¨</span>
xcrun simctl launch booted &lt;packageName&gt;
xcrun simctl launch &lt;UDID&gt; &lt;packageName&gt;

<span class="hljs-comment"># å…³é—­å·²æ‰“å¼€çš„åº”ç”¨</span>
xcrun simctl terminate booted &lt;packageName&gt;
xcrun simctl terminate &lt;UDID&gt; &lt;packageName&gt;

<span class="hljs-comment"># å¸è½½åº”ç”¨</span>
xcrun simctl uninstall &lt;UDID&gt; &lt;bundleIdentifier&gt;

<span class="hljs-comment"># è·å–åº”ç”¨å®¹å™¨è·¯å¾„</span>
xcrun simctl get_app_container &lt;UDID&gt; &lt;bundleIdentifier&gt;

<span class="hljs-comment"># å®‰è£…åº”ç”¨æ•°æ®</span>
xcrun simctl install_app_data &lt;UDID&gt; &lt;path/to/data.xcappdata&gt;
</code></pre>
<h3 data-id="heading-12">éšç§å’Œæƒé™ç®¡ç†</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æˆäºˆæ‰€æœ‰æƒé™</span>
xcrun simctl privacy booted grant all &lt;packageName&gt;

<span class="hljs-comment"># æˆäºˆç‰¹å®šæƒé™</span>
xcrun simctl privacy booted grant photos &lt;packageName&gt;

<span class="hljs-comment"># æ’¤é”€æƒé™</span>
xcrun simctl privacy booted revoke camera &lt;packageName&gt;

<span class="hljs-comment"># é‡ç½®æƒé™</span>
xcrun simctl privacy booted reset all &lt;packageName&gt;
</code></pre>
<h3 data-id="heading-13">çŠ¶æ€æ æ§åˆ¶</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è®¾ç½®æ—¶é—´</span>
xcrun simctl status_bar booted override --time 23:59

<span class="hljs-comment"># è®¾ç½®ç”µé‡ä¸º50</span>
xcrun simctl status_bar booted override --batteryLevel 50

<span class="hljs-comment"># è®¾ç½®æ•°æ®ç½‘ç»œç±»å‹</span>
xcrun simctl status_bar booted override --dataNetwork 5g

<span class="hljs-comment"># è®¾ç½® WiFi ä¿¡å·æ ï¼ˆ0-3ï¼‰</span>
xcrun simctl status_bar booted override --wifiBars 3

<span class="hljs-comment"># è®¾ç½®è¿è¥å•†åç§°</span>
xcrun simctl status_bar booted override --operatorName <span class="hljs-string">'ä¸­å›½ç”µä¿¡'</span>

<span class="hljs-comment"># æ¸…é™¤æ‰€æœ‰ä¿®æ”¹</span>
xcrun simctl status_bar booted clear
</code></pre>
<hr/>
<h2 data-id="heading-14">æˆªå›¾å’Œå½•å±</h2>
<blockquote>
<p><code>booted</code> ä»£è¡¨å½“å‰å¯åŠ¨çš„æ¨¡æ‹Ÿå™¨ï¼›ä¹Ÿå¯æŒ‡å®šæ¨¡æ‹Ÿå™¨ <code>&lt;UDID&gt;</code></p>
</blockquote>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æˆªå›¾</span>
xcrun simctl io booted screenshot xxx.png
xcrun simctl io &lt;UDID&gt; screenshot xxx.png

<span class="hljs-comment"># å½•åˆ¶æ¨¡æ‹Ÿå™¨è§†é¢‘ï¼ˆåœ¨ç»ˆç«¯æŒ‰ Ctrl+C æ¥åœæ­¢å½•å±ï¼‰</span>
xcrun simctl io booted recordVideo test.mp4

<span class="hljs-comment"># ä¿å­˜åˆ°æŒ‡å®šç›®å½•</span>
xcrun simctl io booted screenshot ~/Desktop/screenshot.png
xcrun simctl io booted screenshot /Users/username/Pictures/screenshot.png
</code></pre>
<hr/>
<h2 data-id="heading-15">é«˜çº§åŠŸèƒ½</h2>
<h3 data-id="heading-16">å‰ªè´´æ¿æ“ä½œ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¤åˆ¶åˆ°å‰ªè´´æ¿</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Hello"</span> | xcrun simctl pbcopy &lt;UDID&gt;

<span class="hljs-comment"># ç²˜è´´å‰ªè´´æ¿å†…å®¹</span>
xcrun simctl pbpaste &lt;UDID&gt;

<span class="hljs-comment"># åœ¨è®¾å¤‡é—´åŒæ­¥å‰ªè´´æ¿å†…å®¹</span>
xcrun simctl pbsync &lt;sourceUDID&gt; &lt;destinationUDID&gt;
</code></pre>
<h3 data-id="heading-17">URL å’Œä½ç½®</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ‰“å¼€ URL</span>
xcrun simctl openurl booted <span class="hljs-string">"https://www.example.com"</span>

<span class="hljs-comment"># è®¾ç½®æ¨¡æ‹Ÿä½ç½®</span>
xcrun simctl location booted <span class="hljs-built_in">set</span> 37.7749,-122.4194

<span class="hljs-comment"># æ¸…é™¤æ¨¡æ‹Ÿä½ç½®</span>
xcrun simctl location booted clear
</code></pre>
<h3 data-id="heading-18">æ¨é€é€šçŸ¥</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å‘é€æ¨¡æ‹Ÿæ¨é€é€šçŸ¥</span>
xcrun simctl push booted &lt;bundleIdentifier&gt; &lt;path/to/push.json&gt;
</code></pre>
<p>æ¨é€é€šçŸ¥ JSON ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"aps"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"alert"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Test Push Notification"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"badge"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"sound"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"default"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-19">Keychain å’Œåª’ä½“æ–‡ä»¶</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ·»åŠ é’¥åŒ™æ¡ç›®</span>
xcrun simctl keychain booted add-root-cert &lt;path/to/cert.der&gt;

<span class="hljs-comment"># åˆ é™¤é’¥åŒ™ä¸²</span>
xcrun simctl keychain booted reset

<span class="hljs-comment"># æ·»åŠ ç…§ç‰‡åˆ°è®¾å¤‡</span>
xcrun simctl addmedia booted ~/Photos/photo.jpg

<span class="hljs-comment"># æ·»åŠ è§†é¢‘åˆ°è®¾å¤‡</span>
xcrun simctl addmedia booted ~/Videos/video.mp4
</code></pre>
<h3 data-id="heading-20">ç¯å¢ƒå˜é‡å’Œç³»ç»Ÿä¿¡æ¯</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è·å–å¯åŠ¨çš„æ¨¡æ‹Ÿå™¨ UDID</span>
xcrun simctl getenv booted SIMULATOR_UDID

<span class="hljs-comment"># è·å–ç¯å¢ƒå˜é‡</span>
xcrun simctl getenv &lt;UDID&gt; &lt;variable_name&gt;

<span class="hljs-comment"># è¯»å–æ‰€æœ‰ iOS æ¨¡æ‹Ÿå™¨çš„ä¿¡æ¯</span>
defaults <span class="hljs-built_in">read</span> com.apple.iphonesimulator

<span class="hljs-comment"># è§¦å‘ iCloud åŒæ­¥</span>
xcrun simctl icloud_sync booted

<span class="hljs-comment"># å¯ç”¨è¯¦ç»†æ—¥å¿—</span>
xcrun simctl logverbose booted <span class="hljs-built_in">enable</span>

<span class="hljs-comment"># ç¦ç”¨è¯¦ç»†æ—¥å¿—</span>
xcrun simctl logverbose booted <span class="hljs-built_in">disable</span>
</code></pre>
<hr/>
<h2 data-id="heading-21">è¯Šæ–­å·¥å…·</h2>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åŸºæœ¬è¯Šæ–­</span>
xcrun simctl diagnose

<span class="hljs-comment"># æŒ‡å®šè¾“å‡ºç›®å½•</span>
xcrun simctl diagnose --output ~/Desktop/diag

<span class="hljs-comment"># åŒ…å«æ‰€æœ‰è®¾å¤‡æ—¥å¿—</span>
xcrun simctl diagnose --all-logs

<span class="hljs-comment"># ä¸åˆ›å»ºå‹ç¼©åŒ…</span>
xcrun simctl diagnose --no-archive

<span class="hljs-comment"># æ— è¶…æ—¶è¿è¡Œ</span>
xcrun simctl diagnose -X
</code></pre>
<p><strong>è¯´æ˜</strong>ï¼šç”Ÿæˆæ¨¡æ‹Ÿå™¨è¯Šæ–­æŠ¥å‘Šï¼Œç”¨äºæ’æŸ¥æ¨¡æ‹Ÿå™¨é—®é¢˜å’Œæ•…éšœã€‚å¸¸ç”¨å‚æ•°ï¼š</p>
<ul>
<li><code>--output</code>: æŒ‡å®šè¾“å‡ºç›®å½•</li>
<li><code>--all-logs</code>: åŒ…å«æ‰€æœ‰è®¾å¤‡æ—¥å¿—</li>
<li><code>--no-archive</code>: ä¸åˆ›å»ºå‹ç¼©åŒ…</li>
<li><code>-X</code>: æ— è¶…æ—¶è¿è¡Œï¼ˆå¿½ç•¥è¶…æ—¶è®¾ç½®ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-22">å¸¸è§ä½¿ç”¨åœºæ™¯</h2>
<h3 data-id="heading-23">åœºæ™¯ 1ï¼šæ¸…ç†æ—§ç‰ˆæœ¬è¿è¡Œæ—¶</h3>
<p>å½“éœ€è¦å‡çº§åˆ°æ–°çš„ iOS ç‰ˆæœ¬æ—¶ï¼Œå¯ä»¥åˆ é™¤æ—§è¿è¡Œæ—¶ä»¥é‡Šæ”¾ç©ºé—´ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æŸ¥çœ‹å½“å‰è¿è¡Œæ—¶</span>
xcrun simctl list runtimes

<span class="hljs-comment"># 2. åˆ é™¤ä¸éœ€è¦çš„è¿è¡Œæ—¶</span>
sudo xcrun simctl runtime delete com.apple.CoreSimulator.SimRuntime.iOS-18-2

<span class="hljs-comment"># 3. ç¡®è®¤åˆ é™¤æˆåŠŸ</span>
xcrun simctl list runtimes
</code></pre>
<h3 data-id="heading-24">åœºæ™¯ 2ï¼šæ¸…ç†æ— æ•ˆè®¾å¤‡</h3>
<p>å®šæœŸæ¸…ç†å¤±æ•ˆçš„æ¨¡æ‹Ÿå™¨è®¾å¤‡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æŸ¥çœ‹æ‰€æœ‰è®¾å¤‡</span>
xcrun simctl list

<span class="hljs-comment"># 2. åˆ é™¤ä¸å¯ç”¨çš„è®¾å¤‡</span>
xcrun simctl delete unavailable

<span class="hljs-comment"># 3. éªŒè¯æ¸…ç†ç»“æœ</span>
xcrun simctl list
</code></pre>
<h3 data-id="heading-25">åœºæ™¯ 3ï¼šæ£€æŸ¥ç‰¹å®šç‰ˆæœ¬çš„è®¾å¤‡</h3>
<p>æŸ¥æ‰¾ä½¿ç”¨ç‰¹å®š iOS ç‰ˆæœ¬çš„è®¾å¤‡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥æ‰¾ iOS 18.2 çš„è®¾å¤‡</span>
xcrun simctl list devices | grep -A 20 <span class="hljs-string">"iOS 18.2"</span>

<span class="hljs-comment"># ä½¿ç”¨ JSON å’Œ jq è¿›è¡Œæ›´ç²¾ç¡®çš„è¿‡æ»¤</span>
xcrun simctl list devices --json | jq <span class="hljs-string">'.devices'</span>
</code></pre>
<h3 data-id="heading-26">åœºæ™¯ 4ï¼šæ‰¹é‡æ¸…ç†æ—§è¿è¡Œæ—¶</h3>
<p>å®šæœŸæ¸…ç†æœªä½¿ç”¨çš„è¿è¡Œæ—¶ä»¥é‡Šæ”¾ç£ç›˜ç©ºé—´ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æŸ¥çœ‹æ‰€æœ‰è¿è¡Œæ—¶ï¼ˆè¯¦ç»†ä¿¡æ¯ï¼‰</span>
xcrun simctl runtime list -v

<span class="hljs-comment"># 2. é¢„è§ˆå°†è¦åˆ é™¤çš„è¿è¡Œæ—¶ï¼ˆå®‰å…¨æ¨¡å¼ï¼‰</span>
xcrun simctl runtime delete --notUsedSinceDays 30 --dry-run

<span class="hljs-comment"># 3. åˆ é™¤ 30 å¤©æœªä½¿ç”¨çš„è¿è¡Œæ—¶</span>
xcrun simctl runtime delete --notUsedSinceDays 30

<span class="hljs-comment"># 4. ç¡®è®¤æ¸…ç†ç»“æœ</span>
xcrun simctl list runtimes
</code></pre>
<h3 data-id="heading-27">åœºæ™¯ 5ï¼šè‡ªåŠ¨åŒ–æµ‹è¯•æˆªå›¾</h3>
<p>åœ¨è‡ªåŠ¨åŒ–æµ‹è¯•ä¸­æˆªå–å±å¹•æˆªå›¾ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨æ¨¡æ‹Ÿå™¨</span>
xcrun simctl boot &lt;UDID&gt;

<span class="hljs-comment"># å®‰è£…åº”ç”¨</span>
xcrun simctl install &lt;UDID&gt; /path/to/app.app

<span class="hljs-comment"># å¯åŠ¨åº”ç”¨</span>
xcrun simctl launch &lt;UDID&gt; com.example.app

<span class="hljs-comment"># ç­‰å¾…åº”ç”¨åŠ è½½...</span>

<span class="hljs-comment"># æˆªå›¾</span>
xcrun simctl io &lt;UDID&gt; screenshot screenshot.png

<span class="hljs-comment"># å½•åˆ¶è§†é¢‘</span>
xcrun simctl io &lt;UDID&gt; recordVideo demo.mp4
</code></pre>
<h3 data-id="heading-28">åœºæ™¯ 6ï¼šæ¨¡æ‹Ÿä¸åŒçŠ¶æ€æ çŠ¶æ€</h3>
<p>æµ‹è¯•åº”ç”¨åœ¨ä¸åŒçŠ¶æ€æ çŠ¶æ€ä¸‹çš„è¡¨ç°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ¨¡æ‹Ÿä½ç”µé‡</span>
xcrun simctl status_bar booted override --batteryLevel 10

<span class="hljs-comment"># æ¨¡æ‹Ÿç‰¹å®šæ—¶é—´</span>
xcrun simctl status_bar booted override --time 23:59

<span class="hljs-comment"># æ¨¡æ‹Ÿæ— ä¿¡å·</span>
xcrun simctl status_bar booted override --wifiBars 0

<span class="hljs-comment"># æµ‹è¯•å®Œæˆåæ¸…é™¤</span>
xcrun simctl status_bar booted clear
</code></pre>
<h3 data-id="heading-29">åœºæ™¯ 7ï¼šæµ‹è¯•æ¨é€é€šçŸ¥</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºæ¨é€é€šçŸ¥æ–‡ä»¶</span>
<span class="hljs-built_in">cat</span> &gt; push.json &lt;&lt; <span class="hljs-string">EOF
{
  "aps": {
    "alert": {
      "title": "æ–°æ¶ˆæ¯",
      "body": "æ‚¨æœ‰ä¸€æ¡æ–°æ¶ˆæ¯"
    },
    "badge": 1,
    "sound": "default"
  }
}
EOF</span>

<span class="hljs-comment"># å‘é€æ¨é€é€šçŸ¥</span>
xcrun simctl push booted com.example.app push.json
</code></pre>
<hr/>
<h2 data-id="heading-30">å‘½ä»¤é€ŸæŸ¥è¡¨</h2>
<h3 data-id="heading-31">è¿è¡Œæ—¶ç®¡ç†</h3>





























<table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>xcrun simctl list runtimes</code></td><td>åˆ—å‡ºæ‰€æœ‰è¿è¡Œæ—¶</td></tr><tr><td><code>xcrun simctl runtime list</code></td><td>åˆ—å‡ºå¯ç”¨è¿è¡Œæ—¶</td></tr><tr><td><code>xcrun simctl runtime add &lt;path&gt;</code></td><td>æ·»åŠ è¿è¡Œæ—¶</td></tr><tr><td><code>xcrun simctl runtime delete &lt;identifier&gt;</code></td><td>åˆ é™¤è¿è¡Œæ—¶ï¼ˆæ¨èï¼‰</td></tr><tr><td><code>xcrun simctl runtime delete --notUsedSinceDays &lt;days&gt;</code></td><td>åˆ é™¤æŒ‡å®šå¤©æ•°æœªä½¿ç”¨çš„è¿è¡Œæ—¶</td></tr></tbody></table>
<h3 data-id="heading-32">è®¾å¤‡ç®¡ç†</h3>





































<table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>xcrun simctl list devices</code></td><td>åˆ—å‡ºæ‰€æœ‰è®¾å¤‡</td></tr><tr><td><code>xcrun simctl list devicetypes</code></td><td>åˆ—å‡ºè®¾å¤‡ç±»å‹</td></tr><tr><td><code>xcrun simctl delete unavailable</code></td><td>åˆ é™¤ä¸å¯ç”¨è®¾å¤‡</td></tr><tr><td><code>xcrun simctl create &lt;name&gt; &lt;type&gt; &lt;runtime&gt;</code></td><td>åˆ›å»ºæ–°è®¾å¤‡</td></tr><tr><td><code>xcrun simctl clone &lt;UDID&gt; &lt;name&gt;</code></td><td>å…‹éš†è®¾å¤‡</td></tr><tr><td><code>xcrun simctl rename &lt;UDID&gt; &lt;name&gt;</code></td><td>é‡å‘½åè®¾å¤‡</td></tr><tr><td><code>xcrun simctl upgrade &lt;UDID&gt; &lt;runtime&gt;</code></td><td>å‡çº§è®¾å¤‡è¿è¡Œæ—¶</td></tr></tbody></table>
<h3 data-id="heading-33">è®¾å¤‡æ§åˆ¶</h3>

























<table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>xcrun simctl boot &lt;UDID&gt;</code></td><td>å¯åŠ¨æ¨¡æ‹Ÿå™¨</td></tr><tr><td><code>xcrun simctl shutdown &lt;UDID&gt;</code></td><td>å…³é—­æ¨¡æ‹Ÿå™¨</td></tr><tr><td><code>xcrun simctl erase &lt;UDID&gt;</code></td><td>é‡ç½®æ¨¡æ‹Ÿå™¨</td></tr><tr><td><code>xcrun simctl ui &lt;UDID&gt; appearance &lt;mode&gt;</code></td><td>åˆ‡æ¢ä¸»é¢˜æ¨¡å¼</td></tr></tbody></table>
<h3 data-id="heading-34">åº”ç”¨å’Œæ•°æ®</h3>













































<table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>xcrun simctl launch &lt;UDID&gt; &lt;bundleID&gt;</code></td><td>å¯åŠ¨åº”ç”¨</td></tr><tr><td><code>xcrun simctl terminate &lt;UDID&gt; &lt;bundleID&gt;</code></td><td>å…³é—­åº”ç”¨</td></tr><tr><td><code>xcrun simctl install &lt;UDID&gt; &lt;path&gt;</code></td><td>å®‰è£…åº”ç”¨</td></tr><tr><td><code>xcrun simctl uninstall &lt;UDID&gt; &lt;bundleID&gt;</code></td><td>å¸è½½åº”ç”¨</td></tr><tr><td><code>xcrun simctl get_app_container &lt;UDID&gt; &lt;bundleID&gt;</code></td><td>è·å–åº”ç”¨å®¹å™¨è·¯å¾„</td></tr><tr><td><code>xcrun simctl privacy &lt;UDID&gt; grant all &lt;bundleID&gt;</code></td><td>æˆäºˆæ‰€æœ‰æƒé™</td></tr><tr><td><code>xcrun simctl status_bar booted override --time &lt;time&gt;</code></td><td>è®¾ç½®æ—¶é—´</td></tr><tr><td><code>xcrun simctl status_bar booted override --batteryLevel &lt;level&gt;</code></td><td>è®¾ç½®ç”µé‡</td></tr><tr><td><code>xcrun simctl status_bar booted clear</code></td><td>æ¸…é™¤çŠ¶æ€æ ä¿®æ”¹</td></tr></tbody></table>
<h3 data-id="heading-35">æˆªå›¾å’Œå½•å±</h3>

















<table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>xcrun simctl io booted screenshot &lt;file.png&gt;</code></td><td>æˆªå›¾</td></tr><tr><td><code>xcrun simctl io booted recordVideo &lt;file.mp4&gt;</code></td><td>å½•åˆ¶è§†é¢‘</td></tr></tbody></table>
<h3 data-id="heading-36">é«˜çº§åŠŸèƒ½</h3>





















































<table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>xcrun simctl diagnose</code></td><td>è¿è¡Œè¯Šæ–­</td></tr><tr><td><code>xcrun simctl getenv booted SIMULATOR_UDID</code></td><td>è·å–å½“å‰æ¨¡æ‹Ÿå™¨ UDID</td></tr><tr><td><code>xcrun simctl openurl booted &lt;url&gt;</code></td><td>æ‰“å¼€ URL</td></tr><tr><td><code>xcrun simctl location booted set &lt;lat,lon&gt;</code></td><td>è®¾ç½®æ¨¡æ‹Ÿä½ç½®</td></tr><tr><td><code>xcrun simctl push booted &lt;bundleID&gt; &lt;json&gt;</code></td><td>å‘é€æ¨é€é€šçŸ¥</td></tr><tr><td><code>xcrun simctl pbcopy &lt;UDID&gt;</code></td><td>å¤åˆ¶åˆ°å‰ªè´´æ¿</td></tr><tr><td><code>xcrun simctl pbpaste &lt;UDID&gt;</code></td><td>ç²˜è´´å‰ªè´´æ¿å†…å®¹</td></tr><tr><td><code>xcrun simctl keychain booted add-root-cert &lt;path&gt;</code></td><td>æ·»åŠ è¯ä¹¦åˆ°é’¥åŒ™ä¸²</td></tr><tr><td><code>xcrun simctl addmedia booted &lt;path&gt;</code></td><td>æ·»åŠ åª’ä½“æ–‡ä»¶</td></tr><tr><td><code>xcrun simctl icloud_sync booted</code></td><td>è§¦å‘ iCloud åŒæ­¥</td></tr><tr><td><code>xcrun simctl logverbose booted enable/disable</code></td><td>å¯ç”¨/ç¦ç”¨è¯¦ç»†æ—¥å¿—</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-37">é«˜çº§ç”¨æ³•</h2>
<p><strong>JSON è¾“å‡ºå’Œè„šæœ¬åŒ–å¤„ç†</strong></p>
<p>æ‰€æœ‰ <code>list</code> å‘½ä»¤éƒ½æ”¯æŒ JSON è¾“å‡ºï¼Œé€‚åˆè„šæœ¬åŒ–å¤„ç†ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¾“å‡ºè¿è¡Œæ—¶ä¸º JSON æ ¼å¼</span>
xcrun simctl list runtimes -j

<span class="hljs-comment"># è¾“å‡ºè®¾å¤‡åˆ—è¡¨ä¸º JSON æ ¼å¼</span>
xcrun simctl list devices --json

<span class="hljs-comment"># ä½¿ç”¨ jq è¿›è¡Œè¿‡æ»¤å’Œæ ¼å¼åŒ–</span>
xcrun simctl list runtimes -j | jq <span class="hljs-string">'.runtimes[] | select(.name | contains("iOS"))'</span>

<span class="hljs-comment"># è·å–æ‰€æœ‰è®¾å¤‡ UDID</span>
xcrun simctl list devices --json | jq -r <span class="hljs-string">'.devices | to_entries[] | .value[] | .udid'</span>

<span class="hljs-comment"># è·å–æ‰€æœ‰å·²å¯åŠ¨çš„è®¾å¤‡</span>
xcrun simctl list devices --json | jq -r <span class="hljs-string">'.devices | to_entries[] | .value[] | select(.state == "Booted") | .udid'</span>

<span class="hljs-comment"># è·å–ç‰¹å®šè¿è¡Œæ—¶çš„æ‰€æœ‰è®¾å¤‡</span>
xcrun simctl list devices --json | jq -r <span class="hljs-string">'.devices | to_entries[] | .value[] | select(.runtime.identifier | contains("iOS18-2")) | .name'</span>
</code></pre>
<hr/>
<h2 data-id="heading-38">å®Œæ•´å‘½ä»¤å‚è€ƒ</h2>
<p><code>xcrun simctl</code> æ”¯æŒçš„æ‰€æœ‰å­å‘½ä»¤ï¼š</p>





























































































































































<table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>addmedia</code></td><td>æ·»åŠ ç…§ç‰‡ã€å®æ—¶ç…§ç‰‡ã€è§†é¢‘æˆ–è”ç³»äººåˆ°è®¾å¤‡åº“</td></tr><tr><td><code>boot</code></td><td>å¯åŠ¨è®¾å¤‡æˆ–è®¾å¤‡å¯¹</td></tr><tr><td><code>clone</code></td><td>å…‹éš†ç°æœ‰è®¾å¤‡</td></tr><tr><td><code>create</code></td><td>åˆ›å»ºæ–°è®¾å¤‡</td></tr><tr><td><code>delete</code></td><td>åˆ é™¤æŒ‡å®šè®¾å¤‡ã€ä¸å¯ç”¨è®¾å¤‡æˆ–æ‰€æœ‰è®¾å¤‡</td></tr><tr><td><code>diagnose</code></td><td>æ”¶é›†è¯Šæ–­ä¿¡æ¯å’Œæ—¥å¿—</td></tr><tr><td><code>erase</code></td><td>æ“¦é™¤è®¾å¤‡çš„å†…å®¹å’Œè®¾ç½®</td></tr><tr><td><code>get_app_container</code></td><td>æ‰“å°å·²å®‰è£…åº”ç”¨çš„å®¹å™¨è·¯å¾„</td></tr><tr><td><code>getenv</code></td><td>æ‰“å°è¿è¡Œè®¾å¤‡çš„ç¯å¢ƒå˜é‡</td></tr><tr><td><code>help</code></td><td>æ‰“å°ç»™å®šå­å‘½ä»¤çš„ä½¿ç”¨è¯´æ˜</td></tr><tr><td><code>icloud_sync</code></td><td>åœ¨è®¾å¤‡ä¸Šè§¦å‘ iCloud åŒæ­¥</td></tr><tr><td><code>install</code></td><td>åœ¨è®¾å¤‡ä¸Šå®‰è£…åº”ç”¨</td></tr><tr><td><code>install_app_data</code></td><td>å®‰è£… xcappdata åŒ…åˆ°è®¾å¤‡ï¼Œæ›¿æ¢å®¹å™¨å½“å‰å†…å®¹</td></tr><tr><td><code>io</code></td><td>è®¾ç½®è®¾å¤‡ IO æ“ä½œ</td></tr><tr><td><code>keychain</code></td><td>æ“ä½œè®¾å¤‡é’¥åŒ™ä¸²</td></tr><tr><td><code>launch</code></td><td>åœ¨è®¾å¤‡ä¸Šé€šè¿‡æ ‡è¯†ç¬¦å¯åŠ¨åº”ç”¨</td></tr><tr><td><code>list</code></td><td>åˆ—å‡ºå¯ç”¨è®¾å¤‡ã€è®¾å¤‡ç±»å‹ã€è¿è¡Œæ—¶æˆ–è®¾å¤‡å¯¹</td></tr><tr><td><code>location</code></td><td>æ§åˆ¶è®¾å¤‡çš„æ¨¡æ‹Ÿä½ç½®</td></tr><tr><td><code>logverbose</code></td><td>å¯ç”¨æˆ–ç¦ç”¨è®¾å¤‡çš„è¯¦ç»†æ—¥å¿—</td></tr><tr><td><code>openurl</code></td><td>åœ¨è®¾å¤‡ä¸­æ‰“å¼€ URL</td></tr><tr><td><code>pair</code></td><td>åˆ›å»ºæ–°æ‰‹è¡¨å’Œæ‰‹æœºå¯¹</td></tr><tr><td><code>pair_activate</code></td><td>å°†ç»™å®šçš„å¯¹è®¾ç½®ä¸ºæ´»åŠ¨</td></tr><tr><td><code>pbcopy</code></td><td>å°†æ ‡å‡†è¾“å…¥å¤åˆ¶åˆ°è®¾å¤‡å‰ªè´´æ¿</td></tr><tr><td><code>pbpaste</code></td><td>å°†è®¾å¤‡å‰ªè´´æ¿å†…å®¹æ‰“å°åˆ°æ ‡å‡†è¾“å‡º</td></tr><tr><td><code>pbsync</code></td><td>å°†å‰ªè´´æ¿å†…å®¹ä»ä¸€ä¸ªå‰ªè´´æ¿åŒæ­¥åˆ°å¦ä¸€ä¸ª</td></tr><tr><td><code>privacy</code></td><td>æˆäºˆã€æ’¤é”€æˆ–é‡ç½®éšç§å’Œæƒé™</td></tr><tr><td><code>push</code></td><td>å‘é€æ¨¡æ‹Ÿæ¨é€é€šçŸ¥</td></tr><tr><td><code>rename</code></td><td>é‡å‘½åè®¾å¤‡</td></tr><tr><td><code>runtime</code></td><td>å¯¹è¿è¡Œæ—¶æ‰§è¡Œæ“ä½œ</td></tr><tr><td><code>shutdown</code></td><td>å…³é—­è®¾å¤‡</td></tr><tr><td><code>spawn</code></td><td>é€šè¿‡åœ¨è®¾å¤‡ä¸Šæ‰§è¡Œç»™å®šå¯æ‰§è¡Œæ–‡ä»¶æ¥ç”Ÿæˆè¿›ç¨‹</td></tr><tr><td><code>status_bar</code></td><td>è®¾ç½®æˆ–æ¸…é™¤çŠ¶æ€æ è¦†ç›–</td></tr><tr><td><code>terminate</code></td><td>åœ¨è®¾å¤‡ä¸Šé€šè¿‡æ ‡è¯†ç¬¦ç»ˆæ­¢åº”ç”¨</td></tr><tr><td><code>ui</code></td><td>è·å–æˆ–è®¾ç½® UI é€‰é¡¹</td></tr><tr><td><code>uninstall</code></td><td>ä»è®¾å¤‡å¸è½½åº”ç”¨</td></tr><tr><td><code>unpair</code></td><td>å–æ¶ˆæ‰‹è¡¨å’Œæ‰‹æœºå¯¹</td></tr><tr><td><code>upgrade</code></td><td>å°†è®¾å¤‡å‡çº§åˆ°æ›´æ–°çš„è¿è¡Œæ—¶</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-39">æ³¨æ„äº‹é¡¹</h2>
<ol>
<li><strong>æƒé™é—®é¢˜</strong>ï¼šåˆ é™¤è¿è¡Œæ—¶é€šå¸¸éœ€è¦ <code>sudo</code> æƒé™</li>
<li><strong>è®¾å¤‡ä¾èµ–</strong>ï¼šåˆ é™¤è¿è¡Œæ—¶å‰ç¡®ä¿æ²¡æœ‰è®¾å¤‡åœ¨ä½¿ç”¨è¯¥è¿è¡Œæ—¶</li>
<li><strong>ç£ç›˜ç©ºé—´</strong>ï¼šè¿è¡Œæ—¶å ç”¨è¾ƒå¤§ç£ç›˜ç©ºé—´ï¼ˆé€šå¸¸ 10GB+ï¼‰ï¼Œå®šæœŸæ¸…ç†å¯é‡Šæ”¾ç©ºé—´</li>
<li><strong>Xcode ç‰ˆæœ¬</strong>ï¼šä¸åŒ Xcode ç‰ˆæœ¬æ”¯æŒçš„è¿è¡Œæ—¶ç‰ˆæœ¬å¯èƒ½ä¸åŒ</li>
<li><strong>JSON è¾“å‡º</strong>ï¼šä½¿ç”¨ <code>-j</code> æˆ– <code>--json</code> å‚æ•°ä¾¿äºè„šæœ¬å¤„ç†å’Œæ•°æ®åˆ†æ</li>
<li><strong>UDID vs booted</strong>ï¼š
<ul>
<li>ä½¿ç”¨ <code>&lt;UDID&gt;</code> éœ€è¦æŒ‡å®šå…·ä½“è®¾å¤‡çš„å”¯ä¸€æ ‡è¯†ç¬¦</li>
<li>ä½¿ç”¨ <code>booted</code> è‡ªåŠ¨é€‰æ‹©å½“å‰å¯åŠ¨çš„æ¨¡æ‹Ÿå™¨</li>
<li>å¯ä»¥é€šè¿‡ <code>xcrun simctl getenv booted SIMULATOR_UDID</code> è·å–å½“å‰å¯åŠ¨è®¾å¤‡çš„ UDID</li>
</ul>
</li>
<li><strong>åº”ç”¨ Bundle ID</strong>ï¼šå¤§éƒ¨åˆ†åº”ç”¨ç›¸å…³å‘½ä»¤éœ€è¦ä½¿ç”¨åº”ç”¨çš„ Bundle Identifierï¼ˆå¦‚ <code>com.example.app</code>ï¼‰</li>
<li><strong>å½•åˆ¶è§†é¢‘</strong>ï¼šå½•åˆ¶è¿‡ç¨‹ä¸­ç»ˆç«¯ä¼šè¢«å ç”¨ï¼Œä½¿ç”¨ <code>Ctrl+C</code> åœæ­¢å½•åˆ¶</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ­å»ºHyperfæœ¬åœ°å¼€å‘ç¯å¢ƒä¹‹Dockerå®¹å™¨å¼€å‘(äºŒ)]]></title>    <link>https://juejin.cn/post/7603238967291396148</link>    <guid>https://juejin.cn/post/7603238967291396148</guid>    <pubDate>2026-02-06T02:52:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603238967291396148" data-draft-id="7603283380554022946" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ­å»ºHyperfæœ¬åœ°å¼€å‘ç¯å¢ƒä¹‹Dockerå®¹å™¨å¼€å‘(äºŒ)"/> <meta itemprop="keywords" content="åç«¯,PHP,Docker"/> <meta itemprop="datePublished" content="2026-02-06T02:52:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="jokerä¸¶ç‰§ç¾Šäºº"/> <meta itemprop="url" content="https://juejin.cn/user/4054654614250958"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ­å»ºHyperfæœ¬åœ°å¼€å‘ç¯å¢ƒä¹‹Dockerå®¹å™¨å¼€å‘(äºŒ)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4054654614250958/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    jokerä¸¶ç‰§ç¾Šäºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T02:52:09.000Z" title="Fri Feb 06 2026 02:52:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»22åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å†™åœ¨å‰é¢</h3>
<blockquote>
<p>ã€Šæ­å»ºHyperfæœ¬åœ°å¼€å‘ç¯å¢ƒä¹‹Dockerå®¹å™¨å¼€å‘ï¼ˆäºŒï¼‰ã€‹æ˜¯ç»§ ã€Šæ­å»ºHyperfæœ¬åœ°å¼€å‘ç¯å¢ƒä¹‹Dockerå®¹å™¨å¼€å‘ï¼ˆä¸€ï¼‰ã€‹çš„è¡¥å……è¯´æ˜ï¼›</p>
<p>ä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªè¡¥å……å‘¢ï¼Œæ˜¯å› ä¸ºæˆ‘å‘ç°æˆ‘åœ¨å®‰è£… oracle æ‰©å±•çš„æ—¶å€™ï¼Œå‘ç°ä¸èƒ½æˆåŠŸï¼Œæ‰€ä»¥é‡æ–°åšäº†æ”¹åŠ¨æ¥æ»¡è¶³æˆ‘çš„éœ€æ±‚ï¼›</p>
<p>åˆè¡·è¿˜æ˜¯ä¸å˜ï¼Œéƒ½æ˜¯é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥æ§åˆ¶ä¸€åˆ‡ï¼›</p>
</blockquote>
<h4 data-id="heading-1">å¿«é—ªå›æ”¾</h4>
<p><a href="https://juejin.cn/post/7576086557716168755" target="_blank" title="https://juejin.cn/post/7576086557716168755">æ­å»ºHyperfæœ¬åœ°å¼€å‘ç¯å¢ƒä¹‹Dockerå®¹å™¨å¼€å‘ï¼ˆä¸€ï¼‰</a></p>
<h4 data-id="heading-2">ç›®å½•ç»“æ„</h4>
<pre><code class="hljs language-shell" lang="shell">project
|--config
   |--build.conf
   |--extension_deps.conf
   |--extension_special.conf
   |--system_tools.conf
|--extension
|--logs
|--build.sh
|--Dockerfile
</code></pre>
<h4 data-id="heading-3">æ–‡ä»¶å†…å®¹åŠè¯´æ˜</h4>
<h5 data-id="heading-4">build.conf</h5>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">PHP Hyperf Docker æ„å»ºé…ç½®æ–‡ä»¶</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">PHP åŸºç¡€é•œåƒï¼ˆåªèƒ½é€‰æ‹©ä¸€ä¸ªï¼Œå…¶ä»–æ³¨é‡Šæ‰ï¼‰</span>
[base_image]
<span class="hljs-meta prompt_">#</span><span class="bash">php:8.3-cli</span>
<span class="hljs-meta prompt_">#</span><span class="bash">php:8.3-cli-alpine</span>
<span class="hljs-meta prompt_">#</span><span class="bash">php:8.2-cli</span>
<span class="hljs-meta prompt_">#</span><span class="bash">php:8.2-cli-alpine</span>
<span class="hljs-meta prompt_">#</span><span class="bash">php:8.1-cli</span>
<span class="hljs-meta prompt_">#</span><span class="bash">php:8.1-cli-alpine</span>
php:7.4-cli
<span class="hljs-meta prompt_">#</span><span class="bash">php:7.4-cli-alpine</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ‰©å±•é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ ¼å¼è¯´æ˜ï¼š</span>
<span class="hljs-meta prompt_"># </span><span class="bash">  æ‰©å±•å           - å®‰è£…æœ€æ–°ç‰ˆæœ¬</span>
<span class="hljs-meta prompt_"># </span><span class="bash">  æ‰©å±•å-ç‰ˆæœ¬å·    - å®‰è£…æŒ‡å®šç‰ˆæœ¬</span>
<span class="hljs-meta prompt_"># </span><span class="bash">  <span class="hljs-built_in">local</span>:æ‰©å±•å     - å¼ºåˆ¶ä»æœ¬åœ°å®‰è£…</span>
<span class="hljs-meta prompt_"># </span><span class="bash">  pecl:æ‰©å±•å      - å¼ºåˆ¶ä»PECLå®‰è£…</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
[extension]
<span class="hljs-meta prompt_"># </span><span class="bash">æ ¸å¿ƒæ‰©å±•ï¼ˆdocker-php-ext-installï¼‰</span>
pcntl
pdo_mysql
bcmath
sockets
<span class="hljs-meta prompt_">
# </span><span class="bash">GDåº“ï¼ˆè‡ªåŠ¨å¤„ç†ä¾èµ–ï¼‰</span>
gd
<span class="hljs-meta prompt_">
# </span><span class="bash">å‹ç¼©æ‰©å±•</span>
zip
<span class="hljs-meta prompt_">
# </span><span class="bash">PECLæ‰©å±•</span>
redis
swoole-4.8.13
<span class="hljs-meta prompt_">
# </span><span class="bash">å¯é€‰æ‰©å±•ï¼ˆæŒ‰éœ€å–æ¶ˆæ³¨é‡Šï¼‰</span>
<span class="hljs-meta prompt_">#</span><span class="bash">mongodb</span>
<span class="hljs-meta prompt_">#</span><span class="bash">xlswriter</span>
<span class="hljs-meta prompt_">#</span><span class="bash">protobuf</span>
<span class="hljs-meta prompt_">#</span><span class="bash">grpc</span>
<span class="hljs-meta prompt_">#</span><span class="bash">imagick</span>
<span class="hljs-meta prompt_">#</span><span class="bash">memcached</span>
<span class="hljs-meta prompt_">#</span><span class="bash">oci8</span>
pdo_oci
<span class="hljs-meta prompt_"># </span><span class="bash">SQL Server php7.4 å¯¹åº” pdo_sqlsrv-5.10.1</span>
pdo_sqlsrv-5.10.1
<span class="hljs-meta prompt_">#</span><span class="bash">sqlsrv</span>
pdo_pgsql
<span class="hljs-meta prompt_">#</span><span class="bash">pgsql</span>
<span class="hljs-meta prompt_">#</span><span class="bash">amqp</span>
<span class="hljs-meta prompt_">#</span><span class="bash">rdkafka</span>
<span class="hljs-meta prompt_">#</span><span class="bash">igbinary</span>
<span class="hljs-meta prompt_">#</span><span class="bash">msgpack</span>
<span class="hljs-meta prompt_">#</span><span class="bash">yaf</span>
<span class="hljs-meta prompt_">#</span><span class="bash">yar</span>
<span class="hljs-meta prompt_">#</span><span class="bash">apcu</span>
<span class="hljs-meta prompt_">#</span><span class="bash">xdebug</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ„å»ºæ¨¡å¼ï¼šprod / dev</span>
<span class="hljs-meta prompt_"># </span><span class="bash">prod: ç”Ÿäº§æ¨¡å¼ï¼Œä¼˜åŒ–æ„å»ºï¼Œæ¸…ç†ç¼“å­˜</span>
<span class="hljs-meta prompt_"># </span><span class="bash">dev:  å¼€å‘æ¨¡å¼ï¼Œä¿ç•™è°ƒè¯•ä¿¡æ¯</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
[mode]
prod
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">é¡¹ç›®å·¥ä½œç›®å½•</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
[workdir]
/opt/www
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">APT/APK ç³»ç»Ÿé•œåƒæºï¼ˆç”¨äºåŠ é€Ÿç³»ç»ŸåŒ…ä¸‹è½½ï¼‰</span>
<span class="hljs-meta prompt_"># </span><span class="bash">å¯é€‰ï¼šdefault / aliyun / ustc / tsinghua / 163</span>
<span class="hljs-meta prompt_"># </span><span class="bash">default: ä½¿ç”¨å®˜æ–¹æº</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
[system_mirror]
aliyun
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">Composer é•œåƒæº</span>
<span class="hljs-meta prompt_"># </span><span class="bash">å¯é€‰ï¼šauto / aliyun / tencent / ustc / packagist / huaweicloud</span>
<span class="hljs-meta prompt_"># </span><span class="bash">auto: è‡ªåŠ¨æ£€æµ‹æœ€å¿«çš„æº</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
[composer_mirror]
auto
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">PHP é…ç½®ï¼ˆphp.iniï¼‰</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ ¼å¼ï¼šé…ç½®é¡¹=å€¼</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
[php]
swoole.use_shortname=Off
memory_limit=1G
opcache.enable_cli=On
opcache.jit_buffer_size=128M
date.timezone=Asia/Shanghai
max_execution_time=0
post_max_size=100M
upload_max_filesize=100M
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">Docker CMD å‘½ä»¤é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">ç•™ç©ºåˆ™ä¸è®¾ç½®CMD</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
[cmd]
<span class="hljs-meta prompt_">#</span><span class="bash">php /opt/www/bin/hyperf.php start</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">å¸¸ç”¨ç³»ç»Ÿå·¥å…·</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ”¯æŒçš„å·¥å…·åˆ—è¡¨è§ config/system_tools.conf</span>
<span class="hljs-meta prompt_"># </span><span class="bash">è„šæœ¬ä¼šè‡ªåŠ¨è¯†åˆ«ç³»ç»Ÿç±»å‹å®‰è£…å¯¹åº”çš„åŒ…</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
[system_tools]
<span class="hljs-meta prompt_"># </span><span class="bash">ç½‘ç»œè¯Šæ–­å·¥å…·</span>
<span class="hljs-meta prompt_">#</span><span class="bash">curl</span>
wget
telnet
<span class="hljs-meta prompt_">#</span><span class="bash">netcat</span>
<span class="hljs-meta prompt_">#</span><span class="bash">ping</span>
<span class="hljs-meta prompt_">#</span><span class="bash">traceroute</span>
<span class="hljs-meta prompt_">#</span><span class="bash">dig</span>
<span class="hljs-meta prompt_">#</span><span class="bash">nslookup</span>
ss
netstat
lsof
<span class="hljs-meta prompt_">#</span><span class="bash">tcpdump</span>
<span class="hljs-meta prompt_">#</span><span class="bash">iptables</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">ç¼–è¾‘å™¨å’Œæ–‡æœ¬å¤„ç†</span>
vim
<span class="hljs-meta prompt_">#</span><span class="bash">nano</span>
<span class="hljs-meta prompt_">#</span><span class="bash">less</span>
<span class="hljs-meta prompt_">#</span><span class="bash">jq</span>
<span class="hljs-meta prompt_">#</span><span class="bash">tree</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">ç³»ç»Ÿç›‘æ§å·¥å…·</span>
<span class="hljs-meta prompt_">#</span><span class="bash">htop</span>
<span class="hljs-meta prompt_">#</span><span class="bash">top</span>
<span class="hljs-meta prompt_">#</span><span class="bash">ps</span>
<span class="hljs-meta prompt_">#</span><span class="bash">iostat</span>
<span class="hljs-meta prompt_">#</span><span class="bash">vmstat</span>
<span class="hljs-meta prompt_">#</span><span class="bash">strace</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">æ–‡ä»¶å’Œå‹ç¼©å·¥å…·</span>
<span class="hljs-meta prompt_">#</span><span class="bash">tar</span>
<span class="hljs-meta prompt_">#</span><span class="bash">gzip</span>
<span class="hljs-meta prompt_">#</span><span class="bash">unzip</span>
<span class="hljs-meta prompt_">#</span><span class="bash">zip</span>
<span class="hljs-meta prompt_">#</span><span class="bash">file</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">å…¶ä»–å®ç”¨å·¥å…·</span>
<span class="hljs-meta prompt_">#</span><span class="bash">git</span>
<span class="hljs-meta prompt_">#</span><span class="bash">procps</span>
<span class="hljs-meta prompt_">#</span><span class="bash">coreutils</span>
<span class="hljs-meta prompt_">#</span><span class="bash">findutils</span>
<span class="hljs-meta prompt_">#</span><span class="bash">grep</span>
<span class="hljs-meta prompt_">#</span><span class="bash">sed</span>
<span class="hljs-meta prompt_">#</span><span class="bash">awk</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">é¢å¤–çš„ç³»ç»ŸåŒ…ï¼ˆç©ºæ ¼åˆ†éš”ï¼Œç›´æ¥æŒ‡å®šåŒ…åï¼‰</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
[extra_packages]
<span class="hljs-meta prompt_">

# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">ç¯å¢ƒå˜é‡é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ ¼å¼ï¼šå˜é‡å=å€¼</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
[env]
<span class="hljs-meta prompt_">#</span><span class="bash">APP_ENV=dev</span>
<span class="hljs-meta prompt_">#</span><span class="bash">SCAN_CACHEABLE=<span class="hljs-literal">false</span></span>
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ„å»ºå‚æ•°</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
[build_args]
<span class="hljs-meta prompt_"># </span><span class="bash">å¯ç”¨æ„å»ºç¼“å­˜</span>
enable_cache=true
<span class="hljs-meta prompt_"># </span><span class="bash">å¹¶è¡Œç¼–è¯‘æ•°ï¼ˆ0ä¸ºè‡ªåŠ¨æ£€æµ‹ï¼‰</span>
parallel_jobs=0
<span class="hljs-meta prompt_"># </span><span class="bash">å†…å­˜é™åˆ¶ï¼ˆé˜²æ­¢OOMï¼Œå•ä½MBï¼Œ0ä¸ºä¸é™åˆ¶ï¼‰</span>
memory_limit=2048
<span class="hljs-meta prompt_"># </span><span class="bash">æ¸…ç†æ„å»ºç¼“å­˜</span>
clean_cache=true
</code></pre>
<h5 data-id="heading-5">extension_deps.conf</h5>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">PHP æ‰©å±•ä¾èµ–é…ç½®æ–‡ä»¶</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ ¼å¼ï¼šæ‰©å±•å|Debianä¾èµ–|Alpineä¾èµ–</span>
<span class="hljs-meta prompt_"># </span><span class="bash">å¤šä¸ªä¾èµ–ç”¨é€—å·åˆ†éš”</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">æ ¸å¿ƒæ‰©å±•</span>
pcntl||
pdo_mysql||
bcmath||
sockets||
calendar||
exif||
gettext||
shmop||
sysvmsg||
sysvsem||
sysvshm||
<span class="hljs-meta prompt_">
# </span><span class="bash">GDåº“</span>
gd|libpng-dev,libjpeg-dev,libfreetype6-dev,libwebp-dev,libxpm-dev|libpng-dev,libjpeg-turbo-dev,freetype-dev,libwebp-dev,libxpm-dev
<span class="hljs-meta prompt_">
# </span><span class="bash">å‹ç¼©ç›¸å…³</span>
zip|libzip-dev|libzip-dev
bz2|libbz2-dev|bzip2-dev
zlib||zlib-dev
<span class="hljs-meta prompt_">
# </span><span class="bash">å›¾åƒå¤„ç†</span>
imagick|libmagickwand-dev|imagemagick-dev
<span class="hljs-meta prompt_">
# </span><span class="bash">æ•°æ®åº“æ‰©å±•</span>
pdo_pgsql|libpq-dev|postgresql-dev
pgsql|libpq-dev|postgresql-dev
pdo_sqlite|libsqlite3-dev|sqlite-dev
sqlite3|libsqlite3-dev|sqlite-dev
<span class="hljs-meta prompt_">
# </span><span class="bash">Redis/Memcached</span>
redis||
memcached|libmemcached-dev,zlib1g-dev|libmemcached-dev,zlib-dev
<span class="hljs-meta prompt_">
# </span><span class="bash">æ¶ˆæ¯é˜Ÿåˆ—</span>
amqp|librabbitmq-dev|rabbitmq-c-dev
rdkafka|librdkafka-dev|librdkafka-dev
<span class="hljs-meta prompt_">
# </span><span class="bash">å…¶ä»–å¸¸ç”¨æ‰©å±•</span>
swoole|libcurl4-openssl-dev,libssl-dev,libc-ares-dev|curl-dev,openssl-dev,c-ares-dev
mongodb|libssl-dev|openssl-dev
xlswriter|zlib1g-dev|zlib-dev
protobuf||
grpc||
igbinary||
msgpack||
apcu||
xdebug||
yaf||
yar|libcurl4-openssl-dev|curl-dev
<span class="hljs-meta prompt_">
# </span><span class="bash">å›½é™…åŒ–</span>
intl|libicu-dev|icu-dev
iconv||
<span class="hljs-meta prompt_">
# </span><span class="bash">åŠ å¯†</span>
sodium|libsodium-dev|libsodium-dev
mcrypt|libmcrypt-dev|libmcrypt-dev
openssl||
<span class="hljs-meta prompt_">
# </span><span class="bash">XMLç›¸å…³</span>
xml|libxml2-dev|libxml2-dev
dom|libxml2-dev|libxml2-dev
xmlrpc|libxml2-dev|libxml2-dev
xmlreader|libxml2-dev|libxml2-dev
xmlwriter|libxml2-dev|libxml2-dev
xsl|libxslt-dev|libxslt-dev
simplexml|libxml2-dev|libxml2-dev
soap|libxml2-dev|libxml2-dev
<span class="hljs-meta prompt_">
# </span><span class="bash">LDAP</span>
ldap|libldap2-dev|openldap-dev
<span class="hljs-meta prompt_">
# </span><span class="bash">å…¶ä»–</span>
curl|libcurl4-openssl-dev|curl-dev
gmp|libgmp-dev|gmp-dev
imap|libc-client-dev,libkrb5-dev|imap-dev,krb5-dev
snmp|libsnmp-dev|net-snmp-dev
tidy|libtidy-dev|tidyhtml-dev
ftp||
fileinfo||
phar||
posix||
readline|libreadline-dev|readline-dev
tokenizer||
ctype||
filter||
json||
mbstring|libonig-dev|oniguruma-dev
pdo||
reflection||
session||
standard||
opcache||

</code></pre>
<h5 data-id="heading-6">extension_special.conf</h5>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">PHP æ‰©å±•ç‰¹æ®Šé…ç½®æ–‡ä»¶</span>
<span class="hljs-meta prompt_"># </span><span class="bash">éœ€è¦ç‰¹æ®Šå¤„ç†çš„æ‰©å±•é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">----------------------------------------</span>
<span class="hljs-meta prompt_"># </span><span class="bash">GD åº“é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">----------------------------------------</span>
[gd]
<span class="hljs-meta prompt_"># </span><span class="bash">Debian é…ç½®å‘½ä»¤</span>
debian_configure=docker-php-ext-configure gd --with-freetype --with-jpeg --with-webp --with-xpm
<span class="hljs-meta prompt_"># </span><span class="bash">Alpine é…ç½®å‘½ä»¤</span>
alpine_configure=docker-php-ext-configure gd --with-freetype --with-jpeg --with-webp --with-xpm
<span class="hljs-meta prompt_"># </span><span class="bash">PHP 7.x å…¼å®¹é…ç½®ï¼ˆä¸åŒçš„å‚æ•°æ ¼å¼ï¼‰</span>
php7_debian_configure=docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ --with-webp-dir=/usr/include/ --with-xpm-dir=/usr/include/
php7_alpine_configure=docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ --with-webp-dir=/usr/include/ --with-xpm-dir=/usr/include/
<span class="hljs-meta prompt_">
# </span><span class="bash">----------------------------------------</span>
<span class="hljs-meta prompt_"># </span><span class="bash">Oracle æ‰©å±•é…ç½® (oci8, pdo_oci)</span>
<span class="hljs-meta prompt_"># </span><span class="bash">----------------------------------------</span>
[oci8]
<span class="hljs-meta prompt_"># </span><span class="bash">ä¾èµ–ï¼šéœ€è¦ Oracle Instant Client</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ³¨æ„ï¼šoci8 éœ€è¦å•ç‹¬å®‰è£…ï¼Œä¸èƒ½å’Œå…¶ä»–æ ¸å¿ƒæ‰©å±•ä¸€èµ·æ‰¹é‡å®‰è£…</span>
install_method=separate
pre_install=&lt;&lt;EOF
<span class="hljs-meta prompt_"># </span><span class="bash">ä¸‹è½½å¹¶å®‰è£… Oracle Instant Client</span>
log_info "å®‰è£… Oracle Instant Client..."
mkdir -p /opt/oracle
cd /opt/oracle
<span class="hljs-meta prompt_">
# </span><span class="bash">è®¾ç½® Oracle ç‰ˆæœ¬</span>
ORACLE_VERSION="21_14"
ORACLE_MAJOR="21"
<span class="hljs-meta prompt_">
# </span><span class="bash">Debian</span>
if command -v apt-get &amp;&gt;/dev/null; then
    apt-get update &amp;&amp; apt-get install -y libaio1 libaio-dev unzip wget
    
    # ä¸‹è½½ Oracle Instant Client
    if [ ! -f "instantclient-basic-linux.x64-${ORACLE_MAJOR}.*.zip" ]; then
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/${ORACLE_VERSION}/instantclient-basic-linux.x64-${ORACLE_MAJOR}.14.0.0.0dbru.zip" -O instantclient-basic.zip || \
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/instantclient-basic-linuxx64.zip" -O instantclient-basic.zip
    fi
    if [ ! -f "instantclient-sdk-linux.x64-${ORACLE_MAJOR}.*.zip" ]; then
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/${ORACLE_VERSION}/instantclient-sdk-linux.x64-${ORACLE_MAJOR}.14.0.0.0dbru.zip" -O instantclient-sdk.zip || \
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/instantclient-sdk-linuxx64.zip" -O instantclient-sdk.zip
    fi
    
    unzip -o instantclient-basic.zip
    unzip -o instantclient-sdk.zip
    rm -f *.zip
    
    # è·å–å®é™…å®‰è£…ç›®å½•
    INSTANT_CLIENT_DIR=$(ls -d /opt/oracle/instantclient_* 2&gt;/dev/null | head -1)
    if [ -z "$INSTANT_CLIENT_DIR" ]; then
        log_error "Oracle Instant Client å®‰è£…å¤±è´¥"
    fi
    
    # é…ç½®é“¾æ¥åº“
    echo "$INSTANT_CLIENT_DIR" &gt; /etc/ld.so.conf.d/oracle-instantclient.conf
    ldconfig
fi
<span class="hljs-meta prompt_">
# </span><span class="bash">Alpine</span>
if command -v apk &amp;&gt;/dev/null; then
    apk add --no-cache libaio libnsl libc6-compat unzip wget
    
    if [ ! -f "instantclient-basic.zip" ]; then
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/${ORACLE_VERSION}/instantclient-basic-linux.x64-${ORACLE_MAJOR}.14.0.0.0dbru.zip" -O instantclient-basic.zip || \
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/instantclient-basic-linuxx64.zip" -O instantclient-basic.zip
    fi
    if [ ! -f "instantclient-sdk.zip" ]; then
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/${ORACLE_VERSION}/instantclient-sdk-linux.x64-${ORACLE_MAJOR}.14.0.0.0dbru.zip" -O instantclient-sdk.zip || \
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/instantclient-sdk-linuxx64.zip" -O instantclient-sdk.zip
    fi
    
    unzip -o instantclient-basic.zip
    unzip -o instantclient-sdk.zip
    rm -f *.zip
    
    INSTANT_CLIENT_DIR=$(ls -d /opt/oracle/instantclient_* 2&gt;/dev/null | head -1)
    if [ -z "$INSTANT_CLIENT_DIR" ]; then
        log_error "Oracle Instant Client å®‰è£…å¤±è´¥"
    fi
    
    # Alpine å…¼å®¹æ€§
    ln -sf /lib/libc.musl-x86_64.so.1 /lib/ld-linux-x86-64.so.2 2&gt;/dev/null || true
fi
<span class="hljs-meta prompt_">
# </span><span class="bash">å¯¼å‡ºç¯å¢ƒå˜é‡ï¼ˆå†™å…¥ profile ä»¥ä¾¿åç»­è„šæœ¬ä½¿ç”¨ï¼‰</span>
export ORACLE_HOME="$INSTANT_CLIENT_DIR"
export LD_LIBRARY_PATH="$INSTANT_CLIENT_DIR:$LD_LIBRARY_PATH"
echo "export ORACLE_HOME=$INSTANT_CLIENT_DIR" &gt;&gt; /etc/profile
echo "export LD_LIBRARY_PATH=$INSTANT_CLIENT_DIR:\$LD_LIBRARY_PATH" &gt;&gt; /etc/profile

log_info "Oracle Instant Client å®‰è£…å®Œæˆ: $INSTANT_CLIENT_DIR"
<span class="hljs-meta prompt_">
# </span><span class="bash">ç›´æ¥å®‰è£… oci8 æ‰©å±•</span>
log_step "å®‰è£… oci8 æ‰©å±•..."
docker-php-ext-configure oci8 --with-oci8=instantclient,$INSTANT_CLIENT_DIR
docker-php-ext-install -j$(nproc) oci8
log_info "oci8 æ‰©å±•å®‰è£…æˆåŠŸ"
EOF
<span class="hljs-meta prompt_"># </span><span class="bash">æ ‡è®°ä¸ºå·²åœ¨ pre_install ä¸­å®Œæˆå®‰è£…</span>
skip_install=true

[pdo_oci]
<span class="hljs-meta prompt_"># </span><span class="bash">pdo_oci éœ€è¦å•ç‹¬å®‰è£…</span>
install_method=separate
pre_install=&lt;&lt;EOF
<span class="hljs-meta prompt_"># </span><span class="bash">æ£€æŸ¥ Oracle Instant Client æ˜¯å¦å·²å®‰è£…ï¼ˆå¦‚æœæ²¡æœ‰å®‰è£… oci8 çš„è¯ï¼‰</span>
INSTANT_CLIENT_DIR=$(ls -d /opt/oracle/instantclient_* 2&gt;/dev/null | head -1)

if [ -z "$INSTANT_CLIENT_DIR" ]; then
    log_info "å®‰è£… Oracle Instant Client for pdo_oci..."
    mkdir -p /opt/oracle
    cd /opt/oracle
    
    ORACLE_VERSION="21_14"
    ORACLE_MAJOR="21"
    
    if command -v apt-get &amp;&gt;/dev/null; then
        apt-get update &amp;&amp; apt-get install -y libaio1 libaio-dev unzip wget
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/${ORACLE_VERSION}/instantclient-basic-linux.x64-${ORACLE_MAJOR}.14.0.0.0dbru.zip" -O instantclient-basic.zip || \
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/instantclient-basic-linuxx64.zip" -O instantclient-basic.zip
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/${ORACLE_VERSION}/instantclient-sdk-linux.x64-${ORACLE_MAJOR}.14.0.0.0dbru.zip" -O instantclient-sdk.zip || \
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/instantclient-sdk-linuxx64.zip" -O instantclient-sdk.zip
        unzip -o instantclient-basic.zip
        unzip -o instantclient-sdk.zip
        rm -f *.zip
        INSTANT_CLIENT_DIR=$(ls -d /opt/oracle/instantclient_* 2&gt;/dev/null | head -1)
        echo "$INSTANT_CLIENT_DIR" &gt; /etc/ld.so.conf.d/oracle-instantclient.conf
        ldconfig
    fi
    
    if command -v apk &amp;&gt;/dev/null; then
        apk add --no-cache libaio libnsl libc6-compat unzip wget
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/${ORACLE_VERSION}/instantclient-basic-linux.x64-${ORACLE_MAJOR}.14.0.0.0dbru.zip" -O instantclient-basic.zip || \
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/instantclient-basic-linuxx64.zip" -O instantclient-basic.zip
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/${ORACLE_VERSION}/instantclient-sdk-linux.x64-${ORACLE_MAJOR}.14.0.0.0dbru.zip" -O instantclient-sdk.zip || \
        wget -q "https://download.oracle.com/otn_software/linux/instantclient/instantclient-sdk-linuxx64.zip" -O instantclient-sdk.zip
        unzip -o instantclient-basic.zip
        unzip -o instantclient-sdk.zip
        rm -f *.zip
        INSTANT_CLIENT_DIR=$(ls -d /opt/oracle/instantclient_* 2&gt;/dev/null | head -1)
        ln -sf /lib/libc.musl-x86_64.so.1 /lib/ld-linux-x86-64.so.2 2&gt;/dev/null || true
    fi
    
    echo "export ORACLE_HOME=$INSTANT_CLIENT_DIR" &gt;&gt; /etc/profile
    echo "export LD_LIBRARY_PATH=$INSTANT_CLIENT_DIR:\$LD_LIBRARY_PATH" &gt;&gt; /etc/profile
fi

export ORACLE_HOME="$INSTANT_CLIENT_DIR"
export LD_LIBRARY_PATH="$INSTANT_CLIENT_DIR:$LD_LIBRARY_PATH"

log_info "Oracle Instant Client è·¯å¾„: $INSTANT_CLIENT_DIR"
<span class="hljs-meta prompt_">
# </span><span class="bash">ç›´æ¥å®‰è£… pdo_oci æ‰©å±•</span>
log_step "å®‰è£… pdo_oci æ‰©å±•..."
docker-php-ext-configure pdo_oci --with-pdo-oci=instantclient,$INSTANT_CLIENT_DIR
docker-php-ext-install -j$(nproc) pdo_oci
log_info "pdo_oci æ‰©å±•å®‰è£…æˆåŠŸ"
EOF
<span class="hljs-meta prompt_"># </span><span class="bash">æ ‡è®°ä¸ºå·²åœ¨ pre_install ä¸­å®Œæˆå®‰è£…</span>
skip_install=true
<span class="hljs-meta prompt_">
# </span><span class="bash">----------------------------------------</span>
<span class="hljs-meta prompt_"># </span><span class="bash">SQL Server æ‰©å±•é…ç½® (sqlsrv, pdo_sqlsrv)</span>
<span class="hljs-meta prompt_"># </span><span class="bash">----------------------------------------</span>
[sqlsrv]
pre_install=&lt;&lt;EOF
<span class="hljs-meta prompt_"># </span><span class="bash">å®‰è£… Microsoft ODBC Driver</span>
if command -v apt-get &amp;&gt;/dev/null; then
    # å®‰è£… gnupg å’Œ curl
    apt-get update
    apt-get install -y gnupg curl

    curl -fsSL https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor -o /etc/apt/trusted.gpg.d/microsoft.gpg
    #curl -fsSL https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor -o /usr/share/keyrings/microsoft-prod.gpg
    curl -fsSL https://packages.microsoft.com/config/debian/$(cat /etc/debian_version | cut -d. -f1)/prod.list &gt; /etc/apt/sources.list.d/mssql-release.list
    apt-get update
    ACCEPT_EULA=Y apt-get install -y msodbcsql18 unixodbc-dev
fi
if command -v apk &amp;&gt;/dev/null; then
    apk add --no-cache unixodbc-dev
    # Alpine éœ€è¦ä» edge ä»“åº“å®‰è£… msodbcsql
    echo "Note: SQL Server driver on Alpine requires manual setup"
fi
EOF
<span class="hljs-meta prompt_"># </span><span class="bash">PECL å®‰è£…</span>
install_method=pecl

[pdo_sqlsrv]
pre_install=&lt;&lt;EOF
<span class="hljs-meta prompt_"># </span><span class="bash">å¤ç”¨ sqlsrv çš„ ODBC é©±åŠ¨å®‰è£…</span>
if ! command -v sqlcmd &amp;&gt;/dev/null; then
    if command -v apt-get &amp;&gt;/dev/null; then
        # å®‰è£… gnupg å’Œ curl
        apt-get update
        apt-get install -y gnupg curl

        curl -fsSL https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor -o /etc/apt/trusted.gpg.d/microsoft.gpg
        #curl -fsSL https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor -o /usr/share/keyrings/microsoft-prod.gpg
        curl -fsSL https://packages.microsoft.com/config/debian/$(cat /etc/debian_version | cut -d. -f1)/prod.list &gt; /etc/apt/sources.list.d/mssql-release.list
        apt-get update
        ACCEPT_EULA=Y apt-get install -y msodbcsql18 unixodbc-dev
    fi
    if command -v apk &amp;&gt;/dev/null; then
        apk add --no-cache unixodbc-dev
    fi
fi
EOF
install_method=pecl
<span class="hljs-meta prompt_">
# </span><span class="bash">----------------------------------------</span>
<span class="hljs-meta prompt_"># </span><span class="bash">PostgreSQL æ‰©å±•é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">----------------------------------------</span>
[pdo_pgsql]
<span class="hljs-meta prompt_"># </span><span class="bash">Debian é¢å¤–é…ç½®</span>
debian_extra=ln -sf /usr/include/postgresql /usr/include/pgsql

[pgsql]
debian_extra=ln -sf /usr/include/postgresql /usr/include/pgsql
<span class="hljs-meta prompt_">
# </span><span class="bash">----------------------------------------</span>
<span class="hljs-meta prompt_"># </span><span class="bash">IMAP æ‰©å±•é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">----------------------------------------</span>
[imap]
debian_configure=docker-php-ext-configure imap --with-kerberos --with-imap-ssl
alpine_configure=docker-php-ext-configure imap --with-kerberos --with-imap-ssl
<span class="hljs-meta prompt_">
# </span><span class="bash">----------------------------------------</span>
<span class="hljs-meta prompt_"># </span><span class="bash">LDAP æ‰©å±•é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">----------------------------------------</span>
[ldap]
debian_extra=ln -sf /usr/lib/x86_64-linux-gnu/libldap.so /usr/lib/libldap.so &amp;&amp; ln -sf /usr/lib/x86_64-linux-gnu/liblber.so /usr/lib/liblber.so
debian_configure=docker-php-ext-configure ldap --with-libdir=lib/x86_64-linux-gnu
<span class="hljs-meta prompt_">
# </span><span class="bash">----------------------------------------</span>
<span class="hljs-meta prompt_"># </span><span class="bash">Swoole æ‰©å±•é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">----------------------------------------</span>
[swoole]
<span class="hljs-meta prompt_"># </span><span class="bash">Swoole ç¼–è¯‘å‚æ•°</span>
pecl_configure=--enable-openssl --enable-sockets --enable-mysqlnd --enable-swoole-curl --enable-cares
<span class="hljs-meta prompt_"># </span><span class="bash">PHP 7.x å…¼å®¹é…ç½®</span>
php7_pecl_configure=--enable-openssl --enable-sockets --enable-mysqlnd --enable-http2
<span class="hljs-meta prompt_">
# </span><span class="bash">----------------------------------------</span>
<span class="hljs-meta prompt_"># </span><span class="bash">GrPC æ‰©å±•é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">----------------------------------------</span>
[grpc]
<span class="hljs-meta prompt_"># </span><span class="bash">grpc éœ€è¦å¤§é‡å†…å­˜ç¼–è¯‘</span>
build_memory=4096
<span class="hljs-meta prompt_"># </span><span class="bash">ç¼–è¯‘è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰</span>
build_timeout=3600
<span class="hljs-meta prompt_">
# </span><span class="bash">----------------------------------------</span>
<span class="hljs-meta prompt_"># </span><span class="bash">xlswriter æ‰©å±•é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">----------------------------------------</span>
[xlswriter]
pecl_configure=--enable-reader
<span class="hljs-meta prompt_">
# </span><span class="bash">----------------------------------------</span>
<span class="hljs-meta prompt_"># </span><span class="bash">imagick æ‰©å±•é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">----------------------------------------</span>
[imagick]
<span class="hljs-meta prompt_"># </span><span class="bash">éœ€è¦ ImageMagick å¼€å‘åº“</span>
post_install=&lt;&lt;EOF
<span class="hljs-meta prompt_"># </span><span class="bash">ç¡®ä¿ ImageMagick ç­–ç•¥å…è®¸ PDF å¤„ç†</span>
if [ -f /etc/ImageMagick-6/policy.xml ]; then
    sed -i 's/rights="none" pattern="PDF"/rights="read|write" pattern="PDF"/' /etc/ImageMagick-6/policy.xml
fi
if [ -f /etc/ImageMagick-7/policy.xml ]; then
    sed -i 's/rights="none" pattern="PDF"/rights="read|write" pattern="PDF"/' /etc/ImageMagick-7/policy.xml
fi
EOF
<span class="hljs-meta prompt_">
# </span><span class="bash">----------------------------------------</span>
<span class="hljs-meta prompt_"># </span><span class="bash">memcached æ‰©å±•é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">----------------------------------------</span>
[memcached]
pecl_configure=--enable-memcached-igbinary --enable-memcached-json --enable-memcached-session --enable-memcached-sasl
<span class="hljs-meta prompt_">
# </span><span class="bash">----------------------------------------</span>
<span class="hljs-meta prompt_"># </span><span class="bash">xdebug æ‰©å±•é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">----------------------------------------</span>
[xdebug]
<span class="hljs-meta prompt_"># </span><span class="bash">ä»…åœ¨ dev æ¨¡å¼å®‰è£…</span>
mode_only=dev
<span class="hljs-meta prompt_"># </span><span class="bash">xdebug 3.x é…ç½®</span>
php_ini_config=&lt;&lt;EOF
xdebug.mode=develop,debug
xdebug.start_with_request=yes
xdebug.client_host=host.docker.internal
xdebug.client_port=9003
EOF
<span class="hljs-meta prompt_">
# </span><span class="bash">----------------------------------------</span>
<span class="hljs-meta prompt_"># </span><span class="bash">opcache æ‰©å±•é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">----------------------------------------</span>
[opcache]
php_ini_config=&lt;&lt;EOF
opcache.enable=1
opcache.enable_cli=1
opcache.memory_consumption=256
opcache.interned_strings_buffer=16
opcache.max_accelerated_files=100000
opcache.validate_timestamps=0
opcache.save_comments=1
opcache.fast_shutdown=1
EOF
<span class="hljs-meta prompt_"># </span><span class="bash">ç”Ÿäº§æ¨¡å¼ç‰¹æ®Šé…ç½®</span>
prod_php_ini_config=&lt;&lt;EOF
opcache.enable=1
opcache.enable_cli=1
opcache.memory_consumption=256
opcache.interned_strings_buffer=16
opcache.max_accelerated_files=100000
opcache.validate_timestamps=0
opcache.save_comments=1
opcache.fast_shutdown=1
opcache.jit_buffer_size=256M
opcache.jit=1255
EOF

</code></pre>
<h5 data-id="heading-7">system_tools.conf</h5>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">ç³»ç»Ÿå·¥å…·æ˜ å°„é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ ¼å¼: å·¥å…·å|debianåŒ…å|alpineåŒ…å|è¯´æ˜</span>
<span class="hljs-meta prompt_"># </span><span class="bash">å¦‚æœåŒ…åä¸º - è¡¨ç¤ºè¯¥ç³»ç»Ÿä¸æ”¯æŒæˆ–ä¸éœ€è¦å®‰è£…</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">ç½‘ç»œè¯Šæ–­å·¥å…·</span>
curl|curl|curl|å‘½ä»¤è¡ŒURLå·¥å…·
wget|wget|wget|æ–‡ä»¶ä¸‹è½½å·¥å…·
telnet|telnet|busybox-extras|è¿œç¨‹ç™»å½•åè®®å®¢æˆ·ç«¯
netcat|netcat-openbsd|netcat-openbsd|ç½‘ç»œè¿æ¥å·¥å…·
nc|netcat-openbsd|netcat-openbsd|netcatåˆ«å
ping|iputils-ping|iputils|ç½‘ç»œè¿é€šæ€§æµ‹è¯•
traceroute|traceroute|traceroute|è·¯ç”±è¿½è¸ª
tracepath|iputils-tracepath|iputils|è·¯å¾„MTUå‘ç°
dig|dnsutils|bind-tools|DNSæŸ¥è¯¢å·¥å…·
nslookup|dnsutils|bind-tools|DNSæŸ¥è¯¢å·¥å…·
host|dnsutils|bind-tools|DNSæŸ¥è¯¢å·¥å…·
ss|iproute2|iproute2|å¥—æ¥å­—ç»Ÿè®¡å·¥å…·
netstat|net-tools|net-tools|ç½‘ç»œç»Ÿè®¡å·¥å…·ï¼ˆæ—§ç‰ˆï¼‰
ip|iproute2|iproute2|IPé…ç½®å·¥å…·
ifconfig|net-tools|net-tools|ç½‘ç»œæ¥å£é…ç½®ï¼ˆæ—§ç‰ˆï¼‰
lsof|lsof|lsof|åˆ—å‡ºæ‰“å¼€çš„æ–‡ä»¶
tcpdump|tcpdump|tcpdump|ç½‘ç»œæŠ“åŒ…å·¥å…·
iptables|iptables|iptables|é˜²ç«å¢™è§„åˆ™ç®¡ç†
nmap|nmap|nmap|ç½‘ç»œæ‰«æå·¥å…·
mtr|mtr|mtr|ç½‘ç»œè¯Šæ–­å·¥å…·
<span class="hljs-meta prompt_">
# </span><span class="bash">ç¼–è¾‘å™¨å’Œæ–‡æœ¬å¤„ç†</span>
vim|vim|vim|Viæ”¹è¿›ç‰ˆç¼–è¾‘å™¨
vi|vim|vim|vimåˆ«å
nano|nano|nano|ç®€æ˜“æ–‡æœ¬ç¼–è¾‘å™¨
less|less|less|åˆ†é¡µæŸ¥çœ‹å™¨
more|util-linux|util-linux|åˆ†é¡µæŸ¥çœ‹å™¨
cat|coreutils|coreutils|æ–‡ä»¶æŸ¥çœ‹
head|coreutils|coreutils|æŸ¥çœ‹æ–‡ä»¶å¤´éƒ¨
tail|coreutils|coreutils|æŸ¥çœ‹æ–‡ä»¶å°¾éƒ¨
jq|jq|jq|JSONå¤„ç†å·¥å…·
yq|yq|yq|YAMLå¤„ç†å·¥å…·
tree|tree|tree|ç›®å½•æ ‘æ˜¾ç¤º
diff|diffutils|diffutils|æ–‡ä»¶æ¯”è¾ƒ
<span class="hljs-meta prompt_">
# </span><span class="bash">ç³»ç»Ÿç›‘æ§å·¥å…·</span>
htop|htop|htop|äº¤äº’å¼è¿›ç¨‹æŸ¥çœ‹å™¨
top|procps|procps|è¿›ç¨‹ç›‘æ§
ps|procps|procps|è¿›ç¨‹çŠ¶æ€
free|procps|procps|å†…å­˜ä½¿ç”¨æƒ…å†µ
uptime|procps|procps|ç³»ç»Ÿè¿è¡Œæ—¶é—´
watch|procps|procps|å‘¨æœŸæ€§æ‰§è¡Œå‘½ä»¤
pstree|psmisc|psmisc|è¿›ç¨‹æ ‘æ˜¾ç¤º
killall|psmisc|psmisc|æŒ‰åç§°ç»ˆæ­¢è¿›ç¨‹
fuser|psmisc|psmisc|æ˜¾ç¤ºæ–‡ä»¶ä½¿ç”¨è€…
iostat|sysstat|sysstat|IOç»Ÿè®¡
vmstat|procps|procps|è™šæ‹Ÿå†…å­˜ç»Ÿè®¡
sar|sysstat|sysstat|ç³»ç»Ÿæ´»åŠ¨æŠ¥å‘Š
mpstat|sysstat|sysstat|CPUç»Ÿè®¡
pidstat|sysstat|sysstat|è¿›ç¨‹ç»Ÿè®¡
strace|strace|strace|ç³»ç»Ÿè°ƒç”¨è¿½è¸ª
ltrace|ltrace|-|åº“è°ƒç”¨è¿½è¸ª
dstat|dstat|-|èµ„æºç»Ÿè®¡å·¥å…·
iotop|iotop|iotop|IOç›‘æ§
iftop|iftop|iftop|ç½‘ç»œå¸¦å®½ç›‘æ§
nload|nload|nload|ç½‘ç»œæµé‡ç›‘æ§
<span class="hljs-meta prompt_">
# </span><span class="bash">æ–‡ä»¶å’Œå‹ç¼©å·¥å…·</span>
tar|tar|tar|å½’æ¡£å·¥å…·
gzip|gzip|gzip|gzipå‹ç¼©
gunzip|gzip|gzip|gzipè§£å‹
bzip2|bzip2|bzip2|bzip2å‹ç¼©
bunzip2|bzip2|bzip2|bzip2è§£å‹
xz|xz-utils|xz|xzå‹ç¼©
unxz|xz-utils|xz|xzè§£å‹
zip|zip|zip|zipå‹ç¼©
unzip|unzip|unzip|zipè§£å‹
7z|p7zip-full|p7zip|7zipå‹ç¼©
rar|unrar|-|RARè§£å‹
file|file|file|æ–‡ä»¶ç±»å‹è¯†åˆ«
stat|coreutils|coreutils|æ–‡ä»¶çŠ¶æ€
du|coreutils|coreutils|ç£ç›˜ä½¿ç”¨ç»Ÿè®¡
df|coreutils|coreutils|ç£ç›˜ç©ºé—´ç»Ÿè®¡
ln|coreutils|coreutils|é“¾æ¥åˆ›å»º
cp|coreutils|coreutils|æ–‡ä»¶å¤åˆ¶
mv|coreutils|coreutils|æ–‡ä»¶ç§»åŠ¨
rm|coreutils|coreutils|æ–‡ä»¶åˆ é™¤
mkdir|coreutils|coreutils|åˆ›å»ºç›®å½•
rmdir|coreutils|coreutils|åˆ é™¤ç›®å½•
chmod|coreutils|coreutils|æƒé™ä¿®æ”¹
chown|coreutils|coreutils|æ‰€æœ‰è€…ä¿®æ”¹
touch|coreutils|coreutils|ä¿®æ”¹æ—¶é—´æˆ³
<span class="hljs-meta prompt_">
# </span><span class="bash">æŸ¥æ‰¾å’Œæœç´¢å·¥å…·</span>
find|findutils|findutils|æ–‡ä»¶æŸ¥æ‰¾
locate|mlocate|mlocate|å¿«é€Ÿæ–‡ä»¶å®šä½
which|debianutils|which|å‘½ä»¤è·¯å¾„æŸ¥æ‰¾
whereis|util-linux|util-linux|å‘½ä»¤ä½ç½®æŸ¥æ‰¾
grep|grep|grep|æ–‡æœ¬æœç´¢
egrep|grep|grep|æ‰©å±•æ­£åˆ™æœç´¢
fgrep|grep|grep|å›ºå®šå­—ç¬¦ä¸²æœç´¢
ack|ack|ack|ä»£ç æœç´¢å·¥å…·
ag|silversearcher-ag|the_silver_searcher|å¿«é€Ÿä»£ç æœç´¢
rg|ripgrep|-|æ›´å¿«çš„ä»£ç æœç´¢
<span class="hljs-meta prompt_">
# </span><span class="bash">æ–‡æœ¬å¤„ç†</span>
sed|sed|sed|æµç¼–è¾‘å™¨
awk|gawk|gawk|æ–‡æœ¬å¤„ç†è¯­è¨€
gawk|gawk|gawk|GNU AWK
cut|coreutils|coreutils|æ–‡æœ¬åˆ‡å‰²
sort|coreutils|coreutils|æ’åº
uniq|coreutils|coreutils|å»é‡
wc|coreutils|coreutils|å­—æ•°ç»Ÿè®¡
tr|coreutils|coreutils|å­—ç¬¦è½¬æ¢
tee|coreutils|coreutils|è¾“å‡ºåˆ†æµ
xargs|findutils|findutils|å‚æ•°ä¼ é€’
column|bsdmainutils|util-linux|åˆ—æ ¼å¼åŒ–
<span class="hljs-meta prompt_">
# </span><span class="bash">ç‰ˆæœ¬æ§åˆ¶</span>
git|git|git|Gitç‰ˆæœ¬æ§åˆ¶
svn|subversion|subversion|SVNç‰ˆæœ¬æ§åˆ¶
<span class="hljs-meta prompt_">
# </span><span class="bash">ç³»ç»Ÿç®¡ç†</span>
sudo|sudo|sudo|æƒé™æå‡
su|login|shadow|ç”¨æˆ·åˆ‡æ¢
useradd|passwd|shadow|æ·»åŠ ç”¨æˆ·
usermod|passwd|shadow|ä¿®æ”¹ç”¨æˆ·
userdel|passwd|shadow|åˆ é™¤ç”¨æˆ·
groupadd|passwd|shadow|æ·»åŠ ç»„
passwd|passwd|passwd|ä¿®æ”¹å¯†ç 
crontab|cron|busybox|å®šæ—¶ä»»åŠ¡
systemctl|systemd|-|æœåŠ¡ç®¡ç†ï¼ˆDebianï¼‰
service|sysvinit-utils|openrc|æœåŠ¡ç®¡ç†
rc-service|-|openrc|æœåŠ¡ç®¡ç†ï¼ˆAlpineï¼‰
<span class="hljs-meta prompt_">
# </span><span class="bash">å¼€å‘å·¥å…·</span>
make|make|make|æ„å»ºå·¥å…·
gcc|gcc|gcc|Cç¼–è¯‘å™¨
g++|g++|g++|C++ç¼–è¯‘å™¨
python|python3|python3|Pythonè§£é‡Šå™¨
python3|python3|python3|Python3è§£é‡Šå™¨
pip|python3-pip|py3-pip|PythonåŒ…ç®¡ç†
node|nodejs|nodejs|Node.js
npm|npm|npm|NodeåŒ…ç®¡ç†
perl|perl|perl|Perlè§£é‡Šå™¨
<span class="hljs-meta prompt_">
# </span><span class="bash">æ•°æ®åº“å®¢æˆ·ç«¯</span>
mysql|mariadb-client|mariadb-client|MySQLå®¢æˆ·ç«¯
psql|postgresql-client|postgresql-client|PostgreSQLå®¢æˆ·ç«¯
redis-cli|redis-tools|redis|Rediså®¢æˆ·ç«¯
mongo|mongodb-clients|-|MongoDBå®¢æˆ·ç«¯
sqlite3|sqlite3|sqlite|SQLiteå®¢æˆ·ç«¯
<span class="hljs-meta prompt_">
# </span><span class="bash">å…¶ä»–å®ç”¨å·¥å…·</span>
procps|procps|procps|è¿›ç¨‹å·¥å…·é›†
coreutils|coreutils|coreutils|æ ¸å¿ƒå·¥å…·é›†
util-linux|util-linux|util-linux|ç³»ç»Ÿå·¥å…·é›†
ca-certificates|ca-certificates|ca-certificates|CAè¯ä¹¦
openssl|openssl|openssl|SSLå·¥å…·
tzdata|tzdata|tzdata|æ—¶åŒºæ•°æ®
locales|locales|-|è¯­è¨€ç¯å¢ƒï¼ˆä»…Debianï¼‰
bash|bash|bash|Bash shell
zsh|zsh|zsh|Zsh shell
tmux|tmux|tmux|ç»ˆç«¯å¤ç”¨å™¨
screen|screen|screen|ç»ˆç«¯å¤ç”¨å™¨
rsync|rsync|rsync|æ–‡ä»¶åŒæ­¥
sshpass|sshpass|sshpass|SSHå¯†ç å·¥å…·
expect|expect|expect|è‡ªåŠ¨åŒ–äº¤äº’å·¥å…·
bc|bc|bc|è®¡ç®—å™¨
xxd|xxd|vim|åå…­è¿›åˆ¶æŸ¥çœ‹
hexdump|bsdmainutils|util-linux|åå…­è¿›åˆ¶è½¬å‚¨
base64|coreutils|coreutils|Base64ç¼–è§£ç 
md5sum|coreutils|coreutils|MD5æ ¡éªŒ
sha256sum|coreutils|coreutils|SHA256æ ¡éªŒ

</code></pre>
<h5 data-id="heading-8">build.sh</h5>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">#</span><span class="bash">!/bin/bash</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">PHP Hyperf Docker æ„å»ºè„šæœ¬</span>
<span class="hljs-meta prompt_"># </span><span class="bash">ç”¨æ³•: ./build.sh é•œåƒåç§°:æ ‡ç­¾</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>

set -e
set -o pipefail  # ç¡®ä¿ç®¡é“ä¸­ä»»ä½•ä¸€æ­¥å¤±è´¥ï¼Œæ•´ä¸ªå‘½ä»¤éƒ½è¿”å›é”™è¯¯
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">å…¨å±€å˜é‡</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" &amp;&amp; pwd)"
CONFIG_DIR="${SCRIPT_DIR}/config"
BUILD_SCRIPTS_DIR="${SCRIPT_DIR}/build_scripts"
EXTENSION_DIR="${SCRIPT_DIR}/extension"
LOGS_DIR="${SCRIPT_DIR}/logs"
LOG_FILE="${LOGS_DIR}/build_$(date +%Y%m%d_%H%M%S).log"
<span class="hljs-meta prompt_">
# </span><span class="bash">é…ç½®æ–‡ä»¶</span>
BUILD_CONF="${CONFIG_DIR}/build.conf"
EXTENSION_DEPS_CONF="${CONFIG_DIR}/extension_deps.conf"
EXTENSION_SPECIAL_CONF="${CONFIG_DIR}/extension_special.conf"
<span class="hljs-meta prompt_">
# </span><span class="bash">é»˜è®¤å€¼</span>
DEFAULT_WORKDIR="/opt/www"
DEFAULT_MODE="prod"
DEFAULT_COMPOSER_MIRROR="auto"
<span class="hljs-meta prompt_">
# </span><span class="bash">Bash ç‰ˆæœ¬æ£€æŸ¥</span>
BASH_VERSION_MAJOR="${BASH_VERSION%%.*}"
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">é¢œè‰²å®šä¹‰</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
MAGENTA='\033[0;35m'
CYAN='\033[0;36m'
WHITE='\033[1;37m'
NC='\033[0m' # No Color
BOLD='\033[1m'
BLINK='\033[5m'
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ—¥å¿—å‡½æ•°</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
log_info() {
    local msg="[$(date '+%Y-%m-%d %H:%M:%S')] [INFO] $1"
    echo -e "${GREEN}${msg}${NC}"
    echo "$msg" &gt;&gt; "$LOG_FILE"
}

log_warn() {
    local msg="[$(date '+%Y-%m-%d %H:%M:%S')] [WARN] $1"
    echo -e "${YELLOW}${msg}${NC}"
    echo "$msg" &gt;&gt; "$LOG_FILE"
}

log_error() {
    local msg="[$(date '+%Y-%m-%d %H:%M:%S')] [ERROR] $1"
    echo -e "${RED}${BOLD}${msg}${NC}"
    echo "$msg" &gt;&gt; "$LOG_FILE"
}

log_success() {
    local msg="[$(date '+%Y-%m-%d %H:%M:%S')] [SUCCESS] $1"
    echo -e "${GREEN}${BOLD}${msg}${NC}"
    echo "$msg" &gt;&gt; "$LOG_FILE"
}

log_step() {
    local msg="[$(date '+%Y-%m-%d %H:%M:%S')] [STEP] $1"
    echo -e "${CYAN}${BOLD}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo -e "${CYAN}${BOLD}  $1${NC}"
    echo -e "${CYAN}${BOLD}â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo "$msg" &gt;&gt; "$LOG_FILE"
}

log_debug() {
    if [ "$DEBUG" = "true" ]; then
        local msg="[$(date '+%Y-%m-%d %H:%M:%S')] [DEBUG] $1"
        echo -e "${MAGENTA}${msg}${NC}"
        echo "$msg" &gt;&gt; "$LOG_FILE"
    fi
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">è¿›åº¦æ˜¾ç¤ºå‡½æ•°</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
SPINNER_PID=""

start_spinner() {
    local msg="$1"
    local delay=0.1
    local spinstr='â ‹â ™â ¹â ¸â ¼â ´â ¦â §â ‡â '
    
    (
        while true; do
            for (( i=0; i&lt;${#spinstr}; i++ )); do
                echo -ne "\r${CYAN}${BLINK}${spinstr:$i:1}${NC} ${msg}   "
                sleep $delay
            done
        done
    ) &amp;
    SPINNER_PID=$!
    disown
}

stop_spinner() {
    local status="$1"
    if [ -n "$SPINNER_PID" ]; then
        kill $SPINNER_PID 2&gt;/dev/null || true
        wait $SPINNER_PID 2&gt;/dev/null || true
        SPINNER_PID=""
    fi
    
    if [ "$status" = "success" ]; then
        echo -e "\r${GREEN}âœ”${NC} $2                    "
    elif [ "$status" = "fail" ]; then
        echo -e "\r${RED}âœ˜${NC} $2                    "
    else
        echo -e "\r  $2                    "
    fi
}
<span class="hljs-meta prompt_">
# </span><span class="bash">è¿›åº¦æ¡</span>
show_progress() {
    local current=$1
    local total=$2
    local msg="$3"
    local width=50
    local percent=$((current * 100 / total))
    local filled=$((current * width / total))
    local empty=$((width - filled))
    
    printf "\r${CYAN}[${NC}"
    printf "%${filled}s" | tr ' ' 'â–ˆ'
    printf "%${empty}s" | tr ' ' 'â–‘'
    printf "${CYAN}]${NC} ${percent}%% ${msg}"
    
    if [ "$current" -eq "$total" ]; then
        echo ""
    fi
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">é…ç½®è§£æå‡½æ•°</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
declare -A CONFIG
declare -a EXTENSIONS
declare -a SYSTEM_TOOLS
declare -A PHP_CONFIG
declare -A ENV_VARS
declare -A BUILD_ARGS
declare -A TOOLS_DEBIAN
declare -A TOOLS_ALPINE

parse_config() {
    log_step "è§£æé…ç½®æ–‡ä»¶"
    
    if [ ! -f "$BUILD_CONF" ]; then
        log_error "é…ç½®æ–‡ä»¶ä¸å­˜åœ¨: $BUILD_CONF"
        exit 1
    fi
    
    start_spinner "æ­£åœ¨è§£æ build.conf..."
    
    local current_section=""
    local line_num=0
    
    while IFS= read -r line || [ -n "$line" ]; do
        line_num=$((line_num + 1))
        
        # å»é™¤é¦–å°¾ç©ºç™½
        line="$(echo "$line" | sed -e 's/^[[:space:]]*//' -e 's/[[:space:]]*$//')"
        
        # è·³è¿‡ç©ºè¡Œå’Œæ³¨é‡Š
        if [ -z "$line" ] || [[ "$line" =~ ^# ]]; then
            continue
        fi
        
        # æ£€æµ‹æ®µè½
        if [[ "$line" =~ ^\[([a-zA-Z_]+)\]$ ]]; then
            current_section="${BASH_REMATCH[1]}"
            log_debug "è¿›å…¥æ®µè½: $current_section"
            continue
        fi
        
        # æ ¹æ®æ®µè½è§£æå†…å®¹
        case "$current_section" in
            base_image)
                if [[ ! "$line" =~ ^# ]]; then
                    CONFIG["base_image"]="$line"
                    log_debug "åŸºç¡€é•œåƒ: $line"
                fi
                ;;
            extension)
                EXTENSIONS+=("$line")
                log_debug "æ‰©å±•: $line"
                ;;
            mode)
                CONFIG["mode"]="$line"
                ;;
            workdir)
                CONFIG["workdir"]="$line"
                ;;
            composer_mirror)
                CONFIG["composer_mirror"]="$line"
                ;;
            system_mirror)
                CONFIG["system_mirror"]="$line"
                ;;
            php)
                if [[ "$line" =~ ^([^=]+)=(.*)$ ]]; then
                    local key="${BASH_REMATCH[1]}"
                    local value="${BASH_REMATCH[2]}"
                    PHP_CONFIG["$key"]="$value"
                fi
                ;;
            cmd)
                CONFIG["cmd"]="$line"
                ;;
            system_tools)
                SYSTEM_TOOLS+=("$line")
                log_debug "ç³»ç»Ÿå·¥å…·: $line"
                ;;
            extra_packages)
                if [ -n "$line" ]; then
                    CONFIG["extra_packages"]="${CONFIG["extra_packages"]} $line"
                fi
                ;;
            env)
                if [[ "$line" =~ ^([^=]+)=(.*)$ ]]; then
                    ENV_VARS["${BASH_REMATCH[1]}"]="${BASH_REMATCH[2]}"
                fi
                ;;
            build_args)
                if [[ "$line" =~ ^([^=]+)=(.*)$ ]]; then
                    BUILD_ARGS["${BASH_REMATCH[1]}"]="${BASH_REMATCH[2]}"
                fi
                ;;
        esac
    done &lt; "$BUILD_CONF"
    
    # è®¾ç½®é»˜è®¤å€¼
    CONFIG["base_image"]="${CONFIG["base_image"]:-php:8.2-cli}"
    CONFIG["mode"]="${CONFIG["mode"]:-$DEFAULT_MODE}"
    CONFIG["workdir"]="${CONFIG["workdir"]:-$DEFAULT_WORKDIR}"
    CONFIG["composer_mirror"]="${CONFIG["composer_mirror"]:-$DEFAULT_COMPOSER_MIRROR}"
    CONFIG["system_mirror"]="${CONFIG["system_mirror"]:-default}"
    
    stop_spinner "success" "é…ç½®è§£æå®Œæˆ"
    
    # æ˜¾ç¤ºè§£æç»“æœ
    log_info "åŸºç¡€é•œåƒ: ${CONFIG["base_image"]}"
    log_info "æ„å»ºæ¨¡å¼: ${CONFIG["mode"]}"
    log_info "å·¥ä½œç›®å½•: ${CONFIG["workdir"]}"
    log_info "ç³»ç»Ÿé•œåƒæº: ${CONFIG["system_mirror"]}"
    log_info "Composeræº: ${CONFIG["composer_mirror"]}"
    log_info "æ‰©å±•æ•°é‡: ${#EXTENSIONS[@]}"
    log_info "ç³»ç»Ÿå·¥å…·æ•°é‡: ${#SYSTEM_TOOLS[@]}"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ£€æµ‹é•œåƒç±»å‹</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
detect_image_type() {
    local image="${CONFIG["base_image"]}"
    
    if [[ "$image" =~ alpine ]]; then
        CONFIG["os_type"]="alpine"
        CONFIG["pkg_manager"]="apk"
    else
        CONFIG["os_type"]="debian"
        CONFIG["pkg_manager"]="apt-get"
    fi
    
    # æå– PHP ç‰ˆæœ¬
    if [[ "$image" =~ php:([0-9]+\.[0-9]+) ]]; then
        CONFIG["php_version"]="${BASH_REMATCH[1]}"
        CONFIG["php_major"]="${CONFIG["php_version"]%%.*}"
    else
        CONFIG["php_version"]="8.2"
        CONFIG["php_major"]="8"
    fi
    
    log_info "æ“ä½œç³»ç»Ÿç±»å‹: ${CONFIG["os_type"]}"
    log_info "PHP ç‰ˆæœ¬: ${CONFIG["php_version"]}"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ‰©å±•ä¾èµ–è§£æ</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
declare -A EXT_DEPS_DEBIAN
declare -A EXT_DEPS_ALPINE

parse_extension_deps() {
    log_step "è§£ææ‰©å±•ä¾èµ–é…ç½®"
    
    if [ ! -f "$EXTENSION_DEPS_CONF" ]; then
        log_warn "æ‰©å±•ä¾èµ–é…ç½®æ–‡ä»¶ä¸å­˜åœ¨: $EXTENSION_DEPS_CONF"
        return
    fi
    
    while IFS='|' read -r ext debian alpine; do
        # è·³è¿‡æ³¨é‡Šå’Œç©ºè¡Œ
        [[ "$ext" =~ ^# ]] &amp;&amp; continue
        [ -z "$ext" ] &amp;&amp; continue
        
        ext="$(echo "$ext" | tr -d '[:space:]')"
        EXT_DEPS_DEBIAN["$ext"]="$debian"
        EXT_DEPS_ALPINE["$ext"]="$alpine"
    done &lt; "$EXTENSION_DEPS_CONF"
    
    log_info "å·²åŠ è½½ ${#EXT_DEPS_DEBIAN[@]} ä¸ªæ‰©å±•ä¾èµ–é…ç½®"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ‰©å±•ç‰¹æ®Šé…ç½®è§£æ</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
declare -A EXT_SPECIAL

parse_extension_special() {
    log_step "è§£ææ‰©å±•ç‰¹æ®Šé…ç½®"
    
    if [ ! -f "$EXTENSION_SPECIAL_CONF" ]; then
        log_warn "æ‰©å±•ç‰¹æ®Šé…ç½®æ–‡ä»¶ä¸å­˜åœ¨: $EXTENSION_SPECIAL_CONF"
        return
    fi
    
    local current_ext=""
    local current_key=""
    local in_heredoc=false
    local heredoc_content=""
    
    while IFS= read -r line || [ -n "$line" ]; do
        # æ£€æµ‹æ‰©å±•æ®µè½
        if [[ "$line" =~ ^\[([a-zA-Z0-9_]+)\]$ ]]; then
            current_ext="${BASH_REMATCH[1]}"
            continue
        fi
        
        # è·³è¿‡æ³¨é‡Šå’Œç©ºè¡Œ
        [[ "$line" =~ ^[[:space:]]*# ]] &amp;&amp; continue
        
        if [ -n "$current_ext" ]; then
            # å¤„ç† heredoc
            if [ "$in_heredoc" = true ]; then
                if [[ "$line" =~ ^EOF$ ]]; then
                    EXT_SPECIAL["${current_ext}_${current_key}"]="$heredoc_content"
                    in_heredoc=false
                    heredoc_content=""
                else
                    heredoc_content="${heredoc_content}${line}\n"
                fi
                continue
            fi
            
            # æ£€æµ‹ heredoc å¼€å§‹
            if [[ "$line" =~ ^([a-zA-Z_]+)=\&lt;\&lt;EOF$ ]]; then
                current_key="${BASH_REMATCH[1]}"
                in_heredoc=true
                heredoc_content=""
                continue
            fi
            
            # æ™®é€šé”®å€¼å¯¹
            if [[ "$line" =~ ^([a-zA-Z_]+)=(.+)$ ]]; then
                local key="${BASH_REMATCH[1]}"
                local value="${BASH_REMATCH[2]}"
                EXT_SPECIAL["${current_ext}_${key}"]="$value"
            fi
        fi
    done &lt; "$EXTENSION_SPECIAL_CONF"
    
    log_info "å·²åŠ è½½æ‰©å±•ç‰¹æ®Šé…ç½®"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">è§£æç³»ç»Ÿå·¥å…·é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
resolve_system_tools() {
    log_step "è§£æç³»ç»Ÿå·¥å…·æ˜ å°„"

    local tools_conf="${CONFIG_DIR}/system_tools.conf"
    if [ ! -f "$tools_conf" ]; then
        log_warn "ç³»ç»Ÿå·¥å…·æ˜ å°„æ–‡ä»¶ä¸å­˜åœ¨: $tools_conf"
        return
    fi

    local os_type="${CONFIG["os_type"]}"
    local tool_packages=""

    # è¯»å–é…ç½®æ–‡ä»¶å»ºç«‹æ˜ å°„
    declare -A TOOLS_MAP
    while IFS='|' read -r tool debian alpine desc; do
        [[ "$tool" =~ ^# ]] &amp;&amp; continue
        [ -z "$tool" ] &amp;&amp; continue

        tool="$(echo "$tool" | tr -d '[:space:]')"

        if [ "$os_type" = "alpine" ]; then
            TOOLS_MAP["$tool"]="$(echo "$alpine" | tr -d '[:space:]')"
        else
            TOOLS_MAP["$tool"]="$(echo "$debian" | tr -d '[:space:]')"
        fi
    done &lt; "$tools_conf"

    # åŒ¹é…é€‰ä¸­çš„å·¥å…·
    for tool in "${SYSTEM_TOOLS[@]}"; do
        # å»é™¤æ³¨é‡Š
        [[ "$tool" =~ ^# ]] &amp;&amp; continue

        local pkg_name="${TOOLS_MAP[$tool]}"

        if [ -n "$pkg_name" ] &amp;&amp; [ "$pkg_name" != "-" ]; then
            tool_packages="$tool_packages $pkg_name"
            log_debug "æ˜ å°„å·¥å…·: $tool -&gt; $pkg_name"
        else
            log_warn "æœªæ‰¾åˆ°å·¥å…· $tool çš„å¯¹åº”åŒ…åæˆ–è¯¥ç³»ç»Ÿä¸æ”¯æŒ"
        fi
    done

    # å°†ç»“æœä¿å­˜åˆ°å…¨å±€é…ç½®ä¸­ï¼Œä¾›åç»­ä½¿ç”¨
    CONFIG["resolved_tools"]="$tool_packages"
    log_info "å·²è§£æç³»ç»Ÿå·¥å…·åŒ…: $tool_packages"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ£€æŸ¥æœ¬åœ°æ‰©å±•</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
declare -A LOCAL_EXTENSIONS

check_local_extensions() {
    log_step "æ£€æŸ¥æœ¬åœ°æ‰©å±•ç›®å½•"
    
    if [ ! -d "$EXTENSION_DIR" ]; then
        log_info "æœ¬åœ°æ‰©å±•ç›®å½•ä¸å­˜åœ¨ï¼Œè·³è¿‡æœ¬åœ°æ‰©å±•æ£€æŸ¥"
        return
    fi
    
    local ext_count=0
    
    shopt -s nullglob
    local ext_files=("$EXTENSION_DIR"/*.tgz "$EXTENSION_DIR"/*.tar.gz "$EXTENSION_DIR"/*.zip)
    shopt -u nullglob
    
    for ext_file in "${ext_files[@]}"; do
        [ -f "$ext_file" ] || continue
        
        local filename=$(basename "$ext_file")
        local ext_name=""
        local ext_version=""
        
        # è§£ææ‰©å±•åå’Œç‰ˆæœ¬
        if [[ "$filename" =~ ^([a-zA-Z_]+)-([0-9.]+)\.(tgz|tar\.gz|zip)$ ]]; then
            ext_name="${BASH_REMATCH[1]}"
            ext_version="${BASH_REMATCH[2]}"
        elif [[ "$filename" =~ ^([a-zA-Z_]+)\.(tgz|tar\.gz|zip)$ ]]; then
            ext_name="${BASH_REMATCH[1]}"
            ext_version="latest"
        fi
        
        if [ -n "$ext_name" ]; then
            # æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨è¯¥æ‰©å±•çš„è®°å½•
            if [ -n "${LOCAL_EXTENSIONS[$ext_name]}" ]; then
                # æ¯”è¾ƒç‰ˆæœ¬ï¼Œä¿ç•™æ›´é«˜ç‰ˆæœ¬
                local existing_version="${LOCAL_EXTENSIONS[$ext_name]%%|*}"
                if version_compare "$ext_version" "$existing_version"; then
                    LOCAL_EXTENSIONS["$ext_name"]="${ext_version}|${ext_file}"
                    log_debug "æ›´æ–°æœ¬åœ°æ‰©å±•: $ext_name ç‰ˆæœ¬ $existing_version -&gt; $ext_version"
                fi
            else
                LOCAL_EXTENSIONS["$ext_name"]="${ext_version}|${ext_file}"
                log_debug "å‘ç°æœ¬åœ°æ‰©å±•: $ext_name ç‰ˆæœ¬ $ext_version"
            fi
            ext_count=$((ext_count + 1))
        fi
    done
    
    log_info "å‘ç° ${#LOCAL_EXTENSIONS[@]} ä¸ªæœ¬åœ°æ‰©å±•"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">ç‰ˆæœ¬æ¯”è¾ƒå‡½æ•°</span>
version_compare() {
    local v1="$1"
    local v2="$2"
    
    [ "$v1" = "latest" ] &amp;&amp; return 0
    [ "$v2" = "latest" ] &amp;&amp; return 1
    
    if [ "$(printf '%s\n' "$v1" "$v2" | sort -V | tail -n1)" = "$v1" ]; then
        return 0
    else
        return 1
    fi
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">åˆ¤æ–­æ‰©å±•ç±»å‹</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ ¸å¿ƒæ‰©å±•åˆ—è¡¨ï¼ˆä½¿ç”¨ docker-php-ext-installï¼‰</span>
CORE_EXTENSIONS=(
    "bcmath" "bz2" "calendar" "ctype" "curl" "dba" "dom" "enchant"
    "exif" "fileinfo" "filter" "ftp" "gd" "gettext" "gmp" "hash"
    "iconv" "imap" "intl" "json" "ldap" "mbstring" "mysqli" "oci8"
    "odbc" "opcache" "pcntl" "pdo" "pdo_dblib" "pdo_firebird" "pdo_mysql"
    "pdo_oci" "pdo_odbc" "pdo_pgsql" "pdo_sqlite" "pgsql" "phar" "posix"
    "pspell" "readline" "reflection" "session" "shmop" "simplexml"
    "snmp" "soap" "sockets" "sodium" "spl" "standard" "sysvmsg"
    "sysvsem" "sysvshm" "tidy" "tokenizer" "xml" "xmlreader" "xmlrpc"
    "xmlwriter" "xsl" "zip" "zlib"
)

is_core_extension() {
    local ext="$1"
    for core_ext in "${CORE_EXTENSIONS[@]}"; do
        [ "$ext" = "$core_ext" ] &amp;&amp; return 0
    done
    return 1
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">ç”Ÿæˆå®‰è£…è„šæœ¬</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
generate_install_scripts() {
    log_step "ç”Ÿæˆå®‰è£…è„šæœ¬"
    
    # åˆ›å»ºè„šæœ¬ç›®å½•
    mkdir -p "$BUILD_SCRIPTS_DIR"
    
    local os_type="${CONFIG["os_type"]}"
    local php_major="${CONFIG["php_major"]}"
    local total_ext=${#EXTENSIONS[@]}
    local current_ext=0

    # è§£æç³»ç»Ÿå·¥å…·
    resolve_system_tools
    
    # æ”¶é›†æ‰€æœ‰ä¾èµ–
    local all_deps=""
    local install_core=""
    local install_pecl=""
    local install_local=""
    local configure_cmds=""
    local pre_install_cmds=""
    local post_install_cmds=""
    
    for ext_entry in "${EXTENSIONS[@]}"; do
        current_ext=$((current_ext + 1))
        show_progress $current_ext $total_ext "å¤„ç†æ‰©å±•: $ext_entry"
        
        # è§£ææ‰©å±•åå’Œç‰ˆæœ¬
        local ext_name=""
        local ext_version=""
        local force_local=false
        local force_pecl=false
        
        # æ£€æŸ¥å¼ºåˆ¶æ ‡è®°
        if [[ "$ext_entry" =~ ^local:(.+)$ ]]; then
            ext_entry="${BASH_REMATCH[1]}"
            force_local=true
        elif [[ "$ext_entry" =~ ^pecl:(.+)$ ]]; then
            ext_entry="${BASH_REMATCH[1]}"
            force_pecl=true
        fi
        
        # è§£æç‰ˆæœ¬å·
        if [[ "$ext_entry" =~ ^([a-zA-Z_]+)-([0-9.]+)$ ]]; then
            ext_name="${BASH_REMATCH[1]}"
            ext_version="${BASH_REMATCH[2]}"
        else
            ext_name="$ext_entry"
            ext_version=""
        fi
        
        # æ£€æŸ¥æ˜¯å¦ä»…é™ç‰¹å®šæ¨¡å¼
        local mode_only="${EXT_SPECIAL["${ext_name}_mode_only"]}"
        if [ -n "$mode_only" ] &amp;&amp; [ "$mode_only" != "${CONFIG["mode"]}" ]; then
            log_debug "è·³è¿‡æ‰©å±• $ext_name (ä»…é™ $mode_only æ¨¡å¼)"
            continue
        fi
        
        # è·å–ä¾èµ–
        local deps=""
        if [ "$os_type" = "alpine" ]; then
            deps="${EXT_DEPS_ALPINE[$ext_name]}"
        else
            deps="${EXT_DEPS_DEBIAN[$ext_name]}"
        fi
        
        if [ -n "$deps" ]; then
            all_deps="$all_deps $deps"
        fi
        
        # æ£€æŸ¥é¢„å®‰è£…å‘½ä»¤
        local pre_install="${EXT_SPECIAL["${ext_name}_pre_install"]}"
        if [ -n "$pre_install" ]; then
            pre_install_cmds="${pre_install_cmds}\n# Pre-install for $ext_name\n$(echo -e "$pre_install")"
        fi
        
        # æ£€æŸ¥é¢å¤–é…ç½®
        local extra_cmd=""
        if [ "$os_type" = "debian" ]; then
            extra_cmd="${EXT_SPECIAL["${ext_name}_debian_extra"]}"
        fi
        if [ -n "$extra_cmd" ]; then
            pre_install_cmds="${pre_install_cmds}\n$extra_cmd"
        fi
        
        # ç¡®å®šå®‰è£…æ–¹å¼
        local install_method="${EXT_SPECIAL["${ext_name}_install_method"]}"
        
        # æ£€æŸ¥æ˜¯å¦è·³è¿‡å®‰è£…ï¼ˆå·²åœ¨ pre_install ä¸­å®Œæˆï¼‰
        local skip_install="${EXT_SPECIAL["${ext_name}_skip_install"]}"
        if [ "$skip_install" = "true" ]; then
            log_debug "æ‰©å±• $ext_name å°†åœ¨ pre_install è„šæœ¬ä¸­å®‰è£…"
            continue
        fi
        
        # æ£€æŸ¥æœ¬åœ°æ‰©å±•
        if [ "$force_local" = true ] || [ -n "${LOCAL_EXTENSIONS[$ext_name]}" ]; then
            local local_info="${LOCAL_EXTENSIONS[$ext_name]}"
            if [ -n "$local_info" ]; then
                local local_file="${local_info#*|}"
                install_local="${install_local}\n# Install $ext_name from local\ninstall_local_extension \"$ext_name\" \"$local_file\""
                continue
            fi
        fi
        
        # æ£€æŸ¥æ˜¯å¦ä¸ºæ ¸å¿ƒæ‰©å±•
        if is_core_extension "$ext_name" &amp;&amp; [ "$force_pecl" != true ] &amp;&amp; [ "$install_method" != "pecl" ]; then
            # æ£€æŸ¥é…ç½®å‘½ä»¤
            local configure_cmd=""
            if [ "$php_major" -lt 8 ]; then
                configure_cmd="${EXT_SPECIAL["${ext_name}_php7_${os_type}_configure"]}"
            fi
            if [ -z "$configure_cmd" ]; then
                configure_cmd="${EXT_SPECIAL["${ext_name}_${os_type}_configure"]}"
            fi
            
            if [ -n "$configure_cmd" ]; then
                configure_cmds="${configure_cmds}\n$configure_cmd"
            fi
            
            install_core="${install_core} $ext_name"
        else
            # PECL å®‰è£…
            local pecl_name="$ext_name"
            if [ -n "$ext_version" ]; then
                pecl_name="${ext_name}-${ext_version}"
            fi
            
            # æ£€æŸ¥ PECL é…ç½®å‚æ•°
            local pecl_configure=""
            if [ "$php_major" -lt 8 ]; then
                pecl_configure="${EXT_SPECIAL["${ext_name}_php7_pecl_configure"]}"
            fi
            if [ -z "$pecl_configure" ]; then
                pecl_configure="${EXT_SPECIAL["${ext_name}_pecl_configure"]}"
            fi
            
            if [ -n "$pecl_configure" ]; then
                install_pecl="${install_pecl}\ninstall_pecl_extension \"$pecl_name\" \"$pecl_configure\""
            else
                install_pecl="${install_pecl}\ninstall_pecl_extension \"$pecl_name\" \"\""
            fi
        fi
        
        # æ£€æŸ¥åç½®å®‰è£…å‘½ä»¤
        local post_install="${EXT_SPECIAL["${ext_name}_post_install"]}"
        if [ -n "$post_install" ]; then
            post_install_cmds="${post_install_cmds}\n# Post-install for $ext_name\n$(echo -e "$post_install")"
        fi
        
        # æ£€æŸ¥ PHP é…ç½®
        local php_ini_config=""
        if [ "${CONFIG["mode"]}" = "prod" ]; then
            php_ini_config="${EXT_SPECIAL["${ext_name}_prod_php_ini_config"]}"
        fi
        if [ -z "$php_ini_config" ]; then
            php_ini_config="${EXT_SPECIAL["${ext_name}_php_ini_config"]}"
        fi
        if [ -n "$php_ini_config" ]; then
            # æ·»åŠ åˆ° PHP é…ç½®
            while IFS= read -r ini_line; do
                [ -z "$ini_line" ] &amp;&amp; continue
                if [[ "$ini_line" =~ ^([^=]+)=(.*)$ ]]; then
                    PHP_CONFIG["${BASH_REMATCH[1]}"]="${BASH_REMATCH[2]}"
                fi
            done &lt;&lt;&lt; "$(echo -e "$php_ini_config")"
        fi
    done
    
    # å»é‡ä¾èµ–
    all_deps=$(echo "$all_deps" | tr ',' ' ' | tr ' ' '\n' | sort -u | tr '\n' ' ')
    
<span class="hljs-meta prompt_"># </span><span class="bash">   log_info <span class="hljs-string">"ç”Ÿæˆä¾èµ–å®‰è£…è„šæœ¬..."</span></span>
<span class="hljs-meta prompt_"># </span><span class="bash">   generate_deps_script <span class="hljs-string">"<span class="hljs-variable">$all_deps</span>"</span></span>
    # åˆå¹¶æ‰©å±•ä¾èµ–å’Œç³»ç»Ÿå·¥å…·åŒ…
    local final_deps="${all_deps} ${CONFIG["resolved_tools"]}"
    # å»é‡å¤„ç†
    final_deps=$(echo "$final_deps" | tr ' ' '\n' | sort -u | tr '\n' ' ')

    log_info "ç”Ÿæˆä¾èµ–å®‰è£…è„šæœ¬(åŒ…å«ç³»ç»Ÿå·¥å…·)..."
    generate_deps_script "$final_deps"
    
    log_info "ç”Ÿæˆæ‰©å±•å®‰è£…è„šæœ¬..."
    generate_extensions_script "$install_core" "$install_pecl" "$install_local" "$configure_cmds" "$pre_install_cmds"
    
    log_info "ç”Ÿæˆåç½®å®‰è£…è„šæœ¬..."
    generate_post_install_script "$post_install_cmds"
    
    log_info "ç”Ÿæˆ Composer å®‰è£…è„šæœ¬..."
    generate_composer_script
    
    log_info "ç”Ÿæˆ PHP é…ç½®æ–‡ä»¶..."
    generate_php_ini
    
    log_info "ç”Ÿæˆç¯å¢ƒå˜é‡æ–‡ä»¶..."
    generate_env_file
    
<span class="hljs-meta prompt_"># </span><span class="bash">   log_info <span class="hljs-string">"ç”Ÿæˆå…¥å£ç‚¹è„šæœ¬..."</span></span>
<span class="hljs-meta prompt_"># </span><span class="bash">   generate_entrypoint_script</span>
    
    log_success "æ‰€æœ‰å®‰è£…è„šæœ¬ç”Ÿæˆå®Œæˆ"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">ç”Ÿæˆä¾èµ–å®‰è£…è„šæœ¬</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
generate_deps_script() {
    local deps="$1"
    local os_type="${CONFIG["os_type"]}"
    local system_mirror="${CONFIG["system_mirror"]}"
    
    cat &gt; "$BUILD_SCRIPTS_DIR/install_deps.sh" &lt;&lt; 'SCRIPT_HEADER'
<span class="hljs-meta prompt_">#</span><span class="bash">!/bin/bash</span>
set -e
<span class="hljs-meta prompt_">
# </span><span class="bash">é¢œè‰²å®šä¹‰</span>
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

log_info() { echo -e "${GREEN}[INFO]${NC} $1"; }
log_warn() { echo -e "${YELLOW}[WARN]${NC} $1"; }
log_error() { echo -e "${RED}[ERROR]${NC} $1"; exit 1; }

log_info "å¼€å§‹å®‰è£…ç³»ç»Ÿä¾èµ–..."

SCRIPT_HEADER

    if [ "$os_type" = "alpine" ]; then
        # ç”Ÿæˆ Alpine é•œåƒæºåˆ‡æ¢è„šæœ¬
        if [ "$system_mirror" != "default" ]; then
            cat &gt;&gt; "$BUILD_SCRIPTS_DIR/install_deps.sh" &lt;&lt; SCRIPT_ALPINE_MIRROR
<span class="hljs-meta prompt_"># </span><span class="bash">åˆ‡æ¢ Alpine é•œåƒæº</span>
log_info "åˆ‡æ¢ Alpine é•œåƒæºåˆ°: $system_mirror"
SCRIPT_ALPINE_MIRROR
            case "$system_mirror" in
                aliyun)
                    cat &gt;&gt; "$BUILD_SCRIPTS_DIR/install_deps.sh" &lt;&lt; 'SCRIPT_ALPINE_ALIYUN'
sed -i 's/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g' /etc/apk/repositories
SCRIPT_ALPINE_ALIYUN
                    ;;
                ustc)
                    cat &gt;&gt; "$BUILD_SCRIPTS_DIR/install_deps.sh" &lt;&lt; 'SCRIPT_ALPINE_USTC'
sed -i 's/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g' /etc/apk/repositories
SCRIPT_ALPINE_USTC
                    ;;
                tsinghua)
                    cat &gt;&gt; "$BUILD_SCRIPTS_DIR/install_deps.sh" &lt;&lt; 'SCRIPT_ALPINE_TSINGHUA'
sed -i 's/dl-cdn.alpinelinux.org/mirrors.tuna.tsinghua.edu.cn/g' /etc/apk/repositories
SCRIPT_ALPINE_TSINGHUA
                    ;;
                163)
                    cat &gt;&gt; "$BUILD_SCRIPTS_DIR/install_deps.sh" &lt;&lt; 'SCRIPT_ALPINE_163'
sed -i 's/dl-cdn.alpinelinux.org/mirrors.163.com/g' /etc/apk/repositories
SCRIPT_ALPINE_163
                    ;;
            esac
        fi
        
        cat &gt;&gt; "$BUILD_SCRIPTS_DIR/install_deps.sh" &lt;&lt; SCRIPT_ALPINE
<span class="hljs-meta prompt_"># </span><span class="bash">Alpine ç³»ç»Ÿä¾èµ–</span>
apk update
apk add --no-cache --virtual .build-deps \\
    \$PHPIZE_DEPS \\
    autoconf \\
    automake \\
    libtool \\
    make \\
    gcc \\
    g++ \\
    linux-headers
<span class="hljs-meta prompt_">
# </span><span class="bash">å®‰è£…è¿è¡Œæ—¶ä¾èµ–</span>
apk add --no-cache \\
    $deps

log_info "Alpine ç³»ç»Ÿä¾èµ–å®‰è£…å®Œæˆ"
SCRIPT_ALPINE
    else
        # ç”Ÿæˆ Debian é•œåƒæºåˆ‡æ¢è„šæœ¬
        if [ "$system_mirror" != "default" ]; then
            cat &gt;&gt; "$BUILD_SCRIPTS_DIR/install_deps.sh" &lt;&lt; SCRIPT_DEBIAN_MIRROR
<span class="hljs-meta prompt_"># </span><span class="bash">åˆ‡æ¢ Debian é•œåƒæº</span>
log_info "åˆ‡æ¢ Debian/Ubuntu é•œåƒæºåˆ°: $system_mirror"
<span class="hljs-meta prompt_">
# </span><span class="bash">å¤‡ä»½åŸå§‹æº</span>
cp /etc/apt/sources.list /etc/apt/sources.list.bak 2&gt;/dev/null || true
<span class="hljs-meta prompt_">
# </span><span class="bash">æ£€æµ‹ Debian ç‰ˆæœ¬</span>
DEBIAN_VERSION=\$(cat /etc/os-release | grep VERSION_CODENAME | cut -d= -f2)
if [ -z "\$DEBIAN_VERSION" ]; then
    DEBIAN_VERSION="bullseye"
fi

log_info "æ£€æµ‹åˆ° Debian ç‰ˆæœ¬: \$DEBIAN_VERSION"

SCRIPT_DEBIAN_MIRROR
            case "$system_mirror" in
                aliyun)
                    cat &gt;&gt; "$BUILD_SCRIPTS_DIR/install_deps.sh" &lt;&lt; 'SCRIPT_DEBIAN_ALIYUN'
cat &gt; /etc/apt/sources.list &lt;&lt; EOF
deb https://mirrors.aliyun.com/debian/ $DEBIAN_VERSION main contrib non-free
deb https://mirrors.aliyun.com/debian/ $DEBIAN_VERSION-updates main contrib non-free
deb https://mirrors.aliyun.com/debian-security $DEBIAN_VERSION-security main contrib non-free
EOF
SCRIPT_DEBIAN_ALIYUN
                    ;;
                ustc)
                    cat &gt;&gt; "$BUILD_SCRIPTS_DIR/install_deps.sh" &lt;&lt; 'SCRIPT_DEBIAN_USTC'
cat &gt; /etc/apt/sources.list &lt;&lt; EOF
deb https://mirrors.ustc.edu.cn/debian/ $DEBIAN_VERSION main contrib non-free
deb https://mirrors.ustc.edu.cn/debian/ $DEBIAN_VERSION-updates main contrib non-free
deb https://mirrors.ustc.edu.cn/debian-security $DEBIAN_VERSION-security main contrib non-free
EOF
SCRIPT_DEBIAN_USTC
                    ;;
                tsinghua)
                    cat &gt;&gt; "$BUILD_SCRIPTS_DIR/install_deps.sh" &lt;&lt; 'SCRIPT_DEBIAN_TSINGHUA'
cat &gt; /etc/apt/sources.list &lt;&lt; EOF
deb https://mirrors.tuna.tsinghua.edu.cn/debian/ $DEBIAN_VERSION main contrib non-free
deb https://mirrors.tuna.tsinghua.edu.cn/debian/ $DEBIAN_VERSION-updates main contrib non-free
deb https://mirrors.tuna.tsinghua.edu.cn/debian-security $DEBIAN_VERSION-security main contrib non-free
EOF
SCRIPT_DEBIAN_TSINGHUA
                    ;;
                163)
                    cat &gt;&gt; "$BUILD_SCRIPTS_DIR/install_deps.sh" &lt;&lt; 'SCRIPT_DEBIAN_163'
cat &gt; /etc/apt/sources.list &lt;&lt; EOF
deb http://mirrors.163.com/debian/ $DEBIAN_VERSION main contrib non-free
deb http://mirrors.163.com/debian/ $DEBIAN_VERSION-updates main contrib non-free
deb http://mirrors.163.com/debian-security $DEBIAN_VERSION-security main contrib non-free
EOF
SCRIPT_DEBIAN_163
                    ;;
            esac
        fi
        
        cat &gt;&gt; "$BUILD_SCRIPTS_DIR/install_deps.sh" &lt;&lt; SCRIPT_DEBIAN
<span class="hljs-meta prompt_"># </span><span class="bash">Debian ç³»ç»Ÿä¾èµ–</span>
apt-get update
apt-get install -y --no-install-recommends \\
    \$PHPIZE_DEPS \\
    autoconf \\
    automake \\
    libtool \\
    make \\
    gcc \\
    g++ \\
    $deps

log_info "Debian ç³»ç»Ÿä¾èµ–å®‰è£…å®Œæˆ"
SCRIPT_DEBIAN
    fi
    
    chmod +x "$BUILD_SCRIPTS_DIR/install_deps.sh"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">ç”Ÿæˆæ‰©å±•å®‰è£…è„šæœ¬</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
generate_extensions_script() {
    local core_exts="$1"
    local pecl_exts="$2"
    local local_exts="$3"
    local configure_cmds="$4"
    local pre_install_cmds="$5"
    
    cat &gt; "$BUILD_SCRIPTS_DIR/install_extensions.sh" &lt;&lt; 'SCRIPT_HEADER'
<span class="hljs-meta prompt_">#</span><span class="bash">!/bin/bash</span>
set -e
<span class="hljs-meta prompt_">
# </span><span class="bash">é¢œè‰²å®šä¹‰</span>
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
CYAN='\033[0;36m'
NC='\033[0m'

log_info() { echo -e "${GREEN}[INFO]${NC} $1"; }
log_warn() { echo -e "${YELLOW}[WARN]${NC} $1"; }
log_error() { echo -e "${RED}[ERROR]${NC} $1"; exit 1; }
log_step() { echo -e "${CYAN}[STEP]${NC} $1"; }
<span class="hljs-meta prompt_">
# </span><span class="bash">PECL æ‰©å±•å®‰è£…å‡½æ•°</span>
install_pecl_extension() {
    local ext_name="$1"
    local configure_opts="$2"
    
    log_step "å®‰è£… PECL æ‰©å±•: $ext_name"
    
    if [ -n "$configure_opts" ]; then
        printf "\n" | pecl install $ext_name &lt;&lt;&lt; "$configure_opts" || {
            log_warn "å¸¦é…ç½®å®‰è£…å¤±è´¥ï¼Œå°è¯•é»˜è®¤å®‰è£…..."
            printf "\n" | pecl install $ext_name
        }
    else
        printf "\n" | pecl install $ext_name || log_error "å®‰è£… $ext_name å¤±è´¥"
    fi
    
    # è·å–çº¯æ‰©å±•åï¼ˆå»é™¤ç‰ˆæœ¬å·ï¼‰
    local pure_name="${ext_name%%-*}"
    docker-php-ext-enable $pure_name || log_error "å¯ç”¨ $pure_name å¤±è´¥"
    
    log_info "PECL æ‰©å±• $ext_name å®‰è£…æˆåŠŸ"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">æœ¬åœ°æ‰©å±•å®‰è£…å‡½æ•°</span>
install_local_extension() {
    local ext_name="$1"
    local ext_file="$2"
    
    log_step "ä»æœ¬åœ°å®‰è£…æ‰©å±•: $ext_name"
    
    local ext_dir="/tmp/ext_$ext_name"
    mkdir -p "$ext_dir"
    
    case "$ext_file" in
        *.tgz|*.tar.gz)
            tar -xzf "$ext_file" -C "$ext_dir" --strip-components=1
            ;;
        *.zip)
            unzip -q "$ext_file" -d "$ext_dir"
            ;;
        *)
            log_error "ä¸æ”¯æŒçš„æ‰©å±•æ ¼å¼: $ext_file"
            ;;
    esac
    
    cd "$ext_dir"
    phpize
    ./configure
    make -j$(nproc)
    make install
    docker-php-ext-enable $ext_name
    
    rm -rf "$ext_dir"
    log_info "æœ¬åœ°æ‰©å±• $ext_name å®‰è£…æˆåŠŸ"
}

log_info "å¼€å§‹å®‰è£… PHP æ‰©å±•..."

SCRIPT_HEADER

    # æ·»åŠ é¢„å®‰è£…å‘½ä»¤
    if [ -n "$pre_install_cmds" ]; then
        echo -e "\n# é¢„å®‰è£…å‘½ä»¤" &gt;&gt; "$BUILD_SCRIPTS_DIR/install_extensions.sh"
        echo -e "$pre_install_cmds" &gt;&gt; "$BUILD_SCRIPTS_DIR/install_extensions.sh"
    fi
    
    # æ·»åŠ é…ç½®å‘½ä»¤
    if [ -n "$configure_cmds" ]; then
        echo -e "\n# æ‰©å±•é…ç½®å‘½ä»¤" &gt;&gt; "$BUILD_SCRIPTS_DIR/install_extensions.sh"
        echo -e "$configure_cmds" &gt;&gt; "$BUILD_SCRIPTS_DIR/install_extensions.sh"
    fi
    
    # æ·»åŠ æ ¸å¿ƒæ‰©å±•å®‰è£…
    if [ -n "$core_exts" ]; then
        cat &gt;&gt; "$BUILD_SCRIPTS_DIR/install_extensions.sh" &lt;&lt; SCRIPT_CORE
<span class="hljs-meta prompt_">
# </span><span class="bash">å®‰è£…æ ¸å¿ƒæ‰©å±•</span>
log_step "å®‰è£…æ ¸å¿ƒæ‰©å±•:$core_exts"
docker-php-ext-install -j\$(nproc)$core_exts || log_error "æ ¸å¿ƒæ‰©å±•å®‰è£…å¤±è´¥"
log_info "æ ¸å¿ƒæ‰©å±•å®‰è£…æˆåŠŸ"
SCRIPT_CORE
    fi
    
    # æ·»åŠ  PECL æ‰©å±•å®‰è£…
    if [ -n "$pecl_exts" ]; then
        echo -e "\n# å®‰è£… PECL æ‰©å±•" &gt;&gt; "$BUILD_SCRIPTS_DIR/install_extensions.sh"
        echo -e "$pecl_exts" &gt;&gt; "$BUILD_SCRIPTS_DIR/install_extensions.sh"
    fi
    
    # æ·»åŠ æœ¬åœ°æ‰©å±•å®‰è£…
    if [ -n "$local_exts" ]; then
        echo -e "\n# å®‰è£…æœ¬åœ°æ‰©å±•" &gt;&gt; "$BUILD_SCRIPTS_DIR/install_extensions.sh"
        echo -e "$local_exts" &gt;&gt; "$BUILD_SCRIPTS_DIR/install_extensions.sh"
    fi
    
    echo -e '\nlog_info "æ‰€æœ‰ PHP æ‰©å±•å®‰è£…å®Œæˆ"' &gt;&gt; "$BUILD_SCRIPTS_DIR/install_extensions.sh"
    
    chmod +x "$BUILD_SCRIPTS_DIR/install_extensions.sh"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">ç”Ÿæˆåç½®å®‰è£…è„šæœ¬</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
generate_post_install_script() {
    local post_cmds="$1"
    
    cat &gt; "$BUILD_SCRIPTS_DIR/post_install.sh" &lt;&lt; 'SCRIPT_HEADER'
<span class="hljs-meta prompt_">#</span><span class="bash">!/bin/bash</span>
set -e

log_info() { echo -e "\033[0;32m[INFO]\033[0m $1"; }

log_info "æ‰§è¡Œåç½®å®‰è£…è„šæœ¬..."

SCRIPT_HEADER

    if [ -n "$post_cmds" ]; then
        echo -e "$post_cmds" &gt;&gt; "$BUILD_SCRIPTS_DIR/post_install.sh"
    fi
    
    echo -e '\nlog_info "åç½®å®‰è£…è„šæœ¬æ‰§è¡Œå®Œæˆ"' &gt;&gt; "$BUILD_SCRIPTS_DIR/post_install.sh"
    
    chmod +x "$BUILD_SCRIPTS_DIR/post_install.sh"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">ç”Ÿæˆ Composer å®‰è£…è„šæœ¬</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
generate_composer_script() {
    local mirror="${CONFIG["composer_mirror"]}"
    
    cat &gt; "$BUILD_SCRIPTS_DIR/install_composer.sh" &lt;&lt; 'SCRIPT_HEADER'
<span class="hljs-meta prompt_">#</span><span class="bash">!/bin/bash</span>
set -e

log_info() { echo -e "\033[0;32m[INFO]\033[0m $1"; }
log_error() { echo -e "\033[0;31m[ERROR]\033[0m $1"; exit 1; }

MIRROR="$1"

log_info "å®‰è£… Composer..."
<span class="hljs-meta prompt_">
# </span><span class="bash">ä¸‹è½½å¹¶å®‰è£… Composer</span>
EXPECTED_CHECKSUM="$(php -r 'copy("https://composer.github.io/installer.sig", "php://stdout");')"
php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
ACTUAL_CHECKSUM="$(php -r "echo hash_file('sha384', 'composer-setup.php');")"

if [ "$EXPECTED_CHECKSUM" != "$ACTUAL_CHECKSUM" ]; then
    rm composer-setup.php
    log_error 'Composer installer æ ¡éªŒå¤±è´¥'
fi

php composer-setup.php --install-dir=/usr/local/bin --filename=composer
rm composer-setup.php
<span class="hljs-meta prompt_">
# </span><span class="bash">é…ç½®é•œåƒæº</span>
configure_mirror() {
    case "$MIRROR" in
        aliyun)
            composer config -g repo.packagist composer https://mirrors.aliyun.com/composer/
            ;;
        tencent)
            composer config -g repo.packagist composer https://mirrors.cloud.tencent.com/composer/
            ;;
        ustc)
            composer config -g repo.packagist composer https://mirrors.ustc.edu.cn/composer/
            ;;
        huaweicloud)
            composer config -g repo.packagist composer https://repo.huaweicloud.com/repository/php/
            ;;
        packagist)
            composer config -g repo.packagist composer https://packagist.org
            ;;
        auto)
            # è‡ªåŠ¨æ£€æµ‹æœ€å¿«çš„æº
            log_info "è‡ªåŠ¨æ£€æµ‹æœ€å¿«çš„ Composer æº..."
            MIRRORS=(
                "https://mirrors.aliyun.com/composer/"
                "https://mirrors.cloud.tencent.com/composer/"
                "https://packagist.org"
            )
            FASTEST=""
            FASTEST_TIME=999
            for m in "${MIRRORS[@]}"; do
                TIME=$(curl -o /dev/null -s -w '%{time_total}' --connect-timeout 3 "$m" 2&gt;/dev/null || echo "999")
                if (( $(echo "$TIME &lt; $FASTEST_TIME" | bc -l 2&gt;/dev/null || echo 0) )); then
                    FASTEST_TIME=$TIME
                    FASTEST=$m
                fi
            done
            if [ -n "$FASTEST" ]; then
                composer config -g repo.packagist composer "$FASTEST"
                log_info "ä½¿ç”¨æœ€å¿«æº: $FASTEST"
            fi
            ;;
    esac
}

configure_mirror

log_info "Composer å®‰è£…å®Œæˆ"
composer --version
SCRIPT_HEADER

    chmod +x "$BUILD_SCRIPTS_DIR/install_composer.sh"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">ç”Ÿæˆ PHP é…ç½®æ–‡ä»¶</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
generate_php_ini() {
    local ini_file="$BUILD_SCRIPTS_DIR/php.ini"
    
    echo "; PHP Custom Configuration" &gt; "$ini_file"
    echo "; Generated by build.sh at $(date)" &gt;&gt; "$ini_file"
    echo "" &gt;&gt; "$ini_file"
    
    for key in "${!PHP_CONFIG[@]}"; do
        echo "$key=${PHP_CONFIG[$key]}" &gt;&gt; "$ini_file"
    done
    
    log_debug "PHP é…ç½®æ–‡ä»¶ç”Ÿæˆå®Œæˆ"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">ç”Ÿæˆç¯å¢ƒå˜é‡æ–‡ä»¶</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
generate_env_file() {
    local env_file="$BUILD_SCRIPTS_DIR/env.sh"
    
    echo "# Environment Variables" &gt; "$env_file"
    echo "# Generated by build.sh at $(date)" &gt;&gt; "$env_file"
    echo "" &gt;&gt; "$env_file"
    
    for key in "${!ENV_VARS[@]}"; do
        echo "export $key=\"${ENV_VARS[$key]}\"" &gt;&gt; "$env_file"
    done
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">ç”Ÿæˆå…¥å£ç‚¹è„šæœ¬</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
generate_entrypoint_script() {
    local cmd="${CONFIG["cmd"]}"
    
    cat &gt; "$BUILD_SCRIPTS_DIR/entrypoint.sh" &lt;&lt; 'SCRIPT_HEADER'
<span class="hljs-meta prompt_">#</span><span class="bash">!/bin/bash</span>
set -e
<span class="hljs-meta prompt_">
# </span><span class="bash">åŠ è½½ç¯å¢ƒå˜é‡</span>
if [ -f /etc/profile ]; then
    source /etc/profile
fi
<span class="hljs-meta prompt_">
# </span><span class="bash">å¦‚æœä¼ å…¥äº†å‘½ä»¤ï¼Œæ‰§è¡Œä¼ å…¥çš„å‘½ä»¤</span>
if [ $# -gt 0 ]; then
    exec "$@"
fi

SCRIPT_HEADER

    # æ·»åŠ é»˜è®¤å‘½ä»¤
    if [ -n "$cmd" ]; then
        echo "# é»˜è®¤å‘½ä»¤" &gt;&gt; "$BUILD_SCRIPTS_DIR/entrypoint.sh"
        echo "exec $cmd" &gt;&gt; "$BUILD_SCRIPTS_DIR/entrypoint.sh"
    else
        echo "# æ— é»˜è®¤å‘½ä»¤ï¼Œä¿æŒå®¹å™¨è¿è¡Œ" &gt;&gt; "$BUILD_SCRIPTS_DIR/entrypoint.sh"
        echo 'exec tail -f /dev/null' &gt;&gt; "$BUILD_SCRIPTS_DIR/entrypoint.sh"
    fi
    
    chmod +x "$BUILD_SCRIPTS_DIR/entrypoint.sh"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">éªŒè¯é…ç½®</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
validate_config() {
    log_step "éªŒè¯é…ç½®"
    
    local errors=0
    
    # éªŒè¯åŸºç¡€é•œåƒ
    if [ -z "${CONFIG["base_image"]}" ]; then
        log_error "æœªé…ç½®åŸºç¡€é•œåƒ"
        errors=$((errors + 1))
    fi
    
    # éªŒè¯æ‰©å±•æ•°é‡
    if [ ${#EXTENSIONS[@]} -eq 0 ]; then
        log_warn "æœªé…ç½®ä»»ä½•æ‰©å±•"
    fi
    
    # éªŒè¯å·¥ä½œç›®å½•
    if [ -z "${CONFIG["workdir"]}" ]; then
        log_warn "æœªé…ç½®å·¥ä½œç›®å½•ï¼Œä½¿ç”¨é»˜è®¤å€¼: $DEFAULT_WORKDIR"
        CONFIG["workdir"]="$DEFAULT_WORKDIR"
    fi
    
    if [ $errors -gt 0 ]; then
        log_error "é…ç½®éªŒè¯å¤±è´¥ï¼Œå‘ç° $errors ä¸ªé”™è¯¯"
        exit 1
    fi
    
    log_success "é…ç½®éªŒè¯é€šè¿‡"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">Docker æ„å»º</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
build_docker_image() {
    local image_tag="$1"
    
    log_step "å¼€å§‹æ„å»º Docker é•œåƒ: $image_tag"
    
    # å‡†å¤‡æ„å»ºå‚æ•°
    local build_args=""
    build_args="$build_args --build-arg BASE_IMAGE=${CONFIG["base_image"]}"
    build_args="$build_args --build-arg WORKDIR=${CONFIG["workdir"]}"
    build_args="$build_args --build-arg BUILD_MODE=${CONFIG["mode"]}"
    build_args="$build_args --build-arg COMPOSER_MIRROR=${CONFIG["composer_mirror"]}"

    # ä¼ é€’é¢å¤–åŒ…å‚æ•°
    if [ -n "${CONFIG["extra_packages"]}" ]; then
        build_args="$build_args --build-arg EXTRA_PACKAGES=\"${CONFIG["extra_packages"]}\""
    fi
    
    # å†…å­˜é™åˆ¶ï¼ˆé˜²æ­¢ OOMï¼‰
    local memory_limit="${BUILD_ARGS["memory_limit"]:-2048}"
    if [ "$memory_limit" != "0" ]; then
        build_args="$build_args --memory=${memory_limit}m"
    fi
    
    # å¹¶è¡Œç¼–è¯‘æ•°
    local parallel_jobs="${BUILD_ARGS["parallel_jobs"]:-0}"
    if [ "$parallel_jobs" = "0" ]; then
        parallel_jobs=$(nproc)
    fi
    build_args="$build_args --build-arg PARALLEL_JOBS=$parallel_jobs"
    
    # ç¼“å­˜è®¾ç½®
    local enable_cache="${BUILD_ARGS["enable_cache"]:-true}"
    if [ "$enable_cache" != "true" ]; then
        build_args="$build_args --no-cache"
    fi
    
    # å¤åˆ¶æœ¬åœ°æ‰©å±•åˆ°æ„å»ºä¸Šä¸‹æ–‡
    if [ -d "$EXTENSION_DIR" ] &amp;&amp; [ "$(ls -A "$EXTENSION_DIR" 2&gt;/dev/null)" ]; then
        mkdir -p "$BUILD_SCRIPTS_DIR/extensions"
        cp -r "$EXTENSION_DIR"/* "$BUILD_SCRIPTS_DIR/extensions/" 2&gt;/dev/null || true
    fi
    
    log_info "æ„å»ºå‚æ•°: $build_args"
    
    # æ‰§è¡Œæ„å»º
    start_spinner "æ­£åœ¨æ„å»º Docker é•œåƒ..."

    # ä¿®æ”¹åˆ¤æ–­é€»è¾‘ï¼Œç¡®ä¿æŠ¥é”™ç«‹å³é€€å‡ºï¼Œä¸æ‰“å°æˆåŠŸä¿¡æ¯
    if docker build $build_args -t "$image_tag" -f "$SCRIPT_DIR/Dockerfile" "$SCRIPT_DIR" 2&gt;&amp;1 | tee -a "$LOG_FILE"; then
        stop_spinner "success" "Docker é•œåƒæ„å»ºæˆåŠŸ"
        log_success "é•œåƒæ„å»ºå®Œæˆ: $image_tag"
    else
        # åªè¦ docker build å¤±è´¥ï¼Œè¿›å…¥è¿™é‡Œ
        stop_spinner "fail" "Docker é•œåƒæ„å»ºå¤±è´¥"
        log_error "æ„å»ºè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œè¯·æŸ¥çœ‹ä¸Šæ–¹æ—¥å¿—æˆ–æ£€æŸ¥: $LOG_FILE"
        exit 1  # å¼ºåˆ¶é€€å‡ºï¼Œä¸æ‰§è¡Œåç»­é€»è¾‘
    fi
    
    # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
    if [ "${BUILD_ARGS["clean_cache"]}" = "true" ]; then
        log_info "æ¸…ç†æ„å»ºç¼“å­˜..."
        rm -rf "$BUILD_SCRIPTS_DIR/extensions" 2&gt;/dev/null || true
    fi
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
show_help() {
    cat &lt;&lt; EOF
<span class="hljs-meta prompt_">$</span><span class="bash">{CYAN}<span class="hljs-variable">${BOLD}</span>PHP Hyperf Docker æ„å»ºå·¥å…·<span class="hljs-variable">${NC}</span></span>
<span class="hljs-meta prompt_">
$</span><span class="bash">{YELLOW}ç”¨æ³•:<span class="hljs-variable">${NC}</span></span>
    ./build.sh &lt;é•œåƒåç§°:æ ‡ç­¾&gt;
    ./build.sh [é€‰é¡¹]
<span class="hljs-meta prompt_">
$</span><span class="bash">{YELLOW}é€‰é¡¹:<span class="hljs-variable">${NC}</span></span>
    -h, --help          æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
    -v, --version       æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯
    -d, --debug         å¯ç”¨è°ƒè¯•æ¨¡å¼
    --dry-run           ä»…è§£æé…ç½®ï¼Œä¸æ‰§è¡Œæ„å»º
    --validate          ä»…éªŒè¯é…ç½®
<span class="hljs-meta prompt_">
$</span><span class="bash">{YELLOW}ç¤ºä¾‹:<span class="hljs-variable">${NC}</span></span>
    ./build.sh myapp:latest
    ./build.sh myapp:v1.0.0
    ./build.sh --debug myapp:dev
<span class="hljs-meta prompt_">
$</span><span class="bash">{YELLOW}é…ç½®æ–‡ä»¶:<span class="hljs-variable">${NC}</span></span>
    config/build.conf           ä¸»é…ç½®æ–‡ä»¶
    config/extension_deps.conf  æ‰©å±•ä¾èµ–é…ç½®
    config/extension_special.conf æ‰©å±•ç‰¹æ®Šé…ç½®
<span class="hljs-meta prompt_">
$</span><span class="bash">{YELLOW}æœ¬åœ°æ‰©å±•:<span class="hljs-variable">${NC}</span></span>
    å°†æ‰©å±•æ–‡ä»¶æ”¾å…¥ extension/ ç›®å½•
    æ”¯æŒæ ¼å¼: .tgz, .tar.gz, .zip
    å‘½åæ ¼å¼: æ‰©å±•å-ç‰ˆæœ¬å·.tgz (å¦‚: swoole-4.8.13.tgz)
<span class="hljs-meta prompt_">
$</span><span class="bash">{YELLOW}æ—¥å¿—æ–‡ä»¶:<span class="hljs-variable">${NC}</span></span>
    logs/build_YYYYMMDD_HHMMSS.log

EOF
}
<span class="hljs-meta prompt_">
# </span><span class="bash">========================================</span>
<span class="hljs-meta prompt_"># </span><span class="bash">ä¸»å‡½æ•°</span>
<span class="hljs-meta prompt_"># </span><span class="bash">========================================</span>
main() {
    # åˆ›å»ºæ—¥å¿—ç›®å½•
    mkdir -p "$LOGS_DIR"
    
    # å‚æ•°è§£æ
    local image_tag=""
    local dry_run=false
    local validate_only=false
    
    while [[ $# -gt 0 ]]; do
        case "$1" in
            -h|--help)
                show_help
                exit 0
                ;;
            -v|--version)
                echo "PHP Hyperf Docker Builder v1.0.0"
                exit 0
                ;;
            -d|--debug)
                DEBUG=true
                shift
                ;;
            --dry-run)
                dry_run=true
                shift
                ;;
            --validate)
                validate_only=true
                shift
                ;;
            -*)
                log_error "æœªçŸ¥é€‰é¡¹: $1"
                show_help
                exit 1
                ;;
            *)
                image_tag="$1"
                shift
                ;;
        esac
    done
    
    # æ£€æŸ¥é•œåƒæ ‡ç­¾
    if [ -z "$image_tag" ] &amp;&amp; [ "$validate_only" != true ]; then
        log_error "è¯·æŒ‡å®šé•œåƒåç§°å’Œæ ‡ç­¾"
        echo ""
        show_help
        exit 1
    fi
    
    echo ""
    echo -e "${CYAN}${BOLD}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
    echo -e "${CYAN}${BOLD}â•‘         PHP Hyperf Docker æ„å»ºå·¥å…· v1.0.0                  â•‘${NC}"
    echo -e "${CYAN}${BOLD}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
    echo ""
    
    log_info "æ—¥å¿—æ–‡ä»¶: $LOG_FILE"
    
    # è§£æé…ç½®
    parse_config
    detect_image_type
    parse_extension_deps
    parse_extension_special
    check_local_extensions
    
    # éªŒè¯é…ç½®
    validate_config
    
    if [ "$validate_only" = true ]; then
        log_success "é…ç½®éªŒè¯å®Œæˆ"
        exit 0
    fi
    
    # ç”Ÿæˆå®‰è£…è„šæœ¬
    generate_install_scripts
    
    if [ "$dry_run" = true ]; then
        log_success "Dry run å®Œæˆï¼Œè„šæœ¬å·²ç”Ÿæˆåˆ°: $BUILD_SCRIPTS_DIR"
        exit 0
    fi
    
    # æ„å»º Docker é•œåƒ
    #build_docker_image "$image_tag"
    build_docker_image "$image_tag" || {
        echo -e "${RED}æ„å»ºå¤±è´¥ï¼Œè¯·æ£€æŸ¥ä¸Šæ–¹æ—¥å¿—${NC}"
        exit 1
    }
    
    echo ""
    log_success "æ„å»ºå®Œæˆï¼"
    echo ""
    echo -e "${GREEN}è¿è¡Œå®¹å™¨:${NC}"
    echo -e "  docker run -d --name hyperf -p 9501:9501 $image_tag"
    echo ""
    echo -e "${GREEN}æŸ¥çœ‹æ—¥å¿—:${NC}"
    echo -e "  docker logs -f hyperf"
    echo ""
}
<span class="hljs-meta prompt_">
# </span><span class="bash">æ‰§è¡Œä¸»å‡½æ•°</span>
main "$@"

</code></pre>
<h5 data-id="heading-9">Dockerfile</h5>
<pre><code class="hljs language-dockerfile" lang="dockerfile"># ========================================
# PHP Hyperf Docker æ„å»ºæ–‡ä»¶
# æ‰€æœ‰å‚æ•°é€šè¿‡ ARG ä¼ å…¥ï¼Œä¸ç›´æ¥ä¿®æ”¹æ­¤æ–‡ä»¶
# ========================================

# åŸºç¡€é•œåƒå‚æ•°
ARG BASE_IMAGE=php:8.2-cli
FROM ${BASE_IMAGE}

# æ„å»ºå‚æ•°
ARG WORKDIR=/opt/www
ARG BUILD_MODE=prod
ARG PARALLEL_JOBS=4
ARG COMPOSER_MIRROR=auto
ARG TIMEZONE=Asia/Shanghai

# ç¯å¢ƒå˜é‡
ARG ENV_VARS=""
ARG PHP_INI_CONFIG=""
ARG EXTRA_PACKAGES=""
ARG CMD_COMMAND=""

# æ‰©å±•å®‰è£…è„šæœ¬ï¼ˆç”± build.sh ç”Ÿæˆï¼‰
ARG INSTALL_DEPS_SCRIPT=""
ARG INSTALL_EXTENSIONS_SCRIPT=""
ARG POST_INSTALL_SCRIPT=""

# æ ‡ç­¾
LABEL maintainer="PHP Hyperf Builder"
LABEL description="PHP Hyperf Application Container"
LABEL build.mode="${BUILD_MODE}"

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR ${WORKDIR}

# è®¾ç½®æ—¶åŒº
ENV TZ=${TIMEZONE}

# æ£€æµ‹ç³»ç»Ÿç±»å‹å¹¶å®‰è£…åŸºç¡€ä¾èµ–
RUN set -eux; \
    # æ£€æµ‹æ˜¯å¦ä¸º Alpine
    if [ -f /etc/alpine-release ]; then \
        echo "Detected Alpine Linux"; \
        apk update; \
        apk add --no-cache \
            bash \
            curl \
            wget \
            git \
            unzip \
            tzdata \
            $EXTRA_PACKAGES; \
        cp /usr/share/zoneinfo/${TIMEZONE} /etc/localtime; \
        echo "${TIMEZONE}" &gt; /etc/timezone; \
    else \
        echo "Detected Debian/Ubuntu"; \
        apt-get update; \
        apt-get install -y --no-install-recommends \
            bash \
            curl \
            wget \
            git \
            unzip \
            ca-certificates \
            $EXTRA_PACKAGES; \
        ln -snf /usr/share/zoneinfo/${TIMEZONE} /etc/localtime; \
        echo "${TIMEZONE}" &gt; /etc/timezone; \
    fi

# å¤åˆ¶ä¾èµ–å®‰è£…è„šæœ¬
COPY build_scripts/install_deps.sh /tmp/install_deps.sh
COPY build_scripts/install_extensions.sh /tmp/install_extensions.sh
COPY build_scripts/post_install.sh /tmp/post_install.sh
COPY build_scripts/install_composer.sh /tmp/install_composer.sh

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN chmod +x /tmp/install_deps.sh &amp;&amp; /tmp/install_deps.sh

# å®‰è£… PHP æ‰©å±•
RUN chmod +x /tmp/install_extensions.sh &amp;&amp; /tmp/install_extensions.sh

# å®‰è£… Composer
RUN chmod +x /tmp/install_composer.sh &amp;&amp; /tmp/install_composer.sh ${COMPOSER_MIRROR}

# æ‰§è¡Œåç½®å®‰è£…è„šæœ¬
RUN chmod +x /tmp/post_install.sh &amp;&amp; /tmp/post_install.sh

# å¤åˆ¶ PHP é…ç½®
COPY build_scripts/php.ini /usr/local/etc/php/conf.d/99-custom.ini

# æ¸…ç†
RUN set -eux; \
    rm -rf /tmp/*; \
    if [ -f /etc/alpine-release ]; then \
        rm -rf /var/cache/apk/*; \
    else \
        apt-get clean; \
        rm -rf /var/lib/apt/lists/*; \
    fi; \
    # ç”Ÿäº§æ¨¡å¼é¢å¤–æ¸…ç†
    if [ "${BUILD_MODE}" = "prod" ]; then \
        rm -rf /usr/src/php*; \
        rm -rf /usr/local/include/php; \
    fi

# è®¾ç½®ç¯å¢ƒå˜é‡
COPY build_scripts/env.sh /tmp/env.sh
RUN if [ -f /tmp/env.sh ]; then cat /tmp/env.sh &gt;&gt; /etc/profile; fi

# æš´éœ²ç«¯å£
#EXPOSE 9501

# è®¾ç½®å·¥ä½œç›®å½•æƒé™
RUN mkdir -p ${WORKDIR} &amp;&amp; chmod -R 755 ${WORKDIR}

# å¥åº·æ£€æŸ¥
#HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
#    CMD curl -f http://localhost:9501/health || exit 1

# å…¥å£ç‚¹ï¼ˆå¯è¢«è¦†ç›–ï¼‰
#COPY build_scripts/entrypoint.sh /usr/local/bin/entrypoint.sh
#RUN chmod +x /usr/local/bin/entrypoint.sh
#ENTRYPOINT ["/usr/local/bin/entrypoint.sh"]

# CMD å‘½ä»¤ï¼ˆå¦‚æœé…ç½®äº†ï¼‰
# è¿™è¡Œä¼šè¢« build.sh åŠ¨æ€æ·»åŠ 

</code></pre>
<h4 data-id="heading-10">æ‰§è¡Œæ„å»º</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">è¿›å…¥é¡¹ç›®ç›®å½•</span>
cd project
<span class="hljs-meta prompt_">
# </span><span class="bash">æ·»åŠ æ–‡ä»¶æ‰§è¡Œæƒé™</span>
chmod +x ./build.sh
<span class="hljs-meta prompt_">
# </span><span class="bash">æ‰§è¡Œæ„å»º</span>
./build.sh æ–°çš„é•œåƒåç§°
</code></pre>
<h4 data-id="heading-11">ç»“è¯­</h4>
<p>è¯¥ä»½å¥—é¤å¯ä»¥åšåˆ°ï¼š</p>
<ul>
<li>æ„å»ºé€»è¾‘é€šç”¨ï¼šä¸åŒç‰ˆæœ¬ã€ä¸åŒæ‰©å±•çš„æ„å»ºåªéœ€è¦ä¿®æ”¹ build.conf é…ç½®æ–‡ä»¶</li>
<li>æ‰©å±•è‡ªç”±åº¦é«˜ï¼šå¯è‡ªç”±å¢å‡æ‰©å±•ä¿¡æ¯ï¼Œå¯æŒ‡å®šç‰ˆæœ¬ï¼Œä¹Ÿå¯ä¸æŒ‡å®šï¼Œä¸æŒ‡å®šæ—¶å®‰è£…æœ€æ–°ç‰ˆæœ¬</li>
<li>æ„å»ºæ¨¡å¼åˆ‡æ¢ï¼šåˆ†ä¸º prod/devï¼Œprod æ„å»ºä¼šæ¸…æ¥šæ„å»ºç¼“å­˜ç­‰ä¿¡æ¯ï¼Œå‡å°‘é•œåƒä½“ç§¯ï¼›devæ¨¡å¼ä¸ä¼šï¼Œæ–¹ä¾¿å¤šæ¬¡æ„å»ºï¼Œå‡å°‘æ„å»ºæ—¶é—´</li>
<li>è‡ªå®šä¹‰ç³»ç»Ÿä¾èµ–æºï¼šè‡ªç”±é…ç½®æ˜¯å¦ä½¿ç”¨è‡ªå®šä¹‰ç³»ç»Ÿä¾èµ–æºï¼Œå‡å°‘æ„å»ºæˆåŠŸç‡å’Œæ„å»ºé€Ÿåº¦</li>
<li>è‡ªå®šä¹‰phpé…ç½®ï¼šä¸åŒçš„å¼€å‘éœ€æ±‚ï¼Œå¯èƒ½éœ€è¦ä¸é€šè¿‡çš„phpé…ç½®ï¼Œå¯ä»¥è‡ªç”±é…ç½®ï¼Œæ„å»ºåè¦†ç›–åŸæœ‰çš„é»˜è®¤é…ç½®</li>
<li>æ„å»ºç›®æ ‡è‡ªç”±ï¼šå¯è‡ªç”±é…ç½®æ„å»º åŸºç¡€é•œåƒ(base)ã€æœ€ç»ˆé•œåƒ(final)ã€åŸºç¡€+æœ€ç»ˆ(all)</li>
<li>ç³»ç»Ÿä¾èµ–è‡ªåŠ¨æ£€æµ‹ï¼šå¯æ ¹æ®é…ç½®çš„åŸºç¡€é•œåƒï¼Œè‡ªåŠ¨è¯†åˆ«é•œåƒç³»ç»Ÿï¼ˆdebian/alpineï¼‰ã€å¹¶å®‰è£…å¯¹åº”çš„ä¾èµ–ï¼Œå¦‚ï¼šç³»ç»Ÿä¾èµ–ã€ç³»ç»Ÿå·¥å…·ç­‰</li>
<li>GD æ‰©å±•è‡ªåŠ¨é…ç½®ï¼šå¦‚æœ local æ‰©å±•ä¸­å­˜åœ¨ GD æ‰©å±•ï¼Œåˆ™è‡ªåŠ¨åšæ‰©å±•ç‰¹æ®Šé…ç½®</li>
<li>é•œåƒåç§°è‡ªå®šä¹‰ï¼šåŸºç¡€é•œåƒåç§°è‡ªåŠ¨ç”Ÿæˆï¼Œæœ€ç»ˆé•œåƒåç§°å¯ä»¥è‡ªç”±å®šä¹‰</li>
<li>æ‰©å±•å®‰è£…é‡è¯•æœºåˆ¶ï¼šå®‰è£…æ‰©å±•å®¹æ˜“å› ä¸ºå„ç§åŸå› å¤±è´¥ï¼Œè¿½åŠ é‡è¯•æœºåˆ¶ï¼ˆ3æ¬¡ï¼‰å‡å°‘å¤±è´¥æ¬¡æ•°</li>
<li>... ... ...</li>
</ul>
<p>okkï¼Œæå‡åˆ°æ­¤ç»“æŸï¼Œåˆå¯ä»¥æ„‰å¿«çš„åšç‰›é©¬äº† ... ... ...</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥day23]]></title>    <link>https://juejin.cn/post/7603219519667273747</link>    <guid>https://juejin.cn/post/7603219519667273747</guid>    <pubDate>2026-02-05T16:02:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603219519667273747" data-draft-id="7603252259560374308" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥day23"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2026-02-05T16:02:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æµæµªå°å­©"/> <meta itemprop="url" content="https://juejin.cn/user/4355606019312011"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»£ç éšæƒ³å½•ç®—æ³•è®­ç»ƒè¥day23
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4355606019312011/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æµæµªå°å­©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T16:02:48.000Z" title="Thu Feb 05 2026 16:02:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å›æº¯ç®—æ³•çš„è¿›ä¸€æ­¥å¼ºåŒ–
39.ç»„åˆæ€»å’Œ
å’Œä¹‹å‰çš„ç»„åˆæ•°ç±»ä¼¼ï¼Œä»…ä»…éœ€è¦æ³¨æ„å¯ä»¥å–é‡å°±å¯ä»¥</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {
<span class="hljs-attr">private</span>:
    vector&lt;vector&lt;int&gt;&gt; result;<span class="hljs-comment">//å­˜å‚¨æ‰€æœ‰ç»“æœ</span>
    vector&lt;int&gt; tmp;<span class="hljs-comment">//å­˜å‚¨ä¸´æ—¶ç»“æœ</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">backtracking</span>(<span class="hljs-params">vector&lt;int&gt;&amp; candidates,int target,int index,int sum</span>){
        <span class="hljs-comment">//é€’å½’åº•å±‚</span>
        <span class="hljs-keyword">if</span>(sum&gt;target) <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(sum==target) {
          result.<span class="hljs-title function_">push_back</span>(tmp);
          <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-comment">//å•å±‚é€’å½’é€»è¾‘</span>
        <span class="hljs-keyword">for</span>(int i=index;i&lt;candidates.<span class="hljs-title function_">size</span>()&amp;&amp;sum&lt;target;i++){
          sum=sum+candidates[i];
          tmp.<span class="hljs-title function_">push_back</span>(candidates[i]);
          <span class="hljs-title function_">backtracking</span>(candidates,target,i,sum);
          sum=sum-candidates[i];
          tmp.<span class="hljs-title function_">pop_back</span>();
        }
    }
    
<span class="hljs-attr">public</span>:
    vector&lt;vector&lt;int&gt;&gt; <span class="hljs-title function_">combinationSum</span>(<span class="hljs-params">vector&lt;int&gt;&amp; candidates, int target</span>) {
        result.<span class="hljs-title function_">clear</span>();
        tmp.<span class="hljs-title function_">clear</span>();
        <span class="hljs-title function_">backtracking</span>(candidates,target,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);
        <span class="hljs-keyword">return</span> result;
        
    }
};
</code></pre>
<p>40 ç»„åˆæ•°äºŒ
å¢åŠ äº†å‰ªæ”¯æ“ä½œä»¥åŠåˆ¤æ–­ä¸èƒ½å¤Ÿé‡å¤å–æ•°ï¼Œå‡å°‘æ—¶é—´å¤æ‚åº¦</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {
<span class="hljs-attr">private</span>:
    vector&lt;vector&lt;int&gt;&gt; result;
    vector&lt;int&gt; path;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">backtracking</span>(<span class="hljs-params">vector&lt;int&gt;&amp; candidates, int target, int sum, int startIndex</span>) {
        <span class="hljs-keyword">if</span> (sum == target) {
            result.<span class="hljs-title function_">push_back</span>(path);
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">for</span> (int i = startIndex; i &lt; candidates.<span class="hljs-title function_">size</span>() &amp;&amp; sum + candidates[i] &lt;= target; i++) {
            <span class="hljs-comment">// è¦å¯¹åŒä¸€æ ‘å±‚ä½¿ç”¨è¿‡çš„å…ƒç´ è¿›è¡Œè·³è¿‡</span>
            <span class="hljs-keyword">if</span> (i &gt; startIndex &amp;&amp; candidates[i] == candidates[i - <span class="hljs-number">1</span>]) {
                <span class="hljs-keyword">continue</span>;
            }
            sum += candidates[i];
            path.<span class="hljs-title function_">push_back</span>(candidates[i]);
            <span class="hljs-title function_">backtracking</span>(candidates, target, sum, i + <span class="hljs-number">1</span>); <span class="hljs-comment">// å’Œ39.ç»„åˆæ€»å’Œçš„åŒºåˆ«1ï¼Œè¿™é‡Œæ˜¯i+1ï¼Œæ¯ä¸ªæ•°å­—åœ¨æ¯ä¸ªç»„åˆä¸­åªèƒ½ä½¿ç”¨ä¸€æ¬¡</span>
            sum -= candidates[i];
            path.<span class="hljs-title function_">pop_back</span>();
        }
    }

<span class="hljs-attr">public</span>:
    vector&lt;vector&lt;int&gt;&gt; <span class="hljs-title function_">combinationSum2</span>(<span class="hljs-params">vector&lt;int&gt;&amp; candidates, int target</span>) {
        path.<span class="hljs-title function_">clear</span>();
        result.<span class="hljs-title function_">clear</span>();
        <span class="hljs-comment">// é¦–å…ˆæŠŠç»™candidatesæ’åºï¼Œè®©å…¶ç›¸åŒçš„å…ƒç´ éƒ½æŒ¨åœ¨ä¸€èµ·ã€‚</span>
        <span class="hljs-title function_">sort</span>(candidates.<span class="hljs-title function_">begin</span>(), candidates.<span class="hljs-title function_">end</span>());
        <span class="hljs-title function_">backtracking</span>(candidates, target, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        <span class="hljs-keyword">return</span> result;
    }
};
</code></pre>
<p>131 åˆ†å‰²å›æ–‡ä¸²</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {
<span class="hljs-comment">//è®¾è®¡æ€è·¯ï¼Œé‡‡ç”¨é€’å½’çš„æ–¹å¼ä¸æ–­å¯¹sè¿›è¡Œæ‹†åˆ†é€’å½’ã€‚</span>
<span class="hljs-comment">//ç¬¬ä¸€æ­¥ï¼Œé€’å½’å‡½æ•°éœ€è¦ä¼ å…¥çš„å‚æ•°ï¼Œé™¤sä¹‹å¤–ï¼Œè¿˜åº”å½“æœ‰åˆ†å‰²ä¸‹æ ‡ã€‚å…·ä½“ç»“æœåˆ†åˆ«å­˜å‚¨åœ¨resultå’Œtmpä¹‹ä¸­</span>
<span class="hljs-attr">private</span>:
    vector&lt;vector&lt;string&gt;&gt; result;
    vector&lt;string&gt; tmp;
    <span class="hljs-comment">//åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºå›æ–‡ä¸²çš„å‡½æ•°</span>
   bool <span class="hljs-title function_">reword</span>(<span class="hljs-params">string s</span>){
          <span class="hljs-comment">//ä½¿ç”¨åŒæŒ‡é’ˆ</span>
        <span class="hljs-keyword">for</span>( int i=<span class="hljs-number">0</span>,j=s.<span class="hljs-title function_">size</span>()-<span class="hljs-number">1</span>;i&lt;j;i++,j--){
            <span class="hljs-keyword">if</span>(s[i]!=s[j])
               <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
   
   <span class="hljs-keyword">void</span> <span class="hljs-title function_">backtracking</span>(<span class="hljs-params">string s,int index</span>){
        <span class="hljs-comment">//åº•å±‚é€’å½’ï¼Œå½“index==s.size()æ—¶è¡¨ç¤ºå›æ–‡ä¸²è¢«åˆ†å‰²å®Œï¼Œè¿”å›</span>
        <span class="hljs-keyword">if</span>(index==s.<span class="hljs-title function_">size</span>()){
            result.<span class="hljs-title function_">push_back</span>(tmp);
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-comment">//å•å±‚é€’å½’é€»è¾‘</span>
        <span class="hljs-keyword">for</span>(int i=index;i&lt;s.<span class="hljs-title function_">size</span>();i++){
            <span class="hljs-comment">//åˆ¤æ–­è¯¥æ®µåˆ†å‰²æ˜¯å¦æ»¡è¶³å›æ–‡å­—ç¬¦ä¸²</span>
            string cur=s.<span class="hljs-title function_">substr</span>(index, i - index + <span class="hljs-number">1</span>);
            <span class="hljs-keyword">if</span>(!<span class="hljs-title function_">reword</span>(cur))
               <span class="hljs-keyword">continue</span>;
            tmp.<span class="hljs-title function_">push_back</span>(cur);
            <span class="hljs-title function_">backtracking</span>(s,i+<span class="hljs-number">1</span>);
            tmp.<span class="hljs-title function_">pop_back</span>();
        }
    }
<span class="hljs-attr">public</span>:
    vector&lt;vector&lt;string&gt;&gt; <span class="hljs-title function_">partition</span>(<span class="hljs-params">string s</span>) {
        result.<span class="hljs-title function_">clear</span>();
        tmp.<span class="hljs-title function_">clear</span>();
        <span class="hljs-title function_">backtracking</span>(s,<span class="hljs-number">0</span>);
        <span class="hljs-keyword">return</span> result;
    }
};
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäº littlefs çš„æ—¥å¿—å­˜å‚¨è§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7603195960255250432</link>    <guid>https://juejin.cn/post/7603195960255250432</guid>    <pubDate>2026-02-05T18:07:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603195960255250432" data-draft-id="7603183929252397108" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäº littlefs çš„æ—¥å¿—å­˜å‚¨è§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-05T18:07:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ—é›¨852"/> <meta itemprop="url" content="https://juejin.cn/user/3775071381890170"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäº littlefs çš„æ—¥å¿—å­˜å‚¨è§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3775071381890170/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ—é›¨852
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T18:07:05.000Z" title="Thu Feb 05 2026 18:07:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åŸºäº littlefs çš„æ—¥å¿—å­˜å‚¨è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-1">é¡¹ç›®æ¶æ„æ¦‚è§ˆ</h3>
<h4 data-id="heading-2">littlefs é€‚é…å±‚ï¼ˆç°æœ‰ï¼‰</h4>
<p>æœ¬é¡¹ç›®åœ¨ <code>src/middleware/chips/ws63/littlefs/</code> ä¸­å·²æä¾›äº† littlefs çš„é€‚é…å±‚ï¼š</p>
<p><strong>ä¸»è¦ API å‡½æ•°ï¼š</strong></p>
<pre><code class="hljs language-c" lang="c">fs_adapt_mount()              <span class="hljs-comment">// æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ</span>
fs_adapt_unmount()            <span class="hljs-comment">// å¸è½½æ–‡ä»¶ç³»ç»Ÿ</span>
fs_adapt_open(path, flags)    <span class="hljs-comment">// æ‰“å¼€æ–‡ä»¶ï¼šè¿”å›æ–‡ä»¶æè¿°ç¬¦ (fd)</span>
fs_adapt_close(fd)            <span class="hljs-comment">// å…³é—­æ–‡ä»¶</span>
fs_adapt_write(fd, buf, len)  <span class="hljs-comment">// å†™å…¥æ•°æ®ï¼šæˆåŠŸè¿”å›å†™å…¥å­—èŠ‚æ•°</span>
fs_adapt_read(fd, buf, len)   <span class="hljs-comment">// è¯»å–æ•°æ®ï¼šæˆåŠŸè¿”å›è¯»å–å­—èŠ‚æ•°</span>
fs_adapt_seek(fd, offset, whence)  <span class="hljs-comment">// æ–‡ä»¶æŒ‡é’ˆå®šä½</span>
fs_adapt_stat(path, &amp;size)    <span class="hljs-comment">// è·å–æ–‡ä»¶å¤§å°</span>
fs_adapt_delete(path)         <span class="hljs-comment">// åˆ é™¤æ–‡ä»¶</span>
fs_adapt_mkdir(path)          <span class="hljs-comment">// åˆ›å»ºç›®å½•</span>
fs_adapt_sync(fd)             <span class="hljs-comment">// æ–‡ä»¶åŒæ­¥åˆ°å­˜å‚¨</span>
</code></pre>
<hr/>
<h3 data-id="heading-3">æ—¥å¿—å­˜å‚¨ç®¡ç†æ–¹æ¡ˆ</h3>
<h4 data-id="heading-4">æ ¸å¿ƒåŠŸèƒ½éœ€æ±‚</h4>
<p>âœ… å­˜å‚¨ 20+ ä¸ªæ—¥å¿—æ–‡ä»¶<br/>
âœ… æ ¹æ®æ—¶é—´æˆ³å‘½åæ–‡ä»¶<br/>
âœ… è‡ªåŠ¨æ–‡ä»¶è½®è½¬ï¼ˆè¶…è¿‡ 1MB è‡ªåŠ¨åˆ›å»ºæ–°æ–‡ä»¶ï¼‰<br/>
âœ… æ”¯æŒæŒ‰æ–‡ä»¶åè¯»å–æ—¥å¿—<br/>
âœ… æ”¯æŒæ—¥å¿—è¿½åŠ å†™å…¥</p>
<h4 data-id="heading-5">å®ç°æ­¥éª¤</h4>
<h5 data-id="heading-6">1ï¸âƒ£ <strong>åˆå§‹åŒ–ä¸æŒ‚è½½</strong></h5>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"littlefs_adapt.h"</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">init_log_storage</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-comment">// 1. æŒ‚è½½ littlefs æ–‡ä»¶ç³»ç»Ÿ</span>
    fs_adapt_mount();
    
    <span class="hljs-comment">// 2. åˆ›å»ºæ—¥å¿—ç›®å½•</span>
    <span class="hljs-type">int</span> ret = fs_adapt_mkdir(<span class="hljs-string">"/logs"</span>);
    <span class="hljs-keyword">if</span> (ret != LFS_ERR_OK &amp;&amp; ret != LFS_ERR_EXIST) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<hr/>
<h5 data-id="heading-7">2ï¸âƒ£ <strong>ç”Ÿæˆæ—¶é—´æˆ³æ–‡ä»¶å</strong></h5>
<p><strong>ç¤ºä¾‹ï¼šç”Ÿæˆæ–‡ä»¶åå¦‚ <code>2025-02-06_143022.log</code></strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-comment">// ç”Ÿæˆæ—¶é—´æˆ³æ ¼å¼çš„æ–‡ä»¶å</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">generate_log_filename</span><span class="hljs-params">(<span class="hljs-type">char</span> *filename, <span class="hljs-type">size_t</span> max_len)</span>
{
    <span class="hljs-type">time_t</span> now = time(<span class="hljs-literal">NULL</span>);
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tm</span> *<span class="hljs-title">timeinfo</span> =</span> localtime(&amp;now);
    
    <span class="hljs-built_in">snprintf</span>(filename, max_len, <span class="hljs-string">"/logs/%04d%02d%02d_%02d%02d%02d.log"</span>,
             timeinfo-&gt;tm_year + <span class="hljs-number">1900</span>,
             timeinfo-&gt;tm_mon + <span class="hljs-number">1</span>,
             timeinfo-&gt;tm_mday,
             timeinfo-&gt;tm_hour,
             timeinfo-&gt;tm_min,
             timeinfo-&gt;tm_sec);
}
</code></pre>
<hr/>
<h5 data-id="heading-8">3ï¸âƒ£ <strong>æ—¥å¿—å†™å…¥ï¼ˆå¸¦è‡ªåŠ¨è½®è½¬ï¼‰</strong></h5>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> LOG_FILE_MAX_SIZE (1024 * 1024)  <span class="hljs-comment">// 1MB</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">write_log</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *log_content)</span>
{
    <span class="hljs-type">char</span> filename[<span class="hljs-number">64</span>];
    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> file_size = <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// è·å–å½“å‰æ—¥å¿—æ–‡ä»¶å</span>
    generate_log_filename(filename, <span class="hljs-keyword">sizeof</span>(filename));
    
    <span class="hljs-comment">// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨åŠå¤§å°</span>
    <span class="hljs-keyword">if</span> (fs_adapt_stat(filename, &amp;file_size) == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// æ–‡ä»¶å­˜åœ¨ï¼Œæ£€æŸ¥æ˜¯å¦è¶…è¿‡ 1MB</span>
        <span class="hljs-keyword">if</span> (file_size &gt;= LOG_FILE_MAX_SIZE) {
            <span class="hljs-comment">// æ–‡ä»¶å·²æ»¡ï¼Œç”Ÿæˆæ–°æ–‡ä»¶åï¼ˆåŠ æ—¶é—´æˆ³ï¼‰</span>
            <span class="hljs-type">char</span> new_filename[<span class="hljs-number">64</span>];
            <span class="hljs-type">time_t</span> now = time(<span class="hljs-literal">NULL</span>);
            <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tm</span> *<span class="hljs-title">timeinfo</span> =</span> localtime(&amp;now);
            
            <span class="hljs-built_in">snprintf</span>(new_filename, <span class="hljs-keyword">sizeof</span>(new_filename), 
                     <span class="hljs-string">"/logs/%04d%02d%02d_%02d%02d%02d_%lu.log"</span>,
                     timeinfo-&gt;tm_year + <span class="hljs-number">1900</span>,
                     timeinfo-&gt;tm_mon + <span class="hljs-number">1</span>,
                     timeinfo-&gt;tm_mday,
                     timeinfo-&gt;tm_hour,
                     timeinfo-&gt;tm_min,
                     timeinfo-&gt;tm_sec,
                     (<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span>)now);  <span class="hljs-comment">// æ·»åŠ æ—¶é—´æˆ³é¿å…é‡å</span>
            <span class="hljs-built_in">strcpy</span>(filename, new_filename);
        }
    }
    
    <span class="hljs-comment">// ä»¥è¿½åŠ æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼ˆO_CREAT | O_APPENDï¼‰</span>
    <span class="hljs-type">int</span> fd = fs_adapt_open(filename, O_RDWR | O_CREAT | O_APPEND);
    <span class="hljs-keyword">if</span> (fd &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
    }
    
    <span class="hljs-comment">// å†™å…¥æ—¥å¿—å†…å®¹</span>
    <span class="hljs-type">int</span> ret = fs_adapt_write(fd, log_content, <span class="hljs-built_in">strlen</span>(log_content));
    <span class="hljs-keyword">if</span> (ret &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// å†™å…¥æ¢è¡Œç¬¦</span>
        fs_adapt_write(fd, <span class="hljs-string">"\n"</span>, <span class="hljs-number">1</span>);
    }
    
    <span class="hljs-comment">// åŒæ­¥åˆ°å­˜å‚¨ï¼ˆç¡®ä¿æ•°æ®ä¸ä¸¢å¤±ï¼‰</span>
    fs_adapt_sync(fd);
    
    <span class="hljs-comment">// å…³é—­æ–‡ä»¶</span>
    fs_adapt_close(fd);
    
    <span class="hljs-keyword">return</span> ret;
}
</code></pre>
<hr/>
<h5 data-id="heading-9">4ï¸âƒ£ <strong>æŒ‰æ–‡ä»¶åè¯»å–æ—¥å¿—</strong></h5>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// å®šä¹‰ç¼“å†²åŒºå¤§å°</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> LOG_BUFFER_SIZE (4096)</span>

<span class="hljs-type">ssize_t</span> <span class="hljs-title function_">read_log_file</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *filename, <span class="hljs-type">char</span> *buffer, <span class="hljs-type">size_t</span> max_len)</span>
{
    <span class="hljs-comment">// å®Œæ•´è·¯å¾„</span>
    <span class="hljs-type">char</span> filepath[<span class="hljs-number">64</span>];
    <span class="hljs-built_in">snprintf</span>(filepath, <span class="hljs-keyword">sizeof</span>(filepath), <span class="hljs-string">"/logs/%s"</span>, filename);
    
    <span class="hljs-comment">// ä»¥åªè¯»æ¨¡å¼æ‰“å¼€æ–‡ä»¶</span>
    <span class="hljs-type">int</span> fd = fs_adapt_open(filepath, O_RDONLY);
    <span class="hljs-keyword">if</span> (fd &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;  <span class="hljs-comment">// æ–‡ä»¶ä¸å­˜åœ¨</span>
    }
    
    <span class="hljs-comment">// ä»æ–‡ä»¶å¼€å¤´è¯»å–</span>
    <span class="hljs-type">ssize_t</span> bytes_read = fs_adapt_read(fd, buffer, max_len - <span class="hljs-number">1</span>);
    
    <span class="hljs-keyword">if</span> (bytes_read &gt; <span class="hljs-number">0</span>) {
        buffer[bytes_read] = <span class="hljs-string">'\0'</span>;  <span class="hljs-comment">// å­—ç¬¦ä¸²ç©ºç»ˆæ­¢</span>
    }
    
    fs_adapt_close(fd);
    
    <span class="hljs-keyword">return</span> bytes_read;
}
</code></pre>
<hr/>
<h5 data-id="heading-10">5ï¸âƒ£ <strong>åˆ—å‡ºæ‰€æœ‰æ—¥å¿—æ–‡ä»¶</strong></h5>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>

<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>
    <span class="hljs-type">char</span> filename[<span class="hljs-number">64</span>];
    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> size;
} <span class="hljs-type">log_file_info_t</span>;

<span class="hljs-comment">// åˆ—å‡º /logs ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">list_all_logs</span><span class="hljs-params">(<span class="hljs-type">log_file_info_t</span> *log_files, <span class="hljs-type">int</span> max_count, <span class="hljs-type">int</span> *actual_count)</span>
{
    <span class="hljs-type">lfs_dir_t</span> dir;
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">lfs_info</span> <span class="hljs-title">info</span>;</span>
    <span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// æ‰“å¼€ /logs ç›®å½•ï¼ˆéœ€è¦ä½¿ç”¨åŸç”Ÿ littlefs APIï¼‰</span>
    <span class="hljs-comment">// æ³¨æ„ï¼šå½“å‰é€‚é…å±‚ä¸æä¾›ç›®å½•éå†ï¼Œéœ€è¦æ‰©å±•</span>
    
    <span class="hljs-comment">// æš‚æ—¶ä½¿ç”¨æ–‡ä»¶æ—¶é—´æˆ³çº¦å®šæ¥ç®¡ç†</span>
    <span class="hljs-comment">// åº”ç”¨å±‚å¯ç»´æŠ¤ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ç´¢å¼•è¡¨</span>
    
    <span class="hljs-keyword">return</span> count;
}
</code></pre>
<hr/>
<h3 data-id="heading-11">å®Œæ•´ä½¿ç”¨ç¤ºä¾‹</h3>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"littlefs_adapt.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span></span>

<span class="hljs-comment">// å®Œæ•´çš„æ—¥å¿—ç®¡ç†ç¤ºä¾‹</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">log_management_example</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-comment">// 1ï¸âƒ£ åˆå§‹åŒ–</span>
    init_log_storage();
    
    <span class="hljs-comment">// 2ï¸âƒ£ å†™å…¥æ—¥å¿—ï¼ˆæ¨¡æ‹Ÿå¤šä¸ªæ—¥å¿—æ¡ç›®ï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
        <span class="hljs-type">char</span> log_str[<span class="hljs-number">256</span>];
        <span class="hljs-built_in">snprintf</span>(log_str, <span class="hljs-keyword">sizeof</span>(log_str), 
                 <span class="hljs-string">"[INFO] Log entry %d - Timestamp: %ld"</span>, i, time(<span class="hljs-literal">NULL</span>));
        
        write_log(log_str);
        
        <span class="hljs-comment">// æ¨¡æ‹Ÿå»¶è¿Ÿ</span>
        usleep(<span class="hljs-number">10000</span>);
    }
    
    <span class="hljs-comment">// 3ï¸âƒ£ è¯»å–ç‰¹å®šæ—¥å¿—æ–‡ä»¶</span>
    <span class="hljs-type">char</span> buffer[<span class="hljs-number">4096</span>];
    <span class="hljs-type">ssize_t</span> ret = read_log_file(<span class="hljs-string">"20250206_143022.log"</span>, buffer, <span class="hljs-keyword">sizeof</span>(buffer));
    <span class="hljs-keyword">if</span> (ret &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Log content:\n%s\n"</span>, buffer);
    }
    
    <span class="hljs-comment">// 4ï¸âƒ£ å¸è½½æ–‡ä»¶ç³»ç»Ÿ</span>
    fs_adapt_unmount();
}
</code></pre>
<hr/>
<h3 data-id="heading-12">å…³é”® API è°ƒç”¨æ€»ç»“</h3>




























































<table><thead><tr><th>æ“ä½œ</th><th>API è°ƒç”¨</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>åˆå§‹åŒ–</strong></td><td><code>fs_adapt_mount()</code></td><td>æ–‡ä»¶ç³»ç»Ÿåˆå§‹åŒ–</td></tr><tr><td><strong>åˆ›å»ºç›®å½•</strong></td><td><code>fs_adapt_mkdir("/logs")</code></td><td>åˆ›å»ºæ—¥å¿—ç›®å½•</td></tr><tr><td><strong>æ‰“å¼€æ–‡ä»¶</strong></td><td><code>fs_adapt_open(path, O_RDWR|O_CREAT|O_APPEND)</code></td><td>ä»¥è¿½åŠ æ¨¡å¼æ‰“å¼€</td></tr><tr><td><strong>å†™å…¥æ•°æ®</strong></td><td><code>fs_adapt_write(fd, buf, len)</code></td><td>å†™å…¥æ—¥å¿—å†…å®¹</td></tr><tr><td><strong>åŒæ­¥æ•°æ®</strong></td><td><code>fs_adapt_sync(fd)</code></td><td>ç¡®ä¿æ•°æ®åˆ·æ–°åˆ° Flash</td></tr><tr><td><strong>å…³é—­æ–‡ä»¶</strong></td><td><code>fs_adapt_close(fd)</code></td><td>å…³é—­æ–‡ä»¶æè¿°ç¬¦</td></tr><tr><td><strong>è¯»å–æ•°æ®</strong></td><td><code>fs_adapt_read(fd, buf, len)</code></td><td>è¯»å–æ–‡ä»¶å†…å®¹</td></tr><tr><td><strong>æ£€æŸ¥å¤§å°</strong></td><td><code>fs_adapt_stat(path, &amp;size)</code></td><td>è·å–æ–‡ä»¶å¤§å°</td></tr><tr><td><strong>åˆ é™¤æ–‡ä»¶</strong></td><td><code>fs_adapt_delete(path)</code></td><td>åˆ é™¤æ—§æ—¥å¿—</td></tr><tr><td><strong>å®šä½æŒ‡é’ˆ</strong></td><td><code>fs_adapt_seek(fd, offset, SEEK_SET)</code></td><td>ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆ</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-13">é«˜çº§ç‰¹æ€§å»ºè®®</h3>
<h4 data-id="heading-14">1. <strong>æ—¥å¿—æ–‡ä»¶ç´¢å¼•ç®¡ç†</strong></h4>
<p>ç»´æŠ¤å†…å­˜ä¸­çš„ç´¢å¼•è¡¨ï¼Œè®°å½•æ‰€æœ‰æ—¥å¿—æ–‡ä»¶åŠå…¶å…ƒæ•°æ®ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>
    <span class="hljs-type">char</span> filename[<span class="hljs-number">64</span>];
    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> size;
    <span class="hljs-type">time_t</span> created_time;
    <span class="hljs-type">time_t</span> last_modified;
} <span class="hljs-type">log_index_t</span>;
</code></pre>
<h4 data-id="heading-15">2. <strong>è‡ªåŠ¨æ¸…ç†æœºåˆ¶</strong></h4>
<p>å½“æ—¥å¿—æ€»æ•°è¶…è¿‡ 20 ä¸ªæ—¶ï¼Œåˆ é™¤æœ€æ—§çš„æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">cleanup_old_logs</span><span class="hljs-params">(<span class="hljs-type">int</span> max_files)</span>
{
    <span class="hljs-comment">// æŒ‰ä¿®æ”¹æ—¶é—´æ’åº</span>
    <span class="hljs-comment">// åˆ é™¤è¶…è¿‡æ•°é‡çš„æœ€æ—§æ–‡ä»¶</span>
}
</code></pre>
<h4 data-id="heading-16">3. <strong>ç¯å½¢ç¼“å†²ä¼˜åŒ–</strong></h4>
<p>å¯¹äºé«˜é¢‘æ—¥å¿—åœºæ™¯ï¼Œä½¿ç”¨ç¯å½¢ç¼“å†²åŒºå‡å°‘ I/Oï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>
    <span class="hljs-type">char</span> buffer[<span class="hljs-number">4096</span>];
    <span class="hljs-type">int</span> write_pos;
    <span class="hljs-type">int</span> flush_threshold;
} <span class="hljs-type">log_circular_buffer_t</span>;
</code></pre>
<h4 data-id="heading-17">4. <strong>æ—¥å¿—å‹ç¼©</strong></h4>
<p>è¶…è¿‡ 1MB çš„æ–‡ä»¶å¯é€‰æ‹©å‹ç¼©æˆ–åˆ†ç‰‡å­˜å‚¨</p>
<hr/>
<h3 data-id="heading-18">æ–‡ä»¶ç³»ç»Ÿå®¹é‡è®¡ç®—</h3>
<p>å‡è®¾ littlefs åˆ†åŒºå¤§å°ä¸º 256KBï¼š</p>
<ul>
<li>æ¯ä¸ªæ–‡ä»¶æœ€å¤§ 1MB ï¼ˆå¯é…ç½®ï¼‰</li>
<li>å¯å­˜å‚¨çº¦ <strong>20-25 ä¸ª</strong> æ—¥å¿—æ–‡ä»¶</li>
<li>éœ€åœ¨ <code>littlefs_config.h</code> ä¸­é…ç½®é€‚å½“çš„åˆ†åŒºå¤§å°</li>
</ul>
<hr/>
<h3 data-id="heading-19">å¸¸è§é—®é¢˜</h3>
<p><strong>Q: å¦‚ä½•ç¡®ä¿æ—¥å¿—ä¸ä¸¢å¤±ï¼Ÿ</strong><br/>
A: æ¯æ¬¡å†™å…¥åè°ƒç”¨ <code>fs_adapt_sync(fd)</code> å¼ºåˆ¶åˆ·æ–°åˆ° Flash</p>
<p><strong>Q: å¦‚ä½•å¤„ç†æ–‡ä»¶åå†²çªï¼Ÿ</strong><br/>
A: æ·»åŠ å¾®ç§’çº§æ—¶é—´æˆ³æˆ–åºåˆ—å·åç¼€</p>
<p><strong>Q: å¦‚ä½•å¿«é€ŸæŸ¥è¯¢ç‰¹å®šæ—¶é—´æ®µçš„æ—¥å¿—ï¼Ÿ</strong><br/>
A: è§£ææ–‡ä»¶åä¸­çš„æ—¶é—´æˆ³ï¼Œæˆ–ç»´æŠ¤æ—¶é—´ç´¢å¼•è¡¨</p>
<p><strong>Q: littlefs æ€§èƒ½å¦‚ä½•ï¼Ÿ</strong><br/>
A: å°æ–‡ä»¶æ€§èƒ½ä¼˜ç§€ï¼Œé€‚åˆ MCU åœºæ™¯ï¼ˆå»¶è¿Ÿ &lt; 10msï¼‰</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ—¥å¿—ç®¡ç†åº“é›†æˆæŒ‡å—ï¼ˆIntegration Guideï¼‰]]></title>    <link>https://juejin.cn/post/7603043152673898511</link>    <guid>https://juejin.cn/post/7603043152673898511</guid>    <pubDate>2026-02-05T18:10:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603043152673898511" data-draft-id="7603043152673882127" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ—¥å¿—ç®¡ç†åº“é›†æˆæŒ‡å—ï¼ˆIntegration Guideï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-05T18:10:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ—é›¨852"/> <meta itemprop="url" content="https://juejin.cn/user/3775071381890170"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ—¥å¿—ç®¡ç†åº“é›†æˆæŒ‡å—ï¼ˆIntegration Guideï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3775071381890170/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ—é›¨852
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T18:10:50.000Z" title="Thu Feb 05 2026 18:10:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ—¥å¿—ç®¡ç†åº“é›†æˆæŒ‡å—ï¼ˆIntegration Guideï¼‰</h2>
<h3 data-id="heading-1">å¿«é€Ÿå¼€å§‹</h3>
<h4 data-id="heading-2">æ–‡ä»¶åˆ—è¡¨</h4>
<pre><code class="hljs language-bash" lang="bash">â”œâ”€â”€ log_manager.h              <span class="hljs-comment"># æ—¥å¿—ç®¡ç†åº“å¤´æ–‡ä»¶ï¼ˆå…¬å…±APIï¼‰</span>
â”œâ”€â”€ log_manager.c              <span class="hljs-comment"># æ—¥å¿—ç®¡ç†åº“å®ç°</span>
â”œâ”€â”€ log_manager_examples.c     <span class="hljs-comment"># ä½¿ç”¨ç¤ºä¾‹å’Œæµ‹è¯•ç”¨ä¾‹</span>
â”œâ”€â”€ LOG_STORAGE_SOLUTION.md    <span class="hljs-comment"># è¯¦ç»†çš„æ¶æ„æ–‡æ¡£</span>
â””â”€â”€ INTEGRATION_GUIDE.md       <span class="hljs-comment"># æœ¬æ–‡ä»¶</span>
</code></pre>
<hr/>
<h3 data-id="heading-3">1ï¸âƒ£ æ ¸å¿ƒ API æ€»ç»“</h3>
<h4 data-id="heading-4">åˆå§‹åŒ–å’Œæ¸…ç†</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">int</span> <span class="hljs-title function_">log_manager_init</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;              <span class="hljs-comment">// åˆå§‹åŒ–æ—¥å¿—ç³»ç»Ÿ</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">log_manager_cleanup</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;           <span class="hljs-comment">// å…³é—­æ—¥å¿—ç³»ç»Ÿ</span>
</code></pre>
<h4 data-id="heading-5">æ—¥å¿—å†™å…¥</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">int</span> <span class="hljs-title function_">log_manager_write</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *log_message)</span>;                    <span class="hljs-comment">// å†™å…¥ç®€å•æ—¥å¿—</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">log_manager_printf</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *format, ...)</span>;                  <span class="hljs-comment">// æ ¼å¼åŒ–å†™å…¥ï¼ˆprintfé£æ ¼ï¼‰</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">log_manager_write_level</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *level, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *message)</span>;  <span class="hljs-comment">// å¸¦æ—¥å¿—ç­‰çº§</span>
</code></pre>
<h4 data-id="heading-6">æ—¥å¿—è¯»å–</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">int</span> <span class="hljs-title function_">log_manager_read</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *filename, <span class="hljs-type">char</span> *buffer, <span class="hljs-type">size_t</span> max_len)</span>;
<span class="hljs-type">int</span> <span class="hljs-title function_">log_manager_read_offset</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *filename, <span class="hljs-type">char</span> *buffer, <span class="hljs-type">size_t</span> max_len, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> offset)</span>;
</code></pre>
<h4 data-id="heading-7">æ–‡ä»¶ç®¡ç†</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">int</span> <span class="hljs-title function_">log_manager_get_file_size</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *filename, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *file_size)</span>;
<span class="hljs-type">int</span> <span class="hljs-title function_">log_manager_list_files</span><span class="hljs-params">(<span class="hljs-type">log_file_info_t</span> *files, <span class="hljs-type">int</span> max_count, <span class="hljs-type">int</span> *actual_count)</span>;
<span class="hljs-type">int</span> <span class="hljs-title function_">log_manager_delete_file</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *filename)</span>;
<span class="hljs-type">int</span> <span class="hljs-title function_">log_manager_cleanup_old_files</span><span class="hljs-params">(<span class="hljs-type">int</span> max_files)</span>;
<span class="hljs-type">int</span> <span class="hljs-title function_">log_manager_clear_all</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>;
</code></pre>
<h4 data-id="heading-8">æ–‡ä»¶åç”Ÿæˆ</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">char</span>* <span class="hljs-title function_">log_manager_generate_filename</span><span class="hljs-params">(<span class="hljs-type">char</span> *filename, <span class="hljs-type">size_t</span> max_len)</span>;
<span class="hljs-type">int</span> <span class="hljs-title function_">log_manager_get_current_file_info</span><span class="hljs-params">(<span class="hljs-type">log_file_info_t</span> *current_file)</span>;
</code></pre>
<hr/>
<h3 data-id="heading-9">2ï¸âƒ£ æœ€å°åŒ–é›†æˆæ­¥éª¤</h3>
<h4 data-id="heading-10">æ­¥éª¤1ï¼šæ·»åŠ æ–‡ä»¶åˆ°é¡¹ç›®</h4>
<p>å°† <code>log_manager.h</code> å’Œ <code>log_manager.c</code> å¤åˆ¶åˆ°é¡¹ç›®çš„ middleware ç›®å½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">src/middleware/chips/ws63/log_manager/
â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ log_manager.h
â””â”€â”€ log_manager.c
</code></pre>
<h4 data-id="heading-11">æ­¥éª¤2ï¼šä¿®æ”¹ CMakeLists.txt</h4>
<p>åœ¨ <code>src/middleware/CMakeLists.txt</code> ä¸­æ·»åŠ ï¼š</p>
<pre><code class="hljs language-cmake" lang="cmake">add_subdirectory(chips/${CONFIG_CHIP_TYPE}/log_manager)
</code></pre>
<p>åœ¨ <code>src/middleware/chips/ws63/log_manager/CMakeLists.txt</code> ä¸­æ·»åŠ ï¼š</p>
<pre><code class="hljs language-cmake" lang="cmake">cmake_minimum_required(VERSION 3.5)

file(GLOB_RECURSE LOG_MANAGER_SOURCES "*.c")

add_library(log_manager STATIC ${LOG_MANAGER_SOURCES})

target_include_directories(log_manager PUBLIC 
    ${CMAKE_CURRENT_SOURCE_DIR}
    ${MIDD_DIR}/chips/${CONFIG_CHIP_TYPE}/littlefs
)

target_link_libraries(log_manager littlefs)
</code></pre>
<h4 data-id="heading-12">æ­¥éª¤3ï¼šåœ¨åº”ç”¨ä»£ç ä¸­ä½¿ç”¨</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"log_manager.h"</span></span>

<span class="hljs-type">void</span> <span class="hljs-title function_">main_application</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-comment">// åˆå§‹åŒ–</span>
    log_manager_init();
    
    <span class="hljs-comment">// å†™å…¥æ—¥å¿—</span>
    log_manager_write(<span class="hljs-string">"System started"</span>);
    log_manager_printf(<span class="hljs-string">"Temperature: %dÂ°C"</span>, <span class="hljs-number">28</span>);
    log_manager_write_level(<span class="hljs-string">"INFO"</span>, <span class="hljs-string">"Sensor initialized"</span>);
    
    <span class="hljs-comment">// è¯»å–æ—¥å¿—</span>
    <span class="hljs-type">char</span> buffer[<span class="hljs-number">4096</span>];
    log_manager_read(<span class="hljs-string">"20250206_143022.log"</span>, buffer, <span class="hljs-keyword">sizeof</span>(buffer));
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%s\n"</span>, buffer);
    
    <span class="hljs-comment">// æ¸…ç†</span>
    log_manager_cleanup();
}
</code></pre>
<hr/>
<h3 data-id="heading-13">3ï¸âƒ£ å¸¸è§åœºæ™¯å®ç°</h3>
<h4 data-id="heading-14">åœºæ™¯Aï¼šè®¾å¤‡å¯åŠ¨æ—¥å¿—</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">log_device_startup</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    log_manager_init();
    
    log_manager_write_level(<span class="hljs-string">"INFO"</span>, <span class="hljs-string">"=== Device Startup ==="</span>);
    log_manager_write_level(<span class="hljs-string">"INFO"</span>, <span class="hljs-string">"Firmware: v1.0.0"</span>);
    log_manager_write_level(<span class="hljs-string">"DEBUG"</span>, <span class="hljs-string">"Initializing sensors"</span>);
    log_manager_write_level(<span class="hljs-string">"INFO"</span>, <span class="hljs-string">"All systems online"</span>);
    
    log_manager_cleanup();
}
</code></pre>
<h4 data-id="heading-15">åœºæ™¯Bï¼šå‘¨æœŸæ€§ä¼ æ„Ÿå™¨é‡‡æ ·</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">sensor_monitoring_task</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    log_manager_init();
    
    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {
        <span class="hljs-type">int</span> temp = read_temperature();
        <span class="hljs-type">int</span> humidity = read_humidity();
        
        log_manager_printf(<span class="hljs-string">"SENSOR: T=%dC H=%d%% Battery=85%%"</span>, 
                           temp, humidity);
        
        sleep(<span class="hljs-number">60</span>);  <span class="hljs-comment">// æ¯åˆ†é’Ÿä¸€æ¬¡</span>
    }
    
    log_manager_cleanup();
}
</code></pre>
<h4 data-id="heading-16">åœºæ™¯Cï¼šé”™è¯¯è¯Šæ–­</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">error_handler</span><span class="hljs-params">(<span class="hljs-type">int</span> error_code)</span>
{
    log_manager_init();
    
    log_manager_printf(<span class="hljs-string">"ERROR_CODE: 0x%04X"</span>, error_code);
    log_manager_write_level(<span class="hljs-string">"ERROR"</span>, <span class="hljs-string">"System error detected"</span>);
    log_manager_write_level(<span class="hljs-string">"ERROR"</span>, <span class="hljs-string">"Attempting recovery..."</span>);
    
    <span class="hljs-comment">// è®°å½•è°ƒç”¨æ ˆæˆ–å…¶ä»–è¯Šæ–­ä¿¡æ¯</span>
    log_manager_printf(<span class="hljs-string">"Error source: %s:%d"</span>, __FILE__, __LINE__);
    
    log_manager_cleanup();
}
</code></pre>
<h4 data-id="heading-17">åœºæ™¯Dï¼šæ—¥å¿—æŸ¥è¯¢å’Œå¯¼å‡º</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">export_logs_to_uart</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    log_manager_init();
    
    <span class="hljs-comment">// è·å–æ‰€æœ‰æ—¥å¿—æ–‡ä»¶åˆ—è¡¨</span>
    <span class="hljs-type">log_file_info_t</span> files[<span class="hljs-number">20</span>];
    <span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;
    log_manager_list_files(files, <span class="hljs-number">20</span>, &amp;count);
    
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"=== Log Export ===\n"</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Total files: %d\n\n"</span>, count);
    
    <span class="hljs-comment">// é€ä¸ªè¯»å–å¹¶å¯¼å‡º</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"--- File: %s ---\n"</span>, files[i].filename);
        
        <span class="hljs-type">char</span> buffer[<span class="hljs-number">4096</span>];
        log_manager_read(files[i].filename, buffer, <span class="hljs-keyword">sizeof</span>(buffer));
        
        uart_send(buffer, <span class="hljs-built_in">strlen</span>(buffer));
        
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
    }
    
    log_manager_cleanup();
}
</code></pre>
<hr/>
<h3 data-id="heading-18">4ï¸âƒ£ å†…å­˜å’Œå­˜å‚¨è€ƒè™‘</h3>
<h4 data-id="heading-19">å†…å­˜ä½¿ç”¨</h4>
<ul>
<li>å…¨å±€ç»“æ„ä½“ <code>log_manager_t</code>: ~5.5 KB
<ul>
<li>20 ä¸ªæ–‡ä»¶ä¿¡æ¯ç¼“å­˜</li>
<li>å½“å‰æ–‡ä»¶åç¼“å†²åŒº</li>
</ul>
</li>
</ul>
<h4 data-id="heading-20">å­˜å‚¨ä½¿ç”¨</h4>
<p>å‡è®¾ littlefs åˆ†åŒº 256KBï¼š</p>
<ul>
<li><strong>æœ€å¤šå­˜å‚¨æ•°é‡</strong>: ~20-25 ä¸ª 1MB çº§æ–‡ä»¶</li>
<li><strong>å®é™…å¯ç”¨</strong>: æ ¹æ®åˆ†åŒºå¤§å°è°ƒæ•´ <code>LOG_MAX_FILE_SIZE</code></li>
</ul>
<h4 data-id="heading-21">ä¼˜åŒ–å»ºè®®</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´è¿™äº›å€¼</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> LOG_MAX_FILE_SIZE (512 * 1024)   <span class="hljs-comment">// æ”¹ä¸º 512KB</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> LOG_MAX_FILES 30                  <span class="hljs-comment">// å¢åŠ æ–‡ä»¶æ•°é‡</span></span>
</code></pre>
<hr/>
<h3 data-id="heading-22">5ï¸âƒ£ çº¿ç¨‹å®‰å…¨æ€§</h3>
<h4 data-id="heading-23">å½“å‰å®ç°</h4>
<ul>
<li><strong>éçº¿ç¨‹å®‰å…¨</strong>: é€‚ç”¨äºå•çº¿ç¨‹ MCU</li>
<li>å…¨å±€å˜é‡ <code>g_log_mgr</code> ç”¨äºçŠ¶æ€ç®¡ç†</li>
</ul>
<h4 data-id="heading-24">å¤šçº¿ç¨‹ç¯å¢ƒ</h4>
<p>å¦‚æœéœ€è¦å¤šçº¿ç¨‹æ”¯æŒï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p>
<h5 data-id="heading-25">5a. æ·»åŠ äº’æ–¥é”</h5>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> CONFIG_OSAL_MUTEX</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"soc_osal.h"</span></span>

<span class="hljs-type">static</span> <span class="hljs-type">uint32_t</span> g_log_mgr_mutex;

<span class="hljs-type">void</span> <span class="hljs-title function_">log_manager_lock</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    osal_mutex_lock(g_log_mgr_mutex);
}

<span class="hljs-type">void</span> <span class="hljs-title function_">log_manager_unlock</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    osal_mutex_unlock(g_log_mgr_mutex);
}
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
</code></pre>
<h5 data-id="heading-26">5b. åœ¨å…³é”®å‡½æ•°ä¸­åŠ é”</h5>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">int</span> <span class="hljs-title function_">log_manager_write</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *log_message)</span>
{
    log_manager_lock();
    <span class="hljs-comment">// ... åŸæœ‰é€»è¾‘</span>
    log_manager_unlock();
    <span class="hljs-keyword">return</span> ret;
}
</code></pre>
<hr/>
<h3 data-id="heading-27">6ï¸âƒ£ æ€§èƒ½ä¼˜åŒ–</h3>
<h4 data-id="heading-28">ä¼˜åŒ–1ï¼šç¼“å†²æ‰¹é‡å†™å…¥</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// å‡å°‘ I/O æ¬¡æ•°ï¼Œè€Œä¸æ˜¯æ¯æ¡æ¶ˆæ¯éƒ½åŒæ­¥</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> USE_LOG_BUFFER 1  <span class="hljs-comment">// å¯ç”¨ç¼“å†²</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> LOG_BUFFER_THRESHOLD 512  <span class="hljs-comment">// 512å­—èŠ‚åå†åŒæ­¥</span></span>
</code></pre>
<h4 data-id="heading-29">ä¼˜åŒ–2ï¼šæ–‡ä»¶å‹ç¼©å­˜æ¡£</h4>
<p>å¯¹äºé•¿æœŸå­˜å‚¨ï¼Œå¯ä»¥å‹ç¼©æ—§æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// ä¼ªä»£ç </span>
<span class="hljs-type">void</span> <span class="hljs-title function_">compress_old_logs</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-type">log_file_info_t</span> old_log;
    
    <span class="hljs-comment">// æ‰¾åˆ°æœ€æ—§çš„æ–‡ä»¶</span>
    <span class="hljs-keyword">if</span> (get_oldest_file(&amp;old_log) == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// ä½¿ç”¨ zlib æˆ–å…¶ä»–å‹ç¼©åº“</span>
        compress_file(old_log.filename);
    }
}
</code></pre>
<h4 data-id="heading-30">ä¼˜åŒ–3ï¼šæ™ºèƒ½æ–‡ä»¶è½®è½¬</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// ä¸æ˜¯ç®€å•çš„å¤§å°é™åˆ¶ï¼Œè€ƒè™‘æ—¶é—´æˆ³é‡å</span>
<span class="hljs-comment">// å½“åŒä¸€ç§’å†…å¤šä¸ªå†™å…¥è§¦å‘è½®è½¬æ—¶</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">rotate_with_sequence</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-type">static</span> <span class="hljs-type">int</span> rotation_seq = <span class="hljs-number">0</span>;
    <span class="hljs-type">char</span> filename[<span class="hljs-number">256</span>];
    
    <span class="hljs-built_in">snprintf</span>(filename, <span class="hljs-keyword">sizeof</span>(filename), 
             <span class="hljs-string">"/logs/%s_%d.log"</span>,
             get_timestamp(), rotation_seq++);
    
    <span class="hljs-comment">// ... åˆ›å»ºæ–°æ–‡ä»¶</span>
}
</code></pre>
<hr/>
<h3 data-id="heading-31">7ï¸âƒ£ è°ƒè¯•å’Œæ•…éšœæ’é™¤</h3>
<h4 data-id="heading-32">å¯ç”¨è°ƒè¯•è¾“å‡º</h4>
<p>åœ¨ <code>littlefs_config.h</code> ä¸­å¯ç”¨æ—¥å¿—ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> CONFIG_LFS_ADAPT_DEBUG   <span class="hljs-comment">// littlefs è°ƒè¯•æ—¥å¿—</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> CONFIG_LFS_ADAPT_ERROR   <span class="hljs-comment">// littlefs é”™è¯¯æ—¥å¿—</span></span>
</code></pre>
<h4 data-id="heading-33">å¸¸è§é—®é¢˜</h4>






























<table><thead><tr><th>é—®é¢˜</th><th>åŸå› </th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td><code>fs_adapt_open</code> è¿”å› -1</td><td>æ–‡ä»¶è·¯å¾„æ— æ•ˆæˆ–ç›®å½•ä¸å­˜åœ¨</td><td>æ£€æŸ¥ <code>mkdir</code> æ˜¯å¦æˆåŠŸ</td></tr><tr><td>æ—¥å¿—å†™å…¥åç«‹å³è¯»å–ä¸ºç©º</td><td>æœªè°ƒç”¨ <code>fs_adapt_sync</code></td><td>æ¯æ¬¡å†™å…¥åè°ƒç”¨ sync</td></tr><tr><td>æ–‡ä»¶è½®è½¬ä¸å·¥ä½œ</td><td>æ–‡ä»¶å¤§å°æ£€æŸ¥é€»è¾‘</td><td>éªŒè¯ <code>should_rotate_file()</code></td></tr><tr><td>å†…å­˜æº¢å‡º</td><td>æ–‡ä»¶åˆ—è¡¨è¿‡å¤š</td><td>å¢åŠ  <code>LOG_MAX_FILES</code> æˆ–æ¸…ç†æ—§æ–‡ä»¶</td></tr></tbody></table>
<h4 data-id="heading-34">è°ƒè¯•ç”¨å‡½æ•°</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">debug_print_manager_state</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Log Manager State:\n"</span>);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"  Initialized: %d\n"</span>, g_log_mgr.initialized);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"  Current FD: %d\n"</span>, g_log_mgr.current_fd);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"  Current file: %s\n"</span>, g_log_mgr.current_filename);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"  Current size: %u\n"</span>, g_log_mgr.current_file_size);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"  File count: %d\n"</span>, g_log_mgr.file_count);
    
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; g_log_mgr.file_count; i++) {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"    [%d] %s - %u bytes\n"</span>, i,
               g_log_mgr.file_list[i].filename,
               g_log_mgr.file_list[i].size);
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-35">8ï¸âƒ£ å®Œæ•´ç¤ºä¾‹ä»£ç </h3>
<h4 data-id="heading-36">ç®€æ´ç‰ˆä½¿ç”¨</h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"log_manager.h"</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>
{
    <span class="hljs-comment">// åˆå§‹åŒ–</span>
    log_manager_init();
    
    <span class="hljs-comment">// å†™å…¥æ—¥å¿—</span>
    log_manager_write_level(<span class="hljs-string">"INFO"</span>, <span class="hljs-string">"Application started"</span>);
    log_manager_printf(<span class="hljs-string">"Current time: %ld"</span>, time(<span class="hljs-literal">NULL</span>));
    
    <span class="hljs-comment">// è¯»å–æ—¥å¿—</span>
    <span class="hljs-type">char</span> buffer[<span class="hljs-number">4096</span>];
    log_manager_read(<span class="hljs-string">"2025020_143022.log"</span>, buffer, <span class="hljs-keyword">sizeof</span>(buffer));
    
    <span class="hljs-comment">// æ–‡ä»¶ç®¡ç†</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> total_size;
    log_manager_get_total_size(&amp;total_size);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Total log size: %u bytes\n"</span>, total_size);
    
    <span class="hljs-comment">// æ¸…ç†</span>
    log_manager_cleanup();
    
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<hr/>
<h3 data-id="heading-37">æ€»ç»“</h3>
<p>âœ… <strong>å·²å®Œæˆçš„åŠŸèƒ½</strong></p>
<ul>
<li>æ—¶é—´æˆ³å‘½åæ–‡ä»¶</li>
<li>è‡ªåŠ¨æ–‡ä»¶è½®è½¬ (1MB é™åˆ¶)</li>
<li>æ ¼å¼åŒ–æ—¥å¿—å†™å…¥</li>
<li>æŒ‰æ–‡ä»¶åè¯»å–æ—¥å¿—</li>
<li>æ–‡ä»¶ç®¡ç†ï¼ˆåˆ—è¡¨ã€åˆ é™¤ã€æ¸…ç†ï¼‰</li>
</ul>
<p>âš ï¸ <strong>éœ€è¦æ ¹æ®é¡¹ç›®è°ƒæ•´</strong></p>
<ul>
<li>åˆ†åŒºå¤§å°ï¼ˆå½“å‰å‡è®¾ 256KBï¼‰</li>
<li>æœ€å¤§æ–‡ä»¶æ•°é‡ï¼ˆå½“å‰ 20 ä¸ªï¼‰</li>
<li>æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆå½“å‰ 1MBï¼‰</li>
<li>çº¿ç¨‹å®‰å…¨æ€§ï¼ˆå¦‚éœ€è¦ï¼‰</li>
</ul>
<p>ğŸ“¦ <strong>é›†æˆæ£€æŸ¥æ¸…å•</strong></p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å¤åˆ¶ <code>log_manager.h</code> å’Œ <code>log_manager.c</code></li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ›´æ–° CMakeLists.txt</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> åŒ…å«å¤´æ–‡ä»¶</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> è°ƒç”¨ <code>log_manager_init()</code> å’Œ <code>log_manager_cleanup()</code></li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æµ‹è¯•åŸºæœ¬å†™å…¥å’Œè¯»å–</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> éªŒè¯æ–‡ä»¶è½®è½¬åŠŸèƒ½</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[web audio apiå‰ç«¯å½•éŸ³ä¸å®æ—¶è¯­éŸ³è½¬å†™æŠ€æœ¯å®ç°]]></title>    <link>https://juejin.cn/post/7603054272159170610</link>    <guid>https://juejin.cn/post/7603054272159170610</guid>    <pubDate>2026-02-05T11:24:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603054272159170610" data-draft-id="7602634187283955722" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="web audio apiå‰ç«¯å½•éŸ³ä¸å®æ—¶è¯­éŸ³è½¬å†™æŠ€æœ¯å®ç°"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,å¼€æº"/> <meta itemprop="datePublished" content="2026-02-05T11:24:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xlybyte"/> <meta itemprop="url" content="https://juejin.cn/user/1082388769678615"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            web audio apiå‰ç«¯å½•éŸ³ä¸å®æ—¶è¯­éŸ³è½¬å†™æŠ€æœ¯å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1082388769678615/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xlybyte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T11:24:25.000Z" title="Thu Feb 05 2026 11:24:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰ç«¯å½•éŸ³ä¸å®æ—¶è¯­éŸ³è½¬å†™æŠ€æœ¯å®ç°</h2>
<h3 data-id="heading-1">ä¸€ã€é¡¹ç›®æ¦‚è¿°</h3>
<p>è¿™æ˜¯ä¸€ä¸ªåŸºäºæµè§ˆå™¨åŸç”Ÿèƒ½åŠ›çš„å‰ç«¯å½•éŸ³å·¥å…·ï¼Œé›†æˆäº†<strong>é˜¿é‡Œäº‘é€šè¯‘å¬æ‚Ÿ</strong>çš„å®æ—¶è¯­éŸ³è½¬å†™ï¼ˆASRï¼‰èƒ½åŠ›ã€‚é¡¹ç›®æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>éŸ³é¢‘å½•åˆ¶</strong>ï¼šä½¿ç”¨ Web Audio API å®ç°é«˜è´¨é‡å½•éŸ³</li>
<li><strong>å®æ—¶è½¬å†™</strong>ï¼šé€šè¿‡ WebSocket å°†éŸ³é¢‘æµå®æ—¶å‘é€åˆ°é˜¿é‡Œäº‘ ASR æœåŠ¡</li>
<li><strong>æ³¢å½¢å¯è§†åŒ–</strong>ï¼šæä¾›é¢‘ç‡æŸ±çŠ¶å›¾</li>
<li><strong>å½•éŸ³æ§åˆ¶</strong>ï¼šæ”¯æŒå¼€å§‹ã€æš‚åœã€ç»§ç»­ã€åœæ­¢ç­‰æ“ä½œ</li>
</ul>
<h3 data-id="heading-2">äºŒã€æŠ€æœ¯æ¶æ„</h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Vue ç»„ä»¶å±‚ (index.vue)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å½•éŸ³æ§åˆ¶   â”‚  â”‚  ASRå±•ç¤º    â”‚  â”‚   WebSocket é€šä¿¡    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚                   â”‚
          â–¼                â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Recorderç±»    â”‚  â”‚ WaveformVisualâ”‚  â”‚   é˜¿é‡Œäº‘ ASR API    â”‚
â”‚  (recorder.js)  â”‚  â”‚  (wave.js)    â”‚  â”‚   (å¬æ‚ŸæœåŠ¡)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Web <span class="hljs-selector-tag">Audio</span> API + getUserMedia                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-3">ä¸‰ã€æ ¸å¿ƒå®ç°åŸç†</h3>
<h4 data-id="heading-4">3.1 éŸ³é¢‘é‡‡é›†åŸç†</h4>
<p>æµè§ˆå™¨å½•éŸ³ä¸»è¦ä¾èµ–ä¸¤ä¸ªæ ¸å¿ƒ APIï¼š</p>




















<table><thead><tr><th>API</th><th>ä½œç”¨</th><th>æµè§ˆå™¨æ”¯æŒ</th></tr></thead><tbody><tr><td><code>getUserMedia</code></td><td>è·å–éº¦å…‹é£éŸ³é¢‘æµ</td><td>æ‰€æœ‰ç°ä»£æµè§ˆå™¨</td></tr><tr><td><code>AudioContext</code></td><td>éŸ³é¢‘å¤„ç†ä¸Šä¸‹æ–‡</td><td>Chrome 35+, Firefox 25+</td></tr></tbody></table>
<p><strong>éŸ³é¢‘å¤„ç†æµç¨‹</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">éº¦å…‹é£ â†’ MediaStream â†’ AudioContext â†’ ScriptProcessorNode â†’ PCMæ•°æ®
<span class="hljs-code">                              â†“
                        AnalyserNode â†’ æ³¢å½¢æ•°æ®
</span></code></pre>
<h4 data-id="heading-5">3.2 Recorder ç±»æ ¸å¿ƒè®¾è®¡</h4>
<p><code>Recorder</code> ç±»æ˜¯æ•´ä¸ªå½•éŸ³åŠŸèƒ½çš„æ ¸å¿ƒï¼Œé‡‡ç”¨äº†<strong>é¢å‘å¯¹è±¡</strong>çš„è®¾è®¡æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Recorder</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-comment">// é…ç½®å‚æ•°</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">sampleBits</span>: <span class="hljs-number">16</span>,        <span class="hljs-comment">// é‡‡æ ·ä½æ•°</span>
      <span class="hljs-attr">sampleRate</span>: <span class="hljs-number">16000</span>,     <span class="hljs-comment">// é‡‡æ ·ç‡ï¼ˆé˜¿é‡Œäº‘ASRæ¨èï¼‰</span>
      <span class="hljs-attr">numChannels</span>: <span class="hljs-number">1</span>,        <span class="hljs-comment">// å£°é“æ•°</span>
      <span class="hljs-attr">compiling</span>: <span class="hljs-literal">true</span>,       <span class="hljs-comment">// è¾¹å½•è¾¹è½¬æ¨¡å¼</span>
    };
  }
}
</code></pre>
<p><strong>å…³é”®æŠ€æœ¯ç‚¹</strong>ï¼š</p>
<h5 data-id="heading-6">1) éŸ³é¢‘èŠ‚ç‚¹åˆ›å»º</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºéŸ³é¢‘åˆ†æèŠ‚ç‚¹</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">analyser</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">createAnalyser</span>();
<span class="hljs-variable language_">this</span>.<span class="hljs-property">analyser</span>.<span class="hljs-property">fftSize</span> = <span class="hljs-number">2048</span>;

<span class="hljs-comment">// åˆ›å»ºè„šæœ¬å¤„ç†èŠ‚ç‚¹ï¼ˆæ¯é‡‡é›†4096ä¸ªæ ·æœ¬è§¦å‘ä¸€æ¬¡ï¼‰</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">recorder</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">createScriptProcessor</span>(<span class="hljs-number">4096</span>, numChannels, numChannels);
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆé€‰æ‹© 4096ï¼Ÿ</strong></p>
<ul>
<li>å¹³è¡¡å»¶è¿Ÿå’Œæ€§èƒ½</li>
<li>4096 æ ·æœ¬ â‰ˆ 95msï¼ˆ44.1kHzé‡‡æ ·ç‡ä¸‹ï¼‰</li>
<li>é€‚åˆå®æ—¶å¤„ç†åœºæ™¯</li>
</ul>
<h5 data-id="heading-7">2) éŸ³é¢‘æ•°æ®é‡‡é›†</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">this</span>.<span class="hljs-property">recorder</span>.<span class="hljs-property">onaudioprocess</span> = <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
  <span class="hljs-comment">// è·å–å·¦å£°é“PCMæ•°æ®ï¼ˆFloat32Arrayï¼ŒèŒƒå›´[-1, 1]ï¼‰</span>
  <span class="hljs-keyword">let</span> lData = e.<span class="hljs-property">inputBuffer</span>.<span class="hljs-title function_">getChannelData</span>(<span class="hljs-number">0</span>);
  
  <span class="hljs-comment">// å­˜å‚¨åŸå§‹æ•°æ®</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">lBuffer</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Float32Array</span>(lData));
  
  <span class="hljs-comment">// è¾¹å½•è¾¹è½¬ï¼šç«‹å³è½¬æ¢ä¸ºPCMæ ¼å¼</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">compiling</span>) {
    <span class="hljs-keyword">let</span> pcm = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">transformIntoPCM</span>(lData, rData);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tempPCM</span>.<span class="hljs-title function_">push</span>(pcm);
  }
};
</code></pre>
<h5 data-id="heading-8">3) PCM ç¼–ç åŸç†</h5>
<p>PCMï¼ˆPulse Code Modulationï¼‰æ˜¯éŸ³é¢‘çš„åŸå§‹æ•°å­—è¡¨ç¤ºå½¢å¼ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">static</span> <span class="hljs-title function_">encodePCM</span>(<span class="hljs-params">bytes, sampleBits, littleEdian = <span class="hljs-literal">true</span></span>) {
  <span class="hljs-comment">// Float32Array [-1, 1] â†’ Int16 [-32768, 32767]</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; bytes.<span class="hljs-property">length</span>; i++, offset += <span class="hljs-number">2</span>) {
    <span class="hljs-keyword">let</span> s = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(-<span class="hljs-number">1</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-number">1</span>, bytes[i]));
    <span class="hljs-comment">// è´Ÿæ•° * 32768ï¼Œæ­£æ•° * 32767</span>
    data.<span class="hljs-title function_">setInt16</span>(offset, s &lt; <span class="hljs-number">0</span> ? s * <span class="hljs-number">0x8000</span> : s * <span class="hljs-number">0x7FFF</span>, littleEdian);
  }
}
</code></pre>




















<table><thead><tr><th>é‡‡æ ·ä½æ•°</th><th>èŒƒå›´</th><th>è®¡ç®—å…¬å¼</th></tr></thead><tbody><tr><td>8-bit</td><td>[0, 255]</td><td><code>val = s * 128 + 128</code></td></tr><tr><td>16-bit</td><td>[-32768, 32767]</td><td><code>val = s * 32768</code> (è´Ÿæ•°) / <code>s * 32767</code> (æ­£æ•°)</td></tr></tbody></table>
<h5 data-id="heading-9">4) WAV æ–‡ä»¶æ ¼å¼</h5>
<p>WAV = WAV Header (44å­—èŠ‚) + PCM æ•°æ®</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">static</span> <span class="hljs-title function_">encodeWAV</span>(<span class="hljs-params">bytes, sampleRate, numChannels, sampleBits</span>) {
  <span class="hljs-keyword">let</span> buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">44</span> + bytes.<span class="hljs-property">byteLength</span>);
  <span class="hljs-keyword">let</span> view = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataView</span>(buffer);
  
  <span class="hljs-comment">// RIFF æ ‡è¯†</span>
  <span class="hljs-title function_">writeString</span>(view, <span class="hljs-number">0</span>, <span class="hljs-string">'RIFF'</span>);
  view.<span class="hljs-title function_">setUint32</span>(<span class="hljs-number">4</span>, <span class="hljs-number">36</span> + bytes.<span class="hljs-property">byteLength</span>, <span class="hljs-literal">true</span>);
  <span class="hljs-title function_">writeString</span>(view, <span class="hljs-number">8</span>, <span class="hljs-string">'WAVE'</span>);
  
  <span class="hljs-comment">// fmt å­å—</span>
  <span class="hljs-title function_">writeString</span>(view, <span class="hljs-number">12</span>, <span class="hljs-string">'fmt '</span>);
  view.<span class="hljs-title function_">setUint32</span>(<span class="hljs-number">16</span>, <span class="hljs-number">16</span>, <span class="hljs-literal">true</span>);        <span class="hljs-comment">// å­å—å¤§å°</span>
  view.<span class="hljs-title function_">setUint16</span>(<span class="hljs-number">20</span>, <span class="hljs-number">1</span>, <span class="hljs-literal">true</span>);         <span class="hljs-comment">// éŸ³é¢‘æ ¼å¼ï¼ˆPCM=1ï¼‰</span>
  view.<span class="hljs-title function_">setUint16</span>(<span class="hljs-number">22</span>, numChannels, <span class="hljs-literal">true</span>);
  view.<span class="hljs-title function_">setUint32</span>(<span class="hljs-number">24</span>, sampleRate, <span class="hljs-literal">true</span>);
  <span class="hljs-comment">// ... æ›´å¤šå¤´éƒ¨ä¿¡æ¯</span>
  
  <span class="hljs-comment">// data å­å—</span>
  <span class="hljs-title function_">writeString</span>(view, <span class="hljs-number">36</span>, <span class="hljs-string">'data'</span>);
  view.<span class="hljs-title function_">setUint32</span>(<span class="hljs-number">40</span>, bytes.<span class="hljs-property">byteLength</span>, <span class="hljs-literal">true</span>);
  
  <span class="hljs-comment">// è¿½åŠ  PCM æ•°æ®</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(buffer);
}
</code></pre>
<h4 data-id="heading-10">3.3 è¾¹å½•è¾¹è½¬å®ç°</h4>
<p><strong>æ ¸å¿ƒæµç¨‹</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">å½•éŸ³å¼€å§‹ â†’ onaudioprocess è§¦å‘ â†’ è½¬æ¢PCM â†’ WebSocketå‘é€ â†’ é˜¿é‡Œäº‘ASR
<span class="hljs-code">              â†“                                            â†“
         æ¯4096æ ·æœ¬è§¦å‘                              è¿”å›è¯†åˆ«ç»“æœ
</span></code></pre>
<p><strong>å…³é”®ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// index.vue ä¸­çš„å¤„ç†</span>
<span class="hljs-title function_">processFn</span>(<span class="hljs-params">params</span>) {
  <span class="hljs-keyword">const</span> newBuff = params.<span class="hljs-property">data</span>[params.<span class="hljs-property">data</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>];  <span class="hljs-comment">// è·å–æœ€æ–°PCMå—</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">wsObj</span>?.<span class="hljs-property">readyState</span> == <span class="hljs-number">1</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsObj</span>.<span class="hljs-title function_">send</span>(newBuff);  <span class="hljs-comment">// å®æ—¶å‘é€</span>
  }
}
</code></pre>
<h4 data-id="heading-11">3.4 é˜¿é‡Œäº‘å®æ—¶ ASR é›†æˆ</h4>
<p><strong>WebSocket é€šä¿¡åè®®</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å»ºç«‹è¿æ¥</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsObj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">wsSrc</span>);  <span class="hljs-comment">// wsSrc ä»é€šä¹‰æ‹¿åˆ°çš„websocketè¿æ¥åœ°å€</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsObj</span>.<span class="hljs-property">binaryType</span> = <span class="hljs-string">"arraybuffer"</span>; <span class="hljs-comment">//ä¼ è¾“çš„æ˜¯ ArrayBuffer ç±»å‹çš„æ•°æ®</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsObj</span>.<span class="hljs-property">onopen</span> = <span class="hljs-keyword">async</span> () =&gt; {
          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">wsObj</span>.<span class="hljs-property">readyState</span> == <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">const</span> params = {
              <span class="hljs-attr">header</span>: {
                <span class="hljs-attr">name</span>: <span class="hljs-string">"StartTranscription"</span>,
                <span class="hljs-attr">namespace</span>: <span class="hljs-string">"SpeechTranscriber"</span>,
              },
              <span class="hljs-attr">payload</span>: { <span class="hljs-attr">format</span>: <span class="hljs-string">"pcm"</span> },
            };
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsObj</span>.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(params));
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"WebSocketè¿æ¥å·²æˆåŠŸæ‰“å¼€"</span>);
            <span class="hljs-title function_">resolve</span>(<span class="hljs-literal">true</span>);
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ([<span class="hljs-number">2</span>, <span class="hljs-number">3</span>].<span class="hljs-title function_">includes</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">wsObj</span>.<span class="hljs-property">readyState</span>)) {
            <span class="hljs-title function_">reject</span>(<span class="hljs-literal">false</span>);
          }
        };
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsObj</span>.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"WebSocketé”™è¯¯:"</span>, err);
          <span class="hljs-title function_">reject</span>(<span class="hljs-literal">false</span>);
        };
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsObj</span>.<span class="hljs-property">onclose</span> = <span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"WebSocketè¿æ¥å·²å…³é—­"</span>);
          <span class="hljs-comment">// reject(false);</span>
          <span class="hljs-built_in">setTimeout</span>( <span class="hljs-function">()=&gt;</span> {  <span class="hljs-comment">// ç®€å•å®ç°è‡ªåŠ¨é‡è¿</span>
              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"WebSocket å°è¯•é‡æ–°è¿æ¥"</span>);
              <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">openWs</span>();
          }, <span class="hljs-number">3</span> * <span class="hljs-number">1000</span>);
        };
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">wsObj</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleMessage</span>(msg);
        };
      });
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. è¿æ¥å»ºç«‹åå‘é€å¼€å§‹æŒ‡ä»¤</span>
<span class="hljs-keyword">const</span> params = {
  <span class="hljs-attr">header</span>: {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"StartTranscription"</span>,
    <span class="hljs-attr">namespace</span>: <span class="hljs-string">"SpeechTranscriber"</span>,
  },
  <span class="hljs-attr">payload</span>: { <span class="hljs-attr">format</span>: <span class="hljs-string">"pcm"</span> },
};
wsObj.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(params));

<span class="hljs-comment">// 2. æŒç»­å‘é€éŸ³é¢‘æ•°æ®</span>
wsObj.<span class="hljs-title function_">send</span>(pcmData);  <span class="hljs-comment">// ArrayBuffer æ ¼å¼</span>

<span class="hljs-comment">// 3. æ¥æ”¶è¯†åˆ«ç»“æœ</span>
wsObj.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> dataJson = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(msg.<span class="hljs-property">data</span>);
  <span class="hljs-keyword">switch</span> (dataJson.<span class="hljs-property">header</span>.<span class="hljs-property">name</span>) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"SentenceBegin"</span>:           <span class="hljs-comment">// å¥å­å¼€å§‹</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">"TranscriptionResultChanged"</span>: <span class="hljs-comment">// å®æ—¶ç»“æœå˜åŒ–</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">"SentenceEnd"</span>:             <span class="hljs-comment">// å¥å­ç»“æŸ</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">"ResultTranslated"</span>:        <span class="hljs-comment">// ç¿»è¯‘ç»“æœ</span>
  }
};
</code></pre>
<p><strong>äº‹ä»¶ç±»å‹è¯´æ˜</strong>ï¼š</p>
<p>æ¥æºäºé€šä¹‰æ–‡æ¡£ï¼Œæœ€æ–°è¯·å‚è€ƒé€šä¹‰æ–‡æ¡£(åœ¨æ–‡æ¡£åº•éƒ¨æœ‰æä¾›åœ°å€)</p>






























<table><thead><tr><th>äº‹ä»¶</th><th>è¯´æ˜</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td><code>SentenceBegin</code></td><td>æ–°å¥å­å¼€å§‹</td><td>åˆå§‹åŒ–æ–°å¥å­å¯¹è±¡</td></tr><tr><td><code>TranscriptionResultChanged</code></td><td>è¯†åˆ«ä¸­ç»“æœå˜åŒ–</td><td>å®æ—¶æ›´æ–°æ˜¾ç¤º</td></tr><tr><td><code>SentenceEnd</code></td><td>å¥å­ç»“æŸ</td><td>åˆå¹¶æœ€ç»ˆç»“æœ</td></tr><tr><td><code>ResultTranslated</code></td><td>ç¿»è¯‘å®Œæˆ</td><td>æ˜¾ç¤ºç¿»è¯‘å†…å®¹</td></tr></tbody></table>
<h4 data-id="heading-12">3.5 æ³¢å½¢å¯è§†åŒ–å®ç°</h4>
<p>é¡¹ç›®æä¾›ä¸¤ç§å¯è§†åŒ–æ–¹å¼ï¼š</p>
<p><strong>1) é¢‘ç‡æŸ±çŠ¶å›¾ (wave.js)</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c74a870cd0f4531a8024a82fcc2f4db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGx5Ynl0ZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770895465&amp;x-signature=qHsNjABXZ29eq%2B0KgXQHgNeiFYk%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">WaveformVisualizer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">canvas, options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span> = canvas;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span> = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>);

    <span class="hljs-comment">// é»˜è®¤é…ç½®</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">barWidth</span>: options.<span class="hljs-property">barWidth</span> || <span class="hljs-number">5</span>,
      <span class="hljs-attr">barSpacing</span>: options.<span class="hljs-property">barSpacing</span> || <span class="hljs-number">2</span>,
      <span class="hljs-attr">minHeight</span>: options.<span class="hljs-property">minHeight</span> || <span class="hljs-number">5</span>, <span class="hljs-comment">// æœ€å°é«˜åº¦ç™¾åˆ†æ¯”</span>
      <span class="hljs-attr">amplification</span>: options.<span class="hljs-property">amplification</span> || <span class="hljs-number">3</span>, <span class="hljs-comment">// æ”¾å¤§å€æ•°</span>
      <span class="hljs-attr">smoothing</span>: options.<span class="hljs-property">smoothing</span> || <span class="hljs-number">0.7</span>, <span class="hljs-comment">// å¹³æ»‘åº¦ (0-1)</span>
      <span class="hljs-attr">barColor</span>: options.<span class="hljs-property">barColor</span> || <span class="hljs-string">'#4d79ff'</span>,
      <span class="hljs-attr">gradientColor</span>: options.<span class="hljs-property">gradientColor</span> || <span class="hljs-string">'#ff4d4d'</span>
    };

    <span class="hljs-comment">// çŠ¶æ€å˜é‡</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">animationId</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentData</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">1024</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">smoothedData</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Float32Array</span>(<span class="hljs-number">1024</span>);

    <span class="hljs-comment">// åˆå§‹åŒ–Canvaså°ºå¯¸</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resizeCanvas</span>();
    <span class="hljs-comment">// window.addEventListener('resize', () =&gt; this.resizeCanvas());</span>
  }

  <span class="hljs-comment">// è°ƒæ•´Canvaså°ºå¯¸</span>
  <span class="hljs-title function_">resizeCanvas</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">width</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">offsetWidth</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">height</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">offsetHeight</span>;
  }

  <span class="hljs-comment">// æ›´æ–°é…ç½®</span>
  <span class="hljs-title function_">updateConfig</span>(<span class="hljs-params">newConfig</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>, ...newConfig };
  }

  <span class="hljs-comment">// è®¾ç½®æ•°æ®</span>
  <span class="hljs-title function_">setData</span>(<span class="hljs-params">dataArray</span>) {
    <span class="hljs-keyword">if</span> (dataArray &amp;&amp; dataArray.<span class="hljs-property">length</span> === <span class="hljs-number">1024</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentData</span> = dataArray;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentData</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">1024</span>);
    }
  }

  <span class="hljs-comment">// å¤„ç†æ•°æ® - å¢å¼ºæ³¢åŠ¨æ•ˆæœ</span>
  <span class="hljs-title function_">processData</span>(<span class="hljs-params">dataArray</span>) {
    <span class="hljs-keyword">const</span> { amplification, smoothing } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;
    <span class="hljs-keyword">const</span> processedData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">1024</span>);

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; dataArray.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-comment">// åº”ç”¨æ”¾å¤§å€æ•°</span>
      <span class="hljs-keyword">let</span> value = dataArray[i] * amplification;

      <span class="hljs-comment">// åº”ç”¨å¹³æ»‘å¤„ç†</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">smoothedData</span>[i] = smoothing * <span class="hljs-variable language_">this</span>.<span class="hljs-property">smoothedData</span>[i] + (<span class="hljs-number">1</span> - smoothing) * value;

      <span class="hljs-comment">// ç¡®ä¿å€¼åœ¨0-255èŒƒå›´å†…</span>
      processedData[i] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-number">255</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">smoothedData</span>[i]));
    }

    <span class="hljs-keyword">return</span> processedData;
  }

  <span class="hljs-comment">// ç»˜åˆ¶æ³¢å½¢</span>
  <span class="hljs-title function_">draw</span>(<span class="hljs-params">dataArray = <span class="hljs-variable language_">this</span>.currentData</span>) {
    <span class="hljs-keyword">const</span> { barWidth, barSpacing, minHeight, barColor, gradientColor } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;
    <span class="hljs-keyword">const</span> ctx = <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>;
    <span class="hljs-keyword">const</span> centerY = <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">height</span> / <span class="hljs-number">2</span>;

    <span class="hljs-comment">// æ¸…é™¤ç”»å¸ƒ</span>
    ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">width</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">height</span>);

    <span class="hljs-comment">// ç»˜åˆ¶ä¸­å¿ƒçº¿</span>
    ctx.<span class="hljs-title function_">beginPath</span>();
    ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">0</span>, centerY);
    ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">width</span>, centerY);
    ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">'rgba(255, 255, 255, 0.2)'</span>;
    ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">1</span>;
    ctx.<span class="hljs-title function_">stroke</span>();

    <span class="hljs-comment">// è®¡ç®—æ¯ä¸ªæŸ±å­çš„æ€»å®½åº¦ï¼ˆæŸ±å­å®½åº¦+é—´è·ï¼‰</span>
    <span class="hljs-keyword">const</span> totalBarWidth = barWidth + barSpacing;

    <span class="hljs-comment">// è®¡ç®—å¯ä»¥ç»˜åˆ¶çš„æŸ±å­æ•°é‡</span>
    <span class="hljs-keyword">const</span> maxBars = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">width</span> / totalBarWidth);

    <span class="hljs-comment">// åˆ›å»ºæ¸å˜</span>
    <span class="hljs-keyword">const</span> gradient = ctx.<span class="hljs-title function_">createLinearGradient</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">width</span>, <span class="hljs-number">0</span>);  <span class="hljs-comment">// æ°´å¹³æ–¹å‘</span>
    gradient.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, barColor);
    gradient.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0.5</span>, gradientColor);
    gradient.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, barColor);

    <span class="hljs-comment">// è®¡ç®—æœ€å°é«˜åº¦ï¼ˆåŸºäºç”»å¸ƒé«˜åº¦çš„ç™¾åˆ†æ¯”ï¼‰</span>
    <span class="hljs-keyword">const</span> minHeightPixels = (minHeight / <span class="hljs-number">100</span>) * centerY;

    <span class="hljs-comment">// å¤„ç†æ•°æ®ä»¥å¢å¼ºæ³¢åŠ¨æ•ˆæœ</span>
    <span class="hljs-keyword">const</span> processedData = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processData</span>(dataArray);

    <span class="hljs-comment">// ç»˜åˆ¶æŸ±å­  æ°´å¹³æ–¹å‘æ¸å˜</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; maxBars &amp;&amp; i &lt; processedData.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-comment">// è®¡ç®—æŸ±å­çš„xä½ç½®</span>
      <span class="hljs-keyword">const</span> x = i * totalBarWidth;

      <span class="hljs-comment">// è·å–å¤„ç†åçš„æ•°æ®å€¼</span>
      <span class="hljs-keyword">const</span> value = processedData[i];

      <span class="hljs-comment">// è®¡ç®—å®é™…é«˜åº¦ï¼Œç¡®ä¿ä¸ä½äºæœ€å°é«˜åº¦</span>
      <span class="hljs-keyword">const</span> dynamicHeight = (value / <span class="hljs-number">255</span>) * (centerY - <span class="hljs-number">20</span>);
      <span class="hljs-keyword">const</span> height = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(minHeightPixels, dynamicHeight);

      <span class="hljs-comment">// ç»˜åˆ¶ä¸Šä¸‹å¯¹ç§°çš„æŸ±å­</span>
      ctx.<span class="hljs-property">fillStyle</span> = gradient;
      ctx.<span class="hljs-title function_">fillRect</span>(x, centerY - height, barWidth, height * <span class="hljs-number">2</span>);
    }
  }

  <span class="hljs-comment">// å¼€å§‹ç»˜åˆ¶</span>
  <span class="hljs-title function_">start</span>(<span class="hljs-params">dataGenerator, interval = <span class="hljs-number">100</span></span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span>) <span class="hljs-keyword">return</span>;

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">drawFrame</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span>) <span class="hljs-keyword">return</span>;

      <span class="hljs-comment">// è·å–æ•°æ®å¹¶ç»˜åˆ¶</span>
      <span class="hljs-keyword">const</span> data = <span class="hljs-title function_">dataGenerator</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(data);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">draw</span>(data);

      <span class="hljs-comment">// ç»§ç»­åŠ¨ç”»</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">animationId</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">requestAnimationFrame</span>(drawFrame);
      }, interval);
    };

    <span class="hljs-title function_">drawFrame</span>();
  }

  <span class="hljs-comment">// åœæ­¢ç»˜åˆ¶</span>
  <span class="hljs-title function_">stop</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">animationId</span>) {
      <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">animationId</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">animationId</span> = <span class="hljs-literal">null</span>;
    }

    <span class="hljs-comment">// æ¸…é™¤ç”»å¸ƒ</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">width</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">height</span>);

    <span class="hljs-comment">// ç»˜åˆ¶åœæ­¢çŠ¶æ€æ–‡æœ¬</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">'rgba(255, 255, 255, 0.7)'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-property">font</span> = <span class="hljs-string">'24px Arial'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-property">textAlign</span> = <span class="hljs-string">'center'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-title function_">fillText</span>(<span class="hljs-string">'å·²åœæ­¢ç»˜åˆ¶'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">width</span> / <span class="hljs-number">2</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">height</span> / <span class="hljs-number">2</span>);
  }
}

<span class="hljs-comment">// æ¨¡æ‹Ÿå½•éŸ³æ•°æ®ç”Ÿæˆå™¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createDataGenerator</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">let</span> frameCount = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> dataArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">1024</span>);

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; dataArray.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-comment">// åŸºç¡€å™ªå£°</span>
      <span class="hljs-keyword">let</span> value = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">20</span>;

      <span class="hljs-comment">// æ·»åŠ ä¸€äº›å‘¨æœŸæ€§æ³¢å½¢</span>
      value += <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(i / <span class="hljs-number">20</span> + frameCount / <span class="hljs-number">20</span>) * <span class="hljs-number">30</span>;
      value += <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(i / <span class="hljs-number">5</span> + frameCount / <span class="hljs-number">10</span>) * <span class="hljs-number">10</span>;

      <span class="hljs-comment">// éšæœºå³°å€¼</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &gt; <span class="hljs-number">0.97</span>) {
        value += <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">100</span>;
      }

      <span class="hljs-comment">// ç¡®ä¿å€¼åœ¨0-255èŒƒå›´å†…</span>
      dataArray[i] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-number">255</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, value));
    }

    frameCount++;
    <span class="hljs-keyword">return</span> dataArray;
  };
}

<span class="hljs-comment">// æ— å£°æ•°æ®ç”Ÿæˆå™¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createSilenceDataGenerator</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-comment">// è¿”å›å…¨0æ•°ç»„æ¨¡æ‹Ÿæ— å£°</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">1024</span>);
  };
}

<span class="hljs-keyword">export</span> {
  <span class="hljs-title class_">WaveformVisualizer</span>,
  createDataGenerator,
  createSilenceDataGenerator
}
</code></pre>
<p><strong>2) æ—¶åŸŸæ³¢å½¢ (waveTimeDomain.js)</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">draw</span>(<span class="hljs-params">dataArray</span>) {
  <span class="hljs-comment">// è½¬æ¢æ•°æ®èŒƒå›´ [0, 255] â†’ [-1, 1]</span>
  <span class="hljs-keyword">let</span> value = (dataArray[i] - <span class="hljs-number">128</span>) / <span class="hljs-number">128</span>;
  
  <span class="hljs-comment">// ç»˜åˆ¶è¿ç»­æ³¢å½¢çº¿</span>
  ctx.<span class="hljs-title function_">beginPath</span>();
  ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">0</span>, firstY);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; processedData.<span class="hljs-property">length</span>; i++) {
    ctx.<span class="hljs-title function_">lineTo</span>(x, y);
  }
  ctx.<span class="hljs-title function_">stroke</span>();
}
</code></pre>
<h3 data-id="heading-13">å››ã€ä½¿ç”¨æ­¥éª¤</h3>
<h4 data-id="heading-14">4.1 åŸºç¡€å½•éŸ³</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Recorder</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"js-audio-recorder"</span>;

<span class="hljs-comment">// 1. åˆ›å»ºå®ä¾‹</span>
<span class="hljs-keyword">const</span> recorder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Recorder</span>({
  <span class="hljs-attr">sampleRate</span>: <span class="hljs-number">16000</span>,
  <span class="hljs-attr">sampleBits</span>: <span class="hljs-number">16</span>,
  <span class="hljs-attr">numChannels</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">compiling</span>: <span class="hljs-literal">true</span>,  <span class="hljs-comment">// å¼€å¯è¾¹å½•è¾¹è½¬</span>
});

<span class="hljs-comment">// 2. ç›‘å¬å¤„ç†äº‹ä»¶</span>
recorder.<span class="hljs-property">onprogress</span> = <span class="hljs-function">(<span class="hljs-params">{ duration, fileSize, vol, data }</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å½•éŸ³æ—¶é•¿: <span class="hljs-subst">${duration}</span>ç§’`</span>);
};

<span class="hljs-comment">// 3. å¼€å§‹å½•éŸ³</span>
<span class="hljs-keyword">await</span> recorder.<span class="hljs-title function_">start</span>();

<span class="hljs-comment">// 4. æš‚åœ/ç»§ç»­</span>
recorder.<span class="hljs-title function_">pause</span>();
recorder.<span class="hljs-title function_">resume</span>();

<span class="hljs-comment">// 5. åœæ­¢å¹¶è·å–WAV</span>
recorder.<span class="hljs-title function_">stop</span>();
<span class="hljs-keyword">const</span> blob = recorder.<span class="hljs-title function_">getWAVBlob</span>();

<span class="hljs-comment">// 6. é”€æ¯</span>
<span class="hljs-keyword">await</span> recorder.<span class="hljs-title function_">destroy</span>();
</code></pre>
<h4 data-id="heading-15">4.2 é›†æˆå®æ—¶è½¬å†™</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. å»ºç«‹WebSocketè¿æ¥</span>
<span class="hljs-keyword">const</span> ws = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">'wss://your-asr-service.com'</span>);
ws.<span class="hljs-property">binaryType</span> = <span class="hljs-string">'arraybuffer'</span>;

<span class="hljs-comment">// 2. å‘é€å¼€å§‹æŒ‡ä»¤</span>
ws.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
  <span class="hljs-attr">header</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">"StartTranscription"</span>, <span class="hljs-attr">namespace</span>: <span class="hljs-string">"SpeechTranscriber"</span> },
  <span class="hljs-attr">payload</span>: { <span class="hljs-attr">format</span>: <span class="hljs-string">"pcm"</span> }
}));

<span class="hljs-comment">// 3. å®æ—¶å‘é€éŸ³é¢‘</span>
recorder.<span class="hljs-property">onprogress</span> = <span class="hljs-function">(<span class="hljs-params">{ data }</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> latestPCM = data[data.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>];
  ws.<span class="hljs-title function_">send</span>(latestPCM);
};

<span class="hljs-comment">// 4. æ¥æ”¶è¯†åˆ«ç»“æœ</span>
ws.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(msg.<span class="hljs-property">data</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result.<span class="hljs-property">payload</span>.<span class="hljs-property">result</span>);
};
</code></pre>
<h3 data-id="heading-16">äº”ã€æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</h3>
<h4 data-id="heading-17">5.1 é‡‡æ ·ç‡å‹ç¼©</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">static</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">data, inputSampleRate, outputSampleRate</span>) {
  <span class="hljs-keyword">const</span> rate = inputSampleRate / outputSampleRate;
  <span class="hljs-comment">// 48kHz â†’ 16kHzï¼šæ¯éš”3ä¸ªæ ·æœ¬å–1ä¸ª</span>
  <span class="hljs-keyword">while</span> (index &lt; length) {
    result[index] = lData[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(j)];
    j += rate;
  }
}
</code></pre>
<h4 data-id="heading-18">5.2 å†…å­˜ç®¡ç†</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å½•éŸ³ç»“æŸååŠæ—¶æ¸…ç†</span>
<span class="hljs-title function_">clear</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">lBuffer</span>.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">rBuffer</span>.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">PCM</span> = <span class="hljs-literal">null</span>;
}

<span class="hljs-comment">// é”€æ¯æ—¶å…³é—­éŸ³é¢‘ä¸Šä¸‹æ–‡</span>
<span class="hljs-title function_">destroy</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">stopStream</span>();  <span class="hljs-comment">// åœæ­¢åª’ä½“æµ</span>
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">closeAudioContext</span>();  <span class="hljs-comment">// å…³é—­éŸ³é¢‘ä¸Šä¸‹æ–‡</span>
}
</code></pre>
<h4 data-id="heading-19">5.3 æ³¢å½¢ç»˜åˆ¶ä¼˜åŒ–</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç®€åŒ–ç»˜åˆ¶ï¼šå‡å°‘æ•°æ®ç‚¹</span>
<span class="hljs-keyword">const</span> step = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(processedData.<span class="hljs-property">length</span> / (<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">width</span> / <span class="hljs-number">2</span>));
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; processedData.<span class="hljs-property">length</span>; i += step) {
  <span class="hljs-comment">// åªç»˜åˆ¶å…³é”®å¸§</span>
}
</code></pre>
<h3 data-id="heading-20">å…­ã€æµè§ˆå™¨å…¼å®¹æ€§</h3>








































<table><thead><tr><th>ç‰¹æ€§</th><th>Chrome</th><th>Firefox</th><th>Safari</th><th>Edge</th></tr></thead><tbody><tr><td>getUserMedia</td><td>49+</td><td>44+</td><td>11+</td><td>79+</td></tr><tr><td>AudioContext</td><td>35+</td><td>25+</td><td>14.1+</td><td>79+</td></tr><tr><td>ScriptProcessorNode</td><td>14+</td><td>23+</td><td>6+</td><td>12+</td></tr><tr><td>WebSocket</td><td>16+</td><td>11+</td><td>7.1+</td><td>12+</td></tr></tbody></table>
<p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p>
<ul>
<li>Safari éœ€è¦ HTTPS ç¯å¢ƒ</li>
<li>iOS Safari æœ‰ç‰¹æ®Šçš„éŸ³é¢‘ç­–ç•¥</li>
<li>éƒ¨åˆ†æµè§ˆå™¨éœ€è¦ç”¨æˆ·äº¤äº’åæ‰èƒ½å½•éŸ³</li>
</ul>
<p>æœ¬åœ°å¼€å‘æ—¶è§£å†³éhttpsä¸å…è®¸å½•éŸ³é—®é¢˜</p>
<p>ç”±äºchromeé™åˆ¶ï¼Œå› å®‰å…¨åŸå› ï¼Œä¸å…è®¸éå®‰å…¨ç¯å¢ƒä¸‹ä½¿ç”¨å½•éŸ³æƒé™ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡é…ç½®chromeæ¥è§£å†³
æµè§ˆå™¨åœ°å€æ è¾“å…¥<code>chrome://flags/#unsafely-treat-insecure-origin-as-secure</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a58654e960404f60982e1dfecdf5040a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGx5Ynl0ZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770895465&amp;x-signature=Oq2e49BVleIlCRlGv2oyJOFWcvI%3D" alt="image.png" loading="lazy"/>
å¯ç”¨åï¼Œé‡å¯æµè§ˆå™¨å³å¯è§£å†³</p>
<h3 data-id="heading-21">ä¸ƒã€æ€»ç»“</h3>
<p>è¿™ä¸ªé¡¹ç›®å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æµè§ˆå™¨åŸç”Ÿèƒ½åŠ›æ„å»ºä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„å½•éŸ³å·¥å…·ï¼š</p>
<ol>
<li><strong>Web Audio API</strong> æä¾›å¼ºå¤§çš„éŸ³é¢‘å¤„ç†èƒ½åŠ›</li>
<li><strong>è¾¹å½•è¾¹è½¬</strong> æ¨¡å¼å®ç°å®æ—¶è¯­éŸ³è¯†åˆ«</li>
<li><strong>WebSocket</strong> å®ç°ä½å»¶è¿Ÿçš„åŒå‘é€šä¿¡</li>
<li><strong>Canvas</strong> å®ç°æµç•…çš„æ³¢å½¢å¯è§†åŒ–</li>
</ol>
<p><strong>å…³é”®æŠ€æœ¯è¦ç‚¹</strong>ï¼š</p>
<ul>
<li>PCM æ•°æ®çš„ç¼–ç ä¸æ ¼å¼è½¬æ¢</li>
<li>éŸ³é¢‘èŠ‚ç‚¹çš„è¿æ¥ä¸æ•°æ®æµè½¬</li>
<li>é˜¿é‡Œäº‘ ASR åè®®çš„æ­£ç¡®å®ç°</li>
<li>å†…å­˜ç®¡ç†å’Œæ€§èƒ½ä¼˜åŒ–</li>
</ul>
<hr/>
<p><strong>å‚è€ƒé“¾æ¥</strong>ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FWeb_Audio_API" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/Web_Audio_API" ref="nofollow noopener noreferrer">Web Audio API æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhelp.aliyun.com%2Fzh%2Ftingwu%2Finterface-and-implementation" target="_blank" title="https://help.aliyun.com/zh/tingwu/interface-and-implementation" ref="nofollow noopener noreferrer">é˜¿é‡Œäº‘å¬æ‚Ÿæ¥å£æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fjs-audio-recorder" target="_blank" title="https://www.npmjs.com/package/js-audio-recorder" ref="nofollow noopener noreferrer">js-audio-recorder - npm</a>record.jsç¬¬ä¸‰æ–¹åº“æ¨è</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨Vue3é¡¹ç›®ä¸­å¦‚ä½•å–æ¶ˆé‡å¤è¯·æ±‚ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7603183929251708980</link>    <guid>https://juejin.cn/post/7603183929251708980</guid>    <pubDate>2026-02-05T12:03:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603183929251708980" data-draft-id="7602991346585714722" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨Vue3é¡¹ç›®ä¸­å¦‚ä½•å–æ¶ˆé‡å¤è¯·æ±‚ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2026-02-05T12:03:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·3905133219288"/> <meta itemprop="url" content="https://juejin.cn/user/3609051079121550"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨Vue3é¡¹ç›®ä¸­å¦‚ä½•å–æ¶ˆé‡å¤è¯·æ±‚ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3609051079121550/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·3905133219288
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T12:03:36.000Z" title="Thu Feb 05 2026 12:03:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä»Šå¤©æˆ‘ä»¬æ¥èŠèŠä¸€ä¸ªå®é™…å¼€å‘ä¸­å¸¸è§çš„é—®é¢˜ï¼šåœ¨Vue3é¡¹ç›®ä¸­ï¼Œå¦‚ä½•å–æ¶ˆé‡å¤çš„è¯·æ±‚ã€‚</p>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆéœ€è¦å–æ¶ˆé‡å¤è¯·æ±‚ï¼Ÿ</h2>
<p>è¿™æ ·åšæœ‰å‡ ä¸ªæ˜æ˜¾çš„å¥½å¤„ï¼š</p>
<ol>
<li>Â <strong>èŠ‚çœèµ„æº</strong>ï¼šé‡Šæ”¾æµè§ˆå™¨è¿æ¥ï¼Œå‡è½»æœåŠ¡å™¨å‹åŠ›ã€‚</li>
<li>Â <strong>ä¿è¯æ•°æ®æ­£ç¡®æ€§</strong>ï¼šé¿å…å› è¯·æ±‚å“åº”é¡ºåºé”™ä¹±å¯¼è‡´é¡µé¢æ˜¾ç¤ºæ—§æ•°æ®ã€‚</li>
<li>Â <strong>æå‡ç”¨æˆ·ä½“éªŒ</strong>ï¼šé˜²æ­¢æ— æ•ˆè¯·æ±‚é˜»å¡åç»­æœ‰æ•ˆæ“ä½œã€‚</li>
</ol>
<p>åœ¨Vue3çš„ç”Ÿæ€ä¸­ï¼Œæˆ‘ä»¬æœ€å¸¸ç”¨çš„HTTPå®¢æˆ·ç«¯æ˜¯Â <code>axios</code>ã€‚å› æ­¤ï¼Œæœ¬æ–‡çš„æ ¸å¿ƒå°†å›´ç»•å¦‚ä½•ä½¿ç”¨Â <code>axios</code>Â çš„å–æ¶ˆä»¤ç‰Œï¼ˆCancelTokenï¼‰åŠå…¶æ›´ç°ä»£çš„æ›¿ä»£å“â€”â€”AbortControllerâ€”â€”æ¥å®ç°è¯·æ±‚å–æ¶ˆã€‚</p>
<hr/>
<h2 data-id="heading-1">æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ Axios çš„ CancelToken</h2>
<p><code>axios</code>Â ä»å¾ˆæ—©å°±æ”¯æŒé€šè¿‡Â <code>CancelToken</code>Â æ¥å–æ¶ˆè¯·æ±‚ã€‚è™½ç„¶å®ƒåœ¨Â <code>axios</code>Â v0.22.0 ä¹‹åè¢«æ ‡è®°ä¸ºå·²å¼ƒç”¨ï¼Œè½¬è€Œæ¨èä½¿ç”¨æ ‡å‡†çš„Â <code>AbortController</code>ï¼Œä½†å¾ˆå¤šç°æœ‰é¡¹ç›®ä»åœ¨ä½¿ç”¨è¿™ä¸ªAPIï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰å¿…è¦äº†è§£ä¸€ä¸‹ã€‚
å®ƒçš„å·¥ä½œåŸç†æ˜¯ï¼šåˆ›å»ºä¸€ä¸ªâ€œå–æ¶ˆä»¤ç‰Œâ€çš„æºï¼ˆsourceï¼‰ï¼Œå°†è¿™ä¸ªä»¤ç‰Œé…ç½®åˆ°è¯·æ±‚ä¸­ã€‚å½“æˆ‘ä»¬éœ€è¦å–æ¶ˆè¯·æ±‚æ—¶ï¼Œè°ƒç”¨è¿™ä¸ªæºçš„Â <code>cancel</code>Â æ–¹æ³•ã€‚</p>
<h3 data-id="heading-2">åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span>Â axiosÂ <span class="hljs-keyword">from</span>Â <span class="hljs-string">'axios'</span>;

<span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ª CancelToken Source</span>
<span class="hljs-keyword">const</span>Â source = axios.<span class="hljs-property">CancelToken</span>.<span class="hljs-title function_">source</span>();

<span class="hljs-comment">// 2. å‘èµ·è¯·æ±‚ï¼Œå¹¶é…ç½® cancelToken</span>
axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/user/123'</span>, {
Â  <span class="hljs-attr">cancelToken</span>: source.<span class="hljs-property">token</span>
}).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span>Â =&gt;</span>Â {
Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">data</span>);
}).<span class="hljs-keyword">catch</span>(<span class="hljs-keyword">function</span>Â (<span class="hljs-params">thrown</span>) {
Â  <span class="hljs-comment">// åˆ¤æ–­é”™è¯¯æ˜¯å¦æ˜¯å› ä¸ºè¯·æ±‚è¢«å–æ¶ˆ</span>
Â  <span class="hljs-keyword">if</span>Â (axios.<span class="hljs-title function_">isCancel</span>(thrown)) {
Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¯·æ±‚è¢«å–æ¶ˆ:'</span>, thrown.<span class="hljs-property">message</span>);
Â  }Â <span class="hljs-keyword">else</span>Â {
Â  Â  <span class="hljs-comment">// å¤„ç†å…¶ä»–é”™è¯¯</span>
Â  }
});

<span class="hljs-comment">// 3. åœ¨éœ€è¦çš„æ—¶å€™å–æ¶ˆè¯·æ±‚</span>
source.<span class="hljs-title function_">cancel</span>(<span class="hljs-string">'æ“ä½œè¢«ç”¨æˆ·å–æ¶ˆ'</span>);
</code></pre>
<h3 data-id="heading-3">åœ¨Vue3ç»„ä»¶ä¸­ç®¡ç†é‡å¤è¯·æ±‚</h3>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦ä¸€ç§æœºåˆ¶æ¥ç®¡ç†â€œåŒä¸€ä¸ªâ€é‡å¤è¯·æ±‚ã€‚ä¸€ä¸ªå¸¸è§çš„æ€è·¯æ˜¯ï¼š<strong>å°†æ¯ä¸ªè¯·æ±‚çš„å”¯ä¸€æ ‡è¯†ï¼ˆä¾‹å¦‚ï¼šè¯·æ±‚æ–¹æ³•+URLï¼‰å’Œä¸€ä¸ªå–æ¶ˆå‡½æ•°å…³è”èµ·æ¥ï¼Œåœ¨å‘èµ·æ–°è¯·æ±‚å‰ï¼Œæ£€æŸ¥å¹¶å–æ¶ˆæ—§çš„ã€æœªå®Œæˆçš„ç›¸åŒè¯·æ±‚ã€‚</strong></p>
<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Vue3çš„å“åº”å¼ç³»ç»Ÿå’Œç»„åˆå¼APIï¼Œå°è£…ä¸€ä¸ªå¯å¤ç”¨çš„é€»è¾‘ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç”¨äºå­˜å‚¨æ‰€æœ‰è¿›è¡Œä¸­è¯·æ±‚çš„Mapï¼Œä»¥åŠç›¸å…³çš„æ“ä½œå‡½æ•°ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// utils/request.js</span>
<span class="hljs-keyword">import</span>Â axiosÂ <span class="hljs-keyword">from</span>Â <span class="hljs-string">'axios'</span>;

<span class="hljs-comment">// å­˜å‚¨æ‰€æœ‰è¿›è¡Œä¸­è¯·æ±‚çš„Map</span>
<span class="hljs-keyword">const</span>Â pendingRequestMap =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Map</span>();

<span class="hljs-comment">/**
Â * ç”Ÿæˆè¯·æ±‚çš„å”¯ä¸€æ ‡è¯†é”®
Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">*</span>} config axiosçš„è¯·æ±‚é…ç½®å¯¹è±¡
Â *Â <span class="hljs-doctag">@returns</span>Â {<span class="hljs-type">string</span>} å”¯ä¸€é”®
Â */</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">generateReqKey</span>(<span class="hljs-params">config</span>) {
Â  <span class="hljs-keyword">const</span>Â { method, url, params, data } = config;
Â  <span class="hljs-comment">// ç®€å•æ‹¼æ¥ï¼Œå¯æ ¹æ®ä¸šåŠ¡å¤æ‚åŒ–ï¼ˆå¦‚å¯¹dataæ’åºï¼‰</span>
Â  <span class="hljs-keyword">return</span>Â [method, url,Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(params),Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data)].<span class="hljs-title function_">join</span>(<span class="hljs-string">'&amp;'</span>);
}

<span class="hljs-comment">/**
Â * æ·»åŠ è¯·æ±‚åˆ°ç­‰å¾…é˜Ÿåˆ—
Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">*</span>} config axiosçš„è¯·æ±‚é…ç½®å¯¹è±¡
Â */</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">addPendingRequest</span>(<span class="hljs-params">config</span>) {
Â  <span class="hljs-keyword">const</span>Â requestKey =Â <span class="hljs-title function_">generateReqKey</span>(config);
Â  <span class="hljs-comment">// ä¸ºè¿™ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªå–æ¶ˆä»¤ç‰Œæº</span>
Â  config.<span class="hljs-property">cancelToken</span>Â = config.<span class="hljs-property">cancelToken</span>Â ||Â <span class="hljs-keyword">new</span>Â axios.<span class="hljs-title class_">CancelToken</span>(<span class="hljs-function">(<span class="hljs-params">cancel</span>) =&gt;</span>Â {
Â  Â  <span class="hljs-comment">// å¦‚æœMapä¸­è¿˜æ²¡æœ‰è¿™ä¸ªkeyï¼Œåˆ™æ·»åŠ è¿›å»</span>
Â  Â  <span class="hljs-keyword">if</span>Â (!pendingRequestMap.<span class="hljs-title function_">has</span>(requestKey)) {
Â  Â  Â  pendingRequestMap.<span class="hljs-title function_">set</span>(requestKey, cancel);
Â  Â  }
Â  });
}

<span class="hljs-comment">/**
Â * ç§»é™¤ç­‰å¾…é˜Ÿåˆ—ä¸­çš„è¯·æ±‚
Â *Â <span class="hljs-doctag">@param</span>Â {<span class="hljs-type">*</span>} config axiosçš„è¯·æ±‚é…ç½®å¯¹è±¡
Â */</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">removePendingRequest</span>(<span class="hljs-params">config</span>) {
Â  <span class="hljs-keyword">const</span>Â requestKey =Â <span class="hljs-title function_">generateReqKey</span>(config);
Â  <span class="hljs-keyword">if</span>Â (pendingRequestMap.<span class="hljs-title function_">has</span>(requestKey)) {
Â  Â  <span class="hljs-comment">// å¦‚æœåœ¨Mapä¸­å­˜åœ¨è¿™ä¸ªè¯·æ±‚ï¼Œè¯´æ˜å®ƒè¿˜æœªå®Œæˆï¼Œå°†å…¶å–æ¶ˆå¹¶ä»Mapä¸­ç§»é™¤</span>
Â  Â  <span class="hljs-keyword">const</span>Â cancel = pendingRequestMap.<span class="hljs-title function_">get</span>(requestKey);
Â  Â  <span class="hljs-title function_">cancel</span>(requestKey);Â <span class="hljs-comment">// å–æ¶ˆè¯·æ±‚ï¼Œå¯ä»¥ä¼ é€’æ¶ˆæ¯</span>
Â  Â  pendingRequestMap.<span class="hljs-title function_">delete</span>(requestKey);
Â  }
}

<span class="hljs-comment">// åˆ›å»ºaxioså®ä¾‹</span>
<span class="hljs-keyword">const</span>Â service = axios.<span class="hljs-title function_">create</span>({
Â  <span class="hljs-attr">timeout</span>:Â <span class="hljs-number">10000</span>,
});

<span class="hljs-comment">// è¯·æ±‚æ‹¦æˆªå™¨ï¼šåœ¨è¯·æ±‚å‘å‡ºå‰ï¼Œæ£€æŸ¥å¹¶å–æ¶ˆé‡å¤è¯·æ±‚</span>
service.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(
Â  <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span>Â {
Â  Â  <span class="hljs-comment">// æ£€æŸ¥å¹¶å–æ¶ˆä¹‹å‰çš„ç›¸åŒè¯·æ±‚</span>
Â  Â  <span class="hljs-title function_">removePendingRequest</span>(config);
Â  Â  <span class="hljs-comment">// å°†å½“å‰è¯·æ±‚æ·»åŠ åˆ°ç­‰å¾…é˜Ÿåˆ—</span>
Â  Â  <span class="hljs-title function_">addPendingRequest</span>(config);
Â  Â  <span class="hljs-keyword">return</span>Â config;
Â  },
Â  <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span>Â {
Â  Â  <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
Â  }
);

<span class="hljs-comment">// å“åº”æ‹¦æˆªå™¨ï¼šè¯·æ±‚å®Œæˆåï¼ˆæ— è®ºæˆåŠŸå¤±è´¥ï¼‰ï¼Œå°†å…¶ä»ç­‰å¾…é˜Ÿåˆ—ä¸­ç§»é™¤</span>
service.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(
Â  <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span>Â {
Â  Â  <span class="hljs-title function_">removePendingRequest</span>(response.<span class="hljs-property">config</span>);
Â  Â  <span class="hljs-keyword">return</span>Â response;
Â  },
Â  <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span>Â {
Â  Â  <span class="hljs-comment">// å¦‚æœé”™è¯¯æ˜¯å› ä¸ºå–æ¶ˆè¯·æ±‚é€ æˆçš„ï¼Œæˆ‘ä»¬é€‰æ‹©å¿½ç•¥è¿™ä¸ªé”™è¯¯ï¼Œä¸æŠ›å‡ºåˆ°ä¸šåŠ¡å±‚</span>
Â  Â  <span class="hljs-keyword">if</span>Â (axios.<span class="hljs-title function_">isCancel</span>(error)) {
Â  Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å·²å–æ¶ˆçš„é‡å¤è¯·æ±‚:'</span>, error.<span class="hljs-property">message</span>);
Â  Â  Â  <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Promise</span>(<span class="hljs-function">() =&gt;</span>Â {});Â <span class="hljs-comment">// è¿”å›ä¸€ä¸ªâ€œæ°¸è¿œpendingâ€çš„Promiseï¼Œä¸­æ–­Promiseé“¾</span>
Â  Â  }
Â  Â  <span class="hljs-comment">// å¯¹äºå…¶ä»–é”™è¯¯ï¼Œç§»é™¤è¯·æ±‚å¹¶æ­£å¸¸æŠ›å‡º</span>
Â  Â  <span class="hljs-title function_">removePendingRequest</span>(error.<span class="hljs-property">config</span>Â || {});
Â  Â  <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
Â  }
);

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â service;
</code></pre>
<p>ç„¶åï¼Œåœ¨Vueç»„ä»¶ä¸­ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªå°è£…å¥½çš„Â <code>service</code>Â æ¥å‘èµ·è¯·æ±‚ã€‚å®ƒä¼šè‡ªåŠ¨å¤„ç†é‡å¤è¯·æ±‚çš„å–æ¶ˆã€‚</p>
<pre><code class="hljs language-ini" lang="ini">&lt;script setup&gt;
importÂ { ref }Â fromÂ 'vue'<span class="hljs-comment">;</span>
importÂ requestÂ fromÂ '@/utils/request'<span class="hljs-comment">;</span>

constÂ <span class="hljs-attr">searchResults</span> =Â ref([])<span class="hljs-comment">;</span>
constÂ <span class="hljs-attr">loading</span> =Â ref(<span class="hljs-literal">false</span>)<span class="hljs-comment">;</span>

constÂ <span class="hljs-attr">handleSearch</span>Â =Â asyncÂ (keyword) =&gt; {
Â  <span class="hljs-attr">loading.value</span>Â =Â <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
Â  tryÂ {
Â  Â  constÂ <span class="hljs-attr">response</span> =Â awaitÂ request.get(<span class="hljs-string">'/api/search'</span>, {
Â  Â  Â  params: { keyword }
Â  Â  })<span class="hljs-comment">;</span>
Â  Â  <span class="hljs-attr">searchResults.value</span>Â = response.data<span class="hljs-comment">;</span>
Â  }Â catchÂ (error) {
Â  Â  // è¿™é‡Œä¸ä¼šæ•è·åˆ°å› é‡å¤è¯·æ±‚è¢«å–æ¶ˆè€ŒæŠ›å‡ºçš„é”™è¯¯ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨æ‹¦æˆªå™¨ä¸­å·²ç»å¤„ç†äº†
Â  Â  console.error('æœç´¢å¤±è´¥:', error)<span class="hljs-comment">;</span>
Â  }Â finallyÂ {
Â  Â  <span class="hljs-attr">loading.value</span>Â =Â <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
Â  }
}<span class="hljs-comment">;</span>
&lt;/script&gt;
</code></pre>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼š<code>CancelToken</code>Â æ–¹å¼åœ¨Â <code>axios</code>Â æ–°ç‰ˆæœ¬ä¸­å·²è¢«æ ‡è®°ä¸ºå¼ƒç”¨ã€‚å¯¹äºæ–°é¡¹ç›®ï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨ä¸‹é¢ä»‹ç»çš„æ›´ç°ä»£çš„Â <code>AbortController</code>Â æ–¹æ¡ˆã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-4">æ–¹æ¡ˆäºŒï¼š AbortController</h2>
<p><code>AbortController</code>Â æ˜¯ä¸€ä¸ªç°ä»£çš„Web APIï¼Œå®ƒæä¾›äº†ä¸€ç§æ›´é€šç”¨ã€æ›´æ ‡å‡†çš„æ–¹å¼æ¥ä¸­æ­¢ä¸€ä¸ªæˆ–å¤šä¸ªWebè¯·æ±‚ã€‚<code>fetch</code>Â API å’Œæ–°çš„Â <code>axios</code>Â ç‰ˆæœ¬éƒ½åŸç”Ÿæ”¯æŒå®ƒã€‚ä½¿ç”¨Â <code>AbortController</code>Â æ˜¯å½“å‰æ¨èçš„åšæ³•ã€‚</p>
<h3 data-id="heading-5">åŸºæœ¬æ¦‚å¿µ</h3>
<ul>
<li>â€¢Â <code>AbortController</code>ï¼šæ§åˆ¶å™¨å¯¹è±¡ï¼Œç”¨äºè§¦å‘ä¸­æ­¢ä¿¡å·ã€‚</li>
<li>â€¢Â <code>AbortSignal</code>ï¼šä¿¡å·å¯¹è±¡ï¼Œå…³è”åˆ°å…·ä½“çš„è¯·æ±‚ä¸Šã€‚æ§åˆ¶å™¨å¯ä»¥é€šè¿‡å®ƒæ¥é€šçŸ¥è¯·æ±‚â€œéœ€è¦ä¸­æ­¢â€ã€‚</li>
</ul>
<h3 data-id="heading-6">åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ª AbortController å®ä¾‹</span>
<span class="hljs-keyword">const</span>Â controller =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">AbortController</span>();
<span class="hljs-keyword">const</span>Â signal = controller.<span class="hljs-property">signal</span>;Â <span class="hljs-comment">// è·å–å®ƒçš„ signal</span>

<span class="hljs-comment">// 2. å‘èµ· fetch è¯·æ±‚ï¼Œå¹¶å°† signal å…³è”ä¸Šå»</span>
<span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/some-data'</span>, { signal })
Â  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span>Â =&gt;</span>Â response.<span class="hljs-title function_">json</span>())
Â  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span>Â =&gt;</span>Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data))
Â  .<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span>Â =&gt;</span>Â {
Â  Â  <span class="hljs-comment">// å¦‚æœé”™è¯¯æ˜¯å› ä¸ºè¯·æ±‚è¢«ä¸­æ­¢</span>
Â  Â  <span class="hljs-keyword">if</span>Â (err.<span class="hljs-property">name</span>Â ===Â <span class="hljs-string">'AbortError'</span>) {
Â  Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Fetch è¯·æ±‚è¢«ä¸­æ­¢'</span>);
Â  Â  }Â <span class="hljs-keyword">else</span>Â {
Â  Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å…¶ä»–é”™è¯¯:'</span>, err);
Â  Â  }
Â  });

<span class="hljs-comment">// 3. åœ¨éœ€è¦çš„æ—¶å€™ä¸­æ­¢è¯·æ±‚</span>
controller.<span class="hljs-title function_">abort</span>();Â <span class="hljs-comment">// è¿™ä¼šè§¦å‘ signal çš„ä¸­æ­¢äº‹ä»¶ï¼Œä»è€Œå–æ¶ˆè¯·æ±‚</span>
</code></pre>
<h3 data-id="heading-7">åœ¨ Axios ä¸­ä½¿ç”¨ AbortController</h3>
<p>ä»Â <code>axios</code>Â v0.22.0 å¼€å§‹ï¼Œä½ å¯ä»¥ä½¿ç”¨Â <code>signal</code>Â å±æ€§æ¥é…ç½®Â <code>AbortSignal</code>ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span>Â axiosÂ <span class="hljs-keyword">from</span>Â <span class="hljs-string">'axios'</span>;

<span class="hljs-keyword">const</span>Â controller =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">AbortController</span>();

axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/user/123'</span>, {
Â  <span class="hljs-attr">signal</span>: controller.<span class="hljs-property">signal</span>Â <span class="hljs-comment">// å°† signal ä¼ é€’ç»™è¯·æ±‚é…ç½®</span>
}).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span>Â =&gt;</span>Â {
Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">data</span>);
}).<span class="hljs-keyword">catch</span>(<span class="hljs-keyword">function</span>Â (<span class="hljs-params">error</span>) {
Â  <span class="hljs-comment">// åˆ¤æ–­é”™è¯¯æ˜¯å¦æ˜¯å› ä¸ºè¯·æ±‚è¢«å–æ¶ˆ</span>
Â  <span class="hljs-keyword">if</span>Â (axios.<span class="hljs-title function_">isCancel</span>(error)) {
Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¯·æ±‚è¢«å–æ¶ˆ:'</span>, error.<span class="hljs-property">message</span>);
Â  }Â <span class="hljs-keyword">else</span>Â {
Â  Â  <span class="hljs-comment">// å¤„ç†å…¶ä»–é”™è¯¯</span>
Â  }
});

<span class="hljs-comment">// å–æ¶ˆè¯·æ±‚</span>
controller.<span class="hljs-title function_">abort</span>();
</code></pre>
<h3 data-id="heading-8">å°è£…åŸºäº AbortController çš„é‡å¤è¯·æ±‚å–æ¶ˆ</h3>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ç±»ä¼¼çš„æ€è·¯ï¼Œç”¨Â <code>AbortController</code>Â é‡æ„ä¹‹å‰çš„å·¥å…·å‡½æ•°ã€‚ä¸»è¦å˜åŒ–æ˜¯å°†å­˜å‚¨çš„Â <code>cancel</code>Â å‡½æ•°æ›¿æ¢ä¸ºÂ <code>AbortController</code>Â å®ä¾‹ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// utils/request-abort.js</span>
<span class="hljs-keyword">import</span>Â axiosÂ <span class="hljs-keyword">from</span>Â <span class="hljs-string">'axios'</span>;

<span class="hljs-keyword">const</span>Â pendingRequestMap =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Map</span>();

<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">generateReqKey</span>(<span class="hljs-params">config</span>) {
Â  <span class="hljs-keyword">const</span>Â { method, url, params, data } = config;
Â  <span class="hljs-keyword">return</span>Â [method, url,Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(params),Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data)].<span class="hljs-title function_">join</span>(<span class="hljs-string">'&amp;'</span>);
}

<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">addPendingRequest</span>(<span class="hljs-params">config</span>) {
Â  <span class="hljs-keyword">const</span>Â requestKey =Â <span class="hljs-title function_">generateReqKey</span>(config);
Â  <span class="hljs-comment">// å¦‚æœå·²æœ‰ç›¸åŒè¯·æ±‚åœ¨è¿›è¡Œï¼Œåˆ™ä¸­æ­¢å®ƒ</span>
Â  <span class="hljs-keyword">if</span>Â (pendingRequestMap.<span class="hljs-title function_">has</span>(requestKey)) {
Â  Â  <span class="hljs-keyword">const</span>Â oldController = pendingRequestMap.<span class="hljs-title function_">get</span>(requestKey);
Â  Â  oldController.<span class="hljs-title function_">abort</span>();Â <span class="hljs-comment">// ä¸­æ­¢æ—§çš„è¯·æ±‚</span>
Â  Â  pendingRequestMap.<span class="hljs-title function_">delete</span>(requestKey);
Â  }
Â  <span class="hljs-comment">// ä¸ºå½“å‰è¯·æ±‚åˆ›å»ºæ–°çš„æ§åˆ¶å™¨å¹¶å­˜å‚¨</span>
Â  <span class="hljs-keyword">const</span>Â controller =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">AbortController</span>();
Â  config.<span class="hljs-property">signal</span>Â = controller.<span class="hljs-property">signal</span>;Â <span class="hljs-comment">// å…³é”®ï¼šå°† signal èµ‹ç»™è¯·æ±‚é…ç½®</span>
Â  pendingRequestMap.<span class="hljs-title function_">set</span>(requestKey, controller);
}

<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">removePendingRequest</span>(<span class="hljs-params">config</span>) {
Â  <span class="hljs-keyword">const</span>Â requestKey =Â <span class="hljs-title function_">generateReqKey</span>(config);
Â  <span class="hljs-keyword">if</span>Â (pendingRequestMap.<span class="hljs-title function_">has</span>(requestKey)) {
Â  Â  <span class="hljs-comment">// è¯·æ±‚å®Œæˆï¼Œç›´æ¥ä»Mapä¸­ç§»é™¤å³å¯ï¼Œä¸éœ€è¦æ‰‹åŠ¨abort</span>
Â  Â  pendingRequestMap.<span class="hljs-title function_">delete</span>(requestKey);
Â  }
}

<span class="hljs-keyword">const</span>Â service = axios.<span class="hljs-title function_">create</span>({
Â  <span class="hljs-attr">timeout</span>:Â <span class="hljs-number">10000</span>,
});

service.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(
Â  <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span>Â {
Â  Â  <span class="hljs-title function_">removePendingRequest</span>(config);Â <span class="hljs-comment">// å…ˆç§»é™¤å¯èƒ½å­˜åœ¨çš„æ—§è®°å½•ï¼ˆæ¸…ç†ä½œç”¨ï¼‰</span>
Â  Â  <span class="hljs-title function_">addPendingRequest</span>(config);Â <span class="hljs-comment">// æ·»åŠ æ–°è¯·æ±‚</span>
Â  Â  <span class="hljs-keyword">return</span>Â config;
Â  },
Â  <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span>Â {
Â  Â  <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
Â  }
);

service.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(
Â  <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span>Â {
Â  Â  <span class="hljs-title function_">removePendingRequest</span>(response.<span class="hljs-property">config</span>);
Â  Â  <span class="hljs-keyword">return</span>Â response;
Â  },
Â  <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span>Â {
Â  Â  <span class="hljs-comment">// åˆ¤æ–­é”™è¯¯æ˜¯å¦ç”±å–æ¶ˆè¯·æ±‚å¯¼è‡´</span>
Â  Â  <span class="hljs-keyword">if</span>Â (axios.<span class="hljs-title function_">isCancel</span>(error)) {
Â  Â  Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å·²å–æ¶ˆçš„é‡å¤è¯·æ±‚:'</span>, error.<span class="hljs-property">message</span>);
Â  Â  Â  <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Promise</span>(<span class="hljs-function">() =&gt;</span>Â {});Â <span class="hljs-comment">// ä¸­æ–­Promiseé“¾</span>
Â  Â  }
Â  Â  <span class="hljs-title function_">removePendingRequest</span>(error.<span class="hljs-property">config</span>Â || {});
Â  Â  <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
Â  }
);

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â service;
</code></pre>
<p>è¿™ä¸ªç‰ˆæœ¬çš„é€»è¾‘æ›´æ¸…æ™°ï¼š<strong>åœ¨æ·»åŠ æ–°è¯·æ±‚æ—¶ï¼Œç›´æ¥ä¸­æ­¢æ—§çš„ç›¸åŒè¯·æ±‚</strong>ã€‚å“åº”æ‹¦æˆªå™¨é‡Œåªéœ€è¦åšæ¸…ç†å·¥ä½œã€‚</p>
<hr/>
<h2 data-id="heading-9">è¿›é˜¶ä¸ä¼˜åŒ–</h2>
<p>ä¸Šé¢çš„æ–¹æ¡ˆè§£å†³äº†æ ¸å¿ƒé—®é¢˜ï¼Œä½†åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½è¿˜éœ€è¦è€ƒè™‘æ›´å¤šç»†èŠ‚ã€‚</p>
<h3 data-id="heading-10">1. ç™½åå•æ§åˆ¶</h3>
<p>æœ‰äº›è¯·æ±‚æˆ‘ä»¬å¯èƒ½ä¸å¸Œæœ›è¢«è‡ªåŠ¨å–æ¶ˆã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªè½®è¯¢å®šæ—¶è¯·æ±‚ï¼Œæˆ–è€…å¤šä¸ªå¹¶è¡Œçš„ä¸åŒæ•°æ®è¯·æ±‚ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»™è¯·æ±‚é…ç½®æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰æ ‡è®°ï¼ˆå¦‚Â <code>allowRepeat: true</code>ï¼‰æ¥å®ç°ç™½åå•ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// åœ¨æ‹¦æˆªå™¨ä¸­</span>
service.interceptors.request.<span class="hljs-built_in">use</span>(
Â  (config) =&gt;Â {
Â  Â  <span class="hljs-comment">// å¦‚æœé…ç½®äº†å…è®¸é‡å¤ï¼Œåˆ™è·³è¿‡å–æ¶ˆé€»è¾‘</span>
Â  Â  <span class="hljs-keyword">if</span>Â (config.allowRepeat) {
Â  Â  Â  <span class="hljs-keyword">return</span>Â config;
Â  Â  }
Â  Â  <span class="hljs-built_in">removePendingRequest</span>(config);
Â  Â  <span class="hljs-built_in">addPendingRequest</span>(config);
Â  Â  <span class="hljs-keyword">return</span>Â config;
Â  }
);

<span class="hljs-comment">// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨</span>
request.<span class="hljs-built_in">get</span>(<span class="hljs-string">'/api/polling'</span>, {Â allowRepeat:Â <span class="hljs-literal">true</span>Â });
</code></pre>
<h3 data-id="heading-11">2. ä¸ Vue Router å¯¼èˆªå®ˆå«ç»“åˆ</h3>
<p>å½“ç”¨æˆ·åˆ‡æ¢é¡µé¢æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸å¸Œæœ›å–æ¶ˆæ‰€æœ‰æœªå®Œæˆçš„è¯·æ±‚ï¼Œä»¥å…å®ƒä»¬åœ¨åå°ç»§ç»­è¿è¡Œå¹¶å¯èƒ½æ›´æ–°ä¸€ä¸ªå·²ç»é”€æ¯çš„ç»„ä»¶çŠ¶æ€ã€‚è¿™å¯ä»¥åœ¨Vue Routerçš„å…¨å±€å‰ç½®å®ˆå«ä¸­å®ç°ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// router/index.js</span>
<span class="hljs-keyword">import</span>Â routerÂ <span class="hljs-keyword">from</span>Â <span class="hljs-string">'./router'</span>;
<span class="hljs-keyword">import</span>Â { pendingRequestMap }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'@/utils/request-abort'</span>;Â <span class="hljs-comment">// éœ€è¦å°†mapå¯¼å‡º</span>

router.<span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">(<span class="hljs-params">to,Â <span class="hljs-keyword">from</span>, next</span>) =&gt;</span>Â {
Â  <span class="hljs-comment">// éå†å¹¶ä¸­æ­¢æ‰€æœ‰è¿›è¡Œä¸­çš„è¯·æ±‚</span>
Â  pendingRequestMap.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">controller, key</span>) =&gt;</span>Â {
Â  Â  controller.<span class="hljs-title function_">abort</span>(<span class="hljs-string">`è·¯ç”±è·³è½¬è‡³Â <span class="hljs-subst">${to.path}</span>`</span>);
Â  });
Â  <span class="hljs-comment">// æ¸…ç©ºMap</span>
Â  pendingRequestMap.<span class="hljs-title function_">clear</span>();
Â  <span class="hljs-title function_">next</span>();
});
</code></pre>
<h3 data-id="heading-12">3. ä½¿ç”¨ Composition API å°è£…</h3>
<p>åœ¨Vue3ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç»„åˆå¼APIï¼Œå°†å–æ¶ˆé€»è¾‘å°è£…æˆä¸€ä¸ªæ›´ä¼˜é›…ã€å¯å¤ç”¨çš„Â <code>useRequest</code>Â Hookã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// composables/useRequest.js
importÂ { ref, onUnmounted }Â fromÂ 'vue'<span class="hljs-comment">;</span>
importÂ requestÂ fromÂ '@/utils/request-abort'<span class="hljs-comment">;</span>

exportÂ functionÂ useRequest() {
Â  constÂ <span class="hljs-attr">data</span> =Â ref(null)<span class="hljs-comment">;</span>
Â  constÂ <span class="hljs-attr">error</span> =Â ref(null)<span class="hljs-comment">;</span>
Â  constÂ <span class="hljs-attr">loading</span> =Â ref(<span class="hljs-literal">false</span>)<span class="hljs-comment">;</span>
Â  letÂ <span class="hljs-attr">abortController</span> =Â null<span class="hljs-comment">;</span>

Â  constÂ <span class="hljs-attr">execute</span>Â =Â asyncÂ (config) =&gt; {
Â  Â  <span class="hljs-attr">loading.value</span>Â =Â <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
Â  Â  <span class="hljs-attr">error.value</span>Â =Â null<span class="hljs-comment">;</span>
Â  Â  // ä¸ºè¿™æ¬¡æ‰§è¡Œåˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„æ§åˆ¶å™¨ï¼ˆå¯é€‰ï¼Œå¦‚æœå…¨å±€å·²ç®¡ç†åˆ™å¯çœç•¥ï¼‰
Â  Â  <span class="hljs-attr">abortController</span> =Â newÂ AbortController()<span class="hljs-comment">;</span>
Â  Â  tryÂ {
Â  Â  Â  constÂ <span class="hljs-attr">response</span> =Â awaitÂ request({
Â  Â  Â  Â  ...config,
Â  Â  Â  Â  signal: abortController.signal
Â  Â  Â  })<span class="hljs-comment">;</span>
Â  Â  Â  <span class="hljs-attr">data.value</span>Â = response.data<span class="hljs-comment">;</span>
Â  Â  Â  returnÂ response<span class="hljs-comment">;</span>
Â  Â  }Â catchÂ (err) {
Â  Â  Â  ifÂ (!axios.isCancel(err)) {
Â  Â  Â  Â  <span class="hljs-attr">error.value</span>Â = err<span class="hljs-comment">;</span>
Â  Â  Â  }
Â  Â  Â  throwÂ err<span class="hljs-comment">;</span>
Â  Â  }Â finallyÂ {
Â  Â  Â  <span class="hljs-attr">loading.value</span>Â =Â <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
Â  Â  }
Â  }<span class="hljs-comment">;</span>

Â  // ç»„ä»¶å¸è½½æ—¶ï¼Œå–æ¶ˆç”±è¿™ä¸ªHookå‘èµ·çš„è¯·æ±‚
Â  onUnmounted(() =&gt;Â {
Â  Â  ifÂ (abortController) {
Â  Â  Â  abortController.abort()<span class="hljs-comment">;</span>
Â  Â  }
Â  })<span class="hljs-comment">;</span>

Â  // æä¾›ä¸€ä¸ªæ‰‹åŠ¨å–æ¶ˆçš„æ–¹æ³•
Â  constÂ <span class="hljs-attr">cancel</span>Â = () =&gt; {
Â  Â  ifÂ (abortController) {
Â  Â  Â  abortController.abort()<span class="hljs-comment">;</span>
Â  Â  }
Â  }<span class="hljs-comment">;</span>

Â  returnÂ {
Â  Â  data,
Â  Â  error,
Â  Â  loading,
Â  Â  execute,
Â  Â  cancel
Â  }<span class="hljs-comment">;</span>
}
</code></pre>
<p>åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span>Â { useRequest }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'@/composables/useRequest'</span>;

<span class="hljs-keyword">const</span>Â { data, loading, execute } =Â <span class="hljs-title function_">useRequest</span>();

<span class="hljs-keyword">const</span>Â <span class="hljs-title function_">handleSubmit</span>Â = (<span class="hljs-params"/>) =&gt; {
Â  <span class="hljs-title function_">execute</span>({
Â  Â  <span class="hljs-attr">method</span>:Â <span class="hljs-string">'post'</span>,
Â  Â  <span class="hljs-attr">url</span>:Â <span class="hljs-string">'/api/submit'</span>,
Â  Â  <span class="hljs-attr">data</span>: {Â <span class="hljs-comment">/* ... */</span>Â }
Â  });
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<hr/>
<p>å–æ¶ˆé‡å¤è¯·æ±‚æ˜¯ä¸€ä¸ªçœ‹ä¼¼ç®€å•ï¼Œä½†èƒ½æ˜¾è‘—æå‡åº”ç”¨å¥å£®æ€§çš„ä¼˜åŒ–ç‚¹ã€‚åœ¨Vue3é¡¹ç›®ä¸­ï¼Œç»“åˆÂ <code>axios</code>Â å’ŒÂ <code>AbortController</code>ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ¸…æ™°çš„ä»£ç å®ç°è¿™ä¸€åŠŸèƒ½ã€‚å¸Œæœ›æœ¬æ–‡ä»‹ç»çš„æ–¹æ³•å’Œæ€è·¯ï¼Œèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°å¤„ç†é¡¹ç›®ä¸­çš„ç½‘ç»œè¯·æ±‚é—®é¢˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®© AI å¸®ä½ ç¼–è¯‘éƒ¨ç½²é¸¿è’™åº”ç”¨ï¼šharmonyos-build-deploy Skill]]></title>    <link>https://juejin.cn/post/7603183929251954740</link>    <guid>https://juejin.cn/post/7603183929251954740</guid>    <pubDate>2026-02-05T13:10:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603183929251954740" data-draft-id="7603183929251905588" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®© AI å¸®ä½ ç¼–è¯‘éƒ¨ç½²é¸¿è’™åº”ç”¨ï¼šharmonyos-build-deploy Skill "/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-05T13:10:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŸä¸­çš„é›¾"/> <meta itemprop="url" content="https://juejin.cn/user/77390767983908"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®© AI å¸®ä½ ç¼–è¯‘éƒ¨ç½²é¸¿è’™åº”ç”¨ï¼šharmonyos-build-deploy Skill 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/77390767983908/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŸä¸­çš„é›¾
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T13:10:02.000Z" title="Thu Feb 05 2026 13:10:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>è¿™ä¸æ˜¯ä¸€ç¯‡æ•™ä½ æ•²å‘½ä»¤çš„æ–‡ç« ã€‚è¿™æ˜¯ä¸€ç¯‡å…³äºå¦‚ä½•è®© AI æˆä¸ºä½ çš„é¸¿è’™å¼€å‘åŠ©æ‰‹ï¼Œå¸®ä½ å®Œæˆä»ç¼–è¯‘åˆ°éƒ¨ç½²å…¨æµç¨‹çš„å®è·µåˆ†äº«ã€‚</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb2953a95cac489c9fff8e7aeaf6a8b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Z-O5Lit55qE6Zu-:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770901805&amp;x-signature=PVAKo1ThDDdrpu3R0C0gUAnfsXw%3D" alt="image-20260205203044086.png" loading="lazy"/></p>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆè¦åšè¿™ä¸ª Skillï¼Ÿ</h2>
<h3 data-id="heading-1">ä¸æ˜¯ç»™å¼€å‘è€…ç”¨çš„ï¼Œæ˜¯ç»™ AI ç”¨çš„</h3>
<p>ä¼ ç»Ÿçš„ CLI å·¥å…·è®¾è®¡ç†å¿µæ˜¯ï¼š<strong>å¼€å‘è€…å­¦ä¹ å‘½ä»¤ â†’ å¼€å‘è€…æ‰§è¡Œå‘½ä»¤</strong>ã€‚</p>
<p>ä½†åœ¨ AI Coding æ—¶ä»£ï¼Œæˆ‘ä»¬æœ‰äº†æ–°çš„å¯èƒ½ï¼š<strong>å¼€å‘è€…æè¿°éœ€æ±‚ â†’ AI ç†è§£å¹¶æ‰§è¡Œ</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2def81b6d21a47309bfe50ed4b73faff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Z-O5Lit55qE6Zu-:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770901805&amp;x-signature=Czj5R1LmuA9mTds6xOesKRxtKBs%3D" alt="01.001.png" loading="lazy"/></p>
<p><strong>harmonyos-build-deploy</strong> çš„è®¾è®¡åˆå¿ƒå°±æ˜¯ï¼š</p>
<blockquote>
<p>è®© Claude èƒ½å¤Ÿç†è§£é¸¿è’™é¡¹ç›®ï¼Œè‡ªåŠ¨å®Œæˆç¼–è¯‘ã€ç­¾åã€éƒ¨ç½²ã€è°ƒè¯•çš„å…¨æµç¨‹ã€‚å¼€å‘è€…åªéœ€è¦ç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚ã€‚</p>
</blockquote>
<h2 data-id="heading-2">ä»€ä¹ˆæ˜¯ Claude Code Skillï¼Ÿ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fclaude.ai%2Fcode" target="_blank" title="https://claude.ai/code" ref="nofollow noopener noreferrer">Claude Code</a> æ˜¯ Anthropic æ¨å‡ºçš„ AI ç¼–ç¨‹åŠ©æ‰‹ã€‚<strong>Skill</strong> æ˜¯ä¸€ç§æ‰©å±•æœºåˆ¶ï¼Œå¯ä»¥æ•™ä¼š Claude ç‰¹å®šé¢†åŸŸçš„çŸ¥è¯†å’Œèƒ½åŠ›ã€‚</p>
<p>å½“ä½ å®‰è£…äº† harmonyos-build-deploy Skill åï¼ŒClaude å°±å…·å¤‡äº†ï¼š</p>
<ul>
<li>ğŸ§  ç†è§£é¸¿è’™é¡¹ç›®ç»“æ„ï¼ˆHAP/HSP/HAR æ¨¡å—ï¼‰</li>
<li>ğŸ”§ çŸ¥é“å¦‚ä½•ä½¿ç”¨ hvigorwã€hdcã€ohpm ç­‰å·¥å…·</li>
<li>ğŸ“¦ èƒ½å¤Ÿåˆ†ææ¨¡å—ä¾èµ–å¹¶æŒ‰æ­£ç¡®é¡ºåºç¼–è¯‘</li>
<li>ğŸ“± å¯ä»¥å°†åº”ç”¨éƒ¨ç½²åˆ°çœŸæœºå¹¶å¯åŠ¨</li>
<li>ğŸª èƒ½å¤Ÿæ‰“åŒ… .app æ–‡ä»¶ç”¨äºä¸Šæ¶ AppGallery</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c19d43d22b5a44ebbc87b51f7fe3208a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Z-O5Lit55qE6Zu-:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770901805&amp;x-signature=i2%2B0pt%2BT%2FM1frVBMvtvdJQmEd54%3D" alt="01.1.png" loading="lazy"/></p>
<h2 data-id="heading-3">å®é™…ä½¿ç”¨åœºæ™¯</h2>
<h3 data-id="heading-4">åœºæ™¯ 1ï¼šæ—¥å¸¸å¼€å‘è°ƒè¯•</h3>
<p><strong>ä½ åªéœ€è¦è¯´ï¼š</strong></p>
<pre><code class="hljs">å¸®æˆ‘ç¼–è¯‘ä¸€ä¸‹è¿™ä¸ªé¸¿è’™é¡¹ç›®ï¼Œéƒ¨ç½²åˆ°æ‰‹æœºä¸Šè¿è¡Œ
</code></pre>
<p><strong>Claude ä¼šè‡ªåŠ¨ï¼š</strong></p>
<ol>
<li>è¯†åˆ«è¿™æ˜¯ä¸€ä¸ªé¸¿è’™é¡¹ç›®</li>
<li>è°ƒç”¨ <code>npx harmonyos-deploy --all --launch</code></li>
<li>ç­‰å¾…ç¼–è¯‘å®Œæˆï¼Œå¤„ç†å¯èƒ½çš„é”™è¯¯</li>
<li>éƒ¨ç½²åˆ°è®¾å¤‡å¹¶å¯åŠ¨åº”ç”¨</li>
<li>å‘ä½ æŠ¥å‘Šç»“æœ</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/56550596755444cfa9b446d1fe17a567~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Z-O5Lit55qE6Zu-:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770901805&amp;x-signature=OOJQZoeUEN2vA9lZWdk4q4KkJeA%3D" alt="02.png" loading="lazy"/></p>
<h3 data-id="heading-5">åœºæ™¯ 2ï¼šåˆ‡æ¢ç¯å¢ƒ</h3>
<p><strong>ä½ åªéœ€è¦è¯´ï¼š</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">åˆ‡æ¢åˆ°ç”Ÿäº§ç¯å¢ƒï¼Œç”¨ release æ¨¡å¼é‡æ–°æ‰“åŒ…éƒ¨ç½²
</code></pre>
<p><strong>Claude ç†è§£åæ‰§è¡Œï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">npx harmonyos-deploy --all -p production --release --launch
</code></pre>
<h3 data-id="heading-6">åœºæ™¯ 3ï¼šè°ƒè¯•é—®é¢˜</h3>
<p><strong>ä½ åªéœ€è¦è¯´ï¼š</strong></p>
<pre><code class="hljs">åº”ç”¨å¥½åƒæœ‰é—®é¢˜ï¼Œå¸®æˆ‘çœ‹çœ‹è®¾å¤‡æ—¥å¿—ï¼Œè¿‡æ»¤ NetworkError ç›¸å…³çš„
</code></pre>
<p><strong>Claude ä¼šï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">npx harmonyos-deploy --log-only --filter NetworkError
</code></pre>
<p>ç„¶åå¸®ä½ åˆ†ææ—¥å¿—å†…å®¹ï¼Œå®šä½é—®é¢˜ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b825a6a74ae3424db345f1857dcf72cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Z-O5Lit55qE6Zu-:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770901805&amp;x-signature=fcfLp1lVyVOG%2BTWoU8p27frYU9U%3D" alt="03.png" loading="lazy"/></p>
<h3 data-id="heading-7">åœºæ™¯ 4ï¼šå‡†å¤‡ä¸Šæ¶</h3>
<p><strong>ä½ åªéœ€è¦è¯´ï¼š</strong></p>
<pre><code class="hljs">é¡¹ç›®å¼€å‘å®Œäº†ï¼Œå¸®æˆ‘æ‰“ä¸ªåŒ…å‡†å¤‡ä¸Šæ¶åä¸ºåº”ç”¨å¸‚åœº
</code></pre>
<p><strong>Claude ä¼šï¼š</strong></p>
<ol>
<li>ä½¿ç”¨ release æ¨¡å¼æ‰“åŒ… .app æ–‡ä»¶</li>
<li>ç¡®ä¿ debuggable=false</li>
<li>è¾“å‡ºæ–‡ä»¶è·¯å¾„å’Œå¤§å°</li>
<li>å‘Šè¯‰ä½ ä¸‹ä¸€æ­¥å» AppGallery Connect ä¸Šä¼ </li>
</ol>
<pre><code class="hljs language-bash" lang="bash">npx harmonyos-deploy --app -p production --release -o ./dist
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79520962ad3b4c3dacc31ef4a74d50e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Z-O5Lit55qE6Zu-:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770901805&amp;x-signature=QNKhLeKIOu5f%2B34O5lbrRcXrpt8%3D" alt="04.png" loading="lazy"/></p>
<h2 data-id="heading-8">AI + Skill çš„åä½œæ¨¡å¼</h2>
<h3 data-id="heading-9">ä¼ ç»Ÿæ–¹å¼ vs AI Coding</h3>





























<table><thead><tr><th>ä¼ ç»Ÿæ–¹å¼</th><th>AI Coding + Skill</th></tr></thead><tbody><tr><td>æŸ¥æ–‡æ¡£å­¦ä¹  hvigorw å‘½ä»¤</td><td>ç›´æ¥è¯´"ç¼–è¯‘é¡¹ç›®"</td></tr><tr><td>è®°å¿†å„ç§å‚æ•°ç»„åˆ</td><td>AI è‡ªåŠ¨é€‰æ‹©æ­£ç¡®å‚æ•°</td></tr><tr><td>æ‰‹åŠ¨åˆ†æç¼–è¯‘é”™è¯¯</td><td>AI è§£è¯»é”™è¯¯å¹¶ç»™å‡ºä¿®å¤å»ºè®®</td></tr><tr><td>ä¸€ä¸ªä¸ªæ‰§è¡Œå‘½ä»¤</td><td>AI è‡ªåŠ¨ä¸²è”å®Œæ•´æµç¨‹</td></tr><tr><td>åˆ‡æ¢ç¯å¢ƒè¦æ”¹é…ç½®</td><td>è¯´ä¸€å¥è¯å°±åˆ‡æ¢</td></tr></tbody></table>
<h3 data-id="heading-10">Skill å¦‚ä½•å·¥ä½œ</h3>
<pre><code class="hljs language-css" lang="css">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å¼€å‘è€…                               â”‚
â”‚                    "å¸®æˆ‘ç¼–è¯‘éƒ¨ç½²"                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Claude <span class="hljs-selector-tag">Code</span>                            â”‚
â”‚  <span class="hljs-number">1</span>. ç†è§£ç”¨æˆ·æ„å›¾ï¼šç¼–è¯‘ + éƒ¨ç½²                                â”‚
â”‚  <span class="hljs-number">2</span>. è¯†åˆ«é¡¹ç›®ç±»å‹ï¼šæ£€æµ‹åˆ° build-profile<span class="hljs-selector-class">.json5</span> â†’ é¸¿è’™é¡¹ç›®      â”‚
â”‚  <span class="hljs-number">3</span>. è°ƒç”¨ Skillï¼šharmonyos-build-deploy                      â”‚
â”‚  <span class="hljs-number">4</span>. æ‰§è¡Œå‘½ä»¤ï¼šnpx harmonyos-deploy <span class="hljs-attr">--all</span> <span class="hljs-attr">--launch</span>           â”‚
â”‚  <span class="hljs-number">5</span>. å¤„ç†ç»“æœï¼šæˆåŠŸ/å¤±è´¥ â†’ åé¦ˆç»™ç”¨æˆ·                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   harmonyos-deploy CLI                      â”‚
â”‚  â€¢ ohpm install                                             â”‚
â”‚  â€¢ hvigorw assembleHap/assembleHsp                          â”‚
â”‚  â€¢ hdc install                                              â”‚
â”‚  â€¢ aa start                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      é¸¿è’™è®¾å¤‡                                â”‚
â”‚                    åº”ç”¨æˆåŠŸè¿è¡Œ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ec7b964855940a4b99b062e870b7c36~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Z-O5Lit55qE6Zu-:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770901805&amp;x-signature=M7rAbRnY7dSzR4Yy4kYnD9AswpM%3D" alt="02.2.png" loading="lazy"/></p>
<h2 data-id="heading-11">å¦‚ä½•å¼€å§‹ä½¿ç”¨</h2>
<h3 data-id="heading-12">æ–¹å¼ 1ï¼šåœ¨ Claude Code ä¸­å®‰è£… Skill</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£… skill</span>
/skill install harmonyos-build-deploy
</code></pre>
<p>å®‰è£…åï¼ŒClaude å°±ä¼šåœ¨ä½ æåˆ°é¸¿è’™ç¼–è¯‘ã€éƒ¨ç½²ã€hvigorã€hdc ç­‰å…³é”®è¯æ—¶è‡ªåŠ¨æ¿€æ´»è¿™ä¸ª Skillã€‚</p>
<h3 data-id="heading-13">æ–¹å¼ 2ï¼šç›´æ¥ä½¿ç”¨ï¼ˆæ— éœ€ Skillï¼‰</h3>
<p>å³ä½¿ä¸å®‰è£… Skillï¼Œä½ ä¹Ÿå¯ä»¥åœ¨å¯¹è¯ä¸­å¼•å¯¼ Claude ä½¿ç”¨è¿™ä¸ªå·¥å…·ï¼š</p>
<pre><code class="hljs">æˆ‘çš„é¡¹ç›®æ˜¯é¸¿è’™åº”ç”¨ï¼Œè¯·ä½¿ç”¨ npx harmonyos-deploy æ¥å¸®æˆ‘ç¼–è¯‘éƒ¨ç½²
</code></pre>
<h3 data-id="heading-14">æ–¹å¼ 3ï¼šé¡¹ç›®çº§é…ç½®</h3>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º <code>.claude/skills/</code> æ–‡ä»¶å¤¹ï¼Œå°† Skill æ–‡ä»¶æ”¾å…¥ï¼ŒClaude ä¼šè‡ªåŠ¨åŠ è½½ã€‚</p>
<h2 data-id="heading-15">è§¦å‘å…³é”®è¯</h2>
<p>å½“ä½ åœ¨å¯¹è¯ä¸­æåˆ°ä»¥ä¸‹å…³é”®è¯æ—¶ï¼ŒClaude ä¼šè‡ªåŠ¨è¯†åˆ«å¹¶ä½¿ç”¨ harmonyos-build-deployï¼š</p>
<ul>
<li>é¸¿è’™ã€HarmonyOSã€OpenHarmony</li>
<li>ç¼–è¯‘ã€æ„å»ºã€éƒ¨ç½²ã€å®‰è£…</li>
<li>hvigorã€hvigorwã€hdc</li>
<li>HAPã€HSPã€HAR</li>
<li>AppGalleryã€ä¸Šæ¶</li>
<li>ohpmã€hilog</li>
</ul>
<h2 data-id="heading-16">Skill çš„æŠ€æœ¯å®ç°</h2>
<h3 data-id="heading-17">é›¶ä¾èµ–è®¾è®¡</h3>
<p>æ•´ä¸ªå·¥å…·æ˜¯ä¸€ä¸ªçº¦ 1900 è¡Œçš„ Node.js è„šæœ¬ï¼Œä¸ä¾èµ–ä»»ä½•ç¬¬ä¸‰æ–¹ npm åŒ…ã€‚è¿™æ„å‘³ç€ï¼š</p>
<ul>
<li>âœ… æ— éœ€ <code>npm install</code></li>
<li>âœ… ç›´æ¥ <code>npx</code> è¿è¡Œ</li>
<li>âœ… AI å¯ä»¥ç«‹å³ä½¿ç”¨</li>
</ul>
<h3 data-id="heading-18">æ™ºèƒ½ä¾èµ–è§£æ</h3>
<p>å¯¹äºå¤šæ¨¡å—é¡¹ç›®ï¼Œå·¥å…·ä¼šï¼š</p>
<ol>
<li>æ‰«ææ‰€æœ‰ <code>oh-package.json5</code></li>
<li>è§£æ dependencies å­—æ®µ</li>
<li>æ„å»ºä¾èµ–å›¾</li>
<li>æ‹“æ‰‘æ’åºå¾—åˆ°æ­£ç¡®çš„ç¼–è¯‘é¡ºåº</li>
</ol>

<pre><code class="hljs language-scss" lang="scss">lushu_acommon (æ— ä¾èµ–)
    â†“
lushu_appcommon (ä¾èµ– acommon)
    â†“
lushu_home, lushu_service... (ä¾èµ– acommon + appcommon)
    â†“
entry (HAPï¼Œæœ€åç¼–è¯‘)
</code></pre>
<h3 data-id="heading-19">é”™è¯¯è¯Šæ–­</h3>
<p>å½“ç¼–è¯‘æˆ–å®‰è£…å¤±è´¥æ—¶ï¼Œå·¥å…·ä¼šåˆ†æé”™è¯¯å¹¶ç»™å‡ºä¿®å¤å»ºè®®ï¼ŒAI å¯ä»¥ç›´æ¥å°†è¿™äº›ä¿¡æ¯å‘ˆç°ç»™ä½ ã€‚</p>
<h2 data-id="heading-20">æœªæ¥å±•æœ›</h2>
<h3 data-id="heading-21">æ›´æ·±åº¦çš„ AI é›†æˆ</h3>
<ul>
<li>ğŸ”® AI ç›´æ¥ä¿®æ”¹ä»£ç åè‡ªåŠ¨é‡æ–°ç¼–è¯‘éƒ¨ç½²</li>
<li>ğŸ”® AI åˆ†æè¿è¡Œæ—¶æ—¥å¿—ï¼Œè‡ªåŠ¨å®šä½å¹¶ä¿®å¤ Bug</li>
<li>ğŸ”® AI æ ¹æ®æµ‹è¯•ç»“æœè‡ªåŠ¨ä¼˜åŒ–æ€§èƒ½</li>
</ul>
<h3 data-id="heading-22">æ›´å®Œæ•´çš„ DevOps æ”¯æŒ</h3>
<ul>
<li>ğŸ”® è‡ªåŠ¨åŒ–æµ‹è¯•é›†æˆ</li>
<li>ğŸ”® å¤šè®¾å¤‡å¹¶è¡Œéƒ¨ç½²</li>
<li>ğŸ”® ç‰ˆæœ¬ç®¡ç†å’Œå‘å¸ƒæµç¨‹</li>
</ul>
<h2 data-id="heading-23">å¼€æºåœ°å€</h2>
<ul>
<li><strong>GitHub</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsupermanaaaa%2Fharmonyos-build-deploy" target="_blank" title="https://github.com/supermanaaaa/harmonyos-build-deploy" ref="nofollow noopener noreferrer">github.com/supermanaaaâ€¦</a></li>
<li><strong>npm</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fharmonyos-deploy" target="_blank" title="https://www.npmjs.com/package/harmonyos-deploy" ref="nofollow noopener noreferrer">www.npmjs.com/package/harâ€¦</a></li>
<li><strong>Claude Skills</strong>: å·²æäº¤è‡³ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fanthropics%2Fskills%2Fpull%2F342" target="_blank" title="https://github.com/anthropics/skills/pull/342" ref="nofollow noopener noreferrer">anthropics/skills</a></li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ddff22b034214b15ad1275ac8c2218dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Z-O5Lit55qE6Zu-:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770901805&amp;x-signature=RKj7QerwF2G9I%2FJ2bGoqolfcnxQ%3D" alt="05.png" loading="lazy"/></p>
<h2 data-id="heading-24">æ€»ç»“</h2>
<p><strong>harmonyos-build-deploy</strong> ä¸ä»…ä»…æ˜¯ä¸€ä¸ª CLI å·¥å…·ï¼Œæ›´æ˜¯è¿æ¥ <strong>AI èƒ½åŠ›</strong> å’Œ <strong>é¸¿è’™å¼€å‘</strong> çš„æ¡¥æ¢ã€‚</p>
<p>å®ƒçš„å­˜åœ¨è®© Claude èƒ½å¤Ÿï¼š</p>
<ul>
<li>ç†è§£é¸¿è’™é¡¹ç›®çš„ç»“æ„å’Œæ„å»ºæµç¨‹</li>
<li>æ‰§è¡Œå¤æ‚çš„å¤šæ¨¡å—ç¼–è¯‘</li>
<li>å¤„ç†è®¾å¤‡éƒ¨ç½²å’Œè°ƒè¯•</li>
<li>å®Œæˆåº”ç”¨ä¸Šæ¶æ‰“åŒ…</li>
</ul>
<p>è€Œä½ åªéœ€è¦ï¼š</p>
<ul>
<li>ç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚</li>
<li>è®© AI å¸®ä½ å®Œæˆå‰©ä¸‹çš„å·¥ä½œ</li>
</ul>
<p><strong>è¿™å°±æ˜¯ AI Coding æ—¶ä»£çš„å¼€å‘æ–¹å¼ã€‚</strong></p>
<hr/>
<blockquote>
<p>ä½œè€…ï¼šsupermanaaaa</p>
<p>é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsupermanaaaa%2Fharmonyos-build-deploy" target="_blank" title="https://github.com/supermanaaaa/harmonyos-build-deploy" ref="nofollow noopener noreferrer">github.com/supermanaaaâ€¦</a></p>
<p>å¦‚æœè¿™ä¸ª Skill å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª â­ï¸ Star æ”¯æŒä¸€ä¸‹ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨webåº”ç”¨ä¸­ä½¿ç”¨é«˜å¾·åœ°å›¾çš„èƒ½åŠ›]]></title>    <link>https://juejin.cn/post/7603195960254709760</link>    <guid>https://juejin.cn/post/7603195960254709760</guid>    <pubDate>2026-02-05T13:41:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603195960254709760" data-draft-id="7602512064977584191" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨webåº”ç”¨ä¸­ä½¿ç”¨é«˜å¾·åœ°å›¾çš„èƒ½åŠ›"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-05T13:41:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="FanetheDivine"/> <meta itemprop="url" content="https://juejin.cn/user/4246761716322491"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨webåº”ç”¨ä¸­ä½¿ç”¨é«˜å¾·åœ°å›¾çš„èƒ½åŠ›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4246761716322491/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    FanetheDivine
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T13:41:51.000Z" title="Thu Feb 05 2026 13:41:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åŸºç¡€çŸ¥è¯†</h2>
<p>é«˜å¾·åœ°å›¾ä½¿ç”¨GCJ-02åæ ‡ æ˜¯ç»è¿‡åŠ å¯†å˜æ¢åçš„åæ ‡ç³»ç»Ÿ ä¸ç™¾åº¦åœ°å›¾/GPSçš„åæ ‡æœ‰æ‰€ä¸åŒ</p>
<p>å¯ä»¥ä½¿ç”¨<code>AMap.convertFrom</code>å°†GPSè½¬åŒ–ä¸ºé«˜å¾·åæ ‡</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Flbs.amap.com%2Ftools%2Fpicker" target="_blank" title="https://lbs.amap.com/tools/picker" ref="nofollow noopener noreferrer">å®˜æ–¹åæ ‡æ‹¾å–å·¥å…·</a></p>
<h2 data-id="heading-1">å‰æœŸå‡†å¤‡</h2>
<p>ç™»å½•<a href="https://link.juejin.cn?target=https%3A%2F%2Flbs.amap.com%2F" target="_blank" title="https://lbs.amap.com/" ref="nofollow noopener noreferrer">é«˜å¾·å¼€æ”¾å¹³å°</a>ååœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fconsole.amap.com%2Fdev%2Fkey%2Fapp" target="_blank" title="https://console.amap.com/dev/key/app" ref="nofollow noopener noreferrer">æ§åˆ¶å°</a>åˆ›å»ºåº”ç”¨ã€æ·»åŠ key é€‰æ‹©<code>Webç«¯(JS API)</code> å¹¶å¾—åˆ°keyå’Œå®‰å…¨å¯†é’¥</p>
<p>æ¥ä¸‹æ¥ å‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Flbs.amap.com%2Fapi%2Fjavascript-api-v2%2Fguide%2Fabc%2Famap-react" target="_blank" title="https://lbs.amap.com/api/javascript-api-v2/guide/abc/amap-react" ref="nofollow noopener noreferrer">æ–‡æ¡£</a>åœ¨reactæ„å»ºåœ°å›¾ç»„ä»¶</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { <span class="hljs-variable constant_">FC</span>, useEffect, useRef } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">AMapLoader</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@amap/amap-jsapi-loader'</span>

<span class="hljs-keyword">const</span> <span class="hljs-title class_">MapContainer</span>: <span class="hljs-variable constant_">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> mapRef = useRef&lt;<span class="hljs-built_in">any</span>&gt;(<span class="hljs-literal">null</span>)

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">createMap</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">map</span>) =&gt;</span> (mapRef.<span class="hljs-property">current</span> = map))
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      mapRef.<span class="hljs-property">current</span>?.<span class="hljs-title function_">destroy</span>()
    }
  }, [])

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'container'</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'h-full w-full overflow-hidden'</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">MapContainer</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createMap</span>(<span class="hljs-params"/>) {
  ;(<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">_AMapSecurityConfig</span> = {
    <span class="hljs-attr">securityJsCode</span>: <span class="hljs-string">''</span>, <span class="hljs-comment">// å®‰å…¨å¯†é’¥</span>
  }
  <span class="hljs-keyword">const</span> <span class="hljs-title class_">AMap</span> = <span class="hljs-keyword">await</span> <span class="hljs-title class_">AMapLoader</span>.<span class="hljs-title function_">load</span>({
    <span class="hljs-attr">key</span>: <span class="hljs-string">''</span>, <span class="hljs-comment">// key</span>
    <span class="hljs-attr">version</span>: <span class="hljs-string">'2.0'</span>,
    <span class="hljs-attr">plugins</span>: [<span class="hljs-string">'AMap.Scale'</span>],
  })
  <span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AMap</span>.<span class="hljs-title class_">Map</span>(<span class="hljs-string">'container'</span>, {
    <span class="hljs-attr">viewMode</span>: <span class="hljs-string">'2D'</span>,
    <span class="hljs-attr">zoom</span>: <span class="hljs-number">11</span>,
    <span class="hljs-attr">center</span>: [<span class="hljs-number">116.397428</span>, <span class="hljs-number">39.90923</span>],
  })
  <span class="hljs-keyword">return</span> map
}
</code></pre>
<p>æ¥ä¸‹æ¥å°†èšç„¦äº<code>AMap.Map</code>ç±» åœ¨æ„é€ mapå®ä¾‹æ—¶å¯ä»¥æ·»åŠ å…¶ä»–åœ°å›¾èƒ½åŠ› å®ä¾‹æœ¬èº«ä¹Ÿæœ‰å‡½æ•°å¯¹åœ°å›¾è¿›è¡Œæ“ä½œ ä¹Ÿå¯ä»¥ç›‘å¬å…¶ä¸­çš„äº‹ä»¶</p>
<p>å®Œæ•´èƒ½åŠ›å‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Flbs.amap.com%2Fapi%2Fjavascript-api-v2%2Fdocumentation%23map" target="_blank" title="https://lbs.amap.com/api/javascript-api-v2/documentation#map" ref="nofollow noopener noreferrer">AMapå®˜æ–¹æ–‡æ¡£</a></p>
<p>ä¸‹é¢å°†æŒ‰ç…§<a href="https://link.juejin.cn?target=https%3A%2F%2Flbs.amap.com%2Fapi%2Fjavascript-api-v2%2Ftutorails%2Fdisplay-a-map" target="_blank" title="https://lbs.amap.com/api/javascript-api-v2/tutorails/display-a-map" ref="nofollow noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a>çš„ ä»‹ç»é«˜å¾·åœ°å›¾çš„å¸¸è§èƒ½åŠ›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a372a0221f74b038de77cdd99819352~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRmFuZXRoZURpdmluZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770903711&amp;x-signature=pVU39VObbsVYxnL6n9pcbV3eBfs%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-2">å±•ç¤ºåœ°å›¾</h2>
<p>åœ°å›¾çš„å±•ç¤ºä¸ zoom/center/mapStyleå±æ€§æœ‰å…³</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AMap</span>.<span class="hljs-title class_">Map</span>(<span class="hljs-string">'container'</span>, {
    <span class="hljs-attr">zoom</span>: <span class="hljs-number">11</span>,<span class="hljs-comment">// ç¼©æ”¾æ¯” å€¼è¶Šå¤§ åœ°å›¾æ”¾å¤§å€æ•°è¶Šå¤§ å±•ç¤ºçš„èŒƒå›´å°±è¶Šå°</span>
    <span class="hljs-attr">center</span>: [<span class="hljs-number">116.397428</span>, <span class="hljs-number">39.90923</span>],<span class="hljs-comment">//ä¸­å¿ƒç‚¹</span>
    <span class="hljs-attr">mapStyle</span>: <span class="hljs-string">"amap://styles/normal"</span>, <span class="hljs-comment">//åœ°å›¾æ ·å¼</span>
  })
</code></pre>
<p>åœ°å›¾æ ·å¼å‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Flbs.amap.com%2Fapi%2Fjavascript-api-v2%2Ftutorails%2Fdisplay-a-map%23s5" target="_blank" title="https://lbs.amap.com/api/javascript-api-v2/tutorails/display-a-map#s5" ref="nofollow noopener noreferrer">æ–‡æ¡£</a><br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05f752c692194328bf0d462450a808b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRmFuZXRoZURpdmluZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770903711&amp;x-signature=7GHJuXM8ZxuvCnYgkBgbI%2Bq645c%3D" alt="image.png" loading="lazy"/></p>
<p>æ„é€ å‡½æ•°ä¸­ä»…ä¼ å…¥åˆå§‹å€¼ è¿™äº›å±æ€§å¯èƒ½ä¼šè¢«ç”¨æˆ·æ“ä½œä¿®æ”¹ ä¹Ÿå¯ä»¥é€šè¿‡åç»­<code>map.setStatus</code>ä¸»åŠ¨ä¿®æ”¹</p>
<h2 data-id="heading-3">å›¾å±‚</h2>
<p>å›¾å±‚å¯ä»¥æ•´ä½“ä¸ºåœ°å›¾é™„åŠ ä¿¡æ¯</p>
<p>æ·»åŠ å›¾å±‚å‰å
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e7f4d6f9a9d4c4e96663596ae201a8c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRmFuZXRoZURpdmluZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770903711&amp;x-signature=p7mMxyGwFLQMoLEeDCFS%2BxruE9c%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/efdabbc17b384a91ba1502a3d9809ccc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRmFuZXRoZURpdmluZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770903711&amp;x-signature=hYywvudUbLfuHLGHsshyoiOOCzA%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å®˜æ–¹çš„äº¤é€šå›¾å±‚ å¯ä»¥å±•ç¤ºäº¤é€šä¿¡æ¯ä¿¡æ¯æƒ…å†µ</span>
<span class="hljs-keyword">const</span> traffic = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AMap</span>.<span class="hljs-property">TileLayer</span>.<span class="hljs-title class_">Traffic</span>();

<span class="hljs-comment">// å˜æ›´mapçš„å›¾å±‚(å¯ä»¥ä¼ æ•°ç»„)</span>
map.<span class="hljs-title function_">add</span>(traffic)
map.<span class="hljs-title function_">remove</span>(traffic)

<span class="hljs-comment">// æ§åˆ¶æ˜¾éš</span>
traffic.<span class="hljs-title function_">hide</span>()
traffic.<span class="hljs-title function_">show</span>()

</code></pre>
<p>å›¾å±‚å…·æœ‰setOptionsä»¥è®¾ç½®å±æ€§</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Flbs.amap.com%2Fapi%2Fjavascript-api-v2%2Fguide%2Flayers%2Fofficial-layers" target="_blank" title="https://lbs.amap.com/api/javascript-api-v2/guide/layers/official-layers" ref="nofollow noopener noreferrer">å®˜æ–¹å›¾å±‚</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Flbs.amap.com%2Fapi%2Fjavascript-api-v2%2Fdocumentation%23%25e9%25ab%2598%25e5%25be%25b7%25e5%25ae%2598%25e6%2596%25b9%25e5%259b%25be%25e5%25b1%2582" target="_blank" title="https://lbs.amap.com/api/javascript-api-v2/documentation#%e9%ab%98%e5%be%b7%e5%ae%98%e6%96%b9%e5%9b%be%e5%b1%82" ref="nofollow noopener noreferrer">å®Œæ•´çš„å›¾å±‚æ–‡æ¡£</a></p>
<h2 data-id="heading-4">æ§ä»¶</h2>
<p>æŒ‡åœ°å›¾ä¸Šçš„å„ç§æŒ‰é’® å¦‚ç¼©æ”¾ã€æ¯”ä¾‹å°ºç­‰ ä½ç½®ä»…ä¸åœ°å›¾å®¹å™¨å…³è” ä¸ä¸åæ ‡ç›¸å…³</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bef2201865834568b9e1335f798e28b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRmFuZXRoZURpdmluZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770903711&amp;x-signature=3OmHq22C6GpVDczVSTH8VvLeQZ8%3D" alt="image.png" loading="lazy"/></p>
<p>éœ€è¦åŠ¨æ€å¼•å…¥æ§ä»¶ å¹¶é€šè¿‡mapçš„addControlå°†å…¶æ’å…¥åœ°å›¾ä¸­</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-title class_">AMap</span>.<span class="hljs-title function_">plugin</span>(<span class="hljs-string">'AMap.ToolBar'</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> toolbar = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AMap</span>.<span class="hljs-title class_">ToolBar</span>() <span class="hljs-comment">// ç¼©æ”¾å™¨</span>
    map.<span class="hljs-title function_">addControl</span>(toolbar)

  })    
   
    <span class="hljs-comment">// å¦‚æœéœ€è¦ç§»é™¤æ§ä»¶</span>
    map.<span class="hljs-title function_">removeControl</span>(toolbar)
    
    <span class="hljs-comment">// æ§åˆ¶æ˜¾éš</span>
    toolbar.<span class="hljs-title function_">hide</span>()
    toolbar.<span class="hljs-title function_">show</span>()
</code></pre>
<p>æ§ä»¶æ˜¯æ’ä»¶ç³»ç»Ÿçš„ä¸€éƒ¨åˆ† é«˜å¾·åœ°å›¾æä¾›äº†<a href="https://link.juejin.cn?target=https%3A%2F%2Flbs.amap.com%2Fapi%2Fjavascript-api-v2%2Fguide%2Fabc%2Fplugins-list" target="_blank" title="https://lbs.amap.com/api/javascript-api-v2/guide/abc/plugins-list" ref="nofollow noopener noreferrer">å®˜æ–¹æ’ä»¶</a></p>
<h2 data-id="heading-5">ç‚¹æ ‡è®°</h2>
<p>ä¸æ§ä»¶ç›¸æ¯” ç‚¹æ ‡è®°å¯ä»¥æ·»åŠ å¤šä¸ªç›¸åŒç±»å‹çš„</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79a6a2a6cf73484a9949d4af6a428c7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRmFuZXRoZURpdmluZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770903711&amp;x-signature=6V1V2nAXwkUCZoxBRwNRJlmmVb8%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-comment">//ç‚¹æ ‡è®°æ˜¾ç¤ºå†…å®¹ outerHTML</span>
  <span class="hljs-keyword">const</span> markerContent = <span class="hljs-string">`&lt;img src="//a.amap.com/jsapi_demos/static/demo-center/icons/dir-via-marker.png"&gt;`</span>
  <span class="hljs-comment">// ç‚¹æ ‡è®°ç»çº¬åº¦</span>
  <span class="hljs-keyword">const</span> position = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AMap</span>.<span class="hljs-title class_">LngLat</span>(<span class="hljs-number">116.397428</span>, <span class="hljs-number">39.90923</span>)
  <span class="hljs-keyword">const</span> marker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AMap</span>.<span class="hljs-title class_">Marker</span>({
    position,
    <span class="hljs-attr">content</span>: markerContent,
    <span class="hljs-comment">// positionæ˜¯markerå·¦ä¸Šè§’çš„åæ ‡ offsetæ˜¯åœ¨æ­¤åŸºç¡€ä¸Šçš„åç§»</span>
    <span class="hljs-comment">// æ­¤å¤„æ˜¯ä¸ºäº†è®©markerçš„ä¸‹è¾¹ä¸­å¿ƒå¤„äºpositionä½ç½®</span>
    <span class="hljs-attr">offset</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">AMap</span>.<span class="hljs-title class_">Pixel</span>(-<span class="hljs-number">13</span>, -<span class="hljs-number">30</span>),
    <span class="hljs-attr">draggable</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å…è®¸æ‹–æ‹½</span>
  })
  
  <span class="hljs-comment">// æ·»åŠ /ç§»é™¤ç‚¹æ ‡è®°</span>
  map.<span class="hljs-title function_">add</span>(marker)
  map.<span class="hljs-title function_">remove</span>(marker)
  <span class="hljs-comment">// ç›‘å¬æ ‡è®°äº‹ä»¶ </span>
  marker.<span class="hljs-title function_">on</span>(<span class="hljs-string">'click'</span>, <span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>)
</code></pre>
<p>ç‚¹æ ‡è®°çš„offsetç±»å‹æ˜¯<a href="https://link.juejin.cn?target=https%3A%2F%2Flbs.amap.com%2Fapi%2Fjavascript-api-v2%2Fdocumentation%23pixel" target="_blank" title="https://lbs.amap.com/api/javascript-api-v2/documentation#pixel" ref="nofollow noopener noreferrer">Amap.Pixel</a> å•ä½æ˜¯px</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Flbs.amap.com%2Fapi%2Fjavascript-api-v2%2Fdocumentation%23%25e7%2582%25b9%25e6%25a0%2587%25e8%25ae%25b0" target="_blank" title="https://lbs.amap.com/api/javascript-api-v2/documentation#%e7%82%b9%e6%a0%87%e8%ae%b0" ref="nofollow noopener noreferrer">å®Œæ•´çš„ç‚¹æ ‡è®°æ–‡æ¡£</a></p>
<h2 data-id="heading-6">å¤šè¾¹å½¢</h2>
<p>åœ¨åœ°å›¾ä¸Šç»˜åˆ¶å¤šè¾¹å½¢</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c7616d86a394c7f8bdbe48e5260614b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRmFuZXRoZURpdmluZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770903711&amp;x-signature=QGoBDQo85d5KAbJgHuP60EpKhEo%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-keyword">const</span> path = [
    [
      [<span class="hljs-number">116.35</span>, <span class="hljs-number">39.92</span>],
      [<span class="hljs-number">116.46</span>, <span class="hljs-number">39.92</span>],
      [<span class="hljs-number">116.46</span>, <span class="hljs-number">39.86</span>],
      [<span class="hljs-number">116.35</span>, <span class="hljs-number">39.86</span>],
    ],
  ]

  <span class="hljs-keyword">const</span> polygon = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AMap</span>.<span class="hljs-title class_">Polygon</span>({
    <span class="hljs-attr">path</span>: path,
    <span class="hljs-attr">draggable</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å…è®¸æ‹–æ‹½</span>
  })
  map.<span class="hljs-title function_">add</span>(polygon)
</code></pre>
<p>pathæŒ‰ç…§é¡ºæ—¶é’ˆé¡ºåº</p>
<p>å¦‚æœéœ€è¦é•‚ç©ºå¤šè¾¹å½¢</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-keyword">const</span> path = [
    [
      [<span class="hljs-number">116.35</span>, <span class="hljs-number">39.92</span>],
      [<span class="hljs-number">116.46</span>, <span class="hljs-number">39.92</span>],
      [<span class="hljs-number">116.46</span>, <span class="hljs-number">39.86</span>],
      [<span class="hljs-number">116.35</span>, <span class="hljs-number">39.86</span>],
    ],
    <span class="hljs-comment">// åé¢çš„æ‰€æœ‰åæ ‡éƒ½é•‚ç©º</span>
    [
      [<span class="hljs-number">116.359</span>, <span class="hljs-number">39.9</span>],
      [<span class="hljs-number">116.4</span>, <span class="hljs-number">39.9</span>],
      [<span class="hljs-number">116.4</span>, <span class="hljs-number">39.869</span>],
      [<span class="hljs-number">116.359</span>, <span class="hljs-number">39.869</span>],
    ],
  ]
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad24573ca6664a3c9021c773df7ea366~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRmFuZXRoZURpdmluZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770903711&amp;x-signature=AdrmRPljX0GvVTfzduWUWsJeiF4%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥ç”¨<code>polygon.on</code>æ·»åŠ äº‹ä»¶ é•‚ç©ºçš„éƒ¨åˆ†ä¸è§¦å‘äº‹ä»¶</p>
<p>å¯ä»¥ç”¨<code>polygon.setOptions</code>è°ƒæ•´é¢œè‰²æ ·å¼é€æ˜åº¦ç­‰</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Flbs.amap.com%2Fapi%2Fjavascript-api-v2%2Fdocumentation%23%25e7%259f%25a2%25e9%2587%258f%25e5%259b%25be%25e5%25bd%25a2" target="_blank" title="https://lbs.amap.com/api/javascript-api-v2/documentation#%e7%9f%a2%e9%87%8f%e5%9b%be%e5%bd%a2" ref="nofollow noopener noreferrer">å¤šè¾¹å½¢æ–‡æ¡£</a></p>
<p>å¦‚æœéœ€è¦èŠ‚ç‚¹å¯æ‹–æ‹½ å‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Flbs.amap.com%2Fapi%2Fjavascript-api-v2%2Fguide%2Famap-polygon%2Fpolygon%23t2" target="_blank" title="https://lbs.amap.com/api/javascript-api-v2/guide/amap-polygon/polygon#t2" ref="nofollow noopener noreferrer">å¤šè¾¹å½¢ç¼–è¾‘æ–‡æ¡£</a></p>
<h2 data-id="heading-7">è·¯å¾„ä¿¡æ¯</h2>
<p>å¯ä»¥ä½¿ç”¨å®˜æ–¹çš„è·¯å¾„è§„åˆ’èƒ½åŠ› å‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Flbs.amap.com%2Fapi%2Fjavascript-api-v2%2Ftutorails%2Fcar-dir" target="_blank" title="https://lbs.amap.com/api/javascript-api-v2/tutorails/car-dir" ref="nofollow noopener noreferrer">æ–‡æ¡£</a></p>
<h3 data-id="heading-8">è‡ªå®šä¹‰è·¯å¾„ç»˜åˆ¶</h3>
<p>ä½¿ç”¨Polylines</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-keyword">const</span> path = [
    [<span class="hljs-number">116.4</span>, <span class="hljs-number">39.869</span>],
    [<span class="hljs-number">116.46</span>, <span class="hljs-number">39.86</span>],
    [<span class="hljs-number">116.35</span>, <span class="hljs-number">39.92</span>],
    [<span class="hljs-number">116.35</span>, <span class="hljs-number">39.86</span>],
  ]
  <span class="hljs-keyword">const</span> polyline = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AMap</span>.<span class="hljs-title class_">Polyline</span>({
    path,
    <span class="hljs-attr">strokeWeight</span>: <span class="hljs-number">10</span>,
    <span class="hljs-attr">showDir</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">strokeOpacity</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">lineJoin</span>: <span class="hljs-string">'round'</span>,
    <span class="hljs-attr">lineCap</span>: <span class="hljs-string">'round'</span>,
  })
  map.<span class="hljs-title function_">add</span>(polyline)
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29689b0dd3ef41e09eb97d7eca505964~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRmFuZXRoZURpdmluZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770903711&amp;x-signature=WGFsDY5GEYJQtopJOcSD29q8e4g%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[[ç¡¬æ ¸] åŒæŒ‡é’ˆè¿›é˜¶ï¼šä»â€œå¯¹æ’â€åˆ°â€œæ»‘åŠ¨çª—å£â€çš„æ€ç»´è·ƒè¿]]></title>    <link>https://juejin.cn/post/7603219519666929683</link>    <guid>https://juejin.cn/post/7603219519666929683</guid>    <pubDate>2026-02-05T13:53:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603219519666929683" data-draft-id="7603142147643113515" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="[ç¡¬æ ¸] åŒæŒ‡é’ˆè¿›é˜¶ï¼šä»â€œå¯¹æ’â€åˆ°â€œæ»‘åŠ¨çª—å£â€çš„æ€ç»´è·ƒè¿"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-02-05T13:53:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="NEXT06"/> <meta itemprop="url" content="https://juejin.cn/user/1176918763246011"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            [ç¡¬æ ¸] åŒæŒ‡é’ˆè¿›é˜¶ï¼šä»â€œå¯¹æ’â€åˆ°â€œæ»‘åŠ¨çª—å£â€çš„æ€ç»´è·ƒè¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1176918763246011/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    NEXT06
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T13:53:23.000Z" title="Thu Feb 05 2026 13:53:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨ä¸Šä¸€ç¯‡å…³äºâ€œä¸‰æ•°ä¹‹å’Œâ€çš„æ¢è®¨ä¸­ï¼Œæˆ‘ä»¬æ·±å…¥å‰–æäº†å¦‚ä½•åˆ©ç”¨<strong>æ’åº</strong>å’Œ<strong>å¯¹æ’åŒæŒ‡é’ˆ</strong>ï¼ˆLeft æŒ‡é’ˆå‘å³ï¼ŒRight æŒ‡é’ˆå‘å·¦ï¼‰ï¼Œå°†Â </p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(n3)<span class="hljs-built_in">O</span>(n3)
</code></pre>
<p>Â çš„æš´åŠ›è§£æ³•ä¼˜åŒ–è‡³Â </p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(n2)<span class="hljs-built_in">O</span>(n2)
</code></pre>
<p>ã€‚</p>
<p>ç„¶è€Œï¼Œåœ¨å‰ç«¯ç®—æ³•é¢è¯•ä¸­ï¼Œè¿˜æœ‰å¦ä¸€ç±»æ¶‰åŠæ•°ç»„å’Œå­—ç¬¦ä¸²å¤„ç†çš„é«˜é¢‘é¢˜ç›®ï¼Œå®ƒä»¬åŒæ ·ä¾èµ–åŒæŒ‡é’ˆï¼Œä½†æŒ‡é’ˆçš„ç§»åŠ¨æ–¹å‘å´ä¸å†æ˜¯â€œç›¸å¯¹è€Œè¡Œâ€ï¼Œè€Œæ˜¯â€œåŒå‘è€Œè¡Œâ€ã€‚è¿™ç§ç‰¹æ®Šçš„åŒæŒ‡é’ˆæ¨¡å¼ï¼Œå°±æ˜¯<strong>æ»‘åŠ¨çª—å£ï¼ˆSliding Windowï¼‰</strong> ã€‚</p>
<p>æœ¬æ–‡å°†ä»¥ LeetCode 209 é¢˜â€œé•¿åº¦æœ€å°çš„å­æ•°ç»„â€ä¸ºä¾‹ï¼Œå‰–æä»æš´åŠ›æ³•åˆ°æ»‘åŠ¨çª—å£çš„æ€ç»´è·¯å¾„ï¼Œå¹¶é‡ç‚¹è®²è§£å¦‚ä½•è¿›è¡Œå‡æ‘Šå¤æ‚åº¦åˆ†æã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ æ¨¡å¼å¯¹æ¯”ï¼šå¯¹æ’ vs æ»‘åŠ¨</h2>
<p>åœ¨è¿›å…¥å…·ä½“é¢˜ç›®å‰ï¼Œæˆ‘ä»¬éœ€è¦å»ºç«‹æŠ½è±¡çš„å‡ ä½•ç›´è§‰ã€‚</p>
<ul>
<li>
<p><strong>å¯¹æ’æŒ‡é’ˆï¼ˆå¦‚ä¸‰æ•°ä¹‹å’Œï¼‰</strong> ï¼š</p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šæ•°ç»„æœ‰åºï¼Œæ±‚å›ºå®šå’Œã€‚</li>
<li><strong>å½¢æ€</strong>ï¼šL -&gt; ... &lt;- Rã€‚åŒºé—´ä¸¤ç«¯å‘ä¸­é—´æŒ¤å‹ã€‚</li>
<li><strong>é€»è¾‘</strong>ï¼šæ ¹æ®å½“å‰å’Œä¸ç›®æ ‡å€¼çš„å¤§å°ï¼Œå†³å®šæ˜¯èˆå¼ƒå·¦è¾¹ï¼ˆå˜å¤§ï¼‰è¿˜æ˜¯èˆå¼ƒå³è¾¹ï¼ˆå˜å°ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ»‘åŠ¨çª—å£ï¼ˆåŒå‘åŒæŒ‡é’ˆï¼‰</strong> ï¼š</p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šå¯»æ‰¾æ»¡è¶³æ¡ä»¶çš„è¿ç»­å­æ•°ç»„/å­ä¸²ã€‚</li>
<li><strong>å½¢æ€</strong>ï¼š[L ... R] -&gt;ã€‚åƒä¸€åªæ¯›æ¯›è™«ï¼ŒR å…ˆèµ°ï¼ˆæ‰©å¼ ï¼‰ï¼ŒL éšåï¼ˆæ”¶ç¼©ï¼‰ã€‚</li>
<li><strong>é€»è¾‘</strong>ï¼šR è´Ÿè´£å¯»æ‰¾å¯è¡Œè§£ï¼ŒL è´Ÿè´£ä¼˜åŒ–è§£ï¼ˆå¯»æ‰¾æœ€çŸ­/æœ€ä¼˜ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5297fefadd0a4f5ea017ce1a43874ea2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTkVYVDA2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770904403&amp;x-signature=j%2BZgJKCRFiso140Bb2pQFdu55bA%3D" alt="å±å¹•å½•åˆ¶ 2026-02-05 185039.gif" loading="lazy"/></p>
<h2 data-id="heading-2">äºŒã€ é¢˜ç›®è§£æï¼šé•¿åº¦æœ€å°çš„å­æ•°ç»„</h2>
<p><strong>é¢˜ç›®æè¿°</strong>ï¼š<br/>
ç»™å®šä¸€ä¸ªå«æœ‰Â nÂ ä¸ªæ­£æ•´æ•°çš„æ•°ç»„Â numsÂ å’Œä¸€ä¸ªæ­£æ•´æ•°Â targetÂ ã€‚æ‰¾å‡ºè¯¥æ•°ç»„ä¸­æ»¡è¶³å…¶å’ŒÂ â‰¥ targetÂ çš„é•¿åº¦æœ€å°çš„Â <strong>è¿ç»­å­æ•°ç»„</strong>ï¼Œå¹¶è¿”å›å…¶é•¿åº¦ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œè¿”å› 0ã€‚</p>
<h3 data-id="heading-3">1. æš´åŠ›è§£æ³•</h3>
<p>æœ€ç›´è§‚çš„æ€è·¯æ˜¯ï¼šä»¥æ¯ä¸€ä¸ªå…ƒç´ Â nums[i]Â ä¸ºèµ·ç‚¹ï¼Œå‘åå¯»æ‰¾ï¼Œç›´åˆ°å’Œå¤§äºç­‰äºÂ targetï¼Œè®°å½•é•¿åº¦ï¼Œç„¶åå¯¹æ¯”å–æœ€å°å€¼ã€‚</p>
<p>JavaScript</p>
<pre><code class="hljs language-ini" lang="ini">// ä¼ªä»£ç 
for (let <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; n; i++) {</span>
    let <span class="hljs-attr">sum</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
    for (let <span class="hljs-attr">j</span> = i<span class="hljs-comment">; j &lt; n; j++) {</span>
        sum += nums<span class="hljs-section">[j]</span><span class="hljs-comment">;</span>
        if (sum &gt;= target) {
            <span class="hljs-attr">minLen</span> = Math.min(minLen, j - i + <span class="hljs-number">1</span>)<span class="hljs-comment">;</span>
            break<span class="hljs-comment">; // æ‰¾åˆ°ä»¥ i å¼€å¤´çš„æœ€çŸ­è§£ï¼Œbreak</span>
        }
    }
}
</code></pre>
<p>è¿™ç§è§£æ³•å­˜åœ¨å¤§é‡çš„é‡å¤è®¡ç®—ã€‚å½“æˆ‘ä»¬ä»Â iÂ ç§»åŠ¨åˆ°Â i+1Â æ—¶ï¼Œä¹‹å‰çš„åŒºé—´å’Œå®Œå…¨é‡æ–°è®¡ç®—äº†ï¼Œæµªè´¹äº†å·²çŸ¥ä¿¡æ¯ã€‚</p>
<h3 data-id="heading-4">2. æ»‘åŠ¨çª—å£è§£æ³•</h3>
<p>æˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆÂ leftÂ å’ŒÂ rightÂ ç»´æŠ¤ä¸€ä¸ªçª—å£ã€‚</p>
<ol>
<li><strong>æ‰©å¼ </strong>ï¼šrightÂ ä¸»åŠ¨å‘å³èµ°ï¼Œç´¯åŠ çª—å£å†…çš„å’ŒÂ sumã€‚</li>
<li><strong>æ”¶ç¼©</strong>ï¼šå½“Â sum &gt;= targetÂ æ—¶ï¼Œè¯´æ˜æ‰¾åˆ°äº†ä¸€ä¸ªå¯è¡Œè§£ã€‚æ­¤æ—¶ï¼ŒrightÂ åœä¸‹ï¼ŒleftÂ å¼€å§‹å‘å³èµ°ï¼Œè¯•æ¢èƒ½å¦åœ¨ä¿æŒÂ sum &gt;= targetÂ çš„å‰æä¸‹ç¼©å°çª—å£é•¿åº¦ï¼ˆä¼˜åŒ–è§£ï¼‰ã€‚</li>
</ol>
<p>JavaScript</p>
<pre><code class="hljs language-ini" lang="ini">/**
 * @param {number} target
 * @param {number<span class="hljs-section">[]</span>} nums
 * @return {number}
 */
var <span class="hljs-attr">minSubArrayLen</span> = function(target, nums) {
    let <span class="hljs-attr">left</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
    let <span class="hljs-attr">right</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
    let <span class="hljs-attr">sum</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
    let <span class="hljs-attr">minLen</span> = Infinity<span class="hljs-comment">; // åˆå§‹åŒ–ä¸ºæ— ç©·å¤§</span>
    
    const <span class="hljs-attr">len</span> = nums.length<span class="hljs-comment">;</span>
    
    while (right &lt; len) {
        // 1. è¿›çª—å£ï¼šç´¯åŠ å½“å‰å…ƒç´ 
        sum += nums<span class="hljs-section">[right]</span><span class="hljs-comment">;</span>
        
        // 2. æ»¡è¶³æ¡ä»¶ï¼šå°è¯•æ”¶ç¼©çª—å£ï¼Œå¯»æ‰¾æ›´ä¼˜è§£
        while (sum &gt;= target) {
            // æ›´æ–°æœ€å°é•¿åº¦
            <span class="hljs-attr">minLen</span> = Math.min(minLen, right - left + <span class="hljs-number">1</span>)<span class="hljs-comment">;</span>
            
            // å‡ºçª—å£ï¼šå‡å»å·¦è¾¹çš„å…ƒç´ 
            sum <span class="hljs-attr">-</span>= nums[left]<span class="hljs-comment">;</span>
            // å·¦æŒ‡é’ˆå³ç§»
            left++<span class="hljs-comment">;</span>
        }
        
        // ç»§ç»­æ‰©å¼ 
        right++<span class="hljs-comment">;</span>
    }
    
    return <span class="hljs-attr">minLen</span> === Infinity ? <span class="hljs-number">0</span> : minLen<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b36b0780f72c4533a95aa7f830639f4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTkVYVDA2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770904403&amp;x-signature=wapwgWVVLShuDdJO%2FrsDx6Fz94E%3D" alt="å±å¹•å½•åˆ¶ 2026-02-05 190406.gif" loading="lazy"/></p>
<h2 data-id="heading-5">ä¸‰ã€ æ ¸å¿ƒéš¾ç‚¹ï¼šæ—¶é—´å¤æ‚åº¦åˆ†æ</h2>
<p>è¿™æ˜¯ä¸€ä¸ªé¢è¯•ä¸­çš„é«˜é¢‘é™·é˜±ã€‚</p>
<p>å¾ˆå¤šå€™é€‰äººçœ‹åˆ°ä»£ç ä¸­æœ‰ä¸€ä¸ªÂ while (right &lt; len)Â å¾ªç¯ï¼Œå†…éƒ¨åµŒå¥—äº†ä¸€ä¸ªÂ while (sum &gt;= target)Â å¾ªç¯ï¼Œä¼šä¸‹æ„è¯†åœ°è®¤ä¸ºæ—¶é—´å¤æ‚åº¦æ˜¯Â </p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(n2)<span class="hljs-built_in">O</span>(n2)
</code></pre>
<p>ã€‚</p>
<p><strong>è¿™æ˜¯é”™è¯¯çš„ã€‚</strong></p>
<p><strong>åˆ†æé€»è¾‘</strong>ï¼š<br/>
æ—¶é—´å¤æ‚åº¦çœ‹çš„æ˜¯<strong>åŸºæœ¬æ“ä½œçš„æ‰§è¡Œæ¬¡æ•°</strong>ã€‚<br/>
åœ¨æ•´ä¸ªç®—æ³•è¿è¡Œè¿‡ç¨‹ä¸­ï¼š</p>
<ol>
<li>rightÂ æŒ‡é’ˆï¼šä» 0 èµ°åˆ°Â n-1ï¼Œæ¯ä¸ªå…ƒç´ è¿›çª—å£ 1 æ¬¡ã€‚æ€»å…±ç§»åŠ¨Â nÂ æ¬¡ã€‚</li>
<li>leftÂ æŒ‡é’ˆï¼šä» 0 èµ°åˆ°Â n-1ï¼ˆæœ€å¤šï¼‰ï¼Œæ¯ä¸ªå…ƒç´ å‡ºçª—å£ 1 æ¬¡ã€‚æ€»å…±ç§»åŠ¨Â nÂ æ¬¡ã€‚</li>
</ol>
<p><strong>ç»“è®º</strong>ï¼š<br/>
å°½ç®¡æ˜¯åŒå±‚å¾ªç¯ï¼Œä½†ä¸¤ä¸ªæŒ‡é’ˆéƒ½æ˜¯å•è°ƒé€’å¢çš„ï¼Œä¸ä¼šå›é€€ã€‚æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ æœ€å¤šè¢«æ“ä½œä¸¤æ¬¡ï¼ˆè¿›ä¸€æ¬¡ï¼Œå‡ºä¸€æ¬¡ï¼‰ã€‚<br/>
æ€»æ“ä½œæ¬¡æ•°ä¸ºÂ 2n2nï¼Œå¸¸æ•°å¿½ç•¥ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦ä¸ºÂ <strong><code>O(n)</code></strong>ã€‚</p>
<p>è¿™ç§åˆ†ææ–¹æ³•è¢«ç§°ä¸º<strong>å‡æ‘Šå¤æ‚åº¦åˆ†æ</strong>ã€‚</p>
<h2 data-id="heading-6">å››ã€ æ€»ç»“ä¸é€šç”¨æ¨¡æ¿</h2>
<p>æ»‘åŠ¨çª—å£ç®—æ³•æœ¬è´¨ä¸Šæ˜¯ç»´æŠ¤äº†ä¸€ç»„æ»¡è¶³ç‰¹å®šè§„åˆ™çš„æ•°æ®é›†åˆã€‚è§£å†³æ­¤ç±»é—®é¢˜çš„é€šç”¨æ¨¡æ¿å¦‚ä¸‹ï¼š</p>
<p>JavaScript</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">/* æ»‘åŠ¨çª—å£é€šç”¨æ¨¡æ¿ */</span>
function <span class="hljs-built_in">slidingWindow</span>(nums) {
    let <span class="hljs-attribute">left</span> = <span class="hljs-number">0</span>, <span class="hljs-attribute">right</span> = <span class="hljs-number">0</span>;
    
    while (right &lt; nums.length) {
        <span class="hljs-comment">// c æ˜¯å°†ç§»å…¥çª—å£çš„å­—ç¬¦</span>
        let c = nums<span class="hljs-selector-attr">[right]</span>;
        <span class="hljs-comment">// 1. å³ç§»çª—å£ï¼Œè¿›è¡Œæ•°æ®æ›´æ–°</span>
        ...
        
        <span class="hljs-comment">// 2. åˆ¤æ–­å·¦ä¾§çª—å£æ˜¯å¦è¦æ”¶ç¼© (æ ¹æ®é¢˜ç›®æ¡ä»¶ï¼šå¦‚ sum &gt;= target æˆ– çª—å£é•¿åº¦è¶…é™)</span>
        while (window needs shrink) {
            <span class="hljs-comment">// d æ˜¯å°†ç§»å‡ºçª—å£çš„å­—ç¬¦</span>
            let d = nums<span class="hljs-selector-attr">[left]</span>;
            <span class="hljs-comment">// 3. å·¦ç§»çª—å£ï¼Œè¿›è¡Œæ•°æ®æ›´æ–°</span>
            ...
            <span class="hljs-attribute">left</span>++;
        }
        <span class="hljs-attribute">right</span>++;
    }
}
</code></pre>
<p>ä»â€œä¸‰æ•°ä¹‹å’Œâ€çš„<strong>å¯¹æ’æŒ‡é’ˆ</strong>ï¼Œåˆ°â€œæœ€å°å­æ•°ç»„â€çš„<strong>æ»‘åŠ¨çª—å£</strong>ï¼Œæˆ‘ä»¬å®Œæˆäº†ä»<strong>é™æ€ä½ç½®åˆ¤å®š</strong>åˆ°<strong>åŠ¨æ€åŒºé—´ç»´æŠ¤</strong>çš„è¿›é˜¶ã€‚æŒæ¡äº†è¿™ä¸¤ä¸ªæ¨¡å‹ï¼Œå°±æ”»å…‹äº†æ•°ç»„ç®—æ³•é¢˜çš„åŠå£æ±Ÿå±±ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¢ç´¢JSä½œç”¨åŸŸ]]></title>    <link>https://juejin.cn/post/7602991346586124322</link>    <guid>https://juejin.cn/post/7602991346586124322</guid>    <pubDate>2026-02-05T15:14:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602991346586124322" data-draft-id="7603201727714934836" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¢ç´¢JSä½œç”¨åŸŸ"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-05T15:14:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¶åƒä½³æ²›"/> <meta itemprop="url" content="https://juejin.cn/user/2561180400626944"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¢ç´¢JSä½œç”¨åŸŸ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2561180400626944/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¶åƒä½³æ²›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T15:14:46.000Z" title="Thu Feb 05 2026 15:14:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¼•è¨€ï¼šåœ¨æ–°æ‰‹å­¦JSæœ€æ˜“æ‡µçš„3ä¸ªç‚¹â€”â€”ä½œç”¨åŸŸã€é—­åŒ…ã€åŸå‹ï¼Œå…¶ä¸­ä½œç”¨åŸŸæ˜¯åŸºç¡€</p>
<h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯ JS ä½œç”¨åŸŸ</h2>
<p>å¤§ç™½è¯ï¼šä½œç”¨åŸŸå°±æ˜¯â€œå˜é‡/å‡½æ•°çš„å¯ç”¨èŒƒå›´â€â€”â€”å“ªé‡Œèƒ½è®¿é—®ï¼Œå“ªé‡Œä¸èƒ½è®¿é—®ï¼Œç”±å®ƒçš„â€œå‡ºç”Ÿåœ°â€å†³å®š</p>
<p>å…¶ä¸­ï¼Œå¯åˆ†ä¸ºä¸‰å¤§ä½œç”¨åŸŸï¼ˆå…¨å±€ä½œç”¨åŸŸï¼Œå‡½æ•°ä½œç”¨åŸŸï¼Œå—çº§ä½œç”¨åŸŸï¼‰</p>
<h3 data-id="heading-1">1.å…¨å±€ä½œç”¨åŸŸ</h3>
<p>é¡¾åæ€ä¹‰ï¼Œè¯¥ä½œç”¨åŸŸä½œç”¨äºå…¨å±€ï¼Œåœ¨è¯¥ä½œç”¨åŸŸå£°æ˜çš„å˜é‡èƒ½åœ¨ä»»ä½•åœ°æ–¹è¢«è®¿é—®</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> a = <span class="hljs-number">100</span>

<span class="hljs-keyword">if</span>(<span class="hljs-literal">true</span>){
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a) <span class="hljs-comment">// 100</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>){
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a)
}
<span class="hljs-title function_">foo</span>() <span class="hljs-comment">// 100</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a) <span class="hljs-comment">// 100</span>
</code></pre>
<p>ç”±æ­¤å¯è§ ï¼š åœ¨å…¨å±€ä½œç”¨åŸŸå£°æ˜çš„å˜é‡ï¼Œåœ¨è¯­å¥ï¼ˆä¾‹å¦‚ if ï¼‰ï¼Œ å‡½æ•°ï¼Œ å…¨å±€å†…å‡èƒ½è®¿é—®åˆ°ã€‚</p>
<h3 data-id="heading-2">2. å‡½æ•°ä½œç”¨åŸŸ</h3>
<p>è¯¥ä½œç”¨åŸŸä½œç”¨äºå‡½æ•°å†…éƒ¨ï¼Œä»…åœ¨å‡½æ•°å†…éƒ¨ç”Ÿæ•ˆï¼Œå‡½æ•°çš„å½¢å‚ä¹ŸåŒ…å«åœ¨å‡½æ•°ä½œç”¨åŸŸå†…éƒ¨</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>){
  <span class="hljs-keyword">var</span> a = <span class="hljs-number">100</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a)
}

<span class="hljs-title function_">foo</span>() <span class="hljs-comment">// 100</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a) <span class="hljs-comment">// æœªå®šä¹‰</span>
</code></pre>
<p>ç”±æ­¤å¯è§ï¼Œå®šä¹‰åœ¨å‡½æ•°å†…éƒ¨çš„å˜é‡æ— æ³•åœ¨å‡½æ•°ä½œç”¨åŸŸå¤–è®¿é—®åˆ°</p>
<h3 data-id="heading-3">3.å—çº§ä½œç”¨åŸŸ</h3>
<p>å—çº§ä½œç”¨åŸŸ (let,const å’Œ  { } è¯­æ³•é…åˆä½¿ç”¨ä¼šå¯¼è‡´å£°æ˜çš„å˜é‡å¤„åœ¨ä¸€ä¸ªä½œç”¨åŸŸä¸­)</p>
<pre><code class="hljs language-js" lang="js">{
  <span class="hljs-keyword">var</span> a = <span class="hljs-number">100</span>
}
{
  <span class="hljs-keyword">let</span> b = <span class="hljs-number">200</span>
}
{
  <span class="hljs-keyword">const</span> c = <span class="hljs-number">300</span>
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a) <span class="hljs-comment">// 100</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b) <span class="hljs-comment">// æœªå®šä¹‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(c) <span class="hljs-comment">// æœªå®šä¹‰</span>
</code></pre>
<p>å¦‚ä¸Šè¿°ä»£ç æ‰€ç¤ºï¼Œåœ¨è¢«{ } åŒ…è£¹ var å£°æ˜çš„ a è¿˜æ˜¯èƒ½åœ¨å…¨å±€è®¿é—®åˆ°ï¼Œ è€Œ let / const å£°æ˜çš„å˜é‡åˆ™ä¸èƒ½è¢«å…¨å±€è®¿é—®åˆ°ï¼Œè¿™æ˜¯å› ä¸ºä»–ä»¬å½¢æˆäº†è‡ªå·±çš„å—çº§ä½œç”¨åŸŸ</p>
<hr/>
<h2 data-id="heading-4">ä½œç”¨åŸŸçš„æ ¸å¿ƒè§„åˆ™</h2>
<h3 data-id="heading-5">1.å˜é‡æå‡ï¼ˆvarçš„â€œå‘â€ï¼Œlet/constçš„ä¼˜åŒ–ï¼‰</h3>
<p>å…ˆæ¥è°ˆè°ˆä½•ä¸ºå˜é‡æå‡</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> a = <span class="hljs-number">100</span> 
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a) <span class="hljs-comment">// 100</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b) <span class="hljs-comment">// undefined</span>
<span class="hljs-keyword">var</span> b = <span class="hljs-number">200</span>

</code></pre>
<p>ç”± var å®šä¹‰çš„å˜é‡ä¼šå­˜åœ¨å˜é‡æå‡çš„ç°è±¡ï¼Œå°±å¥½åƒå¤´å’Œèº«å­åˆ†ç¦»äº†ï¼Œa çš„ä¾‹å­çœ‹ä¸å‡ºæ¥ï¼Œ b å°±è±ç„¶å¼€æœ—äº†ï¼Œ
ä¸€èˆ¬åˆ«çš„è¯­è¨€è¿™ä¸ªæ—¶å€™å°±å·²ç»å¼€å§‹æŠ¥é”™äº†ï¼Œä½†æ˜¯ JS çš„ var ä¸ä¸€æ ·ï¼Œå®ƒç‰¹æ®Šï¼Œåœ¨ V8 å¼•æ“é‡Œå®ƒé•¿è¿™æ ·</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> a = <span class="hljs-number">100</span> 
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a) <span class="hljs-comment">// 100</span>

<span class="hljs-keyword">var</span> b
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b) <span class="hljs-comment">// undefined</span>
b = <span class="hljs-number">200</span>
</code></pre>
<p>å¯ä»¥çœ‹åˆ° b çš„å£°æ˜è·‘åˆ°å‰é¢å»äº†ï¼Œè¿™ç§ç°è±¡æˆ‘ä»¬ç§°ä¹‹ä¸ºå˜é‡æå‡</p>
<p>åˆå¦‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å…¨å±€ä½œç”¨åŸŸ</span>
{
  <span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>; <span class="hljs-comment">// var å£°æ˜çš„å˜é‡ï¼Œç©¿é€ {}ï¼Œå±äºå¤–å±‚ï¼ˆå…¨å±€ï¼‰ä½œç”¨åŸŸ</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// 1</span>
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// 1  èƒ½è®¿é—®åˆ°ï¼Œè¯´æ˜ {} æ²¡å½¢æˆç‹¬ç«‹ä½œç”¨åŸŸ</span>

<span class="hljs-comment">// å‡½æ•°ä½œç”¨åŸŸï¼ˆå¯¹æ¯”ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">var</span> b = <span class="hljs-number">2</span>; <span class="hljs-comment">// å‡½æ•°ä½œç”¨åŸŸå†…çš„å˜é‡ï¼Œå¤–å±‚è®¿é—®ä¸åˆ°</span>
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b); <span class="hljs-comment">// æŠ¥é”™ï¼šb is not definedï¼ˆå‡½æ•°ä½œç”¨åŸŸç”Ÿæ•ˆï¼‰</span>
</code></pre>
<p>è¿™ç§åäººç±»ç›´è§‰çš„ä¸œè¥¿ä¸åº”è¯¥å­˜åœ¨ï¼Œæ‰€ä»¥ JS åç»­æ¨å‡ºäº† let/const çš„ä¼˜åŒ–</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(c) <span class="hljs-comment">// æœªå®šä¹‰</span>
<span class="hljs-keyword">let</span> c = <span class="hljs-number">100</span> 


<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(d) <span class="hljs-comment">// æœªå®šä¹‰</span>
<span class="hljs-keyword">const</span> d = <span class="hljs-number">300</span>
</code></pre>
<p>è¿™æ ·æ‰ç¬¦åˆç›´è§‰</p>
<h3 data-id="heading-6">2.ä½œç”¨åŸŸé“¾ï¼ˆå˜é‡æŸ¥æ‰¾çš„è§„åˆ™ï¼‰</h3>
<p>ä½œç”¨åŸŸçš„æŸ¥æ‰¾è§„åˆ™å°±åƒæ˜¯å‰¥æ´‹è‘±ï¼Œä¸€å±‚ä¸€å±‚å¾€å¤–å±‚æ‰¾ï¼Œç›´åˆ°å…¨å±€ä½œç”¨åŸŸï¼Œæ‰¾ä¸åˆ°å°±æŠ¥é”™</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å…¨å±€ä½œç”¨åŸŸ</span>
<span class="hljs-keyword">let</span> all = <span class="hljs-string">"å…¨å±€å˜é‡"</span>;
<span class="hljs-comment">// å¤–å±‚å‡½æ•°ä½œç”¨åŸŸ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">outerFn</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">let</span> outer = <span class="hljs-string">"å¤–å±‚å˜é‡"</span>;
  <span class="hljs-comment">// å†…å±‚å‡½æ•°ä½œç”¨åŸŸ</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">innerFn</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> inner = <span class="hljs-string">"å†…å±‚å˜é‡"</span>;
    <span class="hljs-comment">// æŸ¥æ‰¾é¡ºåºï¼šinnerï¼ˆå½“å‰å†…å±‚ä½œç”¨åŸŸï¼‰ outerï¼ˆå¤–å±‚ä½œç”¨åŸŸï¼‰ globalï¼ˆå…¨å±€ä½œç”¨åŸŸï¼‰</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(inner); <span class="hljs-comment">// è¾“å‡ºï¼šå†…å±‚å˜é‡ï¼ˆå½“å‰ä½œç”¨åŸŸæ‰¾åˆ°ï¼‰</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(outer); <span class="hljs-comment">// è¾“å‡ºï¼šå¤–å±‚å˜é‡ï¼ˆå½“å‰æ‰¾ä¸åˆ°ï¼Œå»å¤–å±‚æ‰¾ï¼‰</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(all); <span class="hljs-comment">// è¾“å‡ºï¼šå…¨å±€å˜é‡ï¼ˆå†…å±‚ã€å¤–å±‚éƒ½æ‰¾ä¸åˆ°ï¼Œå»å…¨å±€æ‰¾ï¼‰   </span>
    <span class="hljs-comment">// æ³¨é‡Šæ‰“å¼€ä¼šæŠ¥é”™ï¼ˆå…¨å±€ä¹Ÿæ‰¾ä¸åˆ°ï¼‰</span>
  }
  <span class="hljs-title function_">innerFn</span>();
}
<span class="hljs-title function_">outerFn</span>();
</code></pre>
<h3 data-id="heading-7">3. if/for ä¸æ˜¯å¯¹è±¡ï¼Œä¹Ÿæ²¡æœ‰â€œä½œç”¨åŸŸâ€</h3>
<p>è¿™é‡Œçš„æ„æ€æ˜¯ if/for ä¸ä¼šåƒä¸Šè¿°çš„å…¨å±€ï¼Œå‡½æ•°æ‹¥æœ‰è‡ªå·±ç‹¬ç‰¹çš„ä½œç”¨åŸŸ</p>
<pre><code class="hljs language-js" lang="js">   {
  <span class="hljs-keyword">let</span> c = <span class="hljs-number">3</span>; <span class="hljs-comment">// let å£°æ˜ï¼Œè¢« {} çš„å—çº§ä½œç”¨åŸŸåŒ…è£¹</span>
  <span class="hljs-keyword">const</span> d = <span class="hljs-number">4</span>; <span class="hljs-comment">// const åŒç†</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(c); <span class="hljs-comment">// 3</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(d); <span class="hljs-comment">// 4</span>
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(c); <span class="hljs-comment">//  æŠ¥é”™ï¼šc is not definedï¼ˆå—çº§ä½œç”¨åŸŸéš”ç¦»ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(d); <span class="hljs-comment">//  æŠ¥é”™ï¼šd is not defined</span>

<span class="hljs-comment">// ç»å…¸ä¾‹å­ï¼šfor å¾ªç¯çš„å—çº§ä½œç”¨åŸŸ</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  <span class="hljs-comment">// æ¯æ¬¡å¾ªç¯éƒ½ä¼šåˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„å—çº§ä½œç”¨åŸŸï¼Œi åªåœ¨å½“å‰å¾ªç¯ç”Ÿæ•ˆ</span>
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i), <span class="hljs-number">0</span>); <span class="hljs-comment">// è¾“å‡º 0ã€1ã€2 </span>
}

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">3</span>; j++) {
  <span class="hljs-comment">// var æ— å—çº§ä½œç”¨åŸŸï¼Œj æ˜¯å…¨å±€çš„ï¼Œå¾ªç¯ç»“æŸå j=3</span>
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(j), <span class="hljs-number">0</span>); <span class="hljs-comment">// è¾“å‡º 3ã€3ã€3 </span>
}
</code></pre>
<p>å°±åƒä¸Šè¿°ä»£ç æ‰€å±•ç¤ºï¼Œvar å£°æ˜çš„å˜é‡è¿˜æ˜¯è·‘åˆ°å…¨å±€äº†ï¼Œæ‰€ä»¥è¾“å‡ºçš„éƒ½æ˜¯ 3 ï¼Œ
å½“ç„¶è¿™é‡Œè¿˜æ¶‰åŠåˆ°äº†å®šæ—¶å™¨çš„å¼‚æ­¥ï¼Œåç»­æ–‡ç« ä¹Ÿä¼šçš„å¯¹å¼‚æ­¥å±•å¼€è®¨è®º</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¹²æ‰ Loading è½¬åœˆï¼šåœ¨ Flutter ä¸­å®ç°çœŸæ­£çš„â€œæ— æ„Ÿâ€åˆ†é¡µ]]></title>    <link>https://juejin.cn/post/7602965400809930802</link>    <guid>https://juejin.cn/post/7602965400809930802</guid>    <pubDate>2026-02-05T13:49:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602965400809930802" data-draft-id="7602965400809898034" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¹²æ‰ Loading è½¬åœˆï¼šåœ¨ Flutter ä¸­å®ç°çœŸæ­£çš„â€œæ— æ„Ÿâ€åˆ†é¡µ"/> <meta itemprop="keywords" content="Flutter"/> <meta itemprop="datePublished" content="2026-02-05T13:49:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ“…é•¿åœ¨ä»£ç ä¸­ä¸‹æ¯’"/> <meta itemprop="url" content="https://juejin.cn/user/3228605945228429"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¹²æ‰ Loading è½¬åœˆï¼šåœ¨ Flutter ä¸­å®ç°çœŸæ­£çš„â€œæ— æ„Ÿâ€åˆ†é¡µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3228605945228429/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ“…é•¿åœ¨ä»£ç ä¸­ä¸‹æ¯’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T13:49:25.000Z" title="Thu Feb 05 2026 13:49:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ çš„ç”¨æˆ·æ­£åœ¨æ²‰æµ¸å¼åœ°åˆ·ç€ä¿¡æ¯æµï¼Œå†…å®¹ç²¾å½©çº·å‘ˆï¼Œå¤šå·´èƒºæ­£åœ¨åˆ†æ³Œï¼Œçªç„¶â€”â€”<em>å’£å½“</em>â€”â€”ä»–ä»¬è§¦åº•äº†ã€‚ä¸€ä¸ªç°è‰²çš„åœˆåœ¨è½¬åŠ¨ã€‚é­”æ³•ä¸­æ–­äº†ï¼Œä½“éªŒâ€œå‡ºæˆâ€äº†ã€‚</p>
<p>åœ¨é«˜è´¨é‡çš„ App ä¸­ï¼Œâ€œæ— é™æ»šåŠ¨ï¼ˆInfinite Scrollï¼‰â€ä¸åº”è¯¥ä»…ä»…åœ¨é€»è¾‘ä¸Šæ˜¯æ— é™çš„ï¼Œå®ƒåœ¨<strong>ä½“éªŒä¸Š</strong>ä¹Ÿåº”è¯¥æ˜¯æ— é™çš„ã€‚æˆ‘ä»¬ä¸åº”è¯¥ç­‰ç”¨æˆ·æ’äº†å—å¢™æ‰å›å¤´ï¼Œæˆ‘ä»¬åº”è¯¥é¢„åˆ¤ä»–ä»¬çš„è¡Œä¸ºã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬è¦å¹²æ‰é‚£ä¸ªåŠ è½½åœˆã€‚æˆ‘ä»¬å°†æ¢è®¨ Flutter ä¸­åˆ—è¡¨é¢„åŠ è½½çš„æ¼”è¿›ä¹‹è·¯ï¼šä»æ‰‹åŠ¨å®ç°çš„â€œè‹¦åŠ›æ³•â€ï¼Œåˆ°ç”Ÿäº§ç¯å¢ƒå¯ç”¨çš„ <strong>â€œä½ä¾µå…¥â€</strong> æ–¹æ¡ˆã€‚</p>
<p><em>ï¼ˆğŸ¶ æˆ‘æ‰¿è®¤æœ‰äº›åœˆçš„ç¡®èƒ½å¤Ÿè®©äººèµå¿ƒæ‚¦ç›®ï¼‰</em>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7fa884f08fbf442e8b8eed3d7e11967d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pOF6ZW_5Zyo5Luj56CB5Lit5LiL5q-S:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770904169&amp;x-signature=88gNaFRUvWk2TP3uugPhgKAfNtE%3D" alt="15ee8c1cc19a457289632f485ecc6d73.webp" loading="lazy"/></p>
<h2 data-id="heading-0">1. ç»å…¸æ–¹æ¡ˆï¼š<code>ScrollController</code></h2>
<p>æ£€æµ‹ç”¨æˆ·æ˜¯å¦æ¥è¿‘åº•éƒ¨çš„æœ€ç›´è§‚æ–¹æ³•ï¼Œå°±æ˜¯å»é—® <code>ScrollController</code>ã€‚</p>
<h3 data-id="heading-1">1.1 åŸå§‹å®ç°ï¼ˆæ ·æ¿ä»£ç ï¼‰</h3>
<p>æ ¸å¿ƒé€»è¾‘å°±æ˜¯ç®€å•çš„æ•°å­¦è®¡ç®—ã€‚ç›‘å¬æ»šåŠ¨åç§»é‡ï¼Œå¦‚æœ <code>å½“å‰ä½ç½® + é˜ˆå€¼ &gt;= æ€»é•¿åº¦</code>ï¼Œå°±è§¦å‘åŠ è½½ã€‚</p>
<p>æ ‡å‡†ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚å®ƒèƒ½è·‘ï¼Œä½†å®ƒè®©ä½ çš„ Widget å˜å¾—ä¹±ç³Ÿç³Ÿï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyFeedPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-meta">@override</span>
  _MyFeedPageState createState() =&gt; _MyFeedPageState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_MyFeedPageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">MyFeedPage</span>&gt; </span>{
  <span class="hljs-keyword">final</span> ScrollController _controller = ScrollController();

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> initState() {
    <span class="hljs-keyword">super</span>.initState();
    _controller.addListener(() {
      <span class="hljs-comment">// 1. æ£€æŸ¥æ˜¯å¦è§¦åº•ï¼ˆé¢„ç•™ 600px çš„ç¼“å†²ç©ºé—´ï¼‰</span>
      <span class="hljs-keyword">if</span> (_controller.position.pixels &gt;= 
          _controller.position.maxScrollExtent - <span class="hljs-number">600</span>) {
        
        <span class="hljs-comment">// 2. è°ƒç”¨åŠ è½½æ•°æ®çš„é€»è¾‘</span>
        _loadMoreData(); 
      }
    });
  }

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> dispose() {
    _controller.dispose(); <span class="hljs-comment">// åˆ«å¿˜äº†é”€æ¯ï¼</span>
    <span class="hljs-keyword">super</span>.dispose();
  }

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> ListView.builder(
      controller: _controller, <span class="hljs-comment">// ä½ å¿…é¡»æ‰‹åŠ¨ç»‘å®šå®ƒ</span>
      itemBuilder: (ctx, i) =&gt; ListTile(title: Text(<span class="hljs-string">"Item <span class="hljs-subst">$i</span>"</span>)),
    );
  }
}
</code></pre>
<h3 data-id="heading-2">1.2 é‡æ„ï¼šä½¿ç”¨ Mixin è§£è€¦</h3>
<p>ä¸Šé¢çš„ä»£ç æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ<strong>é‡å¤ã€‚</strong> å¦‚æœä½ æœ‰ 10 ä¸ªåˆ—è¡¨é¡µé¢ï¼Œä½ å°±å¾—æŠŠè¿™å¥—é€»è¾‘å†™ 10 éã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å°†å…¶æå–åˆ°ä¸€ä¸ª <strong>Mixin</strong> ä¸­ã€‚è¿™æ ·ä¸ä»…ä¿æŒäº† UI ä»£ç çš„æ•´æ´ï¼Œè¿˜èƒ½è®©ä»»ä½• <code>StatefulWidget</code> ç¬é—´è·å¾—â€œåˆ†é¡µèƒ½åŠ›â€ã€‚</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">mixin</span> PaginationMixin&lt;T <span class="hljs-keyword">extends</span> StatefulWidget&gt; <span class="hljs-keyword">on</span> State&lt;T&gt; {
  <span class="hljs-keyword">final</span> ScrollController scrollController = ScrollController();
  
  <span class="hljs-keyword">void</span> _onScroll() {
    <span class="hljs-comment">// åœ¨è¿™é‡Œç»Ÿä¸€ç®¡ç†é˜ˆå€¼é€»è¾‘ï¼ˆä¾‹å¦‚ï¼š600pxï¼‰</span>
    <span class="hljs-keyword">if</span> (scrollController.position.extentAfter &lt; <span class="hljs-number">600</span>) {
      onLoadMore();
    }
  }

  <span class="hljs-comment">// å¼ºåˆ¶ä½¿ç”¨è¯¥ Mixin çš„ç±»å®ç°å…·ä½“çš„åŠ è½½é€»è¾‘</span>
  <span class="hljs-keyword">void</span> onLoadMore(); 
  
  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> initState() {
    <span class="hljs-keyword">super</span>.initState();
    scrollController.addListener(_onScroll);
  }
  
  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> dispose() {
    scrollController.dispose();
    <span class="hljs-keyword">super</span>.dispose();
  }
}
</code></pre>
<p>ç°åœ¨å¥½å¤šäº†ã€‚ä½†è¿™ä»ç„¶å¼ºè¿«ä½ çš„ UI å»æŒæœ‰å¹¶ç»‘å®šä¸€ä¸ª <code>ScrollController</code>ã€‚å¦‚æœä½ æ˜¯åœ¨ä¸€ä¸ªåµŒå¥—è§†å›¾ä¸­ï¼Œå¾ˆéš¾ç›´æ¥æ§åˆ¶ Controller æ€ä¹ˆåŠï¼Ÿ</p>
<h2 data-id="heading-3">2. çº¯ç²¹æ–¹æ¡ˆï¼š<code>ScrollNotification</code></h2>
<p>Flutter æä¾›äº†ä¸€ä¸ªå†’æ³¡äº‹ä»¶ç³»ç»Ÿï¼Œå«åš <code>ScrollNotification</code>ã€‚è¿™å…è®¸æˆ‘ä»¬åœ¨ä¸ç®¡ç† Controller å®ä¾‹çš„æƒ…å†µä¸‹ç›‘å¬æ»šåŠ¨äº‹ä»¶ã€‚</p>
<h3 data-id="heading-4">2.1 åŸå§‹å®ç°</h3>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ <code>NotificationListener</code> åŒ…è£¹åˆ—è¡¨ï¼š</p>
<pre><code class="hljs language-dart" lang="dart">NotificationListener&lt;ScrollNotification&gt;(
  onNotification: (notification) {
    <span class="hljs-comment">// ç­›é€‰æ»šåŠ¨æ›´æ–°äº‹ä»¶</span>
    <span class="hljs-keyword">if</span> (notification <span class="hljs-keyword">is</span> ScrollUpdateNotification) {
      <span class="hljs-comment">// æ£€æŸ¥å‰©ä½™è·ç¦»ï¼ˆä¿æŒä¸€è‡´çš„ 600px é˜ˆå€¼ï¼‰</span>
      <span class="hljs-keyword">if</span> (notification.metrics.extentAfter &lt; <span class="hljs-number">600</span>) {
        _preloadNextPage();
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>; <span class="hljs-comment">// è®©é€šçŸ¥ç»§ç»­å‘ä¸Šå†’æ³¡</span>
  },
  child: ListView.builder(...),
)
</code></pre>
<h3 data-id="heading-5">2.2 é‡æ„ï¼šç»„ä»¶å°è£…</h3>
<p>è™½ç„¶è¿™ç§æ–¹å¼å¾ˆçµæ´»ï¼Œä½†æŠŠé€»è¾‘å†™åœ¨ <code>build</code> æ–¹æ³•é‡Œè¿åäº†æ•´æ´æ¶æ„åŸåˆ™ã€‚å®ƒæŠŠ**å¸ƒå±€ï¼ˆLayoutï¼‰<strong>å’Œ</strong>ä¸šåŠ¡é€»è¾‘ï¼ˆBusiness Logicï¼‰**æ··åœ¨ä¸€èµ·äº†ã€‚</p>
<p>è®©æˆ‘ä»¬æŠŠå®ƒå°è£…æˆä¸€ä¸ªä¸“ç”¨çš„ <strong>PreloadDetector</strong> ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PreloadDetector</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">final</span> Widget child;
  <span class="hljs-keyword">final</span> VoidCallback onTrigger;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> threshold;

  <span class="hljs-keyword">const</span> PreloadDetector({
    <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.child, 
    <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.onTrigger,
    <span class="hljs-keyword">this</span>.threshold = <span class="hljs-number">600</span>, <span class="hljs-comment">// é»˜è®¤ä¸º 600px</span>
  });

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> NotificationListener&lt;ScrollNotification&gt;(
      onNotification: (notification) {
        <span class="hljs-keyword">if</span> (notification.metrics.extentAfter &lt; threshold) {
          onTrigger();
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
      },
      child: child,
    );
  }
}
</code></pre>
<p>å¾ˆå¹²å‡€ã€‚ä½†æ˜¯ï¼Œä½ ä¾ç„¶éœ€è¦æ‰‹åŠ¨å¤„ç† <strong>çŠ¶æ€é˜²å«ï¼ˆState Guardingï¼‰</strong> ï¼ˆä¾‹å¦‚ï¼šâ€œå¦‚æœæ­£åœ¨åŠ è½½ä¸­åˆ™ä¸è§¦å‘â€æˆ–è€…â€œå¦‚æœæ²¡æ•°æ®äº†åˆ™ä¸è§¦å‘â€ï¼‰ã€‚</p>
<h2 data-id="heading-6">3. â€œä½ä¾µå…¥â€æ–¹æ¡ˆï¼š<code>scroll_preload_detector</code></h2>
<p>ä¸åƒä¸Šè¿°ä¸¤ç§æ–¹æ³•éƒ½éœ€è¦ä½ æ‰‹åŠ¨ç»´æŠ¤çŠ¶æ€é€»è¾‘ã€‚</p>
<p>æˆ‘æœ€è¿‘ä½¿ç”¨äº†ä¸€ä¸ªåº“ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fpub.dev%2Fpackages%2Fscroll_preload_detector" target="_blank" title="https://pub.dev/packages/scroll_preload_detector" ref="nofollow noopener noreferrer">scroll_preload_detector</a></strong>ï¼Œä¹‹æ‰€ä»¥ç”¨å®ƒï¼Œæ˜¯å› ä¸ºä¸€ä¸ªå…³é”®ç‰¹æ€§ï¼š<strong>ä½ä¾µå…¥</strong> ã€‚</p>
<h3 data-id="heading-7">ä»€ä¹ˆæ˜¯â€œä½ä¾µå…¥â€ï¼Ÿ</h3>
<p>è¿™æ„å‘³ç€ä½ ç°æœ‰çš„ä»£ç å¯ä»¥ä¿æŒåŸæ ·ï¼š</p>
<ul>
<li>ä¸éœ€è¦æŠŠ <code>StatelessWidget</code> æ”¹ä¸º <code>StatefulWidget</code>ã€‚</li>
<li>ä¸éœ€è¦æ³¨å…¥ <code>ScrollController</code>ã€‚</li>
<li>ä¸éœ€è¦ä¿®æ”¹ä½ çš„ <code>ListView</code> æˆ– <code>itemBuilder</code>ã€‚</li>
</ul>
<h3 data-id="heading-8">3.1 æ¸…çˆ½çš„å®ç°</h3>
<p>è¿™ä¸ªåº“å°†è®¡ç®—ã€é˜²æŠ–å¤„ç†å’ŒçŠ¶æ€é˜²å«å°è£…æˆäº†ä¸€ä¸ªå£°æ˜å¼çš„ APIã€‚</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:scroll_preload_detector/scroll_preload_detector.dart'</span>;

ScrollPreloadDetector(
  <span class="hljs-comment">// å½“å‰©ä½™å†…å®¹ä¸è¶³ 600px æ—¶å¼€å§‹åŠ è½½</span>
  preloadDistance: <span class="hljs-number">600.0</span>,
  
  <span class="hljs-comment">// å¦‚æœæ•°æ®å·²è€—å°½ï¼Œä¸è¦è§¦å‘</span>
  <span class="hljs-comment">// è¿™è‡ªåŠ¨é˜²æ­¢äº†ä¸å¿…è¦çš„ API è°ƒç”¨</span>
  hasMore: () =&gt; _viewModel.hasMoreData,
  
  <span class="hljs-comment">// è‡ªåŠ¨å¤„ç†å¼‚æ­¥é€»è¾‘</span>
  preload: () <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">await</span> _viewModel.fetchMoreData();
  },
  
  child: ListView.builder(
    itemCount: items.length,
    itemBuilder: (context, index) =&gt; MyCard(items[index]),
  ),
)
</code></pre>
<h3 data-id="heading-9">ä¸ºä»€ä¹ˆè¿™æ˜¯â€œæ›´åˆç†â€çš„æ–¹æ¡ˆï¼š</h3>
<ol>
<li><strong>å®‰å…¨æ€§ï¼š</strong> å®ƒå¼ºåˆ¶ä½ å®šä¹‰ <code>hasMore</code>ï¼Œè§£å†³äº† App åœ¨åˆ—è¡¨åº•éƒ¨ä¸æ–­å°è¯•è¯·æ±‚æ— æ•ˆæ•°æ®çš„å¸¸è§ Bugã€‚</li>
<li><strong>æ•´æ´æ€§ï¼š</strong> å®ƒåˆ†ç¦»äº†<strong>å¸ƒå±€çš„èŒè´£</strong>ï¼ˆä½ çš„ Listï¼‰å’Œ<strong>åˆ†é¡µçš„èŒè´£</strong>ï¼ˆDetectorï¼‰ã€‚</li>
<li><strong>é€šç”¨æ€§ï¼š</strong> å› ä¸ºå®ƒæ˜¯åŒ…è£¹åœ¨ Widget å¤–å±‚çš„ï¼Œæ‰€ä»¥å®ƒé€‚ç”¨äº <code>GridView</code>ã€<code>SliverList</code>ã€<code>CustomScrollView</code> æˆ–ä»»ä½•å¯æ»šåŠ¨çš„ç»„ä»¶ã€‚</li>
</ol>
<h2 data-id="heading-10">ğŸ¤ è®©æˆ‘ä»¬ä¸€èµ·å…±å»º</h2>
<p>Flutter ç”Ÿæ€ç³»ç»Ÿçš„ç¾å¦™ä¹‹å¤„åœ¨äºï¼Œæˆ‘ä»¬ä¸å¿…ç‹¬è‡ªè§£å†³è¿™äº›é—®é¢˜ã€‚<strong>scroll_preload_detector</strong> æ˜¯ä¸€ä¸ªå°è€Œç¾çš„å·¥å…·ï¼Œå®ƒç®€åŒ–äº†æˆ‘ä»¬çš„æ—¥å¸¸å·¥ä½œã€‚</p>
<p>å¦‚æœä½ åŒå€¦äº†åœ¨æ¯ä¸ªé¡¹ç›®é‡Œå†™é‡å¤çš„ <code>addListener</code> æ ·æ¿ä»£ç ï¼š</p>
<ol>
<li>åœ¨ä½ çš„ä¸‹ä¸€ä¸ª App ä¸­<strong>è¯•ç”¨å®ƒ</strong>ã€‚</li>
<li>åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fpub.dev%2Fpackages%2Fscroll_preload_detector" target="_blank" title="https://pub.dev/packages/scroll_preload_detector" ref="nofollow noopener noreferrer">Pub.dev</a> ä¸Š<strong>ç»™å®ƒç‚¹ä¸ª Star</strong>ã€‚</li>
<li>å¦‚æœä½ å‘ç°äº†è¾¹ç¼˜æƒ…å†µï¼Œæäº¤ä¸€ä¸ª PRï¼</li>
</ol>
<p>è®©æˆ‘ä»¬å½»åº•å‘Šåˆ« Loading è½¬åœˆã€‚</p>
<h3 data-id="heading-11">æ„Ÿè°¢é˜…è¯»ï¼</h3>
<p>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æŠ€æœ¯æŒ‡å—å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹èµé¼“åŠ±ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€ AIå…¨æ ˆé¡¹ç›®ç¬¬åäº”å¤©ï¼šMineç•Œé¢æ‰“é€ ä¸AIå¤´åƒç”Ÿæˆçš„å¥‡å¦™ä¹‹æ—… âœ¨]]></title>    <link>https://juejin.cn/post/7603221478473891882</link>    <guid>https://juejin.cn/post/7603221478473891882</guid>    <pubDate>2026-02-05T15:43:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603221478473891882" data-draft-id="7603221478473875498" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€ AIå…¨æ ˆé¡¹ç›®ç¬¬åäº”å¤©ï¼šMineç•Œé¢æ‰“é€ ä¸AIå¤´åƒç”Ÿæˆçš„å¥‡å¦™ä¹‹æ—… âœ¨"/> <meta itemprop="keywords" content="React.js,NestJS"/> <meta itemprop="datePublished" content="2026-02-05T15:43:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¥ç§˜çš„çŒªå¤´"/> <meta itemprop="url" content="https://juejin.cn/user/793223472877051"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€ AIå…¨æ ˆé¡¹ç›®ç¬¬åäº”å¤©ï¼šMineç•Œé¢æ‰“é€ ä¸AIå¤´åƒç”Ÿæˆçš„å¥‡å¦™ä¹‹æ—… âœ¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/793223472877051/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¥ç§˜çš„çŒªå¤´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T15:43:09.000Z" title="Thu Feb 05 2026 15:43:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ğŸ‘‹ <strong>Hello æ˜é‡‘çš„åŒå­¦ä»¬ï¼</strong> æ¬¢è¿å›åˆ°æˆ‘ä»¬çš„ <strong>AIå…¨æ ˆå¼€å‘</strong> ç³»åˆ—æ•™ç¨‹ï¼</p>
<p>ä¸çŸ¥ä¸è§‰æˆ‘ä»¬å·²ç»ä¸€èµ·èµ°åˆ°äº†ç¬¬ 15 å¤©ã€‚åŠä¸ªæœˆçš„åšæŒï¼Œæˆ‘ä»¬ä»é›¶å¼€å§‹æ­å»ºé¡¹ç›®ï¼Œç°åœ¨çš„ä½ æ˜¯ä¸æ˜¯æ„Ÿè§‰å‰åç«¯çš„äº¤äº’è¶Šæ¥è¶Šé¡ºæ‰‹äº†ï¼Ÿè¿™ç§æ‰“é€šä»»ç£äºŒè„‰çš„æ„Ÿè§‰ç®€ç›´å¤ªæ£’äº†ï¼ğŸ˜</p>
<p>ä»Šå¤©æˆ‘ä»¬è¦æç‚¹å¥½ç©çš„â€”â€”ç»™æˆ‘ä»¬çš„ç”¨æˆ·å¢åŠ ä¸€ç‚¹â€œä¸ªæ€§â€ã€‚æ²¡é”™ï¼Œæˆ‘ä»¬è¦å®Œæˆ <strong>Mineï¼ˆä¸ªäººä¸­å¿ƒï¼‰</strong> é¡µé¢ï¼Œå¹¶ä¸”åŠ å…¥ä¸€ä¸ªè¶…çº§é…·ç‚«çš„åŠŸèƒ½ï¼š<strong>AI è‡ªåŠ¨ç”Ÿæˆå¤´åƒ</strong>ï¼ğŸ¤–ğŸ¨</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œç”¨æˆ·ä¸éœ€è¦è‡ªå·±åœ¨ç›¸å†Œé‡Œç¿»æ‰¾åŠå¤©ï¼Œåªéœ€è¦ç‚¹ä¸€ä¸‹â€œAI ç”Ÿæˆâ€ï¼Œä¸€ä¸ªä¸“å±çš„ã€ç‹¬ä¸€æ— äºŒçš„å¤´åƒå°±è¯ç”Ÿäº†ã€‚æ˜¯ä¸æ˜¯å¾ˆæœ‰æå®¢èŒƒå„¿ï¼Ÿ</p>
<p>è¯ä¸å¤šè¯´ï¼Œç³»å¥½å®‰å…¨å¸¦ï¼Œæˆ‘ä»¬å‘è½¦å•¦ï¼ğŸš—ğŸ’¨</p>
<hr/>
<h2 data-id="heading-0">ğŸ¨ ç¬¬ä¸€ç«™ï¼šMine é¡µé¢ä¸ Drawer ç»„ä»¶çš„â€œç§¯æœ¨è‰ºæœ¯â€</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå…¥å£ã€‚åœ¨ç§»åŠ¨ç«¯åº”ç”¨ä¸­ï¼Œä¸ªäººä¸­å¿ƒï¼ˆMineï¼‰é€šå¸¸æ˜¯ç”¨æˆ·ç®¡ç†è‡ªå·±èµ„æ–™çš„åœ°æ–¹ã€‚ä¸ºäº†è®©ä½“éªŒæ›´åŠ ä¸æ»‘ï¼Œæˆ‘ä»¬ä¸æƒ³ç”¨ç”Ÿç¡¬çš„å¼¹çª—ï¼Œè€Œæ˜¯é€‰æ‹©äº† <strong>Shadcn UI</strong> æä¾›çš„ <code>Drawer</code>ï¼ˆæŠ½å±‰ï¼‰ç»„ä»¶ã€‚</p>
<h3 data-id="heading-1">1.1 æ·±åº¦æ‹†è§£ï¼šDrawer ç»„ä»¶å®¶æ— ğŸ§©</h3>
<p>åœ¨çœ‹ä¸šåŠ¡ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè®¤è¯†ä¸€ä¸‹æ„å»ºè¿™ä¸ªæŠ½å±‰çš„â€œç§¯æœ¨â€ã€‚Shadcn çš„ Drawer ç»„ä»¶é‡‡ç”¨çš„æ˜¯<strong>ç»„åˆå¼ API (Compound Components)</strong> çš„è®¾è®¡æ¨¡å¼ï¼Œè¿™éå¸¸çµæ´»ã€‚</p>
<p>çœ‹çœ‹æˆ‘ä»¬åœ¨ <code>src/pages/Mine.tsx</code> å¼•å…¥çš„è¿™ç»„â€œå…¨å®¶æ¡¶â€ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">Drawer</span>,            <span class="hljs-comment">// ğŸ“¦ æ ¹å®¹å™¨ï¼šç®¡ç†æŠ½å±‰çš„å¼€å…³çŠ¶æ€</span>
  <span class="hljs-title class_">DrawerTrigger</span>,     <span class="hljs-comment">// ğŸ‘† è§¦å‘å™¨ï¼šç‚¹å‡»å®ƒï¼ŒæŠ½å±‰å°±ä¼šæ»‘å‡ºæ¥</span>
  <span class="hljs-title class_">DrawerContent</span>,     <span class="hljs-comment">// ğŸ“„ å†…å®¹å±‚ï¼šæŠ½å±‰é‡ŒçœŸæ­£è£…çš„ä¸œè¥¿ï¼ˆç™½è‰²é¢æ¿ï¼‰</span>
  <span class="hljs-title class_">DrawerHeader</span>,      <span class="hljs-comment">// ğŸ·ï¸ å¤´éƒ¨åŒºåŸŸï¼šé€šå¸¸æ”¾æ ‡é¢˜</span>
  <span class="hljs-title class_">DrawerTitle</span>,       <span class="hljs-comment">// ğŸ“Œ æ ‡é¢˜ï¼šå¯¹å±å¹•é˜…è¯»å™¨å‹å¥½çš„æ ‡é¢˜ç»„ä»¶</span>
  <span class="hljs-title class_">DrawerDescription</span>, <span class="hljs-comment">// ğŸ“ æè¿°ï¼šå‰¯æ ‡é¢˜æˆ–è¯´æ˜æ–‡å­—</span>
  <span class="hljs-title class_">DrawerFooter</span>,      <span class="hljs-comment">// ğŸ¦¶ åº•éƒ¨åŒºåŸŸï¼šé€šå¸¸æ”¾å–æ¶ˆæŒ‰é’®</span>
  <span class="hljs-title class_">DrawerClose</span>        <span class="hljs-comment">// âŒ å…³é—­åŠ¨ä½œï¼šç‚¹å‡»åŒ…è£¹åœ¨é‡Œé¢çš„å…ƒç´ ä¼šå…³é—­æŠ½å±‰</span>
} <span class="hljs-keyword">from</span> <span class="hljs-string">'@/components/ui/drawer'</span>;
</code></pre>
<p><strong>å®ƒä»¬æ˜¯å¦‚ä½•é…åˆæ‰“é€ ä¸€ä¸ªå®Œç¾æŠ½å±‰çš„ï¼Ÿ</strong></p>
<ol>
<li><strong>æœ€å¤–å±‚</strong>ç”± <code>&lt;Drawer&gt;</code> åŒ…è£¹ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼ˆContextï¼‰æä¾›è€…ï¼Œè´Ÿè´£å‘Šè¯‰é‡Œé¢çš„å­ç»„ä»¶â€œç°åœ¨æ˜¯å¼€ç€è¿˜æ˜¯å…³ç€â€ã€‚</li>
<li><strong>è§¦å‘å¼€å…³</strong> <code>&lt;DrawerTrigger&gt;</code> æ”¾åœ¨é¡µé¢ä¸Šå¯è§çš„åœ°æ–¹ï¼ˆæ¯”å¦‚å¤´åƒï¼‰ï¼Œç”¨æˆ·ä¸€ç‚¹ï¼Œä¿¡å·ä¼ ç»™ <code>&lt;Drawer&gt;</code>ï¼ŒçŠ¶æ€å˜ä¸º <code>open: true</code>ã€‚</li>
<li><strong>å¼¹å‡ºå±‚</strong> <code>&lt;DrawerContent&gt;</code> ç›‘å¬åˆ°çŠ¶æ€å˜åŒ–ï¼Œä»å±å¹•åº•éƒ¨ä¼˜é›…åœ°æ»‘å‡ºã€‚</li>
<li><strong>å†…å®¹ç»“æ„</strong> éµå¾ª Header (Title + Description) -&gt; Body (è‡ªå®šä¹‰å†…å®¹) -&gt; Footer (Close) çš„æ ‡å‡†å¸ƒå±€ï¼Œæ—¢ç¾è§‚åˆç¬¦åˆæ— éšœç¢è®¿é—®ï¼ˆAccessibilityï¼‰æ ‡å‡†ã€‚</li>
</ol>
<h3 data-id="heading-2">1.2 ä»£ç å®æˆ˜ï¼šæ„å»º UI</h3>
<p>ç†è§£äº†ç»„ä»¶åŸç†ï¼Œæˆ‘ä»¬æ¥çœ‹ä»£ç å°±ä¸€ç›®äº†ç„¶äº†ã€‚</p>
<p>ğŸ“ <strong>åæ ‡</strong>ï¼š<code>frontend/notes/src/pages/Mine.tsx</code></p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// ...</span>

<span class="hljs-comment">// ğŸ‘‡ open å’Œ setOpen ç”¨äºæ‰‹åŠ¨æ§åˆ¶æŠ½å±‰çŠ¶æ€ï¼ˆé™¤äº†ç‚¹å‡»è§¦å‘ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä»£ç æ§åˆ¶å…³é—­ï¼‰</span>
&lt;<span class="hljs-title class_">Drawer</span> open={open} onOpenChange={setOpen}&gt;
  
  {<span class="hljs-comment">/* ğŸ‘† 1. è§¦å‘å™¨åŒºåŸŸ */</span>}
  &lt;<span class="hljs-title class_">DrawerTrigger</span> asChild&gt;
    {<span class="hljs-comment">/* asChild è¡¨ç¤º Trigger ä¸ä¼šå¤šæ¸²æŸ“ä¸€ä¸ª buttonï¼Œè€Œæ˜¯ç›´æ¥æŠŠç‚¹å‡»äº‹ä»¶ç»‘å®šåˆ°ä¸‹é¢çš„ div ä¸Š */</span>}
    &lt;div className=<span class="hljs-string">"h-16 w-16 rounded-full bg-primary/10 flex 
    items-center justify-center text-primary text-xl font-bold"</span>&gt;
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Avatar</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"h-16 w-16"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">AvatarImage</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{user?.avatar}</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">AvatarFallback</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"bg-primary/10 text-primary text-xl font-bold"</span>&gt;</span>
        {user?.name?.[0].toUpperCase()}
        <span class="hljs-tag">&lt;/<span class="hljs-name">AvatarFallback</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Avatar</span>&gt;</span></span>
    &lt;/div&gt;
  &lt;/<span class="hljs-title class_">DrawerTrigger</span>&gt;
  
  {<span class="hljs-comment">/* ğŸ“„ 2. æŠ½å±‰å†…å®¹åŒºåŸŸ */</span>}
  &lt;<span class="hljs-title class_">DrawerContent</span>&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"mx-auto w-full max-w-sm"</span>&gt;</span>
      
      {/* ğŸ·ï¸ å¤´éƒ¨ï¼šå‘ŠçŸ¥ç”¨æˆ·è¿™æ˜¯å¹²å˜›çš„ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">DrawerHeader</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-left"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">DrawerTitle</span>&gt;</span>ä¿®æ”¹å¤´åƒ<span class="hljs-tag">&lt;/<span class="hljs-name">DrawerTitle</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">DrawerDescription</span>&gt;</span>
          è¯·é€‰æ‹©ä¸€ç§æ–¹å¼æ›´æ–°æ‚¨çš„ä¸ªäººå¤´åƒ
        <span class="hljs-tag">&lt;/<span class="hljs-name">DrawerDescription</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">DrawerHeader</span>&gt;</span>
      
      {/* âœ¨ æ ¸å¿ƒæ“ä½œåŒºï¼šä¸‰ä¸ªæŒ‰é’® */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"p-4 space-y-3"</span>&gt;</span>
        {/* ğŸ“¸ é€‰é¡¹ä¸€ï¼šæ‹ç…§ */}
        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
          <span class="hljs-attr">variant</span>=<span class="hljs-string">"outline"</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">"w-full justify-start h-14 text-base"</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> handleAction('camera')}
        &gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Camera</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"mr-3 h-5 w-5 text-blue-500"</span>/&gt;</span>
          æ‹ç…§
        <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>

        {/* ğŸ–¼ï¸ é€‰é¡¹äºŒï¼šä»ç›¸å†Œä¸Šä¼  */}
        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
          <span class="hljs-attr">variant</span>=<span class="hljs-string">"outline"</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">"w-full justify-start h-14 text-base"</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> handleAction('upload')}
        &gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Upload</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"mr-3 h-5 w-5 text-blue-500"</span>/&gt;</span>
          ä»ç›¸å†Œä¸Šä¼ 
        <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>

        {/* ğŸ¤– é€‰é¡¹ä¸‰ï¼šAI ç”Ÿæˆå¤´åƒ (ä»Šå¤©çš„é‡å¤´æˆï¼) */}
        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
          <span class="hljs-attr">variant</span>=<span class="hljs-string">"outline"</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">"w-full justify-start h-14 text-base
          bg-gradient-to-r from-purple-600 to-indigo-600 border-none  
          "</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> handleAction('ai')}
        &gt;
          {/* Sparkles å›¾æ ‡éå¸¸é€‚åˆ AI è¿™ç§ç¥å¥‡çš„åŠŸèƒ½ */}
          <span class="hljs-tag">&lt;<span class="hljs-name">Sparkles</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"mr-3 h-5 w-5 text-yellow-300"</span>/&gt;</span>
          AI ç”Ÿæˆå¤´åƒ
        <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      {/* ğŸ¦¶ åº•éƒ¨ï¼šå–æ¶ˆæŒ‰é’® */}
      <span class="hljs-tag">&lt;<span class="hljs-name">DrawerFooter</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"pt-2"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">DrawerClose</span> <span class="hljs-attr">asChild</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">variant</span>=<span class="hljs-string">"ghost"</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"w-full h-12"</span>&gt;</span>å–æ¶ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">DrawerClose</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">DrawerFooter</span>&gt;</span>

    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  &lt;/<span class="hljs-title class_">DrawerContent</span>&gt;
&lt;/<span class="hljs-title class_">Drawer</span>&gt;
</code></pre>
<p><strong>ğŸ’¡ è®¾è®¡äº®ç‚¹ï¼š</strong></p>
<ul>
<li><strong>äº¤äº’é€»è¾‘</strong>ï¼šæ¯ä¸ªæŒ‰é’®éƒ½ç»‘å®šäº† <code>handleAction</code> æ–¹æ³•ï¼Œå¹¶ä¼ å…¥ä¸åŒçš„å‚æ•°ï¼ˆ'camera', 'upload', 'ai'ï¼‰ã€‚è¿™æ˜¯ä¸€ç§éå¸¸æ¸…æ™°çš„ <strong>äº‹ä»¶å§”æ‰˜</strong> æ€æƒ³çš„ç®€åŒ–ç‰ˆã€‚</li>
<li><strong>è§†è§‰å±‚çº§</strong>ï¼šç»™ AI æŒ‰é’®åŠ äº†ä¸€ä¸ª <code>bg-gradient-to-r from-purple-600 to-indigo-600</code> ç´«è‰²æ¸å˜èƒŒæ™¯ï¼Œè¿™æ˜¯è®¾è®¡ç•Œçš„â€œAI è‰²â€ï¼Œæš—ç¤ºè¿™ä¸ªåŠŸèƒ½å¾ˆé«˜çº§ã€å¾ˆæ™ºèƒ½ï¼ğŸ’œ</li>
</ul>
<h2 data-id="heading-3"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4239a116de3b45bb9dc89df427b180c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56We56eY55qE54yq5aS0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770910989&amp;x-signature=uhBdTFdrD6nbKOH75PyrSV9R%2Fwk%3D" alt="image.png" loading="lazy"/></h2>
<h2 data-id="heading-4">ğŸ§  ç¬¬äºŒç«™ï¼šå‰ç«¯å¤§è„‘ â€”â€” çŠ¶æ€ç®¡ç† (Zustand)</h2>
<p>å½“ç”¨æˆ·æ¿€åŠ¨åœ°ç‚¹å‡»äº†â€œAI ç”Ÿæˆå¤´åƒâ€æŒ‰é’®ï¼Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// Mine.tsx ä¸­çš„å¤„ç†å‡½æ•°</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleAction</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"><span class="hljs-keyword">type</span>: <span class="hljs-built_in">string</span></span>) =&gt; {
   <span class="hljs-title function_">setOpen</span>(<span class="hljs-literal">false</span>); <span class="hljs-comment">// å…ˆæŠŠæŠ½å±‰å…³ä¸Šï¼Œæå‡ä½“éªŒ</span>
   <span class="hljs-keyword">if</span>(<span class="hljs-keyword">type</span> == <span class="hljs-string">'ai'</span>){
     <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">true</span>); <span class="hljs-comment">// å¼€å¯ loading çŠ¶æ€ï¼Œå› ä¸º AI ç”Ÿæˆéœ€è¦æ—¶é—´</span>
     <span class="hljs-keyword">await</span> <span class="hljs-title function_">aiAvatar</span>(); <span class="hljs-comment">// è°ƒç”¨ store ä¸­çš„ action</span>
     <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">false</span>); <span class="hljs-comment">// ç»“æŸ loading</span>
  }
}
</code></pre>
<p>è¿™é‡Œè°ƒç”¨äº† <code>aiAvatar()</code>ã€‚è¿™ä¸ªæ–¹æ³•åœ¨å“ªé‡Œï¼Ÿå®ƒå­˜åœ¨äºæˆ‘ä»¬çš„çŠ¶æ€ç®¡ç†åº“ <strong>Zustand</strong> ä¸­ã€‚</p>
<p>ğŸ“ <strong>åæ ‡</strong>ï¼š<code>frontend/notes/src/store/useUserStore.ts</code></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ... inside create store</span>
<span class="hljs-attr">aiAvatar</span>: <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-comment">// 1. è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯</span>
    <span class="hljs-comment">// get() æ˜¯ Zustand æä¾›çš„å„ç§è®¿é—® store å†…éƒ¨çŠ¶æ€çš„æ–¹æ³•</span>
    <span class="hljs-keyword">const</span> name = <span class="hljs-title function_">get</span>().<span class="hljs-property">user</span>?.<span class="hljs-property">name</span>;
    
    <span class="hljs-comment">// 2. æ ¸å¿ƒè°ƒç”¨ï¼šè¯·æ±‚ AI ç”Ÿæˆå¤´åƒçš„æ¥å£</span>
    <span class="hljs-comment">// æˆ‘ä»¬æŠŠç”¨æˆ·åä¼ è¿‡å»ï¼Œè®© AI æ ¹æ®åå­—æ‰¾çµæ„Ÿ</span>
    <span class="hljs-keyword">const</span> avatar = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getAiAvatar</span>(name);
    
    <span class="hljs-comment">// 3. æ›´æ–°çŠ¶æ€</span>
    <span class="hljs-comment">// set() ç”¨äºæ›´æ–° store</span>
    <span class="hljs-title function_">set</span>({
        <span class="hljs-attr">user</span>: {
            ...<span class="hljs-title function_">get</span>().<span class="hljs-property">user</span>, <span class="hljs-comment">// ä¿ç•™åŸæœ‰çš„ user ä¿¡æ¯ï¼ˆå¦‚ id, email ç­‰ï¼‰</span>
            avatar <span class="hljs-comment">// åªæ›´æ–° avatar å­—æ®µä¸ºæ–°ç”Ÿæˆçš„ URL</span>
        }
    })
}
</code></pre>
<p><strong>ğŸ¤” ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå†™ï¼Ÿ</strong></p>
<p>æˆ‘ä»¬å°†ä¸šåŠ¡é€»è¾‘å°è£…åœ¨ Store ä¸­ï¼Œè€Œä¸æ˜¯ç›´æ¥å†™åœ¨ç»„ä»¶é‡Œã€‚</p>
<ul>
<li><strong>è§£è€¦</strong>ï¼šç»„ä»¶åªè´Ÿè´£â€œæ˜¾ç¤ºâ€å’Œâ€œè§¦å‘â€ï¼ŒStore è´Ÿè´£â€œæ€ä¹ˆåšâ€ã€‚</li>
<li><strong>å¤ç”¨</strong>ï¼šå¦‚æœåœ¨å…¶ä»–é¡µé¢ä¹Ÿéœ€è¦ç”Ÿæˆå¤´åƒï¼Œç›´æ¥è°ƒç”¨ <code>aiAvatar</code> å³å¯ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-5">ğŸŒ‰ ç¬¬ä¸‰ç«™ï¼šé€šä¿¡æ¡¥æ¢ â€”â€” API å®šä¹‰</h2>
<p>å‰ç«¯éœ€è¦å‘åç«¯å–Šè¯ï¼šâ€œå˜¿ï¼Œç»™æˆ‘å˜ä¸ªå¤´åƒå‡ºæ¥ï¼â€ğŸ“£</p>
<p>ğŸ“ <strong>åæ ‡</strong>ï¼š<code>frontend/notes/src/api/user.ts</code></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> instance <span class="hljs-keyword">from</span> <span class="hljs-string">'./axios-instance'</span>; 

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">getAiAvatar</span> = (<span class="hljs-params">name:<span class="hljs-built_in">string</span></span>) =&gt; {
    <span class="hljs-comment">// å‘é€ HTTP GET è¯·æ±‚</span>
    <span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ GET è¯·æ±‚ï¼ŒæŠŠ name ä½œä¸ºæŸ¥è¯¢å‚æ•°ä¼ é€’</span>
    <span class="hljs-keyword">return</span> instance.<span class="hljs-title function_">get</span>(<span class="hljs-string">`/ai/avatar?name=<span class="hljs-subst">${name}</span>`</span>);
}   
</code></pre>
<p><strong>ğŸ“ çŸ¥è¯†ç‚¹å¡ç‰‡ï¼š</strong>
è™½ç„¶åˆ›å»ºèµ„æºå¸¸ç”¨ <code>POST</code>ï¼Œä½†è¿™é‡Œè¯­ä¹‰æ›´åå‘äºâ€œè·å–â€ï¼ˆGetï¼‰ä¸€ä¸ªåŸºäºåå­—è®¡ç®—å‡ºæ¥çš„èµ„æºã€‚æ‰€ä»¥ä½¿ç”¨ <code>GET</code> è¯·æ±‚é…åˆ Query Parameters (<code>?name=xxx</code>) æ˜¯å®Œå…¨ç¬¦åˆ RESTful é£æ ¼çš„ã€‚</p>
<hr/>
<h2 data-id="heading-6">âš™ï¸ ç¬¬å››ç«™ï¼šåç«¯å¼•æ“ â€”â€” NestJS ä¸ AI æœåŠ¡</h2>
<p>è¯·æ±‚é£åˆ°äº†æˆ‘ä»¬çš„åç«¯æœåŠ¡å™¨ï¼ˆNestJSï¼‰ã€‚</p>
<h3 data-id="heading-7">4.1 Controller (æ§åˆ¶å±‚)</h3>
<p>Controller æ˜¯åç«¯çš„å¤§é—¨ï¼Œè´Ÿè´£æ¥æ”¶è¯·æ±‚ã€‚</p>
<p>ğŸ“ <strong>åæ ‡</strong>ï¼š<code>backend/posts/src/ai/ai.controller.ts</code></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Controller</span>(<span class="hljs-string">'ai'</span>)
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AiController</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> aiService: AiService</span>) {}

  <span class="hljs-comment">// å¯¹åº”å‰ç«¯çš„ GET /ai/avatar è¯·æ±‚</span>
  <span class="hljs-meta">@Get</span>(<span class="hljs-string">'avatar'</span>)
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">avatar</span>(<span class="hljs-params"><span class="hljs-meta">@Query</span>(<span class="hljs-string">'name'</span>) name: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-comment">// å§”æ‰˜ç»™ aiService å»å¤„ç†</span>
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiService</span>.<span class="hljs-title function_">avatar</span>(name);
  }
}
</code></pre>
<p><code>@Query('name')</code> è‡ªåŠ¨å¸®æˆ‘ä»¬è§£æäº† URL ä¸­çš„ <code>?name=...</code> å‚æ•°ã€‚</p>
<h3 data-id="heading-8">4.2 Service (æœåŠ¡å±‚) â€”â€” AI çš„æ –æ¯åœ° ğŸ¤–</h3>
<p>è¿™é‡Œæ˜¯æ ¸å¿ƒé€»è¾‘æ‰€åœ¨ã€‚æˆ‘ä»¬è¦è°ƒç”¨ <strong>OpenAI</strong> (æˆ–å…¼å®¹æ¥å£) çš„ DALLÂ·E æ¨¡å‹ã€‚</p>
<p>ğŸ“ <strong>åæ ‡</strong>ï¼š<code>backend/posts/src/ai/ai.service.ts</code></p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªèƒ½å¤Ÿä¸ AI å¯¹è¯çš„å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å¼•å…¥å¿…è¦çš„åº“ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ LangChain çš„å°è£…</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">DallEAPIWrapper</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/openai'</span>; 

<span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AiService</span> {
  <span class="hljs-comment">// å®šä¹‰ç§æœ‰å±æ€§ï¼Œç”¨äºå­˜æ”¾å›¾åƒç”Ÿæˆå™¨çš„å®ä¾‹</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">imageGenerator</span>: <span class="hljs-title class_">DallEAPIWrapper</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ğŸ’¡ åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–æ¨¡å‹</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imageGenerator</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DallEAPIWrapper</span>({
      <span class="hljs-attr">openAIApiKey</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">OPENAI_API_KEY</span>, <span class="hljs-comment">// è®°å¾—åœ¨ .env æ–‡ä»¶é‡Œé…å¥½ Keyï¼</span>
      <span class="hljs-attr">n</span>: <span class="hljs-number">1</span>,               <span class="hljs-comment">// ä¸€æ¬¡ç”Ÿæˆä¸€å¼ å›¾</span>
      <span class="hljs-attr">size</span>: <span class="hljs-string">'1024x1024'</span>,  <span class="hljs-comment">// é«˜æ¸…å¤§å›¾</span>
      <span class="hljs-attr">quality</span>: <span class="hljs-string">'standard'</span> <span class="hljs-comment">// æ ‡å‡†è´¨é‡</span>
    })
  }
</code></pre>
<p>æ¥ä¸‹æ¥æ˜¯å…·ä½“çš„ <code>avatar</code> æ–¹æ³•ï¼Œè¿™é‡ŒåŒ…å«äº†æˆ‘ä»¬çš„ <strong>Prompt Engineeringï¼ˆæç¤ºè¯å·¥ç¨‹ï¼‰</strong>ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript">  <span class="hljs-keyword">async</span> <span class="hljs-title function_">avatar</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-comment">// invoke æ–¹æ³•è°ƒç”¨ DALL-E</span>
    <span class="hljs-comment">// è¿™é‡Œçš„å­—ç¬¦ä¸²å°±æ˜¯æˆ‘ä»¬å‘ç»™ AI çš„â€œå’’è¯­â€ (Prompt)</span>
    <span class="hljs-keyword">const</span> imageUrl = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">imageGenerator</span>.<span class="hljs-title function_">invoke</span>(<span class="hljs-string">`
      ä½ æ˜¯ä¸€ä½å¤´åƒè®¾è®¡å¸ˆ
      è¯·æ ¹æ®ç”¨æˆ·çš„å§“å<span class="hljs-subst">${name}</span>
      ç”Ÿæˆä¸€ä¸ªä¸“ä¸šå¤´åƒ
      é£æ ¼å¡é€šæ—¶å°šå¥½çœ‹
    `</span>);
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(imageUrl, <span class="hljs-string">'/////'</span>);
    <span class="hljs-keyword">return</span> imageUrl;
  }
}
</code></pre>
<p><strong>ğŸ© é­”æœ¯æ­ç§˜ï¼š</strong></p>
<ol>
<li><strong>Prompt çš„è‰ºæœ¯</strong>ï¼šæˆ‘ä»¬ç»™ AI è®¾å®šäº†<strong>è§’è‰²</strong>ï¼ˆ"ä½ æ˜¯ä¸€ä½å¤´åƒè®¾è®¡å¸ˆ"ï¼‰å’Œ<strong>é£æ ¼è¦æ±‚</strong>ï¼ˆ"é£æ ¼å¡é€šæ—¶å°šå¥½çœ‹"ï¼‰ã€‚</li>
<li><strong>å¼‚æ­¥æµ</strong>ï¼šä» <code>handleAction</code> åˆ° <code>OpenAI</code>ï¼Œæ•´ä¸ªé“¾è·¯éƒ½æ˜¯å¼‚æ­¥çš„ï¼ˆAsync/Awaitï¼‰ã€‚è¿™æ„å‘³ç€åœ¨ç­‰å¾… AI ä½œç”»æ—¶ï¼Œå‰ç«¯å±•ç¤º Loadingï¼Œåç«¯ä¹Ÿä¸ä¼šé˜»å¡ï¼Œç”¨æˆ·ä½“éªŒä¾ç„¶æµç•…ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-9">ğŸŒˆ æ€»ç»“ï¼šå…¨æ ˆçš„é­…åŠ›</h2>
<p>èµ°åˆ°ä»Šå¤©ï¼Œä½ ä¼šå‘ç°å…¨æ ˆå¼€å‘æœ€è¿·äººçš„åœ°æ–¹åœ¨äº <strong>â€œæŒæ§æ„Ÿâ€</strong>ã€‚</p>
<ul>
<li>ä½ åœ¨ <strong>Frontend</strong> åƒæ­ç§¯æœ¨ä¸€æ ·ç”¨ <code>Drawer</code> å®¶æ—ç»„ä»¶æ„å»ºäº†ä¼˜é›…çš„äº¤äº’ã€‚</li>
<li>ä½ åœ¨ <strong>Store</strong> æ¢³ç†äº†æ•°æ®æµï¼Œè®©çŠ¶æ€æ›´æ–°äº•äº•æœ‰æ¡ã€‚</li>
<li>ä½ åœ¨ <strong>Backend</strong> æŒ‡æŒ¥å¼ºå¤§çš„ AI æ¨¡å‹ä¸ºä½ æœåŠ¡ã€‚</li>
</ul>
<p>å½“ä½ åœ¨æ‰‹æœºæ¨¡æ‹Ÿå™¨ä¸Šç‚¹å‡»é‚£ä¸ªç´«è‰²æŒ‰é’®ï¼Œçœ‹ç€ Loading è½¬åœˆï¼Œæœ€åå¼¹å‡ºä¸€ä¸ªæ ¹æ®ä½ åå­—ç”Ÿæˆçš„ç²¾ç¾å¡é€šå¤´åƒæ—¶ï¼Œé‚£ç§â€œæˆ‘åˆ›é€ äº†è¿™ä¸ªä¸–ç•Œâ€çš„æˆå°±æ„Ÿï¼Œå°±æ˜¯ç¼–ç¨‹æœ€å¤§çš„ä¹è¶£å§ï¼ğŸ¥°</p>
<p><strong>ğŸ’» ä¸‹æœŸé¢„å‘Šï¼š</strong>
å¤´åƒæœ‰äº†ï¼Œæ˜¯ä¸æ˜¯è¯¥å‘ç‚¹å¸¦å›¾çš„åŠ¨æ€äº†ï¼Ÿä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ <strong>å›¾ç‰‡ä¸Šä¼ ä¸äº‘å­˜å‚¨</strong>ï¼Œè®©ä½ çš„åº”ç”¨ä¸ä»…ä»…èƒ½çœ‹ï¼Œè¿˜èƒ½â€œå­˜â€ï¼</p>
<p>æ˜é‡‘çš„ä¼™ä¼´ä»¬ï¼Œå¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œåˆ«å¿˜äº† <strong>ç‚¹èµ ğŸ‘ã€æ”¶è— ğŸŒŸã€å…³æ³¨ ğŸ‘€</strong> ä¸‰è¿å“¦ï¼ä½ çš„æ”¯æŒæ˜¯æˆ‘æŒç»­æ›´æ–°çš„æœ€å¤§åŠ¨åŠ›ï¼</p>
<p>æˆ‘ä»¬ä¸‹æœŸè§ï¼ğŸ‘‹</p>
<hr/>
<p><em>æœ¬æ–‡ä»£ç åŸºäº AI Fullstack Project æ•™å­¦é¡¹ç›®ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒã€‚</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[tsdown å¿«é€Ÿä¸Šæ‰‹å®æ“ï¼šé›¶é…ç½®ä¹Ÿèƒ½è·‘çš„TSæé€Ÿæ„å»ºå·¥å…·]]></title>    <link>https://juejin.cn/post/7603043152673390607</link>    <guid>https://juejin.cn/post/7603043152673390607</guid>    <pubDate>2026-02-05T14:04:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603043152673390607" data-draft-id="7603183929252102196" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="tsdown å¿«é€Ÿä¸Šæ‰‹å®æ“ï¼šé›¶é…ç½®ä¹Ÿèƒ½è·‘çš„TSæé€Ÿæ„å»ºå·¥å…·"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2026-02-05T14:04:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¦‚æœä½ å¥½"/> <meta itemprop="url" content="https://juejin.cn/user/2272012281328215"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            tsdown å¿«é€Ÿä¸Šæ‰‹å®æ“ï¼šé›¶é…ç½®ä¹Ÿèƒ½è·‘çš„TSæé€Ÿæ„å»ºå·¥å…·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2272012281328215/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¦‚æœä½ å¥½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T14:04:18.000Z" title="Thu Feb 05 2026 14:04:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€tsdownçš„å®ç”¨ä¼˜åŠ¿</h2>
<ol>
<li><strong>æé€Ÿæ„å»º</strong>ï¼šåº•å±‚æ˜¯esbuildï¼Œæ¯”ä¼ ç»Ÿtscç¼–è¯‘å¿«å‡ å€ï¼Œå¤§é¡¹ç›®ä¹Ÿèƒ½ç§’çº§æ„å»ºï¼›</li>
<li><strong>é›¶é…ç½®å‹å¥½</strong>ï¼šé…ç½®æ–‡ä»¶å¯ä»¥ç©ºå†…å®¹ï¼Œé»˜è®¤è§„åˆ™èƒ½è¦†ç›–80%çš„TSé¡¹ç›®éœ€æ±‚ï¼›</li>
<li><strong>åŠŸèƒ½å…¨ä¸”å®ç”¨</strong>ï¼šå¤šæ ¼å¼è¾“å‡ºã€è‡ªåŠ¨ç”Ÿæˆd.tsã€ä»£ç å‹ç¼©ã€ç›‘å¬æ¨¡å¼ã€æ ‘æ‘‡è¿™äº›å¼€å‘å¿…å¤‡åŠŸèƒ½éƒ½æœ‰ï¼›</li>
<li><strong>ä¸Šæ‰‹æˆæœ¬ä½</strong>ï¼šå•é…ç½®æ–‡ä»¶+ç®€æ´é…ç½®é¡¹ï¼Œä¸ç”¨åŒæ—¶å­¦å¤šä¸ªå·¥å…·çš„è¯­æ³•ï¼Œæ–°æ‰‹ä¹Ÿèƒ½ä¸€æ¬¡é…å¥½ã€‚</li>
</ol>
<p>ç‰¹åˆ«é€‚åˆåš<strong>TSå·¥å…·åº“ã€NPMåŒ…ã€Nodeå°æ¨¡å—</strong>ï¼Œè½»é‡åˆé«˜æ•ˆã€‚</p>
<h2 data-id="heading-1">äºŒã€é¡¹ç›®åˆå§‹åŒ– &amp; ä¾èµ–å®‰è£…</h2>
<p>æ–°å»ºé¡¹ç›®æ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œä¸¤æ­¥æå®šåˆå§‹åŒ–ï¼Œä¾èµ–åªè£…å¿…è¦çš„ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¿«é€Ÿåˆå§‹åŒ–package.jsonï¼Œä¸€è·¯é»˜è®¤å›è½¦</span>
npm init -y
<span class="hljs-comment"># å®‰è£…tsdownå¼€å‘ä¾èµ–</span>
npm i -D tsdown
<span class="hljs-comment"># ã€å¯é€‰ã€‘å¦‚æœéœ€è¦ç”Ÿæˆ.d.tsç±»å‹å£°æ˜æ–‡ä»¶ï¼Œå®‰è£…typescriptï¼ˆå‘å¸ƒNPMåŒ…å»ºè®®è£…ï¼‰</span>
npm i -D typescript
</code></pre>
<h2 data-id="heading-2">ä¸‰ã€æ ‡å‡†åŒ–é¡¹ç›®æ–‡ä»¶ç»“æ„</h2>
<p>æ­ä¸€ä¸ªé€šç”¨çš„TSé¡¹ç›®ç»“æ„ï¼Œæ¸…æ™°æ˜“ç»´æŠ¤ï¼Œæ„å»ºäº§ç‰©ä¼šè‡ªåŠ¨ç”Ÿæˆåˆ°distç›®å½•ï¼Œä¸ç”¨æ‰‹åŠ¨åˆ›å»ºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">â”œâ”€â”€ dist/               <span class="hljs-comment"># æ„å»ºåè‡ªåŠ¨ç”Ÿæˆï¼ˆäº§ç‰©ã€ç±»å‹å£°æ˜ã€sourcemapï¼‰</span>
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts        <span class="hljs-comment"># é¡¹ç›®å…¥å£ï¼ˆç»Ÿä¸€å¯¼å‡ºæ‰€æœ‰æ¨¡å—ï¼‰</span>
â”‚   â””â”€â”€ tools.ts        <span class="hljs-comment"># ä¸šåŠ¡å·¥å…·å‡½æ•°ï¼ˆç¤ºä¾‹ä»£ç ï¼‰</span>
â”œâ”€â”€ package.json        <span class="hljs-comment"># é¡¹ç›®ä¿¡æ¯ + æ„å»ºè„šæœ¬</span>
â””â”€â”€ tsdown.config.ts    <span class="hljs-comment"># tsdowné…ç½®æ–‡ä»¶ï¼ˆå¯ç©ºï¼Œæ”¯æŒè‡ªå®šä¹‰ï¼‰</span>
</code></pre>
<h2 data-id="heading-3">å››ã€ç¼–å†™ç¤ºä¾‹ä»£ç </h2>
<p>æ›¿æ¢æˆæ—¥å¸¸å¼€å‘ä¸­å¸¸ç”¨çš„<strong>å·¥å…·å‡½æ•°</strong>ï¼Œå¸¦å®Œæ•´TSç±»å‹æ³¨è§£ï¼Œç®€å•å®ç”¨ï¼Œæ–¹ä¾¿åç»­éªŒè¯æ„å»ºæ•ˆæœã€‚</p>
<h3 data-id="heading-4">src/tools.ts - å·¥å…·å‡½æ•°æ¨¡å—</h3>
<p>å†™ä¸¤ä¸ªé«˜é¢‘ç”¨åˆ°çš„å°å·¥å…·ï¼ŒåŠ äº†ç®€å•æ³¨é‡Šï¼Œç¬¦åˆTSå¼€å‘è§„èŒƒï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * ç²¾å‡†åˆ¤æ–­æ•°æ®ç±»å‹
 * <span class="hljs-doctag">@param</span> val ä»»æ„å€¼
 * <span class="hljs-doctag">@returns</span> å°å†™ç±»å‹åï¼ˆå¦‚stringã€arrayã€nullï¼‰
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getType</span>(<span class="hljs-params">val: <span class="hljs-built_in">any</span></span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(val).<span class="hljs-title function_">slice</span>(<span class="hljs-number">8</span>, -<span class="hljs-number">1</span>).<span class="hljs-title function_">toLowerCase</span>()
}

<span class="hljs-comment">/**
 * æ•°ç»„å»é‡ï¼ˆæ”¯æŒæ•°å­—/å­—ç¬¦ä¸²æ•°ç»„ï¼‰
 * <span class="hljs-doctag">@param</span> arr å¾…å»é‡æ•°ç»„
 * <span class="hljs-doctag">@returns</span> å»é‡åçš„æ–°æ•°ç»„
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> uniqueArr&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span>&gt;(<span class="hljs-attr">arr</span>: T[]): T[] {
  <span class="hljs-keyword">return</span> [...<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(arr)]
}
</code></pre>
<h3 data-id="heading-5">src/index.ts - é¡¹ç›®ç»Ÿä¸€å…¥å£</h3>
<p>ä½œä¸ºå¯¹å¤–æš´éœ²çš„å”¯ä¸€å…¥å£ï¼ŒæŒ‰éœ€å¯¼å‡ºå·¥å…·å‡½æ•°ï¼Œå¤–éƒ¨å¼•ç”¨æ—¶åªéœ€è¦å¯¼å…¥è¿™ä¸ªæ–‡ä»¶å°±è¡Œï¼Œç¬¦åˆæ¨¡å—åŒ–å¼€å‘ä¹ æƒ¯ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç»Ÿä¸€å¯¼å‡ºï¼Œå¯¹å¤–æä¾›æ¸…æ™°çš„API</span>
<span class="hljs-keyword">export</span> { getType, uniqueArr } <span class="hljs-keyword">from</span> <span class="hljs-string">'./tools'</span>
</code></pre>
<h2 data-id="heading-6">äº”ã€tsdown.config.ts é…ç½®ï¼šç©ºé…ç½®å¯ç”¨ + ç‰¹æ®Šå±æ€§å…¨è§£</h2>
<p>è¿™æ˜¯æ ¸å¿ƒéƒ¨åˆ†ï¼Œtsdownæ”¯æŒ<strong>é…ç½®æ–‡ä»¶ç©ºå†…å®¹ç›´æ¥è¿è¡Œ</strong>ï¼ˆç”¨é»˜è®¤é…ç½®ï¼‰ï¼Œä¹Ÿèƒ½æ ¹æ®éœ€æ±‚åŠ è‡ªå®šä¹‰é…ç½®å’Œç‰¹æ®Šå±æ€§ã€‚ä¸‹é¢æä¾›ä¸¤ä¸ªæ¨¡æ¿ï¼ŒæŒ‰éœ€é€‰æ‹©ï¼Œéƒ½å¸¦TSç±»å‹æç¤ºã€‚</p>
<h3 data-id="heading-7">æ¨¡æ¿1ï¼šæœ€ç®€ç©ºé…ç½®ï¼ˆæ¨èå°é¡¹ç›®/å¿«é€Ÿå¼€å‘ï¼‰</h3>
<p>é…ç½®æ–‡ä»¶é‡Œä»€ä¹ˆéƒ½ä¸ç”¨å†™ï¼Œç›´æ¥å¯¼å‡ºç©ºé…ç½®ï¼Œtsdownä¼šè‡ªåŠ¨å¯ç”¨<strong>å†…ç½®é»˜è®¤é…ç½®</strong>ï¼Œå¼€ç®±å³ç”¨ï¼Œçœæ—¶é—´ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'tsdown'</span>

<span class="hljs-comment">// ç©ºé…ç½®ï¼šç›´æ¥ç”¨é»˜è®¤è§„åˆ™ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®ä»»ä½•é¡¹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({})
</code></pre>
<h3 data-id="heading-8">æ¨¡æ¿2ï¼šå®Œæ•´é…ç½®ï¼ˆå«ç‰¹æ®Šå±æ€§ï¼Œæ¨èç”Ÿäº§/å¤§é¡¹ç›®/NPMåŒ…ï¼‰</h3>
<p>ä¿ç•™æ‰€æœ‰æ ¸å¿ƒé…ç½®é¡¹ï¼Œé‡ç‚¹æ ‡æ³¨<strong>ç‰¹æ®Šå±æ€§</strong>ï¼ˆæ—¥å¸¸æ˜“å¿½ç•¥ã€ç”Ÿäº§å¸¸ç”¨ï¼‰ï¼Œæ¯ä¸€é¡¹éƒ½åŠ äº†å®ç”¨æ³¨é‡Šï¼Œå¯æ ¹æ®è‡ªå·±çš„é¡¹ç›®åœºæ™¯ä¿®æ”¹ï¼Œç›´æ¥æ›¿æ¢ä¸Šé¢çš„ç©ºé…ç½®å°±è¡Œï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'tsdown'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-comment">// åŸºç¡€å…¥å£è¾“å‡ºé…ç½®</span>
  <span class="hljs-attr">entry</span>: [<span class="hljs-string">'./src/index.ts'</span>], <span class="hljs-comment">// å…¥å£ï¼šå•å…¥å£å†™å­—ç¬¦ä¸²ï¼Œå¤šå…¥å£å†™æ•°ç»„ï¼Œç©ºé…ç½®é»˜è®¤è¯†åˆ«src/index.ts</span>
  <span class="hljs-attr">outDir</span>: <span class="hljs-string">'./dist'</span>,          <span class="hljs-comment">// è¾“å‡ºç›®å½•ï¼Œé»˜è®¤å°±æ˜¯./dist</span>
  <span class="hljs-attr">target</span>: <span class="hljs-string">'es6'</span>,             <span class="hljs-comment">// è¯­æ³•é™çº§ï¼Œes6å…¼å®¹å¤§éƒ¨åˆ†ç°ä»£ç¯å¢ƒï¼Œéœ€è¦å…¼å®¹ä½ç‰ˆæœ¬å¯è®¾ä¸ºes5</span>
  <span class="hljs-attr">format</span>: <span class="hljs-string">'esm'</span>,             <span class="hljs-comment">// è¾“å‡ºæ ¼å¼ï¼šesm/cjs/iifeï¼Œå¯å†™æ•°ç»„åŒæ—¶è¾“å‡ºå¤šæ ¼å¼ï¼ˆå¦‚['esm', 'cjs']ï¼‰</span>
  <span class="hljs-attr">platform</span>: <span class="hljs-string">'neutral'</span>,       <span class="hljs-comment">// è¿è¡Œå¹³å°ï¼šnodeï¼ˆNodeç¯å¢ƒï¼‰/browserï¼ˆæµè§ˆå™¨ï¼‰/neutralï¼ˆé€šç”¨ï¼‰</span>

  <span class="hljs-comment">// ä¼˜åŒ–ç›¸å…³é…ç½®</span>
  <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,        <span class="hljs-comment">// æ„å»ºå‰æ¸…ç©ºdistï¼Œå»ºè®®å¼€å¯ï¼Œé¿å…æ—§äº§ç‰©æ®‹ç•™</span>
  <span class="hljs-attr">dts</span>: <span class="hljs-literal">true</span>,          <span class="hljs-comment">// ç”Ÿæˆ.d.tsç±»å‹å£°æ˜ï¼Œéœ€æå‰è£…typescriptï¼Œå‘å¸ƒNPMåŒ…å¿…å¼€</span>
  <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span>,    <span class="hljs-comment">// ç”Ÿæˆæºç æ˜ å°„ï¼Œæ–¹ä¾¿è°ƒè¯•ï¼Œç”Ÿäº§ç¯å¢ƒå¯è®¾ä¸ºfalseå‡å°ä½“ç§¯</span>
  <span class="hljs-attr">treeshake</span>: <span class="hljs-literal">true</span>,    <span class="hljs-comment">// æ ‘æ‘‡ï¼šè‡ªåŠ¨åˆ é™¤æœªä½¿ç”¨ä»£ç ï¼Œé»˜è®¤å¼€å¯ï¼Œä¸ç”¨æ‰‹åŠ¨å…³</span>
  <span class="hljs-attr">minify</span>: <span class="hljs-literal">true</span>,       <span class="hljs-comment">// ä»£ç å‹ç¼©ï¼Œç”Ÿäº§å¼€ã€å¼€å‘å…³ï¼ˆå¼€å‘å…³äº†æ–¹ä¾¿çœ‹ç¼–è¯‘åçš„ä»£ç ï¼‰</span>

  <span class="hljs-comment">// å¼€å‘è°ƒè¯•é…ç½®</span>
  <span class="hljs-attr">watch</span>: <span class="hljs-literal">false</span>,       <span class="hljs-comment">// ç›‘å¬æ¨¡å¼ï¼šå¼€å‘å¼€ï¼Œæ–‡ä»¶ä¿®æ”¹è‡ªåŠ¨é‡æ–°æ„å»ºï¼Œç”Ÿäº§å…³</span>

  <span class="hljs-comment">// ç‰¹æ®Šå±æ€§ï¼ˆé‡ç‚¹ï¼‰ï¼šæ—¥å¸¸å¼€å‘æ˜“å¿½ç•¥ï¼ŒæŒ‰éœ€ä½¿ç”¨</span>
  <span class="hljs-attr">unbundle</span>: <span class="hljs-literal">false</span>,    <span class="hljs-comment">// æ‹†åŒ…ï¼šå¤šå…¥å£é¡¹ç›®å¼€ï¼ŒæŒ‰å…¥å£æ‹†åˆ†äº§ç‰©ï¼›å•å…¥å£å…³äº†å°±è¡Œ</span>
  <span class="hljs-attr">external</span>: [],       <span class="hljs-comment">// å¤–éƒ¨ä¾èµ–ï¼šæŒ‡å®šä¸æ‰“åŒ…è¿›äº§ç‰©çš„åŒ…ï¼ˆå¦‚react/vueï¼‰ï¼Œéœ€å¤–éƒ¨è‡ªè¡Œå¼•å…¥</span>
  <span class="hljs-attr">noExternal</span>: []      <span class="hljs-comment">// å¼ºåˆ¶æ‰“åŒ…ï¼šè¦†ç›–externalï¼Œå³ä½¿åœ¨externalé‡Œä¹Ÿå¼ºåˆ¶æ‰“åŒ…è¿›äº§ç‰©</span>
})
</code></pre>
<h3 data-id="heading-9">å…³é”®ç‰¹æ®Šå±æ€§å®ç”¨è¯´æ˜</h3>
<p>ä¸ç”¨æ­»è®°ï¼ŒçŸ¥é“è¿™äº›åœºæ™¯æ€ä¹ˆç”¨å°±è¡Œï¼š</p>
<ul>
<li><code>clean</code>ï¼šå¿…å¼€ï¼Œå¦åˆ™æ¯æ¬¡æ„å»ºçš„æ–°äº§ç‰©ä¼šå’Œæ—§äº§ç‰©æ··åœ¨ä¸€èµ·ï¼Œå®¹æ˜“å‡ºé—®é¢˜ï¼›</li>
<li><code>dts</code>ï¼šå‘å¸ƒNPMåŒ…å¿…å¼€ï¼Œå¦åˆ™å…¶ä»–TSé¡¹ç›®å¼•ç”¨æ—¶æ²¡æœ‰ç±»å‹æç¤ºï¼›</li>
<li><code>external/noExternal</code>ï¼šå¼€å‘åŸºäºReact/Vueçš„å·¥å…·åº“æ—¶ç”¨ï¼Œä¸è®©æ ¸å¿ƒåº“æ‰“åŒ…è¿›äº§ç‰©ï¼Œå‡å°ä½“ç§¯ï¼›</li>
<li><code>unbundle</code>ï¼šåªæœ‰å¤šå…¥å£é¡¹ç›®éœ€è¦å¼€ï¼Œå•å…¥å£å¼€äº†åè€Œä¼šç”Ÿæˆå¤šä½™æ–‡ä»¶ï¼›</li>
<li><code>minify</code>ï¼šå¼€å‘é˜¶æ®µå»ºè®®è®¾ä¸ºfalseï¼Œç¼–è¯‘åçš„ä»£ç æœ‰æ ¼å¼ï¼Œæ–¹ä¾¿è°ƒè¯•é—®é¢˜ã€‚</li>
</ul>
<h2 data-id="heading-10">å…­ã€é…ç½®package.json æ„å»ºè„šæœ¬</h2>
<p>æ·»åŠ ä¸¤ä¸ªå¸¸ç”¨è„šæœ¬ï¼Œç¬¦åˆå‰ç«¯å¼€å‘çš„ä½¿ç”¨ä¹ æƒ¯ï¼Œä¸€è¡Œå‘½ä»¤å°±èƒ½æ„å»º/å¼€å‘ï¼Œç©ºé…ç½®å’Œå®Œæ•´é…ç½®éƒ½èƒ½é€‚é…ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tsdown-demo"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"module"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// è¾“å‡ºesmæ ¼å¼å»ºè®®åŠ ï¼Œç¬¦åˆNodeçš„ESæ¨¡å—è§„èŒƒï¼Œè¾“å‡ºcjså¯åˆ é™¤</span>
  <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./dist/index.js"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// äº§ç‰©ä¸»å…¥å£ï¼ŒNPMåŒ…å¿…å¤‡</span>
  <span class="hljs-attr">"types"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./dist/index.d.ts"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// ç±»å‹å£°æ˜å…¥å£ï¼Œå¼€dtsæ—¶å¿…é…</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tsdown"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// ç”Ÿäº§æ„å»ºï¼šä¸€æ¬¡æ€§æ‰“åŒ…æ‰€æœ‰äº§ç‰©</span>
    <span class="hljs-attr">"dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tsdown --watch"</span> <span class="hljs-comment">// å¼€å‘æ¨¡å¼ï¼šç›‘å¬æ–‡ä»¶å˜åŒ–ï¼Œè‡ªåŠ¨é‡æ–°æ„å»º</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"devDependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"tsdown"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^latest"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"typescript"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^5.5.4"</span> <span class="hljs-comment">// å¼€dtsæ—¶å¿…é¡»è£…ï¼Œæ²¡å¼€å¯ä»¥åˆ </span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-11">ä¸ƒã€æ‰§è¡Œæ„å»º &amp; éªŒè¯ç»“æœ</h2>
<p>é…ç½®å…¨éƒ¨æå®šåï¼Œæ‰§è¡Œç®€å•å‘½ä»¤å°±èƒ½æ„å»ºï¼Œä¸ç®¡æ˜¯ç©ºé…ç½®è¿˜æ˜¯å®Œæ•´é…ç½®ï¼Œæ­¥éª¤éƒ½ä¸€æ ·ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒæ„å»ºï¼ˆç”Ÿæˆå‹ç¼©åçš„äº§ç‰©ï¼Œé€‚åˆå‘å¸ƒ/éƒ¨ç½²ï¼‰</span>
npm run build
<span class="hljs-comment"># å¼€å‘ç¯å¢ƒæ„å»ºï¼ˆç›‘å¬æ–‡ä»¶å˜åŒ–ï¼Œè‡ªåŠ¨æ›´æ–°ï¼Œé€‚åˆå†™ä»£ç æ—¶ç”¨ï¼‰</span>
npm run dev
</code></pre>
<h3 data-id="heading-12">æ„å»ºäº§ç‰©è¯´æ˜</h3>
<p>æ‰§è¡Œ<code>npm run build</code>åï¼Œdistç›®å½•ä¼šè‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„äº§ç‰©æ–‡ä»¶ï¼Œä»¥<strong>å¼€dts/sourcemap/minify</strong>ä¸ºä¾‹ï¼Œäº§ç‰©å¦‚ä¸‹ï¼Œå¯ç›´æ¥ç”¨äºNPMåŒ…å‘å¸ƒæˆ–å…¶ä»–é¡¹ç›®å¼•ç”¨ï¼š</p>
<pre><code class="hljs language-python" lang="python">dist/
â”œâ”€â”€ index.js        <span class="hljs-comment"># ç¼–è¯‘+å‹ç¼©åçš„JSæ ¸å¿ƒäº§ç‰©</span>
â”œâ”€â”€ index.d.ts      <span class="hljs-comment"># è‡ªåŠ¨ç”Ÿæˆçš„ç±»å‹å£°æ˜æ–‡ä»¶ï¼ˆTSé¡¹ç›®å¼•ç”¨æœ‰æç¤ºï¼‰</span>
â””â”€â”€ index.js.<span class="hljs-built_in">map</span>    <span class="hljs-comment"># æºç æ˜ å°„æ–‡ä»¶ï¼ˆæ–¹ä¾¿è°ƒè¯•ï¼‰</span>
</code></pre>
<h3 data-id="heading-13">å¿«é€ŸéªŒè¯æ„å»ºæ˜¯å¦æˆåŠŸ</h3>
<p>åœ¨distç›®å½•ä¸‹æ–°å»º<code>test.js</code>ï¼Œå¼•å…¥æ„å»ºåçš„äº§ç‰©ï¼Œæ‰§è¡Œå‘½ä»¤çœ‹è¾“å‡ºï¼ŒéªŒè¯åŠŸèƒ½æ˜¯å¦æ­£å¸¸ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { getType, uniqueArr } <span class="hljs-keyword">from</span> <span class="hljs-string">'./index.js'</span>

<span class="hljs-comment">// æµ‹è¯•å·¥å…·å‡½æ•°</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">getType</span>(<span class="hljs-string">'tsdown å®æ“'</span>)); <span class="hljs-comment">// è¾“å‡ºï¼šstring</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">getType</span>([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]));      <span class="hljs-comment">// è¾“å‡ºï¼šarray</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">uniqueArr</span>([<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">3</span>]));<span class="hljs-comment">// è¾“å‡ºï¼š[1,2,3]</span>
</code></pre>
<p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œæ§åˆ¶å°æ­£å¸¸è¾“å‡ºç»“æœï¼Œè¯´æ˜æ„å»ºå®Œå…¨æˆåŠŸï¼š</p>
<pre><code class="hljs language-bash" lang="bash">node dist/test.js
</code></pre>
<h2 data-id="heading-14">å…«ã€æ ¸å¿ƒé…ç½®é¡¹é€ŸæŸ¥</h2>
<p>æ•´ç†äº†æ—¥å¸¸å¼€å‘æœ€å¸¸ç”¨çš„é…ç½®é¡¹ã€ä½œç”¨å’Œé»˜è®¤å€¼ï¼Œè´´åœ¨è¿™æ–¹ä¾¿å¼€å‘æ—¶å¿«é€ŸæŸ¥é˜…ï¼Œä¸ç”¨æ¯æ¬¡ç¿»æ–‡æ¡£ï¼š</p>


















































































<table><thead><tr><th>é…ç½®é¡¹</th><th>æ ¸å¿ƒä½œç”¨</th><th>å¯é€‰å€¼/ç±»å‹</th><th>é»˜è®¤å€¼</th><th>å®ç”¨å»ºè®®</th></tr></thead><tbody><tr><td>entry</td><td>æŒ‡å®šé¡¹ç›®å…¥å£</td><td>string/string[]</td><td>src/index.ts</td><td>å•å…¥å£å†™å­—ç¬¦ä¸²ï¼Œå¤šå…¥å£å†™æ•°ç»„</td></tr><tr><td>outDir</td><td>äº§ç‰©è¾“å‡ºç›®å½•</td><td>string</td><td>./dist</td><td>ä¸€èˆ¬ä¸ç”¨æ”¹</td></tr><tr><td>format</td><td>äº§ç‰©è¾“å‡ºæ ¼å¼</td><td>esm/cjs/iife/æ•°ç»„</td><td>esm</td><td>å‘å¸ƒNPMåŒ…å¯é…['esm','cjs']</td></tr><tr><td>target</td><td>TSè¯­æ³•é™çº§ç›®æ ‡</td><td>es5/es6/es2020ç­‰</td><td>es6</td><td>éœ€å…¼å®¹ä½ç‰ˆæœ¬è®¾ä¸ºes5</td></tr><tr><td>dts</td><td>ç”Ÿæˆç±»å‹å£°æ˜</td><td>boolean</td><td>false</td><td>å‘å¸ƒNPMåŒ…å¿…å¼€ï¼Œéœ€è£…typescript</td></tr><tr><td>clean</td><td>æ„å»ºå‰æ¸…ç©ºè¾“å‡ºç›®å½•</td><td>boolean</td><td>false</td><td>å»ºè®®å§‹ç»ˆè®¾ä¸ºtrue</td></tr><tr><td>minify</td><td>ä»£ç å‹ç¼©</td><td>boolean</td><td>false</td><td>ç”Ÿäº§å¼€ï¼Œå¼€å‘å…³</td></tr><tr><td>watch</td><td>æ–‡ä»¶å˜åŒ–è‡ªåŠ¨æ„å»º</td><td>boolean</td><td>false</td><td>å¼€å‘å¼€ï¼Œç”Ÿäº§å…³</td></tr><tr><td>external</td><td>ä¸æ‰“åŒ…çš„å¤–éƒ¨ä¾èµ–</td><td>string[]</td><td>[]</td><td>å¼€å‘æ¡†æ¶å·¥å…·åº“æ—¶ç”¨</td></tr><tr><td>unbundle</td><td>æŒ‰å…¥å£æ‹†åŒ…</td><td>boolean</td><td>false</td><td>å¤šå…¥å£å¼€ï¼Œå•å…¥å£å…³</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Now in Android ç°ä»£åº”ç”¨å¼€å‘å®è·µï¼ˆä¸€ï¼‰ - æ¨¡å—åŒ–è®¾è®¡]]></title>    <link>https://juejin.cn/post/7603215839581126666</link>    <guid>https://juejin.cn/post/7603215839581126666</guid>    <pubDate>2026-02-05T10:46:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603215839581126666" data-draft-id="7602531501456621577" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Now in Android ç°ä»£åº”ç”¨å¼€å‘å®è·µï¼ˆä¸€ï¼‰ - æ¨¡å—åŒ–è®¾è®¡"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-02-05T10:46:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ—æ ©link"/> <meta itemprop="url" content="https://juejin.cn/user/870468939434039"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Now in Android ç°ä»£åº”ç”¨å¼€å‘å®è·µï¼ˆä¸€ï¼‰ - æ¨¡å—åŒ–è®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/870468939434039/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ—æ ©link
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T10:46:40.000Z" title="Thu Feb 05 2026 10:46:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æˆªè‡³2026å¹´ï¼Œ<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fandroid%2Fnowinandroid" target="_blank" title="https://github.com/android/nowinandroid" ref="nofollow noopener noreferrer">Now in Android</a></strong>ï¼ˆä»¥ä¸‹ç®€ç§° NiAï¼‰ä¾ç„¶æ˜¯ç”± Google å®˜æ–¹ç»´æŠ¤ã€æœ€èƒ½ä»£è¡¨â€œç°ä»£ Android åº”ç”¨æ¶æ„â€çš„æ ‡æ†é¡¹ç›®ï¼ŒGitHub æ˜Ÿæ ‡å·²çªç ´ 20Kã€‚</p>
<p>å®ƒä¸ä»…ç³»ç»Ÿæ€§åœ°å±•ç¤ºäº† Jetpack å…¨å®¶æ¡¶çš„æœ€ä½³å®è·µï¼Œæ›´å…³é”®çš„æ˜¯ï¼Œæä¾›äº†ä¸€æ•´å¥—é¢å‘ä¸­å¤§å‹é¡¹ç›®çš„å¯è½åœ°å·¥ç¨‹æ–¹æ¡ˆâ€”â€”æ¶µç›–<strong>æ¨¡å—åŒ–è®¾è®¡</strong>ã€<strong>åˆ†å±‚æ¶æ„</strong>ã€<strong>è‡ªåŠ¨åŒ–æµ‹è¯•</strong>ã€<strong>æ€§èƒ½åˆ†æ</strong>ã€<strong>ä»£ç æäº¤ã€é£æ ¼æ£€æŸ¥</strong>ä»¥åŠ<strong>å›¢é˜Ÿåä½œ</strong>ç­‰æ ¸å¿ƒç¯èŠ‚ï¼Œæ˜¯ <strong>Android åº”ç”¨å¼€å‘è€…çš„å¿…å­¦é¡¹ç›®</strong>ã€‚</p>
</blockquote>
<p>æœ¬ç³»åˆ—æ–‡ç« ä¸“ä¸º Android åº”ç”¨å¼€å‘è€…æ‰“é€ ï¼Œå°†ä»¥æŠ“å¤§æ”¾å°çš„æ¨¡å¼æ·±å…¥è§£æ Now in Android çš„è®¾è®¡ç²¾é«“ï¼Œå…¨ç³»åˆ—å…±å…«ç« ã€‚</p>
<ul>
<li><strong>ã€ŠNow in Android ç°ä»£åº”ç”¨å¼€å‘å®è·µï¼ˆä¸€ï¼‰ï¼šæ¨¡å—åŒ–è®¾è®¡ã€‹</strong></li>
<li><strong>ã€ŠNow in Android ç°ä»£åº”ç”¨å¼€å‘å®è·µï¼ˆäºŒï¼‰ï¼šæ¶æ„è®¾è®¡ï¼ˆdata+domainï¼‰ã€‹</strong></li>
<li><strong>ã€ŠNow in Android ç°ä»£åº”ç”¨å¼€å‘å®è·µï¼ˆä¸‰ï¼‰ï¼šæ¶æ„è®¾è®¡ï¼ˆUIï¼‰ã€‹</strong></li>
<li><strong>ã€ŠNow in Android ç°ä»£åº”ç”¨å¼€å‘å®è·µï¼ˆå››ï¼‰ï¼šæ„å»ºé€»è¾‘ã€‹</strong></li>
<li><strong>ã€ŠNow in Android ç°ä»£åº”ç”¨å¼€å‘å®è·µï¼ˆäº”ï¼‰ï¼šä»£ç è§„èŒƒã€‹</strong></li>
<li><strong>ã€ŠNow in Android ç°ä»£åº”ç”¨å¼€å‘å®è·µï¼ˆå…­ï¼‰ï¼šè´¨é‡ä¿éšœä½“ç³»ã€‹</strong></li>
<li><strong>ã€ŠNow in Android ç°ä»£åº”ç”¨å¼€å‘å®è·µï¼ˆä¸ƒï¼‰ï¼šBenchmark æ€§èƒ½æµ‹è¯•ã€‹</strong></li>
<li><strong>ã€ŠNow in Android ç°ä»£åº”ç”¨å¼€å‘å®è·µï¼ˆå…«ï¼‰ï¼šBaseline æ€§èƒ½ä¼˜åŒ–ã€‹</strong></li>
</ul>
<hr/>
<p>æœ¬æ–‡ä½œä¸ºå¼€ç¯‡ï¼Œå°†ç»“åˆ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Ftopic%2Fmodularization" target="_blank" title="https://developer.android.com/topic/modularization" ref="nofollow noopener noreferrer">Android å®˜æ–¹æ¨¡å—åŒ–æŒ‡å—</a>ï¼Œé‡ç‚¹è§£è¯» NiA çš„æ¨¡å—åŒ–è®¾è®¡æ€è·¯ï¼Œå¸®åŠ©ä½ å˜æ¸…ä»¥ä¸‹å…³é”®é—®é¢˜ï¼š</p>
<ul>
<li><strong>ä¸ºä»€ä¹ˆéœ€è¦æ¨¡å—åŒ–ï¼Ÿ</strong></li>
<li><strong>NiA åˆ°åº•å¦‚ä½•åˆ’åˆ†æ¨¡å—ï¼Ÿ</strong></li>
<li><strong>å®ƒéµå¾ªäº†</strong> <strong>å“ªç§</strong> <strong>å®˜æ–¹æ¨èçš„æ¨¡å—åŒ–æ¨¡å¼ï¼Ÿ</strong></li>
<li><strong>å“ªäº›è®¾è®¡å†³ç­–å€¼å¾—åœ¨å®é™…é¡¹ç›®ä¸­å€Ÿé‰´ï¼Ÿ</strong></li>
</ul>
<p>é€šè¿‡æœ¬æ–‡ï¼Œä½ å°†è·å¾—ä¸€å¥—å¯å¤ç”¨çš„æ¨¡å—åŒ–æ€ç»´æ¡†æ¶ï¼Œä¸ºæ„å»ºå¥å£®ã€å¯ç»´æŠ¤çš„ç°ä»£ Android åº”ç”¨æ‰“ä¸‹åšå®åŸºç¡€ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆç»•ä¸å¼€æ¨¡å—åŒ–ï¼Ÿ</h2>
<p>Androidå®˜æ–¹æ¨¡å—åŒ–æŒ‡å—æŠŠå¥½å¤„æ€»ç»“å¾—å¾ˆç›´æ¥ï¼š</p>
<ul>
<li><strong>æ„å»ºé€Ÿåº¦</strong>ï¼šå¢é‡ç¼–è¯‘ã€å¹¶è¡Œæ‰§è¡Œã€ç¼“å­˜å‘½ä¸­ç‡å¤§å¹…æå‡</li>
<li><strong>å¯ç»´æŠ¤æ€§ï¼š</strong> å…³æ³¨ç‚¹åˆ†ç¦»ã€é™ä½è€¦åˆã€ä¿®æ”¹ä¸€å¤„ä¸å½±å“å…¨å±€</li>
<li><strong>å›¢é˜Ÿåä½œï¼š</strong> æ¨¡å—å¯ä»¥åˆ†é…ownerï¼Œå‡å°‘ä»£ç å†²çª</li>
<li><strong>å¯æµ‹è¯•æ€§ï¼š</strong> æ¨¡å—ç²’åº¦æµ‹è¯•æ›´å®¹æ˜“Mockã€æ›´å¿«è¿è¡Œ</li>
<li><strong>å¯é‡ç”¨æ€§ï¼š</strong> æ ¸å¿ƒåŠŸèƒ½æ¨¡å—å¯å¤ç”¨åˆ°å¤šä¸ªApp/å˜ä½“/Wear/TV</li>
<li><strong>åŠŸèƒ½æŒ‰éœ€äº¤ä»˜</strong>ï¼ˆDynamic Featureï¼‰æ½œåŠ›</li>
<li><strong>å°è£…ä¸å¯è§æ€§æ§åˆ¶ï¼š</strong> åˆ©ç”¨<code>internal</code>çœŸæ­£éšè—å®ç°ç»†èŠ‚</li>
</ul>
<p>ç®€å•æ€»ç»“å°±æ˜¯ï¼Œ<strong>å½“é¡¹ç›®è¶…è¿‡2-3ä¸‡è¡Œä»£ç ã€è¶…è¿‡5-8äººå›¢é˜Ÿæ—¶ï¼Œæ¨¡å—åŒ–å‡ ä¹æ˜¯å”¯ä¸€èƒ½æŠŠå¤æ‚åº¦æ§åˆ¶ä½çš„æ‰‹æ®µ</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€ä¸»æµæ¨¡å—åŒ–æ–¹æ¡ˆåˆ†æ</h2>
<p>åœ¨ Android æ¶æ„è®¾è®¡ä¸­ï¼Œå¸¸è§çš„æ¨¡å—ç»„ç»‡æ¨¡å¼ä¸»è¦æœ‰ä¸‰ç§ï¼š<strong>çº¯åˆ†å±‚</strong>ã€<strong>çº¯æŒ‰åŠŸèƒ½åˆ’åˆ†</strong>ï¼Œä»¥åŠ<strong>åˆ†å±‚ä¸åŠŸèƒ½æ··åˆ</strong>çš„æ¨¡å¼ã€‚</p>
<p><strong>1.çº¯åˆ†å±‚æ¨¡å¼</strong></p>
<ul>
<li>
<p><strong>æ ¸å¿ƒæ€è·¯</strong>ï¼šæŒ‰ç…§æŠ€æœ¯èŒè´£çºµå‘åˆ’åˆ†ï¼Œå…¸å‹çš„å±‚çº§é¡ºåºä¸º data â†’ domain â†’ feature â†’ appã€‚</p>
</li>
<li>
<p><strong>ä¼˜ç‚¹</strong>ï¼šè¿™ç§ç»“æ„æ¸…æ™°ç®€å•ï¼Œå¤©ç„¶å¥‘åˆ MVVM æ¶æ„æ€æƒ³ï¼Œæ˜“äºä¸Šæ‰‹ã€‚</p>
</li>
<li>
<p><strong>ç¼ºç‚¹</strong>ï¼šä¸åŒä¸šåŠ¡åŠŸèƒ½ä¹‹é—´å®¹æ˜“äº§ç”Ÿè€¦åˆï¼Œå› ä¸ºå®ƒä»¬å…±äº«åŒä¸€å¥—åˆ†å±‚ç»“æ„ï¼Œä¿®æ”¹ä¸€ä¸ªæ¨¡å—å¯èƒ½å½±å“å…¶ä»–æ¨¡å—ã€‚</p>
</li>
<li>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š<strong>é€‚åˆä¸­å°å‹é¡¹ç›®</strong>ï¼Œå›¢é˜Ÿè§„æ¨¡ä¸å¤§ã€ä¸šåŠ¡å¤æ‚åº¦è¾ƒä½æ—¶ä½¿ç”¨æ•ˆæœè¾ƒå¥½ã€‚</p>
</li>
</ul>
<p><strong>2.çº¯æŒ‰åŠŸèƒ½åˆ’åˆ†æ¨¡å¼</strong></p>
<ul>
<li>
<p><strong>æ ¸å¿ƒæ€è·¯</strong>ï¼šä»¥ä¸šåŠ¡åŠŸèƒ½ä¸ºå•ä½æ¨ªå‘ç»„ç»‡ä»£ç ï¼Œæ¯ä¸ªåŠŸèƒ½æ¨¡å—ï¼ˆå¦‚â€œç™»å½•â€ã€â€œä¸ªäººä¸­å¿ƒâ€ã€â€œè®¢å•â€ï¼‰å‡ ä¹å½¢æˆä¸€ä¸ªç‹¬ç«‹é—­ç¯ï¼ŒåŒ…å«è‡ªå·±çš„æ•°æ®ã€é¢†åŸŸé€»è¾‘å’Œ UI å±‚ï¼ˆç±»ä¼¼<strong>ç»„ä»¶åŒ–</strong>ï¼‰ã€‚</p>
</li>
<li>
<p><strong>ä¼˜ç‚¹</strong>ï¼šè¿™ç§æ–¹å¼å®ç°äº†æé«˜çš„æ¨¡å—ç‹¬ç«‹æ€§ï¼Œéå¸¸é€‚åˆå¤šå›¢é˜Ÿå¹¶è¡Œå¼€å‘ï¼Œå¹¶æ”¯æŒåŠ¨æ€ä¸‹å‘æˆ–ç‹¬ç«‹å‘å¸ƒç‰¹å®šåŠŸèƒ½ã€‚</p>
</li>
<li>
<p><strong>ç¼ºç‚¹</strong>ï¼šå…¶ä»£ä»·æ˜¯å®¹æ˜“é€ æˆé‡å¤ä»£ç ï¼ˆæ¯”å¦‚å¤šä¸ªæ¨¡å—å„è‡ªå®ç°ç›¸ä¼¼çš„ç½‘ç»œè¯·æ±‚æˆ–å·¥å…·ç±»ï¼‰ï¼Œä¸”å…¨å±€æ•°æ®å±‚éš¾ä»¥ç»Ÿä¸€è®¾è®¡å’Œç»´æŠ¤ã€‚</p>
</li>
<li>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå®ƒä¸»è¦<strong>é€‚ç”¨äºè¶…å¤§å‹åº”ç”¨</strong>ï¼Œå°¤å…¶æ˜¯éœ€è¦å¤šå›¢é˜Ÿåä½œã€æ”¯æŒæ¨¡å—åŒ–åŠ¨æ€äº¤ä»˜çš„åœºæ™¯ã€‚</p>
</li>
</ul>
<p><strong>3.åˆ†å±‚ + åŠŸèƒ½æ··åˆæ¨¡å¼</strong></p>
<ul>
<li>
<p><strong>æ ¸å¿ƒæ€è·¯</strong>ï¼šå°†æ¶æ„åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼šåº•å±‚æ˜¯é«˜åº¦æŠ½è±¡ã€é€šç”¨çš„æ ¸å¿ƒå±‚ï¼ˆåŒ…å«å…±äº«çš„æ•°æ®æºã€å·¥å…·ç±»ã€åŸºç¡€ç»„ä»¶ç­‰ï¼‰ï¼Œä¸Šå±‚åˆ™æ˜¯æŒ‰åŠŸèƒ½åˆ’åˆ†çš„ç‹¬ç«‹ä¸šåŠ¡æ¨¡å—ã€‚</p>
</li>
<li>
<p><strong>ä¼˜ç‚¹</strong>ï¼šæ—¢ä¿è¯äº†é€šç”¨èƒ½åŠ›çš„å¤ç”¨ï¼Œåˆèµ‹äºˆå„ä¸šåŠ¡æ¨¡å—è¶³å¤Ÿçš„è‡ªæ²»æ€§ã€‚å®ƒåœ¨å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§å’Œå›¢é˜Ÿåä½œæ•ˆç‡ä¹‹é—´å–å¾—äº†è‰¯å¥½å¹³è¡¡</p>
</li>
<li>
<p><strong>ç¼ºç‚¹</strong>ï¼šåˆæœŸæ¶æ„æ­å»ºå’Œç†è§£æˆæœ¬ç•¥é«˜ï¼Œéœ€è¦å›¢é˜Ÿæœ‰ä¸€å®šç»éªŒï¼Œ</p>
</li>
<li>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š<strong>ä¸­å¤§å‹ç”Ÿäº§é¡¹ç›®</strong>ä¸»æµé€‰æ‹©</p>
</li>
</ul>
<p><strong>Now in Android é‡‡ç”¨çš„å°±æ˜¯ç¬¬ä¸‰ç§â€œåˆ†å±‚ + åŠŸèƒ½æ··åˆâ€æ¨¡å¼ï¼Œè€Œä¸”åšäº†éå¸¸æœ‰ç‰¹è‰²çš„ç»†åŒ– - Featureæ¨¡å—å†…éƒ¨api / impl åŒå±‚åˆ†ç¦»ã€‚</strong></p>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€NiA æ¨¡å—åŒ–ç»“æ„è§£æ</h2>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-symbol">:app</span>                       <span class="hljs-comment"># åº”ç”¨å…¥å£ï¼ˆè„šæ‰‹æ¶ + å¯¼èˆªï¼‰</span>
â”‚
â”œâ”€ <span class="hljs-symbol">:feature</span>
â”‚   â”œâ”€ <span class="hljs-symbol">:foryou</span>
â”‚   â”‚   â”œâ”€ <span class="hljs-symbol">:api</span>           <span class="hljs-comment"># åªæ”¾å¯¼èˆªkeyå’Œå¯¼èˆªæ‰©å±•å‡½æ•°</span>
â”‚   â”‚   â””â”€ <span class="hljs-symbol">:impl</span>          <span class="hljs-comment"># çœŸæ­£çš„Screenã€ViewModelã€UIé€»è¾‘</span>
â”‚   â”œâ”€ <span class="hljs-symbol">:interests</span>
â”‚   â”œâ”€ <span class="hljs-symbol">:topic</span>
â”‚   â””â”€ ... (å…¶ä»–ä¸šåŠ¡åŠŸèƒ½)
â”‚
â”œâ”€ <span class="hljs-symbol">:core</span>
â”‚   â”œâ”€ <span class="hljs-symbol">:data</span>              <span class="hljs-comment"># ç»Ÿä¸€å¯¹å¤–æ•°æ®ä»“åº“ï¼ˆRepositoryï¼‰</span>
â”‚   â”œâ”€ <span class="hljs-symbol">:network</span>           <span class="hljs-comment"># Retrofit + æ•°æ®æº</span>
â”‚   â”œâ”€ <span class="hljs-symbol">:database</span>          <span class="hljs-comment"># Room</span>
â”‚   â”œâ”€ <span class="hljs-symbol">:datastore</span>         <span class="hljs-comment"># Preferences DataStore</span>
â”‚   â”œâ”€ <span class="hljs-symbol">:model</span>             <span class="hljs-comment"># çº¯Kotlin æ•°æ®ç±»ï¼ˆè·¨æ¨¡å—å…±äº«ï¼‰</span>
â”‚   â”œâ”€ <span class="hljs-symbol">:ui</span>                <span class="hljs-comment"># å¤åˆUIç»„ä»¶ï¼ˆä¾èµ–modelå’Œdataï¼‰</span>
â”‚   â”œâ”€ <span class="hljs-symbol">:designsystem</span>      <span class="hljs-comment"># åŸºç¡€UIç»„ä»¶ + ä¸»é¢˜ + å›¾æ ‡ï¼ˆçº¯Composeï¼‰</span>
â”‚   â”œâ”€ <span class="hljs-symbol">:common</span>            <span class="hljs-comment"># é€šç”¨å·¥å…·ã€Dispatchersã€Resultå°è£…ç­‰</span>
â”‚   â””â”€ <span class="hljs-symbol">:testing</span>           <span class="hljs-comment"># æµ‹è¯•æ¡©ã€TestRunnerç­‰</span>
â”‚   â””â”€ ...
â”‚
â”œâ”€ <span class="hljs-symbol">:sync</span>                  <span class="hljs-comment"># å·¥ä½œç®¡ç†å™¨åŒæ­¥ä»»åŠ¡ï¼ˆåŒæ ·å±äºåº”ç”¨çš„ä¸šåŠ¡é€»è¾‘ï¼‰</span>
â”œâ”€ <span class="hljs-symbol">:benchmark</span>             <span class="hljs-comment"># å®åŸºå‡†æµ‹è¯•</span>
â””â”€ <span class="hljs-symbol">:app-NiA-catalog</span>       <span class="hljs-comment"># é™æ€å±•ç¤ºAppå†…çš„ç»„ä»¶ï¼Œæ˜¯ä¸€ä¸ªç‹¬ç«‹åº”ç”¨</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1325524ed8294234a8f9bc372cdef98f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p6X5qCpbGluaw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770893200&amp;x-signature=cwxbwxjEx0MYO8L6GMvOEdf2Gh0%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">1.App æ¨¡å—ï¼šåº”ç”¨çš„ â€œç²˜åˆå‰‚â€</h3>
<p>App æ¨¡å—æ˜¯æ•´ä¸ªåº”ç”¨çš„å…¥å£ï¼Œå±äº<code>android-application</code>ç±»å‹ï¼Œæ ¸å¿ƒèŒè´£æ˜¯<strong>æ•´åˆæ‰€æœ‰æ¨¡å—ï¼Œæä¾›åº”ç”¨çº§è„šæ‰‹æ¶</strong>ï¼Œä¸æ‰¿æ‹…å…·ä½“ä¸šåŠ¡é€»è¾‘ã€‚</p>
<p><strong>æ ¸å¿ƒå†…å®¹ï¼š</strong></p>
<ul>
<li>åŒ…å«<code>MainActivity</code>ã€<code>NiAApp</code>ç­‰åº”ç”¨çº§å…¥å£ç±»ï¼Œä»¥åŠå…¨å±€å¯¼èˆªé…ç½®ï¼ˆå¦‚<code>NiANavHost</code>å®ç°åº”ç”¨çº§å¯¼èˆªã€<code>TopLevelNavItem</code>é…ç½®åº•éƒ¨å¯¼èˆªæ ï¼‰ï¼›</li>
</ul>
<p><strong>ä¾èµ–è§„åˆ™ï¼š</strong></p>
<ul>
<li>ä¾èµ–æ‰€æœ‰åŠŸèƒ½ï¼ˆFeatureï¼‰æ¨¡å—å’Œæ‰€éœ€çš„æ ¸å¿ƒï¼ˆCoreï¼‰æ¨¡å—ï¼Œæ˜¯ä¾èµ–é“¾çš„ â€œé¡¶ç«¯â€ã€‚</li>
</ul>
<h3 data-id="heading-4">2.åŠŸèƒ½ï¼ˆFeatureï¼‰æ¨¡å—ï¼šä¸šåŠ¡é€»è¾‘çš„è½½ä½“</h3>
<p>Feature æ¨¡å—æ˜¯åº”ç”¨çš„ä¸šåŠ¡æ ¸å¿ƒï¼Œæ¯ä¸ªæ¨¡å—èšç„¦ä¸€ä¸ªå…·ä½“åŠŸèƒ½ï¼ˆå¦‚ â€œä¸ºä½ æ¨èâ€â€œå…´è¶£ç®¡ç†â€â€œä¸»é¢˜è¯¦æƒ…â€ï¼‰ï¼Œéµå¾ª â€œå•ä¸€èŒè´£â€ è®¾è®¡ã€‚</p>
<p>NiA å¯¹ Feature æ¨¡å—åšäº†ç²¾ç»†åŒ–æ‹†åˆ† â€”â€” æ¯ä¸ª Feature æ¨¡å—æ‹†åˆ†ä¸ºä¸¤ä¸ªå­æ¨¡å—ï¼š</p>
<ul>
<li><strong><code>api</code></strong> <strong>å­æ¨¡å—</strong>ï¼šä»…åŒ…å«å¯¼èˆªé”®ï¼ˆå¦‚<code>TopicNavKey</code>ï¼‰å’Œå¯¼èˆªå‡½æ•°ï¼ˆå¦‚<code>Navigator.navigateToTopic</code>ï¼‰ï¼Œç”¨äºå¯¹å¤–æš´éœ²è·³è½¬èƒ½åŠ›ï¼›</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57846ddf6f1044fe8cdf16086f8e3120~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p6X5qCpbGluaw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770893200&amp;x-signature=RetryQ%2B6uaI3lVjJPEiM4ReAX3M%3D" alt="" loading="lazy"/></p>
<ul>
<li><strong><code>impl</code></strong> <strong>å­æ¨¡å—</strong>ï¼šåŒ…å«åŠŸèƒ½çš„æ‰€æœ‰æ ¸å¿ƒé€»è¾‘ï¼ˆUI ç•Œé¢ã€ViewModelã€ä¸šåŠ¡å¤„ç†ç­‰ï¼‰ï¼Œæ˜¯åŠŸèƒ½çš„å®é™…å®ç°å±‚ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2788c186da124001896e2ed3e0332adc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p6X5qCpbGluaw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770893200&amp;x-signature=ljUO9ZsWn7NNWeUX7EIMQrfGhG8%3D" alt="" loading="lazy"/></p>
<p><strong>ä¾èµ–è§„åˆ™ï¼š</strong></p>
<ul>
<li>
<p><strong><code>api</code></strong> <strong>å­æ¨¡å—</strong>ï¼šä¸ä¾èµ–å…¶ä»– Feature çš„<code>api</code>/<code>impl</code>å­æ¨¡å—ï¼Œä»…ä¾èµ– Core æ¨¡å—ï¼›</p>
</li>
<li>
<p><strong><code>impl</code></strong> <strong>å­æ¨¡å—</strong>ï¼šä»…å¯ä¾èµ–å…¶ä»– Feature çš„<code>api</code>å­æ¨¡å—ï¼ˆç”¨äºè·¨åŠŸèƒ½è·³è½¬ï¼‰ï¼Œä¸”ä»…ä¾èµ–æ‰€éœ€çš„ Core æ¨¡å—ï¼›</p>
</li>
<li>
<p>æ ¸å¿ƒåŸåˆ™ï¼šé¿å… Feature æ¨¡å—é—´çš„ç›´æ¥è€¦åˆï¼Œé€šè¿‡<code>api</code>å±‚å®ç° â€œæœ€å°åŒ–ä¾èµ–â€ã€‚</p>
</li>
</ul>
<h3 data-id="heading-5">3.æ ¸å¿ƒï¼ˆCoreï¼‰æ¨¡å—ï¼šé€šç”¨èƒ½åŠ›çš„å°è£…</h3>
<p>æ ¸å¿ƒæ¨¡å—æ˜¯é€šç”¨çš„åº“æ¨¡å—ï¼ŒåŒ…å«è¾…åŠ©ä»£ç å’Œéœ€è¦åœ¨åº”ç”¨å…¶ä»–æ¨¡å—é—´å…±äº«çš„ç‰¹å®šä¾èµ–é¡¹ã€‚è¿™äº›æ¨¡å—å¯ä»¥ä¾èµ–äºå…¶ä»–æ ¸å¿ƒæ¨¡å—ï¼Œä½†ä¸åº”ä¾èµ–äºåŠŸèƒ½æ¨¡å—æˆ–appæ¨¡å—ã€‚</p>



















































































<table><thead><tr><th>æ¨¡å—è·¯å¾„</th><th>ä¸»è¦åŠŸèƒ½ / èŒè´£</th><th>å…¸å‹ç±» / æ–‡ä»¶ç¤ºä¾‹</th><th>å¤‡æ³¨è¯´æ˜</th></tr></thead><tbody><tr><td>:core:model</td><td>å­˜æ”¾åº”ç”¨ä¸­é€šç”¨çš„çº¯Kotlinæ•°æ®æ¨¡å‹ç±»ï¼ˆæ— Androidä¾èµ–ï¼‰</td><td>NewsResource, Topic, Episode, Author</td><td>çº¯jvm moduleï¼Œæœ€åº•å±‚æ¨¡å‹</td></tr><tr><td>:core:database</td><td>ä½¿ç”¨Roomå®ç°æœ¬åœ°æ•°æ®åº“ï¼ŒåŒ…æ‹¬æ•°æ®åº“å®šä¹‰ã€Entityã€Daoå’Œè¿ç§»</td><td>NiADatabase, NewsResourceDao, DatabaseMigrations</td><td>Roomæ•°æ®åº“æ ¸å¿ƒ</td></tr><tr><td>:core:datastore</td><td>ä½¿ç”¨Preferences DataStoreå­˜å‚¨ç”¨æˆ·åå¥½è®¾ç½®ï¼ˆè½»é‡çº§KVå­˜å‚¨ï¼‰</td><td>NiAPreferences, UserPreferencesSerializer</td><td>å¸¸ç”¨äºç”¨æˆ·åå¥½ã€é¦–æ¬¡å¯åŠ¨æ ‡å¿—ç­‰</td></tr><tr><td>:core:datastore-proto</td><td>DataStoreçš„protobufå®šä¹‰æ–‡ä»¶ï¼ˆç‹¬ç«‹å‡ºæ¥æ–¹ä¾¿å¤šå¹³å°å¤ç”¨ï¼‰</td><td>.proto æ–‡ä»¶ï¼ˆå¦‚user_preferences.protoï¼‰</td><td>ä¸€èˆ¬ä¸ç›´æ¥ä½¿ç”¨ï¼Œä»…ä¾›datastoreä¾èµ–</td></tr><tr><td>:core:network</td><td>ç½‘ç»œå±‚å®ç°ï¼ŒåŒ…æ‹¬Retrofitæ¥å£å®šä¹‰ã€æ•°æ®æºã€æ‹¦æˆªå™¨ç­‰</td><td>RetrofitNiANetworkApi, NiANetworkDataSource</td><td>è¿œç¨‹æ•°æ®æºæ ¸å¿ƒ</td></tr><tr><td>:core:data</td><td>æ•°æ®å±‚ç»Ÿä¸€å¯¹å¤–æ¥å£ï¼ˆRepositoryæ¨¡å¼ï¼‰ï¼Œèšåˆæœ¬åœ°+è¿œç¨‹æ•°æ®æºï¼Œæä¾›ä¸šåŠ¡æ‰€éœ€æ•°æ®</td><td>TopicsRepository, NewsRepository, UserDataRepository</td><td>æœ€å¸¸ç”¨çš„æ•°æ®ä»“åº“å…¥å£</td></tr><tr><td>:core:data-test</td><td>æ•°æ®å±‚ç›¸å…³çš„æµ‹è¯•æ¡©ï¼ˆfakeå®ç°ã€æµ‹è¯•åŒé‡å®ç°ï¼‰</td><td>FakeNewsRepository, TestNiANetworkDataSource</td><td>ä¸“ä¾›å•å…ƒæµ‹è¯•/é›†æˆæµ‹è¯•ä½¿ç”¨</td></tr><tr><td>:core:ui</td><td>ä¸šåŠ¡ç›¸å…³çš„å¤åˆUIç»„ä»¶ï¼ˆä¾èµ–modelå’Œdataå±‚ï¼Œèƒ½å±•ç¤ºçœŸå®ä¸šåŠ¡æ•°æ®ï¼‰</td><td>NewsResourceCard, NewsFeed, TopicGridItem</td><td>åŒºåˆ«äºdesignsystemï¼Œæ›´åä¸šåŠ¡</td></tr><tr><td>:core:designsystem</td><td>åŸºç¡€è®¾è®¡ç³»ç»Ÿï¼šä¸»é¢˜ã€é¢œè‰²ã€æ’ç‰ˆã€å›¾æ ‡ã€åŸºç¡€Composeç»„ä»¶</td><td>NiATheme, NiAButton, NiAIcons, NiATopAppBar</td><td>ç±»ä¼¼ç»„ä»¶åº“ï¼Œå¯å•ç‹¬é¢„è§ˆ</td></tr><tr><td>:core:common</td><td>é€šç”¨å·¥å…·ç±»ã€æ‰©å±•å‡½æ•°ã€è·¨æ¨¡å—å…±äº«çš„å°å‹å·¥å…·</td><td>NiADispatchers, Result, Async, DispatcherProvider</td><td>æ”¾é‚£äº›åˆ°å¤„éƒ½è¦ç”¨çš„å°å·¥å…·</td></tr><tr><td>:core:analytics</td><td>åŸ‹ç‚¹/åˆ†æç›¸å…³æ¥å£ä¸å®ç°ï¼ˆç›®å‰ä¸»è¦å¯¹æ¥Firebase Analyticsï¼‰</td><td>AnalyticsHelper, StubAnalyticsHelper</td><td>å¯åˆ‡æ¢çœŸå®/ç©ºå®ç°ï¼Œæ–¹ä¾¿æµ‹è¯•</td></tr><tr><td>:core:testing</td><td>é€šç”¨æµ‹è¯•å·¥å…·ã€è§„åˆ™ã€runnerã€Hiltæµ‹è¯•æ¨¡å—ç­‰</td><td>NiATestRunner, TestDispatcherRule, HiltTest</td><td>å‡ ä¹æ‰€æœ‰æµ‹è¯•æ¨¡å—éƒ½ä¼šä¾èµ–å®ƒ</td></tr></tbody></table>
<h3 data-id="heading-6">4.æ•°æ®åŒæ­¥ï¼ˆSyncï¼‰æ¨¡å—</h3>
<p><strong><code>sync</code></strong>: è´Ÿè´£å¤„ç†åå°åŒæ­¥é€»è¾‘ã€‚å®ƒåˆ©ç”¨ WorkManager å®šæ—¶æˆ–æ ¹æ®è§¦å‘æ¡ä»¶ä»ç½‘ç»œæ›´æ–°æ•°æ®ï¼Œå¹¶å°†å…¶æŒä¹…åŒ–åˆ°æœ¬åœ°æ•°æ®åº“ä¸­ã€‚</p>
<blockquote>
<p>NiAé‡‡ç”¨æœ¬åœ°æ•°æ®ä¼˜å…ˆçš„æ¶æ„è®¾è®¡æ–¹å¼ï¼Œæœ‰å…³æ¶æ„è®¾è®¡çš„åˆ†æä¸‹ä¸€ç« ä¼šè¯¦ç»†ä»‹ç»ã€‚</p>
</blockquote>
<h3 data-id="heading-7">5.å·¥ç¨‹æ²»ç†ä¸æ„å»ºé€»è¾‘ç±»</h3>
<p>è¿™ç±»æ¨¡å—ä¸ç›´æ¥åŒ…å«ä¸šåŠ¡ä»£ç ï¼Œè€Œæ˜¯ä¸ºäº†ç®¡ç†æ—¥ç›Šå¤æ‚çš„ Gradle æ„å»ºé…ç½®ã€‚</p>
<ul>
<li>
<p><strong><code>build-logic</code></strong>: è¿™æ˜¯ NiA æœ€æ ¸å¿ƒçš„æ„å»ºç®¡ç†æ¨¡å—ã€‚éšç€æ¨¡å—æ•°é‡å¢åŠ ï¼ŒNiA æå–äº†é€šç”¨çš„é…ç½®æ’ä»¶ï¼ˆConvention Pluginsï¼‰ï¼Œç”¨äºç»Ÿä¸€ç®¡ç†å„æ¨¡å—çš„ç¼–è¯‘ SDK ç‰ˆæœ¬ã€Compose é…ç½®ã€Lint è§„åˆ™å’Œ Hilt ä¾èµ–ã€‚è¿™æ ·å¯ä»¥é¿å…åœ¨å‡ åä¸ªæ¨¡å—çš„ <code>build.gradle</code> ä¸­é‡å¤å†™ç›¸åŒçš„é…ç½®ã€‚</p>
</li>
<li>
<p><strong><code>spotless</code></strong>: è¿™æ˜¯ä¸€ä¸ªä»£ç æ ¼å¼åŒ–å·¥å…·æ¨¡å—ã€‚å®ƒé€šè¿‡é…ç½®ç‰¹å®šçš„è§„åˆ™ï¼ˆå¦‚ Kotlin ç¼–ç è§„èŒƒã€License å¤´éƒ¨ä¿¡æ¯ï¼‰ï¼Œç¡®ä¿æ‰€æœ‰å¼€å‘è€…æäº¤çš„ä»£ç é£æ ¼é«˜åº¦ç»Ÿä¸€ã€‚åœ¨ NiA ä¸­ï¼Œå®ƒé€šå¸¸ç»“åˆ Git Hooks æˆ– CI æµç¨‹ä½¿ç”¨ã€‚</p>
</li>
<li>
<p><strong><code>lint</code></strong>: åŒ…å«è‡ªå®šä¹‰çš„ Lint è§„åˆ™ã€‚é™¤äº† Android é»˜è®¤çš„æ£€æŸ¥å¤–ï¼ŒNiA å¼€å‘å›¢é˜Ÿç¼–å†™äº†ç‰¹å®šçš„é™æ€ä»£ç æ£€æŸ¥è§„åˆ™ï¼Œä»¥ç¡®ä¿é¡¹ç›®éµå¾ªç‰¹å®šçš„æ¶æ„è§„èŒƒï¼ˆä¾‹å¦‚ï¼šç¦æ­¢åœ¨æŸäº›å±‚çº§ç›´æ¥å¼•ç”¨ç‰¹å®šåº“ï¼‰ã€‚</p>
</li>
</ul>
<h3 data-id="heading-8">6.æµ‹è¯•ä¸æ€§èƒ½åˆ†æç±»</h3>
<p>è¿™ç±»æ¨¡å—ç”¨äºä¿éšœåº”ç”¨çš„è´¨é‡å’Œè¿è¡Œæ•ˆç‡ã€‚</p>
<ul>
<li>
<p><strong><code>benchmark</code></strong>: åŒ…å« Macrobenchmark æµ‹è¯•ä»£ç ã€‚å®ƒä¸“é—¨ç”¨äºæµ‹é‡åº”ç”¨çš„å¯åŠ¨æ€§èƒ½å’Œæ»šåŠ¨å¸§ç‡ï¼ˆJankï¼‰ã€‚é€šè¿‡è¿™ä¸ªæ¨¡å—ï¼Œå¼€å‘è€…å¯ä»¥ç”Ÿæˆ Baseline Profiles ä»¥ä¼˜åŒ–åº”ç”¨çš„é¦–æ¬¡è¿è¡Œé€Ÿåº¦ã€‚</p>
</li>
<li>
<p><strong><code>ui-test-hilt-manifest</code></strong>: è¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è¾…åŠ©æ¨¡å—ã€‚ç”±äº Hilt åœ¨è¿›è¡Œé›†æˆæµ‹è¯•æ—¶éœ€è¦ä¸€ä¸ªç©ºçš„ <code>ComponentActivity</code> ä½œä¸ºå®¹å™¨ï¼Œè¯¥æ¨¡å—ä¸“é—¨æä¾›æ‰€éœ€çš„ Android Manifest å’Œ Activity å£°æ˜ï¼Œç¡®ä¿æµ‹è¯•ä»£ç èƒ½æ­£å¸¸æ³¨å…¥ä¾èµ–ï¼ŒåŒæ—¶ä¸æ±¡æŸ“ç”Ÿäº§ä»£ç ã€‚</p>
</li>
</ul>
<h3 data-id="heading-9">7.åŸºç¡€è®¾æ–½ä¸å·¥å…·ç±»</h3>
<ul>
<li><strong><code>tools</code></strong>: å­˜æ”¾å¼€å‘è¾…åŠ©è„šæœ¬ã€‚</li>
<li><strong><code>kokoro</code></strong>: è¿™æ˜¯ Google å†…éƒ¨ä½¿ç”¨çš„æŒç»­é›†æˆï¼ˆCIï¼‰é…ç½®æ–‡ä»¶è·¯å¾„ã€‚å®ƒåŒ…å«ç”¨äºåœ¨ Google åŸºç¡€è®¾æ–½ä¸Šè¿è¡Œæ„å»ºã€æµ‹è¯•å’Œå‘å¸ƒæµç¨‹çš„è„šæœ¬ï¼ˆç±»ä¼¼äºå…¬å…±é¢†åŸŸçš„ GitHub Actions é…ç½®ï¼‰ã€‚</li>
<li><strong><code>app-NiA-catalog</code></strong>: è¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„â€œè®¾è®¡ç³»ç»Ÿç›®å½•â€APPã€‚å®ƒä¸å…·å¤‡æ–°é—»æµè§ˆåŠŸèƒ½ï¼Œè€Œæ˜¯ä¸“é—¨ç”¨äºå±•ç¤º <code>core:designsystem</code> ä¸­å®šä¹‰çš„æ‰€æœ‰ UI ç»„ä»¶ï¼ˆå¦‚æŒ‰é’®ã€å›¾æ ‡ã€é¢œè‰²ï¼‰ã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡è¿è¡Œè¿™ä¸ª App å¿«é€Ÿé¢„è§ˆå’Œè°ƒè¯• UI ç»„ä»¶ï¼Œè€Œæ— éœ€å¯åŠ¨æ•´ä¸ªä¸»åº”ç”¨ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-10">å››ã€å€¼å¾—å€Ÿé‰´çš„å‡ ä¸ªå…³é”®å†³ç­–ç‚¹</h2>
<p><strong>1.ä»€ä¹ˆæ—¶å€™æŠŠåŠŸèƒ½æ‹†æˆ</strong> <strong><code>api</code></strong> <strong>/</strong> <strong><code>impl</code></strong> <strong>åŒæ¨¡å—ï¼Ÿ</strong></p>
<p>å½“è¿™ä¸ªåŠŸèƒ½<strong>ä¼šè¢«å¤šä¸ªå…¶ä»–é¡µé¢è·³è½¬</strong>æ—¶ï¼ˆä¾‹å¦‚ topicã€bookmarkã€search éƒ½æ˜¯å¸¸è§è¢«è·³è½¬ç›®æ ‡ï¼‰</p>
<p><strong>2.core æ¨¡å—è¦æ‹†å¤šç»†ï¼Ÿ</strong></p>
<p>NiAç»™å‡ºäº†æ¯”è¾ƒåŠ¡å®çš„å‚è€ƒï¼š</p>
<ul>
<li>
<p>æ•°æ®å±‚è¾ƒå°æ—¶ï¼Œå¯ä»¥åªä¿ç•™ <code>:core:data</code></p>
</li>
<li>
<p>æ•°æ®æº/ä»“åº“å˜å¤šæ—¶ï¼Œå†æ‹† <code>:network</code>ã€<code>:database</code>ã€<code>:datastore</code></p>
</li>
<li>
<p>UIç»„ä»¶è¾ƒå¤šæ—¶ï¼Œæ‹† <code>:designsystem</code>ï¼ˆçº¯å…¬å…±UIç»„ä»¶ï¼‰ å’Œ <code>:ui</code>ï¼ˆä¸šåŠ¡UIç»„ä»¶ï¼‰</p>
</li>
</ul>
<p><strong>3.è¦ä¸è¦è¿½æ±‚æè‡´æ¨¡å—åŒ–ï¼Ÿ</strong></p>
<p>æ ¹æ®NiAå®˜æ–¹çš„è¯´æ³•ï¼š â€œ<strong>æˆ‘ä»¬åœ¨è¿‡åº¦æ¨¡å—åŒ–ä¸€ä¸ªå°åº”ç”¨ å’Œ å±•ç¤ºé€‚ç”¨äºç”Ÿäº§çº§å¤§å‹ä»£ç åº“çš„æ¨¡å¼ ä¹‹é—´å¯»æ‰¾å¹³è¡¡ã€‚</strong> â€æ‰€ä»¥<strong>é€‚åº¦æ¨¡å—åŒ–</strong>æ‰æ˜¯ç‹é“â€”â€”<strong>ç²’åº¦å¤ªç»†ä¼šæ˜¾è‘—å¢åŠ æ„å»ºé…ç½®å’Œç»´æŠ¤æˆæœ¬</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-11">äº”ã€æ€»ç»“ä¸å»ºè®®</h2>
<p>Now in Android çš„æ¨¡å—åŒ–è®¾è®¡æ˜¯ç›®å‰ï¼ˆ2026å¹´ï¼‰Androidç¤¾åŒºé‡Œ<strong>æœ€å€¼å¾—å‚è€ƒçš„ç”Ÿäº§çº§å®è·µ</strong>ä¹‹ä¸€ã€‚ç›¸æ¯”å…¶ä»– Android ç¤ºä¾‹ï¼ˆå¦‚ Todoist æˆ– Sunflowerï¼‰ï¼ŒNiA æ›´æ³¨é‡ Compose UI å’Œæ¨¡å—åŒ–æ¶æ„çš„æ·±åº¦é›†æˆã€‚</p>
<p>NiAé‡‡ç”¨<strong>åˆ†å±‚ + åŠŸèƒ½æ··åˆ</strong>æ¨¡å¼ï¼Œå¹¶é€šè¿‡<strong>åŠŸèƒ½æ¨¡å— api/impl åˆ†ç¦»</strong>å·§å¦™åœ°è§£å†³äº†åŠŸèƒ½é—´è·³è½¬è€¦åˆé—®é¢˜ï¼ŒåŒæ—¶ä¿æŒäº†æ ¸å¿ƒä»£ç çš„é«˜åº¦å¯é‡ç”¨æ€§ã€‚</p>
<p>å¦‚æœä½ æ­£åœ¨/å‡†å¤‡åšä¸€ä¸ª<strong>ä¸­å¤§å‹é¡¹ç›®</strong>ï¼ˆé¢„è®¡&gt;10ä¸ªä¸»è¦é¡µé¢ã€&gt;5äººå›¢é˜Ÿåä½œã€ç”Ÿå‘½å‘¨æœŸ&gt;2å¹´ï¼‰ï¼Œå¼ºçƒˆå»ºè®®ä½ ï¼š</p>
<p>1.å…ˆç”»å‡º<strong>æ¨¡å—ä¾èµ–å›¾</strong>ï¼ˆMermaid/PlantUML/æ‰‹ç»˜éƒ½è¡Œï¼‰</p>
<p>2.å†³å®š<strong>æ ¸å¿ƒæ¨¡å—</strong>çš„æ‹†åˆ†ç²’åº¦</p>
<p>3.å¯¹äº<strong>é«˜é¢‘è¢«è·³è½¬</strong>çš„åŠŸèƒ½æ¨¡å—ï¼Œè€ƒè™‘é‡‡ç”¨ <strong>api / impl</strong> åˆ†ç¦»</p>
<p>4.æ‰€æœ‰æ¨¡å—éƒ½å†™<strong>README + ä¾èµ–å›¾</strong>ï¼ˆNiAä¸­çš„ä¾èµ–å…³ç³»å›¾ç”±å·¥ç¨‹è„šæœ¬è‡ªåŠ¨ç”Ÿæˆï¼Œåç»­å°†è®²è§£å¦‚ä½•å®ç°ï¼‰</p>
<p>ä¸‹ä¸€ç¯‡æ–‡ç« æˆ‘ä»¬å°†æ·±å…¥å‰–æ NiA çš„<strong>æ¶æ„è®¾è®¡</strong>ï¼Œæ•¬è¯·æœŸå¾…ï½</p>
<hr/>
<p><strong>å‚è€ƒèµ„æ–™</strong>ï¼š</p>
<ul>
<li>Android å®˜æ–¹æ¨¡å—åŒ–æŒ‡å—ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.google.cn%2Ftopic%2Fmodularization" target="_blank" title="https://developer.android.google.cn/topic/modularization" ref="nofollow noopener noreferrer">developer.android.google.cn/topic/modulâ€¦</a></li>
<li>Android å®˜æ–¹æ¨¡å—åŒ–æ¨¡å¼ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.google.cn%2Ftopic%2Fmodularization%2Fpatterns" target="_blank" title="https://developer.android.google.cn/topic/modularization/patterns" ref="nofollow noopener noreferrer">developer.android.google.cn/topic/modulâ€¦</a></li>
<li>Now in Android GitHub ä¸»ä»“åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fandroid%2Fnowinandroid" target="_blank" title="https://github.com/android/nowinandroid" ref="nofollow noopener noreferrer">github.com/android/nowâ€¦</a></li>
</ul>
<blockquote>
<p>æœ¬æ–‡å†™ä½œæ—¶ä½¿ç”¨çš„è¾…åŠ©AIæ¨¡å‹ï¼šGemini Pro + Qwen3 Max</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LiveData åˆ° Flow çš„è¿ç§»ï¼šæˆ‘è¸©è¿‡çš„ 5 ä¸ªå‘]]></title>    <link>https://juejin.cn/post/7603183929251889204</link>    <guid>https://juejin.cn/post/7603183929251889204</guid>    <pubDate>2026-02-05T12:58:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603183929251889204" data-draft-id="7603195960254595072" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LiveData åˆ° Flow çš„è¿ç§»ï¼šæˆ‘è¸©è¿‡çš„ 5 ä¸ªå‘"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-02-05T12:58:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Fushize"/> <meta itemprop="url" content="https://juejin.cn/user/2367696439872411"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LiveData åˆ° Flow çš„è¿ç§»ï¼šæˆ‘è¸©è¿‡çš„ 5 ä¸ªå‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2367696439872411/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Fushize
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T12:58:06.000Z" title="Thu Feb 05 2026 12:58:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<p>åœ¨ Android é¡¹ç›®ä¸­ä» <strong>LiveData è¿ç§»åˆ° Kotlin Flow</strong>ï¼Œçœ‹èµ·æ¥åƒæ˜¯ä¸€æ¬¡â€œé¡ºç†æˆç« çš„æŠ€æœ¯å‡çº§â€ï¼Œä½†çœŸæ­£è½åœ°åï¼Œæˆ‘æ‰æ„è¯†åˆ°ï¼š<br/>
<strong>Flow ä¸æ˜¯ LiveData çš„ 1:1 æ›¿ä»£ï¼Œè€Œæ˜¯ä¸€æ•´å¥—å“åº”å¼æ¨¡å‹çš„å˜åŒ–</strong>ã€‚</p>
<p>ä¸‹é¢è®°å½•æˆ‘åœ¨çœŸå®é¡¹ç›®è¿ç§»è¿‡ç¨‹ä¸­è¸©è¿‡çš„ <strong>5 ä¸ªå…¸å‹å‘</strong>ï¼Œä»¥åŠæœ€ç»ˆçš„è§£å†³æ–¹å¼ã€‚</p>
<hr/>
<h2 data-id="heading-0">å‘ä¸€ï¼šæŠŠ Flow å½“æˆâ€œæ›´é«˜çº§çš„ LiveDataâ€</h2>
<h3 data-id="heading-1">å½“æ—¶çš„é”™è¯¯è®¤çŸ¥</h3>
<p>ä¸€å¼€å§‹æˆ‘å‡ ä¹æ˜¯â€œæœºæ¢°è¿ç§»â€ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">val userLiveData: LiveData<span class="hljs-operator">&lt;</span><span class="hljs-keyword">User</span><span class="hljs-operator">&gt;</span> â†“ val userFlow: Flow<span class="hljs-operator">&lt;</span><span class="hljs-keyword">User</span><span class="hljs-operator">&gt;</span>

ViewModel æš´éœ² Flowï¼ŒUI <span class="hljs-keyword">collect</span>ï¼Œçœ‹èµ·æ¥ä¸€åˆ‡æ­£å¸¸ã€‚
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-2">å®é™…é—®é¢˜</h3>
<ul>
<li>LiveData æ˜¯ <strong>ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ + çƒ­æ•°æ®</strong></li>
<li>Flow é»˜è®¤æ˜¯ <strong>å†·æµ</strong></li>
</ul>
<p>ç»“æœæ˜¯ï¼š</p>
<ul>
<li>æ¯æ¬¡ <code>collect</code> éƒ½é‡æ–°æ‰§è¡Œä¸€éä¸Šæ¸¸é€»è¾‘</li>
<li>ç½‘ç»œè¯·æ±‚ã€æ•°æ®åº“æŸ¥è¯¢è¢«é‡å¤è§¦å‘</li>
</ul>
<h3 data-id="heading-3">æœ¬è´¨åŸå› </h3>
<p>LiveDataï¼š<strong>æ•°æ®æºä¸€ç›´å­˜åœ¨ï¼ŒUI åªæ˜¯è®¢é˜…</strong><br/>
Flowï¼š<strong>UI è®¢é˜… = è§¦å‘æ•°æ®ç”Ÿäº§</strong></p>
<h3 data-id="heading-4">æˆ‘çš„ä¿®æ­£æ–¹å¼</h3>
<p>å¯¹äºâ€œçŠ¶æ€å‹æ•°æ®â€ï¼Œ<strong>ä¸ç›´æ¥æš´éœ²æ™®é€š Flow</strong>ï¼Œè€Œæ˜¯ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> userState: StateFlow&lt;User&gt;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å¹¶åœ¨ ViewModel ä¸­ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">stateIn( <span class="hljs-attr">scope</span> = viewModelScope, started = SharingStarted.WhileSubscribed(<span class="hljs-number">5000</span>), initialValue = User.Empty )
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>ç»“è®º</strong>ï¼š</p>
<blockquote>
<p>Flow â‰  LiveDataï¼Œ<br/>
LiveData æ›´æ¥è¿‘çš„æ˜¯ <code>StateFlow</code> / <code>SharedFlow</code></p>
</blockquote>
<hr/>
<h2 data-id="heading-5">å‘äºŒï¼šcollect å†™åœ¨é”™è¯¯çš„ç”Ÿå‘½å‘¨æœŸé‡Œ</h2>
<h3 data-id="heading-6">å¸¸è§å†™æ³•ï¼ˆæˆ‘ä¸€å¼€å§‹ä¹Ÿè¿™ä¹ˆå¹²ï¼‰</h3>
<pre><code class="hljs">lifecycleScope.launch { viewModel.flow.collect { ... } }
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-7">é—®é¢˜è¡¨ç°</h3>
<ul>
<li>é¡µé¢é€€åˆ°åå°ï¼ŒFlow ä»åœ¨æ”¶é›†</li>
<li>é‡è¿›é¡µé¢ï¼Œå‡ºç°<strong>é‡å¤ collect</strong></li>
<li>æŸäº›åœºæ™¯ä¸‹ UI è¢«æ›´æ–°å¤šæ¬¡</li>
</ul>
<h3 data-id="heading-8">æ ¹å› </h3>
<p>Flow <strong>ä¸è‡ªåŠ¨æ„ŸçŸ¥ç”Ÿå‘½å‘¨æœŸ</strong>ï¼Œä¸åƒ LiveData é‚£æ ·â€œæ´»ç€å°±æ”¶ï¼Œæ­»äº†å°±åœâ€ã€‚</p>
<h3 data-id="heading-9">æ­£ç¡®å§¿åŠ¿</h3>
<pre><code class="hljs language-javascript" lang="javascript">lifecycleScope.<span class="hljs-property">launch</span> { <span class="hljs-title function_">repeatOnLifecycle</span>(<span class="hljs-params">Lifecycle.State.STARTED</span>) { viewModel.<span class="hljs-property">flow</span>.<span class="hljs-property">collect</span> { ... } } }
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>æˆ–è€…æ›´å¸¸è§çš„ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">viewModel<span class="hljs-selector-class">.flow</span> <span class="hljs-selector-class">.flowWithLifecycle</span>(lifecycle, Lifecycle.State.STARTED) <span class="hljs-selector-class">.onEach</span> { ... } <span class="hljs-selector-class">.launchIn</span>(lifecycleScope)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>Â <strong>ç»“è®º</strong>ï¼š</p>
<blockquote>
<p>ç”¨ Flowï¼Œä¸æ‰‹åŠ¨å¤„ç†ç”Ÿå‘½å‘¨æœŸ = è¿Ÿæ—©è¸©å‘</p>
</blockquote>
<hr/>
<h2 data-id="heading-10">å‘ä¸‰ï¼šäº‹ä»¶è¢«é‡å¤æ¶ˆè´¹ï¼ˆToast / è·³è½¬ / Dialogï¼‰</h2>
<h3 data-id="heading-11">LiveData æ—¶ä»£</h3>
<p>æˆ‘ç”¨çš„æ˜¯ï¼š</p>
<ul>
<li>SingleLiveEvent</li>
<li>Event åŒ…è£…ç±»</li>
</ul>
<h3 data-id="heading-12">è¿ç§»åˆ° Flow åçš„å¤©çœŸæƒ³æ³•</h3>
<pre><code class="hljs language-ini" lang="ini">val <span class="hljs-attr">eventFlow</span> = MutableStateFlow&lt;Event?&gt;(null)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ç»“æœï¼š</p>
<ul>
<li>æ—‹è½¬å±å¹•åï¼Œäº‹ä»¶åˆæ‰§è¡Œäº†ä¸€æ¬¡</li>
<li>é¡µé¢é‡è¿›ï¼ŒToast åˆå¼¹äº†</li>
</ul>
<h3 data-id="heading-13">æ ¹å› </h3>
<p><code>StateFlow</code> ä¼š <strong>é‡æ”¾æœ€æ–°å€¼</strong>ï¼Œ<br/>
è€Œ UI äº‹ä»¶æœ¬è´¨æ˜¯ï¼š<strong>åªæ¶ˆè´¹ä¸€æ¬¡</strong>ã€‚</p>
<h3 data-id="heading-14">æ­£ç¡®è§£æ³•</h3>
<p>ç”¨ <code>SharedFlow</code>ï¼Œæ˜ç¡®è¯­ä¹‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">
val <span class="hljs-attr">eventFlow</span> = MutableSharedFlow&lt;UiEvent&gt;( replay = <span class="hljs-number">0</span>, extraBufferCapacity = <span class="hljs-number">1</span> )
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å‘é€äº‹ä»¶ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">eventFlow<span class="hljs-selector-class">.tryEmit</span>(UiEvent.ShowToast)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>ç»“è®º</strong>ï¼š</p>
<blockquote>
<p>çŠ¶æ€ â†’ StateFlow<br/>
äº‹ä»¶ â†’ SharedFlow<br/>
ä¸è¦æ··ç”¨</p>
</blockquote>
<hr/>
<h2 data-id="heading-15">å‘å››ï¼šcombine åçš„â€œæ— æ„ä¹‰ UI åˆ·æ–°â€</h2>
<h3 data-id="heading-16">åœºæ™¯</h3>
<p>å¤šä¸ªæ•°æ®æºç»„åˆ UIï¼š</p>
<p><code>combine(flowA, flowB) { a, b -&gt; UiState(a, b) }</code></p>
<h3 data-id="heading-17">é—®é¢˜</h3>
<ul>
<li>flowA é¢‘ç¹å˜åŒ–</li>
<li>flowB å®é™…æ²¡å˜</li>
<li>UI å´æ¯æ¬¡éƒ½åˆ·æ–°</li>
</ul>
<h3 data-id="heading-18">åŸå› </h3>
<p>Flow ä¸ä¼šå¸®ä½ åˆ¤æ–­ï¼š</p>
<blockquote>
<p>â€œæ–°å€¼å’Œæ—§å€¼æ˜¯å¦ç­‰ä»·â€</p>
</blockquote>
<h3 data-id="heading-19">è§£å†³æ–¹å¼</h3>
<p>åœ¨åˆé€‚çš„åœ°æ–¹åŠ ï¼š</p>
<p><code>.distinctUntilChanged()</code></p>
<p>æˆ–è€…å¯¹ç»„åˆåçš„ UiState åš equals æ§åˆ¶ã€‚</p>
<p><strong>ç»“è®º</strong>ï¼š</p>
<blockquote>
<p>Flow å¾ˆâ€œè¯šå®â€ï¼Œ<br/>
ä½ ä¸æ‹¦ï¼Œå®ƒå°±ä¸€ç›´å‘</p>
</blockquote>
<hr/>
<h2 data-id="heading-20">å‘äº”ï¼šåœ¨ Flow é‡Œç›´æ¥å†™è€—æ—¶é€»è¾‘ï¼Œçº¿ç¨‹ç‚¸äº†</h2>
<h3 data-id="heading-21">LiveData æ—¶ä»£çš„é”™è§‰</h3>
<p>ä»¥å‰ <code>postValue</code> å¾ˆå°‘å…³å¿ƒçº¿ç¨‹ã€‚</p>
<h3 data-id="heading-22">Flow é‡Œæˆ‘ä¸€å¼€å§‹çš„å†™æ³•</h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-attribute">flow</span> { <span class="hljs-built_in">emit</span>(repository.loadBigData()) }
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ç»“æœï¼š</p>
<ul>
<li>collect åœ¨ Main</li>
<li>ä¸Šæ¸¸ä¹Ÿåœ¨ Main</li>
<li>UI å¡é¡¿ï¼Œç”šè‡³ ANR</li>
</ul>
<h3 data-id="heading-23">æ­£ç¡®ç†è§£</h3>
<p>Flow çš„çº¿ç¨‹ â‰  collect çš„çº¿ç¨‹<br/>
<strong>ä¸Šæ¸¸æ‰§è¡Œåœ¨å“ªï¼Œå…¨çœ‹ä½ æœ‰æ²¡æœ‰åˆ‡</strong></p>
<h3 data-id="heading-24">ä¿®æ­£</h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-attribute">flow</span> { <span class="hljs-built_in">emit</span>(repository.loadBigData()) }<span class="hljs-selector-class">.flowOn</span>(Dispatchers.IO)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>Â <strong>ç»“è®º</strong>ï¼š</p>
<blockquote>
<p>Flow é»˜è®¤ä¸å¸®ä½ åˆ‡çº¿ç¨‹<br/>
æ¯ä¸ªè€—æ—¶ç‚¹ï¼Œéƒ½è¦æ˜¾å¼æ€è€ƒè°ƒåº¦å™¨</p>
</blockquote>
<hr/>
<h2 data-id="heading-25">æœ€åçš„æ•´ä½“è®¤çŸ¥å˜åŒ–</h2>
<p>è¿ç§»å®Œæˆåï¼Œæˆ‘å¯¹ LiveData å’Œ Flow çš„ç†è§£æ˜¯ï¼š</p>
<ul>
<li>LiveDataï¼š<strong>ç®€å•ã€ä¿å®ˆã€UI å‹å¥½</strong></li>
<li>Flowï¼š<strong>å¼ºå¤§ã€çµæ´»ï¼Œä½†éœ€è¦ä½ æ‰¿æ‹…è®¾è®¡æˆæœ¬</strong></li>
</ul>
<p>å¦‚æœé¡¹ç›®ï¼š</p>
<ul>
<li>çŠ¶æ€ç®€å•</li>
<li>æ•°æ®æºå•ä¸€<br/>
LiveData å¹¶ä¸è½å</li>
</ul>
<p>å¦‚æœé¡¹ç›®ï¼š</p>
<ul>
<li>å¤šæ•°æ®æº</li>
<li>æœ‰ç»„åˆ / è½¬æ¢ / èƒŒå‹éœ€æ±‚<br/>
Flow æ‰æ˜¯çœŸæ­£çš„ä¼˜åŠ¿åŒº</li>
</ul>
<hr/>
<h2 data-id="heading-26">æ€»ç»“ä¸€å¥è¯</h2>
<blockquote>
<p><strong>LiveData â†’ Flowï¼Œä¸æ˜¯è¯­æ³•è¿ç§»ï¼Œè€Œæ˜¯å¿ƒæ™ºæ¨¡å‹è¿ç§»ã€‚</strong></p>
</blockquote>
<p>å¦‚æœä½ åªæ˜¯â€œä¸ºäº†ç”¨è€Œç”¨â€ï¼Œ<br/>
Flow åè€Œä¼šè®©ç³»ç»Ÿæ›´å¤æ‚ã€‚</p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤šæ¨¡å—æ¶æ„ä¸‹çš„ä¾èµ–æ²»ç†ï¼šå¦‚ä½•é¿å… Gradle ä¾èµ–åœ°ç‹±]]></title>    <link>https://juejin.cn/post/7602931486599004195</link>    <guid>https://juejin.cn/post/7602931486599004195</guid>    <pubDate>2026-02-05T13:02:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602931486599004195" data-draft-id="7603183929251921972" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤šæ¨¡å—æ¶æ„ä¸‹çš„ä¾èµ–æ²»ç†ï¼šå¦‚ä½•é¿å… Gradle ä¾èµ–åœ°ç‹±"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-02-05T13:02:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Fushize"/> <meta itemprop="url" content="https://juejin.cn/user/2367696439872411"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤šæ¨¡å—æ¶æ„ä¸‹çš„ä¾èµ–æ²»ç†ï¼šå¦‚ä½•é¿å… Gradle ä¾èµ–åœ°ç‹±
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2367696439872411/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Fushize
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T13:02:22.000Z" title="Thu Feb 05 2026 13:02:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<p>éšç€é¡¹ç›®ä¸šåŠ¡çš„æ‰©å¼ ï¼Œä½ æŠŠé¡¹ç›®æ‹†æˆäº† <code>app</code>ã€<code>core</code>ã€<code>feature-login</code>ã€<code>feature-home</code> ç­‰åå‡ ä¸ªæ¨¡å—ã€‚ä½ è§‰å¾—æ¶æ„æ¸…æ™°äº†ï¼Œè§£è€¦äº†ï¼Œå¿ƒé‡Œç¾æ»‹æ»‹ã€‚</p>
<p>ç›´åˆ°æœ‰ä¸€å¤©ï¼ŒApp çªç„¶å´©æºƒï¼ŒæŠ¥é”™ <code>java.lang.NoSuchMethodError</code>ï¼Œæˆ–è€… <code>NoClassDefFoundError</code>ã€‚</p>
<p>æ’æŸ¥äº†ä¸€ä¸‹åˆï¼Œä½ å‘ç°ï¼š</p>
<ul>
<li><code>core</code> æ¨¡å—ä¾èµ–äº† <code>OkHttp 4.9.0</code>ã€‚</li>
<li><code>feature-login</code> æ¨¡å—å·å·ä¾èµ–äº† <code>OkHttp 3.12.0</code>ã€‚</li>
<li>Gradle åœ¨æ‰“åŒ…æ—¶â€œè‡ªä½œèªæ˜â€åœ°åˆå¹¶äº†ç‰ˆæœ¬ï¼Œå¯¼è‡´è¿è¡Œæ—¶æ‰¾ä¸åˆ°æ–¹æ³•ã€‚</li>
</ul>
<p>è¿™å°±æ˜¯**â€œä¾èµ–åœ°ç‹±â€ï¼ˆDependency Hellï¼‰**ã€‚åœ¨å¤šæ¨¡å—å¼€å‘ä¸­ï¼Œå¦‚æœç¼ºä¹æ²»ç†ï¼Œ<code>build.gradle</code> æ–‡ä»¶å¾ˆå¿«å°±ä¼šå˜æˆä¸€å †éš¾ä»¥ç»´æŠ¤çš„â€œé­”æ³•æ•°å­—â€å’Œå†²çªä»£ç ã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬æ¥èŠèŠï¼Œåœ¨ 2026 å¹´ï¼Œå¦‚ä½•ä¼˜é›…åœ°æ²»ç† Android ä¾èµ–ã€‚</p>
<h3 data-id="heading-0">1. æ”¾å¼ƒ <code>ext</code>ï¼Œæ‹¥æŠ± Version Catalogs</h3>
<p>ä»¥å‰æˆ‘ä»¬å–œæ¬¢åœ¨æ ¹ç›®å½•çš„ <code>build.gradle</code> é‡Œå†™ä¸ª <code>ext</code> ä»£ç å—æ¥ç®¡ç†ç‰ˆæœ¬å·ã€‚åæ¥æœ‰äººç”¨ <code>buildSrc</code>ï¼Œè™½ç„¶æ”¯æŒè‡ªåŠ¨è¡¥å…¨ï¼Œä½†ä¼šå¯¼è‡´æ¯æ¬¡ä¿®æ”¹ç‰ˆæœ¬å·éƒ½è§¦å‘å…¨é‡ç¼–è¯‘ï¼ˆå¤ªæ…¢äº†ï¼ï¼‰ã€‚</p>
<p>ç°åœ¨ï¼ŒGoogle å®˜æ–¹æ¨èçš„æ ‡å‡†æ˜¯ <strong>Version Catalogs (<code>libs.versions.toml</code>)</strong> ã€‚</p>
<p>å®ƒçš„ä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li><strong>ç»Ÿä¸€ç®¡ç†</strong>ï¼šæ‰€æœ‰ç‰ˆæœ¬å·åœ¨ä¸€ä¸ª TOML æ–‡ä»¶é‡Œï¼Œä¸€ç›®äº†ç„¶ã€‚</li>
<li><strong>æ€§èƒ½å¥½</strong>ï¼šä¿®æ”¹ç‰ˆæœ¬å·ä¸ä¼šå¯¼è‡´æ„å»ºè„šæœ¬é‡æ–°ç¼–è¯‘ã€‚</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šåœ¨ Kotlin DSL ä¸­å¯ä»¥ç›´æ¥ç‚¹å‡ºæ¥ï¼Œä¸ç”¨èƒŒå­—ç¬¦ä¸²ã€‚</li>
</ul>
<p><strong>å®æˆ˜é…ç½® (<code>gradle/libs.versions.toml</code>):</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[versions]</span>
<span class="hljs-attr">kotlin</span> = <span class="hljs-string">"1.9.22"</span>
<span class="hljs-attr">retrofit</span> = <span class="hljs-string">"2.9.0"</span>
<span class="hljs-attr">okhttp</span> = <span class="hljs-string">"4.12.0"</span>

<span class="hljs-section">[libraries]</span>
<span class="hljs-attr">retrofit</span> = { module = <span class="hljs-string">"com.squareup.retrofit2:retrofit"</span>, version.ref = <span class="hljs-string">"retrofit"</span> }
<span class="hljs-attr">retrofit-gson</span> = { module = <span class="hljs-string">"com.squareup.retrofit2:converter-gson"</span>, version.ref = <span class="hljs-string">"retrofit"</span> }
<span class="hljs-attr">okhttp</span> = { module = <span class="hljs-string">"com.squareup.okhttp3:okhttp"</span>, version.ref = <span class="hljs-string">"okhttp"</span> }
<span class="hljs-attr">okhttp-logging</span> = { module = <span class="hljs-string">"com.squareup.okhttp3:logging-interceptor"</span>, version.ref = <span class="hljs-string">"okhttp"</span> }

<span class="hljs-section">[bundles]</span>
<span class="hljs-attr">networking</span> = [<span class="hljs-string">"retrofit"</span>, <span class="hljs-string">"retrofit-gson"</span>, <span class="hljs-string">"okhttp"</span>, <span class="hljs-string">"okhttp-logging"</span>]
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>åœ¨æ¨¡å—ä¸­ä½¿ç”¨ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// app/build.gradle.kts</span>
dependencies {
    <span class="hljs-comment">// ä»¥å‰ï¼šimplementation("com.squareup.retrofit2:retrofit:2.9.0")</span>
    <span class="hljs-comment">// ç°åœ¨ï¼š</span>
    <span class="hljs-built_in">implementation</span>(libs.bundles.networking) 
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>çœ‹ï¼Œè¿ä¾èµ–ä¸€æ•´å¥—ç½‘ç»œåº“éƒ½åªéœ€è¦ä¸€è¡Œä»£ç ï¼Œè€Œä¸”ç»å¯¹ä¸ä¼šå‡ºç° <code>Retrofit</code> å’Œ <code>OkHttp</code> ç‰ˆæœ¬ä¸åŒ¹é…çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-1">2. <code>api</code> vs <code>implementation</code>ï¼šå®ˆå¥½ä½ çš„å¤§é—¨</h3>
<p>è¿™æ˜¯å¤šæ¨¡å—å¼€å‘ä¸­æœ€å®¹æ˜“è¢«å¿½è§†çš„ç»†èŠ‚ï¼Œä¹Ÿæ˜¯<strong>æ„å»ºé€Ÿåº¦å˜æ…¢</strong>çš„ç½ªé­ç¥¸é¦–ã€‚</p>
<ul>
<li><strong><code>implementation</code> (æ¨è)</strong> ï¼šä¾èµ–åªå¯¹å½“å‰æ¨¡å—å¯è§ã€‚å¦‚æœ <code>Library A</code> ä¿®æ”¹äº†ä¾èµ–ï¼Œåªæœ‰ A ä¼šé‡æ–°ç¼–è¯‘ï¼Œä¾èµ– A çš„ <code>App</code> æ¨¡å—ä¸éœ€è¦é‡æ–°ç¼–è¯‘ã€‚</li>
<li><strong><code>api</code> (æ…ç”¨)</strong> ï¼šä¾èµ–ä¼šâ€œæ³„æ¼â€ç»™ä¸Šå±‚æ¨¡å—ã€‚å¦‚æœ <code>Library A</code> ç”¨ <code>api</code> ä¾èµ–äº† Gsonï¼Œé‚£ä¹ˆä¾èµ– A çš„ <code>App</code> æ¨¡å—ä¹Ÿèƒ½ç›´æ¥ç”¨ Gsonã€‚ä¸€æ—¦ Gson ç‰ˆæœ¬å˜äº†ï¼Œæ•´æ¡é“¾è·¯éƒ½è¦é‡æ–°ç¼–è¯‘ã€‚</li>
</ul>
<p><strong>æ²»ç†åŸåˆ™ï¼š</strong> é™¤éä½ çš„æ¨¡å—æ˜¯ä¸€ä¸ªâ€œèšåˆå±‚â€æˆ–è€…ä½ çš„æ¥å£è¿”å›å€¼ç›´æ¥æš´éœ²äº†ç¬¬ä¸‰æ–¹åº“çš„å¯¹è±¡ï¼Œå¦åˆ™<strong>å¾‹ä½¿ç”¨ <code>implementation</code></strong>ã€‚è¿™èƒ½æ˜¾è‘—å‡å°‘å¢é‡ç¼–è¯‘çš„æ—¶é—´ã€‚</p>
<h3 data-id="heading-2">3. è§£å†³å†²çªçš„ç»ˆææ­¦å™¨ï¼šBOM (Bill of Materials)</h3>
<p>å½“ä½ çš„é¡¹ç›®å¼•å…¥äº† Firebaseã€Jetpack Compose æˆ–è€… OkHttp å…¨å®¶æ¡¶æ—¶ï¼Œç»å¸¸é‡åˆ°ä¸åŒå­åº“ç‰ˆæœ¬ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œ<strong>BOM</strong> å°±æ˜¯æ•‘æ˜Ÿã€‚BOM æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ä¾èµ–ï¼Œå®ƒä¸åŒ…å«ä»£ç ï¼ŒåªåŒ…å«â€œç‰ˆæœ¬æ¸…å•â€ã€‚ä½ åªéœ€è¦ä¾èµ– BOMï¼Œç„¶åå¼•å…¥å­åº“æ—¶<strong>ä¸éœ€è¦å†™ç‰ˆæœ¬å·</strong>ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">dependencies {
    <span class="hljs-comment">// å¼•å…¥ OkHttp çš„ BOM</span>
    <span class="hljs-built_in">implementation</span>(platform("com.squareup.okhttp3:okhttp-bom:<span class="hljs-number">4.12</span>.<span class="hljs-number">0</span>"))

    <span class="hljs-comment">// ä¸‹é¢è¿™äº›éƒ½ä¸éœ€è¦å†™ç‰ˆæœ¬å·ï¼ŒBOM ä¼šè‡ªåŠ¨ä¿è¯å®ƒä»¬ç‰ˆæœ¬ä¸€è‡´ä¸”å…¼å®¹</span>
    <span class="hljs-built_in">implementation</span>("com.squareup.okhttp3:okhttp")
    <span class="hljs-built_in">implementation</span>("com.squareup.okhttp3:logging-interceptor")
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>è¿™æ ·ï¼Œä½ æ°¸è¿œä¸ç”¨æ‹…å¿ƒ <code>logging-interceptor</code> çš„ç‰ˆæœ¬å’Œ <code>okhttp</code> ä¸»ä½“ç‰ˆæœ¬æ‰“æ¶äº†ã€‚</p>
<h3 data-id="heading-3">4. å¼ºåˆ¶ç»Ÿä¸€ç‰ˆæœ¬ï¼ˆResolutionStrategyï¼‰</h3>
<p>æœ‰æ—¶å€™ï¼Œç¬¬ä¸‰æ–¹åº“ A ä¾èµ–äº† <code>Gson 2.8</code>ï¼Œç¬¬ä¸‰æ–¹åº“ B ä¾èµ–äº† <code>Gson 2.10</code>ã€‚è™½ç„¶ Gradle é»˜è®¤ä¼šé€‰é«˜çš„ï¼Œä½†æœ‰æ—¶å€™ä½ æƒ³<strong>å¼ºåˆ¶</strong>æ‰€æœ‰æ¨¡å—éƒ½ç”¨åŒä¸€ä¸ªç‰ˆæœ¬ï¼Œé˜²æ­¢æ„å¤–ã€‚</p>
<p>åœ¨æ ¹ç›®å½•çš„ <code>build.gradle.kts</code> ä¸­ï¼Œä½ å¯ä»¥åŠ ä¸€æŠŠâ€œå…¨å±€é”â€ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">allprojects {
    configurations<span class="hljs-selector-class">.all</span> {
        resolutionStrategy {
            <span class="hljs-comment">// å¼ºåˆ¶æ‰€æœ‰æ¨¡å—çš„ Gson éƒ½ä½¿ç”¨ 2.10.1</span>
            <span class="hljs-built_in">force</span>("com.google.code.gson:gson:<span class="hljs-number">2.10</span>.<span class="hljs-number">1</span>")
            
            <span class="hljs-comment">// æˆ–è€…ï¼Œå¦‚æœé‡åˆ°å†²çªç›´æ¥æŠ¥é”™ï¼Œå¼ºè¿«å¼€å‘è€…å»è§£å†³ï¼ˆé€‚åˆä¸¥æ ¼çš„é¡¹ç›®ï¼‰</span>
            <span class="hljs-comment">// failOnVersionConflict()</span>
        }
    }
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-4">5. å®šæœŸä½“æ£€ï¼šDependency Analysis Plugin</h3>
<p>å³ä½¿æœ‰äº†ä¸Šé¢çš„æ‰‹æ®µï¼Œéšç€æ—¶é—´æ¨ç§»ï¼Œé¡¹ç›®é‡Œè¿˜æ˜¯ä¼šå †ç§¯å¾ˆå¤šä¸å†ä½¿ç”¨çš„åƒåœ¾ä¾èµ–ã€‚</p>
<p>æ¨èä¸€ä¸ªç¥å™¨æ’ä»¶ï¼š<strong>Dependency Analysis Gradle Plugin</strong> (by Tony Robalik)ã€‚</p>
<p>å®ƒèƒ½å¸®ä½ æ‰¾å‡ºï¼š</p>
<ol>
<li><strong>Unused dependencies</strong>ï¼šå£°æ˜äº†ä½†æ²¡ç”¨çš„ä¾èµ–ï¼ˆåˆ æ‰å‡ä½“ç§¯ï¼ï¼‰ã€‚</li>
<li><strong>Transitive dependencies used</strong>ï¼šä½ ç”¨äº†æŸä¸ªåº“ï¼Œä½†æ²¡æ˜¾å¼å£°æ˜ï¼ˆæ¯”å¦‚ä½ ç”¨äº† Retrofit å¸¦æ¥çš„ OkHttpï¼Œä½†æ²¡åœ¨ gradle é‡Œå†™ OkHttpï¼‰ã€‚è¿™å¾ˆå±é™©ï¼Œä¸€æ—¦ Retrofit å‡çº§å»æ‰äº† OkHttpï¼Œä½ ä»£ç å°±çº¢äº†ã€‚</li>
<li><strong>Wrong scope</strong>ï¼šè¯¥ç”¨ <code>implementation</code> çš„ä½ ç”¨äº† <code>api</code>ã€‚</li>
</ol>
<p><strong>ä½¿ç”¨æ–¹æ³•ï¼š</strong> è·‘ä¸€ä¸‹ <code>./gradlew buildHealth</code>ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä»½è¯¦å°½çš„ HTML æŠ¥å‘Šï¼Œæ•™ä½ å¦‚ä½•ç²¾ç®€ <code>build.gradle</code>ã€‚</p>
<h3 data-id="heading-5">æ€»ç»“</h3>
<p>ä¾èµ–æ²»ç†ä¸ä»…ä»…æ˜¯ä¸ºäº†â€œç¼–è¯‘é€šè¿‡â€ï¼Œæ›´æ˜¯ä¸ºäº†é¡¹ç›®çš„é•¿æ²»ä¹…å®‰ã€‚</p>
<ol>
<li><strong>æ ‡å‡†åŒ–</strong>ï¼šå…¨çº¿è¿ç§»åˆ° <strong>Version Catalogs (TOML)</strong> ã€‚</li>
<li><strong>éš”ç¦»åŒ–</strong>ï¼šä¸¥æ§ <code>api</code> ä½¿ç”¨ï¼Œé»˜è®¤ä¸º <code>implementation</code>ã€‚</li>
<li><strong>ä¸€è‡´åŒ–</strong>ï¼šå–„ç”¨ <strong>BOM</strong> å’Œ <code>resolutionStrategy</code> è§£å†³ç‰ˆæœ¬å†²çªã€‚</li>
<li><strong>è‡ªåŠ¨åŒ–</strong>ï¼šå®šæœŸç”¨æ’ä»¶æ‰«æâ€œåƒµå°¸ä¾èµ–â€ã€‚</li>
</ol>
<p>æŠŠè¿™äº›åšå¥½äº†ï¼Œä½ ä¼šå‘ç°ä½ çš„ Android é¡¹ç›®å°±åƒæ‰“ç†å¥½çš„èŠ±å›­ä¸€æ ·ï¼Œæ¸…çˆ½ã€ç¨³å®šã€æ„å»ºé£å¿«ã€‚</p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç²¾å‡†åˆ¤æ–­Androidåº”ç”¨å‰åå°çŠ¶æ€ï¼šåŸç†ã€å®è·µä¸é¿å‘æŒ‡å—]]></title>    <link>https://juejin.cn/post/7602965400809783346</link>    <guid>https://juejin.cn/post/7602965400809783346</guid>    <pubDate>2026-02-05T12:16:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602965400809783346" data-draft-id="7602982045139042350" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç²¾å‡†åˆ¤æ–­Androidåº”ç”¨å‰åå°çŠ¶æ€ï¼šåŸç†ã€å®è·µä¸é¿å‘æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-05T12:16:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°ç å“¥_å¸¸"/> <meta itemprop="url" content="https://juejin.cn/user/705230023172650"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç²¾å‡†åˆ¤æ–­Androidåº”ç”¨å‰åå°çŠ¶æ€ï¼šåŸç†ã€å®è·µä¸é¿å‘æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/705230023172650/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°ç å“¥_å¸¸
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T12:16:20.000Z" title="Thu Feb 05 2026 12:16:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨Androidå¼€å‘ä¸­ï¼Œå‡†ç¡®åˆ¤æ–­åº”ç”¨æ•´ä½“å¤„äº<strong>å‰å°ï¼ˆç”¨æˆ·å¯è§äº¤äº’ï¼‰</strong> è¿˜æ˜¯<strong>åå°ï¼ˆå®Œå…¨ä¸å¯è§ï¼‰</strong> æ˜¯è®¸å¤šæ ¸å¿ƒä¸šåŠ¡çš„å…³é”®å‰æï¼š<br/>
âœ… æ¨é€ç­–ç•¥ä¼˜åŒ–ï¼ˆé¿å…åå°é¢‘ç¹å”¤é†’ï¼‰<br/>
âœ… èµ„æºè°ƒåº¦ï¼ˆæš‚åœè§†é¢‘/å®šä½/ä¼ æ„Ÿå™¨ï¼‰<br/>
âœ… ç”¨æˆ·è¡Œä¸ºåˆ†æï¼ˆä½¿ç”¨æ—¶é•¿ç»Ÿè®¡ï¼‰<br/>
âœ… å®‰å…¨æ•æ„Ÿæ“ä½œï¼ˆå¦‚æ”¯ä»˜å‰æ ¡éªŒï¼‰</p>
<p>ç„¶è€Œï¼Œç”±äºAndroidç³»ç»Ÿæ¼”è¿›ã€å‚å•†å®šåˆ¶ã€å¤šè¿›ç¨‹ç­‰å¤æ‚å› ç´ ï¼Œ<strong>â€œçœ‹ä¼¼ç®€å•â€çš„åˆ¤æ–­å®åˆ™é™·é˜±é‡é‡</strong>ã€‚æœ¬æ–‡å°†ç³»ç»Ÿæ¢³ç†å¯é æ–¹æ¡ˆï¼ŒåŠ©ä½ é¿å¼€90%çš„å‘ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€å¸¸è§è¯¯åŒºä¸è¿‡æ—¶æ–¹æ¡ˆï¼ˆè¯·ç»•è¡Œï¼ï¼‰</h2>






























<table><thead><tr><th>æ–¹æ³•</th><th>é—®é¢˜</th><th>çŠ¶æ€</th></tr></thead><tbody><tr><td><code>ActivityManager.getRunningTasks()</code></td><td>API 21+ éœ€<code>GET_TASKS</code>æƒé™ï¼Œè¿”å›ç»“æœè¢«ç³»ç»Ÿé™åˆ¶ï¼Œ<strong>å®Œå…¨ä¸å¯é </strong></td><td>âŒ å·²åºŸå¼ƒ</td></tr><tr><td><code>ActivityManager.getRunningAppProcesses()</code></td><td>API 29+ ä»…è¿”å›è‡ªèº«è¿›ç¨‹ï¼Œæ— æ³•åˆ¤æ–­å‰å°çŠ¶æ€ï¼›éœ€<code>PACKAGE_USAGE_STATS</code>æƒé™</td><td>âŒ ä¸æ¨è</td></tr><tr><td>å•Activityç”Ÿå‘½å‘¨æœŸç›‘å¬</td><td>å¤šActivityåœºæ™¯ä¸‹ï¼ˆå¦‚DialogActivityã€é€æ˜Activityï¼‰ï¼Œè®¡æ•°æ˜“é”™ä¹±</td><td>âš ï¸ å±€é™æ€§å¤§</td></tr><tr><td><code>UsageStatsManager</code></td><td>éœ€ç”¨æˆ·æ‰‹åŠ¨æˆæƒâ€œä½¿ç”¨æƒ…å†µè®¿é—®â€ï¼Œå­˜åœ¨å»¶è¿Ÿï¼Œéšç§æ•æ„Ÿ</td><td>âš ï¸ ä»…ä½œå¤‡é€‰</td></tr></tbody></table>
<blockquote>
<p>ğŸ“Œ <strong>æ ¸å¿ƒè®¤çŸ¥</strong>ï¼šåˆ¤æ–­â€œåº”ç”¨çº§â€å‰åå° â‰  åˆ¤æ–­â€œå•ä¸ªActivityâ€çŠ¶æ€ã€‚éœ€å…³æ³¨<strong>æ•´ä¸ªåº”ç”¨è¿›ç¨‹æ˜¯å¦æœ‰å¯è§çª—å£</strong>ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">äºŒã€å®˜æ–¹é¦–é€‰æ–¹æ¡ˆï¼šProcessLifecycleOwnerï¼ˆå¼ºçƒˆæ¨èï¼‰</h2>
<p>Googleåœ¨AndroidX Lifecycleåº“ä¸­æä¾›<strong>ä¸“ä¸ºåº”ç”¨çº§ç”Ÿå‘½å‘¨æœŸè®¾è®¡</strong>çš„ç»„ä»¶ï¼ŒåŸç†æ¸…æ™°ã€æ— æƒé™è¦æ±‚ã€å…¼å®¹æ€§å¥½ã€‚</p>
<h3 data-id="heading-2">âœ¨ æ ¸å¿ƒä¼˜åŠ¿</h3>
<ul>
<li>åŸºäºæ‰€æœ‰Activityç”Ÿå‘½å‘¨æœŸèšåˆåˆ¤æ–­ï¼ˆéåå°„/ç³»ç»ŸAPIï¼‰</li>
<li><code>onStart</code> = <strong>é¦–ä¸ªActivityå¯è§</strong>ï¼ˆåº”ç”¨è¿›å…¥å‰å°ï¼‰<br/>
<code>onStop</code> = <strong>æœ€åä¸€ä¸ªActivityä¸å¯è§</strong>ï¼ˆåº”ç”¨è¿›å…¥åå°ï¼‰</li>
<li>å›è°ƒåœ¨<strong>ä¸»çº¿ç¨‹</strong>ï¼Œå®‰å…¨æ“ä½œUI</li>
<li>æ— è§†é€æ˜Activityã€DialogFragmentç­‰å¹²æ‰°</li>
<li>æ”¯æŒAndroid 4.0+ï¼ˆAPI 14+ï¼‰ï¼Œç»äº¿çº§åº”ç”¨éªŒè¯</li>
</ul>
<h3 data-id="heading-3">ğŸ›  é›†æˆæ­¥éª¤ï¼ˆKotlinç¤ºä¾‹ï¼‰</h3>
<ol>
<li><strong>æ·»åŠ ä¾èµ–</strong>ï¼ˆapp/build.gradleï¼‰</li>
</ol>
<pre><code class="hljs language-gradle" lang="gradle">dependencies {
    implementation "androidx.lifecycle:lifecycle-process:2.7.0" // ä½¿ç”¨æœ€æ–°ç¨³å®šç‰ˆ
    // å¦‚éœ€Javaæ³¨è§£æ–¹å¼ï¼ˆä¸æ¨èæ–°é¡¹ç›®ï¼‰ï¼šimplementation "androidx.lifecycle:lifecycle-common-java8:2.7.0"
}
</code></pre>
<ol start="2">
<li><strong>åˆ›å»ºè§‚å¯Ÿè€…</strong></li>
</ol>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AppLifecycleObserver</span> : <span class="hljs-type">DefaultLifecycleObserver</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> isForeground = <span class="hljs-literal">false</span>

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStart</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        <span class="hljs-keyword">if</span> (!isForeground) {
            isForeground = <span class="hljs-literal">true</span>
            Log.d(<span class="hljs-string">"AppStatus"</span>, <span class="hljs-string">"âœ… åº”ç”¨è¿›å…¥å‰å°"</span>)
            <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘ï¼šæ¢å¤æ’­æ”¾ã€åˆ·æ–°æ•°æ®ç­‰</span>
        }
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStop</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>)</span></span> {
        <span class="hljs-keyword">if</span> (isForeground) {
            isForeground = <span class="hljs-literal">false</span>
            Log.d(<span class="hljs-string">"AppStatus"</span>, <span class="hljs-string">"â¸ï¸ åº”ç”¨è¿›å…¥åå°"</span>)
            <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘ï¼šæš‚åœä»»åŠ¡ã€ä¿å­˜çŠ¶æ€ç­‰</span>
        }
    }
}
</code></pre>
<ol start="3">
<li><strong>åœ¨Applicationä¸­æ³¨å†Œ</strong></li>
</ol>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplication</span> : <span class="hljs-type">Application</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()
        ProcessLifecycleOwner.<span class="hljs-keyword">get</span>().lifecycle.addObserver(AppLifecycleObserver())
    }
}
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>å…³é”®ç»†èŠ‚</strong></p>
<ul>
<li>ä½¿ç”¨<code>DefaultLifecycleObserver</code>ï¼ˆæ¥å£ï¼‰æ›¿ä»£<code>@OnLifecycleEvent</code>æ³¨è§£ï¼ˆåå°„å¼€é”€ï¼Œæ–°ç‰ˆå·²æ ‡è®°Deprecatedï¼‰</li>
<li>å†…éƒ¨é€šè¿‡<code>ActivityLifecycleCallbacks</code>è‡ªåŠ¨ç®¡ç†Activityè®¡æ•°ï¼Œ<strong>æ— éœ€æ‰‹åŠ¨ç»´æŠ¤æ ˆ</strong></li>
<li>å›è°ƒæ—¶æœºï¼š<code>onStart</code>åœ¨ç¬¬ä¸€ä¸ªActivityçš„<code>onStart()</code>åï¼›<code>onStop</code>åœ¨æœ€åä¸€ä¸ªActivityçš„<code>onStop()</code>å</li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€è¾¹ç•Œåœºæ™¯ä¸å¢å¼ºç­–ç•¥</h2>
<h3 data-id="heading-5">ğŸ”’ å¤šè¿›ç¨‹åº”ç”¨</h3>
<ul>
<li><code>ProcessLifecycleOwner</code><strong>ä»…ç›‘æ§ä¸»è¿›ç¨‹</strong>çš„Activity</li>
<li><strong>æ–¹æ¡ˆ</strong>ï¼šå­è¿›ç¨‹é€šè¿‡AIDL/Binderå‘ä¸»è¿›ç¨‹ä¸ŠæŠ¥çŠ¶æ€ï¼Œæˆ–å­è¿›ç¨‹ç‹¬ç«‹ä½¿ç”¨è½»é‡åˆ¤æ–­ï¼ˆå¦‚ç»“åˆ<code>ActivityManager</code>è‡ªæŸ¥ï¼‰</li>
</ul>
<h3 data-id="heading-6">ğŸ“± å‚å•†ROMå…¼å®¹æ€§</h3>
<ul>
<li>åä¸º/å°ç±³ç­‰å®šåˆ¶ç³»ç»Ÿå¯èƒ½å»¶è¿Ÿ<code>onStop</code>ï¼ˆå¦‚å¿«é€Ÿåˆ‡å›ï¼‰</li>
<li><strong>å¢å¼ºå»ºè®®</strong>ï¼š
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç»“åˆå±å¹•çŠ¶æ€è¾…åŠ©åˆ¤æ–­ï¼ˆéœ€æƒé™ï¼šandroid.permission.READ_PHONE_STATEï¼‰</span>
<span class="hljs-keyword">val</span> isScreenOn = (getSystemService(Context.POWER_SERVICE) <span class="hljs-keyword">as</span> PowerManager).isInteractive
<span class="hljs-keyword">if</span> (!isForeground &amp;&amp; !isScreenOn) {
    <span class="hljs-comment">// å¯èƒ½å› é”å±è§¦å‘åå°ï¼Œé¿å…è¯¯åˆ¤ä¸ºç”¨æˆ·ä¸»åŠ¨åˆ‡å‡º</span>
}
</code></pre>
</li>
</ul>
<h3 data-id="heading-7">ğŸŒ ç‰¹æ®Šåœºæ™¯è¡¥å……</h3>





















<table><thead><tr><th>åœºæ™¯</th><th>å»ºè®®</th></tr></thead><tbody><tr><td>éœ€åˆ¤æ–­â€œå½“å‰Activityæ˜¯å¦åœ¨å‰å°â€</td><td>ä½¿ç”¨<code>Activity.onResume()</code>/<code>onPause()</code>ï¼ˆå•Activityçº§ï¼‰</td></tr><tr><td>éœ€åŒºåˆ†â€œé”å±å¯¼è‡´åå°â€ vs â€œç”¨æˆ·åˆ‡åˆ°å…¶ä»–Appâ€</td><td>ç»“åˆ<code>ScreenStateReceiver</code>ç›‘å¬å±å¹•å¼€å…³</td></tr><tr><td>Android 10+åå°é™åˆ¶</td><td>åˆ¤æ–­é€»è¾‘æœ¬èº«ä¸å—å½±å“ï¼Œä½†åå°ä»»åŠ¡éœ€é€‚é…WorkManager</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-8">å››ã€æ–¹æ¡ˆå¯¹æ¯”é€ŸæŸ¥è¡¨</h2>








































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>å¯é æ€§</th><th>æƒé™è¦æ±‚</th><th>å®æ—¶æ€§</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>ProcessLifecycleOwner</strong></td><td>â­â­â­â­â­</td><td>æ— </td><td>é«˜</td><td><strong>99%åº”ç”¨çº§åˆ¤æ–­é¦–é€‰</strong></td></tr><tr><td>ActivityLifecycleCallbacksï¼ˆæ‰‹åŠ¨è®¡æ•°ï¼‰</td><td>â­â­â­</td><td>æ— </td><td>é«˜</td><td>éœ€æ·±åº¦å®šåˆ¶è®¡æ•°é€»è¾‘æ—¶</td></tr><tr><td>UsageStatsManager</td><td>â­â­</td><td>éœ€ç”¨æˆ·æˆæƒ</td><td>ä¸­ï¼ˆç§’çº§å»¶è¿Ÿï¼‰</td><td>æ— å…¶ä»–æ–¹æ¡ˆæ—¶çš„å¤‡é€‰</td></tr><tr><td>ActivityManagerï¼ˆæ—§ç‰ˆï¼‰</td><td>â­</td><td>é«˜å±æƒé™</td><td>ä½</td><td><strong>å·²æ·˜æ±°ï¼Œåˆ‡å‹¿ä½¿ç”¨</strong></td></tr></tbody></table>
<hr/>
<h2 data-id="heading-9">äº”ã€æœ€ä½³å®è·µ checklist</h2>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ä¼˜å…ˆä½¿ç”¨<code>ProcessLifecycleOwner</code> + <code>DefaultLifecycleObserver</code></li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> é¿å…åœ¨<code>onStop</code>ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œï¼ˆç³»ç»Ÿå¯èƒ½å¿«é€Ÿæ€æ­»è¿›ç¨‹ï¼‰</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> åå°æ“ä½œä½¿ç”¨<code>WorkManager</code>æ›¿ä»£AlarmManager/Handler</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æµ‹è¯•è¦†ç›–ï¼šå¿«é€Ÿåˆ‡æ¢ã€é”å±ã€æ¥ç”µä¸­æ–­ã€å¤šActivityè·³è½¬</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ—¥å¿—åŸ‹ç‚¹éªŒè¯å›è°ƒæ—¶æœºï¼ˆå°¤å…¶å‚å•†æœºï¼‰</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ä¸è¦ä¾èµ–â€œè¿›ç¨‹æ˜¯å¦å­˜æ´»â€åˆ¤æ–­å‰åå°ï¼ˆè¿›ç¨‹å¯èƒ½é©»ç•™åå°ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-10">ç»“è¯­</h2>
<p>åˆ¤æ–­åº”ç”¨å‰åå°çŠ¶æ€ï¼Œæœ¬è´¨æ˜¯<strong>ç†è§£Androidç”Ÿå‘½å‘¨æœŸè®¾è®¡å“²å­¦</strong>ï¼š</p>
<blockquote>
<p>â€œå…³æ³¨ç”¨æˆ·æ˜¯å¦ä¸åº”ç”¨äº¤äº’ï¼Œè€Œéè¿›ç¨‹æ˜¯å¦è¿è¡Œã€‚â€</p>
</blockquote>
<p><code>ProcessLifecycleOwner</code>ä½œä¸ºGoogleå®˜æ–¹æ–¹æ¡ˆï¼Œä»¥æœ€å°æˆæœ¬æä¾›æœ€é«˜å¯é æ€§ã€‚åœ¨ç»å¤§å¤šæ•°ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå®ƒåº”æ˜¯ä½ çš„<strong>å”¯ä¸€é€‰æ‹©</strong>ã€‚å¯¹äºæç«¯å®šåˆ¶éœ€æ±‚ï¼ˆå¦‚é‡‘èçº§å®‰å…¨æ ¡éªŒï¼‰ï¼Œå¯ç»“åˆå±å¹•çŠ¶æ€ã€çª—å£ç„¦ç‚¹ç­‰åšå¢å¼ºåˆ¤æ–­ï¼Œä½†åˆ‡å‹¿æœ¬æœ«å€’ç½®ã€‚</p>
<p><strong>è®°ä½</strong>ï¼šæ²¡æœ‰100%å®Œç¾çš„æ–¹æ¡ˆï¼Œä½†æœ‰99%åœºæ™¯ä¸‹è¶³å¤Ÿä¼˜é›…çš„è§£æ³•ã€‚é€‰æ‹©ç»è¿‡éªŒè¯çš„ç°ä»£APIï¼ŒæŠŠç²¾åŠ›ç•™ç»™çœŸæ­£åˆ›é€ ä»·å€¼çš„ä¸šåŠ¡é€»è¾‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Fragmentå’ŒActivityç”Ÿå‘½å‘¨æœŸç®¡ç†çš„å·¨å¤§åŒºåˆ«]]></title>    <link>https://juejin.cn/post/7603186080493846579</link>    <guid>https://juejin.cn/post/7603186080493846579</guid>    <pubDate>2026-02-05T11:45:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603186080493846579" data-draft-id="7602965400809701426" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Fragmentå’ŒActivityç”Ÿå‘½å‘¨æœŸç®¡ç†çš„å·¨å¤§åŒºåˆ«"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-02-05T11:45:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="GoldenPlayer"/> <meta itemprop="url" content="https://juejin.cn/user/2999123453948119"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Fragmentå’ŒActivityç”Ÿå‘½å‘¨æœŸç®¡ç†çš„å·¨å¤§åŒºåˆ«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2999123453948119/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    GoldenPlayer
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T11:45:08.000Z" title="Thu Feb 05 2026 11:45:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><pre><code class="hljs language-scss" lang="scss"># Fragmenté‡å»ºä¹‹è°œï¼šæˆ‘çš„å›è°ƒä¸ºä½•åœ¨ <span class="hljs-built_in">onResume</span>() æ—¶ç¦»å¥‡æ¶ˆå¤±ï¼Ÿ

&gt; â€œå¿«è·Ÿæˆ‘è¯´è¯´ï¼Œä½ æ˜¯æ€ä¹ˆæŠŠåºæ±ŸåŸæ”»ä¸‹æ¥çš„ï¼Ÿâ€ â€”â€” è¢æœ¯
&gt;
&gt; â€œä¸»å…¬ï¼Œæ­¤äº‹è¯´æ¥è¯é•¿ï¼Œå…¶ä¸­é¢‡ä¸ºè¯¡å¼‚â€¦â€¦â€ â€”â€” å­™ç­–


## æ¡ˆå‘ç°åœº

æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼šæˆ‘ä»¬çš„Appå¯ä»¥è¢«è®¾ç½®ä¸ºç³»ç»Ÿçš„â€œé»˜è®¤ç”µè¯åº”ç”¨â€ã€‚å½“ç”¨æˆ·åœ¨æ‰‹æœºè®¾ç½®é‡Œï¼Œå°†æˆ‘ä»¬çš„Appä»â€œé»˜è®¤â€å®åº§ä¸Šæ’¤ä¸‹æ¥ï¼Œæ¢å›ç³»ç»Ÿè‡ªå¸¦çš„ç”µè¯Appï¼Œç„¶åå†åˆ‡å›æˆ‘ä»¬çš„Appæ—¶ï¼Œä¸€ä¸ªè¯¡å¼‚çš„NullPointerExceptionï¼ˆæˆ–è€…æ˜¯ä¸€ä¸ªä¾èµ–å›è°ƒçš„é€»è¾‘å¤±æ•ˆï¼‰å‘ç”Ÿäº†ã€‚

é—®é¢˜å‡ºåœ¨ManageFragmentçš„<span class="hljs-built_in">onResume</span>()æ–¹æ³•é‡Œã€‚æˆ‘åœ¨è¿™é‡Œéœ€è¦ä½¿ç”¨ä¸€ä¸ªé€šè¿‡AirIMEngineå•ä¾‹è®¾ç½®çš„å›è°ƒï¼Œä½†åœ¨å‡ºäº‹æ—¶ï¼Œè¿™ä¸ªå›è°ƒå¯¹è±¡ç«Ÿç„¶æ˜¯nullï¼

```kotlin
<span class="hljs-comment">// in ManageFragment.kt</span>
override fun <span class="hljs-built_in">onResume</span>() {
    super<span class="hljs-selector-class">.onResume</span>()

    <span class="hljs-comment">// å°è¯•ä½¿ç”¨å›è°ƒï¼Œä½†AirIMEngine.getCallback()è¿”å›äº†nullï¼Œå¯¼è‡´åç»­é€»è¾‘å´©æºƒ</span>
    AirIMEngine<span class="hljs-selector-class">.getCallback</span>()<span class="hljs-selector-class">.doSomething</span>() <span class="hljs-comment">// å´©æºƒå‘ç”Ÿåœ¨è¿™é‡Œï¼</span>
}
</code></pre>
<p>è¿™å¤ªå¥‡æ€ªäº†ï¼å› ä¸ºæˆ‘éå¸¸ç¡®å®šï¼Œåœ¨onViewCreated()é‡Œï¼Œæˆ‘å·²ç»æŠŠå›è°ƒè®¾ç½®å¥½äº†ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// in ManageFragment.kt</span>
<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onViewCreated</span><span class="hljs-params">(view: <span class="hljs-type">View</span>, savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
    <span class="hljs-keyword">super</span>.onViewCreated(view, savedInstanceState)
    Log.d(TAG, <span class="hljs-string">"onViewCreated: è®¾ç½®å›è°ƒ"</span>)
    AirIMEngine.setConnectStateCallback(iMConnectCallback) <span class="hljs-comment">// æ˜æ˜åœ¨è¿™é‡Œè®¾ç½®äº†ï¼</span>
}
</code></pre>
<p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒFragmentçš„ç”Ÿå‘½å‘¨æœŸæ˜¯onViewCreated() -&gt; onStart() -&gt; onResume()ã€‚æ—¢ç„¶onViewCreatedæ‰§è¡Œäº†ï¼Œå›è°ƒå°±åº”è¯¥åœ¨é‚£é‡Œã€‚ä¸ºä»€ä¹ˆåˆ°äº†onResumeï¼Œå®ƒå°±â€œäººé—´è’¸å‘â€äº†å‘¢ï¼Ÿ</p>
<h2 data-id="heading-0">åˆæ­¥æ’æŸ¥ä¸â€œç°åœºæ€¥æ•‘â€</h2>
<p>é¢å¯¹çº¿ä¸Šå¯èƒ½çš„å´©æºƒï¼Œç¬¬ä¸€ååº”æ˜¯å…ˆè§£å†³é—®é¢˜ã€‚æœ€ç›´æ¥çš„â€œæš´åŠ›â€ä¿®å¤æ–¹æ¡ˆæ˜¯åœ¨onResumeé‡Œå†åŠ ä¸€æ¬¡æ£€æŸ¥å’Œè®¾ç½®ï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// in ManageFragment.kt</span>
<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onResume</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">super</span>.onResume()

    <span class="hljs-comment">// å¦‚æœå‘ç°å›è°ƒæ²¡äº†ï¼Œå°±å†è®¾ç½®ä¸€æ¬¡</span>
    <span class="hljs-keyword">if</span> (!AirIMEngine.hasCallback()) {
        Log.w(TAG, <span class="hljs-string">"onResume: å›è°ƒä¸¢å¤±äº†ï¼é‡æ–°è®¾ç½®ï¼"</span>)
        AirIMEngine.setConnectStateCallback(iMConnectCallback)
    }

    AirIMEngine.getCallback().doSomething() <span class="hljs-comment">// è¿™ä¸‹å®‰å…¨äº†</span>
}
</code></pre>
<p>è¿™æ®µä»£ç åƒä¸€ä¸ªâ€œåˆ›å¯è´´â€ï¼Œå®ƒèƒ½å®Œç¾åœ°è§£å†³å´©æºƒã€‚ä½†æ˜¯ï¼Œä½œä¸ºæœ‰è¿½æ±‚çš„å¼€å‘è€…ï¼Œæˆ‘ä»¬ä¸èƒ½æ»¡è¶³äºæ­¤ã€‚<strong>å›è°ƒä¸ºä»€ä¹ˆä¼šä¸¢å¤±ï¼Ÿ</strong> è¿™ä¸ªé—®é¢˜å°±åƒä¸€æ ¹åˆºï¼Œä¸æ‹”ä¸å¿«ã€‚ä¸ææ¸…æ¥šæ ¹æœ¬åŸå› ï¼Œéš¾ä¿å®ƒä¸ä¼šåœ¨åˆ«çš„åœ°æ–¹ä»¥æ›´è¯¡å¼‚çš„å½¢å¼å†æ¬¡å‡ºç°ã€‚</p>
<h2 data-id="heading-1">æ·±å…¥è°ƒæŸ¥ï¼šæ‰¾åˆ°â€œå¦ä¸€ä¸ªä½ â€</h2>
<p>ä¸ºäº†æ‰¾åˆ°çœŸç›¸ï¼Œæˆ‘ç¥­å‡ºäº†Logå¤§æ³•ï¼Œåœ¨onViewCreatedå’ŒonDestroyé‡Œæ‰“å°å‡ºthiså®ä¾‹çš„å“ˆå¸Œå€¼ã€‚å½“æˆ‘å†æ¬¡å¤ç°æ“ä½œåï¼ŒLogcaté‡Œçš„æ—¥å¿—è®©æˆ‘å¤§è·Œçœ¼é•œï¼š</p>
<p>log</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ›´æ”¹é»˜è®¤åº”ç”¨ï¼Œè¿”å›Appå...</span>
D/MyLog: ManageFragment &gt; onViewCreated, <span class="hljs-keyword">this</span>:ManageFragment{**1f02326**}
D/MyLog: Manage-Fragment &gt; onViewCreated, <span class="hljs-keyword">this</span>:ManageFragment{**47cf2fb**}
D/MyLog: ManageFragment &gt; onDestroy, <span class="hljs-keyword">this</span>:ManageFragment{**1f02326**}
</code></pre>
<h2 data-id="heading-2">çœŸç›¸å¤§ç™½ï¼</h2>
<p>åœ¨è¿”å›MainActivityçš„é‚£ä¸€åˆ»ï¼Œç³»ç»Ÿé‡Œç«Ÿç„¶å‡ºç°äº†ä¸¤ä¸ªManageFragmentçš„å®ä¾‹ï¼</p>
<ol>
<li>ä¸€ä¸ªå®ä¾‹ï¼ˆæˆ‘ä»¬å«å®ƒF_A {1f02326}ï¼‰å…ˆè¢«åˆ›å»ºï¼Œå¹¶æ‰§è¡Œäº†onViewCreatedã€‚</li>
<li>ç´§æ¥ç€ï¼Œå¦ä¸€ä¸ªå…¨æ–°çš„å®ä¾‹ï¼ˆF_B {47cf2fb}ï¼‰ä¹Ÿè¢«åˆ›å»ºï¼Œå¹¶æ‰§è¡Œäº†onViewCreatedã€‚</li>
<li>æœ€å…³é”®çš„æ˜¯ï¼Œåœ¨è¿™ä¸€åˆ‡ä¹‹åï¼Œç¬¬ä¸€ä¸ªå®ä¾‹F_Açš„onDestroyæ–¹æ³•è¢«è°ƒç”¨äº†ã€‚</li>
</ol>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å®Œæ•´åœ°è¿˜åŸæ•´ä¸ªâ€œçŠ¯ç½ªè¿‡ç¨‹â€äº†ï¼š</p>
<ol>
<li>æ›´æ”¹é»˜è®¤ç”µè¯Appè¢«ç³»ç»Ÿè§†ä¸ºä¸€æ¬¡é‡å¤§çš„â€œé…ç½®å˜æ›´â€ï¼ˆConfiguration Changeï¼‰ï¼Œç³»ç»Ÿå†³å®šé”€æ¯å¹¶é‡å»ºæˆ‘ä»¬çš„MainActivityã€‚</li>
<li>MainActivityé‡å»ºå¼€å§‹ï¼ŒFragmentManagerä»savedInstanceStateä¸­ï¼Œè‡ªåŠ¨æ¢å¤äº†å®ƒä¹‹å‰ç®¡ç†çš„ManageFragmentå®ä¾‹ï¼Œè¿™å°±æ˜¯F_Aã€‚</li>
<li>F_Aæ‰§è¡ŒonViewCreatedï¼Œè°ƒç”¨AirIMEngine.setConnectStateCallback()ï¼Œæ­¤æ—¶å•ä¾‹ä¸­çš„å›è°ƒè¢«æˆåŠŸè®¾ç½®ä¸ºF_Açš„iMConnectCallbackå®ä¾‹ã€‚</li>
<li>ç„¶è€Œï¼Œåœ¨MainActivityçš„onCreateæ–¹æ³•ä¸­ï¼Œå¾ˆå¯èƒ½å­˜åœ¨è¿™æ ·ä¸€æ®µä»£ç ï¼š<code>supportFragmentManager.beginTransaction().replace(R.id.container, new ManageFragment()).commit()</code>ã€‚è¿™æ®µä»£ç å¹¶ä¸çŸ¥é“FragmentManagerå·²ç»æ¢å¤äº†ä¸€ä¸ªFragmentï¼Œå®ƒåªæ˜¯å¿ å®åœ°æ‰§è¡ŒæŒ‡ä»¤â€”â€”åˆ›å»ºå¹¶æ·»åŠ ä¸€ä¸ªå…¨æ–°çš„ManageFragmentå®ä¾‹ï¼Œä¹Ÿå°±æ˜¯F_Bã€‚</li>
<li>F_Bæ‰§è¡ŒonViewCreatedï¼Œå†æ¬¡è°ƒç”¨AirIMEngine.setConnectStateCallback()ï¼Œæ­¤æ—¶å•ä¾‹ä¸­çš„å›è°ƒè¢«è¦†ç›–ä¸ºF_Bçš„iMConnectCallbackå®ä¾‹ã€‚</li>
<li>replaceäº‹åŠ¡çš„æ‰§è¡Œï¼Œæ„å‘³ç€å®¹å™¨ä¸­æ‰€æœ‰æ—§çš„Fragmentéƒ½å°†è¢«ç§»é™¤ã€‚å› æ­¤ï¼Œåˆšåˆšè¢«æ¢å¤çš„F_Aè¢«ç«‹å³æ ‡è®°ä¸ºé”€æ¯ã€‚</li>
<li>F_Açš„onDestroyæ–¹æ³•è¢«è§¦å‘ã€‚åœ¨onDestroyä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šæ¸…ç†èµ„æºï¼Œè°ƒç”¨äº†AirIMEngine.removeCallback()ã€‚</li>
<li>è‡´å‘½ä¸€å‡»ï¼šremoveCallback()å°†AirIMEngineå•ä¾‹ä¸­çš„å›è°ƒè®¾ç½®ä¸ºäº†nullã€‚å®ƒæ¸…é™¤äº†F_Båˆšåˆšæ‰è®¾ç½®å¥½çš„å›è°ƒï¼</li>
<li>æœ€åï¼ŒF_Bçš„onResumeæ–¹æ³•ç»ˆäºæ‰§è¡Œï¼Œå½“å®ƒå°è¯•å»è·å–å›è°ƒæ—¶ï¼Œå‘ç°å®ƒå·²ç»åœ¨ä¸Šä¸€æ­¥è¢«F_Açš„â€œä¸´ç»ˆé—è¨€â€ç»™æ¸…é™¤äº†ã€‚</li>
</ol>
<p>è¿™ä¸ªè¿‡ç¨‹å®Œç¾è§£é‡Šäº†â€œå›è°ƒç¦»å¥‡å¤±è¸ªâ€çš„ç°è±¡ã€‚å…¶æ ¹æºåœ¨äº<strong>FragmentManagerçš„è‡ªåŠ¨æ¢å¤æœºåˆ¶å’Œæˆ‘ä»¬ä»£ç ä¸­æ‰‹åŠ¨çš„Fragmentäº‹åŠ¡</strong>å‘ç”Ÿäº†å†²çªã€‚</p>
<h2 data-id="heading-3">ç»ˆæè§£å†³æ–¹æ¡ˆï¼šç›¸ä¿¡savedInstanceState</h2>
<p>è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆéå¸¸ç®€å•ï¼Œä¹Ÿæ˜¯Googleå®˜æ–¹æ¨èçš„æœ€ä½³å®è·µã€‚åœ¨Activityçš„onCreateæ–¹æ³•ä¸­ï¼Œå°†æ‰€æœ‰æ‰‹åŠ¨çš„Fragmentäº‹åŠ¡éƒ½åŒ…è£¹åœ¨ä¸€ä¸ª<code>if (savedInstanceState == null)</code>çš„åˆ¤æ–­é‡Œï¼š</p>
<p>kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// in MainActivity.kt</span>
<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
    <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
    setContentView(R.layout.activity_main)

    <span class="hljs-comment">// å…³é”®ï¼åªåœ¨Activityé¦–æ¬¡åˆ›å»ºæ—¶æ‰æ‰‹åŠ¨æ·»åŠ Fragment</span>
    <span class="hljs-keyword">if</span> (savedInstanceState == <span class="hljs-literal">null</span>) {
        supportFragmentManager.beginTransaction()
            .replace(R.id.fragment_container, ManageFragment.newInstance())
            .commit()
    }
    <span class="hljs-comment">// å¦‚æœsavedInstanceStateä¸æ˜¯nullï¼Œè¯´æ˜Activityæ­£åœ¨ä»ä¹‹å‰çš„çŠ¶æ€ä¸­æ¢å¤ï¼Œ</span>
    <span class="hljs-comment">// FragmentManagerä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬æ¢å¤Fragmentï¼Œæˆ‘ä»¬æ— éœ€å†åšä»»ä½•äº‹ã€‚</span>
}
</code></pre>
<ul>
<li>å½“Activityé¦–æ¬¡å¯åŠ¨æ—¶ï¼ŒsavedInstanceStateä¸ºnullï¼Œæˆ‘ä»¬æ‰‹åŠ¨åˆ›å»ºå¹¶æ·»åŠ Fragmentã€‚</li>
<li>å½“Activityå› ä¸ºé…ç½®å˜æ›´è¢«é‡å»ºæ—¶ï¼ŒsavedInstanceStateä¸å†ä¸ºnullï¼Œifåˆ¤æ–­å—ä¸ä¼šæ‰§è¡Œï¼Œæˆ‘ä»¬æŠŠèˆå°å®Œå…¨äº¤ç»™FragmentManagerï¼Œè®©å®ƒä»å®¹åœ°æ¢å¤ä¹‹å‰çš„Fragmentå®ä¾‹ã€‚</li>
</ul>
<p>è¿™æ ·ä¸€æ¥ï¼Œå°±ä¸ä¼šæœ‰ç¬¬äºŒä¸ªFragmentå®ä¾‹æ¥æ£ä¹±ï¼Œç”Ÿå‘½å‘¨æœŸä¹Ÿå°±æ¢å¤äº†æ­£å¸¸ï¼Œå›è°ƒä¸¢å¤±çš„é—®é¢˜è‡ªç„¶è¿åˆƒè€Œè§£ã€‚</p>
<h2 data-id="heading-4">ç»“æ¡ˆé™ˆè¯</h2>
<p>è¿™æ¬¡â€œæ¢æ¡ˆâ€ç»å†ç»™äº†æˆ‘ä»¬å‡ ä¸ªæ·±åˆ»çš„æ•™è®­ï¼š</p>
<ol>
<li><strong>æ°¸è¿œç”¨<code>if (savedInstanceState == null)</code>ä¿æŠ¤ä½ çš„é¦–æ¬¡Fragmentäº‹åŠ¡ã€‚</strong> Â è¿™æ˜¯å¤„ç†Activityé‡å»ºæ—¶FragmentçŠ¶æ€çš„é»„é‡‘æ³•åˆ™ã€‚</li>
<li><strong>è­¦æƒ•å•ä¾‹ï¼ˆSingletonï¼‰ä¸ç”Ÿå‘½å‘¨æœŸçš„çˆ±æ¨æƒ…ä»‡ã€‚</strong> Â å½“ä¸€ä¸ªæœ‰ç”Ÿå‘½å‘¨æœŸçš„ç»„ä»¶ï¼ˆå¦‚Fragmentï¼‰å»ä¿®æ”¹ä¸€ä¸ªå…¨å±€å•ä¾‹çš„çŠ¶æ€æ—¶ï¼Œå°¤å…¶è¦å°å¿ƒåœ¨é‡å»ºè¿‡ç¨‹ä¸­æ–°æ—§å®ä¾‹äº¤æ›¿æ—¶å¯èƒ½å¼•å‘çš„ç«æ€æ¡ä»¶ã€‚</li>
<li><strong>æ—¥å¿—æ˜¯ä½ çš„â€œæ˜¾å¾®é•œâ€ã€‚</strong> Â å½“ä½ é‡åˆ°çœ‹ä¼¼ä¸åˆé€»è¾‘çš„ç”Ÿå‘½å‘¨æœŸé—®é¢˜æ—¶ï¼Œåœ¨å…³é”®èŠ‚ç‚¹æ‰“å°å‡ºå®ä¾‹çš„å“ˆå¸Œç ï¼ˆ<code>this</code>ï¼‰ï¼Œå¾€å¾€èƒ½å¸®ä½ å‘ç°â€œå¦ä¸€ä¸ªä½ â€çš„å­˜åœ¨ã€‚</li>
</ol>
<p>å¸Œæœ›è¿™æ¬¡çš„åˆ†äº«èƒ½å¸®åŠ©å¤§å®¶åœ¨Fragmentçš„â€œæ·±æ°´åŒºâ€é‡Œæ¸¸å¾—æ›´ç¨³ã€‚å¦‚æœä½ ä¹Ÿé‡åˆ°è¿‡ç±»ä¼¼çš„â€œè¯¡å¼‚â€é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„æ•…äº‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android RecyclerView æ€§èƒ½ä¼˜åŒ–]]></title>    <link>https://juejin.cn/post/7602991346585894946</link>    <guid>https://juejin.cn/post/7602991346585894946</guid>    <pubDate>2026-02-05T13:01:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602991346585894946" data-draft-id="7603043152673193999" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android RecyclerView æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-02-05T13:01:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Fushize"/> <meta itemprop="url" content="https://juejin.cn/user/2367696439872411"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android RecyclerView æ€§èƒ½ä¼˜åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2367696439872411/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Fushize
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T13:01:31.000Z" title="Thu Feb 05 2026 13:01:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<h2 data-id="heading-0">RecyclerView æ»‘åŠ¨å¡é¡¿ï¼Ÿæ•™ä½ å‡ æ‹›è®©åˆ—è¡¨â€œä¸èˆ¬é¡ºæ»‘â€</h2>
<p>åœ¨ Android å¼€å‘ä¸­ï¼ŒRecyclerView æ˜¯æˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„â€œè€ä¼™è®¡â€ï¼Œä¹Ÿæ˜¯æœ€å®¹æ˜“å‡ºæ€§èƒ½é—®é¢˜çš„ç»„ä»¶ã€‚ä½ æ˜¯å¦é‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼šæ‰‹æŒ‡åœ¨å±å¹•ä¸Šä¸€åˆ’ï¼Œåˆ—è¡¨å´åƒå¹»ç¯ç‰‡ä¸€æ ·ä¸€å¸§ä¸€å¸§åœ°è·³ï¼ŸLogcat é‡Œä¸åœå¼¹å‡º <code>Skipped 60 frames! The application may be doing too much work on its main thread.</code>ï¼Ÿ</p>
<p>å¯¹äºè¿½æ±‚ç”¨æˆ·ä½“éªŒçš„åº”ç”¨æ¥è¯´ï¼ˆç‰¹åˆ«æ˜¯ TV ç«¯æˆ–è€…ä½ç«¯æœºå‹ï¼‰ï¼Œæ‰å¸§æ˜¯ç»å¯¹ä¸èƒ½æ¥å—çš„ã€‚ä»Šå¤©æˆ‘ä»¬ä¸è°ˆæºç åˆ†æï¼Œåªè°ˆ<strong>å®æˆ˜ä¸­èƒ½ç›´æ¥æå‡ FPS çš„ä¼˜åŒ–æ‰‹æ®µ</strong>ã€‚</p>
<h4 data-id="heading-1">1. åˆ«åœ¨ <code>onBindViewHolder</code> é‡Œâ€œé€šè¿‡è‹¦åŠ›â€</h4>
<p>è¿™æ˜¯æ–°æ‰‹æœ€å®¹æ˜“çŠ¯çš„é”™ã€‚<code>onBindViewHolder</code> æ¯ç§’å¯èƒ½è¢«è°ƒç”¨å‡ åæ¬¡ï¼Œè¿™é‡Œé¢çš„ä»£ç å¿…é¡»<strong>å¿«å¦‚é—ªç”µ</strong>ã€‚</p>
<ul>
<li>
<p><strong>é”™è¯¯åšæ³•</strong>ï¼š</p>
<ul>
<li>åœ¨é‡Œé¢è®¾ç½® <code>OnClickListener</code>ï¼ˆæ¯æ¬¡ bind éƒ½ new ä¸€ä¸ªå¯¹è±¡ï¼Œå†…å­˜æŠ–åŠ¨ï¼‰ã€‚</li>
<li>è¿›è¡Œå¤æ‚çš„æ•°å­¦è®¡ç®—æˆ–æ—¥æœŸæ ¼å¼åŒ–ï¼ˆ<code>SimpleDateFormat</code> æå…¶è€—æ—¶ï¼‰ã€‚</li>
<li>åŠ è½½å›¾ç‰‡æ—¶æ²¡æœ‰æŒ‡å®šå¤§å°ã€‚</li>
</ul>
</li>
<li>
<p><strong>ä¼˜åŒ–æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li><strong>ç‚¹å‡»äº‹ä»¶ç§»åˆ° <code>onCreateViewHolder</code></strong> æˆ–è€… ViewHolder çš„ <code>init</code> å—ä¸­ã€‚</li>
<li><strong>æ•°æ®é¢„å¤„ç†</strong>ï¼šæŠŠæ—¥æœŸæ ¼å¼åŒ–ã€å­—ç¬¦ä¸²æ‹¼æ¥ç­‰é€»è¾‘æ”¾åˆ° ViewModel æˆ–æ•°æ®å±‚å¤„ç†ï¼Œä¼ ç»™ Adapter çš„åº”è¯¥æ˜¯ç›´æ¥èƒ½æ˜¾ç¤ºçš„ Stringã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-2">2. å‘Šåˆ« <code>notifyDataSetChanged()</code>ï¼Œæ‹¥æŠ± <code>DiffUtil</code></h4>
<p>å¦‚æœä½ è¿˜åœ¨æ— è„‘è°ƒç”¨ <code>notifyDataSetChanged()</code>ï¼Œè¯·ç«‹åˆ»åœæ­¢ã€‚è¿™ä¸ªæ–¹æ³•ä¼šå¼ºåˆ¶é‡ç»˜æ•´ä¸ªå±å¹•å¯è§çš„ Itemï¼Œå“ªæ€•ä½ åªæ˜¯æ”¹äº†ä¸€ä¸ª TextView çš„æ–‡å­—ã€‚</p>
<ul>
<li><strong>ç¥å™¨ï¼šDiffUtil / ListAdapter</strong> <code>DiffUtil</code> æ˜¯ Google å®˜æ–¹æ¨å‡ºçš„å·¥å…·ï¼Œå®ƒèƒ½è®¡ç®—å‡ºæ–°æ—§æ•°æ®é›†çš„æœ€å°å·®å¼‚ã€‚ æ›´æ¨èç›´æ¥ä½¿ç”¨ <strong><code>ListAdapter</code></strong>ï¼ˆç»§æ‰¿è‡ª RecyclerView.Adapterï¼‰ï¼Œå®ƒå†…éƒ¨å°è£…äº† AsyncListDifferã€‚</li>
</ul>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ä½¿ç”¨ ListAdapter åçš„åˆ·æ–°</span>
adapter<span class="hljs-selector-class">.submitList</span>(newList) 
<span class="hljs-comment">// å®ƒä¼šè‡ªåŠ¨è®¡ç®—å·®å¼‚ï¼Œåªåˆ·æ–°å˜åŒ–çš„ Itemï¼Œç”šè‡³ä¼´éšä¼˜é›…çš„åŠ¨ç”»</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>è¿™ä¸ä»…èƒ½æå‡æ€§èƒ½ï¼Œè¿˜èƒ½è§£å†³â€œåˆ·æ–°é—ªçƒâ€çš„é—®é¢˜ã€‚</p>
<h4 data-id="heading-3">3. å¸ƒå±€ä¼˜åŒ–ï¼šå‡å°‘å±‚çº§ï¼Œæ‹’ç»è¿‡åº¦ç»˜åˆ¶</h4>
<p>Item çš„å¸ƒå±€è¶Šå¤æ‚ï¼Œæµ‹é‡ï¼ˆMeasureï¼‰å’Œå¸ƒå±€ï¼ˆLayoutï¼‰çš„æ—¶é—´å°±è¶Šé•¿ã€‚</p>
<ul>
<li><strong>æ‰å¹³åŒ–</strong>ï¼šå¦‚æœä½ çš„ Item å¸ƒå±€é‡Œæœ‰ <code>LinearLayout</code> åµŒå¥— <code>LinearLayout</code>ï¼Œå°è¯•ç”¨ <code>ConstraintLayout</code> æŠŠå®ƒæ‹æ‰ã€‚</li>
<li><strong>ä½†æ˜¯...</strong> ï¼šå¯¹äºç‰¹åˆ«ç®€å•çš„ Itemï¼Œ<code>ConstraintLayout</code> çš„æ„å»ºæˆæœ¬åè€Œæ¯” <code>FrameLayout/LinearLayout</code> é«˜ã€‚å¦‚æœåªæ˜¯ç®€å•çš„å›¾æ–‡æ··æ’ï¼Œä¸éœ€è¦å¤æ‚çš„çº¦æŸï¼Œç®€å•çš„ ViewGroup æ€§èƒ½æ›´å¥½ã€‚</li>
<li><strong>ç§»é™¤èƒŒæ™¯è‰²</strong>ï¼šæ£€æŸ¥ Item æ ¹å¸ƒå±€æ˜¯å¦æœ‰ä¸å¿…è¦çš„èƒŒæ™¯è‰²ï¼ˆç‰¹åˆ«æ˜¯ç™½è‰²èƒŒæ™¯ï¼‰ï¼Œè¿™ä¼šå¯¼è‡´ GPU è¿‡åº¦ç»˜åˆ¶ã€‚</li>
</ul>
<h4 data-id="heading-4">4. ç”šè‡³è¿ XML éƒ½ä¸ç”¨ï¼Ÿï¼ˆé«˜çº§æŠ€å·§ï¼‰</h4>
<p>å¦‚æœæ˜¯æè‡´æ€§èƒ½è¦æ±‚ï¼ˆæ¯”å¦‚å³æ—¶é€šè®¯çš„æ¶ˆæ¯åˆ—è¡¨ï¼‰ï¼Œè§£æ XML å¸ƒå±€æœ¬èº«ä¹Ÿæ˜¯ä¸€ç§æ¶ˆè€—ã€‚ æœ‰äº›å¤§å‚ï¼ˆå¦‚ Telegramï¼‰ä¼šç›´æ¥ç”¨ Java/Kotlin ä»£ç æ‰‹å†™ Viewï¼Œæˆ–è€…ä½¿ç”¨ <code>AsyncLayoutInflater</code> åœ¨å­çº¿ç¨‹å¼‚æ­¥åŠ è½½å¸ƒå±€ã€‚ <em>æ³¨ï¼šæ™®é€šé¡¹ç›®ä¸å»ºè®®è¿™ä¹ˆå·ï¼Œç»´æŠ¤æˆæœ¬å¤ªé«˜ã€‚</em></p>
<h4 data-id="heading-5">5. å·§ç”¨ç¼“å­˜ï¼š<code>setItemViewCacheSize</code></h4>
<p>RecyclerView æœ‰ä¸¤çº§ç¼“å­˜ï¼š</p>
<ol>
<li><strong>Scrap/Attached</strong>: å±å¹•å†…çš„ã€‚</li>
<li><strong>CachedViews</strong>: åˆšæ»‘å‡ºå±å¹•çš„ï¼ˆé»˜è®¤æ˜¯ 2 ä¸ªï¼‰ã€‚</li>
<li><strong>RecycledViewPool</strong>: çœŸæ­£çš„å¤ç”¨æ± ã€‚</li>
</ol>
<p>å¦‚æœä½ å‘ç°å›æ»‘ï¼ˆå¾€å›æ»šï¼‰çš„æ—¶å€™ä¼šå¡é¡¿ï¼Œè¯´æ˜ <code>onBindViewHolder</code> è¢«é‡æ–°è§¦å‘äº†ã€‚ä½ å¯ä»¥é€‚å½“è°ƒå¤§ CacheSizeï¼Œä»¥ç©ºé—´æ¢æ—¶é—´ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// å°†åˆšæ»‘å‡ºå±å¹•çš„ç¼“å­˜æ•°é‡ä»é»˜è®¤çš„ 2 å¢åŠ åˆ° 5 æˆ– 10</span>
recyclerView<span class="hljs-selector-class">.setItemViewCacheSize</span>(<span class="hljs-number">10</span>)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>è¿™æ ·ï¼Œå½“ä½ å¿«é€Ÿå›æ»šæ—¶ï¼Œè¿™ 10 ä¸ª Item ä¸éœ€è¦é‡æ–° bind æ•°æ®ï¼Œç›´æ¥æ˜¾ç¤ºã€‚</p>
<h4 data-id="heading-6">6. åµŒå¥— RecyclerView çš„å¤§æ€å™¨ï¼šå…±äº« ViewPool</h4>
<p>è¿™æ˜¯å¾ˆå¤šå¤æ‚é¡µé¢ï¼ˆæ¯”å¦‚ç±»ä¼¼ Play Store æˆ– Netflix çš„é¡µé¢ï¼Œå‚ç›´åˆ—è¡¨ä¸­åµŒå¥—æ°´å¹³åˆ—è¡¨ï¼‰å¡é¡¿çš„å…ƒå‡¶ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªåµŒå¥—çš„å­ RecyclerView éƒ½æœ‰è‡ªå·±çš„ ViewPoolã€‚å½“ç”¨æˆ·å‚ç›´æ»‘åŠ¨æ—¶ï¼Œæ¯ä¸€è¡Œçš„å­ RecyclerView éƒ½åœ¨ä¸åœåœ°åˆ›å»ºå’Œé”€æ¯ ViewHolderã€‚</p>
<p><strong>ä¼˜åŒ–æ–¹æ¡ˆ</strong>ï¼šè®©æ‰€æœ‰å­ RecyclerView å…±ç”¨åŒä¸€ä¸ª <code>RecycledViewPool</code>ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åœ¨å¤–å±‚ Adapter ä¸­</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> viewPool = RecyclerView.RecycledViewPool()

<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onBindViewHolder</span><span class="hljs-params">(holder: <span class="hljs-type">ViewHolder</span>, position: <span class="hljs-type">Int</span>)</span></span> {
    <span class="hljs-comment">// ...</span>
    holder.innerRecyclerView.setRecycledViewPool(viewPool)
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>è¿™èƒ½æå¤§åœ°å‡å°‘å†…å­˜æ³¢åŠ¨å’Œåˆ›å»º View çš„å¼€é”€ã€‚</p>
<h4 data-id="heading-7">7. å›¾ç‰‡åŠ è½½çš„â€œé˜²æŠ–â€</h4>
<p>å¦‚æœåˆ—è¡¨ä¸­æœ‰å¤§é‡é«˜æ¸…å¤§å›¾ï¼Œæ»‘åŠ¨æ—¶åŠ è½½å›¾ç‰‡ä¼šæŠ¢å  CPU èµ„æºã€‚ æˆ‘ä»¬å¯ä»¥ç›‘å¬ RecyclerView çš„æ»‘åŠ¨çŠ¶æ€ï¼š</p>
<ul>
<li><strong>æ»‘åŠ¨æ—¶ï¼ˆSCROLL_STATE_FLINGï¼‰</strong> ï¼šæš‚åœå›¾ç‰‡åŠ è½½æ¡†æ¶ï¼ˆGlide/Coilï¼‰çš„ä»»åŠ¡ã€‚</li>
<li><strong>é™æ­¢æ—¶ï¼ˆSCROLL_STATE_IDLEï¼‰</strong> ï¼šæ¢å¤åŠ è½½ã€‚</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin">recyclerView.addOnScrollListener(<span class="hljs-keyword">object</span> : RecyclerView.OnScrollListener() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onScrollStateChanged</span><span class="hljs-params">(recyclerView: <span class="hljs-type">RecyclerView</span>, newState: <span class="hljs-type">Int</span>)</span></span> {
        <span class="hljs-keyword">if</span> (newState == RecyclerView.SCROLL_STATE_IDLE) {
            Glide.with(context).resumeRequests()
        } <span class="hljs-keyword">else</span> {
            Glide.with(context).pauseRequests()
        }
    }
})
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-8">8. ç®€å•çš„å›ºå®šé«˜åº¦ï¼š<code>setHasFixedSize(true)</code></h4>
<p>è¿™å¯èƒ½æ˜¯æœ€ç®€å•çš„ä¸€è¡Œä»£ç ä¼˜åŒ–ã€‚å¦‚æœä½ çš„åˆ—è¡¨ Item é«˜åº¦æ˜¯å›ºå®šçš„ï¼ˆä¸ä¼šå› ä¸ºæ•°æ®å†…å®¹å˜åŒ–è€Œå¿½å¤§å¿½å°ï¼‰ï¼Œè¯·åŠ¡å¿…è®¾ç½®ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">recyclerView.<span class="hljs-built_in">setHasFixedSize</span>(<span class="hljs-literal">true</span>)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>è¿™å‘Šè¯‰ RecyclerViewï¼šâ€œæˆ‘çš„ Item å¤§å°ä¸ä¼šå˜ï¼Œä½ åœ¨é‡æ–°å¸ƒå±€çš„æ—¶å€™ä¸éœ€è¦é‡æ–°è®¡ç®—æˆ‘çš„å®½é«˜ã€‚â€è¿™èƒ½é¿å…å¤§é‡çš„é‡å¤æµ‹é‡å·¥ä½œã€‚</p>
<h4 data-id="heading-9">æ€»ç»“</h4>
<p>ä¼˜åŒ– RecyclerView å…¶å®å°±æ˜¯ä¸€åœº<strong>ä¸ 16msï¼ˆ60fpsï¼‰çš„èµ›è·‘</strong>ã€‚</p>
<ol>
<li><strong>é€»è¾‘å±‚é¢</strong>ï¼šç”¨ <code>DiffUtil</code> æ›¿ä»£å…¨é‡åˆ·æ–°ã€‚</li>
<li><strong>ä»£ç å±‚é¢</strong>ï¼š<code>onBind</code> è¶Šè½»è¶Šå¥½ã€‚</li>
<li><strong>å¸ƒå±€å±‚é¢</strong>ï¼šå‡å°‘å±‚çº§ï¼Œå…±ç”¨ Poolã€‚</li>
<li><strong>é…ç½®å±‚é¢</strong>ï¼š<code>setHasFixedSize</code>ï¼Œè°ƒæ•´ Cacheã€‚</li>
</ol>
<p>æŠŠè¿™å‡ ç‚¹åšåˆ°ä½ï¼Œä½ çš„åˆ—è¡¨ç»å¯¹èƒ½ä»â€œæ‹–æ‹‰æœºâ€å˜æˆâ€œç£æ‚¬æµ®â€ã€‚</p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æƒ³è¦è¯•è¯•ç”¨ArkTSå†™å‡ºä¸æ»‘çš„é¸¿è’™è½¯ä»¶å—ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7603246733317029942</link>    <guid>https://juejin.cn/post/7603246733317029942</guid>    <pubDate>2026-02-05T14:49:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603246733317029942" data-draft-id="7602900131541516329" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æƒ³è¦è¯•è¯•ç”¨ArkTSå†™å‡ºä¸æ»‘çš„é¸¿è’™è½¯ä»¶å—ï¼Ÿ"/> <meta itemprop="keywords" content="HarmonyOS"/> <meta itemprop="datePublished" content="2026-02-05T14:49:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç é£ä¸€ä¼šå„¿"/> <meta itemprop="url" content="https://juejin.cn/user/555695627842490"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æƒ³è¦è¯•è¯•ç”¨ArkTSå†™å‡ºä¸æ»‘çš„é¸¿è’™è½¯ä»¶å—ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/555695627842490/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç é£ä¸€ä¼šå„¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T14:49:17.000Z" title="Thu Feb 05 2026 14:49:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ArkTS æ˜¯é¸¿è’™åº”ç”¨çš„å¼€å‘è¯­è¨€ã€‚å®ƒåœ¨ä¿æŒ TypeScriptåŸºæœ¬è¯­æ³•é£æ ¼çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡è§„èŒƒå¼ºåŒ–é™æ€æ£€æŸ¥å’Œåˆ†æï¼Œæå‡ä»£ç å¥å£®æ€§ã€‚è€ŒArkUI æ˜¯ä¸€å¥—æ„å»ºåˆ†å¸ƒå¼åº”ç”¨ç•Œé¢çš„å£°æ˜å¼ UI å¼€å‘æ¡†æ¶ï¼Œé€šè¿‡ç®€æ´çš„è¯­æ³•ã€ä¸°å¯Œçš„ç»„ä»¶ã€å®æ—¶é¢„è§ˆå·¥å…·ï¼Œæå‡åº”ç”¨ç•Œé¢å¼€å‘æ•ˆç‡ã€‚</p>
<blockquote>
<p>ä»¥ä¸‹å†…å®¹å‡è®¾è¯»è€…æœ‰typescriptå’ŒJavaScriptåŸºç¡€ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€æ•°æ®ç±»å‹</h2>
<ol>
<li>å­—ç¬¦å‹ï¼šstring</li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>:<span class="hljs-built_in">string</span> = <span class="hljs-string">'hello'</span>
</code></pre>
<ol start="2">
<li>æ•°å­—å‹ï¼šnumber</li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">b</span>:<span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>
</code></pre>
<ol start="3">
<li>å¸ƒå°”å‹ï¼šboolean</li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">c</span>:<span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span>
</code></pre>
<p>æ€»ç»“ï¼šlet å˜é‡å:æ•°æ®ç±»å‹ = å€¼</p>
<blockquote>
<p>ä½¿ç”¨console.log(å˜é‡å)ï¼Œå¯ä»¥æ‰“å°å˜é‡ã€‚</p>
</blockquote>
<h2 data-id="heading-1">äºŒã€æ•°ç»„ï¼šä¸€æ¬¡æ€§å­˜å‚¨å¤šä¸ªç›¸åŒç±»å‹æ•°æ®</h2>
<p>Â Â Â Â Â Â Â Â ä½¿ç”¨ï¼šlet æ•°ç»„å:ç±»å‹å[] = [æ•°æ®1,æ•°æ®2,æ•°æ®3,......]</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">let</span> <span class="hljs-title class_">Narray</span>:<span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]
<span class="hljs-keyword">let</span> <span class="hljs-title class_">Sarray</span>:<span class="hljs-built_in">string</span>[] = [<span class="hljs-string">'ä¸€'</span>,<span class="hljs-string">'one'</span>,<span class="hljs-string">'äºŒ'</span>,<span class="hljs-string">'two'</span>]
<span class="hljs-keyword">let</span> <span class="hljs-title class_">Barray</span>:<span class="hljs-built_in">boolean</span>[]=[<span class="hljs-literal">true</span>,<span class="hljs-literal">false</span>,<span class="hljs-literal">true</span>,<span class="hljs-literal">false</span>]
</code></pre>
<p>æ•°ç»„å¼•ç”¨ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title class_">Narray</span>[<span class="hljs-number">0</span>]
<span class="hljs-title class_">Sarray</span>[<span class="hljs-number">1</span>]
<span class="hljs-title class_">Barray</span>[<span class="hljs-number">3</span>]
</code></pre>
<h2 data-id="heading-2">ä¸‰ã€å¯¹è±¡ï¼šä¸€æ¬¡æ€§å­˜å‚¨å¤šä¸ªä¸åŒç±»å‹æ•°æ®</h2>
<p>æ­¥éª¤ï¼šï¼ˆ1ï¼‰å®šä¹‰æ¥å£ï¼šinterface æ¥å£å={å±æ€§å:å±æ€§æ•°æ®ç±»å‹,â€¦â€¦}</p>
<p>Â Â Â Â Â Â Â Â Â Â Â Â ï¼ˆ2ï¼‰ä½¿ç”¨æ¥å£å®šä¹‰å¯¹è±¡ï¼šlet å¯¹è±¡å:æ¥å£å ={å±æ€§å:å±æ€§å€¼,â€¦â€¦}</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">interface</span>  demo{
  <span class="hljs-attr">name</span>:<span class="hljs-built_in">string</span>
  <span class="hljs-attr">age</span>:<span class="hljs-built_in">number</span>
}
<span class="hljs-keyword">let</span> <span class="hljs-attr">info</span>:demo ={
  <span class="hljs-attr">name</span>:<span class="hljs-string">'Bob'</span>,
  <span class="hljs-attr">age</span>:<span class="hljs-number">10</span>
}
</code></pre>
<p>è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">info.<span class="hljs-property">name</span>
info.<span class="hljs-property">age</span>
</code></pre>
<blockquote>
<p>å¦‚æœè°ƒç”¨æ•´ä¸ªå¯¹è±¡ï¼Œåªä¼šæ˜¾ç¤ºå¯¹è±¡ç±»å‹ï¼Œä¸ä¼šæ˜¾ç¤ºå€¼</p>
</blockquote>
<h2 data-id="heading-3">å››ã€å‡½æ•°ï¼šå°è£…é‡å¤æ€§ä»£ç æé«˜æ•ˆç‡</h2>
<p>æ­¥éª¤ï¼ˆ1ï¼‰å®šä¹‰å‡½æ•°ï¼šfunction å‡½æ•°å(å½¢å¼å‚æ•°åˆ—è¡¨) {å‡½æ•°ä½“}</p>
<blockquote>
<p>å½¢å¼å‚æ•°åˆ—è¡¨å½¢å¼ï¼šå½¢å¼å‚æ•°1:æ•°æ®ç±»å‹,å½¢å¼å‚æ•°2:æ•°æ®ç±»å‹â€¦â€¦</p>
<p>å‡½æ•°å¯ä»¥æ²¡æœ‰å½¢å¼å‚æ•°</p>
<p>å‡½æ•°ä½“å¯ä»¥æ²¡æœ‰è¿”å›å€¼</p>
</blockquote>
<p>Â Â Â Â Â Â Â Â ï¼ˆ2ï¼‰ä½¿ç”¨å‡½æ•°ï¼šå‡½æ•°å(å®é™…å‚æ•°åˆ—è¡¨)</p>
<p>å®šä¹‰ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">function</span> <span class="hljs-title function_">addNumber</span>(<span class="hljs-params">first:<span class="hljs-built_in">number</span>,second:<span class="hljs-built_in">number</span></span>){
  <span class="hljs-keyword">return</span> first+second
}
</code></pre>
<p>è°ƒç”¨ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title function_">addNumber</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)
</code></pre>
<p>æ²¡æœ‰å½¢å¼å‚æ•°å’Œè¿”å›å€¼çš„å‡½æ•°ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">function</span> <span class="hljs-title function_">printInfo</span>(<span class="hljs-params"/>){
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ—¥å¿—æ‰“å°'</span>)
}
<span class="hljs-title function_">printInfo</span>()
</code></pre>
<p>ç®­å¤´å‡½æ•°å½¢å¼ï¼šlet å‡½æ•°å = (å½¢å¼å‚æ•°åˆ—è¡¨)=&gt; {å‡½æ•°ä½“}</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">let</span> <span class="hljs-title function_">addNumber2</span> = (<span class="hljs-params">first:<span class="hljs-built_in">number</span>,second:<span class="hljs-built_in">number</span></span>) =&gt; { 
  <span class="hljs-keyword">return</span> first + second 
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">addNumber2</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>).<span class="hljs-title function_">toString</span>())
</code></pre>
<h2 data-id="heading-4">äº”ã€ç»„ä»¶</h2>




















<table><thead><tr><th>åˆ†ç±»</th><th>å®¹å™¨ç»„ä»¶</th><th>å†…å®¹ç»„ä»¶</th></tr></thead><tbody><tr><td>ä½¿ç”¨</td><td>ç»„ä»¶å(){}</td><td>ç»„ä»¶å()</td></tr><tr><td>ç¤ºä¾‹</td><td>Column(){}//çºµå‘æ’åˆ—ç»„ä»¶<br/>Row(){}//æ¨ªå‘æ’åˆ—ç»„ä»¶</td><td>Text('å†…å®¹')</td></tr></tbody></table>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {

  <span class="hljs-comment">//buildé‡Œé¢è¦æœ‰å”¯ä¸€å®¹å™¨æ ¹ç»„ä»¶</span>
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
      <span class="hljs-title class_">Column</span>(){
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'ä¸€'</span>)
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'äºŒ'</span>)
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'ä¸‰'</span>)
      }
  }
}
</code></pre>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a24f078b48544e6aa9e3fe53678f5f9d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770907757&amp;x-signature=YygU%2F3BgGzgSZHhtEOlsKtSMrs0%3D" alt="2026-01-28-17-48-38-image.png" loading="lazy"/></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {

  <span class="hljs-comment">//buildé‡Œé¢è¦æœ‰å”¯ä¸€å®¹å™¨æ ¹ç»„ä»¶</span>
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
      <span class="hljs-title class_">Row</span>(){
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'ä¸€'</span>)
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'äºŒ'</span>)
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'ä¸‰'</span>)
      }
  }
}
</code></pre>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4cfbbe7e5084425a80517a7431beacfc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770907757&amp;x-signature=IQu1fREsHH7N8W7%2FEqnsZw89pho%3D" alt="2026-01-28-17-49-49-image.png" loading="lazy"/></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>(){
      <span class="hljs-title class_">Column</span>(){
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'ä¸€'</span>)
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'äºŒ'</span>)
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'ä¸‰'</span>)
      }
      <span class="hljs-title class_">Row</span>(){
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'ä¸€'</span>)
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'äºŒ'</span>)
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'ä¸‰'</span>)
      }
    }
  }
}
</code></pre>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c5280c8a35c842d981448db9b2e9b862~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770907757&amp;x-signature=VNdirMuOVlq39Jdo4QNzFwPfJRs%3D" alt="2026-01-28-17-50-46-image.png" loading="lazy"/></p>
<blockquote>
<p>buildé‡Œé¢çš„å®¹å™¨æ ¹ç»„ä»¶å”¯ä¸€</p>
</blockquote>
<h3 data-id="heading-5">ï¼ˆä¸€ï¼‰å›¾åƒç»„ä»¶</h3>
<p>Image(æ–‡ä»¶è·¯å¾„)</p>
<p>æœ¬åœ°ï¼š<code>$r('app.media.æ–‡ä»¶å')</code></p>
<blockquote>
<p>æœ¬åœ°å›¾ç‰‡å®é™…å¯¹åº”åº”æ”¾åœ¨<code>entry\src\main\resources\base\media</code>ä¸‹</p>
</blockquote>
<p>ç½‘ç»œï¼š<code>http://xxx.xxx</code></p>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>(){
      <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.test'</span>))
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">300</span>)
      <span class="hljs-title class_">Image</span>(<span class="hljs-string">'https://www.huawei.com/-/media/hcomponent-header/1.0.1.20251208095539/component/img/huawei_logo.png'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">200</span>)
    }
  }
}
</code></pre>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab97c55a9a09453fbdd96e905012effb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770907757&amp;x-signature=IE8ar90lGHF5Euui30QlZshZ70w%3D" alt="2026-01-29-16-16-11-image.png" loading="lazy"/></p>
<h3 data-id="heading-6">ï¼ˆäºŒï¼‰åˆ—è¡¨ç»„ä»¶</h3>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'çŒœä½ å–œæ¬¢'</span>)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })
      <span class="hljs-title class_">List</span>() {
        <span class="hljs-title class_">ListItem</span>() {
          <span class="hljs-title class_">Row</span>() {
            <span class="hljs-comment">//å›¾ç‰‡</span>
            <span class="hljs-title class_">Image</span>(<span class="hljs-string">'http://p2.music.126.net/CDhYcShQKH2VAMENuCxWWQ==/109951164166513349.jpg?param=130y130'</span>)
              .<span class="hljs-title function_">width</span>(<span class="hljs-number">80</span>)
              .<span class="hljs-title function_">border</span>({<span class="hljs-attr">radius</span>:<span class="hljs-number">8</span>})
              .<span class="hljs-title function_">margin</span>({<span class="hljs-attr">right</span>:<span class="hljs-number">10</span>})
            <span class="hljs-comment">//æ–‡å­—</span>
            <span class="hljs-title class_">Column</span>(){
              <span class="hljs-title class_">Text</span>(<span class="hljs-string">'æ‚¬æºº'</span>)
                .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#f3f3f3'</span>)
                .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
                .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-number">700</span>)
                .<span class="hljs-title function_">margin</span>({<span class="hljs-attr">bottom</span>:<span class="hljs-number">15</span>})
              <span class="hljs-title class_">Row</span>(){
                <span class="hljs-title class_">Text</span>(<span class="hljs-string">'VIP'</span>)
                  .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#9a8e28'</span>)
                  .<span class="hljs-title function_">border</span>({<span class="hljs-attr">width</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">color</span>:<span class="hljs-string">'#9a8e28'</span>,<span class="hljs-attr">radius</span>:<span class="hljs-number">12</span>})
                  .<span class="hljs-title function_">padding</span>({<span class="hljs-attr">left</span>:<span class="hljs-number">5</span>,<span class="hljs-attr">right</span>:<span class="hljs-number">5</span>,<span class="hljs-attr">top</span>:<span class="hljs-number">3</span>,<span class="hljs-attr">bottom</span>:<span class="hljs-number">3</span>})
                  .<span class="hljs-title function_">margin</span>({<span class="hljs-attr">right</span>:<span class="hljs-number">10</span>})
                <span class="hljs-title class_">Text</span>(<span class="hljs-string">'è‘›ä¸œçª'</span>)
                  .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#696969'</span>)
              }
              .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)<span class="hljs-comment">//å·¦å¯¹é½</span>
            }
            .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)<span class="hljs-comment">//å ç”¨å‰©ä¸‹æ‰€æœ‰ç©ºé—´</span>
            <span class="hljs-comment">//æ›´å¤š</span>
            <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.ic_more'</span>))
              .<span class="hljs-title function_">width</span>(<span class="hljs-number">24</span>)
              .<span class="hljs-title function_">fillColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)<span class="hljs-comment">//svgå¡«å……é¢œè‰²</span>
          }
          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">80</span>)
          <span class="hljs-comment">//.backgroundColor(Color.Pink)</span>
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })
        }
      }.<span class="hljs-title function_">scrollBar</span>(<span class="hljs-title class_">BarState</span>.<span class="hljs-property">Off</span>)<span class="hljs-comment">//æ»šåŠ¨æ¡çŠ¶æ€ï¼ˆè‡ªåŠ¨ã€å¼€ã€å…³ï¼‰</span>
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#131313'</span>)
    .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">10</span> })
    .<span class="hljs-title function_">expandSafeArea</span>([<span class="hljs-title class_">SafeAreaType</span>.<span class="hljs-property">SYSTEM</span>], [<span class="hljs-title class_">SafeAreaEdge</span>.<span class="hljs-property">TOP</span>, <span class="hljs-title class_">SafeAreaEdge</span>.<span class="hljs-property">BOTTOM</span>]) <span class="hljs-comment">//æ‰©å……ç»„ä»¶å®‰å…¨åŒºåŸŸ</span>
  }
}
</code></pre>
<p>ä½¿ç”¨List(){}åŒ…å«ç»„ä»¶å½¢æˆä¸€ä¸ªåˆ—è¡¨ï¼Œæ¯ä¸€æ¡ç”¨ListItem(){}å®ç°ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title class_">List</span>() {
        <span class="hljs-title class_">ListItem</span>() {
        <span class="hljs-comment">//è¯¦ç»†å†…å®¹</span>
        }
}
</code></pre>
<blockquote>
<p>ä½¿ç”¨<code>.listDirection</code>å¯ä»¥æ§åˆ¶æ–¹å‘</p>
</blockquote>
<h3 data-id="heading-7">ï¼ˆä¸‰ï¼‰å±‚å å¸ƒå±€ç»„ä»¶</h3>
<p>ä½¿ç”¨æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title class_">Stack</span>(){
    ç»„ä»¶<span class="hljs-number">1</span>
    ç»„ä»¶<span class="hljs-number">2</span>
}
</code></pre>
<blockquote>
<p>æŠŠè¦å åŠ çš„ç»„ä»¶æ”¾åœ¨{}é‡Œé¢ï¼Œå³å¯å åŠ åœ¨ä¸€èµ·</p>
<p>ä½¿ç”¨<code>Stack({ alignContent: Alignment. TopEnd })</code>å¯ä»¥è®¾ç½®ç»„ä»¶å±‚å å¯¹é½æ–¹å¼</p>
</blockquote>
<h3 data-id="heading-8">ï¼ˆå››ï¼‰Tabç»„ä»¶</h3>
<p>ä½¿ç”¨æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title class_">Tabs</span>({<span class="hljs-attr">barPosition</span>: <span class="hljs-title class_">BarPosition</span>. å¯¹é½ä½ç½®}) {
Â Â Â Â <span class="hljs-title class_">TabContent</span>(){
Â Â Â Â Â Â Â Â <span class="hljs-comment">// å†…å®¹</span>
Â Â Â Â }
Â Â Â Â .<span class="hljs-title function_">tabBar</span>() <span class="hljs-comment">//èœå•</span>
}
</code></pre>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Tabs</span>({ <span class="hljs-attr">barPosition</span>: <span class="hljs-title class_">BarPosition</span>.<span class="hljs-property">End</span> }) {
      <span class="hljs-title class_">ForEach</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>], <span class="hljs-function">(<span class="hljs-params">index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
        <span class="hljs-title class_">TabContent</span>() {
          <span class="hljs-title class_">Text</span>(<span class="hljs-string">'å†…å®¹'</span> + index)
        }
        .<span class="hljs-title function_">tabBar</span>(<span class="hljs-string">'èœå•'</span> + index)
      })
    }
  }
}
</code></pre>
<p>ç»“æœï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c017be891af149d6b7b88ddaa851effb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770907757&amp;x-signature=%2FKTjgovLps7cYlvRBtqNpP8uhYY%3D" alt="2026-02-04-10-17-56-image.png" loading="lazy"/></p>
<blockquote>
<p>å¯ä»¥ä½¿ç”¨onChangeæ§åˆ¶ç‚¹å‡»çš„å˜åŒ–</p>
</blockquote>
<h3 data-id="heading-9">ï¼ˆäº”ï¼‰è¾“å…¥æ¡†ç»„ä»¶</h3>
<p>ä½¿ç”¨æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title class_">TextInput</span>({ <span class="hljs-attr">placeholder</span>:<span class="hljs-string">'æç¤ºä¿¡æ¯'</span>})
Â·<span class="hljs-title function_">placeholderColor</span>(â€˜æç¤ºä¿¡æ¯è‰²å€¼â€™)
</code></pre>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>(){
      <span class="hljs-title class_">TextInput</span>({<span class="hljs-attr">placeholder</span>:<span class="hljs-string">'è¯·è¾“å…¥â€¦â€¦'</span>})
        .<span class="hljs-title function_">placeholderColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Brown</span>)
    }
    .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)
  }
}
</code></pre>
<p>ç»“æœï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25b20ee3d5fc47a68679e03f1ce4106e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770907757&amp;x-signature=ZHtbyH04Dz8dfjrR9FAvEaGBNMg%3D" alt="2026-02-04-10-54-04-image.png" loading="lazy"/></p>
<h3 data-id="heading-10">ï¼ˆå…­ï¼‰è½®æ’­å›¾ç»„ä»¶</h3>
<p>ä½¿ç”¨æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title class_">Swiper</span>() {
    <span class="hljs-comment">// å†…å®¹</span>
}
.<span class="hljs-title function_">autoPlay</span>(<span class="hljs-literal">true</span>)<span class="hljs-comment">//è‡ªåŠ¨æ’­æ”¾</span>
</code></pre>
<blockquote>
<p>å†…å®¹å¯ä»¥ä½¿ç”¨ForEachå¾ªç¯æ¸²æŸ“</p>
</blockquote>
<h2 data-id="heading-11">å…­ã€å±æ€§</h2>
<p>ä½¿ç”¨æ–¹æ³•ï¼šç»„ä»¶.å±æ€§(å€¼)</p>
<h3 data-id="heading-12">ï¼ˆä¸€ï¼‰ é€šç”¨å±æ€§</h3>
<p>å¸¸ç”¨é€šç”¨å±æ€§ï¼š</p>





























<table><thead><tr><th>å±æ€§å</th><th>ä½œç”¨</th><th>å±æ€§å€¼</th><th>æ³¨æ„äº‹é¡¹</th></tr></thead><tbody><tr><td>width</td><td>å®½åº¦(å·¦å¯¹é½)</td><td>æ•°å€¼ï¼ˆvpï¼‰</td><td>æœ€å¤§ï¼š360æˆ–100%</td></tr><tr><td>height</td><td>é«˜åº¦</td><td>æ•°å€¼ï¼ˆvpï¼‰</td><td>æœ€å¤§ï¼š360æˆ–100%</td></tr><tr><td>backgroundColor</td><td>èƒŒæ™¯è‰²</td><td>å†…ç½®é¢œè‰²æˆ–åå…­è¿›åˆ¶å€¼</td><td/></tr></tbody></table>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {

  <span class="hljs-comment">//buildé‡Œé¢è¦æœ‰å”¯ä¸€å®¹å™¨æ ¹ç»„ä»¶</span>
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>(){
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'æ–‡æœ¬'</span>)
        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Orange</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
      <span class="hljs-title class_">Row</span>(){}
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">300</span>)<span class="hljs-comment">//æ»¡å±360</span>
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)
        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#ff6600'</span>)
    }
  }
}
</code></pre>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc79a3f105bd45d08ae2b141fc3c5e1a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770907757&amp;x-signature=3cRvvkIdQKQq0Bjlq3fLuGVkjAU%3D" alt="2026-01-29-15-03-40-image.png" loading="lazy"/></p>
<h3 data-id="heading-13">ï¼ˆäºŒï¼‰æ–‡æœ¬å±æ€§</h3>
<p>å¸¸ç”¨ï¼š</p>



































<table><thead><tr><th>å±æ€§å</th><th>ä½œç”¨</th><th>å±æ€§å€¼</th></tr></thead><tbody><tr><td>fontSize</td><td>å­—ä½“å¤§å°</td><td>æ•°å€¼ï¼ˆfp)</td></tr><tr><td>fontColor</td><td>å­—ä½“é¢œè‰²</td><td>å†…ç½®é¢œè‰²æˆ–åå…­è¿›åˆ¶å€¼</td></tr><tr><td>fontWeight</td><td>å­—ä½“ç²—ç»†</td><td>100~900ï¼ˆé»˜è®¤400ï¼‰</td></tr><tr><td>MaxLines</td><td>æœ€å¤§è¡Œæ•°</td><td>æ•°å€¼</td></tr><tr><td>textOverFlow</td><td>ç§»é™¤æ˜¾ç¤º</td><td>å¤šç§ï¼Œæ ¹æ®å®é™…é€‰æ‹©</td></tr></tbody></table>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>(){
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'æµ‹è¯•ç»„ä»¶'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-number">800</span>)
    }
  }
}
</code></pre>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e379e1e2ed64e638431b304384aed5b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770907757&amp;x-signature=JZ0a53%2FL%2F8sv9kCSvsmd9ik%2FJN4%3D" alt="2026-01-29-15-08-41-image.png" loading="lazy"/></p>
## ï¼ˆä¸‰ï¼‰è¾¹è·å±æ€§
<p>å¤–è¾¹è·ï¼š<code>margin</code> å†…è¾¹è· ï¼š<code>padding</code></p>
<ol>
<li>å››ä¸ªæ–¹å‘ç›¸åŒï¼š</li>
</ol>
<pre><code class="hljs language-ts" lang="ts">ç»„ä»¶
    Â·<span class="hljs-title function_">padding</span>(æ•°å€¼)
    Â·<span class="hljs-title function_">margin</span>(æ•°å€¼)
</code></pre>
<ol start="2">
<li>å››ä¸ªæ–¹å‘ä¸åŒï¼š</li>
</ol>
<pre><code class="hljs language-ts" lang="ts">ç»„ä»¶
   .<span class="hljs-title function_">padding</span>({<span class="hljs-attr">top</span>: å€¼, <span class="hljs-attr">bottom</span>: å€¼, <span class="hljs-attr">left</span>: å€¼, <span class="hljs-attr">right</span>: å€¼})
   .<span class="hljs-title function_">margin</span>({<span class="hljs-attr">top</span>: å€¼, <span class="hljs-attr">bottom</span>: å€¼, <span class="hljs-attr">left</span>: å€¼, <span class="hljs-attr">right</span>: å€¼})
</code></pre>
<p>åŸå§‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'ç™»å½•'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'æ³¨å†Œ'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Gray</span>)
    }
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#DDDDDD'</span>)

  }
}
</code></pre>
<p>ç»“æœï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3fac4300405746f6a679233d292001a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770907757&amp;x-signature=upI8%2F4IM%2FkSlkSk9Up0lqbYwirY%3D" alt="2026-01-31-10-01-32-image.png" loading="lazy"/></p>
<p>åŠ å…¥å†…è¾¹è·ï¼Œå’Œè¾¹ç¼˜åˆ†ç¦»ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'ç™»å½•'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'æ³¨å†Œ'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Gray</span>)
    }
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#DDDDDD'</span>)
    .<span class="hljs-title function_">padding</span>({
      <span class="hljs-attr">left</span>: <span class="hljs-number">10</span>,
      <span class="hljs-attr">top</span>: <span class="hljs-number">20</span>,
      <span class="hljs-attr">right</span>: <span class="hljs-number">30</span>,
      <span class="hljs-attr">bottom</span>: <span class="hljs-number">40</span>
    })
  }
}
</code></pre>
<p>ç»“æœï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f5bd341451a4aa3818699eb721d7cb0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770907757&amp;x-signature=s3ftHCBkVQeLlohimpXfVeGjgeQ%3D" alt="2026-01-31-10-02-50-image.png" loading="lazy"/></p>
<p>åŠ å…¥å¤–è¾¹è·åˆ†ç¦»ä¸¤ä¸ªæŒ‰é’®ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'ç™»å½•'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">20</span> })
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'æ³¨å†Œ'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Gray</span>)
    }
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#DDDDDD'</span>)
    .<span class="hljs-title function_">padding</span>({
      <span class="hljs-attr">left</span>: <span class="hljs-number">10</span>,
      <span class="hljs-attr">top</span>: <span class="hljs-number">20</span>,
      <span class="hljs-attr">right</span>: <span class="hljs-number">30</span>,
      <span class="hljs-attr">bottom</span>: <span class="hljs-number">40</span>
    })
  }
}
</code></pre>
<p>ç»“æœï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff7725ec37014b52b8064da4280ed63e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770907757&amp;x-signature=Nq3nYCnlsvXlcjpT8LHmRHSPveY%3D" alt="2026-01-31-10-05-34-image.png" loading="lazy"/></p>
<h3 data-id="heading-14">ï¼ˆå››ï¼‰è¾¹æ¡†å±æ€§</h3>
<pre><code class="hljs language-ts" lang="ts">ç»„ä»¶
    .<span class="hljs-title function_">border</span>({<span class="hljs-attr">width</span>:ç²—ç»†,<span class="hljs-attr">color</span>:é¢œè‰²,<span class="hljs-attr">style</span>:çº¿æ¡æ ·å¼,<span class="hljs-attr">radius</span>:åœ†è§’})
</code></pre>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'ç‚¹èµ'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">60</span>)
        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span>)
        .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)
        .<span class="hljs-title function_">border</span>({
          <span class="hljs-attr">width</span>: <span class="hljs-number">2</span>,
          <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span>,
          <span class="hljs-attr">style</span>: <span class="hljs-title class_">BorderStyle</span>.<span class="hljs-property">Dotted</span>,
          <span class="hljs-attr">radius</span>: <span class="hljs-number">30</span>
        })
    }
    .<span class="hljs-title function_">padding</span>(<span class="hljs-number">20</span>)
  }
}
</code></pre>
<p>æ•ˆæœï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f54bc4a45cf3448db6ebebb620ed7102~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770907757&amp;x-signature=1HUPJ8Vuoz7TRjv3g%2BpFxP43%2FRw%3D" alt="2026-01-31-10-16-01-image.png" loading="lazy"/></p>
<blockquote>
<p>ä½¿ç”¨<code>.clip(true)</code>æ¥è£å‰ªå†…éƒ¨ä»¥è´´åˆå¤–ç»„ä»¶è¾¹æ¡†</p>
</blockquote>
<h3 data-id="heading-15">ï¼ˆäº”ï¼‰å®‰å…¨åŒºåŸŸå±æ€§</h3>
<pre><code class="hljs language-ts" lang="ts">.<span class="hljs-title function_">expandSafeArea</span>([<span class="hljs-title class_">SafeAreaType</span>.<span class="hljs-property">SYSTEM</span>], [<span class="hljs-title class_">SafeAreaEdge</span>.<span class="hljs-property">TOP</span>, <span class="hljs-title class_">SafeAreaEdge</span>.<span class="hljs-property">BOTTOM</span>])
</code></pre>
<blockquote>
<p>å¯ä»¥å°†å®‰å…¨åŒºåŸŸä»ä¸¤è¾¹ç•™ç™½æ‰©å±•åˆ°æ•´ä¸ªå±å¹•</p>
<p>TOPè®¾ç½®æ‰©å±•åˆ°é¡¶éƒ¨ï¼ˆé€šçŸ¥æ ï¼‰</p>
<p>BOTTOMè®¾ç½®æ‰©å±•åˆ°åº•éƒ¨ï¼ˆä»»åŠ¡æ ï¼‰</p>
</blockquote>
<h3 data-id="heading-16">ï¼ˆå…­ï¼‰æ»šåŠ¨æ¡å±æ€§</h3>
<pre><code class="hljs language-ts" lang="ts">.<span class="hljs-title function_">scrollBar</span>(<span class="hljs-title class_">BarState</span>.<span class="hljs-property">Off</span>)
</code></pre>
<blockquote>
<p>å¯ä»¥è®¾ç½®Onã€Offã€Autoï¼Œæ§åˆ¶æ»šåŠ¨æ¡çš„æ˜¾ç¤ºä¸å¦</p>
</blockquote>
<h3 data-id="heading-17">ï¼ˆä¸ƒï¼‰æ‰©å±•å¡«å……å±æ€§</h3>
<pre><code class="hljs language-ts" lang="ts">.<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)
</code></pre>
<blockquote>
<p>è®¾ç½®1å³æ‰©å±•å¡«å……å‰©ä½™æ‰€æœ‰çš„ç©ºé—´ï¼Œ0åˆ™ä¸å¡«å……</p>
</blockquote>
<h3 data-id="heading-18">ï¼ˆå…«ï¼‰é¢œè‰²å¡«å……å±æ€§</h3>
<pre><code class="hljs language-ts" lang="ts">.<span class="hljs-title function_">fillColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
</code></pre>
<blockquote>
<p>å¯ä»¥ä¿®æ”¹å›¾ç‰‡å¡«å……é¢œè‰²ï¼Œæœ€å¥½æ˜¯svgæ ¼å¼çš„ï¼Œä¸€èˆ¬ç”¨äºImageç»„ä»¶</p>
</blockquote>
<h2 data-id="heading-19">ä¸ƒã€ç»“æ„è¯­å¥</h2>
<h3 data-id="heading-20">ï¼ˆä¸€ï¼‰ifåˆ†æ”¯è¯­å¥</h3>
<p>ä½¿ç”¨æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">if</span> (æ¡ä»¶<span class="hljs-number">1</span>) {
  <span class="hljs-comment">//æ¡ä»¶1æ»¡è¶³æ—¶æ‰§è¡Œä»£ç </span>
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (æ¡ä»¶<span class="hljs-number">2</span>) {
  <span class="hljs-comment">//æ¡ä»¶1ä¸æ»¡è¶³æ‰§è¡Œä»£ç ï¼Œæ¡ä»¶2æ»¡è¶³æ—¶æ‰§è¡Œä»£ç </span>
} <span class="hljs-keyword">else</span> {
  <span class="hljs-comment">//æ¡ä»¶å‡æ»¡è¶³æ—¶æ‰§è¡Œä»£ç </span>
}
</code></pre>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">score</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">58</span>
<span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">80</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç­‰çº§ï¼šA'</span>)
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">70</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç­‰çº§ï¼šB'</span>)
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">60</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç­‰çº§ï¼šC'</span>)
} <span class="hljs-keyword">else</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸åŠæ ¼ï¼'</span>)
}
</code></pre>
<blockquote>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå¯ç”¨äºæ¡ä»¶æ¸²æŸ“ï¼Œæ ¹æ®éœ€è¦æ˜¾ç¤ºä¸åŒå†…å®¹</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">20</span>

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-keyword">if</span> (<span class="hljs-number">1</span> === num) {
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'æ–‡æœ¬1'</span>)
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-number">2</span> === num) {
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'æ–‡æœ¬2'</span>)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'æ— æ–‡æœ¬'</span>)
      }
    }
  }
}
</code></pre>
</blockquote>
<h3 data-id="heading-21">ï¼ˆäºŒï¼‰æ¡ä»¶è¡¨è¾¾å¼è¯­å¥</h3>
<pre><code class="hljs language-ts" lang="ts">æ¡ä»¶?æ¡ä»¶æˆç«‹çš„è¡¨è¾¾å¼:æ¡ä»¶ä¸æˆç«‹çš„è¡¨è¾¾å¼
</code></pre>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">num1</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">num2</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">20</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">result</span>: <span class="hljs-built_in">number</span> = num1 &gt; num2 ? num1 : num2
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ€å¤§å€¼æ˜¯'</span>, result);
</code></pre>
<blockquote>
<p>å¯ç”¨äºæ¡ä»¶æ¸²æŸ“</p>
</blockquote>
<h3 data-id="heading-22">ï¼ˆä¸‰ï¼‰å¾ªç¯æ¸²æŸ“è¯­å¥</h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title class_">ForEach</span>(æ•°ç»„,<span class="hljs-function">(<span class="hljs-params">item:ç±»å‹,index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
    ç»„ä»¶
})
</code></pre>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>[] = [<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-string">'æå››'</span>, <span class="hljs-string">'ç‹äº”'</span>]

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">ForEach</span>(name, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">string</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
        <span class="hljs-title class_">Text</span>(item + index)
      })
    }
    .<span class="hljs-title function_">padding</span>(<span class="hljs-number">20</span>)
  }
}
</code></pre>
<p>ç»“æœï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8be1048e974418687901f6bdc600b01~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770907757&amp;x-signature=GGmQXqhj3x%2BWO5%2FOpMdZX3qrj%2F0%3D" alt="2026-02-02-11-05-45-image.png" loading="lazy"/></p>
<h2 data-id="heading-23">å…«ã€çŠ¶æ€ç®¡ç†å’Œäº‹ä»¶å¤„ç†</h2>
<p>åº”ç”¨çš„è¿è¡Œæ—¶çš„çŠ¶æ€æ˜¯å‚æ•°,å½“å‚æ•°æ”¹å˜æ—¶,UIæ¸²æŸ“åˆ·æ–°</p>
<p>çŠ¶æ€å˜é‡:ä½¿ç”¨è£…é¥°å™¨è£…é¥°,çŠ¶æ€å˜é‡æ•°æ®æ”¹å˜ä¼šå¼•èµ·UIçš„æ¸²æŸ“åˆ·æ–°</p>
<p>ä½¿ç”¨V2ç‰ˆæœ¬ç®¡ç†ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@ComponentV2</span>
struct xxx {
  <span class="hljs-meta">@Local</span> å˜é‡
</code></pre>
<blockquote>
<p>æ³¨æ„:</p>
<ol>
<li>çŠ¶æ€å¿…é¡»è®¾ç½®æ•°æ®ç±»å‹</li>
<li>çŠ¶æ€å¿…é¡»è®¾ç½®åˆå§‹å€¼</li>
</ol>
<p>ä½¿ç”¨thiså…³é”®å­—ä¿®æ”¹</p>
</blockquote>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>[] = [<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-string">'æå››'</span>, <span class="hljs-string">'ç‹äº”'</span>]

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@ComponentV2</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-meta">@Local</span> <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Row</span>() {
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'-'</span>)
          .<span class="hljs-title function_">width</span>(<span class="hljs-number">40</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)
          .<span class="hljs-title function_">border</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#999'</span>, <span class="hljs-attr">radius</span>: { <span class="hljs-attr">topLeft</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">bottomLeft</span>: <span class="hljs-number">3</span> } })
          .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)
          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span> &gt; <span class="hljs-number">1</span>) {
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span>--
            }
          })
        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span>.<span class="hljs-title function_">toString</span>())
          .<span class="hljs-title function_">width</span>(<span class="hljs-number">40</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)
          .<span class="hljs-title function_">border</span>({ <span class="hljs-attr">width</span>: { <span class="hljs-attr">top</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">1</span> }, <span class="hljs-attr">color</span>: <span class="hljs-string">'#999'</span> })
          .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'+'</span>)
          .<span class="hljs-title function_">width</span>(<span class="hljs-number">40</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)
          .<span class="hljs-title function_">border</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#999'</span>, <span class="hljs-attr">radius</span>: { <span class="hljs-attr">topRight</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">bottomRight</span>: <span class="hljs-number">3</span> } })
          .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)
          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span>++
          })
      }
      .<span class="hljs-title function_">padding</span>(<span class="hljs-number">50</span>)
    }
    .<span class="hljs-title function_">padding</span>(<span class="hljs-number">20</span>)
  }
}
</code></pre>
<p>ç»“æœï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6723a91f5aec415c9f1eb3b81c2681fe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770907757&amp;x-signature=lCK0XGhTzu8X0ECv4nAkbgbXdhg%3D" alt="2026-02-03-11-37-04-20260203-0336-54.8126786.gif" loading="lazy"/></p>
<ol>
<li><code>onClick</code>å®šä¹‰ç‚¹å‡»æ‰§è¡Œçš„ä»£ç å—</li>
</ol>
<h2 data-id="heading-24">ä¹ã€ä½¿ç”¨@Builderè£…é¥°å‡½æ•°æ§åˆ¶UI</h2>
<p>ä½¿ç”¨@Builder è£…é¥°å‡½æ•°,å°è£…çš„UIå…ƒç´ ,æå‡å¤ç”¨æ€§ï¼Œ@Builderè£…é¥°çš„å‡½æ•°ä¹Ÿç§°ä¸ºâ€œè‡ªå®šä¹‰æ„å»ºå‡½æ•°â€ã€‚</p>
<p>å®šä¹‰ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Builder</span>
è‡ªå®šä¹‰æ„å»ºå‡½æ•°å(å‚æ•°åˆ—è¡¨){
è¦å¤ç”¨çš„ç»„ä»¶ç»“æ„
}
</code></pre>
<p>ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-variable language_">this</span>.è‡ªå®šä¹‰æ„å»ºå‡½æ•°å(æ•°æ®åˆ—è¡¨)
</code></pre>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>[] = [<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-string">'æå››'</span>, <span class="hljs-string">'ç‹äº”'</span>]

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@ComponentV2</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-meta">@Builder</span>
  <span class="hljs-title function_">titleBuilder</span>(<span class="hljs-params">title: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-title class_">Row</span>() {
      <span class="hljs-title class_">Text</span>(title)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#fff'</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-number">700</span>)
        .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)
      <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.ic_more'</span>))
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">22</span>)
        .<span class="hljs-title function_">fillColor</span>(<span class="hljs-string">'#fff'</span>)
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
  }

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">titleBuilder</span>(<span class="hljs-string">'æ ‡é¢˜1'</span>)
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">titleBuilder</span>(<span class="hljs-string">'æ ‡é¢˜2'</span>)
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#131313'</span>)
    .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">10</span> })
  }
}
</code></pre>
<p>ç»“æœï¼š</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f80e21867faf4567be6d96bbf5cd54c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770907757&amp;x-signature=m7r1fTtEufahy5Ki6iWKBZ4oH8w%3D" alt="2026-02-03-11-52-52-image.png" loading="lazy"/></p>
<h2 data-id="heading-25">åã€é¡¹ç›®å¼€å‘</h2>
<h3 data-id="heading-26">ï¼ˆä¸€ï¼‰å›¾æ ‡è®¾ç½®</h3>
<p>é…ç½®æ–‡ä»¶ï¼š<code>é¡¹ç›®ç›®å½•\entry\src\main\module.json5</code></p>
<p>å…·ä½“ä½ç½®ï¼š</p>
<pre><code class="hljs language-json5" lang="json5">{
  "module": {
    â€¦â€¦
    "abilities": [
      {
        â€¦â€¦
        "icon": "$media:layered_image",//è½¯ä»¶æ˜¾ç¤ºå›¾æ ‡
        "label": "$string:EntryAbility_label",//è½¯ä»¶æ˜¾ç¤ºåç§°
        "startWindowIcon": "$media:startIcon",//å¯åŠ¨å›¾æ ‡
        "startWindowBackground": "$color:start_window_background",//å¯åŠ¨èƒŒæ™¯
        â€¦â€¦
      }
    ],
    â€¦â€¦
  }
}
</code></pre>
<blockquote>
<p>å›¾ç‰‡èµ„æºåœ¨<code>é¡¹ç›®åç§°\entry\src\main\resources\base\media\æ–‡ä»¶å</code></p>
<p>æ–‡æœ¬èµ„æºåœ¨<code>é¡¹ç›®åç§°\entry\src\main\resources\base\element\string.json</code></p>
</blockquote>
<h3 data-id="heading-27">ï¼ˆäºŒï¼‰è·³è½¬è®¾è®¡</h3>
<p><code>Navigationç»„ä»¶</code>ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Fdoc%2Fharmonyos-references%2Fts-basic-components-navigation%23%25E7%25A4%25BA%25E4%25BE%258B1navigation%25E9%25A1%25B5%25E9%259D%25A2%25E5%25B8%2583%25E5%25B1%2580" target="_blank" title="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-navigation#%E7%A4%BA%E4%BE%8B1navigation%E9%A1%B5%E9%9D%A2%E5%B8%83%E5%B1%80" ref="nofollow noopener noreferrer">Navigation-å¯¼èˆªä¸åˆ‡æ¢-åä¸ºHarmonyOSå¼€å‘è€…</a></p>
<h3 data-id="heading-28">ï¼ˆä¸‰ï¼‰ç”Ÿå‘½å‘¨æœŸå‡½æ•°</h3>
<p>ç”Ÿå‘½å‘¨æœŸå‡½æ•°æ˜¯ç»„ä»¶ä¸­è‡ªåŠ¨æ‰§è¡Œçš„å‡½æ•°ï¼Œéœ€è¦å†™åœ¨<code>build(){}</code>ä¹‹å‰ã€‚</p>
<ol>
<li><code>ababoutToAppear(): void { å‡½æ•°ä½“ }</code>ï¼Œä¾‹å¦‚ä¸‹é¢è¿™ä¸ªå»¶æ—¶æ‰§è¡Œï¼š</li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>{
    <span class="hljs-comment">//è¦æ‰§è¡Œçš„å†…å®¹</span>
  },ç­‰å¾…æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰)
}
</code></pre>
<h3 data-id="heading-29">ï¼ˆå››ï¼‰é¡¹ç›®æ–‡ä»¶äº¤äº’</h3>
<ol>
<li>
<p>ä½¿ç”¨<code>explort</code> å…³é”®å­—å¯¼å‡ºç»„ä»¶ã€å‡½æ•°</p>
</li>
<li>
<p>ä½¿ç”¨<code>import</code> å…³é”®å­—å¯¼å…¥ç»„ä»¶ã€å‡½æ•°</p>
</li>
</ol>
<h3 data-id="heading-30">ï¼ˆäº”ï¼‰è½¯ä»¶æƒé™</h3>
<p>åœ¨<code>module.json5</code>ä¸­è®¾ç½®æƒé™ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Fdoc%2Fharmonyos-guides%2Fdeclare-permissions%23%25E5%25A3%25B0%25E6%2598%258E%25E6%25A0%25B7%25E4%25BE%258B" target="_blank" title="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/declare-permissions#%E5%A3%B0%E6%98%8E%E6%A0%B7%E4%BE%8B" ref="nofollow noopener noreferrer">å£°æ˜æƒé™-åä¸ºHarmonyOSå¼€å‘è€…</a></p>
<h3 data-id="heading-31">ï¼ˆå…­ï¼‰å¤šé¡µé¢è·³è½¬å­˜å‚¨UIçŠ¶æ€ã€å…¨å±€å…±äº«æ•°æ®</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Fdoc%2Fharmonyos-guides%2Farkts-new-appstoragev2" target="_blank" title="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-appstoragev2" ref="nofollow noopener noreferrer">AppStorageV2: åº”ç”¨å…¨å±€UIçŠ¶æ€å­˜å‚¨-ç®¡ç†åº”ç”¨æ‹¥æœ‰çš„çŠ¶æ€</a></p>
<p>ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title class_">AppStorageV2</span>.<span class="hljs-title function_">connect</span>(ç±»å‹,key,åˆå§‹å€¼æ„é€ å™¨);
</code></pre>
<h3 data-id="heading-32">ï¼ˆä¸ƒï¼‰å¯åŠ¨å‡†å¤‡</h3>
<p>åœ¨<code>é¡¹ç›®åç§°\entry\src\main\ets\entryability\EntryAbility.ets</code>çš„ä¸‹é¢ä»£ç å†…è®¾ç½®ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">â€¦â€¦
<span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-attr">windowStage</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">WindowStage</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// Main window is created, set main page for this ability</span>
    <span class="hljs-comment">//å†™åœ¨è¿™ä¸‹é¢</span>
Â Â Â Â â€¦â€¦
  }
â€¦â€¦
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é»‘å®¢æ¾å† å†›é…ç½®ï¼è€é‡‘æ‹†è§£8å¤§æ ¸å¿ƒæ€è·¯ï¼Œå€¼å¾—åå¤å“å‘³]]></title>    <link>https://juejin.cn/post/7603195719458078726</link>    <guid>https://juejin.cn/post/7603195719458078726</guid>    <pubDate>2026-02-05T10:46:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603195719458078726" data-draft-id="7603142147643097131" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é»‘å®¢æ¾å† å†›é…ç½®ï¼è€é‡‘æ‹†è§£8å¤§æ ¸å¿ƒæ€è·¯ï¼Œå€¼å¾—åå¤å“å‘³"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-02-05T10:46:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è€é‡‘å¸¦ä½ ç©AI"/> <meta itemprop="url" content="https://juejin.cn/user/2561191397043127"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é»‘å®¢æ¾å† å†›é…ç½®ï¼è€é‡‘æ‹†è§£8å¤§æ ¸å¿ƒæ€è·¯ï¼Œå€¼å¾—åå¤å“å‘³
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2561191397043127/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è€é‡‘å¸¦ä½ ç©AI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T10:46:19.000Z" title="Thu Feb 05 2026 10:46:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è€é‡‘æˆ‘ä¹‹å‰å†™è¿‡3ç¯‡AIè®°å¿†æ–¹æ¡ˆçš„æ–‡ç« ï¼šclaude-memï¼ˆè½»é‡ï¼‰ã€mcp-memory-serviceï¼ˆé‡é‡ï¼‰ã€openclawä¸‰å±‚æ¶æ„ï¼ˆæ¦‚å¿µæ€§ï¼‰ã€‚</p>
<p>ä»Šå¤©è®²çš„ç¬¬å››ç§æ–¹æ¡ˆï¼Œä¸åªæ˜¯è®°å¿†ã€‚</p>
<p>å®ƒæ˜¯ä¸€å¥—å®Œæ•´çš„Claude Codeå·¥ä½œæµæ–¹æ³•è®ºã€‚
åŒ…æ‹¬Tokenä¼˜åŒ–ã€Agentç¼–æ’ã€å¹¶è¡ŒåŒ–ã€éªŒè¯å¾ªç¯ã€å¤åˆæ•ˆåº”ã€‚</p>
<p>å››ç§æ–¹æ¡ˆçš„è¯¦ç»†å¯¹æ¯”ï¼Œæ–‡æœ«æœ‰ä¸“é—¨ä¸€èŠ‚ã€‚å…ˆå¾€ä¸‹çœ‹ã€‚</p>
<p>å‘¨æœ«åˆ·GitHubçš„æ—¶å€™ï¼Œè€é‡‘æˆ‘å‘ç°äº†è¿™ä¸ªç¥ä»“åº“ã€‚</p>
<p>28.8kæ˜Ÿï¼Œ3.4k Forkã€‚
åå­—å«everything-claude-codeã€‚</p>
<p>ç‚¹è¿›å»ä¸€çœ‹ï¼Œå§æ§½ï¼Œè¿™ä¸å°±æ˜¯æˆ‘ä¸€ç›´æƒ³è¦çš„ä¸œè¥¿å—ï¼Ÿ</p>
<p>ä½œè€…æ˜¯ä¸ªå«Affaan Mustafaçš„å“¥ä»¬ã€‚
ä»–å’Œé˜Ÿå‹åœ¨Anthropic x Forum Venturesé»‘å®¢æ¾ä¸Šï¼Œç”¨Claude Code 8å°æ—¶åšäº†ä¸ªäº§å“å«zenith.chatã€‚
ç›´æ¥æ‹¿ä¸‹å† å†›ï¼Œèµ¢äº†15000ç¾å…ƒAPI creditsã€‚</p>
<p>å…³é”®æ˜¯ï¼Œä»–æŠŠ10ä¸ªæœˆç§¯ç´¯çš„Claude Codeé…ç½®å’Œæ–¹æ³•è®ºå…¨å¼€æºäº†ã€‚</p>
<p>è€é‡‘æˆ‘ç ”ç©¶äº†ä¸€æ™šä¸Šï¼Œä»Šå¤©ç»™ä½ ä»¬æ‹†è§£ä¸€ä¸‹è¿™ä¸ªç¥å™¨åˆ°åº•ç¥åœ¨å“ªã€‚</p>
<h2 data-id="heading-0">æ ¸å¿ƒæ€è·¯ä¸€ï¼šç”¨CLI+Skillsæ›¿ä»£MCP</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4ca00e82434d4c9ebc2ede9231a706d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ICB6YeR5bim5L2g546pQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770893178&amp;x-signature=uysz7TrITq91pPZQcBmPievB0To%3D" alt="Image" loading="lazy"/></p>
<p>ä½œè€…è¯´ï¼Œå¾ˆå¤šMCPå…¶å®æ˜¯å¯ä»¥æ›¿ä»£çš„ã€‚
æ¯”å¦‚GitHub MCPã€Supabase MCPã€Vercel MCPã€‚
è¿™äº›å¹³å°æœ¬èº«å°±æœ‰å¾ˆå¼ºçš„CLIï¼ŒMCPåªæ˜¯åœ¨å¤–é¢åŒ…äº†ä¸€å±‚ã€‚</p>
<p>é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ
MCPä¼šå ç”¨ä¸Šä¸‹æ–‡çª—å£ï¼Œä¼šæ¶ˆè€—æ›´å¤štokenã€‚</p>
<p>ä½œè€…çš„è§£å†³æ–¹æ¡ˆ
æŠŠMCPçš„åŠŸèƒ½æ‹†æˆSkillså’ŒCommandsã€‚
æ¯”å¦‚ä¸ç”¨GitHub MCPï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªÂ /gh-prå‘½ä»¤ï¼Œç›´æ¥è°ƒç”¨Â gh pr createã€‚
ä¸ç”¨Supabase MCPï¼Œè€Œæ˜¯åˆ›å»ºSkillsç›´æ¥è°ƒç”¨Supabase CLIã€‚</p>
<p>è¿™æ ·åšçš„å¥½å¤„
ä¸Šä¸‹æ–‡çª—å£çœå‡ºæ¥äº†ã€‚
Tokenæ¶ˆè€—é™ä¸‹æ¥äº†ã€‚
åŠŸèƒ½ä¸€æ ·èƒ½ç”¨ã€‚</p>
<p>è€é‡‘æˆ‘è¯•äº†ä¸€ä¸‹ï¼Œç¡®å®æœ‰æ•ˆã€‚
æŠŠå‡ ä¸ªä¸å¸¸ç”¨çš„MCPæ¢æˆCLI+Skillsåï¼Œtokenæ¶ˆè€—é™äº†ä¸å°‘ã€‚</p>
<h2 data-id="heading-1">æ ¸å¿ƒæ€è·¯äºŒï¼šAgenté¡ºåºé˜¶æ®µç¼–æ’</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/afae8d6b4f87416d96792e7e2fe5bafc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ICB6YeR5bim5L2g546pQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770893178&amp;x-signature=7dIYXK6XYJhsyQyeilyRsha6GzI%3D" alt="Image" loading="lazy"/></p>
<p>è¿™æ˜¯è€é‡‘æˆ‘è§‰å¾—æœ€å€¼å¾—å­¦ä¹ çš„éƒ¨åˆ†ã€‚</p>
<p>ä½œè€…æå‡ºäº†ä¸€ä¸ª5é˜¶æ®µçš„Agentç¼–æ’æ¨¡å¼ã€‚</p>
<p>Phase 1: RESEARCH
ç”¨Explore agentåšè°ƒç ”ï¼Œè¾“å‡ºresearch-summary.mdã€‚</p>
<p>Phase 2: PLAN
ç”¨planner agentåšè§„åˆ’ï¼Œè¾“å‡ºplan.mdã€‚</p>
<p>Phase 3: IMPLEMENT
ç”¨tdd-guide agentåšå®ç°ï¼Œè¾“å‡ºä»£ç æ”¹åŠ¨ã€‚</p>
<p>Phase 4: REVIEW
ç”¨code-reviewer agentåšå®¡æŸ¥ï¼Œè¾“å‡ºreview-comments.mdã€‚</p>
<p>Phase 5: VERIFY
å¦‚æœæœ‰é—®é¢˜ï¼Œç”¨build-error-resolverè§£å†³ï¼Œç„¶åå¾ªç¯å›å»ã€‚</p>
<p>å…³é”®è§„åˆ™
æ¯ä¸ªAgentåªæœ‰ä¸€ä¸ªæ¸…æ™°çš„è¾“å…¥ï¼Œäº§å‡ºä¸€ä¸ªæ¸…æ™°çš„è¾“å‡ºã€‚
è¾“å‡ºå˜æˆä¸‹ä¸€é˜¶æ®µçš„è¾“å…¥ã€‚
æ°¸è¿œä¸è¦è·³è¿‡é˜¶æ®µã€‚
é˜¶æ®µä¹‹é—´ç”¨Â /clearæ¸…ç†ä¸Šä¸‹æ–‡ã€‚
ä¸­é—´è¾“å‡ºå­˜åˆ°æ–‡ä»¶é‡Œã€‚</p>
<p>ä¸ºä»€ä¹ˆè¿™æ ·åšï¼Ÿ
Sub-agentæœ‰ä¸ªé—®é¢˜ï¼šå®ƒåªçŸ¥é“å­—é¢æŸ¥è¯¢ï¼Œä¸çŸ¥é“èƒŒåçš„ç›®çš„ã€‚
æ‰€ä»¥éœ€è¦è¿­ä»£æ£€ç´¢æ¨¡å¼ã€‚</p>
<p>ç¼–æ’å™¨è¯„ä¼°æ¯ä¸ªsub-agentçš„è¿”å›ã€‚
åœ¨æ¥å—ä¹‹å‰å…ˆé—®follow-upé—®é¢˜ã€‚
Sub-agentå›å»æ‰¾ç­”æ¡ˆï¼Œå†è¿”å›ã€‚
å¾ªç¯ç›´åˆ°æ»¡æ„ï¼Œæœ€å¤š3è½®ã€‚</p>
<p>å…³é”®æ˜¯ä¼ é€’ç›®æ ‡ä¸Šä¸‹æ–‡ï¼Œè€Œä¸åªæ˜¯æŸ¥è¯¢ã€‚</p>
<h2 data-id="heading-2">æ ¸å¿ƒæ€è·¯ä¸‰ï¼šTokenä¼˜åŒ–ç­–ç•¥</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0b1ca28a69a64ec5b22c3c8b05c26671~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ICB6YeR5bim5L2g546pQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770893178&amp;x-signature=g7H7blT6bAa8rhGxgOrQMQOIo78%3D" alt="Image" loading="lazy"/></p>
<p>ç”¨Claude Codeæœ€å¤´ç–¼çš„å°±æ˜¯tokenæ¶ˆè€—ã€‚
ä½œè€…ç»™äº†ä¸€å¥—å®Œæ•´çš„ä¼˜åŒ–æ–¹æ¡ˆã€‚</p>
<p>æ¨¡å‹é€‰æ‹©çš„æ€è·¯</p>
<p>ä½œè€…çš„å»ºè®®æ˜¯ï¼š90%çš„ç¼–ç ä»»åŠ¡ç”¨Sonnetã€‚
åªæœ‰åœ¨ç‰¹å®šæƒ…å†µä¸‹æ‰å‡çº§åˆ°Opusã€‚</p>
<p>ä»€ä¹ˆæƒ…å†µç”¨Haikuï¼Ÿ
æ¢ç´¢å’Œæœç´¢ä»»åŠ¡ï¼Œå¿«ã€ä¾¿å®œã€å¤Ÿç”¨ã€‚
ç®€å•ç¼–è¾‘ï¼Œå•æ–‡ä»¶æ”¹åŠ¨ï¼ŒæŒ‡ä»¤æ¸…æ™°ã€‚
å†™æ–‡æ¡£ï¼Œç»“æ„ç®€å•ã€‚</p>
<p>ä»€ä¹ˆæƒ…å†µç”¨Sonnetï¼Ÿ
å¤šæ–‡ä»¶å®ç°ï¼Œç¼–ç æœ€ä½³å¹³è¡¡ã€‚
PRå®¡æŸ¥ï¼Œç†è§£ä¸Šä¸‹æ–‡ï¼ŒæŠ“ç»†èŠ‚ã€‚</p>
<p>ä»€ä¹ˆæƒ…å†µç”¨Opusï¼Ÿ
å¤æ‚æ¶æ„ï¼Œéœ€è¦æ·±åº¦æ¨ç†ã€‚
å®‰å…¨åˆ†æï¼Œä¸èƒ½æ¼æ‰æ¼æ´ã€‚
è°ƒè¯•å¤æ‚bugï¼Œéœ€è¦å…¨å±€è§†è§’ã€‚
ç¬¬ä¸€æ¬¡å°è¯•å¤±è´¥ã€ä»»åŠ¡è·¨5ä¸ªä»¥ä¸Šæ–‡ä»¶ã€æ¶‰åŠæ¶æ„å†³ç­–ã€æˆ–è€…å®‰å…¨å…³é”®ä»£ç ã€‚</p>
<p>ç”¨mgrepæ›¿ä»£grep</p>
<p>ä½œè€…æ¨èç”¨mgrepæ›¿ä»£ä¼ ç»Ÿçš„grepæˆ–ripgrepã€‚
æ ¹æ®ä»–çš„æµ‹è¯•ï¼Œtokenæ¶ˆè€—å¹³å‡å‡å°‘50%ã€‚</p>
<p>æ¨¡å—åŒ–ä»£ç åº“</p>
<p>ä½œè€…å¼ºè°ƒï¼ŒæŠŠä¸»æ–‡ä»¶æ§åˆ¶åœ¨å‡ ç™¾è¡Œè€Œä¸æ˜¯å‡ åƒè¡Œã€‚
è¿™æ ·ä¸ä»…çœtokenï¼Œè€Œä¸”ä»»åŠ¡ä¸€æ¬¡åšå¯¹çš„æ¦‚ç‡æ›´é«˜ã€‚</p>
<h2 data-id="heading-3">æ ¸å¿ƒæ€è·¯å››ï¼šéªŒè¯å¾ªç¯</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/662717a0be4b43028efc229802695e4d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ICB6YeR5bim5L2g546pQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770893178&amp;x-signature=49fjQVu0GYHqUdrYFGOEQazye4Y%3D" alt="Image" loading="lazy"/></p>
<p>ä½œè€…åœ¨æŒ‡å—é‡Œæåˆ°äº†ä¸¤ä¸ªé‡è¦æŒ‡æ ‡ã€‚</p>
<p>pass@k
kæ¬¡å°è¯•ä¸­è‡³å°‘æœ‰1æ¬¡æˆåŠŸã€‚
k=1æ—¶70%ï¼Œk=3æ—¶91%ï¼Œk=5æ—¶97%ã€‚</p>
<p>pass^k
kæ¬¡å°è¯•å¿…é¡»å…¨éƒ¨æˆåŠŸã€‚
k=1æ—¶70%ï¼Œk=3æ—¶34%ï¼Œk=5æ—¶17%ã€‚</p>
<p>ä»€ä¹ˆæ—¶å€™ç”¨å“ªä¸ªï¼Ÿ
å¦‚æœåªéœ€è¦èƒ½è·‘å°±è¡Œï¼Œç”¨pass@kã€‚
å¦‚æœéœ€è¦ç¨³å®šä¸€è‡´ï¼Œç”¨pass^kã€‚</p>
<p>ä¸¤ç§éªŒè¯æ¨¡å¼</p>
<p>Checkpoint-Based Evals
è®¾ç½®æ˜ç¡®çš„æ£€æŸ¥ç‚¹ï¼ŒéªŒè¯æ˜¯å¦ç¬¦åˆæ ‡å‡†ï¼Œä¸è¿‡ä¸ç»§ç»­ã€‚</p>
<p>Continuous Evals
æ¯éš”Nåˆ†é’Ÿæˆ–è€…å¤§æ”¹åŠ¨åï¼Œè·‘å®Œæ•´æµ‹è¯•å¥—ä»¶åŠ lintã€‚</p>
<p>æ€ä¹ˆåšåŸºå‡†æµ‹è¯•ï¼Ÿ
Forkå¯¹è¯ï¼Œåœ¨ä¸€ä¸ªåˆ†æ”¯é‡Œä¸ç”¨Skillï¼Œåœ¨å¦ä¸€ä¸ªåˆ†æ”¯é‡Œç”¨Skillã€‚
æœ€åæ‹‰ä¸ªdiffï¼Œçœ‹çœ‹è¾“å‡ºæœ‰ä»€ä¹ˆåŒºåˆ«ã€‚</p>
<h2 data-id="heading-4">æ ¸å¿ƒæ€è·¯äº”ï¼šå¹¶è¡ŒåŒ–ç­–ç•¥</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be1089ea7c584526a903bf0237dac5d6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ICB6YeR5bim5L2g546pQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770893178&amp;x-signature=%2FuOjl03I8AL7uV%2BjQgteccyzsUU%3D" alt="Image" loading="lazy"/></p>
<p>è¿™éƒ¨åˆ†è€é‡‘æˆ‘è§‰å¾—ç‰¹åˆ«å®ç”¨ï¼Œå’Œä¹‹å‰è€é‡‘è®²çš„claude codeè”åˆåˆ›å§‹äººçš„åšæ³•ç›¸åŒã€‚</p>
<p>Git Worktrees</p>
<p>å¦‚æœä½ è¦åŒæ—¶è·‘å¤šä¸ªClaudeå®ä¾‹å¤„ç†ä¸åŒä»»åŠ¡ï¼Œä½œè€…å¼ºçƒˆå»ºè®®ç”¨Git Worktreesã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºå·¥ä½œæ ‘</span>
git worktree add ../project-feature-a feature-a
git worktree add ../project-feature-b feature-b

<span class="hljs-comment"># æ¯ä¸ªå·¥ä½œæ ‘è·‘ä¸€ä¸ªClaudeå®ä¾‹</span>
<span class="hljs-built_in">cd</span>Â ../project-feature-a &amp;&amp; claude
</code></pre>
<p>è¿™æ ·å¤šä¸ªClaudeå®ä¾‹ä¸ä¼šäº’ç›¸å¹²æ‰°ï¼Œä»£ç æ”¹åŠ¨ä¹Ÿä¸ä¼šå†²çªã€‚</p>
<p>Cascade Method</p>
<p>ä½œè€…çš„å¹¶è¡Œå·¥ä½œæµæ˜¯è¿™æ ·çš„ï¼š
æ–°ä»»åŠ¡åœ¨å³è¾¹å¼€æ–°æ ‡ç­¾é¡µã€‚
ä»å·¦åˆ°å³æ‰«ï¼Œæœ€è€çš„åœ¨æœ€å·¦è¾¹ã€‚
åŒæ—¶æœ€å¤šå…³æ³¨3-4ä¸ªä»»åŠ¡ã€‚</p>
<p>å…³äºå¹¶è¡Œæ•°é‡</p>
<p>ä½œè€…å¼•ç”¨äº†Anthropicçš„Borisçš„å»ºè®®ï¼Œä½†ä»–è‡ªå·±çš„è§‚ç‚¹æ˜¯ï¼š
ä¸è¦è®¾ç½®ä»»æ„æ•°é‡çš„ç»ˆç«¯ã€‚
å¢åŠ ç»ˆç«¯åº”è¯¥æ˜¯å‡ºäºçœŸæ­£çš„éœ€è¦ã€‚
ç›®æ ‡æ˜¯ï¼šç”¨æœ€å°‘çš„å¹¶è¡ŒåŒ–å®Œæˆæœ€å¤šçš„å·¥ä½œã€‚</p>
<h2 data-id="heading-5">æ ¸å¿ƒæ€è·¯å…­ï¼šTwo-Instance Kickoff Pattern</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/823bee58678043669390699449965449~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ICB6YeR5bim5L2g546pQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770893178&amp;x-signature=1hjL3kczymkgXo3fDHE3yEWOUk4%3D" alt="Image" loading="lazy"/></p>
<p>å¼€æ–°é¡¹ç›®çš„æ—¶å€™ï¼Œä½œè€…ä¼šå¼€ä¸¤ä¸ªClaudeå®ä¾‹ã€‚</p>
<p>Instance 1: Scaffolding Agent
è´Ÿè´£æ­å»ºé¡¹ç›®éª¨æ¶ã€‚
åˆ›å»ºé¡¹ç›®ç»“æ„ã€‚
é…ç½®CLAUDE.mdå’Œrulesã€‚</p>
<p>Instance 2: Deep Research Agent
è¿æ¥å„ç§æœåŠ¡ï¼Œåšç½‘ç»œæœç´¢ã€‚
åˆ›å»ºè¯¦ç»†çš„PRDã€‚
ç”»æ¶æ„mermaidå›¾ã€‚
ç¼–è¯‘å‚è€ƒæ–‡æ¡£ã€‚</p>
<p>ä¸¤ä¸ªå®ä¾‹å¹¶è¡Œå·¥ä½œï¼Œæ•ˆç‡ç›´æ¥ç¿»å€ã€‚</p>
<p>llms.txtæ¨¡å¼</p>
<p>ä½œè€…æåˆ°ä¸€ä¸ªæŠ€å·§ï¼šå¾ˆå¤šæ–‡æ¡£ç½‘ç«™æœ‰Â /llms.txtã€‚
è®¿é—®æ–‡æ¡£é¡µé¢ååŠ ä¸ŠÂ /llms.txtï¼Œå°±èƒ½è·å¾—LLMä¼˜åŒ–ç‰ˆæœ¬çš„æ–‡æ¡£ã€‚
æ›´å¹²å‡€ï¼Œæ›´é€‚åˆå–‚ç»™Claudeã€‚</p>
<p>å¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œè®°å¾—å…³æ³¨ä¸€æ³¢~</p>
<h2 data-id="heading-6">æ ¸å¿ƒæ€è·¯ä¸ƒï¼šè®°å¿†æŒä¹…åŒ–</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/544fb64e18be452f9638fa7074b8d27b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ICB6YeR5bim5L2g546pQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770893178&amp;x-signature=Jetr4YHpSPRC6SFMBRarkqdeBW8%3D" alt="Image" loading="lazy"/></p>
<p>è¿™éƒ¨åˆ†æ˜¯è®°å¿†ç›¸å…³çš„ï¼Œä½†åªæ˜¯æ•´ä¸ªæ–¹æ³•è®ºçš„ä¸€å°éƒ¨åˆ†ã€‚</p>
<p>åŠ¨æ€ç³»ç»Ÿæç¤ºæ³¨å…¥</p>
<p>ä½œè€…ä¸æ˜¯æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½å¡è¿›CLAUDE.mdï¼Œè€Œæ˜¯ç”¨CLIå‚æ•°åŠ¨æ€æ³¨å…¥ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">claude --system-promptÂ <span class="hljs-string">"<span class="hljs-subst">$(cat memory.md)</span>"</span>
</code></pre>
<p>ç„¶åä»–è®¾ç½®äº†å‡ ä¸ªaliasï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ—¥å¸¸å¼€å‘æ¨¡å¼</span>
aliasÂ <span class="hljs-attr">claude-dev</span>=<span class="hljs-string">'claude --system-prompt "$(cat ~/.claude/contexts/dev.md)"'</span>

<span class="hljs-comment"># PRå®¡æŸ¥æ¨¡å¼</span>
aliasÂ <span class="hljs-attr">claude-review</span>=<span class="hljs-string">'claude --system-prompt "$(cat ~/.claude/contexts/review.md)"'</span>

<span class="hljs-comment"># ç ”ç©¶æ¢ç´¢æ¨¡å¼</span>
aliasÂ <span class="hljs-attr">claude-research</span>=<span class="hljs-string">'claude --system-prompt "$(cat ~/.claude/contexts/research.md)"'</span>
</code></pre>
<p>ä¸åŒåœºæ™¯åŠ è½½ä¸åŒä¸Šä¸‹æ–‡ï¼Œç²¾å‡†æ§åˆ¶Claudeçš„è¡Œä¸ºã€‚</p>
<p>Memory Persistence Hooks
ä½œè€…æäº†ä¸€å¥—Memory Persistence Hooksï¼Œç”¨ä¸‰ä¸ªé’©å­è§£å†³è®°å¿†é—®é¢˜ã€‚</p>
<p>PreCompact Hook
åœ¨ä¸Šä¸‹æ–‡å‹ç¼©ä¹‹å‰ï¼Œè‡ªåŠ¨æŠŠé‡è¦çŠ¶æ€ä¿å­˜åˆ°æ–‡ä»¶ã€‚</p>
<p>Stop Hook
ä¼šè¯ç»“æŸæ—¶ï¼Œè‡ªåŠ¨æŠŠå­¦åˆ°çš„ä¸œè¥¿æŒä¹…åŒ–ã€‚</p>
<p>SessionStart Hook
æ–°ä¼šè¯å¼€å§‹æ—¶ï¼Œè‡ªåŠ¨åŠ è½½ä¹‹å‰çš„ä¸Šä¸‹æ–‡ã€‚</p>
<p>ä¸ºä»€ä¹ˆç”¨Stop Hookè€Œä¸æ˜¯UserPromptSubmitï¼Ÿ
UserPromptSubmitæ¯æ¡æ¶ˆæ¯éƒ½ä¼šè§¦å‘ï¼Œå¢åŠ å»¶è¿Ÿã€‚
Stopåªåœ¨ä¼šè¯ç»“æŸæ—¶è§¦å‘ä¸€æ¬¡ï¼Œè½»é‡çº§ï¼Œä¸ä¼šæ‹–æ…¢ä½ ã€‚</p>
<p>Continuous LearningæŠ€èƒ½
å½“Claudeå‘ç°äº†ä»€ä¹ˆæ–°ä¸œè¥¿ï¼Œæ¯”å¦‚ä¸€ä¸ªè°ƒè¯•æŠ€å·§ã€ä¸€ä¸ªworkaroundï¼Œå®ƒä¼šè‡ªåŠ¨ä¿å­˜æˆæ–°æŠ€èƒ½ã€‚
ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜ï¼ŒæŠ€èƒ½è‡ªåŠ¨åŠ è½½ã€‚</p>
<h2 data-id="heading-7">æ ¸å¿ƒæ€è·¯å…«ï¼šå¤åˆæ•ˆåº”å“²å­¦</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/268dccdd2fa94c8d9fdf9ef3c1f2e759~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ICB6YeR5bim5L2g546pQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770893178&amp;x-signature=0rxOCHv0JKoDTZI%2FuTHAE9koirc%3D" alt="Image" loading="lazy"/></p>
<p>ä½œè€…å¼•ç”¨äº†@omarsar0çš„è¯ï¼š
"æ—©æœŸï¼Œæˆ‘èŠ±æ—¶é—´æ„å»ºå¯å¤ç”¨çš„å·¥ä½œæµå’Œæ¨¡å¼ã€‚æ„å»ºèµ·æ¥å¾ˆç¹çï¼Œä½†éšç€æ¨¡å‹å’Œagentæ¡†æ¶çš„æ”¹è¿›ï¼Œè¿™äº§ç”Ÿäº†ç–¯ç‹‚çš„å¤åˆæ•ˆåº”ã€‚"</p>
<p>åº”è¯¥æŠ•èµ„ä»€ä¹ˆï¼Ÿ
Subagents
Skills
Commands
è§„åˆ’æ¨¡å¼
MCPå·¥å…·
ä¸Šä¸‹æ–‡å·¥ç¨‹æ¨¡å¼</p>
<p>è¿™å°±æ˜¯å¤åˆ©ã€‚
å‰æœŸæŠ•å…¥æ—¶é—´æ„å»ºå¯å¤ç”¨çš„ä¸œè¥¿ã€‚
åæœŸæ¯æ¬¡ä½¿ç”¨éƒ½åœ¨æ”¶ç›Šã€‚</p>
<h2 data-id="heading-8">æ€ä¹ˆç”¨ï¼Ÿæ‰‹æŠŠæ‰‹æ•™ä½ </h2>
<p>å®‰è£…æœ‰ä¸¤ç§æ–¹å¼ï¼Œè€é‡‘æˆ‘æ¨èç”¨æ’ä»¶æ–¹å¼ï¼Œ2åˆ†é’Ÿæå®šã€‚</p>
<h3 data-id="heading-9">æ–¹æ³•ä¸€ï¼šä½œä¸ºæ’ä»¶å®‰è£…ï¼ˆæ¨èï¼‰</h3>
<p>ç¬¬ä¸€æ­¥ï¼šå®‰è£…æ’ä»¶
ç›´æ¥åœ¨claude codeä¸­è¾“å…¥</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ·»åŠ å¸‚åœº</span>
/plugin marketplace add affaan-m/everything-claude-code

<span class="hljs-comment"># å®‰è£…æ’ä»¶</span>
/plugin install everything-claude-code@everything-claude-code
</code></pre>
<p>ç¬¬äºŒæ­¥ï¼šå®‰è£…è§„åˆ™ï¼ˆå¿…éœ€ï¼‰
âš ï¸ é‡è¦ï¼šæ’ä»¶æ— æ³•è‡ªåŠ¨åˆ†å‘rulesï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…ã€‚
å»ºè®®åœ¨claudeå…¨å±€ç›®å½•ç›´æ¥è¿›è¡Œã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é¦–å…ˆå…‹éš†ä»“åº“</span>
gitÂ <span class="hljs-built_in">clone</span>Â https://github.com/affaan-m/everything-claude-code.git

<span class="hljs-comment"># å¤åˆ¶è§„åˆ™åˆ°ç”¨æˆ·çº§ï¼ˆåº”ç”¨äºæ‰€æœ‰é¡¹ç›®ï¼‰</span>
<span class="hljs-built_in">cp</span>Â -r everything-claude-code/rules/* ~/.claude/rules/

<span class="hljs-comment"># æˆ–è€…å¤åˆ¶åˆ°é¡¹ç›®çº§ï¼ˆä»…å½“å‰é¡¹ç›®ï¼‰</span>
<span class="hljs-built_in">mkdir</span>Â -p .claude/rules
<span class="hljs-built_in">cp</span>Â -r everything-claude-code/rules/* .claude/rules/
</code></pre>
<p>ç¬¬ä¸‰æ­¥ï¼šå¼€å§‹ä½¿ç”¨</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å°è¯•ä¸€ä¸ªå‘½ä»¤</span>
/planÂ <span class="hljs-string">"æ·»åŠ ç”¨æˆ·è®¤è¯"</span>

<span class="hljs-comment"># æŸ¥çœ‹å¯ç”¨å‘½ä»¤</span>
/plugin list everything-claude-code@everything-claude-code
</code></pre>
<p>âœ¨ å®Œæˆï¼ä½ ç°åœ¨å¯ä»¥ä½¿ç”¨15+ä»£ç†ã€30+æŠ€èƒ½å’Œ20+å‘½ä»¤ã€‚</p>
<h3 data-id="heading-10">æ–¹æ³•äºŒï¼šæ‰‹åŠ¨å®‰è£…ï¼ˆæ¨èè€æ‰‹ï¼‰</h3>
<p>å¦‚æœä½ å¸Œæœ›å¯¹å®‰è£…çš„å†…å®¹æœ‰å®Œå…¨æ§åˆ¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…‹éš†ä»“åº“</span>
gitÂ <span class="hljs-built_in">clone</span>Â https://github.com/affaan-m/everything-claude-code.git

<span class="hljs-comment"># å¤åˆ¶ä»£ç†</span>
<span class="hljs-built_in">cp</span>Â everything-claude-code/agents/*.md ~/.claude/agents/

<span class="hljs-comment"># å¤åˆ¶å‘½ä»¤</span>
<span class="hljs-built_in">cp</span>Â everything-claude-code/commands/*.md ~/.claude/commands/

<span class="hljs-comment"># å¤åˆ¶æŠ€èƒ½</span>
<span class="hljs-built_in">cp</span>Â -r everything-claude-code/skills/* ~/.claude/skills/
</code></pre>
<p>é…ç½®hookså’ŒMCPéœ€è¦æ‰‹åŠ¨ç¼–è¾‘settings.jsonå’Œclaude.jsonï¼Œè¯¦è§ä»“åº“READMEã€‚</p>
<p>ç›®å½•ç»“æ„ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">everything-claude-code/
|-- .claude-plugin/ Â  <span class="hljs-comment"># æ’ä»¶å’Œå¸‚åœºæ¸…å•</span>
| Â  |-- plugin.json Â  Â  Â  Â  <span class="hljs-comment"># æ’ä»¶å…ƒæ•°æ®å’Œç»„ä»¶è·¯å¾„</span>
| Â  |-- marketplace.json Â  Â <span class="hljs-comment"># /plugin marketplace add çš„å¸‚åœºç›®å½•</span>
|
|-- agents/ Â  Â  Â  Â  Â  <span class="hljs-comment"># ç”¨äºå§”æ‰˜çš„ä¸“ä¸šå­ä»£ç†</span>
| Â  |-- planner.md Â  Â  Â  Â  Â  <span class="hljs-comment"># åŠŸèƒ½å®ç°è§„åˆ’</span>
| Â  |-- architect.md Â  Â  Â  Â  <span class="hljs-comment"># ç³»ç»Ÿè®¾è®¡å†³ç­–</span>
| Â  |-- tdd-guide.md Â  Â  Â  Â  <span class="hljs-comment"># æµ‹è¯•é©±åŠ¨å¼€å‘</span>
| Â  |-- code-reviewer.md Â  Â  <span class="hljs-comment"># è´¨é‡å’Œå®‰å…¨å®¡æŸ¥</span>
| Â  |-- security-reviewer.md <span class="hljs-comment"># æ¼æ´åˆ†æ</span>
| Â  |-- build-error-resolver.md
| Â  |-- e2e-runner.md Â  Â  Â  Â <span class="hljs-comment"># Playwright E2E æµ‹è¯•</span>
| Â  |-- refactor-cleaner.md Â <span class="hljs-comment"># æ­»ä»£ç æ¸…ç†</span>
| Â  |-- doc-updater.md Â  Â  Â  <span class="hljs-comment"># æ–‡æ¡£åŒæ­¥</span>
| Â  |-- go-reviewer.md Â  Â  Â  <span class="hljs-comment"># Go ä»£ç å®¡æŸ¥ï¼ˆæ–°å¢ï¼‰</span>
| Â  |-- go-build-resolver.md <span class="hljs-comment"># Go æ„å»ºé”™è¯¯è§£å†³ï¼ˆæ–°å¢ï¼‰</span>
|
|-- skills/ Â  Â  Â  Â  Â  <span class="hljs-comment"># å·¥ä½œæµå®šä¹‰å’Œé¢†åŸŸçŸ¥è¯†</span>
| Â  |-- coding-standards/ Â  Â  Â  Â  Â  <span class="hljs-comment"># è¯­è¨€æœ€ä½³å®è·µ</span>
| Â  |-- backend-patterns/ Â  Â  Â  Â  Â  <span class="hljs-comment"># APIã€æ•°æ®åº“ã€ç¼“å­˜æ¨¡å¼</span>
| Â  |-- frontend-patterns/ Â  Â  Â  Â  Â <span class="hljs-comment"># Reactã€Next.js æ¨¡å¼</span>
| Â  |-- continuous-learning/ Â  Â  Â  Â <span class="hljs-comment"># ä»ä¼šè¯ä¸­è‡ªåŠ¨æå–æ¨¡å¼ï¼ˆè¯¦ç»†æŒ‡å—ï¼‰</span>
| Â  |-- continuous-learning-v2/ Â  Â  <span class="hljs-comment"># åŸºäºç›´è§‰çš„å­¦ä¹ ä¸ç½®ä¿¡åº¦è¯„åˆ†</span>
| Â  |-- iterative-retrieval/ Â  Â  Â  Â <span class="hljs-comment"># å­ä»£ç†çš„æ¸è¿›å¼ä¸Šä¸‹æ–‡ç»†åŒ–</span>
| Â  |-- strategic-compact/ Â  Â  Â  Â  Â <span class="hljs-comment"># æ‰‹åŠ¨å‹ç¼©å»ºè®®ï¼ˆè¯¦ç»†æŒ‡å—ï¼‰</span>
| Â  |-- tdd-workflow/ Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># TDD æ–¹æ³•è®º</span>
| Â  |-- security-review/ Â  Â  Â  Â  Â  Â <span class="hljs-comment"># å®‰å…¨æ£€æŸ¥æ¸…å•</span>
| Â  |-- <span class="hljs-keyword">eval</span>-harness/ Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># éªŒè¯å¾ªç¯è¯„ä¼°ï¼ˆè¯¦ç»†æŒ‡å—ï¼‰</span>
| Â  |-- verification-loop/ Â  Â  Â  Â  Â <span class="hljs-comment"># æŒç»­éªŒè¯ï¼ˆè¯¦ç»†æŒ‡å—ï¼‰</span>
| Â  |-- golang-patterns/ Â  Â  Â  Â  Â  Â <span class="hljs-comment"># Go æƒ¯ç”¨è¯­å’Œæœ€ä½³å®è·µï¼ˆæ–°å¢ï¼‰</span>
| Â  |-- golang-testing/ Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># Go æµ‹è¯•æ¨¡å¼ã€TDDã€åŸºå‡†æµ‹è¯•ï¼ˆæ–°å¢ï¼‰</span>
|
|-- commands/ Â  Â  Â  Â  <span class="hljs-comment"># ç”¨äºå¿«é€Ÿæ‰§è¡Œçš„æ–œæ å‘½ä»¤</span>
| Â  |-- tdd.md Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># /tdd - æµ‹è¯•é©±åŠ¨å¼€å‘</span>
| Â  |-- plan.md Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># /plan - å®ç°è§„åˆ’</span>
| Â  |-- e2e.md Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># /e2e - E2E æµ‹è¯•ç”Ÿæˆ</span>
| Â  |-- code-review.md Â  Â  Â <span class="hljs-comment"># /code-review - è´¨é‡å®¡æŸ¥</span>
| Â  |-- build-fix.md Â  Â  Â  Â <span class="hljs-comment"># /build-fix - ä¿®å¤æ„å»ºé”™è¯¯</span>
| Â  |-- refactor-clean.md Â  <span class="hljs-comment"># /refactor-clean - æ­»ä»£ç ç§»é™¤</span>
| Â  |-- learn.md Â  Â  Â  Â  Â  Â <span class="hljs-comment"># /learn - ä¼šè¯ä¸­æå–æ¨¡å¼ï¼ˆè¯¦ç»†æŒ‡å—ï¼‰</span>
| Â  |-- checkpoint.md Â  Â  Â  <span class="hljs-comment"># /checkpoint - ä¿å­˜éªŒè¯çŠ¶æ€ï¼ˆè¯¦ç»†æŒ‡å—ï¼‰</span>
| Â  |-- verify.md Â  Â  Â  Â  Â  <span class="hljs-comment"># /verify - è¿è¡ŒéªŒè¯å¾ªç¯ï¼ˆè¯¦ç»†æŒ‡å—ï¼‰</span>
| Â  |-- setup-pm.md Â  Â  Â  Â  <span class="hljs-comment"># /setup-pm - é…ç½®åŒ…ç®¡ç†å™¨</span>
| Â  |-- go-review.md Â  Â  Â  Â <span class="hljs-comment"># /go-review - Go ä»£ç å®¡æŸ¥ï¼ˆæ–°å¢ï¼‰</span>
| Â  |-- go-test.md Â  Â  Â  Â  Â <span class="hljs-comment"># /go-test - Go TDD å·¥ä½œæµï¼ˆæ–°å¢ï¼‰</span>
| Â  |-- go-build.md Â  Â  Â  Â  <span class="hljs-comment"># /go-build - ä¿®å¤ Go æ„å»ºé”™è¯¯ï¼ˆæ–°å¢ï¼‰</span>
| Â  |-- skill-create.md Â  Â  <span class="hljs-comment"># /skill-create - ä» git å†å²ç”ŸæˆæŠ€èƒ½ï¼ˆæ–°å¢ï¼‰</span>
| Â  |-- instinct-status.md Â <span class="hljs-comment"># /instinct-status - æŸ¥çœ‹å­¦ä¹ çš„ç›´è§‰ï¼ˆæ–°å¢ï¼‰</span>
| Â  |-- instinct-import.md Â <span class="hljs-comment"># /instinct-import - å¯¼å…¥ç›´è§‰ï¼ˆæ–°å¢ï¼‰</span>
| Â  |-- instinct-export.md Â <span class="hljs-comment"># /instinct-export - å¯¼å‡ºç›´è§‰ï¼ˆæ–°å¢ï¼‰</span>
| Â  |-- evolve.md Â  Â  Â  Â  Â  <span class="hljs-comment"># /evolve - å°†ç›´è§‰èšç±»åˆ°æŠ€èƒ½ä¸­ï¼ˆæ–°å¢ï¼‰</span>
|
|-- rules/ Â  Â  Â  Â  Â  Â <span class="hljs-comment"># å§‹ç»ˆéµå¾ªçš„æŒ‡å—ï¼ˆå¤åˆ¶åˆ° ~/.claude/rules/ï¼‰</span>
| Â  |-- security.md Â  Â  Â  Â  <span class="hljs-comment"># å¼ºåˆ¶æ€§å®‰å…¨æ£€æŸ¥</span>
| Â  |-- coding-style.md Â  Â  <span class="hljs-comment"># ä¸å¯å˜æ€§ã€æ–‡ä»¶ç»„ç»‡</span>
| Â  |-- testing.md Â  Â  Â  Â  Â <span class="hljs-comment"># TDDã€80% è¦†ç›–ç‡è¦æ±‚</span>
| Â  |-- git-workflow.md Â  Â  <span class="hljs-comment"># æäº¤æ ¼å¼ã€PR æµç¨‹</span>
| Â  |-- agents.md Â  Â  Â  Â  Â  <span class="hljs-comment"># ä½•æ—¶å§”æ‰˜ç»™å­ä»£ç†</span>
| Â  |-- performance.md Â  Â  Â <span class="hljs-comment"># æ¨¡å‹é€‰æ‹©ã€ä¸Šä¸‹æ–‡ç®¡ç†</span>
|
|-- hooks/ Â  Â  Â  Â  Â  Â <span class="hljs-comment"># åŸºäºè§¦å‘å™¨çš„è‡ªåŠ¨åŒ–</span>
| Â  |-- hooks.json Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># æ‰€æœ‰é’©å­é…ç½®ï¼ˆPreToolUseã€PostToolUseã€Stop ç­‰ï¼‰</span>
| Â  |-- memory-persistence/ Â  Â  Â  <span class="hljs-comment"># ä¼šè¯ç”Ÿå‘½å‘¨æœŸé’©å­ï¼ˆè¯¦ç»†æŒ‡å—ï¼‰</span>
| Â  |-- strategic-compact/ Â  Â  Â  Â <span class="hljs-comment"># å‹ç¼©å»ºè®®ï¼ˆè¯¦ç»†æŒ‡å—ï¼‰</span>
|
|-- scripts/ Â  Â  Â  Â  Â <span class="hljs-comment"># è·¨å¹³å° Node.js è„šæœ¬ï¼ˆæ–°å¢ï¼‰</span>
| Â  |-- lib/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># å…±äº«å·¥å…·</span>
| Â  | Â  |-- utils.js Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># è·¨å¹³å°æ–‡ä»¶/è·¯å¾„/ç³»ç»Ÿå·¥å…·</span>
| Â  | Â  |-- <span class="hljs-keyword">package</span>-manager.js Â  <span class="hljs-comment"># åŒ…ç®¡ç†å™¨æ£€æµ‹å’Œé€‰æ‹©</span>
| Â  |-- hooks/ Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># é’©å­å®ç°</span>
| Â  | Â  |-- session-start.js Â  Â  <span class="hljs-comment"># ä¼šè¯å¼€å§‹æ—¶åŠ è½½ä¸Šä¸‹æ–‡</span>
| Â  | Â  |-- session-end.js Â  Â  Â  <span class="hljs-comment"># ä¼šè¯ç»“æŸæ—¶ä¿å­˜çŠ¶æ€</span>
| Â  | Â  |-- pre-compact.js Â  Â  Â  <span class="hljs-comment"># å‹ç¼©å‰çŠ¶æ€ä¿å­˜</span>
| Â  | Â  |-- suggest-compact.js Â  <span class="hljs-comment"># æˆ˜ç•¥æ€§å‹ç¼©å»ºè®®</span>
| Â  | Â  |-- evaluate-session.js Â <span class="hljs-comment"># ä»ä¼šè¯ä¸­æå–æ¨¡å¼</span>
| Â  |-- setup-<span class="hljs-keyword">package</span>-manager.js <span class="hljs-comment"># äº¤äº’å¼ PM è®¾ç½®</span>
|
|-- tests/ Â  Â  Â  Â  Â  Â <span class="hljs-comment"># æµ‹è¯•å¥—ä»¶ï¼ˆæ–°å¢ï¼‰</span>
| Â  |-- lib/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># åº“æµ‹è¯•</span>
| Â  |-- hooks/ Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># é’©å­æµ‹è¯•</span>
| Â  |-- run-all.js Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># è¿è¡Œæ‰€æœ‰æµ‹è¯•</span>
|
|-- contexts/ Â  Â  Â  Â  <span class="hljs-comment"># åŠ¨æ€ç³»ç»Ÿæç¤ºæ³¨å…¥ä¸Šä¸‹æ–‡ï¼ˆè¯¦ç»†æŒ‡å—ï¼‰</span>
| Â  |-- dev.md Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># å¼€å‘æ¨¡å¼ä¸Šä¸‹æ–‡</span>
| Â  |-- review.md Â  Â  Â  Â  Â  <span class="hljs-comment"># ä»£ç å®¡æŸ¥æ¨¡å¼ä¸Šä¸‹æ–‡</span>
| Â  |-- research.md Â  Â  Â  Â  <span class="hljs-comment"># ç ”ç©¶/æ¢ç´¢æ¨¡å¼ä¸Šä¸‹æ–‡</span>
|
|-- examples/ Â  Â  Â  Â  <span class="hljs-comment"># ç¤ºä¾‹é…ç½®å’Œä¼šè¯</span>
| Â  |-- CLAUDE.md Â  Â  Â  Â  Â  <span class="hljs-comment"># ç¤ºä¾‹é¡¹ç›®çº§é…ç½®</span>
| Â  |-- user-CLAUDE.md Â  Â  Â <span class="hljs-comment"># ç¤ºä¾‹ç”¨æˆ·çº§é…ç½®</span>
|
|-- mcp-configs/ Â  Â  Â <span class="hljs-comment"># MCP æœåŠ¡å™¨é…ç½®</span>
| Â  |-- mcp-servers.json Â  Â <span class="hljs-comment"># GitHubã€Supabaseã€Vercelã€Railway ç­‰</span>
|
|-- marketplace.json Â <span class="hljs-comment"># è‡ªæ‰˜ç®¡å¸‚åœºé…ç½®ï¼ˆç”¨äº /plugin marketplace addï¼‰</span>
</code></pre>
<p>è¿™ä¸ªä»“åº“æœ‰å¤šå°‘ä¸œè¥¿ï¼Ÿ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f5022bd62be459b8942d333c5a04be0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ICB6YeR5bim5L2g546pQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770893178&amp;x-signature=34LxTZLEojx3RnGzP3dVKBw0tns%3D" alt="Image" loading="lazy"/></p>
<p>ä¸¤ä¸ªæ–°å¢çš„ç”Ÿæ€ç³»ç»Ÿå·¥å…·</p>
<p>æŠ€èƒ½åˆ›å»ºå™¨
ä¸¤ç§æ–¹å¼ä»ä½ çš„ä»“åº“ç”ŸæˆClaude CodeæŠ€èƒ½ï¼š
æœ¬åœ°åˆ†æï¼šç”¨Â /skill-createå‘½ä»¤
GitHubåº”ç”¨ï¼šé«˜çº§åŠŸèƒ½ã€è‡ªåŠ¨PRã€å›¢é˜Ÿå…±äº«</p>
<p>æŒç»­å­¦ä¹ v2
åŸºäºç›´è§‰çš„å­¦ä¹ ç³»ç»Ÿï¼š
/instinct-statusÂ - æŸ¥çœ‹å­¦ä¹ çš„ç›´è§‰
/instinct-importÂ - å¯¼å…¥ä»–äººçš„ç›´è§‰
/instinct-exportÂ - å¯¼å‡ºä½ çš„ç›´è§‰
/evolveÂ - å°†ç›¸å…³ç›´è§‰èšç±»åˆ°æŠ€èƒ½ä¸­</p>
<p>è€é‡‘æˆ‘å»ºè®®å…ˆè¯»the-shortform-guide.mdï¼ŒæŠŠåŸºç¡€é…ç½®æå®šã€‚
ç„¶åå†è¯»the-longform-guide.mdï¼Œå­¦ä¹ è¿›é˜¶æŠ€å·§ã€‚</p>
<h2 data-id="heading-11">è€é‡‘å®æµ‹æ•ˆæœ</h2>
<p>è€é‡‘æˆ‘ç”¨äº†ä¸€å‘¨ï¼Œè¯´è¯´çœŸå®æ„Ÿå—ã€‚</p>
<p>Tokenæ¶ˆè€—é™äº†
æŒ‰ç…§ä½œè€…çš„æ¨¡å‹é€‰æ‹©å»ºè®®ï¼Œç®€å•ä»»åŠ¡ç”¨Haikuï¼Œå¤æ‚ä»»åŠ¡æ‰ç”¨Opusã€‚
æŠŠå‡ ä¸ªMCPæ¢æˆCLI+Skillsã€‚
è€é‡‘æˆ‘ç»Ÿè®¡äº†ä¸€ä¸‹ï¼Œtokenæ¶ˆè€—å¤§æ¦‚é™äº†30%ã€‚</p>
<p>å¼€å‘æ•ˆç‡æå‡
ç”¨äº†Two-Instance Kickoff Patternå¼€æ–°é¡¹ç›®ã€‚
ä»¥å‰æ­å»ºé¡¹ç›®éª¨æ¶è¦åŠå¤©ï¼Œç°åœ¨ä¸¤ä¸ªå°æ—¶æå®šã€‚</p>
<p>ä»£ç è´¨é‡ä¸Šå»äº†
æœ‰äº†5é˜¶æ®µAgentç¼–æ’ï¼Œå¾ˆå¤šé—®é¢˜åœ¨æ—©æœŸå°±è¢«å‘ç°äº†ã€‚
è¿”å·¥ç‡ä»30%é™åˆ°äº†10%å·¦å³ã€‚</p>
<p>Context Roté—®é¢˜ç¼“è§£äº†
Memory Persistence HooksçœŸçš„æœ‰ç”¨ã€‚
ä¹‹å‰20è½®å°±å¼€å§‹"å¤±å¿†"ï¼Œç°åœ¨50è½®è¿˜èƒ½è®°ä½ã€‚</p>
<h2 data-id="heading-12">éœ€è¦æ³¨æ„çš„åœ°æ–¹</h2>
<p>æœ‰å­¦ä¹ æˆæœ¬
è¿™å¥—ä¸œè¥¿åŠŸèƒ½å¾ˆå…¨ï¼Œä½†åˆšä¸Šæ‰‹éœ€è¦èŠ±æ—¶é—´ç†è§£ã€‚
è€é‡‘æˆ‘å»ºè®®å…ˆä»Tokenä¼˜åŒ–å¼€å§‹ï¼Œè¿™ä¸ªè§æ•ˆæœ€å¿«ã€‚</p>
<p>éœ€è¦æ ¹æ®é¡¹ç›®è°ƒæ•´
ä½œè€…çš„é…ç½®æ˜¯é€šç”¨çš„ï¼Œä½†æ¯ä¸ªé¡¹ç›®æƒ…å†µä¸åŒã€‚
æ¯”å¦‚æ¨¡å‹é€‰æ‹©ã€Agentç¼–æ’ï¼Œä½ å¾—æ ¹æ®è‡ªå·±çš„ä»»åŠ¡ç±»å‹è°ƒæ•´ã€‚</p>
<p>å¤åˆæ•ˆåº”éœ€è¦æ—¶é—´
å‰æœŸæŠ•å…¥æ—¶é—´æ„å»ºSkillsã€Commandsã€Agentsã€‚
åæœŸæ‰èƒ½äº«å—å¤åˆ©ã€‚
ä¸è¦æœŸæœ›ç«‹ç«¿è§å½±ã€‚</p>
<h2 data-id="heading-13">ä¸ºä»€ä¹ˆè¿™ä¸ªä»“åº“èƒ½ç«ï¼Ÿ</h2>
<p>è€é‡‘æˆ‘åˆ†æäº†ä¸€ä¸‹ï¼Œ28.8kæ˜Ÿä¸æ˜¯ç™½æ¥çš„ã€‚</p>
<p>è§£å†³çœŸç—›ç‚¹
Tokenæ¶ˆè€—é«˜ã€Context Rotã€æ•ˆç‡ä½ï¼Œè¿™äº›æ˜¯Claude Codeç”¨æˆ·çš„æ™®éé—®é¢˜ã€‚
è¿™ä¸ªä»“åº“æä¾›äº†ä¸€å¥—ç³»ç»Ÿæ€§çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>å®æˆ˜éªŒè¯
è¿™ä¸æ˜¯ä½œè€…æ‹è„‘è¢‹æƒ³å‡ºæ¥çš„é…ç½®ï¼Œè€Œæ˜¯10ä¸ªæœˆå®é™…ä½¿ç”¨ã€ä¸æ–­è¿­ä»£çš„ç»“æœã€‚
é»‘å®¢æ¾å† å†›æœ¬èº«å°±æ˜¯æœ€å¥½çš„èƒŒä¹¦ã€‚</p>
<p>æ–¹æ³•è®ºå®Œæ•´
ä¸åªæ˜¯ç»™ä½ é…ç½®æ–‡ä»¶ï¼Œè¿˜å‘Šè¯‰ä½ ä¸ºä»€ä¹ˆè¿™æ ·åšã€‚
ä»Tokenä¼˜åŒ–åˆ°Agentç¼–æ’åˆ°å¤åˆæ•ˆåº”ï¼Œå½¢æˆé—­ç¯ã€‚</p>
<p>æ–‡æ¡£å†™å¾—å¥½
ä½œè€…å†™äº†ä¸¤ä»½æŒ‡å—ï¼Œshortformå’Œlongformã€‚
ä»å…¥é—¨åˆ°è¿›é˜¶ï¼Œè¦†ç›–å®Œæ•´ã€‚
è€é‡‘æˆ‘è¯»å®Œlongform guideï¼Œå­¦åˆ°äº†å¾ˆå¤šä¹‹å‰ä¸çŸ¥é“çš„æŠ€å·§ã€‚</p>
<hr/>
<h2 data-id="heading-14">å››ç§è®°å¿†æ–¹æ¡ˆæ€ä¹ˆé€‰ï¼Ÿ</h2>
<p>è€é‡‘æˆ‘ä¹‹å‰ä»‹ç»è¿‡3ä¸ªè®°å¿†æ–¹æ¡ˆï¼Œè¿™é‡Œç»Ÿä¸€å¯¹æ¯”ä¸€ä¸‹ã€‚</p>
<p>æ–¹æ¡ˆ1ï¼šclaude-memï¼ˆè½»é‡å·¥å…·ï¼‰
ä¸¤è¡Œå‘½ä»¤å®‰è£…ï¼Œè‡ªåŠ¨æ•è·å¯¹è¯å­˜åˆ°æœ¬åœ°æ•°æ®åº“ã€‚
åªæ”¯æŒClaude Codeï¼Œç®€å•çœäº‹ã€‚
é€‚åˆåªæƒ³è§£å†³è®°å¿†é—®é¢˜ã€ä¸æƒ³æŠ˜è…¾çš„äººã€‚</p>
<p>æ–¹æ¡ˆ2ï¼šmcp-memory-serviceï¼ˆé‡é‡å·¥å…·ï¼‰
æ”¯æŒ13+ä¸ªAIå®¢æˆ·ç«¯ï¼Œæœ‰æ··åˆå­˜å‚¨ã€æ™ºèƒ½åˆ†ç±»ã€å›¢é˜Ÿåä½œã€‚
åŠŸèƒ½å¼ºå¤§ï¼Œä½†é…ç½®å¤æ‚ã€‚
é€‚åˆè·¨å¤šä¸ªAIå·¥å…·ç”¨ã€æœ‰å›¢é˜Ÿåä½œéœ€æ±‚çš„äººã€‚</p>
<p>æ–¹æ¡ˆ3ï¼šopenclawä¸‰å±‚æ¶æ„ï¼ˆæ¦‚å¿µæ€§ï¼‰
çŸ¥è¯†å›¾è°±+æ¯æ—¥ç¬”è®°+éšæ€§çŸ¥è¯†ï¼Œæ˜¯ä¸€ç§è®°å¿†è®¾è®¡æ€è·¯ã€‚
é€‚åˆç†è§£è®°å¿†ç³»ç»Ÿçš„åŸç†ï¼Œä½†éœ€è¦è‡ªå·±å®ç°ã€‚</p>
<p>æ–¹æ¡ˆ4ï¼ševerything-claude-codeï¼ˆæœ¬æ–‡ä»‹ç»ï¼‰
ä¸åªæ˜¯è®°å¿†ï¼Œæ˜¯ä¸€å¥—å®Œæ•´çš„Claude Codeå·¥ä½œæµæ–¹æ³•è®ºã€‚
åŒ…æ‹¬Tokenä¼˜åŒ–ã€Agentç¼–æ’ã€å¹¶è¡ŒåŒ–ã€éªŒè¯å¾ªç¯ã€å¤åˆæ•ˆåº”ã€‚
è®°å¿†åªæ˜¯å…¶ä¸­ä¸€å°éƒ¨åˆ†ï¼Œç”¨Hookså®ç°ã€‚
é€‚åˆæƒ³è¦ç³»ç»Ÿæ€§æå‡Claude Codeä½¿ç”¨æ•ˆç‡çš„äººã€‚</p>
<p>æ€ä¹ˆé€‰ï¼Ÿ
åªæƒ³è§£å†³è®°å¿†é—®é¢˜ï¼Œé€‰claude-memï¼Œæœ€ç®€å•ã€‚
æƒ³è·¨å¤šä¸ªAIå·¥å…·ç”¨ï¼Œé€‰mcp-memory-serviceï¼Œæœ€å¼ºå¤§ã€‚
æƒ³è¦å®Œæ•´çš„Claude Codeæ–¹æ³•è®ºï¼Œé€‰everything-claude-codeï¼Œæœ¬æ–‡ä»‹ç»çš„ã€‚</p>
<p>è¿™äº›æ–¹æ¡ˆå¯ä»¥ç»„åˆä½¿ç”¨ï¼Œä¸å†²çªã€‚</p>
<hr/>
<p>å‰3ç¯‡æ–‡ç« åœ°å€ï¼š</p>
<ul>
<li>claude-memï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzI0NzU2MDgyNA%3D%3D%26mid%3D2247490130%26idx%3D1%26sn%3Dcb9032f50e8017646cb4021c5a423b29%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzI0NzU2MDgyNA==&amp;mid=2247490130&amp;idx=1&amp;sn=cb9032f50e8017646cb4021c5a423b29&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">Claude Codeå¼€å§‹å¤±å¿†äº†ï¼Ÿä¸¤å¤§è®°å¿†ç¥å™¨å¸®ä½ é€‰</a></li>
<li>mcp-memory-serviceï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzI0NzU2MDgyNA%3D%3D%26mid%3D2247490195%26idx%3D1%26sn%3Dd5dba3d7bff4e486c6d02a5f8973e9e2%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzI0NzU2MDgyNA==&amp;mid=2247490195&amp;idx=1&amp;sn=d5dba3d7bff4e486c6d02a5f8973e9e2&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">çƒ¦é€äº†æ¯æ¬¡ç»™Claudeé‡å¤èƒŒæ™¯ï¼Ÿæ‰‹æŠŠæ‰‹æ•™ä½ è£…è¿™ä¸ªç¥å™¨ï¼Œç»ˆæè®°å¿†ç¥å™¨</a></li>
<li>openclawä¸‰å±‚æ¶æ„ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzI0NzU2MDgyNA%3D%3D%26mid%3D2247491035%26idx%3D1%26sn%3Dd8f8bb398a5ee4caddb4129b373fb528%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzI0NzU2MDgyNA==&amp;mid=2247491035&amp;idx=1&amp;sn=d8f8bb398a5ee4caddb4129b373fb528&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">è¹­ä¸Š150k Starçš„çƒ­ç‚¹ï¼Œä»clawdbotå­¦ä¼šäº†ç»™AIåŠ è‡ªåŠ¨è®°å¿†ï¼</a></li>
</ul>
<h2 data-id="heading-15">è€é‡‘å»ºè®®</h2>
<p>å¦‚æœä½ æ¯å¤©éƒ½åœ¨ç”¨Claude Codeå†™ä»£ç ï¼Œè¿™ä¸ªä»“åº“å€¼å¾—èŠ±æ—¶é—´ç ”ç©¶ã€‚</p>
<p>ç¬¬ä¸€æ­¥ï¼šå…ˆè¯»the-shortform-guide.mdï¼ŒæŠŠåŸºç¡€é…ç½®æå®šã€‚
ç¬¬äºŒæ­¥ï¼šå­¦ä¹ Tokenä¼˜åŒ–ç­–ç•¥ï¼Œè°ƒæ•´æ¨¡å‹é€‰æ‹©ï¼Œç”¨mgrepæ›¿ä»£grepã€‚
ç¬¬ä¸‰æ­¥ï¼šå°è¯•5é˜¶æ®µAgentç¼–æ’ï¼Œè®©å·¥ä½œæµæ›´ç³»ç»ŸåŒ–ã€‚
ç¬¬å››æ­¥ï¼šæŠŠå¸¸ç”¨çš„MCPæ¢æˆCLI+Skillsï¼ŒèŠ‚çœä¸Šä¸‹æ–‡å’Œtokenã€‚
ç¬¬äº”æ­¥ï¼šæŠ•èµ„å¯å¤ç”¨çš„æ¨¡å¼ï¼Œäº«å—å¤åˆæ•ˆåº”ã€‚</p>
<p>è€é‡‘æˆ‘æœ€è¿‘åœ¨æŠŠè¿™å¥—æ–¹æ³•è®ºèåˆåˆ°è‡ªå·±çš„é¡¹ç›®é‡Œã€‚
ç­‰ç”¨ä¸€æ®µæ—¶é—´ï¼Œå†ç»™ä½ ä»¬å†™ä¸ªæ·±åº¦æµ‹è¯„ã€‚</p>
<p>æœ‰é—®é¢˜éšæ—¶é—®è€é‡‘æˆ‘ï¼Œä¸€èµ·äº¤æµï¼</p>
<hr/>
<p><strong>å¾€æœŸæ¨èï¼š</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fappmsgalbum%3F__biz%3DMzI0NzU2MDgyNA%3D%3D%26action%3Dgetalbum%26album_id%3D3704202865347362819%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI0NzU2MDgyNA==&amp;action=getalbum&amp;album_id=3704202865347362819#wechat_redirect" ref="nofollow noopener noreferrer">AIç¼–ç¨‹æ•™ç¨‹åˆ—è¡¨</a>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fappmsgalbum%3F__biz%3DMzI0NzU2MDgyNA%3D%3D%26action%3Dgetalbum%26album_id%3D4120385726238392327%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI0NzU2MDgyNA==&amp;action=getalbum&amp;album_id=4120385726238392327#wechat_redirect" ref="nofollow noopener noreferrer">æç¤ºè¯å·¥å·¥ç¨‹ï¼ˆPrompt Engineeringï¼‰</a>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fappmsgalbum%3F__biz%3DMzI0NzU2MDgyNA%3D%3D%26action%3Dgetalbum%26album_id%3D3171759118513111043%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI0NzU2MDgyNA==&amp;action=getalbum&amp;album_id=3171759118513111043#wechat_redirect" ref="nofollow noopener noreferrer">LLMOPS(å¤§è¯­è¨€æ¨¡è¿ç»´å¹³å°)</a>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fappmsgalbum%3F__biz%3DMzI0NzU2MDgyNA%3D%3D%26action%3Dgetalbum%26album_id%3D3192433076551843848%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI0NzU2MDgyNA==&amp;action=getalbum&amp;album_id=3192433076551843848#wechat_redirect" ref="nofollow noopener noreferrer">AIç»˜ç”»æ•™ç¨‹åˆ—è¡¨</a>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fappmsgalbum%3F__biz%3DMzI0NzU2MDgyNA%3D%3D%26action%3Dgetalbum%26album_id%3D3502843007181520907%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI0NzU2MDgyNA==&amp;action=getalbum&amp;album_id=3502843007181520907#wechat_redirect" ref="nofollow noopener noreferrer">WXæœºå™¨äººæ•™ç¨‹åˆ—è¡¨</a></p>
<hr/>
<p>æ¯æ¬¡æˆ‘éƒ½æƒ³æé†’ä¸€ä¸‹ï¼Œè¿™ä¸æ˜¯å‡¡å°”èµ›ï¼Œæ˜¯å¸Œæœ›æœ‰æƒ³æ³•çš„äººå‹‡æ•¢å†²ã€‚
æˆ‘ä¸ä¼šä»£ç ï¼Œæˆ‘è‹±è¯­ä¹Ÿä¸å¥½ï¼Œä½†æ˜¯æˆ‘åšå‡ºæ¥äº†å¾ˆå¤šä¸œè¥¿ï¼Œåœ¨æ–‡æœ«çš„å¼€æºçŸ¥è¯†åº“å¯è§ã€‚
æˆ‘çœŸå¿ƒå¸Œæœ›èƒ½å½±å“æ›´å¤šçš„äººæ¥å°è¯•æ–°çš„æŠ€å·§ï¼Œè¿æ¥æ–°çš„æ—¶ä»£ã€‚</p>
<p>è°¢è°¢ä½ è¯»æˆ‘çš„æ–‡ç« ã€‚
å¦‚æœè§‰å¾—ä¸é”™ï¼Œéšæ‰‹ç‚¹ä¸ªèµã€åœ¨çœ‹ã€è½¬å‘ä¸‰è¿å§ğŸ™‚
å¦‚æœæƒ³ç¬¬ä¸€æ—¶é—´æ”¶åˆ°æ¨é€ï¼Œä¹Ÿå¯ä»¥ç»™æˆ‘ä¸ªæ˜Ÿæ ‡â­ï½è°¢è°¢ä½ çœ‹æˆ‘çš„æ–‡ç« ã€‚</p>
<p>å¼€æºçŸ¥è¯†åº“åœ°å€ï¼š
<a href="https://link.juejin.cn?target=https%3A%2F%2Ftffyvtlai4.feishu.cn%2Fwiki%2FOhQ8wqntFihcI1kWVDlcNdpznFf" target="_blank" title="https://tffyvtlai4.feishu.cn/wiki/OhQ8wqntFihcI1kWVDlcNdpznFf" ref="nofollow noopener noreferrer">tffyvtlai4.feishu.cn/wiki/OhQ8wqâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[[å¤§æ¨¡å‹å®æˆ˜ 03] æ‹†è§£ Transformersï¼šä»åŸç†å›¾è§£åˆ° HuggingFace Transformers å®æˆ˜]]></title>    <link>https://juejin.cn/post/7603183929251627060</link>    <guid>https://juejin.cn/post/7603183929251627060</guid>    <pubDate>2026-02-05T11:26:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603183929251627060" data-draft-id="7603183929251610676" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="[å¤§æ¨¡å‹å®æˆ˜ 03] æ‹†è§£ Transformersï¼šä»åŸç†å›¾è§£åˆ° HuggingFace Transformers å®æˆ˜"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2026-02-05T11:26:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿å°”çš„ä»£ç å±‹"/> <meta itemprop="url" content="https://juejin.cn/user/2637068702854868"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            [å¤§æ¨¡å‹å®æˆ˜ 03] æ‹†è§£ Transformersï¼šä»åŸç†å›¾è§£åˆ° HuggingFace Transformers å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2637068702854868/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿å°”çš„ä»£ç å±‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T11:26:04.000Z" title="Thu Feb 05 2026 11:26:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">[å¤§æ¨¡å‹å®æˆ˜ 03] æ‹†è§£ Transformersï¼šä»åŸç†å›¾è§£åˆ° HuggingFace Transformers å®æˆ˜</h2>
<blockquote>
<p><strong>æ ¸å¿ƒæ‘˜è¦ (TL;DR)</strong></p>
<ul>
<li><strong>åŸç†</strong>ï¼šå›¾è§£ Transformer æ˜¯å¦‚ä½•é€šè¿‡â€œæ³¨æ„åŠ›æœºåˆ¶â€å’Œâ€œä½ç½®ç¼–ç â€æ¥ç†è§£äººç±»è¯­è¨€çš„ã€‚</li>
<li><strong>å®æˆ˜</strong>ï¼šåœ¨ <strong>Kaggle (åŒ T4 GPU)</strong> ç¯å¢ƒä¸‹ï¼Œæ‹†è§£ HuggingFace ä»£ç çš„â€œé“ä¸‰è§’â€ï¼ˆConfig, Tokenizer, Modelï¼‰ã€‚</li>
<li><strong>æŠ€å·§</strong>ï¼šæŒæ¡ <code>Temperature</code> å’Œ <code>Top_p</code>ï¼Œå­¦ä¼šæ§åˆ¶ AI çš„â€œåˆ›é€ åŠ›â€ã€‚</li>
</ul>
</blockquote>
<h3 data-id="heading-1">å‰è¨€</h3>
<p>å„ä½å‹äººä»¬ï¼Œå¤§å®¶å¥½ï¼Œè¿™é‡Œæ˜¯é˜¿å°”ã€‚åœ¨ä¸Šä¸€èŠ‚çš„â€œç‚¼ä¸¹â€ç¯å¢ƒæ­å»ºä¸­ï¼Œå’±ä»¬æˆåŠŸåœ°å°†Qwen2.5æ¨¡å‹è¿è¡Œäº†èµ·æ¥ï¼Œè·‘é€šäº†ã€‚ ä½†æ˜¯ç›¸ä¿¡å¤§å®¶å¯¹è¿è¡Œçš„æ—¶å€™çš„é‚£äº›å‚æ•°éƒ½ä»£è¡¨ç€ä»€ä¹ˆï¼Œéƒ½è¿˜æ˜¯æ‡µçš„ã€‚ è¿™ç¯‡åšå®¢å°±æ˜¯ä¸ºæ­¤å‡†å¤‡çš„ï¼Œæˆ‘ä»¬æ‰“ç®—å…ˆå¿«é€Ÿå¤§æ¦‚åœ°äº†è§£ä¸€ä¸‹å½“å‰çš„å¤§æ¨¡å‹çš„åº•å±‚åŸç†ï¼Œå†ç»“åˆåœ¨ä¸€èµ·ä»‹ç»é€šç”¨çš„transformersåº“, å»çœ‹çœ‹ä»£ç å’Œå¦‚ä½•å¯¹åº”è¿™äº›ç†è®ºçš„ã€‚</p>
<h3 data-id="heading-2">1. Transformer æç®€åŸç†ï¼šå¤§æ¨¡å‹æ˜¯æ€ä¹ˆæ€è€ƒçš„ï¼Ÿ</h3>
<p>å¤§æ¨¡å‹å’Œæ™®é€šçš„æœºå™¨å­¦ä¹ æ¨¡å‹ä¸€æ ·ï¼Œæœ¬è´¨ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸åŒçš„æ˜¯ï¼Œä¼ ç»Ÿæœºå™¨å­¦ä¹ å¯èƒ½è¾“å…¥çš„æ˜¯ä¸€äº›æ•´ç†å¥½çš„æ•°æ®ï¼Œæ¯”å¦‚æˆ¿å­çš„å°ºå¯¸ï¼Œåœ°æ®µï¼Œè´­ä¹°æ—¶é•¿ï¼Œå’Œå¸‚ä¸­å¿ƒçš„è·ç¦»ç­‰ç­‰æ•°æ®ï¼Œè¾“å‡ºä¸€ä¸ªé¢„æµ‹çš„æ”¾å‡ï¼Œè€Œå¤§æ¨¡å‹è¾“å…¥çš„æ˜¯æˆ‘ä»¬çš„é—®é¢˜ï¼Œæ‹¿åˆ°çš„æ˜¯å¤§æ¨¡å‹ç»™å‡ºçš„å›ç­”ã€‚ä½†ï¼Œå’±ä»¬ç©¶å…¶æ ¹æœ¬ï¼Œå®ƒä»¬éƒ½å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬è¾“å…¥ä¸€äº›ä¸œè¥¿ï¼Œç»è¿‡è¿ç®—ä¹‹åï¼Œè¾“å‡ºç»™æˆ‘ä»¬ä¸€äº›ä¸œè¥¿ã€‚</p>
<p>å¯¹äºå¤§æ¨¡å‹ï¼Œå®ƒçš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ª<strong>ä¸‹ä¸€ä¸ªå­—ç¬¦é¢„æµ‹å™¨</strong>ï¼Œæˆ‘ä»¬è¾“å…¥ä¸€äº›æ–‡å­—ï¼Œå®ƒåªè´Ÿè´£æ ¹æ®å®ƒæ‰€è®­ç»ƒçš„æµ·é‡æ•°æ®ï¼Œè¾“å‡ºæœ€ç¬¦åˆï¼Œæœ€æœ‰å¯èƒ½çš„ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼Œå°±åƒä¸€ä¸ª<strong>æ–‡å­—æ¥é¾™æœºå™¨</strong>ï¼Œå…¶æ ¸å¿ƒä»»åŠ¡åªæœ‰ä¸€ä¸ªï¼š<strong>æ ¹æ®ä¸Šæ–‡ï¼ŒçŒœä¸‹ä¸€ä¸ªå­—æ˜¯ä»€ä¹ˆã€‚</strong></p>
<p>ä¸ºäº†å®ç°è¿™ä¸ªç›®æ ‡ï¼ŒTransformer æ¶æ„ç»å†äº†ä¸€ä¸ªç²¾å¯†çš„æµæ°´çº¿ï¼š
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm03-know-more-about-transformer-lib/01_cover.png" alt="åŒ…å«Transformerçš„5ä¸ªæ­¥éª¤çš„æ€»è§ˆå›¾" loading="lazy"/>
ä¸‹é¢ï¼Œæˆ‘ä»¬ä¼šç¨å¾®è¯¦ç»†ä¸€ç‚¹åœ°ä»‹ç»ä¸€ä¸‹å„ä¸ªæ­¥éª¤ã€‚</p>
<h4 data-id="heading-3">1.1 ç¬¬ä¸€æ­¥ï¼šToken åŒ– (Tokenization) â€”â€” æŸ¥å­—å…¸</h4>
<p>å¤§æ¨¡å‹æ—¢ç„¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯é’ˆå¯¹æ•°å­—è¿›è¡Œå¤„ç†çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªæ³•å­ï¼Œå»å°†æˆ‘ä»¬çš„æ–‡å­—å­—ç¬¦ï¼ˆç”šè‡³æ˜¯å›¾ç‰‡ï¼‰å˜æˆå¤§æ¨¡å‹è®¤è¯†çš„æ•°å­—ï¼ˆæˆ–è€…è¯´å¼ é‡ï¼Œå‘é‡ï¼‰ã€‚ è¿™å°±æ˜¯TokenåŒ–ï¼Œå»åšè¿™ä¸€æ­¥æ“ä½œçš„å‡½æ•°ï¼Œæˆ–è€…æ¨¡å—å°±æ˜¯<strong>åˆ†è¯å™¨ï¼ˆTokenizerï¼‰</strong>ã€‚</p>
<p>é‚£ä¹ˆ<strong>Tokenizer</strong>å…·ä½“æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿå®ƒå®é™…ä¸Šå°±æ˜¯å°†ä¸€ä¸ªä¸ªçš„å­—ç¬¦ï¼Œå¯¹åº”æˆä¸€ä¸ªä¸ªæ•°å­—ï¼Œæˆ–è€…è¯´IDï¼Œå°±åƒASCIIç ä¸€æ ·ï¼Œä¸è¿‡å®ƒåšå¾—æ›´é«˜çº§ã€‚</p>
<p>æŠŠæ¯ä¸€ä¸ªå­—éƒ½æ‰¾ä¸€ä¸ªæ•°å­—å¯¹åº”ï¼Œæœ‰ç‚¹å¥¢ä¾ˆï¼Œç‰¹åˆ«æ˜¯å¯¹äºè‹±è¯­,act, acting,action,actorå…¶å®éƒ½æœ‰ç›¸åŒçš„è¯æ ¹ï¼Œä¸»è¦çš„è¯­ä¹‰æ¥æºäºå…¶è¯æ ¹actï¼Œæ‰€ä»¥åˆ†è¯å™¨æ˜¯æŒ‰ç…§è¯å…ƒï¼ˆtokenï¼‰å»æ‹†åˆ†çš„ï¼Œèƒ½æŠŠæœ‰äº›è¯æ‹†æˆè¯æ ¹ã€å‰ç¼€å’Œåç¼€ç­‰ç­‰ï¼Œå½“ç„¶å…·ä½“å¦‚ä½•æ‹†ï¼Œå–å†³äºå­—å…¸å¦‚ä½•å®šä¹‰ï¼Œå­—å…¸æœ‰å¤šå¤§ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬ç»™ä¸€ä¸ªç®€å•çš„ä¾‹å­</p>
<ul>
<li><strong>è¾“å…¥</strong>ï¼šâ€œæˆ‘çˆ± AIâ€</li>
<li><strong>åŠ¨ä½œ</strong>ï¼šåˆ‡åˆ† -&gt; <code>["æˆ‘", "çˆ±", "AI"]</code> -&gt; æŸ¥è¡¨ -&gt; <code>[2301, 452, 1083]</code>
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm03-know-more-about-transformer-lib/1.1_tokenization.png" alt="TokenåŒ–çš„ç¤ºæ„å›¾" loading="lazy"/></li>
</ul>
<h4 data-id="heading-4">1.2 ç¬¬äºŒæ­¥ï¼šEmbedding &amp; ä½ç½®ç¼–ç  â€”â€” èµ‹äºˆå«ä¹‰ä¸é¡ºåº</h4>
<p>æœ‰äº†tokenä¹‹åï¼Œæˆ‘ä»¬æƒ³çŸ¥é“è¯å’Œè¯çš„å…³ç³»ï¼Œæˆ‘ä»¬æƒ³è¦é€šè¿‡ä¸€ä¸ªå¯ä»¥é‡åŒ–çš„é‡å»åˆ¤æ–­ä¸¤ä¸ªè¯æ˜¯å¦æ˜¯æœ‰å…³ç³»çš„ï¼Œå…³ç³»å¤šå¤§ã€‚è¿™å°±å¼•å…¥äº†æˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªæ¨¡å—ï¼Œè¯åµŒå…¥æ¨¡å—ï¼ˆEmbeddingï¼‰ã€‚</p>
<ul>
<li><strong>Embedding (è¯å‘é‡)</strong>ï¼šæŠŠæ¯ä¸ª ID å˜æˆä¸€ä¸ªé•¿é•¿çš„å‘é‡ï¼ˆæ¯”å¦‚ 4096 ç»´çš„æ•°ç»„ï¼‰ã€‚è¿™ä¸ªå‘é‡åœ¨æ¨¡å‹è®­ç»ƒä¹‹å‰æ˜¯éšæœºçš„ï¼Œå…¶åéšç€æµ·é‡çš„è®­ç»ƒæ•°æ®æ´—ç¤¼ï¼Œè¶Šç›¸å…³çš„è¯å‘é‡è¶Šé è¿‘ï¼Œè¶Šä¸ç›¸å…³çš„è¯è¶Šè¿œç¦»ã€‚è¿™ä¸ªå‘é‡ä»£è¡¨äº†è¯çš„<strong>å«ä¹‰</strong>ã€‚æ¯”å¦‚â€œçŒ«â€å’Œâ€œç‹—â€çš„å‘é‡åœ¨ç©ºé—´é‡Œè·ç¦»å¾ˆè¿‘ï¼Œâ€œè‹¹æœâ€å’Œâ€œæ‰‹æœºâ€åœ¨æŸç§è¯­å¢ƒä¸‹ä¹Ÿæ›´è¿‘ã€‚</li>
</ul>
<p>å…‰çŸ¥é“è¯å’Œè¯çš„å…³ç³»è¿˜ä¸å¤Ÿï¼Œâ€œæˆ‘çˆ±ä½ â€å’Œâ€œä½ çˆ±æˆ‘â€çš„æ¯ä¸€ä¸ªè¯éƒ½æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯å®ƒä»¬ç¡®å®å¯ä»¥ä¸ç›¸å…³çš„ä¸¤ä¸ªå¥å­ï¼Œâ€œå°ç‹—å’¬äº†æˆ‘â€å’Œâ€œæˆ‘å’¬äº†å°ç‹—â€ï¼Œä¹Ÿä¼šè¢«äººè§†ä½œâ€œå¯ä»¥æ­£å¸¸ç†è§£â€å’Œâ€œè¿™äººå¥½åƒä¸å¯¹åŠ²â€ä¸¤ç§å®Œå…¨ä¸åŒçš„ç†è§£ã€‚æ˜¾è€Œæ˜“è§ï¼Œè¯è¯­åœ¨å¥ä¸­çš„ä½ç½®æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¸èƒ½å¼„ä¸¢å®ƒï¼Œä¹Ÿéœ€è¦å°†è¿™ä¸€éƒ¨åˆ†ä¿¡æ¯ä¼ é€’ç»™æ¨¡å‹è®­ç»ƒæ—¶å€™å»å­¦ä¹ ã€‚</p>
<ul>
<li><strong>Positional Encoding (ä½ç½®ç¼–ç )</strong>ï¼šTransformer æ˜¯å¹¶è¡Œè®¡ç®—çš„ï¼ˆå®ƒä¸€çœ¼çœ‹å®Œæ‰€æœ‰è¯ï¼‰ï¼Œè¿™å¯¼è‡´å®ƒä¸çŸ¥é“â€œæˆ‘çˆ±ä½ â€å’Œâ€œä½ çˆ±æˆ‘â€çš„åŒºåˆ«ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ç»™æ¯ä¸ªè¯è´´ä¸Šä¸€ä¸ªâ€œåº§ä½å·â€ï¼Œå‘Šè¯‰æ¨¡å‹è°åœ¨å‰é¢ï¼Œè°åœ¨åé¢ã€‚
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm03-know-more-about-transformer-lib/1.2_ebedding.png" alt="Embedding &amp; ä½ç½®ç¼–ç  â€”â€” èµ‹äºˆå«ä¹‰ä¸é¡ºåºç¤ºæ„å›¾" loading="lazy"/></li>
</ul>
<h4 data-id="heading-5">1.3 ç¬¬ä¸‰æ­¥ï¼šSelf-Attention (è‡ªæ³¨æ„åŠ›) â€”â€” å¯»æ‰¾å…³ç³»</h4>
<p>æ¥ä¸‹æ¥å°±æ˜¯å¤§æ¨¡å‹çš„çµé­‚ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“ä¸€å¥è¯é‡Œçš„æ¯ä¸€ä¸ªè¯å…ƒå’Œå…¶ä»–è¯å…ƒçš„<strong>å…³è”åº¦</strong>ï¼Œå…¶å®å°±æ˜¯ä¸Šä¸‹æ–‡çš„è”ç³»ã€‚å½“æ¨¡å‹å¤„ç†â€œè‹¹æœâ€è¿™ä¸ªè¯æ—¶ï¼Œå¦‚æœä¸Šä¸‹æ–‡é‡Œæœ‰â€œæ‰‹æœºâ€ã€â€œå‘å¸ƒä¼šâ€ï¼Œæ³¨æ„åŠ›æœºåˆ¶ä¼šå‘Šè¯‰æ¨¡å‹ï¼šâ€œå˜¿ï¼Œè¿™é‡Œçš„â€˜è‹¹æœâ€™æŒ‡çš„æ˜¯ç§‘æŠ€å…¬å¸ï¼Œä¸æ˜¯æ°´æœï¼â€,è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œè®©æ¨¡å‹èƒ½ç†è§£ä¸Šä¸‹æ–‡ã€‚
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm03-know-more-about-transformer-lib/1.3-self-attention.png" alt="Self-Attention ç¤ºæ„å›¾" loading="lazy"/></p>
<h4 data-id="heading-6">1.4 ç¬¬å››æ­¥ï¼šMLP (å‰é¦ˆç¥ç»ç½‘ç»œ) â€”â€” æ¶ˆåŒ–å¸æ”¶</h4>
<p>å¦‚æœè¯´æ³¨æ„åŠ›æœºåˆ¶æ˜¯â€œçœ‹â€ï¼Œé‚£ä¹ˆ MLP å°±æ˜¯â€œæƒ³â€ã€‚å®ƒåŒ…å«å¤šå±‚ç¥ç»å…ƒï¼Œè´Ÿè´£å¯¹æå–åˆ°çš„ä¿¡æ¯è¿›è¡Œå¤æ‚çš„éçº¿æ€§å˜æ¢å’Œé€»è¾‘æ¨ç†,ä¹Ÿå°±æ˜¯ä¼ ç»Ÿçš„æ·±åº¦å­¦ä¹ ã€‚
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm03-know-more-about-transformer-lib/1.4-mlp.png" alt="MLP (å‰é¦ˆç¥ç»ç½‘ç»œ)ç¤ºæ„å›¾" loading="lazy"/></p>
<h4 data-id="heading-7">1.5 ç¬¬äº”æ­¥ï¼šDecoder &amp; Softmax â€”â€” è¾“å‡ºæ¦‚ç‡</h4>
<p>ç»è¿‡å±‚å±‚è®¡ç®—ï¼Œæ¨¡å‹æœ€ç»ˆä¼šè¾“å‡ºä¸€ä¸ªåŒ…å«äº†æ‰€æœ‰è¯æ±‡ï¼ˆæ¯”å¦‚ 15 ä¸‡ä¸ªè¯ï¼‰çš„<strong>æ¦‚ç‡åˆ—è¡¨</strong>ã€‚</p>
<ul>
<li><code>AI</code> (80%)</li>
<li><code>åƒ</code> (10%)</li>
<li><code>ç¡</code> (5%)
...
æœ€åï¼Œæˆ‘ä»¬æ ¹æ®è¿™ä¸ªæ¦‚ç‡åˆ—è¡¨ï¼Œé€‰æ‹©ä¸‹ä¸€ä¸ªè¯ã€‚
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm03-know-more-about-transformer-lib/1.5-decoder&amp;softmax.png" alt="è¾“å‡ºæ¦‚ç‡çš„ç¤ºæ„å›¾" loading="lazy"/></li>
</ul>
<hr/>
<p>è¿™å°±æ˜¯å¤§æ¨¡å‹è¯è¯­æ¥é¾™çš„åŸç†äº†ã€‚</p>
<h3 data-id="heading-8">2. æ‹†è§£æ¨¡å‹æ–‡ä»¶å¤¹ï¼šä¸‹è½½ä¸‹æ¥çš„åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>ç†è®ºè®²å®Œäº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹åœ¨ <strong>Kaggle</strong> çš„æ–‡ä»¶ç³»ç»Ÿé‡Œï¼Œè¿™äº›ç†è®ºå˜æˆäº†ä»€ä¹ˆæ–‡ä»¶ã€‚</p>
<p>å½“ä½ ä¸‹è½½ä¸€ä¸ªæ¨¡å‹ï¼ˆä»¥ Qwen2.5-7B ä¸ºä¾‹ï¼‰æ—¶ï¼Œæ–‡ä»¶å¤¹ç»“æ„å¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm03-know-more-about-transformer-lib/safetensor.png" alt="safetensoræ ¼å¼çš„æ–‡ä»¶ç»„ç»‡ç¤ºæ„å›¾" loading="lazy"/></p>
<h4 data-id="heading-9">2.1 æ ¸å¿ƒæ¶æ„ï¼šconfig.json</h4>
<p><strong>config.json</strong>: æ˜¯å¤§æ¨¡å‹çš„èº«ä»½è¯ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯ä½“æ£€è¡¨ï¼Œå®ƒå…¶ä¸­å°±æ˜¯çœŸæ­£çš„æˆ‘ä»¬çš„æ¨¡å‹ï¼Œå…·ä½“ç”±å“ªäº›å±‚æ„æˆï¼Œæ˜¯ä»€ä¹ˆæ¶æ„ç±»å‹ï¼Œéšè—å±‚æœ‰å¤šæ·±ï¼Œæ³¨æ„åŠ›å¤´çš„æ•°é‡æœ‰å‡ ä¸ªï¼Œè¯è¡¨çš„å¤§å°æ˜¯å¤šå°‘ã€‚å¯¹äºå¤§æ¨¡å‹è€Œè¨€ï¼Œå®ƒå°±æ˜¯æ¨¡å‹æœ¬èº«ï¼Œä¹Ÿæ˜¯<strong>éª¨æ¶</strong>ï¼Œå› ä¸ºå¤§æ¨¡å‹é‡è¦çš„æ˜¯è®­ç»ƒå®Œçš„å‚æ•°ï¼Œæ¨¡å‹æœ¬èº«æ˜¯å¾ˆå°çš„ã€‚
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm03-know-more-about-transformer-lib/config.json.png" alt="config.jsonçš„ç¤ºæ„å›¾" loading="lazy"/></p>
<h4 data-id="heading-10">2.2 è¡Œä¸ºé¢„è®¾ï¼šgeneration_config.json</h4>
<p><strong>generation_config.json</strong>:æ˜¯æ¨¡å‹çš„å‡ºå‚é»˜è®¤è®¾ç½®ã€‚
<img src="https://cdn.jsdelivr.net/gh/Algieba-dean/BlogImgs@master/blog-images/test_blog/llm03-know-more-about-transformer-lib/generation_config_.png" alt="generation_configçš„ç¤ºæ„å›¾" loading="lazy"/></p>
<h4 data-id="heading-11">2.3 å¤§è„‘æœ¬èº«ï¼š*.safetensorså’Œ*.index.json</h4>
<p>æœ‰äº†config.jsonä¸­çš„èº¯ä½“ï¼Œæˆ‘ä»¬å†ä»*.safetensorså’Œ*.index.jsonè½½å…¥çµé­‚ï¼Œè¿™æ‰æ˜¯æˆ‘ä»¬èƒ½è¯´ä¼šé“çš„å¤§æ¨¡å‹ã€‚</p>
<ul>
<li><strong><code>model-xxxxx.safetensors</code></strong>ï¼šè¿™é‡Œé¢å­˜çš„æ˜¯å®æ‰“å®çš„<strong>å¼ é‡ï¼ˆTensorï¼‰æ•°æ®</strong>ï¼Œå³æ•°åäº¿ä¸ªå‚æ•°çš„æµ®ç‚¹æ•°ã€‚ä¸ºäº†æ–¹ä¾¿å­˜å‚¨å’ŒåŠ è½½ï¼Œé€šå¸¸ä¼šè¢«åˆ‡åˆ†æˆå¤šä¸ª 2GB-5GB çš„å°æ–‡ä»¶ï¼ˆShardï¼‰ã€‚</li>
<li><strong><code>model.safetensors.index.json</code></strong>ï¼šè¿™æ˜¯ä¸€å¼ <strong>è—å®å›¾</strong>ã€‚å› ä¸ºæƒé‡è¢«åˆ‡åˆ†äº†ï¼Œæ¨¡å‹éœ€è¦çŸ¥é“â€œç¬¬ 5 å±‚çš„æƒé‡â€åˆ°åº•è—åœ¨å“ªä¸ªæ–‡ä»¶é‡Œã€‚
<ul>
<li><strong>å†…éƒ¨é•¿è¿™æ ·</strong>ï¼š
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"metadata"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"total_size"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">15423653888</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"weight_map"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"model.layers.0.self_attn.q_proj.weight"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"model-00001-of-00004.safetensors"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"model.layers.20.mlp.gate_proj.weight"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"model-00003-of-00004.safetensors"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-12">æ•°å­—å’Œæ–‡å­—çš„ç¿»è¯‘å®˜ï¼štokenizerç›¸å…³æ–‡ä»¶</h4>
<ul>
<li><strong><code>vocab.json</code> / <code>merges.txt</code></strong>ï¼šè¿™æ˜¯æœ€åŸå§‹çš„<strong>ç”Ÿè¯è¡¨</strong>ã€‚è®°å½•äº†æ‰€æœ‰å­—ã€è¯æ ¹å¯¹åº”çš„ IDã€‚</li>
<li><strong><code>tokenizer.json</code></strong>ï¼šè¿™æ˜¯ä¸€ä¸ª<strong>ç¼–è¯‘å</strong>çš„é«˜æ•ˆå­—å…¸æ–‡ä»¶ï¼ŒåŒ…å«äº†åˆ†è¯çš„æ‰€æœ‰é€»è¾‘ï¼ˆPre-tokenization, Normalization ç­‰ï¼‰ï¼ŒåŠ è½½é€Ÿåº¦æ¯”è¯»åŸå§‹æ–‡æœ¬å¿«å¾—å¤šã€‚</li>
<li><strong><code>tokenizer_config.json</code> (è‡³å…³é‡è¦)</strong>ï¼šè¿™æ˜¯åˆ†è¯å™¨çš„<strong>é…ç½®æ–‡ä»¶</strong>ã€‚
<ul>
<li>å®ƒå®šä¹‰äº†<strong>ç‰¹æ®Šç¬¦å·</strong>ï¼ˆSpecial Tokensï¼‰ï¼šæ¯”å¦‚å“ªä¸ª ID ä»£è¡¨â€œå¼€å§‹â€ï¼Œå“ªä¸ªä»£è¡¨â€œç»“æŸâ€ã€‚</li>
<li>å®ƒåŒ…å«äº† <strong>Chat Template (èŠå¤©æ¨¡æ¿)</strong>ï¼šè¿™æ˜¯ä¸€æ®µ Jinja2 ä»£ç ï¼Œå†³å®šäº† <code>apply_chat_template</code> å¦‚ä½•å·¥ä½œã€‚</li>
<li><strong>å†…éƒ¨é•¿è¿™æ ·</strong>ï¼š
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"chat_template"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"{% for message in messages %}...&lt;|im_start|&gt;..."</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"eos_token"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"&lt;|im_end|&gt;"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"pad_token"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"&lt;|endoftext|&gt;"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-13">3. Transformersåº“å®æˆ˜ï¼šä»£ç ä¸­çš„â€œé“ä¸‰è§’â€</h3>
<p>åœ¨Transformsåº“ä¸­ï¼Œæˆ‘ä»¬æ°¸è¿œç»•ä¸å¼€ä¸‰ä¸ªæ ¸å¿ƒç±»ã€‚</p>
<p><strong>ç¯å¢ƒå‡†å¤‡ï¼š</strong>
åœ¨ Kaggle å³ä¾§è®¾ç½®ä¸­ï¼Œç¡®ä¿ <strong>Internet: On</strong> ä¸” <strong>Accelerator: GPU T4 x2</strong>ã€‚</p>
<pre><code class="hljs language-python" lang="python">!pip install -U transformers accelerate bitsandbytes
</code></pre>
<h4 data-id="heading-14">3.1 AutoTokenizer (ç¿»è¯‘å®˜)</h4>
<p>å¯¹åº”ç†è®ºä¸­çš„ <strong>Token åŒ–</strong> æ­¥éª¤,å’Œæ¨¡å‹æ–‡ä»¶ä¸­çš„tokenizerç›¸å…³æ–‡ä»¶ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer

model_path = <span class="hljs-string">"/kaggle/input/qwen2.5/transformers/7b-instruct/1/"</span>

<span class="hljs-comment"># åŠ è½½åˆ†è¯å™¨</span>
tokenizer = AutoTokenizer.from_pretrained(model_path, trust_remote_code=<span class="hljs-literal">True</span>)

text = <span class="hljs-string">"Transformer is amazing"</span>
<span class="hljs-comment"># 1. ç¼–ç  (Encode): æ–‡æœ¬ -&gt; æ•°å­— ID</span>
input_ids = tokenizer.encode(text)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŸæ–‡: <span class="hljs-subst">{text}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ•°å­— ID: <span class="hljs-subst">{input_ids}</span>"</span>)

<span class="hljs-comment"># 2. è§£ç  (Decode): æ•°å­— ID -&gt; æ–‡æœ¬</span>
decoded_text = tokenizer.decode(input_ids)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¿˜åŸ: <span class="hljs-subst">{decoded_text}</span>"</span>)
</code></pre>
<p>å¾—åˆ°çš„ç»“æœå°†ä¼šæ˜¯è¿™æ ·</p>
<pre><code class="hljs language-bash" lang="bash">åŸæ–‡: Transformer is amazing
æ•°å­— ID: [46358, 374, 7897]
è¿˜åŸ: Transformer is amazing
</code></pre>
<p><strong>å¯¹è¯æ ¼å¼ï¼šChat Template</strong>
å¤§æ¨¡å‹éœ€è¦ç‰¹å®šçš„å¯¹è¯æ ¼å¼ï¼ˆPromptï¼‰ã€‚æ¥å°†æ¨¡å‹çš„å›ç­”ï¼Œå’Œç”¨æˆ·çš„é—®é¢˜åšåŒºåˆ†, æˆ‘ä»¬ä¸€èˆ¬éƒ½å¯ä»¥é€šè¿‡è½½å…¥è¯­è¨€æ¨¡å‹å¯¹åº”æ¨¡æ¿ï¼ˆä¸åŒå®¶çš„æ¨¡å‹ï¼Œå¯èƒ½æ¨¡æ¿ä¼šæœ‰ä¸åŒï¼‰ï¼Œç”šè‡³å»æ‹¼è£…å†å²è®°å½•ã€‚</p>
<pre><code class="hljs language-python" lang="python">messages = [
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªç‰©ç†å­¦å®¶ã€‚"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ç”¨ä¸€å¥è¯è§£é‡Šç›¸å¯¹è®ºã€‚"</span>}
]

<span class="hljs-comment"># è‡ªåŠ¨åº”ç”¨èŠå¤©æ¨¡æ¿</span>
formatted_prompt = tokenizer.apply_chat_template(messages, tokenize=<span class="hljs-literal">False</span>, add_generation_prompt=<span class="hljs-literal">True</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ¨¡å‹å®é™…çœ‹åˆ°çš„è¾“å…¥:\n"</span>, formatted_prompt)
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹</p>
<pre><code class="hljs language-bash" lang="bash">æ¨¡å‹å®é™…çœ‹åˆ°çš„è¾“å…¥:
 &lt;|im_start|&gt;system
ä½ æ˜¯ä¸€ä¸ªç‰©ç†å­¦å®¶ã€‚&lt;|im_end|&gt;
&lt;|im_start|&gt;user
ç”¨ä¸€å¥è¯è§£é‡Šç›¸å¯¹è®ºã€‚&lt;|im_end|&gt;
&lt;|im_start|&gt;assistant
</code></pre>
<p>çœ‹åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬ä¹Ÿèƒ½æ›´å¥½åœ°ç†è§£ï¼Œä¸ºä»€ä¹ˆä¸€ä¸ªæœ¬è´¨æ˜¯è¯è¯­æ¥é¾™çš„æ¨¡å‹ï¼Œèƒ½å¤ŸåŒºåˆ†é—®é¢˜ï¼Œç„¶ååšå‡ºå›ç­”ã€‚å› ä¸ºåœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šè®©ä»–çŸ¥é“&lt;|im_start&gt;è¡¨ç¤ºä¸€ä¸ªmessageçš„å¼€å§‹ï¼Œå…¶ä¸­ä¼šå‘Šè¯‰æ¨¡å‹ï¼Œè¿™å¥è¯æ˜¯è°è¯´çš„ï¼Œè¿™å¥è¯åœ¨ä»€ä¹ˆä½ç½®ç»“æŸï¼Œå®ƒæ¥é¾™çš„æ—¶å€™ä¹Ÿä¼šå¸¦ä¸Šå¼€å§‹å’Œç»“æŸç¬¦å·ï¼Œåœ¨æ¨ç†æ¨¡å‹ä¸­ï¼Œç”šè‡³ä¼šå¸¦ä¸Šæ€è€ƒçš„æ ‡ç­¾ã€‚</p>
<h4 data-id="heading-15">3.2 AutoModel (å¤§è„‘æœ¬ä½“)</h4>
<p>å¯¹åº”ç†è®ºä¸­çš„ <strong>Embedding -&gt; Attention -&gt; MLP</strong> è®¡ç®—è¿‡ç¨‹,é€šè¿‡ä»config.jsonä¸­åŠ è½½æ¨¡å‹èº¯ä½“ï¼Œåœ¨åŠ è½½ä¸Šæ¨¡å‹çš„safetensorçµé­‚æ•°æ®ä»¥åŠgeneration_config.jsonçš„é»˜è®¤åˆå§‹åŒ–,
åœ¨ Kaggle ä¸Šï¼Œæˆ‘ä»¬æ‹¥æœ‰ <strong>åŒ T4 (15GB x 2)</strong>ï¼Œä¸€å®šè¦åˆ©ç”¨ <code>device_map="auto"</code> è®©åº“è‡ªåŠ¨åˆ†é…æ˜¾å­˜ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModelForCausalLM
<span class="hljs-keyword">import</span> torch

<span class="hljs-comment"># åŠ è½½æ¨¡å‹</span>
model = AutoModelForCausalLM.from_pretrained(
    model_path,
    device_map=<span class="hljs-string">"auto"</span>,      <span class="hljs-comment"># å…³é”®ï¼è‡ªåŠ¨å°†æ¨¡å‹åˆ‡åˆ†åˆ°ä¸¤å¼  T4 æ˜¾å¡ä¸Š</span>
    torch_dtype=torch.float16, <span class="hljs-comment"># ä½¿ç”¨åŠç²¾åº¦ï¼ŒèŠ‚çœæ˜¾å­˜</span>
    trust_remote_code=<span class="hljs-literal">True</span>
)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ¨¡å‹åŠ è½½æˆåŠŸï¼æ˜¾å­˜åˆ†å¸ƒ: <span class="hljs-subst">{model.hf_device_map}</span>"</span>)
</code></pre>
<p>è¾“å‡ºç»“æœä¸º</p>
<pre><code class="hljs language-bash" lang="bash">æ¨¡å‹åŠ è½½æˆåŠŸï¼æ˜¾å­˜åˆ†å¸ƒ: {<span class="hljs-string">'model.embed_tokens'</span>: 0, <span class="hljs-string">'model.layers.0'</span>: 0, <span class="hljs-string">'model.layers.1'</span>: 0, <span class="hljs-string">'model.layers.2'</span>: 0, <span class="hljs-string">'model.layers.3'</span>: 0, <span class="hljs-string">'model.layers.4'</span>: 0, <span class="hljs-string">'model.layers.5'</span>: 0, <span class="hljs-string">'model.layers.6'</span>: 0, <span class="hljs-string">'model.layers.7'</span>: 0, <span class="hljs-string">'model.layers.8'</span>: 0, <span class="hljs-string">'model.layers.9'</span>: 0, <span class="hljs-string">'model.layers.10'</span>: 0, <span class="hljs-string">'model.layers.11'</span>: 0, <span class="hljs-string">'model.layers.12'</span>: 1, <span class="hljs-string">'model.layers.13'</span>: 1, <span class="hljs-string">'model.layers.14'</span>: 1, <span class="hljs-string">'model.layers.15'</span>: 1, <span class="hljs-string">'model.layers.16'</span>: 1, <span class="hljs-string">'model.layers.17'</span>: 1, <span class="hljs-string">'model.layers.18'</span>: 1, <span class="hljs-string">'model.layers.19'</span>: 1, <span class="hljs-string">'model.layers.20'</span>: 1, <span class="hljs-string">'model.layers.21'</span>: 1, <span class="hljs-string">'model.layers.22'</span>: 1, <span class="hljs-string">'model.layers.23'</span>: 1, <span class="hljs-string">'model.layers.24'</span>: 1, <span class="hljs-string">'model.layers.25'</span>: 1, <span class="hljs-string">'model.layers.26'</span>: 1, <span class="hljs-string">'model.layers.27'</span>: 1, <span class="hljs-string">'model.norm'</span>: 1, <span class="hljs-string">'model.rotary_emb'</span>: 1, <span class="hljs-string">'lm_head'</span>: 1}
</code></pre>
<h3 data-id="heading-16">4. æŒæ§ç”Ÿæˆçš„â€œè°ƒèŠ‚æ—‹é’®â€</h3>
<p>åœ¨æ¨¡å‹è¾“å‡ºçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€äº›å‚æ•°å¯ä»¥å¯¹è¾“å‡ºç»“æœè¿›è¡Œè°ƒèŠ‚ï¼Œå¯¹åº”äºæˆ‘ä»¬è®²ç†è®ºéƒ¨åˆ†çš„ä¸­çš„ <strong>ç¬¬äº”æ­¥ (Softmax æ¦‚ç‡è¾“å‡º)</strong>, æˆ‘ä»¬æœ‰ä¸€å †ä¸‹ä¸€ä¸ªè¯å…ƒçš„æ¦‚ç‡åˆ†å¸ƒäº†ï¼Œä½†æ˜¯æˆ‘ä»¬åº”è¯¥å¦‚ä½•å»é€‰æ‹©å‘¢ï¼Ÿ</p>
<h4 data-id="heading-17">4.1 Temperature (æ¸©åº¦)</h4>
<p>æˆ‘ä»¬å¯ä»¥è®¾å®šçš„Temperatureå‚æ•°ï¼Œæˆ‘ä»¬åœ¨generation_config.jsonä¸­ä¹Ÿçœ‹è§è¿‡å®ƒ</p>
<p>å€¼è¶Šå¤§ï¼Œæ›´çƒ­ï¼Œæ›´å…·åˆ›é€ æ€§ï¼Œæ›´å®¹æ˜“è¾“å‡ºå„ç§å¤©é©¬è¡Œç©ºçš„è¯, ä¼šç¼©å°æ‰€æœ‰è¯å…ƒçš„å·®è·ï¼Œ<strong>é›¨éœ²å‡æ²¾</strong>ï¼Œä»¥è¾¾åˆ°åˆ›é€ æ€§ï¼Œè®©ä½æ¦‚ç‡çš„è¯ï¼Œä¹Ÿæœ‰æœºä¼šè¢«é€‰ä¸­ï¼Œå½“ç„¶,ä¹Ÿæ›´å®¹æ˜“èƒ¡è¯´å…«é“ï¼Œå‡ºç°å¹»è§‰.
å€¼è¶Šå°ï¼Œæ›´å†·ï¼Œæ›´ä¸¥è‚ƒï¼Œåœ¨æ¸©åº¦ä¸º0çš„æ—¶å€™ç”šè‡³ä¼šå›ºå®šè¾“å‡ºæœ€é«˜çš„é‚£ä¸ªè¯ï¼Œå®ƒä¼šæ‹‰å¤§é«˜æ¦‚ç‡å’Œä½æ¦‚ç‡çš„å·®è·ï¼Œ<strong>èµ¢å®¶é€šåƒ</strong>ï¼Œè®©æ¨¡å‹çš„å›ç­”æ›´ç¨³å®šï¼Œä¸¥è°¨ã€‚</p>
<h4 data-id="heading-18">4.2 Top_p (æ ¸é‡‡æ ·)</h4>
<p>å’Œæ¸©åº¦ä¸åŒï¼Œæˆ‘ä»¬è¿˜æœ‰å¦ä¸€ç§æ–¹å¼ï¼Œè¿™ç§æ–¹å¼æ›´ç±»ä¼¼äºæ‹‰ç½‘ï¼Œæˆ‘ä»¬åªè¦å¯èƒ½æ€§å‰80%çš„è¯ï¼Œåœ¨é‚£äº›è¯é‡Œè¿›è¡ŒæŒ‘é€‰ï¼Œè¿™ä¸ªå¯èƒ½æ€§å°±æ˜¯Pï¼Œè¿™ä¸ªé€‰è¯ï¼ˆé‡‡æ ·ï¼‰æ–¹æ³•åˆå«top_p(æ ¸é‡‡æ ·).
ç®€è€Œè¨€ä¹‹ï¼šå…¶åªåœ¨ç´¯ç§¯æ¦‚ç‡è¾¾åˆ° P (e.g., 0.9) çš„å‰å‡ ä¸ªè¯é‡Œé€‰ã€‚ç›´æ¥åˆ‡æ‰å°¾éƒ¨é‚£äº›æä½æ¦‚ç‡çš„ç¦»è°±è¯ã€‚</p>
<h4 data-id="heading-19">4.3 å®éªŒä¸€ä¸‹</h4>
<p>æˆ‘ä»¬è¿™é‡Œå…ˆå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œä»¥æ¸©åº¦å’Œtop_pä¸ºå‚æ•°å»æµ‹è¯•ä¸åŒçš„å‚æ•°å¯¹å›ç­”çš„å½±å“</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªæµ‹è¯•å‡½æ•°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_generation</span>(<span class="hljs-params">temp, top_p, prompt_text</span>):
    messages = [
        {<span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªå‰å«çš„ç§‘å¹»å°è¯´å®¶ã€‚"</span>},
        {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: prompt_text}
    ]
    text = tokenizer.apply_chat_template(messages, tokenize=<span class="hljs-literal">False</span>, add_generation_prompt=<span class="hljs-literal">True</span>)
    inputs = tokenizer([text], return_tensors=<span class="hljs-string">"pt"</span>).to(model.device)

    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n======== è®¾ç½®: Temperature=<span class="hljs-subst">{temp}</span>, Top_p=<span class="hljs-subst">{top_p}</span> ========"</span>)

    <span class="hljs-keyword">try</span>:
        generated_ids = model.generate(
            **inputs,
            max_new_tokens=<span class="hljs-number">100</span>,  <span class="hljs-comment"># é™åˆ¶é•¿åº¦ï¼Œæ–¹ä¾¿å¿«é€Ÿçœ‹ç»“æœ</span>
            temperature=temp,
            top_p=top_p,
            do_sample=<span class="hljs-literal">True</span>,      <span class="hljs-comment"># å¿…é¡»å¼€å¯é‡‡æ ·</span>
            pad_token_id=tokenizer.eos_token_id
        )
        response = tokenizer.batch_decode(generated_ids, skip_special_tokens=<span class="hljs-literal">True</span>)[<span class="hljs-number">0</span>]
        <span class="hljs-comment"># åªæ‰“å°å›ç­”éƒ¨åˆ†</span>
        <span class="hljs-built_in">print</span>(response.split(<span class="hljs-string">'assistant'</span>)[-<span class="hljs-number">1</span>].strip())
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç”Ÿæˆå‡ºé”™: <span class="hljs-subst">{e}</span>"</span>)
</code></pre>
<h4 data-id="heading-20">æ¸©åº¦å®éªŒ</h4>
<p>ç„¶åå†å…¶ä¸‹æ–°å»ºcode blockå»æµ‹è¯•ï¼Œçœ‹çœ‹æ•ˆæœ</p>
<pre><code class="hljs language-python" lang="python">prompt = <span class="hljs-string">"è¯·ç”¨è¿™ä¸‰ä¸ªè¯å†™ä¸€ä¸ªå¾®æ•…äº‹ï¼šé‡å­ã€å¤±æ‹ã€ç‚’é¥­ã€‚"</span>

<span class="hljs-comment"># 1. ä½æ¸©æ¨¡å¼ (0.1)ï¼šä¸¥è°¨ã€æ­»æ¿</span>
test_generation(temp=<span class="hljs-number">0.1</span>, top_p=<span class="hljs-number">0.9</span>, prompt_text=prompt)

<span class="hljs-comment"># 2. é€‚ä¸­æ¨¡å¼ (0.7)ï¼šæ­£å¸¸ã€æµç•…</span>
test_generation(temp=<span class="hljs-number">0.7</span>, top_p=<span class="hljs-number">0.9</span>, prompt_text=prompt)

<span class="hljs-comment"># 3. é«˜æ¸©æ¨¡å¼ (1.5)ï¼šç–¯ç‹‚ã€æ··ä¹±</span>
<span class="hljs-comment"># æ³¨æ„ï¼šå¯èƒ½ä¼šè¾“å‡ºä¹±ç æˆ–å®Œå…¨ä¸é€šé¡ºçš„å¥å­</span>
test_generation(temp=<span class="hljs-number">1.5</span>, top_p=<span class="hljs-number">0.9</span>, prompt_text=prompt)
</code></pre>
<p>è¿™æ˜¯æˆ‘çš„è¿è¡Œç»“æœ</p>
<pre><code class="hljs language-bash" lang="bash">======== è®¾ç½®: Temperature=0.1, Top_p=0.9 ========
åœ¨é‡å­ä¸–ç•Œé‡Œï¼Œæ—¶é—´ä¸ç©ºé—´çš„æ¦‚å¿µå˜å¾—æ¨¡ç³Šä¸æ¸…ï¼Œè€Œææ˜çš„ä¸–ç•Œä¹Ÿå› ä¸ºä¸€æ®µå¤±è´¥çš„æ‹æƒ…è€Œå˜å¾—ä¸€ç‰‡æ··æ²Œã€‚ä»–å°è¯•ç€ç”¨é‡å­çº ç¼ ç†è®ºæ¥ä¿®å¤è‡ªå·±ç ´ç¢çš„å¿ƒçµï¼Œå´æ„å¤–åœ°å°†è‡ªå·±ä»ç°å®ä¸–ç•Œé€å…¥äº†ä¸€ä¸ªå¹³è¡Œå®‡å®™ã€‚

åœ¨è¿™ä¸ªå¹³è¡Œå®‡å®™ä¸­ï¼Œææ˜å‘ç°äº†ä¸€å®¶ç‰¹åˆ«çš„é¤é¦†ï¼Œè¿™é‡Œçš„å¨å¸ˆæ˜¯ä¸€ä½æ›¾ç»çš„æ‹äººï¼Œå¥¹æ­£åœ¨ä¸ºä¸€ä½é¡¾å®¢å‡†å¤‡ä¸€é“ç‰¹åˆ«çš„ç‚’é¥­ã€‚è¿™é“ç‚’é¥­ä¸ä»…è‰²é¦™å‘³ä¿±å…¨ï¼Œè¿˜

======== è®¾ç½®: Temperature=0.7, Top_p=0.9 ========
åœ¨é‡å­ä¸–ç•Œçš„è¾¹ç¼˜ï¼Œææ˜ç‹¬è‡ªä¸€äººååœ¨ä¸€å®¶ä¸èµ·çœ¼çš„å°é¤é¦†é‡Œï¼Œé¢å‰æ˜¯ä¸€ç¢—æ™®é€šçš„ç‚’é¥­ã€‚ä»–å’Œå¥³æœ‹å‹åˆ†æ‰‹çš„åŸå› ï¼Œæ˜¯å› ä¸ºå¥¹æ²‰è¿·äºè™šæ‹Ÿç°å®ä¸­çš„é‡å­ä¸–ç•Œï¼Œè€Œä»–å´å¯¹ç°å®ä¸–ç•Œå……æ»¡äº†ç•™æ‹ã€‚

å°±åœ¨å‡ å¤©å‰ï¼Œä»–ä»¬æœ€åä¸€æ¬¡äº‰åµåï¼Œå¥¹å‘Šè¯‰ä»–ï¼šâ€œæˆ‘æ‰¾åˆ°äº†çœŸæ­£çš„è‡ªæˆ‘â€”â€”ä¸€ä¸ªç©¿æ¢­åœ¨é‡å­ä¸–ç•Œçš„æ¢ç´¢è€…ã€‚â€å¥¹ç•™ä¸‹äº†ä¸€ç›˜æœªåƒå®Œçš„ç‚’é¥­ï¼Œç„¶åæ¶ˆå¤±åœ¨äº†è™šæ‹Ÿç°å®ä¸­ã€‚

ææ˜æœ›ç€é‚£ç›˜ç‚’é¥­ï¼Œ

======== è®¾ç½®: Temperature=1.5, Top_p=0.9 ========
æ ‡é¢˜ï¼šæ—¶ç©ºæ³¡é¥­

ææ˜æœ€è¿‘å¤±æ‹äº†ï¼Œæ¯å¤©åªèƒ½ç…®ä¸€å¤§é”…æ³¡é¥­æ¥æ¶ˆç£¨æ—¶é—´ã€‚

è¿™å¤©ææ˜æ­£åœ¨åšé¥­ï¼Œä»–å¿½ç„¶æ¥æ”¶åˆ°ä¸€æ¡é‡å­ä¿¡å·ã€‚ä»–æƒŠå¥‡åœ°å‘ç°é‚£æ˜¯è‡ªå·±å¤±æ‹å‰å¥³å‹çš„åæ ‡ä½ç½®ã€‚æƒ³åˆ°èƒ½ä¸è‡ªå·±ç›¸çˆ±è¿‡çš„äººå…±åº¦æ—¶å…‰æ˜¯å¤šä¹ˆç¾å¦™çš„äº‹æƒ…ï¼Œä»–ä¾¿å°†è‡ªå·±ç…®äº†ä¸€é”…æ³¡é¥­é€è¿›äº†åæ ‡ä¼ é€å™¨ã€‚

ç»“æœå´æ˜¯ä¸€é”…ç‚’é¥­ã€‚

ææ˜ç™¾æ€ä¸è§£ã€‚
</code></pre>
<h4 data-id="heading-21">top_på®éªŒ</h4>
<p>æ¥ä¸‹æ¥æ˜¯top_p</p>
<pre><code class="hljs language-python" lang="python">prompt_2 = <span class="hljs-string">"è¯·ç»™ä¸€ç§ä¸å­˜åœ¨çš„é¢œè‰²èµ·ä¸ªåå­—ï¼Œå¹¶æè¿°å®ƒçš„æ ·å­ã€‚"</span>

<span class="hljs-comment"># 1. æçª„é‡‡æ · (0.01)ï¼šåªé€‰æ¦‚ç‡æœ€é«˜çš„é‚£ä¸ªè¯ï¼ˆè¿‘ä¼¼è´ªå©ªæœç´¢ï¼‰</span>
test_generation(temp=<span class="hljs-number">0.8</span>, top_p=<span class="hljs-number">0.01</span>, prompt_text=prompt_2)

<span class="hljs-comment"># 2. å®½å¹¿é‡‡æ · (0.95)ï¼šå…è®¸ç½•è§è¯å‡ºç°</span>
test_generation(temp=<span class="hljs-number">0.8</span>, top_p=<span class="hljs-number">0.95</span>, prompt_text=prompt_2)
</code></pre>
<p>è¾“å‡ºç»“æœä¸º</p>
<pre><code class="hljs language-bash" lang="bash">======== è®¾ç½®: Temperature=0.8, Top_p=0.01 ========
è¿™ç§ä¸å­˜åœ¨çš„é¢œè‰²æˆ‘å‘½åä¸ºâ€œæ˜Ÿå°˜ç´«â€ã€‚å®ƒæ˜¯ä¸€ç§æ¢¦å¹»èˆ¬çš„é¢œè‰²ï¼Œä»‹äºç´«è‰²å’Œé“¶è‰²ä¹‹é—´ï¼Œä»¿ä½›æ˜¯å®‡å®™ä¸­æ— æ•°å¾®å°çš„æ˜Ÿè¾°ç¢ç‰‡åœ¨é—ªçƒæ—¶æ‰€æ•£å‘å‡ºçš„å…‰èŠ’ã€‚åœ¨ä¸åŒçš„å…‰çº¿ä¸‹ï¼Œæ˜Ÿå°˜ç´«ä¼šå‘ˆç°å‡ºä¸åŒçš„è‰²è°ƒï¼Œæœ‰æ—¶åç´«ï¼Œæœ‰æ—¶åé“¶ï¼Œæœ‰æ—¶åˆåƒæ˜¯æºæ‚äº†ç‚¹ç‚¹æ˜Ÿå…‰çš„æ·¡è“è‰²ã€‚å®ƒæ—¢ç¥ç§˜åˆä¼˜é›…ï¼Œä»¿ä½›èƒ½è®©äººæ„Ÿå—åˆ°å®‡å®™çš„æµ©ç€šä¸æ·±é‚ƒã€‚

======== è®¾ç½®: Temperature=0.8, Top_p=0.95 ========
è¿™ç§ä¸å­˜åœ¨çš„é¢œè‰²æˆ‘ç§°ä¹‹ä¸ºâ€œæ˜Ÿé™…å¹»å½©â€ï¼ˆStellar Mirageï¼‰ã€‚åœ¨è§†è§‰ä¸Šï¼Œå®ƒå¹¶éå•ä¸€è‰²è°ƒï¼Œè€Œæ˜¯ä¸€ç§åŠ¨æ€å˜åŒ–çš„è‰²å½©ç»„åˆï¼Œåƒæ˜¯æ— æ•°å¾®å°çš„å…‰ç‚¹åœ¨çœ¼å‰é—ªçƒå˜å¹»ï¼Œè¿™äº›å…‰ç‚¹åŒ…å«äº†æ‰€æœ‰å¯è§å…‰è°±çš„é¢œè‰²ï¼ŒåŒæ—¶åˆå¸¦ç€ä¸€ç§ç¥ç§˜çš„ã€ä¸å¯åçŠ¶çš„è‰²å½©ã€‚

å½“è§‚å¯Ÿè€…æ³¨è§†ç€â€œæ˜Ÿé™…å¹»å½©â€çš„æ—¶å€™ï¼Œä»–å¯ä»¥çœ‹åˆ°è“ã€ç»¿ã€ç´«ç­‰é¢œè‰²å¿«é€Ÿåœ°åœ¨çœ¼å‰åˆ‡æ¢å’Œæ··åˆï¼Œå®ƒä»¬ä»¥ä¸€ç§å‡ 
</code></pre>
<h3 data-id="heading-22">5. å®Œæ•´ Transformers ä»£ç å®æˆ˜</h3>
<p>æŠŠæ‰€æœ‰ç§¯æœ¨æ­åœ¨ä¸€èµ·ï¼Œè¿™å°±æ˜¯ä¸€æ®µæ ‡å‡†çš„æ¨¡å‹æ¨ç†ä»£ç ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModelForCausalLM, AutoTokenizer

<span class="hljs-comment"># 1. è®¾ç½®æ¨¡å‹ ID</span>
model_id = <span class="hljs-string">"/kaggle/input/qwen2.5/transformers/7b-instruct/1/"</span>

<span class="hljs-comment"># 2. åŠ è½½ç¿»è¯‘å®˜</span>
tokenizer = AutoTokenizer.from_pretrained(model_id, trust_remote_code=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># 3. åŠ è½½å¤§è„‘ (åŒå¡æ¨¡å¼)</span>
model = AutoModelForCausalLM.from_pretrained(
    model_id,
    device_map=<span class="hljs-string">"auto"</span>,
    torch_dtype=torch.float16,
    trust_remote_code=<span class="hljs-literal">True</span>
)

<span class="hljs-comment"># 4. å‡†å¤‡è¾“å…¥</span>
prompt = <span class="hljs-string">"è¯·ç”¨è¿™ä¸‰ä¸ªè¯å†™ä¸€ä¸ªå¾®å°è¯´ï¼šKaggleã€æ·±å¤œã€çˆ†æ˜¾å­˜"</span>
messages = [
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªå¹½é»˜çš„ç¨‹åºå‘˜ã€‚"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: prompt}
]

text = tokenizer.apply_chat_template(messages, tokenize=<span class="hljs-literal">False</span>, add_generation_prompt=<span class="hljs-literal">True</span>)
model_inputs = tokenizer([text], return_tensors=<span class="hljs-string">"pt"</span>).to(model.device)

<span class="hljs-comment"># 5. ç”Ÿæˆ (è°ƒèŠ‚å‚æ•°ï¼)</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">" æ­£åœ¨ç”Ÿæˆ..."</span>)
generated_ids = model.generate(
    **model_inputs,
    max_new_tokens=<span class="hljs-number">512</span>,
    temperature=<span class="hljs-number">0.8</span>,  <span class="hljs-comment"># ç¨å¾®æœ‰ç‚¹åˆ›æ„</span>
    top_p=<span class="hljs-number">0.9</span>,        <span class="hljs-comment"># å‰”é™¤ç¦»è°±è¯</span>
    do_sample=<span class="hljs-literal">True</span>    <span class="hljs-comment"># å¿…é¡»å¼€å¯é‡‡æ ·ï¼Œæ¸©åº¦æ‰ç”Ÿæ•ˆ</span>
)

<span class="hljs-comment"># 6. è§£ç å¹¶è¾“å‡º</span>
generated_ids = [
    output_ids[<span class="hljs-built_in">len</span>(input_ids):] <span class="hljs-keyword">for</span> input_ids, output_ids <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(model_inputs.input_ids, generated_ids)
]
response = tokenizer.batch_decode(generated_ids, skip_special_tokens=<span class="hljs-literal">True</span>)[<span class="hljs-number">0</span>]

<span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span> * <span class="hljs-number">20</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f" å›ç­”:\n<span class="hljs-subst">{response}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span> * <span class="hljs-number">20</span>)
</code></pre>
<p>è¿™æ˜¯è¾“å‡ºç»“æœ</p>
<pre><code class="hljs language-bash" lang="bash">Loadingâ€‡checkpointâ€‡shards:â€‡100%
â€‡4/4â€‡[00:13&lt;00:00,â€‡â€‡3.27s/it]
The module name  (originally ) is not a valid Python identifier. Please rename the original module to avoid import issues.
WARNING:accelerate.big_modeling:Some parameters are on the meta device because they were offloaded to the cpu.
 æ­£åœ¨ç”Ÿæˆ...
--------------------
 å›ç­”:
åœ¨ä¸€ä¸ªå¯’å†·çš„æ·±å¤œï¼Œæé›·ååœ¨ä»–é‚£é—´å †æ»¡å’–å•¡ç½å’Œä»£ç æ–‡ä»¶çš„æˆ¿é—´é‡Œï¼Œå±å¹•ä¸Šæ˜¯Kaggleç«èµ›çš„æ•°æ®é›†ã€‚ä»–æ­£å°è¯•è®­ç»ƒä¸€ä¸ªå¤æ‚çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚ç„¶è€Œï¼Œå°±åœ¨ä»–è®¤ä¸ºèƒœåˆ©åœ¨æœ›çš„æ—¶å€™ï¼Œâ€œå˜¶~â€çš„ä¸€å£°ï¼Œæ˜¾ç¤ºå™¨ç¬é—´å˜æˆäº†ä¸€ç‰‡æ¼†é»‘ï¼Œä¼´éšç€ä¸€å£°æ‚²å£®çš„â€œçˆ†æ˜¾å­˜äº†â€ã€‚

æé›·æ‰äº†æ‰çœ¼ç›ï¼Œçœ‹ç€çœ¼å‰ä¸€ç‰‡ç©ºç™½çš„å±å¹•ï¼Œå¿ƒä¸­å……æ»¡äº†æŒ«è´¥æ„Ÿï¼Œä½†ä»–è½¬å¿µä¸€æƒ³ï¼šâ€œè¿˜å¥½ä¸æ˜¯â€˜çˆ†å†…å­˜äº†â€™ï¼Œå¦åˆ™æˆ‘è¿™å°è€æ—§ç”µè„‘å¯èƒ½å°±è¦å½»åº•é€€ä¼‘äº†ã€‚â€äºæ˜¯ï¼Œä»–åˆå¼€å§‹è°ƒæ•´å‚æ•°ï¼Œå¸Œæœ›èƒ½åœ¨è¿™ä¸ªæ·±å¤œé‡Œæ‰¾åˆ°é‚£ä¸ªéšè—åœ¨æ•°æ®æµ·æ´‹ä¸­çš„å®è—ã€‚
--------------------
</code></pre>
<h4 data-id="heading-23">Hint:</h4>
<p><strong>æ‰€æœ‰çš„ä»£ç ï¼Œéƒ½å¯ä»¥åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.kaggle.com%2Fcode%2Fthaodinhoio%2Fllm03-transformers" target="_blank" title="https://www.kaggle.com/code/thaodinhoio/llm03-transformers" ref="nofollow noopener noreferrer">è¿™ä¸ªç¬”è®°æœ¬</a>ä¸­ç›´æ¥è·å–è¿è¡Œå“¦</strong></p>
<h3 data-id="heading-24">6. å¸¸è§é—®é¢˜ (Q&amp;A)</h3>
<p><strong>Q: åœ¨ Kaggle ä¸Š <code>device_map="auto"</code> æ˜¯å¿…é¡»çš„å—ï¼Ÿ</strong>
<strong>A:</strong> å¦‚æœä½ ä½¿ç”¨å•å¡ T4 (15GB) è·‘ 7B æ¨¡å‹ï¼ˆçº¦ 14GBï¼‰ï¼Œå‹‰å¼ºèƒ½å¡è¿›ä¸€å¼ å¡ã€‚ä½†å¦‚æœä½ å¼€å¯äº† Kaggle çš„ <strong>T4 x2</strong>ï¼Œä¸ºäº†åˆ©ç”¨å…¨éƒ¨ 30GB æ˜¾å­˜ï¼Œ<strong>å¿…é¡»</strong>åŠ è¿™ä¸ªå‚æ•°ï¼Œå¦åˆ™æ¨¡å‹åªä¼šå¡è¿›ç¬¬ä¸€å¼ å¡ï¼Œå¯¼è‡´ç¬¬ä¸€å¼ çˆ†æ»¡ï¼Œç¬¬äºŒå¼ å›´è§‚ã€‚</p>
<p><strong>Q: ä¸ºä»€ä¹ˆç”Ÿæˆçš„æ¯ä¸€å¥è¯éƒ½ä¸ä¸€æ ·ï¼Ÿ</strong>
<strong>A:</strong> å› ä¸ºæˆ‘ä»¬å¼€å¯äº† <code>do_sample=True</code> å¹¶ä¸”è®¾ç½®äº† <code>temperature &gt; 0</code>ã€‚æ¨¡å‹åœ¨é€‰æ‹©ä¸‹ä¸€ä¸ªè¯æ—¶æ˜¯<strong>æŒ‰æ¦‚ç‡éšæœºæŠ½å–</strong>çš„ã€‚å¦‚æœä½ æƒ³è®©ç»“æœæ¯æ¬¡éƒ½ä¸€æ ·ï¼ˆæ¯”å¦‚åšæ•°å­¦é¢˜ï¼‰ï¼Œè¯·è®¾ç½® <code>do_sample=False</code>ï¼ˆæ­¤æ—¶æ¸©åº¦å¤±æ•ˆï¼Œå˜ä¸ºè´ªå©ªè§£ç ï¼‰ã€‚</p>
<p><strong>Q: ä»€ä¹ˆæ˜¯ Logitsï¼Ÿ</strong>
<strong>A:</strong> åœ¨ä»£ç æ·±å¤„ï¼Œæ¨¡å‹è¾“å‡ºçš„é‚£ä¸ªâ€œæ¦‚ç‡è¡¨â€åœ¨å˜æˆç™¾åˆ†æ¯”ä¹‹å‰ï¼Œå« Logitsï¼ˆæœªå½’ä¸€åŒ–çš„æ•°å€¼ï¼‰ã€‚Softmax å‡½æ•°çš„ä½œç”¨å°±æ˜¯æŠŠ Logits å˜æˆæ¦‚ç‡ã€‚ä½ å¯ä»¥æŠŠ Logits ç†è§£ä¸ºæ¨¡å‹å¯¹æ¯ä¸ªè¯çš„â€œåŸå§‹æ‰“åˆ†â€ã€‚</p>
<p><strong>Q: Token å’Œå­—æ˜¯ä¸€ä¸€å¯¹åº”çš„å—ï¼Ÿ</strong>
<strong>A:</strong> ä¸ä¸€å®šã€‚</p>
<ul>
<li>è‹±æ–‡ï¼šé€šå¸¸ä¸€ä¸ªå•è¯æ˜¯ä¸€ä¸ª Tokenï¼Œé•¿å•è¯å¯èƒ½è¢«åˆ‡åˆ†ã€‚</li>
<li>ä¸­æ–‡ï¼šé€šå¸¸ä¸€ä¸ªæ±‰å­—æ˜¯ä¸€ä¸ª Tokenï¼Œä½†å¸¸è§è¯ï¼ˆå¦‚â€œä½ å¥½â€ï¼‰å¯èƒ½ä¼šåˆå¹¶ä¸ºä¸€ä¸ª Tokenã€‚</li>
<li>å¹³å‡æ¥è¯´ï¼Œ<strong>0.75 ä¸ªè‹±æ–‡å•è¯ â‰ˆ 1 Token</strong>ï¼Œ<strong>1 ä¸ªæ±‰å­— â‰ˆ 1.5 - 2 Token</strong>ï¼ˆå–å†³äºåˆ†è¯å™¨æ•ˆç‡ï¼ŒQwen çš„ä¸­æ–‡å‹ç¼©ç‡å¾ˆé«˜ï¼‰ã€‚</li>
</ul>
<hr/>
<p><strong>æœ¬æ–‡ä½œè€…ï¼š</strong> Algieba
<strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.algieba12.cn%2Fllm03-know-more-about-transformer-lib%2F" target="_blank" title="https://blog.algieba12.cn/llm03-know-more-about-transformer-lib/" ref="nofollow noopener noreferrer">blog.algieba12.cn/llm03-know-â€¦</a>
<strong>ç‰ˆæƒå£°æ˜ï¼š</strong> æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
<pre><code class="hljs"/></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ™ºèƒ½ä½“æ¥äº†æˆ‘ç”¨36å°æ—¶ä»0åˆ°1ï¼Œå®ç°äº†èƒ½è‡ªåŠ¨å¤„ç†ä»»åŠ¡çš„AIæ™ºèƒ½ä½“]]></title>    <link>https://juejin.cn/post/7603195719458193414</link>    <guid>https://juejin.cn/post/7603195719458193414</guid>    <pubDate>2026-02-05T11:20:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603195719458193414" data-draft-id="7603195719458177030" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ™ºèƒ½ä½“æ¥äº†æˆ‘ç”¨36å°æ—¶ä»0åˆ°1ï¼Œå®ç°äº†èƒ½è‡ªåŠ¨å¤„ç†ä»»åŠ¡çš„AIæ™ºèƒ½ä½“"/> <meta itemprop="keywords" content="Agent"/> <meta itemprop="datePublished" content="2026-02-05T11:20:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="MarkX"/> <meta itemprop="url" content="https://juejin.cn/user/3247299659832519"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ™ºèƒ½ä½“æ¥äº†æˆ‘ç”¨36å°æ—¶ä»0åˆ°1ï¼Œå®ç°äº†èƒ½è‡ªåŠ¨å¤„ç†ä»»åŠ¡çš„AIæ™ºèƒ½ä½“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3247299659832519/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    MarkX
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T11:20:16.000Z" title="Thu Feb 05 2026 11:20:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>ï¼ˆå‰è¨€ï¼šç”¨ä¸ªäººæ•…äº‹å’Œæˆæœå¼€åœºï¼Œå»ºç«‹å…±é¸£ï¼‰</strong><br/>
æœ€è¿‘AIæ™ºèƒ½ä½“ï¼ˆAgentï¼‰çš„æ¦‚å¿µç«å¾—ä¸è¡Œï¼Œå„ç§æ¡†æ¶å’Œäº§å“çœ‹å¾—äººçœ¼èŠ±ç¼­ä¹±ã€‚ä½œä¸ºä¸€ä¸ªå–œæ¬¢åŠ¨æ‰‹çš„å¼€å‘è€…ï¼Œæˆ‘å¿ƒé‡Œä¸€ç›´ç—’ç—’çš„ï¼šæŠ›å¼€é‚£äº›å¤æ‚çš„åŒ…è£…ï¼Œä¸€ä¸ªèƒ½çœŸæ­£æ‰§è¡Œä»»åŠ¡çš„æ™ºèƒ½ä½“ï¼Œåˆ°åº•è¯¥æ€ä¹ˆä»é›¶æ­èµ·æ¥ï¼Ÿ</p>
<p>ä¸Šå‘¨æœ«ï¼Œæˆ‘èŠ±äº†å¤§æ¦‚36ä¸ªå°æ—¶ï¼Œä»è¯»æ–‡æ¡£ã€æ­ç¯å¢ƒã€è¸©å‘åˆ°è°ƒè¯•ï¼Œç»ˆäºæå‡ºäº†ä¸€ä¸ª<strong>èƒ½ç†è§£æˆ‘çš„è‡ªç„¶è¯­è¨€æŒ‡ä»¤ï¼Œå¹¶è‡ªåŠ¨æ‰§è¡Œå¤šæ­¥ä»»åŠ¡</strong>çš„Demoæ™ºèƒ½ä½“ã€‚å®ƒè™½ç„¶ä¸å¤æ‚ï¼Œä½†å®Œæ•´èµ°é€šäº†â€œæ„ŸçŸ¥-è§„åˆ’-æ‰§è¡Œâ€çš„é—­ç¯ã€‚</p>
<p>æˆ‘æŠŠæ•´ä¸ªè¿‡ç¨‹å’Œæ ¸å¿ƒä»£ç æ¢³ç†äº†å‡ºæ¥ï¼Œå¦‚æœä½ ä¹Ÿå¯¹Agentçš„å®ç°åŸç†æ„Ÿå…´è¶£ï¼Œæƒ³è‡ªå·±åŠ¨æ‰‹åšä¸€ä¸ªï¼Œè¿™ç¯‡ç¬”è®°åº”è¯¥èƒ½å¸®ä½ èŠ‚çœå¤§é‡æ—¶é—´ã€‚</p>
</blockquote>
<h3 data-id="heading-0"><strong>ä¸€ã€å…ˆæ˜ç¡®ç›®æ ‡ï¼šæˆ‘ä»¬è¦åšä¸€ä¸ªä»€ä¹ˆæ ·çš„æ™ºèƒ½ä½“ï¼Ÿ</strong></h3>
<p>åœ¨åŠ¨æ‰‹å†™ç¬¬ä¸€è¡Œä»£ç ä¹‹å‰ï¼Œå®šä¹‰æ¸…æ™°çš„ç›®æ ‡è‡³å…³é‡è¦ã€‚æˆ‘ä¸æƒ³åšä¸€ä¸ªâ€œèŠå¤©æœºå™¨äººâ€ï¼Œè€Œæ˜¯å¸Œæœ›å®ƒèƒ½<strong>ä¸»åŠ¨å®Œæˆä»»åŠ¡</strong>ã€‚</p>
<p>æˆ‘è®¾å®šçš„Demoç›®æ ‡æ˜¯ï¼š <strong>â€œå¸®æˆ‘åˆ†æä»Šæ—¥çƒ­ç‚¹ï¼Œå¹¶æ€»ç»“æˆä¸€ä»½ç®€æŠ¥â€</strong> ã€‚</p>
<p>è¿™ä¸ªä»»åŠ¡éœ€è¦æ™ºèƒ½ä½“ï¼š</p>
<ol>
<li><strong>æ„ŸçŸ¥</strong>ï¼šç†è§£æˆ‘çš„æŒ‡ä»¤æ˜¯è·å–å¹¶æ€»ç»“çƒ­ç‚¹ã€‚</li>
<li><strong>è§„åˆ’</strong>ï¼šæ‹†è§£æ­¥éª¤ï¼ˆæœç´¢çƒ­ç‚¹ â†’ è·å–å†…å®¹ â†’ åˆ†ææ€»ç»“ â†’ æ ¼å¼åŒ–è¾“å‡ºï¼‰ã€‚</li>
<li><strong>æ‰§è¡Œ</strong>ï¼šè°ƒç”¨ä¸åŒçš„å·¥å…·ï¼ˆæœç´¢å·¥å…·ã€çˆ¬è™«å·¥å…·ã€æ–‡æœ¬åˆ†æå·¥å…·ï¼‰æŒ‰æ­¥éª¤æ‰§è¡Œã€‚</li>
<li><strong>åæ€</strong>ï¼šæ£€æŸ¥ç»“æœæ˜¯å¦å®Œæ•´ï¼Œæ˜¯å¦éœ€è¦è°ƒæ•´ã€‚</li>
</ol>
<h3 data-id="heading-1"><strong>äºŒã€æŠ€æœ¯é€‰å‹ï¼šä¸ºä»€ä¹ˆæ˜¯ LangChain + DeepSeekï¼Ÿ</strong></h3>
<p>å¸‚é¢ä¸Šæ¡†æ¶å¾ˆå¤šï¼ˆLangChain, LlamaIndex, Semantic Kernelç­‰ï¼‰ï¼Œæˆ‘ä¼˜å…ˆé€‰æ‹©äº†Â <strong>LangChain</strong>ï¼ŒåŸå› å¾ˆç®€å•ï¼š</p>
<ul>
<li><strong>ç”Ÿæ€æˆç†Ÿ</strong>ï¼šç¤¾åŒºæ´»è·ƒï¼Œæ–‡æ¡£å’Œæ ·ä¾‹å¤šï¼Œé‡åˆ°é—®é¢˜å®¹æ˜“æ‰¾åˆ°è§£å†³æ–¹æ¡ˆã€‚</li>
<li><strong>å·¥å…·é“¾ä¸°å¯Œ</strong>ï¼šå†…ç½®å’Œç¤¾åŒºæä¾›äº†å¤§é‡ç°æˆçš„Toolï¼ˆæœç´¢ã€è®¡ç®—ã€APIè°ƒç”¨ç­‰ï¼‰ï¼Œèƒ½å¿«é€Ÿæ­å»ºã€‚</li>
<li><strong>æŠ½è±¡å±‚æ¬¡åˆç†</strong>ï¼šå®ƒæä¾›äº†Agentã€Toolã€Memoryç­‰æ ¸å¿ƒæ¦‚å¿µçš„æ¸…æ™°æŠ½è±¡ï¼Œæ—¢ä¸ä¼šå¤ªåº•å±‚ï¼Œä¹Ÿä¸ä¼šå¤ªé»‘ç›’ã€‚</li>
</ul>
<p>å¯¹äºå¤§æ¨¡å‹ï¼ˆLLMï¼‰ï¼Œæˆ‘é€‰æ‹©äº†Â <strong>DeepSeek</strong>ï¼Œç†ç”±ä¹Ÿå¾ˆç›´æ¥ï¼š</p>
<ul>
<li><strong>èƒ½åŠ›å¼ºä¸”å…è´¹</strong>ï¼šåœ¨ä»£ç å’Œé€»è¾‘æ¨ç†ä¸Šè¡¨ç°ä¸é”™ï¼Œå®Œå…¨æ»¡è¶³Demoéœ€æ±‚ï¼Œæ²¡æœ‰é¢åº¦ç„¦è™‘å¯ä»¥éšä¾¿â€œé€ â€ã€‚</li>
<li><strong>APIå‹å¥½</strong>ï¼šæ¥å…¥ç®€å•ï¼Œå“åº”é€Ÿåº¦å¿«ã€‚</li>
</ul>
<h3 data-id="heading-2"><strong>ä¸‰ã€å®æˆ˜æ‹†è§£ï¼šä»£ç æ˜¯å¦‚ä½•ä¸€æ­¥æ­¥å®ç°çš„</strong></h3>
<p>è¿™é‡Œæˆ‘å‰¥ç¦»äº†é¡¹ç›®ç»“æ„ï¼Œèšç„¦æœ€æ ¸å¿ƒçš„é“¾è·¯ã€‚å®Œæ•´é¡¹ç›®ä»£ç å·²æ”¾åœ¨æ–‡æœ«çš„GitHubä»“åº“é‡Œã€‚</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šæ­å»ºæ™ºèƒ½ä½“çš„â€œå¤§è„‘â€ (LLM + Prompt)</strong></p>
<p>æ™ºèƒ½ä½“çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªèƒ½è¿›è¡Œä»»åŠ¡è§„åˆ’å’Œé“¾å¼æ€è€ƒçš„LLMã€‚LangChainçš„Â <code>create_react_agent</code>Â å¸®æˆ‘ä»¬å°è£…äº†å¤æ‚çš„Promptå·¥ç¨‹ã€‚</p>
<p>python</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain <span class="hljs-keyword">import</span> hub
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> create_react_agent, AgentExecutor
<span class="hljs-keyword">from</span> langchain.tools <span class="hljs-keyword">import</span> Tool
<span class="hljs-keyword">from</span> langchain_community.llms <span class="hljs-keyword">import</span> DeepSeek

<span class="hljs-comment"># 1. åˆå§‹åŒ–å¤§è„‘ï¼ˆLLMï¼‰</span>
llm = DeepSeek(model=<span class="hljs-string">"deepseek-chat"</span>, temperature=<span class="hljs-number">0.1</span>) <span class="hljs-comment"># temperatureè°ƒä½ï¼Œè®©è¾“å‡ºæ›´ç¨³å®š</span>

<span class="hljs-comment"># 2. æ‹‰å–ä¸€ä¸ªä¼˜åŒ–è¿‡çš„ReActæç¤ºæ¨¡æ¿ï¼ˆè¿™æ˜¯LangChainçš„ç¥å™¨ä¹‹ä¸€ï¼‰</span>
prompt = hub.pull(<span class="hljs-string">"hwchase17/react"</span>)
</code></pre>
<p><strong>ç¬¬äºŒæ­¥ï¼šä¸ºæ™ºèƒ½ä½“æ‰“é€ â€œå·¥å…·ç®±â€ (Tools)</strong></p>
<p>æ™ºèƒ½ä½“ä¹‹æ‰€ä»¥èƒ½â€œæ‰§è¡Œâ€ï¼Œé çš„å°±æ˜¯Toolsã€‚æˆ‘ç»™å®ƒé…å¤‡äº†ä¸‰ä¸ªåŸºç¡€å·¥å…·ï¼š</p>
<p>python</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å·¥å…·1ï¼šç½‘ç»œæœç´¢ï¼ˆæ¨¡æ‹Ÿï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">search_web</span>(<span class="hljs-params">query: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""æ¨¡æ‹Ÿæœç´¢ä»Šæ—¥çƒ­ç‚¹ã€‚å®é™…å¯æ¥å…¥SerperAPIæˆ–Google Search APIã€‚"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[æ™ºèƒ½ä½“æ­£åœ¨æœç´¢]: <span class="hljs-subst">{query}</span>"</span>)
    <span class="hljs-comment"># è¿™é‡Œæ˜¯æ¨¡æ‹Ÿæ•°æ®ï¼ŒçœŸå®æƒ…å†µè°ƒç”¨API</span>
    mock_hot_news = [
        <span class="hljs-string">"AIç¼–ç¨‹åŠ©æ‰‹CodeGeeXå‘å¸ƒ4.0ç‰ˆæœ¬ï¼Œå®£ç§°æ•ˆç‡æå‡50%"</span>,
        <span class="hljs-string">"æ·±åº¦å­¦ä¹ æ¡†æ¶PyTorchå®£å¸ƒå®˜æ–¹æ”¯æŒApple Silicon GPUåŠ é€Ÿ"</span>,
        <span class="hljs-string">"2024å¹´DevOpsçŠ¶æ€æŠ¥å‘Šï¼šAIåœ¨è‡ªåŠ¨åŒ–æµ‹è¯•ä¸­æ¸—é€ç‡è¶…30%"</span>
    ]
    <span class="hljs-keyword">return</span> <span class="hljs-string">"\n"</span>.join(mock_hot_news)

<span class="hljs-comment"># å·¥å…·2ï¼šå†…å®¹æå–ï¼ˆæ¨¡æ‹Ÿï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">fetch_content</span>(<span class="hljs-params">url: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""æ¨¡æ‹Ÿæ ¹æ®é“¾æ¥è·å–è¯¦ç»†å†…å®¹ã€‚"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[æ™ºèƒ½ä½“æ­£åœ¨æŠ“å–å†…å®¹]: <span class="hljs-subst">{url}</span>"</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"è¿™æ˜¯å…³äº'<span class="hljs-subst">{url}</span>'çš„è¯¦ç»†æŠ¥é“å†…å®¹æ‘˜è¦..."</span>

<span class="hljs-comment"># å·¥å…·3ï¼šæ–‡æœ¬æ€»ç»“</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">summarize_text</span>(<span class="hljs-params">text: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""è°ƒç”¨LLMå¯¹é•¿æ–‡æœ¬è¿›è¡Œæ€»ç»“ã€‚"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[æ™ºèƒ½ä½“æ­£åœ¨æ€»ç»“å†…å®¹]..."</span>)
    <span class="hljs-comment"># è¿™é‡Œå®é™…ä¸Šå¯ä»¥å†è°ƒä¸€æ¬¡LLMï¼Œä¸ºç®€åŒ–ï¼Œç›´æ¥è¿”å›æ¨¡æ‹Ÿæ€»ç»“</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"æ ¸å¿ƒè¦ç‚¹ï¼š<span class="hljs-subst">{text[:<span class="hljs-number">50</span>]}</span>..."</span>

<span class="hljs-comment"># å°†å‡½æ•°åŒ…è£…æˆLangChain Tool</span>
tools = [
    Tool(name=<span class="hljs-string">"Search"</span>, func=search_web, description=<span class="hljs-string">"å½“ä½ éœ€è¦è·å–æœ€æ–°çƒ­ç‚¹æˆ–æœç´¢ä¿¡æ¯æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚"</span>),
    Tool(name=<span class="hljs-string">"FetchContent"</span>, func=fetch_content, description=<span class="hljs-string">"å½“ä½ éœ€è¦è·å–æŸä¸ªé“¾æ¥çš„å…·ä½“å†…å®¹æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚"</span>),
    Tool(name=<span class="hljs-string">"Summarizer"</span>, func=summarize_text, description=<span class="hljs-string">"å½“ä½ éœ€è¦æ€»ç»“é•¿æ–‡æœ¬å†…å®¹æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚"</span>),
]
</code></pre>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šç»„è£…å¹¶è¿è¡Œæ™ºèƒ½ä½“</strong></p>
<p>æŠŠå¤§è„‘ã€å·¥å…·å’Œæç¤ºè¯ç»„è£…èµ·æ¥ï¼Œæ™ºèƒ½ä½“å°±è¯ç”Ÿäº†ã€‚</p>
<p>python</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 3. åˆ›å»ºReActæ™ºèƒ½ä½“</span>
agent = create_react_agent(llm, tools, prompt)

<span class="hljs-comment"># 4. åˆ›å»ºæ‰§è¡Œå™¨ï¼Œå®ƒä¼šå¤„ç†æ™ºèƒ½ä½“çš„æ€è€ƒå¾ªç¯</span>
agent_executor = AgentExecutor(agent=agent, tools=tools, verbose=<span class="hljs-literal">True</span>, handle_parsing_errors=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># 5. å‘å¸ƒä»»åŠ¡ï¼</span>
result = agent_executor.invoke({
    <span class="hljs-string">"input"</span>: <span class="hljs-string">"è¯·å¸®æˆ‘åˆ†æä»Šå¤©çš„ç§‘æŠ€çƒ­ç‚¹ï¼Œå¹¶æ•´ç†æˆä¸€ä»½ç®€çŸ­çš„è¦ç‚¹ç®€æŠ¥ã€‚"</span>
})

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">50</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"ã€æ™ºèƒ½ä½“ç”Ÿæˆçš„æœ€ç»ˆç®€æŠ¥ã€‘"</span>)
<span class="hljs-built_in">print</span>(result[<span class="hljs-string">"output"</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span>*<span class="hljs-number">50</span>)
</code></pre>
<h3 data-id="heading-3"><strong>å››ã€è¿è¡Œæ•ˆæœä¸æ ¸å¿ƒæ´å¯Ÿ</strong></h3>
<p>å½“ä½ è¿è¡Œä¸Šé¢çš„ä»£ç ï¼ˆè®°å¾—å®‰è£…ä¾èµ–å¹¶å¡«å…¥è‡ªå·±çš„API Keyï¼‰ï¼Œä¼šåœ¨æ§åˆ¶å°çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„<strong>æ€è€ƒè¿‡ç¨‹</strong>ï¼š</p>
<p>text</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-quote">&gt; è¿›å…¥æ–°çš„AgentExecutoré“¾...</span>
æ€è€ƒï¼šç”¨æˆ·éœ€è¦ä¸€ä»½ä»Šæ—¥ç§‘æŠ€çƒ­ç‚¹ç®€æŠ¥ã€‚æˆ‘éœ€è¦å…ˆæœç´¢çƒ­ç‚¹ï¼Œç„¶åè·å–è¯¦ç»†ä¿¡æ¯ï¼Œæœ€åæ€»ç»“ã€‚
è¡ŒåŠ¨ï¼šSearch
è¡ŒåŠ¨è¾“å…¥ï¼šä»Šæ—¥ç§‘æŠ€çƒ­ç‚¹
[<span class="hljs-symbol">æ™ºèƒ½ä½“æ­£åœ¨æœç´¢</span>]: <span class="hljs-link">ä»Šæ—¥ç§‘æŠ€çƒ­ç‚¹</span>
è§‚å¯Ÿï¼šAIç¼–ç¨‹åŠ©æ‰‹CodeGeeXå‘å¸ƒ4.0ç‰ˆæœ¬... (çœç•¥)
æ€è€ƒï¼šæˆ‘å¾—åˆ°äº†å‡ æ¡çƒ­ç‚¹æ ‡é¢˜ï¼Œéœ€è¦è·å–å…¶ä¸­ä¸€ä¸¤æ¡çš„è¯¦ç»†å†…å®¹æ¥æ€»ç»“ã€‚
è¡ŒåŠ¨ï¼šFetchContent
è¡ŒåŠ¨è¾“å…¥ï¼šAIç¼–ç¨‹åŠ©æ‰‹CodeGeeXå‘å¸ƒ4.0ç‰ˆæœ¬
[<span class="hljs-symbol">æ™ºèƒ½ä½“æ­£åœ¨æŠ“å–å†…å®¹</span>]: <span class="hljs-link">AIç¼–ç¨‹åŠ©æ‰‹CodeGeeXå‘å¸ƒ4.0ç‰ˆæœ¬</span>
è§‚å¯Ÿï¼šè¿™æ˜¯å…³äº'AIç¼–ç¨‹åŠ©æ‰‹...'çš„è¯¦ç»†æŠ¥é“å†…å®¹æ‘˜è¦...
æ€è€ƒï¼šç°åœ¨æˆ‘æœ‰äº†ä¸€äº›ç»†èŠ‚ï¼Œå¯ä»¥å¼€å§‹æ€»ç»“äº†ã€‚
è¡ŒåŠ¨ï¼šSummarizer
è¡ŒåŠ¨è¾“å…¥ï¼š[å°†æœç´¢å’ŒæŠ“å–çš„å†…å®¹ç»„åˆ]
[æ™ºèƒ½ä½“æ­£åœ¨æ€»ç»“å†…å®¹]...
è§‚å¯Ÿï¼šæ ¸å¿ƒè¦ç‚¹ï¼šAIç¼–ç¨‹åŠ©æ‰‹æ•ˆç‡æå‡...
æ€è€ƒï¼šæˆ‘å·²ç»å®Œæˆäº†çƒ­ç‚¹æœç´¢ã€å†…å®¹è·å–å’Œæ€»ç»“ï¼Œå¯ä»¥ç»™å‡ºæœ€ç»ˆç­”æ¡ˆäº†ã€‚
æœ€ç»ˆç­”æ¡ˆï¼šæ ¹æ®ä»Šæ—¥çƒ­ç‚¹ï¼Œä¸ºæ‚¨æ•´ç†ç®€æŠ¥å¦‚ä¸‹ï¼š1. AIç¼–ç¨‹åŠ©æ‰‹CodeGeeX 4.0å‘å¸ƒ... (çœç•¥)
</code></pre>
<p><strong>é€šè¿‡è¿™ä¸ªDemoï¼Œæˆ‘æ¸…æ™°åœ°éªŒè¯äº†å‡ ä¸ªå…³é”®ç‚¹ï¼š</strong></p>
<ol>
<li><strong>æ™ºèƒ½ä½“çš„æœ¬è´¨æ˜¯â€œè§„åˆ’+æ‰§è¡Œâ€å¾ªç¯</strong>ï¼šå®ƒé€šè¿‡LLMè¿›è¡ŒåŠ¨æ€çš„ä»»åŠ¡æ‹†è§£ï¼ˆè§„åˆ’ï¼‰ï¼Œå¹¶é€‰æ‹©åˆé€‚çš„å·¥å…·æ‰§è¡Œã€‚</li>
<li><strong>å·¥å…·ï¼ˆToolsï¼‰æ˜¯èƒ½åŠ›è¾¹ç•Œ</strong>ï¼šæ™ºèƒ½ä½“èƒ½åšä»€ä¹ˆï¼Œå®Œå…¨å–å†³äºä½ ç»™å®ƒæä¾›äº†ä»€ä¹ˆå·¥å…·ã€‚<strong>èµ‹äºˆå®ƒè”ç½‘æœç´¢ã€æ‰§è¡Œä»£ç ã€æ“ä½œç³»ç»Ÿçš„èƒ½åŠ›ï¼Œå®ƒå°±èƒ½å˜å¾—æ— æ¯”å¼ºå¤§ã€‚</strong></li>
<li><strong>Promptæ˜¯çµé­‚</strong>ï¼š<code>hwchase17/react</code>Â è¿™ä¸ªPromptæ¨¡æ¿å·²ç»åµŒå…¥äº†â€œThought/Action/Observationâ€çš„æ ¼å¼ï¼Œå¼•å¯¼LLMè¿›è¡Œæ­£ç¡®æ¨ç†ã€‚å¾®è°ƒPromptèƒ½æå¤§æ”¹å–„è¡¨ç°ã€‚</li>
</ol>
<h3 data-id="heading-4"><strong>äº”ã€è¸©å‘ä¸ä¼˜åŒ–å»ºè®®</strong></h3>
<ol>
<li><strong>æ— é™å¾ªç¯å‘</strong>ï¼šæ™ºèƒ½ä½“æœ‰æ—¶ä¼šé™·å…¥â€œæ€è€ƒ-è¡ŒåŠ¨â€æ­»å¾ªç¯ã€‚<strong>åŠ¡å¿…åœ¨<code>AgentExecutor</code>ä¸­è®¾ç½®<code>max_iterations</code>å‚æ•°</strong>ï¼ˆæ¯”å¦‚10-15æ¬¡ï¼‰ï¼Œå¼ºåˆ¶é€€å‡ºã€‚</li>
<li><strong>å·¥å…·æè¿°å‘</strong>ï¼š<code>Tool</code>çš„<code>description</code>è‡³å…³é‡è¦ï¼LLMå®Œå…¨ä¾èµ–æè¿°æ¥å†³å®šæ˜¯å¦è°ƒç”¨è¯¥å·¥å…·ã€‚æè¿°è¦<strong>æ¸…æ™°ã€å…·ä½“ï¼Œè¯´æ˜é€‚ç”¨åœºæ™¯</strong>ã€‚</li>
<li><strong>é”™è¯¯å¤„ç†å‘</strong>ï¼šå·¥å…·æ‰§è¡Œå¯èƒ½å¤±è´¥ï¼ˆå¦‚ç½‘ç»œè¶…æ—¶ï¼‰ï¼Œéœ€è¦åœ¨å·¥å…·å‡½æ•°å†…éƒ¨åšå¥½å¼‚å¸¸å¤„ç†ï¼Œå¹¶è¿”å›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯ç»™LLMï¼Œè®©å®ƒèƒ½è°ƒæ•´ç­–ç•¥ã€‚</li>
<li><strong>æˆæœ¬ä¸å»¶è¿Ÿå‘</strong>ï¼šæ¯æ¬¡æ€è€ƒå’Œè¡ŒåŠ¨éƒ½å¯èƒ½è°ƒç”¨LLMï¼Œå¤æ‚ä»»åŠ¡æˆæœ¬ä¸ä½ã€‚Demoé˜¶æ®µå¯ä»¥ä½¿ç”¨DeepSeekè¿™ç±»æ€§ä»·æ¯”é«˜çš„æ¨¡å‹ï¼Œä¸Šçº¿å‰éœ€åšå¥½é¢„ç®—å’Œå»¶è¿Ÿè¯„ä¼°ã€‚</li>
</ol>
<h3 data-id="heading-5"><strong>æœ€åï¼ŒèŠèŠâ€œä»0åˆ°1â€ä¹‹åçš„äº‹</strong></h3>
<p>è¿™ä¸ªDemoåªæ˜¯ä¸€ä¸ªèµ·ç‚¹ã€‚å½“ä½ æŒæ¡äº†è¿™ä¸ªæœ€å°é—­ç¯ï¼Œå°±å¯ä»¥å°è¯•ï¼š</p>
<ul>
<li><strong>æ¥å…¥çœŸå®å·¥å…·</strong>ï¼šæ›¿æ¢æ‰æ¨¡æ‹Ÿå·¥å…·ï¼Œæ¥å…¥SerperAPIï¼ˆæœç´¢ï¼‰ã€Requestsï¼ˆçˆ¬è™«ï¼‰ã€ShellToolï¼ˆæ‰§è¡Œå‘½ä»¤ï¼‰ã€‚</li>
<li><strong>å°è¯•å¤šæ™ºèƒ½ä½“åä½œ</strong>ï¼šè®©ä¸€ä¸ªâ€œä¸»ç®¡â€æ™ºèƒ½ä½“åè°ƒå¤šä¸ªâ€œå·¥äººâ€æ™ºèƒ½ä½“åˆ†å·¥åˆä½œã€‚</li>
<li><strong>åŠ å…¥è®°å¿†ï¼ˆMemoryï¼‰</strong> ï¼šè®©æ™ºèƒ½ä½“è®°ä½ä¹‹å‰çš„å¯¹è¯å’Œç»“æœï¼Œå®ç°æ›´è¿è´¯çš„é•¿æœŸä»»åŠ¡ã€‚</li>
</ul>
<p><strong>æŠ€æœ¯æœ¬èº«ä¸æ˜¯ç›®çš„ï¼Œè§£å†³é—®é¢˜æ‰æ˜¯ã€‚</strong> Â åŠ¨æ‰‹æ­å»ºä¸€æ¬¡ï¼Œä½ å¯¹æ‰€æœ‰é‚£äº›â€œç¥å¥‡â€çš„Agentäº§å“çš„ç†è§£ï¼Œä¼šå®Œå…¨ä¸ä¸€æ ·ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€ ç»ˆææ–¹æ¡ˆï¼šOpenClaw + Cloudflare Tunnel ä¼ä¸šå¾®ä¿¡æœºå™¨äººéƒ¨ç½²æŒ‡å—]]></title>    <link>https://juejin.cn/post/7603246733316866102</link>    <guid>https://juejin.cn/post/7603246733316866102</guid>    <pubDate>2026-02-05T12:28:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603246733316866102" data-draft-id="7603352061467951146" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€ ç»ˆææ–¹æ¡ˆï¼šOpenClaw + Cloudflare Tunnel ä¼ä¸šå¾®ä¿¡æœºå™¨äººéƒ¨ç½²æŒ‡å—"/> <meta itemprop="keywords" content="Node.js"/> <meta itemprop="datePublished" content="2026-02-05T12:28:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="éš”å£æ™“æ™“"/> <meta itemprop="url" content="https://juejin.cn/user/4499656909521368"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€ ç»ˆææ–¹æ¡ˆï¼šOpenClaw + Cloudflare Tunnel ä¼ä¸šå¾®ä¿¡æœºå™¨äººéƒ¨ç½²æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4499656909521368/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    éš”å£æ™“æ™“
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T12:28:02.000Z" title="Thu Feb 05 2026 12:28:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸš€ ç»ˆææ–¹æ¡ˆï¼šOpenClaw + Cloudflare Tunnel ä¼ä¸šå¾®ä¿¡æœºå™¨äººéƒ¨ç½²æŒ‡å—</h2>
<blockquote>
<p><strong>ç‰ˆæœ¬</strong>ï¼šFinal Edition (2026.02)
<strong>æ–¹æ¡ˆç‰¹ç‚¹</strong>ï¼šæ— éœ€å…¬ç½‘IPã€é›¶ç«¯å£å¼€æ”¾ã€Cloudflare å…¨çƒåŠ é€Ÿã€é…ç½®æç®€ã€‚
<strong>é€‚ç”¨ç¯å¢ƒ</strong>ï¼šä»»ä½•èƒ½è”ç½‘çš„ Mac/Windows/Linux è®¾å¤‡ï¼ˆå³ä¾¿æ˜¯å…‰çŒ«åçš„å¤šå±‚å†…ç½‘ï¼‰ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ğŸ—ï¸ æ¶æ„å¯¹æ¯”</h3>
<ul>
<li><strong>æ—§æ—¶ä»£ (FRP)</strong>: <code>ä¼ä¸šå¾®ä¿¡</code> -&gt; <code>å…¬ç½‘æœåŠ¡å™¨(frps)</code> -&gt; <code>è·¯ç”±å™¨ç«¯å£æ˜ å°„</code> -&gt; <code>æœ¬æœº(frpc)</code> -&gt; <code>OpenClaw</code> (é“¾è·¯é•¿ï¼Œé…ç½®ç¹çï¼Œéœ€å…¬ç½‘IP)</li>
<li><strong>æ–°æ—¶ä»£ (CF Tunnel)</strong>: <code>ä¼ä¸šå¾®ä¿¡</code> -&gt; <code>Cloudflareè¾¹ç¼˜èŠ‚ç‚¹</code> -&gt; <code>åŠ å¯†éš§é“</code> -&gt; <code>æœ¬æœº(cloudflared)</code> -&gt; <code>OpenClaw</code> (é“¾è·¯çŸ­ï¼Œæ— éœ€å…¬ç½‘IPï¼Œèµ·é£ï¼)</li>
</ul>
<hr/>
<h3 data-id="heading-2">ğŸ› ï¸ ç¬¬ä¸€æ­¥ï¼šOpenClaw åŸºç¡€ç¯å¢ƒæ­å»º</h3>
<p>(å¦‚æœä½ ä¹‹å‰å·²ç»é…å¥½äº† OpenClawï¼Œå¯ä»¥è·³è¿‡å®‰è£…ï¼Œç›´æ¥æ£€æŸ¥é…ç½®æ–‡ä»¶ã€‚)</p>
<h4 data-id="heading-3">1. å®‰è£…æ ¸å¿ƒ</h4>
<pre><code class="hljs language-bash" lang="bash">npm install -g openclaw
openclaw plugins install openclaw-plugin-wecom
</code></pre>
<h4 data-id="heading-4">2. ç¼–å†™/æ£€æŸ¥é…ç½®æ–‡ä»¶ (å…³é”®ï¼)</h4>
<p>æ–‡ä»¶è·¯å¾„ï¼š<code>~/.openclaw/openclaw.json</code></p>
<p><strong>âš ï¸ é¿å‘é‡ç‚¹</strong>ï¼š</p>
<ol>
<li>å¿…é¡»æ˜¾å¼å¯ç”¨æ’ä»¶ <code>plugins.entries</code>ã€‚</li>
<li><strong><code>encodingAesKey</code></strong> å¿…é¡»æ˜¯å°é©¼å³°å‘½åï¼ˆä¼ä¸šå¾®ä¿¡åå°å¤åˆ¶è¿‡æ¥è¦æŠŠ Key åæ”¹å¯¹ï¼‰ã€‚</li>
<li>åœ¨ Tunnel æ¨¡å¼ä¸‹ï¼ŒOpenClaw åªéœ€è¦ç›‘å¬æœ¬åœ°å³å¯ï¼Œä½†ä¹Ÿå»ºè®®æ”¾å¼€å±€åŸŸç½‘æƒé™æ–¹ä¾¿è°ƒè¯•ã€‚</li>
</ol>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"plugins"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"entries"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span> <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"channels"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"wecom"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ çš„Token"</span><span class="hljs-punctuation">,</span>          <span class="hljs-comment">// ä»ä¼ä¸šå¾®ä¿¡åå°è·å–</span>
      <span class="hljs-attr">"encodingAesKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ çš„43ä½Key"</span> <span class="hljs-comment">// ä»ä¼ä¸šå¾®ä¿¡åå°è·å–</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"gateway"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"bind"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"lan"</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// å»ºè®®è®¾ä¸º lanï¼Œæ–¹ä¾¿è°ƒè¯•ï¼›Tunnel è®¿é—® localhost ä¹Ÿæ²¡é—®é¢˜</span>
    <span class="hljs-attr">"port"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">18789</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å¯åŠ¨ç½‘å…³ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">openclaw gateway restart
</code></pre>
<hr/>
<h3 data-id="heading-5">ğŸš‡ ç¬¬äºŒæ­¥ï¼šéƒ¨ç½² Cloudflare Tunnel (é‡å¤´æˆ)</h3>
<p>å‰æï¼šä½ éœ€è¦æœ‰ä¸€ä¸ªåŸŸåæ‰˜ç®¡åœ¨ Cloudflare ä¸Šï¼ˆæ¯”å¦‚ <code>shuqi.run</code>ï¼‰ã€‚</p>
<h4 data-id="heading-6">1. å®‰è£… cloudflared</h4>
<p>Mac ç”¨æˆ·ç›´æ¥ç”¨ Homebrewï¼š</p>
<pre><code class="hljs language-bash" lang="bash">brew install cloudflared
</code></pre>
<pre><code class="hljs language-arduino" lang="arduino">cloudflared tunnel run --url http:<span class="hljs-comment">//localhost:18789</span>
</code></pre>
<h4 data-id="heading-7">2. ç™»å½•å¹¶æˆæƒ</h4>
<pre><code class="hljs language-bash" lang="bash">cloudflared tunnel login
</code></pre>
<p>ç»ˆç«¯ä¼šç»™å‡ºä¸€ä¸ª URLï¼Œåœ¨æµè§ˆå™¨æ‰“å¼€ï¼Œé€‰æ‹©ä½ çš„åŸŸåè¿›è¡Œæˆæƒã€‚</p>
<h4 data-id="heading-8">3. åˆ›å»ºéš§é“</h4>
<p>ç»™éš§é“èµ·ä¸ªåå­—ï¼Œæ¯”å¦‚ <code>bot-tunnel</code>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">cloudflared tunnel create bot-tunnel
</code></pre>
<p><em>æˆåŠŸåä¼šè¿”å›ä¸€ä¸ª Tunnel IDï¼Œè®°ä¸‹æ¥ã€‚</em></p>
<h4 data-id="heading-9">4. ç»‘å®šåŸŸå (DNS è§£æ)</h4>
<p>æŠŠä½ æƒ³è¦çš„å­åŸŸåï¼ˆä¾‹å¦‚ <code>bot.shuqi.run</code>ï¼‰ç»‘å®šåˆ°è¿™ä¸ªéš§é“ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¯­æ³•: cloudflared tunnel route dns [éš§é“å] [ä½ çš„åŸŸå]</span>
cloudflared tunnel route dns bot-tunnel bot.shuqi.run
</code></pre>
<h4 data-id="heading-10">5. é…ç½®æµé‡è½¬å‘</h4>
<p>åˆ›å»ºé…ç½®æ–‡ä»¶ <code>~/.cloudflared/config.yml</code>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">nano ~/.cloudflared/config.yml
</code></pre>
<p>å†™å…¥ä»¥ä¸‹å†…å®¹ï¼ˆæ³¨æ„æ›¿æ¢ Tunnel IDï¼‰ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">tunnel:</span> <span class="hljs-string">&lt;ä½ çš„-Tunnel-ID-xxxxxxxx&gt;</span>
<span class="hljs-attr">credentials-file:</span> <span class="hljs-string">/Users/ä½ çš„ç”¨æˆ·å/.cloudflared/&lt;ä½ çš„-Tunnel-ID&gt;.json</span>

<span class="hljs-attr">ingress:</span>
  <span class="hljs-comment"># å°† bot.shuqi.run çš„æµé‡è½¬å‘ç»™æœ¬åœ° OpenClaw ç«¯å£</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">hostname:</span> <span class="hljs-string">bot.shuqi.run</span>
    <span class="hljs-attr">service:</span> <span class="hljs-string">http://localhost:18789</span>
  <span class="hljs-comment"># å…œåº•è§„åˆ™ï¼ˆå¿…é¡»æœ‰ï¼‰</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">service:</span> <span class="hljs-string">http_status:404</span>
</code></pre>
<h4 data-id="heading-11">6. å¯åŠ¨éš§é“</h4>
<pre><code class="hljs language-bash" lang="bash">cloudflared tunnel run bot-tunnel
</code></pre>
<p>çœ‹åˆ°ç±»ä¼¼ <code>Connection ... registered</code> çš„æ—¥å¿—ï¼Œè¯´æ˜éš§é“å·²æ‰“é€šï¼æ­¤æ—¶å…¨çƒä»»ä½•åœ°æ–¹è®¿é—® <code>https://bot.shuqi.run</code> éƒ½ä¼šç›´æ¥è¿åˆ°ä½  Mac ä¸Šçš„ OpenClawã€‚</p>
<hr/>
<h3 data-id="heading-12">ğŸ“± ç¬¬ä¸‰æ­¥ï¼šä¼ä¸šå¾®ä¿¡åå°æœ€ç»ˆå¯¹æ¥</h3>
<p>å›åˆ° <a href="https://link.juejin.cn?target=https%3A%2F%2Fwork.weixin.qq.com%2Fwework_admin" target="_blank" title="https://work.weixin.qq.com/wework_admin" ref="nofollow noopener noreferrer">ä¼ä¸šå¾®ä¿¡ç®¡ç†åå°</a>ï¼Œè¿›å…¥ <strong>åº”ç”¨ç®¡ç† -&gt; è‡ªå»ºåº”ç”¨ -&gt; APIæ¥æ”¶æ¶ˆæ¯</strong>ã€‚</p>
<h4 data-id="heading-13">å¡«å†™å‚æ•°</h4>
<ul>
<li><strong>URL</strong>: <code>https://bot.shuqi.run/wecom</code>
<ul>
<li><em>æ³¨æ„ï¼šCF Tunnel è‡ªåŠ¨æä¾› HTTPSï¼Œè¿™é‡Œç›´æ¥å¡« HTTPS å³å¯ï¼Œå®Œç¾ç¬¦åˆä¼ä¸šå¾®ä¿¡å®‰å…¨æ€§è¦æ±‚ã€‚</em></li>
<li><em>æ³¨æ„ï¼šè·¯å¾„å¿…é¡»æ˜¯ <code>/wecom</code>ã€‚</em></li>
</ul>
</li>
<li><strong>Token</strong>: ä¸ <code>openclaw.json</code> ä¸€è‡´ã€‚</li>
<li><strong>EncodingAESKey</strong>: ä¸ <code>openclaw.json</code> ä¸€è‡´ã€‚</li>
</ul>
<h4 data-id="heading-14">ç‚¹å‡»ä¿å­˜</h4>
<ul>
<li>Cloudflare Tunnel é€Ÿåº¦æå¿«ï¼Œé€šå¸¸ä¼šç§’è¿‡éªŒè¯ã€‚</li>
<li>å¦‚æœæç¤ºæ ¡éªŒæˆåŠŸï¼Œå»ä¼ä¸šå¾®ä¿¡ App å‘é€â€œä½ å¥½â€æµ‹è¯•ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-15">âš¡ è¿›é˜¶æŠ€å·§ï¼šè®©éš§é“åå°è¿è¡Œ</h3>
<p>è°ƒè¯•æ²¡é—®é¢˜åï¼Œè‚¯å®šä¸æƒ³ä¸€ç›´å¼€ç€ç»ˆç«¯çª—å£ã€‚å¯ä»¥è®© cloudflared å˜æˆåå°æœåŠ¡è‡ªåŠ¨è¿è¡Œã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…ç³»ç»ŸæœåŠ¡</span>
sudo cloudflared service install

<span class="hljs-comment"># å¯åŠ¨æœåŠ¡</span>
sudo cloudflared service start
</code></pre>
<p>è¿™æ ·ä½ çš„ Mac åªè¦å¼€æœºï¼Œéš§é“å°±è‡ªåŠ¨è¿é€šï¼Œæœºå™¨äºº 24 å°æ—¶åœ¨çº¿ã€‚</p>
<hr/>
<h3 data-id="heading-16">ğŸ† æ€»ç»“</h3>
<p>ä½¿ç”¨ Cloudflare Tunnel åï¼Œæˆ‘ä»¬å½»åº•å‘Šåˆ«äº†ï¼š
âŒ ç¹ççš„è·¯ç”±å™¨ç«¯å£æ˜ å°„
âŒ æ˜‚è´µçš„å…¬ç½‘æœåŠ¡å™¨æœˆç§Ÿ
âŒ ä»¤äººå¤´ç§ƒçš„é˜²ç«å¢™é…ç½®
âŒ Nginx åå‘ä»£ç†é…ç½®</p>
<p><strong>è¿™å°±æ˜¯ç›®å‰æœ€ä¼˜é›…ã€æœ€é«˜æ•ˆçš„ä¼ä¸šå¾®ä¿¡æœºå™¨äººéƒ¨ç½²æ–¹æ¡ˆã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Laravel AI SDK æ­£å¼å‘å¸ƒ]]></title>    <link>https://juejin.cn/post/7603216479835947059</link>    <guid>https://juejin.cn/post/7603216479835947059</guid>    <pubDate>2026-02-06T00:22:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603216479835947059" data-draft-id="7603227363821256730" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Laravel AI SDK æ­£å¼å‘å¸ƒ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-06T00:22:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Laravel AI SDK æ­£å¼å‘å¸ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T00:22:04.000Z" title="Fri Feb 06 2026 00:22:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Laravel AI SDK æ­£å¼å‘å¸ƒ</h2>
<p>Laravel AI SDK ä»Šå¤©æ­£å¼å‘å¸ƒäº†ã€‚è¿™ä¸ªç”± Taylor Otwell å¼€å‘æ•°æœˆçš„å®˜æ–¹åŒ…ï¼Œä¸º Laravel åº”ç”¨æä¾›äº†ä¸€å¥—ç»Ÿä¸€çš„ AI äº¤äº’æ¥å£ï¼Œè¦†ç›–æ–‡æœ¬å¯¹è¯ã€å›¾åƒç”Ÿæˆã€è¯­éŸ³åˆæˆã€è¯­éŸ³è½¬å½•ã€å‘é‡åµŒå…¥ç­‰åœºæ™¯ï¼Œæ”¯æŒ OpenAIã€Anthropicã€Geminiã€Groqã€xAI ç­‰ä¸»æµæœåŠ¡å•†ã€‚</p>
<p>å®‰è£…æ–¹å¼å’Œå…¶ä»– Laravel å®˜æ–¹åŒ…ä¸€æ ·ç®€å•ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">composer require laravel/ai
</code></pre>
<h3 data-id="heading-1">Agentï¼šæ ¸å¿ƒäº¤äº’å•å…ƒ</h3>
<p>SDK çš„æ ¸å¿ƒæ¦‚å¿µæ˜¯ Agentã€‚æ¯ä¸ª Agent æ˜¯ä¸€ä¸ª PHP ç±»ï¼Œå°è£…äº†ç³»ç»ŸæŒ‡ä»¤ã€å¯¹è¯ä¸Šä¸‹æ–‡ã€å·¥å…·å’Œè¾“å‡ºæ ¼å¼ã€‚å¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ªä¸“ç”¨åŠ©æ‰‹â€”â€”é”€å”®æ•™ç»ƒã€æ–‡æ¡£åˆ†æå™¨ã€å®¢æœæœºå™¨äººâ€”â€”é…ç½®ä¸€æ¬¡ï¼Œéšå¤„è°ƒç”¨ã€‚</p>
<p>é€šè¿‡ Artisan å‘½ä»¤åˆ›å»ºï¼š</p>
<pre><code class="hljs language-shell" lang="shell">php artisan make:agent SalesCoach
</code></pre>
<p>ç”Ÿæˆçš„ç±»å®ç° <code>Agent</code> æ¥å£ï¼Œå®šä¹‰ <code>instructions()</code> æ–¹æ³•æä¾›ç³»ç»Ÿæç¤ºè¯ï¼Œç„¶åè°ƒç”¨ <code>prompt()</code> å‘èµ·å¯¹è¯ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$response</span> = <span class="hljs-title class_">SalesCoach</span>::<span class="hljs-title function_ invoke__">make</span>(<span class="hljs-attr">user</span>: <span class="hljs-variable">$user</span>)
    -&gt;<span class="hljs-title function_ invoke__">prompt</span>(<span class="hljs-string">'åˆ†æè¿™æ®µé”€å”®å½•éŸ³...'</span>);

<span class="hljs-keyword">return</span> (<span class="hljs-keyword">string</span>) <span class="hljs-variable">$response</span>;
</code></pre>
<p><code>prompt()</code> æ–¹æ³•æ”¯æŒåœ¨è°ƒç”¨æ—¶åˆ‡æ¢æœåŠ¡å•†å’Œæ¨¡å‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$response</span> = (<span class="hljs-keyword">new</span> <span class="hljs-title class_">SalesCoach</span>)-&gt;<span class="hljs-title function_ invoke__">prompt</span>(
    <span class="hljs-string">'åˆ†æè¿™æ®µé”€å”®å½•éŸ³...'</span>,
    <span class="hljs-attr">provider</span>: <span class="hljs-string">'anthropic'</span>,
    <span class="hljs-attr">model</span>: <span class="hljs-string">'claude-haiku-4-5-20251001'</span>,
    <span class="hljs-attr">timeout</span>: <span class="hljs-number">120</span>,
);
</code></pre>
<p>å¦‚æœä¸æƒ³åˆ›å»ºä¸“é—¨çš„ç±»ï¼Œä¹Ÿå¯ä»¥ç”¨åŒ¿å Agent å¿«é€Ÿè°ƒç”¨ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-keyword">function</span> <span class="hljs-title">Laravel</span>\<span class="hljs-title">Ai</span>\{<span class="hljs-title">agent</span>};

<span class="hljs-variable">$response</span> = <span class="hljs-title function_ invoke__">agent</span>(
    <span class="hljs-attr">instructions</span>: <span class="hljs-string">'You are an expert at software development.'</span>,
)-&gt;<span class="hljs-title function_ invoke__">prompt</span>(<span class="hljs-string">'Tell me about Laravel'</span>);
</code></pre>
<h3 data-id="heading-2">ç»“æ„åŒ–è¾“å‡º</h3>
<p>Agent å¯ä»¥è¿”å›ç»“æ„åŒ–æ•°æ®ï¼Œè€Œä¸ä»…ä»…æ˜¯çº¯æ–‡æœ¬ã€‚å®ç° <code>HasStructuredOutput</code> æ¥å£ï¼Œå®šä¹‰ <code>schema()</code> æ–¹æ³•å³å¯ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">schema</span>(<span class="hljs-params">JsonSchema <span class="hljs-variable">$schema</span></span>): <span class="hljs-title">array</span>
</span>{
    <span class="hljs-keyword">return</span> [
        <span class="hljs-string">'feedback'</span> =&gt; <span class="hljs-variable">$schema</span>-&gt;<span class="hljs-keyword">string</span>()-&gt;<span class="hljs-title function_ invoke__">required</span>(),
        <span class="hljs-string">'score'</span> =&gt; <span class="hljs-variable">$schema</span>-&gt;<span class="hljs-keyword">integer</span>()-&gt;<span class="hljs-title function_ invoke__">min</span>(<span class="hljs-number">1</span>)-&gt;<span class="hljs-title function_ invoke__">max</span>(<span class="hljs-number">10</span>)-&gt;<span class="hljs-title function_ invoke__">required</span>(),
    ];
}
</code></pre>
<p>è°ƒç”¨åç›´æ¥å½“æ•°ç»„ç”¨ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$response</span> = (<span class="hljs-keyword">new</span> <span class="hljs-title class_">SalesCoach</span>)-&gt;<span class="hljs-title function_ invoke__">prompt</span>(<span class="hljs-string">'åˆ†æè¿™æ®µå½•éŸ³...'</span>);

<span class="hljs-keyword">return</span> <span class="hljs-variable">$response</span>[<span class="hljs-string">'score'</span>]; <span class="hljs-comment">// 8</span>
</code></pre>
<h3 data-id="heading-3">å¯¹è¯è®°å¿†</h3>
<p>Agent æ”¯æŒè‡ªåŠ¨æŒä¹…åŒ–å¯¹è¯å†å²ã€‚ä½¿ç”¨ <code>RemembersConversations</code> trait åï¼ŒSDK ä¼šè‡ªåŠ¨å°†å¯¹è¯å­˜å…¥æ•°æ®åº“ï¼Œåç»­å¯ä»¥é€šè¿‡ <code>continue()</code> æ–¹æ³•ç»§ç»­ä¹‹å‰çš„å¯¹è¯ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// å¼€å§‹æ–°å¯¹è¯</span>
<span class="hljs-variable">$response</span> = (<span class="hljs-keyword">new</span> <span class="hljs-title class_">SalesCoach</span>)-&gt;<span class="hljs-title function_ invoke__">forUser</span>(<span class="hljs-variable">$user</span>)-&gt;<span class="hljs-title function_ invoke__">prompt</span>(<span class="hljs-string">'ä½ å¥½ï¼'</span>);
<span class="hljs-variable">$conversationId</span> = <span class="hljs-variable">$response</span>-&gt;conversationId;

<span class="hljs-comment">// ç»§ç»­å¯¹è¯</span>
<span class="hljs-variable">$response</span> = (<span class="hljs-keyword">new</span> <span class="hljs-title class_">SalesCoach</span>)
    -&gt;<span class="hljs-keyword">continue</span>(<span class="hljs-variable">$conversationId</span>, <span class="hljs-keyword">as</span>: <span class="hljs-variable">$user</span>)
    -&gt;<span class="hljs-title function_ invoke__">prompt</span>(<span class="hljs-string">'æ¥ç€åˆšæ‰çš„è¯é¢˜...'</span>);
</code></pre>
<h3 data-id="heading-4">å·¥å…·ç³»ç»Ÿ</h3>
<p>Agent å¯ä»¥ä½¿ç”¨å·¥å…·æ¥æ‰©å±•èƒ½åŠ›ã€‚é€šè¿‡ <code>make:tool</code> å‘½ä»¤åˆ›å»ºå·¥å…·ç±»ï¼Œå®šä¹‰è¾“å…¥ schema å’Œ <code>handle()</code> æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RandomNumberGenerator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Tool</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">description</span>(<span class="hljs-params"/>): <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">'ç”ŸæˆåŠ å¯†å®‰å…¨çš„éšæœºæ•°ã€‚'</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span></span>): <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">string</span>) <span class="hljs-title function_ invoke__">random_int</span>(<span class="hljs-variable">$request</span>[<span class="hljs-string">'min'</span>], <span class="hljs-variable">$request</span>[<span class="hljs-string">'max'</span>]);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">schema</span>(<span class="hljs-params">JsonSchema <span class="hljs-variable">$schema</span></span>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'min'</span> =&gt; <span class="hljs-variable">$schema</span>-&gt;<span class="hljs-keyword">integer</span>()-&gt;<span class="hljs-title function_ invoke__">min</span>(<span class="hljs-number">0</span>)-&gt;<span class="hljs-title function_ invoke__">required</span>(),
            <span class="hljs-string">'max'</span> =&gt; <span class="hljs-variable">$schema</span>-&gt;<span class="hljs-keyword">integer</span>()-&gt;<span class="hljs-title function_ invoke__">required</span>(),
        ];
    }
}
</code></pre>
<p>SDK è¿˜å†…ç½®äº†å‡ ä¸ªæœåŠ¡å•†çº§åˆ«çš„å·¥å…·ï¼š</p>
<ul>
<li><strong>WebSearch</strong> â€” è®© Agent æœç´¢ç½‘é¡µï¼Œæ”¯æŒ Anthropicã€OpenAIã€Gemini</li>
<li><strong>WebFetch</strong> â€” è®© Agent æŠ“å–ç½‘é¡µå†…å®¹ï¼Œæ”¯æŒ Anthropicã€Gemini</li>
<li><strong>FileSearch</strong> â€” åœ¨å‘é‡å­˜å‚¨ä¸­æœç´¢æ–‡ä»¶ï¼Œæ”¯æŒ OpenAIã€Gemini</li>
<li><strong>SimilaritySearch</strong> â€” åŸºäº Eloquent æ¨¡å‹çš„å‘é‡ç›¸ä¼¼åº¦æœç´¢ï¼Œç”¨äº RAG åœºæ™¯</li>
</ul>
<h3 data-id="heading-5">æµå¼å“åº”ä¸å¹¿æ’­</h3>
<p>å¯¹äºéœ€è¦å®æ—¶è¾“å‡ºçš„åœºæ™¯ï¼ŒAgent æ”¯æŒæµå¼å“åº”ã€‚è¿”å›å€¼å¯ä»¥ç›´æ¥ä½œä¸ºè·¯ç”±å“åº”ï¼Œè‡ªåŠ¨å‘é€ SSEï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title class_">Route</span>::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">'/coach'</span>, function () {
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">SalesCoach</span>)-&gt;<span class="hljs-title function_ invoke__">stream</span>(<span class="hljs-string">'åˆ†æè¿™æ®µå½•éŸ³...'</span>);
});
</code></pre>
<p>æµå¼äº‹ä»¶è¿˜å¯ä»¥é€šè¿‡ Laravel Broadcasting å¹¿æ’­åˆ°å‰ç«¯é¢‘é“ï¼Œæˆ–è€…ä½¿ç”¨ Vercel AI SDK åè®®ä¸å‰ç«¯æ¡†æ¶å¯¹æ¥ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> <span class="hljs-title class_">SalesCoach</span>)
    -&gt;<span class="hljs-title function_ invoke__">stream</span>(<span class="hljs-string">'åˆ†æè¿™æ®µå½•éŸ³...'</span>)
    -&gt;<span class="hljs-title function_ invoke__">usingVercelDataProtocol</span>();
</code></pre>
<h3 data-id="heading-6">é˜Ÿåˆ—å¤„ç†</h3>
<p>è€—æ—¶çš„ AI è¯·æ±‚å¯ä»¥æ¨å…¥é˜Ÿåˆ—åœ¨åå°å¤„ç†ï¼š</p>
<pre><code class="hljs language-php" lang="php">(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SalesCoach</span>)
    -&gt;<span class="hljs-title function_ invoke__">queue</span>(<span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">input</span>(<span class="hljs-string">'transcript'</span>))
    -&gt;<span class="hljs-title function_ invoke__">then</span>(function (AgentResponse <span class="hljs-variable">$response</span>) {
        <span class="hljs-comment">// å¤„ç†å“åº”...</span>
    })
    -&gt;<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span></span>) </span>{
        <span class="hljs-comment">// å¤„ç†å¼‚å¸¸...</span>
    });
</code></pre>
<h3 data-id="heading-7">å›¾åƒç”Ÿæˆ</h3>
<p><code>Image</code> ç±»æä¾›äº†ç®€æ´çš„å›¾åƒç”Ÿæˆæ¥å£ï¼Œæ”¯æŒ OpenAIã€Gemini å’Œ xAIï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Laravel</span>\<span class="hljs-title">Ai</span>\<span class="hljs-title">Image</span>;

<span class="hljs-variable">$image</span> = <span class="hljs-title class_">Image</span>::<span class="hljs-title function_ invoke__">of</span>(<span class="hljs-string">'å¨æˆ¿å°é¢ä¸Šçš„ç”œç”œåœˆ'</span>)
    -&gt;<span class="hljs-title function_ invoke__">quality</span>(<span class="hljs-string">'high'</span>)
    -&gt;<span class="hljs-title function_ invoke__">landscape</span>()
    -&gt;<span class="hljs-title function_ invoke__">generate</span>();

<span class="hljs-variable">$path</span> = <span class="hljs-variable">$image</span>-&gt;<span class="hljs-title function_ invoke__">store</span>();
</code></pre>
<p>æ”¯æŒé™„åŠ å‚è€ƒå›¾åƒè¿›è¡Œé£æ ¼è¿ç§»ï¼Œä¹Ÿå¯ä»¥æ¨å…¥é˜Ÿåˆ—å¼‚æ­¥ç”Ÿæˆã€‚</p>
<h3 data-id="heading-8">éŸ³é¢‘ä¸è½¬å½•</h3>
<p>è¯­éŸ³åˆæˆï¼ˆTTSï¼‰å’Œè¯­éŸ³è½¬å½•ï¼ˆSTTï¼‰åŒæ ·è¢«çº³å…¥ SDKï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Laravel</span>\<span class="hljs-title">Ai</span>\<span class="hljs-title">Audio</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Laravel</span>\<span class="hljs-title">Ai</span>\<span class="hljs-title">Transcription</span>;

<span class="hljs-comment">// æ–‡å­—è½¬è¯­éŸ³</span>
<span class="hljs-variable">$audio</span> = <span class="hljs-title class_">Audio</span>::<span class="hljs-title function_ invoke__">of</span>(<span class="hljs-string">'I love coding with Laravel.'</span>)
    -&gt;<span class="hljs-title function_ invoke__">female</span>()
    -&gt;<span class="hljs-title function_ invoke__">instructions</span>(<span class="hljs-string">'ç”¨æµ·ç›—çš„è¯­æ°”è¯´'</span>)
    -&gt;<span class="hljs-title function_ invoke__">generate</span>();

<span class="hljs-comment">// è¯­éŸ³è½¬æ–‡å­—</span>
<span class="hljs-variable">$transcript</span> = <span class="hljs-title class_">Transcription</span>::<span class="hljs-title function_ invoke__">fromStorage</span>(<span class="hljs-string">'audio.mp3'</span>)
    -&gt;<span class="hljs-title function_ invoke__">diarize</span>() <span class="hljs-comment">// æŒ‰è¯´è¯äººåˆ†æ®µ</span>
    -&gt;<span class="hljs-title function_ invoke__">generate</span>();
</code></pre>
<p>TTS æ”¯æŒ OpenAI å’Œ ElevenLabsï¼ŒSTT åŒæ ·æ”¯æŒè¿™ä¸¤ä¸ªæœåŠ¡å•†ã€‚</p>
<h3 data-id="heading-9">Embeddings ä¸å‘é‡æœç´¢</h3>
<p>ç”Ÿæˆå‘é‡åµŒå…¥å˜å¾—éå¸¸ç›´è§‚ã€‚Laravel çš„ <code>Stringable</code> ç±»æ–°å¢äº† <code>toEmbeddings()</code> æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$embeddings</span> = <span class="hljs-title class_">Str</span>::<span class="hljs-title function_ invoke__">of</span>(<span class="hljs-string">'Napa Valley has great wine.'</span>)-&gt;<span class="hljs-title function_ invoke__">toEmbeddings</span>();
</code></pre>
<p>é…åˆ PostgreSQL çš„ pgvector æ‰©å±•ï¼Œå¯ä»¥åœ¨æ•°æ®åº“ä¸­ç›´æ¥è¿›è¡Œå‘é‡ç›¸ä¼¼åº¦æŸ¥è¯¢ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$documents</span> = <span class="hljs-title class_">Document</span>::<span class="hljs-title function_ invoke__">query</span>()
    -&gt;<span class="hljs-title function_ invoke__">whereVectorSimilarTo</span>(<span class="hljs-string">'embedding'</span>, <span class="hljs-string">'çº³å¸•è°·æœ€å¥½çš„é…’åº„'</span>)
    -&gt;<span class="hljs-title function_ invoke__">limit</span>(<span class="hljs-number">10</span>)
    -&gt;<span class="hljs-title function_ invoke__">get</span>();
</code></pre>
<p>ä¼ å…¥å­—ç¬¦ä¸²æ—¶ï¼ŒLaravel ä¼šè‡ªåŠ¨ç”ŸæˆåµŒå…¥å‘é‡å†è¿›è¡ŒæŸ¥è¯¢ï¼Œä¸éœ€è¦æ‰‹åŠ¨å¤„ç†ã€‚Embedding è¿˜æ”¯æŒç¼“å­˜ï¼Œé¿å…é‡å¤è°ƒç”¨ APIã€‚</p>
<h3 data-id="heading-10">Reranking</h3>
<p>Reranking å¯ä»¥å¯¹æœç´¢ç»“æœæŒ‰è¯­ä¹‰ç›¸å…³æ€§é‡æ–°æ’åºï¼Œæ”¯æŒ Cohere å’Œ Jinaï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$posts</span> = <span class="hljs-title class_">Post</span>::<span class="hljs-title function_ invoke__">all</span>()-&gt;<span class="hljs-title function_ invoke__">rerank</span>(<span class="hljs-string">'body'</span>, <span class="hljs-string">'Laravel æ•™ç¨‹'</span>);
</code></pre>
<p>è¿™ä¸ªåŠŸèƒ½ç›´æ¥ä»¥ Collection å®çš„å½¢å¼æä¾›ï¼Œå¯ä»¥å¯¹ Eloquent é›†åˆæŒ‰æŒ‡å®šå­—æ®µåšè¯­ä¹‰é‡æ’ã€‚</p>
<h3 data-id="heading-11">æ–‡ä»¶ä¸å‘é‡å­˜å‚¨</h3>
<p>SDK æä¾›äº†æ–‡ä»¶ç®¡ç†å’Œå‘é‡å­˜å‚¨çš„å®Œæ•´æ–¹æ¡ˆã€‚æ–‡ä»¶å¯ä»¥ä¸Šä¼ åˆ°æœåŠ¡å•†å­˜å‚¨ååå¤å¼•ç”¨ï¼Œå‘é‡å­˜å‚¨åˆ™ç”¨äº RAG åœºæ™¯ä¸‹çš„æ–‡ä»¶æ£€ç´¢ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Laravel</span>\<span class="hljs-title">Ai</span>\<span class="hljs-title">Files</span>\<span class="hljs-title">Document</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Laravel</span>\<span class="hljs-title">Ai</span>\<span class="hljs-title">Stores</span>;

<span class="hljs-comment">// ä¸Šä¼ æ–‡ä»¶</span>
<span class="hljs-variable">$stored</span> = <span class="hljs-title class_">Document</span>::<span class="hljs-title function_ invoke__">fromPath</span>(<span class="hljs-string">'/path/to/report.pdf'</span>)-&gt;<span class="hljs-title function_ invoke__">put</span>();

<span class="hljs-comment">// åˆ›å»ºå‘é‡å­˜å‚¨å¹¶æ·»åŠ æ–‡ä»¶</span>
<span class="hljs-variable">$store</span> = <span class="hljs-title class_">Stores</span>::<span class="hljs-title function_ invoke__">create</span>(<span class="hljs-string">'çŸ¥è¯†åº“'</span>);
<span class="hljs-variable">$store</span>-&gt;<span class="hljs-title function_ invoke__">add</span>(<span class="hljs-variable">$stored</span>);
</code></pre>
<h3 data-id="heading-12">Failover</h3>
<p>è°ƒç”¨æ—¶ä¼ å…¥æœåŠ¡å•†æ•°ç»„ï¼ŒSDK ä¼šåœ¨ä¸»æœåŠ¡å•†ä¸å¯ç”¨æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨æœåŠ¡å•†ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$response</span> = (<span class="hljs-keyword">new</span> <span class="hljs-title class_">SalesCoach</span>)-&gt;<span class="hljs-title function_ invoke__">prompt</span>(
    <span class="hljs-string">'åˆ†æè¿™æ®µå½•éŸ³...'</span>,
    <span class="hljs-attr">provider</span>: [<span class="hljs-string">'openai'</span>, <span class="hljs-string">'anthropic'</span>],
);
</code></pre>
<h3 data-id="heading-13">Agent é…ç½®</h3>
<p>Agent æ”¯æŒé€šè¿‡ PHP Attribute é…ç½®å‚æ•°ï¼ŒåŒ…æ‹¬æœ€å¤§æ­¥æ•°ã€æœ€å¤§ token æ•°ã€æ¸©åº¦ã€è¶…æ—¶æ—¶é—´ç­‰ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">#[MaxSteps</span>(<span class="hljs-number">10</span>)<span class="hljs-meta">]</span>
<span class="hljs-meta">#[MaxTokens</span>(<span class="hljs-number">4096</span>)<span class="hljs-meta">]</span>
<span class="hljs-meta">#[Provider</span>(<span class="hljs-string">'anthropic'</span>)<span class="hljs-meta">]</span>
<span class="hljs-meta">#[Temperature</span>(<span class="hljs-number">0.7</span>)<span class="hljs-meta">]</span>
<span class="hljs-meta">#[Timeout</span>(<span class="hljs-number">120</span>)<span class="hljs-meta">]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SalesCoach</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Agent</span>
</span>{
    <span class="hljs-keyword">use</span> <span class="hljs-title">Promptable</span>;
}
</code></pre>
<p><code>UseCheapestModel</code> å’Œ <code>UseSmartestModel</code> ä¸¤ä¸ª Attribute å¯ä»¥è‡ªåŠ¨é€‰æ‹©æœåŠ¡å•†æœ€ä¾¿å®œæˆ–æœ€å¼ºçš„æ¨¡å‹ï¼Œä¸éœ€è¦è®°å…·ä½“çš„æ¨¡å‹åã€‚</p>
<h3 data-id="heading-14">ä¸­é—´ä»¶</h3>
<p>Agent æ”¯æŒä¸­é—´ä»¶æœºåˆ¶ï¼Œå¯ä»¥åœ¨è¯·æ±‚å‘é€å‰åæ’å…¥è‡ªå®šä¹‰é€»è¾‘ï¼Œæ¯”å¦‚æ—¥å¿—è®°å½•ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LogPrompts</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span>(<span class="hljs-params">AgentPrompt <span class="hljs-variable">$prompt</span>, <span class="hljs-built_in">Closure</span> <span class="hljs-variable">$next</span></span>)
    </span>{
        <span class="hljs-title class_">Log</span>::<span class="hljs-title function_ invoke__">info</span>(<span class="hljs-string">'Prompting agent'</span>, [<span class="hljs-string">'prompt'</span> =&gt; <span class="hljs-variable">$prompt</span>-&gt;prompt]);

        <span class="hljs-keyword">return</span> <span class="hljs-variable">$next</span>(<span class="hljs-variable">$prompt</span>)-&gt;<span class="hljs-title function_ invoke__">then</span>(function (AgentResponse <span class="hljs-variable">$response</span>) {
            <span class="hljs-title class_">Log</span>::<span class="hljs-title function_ invoke__">info</span>(<span class="hljs-string">'Agent responded'</span>, [<span class="hljs-string">'text'</span> =&gt; <span class="hljs-variable">$response</span>-&gt;text]);
        });
    }
}
</code></pre>
<h3 data-id="heading-15">æµ‹è¯•æ”¯æŒ</h3>
<p>SDK ä¸ºæ¯ä¸ªåŠŸèƒ½éƒ½æä¾›äº† <code>fake()</code> æ–¹æ³•å’Œæ–­è¨€ APIï¼Œæµ‹è¯•æ—¶ä¸éœ€è¦çœŸå®è°ƒç”¨ AI æœåŠ¡å•†ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title class_">SalesCoach</span>::<span class="hljs-title function_ invoke__">fake</span>([<span class="hljs-string">'ç¬¬ä¸€æ¡å“åº”'</span>, <span class="hljs-string">'ç¬¬äºŒæ¡å“åº”'</span>]);

<span class="hljs-comment">// æ‰§è¡Œä¸šåŠ¡é€»è¾‘...</span>

<span class="hljs-title class_">SalesCoach</span>::<span class="hljs-title function_ invoke__">assertPrompted</span>(<span class="hljs-string">'åˆ†æè¿™æ®µ...'</span>);
<span class="hljs-title class_">SalesCoach</span>::<span class="hljs-title function_ invoke__">assertNeverPrompted</span>();
</code></pre>
<p>å›¾åƒã€éŸ³é¢‘ã€è½¬å½•ã€Embeddingsã€Rerankingã€æ–‡ä»¶æ“ä½œã€å‘é‡å­˜å‚¨éƒ½æœ‰å¯¹åº”çš„ fake å’Œæ–­è¨€æ–¹æ³•ã€‚</p>
<h3 data-id="heading-16">æœåŠ¡å•†æ”¯æŒä¸€è§ˆ</h3>





































<table><thead><tr><th>åŠŸèƒ½</th><th>æ”¯æŒçš„æœåŠ¡å•†</th></tr></thead><tbody><tr><td>æ–‡æœ¬å¯¹è¯</td><td>OpenAIã€Anthropicã€Geminiã€Groqã€xAI</td></tr><tr><td>å›¾åƒç”Ÿæˆ</td><td>OpenAIã€Geminiã€xAI</td></tr><tr><td>è¯­éŸ³åˆæˆ</td><td>OpenAIã€ElevenLabs</td></tr><tr><td>è¯­éŸ³è½¬å½•</td><td>OpenAIã€ElevenLabs</td></tr><tr><td>å‘é‡åµŒå…¥</td><td>OpenAIã€Geminiã€Cohereã€Jina</td></tr><tr><td>é‡æ’åº</td><td>Cohereã€Jina</td></tr><tr><td>æ–‡ä»¶ç®¡ç†</td><td>OpenAIã€Anthropicã€Gemini</td></tr></tbody></table>
<h3 data-id="heading-17">å°ç»“</h3>
<p>Laravel AI SDK æŠŠ AI é›†æˆåšæˆäº† Laravel å¼€å‘è€…ç†Ÿæ‚‰çš„æ ·å­ï¼šArtisan å‘½ä»¤ç”Ÿæˆç±»ã€æ¥å£çº¦æŸè¡Œä¸ºã€trait å¤ç”¨é€»è¾‘ã€é˜Ÿåˆ—å¼‚æ­¥å¤„ç†ã€fake æ–¹æ³•å†™æµ‹è¯•ã€‚å¦‚æœä½ çš„ Laravel é¡¹ç›®éœ€è¦æ¥å…¥ AI èƒ½åŠ›ï¼Œè¿™ä¸ªåŒ…å€¼å¾—å°è¯•ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2026-02%2Flaravel-ai-sdk-released" target="_blank" title="https://catchadmin.com/post/2026-02/laravel-ai-sdk-released" ref="nofollow noopener noreferrer">ğŸ‰Laravel AI SDK æ­£å¼å‘å¸ƒ</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‹¼å¤šå¤šæ˜¥èŠ‚åŠ ç­å·¥èµ„æ›å…‰ï¼Œæ²¡å‡ ä¸ªæ•¢ç»™è¿™ä¸ªæ•°çš„ã€‚]]></title>    <link>https://juejin.cn/post/7603216479836045363</link>    <guid>https://juejin.cn/post/7603216479836045363</guid>    <pubDate>2026-02-06T00:40:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603216479836045363" data-draft-id="7603186080494534707" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‹¼å¤šå¤šæ˜¥èŠ‚åŠ ç­å·¥èµ„æ›å…‰ï¼Œæ²¡å‡ ä¸ªæ•¢ç»™è¿™ä¸ªæ•°çš„ã€‚"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-02-06T00:40:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CodeSheep"/> <meta itemprop="url" content="https://juejin.cn/user/4371313961738616"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‹¼å¤šå¤šæ˜¥èŠ‚åŠ ç­å·¥èµ„æ›å…‰ï¼Œæ²¡å‡ ä¸ªæ•¢ç»™è¿™ä¸ªæ•°çš„ã€‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4371313961738616/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CodeSheep
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T00:40:34.000Z" title="Fri Feb 06 2026 00:40:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è·ç¦»è¿‡å¹´å‡æœŸè¶Šæ¥è¶Šè¿‘äº†ï¼Œè¯´å®è¯ï¼Œè¿™ä¼šååœ¨å·¥ä½ä¸Šæœ‰æ—¶å€™æµ‘èº«åˆºæŒ ï¼Œæ€ç»ªä¸çŸ¥ä¸è§‰ä¹Ÿä¼šé£˜ä¸Šä¸€é˜µã€‚</p>
<p>æœ€è¿‘åœ¨ç½‘ä¸Šåˆ·åˆ°ä¸€ä¸ªè¿‡å¹´æœŸé—´ç”µå•†å¹³å°æ‹¼å¤šå¤šå†…éƒ¨åŠ ç­è¡¥è´´æ›å…‰çš„å¸–å­ï¼Œç›¸ä¿¡ä¸å°‘åŒå­¦ä¹Ÿçœ‹åˆ°äº†ï¼Œåœ¨èŒåœºç¤¾åŒºé‡Œå¼•å‘äº†ä¸€é˜µå…³æ³¨å’Œçƒ­è®®ã€‚</p>
<p>å…·ä½“å†…å®¹æ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36ce0297672e4d9dbb7b32e01c5a48e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29kZVNoZWVw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770943234&amp;x-signature=3lxm0OVo%2BxraXWcm5psP7y8a5DA%3D" alt="" loading="lazy"/></p>
<p>ç®€å•ç‚¹æ¥è¯´ï¼š</p>
<ul>
<li>
<p>ä»é™¤å¤•åˆ°åˆä¸‰è¿™å‰å››å¤©ï¼Œå‘˜å·¥å¯è·å¾—å½“æ—¥å·¥èµ„ 3 å€çš„æŠ¥é…¬ï¼Œå…¶ä¸­ä¸ä»…åŒ…æ‹¬æ­£å¸¸æ—¥è–ªï¼Œè¿˜é¢å¤–å¢åŠ äº†æ¯æ—¥ä¿åº• 400 å…ƒçš„è¡¥è´´ï¼›</p>
</li>
<li>
<p>è€Œä»åˆå››åˆ°åˆä¸ƒè¿™åå››å¤©ï¼ŒæŠ¥é…¬è°ƒæ•´ä¸ºå½“æ—¥å·¥èµ„çš„ 2 å€ï¼Œå½“ç„¶åŒæ ·åŒ…å«æ­£å¸¸æ—¥è–ªä¸æ¯æ—¥ä¿åº• 200 å…ƒçš„è¡¥è´´ã€‚</p>
</li>
</ul>
<p>ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰ç®—è¿‡ä¸€ç¬”è´¦ï¼Œä»¥ä¸€ä¸ªæœˆè–ª 2w~3w çš„å‘˜å·¥ä¸ºä¾‹ï¼ˆå½“ç„¶åœ¨æ‹¼å¤šå¤šå®é™…æ¯”è¿™é«˜çš„æ¯”æ¯”çš†æ˜¯ï¼‰ï¼Œå¹³å‡æ—¥è–ªå¦‚æœå°±ç²—ç•¥åœ°æŒ‰ 1000 å·¦å³æ¥ç®—çš„è¯ï¼Œå¦‚æœä»–é€‰æ‹©åŠ æ»¡è¿™ 9 å¤©ç­ï¼Œä»…æ³•å®šèŠ‚å‡æ—¥çš„ä¸‰å€å·¥èµ„éƒ¨åˆ†å°±å·²æ˜¯ä¸€ç¬”å·¨æ¬¾ã€‚</p>
<p>ç®€å•ä¸€äº›ç²—ç•¥ç®—ç®—ï¼Œå³ä¾¿ä¸ç®—ä¸Šå¸–å­é‡Œæ‰€è¯´çš„ä»€ä¹ˆè¡¥è´´ï¼Œå°±æŒ‰é™¤å¤•åˆ°åˆä¸‰è¿™å››å¤©æ¯å¤©ä¸‰å€å·¥èµ„ä»¥åŠåˆå››åˆ°åˆä¸ƒè¿™å››å¤©æ¯å¤©ä¸¤å€å·¥èµ„ï¼Œé‚£ä¹Ÿæœ‰ï¼š</p>
<p>ï¼ˆ3000Ã—4ï¼‰+ï¼ˆ2000Ã—4ï¼‰+1000=21000</p>
<p>ä¹Ÿå°±æ˜¯è¯´çŸ­çŸ­ 9 å¤©å‡æœŸï¼Œä¸¤ä¸‡å¤šåˆ°æ‰‹ï¼Œè¿™è¿˜ä¸ç®—å¸–å­é‡Œæ‰€è¯´çš„ä»€ä¹ˆå„ç§è¡¥è´´æˆ–è€…å…¶ä»–æ¿€åŠ±ï¼Œå¦‚æœåŠ ä¸Šè¿™äº›ï¼Œå®é™…æ”¶å…¥è¿˜ä¼šæ›´é«˜ã€‚</p>
<p>è¿™ä»€ä¹ˆæ¦‚å¿µï¼Œè¿™ç›¸å½“äºå¤§å‚æ™®é€šç¨‹åºå‘˜å·¥ä½œä¸€ä¸ªæœˆçš„è–ªèµ„ï¼Œä½†åœ¨è¿™é‡Œä»…ç”¨ä¸€å‘¨çš„æ—¶é—´å°±å¯ä»¥èµšåˆ°ã€‚</p>
<p>è¿™å¦‚æœè¦æ˜¯æåœ¨è®¸å¤šå…¶ä»–è¡Œä¸šï¼Œè¿™æˆ–è®¸æ˜¯ä¸€ä¸ªæ™®é€šå‘˜å·¥å¥½å‡ ä¸ªæœˆçš„å…¨éƒ¨æ”¶å…¥äº†ã€‚</p>
<p>æ›´å¼•äººæ³¨ç›®çš„æ˜¯ï¼ŒæŒ‰å¸–å­æ¥è¯´ï¼Œæ‹¼å¤šå¤šåœ¨è¿™æ¬¡æ˜¥èŠ‚æœŸé—´è¿˜å–æ¶ˆäº†è®¡ä»¶è–ªèµ„çš„å°é¡¶é™åˆ¶ï¼Œå¤šåŠ³å¤šå¾—ï¼Œä¸Šä¸å°é¡¶ã€‚</p>
<p>å½“ç„¶ï¼Œå’±ä»¬ä¸Šé¢è¿™åªæ˜¯ç²—ç•¥ç®—ç®—ï¼Œæ¯•ç«Ÿä¸åŒå²—ä½ï¼Œä¸åŒå·¥ç§ï¼Œä¸åŒå‘˜å·¥çš„åŠ ç­æ—¶é—´é€‰æ‹©æ®µä¹Ÿä¸ä¸€æ ·ï¼Œæ‰€ä»¥å®é™…æ”¶å…¥è‚¯å®šæ˜¯å„æœ‰ä¸åŒã€‚</p>
<p>æ¯”å¦‚å¯¹äºæ‹¼å¤šå¤šçš„ç ”å‘å²—ç¨‹åºå‘˜ä»¬æ¥è¯´ï¼Œé«˜ base çš„å‘˜å·¥é‚£æ¯”æ¯”çš†æ˜¯ï¼Œé‚£è¿™ä¸ªæ˜¥èŠ‚åŠ ç­æŠ¥é…¬åˆä¸‹æ¥æ›´æ˜¯éå¸¸å¯è§‚äº†ï¼Œæ¯”ä¸Šé¢ç®—çš„é«˜ä¸€å¤§æˆªä¹Ÿå†æ­£å¸¸ä¸è¿‡ã€‚</p>
<p>é‚£ä½œä¸ºè¡Œä¸šå†…çš„åèµ·ä¹‹ç§€ï¼Œæ‹¼å¤šå¤šå¦‚ä»Šå·²æ˜¯ä¸€ä¸ªæ‹¥æœ‰æµ·é‡ç”¨æˆ·çš„ç”µå•†å¹³å°ï¼Œæ‹¼å¤šå¤šçš„ç³»ç»Ÿéœ€è¦ 365 å¤©æ— é—´æ–­è¿è¡Œï¼Œå³ä¾¿æ˜¯æ˜¥èŠ‚æœŸé—´ï¼Œå„é¡¹ç”µå•†ä¸šåŠ¡å¯¹ç”¨æˆ·æ¥è¯´éƒ½éœ€è¦å¯ç”¨ï¼Œè¿™äº›éœ€æ±‚ä¸ä¼šå› ä¸ºèŠ‚å‡æ—¥è€Œæ¶ˆå¤±ã€‚</p>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œæ‹¼å¤šå¤šçš„å›½é™…ç‰ˆ Temu ä¹Ÿæ­£åœ¨å…¨çƒèŒƒå›´å†…è¿…çŒ›æ‰©å¼ ï¼Œæ— è®ºæ˜¯ä¸‹è½½é‡è¿˜æ˜¯æœˆæ´»æ•°æ®éƒ½å±¡åˆ›æ–°é«˜ï¼Œè¿™äº›æµ·å¤–ç”¨æˆ·çš„è´­ç‰©éœ€æ±‚åœ¨æ˜¥èŠ‚æœŸé—´ä¸ä¼šå‡å°‘ã€‚</p>
<p>å› æ­¤ä¸å…‰æ˜¯æ‹¼å¤šå¤šï¼Œåƒè¿™ç±»ç”µå•†å¹³å°å…¬å¸ï¼Œæ˜¥èŠ‚æœŸé—´ä¸ºäº†ä¿è¯ç³»ç»Ÿçš„ç¨³å®šè¿è¡Œï¼Œéƒ½ä¼šå®‰æ’ä¸“äººå€¼ç­ã€‚</p>
<p>è€Œä¸”æ‹¼å¤šå¤šçš„äººæ•ˆåœ¨ç”µå•†è¡Œä¸šä¸­ä¸€ç›´å¤„äºæ¯”è¾ƒé¢†å…ˆçš„æ°´å¹³ï¼Œåœ¨è¿™æ ·çš„é«˜æ•ˆè¿è¥æ¨¡å¼ä¸‹ï¼Œä¸ºå…³é”®å²—ä½æä¾›é«˜é¢åŠ ç­è¡¥è´´ï¼Œç¡®ä¿ä¸šåŠ¡è¿ç»­æ€§å’Œç¨³å®šæ€§ï¼Œè¿™å¯¹äºä»–ä»¬å…¬å¸æ¥è¯´ï¼Œå…¶å®æ˜¯ä¸€ç§éå¸¸ç†æ€§çš„å•†ä¸šæŠ•èµ„ï¼Œæ€ä¹ˆç®—éƒ½æ˜¯éå¸¸åˆ’ç®—çš„ã€‚</p>
<p>å‰æ®µæ—¶é—´ï¼Œåœ¨ç½‘ä¸Šä¸æ˜¯æœ‰ä¸€ä¸ªæµä¼ å¾ˆå¹¿çš„é‚£ä¸ªã€Šå›½å†…æœ€éš¾å…¥èŒçš„ IT å…¬å¸æ’è¡Œã€‹è¡¨æ ¼å˜›ï¼Œç›¸ä¿¡ä¸å°‘åŒå­¦éƒ½çœ‹è¿‡ï¼Œå…¶ä¸­æ’åœ¨æ¦œé¦–çš„å°±æ˜¯æ‹¼å¤šå¤šã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/93013f302aef4d46a9c630296913a90a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29kZVNoZWVw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770943234&amp;x-signature=p8fGnraLuCYsh2WySs3MIr4Jigg%3D" alt="" loading="lazy"/></p>
<p>å½“ç„¶è¿™ä¸ªè¡¨æ ¼å¹¶éå®˜æ–¹å‘å¸ƒçš„ï¼Œè€Œæ˜¯æœ‰ç½‘å‹æ ¹æ®æ ¡æ‹›é¢è¯•çš„ä¸€äº›æƒ…å†µæ•´ç†å¾—å‡ºçš„ï¼Œåªèƒ½ç®—æ˜¯ä¸€ä¸ªä¸»è§‚æ„Ÿå—ç»“æœï¼Œå¹¶ä¸èƒ½ä¿è¯å®Œå…¨å‡†ç¡®ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒæ„Ÿå—ä¸€ä¸‹ã€‚</p>
<p>å¤§å®¶çŸ¥é“æ‹¼å¤šå¤šç´ æ¥éƒ½ä»¥å¿«èŠ‚å¥ã€é«˜å‹åŠ›å’Œå¼ºæ‰§è¡Œæ‰€è‘—ç§°ï¼Œå…¶é¢è¯•éš¾åº¦åœ¨äº’è”ç½‘è¡Œä¸šä½å±…å‰åˆ—åŸºæœ¬æ˜¯æ²¡æ¯›ç—…çš„ï¼Œå°¤å…¶åœ¨æŠ€æœ¯ç ”å‘å²—å’Œæ ¸å¿ƒä¸šåŠ¡éƒ¨é—¨ã€‚</p>
<p>å°±æ‹¿æŠ€æœ¯å²—æ¥è¯´ï¼Œé¢è¿‡æ‹¼å¤šå¤šçš„åŒå­¦éƒ½çŸ¥é“å…¶ç®—æ³•ä¸å®æˆ˜å¹¶é‡ï¼Œé¢˜ç›®éš¾åº¦å¯å¯¹æ ‡ LeetCode ä¸­ç­‰åˆ° Hard çº§åˆ«ï¼Œæ¯”å¦‚ç»„åˆæ€»æ•°ã€åŠ¨æ€è§„åˆ’ç­‰è¿™ç±»é—®é¢˜ï¼Œè€Œä¸”éœ€æ‰‹å†™ä»£ç å¹¶ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ã€‚</p>
<p>å¦å¤–æ‹¼å¤šå¤šå¯¹äºå·¥ç¨‹å®è·µèƒ½åŠ›ä¹Ÿéå¸¸ä¾§é‡ï¼Œåƒä»€ä¹ˆé«˜å¹¶å‘ã€æ•°æ®åº“ä¼˜åŒ–ã€åˆ†å¸ƒå¼ç¼“å­˜ä¸€è‡´æ€§ç­‰ç­‰è€ƒæŸ¥ï¼Œåœ¨é¢è¯•çš„æ—¶å€™åŸºæœ¬éƒ½æ˜¯å®¶å¸¸ä¾¿é¥­ã€‚</p>
<p>åœ¨æ‹¼å¤šå¤šè™½ç„¶å·¥ä½œå¼ºåº¦å¤§ï¼Œå·¥ä½œé‡å¤šï¼Œä½†äººå®¶ä¹Ÿæ˜¯çœŸçš„è‚¯ç»™é’±ã€‚å°±åƒç½‘å‹è¯´çš„é‚£æ ·ï¼Œåªè¦å›æŠ¥å’Œå·¥ä½œé‡èƒ½ç›¸åŒ¹é…ï¼Œé‚£å¤§å®¶åŸºæœ¬éƒ½è¿˜æ˜¯å¯ä»¥æ¥å—çš„ã€‚</p>
<p>å½“ç„¶ï¼Œè¿˜æ˜¯é‚£å¥è¯ï¼Œæ¯ä¸ªäººçš„æƒ³æ³•ä¸ä¸€æ ·ï¼Œæ¯ä¸ªäººçš„é€‰æ‹©ä¹Ÿä¸ä¸€æ ·ï¼Œå¦‚æœæ˜¯ä½ ï¼Œé¢å¯¹é«˜é¢çš„åŠ ç­è¡¥è´´ or éš¾å¾—çš„å‡æœŸç”Ÿæ´»ï¼Œä½ ä¼šæ€ä¹ˆé€‰æ‹©å‘¢ï¼Ÿ</p>
<blockquote>
<p>æ³¨ï¼šæœ¬æ–‡åœ¨GitHubå¼€æºä»“åº“ã€Œç¼–ç¨‹ä¹‹è·¯ã€ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Frd2coding%2FRoad2Coding" target="_blank" title="https://github.com/rd2coding/Road2Coding" ref="nofollow noopener noreferrer">github.com/rd2coding/Râ€¦</a> ä¸­å·²ç»æ”¶å½•ï¼Œé‡Œé¢æœ‰æˆ‘æ•´ç†çš„6å¤§ç¼–ç¨‹æ–¹å‘(å²—ä½)çš„è‡ªå­¦è·¯çº¿+çŸ¥è¯†ç‚¹å¤§æ¢³ç†ã€é¢è¯•è€ƒç‚¹ã€æˆ‘çš„ç®€å†ã€å‡ æœ¬ç¡¬æ ¸pdfç¬”è®°ï¼Œä»¥åŠç¨‹åºå‘˜ç”Ÿæ´»å’Œæ„Ÿæ‚Ÿï¼Œæ¬¢è¿starã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI æ¨¡å‹æ˜¥æ™šæ¥äº†ï¼ŒOpus 4.6 å’Œ GPT5.3 åŒæ—¥ç™»åœºï¼Œä¸‹ä¸€ä¸ªä¼šæ˜¯è°å‘¢ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7603219519667535891</link>    <guid>https://juejin.cn/post/7603219519667535891</guid>    <pubDate>2026-02-06T00:52:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603219519667535891" data-draft-id="7603246733317275702" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI æ¨¡å‹æ˜¥æ™šæ¥äº†ï¼ŒOpus 4.6 å’Œ GPT5.3 åŒæ—¥ç™»åœºï¼Œä¸‹ä¸€ä¸ªä¼šæ˜¯è°å‘¢ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,OpenAI"/> <meta itemprop="datePublished" content="2026-02-06T00:52:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Moment"/> <meta itemprop="url" content="https://juejin.cn/user/3782764966460398"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI æ¨¡å‹æ˜¥æ™šæ¥äº†ï¼ŒOpus 4.6 å’Œ GPT5.3 åŒæ—¥ç™»åœºï¼Œä¸‹ä¸€ä¸ªä¼šæ˜¯è°å‘¢ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3782764966460398/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Moment
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T00:52:10.000Z" title="Fri Feb 06 2026 00:52:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p>ä»Šå¤©å‡Œæ™¨ï¼ŒAI åœˆçªç„¶å‘å¸ƒäº†ä¸¤ä¸ªé‡ç£…æ¶ˆæ¯ï¼Œä¸¤è€…ä¹‹é—´ç›¸å·®ä¸åˆ°åŠä¸ªå°æ—¶ï¼Œé‚£å¯çœŸæ˜¯ AI æ˜¥æ™šå‘ã€‚Anthropic å’Œ OpenAI è¿™ä¸¤å®¶ AI é¢†åŸŸçš„å¤´éƒ¨å…¬å¸ï¼Œä»¿ä½›çº¦å¥½äº†ä¸€èˆ¬ï¼Œåœ¨åŒä¸€ä¸ªæ¸…æ™¨å‘ä¸–ç•Œå®£å‘Šï¼šæ–°ä¸€ä»£å¤§æ¨¡å‹æ¥äº†ï¼</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/31b40a8edbca422c818dc9ecc988b7b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTW9tZW50:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770943930&amp;x-signature=7vQYjgr%2BrfU7SFbxh8rmws2CtZ4%3D" alt="20260206083225" loading="lazy"/></p>
<h2 data-id="heading-0">Claude Opus 4.6ï¼šæ›´æ™ºèƒ½ã€æ›´å¯é ã€æ›´å¼ºå¤§</h2>
<p>é¦–å…ˆç™»åœºçš„æ˜¯ Anthropic çš„ Claude Opus 4.6ã€‚æ ¹æ®å®˜æ–¹ä»‹ç»ï¼Œè¿™æ˜¯ä»–ä»¬"æœ€æ™ºèƒ½çš„æ¨¡å‹å‡çº§"ã€‚Opus 4.6 åœ¨ä¸‰ä¸ªå…³é”®ç»´åº¦å®ç°äº†æ˜¾è‘—æå‡ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c03004b811824e7194a8e9ba4783a2b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTW9tZW50:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770943930&amp;x-signature=Bt8PFKON3YLfcY0kMbXzXNNfdug%3D" alt="20260206083308" loading="lazy"/></p>
<ul>
<li><strong>æ›´è°¨æ…çš„è§„åˆ’</strong>ï¼šèƒ½å¤Ÿæ›´é•¿æ—¶é—´åœ°ä¿æŒä¸“æ³¨ï¼Œå¤„ç†éœ€è¦æŒç»­æ³¨æ„åŠ›çš„å¤æ‚ä»»åŠ¡</li>
<li><strong>å¤§è§„æ¨¡ä»£ç åº“çš„å¯é æ€§</strong>ï¼šåœ¨å¤„ç†åºå¤§ä»£ç åº“æ—¶è¡¨ç°æ›´åŠ ç¨³å®šå’Œå¯é </li>
<li><strong>è‡ªæˆ‘çº é”™èƒ½åŠ›</strong>ï¼šèƒ½å¤Ÿæ•è·å¹¶ä¿®æ­£è‡ªå·±çš„é”™è¯¯ï¼Œè¿™æ˜¯ AI èµ°å‘çœŸæ­£æ™ºèƒ½çš„é‡è¦ä¸€æ­¥</li>
</ul>
<p>æ›´ä»¤äººå…´å¥‹çš„æ˜¯ï¼ŒOpus 4.6 æˆä¸ºäº†é¦–ä¸ªåœ¨æµ‹è¯•é˜¶æ®µå°±æ‹¥æœ‰ <strong>1M token ä¸Šä¸‹æ–‡çª—å£</strong>çš„ Opus çº§åˆ«æ¨¡å‹ã€‚è¿™æ„å‘³ç€å®ƒå¯ä»¥ä¸€æ¬¡æ€§å¤„ç†æ›´é•¿çš„æ–‡æœ¬ã€æ›´å¤§çš„ä»£ç åº“ï¼Œæå¤§åœ°æå‡äº†å®é™…åº”ç”¨ä¸­çš„æ•ˆç‡ã€‚</p>
<h2 data-id="heading-1">OpenAI ç«é€Ÿè·Ÿè¿›ï¼šGPT-5.3-Codex å¼ºåŠ¿ç™»åœº</h2>
<p>Claude å‘å¸ƒä¸åˆ°åŠå°æ—¶ï¼ŒOpenAI å°±ç´§éšå…¶åå‘å¸ƒäº† GPT-5.3-Codexã€‚è¿™ä¸ªèŠ‚å¥ï¼Œè®©äººä¸ç¦æ„Ÿå¹ï¼šè¿™åœº AI ç«èµ›å·²ç»ç™½çƒ­åŒ–äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/07ed74e0b9d04b9983e053b182092d1c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTW9tZW50:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770943930&amp;x-signature=x3ZlkUwxBM%2BeRDzYsJRBEFdiUPQ%3D" alt="20260206083447" loading="lazy"/></p>
<p>GPT-5.3-Codex ç°å·²åœ¨ Codex å¹³å°ä¸Šçº¿ï¼ŒOpenAI å®˜æ–¹å®£ç§°ï¼š"ä½ å¯ä»¥ç›´æ¥ç”¨å®ƒæ¥æ„å»ºä¸œè¥¿ã€‚"ï¼ˆYou can just build things.ï¼‰è¿™ç§è‡ªä¿¡çš„è¡¨è¿°èƒŒåï¼Œæ˜¯ä»–ä»¬å¯¹è¿™ä¸ªæ–°æ¨¡å‹èƒ½åŠ›çš„å……åˆ†è‚¯å®šã€‚</p>
<h2 data-id="heading-2">æ•°æ®ä¸ä¼šè¯´è°ï¼šè°æ›´å¼ºï¼Ÿ</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9568f6f536243658e5f22338476831d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTW9tZW50:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770943930&amp;x-signature=UJAyFuWV5kKHbjFy%2FsPuEenecUQ%3D" alt="20260206083646" loading="lazy"/></p>
<p>ä»å®˜æ–¹å‘å¸ƒçš„æ€§èƒ½å¯¹æ¯”å›¾è¡¨æ¥çœ‹ï¼Œä¸¤ä¸ªæ¨¡å‹å„æœ‰åƒç§‹ï¼š</p>
<h3 data-id="heading-3">ä¸»è¦æµ‹è¯•ç»“æœå¯¹æ¯”</h3>
<p>åœ¨å¤šé¡¹åŸºå‡†æµ‹è¯•ä¸­ï¼ŒOpus 4.6 å’Œ GPT-5.3-Codex å±•å¼€äº†æ¿€çƒˆç«äº‰ï¼š</p>
<ul>
<li><strong>Agentic terminal testing</strong>ï¼šOpus 4.6 ä»¥ 65.4% é¢†å…ˆ</li>
<li><strong>Agentic coding</strong>ï¼šOpus 4.6 80.8%ï¼ŒGPT-5.3-Codex 80.0%ï¼Œå‡ ä¹æ‰“å¹³</li>
<li><strong>Agentic computer use</strong>ï¼šOpus 4.6 72.7% å ä¼˜</li>
<li><strong>Agentic tool use</strong> å’Œ <strong>Scaled tool use</strong>ï¼šOpus 4.6 ç»§ç»­é¢†å…ˆ</li>
</ul>
<h3 data-id="heading-4">ä¸“ä¸šé¢†åŸŸæµ‹è¯•</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/616345cd701148cabed9c924a1413e54~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTW9tZW50:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770943930&amp;x-signature=%2BcqezdFmJlMQSFu%2B64M0boGAfe4%3D" alt="20260206083521" loading="lazy"/></p>
<p>åœ¨æ›´å¤šä¸“ä¸šé¢†åŸŸçš„æµ‹è¯•ä¸­ï¼š</p>
<ul>
<li><strong>Office tasks</strong>ï¼šGPT-5.3-Codex ä»¥ 1463 åˆ†é¢†å…ˆ</li>
<li><strong>Multidisciplinary reasoning</strong>ï¼šOpus 4.6 åœ¨å¤šä¸ªç»´åº¦è¡¨ç°æ›´ä¼˜</li>
<li><strong>Multilingual Q&amp;A</strong>ï¼šOpus 4.6 91.1% vs GPT-5.3-Codex 89.6%</li>
<li><strong>Visual reasoning</strong>ï¼šä¸¤è€…éƒ½è¶…è¿‡ 77%ï¼Œè¡¨ç°ä¼˜å¼‚</li>
</ul>
<h2 data-id="heading-5">ç¼–ç èƒ½åŠ›çš„å·…å³°å¯¹å†³</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9dc5cbb5bd9453395f3d8799eb8bb8e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTW9tZW50:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770943930&amp;x-signature=4sTaNInO2JJv7apF8imQxqH8Pqw%3D" alt="20260206083605" loading="lazy"/></p>
<p>ç‰¹åˆ«å€¼å¾—å…³æ³¨çš„æ˜¯ç¼–ç èƒ½åŠ›æµ‹è¯•ã€‚åœ¨ Terminal-Bench 2.0 è¿™ä¸ªå¤‡å—å…³æ³¨çš„ç¼–ç åŸºå‡†æµ‹è¯•ä¸­ï¼š</p>
<ul>
<li><strong>GPT-5.3-Codex (high)</strong>: 77.3%</li>
<li><strong>GPT-5.2-Codex (high)</strong>: 64.0%</li>
<li><strong>GPT-5.2 (high)</strong>: 62.2%</li>
</ul>
<p>è€Œåœ¨ SWE-Bench Pro å…¬å¼€æµ‹è¯•ä¸­ï¼š</p>
<ul>
<li><strong>GPT-5.3-Codex (high)</strong>: 56.8%</li>
<li><strong>GPT-5.2-Codex (high)</strong>: 56.4%</li>
<li><strong>GPT-5.2 (high)</strong>: 55.6%</li>
</ul>
<p>è¿™äº›æ•°æ®æ˜¾ç¤ºï¼ŒGPT-5.3-Codex åœ¨ç¼–ç ä»»åŠ¡ä¸Šç¡®å®æœ‰æ˜¾è‘—æå‡ï¼Œå°¤å…¶æ˜¯åœ¨ Terminal-Bench 2.0 ä¸Šå–å¾—äº†çªç ´æ€§çš„ 77.3% å¾—åˆ†ã€‚</p>
<h2 data-id="heading-6">AI å†›å¤‡ç«èµ›ï¼šè°æ˜¯çœŸæ­£çš„èµ¢å®¶ï¼Ÿ</h2>
<p>æœ‰ç½‘å‹åˆ¶ä½œäº†ä¸€å¼ è®½åˆºå›¾ï¼Œå±•ç¤ºäº† OpenAIã€Grokã€Gemini å’Œå…¶ä»– AI å…¬å¸éƒ½åœ¨å¾ªç¯å®£ç§°è‡ªå·±æ¨å‡ºäº†"ä¸–ç•Œä¸Šæœ€å¼ºå¤§çš„æ¨¡å‹"ã€‚è¿™ç§ç°è±¡èƒŒåï¼Œåæ˜ çš„æ˜¯ AI è¡Œä¸šç«äº‰çš„æ¿€çƒˆç¨‹åº¦ã€‚</p>
<p>ä½†ä»ç”¨æˆ·è§’åº¦æ¥çœ‹ï¼Œè¿™ç§ç«äº‰æ— ç–‘æ˜¯å¥½äº‹ï¼š</p>
<ol>
<li><strong>æŠ€æœ¯å¿«é€Ÿè¿­ä»£</strong>ï¼šæ¨¡å‹èƒ½åŠ›ä»¥è‚‰çœ¼å¯è§çš„é€Ÿåº¦æå‡</li>
<li><strong>ä»·æ ¼æ›´åŠ äº²æ°‘</strong>ï¼šç«äº‰ä¿ƒä½¿å„å®¶ä¼˜åŒ–æˆæœ¬</li>
<li><strong>åº”ç”¨åœºæ™¯æ‰©å±•</strong>ï¼šæ›´å¼ºçš„èƒ½åŠ›æ„å‘³ç€æ›´å¤šå¯èƒ½æ€§</li>
<li><strong>å¼€å‘è€…å—ç›Š</strong>ï¼šæ›´å¥½çš„å·¥å…·ï¼Œæ›´é«˜çš„ç”Ÿäº§åŠ›</li>
</ol>
<h2 data-id="heading-7">ç»“è¯­ï¼šAI çš„é»„é‡‘æ—¶ä»£æ‰åˆšåˆšå¼€å§‹</h2>
<p>ä»å‡Œæ™¨çš„"åŒå“ç‚®"å¯ä»¥çœ‹å‡ºï¼ŒAI å¤§æ¨¡å‹çš„ç«èµ›å·²ç»è¿›å…¥äº†åˆ†ç§’å¿…äº‰çš„é˜¶æ®µã€‚Anthropic å’Œ OpenAI çš„åŒæ—¶å‘å¸ƒï¼Œæ—¢æ˜¯å·§åˆï¼Œä¹Ÿæ˜¯å¿…ç„¶â€”â€”åœ¨è¿™ä¸ªæŠ€æœ¯çˆ†ç‚¸çš„æ—¶ä»£ï¼Œè°ä¹Ÿä¸æƒ³è½ååŠæ­¥ã€‚</p>
<p>å¯¹äºå¼€å‘è€…å’Œç”¨æˆ·è€Œè¨€ï¼Œè¿™æ˜¯æœ€å¥½çš„æ—¶ä»£ã€‚æˆ‘ä»¬ä¸å¿…çº ç»“äºè°æ˜¯"æœ€å¼º"ï¼Œå› ä¸ºåœ¨æ¿€çƒˆçš„ç«äº‰ä¸­ï¼Œæ¯ä¸€å®¶éƒ½åœ¨å…¨åŠ›ä»¥èµ´åœ°æ¨åŠ¨æŠ€æœ¯è¿›æ­¥ã€‚Claude Opus 4.6 çš„ 1M token ä¸Šä¸‹æ–‡ã€æ›´å¼ºçš„è‡ªæˆ‘çº é”™èƒ½åŠ›ï¼ŒGPT-5.3-Codex åœ¨ç¼–ç ä»»åŠ¡ä¸Šçš„çªç ´ï¼Œéƒ½æ˜¯å®æ‰“å®çš„èƒ½åŠ›æå‡ã€‚</p>
<p>AI æ¨¡å‹çš„æ˜¥æ™šæ‰åˆšåˆšå¼€å§‹ï¼Œ2026 å¹´æ³¨å®šæ˜¯ç²¾å½©çº·å‘ˆçš„ä¸€å¹´ã€‚è®©æˆ‘ä»¬æ‹­ç›®ä»¥å¾…ï¼Œçœ‹çœ‹æ¥ä¸‹æ¥è¿˜ä¼šæœ‰å“ªäº›æƒŠå–œã€‚</p>
<p><strong>ä½ æ›´çœ‹å¥½å“ªä¸ªæ¨¡å‹ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„çœ‹æ³•ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[django n+1æŸ¥è¯¢é—®é¢˜ä¼˜åŒ–æŒ‡å—]]></title>    <link>https://juejin.cn/post/7603195960255496192</link>    <guid>https://juejin.cn/post/7603195960255496192</guid>    <pubDate>2026-02-06T01:02:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603195960255496192" data-draft-id="7603195960255479808" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="django n+1æŸ¥è¯¢é—®é¢˜ä¼˜åŒ–æŒ‡å—"/> <meta itemprop="keywords" content="Django,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-02-06T01:02:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆé‡Œè°¢é¡¿"/> <meta itemprop="url" content="https://juejin.cn/user/3678304397695056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            django n+1æŸ¥è¯¢é—®é¢˜ä¼˜åŒ–æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3678304397695056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆé‡Œè°¢é¡¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T01:02:40.000Z" title="Fri Feb 06 2026 01:02:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯ N+1 æŸ¥è¯¢é—®é¢˜ï¼Ÿ</h2>
<h3 data-id="heading-1">ğŸ“Œ åœºæ™¯ç¤ºä¾‹</h3>
<p>å‡è®¾ä½ æœ‰ä»¥ä¸‹æ¨¡å‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># models.py</span>
class Author(models.Model):
    <span class="hljs-attr">name</span> = models.CharField(max_length=<span class="hljs-number">100</span>)

class Book(models.Model):
    <span class="hljs-attr">title</span> = models.CharField(max_length=<span class="hljs-number">100</span>)
    <span class="hljs-attr">author</span> = models.ForeignKey(Author, <span class="hljs-literal">on</span>_delete=models.CASCADE)
</code></pre>
<p>ç°åœ¨ä½ æƒ³åœ¨æ¨¡æ¿ä¸­åˆ—å‡ºæ‰€æœ‰ä¹¦ç±åŠå…¶ä½œè€…ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># views.py</span>
<span class="hljs-attr">books</span> = Book.objects.all()
</code></pre>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- template.html --&gt;</span>
{% for book in books %}
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ book.title }} by {{ book.author.name }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
{% endfor %}
</code></pre>
<h3 data-id="heading-2">ğŸ” å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h3>
<ul>
<li><strong>1 æ¬¡æŸ¥è¯¢</strong>ï¼š<code>SELECT * FROM book;</code>ï¼ˆè·å–æ‰€æœ‰ä¹¦ç±ï¼‰</li>
<li><strong>N æ¬¡æŸ¥è¯¢</strong>ï¼šå¯¹æ¯æœ¬ä¹¦ï¼Œæ‰§è¡Œ <code>SELECT * FROM author WHERE id = ?;</code>ï¼ˆè·å–ä½œè€…ï¼‰</li>
</ul>
<p>å¦‚æœ <code>books</code> æœ‰ 100 æ¡è®°å½• â†’ <strong>æ€»å…± 101 æ¬¡æ•°æ®åº“æŸ¥è¯¢ï¼</strong></p>
<blockquote>
<p>âœ… è¿™å°±æ˜¯ <strong>N+1 é—®é¢˜</strong>ï¼š1 æ¬¡ä¸»æŸ¥è¯¢ + N æ¬¡å…³è”æŸ¥è¯¢ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-3">äºŒã€å¦‚ä½•è¯Šæ–­ N+1 é—®é¢˜ï¼Ÿ</h2>
<h3 data-id="heading-4">æ–¹æ³• 1ï¼šä½¿ç”¨ <code>django.db.connection.queries</code></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> connection

books = Book.objects.<span class="hljs-built_in">all</span>()
<span class="hljs-keyword">for</span> book <span class="hljs-keyword">in</span> books:
    <span class="hljs-built_in">print</span>(book.author.name)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"Total queries: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(connection.queries)}</span>"</span>)
</code></pre>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šéœ€å…³é—­ <code>DEBUG=False</code> æˆ–æ‰‹åŠ¨å¯ç”¨ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">from django.conf import settings
<span class="hljs-attr">settings.DEBUG</span> = <span class="hljs-literal">True</span>
</code></pre>
</blockquote>
<h3 data-id="heading-5">æ–¹æ³• 2ï¼šä½¿ç”¨ Django Debug Toolbarï¼ˆå¼€å‘ç¯å¢ƒå¿…å¤‡ï¼‰</h3>
<ul>
<li>å®‰è£…åï¼Œé¡µé¢åº•éƒ¨æ˜¾ç¤º SQL æŸ¥è¯¢æ¬¡æ•°å’Œå†…å®¹</li>
<li>çº¢è‰²é«˜äº®é‡å¤æŸ¥è¯¢</li>
</ul>
<h3 data-id="heading-6">æ–¹æ³• 3ï¼šæ—¥å¿—ç›‘æ§ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰</h3>
<p>é…ç½®æ•°æ®åº“æ—¥å¿—ï¼Œè§‚å¯ŸçŸ­æ—¶é—´å†…çš„é«˜é¢‘ç›¸ä¼¼æŸ¥è¯¢ã€‚</p>
<hr/>
<h2 data-id="heading-7">ä¸‰ã€è§£å†³æ–¹æ¡ˆï¼ˆæŒ‰åœºæ™¯åˆ†ç±»ï¼‰</h2>
<hr/>
<h3 data-id="heading-8">âœ… æ–¹æ¡ˆ 1ï¼šä½¿ç”¨ <code>select_related()</code>ï¼ˆé€‚ç”¨äº <strong>ForeignKey / OneToOne</strong>ï¼‰</h3>
<blockquote>
<p><strong>åŸç†</strong>ï¼šé€šè¿‡ <strong>JOIN</strong> åœ¨ä¸€æ¬¡æŸ¥è¯¢ä¸­è·å–å…³è”å¯¹è±¡ã€‚</p>
</blockquote>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ä¿®å¤å‰ï¼ˆN+1ï¼‰</span>
<span class="hljs-attr">books</span> = Book.objects.all()

<span class="hljs-comment"># ä¿®å¤åï¼ˆ1 æ¬¡æŸ¥è¯¢ï¼‰</span>
<span class="hljs-attr">books</span> = Book.objects.select_related(<span class="hljs-string">'author'</span>)
</code></pre>
<p>ç”Ÿæˆ SQLï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> book.<span class="hljs-operator">*</span>, author.<span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span> book
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">OUTER</span> <span class="hljs-keyword">JOIN</span> author <span class="hljs-keyword">ON</span> book.author_id <span class="hljs-operator">=</span> author.id;
</code></pre>
<h4 data-id="heading-9">æ”¯æŒå¤šå±‚å…³è”ï¼š</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># è·å–ä¹¦ç± â†’ ä½œè€… â†’ ä½œè€…çš„å›½å®¶</span>
<span class="hljs-attr">books</span> = Book.objects.select_related(<span class="hljs-string">'author__country'</span>)
</code></pre>
<blockquote>
<p>âœ… é€‚ç”¨å…³ç³»ï¼š<strong>æ­£å‘ ForeignKeyã€OneToOneField</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-10">âœ… æ–¹æ¡ˆ 2ï¼šä½¿ç”¨ <code>prefetch_related()</code>ï¼ˆé€‚ç”¨äº <strong>åå‘ ForeignKey / ManyToMany</strong>ï¼‰</h3>
<blockquote>
<p><strong>åŸç†</strong>ï¼šå…ˆæŸ¥ä¸»è¡¨ï¼Œå†ç”¨ <strong>IN æŸ¥è¯¢</strong> ä¸€æ¬¡æ€§è·å–æ‰€æœ‰å…³è”å¯¹è±¡ï¼Œç„¶ååœ¨ Python ä¸­â€œæ‹¼æ¥â€ã€‚</p>
</blockquote>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># models.py</span>
class Publisher(models.Model):
    <span class="hljs-attr">name</span> = models.CharField(max_length=<span class="hljs-number">100</span>)

class Book(models.Model):
    <span class="hljs-attr">title</span> = = models.CharField(max_length=<span class="hljs-number">100</span>)
    <span class="hljs-attr">publisher</span> = models.ForeignKey(Publisher, <span class="hljs-literal">on</span>_delete=models.CASCADE)
</code></pre>
<p>æƒ³åˆ—å‡ºæ¯ä¸ªå‡ºç‰ˆç¤¾åŠå…¶æ‰€æœ‰ä¹¦ç±ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># è§†å›¾</span>
<span class="hljs-attr">publishers</span> = Publisher.objects.prefetch_related(<span class="hljs-string">'book_set'</span>)
</code></pre>
<pre><code class="hljs language-css" lang="css">{% for publisher in publishers %}
  &lt;<span class="hljs-selector-tag">h3</span>&gt;{{ publisher<span class="hljs-selector-class">.name</span> }}&lt;/<span class="hljs-selector-tag">h3</span>&gt;
  &lt;<span class="hljs-selector-tag">ul</span>&gt;
    {% for book in publisher<span class="hljs-selector-class">.book_set</span><span class="hljs-selector-class">.all</span> %}
      &lt;<span class="hljs-selector-tag">li</span>&gt;{{ book<span class="hljs-selector-class">.title</span> }}&lt;/<span class="hljs-selector-tag">li</span>&gt;
    {% endfor %}
  &lt;/<span class="hljs-selector-tag">ul</span>&gt;
{% endfor %}
</code></pre>
<blockquote>
<p>âœ… åªäº§ç”Ÿ <strong>2 æ¬¡æŸ¥è¯¢</strong>ï¼š</p>
<ol>
<li><code>SELECT * FROM publisher;</code></li>
<li><code>SELECT * FROM book WHERE publisher_id IN (1, 2, 3, ...);</code></li>
</ol>
</blockquote>
<h4 data-id="heading-11">æ”¯æŒå¤æ‚é¢„å–ï¼š</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># é¢„å–å¤šå±‚ + è¿‡æ»¤</span>
<span class="hljs-attr">publishers</span> = Publisher.objects.prefetch_related(
    Prefetch('book_set', <span class="hljs-attr">queryset</span>=Book.objects.filter(title__icontains=<span class="hljs-string">'Django'</span>))
)
</code></pre>
<blockquote>
<p>âœ… é€‚ç”¨å…³ç³»ï¼š<strong>åå‘ ForeignKeyã€ManyToManyFieldã€GenericForeignKey</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-12">âœ… æ–¹æ¡ˆ 3ï¼šç»„åˆä½¿ç”¨ <code>select_related</code> + <code>prefetch_related</code></h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ä¹¦ç± â†’ ä½œè€…ï¼ˆFKï¼‰ + æ ‡ç­¾ï¼ˆM2Mï¼‰</span>
<span class="hljs-attr">books</span> = Book.objects.select_related(<span class="hljs-string">'author'</span>).prefetch_related(<span class="hljs-string">'tags'</span>)
</code></pre>
<hr/>
<h3 data-id="heading-13">âœ… æ–¹æ¡ˆ 4ï¼šä½¿ç”¨ <code>Prefetch</code> å¯¹è±¡ç²¾ç»†æ§åˆ¶</h3>
<pre><code class="hljs language-ini" lang="ini">from django.db.models import Prefetch

<span class="hljs-attr">books</span> = Book.objects.prefetch_related(
    Prefetch(
        'author',
        <span class="hljs-attr">queryset</span>=Author.objects.<span class="hljs-literal">on</span>ly(<span class="hljs-string">'id'</span>, <span class="hljs-string">'name'</span>)  <span class="hljs-comment"># åªå–å¿…è¦å­—æ®µ</span>
    )
)
</code></pre>
<p>é¿å…åŠ è½½å¤§å­—æ®µï¼ˆå¦‚ <code>bio</code>ã€<code>avatar</code>ï¼‰ï¼Œæå‡æ€§èƒ½ã€‚</p>
<hr/>
<h3 data-id="heading-14">âœ… æ–¹æ¡ˆ 5ï¼šåœ¨åºåˆ—åŒ–å™¨ä¸­å¤„ç†ï¼ˆDRF åœºæ™¯ï¼‰</h3>
<p>å¦‚æœä½ ç”¨ Django REST Frameworkï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># serializers.py</span>
class BookSerializer(serializers.ModelSerializer):
    <span class="hljs-attr">author</span> = AuthorSerializer()  <span class="hljs-comment"># é»˜è®¤ä¼šè§¦å‘ N+1ï¼</span>

    class Meta:
        <span class="hljs-attr">model</span> = Book
        <span class="hljs-attr">fields</span> = [<span class="hljs-string">'id'</span>, <span class="hljs-string">'title'</span>, <span class="hljs-string">'author'</span>]
</code></pre>
<p><strong>ä¿®å¤æ–¹å¼</strong>ï¼š</p>
<ul>
<li>
<p>åœ¨ ViewSet ä¸­é‡å†™ <code>get_queryset</code>ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_queryset</span>(<span class="hljs-params"><span class="hljs-variable language_">self</span></span>):
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Book</span>.objects.select_related(<span class="hljs-string">'author'</span>)
</code></pre>
</li>
<li>
<p>æˆ–ä½¿ç”¨ <code>to_representation</code> ç¼“å­˜ï¼ˆä¸æ¨èï¼‰</p>
</li>
</ul>
<blockquote>
<p>ğŸ’¡ æ›´é«˜çº§æ–¹æ¡ˆï¼šä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyezyilomo%2Fdjango-restql" target="_blank" title="https://github.com/yezyilomo/django-restql" ref="nofollow noopener noreferrer"><code>django-restql</code></a> æ”¯æŒåŠ¨æ€å­—æ®µ + è‡ªåŠ¨ä¼˜åŒ–ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-15">å››ã€é«˜çº§æŠ€å·§ä¸é™·é˜±è§„é¿</h2>
<h3 data-id="heading-16">ğŸ”¸ æŠ€å·§ 1ï¼šåªå–éœ€è¦çš„å­—æ®µï¼ˆ<code>only()</code> / <code>defer()</code>ï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ä¸è¦ SELECT *</span>
<span class="hljs-attr">books</span> = Book.objects.select_related(<span class="hljs-string">'author'</span>).<span class="hljs-literal">on</span>ly(
    'title', 'author__name'
)
</code></pre>
<p>å‡å°‘ç½‘ç»œä¼ è¾“å’Œå†…å­˜å ç”¨ã€‚</p>
<hr/>
<h3 data-id="heading-17">ğŸ”¸ æŠ€å·§ 2ï¼šé¿å…åœ¨å¾ªç¯ä¸­è§¦å‘æŸ¥è¯¢</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># âŒ å±é™©ï¼</span>
for book in Book.objects.all():
    if <span class="hljs-attr">book.author.name</span> == <span class="hljs-string">"Alice"</span>:  <span class="hljs-comment"># æ¯æ¬¡éƒ½æŸ¥ DBï¼</span>
        ...

<span class="hljs-comment"># âœ… æ­£ç¡®</span>
for book in Book.objects.select_related('author'):
    if <span class="hljs-attr">book.author.name</span> == <span class="hljs-string">"Alice"</span>:
        ...
</code></pre>
<hr/>
<h3 data-id="heading-18">ğŸ”¸ é™·é˜± 1ï¼š<code>prefetch_related</code> åä¸èƒ½å†é“¾å¼è¿‡æ»¤</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># âŒ æ— æ•ˆï¼ä¼šé‡æ–°æŸ¥è¯¢</span>
<span class="hljs-attr">books</span> = Book.objects.prefetch_related(<span class="hljs-string">'tags'</span>)
for book in books:
    book.tags.filter(<span class="hljs-attr">name</span>=<span class="hljs-string">'Python'</span>)  <span class="hljs-comment"># å¿½ç•¥ prefetchï¼Œå‘èµ·æ–°æŸ¥è¯¢ï¼</span>

<span class="hljs-comment"># âœ… æ­£ç¡®ï¼šåœ¨ Prefetch ä¸­è¿‡æ»¤</span>
<span class="hljs-attr">books</span> = Book.objects.prefetch_related(
    Prefetch('tags', <span class="hljs-attr">queryset</span>=Tag.objects.filter(name=<span class="hljs-string">'Python'</span>))
)
</code></pre>
<hr/>
<h3 data-id="heading-19">ğŸ”¸ é™·é˜± 2ï¼š<code>select_related</code> ä¸é€‚ç”¨äºåå‘å…³ç³»</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># âŒ æ— æ•ˆ</span>
Author.objects.select_related(<span class="hljs-string">'book'</span>)  <span class="hljs-comment"># Book æ˜¯åå‘ FK</span>

<span class="hljs-comment"># âœ… åº”ç”¨ prefetch_related</span>
Author.objects.prefetch_related(<span class="hljs-string">'book_set'</span>)
</code></pre>
<hr/>
<h2 data-id="heading-20">äº”ã€è‡ªåŠ¨åŒ–æ£€æµ‹å·¥å…·</h2>
<h3 data-id="heading-21">1. <strong><code>nplusone</code></strong>ï¼ˆå¼ºçƒˆæ¨èï¼ï¼‰</h3>
<p>è‡ªåŠ¨æ£€æµ‹ N+1 å¹¶æŠ›å‡ºè­¦å‘Šæˆ–å¼‚å¸¸ã€‚</p>
<p>å®‰è£…ï¼š</p>
<pre><code class="hljs">pip install nplusone
</code></pre>
<p>é…ç½® <code>settings.py</code>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">INSTALLED_APPS += <span class="hljs-section">['nplusone.ext.django']</span>
MIDDLEWARE += <span class="hljs-section">['nplusone.ext.django.NPlusOneMiddleware']</span>

<span class="hljs-attr">NPLUSONE_RAISE</span> = <span class="hljs-literal">True</span>  <span class="hljs-comment"># å¼€å‘ç¯å¢ƒç›´æ¥æŠ¥é”™</span>
</code></pre>
<blockquote>
<p>âœ… æ•ˆæœï¼šä¸€æ—¦å‡ºç° N+1ï¼Œç«‹å³æŠ›å‡º <code>NPlusOneError</code>ï¼Œå¼ºåˆ¶ä¿®å¤ï¼</p>
</blockquote>
<hr/>
<h3 data-id="heading-22">2. <strong>Django Debug Toolbar</strong></h3>
<p>å¯è§†åŒ–æŸ¥çœ‹æ‰€æœ‰ SQL æŸ¥è¯¢ï¼Œé«˜äº®é‡å¤è¯­å¥ã€‚</p>
<hr/>
<h2 data-id="heading-23">å…­ã€æ€»ç»“ï¼šæœ€ä½³å®è·µæ¸…å•</h2>





































<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ³•</th></tr></thead><tbody><tr><td><strong>æ­£å‘ ForeignKey / OneToOne</strong></td><td><code>select_related()</code></td></tr><tr><td><strong>åå‘ ForeignKey / ManyToMany</strong></td><td><code>prefetch_related()</code></td></tr><tr><td><strong>éœ€è¦è¿‡æ»¤å…³è”å¯¹è±¡</strong></td><td><code>Prefetch(queryset=...)</code></td></tr><tr><td><strong>åªå–éƒ¨åˆ†å­—æ®µ</strong></td><td>ç»“åˆ <code>only()</code></td></tr><tr><td><strong>DRF åºåˆ—åŒ–</strong></td><td>åœ¨ <code>get_queryset</code> ä¸­ä¼˜åŒ–</td></tr><tr><td><strong>å¼€å‘é˜¶æ®µ</strong></td><td>å¯ç”¨ <code>nplusone</code> + Debug Toolbar</td></tr><tr><td><strong>ç”Ÿäº§ç›‘æ§</strong></td><td>è®°å½• SQL æŸ¥è¯¢æ¬¡æ•°ï¼Œè®¾ç½®å‘Šè­¦</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ <strong>é»„é‡‘æ³•åˆ™</strong>ï¼š<br/>
<strong>â€œæ°¸è¿œä¸è¦åœ¨å¾ªç¯ä¸­è®¿é—®å…³è”å¯¹è±¡ï¼Œé™¤éä½ ç¡®å®šå®ƒå·²è¢«é¢„å–ã€‚â€</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-24">ä¸ƒã€å»¶ä¼¸é˜…è¯»</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.djangoproject.com%2Fen%2Fstable%2Ftopics%2Fdb%2Foptimization%2F" target="_blank" title="https://docs.djangoproject.com/en/stable/topics/db/optimization/" ref="nofollow noopener noreferrer">Django å®˜æ–¹æ–‡æ¡£ï¼šDatabase access optimization</a></li>
<li>ã€ŠTwo Scoops of Djangoã€‹ç¬¬ 9 ç« ï¼šQuerySets</li>
<li>GitHub: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fjmcarp%2Fnplusone" target="_blank" title="https://github.com/jmcarp/nplusone" ref="nofollow noopener noreferrer"><code>nplusone</code></a></li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ˜¥å“¥çš„Agenté€šå…³ç§˜ç±06ï¼šä½ çš„ç¬¬ä¸€æ¬¾AI æ€ç»´èŒƒå¼ReAct]]></title>    <link>https://juejin.cn/post/7603252259560521764</link>    <guid>https://juejin.cn/post/7603252259560521764</guid>    <pubDate>2026-02-05T23:36:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603252259560521764" data-draft-id="7603252259560505380" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ˜¥å“¥çš„Agenté€šå…³ç§˜ç±06ï¼šä½ çš„ç¬¬ä¸€æ¬¾AI æ€ç»´èŒƒå¼ReAct"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-02-05T23:36:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‘¸é±¼çš„æ˜¥å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/1714893870865303"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ˜¥å“¥çš„Agenté€šå…³ç§˜ç±06ï¼šä½ çš„ç¬¬ä¸€æ¬¾AI æ€ç»´èŒƒå¼ReAct
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1714893870865303/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‘¸é±¼çš„æ˜¥å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T23:36:54.000Z" title="Thu Feb 05 2026 23:36:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">06ã€ä½ çš„ç¬¬ä¸€æ¬¾AI æ€ç»´èŒƒå¼ï¼šReAct</h2>
<p>éƒ½2026å¹´äº†ï¼Œè¿˜æœ‰äººåœ¨è¯´ AI ä¸ä¼šç®—æ•°ï¼Ÿ</p>
<p>é‚£ä»–çš„çŸ¥è¯†ç»“æ„å·²ç»è½ä¼äº†ï¼</p>
<h3 data-id="heading-1">ä¸€ã€é“¾æ¥LLMå’ŒFunctionçš„æ¡¥æ¢ï¼šæ€ç»´èŒƒå¼</h3>
<p>å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„å‡ºå‚è®¾ç½®å…¶å®æ˜¯ä¸€ä¸ªâ€œæ¥é¾™æœºå™¨â€ã€‚</p>
<p>å¦‚æœä½ é—®å®ƒï¼šâ€œ23 ä¹˜ä»¥ 45 ç­‰äºå¤šå°‘ï¼Ÿâ€</p>
<p>å®ƒå¹¶ä¸æ˜¯åƒè®¡ç®—å™¨é‚£æ ·åœ¨åå°è¿ç®—ï¼Œè€Œæ˜¯æ ¹æ®æ¦‚ç‡åœ¨â€œçŒœâ€ä¸‹ä¸€ä¸ªå­—æ˜¯ä»€ä¹ˆã€‚è¿™æ›´åƒäººç±»çš„ç›´è§‰ï¼Œè¿™å¯¼è‡´å®ƒç»å¸¸ä¸€æœ¬æ­£ç»åœ°èƒ¡è¯´å…«é“ã€‚</p>
<p>è¿™å°±æ˜¯å¹»è§‰é—®é¢˜çš„æ ¹æœ¬æ‰€åœ¨ï¼Œä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¹»è§‰é—®é¢˜éš¾ä»¥è§£å†³çš„åŸå› æ‰€åœ¨ã€‚</p>
<p>æ€ç»´èŒƒå¼çš„å‡ºç°ï¼Œå°±æ˜¯ä¸ºäº†å¼ºè¡ŒæŠŠ AI çš„è¿™ç§â€œç›´è§‰â€æ‹‰å›åˆ° <strong>â€œé€»è¾‘æ¨æ¼”â€</strong> ä¸Šæ¥ã€‚</p>
<h3 data-id="heading-2">äºŒã€ä»€ä¹ˆæ˜¯ã€æ€ç»´èŒƒå¼ã€‘ï¼Ÿ</h3>
<p>æ€ç»´èŒƒå¼å°±æ˜¯ä¸€å¥—å¼ºåˆ¶æ€§çš„è§„å®šï¼Œå®ƒè§„å®šäº† AI åœ¨å›ç­”é—®é¢˜ä¹‹å‰ï¼Œå¿…é¡»éµå¾ªçš„æ€è€ƒè·¯å¾„å’Œæ ¼å¼ç»“æ„ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œæ‹’ç»AI <strong>æƒ³åˆ°å•¥è¯´å•¥</strong>ã€‚</p>
<p>å®ƒè§„å®šäº† AI åœ¨å›ç­”é—®é¢˜ä¹‹å‰ï¼Œå¿…é¡»éµå¾ªçš„æ€è€ƒè·¯å¾„å’Œæ ¼å¼ç»“æ„ï¼š</p>
<blockquote>
<p>è¾“å…¥ -&gt; ç‰¹å®šç»“æ„çš„æ€è€ƒæµç¨‹ -&gt; è¾“å‡º</p>
</blockquote>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼š</p>
<p><img src="https://pic.zhangshichun.top/pic/20260205204749058.png" alt="" loading="lazy"/></p>
<p>ä¸Šå›¾è¿™ä¸ªç¤ºæ„å›¾ï¼Œè§£é‡Šäº†ã€æ— èŒƒå¼ã€‘å’Œã€æœ‰èŒƒå¼ã€‘çš„AIï¼Œåœ¨é¢å¯¹è®¡ç®—é¢˜æ—¶çš„æ ¹æœ¬è¡Œä¸ºå·®å¼‚ã€‚</p>
<h3 data-id="heading-3">ä¸‰ã€ä¸€ä¸ªæ ‡å‡†çš„â€œæ€ç»´èŒƒå¼â€åŒ…å«ä»€ä¹ˆï¼Ÿ</h3>
<p>åœ¨ Agent å¼€å‘ä¸­ï¼Œå½“æˆ‘ä»¬è¯´æˆ‘ä»¬é‡‡ç”¨äº†ä¸€ç§èŒƒå¼ï¼ˆæ¯”å¦‚ ReActï¼‰ï¼Œæ„å‘³ç€æˆ‘ä»¬åœ¨ä»£ç å’Œæç¤ºè¯é‡Œè§„å®šäº†ä»¥ä¸‹ä¸‰ç‚¹ï¼š</p>
<ul>
<li>
<p>ç‰¹å®šçš„æ­¥éª¤ï¼ˆProcessï¼‰ï¼š è§„å®šè„‘å­æ€ä¹ˆè½¬ã€‚æ˜¯çº¿æ€§çš„ï¼ˆä¸€æ­¥æ­¥æƒ³ï¼‰ï¼Ÿè¿˜æ˜¯å¾ªç¯çš„ï¼ˆæƒ³-åš-æƒ³-åšï¼‰ï¼Ÿè¿˜æ˜¯æ ‘çŠ¶çš„ï¼ˆæƒ³å‡ºä¸‰ä¸ªæ–¹æ¡ˆé€‰ä¸€ä¸ªï¼‰ï¼Ÿ</p>
</li>
<li>
<p>ç‰¹å®šçš„å…³é”®è¯ï¼ˆKeywordsï¼‰ï¼š è§„å®šå˜´å·´æ€ä¹ˆè¯´ã€‚å¿…é¡»è¯´ Thought:ï¼Œå¿…é¡»è¯´ Action:ã€‚è¿™ä¸ä»…æ˜¯ç»™äººçœ‹çš„ï¼Œæ›´æ˜¯ä¸ºäº†æ–¹ä¾¿ç¨‹åºæŠ“å–å’Œè§£æã€‚</p>
</li>
<li>
<p>ç‰¹å®šçš„çº¦æŸï¼ˆConstraintsï¼‰ï¼š è§„å®šä»€ä¹ˆä¸èƒ½åšã€‚æ¯”å¦‚â€œåœ¨æ²¡æœ‰å¾—åˆ° Observation ä¹‹å‰ï¼Œä¸è®¸ç»™å‡º Final Answerâ€ã€‚</p>
</li>
</ul>
<p><img src="https://pic.zhangshichun.top/pic/20260205205848394.png" alt="" loading="lazy"/></p>
<p>åŸºäºä»¥ä¸Šæ¡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼š</p>
<p><strong>AI çš„â€œè„‘å›è·¯â€æ˜¯å¯ä»¥è¢«å¡‘é€ çš„ï¼Œä¸åŒçš„èŒƒå¼é€‚åˆå¹²ä¸åŒçš„æ´»ï¼š</strong></p>
<p>CoT èŒƒå¼ï¼ˆé“¾å¼æ€è€ƒï¼‰ï¼š é€‚åˆåšæ•°å­¦é¢˜ã€é€»è¾‘æ¨ç†ã€‚å¼ºè¿«å®ƒä¸€æ­¥æ­¥èµ°ï¼Œé˜²æ­¢è·³è·ƒã€‚</p>
<p>ReAct èŒƒå¼ï¼ˆååº”å¼ï¼‰ï¼š é€‚åˆå¹²æ´»ã€æŸ¥èµ„æ–™ã€‚å¼ºè¿«å®ƒåŠ¨ä¸€ä¸‹æ‰‹ã€çœ‹ä¸€çœ¼ç»“æœã€‚</p>
<p>ToT èŒƒå¼ï¼ˆæ ‘çŠ¶æ€è€ƒï¼‰ï¼š é€‚åˆå†™å°è¯´ã€æåˆ›æ„ã€‚å¼ºè¿«å®ƒå¤šæƒ³å‡ ä¸ªæ–¹æ¡ˆï¼Œé€‰æœ€å¥½çš„ã€‚</p>
<p>â€œæ€ç»´èŒƒå¼â€å°±æ˜¯æˆ‘ä»¬äººç±»ä¸ºäº†è®© AI è¿™ç§â€œæ¦‚ç‡æœºå™¨â€èƒ½å¤Ÿåƒäººä¸€æ ·ä¸¥è°¨åœ°å¤„ç†å¤æ‚ä»»åŠ¡ï¼Œè€Œå‘æ˜çš„ä¸€å¥—å¥—â€œç´§ç®å’’â€å’Œâ€œæµç¨‹å›¾â€ã€‚</p>
<h3 data-id="heading-4">å››ï¼šæ‰€ä»¥ä¸ºä»€ä¹ˆæ˜¯ ReAct</h3>
<p>åœ¨ ReAct å‡ºç°ä¹‹å‰ï¼ŒLLM ä¸»è¦é¢ä¸´ä¸¤ç§æç«¯å›°å¢ƒï¼š</p>
<ul>
<li>
<p>å…‰æƒ³ä¸åšï¼ˆçº¯æ¨ç†ï¼Œå¦‚ Chain of Thoughtï¼‰ï¼š æ¨¡å‹å¯ä»¥å†™å‡ºä¼˜ç¾çš„é€»è¾‘æ¨å¯¼ï¼Œä½†å®ƒåƒä¸ªè¢«å…³åœ¨é»‘ç›’é‡Œçš„å“²å­¦å®¶ï¼Œæ— æ³•è·å–å¤–éƒ¨ä¸–ç•Œçš„å®æ—¶ä¿¡æ¯ã€‚å®ƒä¼šä¸€æœ¬æ­£ç»åœ°å‘Šè¯‰ä½ â€œ2024å¹´çš„å¥¥è¿ä¼šå† å†›æ˜¯...â€ï¼ˆå¹»è§‰ï¼‰ï¼Œå› ä¸ºå®ƒä¸çŸ¥é“ä»Šå¤©å…¶å®æ‰2023å¹´ã€‚</p>
</li>
<li>
<p>å…‰åšä¸æƒ³ï¼ˆçº¯æ‰§è¡Œï¼‰ï¼š ç®€å•çš„è„šæœ¬å¯ä»¥è®©æ¨¡å‹è°ƒç”¨ APIï¼Œä½†å¦‚æœæ²¡æœ‰æ¨ç†è¿‡ç¨‹ï¼Œæ¨¡å‹å°±åƒæ— å¤´è‹è‡ã€‚ä¸€æ—¦ API æŠ¥é”™ï¼Œå®ƒä¸çŸ¥é“è¯¥é‡è¯•ã€ä¿®æ”¹å‚æ•°è¿˜æ˜¯æ”¾å¼ƒã€‚</p>
</li>
</ul>
<p>ReAct (Reasoning + Acting) çš„è¯ç”Ÿï¼Œå°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å®ƒçš„æ ¸å¿ƒå“²å­¦éå¸¸ç®€å•ä¸”æ·±åˆ»ï¼š</p>
<p><strong>æ¯ä¸€æ¬¡è¡ŒåŠ¨ä¹‹å‰ï¼Œéƒ½è¦å…ˆæ€è€ƒï¼›æ¯ä¸€æ¬¡è¡ŒåŠ¨ä¹‹åï¼Œéƒ½è¦è§‚å¯Ÿç»“æœã€‚</strong></p>
<h3 data-id="heading-5">äº”ã€ReAct çš„ç‰¹ç‚¹</h3>
<p>ReAct ä¸ä»…ä»…æ˜¯ä¸€ä¸ªè™šæ— ç¼¥ç¼ˆçš„â€œæ€æƒ³â€ï¼Œå®ƒåœ¨å·¥ç¨‹å®ç°ä¸Šå·²ç»å½¢æˆäº†ä¸€å¥—ä¸¥å¯†çš„æ ‡å‡†è§„èŒƒã€‚</p>
<p>åœ¨ LangChain ç­‰æ¡†æ¶ä¸­ï¼ˆä»¥ <code>hwchase17/react</code> ä¸ºä»£è¡¨ï¼‰ï¼Œå®ƒè¡¨ç°ä¸ºä¸€ä¸ªæ— é™å¾ªç¯çš„ While Loopï¼š</p>
<p>äºŒã€ æ·±åº¦è§£æ„ï¼šReAct çš„æ ‡å‡†â€œä¸‰æ­¥èˆâ€
æ­£å¦‚æˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„ï¼ŒReAct ä¸ä»…ä»…æ˜¯ä¸€ä¸ªè™šæ— ç¼¥ç¼ˆçš„â€œæ€æƒ³â€ï¼Œå®ƒåœ¨å·¥ç¨‹å®ç°ä¸Šå·²ç»å½¢æˆäº†ä¸€å¥—ä¸¥å¯†çš„æ ‡å‡†è§„èŒƒã€‚åœ¨ LangChain ç­‰æ¡†æ¶ä¸­ï¼ˆä»¥ hwchase17/react ä¸ºä»£è¡¨ï¼‰ï¼Œå®ƒè¡¨ç°ä¸ºä¸€ä¸ªæ— é™å¾ªç¯çš„ While Loopï¼š</p>
<ol>
<li>Thoughtï¼ˆæ€è€ƒï¼‰
è¿™æ˜¯æ¨¡å‹çš„â€œå†…å¿ƒç‹¬ç™½â€ã€‚æ¨¡å‹åˆ†æå½“å‰çš„æƒ…å†µï¼Œå†³å®šä¸‹ä¸€æ­¥è¯¥åšä»€ä¹ˆã€‚</li>
</ol>
<blockquote>
<p>â€œç”¨æˆ·æƒ³çŸ¥é“ç°åœ¨çš„å¤©æ°”ã€‚æˆ‘ä¸èƒ½ç›´æ¥ç¼–é€ ï¼Œæˆ‘éœ€è¦ä½¿ç”¨å¤©æ°”æŸ¥è¯¢å·¥å…·ã€‚â€</p>
</blockquote>
<ol>
<li>Actionï¼ˆè¡ŒåŠ¨ï¼‰
è¿™æ˜¯æ¨¡å‹ä¼¸å‡ºâ€œæ‰‹â€å»è§¦ç¢°ä¸–ç•Œã€‚å®ƒç”Ÿæˆç‰¹å®šçš„æ ¼å¼åŒ–ä»£ç ï¼Œå»è°ƒç”¨æœç´¢ã€æ•°æ®åº“æˆ– APIã€‚</li>
</ol>
<blockquote>
<p>è¡ŒåŠ¨: è°ƒç”¨Weather_API  å‚æ•°ï¼šåŒ—äº¬</p>
</blockquote>
<ol>
<li>Observationï¼ˆè§‚å¯Ÿï¼‰
è¿™æ˜¯ç¯å¢ƒç»™æ¨¡å‹çš„â€œåé¦ˆâ€ã€‚è¿™æ˜¯å”¯ä¸€ä¸ç”± LLM ç”Ÿæˆï¼Œè€Œæ˜¯ç”±å¤–éƒ¨ä»£ç è¿”å›çš„éƒ¨åˆ†ã€‚</li>
</ol>
<blockquote>
<p>è§‚å¯Ÿ: API è¿”å›é”™è¯¯ï¼šError 404ï¼ŒåŸå¸‚åç§°éœ€ä½¿ç”¨æ‹¼éŸ³ã€‚</p>
</blockquote>
<p>â€”â€” å¾ªç¯å›åˆ° Thought æ€è€ƒ â€”â€”</p>
<p>æ€è€ƒ: å“å‘€ï¼Œå‡ºé”™äº†ã€‚åŸæ¥éœ€è¦ç”¨æ‹¼éŸ³ã€‚é‚£æˆ‘é‡æ–°å°è¯•ä¸€ä¸‹ã€‚ &gt; è¡ŒåŠ¨: è°ƒç”¨Weather_API  å‚æ•° beijing</p>
<p>æ­£æ˜¯å› ä¸ºæœ‰äº† Observationï¼ˆè§‚å¯Ÿï¼‰ è¿™ä¸€ç¯ï¼ŒAgent æ‰æ‹¥æœ‰äº†â€œè‡ªæˆ‘çº é”™â€çš„èƒ½åŠ›ã€‚</p>
<p><img src="https://pic.zhangshichun.top/pic/20260205210658461.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">å…­ã€è®¤è¯†ä¸€ä¸‹å…¶ä»–æµè¡Œçš„ã€æ€ç»´èŒƒå¼ã€‘</h3>
<p>æŒæ¡äº† ReAct åªæ˜¯å…¥é—¨ã€‚åœ¨è§£å†³æ›´å¤æ‚çš„é—®é¢˜æ—¶ï¼ŒAI ç§‘å­¦å®¶ä»¬è¿˜å‘æ˜äº†å…¶ä»–æ€ç»´èŒƒå¼ã€‚æˆ‘ä»¬å¯ä»¥å°† ReAct ä½œä¸ºåæ ‡åŸç‚¹ï¼Œçœ‹çœ‹å…¶ä»–çš„æµæ´¾ï¼š</p>









































<table><thead><tr><th align="left">æ€ç»´èŒƒå¼</th><th align="left">æ ¸å¿ƒé€»è¾‘</th><th align="left">é€‚ç”¨åœºæ™¯</th><th align="left">ä¼˜ç¼ºç‚¹å¯¹æ¯”</th></tr></thead><tbody><tr><td align="left"><strong>CoT (Chain of Thought)</strong></td><td align="left"><strong>çº¯æ€è€ƒ</strong><br/>ä¸€æ­¥æ­¥æ¨ç† -&gt; ç­”æ¡ˆ</td><td align="left">çº¯é€»è¾‘æ•°å­¦é¢˜ã€å¸¸è¯†æ¨ç†</td><td align="left">âŒ æ— æ³•è”ç½‘ï¼Œæœ‰å¹»è§‰<br/>âœ… é€Ÿåº¦å¿«ï¼Œæ— éœ€å·¥å…·</td></tr><tr><td align="left"><strong>ReAct</strong></td><td align="left"><strong>è¾¹æƒ³è¾¹åš</strong><br/>æ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿ -&gt; å¾ªç¯</td><td align="left">èµ„æ–™æ£€ç´¢ã€API è°ƒç”¨ã€é€šç”¨åŠ©ç†</td><td align="left">âœ… å®¹é”™ç‡é«˜ï¼Œæœ€ç¨³å¥<br/>âŒ æ­¥éª¤å¤šï¼Œæ¶ˆè€— Tokenï¼Œé€Ÿåº¦æ…¢</td></tr><tr><td align="left"><strong>Plan-and-Solve (AutoGPTå¼)</strong></td><td align="left"><strong>å…ˆè®¡åˆ’ï¼Œåæ‰§è¡Œ</strong><br/>åˆ—å‡ºä»»åŠ¡æ¸…å• -&gt; é€ä¸ªå‡»ç ´</td><td align="left">å¤æ‚é•¿ä»»åŠ¡ï¼ˆå¦‚ï¼šå†™ä¸€ä¸ªæ¸¸æˆï¼‰</td><td align="left">âœ… å…¨å±€è§‚å¼ºï¼Œä¸è¿·è·¯<br/>âŒ çµæ´»æ€§å·®ï¼Œè®¡åˆ’èµ¶ä¸ä¸Šå˜åŒ–</td></tr><tr><td align="left"><strong>Reflexion</strong></td><td align="left"><strong>äº‹ååæ€</strong><br/>æ‰§è¡Œ -&gt; å¤±è´¥ -&gt; åæ€åŸå›  -&gt; é‡è¯•</td><td align="left">ç¼–å†™ä»£ç ã€é«˜éš¾åº¦è§£é¢˜</td><td align="left">âœ… è‡ªæˆ‘è¿›åŒ–èƒ½åŠ›å¼º<br/>âŒ æå…¶æ¶ˆè€— Token</td></tr><tr><td align="left"><strong>ToT (Tree of Thoughts)</strong></td><td align="left"><strong>æ€ç»´æ ‘</strong><br/>ç”Ÿæˆå¤šä¸ªæ–¹æ¡ˆ -&gt; é€‰æœ€å¥½çš„ -&gt; ç»§ç»­</td><td align="left">åˆ›æ„å†™ä½œã€è§£è°œï¼ˆ24ç‚¹æ¸¸æˆï¼‰</td><td align="left">âœ… æ¢ç´¢æ€§æœ€å¼ºï¼Œèƒ½æ‰¾åˆ°æœ€ä¼˜è§£<br/>âŒ ææ…¢ï¼Œå·¥ç¨‹å¤æ‚åº¦é«˜</td></tr></tbody></table>
<h3 data-id="heading-7">ä¸ƒã€ReAct çš„ç°çŠ¶ï¼šä»â€œæ˜¾å­¦â€åˆ°â€œæœ¬èƒ½â€</h3>
<p>æˆ‘ä»¬åœ¨å¼€å‘ä¸­ç»å¸¸æåˆ° hwchase17/react è¿™ä¸ªæç¤ºè¯æ¨¡æ¿ï¼Œå®ƒåœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…æ˜¯ Agent çš„æ ‡å‡†é…ç½®ã€‚</p>
<p>ä½†åœ¨ 2024 å¹´ä»¥åçš„æ–°æ—¶ä»£ï¼Œäº‹æƒ…å‘ç”Ÿäº†ä¸€ç‚¹å¾®å¦™çš„å˜åŒ–ï¼š</p>
<ul>
<li>
<p>å¯¹äºå¼€æº/å°æ¨¡å‹ï¼š ReAct ä¾ç„¶æ˜¯ç»å¯¹æ ‡å‡†ã€‚ä½ éœ€è¦æ˜ç¡®åœ°åœ¨ Prompt é‡Œå†™ä¸Š "Question/Thought/Action" çš„æ ¼å¼è¦æ±‚ï¼Œæ¨¡å‹æ‰èƒ½å¬æ‡‚ã€‚</p>
</li>
<li>
<p>å¯¹äºé¡¶å°–æ¨¡å‹ï¼ˆGPT-4o, Claude 3.5ï¼‰ï¼š ReAct æ­£åœ¨è¢«å†…åŒ–ã€‚é€šè¿‡ Native Function Callingï¼ˆåŸç”Ÿå‡½æ•°è°ƒç”¨ï¼‰ï¼Œæ¨¡å‹å·²ç»æŠŠâ€œæ€è€ƒ-è¡ŒåŠ¨â€çš„å¾ªç¯åˆ»åœ¨äº†æƒé‡é‡Œã€‚ä½ ä¸å†éœ€è¦å†™å¤æ‚çš„ ReAct æç¤ºè¯ï¼Œç›´æ¥ç»™å®ƒå·¥å…·ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨å±•ç°å‡ºç±»ä¼¼ ReAct çš„è¡Œä¸ºã€‚</p>
</li>
</ul>
<p>æ— è®ºæŠ€æœ¯å¦‚ä½•è¿­ä»£ï¼ŒReAct éƒ½æ˜¯ç†è§£ AI Agent è¿è¡Œæœºåˆ¶çš„â€œé’¥åŒ™â€ã€‚</p>
<p>å½“ä½ ç¬¬ä¸€æ¬¡çœ‹åˆ°æ§åˆ¶å°é‡Œæ‰“å°å‡ºï¼š Thought: æˆ‘éœ€è¦æœç´¢ä¸€ä¸‹... Observation: æœç´¢åˆ°äº†ç»“æœ... Final Answer: ç­”æ¡ˆæ˜¯...</p>
<p>é‚£ä¸€åˆ»ï¼Œä½ æ„å»ºçš„ä¸ä»…ä»…æ˜¯ä¸€æ®µä»£ç ï¼Œè€Œæ˜¯ä¸€ä¸ªæ‹¥æœ‰äº†æ„ŸçŸ¥ï¼ˆObservationï¼‰å’Œè¡ŒåŠ¨ï¼ˆActionï¼‰èƒ½åŠ›çš„åˆçº§æ•°å­—ç”Ÿå‘½ã€‚è¿™å°±æ˜¯ ReAct çš„é­…åŠ›æ‰€åœ¨ã€‚</p>
<h3 data-id="heading-8">å…«ã€å¦‚å†™å†™ä»£ç ï¼Ÿ</h3>
<p>å› ä¸ºæœ¬ç« ç¬¬ä¸ƒèŠ‚å†…å®¹çš„åŸå› ï¼Œç°åœ¨çš„ DeepSeekï¼ˆä»¥åŠ GPT-4ã€Claude 3.5ï¼‰å·²ç»æŠŠ ReAct çš„èƒ½åŠ›â€œåƒâ€è¿›äº†æ¨¡å‹å†…éƒ¨ï¼Œå˜æˆäº†æœ¬èƒ½ï¼Œä¸å†éœ€è¦ä½ ç”¨â€œè¯´æ˜ä¹¦â€ï¼ˆæç¤ºè¯ï¼‰å»æ•™å®ƒäº†ã€‚</p>
<p>è¿™ä¸ªæŠ€æœ¯å«åš Native Function Callingï¼ˆåŸç”Ÿå‡½æ•°è°ƒç”¨ï¼‰ã€‚æ¬¸ï¼Ÿå’Œæˆ‘ä»¬ä¸Šä¸€ç« çš„å†…å®¹ç»“åˆèµ·æ¥äº†ã€‚</p>
<p>åœ¨ç›®å‰ï¼Œä¸€ä¸ªæ ‡å‡†çš„ ReAct åœºæ™¯ä¸‹çš„ä¼ªä»£ç ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">run_native_agent</span>(<span class="hljs-params">query, tools_map, tools_schema</span>):
    <span class="hljs-comment"># åˆå§‹åŒ–æ¶ˆæ¯å†å²</span>
    messages = [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: query}]
    
    <span class="hljs-keyword">while</span> step &lt; max_steps:
        <span class="hljs-comment"># 1. API è°ƒç”¨ (ç›´æ¥ä¼  toolsï¼Œæ¨¡å‹å†…éƒ¨å¤„ç† ReAct é€»è¾‘)</span>
        response = client.chat.completions.create(
            model=<span class="hljs-string">"deepseek-chat"</span>,
            messages=messages,
            tools=tools_schema 
        )
        msg = response.choices[<span class="hljs-number">0</span>].message

        <span class="hljs-comment"># 2. ç»ˆæ­¢æ¡ä»¶ï¼šå¦‚æœæ²¡æœ‰å·¥å…·è°ƒç”¨è¯·æ±‚ï¼Œè¯´æ˜æ˜¯æœ€ç»ˆç­”æ¡ˆ</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> msg.tool_calls:
            <span class="hljs-keyword">return</span> msg.content 

        <span class="hljs-comment"># 3. è®°å½•æ„å›¾ï¼šå°†æ¨¡å‹ "æƒ³è°ƒå·¥å…·" çš„å†³å®šå‹å…¥å†å²</span>
        messages.append(msg)

        <span class="hljs-comment"># 4. æ‰§è¡Œä¸åé¦ˆ (Acting + Observation)</span>
        <span class="hljs-keyword">for</span> tool <span class="hljs-keyword">in</span> msg.tool_calls:
            <span class="hljs-comment"># è‡ªåŠ¨è§£æ JSON å‚æ•°</span>
            func_name = tool.function.name
            args = json.loads(tool.function.arguments)
            
            <span class="hljs-comment"># æ‰§è¡Œæœ¬åœ°ä»£ç </span>
            result = tools_map[func_name](**args)
            
            <span class="hljs-comment"># é—­ç¯ï¼šä»¥ "tool" è§’è‰²å›å¡«è§‚å¯Ÿç»“æœ</span>
            messages.append({
                <span class="hljs-string">"role"</span>: <span class="hljs-string">"tool"</span>,
                <span class="hljs-string">"tool_call_id"</span>: tool.<span class="hljs-built_in">id</span>, <span class="hljs-comment"># ID å¿…é¡»å¯¹åº”</span>
                <span class="hljs-string">"content"</span>: <span class="hljs-built_in">str</span>(result)
            })
            
        <span class="hljs-comment"># å¾ªç¯ç»§ç»­ï¼Œä¸‹ä¸€è½® API è°ƒç”¨æ—¶æ¨¡å‹å°±èƒ½çœ‹åˆ° tool çš„ç»“æœ</span>
</code></pre>
<p>å¯¹ï¼Œæ˜¯ä¸€ä¸ª <code>while</code> å¾ªç¯ï¼Œå› æ­¤ï¼ŒReActåˆæœ‰äººæŠŠå®ƒç§°ä¸ºâ€œReAct Loopâ€ã€‚</p>
<p>ä¸­æ–‡æš‚æ—¶æ²¡æœ‰ç‰¹åˆ«æƒå¨çš„å«æ³•ï¼Œæˆ‘ä¹ æƒ¯å«å®ƒï¼š</p>
<blockquote>
<p>æ€åŠ¨å¾ªç¯ã€‚</p>
</blockquote>
<h3 data-id="heading-9">ä¸‹ä¸€æ­¥é¢„å‘Š</h3>
<p>ç»è¿‡ä¸¤èŠ‚è¯¾çŸ¥è¯†çš„æ­¦è£…ï¼Œæˆ‘ä»¬å·²ç»å˜å¾—éå¸¸å¼ºå¤§ã€‚</p>
<p>ä¸‹èŠ‚è¯¾ï¼Œæˆ‘ä»¬å°†ç›´æ¥ä½¿ç”¨æœ¬èŠ‚è¯¾å’Œä¸ŠèŠ‚è¯¾å­¦åˆ°çš„çŸ¥è¯†è¿›è¡Œå®æˆ˜ï¼</p>
<p>ç›®æ ‡ï¼š</p>
<blockquote>
<p>ä¸€ä¸ªå¯ä»¥å¸®ä½ è‡ªåŠ¨è§„æ•´æ¡Œé¢çš„æ¡Œé¢å°ç§˜ä¹¦ï¼</p>
</blockquote>
<p>æ•¬è¯·æœŸå¾…ï¼</p>
<p><img src="https://pic.zhangshichun.top/pic/ScreenShot_2026-01-26_082327_821.png" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¥ä»™æ‰“æ¶ï¼Claude Opus 4.6 vs GPT-5.3-Codex åŒæ—¥å‘å¸ƒï¼ŒAI ç¼–ç¨‹æ ¼å±€è¦å˜äº†]]></title>    <link>https://juejin.cn/post/7603185231802597402</link>    <guid>https://juejin.cn/post/7603185231802597402</guid>    <pubDate>2026-02-05T21:07:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603185231802597402" data-draft-id="7603186080494501939" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¥ä»™æ‰“æ¶ï¼Claude Opus 4.6 vs GPT-5.3-Codex åŒæ—¥å‘å¸ƒï¼ŒAI ç¼–ç¨‹æ ¼å±€è¦å˜äº†"/> <meta itemprop="keywords" content="LLM,AIç¼–ç¨‹,Claude"/> <meta itemprop="datePublished" content="2026-02-05T21:07:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å­Ÿå¥AIç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/4212984287073895"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¥ä»™æ‰“æ¶ï¼Claude Opus 4.6 vs GPT-5.3-Codex åŒæ—¥å‘å¸ƒï¼ŒAI ç¼–ç¨‹æ ¼å±€è¦å˜äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4212984287073895/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å­Ÿå¥AIç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T21:07:41.000Z" title="Thu Feb 05 2026 21:07:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å­Ÿå¥ã€‚</p>
<p><strong>ä»Šå¤©ï¼ŒAI ç¼–ç¨‹å²ä¸Šæœ€ç–¯ç‹‚çš„ä¸€å¤©ã€‚</strong></p>
<p>Claude å’Œ GPT é€‰åœ¨åŒä¸€å¤©ã€åŒä¸€æ—¶åˆ»å‘å¸ƒé‡ç£…æ›´æ–°ã€‚</p>
<p>Anthropic æ”¾å‡º Opus 4.6ï¼ŒOpenAI ç´§è·Ÿç€æ‰”å‡º GPT-5.3-Codexã€‚</p>
<p>ä¸¤å®¶å…¬å¸çš„ PR å›¢é˜Ÿï¼Œæ€•æ˜¯æå‰å¯¹è¿‡è¡¨ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/56ea645a54c24aa6b12ddb85ba7528e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f5YGlQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770930460&amp;x-signature=xSDZJ9bTajXztq4kx7Dq40xP7Kk%3D" alt="" loading="lazy"/></p>
<p>ä½œä¸ºä¸€ä¸ªå¤©å¤©ç”¨ Claude Code å†™ä»£ç çš„äººï¼Œæˆ‘ç¬¬ä¸€æ—¶é—´æ‰’äº†ä¸¤è¾¹çš„æ›´æ–°ã€‚</p>
<p>ç»“è®ºå…ˆæ”¾è¿™ï¼š<strong>è¿™ä¸æ˜¯ç®€å•çš„ç‰ˆæœ¬è¿­ä»£ï¼Œæ˜¯ AI ç¼–ç¨‹ä»"åŠ©æ‰‹"åˆ°"åŒäº‹"çš„åˆ†æ°´å²­ã€‚</strong></p>
<hr/>
<h2 data-id="heading-0">01 Claude Opus 4.6ï¼šä¸‰ä¸ªæ ¸å¼¹çº§æ›´æ–°</h2>
<p>å…ˆè¯´ Anthropic è¿™è¾¹ã€‚Opus 4.6 çš„æ›´æ–°ï¼Œç”¨ä¸‰ä¸ªè¯æ¦‚æ‹¬ï¼š<strong>æ›´å¤§ã€æ›´é•¿ã€èƒ½ç»„é˜Ÿ</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3243ba05d6a48d2af0afc91131b5d29~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f5YGlQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770930460&amp;x-signature=3XX6QVpnetodphrNIqCuxbd8jG8%3D" alt="" loading="lazy"/></p>
<p><strong>ç¬¬ä¸€é¢—æ ¸å¼¹ï¼š1M token ä¸Šä¸‹æ–‡</strong></p>
<p>Opus ç»ˆäºæ”¯æŒ 100 ä¸‡ token ä¸Šä¸‹æ–‡äº†ã€‚</p>
<p>è¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿä»¥å‰ä½ è®© Claude æ”¹ä¸€ä¸ªå¤§é¡¹ç›®ï¼Œå®ƒåªèƒ½çœ‹åˆ°ä¸€å°éƒ¨åˆ†ä»£ç ï¼Œæ”¹ç€æ”¹ç€å°±"å¤±å¿†"äº†ã€‚ç°åœ¨ï¼Œæ•´ä¸ªä»£ç åº“å®ƒéƒ½èƒ½è£…è¿›è„‘å­é‡Œã€‚</p>
<p><strong>ä»¥å‰</strong>ï¼šæ”¹ä¸ªæ–‡ä»¶è¦åå¤è´´ä»£ç ã€åå¤è§£é‡Šä¸Šä¸‹æ–‡ã€‚</p>
<p><strong>ç°åœ¨</strong>ï¼šæŠŠæ•´ä¸ªé¡¹ç›®æ‰”è¿›å»ï¼Œå®ƒè‡ªå·±ç†è§£ï¼Œè‡ªå·±æ”¹ã€‚</p>
<p><strong>ç¬¬äºŒé¢—æ ¸å¼¹ï¼š128K è¾“å‡º token</strong></p>
<p>ä¸ä»…èƒ½è¯»å¾—å¤šï¼Œè¿˜èƒ½å†™å¾—é•¿ã€‚ä¸€æ¬¡æ€§è¾“å‡º 12.8 ä¸‡ tokenï¼Œç›¸å½“äºä¸€æœ¬å°ä¹¦çš„ç¯‡å¹…ã€‚</p>
<p>å†™é•¿æ–‡æ¡£ã€ç”Ÿæˆå®Œæ•´æ¨¡å—ã€ä¸€æ¬¡æ€§é‡æ„æ•´ä¸ªåŠŸèƒ½â€”â€”ä»¥å‰è¦åˆ†å¥½å‡ è½®çš„æ´»ï¼Œç°åœ¨ä¸€è½®æå®šã€‚</p>
<p><strong>ç¬¬ä¸‰é¢—æ ¸å¼¹ï¼šAgent Teams</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/48349ca73ca148549df0f88a5f3ed552~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f5YGlQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770930460&amp;x-signature=geI2f6CMBgADHp2cYNLXD6ZoebU%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸ªæ˜¯çœŸçš„ç‚¸ã€‚</p>
<p>Claude Code ç°åœ¨æ”¯æŒ<strong>å¤š Agent å›¢é˜Ÿåä½œ</strong>ã€‚ä½ å¯ä»¥è®©å¤šä¸ª Claude åŒæ—¶å¹¶è¡Œå·¥ä½œï¼šä¸€ä¸ªå®¡ä»£ç ã€ä¸€ä¸ªå†™æµ‹è¯•ã€ä¸€ä¸ªæ”¹æ–‡æ¡£ã€‚</p>
<p><strong>ä»¥å‰</strong>ï¼šä¸€ä¸ª AI å¹²æ´»ï¼Œä½ åœ¨æ—è¾¹ç­‰ã€‚</p>
<p><strong>ç°åœ¨</strong>ï¼šä¸€ç¾¤ AI åŒæ—¶å¹²æ´»ï¼Œä½ åœ¨æ—è¾¹å–å’–å•¡ã€‚</p>
<p>è¿˜æœ‰ä¸ªå½©è›‹ï¼šPowerPoint ç”ŸæˆåŠŸèƒ½è¿›å…¥é¢„è§ˆã€‚Claude èƒ½ç›´æ¥åœ¨ PPT é‡Œå·¥ä½œï¼Œè¯»æ‡‚ä½ çš„æ¨¡æ¿å’Œå“ç‰Œè§„èŒƒï¼Œæ”¹å®Œçš„ slides ä¸ä¼šä¹±äº†æ ¼å¼ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee36cc76e52042a88c2ad75779033607~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f5YGlQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770930460&amp;x-signature=GiLLRn%2FsJuVQrdYCEiX2DIia9Qk%3D" alt="" loading="lazy"/></p>
<p><strong>ä»·æ ¼å‘¢ï¼Ÿæ²¡å˜ã€‚</strong> å’Œ Opus 4.5 ä¸€æ ·ã€‚</p>
<hr/>
<h2 data-id="heading-1">02 GPT-5.3-Codexï¼šOpenAI çš„åå‡»</h2>
<p>OpenAI è¿™è¾¹ä¹Ÿä¸ç”˜ç¤ºå¼±ã€‚GPT-5.3-Codex çš„æ›´æ–°ï¼Œæ ¸å¿ƒæ˜¯ä¸¤ä¸ªå­—ï¼š<strong>æ›´å¿«ã€æ›´ç‹ </strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a0e3ad938567424aa0eb93a9bab72fe1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f5YGlQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770930460&amp;x-signature=bLNF26rGDiru4kZTj%2BIIkxTCZLQ%3D" alt="" loading="lazy"/></p>
<p><strong>25% é€Ÿåº¦æå‡</strong></p>
<p>åŒæ ·çš„ä»»åŠ¡ï¼Œè·‘å¾—æ›´å¿«ã€‚å¯¹äºé•¿ä»»åŠ¡æ¥è¯´ï¼Œ25% çš„æé€Ÿæ„å‘³ç€ä½ èƒ½åœ¨ä¸€å¤©å†…å¤šè·‘å¥½å‡ è½®è¿­ä»£ã€‚</p>
<p><strong>é¦–ä¸ª"è‡ªå·±é€ è‡ªå·±"çš„æ¨¡å‹</strong></p>
<p>è¿™ä¸ªæœ‰ç‚¹ç»†æ€ææã€‚OpenAI è¯´ï¼ŒGPT-5.3-Codex æ˜¯ä»–ä»¬ç¬¬ä¸€ä¸ª<strong>å‚ä¸åˆ›é€ è‡ªèº«</strong>çš„æ¨¡å‹â€”â€”Codex å›¢é˜Ÿç”¨ Codex æ¥è°ƒè¯•è‡ªå·±çš„è®­ç»ƒã€ç®¡ç†éƒ¨ç½²ã€è¯Šæ–­æµ‹è¯•ç»“æœã€‚</p>
<p>AI å¼€å§‹å¸®äººç±»é€  AI äº†ã€‚</p>
<p><strong>ä¸­é€”å¯è°ƒæ•´ï¼Œä¸ä¸¢ä¸Šä¸‹æ–‡</strong></p>
<p>ä»¥å‰ç”¨ Codex åšé•¿ä»»åŠ¡ï¼Œä¸­é—´æƒ³æ”¹ä¸ªæ–¹å‘å¾ˆéº»çƒ¦ï¼Œç»å¸¸è¦é‡æ–°å¼€å§‹ã€‚ç°åœ¨ä½ å¯ä»¥éšæ—¶"è½¬å‘"ï¼Œå®ƒä¸ä¼šå¿˜è®°ä¹‹å‰åšäº†ä»€ä¹ˆã€‚</p>
<p><strong>ä»»åŠ¡æ—¶é•¿çªç ´ä¸€å¤©</strong></p>
<p>OpenAI æµ‹è¯•äº†ç”¨ Codex è¿ç»­è·‘è¶…è¿‡ 24 å°æ—¶çš„é¡¹ç›®ï¼Œé€ äº†ä¸¤ä¸ªç½‘é¡µæ¸¸æˆã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥ç»™å®ƒä¸€ä¸ªå¤§æ´»ï¼Œç„¶åå»ç¡è§‰ï¼Œé†’æ¥æ´»å„¿å¹²å®Œäº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f62cf757c004c03aefbc7323a7584c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f5YGlQUnnvJbnqIs=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770930460&amp;x-signature=a%2BkvPGeOT3ES0t535b%2FtlEe%2FtRk%3D" alt="" loading="lazy"/></p>
<p><strong>ä¸æ­¢æ˜¯å†™ä»£ç </strong></p>
<p>GPT-5.3-Codex æ˜ç¡®è¯´ï¼Œå®ƒè¦†ç›–æ•´ä¸ªè½¯ä»¶ç”Ÿå‘½å‘¨æœŸï¼šè°ƒè¯•ã€éƒ¨ç½²ã€ç›‘æ§ã€å†™ PRDã€ç”¨æˆ·ç ”ç©¶ã€å†™æµ‹è¯•ã€çœ‹æ•°æ®â€¦â€¦</p>
<p><strong>ä»¥å‰</strong>ï¼šCodex æ˜¯ä¸ª"ä»£ç ç”Ÿæˆå™¨"ã€‚ <strong>ç°åœ¨</strong>ï¼šCodex æƒ³å½“ä½ çš„"æ•°å­—å‘˜å·¥"ã€‚</p>
<hr/>
<h2 data-id="heading-2">03 ä¸ºä»€ä¹ˆé€‰åœ¨åŒä¸€å¤©ï¼Ÿ</h2>
<p>ä¸¤å®¶åŒæ—¥å‘å¸ƒï¼Œç»éå·§åˆã€‚</p>
<p>GitHub åˆšå®£å¸ƒ Agent HQ å¹³å°ï¼Œè®© Copilotã€Claudeã€Codex ä¸‰å®¶åŒå°ç«æŠ€ã€‚å¼€å‘è€…å¯ä»¥åœ¨ GitHub é‡Œè‡ªç”±åˆ‡æ¢ä¸åŒçš„ AI ç¼–ç¨‹åŠ©æ‰‹ã€‚</p>
<p><strong>è¿™æ˜¯ä¸€åœº"è´§æ¶äº‰å¤ºæˆ˜"ã€‚</strong></p>
<p>ä»¥å‰ï¼Œä½ ç”¨ Cursor å°±ç»‘å®šäº† Claudeï¼Œç”¨ Copilot å°±ç»‘å®šäº† GPTã€‚ç°åœ¨ GitHub æŠŠè´§æ¶æ‰“å¼€äº†ï¼Œä¸‰å®¶äº§å“æ‘†åœ¨ä¸€èµ·ï¼Œç”¨æˆ·è‡ªå·±æŒ‘ã€‚</p>
<p>è°çš„äº§å“æ›´å¼ºï¼Œè°å°±èƒ½æŠ¢åˆ°æ›´å¤šç”¨æˆ·ã€‚æ‰€ä»¥ä¸¤å®¶å¿…é¡»åœ¨åŒä¸€å¤©äº®å‰‘ã€‚</p>
<hr/>
<h2 data-id="heading-3">04 æˆ‘çš„åˆ¤æ–­ï¼šè¯¥ç«™é˜Ÿå—ï¼Ÿ</h2>
<p>è¯´å®è¯ï¼Œ<strong>ä¸ç”¨ç«™é˜Ÿ</strong>ã€‚</p>
<p>è¿™è½®æ›´æ–°ä¹‹åï¼ŒClaude å’Œ GPT åœ¨ AI ç¼–ç¨‹ä¸Šçš„å·®è·è¿›ä¸€æ­¥ç¼©å°ã€‚ä¸¤è¾¹éƒ½åœ¨å¾€"è‡ªä¸» Agent"çš„æ–¹å‘å·ï¼šæ›´é•¿çš„ä¸Šä¸‹æ–‡ã€æ›´å¼ºçš„è§„åˆ’èƒ½åŠ›ã€æ›´å°‘çš„äººå·¥å¹²é¢„ã€‚</p>
<p><strong>å¦‚æœä½ æ˜¯ Claude Code ç”¨æˆ·</strong>ï¼šç»§ç»­ç”¨ã€‚Agent Teams + 1M ä¸Šä¸‹æ–‡ï¼Œå¯¹å¤§é¡¹ç›®çš„ä½“éªŒæå‡æ˜¯è´¨å˜çº§çš„ã€‚</p>
<p><strong>å¦‚æœä½ æ˜¯ Codex ç”¨æˆ·</strong>ï¼šç»§ç»­ç”¨ã€‚25% æé€Ÿ + è¶…é•¿ä»»åŠ¡æ”¯æŒï¼Œåšäº§å“åŸå‹ä¼šæ›´çˆ½ã€‚</p>
<p><strong>å¦‚æœä½ ä¸¤è¾¹éƒ½æ²¡æ·±åº¦ç”¨è¿‡</strong>ï¼šç°åœ¨æ˜¯æœ€å¥½çš„å…¥åœºæ—¶æœºã€‚GitHub Agent HQ è®©ä½ å¯ä»¥é›¶æˆæœ¬åˆ‡æ¢ï¼Œå“ªä¸ªé¡ºæ‰‹ç”¨å“ªä¸ªã€‚</p>
<p>æˆ‘è‡ªå·±çš„é€‰æ‹©ï¼Ÿ<strong>ä¸»åŠ›è¿˜æ˜¯ Claude Codeï¼Œä½† Codex ä¼šä½œä¸ºç¬¬äºŒé€‰é¡¹ã€‚</strong></p>
<p>åŸå› å¾ˆç®€å•ï¼šClaude çš„"æ€ç»´é“¾"æ›´é€æ˜ï¼Œæ”¹ä»£ç çš„æ—¶å€™æˆ‘èƒ½çœ‹æ‡‚å®ƒåœ¨æƒ³ä»€ä¹ˆã€‚Codex çš„é€Ÿåº¦ä¼˜åŠ¿åœ¨çŸ­ä»»åŠ¡ä¸Šæ„ŸçŸ¥ä¸æ˜æ˜¾ï¼Œä½†åšè¶…é•¿ä»»åŠ¡æ—¶ä¼šè€ƒè™‘åˆ‡è¿‡å»ã€‚</p>
<hr/>
<h2 data-id="heading-4">05 ä¸€ä¸ªæ›´å¤§çš„ä¿¡å·</h2>
<p>ä»Šå¤©è¿™åœºç¥ä»™æ‰“æ¶ï¼ŒçœŸæ­£çš„ä¿¡å·ä¸æ˜¯"è°æ›´å¼º"ã€‚</p>
<p>è€Œæ˜¯ï¼š<strong>AI ç¼–ç¨‹æ­£å¼è¿›å…¥"å¤š Agent åä½œ"æ—¶ä»£ã€‚</strong></p>
<p>Claude çš„ Agent Teamsã€Codex çš„è‡ªæˆ‘è¿­ä»£ã€GitHub çš„å¤š Agent å¹³å°â€”â€”æ‰€æœ‰è¿¹è±¡éƒ½æŒ‡å‘åŒä¸€ä¸ªæ–¹å‘ï¼šæœªæ¥çš„è½¯ä»¶å¼€å‘ï¼Œä¸æ˜¯"ä¸€ä¸ªç¨‹åºå‘˜ + ä¸€ä¸ª AI åŠ©æ‰‹"ï¼Œè€Œæ˜¯"ä¸€ä¸ªç¨‹åºå‘˜ + ä¸€ç¾¤ AI åŒäº‹"ã€‚</p>
<p>ä½ è¦ç®¡ç†çš„ä¸å†æ˜¯ä»£ç ï¼Œè€Œæ˜¯ Agentã€‚</p>
<p><strong>ä»¥å‰</strong>ï¼šä½ æ˜¯å·¥ç¨‹å¸ˆã€‚</p>
<p><strong>ç°åœ¨</strong>ï¼šä½ æ˜¯ AI å›¢é˜Ÿçš„ Tech Leadã€‚</p>
<p>è¿™ä¸ªè½¬å˜ï¼Œæ¯”ä»»ä½•ä¸€æ¬¡æ¡†æ¶æ›´è¿­éƒ½è¦å‰§çƒˆã€‚</p>
<hr/>
<h2 data-id="heading-5">å†™åœ¨æœ€å</h2>
<p>æœ‰äººé—®æˆ‘ï¼ŒAI ç¼–ç¨‹å·¥å…·è¿™ä¹ˆå·ï¼Œç¨‹åºå‘˜ä¼šä¸ä¼šè¢«æ›¿ä»£ï¼Ÿ</p>
<p>æˆ‘çš„çœ‹æ³•æ˜¯ï¼š<strong>å·¥å…·è¶Šå¼ºï¼Œä¼šç”¨å·¥å…·çš„äººè¶Šå€¼é’±ã€‚</strong></p>
<p>ä»Šå¤© Claude å’Œ GPT çš„æ›´æ–°ï¼Œæœ¬è´¨ä¸Šæ˜¯åœ¨é™ä½"æŠŠæƒ³æ³•å˜æˆäº§å“"çš„é—¨æ§›ã€‚ä½†"æœ‰å¥½æƒ³æ³•"è¿™ä»¶äº‹ï¼Œé—¨æ§›åè€Œåœ¨æé«˜â€”â€”å› ä¸ºç«äº‰è€…éƒ½åœ¨ç”¨åŒæ ·çš„å·¥å…·ã€‚</p>
<p><strong>AI ä¼šæ›¿ä»£ä¸ç”¨ AI çš„ç¨‹åºå‘˜ã€‚</strong></p>
<p>è¿™å¥è¯æˆ‘è¯´äº†å¾ˆå¤šæ¬¡ï¼Œä»Šå¤©å†è¯´ä¸€æ¬¡ã€‚å·¥å…·å°±æ‘†åœ¨è¿™é‡Œã€‚ç”¨ä¸ç”¨ï¼Œæ˜¯ä½ çš„äº‹ã€‚</p>
<hr/>
<p>å¦‚æœè¿™ç¯‡å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—ã€å…³æ³¨ï¼Œä½ çš„æ”¯æŒæ˜¯æˆ‘æŒç»­è¾“å‡ºçš„åŠ¨åŠ› âœ¨</p>
<hr/>
<p>æˆ‘çš„å…¶ä»–å¹³å°è´¦å·å’Œå¼€æºé¡¹ç›®åœ¨ä¸ªäººä¸»é¡µä¸­ï¼Œæ¬¢è¿äº¤æµ ğŸ¤</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenClawæ¼æ´å…è®¸é€šè¿‡æ¶æ„é“¾æ¥ä¸€é”®è¿œç¨‹æ‰§è¡Œä»£ç ]]></title>    <link>https://juejin.cn/post/7603215839582175242</link>    <guid>https://juejin.cn/post/7603215839582175242</guid>    <pubDate>2026-02-05T21:15:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603215839582175242" data-draft-id="7603215839582158858" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenClawæ¼æ´å…è®¸é€šè¿‡æ¶æ„é“¾æ¥ä¸€é”®è¿œç¨‹æ‰§è¡Œä»£ç "/> <meta itemprop="keywords" content="AIGC,OpenAI"/> <meta itemprop="datePublished" content="2026-02-05T21:15:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Dcs"/> <meta itemprop="url" content="https://juejin.cn/user/3679404422861902"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenClawæ¼æ´å…è®¸é€šè¿‡æ¶æ„é“¾æ¥ä¸€é”®è¿œç¨‹æ‰§è¡Œä»£ç 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3679404422861902/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Dcs
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T21:15:01.000Z" title="Thu Feb 05 2026 21:15:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¾ˆå¤šäººç”¨ OpenClawï¼ˆæ›¾ç”¨å Moltbot/Clawdbotï¼‰æ˜¯å†²ç€å®ƒé‚£å¥éšå«æ‰¿è¯ºï¼š<strong>â€œæœ¬åœ°ä¼˜å…ˆï¼Œæ•°æ®åœ¨è‡ªå·±æœºå™¨ä¸Šï¼Œæ›´å®‰å…¨ã€‚â€</strong></p>
<p>ä½†è¿™æ¬¡äº‹ä»¶éœ€è¦ä½ å†<strong>æ³¨é‡æ³¨é‡</strong>å®‰å…¨äº†ï¼šå“ªæ€•ä½ çš„ç½‘å…³åªç›‘å¬åœ¨å›ç¯åœ°å€ï¼ˆä¹Ÿå°±æ˜¯â€œåªåœ¨æœ¬æœºç”¨â€ï¼‰ï¼Œåªè¦ç”¨æˆ·<strong>ç‚¹å¼€ä¸€ä¸ªé“¾æ¥</strong>ï¼Œæ”»å‡»é“¾å°±å¯èƒ½ä»æµè§ˆå™¨é‡Œâ€œå€Ÿé“â€ï¼ŒæŠŠä½ çš„æ§åˆ¶æƒé€å‡ºå»ã€‚</p>
<p>è¿™ä¸æ˜¯ç„å­¦ï¼Œæ˜¯å®˜æ–¹å®‰å…¨å…¬å‘Šé‡Œå†™å¾—å¾ˆç›´ç™½çš„ä¸€æ¡é«˜å±æ¼æ´ï¼š<strong>â€œ1-Click RCE via Authentication Token Exfiltration From gatewayUrlâ€</strong>ï¼Œå½±å“ç‰ˆæœ¬ <strong>&lt;= v2026.1.28</strong>ï¼Œä¿®å¤ç‰ˆæœ¬æ˜¯ <strong>v2026.1.29</strong>ã€‚</p>
<p>å®˜æ–¹å…¬å‘Šï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenclaw%2Fopenclaw%2Fsecurity%2Fadvisories%2FGHSA-g8p2-7wf7-98mq" target="_blank" title="https://github.com/openclaw/openclaw/security/advisories/GHSA-g8p2-7wf7-98mq" ref="nofollow noopener noreferrer">github.com/openclaw/opâ€¦</a></p>
<h2 data-id="heading-0"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb56c8b1c12d420b87b737c4fe6dd4eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRGNz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770930900&amp;x-signature=JBhI6AIhqrQYGncJgQcpL6menZM%3D" alt="image.png" loading="lazy"/></h2>
<h2 data-id="heading-1">è¿™æ¬¡åˆ°åº•ç‚¸åœ¨å“ªï¼Ÿ</h2>
<p>æŠŠâ€œé…ç½®å…¥å£â€åšæˆäº†â€œè‡ªåŠ¨è¿æ¥å¼€å…³â€</p>
<p>æ§åˆ¶å°ï¼ˆControl UIï¼‰åšäº†ä¸¤ä»¶çœ‹èµ·æ¥å¾ˆâ€œè´´å¿ƒâ€çš„äº‹ï¼š</p>
<ol>
<li><strong>ä¿¡ä»» URL ä¸Šçš„ <code>gatewayUrl</code> å‚æ•°</strong>ï¼ˆæ¥è‡ª query stringï¼‰ï¼Œ</li>
<li>é¡µé¢åŠ è½½æ—¶<strong>è‡ªåŠ¨è¿æ¥</strong>åˆ°è¿™ä¸ªåœ°å€ï¼Œå¹¶ä¸”æŠŠæœ¬åœ°ä¿å­˜çš„ç½‘å…³ token æ”¾è¿› WebSocket çš„ connect payload é‡Œå‘å‡ºå»ã€‚</li>
</ol>
<p>äºæ˜¯é£é™©å°±å˜æˆäº†ï¼š</p>
<blockquote>
<p>ç”¨æˆ·åªè¦ç‚¹äº†ä¸€ä¸ªè¢«æ„é€ è¿‡çš„é“¾æ¥ï¼ˆæˆ–è®¿é—®äº†ä¼šè·³è½¬çš„é¡µé¢ï¼‰ï¼Œtoken å°±å¯èƒ½è¢«é€åˆ°æ”»å‡»è€…æ§åˆ¶çš„æœåŠ¡å™¨ã€‚</p>
</blockquote>
<p>è€Œ token ä¸€æ—¦æ³„éœ²ï¼Œæ”»å‡»è€…æ‹¿åˆ°çš„ä¸æ˜¯â€œçœ‹ä½ èŠå¤©è®°å½•â€è¿™ä¹ˆç®€å•â€”â€”å…¬å‘Šé‡Œç›´æ¥è¯´ï¼Œæ”»å‡»è€…èƒ½è¿è¿›å—å®³è€…æœ¬åœ° gatewayï¼Œä¿®æ”¹é…ç½®ï¼ˆåŒ…æ‹¬ sandboxã€å·¥å…·ç­–ç•¥ï¼‰o(ï¿£â–½ï¿£)ï½„ï¼Œå†è°ƒç”¨é«˜æƒé™åŠ¨ä½œï¼Œæœ€ç»ˆè¾¾æˆ <strong>1-Click RCE</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-2">â€œæˆ‘åªè·‘åœ¨ localhostï¼Œä¸ºå•¥ä¹Ÿèƒ½æŒ¨æï¼Ÿ</h2>
<p>å¾ˆå¤šäººå¯¹â€œæœ¬åœ°æœåŠ¡â€çš„å®‰å…¨ç›´è§‰æ˜¯ï¼šå¤–ç½‘è®¿é—®ä¸äº†ï¼Œé‚£å°±å®‰å…¨ã€‚</p>
<p>ä½†è¿™æ¡é“¾è·¯çš„å…³é”®ç‚¹æ˜¯ï¼š<strong>å¤–ç½‘ä¸éœ€è¦ç›´æ¥è®¿é—®ä½ çš„ localhostï¼Œåªè¦èƒ½è®©â€œä½ çš„æµè§ˆå™¨â€å»è®¿é—®å³å¯ã€‚</strong></p>
<p>å®‰å…¨å…¬å‘Šé‡Œç‚¹å¾—å¾ˆæ¸…æ¥šï¼šå³ä½¿ gateway åªç»‘å®šåœ¨ loopbackï¼Œä¸Šè¿°æ”»å‡»ä¾ç„¶èƒ½æˆç«‹ï¼Œå› ä¸º<strong>å—å®³è€…çš„æµè§ˆå™¨ä¼šå‘èµ·å¯¹å¤–è¿æ¥ï¼Œå……å½“æ¡¥æ¢</strong>ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆç°åœ¨è¶Šæ¥è¶Šå¤šçš„å®‰å…¨é—®é¢˜ä¸å†æ˜¯â€œç«¯å£å¼€æ²¡å¼€â€ï¼Œè€Œæ˜¯â€œå‰ç«¯/æ§åˆ¶å°èƒ½ä¸èƒ½è¢«è¯±å¯¼æ‰§è¡ŒæŸäº›ç½‘ç»œåŠ¨ä½œâ€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a9b38d49ddfd43a593786a540a8b6e52~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRGNz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770930900&amp;x-signature=Cs3wzEUGvHuA%2B0vexo6SuVsFS2E%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-3">ä¿®å¤æ–¹æ¡ˆ</h2>
<p>æ ¹å› æ˜¯ <strong>â€œç¼ºå°‘ <code>gatewayUrl</code> æ ¡éªŒ + é¡µé¢è‡ªåŠ¨è¿æ¥â€</strong> çš„ç»„åˆã€‚</p>
<p>ä¿®å¤ç­–ç•¥ä¹Ÿå¾ˆç›´æ¥ï¼š<strong>å½“ UI æ£€æµ‹åˆ°æ–°çš„ gateway åœ°å€æ—¶ï¼Œè¦æ±‚ç”¨æˆ·ç¡®è®¤</strong>ï¼Œä¸å†â€œæ‚„æ‚„è‡ªåŠ¨è¿â€ã€‚</p>
<p>é¡ºå¸¦ä¸€æï¼ŒOpenClaw è‡ªå·±çš„ Security Policy ä¹Ÿå†™äº†è­¦å‘Šï¼šWeb ç•Œé¢æ˜¯ç»™æœ¬åœ°ç”¨çš„ï¼Œåˆ«ç»‘åˆ°å…¬ç½‘ï¼Œå®ƒå¹¶æ²¡æœ‰æŒ‰å…¬ç½‘æš´éœ²å»åšç¡¬åŒ–ã€‚</p>
<hr/>
<h2 data-id="heading-4">ä½ ç°åœ¨è¯¥åšä»€ä¹ˆï¼Ÿ</h2>
<p><strong>å¦‚æœä½ æ˜¯ç”¨æˆ·ï¼ˆè‡ªæ‰˜ç®¡/æœ¬åœ°è·‘ï¼‰ï¼š</strong></p>
<ul>
<li>ç«‹åˆ»å‡çº§åˆ° <strong>v2026.1.29 æˆ–æ›´é«˜</strong>ï¼ˆ&lt;= v2026.1.28 éƒ½åœ¨å½±å“èŒƒå›´å†…ï¼‰ã€‚</li>
<li><strong>è½®æ¢/é‡ç½® gateway token</strong>ï¼ˆå…¬å‘Šå®šä¹‰æœ¬è´¨æ˜¯ token å¤–æ³„é£é™©ï¼‰ã€‚</li>
<li>ä¸è¦æŠŠ Control UI æš´éœ²åˆ°å…¬ç½‘ï¼ˆå“ªæ€•ä½ è§‰å¾—â€œæˆ‘åŠ äº† token å°±è¡Œâ€ï¼‰ã€‚</li>
<li>å¯¹â€œçœ‹ä¼¼æ— å®³çš„é“¾æ¥â€ä¿æŒè­¦æƒ•ï¼šè¿™ç§æ¼æ´æœ€åƒâ€œç‚¹ä¸€ä¸‹â€ã€‚</li>
</ul>
<p><strong>å¦‚æœä½ æ˜¯åšç±»ä¼¼äº§å“çš„å¼€å‘è€…ï¼š</strong></p>
<ul>
<li>ä»»ä½•èƒ½ä» URL/å‰ªè´´æ¿/æ·±é“¾å†™å…¥é…ç½®çš„å…¥å£ï¼Œéƒ½æŒ‰â€œå¤–éƒ¨è¾“å…¥â€å¤„ç†</li>
<li><strong>æ•æ„Ÿ token æ°¸è¿œåˆ«è·Ÿç€â€œè‡ªåŠ¨è¿æ¥â€ä¸€èµ·å‘</strong>ï¼ˆå°¤å…¶æ˜¯é¦–æ¬¡è¿æ¥/åœ°å€å˜æ›´æ—¶ï¼‰</li>
<li>æµè§ˆå™¨ç«¯åš allowlist/confirmï¼›æœåŠ¡ç«¯ä¹Ÿè¦åš origin/é‰´æƒ/æœ€å°æƒé™</li>
</ul>
<hr/>
<h2 data-id="heading-5">ç»™å·¥ç¨‹å¸ˆçš„â€œæ€ä¹ˆå†™æ‰ä¸è¸©å‘â€ç¤ºä¾‹ï¼ˆé˜²å¾¡æ€§ï¼‰</h2>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªâ€œæœ€ä½é…ä½†ç®¡ç”¨â€çš„æ€è·¯ï¼š<strong>åªå…è®¸ <code>wss://</code> + å›ºå®šåŸŸåç™½åå•</strong>ï¼Œå…¶ä½™ä¸€å¾‹å¼¹çª—ç¡®è®¤æˆ–æ‹’ç»ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// åªç¤ºæ„é˜²å¾¡æ€è·¯ï¼šä¸¥æ ¼æ ¡éªŒ + æ˜¾å¼ç¡®è®¤</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">sanitizeGatewayUrl</span>(<span class="hljs-params">raw: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span> {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> u = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(raw);

    <span class="hljs-comment">// 1) å¼ºåˆ¶ wss</span>
    <span class="hljs-keyword">if</span> (u.<span class="hljs-property">protocol</span> !== <span class="hljs-string">"wss:"</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

    <span class="hljs-comment">// 2) åŸŸåç™½åå•ï¼ˆç¤ºä¾‹ï¼‰</span>
    <span class="hljs-keyword">const</span> allowedHosts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-string">"gateway.example.com"</span>, <span class="hljs-string">"corp-gw.example.com"</span>]);
    <span class="hljs-keyword">if</span> (!allowedHosts.<span class="hljs-title function_">has</span>(u.<span class="hljs-property">hostname</span>)) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

    <span class="hljs-comment">// 3) å¯é€‰ï¼šå›ºå®šç«¯å£/è·¯å¾„</span>
    <span class="hljs-keyword">return</span> u.<span class="hljs-title function_">toString</span>();
  } <span class="hljs-keyword">catch</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
}

<span class="hljs-comment">// åœ°å€å˜æ›´æ—¶ï¼šå¿…é¡»ç”¨æˆ·ç¡®è®¤</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">onGatewayUrlFromQuery</span>(<span class="hljs-params">raw: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-keyword">const</span> safe = <span class="hljs-title function_">sanitizeGatewayUrl</span>(raw);
  <span class="hljs-keyword">if</span> (!safe) <span class="hljs-keyword">return</span>;

  <span class="hljs-keyword">const</span> ok = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">confirm</span>(<span class="hljs-string">`Connect to new gateway?\n<span class="hljs-subst">${safe}</span>`</span>);
  <span class="hljs-keyword">if</span> (!ok) <span class="hljs-keyword">return</span>;

  <span class="hljs-comment">// å†æ‰§è¡Œä¿å­˜/è¿æ¥</span>
  <span class="hljs-comment">// saveSettings({ gatewayUrl: safe }); connectGateway(safe);</span>
}
</code></pre>
<p>è¿™æ®µä»£ç æ ¸å¿ƒåŸåˆ™ï¼š<strong>æŠŠâ€œéšå¼è‡ªåŠ¨è¡Œä¸ºâ€æ”¹æˆâ€œæ˜¾å¼ç”¨æˆ·å†³ç­–â€ã€‚</strong>
å¾ˆå¤š 1-click äº‹æ•…ï¼Œå°±æ˜¯ä»â€œå¸®ç”¨æˆ·çœä¸€æ­¥â€å¼€å§‹çš„ã€‚</p>
<hr/>
<h2 data-id="heading-6">ç»“è¯­</h2>
<p>OpenClaw è¿™ç±»â€œèƒ½æ›¿ä½ å¹²æ´»â€çš„ agentï¼Œæœ¬è´¨ä¸Šæ¡ç€ä½ çš„æ¶ˆæ¯æ¸ é“ã€æ–‡ä»¶ã€API keyã€ç”šè‡³æœ¬æœºå‘½ä»¤æ‰§è¡Œèƒ½åŠ›ã€‚æƒé™è¶Šå¤§ï¼Œå®‰å…¨è¾¹ç•Œå°±è¶Šä¸èƒ½æ¨¡ç³Šã€‚</p>
<p>è¿™æ¬¡çš„æ•™è®­å…¶å®å¾ˆç»Ÿä¸€ï¼š</p>
<ul>
<li><strong>ä¸è¦ä¿¡ä»»æ¥è‡ª URL çš„é…ç½®</strong></li>
<li><strong>ä¸è¦åœ¨é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨å¸¦ token è¿æ¥é™Œç”Ÿç«¯ç‚¹</strong></li>
<li><strong>ä¸è¦æŠŠâ€œæœ¬åœ°ç›‘å¬â€å½“æˆå®‰å…¨æŠ¤èº«ç¬¦</strong></li>
</ul>
<p>çœŸæ­£çš„å®‰å…¨ï¼Œä¸æ˜¯â€œé»˜è®¤æ²¡äº‹â€ï¼Œè€Œæ˜¯â€œé»˜è®¤ä¸åšå±é™©åŠ¨ä½œâ€ï¼Œå—¯ã€‚ã€‚ã€‚æ¢å¥è¯è¯´ï¼šå®æ„¿ä¸åšï¼Œä¹Ÿä¸è¦çŠ¯é”™ï¼</p>
<hr/>
<p><strong>å–œæ¬¢å°±å¥–åŠ±ä¸€ä¸ªâ€œğŸ‘â€å’Œâ€œåœ¨çœ‹â€å‘—~</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/901baa5adb5441b388f90e0cf93b2ae9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRGNz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770930900&amp;x-signature=qCJUGDhhgt0B%2FPn%2BIFXHu1jahfI%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¯»ä¹¦åˆ†äº«ï½œä¸¤æœ¬è®©äº§å“ç»ç†é†é†çŒé¡¶çš„å¥½ä¹¦]]></title>    <link>https://juejin.cn/post/7603186080494387251</link>    <guid>https://juejin.cn/post/7603186080494387251</guid>    <pubDate>2026-02-05T16:54:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603186080494387251" data-draft-id="7603215839582060554" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¯»ä¹¦åˆ†äº«ï½œä¸¤æœ¬è®©äº§å“ç»ç†é†é†çŒé¡¶çš„å¥½ä¹¦"/> <meta itemprop="keywords" content="äº§å“ç»ç†"/> <meta itemprop="datePublished" content="2026-02-05T16:54:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é™†ä¸šèª"/> <meta itemprop="url" content="https://juejin.cn/user/13629904404157"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¯»ä¹¦åˆ†äº«ï½œä¸¤æœ¬è®©äº§å“ç»ç†é†é†çŒé¡¶çš„å¥½ä¹¦
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/13629904404157/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é™†ä¸šèª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T16:54:02.000Z" title="Thu Feb 05 2026 16:54:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘æœ‰æœ‹å‹é—®æˆ‘æœ‰ä»€ä¹ˆä¹¦æ¨èï¼Œæƒ³äº†æƒ³ï¼Œè¿™ä¸¤æœ¬æ˜¯æˆ‘ä»Šå¹´è¯»è¿‡æœ€æƒ³å®‰åˆ©ç»™åˆ«äººçš„â€”â€”ã€Šæ´è§ã€‹å’Œã€Šé±¼ä¸å­˜åœ¨ã€‹ã€‚</p>
<p>æ®è¯´è¿™ä¸¤æœ¬ä¹Ÿæ˜¯äº’è”ç½‘åœˆä¸å°‘äº§å“å¤§ä½¬çš„ç§è—ä¹¦å•ã€‚è¯»å®Œä¹‹åæˆ‘ç®—æ˜¯æ˜ç™½ä¸ºä»€ä¹ˆäº†â€”â€”<strong>åšäº§å“åšä¹…äº†ï¼Œæœ€å®¹æ˜“é™·å…¥çš„é™·é˜±å°±æ˜¯"æˆ‘æ‡‚ç”¨æˆ·"å’Œ"æˆ‘çš„åˆ†ç±»æ¡†æ¶æ˜¯å¯¹çš„"è¿™ä¸¤ç§å¹»è§‰</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-0">ã€Šæ´è§ã€‹ï¼šä½›å­¦çš„ç§‘å­¦æ‰“å¼€æ–¹å¼</h2>
<p>åˆ«è¢«"ä½›å­¦"ä¸¤ä¸ªå­—å“è·‘ã€‚</p>
<p>è¿™æœ¬ä¹¦çš„ä½œè€…ç½—ä¼¯ç‰¹Â·èµ–ç‰¹æ˜¯è¿›åŒ–å¿ƒç†å­¦å®¶ï¼Œä»–å¹²äº†ä¸€ä»¶å¾ˆæœ‰æ„æ€çš„äº‹æƒ…â€”â€”ç”¨ç°ä»£è¿›åŒ–å¿ƒç†å­¦å’Œç¥ç»ç§‘å­¦çš„è§†è§’ï¼Œå»é‡æ–°å®¡è§†ä½›å­¦é‡Œçš„é‚£äº›æ ¸å¿ƒæ¦‚å¿µã€‚</p>
<p>æ¯”å¦‚"æ— æˆ‘"è¿™ä¸ªæ¦‚å¿µï¼Œå¬èµ·æ¥å¾ˆç„ä¹å¯¹å§ï¼Ÿ</p>
<p>ä½œè€…è¯´ï¼Œå…¶å®ä»è¿›åŒ–å¿ƒç†å­¦è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬æ‰€è°“çš„"è‡ªæˆ‘"æœ¬æ¥å°±æ˜¯ä¸€å †æ¨¡å—åŒ–çš„å¿ƒç†æœºåˆ¶æ‹¼å‡‘å‡ºæ¥çš„å¹»è§‰ã€‚ä½ ä»¥ä¸ºæ˜¯"ä½ "åœ¨åšå†³å®šï¼Œå®é™…ä¸Šå¯èƒ½åªæ˜¯æŸä¸ªæƒ…ç»ªæ¨¡å—åœ¨é‚£ä¸€åˆ»å äº†ä¸Šé£è€Œå·²ã€‚</p>
<p><strong>åšäº§å“çš„æœ‹å‹ä»¬ï¼Œæœ‰æ²¡æœ‰è§‰å¾—è¿™ä¸ªæè¿°ç‰¹åˆ«çœ¼ç†Ÿï¼Ÿ</strong></p>
<p>æˆ‘ä»¬å¤©å¤©æŒ‚åœ¨å˜´è¾¹çš„"ç”¨æˆ·å¿ƒæ™º"ã€"ç”¨æˆ·å†³ç­–è·¯å¾„"ï¼Œè¯´ç™½äº†ä¸ä¹Ÿæ˜¯è¿™ä¹ˆå›äº‹å—ï¼Ÿç”¨æˆ·ä»¥ä¸ºè‡ªå·±åœ¨"ç†æ€§é€‰æ‹©"ï¼Œå®é™…ä¸Šå¤§éƒ¨åˆ†æ—¶å€™åªæ˜¯è¢«æŸä¸ªæƒ…ç»ªã€æŸä¸ªåœºæ™¯ã€æŸä¸ªç¬é—´çš„æ„Ÿè§‰æ¨ç€èµ°ã€‚é‚£äº›æ‰€è°“çš„"ç”¨æˆ·è°ƒç ”ç»“è®º"ï¼Œæœ‰å¤šå°‘æ˜¯ç”¨æˆ·çœŸå®æƒ³æ³•ï¼Œåˆæœ‰å¤šå°‘æ˜¯ç”¨æˆ·"ä»¥ä¸ºè‡ªå·±çš„æƒ³æ³•"ï¼Ÿ</p>
<p>ä¹¦é‡Œè¿˜è®²åˆ°ï¼Œæˆ‘ä»¬çš„å¤§è„‘æ˜¯è‡ªç„¶é€‰æ‹©è®¾è®¡å‡ºæ¥è®©æˆ‘ä»¬"å­˜æ´»å’Œç¹è¡"çš„ï¼Œä½†ä¸æ˜¯è®©æˆ‘ä»¬"å¿«ä¹"çš„ã€‚é‚£äº›ç„¦è™‘ã€è´ªå©ªã€æ°¸ä¸æ»¡è¶³çš„æ„Ÿè§‰ï¼Œéƒ½æ˜¯è¿›åŒ–ç•™ä¸‹æ¥çš„"bug"ã€‚</p>
<p><strong>è¿™ä¸å°±æ˜¯äº§å“è®¾è®¡çš„åº•å±‚é€»è¾‘å—ï¼Ÿ</strong> ä¸ºä»€ä¹ˆ"æŸå¤±åŒæ¶"æ¯”"è·å¾—æ„Ÿ"æ›´æœ‰æ•ˆï¼Ÿä¸ºä»€ä¹ˆ"é™æ—¶æŠ¢è´­"æ°¸è¿œæ¯”"æ…¢æ…¢æŒ‘é€‰"è½¬åŒ–ç‡é«˜ï¼Ÿä¸ºä»€ä¹ˆç”¨æˆ·æ°¸è¿œ"è¿˜å·®ä¸€ç‚¹"å°±æ»¡è¶³äº†ï¼Ÿâ€”â€”å› ä¸ºè¿›åŒ–å°±æ˜¯è¿™ä¹ˆè®¾è®¡äººè„‘çš„ã€‚</p>
<p>ä½†è¿™æœ¬ä¹¦æœ€æ‰“åŠ¨æˆ‘çš„åœ°æ–¹åœ¨äºï¼šå®ƒä¸åªæ˜¯æ•™ä½ æ€ä¹ˆåˆ©ç”¨è¿™äº›äººæ€§å¼±ç‚¹ï¼Œè€Œæ˜¯å‘Šè¯‰ä½ æ€ä¹ˆ<strong>è·³å‡ºè¿™äº›æœ¬èƒ½ååº”</strong>ã€‚</p>
<p>è¯´çœŸçš„ï¼Œåšäº§å“ä¹…äº†ï¼Œæˆ‘ä»¬è‡ªå·±ä¹Ÿå®¹æ˜“è¢«æ•°æ®ã€è¢«KPIã€è¢«å„ç§çŸ­æœŸæŒ‡æ ‡ç‰µç€é¼»å­èµ°ã€‚PRDæ”¹äº†å…«ç™¾éè¿˜æ˜¯è¿‡ä¸äº†è¯„å®¡çš„ç„¦è™‘ã€ä¸Šçº¿åæ•°æ®ä¸åŠé¢„æœŸçš„å´©æºƒã€è¢«ä¸šåŠ¡æ–¹éœ€æ±‚åå¤æ‹‰æ‰¯çš„æ„¤æ€’â€”â€”è¿™äº›æƒ…ç»ªå…¶å®ä¹Ÿéƒ½æ˜¯è¿›åŒ–ç•™ç»™æˆ‘ä»¬çš„"bug"ã€‚</p>
<p>å†¥æƒ³çš„æœ¬è´¨æ˜¯åœ¨è®­ç»ƒä½ è·Ÿè‡ªå·±çš„æ„Ÿå—æ‹‰å¼€ä¸€ç‚¹è·ç¦»ï¼Œä¸è¢«é‚£äº›æœ¬èƒ½ååº”ç»‘æ¶ã€‚<strong>å¯¹äº§å“ç»ç†æ¥è¯´ï¼Œè¿™å¯èƒ½æ˜¯æœ€é‡è¦çš„å…ƒæŠ€èƒ½ä¹‹ä¸€ï¼šä¿æŒæ¸…é†’ï¼Œä¸è¢«æƒ…ç»ªå’Œæ•°æ®ç»‘æ¶ï¼Œæ‰èƒ½åšå‡ºçœŸæ­£å¥½çš„åˆ¤æ–­ã€‚</strong></p>
<hr/>
<h2 data-id="heading-1">ã€Šé±¼ä¸å­˜åœ¨ã€‹ï¼šä¸€ä¸ªç–¯ç‹‚ç§‘å­¦å®¶çš„æ•…äº‹ï¼Œä¹Ÿæ˜¯å…³äº"ç§©åº"çš„éšå–»</h2>
<p>è¿™æœ¬ä¹¦çš„åˆ‡å…¥ç‚¹éå¸¸å¥‡ç‰¹ã€‚</p>
<p>ä¸»è§’æ˜¯ä¸€ä¸ªå«å¤§å«Â·æ–¯å¡”å°”Â·ä¹”ä¸¹çš„äººï¼Œ19ä¸–çºªæœ«20ä¸–çºªåˆçš„åˆ†ç±»å­¦å®¶ï¼Œæ–¯å¦ç¦å¤§å­¦çš„åˆ›æ ¡æ ¡é•¿ã€‚è¿™å“¥ä»¬ä¸€è¾ˆå­æœ€å¤§çš„çƒ­æƒ…å°±æ˜¯ç»™é±¼åˆ†ç±»å‘½åâ€”â€”ä»–å‘½åäº†å°†è¿‘äº”åˆ†ä¹‹ä¸€çš„å·²çŸ¥é±¼ç±»ã€‚</p>
<p>ç„¶å1906å¹´æ—§é‡‘å±±å¤§åœ°éœ‡ï¼Œä»–æ¯•ç”Ÿæ”¶é›†çš„æ ‡æœ¬å…¨æ¯äº†ï¼Œé‚£äº›ç“¶ç“¶ç½ç½ç¢äº†ä¸€åœ°ï¼Œæ‰€æœ‰æ ‡ç­¾æ··åœ¨ä¸€èµ·ã€‚æ¢ä¸€èˆ¬äººå¯èƒ½å°±æ­¤å´©æºƒæ”¾å¼ƒäº†ã€‚</p>
<p>ä½†ä¹”ä¸¹æ²¡æœ‰ã€‚ä»–æŠŠé’ˆç©¿è¿‡é±¼çš„èº«ä½“ï¼ŒæŠŠåå­—ç›´æ¥ç¼åœ¨é±¼èº«ä¸Šã€‚</p>
<p>å°±è¿™ä¸ªç»†èŠ‚ï¼Œéœ‡æ’¼åˆ°æˆ‘äº†ã€‚</p>
<p><strong>äº§å“ç»ç†å¹²çš„æ´»ï¼Œä¸ä¹Ÿæ˜¯è¿™æ ·å—ï¼Ÿ</strong></p>
<p>æˆ‘ä»¬æ•´å¤©åœ¨åšçš„äº‹æƒ…ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯"åˆ†ç±»"å’Œ"å‘½å"â€”â€”ç»™ç”¨æˆ·åˆ†å±‚ã€ç»™åŠŸèƒ½åˆ†æ¨¡å—ã€ç»™éœ€æ±‚åˆ†ä¼˜å…ˆçº§ã€ç»™é—®é¢˜è´´æ ‡ç­¾ã€‚æˆ‘ä»¬ç›¸ä¿¡ï¼Œåªè¦åˆ†ç±»åˆ†å¾—è¶³å¤Ÿæ¸…æ™°ã€æ¡†æ¶æ­å¾—è¶³å¤Ÿå®Œæ•´ï¼Œå°±èƒ½æŒæ§ä¸€åˆ‡ã€‚</p>
<p>ä½†ä¹¦å"é±¼ä¸å­˜åœ¨"å…¶å®æ¥è‡ªä¸€ä¸ªé¢ è¦†æ€§çš„ç§‘å­¦ç»“è®ºï¼šä»è¿›åŒ–åˆ†ç±»å­¦çš„è§’åº¦ï¼Œ"é±¼"è¿™ä¸ªç±»åˆ«æ ¹æœ¬ä¸æˆç«‹ã€‚æˆ‘ä»¬å«åš"é±¼"çš„é‚£äº›åŠ¨ç‰©ï¼Œå½¼æ­¤ä¹‹é—´çš„äº²ç¼˜å…³ç³»å¯èƒ½è¿˜ä¸å¦‚æŸäº›é±¼å’Œäººç±»è¿‘ã€‚</p>
<p>è¿™å°±å¾ˆè®½åˆºäº†â€”â€”ä¹”ä¸¹ä¸€è¾ˆå­ç»™é±¼åˆ†ç±»ï¼Œç»“æœ"é±¼"è¿™ä¸ªæ¦‚å¿µæœ¬èº«å°±æ˜¯ä¸ªäººç±»å‘æ˜çš„å‡è±¡ã€‚</p>
<p><strong>åšäº§å“çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœ‰å¤šå°‘"é±¼"ä¸€æ ·çš„å‡æ¦‚å¿µï¼Ÿ</strong></p>
<p>"é«˜ç«¯ç”¨æˆ·"çœŸçš„æ˜¯ä¸€ä¸ªæœ‰æ„ä¹‰çš„åˆ†ç±»å—ï¼Ÿè¿˜æ˜¯æˆ‘ä»¬è‡ªå·±ä¸ºäº†æ–¹ä¾¿è€Œå‘æ˜çš„æ ‡ç­¾ï¼Ÿ"ç¤¾äº¤éœ€æ±‚"å’Œ"å·¥å…·éœ€æ±‚"çœŸçš„æ˜¯æ³¾æ¸­åˆ†æ˜çš„å—ï¼Ÿè¿˜æ˜¯æˆ‘ä»¬å¼ºè¡ŒäºŒåˆ†çš„ç»“æœï¼Ÿé‚£äº›å†™åœ¨PRDé‡Œçš„"ç”¨æˆ·ç”»åƒ"ï¼Œæœ‰å¤šå°‘æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œåˆæœ‰å¤šå°‘æ˜¯æˆ‘ä»¬ä¸ºäº†è®©è‡ªå·±å®‰å¿ƒè€Œåˆ›é€ çš„ç§©åºå¹»è§‰ï¼Ÿ</p>
<p>æ›´æœ‰æ„æ€çš„æ˜¯ï¼Œä½œè€…éœ²éœ²Â·ç±³å‹’åœ¨å†™è¿™æœ¬ä¹¦çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°ä¹”ä¸¹è¿™ä¸ªäººè¿œæ²¡æœ‰çœ‹èµ·æ¥é‚£ä¹ˆæ­£é¢â€”â€”ä»–æ˜¯ä¼˜ç”Ÿå­¦çš„ç‹‚çƒ­æ”¯æŒè€…ï¼Œç”šè‡³å¯èƒ½è·Ÿä¸€æ¡©å‘½æ¡ˆæœ‰å…³ã€‚</p>
<p><strong>å¯¹"ç§©åº"çš„æåº¦æ‰§ç€ï¼Œæœ‰æ—¶å€™ä¼šé€šå‘å¾ˆå±é™©çš„åœ°æ–¹ã€‚</strong> äº’è”ç½‘è¡Œä¸šè¿™äº›å¹´ï¼Œä¸ä¹Ÿæœ‰å¾ˆå¤š"åˆ†ç±»å¼ºè¿«ç—‡"å¯¼è‡´çš„é—®é¢˜å—ï¼Ÿä¸ºäº†æ•°æ®å¥½çœ‹è€ŒæŠŠç”¨æˆ·ç¡¬å¡è¿›ä¸é€‚åˆçš„åˆ†å±‚ã€ä¸ºäº†æ¡†æ¶å®Œæ•´è€Œç æ‰ä¸ç¬¦åˆåˆ†ç±»çš„åŠŸèƒ½ã€ä¸ºäº†æ–¹æ³•è®ºè‡ªæ´½è€Œå¿½è§†çœŸå®çš„å¤æ‚æ€§â€”â€”è¿™äº›æœ¬è´¨ä¸Šéƒ½æ˜¯"ä¹”ä¸¹ç»¼åˆå¾"çš„å˜ä½“ã€‚</p>
<hr/>
<h2 data-id="heading-2">ä¸ºä»€ä¹ˆæŠŠè¿™ä¸¤æœ¬æ”¾ä¸€èµ·æ¨èç»™äº§å“ç»ç†ï¼Ÿ</h2>
<p>å› ä¸ºå®ƒä»¬æˆ³ç ´äº†äº§å“ç»ç†æœ€å®¹æ˜“é™·å…¥çš„ä¸¤ç§å¹»è§‰ï¼š</p>
<p><strong>ã€Šæ´è§ã€‹æˆ³ç ´"è‡ªæˆ‘"çš„å¹»è§‰</strong>â€”â€”ä¸ç®¡æ˜¯ç”¨æˆ·çš„è‡ªæˆ‘ï¼Œè¿˜æ˜¯æˆ‘ä»¬è‡ªå·±çš„è‡ªæˆ‘ã€‚ç†è§£äº†è¿™ä¸€ç‚¹ï¼Œå°±ä¸ä¼šå†é‚£ä¹ˆè¿·ä¿¡ç”¨æˆ·è°ƒç ”çš„è¡¨é¢ç»“è®ºï¼Œä¹Ÿä¸ä¼šå†è¢«è‡ªå·±çš„æƒ…ç»ªå’Œæ‰§å¿µç‰µç€èµ°ã€‚</p>
<p><strong>ã€Šé±¼ä¸å­˜åœ¨ã€‹æˆ³ç ´"ç§©åº"çš„å¹»è§‰</strong>â€”â€”ä¸ç®¡æ˜¯ç”¨æˆ·åˆ†å±‚ã€åŠŸèƒ½åˆ†ç±»è¿˜æ˜¯æ–¹æ³•è®ºæ¡†æ¶ã€‚ç†è§£äº†è¿™ä¸€ç‚¹ï¼Œå°±ä¸ä¼šå†æŠŠè‡ªå·±çš„åˆ†ç±»æ ‡å‡†å½“æˆçœŸç†ï¼Œä¹Ÿä¸ä¼šå†ä¸ºäº†ç»´æŠ¤"ç§©åºæ„Ÿ"è€Œå¿½è§†çœŸå®çš„æ··æ²Œã€‚</p>
<p>ä½†è¿™ä¸æ˜¯ä»€ä¹ˆè™šæ— ä¸»ä¹‰çš„ä¸§æ°”è¯ã€‚æ°æ°ç›¸åï¼Œ<strong>å½“ä½ çœ‹æ¸…æ¥šè¿™äº›å¹»è§‰ä¹‹åï¼Œåè€Œèƒ½åšå‡ºæ›´å¥½çš„äº§å“ã€‚</strong></p>
<p>å› ä¸ºä½ ä¸å†è¯•å›¾ç”¨ä¸€ä¸ª"å®Œç¾çš„æ¡†æ¶"å»æ¡†ä½ç”¨æˆ·ï¼Œè€Œæ˜¯æ¥å—ç”¨æˆ·æœ¬æ¥å°±æ˜¯å¤æ‚ã€çŸ›ç›¾ã€æµåŠ¨çš„ã€‚</p>
<p>å› ä¸ºä½ ä¸å†æ‰§ç€äºç»´æŠ¤ä¸€ä¸ª"å®Œæ•´çš„ä½“ç³»"ï¼Œè€Œæ˜¯æ„¿æ„åœ¨æ··æ²Œä¸­æ‰¾åˆ°çœŸæ­£é‡è¦çš„é‚£å‡ ä¸ªç‚¹ã€‚</p>
<p>å› ä¸ºä½ ä¸å†è¢«æ•°æ®å’ŒKPIç»‘æ¶æƒ…ç»ªï¼Œè€Œæ˜¯èƒ½é€€åä¸€æ­¥ï¼Œé—®ä¸€é—®ï¼šè¿™ä¸ªæŒ‡æ ‡åˆ°åº•åœ¨è¡¡é‡ä»€ä¹ˆï¼Ÿè¿™ä¸ªéœ€æ±‚åˆ°åº•åœ¨è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p>
<hr/>
<p>äº§å“ç»ç†è¿™ä¸ªå²—ä½ï¼Œè¯´åˆ°åº•å°±æ˜¯åœ¨<strong>æ··æ²Œä¸­å¯»æ‰¾ç§©åºï¼ŒåŒæ—¶ä¿æŒå¯¹ç§©åºçš„æ€€ç–‘</strong>ã€‚</p>
<p>å¤ªç›¸ä¿¡æ··æ²Œï¼Œä½ ä»€ä¹ˆéƒ½åšä¸å‡ºæ¥ã€‚</p>
<p>å¤ªç›¸ä¿¡ç§©åºï¼Œä½ å°±ä¼šå˜æˆä¹”ä¸¹â€”â€”æŠŠåå­—ç¼åœ¨ä¸€ä¸ªæ ¹æœ¬ä¸å­˜åœ¨çš„åˆ†ç±»ä¸Šã€‚</p>
<p>è¿™ä¸¤æœ¬ä¹¦ï¼Œä¸€æœ¬æ•™ä½ çœ‹æ¸…äººæ€§çš„æœ¬èƒ½ï¼Œä¸€æœ¬æ•™ä½ è­¦æƒ•ç§©åºçš„é™·é˜±ã€‚</p>
<p>éƒ½ä¸åšï¼Œå‘¨æœ«èŠ±ä¸¤å¤©å°±èƒ½è¯»å®Œã€‚å¼ºçƒˆæ¨èç»™æ‰€æœ‰åœ¨äº’è”ç½‘æµªé‡Œç¿»æ»šçš„æœ‹å‹ä»¬ã€‚</p>
<hr/>
<p>è¯»å®Œæ¬¢è¿æ¥æ‰¾æˆ‘èŠèŠï¼Œå’±ä»¬å¯ä»¥ä¸€èµ·åæ§½ï¼šä½ åšè¿‡çš„äº§å“é‡Œï¼Œæœ‰å¤šå°‘"é±¼"ï¼Ÿ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ…¢æ¥å£æ’æŸ¥å…¨æ™¯å›¾ï¼š7 å±‚å®šä½æ³•ï¼Œå¿«é€Ÿæªå‡ºæ€§èƒ½ç“¶é¢ˆ]]></title>    <link>https://juejin.cn/post/7603183929252315188</link>    <guid>https://juejin.cn/post/7603183929252315188</guid>    <pubDate>2026-02-05T15:27:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603183929252315188" data-draft-id="7603043152673554447" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ…¢æ¥å£æ’æŸ¥å…¨æ™¯å›¾ï¼š7 å±‚å®šä½æ³•ï¼Œå¿«é€Ÿæªå‡ºæ€§èƒ½ç“¶é¢ˆ"/> <meta itemprop="keywords" content="æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-02-05T15:27:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆé‡Œè°¢é¡¿"/> <meta itemprop="url" content="https://juejin.cn/user/3678304397695056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ…¢æ¥å£æ’æŸ¥å…¨æ™¯å›¾ï¼š7 å±‚å®šä½æ³•ï¼Œå¿«é€Ÿæªå‡ºæ€§èƒ½ç“¶é¢ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3678304397695056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆé‡Œè°¢é¡¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T15:27:48.000Z" title="Thu Feb 05 2026 15:27:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å½“ç”¨æˆ·åé¦ˆâ€œæ¥å£å¾ˆæ…¢â€æˆ–ç›‘æ§å‘Šè­¦â€œP99 å»¶è¿Ÿé£™å‡â€ï¼Œä½ æ˜¯å¦æ‰‹å¿™è„šä¹±ï¼Ÿ<br/>
æœ¬æ–‡æä¾›ä¸€å¥—<strong>ç»“æ„åŒ–æ’æŸ¥æ–¹æ³•è®º</strong>ï¼ŒæŒ‰è¯·æ±‚æµå‘é€å±‚æ‹†è§£ï¼ŒåŠ©ä½  30 åˆ†é’Ÿå†…å®šä½æ ¹å› ã€‚</p>
<blockquote>
<p>ğŸ¯ <strong>æ ¸å¿ƒåŸåˆ™</strong>ï¼š<br/>
<strong>â€œå…ˆçœ‹æ•´ä½“ï¼Œå†é’»ç»†èŠ‚ï¼›å…ˆå¤–åå†…ï¼Œå…ˆå¿«åæ…¢ã€‚â€</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€æ•´ä½“ç­–ç•¥ï¼šä¸‰æ­¥å®šç•Œæ³•</h2>
<ol>
<li><strong>ç¡®è®¤ç°è±¡</strong>ï¼šæ˜¯å•æ¥å£æ…¢ï¼Ÿè¿˜æ˜¯å…¨ç«™æ…¢ï¼Ÿå¶å‘è¿˜æ˜¯æŒç»­ï¼Ÿ</li>
<li><strong>ç¼©å°èŒƒå›´</strong>ï¼šé€šè¿‡æ—¥å¿—/ç›‘æ§ï¼Œç¡®å®šæ…¢å‘ç”Ÿåœ¨å“ªä¸€å±‚ï¼ˆå®¢æˆ·ç«¯ï¼Ÿç½‘ç»œï¼ŸæœåŠ¡ç«¯ï¼Ÿï¼‰</li>
<li><strong>èšç„¦æ ¹å› </strong>ï¼šåœ¨ç–‘ä¼¼å±‚æ·±å…¥åˆ†æï¼ˆå¦‚ DB æ…¢æŸ¥ã€CPU é£™å‡ã€é”ç«äº‰ç­‰ï¼‰</li>
</ol>
<hr/>
<h2 data-id="heading-1">äºŒã€åˆ†å±‚æ’æŸ¥è¯¦è§£</h2>
<h3 data-id="heading-2">ç¬¬ 1 å±‚ï¼šå®¢æˆ·ç«¯ï¼ˆClientï¼‰</h3>
<blockquote>
<p>âœ… <strong>é—®é¢˜ç‰¹å¾</strong>ï¼šä»…ç‰¹å®šç”¨æˆ·/è®¾å¤‡æ…¢ï¼ŒæœåŠ¡ç«¯æ—¥å¿—æ˜¾ç¤ºå¤„ç†å¾ˆå¿«</p>
</blockquote>
<h4 data-id="heading-3">æ’æŸ¥ç‚¹ï¼š</h4>





























<table><thead><tr><th>é¡¹ç›®</th><th>æ£€æŸ¥æ–¹æ³•</th></tr></thead><tbody><tr><td><strong>å®¢æˆ·ç«¯ç½‘ç»œ</strong></td><td>ç”¨æˆ·æ˜¯å¦åœ¨å¼±ç½‘ç¯å¢ƒï¼ˆåœ°é“ã€æµ·å¤–ï¼‰ï¼Ÿç”¨ <code>ping</code> / <code>traceroute</code> æµ‹è¯•åˆ°ç½‘å…³å»¶è¿Ÿ</td></tr><tr><td><strong>DNS è§£ææ…¢</strong></td><td><code>time dig your-api.com</code>ï¼Œè‹¥ &gt;500ms åˆ™ DNS æœ‰é—®é¢˜</td></tr><tr><td><strong>TLS æ¡æ‰‹æ…¢</strong></td><td>æµè§ˆå™¨ DevTools â†’ Network â†’ Timingï¼Œçœ‹ <code>SSL</code> é˜¶æ®µè€—æ—¶</td></tr><tr><td><strong>å®¢æˆ·ç«¯ä»£ç é˜»å¡</strong></td><td>å‰ç«¯ JS æ˜¯å¦åœ¨è¯·æ±‚å‰åšå¤§é‡è®¡ç®—ï¼Ÿç§»åŠ¨ç«¯æ˜¯å¦ä¸»çº¿ç¨‹å¡é¡¿ï¼Ÿ</td></tr><tr><td><strong>é‡è¯•é£æš´</strong></td><td>å®¢æˆ·ç«¯è¶…æ—¶è®¾ç½®è¿‡çŸ­ï¼ˆå¦‚ 1sï¼‰ï¼Œé¢‘ç¹é‡è¯•åŠ é‡æœåŠ¡ç«¯å‹åŠ›</td></tr></tbody></table>
<h4 data-id="heading-4">å·¥å…·ï¼š</h4>
<ul>
<li>æµè§ˆå™¨ DevToolsï¼ˆNetwork Tabï¼‰</li>
<li><code>curl -w "@format.txt"</code> è‡ªå®šä¹‰è¾“å‡ºå„é˜¶æ®µè€—æ—¶</li>
<li>ç§»åŠ¨ç«¯ APMï¼ˆå¦‚ Firebase Performance Monitoringï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-5">ç¬¬ 2 å±‚ï¼šç½‘ç»œï¼ˆNetworkï¼‰</h3>
<blockquote>
<p>âœ… <strong>é—®é¢˜ç‰¹å¾</strong>ï¼šè·¨åŒºåŸŸè®¿é—®æ…¢ï¼ŒåŒæœºæˆ¿æ­£å¸¸</p>
</blockquote>
<h4 data-id="heading-6">æ’æŸ¥ç‚¹ï¼š</h4>





























<table><thead><tr><th>é¡¹ç›®</th><th>æ£€æŸ¥æ–¹æ³•</th></tr></thead><tbody><tr><td><strong>è·¨è¿è¥å•†å»¶è¿Ÿ</strong></td><td>ç”µä¿¡ç”¨æˆ·è®¿é—®è”é€šæœåŠ¡å™¨ï¼Ÿç”¨ <code>mtr your-api.com</code> æŸ¥è·¯ç”±è·³æ•°å’Œä¸¢åŒ…</td></tr><tr><td><strong>BGP è·¯ç”±å¼‚å¸¸</strong></td><td>å…¨çƒå¤šåœ° ping æµ‹è¯•ï¼ˆå¦‚ <a href="https://link.juejin.cn?target=https%3A%2F%2Fping.pe%2F" target="_blank" title="https://ping.pe/" ref="nofollow noopener noreferrer">Ping.pe</a>ï¼‰</td></tr><tr><td><strong>é˜²ç«å¢™/å®‰å…¨ç»„é™é€Ÿ</strong></td><td>æ£€æŸ¥äº‘å‚å•†å®‰å…¨ç»„æ˜¯å¦ QoS é™æµ</td></tr><tr><td><strong>MTU ä¸åŒ¹é…</strong></td><td>å¤§åŒ…åˆ†ç‰‡å¯¼è‡´é‡ä¼ ï¼ˆå°‘è§ï¼Œä½†å¯èƒ½ï¼‰</td></tr><tr><td><strong>CDN å›æºæ…¢</strong></td><td>è‹¥ä½¿ç”¨ CDNï¼Œæ£€æŸ¥å›æºåˆ°æºç«™çš„å»¶è¿Ÿ</td></tr></tbody></table>
<h4 data-id="heading-7">å·¥å…·ï¼š</h4>
<ul>
<li><code>mtr --report your-api.com</code></li>
<li><code>tcptraceroute your-api.com 443</code></li>
<li>äº‘å‚å•†ç½‘ç»œè¯Šæ–­å·¥å…·ï¼ˆé˜¿é‡Œäº‘ ARMSã€AWS VPC Flow Logsï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-8">ç¬¬ 3 å±‚ï¼šç½‘å…³/è´Ÿè½½å‡è¡¡ï¼ˆGateway / LBï¼‰</h3>
<blockquote>
<p>âœ… <strong>é—®é¢˜ç‰¹å¾</strong>ï¼šæ‰€æœ‰æ¥å£æ…¢ï¼Œæˆ–ç‰¹å®šè·¯å¾„æ…¢ï¼ˆå¦‚ <code>/api/v1/*</code>ï¼‰</p>
</blockquote>
<h4 data-id="heading-9">æ’æŸ¥ç‚¹ï¼š</h4>





























<table><thead><tr><th>é¡¹ç›®</th><th>æ£€æŸ¥æ–¹æ³•</th></tr></thead><tbody><tr><td><strong>ç½‘å…³ CPU/å†…å­˜æ‰“æ»¡</strong></td><td>æŸ¥çœ‹ Nginx / ALB / API Gateway ç›‘æ§æŒ‡æ ‡</td></tr><tr><td><strong>è¿æ¥æ± è€—å°½</strong></td><td>Nginx <code>upstream</code> è¿æ¥æ•°è¾¾åˆ° <code>max_conns</code></td></tr><tr><td><strong>WAF/å®‰å…¨æ’ä»¶å¼€é”€</strong></td><td>æ˜¯å¦å¯ç”¨äº†æ­£åˆ™è§„åˆ™æ‰«æï¼Ÿå…³é—­ WAF æµ‹è¯•å¯¹æ¯”</td></tr><tr><td><strong>SSL å¸è½½ç“¶é¢ˆ</strong></td><td>TLS 1.3 vs 1.2 æ€§èƒ½å·®å¼‚ï¼Ÿè¯ä¹¦é“¾è¿‡é•¿ï¼Ÿ</td></tr><tr><td><strong>è·¯ç”±é…ç½®é”™è¯¯</strong></td><td>è¯·æ±‚è¢«é”™è¯¯è½¬å‘åˆ°ä½é…å®ä¾‹ï¼Ÿ</td></tr></tbody></table>
<h4 data-id="heading-10">æ—¥å¿—åˆ†æï¼ˆNginx ç¤ºä¾‹ï¼‰ï¼š</h4>
<pre><code class="hljs language-dart" lang="dart"># å¼€å¯è¯¦ç»†æ—¥å¿—
log_format detailed <span class="hljs-string">'<span class="hljs-subst">$remote_addr</span> - <span class="hljs-subst">$remote_user</span> [<span class="hljs-subst">$time_local</span>] '</span>
                   <span class="hljs-string">'"<span class="hljs-subst">$request</span>" <span class="hljs-subst">$status</span> <span class="hljs-subst">$body_bytes_sent</span> '</span>
                   <span class="hljs-string">'"<span class="hljs-subst">$http_referer</span>" "<span class="hljs-subst">$http_user_agent</span>" '</span>
                   <span class="hljs-string">'rt=<span class="hljs-subst">$request_time</span> uct="<span class="hljs-subst">$upstream_connect_time</span>" '</span>
                   <span class="hljs-string">'uht="<span class="hljs-subst">$upstream_header_time</span>" urt="<span class="hljs-subst">$upstream_response_time</span>"'</span>;

access_log /<span class="hljs-keyword">var</span>/log/nginx/access.log detailed;
</code></pre>
<blockquote>
<p>ğŸ” å…³é”®å­—æ®µï¼š</p>
<ul>
<li><code>$request_time</code>ï¼šæ€»è€—æ—¶</li>
<li><code>$upstream_response_time</code>ï¼šåç«¯æœåŠ¡è€—æ—¶<br/>
<strong>è‹¥å‰è€… &gt;&gt; åè€… â†’ ç½‘å…³å±‚é—®é¢˜</strong></li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-11">ç¬¬ 4 å±‚ï¼šæœåŠ¡ç«¯åº”ç”¨ï¼ˆApplicationï¼‰</h3>
<blockquote>
<p>âœ… <strong>é—®é¢˜ç‰¹å¾</strong>ï¼šæ¥å£é€»è¾‘å¤æ‚ï¼Œæ—¥å¿—æ˜¾ç¤ºå¤„ç†æ—¶é—´é•¿</p>
</blockquote>
<h4 data-id="heading-12">æ’æŸ¥ç‚¹ï¼š</h4>





























<table><thead><tr><th>é¡¹ç›®</th><th>æ£€æŸ¥æ–¹æ³•</th></tr></thead><tbody><tr><td><strong>ä»£ç æ€§èƒ½ç“¶é¢ˆ</strong></td><td>æ˜¯å¦æœ‰ O(nÂ²) å¾ªç¯ï¼Ÿé‡å¤è®¡ç®—ï¼Ÿæœªç¼“å­˜ç»“æœï¼Ÿ</td></tr><tr><td><strong>åŒæ­¥é˜»å¡è°ƒç”¨</strong></td><td>åœ¨ HTTP çº¿ç¨‹ä¸­è°ƒç”¨å¤–éƒ¨ APIã€DBã€æ–‡ä»¶ IOï¼Ÿ</td></tr><tr><td><strong>GC é¢‘ç¹</strong></td><td>Java Full GCã€Go GC STW æ—¶é—´è¿‡é•¿ï¼Ÿ</td></tr><tr><td><strong>çº¿ç¨‹æ± è€—å°½</strong></td><td>Tomcat çº¿ç¨‹æ± æ»¡ï¼Œæ–°è¯·æ±‚æ’é˜Ÿï¼Ÿ</td></tr><tr><td><strong>æ—¥å¿—æ‰“å°è¿‡å¤š</strong></td><td>ç”Ÿäº§ç¯å¢ƒ DEBUG æ—¥å¿—æ‹–æ…¢æ€§èƒ½ï¼Ÿ</td></tr></tbody></table>
<h4 data-id="heading-13">å·¥å…·ï¼š</h4>
<ul>
<li>
<p><strong>APM å·¥å…·</strong>ï¼ˆå¿…ç”¨ï¼ï¼‰ï¼š</p>
<ul>
<li>Java: SkyWalking, Pinpoint, Arthas</li>
<li>Go: pprof, Pyroscope</li>
<li>Python: py-spy, OpenTelemetry</li>
</ul>
</li>
<li>
<p><strong>ç«ç„°å›¾ï¼ˆFlame Graphï¼‰</strong> ï¼šç›´è§‚å±•ç¤º CPU çƒ­ç‚¹</p>
</li>
<li>
<p><strong>é“¾è·¯è¿½è¸ªï¼ˆTracingï¼‰</strong> ï¼šæŸ¥çœ‹ Span è€—æ—¶åˆ†å¸ƒ</p>
</li>
</ul>
<blockquote>
<p>ğŸ’¡ ç¤ºä¾‹ï¼ˆArthas ç›‘æ§æ–¹æ³•è€—æ—¶ï¼‰ï¼š</p>
<pre><code class="hljs">trace com.example.service.UserService getUserById
</code></pre>
</blockquote>
<hr/>
<h3 data-id="heading-14">ç¬¬ 5 å±‚ï¼šç³»ç»Ÿèµ„æºï¼ˆOS / Hostï¼‰</h3>
<blockquote>
<p>âœ… <strong>é—®é¢˜ç‰¹å¾</strong>ï¼šæ•´æœºå˜æ…¢ï¼Œå¤šä¸ªæœåŠ¡å—å½±å“</p>
</blockquote>
<h4 data-id="heading-15">æ’æŸ¥ç‚¹ï¼š</h4>



































<table><thead><tr><th>èµ„æº</th><th>æ£€æŸ¥å‘½ä»¤</th><th>å¼‚å¸¸è¡¨ç°</th></tr></thead><tbody><tr><td><strong>CPU</strong></td><td><code>top</code>, <code>htop</code></td><td>%sys é«˜ï¼ˆå†…æ ¸æ€ï¼‰ã€%iowait é«˜ï¼ˆç£ç›˜ç“¶é¢ˆï¼‰</td></tr><tr><td><strong>å†…å­˜</strong></td><td><code>free -h</code>, <code>vmstat 1</code></td><td>swap ä½¿ç”¨ &gt;0ï¼Œé¢‘ç¹ page-in/out</td></tr><tr><td><strong>ç£ç›˜ IO</strong></td><td><code>iostat -x 1</code>, <code>iotop</code></td><td><code>%util &gt; 90%</code>, <code>await &gt; 20ms</code></td></tr><tr><td><strong>ç½‘ç»œå¸¦å®½</strong></td><td><code>iftop</code>, <code>nethogs</code></td><td>å‡º/å…¥å¸¦å®½æ‰“æ»¡</td></tr><tr><td><strong>æ–‡ä»¶æè¿°ç¬¦</strong></td><td>`lsof</td><td>wc -l<code>, </code>cat /proc/sys/fs/file-nr`</td></tr></tbody></table>
<h4 data-id="heading-16">å…³é”®æŒ‡æ ‡ï¼š</h4>
<ul>
<li><strong>Load Average</strong>ï¼š&gt; CPU æ ¸æ•° Ã— 2 å¯èƒ½å­˜åœ¨ç“¶é¢ˆ</li>
<li><strong>Context Switches</strong>ï¼š<code>vmstat</code> ä¸­ <code>cs</code> åˆ—çªå¢ â†’ çº¿ç¨‹ç«äº‰æ¿€çƒˆ</li>
</ul>
<hr/>
<h3 data-id="heading-17">ç¬¬ 6 å±‚ï¼šä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰</h3>
<blockquote>
<p>âœ… <strong>é—®é¢˜ç‰¹å¾</strong>ï¼šæ¶‰åŠç¼“å­˜ã€æ¶ˆæ¯é˜Ÿåˆ—ã€RPC è°ƒç”¨çš„æ¥å£æ…¢</p>
</blockquote>
<h4 data-id="heading-18">å¸¸è§ä¸­é—´ä»¶æ’æŸ¥ï¼š</h4>

























<table><thead><tr><th>ä¸­é—´ä»¶</th><th>æ’æŸ¥é‡ç‚¹</th></tr></thead><tbody><tr><td><strong>Redis</strong></td><td>- æ…¢æŸ¥è¯¢ï¼ˆ<code>SLOWLOG GET</code>ï¼‰ - å¤§ Key é˜»å¡ï¼ˆ<code>MEMORY USAGE key</code>ï¼‰ - è¿æ¥æ± è€—å°½</td></tr><tr><td><strong>Kafka</strong></td><td>- åˆ†åŒº Leader ä¸å¯ç”¨ - Consumer Lag ç§¯å‹ - ç½‘ç»œå¾€è¿”å»¶è¿Ÿé«˜</td></tr><tr><td><strong>RabbitMQ</strong></td><td>- Queue ç§¯å‹ - æ¶ˆè´¹è€…å¤„ç†æ…¢ - å†…å­˜å‘Šè­¦ï¼ˆflow controlï¼‰</td></tr><tr><td><strong>gRPC / Dubbo</strong></td><td>- åºåˆ—åŒ–å¼€é”€å¤§ï¼ˆProtobuf vs JSONï¼‰ - è¿æ¥æœªå¤ç”¨</td></tr></tbody></table>
<h4 data-id="heading-19">é€šç”¨æ–¹æ³•ï¼š</h4>
<ul>
<li><strong>ä¸­é—´ä»¶ç›‘æ§é¢æ¿</strong>ï¼ˆå¦‚ RedisInsight, Kafka Managerï¼‰</li>
<li><strong>å®¢æˆ·ç«¯åŸ‹ç‚¹</strong>ï¼šè®°å½•ä¸­é—´ä»¶è°ƒç”¨è€—æ—¶ï¼ˆå¦‚ <code>redis.get(key)</code> è€—æ—¶ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-20">ç¬¬ 7 å±‚ï¼šæ•°æ®åº“ï¼ˆDatabaseï¼‰</h3>
<blockquote>
<p>âœ… <strong>é—®é¢˜ç‰¹å¾</strong>ï¼šæ¥å£åŒ…å« DB æŸ¥è¯¢ï¼Œä¸” DB è´Ÿè½½é«˜</p>
</blockquote>
<h4 data-id="heading-21">æ’æŸ¥ç‚¹ï¼š</h4>





























<table><thead><tr><th>é¡¹ç›®</th><th>æ£€æŸ¥æ–¹æ³•</th></tr></thead><tbody><tr><td><strong>æ…¢ SQL</strong></td><td>MySQL: <code>slow_query_log</code>ï¼›PostgreSQL: <code>log_min_duration_statement</code></td></tr><tr><td><strong>ç¼ºå¤±ç´¢å¼•</strong></td><td><code>EXPLAIN</code> æ‰§è¡Œè®¡åˆ’å‡ºç° <code>Seq Scan</code> / <code>Using filesort</code></td></tr><tr><td><strong>é”ç«äº‰</strong></td><td>MySQL: <code>SHOW ENGINE INNODB STATUS</code>ï¼›æ­»é”æ—¥å¿—</td></tr><tr><td><strong>è¿æ¥æ± è€—å°½</strong></td><td>åº”ç”¨æŠ¥ <code>Too many connections</code></td></tr><tr><td><strong>å¤§äº‹åŠ¡</strong></td><td>å•äº‹åŠ¡ä¿®æ”¹ç™¾ä¸‡è¡Œï¼Œé˜»å¡å…¶ä»–æ“ä½œ</td></tr></tbody></table>
<h4 data-id="heading-22">å¿«é€Ÿè¯Šæ–­å‘½ä»¤ï¼ˆMySQLï¼‰ï¼š</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥çœ‹å½“å‰è¿è¡Œçš„æ…¢æŸ¥è¯¢</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> information_schema.processlist 
<span class="hljs-keyword">WHERE</span> <span class="hljs-type">TIME</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span> <span class="hljs-keyword">AND</span> COMMAND <span class="hljs-operator">!=</span> <span class="hljs-string">'Sleep'</span>;

<span class="hljs-comment">-- æŸ¥çœ‹ InnoDB é”ç­‰å¾…</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> sys.innodb_lock_waits;
</code></pre>
<h4 data-id="heading-23">å·¥å…·ï¼š</h4>
<ul>
<li><strong>Percona Toolkit</strong>ï¼ˆ<code>pt-query-digest</code> åˆ†ææ…¢æ—¥å¿—ï¼‰</li>
<li><strong>Prometheus + Grafana</strong>ï¼ˆç›‘æ§ QPSã€è¿æ¥æ•°ã€ç¼“å†²æ± å‘½ä¸­ç‡ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-24">ä¸‰ã€å®æˆ˜æ¡ˆä¾‹ï¼šä¸€ä¸ªæ…¢æ¥å£çš„å®Œæ•´æ’æŸ¥è¿‡ç¨‹</h2>
<h3 data-id="heading-25">ç°è±¡ï¼š</h3>
<ul>
<li>æ¥å£ <code>/api/order/detail</code> P99 ä» 200ms â†’ 5s</li>
<li>ä»…è¯¥æ¥å£æ…¢ï¼Œå…¶ä»–æ­£å¸¸</li>
</ul>
<h3 data-id="heading-26">æ’æŸ¥æ­¥éª¤ï¼š</h3>
<ol>
<li><strong>å®¢æˆ·ç«¯</strong>ï¼šå‰ç«¯ DevTools æ˜¾ç¤º TTFBï¼ˆTime To First Byteï¼‰= 4.8s â†’ é—®é¢˜åœ¨æœåŠ¡ç«¯</li>
<li><strong>ç½‘å…³</strong>ï¼šNginx æ—¥å¿— <code>$upstream_response_time = 4.7s</code> â†’ ç½‘å…³æ— ç“¶é¢ˆ</li>
<li><strong>æœåŠ¡ç«¯</strong>ï¼šAPM æ˜¾ç¤º <code>OrderService.getDetail()</code> è€—æ—¶ 4.6s</li>
<li><strong>ä»£ç åˆ†æ</strong>ï¼šè¯¥æ–¹æ³•å†…è°ƒç”¨ <code>userClient.getUser(userId)</code>ï¼ˆè¿œç¨‹ RPCï¼‰</li>
<li><strong>RPC ä¸­é—´ä»¶</strong>ï¼šå‘ç° <code>userClient</code> è¶…æ—¶è®¾ä¸º 5sï¼Œå®é™…è€—æ—¶ 4.5s</li>
<li><strong>ç”¨æˆ·æœåŠ¡</strong>ï¼šAPM æ˜¾ç¤º <code>UserService.getUser()</code> ä¸­ <code>SELECT * FROM users WHERE id=?</code> è€—æ—¶ 4.4s</li>
<li><strong>æ•°æ®åº“</strong>ï¼š<code>EXPLAIN</code> å‘ç° <code>users.id</code> æ— ä¸»é”®ï¼ˆè¯¯åˆ ï¼‰â†’ å…¨è¡¨æ‰«æ 1000 ä¸‡è¡Œï¼</li>
</ol>
<h3 data-id="heading-27">æ ¹å› ï¼š<strong>æ•°æ®åº“ä¸»é”®ä¸¢å¤±å¯¼è‡´å…¨è¡¨æ‰«æ</strong></h3>
<h3 data-id="heading-28">è§£å†³ï¼šé‡å»ºä¸»é”®ï¼Œæ·»åŠ ç›‘æ§å‘Šè­¦â€œæ— ä¸»é”®è¡¨â€ã€‚</h3>
<hr/>
<h2 data-id="heading-29">å››ã€é¢„é˜²æªæ–½ï¼šè®©æ…¢æ¥å£æ— å¤„è—èº«</h2>





























<table><thead><tr><th>å±‚çº§</th><th>é¢„é˜²æ‰‹æ®µ</th></tr></thead><tbody><tr><td><strong>å®¢æˆ·ç«¯</strong></td><td>è®¾ç½®åˆç†è¶…æ—¶ï¼ˆå¦‚ 3sï¼‰ï¼Œé™çº§æ–¹æ¡ˆ</td></tr><tr><td><strong>ç½‘ç»œ</strong></td><td>å¤šå¯ç”¨åŒºéƒ¨ç½²ï¼ŒBGP Anycast</td></tr><tr><td><strong>ç½‘å…³</strong></td><td>é™æµç†”æ–­ï¼ˆSentinel, Hystrixï¼‰</td></tr><tr><td><strong>æœåŠ¡ç«¯</strong></td><td>APM å…¨é“¾è·¯ç›‘æ§ + å‘Šè­¦ï¼ˆP99 &gt; 1sï¼‰</td></tr><tr><td><strong>æ•°æ®åº“</strong></td><td>æ…¢ SQL è‡ªåŠ¨æ•è· + ç´¢å¼•æ¨è</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-30">äº”ã€æ€»ç»“ï¼šæ…¢æ¥å£æ’æŸ¥ Checklist</h2>
<p>âœ… <strong>ç¬¬ä¸€æ­¥ï¼šç¡®è®¤èŒƒå›´</strong></p>
<ul>
<li>å•æ¥å£ or å…¨ç«™ï¼Ÿå¶å‘ or æŒç»­ï¼Ÿ</li>
</ul>
<p>âœ… <strong>ç¬¬äºŒæ­¥ï¼šçœ‹ç½‘å…³æ—¥å¿—</strong></p>
<ul>
<li><code>$request_time</code> vs <code>$upstream_response_time</code></li>
</ul>
<p>âœ… <strong>ç¬¬ä¸‰æ­¥ï¼šæŸ¥ APM é“¾è·¯</strong></p>
<ul>
<li>å“ªä¸ª Span è€—æ—¶æœ€é•¿ï¼Ÿ</li>
</ul>
<p>âœ… <strong>ç¬¬å››æ­¥ï¼šé’»å–ç“¶é¢ˆå±‚</strong></p>
<ul>
<li>DBï¼Ÿä¸­é—´ä»¶ï¼Ÿç³»ç»Ÿèµ„æºï¼Ÿ</li>
</ul>
<p>âœ… <strong>ç¬¬äº”æ­¥ï¼šå¤ç° &amp; éªŒè¯</strong></p>
<ul>
<li>ä¿®å¤åå‹æµ‹éªŒè¯</li>
</ul>
<blockquote>
<p>ğŸŒŸ <strong>è®°ä½</strong>ï¼š<br/>
<strong>â€œæ²¡æœ‰ç›‘æ§çš„ç³»ç»Ÿï¼Œå°±æ˜¯åœ¨é»‘æš—ä¸­å¼€è½¦ã€‚â€</strong><br/>
å»ºç«‹å®Œå–„çš„å¯è§‚æµ‹æ€§ä½“ç³»ï¼ˆMetrics + Logs + Tracesï¼‰ï¼Œæ˜¯é«˜æ•ˆæ’æŸ¥çš„å‰æã€‚</p>
</blockquote>
<hr/>
<p><strong>å»¶ä¼¸é˜…è¯»</strong>ï¼š</p>
<ul>
<li>ã€ŠSite Reliability Engineeringã€‹ç¬¬ 11 ç« ï¼šManaging Incidents</li>
<li>OpenTelemetry å®˜æ–¹æ–‡æ¡£</li>
<li>MySQL é«˜æ€§èƒ½ç´¢å¼•ç­–ç•¥</li>
</ul>
<hr/>
<blockquote>
<p><strong>ä½œè€…</strong>ï¼šSRE å·¥ç¨‹å¸ˆ<br/>
<strong>æ›´æ–°æ—¥æœŸ</strong>ï¼š2026 å¹´ 2 æœˆ<br/>
<strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬æ–‡å¯è‡ªç”±è½¬è½½ï¼Œä½†è¯·ä¿ç•™å‡ºå¤„ã€‚</p>
</blockquote>
<p>å¦‚æœä½ å¸Œæœ›æˆ‘æä¾› <strong>è‡ªåŠ¨åŒ–æ…¢æ¥å£è¯Šæ–­è„šæœ¬æ¨¡æ¿</strong> æˆ– <strong>Prometheus å‘Šè­¦è§„åˆ™ç¤ºä¾‹</strong>ï¼Œæ¬¢è¿ç»§ç»­æé—®ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>