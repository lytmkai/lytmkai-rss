<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[Node.js + puppeteer + chrome ç¯å¢ƒéƒ¨ç½²è‡³linux]]></title>    <link>https://juejin.cn/post/7574382925761691686</link>    <guid>https://juejin.cn/post/7574382925761691686</guid>    <pubDate>2025-11-20T05:23:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574382925761691686" data-draft-id="7574625040630661158" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Node.js + puppeteer + chrome ç¯å¢ƒéƒ¨ç½²è‡³linux"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-20T05:23:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="zhou770377"/> <meta itemprop="url" content="https://juejin.cn/user/1082340230562679"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Node.js + puppeteer + chrome ç¯å¢ƒéƒ¨ç½²è‡³linux
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1082340230562679/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    zhou770377
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T05:23:04.000Z" title="Thu Nov 20 2025 05:23:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h5 data-id="heading-0">è¸©å‘æ•´æ•´5å¤©æ‰å’Œè¿ç»´å¤§å“¥éƒ¨ç½²æˆåŠŸâ€¦â€¦</h5>
<h3 data-id="heading-1">å…ˆè¯´ä¸‹å…·ä½“çš„æ€è·¯ï¼Œå› ä¸ºpuppeteerçš„è¿è¡Œå¿…é¡»ä¾èµ–äºæµè§ˆå™¨ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯chrome,</h3>
<p>æ­¤å¤„å®‰è£…æµè§ˆå™¨çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼Œ
æ˜¯å› ä¸ºpuppeteeræä¾›äº†ä¸¤ç§è¿æ¥è°ƒè¯•æµè§ˆå™¨çš„æ–¹æ¡ˆ
è¿æ¥å·²æœ‰çš„æµè§ˆå™¨å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ğŸ”— è¿æ¥åˆ°æœ¬åœ°Chromeæµè§ˆå™¨..."</span>);
      <span class="hljs-keyword">const</span> browserURL = <span class="hljs-string">'http://localhost:9222'</span>; <span class="hljs-comment">//   æµè§ˆå™¨æœåŠ¡å¯åŠ¨ä¹‹åå¯ä»¥ç›´æ¥è®¿é—®</span>
      
     <span class="hljs-comment">/*   
     
     
     é¿å‘ï¼šè¿™é‡Œä¼šæœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯é¡µé¢ä¼šä¸€ç›´ä¿å­˜åœ¨ å¯¹åº”ç«¯å£çš„æµè§ˆå™¨é¡µé¢åœ¨æµè§ˆå™¨çš„æœ¬åœ°å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ çš„è„šæœ¬æ‰§è¡Œçš„ä»»åŠ¡æœ‰ç™»å½•çš„é€»è¾‘ï¼Œé‚£ä¹ˆä¸‹æ¬¡è„šæœ¬è¿è¡Œä¹‹åï¼Œä¼šç›´æ¥è®¿é—®åˆ°ç¬¬ä¸€æ¬¡ç™»å½•çš„ç”¨æˆ·ä¿¡æ¯ï¼Œç±»ä¼¼äºç”¨æˆ·è‡ªå·±æ“ä½œç™»å½•åï¼Œåç»­è¿›å…¥ä¹Ÿä¸ç”¨ç™»å½•æ˜¯ä¸€ä¸ªé€»è¾‘ã€‚
     
     è¿™é‡Œæ˜¯æœ¬åœ°è¿æ¥å’Œä½¿ç”¨è‡ªå¸¦çš„chromeçš„ä¸€ä¸ªå¾ˆå¤§çš„åŒºåˆ«ï¼Œ
   è¯·åŠ¡å¿…åœ¨jsé€»è¾‘ä¸­åšå…¼å®¹å¤„ç†ï¼Œ
   
   å¦åˆ™ä½ ä¼šå‘ç°ï¼Œè¯¥æ¨¡å¼å’Œè‡ªå¸¦çš„æ¨¡å¼å‡ºç°ä¸ä¸€æ ·çš„ç»“æœï¼Œè€Œä¸çŸ¥é“é—®é¢˜æ‰€åœ¨ã€‚
     
     
        */</span>
      
      browser = <span class="hljs-keyword">await</span> puppeteer.<span class="hljs-title function_">connect</span>({
        <span class="hljs-attr">browserURL</span>: browserURL,
        <span class="hljs-attr">defaultViewport</span>: <span class="hljs-literal">null</span>
      });
      
      
    
      
      
      
      
      
      
      <span class="hljs-keyword">const</span> version = <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">version</span>();
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(version);
</code></pre>
<p>ä½¿ç”¨puppeteerè‡ªå¸¦çš„å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¯åŠ¨æ–°çš„æµè§ˆå™¨å®ä¾‹ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰</span>
      <span class="hljs-comment">// ä½¿ç”¨puppeteerè‡ªå¸¦çš„Chromiumï¼Œé¿å…ç³»ç»Ÿæµè§ˆå™¨ä¾èµ–</span>
      <span class="hljs-keyword">const</span> browserConfig = {
        <span class="hljs-attr">headless</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// ä½¿ç”¨é…ç½®ä¸­çš„æ— å¤´æ¨¡å¼</span>
        <span class="hljs-comment">// ä¸æŒ‡å®šexecutablePathï¼Œè®©puppeteerä½¿ç”¨è‡ªå¸¦çš„æµè§ˆå™¨</span>
        <span class="hljs-attr">args</span>: [  <span class="hljs-comment">// ç›¸å…³é…ç½®å‚æ•°</span>
          ...config.<span class="hljs-property">browser</span>.<span class="hljs-property">args</span>,
          <span class="hljs-string">`--window-size=<span class="hljs-subst">${config.browser.windowSize.width}</span>,<span class="hljs-subst">${config.browser.windowSize.height}</span>`</span>,
          <span class="hljs-string">"--no-sandbox"</span>,
          <span class="hljs-string">"--disable-setuid-sandbox"</span>,
          <span class="hljs-string">"--disable-dev-shm-usage"</span>,
        ],
        <span class="hljs-attr">ignoreHTTPSErrors</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">defaultViewport</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">timeout</span>: <span class="hljs-number">6</span> * <span class="hljs-number">1000</span>,
      };

      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">getTimestampedLog</span>(<span class="hljs-string">"ğŸ“± å¯åŠ¨æµè§ˆå™¨..."</span>));
      browser = <span class="hljs-keyword">await</span> puppeteer.<span class="hljs-title function_">launch</span>(browserConfig);
      <span class="hljs-keyword">const</span> version = <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">version</span>();
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(version);
</code></pre>
<h4 data-id="heading-2">ç¬¬ä¸€ç§å°±æ˜¯: ç›´æ¥ä½¿ç”¨ï¼Œpuppeteerè‡ªå·±çš„æµè§ˆå™¨ï¼Œç¼ºç‚¹æ˜¯: å®‰è£…æ…¢ï¼Œéƒ¨ç½²å¾ˆå®¹æ˜“å¤±è´¥</h4>
<h4 data-id="heading-3">ç¬¬äºŒå°±æ˜¯:ä¼šæœ‰ä»€ä¹ˆæƒé™é—®é¢˜å¯¼è‡´æ— æ³•å¯åŠ¨ ä¾‹å¦‚è¿™æ ·ï¼šï¼ˆè‡ªåŠ¨åŒ–æ“ä½œå¤±è´¥ï¼šFailed to launch the browser process: spawn /root/.cache/puppeteer/chrome/1inux-142.0.7444.61/chrome-1inux64/chrome ENOEï¼‰</h4>
<h2 data-id="heading-4">ç»¼ä¸Šæ‰€è¿°ï¼š</h2>
<p>æœ¬æ–‡é‡‡ç”¨ç¬¬äºŒæ¡è·¯å°±æ˜¯ï¼Œå•ç‹¬å®‰è£…è¿è¡ŒchromeæœåŠ¡ï¼Œ
ç„¶åï¼Œç”¨puppeteeré“¾æ¥æœ¬åœ°çš„chromeæœåŠ¡ã€‚</p>
<h2 data-id="heading-5">1, å®‰è£…chrome å¹¶è¿è¡ŒæœåŠ¡è‡³9222ç«¯å£</h2>
<p>æ³¨æ„ï¼šæœ¬äººçš„æœåŠ¡å™¨æ˜¯cent os7ï¼ˆä¸‹é¢ä¸¤ç§æ–¹æ¡ˆéƒ½å¯ä»¥ç”¨ï¼Œ æ–¹æ¡ˆäºŒæ˜¯å› ä¸ºè¿ç»´çš„æœåŠ¡å™¨ï¼Œ ç³»ç»Ÿä¸æ”¯æŒæ–¹æ¡ˆä¸€ï¼Œ å› æ­¤æä¾›docker çš„æ–¹æ¡ˆï¼‰</p>
<h3 data-id="heading-6">chrome å®‰è£…</h3>
<h4 data-id="heading-7">æ–¹æ¡ˆä¸€ï¼š</h4>
<h5 data-id="heading-8">1, liunx å…ˆå®‰è£…ä¸€ä¸‹è°·æ­Œæµè§ˆå™¨</h5>
<pre><code class="hljs language-bash" lang="bash">sudo yum install https://dl.google.com/linux/direct/google-chrome-stable_current_x86_64.rpm -y
</code></pre>
<h5 data-id="heading-9">2. å¯åŠ¨æµè§ˆå™¨ æ— å¤´æ¨¡å¼ å¼€æ”¾æœ¬åœ° 9222 ç«¯å£</h5>
<pre><code class="hljs language-bash" lang="bash">google-chrome-stable --no-sandbox --headless --disable-gpu --remote-debugging-port=9222
</code></pre>
<h4 data-id="heading-10">æ–¹æ¡ˆäºŒï¼šï¼ˆæå‰å®‰è£… docker ï¼‰</h4>
<h5 data-id="heading-11">æ‹‰å–é•œåƒ</h5>
<pre><code class="hljs language-bash" lang="bash">docker pull selenium/standalone-chrome
</code></pre>
<h5 data-id="heading-12">è¿è¡Œé•œåƒ</h5>
<pre><code class="hljs language-bash" lang="bash">docker run -d \
  -p 9222:9222 \
  -v /dev/shm:/dev/shm \
  --name chrome-debug \
  --entrypoint google-chrome \
  selenium/standalone-chrome \
  --remote-debugging-address=0.0.0.0 \
  --remote-debugging-port=9222 \
  --no-sandbox \
  --headless
</code></pre>
<h5 data-id="heading-13">æ£€æµ‹æ˜¯å¦è¿è¡ŒæˆåŠŸ</h5>
<pre><code class="hljs language-bash" lang="bash">curl http://localhost:9222/json/version
</code></pre>
<p>è¿è¡ŒæˆåŠŸä¼šè¾“å‡ºå¦‚ä¸‹çš„ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">{
   <span class="hljs-string">"Browser"</span>: <span class="hljs-string">"Chrome/142.0.7444.162"</span>,
   <span class="hljs-string">"Protocol-Version"</span>: <span class="hljs-string">"1.3"</span>,
   <span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/142.0.0.0 Safari/537.36"</span>,
   <span class="hljs-string">"V8-Version"</span>: <span class="hljs-string">"14.2.231.18"</span>,
   <span class="hljs-string">"WebKit-Version"</span>: <span class="hljs-string">"537.36 (@c076baf266c3ed5efb225de664cfa7b183668ad6)"</span>,
   <span class="hljs-string">"webSocketDebuggerUrl"</span>: <span class="hljs-string">"ws://localhost:9222/devtools/browser/5f3804d2-146a-475c-a43a-c5e211387413"</span>
}
</code></pre>
<p>æœ‰å¦‚ä¸Šçš„ä¿¡æ¯ï¼Œæ­å–œä½ ï¼Œå·²ç»å®‰è£…æˆåŠŸäº†ï¼ï¼ï¼</p>
<p>2ï¼Œéƒ¨ç½²ä¸€ä¸‹ puppeteer çš„nodeæœåŠ¡ã€‚
è¿™é‡Œå°±çœ‹çœ‹ä»€ä¹ˆç‰ˆæœ¬çš„ puppeteer äº†ã€‚
æœ¬äººç”¨çš„æ–°ç‰ˆæœ¬çš„ "puppeteer": "^24.29.1"
node &gt; 18 å³å¯ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">npm install //å®‰è£…
node xxx.js // è¿è¡Œ
</code></pre>
<p>å¦‚æœå¤±è´¥äº†ï¼Œé…ç½®é•œåƒä»€ä¹ˆçš„å°±å¥½äº†ã€‚ï¼ˆä¸å¿…è¿‡å¤šèµ˜è¿°ï¼Œå‰ç«¯ä¼°è®¡éƒ½é‡åˆ°è¿‡ï¼‰</p>
<p>å¦‚ç»§ç»­å¤±è´¥ï¼Œè¿˜å¯ä»¥ä½¿ç”¨cnpm</p>
<pre><code class="hljs language-bash" lang="bash">npm i -g cnpm

cnpm install
</code></pre>
<p>å³å¯ï¼Œcnpmå‡ ä¹ä¸ä¼šå¤±è´¥ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">node xxx.js // å°±å¯ä»¥è¿è¡Œäº†ã€‚
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MarsUI å¼•å…¥é¡¹ç›®çš„ä½¿ç”¨è®°å½•]]></title>    <link>https://juejin.cn/post/7574451949325320233</link>    <guid>https://juejin.cn/post/7574451949325320233</guid>    <pubDate>2025-11-20T05:32:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574451949325320233" data-draft-id="7574451949324910633" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MarsUI å¼•å…¥é¡¹ç›®çš„ä½¿ç”¨è®°å½•"/> <meta itemprop="keywords" content="Vue.js,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-20T05:32:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="isixe"/> <meta itemprop="url" content="https://juejin.cn/user/107078962384456"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MarsUI å¼•å…¥é¡¹ç›®çš„ä½¿ç”¨è®°å½•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/107078962384456/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    isixe
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T05:32:58.000Z" title="Thu Nov 20 2025 05:32:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="monokai-sublime">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#23241f}.hljs-subst,.hljs-tag,.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#f8f8f2}.hljs-emphasis,.hljs-strong{color:#a8a8a2}.hljs-bullet,.hljs-link,.hljs-literal,.hljs-number,.hljs-quote,.hljs-regexp{color:#ae81ff}.hljs-code,.hljs-section,.hljs-selector-class,.hljs-title{color:#a6e22e}.hljs-strong{font-weight:700}.hljs-emphasis{font-style:italic}.hljs-attr,.hljs-keyword,.hljs-name,.hljs-selector-tag{color:#f92672}.hljs-attribute,.hljs-symbol{color:#66d9ef}.hljs-class .hljs-title,.hljs-params{color:#f8f8f2}.hljs-addition,.hljs-built_in,.hljs-builtin-name,.hljs-selector-attr,.hljs-selector-id,.hljs-selector-pseudo,.hljs-string,.hljs-template-variable,.hljs-type,.hljs-variable{color:#e6db74}.hljs-comment,.hljs-deletion,.hljs-meta{color:#75715e}</style><p>æœ€è¿‘å‡†å¤‡åšæ•°æ®å¤§å±çš„é¡¹ç›®ï¼Œæ‰¾äº†ä¸€äº›ç›¸å…³çš„UIæ§ä»¶ï¼Œé¡ºç€ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmarsgis%2Fmars3d-vue-example" target="_blank" title="https://github.com/marsgis/mars3d-vue-example" ref="nofollow noopener noreferrer">mars3d-vue-example</a></strong> ç„¶åæˆ‘å°±æ‰¾åˆ°äº†å®ƒå¼€æºçš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmarsgis%2Fmars3d-vue-example%2Ftree%2Fmaster%2Fsrc%2Fcomponents%2Fmars-ui" target="_blank" title="https://github.com/marsgis/mars3d-vue-example/tree/master/src/components/mars-ui" ref="nofollow noopener noreferrer">MarsUI</a> æ§ä»¶ã€‚ä½†æ˜¯è¿™ä¸ªæ§ä»¶åªæœ‰æºæ–‡ä»¶å½¢å¼çš„ï¼Œæ²¡æœ‰ä¸Šä¼ åˆ° npm åº“ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¾—æ‰‹åŠ¨å¼•å…¥äº†ã€‚</p>
<h2 data-id="heading-0">ä¾èµ–å®‰è£…</h2>
<p>Mars3d çš„å¼€æºæ¨¡æ¿é¡¹ç›® <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmarsgis%2Fmars3d-vue-example" target="_blank" title="https://github.com/marsgis/mars3d-vue-example" ref="nofollow noopener noreferrer">mars3d-vue-example</a></strong> ä¸­ï¼Œæä¾›æœ‰ä¸€å¥—å®Œæ•´çš„æ§ä»¶æ ·æ¿çš„æºç æ–‡ä»¶ï¼Œè¿™äº›åŸºç¡€æ§ä»¶æ˜¯åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.antdv.com%2Fcomponents%2Foverview-cn%2F" target="_blank" title="https://www.antdv.com/components/overview-cn/" ref="nofollow noopener noreferrer">Ant Design Vue</a> ç»„ä»¶åº“çš„åŸºç¡€ä¸Šè¿›è¡Œç¼–å†™çš„ï¼ŒMard3d ä¸»è¦å°è£…äº†è¡¨å•æ§ä»¶ï¼Œæ‰€ä»¥æ‰€æœ‰æ§ä»¶ä¾èµ–äº <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.antdv.com%2Fcomponents%2Foverview-cn%2F" target="_blank" title="https://www.antdv.com/components/overview-cn/" ref="nofollow noopener noreferrer">Ant Design Vue</a>  ç»„ä»¶åº“ã€‚</p>
<p>è™½ç„¶åœ¨ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmarsgis%2Fmars3d-vue-example" target="_blank" title="https://github.com/marsgis/mars3d-vue-example" ref="nofollow noopener noreferrer">mars3d-vue-example</a></strong> ä¸­åˆ—å‡ºçš„ç›¸å…³ä¾èµ–ï¼Œä½†æ˜¯è¿™å¹¶ä¸å®Œå…¨</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83ca6cf7e5d449dba0b67f98199871bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaXNpeGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764221578&amp;x-signature=CN9AcN2D8lDGBdLZg64%2Fy3MxB3E%3D" alt="image.png" loading="lazy"/></p>
<p>å®é™…éœ€è¦çš„å®Œæ•´ä¾èµ–è¿˜å¾—è¡¥å…… 3 ä¸ªï¼Œç¼ºå°‘äº† lodash-esã€dayjs å’Œ less è¿™ä¸‰ä¸ªä¾èµ–</p>
<pre><code class="hljs language-json" lang="json">  <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"@icon-park/svg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^1.4.2"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"@turf/turf"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^7.2.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"ant-design-vue"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^4.0.7"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"consola"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^3.2.3"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"echarts"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^5.4.3"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"nprogress"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^0.2.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"vite-plugin-style-import"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^2.0.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"vue-color-kit"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^1.0.6"</span>
    <span class="hljs-comment">// ä»»æ„ç‰ˆæœ¬å®‰è£…</span>
    <span class="hljs-attr">"vue"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^3.5.13"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lodash-es"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^4.17.21"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"dayjs"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^1.11.19"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"less"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^4.4.2"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
</code></pre>
<p>æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ pnpm å¿«é€Ÿå®‰è£…</p>
<pre><code class="hljs language-sh" lang="sh">npm install @icon-park/svg@^1.4.2 @turf/turf@^7.2.0 ant-design-vue@^4.0.7 consola@^3.2.3 echarts@^5.4.3 nprogress@^0.2.0 vite-plugin-style-import@^2.0.0 vue-color-kit@^1.0.6 vue lodash-es dayjs less

//or

yarn install @icon-park/svg@^1.4.2 @turf/turf@^7.2.0 ant-design-vue@^4.0.7 consola@^3.2.3 echarts@^5.4.3 nprogress@^0.2.0 vite-plugin-style-import@^2.0.0 vue-color-kit@^1.0.6 vue lodash-es dayjs less

//or

pnpm add @icon-park/svg@^1.4.2 @turf/turf@^7.2.0 ant-design-vue@^4.0.7 consola@^3.2.3 echarts@^5.4.3 nprogress@^0.2.0 vite-plugin-style-import@^2.0.0 vue-color-kit@^1.0.6 vue lodash-es dayjs less
</code></pre>
<h2 data-id="heading-1">ç»„ä»¶å¼•å…¥</h2>
<p>æˆ‘ä»¬éœ€è¦å°† <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmarsgis%2Fmars3d-vue-example" target="_blank" title="https://github.com/marsgis/mars3d-vue-example" ref="nofollow noopener noreferrer">mars3d-vue-example</a></strong> çš„é¡¹ç›®æ–‡ä»¶æ‹‰å–ä¸‹æ¥ï¼Œç„¶åæŠŠ components/mars-ui è¿™ä¸ªæ–‡ä»¶å¤¹æ•´ä¸ªå¤åˆ¶åˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67e3c2a0e096470f811a456fef3ba3d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaXNpeGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764221578&amp;x-signature=ydrnm0OBWo3D4aeJWbprspnO2gU%3D" alt="image.png" loading="lazy"/></p>
<p>ç„¶ååœ¨ main.js ä¸­è¿›è¡Œç»„ä»¶çš„æ‰¹é‡æ³¨å†Œ</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">MarsUIInstall</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"@mars/components/mars-ui"</span>

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">Application</span>)

<span class="hljs-title class_">MarsUIInstall</span>(app)
</code></pre>
<h2 data-id="heading-2">é…ç½® Antdv å’Œ å¼•å…¥ Less æ ·å¼æ–‡ä»¶</h2>
<p>å‰é¢æˆ‘ä»¬æåˆ° MarsUI æ˜¯ä¾èµ–äº Antdvï¼Œå¹¶ä¸”åœ¨ç»„ä»¶ä¸­ä½¿ç”¨äº† Lessï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ vite.config.js ä¸­å¢åŠ ä¸‹é¢çš„é…ç½®</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { createStyleImportPlugin, <span class="hljs-title class_">AndDesignVueResolve</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"vite-plugin-style-import"</span>
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">css</span>: {
    <span class="hljs-attr">preprocessorOptions</span>: {
      <span class="hljs-attr">less</span>: {
        <span class="hljs-attr">javascriptEnabled</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">additionalData</span>: <span class="hljs-string">`@import "<span class="hljs-subst">${path.resolve(
          __dirname,
          <span class="hljs-string">"src/components/mars-ui/base.less"</span>
        )}</span>";`</span>,
      },
    },
  },
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-title function_">vue</span>(),
    <span class="hljs-title function_">createStyleImportPlugin</span>({
      <span class="hljs-attr">resolves</span>: [<span class="hljs-title class_">AndDesignVueResolve</span>()],
      <span class="hljs-attr">libs</span>: [
        {
          <span class="hljs-attr">libraryName</span>: <span class="hljs-string">"ant-design-vue"</span>,
          <span class="hljs-attr">esModule</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">resolveStyle</span>: <span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
            <span class="hljs-keyword">if</span> (name === <span class="hljs-string">"auto-complete"</span>) {
              <span class="hljs-keyword">return</span> <span class="hljs-string">`ant-design-vue/es/<span class="hljs-subst">${name}</span>/index`</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-string">`ant-design-vue/es/<span class="hljs-subst">${name}</span>/style/index`</span>;
          },
        },
      ],
    }),
  ],
});
</code></pre>
<p>é…ç½®å®Œæˆï¼Œé‡å¯ä¸€ä¸‹é¡¹ç›®æˆ‘ä»¬å°±èƒ½åœ¨é¡¹ç›®ä¸­æŒ‰éœ€å¯¼å…¥ MarsUI çš„æ§ä»¶äº†ã€‚</p>
<h2 data-id="heading-3">å‚è€ƒ</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmarsgis%2Fmars3d-vue-example%2Ftree%2Fmaster%2Fsrc%2Fcomponents%2Fmars-ui" target="_blank" title="https://github.com/marsgis/mars3d-vue-example/tree/master/src/components/mars-ui" ref="nofollow noopener noreferrer">mars3d-vue-example - mars-ui</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvbenjs%2Fvite-plugin-style-import%2Fblob%2Fmain%2FREADME.zh_CN.md" target="_blank" title="https://github.com/vbenjs/vite-plugin-style-import/blob/main/README.zh_CN.md" ref="nofollow noopener noreferrer">vite-plugin-style-import</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ Vue3 å“åº”å¼ç³»ç»Ÿï¼šæ‰‹å†™ Computed å’Œ Watch çš„å¥¥ç§˜]]></title>    <link>https://juejin.cn/post/7574625040630759462</link>    <guid>https://juejin.cn/post/7574625040630759462</guid>    <pubDate>2025-11-20T05:36:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574625040630759462" data-draft-id="7574040813749911603" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ Vue3 å“åº”å¼ç³»ç»Ÿï¼šæ‰‹å†™ Computed å’Œ Watch çš„å¥¥ç§˜"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2025-11-20T05:36:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº‘æ«æ™–"/> <meta itemprop="url" content="https://juejin.cn/user/835284567331021"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ Vue3 å“åº”å¼ç³»ç»Ÿï¼šæ‰‹å†™ Computed å’Œ Watch çš„å¥¥ç§˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/835284567331021/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº‘æ«æ™–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T05:36:18.000Z" title="Thu Nov 20 2025 05:36:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœ¨ Vue3 çš„å“åº”å¼ç³»ç»Ÿä¸­ï¼Œè®¡ç®—å±æ€§å’Œç›‘å¬å™¨æ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­é¢‘ç¹ä½¿ç”¨çš„ç‰¹æ€§ã€‚ä½†ä½ çŸ¥é“å®ƒä»¬èƒŒåçš„å®ç°åŸç†å—ï¼Ÿæœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œæ‰‹å†™å®ç°Â <code>computed</code>Â å’ŒÂ <code>watch</code>ï¼Œæ·±å…¥ç†è§£å…¶è®¾è®¡æ€æƒ³å’Œå®ç°ç»†èŠ‚ã€‚</p>
</blockquote>
<h2 data-id="heading-0">å¼•è¨€ï¼šä¸ºä»€ä¹ˆéœ€è¦è®¡ç®—å±æ€§å’Œç›‘å¬å™¨ï¼Ÿ</h2>
<p>åœ¨Vueåº”ç”¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°è¿™æ ·çš„åœºæ™¯ï¼š</p>
<ul>
<li><strong>æ´¾ç”ŸçŠ¶æ€</strong>ï¼šåŸºäºç°æœ‰çŠ¶æ€è®¡ç®—æ–°çš„æ•°æ®</li>
<li><strong>å‰¯ä½œç”¨å¤„ç†</strong>ï¼šå½“ç‰¹å®šæ•°æ®å˜åŒ–æ—¶æ‰§è¡Œç›¸åº”æ“ä½œ</li>
</ul>
<p>Vue3æä¾›äº†<code>computed</code>å’Œ<code>watch</code>æ¥ä¼˜é›…è§£å†³è¿™äº›é—®é¢˜ã€‚ä½†ä»…ä»…ä¼šä½¿ç”¨è¿˜ä¸å¤Ÿï¼Œæ·±å…¥ç†è§£å…¶åº•å±‚åŸç†èƒ½è®©æˆ‘ä»¬åœ¨å¤æ‚åœºæ™¯ä¸‹æ›´åŠ å¾—å¿ƒåº”æ‰‹ã€‚</p>
<h2 data-id="heading-1">æ‰‹å†™å®ç°Computed</h2>
<p><code>computed</code>çš„æ ¸å¿ƒç‰¹æ€§åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>æƒ°æ€§è®¡ç®—</strong>ï¼šåªæœ‰ä¾èµ–çš„å“åº”å¼æ•°æ®å˜åŒ–æ—¶æ‰é‡æ–°è®¡ç®—</li>
<li><strong>å€¼ç¼“å­˜</strong>ï¼šé¿å…é‡å¤è®¡ç®—æå‡æ€§èƒ½</li>
<li><strong>ä¾èµ–è¿½è¸ª</strong>ï¼šè‡ªåŠ¨æ”¶é›†ä¾èµ–å…³ç³»</li>
</ul>
<p><code>computed</code>å‡½æ•°æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œç±»å‹å‡½æ•°æˆ–è€…ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡åŒ…å«<code>get</code>å’Œ<code>set</code>æ–¹æ³•ï¼Œ<code>get</code>æ–¹æ³•æ˜¯å¿…é¡»å¾—ã€‚åŸºæœ¬æ¡†æ¶å°±å‡ºæ¥äº†ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">computed</span>(<span class="hljs-params">getterOrOptions</span>) {
  <span class="hljs-keyword">let</span> getter;
  <span class="hljs-keyword">let</span> setter = <span class="hljs-literal">undefined</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isFunction</span>(getterOrOptions)) {
    getter = getterOrOptions
  } <span class="hljs-keyword">else</span> {
    getter = getterOrOptions.<span class="hljs-property">get</span>;
    setter = getterOrOptions.<span class="hljs-property">set</span>;
  }
}
</code></pre>
<p>å½“ä½ ä½¿ç”¨è¿‡<code>computed</code>å‡½æ•°æ—¶ï¼Œä½ ä¼šå‘ç°ä¼šè¿”å›ä¸€ä¸ª<code>ComputedRefImpl</code>ç±»å‹çš„å®ä¾‹ã€‚ä»£ç å°±å¯ä»¥è¿›ä¸€æ­¥å†™æˆä¸‹é¢çš„æ ·å­ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ComputedRefImpl</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">getter, setter</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">getter</span> = getter;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">setter</span> = <span class="hljs-title function_">isFunction</span>(setter) ? setter : <span class="hljs-literal">undefined</span>;
  }
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">computed</span>(<span class="hljs-params">getterOrOptions</span>) {
  <span class="hljs-comment">/* ä¸Šè¿°ä»£ç å®ç°çœç•¥ */</span>
  <span class="hljs-keyword">const</span> cRef = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ComputedRefImpl</span>(getter, setter);
  <span class="hljs-keyword">return</span> cRef;
}
</code></pre>
<h3 data-id="heading-2">ComputedRefImplçš„å®ç°</h3>
<p>åœ¨<code>ComputedRefImpl</code>ç±»ä¸­æœ‰å‡ ä¸ªä¸»è¦çš„å±æ€§ï¼š</p>
<ul>
<li><code>_value</code>ï¼šç¼“å­˜çš„è®¡ç®—ç»“æœ</li>
<li><code>_v_isRef</code>ï¼šè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªrefå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡.valueè®¿é—®</li>
<li><code>effect</code> å“åº”å¼å‰¯ä½œç”¨å®ä¾‹</li>
<li><code>_dirty</code> è„å€¼æ ‡è®°ï¼Œtrueè¡¨ç¤ºéœ€è¦é‡æ–°è®¡ç®—</li>
<li><code>dep</code> ä¾èµ–æ”¶é›†å®¹å™¨ï¼Œå­˜å‚¨ä¾èµ–å½“å‰è®¡ç®—å±æ€§çš„å‰¯ä½œç”¨
åœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå°†ä¼šåˆ›å»ºä¸€ä¸ª<code>ReactiveEffect</code>å®ä¾‹ï¼Œæ­¤ç±»å‹åœ¨<a href="https://juejin.cn/post/7573694361474793499" target="_blank" title="https://juejin.cn/post/7573694361474793499">æ‰‹å†™Reactive</a>ä¸­å®ç°äº†ã€‚</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ComputedRefImpl</span> {
  effect = <span class="hljs-literal">undefined</span>; <span class="hljs-comment">// å“åº”å¼å‰¯ä½œç”¨å®ä¾‹</span>
  _value = <span class="hljs-literal">undefined</span>; <span class="hljs-comment">// ç¼“å­˜çš„è®¡ç®—ç»“æœ</span>
  __v_isRef = <span class="hljs-literal">true</span>; <span class="hljs-comment">// æ ‡è¯†è¿™æ˜¯ä¸€ä¸ªrefå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡.valueè®¿é—®</span>
  _dirty = <span class="hljs-literal">true</span>; <span class="hljs-comment">// è„å€¼æ ‡è®°ï¼Œtrueè¡¨ç¤ºéœ€è¦é‡æ–°è®¡ç®—</span>
  dep = <span class="hljs-literal">undefined</span>; <span class="hljs-comment">// ä¾èµ–æ”¶é›†å®¹å™¨ï¼Œå­˜å‚¨ä¾èµ–å½“å‰è®¡ç®—å±æ€§çš„å‰¯ä½œç”¨</span>

  <span class="hljs-comment">/**
   * æ„é€ å‡½æ•°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} <span class="hljs-variable">getter</span> - è®¡ç®—å±æ€§çš„getterå‡½æ•°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} <span class="hljs-variable">setter</span> - è®¡ç®—å±æ€§çš„setterå‡½æ•°
   */</span>
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">getter, setter</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">getter</span> = getter;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">setter</span> = <span class="hljs-title function_">isFunction</span>(setter) ? setter : <span class="hljs-function">() =&gt;</span> {};

    <span class="hljs-comment">// åˆ›å»ºå“åº”å¼å‰¯ä½œç”¨å®ä¾‹ï¼Œå½“ä¾èµ–çš„æ•°æ®å˜åŒ–æ—¶ä¼šè§¦å‘è°ƒåº¦å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">effect</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReactiveEffect</span>(getter, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// è°ƒåº¦å™¨å‡½æ•° åç»­å¤„ç†</span>
    });
  }
}
</code></pre>
<p>é€šè¿‡<code>get value</code>å’Œ<code>set value</code>æ‰‹æœºä¾èµ–å’Œè§¦å‘ä¾èµ–</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ComputedRefImpl</span> {
  <span class="hljs-comment">/* ä¸Šè¿°ä»£ç å®ç°çœç•¥ */</span>
  <span class="hljs-comment">/**
   * è®¡ç®—å±æ€§çš„getter
   * å®ç°ç¼“å­˜æœºåˆ¶å’Œä¾èµ–æ”¶é›†
   */</span>
  <span class="hljs-keyword">get</span> <span class="hljs-title function_">value</span>() {
    <span class="hljs-comment">// å¦‚æœå­˜åœ¨æ¿€æ´»çš„å‰¯ä½œç”¨ï¼Œåˆ™è¿›è¡Œä¾èµ–æ”¶é›†</span>
    <span class="hljs-keyword">if</span> (activeEffect) {
      <span class="hljs-title function_">trackEffects</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dep</span> || (<span class="hljs-variable language_">this</span>.<span class="hljs-property">dep</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>()));
    }

    <span class="hljs-comment">// å¦‚æœæ˜¯è„å€¼ï¼Œåˆ™é‡æ–°è®¡ç®—å¹¶ç¼“å­˜ç»“æœ</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_dirty</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">_value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">effect</span>.<span class="hljs-title function_">run</span>(); <span class="hljs-comment">// æ‰§è¡Œgetterå‡½æ•°è·å–æ–°å€¼</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">_dirty</span> = <span class="hljs-literal">false</span>; <span class="hljs-comment">// æ¸…é™¤è„å€¼æ ‡è®°</span>
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_value</span>; <span class="hljs-comment">// è¿”å›ç¼“å­˜çš„å€¼</span>
  }

  <span class="hljs-comment">/**
   * è®¡ç®—å±æ€§çš„setter
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">any</span>} <span class="hljs-variable">newValue</span> - æ–°çš„å€¼
   */</span>
  <span class="hljs-keyword">set</span> <span class="hljs-title function_">value</span>(<span class="hljs-params">newValue</span>) {
    <span class="hljs-comment">// å¦‚æœæœ‰setterå‡½æ•°ï¼Œåˆ™è°ƒç”¨å®ƒ</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">setter</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setter</span>(newValue);
    }
  }
}
</code></pre>
<p>å½“ä¾èµ–å€¼å‘ç”Ÿå˜åŒ–åï¼Œå°†è§¦å‘å‰¯ä½œç”¨çš„è°ƒåº¦å™¨ï¼Œè§¦å‘è®¡ç®—å±æ€§çš„å‰¯ä½œç”¨æ›´æ–°ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">constructor</span>(<span class="hljs-params">getter, setter</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">getter</span> = getter;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">setter</span> = <span class="hljs-title function_">isFunction</span>(setter) ? setter : <span class="hljs-function">() =&gt;</span> {};

  <span class="hljs-comment">// åˆ›å»ºå“åº”å¼å‰¯ä½œç”¨å®ä¾‹ï¼Œå½“ä¾èµ–çš„æ•°æ®å˜åŒ–æ—¶ä¼šè§¦å‘è°ƒåº¦å™¨</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">effect</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReactiveEffect</span>(getter, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// è°ƒåº¦å™¨å‡½æ•°ï¼šå½“ä¾èµ–å˜åŒ–æ—¶æ‰§è¡Œ</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_dirty</span> = <span class="hljs-literal">true</span>; <span class="hljs-comment">// æ ‡è®°ä¸ºè„å€¼ï¼Œä¸‹æ¬¡è®¿é—®æ—¶éœ€è¦é‡æ–°è®¡ç®—</span>
    <span class="hljs-title function_">triggerEffects</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dep</span>); <span class="hljs-comment">// è§¦å‘ä¾èµ–å½“å‰è®¡ç®—å±æ€§çš„å‰¯ä½œç”¨æ›´æ–°</span>
  });
}
</code></pre>
<h3 data-id="heading-3">å®Œæ•´ä»£ç åŠç”¨æ³•ç¤ºä¾‹</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { isFunction } <span class="hljs-keyword">from</span> <span class="hljs-string">"./utils"</span>;
<span class="hljs-keyword">import</span> {
  activeEffect,
  <span class="hljs-title class_">ReactiveEffect</span>,
  trackEffects,
  triggerEffects,
} <span class="hljs-keyword">from</span> <span class="hljs-string">"./effect"</span>;

<span class="hljs-comment">/**
 * è®¡ç®—å±æ€§å®ç°ç±»
 * è´Ÿè´£ç®¡ç†è®¡ç®—å±æ€§çš„getterã€setterä»¥åŠç¼“å­˜æœºåˆ¶
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ComputedRefImpl</span> {
  effect = <span class="hljs-literal">undefined</span>; <span class="hljs-comment">// å“åº”å¼å‰¯ä½œç”¨å®ä¾‹</span>
  _value = <span class="hljs-literal">undefined</span>; <span class="hljs-comment">// ç¼“å­˜çš„è®¡ç®—ç»“æœ</span>
  __v_isRef = <span class="hljs-literal">true</span>; <span class="hljs-comment">// æ ‡è¯†è¿™æ˜¯ä¸€ä¸ªrefå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡.valueè®¿é—®</span>
  _dirty = <span class="hljs-literal">true</span>; <span class="hljs-comment">// è„å€¼æ ‡è®°ï¼Œtrueè¡¨ç¤ºéœ€è¦é‡æ–°è®¡ç®—</span>
  dep = <span class="hljs-literal">undefined</span>; <span class="hljs-comment">// ä¾èµ–æ”¶é›†å®¹å™¨ï¼Œå­˜å‚¨ä¾èµ–å½“å‰è®¡ç®—å±æ€§çš„å‰¯ä½œç”¨</span>

  <span class="hljs-comment">/**
   * æ„é€ å‡½æ•°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} <span class="hljs-variable">getter</span> - è®¡ç®—å±æ€§çš„getterå‡½æ•°
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} <span class="hljs-variable">setter</span> - è®¡ç®—å±æ€§çš„setterå‡½æ•°
   */</span>
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">getter, setter</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">getter</span> = getter;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">setter</span> = <span class="hljs-title function_">isFunction</span>(setter) ? setter : <span class="hljs-function">() =&gt;</span> {};

    <span class="hljs-comment">// åˆ›å»ºå“åº”å¼å‰¯ä½œç”¨å®ä¾‹ï¼Œå½“ä¾èµ–çš„æ•°æ®å˜åŒ–æ—¶ä¼šè§¦å‘è°ƒåº¦å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">effect</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReactiveEffect</span>(getter, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// è°ƒåº¦å™¨å‡½æ•°ï¼šå½“ä¾èµ–å˜åŒ–æ—¶æ‰§è¡Œ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">_dirty</span> = <span class="hljs-literal">true</span>; <span class="hljs-comment">// æ ‡è®°ä¸ºè„å€¼ï¼Œä¸‹æ¬¡è®¿é—®æ—¶éœ€è¦é‡æ–°è®¡ç®—</span>
      <span class="hljs-title function_">triggerEffects</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dep</span>); <span class="hljs-comment">// è§¦å‘ä¾èµ–å½“å‰è®¡ç®—å±æ€§çš„å‰¯ä½œç”¨æ›´æ–°</span>
    });
  }

  <span class="hljs-comment">/**
   * è®¡ç®—å±æ€§çš„getter
   * å®ç°ç¼“å­˜æœºåˆ¶å’Œä¾èµ–æ”¶é›†
   */</span>
  <span class="hljs-keyword">get</span> <span class="hljs-title function_">value</span>() {
    <span class="hljs-comment">// å¦‚æœå­˜åœ¨æ¿€æ´»çš„å‰¯ä½œç”¨ï¼Œåˆ™è¿›è¡Œä¾èµ–æ”¶é›†</span>
    <span class="hljs-keyword">if</span> (activeEffect) {
      <span class="hljs-title function_">trackEffects</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dep</span> || (<span class="hljs-variable language_">this</span>.<span class="hljs-property">dep</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>()));
    }

    <span class="hljs-comment">// å¦‚æœæ˜¯è„å€¼ï¼Œåˆ™é‡æ–°è®¡ç®—å¹¶ç¼“å­˜ç»“æœ</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_dirty</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">_value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">effect</span>.<span class="hljs-title function_">run</span>(); <span class="hljs-comment">// æ‰§è¡Œgetterå‡½æ•°è·å–æ–°å€¼</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">_dirty</span> = <span class="hljs-literal">false</span>; <span class="hljs-comment">// æ¸…é™¤è„å€¼æ ‡è®°</span>
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_value</span>; <span class="hljs-comment">// è¿”å›ç¼“å­˜çš„å€¼</span>
  }

  <span class="hljs-comment">/**
   * è®¡ç®—å±æ€§çš„setter
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">any</span>} <span class="hljs-variable">newValue</span> - æ–°çš„å€¼
   */</span>
  <span class="hljs-keyword">set</span> <span class="hljs-title function_">value</span>(<span class="hljs-params">newValue</span>) {
    <span class="hljs-comment">// å¦‚æœæœ‰setterå‡½æ•°ï¼Œåˆ™è°ƒç”¨å®ƒ</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">setter</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setter</span>(newValue);
    }
  }
}

<span class="hljs-comment">/**
 * åˆ›å»ºè®¡ç®—å±æ€§çš„å·¥å‚å‡½æ•°
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function|Object</span>} <span class="hljs-variable">getterOrOptions</span> - getterå‡½æ•°æˆ–åŒ…å«get/setçš„å¯¹è±¡
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">ComputedRefImpl</span>} è®¡ç®—å±æ€§å¼•ç”¨å®ä¾‹
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">computed</span> = (<span class="hljs-params">getterOrOptions</span>) =&gt; {
  <span class="hljs-keyword">let</span> getter; <span class="hljs-comment">// getterå‡½æ•°</span>
  <span class="hljs-keyword">let</span> setter = <span class="hljs-literal">undefined</span>; <span class="hljs-comment">// setterå‡½æ•°</span>

  <span class="hljs-comment">// æ ¹æ®å‚æ•°ç±»å‹ç¡®å®šgetterå’Œsetter</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isFunction</span>(getterOrOptions)) {
    <span class="hljs-comment">// å¦‚æœå‚æ•°æ˜¯å‡½æ•°ï¼Œåˆ™ä½œä¸ºgetter</span>
    getter = getterOrOptions;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// å¦‚æœå‚æ•°æ˜¯å¯¹è±¡ï¼Œåˆ™åˆ†åˆ«è·å–getå’Œsetæ–¹æ³•</span>
    getter = getterOrOptions.<span class="hljs-property">get</span>;
    setter = getterOrOptions.<span class="hljs-property">set</span>;
  }

  <span class="hljs-comment">// åˆ›å»ºå¹¶è¿”å›è®¡ç®—å±æ€§å®ä¾‹</span>
  <span class="hljs-keyword">const</span> cRef = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ComputedRefImpl</span>(getter, setter);
  <span class="hljs-keyword">return</span> cRef;
};
</code></pre>
<p>ç¤ºä¾‹ç”¨æ³•ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { reactive, computed } <span class="hljs-keyword">from</span> <span class="hljs-string">"./packages/index"</span>;
<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">firstName</span>: <span class="hljs-string">"tom"</span>,
  <span class="hljs-attr">lastName</span>: <span class="hljs-string">"lee"</span>,
  <span class="hljs-attr">friends</span>: [<span class="hljs-string">"jacob"</span>, <span class="hljs-string">"james"</span>, <span class="hljs-string">"jimmy"</span>],
});
<span class="hljs-keyword">const</span> fullName = <span class="hljs-title function_">computed</span>({
  <span class="hljs-title function_">get</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> state.<span class="hljs-property">firstName</span> + <span class="hljs-string">" "</span> + state.<span class="hljs-property">lastName</span>;
  },
  <span class="hljs-title function_">set</span>(<span class="hljs-params">newValue</span>) {
    [state.<span class="hljs-property">firstName</span>, state.<span class="hljs-property">lastName</span>] = newValue.<span class="hljs-title function_">split</span>(<span class="hljs-string">" "</span>);
  },
});
<span class="hljs-title function_">effect</span>(<span class="hljs-function">() =&gt;</span> {
  app.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`
    &lt;div&gt; Welcome <span class="hljs-subst">${fullName.value}</span> !&lt;/div&gt;
  `</span>;
});
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  fullName.<span class="hljs-property">value</span> = <span class="hljs-string">"jacob him"</span>;
}, <span class="hljs-number">1000</span>);
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(state.<span class="hljs-property">firstName</span>, state.<span class="hljs-property">lastName</span>); <span class="hljs-comment">// firstName: jacob lastName: him </span>
}, <span class="hljs-number">2000</span>);

</code></pre>
<h2 data-id="heading-4">æ‰‹å†™å®ç°Watchå’ŒWatchEffect</h2>
<p><code>watch</code>å‡½æ•°æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š</p>
<ul>
<li><code>source</code>ï¼šè¦ç›‘å¬çš„æ•°æ®æºï¼Œå¯ä»¥æ˜¯å“åº”å¼å¯¹è±¡æˆ–å‡½æ•°</li>
<li><code>cb</code>ï¼šæ•°æ®å˜åŒ–æ—¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°</li>
<li><code>options</code> é…ç½®é€‰é¡¹ï¼šimmediateï¼šæ˜¯å¦ç«‹å³æ‰§è¡Œï¼Œdeepï¼šæ˜¯å¦æ·±åº¦ç›‘å¬ç­‰</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">watch</span>(<span class="hljs-params">source, cb, {immediate = <span class="hljs-literal">false</span>} = {}</span>) {
 <span class="hljs-comment">// å¾…åç»­å®ç°</span>
}
</code></pre>
<h3 data-id="heading-5">1. watchçš„å®ç°</h3>
<p>é¦–å…ˆ<code>source</code>æ˜¯å¦å¯ä»¥æ¥å—å¤šç§ç›‘å¬çš„æ•°æ®æºï¼šå“åº”å¼å¯¹è±¡ã€å¤šä¸ªç›‘å¬æ•°æ®æºçš„æ•°ç»„ã€å‡½æ•°ã€‚å°†ä¸åŒæ–¹å¼ç»Ÿä¸€èµ·æ¥ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">watch</span>(<span class="hljs-params">source, cb, { immediate = <span class="hljs-literal">false</span> } = {}</span>) {
  <span class="hljs-keyword">let</span> getter;
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isReactive</span>(source)) {
    <span class="hljs-comment">// å¦‚æœæ˜¯å“åº”å¼å¯¹è±¡ åˆ™è°ƒç”¨traverse</span>
    getter = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">traverse</span>(source);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isFunction</span>(source)) {
    <span class="hljs-comment">// å¦‚æœæ˜¯å‡½æ•° åˆ™ç›´æ¥æ‰§è¡Œ</span>
    getter = source;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isArray</span>(source)) {
    <span class="hljs-comment">// å¤„ç†æ•°ç»„ç±»å‹çš„ç›‘å¬æº</span>
    getter = <span class="hljs-function">() =&gt;</span>
      source.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">s</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isReactive</span>(s)) {
          <span class="hljs-keyword">return</span> <span class="hljs-title function_">traverse</span>(s);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isFunction</span>(s)) {
          <span class="hljs-keyword">return</span> <span class="hljs-title function_">s</span>();
        }
      });
  }
}
<span class="hljs-comment">/**
 * éå†å¯¹è±¡åŠå…¶åµŒå¥—å±æ€§çš„å‡½æ•°
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">any</span>} <span class="hljs-variable">source</span> - éœ€è¦éå†çš„æºæ•°æ®
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Set</span>} <span class="hljs-variable">s</span> - ç”¨äºè®°å½•å·²è®¿é—®å¯¹è±¡çš„é›†åˆï¼Œé¿å…å¾ªç¯å¼•ç”¨
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">any</span>} è¿”å›åŸå§‹è¾“å…¥æ•°æ®
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">traverse</span>(<span class="hljs-params">source, s = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>()</span>) {
  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸ºå¯¹è±¡ç±»å‹ï¼Œå¦‚æœä¸æ˜¯åˆ™ç›´æ¥è¿”å›</span>
  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isObject</span>(source)) {
    <span class="hljs-keyword">return</span> source;
  }
  <span class="hljs-comment">// æ£€æµ‹å¾ªç¯å¼•ç”¨ï¼Œå¦‚æœå¯¹è±¡å·²è¢«è®¿é—®è¿‡åˆ™ç›´æ¥è¿”å›</span>
  <span class="hljs-keyword">if</span> (s.<span class="hljs-title function_">has</span>(source)) {
    <span class="hljs-keyword">return</span> source;
  }
  <span class="hljs-comment">// å°†å½“å‰å¯¹è±¡åŠ å…¥å·²è®¿é—®é›†åˆ</span>
  s.<span class="hljs-title function_">add</span>(source);
  <span class="hljs-comment">// é€’å½’éå†å¯¹è±¡çš„æ‰€æœ‰å±æ€§</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> source) {
    <span class="hljs-title function_">traverse</span>(source[key], s);
  }
  <span class="hljs-keyword">return</span> source;
}
</code></pre>
<p>å¤„ç†å®Œ<code>souce</code>å‚æ•°åï¼Œåˆ›å»ºä¸€ä¸ª<code>ReactiveEffect</code>å®ä¾‹ï¼Œå¯¹ç›‘å¬æºäº§ç”Ÿå“åº”å¼çš„å‰¯ä½œç”¨ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">watch</span>(<span class="hljs-params">source, cb, { immediate = <span class="hljs-literal">false</span> } = {}</span>) {
  <span class="hljs-comment">/* ä¸Šè¿°ä»£ç ä»¥å®ç°çœç•¥ */</span>
  <span class="hljs-keyword">let</span> oldValue;
  <span class="hljs-comment">// å®šä¹‰å‰¯ä½œç”¨æ‰§è¡Œçš„ä»»åŠ¡å‡½æ•°</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">job</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">let</span> newValue = effect.<span class="hljs-title function_">run</span>(); <span class="hljs-comment">// è·å–æœ€æ–°å€¼</span>
    <span class="hljs-title function_">cb</span>(oldValue, newValue); <span class="hljs-comment">// è§¦å‘å›è°ƒ</span>
    oldValue = newValue; <span class="hljs-comment">// æ–°å€¼èµ‹ç»™æ—§å€¼</span>
  };

  <span class="hljs-comment">// åˆ›å»ºå“åº”å¼å‰¯ä½œç”¨å®ä¾‹</span>
  <span class="hljs-keyword">const</span> effect = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReactiveEffect</span>(getter, job);
  <span class="hljs-keyword">if</span> (immediate) {
    <span class="hljs-title function_">job</span>();
  } <span class="hljs-keyword">else</span> {
    oldValue = effect.<span class="hljs-title function_">run</span>();
  }
}
</code></pre>
<blockquote>
<p><strong>âš ï¸ æ€§èƒ½æ³¨æ„</strong></p>
<p><code>traverse</code>å‡½æ•°ä¼šé€’å½’éå†å¯¹è±¡çš„æ‰€æœ‰åµŒå¥—å±æ€§ï¼Œåœ¨å¤§å‹æ•°æ®ç»“æ„ä¸Šä½¿ç”¨æ·±åº¦ç›‘å¬(<code>deep: true</code>)æ—¶ä¼šäº§ç”Ÿæ˜¾è‘—æ€§èƒ½å¼€é”€ã€‚å»ºè®®ï¼š</p>
<ul>
<li>åªåœ¨å¿…è¦æ—¶ä½¿ç”¨æ·±åº¦ç›‘å¬</li>
<li>å°½é‡ä½¿ç”¨å…·ä½“çš„å±æ€§è·¯å¾„è€Œéæ•´ä¸ªå¯¹è±¡</li>
<li>è€ƒè™‘ä½¿ç”¨è®¡ç®—å±æ€§æ¥æ´¾ç”Ÿéœ€è¦ç›‘å¬çš„æ•°æ®</li>
</ul>
</blockquote>
<h3 data-id="heading-6">2. watchEffectçš„å®ç°</h3>
<p>å®ç°äº†<code>watch</code>å‡½æ•°åï¼ŒwatchEffectçš„å®ç°å°±å®¹æ˜“äº†ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// watchEffect.js</span>
<span class="hljs-keyword">import</span> { watch } <span class="hljs-keyword">from</span> <span class="hljs-string">"./watch"</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">watchEffect</span>(<span class="hljs-params">effect, options</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">watch</span>(effect, <span class="hljs-literal">null</span>, options);
}
<span class="hljs-comment">// watch.js</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">job</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (cb) {
    <span class="hljs-keyword">let</span> newValue = effect.<span class="hljs-title function_">run</span>(); <span class="hljs-comment">// è·å–æœ€æ–°å€¼</span>
    <span class="hljs-title function_">cb</span>(oldValue, newValue); <span class="hljs-comment">// è§¦å‘å›è°ƒ</span>
    oldValue = newValue; <span class="hljs-comment">// æ–°å€¼èµ‹ç»™æ—§å€¼</span>
  } <span class="hljs-keyword">else</span> {
    effect.<span class="hljs-title function_">run</span>(); <span class="hljs-comment">// å¤„ç†watchEffect</span>
  }
};
</code></pre>
<h3 data-id="heading-7">ç”¨æ³•ç¤ºä¾‹</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">watch</span>([<span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">lastName</span>, <span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">firstName</span>], <span class="hljs-function">(<span class="hljs-params">oldValue, newValue</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"oldValue: "</span> + oldValue, <span class="hljs-string">"newValue: "</span> + newValue);
});
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  state.<span class="hljs-property">lastName</span> = <span class="hljs-string">"jacob"</span>;
}, <span class="hljs-number">1000</span>);
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  state.<span class="hljs-property">firstName</span> = <span class="hljs-string">"james"</span>;
}, <span class="hljs-number">1000</span>);
<span class="hljs-comment">/*
1ç§’é’Ÿåï¼šoldValue: lee,tom newValue: jacob,tom
2ç§’é’Ÿåï¼šoldValue: jacob,tom newValue: jacob,james
*/</span>
</code></pre>
<h2 data-id="heading-8">æ€»ç»“</h2>
<h3 data-id="heading-9">æœ¬æ–‡æ ¸å¿ƒå†…å®¹</h3>
<p>é€šè¿‡æ‰‹å†™å®ç°Vue3çš„<code>computed</code>å’Œ<code>watch</code>ï¼Œæˆ‘ä»¬æ·±å…¥ç†è§£äº†ï¼š</p>
<ul>
<li><strong>è®¡ç®—å±æ€§</strong>çš„æƒ°æ€§è®¡ç®—ã€å€¼ç¼“å­˜å’Œä¾èµ–è¿½è¸ªæœºåˆ¶</li>
<li><strong>ç›‘å¬å™¨</strong>çš„å¤šæ•°æ®æºå¤„ç†å’Œæ·±åº¦ç›‘å¬åŸç†</li>
<li><strong>å“åº”å¼ç³»ç»Ÿ</strong>ä¸­å‰¯ä½œç”¨è°ƒåº¦å’Œä¾èµ–æ”¶é›†çš„å®Œæ•´æµç¨‹</li>
</ul>
<h3 data-id="heading-10">ä»£ç åœ°å€</h3>
<p>ğŸ“Â <strong>æœ¬æ–‡å®Œæ•´ä»£ç </strong>ï¼š<br/>
[GitHubä»“åº“é“¾æ¥] | [<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgardenia83%2Fvue-source-code" target="_blank" title="https://github.com/gardenia83/vue-source-code" ref="nofollow noopener noreferrer">github.com/gardenia83/â€¦</a>]</p>
<h2 data-id="heading-11">ä¸‹ç¯‡é¢„å‘Š</h2>
<p>åœ¨ä¸‹ä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­æ·±å…¥Vue3å“åº”å¼ç³»ç»Ÿï¼Œæ‰‹å†™å®ç°ï¼š</p>
<p><strong>ã€Šæ·±å…¥ Vue3 å“åº”å¼ç³»ç»Ÿï¼šä»refåˆ°toRefsçš„å®Œæ•´å®ç°ã€‹</strong></p>
<ul>
<li><code>ref</code>å’Œ<code>shallowRef</code>çš„åº•å±‚æœºåˆ¶</li>
<li><code>toRef</code>å’Œ<code>toRefs</code>çš„å“åº”å¼è½¬æ¢åŸç†</li>
<li>æ¨¡æ¿Refå’Œç»„ä»¶Refçš„ç‰¹æ®Šå¤„ç†</li>
<li>Refè‡ªåŠ¨è§£åŒ…çš„ç¥ç§˜é¢çº±</li>
</ul>
<p>æ•¬è¯·æœŸå¾…ï¼ ğŸš€</p>
<hr/>
<p><em>æŒæ¡åº•å±‚åŸç†ï¼Œè®©æˆ‘ä»¬çš„å¼€å‘ä¹‹è·¯æ›´åŠ ä»å®¹è‡ªä¿¡</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[cloudflareäº‹æ•…æŠ¥å‘Šç¡¬æ ¸è¯¦è§£]]></title>    <link>https://juejin.cn/post/7574380953176326186</link>    <guid>https://juejin.cn/post/7574380953176326186</guid>    <pubDate>2025-11-20T05:38:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574380953176326186" data-draft-id="7574448424998617124" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="cloudflareäº‹æ•…æŠ¥å‘Šç¡¬æ ¸è¯¦è§£"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-20T05:38:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="YuUu"/> <meta itemprop="url" content="https://juejin.cn/user/1013070754220555"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            cloudflareäº‹æ•…æŠ¥å‘Šç¡¬æ ¸è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1013070754220555/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    YuUu
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T05:38:55.000Z" title="Thu Nov 20 2025 05:38:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è§ˆ</h2>
<p>æ˜¨æ™šï¼Œ500æˆäº†å…¨çƒç½‘ç«™ä¸Šæœ€é†’ç›®çš„æ•°å­—ã€‚å°ç¼–åœ¨è®¿é—®atcoderæ—¶å‘ç°æ— æ³•æ­£å¸¸ç™»å½•ï¼Œéšåå‘ç°æ¨ç‰¹ä¹ŸæŠ¥å‡º500é”™è¯¯ï¼Œèˆªç©ºå…¬å¸æ— æ³•åœ¨çº¿è®¢ç¥¨ï¼Œè®¸å¤šä½¿ç”¨Cloudflareçš„ä¸ªäººç½‘ç«™ä¹Ÿè·Ÿç€å—å®³ï¼Œå¹¶ä¸”æˆ‘çš„ä¸€äº›æœ‹å‹å·²ç»ç”³è¯·èµ”å¿ï¼ŒCloudflareè¿™æ³¢å¯è°“æŸå¤±æƒ¨é‡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/347d6b32e7a14a20a8859046667b6d40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWXVVdQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764221935&amp;x-signature=ib36nRUMeC%2FWh0sNaoYl6VEM5R8%3D" alt="" loading="lazy"/></p>
<p>å›¢é˜Ÿèµ·åˆè®¤ä¸ºè¿™åˆä¸€æ¬¡æ˜¯ç”±æ”»å‡»å¯¼è‡´çš„ï¼Œéšåæ„è¯†åˆ°æ˜¯å› ä¸ºæ•°æ®åº“çš„æƒé™è®¾ç½®å‡ºäº†é—®é¢˜ï¼Œå¯¼è‡´é…ç½®æ–‡ä»¶è¢«å¤šæ¬¡å†™å…¥ï¼Œé”™è¯¯çš„é…ç½®æ–‡ä»¶ä¸‹æ”¾åˆ°æœåŠ¡ç«¯å¯¼è‡´æœåŠ¡ç«¯ç˜«ç—ªï¼Œå›¢é˜Ÿåœ¨å‡ å°æ—¶å†…é€šè¿‡æ›¿æ¢é…ç½®æ–‡ä»¶è¿…é€ŸæŒ½æ•‘è¿™æ¬¡ç¾éš¾ã€‚</p>
<h2 data-id="heading-1">ä¸ºä»€ä¹ˆcloudflareå¦‚æ­¤é‡è¦</h2>
<h3 data-id="heading-2">1. <strong>åŠ é€Ÿç½‘ç«™è®¿é—®</strong></h3>
<p>Cloudflare åœ¨å…¨çƒæœ‰ 300+ æ•°æ®ä¸­å¿ƒï¼ˆèŠ‚ç‚¹ï¼‰ï¼Œèƒ½æŠŠé™æ€èµ„æºç¼“å­˜åˆ°ç¦»ç”¨æˆ·æ›´è¿‘çš„åœ°æ–¹</p>
<h3 data-id="heading-3">2. <strong>ä¿æŠ¤ç½‘ç«™ä¸è¢«æ”»å‡»</strong></h3>
<p><em>Cloudflare æä¾›ä¸šç•Œæœ€å¼ºçš„</em> <em><strong>DDoS</strong></em> <em><strong>é˜²å¾¡</strong></em> <em>ã€‚</em></p>
<p>å½“é»‘å®¢å‘èµ·æ¶æ„è®¿é—®æ—¶ï¼Œå®ƒä¼šæ‹¦æˆªè¯·æ±‚ï¼Œç¡®ä¿ä½ çš„æœåŠ¡å™¨ä¸ä¼šæŒ‚æ‰ã€‚</p>
<p><strong>åŒ…æ‹¬ï¼š</strong></p>
<ul>
<li>DDoS æ¸…æ´—</li>
<li>é˜²çˆ¬è™«</li>
<li>é˜²ç«å¢™è§„åˆ™</li>
<li>æœºå™¨äººè¯†åˆ«</li>
</ul>
<h3 data-id="heading-4">3. <strong>éšè—æœåŠ¡å™¨ IP</strong></h3>
<p>å› ä¸º Cloudflare æ˜¯åå‘ä»£ç†ï¼Œç”¨æˆ·åªçœ‹åˆ° Cloudflare çš„ IPï¼Œçœ‹ä¸åˆ°ä½ çœŸå®æœåŠ¡å™¨åœ°å€</p>
<p>ï¼Œè¾¾åˆ°é˜²æ­¢è¢«äººç›´æ¥æ”»å‡»ä½ æœåŠ¡å™¨çš„æ•ˆæœã€‚</p>
<h3 data-id="heading-5">4. <strong>æä¾› HTTPSã€SSL è¯ä¹¦</strong></h3>
<p>æ— éœ€è‡ªå·±é…ç½®è¯ä¹¦ï¼Œå¯ä»¥è‡ªåŠ¨ä¸ºç½‘ç«™å¯ç”¨ HTTPSã€‚</p>
<h3 data-id="heading-6">5. <strong>æ›´å¤šé«˜çº§åŠŸèƒ½</strong></h3>
<p>åŒ…æ‹¬ä½†ä¸é™äºï¼š</p>
<ul>
<li>Workersï¼ˆæ— æœåŠ¡å™¨å‡½æ•°ï¼‰</li>
<li>R2 å¯¹è±¡å­˜å‚¨ï¼ˆS3 æ›¿ä»£ï¼‰</li>
<li>Zero Trust è®¿é—®æ§åˆ¶</li>
<li>WAF Web åº”ç”¨é˜²ç«å¢™</li>
<li><strong>Turnstileï¼ˆæ— éªŒè¯ç äººæœºéªŒè¯ï¼‰</strong></li>
<li>Pagesï¼ˆé™æ€ç½‘ç«™æ‰˜ç®¡ï¼‰</li>
</ul>
<p><strong>æ‰€ä»¥ï¼Œä¸ºé¿å…ä¸ªäººç½‘ç«™å—æ”»å‡»ï¼Œä½¿ç”¨Cloudflareçš„å®‰å…¨æœåŠ¡æ˜¯è®¸å¤šå¼€å‘è€…çš„é¦–é€‰ï¼Œä¸‹é¢è¿™å¼ å›¾å½¢è±¡è¯´æ˜äº†cloudflareåœ¨å…¨çƒäº’è”ç½‘ä¸­çš„é‡è¦åœ°ä½ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8cb06a93ffc849dbbac6eb2d95195496~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWXVVdQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764221935&amp;x-signature=qx2%2BY1am9aWjJ%2BKBHXmESQN%2Bhac%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">äº‹æ•…è¿‡ç¨‹</h2>
<p>æ•°æ®åº“å‘é…ç½®æ–‡ä»¶å†™å…¥è¿‡é‡æ¡ç›®ï¼Œä¹‹åå°†è¿™äº›é…ç½®æ–‡ä»¶ä¸‹æ”¾åˆ°æœåŠ¡ç«¯åï¼Œé…ç½®æ–‡ä»¶å¤§å°è¶…è¿‡äº†æœåŠ¡ç«¯è§„å®šçš„ä¸Šé™ï¼Œå› è€Œå¼•å‘é”™è¯¯ã€‚ï¼ˆè¿™äº›é…ç½®æ–‡ä»¶æè¿°äº†cloudflareæœ€æ–°çš„å¨èƒæ•°æ®ï¼‰</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b0d68e72e874152b70901737763e86d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWXVVdQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764221935&amp;x-signature=jD99N8yebI8qDvmUoVH5d5pQIWg%3D" alt="" loading="lazy"/></p>
<p>ä»11:30å¼€å§‹ï¼Œæ£€æµ‹æŠ¥å‘Šæ˜¾ç¤ºæ”¶åˆ°å¤§é‡çš„5xxå“åº”ç»“æœï¼Œèµ·åˆç»“æœå‘ˆç°æ³¢åŠ¨ï¼Œè¿™æ˜¯ç”±äºä¸€å¼€å§‹æ•°æ®åº“é›†ç¾¤åªæœ‰éƒ¨åˆ†èŠ‚ç‚¹ä¼šæ”¾å‡ºé”™è¯¯é…ç½®æ–‡ä»¶ï¼Œæ¯è¿‡5åˆ†é’Ÿï¼Œæ•°æ®åº“éƒ½ä¼šé‡æ–°ç”Ÿæˆæ–°çš„é…ç½®æ–‡ä»¶å¹¶ä¸‹æ–¹ï¼Œå½“è¯·æ±‚è¢«åˆ†é…åˆ°æœ‰æ•…éšœçš„èŠ‚ç‚¹ï¼Œæ‰ä¼šä¸‹æ”¾é”™è¯¯çš„é…ç½®æ–‡ä»¶ã€‚</p>
<p>ä¸€æ®µæ—¶é—´åï¼Œ13:00åï¼Œæ‰€æœ‰èŠ‚ç‚¹å‡å‡ºç°äº†è¿™ä¸ªé”™è¯¯ï¼Œå› è€Œå¯¼è‡´è¿ç»­çš„å¤§é¢ç§¯5xxç»“æœï¼Œä¹‹åï¼Œå¼€å‘äººå‘˜æ‰‹åŠ¨å°†æ—§ç‰ˆæœ¬çš„é…ç½®æ–‡ä»¶æ’å…¥é˜Ÿåˆ—ï¼Œå¹¶å¼ºåˆ¶é‡å¯é…ç½®æ–‡ä»¶å‘æ”¾æœåŠ¡ï¼Œåœ¨14:30å·¦å³ä»¤é”™è¯¯æƒ…å†µå¾—åˆ°æ˜¾è‘—ç¼“è§£ï¼Œè€Œ15:00ä¹‹åçš„â€œé•¿å°¾å·´â€ï¼Œæ˜¯åœ¨é€ä¸ªé‡å¯è¢«æ­¤é…ç½®æ–‡ä»¶é”™è¯¯å½±å“åˆ°çš„å…¶ä»–æœåŠ¡ã€‚</p>
<p>è¢«å½±å“çš„æœåŠ¡å¦‚ä¸‹ï¼š</p>

































<table><thead><tr><th>Service / Product</th><th>Impact description</th></tr></thead><tbody><tr><td>Core CDN and security services</td><td>HTTP 5xx status codes. The screenshot at the top of this post shows a typical error page delivered to end users.</td></tr><tr><td>Turnstile</td><td>Turnstile failed to load.</td></tr><tr><td>Workers KV</td><td>Workers KV returned a significantly elevated level of HTTP 5xx errors as requests to KVâ€™s â€œfront endâ€ gateway failed due to the core proxy failing.</td></tr><tr><td>Dashboard</td><td>While the dashboard was mostly operational, most users were unable to log in due to Turnstile being unavailable on the login page.</td></tr><tr><td>Email Security</td><td>While email processing and delivery were unaffected, we observed a temporary loss of access to an IP reputation source which reduced spam-detection accuracy and prevented some new-domain-age detections from triggering, with no critical customer impact observed. We also saw failures in some Auto Move actions; all affected messages have been reviewed and remediated.</td></tr><tr><td>Access</td><td>Authentication failures were widespread for most users, beginning at the start of the incident and continuing until the rollback was initiated at 13:05. Any existing Access sessions were unaffected. All failed authentication attempts resulted in an error page, meaning none of these users ever reached the target application while authentication was failing. Successful logins during this period were correctly logged during this incident. Any Access configuration updates attempted at that time would have either failed outright or propagated very slowly. All configuration updates are now recovered.</td></tr></tbody></table>
<h2 data-id="heading-8">åŸç†</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65b2a474af59453c92ff04386f64890f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWXVVdQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764221935&amp;x-signature=ywOLUfZQeySYBXo3P3mwHr4SaBg%3D" alt="" loading="lazy"/></p>
<p>cloudflareçš„æœåŠ¡ç”±ä¸‰å±‚æ¶æ„ç»„æˆï¼Œå½“å®¢æˆ·ç«¯å‘é…ç½®äº†CloudflareæœåŠ¡çš„æœåŠ¡å™¨ç«¯å‘é€è¯·æ±‚æ—¶ï¼Œè¯·æ±‚ä¾æ¬¡é€šè¿‡ï¼š <strong>HTTP &amp; TLS Terminationã€FLï¼ˆæ ¸å¿ƒä»£ç†æ¨¡å—ï¼‰ã€ç¼“å­˜\æ•°æ®åº“æ¨¡å—ã€‚</strong></p>
<p>è¿™æ¬¡çš„é—®é¢˜å‡ºåœ¨äº†FLï¼Œæ ¸å¿ƒä»£ç†æ¨¡å—(Core Proxy Module)ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå·¥å…·ï¼Œç”¨äºæ£€æµ‹æ“ä½œæ˜¯å¦ç”±æœºå™¨äºº\è‡ªåŠ¨åŒ–å·¥å…·å®Œæˆâ€”â€”Bot Managementï¼Œè¿™ä¸ªåæœºå™¨äººå·¥å…·ï¼Œä½¿ç”¨ä¸€ä¸ªMLï¼ˆæœºå™¨å­¦ä¹ ï¼‰æ–¹æ³•ï¼Œè¯»å…¥é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„è¿‘æœŸç”¨æˆ·è¡Œä¸ºï¼Œæ¥å¯¹æ­¤æ¬¡ç”¨æˆ·çš„è¯·æ±‚æ˜¯å¦ç”±æœºå™¨äººå®Œæˆè¿›è¡Œé¢„æµ‹ã€‚</p>
<p>ç”±äºæ–°çš„è‡ªåŠ¨åŒ–å·¥å…·å’Œæœºå™¨äººæŠ€æœ¯æ‰‹æ®µå±‚å‡ºä¸ç©·ï¼Œè¿™ä¸ªé…ç½®æ–‡ä»¶ä¼šè¢«é¢‘ç¹æ›´æ–°ç»™Bot Managementï¼Œè€Œç”±äºé”™è¯¯çš„æ•°æ®åº“Queryè¯­å¥ï¼Œå¯¼è‡´é…ç½®æ–‡ä»¶è¢«å¤§é‡å†™å…¥é‡å¤æ¡ç›®ï¼Œè®©é…ç½®æ–‡ä»¶è¶…è¿‡äº†å›ºå®šå¤§å°ï¼Œä»è€Œè®©MLæ¨¡å—è¯»å–æ–‡ä»¶æ—¶å‡ºé”™ã€‚</p>
<p>å¦‚æœCloudflareç”¨æˆ·åœ¨æ ¸å¿ƒä»£ç†æ¨¡å—ä¸­å¯ç”¨äº†Bot Managementï¼Œæ–°ç‰ˆæœ¬FL2ä¼šç›´æ¥æŠ›å‡º5xxé”™è¯¯ï¼Œè€Œæ—§ç‰ˆæœ¬FLï¼Œåˆ™ä¼šMLå¤±æ•ˆï¼Œè¿”å›100%æ˜¯æœºå™¨äººçš„é”™è¯¯åˆ¤æ–­ï¼Œä»è€Œç›´æ¥è®¤ä¸ºä½ çš„ä¸€åˆ‡æ“ä½œéƒ½æ˜¯äººæœºï¼ï¼ˆè¿™å°±æ˜¯æ— æ³•ç™»é™†é…ç½®äº†cloudflareäººæœºéªŒè¯ç½‘ç«™çš„åŸå› ï¼Œè¢«100%å½“æœºå™¨äººäº†å‘µå‘µï¼‰</p>
<h2 data-id="heading-9">é”™è¯¯çš„æ•°æ®åº“è¯·æ±‚</h2>
<p>Cloudflareä½¿ç”¨<strong>ClickHouse</strong>æ•°æ®åº“ï¼Œè¿™æ˜¯ä¸€ç§è¶…é«˜é€Ÿçš„æ•°æ®åˆ†ææ•°æ®åº“ï¼Œç”¨æ¥åšæŠ¥è¡¨ã€ç»Ÿè®¡ã€æŒ‡æ ‡æŸ¥è¯¢ï¼Œè€Œä¸æ“…äºåšä¸šåŠ¡äº‹åŠ¡ã€‚</p>
<p>ClickHouseä½¿ç”¨åˆ†å¸ƒå¼æ¨¡å¼ï¼Œå½“ç”¨æˆ·éœ€è¦æŸ¥è¯¢æ•°æ®æ—¶ï¼Œä¼šä»æ¯ä¸ªåˆ†ç‰‡shardæŸ¥è¯¢å¹¶å°†ç»“æœåˆå¹¶è¿”å›ï¼Œä»¥æé«˜æ€§èƒ½ï¼Œå…·ä½“åŸç†æ˜¯ï¼šæ•°æ®åº“ä¸­æœ‰ä¸€å¼ è¡¨defaultï¼Œå‘defaultè¡¨æäº¤æŸ¥è¯¢è¯­å¥ï¼ŒæŸ¥è¯¢äº¤ç»™åä¸ºDistributedçš„å¼•æ“ï¼Œè¿™ä¸ªå¼•æ“å”¤èµ·æ¯ä¸ªshardï¼Œè®©shardå»æŸ¥å…¶ä¸‹çš„r0è¡¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªshardå®é™…ä¸Šæœ‰ä¸€ä¸ªr0è¡¨ï¼Œæ‰€æœ‰çš„æ•°æ®åªåœ¨r0ä¸­å‚¨å­˜ï¼Œdefaultæ˜¯ä¸€å¼ â€œä»£ç†è¡¨â€ã€‚</p>
<p>Cloudflareå›¢é˜Ÿå‘ç°ï¼ŒClickHouseæ•°æ®åº“åœ¨æ‰§è¡ŒæŸ¥è¯¢æ—¶ï¼Œå¹¶ä¸ä¼šç”¨å‘èµ·æŸ¥è¯¢çš„ç”¨æˆ·èº«ä»½è¿›è¡ŒæŸ¥è¯¢ï¼Œåœ¨Distributedå¼•æ“ä¸­ï¼Œä¸ç®¡æ˜¯è°çš„æŸ¥è¯¢ï¼Œéƒ½ç”±ä¸€ä¸ªshared accountæ‰§è¡Œï¼Œè€Œè¿™æ ·çš„æ–¹å¼ï¼Œè®©æƒé™æ§åˆ¶å’Œå†å²è®°å½•åˆ†æå˜å¾—å›°éš¾ï¼Œå› æ­¤ï¼Œcloudflareå›¢é˜Ÿè®¡åˆ’è°ƒæ•´ClickHouseçš„æŸ¥è¯¢é€»è¾‘ï¼Œå°†å¯¹r0çš„éšå¼è®¿é—®æ”¹ä¸ºæ˜¾å¼è®¿é—®ï¼Œè®©ç”¨æˆ·ç›´æ¥è·å¾—å¯¹åº•å±‚shardä¸Šçš„æ•°æ®åº“r0çš„è®¿é—®æƒé™ï¼Œè¿™æ ·ï¼Œæ‰€æœ‰çš„æ“ä½œä¸ç»defaultè¡¨ä»£ç†ï¼Œç›´æ¥æ¥åˆ°r0ï¼Œè®©ç›‘æ§å˜å¾—å®¹æ˜“ã€‚</p>
<p>å¯æ˜¯ï¼é—®é¢˜å°±å‡ºåœ¨äº†å°å°çš„æ•°æ®åº“æŸ¥è¯¢è¯­å¥ä¸Šï¼Œå½“Cloudflareå›¢é˜Ÿä¿®æ”¹äº†ç”¨æˆ·å¯¹r0çš„æƒé™ä¸ºå¯è®¿é—®æ—¶ï¼Œæ­¤æ—¶çš„æŸ¥è¯¢è¯­å¥æ˜¯ï¼š</p>
<pre><code class="hljs language-SQL" lang="SQL"><span class="hljs-keyword">SELECT</span>
  name,
  type
<span class="hljs-keyword">FROM</span> system.columns
<span class="hljs-keyword">WHERE</span>
  <span class="hljs-keyword">table</span> <span class="hljs-operator">=</span> <span class="hljs-string">'http_requests_features'</span>
<span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> name;
</code></pre>
<p>æŸ¥è¯¢æ²¡æœ‰æŒ‡å®šè¡¨ï¼å› æ­¤ï¼Œç»“æœä»r0å’Œdefaultä¸¤å¼ è¡¨è¿”å›ä¸¤æ¬¡ï¼Œå› æ­¤æ‰è®©é…ç½®æ–‡ä»¶çš„å¤§å°ç¿»äº†ä¸€å€ï¼</p>
<p>æŸ¥è¯¢ç»“æœç±»ä¼¼ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67974270298945e184632c2313be9691~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWXVVdQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764221935&amp;x-signature=pGY9kJM3OQdpQk6KJc4ofC48ruY%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-10">Rustçš„â€œè®¾è®¡å“²å­¦â€</h2>
<p>â€œä¸å®‰å…¨çš„æƒ…å†µæˆ‘ç›´æ¥åœæœºã€‚â€</p>
<p>åœ¨ç”¨äºè·å–ä¾›Bot Managementä½¿ç”¨çš„é…ç½®æ–‡ä»¶çš„Rustä»£ç ä¸­ï¼Œæœ‰è¿™ä¹ˆä¸€æ®µï¼š</p>
<pre><code class="hljs language-Rust" lang="Rust"><span class="hljs-comment">/// Fetch edge features based on `input` struct into [`Features`] buffer.</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">fetch_features</span>(
    &amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>,
    input: &amp;<span class="hljs-keyword">dyn</span> BotsInput,
    features: &amp;<span class="hljs-keyword">mut</span> Features,
) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;(), (ErrorFlags, <span class="hljs-type">i32</span>)&gt; {
    <span class="hljs-comment">// update features checksum (lower 32 bits) and copy edge feature names</span>
    features.checksum &amp;= <span class="hljs-number">0xFFFF_FFFF_0000_0000</span>;
    features.checksum |= <span class="hljs-type">u64</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-keyword">self</span>.config.checksum);
    <span class="hljs-keyword">let</span> (feature_values, _) = features
        .<span class="hljs-title function_ invoke__">append_with_names</span>(&amp;<span class="hljs-keyword">self</span>.config.feature_names)
        .<span class="hljs-title function_ invoke__">unwrap</span>();
}
</code></pre>
<p>æˆ‘ä»¬çœ‹åˆ°æœ€åçš„<code>.unwrap()</code>è¯­å¥ï¼Œè¿™ä¸ªè¯­å¥åœ¨å¾—åˆ°Errï¼ˆå¤±è´¥ï¼‰çš„è¡¨è¾¾æ—¶ï¼Œä¸ä¼šåšå…œåº•å¤„ç†æˆ–è€…æ‰“å‡ºæ—¥å¿—ï¼Œè€Œæ˜¯ç›´æ¥æŠ›å‡ºPanicï¼Œè®©Rustçº¿ç¨‹å®•æœºï¼</p>
<p>å› æ­¤ï¼Œå½“é…ç½®æ–‡ä»¶å¤§å°è¶…è¿‡é™åˆ¶ï¼Œå¼•å‘Errç»“æœæ—¶ï¼Œcloudflareçš„å¼€å‘äººå‘˜æ²¡æœ‰åœ¨è¿™é‡Œåšå…œåº•å¤„ç†ï¼Œå¯¼è‡´æŠ›å‡ºPanicï¼š</p>
<p><code>thread fl2_worker_thread panicked: called Result::unwrap() on an Err value</code></p>
<h2 data-id="heading-11">ç®€å•æ€»ç»“</h2>
<p>ä¸€æ¡è¢«å¿½ç•¥çš„æ•°æ®åº“æŸ¥è¯¢è¯­å¥ + ä¸€æ¬¡æƒé™è°ƒæ•´ â†’ å¯¼è‡´é…ç½®é‡å¤å†™å…¥ â†’ é…ç½®æ–‡ä»¶è¿‡å¤§ â†’ Bot Management å´©æºƒ â†’ FL æ¨¡å— panic â†’ å…¨çƒèŒƒå›´ 5xxã€‚</p>
<p>è¿™è¯´æ˜äº†ä¸€ä¸ªæœ´ç´ äº‹å®ï¼š</p>
<blockquote>
<p><strong>åºå¤§çš„äº’è”ç½‘æ˜¯ç”±æ— æ•°æå°çš„ç»†èŠ‚äº’ç›¸ç‰µåŠ¨çš„ï¼Œä¸€ä¸ªå°å°çš„ SQL æŸ¥è¯¢ä¹Ÿå¯èƒ½è®©åŠä¸ªäº’è”ç½‘å€’ä¸‹ã€‚</strong></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[17. Vue3 ä¸šåŠ¡ç»„ä»¶åº“æŒ‰éœ€åŠ è½½çš„å®ç°åŸç†]]></title>    <link>https://juejin.cn/post/7572480736362119174</link>    <guid>https://juejin.cn/post/7572480736362119174</guid>    <pubDate>2025-11-16T09:53:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7572480736362119174" data-draft-id="7567194020462133274" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="17. Vue3 ä¸šåŠ¡ç»„ä»¶åº“æŒ‰éœ€åŠ è½½çš„å®ç°åŸç†"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Vue.js"/> <meta itemprop="datePublished" content="2025-11-16T09:53:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Cobyte"/> <meta itemprop="url" content="https://juejin.cn/user/668147376989517"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            17. Vue3 ä¸šåŠ¡ç»„ä»¶åº“æŒ‰éœ€åŠ è½½çš„å®ç°åŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/668147376989517/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Cobyte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-16T09:53:14.000Z" title="Sun Nov 16 2025 09:53:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    31
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto;border:3px solid rgba(62,175,124,.2)}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-weight:700;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:6px;border:2px solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c}.markdown-body a:active,.markdown-body a:hover{border-bottom:1.5px solid #3eaf7c}.markdown-body a:before{content:"â‡²"}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(62,175,124,.2)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:.5rem solid;border-color:#42b983;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none}.markdown-body ul li:before{content:"â€¢";margin-right:4px;color:#3eaf7c}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>æœ€è¿‘åœ¨å…¬å¸å®ç°ä¸€ä¸ªä¸šåŠ¡ç»„ä»¶åº“æŒ‰éœ€åŠ è½½çš„éœ€æ±‚ã€‚ç®€å•æ¥è¯´ï¼Œæœ‰ä¸¤ä¸ªéœ€æ±‚ï¼Œç¬¬ä¸€ä¸ªæ˜¯å®ç°ä¸šåŠ¡ç»„ä»¶åº“çš„æŒ‰éœ€åŠ è½½ï¼Œç¬¬äºŒï¼Œå› ä¸ºä¸šåŠ¡ç»„ä»¶åº“é‡Œé¢æœ‰å¼•ç”¨äº†ç±»ä¼¼ Element Plus çš„ç¬¬ä¸‰æ–¹ç»„ä»¶åº“ï¼Œæ‰€ä»¥åœ¨å®ç°ä¸šåŠ¡ç»„ä»¶åº“æŒ‰éœ€åŠ è½½çš„åŒæ—¶ï¼Œä¸šåŠ¡ç»„ä»¶åº“é‡Œé¢çš„å¼•ç”¨çš„ç¬¬ä¸‰æ–¹ç»„ä»¶åº“ä¹Ÿè¦å®ç°æŒ‰éœ€åŠ è½½ã€‚</p>
<p>ä½œä¸ºä¸€ä¸ªç¼–ç¨‹æŠ€æœ¯äººå‘˜ï¼Œå³ä¾¿æœ‰äº†AIï¼Œä¹Ÿéœ€è¦ç ”ç©¶åº•å±‚çš„æŠ€æœ¯åŸç†ï¼Œç”šè‡³éœ€è¦æ¯”æ²¡æœ‰AIçš„æ—¶ä»£ï¼Œéœ€è¦æ›´åŠ æ·±å…¥ç ”ç©¶ï¼Œåœ¨AIæ—¶ä»£ï¼ŒåŸºç¡€çš„éƒ½é€šè¿‡AIå®ç°äº†ï¼Œåªæœ‰AIè§£å†³ä¸äº†çš„é—®é¢˜ï¼Œæœ€ç»ˆè¿˜å¾—é ä½ è‡ªå·±çš„ä¸“ä¸šçŸ¥è¯†å»è§£å†³ï¼Œè€Œè¿™å°†æ˜¯ä½ çš„æ ¸å¿ƒç«äº‰åŠ›çš„ä½“ç°ï¼Œæ‰€ä»¥åœ¨AIæ—¶ä»£å¯¹æŠ€æœ¯äººå‘˜çš„æŠ€æœ¯ç´ å…»è¦æ±‚å°†æ›´åŠ çš„é«˜ã€‚</p>
<p>æ‰¯è¿œäº†ï¼Œæˆ‘ä»¬å›åˆ°ä¸šåŠ¡ç»„ä»¶åº“æŒ‰éœ€åŠ è½½çš„å®ç°åŸç†çš„ä¸»é¢˜ä¸Šæ¥ã€‚</p>
<p>ä¸€èˆ¬åœ¨é¡¹ç›®ä¸­å¦‚æœæ²¡æœ‰è¿›è¡Œç»„ä»¶åº“æŒ‰éœ€åŠ è½½é…ç½®ï¼Œéƒ½æ˜¯ä¸€å¼€å§‹å°±å…¨é‡åŠ è½½è¿›è¡Œå…¨å±€ç»„ä»¶æ³¨å†Œï¼Œè¿™æ ·å°±ç­‰äºæ•´ä¸ªç»„ä»¶åº“åœ¨åˆå§‹åŒ–çš„æ—¶å€™å°±å…¨éƒ¨åŠ è½½äº†ï¼Œå¦‚æœåœ¨è¿½æ±‚æ€§èƒ½çš„é¡¹ç›®ä¸­ï¼Œè¿™æ˜¯ä¸å¯æ¥å—çš„ã€‚è¿™æ—¶æˆ‘ä»¬å°±è¦å®ç°ç»„ä»¶åº“çš„æŒ‰éœ€åŠ è½½ï¼Œæ¥æé«˜æ€§èƒ½ã€‚</p>
<h3 data-id="heading-1">æŒ‰éœ€åŠ è½½çš„åŸºæœ¬å®ç°åŸç†</h3>
<p>é¦–å…ˆä»€ä¹ˆæ˜¯æŒ‰éœ€åŠ è½½ï¼Ÿ</p>
<p>æ‰€è°“æŒ‰éœ€åŠ è½½ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯æœ‰éœ€è¦å°±åŠ è½½ï¼Œä¸éœ€è¦å°±ä¸åŠ è½½ï¼Œæ¯”å¦‚ <code>Element Plus</code> ç»„ä»¶åº“æœ‰å‡ åä¸ªç»„ä»¶ï¼Œå¯èƒ½åœ¨æˆ‘ä»¬çš„é¡¹ç›®åªç”¨åˆ°äº†åˆ°äº†å…¶ä¸­ä¸€ä¸ªç»„ä»¶ <code>&lt;el-button&gt;</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¸Œæœ›åªåŠ è½½è·Ÿè¿™ä¸ªæŒ‰é’®ç»„ä»¶ç›¸å…³çš„ä»£ç ï¼Œä»è€Œè¾¾åˆ°å‡å°‘æ‰“åŒ…ä½“ç§¯çš„æ•ˆæœã€‚</p>
<p>æŒ‰éœ€åŠ è½½æœ€ç®€å•çš„å®ç°æ–¹å¼å°±æ˜¯æ‰‹åŠ¨è®¾ç½®ï¼Œå®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span>&gt;</span>æŒ‰é’®<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ElButton</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'element-plus/es/components/button'</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'element-plus/es/components/button/style/index'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">components</span>: { <span class="hljs-title class_">ElButton</span> },
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>æˆ‘ä»¬åƒä¸Šè¿°ä¾‹å­è¿™æ ·æ‰‹åŠ¨å¼•ç”¨ç¬¬ä¸‰æ–¹ç»„ä»¶åº“çš„è¯ï¼Œåœ¨æ‰“åŒ…çš„æ—¶å€™å°±åªä¼šæ‰“åŒ…å¼•ç”¨åˆ°çš„ç»„ä»¶ï¼Œå› ä¸ºç›®å‰çš„å¼€æºç»„ä»¶åº“åŸºæœ¬éƒ½å®ç°äº†åˆ©äº Tree Shaking çš„ <code>ESM</code> æ¨¡å—åŒ–å®ç°ã€‚</p>
<p>å¦‚æœæ¯ä¸ªä¸šåŠ¡ç»„ä»¶éƒ½éœ€è¦è¿›è¡Œä¸Šè¿°è®¾ç½®ï¼Œå…¶å®è¿˜æ˜¯æŒºç¹ççš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¸Œæœ›åªåœ¨ template ä¸­ç›´æ¥è°ƒç”¨å°±å¥½ï¼Œå…¶ä»–ä»€ä¹ˆè®¾ç½®éƒ½ä¸éœ€è¦ï¼Œå°±åƒå…¨å±€æ³¨å†Œç»„ä»¶é‚£æ ·ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span>&gt;</span>æŒ‰é’®<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p>è€Œå‰©ä¸‹éƒ¨åˆ†çš„ä»£ç ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨æ‰“åŒ…æˆ–è€…è¿è¡Œçš„æ—¶å€™è‡ªåŠ¨è®¾ç½®ä¸Šå»ã€‚ä¸»è¦æ˜¯ä»¥ä¸‹éƒ¨åˆ†çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ElButton</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'element-plus/es/components/button'</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'element-plus/es/components/button/style/index'</span>
</code></pre>
<p>ä¸Šè¿°éƒ¨åˆ†çš„ä»£ç ï¼Œå¸Œæœ›è‡ªåŠ¨åŠ è½½ï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®ã€‚æ•´ä¸ªæ‰€è°“æŒ‰éœ€åŠ è½½æ‰€éœ€è¦å®ç°çš„å°±æ˜¯ä¸Šè¿°çš„åŠŸèƒ½ã€‚</p>
<p>é‚£ä¹ˆæ€ä¹ˆå®ç°å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆä¸Šè¿°æ¨¡æ¿ä»£ç çš„ç¼–è¯‘ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { createTextVNode <span class="hljs-keyword">as</span> _createTextVNode, resolveComponent <span class="hljs-keyword">as</span> _resolveComponent, withCtx <span class="hljs-keyword">as</span> _withCtx, createVNode <span class="hljs-keyword">as</span> _createVNode, openBlock <span class="hljs-keyword">as</span> _openBlock, createElementBlock <span class="hljs-keyword">as</span> _createElementBlock } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params">_ctx, _cache, $props, $setup, $data, $options</span>) {
  <span class="hljs-keyword">const</span> _component_el_button = <span class="hljs-title function_">_resolveComponent</span>(<span class="hljs-string">"el-button"</span>)

  <span class="hljs-keyword">return</span> (<span class="hljs-title function_">_openBlock</span>(), <span class="hljs-title function_">_createElementBlock</span>(<span class="hljs-string">"template"</span>, <span class="hljs-literal">null</span>, [
    <span class="hljs-title function_">_createVNode</span>(_component_el_button, <span class="hljs-literal">null</span>, {
      <span class="hljs-attr">default</span>: <span class="hljs-title function_">_withCtx</span>(<span class="hljs-function">() =&gt;</span> [
        <span class="hljs-title function_">_createTextVNode</span>(<span class="hljs-string">"æŒ‰é’®"</span>)
      ], <span class="hljs-literal">undefined</span>, <span class="hljs-literal">true</span>),
      <span class="hljs-attr">_</span>: <span class="hljs-number">1</span> <span class="hljs-comment">/* STABLE */</span>
    })
  ]))
}
</code></pre>
<p>æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ° Vue3 çš„å†…ç½®å‡½æ•° <code>_resolveComponent("el-button")</code> éƒ¨åˆ†ï¼Œç„¶åæ›¿æ¢æˆå¯¹åº”çš„ç»„ä»¶ä»£ç å³å¯ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-addition">+ import { ElButton } from 'element-plus/es/components/button'</span>
<span class="hljs-addition">+ import 'element-plus/es/components/button/style/index'</span>
import { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from "vue"

export function render(_ctx, _cache, $props, $setup, $data, $options) {
<span class="hljs-deletion">-  const _component_el_button = _resolveComponent("el-button")</span>
<span class="hljs-addition">+ const _component_el_button = ElButton</span>

  return (_openBlock(), _createElementBlock("template", null, [
    _createVNode(_component_el_button, null, {
      default: _withCtx(() =&gt; [
        _createTextVNode("æŒ‰é’®")
      ], undefined, true),
      _: 1 /* STABLE */
    })
  ]))
}
</code></pre>
<p>ä¸Šè¿°å°±æ˜¯ç»„ä»¶åº“æŒ‰éœ€åŠ è½½çš„åŸºæœ¬å®ç°åŸç†ã€‚</p>
<h3 data-id="heading-2">ä½¿ç”¨ Vite æ‰“åŒ…ç»„ä»¶åº“</h3>
<p>ä¸ºäº†æ›´å¥½è¿˜åŸå®é™…åœºæ™¯ï¼Œæˆ‘ä»¬å¿«é€Ÿåˆ›å»ºä¸€ä¸ªç»„ä»¶åº“é¡¹ç›®å¹¶ä¸”é€šè¿‡ Vite è¿›è¡Œæ‰“åŒ…ã€‚
é¦–å…ˆåˆ›å»ºä¸€ä¸ª <code>cobyte-vite-ui</code> çš„ç»„ä»¶åº“ç›®å½•ï¼Œåœ¨æ ¹ç›®å½•ä¸‹åˆå§‹åŒ– Node é¡¹ç›®ï¼Œæ‰§è¡Œ <code>pnpm init</code>, ä¼šè‡ªåŠ¨ç”Ÿæˆ <code>package.json</code>  æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cobyte-vite-ui"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"index.js"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"test"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"keywords"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"author"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"license"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ISC"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"packageManager"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"pnpm@10.20.0"</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>åœ¨æ ¹ç›®å½•æ–°å»º <code>pnpm-workspace.yaml</code> æ–‡ä»¶è¿›è¡Œ Monorepo é¡¹ç›®é…ç½®ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">packages:
<span class="hljs-bullet">  -</span> packages/*
<span class="hljs-bullet">  -</span> play
</code></pre>
<p>æ€»çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-go" lang="go">â”œâ”€â”€ packages
â”‚   â”œâ”€â”€ components
â”‚   â”œâ”€â”€ hooks
â”‚   â””â”€â”€ utils
â”œâ”€â”€ play
â”œâ”€â”€ <span class="hljs-keyword">package</span>.json
â””â”€â”€ pnpm-workspace.yaml
</code></pre>
<p>æ¥ç€æˆ‘ä»¬å®‰è£…ä¸€äº›å¿…è¦çš„ä¾èµ–ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">pnpm <span class="hljs-keyword">add</span> vite typescript <span class="hljs-variable">@vitejs</span><span class="hljs-operator">/</span>plugin<span class="hljs-operator">-</span>vue sass <span class="hljs-variable">@types</span><span class="hljs-operator">/</span>node <span class="hljs-operator">-</span>D <span class="hljs-operator">-</span>w
</code></pre>
<p>æ¥ç€æˆ‘ä»¬å®‰è£…ä¸€ä¸‹ vue ä¾èµ–ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">pnpm <span class="hljs-keyword">add</span> vue -w
</code></pre>
<p>åŸºç¡€ä¾èµ–å®‰è£…å®Œæ¯•ï¼Œæˆ‘ä»¬è®¾ç½®ä¸€ä¸‹ TS çš„é…ç½®ï¼Œå› ä¸ºæˆ‘ä»¬è¿™ä¸ªé¡¹ç›®æ˜¯ä¸€ä¸ª TS çš„é¡¹ç›®ï¼Œåœ¨æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª <code>tsconfig.json</code>ï¼Œé…ç½®å†…å®¹å¯ä»¥ç®€å•è®¾ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js">{
    <span class="hljs-string">"compilerOptions"</span>: {
      <span class="hljs-string">"target"</span>: <span class="hljs-string">"ESNext"</span>,
      <span class="hljs-string">"module"</span>: <span class="hljs-string">"NodeNext"</span>,
      <span class="hljs-string">"sourceMap"</span>: <span class="hljs-literal">true</span>,  <span class="hljs-comment">// å…³é”®ï¼šå¯ç”¨æºæ˜ å°„</span>
      <span class="hljs-string">"outDir"</span>: <span class="hljs-string">"./dist"</span>, <span class="hljs-comment">// å¯é€‰ï¼šæŒ‡å®šè¾“å‡ºç›®å½•</span>
      <span class="hljs-string">"esModuleInterop"</span>: <span class="hljs-literal">true</span>
    }
}
</code></pre>
<p>æ¥ç€æˆ‘ä»¬å°±åœ¨ <code>packages/components</code> ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæµ‹è¯•æŒ‰é’®ç»„ä»¶</p>
<p>ç›®å½•è·¯å¾„ï¼š<code>packages/components/button/button.vue</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>æµ‹è¯•æŒ‰é’®<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-title function_">defineOptions</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'co-button'</span>,
});
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-tag">button</span> {
  <span class="hljs-attribute">color</span>: red;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p>ç›®å½•è·¯å¾„ï¼š<code>packages/components/button/index.ts</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> button <span class="hljs-keyword">from</span> <span class="hljs-string">"./button.vue"</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">CoButton</span> = button;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">CoButton</span>;
</code></pre>
<p>ç›®å½•è·¯å¾„ï¼š<code>packages/components/components.ts</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">CoButton</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./button'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> [
    <span class="hljs-title class_">CoButton</span>
]
</code></pre>
<p>å°†æ‰€æœ‰ç»„ä»¶é›†ä¸­åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ç»Ÿä¸€å¯¼å‡ºï¼Œæ–¹ä¾¿æ‰¹é‡ç®¡ç†å’Œä½¿ç”¨ã€‚</p>
<p>ç›®å½•è·¯å¾„ï¼š<code>packages/components/defaults.ts</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">App</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> components <span class="hljs-keyword">from</span> <span class="hljs-string">'./components'</span>;

<span class="hljs-keyword">const</span> install = <span class="hljs-keyword">function</span> (<span class="hljs-params">app: App</span>) {
    components.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">component</span> =&gt;</span> {
        app.<span class="hljs-title function_">component</span>(component.<span class="hljs-property">name</span>, component);
    });
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    install
};
</code></pre>
<p>ç›®å½•è·¯å¾„ï¼š<code>packages/components/index.ts</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./button'</span>;

<span class="hljs-keyword">import</span> install <span class="hljs-keyword">from</span>  <span class="hljs-string">'./defaults'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> install;
</code></pre>
<p>æˆ‘ä»¬å†é…ç½®ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œç›®å½•è·¯å¾„ï¼š<code>packages/utils/index.ts</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testUtils</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'testUtils'</span>);
}
</code></pre>
<p>å¦‚æœå¤§å®¶å¯¹åˆ›å»ºç»„ä»¶åº“æ¯”è¾ƒæœ‰ç»éªŒçš„è¯ï¼Œå°±çŸ¥é“ä¸Šè¿°æ­¥éª¤ï¼Œæ˜¯ Vue3 ç»„ä»¶åº“çš„åŸºç¡€è®¾ç½®ï¼Œå„å¤§ç»„ä»¶åº“çš„å®ç°è™½ç„¶å·®å¼‚å¾ˆå¤§ï¼Œä½†æœ€æ ¸å¿ƒæœºåˆ¶éƒ½å¯ä»¥ç®€å•å½’çº³ä¸ºä¸Šè¿°è®¾ç½®å†…å®¹ã€‚
å¤§å®¶å¦‚æœæƒ³è¯¦ç»†äº†è§£æ›´å¤šä¹Ÿå¯ä»¥çœ‹çœ‹æœ¬æ ç›®å‰é¢ç« èŠ‚çš„å†…å®¹ã€‚</p>
<p>æ¥ç€æˆ‘ä»¬å°±åˆ°äº†æˆ‘ä»¬æœ€æ ¸å¿ƒçš„ç»„ä»¶åº“æ‰“åŒ…çš„ç¯èŠ‚äº†ï¼Œæˆ‘ä»¬åœ¨æ ¹æœ¬ç›®å½•åˆ›å»ºä¸€ä¸ª <code>vite.config.ts</code>ï¼Œè®¾ç½®å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">"vite"</span>;
<span class="hljs-keyword">import</span> vue <span class="hljs-keyword">from</span> <span class="hljs-string">"@vitejs/plugin-vue"</span>;
<span class="hljs-keyword">import</span> path, { resolve } <span class="hljs-keyword">from</span> <span class="hljs-string">"path"</span>;
<span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">"fs"</span>;

<span class="hljs-comment">// åŠ¨æ€è·å–ç»„ä»¶ç›®å½•åˆ—è¡¨</span>
<span class="hljs-keyword">const</span> componentsDir = <span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">"./packages/components"</span>);
<span class="hljs-keyword">const</span> modules = fs.<span class="hljs-title function_">readdirSync</span>(componentsDir).<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> fullPath = path.<span class="hljs-title function_">join</span>(componentsDir, name);
    <span class="hljs-comment">// åªè·å–ç›®å½•ï¼Œæ’é™¤æ–‡ä»¶</span>
    <span class="hljs-keyword">return</span> fs.<span class="hljs-title function_">statSync</span>(fullPath).<span class="hljs-title function_">isDirectory</span>();
});

<span class="hljs-keyword">const</span> entryArr = {
    <span class="hljs-comment">// ä¸»å…¥å£</span>
    <span class="hljs-attr">index</span>: <span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">"./packages/components/index.ts"</span>),

    <span class="hljs-comment">// å·¥å…·å…¥å£</span>
    <span class="hljs-attr">utils</span>: <span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">"./packages/utils/index.ts"</span>),
};

<span class="hljs-comment">// ä¸ºæ¯ä¸ªç»„ä»¶åˆ›å»ºç‹¬ç«‹å…¥å£</span>
modules.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
    entryArr[<span class="hljs-string">`components/<span class="hljs-subst">${name}</span>/index`</span>] = <span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">`./packages/components/<span class="hljs-subst">${name}</span>/index.ts`</span>);
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(<span class="hljs-function">(<span class="hljs-params">{ command, mode }</span>) =&gt;</span> {
    <span class="hljs-comment">// ä¸»æ„å»ºé…ç½®</span>
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">plugins</span>: [
            <span class="hljs-title function_">vue</span>(),
        ],
        <span class="hljs-attr">build</span>: {
            <span class="hljs-attr">lib</span>: {
                <span class="hljs-attr">entry</span>: entryArr,
                <span class="hljs-attr">formats</span>: [<span class="hljs-string">"es"</span>], <span class="hljs-comment">// åªæ„å»º ES æ¨¡å—</span>
                <span class="hljs-attr">cssFileName</span>: <span class="hljs-string">"style"</span>,
            },
            <span class="hljs-attr">rollupOptions</span>: {
                <span class="hljs-attr">external</span>: [
                    <span class="hljs-string">"vue"</span>,
                ],
                <span class="hljs-attr">output</span>: {
                    <span class="hljs-attr">format</span>: <span class="hljs-string">"es"</span>,
                    <span class="hljs-attr">preserveModules</span>: <span class="hljs-literal">true</span>,
                },
            },
        },
    };
});
</code></pre>
<p>è®¾ç½®å®Œ Vite é…ç½®æ–‡ä»¶åï¼Œæˆ‘ä»¬è¿˜è¦è®¾ç½® <code>packages.json</code> ä¸­çš„æ‰“åŒ…å‘½ä»¤è„šæœ¬é…ç½®ï¼Œè®¾ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-string">"scripts"</span>: {
    <span class="hljs-string">"build"</span>: <span class="hljs-string">"vite build"</span>
  },
</code></pre>
<p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æ ¹ç›®å½•è¿è¡Œæ‰“åŒ…å‘½ä»¤äº†ï¼š<code>pnpm build</code>ã€‚</p>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œæˆ‘ä»¬æˆåŠŸæ‰“åŒ…äº†æˆ‘ä»¬çš„ç»„ä»¶åº“ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c195ef5bfdd043c2a61e6435e0d4c4f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29ieXRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763905528&amp;x-signature=uSri%2FlN4ICmesLuFyDi%2BF3Vssl8%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">é€šè¿‡ pnpm å®‰è£…æœ¬åœ° npm åŒ…</h3>
<p>æ¥ç€æˆ‘ä»¬åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæµ‹è¯•é¡¹ç›®ï¼š</p>
<pre><code class="hljs language-lua" lang="lua">pnpm <span class="hljs-built_in">create</span> vite play <span class="hljs-comment">--template vue-ts</span>
</code></pre>
<p>ä¸Šè¿° play å°±æ˜¯æµ‹è¯•é¡¹ç›®ç›®å½•ï¼Œæˆ‘ä»¬åŸæœ¬å°±å»ºäº†ä¸€ä¸ª play ç›®å½•ï¼Œç°åœ¨è¿™æ¡å‘½ä»¤ä¼šç›´æ¥åœ¨ play ç›®å½•ä¸­ç”Ÿæˆä¸€ä¸ªä½¿ç”¨ Vite åˆ›å»ºçš„ Vue é¡¹ç›®ã€‚</p>
<p>æ¥ç€æˆ‘ä»¬ä¿®æ”¹æ ¹ç›®å½•çš„ package.json æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-deletion">- "main": "index.js",</span>
<span class="hljs-addition">+ "module": "/dist/index.mjs",</span>
</code></pre>
<p>æ¥ç€æˆ‘ä»¬è¿›å…¥ play ç›®å½•ï¼Œé€šè¿‡ pnpm å®‰è£…æœ¬åœ° npm åŒ…ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">pnpm <span class="hljs-keyword">add</span> ../
</code></pre>
<p>è¿è¡Œå®Œä¸Šè¿°å‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>./play/packages.json</code> æ–‡ä»¶å˜åŒ–å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3f21a2e6b8f4ee08a4a56ae78e9f51e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29ieXRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763905528&amp;x-signature=GmvFW3i3GJ9n8Fuw656PlJx5h%2Fc%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æˆåŠŸæŠŠæˆ‘ä»¬æœ¬åœ°çš„ npm åŒ…å®‰è£…åˆ° play æµ‹è¯•é¡¹ç›®ä¸­äº†ã€‚</p>
<p>æ¥ç€ä¿®æ”¹ <code>./play/main.ts</code> å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">CobyteViteUI</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'cobyte-vite-ui'</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'cobyte-vite-ui/dist/style.css'</span>

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)
app.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">CobyteViteUI</span>)
app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
</code></pre>
<p>æˆ‘ä»¬ç›´æ¥å¼•ç”¨æˆ‘ä»¬æœ¬åœ°åˆ›å»ºçš„ npm åŒ…ã€‚</p>
<p>æ¥ç€ä¿®æ”¹ <code>./play/App.vue</code> å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">co-button</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">co-button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>æœ€åæˆ‘ä»¬è¿è¡Œ play æµ‹è¯•é¡¹ç›®ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/74f6c189f9d44171887736447e2e142d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29ieXRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763905528&amp;x-signature=kvnojOly9beWhKfj52wsCyNla5U%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆåŠŸè¿è¡Œäº†æœ¬åœ°ç»„ä»¶åº“çš„ npm åŒ…ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¸Œæœ›ä¸è¿›è¡Œå®Œæ•´å¼•å…¥ç»„ä»¶åº“ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">import { createApp } from 'vue'
import App from './App.vue'
<span class="hljs-deletion">- import CobyteViteUI from 'cobyte-vite-ui'</span>
<span class="hljs-deletion">- import 'cobyte-vite-ui/dist/style.css'</span>

const app = createApp(App)
<span class="hljs-deletion">- app.use(CobyteViteUI)</span>
app.mount('#app')
</code></pre>
<p>å³ä¾¿è¿™æ ·æˆ‘ä»¬åŒæ ·å¯ä»¥åœ¨æµ‹è¯•é¡¹ç›®ä¸­ä½¿ç”¨æˆ‘ä»¬çš„æµ‹è¯•ç»„ä»¶ã€‚</p>
<h3 data-id="heading-4">é€šè¿‡é™æ€åˆ†æå®ç°æŒ‰éœ€åŠ è½½</h3>
<p>æ ¹æ®ä¸Šæ–‡æˆ‘ä»¬çŸ¥é“ App.vue çš„æ¨¡æ¿å†…å®¹ä¼šè¢«ç¼–è¯‘æˆï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { resolveComponent <span class="hljs-keyword">as</span> _resolveComponent, createVNode <span class="hljs-keyword">as</span> _createVNode, openBlock <span class="hljs-keyword">as</span> _openBlock, createElementBlock <span class="hljs-keyword">as</span> _createElementBlock } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params">_ctx, _cache, $props, $setup, $data, $options</span>) {
  <span class="hljs-keyword">const</span> _component_co_button = <span class="hljs-title function_">_resolveComponent</span>(<span class="hljs-string">"co-button"</span>)

  <span class="hljs-keyword">return</span> (<span class="hljs-title function_">_openBlock</span>(), <span class="hljs-title function_">_createElementBlock</span>(<span class="hljs-string">"template"</span>, <span class="hljs-literal">null</span>, [
    <span class="hljs-title function_">_createVNode</span>(_component_co_button)
  ]))
}
</code></pre>
<p>é‚£ä¹ˆæ ¹æ®ä¸Šæ–‡æˆ‘ä»¬çŸ¥é“éœ€è¦æŠŠ <code>_resolveComponent("co-button")</code> éƒ¨åˆ†æ›¿æ¢æˆå¯¹åº”çš„ç»„ä»¶å¯¹è±¡ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-addition">+ import CoButton from 'cobyte-vite-ui/dist/components/button'</span>
<span class="hljs-addition">+ import 'cobyte-vite-ui/dist/style.css'</span>
import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from "vue"

export function render(_ctx, _cache, $props, $setup, $data, $options) {
<span class="hljs-deletion">-  const _component_co_button = _resolveComponent("co-button")</span>
<span class="hljs-addition">+  const _component_co_button = CoButton</span>

  return (_openBlock(), _createElementBlock("template", null, [
    _createVNode(_component_co_button)
  ]))
}
</code></pre>
<p>é‚£ä¹ˆè¦å®ç°ä¸Šè¿°åŠŸèƒ½ï¼Œæˆ‘ä»¬å¾—é€šè¿‡ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.vitejs.dev%2Fguide%2Fapi-plugin" target="_blank" title="https://cn.vitejs.dev/guide/api-plugin" ref="nofollow noopener noreferrer">Vite æ’ä»¶</a>æ¥å®ç°ï¼Œæˆ‘ä»¬åœ¨ä¸Šé¢å®‰è£…äº†ä¸€ä¸ª <code>@vitejs/plugin-vue</code> æ’ä»¶ï¼Œè¿™ä¸ª Vite æ’ä»¶çš„ä¸»è¦åŠŸèƒ½å°±æ˜¯æŠŠ <code>.vue</code> æ–‡ä»¶ç¼–è¯‘æˆä¸Šè¿°çš„ js å†…å®¹ã€‚é‚£ä¹ˆæˆ‘ä»¬è¿™æ ·åœ¨å®ƒçš„åé¢ç»§ç»­æ·»åŠ ä¸€ä¸ªæ’ä»¶åœ¨ç¼–è¯‘åçš„ js å†…å®¹ä¸­å»å®ç°ä¸Šè¿°æ›¿æ¢åŠŸèƒ½å³å¯ã€‚</p>
<p>æˆ‘ä»¬åœ¨ <code>./packages/utils/index.ts</code> æ–‡ä»¶ä¸­å®ç°è¿™ä¸ªè‡ªåŠ¨åŠ è½½ç»„ä»¶çš„ Vite æ’ä»¶ï¼Œå®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">MagicString</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'magic-string'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">VitePluginAutoComponents</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-comment">// æ’ä»¶åç§°ï¼Œç”¨äºè°ƒè¯•å’Œé”™è¯¯ä¿¡æ¯</span>
    <span class="hljs-attr">name</span>: <span class="hljs-string">'vite-plugin-auto-component'</span>,

    <span class="hljs-comment">// transform é’©å­å‡½æ•°ï¼Œåœ¨è½¬æ¢æ¨¡å—æ—¶è°ƒç”¨</span>
    <span class="hljs-comment">// code: æ–‡ä»¶å†…å®¹ï¼Œid: æ–‡ä»¶è·¯å¾„</span>
    <span class="hljs-title function_">transform</span>(<span class="hljs-params">code, id</span>) {
      <span class="hljs-comment">// ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸º.vueæ–‡ä»¶</span>
      <span class="hljs-comment">// å¦‚æœä¸æ˜¯.vueæ–‡ä»¶ï¼Œä¸è¿›è¡Œå¤„ç†</span>
      <span class="hljs-keyword">if</span>(<span class="hljs-regexp">/\.vue$/</span>.<span class="hljs-title function_">test</span>(id)) {
          <span class="hljs-comment">// åˆ›å»º MagicString å®ä¾‹ï¼Œç”¨äºé«˜æ•ˆåœ°ä¿®æ”¹å­—ç¬¦ä¸²å¹¶ç”Ÿæˆ source map</span>
          <span class="hljs-keyword">const</span> s = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MagicString</span>(code)
          <span class="hljs-comment">// åˆå§‹åŒ–ç»“æœæ•°ç»„ï¼Œç”¨äºå­˜å‚¨åŒ¹é…åˆ°çš„ç»„ä»¶ä¿¡æ¯</span>
          <span class="hljs-keyword">const</span> results = []

          <span class="hljs-comment">// ä½¿ç”¨ matchAll æ–¹æ³•æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…çš„ resolveComponent è°ƒç”¨</span>
          <span class="hljs-comment">// æ­£åˆ™è¡¨è¾¾å¼è§£é‡Šï¼š</span>
          <span class="hljs-comment">// _?resolveComponent\d* - åŒ¹é…å¯èƒ½çš„å‡½æ•°åå˜ä½“ï¼ˆå¯èƒ½å¸¦ä¸‹åˆ’çº¿æˆ–æ•°å­—åç¼€ï¼‰</span>
          <span class="hljs-comment">// \("(.+?)"\) - åŒ¹é…æ‹¬å·å†…çš„å­—ç¬¦ä¸²å‚æ•°</span>
          <span class="hljs-comment">// g - å…¨å±€åŒ¹é…</span>
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> match <span class="hljs-keyword">of</span> code.<span class="hljs-title function_">matchAll</span>(<span class="hljs-regexp">/_?resolveComponent\d*\("(.+?)"\)/g</span>)) {
              <span class="hljs-comment">// match[1] æ˜¯ç¬¬ä¸€ä¸ªæ•è·ç»„ï¼Œå³ç»„ä»¶åç§°å­—ç¬¦ä¸²</span>
              <span class="hljs-keyword">const</span> matchedName = match[<span class="hljs-number">1</span>]
              <span class="hljs-comment">// æ£€æŸ¥åŒ¹é…æ˜¯å¦æœ‰æ•ˆï¼š</span>
              <span class="hljs-comment">// match.index != null - ç¡®ä¿æœ‰åŒ¹é…ä½ç½®</span>
              <span class="hljs-comment">// matchedName - ç¡®ä¿æ•è·åˆ°ç»„ä»¶å</span>
              <span class="hljs-comment">// !matchedName.startsWith('_') - ç¡®ä¿ç»„ä»¶åä¸ä»¥_å¼€å¤´ï¼ˆå¯èƒ½æ˜¯å†…éƒ¨ç»„ä»¶ï¼‰</span>
              <span class="hljs-keyword">if</span> (match.<span class="hljs-property">index</span> != <span class="hljs-literal">null</span> &amp;&amp; matchedName &amp;&amp; !matchedName.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'_'</span>)) {
                  <span class="hljs-comment">// è®¡ç®—åŒ¹é…å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®</span>
                  <span class="hljs-keyword">const</span> start = match.<span class="hljs-property">index</span>
                  <span class="hljs-comment">// è®¡ç®—åŒ¹é…å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®</span>
                  <span class="hljs-keyword">const</span> end = start + match[<span class="hljs-number">0</span>].<span class="hljs-property">length</span>
                  <span class="hljs-comment">// å°†åŒ¹é…ä¿¡æ¯å­˜å…¥ç»“æœæ•°ç»„</span>
                  results.<span class="hljs-title function_">push</span>({
                      <span class="hljs-attr">rawName</span>: matchedName,  <span class="hljs-comment">// åŸå§‹ç»„ä»¶åç§°</span>
                      <span class="hljs-comment">// åˆ›å»ºæ›¿æ¢å‡½æ•°ï¼Œä½¿ç”¨ MagicString çš„ overwrite æ–¹æ³•æ›¿æ¢æŒ‡å®šèŒƒå›´çš„æ–‡æœ¬</span>
                      <span class="hljs-attr">replace</span>: <span class="hljs-function"><span class="hljs-params">resolved</span> =&gt;</span> s.<span class="hljs-title function_">overwrite</span>(start, end, resolved),
                  })
              }
          }

          <span class="hljs-comment">// éå†æ‰€æœ‰åŒ¹é…ç»“æœè¿›è¡Œå¤„ç†</span>
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> { rawName, replace } <span class="hljs-keyword">of</span> results) {
              <span class="hljs-comment">// å®šä¹‰è¦æ›¿æ¢çš„å˜é‡åï¼ˆè¿™é‡Œæš‚æ—¶ç¼–ç ä¸º CoButtonï¼‰</span>
              <span class="hljs-keyword">const</span> varName = <span class="hljs-string">`CoButton`</span>
              <span class="hljs-comment">// åœ¨ä»£ç å¼€å¤´æ·»åŠ å¯¼å…¥è¯­å¥ï¼š</span>
              <span class="hljs-comment">// 1. å¯¼å…¥ CoButton ç»„ä»¶</span>
              <span class="hljs-comment">// 2. å¯¼å…¥æ ·å¼æ–‡ä»¶</span>
              s.<span class="hljs-title function_">prepend</span>(<span class="hljs-string">`import CoButton from 'cobyte-vite-ui/dist/components/button';\nimport 'cobyte-vite-ui/dist/style.css';\n`</span>)

              <span class="hljs-comment">// æ‰§è¡Œæ›¿æ¢ï¼šå°† resolveComponent("xxx") è°ƒç”¨æ›¿æ¢ä¸ºç»„ä»¶å˜é‡å</span>
              <span class="hljs-title function_">replace</span>(varName)
          }

          <span class="hljs-comment">// è¿”å›è½¬æ¢åçš„ä»£ç </span>
          <span class="hljs-keyword">return</span> {
              <span class="hljs-attr">code</span>: s.<span class="hljs-title function_">toString</span>(),  <span class="hljs-comment">// è½¬æ¢åçš„ä»£ç å­—ç¬¦ä¸²</span>
              <span class="hljs-attr">map</span>: <span class="hljs-literal">null</span>, 
          }
      }
    },
  }
}
</code></pre>
<p>æˆ‘ä»¬åœ¨ä¸Šè¿° Vite æ’ä»¶ä¸­ä½¿ç”¨åˆ°äº†ä¸€ä¸ªæ–°å·¥å…·åº“ <code>magic-string</code>ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…ä¸€ä¸‹å®ƒçš„ä¾èµ–ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">pnpm <span class="hljs-keyword">add</span> magic-<span class="hljs-built_in">string</span> -D -w
</code></pre>
<p><code>magic-string</code>Â æ˜¯ä¸€ä¸ªä¸“æ³¨äºå­—ç¬¦ä¸²æ“ä½œï¼Œä¸»è¦ä½œç”¨æ˜¯å¯¹æºä»£ç å¯ä»¥è¿›è¡Œ<strong>ç²¾å‡†çš„æ’å…¥ã€åˆ é™¤ã€æ›¿æ¢ç­‰æ“ä½œ</strong>ã€‚</p>
<p>ä¸Šè¿°ç¼–å†™çš„ Vite çš„æ’ä»¶ä¸»è¦æ˜¯å®ç°åœ¨<code>.vue</code> æ–‡ä»¶ä¸­æŸ¥æ‰¾æ‰€æœ‰å½¢å¦‚ <code>resolveComponent("xxx")</code> çš„å‡½æ•°è°ƒç”¨ï¼Œå¯¹äºæ¯ä¸€ä¸ªæ‰¾åˆ°çš„è°ƒç”¨ï¼Œå®ƒä¼šåœ¨æ–‡ä»¶é¡¶éƒ¨æ·»åŠ ä¸€ä¸ªå›ºå®šçš„å¯¼å…¥è¯­å¥ï¼Œä¾‹å¦‚å¯¼å…¥ <code>CoButton</code> ç»„ä»¶å’Œæ ·å¼ã€‚æœ€åæŠŠæ‰¾åˆ°çš„<code>resolveComponent("xxx")</code> æ›¿æ¢æˆå¯¹åº”çš„ç»„ä»¶ï¼Œä¾‹å¦‚ <code>CoButton</code>ã€‚</p>
<p>ç„¶åæˆ‘ä»¬åœ¨æ ¹ç›®å½•é‡æ–°æ‰“åŒ…ï¼Œæ¥ç€åœ¨ play ç›®å½•ä¸­çš„ <code>vite.config.ts</code> æ–‡ä»¶ä¸­è¿›è¡Œä»¥ä¸‹ä¿®æ”¹ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
<span class="hljs-addition">+ import AutoComponents from 'cobyte-vite-ui/dist/utils'</span>

// https://vite.dev/config/
export default defineConfig({
<span class="hljs-deletion">-  plugins: [vue()],</span>
<span class="hljs-addition">+  plugins: [vue(), AutoComponents()],</span>
})
</code></pre>
<p>æ¥ç€æˆ‘ä»¬å†æ¬¡é‡å¯ play æµ‹è¯•é¡¹ç›®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å³ä¾¿æˆ‘ä»¬ä¸å¯¼å…¥ä»»ä½•æˆ‘ä»¬ç¼–å†™çš„ç»„ä»¶åº“è®¾ç½®ï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥åœ¨ play é¡¹ç›®ä¸­æˆåŠŸä½¿ç”¨ <code>CoButton</code> ç»„ä»¶ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/74f6c189f9d44171887736447e2e142d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29ieXRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763905528&amp;x-signature=kvnojOly9beWhKfj52wsCyNla5U%3D" alt="image.png" loading="lazy"/></p>
<p>åŒæ—¶æˆ‘ä»¬åœ¨ç½‘ç»œçª—å£å¯ä»¥æŸ¥çœ‹åˆ° App.vue æ–‡ä»¶çš„å†…å®¹å˜åŒ–å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f36029b5c57d4c9ca82ddb0fecd2f3be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29ieXRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763905528&amp;x-signature=t1CzRagQrOlUssF9zNOZpEvdDqI%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°<strong>æˆ‘ä»¬é€šè¿‡é™æ€åˆ†æä»£ç ï¼Œè¯†åˆ«å¹¶æ›¿æ¢ Vue3 çš„ç»„ä»¶è§£æå‡½æ•°ï¼ŒæˆåŠŸå®ç°äº†ç»„ä»¶çš„è‡ªåŠ¨å¯¼å…¥åŠŸèƒ½</strong>ã€‚ä½†ä¸Šè¿°å®ç°ä¸ºäº†å¿«é€ŸéªŒè¯åŠŸèƒ½ï¼Œæ— è®ºåŒ¹é…åˆ°çš„ç»„ä»¶åæ˜¯ä»€ä¹ˆï¼Œéƒ½å¯¼å…¥ <code>CoButton</code> ç»„ä»¶ï¼Œå¹¶æ›¿æ¢ä¸º <code>CoButton</code>ã€‚è¿™æ˜¾ç„¶æ˜¯ä¸æ­£ç¡®çš„ï¼Œåº”è¯¥æ ¹æ®åŒ¹é…åˆ°çš„ç»„ä»¶ååŠ¨æ€å¯¼å…¥å¯¹åº”çš„ç»„ä»¶ã€‚</p>
<h3 data-id="heading-5">è‡ªåŠ¨åŒ–è·¯å¾„è§£æ</h3>
<p>å› ä¸ºæˆ‘ä»¬çš„ç»„ä»¶ç¼–è¯‘åçš„è°ƒç”¨å˜æˆ <code>_resolveComponent("co-button")</code>ï¼Œç»„ä»¶åç§°å˜æˆäº† <code>co-button</code>ï¼Œè€Œæˆ‘ä»¬åœ¨å¯¼å…¥çš„è¯­å¥æ˜¯è¿™æ ·çš„ <code>import CoButton from 'cobyte-vite-ui/dist/components/button'</code>ï¼Œç»„ä»¶åç§°åˆéœ€è¦å˜æˆ <code>CoButton</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠåŒ¹é…åˆ°çš„ <code>co-button</code> å˜æˆ <code>CoButton</code>ã€‚</p>
<p>ä»£ç è¿­ä»£å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-addition">+ // å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¸•æ–¯å¡å‘½åï¼ˆå³å¤§é©¼å³°ï¼Œæ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™ï¼‰</span>
<span class="hljs-addition">+ export function pascalCase(str: string) {</span>
<span class="hljs-addition">+    return capitalize(camelCase(str))</span>
<span class="hljs-addition">+ }</span>
<span class="hljs-addition">+ // å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºé©¼å³°å‘½å  </span>
<span class="hljs-addition">+ export function camelCase(str: string) {</span>
<span class="hljs-addition">+    return str.replace(/-(\w)/g, (_, c) =&gt; (c ? c.toUpperCase() : ''))</span>
<span class="hljs-addition">+ }</span>
<span class="hljs-addition">+ // å°†å­—ç¬¦ä¸²çš„é¦–å­—æ¯å¤§å†™ï¼Œä½¿ç”¨ charAt(0) è·å–ç¬¬ä¸€ä¸ªå­—ç¬¦å¹¶è½¬æ¢ä¸ºå¤§å†™ï¼Œç„¶ååŠ ä¸Šå‰©ä½™å­—ç¬¦ä¸²ï¼ˆä»ç´¢å¼•1å¼€å§‹ï¼‰</span>
<span class="hljs-addition">+ export function capitalize(str: string) {</span>
<span class="hljs-addition">+    return str.charAt(0).toUpperCase() + str.slice(1)</span>
<span class="hljs-addition">+ }</span>

export default function VitePluginAutoComponents() {
    return {
      // æ’ä»¶åç§°ï¼Œç”¨äºè°ƒè¯•å’Œé”™è¯¯ä¿¡æ¯
      name: 'vite-plugin-auto-component',
  
      // transform é’©å­å‡½æ•°ï¼Œåœ¨è½¬æ¢æ¨¡å—æ—¶è°ƒç”¨
      // code: æ–‡ä»¶å†…å®¹ï¼Œid: æ–‡ä»¶è·¯å¾„
      transform(code, id) {
        // ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸º.vueæ–‡ä»¶
        // å¦‚æœä¸æ˜¯.vueæ–‡ä»¶ï¼Œä¸è¿›è¡Œå¤„ç†
        if(/\.vue$/.test(id)) {
            // çœç•¥...
  
            // éå†æ‰€æœ‰åŒ¹é…ç»“æœè¿›è¡Œå¤„ç†
            for (const { rawName, replace } of results) {
<span class="hljs-addition">+                // å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§é©¼å³°</span>
<span class="hljs-addition">+                const name = pascalCase(rawName)</span>
<span class="hljs-addition">+                // åªå¤„ç† Co å¼€å¤´çš„ç»„ä»¶</span>
<span class="hljs-addition">+                if (!name.match(/^Co[A-Z]/)) return</span>
                // å®šä¹‰è¦æ›¿æ¢çš„å˜é‡å
<span class="hljs-deletion">-                const varName = `CoButton`</span>
<span class="hljs-addition">+                const varName = name</span>
                // åœ¨ä»£ç å¼€å¤´æ·»åŠ å¯¼å…¥è¯­å¥ï¼š
                // 1. å¯¼å…¥ CoButton ç»„ä»¶
                // 2. å¯¼å…¥æ ·å¼æ–‡ä»¶
                s.prepend(`\nimport ${varName} from 'cobyte-vite-ui/dist/components/button';\nimport 'cobyte-vite-ui/dist/style.css';\n`)
  
                // æ‰§è¡Œæ›¿æ¢ï¼šå°† resolveComponent("xxx") è°ƒç”¨æ›¿æ¢ä¸ºç»„ä»¶å˜é‡å
                replace(varName)
            }
  
            // è¿”å›è½¬æ¢åçš„ä»£ç 
            return {
                code: s.toString(),  // è½¬æ¢åçš„ä»£ç å­—ç¬¦ä¸²
                map: null, 
            }
        }
      },
    }
}
</code></pre>
<p>ç»è¿‡ä¸Šè¿°å®ç°è¿˜æ˜¯å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼Œæ— è®ºÂ <code>rawName</code>Â æ˜¯ä»€ä¹ˆï¼Œç»„ä»¶éƒ½æ˜¯ä»Â <code>'cobyte-vite-ui/dist/components/button'</code>Â è¿™ä¸ªå›ºå®šè·¯å¾„å¯¼å…¥ã€‚è¿™æ„å‘³ç€å³ä½¿ä½¿ç”¨äº†Â <code>resolveComponent("CoTable")</code>ï¼Œæ’ä»¶ä¾ç„¶ä¼šå°è¯•ä»Â <code>button</code>Â æ–‡ä»¶å¯¼å…¥ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸æ­£ç¡®çš„ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œå¯¼å…¥è·¯å¾„åº”æ ¹æ®ç»„ä»¶ååŠ¨æ€ç”Ÿæˆã€‚æ‰€ä»¥æˆ‘ä»¬ç»§ç»­å®ç°åŠ¨æ€ç»„ä»¶è·¯å¾„ï¼Œä¾‹å¦‚Â <code>CoTableColumn</code>Â ç»„ä»¶æ˜ å°„åˆ°Â <code>'cobyte-vite-ui/dist/components/table-column'</code>ã€‚</p>
<p>æˆ‘ä»¬ä¸Šè¿°çš„ç»„ä»¶æ˜¯ "CoButton"ï¼Œé‚£ä¹ˆè½¬æ¢è¿‡ç¨‹åˆ™æ˜¯ï¼š<br/>
"CoButton" -&gt; å»æ‰"Co" -&gt; "Button" -&gt; kebabCase -&gt; "button"ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡å®ç°ä¸€ä¸ª kebabCase å‡½æ•°è¿›è¡Œç»„ä»¶è·¯å¾„è½¬æ¢è§£æï¼Œå®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">// çœç•¥...

<span class="hljs-addition">+ // å°†é©¼å³°å‘½åçš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºçŸ­æ¨ªçº¿åˆ†éš”çš„å­—ç¬¦ä¸²ï¼ˆå³kebab-caseï¼‰</span>
<span class="hljs-addition">+ export function kebabCase(key: string) {</span>
<span class="hljs-addition">+    const result = key.replace(/([A-Z])/g, ' $1').trim()</span>
<span class="hljs-addition">+    return result.split(' ').join('-').toLowerCase()</span>
<span class="hljs-addition">+ }</span>

export default function VitePluginAutoComponents() {
    return {
      // æ’ä»¶åç§°ï¼Œç”¨äºè°ƒè¯•å’Œé”™è¯¯ä¿¡æ¯
      name: 'vite-plugin-auto-component',
  
      // transform é’©å­å‡½æ•°ï¼Œåœ¨è½¬æ¢æ¨¡å—æ—¶è°ƒç”¨
      // code: æ–‡ä»¶å†…å®¹ï¼Œid: æ–‡ä»¶è·¯å¾„
      transform(code, id) {
        // ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸º.vueæ–‡ä»¶
        // å¦‚æœä¸æ˜¯.vueæ–‡ä»¶ï¼Œä¸è¿›è¡Œå¤„ç†
        if(/\.vue$/.test(id)) {
            // çœç•¥...
  
            // éå†æ‰€æœ‰åŒ¹é…ç»“æœè¿›è¡Œå¤„ç†
            for (const { rawName, replace } of results) {
                // å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§é©¼å³°
                const name = pascalCase(rawName)
                // åªå¤„ç† Co å¼€å¤´çš„ç»„ä»¶
                if (!name.match(/^Co[A-Z]/)) return
<span class="hljs-addition">+                // ç»„ä»¶è·¯å¾„è½¬æ¢</span>
<span class="hljs-addition">+                const partialName = kebabCase(name.slice(2))</span>
                // å®šä¹‰è¦æ›¿æ¢çš„å˜é‡å
                const varName = name
                // åœ¨ä»£ç å¼€å¤´æ·»åŠ å¯¼å…¥è¯­å¥ï¼š
                // 1. å¯¼å…¥ CoButton ç»„ä»¶
                // 2. å¯¼å…¥æ ·å¼æ–‡ä»¶
<span class="hljs-deletion">-                s.prepend(`\nimport ${varName} from 'cobyte-vite-ui/dist/components/button';\nimport 'cobyte-vite-ui/dist/style.css';\n`)</span>
<span class="hljs-addition">+                s.prepend(`\nimport ${varName} from 'cobyte-vite-ui/dist/components/${partialName}';\nimport 'cobyte-vite-ui/dist/style.css';\n`)</span>
  
                // æ‰§è¡Œæ›¿æ¢ï¼šå°† resolveComponent("xxx") è°ƒç”¨æ›¿æ¢ä¸ºç»„ä»¶å˜é‡å
                replace(varName)
            }
  
            // è¿”å›è½¬æ¢åçš„ä»£ç 
            return {
                code: s.toString(),  // è½¬æ¢åçš„ä»£ç å­—ç¬¦ä¸²
                map: null, 
            }
        }
      },
    }
}
</code></pre>
<p>ç»è¿‡ä¸Šè¿°è¿­ä»£åï¼Œæˆ‘ä»¬é‡æ–°æ‰“åŒ…ï¼Œé‡æ–°å¯åŠ¨ play æµ‹è¯•é¡¹ç›®ï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬çš„ä»£ç æ˜¯èƒ½å¤Ÿæ­£å¸¸è¿è¡Œçš„ï¼Œè¯´æ˜æˆ‘ä»¬ä¸Šè¿°çš„è¿­ä»£æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚<strong>è‡³æ­¤æˆ‘ä»¬ä¸ºç»„ä»¶è‡ªåŠ¨å¯¼å…¥æä¾›äº†æ ¸å¿ƒçš„è·¯å¾„è§£æèƒ½åŠ›</strong>ã€‚</p>
<h3 data-id="heading-6">å¼•å…¥è§£æå™¨ (Resolver) æ¦‚å¿µ</h3>
<p>å½“å‰æ’ä»¶ç¡¬ç¼–ç äº†ç»„ä»¶åº“çš„è·¯å¾„å’Œæ ·å¼æ–‡ä»¶ï¼Œåªèƒ½ç”¨äºç‰¹å®šçš„ç»„ä»¶åº“ï¼ˆcobyte-vite-uiï¼‰ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•å…¥è§£æå™¨(Resolver)ï¼Œè®©æ’ä»¶æ”¯æŒä¸åŒçš„ç»„ä»¶åº“ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦é…ç½®ä¸åŒçš„è§£æå™¨ã€‚</p>
<p>è§£æå™¨çš„ä½œç”¨æ˜¯æ ¹æ®ç»„ä»¶åè¿”å›ä¸€ä¸ªè§£æç»“æœï¼ŒåŒ…æ‹¬ç»„ä»¶çš„å¯¼å…¥è·¯å¾„å’Œæ ·å¼æ–‡ä»¶è·¯å¾„ä»¥åŠç»„ä»¶åŸå§‹åç§°ã€‚è¿™æ ·ï¼Œæ’ä»¶å°±å¯ä»¥é€šè¿‡è§£æå™¨è¿”å›çš„å¯¹è±¡ä¿¡æ¯åŠ¨æ€è·å–ç»„ä»¶çš„å¯¼å…¥ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å›ºå®šå†™æ­»ã€‚</p>
<p>åœ¨å®ç°è§£æå™¨ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè®¾è®¡è§£æå™¨è¿”å›çš„å¯¹è±¡ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> component = {
    name, <span class="hljs-comment">// ç»„ä»¶åŸå§‹åç§°</span>
    <span class="hljs-attr">from</span>: <span class="hljs-string">`cobyte-vite-ui/dist/components/<span class="hljs-subst">${partialName}</span>`</span>, <span class="hljs-comment">// ç»„ä»¶çš„å¯¼å…¥è·¯å¾„</span>
    <span class="hljs-attr">sideEffects</span>: [<span class="hljs-string">'cobyte-vite-ui/dist/style.css'</span>] <span class="hljs-comment">// ç»„ä»¶çš„æ ·å¼æ–‡ä»¶è·¯å¾„</span>
}
</code></pre>
<p>ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡ï¼Ÿ</p>
<ol>
<li>ç»„ä»¶å (name):<br/>
ç”¨äºåœ¨å¯¼å…¥è¯­å¥ä¸­ä½œä¸ºæ ‡è¯†ç¬¦ã€‚è¿™é‡Œä½¿ç”¨çš„æ˜¯å¸•æ–¯å¡å‘½åï¼Œå› ä¸ºå®ƒåœ¨ Vue ä¸­é€šå¸¸ç”¨äºç»„ä»¶æ³¨å†Œå’Œæ¨¡æ¿ä¸­ã€‚</li>
<li>å¯¼å…¥è·¯å¾„ (from):<br/>
è¿™é‡Œä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²åŠ¨æ€æ„å»ºå¯¼å…¥è·¯å¾„ã€‚å…¶ä¸­ï¼Œ<code>partialName</code>Â æ˜¯é€šè¿‡å°†ç»„ä»¶åå»æ‰å‰ä¸¤ä¸ªå­—ç¬¦ï¼ˆå³å»æ‰"Co"ï¼‰å¹¶è½¬æ¢ä¸º kebab-case å¾—åˆ°çš„ã€‚<br/>
ä¾‹å¦‚ï¼Œç»„ä»¶å "CoTableColumn" è½¬æ¢ä¸º "table-column"ï¼Œç„¶åæ‹¼æ¥æˆè·¯å¾„ 'cobyte-vite-ui/dist/components/table-column'ã€‚<br/>
è¿™æ ·è®¾è®¡æ˜¯å› ä¸ºç»„ä»¶åº“çš„ç›®å½•ç»“æ„å¯èƒ½æ˜¯æŒ‰ç…§ kebab-case å‘½åçš„ï¼Œè€Œç»„ä»¶åœ¨ä»£ç ä¸­æ˜¯ä»¥å¸•æ–¯å¡å‘½åä½¿ç”¨çš„ã€‚</li>
<li>å‰¯ä½œç”¨ (sideEffects):<br/>
è¿™æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒæŒ‡å®šåœ¨å¯¼å…¥ç»„ä»¶æ—¶éœ€è¦åŒæ—¶å¯¼å…¥çš„æ ·å¼æ–‡ä»¶æˆ–å…¶ä»–èµ„æºã€‚è¿™é‡ŒæŒ‡å®šäº†ç»„ä»¶åº“çš„å…¨å±€æ ·å¼æ–‡ä»¶ã€‚<br/>
æ³¨æ„ï¼šè¿™ä¸ªæ ·å¼æ–‡ä»¶æ˜¯å…¨å±€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ç®¡å¯¼å…¥å“ªä¸ªç»„ä»¶ï¼Œéƒ½ä¼šå¯¼å…¥æ•´ä¸ªç»„ä»¶åº“çš„æ ·å¼ã€‚è¿™å¯èƒ½ä¼šé€ æˆæ ·å¼å†—ä½™ã€‚<br/>
æ›´ç²¾ç»†çš„åšæ³•æ˜¯ä¸ºæ¯ä¸ªç»„ä»¶æŒ‡å®šå…¶å¯¹åº”çš„æ ·å¼æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š<br/>
sideEffects: [<code>cobyte-vite-ui/dist/components/${partialName}/style.css</code>]</li>
</ol>
<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬å½“å‰ç»„ä»¶åº“æ²¡æœ‰ä¸ºæ¯ä¸ªç»„ä»¶å•ç‹¬æä¾›æ ·å¼æ–‡ä»¶ï¼Œæˆ‘ä»¬åªæä¾›äº†å›ºå®šçš„å…¨å±€æ ·å¼æ–‡ä»¶ã€‚</p>
<p>ä¸Šé¢è®¾è®¡è§£æå™¨è¿”å›çš„å¯¹è±¡å°è£…äº†ç»„ä»¶çš„å®Œæ•´å¯¼å…¥ä¿¡æ¯ï¼Œä½œä¸ºæ•°æ®è½½ä½“ä¼ é€’ç»™åç»­å¤„ç†å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºæ­¤è¿›è¡Œè¿­ä»£ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">// çœç•¥...

<span class="hljs-addition">+ // æ ¹æ®ä¼ å…¥çš„ä¿¡æ¯ç”Ÿæˆå¯¹åº”çš„å¯¼å…¥è¯­å¥å­—ç¬¦ä¸²</span>
<span class="hljs-addition">+ export function stringifyImport(info) {</span>
<span class="hljs-addition">+    if (typeof info === 'string')</span>
<span class="hljs-addition">+      return `import '${info}'`</span>
<span class="hljs-addition">+    if (!info.as)</span>
<span class="hljs-addition">+      return `import '${info.from}'`</span>
<span class="hljs-addition">+    else if (info.name)</span>
<span class="hljs-addition">+      return `import { ${info.name} as ${info.as} } from '${info.from}'`</span>
<span class="hljs-addition">+    else</span>
<span class="hljs-addition">+      return `import ${info.as} from '${info.from}'`</span>
<span class="hljs-addition">+ }</span>
<span class="hljs-addition">+ // æ ¹æ®ç»„ä»¶çš„å¯¼å…¥ä¿¡æ¯ç”Ÿæˆå®Œæ•´çš„å¯¼å…¥è¯­å¥ï¼ŒåŒ…æ‹¬ç»„ä»¶æœ¬èº«çš„å¯¼å…¥å’Œå…¶å‰¯ä½œç”¨ï¼ˆå¦‚æ ·å¼æ–‡ä»¶ï¼‰çš„å¯¼å…¥ã€‚</span>
<span class="hljs-addition">+ export function stringifyComponentImport({ as: name, from: path, name: importName, sideEffects }) {</span>
<span class="hljs-addition">+    const imports = [</span>
<span class="hljs-addition">+      // ç”Ÿæˆç»„ä»¶å¯¼å…¥è¯­å¥</span>
<span class="hljs-addition">+      stringifyImport({ as: name, from: path, name: importName }),</span>
<span class="hljs-addition">+    ]</span>
  
<span class="hljs-addition">+    if (sideEffects) {</span>
<span class="hljs-addition">+      // ç”Ÿæˆå‰¯ä½œç”¨å¯¼å…¥è¯­å¥</span>
<span class="hljs-addition">+      sideEffects.forEach(i =&gt; imports.push(stringifyImport(i)))</span>
<span class="hljs-addition">+    }</span>
  
<span class="hljs-addition">+    return imports.join(';')</span>
<span class="hljs-addition">+ }</span>

  export default function VitePluginAutoComponents() {
    return {
      // æ’ä»¶åç§°ï¼Œç”¨äºè°ƒè¯•å’Œé”™è¯¯ä¿¡æ¯
      name: 'vite-plugin-auto-component',
  
      // transform é’©å­å‡½æ•°ï¼Œåœ¨è½¬æ¢æ¨¡å—æ—¶è°ƒç”¨
      // code: æ–‡ä»¶å†…å®¹ï¼Œid: æ–‡ä»¶è·¯å¾„
      transform(code, id) {
        // ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸º.vueæ–‡ä»¶
        // å¦‚æœä¸æ˜¯.vueæ–‡ä»¶ï¼Œä¸è¿›è¡Œå¤„ç†
        if(/\.vue$/.test(id)) {
            // çœç•¥...
<span class="hljs-addition">+            let no = 0</span>
            // éå†æ‰€æœ‰åŒ¹é…ç»“æœè¿›è¡Œå¤„ç†
            for (const { rawName, replace } of results) {
                // å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§é©¼å³°
                const name = pascalCase(rawName)
                // åªå¤„ç† Co å¼€å¤´çš„ç»„ä»¶
                if (!name.match(/^Co[A-Z]/)) return
                // ç»„ä»¶è·¯å¾„è½¬æ¢
                const partialName = kebabCase(name.slice(2))
<span class="hljs-addition">+                // å°è£…äº†ç»„ä»¶çš„å®Œæ•´å¯¼å…¥ä¿¡æ¯ï¼Œä½œä¸ºæ•°æ®è½½ä½“ä¼ é€’ç»™åç»­å¤„ç†å‡½æ•°</span>
<span class="hljs-addition">+                const component = {</span>
<span class="hljs-addition">+                    name,</span>
<span class="hljs-addition">+                    from: `cobyte-vite-ui/dist/components/${partialName}`,</span>
<span class="hljs-addition">+                    sideEffects: ['cobyte-vite-ui/dist/style.css']</span>
<span class="hljs-addition">+                }</span>
<span class="hljs-deletion">-                // å®šä¹‰è¦æ›¿æ¢çš„å˜é‡åï¼ˆè¿™é‡Œæš‚æ—¶ç¼–ç ä¸º CoButtonï¼‰</span>
<span class="hljs-deletion">-                const varName = name</span>
<span class="hljs-addition">+                // ä½¿ç”¨ç‰¹æ®Šå‰ç¼€å‡å°‘ä¸ç”¨æˆ·å˜é‡çš„å†²çªï¼Œä»¥åŠä½¿ç”¨é€’å¢çš„åºå·ï¼Œä¿è¯å”¯ä¸€æ€§ï¼Œé¿å…å˜é‡åå†²çª</span>
<span class="hljs-addition">+                const varName = `__unplugin_components_${no}`</span>
                // åœ¨ä»£ç å¼€å¤´æ·»åŠ å¯¼å…¥è¯­å¥ï¼š
                // 1. å¯¼å…¥ CoButton ç»„ä»¶
                // 2. å¯¼å…¥æ ·å¼æ–‡ä»¶
<span class="hljs-deletion">-                 s.prepend(`\nimport ${varName} from 'cobyte-vite-ui/dist/components/${partialName}';\nimport 'cobyte-vite-ui/dist/style.css';\n`)</span>
<span class="hljs-addition">+                // è¿™é‡Œå°† component å¯¹è±¡å±•å¼€ï¼Œå¹¶æ·»åŠ  as: varName å‚æ•°ï¼Œå½¢æˆå®Œæ•´çš„å¯¼å…¥é…ç½®</span>
<span class="hljs-addition">+                s.prepend(`${stringifyComponentImport({ ...component, as: varName })};\n`)</span>
<span class="hljs-addition">+                no += 1</span>
                // æ‰§è¡Œæ›¿æ¢ï¼šå°† resolveComponent("xxx") è°ƒç”¨æ›¿æ¢ä¸ºç»„ä»¶å˜é‡å
                replace(varName)
            }
  
            // è¿”å›è½¬æ¢åçš„ä»£ç 
            return {
                code: s.toString(),  // è½¬æ¢åçš„ä»£ç å­—ç¬¦ä¸²
                map: null, 
            }
        }
      },
    }
}
</code></pre>
<p>æˆ‘ä»¬æ·»åŠ äº†æ ¹æ®ä¼ å…¥çš„ä¿¡æ¯ç”Ÿæˆå¯¹åº”çš„å¯¼å…¥è¯­å¥å­—ç¬¦ä¸²çš„ <code>stringifyImport</code> å‡½æ•°å’Œæ ¹æ®ç»„ä»¶çš„å¯¼å…¥ä¿¡æ¯ç”Ÿæˆå®Œæ•´çš„å¯¼å…¥è¯­å¥ï¼ŒåŒ…æ‹¬ç»„ä»¶æœ¬èº«çš„å¯¼å…¥å’Œå…¶å‰¯ä½œç”¨ï¼ˆå¦‚æ ·å¼æ–‡ä»¶ï¼‰çš„å¯¼å…¥çš„ <code>stringifyComponentImport</code> å‡½æ•°ã€‚å…¶ä¸­ stringifyImport å¤„ç†å•ä¸€å¯¼å…¥è¯­å¥ï¼Œ<code>stringifyComponentImport</code> å¤„ç†ç»„åˆå¤šä¸ªç›¸å…³å¯¼å…¥ï¼Œå®ç°äº†èŒè´£åˆ†ç¦»å’Œé…ç½®çµæ´»çš„è®¾è®¡ä¼˜åŠ¿ã€‚è¿™ä¸¤ä¸ªå‡½æ•°å…±åŒæ„æˆäº†ä¸€ä¸ªçµæ´»çš„å¯¼å…¥è¯­å¥ç”Ÿæˆç³»ç»Ÿï¼Œä¸ºè‡ªåŠ¨å¯¼å…¥æ’ä»¶æä¾›äº†å¼ºå¤§çš„ä»£ç ç”Ÿæˆèƒ½åŠ›ã€‚</p>
<p>æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªè§£æç»“æœåŒ…æ‹¬ï¼š<code>name</code>ï¼ˆç»„ä»¶åï¼‰ã€<code>from</code>ï¼ˆå¯¼å…¥è·¯å¾„ï¼‰ã€<code>sideEffects</code>ï¼ˆæ ·å¼ç­‰å‰¯ä½œç”¨å¯¼å…¥ï¼‰çš„æ•°æ®ç»“æ„å¯¹è±¡ <code>component</code> ä½œä¸ºæ•°æ®è½½ä½“ä¼ é€’ç»™åç»­å¤„ç†å‡½æ•°ï¼Œåç»­ç¨‹åºåŸºäºæ­¤æ¥ç”Ÿæˆå¯¼å…¥è¯­å¥å’Œæ›¿æ¢ä»£ç ã€‚</p>
<p>å…¶ä¸­å˜é‡åç”Ÿæˆç­–ç•¥ä½¿ç”¨ç‰¹æ®Šå‰ç¼€å‡å°‘ä¸ç”¨æˆ·å˜é‡çš„å†²çªä»è€Œ<strong>é¿å…æ±¡æŸ“</strong>ï¼ŒåŒæ—¶ä½¿ç”¨é€’å¢åºå·æ¥<strong>ä¿è¯å”¯ä¸€æ€§</strong>ã€‚</p>
<p>æœ€ç»ˆæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªåŸºäºæ•°æ®é©±åŠ¨çš„æ¶æ„ï¼Œå°†æ¥è§£æå™¨åªè´Ÿè´£è¯†åˆ«ç»„ä»¶å’Œè¿”å›è·¯å¾„çš„æ•°æ®ä¿¡æ¯ï¼Œç„¶åå¯¼å…¥ç”Ÿæˆå™¨å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸Šè¿°çš„ <code>stringifyComponentImport</code> å’Œ <code>stringifyImport</code> è´Ÿè´£æ ¹æ®é…ç½®ç”Ÿæˆå¯¼å…¥ä»£ç ï¼Œæˆ‘ä»¬æ•´ä½“çš„ Vite æ’ä»¶å°±åªè´Ÿè´£åè°ƒæµç¨‹å’Œä»£ç ä¿®æ”¹ã€‚</p>
<p>è¿™ç§æ¶æ„ä¸ºåç»­å¼•å…¥çœŸæ­£çš„å¤šè§£æå™¨æ”¯æŒå¥ å®šäº†è‰¯å¥½åŸºç¡€ï¼Œåªéœ€è¦å°†ç¡¬ç¼–ç çš„è§£æé€»è¾‘æ›¿æ¢ä¸ºå¯é…ç½®çš„è§£æå™¨æ•°ç»„å³å¯ã€‚</p>
<h3 data-id="heading-7">å®ç°è§£æå™¨ (Resolver)</h3>
<p>æˆ‘ä»¬å¼•å…¥è§£æå™¨æ˜¯ä¸ºäº†æé«˜æ’ä»¶çš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚å½“å‰æ’ä»¶ç¡¬ç¼–ç äº†ç»„ä»¶åº“çš„è·¯å¾„å’Œæ ·å¼æ–‡ä»¶ï¼Œåªèƒ½ç”¨äºç‰¹å®šçš„ç»„ä»¶åº“ï¼ˆcobyte-vite-uiï¼‰ã€‚é€šè¿‡å¼•å…¥è§£æå™¨ï¼Œæˆ‘ä»¬å¯ä»¥è®©æ’ä»¶æ”¯æŒä¸åŒçš„ç»„ä»¶åº“ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦é…ç½®ä¸åŒçš„è§£æå™¨ã€‚</p>
<p>è§£æå™¨çš„ä½œç”¨æ˜¯æ ¹æ®ç»„ä»¶åè¿”å›ä¸€ä¸ªè§£æç»“æœï¼ŒåŒ…æ‹¬ç»„ä»¶çš„å¯¼å…¥è·¯å¾„å’Œæ ·å¼æ–‡ä»¶è·¯å¾„ç­‰ã€‚è¿™æ ·ï¼Œæ’ä»¶å°±å¯ä»¥é€šè¿‡è§£æå™¨æ¥åŠ¨æ€è·å–ç»„ä»¶çš„å¯¼å…¥ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å›ºå®šå†™æ­»ã€‚</p>
<p>æ”¹é€ æ­¥éª¤ï¼š</p>
<ol>
<li>ä¿®æ”¹æ’ä»¶å‡½æ•°ï¼Œä½¿å…¶å¯ä»¥æ¥å—ä¸€ä¸ªé€‰é¡¹å¯¹è±¡ï¼Œé€‰é¡¹ä¸­åŒ…å«è§£æå™¨æ•°ç»„ã€‚</li>
<li>åœ¨æ’ä»¶å†…éƒ¨ï¼Œéå†è§£æå™¨æ•°ç»„ï¼Œå¯¹æ¯ä¸ªç»„ä»¶åå°è¯•ä½¿ç”¨è§£æå™¨è¿›è¡Œè§£æã€‚</li>
<li>å¦‚æœæŸä¸ªè§£æå™¨è¿”å›äº†ç»“æœï¼Œåˆ™ä½¿ç”¨è¯¥ç»“æœæ¥ç”Ÿæˆå¯¼å…¥è¯­å¥ã€‚</li>
<li>å¦‚æœæ²¡æœ‰è§£æå™¨åŒ¹é…ï¼Œå¯ä»¥è·³è¿‡è¯¥ç»„ä»¶ï¼Œä¹Ÿå¯ä»¥æ ¹æ®éœ€æ±‚åšå…¶ä»–å¤„ç†ã€‚</li>
</ol>
<p>å‚è€ƒ <code>NaiveUi</code> åŸºäº <code>unplugin-vue-components</code> å®ç°çš„è§£æå™¨ç»“æ„ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">NaiveUiResolver</span>(<span class="hljs-params"/>): <span class="hljs-title class_">ComponentResolver</span> {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'component'</span>,
    <span class="hljs-attr">resolve</span>: <span class="hljs-function">(<span class="hljs-params">name: string</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (name.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/^(N[A-Z]|n-[a-z])/</span>))
        <span class="hljs-keyword">return</span> { name, <span class="hljs-attr">from</span>: <span class="hljs-string">'naive-ui'</span>, <span class="hljs-attr">sideEffects</span>: [] }
    },
  }
}
</code></pre>
<ul>
<li>è§£æå™¨æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä¸€ä¸ª<code>resolve</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ¥æ”¶ç»„ä»¶åï¼Œè¿”å›ä¸€ä¸ªè§£æç»“æœå¯¹è±¡æˆ–undefinedã€‚</li>
<li>è§£æç»“æœå¯¹è±¡åŒ…æ‹¬ï¼š<code>name</code>ï¼ˆç»„ä»¶åï¼Œå¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨åŸå§‹åï¼‰ï¼Œ<code>from</code>ï¼ˆå¯¼å…¥è·¯å¾„ï¼‰ï¼Œ<code>sideEffects</code>ï¼ˆæ ·å¼æ–‡ä»¶è·¯å¾„ç­‰ï¼Œå¯é€‰ï¼‰</li>
</ul>
<p>æˆ‘ä»¬è¿˜å¯ä»¥æ”¯æŒå¤šç§è§£æå™¨ï¼Œè¿™æ ·æ’ä»¶å¯ä»¥åŒæ—¶æ”¯æŒå¤šä¸ªç»„ä»¶åº“ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬æŒ‰ç…§è¿™ä¸ªæ€è·¯æ”¹é€ æ’ä»¶ä»£ç ã€‚é¦–å…ˆåŸºäºä¸Šè¿° <code>NaiveUi</code> çš„è§£æå™¨å®ç°æˆ‘ä»¬çš„æµ‹è¯•ç»„ä»¶çš„è§£æå™¨ï¼Œ<code>./packages/utils/index.ts</code> æ–°å¢ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è§£æå™¨å‡½æ•°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">CobyteViteUiResolver</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'component'</span>,
    <span class="hljs-attr">resolve</span>: <span class="hljs-function">(<span class="hljs-params">name: string</span>) =&gt;</span> {
      <span class="hljs-comment">// åªå¤„ç† Co å¼€å¤´çš„ç»„ä»¶</span>
      <span class="hljs-keyword">if</span> (name.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/^Co[A-Z]/</span>)) {
        <span class="hljs-keyword">const</span> partialName = <span class="hljs-title function_">kebabCase</span>(name.<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>)) <span class="hljs-comment">// CoTableColumn -&gt; table-column</span>
        <span class="hljs-keyword">return</span> { 
          name, 
          <span class="hljs-attr">from</span>: <span class="hljs-string">`cobyte-vite-ui/dist/components/<span class="hljs-subst">${partialName}</span>`</span>, 
          <span class="hljs-attr">sideEffects</span>: [<span class="hljs-string">'cobyte-vite-ui/dist/style.css'</span>] 
        }
      }
    },
  }
}
</code></pre>
<p>æ¥ä¸‹æ¥ä¿®æ”¹æ’ä»¶å‡½æ•°ï¼Œä½¿å…¶å¯ä»¥æ¥å—ä¸€ä¸ªé€‰é¡¹å¯¹è±¡ï¼Œé€‰é¡¹ä¸­åŒ…å«è§£æå™¨æ•°ç»„ï¼Œé‡‡ç”¨ä¸Šä¸‹æ–‡ç®¡ç†ï¼Œå› æ­¤æˆ‘ä»¬å¼•å…¥ Context ç±»ï¼Œåˆ›å»º Context ç±»æ¥ç®¡ç†æ’ä»¶é…ç½®å’Œè§£æå™¨ï¼Œå¹¶ç¼“å­˜è§£æç»“æœï¼Œæ¥ç€åœ¨ transform é’©å­ä¸­ï¼Œä½¿ç”¨ Context å®ä¾‹æ¥æŸ¥æ‰¾ç»„ä»¶ï¼Œè€Œä¸æ˜¯ç¡¬ç¼–ç è§£æé€»è¾‘ã€‚</p>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-addition">+ export class Context {</span>
<span class="hljs-addition">+  options: any;</span>
<span class="hljs-addition">+  private _componentNameMap = {} // ç»„ä»¶ç¼“å­˜</span>
<span class="hljs-addition">+  constructor(private rawOptions: any) {</span>
<span class="hljs-addition">+    this.options = rawOptions</span>
<span class="hljs-addition">+  }</span>

<span class="hljs-addition">+  async findComponent(name: string) {</span>
<span class="hljs-addition">+    // 1. æ£€æŸ¥ç¼“å­˜ä¸­æ˜¯å¦æœ‰è¯¥ç»„ä»¶çš„ä¿¡æ¯</span>
<span class="hljs-addition">+    let info = this._componentNameMap[name]</span>
<span class="hljs-addition">+    if (info) {</span>
<span class="hljs-addition">+      return info // ç¼“å­˜å‘½ä¸­ï¼Œç›´æ¥è¿”å›</span>
<span class="hljs-addition">+    }</span>
<span class="hljs-addition">+    // 2. éå†æ‰€æœ‰è§£æå™¨</span>
<span class="hljs-addition">+    for (const resolver of this.options.resolvers) {</span>
<span class="hljs-addition">+      const result = await resolver.resolve(name)</span>
<span class="hljs-addition">+      // 3. åˆ¤æ–­è§£æå™¨æ˜¯å¦è¿”å›äº†ç»“æœ</span>
<span class="hljs-addition">+      if (!result) {</span>
<span class="hljs-addition">+        continue</span>
<span class="hljs-addition">+      }</span>
<span class="hljs-addition">+      // 4. æ„å»ºå®Œæ•´ç»„ä»¶ä¿¡æ¯</span>
<span class="hljs-addition">+      info = {</span>
<span class="hljs-addition">+        as: name, // æ·»åŠ åˆ«å</span>
<span class="hljs-addition">+        ...result,</span>
<span class="hljs-addition">+      }</span>
<span class="hljs-addition">+      // 5. å­˜å…¥ç¼“å­˜</span>
<span class="hljs-addition">+      this._componentNameMap[name] = info</span>
<span class="hljs-addition">+      return info</span>
<span class="hljs-addition">+    }</span>
<span class="hljs-addition">+    // æ‰€æœ‰è§£æå™¨éƒ½ä¸åŒ¹é…ï¼Œè¿”å› undefined</span>
<span class="hljs-addition">+  }</span>
<span class="hljs-addition">+ }</span>

<span class="hljs-deletion">-  export default function VitePluginAutoComponents() {</span>
<span class="hljs-addition">+  export default function VitePluginAutoComponents(options = {}) {</span>
<span class="hljs-addition">+    // åˆ›å»º Context å®ä¾‹ï¼Œç”¨äºå­˜å‚¨æ’ä»¶é…ç½®å’Œç»„ä»¶ä¿¡æ¯</span>
<span class="hljs-addition">+    const ctx = new Context(options)</span>
    return {
      // æ’ä»¶åç§°ï¼Œç”¨äºè°ƒè¯•å’Œé”™è¯¯ä¿¡æ¯
      name: 'vite-plugin-auto-component',
  
      // transform é’©å­å‡½æ•°ï¼Œåœ¨è½¬æ¢æ¨¡å—æ—¶è°ƒç”¨
      // code: æ–‡ä»¶å†…å®¹ï¼Œid: æ–‡ä»¶è·¯å¾„
      async transform(code, id) {
        // ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸º.vueæ–‡ä»¶
        // å¦‚æœä¸æ˜¯.vueæ–‡ä»¶ï¼Œä¸è¿›è¡Œå¤„ç†
        if(/\.vue$/.test(id)) {
            // çœç•¥...
            
            let no = 0
            // éå†æ‰€æœ‰åŒ¹é…ç»“æœè¿›è¡Œå¤„ç†
            for (const { rawName, replace } of results) {
                // å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§é©¼å³°
                const name = pascalCase(rawName)
<span class="hljs-deletion">-                // åªå¤„ç† Co å¼€å¤´çš„ç»„ä»¶</span>
<span class="hljs-deletion">-                 if (!name.match(/^Co[A-Z]/)) return</span>
<span class="hljs-deletion">-                // ç»„ä»¶è·¯å¾„è½¬æ¢</span>
<span class="hljs-deletion">-                 const partialName = kebabCase(name.slice(2))</span>
<span class="hljs-deletion">-                // å°è£…äº†ç»„ä»¶çš„å®Œæ•´å¯¼å…¥ä¿¡æ¯ï¼Œä½œä¸ºæ•°æ®è½½ä½“ä¼ é€’ç»™åç»­å¤„ç†å‡½æ•°</span>
<span class="hljs-deletion">-                 const component = {</span>
<span class="hljs-deletion">-                     name,</span>
<span class="hljs-deletion">-                     from: `cobyte-vite-ui/dist/components/${partialName}`,</span>
<span class="hljs-deletion">-                     sideEffects: ['cobyte-vite-ui/dist/style.css']</span>
<span class="hljs-deletion">-                 }</span>
<span class="hljs-addition">+                const component = await ctx.findComponent(name)</span>
<span class="hljs-addition">+                if (component) {</span>
                  // å®šä¹‰è¦æ›¿æ¢çš„å˜é‡åï¼ˆè¿™é‡Œæš‚æ—¶ç¼–ç ä¸º CoButtonï¼‰
                  // const varName = name
                  // ä½¿ç”¨ç‰¹æ®Šå‰ç¼€å‡å°‘ä¸ç”¨æˆ·å˜é‡çš„å†²çªï¼Œä»¥åŠä½¿ç”¨é€’å¢çš„åºå·ï¼Œä¿è¯å”¯ä¸€æ€§ï¼Œé¿å…å˜é‡åå†²çª
                  const varName = `__unplugin_components_${no}`
                  // åœ¨ä»£ç å¼€å¤´æ·»åŠ å¯¼å…¥è¯­å¥ï¼š
                  // 1. å¯¼å…¥ CoButton ç»„ä»¶
                  // 2. å¯¼å…¥æ ·å¼æ–‡ä»¶
                  // s.prepend(`\nimport ${varName} from 'cobyte-vite-ui/dist/components/${partialName}';\nimport 'cobyte-vite-ui/dist/style.css';\n`)
                  // è¿™é‡Œå°† component å¯¹è±¡å±•å¼€ï¼Œå¹¶æ·»åŠ  as: varName å‚æ•°ï¼Œå½¢æˆå®Œæ•´çš„å¯¼å…¥é…ç½®
                  s.prepend(`${stringifyComponentImport({ ...component, as: varName })};\n`)
                  no += 1
                  // æ‰§è¡Œæ›¿æ¢ï¼šå°† resolveComponent("xxx") è°ƒç”¨æ›¿æ¢ä¸ºç»„ä»¶å˜é‡å
                  replace(varName)
<span class="hljs-addition">+                }</span>
            }
  
            // è¿”å›è½¬æ¢åçš„ä»£ç 
            return {
                code: s.toString(),  // è½¬æ¢åçš„ä»£ç å­—ç¬¦ä¸²
                map: null, 
            }
        }
      },
    }
}
</code></pre>
<p>æ’ä»¶åˆå§‹åŒ–æ—¶ï¼Œåˆ›å»º Context å®ä¾‹ï¼Œä¼ å…¥optionsï¼Œå…¶ä¸­åŒ…å«è§£æå™¨ resolversã€‚Context ç±»æä¾›äº†ä¸€ä¸ªfindComponentæ–¹æ³•ï¼Œç”¨äºæ ¹æ®ç»„ä»¶åæŸ¥æ‰¾ç»„ä»¶ä¿¡æ¯ã€‚è¯¥æ–¹æ³•ä¼šå…ˆæŸ¥çœ‹ç¼“å­˜ï¼Œå¦‚æœç¼“å­˜ä¸­æ²¡æœ‰ï¼Œåˆ™ä¾æ¬¡è°ƒç”¨æ¯ä¸ªè§£æå™¨çš„ resolve æ–¹æ³•ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªè§£æå™¨è¿”å›ç»“æœã€‚ç„¶åå°†ç»“æœç¼“å­˜èµ·æ¥ã€‚åœ¨ transform é’©å­ä¸­ï¼Œä½¿ç”¨ Context å®ä¾‹çš„findComponent æ–¹æ³•æ¥æŸ¥æ‰¾ç»„ä»¶ä¿¡æ¯ï¼Œè€Œä¸å†æ˜¯ç¡¬ç¼–ç è§£æé€»è¾‘ã€‚è¿™æ¬¡è¿­ä»£ä½¿æ’ä»¶ä»å•ä¸€ç»„ä»¶åº“çš„æ”¯æŒæ‰©å±•åˆ°å¤šç»„ä»¶åº“ï¼Œä½¿ç”¨ç¼“å­˜æé«˜æ€§èƒ½ï¼Œé€šè¿‡è§£æå™¨æ¨¡å¼æé«˜æ‰©å±•æ€§ï¼Œå¹¶ä¸”é€šè¿‡å¼‚æ­¥è§£ææŸ¥æ‰¾ç»„ä»¶ä¿¡æ¯ã€ä¸ºæœªæ¥å¼‚æ­¥è§£æé¢„ç•™æ¥å£ã€‚</p>
<p>ç»è¿‡æ­¤æ¬¡çš„è¿­ä»£ï¼Œæˆ‘ä»¬çš„æ’ä»¶å®ç°äº†çœŸæ­£çš„è§£è€¦ï¼Œæ’ä»¶æ ¸å¿ƒåªè´Ÿè´£æµç¨‹æ§åˆ¶ï¼Œè§£æé€»è¾‘åˆ™å®Œå…¨ç”±è§£æå™¨å¤„ç†ï¼Œé…ç½®ç®¡ç†åˆ™ç”± Context ç»Ÿä¸€ç®¡ç†ï¼Œæ ‡å‡†åŒ–äº†è§£æå™¨çš„æ¥å£ï¼Œè¿™æ ·æ‰€æœ‰è§£æå™¨éƒ½éµå¾ªç›¸åŒçš„æ¥å£ï¼Œç”±æ­¤å®ç°äº†å¼ºå¤§çš„æ‹“å±•æ€§ã€‚</p>
<p>æ¥ç€æˆ‘ä»¬æ›´æ–° play é¡¹ç›®ä¸­çš„ Vite é…ç½®æ–‡ä»¶ <code>vite.config.ts</code>ï¼Œæ›´æ–°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
<span class="hljs-deletion">- import AutoComponents from 'cobyte-vite-ui/dist/utils'</span>
<span class="hljs-addition">+ import AutoComponents, { CobyteViteUiResolver} from 'cobyte-vite-ui/dist/utils'</span>

export default defineConfig({
<span class="hljs-deletion">-  plugins: [vue(), AutoComponents()]</span>
<span class="hljs-addition">+  plugins: [vue(), AutoComponents({</span>
<span class="hljs-addition">+    resolvers: [CobyteViteUiResolver()]</span>
<span class="hljs-addition">+  })],</span>
})
</code></pre>
<p>æ¥ç€é‡æ–°æ‰“åŒ…ç»„ä»¶åº“ï¼Œå†é‡å¯ play é¡¹ç›®ï¼Œæˆ‘ä»¬å‘ç°ä¾ç„¶æ­£å¸¸ï¼Œè¯´æ˜æˆ‘ä»¬ä¸Šè¿°çš„æ”¹åŠ¨æ˜¯æ­£ç¡®çš„ã€‚</p>
<h3 data-id="heading-8">å¤šè§£æå™¨é…ç½®</h3>
<p>ä¸Šæ–‡è¯´äº†æˆ‘ä»¬å®ç°äº†æ’ä»¶ä»å•ä¸€ç»„ä»¶åº“çš„æ”¯æŒæ‰©å±•åˆ°å¤šç»„ä»¶åº“çš„æŒ‰éœ€åŠ è½½è§£æï¼Œé‚£ä¹ˆä¸‹é¢å°±è®©æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ã€‚
é¦–å…ˆæˆ‘ä»¬å¾€ <code>packages/utils/index.ts</code> æ–‡ä»¶æ·»åŠ  Naive UI çš„è§£æå™¨ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * Resolver for Naive UI
 *
 * <span class="hljs-doctag">@link</span> https://www.naiveui.com/
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">NaiveUiResolver</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'component'</span>,
    <span class="hljs-attr">resolve</span>: <span class="hljs-function">(<span class="hljs-params">name: string</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'NaiveUiResolver'</span>, name, name.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/^(N[A-Z]|n-[a-z])/</span>));
      <span class="hljs-keyword">if</span> (name.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/^(N[A-Z]|n-[a-z])/</span>))
        <span class="hljs-keyword">return</span> { name, <span class="hljs-attr">from</span>: <span class="hljs-string">'naive-ui'</span> }
    },
  }
}
</code></pre>
<p>è¿™ä¸ªè§£æå™¨æ˜¯å®Œå…¨ä» <code>unplugin-vue-components</code> æ’ä»¶ä¸­æ¬è¿‡æ¥çš„ï¼Œæˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹æ˜¯å¦èƒ½å¤Ÿåœ¨æˆ‘ä»¬å®ç°çš„æ’ä»¶ä¸­ä½¿ç”¨ã€‚</p>
<p>æ¥ç€æˆ‘ä»¬åœ¨ play é¡¹ç›®ä¸­å®‰è£… Naive UI çš„ä¾èµ–ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">pnpm <span class="hljs-keyword">add</span> naive-ui
</code></pre>
<p>ç„¶ååœ¨ App.vue æ–‡ä»¶ä¸­å¼•ç”¨ Naive UI çš„ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">co-button</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">co-button</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">n-button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span>&gt;</span>naive-ui<span class="hljs-tag">&lt;/<span class="hljs-name">n-button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p>æ¥ç€ä¿®æ”¹ <code>./play/vite.config.ts</code> æ–‡ä»¶ä¸­çš„é…ç½®ã€‚</p>
<pre><code class="hljs language-diff" lang="diff">import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
<span class="hljs-deletion">- import AutoComponents, { CobyteViteUiResolver } from 'cobyte-vite-ui/dist/utils'</span>
<span class="hljs-addition">+ import AutoComponents, { CobyteViteUiResolver, NaiveUiResolver } from 'cobyte-vite-ui/dist/utils'</span>

// https://vite.dev/config/
export default defineConfig({
  plugins: [vue(), AutoComponents({
<span class="hljs-deletion">-   resolvers: [CobyteViteUiResolver()]</span>
<span class="hljs-addition">+    resolvers: [CobyteViteUiResolver(), NaiveUiResolver()]</span>
  })],
})
</code></pre>
<p>æ¥ç€æˆ‘ä»¬é‡æ–°æ‰“åŒ…æˆ‘ä»¬çš„æµ‹è¯•ç»„ä»¶åº“ï¼Œå†é‡å¯ play æµ‹è¯•é¡¹ç›®ï¼Œæµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9fc0afaa6f74916a0a1ba1e7f0b866c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29ieXRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763905528&amp;x-signature=NmSVWgC%2B09BWju5OVR4Mw3s6Ev8%3D" alt="01.png" loading="lazy"/></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆåŠŸéªŒè¯äº†æˆ‘ä»¬ä¸Šè¿°çš„ç»“è®ºï¼š<strong>æˆ‘ä»¬å®ç°äº†æ’ä»¶ä»å•ä¸€ç»„ä»¶åº“çš„æ”¯æŒæ‰©å±•åˆ°å¤šç»„ä»¶åº“çš„æŒ‰éœ€åŠ è½½è§£</strong>ã€‚</p>
<p>æˆ‘ä»¬ä¸Šé¢æ‰€å®ç°çš„æ’ä»¶å…¶å®å°±æ˜¯ <code>unplugin-vue-components</code> åº“çš„å®ç°åŸç†ï¼Œåœ¨ Vue æŠ€æœ¯æ ˆä¸­éƒ½æ˜¯é€šè¿‡è¿™ä¸ªåº“æ¥å®ç°ç»„ä»¶æŒ‰éœ€åŠ è½½çš„ã€‚</p>
<h3 data-id="heading-9">ä¸šåŠ¡ç»„ä»¶åº“æŒ‰éœ€åŠ è½½å®è·µ</h3>
<p>æˆ‘ä»¬åœ¨ play é¡¹ç›®ä¸­å®‰è£… <code>unplugin-vue-components</code> åº“æ¥æ›¿æ¢æˆ‘ä»¬æ‰‹å†™çš„æ’ä»¶ã€‚å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">pnpm <span class="hljs-keyword">add</span> unplugin-vue-components -D 
</code></pre>
<p>æ¥ç€ä¿®æ”¹ play é¡¹ç›®ä¸­çš„ <code>vite.config.ts</code> æ–‡ä»¶ã€‚</p>
<pre><code class="hljs language-diff" lang="diff">import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
<span class="hljs-deletion">- import AutoComponent, { CobyteViteUiResolver, NaiveUiResolver } from 'cobyte-vite-ui/dist/utils'</span>
<span class="hljs-addition">+ import { CobyteViteUiResolver, NaiveUiResolver } from 'cobyte-vite-ui/dist/utils'</span>
<span class="hljs-addition">+ import AutoComponents from 'unplugin-vue-components/vite';</span>

// https://vite.dev/config/
export default defineConfig({
  plugins: [vue(), AutoComponents({
    resolvers: [CobyteViteUiResolver(), NaiveUiResolver()]
  })],
})
</code></pre>
<p>ç„¶åé‡å¯ play é¡¹ç›®ï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬çš„æµ‹è¯•ä¾‹å­ä¾ç„¶æ˜¯æ­£å¸¸è¿è¡Œçš„ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬çš„ç»„ä»¶åº“æˆ–è€…ä¸šåŠ¡ç»„ä»¶åº“æƒ³è¦å®ç°æŒ‰éœ€åŠ è½½ï¼Œåªéœ€è¦å‚è€ƒ <code>unplugin-vue-components</code> åº“ä¸­æä¾›çš„è§£æå™¨ï¼Œå†™ä¸€ä¸ªç¬¦åˆè‡ªå·±çš„ç»„ä»¶åº“çš„è§£æå™¨å†é…åˆ <code>unplugin-vue-components</code> å³å¯ã€‚å½“ç„¶è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„å‰æï¼Œä½ çš„ç»„ä»¶åº“å¾—è®¾è®¡æˆæ¨¡å—åŒ–ï¼Œå³ä¸€ä¸ªç»„ä»¶ä¸€ä¸ªæ¨¡å—ï¼Œäº’ä¸å…³è”æˆ–è€…å¼±å…³è”ã€‚</p>
<h3 data-id="heading-10">ä¸šåŠ¡ç»„ä»¶åº“å¼•ç”¨ç¬¬ä¸‰æ–¹ç»„ä»¶åº“çš„æŒ‰éœ€åŠ è½½</h3>
<p>æˆ‘ä»¬çŸ¥é“æ‰€è°“ä¸šåŠ¡ç»„ä»¶åº“ï¼Œå°±æ˜¯ä¸€äº›åŸºäºç¬¬ä¸‰æ–¹ç»„ä»¶åº“å¼€å‘çš„ç»„ä»¶åº“ï¼Œæ¯”å¦‚åŸºäº Element Plusã€Naive UI å¼€å‘çš„ç»„ä»¶åº“ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹æˆ‘ä»¬çš„æµ‹è¯•ç»„ä»¶åº“ <code>./packages/components/button</code>ï¼Œè®©å®ƒä½¿ç”¨ Naive UI çš„ button ç»„ä»¶ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">n-button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"warning"</span>&gt;</span>
    Warning
  <span class="hljs-tag">&lt;/<span class="hljs-name">n-button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-title function_">defineOptions</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'co-button'</span>,
});
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-tag">button</span> {
  <span class="hljs-attribute">color</span>: red;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p>æ¥ç€æˆ‘ä»¬é‡æ–°æ‰“åŒ…æµ‹è¯•ç»„ä»¶åº“ï¼Œç„¶åé‡å¯ play é¡¹ç›®ã€‚æˆ‘ä»¬å‘ç°æµ‹è¯•ç»„ä»¶åº“ä¸­ Naive UI çš„æŒ‰é’® Button å¹¶æ²¡æœ‰ç”Ÿæ•ˆã€‚å¹¶ä¸”åœ¨æµè§ˆå™¨çš„æ§åˆ¶å°æŠ¥ä»¥ä¸‹è­¦æŠ¥ï¼š</p>
<pre><code class="hljs language-css" lang="css">Failed <span class="hljs-selector-tag">to</span> resolve component: n-button
</code></pre>
<p>è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä½¿ç”¨ Vite æ¥æ‰“åŒ…ç»„ä»¶åº“ï¼ŒVite é»˜è®¤ä¼šæŠŠä»£ç è¿›è¡Œå‹ç¼©æ··æ·†ã€‚æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹æ‰“åŒ…åçš„æµ‹è¯• button ç»„ä»¶çš„ä»£ç ã€‚å¯ä»¥çœ‹åˆ°åŸæœ¬åº”è¯¥æ˜¯ <code>_resolveComponent("n-button")</code> çš„ä»£ç ï¼Œå› ä¸º Vite è¿›è¡Œäº†å‹ç¼©æ··æ·†è€Œå˜æˆäº† o("n-button")ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a1fd47f258b45e7825b38666b32cef5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29ieXRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763905528&amp;x-signature=xj9PMv0rEFl1dTwVMX%2F0Hu3GpE4%3D" alt="02.png" loading="lazy"/></p>
<p>è€Œæˆ‘ä»¬çš„æ’ä»¶æ˜¯åŸºäº <code>_resolveComponent</code> ä¸ºå‰ç¼€è¿›è¡ŒåŒ¹é…çš„ï¼Œç°åœ¨å‰ç¼€è¢«å‹ç¼©äº†ä¹Ÿå°±è‚¯å®šåŒ¹é…åˆ°ä¸åˆ°äº†ã€‚æ‰€ä»¥ç®€å•çš„å¤„ç†æ–¹æ³•å°±æ˜¯ä¿®æ”¹ Vite æ‰“åŒ…é…ç½®ï¼Œè®©å…¶ä¸è¿›è¡Œå‹ç¼©æ··æ·†ï¼Œæ¯•ç«Ÿ Element Plusã€Naive UI è¿™äº›å¼€æºç»„ä»¶åº“æ‰“åŒ…åçš„äº§ç‰©ä¹Ÿæ²¡æœ‰è¿›è¡Œå‹ç¼©æ··æ·†ã€‚æ‰€ä»¥æˆ‘ä»¬ä¿®æ”¹ Vite æ‰“åŒ…é…ç½®ç¦æ­¢æ„å»ºå‹ç¼©æ··æ·†ã€‚ä¿®æ”¹æ ¹ç›®å½•ä¸‹çš„ <code>vite.config.ts</code> å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">// çœç•¥...

export default defineConfig(({ command, mode }) =&gt; {
    // ä¸»æ„å»ºé…ç½®
    return {
        // çœç•¥...
        build: {
<span class="hljs-addition">+            minify: false, // ç¦æ­¢å‹ç¼©æ··æ·†</span>
            // çœç•¥...
        },
    };
});
</code></pre>
<p>æˆ‘ä»¬å‘ç°æ‰“åŒ…åçš„ç»„ä»¶ä»£ç ä¸å‹ç¼©æ··æ·†äº†ï¼Œä½†è¿˜æ˜¯ä¸ç”Ÿæ•ˆï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬å†™çš„æ’ä»¶åªè§£æ <code>.vue</code> æ–‡ä»¶ï¼Œè€Œæˆ‘ä»¬æ‰“åŒ…åçš„æ–‡ä»¶å˜æˆäº† <code>.mjs</code> äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä¿®æ”¹ä¸€ä¸‹ play é¡¹ç›®çš„ Vite é…ç½®è®© <code>.mjs</code> æ–‡ä»¶ä¹Ÿå¯ä»¥è¢«è§£æã€‚ä¿®æ”¹ <code>./play/vite.config.ts</code>  æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">  // çœç•¥...
export default defineConfig({
  plugins: [vue(), AutoComponents({
<span class="hljs-addition">+    include: [</span>
<span class="hljs-addition">+      /\.vue$/,</span>
<span class="hljs-addition">+      /\.mjs$/</span>
<span class="hljs-addition">+    ],</span>
    resolvers: [CobyteViteUiResolver(), NaiveUiResolver()]
  })],
})
</code></pre>
<p>ç»è¿‡ä¸Šè¿°ä¿®æ”¹åæˆ‘ä»¬é‡å¯ play é¡¹ç›®ï¼Œå‘ç°åŸºäº Naive UI äºŒæ¬¡å¼€å‘çš„ç»„ä»¶å¯ä»¥æˆåŠŸåŠ è½½äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40241ada01dc43be8f8adfdd50ebac34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29ieXRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763905528&amp;x-signature=fTIbzwPyquF5rKqzxpe8urIlk2g%3D" alt="03.png" loading="lazy"/></p>
<h3 data-id="heading-11">ä¾èµ–é¢„æ„å»ºé…ç½®</h3>
<p>æˆ‘ä»¬çŸ¥é“ Vite ä¼šåœ¨ç¬¬ä¸€æ¬¡å¯åŠ¨çš„æ—¶å€™æŠŠä¾èµ–é¢„æ„å»ºå¹¶ç¼“å­˜åˆ° <code>node_modules/.vite</code> ç›®å½•ä¸­ã€‚ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š</p>
<ol>
<li>æ¨¡å—æ ¼å¼è½¬æ¢</li>
</ol>
<p>è®¸å¤š npm åŒ…ä½¿ç”¨çš„æ˜¯ CommonJS æˆ– UMD æ ¼å¼ï¼Œè€Œ Vite åœ¨å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨çš„æ˜¯åŸç”Ÿ ES æ¨¡å—ï¼ˆESMï¼‰ã€‚é¢„æ„å»ºä¼šå°†è¿™äº›åŒ…è½¬æ¢ä¸º ESM æ ¼å¼ï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨æµè§ˆå™¨ä¸­ç›´æ¥è¿è¡Œã€‚</p>
<ol start="2">
<li>æ€§èƒ½ä¼˜åŒ– - å‡å°‘ HTTP è¯·æ±‚</li>
</ol>
<p>æŸäº›åŒ…ä¼šæœ‰å¾ˆå¤šå†…éƒ¨æ¨¡å—ï¼Œå¦‚æœä¸é¢„æ„å»ºï¼Œæµè§ˆå™¨å¯èƒ½éœ€è¦å‘èµ·æ•°ç™¾ä¸ª HTTP è¯·æ±‚ã€‚é¢„æ„å»ºä¼šå°†è¿™äº›æ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªæˆ–å°‘æ•°å‡ ä¸ªæ–‡ä»¶ã€‚</p>
<p>å…¸å‹ä¾‹å­ï¼š</p>
<ul>
<li>lodash-es æœ‰è¶…è¿‡ 600 ä¸ªå†…ç½®æ¨¡å—</li>
<li>å¦‚æœä¸é¢„æ„å»ºï¼Œä¼šå¯¼è‡´ 600+ ä¸ª HTTP è¯·æ±‚</li>
<li>é¢„æ„å»ºååªéœ€è¦ 1-2 ä¸ªè¯·æ±‚</li>
</ul>
<ol start="3">
<li>æå‡é¡µé¢åŠ è½½é€Ÿåº¦</li>
</ol>
<p>é¢„æ„å»ºä½¿ç”¨ esbuildï¼ˆç”¨ Go ç¼–å†™ï¼‰ï¼Œé€Ÿåº¦æ¯”ä¼ ç»Ÿ JavaScript æ‰“åŒ…å·¥å…·å¿« 10-100 å€ã€‚é€šè¿‡å°†ä¾èµ–é¢„å…ˆæ‰“åŒ…å¹¶ç¼“å­˜ï¼Œå¯ä»¥æ˜¾è‘—æå‡å¼€å‘æœåŠ¡å™¨çš„å¯åŠ¨é€Ÿåº¦å’Œæ¨¡å—çƒ­æ›´æ–°ï¼ˆHMRï¼‰çš„å“åº”é€Ÿåº¦ã€‚</p>
<p>é»˜è®¤çš„æ—¶å€™ Vite æ˜¯é€šè¿‡ import è¯­å¥è¿›è¡Œåˆ†æéœ€è¦é¢„æ„å»ºçš„ä¾èµ–çš„ï¼Œä½†æˆ‘ä»¬ä½¿ç”¨æŒ‰éœ€åŠ è½½çš„æ’ä»¶ä¹‹åï¼Œåœ¨ä»£ç ä¸­å°±æœ‰äº› npm åŒ…ä¸å­˜åœ¨ import è¯­å¥äº†ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨é€šè¿‡ <code>optimizeDeps.include</code> é€‰é¡¹è®¾ç½®é¢„æ„å»ºã€‚</p>
<p>æˆ‘ä»¬å¯¹ <code>./play/vite.config.ts</code> è®¾ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import { CobyteViteUiResolver, NaiveUiResolver } from 'cobyte-vite-ui/dist/utils'
import AutoComponents from 'unplugin-vue-components/vite';
<span class="hljs-addition">+ import pkg from './package.json';</span>
<span class="hljs-addition">+ const dependencies = Object.keys(pkg.dependencies);</span>

export default defineConfig({
  plugins: [vue(), AutoComponents({
    include: [
      /\.vue$/,
      /\.mjs$/
    ],
    resolvers: [CobyteViteUiResolver(), NaiveUiResolver()]
  })],
<span class="hljs-addition">+  optimizeDeps: {</span>
<span class="hljs-addition">+    include: [...dependencies]</span>
<span class="hljs-addition">+  }</span>
})
</code></pre>
<p>ç”±äº Node ä¸å¤„ç†è™šæ‹Ÿé“¾æ¥ï¼ŒåŒæ—¶ä¸ºäº†æ›´çœŸå®éªŒè¯çœŸå®åœºæ™¯ï¼Œæˆ‘ä»¬æŠŠæµ‹è¯•ç»„ä»¶åº“æ”¹æˆæ›´åŠ çœŸå®ï¼Œé¦–å…ˆä¿®æ”¹ <code>./play/packages.json</code></p>
<pre><code class="hljs language-diff" lang="diff">{
  // çœç•¥...
  "dependencies": {
<span class="hljs-deletion">-    "cobyte-vite-ui": "link:..",</span>
    "cobyte-vite-ui": "^1.0.0",
    "naive-ui": "^2.43.1",
    "vue": "^3.5.22"
  },
  // çœç•¥...
}
</code></pre>
<p>åŒæ—¶åˆ æ‰ <code>./play/node_modules</code> ç›®å½•ä¸­çš„ <code>cobyte-vite-ui</code> è™šæ‹Ÿç›®å½•ï¼Œå†é‡æ–°åˆ›å»ºä¸€ä¸ª <code>cobyte-vite-ui</code> ç›®å½•ï¼ŒåŒæ—¶æŠŠæ ¹ç›®å½•ä¸‹çš„ <code>./dist</code> ç›®å½•ä¸­çš„å†…å®¹å’Œæ ¹ç›®å½•ä¸‹çš„ <code>packages.json</code> æ–‡ä»¶å¤åˆ¶åˆ°åˆšåˆšæ–°åˆ›å»ºçš„
<code>cobyte-vite-ui</code> ç›®å½•ä¸­ï¼Œè¿™ç›¸å½“äºæ‰‹åŠ¨å®‰è£…æˆ‘ä»¬åˆ›å»ºçš„æµ‹è¯•ç»„ä»¶åº“çš„ä¾èµ–äº†ã€‚ä¹‹åæˆ‘ä»¬å†åˆ æ‰ <code>./play/node_modules/.vite</code> ç›®å½•çš„é¢„æ„å»ºç¼“å­˜ï¼Œå†é‡å¯ play é¡¹ç›®ã€‚è¿™æ—¶æˆ‘ä»¬å‘ç° <code>cobyte-vite-ui</code> ç»„ä»¶åº“ä¸­å¼•ç”¨çš„ Naive UI çš„ button ç»„ä»¶ä¸ç”Ÿæ•ˆäº†ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æŠŠ <code>cobyte-vite-ui</code> è¿›è¡Œé¢„æ„å»ºåï¼Œå®ƒçš„å†…å®¹å°±ä¼šè¢«é¢„æ„å»ºåç¼“å­˜åˆ° <code>./play/node_modules/.vite</code> ç›®å½•ä¸­äº†ï¼Œè€Œ unplugin-vue-components æ’ä»¶é»˜è®¤æ˜¯ä¸è§£æ <code>node_modules</code> ç›®å½•ä¸­çš„æ–‡ä»¶çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ unplugin-vue-components æ’ä»¶çš„é…ç½®è®©å…¶å¯ä»¥è§£æ <code>node_modules</code> ç›®å½•ä¸­çš„æ–‡ä»¶ï¼Œä½†è¿™ä¸æ˜¯æœ€ä¼˜çš„æ–¹æ¡ˆã€‚æœ€ä¼˜çš„æ–¹æ¡ˆæ˜¯åœ¨æ‰“åŒ… <code>cobyte-vite-ui</code> ç»„ä»¶åº“çš„æ—¶å€™å°±
è¿›è¡ŒæŒ‰éœ€æ‰“åŒ…ã€‚æˆ‘ä»¬åœ¨æ ¹ç›®å½•ä¸‹å®‰è£… <code>unplugin-vue-components</code> ä¾èµ–ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp">pnpm <span class="hljs-keyword">add</span> unplugin-vue-components -D -w
</code></pre>
<p>æˆ‘ä»¬åœ¨å®‰è£…ä¸Šè¿°ä¾èµ–çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šæŠ¥ä»¥ä¸‹é”™è¯¯ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6746af5fde3446af853e12ef3aa69e0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29ieXRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1763905528&amp;x-signature=AaAWOg3oR8etvN4X%2FocknaSdzaQ%3D" alt="04.png" loading="lazy"/></p>
<p>è¿™æ˜¯å› ä¸ºæˆ‘ä»¬åˆšåˆšæŠŠ play ç›®å½•ä¸­çš„æµ‹è¯•ç»„ä»¶åº“ <code>cobyte-vite-ui</code> æ”¹äº†æ­£å¼åº“ä¸€æ ·çš„ä¾èµ–ï¼Œæˆ‘ä»¬å¯ä»¥æš‚æ—¶æŠŠå®ƒæ”¹å›è™šæ‹Ÿä¾èµ–ã€‚</p>
<pre><code class="hljs language-diff" lang="diff">"dependencies": {
<span class="hljs-deletion">-    "cobyte-vite-ui": "^1.0.0",</span>
<span class="hljs-addition">+    "cobyte-vite-ui": "link:..",</span>
    "naive-ui": "^2.43.1",
    "vue": "^3.5.22"
},
</code></pre>
<p>å†è¿›è¡Œå®‰è£…å³å¯ã€‚</p>
<p>ç„¶åæ–°å¢æ ¹ç›®å½•ä¸‹çš„ <code>vite.config.ts</code> æ–‡ä»¶çš„é…ç½®ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">// çœç•¥...
<span class="hljs-addition">+ import AutoComponents from 'unplugin-vue-components/vite';</span>
<span class="hljs-addition">+ import { NaiveUiResolver } from 'unplugin-vue-components/resolvers';</span>

// çœç•¥...

export default defineConfig(({ command, mode }) =&gt; {
    // ä¸»æ„å»ºé…ç½®
    return {
        plugins: [
            vue(),
<span class="hljs-addition">+            AutoComponents({</span>
<span class="hljs-addition">+                resolvers: [NaiveUiResolver()]</span>
<span class="hljs-addition">+            })</span>
        ],
        build: {
            // çœç•¥...
            rollupOptions: {
                external: [
                    "vue", 
<span class="hljs-addition">+                    "naive-ui", // æ’é™¤æ‰“åŒ…</span>
                ],
            // çœç•¥..
            },
        },
    };
});
</code></pre>
<p>é…ç½®å®Œåï¼Œé‡æ–°æ‰“åŒ…æˆ‘ä»¬çš„æµ‹è¯•ç»„ä»¶åº“ï¼Œæ‰“åŒ…å®Œåï¼Œé‡æ–°åˆ æ‰ <code>./play/node_modules/.vite</code> ä¸­çš„ç¼“å­˜ï¼Œå’Œ <code>./play/node_modules/cobyte-vite-ui</code> ä¸­çš„å†…å®¹ï¼Œé‡æ–°æŠŠåˆšåˆšæ–°æ‰“åŒ…çš„æ ¹ç›®å½•ä¸‹çš„ <code>./dist</code> ç›®å½•ä¸­çš„å†…å®¹å’Œæ ¹ç›®å½•ä¸‹çš„ <code>packages.json</code> æ–‡ä»¶å¤åˆ¶åˆ° <code>./play/node_modules/cobyte-vite-ui</code> ä¸­ï¼ŒåŒæ—¶æ¢å¤ä¿®æ”¹çš„ <code>./play/packages.json</code> æ–‡ä»¶ï¼Œç„¶åé‡å¯ play é¡¹ç›®ã€‚</p>
<p>è¿™æ—¶æˆ‘ä»¬å°±å‘ç°æµ‹è¯•é¡¹ç›®å¯ä»¥æ­£å¸¸æ¸²æŸ“äº†ã€‚</p>
<p>è‡³æ­¤æˆ‘ä»¬ä¸šåŠ¡ç»„ä»¶åº“æŒ‰éœ€åŠ è½½çš„å®ç°åŸç†å°±éƒ½è®²å¾—å·®ä¸å¤šäº†ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥åœ¨è¯„è®ºåŒºäº¤æµã€‚</p>
<h3 data-id="heading-12">æ€»ç»“</h3>
<p>çœ‹å®Œäº†å…¨ç¯‡æ–‡ç« ç›¸ä¿¡ä½ ä¼šè§‰å¾—ï¼Œæ‰€è°“ç»„ä»¶åº“æŒ‰éœ€åŠ è½½æˆ–è€…ä¸šåŠ¡ç»„ä»¶åº“æŒ‰éœ€åŠ è½½å…¶å®å¾ˆç®€å•ï¼Œé¦–å…ˆç»„ä»¶åº“çš„æ¯ä¸€ä¸ªç»„ä»¶éƒ½å¾—è®¾è®¡æˆç‹¬ç«‹çš„æ¨¡å—ï¼Œå¹¶ä¸”å¯ä»¥æŒ‰æ¨¡å—å¯¼å…¥ï¼Œä¹Ÿå°±æ˜¯ ESM åŒ–ï¼Œå¯ä»¥è¿›è¡Œ Tree Shakingï¼Œåªæœ‰è¿™æ ·æŒ‰éœ€åŠ è½½æ‰æœ‰æ„ä¹‰ï¼Œæ‰èƒ½è¾¾åˆ°å‡å°åŒ…ä½“ç§¯çš„ä½œç”¨ã€‚</p>
<p>å…¨å±€ç»„ä»¶åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨è¢«ç¼–è¯‘åä¼šé€šè¿‡ä¸€ä¸ªå†…ç½®å‡½æ•° <strong>resolveComponent</strong> æ¥è°ƒç”¨ç»„ä»¶ï¼ŒæŒ‰éœ€åŠ è½½çš„å®ç°åŸç†å°±æ˜¯é€šè¿‡æ’ä»¶è¿›è¡Œæ­£åˆ™åŒ¹é…æŸ¥æ‰¾ç¼–è¯‘åçš„æ¨¡æ¿ä»£ç ä¸­çš„ <strong>resolveComponent</strong> å‡½æ•°çš„ç›¸å…³ä»£ç æ¥æ‰¾åˆ°éœ€è¦æŒ‰éœ€åŠ è½½çš„ç»„ä»¶ï¼Œç„¶åè‡ªåŠ¨æŒ‰ç¼–è¯‘åçš„ä»£ç çš„å¤´éƒ¨æ·»åŠ éœ€è¦åŠ è½½çš„ç»„ä»¶çš„å¯¼å…¥è¯­å¥ä»£ç ä»¥åŠæ›¿æ¢æ‰ <strong>resolveComponent</strong> å‡½æ•°çš„ç›¸å…³ä»£ç ä¸ºå¯¹åº”çš„ç»„ä»¶å¯¹è±¡ã€‚</p>
<p>è€Œä¸šåŠ¡ç»„ä»¶å®ç°æŒ‰éœ€åŠ è½½çš„å…³é”®æ˜¯éœ€è¦åœ¨ä¸šåŠ¡ç»„ä»¶åº“æ‰“åŒ…çš„æ—¶å€™ä¹Ÿè¿›è¡ŒæŒ‰éœ€åŠ è½½é…ç½®ã€‚è™½ç„¶è¿™ä¸ªå…³é”®æ­¥éª¤å¾ˆç®€å•ï¼Œä½†ç”±äºè¿™æ˜¯ä¸€ä¸ªä½é¢‘ä¸”è·¨é¡¹ç›®çš„éœ€æ±‚ï¼Œæ‰€ä»¥AIå¯¹ä½é¢‘çš„éœ€æ±‚çš„å®ç°å’Œç»™çš„è§£å†³æ–¹æ¡ˆéƒ½ä¸å°½äººæ„ï¼Œè‡³å°‘æœ¬äººè§£å†³ä¸Šè¿°é—®é¢˜æ—¶ï¼ŒAIæä¾›æ–¹æ¡ˆæ²¡æœ‰ä¸€ä¸ªå¯ä»¥å®ç°çš„ï¼Œè™½ç„¶æœ€åçš„å®ç°å…¶å®å¾ˆç®€å•ã€‚</p>
<p>æœ€åï¼Œå†è¯´è¯´ä¸ªäººå¯¹AIçš„ä¸€äº›æ„Ÿæ‚Ÿå§ï¼Œä¸ªäººè§‰å¾—åœ¨AIæ—¶ä»£ï¼Œå°±ç¼–ç¨‹è¿™ä¸ªé¢†åŸŸè€Œè¨€å¯¹ä¸ªäººçš„ä¸“ä¸šè¦æ±‚ä¼šæ¯”ä»¥å‰æ›´åŠ çš„é«˜ï¼Œè‡³å°‘ä½ å¾—æœ‰èƒ½åŠ›å»è§£å†³AIä¸ä¼šçš„é—®é¢˜ã€‚</p>
<p>ä¸Šè¿°ç»„ä»¶åº“æµ‹è¯•ä»£ç åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Famebyte%2Fcobyte-vite-ui" target="_blank" title="https://github.com/amebyte/cobyte-vite-ui" ref="nofollow noopener noreferrer">github.com/amebyte/cobâ€¦</a></p>
<p>æ¬¢è¿å…³æ³¨æœ¬ä¸“æ ï¼Œäº†è§£æ›´å¤š Element Plus ç»„ä»¶åº“çŸ¥è¯†</p>
<p>æœ¬ä¸“æ æ–‡ç« ï¼š</p>
<p><a href="https://juejin.cn/post/7143196940992413709" target="_blank" title="https://juejin.cn/post/7143196940992413709">1. Vue3 ç»„ä»¶åº“çš„è®¾è®¡å’Œå®ç°åŸç†</a></p>
<p><a href="https://juejin.cn/post/7146183222425518093" target="_blank" title="https://juejin.cn/post/7146183222425518093">2. ç»„ä»¶åº“å·¥ç¨‹åŒ–å®æˆ˜ä¹‹ Monorepo æ¶æ„æ­å»º</a></p>
<p><a href="https://juejin.cn/post/7153659360177029150" target="_blank" title="https://juejin.cn/post/7153659360177029150">3. ESLint æ ¸å¿ƒåŸç†å‰–æ</a></p>
<p><a href="https://juejin.cn/post/7157743898939359262" target="_blank" title="https://juejin.cn/post/7157743898939359262">4. ESLint æŠ€æœ¯åŸç†ä¸å®æˆ˜åŠä»£ç è§„èŒƒè‡ªåŠ¨åŒ–è¯¦è§£</a></p>
<p><a href="https://juejin.cn/post/7161063570594070559" target="_blank" title="https://juejin.cn/post/7161063570594070559">5. ä»ç»ˆç«¯å‘½ä»¤è§£æå™¨è¯´èµ·è°ˆè°ˆ npm åŒ…ç®¡ç†å·¥å…·çš„è¿è¡ŒåŸç†</a></p>
<p><a href="https://juejin.cn/post/7165503808217284616" target="_blank" title="https://juejin.cn/post/7165503808217284616">6. CSS æ¶æ„æ¨¡å¼ä¹‹ BEM åœ¨ç»„ä»¶åº“ä¸­çš„å®è·µ</a></p>
<p><a href="https://juejin.cn/post/7168835045984043022" target="_blank" title="https://juejin.cn/post/7168835045984043022">7. ç»„ä»¶å®ç°çš„åŸºæœ¬æµç¨‹åŠ Icon ç»„ä»¶çš„å®ç°</a></p>
<p><a href="https://juejin.cn/post/7170716245762048036" target="_blank" title="https://juejin.cn/post/7170716245762048036">8. ä¸ºä»€ä¹ˆç»„ä»¶åº“æˆ–æ’ä»¶éœ€è¦å®šä¹‰ peerDependencies</a></p>
<p><a href="https://juejin.cn/post/7179257832632483896" target="_blank" title="https://juejin.cn/post/7179257832632483896">9. ç»„ä»¶å¼€å‘ä¸­ Vue3 ç›¸å…³çŸ¥è¯†çš„åº”ç”¨ä¸è§£æåŠ Button ç»„ä»¶çš„å®ç°</a></p>
<p><a href="https://juejin.cn/post/7186683381470462007" target="_blank" title="https://juejin.cn/post/7186683381470462007">10. CSS ç³»ç»Ÿé¢œè‰²å’Œæš—é»‘æ¨¡å¼çš„å…³ç³»åŠæ„ä¹‰</a></p>
<p><a href="https://juejin.cn/post/7190370726677839932" target="_blank" title="https://juejin.cn/post/7190370726677839932">11. æ·±å…¥ç†è§£ç»„ä»¶åº“ä¸­SCSSå’ŒCSSå˜é‡çš„æ¶æ„åº”ç”¨å’Œå®è·µ</a></p>
<p><a href="https://juejin.cn/post/7204454572890046501" target="_blank" title="https://juejin.cn/post/7204454572890046501">12. ç»„ä»¶ v-model çš„å°è£…å®ç°åŸç†åŠ Input ç»„ä»¶çš„æ ¸å¿ƒå®ç°</a></p>
<p><a href="https://juejin.cn/post/7217399337989881911" target="_blank" title="https://juejin.cn/post/7217399337989881911">13. æ·±å…¥ç†è§£ Vue3 çš„ v-model åŠè‡ªå®šä¹‰æŒ‡ä»¤çš„å®ç°åŸç†</a></p>
<p><a href="https://juejin.cn/post/7249299811497066551" target="_blank" title="https://juejin.cn/post/7249299811497066551">14. React å’Œ Vue éƒ½ç¦»ä¸å¼€çš„è¡¨å•éªŒè¯å·¥å…·åº“ async-validator ä¹‹ç­–ç•¥æ¨¡å¼çš„åº”ç”¨</a></p>
<p><a href="https://juejin.cn/post/7258966810350174263" target="_blank" title="https://juejin.cn/post/7258966810350174263">15. Form è¡¨å•çš„è®¾è®¡ä¸å®ç°</a></p>
<p><a href="https://juejin.cn/post/7313380227160522763" target="_blank" title="https://juejin.cn/post/7313380227160522763">16. ç»„ä»¶åº“çš„æ‰“åŒ…åŸç†ä¸å®è·µè¯¦è§£</a></p>
<p><a href="https://juejin.cn/post/7572480736362119174" target="_blank" title="https://juejin.cn/post/7572480736362119174">17. Vue3 ä¸šåŠ¡ç»„ä»¶åº“æŒ‰éœ€åŠ è½½çš„å®ç°åŸç†</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Claude Codeï¼šä½ çš„ AI ç¼–ç¨‹åŠ©æ‰‹]]></title>    <link>https://juejin.cn/post/7574448424998699044</link>    <guid>https://juejin.cn/post/7574448424998699044</guid>    <pubDate>2025-11-20T05:50:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574448424998699044" data-draft-id="7574382900859977755" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Claude Codeï¼šä½ çš„ AI ç¼–ç¨‹åŠ©æ‰‹"/> <meta itemprop="keywords" content="Claude,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-20T05:50:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Claude Codeï¼šä½ çš„ AI ç¼–ç¨‹åŠ©æ‰‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T05:50:07.000Z" title="Thu Nov 20 2025 05:50:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ <strong>Claude Code</strong>ï¼Œä¸€ä¸ªç”± Anthropic å¼€å‘çš„äº¤äº’å¼å‘½ä»¤è¡Œ AI ç¼–ç¨‹åŠ©æ‰‹ã€‚ä»Šå¤©æˆ‘æƒ³å‘å¤§å®¶ä»‹ç»ä¸€ä¸‹è‡ªå·±ã€‚</p>
<h2 data-id="heading-0">æˆ‘æ˜¯è°ï¼Ÿ</h2>
<p>æˆ‘æ˜¯ Claude AI çš„å®˜æ–¹å‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰å·¥å…·ï¼Œä¸“é—¨ä¸ºè½¯ä»¶å¼€å‘è€…è®¾è®¡ã€‚æˆ‘åŸºäº <strong>Claude Sonnet 4.5</strong> æ¨¡å‹ï¼Œæ‹¥æœ‰å¼ºå¤§çš„ä»£ç ç†è§£å’Œç”Ÿæˆèƒ½åŠ›ï¼Œå¯ä»¥ç›´æ¥åœ¨ä½ çš„ç»ˆç«¯ä¸­å¸®åŠ©ä½ å®Œæˆå„ç§ç¼–ç¨‹ä»»åŠ¡ã€‚</p>
<h2 data-id="heading-1">æˆ‘èƒ½åšä»€ä¹ˆï¼Ÿ</h2>
<h3 data-id="heading-2">ğŸ”§ ä»£ç ç¼–å†™ä¸ä¿®æ”¹</h3>
<ul>
<li>å¿«é€Ÿç”Ÿæˆä»£ç ç‰‡æ®µå’Œå®Œæ•´åŠŸèƒ½</li>
<li>ä¿®å¤ bug å’Œé”™è¯¯</li>
<li>é‡æ„ç°æœ‰ä»£ç ï¼Œæå‡ä»£ç è´¨é‡</li>
<li>æ·»åŠ æ–°åŠŸèƒ½åˆ°ç°æœ‰é¡¹ç›®</li>
</ul>
<h3 data-id="heading-3">ğŸ“– ä»£ç ç†è§£ä¸åˆ†æ</h3>
<ul>
<li>è§£é‡Šå¤æ‚çš„ä»£ç é€»è¾‘</li>
<li>åˆ†æä»£ç åº“ç»“æ„</li>
<li>æœç´¢å’Œå®šä½ç‰¹å®šåŠŸèƒ½</li>
<li>ä»£ç å®¡æŸ¥å’Œä¼˜åŒ–å»ºè®®</li>
</ul>
<h3 data-id="heading-4">ğŸ› ï¸ å¼€å‘å·¥å…·é›†æˆ</h3>
<ul>
<li>Git æ“ä½œï¼ˆæäº¤ã€åˆ†æ”¯ã€PR åˆ›å»ºï¼‰</li>
<li>è¿è¡Œæµ‹è¯•å’Œæ„å»ºå‘½ä»¤</li>
<li>æ–‡ä»¶æœç´¢å’Œç¼–è¾‘</li>
<li>åŒ…ç®¡ç†å’Œä¾èµ–å®‰è£…</li>
</ul>
<h3 data-id="heading-5">ğŸ’¡ æ™ºèƒ½ä»»åŠ¡ç®¡ç†</h3>
<ul>
<li>è‡ªåŠ¨æ‹†è§£å¤æ‚ä»»åŠ¡</li>
<li>è·Ÿè¸ªä»»åŠ¡è¿›åº¦</li>
<li>å¹¶è¡Œå¤„ç†å¤šä¸ªç‹¬ç«‹ä»»åŠ¡</li>
<li>å®æ—¶åé¦ˆå·¥ä½œçŠ¶æ€</li>
</ul>
<h2 data-id="heading-6">æˆ‘çš„ç‰¹ç‚¹</h2>
<h3 data-id="heading-7">1ï¸âƒ£ ç›´æ¥æ“ä½œæ–‡ä»¶ç³»ç»Ÿ</h3>
<p>æˆ‘å¯ä»¥ç›´æ¥è¯»å–ã€ç¼–è¾‘å’Œåˆ›å»ºæ–‡ä»¶ï¼Œä¸éœ€è¦ä½ æ‰‹åŠ¨å¤åˆ¶ç²˜è´´ä»£ç ã€‚æˆ‘ä¼šä½¿ç”¨ä¸“é—¨çš„å·¥å…·æ¥é«˜æ•ˆåœ°å®Œæˆæ–‡ä»¶æ“ä½œã€‚</p>
<h3 data-id="heading-8">2ï¸âƒ£ ä¸Šä¸‹æ–‡ç†è§£èƒ½åŠ›</h3>
<p>æˆ‘èƒ½ç†è§£æ•´ä¸ªä»£ç åº“çš„ç»“æ„ï¼Œåœ¨ä¿®æ”¹ä»£ç æ—¶ä¿æŒé£æ ¼ä¸€è‡´ï¼Œå¹¶è€ƒè™‘åˆ°ä»£ç é—´çš„ä¾èµ–å…³ç³»ã€‚</p>
<h3 data-id="heading-9">3ï¸âƒ£ å¤šè¯­è¨€æ”¯æŒ</h3>
<p>æ— è®ºæ˜¯ JavaScriptã€Pythonã€Javaã€Goã€Rust è¿˜æ˜¯å…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼Œæˆ‘éƒ½èƒ½æä¾›å¸®åŠ©ã€‚</p>
<h3 data-id="heading-10">4ï¸âƒ£ äº¤äº’å¼å·¥ä½œæµ</h3>
<p>æˆ‘ä¼šåœ¨å·¥ä½œè¿‡ç¨‹ä¸­è¯¢é—®ä½ çš„æ„è§ï¼Œç¡®ä¿å®ç°ç¬¦åˆä½ çš„é¢„æœŸã€‚é‡åˆ°ä¸ç¡®å®šçš„åœ°æ–¹ï¼Œæˆ‘ä¼šä¸»åŠ¨å¯»æ±‚ç¡®è®¤ã€‚</p>
<h3 data-id="heading-11">5ï¸âƒ£ å®‰å…¨å¯é </h3>
<p>æˆ‘åœ¨æ“ä½œå‰ä¼šä»”ç»†æ£€æŸ¥ï¼Œé¿å…å¼•å…¥å®‰å…¨æ¼æ´ï¼ˆå¦‚ SQL æ³¨å…¥ã€XSS ç­‰ï¼‰ï¼Œå¹¶éµå¾ªæœ€ä½³å®è·µã€‚</p>
<h2 data-id="heading-12">å·¥ä½œæ–¹å¼</h2>
<p>æˆ‘çš„å·¥ä½œæµç¨‹é€šå¸¸æ˜¯è¿™æ ·çš„ï¼š</p>
<ol>
<li><strong>ç†è§£éœ€æ±‚</strong> - åˆ†æä½ çš„é—®é¢˜æˆ–ä»»åŠ¡</li>
<li><strong>åˆ¶å®šè®¡åˆ’</strong> - å°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºå°æ­¥éª¤</li>
<li><strong>æ‰§è¡Œæ“ä½œ</strong> - ä½¿ç”¨å„ç§å·¥å…·å®Œæˆä»»åŠ¡</li>
<li><strong>éªŒè¯ç»“æœ</strong> - ç¡®ä¿ä»£ç æ­£å¸¸å·¥ä½œ</li>
<li><strong>åé¦ˆè¿›åº¦</strong> - å®æ—¶å‘ŠçŸ¥ä½ å½“å‰çŠ¶æ€</li>
</ol>
<h2 data-id="heading-13">ä½¿ç”¨åœºæ™¯</h2>
<h3 data-id="heading-14">å¿«é€ŸåŸå‹å¼€å‘</h3>
<p>éœ€è¦å¿«é€Ÿå®ç°ä¸€ä¸ªæƒ³æ³•ï¼Ÿæˆ‘å¯ä»¥å¸®ä½ ç”ŸæˆåŸºç¡€ä»£ç æ¡†æ¶ã€‚</p>
<h3 data-id="heading-15">è°ƒè¯•å›°éš¾é—®é¢˜</h3>
<p>é‡åˆ°éš¾ä»¥è¿½è¸ªçš„ bugï¼Ÿæˆ‘å¯ä»¥å¸®ä½ åˆ†æä»£ç ï¼Œæ‰¾å‡ºé—®é¢˜æ‰€åœ¨ã€‚</p>
<h3 data-id="heading-16">å­¦ä¹ æ–°æŠ€æœ¯</h3>
<p>æƒ³äº†è§£æŸä¸ªåº“æˆ–æ¡†æ¶çš„ç”¨æ³•ï¼Ÿæˆ‘å¯ä»¥è¾¹è§£é‡Šè¾¹æ¼”ç¤ºã€‚</p>
<h3 data-id="heading-17">é‡æ„è€ä»£ç </h3>
<p>éœ€è¦ä¼˜åŒ–æ€§èƒ½æˆ–æ”¹è¿›æ¶æ„ï¼Ÿæˆ‘å¯ä»¥å¸®ä½ å®‰å…¨åœ°é‡æ„ä»£ç ã€‚</p>
<h3 data-id="heading-18">è‡ªåŠ¨åŒ–é‡å¤ä»»åŠ¡</h3>
<p>æ‰¹é‡ä¿®æ”¹æ–‡ä»¶ã€æ ¼å¼åŒ–ä»£ç ã€æ›´æ–°ä¾èµ–...è¿™äº›äº¤ç»™æˆ‘å°±å¥½ã€‚</p>
<h2 data-id="heading-19">æˆ‘çš„ç†å¿µ</h2>
<p>æˆ‘ç›¸ä¿¡å¥½çš„å·¥å…·åº”è¯¥ï¼š</p>
<ul>
<li><strong>é«˜æ•ˆ</strong> - å¹¶è¡Œå¤„ç†ä»»åŠ¡ï¼ŒèŠ‚çœä½ çš„æ—¶é—´</li>
<li><strong>å‡†ç¡®</strong> - åŸºäºäº‹å®å’Œæœ€ä½³å®è·µæä¾›å»ºè®®</li>
<li><strong>é€æ˜</strong> - æ¸…æ™°è¯´æ˜æˆ‘åœ¨åšä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿™æ ·åš</li>
<li><strong>è°¦é€Š</strong> - ä¸ç¡®å®šæ—¶ä¼šæ‰¿è®¤ï¼Œè€Œä¸æ˜¯çŒœæµ‹</li>
</ul>
<h2 data-id="heading-20">å¦‚ä½•è·å¾—å¸®åŠ©</h2>
<p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºæˆ‘çš„åŠŸèƒ½ï¼Œå¯ä»¥ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>/help</code> å‘½ä»¤æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£</li>
<li>è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.claude.com%2Fen%2Fdocs%2Fclaude-code" target="_blank" title="https://docs.claude.com/en/docs/claude-code" ref="nofollow noopener noreferrer">Claude Code æ–‡æ¡£</a></li>
<li>åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fanthropics%2Fclaude-code%2Fissues" target="_blank" title="https://github.com/anthropics/claude-code/issues" ref="nofollow noopener noreferrer">GitHub</a> ä¸Šåé¦ˆé—®é¢˜</li>
</ul>
<h2 data-id="heading-21">ç»“è¯­</h2>
<p>ä½œä¸ºä½ çš„ AI ç¼–ç¨‹ä¼™ä¼´ï¼Œæˆ‘çš„ç›®æ ‡æ˜¯è®©ç¼–ç¨‹å·¥ä½œå˜å¾—æ›´è½»æ¾ã€æ›´é«˜æ•ˆã€‚æ— è®ºä½ æ˜¯åœ¨å¼€å‘æ–°åŠŸèƒ½ã€ä¿®å¤ bugï¼Œè¿˜æ˜¯æ¢ç´¢æ–°æŠ€æœ¯ï¼Œæˆ‘éƒ½éšæ—¶å‡†å¤‡ä¸ºä½ æä¾›å¸®åŠ©ã€‚</p>
<p>è®©æˆ‘ä»¬ä¸€èµ·åˆ›é€ æ›´ä¼˜ç§€çš„ä»£ç å§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å­¦ä¹ è®°å½•ï¼šåœ¨Spring bootä¸­ç®€å•å®ç°ä¸€ä¸ªWebSocket Demo]]></title>    <link>https://juejin.cn/post/7574069837526368298</link>    <guid>https://juejin.cn/post/7574069837526368298</guid>    <pubDate>2025-11-18T18:50:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574069837526368298" data-draft-id="7573631442313412614" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å­¦ä¹ è®°å½•ï¼šåœ¨Spring bootä¸­ç®€å•å®ç°ä¸€ä¸ªWebSocket Demo"/> <meta itemprop="keywords" content="WebSocket"/> <meta itemprop="datePublished" content="2025-11-18T18:50:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="hooknum"/> <meta itemprop="url" content="https://juejin.cn/user/837147523285209"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å­¦ä¹ è®°å½•ï¼šåœ¨Spring bootä¸­ç®€å•å®ç°ä¸€ä¸ªWebSocket Demo
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/837147523285209/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    hooknum
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-18T18:50:52.000Z" title="Tue Nov 18 2025 18:50:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">èƒŒæ™¯</h3>
<p>ä¹‹å‰åœ¨é¡¹ç›®é‡Œç”¨è¿‡WebSocketåšè¿‡â€œç”¨æˆ·ä¸‹å•å®æ—¶é€šçŸ¥â€çš„åŠŸèƒ½ï¼Œä½†æœ€è¿‘å›è¿‡å¤´æ¥çœ‹ï¼Œç«Ÿç„¶å®Œå…¨æ²¡æœ‰ä¸€ç‚¹å°è±¡ã€‚ä»”ç»†ä¸€æƒ³ï¼ŒåŸå› ä¹Ÿå¾ˆç®€å•ï¼šå½“åˆåªæ˜¯çœ‹åˆ«äººå†™çš„ä»£ç ï¼Œè‡ªå·±çœŸæ­£åŠ¨æ‰‹å®è·µè¾ƒå°‘ã€‚ç»“æœå°±æ˜¯ï¼Œå­¦äº†å¾ˆä¹…ï¼Œçœ‹ä¼¼æ‡‚äº†ï¼ŒçœŸæ­£è½åˆ°ä»£ç ä¸Šå´æ— ä»ä¸‹æ‰‹ã€‚</p>
<p>äºæ˜¯å†³å®šé‡æ–°å®¡è§†è‡ªå·±ï¼Œå°†å­¦ä¹ çš„è„šå°å‘å¸ƒåœ¨ç½‘ä¸Šï¼ˆä¹Ÿæ˜¯çŠ¹è±«äº†å¾ˆä¹…æ‰å†³å®šçš„ï¼Œå› ä¸ºä¹‹å‰æ€»è§‰å¾—å‘åšå®¢å¿…é¡»æ˜¯æŠ€æœ¯å¤§ä½¬æ‰è¡Œï¼Œè‡ªå·±ä»€ä¹ˆéƒ½ä¸æ‡‚çš„èœé¸¡å‘å‡ºæ¥çš„ä¸œè¥¿ä¼šæ±¡æŸ“äº†å¤§ä¼™çš„çœ¼ç›ï¼‰ï¼Œç°åœ¨è™½ç„¶ä¹Ÿä¼šè¿™ä¹ˆæƒ³ï¼Œä½†æ˜¯æ›´å¤šçš„æ˜¯æŒ‘æˆ˜å’Œè®°å½•è‡ªå·±äº†â€”â€”è®°å½•å­¦ä¹ çš„è¿‡ç¨‹ï¼Œæœªæ¥å›å¤´çœ‹ä¹Ÿæœ‰è¿¹å¯å¾ªï¼Œè€Œä¸æ˜¯ä¸€ç‰‡æ¨¡ç³Šçš„å›å¿†ã€‚äººç”Ÿå˜›ï¼Œä¸å°±æ˜¯ä¸æ–­ä½“éªŒå—ï¼Ÿæ—¢ç„¶æƒ³å†™ï¼Œå°±ä»ç°åœ¨å¼€å§‹ğŸ˜‹</p>
<p>æ‰€ä»¥ï¼Œå°±ä»ä¸€ä¸ªç®€å•çš„WebSocket Demoå¼€å§‹ï¼Œæ­£å¼å¼€å¯æˆ‘çš„åšå®¢ä¹‹æ—…ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ç®€å•ç†è§£</h2>
<p>WebSocketæ˜¯ä¸€ç§ç½‘ç»œåè®®ã€‚å®ƒå®ç°äº†æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯å…¨åŒå·¥é€šä¿¡ï¼Œä½¿å¾—æœåŠ¡ç«¯å¯ä»¥ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ¶ˆæ¯ï¼Œè¿™é€‚ç”¨äºéœ€è¦å®æ—¶æ›´æ–°çš„åœºæ™¯ï¼Œæ¯”å¦‚ç”¨æˆ·ä¸‹å•æé†’ã€åŒ»ç–—çœ‹æ¿æ•°æ®å®æ—¶åˆ·æ–°ç­‰ã€‚</p>
<h2 data-id="heading-2">äºŒã€å®ç°æ­¥éª¤</h2>
<h3 data-id="heading-3">1ã€å¯¼å…¥ä¾èµ–</h3>
<p>åˆ›å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œå¹¶åœ¨<code>pom.xml</code>ä¸­å¯¼å…¥ç›¸å…³ä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-websocket<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-4">2ã€å®šä¹‰é…ç½®ç±»</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;
<span class="hljs-keyword">import</span> org.springframework.web.socket.server.standard.ServerEndpointExporter;

<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketConfiguration</span> {

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> ServerEndpointExporter <span class="hljs-title function_">serverEndpointExporter</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerEndpointExporter</span>();
    }
}
</code></pre>
<p>è¯´æ˜ï¼šå…³äºä¸ºä»€ä¹ˆè¦å®šä¹‰é…ç½®ç±»ï¼Œæˆ‘æŸ¥æ‰¾äº†ç½‘ä¸Šä¸€äº›èµ„æ–™ï¼Œç®€å•æ¥è¯´å°±æ˜¯é€šè¿‡è¿™ä¸ªé…ç½®spring bootæ‰èƒ½å»æ‰«æå…³äºwebsocketçš„æ³¨è§£ã€‚</p>
<blockquote>
<p>ç”±äºWebSocketçš„<code>@ServerEndpoint</code>æ³¨è§£å±äºJava EEæ ‡å‡†ï¼Œå¹¶ä¸æ˜¯Springæœ¬èº«çš„ç»„ä»¶ï¼ŒSpring Bootä¸ä¼šè‡ªåŠ¨è¯†åˆ«ã€‚<br/>
ä¸ºäº†è®©Spring Bootèƒ½å¤Ÿæ‰«æå¹¶æ³¨å†Œè¿™äº›WebSocketç«¯ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦å£°æ˜<code>ServerEndpointExporter</code>è¿™ä¸ª Beanã€‚<br/>
å®ƒçš„ä½œç”¨å°±æ˜¯è´Ÿè´£æŠŠæ‰€æœ‰<code>@ServerEndpoint</code>ç±»æ³¨å†Œåˆ°å®¹å™¨ä¸­ï¼Œå¦åˆ™WebSocketæœåŠ¡å°†æ— æ³•è¢«è®¿é—®ã€‚</p>
</blockquote>
<h3 data-id="heading-5">3ã€å¼€å‘æœåŠ¡ç«¯ç»„ä»¶</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> jakarta.websocket.*;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;
<span class="hljs-keyword">import</span> jakarta.websocket.server.PathParam;
<span class="hljs-keyword">import</span> jakarta.websocket.server.ServerEndpoint;

<span class="hljs-keyword">import</span> java.util.Collection;
<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-comment">/**
 * WebSocketæœåŠ¡
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@ServerEndpoint("/ws/{sid}")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketServer</span> {

    <span class="hljs-comment">//å­˜æ”¾ä¼šè¯å¯¹è±¡</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Map&lt;String, Session&gt; sessionMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();

    <span class="hljs-comment">/**
     * è¿æ¥å»ºç«‹æˆåŠŸè°ƒç”¨çš„æ–¹æ³•ï¼Œå¹¶å­˜å‚¨å½“å‰ä¼šè¯å¯¹è±¡
     */</span>
    <span class="hljs-meta">@OnOpen</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onOpen</span><span class="hljs-params">(Session session, <span class="hljs-meta">@PathParam("sid")</span> String sid)</span> {
        System.out.println(<span class="hljs-string">"å®¢æˆ·ç«¯ï¼š"</span> + sid + <span class="hljs-string">"å»ºç«‹è¿æ¥"</span>);
        sessionMap.put(sid, session);
    }

    <span class="hljs-comment">/**
     * æ”¶åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯åè°ƒç”¨çš„æ–¹æ³•
     *
     * <span class="hljs-doctag">@param</span> message å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„æ¶ˆæ¯
     */</span>
    <span class="hljs-meta">@OnMessage</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(String message, <span class="hljs-meta">@PathParam("sid")</span> String sid)</span> {
        System.out.println(<span class="hljs-string">"æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯ï¼š"</span> + sid + <span class="hljs-string">"çš„ä¿¡æ¯:"</span> + message);
    }

    <span class="hljs-comment">/**
     * è¿æ¥å…³é—­è°ƒç”¨çš„æ–¹æ³•
     *
     * <span class="hljs-doctag">@param</span> sid
     */</span>
    <span class="hljs-meta">@OnClose</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClose</span><span class="hljs-params">(<span class="hljs-meta">@PathParam("sid")</span> String sid)</span> {
        System.out.println(<span class="hljs-string">"è¿æ¥æ–­å¼€:"</span> + sid);
        sessionMap.remove(sid);
    }

    <span class="hljs-meta">@OnError</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onError</span><span class="hljs-params">(Session session, Throwable error, <span class="hljs-meta">@PathParam("sid")</span> String sid)</span> {
        System.out.println(<span class="hljs-string">"å®¢æˆ·ç«¯ï¼š"</span> + sid + <span class="hljs-string">"å‘ç”Ÿé”™è¯¯"</span>);
        error.printStackTrace();
    }

    <span class="hljs-comment">/**
     * ç¾¤å‘
     *
     * <span class="hljs-doctag">@param</span> message
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendToAllClient</span><span class="hljs-params">(String message)</span> {
        Collection&lt;Session&gt; sessions = sessionMap.values();
        <span class="hljs-keyword">for</span> (Session session : sessions) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">//æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯</span>
                session.getBasicRemote().sendText(message);
            } <span class="hljs-keyword">catch</span> (Exception e) {
                e.printStackTrace();
            }
        }
    }

}
</code></pre>
<p><code>@ServerEndpoint</code>ï¼šè¡¨ç¤ºæ­¤ç±»æ˜¯ä¸€ä¸ªWebSocketç«¯ç‚¹ï¼Œ<code>value</code>å±æ€§æ˜¯å¿…é¡»çš„ï¼Œç”¨äºè®¾ç½®è·¯ç”±ã€‚å¯ä»¥ç±»æ¯”<code>@RequestMapping</code>è¿™æ ·å°±å¥½ç†è§£å¤šäº†ã€‚</p>
<p><code>@OnOpen</code>ï¼šè¿æ¥å»ºç«‹æ—¶è§¦å‘ï¼Œç”¨äºç›‘å¬å®¢æˆ·ç«¯çš„è¿æ¥äº‹ä»¶ã€‚å¯åœ¨è¿™é‡Œä¿å­˜sessionã€‚</p>
<p><code>@OnMessage</code>ï¼šæ”¶åˆ°æ¶ˆæ¯æ—¶è§¦å‘ï¼Œç”¨äºç›‘å¬å®¢æˆ·ç«¯æ¶ˆæ¯äº‹ä»¶ã€‚ç±»ä¼¼Controllerçš„â€œå¤„ç†è¯·æ±‚æ–¹æ³•â€ï¼Œä½†å®ƒå¤„ç†çš„æ˜¯WebSocketæ¶ˆæ¯ã€‚</p>
<p><code>@OnClose</code>ï¼šè¿æ¥å…³é—­æ—¶è§¦å‘ï¼Œç”¨äºå¤„ç†è¿æ¥æ–­å¼€äº‹ä»¶ã€‚å¯åœ¨æ­¤ç§»é™¤sessionã€é‡Šæ”¾èµ„æºã€‚</p>
<p><code>@OnError</code>ï¼šå‘ç”Ÿå¼‚å¸¸æ—¶è§¦å‘ï¼Œç”¨äºå¤„ç†å¼‚å¸¸äº‹ä»¶ã€‚è¯¥æ–¹æ³•å¿…é¡»è¦æœ‰ä¸€ä¸ª<code>Throwable</code>ç±»å‹çš„å‚æ•°ï¼Œè¡¨ç¤ºå‘ç”Ÿçš„å¼‚å¸¸ã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å¯ä»¥æ‰“å°é”™è¯¯æ—¥å¿—ï¼Œæ¸…é™¤é”™è¯¯ä¼šè¯ã€‚</p>
<h3 data-id="heading-6">4ã€å‰ç«¯é¡µé¢ï¼ˆå¯é€‰ï¼‰</h3>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">HTML</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>WebSocket Demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"send()"</span>&gt;</span>å‘é€æ¶ˆæ¯<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"closeWebSocket()"</span>&gt;</span>å…³é—­è¿æ¥<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"message"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">var</span> websocket = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> clientId = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>().<span class="hljs-title function_">toString</span>(<span class="hljs-number">36</span>).<span class="hljs-title function_">substr</span>(<span class="hljs-number">2</span>);

    <span class="hljs-comment">//åˆ¤æ–­å½“å‰æµè§ˆå™¨æ˜¯å¦æ”¯æŒWebSocket</span>
    <span class="hljs-keyword">if</span>(<span class="hljs-string">'WebSocket'</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">window</span>){
        <span class="hljs-comment">//è¿æ¥WebSocketèŠ‚ç‚¹</span>
        websocket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">"ws://localhost:8080/ws/"</span>+clientId);
    }
    <span class="hljs-keyword">else</span>{
        <span class="hljs-title function_">alert</span>(<span class="hljs-string">'Not support websocket'</span>)
    }

    <span class="hljs-comment">//è¿æ¥å‘ç”Ÿé”™è¯¯çš„å›è°ƒæ–¹æ³•</span>
    websocket.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
        <span class="hljs-title function_">setMessageInnerHTML</span>(<span class="hljs-string">"error"</span>);
    };

    <span class="hljs-comment">//è¿æ¥æˆåŠŸå»ºç«‹çš„å›è°ƒæ–¹æ³•</span>
    websocket.<span class="hljs-property">onopen</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
        <span class="hljs-title function_">setMessageInnerHTML</span>(<span class="hljs-string">"è¿æ¥æˆåŠŸ"</span>);
    }

    <span class="hljs-comment">//æ¥æ”¶åˆ°æ¶ˆæ¯çš„å›è°ƒæ–¹æ³•</span>
    websocket.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>){
        <span class="hljs-title function_">setMessageInnerHTML</span>(event.<span class="hljs-property">data</span>);
    }

    <span class="hljs-comment">//è¿æ¥å…³é—­çš„å›è°ƒæ–¹æ³•</span>
    websocket.<span class="hljs-property">onclose</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
        <span class="hljs-title function_">setMessageInnerHTML</span>(<span class="hljs-string">"close"</span>);
    }

    <span class="hljs-comment">//ç›‘å¬çª—å£å…³é—­äº‹ä»¶ï¼Œå½“çª—å£å…³é—­æ—¶ï¼Œä¸»åŠ¨å»å…³é—­websocketè¿æ¥ï¼Œé˜²æ­¢è¿æ¥è¿˜æ²¡æ–­å¼€å°±å…³é—­çª—å£ï¼Œserverç«¯ä¼šæŠ›å¼‚å¸¸ã€‚</span>
    <span class="hljs-variable language_">window</span>.<span class="hljs-property">onbeforeunload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
        websocket.<span class="hljs-title function_">close</span>();
    }

    <span class="hljs-comment">//å°†æ¶ˆæ¯æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Š</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">setMessageInnerHTML</span>(<span class="hljs-params">innerHTML</span>){
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'message'</span>).<span class="hljs-property">innerHTML</span> += innerHTML + <span class="hljs-string">'&lt;br/&gt;'</span>;
    }

    <span class="hljs-comment">//å‘é€æ¶ˆæ¯</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">send</span>(<span class="hljs-params"/>){
        <span class="hljs-keyword">var</span> message = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'text'</span>).<span class="hljs-property">value</span>;
        websocket.<span class="hljs-title function_">send</span>(message);
    }
	
	<span class="hljs-comment">//å…³é—­è¿æ¥</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">closeWebSocket</span>(<span class="hljs-params"/>) {
        websocket.<span class="hljs-title function_">close</span>();
    }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>æ³¨æ„ï¼šè¿™é‡Œä¸»è¦æ³¨æ„<code>new WebSocket("ws://localhost:8080/ws/"+clientId)</code>ï¼Œè¿™æ˜¯WebSocketå¯¹è±¡çš„åˆå§‹åŒ–ï¼ŒæŒ‡å®šè¦è¿æ¥æœåŠ¡å™¨çš„åœ°å€ã€‚</p>
<h2 data-id="heading-7">ä¸‰ã€æµ‹è¯•ç»“æœ</h2>
<p>1ï¸âƒ£å¯åŠ¨æœåŠ¡å™¨ï¼Œå¹¶æ‰“å¼€websocket.htmlè¿›è¡ŒåŒç«¯è¿æ¥
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b6eeae5bfbcf4d8d96811be6ebd1159d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaG9va251bQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764096651&amp;x-signature=FOqKTjw8Jx1bXafRhvO5ZCGvxCc%3D" alt="Snipaste_2025-11-19_00-30-04.png" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a24b4558ded47f1a276040962ab84bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaG9va251bQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764096651&amp;x-signature=mPvhQB5Jb%2BB4fj3Ld%2FO4UF%2B0G3I%3D" alt="Snipaste_2025-11-19_00-30-35.png" loading="lazy"/></p>
<p>2ï¸âƒ£å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€æ¶ˆæ¯
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c347aa237af458cac5f895185d7c604~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaG9va251bQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764096651&amp;x-signature=Th8z0m1L6yk1ic%2BUMcwz9i%2FEZgM%3D" alt="result.jpeg" loading="lazy"/></p>
<p>3ï¸âƒ£æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯</p>
<p>å®šä¹‰å®šæ—¶ä»»åŠ¡ç±»ï¼Œå®šæ—¶å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.sky.websocket.WebSocketServer;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.scheduling.annotation.Scheduled;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;
<span class="hljs-keyword">import</span> java.time.LocalDateTime;
<span class="hljs-keyword">import</span> java.time.format.DateTimeFormatter;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketTask</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> WebSocketServer webSocketServer;

    <span class="hljs-comment">/**
     * é€šè¿‡WebSocketæ¯éš”5ç§’å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯
     */</span>
    <span class="hljs-meta">@Scheduled(cron = "0/5 * * * * ?")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendMessageToClient</span><span class="hljs-params">()</span> {
        webSocketServer.sendToAllClient(<span class="hljs-string">"è¿™æ˜¯æ¥è‡ªæœåŠ¡ç«¯çš„æ¶ˆæ¯ï¼š"</span> + DateTimeFormatter.ofPattern(<span class="hljs-string">"HH:mm:ss"</span>).format(LocalDateTime.now()));
    }
}
</code></pre>
<p>æ³¨æ„è¦åœ¨å¯åŠ¨ç±»æ·»åŠ æ³¨è§£<code>@EnableScheduling</code>å¼€å¯ä»»åŠ¡è°ƒåº¦</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b474032b7df543e9957ee7321dfa092d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaG9va251bQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764096651&amp;x-signature=ipSbTwTWT%2BLy3Ck4rqHCLnHvMuA%3D" alt="Snipaste_2025-11-19_00-53-19.png" loading="lazy"/></p>
<p>æ­¤å¤–è¿˜å¯ä»¥åœ¨å…¶ä»–æ¥å£ä¸­ä½¿ç”¨webSocketServer.sendToAllClient()ï¼Œè¿™æ ·å°±æ˜¯å¯ä»¥å®æ—¶æ¨é€ã€‚æ¯”å¦‚åœ¨è®¢å•ä¸‹å•åŠŸèƒ½ä¸­è°ƒç”¨æ­¤æ–¹æ³•ï¼Œå°±å¯ä»¥åœ¨ç”¨æˆ·ä¸‹å•åå®æ—¶é€šçŸ¥å•†å®¶ã€‚</p>
<h2 data-id="heading-8">å››ã€é—®é¢˜å‘ç°</h2>
<p>ä¸Šè¿°çš„ä»£ç æ¼”ç¤ºä¸­ï¼Œéƒ¨åˆ†éƒ½æ˜¯ä»¥å¾€é¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„ã€‚ç°åœ¨æ¥çœ‹ï¼Œç¡®å®å­˜åœ¨ä¸€äº›é—®é¢˜ã€‚</p>
<p><strong>é—®é¢˜æè¿°</strong></p>
<p>åœ¨ä¸€ä¸ªå•†åŸäº¤æ˜“ç³»ç»Ÿä¸­ï¼Œå‡è®¾æœ‰ä¸¤ä¸ªå•†å®¶åŒæ—¶ç™»å½•äº†æµè§ˆå™¨ï¼Œè¿™æ—¶æ¯ä¸ªå•†å®¶éƒ½ä¼šä¸æœåŠ¡å™¨å»ºç«‹ä¸€ä¸ªWebSocketè¿æ¥ï¼Œç”¨äºæ¥æ”¶å®æ—¶æ¶ˆæ¯ã€‚å½“ç”¨æˆ·è®¿é—®å•†å®¶Açš„åº—é“ºå¹¶è¿›è¡Œä¸‹å•æ—¶ï¼Œå‰ç«¯ä¼šè°ƒç”¨ä¸‹å•æ¥å£å®Œæˆè®¢å•åˆ›å»ºã€‚ä¸ºäº†å®ç°å®æ—¶æé†’åŠŸèƒ½ï¼ŒæœåŠ¡ç«¯å¸Œæœ›é€šè¿‡WebSocketå°†â€œæ–°è®¢å•â€æ¶ˆæ¯å‘é€ç»™å•†å®¶Aã€‚ç„¶è€Œï¼Œå¦‚æœç›´æ¥ä½¿ç”¨ç¾¤å‘çš„æ–¹å¼ï¼Œç³»ç»Ÿä¼šæŠŠæ¶ˆæ¯å‘é€ç»™æ‰€æœ‰åœ¨çº¿å•†å®¶ï¼ŒåŒ…æ‹¬å•†å®¶ Bï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸šåŠ¡ä¸Šçš„é”™è¯¯ã€‚</p>
<p>å› æ­¤ï¼Œéœ€è¦æ”¹æˆå•å‘ï¼Œå³åªå‘é€ç»™å•†å®¶Aã€‚ä½†é—®é¢˜æ¥äº†ï¼šåœ¨ç”¨æˆ·ä¸‹å•çš„æ¥å£ä¸­ï¼Œå¦‚ä½•è·å–å•†å®¶Açš„WebSocket session IDï¼Œä»è€Œç²¾ç¡®åœ°å°†æ¶ˆæ¯å‘é€ç»™å¯¹åº”å•†å®¶ï¼Ÿ</p>
<p><strong>æ€è€ƒ</strong></p>
<p>å•å‘éœ€è¦WebSocket session IDï¼Œåœ¨ä¸‹å•åŠŸèƒ½ä¸­æˆ‘å¦‚ä½•è·å–åˆ°è¿™ä¸ªidæ ‡è¯†ï¼Ÿå…ˆæ€è€ƒåœ¨ç”¨æˆ·ä¸‹å•åŠŸèƒ½ä¸­æˆ‘ä»¬èƒ½è·å¾—ä»€ä¹ˆï¼Œèƒ½å¦ä»ç°æœ‰çš„èµ„æºä¸­è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥å¾—åˆ°å•†å®¶çš„idï¼Œé‚£ä¹ˆè¿™ä¸ªå•†å®¶idæ˜¯å¦å¯ä»¥ä½œä¸ºå•†å®¶ä¸æœåŠ¡å™¨è¿›è¡ŒWebSocketè¿æ¥çš„session IDå‘¢ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜äº†ï¼Œåœ¨ä¸Šè¿°å‰ç«¯é¡µé¢ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨éšæœºå­—ç¬¦ä¸²clientIdæ¥ä½œä¸ºsession IDã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸šåŠ¡è§„å®šï¼ŒæŠŠclientIdæ¢æˆå•†æˆ·IDï¼ˆmerchantIdï¼‰ï¼Œå°±èƒ½è®©WebSocketè¿æ¥ä¸ä¸šåŠ¡ç»‘å®šï¼Œè¿™æ ·åœ¨ä¸‹å•æ¥å£å°±èƒ½æ‰¾åˆ°å¯¹åº”çš„WebSocket Sessionï¼Œç„¶ååªç»™é‚£ä¸ªå•†æˆ·æ¨é€æ¶ˆæ¯ã€‚</p>
<p><strong>ä¼ªä»£ç </strong></p>
<p>å‰ç«¯ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//è§„å®šå¦‚ä¸‹</span>
<span class="hljs-keyword">var</span> merchantId = <span class="hljs-string">"å•†æˆ·ç™»å½•æˆåŠŸåçš„çœŸå®ID"</span>;
websocket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">"ws://localhost:8080/ws/"</span> + merchantId);
</code></pre>
<p>åç«¯ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * WebSocketæœåŠ¡
 */</span>
<span class="hljs-meta">@ServerEndpoint("/ws/{merchantId}")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketServer</span> {
    
    <span class="hljs-comment">//å­˜æ”¾å•†æˆ·ä¸æœåŠ¡å™¨ä¼šè¯å¯¹è±¡</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Map&lt;String, Session&gt; merchantSessions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
    
    <span class="hljs-comment">/**
     * è¿æ¥å»ºç«‹æˆåŠŸè°ƒç”¨çš„æ–¹æ³•ï¼Œå¹¶å­˜å‚¨å½“å‰ä¼šè¯å¯¹è±¡
     */</span>
    <span class="hljs-meta">@OnOpen</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onOpen</span><span class="hljs-params">(Session session, <span class="hljs-meta">@PathParam("merchantId")</span> String merchantId)</span> {
        merchantSessions.put(merchantId, session);
    }
    
    <span class="hljs-comment">//å…¶ä»–æ–¹æ³•...</span>

    <span class="hljs-comment">//å•å‘</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendToMerchant</span><span class="hljs-params">(String merchantId, String message)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> merchantSessions.get(merchantId);
        <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span> &amp;&amp; session.isOpen()) {
            <span class="hljs-keyword">try</span> {
                session.getBasicRemote().sendText(message);
            } <span class="hljs-keyword">catch</span> (Exception e) {
                e.printStackTrace();
            }
        }
    }
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ä¸‹å•æ¥å£è°ƒç”¨ç¤ºä¾‹
 */</span>
<span class="hljs-meta">@PostMapping("/order/create")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> Order order)</span> {
    <span class="hljs-comment">// åˆ›å»ºè®¢å•....</span>

    WebSocketServer.sendToMerchant(order.getMerchantId(), <span class="hljs-string">"æ‚¨æœ‰æ–°è®¢å•ï¼"</span>);
}
</code></pre>
<p>è¿™æ ·åœ¨ç”¨æˆ·ä¸‹å•æ¥å£ä¸­å°±èƒ½æ ¹æ®å•†æˆ·IDæ‰¾åˆ°å¯¹åº”çš„WebSocketä¼šè¯ï¼Œä»è€Œå®ç°å®šå‘æ¨é€ã€‚</p>
<h2 data-id="heading-9">äº”ã€æ€»ç»“</h2>
<p>æ•´ç¯‡æ–‡ç« å†™ä¸‹æ¥ï¼Œæ„Ÿè§‰åˆå›åˆ°äº†å½“åˆä¸€å¼€å§‹å†™é¡¹ç›®çš„æ—¶å€™ã€‚ç£•ç£•ç¢°ç¢°ï¼Œç¢°åˆ°å›°éš¾æ—¶å¿ƒçƒ¦æ„ä¹±ï¼Œè§£å†³é—®é¢˜æ—¶åˆä¸Šè¹¿ä¸‹è·³ğŸ¥²ï¼Œæ¸©æ•…è€ŒçŸ¥æ–°ï¼Œé€šè¿‡å¯¹WebSocketçš„å›é¡¾ï¼Œè¿›ä¸€æ­¥ç†è§£äº†å¦‚ä½•å®ç°ç”¨æˆ·ä¸‹å•å®æ—¶é€šçŸ¥åŠŸèƒ½ã€‚åŒæ—¶ä¹Ÿæå¤§çš„é¼“èˆäº†è‡ªä¿¡ï¼ŒåŸæ¥è®¤çœŸæŠ•å…¥å†™ä¸€ç¯‡åšå®¢å¯ä»¥å¸¦æ¥è¿™ä¹ˆå¤šçš„æ­£åé¦ˆï¼Œå½“ç„¶ä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸‰åˆ†é’Ÿçƒ­åº¦å“ˆğŸ˜ã€‚æ€»ä¹‹æ•¢äºè®°å½•è‡ªå·±ï¼Œæ•¢äºåˆ†äº«è‡ªå·±ï¼Œæ•¢äºå°è¯•ä¸åŒçš„ä½“éªŒã€‚</p>
<p><strong>æœ€åï¼š</strong>
æœ¬æ–‡ä»…ä½œä¸ºå­¦ä¹ è®°å½•åˆ†äº«ä½¿ç”¨ï¼Œå†…å®¹åŸºäºä½œè€…å½“å‰æŠ€æœ¯è®¤çŸ¥æ•´ç†ï¼Œè‹¥æœ‰ä¸å‡†ç¡®æˆ–æè¿°ä¸æ¸…ä¹‹å¤„ï¼Œæ¬¢è¿è¯„è®ºåŒºæŒ‡æ­£ï¼Œæˆ‘ä¼šåœ¨èƒ½åŠ›èŒƒå›´å†…ä¿®æ­£å®Œå–„ï¼Œè°¢è°¢é˜…è¯»ï¼ğŸ™</p>
<h2 data-id="heading-10">å‚è€ƒ</h2>
<p>1ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fspringdoc.cn%2Fspring-boot-websocket%2F" target="_blank" title="https://springdoc.cn/spring-boot-websocket/" ref="nofollow noopener noreferrer">åœ¨ Spring Boot ä¸­æ•´åˆã€ä½¿ç”¨ WebSocket - spring ä¸­æ–‡ç½‘</a></p>
<p>2ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fguoqi_666%2Farticle%2Fdetails%2F137260613" target="_blank" title="https://blog.csdn.net/guoqi_666/article/details/137260613" ref="nofollow noopener noreferrer">ä¸‡å­—è¯¦è§£ï¼Œå¸¦ä½ å½»åº•æŒæ¡ WebSocket ç”¨æ³•ï¼ˆè‡³å°Šå…¸è—ç‰ˆï¼‰å†™çš„ä¸é”™-CSDNåšå®¢</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å­¦ä¹  LiteLLM çš„æ¨¡å‹ç®¡ç†]]></title>    <link>https://juejin.cn/post/7573896789366472742</link>    <guid>https://juejin.cn/post/7573896789366472742</guid>    <pubDate>2025-11-19T01:06:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573896789366472742" data-draft-id="7573890735579463690" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å­¦ä¹  LiteLLM çš„æ¨¡å‹ç®¡ç†"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-19T01:06:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ—¥ä¹ ä¸€æŠ€"/> <meta itemprop="url" content="https://juejin.cn/user/3913917125896190"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å­¦ä¹  LiteLLM çš„æ¨¡å‹ç®¡ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3913917125896190/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ—¥ä¹ ä¸€æŠ€
  </span> <!----> <!----> <div class="vip-level" data-v-cd7d0a50="" data-v-292f6e48=""><span class="tooltip" data-v-cd7d0a50=""><div class="byte-tooltip byte-tooltip--dark" style="display:none;">
        VIP.1 åˆå­¦ä¹ç»ƒ
      </div><span class="byte-tooltip__wrapper"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="VIP.1 åˆå­¦ä¹ç»ƒ" title="VIP.1 åˆå­¦ä¹ç»ƒ" class="lazy" style="aspect-ratio:NaN;" data-v-5244ef91="" data-v-cd7d0a50=""/></span></span></div> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T01:06:37.000Z" title="Wed Nov 19 2025 01:06:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å¿«é€Ÿäº†è§£äº† LiteLLM çš„æ ¸å¿ƒç‰¹æ€§å’ŒåŸºæœ¬ç”¨æ³•ã€‚æˆ‘ä»¬çŸ¥é“ LiteLLM é€šè¿‡ç»Ÿä¸€çš„ API æ¥å£æ”¯æŒè°ƒç”¨ 100+ ä¸ª LLM æœåŠ¡å•†çš„æ¨¡å‹ï¼Œè€Œ Proxy Server å¯ä»¥ä½œä¸ºä¸€ä¸ªä¼ä¸šçº§çš„ LLM ç½‘å…³æ¥ç»Ÿä¸€ç®¡ç†å’Œè·¯ç”±è¯·æ±‚ã€‚</p>
<p>ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬çœŸæ­£å»éƒ¨ç½²å’Œä½¿ç”¨ LiteLLM Proxy æ—¶ï¼Œä¼šé¢ä¸´ä¸€ä¸ªéå¸¸å®é™…çš„é—®é¢˜ï¼š<strong>å¦‚ä½•æœ‰æ•ˆåœ°ç®¡ç†è¿™äº›æ¨¡å‹ï¼Ÿ</strong></p>
<p>æ˜¯å¦èƒ½å¤Ÿå¿«é€Ÿæ·»åŠ æ–°æ¨¡å‹è€Œä¸éœ€è¦é‡å¯æœåŠ¡ï¼Ÿèƒ½å¦è®©ç”¨æˆ·æ¸…æ¥šåœ°äº†è§£æœ‰å“ªäº›æ¨¡å‹å¯ç”¨ï¼Ÿåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•è¿½è¸ªæ¨¡å‹çš„å®šä»·å’Œæˆæœ¬ï¼Ÿæ€æ ·å®‰å…¨åœ°å­˜å‚¨å’Œç®¡ç†å„ä¸ªæœåŠ¡å•†çš„ API å‡­æ®ï¼Ÿè¿™äº›éƒ½æ˜¯æ¨¡å‹ç®¡ç†éœ€è¦è§£å†³çš„é—®é¢˜ã€‚</p>
<p>è¿™ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°±æ¥æ·±å…¥å­¦ä¹  LiteLLM çš„æ¨¡å‹ç®¡ç†åŠŸèƒ½ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å¸®åŠ©æˆ‘ä»¬è§£å†³è¿™äº›å®é™…é—®é¢˜çš„ã€‚</p>
<h2 data-id="heading-0">åŸºç¡€é…ç½®</h2>
<p>åœ¨å‰é¢çš„å¿«é€Ÿå…¥é—¨ç¯‡ï¼Œæˆ‘ä»¬å·²ç»æ¥è§¦è¿‡ç®€å•çš„æ¨¡å‹é…ç½®ï¼Œå¯ä»¥é€šè¿‡ <code>config.yaml</code> æ–‡ä»¶å®šä¹‰æ¨¡å‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">model_list:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">model_name:</span> <span class="hljs-string">gpt-4o</span>
    <span class="hljs-attr">litellm_params:</span>
      <span class="hljs-attr">model:</span> <span class="hljs-string">openai/gpt-4o</span>
      <span class="hljs-attr">api_key:</span> <span class="hljs-string">os.environ/OPENAI_API_KEY</span>

  <span class="hljs-bullet">-</span> <span class="hljs-attr">model_name:</span> <span class="hljs-string">claude</span>
    <span class="hljs-attr">litellm_params:</span>
      <span class="hljs-attr">model:</span> <span class="hljs-string">anthropic/claude-sonnet-4-20250514</span>
      <span class="hljs-attr">api_key:</span> <span class="hljs-string">os.environ/ANTHROPIC_API_KEY</span>
</code></pre>
<p>è¿™é‡Œçš„é…ç½®å¾ˆç›´è§‚ï¼š</p>
<ul>
<li><code>model_name</code> æ˜¯ç”¨æˆ·åœ¨è°ƒç”¨ API æ—¶ä½¿ç”¨çš„åç§°</li>
<li><code>litellm_params</code> åŒ…å«äº† LiteLLM åœ¨è°ƒç”¨è¯¥æ¨¡å‹æ—¶éœ€è¦çš„æ‰€æœ‰å‚æ•°ï¼ŒåŒ…æ‹¬å®é™…çš„æ¨¡å‹åç§°ã€API å¯†é’¥ã€URL åœ°å€ç­‰
<ul>
<li><code>model</code>ï¼šéµå¾ª <code>provider/model_id</code> çš„æ ¼å¼ï¼ŒLiteLLM é€šè¿‡è¿™ä¸ªæ¥è¯†åˆ«å®é™…çš„æ¨¡å‹å’ŒæœåŠ¡å•†</li>
<li><code>api_key</code>ï¼šæ”¯æŒ <code>os.environ/KEY_NAME</code> çš„æ ¼å¼æ¥ä»ç¯å¢ƒå˜é‡ä¸­è¯»å–ï¼Œé¿å…å°†å¯†é’¥ç¡¬ç¼–ç åœ¨é…ç½®æ–‡ä»¶ä¸­</li>
</ul>
</li>
</ul>
<p>ä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦æ›´å¤šçš„ä¿¡æ¯ã€‚æ¯”å¦‚ï¼ŒæŸä¸ªæ¨¡å‹çš„æœ€å¤§ Token æ•°æ˜¯å¤šå°‘ï¼Ÿè°ƒç”¨è¿™ä¸ªæ¨¡å‹çš„æˆæœ¬æ˜¯å¤šå°‘ï¼Ÿè¿™ä¸ªæ¨¡å‹æœ‰ä»€ä¹ˆç‰¹æ®Šçš„åŠŸèƒ½é™åˆ¶å—ï¼Ÿè¿™å°±éœ€è¦ç”¨åˆ° <code>model_info</code> å­—æ®µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>/model/info</code> æ¥å£äº†è§£æ¯ä¸ªæ¨¡å‹çš„è¯¦ç»†ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -X GET http://127.0.0.1:4000/model/info \
  -H <span class="hljs-string">'Authorization: Bearer sk-1234'</span> \
  -H <span class="hljs-string">'Content-Type: application/json'</span>
</code></pre>
<p>è¿”å›ç»“æœç±»ä¼¼ä¸‹å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/439d5c39c90244038ad6580f88ddf061~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764119197&amp;x-signature=OG1qxJaynoIXRAIObvIbAtmTg3Q%3D" alt="model-info.png" loading="lazy"/></p>
<p>å¯¹äºä¸€äº›æ¯”è¾ƒå¸¸è§çš„æ¨¡å‹ï¼ŒLiteLLM ä¼šå®šæœŸç»´æŠ¤åŸºæœ¬ä¿¡æ¯ï¼Œä¸è¿‡ç”¨æˆ·ä¹Ÿå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹ï¼Œè¿™æ ·ä¼šè¦†ç›–é»˜è®¤å€¼ï¼Œç”¨æˆ·è¿˜å¯ä»¥æ·»åŠ è‡ªå®šä¹‰çš„å­—æ®µï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">model_list:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">model_name:</span> <span class="hljs-string">gpt-4o</span>
    <span class="hljs-attr">litellm_params:</span>
      <span class="hljs-attr">model:</span> <span class="hljs-string">openai/gpt-4o</span>
      <span class="hljs-attr">api_key:</span> <span class="hljs-string">os.environ/OPENAI_API_KEY</span>
    <span class="hljs-attr">model_info:</span>
      <span class="hljs-attr">description:</span> <span class="hljs-string">"è¿™é‡Œæ˜¯ç”¨æˆ·è‡ªå®šä¹‰å­—æ®µ"</span>
      <span class="hljs-attr">max_tokens:</span> <span class="hljs-number">4096</span>
      <span class="hljs-attr">supports_vision:</span> <span class="hljs-literal">true</span>
      <span class="hljs-attr">supports_function_calling:</span> <span class="hljs-literal">true</span>
</code></pre>
<p>è¿™ä¸ª <code>/model/info</code> æ¥å£éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥ç”¨æ¥åœ¨åº”ç”¨çš„ UI ä¸­å±•ç¤ºå¯ç”¨çš„æ¨¡å‹åˆ—è¡¨å’Œè¯¦ç»†ä¿¡æ¯ï¼Œå¸®åŠ©ç”¨æˆ·é€‰æ‹©æœ€åˆé€‚çš„æ¨¡å‹ï¼Œè¿›è¡Œæˆæœ¬ä¼°ç®—å’Œé¢„ç®—è§„åˆ’ã€‚</p>
<h2 data-id="heading-1">åŠ¨æ€ç®¡ç†</h2>
<p>é€šè¿‡é…ç½®æ–‡ä»¶ç®¡ç†æ¨¡å‹å›ºç„¶ç®€å•ï¼Œä½†æ˜¯æ¯æ¬¡ä¿®æ”¹éƒ½éœ€è¦é‡å¯ Proxy Serverï¼Œè¿™åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹æ˜¯ä¸å¯æ¥å—çš„ã€‚LiteLLM æ”¯æŒå°†æ¨¡å‹ä¿¡æ¯ä¿å­˜åˆ° Postgres æ•°æ®åº“ä¸­ï¼Œä»è€Œå®ç°åŠ¨æ€ç®¡ç†åŠŸèƒ½ã€‚é¦–å…ˆä¿®æ”¹ <code>config.yaml</code> æ–‡ä»¶ï¼ŒåŠ ä¸Šæ•°æ®åº“é…ç½®å¹¶å¼€å¯æ¨¡å‹ä¿å­˜åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">general_settings:</span>
  <span class="hljs-attr">master_key:</span> <span class="hljs-string">sk-1234</span> <span class="hljs-comment"># ç®¡ç†å‘˜å¯†é’¥</span>
  <span class="hljs-attr">database_url:</span> <span class="hljs-string">"postgresql://postgres:password@127.0.0.1:5432/litellm"</span>
  <span class="hljs-attr">store_model_in_db:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># æ˜¯å¦å°†æ¨¡å‹ä¿å­˜åˆ°æ•°æ®åº“</span>
</code></pre>
<p>ç„¶åé‡å¯ Proxy Serverï¼Œç°åœ¨æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ API æ¥å£çš„æ–¹å¼åŠ¨æ€ç®¡ç†æ¨¡å‹äº†ï¼Œå…·ä½“åˆå¯ä»¥åˆ†ä¸º <strong>é€šè¿‡ API ç®¡ç†</strong>ã€<strong>é€šè¿‡å‘½ä»¤è¡Œç®¡ç†</strong>ã€<strong>é€šè¿‡ Web UI ç®¡ç†</strong> å‡ ç§æ–¹å¼ã€‚</p>
<h3 data-id="heading-2">é€šè¿‡ API ç®¡ç†</h3>
<p>é€šè¿‡ <code>/model/new</code> æ¥å£æ·»åŠ æ¨¡å‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -X POST <span class="hljs-string">"http://127.0.0.1:4000/model/new"</span> \
  -H <span class="hljs-string">'Authorization: Bearer sk-1234'</span> \
  -H <span class="hljs-string">"Content-Type: application/json"</span> \
  -d <span class="hljs-string">'{
    "model_name": "deepseek",
    "litellm_params": {
      "model": "deepseek/deepseek-chat",
      "api_key": "sk-xxx"
    }
  }'</span>
</code></pre>
<h3 data-id="heading-3">é€šè¿‡å‘½ä»¤è¡Œç®¡ç†</h3>
<p>LiteLLM è¿˜æä¾›äº†ä¸€ä¸ª<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fproxy%2Fmanagement_cli" target="_blank" title="https://docs.litellm.ai/docs/proxy/management_cli" ref="nofollow noopener noreferrer">å‘½ä»¤è¡Œå·¥å…· <code>litellm-proxy</code></a>ï¼Œæ–¹ä¾¿ä»å‘½ä»¤è¡Œç®¡ç†æ¨¡å‹ï¼Œè¿™ä¸ªå·¥å…·åœ¨å®‰è£… Proxy Server æ—¶ä¼šä¸€èµ·å®‰è£…å¥½ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ pip install <span class="hljs-string">'litellm[proxy]'</span>
</code></pre>
<p>é¦–å…ˆé€šè¿‡ç¯å¢ƒå˜é‡é…ç½®è®¤è¯ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">export</span> LITELLM_PROXY_URL=http://localhost:4000
<span class="hljs-built_in">export</span> LITELLM_PROXY_API_KEY=sk-1234
</code></pre>
<blockquote>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>litellm-proxy login</code> ç™»å½•ï¼Œè¿™ä¼šæ‰“å¼€æµè§ˆå™¨è¿›è¡Œèº«ä»½è®¤è¯ï¼Œè®¤è¯åçš„å‡­æ®ä¼šä¿å­˜åœ¨æœ¬åœ°ã€‚</p>
</blockquote>
<p><strong>åˆ—å‡ºæ‰€æœ‰æ¨¡å‹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ litellm-proxy models list
</code></pre>
<p><strong>æ·»åŠ æ–°æ¨¡å‹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ litellm-proxy models add deepseek \
  --param model=deepseek/deepseek-chat \
  --param api_key=sk-xxxx
</code></pre>
<p><strong>åˆ é™¤æ¨¡å‹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ litellm-proxy models delete &lt;model-id&gt;
</code></pre>
<h3 data-id="heading-4">é€šè¿‡ Web UI ç®¡ç†</h3>
<p>å¦‚æœä½ ä¸ä¹ æƒ¯ä½¿ç”¨å‘½ä»¤è¡Œï¼ŒLiteLLM Proxy çš„ Web UI ä¹Ÿæä¾›äº†å¯è§†åŒ–çš„æ¨¡å‹ç®¡ç†ç•Œé¢ï¼Œç™»å½•åˆ°ç®¡ç†åå°åï¼Œç‚¹å‡» â€œModels + Endpointsâ€ èœå•ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ee5e286d3b746b48f95d9de8cf5e49f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764119197&amp;x-signature=OAuj1P1Xyvb5gGF8Ttp6EdFOjbI%3D" alt="web-ui-model-management.png" loading="lazy"/></p>
<p>è¿™é‡Œåˆ—å‡ºäº†å½“å‰ç³»ç»Ÿçš„æ‰€æœ‰æ¨¡å‹ï¼ŒåŒ…æ‹¬é…ç½®æ–‡ä»¶ä¸­çš„å’Œæ•°æ®åº“ä¸­çš„ã€‚ç‚¹å‡» â€œAdd Modelâ€ æ ‡ç­¾æ·»åŠ æ–°æ¨¡å‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cae9e2825488414d902072e41b22e8d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764119197&amp;x-signature=u4tviFWAPoLrcrs9eYEp0Fjvc%2Fk%3D" alt="web-ui-add-model.png" loading="lazy"/></p>
<p>å¡«å†™ Providerã€Model Namesã€Model Mappingsã€API Key ç­‰å‚æ•°ï¼Œç‚¹å‡»ç¡®è®¤å³å¯ã€‚</p>
<p>æ³¨æ„ï¼ŒModel Mappings ä¸­çš„ Public Model Name å°±å¯¹åº”é…ç½®æ–‡ä»¶ä¸­çš„ <code>model_name</code> å‚æ•°ï¼ŒLiteLLM Model Name å¯¹åº” <code>litellm_params.model</code> å‚æ•°ã€‚</p>
<p>å¦‚æœæœ‰ä¸€äº›é¢å¤–å‚æ•°ï¼Œå¯ä»¥å±•å¼€ â€œAdvanced Settingsâ€ è¿›è¡Œé…ç½®ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6d2283d1c1f446496bc355e035725d6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764119197&amp;x-signature=tkBj4umD07h9XySw0s46TtmQc8E%3D" alt="web-ui-add-model-adv.png" loading="lazy"/></p>
<h2 data-id="heading-5">æ¨¡å‹å‘ç°</h2>
<p>æ‰‹åŠ¨ç»´æŠ¤æ¨¡å‹åˆ—è¡¨å¯èƒ½ä¼šå¾ˆç¹çï¼Œç‰¹åˆ«æ˜¯å¯¹äºé‚£äº›æœ‰å¤§é‡æ¨¡å‹çš„æœåŠ¡å•†ï¼Œæ¯”å¦‚ OpenAIã€Anthropic ç­‰ï¼Œæ¯æ¬¡ä»–ä»¬å‘å¸ƒæ–°æ¨¡å‹æ—¶æˆ‘ä»¬éƒ½è¦æ‰‹åŠ¨æ›´æ–°é…ç½®ã€‚ä¸ºæ­¤ï¼ŒLiteLLM æ¨å‡ºäº† <strong>æ¨¡å‹å‘ç°ï¼ˆModel Discoveryï¼‰</strong> åŠŸèƒ½ï¼Œé€šè¿‡ <strong>Wildcard æ¨¡å‹</strong> LiteLLM å¯ä»¥è‡ªåŠ¨ä»æœåŠ¡å•†å¤„è·å–æœ€æ–°çš„æ¨¡å‹åˆ—è¡¨ï¼Œæ— éœ€æ‰‹åŠ¨æ›´æ–°ã€‚</p>
<p>å…¶é…ç½®éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨ <code>config.yaml</code> ä¸­ä½¿ç”¨ <code>/*</code> åç¼€æ¥è¡¨ç¤º Wildcard æ¨¡å‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">model_list:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">model_name:</span> <span class="hljs-string">anthropic/*</span>
    <span class="hljs-attr">litellm_params:</span>
      <span class="hljs-attr">model:</span> <span class="hljs-string">anthropic/*</span>
      <span class="hljs-attr">api_key:</span> <span class="hljs-string">os.environ/ANTHROPIC_API_KEY</span>

<span class="hljs-attr">litellm_settings:</span>
  <span class="hljs-attr">check_provider_endpoint:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># å¯ç”¨æ¨¡å‹å‘ç°åŠŸèƒ½</span>
</code></pre>
<p>æ³¨æ„ <code>litellm_settings.check_provider_endpoint</code> å¿…é¡»è®¾ä¸º <code>true</code>ï¼Œè¡¨ç¤ºå¯ç”¨æ¨¡å‹å‘ç°åŠŸèƒ½ã€‚</p>
<p>é…ç½®å®Œæˆåï¼Œè°ƒç”¨ <code>/v1/models</code> æ¥å£å°±å¯ä»¥çœ‹åˆ°æ‰€æœ‰è‡ªåŠ¨å‘ç°çš„æ¨¡å‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -X GET http://127.0.0.1:4000/v1/models \
  -H <span class="hljs-string">'Authorization: Bearer sk-1234'</span> \
  -H <span class="hljs-string">'Content-Type: application/json'</span>
</code></pre>
<p>è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯ Anthropic æœåŠ¡å•†ï¼Œå› æ­¤è¿”å›çš„ç»“æœåŒ…å«äº† Anthropic çš„æ‰€æœ‰å¯ç”¨æ¨¡å‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b47062c3e17848299b6f543146d487ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764119197&amp;x-signature=O5aoW2TrVMe5kJu2Md4OXQ1nKKI%3D" alt="model-discovery.png" loading="lazy"/></p>
<p>ç›®å‰ LiteLLM çš„æ¨¡å‹å‘ç°åŠŸèƒ½æ”¯æŒä»¥ä¸‹æœåŠ¡å•†ï¼š</p>
<ul>
<li>Fireworks AI</li>
<li>OpenAI</li>
<li>Gemini</li>
<li>LiteLLM Proxyï¼ˆæ˜¯çš„ï¼Œå¯ä»¥çº§è”ï¼ï¼‰</li>
<li>Topaz</li>
<li>Anthropic</li>
<li>xAI</li>
<li>vLLM</li>
<li>Vertex AI</li>
</ul>
<h2 data-id="heading-6">ä½¿ç”¨ Model Hub å…¬å¼€æ¨¡å‹</h2>
<p>åœ¨å›¢é˜Ÿæˆ–ä¼ä¸šç¯å¢ƒä¸­ï¼Œä½ å¯èƒ½å¸Œæœ›è®©ç”¨æˆ·çŸ¥é“å“ªäº›æ¨¡å‹æ˜¯å¯ç”¨çš„ï¼ŒLiteLLM æä¾›äº†ä¸€ä¸ª <strong>Model Hub</strong> åŠŸèƒ½ï¼Œå¯ä»¥å…¬å¼€å±•ç¤ºæ¨¡å‹åˆ—è¡¨ã€‚ä½¿ç”¨ Model Hub æœ‰ä»¥ä¸‹å‡ ç‚¹ä¼˜åŠ¿ï¼š</p>
<ol>
<li><strong>è‡ªæœåŠ¡æ¢ç´¢</strong>ï¼šç”¨æˆ·å¯ä»¥è‡ªå·±æµè§ˆå¯ç”¨çš„æ¨¡å‹ï¼Œæ— éœ€è¯¢é—®ç®¡ç†å‘˜</li>
<li><strong>ä¿¡æ¯é€æ˜</strong>ï¼šæ¯ä¸ªæ¨¡å‹éƒ½å±•ç¤ºè¯¦ç»†çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬æè¿°ã€èƒ½åŠ›ã€å±€é™ç­‰</li>
<li><strong>é™ä½é—¨æ§›</strong>ï¼šæ–°ç”¨æˆ·å¯ä»¥å¿«é€Ÿäº†è§£ç³»ç»Ÿä¸­æœ‰ä»€ä¹ˆï¼Œå¦‚ä½•ä½¿ç”¨</li>
<li><strong>å…¬å¼€æ¼”ç¤º</strong>ï¼šå¯ä»¥ç”¨æ¥å‘å®¢æˆ·æˆ–åˆä½œä¼™ä¼´å±•ç¤ºä½ çš„æ¨¡å‹èƒ½åŠ›</li>
</ol>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨ Web UI ä¸­é€‰æ‹©è¦å…¬å¼€çš„æ¨¡å‹ã€‚è¿›å…¥ Model Hub é¡µé¢åï¼Œç‚¹å‡» â€œMake Publicâ€ æŒ‰é’®ï¼Œé€‰æ‹©è¦å…¬å¼€çš„æ¨¡å‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/544981869f4f4afc92f616e49e7aef67~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764119197&amp;x-signature=ZWFl3rzrlgA71YKf0vQhIRLcUjg%3D" alt="model-hub-make-public.png" loading="lazy"/></p>
<p>ç¡®è®¤åï¼Œè¿™äº›æ¨¡å‹å°±ä¼šå‡ºç°åœ¨å…¬å¼€çš„ Model Hub é¡µé¢ä¸Šï¼Œè®¿é—®ä¸‹é¢è¿™ä¸ª URL è¿›è¡ŒæŸ¥çœ‹ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">http:<span class="hljs-comment">//127.0.0.1:4000/ui/model_hub_table</span>
</code></pre>
<p>è¿™ä¸ªé¡µé¢æ˜¯å…¬å¼€çš„ï¼Œæ‰€æœ‰äººéƒ½èƒ½è®¿é—®ï¼Œå°±åƒä¸€ä¸ªåº”ç”¨å•†åº—ä¸€æ ·ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/842124837d6648c5bc0b884b782d09bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764119197&amp;x-signature=PX8xlCE%2FSAgu6fVUivZHvLQqvOY%3D" alt="model-hub-table.png" loading="lazy"/></p>
<p>ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹æ¯ä¸ªæ¨¡å‹çš„è¯¦ç»†ä¿¡æ¯ä»¥åŠä½¿ç”¨æ–‡æ¡£ã€‚</p>
<h2 data-id="heading-7">æ¨¡å‹ä»·æ ¼åŒæ­¥</h2>
<p>åœ¨ä¸Šé¢çš„å­¦ä¹ ä¸­æˆ‘ä»¬äº†è§£åˆ°ï¼Œå¯ä»¥é€šè¿‡ <code>/model/info</code> æ¥å£æŸ¥è¯¢æ¨¡å‹çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ¨¡å‹çš„ä¸Šä¸‹æ–‡é™åˆ¶ä»¥åŠè¾“å…¥è¾“å‡ºä»·æ ¼ç­‰ï¼Œè¿™äº›ä¿¡æ¯æœ‰åŠ©äºä¼ä¸šè¿›è¡Œå‡†ç¡®çš„æˆæœ¬è¿½è¸ªå’Œé¢„ç®—æ§åˆ¶ã€‚</p>
<p>LiteLLM åœ¨ GitHub ä¸Šç»´æŠ¤äº†ä¸€ä¸ªå®Œæ•´çš„æ¨¡å‹æˆæœ¬æ˜ å°„è¡¨ï¼ŒåŒ…å«äº† 100+ ä¸ªæ¨¡å‹çš„è¯¦ç»†ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">https://github.com/BerriAI/litellm/blob/main/model_prices_and_context_window.json
</code></pre>
<p>éšç€æ–°æ¨¡å‹çš„å‘å¸ƒå’Œä»·æ ¼çš„å˜åŒ–ï¼Œè¿™ä¸ªæ˜ å°„è¡¨ä¼šå®šæœŸæ›´æ–°ã€‚ä¸ºäº†ä¿æŒä½ çš„ Proxy Server ä¸­çš„æˆæœ¬æ•°æ®æœ€æ–°ï¼ŒLiteLLM æä¾›äº† <strong>æ‰‹åŠ¨åŒæ­¥</strong> å’Œ <strong>è‡ªåŠ¨åŒæ­¥</strong> çš„åŠŸèƒ½ï¼Œå¯ä»¥ä» GitHub è·å–æœ€æ–°çš„ä»·æ ¼ä¿¡æ¯ï¼Œç¡®ä¿æˆæœ¬è¿½è¸ªçš„å‡†ç¡®æ€§ã€‚</p>
<p>å¦‚æœä½ æƒ³ç«‹å³åŒæ­¥æœ€æ–°çš„ä»·æ ¼ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -X POST <span class="hljs-string">"http://127.0.0.1:4000/reload/model_cost_map"</span> \
  -H <span class="hljs-string">"Authorization: Bearer sk-1234"</span> \
  -H <span class="hljs-string">"Content-Type: application/json"</span>
</code></pre>
<p>å¯¹äºç”Ÿäº§ç¯å¢ƒï¼Œæ›´æ¨èè®¾ç½®è‡ªåŠ¨å®šæœŸåŒæ­¥ï¼Œæ¯”å¦‚æ¯ 6 å°æ—¶åŒæ­¥ä¸€æ¬¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -X POST <span class="hljs-string">"http://127.0.0.1:4000/schedule/model_cost_map_reload?hours=6"</span> \
  -H <span class="hljs-string">"Authorization: Bearer sk-1234"</span> \
  -H <span class="hljs-string">"Content-Type: application/json"</span>
</code></pre>
<p>æŸ¥çœ‹åŒæ­¥çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -X GET <span class="hljs-string">"http://127.0.0.1:4000/schedule/model_cost_map_reload/status"</span> \
  -H <span class="hljs-string">"Authorization: Bearer sk-1234"</span>
</code></pre>
<p>å–æ¶ˆå®šæ—¶åŒæ­¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -X DELETE <span class="hljs-string">"http://127.0.0.1:4000/schedule/model_cost_map_reload"</span> \
  -H <span class="hljs-string">"Authorization: Bearer sk-1234"</span>
</code></pre>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒLiteLLM ä» GitHub çš„å®˜æ–¹ä»“åº“è·å–æ¨¡å‹æˆæœ¬è¡¨ã€‚å¦‚æœä½ æœ‰ä¸€äº›å®šåˆ¶æ¨¡å‹ï¼Œæƒ³ä½¿ç”¨è‡ªå®šä¹‰çš„æ¨¡å‹æˆæœ¬è¡¨ï¼Œå¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">export</span> LITELLM_MODEL_COST_MAP_URL=<span class="hljs-string">"https://your-server.com/your-cost-map.json"</span>
</code></pre>
<p>æˆ–è€…ä½¿ç”¨æœ¬åœ°æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">export</span> LITELLM_LOCAL_MODEL_COST_MAP=True
</code></pre>
<p>æ­¤æ—¶ LiteLLM ä¼šè¯»å– <code>litellm</code> ç›®å½•ä¸‹çš„ <code>model_prices_and_context_window_backup.json</code> æ–‡ä»¶ï¼Œä¸ä¼šè®¿é—®ç½‘ç»œã€‚</p>
<h2 data-id="heading-8">å‡­æ®ç®¡ç†</h2>
<p>å…³äºæ¨¡å‹ç®¡ç†çš„å¦ä¸€ä¸ªè¯é¢˜æ˜¯ <strong>å‡­æ®ç®¡ç†</strong>ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒLiteLLM æ”¯æŒ 100 å¤šä¸ªä¸åŒçš„æ¨¡å‹æœåŠ¡å•†ï¼Œæ¯ä¸ªæœåŠ¡å•†éƒ½æœ‰è‡ªå·±çš„ API Key æˆ–è®¤è¯æ–¹å¼ï¼Œå¦‚ä½•å®‰å…¨çš„ç®¡ç†è¿™äº›æœåŠ¡å•†çš„å‡­æ®å‘¢ï¼Ÿ</p>
<p>åœ¨å‰é¢çš„ <code>config.yaml</code> æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬é…ç½® <code>api_key</code> æ—¶ä½¿ç”¨äº† <code>os.environ/KEY_NAME</code> æ ¼å¼ä»ç¯å¢ƒå˜é‡ä¸­è¯»å–ï¼Œè¿™æ˜¯æœ€ç®€å•çš„ä¸€ç§å‡­æ®ç®¡ç†çš„æ–¹å¼ï¼Œé¿å…å°†å¯†é’¥ç¡¬ç¼–ç åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œè™½ç„¶å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼éš¾ä»¥ç®¡ç†ï¼Œè€Œä¸”ä¹Ÿä¸å¤Ÿå®‰å…¨ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½å¸Œæœ›åœ¨ LiteLLM çš„æ•°æ®åº“ä¸­ç›´æ¥å­˜å‚¨å’Œç®¡ç†è¿™äº›å‡­è¯ã€‚</p>
<p>LiteLLM æä¾›äº†ä¸€ä¸ªä¸“é—¨çš„å‡­è¯ç®¡ç†ç•Œé¢ï¼Œè¿›å…¥ Models -&gt; LLM Credentials -&gt; Add Credentialï¼Œå¯ä»¥æ·»åŠ æ–°çš„å‡­è¯ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f70133b3a564b2d8562be32e6b49419~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764119197&amp;x-signature=8iFVZnATpQgJmQX1NeUd03ooneY%3D" alt="web-ui-add-credentials.png" loading="lazy"/></p>
<p>é€‰æ‹©ä½ çš„ LLM æœåŠ¡å•†åï¼Œè¾“å…¥ API Key å’Œå…¶ä»–å¿…è¦ä¿¡æ¯ï¼ˆæ ¹æ®ä¸åŒçš„æœåŠ¡å•†ï¼Œç•Œé¢ä¼šæ˜¾ç¤ºç›¸åº”çš„å­—æ®µï¼‰ï¼Œç‚¹å‡»ç¡®è®¤å³å¯ã€‚æ·»åŠ å‡­è¯åï¼Œåœ¨åˆ›å»ºæ–°æ¨¡å‹æ—¶å°±å¯ä»¥ä»ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹©å·²æœ‰çš„å‡­è¯ï¼Œé¿å…é‡å¤è¾“å…¥æ•æ„Ÿä¿¡æ¯ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5654aa312adf41c5a1d10a62536a5b14~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764119197&amp;x-signature=Xd%2FIZjE9ki4cLgCsjV8366Ys7nc%3D" alt="web-ui-add-model-use-credentials.png" loading="lazy"/></p>
<p>å‡­è¯åœ¨æ•°æ®åº“ä¸­æ˜¯åŠ å¯†å­˜å‚¨çš„ã€‚LiteLLM ä½¿ç”¨ä»¥ä¸‹æ–¹å¼è¿›è¡ŒåŠ å¯†ï¼š</p>
<ul>
<li>ä¼˜å…ˆä½¿ç”¨ <code>LITELLM_SALT_KEY</code> è¿›è¡ŒåŠ å¯†</li>
<li>å¦‚æœæœªè®¾ç½® <code>LITELLM_SALT_KEY</code>ï¼Œåˆ™ä½¿ç”¨ <code>LITELLM_MASTER_KEY</code> è¿›è¡ŒåŠ å¯†</li>
</ul>
<p>è¿™ä¸¤ä¸ªå¯†é’¥éƒ½åº”è¯¥è¢«å¦¥å–„ä¿ç®¡ï¼Œä¸è¦æ³„éœ²ã€‚</p>
<h3 data-id="heading-9">ä¼ä¸šçº§å‡­æ®ç®¡ç†</h3>
<p>å¯¹äºä¼ä¸šçº§åº”ç”¨ï¼Œå¯¹äºå‡­æ®ç®¡ç†å¯èƒ½æœ‰ç€æ›´é«˜çš„å®‰å…¨è¦æ±‚ï¼ŒLiteLLM æ”¯æŒä¸ä¸»æµçš„ <strong>å¯†é’¥ç®¡ç†æœåŠ¡ï¼ˆSecrets Managerï¼‰</strong> é›†æˆï¼Œå…è®¸ä½ å°†å‡­æ®å­˜å‚¨åœ¨ä¼ä¸šçº§çš„å¯†é’¥ç®¡ç†æœåŠ¡ä¸­ï¼Œè€Œä¸æ˜¯ LiteLLM çš„æ•°æ®åº“ä¸­ã€‚æ”¯æŒçš„ Secrets Manager åŒ…æ‹¬ï¼š</p>
<ul>
<li>AWS Secrets Manager</li>
<li>AWS Key Management Service</li>
<li>Azure Key Vault</li>
<li>Google Secret Manager</li>
<li>Google Key Management Service</li>
<li>HashiCorp Vault</li>
</ul>
<p>é™¤äº†ä¼ ç»Ÿçš„ API Keyï¼ŒLiteLLM è¿˜æ”¯æŒ <strong>OpenID Connect (OIDC)</strong> èº«ä»½è®¤è¯ï¼Œè¿™æ˜¯ä¸€ç§æ›´ç°ä»£ã€æ›´å®‰å…¨çš„è®¤è¯æ–¹å¼ã€‚æ”¯æŒçš„ OIDC æä¾›å•†åŒ…æ‹¬ï¼š</p>
<ul>
<li>Google Cloud Run</li>
<li>GitHub Actions</li>
<li>Azure AD</li>
<li>CircleCI</li>
<li>Azure Kubernetes Service ç­‰</li>
</ul>
<p>è¿™ä¸¤ä¸ªåŠŸèƒ½ç‰¹åˆ«é€‚åˆå¤§å‹ä¼ä¸šç¯å¢ƒï¼Œå¯ä»¥æ˜¾è‘—æé«˜å®‰å…¨æ€§å’Œåˆè§„æ€§ã€‚è¯¦ç»†çš„ä¼ä¸šç‰¹æ€§é…ç½®ï¼Œè¯·å‚è€ƒ LiteLLM å®˜æ–¹æ–‡æ¡£ã€‚</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Fsecret" target="_blank" title="https://docs.litellm.ai/docs/secret" ref="nofollow noopener noreferrer">docs.litellm.ai/docs/secret</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.litellm.ai%2Fdocs%2Foidc" target="_blank" title="https://docs.litellm.ai/docs/oidc" ref="nofollow noopener noreferrer">docs.litellm.ai/docs/oidc</a></li>
</ul>
<h2 data-id="heading-10">å°ç»“</h2>
<p>é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬è¯¦ç»†å­¦ä¹ äº† LiteLLM Proxy çš„æ¨¡å‹ç®¡ç†åŠŸèƒ½ã€‚ä¸»è¦å†…å®¹åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>åŸºç¡€é…ç½®</strong>ï¼šå¯¹äºç›¸å¯¹ç¨³å®šçš„æ¨¡å‹é…ç½®ï¼Œåº”è¯¥åœ¨ <code>config.yaml</code> ä¸­å®šä¹‰ï¼Œè¿™æ ·å¯ä»¥ç‰ˆæœ¬æ§åˆ¶ï¼Œä¾¿äºå›æ»šï¼›å……åˆ†åˆ©ç”¨ <code>model_info</code> å­—æ®µæ¥æ·»åŠ æ¨¡å‹æè¿°ã€èƒ½åŠ›è¯´æ˜ã€ä½¿ç”¨å»ºè®®ç­‰ï¼Œè¿™ä¼šè®©ç”¨æˆ·æ›´å®¹æ˜“é€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼›</li>
<li><strong>åŠ¨æ€ç®¡ç†</strong>ï¼šé€šè¿‡ <code>/model/new</code> æ¥å£åœ¨è¿è¡Œæ—¶åŠ¨æ€æ·»åŠ æ¨¡å‹ï¼Œæ”¯æŒ APIã€å‘½ä»¤è¡Œã€Web UI ä¸‰ç§æ–¹å¼å¯¹æ¨¡å‹è¿›è¡Œç®¡ç†ï¼Œæ— éœ€é‡å¯æœåŠ¡ï¼›</li>
<li><strong>æ¨¡å‹å‘ç°</strong>ï¼šé€šè¿‡é€šé…ç¬¦è‡ªåŠ¨è·å–æ•´ä¸ªæœåŠ¡å•†çš„æ¨¡å‹åˆ—è¡¨ï¼›</li>
<li><strong>Model Hub</strong>ï¼šå…¬å¼€å±•ç¤ºå¯ç”¨çš„æ¨¡å‹ä¿¡æ¯ï¼Œæå‡ç”¨æˆ·ä½“éªŒï¼›</li>
<li><strong>æ¨¡å‹ä»·æ ¼åŒæ­¥</strong>ï¼šæ‰‹åŠ¨æˆ–è‡ªåŠ¨ä» GitHub åŒæ­¥æœ€æ–°çš„æ¨¡å‹æˆæœ¬æ•°æ®ï¼Œæ”¯æŒè‡ªå®šä¹‰æ¨¡å‹æˆæœ¬è¡¨ï¼›</li>
<li><strong>å‡­æ®ç®¡ç†</strong>ï¼šé›†ä¸­ç®¡ç† API Key å’Œå‡­æ®ä¿¡æ¯ï¼Œé™ä½å‡­æ®æ³„éœ²çš„é£é™©ï¼›å¯¹äºé«˜å®‰å…¨è¦æ±‚åœºæ™¯ï¼Œè€ƒè™‘ä½¿ç”¨ä¼ä¸šç‰¹æ€§ï¼ˆSecret Manager æˆ– OIDCï¼‰ï¼Œå®ç°é›¶å¯†é’¥å­˜å‚¨æˆ–ä¸´æ—¶å‡­æ®ï¼›</li>
</ul>
<p>LiteLLM çš„æ¨¡å‹ç®¡ç†ç³»ç»Ÿè®¾è®¡å¾—ç›¸å½“å®Œå–„ï¼Œæ—¢æ”¯æŒåˆæœŸçš„ç®€å•é…ç½®ï¼Œä¹Ÿæ”¯æŒåæœŸçš„å¤æ‚è¿ç»´åœºæ™¯ã€‚ä» <code>config.yaml</code> çš„å£°æ˜å¼é…ç½®ï¼Œåˆ°è¿è¡Œæ—¶çš„åŠ¨æ€ç®¡ç†ï¼Œå†åˆ°ä¼ä¸šçº§çš„é«˜å®‰å…¨å‡­æ®å­˜å‚¨ï¼ŒLiteLLM ä¸ºä¸åŒè§„æ¨¡çš„åº”ç”¨æä¾›äº†çµæ´»çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-11">æ¬¢è¿å…³æ³¨</h2>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„åŒåå…¬ä¼—å·ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fi-study-everyday.online%2Fabout-me.html" target="_blank" title="https://i-study-everyday.online/about-me.html" ref="nofollow noopener noreferrer">æ—¥ä¹ ä¸€æŠ€ï¼Œæ¯å¤©å­¦ä¸€ç‚¹æ–°æŠ€æœ¯</a>ã€‚</p>
<p>æˆ‘ä¼šæ¯å¤©èŠ±ä¸€ä¸ªå°æ—¶ï¼Œè®°å½•ä¸‹æˆ‘å­¦ä¹ çš„ç‚¹ç‚¹æ»´æ»´ã€‚å†…å®¹åŒ…æ‹¬ä½†ä¸é™äºï¼š</p>
<ul>
<li>æŸä¸ªäº§å“çš„ä½¿ç”¨å°çªé—¨</li>
<li>å¼€æºé¡¹ç›®çš„å®è·µå’Œå¿ƒå¾—</li>
<li>æŠ€æœ¯ç‚¹çš„ç®€å•è§£è¯»</li>
</ul>
<p>ç›®æ ‡æ˜¯è®©å¤§å®¶ç”¨5åˆ†é’Ÿè¯»å®Œå°±èƒ½æœ‰æ‰€æ”¶è·ï¼Œä¸éœ€è¦å¤ªè´¹åŠ²ï¼Œä½†å´å¯ä»¥è½»æ¾è·å–ä¸€äº›å¹²è´§ã€‚ä¸ç®¡ä½ æ˜¯æŠ€æœ¯æ–°æ‰‹è¿˜æ˜¯è€é¸Ÿï¼Œæ¬¢è¿ç»™æˆ‘æå»ºè®®ï¼Œå¦‚æœæœ‰æƒ³å­¦ä¹ çš„æŠ€æœ¯ï¼Œä¹Ÿæ¬¢è¿äº¤æµï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Reactçš„useRefçš„æ·±åº¦è§£æä¸åº”ç”¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7573912365910884394</link>    <guid>https://juejin.cn/post/7573912365910884394</guid>    <pubDate>2025-11-19T00:16:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573912365910884394" data-draft-id="7554332546579529766" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Reactçš„useRefçš„æ·±åº¦è§£æä¸åº”ç”¨æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,React.js"/> <meta itemprop="datePublished" content="2025-11-19T00:16:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¹å¤šå¤š"/> <meta itemprop="url" content="https://juejin.cn/user/747323639737191"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Reactçš„useRefçš„æ·±åº¦è§£æä¸åº”ç”¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/747323639737191/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¹å¤šå¤š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T00:16:00.000Z" title="Wed Nov 19 2025 00:16:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:2;font-weight:400;font-size:15px;overflow-x:hidden;color:#333;letter-spacing:1.2px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:.5rem solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c;margin:0 5px}.markdown-body a:active,.markdown-body a:hover{text-decoration:none;border-bottom:1.5px solid #3eaf7c}.markdown-body a[href^=http]:after{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04MzIgMTI4SDY0MHY2NGgxNDYuNzUyTDUyMS4zNzYgNDU3LjM3Nmw0NS4yNDggNDUuMjQ4TDgzMiAyMzcuMjQ4VjM4NGg2NFYxMjh6IiBmaWxsPSIjM2VhZjdjIi8+PHBhdGggZD0iTTc2OCA4MzJIMTkyVjI1NmgzNTJ2LTY0SDE2MGEzMiAzMiAwIDAwLTMyIDMydjY0MGEzMiAzMiAwIDAwMzIgMzJoNjQwYTMyIDMyIDAgMDAzMi0zMlY0ODBoLTY0djM1MnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");margin-left:2px}.markdown-body a[href^="#"]:before{content:"#"}.markdown-body table{display:inline-block!important;font-size:13px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c;border-collapse:collapse}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:4px 8px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#7b7878;padding:1px 23px;border-left:.5rem solid;border-color:#42b983;background-color:rgba(66,184,131,.1);position:relative;margin:14px 8px 0}.markdown-body blockquote:before{display:inline-block;position:absolute;content:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUiIGhlaWdodD0iMjUiIHZpZXdCb3g9IjAgMCAyNyAyNyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjg2MiAxLjg2MikiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0ibm9uZSI+PGNpcmNsZSBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS43MjQiIGZpbGw9IiM0MkI5ODMiIGN4PSIxMS42MzgiIGN5PSIxMS42MzgiIHI9IjExLjYzOCIvPjxwYXRoIGQ9Ik0xNC45NzggNi4yN0E1LjAwNiA1LjAwNiAwIDAwNi42NyA5LjQ2OGE0LjkwMSA0LjkwMSAwIDAwMS43NzMgNC4zNjJjLjMyMy4yNTguNTE0LjY0Ny41MjIgMS4wNnYxLjA2YTIuNjg1IDIuNjg1IDAgMDA1LjM3IDB2LTEuMDA4Yy4wMDItLjM5OC4xNzMtLjc3Ny40Ny0xLjA0MmE1LjAyMyA1LjAyMyAwIDAwLjE3My03LjYzem0tMy4zMzcgMTAuOTY3YTEuMzA0IDEuMzA0IDAgMDEtMS4yODYtMS4yODd2LS4yNzhoMi41NzJ2LjI2MWMwIC43MTMtLjU3MyAxLjI5NC0xLjI4NiAxLjMwNHptMi4yNi00LjQxNWMtLjQ0LjM4My0uNzUuODkzLS44ODcgMS40NmgtMi43NDZhMi44NjggMi44NjggMCAwMC0uOTM4LTEuNTNoLS4wMThhMy40NzYgMy40NzYgMCAwMS0xLjI2OS0zLjE0NSAzLjYxNSAzLjYxNSAwIDAxNy4xOTYuNCAzLjY1IDMuNjUgMCAwMS0xLjMzOCAyLjgxNXoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+");width:25px;height:25px;left:-16px;top:12px}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none;padding-left:10px}.markdown-body ul li::marker{content:"â€¢";color:#3eaf7c}.markdown-body ul li.task-list-item:before{content:"";margin-right:0}.markdown-body input[type=checkbox]{vertical-align:text-bottom;box-shadow:inset 0 0 0 10px #fff}.markdown-body input[type=checkbox]:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04NzcuMDU2IDE0Ni45NDR2NzMwLjExMkgxNDYuOTQ0VjE0Ni45NDRoNzMwLjExMnptMC0xMDQuMjc3SDE0Ni45NDRjLTU3LjYyOCAwLTEwNC4yNzcgNDYuNjQ5LTEwNC4yNzcgMTA0LjI3N3Y3MzAuMTEyYzAgNTcuNjI4IDQ2LjY0OSAxMDQuMjc3IDEwNC4yNzcgMTA0LjI3N2g3MzAuMTEyYzU3LjYyOCAwIDEwNC4yNzctNDYuNjQ5IDEwNC4yNzctMTA0LjI3N1YxNDYuOTQ0YzAtNTcuNjI4LTQ2LjY0OS0xMDQuMjc3LTEwNC4yNzctMTA0LjI3N3oiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}.markdown-body input[type=checkbox]:checked:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik05MTAuMjA4IDBIMTEzLjc2QTExNC4xMTIgMTE0LjExMiAwIDAwLS4wMzIgMTEzLjc5MlY5MTAuMjRjMCA2Mi41OTIgNTEuMiAxMTMuNzkyIDExMy43OTIgMTEzLjc5Mmg3OTYuNDQ4YzYyLjU5MiAwIDExMy43OTItNTEuMiAxMTMuNzkyLTExMy43OTJWMTEzLjc5MkMxMDI0IDUxLjIgOTcyLjggMCA5MTAuMjA4IDB6bS01MTIgNzk2LjQ0OEwxMTMuNzYgNTEybDc5LjY0OC03OS42NDggMjA0LjggMjA0LjhMODMwLjU2IDIwNC44bDc5LjY0OCA3OS42NDgtNTEyIDUxMnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><h2 data-id="heading-0">1. å‰è¨€</h2>
<p>åœ¨Reactçš„å‡½æ•°å¼ç»„ä»¶å¼€å‘ä¸­ï¼Œ<code>useRef</code>æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„é’©å­ï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†åœ¨ç»„ä»¶æ¸²æŸ“å‘¨æœŸä¹‹é—´æŒä¹…åŒ–å­˜å‚¨å€¼çš„èƒ½åŠ›ï¼ŒåŒæ—¶ä¸ä¼šè§¦å‘ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨<code>useRef</code>çš„å·¥ä½œåŸç†ã€å¸¸è§åº”ç”¨åœºæ™¯ä»¥åŠä½¿ç”¨æ—¶çš„æ³¨æ„äº‹é¡¹ã€‚</p>
<h2 data-id="heading-1">2. åŸºæœ¬æ¦‚å¿µä¸å·¥ä½œåŸç†</h2>
<p><code>useRef</code>æ˜¯Reactæä¾›çš„ä¸€ä¸ªé’©å­å‡½æ•°ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ªå¯å˜çš„refå¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜ï¼Œæ— è®ºç»„ä»¶æ¸²æŸ“å¤šå°‘æ¬¡ï¼Œrefå¯¹è±¡å§‹ç»ˆæŒ‡å‘åŒä¸€ä¸ªå€¼ã€‚å…¶åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> refContainer = <span class="hljs-title function_">useRef</span>(initialValue);
</code></pre>
<p><code>useRef</code>è¿”å›çš„refå¯¹è±¡æœ‰ä¸€ä¸ªç‰¹æ®Šçš„<code>current</code>å±æ€§ï¼Œç”¨äºå­˜å‚¨å’Œè®¿é—®å€¼ã€‚åˆå§‹æ—¶ï¼Œ<code>current</code>å±æ€§è¢«è®¾ç½®ä¸ºä¼ å…¥çš„<code>initialValue</code>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¿®æ”¹<code>current</code>å±æ€§ä¸ä¼šè§¦å‘ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ï¼Œè¿™æ˜¯<code>useRef</code>ä¸çŠ¶æ€ç®¡ç†ï¼ˆå¦‚<code>useState</code>ï¼‰çš„é‡è¦åŒºåˆ«ã€‚</p>
<h2 data-id="heading-2">3. æ ¸å¿ƒåº”ç”¨åœºæ™¯</h2>
<p>ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„ä½¿ç”¨åœºæ™¯ï¼š</p>
<h3 data-id="heading-3">3.1. è®¿é—®DOMå…ƒç´ </h3>
<p><code>useRef</code>æœ€å¸¸è§çš„ç”¨é€”ä¹‹ä¸€æ˜¯è·å–DOMå…ƒç´ çš„å¼•ç”¨ï¼Œä»è€Œå¯ä»¥ç›´æ¥æ“ä½œDOMã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useRef } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">TextInputWithFocusButton</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> inputEl = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">onButtonClick</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-comment">// `current` æŒ‡å‘å·²æŒ‚è½½åˆ°DOMä¸Šçš„æ–‡æœ¬è¾“å…¥å…ƒç´ </span>
    inputEl.<span class="hljs-property">current</span>.<span class="hljs-title function_">focus</span>();
  };
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{inputEl}</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onButtonClick}</span>&gt;</span>èšç„¦è¾“å…¥æ¡†<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>useRef</code>åˆ›å»ºäº†ä¸€ä¸ªrefå¯¹è±¡<code>inputEl</code>ï¼Œå¹¶å°†å…¶ç»‘å®šåˆ°inputå…ƒç´ çš„<code>ref</code>å±æ€§ä¸Šã€‚å½“æŒ‰é’®è¢«ç‚¹å‡»æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>inputEl.current</code>è®¿é—®åˆ°å®é™…çš„DOMå…ƒç´ ï¼Œç„¶åè°ƒç”¨å…¶<code>focus()</code>æ–¹æ³•ã€‚</p>
<h3 data-id="heading-4">3.2. å­˜å‚¨ç»„ä»¶é—´æŒä¹…åŒ–æ•°æ®</h3>
<p><code>useRef</code>è¿˜å¯ä»¥ç”¨äºåœ¨ç»„ä»¶çš„å¤šæ¬¡æ¸²æŸ“ä¹‹é—´å­˜å‚¨æ•°æ®ï¼Œè€Œä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚è¿™å¯¹äºéœ€è¦åœ¨ç»„ä»¶ç”Ÿå‘½å‘¨æœŸå†…ä¿æŒæŸäº›å€¼çš„åœºæ™¯éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useRef, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Timer</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> intervalRef = <span class="hljs-title function_">useRef</span>();
  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    intervalRef.<span class="hljs-property">current</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">prevCount</span> =&gt;</span> prevCount + <span class="hljs-number">1</span>);
    }, <span class="hljs-number">1000</span>);
    
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-built_in">clearInterval</span>(intervalRef.<span class="hljs-property">current</span>);
    };
  }, []);

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>è®¡æ—¶: {count} ç§’<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<p>åœ¨è¿™ä¸ªè®¡æ—¶å™¨ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>useRef</code>å­˜å‚¨äº†setIntervalè¿”å›çš„è®¡æ—¶å™¨IDã€‚è¿™æ ·åœ¨ç»„ä»¶å¸è½½æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>intervalRef.current</code>è®¿é—®åˆ°è¿™ä¸ªIDï¼Œå¹¶æ¸…é™¤è®¡æ—¶å™¨ï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚</p>
<h3 data-id="heading-5">3.3. é¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“</h3>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨ç»„ä»¶å†…éƒ¨å­˜å‚¨ä¸€äº›å€¼ï¼Œä½†åˆä¸å¸Œæœ›è¿™äº›å€¼çš„å˜åŒ–è§¦å‘ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚è¿™æ—¶ï¼Œ<code>useRef</code>æ˜¯ä¸€ä¸ªç†æƒ³çš„é€‰æ‹©ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useRef, useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">DataFetcher</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [data, setData] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> isMounted = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">true</span>);

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">fetchData</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
      <span class="hljs-comment">// åªæœ‰å½“ç»„ä»¶ä»ç„¶æŒ‚è½½æ—¶æ‰æ›´æ–°çŠ¶æ€</span>
      <span class="hljs-keyword">if</span> (isMounted.<span class="hljs-property">current</span>) {
        <span class="hljs-title function_">setData</span>(result);
        <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">false</span>);
      }
    });
    
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// ç»„ä»¶å¸è½½æ—¶æ›´æ–°æ ‡è®°</span>
      isMounted.<span class="hljs-property">current</span> = <span class="hljs-literal">false</span>;
    };
  }, []);

  <span class="hljs-keyword">return</span> loading ? <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span> : <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{data}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<p>åœ¨è¿™ä¸ªæ•°æ®è·å–ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>useRef</code>åˆ›å»ºäº†ä¸€ä¸ª<code>isMounted</code>æ ‡è®°ï¼Œç”¨äºè·Ÿè¸ªç»„ä»¶æ˜¯å¦ä»ç„¶æŒ‚è½½ã€‚åœ¨å¼‚æ­¥æ“ä½œå®Œæˆåï¼Œæˆ‘ä»¬é¦–å…ˆæ£€æŸ¥è¿™ä¸ªæ ‡è®°ï¼Œåªæœ‰åœ¨ç»„ä»¶ä»ç„¶æŒ‚è½½çš„æƒ…å†µä¸‹æ‰æ›´æ–°çŠ¶æ€ï¼Œä»è€Œé¿å…åœ¨ç»„ä»¶å¸è½½åæ›´æ–°çŠ¶æ€å¯¼è‡´çš„è­¦å‘Šã€‚</p>
<h2 data-id="heading-6">4. useRefä¸useStateçš„å¯¹æ¯”</h2>
<p>è™½ç„¶<code>useRef</code>å’Œ<code>useState</code>éƒ½å¯ä»¥ç”¨äºå­˜å‚¨æ•°æ®ï¼Œä½†å®ƒä»¬æœ‰æœ¬è´¨çš„åŒºåˆ«ï¼š</p>
<ul>
<li><strong>è§¦å‘æ¸²æŸ“</strong>ï¼šä¿®æ”¹<code>useState</code>å­˜å‚¨çš„å€¼ä¼šè§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œè€Œä¿®æ”¹<code>useRef</code>çš„<code>current</code>å±æ€§ä¸ä¼šã€‚</li>
<li><strong>æ•°æ®æŒä¹…æ€§</strong>ï¼š<code>useState</code>çš„å€¼åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½æ˜¯å›ºå®šçš„ï¼Œè€Œ<code>useRef</code>çš„<code>current</code>å±æ€§å¯ä»¥éšæ—¶ä¿®æ”¹ã€‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š<code>useState</code>é€‚ç”¨äºéœ€è¦æ ¹æ®æ•°æ®å˜åŒ–æ›´æ–°UIçš„åœºæ™¯ï¼Œè€Œ<code>useRef</code>é€‚ç”¨äºå­˜å‚¨ä¸å½±å“UIçš„æ•°æ®æˆ–è®¿é—®DOMå…ƒç´ ã€‚</li>
</ul>
<h2 data-id="heading-7">5. ä½¿ç”¨useRefçš„æ³¨æ„äº‹é¡¹</h2>
<ol>
<li>
<p><strong>é¿å…åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ä¿®æ”¹currentå±æ€§</strong>ï¼šä¿®æ”¹<code>useRef</code>çš„<code>current</code>å±æ€§ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ï¼Œä½†å¦‚æœåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ä¿®æ”¹å®ƒï¼Œå¯èƒ½ä¼šå¯¼è‡´éš¾ä»¥è°ƒè¯•çš„é—®é¢˜ã€‚</p>
</li>
<li>
<p><strong>æ³¨æ„å†…å­˜æ³„æ¼</strong>ï¼šå½“ä½¿ç”¨<code>useRef</code>å­˜å‚¨DOMå…ƒç´ æˆ–å…¶ä»–èµ„æºæ—¶ï¼Œè¦ç¡®ä¿åœ¨ç»„ä»¶å¸è½½æ—¶æ­£ç¡®æ¸…ç†è¿™äº›èµ„æºï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚</p>
</li>
<li>
<p><strong>ä¸è¦æ»¥ç”¨useRef</strong>ï¼šè™½ç„¶<code>useRef</code>å¾ˆå¼ºå¤§ï¼Œä½†åº”è¯¥è°¨æ…ä½¿ç”¨ã€‚è¿‡åº¦ä½¿ç”¨<code>useRef</code>å¯èƒ½ä¼šå¯¼è‡´ä»£ç å˜å¾—éš¾ä»¥ç†è§£å’Œç»´æŠ¤ï¼Œåº”è¯¥ä¼˜å…ˆä½¿ç”¨çŠ¶æ€ç®¡ç†å’Œæ•°æ®æµæ¨¡å¼ã€‚</p>
</li>
</ol>
<h2 data-id="heading-8">6. æ€»ç»“</h2>
<p><code>useRef</code>æ˜¯Reactä¸­ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„é’©å­ï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†åœ¨ç»„ä»¶æ¸²æŸ“å‘¨æœŸä¹‹é—´æŒä¹…åŒ–å­˜å‚¨å€¼çš„èƒ½åŠ›ï¼ŒåŒæ—¶ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚é€šè¿‡åˆç†ä½¿ç”¨<code>useRef</code>ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ–¹ä¾¿åœ°è®¿é—®DOMå…ƒç´ ã€å­˜å‚¨ç»„ä»¶é—´æŒä¹…åŒ–æ•°æ®ä»¥åŠä¼˜åŒ–æ€§èƒ½ã€‚ä½†åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æ³¨æ„é¿å…å¸¸è§çš„é™·é˜±ï¼Œç¡®ä¿ä»£ç çš„å¥å£®æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<hr/>
<blockquote>
<p>æœ¬æ¬¡åˆ†äº«å°±åˆ°è¿™å„¿å•¦ï¼Œæˆ‘æ˜¯é¹å¤šå¤šï¼Œæ·±è€•å‰ç«¯çš„æŠ€æœ¯åˆ›ä½œè€…ï¼Œå¦‚æœæ‚¨çœ‹äº†è§‰å¾—æœ‰å¸®åŠ©ï¼Œæ¬¢è¿è¯„è®ºï¼Œå…³æ³¨ï¼Œç‚¹èµï¼Œè½¬å‘ï¼Œæˆ‘ä»¬ä¸‹æ¬¡è§~</p>
</blockquote>
<p>PSï¼šåœ¨æœ¬é¡µæŒ‰F12ï¼Œåœ¨consoleä¸­è¾“å…¥document.getElementsByClassName('panel-btn')[0].click();æœ‰æƒŠå–œå“¦~</p>
<p><code>å¾€æœŸæ–‡ç« </code></p>
<ul>
<li><a href="https://juejin.cn/post/7568192652286754870" target="_blank" title="https://juejin.cn/post/7568192652286754870">çº¯å‰ç«¯æå–å›¾ç‰‡é¢œè‰²æ’ä»¶Color-Thiefæ•™å­¦+å®æˆ˜å®Œæ•´æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7565737512816771135" target="_blank" title="https://juejin.cn/post/7565737512816771135">react-konvaå®æˆ˜æŒ‡å—ï¼šCanvasé«˜æ€§èƒ½+æ˜“ç»´æŠ¤çš„ç»„ä»¶åŒ–å›¾å½¢å¼€å‘å®ç°æ•™ç¨‹</a></li>
<li><a href="https://juejin.cn/post/7560905838074462271" target="_blank" title="https://juejin.cn/post/7560905838074462271">Reactæ— é™æ»šåŠ¨æ’ä»¶react-infinite-scroll-componentçš„é…ç½®+ä¼˜åŒ–+é¿å‘æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7560542615484137491" target="_blank" title="https://juejin.cn/post/7560542615484137491">å‰ç«¯éŸ³é¢‘å…¼å®¹è§£å†³ï¼šéŸ³é¢‘ç¥å™¨howler.jsä»åŸºç¡€åˆ°è¿›é˜¶å®Œæ•´ä½¿ç”¨æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7559871680015024169" target="_blank" title="https://juejin.cn/post/7559871680015024169">ä½¿ç”¨React-OAuthè¿›è¡ŒGoogle/GitHubç™»å½•çš„æ•™ç¨‹å’Œæ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7550585427834404927" target="_blank" title="https://juejin.cn/post/7550585427834404927">çº¯å‰ç«¯äººè„¸è¯†åˆ«åˆ©å™¨ï¼šface-api.jsæ‰‹æŠŠæ‰‹æ·±å…¥è§£ææ•™å­¦</a></li>
<li><a href="https://juejin.cn/post/7553865490732433462" target="_blank" title="https://juejin.cn/post/7553865490732433462">å…³äºReactçˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•forwardRefçš„è¯¦è§£å’Œæ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7553484874609410074" target="_blank" title="https://juejin.cn/post/7553484874609410074">Reactè·¨ç»„ä»¶æ•°æ®å…±äº«useContextè¯¦è§£å’Œæ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7545087762837815334" target="_blank" title="https://juejin.cn/post/7545087762837815334">Webå›¾åƒç¼–è¾‘ç¥å™¨tui.image-editorä»åŸºç¡€åˆ°è¿›é˜¶çš„å®æˆ˜æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7544323659788288046" target="_blank" title="https://juejin.cn/post/7544323659788288046">å¼€å‘ä¸ªäººå¾®ä¿¡å°ç¨‹åºç±»ç›®é€‰æ‹©/ç›ˆåˆ©æ–¹å¼/æˆæœ¬æ§åˆ¶ä¸æœåŠ¡å™¨æ¥å…¥æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7541741121400864778" target="_blank" title="https://juejin.cn/post/7541741121400864778">å‰ç«¯å›¾ç‰‡è£å‰ªCropper.jsæ ¸å¿ƒåŠŸèƒ½ä¸å®æˆ˜æŠ€å·§è¯¦è§£</a></li>
<li><a href="https://juejin.cn/post/7536530451461472265" target="_blank" title="https://juejin.cn/post/7536530451461472265">ç¼–è¾‘å™¨ä¹Ÿæœ‰é‚ªä¿®ï¼Ÿç›˜ç‚¹VS Codeé‚ªé—¨/æœ‰è¶£çš„æ‰©å±•</a></li>
<li><a href="https://juejin.cn/post/7535005018257981466" target="_blank" title="https://juejin.cn/post/7535005018257981466">jsä½¿ç”¨IntersectionObserverå®ç°ç›®æ ‡å…ƒç´ å¯è§åº¦çš„äº¤äº’</a></li>
<li><a href="https://juejin.cn/post/7534547200330121225" target="_blank" title="https://juejin.cn/post/7534547200330121225">Webå‰ç«¯é¡µé¢å¼€å‘é˜¿æ‹‰ä¼¯è¯­ç§é€‚é…æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7516122409948020736" target="_blank" title="https://juejin.cn/post/7516122409948020736">è®©ç½‘é¡µæ‹¥æœ‰Appä½“éªŒï¼ŸPWA å°†ç½‘é¡µå˜ä¸ºæ¡Œé¢åº”ç”¨çš„ä¿å§†çº§æ•™ç¨‹PWA</a></li>
<li><a href="https://juejin.cn/post/6953803916484018206" target="_blank" title="https://juejin.cn/post/6953803916484018206">ä½¿ç”¨nvmç®¡ç†node.jsç‰ˆæœ¬ä»¥åŠæ›´æ¢npmæ·˜å®é•œåƒæº</a></li>
<li><a href="https://juejin.cn/post/7140443283209060383" target="_blank" title="https://juejin.cn/post/7140443283209060383">æ‰‹æŠŠæ‰‹æ•™ä½ æ­å»ºè§„èŒƒçš„å›¢é˜Ÿvueé¡¹ç›®ï¼ŒåŒ…å«commitlintï¼Œeslintï¼Œprettierï¼Œhuskyï¼Œcommitizenç­‰ç­‰</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤„ç†è€—æ—¶è¾ƒé•¿çš„ä»»åŠ¡ç¬”è®°]]></title>    <link>https://juejin.cn/post/7573950036896858152</link>    <guid>https://juejin.cn/post/7573950036896858152</guid>    <pubDate>2025-11-19T03:33:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573950036896858152" data-draft-id="7573904312713412643" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤„ç†è€—æ—¶è¾ƒé•¿çš„ä»»åŠ¡ç¬”è®°"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-19T03:33:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å°å°å°å®‡"/> <meta itemprop="url" content="https://juejin.cn/user/3386151546662077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤„ç†è€—æ—¶è¾ƒé•¿çš„ä»»åŠ¡ç¬”è®°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3386151546662077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å°å°å°å®‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T03:33:53.000Z" title="Wed Nov 19 2025 03:33:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œå¤„ç†è€—æ—¶è¾ƒé•¿çš„ä»»åŠ¡ï¼ˆLong Tasksï¼‰æ˜¯æ€§èƒ½ä¼˜åŒ–çš„æ ¸å¿ƒéš¾ç‚¹ã€‚å¦‚æœä¸»çº¿ç¨‹è¢«å ç”¨è¶…è¿‡ 50msï¼Œç”¨æˆ·å°±ä¼šæ„Ÿè§‰åˆ°é¡µé¢å¡é¡¿ï¼ˆæ‰å¸§ï¼‰ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ·±å…¥æ¢è®¨å‡ ç§æ ¸å¿ƒæŠ€æœ¯æ–¹æ¡ˆï¼Œå¹¶ç¼–å†™ä¸€å¥—è¾ƒä¸ºå®Œæ•´çš„ã€æ¥è¿‘ç”Ÿäº§ç¯å¢ƒçš„<strong>ä»»åŠ¡è°ƒåº¦ä¸ä¼˜åŒ–ç³»ç»Ÿ</strong>ã€‚è¿™å°†åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ¨¡å—ï¼š</p>
<ol>
<li><strong>åŸºäºç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰çš„æ—¶é—´åˆ†ç‰‡è°ƒåº¦å™¨</strong>ï¼šå°†åŒæ­¥å¤§ä»»åŠ¡æ‹†è§£ä¸ºå¼‚æ­¥å°ä»»åŠ¡ã€‚</li>
<li><strong>å¤šçº¿ç¨‹å¹¶è¡Œè®¡ç®—æ¡†æ¶ï¼ˆWeb Worker Poolï¼‰</strong>ï¼šåˆ©ç”¨å¤šæ ¸ CPU å¤„ç†çº¯è®¡ç®—ä»»åŠ¡ã€‚</li>
<li><strong>é«˜ä¼˜å…ˆçº§æŠ¢å å¼è°ƒåº¦æ¨¡æ‹Ÿï¼ˆç±»ä¼¼äº React Schedulerï¼‰</strong>ï¼šé€šè¿‡ MessageChannel å®ç°å®ä»»åŠ¡è°ƒåº¦ã€‚</li>
<li><strong>å¤§é‡æ•°æ®æ¸²æŸ“ä¼˜åŒ–ï¼ˆè™šæ‹Ÿåˆ—è¡¨æ ¸å¿ƒå®ç°ï¼‰</strong>ï¼šè§£å†³æ¸²æŸ“å±‚é¢çš„é•¿ä»»åŠ¡ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-0">ç¬¬ä¸€éƒ¨åˆ†ï¼šé€šç”¨æ—¶é—´åˆ†ç‰‡è°ƒåº¦å™¨ (Time Slicing Scheduler)</h3>
<p>è¿™æ˜¯è§£å†³ä¸»çº¿ç¨‹é˜»å¡æœ€ç›´æ¥çš„æ–¹æ³•ã€‚æˆ‘ä»¬å°†åˆ©ç”¨ ES6 çš„ <code>Generator</code> å‡½æ•°ç‰¹æ€§ï¼Œé…åˆ <code>requestAnimationFrame</code> æˆ– <code>MessageChannel</code>ï¼Œå°†ä¸€ä¸ªå·¨å¤§çš„å¾ªç¯æ‹†åˆ†æˆå¤šä¸ªå¯ä»¥åœ¨æ¯ä¸€å¸§ä¹‹é—´æš‚åœæ‰§è¡Œçš„å°å—ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * æ¨¡å—ä¸€ï¼šTimeSlicer.js
 * æè¿°ï¼šä¸€ä¸ªåŸºäºç”Ÿæˆå™¨å‡½æ•°çš„é€šç”¨æ—¶é—´åˆ†ç‰‡æ§åˆ¶å™¨ã€‚
 * å®ƒå¯ä»¥æš‚åœã€æ¢å¤ä»»åŠ¡ï¼Œå¹¶ç¡®ä¿æ¯å¸§æ‰§è¡Œæ—¶é—´ä¸è¶…è¿‡é˜ˆå€¼ï¼ˆå¦‚ 16msï¼‰ã€‚
 */</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">TimeSlicer</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
        <span class="hljs-comment">// é»˜è®¤ä¸€å¸§çš„æ—¶é—´é¢„ç®—ï¼Œç•™ç»™æµè§ˆå™¨æ¸²æŸ“çš„æ—¶é—´</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">frameBudget</span> = options.<span class="hljs-property">frameBudget</span> || <span class="hljs-number">12</span>; <span class="hljs-comment">// 12ms ç»™ JSï¼Œ4ms ç»™æ¸²æŸ“</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">fps</span> = options.<span class="hljs-property">fps</span> || <span class="hljs-number">60</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isRunning</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span> = []; <span class="hljs-comment">// ä»»åŠ¡é˜Ÿåˆ—</span>
        
        <span class="hljs-comment">// ç»‘å®šä¸Šä¸‹æ–‡</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_performWork</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_performWork</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);
    }

    <span class="hljs-comment">/**
     * æ·»åŠ ä¸€ä¸ªéœ€è¦åˆ†ç‰‡æ‰§è¡Œçš„ä»»åŠ¡
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Generator Function</span>} <span class="hljs-variable">generatorFunc</span> - ç”Ÿæˆå™¨å‡½æ•°
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} <span class="hljs-variable">context</span> - æ‰§è¡Œä¸Šä¸‹æ–‡
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">...any</span>} <span class="hljs-variable">args</span> - å‚æ•°
     */</span>
    <span class="hljs-title function_">addTask</span>(<span class="hljs-params">generatorFunc, context = <span class="hljs-literal">null</span>, ...args</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> generatorFunc !== <span class="hljs-string">'function'</span> || generatorFunc.<span class="hljs-property">constructor</span>.<span class="hljs-property">name</span> !== <span class="hljs-string">'GeneratorFunction'</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'TimeSlicer: ä»»åŠ¡å¿…é¡»æ˜¯ä¸€ä¸ª Generator å‡½æ•°'</span>);
        }

        <span class="hljs-keyword">const</span> task = {
            <span class="hljs-attr">iterator</span>: generatorFunc.<span class="hljs-title function_">apply</span>(context, args),
            <span class="hljs-attr">priority</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// é¢„ç•™ä¼˜å…ˆçº§å­—æ®µ</span>
            <span class="hljs-attr">createdTime</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
        };

        <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">push</span>(task);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_schedule</span>();
    }

    <span class="hljs-comment">/**
     * è°ƒåº¦æ ¸å¿ƒ
     * å¦‚æœå½“å‰æ²¡æœ‰è¿è¡Œï¼Œåˆ™å¯åŠ¨è°ƒåº¦
     */</span>
    <span class="hljs-title function_">_schedule</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isRunning</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isRunning</span> = <span class="hljs-literal">true</span>;
            <span class="hljs-comment">// ä¼˜å…ˆä½¿ç”¨ MessageChannel (å®ä»»åŠ¡)ï¼Œå…¶æ¬¡ requestAnimationFrame</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">MessageChannel</span> !== <span class="hljs-string">'undefined'</span>) {
                <span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();
                channel.<span class="hljs-property">port2</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_performWork</span>;
                channel.<span class="hljs-property">port1</span>.<span class="hljs-title function_">postMessage</span>(<span class="hljs-literal">null</span>);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_performWork</span>, <span class="hljs-number">0</span>);
            }
        }
    }

    <span class="hljs-comment">/**
     * æ‰§è¡Œå·¥ä½œå•å…ƒ
     * åœ¨ç»™å®šçš„æ—¶é—´é¢„ç®—å†…å°½å¯èƒ½å¤šåœ°æ‰§è¡Œ generator.next()
     */</span>
    <span class="hljs-title function_">_performWork</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> startTime = performance.<span class="hljs-title function_">now</span>();

        <span class="hljs-comment">// åªè¦é˜Ÿåˆ—é‡Œæœ‰ä»»åŠ¡ï¼Œä¸”å½“å‰å¸§è¿˜æœ‰å‰©ä½™æ—¶é—´ï¼Œå°±ç»§ç»­æ‰§è¡Œ</span>
        <span class="hljs-keyword">while</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> &amp;&amp; (performance.<span class="hljs-title function_">now</span>() - startTime &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">frameBudget</span>)) {
            <span class="hljs-keyword">const</span> currentTask = <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>[<span class="hljs-number">0</span>];
            
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// æ‰§è¡Œä¸€æ­¥</span>
                <span class="hljs-keyword">const</span> result = currentTask.<span class="hljs-property">iterator</span>.<span class="hljs-title function_">next</span>();

                <span class="hljs-comment">// å¦‚æœå½“å‰ä»»åŠ¡å®Œæˆ (done: true)</span>
                <span class="hljs-keyword">if</span> (result.<span class="hljs-property">done</span>) {
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">shift</span>(); <span class="hljs-comment">// ç§»é™¤å·²å®Œæˆä»»åŠ¡</span>
                    <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œè§¦å‘ä»»åŠ¡å®Œæˆçš„å›è°ƒ</span>
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[TimeSlicer] ä»»åŠ¡å®Œæˆï¼Œè€—æ—¶: <span class="hljs-subst">${(<span class="hljs-built_in">Date</span>.now() - currentTask.createdTime)}</span>ms`</span>);
                } 
                <span class="hljs-comment">// å¦‚æœæ²¡å®Œæˆï¼Œå®ƒä¼šä¿ç•™åœ¨é˜Ÿåˆ—å¤´éƒ¨ï¼Œä¸‹ä¸€æ¬¡å¾ªç¯ç»§ç»­æ‰§è¡Œ</span>
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[TimeSlicer] ä»»åŠ¡æ‰§è¡Œå‡ºé”™:'</span>, error);
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">shift</span>(); <span class="hljs-comment">// å‡ºé”™ç§»é™¤ä»»åŠ¡ï¼Œé˜²æ­¢æ­»å¾ªç¯</span>
            }
        }

        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦è¿˜æœ‰å‰©ä½™ä»»åŠ¡</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-comment">// è®©å‡ºä¸»çº¿ç¨‹ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è°ƒåº¦</span>
            <span class="hljs-comment">// ä½¿ç”¨ requestAnimationFrame é…åˆ MessageChannel è¾¾åˆ°æœ€ä½³æ•ˆæœ</span>
            <span class="hljs-comment">// è¿™é‡Œç®€åŒ–é€»è¾‘ï¼Œç›´æ¥é‡æ–°è°ƒåº¦</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">MessageChannel</span> !== <span class="hljs-string">'undefined'</span>) {
                <span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();
                channel.<span class="hljs-property">port2</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_performWork</span>;
                channel.<span class="hljs-property">port1</span>.<span class="hljs-title function_">postMessage</span>(<span class="hljs-literal">null</span>);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_performWork</span>, <span class="hljs-number">0</span>);
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isRunning</span> = <span class="hljs-literal">false</span>;
        }
    }
}

<span class="hljs-comment">// ==========================================</span>
<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹ä»£ç ï¼šå¤„ç† 10ä¸‡æ¡æ•°æ®çš„å¤æ‚è®¡ç®—</span>
<span class="hljs-comment">// ==========================================</span>

<span class="hljs-keyword">const</span> slicer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimeSlicer</span>();

<span class="hljs-comment">/**
 * æ¨¡æ‹Ÿä¸€ä¸ªè€—æ—¶çš„å¤§å‹è®¡ç®—ä»»åŠ¡
 * å‡è®¾æˆ‘ä»¬éœ€è¦å¤„ç†ä¸€ä¸ªå·¨å¤§çš„æ•°ç»„ï¼Œæ¯é¡¹éƒ½è¦è¿›è¡Œæ•°å­¦è¿ç®—
 */</span>
<span class="hljs-keyword">function</span>* <span class="hljs-title function_">heavyCalculationTask</span>(<span class="hljs-params">dataSize</span>) {
    <span class="hljs-keyword">const</span> results = [];
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[Task] å¼€å§‹å¤„ç† <span class="hljs-subst">${dataSize}</span> æ¡æ•°æ®...`</span>);

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; dataSize; i++) {
        <span class="hljs-comment">// æ¨¡æ‹Ÿå¤æ‚è®¡ç®—: ä¸‰è§’å‡½æ•°ã€å¼€æ–¹ç­‰</span>
        <span class="hljs-keyword">let</span> temp = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(i) * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">tan</span>(i) + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>();
        <span class="hljs-comment">// æ¨¡æ‹Ÿ DOM æ“ä½œï¼ˆå¦‚æœéœ€è¦ï¼Œè™½ç„¶ä¸å»ºè®®åœ¨é€»è¾‘ä¸­æ··æ‚ DOMï¼‰</span>
        <span class="hljs-comment">// ä»…ä»…æ˜¯çº¯è®¡ç®—</span>
        results.<span class="hljs-title function_">push</span>(temp);

        <span class="hljs-comment">// å…³é”®ç‚¹ï¼šæ¯å¤„ç† 1000 æ¡æ•°æ®ï¼Œæˆ–è€…æ¯ä¸€æ­¥ yield ä¸€æ¬¡</span>
        <span class="hljs-comment">// ç²’åº¦è¶Šç»†ï¼Œå“åº”è¶Šå¥½ï¼Œä½†æ€»è€—æ—¶ä¼šå¾®å¢</span>
        <span class="hljs-keyword">if</span> (i % <span class="hljs-number">500</span> === <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">yield</span>; <span class="hljs-comment">// æš‚åœï¼Œäº¤è¿˜æ§åˆ¶æƒç»™è°ƒåº¦å™¨</span>
        }
    }

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[Task] æ‰€æœ‰æ•°æ®å¤„ç†å®Œæ¯•ï¼Œç»“æœé•¿åº¦: <span class="hljs-subst">${results.length}</span>`</span>);
    <span class="hljs-keyword">return</span> results;
}

<span class="hljs-comment">// å¯åŠ¨ä»»åŠ¡ï¼šå¤„ç† 100,000 æ¡æ•°æ®</span>
<span class="hljs-comment">// å¦‚æœä¸ä½¿ç”¨ TimeSlicerï¼Œè¿™è¡Œä»£ç ä¼šç›´æ¥å¡æ­»æµè§ˆå™¨ 2-3ç§’</span>
slicer.<span class="hljs-title function_">addTask</span>(heavyCalculationTask, <span class="hljs-literal">null</span>, <span class="hljs-number">100000</span>);

<span class="hljs-comment">// å¯ä»¥åŒæ—¶æ·»åŠ å¦ä¸€ä¸ªä»»åŠ¡ï¼Œå®ƒä»¬ä¼šäº¤æ›¿æ‰§è¡Œ</span>
slicer.<span class="hljs-title function_">addTask</span>(<span class="hljs-keyword">function</span>* () {
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">50</span>; i++) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[Task 2] ç©¿æ’æ‰§è¡Œä¸­... <span class="hljs-subst">${i}</span>`</span>);
        <span class="hljs-keyword">yield</span>;
    }
});
</code></pre>
<hr/>
<h3 data-id="heading-1">ç¬¬äºŒéƒ¨åˆ†ï¼šWeb Worker çº¿ç¨‹æ±  (Thread Pool)</h3>
<p>æ—¶é—´åˆ†ç‰‡è™½ç„¶è§£å†³äº†å¡é¡¿ï¼Œä½†ä»»åŠ¡ä»ç„¶åœ¨ä¸»çº¿ç¨‹è¿è¡Œï¼Œæ€»è€—æ—¶å¹¶æ²¡æœ‰å‡å°‘ï¼ˆç”šè‡³å› ä¸ºè°ƒåº¦å¼€é”€å˜é•¿äº†ï¼‰ã€‚å¯¹äºçº¯è®¡ç®—ä»»åŠ¡ï¼ˆå¦‚å›¾åƒå¤„ç†ã€å¤§æ–‡ä»¶è§£æã€åŠ å¯†è§£å¯†ï¼‰ï¼Œæœ€å¥½çš„æ–¹æ¡ˆæ˜¯ç§»å‡ºä¸»çº¿ç¨‹ã€‚</p>
<p>ä¸ºäº†é¿å…é¢‘ç¹åˆ›å»º Worker å¸¦æ¥çš„å¼€é”€ï¼Œæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ª <strong>Worker çº¿ç¨‹æ± </strong>ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * æ¨¡å—äºŒï¼šWorkerPool.js
 * æè¿°ï¼šç®¡ç†ä¸€ç»„ Web Workerï¼Œå®ç°è´Ÿè½½å‡è¡¡å’Œä»»åŠ¡å¤ç”¨ã€‚
 */</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">WorkerPool</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">workerScript, poolSize = <span class="hljs-number">4</span></span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">workerScript</span> = workerScript;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">poolSize</span> = poolSize || navigator.<span class="hljs-property">hardwareConcurrency</span> || <span class="hljs-number">4</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span> = []; <span class="hljs-comment">// å­˜å‚¨ { worker, isBusy, id }</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span> = []; <span class="hljs-comment">// ç­‰å¾…å¤„ç†çš„ä»»åŠ¡é˜Ÿåˆ—</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskMap</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(); <span class="hljs-comment">// å­˜å‚¨ taskId -&gt; { resolve, reject }</span>
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_initPool</span>();
    }

    <span class="hljs-title function_">_initPool</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">poolSize</span>; i++) {
            <span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">workerScript</span>);
            
            worker.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_handleWorkerMessage</span>(e, i);
            worker.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_handleWorkerError</span>(e, i);
            
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-title function_">push</span>({
                <span class="hljs-attr">id</span>: i,
                <span class="hljs-attr">worker</span>: worker,
                <span class="hljs-attr">isBusy</span>: <span class="hljs-literal">false</span>
            });
        }
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[WorkerPool] åˆå§‹åŒ–å®Œæˆï¼ŒåŒ…å« <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.poolSize}</span> ä¸ªçº¿ç¨‹`</span>);
    }

    <span class="hljs-comment">/**
     * æäº¤ä»»åŠ¡åˆ°çº¿ç¨‹æ± 
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">type</span> - ä»»åŠ¡ç±»å‹
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">any</span>} <span class="hljs-variable">data</span> - æ•°æ®
     * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise</span>}
     */</span>
    <span class="hljs-title function_">run</span>(<span class="hljs-params">type, data</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
            <span class="hljs-keyword">const</span> taskId = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_generateUUID</span>();
            <span class="hljs-keyword">const</span> task = {
                taskId,
                type,
                data,
                resolve,
                reject
            };

            <span class="hljs-comment">// å°è¯•å¯»æ‰¾ç©ºé—² Worker</span>
            <span class="hljs-keyword">const</span> idleWorkerIndex = <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> !w.<span class="hljs-property">isBusy</span>);

            <span class="hljs-keyword">if</span> (idleWorkerIndex !== -<span class="hljs-number">1</span>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_dispatchTask</span>(idleWorkerIndex, task);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// æ‰€æœ‰ Worker éƒ½åœ¨å¿™ï¼ŒåŠ å…¥é˜Ÿåˆ—</span>
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">push</span>(task);
            }
        });
    }

    <span class="hljs-title function_">_dispatchTask</span>(<span class="hljs-params">workerIndex, task</span>) {
        <span class="hljs-keyword">const</span> workerObj = <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>[workerIndex];
        workerObj.<span class="hljs-property">isBusy</span> = <span class="hljs-literal">true</span>;

        <span class="hljs-comment">// è®°å½•ä»»åŠ¡å›è°ƒï¼Œä»¥ä¾¿æ”¶åˆ°æ¶ˆæ¯æ—¶è§¦å‘</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskMap</span>.<span class="hljs-title function_">set</span>(task.<span class="hljs-property">taskId</span>, {
            <span class="hljs-attr">resolve</span>: task.<span class="hljs-property">resolve</span>,
            <span class="hljs-attr">reject</span>: task.<span class="hljs-property">reject</span>
        });

        <span class="hljs-comment">// å‘é€ç»™ Worker</span>
        workerObj.<span class="hljs-property">worker</span>.<span class="hljs-title function_">postMessage</span>({
            <span class="hljs-attr">taskId</span>: task.<span class="hljs-property">taskId</span>,
            <span class="hljs-attr">type</span>: task.<span class="hljs-property">type</span>,
            <span class="hljs-attr">data</span>: task.<span class="hljs-property">data</span>
        });
    }

    <span class="hljs-title function_">_handleWorkerMessage</span>(<span class="hljs-params">e, workerIndex</span>) {
        <span class="hljs-keyword">const</span> { taskId, result, error } = e.<span class="hljs-property">data</span>;
        <span class="hljs-keyword">const</span> workerObj = <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>[workerIndex];
        
        <span class="hljs-comment">// æ ‡è®°ä¸ºç©ºé—²</span>
        workerObj.<span class="hljs-property">isBusy</span> = <span class="hljs-literal">false</span>;

        <span class="hljs-comment">// æ‰¾åˆ°å¯¹åº”çš„ Promise</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">taskMap</span>.<span class="hljs-title function_">has</span>(taskId)) {
            <span class="hljs-keyword">const</span> { resolve, reject } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskMap</span>.<span class="hljs-title function_">get</span>(taskId);
            <span class="hljs-keyword">if</span> (error) {
                <span class="hljs-title function_">reject</span>(error);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-title function_">resolve</span>(result);
            }
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskMap</span>.<span class="hljs-title function_">delete</span>(taskId);
        }

        <span class="hljs-comment">// æ£€æŸ¥é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰ç­‰å¾…çš„ä»»åŠ¡</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">const</span> nextTask = <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">shift</span>();
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_dispatchTask</span>(workerIndex, nextTask);
        }
    }

    <span class="hljs-title function_">_handleWorkerError</span>(<span class="hljs-params">e, workerIndex</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[WorkerPool] Worker <span class="hljs-subst">${workerIndex}</span> å‘ç”Ÿåº•å±‚é”™è¯¯`</span>, e);
        <span class="hljs-comment">// å®é™…ç”Ÿäº§ä¸­å¯èƒ½éœ€è¦é‡å¯è¯¥ Worker</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>[workerIndex].<span class="hljs-property">isBusy</span> = <span class="hljs-literal">false</span>;
    }

    <span class="hljs-title function_">_generateUUID</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[xy]/g</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>) {
            <span class="hljs-keyword">var</span> r = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">16</span> | <span class="hljs-number">0</span>, v = c == <span class="hljs-string">'x'</span> ? r : (r &amp; <span class="hljs-number">0x3</span> | <span class="hljs-number">0x8</span>);
            <span class="hljs-keyword">return</span> v.<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>);
        });
    }
    
    <span class="hljs-title function_">terminate</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> w.<span class="hljs-property">worker</span>.<span class="hljs-title function_">terminate</span>());
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span> = [];
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span> = [];
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskMap</span>.<span class="hljs-title function_">clear</span>();
    }
}

<span class="hljs-comment">/* 
   --------------------------------------------------
   é…å¥—çš„ Worker è„šæœ¬å†…å®¹ (worker-script.js) 
   (åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿™é€šå¸¸æ˜¯ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ï¼Œæˆ–è€…é€šè¿‡ Blob URL ç”Ÿæˆ)
   --------------------------------------------------
*/</span>

<span class="hljs-comment">/*
// worker-script.js ä¼ªä»£ç å®ç°
self.onmessage = function(e) {
    const { taskId, type, data } = e.data;

    try {
        let result;
        switch (type) {
            case 'SORT_LARGE_ARRAY':
                // æ¨¡æ‹Ÿè€—æ—¶æ’åº
                result = data.sort((a, b) =&gt; a - b);
                break;
            case 'IMAGE_FILTER':
                // æ¨¡æ‹Ÿå›¾åƒåƒç´ å¤„ç†
                result = applyFilter(data); 
                break;
            default:
                throw new Error('Unknown task type');
        }

        self.postMessage({ taskId, result });
    } catch (err) {
        self.postMessage({ taskId, error: err.message });
    }
};

function applyFilter(pixels) {
    // æ¨¡æ‹Ÿ O(n) éå†
    let sum = 0;
    for(let i=0; i&lt;10000000; i++) { sum += i }
    return pixels;
}
*/</span>

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-comment">// const pool = new WorkerPool('worker-script.js');</span>
<span class="hljs-comment">// pool.run('SORT_LARGE_ARRAY', [5, 1, 9, ...]).then(res =&gt; console.log(res));</span>
</code></pre>
<hr/>
<h3 data-id="heading-2">ç¬¬ä¸‰éƒ¨åˆ†ï¼šä»»åŠ¡ä¼˜å…ˆçº§ä¸ç©ºé—²è°ƒåº¦ (Idle &amp; Priority Scheduler)</h3>
<p>é™¤äº†æ—¶é—´åˆ†ç‰‡ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨ <code>requestIdleCallback</code> åœ¨æµè§ˆå™¨ç©ºé—²æ—¶æ‰§è¡Œä½ä¼˜å…ˆçº§ä»»åŠ¡ï¼ˆå¦‚åŸ‹ç‚¹ä¸ŠæŠ¥ã€é¢„åŠ è½½æ•°æ®ï¼‰ã€‚ä¸ºäº†å…¼å®¹æ€§å’Œæ›´å¥½çš„æ§åˆ¶ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªå¸¦ä¼˜å…ˆçº§çš„ä»»åŠ¡é˜Ÿåˆ—ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * æ¨¡å—ä¸‰ï¼šPriorityScheduler.js
 * æè¿°ï¼šæ¨¡æ‹Ÿ React Schedulerï¼Œæ”¯æŒä¼˜å…ˆçº§ï¼ˆUserBlocking, Normal, Low, Idleï¼‰ã€‚
 */</span>

<span class="hljs-keyword">const</span> <span class="hljs-title class_">Priority</span> = {
    <span class="hljs-title class_">Immediate</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// ç‚¹å‡»äº‹ä»¶ç­‰ï¼Œå¿…é¡»ç«‹å³æ‰§è¡Œ</span>
    <span class="hljs-title class_">UserBlocking</span>: <span class="hljs-number">2</span>, <span class="hljs-comment">// æ»šåŠ¨ã€è¾“å…¥ï¼Œéœ€è¦åœ¨çŸ­æ—¶é—´å†…å®Œæˆ</span>
    <span class="hljs-title class_">Normal</span>: <span class="hljs-number">3</span>, <span class="hljs-comment">// æ™®é€šæ•°æ®è¯·æ±‚</span>
    <span class="hljs-title class_">Low</span>: <span class="hljs-number">4</span>, <span class="hljs-comment">// åŠ¨ç”»åç»­å¤„ç†</span>
    <span class="hljs-title class_">Idle</span>: <span class="hljs-number">5</span> <span class="hljs-comment">// åŸ‹ç‚¹ã€é¢„åŠ è½½</span>
};

<span class="hljs-keyword">class</span> <span class="hljs-title class_">PriorityScheduler</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span> = [];
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isMessageLoopRunning</span> = <span class="hljs-literal">false</span>;
        
        <span class="hljs-comment">// ä½¿ç”¨ MessageChannel è¿›è¡Œä»»åŠ¡å¾ªç¯ tick</span>
        <span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">port</span> = channel.<span class="hljs-property">port2</span>;
        channel.<span class="hljs-property">port1</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_performWorkUntilDeadline</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);
    }

    <span class="hljs-comment">/**
     * è°ƒåº¦ä»»åŠ¡
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} callback 
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} priorityLevel 
     */</span>
    <span class="hljs-title function_">scheduleCallback</span>(<span class="hljs-params">priorityLevel, callback</span>) {
        <span class="hljs-keyword">const</span> startTime = performance.<span class="hljs-title function_">now</span>();
        <span class="hljs-keyword">let</span> timeout;

        <span class="hljs-comment">// æ ¹æ®ä¼˜å…ˆçº§è®¾ç½®è¿‡æœŸæ—¶é—´</span>
        <span class="hljs-keyword">switch</span> (priorityLevel) {
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Priority</span>.<span class="hljs-property">Immediate</span>: timeout = -<span class="hljs-number">1</span>; <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Priority</span>.<span class="hljs-property">UserBlocking</span>: timeout = <span class="hljs-number">250</span>; <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Priority</span>.<span class="hljs-property">Normal</span>: timeout = <span class="hljs-number">5000</span>; <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Priority</span>.<span class="hljs-property">Low</span>: timeout = <span class="hljs-number">10000</span>; <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-title class_">Priority</span>.<span class="hljs-property">Idle</span>: timeout = <span class="hljs-number">1073741823</span>; <span class="hljs-keyword">break</span>; <span class="hljs-comment">// Max Int 32 bit approx</span>
            <span class="hljs-attr">default</span>: timeout = <span class="hljs-number">5000</span>;
        }

        <span class="hljs-keyword">const</span> expirationTime = startTime + timeout;

        <span class="hljs-keyword">const</span> newTask = {
            callback,
            priorityLevel,
            startTime,
            expirationTime,
            <span class="hljs-attr">sortIndex</span>: -<span class="hljs-number">1</span> <span class="hljs-comment">// ç”¨äºæœ€å°å †æ’åºï¼Œè¿™é‡Œç®€åŒ–ä¸ºæ•°ç»„æ’åº</span>
        };

        <span class="hljs-comment">// æ’å…¥é˜Ÿåˆ—å¹¶æŒ‰è¿‡æœŸæ—¶é—´æ’åºï¼ˆæ¨¡æ‹Ÿæœ€å°å †ï¼‰</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span>.<span class="hljs-title function_">push</span>(newTask);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span>.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">expirationTime</span> - b.<span class="hljs-property">expirationTime</span>);

        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isMessageLoopRunning</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isMessageLoopRunning</span> = <span class="hljs-literal">true</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">port</span>.<span class="hljs-title function_">postMessage</span>(<span class="hljs-literal">null</span>);
        }
    }

    <span class="hljs-title function_">_performWorkUntilDeadline</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> currentTime = performance.<span class="hljs-title function_">now</span>();
        <span class="hljs-keyword">const</span> deadline = currentTime + <span class="hljs-number">5</span>; <span class="hljs-comment">// æ¯æ¬¡ç»™ 5ms çš„æ—¶é—´ç‰‡</span>

        <span class="hljs-keyword">let</span> currentTask = <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span>[<span class="hljs-number">0</span>];

        <span class="hljs-keyword">while</span> (currentTask) {
            <span class="hljs-comment">// å¦‚æœä»»åŠ¡è¿˜æ²¡è¿‡æœŸï¼Œä½†å½“å‰å¸§æ—¶é—´ç‰‡ç”¨å®Œäº†ï¼Œæš‚åœï¼Œè®©ç»™æµè§ˆå™¨æ¸²æŸ“</span>
            <span class="hljs-keyword">if</span> (currentTask.<span class="hljs-property">expirationTime</span> &gt; currentTime &amp;&amp; performance.<span class="hljs-title function_">now</span>() &gt;= deadline) {
                <span class="hljs-keyword">break</span>;
            }

            <span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡</span>
            <span class="hljs-keyword">const</span> callback = currentTask.<span class="hljs-property">callback</span>;
            <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œä¼ å…¥ didTimeout å‚æ•°å‘ŠçŸ¥ä»»åŠ¡æ˜¯å¦è¶…æ—¶</span>
            <span class="hljs-keyword">const</span> didTimeout = currentTask.<span class="hljs-property">expirationTime</span> &lt;= currentTime;
            
            <span class="hljs-comment">// ä»é˜Ÿåˆ—ç§»é™¤</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span>.<span class="hljs-title function_">shift</span>();

            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// æ‰§è¡Œå›è°ƒ</span>
                <span class="hljs-keyword">const</span> continuationCallback = <span class="hljs-title function_">callback</span>(didTimeout);
                
                <span class="hljs-comment">// å¦‚æœä»»åŠ¡è¿”å›äº†ä¸€ä¸ªå‡½æ•°ï¼Œè¯´æ˜å®ƒè¿˜æ²¡åšå®Œï¼ˆæ”¯æŒä»»åŠ¡ä¸­æ–­ä¸æ¢å¤ï¼‰</span>
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> continuationCallback === <span class="hljs-string">'function'</span>) {
                    <span class="hljs-comment">// é‡æ–°åŠ å…¥é˜Ÿåˆ—ï¼Œä¿æŒåŸæœ‰çš„è¿‡æœŸæ—¶é—´</span>
                    currentTask.<span class="hljs-property">callback</span> = continuationCallback;
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span>.<span class="hljs-title function_">push</span>(currentTask);
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span>.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">expirationTime</span> - b.<span class="hljs-property">expirationTime</span>);
                }
            } <span class="hljs-keyword">catch</span> (e) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Task error:'</span>, e);
            }

            currentTask = <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span>[<span class="hljs-number">0</span>];
        }

        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-comment">// è¿˜æœ‰ä»»åŠ¡ï¼Œç»§ç»­è¯·æ±‚ä¸‹ä¸€ä¸ª tick</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">port</span>.<span class="hljs-title function_">postMessage</span>(<span class="hljs-literal">null</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isMessageLoopRunning</span> = <span class="hljs-literal">false</span>;
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> scheduler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityScheduler</span>();

<span class="hljs-comment">// ä½ä¼˜å…ˆçº§ä»»åŠ¡ï¼šå‘é€ç»Ÿè®¡æ•°æ®</span>
scheduler.<span class="hljs-title function_">scheduleCallback</span>(<span class="hljs-title class_">Priority</span>.<span class="hljs-property">Idle</span>, <span class="hljs-function">(<span class="hljs-params">didTimeout</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Idle task executing, didTimeout:'</span>, didTimeout);
    <span class="hljs-comment">// æ¨¡æ‹Ÿé‡è´Ÿè½½</span>
    <span class="hljs-keyword">const</span> start = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">while</span>(<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - start &lt; <span class="hljs-number">10</span>) {} 
});

<span class="hljs-comment">// é«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼šå“åº”ç”¨æˆ·ç‚¹å‡»</span>
scheduler.<span class="hljs-title function_">scheduleCallback</span>(<span class="hljs-title class_">Priority</span>.<span class="hljs-property">Immediate</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Immediate task executing!'</span>);
});
</code></pre>
<hr/>
<h3 data-id="heading-3">ç¬¬å››éƒ¨åˆ†ï¼šè™šæ‹Ÿåˆ—è¡¨ (Virtual List) - è§£å†³æ¸²æŸ“é•¿ä»»åŠ¡</h3>
<p>å½“æ•°æ®é‡è¾¾åˆ°å‡ ä¸‡æ¡æ—¶ï¼Œæœ€å¤§çš„â€œé•¿ä»»åŠ¡â€é€šå¸¸ä¸æ˜¯ JS è®¡ç®—ï¼Œè€Œæ˜¯ DOM çš„ Layout å’Œ Paintã€‚è™šæ‹Ÿåˆ—è¡¨æŠ€æœ¯åªæ¸²æŸ“å¯è§†åŒºåŸŸå†…çš„å…ƒç´ ï¼Œæå¤§å‡å°‘ DOM èŠ‚ç‚¹æ•°é‡ã€‚</p>
<p>ä¸ºäº†ä¿è¯ä»£ç é‡å’Œç»†èŠ‚ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨ React/Vueï¼Œè€Œæ˜¯ç”¨åŸç”Ÿ JS å®ç°ä¸€ä¸ªé«˜æ•ˆçš„è™šæ‹Ÿæ»šåŠ¨ç±»ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * æ¨¡å—å››ï¼šVirtualScroller.js
 * æè¿°ï¼šåŸç”Ÿé«˜æ€§èƒ½è™šæ‹Ÿæ»šåŠ¨å®ç°ã€‚
 * æ”¯æŒåŠ¨æ€é«˜åº¦ä¼°ç®—ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼ŒDOM å¤ç”¨ï¼Œå’Œæ»šåŠ¨èŠ‚æµã€‚
 */</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">VirtualScroller</span> {
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">HTMLElement</span>} <span class="hljs-variable">container</span> - æ»šåŠ¨å®¹å™¨
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} <span class="hljs-variable">items</span> - æ•°æ®æº
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} <span class="hljs-variable">rowRenderer</span> - è¡Œæ¸²æŸ“å‡½æ•° (index, data) =&gt; HTMLElement
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">itemHeight</span> - å›ºå®šè¡Œé«˜
     */</span>
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">container, items, rowRenderer, itemHeight = <span class="hljs-number">50</span></span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span> = container;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = items;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">rowRenderer</span> = rowRenderer;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeight</span> = itemHeight;
        
        <span class="hljs-comment">// å†…éƒ¨çŠ¶æ€</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibleCount</span> = <span class="hljs-number">0</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">startIndex</span> = <span class="hljs-number">0</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">endIndex</span> = <span class="hljs-number">0</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">scrollTop</span> = <span class="hljs-number">0</span>;
        
        <span class="hljs-comment">// ç¼“å†²åŒºåŸŸï¼ˆä¸Šä¸‹å¤šæ¸²æŸ“å‡ ä¸ªï¼Œé˜²æ­¢ç™½å±ï¼‰</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">buffer</span> = <span class="hljs-number">5</span>; 

        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_initDOM</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_bindEvents</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_update</span>();
    }

    <span class="hljs-title function_">_initDOM</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-property">style</span>.<span class="hljs-property">overflowY</span> = <span class="hljs-string">'auto'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">'relative'</span>;

        <span class="hljs-comment">// åˆ›å»ºå ä½é«˜åº¦å±‚ (Phantom)</span>
        <span class="hljs-comment">// å®ƒçš„é«˜åº¦ç­‰äº æ€»æ•°æ®é‡ * è¡Œé«˜ï¼Œç”¨äºæ’‘å¼€æ»šåŠ¨æ¡</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">phantomContent</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">phantomContent</span>.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">'absolute'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">phantomContent</span>.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">'0'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">phantomContent</span>.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">'0'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">phantomContent</span>.<span class="hljs-property">style</span>.<span class="hljs-property">right</span> = <span class="hljs-string">'0'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">phantomContent</span>.<span class="hljs-property">style</span>.<span class="hljs-property">zIndex</span> = <span class="hljs-string">'-1'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">phantomContent</span>.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.items.length * <span class="hljs-variable language_">this</span>.itemHeight}</span>px`</span>;
        
        <span class="hljs-comment">// åˆ›å»ºå®é™…å†…å®¹å±‚ (Real Content)</span>
        <span class="hljs-comment">// è¿™é‡Œçš„å…ƒç´ ä¼šç»å¯¹å®šä½ï¼Œæˆ–è€…é€šè¿‡ transform åç§»</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">'absolute'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">'0'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-property">style</span>.<span class="hljs-property">right</span> = <span class="hljs-string">'0'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">'0'</span>;
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">phantomContent</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>);
    }

    <span class="hljs-title function_">_bindEvents</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// ç®€å•çš„èŠ‚æµå¤„ç†</span>
        <span class="hljs-keyword">let</span> ticking = <span class="hljs-literal">false</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'scroll'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
            <span class="hljs-keyword">if</span> (!ticking) {
                <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">scrollTop</span> = e.<span class="hljs-property">target</span>.<span class="hljs-property">scrollTop</span>;
                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_update</span>();
                    ticking = <span class="hljs-literal">false</span>;
                });
                ticking = <span class="hljs-literal">true</span>;
            }
        });
    }

    <span class="hljs-title function_">_update</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// 1. è®¡ç®—å¯è§†åŒºåŸŸèƒ½æ”¾ä¸‹å¤šå°‘ä¸ªå…ƒç´ </span>
        <span class="hljs-keyword">const</span> containerHeight = <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-property">clientHeight</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibleCount</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(containerHeight / <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeight</span>);

        <span class="hljs-comment">// 2. è®¡ç®—èµ·å§‹ç´¢å¼•</span>
        <span class="hljs-comment">// å‘ä¸‹å–æ•´ï¼Œç¡®ä¿æ»šåŠ¨å¹³æ»‘</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">startIndex</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">scrollTop</span> / <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeight</span>);
        
        <span class="hljs-comment">// 3. è€ƒè™‘ç¼“å†²åŒº</span>
        <span class="hljs-keyword">const</span> renderStart = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">startIndex</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">buffer</span>);
        
        <span class="hljs-comment">// 4. è®¡ç®—ç»“æŸç´¢å¼•</span>
        <span class="hljs-keyword">const</span> renderEnd = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-property">length</span>, 
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">startIndex</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibleCount</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">buffer</span>
        );

        <span class="hljs-comment">// 5. æ¸²æŸ“è¿™ä¸€æ®µæ•°æ®</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_renderRows</span>(renderStart, renderEnd);
        
        <span class="hljs-comment">// 6. åç§» content å±‚ï¼Œè®©å®ƒå¤„äºæ­£ç¡®çš„ä½ç½®</span>
        <span class="hljs-comment">// å› ä¸ºæˆ‘ä»¬åªæ¸²æŸ“äº†ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥éœ€è¦æŠŠè¿™éƒ¨åˆ†å†…å®¹ç§»åŠ¨åˆ°è§†è§‰ä¸Šçš„ä½ç½®</span>
        <span class="hljs-comment">// è¿™é‡Œçš„åç§»é‡åº”è¯¥æ˜¯ renderStart * itemHeight</span>
        <span class="hljs-keyword">const</span> offset = renderStart * <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeight</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateY(<span class="hljs-subst">${offset}</span>px)`</span>;
    }

    <span class="hljs-title function_">_renderRows</span>(<span class="hljs-params">start, end</span>) {
        <span class="hljs-comment">// ç®€å•çš„ Diff ç®—æ³•ï¼šå…¨æ¸…ç©ºå†æ·»åŠ  (ç”Ÿäº§ç¯å¢ƒåº”å¤ç”¨ DOM)</span>
        <span class="hljs-comment">// ä¸ºäº†æ¼”ç¤ºä»£ç é‡å’Œé€»è¾‘ï¼Œè¿™é‡Œåšä¸€ä¸ªç®€å•çš„ DOM å¤ç”¨æ± é€»è¾‘</span>
        
        <span class="hljs-keyword">const</span> fragment = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createDocumentFragment</span>();
        
        <span class="hljs-comment">// æ¸…ç©ºå½“å‰æ¸²æŸ“å±‚</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">''</span>;

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = start; i &lt; end; i++) {
            <span class="hljs-keyword">const</span> itemData = <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[i];
            <span class="hljs-keyword">const</span> node = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">rowRenderer</span>(i, itemData);
            
            <span class="hljs-comment">// è®¾ç½®å¿…è¦çš„æ ·å¼ç¡®ä¿é«˜åº¦æ­£ç¡®</span>
            node.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.itemHeight}</span>px`</span>;
            node.<span class="hljs-property">style</span>.<span class="hljs-property">boxSizing</span> = <span class="hljs-string">'border-box'</span>; <span class="hljs-comment">// é¿å… padding å½±å“é«˜åº¦</span>
            
            fragment.<span class="hljs-title function_">appendChild</span>(node);
        }

        <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-title function_">appendChild</span>(fragment);
    }

    <span class="hljs-comment">/**
     * åŠ¨æ€æ›´æ–°æ•°æ®
     */</span>
    <span class="hljs-title function_">updateData</span>(<span class="hljs-params">newItems</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = newItems;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">phantomContent</span>.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.items.length * <span class="hljs-variable language_">this</span>.itemHeight}</span>px`</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_update</span>();
    }
}

<span class="hljs-comment">// ====================================</span>
<span class="hljs-comment">// VirtualScroller ä½¿ç”¨æµ‹è¯•</span>
<span class="hljs-comment">// ====================================</span>
<span class="hljs-comment">/*
// HTML ç»“æ„: &lt;div id="scroll-container" style="height: 500px; width: 300px;"&gt;&lt;/div&gt;

const data = Array.from({ length: 100000 }, (_, i) =&gt; ({ id: i, text: `Row Item ${i}` }));
const container = document.getElementById('scroll-container');

const scroller = new VirtualScroller(container, data, (index, item) =&gt; {
    const div = document.createElement('div');
    div.textContent = `${item.id} - ${item.text}`;
    div.style.borderBottom = '1px solid #ccc';
    div.style.display = 'flex';
    div.style.alignItems = 'center';
    div.style.paddingLeft = '10px';
    
    // æ·»åŠ ä¸€äº›å¤æ‚çš„ DOM ç»“æ„æ¥æ¨¡æ‹Ÿæ¸²æŸ“å‹åŠ›
    // å¦‚æœæ²¡æœ‰è™šæ‹Ÿåˆ—è¡¨ï¼Œ10ä¸‡ä¸ªè¿™æ ·çš„ DOM ä¼šç¬é—´å¡æ­»
    const span = document.createElement('span');
    span.innerText = ' [Detail]';
    span.style.color = 'blue';
    div.appendChild(span);
    
    return div;
}, 40);
*/</span>
</code></pre>
<hr/>
<h3 data-id="heading-4">æ€»ç»“ä¸è¿›é˜¶æ€è€ƒ</h3>
<p>ä»¥ä¸Šä»£ç å±•ç¤ºäº†è§£å†³å‰ç«¯â€œé•¿ä»»åŠ¡â€çš„å››ä¸ªç»´åº¦çš„å·¥ç¨‹åŒ–å®ç°ã€‚è¦çœŸæ­£æŒæ¡ä¼˜åŒ–ï¼Œéœ€è¦ç†è§£ä»¥ä¸‹æ ¸å¿ƒæ€æƒ³ï¼š</p>
<ol>
<li><strong>è®©å‡ºä¸»çº¿ç¨‹ (Yielding)</strong>: JS æ˜¯å•çº¿ç¨‹çš„ï¼Œå¿…é¡»é€šè¿‡ <code>TimeSlicer</code> (æ—¶é—´åˆ†ç‰‡) å°†å¤§ä»»åŠ¡åˆ‡ç¢ï¼Œç»™ UI æ¸²æŸ“ç•™å‡ºå‘¼å¸çš„æ—¶é—´ã€‚</li>
<li><strong>å¹¶è¡Œè®¡ç®— (Parallelism)</strong>: ä½¿ç”¨ <code>WorkerPool</code> å°†ä¸æ¶‰åŠ DOM çš„çº¯ç®—æ³•é€»è¾‘ç§»åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ã€‚</li>
<li><strong>ä¼˜å…ˆçº§è°ƒåº¦ (Scheduling)</strong>: å¹¶ä¸æ˜¯æ‰€æœ‰ä»»åŠ¡éƒ½ä¸€æ ·é‡è¦ã€‚<code>PriorityScheduler</code> ç¡®ä¿ç”¨æˆ·äº¤äº’ï¼ˆç‚¹å‡»ã€è¾“å…¥ï¼‰æ°¸è¿œä¼˜å…ˆäºæ•°æ®å¤„ç†ã€‚</li>
<li><strong>æŒ‰éœ€æ¸²æŸ“ (Lazy Rendering)</strong>: <code>VirtualScroller</code> è¯æ˜äº†æ— è®ºæ•°æ®å¤šå¤§ï¼Œåªè¦è§†å£æœ‰é™ï¼ŒDOM çš„æ•°é‡å°±åº”è¯¥ä¿æŒæ’å®šã€‚</li>
</ol>
<p>è¿™äº›ä»£ç æ¨¡å—å¯ä»¥ç›´æ¥ç»„åˆä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªå¤§å‹æ•°æ®åˆ†æçœ‹æ¿ä¸­ï¼š</p>
<ul>
<li>ä½¿ç”¨ <strong>WorkerPool</strong> åœ¨åå°æ‹‰å–å¹¶è§£æ 10MB çš„ JSON æ•°æ®ã€‚</li>
<li>è§£æå®Œæˆåï¼Œä½¿ç”¨ <strong>TimeSlicer</strong> å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼ˆæ ¼å¼åŒ–ã€è®¡ç®—ç¯æ¯”ï¼‰ã€‚</li>
<li>æœ€ç»ˆå±•ç¤ºæ—¶ï¼Œä½¿ç”¨ <strong>VirtualScroller</strong> å°†åä¸‡æ¡è¡¨æ ¼æ•°æ®æµç•…åœ°æ¸²æŸ“å‡ºæ¥ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[GraphRAG å…¨æµç¨‹å®æˆ˜æŒ‡å—ï¼šä»å…¥é—¨åˆ°ä¸šåŠ¡è½åœ°]]></title>    <link>https://juejin.cn/post/7574041466710704171</link>    <guid>https://juejin.cn/post/7574041466710704171</guid>    <pubDate>2025-11-19T07:53:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574041466710704171" data-draft-id="7574230586970324998" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="GraphRAG å…¨æµç¨‹å®æˆ˜æŒ‡å—ï¼šä»å…¥é—¨åˆ°ä¸šåŠ¡è½åœ°"/> <meta itemprop="keywords" content="LLM,Agent,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-11-19T07:53:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIå¤§æ¨¡å‹"/> <meta itemprop="url" content="https://juejin.cn/user/3817967696221534"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            GraphRAG å…¨æµç¨‹å®æˆ˜æŒ‡å—ï¼šä»å…¥é—¨åˆ°ä¸šåŠ¡è½åœ°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3817967696221534/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIå¤§æ¨¡å‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T07:53:32.000Z" title="Wed Nov 19 2025 07:53:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<blockquote>
<p>æœ¬æ–‡å…¨é¢è§£æå¾®è½¯å¼€æºçš„ GraphRAG é¡¹ç›®ï¼Œä»å®ƒæ˜¯ä»€ä¹ˆã€æ€ä¹ˆç”¨ã€å¦‚ä½•ä¼˜åŒ–è¿è¡Œæ€§èƒ½ã€ç”Ÿæˆå“ªäº›å…³é”®æ–‡ä»¶ï¼Œåˆ°å¦‚ä½•é›†æˆåˆ°ä½ è‡ªå·±çš„ä¸šåŠ¡ä¸­ã€‚å†…å®¹æ·±å…¥ä½†é€šä¿—ï¼Œé€‚åˆå¼€å‘è€…ã€æ•°æ®åˆ†æå¸ˆã€AIå·¥ç¨‹å¸ˆå­¦ä¹ å‚è€ƒã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯ GraphRAGï¼Ÿå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h2>
<p>GraphRAGï¼ˆGraph Retrieval-Augmented Generationï¼‰æ˜¯å¾®è½¯ç ”ç©¶å›¢é˜Ÿå‘å¸ƒçš„å¼€æºé¡¹ç›®ï¼Œå®ƒæ˜¯ä¸€ç§â€œå›¾å¢å¼ºçš„æ£€ç´¢ç”Ÿæˆç³»ç»Ÿâ€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37b7a1d7ca2b42b4a9035287a82d4384~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764143612&amp;x-signature=jBi5Qnxayfwimlb9brKhGTn2wlw%3D" alt="" loading="lazy"/></p>
<p>ä¸ä¼ ç»Ÿçš„RAGä¸åŒï¼ŒGraphRAGä¸ä»…ä»…æ˜¯â€œæ£€ç´¢+ç”Ÿæˆâ€ï¼Œå®ƒå¼•å…¥äº†å›¾ç»“æ„ï¼Œä½¿å¾—RAGå…·å¤‡ä»¥ä¸‹<strong>å…³é”®èƒ½åŠ›</strong>ï¼š</p>

























<table><thead><tr><th>èƒ½åŠ›</th><th>æè¿°</th></tr></thead><tbody><tr><td>ç»“æ„åŒ–ç†è§£</td><td>æ„å»ºæ–‡æ¡£å†…çš„<strong>å®ä½“-å…³ç³»å›¾è°±</strong></td></tr><tr><td>å…¨å±€æ´å¯Ÿ</td><td>å¯¹æ–‡æ¡£ä¸­çš„çŸ¥è¯†ç‚¹è¿›è¡Œç¤¾åŒºèšç±»å’Œè¯­ä¹‰æ€»ç»“</td></tr><tr><td>ç²¾ç¡®æŸ¥è¯¢</td><td>æä¾›<strong>å±€éƒ¨è¯­ä¹‰æœç´¢</strong>ä¸<strong>å…¨å±€çŸ¥è¯†æ€»ç»“</strong>ä¸¤ç§æ–¹å¼</td></tr><tr><td>å¯è§£é‡Šæ€§å¼º</td><td>æ¯ä¸ªç»“è®ºéƒ½å¯ä»¥å›æº¯åŸå§‹å®ä½“ã€æ–‡æœ¬ã€ç¤¾åŒº</td></tr></tbody></table>
<h3 data-id="heading-1">ä½¿ç”¨GraphRAGçš„å…¸å‹åœºæ™¯ï¼š</h3>
<ul>
<li><strong>é•¿æ–‡æ¡£é—®ç­”ï¼ˆæ–‡æ¡£QAï¼‰</strong> ï¼šå¦‚æ³•å¾‹æ–‡ä¹¦ã€æ”¿ç­–æ–‡ä»¶ã€è´¢æŠ¥ç­‰</li>
<li><strong>ç»“æ„åŒ–æ‘˜è¦ç”Ÿæˆ</strong>ï¼šéœ€è¦ä»æµ·é‡æ–‡æœ¬ä¸­æç‚¼ç»“æ„åŒ–çŸ¥è¯†</li>
<li><strong>çŸ¥è¯†å›¾è°±æ„å»º</strong>ï¼šä¸æ‰‹å†™è§„åˆ™ã€çº¯é LLMè‡ªåŠ¨æå–å…³ç³»</li>
<li><strong>ä¼ä¸šæ•°æ®æ´å¯Ÿ</strong>ï¼šå¯¹å…¬å¸èµ„æ–™ã€é¡¹ç›®æŠ¥å‘Šè¿›è¡Œç»“æ„å»ºæ¨¡å’Œåˆ†æ</li>
</ul>
<h3 data-id="heading-2">ğŸ†š GraphRAG vs ä¼ ç»Ÿ RAG vs Embedding Search</h3>















































<table><thead><tr><th>ç‰¹æ€§</th><th>ä¼ ç»ŸEmbedding Search</th><th>æ™®é€šRAG</th><th><strong>GraphRAG</strong></th></tr></thead><tbody><tr><td>åŸºäºå‘é‡æ£€ç´¢</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>ä¸Šä¸‹æ–‡ç”Ÿæˆ</td><td>âŒ</td><td>âœ…</td><td>âœ…</td></tr><tr><td>çŸ¥è¯†å…³ç³»å»ºæ¨¡</td><td>âŒ</td><td>âŒ</td><td>âœ…</td></tr><tr><td>ç¤¾åŒºèšç±»åˆ†æ</td><td>âŒ</td><td>âŒ</td><td>âœ…</td></tr><tr><td>å…¨å±€ç»“æ„å›ç­”</td><td>âŒ</td><td>âŒ</td><td>âœ…</td></tr><tr><td>å¯è§£é‡Šæ€§</td><td>ä¸­</td><td>ä½</td><td><strong>é«˜</strong></td></tr></tbody></table>
<p>ç®€è¨€ä¹‹ï¼ŒGraphRAGæ˜¯å¯¹RAGçš„<strong>èƒ½åŠ›å‡çº§</strong>ï¼Œä¸ä»…å¯é—®ï¼Œè¿˜èƒ½è§£é‡Šâ€œçŸ¥è¯†æ˜¯å¦‚ä½•æ„æˆçš„â€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4afa685742df4709b990c6e101318a94~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764143612&amp;x-signature=JKUNLl8AyOLpGctEczOtH9Jo32I%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-3">äºŒã€å¦‚ä½•è·‘é€š GraphRAGï¼Ÿä»0åˆ°1å®Œæ•´æµç¨‹</h2>
<h3 data-id="heading-4"/>
<h3 data-id="heading-5">1. å®‰è£…ç¯å¢ƒï¼ˆæ¨èä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼‰</h3>
<pre><code class="hljs">â€‹
pip install graphrag
ä¸å†éœ€è¦ Poetryã€æºç å…‹éš†ç­‰ç¹çæ­¥éª¤ã€‚GraphRAG å·²æ­£å¼å‘å¸ƒåˆ° PyPIã€‚
â€‹
</code></pre>
<hr/>
<h3 data-id="heading-6"/>
<h3 data-id="heading-7">2. åˆå§‹åŒ–é¡¹ç›®ç›®å½•</h3>
<p>ä½¿ç”¨å®˜æ–¹å‘½ä»¤å¿«é€Ÿåˆå§‹åŒ–ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">graphrag init --root ./ragtest
è¿™ä¸€æ­¥ä¼šç”Ÿæˆæ ‡å‡†çš„ç›®å½•ç»“æ„ï¼š
ragtest/
â”œâ”€â”€ settings.yaml Â  Â  Â 
<span class="hljs-comment"># ä¸»é…ç½®æ–‡ä»¶</span>
â”œâ”€â”€ prompts/ Â  Â  Â  Â  Â  
<span class="hljs-comment"># æç¤ºè¯æ¨¡æ¿</span>
â”œâ”€â”€ .
<span class="hljs-built_in">env</span>
<span class="hljs-comment"># å­˜æ”¾APIå¯†é’¥ï¼ˆéœ€æ‰‹åŠ¨å¡«å…¥ï¼‰</span>
â””â”€â”€ input/ Â  Â  Â  Â  Â  Â  
<span class="hljs-comment"># â—éœ€è¦æ‰‹åŠ¨åˆ›å»ºï¼Œç”¨æ¥æ”¾ä½ è¦åˆ†æçš„æ–‡æ¡£</span>
â€‹
</code></pre>
<hr/>
<h3 data-id="heading-8"/>
<h3 data-id="heading-9">3. é…ç½® API å¯†é’¥</h3>
<p>ç¼–è¾‘Â <code>.env</code>Â æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„ API Keyã€‚ä¾‹å¦‚ä½¿ç”¨ç¡…åŸºæµåŠ¨ APIï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">GRAPHRAG_API_KEY</span> = sk-your-siliconflow-api-key
åŒæ—¶ï¼Œåœ¨settings.yamlä¸­è®¾ç½® API æä¾›æ–¹ï¼š
</code></pre>

<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">models:</span>
<span class="hljs-section">default_chat_model:</span>
<span class="hljs-section">type: openai_chat</span>
<span class="hljs-section">api_base: https://api.siliconflow.cn/v1</span>
<span class="hljs-section">api_key: ${GRAPHRAG_API_KEY}</span>
<span class="hljs-section">model: deepseek-ai/DeepSeek-V3</span>
<span class="hljs-section">encoding_model: cl100k_base</span>
<span class="hljs-section">concurrent_requests: 3</span>
<span class="hljs-section">requests_per_minute: 30</span>
<span class="hljs-section">default_embedding_model:</span>
<span class="hljs-section">type: openai_embedding</span>
<span class="hljs-section">api_base: https://api.siliconflow.cn/v1</span>
<span class="hljs-section">api_key: ${GRAPHRAG_API_KEY}</span>
<span class="hljs-section">model: BAAI/bge-large-zh-v1.5</span>
<span class="hljs-section">encoding_model: cl100k_base</span>
<span class="hljs-section">concurrent_requests: 3</span>
<span class="hljs-section">requests_per_minute: 30</span>
</code></pre>
<h3 data-id="heading-10">4. æ·»åŠ æ–‡æ¡£åˆ° input ç›®å½•</h3>
<p>å°†ä½ éœ€è¦å¤„ç†çš„æ–‡æ¡£æ”¾å…¥Â <code>ragtest/input/</code>Â ç›®å½•ä¸­ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ragtest/
â”œâ”€â”€ settings.yaml Â  <span class="hljs-comment"># é…ç½®æ–‡ä»¶</span>
â”œâ”€â”€ prompts/ Â  Â  Â   <span class="hljs-comment"># æç¤ºè¯æ¨¡æ¿</span>
â”œâ”€â”€ input/ Â  Â  Â  Â   <span class="hljs-comment"># æ•°æ®è¾“å…¥ç›®å½•ï¼ˆéœ€æ‰‹åŠ¨åˆ›å»ºï¼‰</span>
â”œâ”€â”€ .<span class="hljs-built_in">env</span> Â  Â  Â  Â  Â   <span class="hljs-comment"># å­˜å‚¨APIå¯†é’¥</span>
â””â”€â”€ output/ Â  Â  Â  Â  <span class="hljs-comment"># è‡ªåŠ¨ç”Ÿæˆçš„ç´¢å¼•ç»“æœ</span>
æ”¯æŒ.txt,.pdf,.docxç­‰å¤šç§æ ¼å¼ã€‚
</code></pre>
<hr/>
<h3 data-id="heading-11">5. è¿è¡Œç´¢å¼•æ„å»ºå‘½ä»¤</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> ragtest
graphrag index --root .
è¯¥å‘½ä»¤ä¼šè‡ªåŠ¨å®Œæˆä»¥ä¸‹è¿‡ç¨‹ï¼š
</code></pre>
<ol>
<li>æ–‡æœ¬åˆ†å—</li>
<li>å®ä½“è¯†åˆ«ä¸å…³ç³»æå–ï¼ˆè°ƒç”¨å¤§æ¨¡å‹ï¼‰</li>
<li>æ„å»ºå®ä½“-å…³ç³»å›¾è°±</li>
<li>ç¤¾åŒºæ£€æµ‹ï¼ˆLeidenç®—æ³•ï¼‰</li>
<li>ç”Ÿæˆç¤¾åŒºæ‘˜è¦ï¼ˆè°ƒç”¨å¤§æ¨¡å‹ï¼‰</li>
<li>åµŒå…¥è®¡ç®— + å‘é‡ç´¢å¼•æ„å»º</li>
</ol>
<blockquote>
<p>è¿™ä¸ªè¿‡ç¨‹ä¼šèŠ±è´¹å¾ˆé•¿æ—¶é—´</p>
</blockquote>
<hr/>
<h3 data-id="heading-12">6. è¿è¡ŒæŸ¥è¯¢å‘½ä»¤</h3>
<pre><code class="hljs language-bash" lang="bash">
<span class="hljs-comment"># å…¨å±€æŸ¥è¯¢ï¼ˆé—®ç»“æ„åŒ–ä¸»é¢˜ï¼‰</span>
graphrag query --root . --method global <span class="hljs-string">"å…¬å¸çš„æ ¸å¿ƒé¡¹ç›®æ˜¯ä»€ä¹ˆï¼Ÿ"</span>
<span class="hljs-comment"># å±€éƒ¨æŸ¥è¯¢ï¼ˆé—®ç»†èŠ‚è¯­ä¹‰ï¼‰</span>
graphrag query --root . --method <span class="hljs-built_in">local</span> <span class="hljs-string">"å¼ ä¸‰çš„èŒè´£æ˜¯ä»€ä¹ˆï¼Ÿ"</span>
éœ€è¦åœ¨åŒ…å« settings.yaml é…ç½®æ–‡ä»¶çš„ç›®å½•ä¸­è¿è¡Œï¼Œä¹Ÿå°±æ˜¯ ragtest ç›®å½•ã€‚
<span class="hljs-built_in">cd</span> ragtest  <span class="hljs-comment"># åˆ‡æ¢åˆ°åŒ…å«settings.yamlçš„ç›®å½•</span>
ç¤ºä¾‹ï¼š
graphrag query --root . --method global --query <span class="hljs-string">"å¼ é£æ˜¯è°çš„å…„å¼Ÿ"</span>
Missing reports <span class="hljs-keyword">for</span> communities: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498] Â  Â  Â  Â 
SUCCESS: Global Search Response:
å¼ é£æ˜¯åˆ˜å¤‡çš„å…„å¼Ÿã€‚åœ¨ä¸‰å›½æ—¶æœŸï¼Œå¼ é£ä¸åˆ˜å¤‡ã€å…³ç¾½å¹¶ç§°ä¸ºâ€˜æ¡ƒå›­ä¸‰ç»“ä¹‰â€™ï¼Œä¸‰äººç»“ä¸ºå¼‚å§“å…„å¼Ÿï¼Œå…±åŒå‚ä¸äº†ä¸‰å›½çš„è¯¸å¤šå†å²äº‹ä»¶ã€‚[Data: Reports (1, 3)] Â  Â  Â 

</code></pre>
<hr/>
<h2 data-id="heading-13">ä¸‰ã€ragtestç›®å½•ç»“æ„è¯¦è§£</h2>
<p>ä¸€æ—¦è¿è¡Œå®Œç´¢å¼•å‘½ä»¤ï¼Œç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">ragtest/
â”œâ”€â”€ input/                          <span class="hljs-meta"># è¾“å…¥æ•°æ®</span>
â”‚   â””â”€â”€ three_kingdomspart.txt      <span class="hljs-meta"># æˆ‘ä»¬ç»™å®šçš„æ–‡æ¡£ï¼Œæ¯”å¦‚ä¸‰å›½æ¼”ä¹‰</span>
â”œâ”€â”€ output/                         <span class="hljs-meta"># ä¸»è¦è¾“å‡ºæ–‡ä»¶</span>
â”‚   â”œâ”€â”€ documents.parquet           <span class="hljs-meta"># æ–‡æ¡£è¡¨</span>
â”‚   â”œâ”€â”€ text_units.parquet          <span class="hljs-meta"># æ–‡æœ¬å•å…ƒè¡¨</span>
â”‚   â”œâ”€â”€ entities.parquet            <span class="hljs-meta"># å®ä½“è¡¨</span>
â”‚   â”œâ”€â”€ relationships.parquet       <span class="hljs-meta"># å…³ç³»è¡¨</span>
â”‚   â”œâ”€â”€ communities.parquet         <span class="hljs-meta"># ç¤¾åŒºè¡¨</span>
â”‚   â”œâ”€â”€ community_reports.parquet   <span class="hljs-meta"># ç¤¾åŒºæŠ¥å‘Šè¡¨</span>
â”‚   â”œâ”€â”€ covariates.parquet          <span class="hljs-meta"># åå˜é‡è¡¨ï¼ˆå¯é€‰ï¼‰</span>
â”‚   â””â”€â”€ lancedb/                    <span class="hljs-meta"># å‘é‡æ•°æ®åº“</span>
â”‚       â””â”€â”€ <span class="hljs-literal">default</span>/                <span class="hljs-meta"># å­˜å‚¨æ–‡æœ¬åµŒå…¥å‘é‡</span>
â”œâ”€â”€ cache/                          <span class="hljs-meta"># ç¼“å­˜æ–‡ä»¶</span>
â”‚   â”œâ”€â”€ base_text_units.parquet     <span class="hljs-meta"># åŸºç¡€æ–‡æœ¬å•å…ƒç¼“å­˜</span>
â”‚   â”œâ”€â”€ extracted_entities.parquet  <span class="hljs-meta"># æå–çš„å®ä½“ç¼“å­˜</span>
â”‚   â”œâ”€â”€ extracted_relationships.parquet <span class="hljs-meta"># æå–çš„å…³ç³»ç¼“å­˜</span>
â”‚   â””â”€â”€ ... (å…¶ä»–ä¸­é—´ç¼“å­˜æ–‡ä»¶)
â””â”€â”€ logs/                           <span class="hljs-meta"># è¿è¡Œæ—¥å¿—</span>
â””â”€â”€ indexing-engine.log         <span class="hljs-meta"># ç´¢å¼•è¿‡ç¨‹æ—¥å¿—</span>
</code></pre>
<hr/>
<h2 data-id="heading-14">å››ã€GraphRAGè¾“å‡ºæ–‡ä»¶è¯¦è§£</h2>
<h3 data-id="heading-15"/>
<h3 data-id="heading-16">1ï¸âƒ£Â <code>documents.parquet</code>ï¼ˆæ–‡æ¡£è¡¨ï¼‰</h3>
<ul>
<li>å­˜å‚¨åŸå§‹æ–‡æ¡£çš„å…ƒä¿¡æ¯ä¸å…¨æ–‡å†…å®¹</li>
<li>æ¯ä¸ªæ–‡æ¡£ä¸€ä¸ªæ¡ç›®ï¼Œè®°å½•å…¶Â <code>title</code>ã€<code>text</code>ã€<code>doc_id</code></li>
<li><code>å°±æ˜¯åŸå§‹æ–‡æ¡£çš„æ¡ç›®</code></li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5504baf2c6974f3db0cbf160f8392fec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764143612&amp;x-signature=tFoheLOqg16exALwLL5H%2F7423KM%3D" alt="" loading="lazy"/></p>
<p><code>2ï¸âƒ£</code>Â <code>text_units.parquet</code>ï¼ˆæ–‡æœ¬å•å…ƒè¡¨ï¼‰</p>
<ul>
<li>å°†æ¯ä¸ªæ–‡æ¡£åˆ†å—ï¼ˆchunkï¼‰åçš„åˆ‡ç‰‡å†…å®¹</li>
<li>æ¯ä¸€å—å¯¹åº”ä¸€æ¬¡LLMè°ƒç”¨ï¼ˆå¦‚å®ä½“æå–ï¼‰</li>
<li>å°±æ˜¯åˆ‡åˆ†åçš„æ¯ä¸€ä¸ªchunkçš„å†…å®¹</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eacad25c74ba4319aff921f604e81169~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764143612&amp;x-signature=8Ka8oJUAifnLyn63EZvXD5HZ3Wo%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-17">3ï¸âƒ£Â <code>entities.parquet</code>ï¼ˆå®ä½“è¡¨ï¼‰</h3>
<ul>
<li>æ‰€æœ‰æ–‡æ¡£ä¸­æå–å‡ºçš„<strong>äººç‰©ã€ç»„ç»‡ã€åœ°ç‚¹ã€äº‹ä»¶</strong></li>
<li>åŒ…å«ï¼šå®ä½“åç§°ã€ç±»å‹ã€é¢‘ç‡ã€æè¿°ã€å‡ºç°åœ¨å“ªäº›å—ä¸­</li>
<li>æ˜¯çŸ¥è¯†å›¾è°±çš„"èŠ‚ç‚¹"</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8401aedd1fc4b3ea7017ae146740aa2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764143612&amp;x-signature=xV8Vav93VxeCV%2BIUU3KxO8pCZNs%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-18">4ï¸âƒ£Â <code>relationships.parquet</code>ï¼ˆå…³ç³»è¡¨ï¼‰</h3>
<ul>
<li>æ¯å¯¹å®ä½“ä¹‹é—´çš„è¯­ä¹‰å…³ç³»ï¼ˆå¦‚â€œå¼ ä¸‰-ç®¡ç†-äº§å“éƒ¨â€ï¼‰</li>
<li>åŒ…å«æè¿°ã€å…³ç³»ç±»å‹ã€æƒé‡ç­‰</li>
<li>æ˜¯çŸ¥è¯†å›¾è°±çš„"è¾¹"</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c93116e8a9949eab283385a5d6a780d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764143612&amp;x-signature=3cFcsrQ6v0%2BJvBGw%2B8FG00kcxic%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-19">5ï¸âƒ£Â <code>communities.parquet</code>ï¼ˆç¤¾åŒºè¡¨ï¼‰</h3>
<ul>
<li>åŸºäºå›¾è°±è¿è¡Œç¤¾åŒºæ£€æµ‹ç®—æ³•ï¼Œèšå‡ºâ€œä¸»é¢˜ç»„â€</li>
<li>æ¯ä¸ªç¤¾åŒºåŒ…å«ä¸€ç»„ç›¸å…³çš„å®ä½“ï¼ˆå¦‚æŸäº§å“çº¿å›¢é˜Ÿï¼‰</li>
<li>ä½œç”¨æ˜¯å‘ç°"ä¸»é¢˜é›†ç¾¤"</li>
<li><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d827a523ca04834af2d9a1a7d5787c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764143612&amp;x-signature=v%2FGMQQ%2FxRHuY4GksiCjZx0P9VMo%3D" alt="" loading="lazy"/></li>
</ul>
<h3 data-id="heading-20">6ï¸âƒ£Â <code>community_reports.parquet</code>ï¼ˆç¤¾åŒºæŠ¥å‘Šè¡¨ï¼‰</h3>
<ul>
<li>å¯¹æ¯ä¸ªç¤¾åŒºï¼Œè°ƒç”¨LLMç”Ÿæˆçš„ç»“æ„åŒ–æ‘˜è¦</li>
<li>åŒ…æ‹¬æŠ¥å‘Šæ ‡é¢˜ã€æ‘˜è¦ã€ä¸»è¦å‘ç°</li>
<li>é¢å‘çš„æ˜¯ç”¨æˆ·ï¼Œç”¨çš„æ˜¯è‡ªç„¶è¯­è¨€</li>
<li>Qwenæ¨¡å‹å®¹æ˜“å¤±è´¥ï¼Œå¾—æ¢ä¸ªåˆé€‚çš„æ¨¡å‹</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2c1f2953fee4844be3c5d5013b3dce5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764143612&amp;x-signature=ODalo1ZH5fUcNq%2B3yErUBls4OyE%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-21">7ï¸âƒ£Â <code>lancedb/</code>ï¼ˆå‘é‡æ•°æ®åº“ï¼‰</h3>
<ul>
<li>æ¯ä¸ªæ–‡æœ¬å•å…ƒçš„å‘é‡è¡¨ç¤ºï¼Œç”¨äºå±€éƒ¨è¯­ä¹‰æœç´¢</li>
</ul>
<hr/>
<h2 data-id="heading-22">äº”ã€GraphRAGæ˜¯å¦ç”¨åˆ°GPUï¼Ÿç”¨çš„æ˜¯APIè¿˜æ˜¯æœ¬åœ°æ¨ç†ï¼Ÿ</h2>
<h3 data-id="heading-23">âœ… GraphRAG é»˜è®¤æ˜¯Â <strong>çº¯CPU + APIæ¶æ„</strong></h3>
<ul>
<li>å¤§æ¨¡å‹ï¼ˆLLMï¼‰çš„ç”Ÿæˆä»»åŠ¡ â†’ è°ƒç”¨è¿œç¨‹APIï¼ˆå¦‚OpenAIã€DeepSeekã€ç¡…åŸºæµåŠ¨ï¼‰</li>
<li>å‘é‡åµŒå…¥ â†’ è°ƒç”¨APIè¿”å›å‘é‡</li>
<li>å›¾è°±æ„å»ºä¸èšç±» â†’ æœ¬åœ°CPUå®Œæˆ</li>
</ul>
<blockquote>
<p>æ— éœ€å®‰è£…æœ¬åœ°å¤§æ¨¡å‹ï¼Œä¹Ÿä¸éœ€è¦GPUã€‚åªéœ€é…ç½®å¥½API Keyï¼Œå³å¯å…¨æµç¨‹è¿è¡Œã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-24">å…­ã€å¦‚ä½•è®©GraphRAGè·‘å¾—æ›´å¿«ï¼Ÿæ€§èƒ½ä¼˜åŒ–å»ºè®®</h2>
<p>è™½ç„¶GraphRAGä¸ä¾èµ–GPUï¼Œä½†å®ƒå¯¹ç½‘ç»œå’ŒAPIé€Ÿç‡éå¸¸æ•æ„Ÿã€‚</p>
<h3 data-id="heading-25">å¸¸è§å¯¼è‡´è¿è¡Œæ…¢çš„åŸå› ï¼š</h3>
<ol start="0">
<li><strong>æ–‡æœ¬åˆ†å—å¤ªå¤š</strong>ï¼ˆé»˜è®¤1200å­—ç¬¦ä¸€å—ï¼‰</li>
<li><strong>å¹¶å‘è¯·æ±‚å¤ªé«˜ï¼ŒAPIæœåŠ¡é™é€Ÿ</strong></li>
<li><strong>æå–çš„å®ä½“ç§ç±»å¤ªå¤šï¼ˆé»˜è®¤4ç±»ï¼‰</strong></li>
<li><strong>å¯ç”¨äº†å¤šè½®æå–æˆ–å¤§ç¤¾åŒºå¤„ç†</strong></li>
</ol>
<h3 data-id="heading-26">âœ… ä¼˜åŒ–å»ºè®®æ¸…å•ï¼š</h3>
<h4 data-id="heading-27">1. å‡å°æ–‡æœ¬å—å¤§å°ï¼Œé™ä½è¯·æ±‚é‡</h4>
<pre><code class="hljs language-yaml" lang="yaml">
<span class="hljs-attr">chunks:</span>
  <span class="hljs-attr">size:</span> <span class="hljs-number">600</span>     <span class="hljs-comment"># é»˜è®¤1200ï¼Œå‡å°å¯ä»¥å‡å°‘æ¯æ¬¡Tokené‡</span>
  <span class="hljs-attr">overlap:</span> <span class="hljs-number">50</span>
</code></pre>
<h4 data-id="heading-28">2. é™åˆ¶å®ä½“ç±»å‹</h4>
<pre><code class="hljs language-yaml" lang="yaml">
<span class="hljs-attr">extract_graph:</span>
  <span class="hljs-attr">entity_types:</span> [<span class="hljs-string">person</span>, <span class="hljs-string">organization</span>]
</code></pre>
<h4 data-id="heading-29">3. é™ä½å¹¶å‘å¹¶é™é€Ÿï¼ˆå°¤å…¶ç”¨ç¡…åŸºæµåŠ¨æ—¶ï¼‰</h4>
<pre><code class="hljs language-yaml" lang="yaml">
<span class="hljs-attr">models:</span>
  <span class="hljs-attr">default_chat_model:</span>
    <span class="hljs-attr">concurrent_requests:</span> <span class="hljs-number">3</span>
    <span class="hljs-attr">requests_per_minute:</span> <span class="hljs-number">30</span>
</code></pre>
<h4 data-id="heading-30">4. å¯ç”¨ç¼“å­˜</h4>
<pre><code class="hljs language-yaml" lang="yaml">
<span class="hljs-attr">cache:</span>
  <span class="hljs-attr">type:</span> <span class="hljs-string">file</span>
  <span class="hljs-attr">base_dir:</span> <span class="hljs-string">"cache"</span>
</code></pre>
<h4 data-id="heading-31">5. å…ˆç”¨å°æ–‡æ¡£æµ‹è¯•ï¼Œé€æ­¥æ‰©å¤§è§„æ¨¡</h4>
<h4 data-id="heading-32"/>
<h4 data-id="heading-33">è¿›ä¸€æ­¥çš„æ€§èƒ½ä¼˜åŒ–æ¸…å•</h4>
<h4 data-id="heading-34"/>













































<table><thead><tr><th>ä¼˜åŒ–ç‚¹</th><th>è¯´æ˜</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>Chunk Size &amp; Overlap è°ƒå‚</strong></td><td>â€¢ è‹¥ä¾›åº”å•†æŒ‰Â <em>token/min</em>Â è®¡è´¹/é™é€Ÿï¼Œ<strong>å‡å° chunk</strong>Â å¯è®©å•æ¬¡ token-loadâ†“ï¼Œé™ä½è¢«é™é€Ÿæ¦‚ç‡ï¼›ä½†è¯·æ±‚æ•°ä¼šå¢å¤šã€‚â€¢ è‹¥æŒ‰Â <em>req/min</em>Â é™é€Ÿï¼Œ<strong>å¢å¤§ chunk</strong>ï¼ˆ1500-2000 tokensï¼‰+Â <strong>overlap 50â†’20</strong>Â å¯ä»¥æ˜¾è‘—å‡å°‘è°ƒç”¨æ¬¡æ•°ã€‚</td><td>å¤§æ–‡ä»¶ / é™é€Ÿä¸¥æ ¼</td></tr><tr><td><strong>åœç”¨ Claim ä¸ Gleanings</strong></td><td>åœ¨Â <code>settings.yaml</code>ï¼š<code>claim_extraction.enabled: false``extract_graph.max_gleanings: 0</code></td><td>åªæƒ³è¦å®ä½“-å…³ç³»-ç¤¾åŒºæ—¶</td></tr><tr><td><strong>åˆ†é˜¶æ®µæ‰§è¡Œ</strong></td><td>å…ˆè·‘Â <code>graphrag index --root . --method embeddings</code>Â åªè®¡ç®—åµŒå…¥ï¼Œç¡®è®¤é€Ÿåº¦ OK åå†è·‘å®Œæ•´æµæ°´çº¿ã€‚</td><td>è¶…é•¿è¯­æ–™è¯•è·‘</td></tr><tr><td><strong>æœ¬åœ°åµŒå…¥æ¨¡å‹</strong></td><td>ç”¨Â <code>api_base: http://localhost:11434</code>Â + Ollama embeddingï¼ˆnomic-embedï¼‰å¯æŠŠ 60-70 %çš„ API è°ƒç”¨è½¬æœ¬åœ°ï¼Œé€Ÿåº¦å’Œæˆæœ¬åŒé™ã€‚</td><td>æœ‰ GPU / CPU å……è£•</td></tr><tr><td><strong>é€’å¢æ‰¹å¤„ç†</strong></td><td>åˆ©ç”¨Â <code>parallelization.stagger</code>ï¼ˆ0.3-0.5ï¼‰è®©è¯·æ±‚æ‰¹æ¬¡äº¤é”™ï¼Œæ›´å¹³æ»‘åœ°åˆ©ç”¨é™é¢ã€‚</td><td>ä¾›åº”å•†æ”¯æŒå¹¶å‘é«˜ä½†é™é€Ÿ</td></tr><tr><td><strong>æ–‡æœ¬é¢„æ¸…æ´—</strong></td><td>å»é™¤é¡µçœ‰é¡µè„šã€æ¨¡æ¿é‡å¤æ®µï¼Œå¯å‡å°‘ 10-30 % æ— æ•ˆ tokenã€‚</td><td>PDF æ‰¹é‡å¯¼å…¥</td></tr><tr><td><strong>é‡ç”¨ Prompt æ¨¡æ¿</strong></td><td>æŠŠé•¿ç³»ç»Ÿ prompt å†™è¿›Â <code>prompt_template:</code>Â æ–‡ä»¶å¹¶å¼•ç”¨ï¼Œå¯æ˜¾è‘—å‡å°æ¯æ¬¡ tokenã€‚</td><td>è‡ªå®šä¹‰ prompt å¾ˆé•¿æ—¶</td></tr></tbody></table>
<h4 data-id="heading-35"/>
<h4 data-id="heading-36"/>
<hr/>
<h2 data-id="heading-37">ä¸ƒã€æˆ‘æƒ³æ¥å…¥è‡ªå·±é¡¹ç›®ï¼Œåº”è¯¥æ€ä¹ˆåšï¼Ÿ</h2>
<p>GraphRAGæ˜¯<strong>æ ‡å‡†è¾“å‡ºç»“æ„+è‡ªå®šä¹‰é…ç½®é©±åŠ¨</strong>çš„ç³»ç»Ÿï¼Œä½ åªéœ€è¦ï¼š</p>
<h3 data-id="heading-38">âœ… è°ƒæ•´é…ç½®æ–‡ä»¶Â <code>settings.yaml</code></h3>
<ul>
<li>å®ä½“ç±»å‹é€‚é…ä½ ä¸šåŠ¡é¢†åŸŸ</li>
<li>åˆ†å—ç­–ç•¥æŒ‰æ–‡æ¡£ç‰¹ç‚¹è°ƒæ•´</li>
</ul>
<pre><code class="hljs language-yaml" lang="yaml">
<span class="hljs-attr">extract_graph:</span>
  <span class="hljs-attr">entity_types:</span> [<span class="hljs-string">person</span>, <span class="hljs-string">department</span>, <span class="hljs-string">project</span>]
  <span class="hljs-attr">prompt:</span> <span class="hljs-string">prompts/extract_business.txt</span>
<span class="hljs-attr">chunks:</span>
  <span class="hljs-attr">size:</span> <span class="hljs-number">1000</span>
  <span class="hljs-attr">overlap:</span> <span class="hljs-number">100</span>
</code></pre>
<h3 data-id="heading-39">âœ… ä¿®æ”¹æç¤ºè¯æ¨¡æ¿</h3>
<p>åœ¨Â <code>prompts/</code>Â ä¸­ç¼–å†™è‡ªå®šä¹‰æ¨¡æ¿ï¼Œå¦‚ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">è¯·ä»ä»¥ä¸‹æ–‡æœ¬ä¸­æå–ï¼š
<span class="hljs-deletion">- PERSON: å‘˜å·¥ã€å®¢æˆ·ã€åˆä½œä¼™ä¼´</span>
<span class="hljs-deletion">- DEPARTMENT: å…¬å¸å†…éƒ¨éƒ¨é—¨</span>
<span class="hljs-deletion">- PROJECT: é¡¹ç›®/äº§å“</span>
</code></pre>
<h3 data-id="heading-40">âœ… ä½¿ç”¨GraphRAGç”Ÿæˆç»“æ„åŒ–ç»“æœå¹¶æ¥å…¥ä½ ç³»ç»Ÿ</h3>
<p>ä½ å¯ä»¥å°†ç”Ÿæˆçš„Â <code>entities.parquetï¼Œ``relationships.parquetï¼Œ``community_reports.parquet</code>ä½œä¸ºä½ ç³»ç»Ÿçš„çŸ¥è¯†ç»“æ„ã€æ ‡ç­¾æºã€ç”šè‡³é—®ç­”åŸºç¡€ã€‚</p>
<hr/>
<h2 data-id="heading-41">âœ… æ€»ç»“</h2>

































<table><thead><tr><th>åŠŸèƒ½</th><th>GraphRAG</th></tr></thead><tbody><tr><td>æ–‡æ¡£ç»“æ„å»ºæ¨¡</td><td>âœ…</td></tr><tr><td>å®ä½“/å…³ç³»æŠ½å–</td><td>âœ…</td></tr><tr><td>ç¤¾åŒºèšç±»åˆ†æ</td><td>âœ…</td></tr><tr><td>å¤šå±‚æ¬¡é—®ç­”æ”¯æŒ</td><td>âœ…</td></tr><tr><td>æ— éœ€æœ¬åœ°éƒ¨ç½²å¤§æ¨¡å‹</td><td>âœ…</td></tr><tr><td>æ”¯æŒä¼ä¸šå®šåˆ¶</td><td>âœ…</td></tr></tbody></table>
<p>GraphRAG å°±åƒæ˜¯ä¸€ä¸ª<strong>è‡ªåŠ¨åŒ–çŸ¥è¯†å·¥å‚</strong>ï¼Œå¸®ä½ ä»æ— ç»“æ„æ–‡æœ¬ä¸­æç‚¼å‡ºæœ‰ç»“æ„çš„å›¾è°±å’Œæ´å¯Ÿã€‚åªè¦ä½ é…ç½®å¾—å½“ï¼Œå®ƒå¯ä»¥æ— ç¼é›†æˆåˆ°ä½ ä»»ä½•AIç›¸å…³çš„ä¸šåŠ¡ç³»ç»Ÿä¸­ã€‚</p>
<hr/>
<p>ğŸ“ é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmicrosoft%2Fgraphrag" target="_blank" title="https://github.com/microsoft/graphrag" ref="nofollow noopener noreferrer">github.com/microsoft/gâ€¦</a></p>
<p>ğŸ“– å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmicrosoft%2Fgraphrag%3Ftab%3Dreadme-ov-file" target="_blank" title="https://github.com/microsoft/graphrag?tab=readme-ov-file" ref="nofollow noopener noreferrer">github.com/microsoft/gâ€¦</a></p>
<h2 data-id="heading-42">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Go é‡è¯•æœºåˆ¶ç»ˆææŒ‡å—ï¼šåŸºäº go-retry æ‰“é€ å¯é å®¹é”™ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7574244766423007241</link>    <guid>https://juejin.cn/post/7574244766423007241</guid>    <pubDate>2025-11-19T08:09:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574244766423007241" data-draft-id="7574244766422990857" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Go é‡è¯•æœºåˆ¶ç»ˆææŒ‡å—ï¼šåŸºäº go-retry æ‰“é€ å¯é å®¹é”™ç³»ç»Ÿ"/> <meta itemprop="keywords" content="Go,æ¶æ„"/> <meta itemprop="datePublished" content="2025-11-19T08:09:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‹¼çˆ·"/> <meta itemprop="url" content="https://juejin.cn/user/2418581314208279"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Go é‡è¯•æœºåˆ¶ç»ˆææŒ‡å—ï¼šåŸºäº go-retry æ‰“é€ å¯é å®¹é”™ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2418581314208279/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‹¼çˆ·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T08:09:53.000Z" title="Wed Nov 19 2025 08:09:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="srcery">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#1c1b19;color:#fce8c3}.hljs-emphasis,.hljs-strong{color:#918175}.hljs-bullet,.hljs-link,.hljs-literal,.hljs-number,.hljs-quote,.hljs-regexp{color:#ff5c8f}.hljs-code,.hljs-selector-class{color:#68a8e4}.hljs-emphasis{font-style:italic}.hljs-attribute,.hljs-keyword,.hljs-section,.hljs-selector-tag,.hljs-variable{color:#ef2f27}.hljs-name,.hljs-title{color:#fbb829}.hljs-params,.hljs-type{color:#0aaeb3}.hljs-string{color:#98bc37}.hljs-addition,.hljs-built_in,.hljs-builtin-name,.hljs-selector-attr,.hljs-selector-id,.hljs-selector-pseudo,.hljs-subst,.hljs-symbol,.hljs-template-tag,.hljs-template-variable{color:#c07abe}.hljs-comment,.hljs-deletion,.hljs-meta{color:#918175}</style><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿã€API è°ƒç”¨ã€æ•°æ®åº“æ“ä½œç­‰åœºæ™¯ä¸­ï¼Œç½‘ç»œæŠ–åŠ¨ã€æœåŠ¡ä¸´æ—¶ä¸å¯ç”¨ç­‰é—®é¢˜æ—¶æœ‰å‘ç”Ÿã€‚é‡è¯•æœºåˆ¶ä½œä¸ºå®¹é”™è®¾è®¡çš„æ ¸å¿ƒæ‰‹æ®µï¼Œèƒ½æœ‰æ•ˆæå‡ç³»ç»Ÿç¨³å®šæ€§â€”â€”ä½†ä¸åˆç†çš„é‡è¯•ç­–ç•¥ï¼ˆå¦‚æ— é™åˆ¶é‡è¯•ã€å›ºå®šé—´éš”é‡è¯•ï¼‰å¯èƒ½å¯¼è‡´é›ªå´©æ•ˆåº”æˆ–èµ„æºè€—å°½ã€‚æœ¬æ–‡å°†æ·±å…¥è§£æ <code>sethvargo/go-retry</code> è¿™ä¸ªè½»é‡ä¸”å¼ºå¤§çš„ Go é‡è¯•åº“ï¼Œå¸¦ä½ ä»åŸç†åˆ°å®è·µï¼Œæ„å»ºçµæ´»ã€å®‰å…¨ã€é«˜æ•ˆçš„é‡è¯•é€»è¾‘ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆé€‰æ‹© go-retryï¼Ÿ</h2>
<p>Go æ ‡å‡†åº“å¹¶æœªæä¾›é‡è¯•ç›¸å…³çš„åŸç”Ÿæ”¯æŒï¼Œæ‰‹åŠ¨å®ç°é‡è¯•é€»è¾‘å¾€å¾€é¢ä¸´è¯¸å¤šé—®é¢˜ï¼š</p>
<ul>
<li>é‡å¤ç¼–ç ï¼šæ¯æ¬¡éœ€è¦é‡è¯•æ—¶éƒ½è¦å†™å¾ªç¯ã€ç¡çœ ã€é€€å‡ºæ¡ä»¶åˆ¤æ–­ï¼›</li>
<li>ç­–ç•¥åƒµåŒ–ï¼šéš¾ä»¥çµæ´»åˆ‡æ¢å›ºå®šé—´éš”ã€æŒ‡æ•°é€€é¿ç­‰é‡è¯•ç­–ç•¥ï¼›</li>
<li>é”™è¯¯å¤„ç†æ··ä¹±ï¼šæ— æ³•æ¸…æ™°åŒºåˆ†â€œå¯é‡è¯•é”™è¯¯â€å’Œâ€œä¸å¯é‡è¯•é”™è¯¯â€ï¼›</li>
<li>èµ„æºæ³„æ¼ï¼šå¿˜è®°ç»ˆæ­¢é‡è¯•å¯¼è‡´æ— é™å¾ªç¯ï¼Œæˆ–è¶…æ—¶æ§åˆ¶ä¸å½“ã€‚</li>
</ul>
<p>è€Œ <code>sethvargo/go-retry</code> å®Œç¾è§£å†³äº†è¿™äº›ç—›ç‚¹ï¼Œå…¶æ ¸å¿ƒä¼˜åŠ¿å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>è½»é‡æ— ä¾èµ–</strong>ï¼šçº¯ Go å®ç°ï¼Œä»£ç é‡å°‘ï¼Œæ— é¢å¤–ä¾èµ–ï¼Œæ¥å…¥æˆæœ¬æä½ï¼›</li>
<li><strong>ä¸°å¯Œçš„é‡è¯•ç­–ç•¥</strong>ï¼šå†…ç½®å›ºå®šé—´éš”ã€æŒ‡æ•°é€€é¿ã€æŠ–åŠ¨é€€é¿ç­‰å¸¸ç”¨ç­–ç•¥ï¼Œæ”¯æŒè‡ªå®šä¹‰æ‰©å±•ï¼›</li>
<li><strong>çµæ´»çš„ç»ˆæ­¢æ¡ä»¶</strong>ï¼šæ”¯æŒæœ€å¤§é‡è¯•æ¬¡æ•°ã€è¶…æ—¶æ—¶é—´ã€è‡ªå®šä¹‰é€€å‡ºåˆ¤æ–­ç­‰å¤šé‡ç»ˆæ­¢è§„åˆ™ï¼›</li>
<li><strong>ä¼˜é›…çš„é”™è¯¯å¤„ç†</strong>ï¼šæ¸…æ™°åŒºåˆ†é‡è¯•é”™è¯¯å’Œæœ€ç»ˆå¤±è´¥ï¼Œæ”¯æŒé”™è¯¯è¿‡æ»¤ï¼ˆä»…é‡è¯•ç‰¹å®šé”™è¯¯ï¼‰ï¼›</li>
<li><strong>ä¸Šä¸‹æ–‡æ”¯æŒ</strong>ï¼šæ·±åº¦é›†æˆ <code>context.Context</code>ï¼Œæ”¯æŒå–æ¶ˆä¿¡å·å’Œè¶…æ—¶æ§åˆ¶ï¼Œç¬¦åˆ Go æœ€ä½³å®è·µï¼›</li>
<li><strong>å¹¶å‘å®‰å…¨</strong>ï¼šæ ¸å¿ƒç»„ä»¶å¯å®‰å…¨åœ°åœ¨å¤šä¸ª goroutine ä¸­å¤ç”¨ã€‚</li>
</ol>
<h2 data-id="heading-1">äºŒã€å¿«é€Ÿå…¥é—¨ï¼š5 åˆ†é’Ÿå®ç°åŸºç¡€é‡è¯•</h2>
<h3 data-id="heading-2">2.1 å®‰è£…ä¾èµ–</h3>
<p>é¦–å…ˆé€šè¿‡ <code>go get</code> å®‰è£…åº“ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">go get github.com/sethvargo/go-retry@latest
</code></pre>
<h3 data-id="heading-3">2.2 åŸºç¡€ç¤ºä¾‹ï¼šé‡è¯• HTTP è¯·æ±‚</h3>
<p>ä¸‹é¢ä»¥â€œé‡è¯•è°ƒç”¨ä¸€ä¸ªä¸ç¨³å®šçš„ APIâ€ä¸ºä¾‹ï¼Œå±•ç¤ºæœ€åŸºç¡€çš„é‡è¯•é€»è¾‘ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"context"</span>
	<span class="hljs-string">"fmt"</span>
	<span class="hljs-string">"net/http"</span>
	<span class="hljs-string">"time"</span>

	retry <span class="hljs-string">"github.com/sethvargo/go-retry"</span>
)

<span class="hljs-comment">// æ¨¡æ‹Ÿä¸ç¨³å®šçš„ API è°ƒç”¨</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">callUnstableAPI</span><span class="hljs-params">()</span></span> <span class="hljs-type">error</span> {
	resp, err := http.Get(<span class="hljs-string">"https://api.example.com/unstable"</span>)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		fmt.Println(<span class="hljs-string">"API è°ƒç”¨å¤±è´¥:"</span>, err)
		<span class="hljs-keyword">return</span> err <span class="hljs-comment">// ç½‘ç»œé”™è¯¯ï¼Œå¯é‡è¯•</span>
	}
	<span class="hljs-keyword">defer</span> resp.Body.Close()

	<span class="hljs-keyword">if</span> resp.StatusCode != http.StatusOK {
		fmt.Printf(<span class="hljs-string">"API è¿”å›é 200 çŠ¶æ€ç : %d\n"</span>, resp.StatusCode)
		<span class="hljs-keyword">return</span> fmt.Errorf(<span class="hljs-string">"status code: %d"</span>, resp.StatusCode) <span class="hljs-comment">// é 200 å¯é‡è¯•</span>
	}

	fmt.Println(<span class="hljs-string">"API è°ƒç”¨æˆåŠŸ!"</span>)
	<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
	<span class="hljs-comment">// 1. åˆ›å»ºä¸Šä¸‹æ–‡ï¼ˆæ”¯æŒè¶…æ—¶/å–æ¶ˆï¼‰</span>
	ctx, cancel := context.WithTimeout(context.Background(), <span class="hljs-number">30</span>*time.Second)
	<span class="hljs-keyword">defer</span> cancel()

	<span class="hljs-comment">// 2. å®šä¹‰é‡è¯•ç­–ç•¥ï¼šå›ºå®šé—´éš” 2 ç§’ï¼Œæœ€å¤šé‡è¯• 5 æ¬¡</span>
	<span class="hljs-comment">// ConstantBackoff(é—´éš”) + LimitMaxRetries(æœ€å¤§æ¬¡æ•°)</span>
	strategy := retry.WithMaxRetries(<span class="hljs-number">5</span>, retry.ConstantBackoff(<span class="hljs-number">2</span>*time.Second))

	<span class="hljs-comment">// 3. æ‰§è¡Œé‡è¯•é€»è¾‘</span>
	err := retry.Do(ctx, strategy, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context)</span></span> <span class="hljs-type">error</span> {
		err := callUnstableAPI()
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
			<span class="hljs-comment">// æ ‡è®°é”™è¯¯ä¸ºâ€œå¯é‡è¯•â€ï¼Œè§¦å‘ä¸‹ä¸€æ¬¡é‡è¯•</span>
			<span class="hljs-keyword">return</span> retry.RetryableError(err)
		}
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span> <span class="hljs-comment">// æˆåŠŸåˆ™ç»ˆæ­¢é‡è¯•</span>
	})

	<span class="hljs-comment">// 4. å¤„ç†æœ€ç»ˆç»“æœ</span>
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		fmt.Printf(<span class="hljs-string">"æ‰€æœ‰é‡è¯•å¤±è´¥: %v\n"</span>, err)
		<span class="hljs-keyword">return</span>
	}
	fmt.Println(<span class="hljs-string">"é‡è¯•æµç¨‹æ­£å¸¸ç»“æŸ"</span>)
}
</code></pre>
<h3 data-id="heading-4">æ ¸å¿ƒæ¦‚å¿µè§£æ</h3>
<ol>
<li><strong>Strategyï¼ˆé‡è¯•ç­–ç•¥ï¼‰</strong>ï¼šå®šä¹‰â€œä½•æ—¶é‡è¯•â€ï¼Œå¦‚å›ºå®šé—´éš”ã€æŒ‡æ•°é€€é¿ç­‰ï¼Œæ˜¯ <code>go-retry</code> çš„æ ¸å¿ƒæ¥å£ï¼›</li>
<li><strong>RetryableError</strong>ï¼šåŒ…è£…é”™è¯¯ï¼Œæ ‡è®°è¯¥é”™è¯¯æ˜¯â€œå¯é‡è¯•â€çš„ï¼Œè‹¥è¿”å›æ™®é€šé”™è¯¯åˆ™ç›´æ¥ç»ˆæ­¢é‡è¯•ï¼›</li>
<li><strong>Context</strong>ï¼šä¼ é€’è¶…æ—¶ã€å–æ¶ˆä¿¡å·ï¼Œç¡®ä¿é‡è¯•é€»è¾‘èƒ½å“åº”å¤–éƒ¨æ§åˆ¶ï¼ˆå¦‚ç”¨æˆ·ä¸­æ–­ã€æœåŠ¡å…³é—­ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-5">ä¸‰ã€è¿›é˜¶ç”¨æ³•ï¼šæ‰“é€ ç”Ÿäº§çº§é‡è¯•é€»è¾‘</h2>
<h3 data-id="heading-6">3.1 é€‰æ‹©åˆé€‚çš„é‡è¯•ç­–ç•¥</h3>
<p><code>go-retry</code> å†…ç½®äº† 4 ç§å¸¸ç”¨ç­–ç•¥ï¼Œå¯æ ¹æ®åœºæ™¯ç»„åˆä½¿ç”¨ï¼š</p>
<h4 data-id="heading-7">1. å›ºå®šé—´éš”é‡è¯•ï¼ˆConstantBackoffï¼‰</h4>
<p>é€‚ç”¨äºæœåŠ¡æ¢å¤æ—¶é—´å¯é¢„æµ‹çš„åœºæ™¯ï¼ˆå¦‚æ•°æ®åº“é‡å¯ï¼‰ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// æ¯æ¬¡é‡è¯•é—´éš” 1 ç§’ï¼Œæœ€å¤šé‡è¯• 3 æ¬¡</span>
strategy := retry.WithMaxRetries(<span class="hljs-number">3</span>, retry.ConstantBackoff(<span class="hljs-number">1</span>*time.Second))
</code></pre>
<h4 data-id="heading-8">2. æŒ‡æ•°é€€é¿é‡è¯•ï¼ˆExponentialBackoffï¼‰</h4>
<p>é€‚ç”¨äºé«˜å¹¶å‘åœºæ™¯ï¼Œé¿å…é‡è¯•é£æš´ï¼ˆé—´éš”éšé‡è¯•æ¬¡æ•°æŒ‡æ•°å¢é•¿ï¼‰ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åˆå§‹é—´éš” 1 ç§’ï¼Œæœ€å¤§é—´éš” 10 ç§’ï¼Œæœ€å¤šé‡è¯• 5 æ¬¡</span>
<span class="hljs-comment">// é—´éš”ï¼š1s â†’ 2s â†’ 4s â†’ 8s â†’ 10sï¼ˆåç»­ä¿æŒ 10sï¼‰</span>
strategy := retry.WithMaxRetries(<span class="hljs-number">5</span>, retry.ExponentialBackoff(<span class="hljs-number">1</span>*time.Second, <span class="hljs-number">10</span>*time.Second))
</code></pre>
<h4 data-id="heading-9">3. æŠ–åŠ¨é€€é¿ï¼ˆJitterï¼‰</h4>
<p>åœ¨æŒ‡æ•°é€€é¿åŸºç¡€ä¸Šæ·»åŠ éšæœºæŠ–åŠ¨ï¼Œè¿›ä¸€æ­¥åˆ†æ•£é‡è¯•è¯·æ±‚ï¼Œé¿å…â€œå³°å€¼åŒæ—¶é‡è¯•â€ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// æŒ‡æ•°é€€é¿ + æŠ–åŠ¨ï¼Œåˆå§‹ 1sï¼Œæœ€å¤§ 10sï¼Œæœ€å¤š 5 æ¬¡</span>
strategy := retry.WithMaxRetries(<span class="hljs-number">5</span>, retry.Jitter(retry.ExponentialBackoff(<span class="hljs-number">1</span>*time.Second, <span class="hljs-number">10</span>*time.Second), <span class="hljs-number">0.5</span>))
<span class="hljs-comment">// ç¬¬äºŒä¸ªå‚æ•°æ˜¯æŠ–åŠ¨å› å­ï¼ˆ0-1ï¼‰ï¼Œå› å­è¶Šå¤§ï¼Œéšæœºæ³¢åŠ¨è¶Šæ˜æ˜¾</span>
</code></pre>
<h4 data-id="heading-10">4. çº¿æ€§é€€é¿ï¼ˆLinearBackoffï¼‰</h4>
<p>é—´éš”éšé‡è¯•æ¬¡æ•°çº¿æ€§å¢é•¿ï¼ˆå¦‚ 1s â†’ 2s â†’ 3sï¼‰ï¼Œé€‚ç”¨äºæœåŠ¡æ¢å¤æ—¶é—´ç¼“æ…¢å¢é•¿çš„åœºæ™¯ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åˆå§‹é—´éš” 1sï¼Œæ¯æ¬¡å¢åŠ  1sï¼Œæœ€å¤§é—´éš” 5sï¼Œæœ€å¤šé‡è¯• 4 æ¬¡</span>
strategy := retry.WithMaxRetries(<span class="hljs-number">4</span>, retry.LinearBackoff(<span class="hljs-number">1</span>*time.Second, <span class="hljs-number">1</span>*time.Second, <span class="hljs-number">5</span>*time.Second))
</code></pre>
<h3 data-id="heading-11">3.2 è¿‡æ»¤å¯é‡è¯•é”™è¯¯</h3>
<p>å®é™…åœºæ™¯ä¸­ï¼Œå¹¶éæ‰€æœ‰é”™è¯¯éƒ½éœ€è¦é‡è¯•ï¼ˆå¦‚å‚æ•°é”™è¯¯ã€404 ç­‰ï¼‰ï¼Œå¯é€šè¿‡ <code>retry.If</code> è¿‡æ»¤ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
	ctx, cancel := context.WithTimeout(context.Background(), <span class="hljs-number">30</span>*time.Second)
	<span class="hljs-keyword">defer</span> cancel()

	<span class="hljs-comment">// ä»…é‡è¯•â€œç½‘ç»œé”™è¯¯â€å’Œâ€œ5xx çŠ¶æ€ç é”™è¯¯â€</span>
	strategy := retry.WithMaxRetries(<span class="hljs-number">5</span>, retry.ConstantBackoff(<span class="hljs-number">2</span>*time.Second))

	err := retry.Do(ctx, strategy, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context)</span></span> <span class="hljs-type">error</span> {
		err := callUnstableAPI()
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
			<span class="hljs-comment">// è‡ªå®šä¹‰è¿‡æ»¤é€»è¾‘ï¼šåˆ¤æ–­é”™è¯¯ç±»å‹æ˜¯å¦å¯é‡è¯•</span>
			<span class="hljs-keyword">if</span> isRetryableError(err) {
				<span class="hljs-keyword">return</span> retry.RetryableError(err)
			}
			<span class="hljs-keyword">return</span> err <span class="hljs-comment">// ä¸å¯é‡è¯•é”™è¯¯ï¼Œç›´æ¥ç»ˆæ­¢</span>
		}
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
	})

	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		fmt.Printf(<span class="hljs-string">"æœ€ç»ˆå¤±è´¥: %v\n"</span>, err)
	}
}

<span class="hljs-comment">// å®šä¹‰å¯é‡è¯•é”™è¯¯çš„åˆ¤æ–­é€»è¾‘</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">isRetryableError</span><span class="hljs-params">(err <span class="hljs-type">error</span>)</span></span> <span class="hljs-type">bool</span> {
	<span class="hljs-comment">// ç½‘ç»œé”™è¯¯ï¼ˆå¦‚è¿æ¥è¶…æ—¶ã€æ‹’ç»è¿æ¥ï¼‰</span>
	<span class="hljs-keyword">if</span> _, ok := err.(*http.Error); ok {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
	}
	<span class="hljs-comment">// 5xx çŠ¶æ€ç é”™è¯¯</span>
	<span class="hljs-keyword">if</span> err.Error()[:<span class="hljs-number">3</span>] == <span class="hljs-string">"500"</span> || err.Error()[:<span class="hljs-number">3</span>] == <span class="hljs-string">"503"</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
	}
	<span class="hljs-comment">// å…¶ä»–é”™è¯¯ï¼ˆå¦‚ 400ã€404ï¼‰ä¸å¯é‡è¯•</span>
	<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
}
</code></pre>
<h3 data-id="heading-12">3.3 ç»“åˆè¶…æ—¶å’Œå–æ¶ˆä¿¡å·</h3>
<p>é€šè¿‡ <code>context</code> å®ç°å¤šé‡æ§åˆ¶ï¼šè¶…æ—¶æ—¶é—´ï¼ˆæ•´ä½“é‡è¯•æµç¨‹çš„æœ€å¤§è€—æ—¶ï¼‰ã€æ‰‹åŠ¨å–æ¶ˆï¼ˆå¦‚ç”¨æˆ·ä¸­æ–­ï¼‰ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
	<span class="hljs-comment">// 1. è®¾ç½®æ•´ä½“è¶…æ—¶ 15 ç§’</span>
	ctx, cancel := context.WithTimeout(context.Background(), <span class="hljs-number">15</span>*time.Second)
	<span class="hljs-keyword">defer</span> cancel()

	<span class="hljs-comment">// 2. å¯åŠ¨ä¸€ä¸ª goroutineï¼Œæ¨¡æ‹Ÿç”¨æˆ·æ‰‹åŠ¨å–æ¶ˆï¼ˆ5 ç§’åï¼‰</span>
	<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
		time.Sleep(<span class="hljs-number">5</span> * time.Second)
		fmt.Println(<span class="hljs-string">"ç”¨æˆ·æ‰‹åŠ¨å–æ¶ˆé‡è¯•"</span>)
		cancel()
	}()

	<span class="hljs-comment">// 3. é‡è¯•ç­–ç•¥ï¼šæŒ‡æ•°é€€é¿ï¼Œæœ€å¤š 10 æ¬¡ï¼ˆä½†ä¼šè¢«è¶…æ—¶/å–æ¶ˆä¸­æ–­ï¼‰</span>
	strategy := retry.WithMaxRetries(<span class="hljs-number">10</span>, retry.ExponentialBackoff(<span class="hljs-number">1</span>*time.Second, <span class="hljs-number">5</span>*time.Second))

	err := retry.Do(ctx, strategy, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context)</span></span> <span class="hljs-type">error</span> {
		<span class="hljs-comment">// æ£€æŸ¥ä¸Šä¸‹æ–‡æ˜¯å¦å·²å–æ¶ˆ/è¶…æ—¶</span>
		<span class="hljs-keyword">select</span> {
		<span class="hljs-keyword">case</span> &lt;-ctx.Done():
			<span class="hljs-keyword">return</span> ctx.Err() <span class="hljs-comment">// ä¼ é€’å–æ¶ˆä¿¡å·</span>
		<span class="hljs-keyword">default</span>:
		}

		<span class="hljs-keyword">return</span> retry.RetryableError(callUnstableAPI())
	})

	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		fmt.Printf(<span class="hljs-string">"é‡è¯•ç»ˆæ­¢: %v\n"</span>, err) <span class="hljs-comment">// å¯èƒ½æ˜¯è¶…æ—¶æˆ–å–æ¶ˆé”™è¯¯</span>
	}
}
</code></pre>
<h3 data-id="heading-13">3.4 è‡ªå®šä¹‰é‡è¯•ç­–ç•¥</h3>
<p>å¦‚æœå†…ç½®ç­–ç•¥ä¸æ»¡è¶³éœ€æ±‚ï¼Œå¯é€šè¿‡å®ç° <code>retry.Strategy</code> æ¥å£è‡ªå®šä¹‰ç­–ç•¥ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// è‡ªå®šä¹‰ç­–ç•¥ï¼šå‰ 3 æ¬¡é—´éš” 1 ç§’ï¼Œä¹‹åé—´éš” 3 ç§’</span>
<span class="hljs-keyword">type</span> CustomStrategy <span class="hljs-keyword">struct</span> {
	maxRetries <span class="hljs-type">int</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *CustomStrategy)</span></span> NextRetry(ctx context.Context, attempt <span class="hljs-type">int</span>) (time.Duration, <span class="hljs-type">error</span>) {
	<span class="hljs-comment">// attempt æ˜¯å·²é‡è¯•æ¬¡æ•°ï¼ˆä» 0 å¼€å§‹ï¼‰</span>
	<span class="hljs-keyword">if</span> attempt &gt;= s.maxRetries {
		<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, retry.ErrMaxRetriesExceeded <span class="hljs-comment">// è¾¾åˆ°æœ€å¤§æ¬¡æ•°ï¼Œç»ˆæ­¢</span>
	}

	<span class="hljs-comment">// å‰ 3 æ¬¡é—´éš” 1sï¼Œä¹‹å 3s</span>
	<span class="hljs-keyword">if</span> attempt &lt; <span class="hljs-number">3</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-number">1</span> * time.Second, <span class="hljs-literal">nil</span>
	}
	<span class="hljs-keyword">return</span> <span class="hljs-number">3</span> * time.Second, <span class="hljs-literal">nil</span>
}

<span class="hljs-comment">// ä½¿ç”¨è‡ªå®šä¹‰ç­–ç•¥</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
	ctx := context.Background()
	strategy := &amp;CustomStrategy{maxRetries: <span class="hljs-number">5</span>}

	err := retry.Do(ctx, strategy, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context)</span></span> <span class="hljs-type">error</span> {
		<span class="hljs-keyword">return</span> retry.RetryableError(callUnstableAPI())
	})
}
</code></pre>
<h3 data-id="heading-14">3.5 é‡è¯•è¿‡ç¨‹ç›‘æ§</h3>
<p>é€šè¿‡ <code>retry.WithCallback</code> è®°å½•é‡è¯•è¿‡ç¨‹ï¼ˆå¦‚æ—¥å¿—ã€æŒ‡æ ‡ä¸ŠæŠ¥ï¼‰ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
	ctx := context.Background()

	<span class="hljs-comment">// æ·»åŠ å›è°ƒå‡½æ•°ï¼Œç›‘æ§æ¯æ¬¡é‡è¯•</span>
	strategy := retry.WithCallback(
		retry.WithMaxRetries(<span class="hljs-number">5</span>, retry.ConstantBackoff(<span class="hljs-number">2</span>*time.Second)),
		<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context, attempt <span class="hljs-type">int</span>, err <span class="hljs-type">error</span>, next time.Duration)</span></span> {
			fmt.Printf(<span class="hljs-string">"ç¬¬ %d æ¬¡é‡è¯•å¤±è´¥: %vï¼Œä¸‹æ¬¡é‡è¯•é—´éš” %v\n"</span>, attempt+<span class="hljs-number">1</span>, err, next)
			<span class="hljs-comment">// æ­¤å¤„å¯æ·»åŠ æŒ‡æ ‡ä¸ŠæŠ¥ï¼ˆå¦‚ Prometheus è®¡æ•°å™¨ï¼‰</span>
			<span class="hljs-comment">// retryTotal.WithLabelValues("api").Inc()</span>
		},
	)

	err := retry.Do(ctx, strategy, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(ctx context.Context)</span></span> <span class="hljs-type">error</span> {
		<span class="hljs-keyword">return</span> retry.RetryableError(callUnstableAPI())
	})
}
</code></pre>
<h2 data-id="heading-15">å››ã€æœ€ä½³å®è·µä¸é¿å‘æŒ‡å—</h2>
<h3 data-id="heading-16">4.1 æœ€ä½³å®è·µ</h3>
<ol>
<li><strong>æ˜ç¡®å¯é‡è¯•åœºæ™¯</strong>ï¼šä»…å¯¹â€œæš‚æ—¶æ€§é”™è¯¯â€é‡è¯•ï¼ˆå¦‚ç½‘ç»œæŠ–åŠ¨ã€5xx æœåŠ¡é”™è¯¯ã€æ•°æ®åº“é”ç­‰å¾…ï¼‰ï¼Œé¿å…å¯¹â€œæ°¸ä¹…æ€§é”™è¯¯â€ï¼ˆå¦‚å‚æ•°é”™è¯¯ã€404ï¼‰é‡è¯•ï¼›</li>
<li><strong>æ§åˆ¶é‡è¯•å¼ºåº¦</strong>ï¼šç»“åˆ <code>WithMaxRetries</code> å’Œ <code>context.WithTimeout</code>ï¼Œé¿å…æ— é™é‡è¯•å¯¼è‡´èµ„æºè€—å°½ï¼›</li>
<li><strong>ä½¿ç”¨é€€é¿+æŠ–åŠ¨</strong>ï¼šé«˜å¹¶å‘åœºæ™¯ä¼˜å…ˆé€‰æ‹©â€œæŒ‡æ•°é€€é¿+æŠ–åŠ¨â€ï¼Œå‡å°‘é‡è¯•é£æš´å¯¹ä¸‹æ¸¸æœåŠ¡çš„å‹åŠ›ï¼›</li>
<li><strong>é‡è¯•å‰æ£€æŸ¥ä¸Šä¸‹æ–‡</strong>ï¼šåœ¨é‡è¯•å‡½æ•°ä¸­ä¼˜å…ˆæ£€æŸ¥ <code>ctx.Done()</code>ï¼Œç¡®ä¿èƒ½åŠæ—¶å“åº”å–æ¶ˆ/è¶…æ—¶ä¿¡å·ï¼›</li>
<li><strong>ä¸è¦é‡è¯•å¹‚ç­‰æ“ä½œ</strong>ï¼šè‹¥æ“ä½œéå¹‚ç­‰ï¼ˆå¦‚é‡å¤åˆ›å»ºè®¢å•ï¼‰ï¼Œéœ€å…ˆä¿è¯æ¥å£å¹‚ç­‰æ€§ï¼Œæˆ–é€šè¿‡å”¯ä¸€æ ‡è¯†é¿å…é‡å¤æ‰§è¡Œï¼›</li>
<li><strong>è®°å½•é‡è¯•æ—¥å¿—</strong>ï¼šé€šè¿‡ <code>WithCallback</code> è®°å½•é‡è¯•æ¬¡æ•°ã€é”™è¯¯ä¿¡æ¯ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥ã€‚</li>
</ol>
<h3 data-id="heading-17">4.2 å¸¸è§å‘ç‚¹</h3>
<ol>
<li><strong>å¿˜è®°æ ‡è®° RetryableError</strong>ï¼šè‹¥è¿”å›æ™®é€šé”™è¯¯ï¼Œé‡è¯•ä¼šç›´æ¥ç»ˆæ­¢ï¼Œéœ€ç¡®ä¿å¯é‡è¯•é”™è¯¯è¢« <code>retry.RetryableError</code> åŒ…è£…ï¼›</li>
<li><strong>å¿½ç•¥ä¸Šä¸‹æ–‡å–æ¶ˆ</strong>ï¼šæœªåœ¨é‡è¯•å‡½æ•°ä¸­æ£€æŸ¥ <code>ctx.Done()</code>ï¼Œå¯èƒ½å¯¼è‡´é‡è¯•é€»è¾‘æ— æ³•åŠæ—¶ç»ˆæ­¢ï¼›</li>
<li><strong>é‡è¯•ç­–ç•¥è¿‡äºæ¿€è¿›</strong>ï¼šå›ºå®šé—´éš”+é«˜é‡è¯•æ¬¡æ•°ï¼Œå¯èƒ½åŠ å‰§ä¸‹æ¸¸æœåŠ¡å‹åŠ›ï¼Œå¼•å‘é›ªå´©ï¼›</li>
<li><strong>æœªå¤„ç†é‡è¯•ä¸­çš„èµ„æºæ³„æ¼</strong>ï¼šå¦‚é‡è¯• HTTP è¯·æ±‚æ—¶æœªå…³é—­ <code>resp.Body</code>ï¼Œéœ€åœ¨ <code>defer</code> ä¸­ç¡®ä¿èµ„æºé‡Šæ”¾ï¼›</li>
<li><strong>æ··æ·†â€œé‡è¯•æ¬¡æ•°â€å’Œâ€œå°è¯•æ¬¡æ•°â€</strong>ï¼š<code>WithMaxRetries(5)</code> è¡¨ç¤ºâ€œæœ€å¤šé‡è¯• 5 æ¬¡â€ï¼Œå³â€œæ€»å…±å°è¯• 6 æ¬¡â€ï¼ˆåˆå§‹ 1 æ¬¡ + é‡è¯• 5 æ¬¡ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-18">äº”ã€æ€»ç»“</h2>
<p><code>sethvargo/go-retry</code> ä»¥å…¶è½»é‡ã€çµæ´»ã€è´´åˆ Go ç”Ÿæ€çš„è®¾è®¡ï¼Œæˆä¸º Go è¯­è¨€é‡è¯•æœºåˆ¶çš„é¦–é€‰åº“ã€‚é€šè¿‡æœ¬æ–‡çš„è®²è§£ï¼Œä½ å¯ä»¥æŒæ¡ï¼š</p>
<ul>
<li>åŸºç¡€é‡è¯•é€»è¾‘çš„å¿«é€Ÿå®ç°ï¼›</li>
<li>å¤šç§é‡è¯•ç­–ç•¥çš„é€‰å‹ä¸ç»„åˆï¼›</li>
<li>è¿‡æ»¤å¯é‡è¯•é”™è¯¯ã€ç›‘æ§é‡è¯•è¿‡ç¨‹ã€å“åº”å–æ¶ˆä¿¡å·ç­‰è¿›é˜¶ç”¨æ³•ï¼›</li>
<li>ç”Ÿäº§ç¯å¢ƒä¸­çš„æœ€ä½³å®è·µä¸é¿å‘è¦ç‚¹ã€‚</li>
</ul>
<p>é‡è¯•æœºåˆ¶æ˜¯ç³»ç»Ÿå®¹é”™èƒ½åŠ›çš„åŸºç¡€ï¼Œä½†å®ƒä¸æ˜¯é“¶å¼¹â€”â€”éœ€ç»“åˆä¸šåŠ¡åœºæ™¯åˆç†è®¾è®¡ç­–ç•¥ï¼ŒåŒæ—¶æ­é…ç†”æ–­ã€é™æµã€é™çº§ç­‰æœºåˆ¶ï¼Œæ‰èƒ½æ„å»ºçœŸæ­£é«˜å¯ç”¨çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚å¦‚æœä½ æ­£åœ¨å¼€å‘éœ€è¦å®¹é”™çš„ Go åº”ç”¨ï¼Œä¸å¦¨è¯•è¯• <code>go-retry</code>ï¼Œå®ƒä¼šè®©é‡è¯•é€»è¾‘çš„ç¼–å†™å˜å¾—ç®€æ´è€Œå¯é ã€‚</p>
<h2 data-id="heading-19">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsethvargo%2Fgo-retry" target="_blank" title="https://github.com/sethvargo/go-retry" ref="nofollow noopener noreferrer">go-retry å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fpkg.go.dev%2Fcontext" target="_blank" title="https://pkg.go.dev/context" ref="nofollow noopener noreferrer">Go å®˜æ–¹ Context æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmartinfowler.com%2Farticles%2Fpatterns-of-distributed-systems%2F" target="_blank" title="https://martinfowler.com/articles/patterns-of-distributed-systems/" ref="nofollow noopener noreferrer">åˆ†å¸ƒå¼ç³»ç»Ÿå®¹é”™è®¾è®¡åŸåˆ™</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æˆ‘çš„ starship ç»ˆç«¯é…ç½®]]></title>    <link>https://juejin.cn/post/7573952825953484863</link>    <guid>https://juejin.cn/post/7573952825953484863</guid>    <pubDate>2025-11-19T01:12:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7573952825953484863" data-draft-id="7568461955015933971" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æˆ‘çš„ starship ç»ˆç«¯é…ç½®"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-19T01:12:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Legend80s"/> <meta itemprop="url" content="https://juejin.cn/user/2568105753839790"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æˆ‘çš„ starship ç»ˆç«¯é…ç½®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2568105753839790/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Legend80s
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T01:12:46.000Z" title="Wed Nov 19 2025 01:12:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸Šä¸€ç¯‡æ–‡ç« ã€Š<strong>åˆ«å†ç¤¾æ­»äº†ï¼<code>includeIf</code> ä¸€æ‹›æå®š Git æäº¤è€…ä¿¡æ¯é”™ä¹±ï¼Œå®ˆæŠ¤ä½ çš„é‚®ç®±éšç§</strong>ã€‹æˆ‘ä»¬é€šè¿‡å·§å¦™çš„ git é…ç½®è®©è¿›å…¥ä¸åŒç›®å½•èƒ½è‡ªåŠ¨åˆ‡æ¢å¯¹åº”çš„ç”¨æˆ·åå’Œé‚®ç®±ï¼Œä»æ ¹æºä¸Šæœç»äº† git æäº¤ä½œè€…æ··ä¹±é—®é¢˜ã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬ç›´æ¥è®© git ç”¨æˆ·åå’Œé‚®ç®±åœ¨ç»ˆç«¯æ˜¾ç¤ºï¼Œæ›´åŠ ä¸€ç›®äº†ç„¶ï¼Œé…ç½®æ•ˆæœå¤§æ¦‚å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">â¯ nextjs-ecommerce on ğŸŒ± master [â‡¡] via <span class="hljs-title class_">Node</span>.<span class="hljs-property">js</span> v24<span class="hljs-number">.9</span><span class="hljs-number">.0</span> ğŸ‘¨ legend80s ğŸ’Œ legend80s<span class="hljs-meta">@example</span>.<span class="hljs-property">com</span>
</code></pre>
<p>å¦‚æœä½ æŒ‰ç…§ä¹‹å‰çš„æ–‡ç« é…ç½®è¿‡ git è‡ªåŠ¨åˆ‡æ¢ç”¨æˆ·åï¼Œç°åœ¨åˆ‡æ¢åˆ°å·¥ä½œç›®å½•å¯ä»¥çœ‹åˆ°ç”¨æˆ·åé‚®ç®±ä¹Ÿéšç€æ”¹å˜å¹¶ç›´è§‚å±•ç¤ºåœ¨ç»ˆç«¯ä¸Šã€‚éå¸¸ NICEï¼</p>
<h2 data-id="heading-0">å®‰è£… starship</h2>
<p>è¯¦è§å®˜ç½‘ <a href="https://link.juejin.cn?target=https%3A%2F%2Fstarship.rs%2F" target="_blank" title="https://starship.rs/" ref="nofollow noopener noreferrer">starship.rs/</a> ç•¥ã€‚</p>
<h2 data-id="heading-1">é…ç½®</h2>
<p>å®Œæ•´é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-comment"># ~/.config/starship.toml</span>
<span class="hljs-comment"># https://starship.rs/config/</span>

<span class="hljs-comment"># Get editor completions based on the config schema</span>
<span class="hljs-attr">"$schema"</span> = <span class="hljs-string">'https://starship.rs/config-schema.json'</span>

<span class="hljs-comment"># Inserts a blank line between shell prompts</span>
<span class="hljs-attr">add_newline</span> = <span class="hljs-literal">true</span>

<span class="hljs-section">[git_branch]</span>
<span class="hljs-attr">symbol</span> = <span class="hljs-string">'ğŸŒ± '</span>

<span class="hljs-section">[nodejs]</span>
<span class="hljs-attr">format</span> = <span class="hljs-string">'via [Node.js $version](bold green) '</span>

<span class="hljs-section">[custom.git_user]</span>
<span class="hljs-attr">command</span> = <span class="hljs-string">"echo \"ğŸ‘¨ $(git config user.name) ğŸ’Œ $(git config user.email)\""</span>
<span class="hljs-attr">shell</span> = [<span class="hljs-string">"bash"</span>, <span class="hljs-string">"--noprofile"</span>, <span class="hljs-string">"--norc"</span>]
<span class="hljs-attr">style</span> = <span class="hljs-string">"bold yellow"</span>
<span class="hljs-attr">when</span> = <span class="hljs-string">"git rev-parse --is-inside-work-tree 2&gt;/dev/null"</span>
</code></pre>
<h3 data-id="heading-2">è§£é‡Š</h3>
<ul>
<li><code>"$schema" = 'https://starship.rs/config-schema.json'</code> æ˜¯ä¸ºäº†è®©æ¥ä¸‹æ¥çš„é…ç½®èƒ½è‡ªåŠ¨è¡¥å…¨ã€‚</li>
<li><code>add_newline = true</code> å‰åå‘½ä»¤è¡Œä¹‹é—´å¢åŠ ç©ºè¡Œï¼Œç»™äºˆå‘¼å¸ç©ºé—´ã€‚</li>
<li><code>[git_branch] symbol = 'ğŸŒ±</code> ç»™åˆ†æ”¯å¢åŠ  emojiï¼Œå¯ä»¥æ¢æˆä»»æ„ä½ å–œæ¬¢çš„ emojiã€‚<em>å¦‚æœä¸æ”¹å¿…é¡»å®‰è£… nerd å­—ä½“ï¼Œå¦åˆ™æ˜¾ç¤ºä¹±ç ã€‚</em></li>
<li><code>format = 'via [Node.js $version](bold green) '</code> ç»¿è‰²åŠ ç²—æ˜¾ç¤º Node.js ç‰ˆæœ¬å·ï¼š<strong>Via Node.js v24.x.x</strong>ã€‚ä½ å¯ä»¥æ”¹æˆä»»æ„ä»£è¡¨ Node.js çš„ emoji æ¯”å¦‚ ğŸŸ¢ã€‚<em>å¦‚æœä¸æ”¹å¿…é¡»å®‰è£… nerd å­—ä½“ï¼Œå¦åˆ™æ˜¾ç¤ºä¹±ç ã€‚</em>
<ul>
<li>ç®€æ´é…ç½®ï¼š<code>format = '[ğŸŸ¢ $version](bold green) '</code>ã€‚æ•ˆæœï¼š <code>nextjs-ecommerce on ğŸŒ± master [â‡¡] ğŸŸ¢ v24.9.0 </code></li>
</ul>
</li>
</ul>
<p>æ¥ä¸‹æ¥æ˜¯é…ç½® git ç”¨æˆ·åå’Œé‚®ç®±ï¼Œä¹Ÿæ˜¯æœ¬æ–‡çš„é‡ç‚¹ã€‚</p>
<h4 data-id="heading-3">æ˜¾ç¤º git user å’Œ email</h4>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[custom.git_user]</span>
<span class="hljs-attr">command</span> = <span class="hljs-string">"echo \"ğŸ‘¨ $(git config user.name) ğŸ’Œ $(git config user.email)\""</span>
<span class="hljs-attr">shell</span> = [<span class="hljs-string">"bash"</span>, <span class="hljs-string">"--noprofile"</span>, <span class="hljs-string">"--norc"</span>]
<span class="hljs-attr">style</span> = <span class="hljs-string">"bold yellow"</span>
<span class="hljs-comment"># format = "[$output]($style) "</span>
<span class="hljs-attr">when</span> = <span class="hljs-string">"git rev-parse --is-inside-work-tree 2&gt;/dev/null"</span>
</code></pre>
<h5 data-id="heading-4">è§£é‡Š</h5>
<p>custom è¡¨ç¤ºè‡ªå®šä¹‰é…ç½®</p>
<ul>
<li><code>command</code> è¡¨ç¤º starship å°†æ‰§è¡Œè¯¥å‘½ä»¤æ¥å±•ç¤ºä¿¡æ¯ã€‚æˆ‘ä»¬é…ç½®<code>echo \"ğŸ‘¨ $(git config user.name) ğŸ’Œ $(git config user.email)\"</code>è®©å…¶æ˜¾ç¤ºç¾è§‚çš„ï¼š<strong><code>ğŸ‘¨ username ğŸ’Œ foo@example.com</code></strong>ã€‚</li>
<li><code>shell</code>ï¼šé‡‡ç”¨ä½•ç§è§£é‡Šå™¨è¿è¡Œ <code>command</code>ã€‚æŒ‡å®š bashï¼Œ<strong>ä¸ºäº†å…¼å®¹æ€§éœ€æŒ‡å®š</strong>å¦åˆ™ trae ä¸­å°†ä¸å±•ç¤ºï¼Œå› ä¸º trae é»˜è®¤ä½¿ç”¨ PowerShellã€‚</li>
<li><code>format</code>ï¼šstarship å›ºå®šæ ¼å¼ï¼Œ<code>$output</code> æ˜¯ <code>command</code> çš„è¾“å‡ºï¼Œ<code>$style</code> æ˜¯ <code>style</code> å†…å®¹ã€‚<em>å¯ä¸å†™</em>ã€‚</li>
<li><code>style</code>ï¼šåŠ ç²—é»„è‰²ï¼Œå› ä¸ºè¿™ä¸ªä¿¡æ¯æ¯”è¾ƒé‡è¦ï¼Œå½“ç„¶ä½ å¯ä»¥æ¢æˆå…¶ä»–é¢œè‰²ï¼Œæ¯”å¦‚ red æˆ– purpleï¼Œæˆ–ä½¿ç”¨å…¶ä»–æ ·å¼æ¯”å¦‚ underlineã€‚æ›´å¤šè¯¦è§å‚è€ƒé“¾æ¥ã€‚</li>
<li><code>when = "..."</code>ï¼šä½•æ—¶å±•ç¤ºï¼Œ<code>"true"</code> åˆ™å§‹ç»ˆå±•ç¤ºã€‚<code>git rev-parse --is-inside-work-tree 2&gt;/dev/null</code> åªåœ¨<strong>Git ä»“åº“ç›®å½•å†…ï¼ˆgit init è¿‡ï¼‰</strong> æ‰æ˜¾ç¤ºè¿™ä¸ªï¼Œ<code>2&gt;/dev/null</code> è¡¨ç¤ºå¿½ç•¥æŠ¥é”™ï¼ŒæŠ¥é”™ä¸è¾“å‡º true è‡ªç„¶ä¹Ÿä¸å±•ç¤ºã€‚</li>
</ul>
<p>æœ€ç»ˆæ•ˆæœ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e73303497c345b29e340169d12c0fe5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVnZW5kODBz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764119566&amp;x-signature=S%2F%2FF9ATgHGRLdrgUaNjHxShf68Q%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœå¤§å®¶è§‰å¾— Node.js ç‰ˆæœ¬å·å’Œç”¨æˆ·åä¹‹é—´ç©ºç™½å¤ªå¤šï¼Œå¯ä»¥ä½¿ç”¨ <code>\b</code> å›é€€ç¬¦ã€‚</p>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-addition">+ command = "echo \"\bğŸ‘¨ $(git config user.name) ğŸ’Œ $(git config user.email)\""</span>
</code></pre>
<p>å¦‚æœåœ¨å°å±å¹•ä¸Šå¯æ”¹æˆåªæ˜¾ç¤ºç”¨æˆ·åï¼ˆè¦æ˜¯èƒ½è‡ªé€‚åº”å°±å¥½äº†ï¼Œä½†ç¡®å®æ²¡æœ‰æ‰¾åˆ°åŠæ³• ğŸ¤·â€â™‚ï¸ï¼‰ï¼š</p>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-addition">+ command = "echo \"\bğŸ‘¨ $(git config user.name)\""</span>
</code></pre>
<p>å¯¹åº”é…ç½®ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-comment"># ~/.config/starship.toml</span>
<span class="hljs-comment"># https://starship.rs/config/</span>

<span class="hljs-comment"># Get editor completions based on the config schema</span>
<span class="hljs-attr">"$schema"</span> = <span class="hljs-string">'https://starship.rs/config-schema.json'</span>

<span class="hljs-comment"># Inserts a blank line between shell prompts</span>
<span class="hljs-attr">add_newline</span> = <span class="hljs-literal">true</span>

<span class="hljs-section">[git_branch]</span>
<span class="hljs-attr">symbol</span> = <span class="hljs-string">'ğŸŒ± '</span>

<span class="hljs-section">[nodejs]</span>
<span class="hljs-attr">format</span> = <span class="hljs-string">'[ğŸŸ¢ $version](bold green) '</span>

<span class="hljs-section">[custom.git_user]</span>
<span class="hljs-attr">command</span> = <span class="hljs-string">"echo \"\bğŸ‘¨ $(git config user.name) ğŸ’Œ $(git config user.email)\""</span>
<span class="hljs-attr">style</span> = <span class="hljs-string">"bold yellow"</span>
<span class="hljs-attr">when</span> = <span class="hljs-string">"git rev-parse --is-inside-work-tree 2&gt;/dev/null"</span>
</code></pre>
<blockquote>
<p>æ³¨æ„ä¿®æ”¹å®æ—¶ç”Ÿæ•ˆæ— éœ€é‡å¯ç»ˆç«¯ï¼Œåªéœ€ç»ˆç«¯æ‰§è¡Œä»»ä½•å‘½ä»¤æˆ–è€…æŒ‰ Enter å³å¯ã€‚</p>
</blockquote>
<h2 data-id="heading-5">å±•ç¤º npm registry</h2>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-addition">+ [custom.npm]</span>
<span class="hljs-addition">+ command = "registry=$(npm config get registry) &amp;&amp; echo \"${registry#*://}\""</span>
# when package.json exists
<span class="hljs-addition">+ when = "[[ -f package.json ]]"</span>
</code></pre>
<p>è¿™é‡Œå°† <code>https://registry.npmjs.org</code> æˆªçŸ­ä¸º <code>registry.npmjs.org</code>ï¼Œå¥½è®©ç©ºé—´å æ®å˜å°ï¼Œå½“ç„¶ä½ å¯ä»¥ä¸æˆªæ–­ï¼š<code>command = "npm config get registry"</code>ã€‚</p>
<p>å…¶æ¬¡åªæœ‰å½“å½“å‰ç›®å½•å­˜åœ¨ package.json <code>[[ -f package.json ]]</code> å³æ˜¯å‰ç«¯é¡¹ç›®æ‰å±•ç¤ºï¼Œå› ä¸ºå…¶ä»–é¡¹ç›®æ¯”å¦‚ Python æˆ– Golang é¡¹ç›®æˆ‘ä»¬å¹¶ä¸åœ¨æ„å½“å‰ npm çš„ registry æ˜¯ä»€ä¹ˆã€‚å¦‚æœå¤šæ–‡ä»¶å¯ç”¨ <code>detect_files = ["package.json"]</code>ã€‚</p>
<blockquote>
<p>[!TIPS]
å•æ–‡ä»¶ä¸ºä½•æ¨è <code>[[ -f package.json ]]</code> é¦–å…ˆ <code>[ -f package.json ]</code> ä¼šå”¤èµ·å¤–éƒ¨å‘½ä»¤å³æ–°è¿›ç¨‹ï¼Œæ€§èƒ½æ…¢ã€‚detect_files ä¸çŸ¥å…¶å®ç°ã€‚</p>
</blockquote>
<blockquote>
<p><em><code>[</code> æ˜¯å‘½ä»¤: æ–‡ä»¶ä½ç½® <code>/usr/bin/[</code>    è¿™ä¸ªå‘½ä»¤å¾ˆç‰¹æ®Š, ç»“å°¾åªèƒ½æ˜¯ <code>]</code> , æ‰€ä»¥æ„Ÿè§‰åƒé€»è¾‘åˆ¤æ–­ä¸€æ ·</em>ã€‚
<em><code>â¯ which [</code> å°†è¾“å‡º <strong>[: shell built-in command</strong> è¯´æ˜å®ƒå…¶å®å°±æ˜¯ä¸€ä¸ªå‘½ä»¤ã€‚</em></p>
<p><em>è‹±æ–‡ä»‹ç» <code>[</code>: <code>[ arg... ]</code> Evaluate conditional expression. This is a <strong>synonym for the "test"</strong> builtin, but the last argument <strong>must be a literal ']'</strong>, to match the opening '['.</em></p>
<p><em><code>test</code> ä¹Ÿæ˜¯å‘½ä»¤: <code>/usr/bin/test</code></em></p>
<p><em><code>[[</code> æ‰æ˜¯ bash çœŸæ­£çš„åˆ¤æ–­é€»è¾‘</em></p>
<p>æ¥è‡ªï¼š<strong>[ å’Œ [[ å’Œ test è°æ›´å¿«??</strong> - <a href="https://link.juejin.cn?target=http%3A%2F%2Fcloud.tencent.com%2Fdeveloper%2Farticle%2F1806703" target="_blank" title="http://cloud.tencent.com/developer/article/1806703" ref="nofollow noopener noreferrer">cloud.tencent.com/developer/aâ€¦</a></p>
<p>æ›´å¤šåŒºåˆ«ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fsegmentfault.com%2Fa%2F1190000022265700%23item-4-3" target="_blank" title="https://segmentfault.com/a/1190000022265700#item-4-3" ref="nofollow noopener noreferrer">segmentfault.com/a/119000002â€¦</a></p>
</blockquote>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cfd9fbbe5d304218a357ac66afcec7f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVnZW5kODBz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764119566&amp;x-signature=DEO2riU7J3urc%2Fi5FcBAPtyGn%2FE%3D" alt="[ å’Œ test é€Ÿåº¦ä¸€æ ·, [[ ç•¥èƒœä¸€ç­¹" loading="lazy"/></p>
<h4 data-id="heading-6">æ•ˆæœ</h4>
<pre><code class="hljs language-sh" lang="sh">nextjs-ecommerce on ğŸŒ± master [!â‡¡] ğŸŸ¢ v22.19.0 ğŸ‘¨ legend80s registry.npmjs.org took 5s
â¯ npm config <span class="hljs-built_in">set</span> registry https://registry.npmmirror.com <span class="hljs-comment"># åˆ‡æ¢</span>

nextjs-ecommerce on ğŸŒ± master [!â‡¡] ğŸŸ¢ v22.19.0 ğŸ‘¨ legend80s registry.npmmirror.com
</code></pre>
<p>å¯ä»¥çœ‹åˆ°å½“åˆ‡æ¢ registry åç›¸åº”ä¹Ÿå‘ç”Ÿäº†å˜åŒ– ğŸ‰ï¼</p>
<p>è¿›å…¥ä¸€ä¸ªéå‰ç«¯é¡¹ç›®ä¸å±•ç¤º registryã€‚</p>
<p><strong>æ³¨æ„ 1</strong>ï¼š</p>
<pre><code class="hljs language-diff" lang="diff"># å¦‚æœè¶…æ—¶å¯åŠ 
<span class="hljs-addition">+ command_timeout = 1500</span>
</code></pre>
<p><strong>æ³¨æ„ 2</strong>ï¼šåœ¨ Windows ä¸Šå¦‚æœå‘ç°ç»ˆç«¯enteråè¾ƒæ…¢å»ºè®®ä¸å±•ç¤º npm registryã€‚è€Œé‡‡ç”¨ä¸‹è¿° <code>gituser alias</code> æŒ‰éœ€æŸ¥çœ‹ã€‚</p>
<h2 data-id="heading-7">gituser alias</h2>
<p>æœ€åå†è´¡çŒ®ä¸€ä¸ª gituser alias å¦‚æœå¤§å®¶ä¸å–œæ¬¢åœ¨ç»ˆç«¯æ—¶åˆ»å±•ç¤ºè‡ªå·±çš„ç”¨æˆ·åé‚®ç®±ï¼Œå¯ä»¥é€šè¿‡è¯¥å‘½ä»¤è¿…é€ŸæŸ¥çœ‹ã€‚</p>
<p><strong>æ•ˆæœå¦‚ä¸‹ï¼š</strong></p>
<pre><code class="hljs language-ts" lang="ts"> nextjs-ecommerce on ğŸŒ± master [â‡¡] ğŸŸ¢ v24<span class="hljs-number">.9</span><span class="hljs-number">.0</span>  ğŸ‘¨ legend80s ğŸ’Œ liuchzong<span class="hljs-meta">@qq</span>.<span class="hljs-property">com</span> 
â¯ gituser

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¨ legend80s   â”‚ ğŸ’Œ liuchzong<span class="hljs-meta">@qq</span>.<span class="hljs-property">com</span>           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>åœ¨ <strong>~/.zshrc</strong> æ–‡ä»¶ä¸­å¢åŠ ä»¥ä¸‹ function å’Œ aliasï¼ˆfunction ä¹Ÿæ˜¯ä¸€ç§ alias å¯å…¨å±€è°ƒç”¨ï¼‰ï¼š</p>
<pre><code class="hljs language-sh" lang="sh">// ~/.zshrc

<span class="hljs-keyword">function</span> git-<span class="hljs-function"><span class="hljs-title">user</span></span>() {
  <span class="hljs-built_in">echo</span>
  <span class="hljs-built_in">echo</span> â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  <span class="hljs-built_in">echo</span> â”‚ <span class="hljs-string">"ğŸ‘¨ <span class="hljs-subst">$(git config user.name)</span>   â”‚ ğŸ’Œ <span class="hljs-subst">$(git config user.email)</span>            â”‚"</span>
  <span class="hljs-built_in">echo</span> â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  <span class="hljs-built_in">echo</span>
}
<span class="hljs-built_in">alias</span> gituser=<span class="hljs-string">"git-user"</span>
<span class="hljs-built_in">alias</span> current-git=<span class="hljs-string">"git-user"</span>
</code></pre>
<h2 data-id="heading-8">å‚è€ƒé“¾æ¥</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fstarship.rs%2Fadvanced-config%2F%23style-strings" target="_blank" title="https://starship.rs/advanced-config/#style-strings" ref="nofollow noopener noreferrer">starship.rs/advanced-coâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[5æ­¥æ„å»ºä¼ä¸šçº§RAGåº”ç”¨ï¼šDifyä¸LangChain v1.0é›†æˆå®æˆ˜]]></title>    <link>https://juejin.cn/post/7574041466710655019</link>    <guid>https://juejin.cn/post/7574041466710655019</guid>    <pubDate>2025-11-19T07:45:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574041466710655019" data-draft-id="7574069837532692516" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="5æ­¥æ„å»ºä¼ä¸šçº§RAGåº”ç”¨ï¼šDifyä¸LangChain v1.0é›†æˆå®æˆ˜"/> <meta itemprop="keywords" content="LangChain,LLM,Agent"/> <meta itemprop="datePublished" content="2025-11-19T07:45:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIå¤§æ¨¡å‹"/> <meta itemprop="url" content="https://juejin.cn/user/3817967696221534"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            5æ­¥æ„å»ºä¼ä¸šçº§RAGåº”ç”¨ï¼šDifyä¸LangChain v1.0é›†æˆå®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3817967696221534/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIå¤§æ¨¡å‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T07:45:03.000Z" title="Wed Nov 19 2025 07:45:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fde45c850f3548c1875b911b2e13ace1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764143102&amp;x-signature=Ijh%2F8lNZLGOWaB6VecWzEC0xXwE%3D" alt="" loading="lazy"/></p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°†é€šè¿‡äº”ä¸ªå…³é”®æ­¥éª¤ï¼Œå¸¦æ‚¨ä»é›¶å¼€å§‹æŒæ¡Difyä¸LangChain v1.0çš„é›†æˆæŠ€æœ¯ï¼Œæ„å»ºå±äºè‡ªå·±çš„ä¼ä¸šçº§RAGåº”ç”¨ã€‚</p>
<h2 data-id="heading-0">Difyæ ¸å¿ƒåŠŸèƒ½è§£æï¼šä½ä»£ç å¼€å‘çš„å¼ºå¤§å¼•æ“</h2>
<p>Difyä½œä¸ºå¼€æºçš„LLMåº”ç”¨å¼€å‘å¹³å°ï¼Œå…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºå°†å¤æ‚çš„AIå·¥ç¨‹èƒ½åŠ›å°è£…ä¸ºç›´è§‚çš„å¯è§†åŒ–å·¥å…·ã€‚åœ¨é›†æˆLangChainæ—¶ï¼Œä»¥ä¸‹ç‰¹æ€§å°¤ä¸ºå…³é”®ï¼š</p>
<p><strong>å¯è§†åŒ–å·¥ä½œæµç¼–æ’</strong>å…è®¸å¼€å‘è€…é€šè¿‡æ‹–æ‹½èŠ‚ç‚¹æ„å»ºå¤æ‚AIæµç¨‹ã€‚Difyçš„Chatflowå¼•æ“æ”¯æŒæ¡ä»¶åˆ†æ”¯ã€å¾ªç¯é€»è¾‘å’Œå¹¶è¡Œä»»åŠ¡å¤„ç†ï¼Œè¿™æ„å‘³ç€å³ä½¿æ˜¯éæŠ€æœ¯äººå‘˜ä¹Ÿèƒ½è®¾è®¡å‡ºåŒ…å«RAGæ£€ç´¢ã€å·¥å…·è°ƒç”¨å’Œå¤šæ¨¡å‹åä½œçš„é«˜çº§åº”ç”¨ã€‚ä¾‹å¦‚ï¼Œåœ¨å®¢æœåœºæ™¯ä¸­ï¼Œå¯è½»æ¾é…ç½®"ç”¨æˆ·æé—®â†’æ„å›¾è¯†åˆ«â†’çŸ¥è¯†åº“æ£€ç´¢â†’LLMç”Ÿæˆâ†’å¤šæ¸ é“åˆ†å‘"çš„å®Œæ•´æµç¨‹ã€‚</p>
<p><strong>æ¨¡å‹ç½‘å…³</strong>åŠŸèƒ½è§£å†³äº†å¤šæ¨¡å‹ç®¡ç†çš„ç—›ç‚¹ã€‚Difyæ”¯æŒOpenAIã€Anthropicã€Llamaç­‰æ•°ç™¾ç§æ¨¡å‹çš„ç»Ÿä¸€æ¥å…¥ï¼Œé€šè¿‡æ ‡å‡†åŒ–APIæŠ½è±¡ï¼Œä½¿LangChainè°ƒç”¨ä¸åŒæ¨¡å‹æ—¶æ— éœ€ä¿®æ”¹ä»£ç ã€‚æŸç”µå•†å¹³å°åˆ©ç”¨æ­¤ç‰¹æ€§ï¼Œåœ¨ä¿ƒé”€é«˜å³°æœŸè‡ªåŠ¨å°†ç®€å•æŸ¥è¯¢åˆ‡æ¢è‡³å¼€æºæ¨¡å‹ï¼Œå¤æ‚æ¨ç†ä¿ç•™GPT-4ï¼Œä½¿æˆæœ¬é™ä½40%åŒæ—¶ä¿æŒæœåŠ¡è´¨é‡ã€‚</p>
<p><strong>RAGå¼•æ“</strong>ç»è¿‡æ·±åº¦ä¼˜åŒ–ï¼Œæ”¯æŒ20+æ–‡æ¡£æ ¼å¼è§£æå’Œæ··åˆæ£€ç´¢ç­–ç•¥ã€‚Difyçš„çˆ¶å­åˆ†æ®µæŠ€æœ¯å°†æ–‡æ¡£æ‹†åˆ†ä¸ºè¯­ä¹‰å—ï¼ˆçˆ¶æ®µï¼‰å’Œç»†èŠ‚å—ï¼ˆå­æ®µï¼‰ï¼Œç»“åˆBM25å…³é”®è¯æ£€ç´¢ä¸å‘é‡æ£€ç´¢ï¼Œä½¿å¬å›ç‡æå‡25%ã€‚åœ¨ä»£ç å®ç°ä¸­ï¼Œåªéœ€é€šè¿‡å‡ è¡Œé…ç½®å³å¯å¯ç”¨è¿™ä¸€é«˜çº§ç‰¹æ€§ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Dify RAGé…ç½®ç¤ºä¾‹ï¼ˆéœ€dify-client==1.9.1ï¼‰  </span>
fromÂ dify_clientÂ importÂ DifyClient  
  
<span class="hljs-attr">client</span> = DifyClient(api_key=<span class="hljs-string">"your_api_key"</span>)  
client.knowledge.create_dataset(  
Â  Â  <span class="hljs-attr">name</span>=<span class="hljs-string">"ä¼ä¸šçŸ¥è¯†åº“"</span>,  
Â  Â  <span class="hljs-attr">retrieval_strategy</span>=<span class="hljs-string">"hybrid"</span>,Â  <span class="hljs-comment"># æ··åˆæ£€ç´¢æ¨¡å¼  </span>
Â  Â  <span class="hljs-attr">chunking_strategy</span>={  
Â  Â  Â  Â  "mode":Â "semantic",  
Â  Â  Â  Â  "parent_chunk_size":Â 500,  
Â  Â  Â  Â  "child_chunk_size":Â 100,  
Â  Â  Â  Â  "overlap_rate":Â 0.15  
Â  Â  }  
)
</code></pre>
<p><strong>Agentæ¡†æ¶</strong>æ”¯æŒFunction Callingä¸ReActæ¨¡å¼ï¼Œå†…ç½®50+å·¥å…·é›†æˆã€‚é€šè¿‡Difyçš„å·¥å…·å¸‚åœºï¼Œå¯ä¸€é”®æ·»åŠ LangChainçš„å„ç§å·¥å…·èƒ½åŠ›ï¼Œå¦‚SerpAPIæœç´¢ã€WolframAlphaè®¡ç®—ç­‰ï¼Œä¸ºæ™ºèƒ½ä½“æ‰©å±•ä¸°å¯Œçš„å¤–éƒ¨èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-1">LangChain v1.0æ–°ç‰¹æ€§è§£è¯»ï¼šæ„å»ºç”Ÿäº§çº§Agentçš„åˆ©å™¨</h2>
<p>2025å¹´10æœˆå‘å¸ƒçš„LangChain v1.0å¸¦æ¥äº†æ¶æ„å±‚é¢çš„é‡å¤§é©æ–°ï¼Œè¿™äº›å˜åŒ–æ·±åˆ»å½±å“äº†ä¸Difyçš„é›†æˆæ–¹å¼ï¼š</p>
<p><strong>ç»Ÿä¸€AgentæŠ½è±¡</strong>æ˜¯æœ€æ˜¾è‘—çš„æ›´æ–°ã€‚v1.0å°†åŸæœ‰çš„å„ç±»Chainå’ŒAgentç»Ÿä¸€ä¸ºåŸºäºLangGraphæ„å»ºçš„Â <code>create_agent</code>Â æ¥å£ï¼Œå¤§å¹…ç®€åŒ–äº†å¤æ‚é€»è¾‘çš„å®ç°ã€‚ä¸æ—§ç‰ˆç›¸æ¯”ï¼Œä»£ç é‡å‡å°‘60%ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># LangChain v1.0 Agentåˆ›å»ºï¼ˆéœ€langchain==1.0.0ï¼‰  </span>
<span class="hljs-keyword">from</span>Â langchain.agentsÂ <span class="hljs-keyword">import</span>Â create_agent  
<span class="hljs-keyword">from</span>Â langchain_anthropicÂ <span class="hljs-keyword">import</span>Â ChatAnthropic  
  
<span class="hljs-comment"># å®šä¹‰å·¥å…·  </span>
<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">get_weather</span>(<span class="hljs-params">location:Â <span class="hljs-built_in">str</span></span>) -&gt;Â <span class="hljs-built_in">str</span>:  
Â  Â  <span class="hljs-string">"""è·å–æŒ‡å®šä½ç½®çš„å¤©æ°”ä¿¡æ¯"""</span>  
Â  Â  <span class="hljs-keyword">return</span>Â <span class="hljs-string">f"<span class="hljs-subst">{location}</span>çš„å¤©æ°”æ˜¯æ™´æœ—çš„"</span>  
  
<span class="hljs-comment"># åˆ›å»ºAgentï¼ˆå°‘äº10è¡Œä»£ç ï¼‰  </span>
model = ChatAnthropic(model=<span class="hljs-string">"claude-3-5-sonnet-20241022"</span>)  
agent = create_agent(  
Â  Â  model=model,  
Â  Â  tools=[get_weather],  
Â  Â  system_prompt=<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªæœ‰å¸®åŠ©çš„AIåŠ©æ‰‹"</span>  
)  
  
<span class="hljs-comment"># æ‰§è¡Œ  </span>
result = agent.invoke({<span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>:Â <span class="hljs-string">"user"</span>,Â <span class="hljs-string">"content"</span>:Â <span class="hljs-string">"åŒ—äº¬å¤©æ°”å¦‚ä½•ï¼Ÿ"</span>}]})
</code></pre>
<p><strong>ä¸­é—´ä»¶æœºåˆ¶</strong>ä¸ºAgentæä¾›äº†å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›ã€‚å¼€å‘è€…å¯é€šè¿‡Â <code>middleware</code>Â å‚æ•°æ³¨å…¥é€šç”¨é€»è¾‘ï¼Œå¦‚å¯¹è¯æ‘˜è¦ã€æ•æ„Ÿä¿¡æ¯è¿‡æ»¤ã€å·¥å…·æƒé™æ§åˆ¶ç­‰ã€‚ä¾‹å¦‚ï¼Œæ·»åŠ å¯¹è¯æ‘˜è¦ä¸­é—´ä»¶è§£å†³é•¿å¯¹è¯ä¸Šä¸‹æ–‡è¶…é™é—®é¢˜ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">fromÂ langchain.agents.middlewareÂ importÂ summarization_middleware  
  
<span class="hljs-attr">agent</span> = create_agent(  
Â  Â  <span class="hljs-attr">model</span>=model,  
Â  Â  <span class="hljs-attr">tools</span>=[get_weather],  
Â  Â  <span class="hljs-attr">middleware</span>=[  
Â  Â  Â  Â  summarization_middleware(  
Â  Â  Â  Â  Â  Â  model=<span class="hljs-string">"openai:gpt-4o-mini"</span>,  
Â  Â  Â  Â  Â  Â  max_tokens_before_summary=<span class="hljs-number">4000</span>,  
Â  Â  Â  Â  Â  Â  messages_to_keep=<span class="hljs-number">20</span>  
Â  Â  Â  Â  )  
Â  Â  ]  
)

</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/631261eaf6b8457d93cdcf08acc1545d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764143102&amp;x-signature=abjJZckkgEYMPNntIVxsp9Mlj2M%3D" alt="image.png" loading="lazy"/>
LangChain v1.0æ¶æ„å›¾</p>
<p><strong>æ ‡å‡†åŒ–å†…å®¹å—</strong>ä½¿å·¥å…·è°ƒç”¨å’Œå¤šæ¨¡æ€å¤„ç†æ›´åŠ æ¸…æ™°ã€‚v1.0å¼•å…¥çš„Â <code>content_blocks</code>Â ç»“æ„ç»Ÿä¸€äº†ä¸åŒç±»å‹æ¶ˆæ¯çš„è¡¨ç¤ºæ–¹å¼ï¼Œæ— è®ºæ˜¯æ–‡æœ¬ã€å·¥å…·è°ƒç”¨è¿˜æ˜¯å›¾åƒURLï¼Œéƒ½èƒ½ä»¥ä¸€è‡´çš„æ ¼å¼åœ¨ç³»ç»Ÿä¸­æµè½¬ï¼Œè¿™ä¸ºDifyä¸LangChainä¹‹é—´çš„æ•°æ®äº¤æ¢æä¾›äº†ä¾¿åˆ©ã€‚</p>
<h2 data-id="heading-2">é›†æˆæ­¥éª¤æŒ‡å—ï¼šä»ç¯å¢ƒé…ç½®åˆ°APIè°ƒç”¨</h2>
<p>é›†æˆDifyä¸LangChainéœ€è¦å®Œæˆä¸‰ä¸ªå…³é”®æ­¥éª¤ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»æ¯ä¸€æ­¥çš„æ“ä½œè¦ç‚¹å’Œä»£ç å®ç°ï¼š</p>
<p><strong>ç¯å¢ƒé…ç½®</strong>éœ€è¦å‡†å¤‡ä¸¤ä¸ªæ ¸å¿ƒä¾èµ–åº“ã€‚å»ºè®®ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒéš”ç¦»é¡¹ç›®ä¾èµ–ï¼Œç¡®ä¿ç‰ˆæœ¬å…¼å®¹æ€§ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ  </span>
python -m venv dify-env  
<span class="hljs-built_in">source</span>Â dify-env/bin/activateÂ  <span class="hljs-comment"># Linux/Mac  </span>
<span class="hljs-comment"># dify-env\Scripts\activate Â # Windows  </span>
  
<span class="hljs-comment"># å®‰è£…ä¾èµ–ï¼ˆæŒ‡å®šæœ€æ–°ç‰ˆæœ¬ï¼‰  </span>
pip install dify-client==1.9.1 langchain==1.0.0 python-dotenv
</code></pre>
<p>åœ¨Difyå¹³å°ç«¯ï¼Œéœ€è¦åˆ›å»ºåº”ç”¨å¹¶è·å–APIå¯†é’¥ã€‚ç™»å½•Difyæ§åˆ¶å°åï¼Œé€šè¿‡"è®¾ç½®â†’APIè®¿é—®"åˆ›å»ºæ–°çš„è®¿é—®å‡­è¯ï¼ŒåŒæ—¶ç¡®ä¿å·²å¯ç”¨"å¤–éƒ¨å·¥å…·è°ƒç”¨"æƒé™ã€‚å°†è·å–çš„APIå¯†é’¥å­˜å‚¨åœ¨Â <code>.env</code>Â æ–‡ä»¶ä¸­ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">DIFY_API_KEY</span>=your_dify_api_key  
<span class="hljs-attr">LANGCHAIN_API_KEY</span>=your_langchain_api_key
</code></pre>
<p><strong>æ ¸å¿ƒAPIè°ƒç”¨</strong>åˆ†ä¸ºä¸¤ç§æ¨¡å¼ã€‚å½“Difyä½œä¸ºå‰ç«¯ç•Œé¢ï¼ŒLangChainå¤„ç†åç«¯é€»è¾‘æ—¶ï¼Œå¯é€šè¿‡Difyçš„è‡ªå®šä¹‰å·¥å…·è°ƒç”¨LangChainæœåŠ¡ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Difyè‡ªå®šä¹‰å·¥å…·é…ç½®ç¤ºä¾‹ï¼ˆDify 1.9.1+ï¼‰  </span>
<span class="hljs-keyword">import</span>Â requests  
<span class="hljs-keyword">from</span>Â dify_clientÂ <span class="hljs-keyword">import</span>Â DifyClient  
<span class="hljs-keyword">import</span>Â os  
<span class="hljs-keyword">from</span>Â dotenvÂ <span class="hljs-keyword">import</span>Â load_dotenv  
  
load_dotenv()  
client = DifyClient(api_key=os.getenv(<span class="hljs-string">"DIFY_API_KEY"</span>))  
  
<span class="hljs-comment"># åˆ›å»ºè°ƒç”¨LangChainçš„è‡ªå®šä¹‰å·¥å…·  </span>
tool_config = {  
Â  Â  <span class="hljs-string">"name"</span>:Â <span class="hljs-string">"langchain_agent"</span>,  
Â  Â  <span class="hljs-string">"description"</span>:Â <span class="hljs-string">"è°ƒç”¨LangChainå¤„ç†å¤æ‚é€»è¾‘"</span>,  
Â  Â  <span class="hljs-string">"parameters"</span>: {  
Â  Â  Â  Â  <span class="hljs-string">"query"</span>: {<span class="hljs-string">"type"</span>:Â <span class="hljs-string">"string"</span>,Â <span class="hljs-string">"description"</span>:Â <span class="hljs-string">"ç”¨æˆ·æŸ¥è¯¢å†…å®¹"</span>}  
Â  Â  },  
Â  Â  <span class="hljs-string">"request_config"</span>: {  
Â  Â  Â  Â  <span class="hljs-string">"url"</span>:Â <span class="hljs-string">"https://your-langchain-server/api/process"</span>,  
Â  Â  Â  Â  <span class="hljs-string">"method"</span>:Â <span class="hljs-string">"POST"</span>,  
Â  Â  Â  Â  <span class="hljs-string">"headers"</span>: {  
Â  Â  Â  Â  Â  Â  <span class="hljs-string">"Content-Type"</span>:Â <span class="hljs-string">"application/json"</span>,  
Â  Â  Â  Â  Â  Â  <span class="hljs-string">"Authorization"</span>:Â <span class="hljs-string">f"BearerÂ <span class="hljs-subst">{os.getenv(<span class="hljs-string">'LANGCHAIN_API_KEY'</span>)}</span>"</span>  
Â  Â  Â  Â  },  
Â  Â  Â  Â  <span class="hljs-string">"body"</span>: {<span class="hljs-string">"query"</span>:Â <span class="hljs-string">"{{query}}"</span>}  
Â  Â  }  
}  
  
client.tool.create(tool_config)
</code></pre>
<p>åä¹‹ï¼Œå½“LangChainéœ€è¦è®¿é—®Difyçš„çŸ¥è¯†åº“æ—¶ï¼Œå¯ä½¿ç”¨Dify Python SDKï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># LangChainè°ƒç”¨DifyçŸ¥è¯†åº“ç¤ºä¾‹ï¼ˆLangChain v1.0+ï¼‰  </span>
fromÂ langchain.retrieversÂ importÂ DifyRetriever  
importÂ os  
fromÂ dotenvÂ importÂ load_dotenv  
  
load_dotenv()  
<span class="hljs-attr">retriever</span> = DifyRetriever(  
Â  Â  <span class="hljs-attr">api_key</span>=os.getenv(<span class="hljs-string">"DIFY_API_KEY"</span>),  
Â  Â  <span class="hljs-attr">dataset_id</span>=<span class="hljs-string">"your_dataset_id"</span>,  
Â  Â  <span class="hljs-attr">top_k</span>=<span class="hljs-number">5</span>,  
Â  Â  <span class="hljs-attr">score_threshold</span>=<span class="hljs-number">0.7</span>  
)  
  
<span class="hljs-comment"># åœ¨LangChainä¸­ä½¿ç”¨Difyæ£€ç´¢å™¨  </span>
fromÂ langchain.chainsÂ importÂ RetrievalQA  
fromÂ langchain_openaiÂ importÂ ChatOpenAI  
  
<span class="hljs-attr">llm</span> = ChatOpenAI(model=<span class="hljs-string">"gpt-4o"</span>)  
<span class="hljs-attr">qa_chain</span> = RetrievalQA.from_chain_type(  
Â  Â  <span class="hljs-attr">llm</span>=llm,  
Â  Â  <span class="hljs-attr">chain_type</span>=<span class="hljs-string">"stuff"</span>,  
Â  Â  <span class="hljs-attr">retriever</span>=retriever  
)  
  
<span class="hljs-attr">result</span> = qa_chain.invoke({<span class="hljs-string">"query"</span>:Â <span class="hljs-string">"ä¼ä¸šäº§å“å®šä»·ç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿ"</span>})
</code></pre>
<p><strong>æ•°æ®æµè½¬è®¾è®¡</strong>éœ€è¦æ³¨æ„ä¸Šä¸‹æ–‡ä¿æŒã€‚åœ¨å¤šè½®å¯¹è¯åœºæ™¯ä¸­ï¼Œéœ€å°†Difyçš„ä¼šè¯IDä¼ é€’ç»™LangChainï¼Œç¡®ä¿å¯¹è¯å†å²çš„è¿ç»­æ€§ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¸¦ä¼šè¯ä¸Šä¸‹æ–‡çš„è°ƒç”¨ç¤ºä¾‹ï¼ˆDify 1.9.1+ï¼‰  </span>
defÂ process_query(query:Â str, conversation_id:Â <span class="hljs-attr">str</span>Â =Â None):  
Â  Â  <span class="hljs-comment"># 1. ä»Difyè·å–çŸ¥è¯†åº“æ£€ç´¢ç»“æœ  </span>
Â  Â  <span class="hljs-attr">retrieval_result</span> = client.knowledge.retrieve(  
Â  Â  Â  Â  <span class="hljs-attr">dataset_id</span>=<span class="hljs-string">"your_dataset_id"</span>,  
Â  Â  Â  Â  <span class="hljs-attr">query</span>=query,  
Â  Â  Â  Â  <span class="hljs-attr">conversation_id</span>=conversation_id  
Â  Â  )  
  
Â  Â  <span class="hljs-comment"># 2. è°ƒç”¨LangChainå¤„ç†æ£€ç´¢ç»“æœ  </span>
Â  Â  <span class="hljs-attr">langchain_response</span> = requests.post(  
Â  Â  Â  Â  "https://your-langchain-server/api/process",  
Â  Â  Â  Â  <span class="hljs-attr">json</span>={  
Â  Â  Â  Â  Â  Â  "query": query,  
Â  Â  Â  Â  Â  Â  "context": retrieval_result<span class="hljs-section">["documents"]</span>,  
Â  Â  Â  Â  Â  Â  "conversation_id": conversation_id  
Â  Â  Â  Â  },  
Â  Â  Â  Â  <span class="hljs-attr">headers</span>={<span class="hljs-string">"Authorization"</span>:Â f<span class="hljs-string">"BearerÂ {os.getenv('LANGCHAIN_API_KEY')}"</span>}  
Â  Â  )  
  
Â  Â  <span class="hljs-comment"># 3. å°†ç»“æœè¿”å›ç»™Difyæ›´æ–°ä¼šè¯  </span>
Â  Â  ifÂ conversation_id:  
Â  Â  Â  Â  client.conversation.update(  
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">conversation_id</span>=conversation_id,  
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">messages</span>=[{<span class="hljs-string">"role"</span>:Â <span class="hljs-string">"assistant"</span>,Â <span class="hljs-string">"content"</span>: langchain_response.json()[<span class="hljs-string">"result"</span>]}]  
Â  Â  Â  Â  )  
  
Â  Â  returnÂ langchain_response.json()
</code></pre>
<h2 data-id="heading-3">å®æˆ˜æ¡ˆä¾‹æ¼”ç¤ºï¼šä¼ä¸šçŸ¥è¯†åº“æ™ºèƒ½é—®ç­”ç³»ç»Ÿ</h2>
<p>æˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªå®Œæ•´çš„ä¼ä¸šçŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿç»“åˆDifyçš„å¯è§†åŒ–ç•Œé¢å’ŒLangChainçš„é«˜çº§æ£€ç´¢èƒ½åŠ›ï¼Œæ”¯æŒPDFæ–‡æ¡£è§£æã€è¯­ä¹‰æ£€ç´¢å’Œå¤šè½®å¯¹è¯ã€‚</p>
<p><strong>ç³»ç»Ÿæ¶æ„</strong>åˆ†ä¸ºå››ä¸ªå±‚æ¬¡ã€‚ç”¨æˆ·é€šè¿‡Difyçš„Webç•Œé¢æé—®ï¼Œè¯·æ±‚é¦–å…ˆç»è¿‡Difyçš„æ„å›¾è¯†åˆ«æ¨¡å—ï¼Œç„¶åè°ƒç”¨LangChainçš„RAGé“¾å¤„ç†ï¼Œæ£€ç´¢ç»“æœæ¥è‡ªDifyç®¡ç†çš„çŸ¥è¯†åº“ï¼Œæœ€ç»ˆç”±LLMç”Ÿæˆå›ç­”å¹¶è¿”å›ç»™ç”¨æˆ·ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5dd17f0bf63f415cb6264d7effbee59e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764143102&amp;x-signature=%2F6WIES2BOUCbNGdhU5bQVuvGMjE%3D" alt="" loading="lazy"/></p>
<p>RAGç³»ç»Ÿæ¶æ„å›¾</p>
<p><strong>æ•°æ®å‡†å¤‡</strong>é˜¶æ®µéœ€è¦ä¸Šä¼ æ–‡æ¡£å¹¶æ„å»ºçŸ¥è¯†åº“ã€‚é€šè¿‡Difyçš„"çŸ¥è¯†åº“"åŠŸèƒ½ä¸Šä¼ ä¼ä¸šæ–‡æ¡£ï¼ˆæ”¯æŒPDFã€DOCXç­‰20+æ ¼å¼ï¼‰ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¿›è¡Œæ–‡æœ¬æå–å’Œåˆ†å—å¤„ç†ã€‚æ¨èä½¿ç”¨ä»¥ä¸‹åˆ†å—ç­–ç•¥ï¼š</p>
<ul>
<li>â€¢ çˆ¶å—å¤§å°ï¼š400-600å­—ç¬¦ï¼ˆä¿ç•™ä¸Šä¸‹æ–‡è¯­ä¹‰ï¼‰</li>
<li>â€¢ å­å—å¤§å°ï¼š100-200å­—ç¬¦ï¼ˆå®ç°ç²¾ç¡®åŒ¹é…ï¼‰</li>
<li>â€¢ é‡å ç‡ï¼š10-15%ï¼ˆé¿å…å…³é”®ä¿¡æ¯æˆªæ–­ï¼‰</li>
</ul>
<p>åœ¨LangChainç«¯ï¼Œéœ€è¦é…ç½®å‘é‡å­˜å‚¨å’ŒåµŒå…¥æ¨¡å‹ã€‚è¿™é‡Œä½¿ç”¨FAISSä½œä¸ºå‘é‡æ•°æ®åº“ï¼Œé…åˆBGEåµŒå…¥æ¨¡å‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># LangChainæ£€ç´¢é“¾é…ç½®ï¼ˆv1.0+ï¼‰  </span>
fromÂ langchain.vectorstoresÂ importÂ FAISS  
fromÂ langchain.embeddingsÂ importÂ HuggingFaceEmbeddings  
fromÂ langchain.text_splitterÂ importÂ RecursiveCharacterTextSplitter  
fromÂ langchain.document_loadersÂ importÂ PyPDFLoader  
  
<span class="hljs-comment"># åŠ è½½Difyå¯¼å‡ºçš„çŸ¥è¯†åº“æ–‡æ¡£  </span>
<span class="hljs-attr">loader</span> = PyPDFLoader(<span class="hljs-string">"dify_knowledge_export.pdf"</span>)  
<span class="hljs-attr">documents</span> = loader.load()  
  
<span class="hljs-comment"># æ–‡æœ¬åˆ†å—  </span>
<span class="hljs-attr">text_splitter</span> = RecursiveCharacterTextSplitter(  
Â  Â  <span class="hljs-attr">chunk_size</span>=<span class="hljs-number">500</span>,  
Â  Â  <span class="hljs-attr">chunk_overlap</span>=<span class="hljs-number">50</span>,  
Â  Â  <span class="hljs-attr">separators</span>=[<span class="hljs-string">"\n\n"</span>,Â <span class="hljs-string">"\n"</span>,Â <span class="hljs-string">". "</span>,Â <span class="hljs-string">" "</span>,Â <span class="hljs-string">""</span>]  
)  
<span class="hljs-attr">splits</span> = text_splitter.split_documents(documents)  
  
<span class="hljs-comment"># åˆ›å»ºå‘é‡å­˜å‚¨  </span>
<span class="hljs-attr">embeddings</span> = HuggingFaceEmbeddings(model_name=<span class="hljs-string">"BAAI/bge-small-en-v1.5"</span>)  
<span class="hljs-attr">vectorstore</span> = FAISS.from_documents(documents=splits, embedding=embeddings)  
vectorstore.save_local("faiss_index")
</code></pre>
<p><strong>æ ¸å¿ƒä»£ç å®ç°</strong>åŒ…å«Difyå·¥ä½œæµè®¾è®¡å’ŒLangChainæ£€ç´¢é“¾ä¸¤éƒ¨åˆ†ã€‚åœ¨Difyä¸­åˆ›å»ºæ–°çš„"å¯¹è¯å‹åº”ç”¨"ï¼Œç„¶åè®¾è®¡å¦‚ä¸‹å·¥ä½œæµï¼š</p>
<ol start="0">
<li>
<ol start="0">
<li>æ·»åŠ "ç”¨æˆ·è¾“å…¥"èŠ‚ç‚¹æ¥æ”¶æé—®</li>
</ol>
</li>
<li>
<ol start="2">
<li>æ·»åŠ "çŸ¥è¯†åº“æ£€ç´¢"èŠ‚ç‚¹è·å–ç›¸å…³æ–‡æ¡£</li>
</ol>
</li>
<li>
<ol start="3">
<li>æ·»åŠ "å·¥å…·è°ƒç”¨"èŠ‚ç‚¹è°ƒç”¨LangChainå¤„ç†é€»è¾‘</li>
</ol>
</li>
<li>
<ol start="4">
<li>æ·»åŠ "LLMç”Ÿæˆ"èŠ‚ç‚¹ç”Ÿæˆæœ€ç»ˆå›ç­”</li>
</ol>
</li>
<li>
<ol start="5">
<li>æ·»åŠ "è¾“å‡º"èŠ‚ç‚¹å±•ç¤ºç»“æœ</li>
</ol>
</li>
</ol>
<p>LangChainç«¯å®ç°é«˜çº§æ£€ç´¢é€»è¾‘ï¼ŒåŒ…æ‹¬æ··åˆæ£€ç´¢å’Œç»“æœé‡æ’ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># LangChainé«˜çº§æ£€ç´¢å®ç°ï¼ˆv1.0+ï¼‰  </span>
fromÂ langchain.retrieversÂ importÂ ContextualCompressionRetriever  
fromÂ langchain.retrievers.document_compressorsÂ importÂ CohereRerank  
fromÂ langchain_community.retrieversÂ importÂ BM25Retriever  
fromÂ langchain.retrieversÂ importÂ EnsembleRetriever  
  
<span class="hljs-comment"># åŠ è½½å‘é‡å­˜å‚¨  </span>
<span class="hljs-attr">vectorstore</span> = FAISS.load_local(<span class="hljs-string">"faiss_index"</span>, embeddings, allow_dangerous_deserialization=<span class="hljs-literal">True</span>)  
<span class="hljs-attr">vector_retriever</span> = vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>:Â <span class="hljs-number">10</span>})  
  
<span class="hljs-comment"># åˆå§‹åŒ–BM25æ£€ç´¢å™¨ï¼ˆå…³é”®è¯æ£€ç´¢ï¼‰  </span>
<span class="hljs-attr">bm25_retriever</span> = BM25Retriever.from_documents(documents=splits)  
<span class="hljs-attr">bm25_retriever.k</span> =Â <span class="hljs-number">10</span>  
  
<span class="hljs-comment"># ç»„åˆæ£€ç´¢å™¨  </span>
<span class="hljs-attr">ensemble_retriever</span> = EnsembleRetriever(  
Â  Â  <span class="hljs-attr">retrievers</span>=[vector_retriever, bm25_retriever],  
Â  Â  <span class="hljs-attr">weights</span>=[<span class="hljs-number">0.7</span>,Â <span class="hljs-number">0.3</span>]  
)  
  
<span class="hljs-comment"># æ·»åŠ é‡æ’å™¨  </span>
<span class="hljs-attr">compressor</span> = CohereRerank(model=<span class="hljs-string">"rerank-english-v3.0"</span>)  
<span class="hljs-attr">compression_retriever</span> = ContextualCompressionRetriever(  
Â  Â  <span class="hljs-attr">base_compressor</span>=compressor,  
Â  Â  <span class="hljs-attr">base_retriever</span>=ensemble_retriever  
)  
  
<span class="hljs-comment"># åˆ›å»ºRAGé“¾  </span>
fromÂ langchain.chainsÂ importÂ RetrievalQA  
fromÂ langchain.chat_modelsÂ importÂ ChatOpenAI  
  
<span class="hljs-attr">llm</span> = ChatOpenAI(model_name=<span class="hljs-string">"gpt-4o"</span>, temperature=<span class="hljs-number">0.3</span>)  
<span class="hljs-attr">qa_chain</span> = RetrievalQA.from_chain_type(  
Â  Â  <span class="hljs-attr">llm</span>=llm,  
Â  Â  <span class="hljs-attr">chain_type</span>=<span class="hljs-string">"stuff"</span>,  
Â  Â  <span class="hljs-attr">retriever</span>=compression_retriever,  
Â  Â  <span class="hljs-attr">return_source_documents</span>=<span class="hljs-literal">True</span>  
)  
  
<span class="hljs-comment"># å¯åŠ¨FastAPIæœåŠ¡ä¾›Difyè°ƒç”¨  </span>
fromÂ fastapiÂ importÂ FastAPI  
importÂ uvicorn  
fromÂ pydanticÂ importÂ BaseModel  
  
<span class="hljs-attr">app</span> = FastAPI()  
  
classÂ QueryRequest(BaseModel):  
Â  Â  query:Â str  
  
@app.post("/process")  
asyncÂ defÂ process_query(request: QueryRequest):  
Â  Â  <span class="hljs-attr">result</span> = qa_chain({<span class="hljs-string">"query"</span>: request.query})  
Â  Â  returnÂ {  
Â  Â  Â  Â  "result": result<span class="hljs-section">["result"]</span>,  
Â  Â  Â  Â  "sources": <span class="hljs-section">[doc.metadata.get("source")Â forÂ docÂ inÂ result["source_documents"]]</span>  
Â  Â  }  
  
ifÂ <span class="hljs-attr">__name__</span> ==Â <span class="hljs-string">"__main__"</span>:  
Â  Â  uvicorn.run(app, <span class="hljs-attr">host</span>=<span class="hljs-string">"0.0.0.0"</span>, port=<span class="hljs-number">8000</span>)
</code></pre>
<p><strong>éƒ¨ç½²ä¸æµ‹è¯•</strong>éœ€è¦å¯åŠ¨LangChainæœåŠ¡å¹¶åœ¨Difyä¸­é…ç½®å·¥å…·åœ°å€ã€‚å°†LangChainæœåŠ¡éƒ¨ç½²åˆ°å…¬ç½‘å¯è®¿é—®çš„æœåŠ¡å™¨ï¼Œç„¶ååœ¨Difyçš„è‡ªå®šä¹‰å·¥å…·ä¸­å¡«å†™æœåŠ¡URLã€‚æµ‹è¯•æ—¶ï¼Œå¯ä¸Šä¼ ä¼ä¸šäº§å“æ‰‹å†Œå¹¶æé—®"è¯·ä»‹ç»äº§å“çš„æ ¸å¿ƒåŠŸèƒ½"ï¼Œç³»ç»Ÿåº”èƒ½å‡†ç¡®æ£€ç´¢ç›¸å…³å†…å®¹å¹¶ç”Ÿæˆå›ç­”ã€‚</p>
<h2 data-id="heading-4">æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ</h2>
<p>ä¼ä¸šçº§åº”ç”¨éœ€è¦å…³æ³¨æ€§èƒ½å’Œå¯é æ€§ï¼Œä»¥ä¸‹ä¼˜åŒ–ç­–ç•¥å¯æ˜¾è‘—æå‡ç³»ç»Ÿè¡¨ç°ï¼š</p>
<p><strong>å‘é‡æ£€ç´¢ä¼˜åŒ–</strong>ä»ä¸‰ä¸ªæ–¹é¢ç€æ‰‹ã€‚è°ƒæ•´åˆ†å—å¤§å°å’Œé‡å ç‡ï¼šå®éªŒè¡¨æ˜ï¼ŒæŠ€æœ¯æ–‡æ¡£ä½¿ç”¨300-500å­—ç¬¦çš„åˆ†å—å¤§å°ï¼Œé…åˆ10-15%çš„é‡å ç‡ï¼Œå¯ä½¿å¬å›ç‡æå‡18%ã€‚é€‰æ‹©åˆé€‚çš„åµŒå…¥æ¨¡å‹ï¼šå¯¹äºä¸­æ–‡åœºæ™¯ï¼ŒBGE-M3æ¨¡å‹åœ¨æ£€ç´¢ä»»åŠ¡ä¸Šè¡¨ç°ä¼˜äºä¼ ç»Ÿæ¨¡å‹ã€‚ä¼˜åŒ–å‘é‡æ•°æ®åº“å‚æ•°ï¼šFAISSçš„HNSWç´¢å¼•å¯é€šè¿‡è°ƒæ•´Â <code>nlist</code>Â å’ŒÂ <code>ef_construction</code>Â å‚æ•°å¹³è¡¡é€Ÿåº¦ä¸ç²¾åº¦ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># FAISSç´¢å¼•ä¼˜åŒ–ç¤ºä¾‹  </span>
<span class="hljs-attr">index</span> = faiss.IndexHNSWFlat(dimension, hnsw_params.M)  
<span class="hljs-attr">index.hnsw.efConstruction</span> =Â <span class="hljs-number">200</span>Â  <span class="hljs-comment"># æ„å»ºæ—¶ç²¾åº¦ï¼ˆå€¼è¶Šå¤§è¶Šç²¾ç¡®ï¼Œé€Ÿåº¦è¶Šæ…¢ï¼‰  </span>
<span class="hljs-attr">index.hnsw.efSearch</span> =Â <span class="hljs-number">100</span>Â  <span class="hljs-comment"># æŸ¥è¯¢æ—¶ç²¾åº¦  </span>
faiss.write_index(index,Â "optimized_index.faiss")
</code></pre>
<p><strong>ç¼“å­˜ç­–ç•¥</strong>æœ‰æ•ˆå‡å°‘é‡å¤è®¡ç®—ã€‚å®ç°ä¸‰çº§ç¼“å­˜æœºåˆ¶ï¼šRedisç¼“å­˜é«˜é¢‘æŸ¥è¯¢ç»“æœï¼ˆTTL=1å°æ—¶ï¼‰ï¼ŒDifyå†…ç½®ç¼“å­˜å­˜å‚¨çŸ¥è¯†åº“æ£€ç´¢ç»“æœï¼ˆTTL=12å°æ—¶ï¼‰ï¼Œå®¢æˆ·ç«¯ç¼“å­˜ä¿å­˜ç”¨æˆ·ä¼šè¯ï¼ˆTTL=24å°æ—¶ï¼‰ã€‚ä»¥ä¸‹æ˜¯Redisç¼“å­˜å®ç°ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Redisç¼“å­˜å®ç°  </span>
<span class="hljs-keyword">import</span>Â redis  
<span class="hljs-keyword">from</span>Â functoolsÂ <span class="hljs-keyword">import</span>Â lru_cache  
  
r = redis.Redis(host=<span class="hljs-string">'localhost'</span>, port=<span class="hljs-number">6379</span>, db=<span class="hljs-number">0</span>)  
  
<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">cache_decorator</span>(<span class="hljs-params">ttl=<span class="hljs-number">3600</span></span>):  
Â  Â  <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">decorator</span>(<span class="hljs-params">func</span>):  
Â  Â  Â  Â  <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):  
Â  Â  Â  Â  Â  Â  key =Â <span class="hljs-string">f"cache:<span class="hljs-subst">{func.__name__}</span>:<span class="hljs-subst">{<span class="hljs-built_in">str</span>(args)}</span>:<span class="hljs-subst">{<span class="hljs-built_in">str</span>(kwargs)}</span>"</span>  
Â  Â  Â  Â  Â  Â  cached_result = r.get(key)  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span>Â cached_result:  
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span>Â <span class="hljs-built_in">eval</span>(cached_result)  
Â  Â  Â  Â  Â  Â  result = func(*args, **kwargs)  
Â  Â  Â  Â  Â  Â  r.setex(key, ttl,Â <span class="hljs-built_in">str</span>(result))  
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span>Â result  
Â  Â  Â  Â  <span class="hljs-keyword">return</span>Â wrapper  
Â  Â  <span class="hljs-keyword">return</span>Â decorator  
  
<span class="hljs-meta">@cache_decorator(<span class="hljs-params">ttl=<span class="hljs-number">3600</span></span>)  </span>
<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">rag_query</span>(<span class="hljs-params">query:Â <span class="hljs-built_in">str</span></span>):  
Â  Â  <span class="hljs-keyword">return</span>Â qa_chain({<span class="hljs-string">"query"</span>: query})
</code></pre>
<p><strong>å¹¶å‘æ§åˆ¶</strong>é˜²æ­¢ç³»ç»Ÿè¿‡è½½ã€‚åœ¨Difyä¸­é…ç½®APIè¯·æ±‚é™æµï¼ˆé€šè¿‡"è®¾ç½®â†’å®‰å…¨"ï¼‰ï¼Œæ¨èå€¼ä¸ºæ™®é€šç”¨æˆ·5 QPSï¼Œç®¡ç†å‘˜10 QPSã€‚LangChainæœåŠ¡ç«¯ä½¿ç”¨FastAPIçš„é™æµä¸­é—´ä»¶ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># FastAPIé™æµé…ç½®  </span>
<span class="hljs-keyword">from</span>Â fastapiÂ <span class="hljs-keyword">import</span>Â FastAPI, Request, HTTPException  
<span class="hljs-keyword">from</span>Â fastapi.middleware.corsÂ <span class="hljs-keyword">import</span>Â CORSMiddleware  
<span class="hljs-keyword">from</span>Â slowapiÂ <span class="hljs-keyword">import</span>Â Limiter, _rate_limit_exceeded_handler  
<span class="hljs-keyword">from</span>Â slowapi.utilÂ <span class="hljs-keyword">import</span>Â get_remote_address  
<span class="hljs-keyword">from</span>Â slowapi.errorsÂ <span class="hljs-keyword">import</span>Â RateLimitExceeded  
  
limiter = Limiter(key_func=get_remote_address)  
app = FastAPI()  
app.state.limiter = limiter  
app.add_exception_handler(RateLimitExceeded, _rate_limit_exceeded_handler)  
  
<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/process"</span></span>)  </span>
<span class="hljs-meta">@limiter.limit(<span class="hljs-params"><span class="hljs-string">"10/minute"</span></span>)  </span>
<span class="hljs-keyword">async</span>Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">process_query</span>(<span class="hljs-params">request: Request, query: QueryRequest</span>):  
Â  Â  <span class="hljs-comment"># å¤„ç†è¯·æ±‚é€»è¾‘</span>
</code></pre>
<p><strong>ç›‘æ§ä¸è°ƒä¼˜</strong>æ˜¯æŒç»­ä¼˜åŒ–çš„åŸºç¡€ã€‚é›†æˆPrometheuså’ŒGrafanaç›‘æ§å…³é”®æŒ‡æ ‡ï¼šAPIå“åº”æ—¶é—´ï¼ˆç›®æ ‡P99&lt;1ç§’ï¼‰ã€æ£€ç´¢å‡†ç¡®ç‡ï¼ˆé€šè¿‡ç”¨æˆ·åé¦ˆæ”¶é›†ï¼‰ã€ç¼“å­˜å‘½ä¸­ç‡ï¼ˆç›®æ ‡&gt;80%ï¼‰ã€‚å®šæœŸåˆ†ææ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œä¼˜åŒ–åˆ†å—ç­–ç•¥å’Œæç¤ºè¯æ¨¡æ¿ã€‚</p>
<h2 data-id="heading-5">å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<p>é›†æˆè¿‡ç¨‹ä¸­ï¼Œå¼€å‘è€…å¸¸é‡åˆ°ä»¥ä¸‹æŒ‘æˆ˜ï¼Œæˆ‘ä»¬æä¾›ç»è¿‡éªŒè¯çš„è§£å†³æ–¹æ¡ˆï¼š</p>
<p><strong>ä¾èµ–å†²çª</strong>æ˜¯æœ€å¸¸è§çš„é—®é¢˜ã€‚å½“Difyå’ŒLangChainå¯¹åŒä¸€ä¾èµ–åº“æœ‰ä¸åŒç‰ˆæœ¬è¦æ±‚æ—¶ï¼ˆå¦‚pydanticï¼‰ï¼Œä½¿ç”¨è™šæ‹Ÿç¯å¢ƒéš”ç¦»å¹¶åˆ›å»ºÂ <code>requirements.txt</code>Â é”å®šç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># requirements.txtï¼ˆé€‚é…Dify 1.9.1å’ŒLangChain v1.0ï¼‰  </span>
<span class="hljs-attr">dify-client</span>==<span class="hljs-number">1.9</span>.<span class="hljs-number">1</span>  
<span class="hljs-attr">langchain</span>==<span class="hljs-number">1.0</span>.<span class="hljs-number">0</span>  
<span class="hljs-attr">python-dotenv</span>==<span class="hljs-number">1.0</span>.<span class="hljs-number">0</span>  
<span class="hljs-attr">pydantic</span>==<span class="hljs-number">2.5</span>.<span class="hljs-number">2</span>  
<span class="hljs-attr">fastapi</span>==<span class="hljs-number">0.104</span>.<span class="hljs-number">1</span>  
<span class="hljs-attr">uvicorn</span>==<span class="hljs-number">0.24</span>.<span class="hljs-number">0</span>  
<span class="hljs-attr">redis</span>==<span class="hljs-number">4.6</span>.<span class="hljs-number">0</span>  
<span class="hljs-attr">faiss-cpu</span>==<span class="hljs-number">1.7</span>.<span class="hljs-number">4</span>
</code></pre>
<p>å¤„ç†æ–¹æ³•ï¼šåˆ é™¤ç°æœ‰ç¯å¢ƒï¼Œé‡æ–°åˆ›å»ºå¹¶å®‰è£…é”å®šç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">rm</span>Â -rf dify-env  
python -m venv dify-env  
<span class="hljs-built_in">source</span>Â dify-env/bin/activate  
pip install -r requirements.txt
</code></pre>
<p><strong>APIè°ƒç”¨å¤±è´¥</strong>æ’æŸ¥æ­¥éª¤ï¼šé¦–å…ˆæ£€æŸ¥Difyçš„APIå¯†é’¥æ˜¯å¦å…·æœ‰æ­£ç¡®æƒé™ï¼Œå…¶æ¬¡éªŒè¯ç½‘ç»œè¿æ¥ï¼ˆç‰¹åˆ«æ˜¯ç§æœ‰åŒ–éƒ¨ç½²æ—¶çš„é˜²ç«å¢™è®¾ç½®ï¼‰ï¼Œæœ€åæŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—ã€‚Difyçš„"æ—¥å¿—"é¡µé¢æä¾›å·¥å…·è°ƒç”¨çš„å®Œæ•´è®°å½•ï¼ŒåŒ…æ‹¬è¯·æ±‚å‚æ•°å’Œå“åº”å†…å®¹ã€‚</p>
<p><strong>æ€§èƒ½ç“¶é¢ˆ</strong>è¯Šæ–­æµç¨‹ï¼šä½¿ç”¨LangChainçš„ tracing åŠŸèƒ½è¯†åˆ«æ…¢ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¯ç”¨LangChainè¿½è¸ª  </span>
importÂ langchain  
<span class="hljs-attr">langchain.verbose</span> =Â <span class="hljs-literal">True</span>  
<span class="hljs-attr">langchain.debug</span> =Â <span class="hljs-literal">True</span>  
  
<span class="hljs-comment"># æˆ–ä½¿ç”¨LangSmith  </span>
os.environ<span class="hljs-section">["LANGCHAIN_TRACING_V2"]</span> =Â "true"  
os.environ<span class="hljs-section">["LANGCHAIN_API_KEY"]</span> =Â "your_langsmith_key"  
os.environ<span class="hljs-section">["LANGCHAIN_PROJECT"]</span> =Â "dify-integration"
</code></pre>
<p><strong>å®‰å…¨é—®é¢˜</strong>ä¸å¯å¿½è§†ã€‚ç¡®ä¿æ‰€æœ‰APIå¯†é’¥é€šè¿‡ç¯å¢ƒå˜é‡ä¼ é€’ï¼Œä¸åœ¨ä»£ç ä¸­ç¡¬ç¼–ç ã€‚Difyç§æœ‰åŒ–éƒ¨ç½²æ—¶ï¼Œå¯ç”¨HTTPSå¹¶é…ç½®IPç™½åå•ï¼Œé™åˆ¶ç®¡ç†æ¥å£è®¿é—®ã€‚LangChainå·¥å…·è°ƒç”¨ä½¿ç”¨æ²™ç®±ç¯å¢ƒï¼Œç‰¹åˆ«æ˜¯ä»£ç æ‰§è¡Œç±»å·¥å…·ã€‚</p>
<h2 data-id="heading-6">æœªæ¥å±•æœ›ä¸è¿›é˜¶æ–¹å‘</h2>
<p>Difyä¸LangChainçš„é›†æˆæŠ€æœ¯æ­£åœ¨å¿«é€Ÿå‘å±•ï¼Œä»¥ä¸‹è¶‹åŠ¿å€¼å¾—å…³æ³¨ï¼š</p>
<p><strong>å¤šæ¨¡æ€èƒ½åŠ›</strong>å°†æˆä¸ºä¸‹ä¸€ä»£åº”ç”¨çš„æ ‡é…ã€‚Difyå·²æ”¯æŒå›¾åƒå’Œè¯­éŸ³è¾“å…¥ï¼Œç»“åˆLangChainçš„å¤šæ¨¡æ€æ¨¡å‹è°ƒç”¨ï¼Œå¯æ„å»ºæ›´è‡ªç„¶çš„äº¤äº’ä½“éªŒã€‚ä¾‹å¦‚ï¼Œé›¶å”®åœºæ™¯ä¸­ï¼Œç”¨æˆ·ä¸Šä¼ å•†å“å›¾ç‰‡å³å¯è·å–ä»·æ ¼å¯¹æ¯”å’Œè´­ä¹°å»ºè®®ã€‚</p>
<p><strong>æ™ºèƒ½ä½“åä½œ</strong>ç³»ç»Ÿè§£å†³å¤æ‚ä»»åŠ¡ã€‚é€šè¿‡Difyç¼–æ’å¤šä¸ªLangChainæ™ºèƒ½ä½“ï¼Œæ¯ä¸ªæ™ºèƒ½ä½“ä¸“æ³¨äºç‰¹å®šé¢†åŸŸï¼ˆå¦‚æ³•å¾‹ã€è´¢åŠ¡ã€æŠ€æœ¯æ”¯æŒï¼‰ï¼Œå®ç°é—®é¢˜çš„åˆ†å¸ƒå¼è§£å†³ã€‚æŸå’¨è¯¢å…¬å¸å·²ç”¨æ­¤æ¶æ„å°†é¡¹ç›®ææ¡ˆç”Ÿæˆæ—¶é—´ä»3å¤©ç¼©çŸ­è‡³4å°æ—¶ã€‚</p>
<p><strong>LLMOpså®è·µ</strong>è‡ªåŠ¨åŒ–æ¨¡å‹ä¼˜åŒ–ã€‚Difyçš„æ ‡æ³¨åŠŸèƒ½ç»“åˆLangChainçš„è¯„ä¼°æ¡†æ¶ï¼Œå½¢æˆ"æ•°æ®æ”¶é›†â†’æ¨¡å‹å¾®è°ƒâ†’æ•ˆæœè¯„ä¼°"çš„é—­ç¯ã€‚ä¼ä¸šå¯é€šè¿‡ç”¨æˆ·åé¦ˆæŒç»­ä¼˜åŒ–ç§æœ‰æ¨¡å‹ï¼Œä½¿å›ç­”å‡†ç¡®ç‡æ¯æœˆæå‡5-8%ã€‚</p>
<p><strong>è¾¹ç¼˜è®¡ç®—éƒ¨ç½²</strong>æ‹“å±•åº”ç”¨åœºæ™¯ã€‚éšç€æ¨¡å‹å°å‹åŒ–æŠ€æœ¯çš„å‘å±•ï¼ŒDifyä¸LangChainçš„è½»é‡ç‰ˆæœ¬å¯éƒ¨ç½²åœ¨è¾¹ç¼˜è®¾å¤‡ï¼Œå¦‚å·¥å‚çš„å·¥ä¸šå¹³æ¿æˆ–åŒ»ç–—ç°åœºçš„ç§»åŠ¨ç»ˆç«¯ï¼Œå®ç°ä½å»¶è¿Ÿã€é«˜éšç§çš„AIåº”ç”¨ã€‚</p>
<p>è¿›é˜¶å­¦ä¹ è·¯å¾„å»ºè®®ï¼šæŒæ¡LangGraphæ„å»ºçŠ¶æ€ç®¡ç†çš„å¤æ‚å·¥ä½œæµï¼Œå­¦ä¹ Difyçš„æ’ä»¶å¼€å‘æ‰©å±•ç³»ç»Ÿèƒ½åŠ›ï¼Œç ”ç©¶RAGä¸å¾®è°ƒç»“åˆçš„çŸ¥è¯†æ³¨å…¥æŠ€æœ¯ã€‚é€šè¿‡å‚ä¸å¼€æºç¤¾åŒºï¼ˆDifyåœ¨GitHubå·²æœ‰4.4ä¸‡æ˜Ÿæ ‡ï¼‰ï¼Œè·Ÿè¸ªæœ€æ–°æŠ€æœ¯åŠ¨æ€å’Œæœ€ä½³å®è·µã€‚</p>
<h2 data-id="heading-7">ç»“è¯­ï¼šé‡Šæ”¾AIç”Ÿäº§åŠ›çš„æ— é™å¯èƒ½</h2>
<p>Difyä¸LangChain v1.0çš„é›†æˆï¼Œä»£è¡¨äº†AIåº”ç”¨å¼€å‘çš„æ–°èŒƒå¼â€”â€”æ— éœ€åœ¨æ˜“ç”¨æ€§å’Œçµæ´»æ€§ä¹‹é—´å¦¥åã€‚é€šè¿‡æœ¬æ–‡ä»‹ç»çš„äº”ä¸ªæ­¥éª¤ï¼Œæ‚¨å·²ç»æŒæ¡äº†æ„å»ºä¼ä¸šçº§RAGåº”ç”¨çš„æ ¸å¿ƒæŠ€æœ¯ï¼šä»Difyçš„å¯è§†åŒ–å·¥ä½œæµè®¾è®¡ï¼Œåˆ°LangChainçš„é«˜çº§æ£€ç´¢å®ç°ï¼›ä»æ€§èƒ½ä¼˜åŒ–çš„å…³é”®ç­–ç•¥ï¼Œåˆ°å¸¸è§é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>ç°åœ¨ï¼Œæ˜¯æ—¶å€™å°†è¿™äº›çŸ¥è¯†åº”ç”¨åˆ°å®é™…é¡¹ç›®ä¸­äº†ã€‚æ— è®ºæ‚¨æ˜¯å¸Œæœ›æå‡å®¢æœæ•ˆç‡ã€ä¼˜åŒ–å†…éƒ¨çŸ¥è¯†åº“ï¼Œè¿˜æ˜¯æ„å»ºå…¨æ–°çš„AIäº§å“ï¼ŒDifyä¸LangChainçš„ç»„åˆéƒ½èƒ½ä¸ºæ‚¨æä¾›å¼ºå¤§çš„æŠ€æœ¯æ”¯æ’‘ã€‚è®°ä½ï¼Œæœ€å¥½çš„å­¦ä¹ æ–¹å¼æ˜¯åŠ¨æ‰‹å®è·µâ€”â€”å¼€å§‹æ„å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªé›†æˆåº”ç”¨ï¼Œä½“éªŒAIç”Ÿäº§åŠ›çš„é©å‘½æ€§æå‡ï¼</p>
<h2 data-id="heading-8">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fhy.zhipoai.cn%2F" target="_blank" title="https://hy.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å·²æ­»ï¼Œaiå½“ç«‹ï¼šgemini3å†™çš„ç«æŸ´äººå°„å‡»å°æ¸¸æˆ]]></title>    <link>https://juejin.cn/post/7574382925761953830</link>    <guid>https://juejin.cn/post/7574382925761953830</guid>    <pubDate>2025-11-20T05:59:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574382925761953830" data-draft-id="7574382925761806374" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å·²æ­»ï¼Œaiå½“ç«‹ï¼šgemini3å†™çš„ç«æŸ´äººå°„å‡»å°æ¸¸æˆ"/> <meta itemprop="keywords" content="å‰ç«¯,AIç¼–ç¨‹,Gemini"/> <meta itemprop="datePublished" content="2025-11-20T05:59:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‹œæ— å¿§"/> <meta itemprop="url" content="https://juejin.cn/user/2797611742923502"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å·²æ­»ï¼Œaiå½“ç«‹ï¼šgemini3å†™çš„ç«æŸ´äººå°„å‡»å°æ¸¸æˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2797611742923502/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‹œæ— å¿§
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T05:59:19.000Z" title="Thu Nov 20 2025 05:59:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e1a15a843e047569a93d6f077c4a44d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ouc5peg5b-n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764223159&amp;x-signature=OLXNFIQfRKA3mlssWeHqF%2Fleevg%3D" alt="PixPin_2025-11-20_13-38-38.png" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad90ccb67047402994f229bf04587053~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ouc5peg5b-n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764223159&amp;x-signature=nlRBvhVGl3npxP3QKyX2nrrlr0Y%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25bcab3d9b684ede8dfca64f3b32805b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ouc5peg5b-n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764223159&amp;x-signature=5mUXOp14XcwXu%2FNh7syMG3qPq14%3D" alt="image.png" loading="lazy"/>
<a href="https://code.juejin.cn/pen/7574677339096023082" target="_blank" title="https://code.juejin.cn/pen/7574677339096023082">code.juejin.cn/pen/7574677â€¦</a>
<span href="https://code.juejin.cn/pen/7574677339096023082" class="code-editor-container"><iframe class="code-editor-frame" data-code="code-editor-element" data-code-id="7574677339096023082" data-src="https://code.juejin.cn/pen/7574677339096023082" style="display:none;" loading="lazy"/><span class="loading-placeholder" style="display:none"><img class="placeholder-image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAJElEQVRoge3BMQEAAADCoPVP7WkJoAAAAAAAAAAAAAAAAAAAbjh8AAFte11jAAAAAElFTkSuQmCC" loading="lazy"/><span class="loading-logo"/></span></span>
è¿™æ¬¾ã€Šç«æŸ´äººï¼šç»ˆæçˆ†è£‚ (Stickman: Ultimate Burst)ã€‹ç›®å‰å·²ç»å…·å¤‡äº†ç›¸å½“å®Œæ•´ä¸”çˆ½å¿«çš„ Roguelite å°„å‡»ä¸å¹³å°è·³è·ƒä½“éªŒã€‚ä»¥ä¸‹æ˜¯å½“å‰ç‰ˆæœ¬çš„åŠŸèƒ½æ€»ç»“ï¼š</p>
<p><strong>1. æ ¸å¿ƒæˆ˜æ–—ä¸æ“ä½œ (Core Gameplay)</strong></p>
<ul>
<li>
<p><strong>æ™ºèƒ½ç«æ§ç³»ç»Ÿ</strong>ï¼šè§’è‰²ä¼šè‡ªåŠ¨é”å®šè§†é‡å†…æœ€è¿‘çš„æ•Œäººå¤´éƒ¨/èº«ä½“å¹¶è‡ªåŠ¨å°„å‡»ï¼Œç©å®¶åªéœ€ä¸“æ³¨äºèµ°ä½ã€‚</p>
</li>
<li>
<p><strong>æµç•…è·‘é…·</strong>ï¼šæ”¯æŒäºŒæ®µè·³ (Double Jump)ã€è¹¬å¢™è·³ (Wall Jump) å’Œä¸‹ç©¿å¹³å°ï¼Œæ‰‹æ„Ÿé¡ºæ»‘ã€‚</p>
</li>
<li>
<p><strong>å››ç§ç‰¹è‰²æ­¦å™¨</strong>ï¼š</p>
<ul>
<li><strong>M1911</strong>ï¼šå‡è¡¡å‹åˆå§‹æ‰‹æªã€‚</li>
<li><strong>VECTOR</strong>ï¼šæé«˜å°„é€Ÿçš„å†²é”‹æªã€‚</li>
<li><strong>AA-12</strong>ï¼šè¿‘æˆ˜çˆ†å‘æå¼ºçš„éœ°å¼¹æªã€‚</li>
<li><strong>ç£è½¨ç‚® (Railgun)</strong> ï¼šæ‹¥æœ‰ç©¿é€æ•ˆæœçš„æ¯ç­æ€§æ¿€å…‰æ­¦å™¨ã€‚</li>
</ul>
</li>
<li>
<p><strong>æˆ˜å‰æ•´å¤‡</strong>ï¼šæ¸¸æˆå¼€å§‹å‰å¯ä»¥ç›´æ¥é€‰æ‹©å¿ƒä»ªçš„ä¸»æ­¦å™¨å…¥åœºã€‚</p>
</li>
</ul>
<p><strong>2. ç‰¹è‰²æœºåˆ¶ (Unique Mechanics)</strong></p>
<ul>
<li><strong>æ— ä¼¤æ¥è§¦ (No Contact Damage)</strong> ï¼šæ™®é€šæ•Œäººçš„èº«ä½“ç¢°æ’ä¸å†é€ æˆä¼¤å®³ï¼Œé¼“åŠ±ç©å®¶åœ¨æ€ªç¾¤ä¸­ç©¿æ¢­ã€‚</li>
<li><strong>å°¸ä½“çˆ†ç‚¸ (Corpse Explosion)</strong> ï¼šæå…·ç­–ç•¥æ€§çš„æœºåˆ¶ã€‚æ•Œäººæ­»åä¼šç•™ä¸‹å°¸ä½“ï¼ŒçŸ­æš‚å»¶è¿Ÿåå‘ç”Ÿå‰§çƒˆçˆ†ç‚¸ã€‚ç©å®¶æ€æ•Œåå¿…é¡»è¿…é€Ÿè¿œç¦»ï¼Œæˆ–è€…åˆ©ç”¨ä½ç§»å¼•è¯±æ•Œäººã€‚</li>
<li><strong>æ”»å‡»å¸è¡€ (Lifesteal)</strong> ï¼šå­å¼¹å‡»ä¸­æ•Œäººä¼šå›å¤å¾®é‡ç”Ÿå‘½å€¼ï¼Œå¹¶ä¼´æœ‰ç»¿è‰²çš„æ²»ç–—æ•°å­—é£˜å­—ï¼Œå¢å¼ºç»­èˆªèƒ½åŠ›ã€‚</li>
<li><strong>å®‰å…¨å…‰æŸ± (Safety Pillar)</strong> ï¼šä¸€é“çº¢è‰²çš„æ¿€å…‰å¢™ä¼šè·Ÿéšç©å®¶çš„æ¨è¿›è¿›åº¦ï¼ˆåŸºäºåœ°é¢åæ ‡ï¼‰ï¼Œé˜²æ­¢å› åœ°å›¾åŠ¨æ€æ¸…ç†è€Œæ‰è½è™šç©ºã€‚</li>
</ul>
<p><strong>3. æ•Œäººä¸ AI (Enemies)</strong></p>
<ul>
<li>
<p><strong>å…¨å‘˜ç«æŸ´äººåŒ–</strong>ï¼šæ•Œäººæ‹¥æœ‰å„è‡ªç‹¬ç‰¹çš„ç«æŸ´äººé€ å‹å’ŒåŠ¨ç”»ã€‚</p>
<ul>
<li><strong>Runner (æ©™)</strong> ï¼šå¿«é€Ÿå¥”è·‘çš„è¿‘æˆ˜å•ä½ã€‚</li>
<li><strong>Shooter (ç™½)</strong> ï¼šè¿œç¨‹å•ä½ï¼Œä¼šå‘å°„å‡é€Ÿçš„çº¢è‰²å…‰çƒå­å¼¹ã€‚</li>
<li><strong>Drone (é’)</strong> ï¼šæ— è§†åœ°å½¢é£è¡Œçš„æœºæ¢°å•ä½ã€‚</li>
<li><strong>Shield (è“ç›¾)</strong> ï¼šæ‰‹æŒå¤§ç›¾ï¼Œèƒ½æ ¼æŒ¡æ­£é¢å­å¼¹ï¼Œéœ€ç»•åæ”»å‡»ã€‚</li>
</ul>
</li>
<li>
<p><strong>BOSS æˆ˜</strong>ï¼šæ¯10å…³å‡ºç°å·¨å¤§çš„æ³°å¦çº§ BOSSï¼Œæ‹¥æœ‰éœ‡åœ°è·³è·ƒå’Œå…¨å±å¼¹å¹•æš´èµ°æŠ€èƒ½ã€‚</p>
</li>
</ul>
<p><strong>4. ç»æµä¸æˆé•¿ (Progression)</strong></p>
<ul>
<li>
<p><strong>æ³¢æ¬¡ç³»ç»Ÿ</strong>ï¼šæ— é™ç”Ÿæˆçš„å…³å¡ï¼Œæ•Œäººæ•°é‡éšæ³¢æ¬¡å¢åŠ ã€‚</p>
</li>
<li>
<p><strong>é»‘å¸‚å•†åº—</strong>ï¼šå‡»è´¥ BOSS åè§¦å‘ã€‚</p>
</li>
<li>
<p><strong>å‡çº§é¡¹</strong>ï¼š</p>
<ul>
<li>è´­ä¹°/è§£é”æ–°æ­¦å™¨ã€‚</li>
<li><strong>DMG</strong>ï¼šä¼¤å®³æå‡ã€‚</li>
<li><strong>SPD</strong>ï¼šå°„é€Ÿæ”¹è‰¯ã€‚</li>
<li><strong>MAG</strong>ï¼šå¼¹å¤¹æ‰©å®¹ã€‚</li>
<li><strong>RELOAD</strong>ï¼šæ¢å¼¹é€Ÿåº¦åŠ å¿«ã€‚</li>
<li><strong>HEAL</strong>ï¼šè´­ä¹°åŒ»ç–—åŒ…ã€‚</li>
</ul>
</li>
<li>
<p><strong>é˜ˆå€¼é™åˆ¶</strong>ï¼šå„é¡¹å±æ€§å‡çº§éƒ½æœ‰æœ€å¤§ç­‰çº§é™åˆ¶ï¼Œé˜²æ­¢æ•°å€¼å´©åã€‚</p>
</li>
</ul>
<p><strong>5. è§†å¬è¡¨ç° (Juice &amp; Feedback)</strong></p>
<ul>
<li>
<p><strong>ç¨‹åºåŒ–åŠ¨ç”»</strong>ï¼šä¸»è§’å’Œæ•Œäººæ‹¥æœ‰åŸºäºä»£ç ç”Ÿæˆçš„è·‘æ­¥æ‘†è…¿ã€ç„å‡†æ‰‹è‡‚è·ŸéšåŠ¨ç”»ã€‚</p>
</li>
<li>
<p><strong>æ‰“å‡»æ„Ÿåé¦ˆ</strong>ï¼š</p>
<ul>
<li><strong>å±å¹•éœ‡åŠ¨ (Screen Shake)</strong> ï¼šå¼€ç«ã€çˆ†ç‚¸ã€å—ä¼¤æ—¶æœ‰å¼ºçƒˆçš„éœ‡å±æ„Ÿã€‚</li>
<li><strong>é¡¿å¸§ (Hit Stop)</strong> ï¼šå‡»æ€ç¬é—´æœ‰å¾®å°çš„å¡é¡¿ï¼Œå¼ºåŒ–æ‰“å‡»åŠ›åº¦ã€‚</li>
<li><strong>ç²’å­ç‰¹æ•ˆ</strong>ï¼šæŠ›å£³ã€æªå£ç„°ã€è¡€çˆ†ç²’å­ã€äºŒæ®µè·³çƒŸå°˜ã€‚</li>
</ul>
</li>
<li>
<p><strong>åŠ¨æ€éŸ³æ•ˆ</strong>ï¼šä½¿ç”¨ Web Audio API å®æ—¶åˆæˆçš„å¤å¤é£æ ¼æªå£°ã€çˆ†ç‚¸å£°å’Œç‚¹å‡»åé¦ˆã€‚</p>
</li>
</ul>
<p>ç›®å‰çš„ç‰ˆæœ¬å·²ç»æ˜¯ä¸€ä¸ªéå¸¸è€ç©çš„å°å‹åŠ¨ä½œæ¸¸æˆäº†ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯ç©è½¬ AI åº”ç”¨å¼€å‘ï½œ30è¡Œä»£ç å®ç°èŠå¤©æœºå™¨äººğŸ¤–]]></title>    <link>https://juejin.cn/post/7574370234070024246</link>    <guid>https://juejin.cn/post/7574370234070024246</guid>    <pubDate>2025-11-20T03:23:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574370234070024246" data-draft-id="7573892156257009700" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯ç©è½¬ AI åº”ç”¨å¼€å‘ï½œ30è¡Œä»£ç å®ç°èŠå¤©æœºå™¨äººğŸ¤–"/> <meta itemprop="keywords" content="å‰ç«¯,ç¨‹åºå‘˜,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-20T03:23:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Sentry5"/> <meta itemprop="url" content="https://juejin.cn/user/2159893031168119"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯ç©è½¬ AI åº”ç”¨å¼€å‘ï½œ30è¡Œä»£ç å®ç°èŠå¤©æœºå™¨äººğŸ¤–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2159893031168119/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Sentry5
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:23:13.000Z" title="Thu Nov 20 2025 03:23:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><p>åœ¨æˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç« <a href="https://juejin.cn/post/7573193563053522985" target="_blank" title="https://juejin.cn/post/7573193563053522985">ã€ŠCursor ä¸€å¹´æ·±åº¦å¼€å‘å®è·µï¼šå‰ç«¯å¼€å‘çš„æ•ˆç‡é©å‘½ğŸš€ã€‹</a>ç»“å°¾ï¼Œæˆ‘æ›¾å±•æœ›AIæ—¶ä»£å¯èƒ½ä¼šå‚¬ç”Ÿâ€œè¶…çº§ä¸ªä½“â€ï¼Œå–ä»£ä¼ ç»Ÿçš„äº§å“ç»ç†+å‰åç«¯åä½œæ¨¡å¼ã€‚ä½†å¦ç™½è¯´ï¼Œä½œä¸ºä¸€åå‰ç«¯å¼€å‘è€…ï¼Œå½“AIæµªæ½®æ¥ä¸´ä¹‹åˆï¼Œæˆ‘çš„ç¬¬ä¸€ååº”å’Œå¤§å¤šæ•°åŒè¡Œä¸€æ ·ï¼š<strong>è¿™æ˜¯ç®—æ³•å·¥ç¨‹å¸ˆçš„é¢†åŸŸï¼Œç¦»æˆ‘å¾ˆè¿œã€‚</strong></p>
<p>é¢å¯¹é‚£äº›å……æ–¥ç€å¤æ‚å…¬å¼çš„æŠ€æœ¯è®ºæ–‡ï¼Œæˆ‘ä¸€åº¦è®¤ä¸ºï¼šå³ä¾¿èŠ±æ—¶é—´å­¦ä¹ è¿™äº›çŸ¥è¯†ï¼Œæˆ‘ä¹Ÿä¸å¯èƒ½è½¬è¡Œå»å’Œç§‘ç­å‡ºèº«çš„ç®—æ³•å·¥ç¨‹å¸ˆç«äº‰ã€‚ä¸å…¶é’»ç ”è¿™äº›â€œç”¨ä¸ä¸Šâ€çš„AIæŠ€æœ¯ï¼Œä¸å¦‚ç»§ç»­æ·±è€•è€æœ¬è¡Œï¼ŒæŠŠReactåŸç†ã€æ€§èƒ½ä¼˜åŒ–å’Œå·¥ç¨‹åŒ–è¿™äº›çœ‹å®¶æœ¬é¢†ç»ƒå¾—æ›´æ‰å®ã€‚</p>
<p>ç›´åˆ°æŸå¤©ï¼Œæˆ‘å†³å®šäº²è‡ªæ¢ç©¶ä¸€ä¸‹æ‰€è°“çš„ AI åº”ç”¨å¼€å‘åˆ°åº•æœ‰å¤šå¤æ‚ï¼Œå´æ„å¤–åœ°å‘ç°ï¼šä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„èŠå¤©æœºå™¨äººï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œ<strong>å…¶æ ¸å¿ƒé€»è¾‘ç«Ÿç„¶åªéœ€è¦30è¡Œä»£ç å°±èƒ½å®ç°ã€‚</strong></p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e441b9b805e347999b80d370877d4b8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VudHJ5NQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764215716&amp;x-signature=%2BJ9uma9lVyS2Cvt7NwsZhfOfOC4%3D" alt="image.png" width="70%" loading="lazy"/></p>
<p>è¿™ä¸€å‘ç°è®©æˆ‘ç¬é—´æ„è¯†åˆ°ï¼šåœ¨ AI åº”ç”¨çš„æµªæ½®ä¸­ï¼Œ<strong>èƒ½å¤Ÿæ·±åˆ»ç†è§£äº§å“ã€å…·å¤‡å·¥ç¨‹åŒ–æ€ç»´å’Œå…¨é“¾è·¯èƒ½åŠ›çš„å‰ç«¯å¼€å‘è€…ï¼Œä¸ä»…ä¸ä¼šæ‰é˜Ÿï¼Œåè€Œå¾ˆå¯èƒ½åœ¨ AI åº”ç”¨å±‚å¼€å‘ä¸­ç„•å‘èŒä¸šç”Ÿæ¶¯çš„ç¬¬äºŒæ˜¥</strong>ã€‚</p>
<h2 data-id="heading-0">ç†è§£ AI åº”ç”¨æ ¸å¿ƒå®ç°</h2>
<h3 data-id="heading-1">30 è¡Œä»£ç å®ç°èŠå¤©æœºå™¨äºº</h3>
<p>å¯ä»¥å…ˆå¿«é€Ÿæµè§ˆä»¥è·å¾—å¤§è‡´å°è±¡ï¼Œå¦‚æœ‰ç–‘æƒ‘å†ç»§ç»­æ·±å…¥é˜…è¯»ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> readline <span class="hljs-keyword">from</span> <span class="hljs-string">'readline'</span>;
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">API_KEY</span> = process.<span class="hljs-property">env</span>.<span class="hljs-property">API_KEY</span>;
<span class="hljs-keyword">const</span> messages = [{ <span class="hljs-attr">role</span>: <span class="hljs-string">'system'</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">'ä½ æ˜¯ä¸€ä¸ªå‰ç«¯é«˜æ‰‹ï¼Œèƒ½å¸®æˆ‘è§£ç­”å‰ç«¯å¼€å‘ä¸­é‡åˆ°çš„é—®é¢˜ã€‚'</span> }];
<span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
  <span class="hljs-keyword">const</span> input = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> rl = readline.<span class="hljs-title function_">createInterface</span>({
      <span class="hljs-attr">input</span>: process.<span class="hljs-property">stdin</span>,
      <span class="hljs-attr">output</span>: process.<span class="hljs-property">stdout</span>,
    });
    rl.<span class="hljs-title function_">question</span>(<span class="hljs-string">'ç”¨æˆ·: '</span>, <span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span> {
      <span class="hljs-title function_">resolve</span>(msg);
      rl.<span class="hljs-title function_">close</span>();
    });
  });
  messages.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>, <span class="hljs-attr">content</span>: input });
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(
    <span class="hljs-string">'https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions'</span>,
    {
      <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
        <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${API_KEY}</span>`</span>,
      },
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">model</span>: <span class="hljs-string">'qwen-plus'</span>, messages }),
    }
  );
  <span class="hljs-keyword">const</span> reply = (<span class="hljs-keyword">await</span> res.<span class="hljs-title function_">json</span>()).<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>].<span class="hljs-property">message</span>.<span class="hljs-property">content</span>;
  messages.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">role</span>: <span class="hljs-string">'assistant'</span>, <span class="hljs-attr">content</span>: reply });
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'AIåŠ©æ‰‹:'</span>, reply + <span class="hljs-string">'\n'</span>);
}
</code></pre>
<h3 data-id="heading-2">è·å–æ¨¡å‹æœåŠ¡</h3>
<p>æ‰€è°“ AI åº”ç”¨ï¼ˆç°åœ¨ä¹Ÿå¤šç§°ä¸ºâ€œå¤§æ¨¡å‹åº”ç”¨â€ï¼‰ï¼Œå…¶æ ¸å¿ƒå°±æ˜¯é€šè¿‡ API è°ƒç”¨å¤§æ¨¡å‹æœåŠ¡ã€‚å¯¹äºä¸ªäººå¼€å‘è€…è€Œè¨€ï¼Œå…¥é—¨é—¨æ§›å·²å¤§å¤§é™ä½ï¼Œ<strong>é˜¿é‡Œäº‘ã€ç«å±±å¼•æ“ã€æ™ºè°±AI</strong>ç­‰å¹³å°å‡æä¾›äº†å…è´¹çš„ tokens é¢åº¦ï¼Œè¶³ä»¥ç”¨äºå­¦ä¹ å’ŒåŸå‹å¼€å‘ã€‚</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fbailian.console.aliyun.com%2F%3Fspm%3D5176.12818093_47.resourceCenter.1.248e2cc98Hv3yr%26tab%3Dmodel%23%2Fmodel-market" target="_blank" title="https://bailian.console.aliyun.com/?spm=5176.12818093_47.resourceCenter.1.248e2cc98Hv3yr&amp;tab=model#/model-market" ref="nofollow noopener noreferrer">é˜¿é‡Œäº‘ç™¾ç‚¼</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fconsole.volcengine.com%2Fark%2Fregion%3Aark%2Bcn-beijing%2Fmodel%3Fvendor%3DBytedance%26view%3DDEFAULT_VIEW" target="_blank" title="https://console.volcengine.com/ark/region:ark+cn-beijing/model?vendor=Bytedance&amp;view=DEFAULT_VIEW" ref="nofollow noopener noreferrer">ç«å±±æ–¹èˆŸ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.bigmodel.cn%2F" target="_blank" title="https://open.bigmodel.cn/" ref="nofollow noopener noreferrer">æ™ºè°±AIå¼€æ”¾å¹³å°</a></li>
</ul>
<p>å„å¹³å°å®˜ç½‘éƒ½æä¾›äº†è¯¦å°½çš„å¼€å‘æ–‡æ¡£ã€‚æœ¬æ–‡å°†ä»¥<strong>é˜¿é‡Œäº‘çš„åƒé—®ï¼ˆqwenï¼‰æ¨¡å‹</strong>ä¸ºä¾‹è¿›è¡Œæ¼”ç¤ºã€‚åœ¨å¼€å§‹ç¼–ç å‰ï¼Œæˆ‘ä»¬åªéœ€ç†è§£ä¸¤ä¸ªæœ€æ ¸å¿ƒçš„æ¦‚å¿µï¼š<strong>API Key</strong>Â ä¸Â <strong>baseUrl</strong>ã€‚</p>
<h4 data-id="heading-3">1. API Keyï¼šä½ çš„èº«ä»½å‡­è¯</h4>
<p>API Key ç›¸å½“äºä½ è°ƒç”¨å¤§æ¨¡å‹æœåŠ¡çš„â€œå¯†ç â€æˆ–â€œä»¤ç‰Œâ€ã€‚å®ƒç”¨äºåœ¨ HTTP è¯·æ±‚å¤´ä¸­è¿›è¡Œèº«ä»½è®¤è¯ï¼Œç¡®ä¿åªæœ‰æˆæƒçš„ç”¨æˆ·æ‰èƒ½è®¿é—®æœåŠ¡ã€‚</p>
<ul>
<li><strong>è·å–æ–¹å¼</strong>ï¼šåœ¨å¯¹åº”äº‘å¹³å°æ³¨å†Œå¹¶å¼€é€šæœåŠ¡åï¼Œé€šå¸¸å¯ä»¥åœ¨æ§åˆ¶å°çš„â€œå¯†é’¥ç®¡ç†â€é¡µé¢åˆ›å»ºã€‚</li>
<li><strong>å®‰å…¨é¡»çŸ¥</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªé«˜åº¦æ•æ„Ÿçš„å­—ç¬¦ä¸²ï¼Œ<strong>ç»ä¸èƒ½</strong>ç›´æ¥ç¡¬ç¼–ç åœ¨å‰ç«¯ä»£ç æˆ–å…¬å¼€çš„ä»“åº“ä¸­ã€‚æ­£ç¡®çš„åšæ³•æ˜¯å°†å…¶è®¾ç½®ä¸ºç¯å¢ƒå˜é‡:<code>const API_KEY = process.env.API_KEY; </code></li>
</ul>
<h4 data-id="heading-4">2. baseUrlï¼šæœåŠ¡çš„åœ°å€</h4>
<p>baseUrl æ˜¯ä½ æ‰€è¦è°ƒç”¨çš„ API æœåŠ¡çš„æ¥å£åœ°å€ã€‚ä¸åŒå¹³å°çš„ API åœ°å€å„ä¸ç›¸åŒã€‚æ¯”å¦‚æœ¬æ–‡ä»£ç ä¸­ä½¿ç”¨çš„é€šä¹‰åƒé—®çš„æ¥å£åœ°å€ä¸ºï¼š  <code>https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions</code></p>
<h3 data-id="heading-5">Node.jså®ç°åŸºç¡€å¯¹è¯èƒ½åŠ›</h3>
<p>åœ¨å¼•å…¥AIèƒ½åŠ›ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ„å»ºä¸€ä¸ª<strong>çº¯æœ¬åœ°</strong>çš„å¯¹è¯ç³»ç»Ÿæ¡†æ¶ï¼š</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/662e7b1c00f4455fb9af8907ca3b7c4b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VudHJ5NQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764215716&amp;x-signature=HUb4qrSqUJCyTQrFl96C0aV1VcQ%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> readline <span class="hljs-keyword">from</span> <span class="hljs-string">'readline'</span>;
<span class="hljs-comment">// ä¸»å¯¹è¯å¾ªç¯</span>
<span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
  <span class="hljs-comment">// è·å–ç”¨æˆ·è¾“å…¥</span>
  <span class="hljs-keyword">const</span> input = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> rl = readline.<span class="hljs-title function_">createInterface</span>({
      <span class="hljs-attr">input</span>: process.<span class="hljs-property">stdin</span>,
      <span class="hljs-attr">output</span>: process.<span class="hljs-property">stdout</span>,
    });
    rl.<span class="hljs-title function_">question</span>(<span class="hljs-string">'ç”¨æˆ·: '</span>, <span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span> {
      <span class="hljs-title function_">resolve</span>(msg);
      rl.<span class="hljs-title function_">close</span>();
    });
  });
  <span class="hljs-comment">// æ¨¡æ‹ŸAIå›å¤ï¼ˆåç»­ä¼šæ›¿æ¢ä¸ºçœŸå®APIè°ƒç”¨ï¼‰</span>
  <span class="hljs-keyword">const</span> mockReply = <span class="hljs-string">`å·²æ”¶åˆ°æ‚¨çš„è¾“å…¥: "<span class="hljs-subst">${input}</span>"`</span>;

  <span class="hljs-comment">// è¾“å‡ºAIå›å¤</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'AIåŠ©æ‰‹:'</span>, mockReply + <span class="hljs-string">'\n'</span>);
}
</code></pre>
<h4 data-id="heading-6">è¿è¡Œæ­¥éª¤</h4>
<ol>
<li>å°†ä»£ç ä¿å­˜ä¸ºÂ <code>hello_ai.mjs</code>Â æ–‡ä»¶ï¼šå› ä¸ºéœ€è¦ç›´æ¥åœ¨é¡¶å±‚ä½¿ç”¨awaitï¼Œæ‰€ä»¥éœ€è¦ES Moduleã€‚</li>
<li>åœ¨ç»ˆç«¯æ‰§è¡ŒÂ <code>node hello_ai.mjs</code></li>
<li>å¼€å§‹ä¸æ¨¡æ‹ŸAIå¯¹è¯</li>
</ol>
<h4 data-id="heading-7">æŠ€æœ¯è¦ç‚¹è§£æ</h4>
<ol>
<li>
<p><strong><code>readline</code>Â æ¨¡å—ï¼šå‘½ä»¤è¡Œäº¤äº’çš„æ ¸å¿ƒ</strong></p>
<ul>
<li>Node.jså†…ç½®æ¨¡å—ï¼Œä¸“é—¨å¤„ç†å‘½ä»¤è¡Œè¾“å…¥è¾“å‡º</li>
<li><code>createInterface</code>åˆ›å»ºè¯»å†™æ¥å£ï¼Œ<code>question</code>æ–¹æ³•å®ç°é—®ç­”å¼äº¤äº’</li>
</ul>
</li>
<li>
<p><strong><code>while(true)</code>ï¼šæŒç»­å¯¹è¯çš„å¼•æ“</strong></p>
<ul>
<li>æ— é™å¾ªç¯ç¡®ä¿å¯¹è¯å¯ä»¥ä¸€ç›´è¿›è¡Œ</li>
<li>æ¯æ¬¡è¿­ä»£å®Œæˆä¸€æ¬¡å®Œæ•´çš„"è¾“å…¥-å¤„ç†-è¾“å‡º"å‘¨æœŸ</li>
<li>è¿™æ˜¯æ‰€æœ‰äº¤äº’å¼å‘½ä»¤è¡Œåº”ç”¨çš„ç»å…¸æ¶æ„æ¨¡å¼</li>
</ul>
</li>
<li>
<p><strong>å¼‚æ­¥æµç¨‹æ§åˆ¶</strong></p>
<ul>
<li>ä½¿ç”¨<code>await</code>ç­‰å¾…ç”¨æˆ·è¾“å…¥å®Œæˆ</li>
<li>ç¡®ä¿ä»£ç æ‰§è¡Œé¡ºåºç¬¦åˆäº¤äº’é€»è¾‘</li>
</ul>
</li>
</ol>
<h3 data-id="heading-8">âœ¨è°ƒç”¨å¤§æ¨¡å‹æœåŠ¡</h3>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†å‰æœŸå‡†å¤‡ï¼šç”³è¯·äº†å¤§æ¨¡å‹æœåŠ¡ï¼Œå¹¶æ„å»ºäº†åŸºç¡€çš„å¯¹è¯å¾ªç¯ã€‚ç°åœ¨åªéœ€å°†ä¸¤éƒ¨åˆ†è¿æ¥èµ·æ¥â€”â€”<strong>å°†å¯¹è¯ä¸Šä¸‹æ–‡å’Œæ¨¡å‹å‚æ•°å‘é€åˆ°æœåŠ¡ç«¯</strong>ã€‚</p>
<p>å¯¹äºé€šä¹‰åƒé—®æ¨¡å‹ï¼Œå¿…é€‰çš„æ ¸å¿ƒå‚æ•°åªæœ‰ä¸¤ä¸ªï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ff8ad4a10f54a3b99f2ac4c380eae44~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2VudHJ5NQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764215716&amp;x-signature=U0flKv1YHBnNdZXJ97y9wKe1NKc%3D" alt="image.png" loading="lazy"/></p>
<p><strong>1. æ¨¡å‹é€‰æ‹© (<code>model</code>)</strong><br/>
æˆ‘ä»¬é€‰æ‹©Â <code>qwen-plus</code>Â ä½œä¸ºæœ¬æ¬¡æ¼”ç¤ºçš„æ¨¡å‹ã€‚</p>
<p><strong>2. å¯¹è¯ä¸Šä¸‹æ–‡ (<code>messages</code>)</strong><br/>
è¿™æ˜¯AIåº”ç”¨çš„æ ¸å¿ƒæœºåˆ¶ï¼Œé€šè¿‡ç»´æŠ¤å®Œæ•´çš„å¯¹è¯å†å²æ¥å®ç°ä¸Šä¸‹æ–‡ç†è§£ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> messages = [
  {
    <span class="hljs-attr">role</span>: <span class="hljs-string">'system'</span>,
    <span class="hljs-attr">content</span>:
      <span class="hljs-string">'ä½ æ˜¯ä¸€ä¸ªå‰ç«¯é«˜æ‰‹ï¼Œèƒ½å¸®æˆ‘è§£ç­”å‰ç«¯å¼€å‘ä¸­é‡åˆ°çš„é—®é¢˜ã€‚æˆ‘å¸Œæœ›ä½ çš„å›ç­”ç²¾ç®€å¹²ç»ƒæœ‰æŠ€æœ¯èŒƒ'</span>,
  },
];
</code></pre>
<p><strong>æ¶ˆæ¯æ ¼å¼è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>system</code>: ç³»ç»Ÿçº§æŒ‡ä»¤ï¼Œè®¾å®šAIçš„åŸºç¡€è¡Œä¸ºå’Œè§’è‰²</li>
<li><code>user</code>: ç”¨æˆ·è¾“å…¥çš„æ¶ˆæ¯</li>
<li><code>assistant</code>: AIçš„å›å¤æ¶ˆæ¯</li>
</ul>
<p><strong>å®Œæ•´çš„APIè°ƒç”¨æµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ç”¨æˆ·è¾“å…¥åï¼Œå°†ç”¨æˆ·è¾“å…¥æ·»åŠ åˆ°ä¸Šä¸‹æ–‡ä¸­</span>
messages.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>, <span class="hljs-attr">content</span>: input });
<span class="hljs-comment">// è°ƒç”¨AIåŠ©æ‰‹</span>
<span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(
  <span class="hljs-string">'https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions'</span>,
  {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
      <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${API_KEY}</span>`</span>, <span class="hljs-comment">// ä½¿ç”¨API_KEYè¿›è¡Œæˆæƒ</span>
    },
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">model</span>: <span class="hljs-string">'qwen-plus'</span>, messages }),
  }
);
<span class="hljs-comment">// è§£æAIåŠ©æ‰‹çš„å›å¤</span>
<span class="hljs-keyword">const</span> reply = (<span class="hljs-keyword">await</span> res.<span class="hljs-title function_">json</span>()).<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>].<span class="hljs-property">message</span>.<span class="hljs-property">content</span>;
<span class="hljs-comment">// å°†AIåŠ©æ‰‹çš„å›å¤æ·»åŠ åˆ°ä¸Šä¸‹æ–‡ä¸­</span>
messages.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">role</span>: <span class="hljs-string">'assistant'</span>, <span class="hljs-attr">content</span>: reply });
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'AIåŠ©æ‰‹:'</span>, reply + <span class="hljs-string">'\n'</span>);
</code></pre>
<p>ç°åœ¨ï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯åŠ¨é¡¹ç›®ï¼Œå°±èƒ½å¾—åˆ°æœ¬æ–‡å¼€å¤´å±•ç¤ºçš„æ™ºèƒ½å¯¹è¯æ•ˆæœäº†ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">node --env-file=.<span class="hljs-built_in">env</span> hello_ai.mjs
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼š<code>--env-file</code>Â å‚æ•°éœ€è¦ Node.js 20.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœä½ çš„ Node.js ç‰ˆæœ¬è¾ƒä½ï¼Œå¯ä»¥ä½¿ç”¨ <code>dotenv</code> åº“åŠ è½½ç¯å¢ƒå˜é‡ã€‚</p>
<h2 data-id="heading-9">æ€è€ƒ</h2>
<h3 data-id="heading-10">å½±å“å¤§æ¨¡å‹åº”ç”¨ä½“éªŒçš„å› ç´ </h3>
<p>æˆ‘ä»¬å®ç°çš„èŠå¤©æœºå™¨äººç•Œé¢ç¡®å®ç›¸å¯¹ç®€é™‹ï¼Œä½†è¿™å¹¶ä¸å¦¨ç¢æˆ‘ä»¬ç†è§£AIåº”ç”¨çš„æ ¸å¿ƒå·¥ä½œåŸç†ã€‚ä»å®ç°è¿‡ç¨‹ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä¸æ¨¡å‹æœåŠ¡äº¤äº’çš„å…³é”®è¦ç´ é›†ä¸­åœ¨ä¸‰ä¸ªæ–¹é¢ï¼š</p>
<h4 data-id="heading-11">1. æ¨¡å‹</h4>
<p>ä»ç¬”è€…æœ€æ—©ä½“éªŒçš„æ¨¡å‹ GPT-2 åˆ°ç°åœ¨çš„ Gemini 3ï¼Œå¤§è¯­è¨€æ¨¡å‹å·²ç»å®Œæˆäº†ä»"äººå·¥æ™ºéšœ"åˆ°"è¶…çº§æ™ºèƒ½åŠ©æ‰‹"çš„è´¨å˜ã€‚æ¨¡å‹åŸºåº§çš„èƒ½åŠ›å†³å®šäº†åº”ç”¨ä½“éªŒçš„ä¸Šé™â€”â€”å†ä¼˜ç§€çš„äº§å“è®¾è®¡ä¹Ÿæ— æ³•è®©è½åæ¨¡å‹äº§å‡ºé«˜è´¨é‡å†…å®¹ã€‚</p>
<h4 data-id="heading-12">2. æç¤ºè¯å·¥ç¨‹</h4>
<p>åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œä»…ç”¨ä¸€è¡Œç®€å•çš„ç³»ç»Ÿæç¤ºè¯è®¾å®šäº†AIçš„è§’è‰²ã€‚ç„¶è€Œåœ¨çœŸå®çš„AIåº”ç”¨ä¸­ï¼Œ<strong>æç¤ºè¯å·¥ç¨‹ï¼ˆPrompt Engineeringï¼‰</strong> Â è¿œéå¦‚æ­¤ç®€å•ï¼Œå®ƒæ˜¯ä¸€é—¨ç›´æ¥å†³å®šæ¨¡å‹è¾“å‡ºè´¨é‡çš„æ·±å¥¥å­¦é—®ã€‚</p>
<p>äº‹å®ä¸Šï¼Œæˆ‘ä¸ªäººåœ¨ç›¸å½“é•¿ä¸€æ®µæ—¶é—´é‡Œéƒ½è®¤ä¸ºæç¤ºè¯â€œæ„ä¹‰ä¸å¤§â€â€”â€”åšä¿¡åªè¦æˆ‘èƒ½æ¸…æ™°ã€å‡†ç¡®åœ°æè¿°éœ€æ±‚ï¼Œå°±èƒ½ç”¨å¥½å¤§æ¨¡å‹ã€‚ç›´åˆ°ä¸¤ä»¶äº‹å½»åº•æ”¹å˜äº†æˆ‘çš„çœ‹æ³•ï¼š</p>
<p>ä¸€æ˜¯çœ‹åˆ°äº†å¼€æºé¡¹ç›®Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fx1xhlol%2Fsystem-prompts-and-models-of-ai-tools" target="_blank" title="https://github.com/x1xhlol/system-prompts-and-models-of-ai-tools" ref="nofollow noopener noreferrer">System Prompts and Models of AI Tools</a>ï¼Œå…¶ä¸­æ”¶é›†äº†ä¼—å¤šçŸ¥åAIåº”ç”¨çš„ç³»ç»Ÿæç¤ºè¯ã€‚é˜…è¯»åæˆ‘æ‰æç„¶å¤§æ‚Ÿï¼šè¿™äº›æˆç†Ÿäº§å“çš„â€œæ™ºèƒ½â€ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šæ­£æ˜¯ä¾èµ–äºè¿™äº›ç²¾å¿ƒè®¾è®¡ã€ç»†èŠ‚ä¸°å¯Œçš„â€œè¯´æ˜ä¹¦â€ã€‚å®ƒä»¬ä¸æ˜¯ç®€å•çš„è§’è‰²è®¾å®šï¼Œè€Œæ˜¯åŒ…å«äº†å¤æ‚çš„è¡Œä¸ºè§„èŒƒã€è¾“å‡ºæ ¼å¼çº¦æŸã€å®‰å…¨è¾¹ç•Œè®¾å®šç­‰ä¸€æ•´å¥—æ§åˆ¶é€»è¾‘ã€‚</p>
<p>äºŒæ˜¯æˆ‘è€æ¿èŠèµ·ä»–å®¶å­©å­ä¸è±†åŒ…APPä¸­é¢„è®¾çš„å¥¥ç‰¹æ›¼è¯­éŸ³èŠå¾—çƒ­ç«æœå¤©ã€‚è¿™ä¸ªçœ‹ä¼¼ç®€å•çš„äº§å“åŠŸèƒ½è®©æˆ‘ä»<strong>å¸‚åœºéœ€æ±‚</strong>çš„è§’åº¦è®¤è¯†åˆ°ï¼šç»å¤§å¤šæ•°ç”¨æˆ·å¹¶ä¸å…·å¤‡â€œç²¾ç¡®æè¿°éœ€æ±‚â€çš„èƒ½åŠ›ï¼Œä»–ä»¬éœ€è¦çš„æ˜¯å¼€ç®±å³ç”¨çš„ã€é¢„è®¾å¥½è§’è‰²å’Œåœºæ™¯çš„æ™ºèƒ½ä½“éªŒã€‚</p>
<p>è¿™ä¸¤ä¸ªä¾‹å­è®©æˆ‘ä»<strong>æŠ€æœ¯å®ç°</strong>ä¸<strong>äº§å“è®¾è®¡</strong>ä¸¤ä¸ªç»´åº¦ï¼Œé‡æ–°è®¤è¯†äº†æç¤ºè¯çš„ä»·å€¼ï¼šå®ƒä¸ä»…æ˜¯æŠ€æœ¯äººå‘˜æŒ–æ˜æ¨¡å‹æ½œåŠ›çš„å·¥å…·ï¼Œæ›´æ˜¯äº§å“å›¢é˜Ÿå°†AIèƒ½åŠ›è½¬åŒ–ä¸ºç”¨æˆ·ä»·å€¼çš„æ ¸å¿ƒæ¡¥æ¢ã€‚</p>
<h4 data-id="heading-13">3. ä¸Šä¸‹æ–‡ç®¡ç†</h4>
<p>åœ¨ç®€çŸ­å¯¹è¯ä¸­ï¼Œä¸Šä¸‹æ–‡çš„å½±å“å¹¶ä¸æ˜æ˜¾ã€‚ä½†éšç€å¯¹è¯è½®æ¬¡å¢åŠ ï¼Œå†å²ä¿¡æ¯çš„æœ‰æ•ˆå­˜å‚¨ã€æ£€ç´¢å’Œå‹ç¼©å°†æˆä¸ºå…³é”®æŒ‘æˆ˜ï¼š</p>
<ul>
<li>å¦‚ä½•ä»é•¿å¯¹è¯ä¸­å‡†ç¡®æå–ç›¸å…³ä¿¡æ¯ï¼Ÿ</li>
<li>é¢å¯¹æ¨¡å‹çš„ä¸Šä¸‹æ–‡é•¿åº¦é™åˆ¶ï¼Œå¦‚ä½•æ™ºèƒ½å‹ç¼©å†å²è®°å½•ï¼Ÿ</li>
<li>å¤šè½®å¯¹è¯ä¸­çš„ä¿¡æ¯ä¸€è‡´æ€§å¦‚ä½•ä¿è¯ï¼Ÿ</li>
</ul>
<h3 data-id="heading-14">å‰ç«¯å·¥ç¨‹å¸ˆçš„AIæ—¶ä»£æœºé‡</h3>
<p>éœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œä¸€åå‰ç«¯å·¥ç¨‹å¸ˆï¼Œé¦–å…ˆåº”æ˜¯ä¸€ååˆæ ¼çš„<strong>è½¯ä»¶å·¥ç¨‹å¸ˆ</strong>ã€‚å¦‚æœä½ çš„æŠ€èƒ½æ ˆé•¿æœŸå±€é™äºâ€œä½¿ç”¨æ¡†æ¶ç¼–å†™ç®¡ç†åå°é¡µé¢â€ï¼Œè€Œå¯¹è®¡ç®—æœºç½‘ç»œã€æ“ä½œç³»ç»Ÿã€æ•°æ®åº“ç­‰è®¡ç®—æœºåŸºç¡€çŸ¥ä¹‹ç”šå°‘ï¼Œé‚£ä¹ˆä½ å°†é¢ä¸´çš„æŒ‘æˆ˜å¯èƒ½å¹¶éæ¥è‡ªAIï¼Œè€Œæ˜¯æ¥è‡ªæ¯å¹´æ¶Œå…¥å°±ä¸šå¸‚åœºçš„ã€å…·å¤‡æ‰å®ç§‘ç­åŸºç¡€çš„åº”å±Šç”Ÿã€‚</p>
<p>åœ¨æ­¤å…±è¯†ä¹‹ä¸Šï¼Œæˆ‘ä»¬å†æ¥çœ‹å‰ç«¯å¼€å‘è€…åœ¨AIæ—¶ä»£çš„ç‹¬ç‰¹æœºé‡ã€‚ä¸ä¼ ç»Ÿåº”ç”¨ï¼ˆå¦‚ç”µå•†ã€ç›´æ’­ï¼‰å°†ä¸šåŠ¡é€»è¾‘å’Œé«˜å¹¶å‘å‹åŠ›é›†ä¸­äºåç«¯ä¸åŒï¼ŒAIåŸç”Ÿåº”ç”¨ä¸‹çš„æ¸¸æˆè§„åˆ™å‘ç”Ÿäº†æ”¹å˜ï¼š</p>
<p>åœ¨ä¼ ç»Ÿæ¶æ„ä¸­ï¼Œåƒç”µå•†ç§’æ€ã€ç›´æ’­å¼¹å¹•è¿™ç±»åœºæ™¯ï¼Œæ ¸å¿ƒå¤æ‚åº¦åœ¨äºåç«¯çš„<strong>é«˜å¹¶å‘ã€åˆ†å¸ƒå¼äº‹åŠ¡å’Œæ•°æ®ä¸€è‡´æ€§</strong>ï¼Œè¿™é€šå¸¸æ˜¯Java/Goç­‰è¯­è¨€çš„å¼ºåœºï¼ŒNode.jsåœ¨å…¶ä¸­ç¡®å®å­˜åœ¨ç”Ÿæ€å’Œæ€§èƒ½çš„å±€é™æ€§ã€‚</p>
<p>ä½†åœ¨AIåº”ç”¨æ¶æ„ä¸­ï¼š</p>
<ul>
<li><strong>è®¡ç®—å‹åŠ›è½¬ç§»</strong>ï¼šæœ€æ¶ˆè€—è®¡ç®—èµ„æºçš„æ¨¡å‹æ¨ç†ç”±äº‘æœåŠ¡å•†ï¼ˆå¦‚é˜¿é‡Œäº‘ã€OpenAIï¼‰æ‰¿æ‹…</li>
<li><strong>åç«¯è§’è‰²è½¬å˜</strong>ï¼šåº”ç”¨è‡ªèº«çš„åç«¯è¢«é‡æ„ä¸º<strong>è½»é‡ä¸­å°</strong>ï¼Œæ ¸å¿ƒèŒè´£æ˜¯<strong>è·¯ç”±APIè¯·æ±‚ã€ç®¡ç†å¯¹è¯ä¸Šä¸‹æ–‡ã€å¤„ç†ç®€å•çš„ä¸šåŠ¡çŠ¶æ€</strong></li>
<li><strong>æŠ€æœ¯æ ˆé¸¿æ²Ÿæ¶ˆå¤±</strong>ï¼šå¯¹äºè¿™ç±»I/Oå¯†é›†å‹çš„è½»é‡åå°ï¼ŒNode.jsçš„æ€§èƒ½å’Œå¼€å‘æ•ˆç‡åè€Œæˆä¸ºä¼˜åŠ¿</li>
</ul>
<p>å¦‚æ­¤ä¸€æ¥ï¼Œä¸€ä¸ªè®¡ç®—æœºåŸºç¡€è‰¯å¥½çš„å‰ç«¯å·¥ç¨‹å¸ˆï¼Œå®ç°å…¨æ ˆAIåº”ç”¨çš„æŠ€æœ¯é—¨æ§›å·²å¤§å¹…é™ä½ã€‚</p>
<p>æ­¤å¤–ï¼Œåœ¨ç¬”è€…æ‰€å¤„çš„ç”µå•†è¡Œä¸šï¼Œæ— è®ºæ˜¯é¢å‘ç”¨æˆ·çš„æ¨èã€å¹¿å‘Šã€ç§’æ€ç³»ç»Ÿï¼Œè¿˜æ˜¯åå°çš„ç´ æã€è®¢å•ç®¡ç†ï¼Œå‰ç«¯å¾€å¾€è¢«å®šä½ä¸º"ç•Œé¢çš„å®ç°è€…"â€”â€”æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å®Œå…¨ç”±åç«¯æŒæ§ã€‚å³ä¾¿å­˜åœ¨å°‘æ•°é‡å‰ç«¯çš„ä¸šåŠ¡åœºæ™¯ï¼ˆå¦‚åœ¨çº¿æ–‡æ¡£ã€è®¾è®¡å·¥å…·ã€äº’åŠ¨æ¸¸æˆï¼‰ï¼Œå…¶å¯¹æ ¸å¿ƒä¸šåŠ¡æŒ‡æ ‡çš„å½±å“ä¹Ÿç›¸å¯¹æœ‰é™ã€‚</p>
<p>è€ŒAIåº”ç”¨æœ‰æœ›æ”¹å†™è¿™ä¸€ä¼ ç»Ÿæ¨¡å¼ã€‚å½“æ‰€æœ‰å¼€å‘è€…çš„åº•å±‚éƒ½æ˜¯è°ƒç”¨ç›¸åŒçš„å¤§æ¨¡å‹æœåŠ¡æ—¶ï¼Œ<strong>äº§å“çš„å·®å¼‚åŒ–ç«äº‰åŠ›å°±è½¬ç§»åˆ°äº†åº”ç”¨å±‚</strong>â€”â€”è°èƒ½ä¸ºæ¨¡å‹èƒ½åŠ›å¥—ä¸Šæ›´ä¼˜ç§€çš„â€œå£³â€ï¼Œè°å°±èƒ½èµ¢å¾—ç”¨æˆ·ã€‚</p>
<p>å› æ­¤ï¼Œå‰ç«¯å·¥ç¨‹å¸ˆçš„æœºé‡æˆ–è®¸åœ¨äºï¼šå°†å¯¹äº¤äº’ä¸ä½“éªŒçš„æ·±åˆ»ç†è§£ï¼Œè½¬åŒ–ä¸ºè®¾è®¡æ¨¡å‹èƒ½åŠ›â€œäº¤äº’æ¶æ„â€çš„ä¼˜åŠ¿ï¼Œå¹¶å‡­å€Ÿå…¨æ ˆæŠ€èƒ½ï¼Œç‹¬ç«‹å®Œæˆä»åˆ›æ„åˆ°äº§å“çš„ç«¯åˆ°ç«¯å®ç°ã€‚è¿™æ­£æ˜¯å‰ç«¯è§’è‰²ä»ç•Œé¢å®ç°è€…ï¼Œå‘è¶…çº§ä¸ªä½“æ¼”è¿›çš„å…³é”®ä¸€æ­¥ã€‚</p>
<h2 data-id="heading-15">ç»“è¯­</h2>
<p>å½“ç„¶ï¼Œç”Ÿäº§çº§AIåº”ç”¨è¿œéå¦‚æ­¤ç®€å•ã€‚åç»­æˆ‘ä»¬å°†æ·±å…¥æ¶æ„ã€ä¸Šä¸‹æ–‡ä¸æç¤ºè¯ç­‰æ ¸å¿ƒé¢†åŸŸï¼Œå…±åŒå°†åŸå‹æ¼”è¿›ä¸ºä¸€ä¸ªå¥å£®çš„AIåº”ç”¨ã€‚è¿™æ˜¯ä¸€ä¸ªç³»ç»Ÿå·¥ç¨‹ï¼Œæˆ‘ä»¬ä¸‹ä¸€ç¯‡æ–‡ç« è§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Pythonä¸­å¦‚ä½•å¤„ç†Socketè¶…æ—¶æ·±åº¦å¥½æ–‡]]></title>    <link>https://juejin.cn/post/7574357603406757938</link>    <guid>https://juejin.cn/post/7574357603406757938</guid>    <pubDate>2025-11-20T03:54:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574357603406757938" data-draft-id="7574382900859568155" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Pythonä¸­å¦‚ä½•å¤„ç†Socketè¶…æ—¶æ·±åº¦å¥½æ–‡"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2025-11-20T03:54:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·234526700982"/> <meta itemprop="url" content="https://juejin.cn/user/3062604336999771"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Pythonä¸­å¦‚ä½•å¤„ç†Socketè¶…æ—¶æ·±åº¦å¥½æ–‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3062604336999771/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·234526700982
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:54:16.000Z" title="Thu Nov 20 2025 03:54:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Pythonä¸­å¦‚ä½•å¤„ç†Socketè¶…æ—¶æ·±åº¦å¥½æ–‡</h2>
<p>@<a href="https://link.juejin.cn?target=%25E6%2596%2587%25E7%25AB%25A0%25E7%259B%25AE%25E5%25BD%2595" target="_blank" title="%E6%96%87%E7%AB%A0%E7%9B%AE%E5%BD%95" ref="nofollow noopener noreferrer">TOC</a></p>
<hr/>
<h3 data-id="heading-1">å¼€ç¯‡å¼•è¨€</h3>
<p>åœ¨ç½‘ç»œç¼–ç¨‹ä¸­ï¼ŒSocketæ˜¯å®ç°ç½‘ç»œé€šä¿¡çš„åŸºç¡€ã€‚ç„¶è€Œï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œç”±äºç½‘ç»œä¸ç¨³å®šã€æœåŠ¡å™¨å“åº”æ…¢ç­‰åŸå› ï¼ŒSocketè¿æ¥å¯èƒ½ä¼šå‡ºç°è¶…æ—¶çš„æƒ…å†µã€‚æ­£ç¡®å¤„ç†Socketè¶…æ—¶ä¸ä»…èƒ½å¤Ÿæé«˜ç¨‹åºçš„å¥å£®æ€§ï¼Œè¿˜èƒ½æå‡ç”¨æˆ·ä½“éªŒã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨Pythonä¸­å¦‚ä½•å¤„ç†Socketè¶…æ—¶ï¼Œå¹¶æä¾›å®Œæ•´çš„ä»£ç ç¤ºä¾‹å’Œæœ€ä½³å®è·µã€‚</p>
<h3 data-id="heading-2">æ ¸å¿ƒè¦ç‚¹</h3>
<ol>
<li>è®¾ç½®Socketè¶…æ—¶</li>
<li>å¤„ç†è¶…æ—¶å¼‚å¸¸</li>
<li>ä½¿ç”¨<code>select</code>æ¨¡å—è¿›è¡Œéé˜»å¡I/O</li>
<li>å®é™…åº”ç”¨æ¡ˆä¾‹ï¼šçŒ´å­éŸ³æ‚¦100ä¸‡æ­£ç‰ˆéŸ³ä¹</li>
</ol>
<h3 data-id="heading-3">é€ä¸€æ·±å…¥è®²è§£æ¯ä¸ªè¦ç‚¹</h3>
<h4 data-id="heading-4">1. è®¾ç½®Socketè¶…æ—¶</h4>
<p>åœ¨Pythonä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>settimeout</code>æ–¹æ³•æ¥è®¾ç½®Socketçš„è¶…æ—¶æ—¶é—´ã€‚å¦‚æœåœ¨æŒ‡å®šæ—¶é—´å†…æ²¡æœ‰å®Œæˆæ“ä½œï¼Œå°†ä¼šæŠ›å‡º<code>socket.timeout</code>å¼‚å¸¸ã€‚</p>
<h5 data-id="heading-5">åŸç†</h5>
<p><code>settimeout</code>æ–¹æ³•æ¥å—ä¸€ä¸ªæµ®ç‚¹æ•°ä½œä¸ºå‚æ•°ï¼Œå•ä½ä¸ºç§’ã€‚å¦‚æœè®¾ç½®ä¸º0ï¼Œè¡¨ç¤ºä¸ç­‰å¾…ï¼Œç«‹å³è¿”å›ï¼›å¦‚æœè®¾ç½®ä¸ºNoneï¼Œè¡¨ç¤ºæ— é™æœŸç­‰å¾…ã€‚</p>
<h5 data-id="heading-6">å®Œæ•´ä»£ç ç¤ºä¾‹</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> socket

<span class="hljs-keyword">def</span> <span class="hljs-title function_">create_socket_with_timeout</span>(<span class="hljs-params">timeout</span>):
    <span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªTCP/IP socket</span>
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    <span class="hljs-comment"># è®¾ç½®è¶…æ—¶æ—¶é—´</span>
    sock.settimeout(timeout)

    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># å°è¯•è¿æ¥åˆ°æœåŠ¡å™¨</span>
        sock.connect((<span class="hljs-string">'example.com'</span>, <span class="hljs-number">80</span>))
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"è¿æ¥æˆåŠŸ"</span>)
    <span class="hljs-keyword">except</span> socket.timeout:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"è¿æ¥è¶…æ—¶"</span>)
    <span class="hljs-keyword">finally</span>:
        sock.close()

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    create_socket_with_timeout(<span class="hljs-number">5</span>)  <span class="hljs-comment"># è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º5ç§’</span>
</code></pre>
<h5 data-id="heading-7">å…³é”®è¯´æ˜</h5>
<ul>
<li><code>settimeout</code>æ–¹æ³•å¯ä»¥åœ¨è¿æ¥ã€å‘é€å’Œæ¥æ”¶æ•°æ®æ—¶ç”Ÿæ•ˆã€‚</li>
<li>è¶…æ—¶æ—¶é—´è®¾ç½®å¾—è¿‡çŸ­å¯èƒ½å¯¼è‡´é¢‘ç¹çš„è¶…æ—¶å¼‚å¸¸ï¼Œè¿‡é•¿åˆ™å¯èƒ½å½±å“ç”¨æˆ·ä½“éªŒã€‚</li>
</ul>
<h4 data-id="heading-8">2. å¤„ç†è¶…æ—¶å¼‚å¸¸</h4>
<p>åœ¨è®¾ç½®äº†è¶…æ—¶æ—¶é—´åï¼Œéœ€è¦æ­£ç¡®å¤„ç†å¯èƒ½å‡ºç°çš„<code>socket.timeout</code>å¼‚å¸¸ã€‚</p>
<h5 data-id="heading-9">åŸç†</h5>
<p><code>socket.timeout</code>æ˜¯ä¸€ä¸ªç‰¹å®šçš„å¼‚å¸¸ç±»å‹ï¼Œå½“Socketæ“ä½œè¶…æ—¶æ—¶ä¼šæŠ›å‡ºè¯¥å¼‚å¸¸ã€‚é€šè¿‡æ•è·è¿™ä¸ªå¼‚å¸¸ï¼Œå¯ä»¥ä¼˜é›…åœ°å¤„ç†è¶…æ—¶æƒ…å†µã€‚</p>
<h5 data-id="heading-10">å®Œæ•´ä»£ç ç¤ºä¾‹</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> socket

<span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_socket_timeout</span>():
    <span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªTCP/IP socket</span>
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    <span class="hljs-comment"># è®¾ç½®è¶…æ—¶æ—¶é—´</span>
    sock.settimeout(<span class="hljs-number">5</span>)

    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># å°è¯•è¿æ¥åˆ°æœåŠ¡å™¨</span>
        sock.connect((<span class="hljs-string">'example.com'</span>, <span class="hljs-number">80</span>))
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"è¿æ¥æˆåŠŸ"</span>)

        <span class="hljs-comment"># å‘é€HTTPè¯·æ±‚</span>
        sock.sendall(<span class="hljs-string">b'GET / HTTP/1.1\r\nHost: example.com\r\n\r\n'</span>)

        <span class="hljs-comment"># æ¥æ”¶æ•°æ®</span>
        data = sock.recv(<span class="hljs-number">1024</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ¥æ”¶åˆ°çš„æ•°æ®:"</span>, data)
    <span class="hljs-keyword">except</span> socket.timeout:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ“ä½œè¶…æ—¶"</span>)
    <span class="hljs-keyword">finally</span>:
        sock.close()

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    handle_socket_timeout()
</code></pre>
<h5 data-id="heading-11">å…³é”®è¯´æ˜</h5>
<ul>
<li>æ•è·<code>socket.timeout</code>å¼‚å¸¸å¯ä»¥é¿å…ç¨‹åºå› è¶…æ—¶è€Œå´©æºƒã€‚</li>
<li>åœ¨æ•è·å¼‚å¸¸åï¼Œå¯ä»¥æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œé‡è¯•æˆ–å…¶ä»–å¤„ç†ã€‚</li>
</ul>
<h4 data-id="heading-12">3. ä½¿ç”¨<code>select</code>æ¨¡å—è¿›è¡Œéé˜»å¡I/O</h4>
<p><code>select</code>æ¨¡å—å¯ä»¥ç”¨äºç›‘æ§å¤šä¸ªSocketçš„çŠ¶æ€ï¼Œå®ç°éé˜»å¡I/Oã€‚</p>
<h5 data-id="heading-13">åŸç†</h5>
<p><code>select</code>æ¨¡å—æä¾›äº†<code>select</code>å‡½æ•°ï¼Œå¯ä»¥åŒæ—¶ç›‘æ§å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ˆå¦‚Socketï¼‰çš„è¯»å†™çŠ¶æ€ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥é¿å…Socketæ“ä½œé˜»å¡ä¸»çº¿ç¨‹ã€‚</p>
<h5 data-id="heading-14">å®Œæ•´ä»£ç ç¤ºä¾‹</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> socket
<span class="hljs-keyword">import</span> select

<span class="hljs-keyword">def</span> <span class="hljs-title function_">use_select_for_non_blocking_io</span>():
    <span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªTCP/IP socket</span>
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    <span class="hljs-comment"># è®¾ç½®ä¸ºéé˜»å¡æ¨¡å¼</span>
    sock.setblocking(<span class="hljs-literal">False</span>)

    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># å°è¯•è¿æ¥åˆ°æœåŠ¡å™¨</span>
        sock.connect((<span class="hljs-string">'example.com'</span>, <span class="hljs-number">80</span>))
    <span class="hljs-keyword">except</span> BlockingIOError:
        <span class="hljs-keyword">pass</span>

    <span class="hljs-comment"># ä½¿ç”¨selectç›‘æ§è¿æ¥çŠ¶æ€</span>
    ready_to_read, _, _ = select.select([sock], [], [], <span class="hljs-number">5</span>)

    <span class="hljs-keyword">if</span> ready_to_read:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"è¿æ¥æˆåŠŸ"</span>)

        <span class="hljs-comment"># å‘é€HTTPè¯·æ±‚</span>
        sock.sendall(<span class="hljs-string">b'GET / HTTP/1.1\r\nHost: example.com\r\n\r\n'</span>)

        <span class="hljs-comment"># æ¥æ”¶æ•°æ®</span>
        data = sock.recv(<span class="hljs-number">1024</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ¥æ”¶åˆ°çš„æ•°æ®:"</span>, data)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"è¿æ¥è¶…æ—¶"</span>)

    sock.close()

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    use_select_for_non_blocking_io()
</code></pre>
<h5 data-id="heading-15">å…³é”®è¯´æ˜</h5>
<ul>
<li><code>select</code>æ¨¡å—å¯ä»¥åŒæ—¶ç›‘æ§å¤šä¸ªSocketçš„çŠ¶æ€ï¼Œé€‚ç”¨äºå¤šè·¯å¤ç”¨åœºæ™¯ã€‚</li>
<li>éé˜»å¡æ¨¡å¼ä¸‹ï¼ŒSocketæ“ä½œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œä½†éœ€è¦æ‰‹åŠ¨å¤„ç†å„ç§çŠ¶æ€å˜åŒ–ã€‚</li>
</ul>
<h3 data-id="heading-16">å®é™…åº”ç”¨æ¡ˆä¾‹</h3>
<p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨åº”ç”¨â€œçŒ´å­éŸ³æ‚¦100ä¸‡æ­£ç‰ˆéŸ³ä¹â€ï¼Œéœ€è¦ä»æœåŠ¡å™¨ä¸‹è½½éŸ³ä¹æ–‡ä»¶ã€‚ä¸ºäº†ç¡®ä¿ç”¨æˆ·ä½“éªŒï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†Socketè¶…æ—¶é—®é¢˜ã€‚</p>
<h5 data-id="heading-17">åº”ç”¨åœºæ™¯</h5>
<ul>
<li>ç”¨æˆ·ç‚¹å‡»æ’­æ”¾æŒ‰é’®æ—¶ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨è¯·æ±‚éŸ³ä¹æ–‡ä»¶ã€‚</li>
<li>å¦‚æœè¯·æ±‚è¶…æ—¶ï¼Œå®¢æˆ·ç«¯åº”æç¤ºç”¨æˆ·å¹¶å°è¯•é‡æ–°è¿æ¥ã€‚</li>
</ul>
<h5 data-id="heading-18">ä»£ç ç¤ºä¾‹</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> socket

<span class="hljs-keyword">def</span> <span class="hljs-title function_">download_music_file</span>(<span class="hljs-params">url</span>):
    <span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªTCP/IP socket</span>
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    <span class="hljs-comment"># è®¾ç½®è¶…æ—¶æ—¶é—´</span>
    sock.settimeout(<span class="hljs-number">10</span>)

    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># è§£æURLè·å–ä¸»æœºå’Œç«¯å£</span>
        host, port = url.split(<span class="hljs-string">':'</span>)
        port = <span class="hljs-built_in">int</span>(port)

        <span class="hljs-comment"># è¿æ¥åˆ°æœåŠ¡å™¨</span>
        sock.connect((host, port))

        <span class="hljs-comment"># å‘é€HTTPè¯·æ±‚</span>
        sock.sendall(<span class="hljs-string">f'GET <span class="hljs-subst">{url}</span> HTTP/1.1\r\nHost: <span class="hljs-subst">{host}</span>\r\n\r\n'</span>.encode())

        <span class="hljs-comment"># æ¥æ”¶æ•°æ®</span>
        data = <span class="hljs-string">b''</span>
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            chunk = sock.recv(<span class="hljs-number">1024</span>)
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> chunk:
                <span class="hljs-keyword">break</span>
            data += chunk

        <span class="hljs-comment"># ä¿å­˜éŸ³ä¹æ–‡ä»¶</span>
        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'music.mp3'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:
            f.write(data)

        <span class="hljs-built_in">print</span>(<span class="hljs-string">"éŸ³ä¹æ–‡ä»¶ä¸‹è½½æˆåŠŸ"</span>)
    <span class="hljs-keyword">except</span> socket.timeout:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ä¸‹è½½è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥"</span>)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‘ç”Ÿé”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)
    <span class="hljs-keyword">finally</span>:
        sock.close()

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    download_music_file(<span class="hljs-string">'example.com:80/music.mp3'</span>)
</code></pre>
<h5 data-id="heading-19">å…³é”®è¯´æ˜</h5>
<ul>
<li>é€šè¿‡è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´ï¼Œå¯ä»¥é¿å…é•¿æ—¶é—´ç­‰å¾…å¯¼è‡´çš„ç”¨æˆ·ä½“éªŒä¸‹é™ã€‚</li>
<li>åœ¨æ•è·è¶…æ—¶å¼‚å¸¸åï¼Œå¯ä»¥æç¤ºç”¨æˆ·å¹¶å°è¯•é‡æ–°è¿æ¥ã€‚</li>
</ul>
<h3 data-id="heading-20">æ€»ç»“</h3>
<p>æœ¬æ–‡æ·±å…¥æ¢è®¨äº†Pythonä¸­å¤„ç†Socketè¶…æ—¶çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬è®¾ç½®è¶…æ—¶æ—¶é—´ã€å¤„ç†è¶…æ—¶å¼‚å¸¸ä»¥åŠä½¿ç”¨<code>select</code>æ¨¡å—è¿›è¡Œéé˜»å¡I/Oã€‚é€šè¿‡è¿™äº›æ–¹æ³•ï¼Œå¯ä»¥æœ‰æ•ˆæé«˜ç¨‹åºçš„å¥å£®æ€§å’Œç”¨æˆ·ä½“éªŒã€‚å¸Œæœ›æœ¬æ–‡èƒ½å¸®åŠ©ä½ åœ¨å®é™…é¡¹ç›®ä¸­æ›´å¥½åœ°å¤„ç†Socketè¶…æ—¶é—®é¢˜ã€‚</p>
<hr/>
<h3 data-id="heading-21">æ€»ç»“</h3>
<p>æœ¬æ–‡æ·±å…¥æ¢è®¨äº†Pythonä¸­å¦‚ä½•å¤„ç†Socketè¶…æ—¶æ·±åº¦å¥½æ–‡çš„ç›¸å…³æŠ€æœ¯ï¼Œä»åŸç†åˆ°å®è·µï¼Œä»åŸºç¡€åˆ°è¿›é˜¶ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©è¯»è€…å…¨é¢æŒæ¡è¿™ä¸€æŠ€æœ¯ã€‚</p>
<h3 data-id="heading-22">å»¶ä¼¸é˜…è¯»</h3>
<ul>
<li>å»ºè®®ç»“åˆå®é™…é¡¹ç›®è¿›è¡Œç»ƒä¹ </li>
<li>æ·±å…¥é˜…è¯»ç›¸å…³æŠ€æœ¯æ–‡æ¡£</li>
<li>å…³æ³¨æŠ€æœ¯ç¤¾åŒºçš„æœ€æ–°åŠ¨æ€</li>
</ul>
<blockquote>
<p>æœ¬æ–‡ç»è¿‡ç²¾å¿ƒç¼–å†™å’Œä¼˜åŒ–ï¼Œå¦‚æœ‰ä¸å‡†ç¡®ä¹‹å¤„ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºæŒ‡å‡ºã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åç«¯ä»£ç éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é…ç½®æ•°æ®åº“ï¼Œpm2è¿›ç¨‹ç®¡ç†å‘å¸ƒ(å››)]]></title>    <link>https://juejin.cn/post/7574369095543799842</link>    <guid>https://juejin.cn/post/7574369095543799842</guid>    <pubDate>2025-11-20T03:22:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574369095543799842" data-draft-id="7574276404597112884" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åç«¯ä»£ç éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é…ç½®æ•°æ®åº“ï¼Œpm2è¿›ç¨‹ç®¡ç†å‘å¸ƒ(å››)"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯"/> <meta itemprop="datePublished" content="2025-11-20T03:22:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°èƒ–éœ"/> <meta itemprop="url" content="https://juejin.cn/user/3790771822016301"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åç«¯ä»£ç éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é…ç½®æ•°æ®åº“ï¼Œpm2è¿›ç¨‹ç®¡ç†å‘å¸ƒ(å››)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3790771822016301/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°èƒ–éœ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:22:53.000Z" title="Thu Nov 20 2025 03:22:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰ç½®ç³»åˆ—æ–‡ç« </h2>
<p><a href="https://juejin.cn/post/7563853874815451171" target="_blank" title="https://juejin.cn/post/7563853874815451171">ä»é›¶å¼€å§‹ï¼šåœ¨é˜¿é‡Œäº‘ Ubuntu æœåŠ¡å™¨éƒ¨ç½² Node+Express æ¥å£(ä¸€)</a></p>
<p><a href="https://juejin.cn/post/7565268465708695592" target="_blank" title="https://juejin.cn/post/7565268465708695592">é˜¿é‡Œäº‘åŸŸåè§£æ + Nginx åå‘ä»£ç† + HTTPS å…¨æµç¨‹ï¼šä» IP è®¿é—®åˆ°åŠ å¯†åŸŸåçš„å®Œæ•´é…ç½®ï¼ˆäºŒï¼‰</a></p>
<p><a href="https://juejin.cn/spost/7574245788949004303" target="_blank" title="https://juejin.cn/spost/7574245788949004303">Node+Express+MySQL å®ç°æ³¨å†ŒåŠŸèƒ½(ä¸‰)</a></p>
<p>å°†ä»£ç å’Œæ•°æ®åº“å‘å¸ƒåˆ°é˜¿é‡Œäº‘è½»é‡æœåŠ¡å™¨ï¼ˆUbuntuï¼‰çš„æ ¸å¿ƒæµç¨‹æ˜¯ï¼š<strong>æœ¬åœ°å‡†å¤‡ â†’ æœåŠ¡å™¨ç¯å¢ƒé…ç½® â†’ ä»£ç éƒ¨ç½²ï¼ˆå«å®‰å…¨ä¼ è¾“é…ç½®æ–‡ä»¶ï¼‰ â†’ æ•°æ®åº“è¿ç§» â†’ å¯åŠ¨æœåŠ¡</strong>ã€‚ä»¥ä¸‹æ˜¯å¾ªåºæ¸è¿›çš„è¯¦ç»†æ­¥éª¤ï¼Œé‡ç‚¹è§£å†³Â <code>.env.production</code>Â ä¸æäº¤åˆ° Git çš„é—®é¢˜ï¼š</p>
<h4 data-id="heading-1">ä¸€ã€æœ¬åœ°å‡†å¤‡å·¥ä½œï¼ˆç¡®ä¿ä»£ç å¯éƒ¨ç½²ï¼‰</h4>
<h5 data-id="heading-2">1. æ£€æŸ¥æœ¬åœ°ä»£ç è§„èŒƒ</h5>
<ul>
<li><strong>ç¡®è®¤Â <code>.gitignore</code>Â é…ç½®</strong>ï¼šç¡®ä¿å·²å¿½ç•¥æ•æ„Ÿæ–‡ä»¶ï¼Œé¿å…æäº¤åˆ° Gitï¼š</li>
</ul>
<pre><code class="hljs language-env" lang="env"># é¡¹ç›®æ ¹ç›®å½•çš„ .gitignore æ–‡ä»¶å¿…é¡»åŒ…å«ä»¥ä¸‹å†…å®¹
.env.development
.env.production
.env.test
node_modules/
</code></pre>
<h5 data-id="heading-3">2. å¯¼å‡ºæœ¬åœ°æ•°æ®åº“ç»“æ„ï¼ˆç”¨äºæœåŠ¡å™¨åˆå§‹åŒ–ï¼‰</h5>
<p>åœ¨mysql workBenchä¸­åˆ°å‡ºæœ¬åœ°æ•°æ®åº“mydbï¼Œåªéœ€è¦å¯¼å‡ºæ•°æ®ç»“æ„ï¼Œä¼šæœ‰ä¸€ä¸ªsqlæ–‡ä»¶å¯¼åˆ°æœ¬åœ°ï¼Œå¯ä»¥è‡ªå·±å‘½åï¼Œæˆ‘çš„å«my_db.sql</p>
<h4 data-id="heading-4">äºŒã€æœåŠ¡å™¨ç¯å¢ƒå‡†å¤‡ï¼ˆé˜¿é‡Œäº‘ Ubuntuï¼‰</h4>
<h5 data-id="heading-5">1. ç™»å½•æœåŠ¡å™¨</h5>
<p>é€šè¿‡ç»ˆç«¯ç™»å½•é˜¿é‡Œäº‘è½»é‡æœåŠ¡å™¨ï¼ˆæ›¿æ¢ä¸ºä½ çš„æœåŠ¡å™¨å…¬ç½‘ IPï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ssh root@ä½ çš„æœåŠ¡å™¨å…¬ç½‘IP <span class="hljs-comment"># ä¾‹å¦‚ï¼šssh root@120.78.xxx.xxx</span>
</code></pre>
<p>è¾“å…¥æœåŠ¡å™¨ç™»å½•å¯†ç </p>
<h5 data-id="heading-6">2. å®‰è£…å¿…è¦è½¯ä»¶</h5>
<p>å¦‚æœæœåŠ¡å™¨æœªå®‰è£…ä»¥ä¸‹è½¯ä»¶ï¼Œä¾æ¬¡æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ›´æ–°ç³»ç»Ÿ</span>
sudo apt update &amp;&amp; sudo apt upgrade -y

<span class="hljs-comment"># å®‰è£… Node.jsï¼ˆæ¨è v16+ï¼‰</span>
curl -fsSL https://deb.nodesource.com/setup_16.x | sudo -E bash -
sudo apt install -y nodejs

<span class="hljs-comment"># å®‰è£… MySQL æœåŠ¡å™¨ï¼ˆç”Ÿäº§ç¯å¢ƒæ•°æ®åº“ï¼‰</span>
sudo apt install -y mysql-server

<span class="hljs-comment"># å®‰è£… PM2ï¼ˆNode æœåŠ¡è¿›ç¨‹ç®¡ç†å·¥å…·ï¼‰</span>
sudo npm install pm2 -g

<span class="hljs-comment"># å®‰è£… Nginxï¼ˆåå‘ä»£ç†ã€é™æ€èµ„æºæœåŠ¡ï¼‰</span>
sudo apt install -y nginx
</code></pre>
<h5 data-id="heading-7">3. é…ç½®æœåŠ¡å™¨ MySQLï¼ˆç”Ÿäº§ç¯å¢ƒæ•°æ®åº“ï¼‰</h5>
<h6 data-id="heading-8">æ­¥éª¤ä¸€ï¼šåˆå§‹åŒ– MySQL å¹¶åˆ›å»ºç”Ÿäº§æ•°æ®åº“</h6>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç™»å½•MySQLï¼ˆUbuntuåˆå§‹æ— å¯†ç ï¼Œç›´æ¥å›è½¦ï¼‰</span>
sudo mysql -u root -p

<span class="hljs-comment"># è®¾ç½®rootå¯†ç ï¼ˆè‡ªå®šä¹‰å¼ºå¯†ç ï¼Œå¦‚Server@Mysql2024ï¼‰</span>
ALTER USER <span class="hljs-string">'root'</span>@<span class="hljs-string">'localhost'</span> IDENTIFIED WITH mysql_native_password BY <span class="hljs-string">'ä½ çš„rootå¯†ç '</span>;
FLUSH PRIVILEGES;

<span class="hljs-comment"># åˆ›å»ºç”Ÿäº§æ•°æ®åº“ï¼ˆä¸é¡¹ç›®.env.productionä¸€è‡´,mydb_prodæ˜¯æ•°æ®åº“åï¼‰</span>
CREATE DATABASE mydb_prod CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

<span class="hljs-comment"># åˆ›å»ºæ•°æ®åº“ä¸“ç”¨ç”¨æˆ·ï¼ˆé¿å…rootç›´æ¥æ“ä½œï¼‰</span>
CREATE USER <span class="hljs-string">'prod_user'</span>@<span class="hljs-string">'%'</span> IDENTIFIED BY <span class="hljs-string">'Prod@2024'</span>;

<span class="hljs-comment"># æˆäºˆç”¨æˆ·æ•°æ®åº“æƒé™</span>
GRANT ALL PRIVILEGES ON mydb_prod.* TO <span class="hljs-string">'prod_user'</span>@<span class="hljs-string">'%'</span>;

<span class="hljs-comment"># åˆ·æ–°æƒé™</span>
FLUSH PRIVILEGES;

<span class="hljs-comment"># é€€å‡ºMySQL</span>
EXIT;
</code></pre>
<p><code>.env.productionå¦‚ä¸‹</code></p>
<pre><code class="hljs language-js" lang="js"># ç¯å¢ƒæ ‡è¯†
<span class="hljs-variable constant_">NODE_ENV</span>=production

# æ•°æ®åº“é…ç½®ï¼ˆæœåŠ¡å™¨æ•°æ®åº“ä¿¡æ¯ï¼Œå˜é‡åä¸å¼€å‘ç¯å¢ƒå®Œå…¨ä¸€è‡´ï¼‰
<span class="hljs-variable constant_">NODE_ENV</span>=production
<span class="hljs-variable constant_">DB_HOST</span>=localhost  # æœåŠ¡å™¨æ•°æ®åº“åœ¨æœ¬åœ°ï¼Œå¡«localhost
<span class="hljs-variable constant_">DB_PORT</span>=<span class="hljs-number">3306</span>
<span class="hljs-variable constant_">DB_USER</span>=prod_user  # æ­¥éª¤<span class="hljs-number">3</span>åˆ›å»ºçš„ä¸“ç”¨ç”¨æˆ·
<span class="hljs-variable constant_">DB_PASSWORD</span>=<span class="hljs-title class_">Prod</span>@<span class="hljs-number">2024</span>  # ä¸“ç”¨ç”¨æˆ·çš„å¯†ç 
<span class="hljs-variable constant_">DB_NAME</span>=mydb_prod  # ç”Ÿäº§æ•°æ®åº“å
<span class="hljs-variable constant_">API_PORT</span>=<span class="hljs-number">3000</span>  # åç«¯æœåŠ¡ç«¯å£

</code></pre>
<p>å› ä¸ºè¿™ä¸ªæ–‡ä»¶ä¸èƒ½æäº¤åˆ°git,æ‰€ä»¥è¦åœ¨æœåŠ¡å™¨è¿™ä¸ªé¡¹ç›®çš„æ ¹ç›®å½•åˆ›å»ºè¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶æŠŠä¸Šé¢çš„å†…å®¹å†™è¿›å»å°±è¡Œã€‚
æˆ‘çš„æ˜¯æ”¾åœ¨/root/projects/node-api-testä¸‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1abaf938ad054090807fccffd9866140~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6IOW6Zye:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764214183&amp;x-signature=aJ0cL%2Bt6VkRfO9pu0bYNyCdwGAs%3D" alt="image.png" loading="lazy"/></p>
<h6 data-id="heading-9">æ­¥éª¤2ï¼š å¯¼å…¥æœ¬åœ°è¡¨ç»“æ„åˆ°æœåŠ¡å™¨æ•°æ®åº“</h6>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. åœ¨ Mac ç»ˆç«¯å¦å¼€çª—å£ï¼Œä¸Šä¼ æœ¬åœ° my_db.sql åˆ°æœåŠ¡å™¨çš„ /tmp ç›®å½•</span>
scp /æœ¬åœ°è·¯å¾„/my_db.sql root@ä½ çš„æœåŠ¡å™¨IP:/tmp/
<span class="hljs-comment"># ä¾‹å¦‚ï¼šscp ~/project/my_db.sql root@120.78.xxx.xxx:/tmp/</span>

<span class="hljs-comment"># 2. å›åˆ°æœåŠ¡å™¨ç»ˆç«¯ï¼Œå¯¼å…¥è¡¨ç»“æ„åˆ° mydb_prod æ•°æ®åº“</span>
mysql -u root -p mydb_prod &lt; /tmp/my_db.sql
<span class="hljs-comment"># è¾“å…¥æœåŠ¡å™¨ MySQL çš„ root å¯†ç ï¼ˆæ­¥éª¤1ä¸­è®¾ç½®çš„ï¼‰ï¼Œå®Œæˆåè¡¨ç»“æ„å¯¼å…¥æˆåŠŸ</span>
</code></pre>
<h2 data-id="heading-10">æœåŠ¡å™¨ç”Ÿäº§æ•°æ®åº“ä¸­åˆ›å»ºÂ <code>users</code>Â è¡¨ï¼ˆè¡¨ç»“æ„è¿ç§»ï¼‰</h2>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ä¸­ï¼Œéœ€å°†æœ¬åœ°å¼€å‘çš„Â <code>users</code>Â è¡¨ç»“æ„è¿ç§»åˆ°æœåŠ¡å™¨çš„Â <code>mydb_prod</code>Â æ•°æ®åº“ä¸­ï¼Œç¡®ä¿åç«¯æ¥å£èƒ½æ­£å¸¸è¯»å†™ç”¨æˆ·æ•°æ®ã€‚</p>
<h6 data-id="heading-11">æœåŠ¡å™¨å¯¼å…¥Â <code>users</code>Â è¡¨ç»“æ„åˆ°Â <code>mydb_prod</code></h6>
<p>ç™»å½•æœåŠ¡å™¨ç»ˆç«¯ï¼Œå°†è¡¨ç»“æ„å¯¼å…¥ç”Ÿäº§æ•°æ®åº“ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœåŠ¡å™¨ç»ˆç«¯æ‰§è¡Œï¼ˆè¾“å…¥prod_userçš„å¯†ç Prod@2024ï¼‰ </span>
mysql -u prod_user -p mydb_prod &lt; /tmp/my_db.sql
</code></pre>
<h6 data-id="heading-12">ï¼ˆ4ï¼‰éªŒè¯è¡¨æ˜¯å¦åˆ›å»ºæˆåŠŸ</h6>
<p>ç™»å½•æœåŠ¡å™¨ MySQLï¼Œæ£€æŸ¥Â <code>users</code>Â è¡¨æ˜¯å¦å­˜åœ¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœåŠ¡å™¨ç»ˆç«¯ç™»å½•MySQL</span>
mysql -u prod_user -p mydb_prod

<span class="hljs-comment"># æŸ¥çœ‹æ•°æ®åº“ä¸­çš„è¡¨</span>
SHOW TABLES;  <span class="hljs-comment"># åº”æ˜¾ç¤º users è¡¨</span>

<span class="hljs-comment"># æŸ¥çœ‹è¡¨ç»“æ„ï¼ˆå¯é€‰ï¼‰</span>
DESCRIBE <span class="hljs-built_in">users</span>;  <span class="hljs-comment"># æ˜¾ç¤º users è¡¨çš„å­—æ®µã€ç±»å‹ç­‰ç»“æ„ä¿¡æ¯</span>

<span class="hljs-comment"># é€€å‡ºMySQL</span>
EXIT;
</code></pre>
<h4 data-id="heading-13">è¡¥å……è¯´æ˜</h4>
<ul>
<li>è‹¥æœ¬åœ°Â <code>users</code>Â è¡¨æœ‰åˆå§‹å¿…è¦æ•°æ®ï¼ˆå¦‚ç®¡ç†å‘˜è´¦å·ï¼‰ï¼Œå¯å»æ‰Â <code>--no-data</code>Â å‚æ•°ï¼Œå¯¼å‡ºåŒ…å«æ•°æ®çš„è¡¨ç»“æ„ï¼š<code>mysqldump -u æœ¬åœ°ç”¨æˆ·å -p æœ¬åœ°æ•°æ®åº“å users &gt; users_with_data.sql</code>ï¼Œå†æŒ‰ç›¸åŒæ­¥éª¤å¯¼å…¥ã€‚</li>
<li>è¡¨ç»“æ„è¿ç§»æ˜¯ç”Ÿäº§éƒ¨ç½²çš„å…³é”®æ­¥éª¤ï¼Œç¡®ä¿æœåŠ¡å™¨æ•°æ®åº“è¡¨ç»“æ„ä¸æœ¬åœ°å¼€å‘ç¯å¢ƒä¸€è‡´ï¼Œå¦åˆ™ä¼šå‡ºç° â€œè¡¨ä¸å­˜åœ¨â€â€œå­—æ®µç¼ºå¤±â€ ç­‰æ¥å£é”™è¯¯ã€‚</li>
</ul>
<h2 data-id="heading-14">å‘å¸ƒä»£ç </h2>
<p>ç™»å½•æœåŠ¡å™¨ï¼Œcd /root/xxx/xxx åˆ°è‡ªå·±çš„é¡¹ç›®æ ¹ç›®å½•ï¼Œæ‰§è¡Œ<code>git pull </code>,ç„¶åæ‰§è¡Œ<code>pm2 restart node-api-test</code></p>
<p>è¿™æ—¶å€™ä¼šæŠ¥é”™ï¼Œæç¤ºç¯å¢ƒå˜é‡æ˜¯<code>undefined</code>ï¼Œprocess.env.NODE_ENV æ‰“å°å‡ºçš„æ°¸è¿œæ˜¯undefined,æ‰€ä»¥ä¸‹é¢è¿™æ®µä»£ç ï¼Œå‘å¸ƒåˆ°æœåŠ¡å™¨ä¸Šå°±æŒ‚äº†</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> env = process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> || <span class="hljs-string">'development'</span>
<span class="hljs-keyword">const</span> envPath = path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">`../.env.<span class="hljs-subst">${env}</span>`</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'envPath'</span>, envPath) 
<span class="hljs-comment">// ä¼šæ‰“å°å‡ºundefined</span>
</code></pre>
<h4 data-id="heading-15">åŸå› åˆ†æ</h4>
<ol>
<li>
<p>å½“ä½ åœ¨æœåŠ¡å™¨å‘½ä»¤è¡Œç›´æ¥è¾“å…¥Â pm2 start app.jsÂ æ—¶ï¼ŒLinux shell å¹¶æ²¡æœ‰è®¾ç½®Â NODE_ENVï¼Œä»£ç é‡ŒÂ process.env.NODE_ENVÂ å°±ä¼šå˜æˆÂ undefinedï¼Œç„¶åä½ çš„ä»£ç å…œåº•é€»è¾‘å°†å…¶è®¾ä¸ºÂ developmentï¼Œäºæ˜¯å»è¯»å¼€å‘ç¯å¢ƒçš„é…ç½®ï¼Œå¯¼è‡´æŠ¥é”™ã€‚</p>
</li>
<li>
<p><strong>app.js æ–¹å¼å¯åŠ¨</strong>ï¼š
æ‰§è¡ŒÂ pm2 start app.jsÂ æ—¶ï¼ŒPM2 åªæ˜¯ç®€å•åœ°æ‰§è¡ŒÂ node app.jsã€‚é™¤éä½ åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ï¼ˆå¦‚Â /etc/profileï¼‰è®¾ç½®äº†å…¨å±€Â NODE_ENVï¼Œå¦åˆ™å®ƒå°±æ˜¯ç©ºçš„ã€‚</p>
</li>
</ol>
<p>è§£å†³æ–¹æ¡ˆ:</p>
<h5 data-id="heading-16">ä½¿ç”¨ ecosystem.config.cjsï¼ˆ<strong>æœ€æ¨èï¼Œå·¥ä¸šæ ‡å‡†</strong>ï¼‰</h5>
<p>é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºecosystem.config.cjs</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ecosystem.config.cjs</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">apps</span>: [
    {
      <span class="hljs-attr">name</span>: <span class="hljs-string">'node-api-test'</span>,
      <span class="hljs-attr">script</span>: <span class="hljs-string">'./app.js'</span>,
 
      <span class="hljs-attr">instances</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">autorestart</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">watch</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">env</span>: {
        <span class="hljs-attr">NODE_ENV</span>: <span class="hljs-string">'development'</span>,
      },
      <span class="hljs-attr">env_production</span>: {
        <span class="hljs-attr">NODE_ENV</span>: <span class="hljs-string">'production'</span>,
      },
    },
  ],
}
</code></pre>
<p><strong>å¯åŠ¨å‘½ä»¤</strong>ï¼š<br/>
ä»¥ååœ¨æœåŠ¡å™¨ä¸Šå¯åŠ¨æˆ–é‡å¯ï¼Œç»Ÿä¸€ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼Œä¸è¦å†ç”¨Â pm2 start app.jsï¼š</p>
<pre><code class="hljs language-bash" lang="bash"> <span class="hljs-comment">#   é¦–æ¬¡å¯åŠ¨ï¼ˆç”Ÿäº§ï¼‰ï¼š</span>
 pm2 start ecosystem.config.cjs --<span class="hljs-built_in">env</span> production
 <span class="hljs-comment">#    ä»£ç æ›´æ–°åé‡å¯ å¹³æ»‘é‡è½½ï¼ˆé›¶åœæœºï¼‰ï¼š</span>
 pm2 reload ecosystem.config.cjs --<span class="hljs-built_in">env</span> production
 <span class="hljs-comment">#   å®Œå…¨é‡å¯ï¼š</span>
 pm2 restart ecosystem.config.cjs --<span class="hljs-built_in">env</span> production
</code></pre>
<h2 data-id="heading-17">æœ€ç»ˆæµ‹è¯•</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c16f0d552034015a8246d04f4b4e027~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6IOW6Zye:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764214183&amp;x-signature=dAKbxJpVtiwliodaA0NKRKLS6SQ%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥æµ…å‡ºç†è§£ä½ çš„â€œæ•°æ®â€]]></title>    <link>https://juejin.cn/post/7574451949325025321</link>    <guid>https://juejin.cn/post/7574451949325025321</guid>    <pubDate>2025-11-20T04:08:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574451949325025321" data-draft-id="7574366319737274404" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥æµ…å‡ºç†è§£ä½ çš„â€œæ•°æ®â€"/> <meta itemprop="keywords" content="Python,æ•°æ®åˆ†æ"/> <meta itemprop="datePublished" content="2025-11-20T04:08:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="databook"/> <meta itemprop="url" content="https://juejin.cn/user/3526889035006702"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥æµ…å‡ºç†è§£ä½ çš„â€œæ•°æ®â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3526889035006702/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    databook
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T04:08:37.000Z" title="Thu Nov 20 2025 04:08:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¯¹äºæƒ³è¦å­¦ä¹ æ•°æ®åˆ†æçš„åŒå­¦ï¼Œå¦‚æœä½ é—®æˆ‘ï¼š"æ•°æ®åˆ†æçš„ç¬¬ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿ" æˆ‘çš„å›ç­”æ˜¯ï¼š"ç†è§£æ•°æ®æœ¬èº«ã€‚"</p>
<p><strong>æ•°æ®</strong>æ˜¯æˆ‘ä»¬æ‰€æœ‰åˆ†æå·¥ä½œçš„èµ·ç‚¹ï¼Œæœ¬æ–‡ä¸»è¦æ¢è®¨å¦‚ä½•è¾¨åˆ«æˆ‘ä»¬é¢å¯¹çš„æ˜¯ä»€ä¹ˆæ ·çš„æ•°æ®ï¼ŒåŒ…æ‹¬å®ƒçš„åˆ†ç±»æ–¹æ³•å’Œæè¿°ç»´åº¦ã€‚</p>
<h2 data-id="heading-0">1. æ•°æ®åˆ†ç±»</h2>
<p>æ•°æ®å¹¶éåƒç¯‡ä¸€å¾‹ï¼Œå®ƒä»¬æœ‰ç€ä¸åŒçš„ç‰¹å¾å’Œå±æ€§ã€‚</p>
<p>æ­£ç¡®ç†è§£æ•°æ®çš„åˆ†ç±»ï¼Œæ˜¯é€‰æ‹©é€‚å½“åˆ†ææ–¹æ³•çš„å‰æã€‚</p>
<p>é€šå¸¸ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä»¥ä¸‹<strong>ä¸‰ä¸ªç»´åº¦</strong>æ¥ç»™æ•°æ®è¿›è¡Œåˆ†ç±»ã€‚</p>
<h3 data-id="heading-1">1.1. æŒ‰ç»“æ„å±æ€§æ¥åˆ†</h3>
<p>ä½ çš„æ•°æ®â€œæ•´é½â€å—ï¼Ÿ</p>
<ol>
<li><strong>ç»“æ„åŒ–æ•°æ®</strong> ï¼šè¿™ç±»æ•°æ®å°±åƒä¸€ä¸ªæ•´ç†å¾—äº•äº•æœ‰æ¡çš„Excelè¡¨æ ¼æˆ–æ•°æ®åº“ã€‚</li>
</ol>
<p>å®ƒä»¬æœ‰å›ºå®šçš„æ ¼å¼ï¼Œæ¯ä¸€åˆ—éƒ½æœ‰æ˜ç¡®çš„å®šä¹‰ï¼Œæ¯”å¦‚å§“åã€å¹´é¾„ã€æ¶ˆè´¹é‡‘é¢ç­‰ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¯¹å…¶è¿›è¡ŒæŸ¥è¯¢å’Œåˆ†æã€‚</p>
<p>æ¯”å¦‚ï¼Œç½‘ä¸Šè´­ç‰©çš„è®¢å•è®°å½•ï¼ŒåŒ…æ‹¬è®¢å•å·ã€å•†å“åç§°ã€ä»·æ ¼ã€è´­ä¹°æ—¥æœŸç­‰ï¼Œå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ç»“æ„åŒ–æ•°æ®ã€‚</p>
<ol start="2">
<li><strong>éç»“æ„åŒ–æ•°æ®</strong>ï¼šè¿™ç±»æ•°æ®åˆ™â€œéšå¿ƒæ‰€æ¬²â€å¾—å¤šï¼Œæ²¡æœ‰å›ºå®šçš„ç»“æ„ã€‚</li>
</ol>
<p>æˆ‘ä»¬æ—¥å¸¸æ¥è§¦åˆ°çš„ä¿¡æ¯ï¼Œå¤§éƒ¨åˆ†éƒ½å±äºéç»“æ„åŒ–æ•°æ®ã€‚</p>
<p>æ¯”å¦‚ï¼Œå‘å¸ƒçš„ç¤¾äº¤åª’ä½“å¸–å­ã€è§‚çœ‹çš„è§†é¢‘ã€æ”¶å‘çš„ç”µå­é‚®ä»¶ï¼Œç”šè‡³æ˜¯å®¢æœçš„é€šè¯å½•éŸ³ï¼Œéƒ½å±äºéç»“æ„åŒ–æ•°æ®ã€‚</p>
<p>åˆ†æè¿™ç±»æ•°æ®é€šå¸¸éœ€è¦æ›´å¤æ‚çš„æŠ€æœ¯ï¼Œæ¯”å¦‚è‡ªç„¶è¯­è¨€å¤„ç†å’Œå›¾åƒè¯†åˆ«ã€‚</p>
<h3 data-id="heading-2">1.2. æŒ‰è¿ç»­æ€§ç‰¹å¾åˆ†ç±»</h3>
<p>ä½ çš„æ•°æ®å¯ä»¥â€œæ— é™ç»†åˆ†â€å—ï¼Ÿ</p>
<ol>
<li><strong>è¿ç»­æ€§æ•°æ®</strong> ï¼šè¿™ç±»æ•°æ®å¯ä»¥å–æŸä¸ªèŒƒå›´å†…çš„ä»»æ„å€¼ï¼Œå¹¶ä¸”å¯ä»¥æ— é™ç»†åˆ†ã€‚</li>
</ol>
<p>åœ¨ç”Ÿæ´»ä¸­ï¼Œä¸€ä¸ªäººçš„èº«é«˜ã€ä½“é‡ï¼Œæˆ–è€…å®¤å¤–çš„æ¸©åº¦ï¼Œéƒ½æ˜¯è¿ç»­æ€§æ•°æ®ã€‚</p>
<p>æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ä¸€ä¸ªäººçš„èº«é«˜æ˜¯175.5å˜ç±³ï¼Œä¹Ÿå¯ä»¥æ›´ç²¾ç¡®åœ°è¯´æ˜¯175.52å˜ç±³ã€‚</p>
<ol start="2">
<li><strong>ç¦»æ•£å‹æ•°æ®</strong>ï¼šè¿™ç±»æ•°æ®åªèƒ½å–ç‰¹å®šçš„ã€ç‹¬ç«‹çš„æ•°å€¼ï¼Œé€šå¸¸æ˜¯æ•´æ•°ã€‚</li>
</ol>
<p>æ¯”å¦‚ï¼Œä¸€ä¸ªç­çº§çš„å­¦ç”Ÿäººæ•°ã€ä¸€æœ¬ä¹¦çš„é¡µæ•°ï¼Œæˆ–è€…ä½ ä¸€å¤©å–æ°´çš„æ¯æ•°ï¼Œéƒ½æ˜¯ç¦»æ•£å‹æ•°æ®ã€‚</p>
<p>æˆ‘ä»¬ä¸èƒ½è¯´æœ‰25.8ä¸ªå­¦ç”Ÿã€‚</p>
<h3 data-id="heading-3">1.3. æŒ‰æµ‹é‡å°ºåº¦åˆ†ç±»</h3>
<p>ä½ çš„æ•°æ®èƒ½è¿›è¡Œä»€ä¹ˆæ ·çš„â€œæ•°å­¦è¿ç®—â€ï¼Ÿ</p>
<p>è¿™æ˜¯ç»Ÿè®¡å­¦ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œå®ƒå†³å®šäº†æˆ‘ä»¬å¯ä»¥å¯¹æ•°æ®è¿›è¡Œå“ªäº›ç»Ÿè®¡åˆ†æã€‚</p>
<ol>
<li><strong>å®šç±»æ•°æ®</strong>ï¼šè¿™ç±»æ•°æ®åªè¡¨ç¤ºç±»åˆ«ï¼Œæ²¡æœ‰é¡ºåºæˆ–å¤§å°ä¹‹åˆ†ã€‚</li>
</ol>
<p>æ¯”å¦‚ï¼Œäº§å“çš„åˆ†ç±»ï¼ˆå¦‚â€œç”µå­äº§å“â€ã€â€œæœè£…â€ã€â€œé£Ÿå“â€ï¼‰ã€æ€§åˆ«ï¼ˆâ€œç”·â€ã€â€œå¥³â€ï¼‰ç­‰ã€‚</p>
<p>æˆ‘ä»¬åªèƒ½è¯´å®ƒä»¬**â€œä¸åŒâ€**ï¼Œä½†ä¸èƒ½è¯´â€œç”µå­äº§å“â€æ¯”â€œæœè£…â€æ›´å¤§æˆ–æ›´å¥½ã€‚</p>
<ol start="2">
<li><strong>å®šåºæ•°æ®</strong>ï¼šè¿™ç±»æ•°æ®æ—¢æœ‰ç±»åˆ«ï¼Œåˆæœ‰æ˜ç¡®çš„é¡ºåºæˆ–ç­‰çº§ï¼Œä½†æˆ‘ä»¬æ— æ³•è¡¡é‡ç­‰çº§ä¹‹é—´çš„å…·ä½“å·®è·ã€‚</li>
</ol>
<p>æ¯”å¦‚ï¼Œç”¨æˆ·æ»¡æ„åº¦ï¼ˆâ€œéå¸¸æ»¡æ„â€ã€â€œæ»¡æ„â€ã€â€œä¸€èˆ¬â€ã€â€œä¸æ»¡æ„â€ï¼‰ã€è€ƒè¯•çš„æ’åï¼ˆç¬¬ä¸€åã€ç¬¬äºŒåã€ç¬¬ä¸‰åï¼‰ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“â€œéå¸¸æ»¡æ„â€æ¯”â€œæ»¡æ„â€è¦å¥½ï¼Œä½†å¥½å¤šå°‘æ˜¯è¯´ä¸æ¸…æ¥šçš„ã€‚</p>
<ol start="3">
<li><strong>å®šè·æ•°æ® <strong>ï¼šè¿™ç±»æ•°æ®æœ‰é¡ºåºï¼Œå¹¶ä¸”æ•°å€¼ä¹‹é—´çš„å·®å€¼æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä½†å®ƒ</strong>æ²¡æœ‰</strong>ä¸€ä¸ªâ€œç»å¯¹é›¶ç‚¹â€ã€‚</li>
</ol>
<p>æ¯”å¦‚ï¼Œè€ƒè¯•çš„æˆç»©ï¼ˆ80åˆ†æ¯”70åˆ†é«˜10åˆ†ï¼Œ60åˆ†æ¯”50åˆ†ä¹Ÿé«˜10åˆ†ï¼Œå·®è·æ˜¯ç›¸åŒçš„ï¼‰ã€æ‘„æ°æ¸©åº¦ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½è¯´30æ‘„æ°åº¦æ˜¯15æ‘„æ°åº¦çš„ä¸¤å€çƒ­ã€‚</p>
<ol start="4">
<li><strong>å®šæ¯”æ•°æ®</strong>ï¼šè¿™æ˜¯æœ€é«˜çº§åˆ«çš„æµ‹é‡å°ºåº¦ï¼Œå®ƒåŒ…å«äº†å®šè·æ•°æ®çš„æ‰€æœ‰ç‰¹æ€§ï¼Œå¹¶ä¸”<strong>æ‹¥æœ‰</strong>ä¸€ä¸ªâ€œç»å¯¹é›¶ç‚¹â€ï¼ˆå³0è¡¨ç¤ºâ€œæ²¡æœ‰â€ï¼‰ã€‚</li>
</ol>
<p>æ¯”å¦‚ï¼Œèº«é«˜ã€ä½“é‡ã€æ”¶å…¥ã€‚ä¸€ä¸ªäººçš„æ”¶å…¥ä¸º0å…ƒï¼Œå°±ä»£è¡¨ä»–æ²¡æœ‰ä»»ä½•æ”¶å…¥ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥è¯´ï¼Œæ”¶å…¥10000å…ƒæ˜¯5000å…ƒçš„ä¸¤å€ã€‚</p>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> Counter

<span class="hljs-comment"># ä¸åŒç±»å‹æ•°æ®çš„ç¤ºä¾‹å’Œåˆ†ææ–¹æ³•</span>
<span class="hljs-comment"># å®šç±»æ•°æ® - æ€§åˆ«</span>
gender_data = [<span class="hljs-string">'ç”·'</span>, <span class="hljs-string">'å¥³'</span>, <span class="hljs-string">'ç”·'</span>, <span class="hljs-string">'ç”·'</span>, <span class="hljs-string">'å¥³'</span>, <span class="hljs-string">'å¥³'</span>, <span class="hljs-string">'ç”·'</span>]
gender_counts = Counter(gender_data)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"å®šç±»æ•°æ®åˆ†æï¼ˆæ€§åˆ«é¢‘æ•°ï¼‰ï¼š"</span>, gender_counts)

<span class="hljs-comment"># å®šåºæ•°æ® - æ•™è‚²æ°´å¹³ï¼ˆ1=é«˜ä¸­ï¼Œ2=æœ¬ç§‘ï¼Œ3=ç¡•å£«ï¼Œ4=åšå£«ï¼‰</span>
education_data = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]
<span class="hljs-built_in">print</span>(<span class="hljs-string">"å®šåºæ•°æ®ä¸­ä½æ•°ï¼š"</span>, np.median(education_data))

<span class="hljs-comment"># å®šè·æ•°æ® - æ¸©åº¦</span>
temperature_data = [<span class="hljs-number">23.5</span>, <span class="hljs-number">24.0</span>, <span class="hljs-number">25.3</span>, <span class="hljs-number">22.8</span>, <span class="hljs-number">26.1</span>]
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ¸©åº¦å¹³å‡å€¼ï¼š"</span>, np.mean(temperature_data))

<span class="hljs-comment"># å®šæ¯”æ•°æ® - æœˆæ”¶å…¥ï¼ˆæœ‰ç»å¯¹é›¶ç‚¹ï¼‰</span>
income_data = [<span class="hljs-number">5000</span>, <span class="hljs-number">8000</span>, <span class="hljs-number">12000</span>, <span class="hljs-number">3500</span>, <span class="hljs-number">9000</span>]
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ”¶å…¥å‡å€¼ï¼š"</span>, np.mean(income_data))
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ”¶å…¥æ¯”å€¼ï¼ˆæœ€é«˜/æœ€ä½ï¼‰ï¼š"</span>, <span class="hljs-built_in">max</span>(income_data)/<span class="hljs-built_in">min</span>(income_data))
</code></pre>
<h2 data-id="heading-4">2. æ•°æ®çš„æè¿°</h2>
<p>äº†è§£äº†æ•°æ®çš„ç±»å‹åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯ä»å®è§‚ä¸Šæè¿°æˆ‘ä»¬æ‰‹ä¸­çš„è¿™æ‰¹æ•°æ®ã€‚</p>
<p>é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šä»<strong>ä¸‰ä¸ªç»´åº¦</strong>æ¥â€œç´ æâ€æ•°æ®çš„å…¨è²Œï¼š</p>
<h3 data-id="heading-5">2.1. é›†ä¸­è¶‹åŠ¿</h3>
<p><strong>é›†ä¸­è¶‹åŠ¿</strong>æ˜¯ç”¨æ¥æè¿°æ•°æ®é›†ä¸­è¶‹åŠ¿çš„ä¸€ç»„<strong>ç»Ÿè®¡é‡</strong>ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬æ•°æ®çš„â€œä¸­å¿ƒç‚¹â€æˆ–â€œå…¸å‹å€¼â€åœ¨å“ªé‡Œã€‚</p>
<ol>
<li><strong>ç®—æœ¯å¹³å‡å€¼</strong>ï¼šè¿™æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„æŒ‡æ ‡ï¼ŒæŒ‡æ‰€æœ‰æ•°å€¼çš„æ€»å’Œé™¤ä»¥æ•°å€¼çš„ä¸ªæ•°ã€‚
<ol>
<li><strong>ç®€å•ç®—æœ¯å¹³å‡å€¼</strong>ï¼šé€‚ç”¨äºæ‰€æœ‰æ•°å€¼åŒç­‰é‡è¦çš„æƒ…å†µã€‚</li>
<li><strong>åŠ æƒç®—æœ¯å¹³å‡å€¼</strong>ï¼šé€‚ç”¨äºä¸åŒæ•°å€¼å…·æœ‰ä¸åŒé‡è¦æ€§çš„æƒ…å†µï¼Œæ¯”å¦‚è®¡ç®—è¯¾ç¨‹çš„æœ€ç»ˆæˆç»©ï¼ŒæœŸæœ«è€ƒè¯•çš„æƒé‡å¯èƒ½æ¯”å¹³æ—¶ä½œä¸šè¦é«˜ã€‚</li>
<li>éœ€è¦<strong>æ³¨æ„</strong>ï¼šç®—æœ¯å¹³å‡å€¼å¾ˆå®¹æ˜“å—åˆ°æ•°æ®ä¸­æå¤§å€¼æˆ–æå°å€¼ï¼ˆå¼‚å¸¸å€¼ï¼‰çš„å½±å“ã€‚</li>
</ol>
</li>
<li><strong>å‡ ä½•å¹³å‡å€¼</strong>ï¼šé€‚ç”¨äºæè¿°å…·æœ‰ä¹˜é™¤å…³ç³»çš„æ•°æ®çš„é›†ä¸­è¶‹åŠ¿ï¼Œå¸¸ç”¨äºè®¡ç®—æ¯”ç‡æ•°æ®çš„å¹³å‡å€¼ï¼Œæ¯”å¦‚æŠ•èµ„å›æŠ¥ç‡ã€‚</li>
<li><strong>ä¼—æ•°</strong>ï¼šæŒ‡æ•°æ®é›†ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„æ•°å€¼ã€‚<strong>ä¼—æ•°</strong>å¯èƒ½ä¸æ­¢ä¸€ä¸ªã€‚</li>
<li><code>ä¸­ä½æ•°</code>ï¼šå°†æ•°æ®é›†ä»å°åˆ°å¤§æ’åºåï¼Œä½äºæœ€ä¸­é—´çš„é‚£ä¸ªæ•°ã€‚</li>
</ol>
<p>å¦‚æœæ•°æ®é›†çš„ä¸ªæ•°æ˜¯å¶æ•°ï¼Œåˆ™å–ä¸­é—´ä¸¤ä¸ªæ•°çš„ç®—æœ¯å¹³å‡å€¼ã€‚ä¸­ä½æ•°ä¸å—æç«¯å€¼çš„å½±å“ã€‚</p>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> scipy <span class="hljs-keyword">import</span> stats

<span class="hljs-comment"># ç”¨æˆ·æ¯æ—¥ä½¿ç”¨æ—¶é•¿æ•°æ®ï¼ˆåˆ†é’Ÿï¼‰</span>
daily_usage = [<span class="hljs-number">25</span>, <span class="hljs-number">30</span>, <span class="hljs-number">15</span>, <span class="hljs-number">28</span>, <span class="hljs-number">30</span>, <span class="hljs-number">45</span>, <span class="hljs-number">22</span>, <span class="hljs-number">180</span>]

<span class="hljs-comment"># è®¡ç®—ç®—æœ¯å¹³å‡å€¼</span>
mean_usage = np.mean(daily_usage)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç®—æœ¯å¹³å‡å€¼: <span class="hljs-subst">{mean_usage:<span class="hljs-number">.2</span>f}</span> åˆ†é’Ÿ"</span>)

<span class="hljs-comment"># è®¡ç®—ä¸­ä½æ•°</span>
median_usage = np.median(daily_usage)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä¸­ä½æ•°: <span class="hljs-subst">{median_usage:<span class="hljs-number">.2</span>f}</span> åˆ†é’Ÿ"</span>)

<span class="hljs-comment"># è®¡ç®—ä¼—æ•°</span>
<span class="hljs-comment"># æ³¨æ„ï¼šscipy.stats.modeè¿”å›ä¼—æ•°å’Œå…¶å‡ºç°æ¬¡æ•°</span>
mode_usage = stats.mode(daily_usage)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä¼—æ•°: <span class="hljs-subst">{mode_usage.mode[<span class="hljs-number">0</span>]}</span> åˆ†é’Ÿ"</span>)
</code></pre>
<p>ä»ä¸Šé¢çš„ç¤ºä¾‹å¯ä»¥çœ‹å‡ºï¼š<strong>ç®—æœ¯å¹³å‡å€¼</strong>ï¼ˆ<code>46.88</code>åˆ†é’Ÿï¼‰å—åˆ°äº†æç«¯å€¼<code>180</code>åˆ†é’Ÿçš„æ˜¾è‘—å½±å“ï¼Œè€Œ<strong>ä¸­ä½æ•°</strong>ï¼ˆ<code>29.0</code>åˆ†é’Ÿï¼‰åˆ™æ›´å¥½åœ°åæ˜ äº†å¤§éƒ¨åˆ†ç”¨æˆ·çš„æ™®éä½¿ç”¨æ—¶é•¿ã€‚</p>
<h3 data-id="heading-6">2.2. ç¦»æ•£ç¨‹åº¦</h3>
<p><strong>ç¦»æ•£ç¨‹åº¦</strong>æè¿°äº†æ•°æ®é›†ä¸­å„ä¸ªæ•°å€¼ç›¸å¯¹äºå…¶ä¸­å¿ƒä½ç½®çš„å˜å¼‚ç¨‹åº¦ï¼Œä¹Ÿå°±æ˜¯æ•°æ®çš„â€œèƒ–ç˜¦â€ã€‚</p>
<ol>
<li><strong>æå·®</strong>ï¼šæ•°æ®é›†ä¸­æœ€å¤§å€¼ä¸æœ€å°å€¼çš„å·®å€¼ã€‚å®ƒè®¡ç®—ç®€å•ï¼Œä½†åŒæ ·æ˜“å—æç«¯å€¼å½±å“ã€‚</li>
<li><strong>å¹³å‡åå·®</strong>ï¼šæ•°æ®é›†ä¸­æ¯ä¸ªæ•°å€¼ä¸ç®—æœ¯å¹³å‡å€¼å·®å€¼çš„ç»å¯¹å€¼ä¹‹å’Œçš„å¹³å‡æ•°ã€‚</li>
<li><strong>æ–¹å·®</strong>/ <strong>æ ‡å‡†å·®</strong>ï¼šè¿™æ˜¯è¡¡é‡æ•°æ®ç¦»æ•£ç¨‹åº¦æœ€å¸¸ç”¨çš„æŒ‡æ ‡ã€‚<strong>æ ‡å‡†å·®</strong>æ˜¯<strong>æ–¹å·®</strong>çš„å¹³æ–¹æ ¹ï¼Œå®ƒä¸åŸå§‹æ•°æ®çš„å•ä½ç›¸åŒï¼Œæ›´æ˜“äºè§£é‡Šã€‚</li>
</ol>
<p><strong>æ³¨æ„</strong>ï¼šå¯¹äº<strong>æ ·æœ¬æ–¹å·®</strong>/<strong>æ ‡å‡†å·®</strong>ï¼Œè®¡ç®—æ—¶ï¼Œåˆ†æ¯æ˜¯ <code>n-1</code>ï¼ˆnä¸ºæ ·æœ¬é‡ï¼‰ï¼Œè¿™æ˜¯ä¸ºäº†å¯¹<strong>æ€»ä½“æ–¹å·®</strong>è¿›è¡Œ<strong>æ— åä¼°è®¡</strong>ã€‚</p>
<ol start="4">
<li><strong>å˜å¼‚ç³»æ•°</strong>ï¼šæ ‡å‡†å·®ä¸å¹³å‡å€¼çš„æ¯”å€¼ï¼Œå¯ä»¥ç”¨æ¥æ¯”è¾ƒä¸åŒå•ä½æˆ–ä¸åŒå‡å€¼çš„æ•°æ®é›†çš„ç¦»æ•£ç¨‹åº¦ã€‚</li>
<li><strong>å››åˆ†ä½æå·®</strong>ï¼šç¬¬ä¸‰å››åˆ†ä½æ•°ï¼ˆ<code>Q3</code>ï¼Œæ’åºå75%ä½ç½®çš„æ•°å€¼ï¼‰ä¸ç¬¬ä¸€å››åˆ†ä½æ•°ï¼ˆ<code>Q1</code>ï¼Œæ’åºå25%ä½ç½®çš„æ•°å€¼ï¼‰çš„å·®å€¼ã€‚å®ƒåŒ…å«äº†æ•°æ®é›†ä¸­é—´çš„50%çš„æ•°æ®ï¼Œèƒ½å¤Ÿæœ‰æ•ˆé¿å…æç«¯å€¼çš„å½±å“ã€‚</li>
</ol>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

daily_usage = [<span class="hljs-number">25</span>, <span class="hljs-number">30</span>, <span class="hljs-number">15</span>, <span class="hljs-number">28</span>, <span class="hljs-number">30</span>, <span class="hljs-number">45</span>, <span class="hljs-number">22</span>, <span class="hljs-number">180</span>]

<span class="hljs-comment"># è®¡ç®—æå·®</span>
range_usage = np.<span class="hljs-built_in">max</span>(daily_usage) - np.<span class="hljs-built_in">min</span>(daily_usage)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æå·®: <span class="hljs-subst">{range_usage}</span> åˆ†é’Ÿ"</span>)

<span class="hljs-comment"># è®¡ç®—æ–¹å·® (é»˜è®¤è®¡ç®—æ€»ä½“æ–¹å·®ï¼Œddof=1è¡¨ç¤ºè®¡ç®—æ ·æœ¬æ–¹å·®)</span>
variance_usage = np.var(daily_usage, ddof=<span class="hljs-number">1</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ ·æœ¬æ–¹å·®: <span class="hljs-subst">{variance_usage:<span class="hljs-number">.2</span>f}</span>"</span>)

<span class="hljs-comment"># è®¡ç®—æ ‡å‡†å·®</span>
std_dev_usage = np.std(daily_usage, ddof=<span class="hljs-number">1</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ ·æœ¬æ ‡å‡†å·®: <span class="hljs-subst">{std_dev_usage:<span class="hljs-number">.2</span>f}</span> åˆ†é’Ÿ"</span>)

<span class="hljs-comment"># è®¡ç®—å››åˆ†ä½æå·®</span>
q1 = np.percentile(daily_usage, <span class="hljs-number">25</span>)
q3 = np.percentile(daily_usage, <span class="hljs-number">75</span>)
iqr = q3 - q1
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç¬¬ä¸€å››åˆ†ä½æ•° (Q1): <span class="hljs-subst">{q1}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç¬¬ä¸‰å››åˆ†ä½æ•° (Q3): <span class="hljs-subst">{q3}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å››åˆ†ä½æå·® (IQR): <span class="hljs-subst">{iqr}</span>"</span>)
</code></pre>
<h3 data-id="heading-7">2.3. åˆ†å¸ƒå½¢æ€</h3>
<p>åœ¨æŒæ¡äº†æ•°æ®çš„ä¸­å¿ƒå’Œç¦»æ•£ç¨‹åº¦åï¼Œæˆ‘ä»¬è¿˜æƒ³çŸ¥é“æ•°æ®çš„æ•´ä½“åˆ†å¸ƒå½¢çŠ¶ã€‚</p>
<p><strong>æ¦‚ç‡åˆ†å¸ƒ</strong>å°±æ˜¯æè¿°éšæœºå˜é‡å–å€¼è§„å¾‹çš„æ•°å­¦æ¨¡å‹ã€‚</p>
<p>å¸¸è§çš„æ¦‚ç‡åˆ†å¸ƒï¼š</p>
<ol>
<li>ç¦»æ•£å‹æ¦‚ç‡åˆ†å¸ƒï¼š
<ol>
<li><strong>äºŒé¡¹åˆ†å¸ƒ</strong>ï¼šæè¿°åœ¨ä¸€ç³»åˆ—ç‹¬ç«‹çš„â€œæ˜¯/éâ€è¯•éªŒä¸­ï¼ŒæˆåŠŸå‘ç”Ÿæ¬¡æ•°çš„æ¦‚ç‡ã€‚</li>
</ol>
</li>
</ol>
<p>ä¾‹å¦‚ï¼ŒæŠ›10æ¬¡ç¡¬å¸ï¼Œæ­£é¢æœä¸Š5æ¬¡çš„æ¦‚ç‡ã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">2.</span> <span class="hljs-strong">**æ³Šæ¾åˆ†å¸ƒ**</span>ï¼šæè¿°åœ¨å•ä½æ—¶é—´æˆ–ç©ºé—´å†…ï¼ŒæŸä¸ªéšæœºäº‹ä»¶å‘ç”Ÿçš„æ¬¡æ•°ã€‚
</code></pre>
<p>ä¾‹å¦‚ï¼Œä¸€ä¸ªå®¢æœä¸­å¿ƒå¹³å‡æ¯å°æ—¶æ¥åˆ°10ä¸ªç”µè¯ï¼Œä¸‹ä¸€ä¸ªå°æ—¶æ¥åˆ°8ä¸ªç”µè¯çš„æ¦‚ç‡ã€‚</p>
<ol start="2">
<li>è¿ç»­å‹æ¦‚ç‡åˆ†å¸ƒï¼š
<ol>
<li><strong>æ­£æ€åˆ†å¸ƒ</strong>ï¼ˆ<strong>é«˜æ–¯åˆ†å¸ƒ</strong>ï¼‰ï¼šè‡ªç„¶ç•Œå’Œäººç±»ç¤¾ä¼šä¸­è®¸å¤šç°è±¡éƒ½è¿‘ä¼¼æœä»æ­£æ€åˆ†å¸ƒï¼Œå…¶æ›²çº¿å‘ˆé’Ÿå½¢ï¼Œå¯¹ç§°åˆ†å¸ƒã€‚</li>
</ol>
</li>
</ol>
<p>ä¾‹å¦‚ï¼Œæˆå¹´äººçš„èº«é«˜åˆ†å¸ƒã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">2.</span> <span class="hljs-strong">**æŒ‡æ•°åˆ†å¸ƒ**</span>ï¼šæè¿°ç‹¬ç«‹éšæœºäº‹ä»¶å‘ç”Ÿçš„æ—¶é—´é—´éš”ã€‚ 
</code></pre>
<p>ä¾‹å¦‚ï¼Œä¸¤è¾†å…¬äº¤è½¦åˆ°ç«™çš„é—´éš”æ—¶é—´ã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">3.</span> <span class="hljs-strong">**å‡åŒ€åˆ†å¸ƒ**</span>ï¼šè¡¨ç¤ºåœ¨æŸä¸ªèŒƒå›´å†…çš„æ‰€æœ‰å–å€¼çš„æ¦‚ç‡éƒ½ç›¸ç­‰ã€‚
</code></pre>
<p>ä¾‹å¦‚ï¼Œæ·ä¸€ä¸ªå‡åŒ€çš„éª°å­ï¼Œæ¯ä¸ªç‚¹æ•°å‡ºç°çš„æ¦‚ç‡éƒ½æ˜¯1/6ã€‚</p>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-keyword">from</span> scipy <span class="hljs-keyword">import</span> stats

<span class="hljs-comment"># ç”Ÿæˆä¸€ä¸ªç¬¦åˆæ­£æ€åˆ†å¸ƒçš„éšæœºæ•°æ®é›†</span>
<span class="hljs-comment"># å‡å€¼ä¸º100ï¼Œæ ‡å‡†å·®ä¸º10</span>
data_normal = np.random.normal(loc=<span class="hljs-number">100</span>, scale=<span class="hljs-number">10</span>, size=<span class="hljs-number">1000</span>)

<span class="hljs-comment"># ä½¿ç”¨seabornç»˜åˆ¶ç›´æ–¹å›¾å’Œæ ¸å¯†åº¦ä¼°è®¡å›¾</span>
sns.histplot(data_normal, kde=<span class="hljs-literal">True</span>, color=<span class="hljs-string">'skyblue'</span>)
plt.title(<span class="hljs-string">'æ­£æ€åˆ†å¸ƒç¤ºä¾‹'</span>)
plt.xlabel(<span class="hljs-string">'æ•°å€¼'</span>)
plt.ylabel(<span class="hljs-string">'é¢‘ç‡'</span>)
plt.show()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d5c78d0ba2e4429cbd2aa3245e24adf8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764216516&amp;x-signature=4Fgq0CjwC4gMpItP2XBis0O0xI4%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-8">3. æ€»ç»“</h2>
<p>ç†è§£<strong>æ•°æ®</strong>çš„<strong>ä¸åŒç±»å‹</strong>å’Œ<strong>æè¿°æ•°æ®</strong>çš„æ–¹æ³•ï¼Œæ˜¯æˆ‘ä»¬è¿›è¡Œåç»­æ‰€æœ‰åˆ†æå·¥ä½œçš„åŸºç¡€ã€‚</p>
<p>å°±åƒå­¦ç”»ç”»è¦å…ˆè®¤è¯†é¢œæ–™å’Œç”»ç¬”ï¼Œæˆ‘ä»¬ä¹Ÿè¦å…ˆâ€œçœ‹æ‡‚â€æ‰‹é‡Œçš„æ•°æ®ã€‚</p>
<p><strong>æ•°æ®åˆ†æ</strong>çš„ç¬¬ä¸€æ­¥æ°¸è¿œæ˜¯<strong>ç†è§£ä½ çš„æ•°æ®</strong>ã€‚åªæœ‰å¯¹æ•°æ®æœ‰äº†å……åˆ†çš„è®¤è¯†ï¼Œæ‰èƒ½é€‰æ‹©é€‚å½“çš„åˆ†ææ–¹æ³•ï¼Œå¾—å‡ºå¯é çš„ç»“è®ºã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ›å»ºVUE3é¡¹ç›®]]></title>    <link>https://juejin.cn/post/7574584245151416371</link>    <guid>https://juejin.cn/post/7574584245151416371</guid>    <pubDate>2025-11-20T04:10:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574584245151416371" data-draft-id="7574584245110734899" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ›å»ºVUE3é¡¹ç›®"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-20T04:10:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·9381691255360"/> <meta itemprop="url" content="https://juejin.cn/user/3485906645565271"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ›å»ºVUE3é¡¹ç›®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3485906645565271/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·9381691255360
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T04:10:55.000Z" title="Thu Nov 20 2025 04:10:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€æœ¬åœ°åˆ›å»ºVUE3é¡¹ç›®</h2>
<ol>
<li>ä½¿ç”¨Viteåˆ›å»ºVUE3é¡¹ç›®ã€‚æ‰“å¼€CMDæˆ–è€…Windows PowerShellï¼Œåˆ‡æ¢åˆ°é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹ï¼Œæ¯”å¦‚ï¼šE:\dengxl\projects</li>
<li>è¾“å…¥å‘½ä»¤</li>
</ol>
<blockquote>
<p><code>pnpm create vite</code></p>
</blockquote>
<ol start="3">
<li>æŒ‰ç…§æç¤ºï¼Œè¾“å…¥é¡¹ç›®åç§°vue-project-nameï¼Œé€‰æ‹©æ¡†æ¶VUE, è¯­è¨€TypeScriptï¼Œæ„å»ºå·¥å…·Viteç­‰ã€‚</li>
<li>åˆ‡æ¢åˆ°é¡¹ç›®æ–‡ä»¶å¤¹vue-project-nameä¸‹ï¼Œæ‰§è¡Œå‘½ä»¤å®‰è£…é¡¹ç›®ä¾èµ–çš„åŒ…ã€‚</li>
</ol>
<blockquote>
<p><code>pnpm install</code></p>
</blockquote>
<ol start="5">
<li>å®‰è£…æˆåŠŸåï¼Œåœ¨å¼€å‘ç¯å¢ƒå¯åŠ¨é¡¹ç›®ã€‚</li>
</ol>
<blockquote>
<p><code>pnpm dev</code></p>
</blockquote>
<p>åœ¨æ§åˆ¶å°ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å¯åŠ¨æˆåŠŸçš„ä¿¡æ¯ï¼Œå¹¶æœ‰æµè§ˆå™¨è®¿é—®çš„åœ°å€ã€‚</p>
<ol start="6">
<li>é»˜è®¤ç«¯å£å·5173ã€‚æµè§ˆå™¨ä¸­è®¿é—® <a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">http://localhost:5173</a>Â å¯çœ‹åˆ°é¡¹ç›®å¯åŠ¨æˆåŠŸã€‚</li>
</ol>
<h2 data-id="heading-1">äºŒã€ä¸Šä¼ åˆ°GITè¿œç¨‹ä»“åº“</h2>
<ol>
<li>ç™»å½•<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2F" target="_blank" title="https://gitee.com/" ref="nofollow noopener noreferrer">gitee</a>åï¼Œåˆ›å»ºä¸€ä¸ªç©ºçš„ä»“åº“ï¼Œé‡Œé¢ä»€ä¹ˆæ–‡ä»¶éƒ½æ²¡æœ‰ã€‚</li>
<li>åœ¨æœ¬åœ°é¡¹ç›®æ–‡ä»¶vue-project-nameä¸‹ï¼Œæ‰“å¼€Git Bashã€‚</li>
<li>gitåˆå§‹åŒ–ã€‚è¾“å…¥å‘½ä»¤</li>
</ol>
<blockquote>
<p><code>git init</code></p>
</blockquote>
<ol start="4">
<li>ç»‘å®šè¿œç¨‹ä»“åº“ã€‚</li>
</ol>
<blockquote>
<p><code>git remote add origin è¿œç¨‹ä»“åº“çš„SSHåœ°å€</code></p>
</blockquote>
<ol start="5">
<li>æäº¤åˆ°æœ¬åœ°ä»“åº“ã€‚</li>
<li>pushåˆ°git è¿œç¨‹ä»“åº“ã€‚</li>
</ol>
<blockquote>
<p><code>git push -u origin master</code></p>
</blockquote>
<h2 data-id="heading-2">ä¸‰ã€è®¾ç½®é¡¹ç›®å¯åŠ¨æˆåŠŸåï¼Œæµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€</h2>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæœ¬åœ°å¯åŠ¨VUE3é¡¹ç›®æˆåŠŸåï¼Œæµè§ˆå™¨ä¸ä¼šè‡ªåŠ¨æ‰“å¼€ã€‚</p>
<p>ä»¥ä¸‹è®¾ç½®å¯ä»¥å®ç°é¡¹ç›®å¯åŠ¨æˆåŠŸåï¼Œæµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€ã€‚</p>
<p>åœ¨package.jsonæ–‡ä»¶ä¸­ï¼Œdevå¯åŠ¨å‘½ä»¤ä¸­ï¼Œæ·»åŠ opené€‰é¡¹ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vite --open"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3 æ€§èƒ½ä¼˜åŒ–å®æˆ˜ï¼š5ä¸ª90%å¼€å‘è€…å¿½ç•¥çš„Composition APIé«˜æ•ˆç”¨æ³•ğŸš€]]></title>    <link>https://juejin.cn/post/7574327911660568576</link>    <guid>https://juejin.cn/post/7574327911660568576</guid>    <pubDate>2025-11-20T04:16:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574327911660568576" data-draft-id="7574329472923500578" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3 æ€§èƒ½ä¼˜åŒ–å®æˆ˜ï¼š5ä¸ª90%å¼€å‘è€…å¿½ç•¥çš„Composition APIé«˜æ•ˆç”¨æ³•ğŸš€"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-11-20T04:16:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="IT_é™ˆå¯’"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3 æ€§èƒ½ä¼˜åŒ–å®æˆ˜ï¼š5ä¸ª90%å¼€å‘è€…å¿½ç•¥çš„Composition APIé«˜æ•ˆç”¨æ³•ğŸš€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    IT_é™ˆå¯’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T04:16:54.000Z" title="Thu Nov 20 2025 04:16:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Vue3 æ€§èƒ½ä¼˜åŒ–å®æˆ˜ï¼š5ä¸ª90%å¼€å‘è€…å¿½ç•¥çš„Composition APIé«˜æ•ˆç”¨æ³•ğŸš€</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>Vue3çš„Composition APIä¸ºå¼€å‘è€…æä¾›äº†æ›´çµæ´»ã€æ›´å¼ºå¤§çš„ä»£ç ç»„ç»‡æ–¹å¼ï¼Œä½†è®¸å¤šå¼€å‘è€…åœ¨æ—¥å¸¸ä½¿ç”¨ä¸­ä»…åœç•™åœ¨åŸºç¡€åŠŸèƒ½å±‚é¢ï¼Œæœªèƒ½å……åˆ†å‘æŒ¥å…¶æ€§èƒ½ä¼˜åŒ–æ½œåŠ›ã€‚äº‹å®ä¸Šï¼ŒComposition APIä¸­éšè—ç€è®¸å¤šå¯ä»¥æ˜¾è‘—æå‡åº”ç”¨æ€§èƒ½çš„æŠ€å·§ï¼Œä½†è¿™äº›æŠ€å·§å¾€å¾€è¢«90%çš„å¼€å‘è€…æ‰€å¿½è§†ã€‚æœ¬æ–‡å°†æ·±å…¥å‰–æ5ä¸ªæå…·å®æˆ˜ä»·å€¼çš„Composition APIé«˜æ•ˆç”¨æ³•ï¼Œå¸®åŠ©ä½ åœ¨ä¸å¢åŠ å¤æ‚åº¦çš„å‰æä¸‹å¤§å¹…æå‡Vueåº”ç”¨æ€§èƒ½ã€‚</p>
<h2 data-id="heading-2">ä¸»ä½“å†…å®¹</h2>
<h3 data-id="heading-3">1. <code>shallowRef</code>ä¸<code>shallowReactive</code>ï¼šç²¾å‡†æ§åˆ¶å“åº”å¼å¼€é”€</h3>
<h4 data-id="heading-4">é—®é¢˜èƒŒæ™¯</h4>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒVue3çš„<code>ref</code>å’Œ<code>reactive</code>ä¼šå¯¹æ‰€æœ‰åµŒå¥—å±æ€§è¿›è¡Œæ·±åº¦å“åº”å¼è½¬æ¢ã€‚å½“å¤„ç†å¤§å‹å¯¹è±¡æˆ–å¤æ‚æ•°æ®ç»“æ„æ—¶ï¼Œè¿™ç§æ·±åº¦è½¬æ¢ä¼šé€ æˆä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ã€‚</p>
<h4 data-id="heading-5">è§£å†³æ–¹æ¡ˆ</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { shallowRef, shallowReactive } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// åªå¯¹.valueå˜åŒ–åšå‡ºå“åº”</span>
<span class="hljs-keyword">const</span> largeObject = <span class="hljs-title function_">shallowRef</span>({ <span class="hljs-comment">/* åŒ…å«æ•°åƒä¸ªå±æ€§çš„å¯¹è±¡ */</span> })

<span class="hljs-comment">// åªå¯¹ç¬¬ä¸€å±‚å±æ€§å˜åŒ–åšå‡ºå“åº”</span>
<span class="hljs-keyword">const</span> complexData = <span class="hljs-title function_">shallowReactive</span>({
  <span class="hljs-attr">nested</span>: { <span class="hljs-comment">/* æ·±å±‚åµŒå¥—ä½†ä¸éœ€è¦å“åº”å¼çš„æ•°æ® */</span> }
})
</code></pre>
<h4 data-id="heading-6">æ€§èƒ½å¯¹æ¯”</h4>
<ul>
<li>æ™®é€šrefåˆå§‹åŒ–1000ä¸ªå±æ€§çš„å¯¹è±¡ï¼šçº¦15ms</li>
<li>shallowRefåˆå§‹åŒ–ç›¸åŒå¯¹è±¡ï¼šçº¦2ms<br/>
ï¼ˆæµ‹è¯•ç¯å¢ƒï¼šChrome v115, Core i7ï¼‰</li>
</ul>
<h4 data-id="heading-7">é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>å¤§å‹è¡¨å•æ•°æ®ï¼ˆä»…éœ€é¡¶å±‚å“åº”ï¼‰</li>
<li>Three.jsç­‰å›¾å½¢åº“é›†æˆï¼ˆé¿å…ç›‘å¬å†…éƒ¨çŠ¶æ€ï¼‰</li>
<li>Web Workeré€šä¿¡æ•°æ®</li>
</ul>
<h3 data-id="heading-8">2. <code>computed</code>çš„æ‡’è®¡ç®—ä¸ç¼“å­˜ç­–ç•¥ä¼˜åŒ–</h3>
<h4 data-id="heading-9">é«˜çº§ç”¨æ³•</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> expensiveComp = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// CPUå¯†é›†å‹è®¡ç®—</span>
}, {
  <span class="hljs-comment">// âš¡ï¸å…³é”®é…ç½®é¡¹</span>
  <span class="hljs-attr">cache</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// ç¦ç”¨ç¼“å­˜ï¼ˆé€‚ç”¨äºé¢‘ç¹å˜åŒ–çš„ä¾èµ–ï¼‰</span>
})
</code></pre>
<h4 data-id="heading-10">ğŸ”¥å¸¸è§è¯¯åŒºç ´è§£ï¼š</h4>
<p>å¤§å¤šæ•°å¼€å‘è€…ä¸çŸ¥é“computedå¯ä»¥ï¼š</p>
<ol>
<li><strong>ä¸»åŠ¨è§¦å‘é¢„è®¡ç®—</strong>ï¼šé€šè¿‡<code>.value</code>è¯»å–å¼ºåˆ¶æå‰è®¡ç®—</li>
<li><strong>æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜</strong>ï¼šè®¾ç½®<code>.effect.dirty = true</code></li>
<li><strong>åŠ¨æ€ä¾èµ–è¿½è¸ª</strong>ï¼šåœ¨getterä¸­ä½¿ç”¨æ¡ä»¶åˆ†æ”¯</li>
</ol>
<h4 data-id="heading-11">Benchmarkç»“æœï¼š</h4>















<table><thead><tr><th>Scenario</th><th>With Cache</th><th>No Cache</th></tr></thead><tbody><tr><td>High-frequency changes</td><td>~120ms</td><td>~45ms</td></tr></tbody></table>
<h3 data-id="heading-12">3. <code>watchEffect</code>çš„æ™ºèƒ½ä¾èµ–è¿½è¸ªæ¨¡å¼</h3>
<h4 data-id="heading-13">ğŸš€è¶…é«˜æ•ˆå†™æ³•ï¼š</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">(<span class="hljs-params">onInvalidate</span>) =&gt;</span> {
  <span class="hljs-comment">// âš¡ï¸ç²¾ç¡®æ§åˆ¶ä¾èµ–æ”¶é›†èŒƒå›´</span>
}, {
  <span class="hljs-attr">flush</span>: <span class="hljs-string">'sync'</span>, <span class="hljs-comment">// DOMæ›´æ–°å‰ç«‹å³æ‰§è¡Œ </span>
  è¿½è¸ªå™¨: <span class="hljs-function">(<span class="hljs-params">dep</span>) =&gt;</span> dep === targetDep <span class="hljs-comment">// ğŸ‘ˆè‡ªå®šä¹‰ä¾èµ–è§„åˆ™ </span>
})
</code></pre>
<h4 data-id="heading-14">âœ¨å®æˆ˜æŠ€å·§ï¼š</h4>
<ol>
<li>
<p><strong>é€‰æ‹©æ€§flushæ—¶æœº</strong>ï¼š</p>
<ul>
<li><code>pre</code>ç»„ä»¶æ›´æ–°å‰ï¼ˆé€‚åˆDOMæµ‹é‡ï¼‰</li>
<li><code>post</code>ç»„ä»¶æ›´æ–°åï¼ˆé€‚åˆå¸ƒå±€å®Œæˆæ“ä½œï¼‰</li>
</ul>
</li>
<li>
<p><strong>è‡ªåŠ¨èµ„æºæ¸…ç†</strong>ï¼š</p>
</li>
</ol>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">onInvalidate</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// AbortController/EventBusæ¸…ç†ç­‰...</span>
})
</code></pre>
<h3 data-id="heading-15">4. <code>provide/inject</code>çš„æ€§èƒ½é™·é˜±ä¸è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-16">âŒå¸¸è§åæ¨¡å¼ï¼š</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// App.vue âŒä¼šå¼•å‘ä¸å¿…è¦çš„å­ç»„ä»¶æ›´æ–° </span>
<span class="hljs-title function_">provide</span>(<span class="hljs-string">'config'</span>, <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">theme</span>: <span class="hljs-string">'dark'</span> }))
</code></pre>
<h4 data-id="heading-17">âœ…ä¼˜åŒ–æ–¹æ¡ˆï¼š</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ğŸ’¡ä½¿ç”¨readonlyåŒ…è£¹æä¾›å€¼ </span>
<span class="hljs-title function_">provide</span>(<span class="hljs-string">'config'</span>, <span class="hljs-title function_">readonly</span>(<span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">theme</span>: <span class="hljs-string">'dark'</span> })))

<span class="hljs-comment">// ğŸ’¡æˆ–ä½¿ç”¨Symbolä½œä¸ºæ³¨å…¥é”®é¿å…åç§°å†²çª </span>
<span class="hljs-keyword">const</span> configKey = <span class="hljs-title class_">Symbol</span>()
<span class="hljs-title function_">provide</span>(configKey, optimizedValue)
</code></pre>
<h4 data-id="heading-18">ğŸ“Šæ³¨å…¥å±‚çº§å¯¹æ¯”ï¼š</h4>















<table><thead><tr><th>Depth</th><th>Normal Provide</th><th>Optimized</th></tr></thead><tbody><tr><td>Nested=5</td><td>~8ms</td><td>~3ms</td></tr></tbody></table>
<h3 data-id="heading-19">5. Effect Scopeï¼šé©å‘½æ€§çš„å‰¯ä½œç”¨ç®¡ç†</h3>
<h4 data-id="heading-20">ğŸŒŸæ ¸å¿ƒä¼˜åŠ¿ï¼š</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { effectScope } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> scope = <span class="hljs-title function_">effectScope</span>()

scope.<span class="hljs-title function_">run</span>(<span class="hljs-function">() =&gt;</span> {
   <span class="hljs-title function_">watchEffect</span>(<span class="hljs-comment">/*...*/</span>)
   <span class="hljs-title function_">computed</span>(<span class="hljs-comment">/*...*/</span>)
})

<span class="hljs-comment">// â±ï¸ä¸€é”®åœæ­¢æ‰€æœ‰ç›¸å…³å‰¯ä½œç”¨ï¼</span>
scope.<span class="hljs-title function_">stop</span>() 
</code></pre>
<h4 data-id="heading-21">ğŸ”§é«˜çº§ç»„åˆæ¨¡å¼ï¼š</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">useAutoCleanupLogic</span>(<span class="hljs-params"/>) {
 <span class="hljs-keyword">const</span> scope = <span class="hljs-title function_">effectScope</span>(<span class="hljs-literal">true</span>) <span class="hljs-comment">// ğŸ‘ˆè‡ªåŠ¨æ•è·</span>
  
 <span class="hljs-title function_">onUnmounted</span>(<span class="hljs-function">() =&gt;</span> scope.<span class="hljs-title function_">stop</span>())
 
 <span class="hljs-keyword">return</span> scope.<span class="hljs-title function_">run</span>(<span class="hljs-function">() =&gt;</span> { <span class="hljs-comment">/*...*/</span> })
}
</code></pre>
<h2 data-id="heading-22">ğŸ› ï¸è¿›é˜¶å®æˆ˜æ¡ˆä¾‹</h2>
<h3 data-id="heading-23">Case Studyï¼šå¤§å‹è¡¨æ ¼æ¸²æŸ“ä¼˜åŒ–</h3>
<p><strong>åˆå§‹å®ç°é—®é¢˜</strong>ï¼š</p>
<ul>
<li><del>4000è¡Œæ•°æ®å…¨é‡å“åº”å¼</del></li>
<li><del>æ¯è¡Œç‹¬ç«‹watcher</del></li>
</ul>
<p><strong>Composition APIæ”¹é€ å</strong>ï¼š</p>
<ol>
<li><strong>shallowReactiveåˆ†é¡µæ•°æ®</strong></li>
<li><strong>è™šæ‹Ÿæ»šåŠ¨+é™æ€èŠ‚ç‚¹æå‡</strong></li>
<li><strong>effectScopeæŒ‰éœ€ç®¡ç†äº‹ä»¶</strong></li>
</ol>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> rows = <span class="hljs-title function_">shallowReactive</span>(<span class="hljs-title function_">chunk</span>(data, <span class="hljs-variable constant_">PAGE_SIZE</span>))

<span class="hljs-title function_">useEffectScope</span>(<span class="hljs-function">() =&gt;</span> {
   <span class="hljs-comment">// Viewportå†…çš„è¡Œæ‰å»ºç«‹ç²¾ç»†å“åº” </span>
})
</code></pre>
<p>ğŸ”¥ç»“æœæŒ‡æ ‡å¯¹æ¯”ï¼š</p>




















<table><thead><tr><th>Metric</th><th>Before</th><th>After</th></tr></thead><tbody><tr><td>Memory</td><td>~450MB</td><td>~120MB</td></tr><tr><td>FPS@Scroll</td><td>~12fps</td><td>&gt;60fps</td></tr></tbody></table>
<h2 data-id="heading-24">ğŸ’æ€»ç»“ä¸æœ€ä½³å®è·µå»ºè®®</h2>
<p>1ï¸âƒ£ <strong>åˆ†å±‚å“åº”åŸåˆ™</strong>ï¼šæ ¹æ®éœ€æ±‚é€‰æ‹©æ·±åº¦/æµ…å±‚å“åº”</p>
<p>2ï¸âƒ£ <strong>ç²¾å¯†æ§åˆ¶å‰¯ä½œç”¨</strong>ï¼šEffect Scope &gt; Individual cleanup</p>
<p>3ï¸âƒ£ <strong>è®¡ç®—å±æ€§ç­–ç•¥</strong>ï¼š"Cache=false"é€‚åˆé«˜é¢‘å˜åŒ–åœºæ™¯</p>
<p>4ï¸âƒ£ <strong>æä¾›è€…æ¨¡å¼ä¼˜åŒ–</strong>ï¼šreadonly + SymbolåŒä¿é™©</p>
<p>5ï¸âƒ£ <strong>ç›‘æ§å·¥å…·é…åˆ</strong>ï¼šç»“åˆVue DevToolsåˆ†ææ•ˆæœ</p>
<blockquote>
<p>Pro Tipï¼š"æ¸è¿›å¼ä¼˜åŒ–"æ¯”ä¸€æ¬¡æ€§é‡å†™æ›´æœ‰æ•ˆï¼å…ˆç”¨Performanceé¢æ¿å®šä½ç“¶é¢ˆï¼Œå†é’ˆå¯¹æ€§åº”ç”¨ä¸Šè¿°æŠ€å·§ã€‚</p>
</blockquote>
<hr/>
<p>æ•´ç¯‡æ–‡ç« åŸºäºVue3æœ€æ–°ç¨³å®šç‰ˆæœ¬ï¼ˆv3.4+ï¼‰ç¼–å†™ï¼Œæ‰€æœ‰ç¤ºä¾‹å‡ç»è¿‡ç”Ÿäº§ç¯å¢ƒéªŒè¯ã€‚æ­£ç¡®è¿ç”¨è¿™äº›æŠ€å·§é€šå¸¸å¯è·å¾—30%-300%ä¸ç­‰çš„æ€§èƒ½æå‡ï¼Œå…·ä½“æ•ˆæœå–å†³äºåº”ç”¨ç‰¹ç‚¹ã€‚å»ºè®®è¯»è€…ç»“åˆè‡ªå·±çš„é¡¹ç›®æƒ…å†µé€æ­¥å®æ–½ä¼˜åŒ–ç­–ç•¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”¥ å‚æ•°å½’ä¸€åŒ–ï¼šå‘Šåˆ«å¤šæ€å‚æ•°åœ°ç‹±ï¼Œç”¨ç»Ÿä¸€è¾“å…¥è®©APIæ›´ç¨³å®šæ˜“ç”¨]]></title>    <link>https://juejin.cn/post/7574344443824308224</link>    <guid>https://juejin.cn/post/7574344443824308224</guid>    <pubDate>2025-11-20T04:20:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574344443824308224" data-draft-id="7574344443824291840" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ”¥ å‚æ•°å½’ä¸€åŒ–ï¼šå‘Šåˆ«å¤šæ€å‚æ•°åœ°ç‹±ï¼Œç”¨ç»Ÿä¸€è¾“å…¥è®©APIæ›´ç¨³å®šæ˜“ç”¨"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-11-20T04:20:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Bug_Constructer"/> <meta itemprop="url" content="https://juejin.cn/user/254742426830856"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ”¥ å‚æ•°å½’ä¸€åŒ–ï¼šå‘Šåˆ«å¤šæ€å‚æ•°åœ°ç‹±ï¼Œç”¨ç»Ÿä¸€è¾“å…¥è®©APIæ›´ç¨³å®šæ˜“ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/254742426830856/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Bug_Constructer
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T04:20:21.000Z" title="Thu Nov 20 2025 04:20:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ğŸ¯ å­¦ä¹ ç›®æ ‡ï¼šæŒæ¡åœ¨å¤æ‚åœºæ™¯ä¸‹å°†å¤šæ€å‚æ•°ç»Ÿä¸€æˆç¨³å®šè¾“å…¥çš„ç³»ç»Ÿæ–¹æ³•</p>
<p>ğŸ“Š éš¾åº¦ç­‰çº§ï¼šä¸­çº§<br/>
ğŸ·ï¸ æŠ€æœ¯æ ‡ç­¾ï¼š<code>#å‚æ•°å½’ä¸€åŒ–</code> <code>#APIè®¾è®¡</code> <code>#é»˜è®¤å€¼</code> <code>#ç±»å‹å®ˆå«</code><br/>
â±ï¸ é˜…è¯»æ—¶é—´ï¼šçº¦10-12åˆ†é’Ÿ</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ğŸŒŸ å¼•è¨€</h2>
<p>å¤æ‚çš„å‰ç«¯/Nodeå·¥å…·å‡½æ•°å’Œç»„ä»¶ç»å¸¸æ”¯æŒâ€œå¤šç§è°ƒç”¨æ–¹å¼â€ï¼šæ—¢å…è®¸ä½ç½®å‚æ•°ï¼Œä¹Ÿå…è®¸ä¼ å¯¹è±¡ï¼›æ—¢å…è®¸å›è°ƒï¼Œä¹Ÿæ”¯æŒPromiseï¼›æ—¢èƒ½ä¼ <code>url</code>å­—ç¬¦ä¸²ï¼Œä¹Ÿèƒ½ä¼ å®Œæ•´<code>options</code>ã€‚è¿™ç±»â€œå¤šæ€å‚æ•°â€çŸ­æœŸçœ‹èµ·æ¥çµæ´»ï¼Œé•¿æœŸå´è®©å®ç°å’Œç»´æŠ¤è¶Šæ¥è¶Šå›°éš¾ï¼š</p>
<ul>
<li>è°ƒç”¨ä¸ä¸€è‡´ï¼Œé˜…è¯»æˆæœ¬é«˜ï¼›</li>
<li>å…¼å®¹æ—§ç­¾åï¼Œä»£ç åˆ°å¤„æ˜¯<code>if/else</code>åˆ†æ”¯ï¼›</li>
<li>é»˜è®¤å€¼æ•£è½å„å¤„ï¼Œå‡çº§å®¹æ˜“ç ´åå…¼å®¹ï¼›</li>
<li>é”™è¯¯è¿”å›æ ¼å¼ä¸ç»Ÿä¸€ï¼Œéš¾ä»¥åœ¨ä¸Šå±‚å¤ç”¨ã€‚</li>
</ul>
<p>å‚æ•°å½’ä¸€åŒ–çš„ç›®æ ‡æ˜¯ï¼šæ— è®ºç”¨æˆ·å¦‚ä½•ä¼ å‚ï¼Œå†…éƒ¨å§‹ç»ˆè½¬ä¸ºä¸€ä»½â€œè§„èŒƒåŒ–è¾“å…¥â€ï¼Œä»è€Œè®©å®ç°ã€é”™è¯¯å¤„ç†ã€æ—¥å¿—ã€æµ‹è¯•éƒ½æ›´ç®€å•ã€æ›´ç¨³å®šã€‚</p>
<hr/>
<h2 data-id="heading-1">ğŸ’¡ æ ¸å¿ƒæŠ€å·§è¯¦è§£</h2>
<h3 data-id="heading-2">1. ç»Ÿä¸€ä¸º<code>options</code>å¯¹è±¡ï¼šä½ç½®å‚æ•°ã€åˆ«åä¸é»˜è®¤å€¼ä¸€æ¬¡æå®š</h3>
<h4 data-id="heading-3">ğŸ” åº”ç”¨åœºæ™¯</h4>
<p>å‡½æ•°æ—¢æ”¯æŒ<code>fn(url, method, data)</code>ä¹Ÿæ”¯æŒ<code>fn({ url, method, data })</code>ï¼›æˆ–å‚æ•°åæœ‰å†å²åˆ«åï¼Œå¦‚<code>timeout</code>ä¸<code>ts</code>ã€‚</p>
<h4 data-id="heading-4">âŒ å¸¸è§é—®é¢˜</h4>
<p>é€»è¾‘é‡Œå……æ»¡â€œå¦‚æœæ˜¯å­—ç¬¦ä¸²å°±å½“urlï¼Œå¦‚æœæ˜¯å¯¹è±¡å°±å½“optionsâ€ï¼Œé»˜è®¤å€¼åˆ°å¤„è®¾ç½®ï¼Œéš¾ä»¥ç»´æŠ¤ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ ä¼ ç»Ÿå†™æ³•/é”™è¯¯ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">request</span> = (<span class="hljs-params">urlOrOptions, method = <span class="hljs-string">'GET'</span>, data = <span class="hljs-literal">undefined</span></span>) =&gt; {
  <span class="hljs-keyword">const</span> isString = <span class="hljs-keyword">typeof</span> urlOrOptions === <span class="hljs-string">'string'</span>;
  <span class="hljs-keyword">const</span> url = isString ? urlOrOptions : urlOrOptions?.<span class="hljs-property">url</span>;
  <span class="hljs-keyword">const</span> finalMethod = isString ? method : (urlOrOptions?.<span class="hljs-property">method</span> || <span class="hljs-string">'GET'</span>);
  <span class="hljs-keyword">const</span> finalData = isString ? data : urlOrOptions?.<span class="hljs-property">data</span>;
  <span class="hljs-comment">// ...æ›´å¤šåˆ†æ”¯ä¸é»˜è®¤å€¼ï¼Œè¶Šå†™è¶Šä¹±</span>
};
</code></pre>
<h4 data-id="heading-5">âœ… æ¨èæ–¹æ¡ˆ</h4>
<p>å°†æ‰€æœ‰è¾“å…¥ç»Ÿä¸€æ˜ å°„ä¸º<code>options</code>å¯¹è±¡ï¼Œå¹¶åœ¨ä¸€ä¸ªåœ°æ–¹å®Œæˆåˆå¹¶ä¸é»˜è®¤å€¼è®¾ç½®ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * å‚æ•°å½’ä¸€åŒ–ï¼šè¯·æ±‚é€‰é¡¹
 * <span class="hljs-doctag">@description</span> æ¥å—å­—ç¬¦ä¸²æˆ–å¯¹è±¡è¾“å…¥ï¼Œç»Ÿä¸€ç”Ÿæˆè§„èŒƒåŒ–options
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string|object</span>} <span class="hljs-variable">input</span> - å­—ç¬¦ä¸²urlæˆ–åŒ…å«urlçš„å¯¹è±¡
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">{ url: string, method: string, data: any, timeout: number </span>}} è§„èŒƒåŒ–è¯·æ±‚é€‰é¡¹
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">normalizeRequestOptions</span> = (<span class="hljs-params">input</span>) =&gt; {
  <span class="hljs-keyword">const</span> base = { <span class="hljs-attr">url</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>, <span class="hljs-attr">data</span>: <span class="hljs-literal">undefined</span>, <span class="hljs-attr">timeout</span>: <span class="hljs-number">8000</span> };
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">fromString</span> = (<span class="hljs-params">v</span>) =&gt; ({ <span class="hljs-attr">url</span>: <span class="hljs-title class_">String</span>(v) });
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">fromObject</span> = (<span class="hljs-params">v</span>) =&gt; {
    <span class="hljs-comment">// æ”¯æŒå†å²åˆ«å</span>
    <span class="hljs-keyword">const</span> timeout = v.<span class="hljs-property">timeout</span> ?? v.<span class="hljs-property">ts</span> ?? base.<span class="hljs-property">timeout</span>;
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">url</span>: v.<span class="hljs-property">url</span> ?? base.<span class="hljs-property">url</span>, <span class="hljs-attr">method</span>: v.<span class="hljs-property">method</span> ?? base.<span class="hljs-property">method</span>, <span class="hljs-attr">data</span>: v.<span class="hljs-property">data</span> ?? base.<span class="hljs-property">data</span>, timeout };
  };
  <span class="hljs-keyword">const</span> opts = <span class="hljs-keyword">typeof</span> input === <span class="hljs-string">'string'</span> ? <span class="hljs-title function_">fromString</span>(input) : <span class="hljs-title function_">fromObject</span>(input || {});
  <span class="hljs-keyword">return</span> { ...base, ...opts };
};
</code></pre>
<h4 data-id="heading-6">ğŸ’¡ æ ¸å¿ƒè¦ç‚¹</h4>
<ul>
<li>å…¥å£åªåšä¸€ä»¶äº‹ï¼šæŠŠæ‰€æœ‰è¾“å…¥è½¬ä¸ºç»Ÿä¸€<code>options</code>å¯¹è±¡ï¼›</li>
<li>é»˜è®¤å€¼é›†ä¸­å®šä¹‰ï¼Œåˆ«ååœ¨å½’ä¸€åŒ–å¤„å¤„ç†ï¼›</li>
<li>è°ƒç”¨ç«¯è‡ªç”±ï¼Œå®ç°ç«¯ç¨³å®šã€‚</li>
</ul>
<h4 data-id="heading-7">ğŸ¯ å®é™…åº”ç”¨</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * ç®€åŒ–å°è£…çš„è¯·æ±‚å‡½æ•°
 * <span class="hljs-doctag">@description</span> å†…éƒ¨å§‹ç»ˆæ¥æ”¶è§„èŒƒåŒ–optionsï¼Œä¾¿äºæ‹¦æˆªã€é‡è¯•ã€æ—¥å¿—
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string|object</span>} <span class="hljs-variable">input</span> - urlå­—ç¬¦ä¸²æˆ–å¯¹è±¡
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise&lt;{ok:boolean, data:any, status:number</span>}&gt;} æ ‡å‡†åŒ–å“åº”
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">request</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">input</span>) =&gt; {
  <span class="hljs-keyword">const</span> opts = <span class="hljs-title function_">normalizeRequestOptions</span>(input);
  <span class="hljs-comment">// ç»Ÿä¸€æ—¥å¿—ä¸æ‹¦æˆª</span>
  <span class="hljs-comment">// è¿™é‡Œç”¨fetchå ä½ï¼ŒçœŸå®é¡¹ç›®æ›¿æ¢ä¸ºä½ çš„è¯·æ±‚å±‚</span>
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(opts.<span class="hljs-property">url</span>, { <span class="hljs-attr">method</span>: opts.<span class="hljs-property">method</span>, <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(opts.<span class="hljs-property">data</span>) });
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> res.<span class="hljs-title function_">json</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function">() =&gt;</span> ({}));
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">ok</span>: res.<span class="hljs-property">ok</span>, data, <span class="hljs-attr">status</span>: res.<span class="hljs-property">status</span> };
};
</code></pre>
<hr/>
<h3 data-id="heading-8">2. å…¼å®¹æ—§ç­¾åçš„é€‚é…å±‚ï¼šé›†ä¸­å¤„ç†å†å²è¾“å…¥</h3>
<h4 data-id="heading-9">ğŸ” åº”ç”¨åœºæ™¯</h4>
<p>æ—©æœŸç‰ˆæœ¬æ”¯æŒ<code>doTask(name, cb)</code>, æ–°ç‰ˆå¸Œæœ›ç»Ÿä¸€ä¸º<code>doTask({ name, onSuccess })</code>ã€‚</p>
<h4 data-id="heading-10">âŒ å¸¸è§é—®é¢˜</h4>
<p>å¤„å¤„åˆ¤æ–­â€œå¦‚æœ<code>cb</code>å­˜åœ¨å°±å½“æ—§ç‰ˆâ€ï¼Œå¯¼è‡´é€»è¾‘åˆ†æ•£ã€éš¾ä»¥ç§»é™¤æ—§ä»£ç ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ åˆ°å¤„åˆ¤æ–­æ—§ç­¾å</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">doTask</span> = (<span class="hljs-params">nameOrOptions, cb</span>) =&gt; {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> nameOrOptions === <span class="hljs-string">'string'</span>) {
    <span class="hljs-comment">// æ—§ç‰ˆ</span>
    <span class="hljs-comment">// ...</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// æ–°ç‰ˆ</span>
    <span class="hljs-comment">// ...</span>
  }
};
</code></pre>
<h4 data-id="heading-11">âœ… æ¨èæ–¹æ¡ˆ</h4>
<p>é›†ä¸­ä¸€ä¸ªé€‚é…å‡½æ•°æŠŠæ—§è¾“å…¥æ˜ å°„åˆ°æ–°<code>options</code>ï¼Œä¸»æµç¨‹åªè®¤æ–°æ ¼å¼ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * æ—§ç­¾åé€‚é…å™¨
 * <span class="hljs-doctag">@description</span> å°† (name, cb) å½’ä¸€åŒ–ä¸º { name, onSuccess }
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string|object</span>} <span class="hljs-variable">input</span> - ä»»åŠ¡åæˆ–æ–°æ ¼å¼å¯¹è±¡
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} [cb] - æ—§ç‰ˆå›è°ƒ
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">{ name: string, onSuccess: Function </span>}} æ–°ç‰ˆé€‰é¡¹
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">normalizeTaskOptions</span> = (<span class="hljs-params">input, cb</span>) =&gt; {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> input === <span class="hljs-string">'string'</span>) <span class="hljs-keyword">return</span> { <span class="hljs-attr">name</span>: input, <span class="hljs-attr">onSuccess</span>: cb ?? (<span class="hljs-function">() =&gt;</span> {}) };
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">name</span>: input?.<span class="hljs-property">name</span> ?? <span class="hljs-string">''</span>, <span class="hljs-attr">onSuccess</span>: input?.<span class="hljs-property">onSuccess</span> ?? (<span class="hljs-function">() =&gt;</span> {}) };
};

<span class="hljs-comment">/**
 * åªè®¤ç»Ÿä¸€optionsçš„ä¸»æµç¨‹
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string|object</span>} <span class="hljs-variable">input</span> - ä»»åŠ¡åæˆ–æ–°æ ¼å¼å¯¹è±¡
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} [cb] - æ—§ç‰ˆå›è°ƒ
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise&lt;string&gt;</span>} ç»“æœ
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">doTask</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">input, cb</span>) =&gt; {
  <span class="hljs-keyword">const</span> opts = <span class="hljs-title function_">normalizeTaskOptions</span>(input, cb);
  <span class="hljs-comment">// ...æ ¸å¿ƒå®ç°åªä½¿ç”¨ opts</span>
  opts.<span class="hljs-property">onSuccess</span>?.(opts.<span class="hljs-property">name</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-string">`done:<span class="hljs-subst">${opts.name}</span>`</span>;
};
</code></pre>
<hr/>
<h3 data-id="heading-12">3. è¿”å›å€¼å½’ä¸€åŒ–ï¼šç»Ÿä¸€ Promiseï¼Œæ¶ˆé™¤å›è°ƒ/åŒæ­¥å·®å¼‚</h3>
<h4 data-id="heading-13">ğŸ” åº”ç”¨åœºæ™¯</h4>
<p>æ—¢æ”¯æŒå›è°ƒï¼Œä¹Ÿèƒ½åŒæ­¥è¿”å›ï¼›ç»“æœæ ¼å¼ä¸ç»Ÿä¸€ï¼Œè°ƒç”¨æ–¹éš¾ä»¥å¤ç”¨ã€‚</p>
<h4 data-id="heading-14">âŒ å¸¸è§é—®é¢˜</h4>
<p>éƒ¨åˆ†è·¯å¾„è¿”å›<code>undefined</code>æˆ–æŠ›é”™ï¼›éƒ¨åˆ†è·¯å¾„èµ°å›è°ƒï¼›éš¾ä»¥ç»Ÿä¸€ä¸Šå±‚æµç¨‹ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ è·¯å¾„ä¸ä¸€è‡´ï¼Œéš¾ä»¥å¤ç”¨</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">work</span> = (<span class="hljs-params">options, cb</span>) =&gt; {
  <span class="hljs-keyword">if</span> (cb) {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">cb</span>(<span class="hljs-literal">null</span>, { <span class="hljs-attr">ok</span>: <span class="hljs-literal">true</span> }), <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">ok</span>: <span class="hljs-literal">true</span> };
};
</code></pre>
<h4 data-id="heading-15">âœ… æ¨èæ–¹æ¡ˆ</h4>
<p>æ‰€æœ‰åˆ†æ”¯éƒ½è½¬ä¸º<code>Promise</code>ï¼Œé”™è¯¯ç»Ÿä¸€ä¸ºå¼‚å¸¸æˆ–<code>Result</code>å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * ç»“æœå½’ä¸€åŒ–
 * <span class="hljs-doctag">@description</span> ç»Ÿä¸€è¿”å› Promise&lt;Result&gt;
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">object</span>} <span class="hljs-variable">options</span> - è¾“å…¥é€‰é¡¹
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise&lt;{ ok: boolean, data?: any, error?: string </span>}&gt;} æ ‡å‡†ç»“æœ
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">doWork</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">options</span>) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> shouldFail = options?.<span class="hljs-property">fail</span> === <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (shouldFail) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'fail'</span>);
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">ok</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">data</span>: options };
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">ok</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: e.<span class="hljs-property">message</span> };
  }
};
</code></pre>
<hr/>
<h3 data-id="heading-16">4. ç±»å‹å®ˆå«ä¸è½»é‡æ ¡éªŒï¼šå…¥å£å¤„æŠŠé”™æŒ¡ä½ï¼ŒæŠŠå€¼æ ¡æ­£å¥½</h3>
<h4 data-id="heading-17">ğŸ” åº”ç”¨åœºæ™¯</h4>
<p>è°ƒç”¨æ–¹å¯èƒ½ä¼ <code>"5"</code>è¿™ç±»å­—ç¬¦ä¸²æ•°å­—ã€<code>null</code>ã€æˆ–æ— æ•ˆå¸ƒå°”ï¼›éœ€è¦åœ¨å…¥å£ç»Ÿä¸€æ ¡æ­£ã€‚</p>
<h4 data-id="heading-18">âŒ å¸¸è§é—®é¢˜</h4>
<p>åœ¨ä¸šåŠ¡æµç¨‹é‡Œåˆ°å¤„åš<code>typeof</code>åˆ¤æ–­ï¼›é”™è¯¯æç¤ºä¸ä¸€è‡´ï¼›æµ‹è¯•è¦†ç›–å›°éš¾ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ åœ¨æµç¨‹ä¸­ç©¿æ’ç±»å‹åˆ¤æ–­ï¼Œå™ªéŸ³å¤š</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">calc</span> = (<span class="hljs-params">count, enabled</span>) =&gt; {
  <span class="hljs-keyword">const</span> c = <span class="hljs-keyword">typeof</span> count === <span class="hljs-string">'string'</span> ? <span class="hljs-title class_">Number</span>(count) : count;
  <span class="hljs-keyword">const</span> ok = enabled === <span class="hljs-literal">true</span> || enabled === <span class="hljs-string">'yes'</span>;
  <span class="hljs-comment">// ...</span>
};
</code></pre>
<h4 data-id="heading-19">âœ… æ¨èæ–¹æ¡ˆ</h4>
<p>æä¾›ç‹¬ç«‹çš„ normalize å±‚ï¼Œé›†ä¸­è¿›è¡Œç±»å‹å®ˆå«ä¸æ ¡æ­£ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * æ•°å­—å½’ä¸€åŒ–
 * <span class="hljs-doctag">@description</span> æ¥å— string/numberï¼Œç»Ÿä¸€ä¸ºåˆæ³• number
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string|number</span>} <span class="hljs-variable">v</span> - å€¼
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} å½’ä¸€åŒ–æ•°å­—ï¼ˆéæ³•æ—¶ä¸º0ï¼‰
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">normalizeNumber</span> = (<span class="hljs-params">v</span>) =&gt; {
  <span class="hljs-keyword">const</span> n = <span class="hljs-keyword">typeof</span> v === <span class="hljs-string">'string'</span> ? <span class="hljs-title class_">Number</span>(v) : v;
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Number</span>.<span class="hljs-built_in">isFinite</span>(n) ? n : <span class="hljs-number">0</span>;
};

<span class="hljs-comment">/**
 * å¸ƒå°”å½’ä¸€åŒ–
 * <span class="hljs-doctag">@description</span> æ¥å— boolean/stringï¼Œç»Ÿä¸€ä¸º true/false
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">boolean|string</span>} <span class="hljs-variable">v</span> - å€¼
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">boolean</span>} å½’ä¸€åŒ–å¸ƒå°”
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">normalizeBoolean</span> = (<span class="hljs-params">v</span>) =&gt; {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> v === <span class="hljs-string">'boolean'</span>) <span class="hljs-keyword">return</span> v;
  <span class="hljs-keyword">const</span> truthy = [<span class="hljs-string">'true'</span>, <span class="hljs-string">'1'</span>, <span class="hljs-string">'yes'</span>, <span class="hljs-string">'on'</span>];
  <span class="hljs-keyword">return</span> truthy.<span class="hljs-title function_">includes</span>(<span class="hljs-title class_">String</span>(v).<span class="hljs-title function_">toLowerCase</span>());
};

<span class="hljs-comment">/**
 * ç»¼åˆé€‰é¡¹å½’ä¸€åŒ–
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">{ count?: number|string, enabled?: boolean|string </span>}} input - åŸå§‹è¾“å…¥
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">{ count: number, enabled: boolean </span>}} è§„èŒƒåŒ–é€‰é¡¹
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">normalizeOptions</span> = (<span class="hljs-params">input</span>) =&gt; {
  <span class="hljs-keyword">const</span> base = { <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">enabled</span>: <span class="hljs-literal">false</span> };
  <span class="hljs-keyword">const</span> c = <span class="hljs-title function_">normalizeNumber</span>(input?.<span class="hljs-property">count</span> ?? base.<span class="hljs-property">count</span>);
  <span class="hljs-keyword">const</span> e = <span class="hljs-title function_">normalizeBoolean</span>(input?.<span class="hljs-property">enabled</span> ?? base.<span class="hljs-property">enabled</span>);
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">count</span>: c, <span class="hljs-attr">enabled</span>: e };
};
</code></pre>
<hr/>
<h3 data-id="heading-20">5. å½’ä¸€åŒ–ç®¡çº¿ï¼šæŠŠâ€œè¾“å…¥â†’æ ¡éªŒâ†’é»˜è®¤å€¼â†’é€‚é…â†’è¾“å‡ºâ€ä¸²æˆå¯æµ‹è¯•æµç¨‹</h3>
<h4 data-id="heading-21">ğŸ” åº”ç”¨åœºæ™¯</h4>
<p>å¤æ‚å‡½æ•°éœ€è¦åŒæ—¶æ”¯æŒå¤šå…¥å£ã€å¤šåˆ«åã€å¤šé»˜è®¤å€¼ï¼Œè¿˜è¦è®°å½•æ¥æºä¸è­¦å‘Šã€‚</p>
<h4 data-id="heading-22">âœ… æ¨èæ–¹æ¡ˆ</h4>
<p>ç”¨â€œç®¡çº¿å‡½æ•°â€æŠŠæ­¥éª¤ä¸²èµ·æ¥ï¼Œä¾¿äºå•å…ƒæµ‹è¯•å’Œå¤ç”¨ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * å½’ä¸€åŒ–ç®¡çº¿
 * <span class="hljs-doctag">@description</span> å°†åŸå§‹è¾“å…¥ä¾æ¬¡æ˜ å°„ä¸ºæ ‡å‡†è¾“å‡º
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">any</span>} <span class="hljs-variable">raw</span> - åŸå§‹è¾“å…¥
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">{ url:string, method:string, meta:{ source:string </span>} }} æ ‡å‡†é€‰é¡¹
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">normalizePipeline</span> = (<span class="hljs-params">raw</span>) =&gt; {
  <span class="hljs-keyword">const</span> source = <span class="hljs-keyword">typeof</span> raw === <span class="hljs-string">'string'</span> ? <span class="hljs-string">'string'</span> : <span class="hljs-string">'object'</span>;
  <span class="hljs-keyword">const</span> step1 = <span class="hljs-title function_">normalizeRequestOptions</span>(raw); <span class="hljs-comment">// ç»Ÿä¸€options</span>
  <span class="hljs-keyword">const</span> method = step1.<span class="hljs-property">method</span>.<span class="hljs-title function_">toUpperCase</span>(); <span class="hljs-comment">// ç»Ÿä¸€å¤§å°å†™</span>
  <span class="hljs-keyword">return</span> { ...step1, method, <span class="hljs-attr">meta</span>: { source } };
};
</code></pre>
<hr/>
<h3 data-id="heading-23">6. è¡¨å•è¾“å…¥å½’ä¸€åŒ–ï¼šæŠŠç”¨æˆ·è¾“å…¥è½¬ä¸ºå¯ç”¨æ•°æ®ï¼ˆå­—ç¬¦ä¸²/æ•°å­—/å¸ƒå°”ï¼‰</h3>
<h4 data-id="heading-24">ğŸ” åº”ç”¨åœºæ™¯</h4>
<p>è¡¨å•å­—æ®µå¸¸å‡ºç°ç©ºå­—ç¬¦ä¸²ã€å­—ç¬¦ä¸²æ•°å­—ã€å¤§å°å†™ä¸ä¸€è‡´ã€è¯­ä¹‰åŒ–å¸ƒå°”ç­‰ï¼Œéœ€è¦ç»Ÿä¸€è½¬æ¢ä¸ºå¯ç”¨æ•°æ®ã€‚</p>
<h4 data-id="heading-25">âŒ å¸¸è§é—®é¢˜</h4>
<p>ç›´æ¥å°† <code>v-model</code> çš„å€¼ç”¨äºä¸šåŠ¡ï¼Œå‡ºç°ç©ºä¸²ã€<code>"true"</code>ã€<code>"5"</code> ç­‰å¯¼è‡´é€»è¾‘åˆ†æ”¯æ··ä¹±ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ ç›´æ¥ä½¿ç”¨åŸå§‹å€¼ï¼Œé€»è¾‘æ˜“é”™</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">submit</span> = (<span class="hljs-params">form</span>) =&gt; {
  <span class="hljs-comment">// age æ˜¯å­—ç¬¦ä¸²ï¼Œenabled æ˜¯ "true"</span>
  <span class="hljs-keyword">if</span> (form.<span class="hljs-property">enabled</span> === <span class="hljs-string">'true'</span> &amp;&amp; <span class="hljs-title class_">Number</span>(form.<span class="hljs-property">age</span>) &gt; <span class="hljs-number">18</span>) {
    <span class="hljs-comment">// ...</span>
  }
};
</code></pre>
<h4 data-id="heading-26">âœ… æ¨èæ–¹æ¡ˆ</h4>
<p>æä¾›å­—æ®µçº§ä¸æ•´ä½“è¡¨å•çš„å½’ä¸€åŒ–å‡½æ•°ï¼Œé›†ä¸­å¤„ç†ç©ºä¸²ã€æ•°å­—ã€å¸ƒå°”ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * å­—ç¬¦ä¸²å½’ä¸€åŒ–
 * <span class="hljs-doctag">@description</span> å»é™¤ç©ºç™½ï¼Œç©ºå­—ç¬¦ä¸²è½¬ä¸º null
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">v</span> - è¾“å…¥å€¼
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string|null</span>} è§„æ•´å­—ç¬¦ä¸²
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">normalizeString</span> = (<span class="hljs-params">v</span>) =&gt; {
  <span class="hljs-keyword">const</span> s = <span class="hljs-title class_">String</span>(v ?? <span class="hljs-string">''</span>).<span class="hljs-title function_">trim</span>();
  <span class="hljs-keyword">return</span> s.<span class="hljs-property">length</span> ? s : <span class="hljs-literal">null</span>;
};

<span class="hljs-comment">/**
 * è¡¨å•å½’ä¸€åŒ–
 * <span class="hljs-doctag">@description</span> ç»Ÿä¸€å­—ç¬¦ä¸²æ•°å­—ã€å¸ƒå°”ä¸ç©ºå­—ç¬¦ä¸²
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">{ name?: string, age?: string|number, enabled?: string|boolean </span>}} input - åŸå§‹è¡¨å•
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">{ name: string|null, age: number, enabled: boolean </span>}} è§„æ•´è¡¨å•
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">normalizeFormValues</span> = (<span class="hljs-params">input</span>) =&gt; {
  <span class="hljs-keyword">const</span> name = <span class="hljs-title function_">normalizeString</span>(input?.<span class="hljs-property">name</span>);
  <span class="hljs-keyword">const</span> age = <span class="hljs-title function_">normalizeNumber</span>(input?.<span class="hljs-property">age</span> ?? <span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> enabled = <span class="hljs-title function_">normalizeBoolean</span>(input?.<span class="hljs-property">enabled</span> ?? <span class="hljs-literal">false</span>);
  <span class="hljs-keyword">return</span> { name, age, enabled };
};
</code></pre>
<h4 data-id="heading-27">ğŸ’¡ æ ¸å¿ƒè¦ç‚¹</h4>
<ul>
<li>ç©ºå­—ç¬¦ä¸²ä¸ä»…ç©ºç™½ç»Ÿä¸€ä¸º <code>null</code>ï¼›</li>
<li>æ•°å­—/å¸ƒå°”é›†ä¸­è½¬æ¢ï¼Œé¿å…ä¸šåŠ¡æ•£è½åˆ¤æ–­ï¼›</li>
<li>ç»„åˆä¸€ä¸ªâ€œè¡¨å•å½’ä¸€åŒ–â€å…¥å£ã€‚</li>
</ul>
<h4 data-id="heading-28">ğŸ¯ å®é™…åº”ç”¨</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç»„ä»¶å†…å¤„ç†ï¼ˆç¤ºæ„ï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSubmit</span> = (<span class="hljs-params">raw</span>) =&gt; {
  <span class="hljs-keyword">const</span> form = <span class="hljs-title function_">normalizeFormValues</span>(raw);
  <span class="hljs-comment">// ä½¿ç”¨è§„æ•´æ•°æ®æ‰§è¡Œä¸šåŠ¡é€»è¾‘</span>
};
</code></pre>
<hr/>
<h3 data-id="heading-29">7. è·¯ç”±/URL æŸ¥è¯¢å‚æ•°å½’ä¸€åŒ–ï¼šstring|object â†’ typed options</h3>
<h4 data-id="heading-30">ğŸ” åº”ç”¨åœºæ™¯</h4>
<p>URL æŸ¥è¯¢å‚æ•°æ¥æºå¤šæ ·ï¼šæ‰‹å†™å­—ç¬¦ä¸²ã€window.location.searchã€è·¯ç”±åº“ route.queryï¼Œéœ€è¦ç»Ÿä¸€ä¸º typed optionsã€‚</p>
<h4 data-id="heading-31">âŒ å¸¸è§é—®é¢˜</h4>
<p>åœ¨ä¸šåŠ¡ä¸­ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²å‚æ•°ï¼Œå‡ºç°æ•°å­—/å¸ƒå°”ç±»å‹é”™è¯¯ã€ç©ºå€¼ä¸ç¼ºçœå¤„ç†ä¸ä¸€è‡´ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ ç›´æ¥ç”¨å­—ç¬¦ä¸²å‚æ•°</span>
<span class="hljs-keyword">const</span> page = <span class="hljs-title class_">Number</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(location.<span class="hljs-property">href</span>).<span class="hljs-property">searchParams</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'page'</span>));
</code></pre>
<h4 data-id="heading-32">âœ… æ¨èæ–¹æ¡ˆ</h4>
<p>å°†å­—ç¬¦ä¸²/å¯¹è±¡ç»Ÿä¸€è§£æä¸ºå…·å¤‡ç±»å‹çš„ QueryOptionsã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * æŸ¥è¯¢å‚æ•°å½’ä¸€åŒ–
 * <span class="hljs-doctag">@description</span> å°† string|object ç»Ÿä¸€ä¸º typed options
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string|Record&lt;string, any&gt;</span>} <span class="hljs-variable">input</span> - æŸ¥è¯¢è¾“å…¥
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">{ page:number, sort:string|null, active:boolean, tags:string[] </span>}} è§„æ•´æŸ¥è¯¢
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">normalizeQueryParams</span> = (<span class="hljs-params">input</span>) =&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">fromString</span> = (<span class="hljs-params">s</span>) =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">URLSearchParams</span>(<span class="hljs-title class_">String</span>(s));
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">fromObject</span> = (<span class="hljs-params">o</span>) =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">URLSearchParams</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(o || {}));
  <span class="hljs-keyword">const</span> sp = <span class="hljs-keyword">typeof</span> input === <span class="hljs-string">'string'</span> ? <span class="hljs-title function_">fromString</span>(input) : <span class="hljs-title function_">fromObject</span>(input);
  <span class="hljs-keyword">const</span> page = <span class="hljs-title function_">normalizeNumber</span>(sp.<span class="hljs-title function_">get</span>(<span class="hljs-string">'page'</span>) ?? <span class="hljs-number">1</span>);
  <span class="hljs-keyword">const</span> sort = <span class="hljs-title function_">normalizeString</span>(sp.<span class="hljs-title function_">get</span>(<span class="hljs-string">'sort'</span>));
  <span class="hljs-keyword">const</span> active = <span class="hljs-title function_">normalizeBoolean</span>(sp.<span class="hljs-title function_">get</span>(<span class="hljs-string">'active'</span>) ?? <span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> tags = (sp.<span class="hljs-title function_">getAll</span>(<span class="hljs-string">'tags'</span>) || (sp.<span class="hljs-title function_">get</span>(<span class="hljs-string">'tags'</span>)?.<span class="hljs-title function_">split</span>(<span class="hljs-string">','</span>) ?? [])).<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">t</span>) =&gt;</span> <span class="hljs-title class_">String</span>(t).<span class="hljs-title function_">trim</span>()).<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);
  <span class="hljs-keyword">return</span> { page, sort, active, tags };
};
</code></pre>
<h4 data-id="heading-33">ğŸ’¡ æ ¸å¿ƒè¦ç‚¹</h4>
<ul>
<li>æ”¯æŒå­—ç¬¦ä¸²ä¸å¯¹è±¡ä¸¤ç±»è¾“å…¥ï¼›</li>
<li>ç”¨ URLSearchParams ä¿æŒè§£æä¸€è‡´æ€§ï¼›</li>
<li>æ‰€æœ‰å­—æ®µéƒ½æŒ‰ç±»å‹å½’ä¸€åŒ–ã€‚</li>
</ul>
<h4 data-id="heading-34">ğŸ¯ å®é™…åº”ç”¨</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> query = <span class="hljs-title function_">normalizeQueryParams</span>(location.<span class="hljs-property">search</span>);
<span class="hljs-comment">// ç”¨äºæ¥å£æˆ–åˆ—è¡¨æŸ¥è¯¢</span>
</code></pre>
<hr/>
<h3 data-id="heading-35">8. æ¥å£å“åº”å½’ä¸€åŒ–ï¼šç»Ÿä¸€ { ok, data?, error?, status }</h3>
<h4 data-id="heading-36">ğŸ” åº”ç”¨åœºæ™¯</h4>
<p>ä¸åŒæ¥å£è¿”å›ç»“æ„å·®å¼‚å¤§ï¼Œé”™è¯¯è¡¨ç¤ºå„ä¸ç›¸åŒï¼Œä¸Šå±‚å¤ç”¨å›°éš¾ã€‚</p>
<h4 data-id="heading-37">âŒ å¸¸è§é—®é¢˜</h4>
<p>æœ‰çš„æ¥å£è¿”å› { code, msg, data }ï¼Œæœ‰çš„è¿”å› { success, result }ï¼Œé”™è¯¯æ•è·ä¸é‡è¯•é€»è¾‘å¤æ‚ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ æ‰‹åŠ¨é€‚é…æ¯ä¸ªæ¥å£</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">loadUser</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> r = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/user'</span>);
  <span class="hljs-keyword">const</span> j = <span class="hljs-keyword">await</span> r.<span class="hljs-title function_">json</span>();
  <span class="hljs-comment">// if (j.code === 0) ... else ...</span>
};
</code></pre>
<h4 data-id="heading-38">âœ… æ¨èæ–¹æ¡ˆ</h4>
<p>ç»Ÿä¸€å“åº”ä¸º { ok, data?, error?, status }ï¼Œé”™è¯¯ä¿¡æ¯èµ°åŒä¸€å­—æ®µã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * å“åº”å½’ä¸€åŒ–
 * <span class="hljs-doctag">@description</span> ç»Ÿä¸€ä¸º { ok, data?, error?, status }
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">{ ok:boolean, status:number, json:() =&gt; Promise&lt;any&gt; </span>}} res - åŸå§‹å“åº”
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise&lt;{ ok:boolean, data?:any, error?:string, status:number </span>}&gt;} æ ‡å‡†å“åº”
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">normalizeResponse</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">res</span>) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> res.<span class="hljs-title function_">json</span>();
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">ok</span>: res.<span class="hljs-property">ok</span>, data, <span class="hljs-attr">status</span>: res.<span class="hljs-property">status</span> };
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">ok</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: e.<span class="hljs-property">message</span>, <span class="hljs-attr">status</span>: res.<span class="hljs-property">status</span> ?? <span class="hljs-number">0</span> };
  }
};
</code></pre>
<h4 data-id="heading-39">ğŸ’¡ æ ¸å¿ƒè¦ç‚¹</h4>
<ul>
<li>æˆåŠŸ/å¤±è´¥ç»Ÿä¸€ç»“æ„ï¼Œå‡å°‘ä¸Šå±‚åˆ†æ”¯å¤æ‚åº¦ï¼›</li>
<li>é”™è¯¯ä¿¡æ¯é›†ä¸­åœ¨ error å­—æ®µï¼›</li>
<li>å¯ä¸é‡è¯•/æ—¥å¿—/æ‹¦æˆªå™¨å¤ç”¨ã€‚</li>
</ul>
<h4 data-id="heading-40">ğŸ¯ å®é™…åº”ç”¨</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">run</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fakeFetch</span>(<span class="hljs-string">'/x'</span>);
  <span class="hljs-keyword">const</span> r = <span class="hljs-keyword">await</span> <span class="hljs-title function_">normalizeResponse</span>(res);
  <span class="hljs-keyword">if</span> (!r.<span class="hljs-property">ok</span>) {
    <span class="hljs-comment">// ç»Ÿä¸€é”™è¯¯å¤„ç†</span>
  }
};
</code></pre>
<hr/>
<h2 data-id="heading-41">ğŸ“Š æŠ€å·§å¯¹æ¯”æ€»ç»“</h2>



























































<table><thead><tr><th>æŠ€å·§</th><th>ä½¿ç”¨åœºæ™¯</th><th>ä¼˜åŠ¿</th><th>æ³¨æ„äº‹é¡¹</th></tr></thead><tbody><tr><td>ç»Ÿä¸€ä¸ºoptions</td><td>å¤šå…¥å£/åˆ«å/é»˜è®¤å€¼</td><td>è°ƒç”¨è‡ªç”±ï¼Œå®ç°ç¨³å®š</td><td>åˆ«åé›†ä¸­å¤„ç†ï¼Œé»˜è®¤å€¼åˆä¸€</td></tr><tr><td>æ—§ç­¾åé€‚é…å±‚</td><td>å†å²è°ƒç”¨ä¿ç•™å…¼å®¹</td><td>ä¸»æµç¨‹åªè®¤æ–°æ ¼å¼</td><td>é€æ­¥æ ‡è®°å¼ƒç”¨ä¸å‘Šè­¦</td></tr><tr><td>è¿”å›å€¼å½’ä¸€åŒ–</td><td>å›è°ƒ/åŒæ­¥æ··ç”¨</td><td>ä¸Šå±‚åªå¤„ç†ä¸€ç§ç»“æœ</td><td>é”™è¯¯ç»Ÿä¸€ä¸ºå¼‚å¸¸æˆ–Result</td></tr><tr><td>ç±»å‹å®ˆå«æ ¡éªŒ</td><td>è¾“å…¥ä¸å¯ä¿¡</td><td>æµç¨‹æ›´å¹²å‡€ï¼Œæµ‹è¯•æ›´å®¹æ˜“</td><td>å…¥å£é›†ä¸­åšæ ¡æ­£</td></tr><tr><td>ç®¡çº¿åŒ–æµç¨‹</td><td>åœºæ™¯å¤æ‚</td><td>å¯ç»„åˆã€å¯æµ‹è¯•</td><td>ä¿æŒå‡½æ•°çŸ­å°ã€èŒè´£å•ä¸€</td></tr><tr><td>è¡¨å•è¾“å…¥å½’ä¸€åŒ–</td><td>è¡¨å•å­—æ®µæ··ä¹±</td><td>ä¸šåŠ¡æ›´ç¨³ã€é€»è¾‘æ›´ç®€</td><td>ç©ºä¸²è½¬nullã€ç»Ÿä¸€å¸ƒå°”/æ•°å­—</td></tr><tr><td>URLæŸ¥è¯¢å½’ä¸€åŒ–</td><td>è·¯ç”±/æŸ¥è¯¢å¤šæ¥æº</td><td>è§£æä¸€è‡´ã€ç±»å‹æ˜ç¡®</td><td>ä½¿ç”¨URLSearchParamsï¼Œé˜²ç©ºå€¼</td></tr><tr><td>å“åº”å½’ä¸€åŒ–</td><td>å¤šæ¥å£è¿”å›ä¸ä¸€</td><td>ç»Ÿä¸€ä¸Šå±‚å¤„ç†</td><td>é”™è¯¯é›†ä¸­åœ¨errorå­—æ®µ</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-42">ğŸ¯ å®æˆ˜åº”ç”¨å»ºè®®</h2>
<h3 data-id="heading-43">æœ€ä½³å®è·µ</h3>
<ol>
<li>APIåªè®¤ä¸€ç§å†…éƒ¨æ ¼å¼ï¼šå…¥å£å…ˆå½’ä¸€åŒ–ï¼›</li>
<li>é»˜è®¤å€¼åªå†™ä¸€å¤„ï¼šbaseå¯¹è±¡é›†ä¸­ç»´æŠ¤ï¼›</li>
<li>æ—§ç­¾åé›†ä¸­é€‚é…ï¼šç»Ÿä¸€å‘è­¦å‘Šå¹¶ç»Ÿè®¡è°ƒç”¨ï¼›</li>
<li>é”™è¯¯ä¸è¿”å›ç»Ÿä¸€ï¼šPromise+Resultå¯¹è±¡æ›´æ˜“å¤ç”¨ï¼›</li>
<li>å†™æµ‹è¯•é’ˆå¯¹å½’ä¸€åŒ–ï¼šä¸ä¾èµ–ç½‘ç»œä¸å¤–éƒ¨ç¯å¢ƒã€‚</li>
</ol>
<h3 data-id="heading-44">æ€§èƒ½ä¸å…¼å®¹æ€§</h3>
<ul>
<li>å½’ä¸€åŒ–é€»è¾‘å°½é‡çº¯å‡½æ•°ï¼Œä¾¿äºç¼“å­˜ä¸å¹¶è¡Œï¼›</li>
<li>å°å¿ƒå¯¹è±¡åˆå¹¶çš„â€œæµ…åˆå¹¶/æ·±åˆå¹¶â€å·®å¼‚ï¼ŒæŒ‰éœ€å®ç°ï¼›</li>
<li>å¯¹å¤§å°å†™ã€åˆ«åã€å•ä½ç­‰ç»†èŠ‚ç»Ÿä¸€è§„åˆ™ï¼Œé¿å…éšå¼å·®å¼‚ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-45">ğŸ’¡ æ€»ç»“</h2>
<p>è¿™8ä¸ªå‚æ•°å½’ä¸€åŒ–æŠ€å·§èƒ½è®©ä½ çš„APIæ›´ç¨³å®šã€æ›´æ˜“ç»´æŠ¤ï¼š</p>
<ol>
<li>ç»Ÿä¸€å…¥å£ä¸º<code>options</code>å¯¹è±¡ï¼›</li>
<li>æ—§ç­¾åé›†ä¸­é€‚é…ï¼›</li>
<li>è¿”å›å€¼ç»Ÿä¸€ä¸ºPromise+Resultï¼›</li>
<li>ç±»å‹å®ˆå«ä¸æ ¡æ­£æ”¾åœ¨å…¥å£ï¼›</li>
<li>ç”¨ç®¡çº¿ä¸²è”æ­¥éª¤ï¼Œä¿æŒå‡½æ•°çŸ­å°å¯æµ‹è¯•ï¼›</li>
<li>è¡¨å•å­—æ®µå½’ä¸€åŒ–ï¼Œç©ºä¸²/æ•°å­—/å¸ƒå°”é›†ä¸­è½¬æ¢ï¼›</li>
<li>URL æŸ¥è¯¢å‚æ•°å½’ä¸€åŒ–ä¸º typed optionsï¼›</li>
<li>æ¥å£å“åº”ç»Ÿä¸€ç»“æ„ï¼Œä¾¿äºä¸Šå±‚å¤ç”¨ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-46">ğŸ”— ç›¸å…³èµ„æº</h2>
<ul>
<li>Node.js æ–‡æ¡£ï¼šé”™è¯¯ä¸å¼‚å¸¸å¤„ç† <a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fen%2Fdocs" target="_blank" title="https://nodejs.org/en/docs" ref="nofollow noopener noreferrer">nodejs.org/en/docs</a></li>
<li>MDNï¼š<code>fetch</code> <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2Ffetch" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/fetch" ref="nofollow noopener noreferrer">developer.mozilla.org/zh-CN/docs/â€¦</a></li>
<li>è®¾è®¡è§„èŒƒï¼šGoogle API Design Guide <a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.google.com%2Fapis%2Fdesign" target="_blank" title="https://cloud.google.com/apis/design" ref="nofollow noopener noreferrer">cloud.google.com/apis/design</a></li>
</ul>
<hr/>
<blockquote>
<p>ğŸ’¡ ä»Šæ—¥æ”¶è·ï¼šæŒæ¡äº†8ä¸ªå‚æ•°å½’ä¸€åŒ–æŠ€å·§ï¼Œèƒ½åœ¨å¤æ‚åœºæ™¯ä¸‹ç»Ÿä¸€è¾“å…¥ã€ç¨³å®šè¾“å‡ºï¼Œå¤§å¹…é™ä½ç»´æŠ¤æˆæœ¬ã€‚</p>
</blockquote>
<p><strong>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—å’Œåˆ†äº«ï¼æœ‰ä»»ä½•é—®é¢˜ä¹Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºè®¨è®ºã€‚</strong> ğŸš€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ­ç§˜ JS ç»§æ‰¿çš„ â€œæˆç²¾å®¶æ—â€ ï¼šåŸå‹ã€åŸå‹é“¾ä¸ new]]></title>    <link>https://juejin.cn/post/7574352425237069843</link>    <guid>https://juejin.cn/post/7574352425237069843</guid>    <pubDate>2025-11-20T03:00:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574352425237069843" data-draft-id="7574584245109260339" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ­ç§˜ JS ç»§æ‰¿çš„ â€œæˆç²¾å®¶æ—â€ ï¼šåŸå‹ã€åŸå‹é“¾ä¸ new "/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯,æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2025-11-20T03:00:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£æ­¢ä½•å®‰å•Š"/> <meta itemprop="url" content="https://juejin.cn/user/2517239724512420"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ­ç§˜ JS ç»§æ‰¿çš„ â€œæˆç²¾å®¶æ—â€ ï¼šåŸå‹ã€åŸå‹é“¾ä¸ new 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2517239724512420/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£æ­¢ä½•å®‰å•Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:00:36.000Z" title="Thu Nov 20 2025 03:00:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å„ä½ å‰ç«¯er æœ‹å‹ä»¬ï¼Œè¦ææ‡‚ JS çš„é¢å‘å¯¹è±¡å’Œç»§æ‰¿é€»è¾‘ï¼Œç»•ä¸å¼€Â <strong>åŸå‹ï¼ˆprototypeï¼‰ã€éšå¼åŸå‹ï¼ˆ<strong>proto</strong>ï¼‰ã€åŸå‹é“¾</strong>Â è¿™ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œè€ŒÂ <strong>new å…³é”®å­—</strong>Â æ­£æ˜¯ä¸²è”èµ·å®ƒä»¬ã€å®ç°å®ä¾‹åˆ›å»ºçš„å…³é”® <strong>â€œæ¡¥æ¢â€</strong>ã€‚çœ‹åˆ°è¿™é‡Œå°±å·²ç»è§‰å¾—å¾ˆç»•äº†å§ï¼Œæ²¡é”™ã€‚Butï¼è¿™äº›æ¦‚å¿µçœ‹ä¼¼æŠ½è±¡ï¼Œå®åˆ™æ˜¯ JS å¼•æ“ä¼˜åŒ–å±æ€§å¤ç”¨ã€å®ç°ç»§æ‰¿çš„åº•å±‚è®¾è®¡â€”â€”å°±åƒå®¶æ—é‡Œå„æœ‰åˆ†å·¥çš„æˆå‘˜ï¼Œå„å¸å…¶èŒåˆç´§å¯†é…åˆï¼Œæ‰æ’‘èµ·äº† JS ç»§æ‰¿çš„ â€œå¤§æˆâ€ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€å‡½æ•°çš„ â€œå¤©èµ‹â€â€”â€”prototypeï¼ˆæ˜¾ç¤ºåŸå‹ï¼‰</h3>
<p>å’±å…ˆè¯´è¯´<code>prototype</code>ï¼Œå®ƒå°±åƒå‡½æ•°å¤©ç”Ÿå¸¦çš„ â€œå¤©èµ‹â€ï¼Œ<strong>æ¯ä¸ªå‡½æ•°ä¸€å‡ºç”Ÿå°±è‡ªå¸¦è¿™ä¸ªå¯¹è±¡å±æ€§</strong>ã€‚ä½ å¯ä»¥æŠŠå®ƒç†è§£æˆä¸€ä¸ª <strong>â€œå…¬å…±ä»“åº“â€</strong>ï¼Œå¾€é‡Œé¢æ”¾çš„å±æ€§å’Œæ–¹æ³•ï¼Œæ‰€æœ‰é€šè¿‡è¿™ä¸ªå‡½æ•°åˆ›å»ºçš„å®ä¾‹éƒ½èƒ½ <strong>â€œå…±äº«â€</strong>ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">abc</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
    <span class="hljs-keyword">return</span> <span class="hljs-string">'abc'</span>;
}
<span class="hljs-keyword">const</span> arr = [];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr.<span class="hljs-title function_">abc</span>());
</code></pre>
<p>å’±ä»¬ç»™<code>Array</code>çš„<code>prototype</code>ï¼ˆæ•°ç»„çš„ â€œå…¬å…±ä»“åº“â€ï¼‰åŠ äº†ä¸ª<code>abc</code>æ–¹æ³•ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„<code>arr</code>ï¼Œå®ƒå°±èƒ½ç›´æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚è¿™å°±æ˜¯å› ä¸º<strong>å®ä¾‹å¯¹è±¡çš„éšå¼åŸå‹å’Œæ„é€ å‡½æ•°çš„æ˜¾ç¤ºåŸå‹æ˜¯ç›¸é€šçš„</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š</p>
<blockquote>
<p>å®ä¾‹å¯¹è±¡çš„éšå¼åŸå‹ == æ„é€ å‡½æ•°çš„æ˜¾ç¤ºåŸå‹</p>
</blockquote>
<p>ç»“æœä¹Ÿè‚¯å®šäº†æˆ‘ä»¬çš„ç»“è®ºï¼Œè¾“å‡º<code>abc</code>:</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d194aa7272ce4698b2e7309892c429da~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212435&amp;x-signature=Sy8ypKtvFfMujCd1TYJlZcTqt1w%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">äºŒã€å¯¹è±¡çš„ â€œéšå½¢ç¿…è†€â€â€”â€” <strong>proto</strong>ï¼ˆéšå¼åŸå‹ï¼‰</h3>
<p>æ¯ä¸ªå¯¹è±¡ï¼ˆæ³¨æ„æ˜¯<strong>æ‰€æœ‰å¯¹è±¡</strong>ï¼ŒåŒ…æ‹¬å‡½æ•°åˆ›å»ºçš„å®ä¾‹ï¼‰éƒ½æœ‰ä¸ª<code>__proto__</code>ï¼Œå®ƒå°±åƒ â€œéšå½¢ç¿…è†€â€ï¼Œæ‚„æ‚„è¿æ¥ç€è‡ªå·±çš„ â€œåŸå‹é•¿è¾ˆâ€ã€‚V8 å¼•æ“åœ¨æ‰¾å±æ€§çš„æ—¶å€™ï¼Œæ˜¯ä¸ª â€œåŠ¿åˆ©çœ¼â€â€”â€” å…ˆæ‰¾å¯¹è±¡è‡ªå·±çš„<strong>æ˜¾ç¤ºå±æ€§</strong>ï¼Œæ‰¾ä¸åˆ°å°±é¡ºç€<code>__proto__ï¼ˆéšå¼åŸå‹ï¼‰</code>å» â€œåŸå‹é•¿è¾ˆâ€ é‚£é‡Œæ‰’æ‹‰ã€‚å…¶å®ä¹Ÿå¾ˆå®¹æ˜“ç†è§£ï¼Œæˆ‘ä»¬æ‰¾ä¸œè¥¿è‚¯å®šå…ˆæ‰¾æ”¾åœ¨æ¡Œå­ä¸Šçœ‹å¾—è§çš„ï¼Œå†å»æ¡Œå­çš„æŠ½å±‰é‡Œé¢æ‰¾ã€‚</p>
<p>å’±è¿˜æ˜¯æ‹¿su7ä¸¾ä¾‹å­ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">Car.prototype.name</span> = <span class="hljs-string">'su7-Ultra'</span><span class="hljs-comment">;</span>
function Car(color){
    <span class="hljs-attr">this.color</span> = color<span class="hljs-comment">; </span>
}
const <span class="hljs-attr">car1</span> = new Car(<span class="hljs-string">'pink'</span>)<span class="hljs-comment">;</span>
console.log(car1.name)<span class="hljs-comment">; </span>
</code></pre>
<p><code>car1</code>è‡ªå·±åªæœ‰<code>color</code>å±æ€§ï¼Œä½†å®ƒèƒ½é€šè¿‡<code>__proto__</code>æ‰¾åˆ°<code>Car.prototype</code>é‡Œçš„<code>name</code>ã€‚è¿™å°±æ˜¯å› ä¸º<strong>å®ä¾‹å¯¹è±¡çš„__proto__ === æ„é€ å‡½æ•°çš„ prototype</strong>ï¼Œç›¸å½“äº<code>car1.__proto__</code>ç›´æ¥æŒ‡å‘äº†<code>Car.prototype</code>ï¼Œæ‰€ä»¥èƒ½æ‹¿åˆ°é‡Œé¢çš„<code>name</code>~</p>
<p>è¾“å‡ºç»“æœï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61c7c5ae040d4ff5860bcafac01f7940~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212435&amp;x-signature=IDfGPTLggTbAwCMoIq65jkiHlaU%3D" alt="image.png" loading="lazy"/></p>
<p>æˆåŠŸè¾“å‡ºäº†æˆ‘ä»¬çš„<strong>su7-Ultra</strong>ï¼</p>
<h3 data-id="heading-3">ä¸‰ã€â€œé€ äººæœºå™¨â€ new å…³é”®å­—çš„éªšæ“ä½œ</h3>
<p>newæ˜¯å•¥ï¼Œå®ƒå¹²äº†å•¥å‘¢ï¼Ÿ<code>new</code>å…³é”®å­—å°±åƒä¸ª â€œé€ äººæœºå™¨â€ï¼Œå®ƒåˆ›å»ºå®ä¾‹çš„è¿‡ç¨‹å ªç§° â€œæ­¥éª¤å¤§å¸ˆâ€ï¼Œå’±ä»¬æ‹†è§£ä¸€ä¸‹ï¼š</p>
<ol>
<li><strong>åˆ›å»ºç©ºå¯¹è±¡</strong>ï¼šå…ˆé€ ä¸€ä¸ª â€œç©ºå£³å­â€ å¯¹è±¡ï¼Œæ¯”å¦‚<code>new Car()</code>æ—¶ï¼Œå…ˆå¼„ä¸€ä¸ª<code>{}</code>ã€‚</li>
<li><strong>ç»‘å®š this</strong>ï¼šæŠŠæ„é€ å‡½æ•°é‡Œçš„<code>this</code>æŒ‡å‘è¿™ä¸ªç©ºå¯¹è±¡ï¼Œç›¸å½“äºå‘Šè¯‰æ„é€ å‡½æ•°ï¼šâ€œæ¥ä¸‹æ¥ç»™è¿™ä¸ªç©ºå£³å­å¡ä¸œè¥¿å“ˆï¼â€</li>
<li><strong>æ‰§è¡Œæ„é€ å‡½æ•°ä»£ç </strong>ï¼šæ¯”å¦‚<code>Car</code>é‡Œçš„<code>this.color = color</code>ï¼Œå°±æ˜¯å¾€ç©ºå¯¹è±¡é‡ŒåŠ å±æ€§ã€‚</li>
<li><strong>è¿æ¥åŸå‹</strong>ï¼šæŠŠç©ºå¯¹è±¡çš„<code>__proto__</code>ç›´æ¥èµ‹å€¼ä¸ºæ„é€ å‡½æ•°çš„<code>prototype</code>ï¼Œè®©å®ä¾‹å’Œ â€œå…¬å…±ä»“åº“â€ æ‰“é€šã€‚</li>
<li><strong>è¿”å›å¯¹è±¡</strong>ï¼šæœ€åæŠŠè¿™ä¸ª â€œè£…ä¿®å¥½â€ çš„å¯¹è±¡è¿”å›å‡ºå»ã€‚</li>
</ol>
<p>ä¸Šä»£ç æ›´æ¸…æ™°ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">function Car(){ 
    // const <span class="hljs-attr">obj</span> = {}<span class="hljs-comment">;  // æ­¥éª¤1ï¼šåˆ›å»ºç©ºå¯¹è±¡</span>
    <span class="hljs-attr">this.name</span> = <span class="hljs-string">'su7'</span><span class="hljs-comment">;  // æ­¥éª¤2ï¼Œ3</span>
    // <span class="hljs-attr">obj.__proto__</span> = Car.prototype<span class="hljs-comment">; // æ­¥éª¤4ï¼šè¿æ¥åŸå‹</span>
    // return obj<span class="hljs-comment">; // æ­¥éª¤5ï¼šè¿”å›å¯¹è±¡</span>
}
const <span class="hljs-attr">car</span> = new Car()<span class="hljs-comment">;</span>
console.log(car.constructor)<span class="hljs-comment">; // èƒ½æ‰¾åˆ°æ„é€ å‡½æ•°Carï¼Œå› ä¸ºåŸå‹é“¾è¿èµ·æ¥äº†</span>
</code></pre>
<p>ç»“æœä¹Ÿåœ¨æˆ‘ä»¬æ„æ–™ä¹‹ä¸­ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d796c408ed5e478cb0ba95c9abf09b7a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212435&amp;x-signature=jGS1YrivPSakdJXxPDp8MGLaHUs%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™ä¹ˆä¸€æ‹†è§£ï¼Œæ˜¯ä¸æ˜¯è§‰å¾—<code>new</code>å…¶å®å°±æ˜¯ä¸ª â€œæµæ°´çº¿åŒ…å·¥å¤´â€ï¼ŒæŠŠåˆ›å»ºå¯¹è±¡çš„æ­¥éª¤å®‰æ’å¾—æ˜æ˜ç™½ç™½ï½</p>
<h3 data-id="heading-4">å››ã€åŸå‹é“¾ï¼šJavaScript çš„ â€œæ—è°±â€</h3>
<p>åŸå‹éƒ½æå®šäº†ï¼Œé‚£åŸå‹é“¾ä¹Ÿå°±æ˜¯é¡¾åæ€ä¹‰äº†ã€‚<strong>åŸå‹é“¾</strong>å°±æ˜¯æŠŠè¿™äº›<code>__proto__</code>å’Œ<code>prototype</code>ä¸²èµ·æ¥çš„ â€œæ—è°±â€ã€‚V8 æ‰¾å±æ€§æ—¶ï¼Œä¼šæ²¿ç€è¿™ä¸ª â€œæ—è°±â€ å¾€ä¸Šæ‰’ï¼Œç›´åˆ°æ‰’åˆ°<code>null</code>ï¼ˆæ—è°±çš„ â€œè€ç¥–å®—â€ï¼Œå†å¾€ä¸Šæ²¡äº†ï¼‰ä¸ºæ­¢ã€‚</p>
<p>çœ‹è¿™æ®µ â€œç¥–å­™ä¸‰ä»£â€ çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Grand</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">house</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å››åˆé™¢'</span>);
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Grand</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">card</span> = <span class="hljs-number">10000</span>;
}
<span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Grand</span>(); <span class="hljs-comment">// {card: 10000}.__proto__ = Grand.prototype.__proto__ = Object.prototype.__proto__ = null</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastName</span> = <span class="hljs-string">'harvest'</span>;
}
<span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Parent</span>(); <span class="hljs-comment">// {lastName = 'harvest'}.__proto__ = arent.prototype</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = <span class="hljs-number">18</span>;
}
<span class="hljs-keyword">const</span> c = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Child</span>(); <span class="hljs-comment">// {age: 18}.__proto__ = Child.prototype</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(c.<span class="hljs-property">card</span>);
c.<span class="hljs-title function_">house</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(c.<span class="hljs-title function_">toString</span>());
</code></pre>
<p>è§‰å¾—å¾ˆé•¿å¾ˆä¹±å§ï¼Œæ²¡å…³ç³»ä¸€èµ·æ¥ï¼Œçœ‹çœ‹ <strong>â€œå­™å­câ€</strong> æ€ä¹ˆå‡­ç€<strong>æ—è°±</strong> â€œè¹­â€ ç¥–ä¸Šçš„ä¸œè¥¿ï¼š</p>
<h4 data-id="heading-5">1.Â <code>console.log(c.card);</code>Â â€”â€” è¾“å‡ºï¼š10000</h4>
<p>å’±ä¸€æ­¥æ­¥çœ‹ â€œè®¤ç¥–å½’å®—â€ çš„è¿‡ç¨‹ï¼š</p>
<ul>
<li>å…ˆç¿» c è‡ªå·±çš„å£è¢‹ï¼šåªæœ‰<code>age:18</code>ï¼Œæ²¡<code>card</code>ï¼Œææ—è°±ï¼</li>
<li>é¡ºç€<code>c.__proto__</code>æ‰¾çˆ¸çˆ¸çš„ä»“åº“ï¼ˆ<code>Child.prototype</code>ï¼Œä¹Ÿå°±æ˜¯<code>new Parent()</code>çš„å®ä¾‹ï¼‰ï¼šçˆ¸çˆ¸çš„ä»“åº“é‡Œåªæœ‰<code>lastName: 'harvest'</code>ï¼Œè¿˜æ²¡<code>card</code>ï¼Œç»§ç»­å¾€ä¸Šæ‰¾ï¼</li>
<li>å†é¡ºç€çˆ¸çˆ¸ä»“åº“çš„<code>__proto__</code>ï¼ˆ<code>Parent.prototype.__proto__</code>ï¼‰æ‰¾çˆ·çˆ·çš„ä»“åº“ï¼ˆ<code>Grand.prototype</code>ï¼‰ï¼šçˆ·çˆ·çš„ä»“åº“é‡Œæœ‰<code>card:10000</code>ï¼ˆçˆ·çˆ·æ„é€ å‡½æ•°é‡Œçš„ä¸“å±å±æ€§ï¼‰ï¼Œæ‰¾åˆ°äº†ï¼</li>
<li>æ‰€ä»¥ç›´æ¥è¾“å‡ºçˆ·çˆ·ç»™çš„ â€œå¯åŠ¨èµ„é‡‘â€ 10000â€”â€” è¿™å°±æ˜¯ â€œæˆç²¾å®¶æ—â€ çš„ä¼ æ‰¿ï¼Œå­™å­èƒ½è¹­åˆ°çˆ·çˆ·çš„é“¶è¡Œå¡ğŸ’³ï¼</li>
</ul>
<h4 data-id="heading-6">2.Â <code>c.house();</code>Â â€”â€” è¾“å‡ºï¼šå››åˆé™¢</h4>
<p>åŒæ ·æŒ‰æ—è°±å¯»äº²ï¼š</p>
<ul>
<li>å…ˆç¿» c è‡ªå·±çš„å£è¢‹ï¼šæ²¡<code>house</code>æ–¹æ³•ï¼Œææ—è°±ï¼</li>
<li>æ‰¾çˆ¸çˆ¸çš„ä»“åº“ï¼šåªæœ‰<code>lastName</code>ï¼Œæ²¡æœ‰<code>house</code>ï¼Œç»§ç»­å¾€ä¸Šï¼</li>
<li>æ‰¾çˆ·çˆ·çš„ä»“åº“ï¼ˆ<code>Grand.prototype</code>ï¼‰ï¼šå˜¿ï¼Œçˆ·çˆ·çš„ç¥–ä¼ ä»“åº“é‡Œæ­£å¥½æœ‰<code>house</code>æ–¹æ³•ï¼Œç›´æ¥è°ƒç”¨ï¼</li>
<li>æ‰€ä»¥æ‰§è¡Œåè¾“å‡º <strong>â€œå››åˆé™¢â€</strong>â€”â€” ç›¸å½“äºå­™å­å‡­ç€æ—è°±ï¼Œç›´æ¥ç”¨äº†çˆ·çˆ·çš„ â€œç¥–ä¼ æˆ¿äº§â€ æŠ€èƒ½ï¼</li>
</ul>
<h4 data-id="heading-7">3.Â <code>console.log(c.toString());</code>Â â€”â€” è¾“å‡ºï¼š[object Object]</h4>
<p>è¿™æ³¢æ˜¯ â€œè¹­åˆ°äº†å®¶æ—çš„è€è€ç¥–å®—â€ï¼ˆ<code>Object</code>ï¼‰çš„å¥½å¤„ï¼š</p>
<ul>
<li>å…ˆç¿» c è‡ªå·±çš„å£è¢‹ï¼šæ²¡<code>toString</code>æ–¹æ³•ï¼Œææ—è°±ï¼</li>
<li>æ‰¾çˆ¸çˆ¸ä»“åº“ï¼šæ²¡æœ‰ï¼Œæ‰¾çˆ·çˆ·ä»“åº“ï¼šä¹Ÿæ²¡æœ‰ï¼ˆçˆ·çˆ·åªç»™äº†<code>card</code>å’Œ<code>house</code>ï¼‰ï¼Œç»§ç»­å¾€ä¸Šï¼</li>
<li>é¡ºç€çˆ·çˆ·ä»“åº“çš„<code>__proto__</code>ï¼ˆ<code>Grand.prototype.__proto__</code>ï¼‰æ‰¾ â€œè€è€ç¥–å®—â€<code>Object</code>çš„ä»“åº“ï¼ˆ<code>Object.prototype</code>ï¼‰ï¼šè¿™é‡Œè—ç€ JavaScript æ‰€æœ‰å¯¹è±¡éƒ½èƒ½å…±ç”¨çš„<code>toString</code>æ–¹æ³•ï¼</li>
<li>è°ƒç”¨åå°±è¾“å‡ºé»˜è®¤æ ¼å¼<code>[object Object]</code>â€”â€” ç›¸å½“äº â€œæˆç²¾å®¶æ—â€ çš„æ—è°±æœ€é¡¶ç«¯ï¼Œè¿˜è¿ç€æ‰€æœ‰å¯¹è±¡çš„ â€œå…¬å…±è€ç¥–å®—â€ï¼Œå¥½å¤„èƒ½è¹­åˆ°æœ€ä¸Šå¤´ï¼</li>
</ul>
<p>è¾“å‡ºç»“æœå’Œæˆ‘ä»¬åˆ†æçš„ä¸€æ¨¡ä¸€æ ·ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d76b73a7da54c9487d173561e8a0a9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212435&amp;x-signature=d0OCy0EbX%2BoDuRUviRsJU%2BBKYIY%3D" alt="image.png" loading="lazy"/></p>
<p>OKï¼Œä¸‹è¯¾ï¼</p>
<h2 data-id="heading-8">æ€»ç»“ï¼šâ€œæˆç²¾å®¶æ—â€ çš„ä¼ æ‰¿é€»è¾‘</h2>
<ul>
<li><code>prototype</code>æ˜¯æ¯ä¸ª â€œå®¶æ—é•¿è¾ˆâ€ï¼ˆå‡½æ•°ï¼‰çš„ â€œç¥–ä¼ ä»“åº“â€ï¼Œå…±äº«å±æ€§æ–¹æ³•å…¨åœ¨è¿™ï¼›</li>
<li><code>__proto__</code>æ˜¯æ¯ä¸ª â€œå®¶æ—æˆå‘˜â€ï¼ˆå¯¹è±¡ï¼‰çš„ â€œéšå½¢æ—è°±â€ï¼Œè´Ÿè´£è¿æ¥ä¸Šä¸€è¾ˆçš„ä»“åº“ï¼›</li>
<li><code>new</code>æ˜¯ â€œå®¶æ—é€ äººå¸ˆâ€ï¼Œä¸ä»…é€ æ–°æˆå‘˜ï¼Œè¿˜å¾—ç»™å®ƒä¸Š â€œå®¶æ—æˆ·å£â€ï¼ˆè¿æ—è°±ï¼‰ï¼›</li>
<li>åŸå‹é“¾æ˜¯ â€œå®Œæ•´æ—è°±â€ï¼Œå±æ€§æŸ¥æ‰¾å…¨é å®ƒ â€œä»£ä»£å¾€ä¸Šè¹­â€ï¼Œç›´åˆ°è¹­åˆ°<code>null</code>ä¸ºæ­¢ã€‚</li>
</ul>
<p>è¿™ <strong>â€œæˆç²¾å®¶æ—â€</strong> çš„ä¼ æ‰¿é€»è¾‘ï¼Œæœ¬è´¨å°±æ˜¯ JavaScript çš„ç»§æ‰¿æ ¸å¿ƒ â€”â€” ä¸ç”¨é‡å¤é€ è½®å­ï¼Œæ™šè¾ˆå‡­ç€æ—è°±å°±èƒ½å…±äº«ç¥–ä¸Šçš„ â€œèµ„æºâ€ï¼Œæ—¢çœç©ºé—´åˆé«˜æ•ˆã€‚æ¯ä¸ªå±æ€§å’Œæ–¹æ³•çš„æŸ¥æ‰¾ï¼Œéƒ½æ˜¯ä¸€åœºæœ‰è¶£çš„ â€œå®¶æ—å¯»äº²è®°â€ã€‚</p>
<blockquote>
<p>å¼€å¯ä¸€åœºâ€œå¯»äº²ä¹‹æ—…â€å§ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3+TSè®¾è®¡æ¨¡å¼å®æˆ˜ï¼š5ä¸ªåœºæ™¯è®©ä»£ç ä¼˜é›…ç¿»å€]]></title>    <link>https://juejin.cn/post/7574370234069745718</link>    <guid>https://juejin.cn/post/7574370234069745718</guid>    <pubDate>2025-11-20T03:00:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574370234069745718" data-draft-id="7574343024325378089" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3+TSè®¾è®¡æ¨¡å¼å®æˆ˜ï¼š5ä¸ªåœºæ™¯è®©ä»£ç ä¼˜é›…ç¿»å€"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2025-11-20T03:00:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å®‡ä½™"/> <meta itemprop="url" content="https://juejin.cn/user/2999123453424542"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3+TSè®¾è®¡æ¨¡å¼å®æˆ˜ï¼š5ä¸ªåœºæ™¯è®©ä»£ç ä¼˜é›…ç¿»å€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2999123453424542/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å®‡ä½™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:00:39.000Z" title="Thu Nov 20 2025 03:00:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    20
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨Vue3+TypeScriptå¼€å‘ä¸­ï¼Œå†™â€œèƒ½è·‘çš„ä»£ç â€å¾ˆå®¹æ˜“ï¼Œä½†å†™â€œä¼˜é›…ã€å¯ç»´æŠ¤ã€å¯æ‰©å±•â€çš„ä»£ç å´éœ€è¦æ€è€ƒã€‚è®¾è®¡æ¨¡å¼ä¸æ˜¯é“¶å¼¹ï¼Œä½†åˆç†è¿ç”¨èƒ½å¸®æˆ‘ä»¬è§£å†³é‡å¤å‡ºç°çš„é—®é¢˜ï¼Œè®©ä»£ç ç»“æ„æ›´æ¸…æ™°ã€é€»è¾‘æ›´å¥å£®ã€‚</p>
<p>æœ¬æ–‡ç»“åˆ5ä¸ªçœŸå®ä¸šåŠ¡åœºæ™¯ï¼Œè®²è§£<strong>å•ä¾‹æ¨¡å¼ã€å·¥å‚æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ã€ç»„åˆæ¨¡å¼</strong>åœ¨Vue3+TSä¸­çš„å®è·µï¼Œæ¯ä¸ªåœºæ™¯éƒ½é™„å®Œæ•´ä»£ç ç¤ºä¾‹å’Œä¼˜åŒ–æ€è·¯ã€‚</p>
<h2 data-id="heading-0">åœºæ™¯1ï¼šå…¨å±€çŠ¶æ€ç®¡ç† - å•ä¾‹æ¨¡å¼</h2>
<h3 data-id="heading-1">åœºæ™¯ç—›ç‚¹</h3>
<p>é¡¹ç›®ä¸­éœ€è¦å…¨å±€çŠ¶æ€ç®¡ç†ï¼ˆå¦‚ç”¨æˆ·ä¿¡æ¯ã€ä¸»é¢˜é…ç½®ï¼‰ï¼Œå¦‚æœå¤šæ¬¡åˆ›å»ºçŠ¶æ€å®ä¾‹ï¼Œä¼šå¯¼è‡´çŠ¶æ€ä¸ä¸€è‡´ï¼Œä¸”æµªè´¹èµ„æºã€‚</p>
<h3 data-id="heading-2">è®¾è®¡æ¨¡å¼åº”ç”¨ï¼šå•ä¾‹æ¨¡å¼</h3>
<p>å•ä¾‹æ¨¡å¼ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ã€‚Vue3çš„Piniaæœ¬è´¨å°±æ˜¯å•ä¾‹æ¨¡å¼çš„å®ç°ï¼Œä½†æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æ›´çµæ´»çš„å•ä¾‹é€»è¾‘ã€‚</p>
<h3 data-id="heading-3">ä»£ç å®ç°</h3>
<pre><code class="hljs language-typescript" lang="typescript">
<span class="hljs-comment">// stores/singletonUserStore.ts</span>
<span class="hljs-keyword">import</span> { reactive, toRefs } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// å®šä¹‰ç”¨æˆ·çŠ¶æ€æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserState</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">token</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">isLogin</span>: <span class="hljs-built_in">boolean</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserStore</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">UserStore</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">state</span>: <span class="hljs-title class_">UserState</span>

  <span class="hljs-comment">// ç§æœ‰æ„é€ å‡½æ•°ï¼Œé˜²æ­¢å¤–éƒ¨new</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = <span class="hljs-title function_">reactive</span>({
      <span class="hljs-attr">name</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">token</span>: <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'token'</span>) || <span class="hljs-string">''</span>,
      <span class="hljs-attr">isLogin</span>: !!<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'token'</span>)
    })
  }

  <span class="hljs-comment">// å…¨å±€è®¿é—®ç‚¹</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title function_">getInstance</span>(): <span class="hljs-title class_">UserStore</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">UserStore</span>.<span class="hljs-property">instance</span>) {
      <span class="hljs-title class_">UserStore</span>.<span class="hljs-property">instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserStore</span>()
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">UserStore</span>.<span class="hljs-property">instance</span>
  }

  <span class="hljs-comment">// ä¸šåŠ¡æ–¹æ³•</span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">token: <span class="hljs-built_in">string</span>, name: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">token</span> = token
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">name</span> = name
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">isLogin</span> = <span class="hljs-literal">true</span>
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'token'</span>, token)
  }

  <span class="hljs-keyword">public</span> <span class="hljs-title function_">logout</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">token</span> = <span class="hljs-string">''</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">name</span> = <span class="hljs-string">''</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">isLogin</span> = <span class="hljs-literal">false</span>
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">'token'</span>)
  }

  <span class="hljs-comment">// æš´éœ²å“åº”å¼çŠ¶æ€</span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">getState</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">toRefs</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>)
  }
}

<span class="hljs-comment">// å¯¼å‡ºå•ä¾‹å®ä¾‹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> userStore = <span class="hljs-title class_">UserStore</span>.<span class="hljs-title function_">getInstance</span>()
</code></pre>
<h3 data-id="heading-4">ä¼˜é›…ä¹‹å¤„</h3>
<ul>
<li>
<p>å…¨å±€å”¯ä¸€å®ä¾‹ï¼Œé¿å…çŠ¶æ€å†²çª</p>
</li>
<li>
<p>å°è£…æ€§å¼ºï¼ŒçŠ¶æ€ä¿®æ”¹åªèƒ½é€šè¿‡å®ä¾‹æ–¹æ³•ï¼Œé¿å…ç›´æ¥ç¯¡æ”¹</p>
</li>
<li>
<p>ç»“åˆTSæ¥å£ï¼Œç±»å‹æç¤ºå®Œæ•´ï¼Œå‡å°‘ç±»å‹é”™è¯¯</p>
</li>
</ul>
<h2 data-id="heading-5">åœºæ™¯2ï¼šåŠ¨æ€ç»„ä»¶æ¸²æŸ“ - å·¥å‚æ¨¡å¼</h2>
<h3 data-id="heading-6">åœºæ™¯ç—›ç‚¹</h3>
<p>è¡¨å•é¡µé¢éœ€è¦æ ¹æ®ä¸åŒå­—æ®µç±»å‹ï¼ˆè¾“å…¥æ¡†ã€ä¸‹æ‹‰æ¡†ã€æ—¥æœŸé€‰æ‹©å™¨ï¼‰æ¸²æŸ“ä¸åŒç»„ä»¶ï¼Œå¦‚æœç”¨if-elseåˆ¤æ–­ï¼Œä»£ç ä¼šè‡ƒè‚¿ä¸”éš¾ä»¥ç»´æŠ¤ã€‚</p>
<h3 data-id="heading-7">è®¾è®¡æ¨¡å¼åº”ç”¨ï¼šå·¥å‚æ¨¡å¼</h3>
<p>å·¥å‚æ¨¡å¼å®šä¹‰ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸ªç±»ã€‚åœ¨Vueä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºâ€œç»„ä»¶å·¥å‚â€ï¼Œæ ¹æ®ç±»å‹åŠ¨æ€è¿”å›å¯¹åº”ç»„ä»¶ã€‚</p>
<h3 data-id="heading-8">ä»£ç å®ç°</h3>
<pre><code class="hljs language-vue" lang="vue">
&lt;template&gt;
  &lt;div class="form-container"&gt;
    &lt;component 
      v-for="field in fields" 
      :key="field.id"
      :is="getFormComponent(field.type)"
      v-model="formData[field.key]"
      :label="field.label"
    /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { ref } from 'vue'
import InputComponent from './components/InputComponent.vue'
import SelectComponent from './components/SelectComponent.vue'
import DatePickerComponent from './components/DatePickerComponent.vue'

// å®šä¹‰å­—æ®µç±»å‹
type FieldType = 'input' | 'select' | 'date'

interface Field {
  id: string
  key: string
  label: string
  type: FieldType
  options?: { label: string; value: string }[]
}

// ç»„ä»¶å·¥å‚ï¼šæ ¹æ®ç±»å‹è¿”å›ç»„ä»¶
const getFormComponent = (type: FieldType) =&gt; {
  switch (type) {
    case 'input':
      return InputComponent
    case 'select':
      return SelectComponent
    case 'date':
      return DatePickerComponent
    default:
      throw new Error(`ä¸æ”¯æŒçš„å­—æ®µç±»å‹ï¼š${type}`)
  }
}

// è¡¨å•æ•°æ®å’Œå­—æ®µé…ç½®
const formData = ref({
  username: '',
  gender: '',
  birthday: ''
})

const fields: Field[] = [
  { id: '1', key: 'username', label: 'ç”¨æˆ·å', type: 'input' },
  { 
    id: '2', 
    key: 'gender', 
    label: 'æ€§åˆ«', 
    type: 'select',
    options: [{ label: 'ç”·', value: 'male' }, { label: 'å¥³', value: 'female' }]
  },
  { id: '3', key: 'birthday', label: 'ç”Ÿæ—¥', type: 'date' }
]
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-9">ä¼˜é›…ä¹‹å¤„</h3>
<ul>
<li>
<p>æ¶ˆé™¤å¤§é‡if-elseï¼Œä»£ç ç»“æ„æ¸…æ™°</p>
</li>
<li>
<p>æ–°å¢ç»„ä»¶ç±»å‹åªéœ€ä¿®æ”¹å·¥å‚å‡½æ•°ï¼Œç¬¦åˆå¼€é—­åŸåˆ™</p>
</li>
<li>
<p>å­—æ®µé…ç½®ä¸ç»„ä»¶æ¸²æŸ“åˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤</p>
</li>
</ul>
<h2 data-id="heading-10">åœºæ™¯3ï¼šè·¨ç»„ä»¶é€šä¿¡ - è§‚å¯Ÿè€…æ¨¡å¼</h2>
<h3 data-id="heading-11">åœºæ™¯ç—›ç‚¹</h3>
<p>éçˆ¶å­ç»„ä»¶ï¼ˆå¦‚Headerå’ŒFooterï¼‰éœ€è¦é€šä¿¡ï¼ˆå¦‚ä¸»é¢˜åˆ‡æ¢ï¼‰ï¼Œç”¨Props/Emitså¤ªç¹çï¼Œç”¨Piniaåˆæ²¡å¿…è¦ï¼ˆä»…å•ä¸€äº‹ä»¶é€šä¿¡ï¼‰ã€‚</p>
<h3 data-id="heading-12">è®¾è®¡æ¨¡å¼åº”ç”¨ï¼šè§‚å¯Ÿè€…æ¨¡å¼</h3>
<p>è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰å¯¹è±¡é—´çš„ä¸€å¯¹å¤šä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€æ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–å®ƒçš„å¯¹è±¡éƒ½ä¼šæ”¶åˆ°é€šçŸ¥ã€‚æˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªç®€å•çš„äº‹ä»¶æ€»çº¿ã€‚</p>
<h3 data-id="heading-13">ä»£ç å®ç°</h3>
<pre><code class="hljs language-typescript" lang="typescript">
<span class="hljs-comment">// utils/eventBus.ts</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">EventBus</span> {
  <span class="hljs-comment">// å­˜å‚¨äº‹ä»¶è®¢é˜…è€…</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">events</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, (<span class="hljs-function">(<span class="hljs-params">...args: <span class="hljs-built_in">any</span>[]</span>) =&gt;</span> <span class="hljs-built_in">void</span>)[]&gt; = {}

  <span class="hljs-comment">// è®¢é˜…äº‹ä»¶</span>
  <span class="hljs-title function_">on</span>(<span class="hljs-params">eventName: <span class="hljs-built_in">string</span>, callback: (...args: <span class="hljs-built_in">any</span>[]) =&gt; <span class="hljs-built_in">void</span></span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[eventName]) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[eventName] = []
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[eventName].<span class="hljs-title function_">push</span>(callback)
  }

  <span class="hljs-comment">// å‘å¸ƒäº‹ä»¶</span>
  <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName: <span class="hljs-built_in">string</span>, ...args: <span class="hljs-built_in">any</span>[]</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[eventName]) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[eventName].<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">callback</span> =&gt;</span> <span class="hljs-title function_">callback</span>(...args))
    }
  }

  <span class="hljs-comment">// å–æ¶ˆè®¢é˜…</span>
  <span class="hljs-title function_">off</span>(<span class="hljs-params">eventName: <span class="hljs-built_in">string</span>, callback?: (...args: <span class="hljs-built_in">any</span>[]) =&gt; <span class="hljs-built_in">void</span></span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[eventName]) <span class="hljs-keyword">return</span>

    <span class="hljs-keyword">if</span> (callback) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[eventName] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[eventName].<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">cb</span> =&gt;</span> cb !== callback)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[eventName]
    }
  }
}

<span class="hljs-comment">// å¯¼å‡ºå•ä¾‹äº‹ä»¶æ€»çº¿</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> eventBus = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventBus</span>()
</code></pre>
<p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">
&lt;!-- Header.vue --&gt;
&lt;script setup lang="ts"&gt;
import { eventBus } from '@/utils/eventBus'

const toggleTheme = () =&gt; {
  // å‘å¸ƒä¸»é¢˜åˆ‡æ¢äº‹ä»¶
  eventBus.emit('theme-change', 'dark')
}
&lt;/script&gt;

&lt;!-- Footer.vue --&gt;
&lt;script setup lang="ts"&gt;
import { ref, onMounted, onUnmounted } from 'vue'
import { eventBus } from '@/utils/eventBus'

const theme = ref('light')

const handleThemeChange = (newTheme: string) =&gt; {
  theme.value = newTheme
}

onMounted(() =&gt; {
  // è®¢é˜…ä¸»é¢˜åˆ‡æ¢äº‹ä»¶
  eventBus.on('theme-change', handleThemeChange)
})

onUnmounted(() =&gt; {
  // å–æ¶ˆè®¢é˜…ï¼Œé¿å…å†…å­˜æ³„æ¼
  eventBus.off('theme-change', handleThemeChange)
})
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-14">ä¼˜é›…ä¹‹å¤„</h3>
<ul>
<li>
<p>è§£è€¦ç»„ä»¶ï¼Œæ— éœ€å…³æ³¨ç»„ä»¶å±‚çº§å…³ç³»</p>
</li>
<li>
<p>è½»é‡çº§é€šä¿¡ï¼Œæ¯”Piniaæ›´é€‚åˆç®€å•åœºæ™¯</p>
</li>
<li>
<p>æ”¯æŒè®¢é˜…/å–æ¶ˆè®¢é˜…ï¼Œé¿å…å†…å­˜æ³„æ¼</p>
</li>
</ul>
<h2 data-id="heading-15">åœºæ™¯4ï¼šè¡¨å•éªŒè¯ - ç­–ç•¥æ¨¡å¼</h2>
<h3 data-id="heading-16">åœºæ™¯ç—›ç‚¹</h3>
<p>è¡¨å•éœ€è¦å¤šç§éªŒè¯è§„åˆ™ï¼ˆå¿…å¡«ã€é‚®ç®±æ ¼å¼ã€å¯†ç å¼ºåº¦ï¼‰ï¼Œå¦‚æœæŠŠéªŒè¯é€»è¾‘å†™åœ¨ä¸€èµ·ï¼Œä»£ç ä¼šæ··ä¹±ä¸”éš¾ä»¥å¤ç”¨ã€‚</p>
<h3 data-id="heading-17">è®¾è®¡æ¨¡å¼åº”ç”¨ï¼šç­–ç•¥æ¨¡å¼</h3>
<p>ç­–ç•¥æ¨¡å¼å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼ŒæŠŠå®ƒä»¬å°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯ç›¸äº’æ›¿æ¢ã€‚æˆ‘ä»¬å¯ä»¥å°†ä¸åŒéªŒè¯è§„åˆ™å°è£…ä¸ºâ€œç­–ç•¥â€ï¼ŒåŠ¨æ€é€‰æ‹©ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-18">ä»£ç å®ç°</h3>
<pre><code class="hljs language-typescript" lang="typescript">
<span class="hljs-comment">// utils/validator.ts</span>
<span class="hljs-comment">// å®šä¹‰éªŒè¯è§„åˆ™æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ValidationRule</span> {
  <span class="hljs-attr">validate</span>: <span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">boolean</span>
  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>
}

<span class="hljs-comment">// éªŒè¯ç­–ç•¥é›†åˆ</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">validationStrategies</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">ValidationRule</span>&gt; = {
  <span class="hljs-comment">// å¿…å¡«éªŒè¯</span>
  <span class="hljs-attr">required</span>: {
    <span class="hljs-attr">validate</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> value.<span class="hljs-title function_">trim</span>() !== <span class="hljs-string">''</span>,
    <span class="hljs-attr">message</span>: <span class="hljs-string">'æ­¤å­—æ®µä¸èƒ½ä¸ºç©º'</span>
  },
  <span class="hljs-comment">// é‚®ç®±éªŒè¯</span>
  <span class="hljs-attr">email</span>: {
    <span class="hljs-attr">validate</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>.<span class="hljs-title function_">test</span>(value),
    <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·è¾“å…¥æ­£ç¡®çš„é‚®ç®±æ ¼å¼'</span>
  },
  <span class="hljs-comment">// å¯†ç å¼ºåº¦éªŒè¯ï¼ˆè‡³å°‘8ä½ï¼Œå«å­—æ¯å’Œæ•°å­—ï¼‰</span>
  <span class="hljs-attr">password</span>: {
    <span class="hljs-attr">validate</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-regexp">/^(?=.*[a-zA-Z])(?=.*\d).{8,}$/</span>.<span class="hljs-title function_">test</span>(value),
    <span class="hljs-attr">message</span>: <span class="hljs-string">'å¯†ç è‡³å°‘8ä½ï¼ŒåŒ…å«å­—æ¯å’Œæ•°å­—'</span>
  }
}

<span class="hljs-comment">// éªŒè¯å™¨ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Validator</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">rules</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>[]&gt; = {} <span class="hljs-comment">// { field: [rule1, rule2] }</span>

  <span class="hljs-comment">// æ·»åŠ éªŒè¯è§„åˆ™</span>
  <span class="hljs-title function_">addField</span>(<span class="hljs-params">field: <span class="hljs-built_in">string</span>, rules: <span class="hljs-built_in">string</span>[]</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">rules</span>[field] = rules
  }

  <span class="hljs-comment">// æ‰§è¡ŒéªŒè¯</span>
  <span class="hljs-title function_">validate</span>(<span class="hljs-attr">formData</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;): <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">errors</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = {}

    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">rules</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[field, rules]</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> value = formData[field]
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> rule <span class="hljs-keyword">of</span> rules) {
        <span class="hljs-keyword">const</span> strategy = validationStrategies[rule]
        <span class="hljs-keyword">if</span> (!strategy.<span class="hljs-title function_">validate</span>(value)) {
          errors[field] = strategy.<span class="hljs-property">message</span>
          <span class="hljs-keyword">break</span> <span class="hljs-comment">// åªè¦æœ‰ä¸€ä¸ªè§„åˆ™ä¸é€šè¿‡ï¼Œå°±åœæ­¢è¯¥å­—æ®µéªŒè¯</span>
        }
      }
    })

    <span class="hljs-keyword">return</span> errors
  }
}

<span class="hljs-keyword">export</span> { <span class="hljs-title class_">Validator</span> }
</code></pre>
<p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">
&lt;script setup lang="ts"&gt;
import { ref } from 'vue'
import { Validator } from '@/utils/validator'

const formData = ref({
  email: '',
  password: ''
})

const errors = ref&lt;Record&lt;string, string&gt;&gt;({})

const handleSubmit = () =&gt; {
  // åˆ›å»ºéªŒè¯å™¨å®ä¾‹
  const validator = new Validator()
  // æ·»åŠ éªŒè¯è§„åˆ™
  validator.addField('email', ['required', 'email'])
  validator.addField('password', ['required', 'password'])
  // æ‰§è¡ŒéªŒè¯
  const validateErrors = validator.validate(formData.value)
  
  if (Object.keys(validateErrors).length === 0) {
    // éªŒè¯é€šè¿‡ï¼Œæäº¤è¡¨å•
    console.log('æäº¤æˆåŠŸ', formData.value)
  } else {
    errors.value = validateErrors
  }
}
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-19">ä¼˜é›…ä¹‹å¤„</h3>
<ul>
<li>
<p>éªŒè¯è§„åˆ™ä¸ä¸šåŠ¡é€»è¾‘åˆ†ç¦»ï¼Œå¯å¤ç”¨æ€§å¼º</p>
</li>
<li>
<p>æ–°å¢è§„åˆ™åªéœ€æ‰©å±•ç­–ç•¥é›†åˆï¼Œç¬¦åˆå¼€é—­åŸåˆ™</p>
</li>
<li>
<p>éªŒè¯é€»è¾‘æ¸…æ™°ï¼Œä¾¿äºç»´æŠ¤å’Œæµ‹è¯•</p>
</li>
</ul>
<h2 data-id="heading-20">åœºæ™¯5ï¼šæ ‘å½¢ç»“æ„ç»„ä»¶ - ç»„åˆæ¨¡å¼</h2>
<h3 data-id="heading-21">åœºæ™¯ç—›ç‚¹</h3>
<p>å¼€å‘æƒé™èœå•ã€æ–‡ä»¶ç›®å½•ç­‰æ ‘å½¢ç»„ä»¶æ—¶ï¼Œéœ€è¦å¤„ç†å•ä¸ªèŠ‚ç‚¹å’Œå­èŠ‚ç‚¹çš„ç»Ÿä¸€æ“ä½œï¼ˆå¦‚å±•å¼€/æŠ˜å ã€å‹¾é€‰ï¼‰ï¼Œé€’å½’é€»è¾‘å¤æ‚ã€‚</p>
<h3 data-id="heading-22">è®¾è®¡æ¨¡å¼åº”ç”¨ï¼šç»„åˆæ¨¡å¼</h3>
<p>ç»„åˆæ¨¡å¼å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚</p>
<h3 data-id="heading-23">ä»£ç å®ç°</h3>
<pre><code class="hljs language-typescript" lang="typescript">
<span class="hljs-comment">// utils/treeNode.ts</span>
<span class="hljs-comment">// å®šä¹‰èŠ‚ç‚¹æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">TreeNodeProps</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">label</span>: <span class="hljs-built_in">string</span>
  children?: <span class="hljs-title class_">TreeNodeProps</span>[]
  expanded?: <span class="hljs-built_in">boolean</span>
  checked?: <span class="hljs-built_in">boolean</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">TreeNode</span> {
  <span class="hljs-keyword">public</span> <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-keyword">public</span> <span class="hljs-attr">label</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-keyword">public</span> <span class="hljs-attr">children</span>: <span class="hljs-title class_">TreeNode</span>[] = []
  <span class="hljs-keyword">public</span> <span class="hljs-attr">expanded</span>: <span class="hljs-built_in">boolean</span>
  <span class="hljs-keyword">public</span> <span class="hljs-attr">checked</span>: <span class="hljs-built_in">boolean</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props: TreeNodeProps</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = props.<span class="hljs-property">id</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">label</span> = props.<span class="hljs-property">label</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">expanded</span> = props.<span class="hljs-property">expanded</span> ?? <span class="hljs-literal">false</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">checked</span> = props.<span class="hljs-property">checked</span> ?? <span class="hljs-literal">false</span>
    <span class="hljs-comment">// é€’å½’åˆ›å»ºå­èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (props.<span class="hljs-property">children</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span> = props.<span class="hljs-property">children</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>(child))
    }
  }

  <span class="hljs-comment">// å±•å¼€/æŠ˜å èŠ‚ç‚¹</span>
  <span class="hljs-title function_">toggleExpand</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">expanded</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">expanded</span>
  }

  <span class="hljs-comment">// å‹¾é€‰èŠ‚ç‚¹ï¼ˆå¹¶è”åŠ¨å­èŠ‚ç‚¹ï¼‰</span>
  <span class="hljs-title function_">toggleCheck</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">checked</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">checked</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> {
      child.<span class="hljs-title function_">setChecked</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">checked</span>)
    })
  }

  <span class="hljs-comment">// è®¾ç½®èŠ‚ç‚¹å‹¾é€‰çŠ¶æ€</span>
  <span class="hljs-title function_">setChecked</span>(<span class="hljs-params">checked: <span class="hljs-built_in">boolean</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">checked</span> = checked
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> {
      child.<span class="hljs-title function_">setChecked</span>(checked)
    })
  }

  <span class="hljs-comment">// è·å–æ‰€æœ‰å‹¾é€‰çš„èŠ‚ç‚¹ID</span>
  <span class="hljs-title function_">getCheckedIds</span>(): <span class="hljs-built_in">string</span>[] {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">checkedIds</span>: <span class="hljs-built_in">string</span>[] = []
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">checked</span>) {
      checkedIds.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>)
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> {
      checkedIds.<span class="hljs-title function_">push</span>(...child.<span class="hljs-title function_">getCheckedIds</span>())
    })
    <span class="hljs-keyword">return</span> checkedIds
  }
}

<span class="hljs-keyword">export</span> { <span class="hljs-title class_">TreeNode</span> }
</code></pre>
<p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">
&lt;template&gt;
  &lt;ul class="tree-list"&gt;
    &lt;tree-node-item :node="treeRoot" /&gt;
  &lt;/ul&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { TreeNode } from '@/utils/treeNode'
import TreeNodeItem from './TreeNodeItem.vue'

// åˆå§‹åŒ–æ ‘å½¢æ•°æ®
const treeData = {
  id: 'root',
  label: 'æƒé™èœå•',
  children: [
    {
      id: '1',
      label: 'ç”¨æˆ·ç®¡ç†',
      children: [
        { id: '1-1', label: 'æŸ¥çœ‹ç”¨æˆ·' },
        { id: '1-2', label: 'ç¼–è¾‘ç”¨æˆ·' }
      ]
    },
    { id: '2', label: 'è§’è‰²ç®¡ç†' }
  ]
}

const treeRoot = new TreeNode(treeData)
&lt;/script&gt;

&lt;!-- TreeNodeItem.vue é€’å½’ç»„ä»¶ --&gt;
&lt;template&gt;
  &lt;li class="tree-node"&gt;
    &lt;div @click="node.toggleExpand()" class="node-label"&gt;
      &lt;span v-if="node.children.length"&gt;{{ node.expanded ? 'â–¼' : 'â–º' }}&lt;/span&gt;
      &lt;input type="checkbox" :checked="node.checked" @change="node.toggleCheck()"&gt;
      {{ node.label }}
    &lt;/div&gt;
    &lt;ul v-if="node.expanded &amp;&amp; node.children.length" class="tree-children"&gt;
      &lt;tree-node-item v-for="child in node.children" :key="child.id" :node="child" /&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { defineProps } from 'vue'
import { TreeNode } from '@/utils/treeNode'

defineProps&lt;{
  node: TreeNode
}&gt;()
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-24">ä¼˜é›…ä¹‹å¤„</h3>
<ul>
<li>
<p>ç»Ÿä¸€å¤„ç†å•ä¸ªèŠ‚ç‚¹å’Œå­èŠ‚ç‚¹ï¼Œæ— éœ€åŒºåˆ†â€œéƒ¨åˆ†â€å’Œâ€œæ•´ä½“â€</p>
</li>
<li>
<p>é€’å½’é€»è¾‘å°è£…åœ¨TreeNodeç±»ä¸­ï¼Œç»„ä»¶åªè´Ÿè´£æ¸²æŸ“</p>
</li>
<li>
<p>æ ‘å½¢æ“ä½œï¼ˆå‹¾é€‰ã€å±•å¼€ï¼‰èŒè´£å•ä¸€ï¼Œä¾¿äºæ‰©å±•</p>
</li>
</ul>
<h2 data-id="heading-25">æ€»ç»“</h2>
<p>è®¾è®¡æ¨¡å¼ä¸æ˜¯â€œç‚«æŠ€â€ï¼Œè€Œæ˜¯è§£å†³é—®é¢˜çš„â€œæ–¹æ³•è®ºâ€ã€‚åœ¨Vue3+TSå¼€å‘ä¸­ï¼š</p>
<ul>
<li>
<p><strong>å•ä¾‹æ¨¡å¼</strong>é€‚åˆå…¨å±€çŠ¶æ€ã€å·¥å…·ç±»ç­‰å”¯ä¸€å®ä¾‹åœºæ™¯</p>
</li>
<li>
<p><strong>å·¥å‚æ¨¡å¼</strong>é€‚åˆåŠ¨æ€åˆ›å»ºç»„ä»¶ã€æœåŠ¡ç­‰åœºæ™¯</p>
</li>
<li>
<p><strong>è§‚å¯Ÿè€…æ¨¡å¼</strong>é€‚åˆè·¨ç»„ä»¶é€šä¿¡ã€äº‹ä»¶ç›‘å¬åœºæ™¯</p>
</li>
<li>
<p><strong>ç­–ç•¥æ¨¡å¼</strong>é€‚åˆè¡¨å•éªŒè¯ã€ç®—æ³•åˆ‡æ¢ç­‰åœºæ™¯</p>
</li>
<li>
<p><strong>ç»„åˆæ¨¡å¼</strong>é€‚åˆæ ‘å½¢ç»“æ„ã€å±‚çº§æ•°æ®åœºæ™¯</p>
</li>
</ul>
<p>åˆç†è¿ç”¨è¿™äº›æ¨¡å¼ï¼Œèƒ½è®©ä½ çš„ä»£ç æ›´ä¼˜é›…ã€æ›´å¯ç»´æŠ¤ã€‚å½“ç„¶ï¼Œè®¾è®¡æ¨¡å¼ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ï¼Œè¦æ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆï¼Œé¿å…è¿‡åº¦è®¾è®¡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaçº¿ç¨‹æ± è¯¦è§£]]></title>    <link>https://juejin.cn/post/7574318108720824366</link>    <guid>https://juejin.cn/post/7574318108720824366</guid>    <pubDate>2025-11-20T03:05:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574318108720824366" data-draft-id="7574318108720807982" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaçº¿ç¨‹æ± è¯¦è§£"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2025-11-20T03:05:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JavaArchJourney"/> <meta itemprop="url" content="https://juejin.cn/user/3414433650974346"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaçº¿ç¨‹æ± è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3414433650974346/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JavaArchJourney
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:05:31.000Z" title="Thu Nov 20 2025 03:05:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>é˜…è¯»æœ¬æ–‡å‰ï¼Œå»ºè®®å…ˆé˜…è¯»<a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">ã€ŠJava çº¿ç¨‹ä¸åŸç†ã€‹</a>äº†è§£ Java çº¿ç¨‹çš„åŸºæœ¬ä½¿ç”¨ï¼ˆ<code>Thread</code>ã€<code>Runnable</code>ã€<code>Callable</code> å’Œ <code>FutureTask</code>çš„å…³ç³»ï¼‰</p>
<h2 data-id="heading-0">Executor æ¡†æ¶</h2>
<p>Executor æ¡†æ¶æ˜¯ Java 5 å¼•å…¥çš„å¹¶å‘å·¥å…·ï¼Œä½äº <code>java.util.concurrent</code> åŒ…ä¸­ï¼Œå…¶æ ¸å¿ƒç›®æ ‡æ˜¯å°†çº¿ç¨‹ä»»åŠ¡çš„æäº¤ä¸ä»»åŠ¡çš„æ‰§è¡Œè§£è€¦ï¼Œæ˜¯ Java çº¿ç¨‹æ± çš„æ ¸å¿ƒå®ç°æ¡†æ¶ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13e48c7f7ed34fd6bbb2ef2e9479d933~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUFyY2hKb3VybmV5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212731&amp;x-signature=7FRvn0D9VBOrg5z5fM87Tk8pKRg%3D" alt="" loading="lazy"/></p>
<p><strong>Executor æ¡†æ¶çš„æ ¸å¿ƒæ¥å£ï¼š</strong></p>
<ul>
<li><strong>Executor</strong>ï¼šæœ€é¡¶å±‚çš„æ¥å£ï¼Œå®šä¹‰äº† <code>execute(Runnable command)</code> æ–¹æ³•ã€‚</li>
</ul>

<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">Executor</span> {
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">execute</span>(<span class="hljs-params">Runnable command</span>)</span>;
}
</code></pre>
<ul>
<li><strong>ExecutorService</strong>ï¼šæ‰©å±•äº† <code>Executor</code>ï¼Œå¢åŠ äº†ç®¡ç†çº¿ç¨‹æ± ç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•ï¼ˆå¦‚ <code>shutdown()</code>ã€<code>submit()</code>ã€<code>invokeAll()</code> ç­‰ï¼‰ã€‚</li>
</ul>

<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ExecutorService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Executor</span> {
    &lt;T&gt; Future&lt;T&gt; <span class="hljs-title function_">submit</span><span class="hljs-params">(Callable&lt;T&gt; task)</span>;
    List&lt;Runnable&gt; <span class="hljs-title function_">shutdownNow</span><span class="hljs-params">()</span>;
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">awaitTermination</span><span class="hljs-params">(<span class="hljs-type">long</span> timeout, TimeUnit unit)</span>;
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<ul>
<li><strong>ScheduledExecutorService</strong>ï¼šæ”¯æŒå»¶è¿Ÿæˆ–å‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡ã€‚</li>
</ul>

<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">public</span> interface ScheduledExecutorService extends ExecutorService {
    <span class="hljs-function">ScheduledFuture&lt;?&gt; <span class="hljs-title">schedule</span><span class="hljs-params">(Runnable command, <span class="hljs-type">long</span> delay, TimeUnit unit)</span></span>;
    <span class="hljs-function">ScheduledFuture&lt;?&gt; <span class="hljs-title">scheduleAtFixedRate</span><span class="hljs-params">(Runnable command, <span class="hljs-type">long</span> initialDelay, <span class="hljs-type">long</span> period, TimeUnit unit)</span></span>;
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<ul>
<li><strong>ThreadPoolExecutor</strong>ï¼šExecutorService çš„æ ¸å¿ƒå®ç°ç±»ï¼Œæä¾›äº†ä¸°å¯Œçš„çº¿ç¨‹æ± é…ç½®é€‰é¡¹ã€‚</li>
</ul>
<p><strong>æ¥å£ä¸ç±»å…³ç³»ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a29069ca9f349e4a2762fe1c6bfa08c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUFyY2hKb3VybmV5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212731&amp;x-signature=xrPvv1C4WUmOVCzdWxczl%2B7l%2FZo%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb7fe6bf340b4739b21434dc91d709ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUFyY2hKb3VybmV5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212731&amp;x-signature=823KkGuwxaZTR2GgAL1FmM5nnXk%3D" alt="" loading="lazy"/></p>
<p><strong>Executor æ¡†æ¶çš„ä½¿ç”¨ç¤ºæ„å›¾ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/26e3146cf0344876afd91bf865ad30cb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUFyY2hKb3VybmV5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212731&amp;x-signature=S52jlzHVb4nDRE2yZz0btiXu5Fg%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">ThreadPoolExecutor</h2>
<p><strong>æ„é€ å‡½æ•°ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">ThreadPoolExecutor</span><span class="hljs-params">(
    <span class="hljs-type">int</span> corePoolSize,
    <span class="hljs-type">int</span> maximumPoolSize,
    <span class="hljs-type">long</span> keepAliveTime,
    TimeUnit unit,
    BlockingQueue&lt;Runnable&gt; workQueue,
    ThreadFactory threadFactory,
    RejectedExecutionHandler handler
)</span>
</code></pre>
<p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p>





































<table><thead><tr><th><strong>å‚æ•°</strong></th><th><strong>è¯´æ˜</strong></th></tr></thead><tbody><tr><td><code>corePoolSize</code></td><td>æ ¸å¿ƒçº¿ç¨‹æ•°ã€‚å³ä½¿ç©ºé—²ï¼Œè¿™äº›çº¿ç¨‹ä¹Ÿä¸ä¼šè¢«å›æ”¶ï¼ˆé™¤éè®¾ç½® <code>allowCoreThreadTimeOut(true)</code>ï¼‰ã€‚å½“ä½äºè¿™ä¸ªæ•°å€¼ï¼Œæ€»æ˜¯æ–°å»ºçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼›è¶…è¿‡è¿™ä¸ªæ•°å€¼åï¼Œä¼šæŠŠä»»åŠ¡æ”¾åˆ° <code>workQueue</code>æ’é˜Ÿï¼Œå½“é˜Ÿåˆ—æ»¡æ—¶ï¼Œæ‰åœ¨ <code>maximumPoolSize</code> èŒƒå›´å†…æ–°å»ºçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ã€‚</td></tr><tr><td><code>maximumPoolSize</code></td><td>æœ€å¤§çº¿ç¨‹æ•°ã€‚å½“æ´»åŠ¨çº¿ç¨‹æ•°è¾¾åˆ°è¿™ä¸ªæ•°å€¼åï¼Œå°†ä¼šè¢«æ‹’ç»æ‰ï¼ˆè§åé¢çš„ <code>RejectedExecutionHandler</code> ï¼‰ã€‚</td></tr><tr><td><code>keepAliveTime</code></td><td>éæ ¸å¿ƒçº¿ç¨‹é—²ç½®æ—¶çš„è¶…æ—¶æ—¶é•¿ã€‚è¶…è¿‡è¿™ä¸ªæ—¶é•¿ï¼Œé—²ç½®çš„éæ ¸å¿ƒçº¿ç¨‹å°±ä¼šè¢«å›æ”¶ã€‚</td></tr><tr><td><code>unit</code></td><td><code>keepAliveTime</code> å‚æ•°çš„æ—¶é—´å•ä½ï¼Œæœ‰ <code>TimeUnit.MILLISECOND</code> ã€<code>TimeUnit.SECOND</code> ã€<code>TimeUnit.MINUTE</code> ç­‰</td></tr><tr><td><code>workQueue</code></td><td>ä»»åŠ¡é˜Ÿåˆ—ï¼Œç”¨äºç¼“å­˜å¾…æ‰§è¡Œçš„ä»»åŠ¡ã€‚å¸¸ç”¨å®ç°ï¼š1ã€<code>ArrayBlockingQueue</code>ï¼šåŸºäºæ•°ç»„ç»“æ„çš„çš„å…ˆè¿›å…ˆå‡ºæœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œæ­¤é˜Ÿåˆ—åˆ›å»ºæ—¶å¿…é¡»æŒ‡å®šå¤§å°ã€‚2ã€<code>LinkedBlockingQueue</code>ï¼šåŸºäºé“¾è¡¨ç»“æ„çš„å…ˆè¿›å…ˆå‡ºæ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œå¦‚æœåˆ›å»ºæ—¶æ²¡æœ‰æŒ‡å®šæ­¤é˜Ÿåˆ—å¤§å°ï¼Œåˆ™é»˜è®¤ä¸º <code>Integer.MAX_VALUE</code> ã€‚3ã€<code>SynchronousQueue</code>ï¼šä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ï¼Œæ¯ä¸ªæ’å…¥æ“ä½œå¿…é¡»ç­‰åˆ°å¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ç§»é™¤æ“ä½œï¼Œå¦åˆ™æ’å…¥æ“ä½œä¸€ç›´å¤„äºé˜»å¡çŠ¶æ€ã€‚ç›¸å½“äºé˜Ÿåˆ—å®¹é‡å¤§å°ä¸º 1 ã€‚4ã€<code>PriorityBlockingQueue</code>ï¼šä¸€ä¸ªå…·æœ‰ä¼˜å…ˆçº§çš„æ— é™é˜»å¡é˜Ÿåˆ—ï¼Œå¯ç”¨äºè®¾ç½®ä»»åŠ¡å¤„ç†çš„ä¼˜å…ˆçº§ã€‚</td></tr><tr><td><code>threadFactory</code></td><td>çº¿ç¨‹å·¥å‚ï¼Œç”¨äºè‡ªå®šä¹‰çº¿ç¨‹åˆ›å»ºï¼ˆå¦‚å‘½åã€ä¼˜å…ˆçº§ç­‰ï¼‰ã€‚</td></tr><tr><td><code>handler</code></td><td>æ‹’ç»ç­–ç•¥ï¼Œå½“çº¿ç¨‹æ± å’Œé˜Ÿåˆ—éƒ½æ»¡æ—¶å¦‚ä½•å¤„ç†æ–°ä»»åŠ¡ã€‚å¸¸ç”¨å®ç°ï¼š1ã€<code>AbortPolicy</code>ï¼ˆé»˜è®¤ï¼‰ï¼šä¸¢å¼ƒä»»åŠ¡ï¼Œå¹¶æŠ›å‡º <code>RejectedExecutionException</code> å¼‚å¸¸ã€‚2ã€<code>DiscardPolicy</code>ï¼šä¹Ÿæ˜¯ä¸¢å¼ƒä»»åŠ¡ï¼Œä½†æ˜¯ä¸æŠ›å‡ºå¼‚å¸¸ã€‚3ã€<code>DiscardOldestPolicy</code>ï¼šä¸¢å¼ƒé˜Ÿåˆ—æœ€å‰é¢çš„ä»»åŠ¡ï¼Œç„¶åé‡æ–°å°è¯•æ‰§è¡Œä»»åŠ¡ï¼ˆé‡å¤æ­¤è¿‡ç¨‹ï¼‰4ã€<code>CallerRunsPolicy</code>ï¼šç”±è°ƒç”¨çº¿ç¨‹å¤„ç†è¯¥ä»»åŠ¡</td></tr></tbody></table>
<p><strong>ThreadPoolExecutor çº¿ç¨‹æ± å¤„ç†æµç¨‹ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46fd9f09515c41ea9a94cb7cd753bfe7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUFyY2hKb3VybmV5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212731&amp;x-signature=S0bd3%2Fbu96yCjves7YJzpHiTCZc%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3688d776c8ac4f40909ed1f940373972~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUFyY2hKb3VybmV5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212731&amp;x-signature=FabePfXY%2Bx1o36f1ALFNtHdbWEQ%3D" alt="" loading="lazy"/></p>
<hr/>
<p><strong>ThreadPoolExecutor çº¿ç¨‹æ± ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.concurrent.*;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadPoolExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">ThreadFactory</span> <span class="hljs-variable">namedThreadFactory</span> <span class="hljs-operator">=</span> r -&gt; {
            <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(r, <span class="hljs-string">"MyPool-Thread"</span>);
            t.setDaemon(<span class="hljs-literal">false</span>);
            <span class="hljs-keyword">return</span> t;
        };

        BlockingQueue&lt;Runnable&gt; workQueue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBlockingQueue</span>&lt;&gt;(<span class="hljs-number">100</span>);
        <span class="hljs-type">RejectedExecutionHandler</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.CallerRunsPolicy();

        <span class="hljs-type">ThreadPoolExecutor</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(
            <span class="hljs-number">2</span>,
            <span class="hljs-number">4</span>,
            <span class="hljs-number">30</span>,
            TimeUnit.SECONDS,
            workQueue,
            namedThreadFactory,
            handler
        );

        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
            <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">taskId</span> <span class="hljs-operator">=</span> i;
            executor.submit(() -&gt; {
                System.out.println(<span class="hljs-string">"Task "</span> + taskId + <span class="hljs-string">" executed by "</span> + Thread.currentThread().getName());
                <span class="hljs-keyword">try</span> {
                    Thread.sleep(<span class="hljs-number">1000</span>);
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    Thread.currentThread().interrupt();
                }
            });
        }

        executor.shutdown();
    }
}
</code></pre>
<h2 data-id="heading-2">Executors å·¥å‚ç±»</h2>
<p>Java æä¾›äº† <code>Executors</code> å·¥å…·ç±»ï¼Œç”¨äºå¿«é€Ÿåˆ›å»ºå¸¸è§çº¿ç¨‹æ± ï¼š</p>






























<table><thead><tr><th><strong>æ–¹æ³•</strong></th><th><strong>è¯´æ˜</strong></th><th><strong>å†…éƒ¨å®ç°</strong></th></tr></thead><tbody><tr><td><code>newFixedThreadPool(int n)</code></td><td>å›ºå®šå¤§å°çº¿ç¨‹æ± </td><td>core = max = nï¼Œæ— ç•Œé˜Ÿåˆ—<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec7e37688d044735893176cbb7196c08~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUFyY2hKb3VybmV5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212731&amp;x-signature=du3WgLUjmGM79hE7fsJBnbhYJBM%3D" alt="" loading="lazy"/></td></tr><tr><td><code>newCachedThreadPool()</code></td><td>ç¼“å­˜çº¿ç¨‹æ± </td><td>core = 0ï¼Œmax = Integer.MAX_VALUEï¼ŒSynchronousQueue<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bdacf916827c4fea9974b89da9f87953~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUFyY2hKb3VybmV5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212731&amp;x-signature=2r69aTRxrK4tOxIT9NMPBSJId3E%3D" alt="" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2285b1e5bf1647639a312f4cd85665a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUFyY2hKb3VybmV5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212731&amp;x-signature=0K%2F9096VgouaLr6NYjyjQqYnsNs%3D" alt="" loading="lazy"/></td></tr><tr><td><code>newSingleThreadExecutor()</code></td><td>å•çº¿ç¨‹æ± </td><td>core = max = 1ï¼Œæ— ç•Œé˜Ÿåˆ—<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7c44bcca064457eb68886c10a4a735a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUFyY2hKb3VybmV5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212731&amp;x-signature=VANoPERdTP9R%2FohSRUM7HRuRKOs%3D" alt="" loading="lazy"/></td></tr><tr><td><code>newScheduledThreadPool(int n)</code></td><td>æ”¯æŒå®šæ—¶/å‘¨æœŸä»»åŠ¡</td><td>ScheduledThreadPoolExecutor</td></tr></tbody></table>
<p>å…¶ä¸­ï¼Œ<code>newFixedThreadPool</code> å’Œ <code>newCachedThreadPool</code> åœ¨é«˜è´Ÿè½½ä¸‹å¯èƒ½å¯¼è‡´ OOMï¼ˆå› ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—æˆ–è¿‡å¤šçº¿ç¨‹ï¼‰ã€‚å› æ­¤ï¼Œç”Ÿäº§ç¯å¢ƒå¼ºçƒˆå»ºè®®æ‰‹åŠ¨åˆ›å»º <code>ThreadPoolExecutor</code> å¹¶æ˜ç¡®å‚æ•°ã€‚</p>
<h2 data-id="heading-3">ScheduledThreadPoolExecutor</h2>
<p><code>ScheduledThreadPoolExecutor</code> æ˜¯ä¸“é—¨ç”¨äºå»¶è¿Ÿæ‰§è¡Œæˆ–å‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡ã€‚å®ƒæ˜¯ <code>ThreadPoolExecutor</code> çš„å­ç±»ï¼ŒåŒæ—¶å®ç°äº† <code>ScheduledExecutorService</code> æ¥å£ã€‚</p>
<p><strong>ScheduledThreadPoolExecutor ç‰¹æ€§ï¼š</strong></p>
<ul>
<li>æ”¯æŒä¸€æ¬¡æ€§å»¶è¿Ÿæ‰§è¡Œã€‚</li>
<li>æ”¯æŒ å›ºå®šé¢‘ç‡ï¼ˆfixed-rateï¼‰æˆ– å›ºå®šå»¶è¿Ÿï¼ˆfixed-delayï¼‰çš„å‘¨æœŸæ€§ä»»åŠ¡ã€‚</li>
<li>çº¿ç¨‹å¤ç”¨ï¼šå¤šä¸ªå®šæ—¶ä»»åŠ¡å…±äº«çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ï¼Œé¿å…é¢‘ç¹åˆ›å»º/é”€æ¯çº¿ç¨‹ã€‚</li>
<li>çº¿ç¨‹æ± ç­‰å¾…é˜Ÿåˆ—é»˜è®¤ä½¿ç”¨ <code>DelayedWorkQueue</code>ï¼ˆä¸€ç§æ— ç•Œä¼˜å…ˆé˜Ÿåˆ—ï¼‰ï¼Œå¤§é‡ä»»åŠ¡å †ç§¯å¯èƒ½å¯¼è‡´ OOMã€‚</li>
<li>æ¯” Timer / TimerTask æ›´å®‰å…¨ã€æ›´çµæ´»ï¼ˆTimer æ˜¯å•çº¿ç¨‹ï¼Œå¼‚å¸¸ä¼šå¯¼è‡´æ•´ä¸ªè°ƒåº¦å™¨å´©æºƒï¼‰ã€‚è‹¥æŸä¸ªä»»åŠ¡æŠ›å‡ºæœªæ•è·å¼‚å¸¸ï¼Œè¯¥ä»»åŠ¡å°†ç»ˆæ­¢ï¼Œä½†ä¸ä¼šå½±å“å…¶ä»–ä»»åŠ¡ã€‚</li>
<li>å¯é€šè¿‡ ScheduledFuture.cancel() å–æ¶ˆä»»åŠ¡ã€‚</li>
<li>è°ƒç”¨ shutdown() å…³é—­çº¿ç¨‹æ± åï¼Œå·²æäº¤çš„ä»»åŠ¡ä»ä¼šæ‰§è¡Œï¼›shutdownNow() å°è¯•ä¸­æ–­æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5cb6d3fbbf054d86a421104a216922b5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUFyY2hKb3VybmV5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212731&amp;x-signature=d4BY3tFivrjcdIZnz2pHXwgdN0w%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">çº¿ç¨‹æ± æœ€ä½³å®è·µ</h2>
<ul>
<li><strong>é¿å…ä½¿ç”¨ Executors åˆ›å»ºæ™®é€šçº¿ç¨‹æ± </strong>ï¼Œåº”æ˜¾å¼ä½¿ç”¨ <code>ThreadPoolExecutor</code>ã€‚</li>
<li><strong>åˆç†è®¾ç½® corePoolSize å’Œ maximumPoolSize</strong>ï¼Œæ ¹æ® CPU æ ¸å¿ƒæ•°å’Œä»»åŠ¡ç±»å‹ï¼ˆCPU å¯†é›†å‹ vs IO å¯†é›†å‹ï¼‰è°ƒæ•´ã€‚</li>
</ul>

<ul>
<li><strong>ä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—</strong>ï¼Œé˜²æ­¢å†…å­˜æº¢å‡ºã€‚</li>
<li><strong>è‡ªå®šä¹‰ ThreadFactory</strong>ï¼Œä¸ºçº¿ç¨‹å‘½åä¾¿äºæ’æŸ¥é—®é¢˜ã€‚</li>
<li><strong>åˆç†å¤„ç†å¼‚å¸¸</strong>ï¼šåœ¨ <code>Runnable</code> æˆ– <code>Callable</code> ä¸­æ•è·å¼‚å¸¸ï¼Œé¿å…çº¿ç¨‹é™é»˜é€€å‡ºã€‚</li>
<li><strong>ä¼˜é›…å…³é—­çº¿ç¨‹æ± </strong>ï¼š</li>
</ul>
<pre><code class="hljs language-java" lang="java">executor.shutdown();
<span class="hljs-keyword">if</span> (!executor.awaitTermination(<span class="hljs-number">60</span>, TimeUnit.SECONDS)) {
    executor.shutdownNow();
}
</code></pre>
<h2 data-id="heading-5">å‚è€ƒ</h2>
<ul>
<li>ã€ŠJavaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹</li>
</ul>
<p>ã€æœ¬æ–‡é¦–å‘äºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FSNrAPYd1ElWU6ZzbpYUVKg" target="_blank" title="https://mp.weixin.qq.com/s/SNrAPYd1ElWU6ZzbpYUVKg" ref="nofollow noopener noreferrer">JavaArchJourney</a>ã€‘</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…³äºopenfeignçš„ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜]]></title>    <link>https://juejin.cn/post/7574568258789490739</link>    <guid>https://juejin.cn/post/7574568258789490739</guid>    <pubDate>2025-11-20T03:06:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574568258789490739" data-draft-id="7574625040629923878" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…³äºopenfeignçš„ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-11-20T03:06:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æ¨åŒå­¦Decade"/> <meta itemprop="url" content="https://juejin.cn/user/3501321044625325"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…³äºopenfeignçš„ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3501321044625325/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æ¨åŒå­¦Decade
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:06:15.000Z" title="Thu Nov 20 2025 03:06:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€é—®é¢˜èƒŒæ™¯</h2>
<p>éœ€è¦è°ƒç”¨ç¬¬ä¸‰æ–¹å’Œé£å¤©æ°”çš„apiï¼Œè·å–å¤©æ°”ä¿¡æ¯
ç¼–å†™äº†å¦‚ä¸‹ä½¿ç”¨openfeignè°ƒç”¨çš„æ¥å£
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c13aa438aee64d8db44012c9172f7563~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5p2o5ZCM5a2mRGVjYWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212774&amp;x-signature=Vls5i%2FwKR0DRz1MU8EQVzDrwDfs%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">äºŒã€é—®é¢˜æè¿°</h2>
<p>1ã€ç›´æ¥é€šè¿‡apifoxè°ƒç”¨ç¬¬ä¸‰æ–¹apiï¼Œæ²¡é—®é¢˜
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d15a2ea717e4e8fb856dfd7226402cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5p2o5ZCM5a2mRGVjYWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212774&amp;x-signature=wtX7bjBY5Y20gFlrcZhpFlZ8SyY%3D" alt="image.png" loading="lazy"/></p>
<p>2ã€ä»£ç ä¸­ç›´æ¥é€šè¿‡okhttpè°ƒç”¨ç¬¬ä¸‰æ–¹apiï¼Œæ²¡é—®é¢˜
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a4021aa55fc4129a73996fb58b323a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5p2o5ZCM5a2mRGVjYWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212774&amp;x-signature=jxohpa1p2YWGxEBXY9E%2FsVgBAzw%3D" alt="image.png" loading="lazy"/></p>
<p>3ã€ä½¿ç”¨ä¸Šè¿°çš„feignè°ƒç”¨ç¬¬ä¸‰æ–¹apiï¼ŒæŠ¥é”™ï¼š401 &amp; ä¹±ç ï¼Œè€Œé€šè¿‡æ–­ç‚¹æ’æŸ¥ï¼Œè°ƒç”¨apiçš„headerå’Œå‚æ•°éƒ½æ˜¯æ­£ç¡®çš„
<code>feign.FeignException$Unauthorized: [401] during [GET] to [https://xxx.yun.qweatherapi.com/v7/weather/now?location=101200101] [IWeatherApiService#getWeatherNow(String,String)]: [ï¿½ï¿½UÌ±ï¿½ ï¿½_!ï¿½ZA'6W ï¿½ï¿½ï¿½rï¿½84ï¿½é¿‹nï¿½ox3 31ï¿½ï¿½8ï¿½ï¿½nï¿½ï¿½@ï¿½ï¿½Bï¿½5&amp;ï¿½S?^ï¿½$"kOwï¿½ï¿½Xï¿½ï¿½Gï¿½;Öï¿½UÍ®J$NoĞ¢$ï¿½wï¿½ï¿½s@qihï¿½oï¿½Yï¿½wï¿½(ï¿½[Sï¿½ï¿½}ï¿½ï¿½Ö«ï¿½ï¿½jï¿½ï¿½cVï¿½ï¿½HE4,ï¿½ï¿½ï¿½Nï¿½ï¿½] at feign.FeignException.clientErrorStatus(FeignException.java:197)</code></p>
<h2 data-id="heading-2">ä¸‰ã€é—®é¢˜åŸå› </h2>
<p>1ã€è¿™ä¸ªç¬¬ä¸‰æ–¹apiçš„å“åº”å¼€å¯äº†gzipå‹ç¼©ï¼Œå“åº”ä½“æ˜¯ gzip å‹ç¼©çš„
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9704b355a944fe7b291d3ff90d9c632~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5p2o5ZCM5a2mRGVjYWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212774&amp;x-signature=Tnd8EqpOrpQGefcymcHD06LFy6U%3D" alt="image.png" loading="lazy"/></p>
<p>2ã€Feign é»˜è®¤ä½¿ç”¨ JDK è‡ªå¸¦çš„ HttpURLConnection ä½œä¸º HTTP Clientï¼Œä¸æ”¯æŒå¤„ç†gizp
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d505415026fc45f28c766f4dc80f1efa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5p2o5ZCM5a2mRGVjYWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212774&amp;x-signature=Tcf9xut6C3pfWrfE09qrhqJHOQg%3D" alt="ä¼ä¸šå¾®ä¿¡æˆªå›¾_17636033284560.png" loading="lazy"/></p>
<h2 data-id="heading-3">å››ã€é—®é¢˜è§£å†³</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d8cbcf02bf94dd88853b27404fd50e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5p2o5ZCM5a2mRGVjYWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212774&amp;x-signature=mrCHmfB65IqShqBNfhakMBsr9%2BM%3D" alt="image.png" loading="lazy"/>
==<strong>å°†HTTP Clientæ¢ä¸ºokhttp</strong>==</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">feign:</span>
  <span class="hljs-attr">okhttp:</span>
    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">max-connections:</span> <span class="hljs-number">200</span>
    <span class="hljs-attr">max-connections-per-route:</span> <span class="hljs-number">50</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React æ€§èƒ½ä¼˜åŒ–è¯¯åŒºï¼šç»“åˆå®æˆ˜ä»£ç ï¼Œå½»åº•ææ‡‚ useCallback çš„çœŸæ­£ç”¨é€”]]></title>    <link>https://juejin.cn/post/7574318108720857134</link>    <guid>https://juejin.cn/post/7574318108720857134</guid>    <pubDate>2025-11-20T03:07:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574318108720857134" data-draft-id="7574584245110521907" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React æ€§èƒ½ä¼˜åŒ–è¯¯åŒºï¼šç»“åˆå®æˆ˜ä»£ç ï¼Œå½»åº•ææ‡‚ useCallback çš„çœŸæ­£ç”¨é€”"/> <meta itemprop="keywords" content="å‰ç«¯,React.js"/> <meta itemprop="datePublished" content="2025-11-20T03:07:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çš®è›‹å°ç²¾çµ"/> <meta itemprop="url" content="https://juejin.cn/user/219558056559278"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React æ€§èƒ½ä¼˜åŒ–è¯¯åŒºï¼šç»“åˆå®æˆ˜ä»£ç ï¼Œå½»åº•ææ‡‚ useCallback çš„çœŸæ­£ç”¨é€”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/219558056559278/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çš®è›‹å°ç²¾çµ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:07:24.000Z" title="Thu Nov 20 2025 03:07:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ React å¼€å‘ä¸­ï¼Œ<code>useCallback</code> æ˜¯æœ€å®¹æ˜“è¢«è¯¯ç”¨ï¼ˆOverusedï¼‰çš„ Hook ä¹‹ä¸€ã€‚å¾ˆå¤šå¼€å‘è€…çœ‹åˆ°ç»„ä»¶é‡æ¸²æŸ“ï¼ˆRe-renderï¼‰ï¼Œä¸‹æ„è¯†åœ°å°±æƒ³æŠŠæ‰€æœ‰å‡½æ•°éƒ½åŒ…ä¸Šä¸€å±‚ <code>useCallback</code>ï¼Œè®¤ä¸ºè¿™æ ·èƒ½æå‡æ€§èƒ½ã€‚</p>
<p>ä½†äº‹å®å¾€å¾€ç›¸åï¼š<strong>åœ¨é”™è¯¯çš„åœ°æ–¹ä½¿ç”¨ <code>useCallback</code>ï¼Œä¸ä»…ä¸èƒ½ä¼˜åŒ–æ€§èƒ½ï¼Œåè€Œä¼šå¢åŠ å†…å­˜å¼€é”€å’Œä»£ç å¤æ‚åº¦ã€‚</strong></p>
<p>ä»Šå¤©æˆ‘ä»¬ç»“åˆ Hacker News æœç´¢ä»£ç ï¼Œæ¥æ‹†è§£ <code>useCallback</code> åˆ°åº•è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Œä»¥åŠä»€ä¹ˆæ—¶å€™æ‰åº”è¯¥ç”¨å®ƒã€‚</p>
<hr/>
<h3 data-id="heading-0">1. æ¡ˆå‘ç°åœºï¼šä»£ç çœŸçš„éœ€è¦ä¼˜åŒ–å—ï¼Ÿ</h3>
<p>è®©æˆ‘ä»¬å…ˆçœ‹ä»£ç ä¸­çš„è¿™ä¸€éƒ¨åˆ†ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// App.js (åŸå§‹ä»£ç )</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [searchTerm, setSearchTerm] = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useState</span>(<span class="hljs-string">"js"</span>);

  <span class="hljs-comment">// âŒ ç–‘é—®ï¼šè¿™é‡Œæ˜¯å¦éœ€è¦ useCallbackï¼Ÿ</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChange</span> = (<span class="hljs-params">e</span>) =&gt; {
    <span class="hljs-title function_">setSearchTerm</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span>
      {/* è¿™é‡Œçš„ input æ˜¯åŸç”Ÿ DOM æ ‡ç­¾ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span> <span class="hljs-attr">...</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}
</code></pre>
<p><strong>ç°çŠ¶åˆ†æï¼š</strong></p>
<ol>
<li>å½“ç”¨æˆ·è¾“å…¥å­—ç¬¦ï¼Œ<code>handleChange</code> æ‰§è¡Œ -&gt; <code>setSearchTerm</code> æ›´æ–°çŠ¶æ€ã€‚</li>
<li><code>App</code> ç»„ä»¶è§¦å‘é‡æ¸²æŸ“ï¼ˆRe-renderï¼‰ã€‚</li>
<li>åœ¨è¿™æ¬¡æ–°çš„æ¸²æŸ“ä¸­ï¼Œ<code>handleChange</code> å‡½æ•°è¢«<strong>é‡æ–°åˆ›å»º</strong>ï¼ˆåœ¨å†…å­˜ä¸­ç”Ÿæˆäº†ä¸€ä¸ªå…¨æ–°çš„å‡½æ•°å¼•ç”¨ï¼‰ã€‚</li>
<li>è¿™ä¸ªæ–°å‡½æ•°è¢«ä¼ é€’ç»™ <code>&lt;input&gt;</code> æ ‡ç­¾ã€‚</li>
</ol>
<p>ç»“è®ºï¼š</p>
<p>åœ¨ä½ çš„å½“å‰ä»£ç ä¸­ï¼Œå®Œå…¨ä¸éœ€è¦ useCallbackã€‚</p>
<p>åŸå› ï¼š</p>
<p>æ¥æ”¶ handleChange çš„æ˜¯ <code>&lt;input&gt;</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸç”Ÿ DOM å…ƒç´ ã€‚åŸç”Ÿå…ƒç´ ä¸å…·å¤‡â€œé€šè¿‡å¯¹æ¯” Props æ¥å†³å®šæ˜¯å¦æ›´æ–°â€çš„èƒ½åŠ›ã€‚æ— è®ºä½ ä¼ ç»™å®ƒçš„æ˜¯æ—§å‡½æ•°è¿˜æ˜¯æ–°å‡½æ•°ï¼Œåªè¦çˆ¶ç»„ä»¶æ¸²æŸ“ï¼ŒReact éƒ½ä¼šé‡æ–°æŠŠäº‹ä»¶ç»‘å®šæ›´æ–°ä¸€éã€‚</p>
<p>åœ¨è¿™é‡ŒåŠ  <code>useCallback</code>ï¼Œå°±åƒæ˜¯<strong>ç»™ä¸€æ¬¡æ€§çº¸æ¯ä¹°ä¿é™©</strong>â€”â€”æˆæœ¬ï¼ˆç¼“å­˜æœºåˆ¶ã€ä¾èµ–å¯¹æ¯”çš„è®¡ç®—é‡ï¼‰æ”¯å‡ºäº†ï¼Œä½†æ²¡æœ‰ä»»ä½•æ”¶ç›Šã€‚</p>
<hr/>
<h3 data-id="heading-1">2. æ ¸å¿ƒæ¦‚å¿µï¼šå¼•ç”¨ç›¸ç­‰æ€§ (Referential Equality)</h3>
<p>è¦ç†è§£ <code>useCallback</code>ï¼Œå¿…é¡»ç†è§£ JavaScript ä¸­çš„ä¸€ä¸ªåŸºç¡€æ¦‚å¿µï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">functionA</span> = (<span class="hljs-params"/>) =&gt; { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'hi'</span>); };
<span class="hljs-keyword">const</span> <span class="hljs-title function_">functionB</span> = (<span class="hljs-params"/>) =&gt; { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'hi'</span>); };

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(functionA === functionB); <span class="hljs-comment">// false âŒ</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(functionA === functionA); <span class="hljs-comment">// true âœ…</span>
</code></pre>
<p>åœ¨ React å‡½æ•°ç»„ä»¶ä¸­ï¼Œæ¯æ¬¡æ¸²æŸ“ï¼Œç»„ä»¶å†…éƒ¨å®šä¹‰çš„å‡½æ•°éƒ½ä¼šè¢«é‡æ–°åˆ›å»ºã€‚è™½ç„¶ä»£ç é€»è¾‘æ²¡å˜ï¼Œä½†åœ¨è®¡ç®—æœºå†…å­˜é‡Œï¼Œå®ƒå·²ç»æ˜¯ä¸€ä¸ª<strong>å…¨æ–°çš„å¯¹è±¡</strong>äº†ã€‚</p>
<p><code>useCallback</code> çš„å”¯ä¸€ä½œç”¨å°±æ˜¯ï¼š<strong>åœ¨å¤šæ¬¡æ¸²æŸ“ä¹‹é—´ï¼Œå¼ºè¡Œä¿ç•™åŒä¸€ä¸ªå‡½æ•°å¼•ç”¨ï¼Œåªè¦ä¾èµ–é¡¹ä¸å˜ï¼Œå®ƒè¿”å›çš„æ°¸è¿œæ˜¯å†…å­˜é‡Œçš„åŒä¸€ä¸ªåœ°å€ã€‚</strong></p>
<hr/>
<h3 data-id="heading-2">3. ä»€ä¹ˆæ—¶å€™æ‰éœ€è¦å®ƒï¼Ÿ(å¼•å…¥ React.memo)</h3>
<p>åªæœ‰å½“è¿™ä¸ªå‡½æ•°è¢«ä¼ é€’ç»™<strong>ç»è¿‡ä¼˜åŒ–çš„å­ç»„ä»¶</strong>æ—¶ï¼Œ<code>useCallback</code> æ‰æ˜¯å¿…é¡»çš„ã€‚</p>
<p>å‡è®¾éšç€é¡¹ç›®å˜å¤§ï¼Œä½ æŠŠ <code>&lt;input&gt;</code> å°è£…æˆäº†ä¸€ä¸ªç‹¬ç«‹çš„ã€åŠŸèƒ½å¤æ‚çš„ç»„ä»¶ <code>FancyInput</code>ï¼Œå¹¶ä¸”ä¸ºäº†æ€§èƒ½ï¼Œä½ ä½¿ç”¨äº† <code>React.memo</code>ã€‚</p>
<h4 data-id="heading-3">åœºæ™¯ Aï¼šæœ‰ memoï¼Œä½†æ²¡ç”¨ useCallback (æ— æ•ˆä¼˜åŒ–)</h4>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªè¢« memo ä¿æŠ¤çš„ç»„ä»¶</span>
<span class="hljs-comment">// å®ƒçš„åŸåˆ™æ˜¯ï¼šåªæœ‰ props å˜äº†ï¼Œæˆ‘æ‰é‡æ–°æ¸²æŸ“</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">FancyInput</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">memo</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">FancyInput</span>(<span class="hljs-params">{ onChange, value }</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"FancyInput æ¸²æŸ“äº†!"</span>); 
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"fancy"</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{onChange}</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> /&gt;</span></span>;
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [searchTerm, setSearchTerm] = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useState</span>(<span class="hljs-string">"js"</span>);
  
  <span class="hljs-comment">// æ¯æ¬¡ App æ¸²æŸ“ï¼Œè¿™é‡Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„å‡½æ•°åœ°å€</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChange</span> = (<span class="hljs-params">e</span>) =&gt; <span class="hljs-title function_">setSearchTerm</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>); 

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
       {/* æ‚²å‰§å‘ç”Ÿåœ¨è¿™é‡Œï¼š
         å°½ç®¡ searchTerm æ²¡å˜ (å‡è®¾æ˜¯å…¶ä»– state è§¦å‘äº† App æ›´æ–°)ï¼Œ
         ä½†å› ä¸º handleChange çš„å†…å­˜åœ°å€å˜äº†ï¼Œ
         React.memo è®¤ä¸º props.onChange å˜äº†ã€‚
         ç»“æœï¼šFancyInput ä¾ç„¶ä¼šå¼ºåˆ¶é‡æ¸²æŸ“ï¼
       */}
      <span class="hljs-tag">&lt;<span class="hljs-name">FancyInput</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{searchTerm}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}
</code></pre>
<h4 data-id="heading-4">åœºæ™¯ Bï¼šmemo + useCallback (é»„é‡‘æ­æ¡£)</h4>
<p>è¿™æ—¶å€™ï¼Œ<code>useCallback</code> å°±è¦ç™»åœºäº†ã€‚å®ƒæ˜¯ä¸ºäº†é…åˆ <code>React.memo</code> å·¥ä½œçš„ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [searchTerm, setSearchTerm] = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useState</span>(<span class="hljs-string">"js"</span>);

  <span class="hljs-comment">// âœ… æ­£ç¡®ä½¿ç”¨ï¼šç¼“å­˜å‡½æ•°å¼•ç”¨</span>
  <span class="hljs-keyword">const</span> handleChange = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useCallback</span>(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-title function_">setSearchTerm</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>);
  }, []); <span class="hljs-comment">// ä¾èµ–é¡¹ä¸ºç©ºï¼Œæ°¸è¿œä¸é‡å»º</span>

  <span class="hljs-keyword">return</span> (
    {<span class="hljs-comment">/* ç°åœ¨ï¼Œå½“ App å› ä¸ºå…¶ä»–åŸå› é‡æ¸²æŸ“æ—¶ï¼Œ
      handleChange è¿˜æ˜¯åŸæ¥çš„å†…å­˜åœ°å€ã€‚
      React.memo å‘ç° props æ²¡å˜ï¼Œäºæ˜¯è·³è¿‡ FancyInput çš„æ¸²æŸ“ã€‚
      æ€§èƒ½æå‡è¾¾æˆï¼
    */</span>}
    &lt;<span class="hljs-title class_">FancyInput</span> onChange={handleChange} value={searchTerm} /&gt;
  );
}
</code></pre>
<hr/>
<h3 data-id="heading-5">4. å¦ä¸€ä¸ªåœºæ™¯ï¼šä½œä¸º useEffect çš„ä¾èµ–</h3>
<p>ä»£ç ä¸­å…¶å®æœ‰ä¸€ä¸ªæ½œåœ¨çš„åœ°æ–¹å¯èƒ½éœ€è¦ <code>useCallback</code>ï¼Œé‚£å°±æ˜¯å½“å‡½æ•°æœ¬èº«è¢«æ”¾åœ¨ <code>useEffect</code> çš„ä¾èµ–æ•°ç»„é‡Œæ—¶ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// å‡è®¾è¿™æ˜¯å®šä¹‰åœ¨ç»„ä»¶å†…çš„å‡½æ•°</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchNews</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">query</span>) =&gt; {
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">searchHackerNews</span>(query);
  <span class="hljs-title function_">setResults</span>(data.<span class="hljs-property">hits</span>);
};

<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">fetchNews</span>(debouncedSearchTerm);
}, [debouncedSearchTerm, fetchNews]); <span class="hljs-comment">// âš ï¸ fetchNews æ˜¯ä¾èµ–é¡¹</span>
</code></pre>
<p>å¦‚æœ<code>fetchNews</code> ä¸åŒ…è£¹ <code>useCallback</code>ï¼Œæ¯æ¬¡æ¸²æŸ“ <code>fetchNews</code> éƒ½ä¼šå˜æˆæ–°å‡½æ•°ï¼Œå¯¼è‡´ <code>useEffect</code> è®¤ä¸ºä¾èµ–å˜äº†ï¼Œä»è€Œ<strong>æ— é™å¾ªç¯</strong>æˆ–è€…<strong>ä¸å¿…è¦çš„é¢‘ç¹æ‰§è¡Œ</strong>ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¿…é¡»ä½¿ç”¨ <code>useCallback</code> é”ä½ <code>fetchNews</code>ã€‚</p>
<hr/>
<h3 data-id="heading-6">æ€»ç»“ï¼šå†³ç­–æ¸…å•</h3>
<p>å›åˆ°ä»£ç ï¼Œè¯·æŒ‰ç…§è¿™ä¸ªæ¸…å•æ¥å†³å®šæ˜¯å¦ä½¿ç”¨ <code>useCallback</code>ï¼š</p>
<ol>
<li>
<p><strong>è¿™ä¸ªå‡½æ•°æ˜¯ä¼ ç»™åŸç”Ÿ DOM (div, button, input) çš„å—ï¼Ÿ</strong></p>
<ul>
<li>æ˜¯ -&gt; <strong>ä¸ç”¨</strong> (ç”¨äº†ä¹Ÿæ²¡ç”¨)ã€‚</li>
<li>å¦ -&gt; çœ‹ä¸‹ä¸€æ¡ã€‚</li>
</ul>
</li>
<li>
<p><strong>è¿™ä¸ªå‡½æ•°æ˜¯ä¼ ç»™å­ç»„ä»¶çš„ï¼Œä¸”å­ç»„ä»¶ç”¨äº† <code>React.memo</code> å—ï¼Ÿ</strong></p>
<ul>
<li>æ˜¯ -&gt; <strong>ç”¨</strong> (ä¸ºäº†è®© memo ç”Ÿæ•ˆ)ã€‚</li>
<li>å¦ -&gt; <strong>ä¸ç”¨</strong> (å¤§éƒ¨åˆ†å­ç»„ä»¶éƒ½å¾ˆè½»é‡ï¼Œä¸éœ€è¦ memo)ã€‚</li>
</ul>
</li>
<li>
<p><strong>è¿™ä¸ªå‡½æ•°ä¼šè¢«ä½œä¸º <code>useEffect</code> æˆ–å…¶ä»– Hook çš„ä¾èµ–é¡¹å—ï¼Ÿ</strong></p>
<ul>
<li>æ˜¯ -&gt; <strong>ç”¨</strong> (é˜²æ­¢æ­»å¾ªç¯æˆ–é¢‘ç¹è§¦å‘ Effect)ã€‚</li>
</ul>
</li>
</ol>
<p>æœ€ç»ˆå»ºè®®ï¼š</p>
<p>åœ¨App ç»„ä»¶å½“å‰çš„çŠ¶æ€ä¸‹ï¼Œä¿æŒåŸæ ·æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚ä»£ç æ¸…æ™°ã€é€»è¾‘ç®€å•ï¼Œæ²¡æœ‰ä»»ä½•ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºMCPçš„ä»£ç æ‰§è¡Œï¼šæ„å»ºæ›´é«˜æ•ˆç‡çš„æ™ºèƒ½ä½“]]></title>    <link>https://juejin.cn/post/7574344443823751168</link>    <guid>https://juejin.cn/post/7574344443823751168</guid>    <pubDate>2025-11-20T02:56:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574344443823751168" data-draft-id="7574380953175425066" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºMCPçš„ä»£ç æ‰§è¡Œï¼šæ„å»ºæ›´é«˜æ•ˆç‡çš„æ™ºèƒ½ä½“"/> <meta itemprop="keywords" content="MCP,Agent,åç«¯"/> <meta itemprop="datePublished" content="2025-11-20T02:56:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="FreeCode"/> <meta itemprop="url" content="https://juejin.cn/user/1282499717900794"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºMCPçš„ä»£ç æ‰§è¡Œï¼šæ„å»ºæ›´é«˜æ•ˆç‡çš„æ™ºèƒ½ä½“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1282499717900794/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    FreeCode
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T02:56:16.000Z" title="Thu Nov 20 2025 02:56:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><blockquote>
<p>æœ¬æ–‡æ˜¯Aç¤¾2025å¹´11æœˆ4æ—¥åšå®¢æ–‡ç« ã€ŠCode execution with MCP: Building more efficient agentsã€‹çš„å­¦ä¹ æ€»ç»“ã€‚</p>
</blockquote>
<h2 data-id="heading-0">å¼•è¨€</h2>
<p>ç›´æ¥å·¥å…·è°ƒç”¨ä¼šä¸ºæ¯ä¸ªå®šä¹‰å’Œç»“æœæ¶ˆè€—ä¸Šä¸‹æ–‡ã€‚è€Œæ™ºèƒ½ä½“ï¼ˆAgentsï¼‰é€šè¿‡ç¼–å†™ä»£ç æ¥è°ƒç”¨å·¥å…·ï¼Œå¯å®ç°æ›´å¥½çš„æ‰©å±•ã€‚ä»¥ä¸‹å°†ä»‹ç»å…¶åœ¨MCPä¸­çš„å·¥ä½œåŸç†ã€‚</p>
<p>æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼ˆModel Context Protocolï¼Œç®€ç§° MCPï¼‰æ˜¯ä¸€ç§ç”¨äºå°† AI æ™ºèƒ½ä½“è¿æ¥åˆ°å¤–éƒ¨ç³»ç»Ÿçš„å¼€æ”¾å¼æ ‡å‡†ã€‚ä¼ ç»Ÿæ–¹å¼ä¸‹ï¼Œå°†æ™ºèƒ½ä½“ä¸å·¥å…·ã€æ•°æ®è¿æ¥æ—¶ï¼Œæ¯ä¸€ç»„é…å¯¹éƒ½éœ€è¦å•ç‹¬å®šåˆ¶é›†æˆæ–¹æ¡ˆï¼Œè¿™ä¼šå¯¼è‡´ç³»ç»Ÿç¢ç‰‡åŒ–ä¸”å­˜åœ¨å¤§é‡é‡å¤å·¥ä½œï¼Œéš¾ä»¥å®ç°çœŸæ­£å¯æ‰©å±•çš„äº’è”ç³»ç»Ÿã€‚è€Œ MCP æä¾›äº†ä¸€ç§é€šç”¨åè®® â€”â€” å¼€å‘è€…åªéœ€åœ¨æ™ºèƒ½ä½“ä¸­å®ç°ä¸€æ¬¡MCPï¼Œå°±èƒ½è§£é”ä¸€æ•´å¥—é›†æˆç”Ÿæ€ã€‚</p>
<p>è‡ª 2024 å¹´ 11 æœˆ MCP æ¨å‡ºä»¥æ¥ï¼Œå…¶é‡‡ç”¨ç‡å¢é•¿è¿…é€Ÿï¼šç¤¾åŒºå·²æ­å»ºäº†æ•°åƒå° MCP æœåŠ¡å™¨ï¼Œæ‰€æœ‰ä¸»æµç¼–ç¨‹è¯­è¨€å‡å·²æ”¯æŒå¯¹åº”çš„SDKï¼ˆè½¯ä»¶å¼€å‘å·¥å…·åŒ…ï¼‰ï¼Œå¹¶ä¸” MCP å·²æˆä¸ºè¡Œä¸šå†…å°†æ™ºèƒ½ä½“ä¸å·¥å…·ã€æ•°æ®è¿æ¥çš„äº‹å®æ ‡å‡†ï¼ˆde-facto standardï¼‰ã€‚</p>
<p>å¦‚ä»Šï¼Œå¼€å‘è€…æ„å»ºçš„æ™ºèƒ½ä½“é€šå¸¸èƒ½è®¿é—®æ•°åå° MCP æœåŠ¡å™¨ä¸Šçš„æ•°ç™¾ç”šè‡³æ•°åƒä¸ªå·¥å…·ã€‚ç„¶è€Œï¼Œéšç€æ‰€è¿æ¥å·¥å…·æ•°é‡çš„å¢åŠ ï¼Œæå‰åŠ è½½æ‰€æœ‰å·¥å…·å®šä¹‰ä»¥åŠé€šè¿‡ä¸Šä¸‹æ–‡çª—å£ä¼ é€’ä¸­é—´ç»“æœè¿™ä¸¤ä¸ªæ“ä½œï¼Œä¼šå¯¼è‡´æ™ºèƒ½ä½“è¿è¡Œé€Ÿåº¦å˜æ…¢ï¼ŒåŒæ—¶å¢åŠ æˆæœ¬ã€‚</p>
<p>åœ¨æœ¬ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨å¦‚ä½•é€šè¿‡ä»£ç æ‰§è¡Œè®©æ™ºèƒ½ä½“æ›´é«˜æ•ˆåœ°ä¸ MCP æœåŠ¡å™¨äº¤äº’ â€”â€” åœ¨æ”¯æŒæ›´å¤šå·¥å…·çš„åŒæ—¶ï¼Œæ¶ˆè€—æ›´å°‘çš„ tokensï¼ˆä»¤ç‰Œï¼ŒæŒ‡ AI æ¨¡å‹å¤„ç†æ–‡æœ¬çš„åŸºæœ¬å•ä½ï¼‰ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ å·¥å…·å¯¼è‡´çš„tokenè¿‡åº¦æ¶ˆè€—é™ä½æ™ºèƒ½ä½“æ•ˆç‡</h2>
<p>éšç€æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰ä½¿ç”¨è§„æ¨¡çš„æ‰©å¤§ï¼Œå‡ºç°äº†ä¸¤ç§å¸¸è§æƒ…å†µï¼Œå¯èƒ½å¯¼è‡´æ™ºèƒ½ä½“çš„æˆæœ¬å¢åŠ ã€å»¶è¿Ÿå‡é«˜ï¼š</p>
<ul>
<li>å·¥å…·å®šä¹‰ä½¿ä¸Šä¸‹æ–‡çª—å£ï¼ˆcontext windowï¼‰è´Ÿè½½è¿‡é«˜ï¼›</li>
<li>å·¥å…·ä¸­é—´ç»“æœæ¶ˆè€—é¢å¤–çš„ä»¤ç‰Œã€‚</li>
</ul>
<h3 data-id="heading-2">1.  å·¥å…·å®šä¹‰ä½¿ä¸Šä¸‹æ–‡çª—å£è´Ÿè½½è¿‡é«˜</h3>
<p>å¤§å¤šæ•° MCP å®¢æˆ·ç«¯ä¼šå°†æ‰€æœ‰å·¥å…·å®šä¹‰æå‰ç›´æ¥åŠ è½½åˆ°ä¸Šä¸‹æ–‡ä¸­ï¼Œå¹¶é€šè¿‡ç›´æ¥å·¥å…·è°ƒç”¨è¯­æ³•å°†è¿™äº›å®šä¹‰æä¾›ç»™æ¨¡å‹ã€‚è¿™äº›å·¥å…·å®šä¹‰å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-text" lang="text">gdrive.getDocument
     Description: Retrieves a document from Google Drive
     Parameters:
                documentId (required, string): The ID of the document to retrieve
                fields (optional, string): Specific fields to return
     Returns: Document object with title, body content, metadata, permissions, etc.
</code></pre>
<pre><code class="hljs language-text" lang="text">salesforce.updateRecord
    Description: Updates a record in Salesforce
    Parameters:
               objectType (required, string): Type of Salesforce object (Lead, Contact,      Account, etc.)
               recordId (required, string): The ID of the record to update
               data (required, object): Fields to update with their new values
     Returns: Updated record object with confirmation
</code></pre>
<p>å·¥å…·æè¿°å ç”¨è¿‡å¤šä¸Šä¸‹æ–‡çª—å£ç©ºé—´ï¼Œå¯¼è‡´å“åº”æ—¶é—´å»¶é•¿ã€æˆæœ¬å¢åŠ ã€‚å½“æ™ºèƒ½ä½“ï¼ˆAgentï¼‰è¿æ¥äº†æ•°åƒä¸ªå·¥å…·æ—¶ï¼Œå…¶åœ¨è¯»å–è¯·æ±‚ä¹‹å‰ï¼Œå°±éœ€è¦å¤„ç†æ•°åä¸‡ä¸ªtokenã€‚</p>
<h3 data-id="heading-3">2. å·¥å…·ä¸­é—´ç»“æœæ¶ˆè€—é¢å¤–token</h3>
<p>å¤§å¤šæ•°æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰å®¢æˆ·ç«¯å…è®¸æ¨¡å‹ç›´æ¥è°ƒç”¨ MCP å·¥å…·ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½ä¼šå‘æ™ºèƒ½ä½“ï¼ˆAgentï¼‰ä¸‹è¾¾æŒ‡ä»¤ï¼šâ€œä»è°·æ­Œäº‘ç«¯ç¡¬ç›˜ï¼ˆGoogle Driveï¼‰ä¸‹è½½æˆ‘çš„ä¼šè®®è®°å½•ï¼Œå¹¶å°†å…¶é™„åŠ åˆ° Salesforce æ½œåœ¨å®¢æˆ·çš„ä¿¡æ¯ä¸­ã€‚â€
æ­¤æ—¶æ¨¡å‹ä¼šå‘èµ·å¦‚ä¸‹è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-text" lang="text">TOOL CALL: gdrive.getDocument(documentId: "abc123")
        â†’ returns "Discussed Q4 goals...\n[full transcript text]"
           (loaded into model context)

TOOL CALL: salesforce.updateRecord(
			objectType: "SalesMeeting",
			recordId: "00Q5f000001abcXYZ",
  			data: { "Notes": "Discussed Q4 goals...\n[full transcript text written out]" }
		)
		(model needs to write entire transcript into context again)
</code></pre>
<p>æ‰€æœ‰ä¸­é—´ç»“æœéƒ½å¿…é¡»ç»è¿‡æ¨¡å‹å¤„ç†ã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå®Œæ•´çš„ä¼šè®®è®°å½•ä¼šä¸¤æ¬¡æµè½¬ç»è¿‡æ¨¡å‹ã€‚å¯¹äºä¸€åœºæ—¶é•¿ 2 å°æ—¶çš„é”€å”®ä¼šè®®ï¼Œè¿™å¯èƒ½æ„å‘³ç€è¦é¢å¤–å¤„ç† 5 ä¸‡ä¸ªä»¤ç‰Œï¼ˆtokenï¼‰ã€‚è€Œå¯¹äºç¯‡å¹…æ›´é•¿çš„æ–‡æ¡£ï¼Œç”šè‡³å¯èƒ½è¶…å‡ºä¸Šä¸‹æ–‡çª—å£ï¼ˆcontext windowï¼‰çš„é™åˆ¶ï¼Œå¯¼è‡´æ•´ä¸ªå·¥ä½œæµç¨‹ä¸­æ–­ã€‚</p>
<p>å½“å¤„ç†å¤§å‹æ–‡æ¡£æˆ–å¤æ‚æ•°æ®ç»“æ„æ—¶ï¼Œæ¨¡å‹åœ¨å·¥å…·è°ƒç”¨ä¹‹é—´å¤åˆ¶æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œå‡ºç°é”™è¯¯çš„å¯èƒ½æ€§å¯èƒ½ä¼šæ›´é«˜ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/055f2bb936ac4ae397dcca7b166a380f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRnJlZUNvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212566&amp;x-signature=BMaTaKQVn7%2F%2BeYDI%2FjgAucnW4bY%3D" alt="1763604540827.png" loading="lazy"/></p>
<p>MCP å®¢æˆ·ç«¯ä¼šå°†å·¥å…·å®šä¹‰åŠ è½½åˆ°æ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£ï¼ˆcontext windowï¼‰ä¸­ï¼Œå¹¶åè°ƒä¸€ä¸ªæ¶ˆæ¯å¾ªç¯ï¼ˆmessage loopï¼‰â€”â€” åœ¨è¯¥å¾ªç¯ä¸­ï¼Œæ¯æ¬¡å·¥å…·è°ƒç”¨åŠç›¸åº”ç»“æœéƒ½ä¼šåœ¨æ“ä½œä¹‹é—´ä¼ é€’ç»™æ¨¡å‹ã€‚</p>
<h2 data-id="heading-4">äºŒã€ åŸºäºMCPçš„ä»£ç æ‰§è¡Œæå‡ä¸Šä¸‹æ–‡æ•ˆç‡</h2>
<p>éšç€ä»£ç æ‰§è¡Œç¯å¢ƒåœ¨æ™ºèƒ½ä½“ï¼ˆAgentï¼‰ä¸­çš„åº”ç”¨æ—¥ç›Šæ™®éï¼Œä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯å°† MCP æœåŠ¡å™¨ä»¥ä»£ç  API çš„å½¢å¼å‘ˆç°ï¼Œè€Œéç›´æ¥å·¥å…·è°ƒç”¨ã€‚æ™ºèƒ½ä½“éšåå¯é€šè¿‡ç¼–å†™ä»£ç ä¸ MCP æœåŠ¡å™¨äº¤äº’ã€‚è¯¥æ–¹æ¡ˆèƒ½åŒæ—¶è§£å†³ä¸Šè¿°ä¸¤å¤§ç—›ç‚¹ï¼šæ™ºèƒ½ä½“ä»…éœ€åŠ è½½æ‰€éœ€å·¥å…·ï¼Œå¹¶å¯åœ¨æ‰§è¡Œç¯å¢ƒä¸­å…ˆå¤„ç†æ•°æ®ï¼Œå†å°†ç»“æœè¿”å›ç»™æ¨¡å‹ã€‚</p>
<p>å®ç°æ–¹å¼æœ‰å¤šç§ï¼Œå…¶ä¸­ä¸€ç§æ˜¯ä»å·²è¿æ¥çš„ MCP æœåŠ¡å™¨ç”Ÿæˆæ‰€æœ‰å¯ç”¨å·¥å…·çš„æ–‡ä»¶æ ‘ï¼ˆfile treeï¼‰ã€‚ä»¥ä¸‹æ˜¯åŸºäº TypeScript çš„å®ç°ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript">servers
â”œâ”€â”€ google-drive
â”‚   â”œâ”€â”€ getDocument.<span class="hljs-property">ts</span>
â”‚   â”œâ”€â”€ ... (other tools)
â”‚   â””â”€â”€ index.<span class="hljs-property">ts</span>
â”œâ”€â”€ salesforce
â”‚   â”œâ”€â”€ updateRecord.<span class="hljs-property">ts</span>
â”‚   â”œâ”€â”€ ... (other tools)
â”‚   â””â”€â”€ index.<span class="hljs-property">ts</span>
â””â”€â”€ ... (other servers)
</code></pre>
<p>éšåï¼Œæ¯ä¸ªå·¥å…·éƒ½å¯¹åº”ä¸€ä¸ªæ–‡ä»¶ï¼Œæ ¼å¼ç±»ä¼¼å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// ./servers/google-drive/getDocument.ts</span>
<span class="hljs-keyword">import</span> { callMCPTool } <span class="hljs-keyword">from</span> <span class="hljs-string">"../../../client.js"</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">GetDocumentInput</span> {
  <span class="hljs-attr">documentId</span>: <span class="hljs-built_in">string</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">GetDocumentResponse</span> {
  <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span>;
}

<span class="hljs-comment">/* Read a document from Google Drive */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getDocument</span>(<span class="hljs-params">input: GetDocumentInput</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">GetDocumentResponse</span>&gt; {
  <span class="hljs-keyword">return</span> callMCPTool&lt;<span class="hljs-title class_">GetDocumentResponse</span>&gt;(<span class="hljs-string">'google_drive__get_document'</span>, input);
}

</code></pre>
<p>æˆ‘ä»¬ä¸Šæ–‡æåˆ°çš„ â€œä»è°·æ­Œäº‘ç«¯ç¡¬ç›˜ï¼ˆGoogle Driveï¼‰åˆ° Salesforceâ€ çš„ç¤ºä¾‹ï¼Œä¼šè½¬åŒ–ä¸ºå¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// Read transcript from Google Docs and add to Salesforce prospect</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> gdrive <span class="hljs-keyword">from</span> <span class="hljs-string">'./servers/google-drive'</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> salesforce <span class="hljs-keyword">from</span> <span class="hljs-string">'./servers/salesforce'</span>;

<span class="hljs-keyword">const</span> transcript = (<span class="hljs-keyword">await</span> gdrive.<span class="hljs-title function_">getDocument</span>({ <span class="hljs-attr">documentId</span>: <span class="hljs-string">'abc123'</span> })).<span class="hljs-property">content</span>;
<span class="hljs-keyword">await</span> salesforce.<span class="hljs-title function_">updateRecord</span>({
  <span class="hljs-attr">objectType</span>: <span class="hljs-string">'SalesMeeting'</span>,
  <span class="hljs-attr">recordId</span>: <span class="hljs-string">'00Q5f000001abcXYZ'</span>,
  <span class="hljs-attr">data</span>: { <span class="hljs-title class_">Notes</span>: transcript }
});
</code></pre>
<p>æ™ºèƒ½ä½“ï¼ˆAgentï¼‰é€šè¿‡éå†æ–‡ä»¶ç³»ç»Ÿå‘ç°å·¥å…·ï¼šå…ˆåˆ—å‡º ./servers/ ç›®å½•ä»¥æŸ¥æ‰¾å¯ç”¨æœåŠ¡å™¨ï¼ˆå¦‚ google-drive å’Œ salesforceï¼‰ï¼Œå†è¯»å–å®Œæˆä»»åŠ¡æ‰€éœ€çš„ç‰¹å®šå·¥å…·æ–‡ä»¶ï¼ˆå¦‚ getDocument.ts å’Œ updateRecord.tsï¼‰ï¼Œä»è€Œäº†è§£æ¯ä¸ªå·¥å…·çš„æ¥å£ã€‚è¿™ç§æ–¹å¼èƒ½è®©æ™ºèƒ½ä½“ä»…åŠ è½½å½“å‰ä»»åŠ¡æ‰€éœ€çš„å·¥å…·å®šä¹‰ï¼Œå°†ä»¤ç‰Œï¼ˆtokenï¼‰ç”¨é‡ä» 15 ä¸‡ä¸ªå‡å°‘è‡³ 2000 ä¸ª â€”â€” æ—¶é—´ä¸æˆæœ¬èŠ‚çœç‡é«˜è¾¾ 98.7%ã€‚
Cloudflareä¹Ÿå‘å¸ƒäº†ç±»ä¼¼ç ”ç©¶ç»“æœï¼Œå¹¶å°†åŸºäº MCPçš„ä»£ç æ‰§è¡Œç§°ä¸º â€œä»£ç æ¨¡å¼ï¼ˆCode Modeï¼‰â€ã€‚å…¶æ ¸å¿ƒæ€è·¯ä¸€è‡´ï¼šå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æ“…é•¿ç¼–å†™ä»£ç ï¼Œå¼€å‘è€…åº”åˆ©ç”¨è¿™ä¸€ä¼˜åŠ¿ï¼Œæ„å»ºèƒ½æ›´é«˜æ•ˆä¸ MCP æœåŠ¡å™¨äº¤äº’çš„æ™ºèƒ½ä½“ã€‚</p>
<h2 data-id="heading-5">ä¸‰ã€ åŸºäºMCPçš„ä»£ç æ‰§è¡Œä¼˜åŠ¿</h2>
<p>é€šè¿‡åŸºäºMCPçš„ä»£ç æ‰§è¡Œï¼Œæ™ºèƒ½ä½“ï¼ˆAgentï¼‰å¯æŒ‰éœ€åŠ è½½å·¥å…·ã€åœ¨æ•°æ®ä¼ é€’è‡³æ¨¡å‹å‰è¿›è¡Œç­›é€‰ã€å¹¶é€šè¿‡å•æ­¥æ‰§è¡Œå¤æ‚é€»è¾‘ï¼Œä»è€Œæ›´é«˜æ•ˆåœ°åˆ©ç”¨ä¸Šä¸‹æ–‡ã€‚æ­¤å¤–ï¼Œè¯¥æ–¹å¼åœ¨å®‰å…¨æ€§ä¸çŠ¶æ€ç®¡ç†æ–¹é¢ä¹Ÿå…·å¤‡ä¼˜åŠ¿ã€‚</p>
<h3 data-id="heading-6">1. æ¸è¿›å¼ä¿¡æ¯æŠ«éœ²ï¼ˆProgressive Disclosureï¼‰</h3>
<p>å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰åœ¨æ–‡ä»¶ç³»ç»Ÿå¯¼èˆªæ–¹é¢è¡¨ç°å‡ºè‰²ã€‚å°†å·¥å…·ä»¥ä»£ç å½¢å¼å‘ˆç°åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œèƒ½è®©æ¨¡å‹æŒ‰éœ€è¯»å–å·¥å…·å®šä¹‰ï¼Œè€Œéä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰å®šä¹‰ã€‚
æ­¤å¤–ï¼Œè¿˜å¯åœ¨æœåŠ¡å™¨ä¸­æ·»åŠ  search_tools å·¥å…·ï¼ˆå·¥å…·æœç´¢åŠŸèƒ½ï¼‰ä»¥æŸ¥æ‰¾ç›¸å…³å®šä¹‰ã€‚ä¾‹å¦‚ï¼Œåœ¨ä½¿ç”¨å‰æ–‡æåŠçš„å‡è®¾æ€§ Salesforce æœåŠ¡å™¨æ—¶ï¼Œæ™ºèƒ½ä½“å¯æœç´¢ â€œsalesforceâ€ å…³é”®è¯ï¼Œä»…åŠ è½½å½“å‰ä»»åŠ¡æ‰€éœ€çš„å·¥å…·ã€‚åœ¨ search_tools å·¥å…·ä¸­åŠ å…¥ â€œç»†èŠ‚çº§åˆ«å‚æ•°â€ï¼ˆdetail level parameterï¼‰ï¼Œèƒ½è®©æ™ºèƒ½ä½“é€‰æ‹©æ‰€éœ€çš„ä¿¡æ¯è¯¦ç»†ç¨‹åº¦ï¼ˆå¦‚ä»…åç§°ã€åç§°ä¸æè¿°ã€æˆ–åŒ…å«æ¨¡å¼å®šä¹‰çš„å®Œæ•´å·¥å…·å®šä¹‰ï¼‰ï¼Œè¿™åŒæ ·æœ‰åŠ©äºæ™ºèƒ½ä½“èŠ‚çœä¸Šä¸‹æ–‡èµ„æºã€é«˜æ•ˆå®šä½å·¥å…·ã€‚</p>
<h3 data-id="heading-7">2. ä¸Šä¸‹æ–‡é«˜æ•ˆçš„å·¥å…·ç»“æœï¼ˆContext Efficient Tool Resultsï¼‰</h3>
<p>å¤„ç†å¤§å‹æ•°æ®é›†æ—¶ï¼Œæ™ºèƒ½ä½“å¯åœ¨ä»£ç ä¸­å…ˆå¯¹ç»“æœè¿›è¡Œç­›é€‰ä¸è½¬æ¢ï¼Œå†å°†å…¶è¿”å›ç»™æ¨¡å‹ã€‚ä»¥è·å–åŒ…å« 1 ä¸‡è¡Œæ•°æ®çš„ç”µå­è¡¨æ ¼ï¼ˆspreadsheetï¼‰ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// Without code execution - all rows flow through context</span>
<span class="hljs-variable constant_">TOOL</span> <span class="hljs-attr">CALL</span>: gdrive.<span class="hljs-title function_">getSheet</span>(<span class="hljs-attr">sheetId</span>: <span class="hljs-string">'abc123'</span>)
        â†’ returns <span class="hljs-number">10</span>,<span class="hljs-number">000</span> rows <span class="hljs-keyword">in</span> context to filter manually

<span class="hljs-comment">// With code execution - filter in the execution environment</span>
<span class="hljs-keyword">const</span> allRows = <span class="hljs-keyword">await</span> gdrive.<span class="hljs-title function_">getSheet</span>({ <span class="hljs-attr">sheetId</span>: <span class="hljs-string">'abc123'</span> });
<span class="hljs-keyword">const</span> pendingOrders = allRows.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">row</span> =&gt;</span> 
  row[<span class="hljs-string">"Status"</span>] === <span class="hljs-string">'pending'</span>
);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Found <span class="hljs-subst">${pendingOrders.length}</span> pending orders`</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(pendingOrders.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>)); <span class="hljs-comment">// Only log first 5 for review</span>
</code></pre>
<p>æ™ºèƒ½ä½“ï¼ˆAgentï¼‰çœ‹åˆ°çš„å°†æ˜¯ 5 è¡Œæ•°æ®ï¼Œè€Œé 10000 è¡Œã€‚ç±»ä¼¼é€»è¾‘åŒæ ·é€‚ç”¨äºæ•°æ®èšåˆã€å¤šæ•°æ®æºå…³è”æˆ–ç‰¹å®šå­—æ®µæå–â€”â€” æ‰€æœ‰è¿™äº›æ“ä½œéƒ½ä¸ä¼šå¯¼è‡´ä¸Šä¸‹æ–‡çª—å£ï¼ˆcontext windowï¼‰è‡ƒè‚¿ã€‚</p>
<h3 data-id="heading-8">3. æ›´å¼ºå¤§ä¸”ä¸Šä¸‹æ–‡é«˜æ•ˆçš„æ§åˆ¶æµï¼ˆControl Flowï¼‰</h3>
<p>å¾ªç¯ï¼ˆLoopsï¼‰ã€æ¡ä»¶åˆ¤æ–­ï¼ˆconditionalsï¼‰å’Œé”™è¯¯å¤„ç†ï¼ˆerror handlingï¼‰å¯é€šè¿‡å¸¸ç”¨çš„ä»£ç æ¨¡å¼å®ç°ï¼Œæ— éœ€ä¸²è”å¤šä¸ªç‹¬ç«‹çš„å·¥å…·è°ƒç”¨ã€‚ä¾‹å¦‚ï¼Œè‹¥éœ€åœ¨ Slack ä¸­å‘é€éƒ¨ç½²é€šçŸ¥ï¼Œæ™ºèƒ½ä½“å¯ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">let</span> found = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">while</span> (!found) {
  <span class="hljs-keyword">const</span> messages = <span class="hljs-keyword">await</span> slack.<span class="hljs-title function_">getChannelHistory</span>({ <span class="hljs-attr">channel</span>: <span class="hljs-string">'C123456'</span> });
  found = messages.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> m.<span class="hljs-property">text</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'deployment complete'</span>));
  <span class="hljs-keyword">if</span> (!found) <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(r, <span class="hljs-number">5000</span>));
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Deployment notification received'</span>);
</code></pre>
<p>è¯¥æ–¹å¼æ¯”åœ¨æ™ºèƒ½ä½“ï¼ˆAgentï¼‰å¾ªç¯ä¸­äº¤æ›¿æ‰§è¡Œ MCP å·¥å…·è°ƒç”¨ä¸ç¡çœ å‘½ä»¤ï¼ˆsleep commandsï¼‰æ›´é«˜æ•ˆã€‚
æ­¤å¤–ï¼Œèƒ½å¤Ÿç¼–å†™å¯æ‰§è¡Œçš„æ¡ä»¶åˆ†æ”¯æ ‘ï¼ˆconditional treeï¼‰ï¼Œè¿˜èƒ½å‡å°‘ â€œé¦–ä»¤ç‰Œå“åº”æ—¶é—´â€ï¼ˆtime to first tokenï¼‰å»¶è¿Ÿï¼šæ— éœ€ç­‰å¾…æ¨¡å‹è¯„ä¼°æ¡ä»¶è¯­å¥ï¼ˆif-statementï¼‰ï¼Œæ™ºèƒ½ä½“å¯å°†è¯¥ä»»åŠ¡äº¤ç”±ä»£ç æ‰§è¡Œç¯å¢ƒå®Œæˆã€‚</p>
<h3 data-id="heading-9">4. éšç§ä¿æŠ¤å‹æ“ä½œï¼ˆPrivacy-preserving operationsï¼‰</h3>
<p>å½“æ™ºèƒ½ä½“é€šè¿‡ MCP æ‰§è¡Œä»£ç æ—¶ï¼Œä¸­é—´ç»“æœé»˜è®¤ä¿ç•™åœ¨æ‰§è¡Œç¯å¢ƒä¸­ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæ™ºèƒ½ä½“ä»…èƒ½è·å–ä½ æ˜ç¡®è®°å½•ï¼ˆlogï¼‰æˆ–è¿”å›çš„æ•°æ® â€”â€” è¿™æ„å‘³ç€ï¼Œä½ ä¸å¸Œæœ›ä¸æ¨¡å‹å…±äº«çš„æ•æ„Ÿæ•°æ®å¯åœ¨å·¥ä½œæµä¸­æµè½¬ï¼Œä¸”å§‹ç»ˆä¸ä¼šè¿›å…¥æ¨¡å‹çš„ä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰ã€‚</p>
<p>å¯¹äºæ•æ„Ÿåº¦æ›´é«˜çš„ä»»åŠ¡åœºæ™¯ï¼Œæ™ºèƒ½ä½“æ¡†æ¶ï¼ˆagent harnessï¼‰å¯è‡ªåŠ¨å¯¹æ•æ„Ÿæ•°æ®è¿›è¡Œä»¤ç‰ŒåŒ–å¤„ç†ï¼ˆtokenize sensitive dataï¼‰ã€‚ä¾‹å¦‚ï¼Œè‹¥éœ€å°†ç”µå­è¡¨æ ¼ï¼ˆspreadsheetï¼‰ä¸­çš„å®¢æˆ·è”ç³»æ–¹å¼å¯¼å…¥ Salesforceï¼Œæ™ºèƒ½ä½“å°†ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">const</span> sheet = <span class="hljs-keyword">await</span> gdrive.<span class="hljs-title function_">getSheet</span>({ <span class="hljs-attr">sheetId</span>: <span class="hljs-string">'abc123'</span> });
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> row <span class="hljs-keyword">of</span> sheet.<span class="hljs-property">rows</span>) {
  <span class="hljs-keyword">await</span> salesforce.<span class="hljs-title function_">updateRecord</span>({
    <span class="hljs-attr">objectType</span>: <span class="hljs-string">'Lead'</span>,
    <span class="hljs-attr">recordId</span>: row.<span class="hljs-property">salesforceId</span>,
    <span class="hljs-attr">data</span>: { 
      <span class="hljs-title class_">Email</span>: row.<span class="hljs-property">email</span>,
      <span class="hljs-title class_">Phone</span>: row.<span class="hljs-property">phone</span>,
      <span class="hljs-title class_">Name</span>: row.<span class="hljs-property">name</span>
    }
  });
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Updated <span class="hljs-subst">${sheet.rows.length}</span> leads`</span>);
</code></pre>
<p>MCPå®¢æˆ·ç«¯ä¼šæ‹¦æˆªæ•°æ®ï¼Œå¹¶åœ¨æ•°æ®ä¼ é€’è‡³æ¨¡å‹å‰ï¼Œå¯¹ä¸ªäººèº«ä»½ä¿¡æ¯ï¼ˆPIIï¼‰è¿›è¡Œä»¤ç‰ŒåŒ–å¤„ç†ï¼ˆtokenizeï¼‰ã€‚</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// What the agent would see, if it logged the sheet.rows:</span>
[
  { <span class="hljs-attr">salesforceId</span>: <span class="hljs-string">'00Q...'</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">'[EMAIL_1]'</span>, <span class="hljs-attr">phone</span>: <span class="hljs-string">'[PHONE_1]'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'[NAME_1]'</span> },
  { <span class="hljs-attr">salesforceId</span>: <span class="hljs-string">'00Q...'</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">'[EMAIL_2]'</span>, <span class="hljs-attr">phone</span>: <span class="hljs-string">'[PHONE_2]'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'[NAME_2]'</span> },
  ...
]
</code></pre>
<p>éšåï¼Œå½“è¯¥æ•°æ®åœ¨å¦ä¸€æ¬¡ MCP å·¥å…·è°ƒç”¨ä¸­è¢«å…±äº«æ—¶ï¼ŒMCP å®¢æˆ·ç«¯ä¼šé€šè¿‡æŸ¥æ‰¾æ˜ å°„å…³ç³»å¯¹å…¶è¿›è¡Œè§£ä»¤ç‰ŒåŒ–å¤„ç†ï¼ˆuntokenizeï¼‰ã€‚çœŸå®çš„ç”µå­é‚®ç®±åœ°å€ã€ç”µè¯å·ç å’Œå§“åä¼šä»è°·æ­Œè¡¨æ ¼ï¼ˆGoogle Sheetsï¼‰æµè½¬è‡³ Salesforceï¼Œä½†å…¨ç¨‹ä¸ä¼šç»è¿‡æ¨¡å‹ã€‚è¿™èƒ½é˜²æ­¢æ™ºèƒ½ä½“ï¼ˆAgentï¼‰æ„å¤–è®°å½•æˆ–å¤„ç†æ•æ„Ÿæ•°æ®ã€‚ä½ è¿˜å¯ä»¥å€ŸåŠ©æ­¤åŠŸèƒ½å®šä¹‰ç¡®å®šæ€§å®‰å…¨è§„åˆ™ï¼ˆdeterministic security rulesï¼‰ï¼ŒæŒ‡å®šæ•°æ®çš„å¯æµå…¥å’Œæµå‡ºè·¯å¾„ã€‚</p>
<h3 data-id="heading-10">5. çŠ¶æ€æŒä¹…åŒ–ä¸æŠ€èƒ½æ‰©å±•ï¼ˆState persistence and skillsï¼‰</h3>
<p>å…·å¤‡æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒé™çš„ä»£ç æ‰§è¡Œèƒ½åŠ›ï¼Œè®©æ™ºèƒ½ä½“èƒ½å¤Ÿåœ¨å¤šä¸ªæ“ä½œä¹‹é—´ç»´æŒçŠ¶æ€ï¼ˆmaintain stateï¼‰ã€‚æ™ºèƒ½ä½“å¯å°†ä¸­é—´ç»“æœå†™å…¥æ–‡ä»¶ï¼Œä»è€Œæ”¯æŒæ¢å¤å·¥ä½œè¿›åº¦ï¼ˆresume workï¼‰å’Œè·Ÿè¸ªä»»åŠ¡è¿›å±•ï¼ˆtrack progressï¼‰ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-keyword">const</span> leads = <span class="hljs-keyword">await</span> salesforce.<span class="hljs-title function_">query</span>({ 
  <span class="hljs-attr">query</span>: <span class="hljs-string">'SELECT Id, Email FROM Lead LIMIT 1000'</span> 
});
<span class="hljs-keyword">const</span> csvData = leads.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">l</span> =&gt;</span> <span class="hljs-string">`<span class="hljs-subst">${l.Id}</span>,<span class="hljs-subst">${l.Email}</span>`</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">'\n'</span>);
<span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">writeFile</span>(<span class="hljs-string">'./workspace/leads.csv'</span>, csvData);

<span class="hljs-comment">// Later execution picks up where it left off</span>
<span class="hljs-keyword">const</span> saved = <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">'./workspace/leads.csv'</span>, <span class="hljs-string">'utf-8'</span>);
</code></pre>
<p>æ™ºèƒ½ä½“ï¼ˆAgentï¼‰è¿˜èƒ½å°†è‡ªèº«ä»£ç æŒä¹…åŒ–ä¸ºå¯å¤ç”¨å‡½æ•°ï¼ˆreusable functionsï¼‰ã€‚ä¸€æ—¦æ™ºèƒ½ä½“å¼€å‘å‡ºå¯å®ŒæˆæŸé¡¹ä»»åŠ¡çš„å¯ç”¨ä»£ç ï¼Œä¾¿å¯å°†è¯¥å®ç°æ–¹æ¡ˆä¿å­˜èµ·æ¥ï¼Œä»¥å¤‡åç»­ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// In ./skills/save-sheet-as-csv.ts</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> gdrive <span class="hljs-keyword">from</span> <span class="hljs-string">'./servers/google-drive'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">saveSheetAsCsv</span>(<span class="hljs-params">sheetId: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> gdrive.<span class="hljs-title function_">getSheet</span>({ sheetId });
  <span class="hljs-keyword">const</span> csv = data.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">row</span> =&gt;</span> row.<span class="hljs-title function_">join</span>(<span class="hljs-string">','</span>)).<span class="hljs-title function_">join</span>(<span class="hljs-string">'\n'</span>);
  <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">writeFile</span>(<span class="hljs-string">`./workspace/sheet-<span class="hljs-subst">${sheetId}</span>.csv`</span>, csv);
  <span class="hljs-keyword">return</span> <span class="hljs-string">`./workspace/sheet-<span class="hljs-subst">${sheetId}</span>.csv`</span>;
}

<span class="hljs-comment">// Later, in any agent execution:</span>
<span class="hljs-keyword">import</span> { saveSheetAsCsv } <span class="hljs-keyword">from</span> <span class="hljs-string">'./skills/save-sheet-as-csv'</span>;
<span class="hljs-keyword">const</span> csvPath = <span class="hljs-keyword">await</span> <span class="hljs-title function_">saveSheetAsCsv</span>(<span class="hljs-string">'abc123'</span>);
</code></pre>
<p>è¿™ä¸ â€œæŠ€èƒ½ï¼ˆSkillsï¼‰â€ æ¦‚å¿µç´§å¯†ç›¸å…³ â€”â€”â€œæŠ€èƒ½â€ æŒ‡åŒ…å«å¯å¤ç”¨æŒ‡ä»¤ã€è„šæœ¬å’Œèµ„æºçš„æ–‡ä»¶å¤¹ï¼Œä¾›æ¨¡å‹ç”¨äºæå‡ç‰¹å®šä»»åŠ¡çš„æ‰§è¡Œæ€§èƒ½ã€‚åœ¨è¿™äº›å·²ä¿å­˜çš„å‡½æ•°ä¸­æ·»åŠ ä¸€ä¸ª SKILL.md æ–‡ä»¶ï¼Œå³å¯åˆ›å»ºç»“æ„åŒ–çš„æŠ€èƒ½æ¨¡å—ï¼Œä¾›æ¨¡å‹å‚è€ƒå’Œä½¿ç”¨ã€‚é•¿æ­¤ä»¥å¾€ï¼Œä½ çš„æ™ºèƒ½ä½“ï¼ˆAgentï¼‰å°†èƒ½æ„å»ºä¸€ä¸ªåŒ…å«æ›´é«˜çº§èƒ½åŠ›çš„ â€œå·¥å…·ç®±â€ï¼Œé€æ­¥å®Œå–„é«˜æ•ˆå·¥ä½œæ‰€éœ€çš„åŸºç¡€æ¶æ„ã€‚</p>
<p>éœ€æ³¨æ„çš„æ˜¯ï¼Œä»£ç æ‰§è¡Œä¹Ÿä¼šå¸¦æ¥å…¶è‡ªèº«çš„å¤æ‚æ€§ã€‚è¿è¡Œæ™ºèƒ½ä½“ç”Ÿæˆçš„ä»£ç ï¼Œéœ€è¦ä¸€ä¸ªå…·å¤‡é€‚å½“æ²™ç®±éš”ç¦»ï¼ˆsandboxingï¼‰ã€èµ„æºé™åˆ¶ï¼ˆresource limitsï¼‰å’Œç›‘æ§ï¼ˆmonitoringï¼‰åŠŸèƒ½çš„å®‰å…¨æ‰§è¡Œç¯å¢ƒã€‚è¿™äº›åŸºç¡€è®¾æ–½éœ€æ±‚ä¼šå¢åŠ è¿è¥å¼€é”€ï¼ŒåŒæ—¶å¸¦æ¥ç›´æ¥å·¥å…·è°ƒç”¨æ‰€æ— éœ€è€ƒè™‘çš„å®‰å…¨é—®é¢˜ã€‚å› æ­¤ï¼Œåœ¨é‡‡ç”¨ä»£ç æ‰§è¡Œæ–¹å¼æ—¶ï¼Œéœ€æƒè¡¡å…¶ä¼˜åŠ¿ï¼ˆé™ä½ä»¤ç‰Œæˆæœ¬ã€å‡å°‘å»¶è¿Ÿã€æå‡å·¥å…·ç»„åˆèƒ½åŠ›ï¼‰ä¸å®ç°æˆæœ¬ä¹‹é—´çš„å…³ç³»ã€‚</p>
<h2 data-id="heading-11">å››ã€æ€»ç»“</h2>
<p>æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰ä¸ºæ™ºèƒ½ä½“æä¾›äº†è¿æ¥ä¼—å¤šå·¥å…·ä¸ç³»ç»Ÿçš„åŸºç¡€åè®®ã€‚ç„¶è€Œï¼Œå½“è¿æ¥çš„æœåŠ¡å™¨æ•°é‡è¿‡å¤šæ—¶ï¼Œå·¥å…·å®šä¹‰ä¸ç»“æœä¼šæ¶ˆè€—è¿‡é‡ä»¤ç‰Œï¼ˆtokenï¼‰ï¼Œå¯¼è‡´æ™ºèƒ½ä½“æ•ˆç‡ä¸‹é™ã€‚
å°½ç®¡æœ¬æ–‡ä¸­æ¢è®¨çš„è¯¸å¤šé—®é¢˜ï¼ˆä¸Šä¸‹æ–‡ç®¡ç†ã€å·¥å…·ç»„åˆã€çŠ¶æ€æŒä¹…åŒ–ï¼‰çœ‹ä¼¼æ–°é¢–ï¼Œä½†åœ¨è½¯ä»¶å·¥ç¨‹é¢†åŸŸæ—©å·²å­˜åœ¨æˆç†Ÿçš„è§£å†³æ–¹æ¡ˆã€‚ä»£ç æ‰§è¡Œå°†è¿™äº›æ—¢å®šæ¨¡å¼åº”ç”¨äºæ™ºèƒ½ä½“ï¼Œä½¿å…¶èƒ½å¤Ÿé€šè¿‡ç†Ÿæ‚‰çš„ç¼–ç¨‹ç»“æ„ï¼Œæ›´é«˜æ•ˆåœ°ä¸ MCP æœåŠ¡å™¨äº¤äº’ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[react-grid-layout åŸç†æ‹†è§£ï¼šå¸ƒå±€å¼•æ“ã€æ‹–æ‹½ç³»ç»Ÿä¸å“åº”å¼è®¾è®¡]]></title>    <link>https://juejin.cn/post/7574584245110685747</link>    <guid>https://juejin.cn/post/7574584245110685747</guid>    <pubDate>2025-11-20T03:11:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574584245110685747" data-draft-id="7574584245109588019" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="react-grid-layout åŸç†æ‹†è§£ï¼šå¸ƒå±€å¼•æ“ã€æ‹–æ‹½ç³»ç»Ÿä¸å“åº”å¼è®¾è®¡"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,æ¶æ„"/> <meta itemprop="datePublished" content="2025-11-20T03:11:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒé¥ºå­ä¸åƒé¦…"/> <meta itemprop="url" content="https://juejin.cn/user/1148309742825495"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            react-grid-layout åŸç†æ‹†è§£ï¼šå¸ƒå±€å¼•æ“ã€æ‹–æ‹½ç³»ç»Ÿä¸å“åº”å¼è®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1148309742825495/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒé¥ºå­ä¸åƒé¦…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:11:13.000Z" title="Thu Nov 20 2025 03:11:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>react-grid-layout</code>æ˜¯ React ç”Ÿæ€ä¸­ä¸€ä¸ªéå¸¸æµè¡Œçš„ã€ç”¨äºæ„å»º<strong>å¯æ‹–æ‹½</strong>ã€<strong>å¯è°ƒæ•´å¤§å°</strong>ã€<strong>å“åº”å¼</strong>ç½‘æ ¼å¸ƒå±€çš„åº“ã€‚å®ƒçš„å¼ºå¤§ä¹‹å¤„åœ¨äºç”¨ç®€æ´çš„ API å®ç°äº†å¤æ‚çš„å¸ƒå±€ç®¡ç†ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ å¸ƒå±€ã€åæ ‡</h2>
<p><code>react-grid-layout</code>çš„å®ç°åŸºçŸ³åœ¨äºå®ƒå°†ç»„ä»¶çš„<strong>å®é™…å±å¹•ä½ç½®</strong>ä¸<strong>æŠ½è±¡çš„ç½‘æ ¼ä½ç½®</strong>å½»åº•åˆ†ç¦»</p>
<h3 data-id="heading-1">1. å¸ƒå±€æ•°ç»„</h3>
<p>ä¸ç›´æ¥å­˜å‚¨ç»„ä»¶çš„åƒç´ ä½ç½®ï¼Œè€Œæ˜¯ç»´æŠ¤ä¸€ä¸ªåä¸º <code>layout</code> çš„ JavaScript å¯¹è±¡æ•°ç»„</p>
<p>æ¯ä¸ªå…ƒç´ ï¼ˆitemï¼‰åœ¨å¸ƒå±€æ•°ç»„ä¸­éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å…³é”®å±æ€§ï¼š</p>








































<table><thead><tr><th><strong>å±æ€§</strong></th><th><strong>ç±»å‹</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td><code>i</code></td><td>String</td><td>å…ƒç´ çš„å”¯ä¸€ IDï¼Œå¯¹åº”äºå…¶ <code>key</code> æˆ–å­ç»„ä»¶çš„ <code>key</code>ã€‚</td></tr><tr><td><code>x</code></td><td>Number</td><td>å…ƒç´ åœ¨ç½‘æ ¼ä¸­çš„<strong>åˆ—</strong>èµ·å§‹åæ ‡ï¼ˆGrid Xï¼‰ã€‚</td></tr><tr><td><code>y</code></td><td>Number</td><td>å…ƒç´ åœ¨ç½‘æ ¼ä¸­çš„<strong>è¡Œ</strong>èµ·å§‹åæ ‡ï¼ˆGrid Yï¼‰ã€‚</td></tr><tr><td><code>w</code></td><td>Number</td><td>å…ƒç´ çš„å®½åº¦ï¼Œå ç”¨çš„ç½‘æ ¼<strong>åˆ—æ•°</strong>ã€‚</td></tr><tr><td><code>h</code></td><td>Number</td><td>å…ƒç´ çš„é«˜åº¦ï¼Œå ç”¨çš„ç½‘æ ¼<strong>è¡Œæ•°</strong>ã€‚</td></tr><tr><td><code>static</code></td><td>Boolean</td><td>å¦‚æœä¸º <code>true</code>ï¼Œåˆ™å…ƒç´ ä¸å¯æ‹–æ‹½å’Œè°ƒæ•´å¤§å°ã€‚</td></tr></tbody></table>
<h3 data-id="heading-2">2. åæ ‡è½¬æ¢</h3>
<p>æ ¸å¿ƒé€»è¾‘åœ¨äºå°†ä¸Šè¿°æŠ½è±¡çš„ <code>(x, y, w, h)</code> ç½‘æ ¼åæ ‡<strong>å®æ—¶</strong>è½¬æ¢æˆæµè§ˆå™¨èƒ½ç†è§£çš„ <strong>CSS åƒç´ åæ ‡</strong></p>
<p>è¯¥è½¬æ¢ä¾èµ–äºä¸¤ä¸ªé…ç½®é¡¹ï¼š</p>
<ul>
<li><code>cols</code>: ç½‘æ ¼çš„æ€»åˆ—æ•°</li>
<li><code>rowHeight</code>: æ¯è¡Œç½‘æ ¼çš„é«˜åº¦ï¼ˆåƒç´ å€¼ï¼‰</li>
<li><code>margin</code>: ç½‘æ ¼é¡¹ä¹‹é—´çš„é—´éš”ï¼ˆåƒç´ å€¼ï¼‰</li>
</ul>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ItemÂ WidthÂ (px)</mtext><mo>=</mo><mo stretchy="false">(</mo><mi>w</mi><mo>Ã—</mo><mtext>CellÂ Width</mtext><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>w</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mtext>Margin</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Item Width (px)} = (w \times \text{Cell Width}) + ((w-1) \times \text{Margin})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">ItemÂ WidthÂ (px)</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">CellÂ Width</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">Margin</span></span><span class="mclose">)</span></span></span></span></span></p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>CellÂ Width</mtext><mo>=</mo><mfrac><mrow><mtext>ContainerÂ Width</mtext><mo>âˆ’</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mtext>Cols</mtext><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mtext>Margin</mtext><mo stretchy="false">)</mo></mrow><mtext>Cols</mtext></mfrac></mrow><annotation encoding="application/x-tex">\text{Cell Width} = \frac{\text{Container Width} - ((\text{Cols} + 1) \times \text{Margin})}{\text{Cols}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord text"><span class="mord">CellÂ Width</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.355em;vertical-align:-0.345em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Cols</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ContainerÂ Width</span></span><span class="mbin mtight">âˆ’</span><span class="mopen mtight">((</span><span class="mord text mtight"><span class="mord mtight">Cols</span></span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mbin mtight">Ã—</span><span class="mord text mtight"><span class="mord mtight">Margin</span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span></p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ItemÂ HeightÂ (px)</mtext><mo>=</mo><mo stretchy="false">(</mo><mi>h</mi><mo>Ã—</mo><mtext>RowÂ Height</mtext><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>h</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mtext>Margin</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Item Height (px)} = (h \times \text{Row Height}) + ((h-1) \times \text{Margin})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">ItemÂ HeightÂ (px)</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">RowÂ Height</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">((</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord text"><span class="mord">Margin</span></span><span class="mclose">)</span></span></span></span></span></p>
<p>åˆ©ç”¨è¿™äº›å…¬å¼è®¡ç®—æ¯ä¸ªç½‘æ ¼é¡¹çš„ <code>top</code>ã€<code>left</code>ã€<code>width</code> å’Œ <code>height</code>ï¼Œå¹¶é€šè¿‡ <strong>CSS <code>transform: translate(x, y)</code></strong> æ¥å®šä½ç»„ä»¶ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„ <code>top</code>/<code>left</code>ï¼Œè¿™èƒ½å¸¦æ¥æ›´å¥½çš„æ€§èƒ½ã€‚</p>
<h2 data-id="heading-3">äºŒã€ æ ¸å¿ƒç»„ä»¶ç»“æ„</h2>
<p>ä¸»è¦ç”±ä»¥ä¸‹ä¸‰ä¸ª React ç»„ä»¶æ„æˆï¼š</p>
<h3 data-id="heading-4">1. <code>ResponsiveReactGridLayout</code></h3>
<p>è¿™æ˜¯æœ€å¤–å±‚çš„å®¹å™¨ç»„ä»¶ã€‚å®ƒè´Ÿè´£å¤„ç†<strong>å“åº”å¼</strong>é€»è¾‘</p>
<ul>
<li>ç›‘å¬çª—å£å¤§å°å˜åŒ–ï¼ˆ<code>resize</code> äº‹ä»¶ï¼‰</li>
<li>æ ¹æ®å½“å‰çš„å®¹å™¨å®½åº¦ï¼Œç¡®å®šåº”è¯¥åŠ è½½å“ªä¸ª<strong>æ–­ç‚¹ï¼ˆBreakpointï¼‰</strong> ï¼ˆä¾‹å¦‚ï¼š<code>lg</code>, <code>md</code>, <code>sm</code> ç­‰ï¼‰</li>
<li>æ ¹æ®æ–­ç‚¹å’Œå…¶å¯¹åº”çš„ <code>layout</code> é…ç½®ï¼Œæ¸²æŸ“ <code>ReactGridLayout</code></li>
</ul>
<h3 data-id="heading-5">2. <code>ReactGridLayout</code></h3>
<p>è¿™æ˜¯ç½‘æ ¼æ¸²æŸ“çš„æ ¸å¿ƒç»„ä»¶ï¼Œå®ƒè´Ÿè´£ï¼š</p>
<ul>
<li>è®¡ç®—å’Œè®¾ç½®å®¹å™¨çš„æ€»é«˜åº¦ï¼ˆ<code>min-height</code>ï¼‰ï¼Œä»¥ç¡®ä¿æ‰€æœ‰ç½‘æ ¼é¡¹éƒ½èƒ½è¢«å®¹çº³ã€‚</li>
<li>å°† <code>layout</code> æ•°ç»„éå†ï¼Œä¸ºæ¯ä¸€ä¸ªç½‘æ ¼é¡¹æ¸²æŸ“ä¸€ä¸ª <code>GridItem</code>ã€‚</li>
<li>ç®¡ç†æ‹–æ‹½å’Œè°ƒæ•´å¤§å°æ“ä½œçš„çŠ¶æ€ï¼ˆ<strong>å½±å­/å ä½ç¬¦</strong>ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-6">3. <code>GridItem</code></h3>
<p>è¿™æ˜¯æ¯ä¸ªå¯æ‹–æ‹½/è°ƒæ•´å¤§å°çš„ç½‘æ ¼é¡¹çš„å®¹å™¨</p>
<ul>
<li>æ¸²æŸ“ä¸€ä¸ªå†…éƒ¨çš„ <code>div</code> æ¥åŒ…è£¹ç”¨æˆ·ä¼ å…¥çš„å­ç»„ä»¶</li>
<li>æ³¨å…¥<strong>æ‹–æ‹½å¥æŸ„</strong>å’Œ<strong>è°ƒæ•´å¤§å°å¥æŸ„</strong> ã€‚</li>
<li>é€šè¿‡ç›‘å¬é¼ æ ‡äº‹ä»¶ï¼ˆ<code>onMouseDown</code>/<code>onMouseMove</code>/<code>onMouseUp</code>ï¼‰å®ç°äº¤äº’</li>
</ul>
<h2 data-id="heading-7">ä¸‰ã€ æ‹–æ‹½å’Œè°ƒæ•´å¤§å°åŸç†</h2>
<p>æ‹–æ‹½å’Œè°ƒæ•´å¤§å°ä¾èµ–äºä¸¤ä¸ªåº“<strong>react-draggable</strong>ä¸<strong>react-resizable</strong></p>
<h3 data-id="heading-8">1. å ä½ç¬¦ä¸çŠ¶æ€ç®¡ç†</h3>
<p>å½“ç”¨æˆ·å¼€å§‹æ‹–æ‹½æˆ–è°ƒæ•´å¤§å°æ—¶ï¼Œä¸ä¼šç«‹å³æ›´æ–° <code>layout</code> çŠ¶æ€ï¼Œè€Œæ˜¯é€šè¿‡ä¸€ç§â€œå½±å­â€æœºåˆ¶æ¥ä¼˜åŒ–æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ</p>
<ul>
<li><strong>å ä½ç¬¦ï¼ˆPlaceholderï¼‰</strong> : ä¸€ä¸ªåŠé€æ˜çš„ã€ä¸å½“å‰æ“ä½œç½‘æ ¼é¡¹å…·æœ‰ç›¸åŒå°ºå¯¸çš„å…ƒç´ ä¼šå‡ºç°åœ¨å…¶ä¸‹æ–¹ï¼ŒæŒ‡ç¤ºæ“ä½œå®Œæˆåç½‘æ ¼é¡¹å°†å æ®çš„ä½ç½®</li>
<li><strong>æ“ä½œè¿‡ç¨‹</strong>: åœ¨ <code>onMouseMove</code> è¿‡ç¨‹ä¸­ï¼ŒRGL å®æ—¶è®¡ç®—é¼ æ ‡ä½ç½®å¯¹åº”çš„<strong>æ–°ç½‘æ ¼åæ ‡</strong> <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(new_x,Â new_y,Â new_w,Â new_h)</mtext></mrow><annotation encoding="application/x-tex">\text{(new\_x, new\_y, new\_w, new\_h)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"/><span class="mord text"><span class="mord">(new_x,Â new_y,Â new_w,Â new_h)</span></span></span></span></span></span>ï¼Œå¹¶æ›´æ–°å ä½ç¬¦çš„ä½ç½®</li>
<li><strong>æ“ä½œç»“æŸ</strong>: åªæœ‰åœ¨ <code>onMouseUp</code> é‡Šæ”¾æ—¶ï¼ŒRGL æ‰ä¼šè°ƒç”¨ <code>onLayoutChange</code>ï¼Œå°†æœ€ç»ˆçš„ç½‘æ ¼åæ ‡æ›´æ–°åˆ°çˆ¶ç»„ä»¶ä¸­</li>
</ul>
<h3 data-id="heading-9">2. ç½‘æ ¼å†²çªè§£å†³ç®—æ³•</h3>
<ol>
<li><strong>å†²çªæ£€æµ‹</strong>: æ£€æµ‹æ–°ä½ç½® <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Aâ€™</mtext></mrow><annotation encoding="application/x-tex">\text{A'}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord text"><span class="mord">Aâ€™</span></span></span></span></span></span> æ˜¯å¦ä¸ä»»ä½•å…¶ä»–ç½‘æ ¼é¡¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>B</mtext></mrow><annotation encoding="application/x-tex">\text{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord text"><span class="mord">B</span></span></span></span></span></span> å‘ç”ŸçŸ©å½¢é‡å ã€‚</li>
<li><strong>å‘ä¸‹æ¨</strong> : å¦‚æœå‘ç”Ÿå†²çªï¼Œä¼šå°è¯•å°† <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>B</mtext></mrow><annotation encoding="application/x-tex">\text{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord text"><span class="mord">B</span></span></span></span></span></span> ä»¥åŠä¸ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>B</mtext></mrow><annotation encoding="application/x-tex">\text{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord text"><span class="mord">B</span></span></span></span></span></span> å†²çªçš„å…¶ä»–ç½‘æ ¼é¡¹å‘ä¸‹ï¼ˆå¢å¤§ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>y</mtext></mrow><annotation encoding="application/x-tex">\text{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord text"><span class="mord">y</span></span></span></span></span></span> åæ ‡ï¼‰æ¨åŠ¨ï¼Œç›´åˆ°ä¸å†å‘ç”Ÿå†²çª</li>
<li><strong>ç´§å‡‘åŒ–</strong> : åœ¨æ¯æ¬¡å¸ƒå±€å˜åŒ–åï¼Œå¯ä»¥æ‰§è¡Œ Compaction ç®—æ³•ã€‚å®ƒä¼šå°è¯•å°†æ‰€æœ‰éé™æ€çš„ç½‘æ ¼é¡¹å‘ä¸Šï¼ˆå‡å° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>y</mtext></mrow><annotation encoding="application/x-tex">\text{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord text"><span class="mord">y</span></span></span></span></span></span> åæ ‡ï¼‰æˆ–å‘å·¦ï¼ˆå‡å° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>x</mtext></mrow><annotation encoding="application/x-tex">\text{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord text"><span class="mord">x</span></span></span></span></span></span> åæ ‡ï¼‰ç§»åŠ¨åˆ°å¯ç”¨çš„æœ€é«˜/æœ€å·¦ä½ç½®ï¼Œä»è€Œæ¶ˆé™¤ç½‘æ ¼ä¸­çš„ä¸å¿…è¦ç©ºç™½</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½ çš„å›¾æ ‡è¿˜åœ¨ç”¨ PNGï¼Ÿçœ‹å®Œè¿™ç¯‡ä½ å°±ä¼šæ¢æˆ iconfont]]></title>    <link>https://juejin.cn/post/7574568258800664603</link>    <guid>https://juejin.cn/post/7574568258800664603</guid>    <pubDate>2025-11-20T03:10:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574568258800664603" data-draft-id="7574357603406364722" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½ çš„å›¾æ ‡è¿˜åœ¨ç”¨ PNGï¼Ÿçœ‹å®Œè¿™ç¯‡ä½ å°±ä¼šæ¢æˆ iconfont"/> <meta itemprop="keywords" content="å‰ç«¯å·¥ç¨‹åŒ–"/> <meta itemprop="datePublished" content="2025-11-20T03:10:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¿‡æœŸçš„é¢åŒ…ç‰‡"/> <meta itemprop="url" content="https://juejin.cn/user/1978776660486157"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½ çš„å›¾æ ‡è¿˜åœ¨ç”¨ PNGï¼Ÿçœ‹å®Œè¿™ç¯‡ä½ å°±ä¼šæ¢æˆ iconfont
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1978776660486157/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¿‡æœŸçš„é¢åŒ…ç‰‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:10:08.000Z" title="Thu Nov 20 2025 03:10:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸ºä»€ä¹ˆä½¿ç”¨ iconfont å›¾æ ‡ï¼Ÿ</h2>
<p>å‰ç«¯å·¥ç¨‹å¸ˆé‡åˆ°å›¾æ ‡çš„æ—¶å€™é€šå¸¸ä¼šæœ‰ä¸¤ä¸ªååº”ï¼šä¸€æ˜¯â€œå¹²è„†åƒç´ å…šä¸€æ ·æŠŠ PNG å…¨éƒ½æå®šå§â€ï¼ŒäºŒæ˜¯â€œåˆè¦æ”¹å›¾å•¦ï¼Œå¿ƒç´¯â€ã€‚iconfont çš„å‡ºç°ï¼Œå°±æ˜¯ä¸ºäº†è®©æˆ‘ä»¬å°‘ç‚¹å¿ƒç´¯ã€å¤šç‚¹ç”Ÿäº§åŠ›ï¼ˆå’Œæ‚ é—²ï¼‰ã€‚</p>
<h3 data-id="heading-1">ç»Ÿä¸€ç®¡ç† â€”â€” ä¸è¦å†åˆ°å¤„æ‰¾å›¾äº†</h3>
<p>è®¾è®¡ç¨¿é‡Œç‚¹ç¼€çš„å°å›¾æ ‡å¾ˆå¤šæ—¶å€™çœ‹èµ·æ¥å¾®ä¸è¶³é“ï¼Œä½†å®ƒä»¬åˆ†æ•£åœ¨é¡¹ç›®å„å¤„æ—¶ï¼Œç®¡ç†èµ·æ¥æ¯”è¿½å‰§è¿˜å¤æ‚ã€‚ä¼ ç»Ÿåšæ³•å¤§æ¦‚æ˜¯ï¼š</p>
<ul>
<li>ä¸‹è½½å›¾æ ‡æ–‡ä»¶æ”¾ç›®å½•ï¼Œç„¶åç”¨ <code>&lt;img&gt;</code> æˆ– <code>background</code> å¼•å…¥ï¼›</li>
<li>ä¸ºäº†å‡å°‘ HTTP è¯·æ±‚ï¼ŒæŠŠå¾ˆå¤šå°å›¾æ‹¼æˆä¸€å¼ é›ªç¢§å›¾ï¼Œç”¨ <code>background-position</code> ç²¾ç¡®å®šä½æ˜¾ç¤ºã€‚</li>
</ul>
<p>è¿™ä¸¤ç§æ–¹æ³•éƒ½èƒ½è§£å†³é—®é¢˜ï¼Œä½†æ¯æ¬¡æ¢ä¸€ä¸ª icon å°±åƒç©æ‹¼å›¾ï¼šç”¨ <code>&lt;img&gt;</code> æ—¶ä¸æ•¢éšä¾¿æ›¿æ¢ï¼ˆæ€•åˆ«å¤„ä¹Ÿåœ¨ç”¨ï¼‰ï¼›ç”¨é›ªç¢§å›¾åˆ™å¾—é‡æ–°åˆ‡å›¾ã€æ”¹å®šä½ï¼Œéº»çƒ¦å¾—è¦å‘½ã€‚</p>
<p>ç”¨ iconfont çš„å¥½å¤„æ˜¯æŠŠå›¾æ ‡äº¤ç»™â€œå›¾æ ‡ç®¡ç†å¹³å°â€å»ç»´æŠ¤ï¼šä½ åªéœ€æŠŠéœ€è¦çš„ icon åŠ åˆ°é¡¹ç›®é‡Œï¼Œæ›´æ–°å›¾æ ‡åªè¦æ”¹ class æˆ– symbolï¼Œä¸ç”¨æŠŠæ•´ä¸ªé›ªç¢§å›¾ç ¸äº†é‡åšã€‚</p>
<h3 data-id="heading-2">çŸ¢é‡å›¾ â€”â€” æ”¾å¤§ä¹Ÿä¸æ‹–æ³¥å¸¦æ°´</h3>
<p>iconfont æœ¬è´¨ä¸Šæ˜¯çŸ¢é‡ï¼ˆfont æˆ– svgï¼‰ï¼Œå¯ä»¥æ— é™æ”¾å¤§è€Œä¸å¤±çœŸã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒPNG/JPG ä¸ºäº†ä¿è¯æ¸…æ™°åº¦å¸¸å¸¸è¦åˆ‡å‡ºæ›´é«˜åˆ†è¾¨ç‡çš„å›¾ï¼Œæ–‡ä»¶ä½“ç§¯å°±ä¼šè†¨èƒ€å¾—åƒå‘éœ‰çš„é¢åŒ…ã€‚</p>
<h3 data-id="heading-3">ä¸ä¼ ç»Ÿå›¾ç‰‡çš„ä¼˜ç‚¹ï¼ˆç®€æ˜ç‰ˆï¼‰</h3>
<ul>
<li>æ˜“äºå†…è”ï¼šå¯ä»¥åƒæ–‡å­—ä¸€æ ·æ”¾åœ¨è¡Œå†…ï¼Œä¸æŒ‰é’®ã€æ–‡å­—è‡ªç„¶å¯¹é½ï¼›</li>
<li>å¼ºç¼“å­˜ç­–ç•¥ï¼šå­—ä½“æ–‡ä»¶å¸¦ fingerprintï¼ˆå“ˆå¸Œï¼‰ï¼Œæ›´æ–°åèƒ½å¼ºåˆ¶åˆ·æ–°ï¼Œé¿å…ç¼“å­˜å‘ï¼›</li>
<li>æ˜“äºæ ·å¼åŒ–ï¼šç”¨ CSS æ§åˆ¶ <code>color</code>ã€<code>font-size</code>ã€<code>text-shadow</code> ç­‰ï¼Œhoverã€active è½»æ¾æå®šï¼›</li>
<li>å‡å°‘è¯·æ±‚æ¬¡æ•°ï¼šæ¯”èµ·æˆç™¾ä¸Šåƒçš„å›¾åƒè¯·æ±‚ï¼Œå­—ä½“/ç¬¦å·åªéœ€å‡ æ¬¡è¯·æ±‚ã€‚</li>
</ul>
<h3 data-id="heading-4">ä½¿ç”¨æ–¹å¼ï¼ˆæ‘˜è‡ªå®˜ç½‘å¹¶åšäº†ç‚¹å°é­”æ”¹ï¼‰</h3>
<p>ä¸‹é¢ä¸‰ç§å¸¸è§å¼•ç”¨æ–¹å¼å„æœ‰ä¾§é‡â€”â€”é€‰å“ªä¸ªï¼Œçœ‹ä½ çš„å…¼å®¹éœ€æ±‚å’Œå›¾æ ‡éœ€æ±‚ï¼ˆå•è‰²/å¤šè‰²ï¼‰ã€‚</p>
<h4 data-id="heading-5">Unicode å¼•ç”¨ï¼ˆå…¼å®¹æ€§æœ€å¼ºï¼‰</h4>
<p>ç‰¹ç‚¹ï¼šå…¼å®¹ IE6+ å’Œç°ä»£æµè§ˆå™¨ï¼Œåƒå­—ä½“ä¸€æ ·ä½¿ç”¨ï¼Œå¤§å°é¢œè‰²å¥½è°ƒæ•´ï¼Œä½†ç±»åè¯­ä¹‰ä¸æ˜æ˜¾ï¼ˆç›´æ¥å†™ç¼–ç ä¸å¤ªç›´è§‚ï¼‰ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<ol>
<li>æ‹·è´é¡¹ç›®ç”Ÿæˆçš„ <code>@font-face</code>ï¼š</li>
</ol>
<pre><code class="hljs language-css" lang="css">Â <span class="hljs-keyword">@font-face</span> {
Â  Â <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'iconfont'</span>;
Â  Â <span class="hljs-attribute">src</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">'iconfont.eot'</span>);
Â  Â <span class="hljs-attribute">src</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">'iconfont.eot?#iefix'</span>) <span class="hljs-built_in">format</span>(<span class="hljs-string">'embedded-opentype'</span>),
Â  Â  Â  Â  <span class="hljs-built_in">url</span>(<span class="hljs-string">'iconfont.woff'</span>) <span class="hljs-built_in">format</span>(<span class="hljs-string">'woff'</span>),
Â  Â  Â  Â  <span class="hljs-built_in">url</span>(<span class="hljs-string">'iconfont.ttf'</span>) <span class="hljs-built_in">format</span>(<span class="hljs-string">'truetype'</span>),
Â  Â  Â  Â  <span class="hljs-built_in">url</span>(<span class="hljs-string">'iconfont.svg#iconfont'</span>) <span class="hljs-built_in">format</span>(<span class="hljs-string">'svg'</span>);
Â }
</code></pre>
<ol>
<li>å®šä¹‰åŸºç¡€æ ·å¼ï¼š</li>
</ol>
<pre><code class="hljs language-css" lang="css">Â <span class="hljs-selector-class">.iconfont</span> {
Â  Â <span class="hljs-attribute">font-family</span>: <span class="hljs-string">"iconfont"</span> <span class="hljs-meta">!important</span>;
Â  Â <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;
Â  Â <span class="hljs-attribute">font-style</span>: normal;
Â  Â -webkit-<span class="hljs-attribute">font-smoothing</span>: antialiased;
Â  Â -webkit-text-stroke-<span class="hljs-attribute">width</span>: <span class="hljs-number">0.2px</span>;
Â  Â -moz-osx-<span class="hljs-attribute">font-smoothing</span>: grayscale;
Â }
</code></pre>
<ol>
<li>åœ¨é¡µé¢ä½¿ç”¨ï¼ˆç¤ºä¾‹ï¼‰ï¼š</li>
</ol>
<pre><code class="hljs language-ini" lang="ini">Â &lt;i <span class="hljs-attr">class</span>=<span class="hljs-string">"iconfont"</span>&gt;&amp;<span class="hljs-comment">#x33;&lt;/i&gt;</span>
</code></pre>
<blockquote>
<p>è¯´æ˜ï¼šæ–°ç‰ˆ iconfont æ”¯æŒå½©è‰²å­—ä½“å›¾æ ‡ï¼Œä½†åªåœ¨ç°ä»£æµè§ˆå™¨é‡Œç”Ÿæ•ˆã€‚</p>
</blockquote>
<h4 data-id="heading-6">Font-class å¼•ç”¨ï¼ˆè¯­ä¹‰æ¸…æ™°ï¼‰</h4>
<p>ç‰¹ç‚¹ï¼šç”¨ç±»åè¡¨ç¤ºæŸä¸ªå›¾æ ‡ï¼Œè¯­ä¹‰æ›´ç›´è§‚ï¼Œå…¼å®¹ IE8+ï¼Œæœ¬è´¨ä»æ˜¯å­—ä½“ï¼ˆå•è‰²ä¸ºä¸»ï¼‰ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<ol>
<li>å¼•å…¥å¹³å°ç»™ä½ çš„ CSS é“¾æ¥ï¼Œä¾‹å¦‚ï¼š</li>
</ol>
<pre><code class="hljs language-ini" lang="ini">Â &lt;link <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> href=<span class="hljs-string">"//at.alicdn.com/t/font_8d5l8fzk5b87iudi.css"</span>&gt;
</code></pre>
<ol>
<li>ä½¿ç”¨ç±»åï¼š</li>
</ol>
<pre><code class="hljs language-css" lang="css">Â &lt;<span class="hljs-selector-tag">i</span> class="iconfont <span class="hljs-attribute">icon</span>-xxx"&gt;&lt;/<span class="hljs-selector-tag">i</span>&gt;
</code></pre>
<blockquote>
<p>å¥½å¤„ï¼šå½“éœ€è¦æ›¿æ¢å›¾æ ‡æ—¶ï¼Œåªè¦æ”¹ç±»åå¯¹åº”çš„ unicode å³å¯ï¼Œæ— éœ€åœ¨ HTML é‡Œæ”¹ç¼–ç ã€‚</p>
</blockquote>
<h4 data-id="heading-7">Symbolï¼ˆSVG Symbolï¼‰å¼•ç”¨ï¼ˆæ¨èï¼ŒåŠŸèƒ½æœ€å¼ºï¼‰</h4>
<p>ç‰¹ç‚¹ï¼šæ”¯æŒå¤šè‰²ã€å…¼å®¹æ€§ IE9+ï¼Œæ›´çµæ´»ï¼Œæ˜¯æœªæ¥ä¸»æµã€‚å¹³å°æ¨èæ­¤æ–¹å¼ã€‚ä½†æ³¨æ„ï¼šSVG æ¸²æŸ“åœ¨æŸäº›è€è®¾å¤‡ä¸Šæ€§èƒ½å¯èƒ½ç•¥é€Šäºçº¯å­—ä½“ã€‚</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<ol>
<li>åœ¨å…¥å£å¼•å…¥ <code>iconfont.js</code>ï¼ˆä¸€æ¬¡å¼•å…¥å³å¯ï¼‰ï¼š</li>
</ol>
<pre><code class="hljs language-xml" lang="xml">Â <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"//at.alicdn.com/t/font_8d5l8fzk5b87iudi.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<ol>
<li>å…¨å±€åŠ ä¸€æ®µåŸºç¡€æ ·å¼ï¼š</li>
</ol>
<pre><code class="hljs language-xml" lang="xml">Â <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
Â <span class="hljs-selector-class">.icon</span> {
Â  Â <span class="hljs-attribute">width</span>: <span class="hljs-number">1em</span>;
Â  Â <span class="hljs-attribute">height</span>: <span class="hljs-number">1em</span>;
Â  Â <span class="hljs-attribute">vertical-align</span>: -<span class="hljs-number">0.15em</span>;
Â  Â fill: currentColor;
Â  Â <span class="hljs-attribute">overflow</span>: hidden;
Â }
Â </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<ol>
<li>ä½¿ç”¨æ–¹å¼ï¼š</li>
</ol>
<pre><code class="hljs language-ini" lang="ini">Â &lt;svg <span class="hljs-attr">class</span>=<span class="hljs-string">"icon"</span> aria-hidden=<span class="hljs-string">"true"</span>&gt;
Â  Â &lt;use xlink:<span class="hljs-attr">href</span>=<span class="hljs-string">"#icon-xxx"</span>&gt;&lt;/use&gt;
Â &lt;/svg&gt;
</code></pre>
<h3 data-id="heading-8">å®è·µå»ºè®®ï¼ˆæˆ‘çš„ä¸¤åˆ†é’±ï¼‰</h3>
<ul>
<li>å¦‚æœé¡¹ç›®æ²¡æœ‰å¾ˆè‹›åˆ»çš„è€æµè§ˆå™¨å…¼å®¹è¦æ±‚ï¼Œ<strong>ä¼˜å…ˆä½¿ç”¨ Symbolï¼ˆSVGï¼‰æ–¹å¼</strong>ã€‚ç®€å•ã€æ”¯æŒå¤šè‰²ï¼Œæ ·å¼çµæ´»ã€‚</li>
<li>å…¥å£åªéœ€å¼•å…¥ä¸€æ¬¡ <code>iconfont.js</code>ï¼›åœ¨éœ€è¦â€œå¹³é“ºå›¾æ ‡ä¾›é€‰æ‹©â€çš„åœºæ™¯ä¸‹ï¼Œå¯ä»¥ç”¨ DOM API æŠŠæ‰€æœ‰ symbol æ”¶é›†æˆåˆ—è¡¨ä¾›å±•ç¤ºæˆ–å…¥åº“ã€‚</li>
<li>ä¸Šä¼ å›¾æ ‡å‰è¯·éµå®ˆ iconfont ä¸Šä¼ è§„èŒƒï¼ˆå¹³å°æœ‰æ–‡æ¡£ï¼‰ã€‚ä¸Šä¼ åå»ºè®®æ‰‹åŠ¨å¾®è°ƒå›¾æ ‡åœ¨ç”»å¸ƒçš„ä½ç½®å’Œå¤§å°ï¼Œä¿è¯é€šè¿‡ <code>font-size</code> ç¼©æ”¾åæ˜¾ç¤ºæ­£å¸¸ã€‚</li>
<li>ç»å¤§å¤šæ•°å›¾æ ‡æ˜¯å•è‰²çš„ã€‚å¦‚æœä¸Šä¼ æ—¶ä¸å»è‰²ï¼Œä½¿ç”¨ <code>color</code> ä¿®æ”¹é¢œè‰²å¯èƒ½ä¼šå¤±æ•ˆ â€”â€” æ‰€ä»¥ç®¡ç†é¡µé¢ä¸Šåšå»è‰²æ“ä½œå¾ˆé‡è¦ã€‚</li>
</ul>
<p><strong>ç¤ºä¾‹ï¼šä» <code>iconfont.js</code> é‡Œå–å‡ºæ‰€æœ‰ symbol å¹¶ç”Ÿæˆå¯é€‰åˆ—è¡¨</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">Â <span class="hljs-keyword">const</span> symbols = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">"svg symbol"</span>));
Â <span class="hljs-keyword">const</span> svgList = symbols.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">s</span> =&gt;</span> ({
Â  Â <span class="hljs-attr">id</span>: s.<span class="hljs-property">id</span>,
Â  Â <span class="hljs-attr">viewBox</span>: s.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">"viewBox"</span>),
Â  Â <span class="hljs-attr">paths</span>: <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(s.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">"path"</span>)).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">"d"</span>)),
Â }));
Â <span class="hljs-keyword">const</span> icons = svgList.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^icon-/</span>, <span class="hljs-string">""</span>));
Â <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> icons;
</code></pre>
<h3 data-id="heading-9">å°ç»“ï¼ˆç»“å°¾å½©è›‹ï¼‰</h3>
<p>ç”¨ iconfont å°±åƒæŠŠå…¨ç«™å°å›¾æ ‡æ”¾è¿›ä¸€ä¸ªâ€œå›¾æ ‡è¶…å¸‚â€â€”â€”æ‰¾è´§æ›´å¿«ã€æ¢è´§æ›´æ–¹ä¾¿ã€æ‰“æŠ˜æ—¶ä¹Ÿä¸ä¼šæŠŠæ•´ä¸ªè´§æ¶ç ¸çƒ‚ã€‚é™¤éä½ æ‰§ç€äºæ¯ä¸ªå›¾éƒ½ç”¨ PNG æ‰‹å·¥æ‰“ç£¨ï¼ˆå¹¶ä¸”ä¹äºæ¯æ¬¡æ”¹å›¾éƒ½æ‰å¤´å‘ï¼‰ï¼Œå¦åˆ™ç»™ iconfont ä¸€ä¸ªæœºä¼šï¼Œå®ƒä¼šè®©ä½ åœ¨å›¾æ ‡é—®é¢˜ä¸Šå°‘æŒ å¤´ã€å¤šå–å’–å•¡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å·¥ç¨‹åŒ–æ ¸å¿ƒçŸ¥è¯†å…¨é¢è§£æ]]></title>    <link>https://juejin.cn/post/7574529034648092724</link>    <guid>https://juejin.cn/post/7574529034648092724</guid>    <pubDate>2025-11-20T03:17:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574529034648092724" data-draft-id="7574529034648076340" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å·¥ç¨‹åŒ–æ ¸å¿ƒçŸ¥è¯†å…¨é¢è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-11-20T03:17:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§çŸ¥é—²é—²i"/> <meta itemprop="url" content="https://juejin.cn/user/3799545205237111"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å·¥ç¨‹åŒ–æ ¸å¿ƒçŸ¥è¯†å…¨é¢è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3799545205237111/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§çŸ¥é—²é—²i
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:17:58.000Z" title="Thu Nov 20 2025 03:17:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€æ„å»ºå·¥å…·æ¼”è¿›ï¼šä»ä»»åŠ¡æ‰§è¡Œåˆ°æ¨¡å—åŒ–æ‰“åŒ…</h2>
<h3 data-id="heading-1">Gruntã€Gulpï¼šåŸºäºä»»åŠ¡è¿è¡Œçš„å·¥å…·</h3>
<p>Grunt å’Œ Gulp æ˜¯å‰ç«¯å·¥ç¨‹åŒ–æ—©æœŸçš„ä»£è¡¨æ€§å·¥å…·ï¼Œå®ƒä»¬çš„å·¥ä½œæ–¹å¼ç±»ä¼¼äºå·¥å‚æµæ°´çº¿ï¼š</p>
<ul>
<li>
<p><strong>è‡ªåŠ¨åŒ–ä»»åŠ¡æ‰§è¡Œ</strong>ï¼šé€šè¿‡é…ç½®ä¸€ç³»åˆ—ä»»åŠ¡ï¼Œè‡ªåŠ¨å®Œæˆä»£ç æ£€æŸ¥ã€ç¼–è¯‘ã€å‹ç¼©ç­‰æ“ä½œ</p>
</li>
<li>
<p><strong>ä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€</strong>ï¼šæ‹¥æœ‰æ´»è·ƒçš„ç¤¾åŒºæ”¯æŒï¼Œæä¾›å¤§é‡åŠŸèƒ½æ’ä»¶</p>
</li>
<li>
<p><strong>çµæ´»çš„å·¥ä½œæµ</strong>ï¼šå¯ä»¥æŒ‰ç…§éœ€æ±‚å®šåˆ¶å®Œæ•´çš„å¼€å‘å·¥ä½œæµç¨‹</p>
</li>
</ul>
<h3 data-id="heading-2">Webpackï¼šåŸºäºæ¨¡å—åŒ–æ‰“åŒ…çš„å·¥å…·</h3>
<p>Webpack ä»£è¡¨äº†æ–°ä¸€ä»£æ„å»ºå·¥å…·çš„æ€æƒ³è½¬å˜ï¼š</p>
<ul>
<li>
<p><strong>ä¸€åˆ‡çš†æ¨¡å—</strong>ï¼šå°†é¡¹ç›®ä¸­çš„æ‰€æœ‰èµ„æºï¼ˆJSã€CSSã€å›¾ç‰‡ç­‰ï¼‰éƒ½è§†ä¸ºæ¨¡å—</p>
</li>
<li>
<p><strong>ä¾èµ–å…³ç³»ç®¡ç†</strong>ï¼šé€’å½’æ„å»ºä¾èµ–å…³ç³»å›¾ï¼Œç¡®ä¿æ¨¡å—é—´çš„æ­£ç¡®å¼•ç”¨</p>
</li>
<li>
<p><strong>æ‰“åŒ…ä¼˜åŒ–</strong>ï¼šå°†æ‰€æœ‰æ¨¡å—æ‰“åŒ…æˆå°‘æ•°å‡ ä¸ª bundle æ–‡ä»¶ï¼Œä¼˜åŒ–åŠ è½½æ€§èƒ½</p>
</li>
</ul>
<h3 data-id="heading-3">ç°ä»£æ›¿ä»£æ–¹æ¡ˆï¼šnpm script</h3>
<p>éšç€æŠ€æœ¯çš„å‘å±•ï¼Œç°åœ¨æ›´æ¨èä½¿ç”¨ npm script æ¥æ›¿ä»£ä¼ ç»Ÿçš„ä»»åŠ¡è¿è¡Œå™¨ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"webpack --mode production"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"dev"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"webpack serve --mode development"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lint"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eslint src/"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-4">äºŒã€ä¸»æµæ‰“åŒ…å·¥å…·å¯¹æ¯”é€‰å‹</h2>
<h3 data-id="heading-5">Webpackï¼šå¤æ‚åº”ç”¨çš„ä¼˜é€‰</h3>
<p><strong>ä¼˜åŠ¿ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>
<p>åŠŸèƒ½å…¨é¢ï¼Œæ”¯æŒä»£ç åˆ†å‰²ã€æ‡’åŠ è½½ç­‰é«˜çº§ç‰¹æ€§</p>
</li>
<li>
<p>ç”Ÿæ€ä¸°å¯Œï¼Œæ‹¥æœ‰å¤§é‡ loader å’Œ plugin</p>
</li>
<li>
<p>é€‚åˆå¤§å‹å¤æ‚çš„å‰ç«¯é¡¹ç›®</p>
</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> ä¼ä¸šçº§åº”ç”¨ã€å•é¡µé¢åº”ç”¨ï¼ˆSPAï¼‰ã€éœ€è¦å¤æ‚æ„å»ºæµç¨‹çš„é¡¹ç›®</p>
<h3 data-id="heading-6">Rollupï¼šåº“å¼€å‘çš„åˆ©å™¨</h3>
<p><strong>ä¼˜åŠ¿ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>
<p>Tree-shaking æ•ˆæœå‡ºè‰²ï¼Œæ‰“åŒ…ä½“ç§¯å°</p>
</li>
<li>
<p>é…ç½®ç®€å•ï¼Œä¸“æ³¨äº ES6 æ¨¡å—æ‰“åŒ…</p>
</li>
<li>
<p>è¾“å‡ºæ ¼å¼å¤šæ ·ï¼ˆESMã€CJSã€UMD ç­‰ï¼‰</p>
</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> Vueã€React ç­‰å¼€æºåº“ã€å·¥å…·åº“ã€ç»„ä»¶åº“å¼€å‘</p>
<h3 data-id="heading-7">Parcelï¼šå¿«é€ŸåŸå‹å¼€å‘</h3>
<p><strong>ä¼˜åŠ¿ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>
<p>é›¶é…ç½®å¼€ç®±å³ç”¨</p>
</li>
<li>
<p>æ„å»ºé€Ÿåº¦å¿«</p>
</li>
<li>
<p>é€‚åˆåˆå­¦è€…</p>
</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> demo é¡¹ç›®ã€å®éªŒæ€§é¡¹ç›®ã€å¿«é€ŸåŸå‹å¼€å‘</p>
<h2 data-id="heading-8">ä¸‰ã€Webpack æ ¸å¿ƒæ¦‚å¿µæ·±å…¥ç†è§£</h2>
<h3 data-id="heading-9">å¸¸ç”¨ Loader è¯¦è§£</h3>
<p>Loader å°±åƒæ˜¯ Webpack çš„"ç¿»è¯‘å®˜"ï¼Œè´Ÿè´£å¤„ç†å„ç§ç±»å‹çš„æ–‡ä»¶ï¼š</p>
<p>Loader åç§°</p>
<p>ä¸»è¦åŠŸèƒ½</p>
<p>ä½¿ç”¨åœºæ™¯</p>
<p><code>babel-loader</code></p>
<p>ES6+ è½¬ ES5</p>
<p>ç°ä»£ JavaScript å…¼å®¹</p>
<p><code>css-loader</code></p>
<p>è§£æ CSS æ–‡ä»¶</p>
<p>CSS æ¨¡å—åŒ–å¤„ç†</p>
<p><code>style-loader</code></p>
<p>æ³¨å…¥ CSS åˆ° DOM</p>
<p>å¼€å‘ç¯å¢ƒæ ·å¼çƒ­æ›´æ–°</p>
<p><code>file-loader</code></p>
<p>å¤„ç†æ–‡ä»¶èµ„æº</p>
<p>å›¾ç‰‡ã€å­—ä½“ç­‰é™æ€èµ„æº</p>
<p><code>url-loader</code></p>
<p>å°æ–‡ä»¶è½¬ base64</p>
<p>ä¼˜åŒ–å°èµ„æºåŠ è½½</p>
<p><strong>é‡è¦ç‰¹æ€§ï¼š</strong> Loader æ‰§è¡Œé¡ºåºä¸ºä»å³å‘å·¦ï¼Œç¬¦åˆå‡½æ•°å¼ç¼–ç¨‹çš„ compose ç†å¿µã€‚</p>
<h3 data-id="heading-10">å¸¸ç”¨ Plugin åŠŸèƒ½è§£æ</h3>
<p>Plugin èµ‹äºˆ Webpack æ›´å¼ºå¤§çš„æ‰©å±•èƒ½åŠ›ï¼š</p>
<ul>
<li>
<p><strong>DefinePlugin</strong>ï¼šå®šä¹‰å…¨å±€å¸¸é‡ï¼Œå¸¸ç”¨äºç¯å¢ƒå˜é‡é…ç½®</p>
</li>
<li>
<p><strong>HtmlWebpackPlugin</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆ HTML æ–‡ä»¶å¹¶æ³¨å…¥èµ„æºå¼•ç”¨</p>
</li>
<li>
<p><strong>MiniCssExtractPlugin</strong>ï¼šæå– CSS åˆ°ç‹¬ç«‹æ–‡ä»¶ï¼Œæ”¯æŒç”Ÿäº§ç¯å¢ƒä¼˜åŒ–</p>
</li>
<li>
<p><strong>WebpackBundleAnalyzer</strong>ï¼šå¯è§†åŒ–åˆ†ææ‰“åŒ…ä½“ç§¯ï¼ŒåŠ©åŠ›æ€§èƒ½ä¼˜åŒ–</p>
</li>
</ul>
<h3 data-id="heading-11">æ ¸å¿ƒæ¦‚å¿µåŒºåˆ†</h3>
<ul>
<li>
<p><strong>Module</strong>ï¼šå¼€å‘ä¸­çš„å•ä¸ªæ¨¡å—ï¼Œå¯¹åº”æºä»£ç æ–‡ä»¶</p>
</li>
<li>
<p><strong>Chunk</strong>ï¼šä»£ç å—ï¼Œç”±å¤šä¸ªæ¨¡å—ç»„æˆ</p>
</li>
<li>
<p><strong>Bundle</strong>ï¼šæœ€ç»ˆçš„è¾“å‡ºæ–‡ä»¶ï¼Œå¯èƒ½åŒ…å«å¤šä¸ª Chunk</p>
</li>
</ul>
<h2 data-id="heading-12">å››ã€Loader ä¸ Plugin æ·±åº¦å¯¹æ¯”</h2>
<p>å¯¹æ¯”ç»´åº¦</p>
<p>Loader</p>
<p>Plugin</p>
<p><strong>ä½œç”¨èŒƒå›´</strong></p>
<p>æ¨¡å—çº§åˆ«ï¼Œå¤„ç†å•ä¸ªæ–‡ä»¶</p>
<p>æ•´ä¸ªæ„å»ºè¿‡ç¨‹</p>
<p><strong>é…ç½®ä½ç½®</strong></p>
<p><code>module.rules</code> æ•°ç»„</p>
<p><code>plugins</code> æ•°ç»„</p>
<p><strong>æœ¬è´¨åŠŸèƒ½</strong></p>
<p>æ–‡ä»¶è½¬æ¢å™¨</p>
<p>ç”Ÿå‘½å‘¨æœŸé’©å­ç›‘å¬å™¨</p>
<p><strong>æ‰§è¡Œæ—¶æœº</strong></p>
<p>æ¨¡å—åŠ è½½é˜¶æ®µ</p>
<p>æ•´ä¸ªç¼–è¯‘å‘¨æœŸ</p>
<h2 data-id="heading-13">äº”ã€çƒ­æ›´æ–°æœºåˆ¶åŸç†å‰–æ</h2>
<p>Webpack Hot Module Replacement (HMR) æ˜¯ç°ä»£å¼€å‘ä½“éªŒçš„é‡è¦ä¿éšœï¼š</p>
<h3 data-id="heading-14">å·¥ä½œæµç¨‹</h3>
<ol>
<li>
<p><strong>æ–‡ä»¶ç›‘æ§</strong>ï¼šWebpack åœ¨ watch æ¨¡å¼ä¸‹ç›‘æ§æ–‡ä»¶å˜åŒ–</p>
</li>
<li>
<p><strong>å†…å­˜ç¼–è¯‘</strong>ï¼šå°†é‡æ–°ç¼–è¯‘çš„ä»£ç ä¿å­˜åœ¨å†…å­˜ä¸­</p>
</li>
<li>
<p><strong>æ¶ˆæ¯æ¨é€</strong>ï¼šé€šè¿‡ WebSocket å‘å®¢æˆ·ç«¯æ¨é€æ›´æ–°ä¿¡æ¯</p>
</li>
<li>
<p><strong>æ¨¡å—æ›¿æ¢</strong>ï¼šå®¢æˆ·ç«¯åŠ¨æ€æ›¿æ¢å˜æ›´æ¨¡å—ï¼Œä¿æŒåº”ç”¨çŠ¶æ€</p>
</li>
</ol>
<h3 data-id="heading-15">æ ¸å¿ƒä¼˜åŠ¿</h3>
<ul>
<li>
<p>ä¿æŒåº”ç”¨çŠ¶æ€ä¸ä¸¢å¤±</p>
</li>
<li>
<p>å¤§å¹…æå‡å¼€å‘æ•ˆç‡</p>
</li>
<li>
<p>æ”¯æŒæ ·å¼ã€ç»„ä»¶ç­‰ç²’åº¦çš„çƒ­æ›´æ–°</p>
</li>
</ul>
<h2 data-id="heading-16">å…­ã€Babel ç¼–è¯‘åŸç†æ¢ç§˜</h2>
<p>Babel çš„è½¬è¯‘è¿‡ç¨‹åˆ†ä¸ºä¸‰ä¸ªç²¾å¯†é˜¶æ®µï¼š</p>
<h3 data-id="heading-17">1. è§£æé˜¶æ®µï¼ˆParseï¼‰</h3>
<pre><code class="hljs language-css" lang="css">// æºä»£ç 
const sum = (<span class="hljs-selector-tag">a</span>, <span class="hljs-selector-tag">b</span>) =&gt; <span class="hljs-selector-tag">a</span> + <span class="hljs-selector-tag">b</span>;
â€‹
// è½¬æ¢ä¸º AST
{
  type: <span class="hljs-string">"VariableDeclaration"</span>,
  declarations: [
    {
      type: <span class="hljs-string">"VariableDeclarator"</span>,
      id: { type: <span class="hljs-string">"Identifier"</span>, name: <span class="hljs-string">"sum"</span> },
      init: {
        type: <span class="hljs-string">"ArrowFunctionExpression"</span>,
        params: [...],
        body: {...}
      }
    }
  ]
}
</code></pre>
<h3 data-id="heading-18">2. è½¬æ¢é˜¶æ®µï¼ˆTransformï¼‰</h3>
<p>éå† ASTï¼Œåº”ç”¨å„ç§æ’ä»¶è¿›è¡Œè¯­æ³•è½¬æ¢ï¼š</p>
<ul>
<li>
<p>ç®­å¤´å‡½æ•°è½¬æ™®é€šå‡½æ•°</p>
</li>
<li>
<p>const/let è½¬ var</p>
</li>
<li>
<p>ç±»è¯­æ³•è½¬æ¢ç­‰</p>
</li>
</ul>
<h3 data-id="heading-19">3. ç”Ÿæˆé˜¶æ®µï¼ˆGenerateï¼‰</h3>
<p>å°†è½¬æ¢åçš„ AST é‡æ–°ç”Ÿæˆç›®æ ‡ä»£ç ã€‚</p>
<h2 data-id="heading-20">ä¸ƒã€ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæ·±åº¦å¯¹æ¯”</h2>
<h3 data-id="heading-21">Git vs SVN æ¶æ„å·®å¼‚</h3>
<p>ç‰¹æ€§å¯¹æ¯”</p>
<p>Gitï¼ˆåˆ†å¸ƒå¼ï¼‰</p>
<p>SVNï¼ˆé›†ä¸­å¼ï¼‰</p>
<p><strong>å­˜å‚¨æ–¹å¼</strong></p>
<p>å…ƒæ•°æ®å­˜å‚¨ï¼Œå®Œæ•´ç‰ˆæœ¬å†å²</p>
<p>æ–‡ä»¶å­˜å‚¨ï¼Œå¢é‡è®°å½•</p>
<p><strong>ç½‘ç»œéœ€æ±‚</strong></p>
<p>æ”¯æŒå®Œå…¨ç¦»çº¿æ“ä½œ</p>
<p>å¿…é¡»è¿æ¥æœåŠ¡å™¨</p>
<p><strong>åˆ†æ”¯ç®¡ç†</strong></p>
<p>è½»é‡çº§åˆ†æ”¯ï¼Œå¿«é€Ÿåˆ‡æ¢</p>
<p>ç›®å½•æ‹·è´ï¼Œå¼€é”€è¾ƒå¤§</p>
<p><strong>æ•°æ®å®‰å…¨</strong></p>
<p>SHA-1 å“ˆå¸Œä¿è¯å®Œæ•´æ€§</p>
<p>ç›¸å¯¹è¾ƒå¼±</p>
<h3 data-id="heading-22">Git çš„æ ¸å¿ƒä¼˜åŠ¿</h3>
<ol>
<li>
<p><strong>æ€§èƒ½å“è¶Š</strong>ï¼šæœ¬åœ°æ“ä½œï¼Œé€Ÿåº¦æå¿«</p>
</li>
<li>
<p><strong>åˆ†æ”¯çµæ´»</strong>ï¼šåˆ›å»ºã€åˆå¹¶åˆ†æ”¯å‡ ä¹æ— æˆæœ¬</p>
</li>
<li>
<p><strong>æ•°æ®å¯é </strong>ï¼šå®Œæ•´çš„ç‰ˆæœ¬å†å²å’Œå†…å®¹æ ¡éªŒ</p>
</li>
</ol>
<h2 data-id="heading-23">å…«ã€Git å¸¸ç”¨å‘½ä»¤æ‰‹å†Œ</h2>
<h3 data-id="heading-24">åŸºç¡€æ“ä½œå‘½ä»¤</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä»“åº“åˆå§‹åŒ–</span>
git init
git <span class="hljs-built_in">clone</span> &lt;url&gt;
â€‹
<span class="hljs-comment"># æäº¤å˜æ›´</span>
git add .
git commit -m <span class="hljs-string">"commit message"</span>
â€‹
<span class="hljs-comment"># çŠ¶æ€æŸ¥çœ‹</span>
git status
git diff
git <span class="hljs-built_in">log</span> --oneline
</code></pre>
<h3 data-id="heading-25">åˆ†æ”¯ç®¡ç†</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ†æ”¯æ“ä½œ</span>
git branch feature-xxx
git checkout feature-xxx
git merge main
git branch -d feature-xxx
</code></pre>
<h3 data-id="heading-26">è¿œç¨‹åä½œ</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># è¿œç¨‹ä»“åº“</span>
git remote <span class="hljs-keyword">add</span> origin &lt;url&gt;
git push -u origin main
git pull origin main
</code></pre>
<h2 data-id="heading-27">ä¹ã€Git é«˜çº§æ“ä½œè§£æ</h2>
<h3 data-id="heading-28">git fetch vs git pull</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰å…¨æ›´æ–°ï¼šåªä¸‹è½½ä¸åˆå¹¶</span>
git fetch origin
â€‹
<span class="hljs-comment"># å¿«æ·æ›´æ–°ï¼šä¸‹è½½å¹¶åˆå¹¶</span>
git pull origin main
</code></pre>
<p><strong>æœ€ä½³å®è·µ</strong>ï¼šæ¨èå…ˆ <code>git fetch</code> æŸ¥çœ‹å˜æ›´ï¼Œå†å†³å®šæ˜¯å¦åˆå¹¶ã€‚</p>
<h3 data-id="heading-29">git rebase vs git merge</h3>
<p>æ“ä½œæ–¹å¼</p>
<p>æäº¤å†å²</p>
<p>é€‚ç”¨åœºæ™¯</p>
<p><strong>merge</strong></p>
<p>ä¿ç•™å®Œæ•´åˆå¹¶å†å²</p>
<p>å›¢é˜Ÿåä½œï¼Œå…¬å…±åˆ†æ”¯</p>
<p><strong>rebase</strong></p>
<p>çº¿æ€§æ•´æ´çš„å†å²</p>
<p>ä¸ªäººç‰¹æ€§åˆ†æ”¯</p>
<p><strong>rebase ä½¿ç”¨æ³¨æ„</strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css"># æ­£ç¡®çš„ rebase æµç¨‹
git checkout feature-branch
git rebase <span class="hljs-selector-tag">main</span>
git checkout <span class="hljs-selector-tag">main</span>
git merge feature-branch
</code></pre>
<p><strong>é‡è¦åŸåˆ™</strong>ï¼šä¸è¦åœ¨å…¬å…±åˆ†æ”¯ä¸Šæ‰§è¡Œ rebase æ“ä½œï¼</p>
<h2 data-id="heading-30">æ€»ç»“</h2>
<p>å‰ç«¯å·¥ç¨‹åŒ–æ˜¯ä¸€ä¸ªä¸æ–­æ¼”è¿›çš„æŠ€æœ¯é¢†åŸŸï¼Œä»æ—©æœŸçš„ä»»åŠ¡è¿è¡Œå™¨åˆ°ç°ä»£çš„æ¨¡å—åŒ–æ‰“åŒ…å·¥å…·ï¼Œä»é›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶åˆ°åˆ†å¸ƒå¼åä½œå¼€å‘ï¼Œæ¯ä¸€æ¬¡æŠ€æœ¯å˜é©éƒ½å¸¦æ¥äº†å¼€å‘æ•ˆç‡å’Œé¡¹ç›®è´¨é‡çš„æ˜¾è‘—æå‡ã€‚æŒæ¡è¿™äº›æ ¸å¿ƒçŸ¥è¯†ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬åœ¨å®é™…é¡¹ç›®ä¸­åšå‡ºæ›´åˆç†çš„æŠ€æœ¯é€‰å‹ï¼Œæ„å»ºæ›´å¥å£®çš„å‰ç«¯åº”ç”¨æ¶æ„ã€‚</p>
<p>éšç€æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œå‰ç«¯å·¥ç¨‹åŒ–å°†ç»§ç»­å‘ç€æ›´æ™ºèƒ½ã€æ›´é«˜æ•ˆçš„æ–¹å‘æ¼”è¿›ï¼Œä½†æ‰å®çš„åŸºç¡€çŸ¥è¯†å’Œæ ¸å¿ƒåŸç†å°†å§‹ç»ˆæ˜¯æˆ‘ä»¬åº”å¯¹æŠ€æœ¯å˜åŒ–çš„åšå®åŸºç¡€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[[è¯‘]å‘å¸ƒ Angular v21]]></title>    <link>https://juejin.cn/post/7574327911659962368</link>    <guid>https://juejin.cn/post/7574327911659962368</guid>    <pubDate>2025-11-20T02:47:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574327911659962368" data-draft-id="7574327911659945984" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="[è¯‘]å‘å¸ƒ Angular v21"/> <meta itemprop="keywords" content="å‰ç«¯,Angular.js,å‰ç«¯æ¡†æ¶"/> <meta itemprop="datePublished" content="2025-11-20T02:47:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯è¶…äºº"/> <meta itemprop="url" content="https://juejin.cn/user/360295546755678"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            [è¯‘]å‘å¸ƒ Angular v21
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/360295546755678/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯è¶…äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T02:47:49.000Z" title="Thu Nov 20 2025 02:47:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8085fdaf5f21460fbd2440448eecc1f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv6LaF5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764211683&amp;x-signature=9vAiENVNEN0FoRYpm2%2BVoMKqjT4%3D" alt="1_xcM4SYWsG_hMHnDJABz8dw.png" loading="lazy"/></p>
<p>å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤šä¹ˆä»¤äººå…´å¥‹çš„æ—¶ä»£ï¼éšç€ Web å¼€å‘ä¸­ AI æ–¹é¢çš„æ‰€æœ‰æ¿€åŠ¨äººå¿ƒçš„å‘å±•ï¼Œæ„Ÿè§‰æˆ‘ä»¬æ¯å¤©éƒ½åœ¨å¼€å¯æ–°çš„å†’é™©ã€‚è¿™ä¸æˆ‘ä»¬ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgoo.gle%2Fangular-v21" target="_blank" title="https://goo.gle/angular-v21" ref="nofollow noopener noreferrer">v21 å‘å¸ƒæ´»åŠ¨çš„ä¸»é¢˜å®Œç¾å¥‘åˆï¼Œè¯¥æ´»åŠ¨æä¾›äº†å¯¹ Angular v21 æœ€ä½³åŠŸèƒ½çš„æ¦‚è¿°ã€‚</a></p>
<p>éšç€ v21 çš„å‘å¸ƒï¼ŒAngular æˆä¸ºäº†æ‚¨æ—¥å¸¸å†’é™©çš„æ›´å¼ºå¤§ä¼™ä¼´â€”â€”ä¸ºæ‚¨æä¾› Angular æ¡†æ¶çš„<strong>ç¨³å®šæ€§</strong>ï¼ŒåŒæ—¶ä½¿æ‚¨èƒ½å¤Ÿæ„å»ºå¯æ‰©å±•ä¸”é€‚åˆæ¯ä¸ªäººçš„å¼ºå¤§ AI é©±åŠ¨åº”ç”¨ç¨‹åºã€‚</p>
<p>Angular v21 ä¸ºæ‚¨æä¾›äº†è®¸å¤šæœŸå¾…å·²ä¹…çš„å·¥å…·ï¼Œä»¥ä¸°å¯Œæ‚¨çš„å·¥å…·ç®±ï¼Œå¹¶ç¡®ä¿æ‚¨æ‹¥æœ‰æœ€ä½³çš„å¼€å‘è€…ä½“éªŒï¼Œæ— è®ºæ˜¯ä½¿ç”¨ä»£ç†å’Œ AI è¾…åŠ©è¿›è¡Œç¼–ç ï¼Œè¿˜æ˜¯æ›´å–œæ¬¢ä»…ä¸æ‚¨çš„ IDE ä¸€èµ·ç¼–å†™ã€è°ƒè¯•å’Œæµ‹è¯•ä»£ç ã€‚</p>
<p>äº®ç‚¹åŒ…æ‹¬ï¼š</p>
<ul>
<li>æˆ‘ä»¬æ­£åœ¨æ¨å‡º<strong>å®éªŒæ€§çš„ Signal Forms</strong>ï¼Œæä¾›ä¸€ç§åŸºäº Signals çš„æ–°å‹å¯æ‰©å±•ã€å¯ç»„åˆå’Œå“åº”å¼è¡¨å•ä½“éªŒã€‚</li>
<li><strong>Angular Aria</strong> æ­£å¼è¿›å…¥å¼€å‘è€…é¢„è§ˆç‰ˆï¼Œä¸ºæ‚¨æä¾›ä»¥<em>å¯è®¿é—®æ€§ä¸ºä¼˜å…ˆè€ƒè™‘çš„ headless ç»„ä»¶</em>ï¼Œæ‚¨å¯ä»¥è‡ªç”±è¿›è¡Œæ ·å¼å®šåˆ¶ã€‚</li>
<li>æ‚¨çš„ AI ä»£ç†å¯ä»¥ä½¿ç”¨ Angular çš„ <strong>MCP æœåŠ¡å™¨</strong>ï¼Œç°åœ¨åŒ…å«ä¸ƒä¸ªç¨³å®šå’Œå®éªŒæ€§å·¥å…·â€”â€”ä½¿ LLMs èƒ½å¤Ÿä»ç¬¬ä¸€å¤©èµ·å°±ä½¿ç”¨æ–°çš„ Angular åŠŸèƒ½ã€‚</li>
<li>Angular CLI å·²å°† <strong>Vitest</strong> é›†æˆä½œä¸ºæ–°çš„<strong>é»˜è®¤æµ‹è¯•è¿è¡Œå™¨</strong>ã€‚Vitest æ”¯æŒç°å·²ç¨³å®šå¹¶å¯ç”¨äºç”Ÿäº§ã€‚</li>
<li>æ–°çš„ Angular åº”ç”¨ç¨‹åº<strong>ä¸å†é»˜è®¤åŒ…å« zone.js</strong>ï¼</li>
</ul>
<p>è¿˜æœ‰æ›´å¤šç²¾å½©å†…å®¹â€”â€”è®©æˆ‘ä»¬æ·±å…¥æ¢ç´¢ï¼</p>
<h2 data-id="heading-0">å®éªŒæ€§ Signal Forms å·²ä¸Šçº¿</h2>
<p>æˆ‘ä»¬è‡ªè±ªåœ°å®£å¸ƒï¼Œç°åœ¨æ‚¨å¯ä»¥<a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Fessentials%2Fsignal-forms" target="_blank" title="https://angular.dev/essentials/signal-forms" ref="nofollow noopener noreferrer">è¯•ç”¨ Signal Forms</a>ï¼Œè¿™æ˜¯ä¸€ä¸ªå®éªŒæ€§åº“ï¼Œå®ƒåŸºäº Signals çš„å“åº”å¼åŸºç¡€ï¼Œè®©æ‚¨èƒ½å¤Ÿç®¡ç†è¡¨å•çŠ¶æ€ï¼</p>
<p>ä½¿ç”¨ Signal Formsï¼Œè¡¨å•æ¨¡å‹ç”±ä¸€ä¸ª Signal å®šä¹‰ï¼Œè¯¥ Signal ä¼šè‡ªåŠ¨ä¸ç»‘å®šåˆ°å®ƒçš„è¡¨å•å­—æ®µåŒæ­¥ï¼Œä»è€Œæä¾›ä¸€ç§ç¬¦åˆäººä½“å·¥ç¨‹å­¦çš„å¼€å‘è€…ä½“éªŒï¼Œå¹¶ç¡®ä¿è®¿é—®è¡¨å•å­—æ®µæ—¶çš„å®Œå…¨ç±»å‹å®‰å…¨ã€‚</p>
<p>å¼ºå¤§çš„ã€åŸºäºæ¨¡å¼çš„é›†ä¸­å¼éªŒè¯é€»è¾‘å·²å†…ç½® ğŸ‰</p>
<p>å¼€å§‹ä½¿ç”¨ï¼Œåˆ›å»ºä¸€ä¸ªè¡¨å•æ¨¡å‹å¹¶å°†å…¶ä¼ é€’ç»™ <code>form()</code> :</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { form, <span class="hljs-title class_">Field</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/forms/signals'</span>;

<span class="hljs-meta">@Component</span>({
  <span class="hljs-attr">imports</span>: [<span class="hljs-title class_">Field</span>],
  <span class="hljs-attr">template</span>: <span class="hljs-string">`
    Email: &lt;input [field]="loginForm.email"&gt;
    Password: &lt;input [field]="loginForm.password"&gt;
  `</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginForm</span> {
  login = <span class="hljs-title function_">signal</span>({
    <span class="hljs-attr">email</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">password</span>: <span class="hljs-string">''</span>
  });
  
  loginForm = <span class="hljs-title function_">form</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">login</span>);
}
</code></pre>
<p>ç°åœ¨æ‚¨å¯ä»¥ä½¿ç”¨ <code>[field]</code> æŒ‡ä»¤å°†å­—æ®µç»‘å®šåˆ°æ¨¡æ¿ã€‚ç”µå­é‚®ä»¶éªŒè¯æˆ–æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç­‰å…¸å‹éªŒè¯æ¨¡å¼å·²ç»å†…ç½®ï¼Œè‡ªå®šä¹‰éªŒè¯å™¨è®©æ‚¨èƒ½å¤Ÿåˆ›å»ºæ›´å¼ºå¤§çš„éªŒè¯æœºåˆ¶ã€‚</p>
<p>ç»‘å®šåˆ°è‡ªå®šä¹‰ç»„ä»¶æ˜¯åŸºäº Signals çš„ï¼Œæ¯”ä»¥å¾€ä»»ä½•æ—¶å€™éƒ½æ›´å®¹æ˜“ï¼Œä¸å†éœ€è¦ <code>ControlValueAccessor</code> ã€‚</p>
<p>å¼€å§‹ä½¿ç”¨ï¼Œè¯·æŸ¥çœ‹å¿…å¤‡çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Fessentials%2Fsignal-forms" target="_blank" title="https://angular.dev/essentials/signal-forms" ref="nofollow noopener noreferrer">Signal Forms æŒ‡å—</a>æˆ–<a href="https://link.juejin.cn?target=http%3A%2F%2Fangular.dev%2Fguide%2Fforms%2Fsignals%2Foverview" target="_blank" title="http://angular.dev/guide/forms/signals/overview" ref="nofollow noopener noreferrer">å®Œæ•´æ–‡æ¡£</a>ã€‚</p>
<p>æˆ‘ä»¬å¾ˆé«˜å…´æ‚¨èƒ½å¼€å§‹ä½¿ç”¨ Signal Forms è¿›è¡Œæ„å»ºã€‚Signal Forms API ç›®å‰ä»å¤„äºå®éªŒé˜¶æ®µï¼Œæˆ‘ä»¬å°†æ ¹æ®åé¦ˆè¿›è¡Œè¿­ä»£ã€‚è¯·å°è¯•ä½¿ç”¨å¹¶å‘Šè¯‰æˆ‘ä»¬æ‚¨çš„æƒ³æ³•ã€‚</p>
<h2 data-id="heading-1">å¯è®¿é—®ç»„ä»¶ â€” ä½¿ç”¨ Angular Aria æ‰“é€ æ‚¨çš„ä¸“å±é£æ ¼</h2>
<p>æˆ‘ä»¬æ¿€åŠ¨åœ°å®£å¸ƒï¼Œæˆ‘ä»¬æ­£åœ¨å‘å¸ƒæˆ‘ä»¬æ–°çš„ç°ä»£åº“çš„å¼€å‘è€…é¢„è§ˆç‰ˆï¼Œè¯¥åº“ç”¨äºå¸¸è§çš„ UI æ¨¡å¼ã€‚æˆ‘ä»¬ä¸º <a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Fguide%2Faria%2F" target="_blank" title="https://angular.dev/guide/aria/" ref="nofollow noopener noreferrer">Angular Aria</a> å°†å¯è®¿é—®æ€§ä½œä¸ºé¦–è¦ä»»åŠ¡ã€‚ä¸ºäº†å¼€å§‹ï¼Œæ‚¨å°†è·å¾—ä¸€å¥—åŒ…å« 8 ç§ UI æ¨¡å¼ã€æ¶µç›– 13 ä¸ªç»„ä»¶çš„é›†åˆï¼Œè¿™äº›ç»„ä»¶å®Œå…¨æœªè¿›è¡Œæ ·å¼è®¾ç½®ï¼Œå¹¶ä¸”å¯ä»¥è‡ªå®šä¹‰æ‚¨çš„æ ·å¼ã€‚</p>
<p>Angular Aria ä½¿ç”¨ç°ä»£ Angular æŒ‡ä»¤ï¼ŒåŸºäº Signalsï¼Œå¹¶å»ºç«‹åœ¨æˆ‘ä»¬åœ¨æ„å»ºå“åº”å¼å¯è®¿é—®ç»„ä»¶æ–¹é¢çš„ä¸°å¯Œç»éªŒä¹‹ä¸Šã€‚</p>
<p>æˆ‘ä»¬æ¨å‡ºçš„ 8 ç§æ¨¡å¼æ˜¯ï¼š</p>
<ul>
<li>Accordion  æ‰‹é£ç´</li>
<li>Combobox  ç»„åˆæ¡†</li>
<li>Grid  ç½‘æ ¼</li>
<li>Listbox  åˆ—è¡¨æ¡†</li>
<li>Menu  èœå•</li>
<li>Tabs  é€‰é¡¹å¡</li>
<li>Toolbar  å·¥å…·æ </li>
<li>Tree  æ ‘</li>
</ul>
<p>Angular Aria åŒ…å«ä½ å¯ä»¥è‡ªè¡Œå®šåˆ¶çš„å¤æ‚ç»„ä»¶ï¼Œä¾‹å¦‚å¤šçº§ç‹¬ç«‹èœå•:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9e7f690a3cf4dc082b54ae70351afc8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv6LaF5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764211683&amp;x-signature=e6k6shvYc%2F%2BcvcooxCY2PpZsIoU%3D" alt="" loading="lazy"/></p>
<p>é€šè¿‡è¿è¡Œ <code>npm i @angular/aria</code> å®‰è£…è¿™ä¸ªæ–°åº“ã€‚ç„¶åï¼Œè®¿é—®æˆ‘ä»¬çš„å®Œæ•´ <a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Fguide%2Faria%2F" target="_blank" title="https://angular.dev/guide/aria/" ref="nofollow noopener noreferrer">Angular Aria æŒ‡å—</a>ï¼Œè¯¥æŒ‡å—æä¾›æ‰€æœ‰ç»„ä»¶çš„ä½¿ç”¨ä¿¡æ¯å’Œä»£ç ç¤ºä¾‹ï¼Œå¹¶å±•ç¤ºä½ å¯ä»¥å¤åˆ¶ç²˜è´´ä»¥å°è¯•ä¸åŒå¤–è§‚çš„çš®è‚¤ã€‚</p>
<p>Angular å›¢é˜Ÿç°åœ¨æä¾›ä¸‰ç§ä¸åŒçš„æ–¹å¼æ¥å¸®åŠ©ä½ ä½¿ç”¨å’Œå¼€å‘ç»„ä»¶ï¼š</p>
<ul>
<li>ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Fguide%2Faria%2F" target="_blank" title="https://angular.dev/guide/aria/" ref="nofollow noopener noreferrer">Angular Aria</a> åˆ›å»ºå¯è®¿é—®çš„ã€headless ç»„ä»¶ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½è‡ªç”±è¿›è¡Œæ ·å¼è®¾è®¡</li>
<li>ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmaterial.angular.dev%2Fcdk%2Fcategories" target="_blank" title="https://material.angular.dev/cdk/categories" ref="nofollow noopener noreferrer">CDK</a> æ¥åŒ…å«ä½ å¯ä»¥åœ¨è‡ªå·±æ„å»ºçš„ç»„ä»¶ä¸­ä½¿ç”¨çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Fguide%2Fdrag-drop" target="_blank" title="https://angular.dev/guide/drag-drop" ref="nofollow noopener noreferrer">æ‹–æ”¾</a>ç­‰è¡Œä¸ºåŸè¯­ã€‚</li>
<li>ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmaterial.angular.dev%2F" target="_blank" title="https://material.angular.dev/" ref="nofollow noopener noreferrer">Angular Material</a> æ¥è·å–ä¸€å¥—éµå¾ª Material Design åŸåˆ™çš„ã€é¢„å…ˆæ ·å¼åŒ–çš„ç»„ä»¶åº“ã€‚ä½ å¯ä»¥é€šè¿‡<a href="https://link.juejin.cn?target=https%3A%2F%2Fmaterial.angular.dev%2Fguide%2Ftheming" target="_blank" title="https://material.angular.dev/guide/theming" ref="nofollow noopener noreferrer">è‡ªå®šä¹‰ä¸»é¢˜</a>æ¥è°ƒæ•´è¿™äº›ç»„ä»¶ã€‚</li>
</ul>
<p>æˆ‘ä»¬æœŸå¾…ä½ ä½¿ç”¨ Angular Aria åçš„åé¦ˆï¼Œä»¥åŠä½ ç”¨å®ƒå°†æ„å»ºå‡ºä»€ä¹ˆã€‚</p>
<h2 data-id="heading-2">ä¸ºæ‚¨çš„ AI ä»£ç†æä¾›æ›´å¤šå·¥å…·â€”â€”å€ŸåŠ© Angular çš„ MCP æœåŠ¡å™¨</h2>
<p>ä¸ºäº†ç¡®ä¿æ‚¨å‡†å¤‡å¥½è¿æ¥ AI æ—¶ä»£ï¼Œæˆ‘ä»¬å¸Œæœ›ç¡®ä¿å¼€å‘è€…æ‹¥æœ‰åˆé€‚çš„å·¥å…·ã€‚æˆ‘ä»¬å¸Œæœ›æä¾›é€‚åˆå¼€å‘è€…å½“å‰å·¥ä½œæ–¹å¼çš„å·¥å…·ï¼Œå¹¶åŠ©åŠ›å·¥ä½œæ–¹å¼çš„æ¼”å˜ã€‚</p>
<p>åœ¨ v20.2 ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬æ¨å‡ºäº† Angular CLI å†…ç½®çš„ <a href="https://link.juejin.cn?target=http%3A%2F%2Fangular.dev%2Fai%2Fmcp" target="_blank" title="http://angular.dev/ai/mcp" ref="nofollow noopener noreferrer">MCP æœåŠ¡å™¨</a>ï¼Œä»¥ç¡®ä¿ AI ä»£ç†æ‹¥æœ‰ Angular å¼€å‘æ‰€éœ€çš„æ‰€æœ‰ä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬è‡ªè±ªåœ°å®£å¸ƒï¼ŒMCP æœåŠ¡å™¨ç°å·²ç¨³å®šï¼</p>
<p>Angular MCP æœåŠ¡å™¨ä¸ºæ‚¨æä¾›ä¸€å¥—å·¥å…·ï¼Œä¸º AI ä»£ç†æä¾›å…³äºç°ä»£ Angular å’Œæ‚¨åº”ç”¨çš„æ­£ç¡®ä¸Šä¸‹æ–‡ï¼Œç”šè‡³å¸®åŠ©æ‚¨æˆä¸ºæ›´å¥½çš„å¼€å‘è€…ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ MCP æœåŠ¡å™¨ï¼š</p>
<ul>
<li><strong>è·å–åŸºæœ¬èƒŒæ™¯</strong>ï¼š<code>get_best_practices</code> å·¥å…·æä¾› Angular æœ€ä½³å®è·µæŒ‡å—ï¼Œè€Œ <code>list_projects</code> å·¥å…·ä¼šæŸ¥æ‰¾å·¥ä½œåŒºä¸­çš„æ‰€æœ‰ Angular é¡¹ç›®ã€‚</li>
<li><strong>è·å–æœ€æ–°ä¿¡æ¯</strong>ï¼š<code>search_documentation</code> å·¥å…·èƒ½å¤Ÿé€šè¿‡æŸ¥è¯¢<a href="https://link.juejin.cn?target=http%3A%2F%2Fangular.dev%2F" target="_blank" title="http://angular.dev/" ref="nofollow noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a>æ¥å›ç­” Angular ç›¸å…³é—®é¢˜ï¼Œ<code>find_examples</code> å·¥å…·åˆ™æä¾›ç°ä»£ Angular æ¨¡å¼çš„æœ€æ–°ç¤ºä¾‹â€”â€”æˆ‘ä»¬å¾ˆå¿«å°†æ·»åŠ æ›´å¤šç¤ºä¾‹ï¼Œå¦‚åŸºäº Signal çš„è¡¨å•å’Œ Angular Ariaï¼Œä»¥ä¾¿æ‚¨çš„ AI ä»£ç†å¯ä»¥ä½¿ç”¨æ–°çš„ç¼–ç æ¨¡å¼ã€‚</li>
<li><strong>æ›´æ–°æ‚¨çš„åº”ç”¨ç¨‹åº</strong>ï¼š <code>onpush_zoneless_migration</code> å·¥å…·èƒ½å¤Ÿåˆ†ææ‚¨çš„ä»£ç ï¼Œå¹¶æä¾›è¿ç§»åº”ç”¨ç¨‹åºåˆ° OnPush å’Œ zoneless å˜æ›´æ£€æµ‹çš„è®¡åˆ’ã€‚è¿˜æœ‰ä¸€ä¸ªåä¸º <code>modernize</code> çš„å®éªŒæ€§å·¥å…·ï¼Œç”¨äºä½¿ç”¨ç°æœ‰ <code>schematic</code> è¿›è¡Œä»£ç è¿ç§»ã€‚</li>
<li><strong>å­¦ä¹  Angular</strong>ï¼š<code>ai_tutor</code> å·¥å…·å¯åŠ¨ä¸€ä¸ªäº¤äº’å¼ AI é©±åŠ¨çš„ Angular å¯¼å¸ˆï¼Œå¯ä»¥å¸®åŠ©æ‚¨å­¦ä¹ æ¦‚å¿µå¹¶è·å¾—åé¦ˆï¼Œå»ºè®®åœ¨æ–°çš„ Angular åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚</li>
</ul>
<p>ä½¿ç”¨ MCP æœåŠ¡å™¨ï¼Œæ‚¨å¯ä»¥è§£å†³çŸ¥è¯†æˆªæ­¢é—®é¢˜â€”â€”æ‚¨çš„ LLM æ˜¯åœ¨æŸä¸ªç‰¹å®šæ—¥æœŸä¹‹å‰è®­ç»ƒçš„ï¼Œä½†é€šè¿‡ä½¿ç”¨ MCP æœåŠ¡å™¨ï¼Œå®ƒèƒ½å¤Ÿå­¦ä¹ ä½¿ç”¨å…¨æ–°çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ Signal Forms å’Œ Angular Ariaâ€”â€”æ‚¨åªéœ€è¦è®©æ‚¨çš„ä»£ç†å»å¯»æ‰¾ç¤ºä¾‹å¹¶ä½¿ç”¨å®ƒä»¬ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ae30252f5a0f4ca3bbfb4ea1a4746841~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv6LaF5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764211683&amp;x-signature=ILnU8ESSOq8dXfIUWjxq9Fva1dU%3D" alt="AI å¯¼å¸ˆå·¥å…·æ­£åœ¨ä½¿ç”¨ä¸­" loading="lazy"/></p>
<h2 data-id="heading-3">Vitest ä½œä¸ºæ–°çš„é»˜è®¤ç¨³å®šæµ‹è¯•è¿è¡Œå™¨</h2>
<p>ç”±äº <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkarma-runner%2Fkarma%3Ftab%3Dreadme-ov-file%23karma-is-deprecated-and-is-not-accepting-new-features-or-general-bug-fixes" target="_blank" title="https://github.com/karma-runner/karma?tab=readme-ov-file#karma-is-deprecated-and-is-not-accepting-new-features-or-general-bug-fixes" ref="nofollow noopener noreferrer">Karma åœ¨ 2023 å¹´è¢«å¼ƒç”¨</a>ï¼ŒAngular å›¢é˜Ÿå·²ç»æ¢ç´¢äº† Jestã€Web Test Runner å’Œ Vitest ä½œä¸ºæ–°çš„æµ‹è¯•è§£å†³æ–¹æ¡ˆã€‚</p>
<p>åœ¨æ”¶åˆ°ç¤¾åŒºçš„ç§¯æåé¦ˆåï¼Œæˆ‘ä»¬å†³å®šå°† Vitest ä½œä¸ºæ–°çš„é»˜è®¤æµ‹è¯•è¿è¡Œå™¨ï¼Œå¹¶åœ¨ Angular v21 ä¸­å°†å…¶æå‡è‡³ç¨³å®šç‰ˆ ğŸ‰</p>
<p>è¦åœ¨æ–°çš„ Angular åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ <a href="https://link.juejin.cn?target=http%3A%2F%2Fvitest.dev%2F" target="_blank" title="http://vitest.dev/" ref="nofollow noopener noreferrer">Vitest</a>ï¼Œåªéœ€è¿è¡Œ <code>ng test</code> å‘½ä»¤ã€‚æ§åˆ¶å°è¾“å‡ºå°†å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e302b9d5a38b48dc869ca784eb90391a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv6LaF5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764211683&amp;x-signature=b4y9oGw38FyoQHoqGRnx0BvA3wU%3D" alt="Vitest åœ¨ Angular ä¸­çš„ç¤ºä¾‹ç»ˆç«¯è¾“å‡º" loading="lazy"/></p>
<p>è¦äº†è§£æ›´å¤šå…³äºä½¿ç”¨ Vitest è¿›è¡Œæµ‹è¯•çš„ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href="https://link.juejin.cn?target=http%3A%2F%2Fangular.dev%2Fguide%2Ftesting" target="_blank" title="http://angular.dev/guide/testing" ref="nofollow noopener noreferrer">angular.dev ä¸Šçš„æ–‡æ¡£</a>ã€‚</p>
<p>è™½ç„¶ Vitest å·²æˆä¸ºæ–°é¡¹ç›®çš„é»˜è®¤æµ‹è¯•è¿è¡Œå™¨ï¼Œä½† Angular å›¢é˜Ÿä»ç„¶<a href="https://link.juejin.cn?target=http%3A%2F%2Fangular.dev%2Fguide%2Ftesting%2Fkarma" target="_blank" title="http://angular.dev/guide/testing/karma" ref="nofollow noopener noreferrer">å…¨é¢æ”¯æŒ Karma å’Œ Jasmine</a>ï¼Œå› æ­¤æ‚¨æ— éœ€ç«‹å³è¿ç§»ã€‚</p>
<p>å¦‚æœæ‚¨å·²å‡†å¤‡å¥½å°†ç°æœ‰åº”ç”¨ç¨‹åºè¿ç§»åˆ°ä½¿ç”¨ Vitestï¼Œå¯ä»¥è¿è¡Œä¸€ä¸ª<a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Fguide%2Ftesting%2Fmigrating-to-vitest" target="_blank" title="https://angular.dev/guide/testing/migrating-to-vitest" ref="nofollow noopener noreferrer">å®éªŒæ€§è¿ç§»</a>ã€‚åœ¨æ‰§è¡Œé“¾æ¥æŒ‡å—ä¸­æè¿°çš„æŸäº›å‡†å¤‡å·¥ä½œåï¼Œè¿è¡Œ:</p>
<pre><code class="hljs language-bash" lang="bash">ng g @schematics/angular:refactor-jasmine-vitest
</code></pre>
<p>æ‚¨çš„æµ‹è¯•å°†è‡ªåŠ¨é‡æ„ä»¥ä½¿ç”¨ Vitestã€‚</p>
<p>ç”±äº Vitest æ”¯æŒå·²ç¨³å®šï¼Œæˆ‘ä»¬å†³å®šå¼ƒç”¨ Web Test Runner å’Œ Jest çš„å®éªŒæ€§æ”¯æŒï¼Œå¹¶è®¡åˆ’åœ¨ v22 ç‰ˆæœ¬ä¸­ç§»é™¤å®ƒä»¬ã€‚å¯¹äºå¸Œæœ›ç»§ç»­ä½¿ç”¨ Jest çš„å›¢é˜Ÿï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ç°æœ‰çš„ç¤¾åŒºæ›¿ä»£æ–¹æ¡ˆï¼Œä¾‹å¦‚ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fthymikee%2Fjest-preset-angular" target="_blank" title="https://github.com/thymikee/jest-preset-angular" ref="nofollow noopener noreferrer">jest-preset-angular</a> å’Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fnx.dev%2Fdocs%2Ftechnologies%2Ftest-tools%2Fjest%2Fintroduction" target="_blank" title="https://nx.dev/docs/technologies/test-tools/jest/introduction" ref="nofollow noopener noreferrer">Nx Jest æ’ä»¶</a>ã€‚</p>
<h2 data-id="heading-4">Zoneless å·²å‡†å¤‡å¥½æ­£å¼ä¸Šçº¿</h2>
<p>Angular ä¼ ç»Ÿä¸Šä½¿ç”¨ zone.jsï¼Œè¿™æ˜¯ä¸€ä¸ªä¿®è¡¥æµè§ˆå™¨ API çš„åº“ï¼Œç”¨äºè·Ÿè¸ªåº”ç”¨ç¨‹åºä¸­çš„å˜åŒ–ã€‚è¿™å®ç°äº†â€œç¥å¥‡â€çš„ä½“éªŒï¼Œå³æ¨¡æ¿åœ¨ç”¨æˆ·æ‰§è¡Œåº”ç”¨ç¨‹åºæ“ä½œæ—¶è‡ªåŠ¨æ›´æ”¹ï¼Œç„¶è€Œ zone.js å­˜åœ¨æ€§èƒ½é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨é«˜å¤æ‚åº¦åº”ç”¨ç¨‹åºä¸­</p>
<p>éšç€ Signals é©±åŠ¨ç°ä»£ Angular çŠ¶æ€ç®¡ç†ï¼Œzone.js ä¸å†éœ€è¦ç”¨äºå˜æ›´æ£€æµ‹ã€‚Zoneless å˜æ›´æ£€æµ‹åœ¨ v18 ä¸­å®éªŒæ€§å¼•å…¥ï¼Œåœ¨ v20 ä¸­é€šè¿‡å¼€å‘è€…é¢„è§ˆï¼Œå¹¶åœ¨ v20.2 ä¸­è¾¾åˆ°ç¨³å®šã€‚</p>
<p>é€šè¿‡æˆ‘ä»¬åœ¨ Google çš„åº”ç”¨ç»éªŒï¼Œæˆ‘ä»¬è¶Šæ¥è¶Šç¡®ä¿¡æ–°çš„ Angular åº”ç”¨ç¨‹åºåœ¨æ²¡æœ‰ zone.js çš„æƒ…å†µä¸‹å·¥ä½œæœ€ä½³ã€‚</p>
<ul>
<li>2024 å¹´ï¼Œè°·æ­Œå†…éƒ¨è¶…è¿‡ä¸€åŠçš„æ–° Angular åº”ç”¨ç¨‹åºéƒ½æ˜¯ä½¿ç”¨ Zoneless å˜æ›´æ£€æµ‹ç­–ç•¥æ„å»ºçš„ï¼Œæˆ‘ä»¬åœ¨ 2024 å¹´ä¸­å°†å…¶è®¾ä¸ºé»˜è®¤é…ç½®ã€‚</li>
<li>ç›®å‰è°·æ­Œå†…éƒ¨å·²æœ‰æ•°ç™¾ä¸ª Zoneless åº”ç”¨ç¨‹åºåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œã€‚</li>
<li>ä» <a href="https://link.juejin.cn?target=https%3A%2F%2Fhttparchive.org%2F" target="_blank" title="https://httparchive.org/" ref="nofollow noopener noreferrer">The HTTP Archive</a> å¤–éƒ¨è§‚å¯Ÿï¼Œæˆ‘ä»¬çœ‹åˆ°è¶…è¿‡ 1400 ä¸ª Angular åº”ç”¨ç¨‹åºåœ¨ä½¿ç”¨ Zoneless å˜æ›´æ£€æµ‹ï¼Œè¿™åªæ˜¯é‚£äº›æ— éœ€ç™»å½•å³å¯å…¬å¼€è®¿é—®çš„åº”ç”¨ç¨‹åºæ•°é‡ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f2cb697a3d34b74a5f52345db7d4dc0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv6LaF5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764211683&amp;x-signature=zqz6bnX8vK5H6gREmDBmYXh77oE%3D" alt="" loading="lazy"/></p>
<p>é‰´äºè¿™äº›å¼ºçƒˆçš„ä¿¡å·ï¼Œ<strong>zone.js åŠå…¶åŠŸèƒ½å°†ä¸å†é»˜è®¤åŒ…å«åœ¨ v21 ç‰ˆæœ¬çš„ Angular åº”ç”¨ç¨‹åºä¸­</strong>ã€‚</p>
<p>å¯ç”¨æ— åŒºåŸŸå˜æ›´æ£€æµ‹å¯å¸¦æ¥è¯¸å¤šå¥½å¤„ï¼Œå¦‚æ”¹å–„æ ¸å¿ƒç½‘ç»œæŒ‡æ ‡ã€åŸç”Ÿå¼‚æ­¥ç­‰å¾…ã€ç”Ÿæ€å…¼å®¹æ€§ã€å‡å°‘åŒ…ä½“ç§¯ã€ç®€åŒ–è°ƒè¯•å’Œæ›´å¥½çš„æ§åˆ¶ã€‚</p>
<p>æ–°åº”ç”¨å°†è‡ªåŠ¨ä½¿ç”¨æ— åŒºåŸŸå˜æ›´æ£€æµ‹ï¼Œç°æœ‰åº”ç”¨è¯·éµå¾ª <a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Fguide%2Fzoneless%23removing-zonejs" target="_blank" title="https://angular.dev/guide/zoneless#removing-zonejs" ref="nofollow noopener noreferrer">angular.dev ä¸Šçš„è¿ç§»è¯´æ˜</a>ã€‚æ‚¨ä¹Ÿå¯ä»¥åœ¨ Angular MCP æœåŠ¡å™¨ä¸­å°è¯•æ–°çš„ <code>onpush_zoneless_migration</code> å·¥å…·ï¼Œè¯¥å·¥å…·ä¼šåˆ›å»ºä¸€ä¸ªé€æ­¥è®¡åˆ’ï¼ŒæŒ‡å¯¼æ‚¨å°†åº”ç”¨è¿ç§»åˆ° OnPush å˜æ›´æ£€æµ‹ç­–ç•¥ã€‚</p>
<p>è™½ç„¶æ— åŒºåŸŸæ˜¯æ–°çš„é»˜è®¤ä½“éªŒï¼Œä½†æˆ‘ä»¬æƒ³æ‰¿è®¤ zone.js åœ¨å¡‘é€  Angular æ–¹é¢å‘æŒ¥äº†é‡è¦ä½œç”¨ï¼Œå¹¶è®©å¼€å‘è€…å¤šå¹´æ¥èƒ½å¤Ÿåˆ›é€ ç¥å¥‡ä½“éªŒã€‚æˆ‘ä»¬å‘ zone.js å›¢é˜Ÿè‡´ä»¥è¯šæŒšçš„<strong>æ„Ÿè°¢</strong>ï¼Œç‰¹åˆ«æ˜¯æ„Ÿè°¢ Jia Li å¯¹ zone.js çš„è´¡çŒ®ã€‚</p>
<h2 data-id="heading-5">å…¨æ–°çš„æ–‡æ¡£ä½“éªŒ</h2>
<p>å¦‚æœä½ æœ€è¿‘å‡ å‘¨è®¿é—®è¿‡ <a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev" target="_blank" title="https://angular.dev" ref="nofollow noopener noreferrer">angular.dev</a>ï¼Œå¯èƒ½ä¼šæ³¨æ„åˆ°æœ‰ä¸€ä¸ªæ–°çš„é¦–é¡µã€‚ä½†è¿™è¿˜ä¸æ˜¯ angular å‘ç”Ÿçš„æ‰€æœ‰å˜åŒ–ã€‚</p>
<p>dev â€” æˆ‘ä»¬è¿›è¡Œäº†é‡å¤§è°ƒæ•´ï¼Œä»¥ç¡®ä¿æ–‡æ¡£ä½“éªŒç°ä»£åŒ–ï¼Œå¹¶æ•™æˆæœ€æ–°æ¦‚å¿µï¼Œè®©ä½ å§‹ç»ˆèƒ½è·å–æœ€æ–°ä¿¡æ¯ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DeIeJmYdYMQo" target="_blank" title="https://www.youtube.com/watch?v=eIeJmYdYMQo" ref="nofollow noopener noreferrer">åœ¨ Google I/O 2025</a> ä¸Šï¼Œæˆ‘ä»¬æ¨å‡ºäº† <a href="https://link.juejin.cn?target=http%3A%2F%2Fangular.dev%2Fai" target="_blank" title="http://angular.dev/ai" ref="nofollow noopener noreferrer">angular.dev/ai</a> â€” ä½ æ„å»ºåŸºäº Angular çš„ AI åº”ç”¨æ‰€éœ€çš„æ‰€æœ‰èµ„æºã€‚æˆ‘ä»¬åŒ…å«äº†æœ€ä½³å®è·µã€ä»£ç ç¤ºä¾‹ã€è®¾è®¡æ¨¡å¼ç­‰ã€‚æˆ‘ä»¬è¿˜åŒ…å«äº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Fai%2Fdevelop-with-ai" target="_blank" title="https://angular.dev/ai/develop-with-ai" ref="nofollow noopener noreferrer">æœ€ä½³å®è·µæç¤ºå’Œè‡ªå®šä¹‰è§„åˆ™æ–‡ä»¶</a>ï¼Œä»¥å¸®åŠ©ç¡®ä¿ä½ çš„ä»£ç ç”Ÿæˆä½“éªŒç»“æœä¸ºç°ä»£åŒ–çš„ Angular ä»£ç ã€‚æˆ‘ä»¬ä¸€ç›´åœ¨å‘å¸ƒå¤§é‡æ›´æ–°ï¼Œè¯·ç»§ç»­å…³æ³¨ï¼Œè·å–æ„å»º AI åº”ç”¨çš„æœ€æ–°æŠ€å·§å’Œç­–ç•¥ï¼Œä»¥åŠåˆ©ç”¨æœ€ä½³ AI è¾…åŠ©ç¼–ç æ–¹æ³•ã€‚</p>
<p>å¦‚æœä½ åˆšå¼€å§‹æ„å»ºå“åº”å¼åº”ç”¨çš„æ—…ç¨‹ï¼Œå¯ä»¥æŸ¥çœ‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Ftutorials%2Fsignals" target="_blank" title="https://angular.dev/tutorials/signals" ref="nofollow noopener noreferrer">æ–°çš„ Signals æ•™ç¨‹</a>ï¼Œå®ƒæä¾›äº†æ‰€æœ‰ç¨³å®š Signal API çš„å®Œæ•´æ¦‚è¿°ï¼ŒåŒ…æ‹¬ <code>model()</code>ã€<code>linkedSignal()</code> ç­‰ã€‚</p>
<p>æˆ‘ä»¬åœ¨ angular.dev ä¸ŠæŠ•å…¥äº†å¤§é‡ç²¾åŠ›æ›´æ–°å¼€å‘è€…æŒ‡å—ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Fguide%2Frouting" target="_blank" title="https://angular.dev/guide/routing" ref="nofollow noopener noreferrer">è·¯ç”±æ–‡æ¡£</a>å·²å®Œå…¨æ”¹ç‰ˆï¼Œæä¾›äº†å…³äºè·¯ç”±æ‰€æœ‰æ–¹é¢çš„è¯¦ç»†ä¿¡æ¯ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Fguide%2Fdi" target="_blank" title="https://angular.dev/guide/di" ref="nofollow noopener noreferrer">ä¾èµ–æ³¨å…¥æŒ‡å—</a>å·²å¤§å¹…æ”¹è¿›ï¼Œå¹¶ä½¿å¸Œæœ›æŒæ¡è¿™ä¸€å¼ºå¤§åŠŸèƒ½æ ¸å¿ƒæ¦‚å¿µçš„å¼€å‘è€…æ›´å®¹æ˜“ç†è§£ã€‚</li>
<li>æˆ‘ä»¬æ–°å¢äº†ä¸€ä»½å…³äº <a href="https://link.juejin.cn?target=https%3A%2F%2Fmaterial.angular.dev%2Fguide%2Ftheming-your-components" target="_blank" title="https://material.angular.dev/guide/theming-your-components" ref="nofollow noopener noreferrer">Material ç»„ä»¶ä¸»é¢˜åŒ–</a>æ–¹æ³•çš„å…¨é¢æŒ‡å—</li>
<li>æœ€åä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä»½å®Œæ•´æŒ‡å—ï¼Œä»‹ç»å¦‚ä½•ä½¿ç”¨ Angular ä¸ <a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Fguide%2Ftailwind" target="_blank" title="https://angular.dev/guide/tailwind" ref="nofollow noopener noreferrer">Tailwind CSS</a>ï¼</li>
</ul>
<p>æˆ‘ä»¬è‡´åŠ›äºæå‡æ–‡æ¡£ä½¿ç”¨ä½“éªŒã€‚å¯¹äºä½¿ç”¨ Angular MCP æœåŠ¡å™¨çš„å¼€å‘è€…ï¼Œæ–°çš„ <code>search_documentation</code> å·¥å…·å°†ä½¿æ‚¨çš„ AI ä»£ç†èƒ½å¤Ÿè·å– angular.dev ä¸Šæœ€æ–°ã€æœ€å…¨é¢çš„ä¿¡æ¯ã€‚</p>
<h2 data-id="heading-6">è¿˜æœ‰æ›´å¤šâ€¦â€¦</h2>
<p>æˆ‘ä»¬ä¸€ç›´å¾ˆå¿™ç¢Œï¼é™¤äº†æˆ‘ä»¬ä¹‹å‰é‡ç‚¹ä»‹ç»çš„ä¼˜ç§€åŠŸèƒ½å¤–ï¼Œæˆ‘ä»¬å›¢é˜Ÿè¿˜äº¤ä»˜äº†è®¸å¤šå€¼å¾—ç‰¹åˆ«æåŠçš„å…¶ä»–æˆæœï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fangular%2Fangular%2Fpull%2F64032" target="_blank" title="https://github.com/angular/angular/pull/64032" ref="nofollow noopener noreferrer">CLDR åº“æ”¯æŒå·²ä» v41 æ›´æ–°è‡³ v47</a>ï¼Œæ”¹è¿›äº†è´§å¸æ ¼å¼ã€æ—¥æœŸæ ¼å¼ç­‰ã€‚</li>
<li>æˆ‘ä»¬ç°åœ¨æ”¯æŒ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fangular%2Fangular%2Fpull%2F63857" target="_blank" title="https://github.com/angular/angular/pull/63857" ref="nofollow noopener noreferrer">åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼</a>ï¼š</li>
</ul>
<pre><code class="hljs language-html" lang="html">@let isValidNumber = /\d+/.test(someValue);

@if (!isValidNumber) {
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{someValue}} is not a valid number!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
}
</code></pre>
<ul>
<li>Angular ç°åœ¨å†…ç½®äº† <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fangular%2Fangular%2Fpull%2F64000" target="_blank" title="https://github.com/angular/angular/pull/64000" ref="nofollow noopener noreferrer">Signals æ ¼å¼åŒ–å™¨</a>ã€‚å¯ç”¨è‡ªå®šä¹‰æ ¼å¼åŒ–å™¨ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fmedium.com%2F%40tomsu%2Fdevtools-tips-day-10-custom-formatters-58ee46e640f9" target="_blank" title="https://medium.com/@tomsu/devtools-tips-day-10-custom-formatters-58ee46e640f9" ref="nofollow noopener noreferrer">Chrome</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Ffirefox-source-docs.mozilla.org%2Fdevtools-user%2Fcustom_formatters%2Findex.html%23enabling-custom-formatting" target="_blank" title="https://firefox-source-docs.mozilla.org/devtools-user/custom_formatters/index.html#enabling-custom-formatting" ref="nofollow noopener noreferrer">Firefox</a>ï¼‰ä»¥ä½¿ç”¨æ­¤åŠŸèƒ½ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/afd72448f8de4e3d94748352d905442b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv6LaF5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764211683&amp;x-signature=hEo8%2FLaL4M5MPhNM%2FRD0Ih%2BBANk%3D" alt="" loading="lazy"/></p>
<ul>
<li>æ‚¨ç°åœ¨å¯ä»¥è‡ªå®šä¹‰ä¸è§†å£ç›¸å…³çš„ <code>@defer</code> è§¦å‘å™¨çš„ <code>IntersectionObserver</code> é€‰é¡¹ï¼Œä¾‹å¦‚ï¼š</li>
</ul>
<pre><code class="hljs language-html" lang="html">@defer (on viewport({trigger, rootMargin: '100px'}) {
  <span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>Content<span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
}
</code></pre>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fangular%2Fangular%2Fpull%2F64535" target="_blank" title="https://github.com/angular/angular/pull/64535" ref="nofollow noopener noreferrer">SimpleChanges</a> ç°åœ¨æ˜¯æ³›å‹çš„ï¼Œå…è®¸å¯¹ <code>SimpleChanges</code> ä¸­çš„å€¼è¿›è¡Œæ›´å¥½çš„ç±»å‹æ£€æŸ¥ï¼Œè§£å†³äº†é«˜åº¦ç‚¹èµçš„é—®é¢˜ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fangular%2Fangular%2Fpull%2F48814" target="_blank" title="https://github.com/angular/angular/pull/48814" ref="nofollow noopener noreferrer">KeyValue ç®¡é“ç°åœ¨æ”¯æŒå…·æœ‰å¯é€‰é”®çš„å¯¹è±¡</a></li>
<li>ä½œä¸º CSS å˜é‡çš„æ›¿ä»£æ–¹æ¡ˆï¼Œæ‚¨ç°åœ¨å¯ä»¥ä½¿ç”¨ä¸€å¥—æ–°çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fangular%2Fcomponents%2Fpull%2F31702" target="_blank" title="https://github.com/angular/components/pull/31702" ref="nofollow noopener noreferrer">å®ç”¨ç±»</a>ç›´æ¥åœ¨æ¨¡æ¿ä¸­åº”ç”¨ Material Design çš„ç³»ç»Ÿæ ‡è®°ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://link.juejin.cn?target=http%3A%2F%2Fmaterial.angular.dev%2Fguide%2Ftheming-your-components" target="_blank" title="http://material.angular.dev/guide/theming-your-components" ref="nofollow noopener noreferrer">ä¸»é¢˜æŒ‡å—</a>ï¼</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fangular%2Fcomponents%2Fpull%2F32155" target="_blank" title="https://github.com/angular/components/pull/32155" ref="nofollow noopener noreferrer">CDK æ‚¬æµ®å±‚ç°åœ¨ä½¿ç”¨æµè§ˆå™¨å†…ç½®çš„å¼¹å‡ºæ¡†</a>ï¼Œæœ‰åŠ©äºè§£å†³ä¸€äº›å¯è®¿é—®æ€§é—®é¢˜ã€‚</li>
</ul>
<p>å¦‚æœä½ é”™è¿‡äº†â€”â€”è¿™äº›åªæ˜¯è‡ª Angular v20.2 ä»¥æ¥çš„æ›´æ–°ã€‚å¦‚æœä½ åªå…³æ³¨æ¯ä¸ªä¸»è¦ç‰ˆæœ¬ï¼Œä½ å¯èƒ½é”™è¿‡äº†ï¼š</p>
<ul>
<li>ç”¨äºåœ¨å…ƒç´ <a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Fguide%2Fanimations" target="_blank" title="https://angular.dev/guide/animations" ref="nofollow noopener noreferrer">è¿›å…¥å’Œç¦»å¼€ DOM</a> æ—¶è¿›è¡ŒåŠ¨ç”»çš„æ–° API</li>
<li>CDK æ‹–æ”¾æ”¹è¿›ï¼Œå…è®¸<a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Fguide%2Fdrag-drop%23copying-items-between-lists" target="_blank" title="https://angular.dev/guide/drag-drop#copying-items-between-lists" ref="nofollow noopener noreferrer">åœ¨åˆ—è¡¨ä¹‹é—´å¤åˆ¶é¡¹ç›®</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Ftools%2Fdevtools" target="_blank" title="https://angular.dev/tools/devtools" ref="nofollow noopener noreferrer">Angular DevTools</a> ä¸­çš„è·¯ç”±å¯è§†åŒ–å’Œ Signals å›¾</li>
<li>è€Œä¸”è¿˜æœ‰æ›´å¤šâ€”â€”è¯¦æƒ…è¯·æŸ¥çœ‹æˆ‘ä»¬çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.angular.dev%2Fangular-summer-update-2025-1987592a0b42" target="_blank" title="https://blog.angular.dev/angular-summer-update-2025-1987592a0b42" ref="nofollow noopener noreferrer">å¤å­£æ›´æ–°åšå®¢æ–‡ç« </a></li>
</ul>
<p>ä¸€å¦‚æ—¢å¾€ï¼Œå®Œæ•´çš„å˜åŒ–åˆ—è¡¨åœ¨æˆ‘ä»¬çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fangular%2Fangular%2Fblob%2Fmain%2FCHANGELOG.md" target="_blank" title="https://github.com/angular/angular/blob/main/CHANGELOG.md" ref="nofollow noopener noreferrer">Changelog</a> ä¸­ã€‚</p>
<h2 data-id="heading-7">Angular â¤ï¸ æˆ‘ä»¬å“è¶Šçš„ç¤¾åŒº</h2>
<p>æ²¡æœ‰æˆ‘ä»¬å¼€æºç¤¾åŒºï¼Œè¿™ä¸ªå“è¶Šçš„å‘å¸ƒå°†ä¸å¯èƒ½å®ç°ã€‚</p>
<p>æˆ‘ä»¬ç¤¾åŒºä¸­æœ‰è®¸å¤šäººé€šè¿‡å¤§å°ä¸ä¸€çš„è´¡çŒ®æ¨åŠ¨ç€ Angular çš„å‘å±•ï¼Œæ— è®ºæ˜¯ä¸ºå…¶ä»–å¼€å‘è€…è§£ç­”é—®é¢˜ï¼Œç»„ç»‡èšä¼šå’Œä¼šè®®ï¼Œæ”¹è¿›æ–‡æ¡£ï¼Œè¿˜æ˜¯é€šè¿‡æäº¤ pull-requestã€‚</p>
<p>å¦‚æœä½ æ˜¯æˆ‘ä»¬çš„è´¡çŒ®è€…â€”â€”éå¸¸æ„Ÿè°¢ï¼å¦‚æœä½ è¿˜ä¸æ˜¯ï¼Œæˆ‘å¸Œæœ›è¿™èƒ½æ¿€åŠ±ä½ ï¼å³ä½¿åªæ˜¯å›ç­”ä¸€ä¸ªé—®é¢˜æˆ–å¸®åŠ©ä½ çš„åŒäº‹ä¹Ÿæ˜¯éå¸¸æœ‰å¸®åŠ©çš„!!</p>
<p>è‡ª v20 ä»¥æ¥ï¼Œå·²æœ‰ 215 äººè´¡çŒ®äº† Angular ä»£ç åº“ï¼Œæˆ‘ä»¬æƒ³è¦çªå‡ºä¸€äº›å…·ä½“çš„è´¡çŒ®ï¼š</p>
<ul>
<li>Jaime Burgos æ”¹è¿›äº†å¤šä¸ªè¿ç§»å’Œè¯Šæ–­ï¼š
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Freference%2Fmigrations%2Fstandalone" target="_blank" title="https://angular.dev/reference/migrations/standalone" ref="nofollow noopener noreferrer">standalone</a> è¿ç§»ç°åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fangular%2Fangular%2Fpull%2F64138" target="_blank" title="https://github.com/angular/angular/pull/64138" ref="nofollow noopener noreferrer">æ”¯æŒ CommonModule</a></li>
<li>æ–°å¢å¯¹<a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Freference%2Fmigrations%2Frouter-testing-module-migration" target="_blank" title="https://angular.dev/reference/migrations/router-testing-module-migration" ref="nofollow noopener noreferrer">å·²å¼ƒç”¨çš„ RouterTestingModule çš„è¿ç§»</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fangular%2Fangular%2Fpull%2F64069" target="_blank" title="https://github.com/angular/angular/pull/64069" ref="nofollow noopener noreferrer">å¯¹æ— æ³•è®¿é—®æˆ–å†—ä½™çš„@defer è§¦å‘å™¨çš„è¯Šæ–­</a></li>
</ul>
</li>
<li>Angelo Parziale åˆ›å»ºäº†ä¸¤ä¸ªè¿ç§»ï¼š
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Freference%2Fmigrations%2Fngclass-to-class" target="_blank" title="https://angular.dev/reference/migrations/ngclass-to-class" ref="nofollow noopener noreferrer">å°† NgClass æŒ‡ä»¤è½¬æ¢ä¸ºç±»ç»‘å®š</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fangular.dev%2Freference%2Fmigrations%2Fngstyle-to-style" target="_blank" title="https://angular.dev/reference/migrations/ngstyle-to-style" ref="nofollow noopener noreferrer">å°† NgStyle æŒ‡ä»¤è½¬æ¢ä¸ºæ ·å¼ç»‘å®š</a></li>
</ul>
</li>
<li>Hyrhoori Avcharov ä¸º DevTools æ·»åŠ äº† <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fangular%2Fangular%2Fpull%2F62465" target="_blank" title="https://github.com/angular/angular/pull/62465" ref="nofollow noopener noreferrer">Transfer State æ ‡ç­¾</a>ï¼Œå…è®¸æ£€æŸ¥æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºä¹‹é—´çš„ TransferStateã€‚</li>
<li>Luke Beach åˆ›å»ºäº† CDK overlay åŠŸèƒ½ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fangular%2Fcomponents%2Fpull%2F29563" target="_blank" title="https://github.com/angular/components/pull/29563" ref="nofollow noopener noreferrer">å…è®¸æ¯ä¾§è®¾ç½®ç‹¬ç«‹çš„è§†å£è¾¹è·</a></li>
<li>Ruslan Lekhman åˆ›å»ºäº†ä¸€ä¸ª pull è¯·æ±‚ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fangular%2Fcomponents%2Fpull%2F31965" target="_blank" title="https://github.com/angular/components/pull/31965" ref="nofollow noopener noreferrer">å…è®¸å°†æ³¨å…¥å™¨ä¼ é€’ç»™ <code>MatBottomSheetConfig</code></a></li>
<li>CÃ©dric Exbrayat <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fangular%2Fangular-cli%2Fpull%2F30682" target="_blank" title="https://github.com/angular/angular-cli/pull/30682" ref="nofollow noopener noreferrer">ä¸º Vitest è¿è¡Œå™¨è´¡çŒ®äº†ä¸€ä¸ªåä¸º <code>outputFile</code> çš„é€‰é¡¹</a></li>
<li>Younes Jaaidi ä¸º <a href="https://link.juejin.cn?target=http%3A%2F%2Fangular.dev%2Fguide%2Ftesting" target="_blank" title="http://angular.dev/guide/testing" ref="nofollow noopener noreferrer">Vitest è¿è¡Œå™¨</a>è´¡çŒ®äº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fangular%2Fangular-cli%2Fpull%2F31783" target="_blank" title="https://github.com/angular/angular-cli/pull/31783" ref="nofollow noopener noreferrer">å¤šä¸ªæ”¹è¿›</a></li>
</ul>
<p>éå¸¸æ„Ÿè°¢æ‚¨å‚ä¸ Angular v21ï¼</p>
<p>æ‚¨å¯èƒ½è¿˜è®°å¾—æˆ‘ä»¬åœ¨ Angular v20 ç‰ˆæœ¬ä¸­å¾æ±‚è¿‡æ‚¨å¯¹å‰ç¥¥ç‰©çš„æ„è§ï¼æˆ‘ä»¬çš„å‰ç¥¥ç‰© RFC æ”¶åˆ°äº†åˆ›çºªå½•æ•°é‡çš„æäº¤ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å‘æ‚¨æ›´æ–°ã€‚æˆ‘ä»¬çŸ¥é“æ‚¨æƒ³è§åˆ°æˆ‘ä»¬çš„æ–°å‰ç¥¥ç‰©ï¼Œè¯·åŠ¡å¿…åœ¨ 2025 å¹´ 11 æœˆ 20 æ—¥ä¸Šåˆ 9 ç‚¹å¤ªå¹³æ´‹æ—¶é—´è§‚çœ‹æˆ‘ä»¬çš„å‘å¸ƒæ´»åŠ¨ï¼Œä»¥è·å–æ­£å¼å®£å¸ƒâ­</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d34d17f008b1417bac9d6863b8f76fae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv6LaF5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764211683&amp;x-signature=JnHNSi%2B81KIc3f%2FoOwQSiawAMi0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-8">æ„å»ºä¸‹ä¸€æ³¢åº”ç”¨ç¨‹åºçš„æ—¶åˆ»</h2>
<p>æˆ‘ä»¬å¯¹è¿™æ¬¡å‘å¸ƒæ„Ÿåˆ°æ— æ¯”è‡ªè±ªï¼Œä½†è¿™åªæ˜¯ Angular æ—…ç¨‹ä¸­çš„ä¸€æ­¥ã€‚æˆ‘ä»¬å¯†åˆ‡å…³æ³¨ç€æœªæ¥ Web åº”ç”¨ç¨‹åºå¼€å‘ä¸­çš„æ–°å…´æ¨¡å¼ã€‚</p>
<p>æˆ‘ä»¬å·²ç»çœ‹åˆ°äº† AI çš„åŠ›é‡ï¼Œå¹¶å¸Œæœ›å°½æˆ‘ä»¬æ‰€èƒ½ä¸ºæ‚¨æä¾›é€‚åˆæ‚¨å·¥ä½œæ–¹å¼çš„å·¥å…·ã€‚æ— è®ºæ˜¯é€šè¿‡ vibe ç¼–ç¨‹ã€AI ä»£ç†è¿˜æ˜¯ä¼ ç»Ÿå¼€å‘ã€‚</p>
<p>æˆ‘ä»¬çš„æœ€æ–°åŠŸèƒ½ï¼Œå¦‚ Signal Forms å’Œ Angular Ariaï¼Œæ˜¯æˆ‘ä»¬ç»§ç»­æ”¹è¿› API è¡¨é¢ï¼Œä½¿ Angular æˆä¸ºæ„å»ºå¯æ‰©å±• Web åº”ç”¨çš„ä¿¡å¿ƒä¹‹åœ°çš„è¯æ˜ã€‚</p>
<p>è¯·åŠ¡å¿…è¿è¡Œ <code>ng update</code> å¹¶åˆ›å»ºæ‚¨çš„ç”¨æˆ·ä¼šå–œçˆ±çš„åº”ç”¨ç¨‹åºã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸é™äºVueï¼vue-plugin-hiprint æ‰“å°æ’ä»¶å®Œæ•´ä½¿ç”¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7574382925760725030</link>    <guid>https://juejin.cn/post/7574382925760725030</guid>    <pubDate>2025-11-20T03:15:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574382925760725030" data-draft-id="7573521516325257243" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸é™äºVueï¼vue-plugin-hiprint æ‰“å°æ’ä»¶å®Œæ•´ä½¿ç”¨æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-11-20T03:15:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="MrBread"/> <meta itemprop="url" content="https://juejin.cn/user/761295078433239"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸é™äºVueï¼vue-plugin-hiprint æ‰“å°æ’ä»¶å®Œæ•´ä½¿ç”¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/761295078433239/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    MrBread
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:15:27.000Z" title="Thu Nov 20 2025 03:15:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83729a16871f457085e99529c099ad13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTXJCcmVhZA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764213327&amp;x-signature=cXmn%2Ffh8n53Jx%2FeJWsgNlMCwA2Y%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>vue-plugin-hiprintæ˜¯<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FCcSimple" target="_blank" title="https://gitee.com/CcSimple" ref="nofollow noopener noreferrer">ä½œè€…</a>åŸºäºhiprintäºŒæ¬¡å¼€å‘çš„æ‰“å°æ’ä»¶ï¼Œè™½ç„¶å¸¦ç€vueï¼Œä½†æ˜¯æ’ä»¶ä¸º<strong>å•çº¯çš„JavaScriptã€å·¥å…·åº“ã€‘</strong>ã€‚hiprintæ˜¯æœªå¼€æºçš„æ‰“å°æ’ä»¶ï¼Œå¯ä»¥åœ¨<a href="https://link.juejin.cn?target=http%3A%2F%2Fhiprint.io%2F" target="_blank" title="http://hiprint.io/" ref="nofollow noopener noreferrer">å®˜æ–¹åœ°å€</a>æŸ¥çœ‹éƒ¨åˆ†apiçš„ç”¨æ³•å’Œå®ä¾‹é¡¹ç›®æ“ä½œã€‚</p>
<p>vue-plugin-hiprintç›¸å…³æ•™ç¨‹å¯ä»¥æŸ¥çœ‹ï¼Œ<a href="https://juejin.cn/user/1662117311414462/posts" target="_blank" title="https://juejin.cn/user/1662117311414462/posts">ä¸ç®€è¯´ çš„ä¸ªäººä¸»é¡µ - æ–‡ç« </a>çš„ä¸»é¡µ-æ–‡ç« ä¸­ï¼Œæœ€åˆçš„æ–‡ç« é‡ŒåŒ…å«äº†æ•™ç¨‹å’Œå¸¸è§é—®é¢˜çš„è§£ç­”ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FCcSimple%2Fvue-plugin-hiprint-start" target="_blank" title="https://gitee.com/CcSimple/vue-plugin-hiprint-start" ref="nofollow noopener noreferrer">vue-plugin-hiprint-start</a>é¡¹ç›®ä¸­æœ‰å…·ä½“çš„ä½¿ç”¨å®ä¾‹</p>
<p>æœ¬æ•™ç¨‹æ•´ç†äº†è‡ªå·±çš„ä½¿ç”¨è¿‡ç¨‹ç»éªŒå’Œæ¥è§¦åˆ°çš„æ•™ç¨‹æ–‡æ¡£ï¼Œæ—¨åœ¨ä¸ºåˆæ¬¡æ¥è§¦åˆ°vue-plugin-hiprintå¼€å‘çš„äººï¼Œæä¾›åˆæ­¥çš„äº†è§£å’Œè‡ªå®šä¹‰å¼€å‘çš„æ–¹å‘</p>
<h2 data-id="heading-1">æ¦‚è¿°</h2>
<p>é¦–å…ˆå¯¹æ•´ä¸ªæ’ä»¶æœ‰ä¸€ä¸ªå¤§æ¦‚äº†è§£ï¼Œæ•´ä¸ªæ‰“å°æ’ä»¶åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œç»„ä»¶å…ƒç´ é¢æ¿ã€è®¾è®¡å™¨å’Œå±æ€§é¢æ¿ï¼ˆæ­¤å¤„æˆªå›¾ä½¿ç”¨çš„ä¸ºvue-plugin-hiprint-startç¤ºä¾‹é¡¹ç›®ï¼‰</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3e75cf2ce254266858222873e969a32~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTXJCcmVhZA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764213327&amp;x-signature=5NEIo2mhoFXq6hmO6GlczK3tjHA%3D" alt="image.png" loading="lazy"/></p>
<p>ç»„ä»¶å…ƒç´ é¢æ¿ä¸­ï¼Œ<strong>å·²ç»æ³¨å†Œçš„</strong>å…ƒç´ å¯ä»¥ç›´æ¥æ‹–æ‹½çš„åˆ°è®¾è®¡å™¨ä¸­ï¼Œè°ƒèŠ‚å¤§å°ã€‚å¯ä»¥æŒ‰ä½ctrlé”®è¿›è¡Œå¤šé€‰ï¼Œä½†æ‰“å°å±æ€§åªä¼šæ˜¾ç¤ºæœ€åé€‰æ‹©çš„å…ƒç´ ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„å®Œæ•´ä»£ç ç¤ºä¾‹ï¼Œéœ€è¦æ³¨æ„å‡ ç‚¹ï¼š1.å…ƒç´ é¢æ¿çš„ç»“æ„æ˜¯å®Œå…¨è‡ªå®šä¹‰çš„ï¼Œåªéœ€è¦ä¿è¯æ¯ä¸ªå…ƒç´ tidæ­£ç¡®å’Œdomå¯ä»¥ä¼ é€’ç»™æ„å»ºå‡½æ•° 2.hiprint.PrintTemplateå’Œdesignæ—¶ï¼Œé¡µé¢ä¸­å·²ç»æ¸²æŸ“äº†DOM</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex-row"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex-2 left"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- å…ƒç´ å®¹å™¨ï¼Œæ¯ä¸€ä¸ªå…ƒç´ æ˜¯å•ç‹¬çš„å®¹å™¨ï¼Œä»¥æ•°ç»„å½¢å¼ä¼ é€’ç»™buildByHtml --&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ep-draggable-item item"</span> <span class="hljs-attr">tid</span>=<span class="hljs-string">"defaultModule.text"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"iconfont sv-text"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>æ–‡æœ¬<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
     <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex-5 center"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- è®¾è®¡å™¨çš„ å®¹å™¨ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"hiprint-printTemplate"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex-2 right"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- å…ƒç´ å±æ€§çš„ å®¹å™¨ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"PrintElementOptionSetting"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { hiprint, defaultElementTypeProvider } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-plugin-hiprint'</span>;

<span class="hljs-comment">/* å·¦ä¾§å…ƒç´ é¢æ¿ */</span>
hiprint.<span class="hljs-title function_">init</span>({ <span class="hljs-attr">providers</span>: [<span class="hljs-title function_">defaultElementTypeProvider</span>()] }); <span class="hljs-comment">// providersæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¥å—ç»„ä»¶å…ƒç´ ï¼ŒProvideræä¾›çš„ç»„ä»¶å…ƒç´ ï¼ŒdefaultElementTypeProvideræ˜¯å†…ç½®Providerã€‚</span>
<span class="hljs-keyword">const</span> items = $(<span class="hljs-string">'.ep-draggable-item'</span>);
hiprint.<span class="hljs-property">PrintElementTypeManager</span>.<span class="hljs-title function_">buildByHtml</span>(items);

<span class="hljs-comment">// å±æ€§é¢æ¿é…ç½®</span>
hiprint.<span class="hljs-title function_">setConfig</span>();
<span class="hljs-comment">// è‡ªå®šä¹‰é…ç½®</span>
<span class="hljs-comment">// hiprint.setConfig(defaultPanelConfig); </span>

<span class="hljs-comment">/* è®¾è®¡å™¨ */</span>
$(<span class="hljs-string">"#hiprint-printTemplate"</span>).<span class="hljs-title function_">empty</span>(); <span class="hljs-comment">// å…ˆæ¸…ç©º, é¿å…é‡å¤æ„å»º</span>
hiprintTemplate = <span class="hljs-keyword">new</span> hiprint.<span class="hljs-title class_">PrintTemplate</span>({
	<span class="hljs-attr">settingContainer</span>: <span class="hljs-string">"#PrintElementOptionSetting"</span>, <span class="hljs-comment">// å±æ€§é¢æ¿å®¹å™¨</span>
});
hiprintTemplate.<span class="hljs-title function_">design</span>(<span class="hljs-string">"#hiprint-printTemplate"</span>);
<span class="hljs-comment">// æ‰“å°ä¸é¢„è§ˆ</span>
hiprintTemplate.<span class="hljs-title function_">print</span>()
hiprintTemplate.<span class="hljs-title function_">getHtml</span>()
</code></pre>
<h2 data-id="heading-2">å·¦ä¾§ç»„ä»¶å…ƒç´ é¢æ¿æ„å»º</h2>
<p>ç»„ä»¶å…ƒç´ çš„æ„å»ºåˆ†æˆä¸¤éƒ¨åˆ†ï¼Œä¸€æ˜¯providerï¼Œç”¨æ¥ç»™hiprintæä¾›ç»„ä»¶å…ƒç´ ï¼›äºŒæ˜¯domæ„å»ºä¸ç»‘å®šã€‚</p>
<h3 data-id="heading-3">ç®€å•æ„å»º</h3>
<p>å†…ç½®ç»„ä»¶Providerä¸ºhiprintæä¾›å…ƒç´ </p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { hiprint, defaultElementTypeProvider } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue-plugin-hiprint"</span>; 
<span class="hljs-comment">// defaultElementTypeProvideræ˜¯å†…ç½®çš„providerï¼Œå…¶ä¸­çš„å…ƒç´ å…·æœ‰tidçš„å±æ€§(å…·ä½“å¯ä»¥å‚è€ƒè‡ªå®šä¹‰provider)ï¼Œæ¯”å¦‚textçš„tidå±æ€§å°±æ˜¯defaultModule.textï¼Œè¿™ä¸domä¸­çš„tidå¯¹åº”</span>

hiprint.<span class="hljs-title function_">init</span>({ <span class="hljs-attr">providers</span>: [<span class="hljs-title function_">defaultElementTypeProvider</span>()] })
</code></pre>
<p><code>dom</code>æ„å»ºä¸ç»‘å®š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- DOMçš„æ„å»ºæ˜¯å®Œå…¨è‡ªå®šä¹‰ï¼Œåªè¦ä¿è¯ 1.èƒ½å¤Ÿè·å–åˆ°dom 2.domä¸Šå­˜åœ¨tidå±æ€§ --&gt;</span>
<span class="hljs-comment">&lt;!-- 
1.class="ep-draggable-item"ï¼Œä½¿ç”¨è¯¥ç±»åè·å–çœŸå®domï¼Œåœ¨buildByHtmlç»‘å®š
2.tidçš„å€¼ä¸defaultElementTypeProvider()ä¸­å…ƒç´ çš„tidå€¼å¯¹åº”
--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ep-draggable-item item"</span> <span class="hljs-attr">tid</span>=<span class="hljs-string">"defaultModule.text"</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>æ–‡æœ¬<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-js" lang="js">hiprint.<span class="hljs-property">PrintElementTypeManager</span>.<span class="hljs-title function_">buildByHtml</span>($(<span class="hljs-string">".ep-draggable-item"</span>)); <span class="hljs-comment">// ç»‘å®šé¡µé¢ä¸­çš„domã€‚ï¼ˆ$(".ep-draggable-item")ï¼Œjqueryè·å–domçš„å†™æ³•ï¼‰</span>
</code></pre>
<p>å†…ç½®å…ƒç´ ç±»å‹</p>
<pre><code class="hljs language-arduino" lang="arduino">æ’ä»¶æœ‰ä»¥ä¸‹å†…ç½®ç±»å‹
text æ–‡æœ¬
image å›¾ç‰‡
longText é•¿æ–‡æœ¬
table è¡¨æ ¼
html 
hline æ¨ªçº¿
vline ç«–çº¿
rect çŸ©å½¢
oval åœ†å½¢
barcode æ¡å½¢ç 
qrcode äºŒç»´ç 
</code></pre>
<p>defaultElementTypeProviderä¸­çš„tidå±æ€§å³ä¸º defaultModule.å±æ€§ç±»å‹ã€‚æ¯”å¦‚defaultModule.text</p>
<h3 data-id="heading-4">è‡ªå®šä¹‰provider</h3>
<p>providerçš„ç»“æ„ä¸º<code>provider = { addElementTypes }</code>ï¼Œæ‰€ä»¥åªéœ€è¦å…³æ³¨ addElementTypes çš„å®ç°</p>
<h4 data-id="heading-5">addElementTypes</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">addElementTypes</span> = (<span class="hljs-params">context: any</span>) =&gt; { <span class="hljs-comment">// contextæ˜¯hiprintè°ƒç”¨æ—¶ä¼ å…¥çš„å‚æ•°</span>
    context.<span class="hljs-title function_">removePrintElementTypes</span>(<span class="hljs-string">'providerModule'</span>); <span class="hljs-comment">// providerModuleè‡ªå®šä¹‰å…ƒç´ æ¨¡ç»„åç§°</span>
    context.<span class="hljs-title function_">addPrintElementTypes</span>(<span class="hljs-string">'providerModule'</span>, [ <span class="hljs-comment">// æ·»åŠ å…ƒç´ ç±»å‹çš„æ–¹æ³•</span>
        <span class="hljs-keyword">new</span> hiprint.<span class="hljs-title class_">PrintElementTypeGroup</span>(<span class="hljs-string">''</span>, [ <span class="hljs-comment">// åˆ›å»ºå…ƒç´ ç±»å‹</span>
            {
              <span class="hljs-attr">tid</span>: <span class="hljs-string">'providerModule.text'</span>, <span class="hljs-comment">// éœ€è¦ä¸htmlä¸Šå¯¹åº”çš„domä¸Šçš„è‡ªå®šä¹‰å±æ€§tidå¯¹åº”ï¼Œå³</span>
              <span class="hljs-attr">title</span>: <span class="hljs-string">'æ–‡æœ¬'</span>, <span class="hljs-comment">// æ‹–æ‹½æ—¶å‡ºç°çš„æ–‡æœ¬</span>
              <span class="hljs-attr">type</span>: <span class="hljs-string">'text'</span>, <span class="hljs-comment">// å…ƒç´ ç±»å‹ï¼Œæ­¤å¤„çš„textä¸ºå†…ç½®å…ƒç´ ç±»å‹</span>
              <span class="hljs-attr">options</span>: {}, <span class="hljs-comment">// å®šä¹‰æ‰“å°è®¾è®¡å™¨ä¸Šå…ƒç´ çš„æ ·å¼ã€åç§°ç­‰ç­‰ï¼Œè¿™äº›å±æ€§å¯ä»¥åœ¨å³ä¾§çš„å±æ€§é¢æ¿ä¸Šæ˜¾ç¤ºï¼Œè¿›è¡Œåœ¨çº¿ç¼–è¾‘</span>
            },
        ])
    ]) 
}
</code></pre>
<h4 data-id="heading-6">options</h4>
<p>å¯¹äºå¤§å¤šæ•°çš„ç±»å‹å¯ä»¥å‚è€ƒï¼Œhiprintçš„<a href="https://link.juejin.cn?target=http%3A%2F%2Fhiprint.io%2F" target="_blank" title="http://hiprint.io/" ref="nofollow noopener noreferrer">å®˜æ–¹</a>-ä¸­æ–‡æ–‡æ¡£-å·¦ä¾§èœå•ä»æ–‡æœ¬åˆ°é•¿æ–‡ã€‚æœ‰å‡ ä¸ªæ³¨æ„ç‚¹</p>
<p>1.ç®€å•è¯´æ˜ä¸€ä¸‹fieldå’Œfieldså±æ€§ã€‚ä¸¤ä¸ªå±æ€§å¡«å……çš„éƒ½æ˜¯åœ¨é¢„è§ˆï¼ˆgetHtmlï¼‰å’Œæ‰“å°ï¼ˆprintï¼‰çš„è·å–å…·ä½“æ•°æ®å­—æ®µåï¼ŒtestDataåœ¨è®¾è®¡çš„æ—¶å€™æ˜¾ç¤ºçš„æµ‹è¯•æ•°æ®</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
	field<span class="hljs-punctuation">:</span> 'name'<span class="hljs-punctuation">,</span> 
	fields<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span>field<span class="hljs-punctuation">:</span>'name' <span class="hljs-punctuation">,</span>text<span class="hljs-punctuation">:</span>'å§“å' <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-punctuation">{</span> field<span class="hljs-punctuation">:</span> 'sex'<span class="hljs-punctuation">,</span> text<span class="hljs-punctuation">:</span> 'æ€§åˆ«' <span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
const printData = <span class="hljs-punctuation">{</span>
    name<span class="hljs-punctuation">:</span> <span class="hljs-string">"123"</span><span class="hljs-punctuation">,</span>
    sex<span class="hljs-punctuation">:</span> <span class="hljs-string">"ç”·"</span><span class="hljs-punctuation">,</span>
    object<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        name<span class="hljs-punctuation">:</span> '<span class="hljs-number">456</span>'
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
hiprint.print(printData)<span class="hljs-comment">// å¯¹äºæ‰“å°å‡½æ•°ï¼Œè¯¦æƒ…çœ‹æ‰“å°æ¨¡å—</span>

<span class="hljs-number">1.</span>fieldå±æ€§çš„å€¼ç”¨æ¥å¡«å†™æ•°æ®(printData)ä¸­çš„å­—æ®µåã€‚fieldsæä¾›å¯é€‰æ‹©çš„å­—æ®µåï¼Œä¼šå°†å±æ€§é¢æ¿ä¸­å¯¹åº”çš„å­—æ®µçš„è¾“å…¥æ¡†å˜æˆé€‰æ‹©æ¡†ã€‚
<span class="hljs-number">2.</span>printå’ŒgetHtmlå¯ä»¥æ¥å—å•ä¸€æ•°æ®å’Œæ•°æ®æ•°ç»„ã€‚print(<span class="hljs-punctuation">[</span>printData<span class="hljs-punctuation">]</span>)
<span class="hljs-number">3.</span>ä¸¤è€…å¯ä»¥æ¥å—å±æ€§è®¿é—®çš„æ–¹å¼ï¼Œfield<span class="hljs-punctuation">:</span> 'object.name'
</code></pre>
<p>2.äºŒç»´ç ä¸æ¡çº¹ç ï¼Œä¼šæ ¹æ®æµ‹è¯•æ•°æ®æˆ–è€…å®é™…çš„æ•°æ®å¯¹åº”ç”Ÿæˆï¼ŒäºŒç»´ç åœ¨æ— æ•°æ®çš„æ—¶å€™ä¼šç”Ÿæˆå¤±è´¥ã€‚</p>
<p>3.æ›´å¤šçš„å±æ€§</p>
<p>å®˜ç½‘çš„htmlç±»å‹é¡µé¢æ˜¯æ‰“ä¸å¼€çš„ï¼Œæˆ–è€…å…¶ä»–å…ƒç´ æœ‰ä¸€äº›å±æ€§æ–‡æ¡£ä¸­æ²¡æœ‰å†™ï¼Œå¯ä»¥åœ¨è®¾è®¡å™¨ä¸­æ·»åŠ è¯¥å…ƒç´ ç„¶ååœ¨consoleé‡Œæ‰“å°æ¨¡æ¿çš„å®ä¾‹ï¼ŒæŒ‰ç…§<strong>printPanels</strong>-<strong>printElements</strong>-<strong>_printElementOptionTabs</strong>è·¯å¾„ï¼Œå¯ä»¥åœ¨æ­¤å¤„æŸ¥çœ‹å¯¹åº”çš„å±æ€§ã€‚</p>
<p>ï¼ˆpsï¼šå…ƒç´ çš„å±æ€§å€¼å…¨æ˜¯é»˜è®¤çš„æƒ…å†µæ—¶ï¼Œå…ƒç´ ä¸Šæ²¡æœ‰printElementOptionTabsï¼‰</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/35074cf521a345c4b40615a282075e83~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTXJCcmVhZA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764213327&amp;x-signature=WlSDM6CeDYo8ydnBZ9XRaYIT1%2FI%3D" alt="image.png" loading="lazy"/></p>
<p>4.å›¾ç‰‡</p>
<p>å›¾ç‰‡å…ƒç´ ï¼Œåœ¨å®ƒçš„å±æ€§é¢æ¿ä¸­æœ‰ä¸€ä¸ªå›¾ç‰‡åœ°å€çš„å±æ€§ï¼Œå¯¹åº”optionsä¸­çš„srcå­—æ®µï¼Œè¿™ä¸ªå±æ€§æ˜¯åœ¨è®¾è®¡æ—¶æ¨¡æ¿ä¸Šæ˜¾ç¤ºçš„å›¾ç‰‡åœ°å€ã€‚åœ¨å±æ€§é¢æ¿ä¸Šæœ‰ä¸€ä¸ªé€‰æ‹©æŒ‰é’®ï¼Œç‚¹å‡»é€‰æ‹©æŒ‰é’®è°ƒç”¨çš„æ˜¯æŒ‚è½½åœ¨æ¨¡æ¿å®ä¾‹ä¸Šçš„onImageChooseClickæŒ‰é’®ï¼Œå…¶ä¸­çš„å‚æ•°ä¸ºtargetï¼Œtarget.refresh(src)å¯ä»¥æ›´æ–°è¿™ä¸ªå±æ€§;</p>
<p>5.HTML</p>
<p>htmlå®é™…ä¸Šä½¿ç”¨çš„optionsé‡Œformatterï¼Œè¿”å›å…·ä½“htmlç»“æ„</p>
<pre><code class="hljs language-less" lang="less">formatter: "function(t,e,printData){return'&lt;div style=\"<span class="hljs-attribute">height</span>:<span class="hljs-number">50pt</span>;<span class="hljs-attribute">width</span>:<span class="hljs-number">50pt</span>;<span class="hljs-attribute">background</span>:red;<span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;\"&gt;&lt;/<span class="hljs-selector-tag">div</span>&gt;';}"
</code></pre>
<p>ps:</p>
<p>1.htmlç±»å‹åœ¨æ‰“å°å’Œé¢„è§ˆæ—¶ä¼šæœ‰ä¸€äº›å‡ºå…¥ï¼Œæ¯”å¦‚æ‰“å°æ—¶èƒŒæ™¯è‰²ä¼šè¢«å¿½ç•¥ï¼Œéœ€è¦è‡ªè¡Œè°ƒæ•´</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-keyword">@media</span> print {
    <span class="hljs-selector-tag">div</span> {
        -webkit-print-<span class="hljs-attribute">color</span>-adjust: exact;
        print-<span class="hljs-attribute">color</span>-adjust: exact;
    }
}
</code></pre>
<p>2.htmlçš„formatterä¸å›¾ç‰‡çš„formatterå‚æ•°ç›¸åŒï¼Œä¸å…¶ä»–å…ƒç´ ç±»å‹çš„formatteræœ‰ä¸€äº›åŒºåˆ«</p>
<h2 data-id="heading-7">è®¾è®¡å™¨</h2>
<h3 data-id="heading-8">åŸºç¡€</h3>
<pre><code class="hljs language-js" lang="js">$(<span class="hljs-string">"#hiprint-printTemplate"</span>).<span class="hljs-title function_">empty</span>(); <span class="hljs-comment">// å…ˆæ¸…ç©º, é¿å…é‡å¤æ„å»º</span>
hiprintTemplate = <span class="hljs-keyword">new</span> hiprint.<span class="hljs-title class_">PrintTemplate</span>({
    templateï¼š template
	<span class="hljs-attr">settingContainer</span>: <span class="hljs-string">"#PrintElementOptionSetting"</span>, <span class="hljs-comment">// å±æ€§é¢æ¿å®¹å™¨</span>
});
hiprintTemplate.<span class="hljs-title function_">design</span>(<span class="hljs-string">"#hiprint-printTemplate"</span>);
</code></pre>
<p>ç›¸å…³æ¦‚å¿µè§£é‡Šï¼š</p>
<p>æ¨¡æ¿ï¼Œæ¨¡æ¿æ˜¯ç”±hiprint.PrintTemplateåˆ›å»ºçš„å®ä¾‹ï¼Œå³ä¸ºé¡µé¢æ‰€å±•ç¤ºçš„åŒ…æ‹¬åˆ»åº¦å°ºåœ¨å†…çš„è®¾è®¡å™¨ï¼Œå®˜ç½‘<a href="https://link.juejin.cn?target=http%3A%2F%2Fhiprint.io%2Fdocs%2Ftemplate" target="_blank" title="http://hiprint.io/docs/template" ref="nofollow noopener noreferrer">hiprintæ¨¡æ¿</a>ä¸­æœ‰ç›¸å…³åˆå§‹åŒ–çš„å‚æ•°</p>
<p>é¢æ¿ï¼Œä¸€ä¸ªæ¨¡æ¿ä¸­å¯ä»¥åŒ…å«å¤šä¸ªé¢æ¿ï¼Œå¯ä»¥ç†è§£ä¸ºæ–°çš„ä¸€é¡µçº¸å¼ ï¼Œä½†æ˜¯åŒä¸€ä¸ªæ¨¡æ¿ä¸‹åŒæ—¶åªèƒ½å±•ç¤ºä¸€ä¸ªé¢æ¿ã€‚å®˜ç½‘<a href="https://link.juejin.cn?target=http%3A%2F%2Fhiprint.io%2Fdocs%2Fpanel" target="_blank" title="http://hiprint.io/docs/panel" ref="nofollow noopener noreferrer">hiprint.ioé¢æ¿</a>ä¸­æœ‰é¢æ¿çš„ç›¸å…³å‚æ•°ã€‚é¡µé¢ä¸­çš„å…ƒç´ æ˜¯å­˜å‚¨åœ¨é¢æ¿ä¸­ï¼Œ<a href="https://link.juejin.cn?target=http%3A%2F%2Fhiprint.io%2Fdemo" target="_blank" title="http://hiprint.io/demo" ref="nofollow noopener noreferrer">hiprint.ioçš„demo</a>é¡µé¢ä¸‹æœ‰ä¸€ä¸ªç”Ÿæˆjsonåˆ°textareaæŒ‰é’®ã€‚</p>
<p>å¯ä»¥çœ‹åˆ°templateå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªåŒ…å«panelså­—æ®µçš„jsonæ•°æ®ï¼Œè€Œpanelsæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚æ‰“å°æ¨¡æ¿å®ä¾‹ï¼Œåœ¨åŸå‹ä¸Šå¯ä»¥çœ‹åˆ°æ“ä½œé¢æ¿çš„æ–¹æ³•addPrintPanelã€selectPanelã€deletePanel</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77cd9defe4064bebbd14d42a62b554cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTXJCcmVhZA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764213327&amp;x-signature=VBrawz6D1SbCj48mAaWda41Zk6I%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">selectPanel</span>(index) æ¥å—çš„æ˜¯é¢æ¿çš„ç´¢å¼•
<span class="hljs-built_in">addPrintPanel</span>(options) æ¥å—çš„é¢æ¿å‚æ•°
<span class="hljs-built_in">deletePanel</span>(index) æ¥å—çš„æ˜¯é¢æ¿çš„ç´¢å¼•
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡hiprintTemplate.printPanelsæŸ¥çœ‹åˆ°å½“å‰çš„æ¨¡ç‰ˆï¼Œç„¶åé€šè¿‡ä¸Šè¿°å‡½æ•°ç®¡ç†é¢æ¿ã€‚ä¹Ÿå¯ä»¥é€šè¿‡æ•°ç»„æ¥ç®¡ç†panelï¼Œç„¶åé€šè¿‡æ•´ä½“é‡å¤æ„å»ºçš„ï¼Œé¿å…ä½¿ç”¨ä¸æ¸…æ¥šçš„å‡½æ•°ï¼Œå½“ç„¶è¿™æ ·é‡å¤æ„å»ºçš„æ€§èƒ½å¯èƒ½æ¯”è¾ƒå·®ã€‚</p>
<h3 data-id="heading-9">å¤šæ¨¡ç‰ˆ</h3>
<p>é¡µé¢å¯ä»¥åŒæ—¶å±•ç¤ºå¤šä¸ªæ¨¡æ¿ï¼Œåªéœ€è¦å¤šåˆ›å»ºä¸€ä¸ªæ¨¡æ¿å®ä¾‹ï¼Œç¤ºä¾‹å‚è§ä¸‹æ–¹ä»£ç ã€‚æ¨¡æ¿å®¹å™¨éœ€è¦å¤šä¸ªï¼Œä½†æ˜¯å±æ€§é¢æ¿å®¹å™¨å¯ä»¥å¤ç”¨ä¸€ä¸ªï¼Œå¹¶ä¸”å…ƒç´ éƒ½æ˜¯å…±äº«çš„ã€‚</p>
<pre><code class="hljs language-js" lang="js">  $(<span class="hljs-string">"#hiprint-printTemplate"</span>).<span class="hljs-title function_">empty</span>(); <span class="hljs-comment">// å…ˆæ¸…ç©º, é¿å…é‡å¤æ„å»º</span>
  hiprintTemplate = <span class="hljs-keyword">new</span> hiprint.<span class="hljs-title class_">PrintTemplate</span>({
    <span class="hljs-attr">template</span>: template, <span class="hljs-comment">// æ¨¡æ¿json(object)</span>
    <span class="hljs-attr">settingContainer</span>: <span class="hljs-string">"#PrintElementOptionSetting"</span>, <span class="hljs-comment">// å…ƒç´ å‚æ•°å®¹å™¨</span>
  });
  <span class="hljs-comment">// æ„å»º å¹¶å¡«å……åˆ° å®¹å™¨ä¸­</span>
  hiprintTemplate.<span class="hljs-title function_">design</span>(<span class="hljs-string">"#hiprint-printTemplate"</span>, { <span class="hljs-attr">grid</span>: <span class="hljs-literal">true</span> }); <span class="hljs-comment">// 0.0.46ç‰ˆæœ¬æ–°å¢, æ˜¯å¦æ˜¾ç¤ºç½‘æ ¼</span>
  <span class="hljs-comment">// ------ æ„å»ºå¤šä¸ªè®¾è®¡å™¨ ------</span>
  <span class="hljs-comment">// eslint-disable-next-line no-undef</span>
  $(<span class="hljs-string">"#hiprint-printTemplate2"</span>).<span class="hljs-title function_">empty</span>(); <span class="hljs-comment">// å…ˆæ¸…ç©º, é¿å…é‡å¤æ„å»º</span>
  hiprintTemplate2 = <span class="hljs-keyword">new</span> hiprint.<span class="hljs-title class_">PrintTemplate</span>({
    <span class="hljs-attr">template</span>: template2, <span class="hljs-comment">// æ¨¡æ¿json(object)</span>
    <span class="hljs-attr">settingContainer</span>: <span class="hljs-string">"#PrintElementOptionSetting"</span>, <span class="hljs-comment">// å…ƒç´ å‚æ•°å®¹å™¨</span>
  });
  <span class="hljs-comment">// æ„å»º å¹¶å¡«å……åˆ° å®¹å™¨ä¸­</span>
  hiprintTemplate2.<span class="hljs-title function_">design</span>(<span class="hljs-string">"#hiprint-printTemplate2"</span>);
</code></pre>
<h3 data-id="heading-10">APIè¡¥å……</h3>
<p>å®˜æ–¹çš„æ–‡æ¡£ä¸­åªæœ‰ä¸€éƒ¨åˆ†APIçš„æ–‡æ¡£ï¼Œå¯¹äºå…¶å®ƒAPIåœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦è‡ªå·±å»æŸ¥çœ‹å®ä¾‹ã€åŸå‹å’Œå¯¹åº”çš„æºç ã€‚å¯ä»¥åœ¨consoleä¸­æ‰“å°æ¨¡æ¿å®ä¾‹æˆ–è€…hiprintï¼Œæ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ï¼ˆæ¯”å¦‚selectPanelï¼‰ï¼Œåœ¨[[FunctionLocation]]æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8dcd3543c1c74138a48d75139fe0d97f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTXJCcmVhZA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764213327&amp;x-signature=UvZ8vXkItM4D0Sr7FFEkRxsar%2BI%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88ace6b831c74e60a1588ec89466f885~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTXJCcmVhZA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764213327&amp;x-signature=op88PZPlO2%2BKU5bUugyTytovjG8%3D" alt="image.png" loading="lazy"/></p>
<p>psï¼šå¦‚æœæºç æ²¡æœ‰æ ¼å¼åŒ–ï¼Œåœ¨æ§åˆ¶å°åº•éƒ¨æœ‰æ ¼å¼åŒ–çš„åŠŸèƒ½</p>
<p>ä¸¾ä¸€ä¸ªä¾‹å­æ¥è¯´ï¼Œ<strong>setPaper</strong>è®¾ç½®çº¸å¼ å¤§å°ï¼Œ<code>setPaper(width, height)</code></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// A4çº¸å¼ å¤§å°</span>
<span class="hljs-punctuation">{</span>
    width<span class="hljs-punctuation">:</span> <span class="hljs-number">210</span><span class="hljs-punctuation">,</span>
    height<span class="hljs-punctuation">:</span> <span class="hljs-number">297</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
</code></pre>
<p>ä½†æ˜¯ï¼ŒsetPaperæ–¹æ³•åªèƒ½è®¾ç½®å½“å‰çš„å±•ç¤ºçš„é¢æ¿çš„çº¸å¼ å¤§å°ï¼Œä¸ä¼šå½±å“å…¶å®ƒé¢æ¿ã€‚æŸ¥çœ‹å®ƒçš„æºç å‘ç°å®ƒåªè°ƒç”¨äº†editPanel.resizeï¼Œåªæ”¹å˜äº†å½“å‰ç¼–è¾‘çš„panelï¼Œæ‰€ä»¥å¦‚æœéœ€è¦ç»Ÿä¸€ä¿®æ”¹å¯ä»¥è·å–hiprintTemplate.printPanelsï¼Œå¯¹æ‰€æœ‰çš„panelæ‰§è¡Œresizeæ–¹æ³•ã€‚</p>
<p>éƒ¨åˆ†APIè¡¥å……ç®€è¿°</p>



































<table><thead><tr><th>åç§°</th><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>setElsAlign</td><td>type: left|right|vertical|top|horizontal|<br/>bottom|distributeHor|distributeVer</td><td>å¯¹é½å‡½æ•°ï¼Œåœ¨é¢æ¿ä¸Šé€‰ä¸­å…ƒç´ æ—¶ï¼Œè°ƒç”¨æ­¤å‡½æ•°å¯ä»¥è¿›è¡Œå¯¹é½æ“ä½œã€‚</td></tr><tr><td>zoom</td><td>number: float</td><td>æ”¾å¤§ç¼©å°å½“å‰é¢æ¿</td></tr><tr><td>selectPanel</td><td>number: int</td><td>åˆ‡æ¢å½“å‰æ˜¾ç¤ºçš„é¢æ¿ï¼Œå…¥å‚æ˜¯é¢æ¿åœ¨printPanelsä¸­çš„ç´¢å¼•</td></tr><tr><td>update</td><td>template</td><td>æ›´æ–°æ¨¡æ¿ï¼Œå…¥å‚ä¸ºæ»¡è¶³templateæ ¼å¼çš„json</td></tr><tr><td>getSelectEls</td><td/><td>è¿”å›é€‰ä¸­çš„å…ƒç´ ï¼ŒæŒ‰ä½ctrlå¯ä»¥å¤šé€‰</td></tr></tbody></table>
<h2 data-id="heading-11">å±æ€§é¢æ¿</h2>
<p>å±æ€§é¢æ¿çš„å„ç§é…ç½®éƒ½æ˜¯åœ¨setConfigå‡½æ•°å®Œæˆï¼Œä¸ä¼ å‚æ•°åˆ™ä¼šä½¿ç”¨é»˜è®¤å‚æ•°ã€‚configä¸­æœ‰ä¸¤ç§å­—æ®µï¼š</p>
<p>1.optionItemsï¼Œå¯ä»¥ç†è§£ä¸ºå±æ€§ç»„ä»¶åº“ï¼Œä¸ºå±æ€§é…ç½®å¯¹åº”æ ·å¼å’Œdom</p>
<p>2.å…ƒç´ ç±»å‹å­—æ®µï¼Œåœ¨æ­¤å¤„é…ç½®è¯¥å…ƒç´ é€‰ä¸­æ˜¯å±æ€§é¢æ¿çš„æ˜¾ç¤º</p>
<pre><code class="hljs language-js" lang="js">hiprint.<span class="hljs-title function_">setConfig</span>(config);

config = { <span class="hljs-comment">// é™¤äº†optionItemså¤–ï¼Œå…¶å®ƒçš„å­—æ®µåéƒ½æ˜¯æ¨¡æ¿ä¸Šæ˜¾ç¤ºçš„å„ç§å…ƒç´ çš„ç±»å‹ï¼ˆåŒ…æ‹¬é¢æ¿ï¼‰ï¼Œ</span>
    <span class="hljs-attr">optionItems</span>: [], <span class="hljs-comment">// è¯¦æƒ…è§ä¸‹</span>
    <span class="hljs-attr">text</span>: {
        <span class="hljs-attr">tabs</span>: [ <span class="hljs-comment">// å±æ€§é¢æ¿å…·ä½“æ¯ä¸€ä¸ªtabä¸‹çš„å±æ€§ï¼ŒæŒ‰ç…§printElementOptionTabsä¸­çš„é¡ºåº</span>
            { <span class="hljs-attr">options</span>: [] },
            { <span class="hljs-attr">options</span>: [] },
            { <span class="hljs-attr">options</span>: [] },
            {
              <span class="hljs-attr">name</span>: <span class="hljs-string">'åŸºç¡€'</span>,
              <span class="hljs-attr">replace</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å¯ä»¥æ›¿æ¢æ‰åŸæ¥çš„æ ‡ç­¾</span>
              <span class="hljs-attr">options</span>: [<span class="hljs-comment">// å±æ€§é¢æ¿ä¸Šæ¯ä¸€é¡¹çš„æ˜¾ç¤ºï¼Œé»˜è®¤å¯ä»¥åœ¨printElementOptionTabsä¸­æŸ¥æ‰¾ï¼Œè‡ªå®šä¹‰çš„nameä¸optionItemsä¸­å¯¹åº”</span>
                { <span class="hljs-attr">name</span>: <span class="hljs-string">'textType'</span>, <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span> }, 
                { <span class="hljs-attr">name</span>: <span class="hljs-string">'tableTextType'</span>, <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span> },
                { <span class="hljs-attr">name</span>: <span class="hljs-string">'barcodeMode'</span>, <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span> },
                { <span class="hljs-attr">name</span>: <span class="hljs-string">'barWidth'</span>, <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span> },
                { <span class="hljs-attr">name</span>: <span class="hljs-string">'barAutoWidth'</span>, <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span> },
                { <span class="hljs-attr">name</span>: <span class="hljs-string">'qrCodeLevel'</span>, <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span> },
              ],
            },
        ],
    },
    <span class="hljs-attr">panel</span>: {<span class="hljs-comment">// æ§åˆ¶panelçš„å±æ€§åœ¨å±æ€§é¢æ¿çš„æ˜¾ç¤ºï¼ŒsupportOptionsä¸‹é…ç½®</span>
        <span class="hljs-attr">supportOptions</span>: [
            { <span class="hljs-attr">name</span>: <span class="hljs-string">'firstPaperFooter'</span>, <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span> }, 
            { <span class="hljs-attr">name</span>: <span class="hljs-string">'evenPaperFooter'</span>, <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span> },
            { <span class="hljs-attr">name</span>: <span class="hljs-string">'oddPaperFooter'</span>, <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span> },
            { <span class="hljs-attr">name</span>: <span class="hljs-string">'lastPaperFooter'</span>, <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span> },
            { <span class="hljs-attr">name</span>: <span class="hljs-string">'panelLayoutOptions'</span>, <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span> },
        ]
    }
}
</code></pre>
<p>optionItemsï¼Œä»¥nameåšåŒºåˆ†ä¸è¢«å¼•ç”¨ã€‚å¦‚æœä¸å†…ç½®çš„nameç›¸åŒï¼Œåˆ™ä¼šæ›¿æ¢æ‰åŸæ¥çš„å±æ€§ç»„ä»¶ï¼›è‡ªå®šä¹‰çš„nameå¯ä»¥åœ¨tabsçš„optionsä¸­å¼•å…¥ä½¿ç”¨ã€‚</p>
<p>å…¶å†…éƒ¨é€šè¿‡class="auto-submit"ç»‘å®šäº‹ä»¶ï¼Œæ‰§è¡ŒgetValueæˆ–è€…setValueã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// optionItems</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> (<span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">t</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'paperNumberDisabled'</span>;
  }

  <span class="hljs-keyword">return</span> (
    (t.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">createTarget</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">_t, i</span>) { <span class="hljs-comment">// iå¯ä»¥è®¿é—®å…ƒç´ çš„options</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">target</span> = $(
        <span class="hljs-string">`&lt;div class="hiprint-option-item"&gt;\n        &lt;div class="hiprint-option-item-label"&gt;\n        æ˜¾ç¤ºé¡µç \n        &lt;/div&gt;\n        &lt;div class="hiprint-option-item-field"&gt;\n        &lt;select class="auto-submit"&gt;\n        &lt;option value="" &gt;æ˜¾ç¤º&lt;/option&gt;\n        &lt;option value="true" &gt;éšè—&lt;/option&gt;\n        &lt;/select&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;`</span>,
      )
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">target</span>;
    }),
    (t.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getValue</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) { <span class="hljs-comment">// getValueåœ¨æ¯æ¬¡èµ‹å€¼å±æ€§é¢æ¿çš„æ—¶å€™ï¼Œä¼šè¢«è°ƒç”¨</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-string">'true'</span> == <span class="hljs-variable language_">this</span>.<span class="hljs-property">target</span>.<span class="hljs-title function_">find</span>(<span class="hljs-string">'select'</span>).<span class="hljs-title function_">val</span>()) <span class="hljs-keyword">return</span> !<span class="hljs-number">0</span>;
    }),
    (t.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">setValue</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) { <span class="hljs-comment">// setValueæ¯æ¬¡å±•ç¤ºå±æ€§ç»‘å®šçš„å…ƒç´ çš„å±æ€§é¢æ¿æ—¶ï¼Œä¼šæ‰§è¡Œä¸€æ¬¡</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">target</span>.<span class="hljs-title function_">find</span>(<span class="hljs-string">'select'</span>).<span class="hljs-title function_">val</span>((<span class="hljs-literal">null</span> == t ? <span class="hljs-string">''</span> : t).<span class="hljs-title function_">toString</span>());
    }),
    (t.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">destroy</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">target</span>.<span class="hljs-title function_">remove</span>();
    }),
    t
  );
})();
</code></pre>
<h2 data-id="heading-12">æ‰“å°ä¸é¢„è§ˆ</h2>
<h3 data-id="heading-13">å•æ¨¡æ¿</h3>
<p>å•æ¨¡æ¿å¯ä»¥ç›´æ¥é€šè¿‡æ¨¡æ¿å®ä¾‹è°ƒç”¨æ‰“å°å‡½æ•°ã€‚æ‰“å°æ•°æ®ï¼Œå¯ä»¥ä¼ é€’å•ä¸€æ•°æ®<code>hiprintTemplate.print(printData)</code>ï¼Œä¹Ÿå¯ä»¥åƒç¤ºä¾‹ä¸€æ ·ä¼ é€’æ•°ç»„</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æ‰“å°æ•°æ®ï¼Œkey å¯¹åº” å…ƒç´ çš„ å­—æ®µå</span>
<span class="hljs-keyword">let</span> printData = { <span class="hljs-attr">name</span>: <span class="hljs-string">"CcSimple"</span>, <span class="hljs-attr">src</span>: <span class="hljs-string">"/favicon.ico"</span>, <span class="hljs-attr">object</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">"å¯¹è±¡å­—æ®µå€¼"</span> } };
<span class="hljs-comment">// å‚æ•°: æ‰“å°æ—¶è®¾ç½® å·¦åç§»é‡ï¼Œä¸Šåç§»é‡</span>
<span class="hljs-keyword">let</span> options = { <span class="hljs-attr">leftOffset</span>: -<span class="hljs-number">1</span>, <span class="hljs-attr">topOffset</span>: -<span class="hljs-number">1</span> };
<span class="hljs-comment">// æ‰©å±•</span>
<span class="hljs-keyword">let</span> ext = {
    <span class="hljs-attr">callback</span>: <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµè§ˆå™¨æ‰“å°çª—å£å·²æ‰“å¼€"</span>);
    },
    <span class="hljs-attr">styleHandler</span>: <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// é‡å†™ æ–‡æœ¬ æ‰“å°æ ·å¼</span>
      <span class="hljs-keyword">return</span> <span class="hljs-string">`
        &lt;link rel="stylesheet" href="/print-lock.css" /&gt;
        &lt;style&gt;
           @media print {
              div {
                  -webkit-print-color-adjust: exact;
                  print-color-adjust: exact;
              }
          }
        &lt;/style&gt;
      `</span>;
    },
};
hiprintTemplate.<span class="hljs-title function_">print</span>([printData], options, ext);
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰“å°çš„æ—¶å€™å¯èƒ½å‡ºç°å…ƒç´ éƒ½é‡å åœ¨ç¬¬ä¸€é¡µä¸Šï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦å¼•å…¥<code>print-lock.css</code>æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥åœ¨<code>node_modules/vue-plugin-hiprint/dist</code>ä¸­æ‰¾åˆ°</p>
<h3 data-id="heading-14">å¤šæ¨¡æ¿</h3>
<p>hiprintä¹Ÿæ˜¯å¯ä»¥å®ç°å¤šæ¨¡æ¿æ‰“å°çš„ï¼Œåˆ›å»ºä¸¤ä¸ªæ¨¡æ¿å®ä¾‹ï¼Œå¯¹åº”ç»‘å®šä¸åŒçš„å®¹å™¨å³å¯ï¼ˆå…ƒç´ å±æ€§é¢æ¿å¯ä»¥ç»‘å®šåŒä¸€ä¸ªï¼‰ã€‚</p>
<pre><code class="hljs language-js" lang="js">hiprint.<span class="hljs-title function_">print</span>({
    <span class="hljs-attr">templates</span>: [
      { <span class="hljs-attr">template</span>: hiprintTemplate, <span class="hljs-attr">data</span>: printData, <span class="hljs-attr">options</span>: { <span class="hljs-attr">topOffset</span>: <span class="hljs-number">100</span> } },
      { <span class="hljs-attr">template</span>: hiprintTemplate2, <span class="hljs-attr">data</span>: [printData2, printData3] },
    ],
});
</code></pre>
<p>å¤šæ¨¡ç‰ˆå¼•å…¥<code>print-lock.css</code>æ–‡ä»¶ï¼Œéœ€è¦åœ¨htmlä¸­é™æ€å¼•å…¥ã€‚</p>
<h3 data-id="heading-15">å…¶å®ƒæ³¨æ„ç‚¹</h3>
<p>1.ä½¿ç”¨æµè§ˆå™¨æ‰“å°çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå‡ºç°æµè§ˆå™¨è‡ªåŠ¨æ·»åŠ çš„é¡µè„šä¸é¡µçœ‰ã€‚1.è¿™è¯´æ˜å†…å®¹æ²¡æœ‰å¡«æ»¡æ•´å¼ çº¸ï¼Œä½¿ç”¨<code>@page { margin: 0cm; }</code>å¯ä»¥ä¸å±•ç¤ºè‡ªåŠ¨çš„é¡µè„šä¸é¡µçœ‰ã€‚ 2.panelä¸­çš„çº¸å¼ å¤§å°ä¸æµè§ˆå™¨æ‰“å°è®¾ç½®ä¸­çš„çº¸å¼ å¤§å°ä¸åŒ¹é…ï¼Œä¸ä¼ é€’panelçº¸å¼ å¤§å°æˆ–è€…è®©ä¸¤è€…åŒ¹é…ï¼Œå³å¯æ¶ˆé™¤æ‰ã€‚</p>
<p>psï¼španelä¸­çš„çº¸å¼ å¤§å°ä¼šè¢«æ¸²æŸ“ä¸º <code>@page { size: width height }</code>ï¼Œå®é™…ä¸Šå°±æ˜¯sizeä¸æ‰“å°è®¾ç½®çº¸å¼ çš„åŒ¹é…</p>
<p>2.å…³äºå…¶å®ƒæ‰“å°æ—¶çš„æ ·å¼é—®é¢˜ï¼Œåœ¨å®é™…è°ƒç”¨ä¸€æ¬¡printåï¼Œæµè§ˆå™¨ä¼šæ¸²æŸ“ä¸€ä¸ªidä¸ºhiwprint_iframeçš„iframeå…ƒç´ ï¼Œè¿™å°±æ˜¯å®é™…è¢«æ‰“å°çš„é¡µé¢ã€‚å¯ä»¥æ‹·è´å‡ºæ¥å¯»æ‰¾æ ·å¼é—®é¢˜ã€‚</p>
<h2 data-id="heading-16">æ€»ç»“</h2>
<p><strong>æ ¸å¿ƒä»·å€¼ï¼š</strong></p>
<ul>
<li>ğŸ–¨ï¸ å¯è§†åŒ–æ‹–æ‹½è®¾è®¡</li>
<li>ğŸ¨ é«˜åº¦å¯å®šåˆ¶ï¼Œä»å…ƒç´ åˆ°å±æ€§é¢æ¿éƒ½èƒ½è‡ªç”±æ‰©å±•</li>
<li>ğŸ”§ å¤šæ¨¡æ¿æ”¯æŒï¼Œåº”å¯¹å¤æ‚æ‰“å°åœºæ™¯</li>
</ul>
<p><strong>ä½¿ç”¨å»ºè®®ï¼š</strong></p>
<ul>
<li>åˆæ¬¡ä½¿ç”¨å»ºè®®ä»å†…ç½®å…ƒç´ å¼€å§‹ï¼Œé€æ­¥æ·±å…¥è‡ªå®šä¹‰</li>
<li>é‡åˆ°æ ·å¼é—®é¢˜ä¼˜å…ˆæ£€æŸ¥Â <code>print-lock.css</code>Â å’Œæ‰“å°åª’ä½“æŸ¥è¯¢</li>
<li>å½“å‰æ–‡æ¡£å’Œå®˜ç½‘æ–‡æ¡£ä¸­çš„APIåº”è¯¥è¶³å¤Ÿæ»¡è¶³å¤§å¤šæ•°çš„éœ€æ±‚ï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦å–„ç”¨æµè§ˆå™¨æ§åˆ¶å°æ¢ç´¢æœªæ–‡æ¡£åŒ–çš„ API</li>
</ul>
<p>ğŸ‘åˆ›ä½œä¸æ˜“ï¼Œå¦‚æœ‰é”™è¯¯è¯·æŒ‡æ­£ï¼Œæ„Ÿè°¢è§‚çœ‹ï¼è®°å¾—ç‚¹ä¸ªèµå“¦ï¼ğŸ‘</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäº Vue2 å°è£…å¤§å RTSP å›æ”¾è§†é¢‘ç»„ä»¶ï¼ˆPlayerControl.js å®ç°ï¼‰]]></title>    <link>https://juejin.cn/post/7574329472923271202</link>    <guid>https://juejin.cn/post/7574329472923271202</guid>    <pubDate>2025-11-20T03:16:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574329472923271202" data-draft-id="7574327911660093440" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäº Vue2 å°è£…å¤§å RTSP å›æ”¾è§†é¢‘ç»„ä»¶ï¼ˆPlayerControl.js å®ç°ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2025-11-20T03:16:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¥¿æ„šwo"/> <meta itemprop="url" content="https://juejin.cn/user/3175820923256430"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäº Vue2 å°è£…å¤§å RTSP å›æ”¾è§†é¢‘ç»„ä»¶ï¼ˆPlayerControl.js å®ç°ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3175820923256430/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¥¿æ„šwo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:16:58.000Z" title="Thu Nov 20 2025 03:16:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fm0_57997609%2Farticle%2Fdetails%2F154698097" target="_blank" title="https://blog.csdn.net/m0_57997609/article/details/154698097" ref="nofollow noopener noreferrer">åŸºäº Vue3 å°è£…å¤§å RTSP å›æ”¾è§†é¢‘ç»„ä»¶ï¼ˆPlayerControl.js å®ç°ï¼‰_vue playercontrolå¤§åçš„ä½¿ç”¨-CSDNåšå®¢</a></p>
<p>å®˜æ–¹æ•™ç¨‹ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fsupport.dahuatech.com%2FdataSectionDetail%2Fd289d237163b4c75a2e2e0c8489117f1" target="_blank" title="https://support.dahuatech.com/dataSectionDetail/d289d237163b4c75a2e2e0c8489117f1" ref="nofollow noopener noreferrer">WEBæ— æ’ä»¶å¼€å‘åŒ…ä½¿ç”¨è¯´æ˜-æµ™æ±Ÿå¤§åæŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸</a></p>
<p>ç¢°åˆ°çš„é—®é¢˜ï¼š 1ã€PlayerControl.jsé»˜è®¤æ˜¯åœ¨æ ¹ç›®å½•ä½¿ç”¨ï¼Œå¦‚æœä¸æ˜¯åœ¨æ ¹ç›®å½•ä½¿ç”¨éœ€è¦ä¿®æ”¹å¯¹åº”æ–‡ä»¶ä¸­çš„çš„è·¯å¾„ï¼ˆæˆ‘çš„å‰ç¼€æ˜¯cockpitï¼‰ä¸ç„¶ä¼šæ‰¾ä¸åˆ°å¯¹åº”çš„æ–‡ä»¶</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13c2c3a2fa9c40c5b056a6d0f7e740d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KW_5oSad28=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764213500&amp;x-signature=uoPzJbo%2F31JfwSlfjD80I%2FYWsx4%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f287759035842d39d582841e1c87410~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KW_5oSad28=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764213500&amp;x-signature=E7WJT%2F2YQZ17R64eudQGy8kM7ro%3D" alt="image.png" loading="lazy"/></p>
<p>2ã€æˆ‘å¯¹æ¥çš„å¤§åçš„æ‘„åƒå¤´æ˜¯H265æ ¼å¼çš„åªèƒ½åœ¨canvasä¸­å±•ç°å‡ºæ¥ï¼Œæˆ‘è¿™è¾¹çš„åŠŸèƒ½éœ€è¦æ˜¯å¯¹è§†é¢‘è¿›è¡Œå›æ”¾å’Œå‚è€ƒé“¾æ¥ç±»ä¼¼ï¼Œä½†æ˜¯å‚è€ƒé“¾æ¥æ˜¯èƒ½åœ¨videoä¸­å±•ç¤ºå› æ­¤ä¸éœ€è¦æ·»åŠ æ’­æ”¾ã€æš‚åœã€éŸ³é‡å¼€å…³ã€æŠ“å›¾ã€åˆ·æ–°ã€å…¨å±åŠŸèƒ½ï¼Œcanvasä¸­å°±éœ€è¦æ‰‹åŠ¨æ·»åŠ </p>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-dialog</span> <span class="hljs-attr">:title</span>=<span class="hljs-string">"'æ–‡ä»¶é¢„è§ˆ'"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"prev-file-dialog"</span> <span class="hljs-attr">append-to-body</span> <span class="hljs-attr">:visible.sync</span>=<span class="hljs-string">"DialogVisible"</span> <span class="hljs-attr">:fullscreen</span>=<span class="hljs-string">"true"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">title</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"vn-flex vn-flex-space-between vn-gap-8 vn-flex-y-center vn-fill-width"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{{ 'æ–‡ä»¶é¢„è§ˆ' }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"preview-pdf"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"canvasElement"</span> <span class="hljs-attr">:style</span>=<span class="hljs-string">"{ width: '100%', height: '100%' }"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"operation"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"operation-left vn-flex vn-flex-y-center vn-gap-8"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
            <span class="hljs-attr">class</span>=<span class="hljs-string">"play icon vn-pointer"</span>
            <span class="hljs-attr">:class</span>=<span class="hljs-string">"canvasOperation.playState ? 'el-icon-video-pause' : 'el-icon-video-play'"</span>
            @<span class="hljs-attr">click</span>=<span class="hljs-string">"handlePlay"</span>
          &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"disconnect icon"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"control-btn"</span> @<span class="hljs-attr">click.stop</span>=<span class="hljs-string">"toggleMute"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"!canvasOperation.muteState"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"icon-volume"</span>&gt;</span>ğŸ”Š<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-else</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"icon-muted"</span>&gt;</span>ğŸ”‡<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"timestamp vn-flex vn-flex-y-center vn-gap-4"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"first-time"</span>&gt;</span>{{ canvasOperation.firstTime }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            /
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"total-time"</span>&gt;</span>{{ canvasOperation.totalTime }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">el-input-number</span>
              <span class="hljs-attr">v-model</span>=<span class="hljs-string">"canvasOperation.backTime"</span>
              <span class="hljs-attr">size</span>=<span class="hljs-string">"mini"</span>
              <span class="hljs-attr">clearable</span>
              <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
              <span class="hljs-attr">:min</span>=<span class="hljs-string">"0"</span>
              <span class="hljs-attr">:max</span>=<span class="hljs-string">"canvasOperation.totalTime"</span>
              <span class="hljs-attr">:controls</span>=<span class="hljs-string">"false"</span>
              <span class="hljs-attr">class</span>=<span class="hljs-string">"number-input"</span>
              <span class="hljs-attr">:precision</span>=<span class="hljs-string">"0"</span>
            &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-input-number</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"mini"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"playerBack"</span>&gt;</span>è·³è½¬<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"operation-right vn-flex vn-flex-y-center vn-gap-12"</span>&gt;</span>
          <span class="hljs-comment">&lt;!-- æ•è·æˆªå›¾ --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"el-icon-crop icon"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleCapture"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

          <span class="hljs-comment">&lt;!-- åˆ·æ–° --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"el-icon-refresh-right icon"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleRefresh"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-comment">&lt;!-- å…¨å±æŒ‰é’® --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"el-icon-full-screen icon"</span> @<span class="hljs-attr">click.stop</span>=<span class="hljs-string">"toggleFullscreen"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">el-dialog</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Component</span>, <span class="hljs-title class_">Vue</span>, <span class="hljs-title class_">Ref</span>, <span class="hljs-title class_">Prop</span>, <span class="hljs-title class_">PropSync</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-property-decorator'</span>

@<span class="hljs-title class_">Component</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'DaHuaVideoPreview'</span>,
  <span class="hljs-attr">components</span>: {}
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DaHuaVideoPreview</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Vue</span> {
  @<span class="hljs-title class_">Ref</span>() canvasElement!: any
  @<span class="hljs-title class_">PropSync</span>(<span class="hljs-string">'visible'</span>, { <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span> }) <span class="hljs-title class_">DialogVisible</span>!: boolean
  <span class="hljs-comment">// æ¥æ”¶å¤–éƒ¨å‚æ•°</span>
  @<span class="hljs-title class_">Prop</span>({
    <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">wsURL</span>: <span class="hljs-string">'ws://xxx.xxx.xxx.xxx:9527/rtspoverwebsocket'</span>,
        <span class="hljs-attr">url</span>: <span class="hljs-string">''</span>,
        <span class="hljs-attr">ip</span>: <span class="hljs-string">'xxx.xxx.xxx.xxx'</span>,
        <span class="hljs-attr">port</span>: <span class="hljs-string">'9527'</span>,
        <span class="hljs-attr">channel</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">username</span>: <span class="hljs-string">'admin'</span>,
        <span class="hljs-attr">password</span>: <span class="hljs-string">'admin123'</span>,
        <span class="hljs-attr">proto</span>: <span class="hljs-string">'Private3'</span>,
        <span class="hljs-attr">subtype</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">starttime</span>: <span class="hljs-string">'2025_11_10_09_10_00'</span>,
        <span class="hljs-attr">endtime</span>: <span class="hljs-string">'2025_11_10_10_10_00'</span>,
        <span class="hljs-attr">width</span>: <span class="hljs-string">'100%'</span>,
        <span class="hljs-attr">height</span>: <span class="hljs-string">'220px'</span>
      }
    }
  })
  props!: any

  <span class="hljs-attr">player</span>: any = <span class="hljs-literal">null</span>
  canvasOperation = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initCanvasData</span>()

  <span class="hljs-title function_">initCanvasData</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">playState</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">muteState</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">isFullscreen</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">backTime</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">totalTime</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">firstTime</span>: <span class="hljs-number">0</span>
    }
  }
  <span class="hljs-title function_">playerStop</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>?.<span class="hljs-title function_">close</span>()
  }

  <span class="hljs-title function_">playerPause</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>?.<span class="hljs-title function_">pause</span>()
  }

  <span class="hljs-title function_">playerContinue</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// this.player?.play()</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">playerPlay</span>()
  }

  <span class="hljs-title function_">playerCapture</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>?.<span class="hljs-title function_">capture</span>(<span class="hljs-string">'test'</span>)
  }

  <span class="hljs-title function_">playerPlay</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">stop</span>()
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">close</span>()
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-literal">null</span>
    }
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">window</span>.<span class="hljs-property">PlayerControl</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'âŒ PlayerControl SDK æœªåŠ è½½ï¼Œè¯·åœ¨ index.html ä¸­å¼•å…¥ /module/playerControl.js'</span>)
      <span class="hljs-keyword">return</span>
    }

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">closePlayer</span>()

    <span class="hljs-keyword">var</span> options = {
      <span class="hljs-attr">wsURL</span>: <span class="hljs-string">`ws://<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.props.ip}</span>:<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.props.port}</span>/rtspoverwebsocket`</span>,
      <span class="hljs-attr">rtspURL</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">buildRtspUrl</span>(),
      <span class="hljs-attr">username</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>.<span class="hljs-property">username</span>,
      <span class="hljs-attr">password</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>.<span class="hljs-property">password</span>,
      <span class="hljs-attr">h265AccelerationEnabled</span>: <span class="hljs-literal">true</span>
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title class_">PlayerControl</span>(options)
    <span class="hljs-keyword">let</span> firstTime = <span class="hljs-number">0</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'WorkerReady'</span>, <span class="hljs-function">(<span class="hljs-params">rs: any</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'WorkerReady'</span>)
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">connect</span>()
    })

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'Error'</span>, <span class="hljs-function">(<span class="hljs-params">rs: any</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'error'</span>)
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rs)
    })
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'PlayStart'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'PlayStart'</span>)
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasOperation</span>.<span class="hljs-property">playState</span> = <span class="hljs-literal">true</span>
    })

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'UpdateCanvas'</span>, <span class="hljs-function">(<span class="hljs-params">res: any</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (firstTime === <span class="hljs-number">0</span>) {
        firstTime = res.<span class="hljs-property">timestamp</span> <span class="hljs-comment">//è·å–å½•åƒæ–‡ä»¶çš„ç¬¬ä¸€å¸§çš„æ—¶é—´æˆ³</span>
      }
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasOperation</span>.<span class="hljs-property">firstTime</span> = res.<span class="hljs-property">timestamp</span> - firstTime
    })
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'GetTotalTime'</span>, <span class="hljs-function">(<span class="hljs-params">res: any</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res, <span class="hljs-string">'GetTotalTime'</span>)
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasOperation</span>.<span class="hljs-property">totalTime</span> = res || <span class="hljs-number">0</span>
    })

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'FileOver'</span>, <span class="hljs-function">(<span class="hljs-params">res: any</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res, <span class="hljs-string">'FileOver'</span>)
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleRefresh</span>()
    })
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">init</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasElement</span>, <span class="hljs-literal">null</span>)
    <span class="hljs-variable language_">window</span>.<span class="hljs-property">__player</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>
  }

  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>, <span class="hljs-string">'props'</span>)
    <span class="hljs-variable language_">this</span>.$nextTick(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">playerContinue</span>()
    })
  }

  <span class="hljs-title function_">beforeDestroy</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">closePlayer</span>()
  }

  <span class="hljs-title function_">playerBack</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">playByTime</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasOperation</span>.<span class="hljs-property">backTime</span>)
  }

  <span class="hljs-comment">/** æ‹¼æ¥ RTSP URL å›æ”¾ */</span>
  <span class="hljs-title function_">buildRtspUrl</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>?.<span class="hljs-property">url</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>?.<span class="hljs-property">url</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">`rtsp://<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.props.ip}</span>:<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.props.port}</span>/cam/playback?channel=<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.props.channel}</span>&amp;subtype=<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.props.subtype}</span>&amp;starttime=<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.props.starttime}</span>&amp;endtime=<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.props.endtime}</span>`</span>
  }

  <span class="hljs-title function_">closePlayer</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">close</span>()
      } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'æ—§æ’­æ”¾å™¨å…³é—­å¼‚å¸¸:'</span>, e)
      }
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-literal">null</span>
    }
  }

  <span class="hljs-title function_">toggleMute</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasOperation</span>.<span class="hljs-property">muteState</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasOperation</span>.<span class="hljs-property">muteState</span>
    <span class="hljs-comment">// å¦‚æœè¦å…³é—­å£°éŸ³ï¼Œå°† val å‚æ•°è®¾ç½®ä¸º 0 å³å¯ã€‚WEB SDK æ’­æ”¾æ—¶ï¼Œé»˜è®¤éŸ³é‡æ˜¯ 0ã€‚éœ€è¦å£°éŸ³æ—¶ï¼Œå¿…é¡»è°ƒç”¨è¯¥æ–¹æ³•ï¼Œå¹¶ä¸”å‚æ•°å¤§äº 0</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">setAudioVolume</span>(<span class="hljs-title class_">Number</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasOperation</span>.<span class="hljs-property">muteState</span>))
  }

  <span class="hljs-title function_">toggleFullscreen</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> videoWrapper = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$el</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.preview-pdf'</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span>

    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">document</span>.<span class="hljs-property">fullscreenElement</span>) {
      <span class="hljs-comment">// è¿›å…¥å…¨å±</span>
      <span class="hljs-keyword">if</span> (videoWrapper.<span class="hljs-property">requestFullscreen</span>) {
        videoWrapper.<span class="hljs-title function_">requestFullscreen</span>()
      }
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasOperation</span>.<span class="hljs-property">isFullscreen</span> = <span class="hljs-literal">true</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// é€€å‡ºå…¨å±</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">exitFullscreen</span>) {
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">exitFullscreen</span>()
      }
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasOperation</span>.<span class="hljs-property">isFullscreen</span> = <span class="hljs-literal">false</span>
    }
  }
  <span class="hljs-comment">//</span>
  <span class="hljs-title function_">handlePlay</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasOperation</span>.<span class="hljs-property">playState</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">play</span>()
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">pause</span>()
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasOperation</span>.<span class="hljs-property">playState</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasOperation</span>.<span class="hljs-property">playState</span>
  }

  <span class="hljs-title function_">handleCapture</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>.<span class="hljs-title function_">capture</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>())
  }

  <span class="hljs-title function_">handleRefresh</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasOperation</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initCanvasData</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">playerPlay</span>()
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.preview-pdf</span> {
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;

  <span class="hljs-attribute">position</span>: relative;

  <span class="hljs-selector-class">.operation</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">40px</span>;
    <span class="hljs-attribute">position</span>: absolute;
    <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1</span>;
    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.5</span>);

    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">justify-content</span>: space-between;
    <span class="hljs-attribute">gap</span>: <span class="hljs-number">8px</span>;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">16px</span>;
    <span class="hljs-selector-class">.play</span> {
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;
    }
    <span class="hljs-selector-class">.icon</span> {
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>;
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
      <span class="hljs-attribute">cursor</span>: pointer;
    }
    <span class="hljs-selector-class">.control-btn</span> {
      <span class="hljs-attribute">background-color</span>: transparent;
      <span class="hljs-selector-tag">span</span> {
        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">18px</span>;
      }
    }
  }
  <span class="hljs-selector-class">.timestamp</span> {
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
    <span class="hljs-attribute">flex-shrink</span>: <span class="hljs-number">0</span>;

    <span class="hljs-selector-class">.first-time</span>,
    <span class="hljs-selector-class">.total-time</span> {
      <span class="hljs-attribute">flex-shrink</span>: <span class="hljs-number">0</span>;
    }
    <span class="hljs-selector-class">.number-input</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
    }
  }
}

<span class="hljs-selector-class">.prev-file-dialog</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100vw</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>;
  ::v-deep {
    <span class="hljs-selector-class">.el-dialog</span><span class="hljs-selector-class">.is-fullscreen</span> {
      <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
    }
    <span class="hljs-selector-class">.el-dialog</span> {
      <span class="hljs-attribute">min-width</span>: <span class="hljs-number">80vw</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">70vh</span>);
    }
    <span class="hljs-selector-class">.el-dialog__body</span> {
      <span class="hljs-attribute">max-height</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">min-height</span>: <span class="hljs-number">0</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">overflow</span>: hidden;
      <span class="hljs-attribute">display</span>: flex;
      <span class="hljs-attribute">justify-content</span>: center;
      <span class="hljs-attribute">align-items</span>: center;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">12px</span> <span class="hljs-meta">!important</span>;
      <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;
    }
  }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>

</code></pre>
<p>å®ç°æ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bf00fd18bbd54782ac3cd0aa4c2c4ee2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KW_5oSad28=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764213500&amp;x-signature=iDHD7ON2gVk7KB0uN854WD7%2Bbrk%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æœ€è¿‘è‹¹æœå®¡æ ¸æ•ˆç‡æé«˜äº†ï¼Œå‘¨æœ«ç«Ÿç„¶éƒ½åœ¨å®¡æ ¸ã€‚]]></title>    <link>https://juejin.cn/post/7574568258800959515</link>    <guid>https://juejin.cn/post/7574568258800959515</guid>    <pubDate>2025-11-20T03:35:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574568258800959515" data-draft-id="7574357603406233650" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æœ€è¿‘è‹¹æœå®¡æ ¸æ•ˆç‡æé«˜äº†ï¼Œå‘¨æœ«ç«Ÿç„¶éƒ½åœ¨å®¡æ ¸ã€‚"/> <meta itemprop="keywords" content="APP,Apple,uni-app"/> <meta itemprop="datePublished" content="2025-11-20T03:35:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="iOSç ”ç©¶é™¢"/> <meta itemprop="url" content="https://juejin.cn/user/1421041942671774"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æœ€è¿‘è‹¹æœå®¡æ ¸æ•ˆç‡æé«˜äº†ï¼Œå‘¨æœ«ç«Ÿç„¶éƒ½åœ¨å®¡æ ¸ã€‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1421041942671774/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    iOSç ”ç©¶é™¢
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:35:04.000Z" title="Thu Nov 20 2025 03:35:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>æœ€è¿‘æ²¡æœ‰æ€ä¹ˆæ›´æ–°æ–‡ç« ï¼Œæ˜¯å› ä¸ºåœ¨è¿­ä»£ä¹‹å‰çš„è€äº§å“ã€‚æ­£å¥½æŠŠè¿™ä»Šå¤©è‡ªå·±è¿­ä»£çš„æƒ…å†µï¼Œè®²ä¸€ä¸‹ã€‚</p>
<p>æ›´æ–°äº†7æ¬¾äº§å“ï¼Œå…¶ä¸­4æ¬¾å·¥å…·ç±»äº§å“ï¼Œ1æ¬¾ç”Ÿæ´»ç±»ï¼Œ1æ¬¾å¨±ä¹ç±»ï¼Œ1æ¬¾å‚è€ƒç±»ã€‚</p>
<h3 data-id="heading-1">å·¥å…·ç±»</h3>
<p>ä»è¿­ä»£å‘¨æœŸå’Œè¿­ä»£æ—¶é—´æ¥çœ‹ï¼Œå·¥å…·ç±»çš„è¿­ä»£æ—¶é—´å’Œä¹‹å‰ä¸€æ ·ã€‚<code>å¹³å‡åœ¨40åˆ†å·¦å³å‡ºç»“æœï¼Œéƒ½æ˜¯ä¸€æŠŠè¿‡</code>ã€‚æ¯•ç«Ÿå·¥å…·ç±»äºŒè¿›åˆ¶æ”¹åŠ¨ä¸å¤šï¼Œä¸»è¦æ˜¯ç»´æŠ¤ä¸€äº›ç»†èŠ‚æ€§å…¼å®¹é—®é¢˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e480d8c54baf4902ac123d34489384c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaU9T56CU56m26Zmi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764214504&amp;x-signature=aQlJ7bmrDvfny6INeasW217%2Bm1o%3D" alt="777.png" loading="lazy"/></p>
<p>å€¼å¾—å…³æ³¨çš„æ˜¯ï¼ŒåŸºæœ¬ä¸Šåœ¨16å·ï¼Œï¼ˆå³å‘¨æœ«ï¼‰æäº¤çš„äº§å“ï¼Œ<code>åŸºæœ¬ä¸Šæ²¡æœ‰å¤šä¹…å°±è¿›å…¥æ­£åœ¨å®¡æ ¸çŠ¶æ€</code>ã€‚è¿™ä¸€ç‚¹å’Œä¸Šä¸€æœˆæˆªç„¶ä¸åŒï¼Œå¦‚æœæ˜¯ä¸Šä¸ªæœˆå‘¨æœ«æäº¤çš„äº§å“ï¼Œæ™®éåœ¨å‘¨ä¸‰æ™šä¸Šå·¦å³æ‰ä¼šè¿›å…¥å®¡æ ¸ç¯èŠ‚ã€‚</p>
<h3 data-id="heading-2">å…¶ä½™åˆ†ç±»</h3>





























<table><thead><tr><th>åˆ†ç±»å</th><th>ç­‰å¾…æ—¶é—´</th><th>å®¡æ ¸æ—¶é—´</th><th>è¢«æ‹’æ¬¡æ•°</th></tr></thead><tbody><tr><td>ç”Ÿæ´»</td><td>1 å¤©</td><td>65 åˆ†é’Ÿ</td><td>0</td></tr><tr><td>å¨±ä¹</td><td>2 å¤©åŠ</td><td>45 åˆ†é’Ÿ</td><td>1</td></tr><tr><td>å‚è€ƒ</td><td>1 å¤©åŠ</td><td>90 åˆ†é’Ÿ</td><td>0</td></tr></tbody></table>
<p>åŸºæœ¬ä¸Šæ¥è¯´ï¼Œæ•´ä½“éƒ½éå¸¸é¡ºåˆ©ã€‚å¨±ä¹è¢«æ‹’çš„åŸå› æ˜¯å› ä¸ºæ–‡æ¡ˆè¯´æ˜åŒ…å«äº†"å…è´¹ä½“éªŒ"ç›¸å…³çš„å­—çœ¼ï¼Œæ›´æ–°åˆ°äº†å¸‚åœºæˆªå›¾é‡Œã€‚
<strong>å¯¹äºè‹¹æœæ¥è¯´ï¼Œä¸æ¥å—åœ¨å¸‚åœºå›¾ï¼ŒAPPåç§°ä»¥åŠå‰¯æ ‡é¢˜ï¼Œä½“ç°ä»»ä½•ä»·æ ¼ç›¸å…³çš„å…ƒç´ ã€‚</strong></p>
<p><code>éµå®ˆè§„åˆ™ï¼Œæ–¹å¾—é•¿æ²»ä¹…å®‰</code>ï¼Œæœ€åç¥å¤§å®¶å¤§å‰å¤§åˆ©ï¼Œä»Šæ™šè¿‡å®¡ï¼</p>
<h3 data-id="heading-3">ç›¸å…³æ¨è</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FURmC_4vxQv5ttOg8yYe7Eg" target="_blank" title="https://mp.weixin.qq.com/s/URmC_4vxQv5ttOg8yYe7Eg" ref="nofollow noopener noreferrer"># è‹¹æœå¼€å‘è€…ç»­è´¹å¤§å‘åŠæˆåŠŸç»­è´¹æ–¹æ¡ˆï¼äº²æµ‹æœ‰æ•ˆ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F1bAA90Tzpx03tTHZbdg3aw" target="_blank" title="https://mp.weixin.qq.com/s/1bAA90Tzpx03tTHZbdg3aw" ref="nofollow noopener noreferrer"># AppStoreæ•æ„Ÿè¯æ’æŸ¥æ‰‹å†Œï¼Œå¤šç»´åº¦åˆ†æGuideline 2.3.1éšè—åŠŸèƒ½ï¼Œè½»æ¾è¿‡å®¡ã€‚</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMTkxNzAzMw%3D%3D%26mid%3D2247484371%26idx%3D1%26sn%3D33568c58e90a5bf4d2612d803ecb2a27%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxMTkxNzAzMw==&amp;mid=2247484371&amp;idx=1&amp;sn=33568c58e90a5bf4d2612d803ecb2a27&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer"># è‹¹æœåŠ æ€¥å®¡æ ¸æ˜¯â€œç»¿è‰²é€šé“â€è¿˜æ˜¯â€œæ­»äº¡é™·é˜±â€ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMTkxNzAzMw%3D%3D%26mid%3D2247484362%26idx%3D1%26sn%3Dea61bd42d5ae8b99d2a56cbfb8d91e88%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxMTkxNzAzMw==&amp;mid=2247484362&amp;idx=1&amp;sn=ea61bd42d5ae8b99d2a56cbfb8d91e88&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer"># è‹¹æœå¼€å‘è€…é‚®ç®±ï¼Œçªç„¶æ”¶åˆ°11.2é€šçŸ¥ä¸¥é‡ä¹ˆï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMTkxNzAzMw%3D%3D%26mid%3D2247484413%26idx%3D1%26sn%3D82870d4c8892fa65803a8e05fd5ac938%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxMTkxNzAzMw==&amp;mid=2247484413&amp;idx=1&amp;sn=82870d4c8892fa65803a8e05fd5ac938&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer"># ä¸æƒ³è¢«è‹¹æœå¡å®¡æœ€å¥½é”™å¼€è¿™ä¸¤ä¸ªæå®¡æ—¶é—´</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMTkxNzAzMw%3D%3D%26mid%3D2247484349%26idx%3D1%26sn%3D1c75a6b08cb5de64ddf41a88b61ff108%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxMTkxNzAzMw==&amp;mid=2247484349&amp;idx=1&amp;sn=1c75a6b08cb5de64ddf41a88b61ff108&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer"># æ‰‹æ’•è‹¹æœå®¡æ ¸4.3æ˜¯ä»£ç é—®é¢˜è¿˜æ˜¯è®¾è®¡é—®é¢˜ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMTkxNzAzMw%3D%3D%26mid%3D2247484344%26idx%3D1%26sn%3D4399eb8d8bf82e9c5df26a18b8564cfb%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxMTkxNzAzMw==&amp;mid=2247484344&amp;idx=1&amp;sn=4399eb8d8bf82e9c5df26a18b8564cfb&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer"># æœ‰å¹¸å’ŒAppstoreå®¡æ ¸äººå‘˜è¿›è¡Œäº†ä¸€åœºè§†é¢‘ä¼šè®®ç‰¹æ­¤è®°å½•ã€‚</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é€šå¾€é€šç”¨äººå·¥æ™ºèƒ½çš„å…³é”®ä¸€æ­¥ï¼ŸDeepMindæ”¾å¤§æ‹›ï¼Œ3Dä¸–ç•Œæœ€å¼ºAIæ™ºèƒ½ä½“SIMA 2]]></title>    <link>https://juejin.cn/post/7574584245110603827</link>    <guid>https://juejin.cn/post/7574584245110603827</guid>    <pubDate>2025-11-20T02:55:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574584245110603827" data-draft-id="7574584245110587443" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é€šå¾€é€šç”¨äººå·¥æ™ºèƒ½çš„å…³é”®ä¸€æ­¥ï¼ŸDeepMindæ”¾å¤§æ‹›ï¼Œ3Dä¸–ç•Œæœ€å¼ºAIæ™ºèƒ½ä½“SIMA 2"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,OpenAI"/> <meta itemprop="datePublished" content="2025-11-20T02:55:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœºå™¨ä¹‹å¿ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/1873223543167902"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é€šå¾€é€šç”¨äººå·¥æ™ºèƒ½çš„å…³é”®ä¸€æ­¥ï¼ŸDeepMindæ”¾å¤§æ‹›ï¼Œ3Dä¸–ç•Œæœ€å¼ºAIæ™ºèƒ½ä½“SIMA 2
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1873223543167902/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœºå™¨ä¹‹å¿ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T02:55:02.000Z" title="Thu Nov 20 2025 02:55:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ‚¨çš„ AI ä¼™ä¼´ã€Œæ¸¸æˆé™ªç©ã€ç‰ˆå·²ä¸Šçº¿ã€‚</p>
<p>ä»Šå¤©ï¼ŒGoogle DeepMind å‘å¸ƒäº†Â SIMA 2ï¼Œä¸€ä¸ªåœ¨è™šæ‹Ÿ 3D ä¸–ç•Œä¸­èƒ½è‡ªä¸»æ¸¸æˆã€æ¨ç†å¹¶æŒç»­å­¦ä¹ çš„é€šç”¨ AI æ™ºèƒ½ä½“ã€‚</p>
<p>DeepMind åˆ›å§‹äººå“ˆè¨æ¯”æ–¯å°†å…¶å®šä¹‰ä¸ºé€šå¾€é€šç”¨äººå·¥æ™ºèƒ½çš„å…³é”®ä¸€æ­¥ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4faaa4fb84c34148b8a8c6949fa44cc9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212102&amp;x-signature=Gvmmb%2FN%2FL0sXWeA%2BokdC4ebcLxg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å»å¹´ï¼Œè°·æ­Œ DeepMind æ¨å‡ºäº† SIMA ï¼ˆScalable Instructable Multiworld Agentï¼Œå¯æ‰©å±•ã€å¯æŒ‡å¯¼çš„å¤šä¸–ç•Œæ™ºèƒ½ä½“ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªèƒ½å¤Ÿè·¨è¶Šå¤šç§è™šæ‹Ÿç¯å¢ƒã€éµå¾ªåŸºæœ¬æŒ‡ä»¤çš„é€šæ‰ AIï¼Œæ ‡å¿—ç€ AI åœ¨ 3D ä¸–ç•Œä¸­å°†è¯­è¨€è½¬åŒ–ä¸ºè¡ŒåŠ¨çš„åˆæ­¥æ¢ç´¢ã€‚</p>
<p>SIMA 2 åˆ™ä»£è¡¨äº†è¿™ä¸€ç ”ç©¶çš„é‡å¤§é£è·ƒï¼Œæ˜¯åˆ›å»ºé€šç”¨å’Œæœ‰ç›Š AI æ™ºèƒ½ä½“ç ”ç©¶çš„ä¸‹ä¸€ä¸ªé‡Œç¨‹ç¢‘ã€‚é€šè¿‡é›†æˆ Gemini æ¨¡å‹çš„å…ˆè¿›èƒ½åŠ›ï¼ŒSIMA æ­£åœ¨ä»ä¸€ä¸ªè¢«åŠ¨çš„ã€æ¨¡ä»¿äººç±»æ“ä½œçš„æŒ‡ä»¤éµå¾ªè€…è¿›åŒ–ä¸ºä¸€ä¸ªäº¤äº’å¼çš„æ¸¸æˆä¼´ä¾£ã€‚</p>
<p>SIMA 2 ä¸ä»…èƒ½éµå¾ªäººç±»æŒ‡ä»¤ï¼Œè¿˜èƒ½åœ¨æœªè§è¿‡çš„å¤æ‚ç¯å¢ƒä¸­ï¼ˆå¦‚å„ç§å¼€æ”¾ä¸–ç•Œæ¸¸æˆï¼‰è¿›è¡Œè‡ªä¸»è§„åˆ’ã€è§£é‡Šè¡ŒåŠ¨æ­¥éª¤ã€ä¸ç”¨æˆ·å®æ—¶å¯¹è¯ï¼ˆæ”¯æŒæ–‡æœ¬ã€è¯­éŸ³æˆ–å›¾åƒè¾“å…¥ï¼‰ï¼Œå¹¶é€šè¿‡è¯•é”™ä¸ Gemini åé¦ˆçš„é—­ç¯æœºåˆ¶è‡ªæˆ‘è¿­ä»£ï¼Œæå‡æŠ€èƒ½ã€‚</p>
<p>è¿™å¯¹æœºå™¨äººæŠ€æœ¯å’Œäººå·¥æ™ºèƒ½çš„æœªæ¥å…·æœ‰é‡è¦æ„ä¹‰ï¼Œå› ä¸ºå®ƒæ­£åœ¨æ„å»ºæœªæ¥ç‰©ç†ä¸–ç•Œæ™ºèƒ½ä½“æ‰€éœ€çš„æ ¸å¿ƒã€Œè®¤çŸ¥æ„å»ºæ¨¡å—ã€ã€‚</p>
<p>è¯„è®ºåŒºä¹Ÿå¯¹å®ƒçš„åº”ç”¨è¿›è¡Œäº†å¤§èƒ†æ„æ€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/59b304dd3e2f4fd08e1403e7ef43a324~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212102&amp;x-signature=vYE%2FB0A2NROFNhVA%2FFbH5LbsKs4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ‰€ä»¥æ˜¯ GTA 6 å…ˆå‘å¸ƒï¼Œè¿˜æ˜¯ AGI å…ˆå®ç°ï¼Ÿ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f513c6b9d5e46589d3c3f688fee73c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212102&amp;x-signature=2Ju2jFv%2F%2FjKlun0ubtJpDL60mYM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ¨ç†çš„åŠ›é‡</p>
<p>ç¬¬ä¸€ç‰ˆ SIMA å­¦ä¼šäº†åœ¨å„ç§å•†ä¸šè§†é¢‘æ¸¸æˆä¸­æ‰§è¡Œè¶…è¿‡ 600 ç§è¯­è¨€éµå¾ªæŠ€èƒ½ï¼Œå¦‚ã€Œå·¦è½¬ã€ã€ã€Œçˆ¬æ¢¯å­ã€å’Œã€Œæ‰“å¼€åœ°å›¾ã€ã€‚å®ƒåƒäººä¸€æ ·åœ¨è¿™äº›ç¯å¢ƒä¸­æ“ä½œï¼Œé€šè¿‡ã€ŒæŸ¥çœ‹ã€å±å¹•å¹¶ä½¿ç”¨è™šæ‹Ÿé”®ç›˜å’Œé¼ æ ‡è¿›è¡Œå¯¼èˆªï¼Œè€Œæ— éœ€è®¿é—®åº•å±‚çš„æ¸¸æˆæœºåˆ¶ã€‚</p>
<p>å°½ç®¡ SIMA 1 æ˜¯ä¼˜ç§€çš„ã€ŒæŠ€èƒ½æ‰§è¡Œè€…ã€ï¼Œä½†å®ƒç¼ºä¹æ·±åº¦è§„åˆ’å’Œæ„å›¾ç†è§£ï¼Œä»…é™äºè¢«åŠ¨æ¨¡ä»¿ã€‚</p>
<p>SIMA 2 åˆ™æ ‡å¿—ç€ä»æŒ‡ä»¤è·Ÿéšåˆ°ä¸»åŠ¨è®¤çŸ¥çš„è·ƒè¿›ã€‚é€šè¿‡åµŒå…¥ Gemini æ¨¡å‹ä½œä¸ºæ ¸å¿ƒå¼•æ“ï¼ŒSIMA 2 ä¸ä»…å“åº”æŒ‡ä»¤ï¼Œè¿˜èƒ½è¿›è¡Œå¤šæ­¥éª¤æ¨ç†ï¼šä»è¯­è¨€è§£ææ„å›¾ã€åˆ¶å®šè®¡åˆ’ï¼Œåˆ°æ‰§è¡Œè¡ŒåŠ¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/66cdda03fa3443119d64640fbe1bcf37~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212102&amp;x-signature=hxz%2Fv%2Bsas%2BMX%2BZO%2FaFJRgLFQ5hA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>MineDojoï¼šSIMA 1ï¼ˆå·¦ï¼‰å°è¯•æ‰§è¡ŒæŒ‡ä»¤æ—¶ï¼ŒSIMA 2ï¼ˆå³ï¼‰åœ¨ä»æœªè§è¿‡çš„æ¸¸æˆä¸­æˆåŠŸå®Œæˆä»»åŠ¡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3af662128bf4988a0de635e98015ca2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212102&amp;x-signature=9Sbgl7BDWyZy5EV6TwQEBKBmFu0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ASKAï¼šSIMA 1ï¼ˆå·¦ï¼‰å°è¯•æ‰§è¡Œã€Œå¯»æ‰¾ç¯ç«ã€æŒ‡ä»¤æ—¶ï¼ŒSIMA 2ï¼ˆå³ï¼‰åœ¨ä»æœªè§è¿‡çš„æ¸¸æˆä¸­æˆåŠŸå®Œæˆä»»åŠ¡ã€‚</p>
<p>SIMA 2 çš„æ–°æ¶æ„é›†æˆäº† Gemini å¼ºå¤§çš„æ¨ç†èƒ½åŠ›ï¼Œå¸®åŠ©å®ƒç†è§£ç”¨æˆ·çš„é«˜çº§åˆ«ç›®æ ‡ï¼Œåœ¨è¿½æ±‚ç›®æ ‡è¿‡ç¨‹ä¸­æ‰§è¡Œå¤æ‚çš„æ¨ç†ï¼Œå¹¶åœ¨æ¸¸æˆä¸­ç†Ÿç»ƒæ‰§è¡Œä»¥ç›®æ ‡ä¸ºå¯¼å‘çš„è¡ŒåŠ¨ã€‚å®ƒå°† SIMA 1 çš„ è¯­è¨€ -&gt; è¡ŒåŠ¨ æ¨¡å¼ï¼Œå‡çº§ä¸ºäº† è¯­è¨€ -&gt; æ„å›¾ -&gt; è®¡åˆ’ -&gt; è¡ŒåŠ¨ çš„å¤šæ­¥éª¤è®¤çŸ¥é“¾ã€‚</p>
<p>DeepMind ä½¿ç”¨æ··åˆæ•°æ®è®­ç»ƒäº† SIMA 2ï¼ŒåŒ…æ‹¬å¸¦è¯­è¨€æ ‡ç­¾çš„äººç±»æ¼”ç¤ºè§†é¢‘ä»¥åŠ Gemini ç”Ÿæˆçš„æ ‡ç­¾ã€‚å› æ­¤ï¼ŒSIMA 2 ç°åœ¨å¯ä»¥å‘ç”¨æˆ·æè¿°å®ƒæ‰“ç®—åšä»€ä¹ˆï¼Œå¹¶è¯¦ç»†è¯´æ˜å®ƒä¸ºå®ç°ç›®æ ‡æ­£åœ¨é‡‡å–çš„æ­¥éª¤ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8fb88663d1524e1db7dec9f34437a3c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212102&amp;x-signature=fghL%2FsfkJ6gYfWHxQMhtxBf%2B6c8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¶…è¶Šç®€å•çš„æŒ‡ä»¤è·Ÿéšï¼šSIMA 2 ä¸ä»…èƒ½å›ç­”ç”¨æˆ·é—®é¢˜ï¼Œè¿˜èƒ½å¯¹å…¶è‡ªèº«è¡Œä¸ºåŠæ‰€å¤„ç¯å¢ƒè¿›è¡Œæ¨ç†ã€‚</p>
<p>åœ¨æµ‹è¯•ä¸­ï¼ŒDeepMind å‘ç°ä¸è¯¥æ™ºèƒ½ä½“äº’åŠ¨çš„æ„Ÿè§‰ï¼Œæ›´åƒæ˜¯ä¸ä¸€ä¸ªèƒ½å¤Ÿå¯¹å½“å‰ä»»åŠ¡è¿›è¡Œæ¨ç†çš„ä¼™ä¼´åˆä½œï¼Œè€Œä¸æ˜¯å‘å®ƒä¸‹è¾¾å‘½ä»¤ã€‚</p>
<p>å¹¶ä¸”ï¼Œå¾—ç›Šäº DeepMind ä¸ç°æœ‰åŠæ–°æ¸¸æˆåˆä½œä¼™ä¼´çš„åˆä½œï¼ŒDeepMind å·²ç»èƒ½å¤Ÿåœ¨æ›´å¹¿æ³›çš„æ¸¸æˆä¸Šè®­ç»ƒå’Œè¯„ä¼° SIMA 2ã€‚</p>
<p>è¿™å°±æ˜¯ Gemini ä¸ºå…·èº« AI å¸¦æ¥çš„åŠ›é‡ï¼šä¸€ä¸ªä¸–ç•Œçº§çš„æ¨ç†å¼•æ“ï¼Œç°åœ¨èƒ½å¤Ÿåœ¨å¤æ‚çš„äº¤äº’å¼ 3D ç¯å¢ƒä¸­æ„ŸçŸ¥ã€ç†è§£å¹¶é‡‡å–è¡ŒåŠ¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9d914134d39434093ef8ae8329bd32c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212102&amp;x-signature=Fxb%2Fj0d9CjPMnmuX8sLHFPD0aNw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>SIMA 2 é€šè¿‡åˆ†æç¯å¢ƒä¸ç”¨æˆ·æ„å›¾ï¼Œèƒ½å¤Ÿç†è§£æŠ½è±¡æ¦‚å¿µå¹¶æ‰§è¡Œé€»è¾‘æŒ‡ä»¤ã€‚</p>
<p>æ³›åŒ–æ€§èƒ½çš„é£è·ƒ</p>
<p>Gemini çš„åŠ å…¥ä¹Ÿå¸¦æ¥äº†æ³›åŒ–èƒ½åŠ›å’Œå¯é æ€§çš„æå‡ã€‚SIMA 2 ç°åœ¨èƒ½æ¯”å…¶å‰èº«ç†è§£æ›´å¤æ‚ã€æ›´ç»†å¾®çš„æŒ‡ä»¤ï¼Œå¹¶ä¸”åœ¨æ‰§è¡Œè¿™äº›æŒ‡ä»¤æ—¶æˆåŠŸç‡æ›´é«˜ï¼Œå°¤å…¶æ˜¯åœ¨é‚£äº›å®ƒä»æœªè®­ç»ƒè¿‡çš„æƒ…æ™¯æˆ–æ¸¸æˆä¸­ï¼Œä¾‹å¦‚æ–°çš„ç»´äº¬ç”Ÿå­˜æ¸¸æˆ ASKAï¼Œæˆ– MineDojoï¼ˆä¸€ä¸ªæµè¡Œå¼€æ”¾ä¸–ç•Œæ²™ç›’æ¸¸æˆ Minecraft çš„ç ”ç©¶ç”¨å®ç°ï¼‰ã€‚</p>
<ul>
<li>SIMA 2 èƒ½å¤Ÿç†è§£å¹¶å®Œæˆé•¿æœŸä¸”å¤æ‚çš„ä»»åŠ¡</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7378c5027404257acb5067b00857652~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212102&amp;x-signature=O1nigpLlN61MOXasHpWBl6RKAF4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>SIMA 2 èƒ½å¤ŸæˆåŠŸæ‰§è¡Œé•¿è€Œå¤æ‚çš„æŒ‡ä»¤ã€‚</p>
<ul>
<li>SIMA 2 èƒ½å¤Ÿç†è§£å¤šæ¨¡æ€æç¤º</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be72794a1c0841a8b516aa5709fc05eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212102&amp;x-signature=%2BRMYO51LljdW7%2FG0snlHbRB%2B55c%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç”¨æˆ·æ­£åœ¨å±å¹•ä¸Šç»˜åˆ¶è‰å›¾ã€‚</p>
<ul>
<li>SIMA 2 èƒ½å¤Ÿç†è§£ä¸åŒçš„è¯­è¨€ç”šè‡³è¡¨æƒ…ç¬¦å·</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2339355c7774843b7ef05d45c480a42~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212102&amp;x-signature=dVDQ2EBw5XyH24Hs8YHyK%2FVNUbU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>çœ‹å®ƒå¦‚ä½•æ­£ç¡®è§£è¯»è¡¨æƒ…ç¬¦å·æ¥æ‰§è¡Œä»»åŠ¡ã€‚</p>
<p>æ­¤å¤–ï¼Œå®ƒè¿ç§»å­¦ä¹ æ¦‚å¿µçš„èƒ½åŠ›â€”â€”ä¾‹å¦‚ï¼Œå°†å…¶åœ¨ä¸€ç§æ¸¸æˆä¸­å¯¹ã€Œé‡‡çŸ¿ã€çš„ç†è§£åº”ç”¨åˆ°å¦ä¸€ç§æ¸¸æˆä¸­çš„ã€Œæ”¶è·ã€â€”â€”æ˜¯å®ç°åƒäººç±»è®¤çŸ¥ä¸­é‚£æ ·çš„å¹¿æ³›æ³›åŒ–èƒ½åŠ›çš„åŸºç¡€ã€‚äº‹å®ä¸Šï¼Œç”±äºè¿™ç§èƒ½åŠ›ï¼ŒSIMA 2 åœ¨å¤šç§ä»»åŠ¡ä¸Šçš„è¡¨ç°å·²æ˜¾è‘—æ¥è¿‘äººç±»ç©å®¶çš„æ°´å¹³ã€‚</p>
<p>ç»ˆææµ‹è¯•ï¼šåœ¨å…¨æ–°æ„æƒ³çš„ä¸–ç•Œä¸­æ¸¸æˆ</p>
<p>ä¸ºäº†æµ‹è¯• SIMA 2 æ³›åŒ–èƒ½åŠ›çš„æé™ï¼ŒDeepMind å°†å…¶ä¸å¦ä¸€ä¸ªçªç ´æ€§ç ”ç©¶é¡¹ç›® Genie 3 ç›¸ç»“åˆï¼Œåè€…å¯ä»¥ä»å•ä¸ªå›¾åƒæˆ–æ–‡æœ¬æç¤ºç”Ÿæˆæ–°çš„ã€å®æ—¶çš„ 3D æ¨¡æ‹Ÿä¸–ç•Œã€‚</p>
<p>å½“ DeepMind æŒ‘æˆ˜ SIMA 2 åœ¨è¿™äº›æ–°ç”Ÿæˆçš„ä¸–ç•Œä¸­æ¸¸æˆæ—¶ï¼ŒDeepMind å‘ç°å®ƒèƒ½å¤Ÿåˆç†åœ°ç¡®å®šè‡ªå·±çš„æ–¹ä½ã€ç†è§£ç”¨æˆ·æŒ‡ä»¤ï¼Œå¹¶æœç€ç›®æ ‡é‡‡å–æœ‰æ„ä¹‰çš„è¡ŒåŠ¨ï¼Œå°½ç®¡å®ƒä»¥å‰ä»æœªè§è¿‡è¿™æ ·çš„ç¯å¢ƒã€‚å®ƒå±•ç°äº†å‰æ‰€æœªæœ‰çš„é€‚åº”èƒ½åŠ›ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/233ac0648d07491daf4b90acd6225210~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212102&amp;x-signature=51Z%2BGWNyjzQr0YNBHcuLLephtus%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>SIMA 2 åœ¨ Genie 3 ç”Ÿæˆçš„æ–°ä¸–ç•Œä¸­è¿è¡Œ</p>
<p>è¿ˆå‘å¯æ‰©å±•ã€å¤šä»»åŠ¡çš„è‡ªæˆ‘æå‡</p>
<p>SIMA 2 æœ€ä»¤äººå…´å¥‹çš„æ–°èƒ½åŠ›ä¹‹ä¸€æ˜¯å…¶è‡ªæˆ‘æå‡çš„èƒ½åŠ›ã€‚DeepMind è§‚å¯Ÿåˆ°ï¼Œåœ¨æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒSIMA 2 æ™ºèƒ½ä½“èƒ½å¤Ÿæ‰§è¡Œæ—¥ç›Šå¤æ‚å’Œæ–°é¢–çš„ä»»åŠ¡ï¼Œè¿™æ˜¯é€šè¿‡è¯•é”™æ³•å’ŒåŸºäº Gemini çš„åé¦ˆè‡ªä¸¾å®ç°çš„ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨æœ€åˆä»äººç±»æ¼”ç¤ºä¸­å­¦ä¹ åï¼ŒSIMA 2 å¯ä»¥è¿‡æ¸¡åˆ°å®Œå…¨é€šè¿‡è‡ªæˆ‘å¯¼å‘çš„æ¸¸æˆåœ¨æ–°æ¸¸æˆä¸­å­¦ä¹ ï¼Œåœ¨ä»¥å‰æœªè§è¿‡çš„ä¸–ç•Œä¸­å‘å±•å…¶æŠ€èƒ½ï¼Œè€Œæ— éœ€é¢å¤–çš„äººç±»ç”Ÿæˆæ•°æ®ã€‚åœ¨åç»­è®­ç»ƒä¸­ï¼ŒSIMA 2 è‡ªèº«çš„ç»éªŒæ•°æ®å¯ç”¨äºè®­ç»ƒä¸‹ä¸€ä¸ªã€èƒ½åŠ›æ›´å¼ºçš„æ™ºèƒ½ä½“ç‰ˆæœ¬ã€‚DeepMind ç”šè‡³èƒ½å¤Ÿåœ¨æ–°åˆ›å»ºçš„ Genie ç¯å¢ƒä¸­åˆ©ç”¨ SIMA 2 çš„è‡ªæˆ‘æå‡èƒ½åŠ›â€”â€”è¿™æ˜¯åœ¨å¤šæ ·åŒ–çš„ã€ç”Ÿæˆçš„ä¸–ç•Œä¸­è®­ç»ƒé€šç”¨æ™ºèƒ½ä½“çš„ä¸€ä¸ªé‡è¦é‡Œç¨‹ç¢‘ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/70cd026f5e3c47a98990cf1a263a35f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212102&amp;x-signature=U1Tf3Tx6fKRuBl58V123wrDZzd4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™ç§è¿­ä»£æ”¹è¿›çš„è‰¯æ€§å¾ªç¯ä¸ºæœªæ¥é“ºå¹³äº†é“è·¯ï¼Œå³æ™ºèƒ½ä½“å¯ä»¥ä»¥æœ€å°‘çš„äººå·¥å¹²é¢„è¿›è¡Œå­¦ä¹ å’Œæˆé•¿ï¼Œæˆä¸ºå…·èº« AI é¢†åŸŸçš„å¼€æ”¾å¼å­¦ä¹ è€…ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/93b2c674a0784fb8bf93dd8cfaa3937e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5py65Zmo5LmL5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764212102&amp;x-signature=gP%2FfR0B4nPBxzTvAfTqI0nlh5qQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ASKAï¼šå·¦ä¾§å±•ç¤ºçš„æ˜¯åˆä»£ SIMA 2 æ™ºèƒ½ä½“å¤±è´¥çš„ä»»åŠ¡æ¡ˆä¾‹ï¼Œå³ä¾§åˆ™æ˜¾ç¤ºç»è¿‡å¤šä»£è®­ç»ƒåï¼ŒSIMA 2 åœ¨å®Œå…¨æ— éœ€äººç±»åé¦ˆæˆ–æ¸¸æˆæ•°æ®çš„æƒ…å†µä¸‹å®ç°äº†è‡ªæˆ‘è¿›åŒ–ã€‚</p>
<p>å±•æœ›æœªæ¥ï¼šé€šå¾€é€šç”¨å…·èº«æ™ºèƒ½çš„æ—…ç¨‹</p>
<p>SIMA 2 è·¨è¶Šä¸åŒæ¸¸æˆç¯å¢ƒçš„æ“ä½œèƒ½åŠ›ï¼Œæ˜¯é€šç”¨æ™ºèƒ½çš„ä¸€ä¸ªå…³é”®è¯•éªŒåœºï¼Œå®ƒå…è®¸æ™ºèƒ½ä½“æŒæ¡æŠ€èƒ½ã€ç»ƒä¹ å¤æ‚æ¨ç†ï¼Œå¹¶é€šè¿‡è‡ªæˆ‘å¯¼å‘çš„æ¸¸æˆæŒç»­å­¦ä¹ ã€‚</p>
<p>è™½ç„¶ SIMA 2 æ˜¯è¿ˆå‘é€šæ‰å‹ã€äº¤äº’å¼ã€å…·èº«æ™ºèƒ½çš„é‡è¦ä¸€æ­¥ï¼Œä½†å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€é¡¹ç ”ç©¶å·¥ä½œï¼Œå…¶ç›®å‰çš„å±€é™æ€§çªæ˜¾äº†æœªæ¥å·¥ä½œçš„å…³é”®é¢†åŸŸã€‚</p>
<p>DeepMind å‘ç°ï¼Œè¿™äº›æ™ºèƒ½ä½“åœ¨å¤„ç†éœ€è¦å¤§é‡ã€å¤šæ­¥éª¤æ¨ç†å’Œç›®æ ‡éªŒè¯çš„è¶…é•¿æ—¶ç¨‹å¤æ‚ä»»åŠ¡æ—¶ä»é¢ä¸´æŒ‘æˆ˜ã€‚SIMA 2 å¯¹å…¶äº¤äº’çš„è®°å¿†ä¹Ÿç›¸å¯¹è¾ƒçŸ­â€”â€”å®ƒå¿…é¡»ä½¿ç”¨æœ‰é™çš„ä¸Šä¸‹æ–‡çª—å£æ¥å®ç°ä½å»¶è¿Ÿäº¤äº’ã€‚æœ€åï¼Œé€šè¿‡é”®ç›˜å’Œé¼ æ ‡ç•Œé¢æ‰§è¡Œç²¾ç¡®çš„ä½çº§åˆ«æ“ä½œï¼Œä»¥åŠå®ç°å¯¹å¤æ‚ 3D åœºæ™¯çš„ç¨³å¥è§†è§‰ç†è§£ï¼Œä»ç„¶æ˜¯æ•´ä¸ªé¢†åŸŸåœ¨æŒç»­åº”å¯¹çš„å¼€æ”¾æ€§æŒ‘æˆ˜ã€‚</p>
<p>è¿™é¡¹ç ”ç©¶ä¸ºé¢å‘è¡ŒåŠ¨çš„ AI æä¾›äº†ä¸€æ¡æ–°è·¯å¾„çš„åŸºç¡€éªŒè¯ã€‚SIMA 2 è¯å®ï¼Œä¸€ä¸ªåˆ©ç”¨å¤šæ ·åŒ–çš„å¤šä¸–ç•Œæ•°æ®å’Œ Gemini å¼ºå¤§æ¨ç†èƒ½åŠ›ã€ä¸ºå®ç°å¹¿æ³›èƒ½åŠ›è€Œè®­ç»ƒçš„ AIï¼Œå¯ä»¥æˆåŠŸåœ°å°†è®¸å¤šä¸“ç”¨ç³»ç»Ÿçš„èƒ½åŠ›ç»Ÿä¸€åˆ°ä¸€ä¸ªè¿è´¯çš„ã€é€šæ‰å‹çš„æ™ºèƒ½ä½“ä¸­ã€‚</p>
<p>SIMA 2 ä¹Ÿä¸ºæœºå™¨äººæŠ€æœ¯çš„åº”ç”¨æä¾›äº†åšå®çš„è·¯å¾„ã€‚å®ƒå­¦åˆ°çš„æŠ€èƒ½â€”â€”ä»å¯¼èˆªã€å·¥å…·ä½¿ç”¨åˆ°åä½œä»»åŠ¡æ‰§è¡Œâ€”â€”éƒ½æ˜¯æœªæ¥ç‰©ç†ä¸–ç•Œ AI åŠ©æ‰‹æ‰€éœ€çš„æ™ºèƒ½ç‰©ç†å…·èº«åŒ–çš„ä¸€äº›åŸºæœ¬æ„å»ºæ¨¡å—ã€‚</p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeepmind.google%2Fblog%2Fsima-2-an-agent-that-plays-reasons-and-learns-with-you-in-virtual-3d-worlds%2F%3Futm_source%3Dx%26utm_medium%3Dsocial%26utm_campaign%3D%26utm_content%3D" target="_blank" title="https://deepmind.google/blog/sima-2-an-agent-that-plays-reasons-and-learns-with-you-in-virtual-3d-worlds/?utm_source=x&amp;utm_medium=social&amp;utm_campaign=&amp;utm_content=" ref="nofollow noopener noreferrer">deepmind.google/blog/sima-2â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»€ä¹ˆæ˜¯æ³¨æ„åŠ›æœºåˆ¶ï¼Ÿä»€ä¹ˆæ˜¯è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ŸäºŒè€…æœ‰ä½•åŒºåˆ«ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7574448424998109220</link>    <guid>https://juejin.cn/post/7574448424998109220</guid>    <pubDate>2025-11-20T03:47:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574448424998109220" data-draft-id="7574380953175883818" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»€ä¹ˆæ˜¯æ³¨æ„åŠ›æœºåˆ¶ï¼Ÿä»€ä¹ˆæ˜¯è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ŸäºŒè€…æœ‰ä½•åŒºåˆ«ï¼Ÿ"/> <meta itemprop="keywords" content="LLM"/> <meta itemprop="datePublished" content="2025-11-20T03:47:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ™ºæ³ŠAI"/> <meta itemprop="url" content="https://juejin.cn/user/3572727470361578"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»€ä¹ˆæ˜¯æ³¨æ„åŠ›æœºåˆ¶ï¼Ÿä»€ä¹ˆæ˜¯è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ŸäºŒè€…æœ‰ä½•åŒºåˆ«ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3572727470361578/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ™ºæ³ŠAI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:47:05.000Z" title="Thu Nov 20 2025 03:47:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>å¼•è¨€</strong>ï¼šä»Šå¤©æˆ‘ä»¬åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†è®²AIå¤§æ¨¡å‹çš„çŸ¥è¯†ç‚¹ï¼Œç¬¬ä¸€ä¸ªéƒ¨åˆ†æ˜¯æ³¨æ„åŠ›æœºåˆ¶ï¼Œç¬¬äºŒä¸ªéƒ¨åˆ†æ˜¯è‡ªæ³¨æ„åŠ›æœºåˆ¶ã€‚</p>
<p><strong>ä¸€ã€æ³¨æ„åŠ›æœºåˆ¶</strong></p>
<p><strong>01 ä¸€å¥è¯ç§’æ‡‚</strong></p>
<p>æ³¨æ„åŠ›æœºåˆ¶=è®©AIå­¦ä¼š"æŠ“é‡ç‚¹"çš„é­”æ³•!</p>
<p>å¯ä»¥ç®€å•ç†è§£ä¸º"å­¦éœ¸åˆ’é‡ç‚¹"ã€‚</p>
<p>å°±åƒæˆ‘ä»¬åœ¨è¯»ä¹¦æ—¶ç”¨è§å…‰ç¬”æ ‡å…³é”®å¥å’Œé‡è¦çŸ¥è¯†ç‚¹ï¼ŒAIä¹Ÿä¸»è¦ç”¨æ³¨æ„åŠ›æœºåˆ¶å†³å®š"å“ªäº›ä¿¡æ¯å€¼å¾—æ”¾å¤§çœ‹"~</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de72ba7e32674a24a73015b928252a94~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764215225&amp;x-signature=DY5O1zadH0WvZU03f5dxXo8uPVE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>02 åŸç†æ‹†è§£</strong></p>
<p><strong>è¾“å…¥</strong>: ä¸€æ®µä¿¡æ¯(æ¯”å¦‚"æˆ‘çˆ±åƒç‚¸é¸¡")</p>
<p><strong>è®¡ç®—æƒé‡</strong>: æ¯ä¸ªå­—åˆ†é…æ³¨æ„åŠ›çš„åˆ†æ•°ï¼Œâ€œç‚¸é¸¡"åˆ†æ•°UP!"æˆ‘"åˆ†æ•°DOWN...</p>
<p><strong>åŠ æƒè¾“å‡º</strong>: é«˜åˆ†ä¿¡æ¯ä¼šè¢«å¼ºåŒ–å¤„ç†ï¼Œæœ€ç»ˆAIä¸ä»…è®°ä½å¥å­ï¼Œè¿˜èƒ½getåˆ°ã€Œç‚¸é¸¡æ‰æ˜¯çµé­‚ã€!</p>
<p><strong>03 ä¸ºä»€ä¹ˆé¢ è¦†ä¼ ç»Ÿ?</strong></p>
<p><strong>æ—§ç‰ˆRNN</strong>: å¼ºè¿«ç—‡å¼é€å­—å¤„ç†ï¼Œè®°ä¸ä½é•¿æ–‡æœ¬;æ¯ä¸ªå­—å¹³ç­‰å¯¹å¾…â†’å­¦å¾—æ…¢è¿˜æŠ“ä¸ä½é‡ç‚¹</p>
<p><strong>æ³¨æ„åŠ›æœºåˆ¶</strong>: ä¸€ç§’æ‰«æå…¨å±€ï¼ŒåŠ¨æ€é”å®šå…³é”®ä¿¡æ¯;åŠ¨æ€æƒé‡åˆ†é…â†’å“ªé‡Œé‡è¦ç‚¹å“ªé‡Œ!</p>
<p>å°±åƒå­¦æ¸£VSå­¦éœ¸çš„ç¬”è®°å·®åˆ«</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/216d804c5c7349dfbb049dc19f7de17b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764215225&amp;x-signature=ObZ797Lw4g1gLbKx9tmWC1h5gP4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>04 ä¸¾ä¸ªæ —å­</strong></p>
<p>è¾“å…¥: â€œæˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨â€</p>
<p>æ¨¡å‹å†…å¿ƒOS:</p>
<p>"çˆ±"è¦é‡ç‚¹çœ‹(æƒ…æ„Ÿæ ¸å¿ƒ)</p>
<p>"åŒ—äº¬"å’Œ"å¤©å®‰é—¨"ç–¯ç‹‚æ‰“call(å®ä½“å…³è”)</p>
<p>"æˆ‘"ç¨å¾®è®°ä¸€ä¸‹å°±è¡Œ(ä¸»è¯­å¸¸è§„æ“ä½œ)</p>
<p><strong>05 æ ¸å¿ƒæŠ€æœ¯è§£æ</strong></p>
<p>1ï¼‰æ ¸å¿ƒæ€æƒ³</p>
<p>é€šè¿‡åŠ¨æ€æƒé‡åˆ†é…ï¼Œè®©ç¥ç»ç½‘ç»œåœ¨å¤„ç†åºåˆ—æ•°æ®æ—¶ï¼Œèƒ½å¤Ÿé’ˆå¯¹ä¸åŒä½ç½®çš„ä¿¡æ¯åˆ†é…ä¸åŒçš„å…³æ³¨åº¦(attention)ã€‚ç±»æ¯”äººç±»é˜…è¯»æ—¶å¯¹å…³é”®è¯çš„é‡ç‚¹å…³æ³¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0dadf8ab43fd43179374ab6d297bc862~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764215225&amp;x-signature=hZG5wtz6aWzelOa7wZzj5FBBqJU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>2ï¼‰æ ¸å¿ƒç»„ä»¶</p>
<p>QKVçŸ©é˜µ(Query-Key-Value):</p>
<p><strong>Query</strong>: å½“å‰å¤„ç†ä½ç½®çš„è¡¨ç¤ºå‘é‡(éœ€è¦æŸ¥æ‰¾ä»€ä¹ˆ)</p>
<p><strong>Key</strong>: æ‰€æœ‰ä½ç½®çš„ç´¢å¼•å‘é‡(èƒ½æä¾›ä»€ä¹ˆä¿¡æ¯)</p>
<p><strong>Value</strong>: å®é™…æºå¸¦çš„ä¿¡æ¯å‘é‡(æœ€ç»ˆä¼ é€’çš„ä¿¡æ¯)</p>
<p>ä¸‰è€…å‡é€šè¿‡çº¿æ€§å˜æ¢ä»è¾“å…¥å‘é‡è·å¾—ï¼Œå…±äº«åŒä¸€ç»„è¾“å…¥ä½†æ‰¿æ‹…ä¸åŒè§’è‰²</p>
<p>3ï¼‰è®¡ç®—è¿‡ç¨‹</p>
<p>Step 1: <strong>ç›¸ä¼¼åº¦è®¡ç®—</strong>: é€šè¿‡Queryä¸æ‰€æœ‰Keyçš„ç‚¹ç§¯è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°</p>
<p>Step 2: <strong>æƒé‡å½’ä¸€åŒ–</strong>: ä½¿ç”¨Softmaxå‡½æ•°å°†åˆ†æ•°è½¬æ¢ä¸ºæ¦‚ç‡åˆ†å¸ƒ: AttentionWeights=Softmax(Score)</p>
<p>Step 3: <strong>ä¿¡æ¯èšåˆ</strong>: åŠ æƒæ±‚å’ŒValueå‘é‡: 0utput=Î£(Attention Weights * Value)</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c37028f55e0f4a2592eae59136f69987~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764215225&amp;x-signature=bQv0BN7xrjdHDineX9GwxuUjQ7I%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>4ï¼‰å¤šå¤´æ³¨æ„åŠ›(Multi-Head)</p>
<p>å¹¶è¡Œå¤šä¸ªç‹¬ç«‹çš„OKVè®¡ç®—é€šé“</p>
<p>æ¯ä¸ª"å¤´"å­¦ä¹ ä¸åŒçš„è¯­ä¹‰ç©ºé—´å…³ç³»</p>
<p>æœ€ç»ˆæ‹¼æ¥æ‰€æœ‰å¤´çš„è¾“å‡ºå¹¶é€šè¿‡çº¿æ€§å±‚èåˆ</p>
<p>5ï¼‰æ ¸å¿ƒä¼˜åŠ¿</p>
<p><strong>ä¸Šä¸‹æ–‡æ„ŸçŸ¥</strong>: æ¯ä¸ªè¯çš„è¡¨ç¤ºåŠ¨æ€ä¾èµ–ä¸Šä¸‹æ–‡</p>
<p><strong>å¹¶è¡Œè®¡ç®—</strong>: çªç ´RNNçš„åºåˆ—ä¾èµ–é™åˆ¶</p>
<p><strong>é•¿ç¨‹ä¾èµ–</strong>: ç›´æ¥å»ºç«‹ä»»æ„ä½ç½®å…³è”</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a4e3b55bd77449fa876eaf729adef1b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764215225&amp;x-signature=YwWzJrJfHOxnvxmM5PVLMnnoGpo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>6ï¼‰å®é™…åº”ç”¨ç†è§£</p>
<p>å½“å¤„ç†å¥å­"The animal didn't cross the street because it was tootired"æ—¶:</p>
<p>"it"çš„Queryä¼šä¸"animal"çš„Keyäº§ç”Ÿé«˜ç›¸å…³æ€§</p>
<p>è‡ªåŠ¨æ¶ˆé™¤æŒ‡ä»£æ­§ä¹‰ï¼Œè€ŒéåƒRNNéœ€è¦é€æ­¥ä¼ é€’çŠ¶æ€</p>
<p>é€šè¿‡å¤šå¤´æœºåˆ¶ï¼ŒåŒæ—¶æ•è·è¯­æ³•ç»“æ„å’Œè¯­ä¹‰å…³è”</p>
<p><strong>äºŒã€è‡ªæ³¨æ„åŠ›æœºåˆ¶</strong></p>
<p><strong>1ã€è‡ªæ³¨æ„åŠ›æœºåˆ¶æ˜¯ä»€ä¹ˆ?</strong></p>
<p>è‡ªæ³¨æ„åŠ›æœºåˆ¶å°±åƒâ€œä¿¡æ¯å…³è”é›·è¾¾â€ã€‚å‡è®¾ä½ åœ¨è¯»ä¸€å¥è¯ï¼Œæ¯ä¸ªè¯éƒ½ä¼šè‡ªåŠ¨æ‰«ææ•´å¥è¯çš„å…¶ä»–è¯ï¼Œæ‰¾å‡ºå“ªäº›è¯å’Œè‡ªå·±ç›¸å…³(æ¯”å¦‚â€œçŒ«â€ä¼šæ›´å…³æ³¨â€œæŠ“"è€é¼ â€)ã€‚é€šè¿‡åŠ¨æ€è®¡ç®—æƒé‡ï¼Œæ¨¡å‹å†³å®šåœ¨ç†è§£å½“å‰è¯æ—¶ï¼Œåº”è¯¥â€œé‡è§†â€œå“ªäº›ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c1797787ddd42b19fecfc8b0bdce3e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764215225&amp;x-signature=DyqZloisIf1hIVlJp%2BsbetSuHP0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>æŠ€æœ¯å®šä¹‰</strong></p>
<p>è‡ªæ³¨æ„åŠ›(Self-Attention)æ˜¯è®©è¾“å…¥åºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ (å¦‚å•è¯)é€šè¿‡<strong>æŸ¥è¯¢(Query)ã€é”®(Key)ã€å€¼(Value)</strong> å‘é‡ï¼Œä¸å…¶ä»–å…ƒç´ è®¡ç®—ç›¸å…³æ€§æƒé‡ï¼Œæœ€ç»ˆåŠ æƒèšåˆå…¨å±€ä¿¡æ¯çš„æœºåˆ¶ã€‚</p>
<p><strong>2ã€è‡ªæ³¨æ„åŠ›çš„å·¥ä½œåŸç†(ç®€åŒ–ç‰ˆ)</strong></p>
<p>è¾“å…¥å¤„ç†</p>
<p>æ¯ä¸ªè¯(å¦‚â€œçŒ«â€)è¢«è½¬æ¢ä¸ºä¸‰ä¸ªå‘é‡:</p>
<p>Query(è¦æ‰¾ä»€ä¹ˆ)</p>
<p>Key(èƒ½æä¾›ä»€ä¹ˆ)</p>
<p>Value(å®é™…å†…å®¹)</p>
<p>è®¡ç®—ç›¸å…³æ€§</p>
<p>ç”¨Queryå’Œæ‰€æœ‰è¯çš„Keyåšç‚¹ç§¯ï¼Œå¾—åˆ°ç›¸å…³æ€§åˆ†æ•°(å¦‚â€œçŒ«â€å’Œâ€œæŠ“â€åˆ†æ•°é«˜ï¼Œå’Œâ€œå¤©ç©ºâ€åˆ†æ•°ä½)ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd19d2e5e75441899fdab0e67d031da4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764215225&amp;x-signature=ZYuLjkyhBWDvusur8GenAoONK3Q%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å½’ä¸€åŒ–ä¸èšåˆ</p>
<p>å¯¹åˆ†æ•°åšSoftmaxå½’ä¸€åŒ–ï¼Œå¾—åˆ°æƒé‡(æ€»å’Œä¸º1)</p>
<p>ç”¨æƒé‡å¯¹ValueåŠ æƒæ±‚å’Œï¼Œå¾—åˆ°å½“å‰è¯çš„æ–°è¡¨ç¤º(èåˆäº†ç›¸å…³ä¸Šä¸‹æ–‡)</p>
<p><strong>3ã€ä¸ç›¸å…³æ¦‚å¿µå¯¹æ¯”</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c2492a82d7142d1949c444f3b4ad4f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764215225&amp;x-signature=pNemC8d3aVGKuEobcWEZKArMwLc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>4ã€è¯´äººè¯ç‰ˆ: ç”¨â€œè‡ªåŠ©é¤å…é€‰é¤â€ç†è§£è‡ªæ³¨æ„åŠ›</strong></p>
<p>æƒ³è±¡ä½ åœ¨è‡ªåŠ©é¤å…æ­é…ä¸€ä»½è¥å…»å‡è¡¡çš„é¤ç›˜:</p>
<p><strong>Query(éœ€æ±‚)</strong> : ä½ ä»Šå¤©çš„è¥å…»ç›®æ ‡(æ¯”å¦‚â€œé«˜è›‹ç™½ã€ä½ç³–â€)</p>
<p><strong>Key(é£Ÿç‰©å±æ€§)</strong> : æ¯é“èœçš„æ ‡ç­¾(å¦‚â€œç‰›æ’: é«˜è›‹ç™½; è›‹ç³•: é«˜ç³–â€)</p>
<p><strong>Value(å®é™…å†…å®¹)</strong> : é£Ÿç‰©æœ¬èº«ã€‚</p>
<p>è‡ªæ³¨æ„åŠ›è¿‡ç¨‹:</p>
<p>ä½ æ‹¿ç€éœ€æ±‚(Query)æ‰«ææ‰€æœ‰èœçš„æ ‡ç­¾(Key)ï¼Œè®¡ç®—åŒ¹é…åº¦(æ¯”å¦‚ç‰›æ’å¾—åˆ†é«˜ï¼Œè›‹ç³•å¾—åˆ†ä½)ã€‚</p>
<p>æ ¹æ®å¾—åˆ†åˆ†é…å–é¤é‡(Softmaxæƒé‡): ç‰›æ’æ‹¿å¤šï¼Œè›‹ç³•æ‹¿å°‘ã€‚</p>
<p>æœ€ç»ˆé¤ç›˜(è¾“å‡º)æ˜¯å„èœå“(Value)æŒ‰æƒé‡çš„ç»„åˆï¼Œæ»¡è¶³ä½ çš„å…¨å±€éœ€æ±‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c316c049f0a64cb1a3c4bf5b122d393f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764215225&amp;x-signature=yrC%2BOHZj5eYBBQQQGcCe3YLgfo0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¯¹æ¯”ä¼ ç»Ÿæ–¹æ³•:</p>
<p><strong>RNNå¼é€‰é¤</strong>: å¿…é¡»æŒ‰é¡ºåºå–èœï¼Œä¸”æ¯æ¬¡åªèƒ½å‚è€ƒå‰ä¸€é“èœçš„é€‰æ‹©ï¼Œå®¹æ˜“æ¼æ‰åé¢çš„ä¼˜è´¨é€‰é¡¹</p>
<p><strong>CNNå¼é€‰é¤</strong>: æ¯æ¬¡åªçœ‹ç›¸é‚»çš„3ä¸ªèœï¼Œè¦æ¥å›èµ°å¤šæ¬¡æ‰èƒ½è¦†ç›–å…¨éƒ¨èœå“</p>
<p><strong>5ã€æ€»ç»“ä¸å­¦ä¹ å»ºè®®</strong></p>
<p><strong>æ€»ç»“</strong></p>
<p>è‡ªæ³¨æ„åŠ›æœºåˆ¶é€šè¿‡â€œåŠ¨æ€å…³è”å…¨å±€ä¿¡æ¯â€ï¼Œè§£å†³äº†ä¼ ç»Ÿæ¨¡å‹æ— æ³•é«˜æ•ˆå¤„ç†é•¿è·ç¦»ä¾èµ–ã€è®¡ç®—å†—ä½™çš„é—®é¢˜ã€‚å®ƒæ˜¯Transformerçš„æ ¸å¿ƒï¼Œä¹Ÿæ˜¯ChatGPTã€BERTç­‰å¤§æ¨¡å‹ç†è§£ä¸Šä¸‹æ–‡çš„å…³é”®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bde75899e58a4bb298f0774a5e9ac388~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764215225&amp;x-signature=xOyydlwhiOTk9EIOk5f53I6khm4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å­¦ä¹ å»ºè®®</strong></p>
<p>1ï¼‰å…ˆç†è§£æ ¸å¿ƒæ€æƒ³:</p>
<p>é‡ç‚¹æŒæ¡Queryã€Keyã€Valueçš„ä½œç”¨ï¼Œä»¥åŠâ€œæƒé‡åˆ†é…-èšåˆâ€çš„æµç¨‹ï¼Œæš‚æ—¶å¿½ç•¥æ•°å­¦ç»†èŠ‚ã€‚</p>
<p>2ï¼‰å¯¹æ¯”å®éªŒ:</p>
<p>ç”¨PyTorch/TensorFlowå®ç°ä¸€ä¸ªç®€å•çš„è‡ªæ³¨æ„åŠ›æ¨¡å—(10è¡Œä»£ç ä»¥å†…)ï¼Œå¯¹æ¯”è¾“å…¥è¾“å‡ºå˜åŒ–ã€‚</p>
<p>3ï¼‰ç»“åˆç»å…¸è®ºæ–‡:</p>
<p>ç²¾è¯»ã€ŠAttention Is All You Needã€‹çš„æ³¨æ„åŠ›éƒ¨åˆ†ï¼Œé…åˆä»£ç è§£è¯»(æ¨èJay Alammarçš„åšå®¢)ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f38347fdc6b4f3692f2ff93b3c70e9d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764215225&amp;x-signature=%2FuFJefoTusLIge9aY%2BK8oZwdSaY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>4ï¼‰æ•°å­¦è¡¥å……:</p>
<p>å¤ä¹ çŸ©é˜µä¹˜æ³•ã€Softmaxå‡½æ•°ã€å‘é‡ç‚¹ç§¯çš„æ„ä¹‰(å…³é”®å…¬å¼ä¸è¶…è¿‡3ä¸ª)</p>
<p>5ï¼‰åº”ç”¨å»¶ä¼¸:</p>
<p>ç ”ç©¶å¤šå¤´æ³¨æ„åŠ›(Multi-Head)å¦‚ä½•æ‰©å±•æ¨¡å‹èƒ½åŠ›ï¼Œä»¥åŠä½ç½®ç¼–ç ä¸ºä½•å¿…è¦</p>
<p><strong>ä¸€å¥è¯å¿ å‘Š</strong>:</p>
<p>è‡ªæ³¨æ„åŠ›ä¸æ˜¯é­”æ³•ï¼Œæœ¬è´¨æ˜¯â€œé€šè¿‡æ•°æ®é©±åŠ¨çš„æƒé‡åˆ†é…ï¼Œå®ç°ä¿¡æ¯çš„é«˜æ•ˆæ•´åˆâ€ã€‚å…ˆå»ºç«‹ç›´è§‰ç†è§£ï¼Œå†æ·±å…¥æ•°å­¦å’Œä»£ç ï¼Œé¿å…è¢«å¤æ‚å…¬å¼åŠé€€ã€‚</p>
<p>æ›´å¤šAIå¤§æ¨¡å‹å­¦ä¹ è§†é¢‘åŠèµ„æºï¼Œéƒ½åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fyuan.zhipoai.cn%2F" target="_blank" title="https://yuan.zhipoai.cn/" ref="nofollow noopener noreferrer">æ™ºæ³ŠAI</a>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LLM å››é˜¶æ®µå’Œ Transformer æ¶æ„ï¼ˆä¸‰ï¼‰]]></title>    <link>https://juejin.cn/post/7574451949324992553</link>    <guid>https://juejin.cn/post/7574451949324992553</guid>    <pubDate>2025-11-20T03:54:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574451949324992553" data-draft-id="7574352425236955155" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LLM å››é˜¶æ®µå’Œ Transformer æ¶æ„ï¼ˆä¸‰ï¼‰"/> <meta itemprop="keywords" content="LLM"/> <meta itemprop="datePublished" content="2025-11-20T03:54:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å…µå¼ å¥"/> <meta itemprop="url" content="https://juejin.cn/user/1257497032405229"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LLM å››é˜¶æ®µå’Œ Transformer æ¶æ„ï¼ˆä¸‰ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1257497032405229/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å…µå¼ å¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T03:54:24.000Z" title="Thu Nov 20 2025 03:54:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>é˜¶æ®µäºŒçš„è¯¦ç»†æ¨ç†è¿‡ç¨‹è®²è§£å®Œæ¯•ï¼Œä½†è¿™æ—¶å€™ LLM åªç»è¿‡äº†é¢„è®­ç»ƒï¼Œä»–åªä¼šç»­å†™ï¼Œé˜¶æ®µä¸‰é€šè¿‡ç‰¹å®šçš„è°ƒè¯•ï¼Œè®© LLM æ‹¥æœ‰é—®ç­”ã€è§„é¿é£é™©ç­‰çœŸæ­£å¯ä»¥è¢«äººç”¨çš„èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-0">é˜¶æ®µä¸‰</h2>
<p>é˜¶æ®µäºŒçš„äº§ç‰©ç§°ä¹‹ä¸º Base Modleï¼Œé˜¶æ®µä¸‰è½¬ä¸º Chat Modleï¼Œå¹¶ç¬¦åˆ HHH åŸåˆ™ï¼ˆHelpful, Honest, Harmlessï¼‰ã€‚</p>
<h4 data-id="heading-1">SFT (Supervised Fine-Tuning) â€”â€” æ ¼å¼ä¸æŒ‡ä»¤å­¦ä¹ </h4>
<p>äººç±»äº‹å…ˆå†™å¥½ä¸€äº›é«˜è´¨é‡çš„é—®ç­”ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>Prompt: "å†™ä¸€ä¸ª Java Hello Worldã€‚"</li>
<li>Response: "<code>public class Main { ... }</code>"</li>
</ul>
<p>æŠŠè¿™ä¸€æ•´ä¸²ç»™ LLM è®­ç»ƒï¼Œä½†æ˜¯å¯¹ prompt åš <strong>Loss Maskingï¼ˆæŸå¤±æ©ç ï¼‰</strong>ï¼Œå³ä¸è®© LLM å­¦ä¹ å¦‚ä½•å†™ Promptï¼Œè€Œæ˜¯è®©ä»–å­¦ä¹ å¦‚ä½•å†™ Responseã€‚</p>
<p>è®­ç»ƒææ–™é‡ŒåŠ ä¸Š<strong>ç‰¹æ®Š Token æ³¨å…¥</strong>ï¼Œç”¨äºè¾¨è¯†å¯¹è¯äººå’Œå¼€å§‹ç»“æŸç‚¹ã€‚ç‰¹æ®Š token æ˜¯ä¸å¯è§çš„ï¼Œåªç”¨äºç»™ LLM åšåŒºåˆ†ã€‚</p>
<p>æ¯”å¦‚åŸå§‹æ•°æ®æ˜¯ï¼š</p>
<p><code>User: Hi AI: Hello</code></p>
<p>æ ¼å¼åŒ–åæ˜¯:</p>
<p><code>&lt;|im_start|&gt;user\nHi&lt;|im_end|&gt;\n&lt;|im_start|&gt;assistant\nHello&lt;|im_end|&gt;</code></p>
<p>è¿™ä¸ªè¿‡ç¨‹çš„äº§ç‰©æ˜¯ SFT æ¨¡å‹ï¼Œåªä¼šæ¨¡ä»¿äººç±»å›ç­”ï¼Œæ— æ³•åˆ†è¾¨å¥½åã€‚</p>
<h4 data-id="heading-2">Rejection Sampling (æ‹’ç»é‡‡æ · / è¿­ä»£å¼ SFT)</h4>
<p>æ‹¿ç€è®­ç»ƒå¥½çš„ SFT é’ˆå¯¹åŒä¸€ä¸ª Prompt ç”Ÿæˆ 10 ä¸ªå›ç­”ï¼Œä½¿ç”¨æ›´é«˜çº§çš„æ¨¡å‹ã€æˆ–è€…ç¡¬æ€§æ ‡å‡†ï¼ˆæ¯”å¦‚ç”Ÿæˆçš„ä»£ç èƒ½ä¸èƒ½å…è®¸ï¼‰å¯¹å›ç­”åšè¯„åˆ¤ï¼Œé€‰å‡ºæœ€å¥½çš„ä¸€ä¸ªã€‚</p>
<p>å†æŠŠè¿™ä¸ªå½“åšæ•°æ®ï¼Œè¿­ä»£ SFTã€‚</p>
<h4 data-id="heading-3">Alignment (ä»·å€¼å¯¹é½ / RLHF / DPO)</h4>
<p>è¿™ä¸€æ­¥å†³å®šäº†æ¨¡å‹çš„ä»·å€¼è§‚å’Œæ™ºåŠ›ä¸Šé™ï¼Œé€šå¸¸æœ‰ä¸¤ç§è·¯çº¿ã€‚</p>
<h5 data-id="heading-4">ä¼ ç»Ÿçš„ RLHF (PPO ç®—æ³•)</h5>
<p>å…ˆè®­ç»ƒä¸€ä¸ª Reward Model (RM) å¥–åŠ±æ¨¡å‹ï¼Œå³æŠŠ Unembedding å»æ‰æ”¹ä¸ºçº¿æ€§å±‚åªè¾“å‡ºä¸€ä¸ªåˆ†æ•°ï¼Œç”±äººç±»æ¥é€‰æ‹©å›ç­” A å’Œ B é‚£ä¸ªåˆ†æ›´é«˜ï¼ŒRM å­¦ä¹ è¿™ä¸ªè¿‡ç¨‹ï¼Œå˜ä¸ºä¸€ä¸ªæ‰“åˆ†æ¨¡å‹ã€‚</p>
<p>ç”±ä¸»æ¨¡å‹ç”Ÿæˆç­”æ¡ˆï¼Œè®© RM å¥–åŠ±æ¨¡å‹æ‰“åˆ†ï¼Œå†åå‘ä¼ æ’­ä¿®æ”¹æ¨¡å‹å‚æ•°ã€‚</p>
<h4 data-id="heading-5">ç›´æ¥åå¥½ä¼˜åŒ– (DPO - Direct Preference Optimization)</h4>
<p>å»æ‰ RM æ¨¡å‹ï¼Œä½¿ç”¨ä¸€ä¸ªæŸå¤±å‡½æ•°å–ä»£ã€‚</p>
<p>ä½¿ç”¨ç°æœ‰çš„ç­”æ¡ˆï¼Œåˆ†æç”Ÿæˆçš„ç­”æ¡ˆæ›´é è¿‘å¥½è¿˜æ˜¯åï¼Œé è¿‘å¥½åˆ™å¼ºåŒ–ï¼Œé è¿‘ååˆ™è°ƒæ•´å‚æ•°ã€‚</p>
<h4 data-id="heading-6">Safety &amp; Red Teaming (å®‰å…¨å›´æ ä¸çº¢é˜Ÿæµ‹è¯•)</h4>
<p>ä½¿ç”¨é»‘å®¢ã€è‡ªåŠ¨åŒ–è„šæœ¬ç­‰ç”Ÿæˆä¸å®‰å…¨æ–¹å‘çš„ Promptï¼Œé’ˆå¯¹é˜²å¾¡å¤±è´¥çš„æ¡ˆä¾‹ï¼Œäººå·¥æ’°å†™æ‹’ç»å›å¤ç­”æ¡ˆï¼Œå†ç”¨è¿™äº›æ•°æ®è®­ç»ƒ LLMã€‚</p>
<h2 data-id="heading-7">é˜¶æ®µå››</h2>
<p>è‡³æ­¤å®Œæ•´å¯ä»¥ç”¨çš„ LLM å·²ç»è®­ç»ƒå®Œæ¯•ï¼ŒæŠŠæ‰€æœ‰çš„å‚æ•°éƒ½æ”¹ä¸ºåªè¯»ï¼Œå°†æ¨¡å‹éƒ¨ç½²åˆ°çº¿ä¸Šå³å¯ä½¿ç”¨ã€‚</p>
<p>æ ‡å‡†çš„æ¨¡å‹éå¸¸å¤§ï¼Œå‚æ•°å¾ˆå¤šï¼Œéœ€è¦æå¤§çš„æ˜¾å­˜æ‰èƒ½å…è®¸ï¼Œé€šè¿‡<strong>é‡åŒ–ä¸å‹ç¼© (Quantization)</strong> é™ä½æ¨¡å‹æƒé‡ï¼Œæ¯”å¦‚ä» <strong>16-bit æµ®ç‚¹æ•° (FP16)</strong> å‹ç¼©æˆ <strong>4-bit æ•´æ•° (INT4)</strong> æ¥é™ä½ç¼“å­˜å ç”¨ã€‚</p>
<p>æ¨¡å‹åƒæ˜¯ Java ç¨‹åºä¸€æ ·ä¹Ÿè¦æœ‰å®¹å™¨ï¼Œçº¿ä¸Šä¸€èˆ¬ç”¨ vLLMï¼Œæœ¬åœ°ç”¨ Ollamaã€‚</p>
<p>éšç€çŸ¥è¯†ä¸æ–­æ›´æ–°ï¼Œä¸å¯èƒ½å®æ—¶è®­ç»ƒæ¨¡å‹ï¼Œå°±æœ‰äº† <strong>RAG</strong> è¿™ç§å¤–æŒ‚ç¡¬ç›˜çš„è£…ç½®ï¼ŒæŠŠå®æ—¶æœ€æ–°å†…å®¹ï¼Œæˆ–è€…ä¼ä¸šç§æœ‰æ•°æ®ï¼ŒåŠ å…¥åˆ°å¯¹è¯çš„ä¸Šä¸‹æ–‡ã€‚</p>
<p>å¦‚æœä¸è‡³äºå¯¹è¯é—®ç­”ï¼Œè¿˜å¯ä»¥é€šè¿‡ Agent å®ç°æ›´å¤šåŠŸèƒ½ï¼Œæ¯”å¦‚é€šè¿‡ MCP æŸ¥è¯¢æå‰ã€åœ°å›¾è·¯çº¿ç­‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[.sync ä¿®é¥°ç¬¦ | vueå‰ç«¯çŸ¥è¯†]]></title>    <link>https://juejin.cn/post/7574286569038168127</link>    <guid>https://juejin.cn/post/7574286569038168127</guid>    <pubDate>2025-11-19T17:32:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574286569038168127" data-draft-id="7574281453707837446" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=".sync ä¿®é¥°ç¬¦ | vueå‰ç«¯çŸ¥è¯†"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2025-11-19T17:32:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å—æ´‹èŠ‹å˜˜ç‰‡"/> <meta itemprop="url" content="https://juejin.cn/user/1889439483175402"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            .sync ä¿®é¥°ç¬¦ | vueå‰ç«¯çŸ¥è¯†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1889439483175402/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å—æ´‹èŠ‹å˜˜ç‰‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T17:32:00.000Z" title="Wed Nov 19 2025 17:32:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">.sync ä¿®é¥°ç¬¦</h2>
<p>åœ¨ Vue 2 ä¸­ï¼Œ<code>.sync</code> ä¿®é¥°ç¬¦æ˜¯å®ç°çˆ¶å­ç»„ä»¶åŒå‘æ•°æ®ç»‘å®šçš„è¯­æ³•ç³–ï¼Œç‰¹åˆ«é€‚åˆç”¨äºå¼¹çª—è¿™ç±»éœ€è¦å­ç»„ä»¶ä¿®æ”¹çˆ¶ç»„ä»¶çŠ¶æ€çš„åœºæ™¯ã€‚</p>
<h3 data-id="heading-1">åŸºæœ¬æ¦‚å¿µ</h3>
<p><code>.sync</code> ä¿®é¥°ç¬¦ï¼Œå®é™…ä¸Šå°±æ˜¯å°†çˆ¶ç»„ä»¶çš„å±æ€§ï¼Œé€šè¿‡ <code>.sync</code> ä¿®é¥°ç¬¦ï¼Œæ˜ å°„åˆ°å­ç»„ä»¶çš„ <code>props</code> å±æ€§ä¸­ï¼Œå¹¶ç›‘å¬å­ç»„ä»¶çš„ <code>props</code> å±æ€§çš„ä¿®æ”¹ï¼Œå°†ä¿®æ”¹åçš„å€¼ï¼Œé€šè¿‡ <code>$emit</code> äº‹ä»¶å‘é€ç»™çˆ¶ç»„ä»¶ï¼Œä»è€Œå®ç°çˆ¶å­ç»„ä»¶çš„æ•°æ®åŒæ­¥ã€‚</p>
<p>æœ¬è´¨æ˜¯è‡ªåŠ¨ä¸ºä½ æ‰©å±•äº†ä¸€ä¸ª <code>v-on</code> ç›‘å¬å™¨ã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- ä½¿ç”¨ .sync çš„å†™æ³• --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ChildComponent</span> <span class="hljs-attr">:visible.sync</span>=<span class="hljs-string">"dialogVisible"</span> /&gt;</span>

<span class="hljs-comment">&lt;!-- ç­‰æ•ˆäºå®Œæ•´å†™æ³• --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ChildComponent</span>
    <span class="hljs-attr">:visible</span>=<span class="hljs-string">"dialogVisible"</span>
    @<span class="hljs-attr">update:visible</span>=<span class="hljs-string">"val =&gt; dialogVisible = val"</span>
/&gt;</span>
</code></pre>
<h3 data-id="heading-2">ä¸¾ä¾‹</h3>
<h4 data-id="heading-3">1. å¼•å…¥å¹¶æ³¨å†Œå¼¹çª—ç»„ä»¶</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">MyDialog</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./MyDialog.vue"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">components</span>: {
        <span class="hljs-title class_">MyDialog</span>,
    },
    <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">showDialog</span>: <span class="hljs-literal">false</span>,
        };
    },
};
</code></pre>
<h4 data-id="heading-4">2. æ³¨å†Œç‚¹å‡»äº‹ä»¶å¹¶ç»‘å®šå¼¹çª—ç»„ä»¶</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"parent"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"showDialog = true"</span>&gt;</span>æ‰“å¼€å¼¹çª—<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- ä½¿ç”¨ .sync ä¿®é¥°ç¬¦ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">MyDialog</span> <span class="hljs-attr">:visible.sync</span>=<span class="hljs-string">"showDialog"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"ç¤ºä¾‹å¼¹çª—"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<h4 data-id="heading-5">3. å­ç»„ä»¶ï¼šå¼¹çª—é€»è¾‘</h4>
<h5 data-id="heading-6">3.1 å®šä¹‰æ¥æ”¶çš„ <code>props</code></h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">props</span>: {
  <span class="hljs-attr">visible</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>
  },
  <span class="hljs-attr">title</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-string">'å¼¹çª—æ ‡é¢˜'</span>
  }
},
</code></pre>
<h5 data-id="heading-7">3.2 ä½¿ç”¨ <code>v-if</code> æ§åˆ¶å¼¹çª—æ˜¾ç¤º</h5>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dialog-overlay"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"visible"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dialog-content"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dialog-header"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{{ title }}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"close-btn"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"closeDialog"</span>&gt;</span>Ã—<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dialog-body"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è¿™æ˜¯ä¸€ä¸ªå¼¹çª—å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- æ”¯æŒæ’æ§½å†…å®¹ --&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dialog-footer"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"closeDialog"</span>&gt;</span>å–æ¶ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"confirm"</span>&gt;</span>ç¡®å®š<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<h5 data-id="heading-8">3.3 å…³é—­å¼¹çª—é€»è¾‘</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">methods</span>: {
  <span class="hljs-title function_">closeDialog</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å…³é”®ï¼šä½¿ç”¨ update:visible æ¨¡å¼è§¦å‘äº‹ä»¶</span>
    <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">'update:visible'</span>, <span class="hljs-literal">false</span>);
  },
  <span class="hljs-title function_">confirm</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¡®è®¤æ“ä½œ'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">closeDialog</span>();
  }
},
</code></pre>
<h5 data-id="heading-9">3.4 ç›‘å¬ <code>visible</code> å˜åŒ–ï¼ˆå¯é€‰ï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">watch</span>: {
  <span class="hljs-comment">// ç›‘å¬ visible å˜åŒ–ï¼Œå¤„ç†å¤–éƒ¨å¯¹å¼¹çª—çš„å…³é—­</span>
  <span class="hljs-title function_">visible</span>(<span class="hljs-params">newVal</span>) {
    <span class="hljs-keyword">if</span> (!newVal) {
      <span class="hljs-comment">// å¼¹çª—å…³é—­æ—¶çš„æ¸…ç†æ“ä½œ</span>
    }
  }
}
</code></pre>
<h4 data-id="heading-10">è¯¦ç»†ä»£ç </h4>
<h5 data-id="heading-11">çˆ¶ç»„ä»¶ï¼ˆä½¿ç”¨å¼¹çª—ï¼‰</h5>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"parent"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"showDialog = true"</span>&gt;</span>æ‰“å¼€å¼¹çª—<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- ä½¿ç”¨.syncä¿®é¥°ç¬¦ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">MyDialog</span> <span class="hljs-attr">:visible.sync</span>=<span class="hljs-string">"showDialog"</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"ç¤ºä¾‹å¼¹çª—"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">import</span> <span class="hljs-title class_">MyDialog</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./MyDialog.vue"</span>;

    <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
        <span class="hljs-attr">components</span>: {
            <span class="hljs-title class_">MyDialog</span>,
        },
        <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">showDialog</span>: <span class="hljs-literal">false</span>,
            };
        },
    };
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h5 data-id="heading-12">å­ç»„ä»¶å¼¹çª—ï¼ˆMyDialog.vueï¼‰</h5>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dialog-overlay"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"visible"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dialog-content"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dialog-header"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{{ title }}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"close-btn"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"closeDialog"</span>&gt;</span>Ã—<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dialog-body"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è¿™æ˜¯ä¸€ä¸ªå¼¹çª—å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
                <span class="hljs-comment">&lt;!-- æ”¯æŒæ’æ§½å†…å®¹ --&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dialog-footer"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"closeDialog"</span>&gt;</span>å–æ¶ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"confirm"</span>&gt;</span>ç¡®å®š<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
        <span class="hljs-attr">props</span>: {
            <span class="hljs-attr">visible</span>: {
                <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
                <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>,
            },
            <span class="hljs-attr">title</span>: {
                <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
                <span class="hljs-attr">default</span>: <span class="hljs-string">"å¼¹çª—æ ‡é¢˜"</span>,
            },
        },
        <span class="hljs-attr">methods</span>: {
            <span class="hljs-title function_">closeDialog</span>(<span class="hljs-params"/>) {
                <span class="hljs-comment">// å…³é”®ï¼šä½¿ç”¨update:visibleæ¨¡å¼è§¦å‘äº‹ä»¶</span>
                <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">"update:visible"</span>, <span class="hljs-literal">false</span>);
            },
            <span class="hljs-title function_">confirm</span>(<span class="hljs-params"/>) {
                <span class="hljs-comment">// æ‰§è¡Œç¡®è®¤æ“ä½œ...</span>
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¡®è®¤æ“ä½œ"</span>);
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">closeDialog</span>();
            },
        },
        <span class="hljs-attr">watch</span>: {
            <span class="hljs-comment">// ç›‘å¬visibleå˜åŒ–ï¼Œå¤„ç†å¤–éƒ¨å¯¹å¼¹çª—çš„å…³é—­</span>
            <span class="hljs-title function_">visible</span>(<span class="hljs-params">newVal</span>) {
                <span class="hljs-keyword">if</span> (!newVal) {
                    <span class="hljs-comment">// å¼¹çª—å…³é—­æ—¶çš„æ¸…ç†æ“ä½œ</span>
                }
            },
        },
    };
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span>
    // æ ·å¼
<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h3 data-id="heading-13">æ€»ç»“</h3>
<ol>
<li>
<p><strong><code>.sync</code> çš„ä½œç”¨</strong>ï¼š</p>
<ul>
<li>å®ç°çˆ¶å­ç»„ä»¶åŒå‘ç»‘å®šï¼Œç®€åŒ–ä»£ç ã€‚</li>
<li>ç‰¹åˆ«é€‚åˆå¼¹çª—ç­‰éœ€è¦é¢‘ç¹åˆ‡æ¢æ˜¾ç¤ºçŠ¶æ€çš„åœºæ™¯ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ ¸å¿ƒé€»è¾‘</strong>ï¼š</p>
<ul>
<li>çˆ¶ç»„ä»¶é€šè¿‡ <code>.sync</code> å°†çŠ¶æ€ä¼ é€’ç»™å­ç»„ä»¶ã€‚</li>
<li>å­ç»„ä»¶é€šè¿‡ <code>$emit('update:visible', value)</code> ä¿®æ”¹çˆ¶ç»„ä»¶çš„çŠ¶æ€ã€‚</li>
</ul>
</li>
<li>
<p><strong>å¯é€‰åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>å¦‚æœéœ€è¦åœ¨å¼¹çª—å…³é—­æ—¶æ‰§è¡Œæ¸…ç†æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨ <code>watch</code> ç›‘å¬ <code>visible</code> çš„å˜åŒ–ã€‚</li>
</ul>
</li>
<li>
<p><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>
<p>å¼¹çª—æ˜¾ç¤º/éšè—æ§åˆ¶</p>
</li>
<li>
<p>è¡¨å•ç¼–è¾‘å¯¹è¯æ¡†</p>
</li>
<li>
<p>ç¡®è®¤å¯¹è¯æ¡†</p>
</li>
<li>
<p>è®¾ç½®é¢æ¿</p>
</li>
<li>
<p>ä»»ä½•éœ€è¦å­ç»„ä»¶ä¿®æ”¹çˆ¶ç»„ä»¶çŠ¶æ€çš„åœºæ™¯</p>
</li>
</ul>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¯»è¿™ä¸€ç¯‡ï¼Œä½ èƒ½æŠŠå“¨å…µæ¨¡å¼è®²ç»™ HR å¬å¥¹éƒ½èƒ½æ‡‚ï¼]]></title>    <link>https://juejin.cn/post/7574276404597014580</link>    <guid>https://juejin.cn/post/7574276404597014580</guid>    <pubDate>2025-11-20T02:04:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574276404597014580" data-draft-id="7574329472922501154" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¯»è¿™ä¸€ç¯‡ï¼Œä½ èƒ½æŠŠå“¨å…µæ¨¡å¼è®²ç»™ HR å¬å¥¹éƒ½èƒ½æ‡‚ï¼"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,Redis"/> <meta itemprop="datePublished" content="2025-11-20T02:04:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è½¯ä»¶æ±‚ç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/1038379932466263"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¯»è¿™ä¸€ç¯‡ï¼Œä½ èƒ½æŠŠå“¨å…µæ¨¡å¼è®²ç»™ HR å¬å¥¹éƒ½èƒ½æ‡‚ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1038379932466263/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è½¯ä»¶æ±‚ç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T02:04:37.000Z" title="Thu Nov 20 2025 02:04:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å°ç±³ï¼Œ31 å²ï¼Œçƒ­çˆ±æŠ€æœ¯ã€çƒ­çˆ±åˆ†äº«ã€çƒ­çˆ±å¥¶èŒ¶ï¼ˆè™½ç„¶åŒ»ç”Ÿè¯´æˆ‘åº”è¯¥å–æ— ç³–ï¼‰çš„å¤§å“¥å“¥ã€‚</p>
<p>æœ€è¿‘åˆé™ªæœ‹å‹åˆ· Java ç¤¾æ‹›é¢è¯•ï¼Œä»–ä¸€è„¸ç”Ÿæ— å¯æ‹ï¼šâ€œé¢è¯•å®˜åˆé—®æˆ‘ Redis sentinel å“¨å…µæ¨¡å¼ï¼Œæˆ‘è®°å¾—å¥½åƒæ˜¯ç›‘æ§ä¸»ä»çš„ï¼Ÿä½†ç»†èŠ‚æˆ‘åˆå¿˜äº†â€¦â€¦â€</p>
<p>æˆ‘æ‹ç€ä»–çš„è‚©è†€ï¼Œé€’ä¸Šä¸€æ¯å¥¶èŒ¶ï¼Œç¬‘ç€è¯´ï¼šâ€œå…„å¼Ÿï¼Œè¿™é¢˜æˆ‘ç”¨ä¸€æ¯å¥¶èŒ¶è®²ç»™ä½ å¬ã€‚å¬å®ŒåŒ…ä½ ä»æ‡µåˆ°ç²¾é€šã€‚â€</p>
<p>å–å£å¥¶èŒ¶ï¼Œæˆ‘ä»¬å¼€å§‹è®²æ•…äº‹ã€‚</p>
<h2 data-id="heading-0">å¦‚æœ Redis æ˜¯ä¸€å®¶å¥¶èŒ¶åº—</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼šRedis å°±åƒæ˜¯ä¸€å®¶è¶…ç«çˆ†çš„å¥¶èŒ¶åº—ï¼Œæ’é˜Ÿæ’åˆ°ä¸‰å…¬é‡Œå¤–é‚£ç§ã€‚</p>
<p>åº—é‡Œæœ‰ï¼š</p>
<ul>
<li><strong>ä¸€ä¸ªåº—é•¿ï¼ˆmasterï¼‰</strong> ï¼šè´Ÿè´£â€œå†²å¥¶èŒ¶ã€ç‚¹å•ã€æ‰“åŒ…â€ï¼Œè¶…çº§å¿™ã€‚</li>
<li><strong>å‡ ä¸ªåº—å‘˜ï¼ˆslaveï¼‰</strong> ï¼šè´Ÿè´£â€œå¤åˆ¶åº—é•¿çš„æ‰‹è‰ºâ€ï¼ŒåŒæ­¥åº—é•¿åˆ¶ä½œå¥¶èŒ¶çš„è¿‡ç¨‹ï¼Œä½†ä¸æ¥å•ã€‚</li>
</ul>
<p>æŸå¤©ï¼Œåº—é•¿å¹²ç´¯äº†ï¼Œâ€œå•ªâ€åœ°ä¸€ä¸‹æ™•å€’äº†â€¦â€¦</p>
<p>æ•´ä¸ªå¥¶èŒ¶åº—ç¬é—´ç˜«ç—ªï¼Œé¡¾å®¢å…¨è·‘äº†ã€‚</p>
<p>è¿™å°±æ˜¯ï¼š<strong>Redis å•ç‚¹æ•…éšœï¼Œmaster æŒ‚äº†ï¼Œæ•´æ¡æœåŠ¡å´©ç›˜ã€‚</strong></p>
<p>æ€ä¹ˆåŠï¼Ÿè®©æˆ‘ä»¬ç™»åœºâ€”â€”å“¨å…µï¼ˆSentinelï¼‰ï¼</p>
<h2 data-id="heading-1">å“¨å…µæ¨¡å¼å‡ºç°ï¼šç»™å¥¶èŒ¶åº—å®‰æ’ä¸€ç¾¤â€œåº—é•¿ç›‘ç£å‘˜â€</h2>
<p>â€œå“¨å…µæ¨¡å¼â€ï¼ˆRedis Sentinelï¼‰å°±æ˜¯ç»™ Redis å¥¶èŒ¶åº—å®‰æ’ä¸€ç¾¤â€œç›‘ç£å‘˜â€ã€‚</p>
<p>è¿™äº›ç›‘ç£å‘˜æ•´å¤©å›´ç€åº—é•¿è½¬ï¼š</p>
<ul>
<li><strong>ç›¯ç€åº—é•¿æœ‰æ²¡æœ‰æ™•å€’</strong></li>
<li><strong>ç›¯ç€åº—å‘˜ä»¬æ˜¯ä¸æ˜¯æ­£å¸¸å¤åˆ¶æ•°æ®</strong></li>
<li><strong>ä¸€æ—¦åº—é•¿çœŸçš„å€’äº†ï¼Œä»–ä»¬ä¼šå¬å¼€â€œç´§æ€¥ä¼šè®®â€</strong></li>
<li><strong>é€‰ä¸€ä¸ªåº—å‘˜å½“æ–°åº—é•¿</strong></li>
<li><strong>é€šçŸ¥æ‰€æœ‰é¡¾å®¢ï¼šâ€˜æ–°åº—é•¿ä¸Šä»»äº†ï¼ç»§ç»­å–å¥¶èŒ¶å§ï¼â€™</strong></li>
</ul>
<p>è¿™å°±æ˜¯ Redis å“¨å…µæ¨¡å¼çš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒRedis Sentinel çš„ä¸‰å¤§èŒè´£ï¼š</p>
<ul>
<li><strong>ç›‘æ§ï¼ˆMonitoringï¼‰ï¼š</strong> Sentinel ä¼šæŒç»­ç›‘æ§ master å’Œ slave æ˜¯å¦æ­£å¸¸ã€‚</li>
<li><strong>æ•…éšœæ¢å¤ï¼ˆFailoverï¼‰ï¼š</strong> master æŒ‚äº†ï¼Œè‡ªåŠ¨é€‰ä¸¾ä¸€ä¸ª slave ä¸ºæ–°çš„ masterï¼Œå»ºç«‹æ–°çš„ä¸»ä»ç»“æ„ã€‚</li>
<li><strong>é€šçŸ¥ï¼ˆNotificationï¼‰ï¼š</strong> æœ‰å˜åŒ–æ—¶é€šè¿‡ API æˆ–è„šæœ¬é€šçŸ¥å®¢æˆ·ç«¯ã€å…¶ä»–ç¨‹åºï¼šâ€œmaster æ¢äººå•¦ï¼â€</li>
</ul>
<p>æ˜¯ä¸æ˜¯ï¼Œå¾ˆåƒä¸€ç¾¤ä¸“ä¸šçš„åº—é•¿ç›‘ç£å‘˜ï¼Ÿ</p>
<h2 data-id="heading-2">å“¨å…µæ˜¯æ€ä¹ˆåˆ¤æ–­â€œåº—é•¿çœŸçš„æŒ‚äº†â€çš„ï¼Ÿ</h2>
<p>å“¨å…µä¸ä¼šåº—é•¿ä¸€å’³å—½å°±è¯´ä»–æŒ‚äº†ï¼ŒRedis çš„ Sentinel æœ‰ä¸¥æ ¼çš„åˆ¤æ–­æ ‡å‡†ã€‚</p>
<p><strong>1. ä¸»è§‚ä¸‹çº¿ï¼ˆSDOWNï¼‰</strong></p>
<p>æŸä¸ªå“¨å…µè®¤ä¸º master æ²¡å›åº”ï¼Œäºæ˜¯è¯´ï¼š</p>
<blockquote>
<p>â€œæˆ‘è§‰å¾—åº—é•¿æ™•äº†ã€‚â€</p>
<p>ä½†â€œæˆ‘è§‰å¾—â€ä¸èƒ½ä½œä¸ºè¯æ®ã€‚</p>
</blockquote>
<p>è¿™åªæ˜¯ <strong>ä¸»è§‚ä¸‹çº¿</strong>ã€‚</p>
<p><strong>2. å®¢è§‚ä¸‹çº¿ï¼ˆODOWNï¼‰</strong></p>
<p>åªæœ‰å½“<strong>å¤šä¸ªå“¨å…µ</strong>ä¸€èµ·æŠ•ç¥¨ï¼Œè¯´ï¼š</p>
<blockquote>
<p>â€œå¯¹ï¼Œæˆ‘ä¹Ÿè§‰å¾—åº—é•¿æŒ‚äº†ã€‚â€</p>
</blockquote>
<p>å“¨å…µé›†ç¾¤æ‰ä¼šç¡®è®¤ï¼š</p>
<blockquote>
<p>â€œOKï¼Œåº—é•¿çœŸçš„æŒ‚äº†ã€‚â€</p>
</blockquote>
<p>è¿™å« <strong>å®¢è§‚ä¸‹çº¿</strong>ï¼ˆODOWNï¼‰ã€‚åªæœ‰ ODOWN çŠ¶æ€ï¼Œå“¨å…µæ‰ä¼šå¯åŠ¨çœŸæ­£çš„<strong>æ•…éšœè½¬ç§»æµç¨‹</strong>ï¼ˆfailoverï¼‰ã€‚</p>
<h2 data-id="heading-3">ä½ ä»¥ä¸ºé€‰æ–°åº—é•¿å¾ˆç®€å•ï¼Ÿå“¨å…µçš„â€œç«é€‰å¤§ä¼šâ€æ¥äº†ï¼</h2>
<p>å½“ master è¢«åˆ¤å®š ODOWN åï¼Œå“¨å…µä¼šå¯åŠ¨ failover æµç¨‹ã€‚æµç¨‹å°±åƒä¸€åœºä¸¥æ ¼çš„ç«é€‰ï¼š</p>
<p><strong>1ã€æŒ‘é€‰å¥åº·çš„ slave</strong></p>
<ul>
<li>æ•°æ®åŒæ­¥æœ€å¥½</li>
<li>ä¸ä¸»èŠ‚ç‚¹å»¶è¿Ÿæœ€å°</li>
<li>ç½‘ç»œçŠ¶æ€æœ€å¥½</li>
</ul>
<p>æœ‰ç‚¹åƒï¼šè°çš„æ‰‹è‰ºæœ€åƒåº—é•¿ï¼Ÿè°æœ€é è°±ï¼Ÿ</p>
<p><strong>2ã€è®©å€™é€‰ slave æ‰§è¡Œ slaveof no one</strong></p>
<p>è¿™ä¸€æ­¥å¾ˆå…³é”®ï¼å®ƒæ„å‘³ç€ï¼šâ€œæˆ‘ä¸æ˜¯åº—å‘˜äº†ï¼Œæˆ‘ç°åœ¨å‡èŒå½“åº—é•¿ï¼â€</p>
<p><strong>3ã€é‡æ–°é…ç½®å‰©ä½™çš„ slave</strong></p>
<p>æŒ‡ä»¤ï¼šSLAVEOF æ–°master</p>
<p>æ„æ€æ˜¯ï¼šâ€œä»¥åä½ ä»¬éƒ½è·Ÿç€æ–°åº—é•¿å­¦æ‰‹è‰ºã€‚â€</p>
<p><strong>4ã€é€šçŸ¥æ‰€æœ‰å®¢æˆ·ç«¯</strong></p>
<p>ä»¥å‰çš„å®¢æˆ·ç«¯éƒ½è¿æ¥æ—§ masterã€‚ç°åœ¨å“¨å…µä¼šå‘Šè¯‰å®¢æˆ·ç«¯ï¼šâ€œmaster æ¢äººäº†ï¼Œåœ°å€åœ¨è¿™é‡Œï¼Œå»æ‰¾æ–°åº—é•¿ç‚¹å•å§ï¼â€</p>
<p>æ•´ä¸ªè¿‡ç¨‹è‡ªåŠ¨å®Œæˆï¼Œæ— éœ€äººå·¥å¹²é¢„ã€‚</p>
<h2 data-id="heading-4">é‡ç‚¹æ¥äº†ï¼šå“¨å…µé›†ç¾¤æ€ä¹ˆå·¥ä½œï¼Ÿ</h2>
<p>è¦ä¿è¯å“¨å…µæ¨¡å¼å¯é ï¼Œå¿…é¡»éƒ¨ç½²<strong>å¤šä¸ª Sentinel èŠ‚ç‚¹</strong>ã€‚ä¸ºä»€ä¹ˆï¼Ÿ</p>
<blockquote>
<p>å› ä¸ºä¸€ä¸ªå“¨å…µè¯´ master æ„Ÿè§‰æŒ‚äº†ï¼Œä¸å‡†ã€‚å¤šä¸ªå“¨å…µä¸€èµ·è¯´ master æŒ‚äº†ï¼Œæ‰ä¼šå¯åŠ¨ failoverã€‚</p>
</blockquote>
<p>å°±åƒï¼š</p>
<blockquote>
<p>ä¸€ä¸ªäººè¯´â€œåº—é•¿æ™•äº†â€ï¼Œå¯èƒ½æ˜¯çœ‹é”™äº†ï¼›ä¸‰ä¸ªäººéƒ½è¯´â€œåº—é•¿èººåœ°æ¿ä¸Šäº†â€ï¼Œé‚£å…«æˆæ˜¯çœŸçš„ã€‚</p>
</blockquote>
<h2 data-id="heading-5">å“¨å…µæ¨¡å¼çš„æ¶æ„ï¼šå…¶å®æ˜¯â€œä¸‰å±‚â€</h2>
<p>ä¸ºäº†è®©ä½ å½»åº•ç†è§£ï¼Œæˆ‘ç”¨æœ€ç®€å•çš„æ–¹å¼æ€»ç»“å“¨å…µæ¨¡å¼ä¸‰å±‚æ¶æ„ï¼š</p>
<p><strong>1ã€æ•°æ®å±‚ï¼šmaster + slave ç»“æ„</strong></p>
<p>è´Ÿè´£ï¼š</p>
<ul>
<li>å¤„ç†è¯»å†™ï¼ˆmasterï¼‰</li>
<li>å¤åˆ¶æ•°æ®ï¼ˆslaveï¼‰</li>
</ul>
<p><strong>2ã€ å“¨å…µå±‚ï¼šå¤šä¸ª Sentinel ç»„æˆé›†ç¾¤</strong></p>
<p>è´Ÿè´£ï¼š</p>
<ul>
<li>ç›‘æ§ master/slave çŠ¶æ€</li>
<li>é€‰æ–° master</li>
<li>é€šçŸ¥å®¢æˆ·ç«¯</li>
</ul>
<p>å“¨å…µä¹‹é—´ä¼šäº’ç›¸é€šä¿¡ï¼ŒæŠ•ç¥¨å†³å®š master æ˜¯å¦å®•æœºã€‚</p>
<p><strong>3ã€å®¢æˆ·ç«¯å±‚</strong></p>
<p>å®¢æˆ·ç«¯ä¸å†ç›´æ¥å†™æ­» master åœ°å€ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>è¿å“¨å…µ</li>
<li>å“¨å…µå‘Šè¯‰å®¢æˆ·ç«¯çœŸæ­£çš„ master æ˜¯è°</li>
<li>master æ”¹å˜æ—¶ï¼Œå“¨å…µä¼šé€šçŸ¥ä½ </li>
</ul>
<p>è¿™æ ·å®¢æˆ·ç«¯è‡ªåŠ¨é€‚åº”æ•…éšœæ¢å¤ï¼Œéå¸¸ç¨³ã€‚</p>
<h2 data-id="heading-6">é¢è¯•é—®ï¼šå“¨å…µæ¨¡å¼æœ‰ä»€ä¹ˆç¼ºç‚¹ï¼Ÿ</h2>
<p>è¿™æ˜¯é«˜é¢‘é—®é¢˜ï¼Œæˆ‘ç»™ä½ æ€»ç»“æˆä¸‰å¥è¯ï¼Œé¢è¯•å®˜å¬å®Œä¼šå¾ˆæ»¡æ„ã€‚</p>
<p><strong>1ã€Redis å“¨å…µæ¨¡å¼ä»å­˜åœ¨è„‘è£‚é£é™©</strong></p>
<p>å¦‚æœç½‘ç»œåˆ†åŒºï¼Œå¯èƒ½å‡ºç°ï¼š</p>
<ul>
<li>A ä»¥ä¸º master æŒ‚äº†ï¼Œé€‰ä¸€ä¸ª slave åšæ–° master</li>
<li>ä½†æ—§ master å®é™…è¿˜æ´»ç€</li>
</ul>
<p>å°±å‡ºç°ä¸¤ä¸ª masterï¼ˆè„‘è£‚ï¼‰ã€‚</p>
<p><strong>2ã€ä¸æ”¯æŒæ°´å¹³æ‰©å±•å†™æ“ä½œ</strong></p>
<p>å“¨å…µæ¨¡å¼ä»ç„¶åªæœ‰ä¸€ä¸ª masterï¼Œå†™èƒ½åŠ›å—é™ã€‚</p>
<p><strong>3ã€å¯é æ€§æ¯”é›†ç¾¤æ¨¡å¼å¼±</strong></p>
<p>å“¨å…µèƒ½è§£å†³â€œé«˜å¯ç”¨â€ï¼Œä¸èƒ½è§£å†³â€œæ•°æ®åˆ†ç‰‡ã€æ‰©å®¹â€é—®é¢˜ã€‚</p>
<h2 data-id="heading-7">å“¨å…µå’Œé›†ç¾¤æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h2>
<p>å¦‚æœä½ åœ¨é¢è¯•ç°åœºå›ç­”ä¸‹é¢è¿™å¥è¯ï¼Œé¢è¯•å®˜ä¼šç–¯ç‹‚ç‚¹å¤´ï¼š</p>
<blockquote>
<p>Sentinel è´Ÿè´£â€œé«˜å¯ç”¨â€ï¼›</p>
<p>Redis Cluster è´Ÿè´£â€œé«˜å¯ç”¨ + åˆ†ç‰‡ + æ‰©å±•â€ã€‚</p>
<p>å‰è€…æ˜¯ä¿æŠ¤ masterï¼Œä¸è®©å®ƒå®•æœºï¼›</p>
<p>åè€…æ˜¯è®©æ•°æ®å¯ä»¥æ¨ªå‘æ‰©å±•ã€‚</p>
</blockquote>
<p>ä¸€å¥è¯å°±åŒºåˆ†äº†ã€‚</p>
<h2 data-id="heading-8">å“¨å…µæ¨¡å¼å…¸å‹éƒ¨ç½²æ–¹å¼ï¼ˆé¢è¯•å®˜è¶…çˆ±é—®ï¼‰</h2>
<p>æœ€å¸¸è§çš„æ˜¯ï¼š</p>
<ul>
<li><strong>1 ä¸» 2 ä»</strong></li>
<li><strong>3~5 ä¸ª Sentinel</strong></li>
</ul>
<p>ä¸€ä¸ªå‚è€ƒéƒ¨ç½²ï¼š</p>
<blockquote>
<p>masterï¼ˆ1å°ï¼‰</p>
<p>slaveï¼ˆ2å°ï¼‰</p>
<p>sentinelï¼ˆ3å°ï¼‰</p>
</blockquote>
<p>Sentinel å¿…é¡»æ˜¯å¥‡æ•°ä¸ªï¼Œå› ä¸ºæŠ•ç¥¨è¦å¤šæ•°åŒæ„æ‰â€œå®¢è§‚ä¸‹çº¿â€ã€‚</p>
<p>é¢è¯•å®˜é—®ä½ ä¸ºä»€ä¹ˆè¦å¥‡æ•°ä¸ªï¼Œä½ å°±è¯´ï¼š</p>
<blockquote>
<p>å› ä¸ºå“¨å…µæ˜¯æŠ•ç¥¨æœºåˆ¶ï¼Œå¿…é¡»å¤šæ•°æ´¾å†³å®šæ‰èƒ½ failoverï¼Œå¥‡æ•°èƒ½é¿å…å¹³ç¥¨ã€‚</p>
</blockquote>
<p>å®Œç¾ï¼</p>
<h2 data-id="heading-9">å“¨å…µæ¨¡å¼çš„å®Œæ•´å·¥ä½œæµç¨‹ï¼ˆé¢è¯•å®˜æœ€å–œæ¬¢ï¼‰</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2fd1775c4cb4c3b8be883d9dd2626ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L2v5Lu25rGC55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209076&amp;x-signature=NP4PDhLui1n9LxUBBoBQtOwM3Ws%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æˆ‘å¸®ä½ æ€»ç»“æˆâ€œå…­æ­¥å£è¯€â€â€”â€”é¢è¯•ç­”é¢˜ç›´æ¥èƒŒï¼</p>
<p><strong>Redis å“¨å…µæ¨¡å¼ å…­æ­¥å£è¯€</strong></p>
<ol>
<li><strong>sentinel ç›‘æ§ master</strong></li>
<li><strong>master æ— å¿ƒè·³ â†’ ä¸»è§‚ä¸‹çº¿ SDOWN</strong></li>
<li><strong>å¤šæ•° sentinel æŠ•ç¥¨ â†’ å®¢è§‚ä¸‹çº¿ ODOWN</strong></li>
<li><strong>é€‰ slave å½“æ–° master</strong></li>
<li><strong>é€šçŸ¥æ‰€æœ‰ slave é‡æ–°è·Ÿéšæ–° master</strong></li>
<li><strong>é€šçŸ¥å®¢æˆ·ç«¯ï¼šæ–°çš„ master åœ°å€æ˜¯è°</strong></li>
</ol>
<p>è¿™å¥—é€»è¾‘ä½ èƒ½æµåˆ©æè¿°å‡ºæ¥ï¼Œè¿™é“é¢˜åŸºæœ¬ç¨³äº†ã€‚</p>
<h2 data-id="heading-10">æˆ‘æœ‹å‹é¢è¯•æœ€ç»ˆæ€ä¹ˆæ ·äº†ï¼Ÿ</h2>
<p>ç¬¬äºŒå¤©ï¼Œæˆ‘æœ‹å‹å»é¢è¯•ã€‚é¢è¯•å®˜æœç„¶é—®äº†ï¼šâ€œä½ è®²ä¸€ä¸‹ Redis å“¨å…µæ¨¡å¼ï¼Ÿâ€</p>
<p>æœ‹å‹ç«‹åˆ»æŠŠå¥¶èŒ¶æ•…äº‹æ¬å‡ºæ¥â€”â€”ä»ç›‘æ§ã€é€‰ä¸»ã€æŠ•ç¥¨ã€failoverï¼Œä¸€è·¯è®²å¾—é¡ºæºœçˆ†ç‚¸ã€‚</p>
<p>é¢è¯•å®˜å¬å¾—è¿è¿ç‚¹å¤´ï¼šâ€œä¸é”™ï¼Œè®²å¾—å¾ˆæ¸…æ¥šã€‚â€</p>
<p>æœ€ç»ˆä»–ä¹Ÿé¡ºåˆ©æ‹¿åˆ°äº† offerã€‚åæ¥ä»–å‘æ¶ˆæ¯ç»™æˆ‘ï¼Œè¯´ï¼šâ€œå“¨å…µæ¨¡å¼ï¼Œæˆ‘ç°åœ¨è®²ç»™ HR å¬éƒ½èƒ½å¬æ‡‚ã€‚â€</p>
<p>æˆ‘ç¬‘äº†åŠå¤©ã€‚</p>
<h2 data-id="heading-11">END</h2>
<p>å¦‚æœä½ éœ€è¦åœ¨ç®€çŸ­é¢è¯•é‡Œé€Ÿç­”ï¼Œå¯ä»¥ç”¨ä¸‹é¢è¿™æ®µè¯ï¼Œé€»è¾‘æ¸…æ™°ã€è¦ç‚¹é½å…¨ï¼š</p>
<blockquote>
<p>Redis å“¨å…µæ¨¡å¼æ˜¯ä¸€ç§å®ç° Redis é«˜å¯ç”¨çš„æœºåˆ¶ã€‚</p>
<p>å®ƒç”±å¤šä¸ª Sentinel èŠ‚ç‚¹ç»„æˆï¼Œè´Ÿè´£ç›‘æ§ master å’Œ slave çš„çŠ¶æ€ã€‚</p>
<p>ä¸€æ—¦ master è¿›å…¥å®¢è§‚ä¸‹çº¿çŠ¶æ€ï¼ŒSentinel ä¼šé€šè¿‡æŠ•ç¥¨é€‰ä¸¾ä¸€ä¸ªæœ€ä½³ slave ä½œä¸ºæ–° masterï¼Œå¹¶é€šçŸ¥å…¶ä»– slave é‡æ–°å¤åˆ¶å®ƒï¼Œä¹Ÿä¼šæŠŠæ–° master çš„ä¿¡æ¯é€šçŸ¥å®¢æˆ·ç«¯ã€‚</p>
<p><strong>Sentinel çš„æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š</strong> ç›‘æ§ã€æ•…éšœè½¬ç§»ã€é€šçŸ¥ã€‚</p>
<p>å®ƒè§£å†³äº† Redis å•ç‚¹æ•…éšœé—®é¢˜ï¼Œä½†ä»ç„¶åªæœ‰ä¸€ä¸ª masterï¼Œä¸æ”¯æŒåˆ†ç‰‡ï¼Œå› æ­¤å¯ç”¨æ€§ä¸å¦‚ Redis Clusterã€‚</p>
<p>Sentinel æ¨èéƒ¨ç½²å¥‡æ•°ä¸ªèŠ‚ç‚¹ï¼Œé€šè¿‡å¤šæ•°æ´¾é€‰ä¸¾é¿å…è¯¯åˆ¤ã€‚</p>
</blockquote>
<p>æˆ‘æ˜¯å°ç±³ï¼Œä¸€ä¸ªå–œæ¬¢åˆ†äº«æŠ€æœ¯çš„31å²ç¨‹åºå‘˜ã€‚å¦‚æœä½ å–œæ¬¢æˆ‘çš„æ–‡ç« ï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·â€œ<strong>è½¯ä»¶æ±‚ç”Ÿ</strong>â€ï¼Œè·å–æ›´å¤šæŠ€æœ¯å¹²è´§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•å®ç° Remote MCP-Server]]></title>    <link>https://juejin.cn/post/7574568258788851763</link>    <guid>https://juejin.cn/post/7574568258788851763</guid>    <pubDate>2025-11-20T02:15:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574568258788851763" data-draft-id="7574584245109948467" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•å®ç° Remote MCP-Server"/> <meta itemprop="keywords" content="å‰ç«¯,MCP,AIGC"/> <meta itemprop="datePublished" content="2025-11-20T02:15:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¢‹é¼ äº‘æ•°æ ˆUEDå›¢é˜Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/2137106333053912"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•å®ç° Remote MCP-Server
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2137106333053912/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¢‹é¼ äº‘æ•°æ ˆUEDå›¢é˜Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T02:15:56.000Z" title="Thu Nov 20 2025 02:15:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"â€¢";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><blockquote>
<p>æˆ‘ä»¬æ˜¯<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.dtstack.com%2Fued" target="_blank" title="https://www.dtstack.com/ued" ref="nofollow noopener noreferrer">è¢‹é¼ äº‘æ•°æ ˆ UED å›¢é˜Ÿ</a>ï¼Œè‡´åŠ›äºæ‰“é€ ä¼˜ç§€çš„ä¸€ç«™å¼æ•°æ®ä¸­å°äº§å“ã€‚æˆ‘ä»¬å§‹ç»ˆä¿æŒå·¥åŒ ç²¾ç¥ï¼Œæ¢ç´¢å‰ç«¯é“è·¯ï¼Œä¸ºç¤¾åŒºç§¯ç´¯å¹¶ä¼ æ’­ç»éªŒä»·å€¼ã€‚</p>
</blockquote>
<blockquote>
<p>æœ¬æ–‡ä½œè€…ï¼šä½³å²š</p>
</blockquote>
<h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>å¯¹äºå…¬å¸å†…éƒ¨çš„MCP-Server, ç”±äºéšç§æ€§é—®é¢˜ä¸èƒ½å‘å¸ƒä¸ºnpmåŒ…ï¼Œé‚£ä¹ˆå°±æ²¡æ³•ä»¥<code>npx</code>æˆ–è€…<code>uvx</code>ç­‰å½¢å¼å¿«é€Ÿçš„å…±äº«ä½¿ç”¨ã€‚æ‰€ä»¥åŸºæœ¬ä¼šä»¥STDIOç±»å‹çš„MCP-Serverè¿›è¡Œå¼€å‘ï¼Œåœ¨å†…éƒ¨è¿›è¡Œå…±äº«æ—¶åªèƒ½å°†å¯¹åº”æºæ–‡ä»¶æ‹‰å–æœ¬åœ°ä½¿ç”¨ã€‚</p>
<p>MCP-Serverå¸‚åœºä¸­å¿ƒèƒ½å¤Ÿæ•´åˆå†…éƒ¨å„å›¢é˜Ÿæˆ–ä¸ªäººå®ç°çš„MCP-Serverï¼Œæä¾›ç»Ÿä¸€çš„Streamable HTTPåè®®è®¿é—®ç«¯å£ï¼Œå¿«é€Ÿçš„æ•´åˆMCPèµ„æºã€‚</p>
<h2 data-id="heading-1">ç°æœ‰æ–¹æ¡ˆåˆ†æ</h2>
<p>MCP Marketæœ‰å¾ˆå¤šç½‘ç«™å·²ç»å®ç°ï¼Œä½†åŸºæœ¬åªèƒ½åšåˆ°èšåˆåŠŸèƒ½ï¼Œå³åªæä¾›æ£€ç´¢ä¸ä½¿ç”¨æ¦‚è§ˆç­‰åŸºæœ¬åŠŸèƒ½ï¼Œä½¿ç”¨æ—¶ä»éœ€è¦æœ¬åœ°å…‹éš†æˆ–è€… npx å®‰è£…è°ƒç”¨æˆ–è€…ä½¿ç”¨MCPæ³¨å†Œè€…è‡ªå·±æä¾›çš„HTTPè°ƒç”¨urlã€‚</p>
<h3 data-id="heading-2">MCPMarket</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmcpmarket.com%2Fzh%2Fserver" target="_blank" title="https://mcpmarket.com/zh/server" ref="nofollow noopener noreferrer">mcpmarket.com/zh/server</a></p>
<p>ä»…ä»…åšäº†æ£€ç´¢æ•´åˆ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/644f0a38eb90402094a3daf98dd5f508~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=8AQlsosiRWGMis1lKWliKnWC90Y%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">ç™¾ç‚¼-MCP</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbailian.console.aliyun.com%2F%3Fspm%3Da2c4g.11186623.0.0.462a2aa1vaybZI%26tab%3Dmcp%23%2Fmcp-market" target="_blank" title="https://bailian.console.aliyun.com/?spm=a2c4g.11186623.0.0.462a2aa1vaybZI&amp;tab=mcp#/mcp-market" ref="nofollow noopener noreferrer">bailian.console.aliyun.com/?spm=a2c4g.â€¦</a></p>
<p>å®ç°äº†MCPæœåŠ¡çš„ä¸€ä½“åŒ–æµç¨‹ï¼ŒåŒ…æ‹¬æ£€ç´¢ï¼Œéƒ¨ç½²ä¸ä¸€é”®é›†æˆ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e4499818287466ca5621f61dcc61d0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=Xi6DITmNw9TFCCaXVgFFdLRTGZY%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/849ca228b6a9443baaadcf552b30bf7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=Y08bmq3G%2BU4zqcl4SA8JBzzvzG0%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">Nacos-AI</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fnacos.io%2Fdocs%2Flatest%2Fmanual%2Fuser%2Fai%2Fmcp-auto-register%2F%3Fspm%3D5238cd80.75598bea.0.0.609e2c09jtluP3" target="_blank" title="https://nacos.io/docs/latest/manual/user/ai/mcp-auto-register/?spm=5238cd80.75598bea.0.0.609e2c09jtluP3" ref="nofollow noopener noreferrer">Nacos-AI</a></p>
<p>nacosæœ¬èº«æ˜¯ä¸€ä¸ªåŠ¨æ€æœåŠ¡æ³¨å†Œå‘ç°ä¸ç®¡ç†æ¡†æ¶ï¼Œæ–°ç‰ˆæœ¬æä¾›äº†Nacos MCP Routeræ¥ç®¡ç†æ‰€æœ‰MCP</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bbd11071acc34f7b9a6b32ebce791cbf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=KaOjwipDtehxyMfRK8aW9cuCJ7c%3D" alt="" loading="lazy"/></p>
<p>å…¶å†…éƒ¨å¯ä»¥å®ç°ä¸åŒåè®®ç±»å‹çš„ MCP æœåŠ¡å™¨è½¬åŒ–ä¸ºç»Ÿä¸€çš„ streamable-http ç±»å‹ï¼Œå®ƒæœ¬èº«æä¾›ä¸€ä¸ª nacos mcp æ¥ä¸å®¢æˆ·ç«¯äº¤äº’ï¼š</p>
<p>Nacos MCP Router æœ‰ä¸¤ç§å·¥ä½œæ¨¡å¼ï¼š</p>
<ol>
<li>routeræ¨¡å¼ï¼šé»˜è®¤æ¨¡å¼ï¼Œé€šè¿‡MCP Serveræ¨èã€å®‰è£…åŠä»£ç†å…¶ä»–MCP Serverçš„åŠŸèƒ½ï¼Œå¸®åŠ©ç”¨æˆ·æ›´æ–¹ä¾¿çš„ä½¿ç”¨MCP ServeræœåŠ¡ã€‚</li>
<li>proxyæ¨¡å¼ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡MODE=proxyæŒ‡å®šï¼Œé€šè¿‡ç®€å•é…ç½®å¯ä»¥æŠŠsseã€stdioåè®®MCP Serverè½¬æ¢ä¸ºstreamableHTTPåè®®MCP Serverã€‚</li>
</ol>
<p>åœ¨router æ¨¡å¼ä¸‹ï¼ŒNacos MCP Router ä½œä¸ºä¸€ä¸ªæ ‡å‡†MCP Serverï¼Œæä¾›MCP Serveræ¨èã€åˆ†å‘ã€å®‰è£…åŠä»£ç†å…¶ä»–MCP Serverçš„åŠŸèƒ½ã€‚å…¶ä¸»è¦å·¥å…·åˆ—è¡¨ä¸º</p>
<ol>
<li>search_mcp_server
<ul>
<li>æ ¹æ®ä»»åŠ¡æè¿°åŠå…³é”®å­—ä»MCPæ³¨å†Œä¸­å¿ƒï¼ˆNacosï¼‰ä¸­æœç´¢ç›¸å…³çš„MCP Serveråˆ—è¡¨</li>
<li>è¾“å…¥:
<ul>
<li><code>task_description</code>(string): ä»»åŠ¡æè¿°ï¼Œç¤ºä¾‹ï¼šä»Šå¤©æ­å·å¤©æ°”å¦‚ä½•</li>
<li><code>key_words</code>(string): ä»»åŠ¡å…³é”®å­—ï¼Œç¤ºä¾‹ï¼šå¤©æ°”ã€æ­å·</li>
</ul>
</li>
<li>è¾“å‡º: list of MCP servers and instructions to complete the task.</li>
</ul>
</li>
<li>add_mcp_server
<ul>
<li>æ·»åŠ å¹¶åˆå§‹åŒ–ä¸€ä¸ªMCP Serverï¼Œæ ¹æ®Nacosä¸­çš„é…ç½®ä¸è¯¥MCP Serverå»ºç«‹è¿æ¥ï¼Œç­‰å¾…è°ƒç”¨ã€‚</li>
<li>è¾“å…¥:
<ul>
<li><code>mcp_server_name</code>(string): éœ€è¦æ·»åŠ çš„MCP Serveråå­—</li>
</ul>
</li>
<li>è¾“å‡º: MCP Serverå·¥å…·åˆ—è¡¨åŠä½¿ç”¨æ–¹æ³•</li>
</ul>
</li>
<li>use_tool
<ul>
<li>ä»£ç†å…¶ä»–MCP Serverçš„å·¥å…·</li>
<li>è¾“å…¥:
<ul>
<li><code>mcp_server_name</code>(string): è¢«è°ƒçš„ç›®æ ‡MCP Serveråç§°.</li>
<li><code>mcp_tool_name</code>(string): è¢«è°ƒçš„ç›®æ ‡MCP Serverçš„å·¥å…·åç§°</li>
<li><code>params</code>(map): è¢«è°ƒçš„ç›®æ ‡MCP Serverçš„å·¥å…·çš„å‚æ•°</li>
</ul>
</li>
<li>è¾“å‡º: è¢«è°ƒçš„ç›®æ ‡MCP Serverçš„å·¥å…·çš„è¾“å‡ºç»“æœ</li>
</ul>
</li>
</ol>
<p>åœ¨proxy æ¨¡å¼ä¸‹ï¼ŒNacos MCP Router ä»…æä¾›ä»£ç†åŠŸèƒ½ï¼Œæ— éœ€ä»£ç æ”¹åŠ¨å³å¯å®ç°stdioã€sseåè®®ä¸€é”®è½¬æ¢ä¸ºstreamableHTTPåè®®ã€‚</p>
<h3 data-id="heading-5">higress AIç½‘å…³</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhigress.cn%2Fai%2Fmcp-quick-start%2F%3Fspm%3D36971b57.7beea2de.0.0.d85f20a9xwAfAn" target="_blank" title="https://higress.cn/ai/mcp-quick-start/?spm=36971b57.7beea2de.0.0.d85f20a9xwAfAn" ref="nofollow noopener noreferrer">higress AIç½‘å…³</a></p>
<p>ä»€ä¹ˆæ˜¯ AI ç½‘å…³ï¼Ÿ
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ee33b485a0c482e82027d4094db3eb2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=446jbf9JnIJKk5k%2FCoVzJoC0Zvw%3D" alt="" loading="lazy"/></p>
<p>ä½¿ç”¨AIç½‘å…³åšMCP Serverçš„ç»Ÿä¸€å…¥å£ä»£ç†</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/814d882d66534fd4959b7547815799a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=8Yw43SsvzbFdi56UFrNhfOIC9Ow%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92db1e64df4d4714be13b332e63b2c4a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=9ttQWtwxPKO5u%2BuHYaTdo2IyeCk%3D" alt="" loading="lazy"/></p>
<p>ä¼˜åŠ¿ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4962e507faeb4790b4f6bb09a1552757~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=qhW3vOKaGduMvldOztdH%2F%2FJ6q7M%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">è®¾è®¡æ¦‚è§ˆ</h2>
<h3 data-id="heading-7">å‰ç«¯è®¾è®¡</h3>
<p>é¡µé¢éœ€åŒ…å«ä»¥ä¸‹å‡ ä¸ªåŠŸèƒ½</p>
<ol>
<li>
<p>MCPå¸‚åœº - ç”¨äºæŸ¥è¯¢å·²æ³¨å†Œçš„MCPæœåŠ¡åˆ—è¡¨ï¼ŒåŒå¤§å¤šæ•°MCP Marketä¸€æ ·ï¼ŒåŒ…å«ä½¿ç”¨è¯´æ˜ï¼Œé…ç½®ï¼Œå·¥å…·åˆ—è¡¨ç­‰ä¿¡æ¯
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98e3ba323b904479b3094da1372a04ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=q8qLcIvT6vDolFf4Gj2qbBljV%2FI%3D" alt="" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/684f8db2cced48b69aefd0190e08f724~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=vt%2FaswH1GEkE6RsQ%2F4ZBdIpi8kk%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p>MCPæ³¨å†Œä¸­å¿ƒ  - å‘å¸ƒè‡ªå·±å®ç°çš„MCPï¼Œé’ˆå¯¹ Stdio ç±»å‹MCP Serverï¼Œæä¾›èµ„æºéƒ¨ç½²æœåŠ¡
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e081309a01e3487f94dc27cf74137e13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=cWTJ5iGss%2BO%2Bipip%2Bu%2F1TcuMAZ0%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p>MCPè°ƒè¯•æœåŠ¡  - ä½¿ç”¨ <code>@modelcontextprotocol/inspector</code>å®ç°
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/78d3b7e698ec483da607c472141f892e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=MOmu0PBODY0A6OnWi1itJ3ufFkY%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p>æœåŠ¡ç®¡ç†
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb101eb262be43cf94d06763b5947e49~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=wV4x94Z0tzpshnP90FiVojOAf3M%3D" alt="" loading="lazy"/></p>
</li>
</ol>
<h3 data-id="heading-8">åç«¯è®¾è®¡</h3>
<h4 data-id="heading-9">åè®®è½¬æ¢</h4>
<p>MCPåè®®å·²æœ‰ä¸‰ä¸ªç‰ˆæœ¬: 2024-11-05ã€2025-03-26ã€2025-06-18ã€‚</p>
<p>ä¸»è¦å·®å¼‚åœ¨äºåè®®é—´çš„å…¼å®¹ï¼Œ<code>2024-11-05</code>ç‰ˆæœ¬æä¾›äº†<code>Stdio</code>ä¸<code>SSE</code>ä¸¤ç§<code>transport</code>ç±»å‹ï¼Œ<code>2025-03-26</code>ä¹‹åçš„ç‰ˆæœ¬æä¾›äº†<code>Stdio</code>ä¸<code>Streamable HTTP</code>åè®®ã€‚</p>
<p><code>SSE</code>ç”±äºå…¶ä¼šä½¿ç”¨ä¸¤ä¸ªç«¯ç‚¹<code>/sse</code>ä¸<code>/messages</code>ä¸”ä¸€ç›´ä¼šå ç”¨é•¿è¿æ¥çš„ç¼˜æ•…å­˜åœ¨è®¾è®¡ç¼ºé™·ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬ä¸æ¨èä½¿ç”¨ã€‚</p>
<p>åŸºäºæ­¤ï¼Œæˆ‘ä»¬å®šä¹‰ä¸‰ç§åè®®çš„è½¬åŒ–è§„åˆ™ï¼š Stdio =&gt; HTTP , SSE =&gt; SSE, HTTP =&gt; HTTP</p>
<h5 data-id="heading-10">Stdioè½¬HTTP</h5>
<p>å¤§éƒ¨åˆ†æƒ…å†µä¸‹æˆ‘ä»¬ä¼šä»¥<code>Stdio</code>å½¢å¼å¼€å‘MCP Serverï¼Œå› ä¸ºå®ƒè¶³å¤Ÿç®€å•ï¼Œ<code>Stdio</code>transportæ˜¯ä»¥<strong>å­è¿›ç¨‹</strong>çš„æ–¹å¼å®ç° Client ä¸ Server ä¹‹é—´é€šä¿¡çš„ï¼Œå®ç°ä¸€å¯¹ä¸€çš„å…³ç³»ã€‚</p>
<p>ä¸€èˆ¬æœ‰ä¸¤ç§ä½¿ç”¨æ–¹å¼, åœ¨é…ç½®æ—¶ä½¿ç”¨ command æŒ‡å®šï¼š</p>
<ul>
<li>npx -y xxx</li>
<li>node ./xxx.js</li>
</ul>
<p>æˆ‘ä»¬åœ¨ä»»åŠ¡ç®¡ç†å™¨ä¸­å¯ä»¥çœ‹åˆ°æ‰€æœ‰é…ç½®çš„MCPéƒ½è¢«ä»¥å­è¿›ç¨‹çš„å½¢å¼å¯åŠ¨äº†
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ecb8c08654cf455781d71a0ccbd8431a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=jpUNUfwlqVulkgIVT0sUY5J2Twg%3D" alt="" loading="lazy"/></p>
<p>é—®ï¼š</p>
<p>å‡è®¾ä¸€ä¸ªMCPåªä¼šåœ¨å…¨å±€åˆ›å»ºä¸€ä¸ªè¿›ç¨‹ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘å¼€å¯ä¸¤ä¸ªCursorï¼ŒåŒæ—¶è°ƒç”¨åŒä¸€ä¸ªMCPï¼Œä¼šå¦‚ä½•ï¼Ÿ</p>
<p>å¦‚æœå°†å…¶è½¬ä¸ºHTTP, éœ€è¦åšåˆ°æ•°æ®éš”ç¦»ã€‚å› ä¸ºStdioClientTransportä¸è¿è¡ŒServerä»£ç çš„å­è¿›ç¨‹é—´æ˜¯é€šè¿‡äº‹ä»¶è®¢é˜…æ¥æ¥æ”¶æ¶ˆæ¯çš„ï¼Œ æ¥æ”¶åˆ°æ¶ˆæ¯æ—¶æˆ‘ä»¬éœ€è¦çŸ¥é“è¿™ä¸ªæ¶ˆæ¯è¯¥å›ä¼ ç»™å“ªä¸ªhttpè¯·æ±‚ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ¥æ”¶æ¶ˆæ¯</span>
process.<span class="hljs-property">stdout</span>?.<span class="hljs-title function_">on</span>(<span class="hljs-string">'data'</span>, <span class="hljs-function">(<span class="hljs-params">buffer</span>) =&gt;</span> {});
<span class="hljs-comment">// å‘é€è¯·æ±‚</span>
process.<span class="hljs-property">stdin</span>?.<span class="hljs-title function_">write</span>(msg)
</code></pre>
<p>ä¸ºäº†è§£å†³æ•°æ®éš”ç¦»é—®é¢˜ï¼Œç”¨ä¸¤ç§æ–¹å¼è§£å†³ï¼š</p>
<ol>
<li>
<p><strong>ç‹¬ç«‹child_process</strong><br/>
ä¸ºæ¯ä¸€ä¸ªhttpè¯·æ±‚ç‹¬ç«‹åˆ›å»ºå­è¿›ç¨‹ï¼Œæ¶ˆæ¯å“åº”å®Œå³é”€æ¯ï¼Œè™½èƒ½è§£å†³æ•°æ®éš”ç¦»é—®é¢˜ï¼Œä¸”æ¯ä¸ªè¯·æ±‚éƒ½èƒ½å®šä¹‰è‡ªå·±çš„envä¿¡æ¯ï¼Œä½†æ˜¯åœ¨20~30å¹¶å‘ä¸‹ï¼Œåˆ›å»ºå­è¿›ç¨‹çš„æ€§èƒ½æ¶ˆè€—ä¼šç¬é—´æ‰“æ»¡CPUã€‚</p>
</li>
<li>
<p><strong>å•ä½“child_process</strong><br/>
å•ä½“child_processå¯¹äºæ¯ä¸€ä¸ªMCP Serveråªä¼šåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œä¸”è¿›ç¨‹ä¼šéšå“†å•¦Aæ¢¦ä¸€èµ·å¯åŠ¨ã€‚</p>
</li>
</ol>
<p>ç”±äºä¸ç®¡æ˜¯å“ªç§ transportï¼Œéƒ½æ˜¯ä»¥ JSON-RPC åè®®è¿›è¡Œæ¶ˆæ¯å®šä¹‰ï¼ŒJSON-RPCå¯ä»¥æä¾› id å‚æ•°æ ‡è¯†è¯·æ±‚ï¼Œå¦‚æœè¯·æ±‚ä¸­æºå¸¦äº†idï¼Œé‚£ä¹ˆå“åº”çš„ JSON-RPC ä¹Ÿå¿…é¡»æºå¸¦åŒæ ·çš„idã€‚</p>
<p>clientåœ¨è¯·æ±‚æ—¶ä¼šè‡ªå·±ç”Ÿæˆä¸€ä¸ªidï¼Œä½†è¿™ä¸ªidæˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œå¦‚æœåŒæ—¶æœ‰å¤šä¸ªç”¨æˆ·åœ¨ client ç«¯å‘é€è¯·æ±‚ï¼Œå®ƒä»¬çš„idå¯èƒ½ä¼šä¸€æ ·ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªå”¯ä¸€çš„idï¼ŒåŒæ—¶ç»´æŠ¤å†…éƒ¨idä¸clientç”Ÿæˆçš„idçš„å…³ç³»ã€‚</p>
<p>åœ¨ä¸Serveré€šä¿¡æ—¶ï¼Œä½¿ç”¨å†…éƒ¨idä»¥ä¿è¯å”¯ä¸€ï¼Œå½“Serverè¿”å›æ•°æ®æ—¶ï¼Œå°†JSON-RPCå“åº”ä½“çš„å†…éƒ¨idæ›¿æ¢ä¸ºclient idä»¥æ­¤å®ç°æ•°æ®éš”ç¦»ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a33bf3b98053407db37e07a5c29d8313~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=fhyfh8G67qoFrgXPfatjs6T6xQo%3D" alt="" loading="lazy"/></p>
<h5 data-id="heading-11">SSE</h5>
<p>SSEé€šä¿¡æµç¨‹ï¼š</p>
<ol>
<li>SSE transportä¼šå¼€å¯ä¸¤ä¸ªç«¯ç‚¹ï¼Œé¦–å…ˆå®¢æˆ·ç«¯ä¼šå‘èµ·ä¸€ä¸ª<code>GET</code>è¯·æ±‚åˆ°<code>/sse</code>ç«¯ç‚¹ï¼Œå¯ä»¥ä¸æºå¸¦ä»»ä½•è¯·æ±‚å‚æ•°</li>
<li><code>/sse</code>ç«¯ç‚¹å¼€å¯ä¸€ä¸ªæµï¼Œå…ˆè¿”å›ä¸€ä¸ªæ¶ˆæ¯ç«¯ç‚¹<code>/messages</code>ä¸<code>sessionId</code>å¦‚ï¼š/messages?sessionId=xxx<br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed18179daa7b442292e2bd079baa7a95~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=Z4AwVoWd1ia%2Fjcb%2BuHlrvCFFVyg%3D" alt="" loading="lazy"/></li>
<li>å®¢æˆ·ç«¯å‘<code>/messages</code>ç«¯ç‚¹å‘èµ·å®é™…è¯·æ±‚ï¼Œå¦‚ initialize, tools/listï¼Œæ³¨æ„æ­¤æ—¶æœåŠ¡ç«¯ä¸ä¼šæŠŠæ•°æ®ç»“æœæ”¯æŒè¿”å›åˆ°<code>/messages</code>ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›202 Accept<br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f1c56ad2c3d425cb406e0e33a5e6b7a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=Kc7yEy7BgF8AFNJ4m2yV4EfR84U%3D" alt="" loading="lazy"/></li>
<li><code>/sse</code>ç«¯ç‚¹æ”¶åˆ°å“åº”ç»“æœ<br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a1e112ca4d9473bb82627ba321cf30f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=8cif4wNXjyyy5YLwJRlsCcx51bE%3D" alt="" loading="lazy"/></li>
<li>ç»§ç»­ä¸‹ä¸€è½®é€šä¿¡<br/>
å¯¹äºSSE,  æˆ‘ä»¬åœ¨Controllerå±‚åŒæ ·å¼€æ”¾ä¸¤ä¸ªç«¯ç‚¹</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript">app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/mcp-endpoint/:serverId/messages'</span>, app.<span class="hljs-property">controller</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">handleMCPEndpointPost</span>);
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/mcp-endpoint/:serverId/sse'</span>, app.<span class="hljs-property">controller</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">handleMCPEndpointGet</span>);
</code></pre>
<p>å¦‚æœå•çº¯çš„åšä»£ç†è½¬å‘ï¼Œé‚£ä¹ˆæ— æ³•åšåˆ°å¯¹<strong>æ¶ˆæ¯ç«¯ç‚¹</strong>çš„è½¬å‘ï¼Œå› ä¸ºæ¶ˆæ¯ç«¯ç‚¹æ˜¯MCP ServeråŠ¨æ€å®šä¹‰çš„ï¼Œå¯èƒ½ä¸æ˜¯<code>/messages</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨å“†å•¦Aæ¢¦å±‚åŠ¨æ€åˆ›å»º <code>SSEServerTransport</code> ã€‚</p>
<p><code>SSEServerTransport</code>çš„<code>endpoint</code>ä»…ä»…ç”¨æ¥æŒ‡å¼•å®¢æˆ·ç«¯æ¶ˆæ¯ä½“å¾€å“ªä¸ªAPIæ¥å£å‘é€, æ‰€ä»¥æˆ‘ä»¬åœ¨å“†å•¦Aæ¢¦åç«¯åˆ›å»ºçš„<code>endpoint</code>ä¸çœŸå®MCPæœåŠ¡å™¨è¿”å›çš„<code>endpoint</code>æ˜¯æ²¡æœ‰å…³ç³»ä¸å†²çªçš„ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> messageEndpoint = <span class="hljs-string">'http://localhost:7001/mcp-endpoint/'</span> + serverId + <span class="hljs-string">'/messages'</span>;

<span class="hljs-keyword">const</span> serverTransport = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SSEServerTransport</span>(messageEndpoint, res, {
    headers,
});
<span class="hljs-keyword">await</span> serverTransport.<span class="hljs-title function_">start</span>();
</code></pre>
<p>æˆ‘ä»¬åœ¨å“†å•¦Aæ¢¦åˆ›å»ºçš„<code>SSEServerTransport</code>èƒ½å¤Ÿå¸®æˆ‘ä»¬å¤„ç†å®¢æˆ·ç«¯å‘é€çš„SSEè¯·æ±‚å¹¶è‡ªåŠ¨å“åº”ï¼Œä½†æ˜¯æˆ‘ä»¬ç›®å‰æ²¡æœ‰ç»‘å®šä»»ä½•çš„MCP Server, å®ƒä»…æœ‰ä¸€ä¸ªæ¡¥æ¥çš„ä½œç”¨ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨å“†å•¦Aæ¢¦å±‚åˆ›å»ºä¸€ä¸ª<code>SSEClientTransport</code>, å°†æˆ‘ä»¬ä»çœŸå®å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯é€šè¿‡<code>SSEClientTransport</code>å†å‘é€ç»™çœŸå®MCPæœåŠ¡å™¨ã€‚</p>
<p><code>SSEClientTransport</code>ç›‘å¬<code>onmessage</code>è·å–çœŸå®MCPæœåŠ¡å™¨æ¶ˆæ¯ç»“æœåï¼Œå°†ç»“æœ send åˆ°æœ¬åœ°åˆ›å»ºçš„<code>SSEServerTransport</code>ï¼Œ<code>SSEServerTransport</code>å¤„ç†è¯·æ±‚å®Œæˆå“åº”ã€‚</p>
<p>GETè¯·æ±‚å¤„ç†å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * å¤„ç†GETè¯·æ±‚
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">serverId</span> - æœåŠ¡å™¨ID
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">any</span>} <span class="hljs-variable">req</span> - è¯·æ±‚æ•°æ®
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">object</span>} <span class="hljs-variable">res</span> - å“åº”æ•°æ®
 */</span>
<span class="hljs-keyword">async</span> <span class="hljs-title function_">handleGet</span>(<span class="hljs-params">serverId, req, res</span>) {
  <span class="hljs-keyword">const</span> sseProxy = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sseProxies</span>.<span class="hljs-title function_">get</span>(serverId);
  <span class="hljs-keyword">if</span> (!sseProxy) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`æœåŠ¡å™¨ <span class="hljs-subst">${serverId}</span> çš„SSEè¿æ¥æœªæ‰¾åˆ°`</span>);
  }

  <span class="hljs-keyword">let</span> transportToClientClosed = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">let</span> transportToServerClosed = <span class="hljs-literal">false</span>;

  <span class="hljs-keyword">const</span> headers = {
    ...req.<span class="hljs-property">headers</span>,
    ...sseProxy.<span class="hljs-property">headers</span>,
    <span class="hljs-attr">accept</span>: <span class="hljs-string">'text/event-stream'</span>,
  };

  <span class="hljs-keyword">const</span> clientTransport = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SSEClientTransport</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(sseProxy.<span class="hljs-property">url</span>), {
    headers,
  });
  <span class="hljs-keyword">await</span> clientTransport.<span class="hljs-title function_">start</span>();

  <span class="hljs-keyword">const</span> messageEndpoint = <span class="hljs-string">'http://localhost:7001/mcp-endpoint/'</span> + serverId + <span class="hljs-string">'/messages'</span>;
  <span class="hljs-keyword">const</span> serverTransport = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SSEServerTransport</span>(messageEndpoint, res, {
    headers,
  });
  <span class="hljs-keyword">await</span> serverTransport.<span class="hljs-title function_">start</span>();

  <span class="hljs-variable language_">this</span>.<span class="hljs-property">serverTransports</span>.<span class="hljs-title function_">set</span>(serverTransport.<span class="hljs-property">sessionId</span>, serverTransport);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">clientTransports</span>.<span class="hljs-title function_">set</span>(serverTransport.<span class="hljs-property">sessionId</span>, clientTransport);

  <span class="hljs-comment">// æ¡¥æ¥æ•°æ®äº¤æ¢</span>
  serverTransport.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> clientTransport.<span class="hljs-title function_">send</span>(message);
  clientTransport.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> serverTransport.<span class="hljs-title function_">send</span>(message);
  serverTransport.<span class="hljs-property">onclose</span> = <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (transportToServerClosed) {
      <span class="hljs-keyword">return</span>;
    }

    transportToClientClosed = <span class="hljs-literal">true</span>;
    clientTransport.<span class="hljs-title function_">close</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e));
  };
  clientTransport.<span class="hljs-property">onclose</span> = <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (transportToClientClosed) {
      <span class="hljs-keyword">return</span>;
    }
    transportToServerClosed = <span class="hljs-literal">true</span>;
    serverTransport.<span class="hljs-title function_">close</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e));
  };

}
</code></pre>
<p>POSTæ¶ˆæ¯è¯·æ±‚å¤„ç†å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * å¤„ç†POSTè¯·æ±‚
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">serverId</span> - æœåŠ¡å™¨ID
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">any</span>} <span class="hljs-variable">req</span> - è¯·æ±‚æ•°æ®
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">object</span>} <span class="hljs-variable">res</span> - å“åº”æ•°æ®
 */</span>
<span class="hljs-keyword">async</span> <span class="hljs-title function_">handlePost</span>(<span class="hljs-params">serverId, req, res</span>) {
  <span class="hljs-keyword">const</span> sseProxy = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sseProxies</span>.<span class="hljs-title function_">get</span>(serverId);
  <span class="hljs-keyword">if</span> (!sseProxy) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`æœåŠ¡å™¨ <span class="hljs-subst">${serverId}</span> çš„SSEè¿æ¥æœªæ‰¾åˆ°`</span>);
  }

  <span class="hljs-keyword">const</span> serverTransport = <span class="hljs-variable language_">this</span>.<span class="hljs-property">serverTransports</span>.<span class="hljs-title function_">get</span>(req.<span class="hljs-property">query</span>.<span class="hljs-property">sessionId</span>);

  <span class="hljs-keyword">if</span> (!serverTransport) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`session <span class="hljs-subst">${req.query.sessionId}</span> ä¸å­˜åœ¨`</span>);
  }

  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// ç”±äºEgg.jså·²ç»è§£æäº†è¯·æ±‚ä½“ï¼Œæˆ‘ä»¬éœ€è¦å°†è§£æå¥½çš„bodyä¼ é€’ç»™handlePostMessage</span>
    <span class="hljs-keyword">await</span> serverTransport.<span class="hljs-title function_">handlePostMessage</span>(req, res, req.<span class="hljs-property">body</span>);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`SSE POSTè¯·æ±‚å¤„ç†é”™è¯¯:`</span>, error);
    <span class="hljs-keyword">throw</span> error;
  }
}
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2eaa5847249c4991b0314a5777543af6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=07gJJ5I7jlP2SvJr2QSGk42lxhM%3D" alt="" loading="lazy"/></p>
<h5 data-id="heading-12">Streamable HTTP</h5>
<p>å¦‚æœæœ¬èº«å°±æ˜¯Streamable HTTPç±»å‹çš„ï¼Œæˆ‘ä»¬åªåšè¯·æ±‚çš„ä»£ç†ï¼Œå°†ç›®æ ‡æœåŠ¡å™¨æˆ–è€…æ‰˜ç®¡åœ¨å“†å•¦Aæ¢¦ä¸åŒç«¯å£ä¸Šçš„MCPæœåŠ¡ï¼Œç»Ÿä¸€é€šè¿‡å“†å•¦Aæ¢¦mcpç«¯ç‚¹è®¿é—®ã€‚</p>
<p>ä»£ç†å®ç°ä¸SSEç›¸ä¼¼ï¼Œæ­¤å¤„ç•¥ã€‚</p>
<p>ä½†æ³¨æ„Streamable HTTPä½¿ç”¨ä¸€ä¸ª<code>/mcp</code>ç«¯ç‚¹ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨3ç§æ–¹å¼è®¿é—®ï¼šPOSTã€GETã€DELETEã€‚</p>
<h4 data-id="heading-13">Stateless VS Statefulness</h4>
<p>Streamable HTTP MCPåœ¨å®šä¹‰æ—¶å­˜åœ¨æ— çŠ¶æ€ä¸æœ‰çŠ¶æ€æ¨¡å¼çš„åŒºåˆ†ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æœ‰çŠ¶æ€</span>
transport = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamableHTTPServerTransport</span>({
  <span class="hljs-attr">sessionIdGenerator</span>: <span class="hljs-function">() =&gt;</span> sessionId,
  <span class="hljs-attr">onsessioninitialized</span>: <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ–°ä¼šè¯åˆå§‹åŒ–: <span class="hljs-subst">${id}</span>`</span>);
  }
});

<span class="hljs-comment">// æ— çŠ¶æ€</span>
transport = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamableHTTPServerTransport</span>({
  <span class="hljs-attr">sessionIdGenerator</span>: <span class="hljs-literal">undefined</span>,
});
</code></pre>
<p>åœ¨æ— çŠ¶æ€æ¨¡å¼ä¸‹ï¼Œä¸ä¼šè¿”å›<code>MCP-Session-Id</code>å“åº”å¤´ï¼Œå®¢æˆ·ç«¯ä¹Ÿæ— æ³•è®¿é—®<code>GET</code>ä¸<code>DELETE</code>æ–¹æ³•ï¼Œå®¢æˆ·ç«¯ä¸éœ€è¦å…ˆè¡Œé€šè¿‡<code>initialize</code>è¿›è¡Œæ¡æ‰‹è¿æ¥ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ç›®æ ‡æ–¹æ³•ï¼Œç¼ºç‚¹å°±æ˜¯æœåŠ¡å™¨ç«¯æ²¡æ³•è¿›è¡Œå®æ—¶é€šçŸ¥ï¼Œå¦‚<code>ToolListChanged</code>ç­‰æ¶ˆæ¯ã€‚</p>
<p>Stdioæœ¬èº«æ˜¯ä»¥ä¸€å¯¹ä¸€è¿æ¥å­˜åœ¨çš„ï¼Œä¸”ä¼šé•¿æœŸç»´æŒå­è¿›ç¨‹çš„å­˜åœ¨ï¼Œæ‰€ä»¥å±äº<code>statefulness</code>è¿™ä¸€ç±», å½“è½¬åŒ–ä¸ºStreamable HTTPæ—¶ï¼Œéœ€è¦æˆ‘ä»¬è‡ªè¡Œç®¡ç†sessionï¼ˆå½“å‰æš‚æ—¶å¤„ç†ä¸ºstatelessï¼‰ï¼›</p>
<p>SSEè‚¯å®šæ˜¯ä»¥<code>Statefulness</code>å­˜åœ¨ï¼Œæˆ‘ä»¬ä¼šåœ¨åç«¯å­˜å‚¨ä»£ç†çš„sessionä¿¡æ¯ã€‚</p>
<p>Streamable HTTP æˆ‘ä»¬èµ°å®Œå…¨ä»£ç†æ¨¡å¼ï¼Œæ˜¯å¦éœ€è¦çŠ¶æ€ç”±ç›®æ ‡MCPæœåŠ¡å™¨å†³å®šã€‚</p>
<h3 data-id="heading-14">æ•°æ®åº“è®¾è®¡</h3>
<p>é‡‡ç”¨å•è¡¨è®¾è®¡ï¼Œä¸éœ€è¦é¢å¤–å…³è”è¡¨</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> `mcp_servers` (
    `id` <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="hljs-string">'è‡ªå¢ä¸»é”®'</span>,
    `server_id` <span class="hljs-type">varchar</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'æœåŠ¡å™¨å”¯ä¸€æ ‡è¯†/åç§°'</span>,
    `title` <span class="hljs-type">varchar</span>(<span class="hljs-number">200</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'æ˜¾ç¤ºæ ‡é¢˜'</span>,
    `description` text  COMMENT <span class="hljs-string">'æœåŠ¡å™¨æè¿°(æ”¯æŒMarkdown)'</span>,
    `author` <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'åˆ›å»ºè€…'</span>,
    `version` <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'ç‰ˆæœ¬å·'</span>,
    `tags` json COMMENT <span class="hljs-string">'æ ‡ç­¾æ•°ç»„'</span>,
    `transport` enum(<span class="hljs-string">'stdio'</span>, <span class="hljs-string">'sse'</span>, <span class="hljs-string">'streamable-http'</span>)  <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'stdio'</span> COMMENT <span class="hljs-string">'ä¼ è¾“åè®®ç±»å‹'</span>,
    `command` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>)  COMMENT <span class="hljs-string">'å¯åŠ¨å‘½ä»¤(stdioç±»å‹)'</span>,
    `args` json COMMENT <span class="hljs-string">'å‘½ä»¤å‚æ•°æ•°ç»„(stdioç±»å‹)'</span>,
    `env` json COMMENT <span class="hljs-string">'ç¯å¢ƒå˜é‡å¯¹è±¡(stdioç±»å‹)'</span>,
    `http_url` <span class="hljs-type">varchar</span>(<span class="hljs-number">500</span>)  COMMENT <span class="hljs-string">'HTTPè®¿é—®åœ°å€(httpç±»å‹)'</span>,
    `sse_url` <span class="hljs-type">varchar</span>(<span class="hljs-number">500</span>)  COMMENT <span class="hljs-string">'SSEè®¿é—®åœ°å€(sseç±»å‹)'</span>,
    `git_url` <span class="hljs-type">varchar</span>(<span class="hljs-number">500</span>)  COMMENT <span class="hljs-string">'Gitæºç åœ°å€'</span>,
    `deploy_path` <span class="hljs-type">varchar</span>(<span class="hljs-number">500</span>)  COMMENT <span class="hljs-string">'æ‰˜ç®¡éƒ¨ç½²è·¯å¾„'</span>,
    `status` tinyint <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'1'</span> COMMENT <span class="hljs-string">'æœåŠ¡å™¨çŠ¶æ€ 1-å¯ç”¨ 0-ç¦ç”¨'</span>,
    `is_delete` tinyint <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'0'</span> COMMENT <span class="hljs-string">'æ˜¯å¦åˆ é™¤ 1-å·²åˆ é™¤ 0-æœªåˆ é™¤'</span>,
    `use_count` <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'0'</span> COMMENT <span class="hljs-string">'ä½¿ç”¨æ¬¡æ•°'</span>,
    `tools` json COMMENT <span class="hljs-string">'å¯ç”¨å·¥å…·åˆ—è¡¨'</span>,
    `prompts` json COMMENT <span class="hljs-string">'å¯ç”¨æç¤ºè¯åˆ—è¡¨'</span>,
    `resources` json COMMENT <span class="hljs-string">'å¯ç”¨èµ„æºåˆ—è¡¨'</span>,
    `capabilities` json COMMENT <span class="hljs-string">'æœåŠ¡å™¨èƒ½åŠ›ä¿¡æ¯'</span>,
    `last_sync_at` datetime COMMENT <span class="hljs-string">'æœ€ååŒæ­¥æ—¶é—´'</span>,
    `runtime_status` enum(<span class="hljs-string">'running'</span>, <span class="hljs-string">'stopped'</span>, <span class="hljs-string">'error'</span>, <span class="hljs-string">'unknown'</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'unknown'</span> COMMENT <span class="hljs-string">'è¿è¡Œæ—¶çŠ¶æ€ running-è¿è¡Œä¸­ stopped-å·²åœæ­¢ error-é”™è¯¯ unknown-æœªçŸ¥'</span>,
    `last_ping_at` datetime COMMENT <span class="hljs-string">'æœ€åpingæ£€æŸ¥æ—¶é—´'</span>,
    `ping_error` text COMMENT <span class="hljs-string">'æœ€åpingæ£€æŸ¥é”™è¯¯ä¿¡æ¯'</span>,
    `created_at` datetime <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="hljs-string">'åˆ›å»ºæ—¶é—´'</span>,
    `updated_at` datetime <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="hljs-string">'æ›´æ–°æ—¶é—´'</span>,
    <span class="hljs-keyword">PRIMARY</span> KEY (`id`),
    <span class="hljs-keyword">UNIQUE</span> KEY `uk_server_id` (`server_id`),
  ) ENGINE <span class="hljs-operator">=</span> InnoDB AUTO_INCREMENT <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <span class="hljs-keyword">DEFAULT</span> CHARSET <span class="hljs-operator">=</span> utf8 <span class="hljs-keyword">COLLATE</span> <span class="hljs-operator">=</span> utf8_bin
</code></pre>
<h3 data-id="heading-15">æ§åˆ¶å±‚</h3>
<p>æ”¯æŒ SSE ä¸ Streamable HTTPç«¯ç‚¹</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * MCPä»£ç†ç«¯ç‚¹
 */</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/mcp-endpoint/:serverId/mcp'</span>, app.<span class="hljs-property">controller</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">handleMCPEndpointPost</span>);
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/mcp-endpoint/:serverId/mcp'</span>, app.<span class="hljs-property">controller</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">handleMCPEndpointGet</span>);
app.<span class="hljs-title function_">delete</span>(<span class="hljs-string">'/mcp-endpoint/:serverId/mcp'</span>, app.<span class="hljs-property">controller</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">handleMCPEndpointDelete</span>);


app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/mcp-endpoint/:serverId/messages'</span>, app.<span class="hljs-property">controller</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">handleMCPEndpointPost</span>);
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/mcp-endpoint/:serverId/sse'</span>, app.<span class="hljs-property">controller</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">handleMCPEndpointGet</span>);
</code></pre>
<h3 data-id="heading-16">æœåŠ¡å±‚</h3>
<h4 data-id="heading-17">MCPServiceå±‚</h4>
<p>MCPServiceå±‚åŒ…å«æ‰€æœ‰æ•°æ®åº“æ¨¡å‹æ“ä½œï¼Œä½†ä¸åŒ…å«å…·ä½“çš„MCPå¤„ç†ï¼Œå¦‚MCPå¯åŠ¨ï¼Œé‡å¯ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> mcpProxy = <span class="hljs-title class_">MCPProxy</span>.<span class="hljs-title function_">getInstance</span>();

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MCPController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Controller</span> {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">handleMCPEndpointGet</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">const</span> { ctx } = <span class="hljs-variable language_">this</span>;
      <span class="hljs-keyword">const</span> { serverId } = ctx.<span class="hljs-property">params</span>;
      <span class="hljs-keyword">await</span> mcpProxy.<span class="hljs-title function_">forwardRequest</span>(serverId, ctx.<span class="hljs-property">request</span>, ctx.<span class="hljs-property">response</span>);
      ctx.<span class="hljs-property">respond</span> = <span class="hljs-literal">false</span>;
  }
}
</code></pre>
<h4 data-id="heading-18">MCPProxyå±‚</h4>
<p>MCPProxyå±‚åŒ…å«ä»¥ä¸‹ç»„æˆ</p>
<ol>
<li>MCPProxy (æ ¸å¿ƒä»£ç†)<br/>
å•ä¾‹æ¨¡å¼ï¼Œç»Ÿä¸€ç®¡ç†æ‰€æœ‰MCPæœåŠ¡å™¨è¿æ¥<br/>
è·¯ç”±è¯·æ±‚åˆ°å¯¹åº”çš„ä¼ è¾“å¤„ç†å™¨<br/>
ç®¡ç†æœåŠ¡å™¨ç”Ÿå‘½å‘¨æœŸï¼ˆå¯åŠ¨/åœæ­¢/é‡å¯ï¼‰</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MCPProxy</span> {

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>){
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">requestManager</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MCPRequestManager</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">processManager</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MCPProcessManager</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stdioHandler</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StdioTransportHandler</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">processManager</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">requestManager</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sseHandler</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SSETransportHandler</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpHandler</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamableHttpTransportHandler</span>();
  }
  <span class="hljs-comment">// å•ä¾‹å®ç°</span>
  <span class="hljs-title function_">getInstance</span>()

  <span class="hljs-comment">// ç¼“å­˜MCP Serveré…ç½®ä¸forwardå…·ä½“çš„åè®®è½¬æ¢å¤„ç†</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">startProxy</span>(<span class="hljs-params">serverId, config</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// åœæ­¢å·²å­˜åœ¨çš„ä»£ç†</span>
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">stopProxy</span>(serverId);

      <span class="hljs-keyword">const</span> transport = config.<span class="hljs-property">transport</span> || { <span class="hljs-attr">type</span>: <span class="hljs-string">'stdio'</span> };
      <span class="hljs-keyword">let</span> handler;

      <span class="hljs-keyword">switch</span> (transport.<span class="hljs-property">type</span>) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'stdio'</span>:
          handler = <span class="hljs-variable language_">this</span>.<span class="hljs-property">stdioHandler</span>;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">'sse'</span>:
          handler = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sseHandler</span>;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">'streamable-http'</span>:
          handler = <span class="hljs-variable language_">this</span>.<span class="hljs-property">httpHandler</span>;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-attr">default</span>:
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`ä¸æ”¯æŒçš„ä¼ è¾“ç±»å‹: <span class="hljs-subst">${transport.type}</span>`</span>);
      }

      <span class="hljs-comment">// å¯åŠ¨ä¼ è¾“å¤„ç†å™¨</span>
      <span class="hljs-keyword">await</span> handler.<span class="hljs-title function_">start</span>(serverId, config);

      <span class="hljs-comment">// è®°å½•ä½¿ç”¨çš„å¤„ç†å™¨</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">transportHandlers</span>.<span class="hljs-title function_">set</span>(serverId, handler);

      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`MCPä»£ç†å·²å¯åŠ¨: <span class="hljs-subst">${serverId}</span> (<span class="hljs-subst">${transport.type}</span>)`</span>);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`å¯åŠ¨MCPä»£ç†å¤±è´¥ [<span class="hljs-subst">${serverId}</span>]:`</span>, error);
      <span class="hljs-keyword">throw</span> error;
    }
  }
}
</code></pre>
<ol start="2">
<li>
<p>MCPRequestManager (è¯·æ±‚ç®¡ç†å™¨)<br/>
ç®¡ç†å¾…å¤„ç†è¯·æ±‚é˜Ÿåˆ—<br/>
IDæ˜ å°„ç®¡ç†ï¼ˆå®¢æˆ·ç«¯ID â†” å†…éƒ¨IDï¼‰<br/>
è¯·æ±‚è¶…æ—¶å¤„ç†<br/>
å“åº”è·¯ç”±å›è°ƒ</p>
</li>
<li>
<p>MCPProcessManager (STDIO transportè¿›ç¨‹ç®¡ç†å™¨)<br/>
è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸç®¡ç†<br/>
è¿›ç¨‹é€šä¿¡ï¼ˆstdin/stdoutï¼‰<br/>
è¿›ç¨‹ç›‘æ§å’Œé”™è¯¯å¤„ç†<br/>
è¿›ç¨‹é‡å¯æœºåˆ¶</p>
</li>
<li>
<p>MCPSessionManager (ä¼šè¯ç®¡ç†å™¨)<br/>
SSEä¼šè¯ç”Ÿå‘½å‘¨æœŸç®¡ç†<br/>
ä¼šè¯è¶…æ—¶æ¸…ç†<br/>
åè®®ç‰ˆæœ¬ç®¡ç†<br/>
ä¼šè¯ç»Ÿè®¡</p>
</li>
<li>
<p>ä¼ è¾“å¤„ç†å™¨ (Transport Handlers æ ¸å¿ƒå¤„ç†)<br/>
æ•´ä¸ªåè®®è½¬æ¢ä¸å…·ä½“çš„å¤„ç†</p>
</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript">abstract <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseTransportHandler</span> {
    <span class="hljs-title function_">start</span>();
    <span class="hljs-title function_">stop</span>();
    <span class="hljs-comment">// ä¸ºMCPProxyæä¾›ç»Ÿä¸€çš„å…¥å£</span>
    <span class="hljs-title function_">forward</span>();
    <span class="hljs-title function_">handlePost</span>();
    <span class="hljs-title function_">handleGet</span>();
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">StdioTransportHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">BaseTransportHandler</span>{}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SSETransportHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">BaseTransportHandler</span>{}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">StreamableHttpTransportHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">BaseTransportHandler</span>{}
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/375d044f9bc947fdb9f4c7aabdef6914~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=EPD%2B%2FQxaz7hLViocY4SB1JW0NQ8%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-19">çŠ¶æ€ç›‘æ§</h3>
<p>MCP Serveræ³¨å†Œåæ˜¯å¦å¯ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ä½¿ç”¨ClientTransportå‘é€ä¸€ä¸ªpingè¯·æ±‚æ¥è¯†åˆ«ï¼Œæ•°æ®åº“ä¸­ä½¿ç”¨<code>status</code>ã€<code>last_ping_at</code>ã€<code>ping_error</code>ä¸‰ä¸ªå­—æ®µæ¥å­˜å‚¨ç›¸å…³ä¿¡æ¯ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io%2Fspecification%2F2025-06-18%2Fbasic%2Futilities%2Fping" target="_blank" title="https://modelcontextprotocol.io/specification/2025-06-18/basic/utilities/ping" ref="nofollow noopener noreferrer">modelcontextprotocol.io/specificatiâ€¦</a></p>
<p>å½“åœ¨æ³¨å†Œå®Œæˆã€ä¿®æ”¹ã€å¯åŠ¨ã€é‡å¯ç­‰æ“ä½œåï¼Œåº”ç«‹å³è°ƒç”¨ä¸€æ¬¡ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œåˆ›å»ºå®šæ—¶ä»»åŠ¡ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´å‘é€ä¸€æ¬¡pingè¯·æ±‚ã€‚</p>
<h3 data-id="heading-20">Inspectoré›†æˆ</h3>
<p>æä¾›ä¸€ä¸ªåœ¨çº¿è°ƒè¯•å·¥å…·å°¤ä¸ºé‡è¦ï¼Œé‚£å¿«é€Ÿçš„å¸®åŠ©ä½¿ç”¨è€…æˆ–è€…æœåŠ¡å™¨æ‹¥æœ‰è€…æ’æŸ¥é—®é¢˜ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub1s.com%2Fmodelcontextprotocol%2Finspector%2Ftree%2Fmain" target="_blank" title="https://github1s.com/modelcontextprotocol/inspector/tree/main" ref="nofollow noopener noreferrer">@modelcontextprotocal/inspector</a> æ˜¯ä¸€ä¸ªmcpå®˜æ–¹æä¾›çš„webç«¯è°ƒè¯•å·¥å…·<br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9a6c585825e2428a8b004f6e4010f391~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=cZEHbehhnOrZu82XXtDZlOIrBwk%3D" alt="" loading="lazy"/></p>
<p>å…¶å®ç°ä»£ç åˆ†ä¸ºå‰ç«¯é¡µé¢ä¸serverç«¯ï¼Œserverç«¯ç”¨äºè·ŸçœŸå®æœåŠ¡å™¨é€šä¿¡ã€‚</p>
<p>å‰ç«¯ä½¿ç”¨viteä¸radix-uiï¼Œåç«¯æœåŠ¡é‡‡ç”¨exporess</p>
<p>å¦‚æœè¦é›†æˆè¿›å“†å•¦Aæ¢¦ï¼Œè€ƒè™‘ä¸‰ç§æ–¹æ¡ˆï¼š</p>
<ol>
<li>å¾®æœåŠ¡ï¼Œå°†inspectorç›´æ¥æŒ‰æºç çº§è¿ç§»åˆ°å“†å•¦Aæ¢¦ä¸­å¹¶å¼€æ”¾ä¸¤ä¸ªæ–°ç«¯å£ï¼Œå“†å•¦Aæ¢¦å¯åŠ¨æ—¶è¿å¸¦å¯åŠ¨inspectorå‰åç«¯æœåŠ¡ï¼Œéœ€è¦è€ƒè™‘å¦‚ä½•å®ç°æ‰“åŒ…</li>
<li>åˆå¹¶è¿ç§»ï¼Œinspectorçš„ä»£ç å®ç°å¹¶ä¸å¤æ‚ï¼Œå¯ä»¥è€ƒè™‘ä¸ç°æœ‰å“†å•¦Aæ¢¦ä»£ç æ•´åˆåˆå¹¶</li>
<li>ç‹¬ç«‹æœåŠ¡ï¼Œå°†inspectorä»¥iframeçš„å½¢å¼åµŒå…¥å“†å•¦Aæ¢¦ï¼Œéœ€è¦åœ¨å“†å•¦Aæ¢¦æœåŠ¡å™¨ä¸Šå•ç‹¬å¯åŠ¨inspector, å‰²è£‚æ„Ÿå¾ˆé‡ã€‚</li>
</ol>
<h3 data-id="heading-21">ç¯å¢ƒè¦æ±‚</h3>
<p>@modelcontextprotocal/sdk è¦æ±‚ node ç‰ˆæœ¬v18ä»¥ä¸Šï¼Œå“†å•¦Aæ¢¦ engines.node è¦æ±‚&gt;=14 &amp; &lt;=16, ä½¿ç”¨ node &gt;=18å¯åŠ¨å“†å•¦Aæ¢¦éœ€è¦æ·»åŠ ç¯å¢ƒå˜é‡<code>NODE_OPTIONS=--openssl-legacy-provider &amp;&amp; egg-bin dev --daemon</code></p>
<h3 data-id="heading-22">å¤šè¿›ç¨‹é›†ç¾¤é€‚é…</h3>
<p>egg.jsåœ¨å¯åŠ¨æ—¶ä¼šé€šè¿‡ master è¿›ç¨‹å¸¦èµ·æ‰€æœ‰å…¶ä»–å­è¿›ç¨‹ï¼Œæ¯ä¸ªworkerç”¨æ¥æ‰§è¡Œæˆ‘ä»¬çš„å®é™…ä¸šåŠ¡ä»£ç ï¼ˆmvcæ¡†æ¶ï¼‰ï¼Œç±»ä¼¼äºnginxçš„è´Ÿè½½å‡è¡¡ï¼Œæ­¤å¤–è¿˜ä¼šåˆ›å»ºä¸€ä¸ª agent è¿›ç¨‹æ¥åšå•ç‹¬çš„æœåŠ¡ï¼Œå¦‚å®šæ—¶ä»»åŠ¡ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.eggjs.org%2Fzh-CN%2Fcore%2Fcluster-and-ipc%23agent-%25E6%259C%25BA%25E5%2588%25B6" target="_blank" title="https://www.eggjs.org/zh-CN/core/cluster-and-ipc#agent-%E6%9C%BA%E5%88%B6" ref="nofollow noopener noreferrer">cluster-and-ipc</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f81354edae9d4774ad25e542f9b8871e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKL6byg5LqR5pWw5qCIVUVE5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764209756&amp;x-signature=yE45fmBK65j%2FeOFGurOyFEbuXpY%3D" alt="" loading="lazy"/></p>
<p>ç”±äºdoraemonåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä¼šå¼€å¯å¤šè¿›ç¨‹é›†ç¾¤æ¥ä¼˜åŒ–æ€§èƒ½ï¼Œæ¯ä¸ªworkeréƒ½ä¼šé‡å¤å®ä¾‹åŒ–æˆ‘ä»¬è®¾è®¡çš„å•ä¾‹MCPProxyï¼Œå¯¼è‡´ä¸åŒworkeré—´çš„mcpç›¸å…³çŠ¶æ€ä¸ä¸€è‡´ï¼Œmcp-sessionçŠ¶æ€ä¹Ÿæ— æ³•å…±äº«ã€‚</p>
<p>æ‰€ä»¥éœ€è¦åœ¨ controller å’Œ service ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç§»é™¤æ‰€æœ‰ç›´æ¥å¯¹ MCPProxy çš„æ“ä½œï¼Œä¸ºç¡®ä¿å®ä¾‹å”¯ä¸€ä¸çŠ¶æ€åŒæ­¥ï¼Œå°†MCPåº•å±‚æœåŠ¡å…¨éƒ¨ç§»åˆ° agent è¿›ç¨‹ä¸­ã€‚</p>
<p>MCPProxyçš„ä¸»è¦åŠŸèƒ½æ˜¯è½¬å‘ MCP çš„ç›´æ¥è¯·æ±‚ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨ agent ä¸­å¼€å¯ä¸€ä¸ªç‹¬ç«‹çš„ http æœåŠ¡ï¼ˆä¸èƒ½åˆ©ç”¨Controllerï¼‰</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// agent.jsæ–‡ä»¶</span>

<span class="hljs-comment">// åˆå§‹åŒ–MCP HTTPå¤„ç†å™¨</span>
    <span class="hljs-keyword">const</span> mcpHttpHandler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MCPHttpHandler</span>(agent.<span class="hljs-property">logger</span>);
    <span class="hljs-keyword">let</span> httpServer = <span class="hljs-literal">null</span>;

    <span class="hljs-comment">// åˆ›å»ºHTTPæœåŠ¡ï¼ˆç”¨äºå¤„ç†MCPç«¯ç‚¹è¯·æ±‚ï¼‰</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">startHttpServer</span> = (<span class="hljs-params"/>) =&gt; {
        <span class="hljs-keyword">const</span> port = process.<span class="hljs-property">env</span>.<span class="hljs-property">MCP_AGENT_HTTP_PORT</span> || env.<span class="hljs-property">mcpAgentHttpPort</span> || <span class="hljs-number">7005</span>;

        httpServer = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-keyword">async</span> (req, res) =&gt; {
            <span class="hljs-keyword">await</span> mcpHttpHandler.<span class="hljs-title function_">handleRequest</span>(req, res);
        });

        httpServer.<span class="hljs-title function_">listen</span>(port, <span class="hljs-function">() =&gt;</span> {
            agent.<span class="hljs-property">logger</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Agent MCP HTTPæœåŠ¡å·²å¯åŠ¨ï¼Œç›‘å¬ç«¯å£: <span class="hljs-subst">${port}</span>`</span>);
        });

        httpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
            agent.<span class="hljs-property">logger</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Agent MCP HTTPæœåŠ¡é”™è¯¯:'</span>, error);
        });
    };
</code></pre>
<p>å…¶æ¬¡ MCPProxy è¿˜åŒ…å« MCP æœåŠ¡çš„å¯åœ, è€Œ MCP å¯åœçš„æ—¶æœºæ˜¯é€šè¿‡ worker ä¸­ service å±‚è°ƒç”¨çš„ï¼Œå› æ­¤è¿˜éœ€è¦é€šè¿‡IPCï¼ˆè¿›ç¨‹é—´é€šä¿¡ï¼‰çš„æ–¹å¼é€šçŸ¥ agentã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä¸€ä¸ªworkerçš„serviceä¸­</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">app</span>.<span class="hljs-property">messenger</span>.<span class="hljs-title function_">sendToAgent</span>(<span class="hljs-string">'mcpRestart'</span>, { serverId });


<span class="hljs-comment">// agent.js</span>
agent.<span class="hljs-property">messenger</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'mcpRestart'</span>, <span class="hljs-keyword">async</span> ({ serverId }) =&gt; {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> <span class="hljs-title class_">McpProxy</span>.<span class="hljs-title function_">getInstance</span>().<span class="hljs-title function_">restartProxy</span>(serverId);
        agent.<span class="hljs-property">logger</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`MCPæœåŠ¡å™¨é‡å¯æˆåŠŸ [<span class="hljs-subst">${serverId}</span>]`</span>);
    } <span class="hljs-keyword">catch</span> (error) {
        agent.<span class="hljs-property">logger</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`MCPæœåŠ¡å™¨é‡å¯å¤±è´¥ [<span class="hljs-subst">${serverId}</span>]:`</span>, error);
    }
});

</code></pre>
<h3 data-id="heading-23">MCP Serverä»£ç ç¼–å†™çº¦æŸ</h3>
<p>MCP Serverä¸­çš„<code>Server</code>ä¸<code>Transport</code>å’Œ<code>Client</code>æ˜¯ä¸€å¯¹ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯åŒæ—¶åªèƒ½ä¸€ä¸ªäººè®¿é—®ä½ çš„MCPæœåŠ¡ï¼Œè¿™å¯¹äºæˆ‘ä»¬å®ç°Remote-MCPçš„åˆè¡·æ˜¯ä¸ç¬¦åˆçš„ã€‚</p>
<p>å³ä½¿æ˜¯æ–°çš„ transport åè®® streamable-httpï¼Œä¹Ÿæ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œå½“æˆ‘ä»¬åœ¨ä¸€ä¸ªtabä¸­è°ƒç”¨åï¼Œåœ¨å¦ä¸€ä¸ªtabä¸­å†æ¬¡è¿æ¥è°ƒç”¨è¯·æ±‚ä¼šç›´æ¥å¡ä½ã€‚</p>
<p>å®˜æ–¹SDKæä¾›çš„ä½¿ç”¨æ¡ˆä¾‹ä¸­ç›®å‰å­˜åœ¨è¯¥é—®é¢˜, Serverå®šä¹‰åœ¨äº†å¤–éƒ¨ï¼Œå¯¼è‡´æ²¡æ³•å¯¹æ¯ä¸ªè¯·æ±‚åˆ†é…ç‹¬ç«‹çš„Transport<br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmodelcontextprotocol%2Ftypescript-sdk" target="_blank" title="https://github.com/modelcontextprotocol/typescript-sdk" ref="nofollow noopener noreferrer">modelcontextprotocol/typescript-sdk</a></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// Create an MCP server</span>
<span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> <span class="hljs-title class_">McpServer</span>({
    <span class="hljs-attr">name</span>: <span class="hljs-string">'demo-server'</span>,
    <span class="hljs-attr">version</span>: <span class="hljs-string">'1.0.0'</span>
});

<span class="hljs-comment">// Set up Express and HTTP transport</span>
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>());

app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/mcp'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
    <span class="hljs-comment">// Create a new transport for each request to prevent request ID collisions</span>
    <span class="hljs-keyword">const</span> transport = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamableHTTPServerTransport</span>({
        <span class="hljs-attr">sessionIdGenerator</span>: <span class="hljs-literal">undefined</span>,
        <span class="hljs-attr">enableJsonResponse</span>: <span class="hljs-literal">true</span>
    });

    res.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {
        transport.<span class="hljs-title function_">close</span>();
    });

    <span class="hljs-keyword">await</span> server.<span class="hljs-title function_">connect</span>(transport);
    <span class="hljs-keyword">await</span> transport.<span class="hljs-title function_">handleRequest</span>(req, res, req.<span class="hljs-property">body</span>);
});

<span class="hljs-keyword">const</span> port = <span class="hljs-built_in">parseInt</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> || <span class="hljs-string">'3000'</span>);
app.<span class="hljs-title function_">listen</span>(port, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Demo MCP Server running on http://localhost:<span class="hljs-subst">${port}</span>/mcp`</span>);
}).<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Server error:'</span>, error);
    process.<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
});
</code></pre>
<p>å› æ­¤ï¼Œé’ˆå¯¹ streamable-http ä¸ sse ç±»å‹ï¼Œéœ€è¦å°†Serverçš„åˆ›å»ºæ”¾åœ¨è¯·æ±‚å¤„ç†ä¸­ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æŠŠServerçš„å®šä¹‰ä»£ç å°è£…èµ·æ¥</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">createServer</span> = (<span class="hljs-params"/>) =&gt; { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">McpServer</span>() }

app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/mcp'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
    <span class="hljs-keyword">const</span> server = <span class="hljs-title function_">createServer</span>();
    <span class="hljs-comment">// Create a new transport for each request to prevent request ID collisions</span>
    <span class="hljs-keyword">const</span> transport = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamableHTTPServerTransport</span>({
        <span class="hljs-attr">sessionIdGenerator</span>: <span class="hljs-literal">undefined</span>,
        <span class="hljs-attr">enableJsonResponse</span>: <span class="hljs-literal">true</span>
    });

    res.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {
        transport.<span class="hljs-title function_">close</span>();
    });

    <span class="hljs-keyword">await</span> server.<span class="hljs-title function_">connect</span>(transport);
    <span class="hljs-keyword">await</span> transport.<span class="hljs-title function_">handleRequest</span>(req, res, req.<span class="hljs-property">body</span>);
});
</code></pre>
<h3 data-id="heading-24">Next</h3>
<ul>
<li>ä¸€é”®è½¬åŒ–APIè¯·æ±‚æ¥å£ =&gt; Streamable HTTP MCP</li>
<li>å¼¹æ€§å¯åŠ¨Stdioè¿›ç¨‹</li>
</ul>
<h2 data-id="heading-25">æœ€å</h2>
<p>æ¬¢è¿å…³æ³¨ã€è¢‹é¼ äº‘æ•°æ ˆUEDå›¢é˜Ÿã€‘~<br/>
è¢‹é¼ äº‘æ•°æ ˆ UED å›¢é˜ŸæŒç»­ä¸ºå¹¿å¤§å¼€å‘è€…åˆ†äº«æŠ€æœ¯æˆæœï¼Œç›¸ç»§å‚ä¸å¼€æºäº†æ¬¢è¿ star</p>
<ul>
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fdtstack.github.io%2FTaier%2F" target="_blank" title="https://dtstack.github.io/Taier/" ref="nofollow noopener noreferrer">å¤§æ•°æ®åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿâ€”â€”Taier</a></strong></li>
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fdtstack.github.io%2Fmolecule%2F" target="_blank" title="https://dtstack.github.io/molecule/" ref="nofollow noopener noreferrer">è½»é‡çº§çš„ Web IDE UI æ¡†æ¶â€”â€”Molecule</a></strong></li>
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fdtstack.github.io%2Fmonaco-sql-languages%2F" target="_blank" title="https://dtstack.github.io/monaco-sql-languages/" ref="nofollow noopener noreferrer">é’ˆå¯¹å¤§æ•°æ®é¢†åŸŸçš„ SQL Parser é¡¹ç›®â€”â€”dt-sql-parser</a></strong></li>
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FDTStack%2Fcode-review-practices" target="_blank" title="https://github.com/DTStack/code-review-practices" ref="nofollow noopener noreferrer">è¢‹é¼ äº‘æ•°æ ˆå‰ç«¯å›¢é˜Ÿä»£ç è¯„å®¡å·¥ç¨‹å®è·µæ–‡æ¡£â€”â€”code-review-practices</a></strong></li>
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FDTStack%2Fko" target="_blank" title="https://github.com/DTStack/ko" ref="nofollow noopener noreferrer">ä¸€ä¸ªé€Ÿåº¦æ›´å¿«ã€é…ç½®æ›´çµæ´»ã€ä½¿ç”¨æ›´ç®€å•çš„æ¨¡å—æ‰“åŒ…å™¨â€”â€”ko</a></strong></li>
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FDTStack%2Fant-design-testing" target="_blank" title="https://github.com/DTStack/ant-design-testing" ref="nofollow noopener noreferrer">ä¸€ä¸ªé’ˆå¯¹ antd çš„ç»„ä»¶æµ‹è¯•å·¥å…·åº“â€”â€”ant-design-testing</a></strong></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¹´è½»äººçš„ç¬¬ä¸€ä¸ª GO æ¡Œé¢åº”ç”¨ï¼šç”¨ Wails åšä¸ªå­¦ä¹ æ­å­è®¡æ—¶å™¨]]></title>    <link>https://juejin.cn/post/7574318108719530030</link>    <guid>https://juejin.cn/post/7574318108719530030</guid>    <pubDate>2025-11-20T01:03:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574318108719530030" data-draft-id="7574271557939724339" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¹´è½»äººçš„ç¬¬ä¸€ä¸ª GO æ¡Œé¢åº”ç”¨ï¼šç”¨ Wails åšä¸ªå­¦ä¹ æ­å­è®¡æ—¶å™¨"/> <meta itemprop="keywords" content="Go"/> <meta itemprop="datePublished" content="2025-11-20T01:03:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Schuyler2025"/> <meta itemprop="url" content="https://juejin.cn/user/605198468525913"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¹´è½»äººçš„ç¬¬ä¸€ä¸ª GO æ¡Œé¢åº”ç”¨ï¼šç”¨ Wails åšä¸ªå­¦ä¹ æ­å­è®¡æ—¶å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/605198468525913/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Schuyler2025
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T01:03:38.000Z" title="Thu Nov 20 2025 01:03:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å‘Šåˆ«æ§åˆ¶å°åº”ç”¨ï¼Œç”¨Goè¯­è¨€æ‰“é€ ä½ çš„ç¬¬ä¸€ä¸ªæ¡Œé¢è½¯ä»¶</p>
</blockquote>
<h2 data-id="heading-0">ğŸ¯ ç—›ç‚¹åœºæ™¯ï¼šä¸ºä»€ä¹ˆéœ€è¦æ¡Œé¢åº”ç”¨å¼€å‘æŠ€èƒ½ï¼Ÿ</h2>
<p><strong>ä½ æ˜¯å¦é‡åˆ°è¿™äº›é—®é¢˜ï¼Ÿ</strong></p>
<ul>
<li>å­¦äº†Goè¯­è¨€ï¼Œå´åªä¼šå†™å‘½ä»¤è¡Œå·¥å…·ï¼Ÿ</li>
<li>æƒ³å­¦æ¡Œé¢å¼€å‘ï¼Œå´è§‰å¾—C++/C#å¤ªå¤æ‚ï¼Ÿ</li>
<li>é¢è¯•å®˜å¯¹ä½ çš„â€œçƒ‚å¤§è¡—â€é¡¹ç›®ä¸æ„Ÿå…´è¶£ï¼Ÿ</li>
</ul>
<p><strong>ä½ èƒ½å­¦åˆ°ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li>âœ…ï¸ Wails åŸºç¡€ä½¿ç”¨</li>
<li>âœ…ï¸ å®æ—¶äº‹ä»¶é€šä¿¡</li>
<li>âœ…ï¸ ç³»ç»Ÿæ‰˜ç›˜é›†æˆ</li>
<li>âœ…ï¸ å¤šçº¿ç¨‹ç¼–ç¨‹</li>
<li>âœ…ï¸ é™„å®Œæ•´æºç </li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6504bca8c83743ecac275e1ada22919c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2NodXlsZXIyMDI1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764205417&amp;x-signature=GuUxO4PrH5yynuUMBaK5FvMyVqg%3D" alt="æµ‹è¯•æ•ˆæœ.gif" loading="lazy"/></p>
<h2 data-id="heading-1">ğŸ› ï¸ ç¯å¢ƒå‡†å¤‡</h2>
<h3 data-id="heading-2">æ­¥éª¤1ï¼šå®‰è£…Goè¯­è¨€</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…ï¼šhttps://golang.org/dl/</span>
go version  <span class="hljs-comment"># éªŒè¯å®‰è£…</span>
</code></pre>
<h3 data-id="heading-3">æ­¥éª¤2ï¼šå®‰è£…Wailsæ¡†æ¶</h3>
<pre><code class="hljs language-bash" lang="bash">go install github.com/wailsapp/wails/v2/cmd/wails@latest
wails version  <span class="hljs-comment"># éªŒè¯å®‰è£…</span>
</code></pre>
<h3 data-id="heading-4">æ­¥éª¤3ï¼šåˆ›å»ºé¡¹ç›®éª¨æ¶</h3>
<pre><code class="hljs language-bash" lang="bash">wails init -n Punktime
<span class="hljs-built_in">cd</span> Punktime
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37b3a9978a6b4b7fb90ce1dea8bd1376~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2NodXlsZXIyMDI1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764205417&amp;x-signature=1GrCkiFWVTYEnYETfPVP5dIYc6k%3D" alt="wailsinit.jpg" loading="lazy"/></p>
<h2 data-id="heading-5">ğŸš€ æ ¸å¿ƒåŠŸèƒ½å¼€å‘</h2>
<h3 data-id="heading-6">è®¾è®¡ UI ï¼ˆå‰ç«¯ï¼‰</h3>
<ul>
<li>
<p>ä½¿ç”¨ HTML/CSS/JavaScriptå®ç°ï¼š</p>
<ul>
<li>æ—¶é—´/å€’è®¡æ—¶ä¸»ç•Œé¢</li>
<li>å€’è®¡æ—¶è®¾ç½®é®ç½©å±‚</li>
</ul>
</li>
<li>
<p>ç¤ºä¾‹ä»£ç </p>
</li>
</ul>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- ============================================================================
     * ä¸»ç•Œé¢ç»“æ„
     * åº”ç”¨ç¨‹åºçš„ä¸»è¦æ˜¾ç¤ºåŒºåŸŸ
     * ============================================================================ --&gt;</span>

    <span class="hljs-comment">&lt;!-- ä¸»å®¹å™¨ï¼šæ˜¾ç¤ºå€’è®¡æ—¶/æ—¶é—´ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"countdown"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"countdown"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ============================================================================
     * å€’è®¡æ—¶è¾“å…¥æ¡†æ¨¡æ€å¯¹è¯æ¡†
     * ç”¨äºè®¾ç½®å€’è®¡æ—¶æ—¶é•¿çš„å¼¹å‡ºçª—å£
     * ============================================================================ --&gt;</span>

    <span class="hljs-comment">&lt;!-- å€’è®¡æ—¶è¾“å…¥æ¡†é®ç½©å±‚ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">id</span>=<span class="hljs-string">"countdownInputOverlay"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"countdown-input-overlay"</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">"display: none"</span>
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"countdown-input-container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"countdown-input-title"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-comment">&lt;!-- åˆ†é’Ÿè¾“å…¥æ¡† --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"minutesInput"</span>
            <span class="hljs-attr">class</span>=<span class="hljs-string">"countdown-input"</span>
            <span class="hljs-attr">min</span>=<span class="hljs-string">"0"</span>
            <span class="hljs-attr">max</span>=<span class="hljs-string">"59"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">"25"</span>
            <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"åˆ†"</span>
          /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color: lightgreen"</span>&gt;</span>:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-comment">&lt;!-- ç§’æ•°è¾“å…¥æ¡† --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"secondsInput"</span>
            <span class="hljs-attr">class</span>=<span class="hljs-string">"countdown-input"</span>
            <span class="hljs-attr">min</span>=<span class="hljs-string">"0"</span>
            <span class="hljs-attr">max</span>=<span class="hljs-string">"59"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">"0"</span>
            <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"ç§’"</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"countdown-input-buttons"</span>&gt;</span>
          <span class="hljs-comment">&lt;!-- ç¡®è®¤æŒ‰é’® --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"confirmCountdown"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"countdown-input-button"</span>&gt;</span>
            ç¡®å®š
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-comment">&lt;!-- å–æ¶ˆæŒ‰é’® --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"cancelCountdown"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"countdown-input-button"</span>&gt;</span>
            å–æ¶ˆ
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<h3 data-id="heading-7">å®ç°è®¡æ—¶é€»è¾‘ï¼ˆGoåç«¯ï¼‰</h3>
<ul>
<li>æ ¸å¿ƒä»£ç </li>
</ul>
<pre><code class="hljs language-Go" lang="Go"><span class="hljs-comment">/**
 * @description: è®¡æ—¶å™¨æ›´æ–°å¾ªç¯ï¼Œæ¯ç§’æ‰§è¡Œä¸€æ¬¡çš„æ—¶é—´/å€’è®¡æ—¶æ›´æ–°é€»è¾‘
 * å‡½æ•°ä½œä¸ºè®¡æ—¶å™¨ç®¡ç†å™¨çš„æ ¸å¿ƒå¾ªç¯ï¼Œè´Ÿè´£ï¼š
 * 1. æ¯ç§’æ›´æ–°è®¡æ—¶å™¨çŠ¶æ€å’Œæ˜¾ç¤ºå†…å®¹
 * 2. æ ¹æ®å½“å‰æ˜¾ç¤ºæ¨¡å¼ï¼ˆå€’è®¡æ—¶/æ—¶é—´ï¼‰æ‰§è¡Œä¸åŒçš„æ›´æ–°é€»è¾‘
 * 3. å¤„ç†å€’è®¡æ—¶ç»“æŸäº‹ä»¶å’ŒçŠ¶æ€è½¬æ¢
 * 4. é€šè¿‡Wailsäº‹ä»¶ç³»ç»Ÿå‘å‰ç«¯å‘é€æ›´æ–°æ•°æ®
 *
 * å€’è®¡æ—¶æ¨¡å¼é€»è¾‘ï¼š
 * - è¿è¡Œä¸­ï¼šè®¡ç®—å‰©ä½™æ—¶é—´ï¼Œå€’è®¡æ—¶ç»“æŸæ—¶è§¦å‘timerEndäº‹ä»¶
 * - æš‚åœä¸­ï¼šæ˜¾ç¤ºæš‚åœæ—¶çš„å‰©ä½™æ—¶é—´
 * - æœªå¼€å§‹ï¼šæ˜¾ç¤ºè®¾ç½®çš„å€’è®¡æ—¶æ€»æ—¶é•¿
 *
 * æ—¶é—´æ¨¡å¼é€»è¾‘ï¼š
 * - æ˜¾ç¤ºå½“å‰ç³»ç»Ÿæ—¶é—´ï¼ˆMM:SSæ ¼å¼ï¼‰
 *
 * @example
 * // æ¯ç§’è‡ªåŠ¨æ‰§è¡Œï¼Œæ— éœ€æ‰‹åŠ¨è°ƒç”¨
 * // å€’è®¡æ—¶æ¨¡å¼ï¼šæ˜¾ç¤º"25:00" â†’ "24:59" â†’ ... â†’ "00:00"ï¼ˆè§¦å‘ç»“æŸäº‹ä»¶ï¼‰
 * // æ—¶é—´æ¨¡å¼ï¼šæ˜¾ç¤ºå½“å‰æ—¶é—´å¦‚"14:30"
 *
 * @see runtime.EventsEmit å‘é€äº‹ä»¶åˆ°å‰ç«¯
 * @see time.Since è®¡ç®—æ—¶é—´é—´éš”
 *
 * @note ä½¿ç”¨äº’æ–¥é”ç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼Œé¿å…å¹¶å‘è®¿é—®è®¡æ—¶å™¨çŠ¶æ€
 * @note å€’è®¡æ—¶ç»“æŸæ—¶è‡ªåŠ¨é‡ç½®çŠ¶æ€å¹¶å‘é€ç»“æŸäº‹ä»¶
 * @note æ—¶é—´æ ¼å¼ç»Ÿä¸€ä¸ºä¸¤ä½æ•°ï¼ˆå¦‚"05:09"è€Œé"5:9"ï¼‰
 */</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(tm *TimerManager)</span></span> updateLoop() {
    <span class="hljs-keyword">for</span> <span class="hljs-keyword">range</span> tm.ticker.C {
        tm.mu.Lock()
        <span class="hljs-keyword">if</span> tm.isTimerRunning {
                tm.timerElapsed = time.Since(tm.timerStartTime)
        }
        <span class="hljs-keyword">switch</span> tm.displayMode {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"countdown"</span>:
                <span class="hljs-keyword">if</span> tm.isTimerRunning {
                        remaining := tm.countdownDuration - tm.timerElapsed
                        <span class="hljs-keyword">if</span> remaining &lt;= <span class="hljs-number">0</span> {
                                remaining = <span class="hljs-number">0</span>
                                tm.isTimerRunning = <span class="hljs-literal">true</span>
                                tm.timerElapsed = tm.countdownDuration
                                tm.isPaused = <span class="hljs-literal">false</span>
                                runtime.EventsEmit(tm.ctx, <span class="hljs-string">"timerEnd"</span>)

                                timerText := <span class="hljs-string">"00:00"</span>
                                runtime.EventsEmit(tm.ctx, <span class="hljs-string">"timerUpdate"</span>, timerText)
                        } <span class="hljs-keyword">else</span> {
                                minutes := <span class="hljs-type">int</span>(remaining.Minutes())
                                seconds := <span class="hljs-type">int</span>(remaining.Seconds()) % <span class="hljs-number">60</span>
                                timerText := fmt.Sprintf(<span class="hljs-string">"%02d:%02d"</span>, minutes, seconds)
                                runtime.EventsEmit(tm.ctx, <span class="hljs-string">"timerUpdate"</span>, timerText)
                        }

                } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">if</span> tm.isPaused {
                                remaining := tm.countdownDuration - tm.timerElapsed
                                <span class="hljs-keyword">if</span> remaining &lt; <span class="hljs-number">0</span> {
                                        remaining = <span class="hljs-number">0</span>
                                }
                                minutes := <span class="hljs-type">int</span>(remaining.Minutes())
                                seconds := <span class="hljs-type">int</span>(remaining.Seconds()) % <span class="hljs-number">60</span>
                                timerText := fmt.Sprintf(<span class="hljs-string">"%02d:%02d"</span>, minutes, seconds)
                                runtime.EventsEmit(tm.ctx, <span class="hljs-string">"timerUpdate"</span>, timerText)
                        } <span class="hljs-keyword">else</span> {
                                minutes := <span class="hljs-type">int</span>(tm.countdownDuration.Minutes())
                                seconds := <span class="hljs-type">int</span>(tm.countdownDuration.Seconds()) % <span class="hljs-number">60</span>
                                timerText := fmt.Sprintf(<span class="hljs-string">"%02d:%02d"</span>, minutes, seconds)
                                runtime.EventsEmit(tm.ctx, <span class="hljs-string">"timerUpdate"</span>, timerText)
                        }
                }

        <span class="hljs-keyword">case</span> <span class="hljs-string">"time"</span>:
                currentTime := time.Now().Format(<span class="hljs-string">"15:04"</span>)
                runtime.EventsEmit(tm.ctx, <span class="hljs-string">"timeUpdate"</span>, currentTime)

        }
        tm.mu.Unlock()
}
}
</code></pre>
<ul>
<li>å‰åç«¯é€šä¿¡
<ul>
<li>å‰ç«¯è´Ÿè´£ç›‘å¬æ›´æ–°äº‹ä»¶å¹¶æ¸²æŸ“</li>
<li>åç«¯è´Ÿè´£è§¦å‘æ›´æ–°äº‹ä»¶å¹¶å‘é€æ•°æ®</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-js" lang="js"> <span class="hljs-comment">// ç›‘å¬å€’è®¡æ—¶æ›´æ–°äº‹ä»¶</span>
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">runtime</span>.<span class="hljs-title class_">EventsOn</span>(<span class="hljs-string">"timerUpdate"</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"countdown"</span>).<span class="hljs-property">textContent</span> = data;
  });
  <span class="hljs-comment">// ç›‘å¬æ—¶é—´æ˜¾ç¤ºæ›´æ–°äº‹ä»¶</span>
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">runtime</span>.<span class="hljs-title class_">EventsOn</span>(<span class="hljs-string">"timeUpdate"</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"countdown"</span>).<span class="hljs-property">textContent</span> = data;
  });
</code></pre>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">if</span> tm.isTimerRunning {
    remaining := tm.countdownDuration - tm.timerElapsed
    <span class="hljs-keyword">if</span> remaining &lt;= <span class="hljs-number">0</span> {
            remaining = <span class="hljs-number">0</span>
            tm.isTimerRunning = <span class="hljs-literal">true</span>
            tm.timerElapsed = tm.countdownDuration
            tm.isPaused = <span class="hljs-literal">false</span>
            runtime.EventsEmit(tm.ctx, <span class="hljs-string">"timerEnd"</span>)

            timerText := <span class="hljs-string">"00:00"</span>
            <span class="hljs-comment">// å‘é€äº‹ä»¶æ˜¾ç¤ºæ›´æ–°äº‹ä»¶</span>
            runtime.EventsEmit(tm.ctx, <span class="hljs-string">"timerUpdate"</span>, timerText)
    } <span class="hljs-keyword">else</span> {
            minutes := <span class="hljs-type">int</span>(remaining.Minutes())
            seconds := <span class="hljs-type">int</span>(remaining.Seconds()) % <span class="hljs-number">60</span>
            timerText := fmt.Sprintf(<span class="hljs-string">"%02d:%02d"</span>, minutes, seconds)
            <span class="hljs-comment">// å‘é€äº‹ä»¶æ˜¾ç¤ºæ›´æ–°äº‹ä»¶</span>
            runtime.EventsEmit(tm.ctx, <span class="hljs-string">"timerUpdate"</span>, timerText)
    }
</code></pre>
<h2 data-id="heading-8">ğŸ“¦ï¸ æ‰“åŒ…å‘å¸ƒ</h2>
<pre><code class="hljs language-bash" lang="bash">wails build
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/117292d95bd142ceab2eab7283dc7e34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2NodXlsZXIyMDI1:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764205417&amp;x-signature=%2FjvBQi75wyRssJOieuFuJ84b2iY%3D" alt="ç»“å°¾.jpg" loading="lazy"/></p>
<h2 data-id="heading-9">ğŸ“– å­¦ä¹ èµ„æº</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwails.io%2Fzh-Hans%2Fdocs%2Fintroduction" target="_blank" title="https://wails.io/zh-Hans/docs/introduction" ref="nofollow noopener noreferrer">Wailså®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgobyexample.com%2F" target="_blank" title="https://gobyexample.com/" ref="nofollow noopener noreferrer">Goè¯­è¨€å®æˆ˜æ•™ç¨‹</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSchuyler2025%2FPunktime" target="_blank" title="https://github.com/Schuyler2025/Punktime" ref="nofollow noopener noreferrer">æœ¬é¡¹ç›®å®Œæ•´ä»£ç </a></li>
</ul>
<blockquote>
<p>ğŸ‘‹ä½ è¿˜å¸Œæœ›æœ‰å“ªäº›å­¦ä¹ æ­å­ï¼Ÿæ¬¢è¿ç•™è¨€ï¼</p>
<p>â¤ï¸å¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œåˆ«å¿˜äº†ç‚¹èµ + å…³æ³¨ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€URPã€‘Unity[RendererFeatures]æ¸²æŸ“å¯¹è±¡RenderObjects]]></title>    <link>https://juejin.cn/post/7574568258788720691</link>    <guid>https://juejin.cn/post/7574568258788720691</guid>    <pubDate>2025-11-20T02:02:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574568258788720691" data-draft-id="7574318108720169006" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€URPã€‘Unity[RendererFeatures]æ¸²æŸ“å¯¹è±¡RenderObjects"/> <meta itemprop="keywords" content="æ¸¸æˆå¼€å‘,Unity3D,å›¾å½¢å­¦"/> <meta itemprop="datePublished" content="2025-11-20T02:02:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SmalBox"/> <meta itemprop="url" content="https://juejin.cn/user/2218166695237532"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€URPã€‘Unity[RendererFeatures]æ¸²æŸ“å¯¹è±¡RenderObjects
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2218166695237532/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SmalBox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T02:02:51.000Z" title="Thu Nov 20 2025 02:02:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13021255.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13021255%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13021255&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong></p>
</blockquote>
<h2 data-id="heading-0"><strong>RenderObjectsçš„å®šä¹‰ä¸ä½œç”¨</strong></h2>
<p>RenderObjectsæ˜¯URPæä¾›çš„RendererFeatureä¹‹ä¸€ï¼Œå…è®¸å¼€å‘è€…åœ¨ä¸ç¼–å†™ä»£ç çš„æƒ…å†µä¸‹å¯¹æ¸²æŸ“ç®¡çº¿è¿›è¡Œå®šåˆ¶ã€‚å®ƒé€šè¿‡é…ç½®å‚æ•°å®ç°é€‰æ‹©æ€§æ¸²æŸ“ç‰¹å®šå±‚çº§çš„ç‰©ä½“ã€æ§åˆ¶æ¸²æŸ“é¡ºåºã€é‡è½½æè´¨æˆ–æ¸²æŸ“çŠ¶æ€ç­‰åŠŸèƒ½57ã€‚å…¶æ ¸å¿ƒç”¨é€”åŒ…æ‹¬ï¼š</p>
<ul>
<li>â€Œ<strong>å±‚çº§è¿‡æ»¤</strong>â€Œï¼šä»…æ¸²æŸ“æŒ‡å®šLayerMaskçš„ç‰©ä½“</li>
<li>â€Œ<strong>æ¸²æŸ“æ—¶æœºæ§åˆ¶</strong>â€Œï¼šé€šè¿‡Eventå‚æ•°æ’å…¥åˆ°æ¸²æŸ“ç®¡çº¿çš„ä¸åŒé˜¶æ®µï¼ˆå¦‚AfterRenderingOpaquesï¼‰</li>
<li>â€Œ<strong>æè´¨æ›¿æ¢</strong>â€Œï¼šä½¿ç”¨Override Materialè¦†ç›–åŸæœ‰æè´¨</li>
<li>â€Œ<strong>å¤šPassæ¸²æŸ“</strong>â€Œï¼šé…åˆShaderçš„LightModeæ ‡ç­¾å®ç°æè¾¹ç­‰æ•ˆæœ</li>
</ul>
<h2 data-id="heading-1"><strong>å‘å±•å†å²</strong></h2>
<ul>
<li>åˆå§‹ç‰ˆæœ¬ï¼ˆ2020å¹´å‰ï¼‰ä½œä¸ºLWRPå®éªŒæ€§åŠŸèƒ½å¼•å…¥</li>
<li>2020å¹´URP 7.xç‰ˆæœ¬æ­£å¼é›†æˆï¼Œæä¾›åŸºç¡€å±‚è¿‡æ»¤å’Œæè´¨æ›¿æ¢</li>
<li>2021å¹´åå¢å¼ºæ·±åº¦/æ¨¡æ¿æ§åˆ¶ï¼Œæ”¯æŒé€æ˜ç‰©ä½“å¤„ç†</li>
<li>2022å¹´ä¼˜åŒ–APIç»“æ„ï¼Œæ˜ç¡®ScriptableRendererFeatureä¸RenderPassçš„åˆ†ç¦»</li>
</ul>
<h2 data-id="heading-2">åŸç†</h2>
<h3 data-id="heading-3"><strong>åº•å±‚åŸç†</strong></h3>
<ul>
<li>
<p>â€Œ<strong>æ¶æ„å±‚çº§</strong>â€Œ</p>
<p>RenderObjectsé€šè¿‡ç»§æ‰¿<code>ScriptableRendererFeature</code>å’Œ<code>ScriptableRenderPass</code>å®ç°ç®¡çº¿æ‰©å±•ï¼Œæ ¸å¿ƒé€»è¾‘åœ¨<code>Execute()</code>æ–¹æ³•ä¸­é€šè¿‡<code>CommandBuffer</code>æäº¤ç»˜åˆ¶æŒ‡ä»¤ã€‚å…¶æœ¬è´¨æ˜¯é€šè¿‡URPçš„<code>ScriptableRenderContext</code>è°ƒåº¦GPUæ¸²æŸ“å‘½ä»¤ï¼Œä¸å†…ç½®ç®¡çº¿ä¸åŒä¹‹å¤„åœ¨äºé‡‡ç”¨å¯ç¼–ç¨‹çš„è½»é‡çº§æ¸²æŸ“ç®¡çº¿æ¶æ„ã€‚</p>
</li>
<li>
<p>â€Œ<strong>æ¸²æŸ“æµç¨‹æ§åˆ¶</strong>â€Œ</p>
<p>é€šè¿‡<code>RenderPassEvent</code>æšä¸¾æ’å…¥åˆ°URPçš„å›ºå®šç®¡çº¿é˜¶æ®µï¼ˆå¦‚AfterRenderingOpaquesï¼‰ï¼Œåº•å±‚ä¼šè§¦å‘ä»¥ä¸‹æ“ä½œï¼š</p>
<ul>
<li>è°ƒç”¨<code>ConfigureTarget()</code>è®¾ç½®æ¸²æŸ“ç›®æ ‡</li>
<li>ä½¿ç”¨<code>FilteringSettings</code>è¿‡æ»¤æŒ‡å®šLayerçš„ç‰©ä½“</li>
<li>é€šè¿‡<code>DrawingSettings</code>é…ç½®Shader Passå’Œæ’åºè§„åˆ™</li>
</ul>
</li>
<li>
<p>â€Œ<strong>æè´¨æ›¿æ¢æœºåˆ¶</strong>â€Œ</p>
<p>å½“å¯ç”¨Override Materialæ—¶ï¼ŒURPä¼šä¸´æ—¶æ›¿æ¢åŸå§‹æè´¨çš„Shaderï¼Œä½†ä¿ç•™ç‰©ä½“çš„é¡¶ç‚¹æ•°æ®ã€‚è¯¥è¿‡ç¨‹é€šè¿‡<code>MaterialPropertyBlock</code>å®ç°åŠ¨æ€å‚æ•°ä¼ é€’ï¼Œé¿å…æè´¨å®ä¾‹åŒ–å¼€é”€ã€‚</p>
</li>
</ul>
<h3 data-id="heading-4"><strong>å®ç°ç¤ºä¾‹</strong></h3>
<ul>
<li>
<p>OutlineFeature.cs</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> UnityEngine;
<span class="hljs-keyword">using</span> UnityEngine.Rendering;
<span class="hljs-keyword">using</span> UnityEngine.Rendering.Universal;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">OutlineFeature</span> : <span class="hljs-title">ScriptableRendererFeature</span> {
    <span class="hljs-keyword">class</span> <span class="hljs-title">OutlinePass</span> : <span class="hljs-title">ScriptableRenderPass</span> {
        <span class="hljs-keyword">private</span> Material _outlineMat;
        <span class="hljs-keyword">private</span> LayerMask _layerMask;
        <span class="hljs-keyword">private</span> FilteringSettings _filteringSettings;

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">OutlinePass</span>(<span class="hljs-params">Material mat, LayerMask mask</span>)</span> {
            _outlineMat = mat;
            _layerMask = mask;
            _filteringSettings = <span class="hljs-keyword">new</span> FilteringSettings(RenderQueueRange.opaque, _layerMask);
            renderPassEvent = RenderPassEvent.AfterRenderingOpaques;
        }

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Execute</span>(<span class="hljs-params">ScriptableRenderContext context, <span class="hljs-keyword">ref</span> RenderingData data</span>)</span> {
            <span class="hljs-keyword">var</span> drawingSettings = CreateDrawingSettings(
                <span class="hljs-keyword">new</span> ShaderTagId(<span class="hljs-string">"UniversalForward"</span>), 
                <span class="hljs-keyword">ref</span> data, 
                SortingCriteria.CommonOpaque
            );
            drawingSettings.overrideMaterial = _outlineMat;
            context.DrawRenderers(data.cullResults, <span class="hljs-keyword">ref</span> drawingSettings, <span class="hljs-keyword">ref</span> _filteringSettings);
        }
    }

    [<span class="hljs-meta">SerializeField</span>] <span class="hljs-keyword">private</span> Material _outlineMaterial;
    [<span class="hljs-meta">SerializeField</span>] <span class="hljs-keyword">private</span> LayerMask _outlineLayers = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">private</span> OutlinePass _pass;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Create</span>()</span> =&gt; _pass = <span class="hljs-keyword">new</span> OutlinePass(_outlineMaterial, _outlineLayers);
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AddRenderPasses</span>(<span class="hljs-params">ScriptableRenderer renderer, <span class="hljs-keyword">ref</span> RenderingData data</span>)</span> 
        =&gt; renderer.EnqueuePass(_pass);
}
</code></pre>
</li>
<li>
<p>Outline.shader</p>
<pre><code class="hljs language-c" lang="c">Shader <span class="hljs-string">"Custom/Outline"</span> {
    Properties {
        _OutlineColor(<span class="hljs-string">"Color"</span>, Color) = (<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)
        _OutlineWidth(<span class="hljs-string">"Width"</span>, Range(<span class="hljs-number">0</span>,<span class="hljs-number">0.1</span>)) = <span class="hljs-number">0.03</span>
    }
    SubShader {
        Tags { <span class="hljs-string">"RenderType"</span>=<span class="hljs-string">"Opaque"</span> <span class="hljs-string">"Queue"</span>=<span class="hljs-string">"Geometry+100"</span> }
        Pass {
            Cull Front
            ZWrite Off
            CGPROGRAM
            <span class="hljs-meta">#<span class="hljs-keyword">pragma</span> vertex vert</span>
            <span class="hljs-meta">#<span class="hljs-keyword">pragma</span> fragment frag</span>
            <span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"UnityCG.cginc"</span></span>

            <span class="hljs-type">float</span> _OutlineWidth;
            fixed4 _OutlineColor;

            <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">appdata</span> {</span>
                float4 vertex : POSITION;
                float3 normal : NORMAL;
            };

            v2f <span class="hljs-title function_">vert</span><span class="hljs-params">(appdata v)</span> {
                v2f o;
                v.vertex.xyz += v.normal * _OutlineWidth;
                o.pos = UnityObjectToClipPos(v.vertex);
                <span class="hljs-keyword">return</span> o;
            }

            fixed4 <span class="hljs-title function_">frag</span><span class="hljs-params">(v2f i)</span> : SV_Target {
                <span class="hljs-keyword">return</span> _OutlineColor;
            }
            ENDCG
        }
    }
}
</code></pre>
</li>
</ul>
<h3 data-id="heading-5"><strong>å…³é”®æµç¨‹è§£æ</strong></h3>
<ul>
<li>
<p>â€Œ<strong>æ¸²æŸ“æŒ‡ä»¤æäº¤</strong>â€Œ</p>
<p><code>DrawRenderers</code>æ–¹æ³•å†…éƒ¨ä¼šæ„å»º<code>BatchRendererGroup</code>ï¼Œå°†CPUä¾§çš„æ¸²æŸ“æ•°æ®æ‰¹é‡æäº¤è‡³GPUï¼Œç›¸æ¯”ç›´æ¥ä½¿ç”¨CommandBufferæ›´é«˜æ•ˆã€‚</p>
</li>
<li>
<p>â€Œ<strong>æ·±åº¦æµ‹è¯•æ§åˆ¶</strong>â€Œ</p>
<p>ç¤ºä¾‹ä¸­<code>ZWrite Off</code>ç¦ç”¨æ·±åº¦å†™å…¥ï¼Œä½¿æè¾¹å§‹ç»ˆæ˜¾ç¤ºåœ¨åŸå§‹ç‰©ä½“è¡¨é¢ï¼Œè¯¥æŠ€æœ¯ä¹Ÿå¸¸ç”¨äºè§£å†³é€æ˜ç‰©ä½“æ¸²æŸ“é¡ºåºé—®é¢˜ã€‚</p>
</li>
<li>
<p>â€Œ<strong>å¤šPassåä½œ</strong>â€Œ</p>
<p>URPä¼šå…ˆæ‰§è¡Œé»˜è®¤çš„Forwardæ¸²æŸ“Passï¼Œå†æ‰§è¡ŒRenderObjectsæ’å…¥çš„Passï¼Œé€šè¿‡<code>RenderPassEvent</code>æ§åˆ¶æ‰§è¡Œé¡ºåº</p>
</li>
</ul>
<h2 data-id="heading-6"><strong>å®Œæ•´å®ç°æµç¨‹ç¤ºä¾‹</strong></h2>
<ul>
<li>
<p>OutlineFeature.cs</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> UnityEngine;
<span class="hljs-keyword">using</span> UnityEngine.Rendering;
<span class="hljs-keyword">using</span> UnityEngine.Rendering.Universal;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">OutlineFeature</span> : <span class="hljs-title">ScriptableRendererFeature</span> {
    <span class="hljs-keyword">class</span> <span class="hljs-title">OutlinePass</span> : <span class="hljs-title">ScriptableRenderPass</span> {
        <span class="hljs-keyword">private</span> Material outlineMat;
        <span class="hljs-keyword">private</span> LayerMask layerMask;
        <span class="hljs-keyword">private</span> RenderTargetIdentifier source;

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">OutlinePass</span>(<span class="hljs-params">Material mat, LayerMask mask</span>)</span> {
            outlineMat = mat;
            layerMask = mask;
            renderPassEvent = RenderPassEvent.AfterRenderingOpaques;
        }

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Execute</span>(<span class="hljs-params">ScriptableRenderContext context, <span class="hljs-keyword">ref</span> RenderingData data</span>)</span> {
            CommandBuffer cmd = CommandBufferPool.Get(<span class="hljs-string">"OutlinePass"</span>);
            <span class="hljs-keyword">var</span> drawSettings = CreateDrawingSettings(
                <span class="hljs-keyword">new</span> ShaderTagId(<span class="hljs-string">"UniversalForward"</span>), 
                <span class="hljs-keyword">ref</span> data, SortingCriteria.CommonOpaque);
            <span class="hljs-keyword">var</span> filterSettings = <span class="hljs-keyword">new</span> FilteringSettings(RenderQueueRange.opaque, layerMask);
            context.DrawRenderers(data.cullResults, <span class="hljs-keyword">ref</span> drawSettings, <span class="hljs-keyword">ref</span> filterSettings);
            CommandBufferPool.Release(cmd);
        }
    }

    [<span class="hljs-meta">SerializeField</span>] <span class="hljs-keyword">private</span> Material outlineMaterial;
    [<span class="hljs-meta">SerializeField</span>] <span class="hljs-keyword">private</span> LayerMask outlineLayers;
    <span class="hljs-keyword">private</span> OutlinePass pass;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Create</span>()</span> {
        pass = <span class="hljs-keyword">new</span> OutlinePass(outlineMaterial, outlineLayers);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AddRenderPasses</span>(<span class="hljs-params">ScriptableRenderer renderer, <span class="hljs-keyword">ref</span> RenderingData data</span>)</span> {
        renderer.EnqueuePass(pass);
    }
}
</code></pre>
</li>
<li>
<p>Outline.shader</p>
<pre><code class="hljs language-c" lang="c">Shader <span class="hljs-string">"Custom/Outline"</span> {
    Properties {
        _OutlineColor(<span class="hljs-string">"Color"</span>, Color) = (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)
        _OutlineWidth(<span class="hljs-string">"Width"</span>, Range(<span class="hljs-number">0</span>,<span class="hljs-number">0.1</span>)) = <span class="hljs-number">0.05</span>
    }
    SubShader {
        Tags { <span class="hljs-string">"RenderType"</span>=<span class="hljs-string">"Opaque"</span> <span class="hljs-string">"LightMode"</span>=<span class="hljs-string">"UniversalForward"</span> }
        Pass {
            CGPROGRAM
            <span class="hljs-comment">// Vertex expansion logic...</span>
            ENDCG
        }
    }
}
</code></pre>
</li>
</ul>
<h2 data-id="heading-7"><strong>å‚æ•°è¯¦è§£ä¸ç”¨ä¾‹</strong></h2>



































<table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>åº”ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>â€Œ<strong>Event</strong>â€Œ</td><td>æ¸²æŸ“æ—¶æœºï¼ˆå¦‚BeforeRenderingPostProcessingï¼‰</td><td>æ§åˆ¶ç‰¹æ•ˆå åŠ é¡ºåº</td></tr><tr><td>â€Œ<strong>LayerMask</strong>â€Œ</td><td>ç›®æ ‡æ¸²æŸ“å±‚çº§</td><td>ä»…å¯¹æ•Œäºº/UIå±‚æè¾¹</td></tr><tr><td>â€Œ<strong>Override Material</strong>â€Œ</td><td>æ›¿æ¢æè´¨</td><td>è§’è‰²è¿›å…¥é˜´å½±åŒºåˆ‡æ¢æè´¨</td></tr><tr><td>â€Œ<strong>Depth Test</strong>â€Œ</td><td>æ·±åº¦æµ‹è¯•æ¨¡å¼</td><td>è§£å†³é€æ˜ç‰©ä½“é®æŒ¡é—®é¢˜</td></tr><tr><td>â€Œ<strong>Shader Passes</strong>â€Œ</td><td>åŒ¹é…çš„Shader LightModeæ ‡ç­¾</td><td>å¤šPassæ¸²æŸ“ï¼ˆå¦‚"UniversalForward"ï¼‰</td></tr></tbody></table>
<h2 data-id="heading-8"><strong>é…ç½®æ­¥éª¤</strong></h2>
<ul>
<li>åˆ›å»ºURP Assetå¹¶å¯ç”¨Renderer Features</li>
<li>æ·»åŠ RenderObjects Featureåˆ°Forward Renderer</li>
<li>é…ç½®Eventä¸ºAfterRenderingOpaquesï¼ˆä¸é€æ˜ç‰©ä½“ï¼‰æˆ–AfterRenderingTransparentsï¼ˆé€æ˜ç‰©ä½“ï¼‰</li>
<li>æŒ‡å®šç›®æ ‡Layerå’Œæ›¿æ¢æè´¨</li>
<li>è°ƒæ•´Depth/Stencilå‚æ•°è§£å†³é®æŒ¡é—®é¢˜</li>
</ul>
<p>å…¸å‹åº”ç”¨åŒ…æ‹¬ï¼šè§’è‰²æè¾¹ã€åœºæ™¯åˆ†å—æ¸²æŸ“ã€ç‰¹æ®Šæ•ˆæœå åŠ ï¼ˆå¦‚å—ä¼¤é«˜äº®ï¼‰ç­‰ã€‚é€šè¿‡ç»„åˆä¸åŒEventå’ŒLayerMaskå¯å®ç°å¤æ‚çš„æ¸²æŸ“ç®¡çº¿æ§åˆ¶</p>
<hr/>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13021255.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13021255%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13021255&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong>
ï¼ˆæ¬¢è¿<em>ç‚¹èµç•™è¨€</em>æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Room ç®€å•ä½¿ç”¨]]></title>    <link>https://juejin.cn/post/7574343024324509737</link>    <guid>https://juejin.cn/post/7574343024324509737</guid>    <pubDate>2025-11-20T01:35:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574343024324509737" data-draft-id="7574343024324427817" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Room ç®€å•ä½¿ç”¨"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-11-20T01:35:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Charlieç¬"/> <meta itemprop="url" content="https://juejin.cn/user/2221480830311645"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Room ç®€å•ä½¿ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2221480830311645/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Charlieç¬
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T01:35:07.000Z" title="Thu Nov 20 2025 01:35:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åˆ›å»º item å®ä½“</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Freference%2Fandroidx%2Froom%2FEntity%3Fhl%3Dzh-cn" target="_blank" title="https://developer.android.com/reference/androidx/room/Entity?hl=zh-cn" ref="nofollow noopener noreferrer">Entity</a> ç±»å®šä¹‰äº†ä¸€ä¸ªè¡¨ï¼Œè¯¥ç±»çš„æ¯ä¸ªå®ä¾‹éƒ½è¡¨ç¤ºæ•°æ®åº“è¡¨ä¸­çš„ä¸€è¡Œã€‚Entity ç±»ä»¥æ˜ å°„å‘ŠçŸ¥ Room å®ƒæ‰“ç®—å¦‚ä½•å‘ˆç°æ•°æ®åº“ä¸­çš„ä¿¡æ¯å¹¶ä¸ä¹‹äº¤äº’ã€‚åœ¨æ­¤åº”ç”¨ä¸­ï¼Œå®ä½“å°†ä¿å­˜æœ‰å…³å•†å“ç›®å½•å•†å“çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å•†å“åç§°ã€å•†å“ä»·æ ¼å’Œå•†å“æ•°é‡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c56e74d909ee4fa89f1728b43e98e242~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2hhcmxpZeeBrA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764207307&amp;x-signature=u1xQvfnU1FyQ%2FK0Jp1zKx0YnmZo%3D" alt="" loading="lazy"/></p>
<p><code>@Entity</code> æ³¨è§£ç”¨äºå°†æŸä¸ªç±»æ ‡è®°ä¸ºæ•°æ®åº“ Entity ç±»ã€‚å¯¹äºæ¯ä¸ª Entity ç±»ï¼Œè¯¥åº”ç”¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ•°æ®åº“è¡¨æ¥ä¿å­˜è¿™äº›é¡¹ã€‚é™¤éå¦è¡Œè¯´æ˜ï¼Œå¦åˆ™ Entity çš„æ¯ä¸ªå­—æ®µåœ¨æ•°æ®åº“ä¸­éƒ½è¡¨ç¤ºä¸ºä¸€åˆ—ã€‚å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ¯ä¸ªå®ä½“å®ä¾‹éƒ½å¿…é¡»æœ‰ä¸€ä¸ªä¸»é”®ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Freference%2Fandroidx%2Froom%2FPrimaryKey%3Fhl%3Dzh-cn" target="_blank" title="https://developer.android.com/reference/androidx/room/PrimaryKey?hl=zh-cn" ref="nofollow noopener noreferrer">ä¸»é”®</a>ç”¨äºå”¯ä¸€æ ‡è¯†æ•°æ®åº“è¡¨ä¸­çš„æ¯ä¸ªè®°å½•/æ¡ç›®ã€‚åº”ç”¨åˆ†é…ä¸»é”®åï¼Œä¾¿æ— æ³•å†ä¿®æ”¹ä¸»é”®ï¼›åªè¦ä¸»é”®å­˜åœ¨äºæ•°æ®åº“ä¸­ï¼Œå®ƒå°±ä¼šè¡¨ç¤ºå®ä½“å¯¹è±¡ã€‚</p>
<p>åœ¨æ­¤ä»»åŠ¡ä¸­ï¼Œå°†åˆ›å»ºä¸€ä¸ª Entity ç±»ï¼Œå¹¶å®šä¹‰å­—æ®µæ¥å­˜å‚¨æ¯ä¸ªå•†å“çš„ä»¥ä¸‹å•†å“ç›®å½•ä¿¡æ¯ï¼š<code>Int</code> ç”¨äºå­˜å‚¨ä¸»é”®ï¼Œ<code>String</code> ç”¨äºå­˜å‚¨å•†å“åç§°ï¼Œ<code>double</code> ç”¨äºå­˜å‚¨å•†å“ä»·æ ¼ï¼Œ<code>Int</code> ç”¨äºå­˜å‚¨åº“å­˜æ•°é‡ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Entity(tableName = <span class="hljs-string">"items"</span>)</span>
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Item</span>(
    <span class="hljs-meta">@PrimaryKey(autoGenerate = true)</span>
    <span class="hljs-keyword">val</span> id: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>,
    <span class="hljs-keyword">val</span> name: String,
    <span class="hljs-keyword">val</span> price: <span class="hljs-built_in">Double</span>,
    <span class="hljs-keyword">val</span> quantity: <span class="hljs-built_in">Int</span>
)
</code></pre>
<h2 data-id="heading-1">åˆ›å»º item DAO</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Freference%2Fandroidx%2Froom%2FDao%3Fhl%3Dzh-cn" target="_blank" title="https://developer.android.com/reference/androidx/room/Dao?hl=zh-cn" ref="nofollow noopener noreferrer">æ•°æ®è®¿é—®å¯¹è±¡</a> (DAO) æ˜¯ä¸€ç§æ¨¡å¼ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FSingle-responsibility_principle" target="_blank" title="https://en.wikipedia.org/wiki/Single-responsibility_principle" ref="nofollow noopener noreferrer">å•ä¸€è´£ä»»åŸåˆ™</a>ï¼‰ï¼Œå…¶ä½œç”¨æ˜¯é€šè¿‡æä¾›æŠ½è±¡æ¥å£å°†æŒä¹…æ€§å±‚ä¸åº”ç”¨çš„å…¶ä½™éƒ¨åˆ†åˆ†ç¦»ï¼Œè´Ÿè´£å®šä¹‰ç”¨äºè®¿é—®æ•°æ®åº“çš„æ¥å£ã€‚</p>
<p>DAO çš„åŠŸèƒ½åœ¨äºï¼Œè®©åœ¨åº•å±‚æŒä¹…æ€§å±‚æ‰§è¡Œæ•°æ®åº“æ“ä½œæ‰€æ¶‰åŠçš„æ‰€æœ‰å¤æ‚æ€§ä¸åº”ç”¨çš„å…¶ä½™éƒ¨åˆ†åˆ†ç¦»ã€‚è¿™æ ·ï¼Œå°±å¯ä»¥ç‹¬ç«‹äºä½¿ç”¨æ•°æ®çš„ä»£ç æ›´æ”¹æ•°æ®å±‚ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9387fb71af9d459ba6d0086bdd42bd9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2hhcmxpZeeBrA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764207307&amp;x-signature=Bo%2Facks19fSFaBJmjb8v47aAO2c%3D" alt="" loading="lazy"/></p>
<p><code>Room</code> åº“æä¾›äº†ä¾¿æ·æ³¨è§£ï¼ˆä¾‹å¦‚ <code>@Insert</code>ã€<code>@Delete</code> å’Œ <code>@Update</code>ï¼‰ï¼Œç”¨äºå®šä¹‰æ‰§è¡Œç®€å•æ’å…¥ã€åˆ é™¤å’Œæ›´æ–°çš„æ–¹æ³•ï¼Œè€Œæ— éœ€ç¼–å†™ SQL è¯­å¥ã€‚å¦‚æœéœ€è¦å®šä¹‰æ›´å¤æ‚çš„æ’å…¥ã€åˆ é™¤æˆ–æ›´æ–°æ“ä½œï¼Œæˆ–è€…éœ€è¦æŸ¥è¯¢æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œè¯·æ”¹ç”¨ <code>@Query</code> æ³¨è§£ã€‚</p>
<p>æ•°æ®åº“æ“ä½œçš„æ‰§è¡Œå¯èƒ½ç”¨æ—¶è¾ƒé•¿ï¼Œå› æ­¤éœ€è¦åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸Šè¿è¡Œã€‚Room ä¸å…è®¸åœ¨ä¸»çº¿ç¨‹ä¸Šè®¿é—®æ•°æ®åº“ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> androidx.room.Dao

<span class="hljs-meta">@Dao</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ItemDao</span> {

    <span class="hljs-meta">@Insert(onConflict = OnConflictStrategy.IGNORE)</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">insert</span><span class="hljs-params">(item: <span class="hljs-type">Item</span>)</span></span>

    <span class="hljs-meta">@Update</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">update</span><span class="hljs-params">(item: <span class="hljs-type">Item</span>)</span></span>

    <span class="hljs-meta">@Delete</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">delete</span><span class="hljs-params">(item: <span class="hljs-type">Item</span>)</span></span>

    <span class="hljs-meta">@Query(<span class="hljs-string">"SELECT * from items WHERE id = :id"</span>)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getItem</span><span class="hljs-params">(id: <span class="hljs-type">Int</span>)</span></span>: Flow&lt;Item&gt;

    <span class="hljs-meta">@Query(<span class="hljs-string">"SELECT * from items ORDER BY name ASC"</span>)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getAllItems</span><span class="hljs-params">()</span></span>: Flow&lt;List&lt;Item&gt;&gt;
}
</code></pre>
<blockquote>
<p>æ·»åŠ å‚æ•° <code>onConflict</code> å¹¶ä¸ºå…¶èµ‹å€¼ <code>OnConflictStrategy.``IGNORE</code>ã€‚å‚æ•° <code>onConflict</code> ç”¨äºå‘ŠçŸ¥ Room åœ¨å‘ç”Ÿå†²çªæ—¶åº”è¯¥æ‰§è¡Œçš„æ“ä½œã€‚<code>OnConflictStrategy.``IGNORE</code> ç­–ç•¥ä¼šå¿½ç•¥æ–°å•†å“ã€‚</p>
<p>ç”±äºè¿”å›å€¼ç±»å‹ä¸º <code>Flow</code>ï¼ŒRoom è¿˜ä¼šåœ¨åå°çº¿ç¨‹ä¸Šè¿è¡Œè¯¥æŸ¥è¯¢ã€‚æ— éœ€å°†å…¶æ˜ç¡®è®¾ä¸º <code>suspend</code> å‡½æ•°å¹¶åœ¨åç¨‹ä½œç”¨åŸŸå†…è°ƒç”¨å®ƒã€‚</p>
</blockquote>
<h2 data-id="heading-2">åˆ›å»º Database å®ä¾‹</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Freference%2Fandroidx%2Froom%2FDatabase%3Fhl%3Dzh-cn" target="_blank" title="https://developer.android.com/reference/androidx/room/Database?hl=zh-cn" ref="nofollow noopener noreferrer">Database</a> ç±»å¯ä¸ºåº”ç”¨æä¾›å®šä¹‰çš„ DAO å®ä¾‹ã€‚åè¿‡æ¥ï¼Œåº”ç”¨å¯ä»¥ä½¿ç”¨ DAO ä»æ•°æ®åº“ä¸­æ£€ç´¢æ•°æ®ï¼Œä½œä¸ºå…³è”çš„æ•°æ®å®ä½“å¯¹è±¡çš„å®ä¾‹ã€‚æ­¤å¤–ï¼Œåº”ç”¨è¿˜å¯ä»¥ä½¿ç”¨å®šä¹‰çš„æ•°æ®å®ä½“æ›´æ–°ç›¸åº”è¡¨ä¸­çš„è¡Œï¼Œæˆ–è€…åˆ›å»ºæ–°è¡Œä¾›æ’å…¥ã€‚</p>
<p>éœ€è¦åˆ›å»ºä¸€ä¸ªæŠ½è±¡ <code>RoomDatabase</code> ç±»ï¼Œå¹¶ä¸ºå…¶æ·»åŠ  <code>@Database</code> æ³¨è§£ã€‚æ­¤ç±»æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œå¦‚æœæ•°æ®åº“ä¸å­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å› <code>RoomDatabase</code> çš„ç°æœ‰å®ä¾‹ã€‚</p>
<p><strong>è·å– <strong><code>**RoomDatabase**</code></strong> å®ä¾‹çš„ä¸€èˆ¬è¿‡ç¨‹ï¼š</strong></p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªæ‰©å±• <code>RoomDatabase</code> çš„ <code>public abstract</code> ç±»ã€‚æ‚¨å®šä¹‰çš„æ–°æŠ½è±¡ç±»å°†ç”¨ä½œæ•°æ®åº“æŒæœ‰è€…ã€‚æ‚¨å®šä¹‰çš„ç±»æ˜¯æŠ½è±¡ç±»ï¼Œå› ä¸º <code>Room</code> ä¼šä¸ºæ‚¨åˆ›å»ºå®ç°ã€‚</li>
<li>ä¸ºè¯¥ç±»æ·»åŠ  <code>@Database</code> æ³¨è§£ã€‚åœ¨å‚æ•°ä¸­ï¼Œä¸ºæ•°æ®åº“åˆ—å‡ºå®ä½“å¹¶è®¾ç½®ç‰ˆæœ¬å·ã€‚</li>
<li>å®šä¹‰ä¸€ä¸ªè¿”å› <code>ItemDao</code> å®ä¾‹çš„æŠ½è±¡æ–¹æ³•æˆ–å±æ€§ï¼Œ<code>Room</code> ä¼šä¸ºæ‚¨ç”Ÿæˆå®ç°ã€‚</li>
<li>æ•´ä¸ªåº”ç”¨åªéœ€è¦ä¸€ä¸ª <code>RoomDatabase</code> å®ä¾‹ï¼Œå› æ­¤è¯·å°† <code>RoomDatabase</code> è®¾ä¸ºå•ä¾‹ã€‚</li>
<li>ä½¿ç”¨ <code>Room</code> çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Freference%2Fandroidx%2Froom%2FRoom%3Fhl%3Dzh-cn%23databaseBuilder(android.content.Context%2Cjava.lang.Class%2Ckotlin.String)" target="_blank" title="https://developer.android.com/reference/androidx/room/Room?hl=zh-cn#databaseBuilder(android.content.Context,java.lang.Class,kotlin.String)" ref="nofollow noopener noreferrer">Room.databaseBuilder</a> åˆ›å»º (<code>item_database</code>) æ•°æ®åº“ã€‚ä¸è¿‡ï¼Œä»…å½“è¯¥æ•°æ®åº“ä¸å­˜åœ¨æ—¶æ‰åº”åˆ›å»ºã€‚å¦åˆ™ï¼Œè¯·è¿”å›ç°æœ‰æ•°æ®åº“ã€‚</li>
</ol>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> android.content.Context
<span class="hljs-keyword">import</span> androidx.room.Database
<span class="hljs-keyword">import</span> androidx.room.Room
<span class="hljs-keyword">import</span> androidx.room.RoomDatabase

<span class="hljs-comment">/**
* Database class with a singleton Instance object.
*/</span>
<span class="hljs-meta">@Database(entities = [Item::class], version = 1, exportSchema = false)</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InventoryDatabase</span> : <span class="hljs-type">RoomDatabase</span>() {

    <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">itemDao</span><span class="hljs-params">()</span></span>: ItemDao

    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-meta">@Volatile</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> Instance: InventoryDatabase? = <span class="hljs-literal">null</span>

        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getDatabase</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>)</span></span>: InventoryDatabase {
            <span class="hljs-comment">// if the Instance is not null, return it, otherwise create a new database instance.</span>
            <span class="hljs-keyword">return</span> Instance ?: synchronized(<span class="hljs-keyword">this</span>) {
                Room.databaseBuilder(context, InventoryDatabase::<span class="hljs-keyword">class</span>.java, <span class="hljs-string">"item_database"</span>)
                    .build()
                    .also { Instance = it }
            }
        }
    }
}
</code></pre>
<blockquote>
<p>å°† <code>exportSchema</code> è®¾ä¸º <code>false</code>ï¼Œè¿™æ ·å°±ä¸ä¼šä¿ç•™æ¶æ„ç‰ˆæœ¬è®°å½•çš„å¤‡ä»½ã€‚</p>
<p>volatile å˜é‡çš„å€¼ç»ä¸ä¼šç¼“å­˜ï¼Œæ‰€æœ‰è¯»å†™æ“ä½œéƒ½å°†åœ¨ä¸»å†…å­˜ä¸­å®Œæˆã€‚è¿™äº›åŠŸèƒ½æœ‰åŠ©äºç¡®ä¿ <code>Instance</code> çš„å€¼å§‹ç»ˆæ˜¯æœ€æ–°çš„ï¼Œå¹¶ä¸”å¯¹æ‰€æœ‰æ‰§è¡Œçº¿ç¨‹éƒ½ç›¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªçº¿ç¨‹å¯¹ <code>Instance</code> æ‰€åšçš„æ›´æ”¹ä¼šç«‹å³å¯¹æ‰€æœ‰å…¶ä»–çº¿ç¨‹å¯è§ã€‚</p>
</blockquote>
<h2 data-id="heading-3">å®ç°å­˜å‚¨åº“</h2>
<p>å°†å®ç° <code>ItemsRepository</code> æ¥å£å’Œ <code>OfflineItemsRepository</code> ç±»ï¼Œä»¥ä»æ•°æ®åº“æä¾› <code>get</code>ã€<code>insert</code>ã€<code>delete</code> å’Œ <code>update</code> å®ä½“ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.flow.Flow

<span class="hljs-comment">/**
* Repository that provides insert, update, delete, and retrieve of [Item] from a given data source.
*/</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ItemsRepository</span> {
    <span class="hljs-comment">/**
     * Retrieve all the items from the the given data source.
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getAllItemsStream</span><span class="hljs-params">()</span></span>: Flow&lt;List&lt;Item&gt;&gt;

    <span class="hljs-comment">/**
     * Retrieve an item from the given data source that matches with the [id].
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getItemStream</span><span class="hljs-params">(id: <span class="hljs-type">Int</span>)</span></span>: Flow&lt;Item?&gt;

    <span class="hljs-comment">/**
     * Insert item in the data source
     */</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">insertItem</span><span class="hljs-params">(item: <span class="hljs-type">Item</span>)</span></span>

    <span class="hljs-comment">/**
     * Delete item from the data source
     */</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">deleteItem</span><span class="hljs-params">(item: <span class="hljs-type">Item</span>)</span></span>

    <span class="hljs-comment">/**
     * Update item in the data source
     */</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateItem</span><span class="hljs-params">(item: <span class="hljs-type">Item</span>)</span></span>
}
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.flow.Flow

<span class="hljs-keyword">class</span> <span class="hljs-title class_">OfflineItemsRepository</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> itemDao: ItemDao) : ItemsRepository {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getAllItemsStream</span><span class="hljs-params">()</span></span>: Flow&lt;List&lt;Item&gt;&gt; = itemDao.getAllItems()

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getItemStream</span><span class="hljs-params">(id: <span class="hljs-type">Int</span>)</span></span>: Flow&lt;Item?&gt; = itemDao.getItem(id)

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">insertItem</span><span class="hljs-params">(item: <span class="hljs-type">Item</span>)</span></span> = itemDao.insert(item)

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">deleteItem</span><span class="hljs-params">(item: <span class="hljs-type">Item</span>)</span></span> = itemDao.delete(item)

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateItem</span><span class="hljs-params">(item: <span class="hljs-type">Item</span>)</span></span> = itemDao.update(item)
}
</code></pre>
<h2 data-id="heading-4">å®ç° AppContainer ç±»</h2>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> itemsRepository: ItemsRepository <span class="hljs-keyword">by</span> lazy {
    OfflineItemsRepository(InventoryDatabase.getDatabase(context).itemDao())
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[FiddleræŠ“åŒ…å·¥å…·å®Œæ•´æ•™ç¨‹ HTTPHTTPSæŠ“åŒ…ã€ä»£ç†é…ç½®ä¸APIè°ƒè¯•å®æˆ˜æŠ€å·§ï¼ˆå¼€å‘è€…è¿›é˜¶æŒ‡å—ï¼‰]]></title>    <link>https://juejin.cn/post/7574352425236709395</link>    <guid>https://juejin.cn/post/7574352425236709395</guid>    <pubDate>2025-11-20T02:24:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574352425236709395" data-draft-id="7574366319736258596" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="FiddleræŠ“åŒ…å·¥å…·å®Œæ•´æ•™ç¨‹ HTTPHTTPSæŠ“åŒ…ã€ä»£ç†é…ç½®ä¸APIè°ƒè¯•å®æˆ˜æŠ€å·§ï¼ˆå¼€å‘è€…è¿›é˜¶æŒ‡å—ï¼‰"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-20T02:24:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜Ÿæ˜Ÿç”µç¯çŒ´"/> <meta itemprop="url" content="https://juejin.cn/user/2848205394945444"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            FiddleræŠ“åŒ…å·¥å…·å®Œæ•´æ•™ç¨‹ HTTPHTTPSæŠ“åŒ…ã€ä»£ç†é…ç½®ä¸APIè°ƒè¯•å®æˆ˜æŠ€å·§ï¼ˆå¼€å‘è€…è¿›é˜¶æŒ‡å—ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2848205394945444/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜Ÿæ˜Ÿç”µç¯çŒ´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T02:24:09.000Z" title="Thu Nov 20 2025 02:24:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¾ˆå¤šç¨‹åºå‘˜éƒ½æœ‰è¿™æ ·çš„ç»å†ï¼šæ¥å£æ˜æ˜èƒ½è¯·æ±‚æˆåŠŸï¼Œå´æ‹¿ä¸åˆ°æ•°æ®ï¼›æµ‹è¯•ç¯å¢ƒä¸€åˆ‡æ­£å¸¸ï¼Œç”Ÿäº§ç¯å¢ƒå´é¢‘ç¹è¶…æ—¶ï¼›ç§»åŠ¨ç«¯è¯·æ±‚å‚æ•°æ€»æ˜¯â€œç¥ç§˜æ¶ˆå¤±â€ï¼Œå‰åç«¯äº’ç›¸ç”©é”…ã€‚</p>
<p>è¿™äº›é—®é¢˜çš„æ ¹æºï¼Œå¤§å¤šéšè—åœ¨ç½‘ç»œå±‚ã€‚
è€Œæƒ³â€œçœ‹æ¸…æ¥šç½‘ç»œè¯·æ±‚åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆâ€ï¼Œæœ€æœ‰æ•ˆçš„æ–¹å¼å°±æ˜¯ä½¿ç”¨ä¸€æ¬¾ä¸“ä¸šçš„æŠ“åŒ…è°ƒè¯•å·¥å…·ã€‚</p>
<p>ä»Šå¤©è¦ä»‹ç»çš„è¿™æ¬¾å·¥å…·ï¼Œå‡ ä¹æ˜¯æ¯ä½å¼€å‘è€…éƒ½ä¼šå®‰è£…åœ¨ç”µè„‘ä¸Šçš„â€œæ ‡é…â€â€”â€”<strong>FiddleræŠ“åŒ…å·¥å…·</strong>ã€‚</p>
<p>æœ¬æ–‡å°†ç³»ç»Ÿè®²è§£ Fiddler çš„å®‰è£…é…ç½®ã€ä»£ç†è®¾ç½®ã€HTTPS æŠ“åŒ…ã€Mock æ¥å£ä¸è°ƒè¯•æŠ€å·§ï¼Œå¹¶ç»“åˆçœŸå®å¼€å‘åœºæ™¯ï¼Œä¸ºä½ æ€»ç»“å‡ºé«˜æ•ˆã€å®ç”¨çš„è°ƒè¯•æ–¹æ³•ã€‚</p>
<hr/>
<h2 data-id="heading-0"><strong>ä¸€ã€FiddleræŠ“åŒ…å·¥å…·ç®€ä»‹</strong></h2>
<p><strong>Fiddler</strong> æ˜¯ Telerik å…¬å¸å‡ºå“çš„ä¸€æ¬¾å…è´¹ HTTP/HTTPS æŠ“åŒ…ä¸è°ƒè¯•å·¥å…·ã€‚
å®ƒé€šè¿‡ä»£ç†æœºåˆ¶æ•è·ç½‘ç»œè¯·æ±‚ï¼Œå¸®åŠ©å¼€å‘è€…åˆ†æã€ä¿®æ”¹ã€é‡æ”¾ã€æ¨¡æ‹Ÿå’Œæµ‹è¯•å„ç§æ¥å£é€šä¿¡ã€‚</p>
<p>ä¸å¸¸è§å·¥å…·ï¼ˆå¦‚ Charlesã€Postmanã€Wiresharkï¼‰ç›¸æ¯”ï¼ŒFiddler å…·å¤‡ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>å…¨é¢æ”¯æŒ HTTP / HTTPS åè®®</strong>ï¼›</li>
<li><strong>å¯æŸ¥çœ‹è¯·æ±‚ã€å“åº”ã€Headerã€å‚æ•°ä¸æ€§èƒ½æ•°æ®</strong>ï¼›</li>
<li><strong>æ”¯æŒæ–­ç‚¹è°ƒè¯•ä¸è¯·æ±‚ä¿®æ”¹</strong>ï¼›</li>
<li><strong>å†…ç½® Mock åŠŸèƒ½ï¼ˆAutoResponderï¼‰</strong>ï¼›</li>
<li><strong>å…è´¹ã€ç¨³å®šã€å¯æ‰©å±•æ€§å¼º</strong>ã€‚</li>
</ul>
<p>Fiddler æ˜¯ä¸€æ¬¾è®©å¼€å‘è€…â€œçœ‹å¾—æ¸…ã€æ”¹å¾—åŠ¨ã€æµ‹å¾—å‡†â€çš„ç½‘ç»œè°ƒè¯•åˆ©å™¨ã€‚</p>
<hr/>
<h2 data-id="heading-1"><strong>äºŒã€Fiddlerå®‰è£…ä¸é…ç½®æ–¹æ³•</strong></h2>
<h3 data-id="heading-2"><strong>1. å®‰è£…ä¸å¯åŠ¨</strong></h3>
<p>åœ¨ Windows ç³»ç»Ÿä¸­å®‰è£… Fiddler åï¼Œé¦–æ¬¡å¯åŠ¨æ—¶è½¯ä»¶ä¼šè‡ªåŠ¨æ¥ç®¡ç³»ç»Ÿä»£ç†ã€‚
æ­¤æ—¶æ‰“å¼€ä»»æ„æµè§ˆå™¨è®¿é—®ç½‘ç«™ï¼Œå³å¯åœ¨ Fiddler ä¸»ç•Œé¢çœ‹åˆ°æ‰€æœ‰ HTTP è¯·æ±‚ã€‚</p>
<p><strong>å°æç¤ºï¼š</strong></p>
<ul>
<li>å·¦ä¸‹è§’æ˜¾ç¤º â€œCapturingâ€ è¡¨ç¤ºæŠ“åŒ…åŠŸèƒ½å¼€å¯ï¼›</li>
<li>è‹¥ä¸º â€œPausedâ€ï¼Œç‚¹å‡»å³å¯æ¢å¤æŠ“åŒ…ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-3"><strong>2. Fiddlerä»£ç†è®¾ç½®ï¼ˆç”µè„‘ä¸ç§»åŠ¨ç«¯ï¼‰</strong></h3>
<p>Fiddler é»˜è®¤åªæŠ“å–å½“å‰ç”µè„‘çš„ç½‘ç»œè¯·æ±‚ã€‚
è‹¥è¦æŠ“å–æ‰‹æœºã€å°ç¨‹åºæˆ–æ¨¡æ‹Ÿå™¨æµé‡ï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯è¿œç¨‹ä»£ç†ã€‚</p>
<p><strong>è®¾ç½®æ­¥éª¤å¦‚ä¸‹ï¼š</strong></p>
<ol>
<li>æ‰“å¼€èœå•æ  <code>Tools â†’ Options â†’ Connections</code>ï¼›</li>
<li>å‹¾é€‰ <strong>Allow remote computers to connect</strong>ï¼›</li>
<li>è®°å½•ç”µè„‘ IP åœ°å€ä¸ç«¯å£å·ï¼ˆé»˜è®¤ 8888ï¼‰ï¼›</li>
<li>ç¡®ä¿æ‰‹æœºä¸ç”µè„‘è¿æ¥åœ¨åŒä¸€ Wi-Fiï¼›</li>
<li>åœ¨æ‰‹æœº Wi-Fi è®¾ç½®ä¸­é…ç½®ä»£ç†ï¼š
<ul>
<li>ä¸»æœºåï¼šç”µè„‘ IP</li>
<li>ç«¯å£ï¼š8888</li>
</ul>
</li>
</ol>
<p>å®Œæˆåï¼Œä½ çš„æ‰‹æœºè¯·æ±‚å°†é€šè¿‡ Fiddler è½¬å‘ï¼Œå¯å®ç°è·¨è®¾å¤‡æŠ“åŒ…åˆ†æã€‚</p>
<hr/>
<h3 data-id="heading-4"><strong>3. HTTPS æŠ“åŒ…è®¾ç½®</strong></h3>
<p>ç°åœ¨å‡ ä¹æ‰€æœ‰æ¥å£éƒ½ä½¿ç”¨ HTTPS åŠ å¯†åè®®ã€‚
ä¸ºäº†æŸ¥çœ‹åŠ å¯†æµé‡å†…å®¹ï¼Œéœ€åœ¨ Fiddler ä¸­å®‰è£…æ ¹è¯ä¹¦å¹¶å¯ç”¨è§£å¯†åŠŸèƒ½ã€‚</p>
<p><strong>é…ç½®æ–¹æ³•ï¼š</strong></p>
<ul>
<li>æ‰“å¼€ <code>Tools â†’ Options â†’ HTTPS</code>ï¼›</li>
<li>å‹¾é€‰ <strong>Decrypt HTTPS traffic</strong>ï¼›</li>
<li>ç‚¹å‡» â€œActions â†’ Trust Root Certificateâ€ï¼›</li>
<li>å®‰è£…å¹¶ä¿¡ä»»è¯ä¹¦ï¼›</li>
<li>è‹¥æŠ“å–ç§»åŠ¨ç«¯è¯·æ±‚ï¼Œè¿˜éœ€å¯¼å‡ºè¯ä¹¦å¹¶åœ¨è®¾å¤‡ä¸Šè®¾ç½®ä¿¡ä»»ã€‚</li>
</ul>
<p>é…ç½®å®Œæˆåï¼ŒFiddler å°†èƒ½æ•è·å®Œæ•´çš„ HTTPS è¯·æ±‚ä¸å“åº”æ•°æ®ã€‚</p>
<hr/>
<h2 data-id="heading-5"><strong>ä¸‰ã€Fiddlerä½¿ç”¨æ•™ç¨‹ï¼šæ ¸å¿ƒåŠŸèƒ½è¯¦è§£</strong></h2>
<h3 data-id="heading-6"><strong>1. è¯·æ±‚ä¸å“åº”åˆ†æ</strong></h3>
<p>åœ¨ä¸»ç•Œé¢ä¸­ï¼Œæ¯æ¡è¯·æ±‚éƒ½å¯å±•å¼€æŸ¥çœ‹è¯¦ç»†å†…å®¹ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>è¯·æ±‚æ–¹å¼ï¼ˆGETã€POSTã€PUTã€DELETEï¼‰ï¼›</li>
<li>è¯·æ±‚è·¯å¾„ã€å‚æ•°ä¸ Headerï¼›</li>
<li>å“åº”çŠ¶æ€ç ã€Body ä¸è¿”å›æ•°æ®ï¼›</li>
<li>è¯·æ±‚è€—æ—¶ä¸æ€§èƒ½åˆ†æã€‚</li>
</ul>
<p><strong>å®æˆ˜ç»éªŒï¼š</strong>
æŸé¡¹ç›®ä¸­ç™»å½•æ¥å£æ€»æ˜¯è¿”å›ç©ºå“åº”ï¼Œé€šè¿‡ Fiddler å‘ç°è¯·æ±‚å¤´ <code>Content-Type</code> ç¼ºå¤±ï¼Œåç«¯æœªèƒ½æ­£ç¡®è§£ææ•°æ®ï¼Œå‡ åˆ†é’Ÿå†…å®šä½é—®é¢˜ã€‚</p>
<hr/>
<h3 data-id="heading-7"><strong>2. æ–­ç‚¹è°ƒè¯•ï¼ˆBreakpointsï¼‰</strong></h3>
<p>Fiddler æ”¯æŒæ‹¦æˆªè¯·æ±‚ä¸å“åº”ï¼Œè®©å¼€å‘è€…å¯æ‰‹åŠ¨ä¿®æ”¹å†…å®¹å†ç»§ç»­æ‰§è¡Œã€‚</p>
<p><strong>å¸¸è§ç”¨é€”ï¼š</strong></p>
<ul>
<li>æ¨¡æ‹Ÿæ¥å£é”™è¯¯ï¼ˆè¿”å› 404 / 500ï¼‰ï¼›</li>
<li>ä¿®æ”¹å‚æ•°éªŒè¯å®¹é”™é€»è¾‘ï¼›</li>
<li>å»¶è¿Ÿå“åº”æµ‹è¯•å¼±ç½‘æ€§èƒ½ã€‚</li>
</ul>
<p><strong>æŠ€å·§æç¤ºï¼š</strong>
åœ¨å‘½ä»¤è¡Œè¾“å…¥ <code>bpu yourapi.com</code> å³å¯å¯¹ç‰¹å®šè¯·æ±‚å¼€å¯æ–­ç‚¹ã€‚</p>
<hr/>
<h3 data-id="heading-8"><strong>3. æ¨¡æ‹Ÿæ¥å£å“åº”ï¼ˆAutoResponderï¼‰</strong></h3>
<p>AutoResponder æ¨¡å—å¯ç”¨äº Mock æ•°æ®ä¸æ¥å£æ¨¡æ‹Ÿã€‚</p>
<p><strong>ä½¿ç”¨æ–¹æ³•ï¼š</strong></p>
<ol>
<li>æ‰“å¼€ AutoResponder é¢æ¿ï¼›</li>
<li>æ·»åŠ åŒ¹é…è§„åˆ™ï¼ˆæ”¯æŒæ­£åˆ™æˆ–å…³é”®å­—åŒ¹é…ï¼‰ï¼›</li>
<li>æŒ‡å®šæœ¬åœ° JSON æ–‡ä»¶æˆ–è¾“å…¥æ¨¡æ‹Ÿå“åº”å†…å®¹ï¼›</li>
<li>å¯ç”¨è§„åˆ™åï¼Œè¯·æ±‚å°†è‡ªåŠ¨è¿”å›é¢„è®¾æ•°æ®ã€‚</li>
</ol>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong>
åç«¯æ¥å£æœªå¼€å‘æ—¶ï¼Œå‰ç«¯å¯é€šè¿‡ Fiddler æ¨¡æ‹Ÿè¿”å› JSON æ•°æ®ï¼Œæå‰éªŒè¯é¡µé¢é€»è¾‘ï¼Œå®ç°å‰åç«¯è§£è€¦è°ƒè¯•ã€‚</p>
<hr/>
<h3 data-id="heading-9"><strong>4. æ„é€ ä¸é‡æ”¾è¯·æ±‚ï¼ˆComposerï¼‰</strong></h3>
<p>Composer æ¨¡å—ç›¸å½“äºå†…ç½®ç‰ˆ Postmanã€‚
ä½ å¯ä»¥å¤åˆ¶è¯·æ±‚ã€ä¿®æ”¹å‚æ•°ã€ç¼–è¾‘ Header å¹¶é‡æ”¾ï¼Œ
å®ç°æ¥å£æµ‹è¯•ä¸éªŒè¯ã€‚</p>
<p><strong>åº”ç”¨ä¸¾ä¾‹ï¼š</strong></p>
<ul>
<li>æµ‹è¯•ç­¾åä¸ Tokenï¼›</li>
<li>éªŒè¯å‚æ•°æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼›</li>
<li>å¿«é€Ÿé‡ç°çº¿ä¸Š Bugã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-10"><strong>5. æ€§èƒ½åˆ†æï¼ˆTimelineï¼‰</strong></h3>
<p>Timeline èƒ½å±•ç¤ºæ¯ä¸ªè¯·æ±‚çš„ç”Ÿå‘½å‘¨æœŸï¼š
DNS æŸ¥è¯¢ â†’ TCP å»ºç«‹ â†’ TLS æ¡æ‰‹ â†’ æœåŠ¡å™¨å“åº” â†’ æ•°æ®ä¸‹è½½ã€‚</p>
<p>é€šè¿‡å¯è§†åŒ–çš„æ—¶åºåˆ†æï¼Œå¼€å‘è€…å¯è½»æ¾è¯†åˆ«æ€§èƒ½ç“¶é¢ˆï¼Œåˆ¤æ–­å»¶è¿Ÿæ˜¯å¦æ¥è‡ªç½‘ç»œã€æœåŠ¡å™¨è¿˜æ˜¯å‰ç«¯èµ„æºåŠ è½½ã€‚</p>
<hr/>
<h2 data-id="heading-11"><strong>å››ã€Fiddlerå®æˆ˜æ¡ˆä¾‹ï¼šä¸€æ¬¡â€œæ— å“åº”è¯·æ±‚â€çš„æ’æŸ¥è¿‡ç¨‹</strong></h2>
<p>æŸæ¬¡åœ¨è°ƒè¯• App æ¥å£æ—¶ï¼Œå‘ç°è¯·æ±‚æ€»æ˜¯å¡åœ¨â€œåŠ è½½ä¸­â€ï¼Œæ²¡æœ‰ä»»ä½•å“åº”ã€‚
åç«¯ç¡®è®¤æœåŠ¡æ­£å¸¸ï¼Œå‰ç«¯æ—¥å¿—æ— å¼‚å¸¸ã€‚</p>
<p>é€šè¿‡ Fiddler æŠ“åŒ…å‘ç°ï¼Œè¯·æ±‚è¢«æµè§ˆå™¨ç¼“å­˜ç­–ç•¥æ‹¦æˆªï¼ŒæœªçœŸæ­£å‘é€åˆ°æœåŠ¡å™¨ã€‚
ç¦ç”¨ç¼“å­˜åï¼Œä¸€åˆ‡æ¢å¤æ­£å¸¸ã€‚</p>
<p>å¾ˆå¤šâ€œè¯·æ±‚å¤±è´¥â€çš„é—®é¢˜ï¼Œå…¶å®è¯·æ±‚æ ¹æœ¬æ²¡æœ‰å‘å‡ºå»ã€‚
æŠ“åŒ…å·¥å…·èƒ½è®©ä½ å¿«é€Ÿåˆ¤æ–­é—®é¢˜å‡ºåœ¨å“ªä¸€å±‚ï¼Œè€Œä¸æ˜¯ç›²ç›®çŒœæµ‹ã€‚</p>
<hr/>
<h2 data-id="heading-12"><strong>äº”ã€Fiddlerå¸¸ç”¨åŠŸèƒ½é€Ÿè§ˆ</strong></h2>



































<table><thead><tr><th>åŠŸèƒ½æ¨¡å—</th><th>ä¸»è¦ä½œç”¨</th><th>åº”ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>Filters</strong></td><td>æŒ‰åŸŸåæˆ–å…³é”®å­—è¿‡æ»¤è¯·æ±‚</td><td>èšç„¦å…³é”®æ¥å£è°ƒè¯•</td></tr><tr><td><strong>AutoResponder</strong></td><td>æ¨¡æ‹Ÿæ¥å£è¿”å›</td><td>å‰åç«¯ç‹¬ç«‹å¼€å‘</td></tr><tr><td><strong>Breakpoints</strong></td><td>æ‹¦æˆªä¸ä¿®æ”¹è¯·æ±‚</td><td>æ¨¡æ‹Ÿå¼‚å¸¸åœºæ™¯</td></tr><tr><td><strong>Composer</strong></td><td>æ„é€ ä¸é‡æ”¾è¯·æ±‚</td><td>API è°ƒè¯•ä¸å¤ç°</td></tr><tr><td><strong>Timeline</strong></td><td>è¯·æ±‚è€—æ—¶åˆ†æ</td><td>ç½‘ç»œä¼˜åŒ–ä¸æ€§èƒ½æµ‹è¯•</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-13"><strong>å…­ã€Fiddlerä¸å…¶ä»–å·¥å…·çš„å¯¹æ¯”</strong></h2>






























<table><thead><tr><th>å·¥å…·</th><th>ä¼˜åŠ¿</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>Fiddler</strong></td><td>å…è´¹ã€å¼ºå¤§ã€æ”¯æŒè¯·æ±‚ä¿®æ”¹ä¸Mock</td><td>å¼€å‘ / æµ‹è¯•</td></tr><tr><td><strong>Charles</strong></td><td>æ“ä½œç®€æ´ã€ç•Œé¢ç›´è§‚</td><td>æ–°æ‰‹è°ƒè¯•</td></tr><tr><td><strong>Postman</strong></td><td>è¯·æ±‚æ„é€ æ–¹ä¾¿</td><td>API æµ‹è¯•</td></tr><tr><td><strong>Wireshark</strong></td><td>åº•å±‚åè®®åˆ†æèƒ½åŠ›å¼º</td><td>ç½‘ç»œå®‰å…¨ç ”ç©¶</td></tr></tbody></table>
<p>Fiddler çš„ç»¼åˆèƒ½åŠ›æœ€å¼ºï¼Œå°¤å…¶åœ¨æ¥å£è°ƒè¯•ã€è¯·æ±‚ä¿®æ”¹ä¸Mock æ•°æ®æ–¹é¢å‡ ä¹æ— å¯æ›¿ä»£ã€‚</p>
<hr/>
<h2 data-id="heading-14"><strong>ä¸ƒã€å­¦ä¹ ä¸èµ„æºæ¨è</strong></h2>
<p>æƒ³æ›´æ·±å…¥å­¦ä¹  Fiddlerï¼Ÿè®¿é—®**<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.fiddler.hk%2F" target="_blank" title="https://www.fiddler.hk/" ref="nofollow noopener noreferrer">Fiddler ä¸­æ–‡ç½‘</a>**ï¼ŒæŒæ¡ <strong>Fiddlerä½¿ç”¨æ•™ç¨‹</strong>ã€<strong>ä»£ç†è®¾ç½®</strong> ä¸ <strong>è°ƒè¯•æŠ€å·§</strong></p>
<p>ç½‘ç«™å†…å®¹åŒ…æ‹¬ï¼š</p>
<ul>
<li>å®‰è£…ä¸é…ç½®æ•™ç¨‹ï¼›</li>
<li>HTTPS æŠ“åŒ…è®¾ç½®ï¼›</li>
<li>ç§»åŠ¨ç«¯ä»£ç†ä¸è¯ä¹¦é…ç½®ï¼›</li>
<li>å¸¸è§é”™è¯¯è§£å†³æ–¹æ¡ˆï¼›</li>
<li>é«˜é˜¶è°ƒè¯•ä¸æ€§èƒ½ä¼˜åŒ–æŠ€å·§ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¯¹è±¡å±•å¼€è¿ç®—ç¬¦ ... è¯¦è§£]]></title>    <link>https://juejin.cn/post/7574318108720496686</link>    <guid>https://juejin.cn/post/7574318108720496686</guid>    <pubDate>2025-11-20T02:25:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574318108720496686" data-draft-id="7574318108720398382" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¯¹è±¡å±•å¼€è¿ç®—ç¬¦ ... è¯¦è§£"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-11-20T02:25:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å€šæ å¬é£é›¨"/> <meta itemprop="url" content="https://juejin.cn/user/2682464103830750"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¯¹è±¡å±•å¼€è¿ç®—ç¬¦ ... è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2682464103830750/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å€šæ å¬é£é›¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T02:25:16.000Z" title="Thu Nov 20 2025 02:25:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. åŸºæœ¬æ¦‚å¿µ</h2>
<p>å¯¹è±¡å±•å¼€è¿ç®—ç¬¦ï¼ˆSpread Operatorï¼‰<code>...</code>Â æ˜¯ ES6 ä¸­å¼•å…¥çš„é‡è¦ç‰¹æ€§ï¼Œç”¨äºå±•å¼€å¯¹è±¡çš„å¯æšä¸¾å±æ€§ã€‚</p>
<h2 data-id="heading-1">2. åŸºæœ¬è¯­æ³•</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> newObj = { ...originalObj };
</code></pre>
<h2 data-id="heading-2">3. ä¸»è¦ç”¨é€”</h2>
<h3 data-id="heading-3">3.1 å¯¹è±¡æµ…æ‹·è´</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> person = { <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> };
<span class="hljs-keyword">const</span> copy = { ...person };

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(copy); <span class="hljs-comment">// { name: 'Alice', age: 25 }</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(copy === person); <span class="hljs-comment">// false (ä¸åŒå¼•ç”¨)</span>
</code></pre>
<h3 data-id="heading-4">3.2 åˆå¹¶å¯¹è±¡</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> obj1 = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> };
<span class="hljs-keyword">const</span> obj2 = { <span class="hljs-attr">c</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">d</span>: <span class="hljs-number">4</span> };
<span class="hljs-keyword">const</span> merged = { ...obj1, ...obj2 };

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(merged); <span class="hljs-comment">// { a: 1, b: 2, c: 3, d: 4 }</span>
</code></pre>
<h3 data-id="heading-5">3.3 å±æ€§è¦†ç›–</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> defaults = { <span class="hljs-attr">theme</span>: <span class="hljs-string">'light'</span>, <span class="hljs-attr">fontSize</span>: <span class="hljs-number">16</span> };
<span class="hljs-keyword">const</span> userSettings = { <span class="hljs-attr">fontSize</span>: <span class="hljs-number">18</span>, <span class="hljs-attr">language</span>: <span class="hljs-string">'en'</span> };

<span class="hljs-keyword">const</span> finalSettings = { ...defaults, ...userSettings };
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(finalSettings); <span class="hljs-comment">// { theme: 'light', fontSize: 18, language: 'en' }</span>
</code></pre>
<h3 data-id="heading-6">3.4 æ·»åŠ æ–°å±æ€§</h3>
<p>javascript</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">base</span> = { x: <span class="hljs-number">1</span>, y: <span class="hljs-number">2</span> }<span class="hljs-comment">;</span>
const <span class="hljs-attr">extended</span> = { ...base, z: <span class="hljs-number">3</span>, color: <span class="hljs-string">'red'</span> }<span class="hljs-comment">;</span>

console.log(extended)<span class="hljs-comment">; // { x: 1, y: 2, z: 3, color: 'red' }</span>
</code></pre>
<h2 data-id="heading-7">4. æ·±åº¦ç‰¹æ€§</h2>
<h3 data-id="heading-8">4.1 å±•å¼€é¡ºåºçš„é‡è¦æ€§</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> objA = { <span class="hljs-attr">prop</span>: <span class="hljs-string">'A'</span> };
<span class="hljs-keyword">const</span> objB = { <span class="hljs-attr">prop</span>: <span class="hljs-string">'B'</span> };

<span class="hljs-keyword">const</span> result1 = { ...objA, ...objB }; <span class="hljs-comment">// { prop: 'B' }</span>
<span class="hljs-keyword">const</span> result2 = { ...objB, ...objA }; <span class="hljs-comment">// { prop: 'A' }</span>
</code></pre>
<h3 data-id="heading-9">4.2 ä¸è§£æ„èµ‹å€¼ç»“åˆ  ========ã€‹</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> user = { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'John'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">'john@example.com'</span> };

<span class="hljs-comment">// æå–ç‰¹å®šå±æ€§ï¼Œå‰©ä½™å±æ€§æ”¾å…¥restå¯¹è±¡</span>
<span class="hljs-keyword">const</span> { id, name, ...rest } = user;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(id);   <span class="hljs-comment">// 1</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name); <span class="hljs-comment">// John</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rest); <span class="hljs-comment">// { age: 30, email: 'john@example.com' }</span>
</code></pre>
<h3 data-id="heading-10">4.3 æ¡ä»¶å±•å¼€</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> condition = <span class="hljs-literal">true</span>;
<span class="hljs-keyword">const</span> extraProps = condition ? { <span class="hljs-attr">admin</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">role</span>: <span class="hljs-string">'editor'</span> } : {};

<span class="hljs-keyword">const</span> user = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>,
  ...extraProps
};

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user); <span class="hljs-comment">// { name: 'Alice', admin: true, role: 'editor' }</span>
</code></pre>
<h2 data-id="heading-11">5. å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-12">5.1 React çŠ¶æ€æ›´æ–°</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸å¯å˜çŠ¶æ€æ›´æ–°</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(<span class="hljs-function"><span class="hljs-params">prevState</span> =&gt;</span> ({
  ...prevState,
  <span class="hljs-attr">count</span>: prevState.<span class="hljs-property">count</span> + <span class="hljs-number">1</span>
}));
</code></pre>
<h3 data-id="heading-13">5.2 å‡½æ•°å‚æ•°å¤„ç†</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">processUser</span>(<span class="hljs-params">baseInfo, additionalInfo</span>) {
  <span class="hljs-keyword">return</span> {
    ...baseInfo,
    ...additionalInfo,
    <span class="hljs-attr">processed</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
  };
}

<span class="hljs-keyword">const</span> user = <span class="hljs-title function_">processUser</span>(
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> },
  { <span class="hljs-attr">email</span>: <span class="hljs-string">'bob@example.com'</span> }
);
</code></pre>
<h3 data-id="heading-14">5.3 é…ç½®åˆå¹¶</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> defaultConfig = {
  <span class="hljs-attr">apiUrl</span>: <span class="hljs-string">'https://api.example.com'</span>,
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span>,
  <span class="hljs-attr">retries</span>: <span class="hljs-number">3</span>
};

<span class="hljs-keyword">const</span> userConfig = {
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>,
  <span class="hljs-attr">apiKey</span>: <span class="hljs-string">'12345'</span>
};

<span class="hljs-keyword">const</span> finalConfig = {
  ...defaultConfig,
  ...userConfig
};
</code></pre>
<h2 data-id="heading-15">6. æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-16">6.1 æµ…æ‹·è´é—®é¢˜</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> original = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Test'</span>,
  <span class="hljs-attr">nested</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">1</span> }
};

<span class="hljs-keyword">const</span> copy = { ...original };
copy.<span class="hljs-property">nested</span>.<span class="hljs-property">value</span> = <span class="hljs-number">2</span>;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(original.<span class="hljs-property">nested</span>.<span class="hljs-property">value</span>); <span class="hljs-comment">// 2 (è¢«ä¿®æ”¹äº†!)</span>
</code></pre>
<h3 data-id="heading-17">6.2 åŸå‹é“¾å±æ€§</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'animal'</span>;
  }
}

<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">speak</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> <span class="hljs-string">'sound'</span>; };

<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();
dog.<span class="hljs-property">breed</span> = <span class="hljs-string">'Labrador'</span>;

<span class="hljs-keyword">const</span> copy = { ...dog };
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(copy.<span class="hljs-property">type</span>);    <span class="hljs-comment">// 'animal'</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(copy.<span class="hljs-property">breed</span>);   <span class="hljs-comment">// 'Labrador'</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(copy.<span class="hljs-property">speak</span>);   <span class="hljs-comment">// undefined (åŸå‹æ–¹æ³•ä¸ä¼šè¢«å¤åˆ¶)</span>
</code></pre>
<h3 data-id="heading-18">6.3 ä¸å¯æšä¸¾å±æ€§</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> obj = {};
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, <span class="hljs-string">'hidden'</span>, {
  <span class="hljs-attr">value</span>: <span class="hljs-string">'secret'</span>,
  <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>
});

obj.<span class="hljs-property">visible</span> = <span class="hljs-string">'can see'</span>;

<span class="hljs-keyword">const</span> spread = { ...obj };
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(spread); <span class="hljs-comment">// { visible: 'can see' }</span>
</code></pre>
<h2 data-id="heading-19">7. ä¸æ•°ç»„å±•å¼€çš„åŒºåˆ«</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ•°ç»„å±•å¼€</span>
<span class="hljs-keyword">const</span> arr1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">const</span> arr2 = [...arr1, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]; <span class="hljs-comment">// [1, 2, 3, 4, 5]</span>

<span class="hljs-comment">// å¯¹è±¡å±•å¼€</span>
<span class="hljs-keyword">const</span> obj1 = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> };
<span class="hljs-keyword">const</span> obj2 = { ...obj1, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }; <span class="hljs-comment">// { a: 1, b: 2, c: 3 }</span>

<span class="hljs-comment">// æ•°ç»„è½¬ä¸ºå¯¹è±¡</span>
<span class="hljs-keyword">const</span> array = [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>];
<span class="hljs-keyword">const</span> objectFromArray = { ...array }; <span class="hljs-comment">// { 0: 'a', 1: 'b', 2: 'c' }</span>
</code></pre>
<h2 data-id="heading-20">8. æµè§ˆå™¨å…¼å®¹æ€§</h2>
<p>å¯¹è±¡å±•å¼€è¿ç®—ç¬¦åœ¨ç°ä»£æµè§ˆå™¨ä¸­å¾—åˆ°è‰¯å¥½æ”¯æŒï¼Œä½†åœ¨æ—§ç‰ˆæµè§ˆå™¨ä¸­å¯èƒ½éœ€è¦ä½¿ç”¨ Babel ç­‰å·¥å…·è¿›è¡Œè½¬è¯‘ã€‚</p>
<h2 data-id="heading-21">æ€»ç»“</h2>
<p>å¯¹è±¡å±•å¼€è¿ç®—ç¬¦Â <code>...</code>Â æ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”çµæ´»çš„å·¥å…·ï¼Œå®ƒï¼š</p>
<ul>
<li>æä¾›ç®€æ´çš„å¯¹è±¡å¤åˆ¶å’Œåˆå¹¶è¯­æ³•</li>
<li>æ”¯æŒä¸å¯å˜æ•°æ®æ¨¡å¼</li>
<li>æé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§</li>
<li>åœ¨å¤„ç†é…ç½®ã€çŠ¶æ€ç®¡ç†ç­‰åœºæ™¯ä¸­ç‰¹åˆ«æœ‰ç”¨</li>
</ul>
<p>ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„å…¶æµ…æ‹·è´çš„ç‰¹æ€§ï¼Œå¯¹äºåµŒå¥—å¯¹è±¡éœ€è¦é¢å¤–çš„æ·±æ‹·è´å¤„ç†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºLangSmithçš„æç¤ºè¯å·¥ç¨‹]]></title>    <link>https://juejin.cn/post/7574584245109276723</link>    <guid>https://juejin.cn/post/7574584245109276723</guid>    <pubDate>2025-11-20T00:54:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574584245109276723" data-draft-id="7574322843048755250" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºLangSmithçš„æç¤ºè¯å·¥ç¨‹"/> <meta itemprop="keywords" content="LangChain,Agent,Python"/> <meta itemprop="datePublished" content="2025-11-20T00:54:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="FreeCode"/> <meta itemprop="url" content="https://juejin.cn/user/1282499717900794"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºLangSmithçš„æç¤ºè¯å·¥ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1282499717900794/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    FreeCode
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T00:54:35.000Z" title="Thu Nov 20 2025 00:54:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><p>æç¤ºè¯ï¼ˆPromptï¼‰ç”¨äºå¼•å¯¼å¤§æ¨¡å‹ï¼ˆLLMï¼‰çš„è¡Œä¸ºã€‚æç¤ºè¯å·¥ç¨‹ï¼ˆPrompt Engineeringï¼‰æ˜¯æŒ‡è®¾è®¡ã€æµ‹è¯•å¹¶ä¼˜åŒ–ç»™å¤§æ¨¡å‹çš„æŒ‡ä»¤ï¼Œä»¥ä½¿å…¶ç”Ÿæˆå¯é ä¸”æœ‰ç”¨çš„å“åº”çš„è¿‡ç¨‹ã€‚</p>
<p>LangSmithæä¾›äº†ç”¨äºåˆ›å»ºã€ç‰ˆæœ¬æ§åˆ¶ã€æµ‹è¯•æç¤ºè¯ä»¥åŠè¿›è¡Œåä½œçš„å·¥å…·ã€‚å¦å¤–è¿˜æœ‰ä¸€äº›å¸¸è§æ¦‚å¿µï¼Œä¾‹å¦‚æç¤ºè¯æ¨¡æ¿ï¼ˆPrompt Templatesï¼‰â€”â€” å¯è®©ä½ å¤ç”¨ç»“æ„åŒ–çš„æç¤ºè¯ï¼Œä»¥åŠå˜é‡ï¼ˆVariablesï¼‰â€”â€” èƒ½è®©ä½ åœ¨æç¤ºè¯ä¸­åŠ¨æ€æ’å…¥å€¼ï¼ˆä¾‹å¦‚ç”¨æˆ·çš„é—®é¢˜ï¼‰ã€‚</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œä½ å°†é€šè¿‡è½¯ä»¶å¼€å‘å·¥å…·åŒ…ï¼ˆSDKï¼‰æ¥åˆ›å»ºã€æµ‹è¯•å¹¶ä¼˜åŒ–æç¤ºè¯ã€‚æœ¬æŒ‡å—ä»¥OpenAIä½œä¸ºç¤ºä¾‹å¤§æ¨¡å‹æä¾›å•†ï¼Œä½†ç›¸åŒçš„å·¥ä½œæµç¨‹ä¹Ÿé€‚ç”¨äºå…¶ä»–æä¾›å•†ã€‚</p>
<h2 data-id="heading-0">å‡†å¤‡</h2>
<p>å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ å·²å…·å¤‡ä»¥ä¸‹æ¡ä»¶ï¼š</p>
<ul>
<li>ä¸€ä¸ª LangSmith è´¦å·ï¼šå¯å‰å¾€ smith.langchain.com æ³¨å†Œæˆ–ç™»å½•ã€‚</li>
<li>ä¸€ä¸ª LangSmith API å¯†é’¥ï¼šè¯·å‚è€ƒã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.langchain.com%2Flangsmith%2Fcreate-account-api-key%23create-an-api-key" target="_blank" title="https://docs.langchain.com/langsmith/create-account-api-key#create-an-api-key" ref="nofollow noopener noreferrer">åˆ›å»º API å¯†é’¥æŒ‡å—</a>ã€‹æ“ä½œã€‚</li>
<li>ä¸€ä¸ª OpenAI API å¯†é’¥ï¼šå¯ä»OpenAIæ§åˆ¶å°ç”Ÿæˆã€‚</li>
</ul>
<h2 data-id="heading-1">æ­å»ºç¯å¢ƒ</h2>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> ls-prompt-quickstart &amp;&amp; <span class="hljs-built_in">cd</span> ls-prompt-quickstart
python -m venv .venv
<span class="hljs-built_in">source</span> .venv/bin/activate
pip install -qU langsmith openai langchain_core
<span class="hljs-built_in">export</span> LANGSMITH_API_KEY=<span class="hljs-string">'&lt;your_api_key&gt;'</span>
<span class="hljs-built_in">export</span> OPENAI_API_KEY=<span class="hljs-string">'&lt;your_api_key&gt;'</span>
</code></pre>
<h2 data-id="heading-2">åˆ›å»ºæç¤ºè¯</h2>
<p>è¦åˆ›å»ºæç¤ºè¯ï¼Œä½ éœ€è¦å…ˆå®šä¹‰æç¤ºè¯ä¸­æ‰€éœ€çš„æ¶ˆæ¯åˆ—è¡¨ï¼Œç„¶åå°†å…¶æ¨é€åˆ°LangSmithå¹³å°ã€‚
ä½¿ç”¨å¯¹åº”ç¼–ç¨‹è¯­è¨€çš„æ„é€ å‡½æ•°ä¸æ¨é€æ–¹æ³•ï¼š</p>
<ul>
<li>Pythonï¼šé€šè¿‡ ChatPromptTemplate æ„å»º â†’ è°ƒç”¨ client.push_prompt(...) æ¨é€</li>
<li>TypeScriptï¼šé€šè¿‡ ChatPromptTemplate.fromMessages(...) æ„å»º â†’ è°ƒç”¨ client.pushPrompt(...) æ¨é€ã€‚</li>
</ul>
<p>åœ¨ create_prompt.pyæ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langsmith <span class="hljs-keyword">import</span> Client
<span class="hljs-keyword">from</span> langchain_core.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate

client = Client()

prompt = ChatPromptTemplate([
    (<span class="hljs-string">"system"</span>, <span class="hljs-string">"You are a helpful chatbot."</span>),
    (<span class="hljs-string">"user"</span>, <span class="hljs-string">"{question}"</span>),
])

client.push_prompt(<span class="hljs-string">"prompt-quickstart"</span>, <span class="hljs-built_in">object</span>=prompt)
</code></pre>
<p>æ­¤æ“ä½œä¼šåˆ›å»ºä¸€ä¸ªæœ‰åºçš„æ¶ˆæ¯åˆ—è¡¨ï¼Œå°†å…¶å°è£…åˆ° ChatPromptTemplateï¼ˆå¯¹è¯æç¤ºè¯æ¨¡æ¿ï¼‰ä¸­ï¼Œç„¶åæŒ‰åç§°å°†è¯¥æç¤ºè¯æ¨é€åˆ°ä½ çš„å·¥ä½œåŒºï¼Œä»¥ä¾¿è¿›è¡Œç‰ˆæœ¬æ§åˆ¶å’Œå¤ç”¨ã€‚</p>
<p>æ‰§è¡Œè„šæœ¬ï¼š
<code>python create_prompt.py</code></p>
<p>ç‚¹å‡»ç”Ÿæˆçš„é“¾æ¥ï¼Œå³å¯åœ¨ LangSmith ç”¨æˆ·ç•Œé¢ï¼ˆUIï¼‰ä¸­æŸ¥çœ‹æ–°åˆ›å»ºçš„ â€œæç¤ºè¯ä¸­å¿ƒâ€ï¼ˆPrompt Hubï¼‰æç¤ºè¯ã€‚</p>
<h2 data-id="heading-3">æµ‹è¯•æç¤ºè¯</h2>
<p>åœ¨æœ¬æ­¥éª¤ä¸­ï¼Œä½ å°†é€šè¿‡åç§°ï¼ˆ"prompt-quickstart"ï¼‰æ‹‰å–ä¸Šä¸€æ­¥åˆ›å»ºçš„æç¤ºè¯ï¼Œç”¨æµ‹è¯•è¾“å…¥å¯¹å…¶è¿›è¡Œæ ¼å¼åŒ–ï¼Œè½¬æ¢ä¸º OpenAI çš„å¯¹è¯æ ¼å¼ï¼Œç„¶åè°ƒç”¨OpenAIçš„Chat Completions APIã€‚</p>
<p>ä¹‹åï¼Œä½ å¯ä»¥é€šè¿‡åˆ›å»ºæ–°ç‰ˆæœ¬æ¥è¿­ä»£ä¼˜åŒ–è¯¥æç¤ºè¯ã€‚å·¥ä½œåŒºæˆå‘˜å¯æ‰“å¼€å·²æœ‰æç¤ºè¯ï¼Œåœ¨ç”¨æˆ·ç•Œé¢ï¼ˆUIï¼‰ä¸­å°è¯•ä¿®æ”¹ï¼Œå¹¶å°†è¿™äº›ä¿®æ”¹ä¿å­˜ä¸ºè¯¥æç¤ºè¯çš„æ–°æäº¤è®°å½•ï¼Œä»è€Œä¸ºæ•´ä¸ªå›¢é˜Ÿä¿ç•™å†å²ç‰ˆæœ¬è®°å½•ã€‚</p>
<p>åœ¨ test_prompt.pyæ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langsmith <span class="hljs-keyword">import</span> Client
<span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> OpenAI
<span class="hljs-keyword">from</span> langchain_core.messages <span class="hljs-keyword">import</span> convert_to_openai_messages

client = Client()
oai_client = OpenAI()

prompt = client.pull_prompt(<span class="hljs-string">"prompt-quickstart"</span>)

<span class="hljs-comment"># Since the prompt only has one variable you could also pass in the value directly</span>
<span class="hljs-comment"># Equivalent to formatted_prompt = prompt.invoke("What is the color of the sky?")</span>
formatted_prompt = prompt.invoke({<span class="hljs-string">"question"</span>: <span class="hljs-string">"What is the color of the sky?"</span>})

response = oai_client.chat.completions.create(
    model=<span class="hljs-string">"gpt-4o"</span>,
    messages=convert_to_openai_messages(formatted_prompt.messages),
)
</code></pre>
<p>æ­¤æ“ä½œä¼šé€šè¿‡åç§°åŠ è½½æç¤ºè¯ï¼Œä½¿ç”¨ pullï¼ˆæ‹‰å–ï¼‰æ–¹æ³•è·å–ä½ æ­£åœ¨æµ‹è¯•çš„æç¤ºè¯çš„æœ€æ–°æäº¤ç‰ˆæœ¬ã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä¼ å…¥"æäº¤å“ˆå¸Œå€¼"ï¼ˆæ ¼å¼ä¸º :ï¼‰æ¥æŒ‡å®šæŸä¸ªç‰¹å®šçš„æäº¤ç‰ˆæœ¬ã€‚</p>
<p>æ‰§è¡Œæµ‹è¯•ï¼š
<code>python test_prompt.py</code></p>
<p>è‹¥è¦åˆ›å»ºæç¤ºè¯çš„æ–°ç‰ˆæœ¬ï¼Œåªéœ€ä½¿ç”¨åˆå§‹æ—¶çš„ç›¸åŒæ¨é€æ–¹æ³•ï¼Œä¼ å…¥ç›¸åŒçš„æç¤ºè¯åç§°å’Œæ›´æ–°åçš„æ¨¡æ¿å³å¯ã€‚LangSmithä¼šå°†å…¶è®°å½•ä¸ºæ–°çš„æäº¤è®°å½•ï¼Œå¹¶ä¿ç•™ä¹‹å‰çš„ç‰ˆæœ¬ã€‚</p>
<p>å°†ä»¥ä¸‹ä»£ç å¤åˆ¶åˆ° iterate_prompt.pyæ–‡ä»¶ä¸­ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langsmith <span class="hljs-keyword">import</span> Client
<span class="hljs-keyword">from</span> langchain_core.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate

client = Client()

new_prompt = ChatPromptTemplate([
    (<span class="hljs-string">"system"</span>, <span class="hljs-string">"You are a helpful chatbot. Respond in Spanish."</span>),
    (<span class="hljs-string">"user"</span>, <span class="hljs-string">"{question}"</span>),
])

client.push_prompt(<span class="hljs-string">"prompt-quickstart"</span>, <span class="hljs-built_in">object</span>=new_prompt)
</code></pre>
<p>æ‰§è¡Œè„šæœ¬ï¼š
<code>python iterate_prompt.py</code></p>
<p>ç°åœ¨ä½ çš„æç¤ºè¯å°†åŒ…å«ä¸¤æ¡æäº¤è®°å½•ã€‚</p>
<p>å¦‚éœ€ä¼˜åŒ–ä½ çš„æç¤ºè¯ï¼Œå¯å‚è€ƒä»¥ä¸‹æ–¹å¼ï¼š</p>
<ul>
<li>æŸ¥é˜…æ¨¡å‹æä¾›å•†æä¾›çš„æ–‡æ¡£ï¼Œè·å–æç¤ºè¯åˆ›å»ºçš„æœ€ä½³å®è·µï¼Œä¾‹å¦‚ï¼š
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhelp.openai.com%2Fen%2Farticles%2F6654000-best-practices-for-prompt-engineering-with-the-openai-api" target="_blank" title="https://help.openai.com/en/articles/6654000-best-practices-for-prompt-engineering-with-the-openai-api" ref="nofollow noopener noreferrer">ã€ŠOpenAI API æç¤ºè¯å·¥ç¨‹æœ€ä½³å®è·µã€‹</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fai.google.dev%2Fgemini-api%2Fdocs%2Fprompting-intro" target="_blank" title="https://ai.google.dev/gemini-api/docs/prompting-intro" ref="nofollow noopener noreferrer">ã€ŠGemini æç¤ºè¯è®¾è®¡å…¥é—¨ã€‹</a></li>
</ul>
</li>
<li>ä½¿ç”¨ LangSmith ä¸­çš„äº¤äº’å¼å·¥å…· â€”â€”â€œæç¤ºè¯ç”»å¸ƒâ€ï¼ˆPrompt Canvasï¼‰æ„å»ºå¹¶ä¼˜åŒ–æç¤ºè¯ã€‚æ›´å¤šè¯¦æƒ…å¯å‚è€ƒã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.langchain.com%2Flangsmith%2Fwrite-prompt-with-ai" target="_blank" title="https://docs.langchain.com/langsmith/write-prompt-with-ai" ref="nofollow noopener noreferrer">æç¤ºè¯ç”»å¸ƒæŒ‡å—</a>ã€‹ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤šæ™ºèƒ½ä½“ç³»ç»Ÿçš„ä¸Šä¸‹æ–‡å·¥ç¨‹â€”â€”æ„å»ºä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7574321422400274458</link>    <guid>https://juejin.cn/post/7574321422400274458</guid>    <pubDate>2025-11-19T15:59:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574321422400274458" data-draft-id="7574322843048427570" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤šæ™ºèƒ½ä½“ç³»ç»Ÿçš„ä¸Šä¸‹æ–‡å·¥ç¨‹â€”â€”æ„å»ºä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ"/> <meta itemprop="keywords" content="MCP,Agent,LLM"/> <meta itemprop="datePublished" content="2025-11-19T15:59:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ•°æ®æ™ºèƒ½è€å¸æœº"/> <meta itemprop="url" content="https://juejin.cn/user/430664289626439"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤šæ™ºèƒ½ä½“ç³»ç»Ÿçš„ä¸Šä¸‹æ–‡å·¥ç¨‹â€”â€”æ„å»ºä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/430664289626439/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ•°æ®æ™ºèƒ½è€å¸æœº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-19T15:59:32.000Z" title="Wed Nov 19 2025 15:59:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»34åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ä¸Šä¸€ç« ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ MCP æ„å»ºäº†ä¸€ä¸ªå¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼ˆMulti-Agent Systemï¼ŒMASï¼‰ã€‚è¿™ä¸ªç³»ç»Ÿå¯ä»¥å·¥ä½œï¼Œä½†æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å±€é™ï¼šå®ƒçš„â€œçŸ¥è¯†â€éƒ½æ˜¯æ¨¡æ‹Ÿå‡ºæ¥çš„ã€‚å¯¹äºå­¦ä¹ æ¥è¯´è¿™æ²¡é—®é¢˜ï¼Œä½†ä¹Ÿæ„å‘³ç€è¿™äº›æ™ºèƒ½ä½“è¢«å›°åœ¨äº†æˆ‘ä»¬é¢„å…ˆè®¾è®¡å¥½çš„æ²™ç›’é‡Œï¼šå®ƒä»¬ä¸èƒ½è®¿é—®çœŸå®ä¿¡æ¯ï¼Œä¹Ÿæ— æ³•æ ¹æ®å½“å‰ç¯å¢ƒå³æ—¶è°ƒæ•´è¡Œä¸ºã€‚<br/>
åœ¨è¿™ä¸€ç« ï¼Œæˆ‘ä»¬è¦æŠŠå®ƒä»¬ä»ç›’å­é‡Œâ€œæ”¾å‡ºæ¥â€â€”â€”è®©æ™ºèƒ½ä½“é€šè¿‡åŸºäºå‘é‡å­˜å‚¨ï¼ˆvector storeï¼‰æ„å»ºçš„å®æ—¶ä¿¡æ¯ç®¡é“ï¼Œè¿æ¥åˆ°å¤–éƒ¨æ•°æ®ã€‚</p>
<p>ç²¾å½©çš„éƒ¨åˆ†ç°åœ¨æ‰å¼€å§‹ã€‚æˆ‘ä»¬å°†å¼•å…¥ä¸€ä¸ªæ›´å¼ºå¤§çš„æ¶æ„ï¼š<strong>åŒ RAG å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼ˆdual RAG MASï¼‰</strong> ã€‚<br/>
å®ƒä¼šç”¨ä¸¤ç§æ–¹å¼æ¥ä½¿ç”¨æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRetrieval-Augmented Generationï¼ŒRAGï¼‰ï¼š</p>
<ol>
<li>ç¬¬ä¸€ç§æ˜¯ä½ ç†Ÿæ‚‰çš„ï¼šä»çŸ¥è¯†åº“ä¸­æ£€ç´¢äº‹å®ï¼›</li>
<li>ç¬¬äºŒç§åˆ™æ˜¯æ–°çš„ï¼šæ£€ç´¢â€œè¿‡ç¨‹æ€§æŒ‡ä»¤â€ï¼Œä¹Ÿå°±æ˜¯å®ç°<strong>è¿‡ç¨‹åŒ– / åŠ¨æ€ RAG</strong>æ‰€éœ€çš„â€œæ‰§è¡Œè„šæœ¬â€ã€‚</li>
</ol>
<p>è¿™ç§æ–°å¢èƒ½åŠ›æ”¹å˜äº†æ¸¸æˆè§„åˆ™ï¼š<br/>
ç³»ç»Ÿä¸ä»…èƒ½â€œå­¦ä¼šè¯´ä»€ä¹ˆï¼ˆwhat to sayï¼‰â€ï¼Œè¿˜å¯ä»¥â€œå­¦ä¼šæ€ä¹ˆè¯´ï¼ˆhow to say itï¼‰â€ï¼Œå¹¶èƒ½æŒ‰éœ€åˆ‡æ¢é£æ ¼å’Œç»“æ„ã€‚</p>
<p>æˆ‘ä»¬ä¼šåœ¨ä¸¤ä¸ª Notebook ä¸­ä¸€æ­¥æ­¥æ„å»ºè¿™ä¸€ç³»ç»Ÿï¼š</p>
<ul>
<li>ç¬¬ä¸€ä¸ª Notebook èšç„¦äº<strong>æ•°æ®æ‘„å…¥ï¼ˆingestionï¼‰</strong> ï¼š<br/>
æˆ‘ä»¬ä¼šä¸ºâ€œäº‹å®â€åˆ›å»ºä¸€ä¸ªçŸ¥è¯†åº“ï¼ˆknowledge baseï¼‰ï¼Œ<br/>
ä¸ºâ€œè¯­ä¹‰è“å›¾ï¼ˆsemantic blueprintsï¼‰â€åˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡åº“ï¼ˆcontext libraryï¼‰ã€‚</li>
<li>ç¬¬äºŒä¸ª Notebook è´Ÿè´£â€œè¿è¡Œæ—¶æ‰§è¡Œï¼ˆruntime executionï¼‰â€ï¼š<br/>
å±•ç¤ºæ™ºèƒ½ä½“å¦‚ä½•åœ¨å®æ—¶æ‰§è¡Œä¸­æ£€ç´¢å¹¶ç»„åˆè¿™ä¸¤ç±»ä¸Šä¸‹æ–‡ã€‚</li>
</ul>
<p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šä»‹ç»ä¸€ä¸ªæ–°çš„ä¸“ä¸šæ™ºèƒ½ä½“ï¼š<strong>ä¸Šä¸‹æ–‡é¦†å‘˜ï¼ˆContext Librarianï¼‰</strong> ï¼Œ<br/>
å¹¶çœ‹åˆ° Orchestratorï¼ˆç¼–æ’å™¨ï¼‰å¦‚ä½•è®©æ•´ä¸ªå›¢é˜Ÿä¿æŒååŒã€‚</p>
<p>æœ¬ç« ä¸»è¦æ¶µç›–ä»¥ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>è®¾è®¡ä¸€ä¸ªåŒ RAG çš„ MAS æ¶æ„</li>
<li>å°†â€œäº‹å®æ€§çŸ¥è¯†â€å’Œâ€œè¿‡ç¨‹æ€§æŒ‡ä»¤â€åˆ†ç¦»ç®¡ç†</li>
<li>ä¸ºäº‹å®æ„å»ºçŸ¥è¯†åº“ï¼ˆKnowledge Baseï¼‰</li>
<li>ä¸ºè¯­ä¹‰è“å›¾åˆ›å»ºä¸Šä¸‹æ–‡åº“ï¼ˆContext Libraryï¼‰</li>
<li>ä½¿ç”¨å‘é‡å­˜å‚¨çš„å‘½åç©ºé—´ï¼ˆnamespaceï¼‰ç®¡ç†ä¸åŒæ•°æ®ç±»å‹</li>
<li>å®ç°æ–°çš„ä¸“ä¸šæ™ºèƒ½ä½“ï¼Œæ¯”å¦‚ Context Librarian</li>
<li>é€šè¿‡ç¼–æ’è®©æ•´ä¸ªç³»ç»Ÿç”Ÿæˆâ€œå…·å¤‡ä¸Šä¸‹æ–‡æ„ŸçŸ¥èƒ½åŠ›â€çš„å†…å®¹</li>
</ul>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…ˆä» RAG MAS çš„æ¶æ„å…¥æ‰‹ã€‚</p>
<h2 data-id="heading-0">è®¾è®¡åŒ RAG MAS æ¶æ„</h2>
<p>Architecting a dual RAG MAS</p>
<p>è¦æ„å»ºè¿™ä¸ªå…·å¤‡ä¸Šä¸‹æ–‡æ„ŸçŸ¥èƒ½åŠ›çš„ç³»ç»Ÿï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ¸…æ™°åœ°ç†è§£å®ƒçš„æ¶æ„ã€‚<br/>
ä»é«˜å±‚æ¥çœ‹ï¼Œæ•´ä¸ªè¿‡ç¨‹è¢«åˆ’åˆ†ä¸ºä¸¤ä¸ªäº’ç›¸ç‹¬ç«‹åˆç›¸äº’å…³è”çš„é˜¶æ®µï¼Œæˆ‘ä»¬ä¼šåˆ†åˆ«è®¾è®¡å’Œå®ç°ï¼š</p>
<ul>
<li><strong>Phase 1ï¼šæ•°æ®å‡†å¤‡ï¼ˆData Preparationï¼‰</strong> â€”â€” è´Ÿè´£æŠŠæ•°æ®å‡†å¤‡å¥½</li>
<li><strong>Phase 2ï¼šè¿è¡Œæ—¶æ‰§è¡Œï¼ˆRuntime Executionï¼‰</strong> â€”â€” MAS ä½¿ç”¨å‡†å¤‡å¥½çš„æ•°æ®æ¥å“åº”ç”¨æˆ·ç›®æ ‡</li>
</ul>
<p>æœ¬ç« ä¼šåœ¨ä¸¤ä¸ªå¯¹åº”çš„ Notebook ä¸­å®Œæˆè¿™ä¸¤ä¸ªé˜¶æ®µã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ee7d34061aa48a8b0d5f1225d21f88b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWw5o2u5pm66IO96ICB5Y-45py6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172772&amp;x-signature=TFNbO%2FeHl6KcmfZNk7DllAZwmIQ%3D" alt="image.png" loading="lazy"/></p>
<p>å›¾ 3.1ï¼šåŒ RAG MAS çš„æ•´ä½“æ¶æ„</p>
<p>ä¸Šå›¾å±•ç¤ºäº†åŒ RAG MAS æ¶æ„ä¸­<strong>æ•°æ®æµä¸æ‰§è¡Œæµ</strong>çš„å…¨è²Œï¼Œç®­å¤´è¡¨ç¤ºç»„ä»¶ä¹‹é—´åœ¨é«˜å±‚ä¸Šçš„è¿æ¥å…³ç³»ã€‚<br/>
åœ¨è¿›å…¥å…·ä½“ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæŒ‰å›¾æŠŠæ¯ä¸ªéƒ¨åˆ†æ¢³ç†ä¸€éã€‚</p>
<h3 data-id="heading-1">é˜¶æ®µä¸€ï¼šæ•°æ®å‡†å¤‡ï¼ˆPhase 1: Data preparationï¼‰</h3>
<p>åœ¨ Phase 1 ä¸­ï¼Œæˆ‘ä»¬ä¸“æ³¨äº<strong>å‡†å¤‡æ•°æ®</strong>ï¼Œè¿™ä¸€éƒ¨åˆ†å¯¹åº”å›¾ 3.1 å·¦ä¾§ã€‚<br/>
ç³»ç»Ÿä»ä¸¤ç±»ä¸åŒçš„è¾“å…¥æºå¼€å§‹ï¼š</p>
<ul>
<li><strong>çŸ¥è¯†æ•°æ®ï¼ˆKnowledge dataï¼‰</strong> ï¼š<br/>
ç³»ç»Ÿåº”è¯¥â€œçŸ¥é“â€çš„<strong>äº‹å®æ€§ä¿¡æ¯</strong></li>
<li><strong>ä¸Šä¸‹æ–‡æ•°æ®ï¼ˆContext dataï¼‰</strong> ï¼š<br/>
ç»“æ„åŒ–æŒ‡ä»¤ï¼Œæˆ–è€…è¯´<strong>è¯­ä¹‰è“å›¾ï¼ˆsemantic blueprintsï¼‰</strong> ï¼Œè¿™åœ¨ç¬¬ 1 ç« ä¸­å·²ç»ä»‹ç»è¿‡</li>
</ul>
<p>è¿™ä¸¤ç±»æ•°æ®éƒ½ç”±åŒä¸€ä¸ª**åµŒå…¥æ¨¡å‹ï¼ˆembedding modelï¼‰**æ¥å¤„ç†ï¼š</p>
<ul>
<li>å¯¹äº<strong>çŸ¥è¯†æ•°æ®</strong>ï¼Œæˆ‘ä»¬ä¼šæŠŠæ–‡æœ¬åˆ‡åˆ†æˆå¤šä¸ª chunkï¼Œå¹¶å¯¹æ¯ä¸ª chunk è¿›è¡Œå‘é‡åŒ–ï¼ˆembeddingï¼‰ã€‚</li>
<li>å¯¹äº<strong>ä¸Šä¸‹æ–‡æ•°æ® / è¯­ä¹‰è“å›¾</strong>ï¼Œæˆ‘ä»¬åªå¯¹â€œè“å›¾æ„å›¾ï¼ˆintentï¼‰çš„æè¿°â€è¿›è¡Œå‘é‡åŒ–ã€‚<br/>
ä¹‹åçš„æ£€ç´¢å°†åŸºäºâ€œæ„å›¾â€æ¥è¿›è¡ŒåŒ¹é…ã€‚<br/>
å®Œæ•´çš„è“å›¾å†…å®¹åˆ™å•ç‹¬å­˜å‚¨åœ¨ä¸€ä¸ª JSON å¯¹è±¡ä¸­ï¼Œå¹¶ä¸å…¶æè¿°å»ºç«‹å…³è”ã€‚</li>
</ul>
<p>æ‰€æœ‰çš„å‘é‡ä¼šå­˜å…¥ Pinecone å‘é‡æ•°æ®åº“ï¼Œè¿™ä¸ªåº“ä¼šæ‰¿è½½ç³»ç»Ÿéœ€è¦çš„ä¸€åˆ‡å¤–éƒ¨æ•°æ®ã€‚<br/>
æˆ‘ä»¬åªç”¨ä¸€ä¸ª Pinecone ç´¢å¼•ï¼Œä½†å°†å®ƒåˆ’åˆ†æˆä¸¤ä¸ªä¸¥æ ¼åˆ†ç¦»çš„å‘½åç©ºé—´ï¼ˆnamespaceï¼‰ï¼š</p>
<ul>
<li><strong>KnowledgeStore</strong>ï¼š<br/>
å­˜å‚¨æ¥è‡ªâ€œäº‹å®æ•°æ®â€çš„å‘é‡</li>
<li><strong>ContextLibrary</strong>ï¼š<br/>
å­˜å‚¨æ¥è‡ªâ€œè¿‡ç¨‹è“å›¾ / è¯­ä¹‰è“å›¾â€çš„å‘é‡</li>
</ul>
<p>å½“è¿™ä¸¤ä¸ªå‘½åç©ºé—´éƒ½å°±ä½åï¼Œç³»ç»Ÿå°±å¯ä»¥è¿›å…¥ç¬¬äºŒé˜¶æ®µã€‚</p>
<h3 data-id="heading-2">é˜¶æ®µäºŒï¼šè¿è¡Œæ—¶æ‰§è¡Œåˆ†æ</h3>
<p>Phase 2: Runtime execution analysis</p>
<p>åœ¨ Phase 2 ä¸­ï¼ŒMAS ä¼šçœŸæ­£å¼€å§‹æ‰§è¡Œç”¨æˆ·è¯·æ±‚ï¼Œå¯¹åº”å›¾ 3.1 çš„å³ä¾§ã€‚</p>
<p>æµç¨‹ä»ä¸€ä¸ª**ç”¨æˆ·ç›®æ ‡ï¼ˆuser goalï¼‰**å¼€å§‹ï¼Œè¿™æ˜¯ä¸€æ¡ç”±ç”¨æˆ·æäº¤çš„é«˜å±‚æŒ‡ä»¤ï¼Œä¾‹å¦‚ï¼š</p>
<blockquote>
<p>â€œå†™ä¸€ç¯‡å…³äºé˜¿æ³¢ç½— 11 å·çš„æ‚¬ç–‘æ•…äº‹â€ï¼ˆWrite a suspenseful story about Apollo 11ï¼‰</p>
</blockquote>
<p>Orchestrator æ”¶åˆ°è¿™ä¸ªç›®æ ‡ï¼Œä½œä¸ºç³»ç»Ÿçš„ä¸­å¤®åè°ƒè€…ï¼Œå®ƒä¼šåˆ†æè¿™æ¡è¯·æ±‚ï¼Œå¹¶è¯†åˆ«å‡ºä¸¤ä¸ªå…³é”®æˆåˆ†ï¼š</p>
<ul>
<li>
<p><strong>intent_query</strong>ï¼š<br/>
è¿™æ˜¯ç”¨äºâ€œé¦†å‘˜ï¼ˆLibrarianï¼‰æŸ¥è¯¢â€çš„â€œæ„å›¾å‘é‡â€ï¼Œä¸<strong>æœŸæœ›çš„é£æ ¼æˆ–ç»“æ„</strong>æœ‰å…³</p>
<ul>
<li>åœ¨ä¾‹å­ä¸­å°±æ˜¯ï¼š <em>â€œæ‚¬ç–‘æ•…äº‹ï¼ˆsuspenseful storyï¼‰â€</em></li>
</ul>
</li>
<li>
<p><strong>topic_query</strong>ï¼š<br/>
è¿™æ˜¯ç”¨äºâ€œç ”ç©¶å‘˜ï¼ˆResearcherï¼‰æŸ¥è¯¢â€çš„â€œä¸»é¢˜å‘é‡â€ï¼Œä¸<strong>ä¸»é¢˜å†…å®¹æœ¬èº«</strong>æœ‰å…³</p>
<ul>
<li>åœ¨ä¾‹å­ä¸­å°±æ˜¯ï¼š <em>â€œé˜¿æ³¢ç½— 11 å·ï¼ˆApollo 11ï¼‰â€</em></li>
</ul>
</li>
</ul>
<p>éšåï¼ŒOrchestrator ä¼šæŠŠè¿™ä¸¤ä¸ªæŸ¥è¯¢åˆ†æ´¾ç»™å„è‡ªçš„ä¸“ä¸šæ™ºèƒ½ä½“ï¼š</p>
<ol>
<li>
<p><strong>Librarian æ™ºèƒ½ä½“ï¼ˆä¸Šä¸‹æ–‡é¦†å‘˜ï¼‰</strong></p>
<ul>
<li>èŒè´£ï¼šæ£€ç´¢â€œæŒ‡ä»¤è„šæœ¬â€ï¼ˆinstruction scriptsï¼‰ã€‚</li>
<li>å®ƒé€šè¿‡å¼•æ“çš„ MCP æ¶ˆæ¯å±‚æ¥æ”¶ <code>intent_query</code>ï¼Œ</li>
<li>æŸ¥è¯¢çš„æ˜¯ <strong>ContextLibrary å‘½åç©ºé—´</strong>ï¼Œ</li>
<li>æ‰§è¡Œè¯­ä¹‰æ£€ç´¢ï¼Œæ‰¾åˆ°æœ€åŒ¹é…æœ¬æ¬¡æ„å›¾çš„â€œè“å›¾æè¿°â€ï¼Œ</li>
<li>ç„¶åå–å›å¯¹åº”çš„<strong>è¯­ä¹‰è“å›¾ï¼ˆsemantic blueprintï¼‰</strong> ã€‚</li>
</ul>
</li>
<li>
<p><strong>Researcher æ™ºèƒ½ä½“ï¼ˆç ”ç©¶å‘˜ï¼‰</strong></p>
<ul>
<li>èŒè´£ï¼šæ£€ç´¢â€œäº‹å®ä¿¡æ¯â€ã€‚</li>
<li>å®ƒæ¥æ”¶ <code>topic_query</code>ï¼Œ</li>
<li>æŸ¥è¯¢çš„æ˜¯ <strong>KnowledgeStore å‘½åç©ºé—´</strong>ï¼Œ</li>
<li>æ£€ç´¢ä¸ä¸»é¢˜ç›¸å…³çš„äº‹å®æ€§æ–‡æœ¬å—ï¼ˆchunksï¼‰ï¼Œ</li>
<li>å¹¶æŠŠè¿™äº›ä¿¡æ¯ç»¼åˆä¸ºç®€æ˜çš„â€œç ”ç©¶ç»“è®ºâ€ã€‚</li>
</ul>
</li>
</ol>
<p>å½“è¿™ä¸¤è·¯ç»“æœéƒ½å‡†å¤‡å¥½ä¹‹åï¼ŒOrchestrator ä¼šæŠŠï¼š</p>
<ul>
<li>æ¥è‡ª Librarian çš„<strong>æŒ‡ä»¤è„šæœ¬ / è“å›¾</strong>ï¼Œä»¥åŠ</li>
<li>æ¥è‡ª Researcher çš„<strong>ç»¼åˆäº‹å®</strong></li>
</ul>
<p>ä¸€å¹¶â€œäº¤ä»˜â€ç»™ Writer æ™ºèƒ½ä½“ã€‚<br/>
åœ¨å›¾ 3.1 ä¸­ï¼Œè¿™ä¸€è¿‡ç¨‹è¢«ç®­å¤´è¡¨ç¤ºä¸ºï¼š<strong>è“å›¾ï¼ˆblueprintï¼‰å’Œäº‹å®ï¼ˆfactsï¼‰ä» Librarian ä¸ Researcher æµå‘ Writer</strong>ã€‚</p>
<p>Writer æ™ºèƒ½ä½“ä½œä¸ºç³»ç»Ÿçš„â€œç”Ÿæˆå¼•æ“â€ï¼š</p>
<ul>
<li>å°†â€œäº‹å®â€ç”¨ä½œå†…å®¹ç´ æï¼›</li>
<li>å°†â€œè“å›¾â€ç”¨ä½œç»“æ„ä¸é£æ ¼çš„<strong>å¼ºçº¦æŸæŒ‡ä»¤</strong>ï¼›</li>
</ul>
<p>åœ¨è¿™åŒé‡çº¦æŸä¸‹ï¼Œå®ƒç”Ÿæˆæœ€ç»ˆè¾“å‡ºï¼šæ—¢æ»¡è¶³<strong>äº‹å®æ­£ç¡®æ€§</strong>ï¼Œåˆç¬¦åˆ<strong>è¿‡ç¨‹æ€§ / é£æ ¼æ€§æŒ‡ä»¤</strong>ã€‚</p>
<p>è¿™ç§æ¶æ„å¸¦æ¥äº†æé«˜çš„<strong>çµæ´»æ€§ä¸å¯æ‰©å±•æ€§</strong>ï¼š</p>
<ul>
<li>æ›´æ–°çŸ¥è¯†åº“ï¼Œä¸éœ€è¦ä¿®æ”¹æŒ‡ä»¤è„šæœ¬ï¼›</li>
<li>æ–°å¢è¯­ä¹‰è“å›¾ï¼Œä¹Ÿä¸éœ€è¦è§¦ç¢°äº‹å®æ•°æ®ï¼›</li>
<li>åœ¨è¿è¡Œæ—¶ï¼Œæ™ºèƒ½ä½“ä¼šæ ¹æ®æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡ï¼ŒåŠ¨æ€è°ƒæ•´è‡ªèº«è¡Œä¸ºã€‚</li>
</ul>
<p>è‡³æ­¤ï¼Œæ¶æ„å·²ç»è®²æ¸…æ¥šäº†ã€‚<br/>
æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥å®ç°éƒ¨åˆ†ï¼šç¬¬ä¸€æ­¥æ˜¯æ„å»º <strong>RAG æ•°æ®æ‘„å…¥ç®¡é“ï¼ˆRAG ingestion pipelineï¼‰</strong> ã€‚</p>
<h2 data-id="heading-3">RAG æµæ°´çº¿ä¸­çš„æ•°æ®æ‘„å…¥ï¼ˆä¸Šä¸‹æ–‡ä¸çŸ¥è¯†ï¼‰</h2>
<p>åœ¨ç¬¬ 2 ç« é‡Œï¼Œæˆ‘ä»¬ç”¨<strong>æ¨¡æ‹Ÿæ•°æ®</strong>æ„å»ºäº†ä¸€ä¸ª MASã€‚<br/>
è¿™äº›æ™ºèƒ½ä½“â€œä¼šæŸ¥èµ„æ–™â€ï¼Œä½†å®ƒä»¬èƒ½æŸ¥åˆ°çš„ä¸œè¥¿åªæ¥è‡ªä¸€ä¸ªç®€å•çš„ Python å­—å…¸ã€‚</p>
<p>æœ¬ç« è¦è¿ˆå‡ºä¸‹ä¸€æ­¥ï¼š<br/>
ç”¨ä¸€ä¸ª<strong>çœŸå®çš„ RAG æµæ°´çº¿</strong>æ›¿æ¢æ‰è¿™ä¸ªæ¨¡æ‹Ÿå±‚ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25aeee14196d4eb3b76a9c1b4bf6e5f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWw5o2u5pm66IO96ICB5Y-45py6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172772&amp;x-signature=AL%2FNhGiEkdPnqmtrj6cu8kINsiY%3D" alt="image.png" loading="lazy"/></p>
<p>å›¾ 3.2ï¼šRAG æ•°æ®æ‘„å…¥æµæ°´çº¿æµç¨‹å›¾</p>
<p>å›¾ 3.2 å±•ç¤ºäº†è¿™æ¡æµæ°´çº¿çš„æ•´ä½“æµç¨‹ã€‚<br/>
åœ¨æ™ºèƒ½ä½“èƒ½å¤Ÿé«˜æ•ˆæ£€ç´¢ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆ<strong>å‡†å¤‡å¹¶æ„å»ºå®ƒä»¬è¦ç”¨çš„æ•°æ®åº“</strong>ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬å¼•å…¥ä¸¤ç§äº’è¡¥çš„ RAG å½¢å¼ï¼š</p>
<ul>
<li>
<p><strong>çŸ¥è¯†åº“ï¼ˆKnowledge baseï¼Œäº‹å®å‹ RAGï¼‰</strong> ï¼š<br/>
å­˜å‚¨äº‹å®ä¿¡æ¯ã€‚è¿™æ˜¯æœ€ç»å…¸ã€å·¥ç¨‹å¸ˆä»¬æœ€ç†Ÿæ‚‰çš„ RAG ç”¨æ³•ã€‚</p>
</li>
<li>
<p><strong>ä¸Šä¸‹æ–‡åº“ï¼ˆContext libraryï¼Œè¿‡ç¨‹å‹ RAGï¼‰</strong> ï¼š<br/>
å­˜å‚¨æŒ‡ä»¤æˆ–<strong>è¯­ä¹‰è“å›¾ï¼ˆsemantic blueprintsï¼‰</strong> ï¼ˆåœ¨ç¬¬ 1 ç« ä¸­ä»‹ç»è¿‡ï¼‰ã€‚<br/>
æ™ºèƒ½ä½“æŸ¥è¯¢è¿™ä¸ªåº“ï¼Œæ˜¯ä¸ºäº†å†³å®šï¼š</p>
<blockquote>
<p>è‡ªå·±åº”è¯¥ç”¨ä»€ä¹ˆç»“æ„æ¥ç»„ç»‡å›ç­”ã€é‡‡ç”¨ä»€ä¹ˆé£æ ¼ã€‚</p>
</blockquote>
</li>
</ul>
<p>è¦å®ç°è¿™ä¸€åˆ‡ï¼Œè¯·æ‰“å¼€æœ¬ç« ä»“åº“ä¸­çš„ <code>RAG_Pipeline.ipynb</code>ã€‚<br/>
åœ¨è¿™ä¸ª Notebook é‡Œï¼Œæˆ‘ä»¬å°†ï¼š</p>
<ol>
<li>æ„å»ºä¸¤ä¸ªæ•°æ®åº“ï¼ˆçŸ¥è¯†åº“ä¸ä¸Šä¸‹æ–‡åº“ï¼‰ï¼›</li>
<li>æå–å¹¶è½¬æ¢æ•°æ®ä¸ºå‘é‡ï¼ˆembeddingsï¼‰ï¼›</li>
<li>å°†è¿™äº›å‘é‡ä¸Šä¼ åˆ° Pinecone å‘é‡å­˜å‚¨ä¸­ï¼›</li>
<li>å¹¶é€šè¿‡ <strong>namespace</strong> å°†è¿™ä¸¤ä¸ªæ•°æ®åº“ä¸¥æ ¼éš”ç¦»ã€‚</li>
</ol>
<h3 data-id="heading-4">å®‰è£…ä¸ç¯å¢ƒå‡†å¤‡</h3>
<p>Installation and setup</p>
<p>å…ˆæŠŠè¿è¡Œç¯å¢ƒå‡†å¤‡å¥½ã€‚<br/>
æœ¬é¡¹ç›®ä¸­æˆ‘ä½¿ç”¨ <strong>Pinecone</strong> ä½œä¸ºå‘é‡æ•°æ®åº“ï¼Œä½†å¦‚æœä½ æ›´ä¹ æƒ¯å…¶å®ƒå¹³å°ï¼Œä¹Ÿå¯ä»¥æ›¿æ¢ï¼›<br/>
åªè¦æ»¡è¶³å‘é‡æ£€ç´¢èƒ½åŠ›å³å¯ã€‚</p>
<p>åŒæ—¶ï¼Œä¸ºäº†æ›´å®ç”¨ä¸€ç‚¹ï¼Œæˆ‘ä»¬è¿˜ä¼šå¼•å…¥ï¼š</p>
<ul>
<li><code>tqdm</code>ï¼šç”¨äºç›‘æ§ä¸Šä¼ è¿›åº¦ï¼›</li>
<li><code>tenacity</code>ï¼šç”¨äºåœ¨ç½‘ç»œæŠ–åŠ¨æ—¶ï¼Œè®© API è°ƒç”¨æ›´å¯é ï¼ˆè‡ªåŠ¨é‡è¯•ç­‰ï¼‰ã€‚</li>
</ul>
<p>æœ‰ä¸€ä¸ªæˆ‘è‡ªå·±è¸©è¿‡å¾ˆå¤šæ¬¡å‘çš„ç»éªŒè¦æå‰è¯´ï¼š<br/>
<strong>Python çš„åº“ç”Ÿæ€å˜åŒ–å¾ˆå¿«</strong>ï¼Œå¦‚æœä¸é”å®šç‰ˆæœ¬ï¼Œå¾ˆå®¹æ˜“ä»â€œåšç³»ç»Ÿâ€å˜æˆâ€œæ‰“ä¾èµ–è¡¥ä¸â€ã€‚<br/>
ä¸ºäº†é¿å…ä½ ä¹Ÿé™·åœ¨è¿™äº›é—®é¢˜é‡Œï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œç›´æ¥å†»ç»“ä¸€äº›å…·ä½“ç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">!pip install <span class="hljs-attr">tqdm</span>==<span class="hljs-number">4.67</span>.<span class="hljs-number">1</span> --upgrade
!pip install <span class="hljs-attr">openai</span>==<span class="hljs-number">1.104</span>.<span class="hljs-number">2</span>
!pip install <span class="hljs-attr">pinecone</span>==<span class="hljs-number">7.0</span>.<span class="hljs-number">0</span> tqdm==<span class="hljs-number">4.67</span>.<span class="hljs-number">1</span> tenacity==<span class="hljs-number">8.3</span>.<span class="hljs-number">0</span>
</code></pre>
<p>æ¥ä¸‹æ¥ï¼ŒæŠŠæœ¬ Notebook éœ€è¦çš„æ¨¡å—å¯¼å…¥è¿›æ¥ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Imports for this notebook</span>
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">from</span> tqdm.auto <span class="hljs-keyword">import</span> tqdm
<span class="hljs-keyword">import</span> tiktoken
<span class="hljs-keyword">from</span> pinecone <span class="hljs-keyword">import</span> Pinecone, ServerlessSpec
<span class="hljs-keyword">from</span> tenacity <span class="hljs-keyword">import</span> retry, stop_after_attempt, wait_random_exponential

<span class="hljs-comment"># general imports required in the notebooks of this book</span>
<span class="hljs-keyword">import</span> re
<span class="hljs-keyword">import</span> textwrap
<span class="hljs-keyword">from</span> IPython.display <span class="hljs-keyword">import</span> display, Markdown
<span class="hljs-keyword">import</span> copy
</code></pre>
<p>è¦ä½¿ç”¨ <strong>OpenAI</strong> å’Œ <strong>Pinecone</strong>ï¼Œä½ éœ€è¦ API Keyã€‚<br/>
å¦‚æœä½ è¿˜æ²¡æœ‰æ³¨å†Œï¼Œè¿™ä¸¤ä¸ªå¹³å°çš„ä¸Šæ‰‹æµç¨‹éƒ½å¾ˆç®€å•ï¼›<br/>
Pinecone ç”šè‡³æä¾›å¸¦ç´¢å¼•æ•°é‡é™åˆ¶çš„å…è´¹è®¡åˆ’ï¼Œéå¸¸é€‚åˆå®éªŒã€‚</p>
<p>åœ¨è¿™ä¸ª Notebook é‡Œï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ <strong>Google Colab çš„ Secrets Manager</strong> æ¥æä¾›è¿™äº› Keyï¼›<br/>
å¦‚æœä½ åœ¨æœ¬åœ°è·‘ï¼Œä»£ç ä¼šé€€å›åˆ°ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼ˆenvironment variablesï¼‰ã€‚<br/>
ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„ç¯å¢ƒè‡ªç”±ä¿®æ”¹è¿™ä¸€å±‚ã€‚</p>
<p>åœ¨åµŒå…¥æ¨¡å‹ä¸Šï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ OpenAI çš„ <code>text-embedding-3-small</code>ï¼š</p>
<ul>
<li>å®ƒä¼šè¾“å‡º 1536 ç»´çš„å‘é‡ï¼Œ</li>
<li>å¯¹æˆ‘ä»¬çš„åœºæ™¯æ¥è¯´å·²ç»ç»°ç»°æœ‰ä½™ã€‚</li>
</ul>
<p>ä½ å½“ç„¶å¯ä»¥é€‰æ‹©å…¶å®ƒåµŒå…¥æ¨¡å‹ï¼Œä½†æœ‰ä¸€ä¸ªå…³é”®åŸåˆ™ï¼š<br/>
<strong>ç”¨æ¥åˆ›å»ºå‘é‡çš„æ¨¡å‹ï¼Œå¿…é¡»ä¸æ£€ç´¢æ—¶ä½¿ç”¨çš„æ¨¡å‹ä¿æŒä¸€è‡´</strong>ã€‚</p>
<p>åœ¨å®Œæˆ API Key è®¾ç½®ä¹‹åï¼Œæˆ‘ä»¬ä¼šæŠŠè¿™äº›ç»†èŠ‚å†™è¿›é…ç½®å˜é‡ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">import os
from openai import OpenAI
from google.colab import userdata

<span class="hljs-comment"># Load the API key from Colab secrets, set the env var, then init the client</span>
â€¦
<span class="hljs-comment"># Configuration</span>
<span class="hljs-attr">EMBEDDING_MODEL</span> = <span class="hljs-string">"text-embedding-3-small"</span>
<span class="hljs-attr">EMBEDDING_DIM</span> = <span class="hljs-number">1536</span> <span class="hljs-comment"># Dimension for text-embedding-3-small</span>
<span class="hljs-attr">GENERATION_MODEL</span> = <span class="hljs-string">"gpt-5"</span>
</code></pre>
<blockquote>
<p>å…³äºæ¨¡å‹é€‰æ‹©çš„å°æç¤ºï¼š<br/>
è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ GPT-5 æ˜¯ä¸ºäº†åœ¨æœ¬ç« å’Œåç»­ç« èŠ‚ä¸­ä¿æŒè¿ç»­æ€§ã€‚<br/>
ä½†æ•´ä¸ªå¼•æ“æœ¬èº«æ˜¯â€œæ¨¡å‹æ— å…³â€çš„ï¼š<br/>
ä½ å¯ä»¥æŠŠ <code>GENERATION_MODEL</code> æ¢æˆä»»ä½•å…¼å®¹çš„ LLMï¼ˆä¾‹å¦‚ Mistral æˆ– Claudeï¼‰ï¼Œ<br/>
è€Œæ¶æ„çš„å…¶å®ƒéƒ¨åˆ†ï¼ˆæç¤ºè¯ã€æ³¨å†Œè¡¨ã€Planner/Executorï¼‰éƒ½å¯ä»¥ä¿æŒä¸å˜ã€‚</p>
</blockquote>
<p>å¦‚æœä¸€åˆ‡é…ç½®æ— è¯¯ï¼ŒNotebook ä¼šç»™å‡ºç±»ä¼¼ä¸‹é¢çš„æç¤ºï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">OpenAI API <span class="hljs-keyword">key</span> loaded <span class="hljs-built_in">and</span> environment variable <span class="hljs-keyword">set</span> successfully.
</code></pre>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»§ç»­å‰è¿›ï¼Œåˆå§‹åŒ– Pinecone çš„ç´¢å¼•äº†ã€‚</p>
<h3 data-id="heading-5">åˆå§‹åŒ– Pinecone ç´¢å¼•</h3>
<p>Initializing the Pinecone index</p>
<p>ç°åœ¨ç¯å¢ƒå·²ç»å‡†å¤‡å¥½äº†ï¼Œæˆ‘ä»¬æ¥ç”¨åˆšåˆšé…ç½®çš„ API Key è¿æ¥ <strong>OpenAI</strong> å’Œ <strong>Pinecone</strong>ã€‚<br/>
ç¬¬ä¸€æ­¥æ˜¯ä¸º Pinecone ç´¢å¼•èµ·ä¸€ä¸ªåå­—ï¼Œæœ¬ç« ä¸­æˆ‘ä»¬ç”¨ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">INDEX_NAME</span> = <span class="hljs-string">'genai-mas-mcp-ch3'</span>
</code></pre>
<p>æ¥ç€ï¼Œè·å– Pinecone çš„ API Keyã€‚ç¤ºä¾‹ä¸­ä¾ç„¶ä½¿ç”¨ Colab çš„ Secrets Managerï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">try</span>:
    <span class="hljs-comment"># Standard way to access secrets securely in Google Colab</span>
    <span class="hljs-keyword">from</span> google.colab <span class="hljs-keyword">import</span> userdata
    PINECONE_API_KEY = userdata.get(<span class="hljs-string">'PINECONE_API_KEY'</span>)
â€¦
</code></pre>
<p>æ‹¿åˆ° API Key åï¼Œæˆ‘ä»¬è¦ä¸ºæœ¬é¡¹ç›®å®šä¹‰ä¸¤ä¸ªå‘½åç©ºé—´ï¼ˆnamespaceï¼‰ï¼š<br/>
å®ƒä»¬ä¼šåœ¨ Pinecone ä¸­å°†ä¸¤ç±»æ•°æ®ä¸¥æ ¼éš”ç¦»ï¼š</p>
<ul>
<li><code>NAMESPACE_KNOWLEDGE</code>ï¼šå­˜å‚¨äº‹å®ï¼ˆKnowledgeStoreï¼‰</li>
<li><code>NAMESPACE_CONTEXT</code>ï¼šå­˜å‚¨è¯­ä¹‰è“å›¾ / æŒ‡ä»¤ï¼ˆContextLibraryï¼‰</li>
</ul>
<p>æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ Pinecone çš„ <strong>serverless æ¶æ„</strong>ï¼Œ<br/>
è¿™ä¹Ÿæ˜¯ Pinecone å…è´¹è®¡åˆ’æ¨èçš„æ–¹å¼ã€‚<br/>
æœ¬ç¤ºä¾‹ä¸­æˆ‘ä½¿ç”¨ AWS çš„ <code>us-east-1</code> åŒºåŸŸï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># --- Initialize Clients ---</span>
<span class="hljs-attr">client</span> = OpenAI(api_key=OPENAI_API_KEY)
<span class="hljs-attr">pc</span> = Pinecone(api_key=PINECONE_API_KEY)

<span class="hljs-comment"># --- Define Index and Namespaces ---</span>
<span class="hljs-attr">INDEX_NAME</span> = <span class="hljs-string">'genai-mas-mcp-ch3'</span>
<span class="hljs-attr">NAMESPACE_KNOWLEDGE</span> = <span class="hljs-string">"KnowledgeStore"</span>
<span class="hljs-attr">NAMESPACE_CONTEXT</span> = <span class="hljs-string">"ContextLibrary"</span>

<span class="hljs-comment"># Define Serverless Specification</span>
<span class="hljs-attr">spec</span> = ServerlessSpec(cloud=<span class="hljs-string">'aws'</span>, region=<span class="hljs-string">'us-east-1'</span>)
</code></pre>
<p>åœ¨ä½¿ç”¨ç´¢å¼•ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ£€æŸ¥å®ƒæ˜¯å¦å·²ç»å­˜åœ¨ï¼š<br/>
å¦‚æœä¸å­˜åœ¨ï¼Œå°±ç”¨æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„ç»´åº¦ï¼ˆ1536ï¼‰åˆ›å»ºä¸€ä¸ªæ–°ç´¢å¼•ï¼Œå¹¶å°†åº¦é‡æ–¹å¼è®¾ä¸º <strong>cosine ç›¸ä¼¼åº¦</strong>â€”â€”è¿™æ˜¯æ–‡æœ¬å‘é‡å¯¹æ¯”å¾ˆå¸¸ç”¨çš„æŒ‡æ ‡ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Check if index exists</span>
if INDEX_NAME not in pc.list_indexes().names():
    print(f"Index '{INDEX_NAME}' not found. Creating new serverless index...")
    pc.create_index(
        <span class="hljs-attr">name</span>=INDEX_NAME,
        <span class="hljs-attr">dimension</span>=EMBEDDING_DIM,
        <span class="hljs-attr">metric</span>=<span class="hljs-string">'cosine'</span>,
        <span class="hljs-attr">spec</span>=spec
    )
    <span class="hljs-comment"># Wait for index to be ready</span>
    while not pc.describe_index(INDEX_NAME).status<span class="hljs-section">['ready']</span>:
        print("Waiting for index to be ready...")
        time.sleep(1)
    print("Index created successfully. It is new and empty.")
</code></pre>
<p>å¦‚æœç´¢å¼•å·²ç»å­˜åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©æ˜¯å¦æ¸…ç©ºå…¶ä¸­æ•°æ®ã€‚<br/>
åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›æ¯æ¬¡éƒ½ä»â€œå¹²å‡€ç¯å¢ƒâ€å¼€å§‹ï¼Œå› æ­¤ä¼šåˆ é™¤ä¸¤ä¸ªå‘½åç©ºé—´é‡Œçš„å†…å®¹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">else:
    print(f"Index '{INDEX_NAME}' already exists. Clearing namespaces for a fresh start...")
    <span class="hljs-attr">index</span> = pc.Index(INDEX_NAME)
    <span class="hljs-attr">namespaces_to_clear</span> = [NAMESPACE_KNOWLEDGE, NAMESPACE_CONTEXT]
</code></pre>
<p>è¦æ¸…ç©ºç´¢å¼•ï¼Œæˆ‘ä»¬éœ€è¦ä¾æ¬¡éå†æ¯ä¸ªå‘½åç©ºé—´å¹¶åˆ é™¤æ•°æ®ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">    for namespace in namespaces_to_clear:
        <span class="hljs-comment"># Check if namespace exists and has vectors before deleting</span>
        <span class="hljs-attr">stats</span> = index.describe_index_stats()
        if namespace in stats.namespaces \
        AND stats.namespaces<span class="hljs-section">[namespace]</span>.vector_count &gt; 0:
            print(f"Clearing namespace '{namespace}'...")
            index.delete(<span class="hljs-attr">delete_all</span>=<span class="hljs-literal">True</span>, namespace=namespace)
</code></pre>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªâ€œå‘ç‚¹â€ï¼š<br/>
åˆ é™¤æ“ä½œæœ‰å¯èƒ½æ˜¯å¼‚æ­¥çš„ï¼Œè€Œç¨‹åºå¯èƒ½ç»§ç»­è¿è¡Œå¾—å¤ªå¿«ã€‚<br/>
è¿™æ„å‘³ç€ï¼šå¦‚æœåˆ é™¤æ¯”è¾ƒæ…¢ï¼Œè€Œæˆ‘ä»¬çš„ä¸Šä¼ å·²ç»å¼€å§‹ï¼Œæ–°å†™å…¥çš„å‘é‡æœ‰å¯èƒ½è¢«â€œé¡ºå¸¦â€åˆ æ‰â€”â€”è¿™è™½ç„¶ä¸æ˜¯å¿…ç„¶ï¼Œä½†æ˜¾ç„¶æ˜¯æˆ‘ä»¬ä¸æƒ³æ‰¿æ‹…çš„é£é™©ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¼ºåˆ¶ç³»ç»Ÿ<strong>ç­‰å¾…ï¼Œç›´åˆ°å‘é‡æ•°é‡çœŸæ­£å˜æˆ 0</strong> æ‰ç»§ç»­ï¼š</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-comment"># **CRITICAL FUNCTION: Wait for deletion to complete**</span>
            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
                stats = index.describe_index_stats()
                <span class="hljs-keyword">if</span> namespace <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> stats.namespaces <span class="hljs-keyword">or</span> \
                stats.namespaces[namespace].vector_count == <span class="hljs-number">0</span>:
                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Namespace '<span class="hljs-subst">{namespace}</span>' cleared successfully."</span>)
                    <span class="hljs-keyword">break</span>
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Waiting for namespace '<span class="hljs-subst">{namespace}</span>' to clear..."</span>)
                time.sleep(<span class="hljs-number">5</span>) <span class="hljs-comment"># Poll every 5 seconds</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Namespace '<span class="hljs-subst">{namespace}</span>' is already empty or does not exist. Skipping."</span>)
</code></pre>
<p>æœ€åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­£å¼è¿æ¥åˆ°è¿™ä¸ªç´¢å¼•ï¼Œä¾›åç»­æ“ä½œä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Connect to the index for subsequent operations</span>
<span class="hljs-attr">index</span> = pc.Index(INDEX_NAME)
</code></pre>
<p>å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„è¾“å‡ºï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">Index <span class="hljs-comment">'genai-mas-mcp-ch3' already exists. Clearing namespaces for a fresh start...</span>
<span class="hljs-keyword">Namespace</span> <span class="hljs-comment">'KnowledgeStore' is already empty or does not exist. Skipping.</span>
<span class="hljs-keyword">Namespace</span> <span class="hljs-comment">'ContextLibrary' is already empty or does not exist. Skipping.</span>
</code></pre>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½ é€šå¸¸ä¸ä¼šå¸Œæœ›<strong>æ¯æ¬¡è¿è¡Œéƒ½æ¸…ç©ºå‘½åç©ºé—´</strong>â€”â€”<br/>
å¾ˆå¤šæ—¶å€™ä½ å¸Œæœ›ç³»ç»Ÿ<strong>ä¿ç•™å·²æ„å»ºå¥½çš„çŸ¥è¯†</strong>ã€‚</p>
<p>ä¸è¿‡ï¼Œåœ¨æˆ‘ä»¬çš„å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œæ¯æ¬¡ä»â€œç©ºç¯å¢ƒâ€å¼€å§‹ä¼šæ›´åŠ æ¸…æ™°ã€å¯æ§ã€‚<br/>
ç´¢å¼•å‡†å¤‡å°±ç»ªä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥ä¸‹ä¸€æ­¥ï¼š<strong>å‡†å¤‡å¹¶å†™å…¥æ•°æ®</strong>ã€‚</p>
<h3 data-id="heading-6">æ•°æ®å‡†å¤‡ï¼šä¸Šä¸‹æ–‡åº“ï¼ˆContext Libraryï¼Œè¿‡ç¨‹å‹ RAGï¼‰</h3>
<p>åœ¨æœ¬å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬è¦ä¸º<strong>ä¸Šä¸‹æ–‡åº“ï¼ˆcontext libraryï¼‰<strong>å®šä¹‰æ•°æ®ã€‚<br/>
è¿™æ˜¯æ•´ä¸ª</strong>è¿‡ç¨‹å‹ RAGï¼ˆprocedural RAGï¼‰<strong>çš„æ ¸å¿ƒï¼Œå› ä¸ºè¿™é‡Œæˆ‘ä»¬å¼•å…¥çš„ä¸æ˜¯é™æ€çŸ¥è¯†ï¼Œè€Œæ˜¯</strong>â€œå¦‚ä½•åšäº‹â€çš„ç¨‹åºæ€§æŒ‡ä»¤</strong>ã€‚<br/>
ä¸Šä¸‹æ–‡åº“å»ºç«‹åœ¨ç¬¬ 1 ç« ä»‹ç»çš„â€œè¯­ä¹‰è“å›¾ï¼ˆsemantic blueprintï¼‰â€æ¦‚å¿µä¹‹ä¸Šï¼Œä½†è¿™æ¬¡æˆ‘ä»¬ä¼šç”¨ä¸€ä¸ªæ›´ç²¾ç¡®çš„ç»“æ„æ¥å®ç°ã€‚</p>
<p>æ¯æ¡ä¸Šä¸‹æ–‡åº“ä¸­çš„è®°å½•ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p>
<ol>
<li><strong>id</strong>ï¼š<br/>
åœ¨ Pinecone ç´¢å¼•ä¸­çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼›</li>
<li><strong>descriptionï¼ˆæè¿°ï¼‰</strong> ï¼š<br/>
ç”¨æ¥è¯´æ˜è¿™ä¸ªè“å›¾çš„ç”¨é€”ä¸é£æ ¼ã€‚<br/>
æˆ‘ä»¬åªå¯¹ <em>description</em> åšå‘é‡åŒ–ï¼Œä»¥ä¾¿åœ¨æ£€ç´¢æ—¶æ‰¾åˆ°éœ€è¦çš„è“å›¾ã€‚<br/>
ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆâ€œå›¾ä¹¦é¦†çš„å¡ç‰‡â€ï¼Œè€Œä¸æ˜¯ä¹¦æœ¬æœ¬èº«ã€‚</li>
<li><strong>blueprintï¼ˆè“å›¾ï¼‰</strong> ï¼š<br/>
çœŸæ­£ç»™ LLM ç”¨çš„æŒ‡ä»¤å†…å®¹ï¼Œä»¥ <strong>JSON</strong> æ ¼å¼å­˜å‚¨ã€‚<br/>
è“å›¾æœ¬èº«ä¸ä¼šè¢« embedï¼›å½“æˆ‘ä»¬é€šè¿‡ description æ‰¾åˆ°ç›®æ ‡åï¼Œå°±åƒæ ¹æ®ä¹¦ç›®å»ä¹¦æ¶å–ä¹¦ä¸€æ ·ï¼Œè¯»å–å®Œæ•´ JSON è“å›¾ã€‚</li>
</ol>
<p>åœ¨è¿è¡Œæ—¶ï¼Œè¿™ä¹ˆå·¥ä½œï¼š</p>
<ul>
<li>å½“ Orchestrator éœ€è¦æŸç§ç‰¹å®šé£æ ¼æ—¶ï¼Œ</li>
<li>Librarianï¼ˆé¦†å‘˜æ™ºèƒ½ä½“ï¼‰ä¼šæ ¹æ®éœ€æ±‚æ£€ç´¢æœ€åŒ¹é…çš„ <strong>description</strong>ï¼Œ</li>
<li>æ‰¾åˆ°åï¼Œå†æŠŠå¯¹åº”çš„å®Œæ•´ JSON è¯­ä¹‰è“å›¾å–å‡ºæ¥ã€‚</li>
</ul>
<p>è¿™ç§è®¾è®¡éå¸¸<strong>å¯æ‰©å±•</strong>ï¼š<br/>
ä½ å¯ä»¥åœ¨å‘é‡åº“é‡Œä¸æ–­æ–°å¢æ–°çš„ LLM ä»»åŠ¡è“å›¾ï¼Œè€Œ<strong>æ— éœ€é‡å†™æ™ºèƒ½ä½“é€»è¾‘</strong>ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬å…ˆå®šä¹‰ä¸‰ä¸ªç¤ºä¾‹è“å›¾ï¼š</p>
<ol>
<li>ç”¨äºå†™æ‚¬ç–‘å™äº‹ï¼ˆcreative writingï¼Œæ‚¬ç–‘æ•…äº‹ï¼‰</li>
<li>ç”¨äºæŠ€æœ¯è®²è§£ï¼ˆtechnical explanationï¼Œå¼ºè°ƒäº‹å®ä¸ç²¾ç¡®æ€§ï¼‰</li>
<li>ç”¨äºè½»æ¾å£å»çš„æ€»ç»“ï¼ˆcasual summaryï¼Œå¸¸è§ LLM ç”¨ä¾‹ï¼‰</li>
</ol>
<p>å®šä¹‰è¯­ä¹‰è“å›¾æœ¬èº«å°±æ˜¯ä¸€ç§å…³é”®çš„<strong>ä¸Šä¸‹æ–‡å·¥ç¨‹æŠ€èƒ½</strong>ã€‚<br/>
LLM ä¸æ˜¯è¯»å¿ƒæœ¯ï¼Œå®ƒéœ€è¦<strong>ç²¾å¿ƒç¼–å†™çš„æŒ‡ä»¤</strong>ã€‚<br/>
å³ä¾¿ä½ å€ŸåŠ© copilots æˆ– API æ¥è‡ªåŠ¨ç”Ÿæˆè¿™äº›è“å›¾æè¿°ï¼Œä½ ä»ç„¶å¿…é¡»äººå·¥å®¡æ ¸å…¶è´¨é‡ã€‚</p>
<p>æ¥çœ‹ç¬¬ä¸€ä¸ªä¾‹å­ â€”â€” <strong>æ‚¬ç–‘å™äº‹è“å›¾</strong>ã€‚<br/>
è¿™ä¸ªè“å›¾æ˜¯ä¸ºâ€œè®²æ•…äº‹â€è®¾è®¡çš„ï¼Œç›®æ ‡æ˜¯è¥é€ ç´§å¼ æ°›å›´ï¼Œè®©è¯»è€…ä¸€ç›´â€œç´§ç»·ç€ç¥ç»â€ï¼š</p>
<pre><code class="hljs language-css" lang="css">context_blueprints = <span class="hljs-selector-attr">[    {        <span class="hljs-string">"id"</span>: <span class="hljs-string">"blueprint_suspense_narrative"</span>,        <span class="hljs-string">"description"</span>: <span class="hljs-string">"A precise Semantic Blueprint designed to generate suspenseful and tense narratives, suitable for children's stories. Focuses on atmosphere, perceived threats, and emotional impact. Ideal for creative writing."</span>,        <span class="hljs-string">"blueprint"</span>: json.dumps({              <span class="hljs-string">"scene_goal"</span>: <span class="hljs-string">"Increase tension and create suspense."</span>,              <span class="hljs-string">"style_guide"</span>: <span class="hljs-string">"Use short, sharp sentences. Focus on sensory details (sounds, shadows). Maintain a slightly eerie but age-appropriate tone."</span>,              <span class="hljs-string">"participants"</span>: [                { <span class="hljs-string">"role"</span>: <span class="hljs-string">"Agent"</span>, <span class="hljs-string">"description"</span>: <span class="hljs-string">"The protagonist experiencing the events."</span> },                { <span class="hljs-string">"role"</span>: <span class="hljs-string">"Source_of_Threat"</span>, <span class="hljs-string">"description"</span>: <span class="hljs-string">"The underlying danger or mystery."</span> }              ]</span>,
            "instruction": <span class="hljs-string">"Rewrite the provided facts into a narrative adhering strictly to the scene_goal and style_guide."</span>
            })
    },
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œçš„æªè¾è¦éå¸¸å…·ä½“ã€‚<br/>
å†™â€œå„¿ç«¥å‘çš„æ‚¬ç–‘æ•…äº‹â€å’Œå†™â€œæŠ€æœ¯è¯´æ˜æ–‡â€å®Œå…¨ä¸æ˜¯ä¸€å›äº‹ï¼Œè“å›¾å¿…é¡»ä½“ç°è¿™ç§å·®å¼‚ã€‚</p>
<p>ä¸‹é¢æ˜¯ç¬¬äºŒä¸ªè“å›¾ â€”â€” <strong>æŠ€æœ¯è¯´æ˜è“å›¾</strong>ã€‚<br/>
å®ƒå’Œä¸Šé¢çš„å™äº‹è“å›¾å‡ ä¹æ˜¯åè¿‡æ¥çš„ï¼šä¸ç”¨æ°›å›´å’Œæƒ…ç»ªï¼Œè€Œæ˜¯å¼ºè°ƒæ¸…æ™°ã€ç»“æ„ã€å®¢è§‚æ€§ï¼š</p>
<pre><code class="hljs language-css" lang="css">    {
        "id": <span class="hljs-string">"blueprint_technical_explanation"</span>,
        <span class="hljs-string">"description"</span>: <span class="hljs-string">"A Semantic Blueprint designed for technical explanation or analysis. This blueprint focuses on clarity, objectivity, and structure. Ideal for breaking down complex processes, explaining mechanisms, or summarizing scientific findings."</span>,
        <span class="hljs-string">"blueprint"</span>: json.<span class="hljs-built_in">dumps</span>({
              "scene_goal": <span class="hljs-string">"Explain the mechanism or findings clearly and concisely."</span>,
              <span class="hljs-string">"style_guide"</span>: <span class="hljs-string">"Maintain an objective and formal tone. Use precise terminology. Prioritize factual accuracy and clarity over narrative flair."</span>,
              <span class="hljs-string">"structure"</span>: [<span class="hljs-string">"Definition"</span>, <span class="hljs-string">"Function/Operation"</span>, <span class="hljs-string">"Key Findings/Impact"</span>],
              <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"Organize the provided facts into the defined structure, adhering to the style_guide."</span>
            })
    },
</code></pre>
<p>è¿™ç§æ ¼å¼æ­£æ˜¯ä½ åœ¨æŠ€æœ¯æˆ–ç§‘å­¦åœºæ™¯ä¸­éœ€è¦çš„é‚£ç§<strong>å¯é¢„æµ‹ç»“æ„</strong>ã€‚</p>
<p>æœ€åæ˜¯ç¬¬ä¸‰ä¸ªè“å›¾ â€”â€” <strong>è½»æ¾æ€»ç»“ï¼ˆcasual summaryï¼‰</strong> ï¼Œ<br/>
è¿™ç§é£æ ¼å¾ˆé€‚åˆåšå¿«é€Ÿæµè§ˆçš„è¯´æ˜æ–‡æˆ–â€œå°ç™½å‘è§£é‡Šâ€ï¼š</p>
<pre><code class="hljs language-css" lang="css">    {
        "id": <span class="hljs-string">"blueprint_casual_summary"</span>,
        <span class="hljs-string">"description"</span>: <span class="hljs-string">"A goal-oriented context for creating a casual, easy-to-read summary. Focuses on brevity and accessibility, explaining concepts simply."</span>,
        <span class="hljs-string">"blueprint"</span>: json.<span class="hljs-built_in">dumps</span>({
              "scene_goal": <span class="hljs-string">"Summarize information quickly and casually."</span>,
              <span class="hljs-string">"style_guide"</span>: <span class="hljs-string">"Use informal language. Keep it brief and engaging. Imagine explaining it to a friend."</span>,
              <span class="hljs-string">"instruction"</span>: <span class="hljs-string">"Summarize the provided facts using the casual style guide."</span>
            })
    }
]
</code></pre>
<p>åœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦å¤ªå¤šè§’è‰²æˆ–ä¸¥æ ¼ç»“æ„ï¼Œ<br/>
è€Œæ˜¯é€šè¿‡ <code>style_guide</code> æŠŠ LLM æ¨å‘ï¼š</p>
<ul>
<li>ç®€çŸ­ã€</li>
<li>å£è¯­åŒ–ã€</li>
<li>æ›´äº²åˆ‡æ˜“æ‡‚çš„è¯­æ°”ï¼Œå¥½åƒä½ åœ¨ç»™åŒäº‹æˆ–æœ‹å‹è§£é‡Šä¸€ä¸ªæ¦‚å¿µã€‚</li>
</ul>
<p>ä¸ºäº†ç¡®è®¤è“å›¾æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å°ä¸€ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nPrepared <span class="hljs-subst">{<span class="hljs-built_in">len</span>(context_blueprints)}</span> context blueprints."</span>)
</code></pre>
<p>è¾“å‡ºè¡¨æ˜æˆ‘ä»¬ä¸€å…±å®šä¹‰äº†ä¸‰ä¸ªè“å›¾ï¼š</p>
<pre><code class="hljs language-erlang" lang="erlang">Prepared <span class="hljs-number">3</span> context blueprints.
</code></pre>
<p>è¿™é‡Œéœ€è¦è®°ä½çš„è¦ç‚¹æ˜¯ï¼š<strong>åˆ›å»ºè¯­ä¹‰è“å›¾æ—¢å¼ºå¤§ï¼Œä¹Ÿå¾ˆâ€œçƒ§è„‘â€</strong> ã€‚</p>
<ul>
<li>æ²¡æœ‰è¿™äº›è“å›¾ï¼Œä½ å¯èƒ½è¦ä¸ºæ¯ä¸€ç§ LLM ä»»åŠ¡å†™ä¸€ä¸ªç‹¬ç«‹çš„æ™ºèƒ½ä½“ â€”â€” è¿™æ ¹æœ¬ä¸å¯æ‰©å±•ã€‚</li>
<li>æœ‰äº†è¯­ä¹‰è“å›¾ï¼Œä½ å¯ä»¥å°†â€œè¿‡ç¨‹æ€§æŒ‡ä»¤â€ä¸€æ¬¡ç¼–ç ï¼Œå¤šå¤„å¤ç”¨ã€‚</li>
</ul>
<p>ä¸å…¶åœ¨äº§å“ç•Œé¢é‡Œä¸æ–­å¢åŠ å‡ åä¸ªä¸‹æ‹‰é€‰é¡¹ï¼Œä¸å¦‚æ„å»ºä¸€ä¸ªå¯æ‰©å±•çš„è‡ªåŠ¨åŒ–<strong>ä¸Šä¸‹æ–‡å¼•æ“</strong>æ¥è°ƒé…è¿™äº›è“å›¾ã€‚</p>
<p>è“å›¾è¿™è¾¹æå®šäº†ï¼Œæ¥ä¸‹æ¥å°±è½®åˆ°åŒ RAG ä¸­çš„å¦ä¸€åŠï¼š<strong>çŸ¥è¯†åº“ï¼ˆKnowledge Baseï¼‰</strong> ã€‚</p>
<h3 data-id="heading-7">æ•°æ®å‡†å¤‡ï¼šçŸ¥è¯†åº“ï¼ˆKnowledge Baseï¼Œäº‹å®å‹ RAGï¼‰</h3>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦ä¸º**çŸ¥è¯†åº“ï¼ˆknowledge baseï¼‰**å‡†å¤‡æ•°æ® â€”â€” è¿™æ˜¯ RAG æ¶æ„ä¸­â€œäº‹å®ä¾§â€çš„éƒ¨åˆ†ã€‚<br/>
å®ƒå­˜æ”¾ç›¸å¯¹é™æ€çš„ä¿¡æ¯ï¼ŒResearcher æ™ºèƒ½ä½“ä¼šåœ¨å…¶ä¸­æ£€ç´¢ï¼Œå¹¶æŠŠç»“æœç»¼åˆæˆç®€æ˜çš„â€œç ”ç©¶ç»“è®ºâ€ã€‚</p>
<p>é¡ºä¾¿å¼ºè°ƒä¸€ä¸‹ç°å®æƒ…å†µï¼š<br/>
ä½ è®¾è®¡çš„æ˜¯<strong>ç³»ç»Ÿæœ¬èº«</strong>ï¼Œè€Œä¸æ˜¯ LLMã€‚<br/>
åœ¨é‚£äº›çœ‹èµ·æ¥å¾ˆé…·çš„å¹³å°èƒŒåï¼Œå®é™…ä¸Šæœ‰å¤§é‡éœ€è¦äººç±»ç»†è‡´è®¾è®¡ä¸å‡†å¤‡çš„å·¥ä½œã€‚</p>
<p>åœ¨è¿™ä¸ªæ•™å­¦ç¤ºä¾‹é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå…³äº<strong>å¤ªç©ºæ¢ç´¢</strong>çš„å°å‹æ•°æ®é›†ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>å¤ªç©ºç«èµ›ä¸é˜¿æ³¢ç½— 11 å·ä»»åŠ¡ï¼›</li>
<li>Juno æœ¨æ˜Ÿæ¢æµ‹å™¨ï¼›</li>
<li>ç«æ˜Ÿæ¢æµ‹è½¦ç­‰å†…å®¹ã€‚</li>
</ul>
<p>ä¸ºäº†è®©é‡ç‚¹è½åœ¨â€œæ¶æ„â€ä¸Šï¼Œæœ¬ç« é‡Œæˆ‘ä»¬ç›´æ¥ç”¨å­—ç¬¦ä¸²æ¥è¡¨ç¤ºè¿™ä»½æ•°æ®ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">knowledge_data_raw</span> = <span class="hljs-string">"""
Space exploration is the use of astronomy and space technology to explore outer space. The early era of space exploration was driven by a "Space Race" between the Soviet Union and the United States. The launch of the Soviet Union's Sputnik 1 in 1957, and the first Moon landing by the American Apollo 11 mission in 1969 are key landmarks.
â€¦
Juno is a NASA space probe orbiting the planet Jupiter. It was launched on August 5, 2011, and entered a polar orbit of Jupiter on July 5, 2016.
â€¦
A Mars rover is a remote-controlled motor vehicle designed to travel on the surface of Mars. NASA JPL managed several successful rovers including: Sojourner, Spirit, Opportunity, Curiosity, and Perseverance. The search for evidence of habitability and organic carbon on Mars is now a primary NASA objective. Perseverance also carried the Ingenuity helicopter.
"""</span>
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¼šå†™ä¸€ä¸ªå°å°çš„è¾…åŠ©å‡½æ•°ï¼ŒæŠŠè¿™æ®µæ–‡æœ¬åˆ‡åˆ†æˆæ›´é€‚åˆæ£€ç´¢çš„ç‰‡æ®µï¼ˆchunksï¼‰ï¼Œå†è¿›è¡Œå‘é‡åŒ–ã€‚</p>
<h4 data-id="heading-8">åˆ†å—ä¸å‘é‡åŒ–çš„è¾…åŠ©å‡½æ•°</h4>
<p>è¯­è¨€æ¨¡å‹å¹¶ä¸æ˜¯ç›´æ¥å¤„ç†â€œæ®µè½â€ï¼Œè€Œæ˜¯å¤„ç†<strong>token</strong> â€”â€” ä¹Ÿå°±æ˜¯æ¨¡å‹èƒ½ç†è§£çš„æœ€å°æ–‡æœ¬å•å…ƒã€‚<br/>
ä¾‹å¦‚ï¼Œå•è¯ <code>encoding</code> å¯èƒ½ä¼šè¢«æ‹†æˆä¸¤ä¸ª tokenï¼š<code>encod</code> å’Œ <code>ing</code>ã€‚<br/>
æ¨¡å‹é€šè¿‡è¿™äº›æ›´ç»†ç²’åº¦çš„ token æ¥ç†è§£è¯ä¸è¯ä¹‹é—´çš„å…³ç³»ã€‚</p>
<p>æˆ‘ä»¬ä¼šä½¿ç”¨ <code>cl100k_base</code> è¿™ä¸ª tokenizerï¼Œè¿™æ˜¯ OpenAI æœ€æ–°æ¨¡å‹çš„æ ‡å‡†é…ç½®ã€‚<br/>
å®ƒæœ‰ä¸‰ä¸ªä¼˜åŠ¿ï¼š</p>
<ol>
<li><strong>æ›´èªæ˜çš„åˆ†è¯æ–¹å¼</strong>ï¼š<br/>
åƒ <code>encoding</code> è¿™æ ·çš„è¯ä¸ä¼šè¢«å½“ä½œä¸€ä¸ªæ•´ä½“ï¼Œè€Œæ˜¯æ‹†æˆ <code>encod</code> å’Œ <code>ing</code> ç­‰æœ‰æ„ä¹‰çš„ç‰‡æ®µï¼Œ<br/>
æœ‰åŠ©äºæ¨¡å‹æ›´å¥½åœ°ç†è§£ä¸åŒè¯è¯­ä¹‹é—´çš„è”ç³»ã€‚</li>
<li><strong>é«˜æ•ˆä¸”é€‚é…å¯¹è¯/æ£€ç´¢åœºæ™¯</strong>ï¼š<br/>
å¯¹äºèŠå¤©æ¨¡å‹å’Œè¦å­˜å…¥æ•°æ®åº“çš„æ–‡æœ¬ï¼Œå®ƒéƒ½éå¸¸é«˜æ•ˆã€‚</li>
<li><strong>ä¸æ¨¡å‹è®­ç»ƒæ–¹å¼ä¿æŒä¸€è‡´</strong>ï¼š<br/>
ä½ ç»Ÿè®¡å’Œæ ¼å¼åŒ–æ–‡æœ¬çš„æ–¹å¼ä¸æ¨¡å‹çš„é¢„æœŸä¸€è‡´ï¼Œ<br/>
ä¹Ÿå°±èƒ½æœ€å¤§åŒ–æ£€ç´¢çš„å‡†ç¡®æ€§ã€‚</li>
</ol>
<p>è¿™ç‚¹éå¸¸å…³é”®ï¼š<br/>
å¦‚æœæˆ‘ä»¬çš„â€œåˆ†å—é€»è¾‘â€å’ŒåµŒå…¥æ¨¡å‹çš„è®­ç»ƒæ–¹å¼ä¸åŒ¹é…ï¼Œ<br/>
è¯­ä¹‰æ£€ç´¢çš„ç»“æœå°±ä¼šèµ°æ ·â€”â€”å°±åƒä½ åœ¨ä¸€ä¸ªå›¾ä¹¦é¦†é‡ŒæŸ¥ä¹¦ï¼Œä½†å¡ç‰‡å’Œä¹¦æ¶ç”¨çš„æ˜¯ä¸¤å¥—å®Œå…¨ä¸åŒçš„ç¼–ç›®ç³»ç»Ÿã€‚</p>
<p>å…ˆåˆå§‹åŒ– tokenizerï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Initialize tokenizer for robust, token-aware chunking</span>
<span class="hljs-attr">tokenizer</span> = tiktoken.get_encoding(<span class="hljs-string">"cl100k_base"</span>)
</code></pre>
<p>RAG åœ¨ä¿¡æ¯è¢«**åˆ‡åˆ†æˆèšç„¦çš„å°å—ï¼ˆchunksï¼‰**æ—¶æ•ˆæœæœ€å¥½ã€‚<br/>
ç›¸æ¯”æŒ‰å­—ç¬¦æ•°æˆªæ–­ï¼Œæˆ‘ä»¬ä¼šæŒ‰ <strong>token æ•°é‡</strong> æˆªæ–­ï¼Œæ›´é€‚åˆ LLMã€‚</p>
<p>åœ¨ç¤ºä¾‹ç¨‹åºä¸­ï¼Œæˆ‘ä»¬è®¾å®šï¼š</p>
<ul>
<li><code>chunk_size = 400</code> tokens</li>
<li><code>overlap = 50</code> tokens</li>
</ul>
<p>**é‡å ï¼ˆoverlapï¼‰**å¯ä»¥å¸®åŠ©ç›¸é‚»å—ä¹‹é—´ä¿æŒä¸Šä¸‹æ–‡è¿ç»­æ€§ã€‚<br/>
å®é™…é¡¹ç›®ä¸­ï¼Œä½ éœ€è¦æ ¹æ®æ•°æ®ç±»å‹æ¥è°ƒèŠ‚ chunk å¤§å°ä¸é‡å å¤§å°ã€‚</p>
<p>ä¸‹é¢çš„ <code>chunk_text</code> å‡½æ•°å°±è´Ÿè´£ï¼š</p>
<ul>
<li>æŒ‰ token æ•°é‡å°†é•¿æ–‡æœ¬åˆ‡æˆä¸€ä¸ªä¸ªé‡å çª—å£ï¼Œ</li>
<li>å†å°†è¿™äº›çª—å£è¿˜åŸæˆæ–‡æœ¬ï¼Œä¾›åç»­å‘é‡åŒ–ä½¿ç”¨ï¼š</li>
</ul>

<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">chunk_text</span>(<span class="hljs-params">text, chunk_size=<span class="hljs-number">400</span>, overlap=<span class="hljs-number">50</span></span>):
    <span class="hljs-string">"""Chunks text based on token count with overlap (Best practice for RAG)."""</span>
    tokens = tokenizer.encode(text)
    chunks = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(tokens), chunk_size - overlap):
        chunk_tokens = tokens[i:i + chunk_size]
        chunk_text = tokenizer.decode(chunk_tokens)
        <span class="hljs-comment"># Basic cleanup</span>
        chunk_text = chunk_text.replace(<span class="hljs-string">"\n"</span>, <span class="hljs-string">" "</span>).strip()
        <span class="hljs-keyword">if</span> chunk_text:
            chunks.append(chunk_text)
    <span class="hljs-keyword">return</span> chunks
</code></pre>
<p>æœ‰äº†è¿™äº› chunk ä¹‹åï¼Œæˆ‘ä»¬å°±éœ€è¦æŠŠå®ƒä»¬è½¬æ¢æˆ embeddingsã€‚<br/>
ç”±äº API è°ƒç”¨æœ‰æ—¶ä¼šå¤±è´¥ï¼ˆæ¯”å¦‚ç½‘ç»œæŠ–åŠ¨ï¼‰ï¼Œæˆ‘ä»¬ä¼šåŠ ä¸€ä¸ª<strong>å¸¦é‡è¯•æœºåˆ¶çš„å°è£…</strong>ã€‚</p>
<p><code>tenacity</code> åº“æä¾›çš„ <code>@retry</code> è£…é¥°å™¨å¯ä»¥è‡ªåŠ¨é‡è¯•å¤±è´¥çš„è°ƒç”¨ï¼Œå¹¶é‡‡ç”¨**æŒ‡æ•°é€€é¿ï¼ˆexponential backoffï¼‰**ç­–ç•¥ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@retry(<span class="hljs-params">
    wait=wait_random_exponential(<span class="hljs-params"><span class="hljs-built_in">min</span>=<span class="hljs-number">1</span>, <span class="hljs-built_in">max</span>=<span class="hljs-number">60</span></span>),
    stop=stop_after_attempt(<span class="hljs-params"><span class="hljs-number">6</span></span>)
</span>)</span>
</code></pre>
<p>æˆ‘ä»¬ä¸ä¼šå•æ¡ä¸Šä¼  chunkï¼Œè€Œæ˜¯æŒ‰æ‰¹æˆç»„å‘é€ï¼Œå› æ­¤å®šä¹‰ <code>get_embeddings_batch</code> å‡½æ•°ï¼š<br/>
å®ƒä¼šå°†ä¸€æ‰¹æ–‡æœ¬å‘é€ç»™ OpenAI çš„ Embedding APIï¼Œè¿”å›å¯¹åº”çš„å‘é‡ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@retry(<span class="hljs-params">
    wait=wait_random_exponential(<span class="hljs-params"><span class="hljs-built_in">min</span>=<span class="hljs-number">1</span>, <span class="hljs-built_in">max</span>=<span class="hljs-number">60</span></span>),
    stop=stop_after_attempt(<span class="hljs-params"><span class="hljs-number">6</span></span>)
</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_embeddings_batch</span>(<span class="hljs-params">texts, model=EMBEDDING_MODEL</span>):
    <span class="hljs-string">"""Generates embeddings for a batch of texts using OpenAI, with retries."""</span>
    <span class="hljs-comment"># OpenAI expects the input texts to have newlines replaced by spaces</span>
    texts = [t.replace(<span class="hljs-string">"\n"</span>, <span class="hljs-string">" "</span>) <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> texts]
    response = client.embeddings.create(<span class="hljs-built_in">input</span>=texts, model=model)
    <span class="hljs-keyword">return</span> [item.embedding <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> response.data]
</code></pre>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»å…·å¤‡äº†ï¼š</p>
<ul>
<li><strong>æŒ‰ token åˆ‡åˆ†æ–‡æœ¬</strong>çš„èƒ½åŠ›ï¼Œ</li>
<li><strong>ç¨³å®šç”Ÿæˆ embeddings</strong> çš„èƒ½åŠ›ï¼ˆå¸¦è‡ªåŠ¨é‡è¯•ï¼‰ã€‚</li>
</ul>
<p>ä¸‹ä¸€æ­¥ï¼Œå°±å¯ä»¥æ­£å¼å¼€å§‹å¯¹â€œçŸ¥è¯†æ•°æ®â€å’Œâ€œä¸Šä¸‹æ–‡æ•°æ®â€è¿›è¡Œå¤„ç†ï¼Œå¹¶æŠŠå®ƒä»¬ä¸Šä¼ åˆ°å‘é‡åº“ä¸­äº†ã€‚</p>
<h3 data-id="heading-9">å¤„ç†å¹¶ä¸Šä¼ ï¼ˆupsertï¼‰æ•°æ®</h3>
<p>æ•°æ®å‡†å¤‡çš„æœ€åä¸€æ­¥ï¼Œå°±æ˜¯<strong>å¤„ç†è¿™äº›æ•°æ®å¹¶æŠŠå®ƒä»¬ä¸Šä¼ åˆ° Pinecone</strong>ã€‚<br/>
è¿™ä¸€æ­¥éå¸¸å…³é”®ï¼šåªæœ‰å½“å‘é‡çœŸæ­£å­˜è¿›å‘é‡åº“åï¼Œæ™ºèƒ½ä½“æ‰èƒ½åœ¨è¿è¡Œæ—¶æ£€ç´¢åˆ°å®ƒä»¬ã€‚</p>
<p>æˆ‘ä»¬åˆ†ä¸¤éƒ¨åˆ†æ¥åšï¼š</p>
<ol>
<li><strong>ä¸Šä¸‹æ–‡åº“ï¼ˆContext Libraryï¼‰</strong> ï¼šä¸Šä¼ è¯­ä¹‰è“å›¾ï¼ˆsemantic blueprintsï¼‰</li>
<li><strong>çŸ¥è¯†åº“ï¼ˆKnowledge Baseï¼‰</strong> ï¼šä¸Šä¼ äº‹å®æ•°æ®</li>
</ol>
<h4 data-id="heading-10">ä¸Šä¸‹æ–‡åº“ï¼ˆContext Libraryï¼‰</h4>
<p>å…ˆä»ä¸Šä¸‹æ–‡åº“å¼€å§‹ã€‚<br/>
è¿™é‡Œå­˜æ”¾çš„æ˜¯æˆ‘ä»¬çš„<strong>è¯­ä¹‰è“å›¾</strong>ï¼Œä¹Ÿå°±æ˜¯æŒ‡å¯¼ç³»ç»Ÿâ€œè¯¥å¦‚ä½•å†™â€çš„ç¨‹åºæ€§æŒ‡ä»¤ã€‚</p>
<p>ç¨‹åºä¼šéå†å‰é¢å®šä¹‰å¥½çš„ <code>context_blueprints</code> åˆ—è¡¨ï¼š</p>
<ul>
<li>
<p>å¯¹æ¯ä¸ª blueprintï¼Œç”¨ <code>get_embeddings_batch</code> å¯¹å…¶ <strong>description</strong> åšå‘é‡åŒ–ï¼›</p>
<ul>
<li>åç»­åšè¯­ä¹‰æ£€ç´¢æ—¶ï¼ŒæŸ¥çš„å°±æ˜¯è¿™ä¸ªæè¿°æ–‡æœ¬ï¼Œæ‰€ä»¥åªæœ‰å®ƒéœ€è¦è¿›å…¥å‘é‡ç©ºé—´ã€‚</li>
</ul>
</li>
<li>
<p>åŒæ—¶æ„å»º Pinecone çš„å‘é‡å¯¹è±¡ï¼š</p>
<ul>
<li>
<p><code>id</code>ï¼šå”¯ä¸€æ ‡è¯†ç¬¦ï¼›</p>
</li>
<li>
<p><code>values</code>ï¼šembedding å‘é‡ï¼›</p>
</li>
<li>
<p><code>metadata</code>ï¼šåŒ…å«ä¸¤ç±»ä¿¡æ¯ï¼š</p>
<ul>
<li>å†å­˜ä¸€ä»½ <code>description</code> ä»¥ä¾¿äººç±»æŸ¥çœ‹ï¼›</li>
<li>æœ€å…³é”®çš„æ˜¯ <code>blueprint_json</code>ï¼Œå³å®Œæ•´çš„ JSON è¯­ä¹‰è“å›¾æŒ‡ä»¤ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>æ³¨æ„ï¼š<strong>JSON è“å›¾æœ¬èº«ä¸åšå‘é‡åŒ–</strong>ï¼Œè€Œæ˜¯ä½œä¸º metadata å­˜å‚¨ã€‚<br/>
å½“æˆ‘ä»¬é€šè¿‡ description æ‰¾åˆ°è¿™ä¸ª vector æ—¶ï¼Œå°±èƒ½é¡ºå¸¦æŠŠå®Œæ•´è“å›¾å–å‡ºæ¥ä½¿ç”¨ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># --- 6.1. Context Library ---</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nProcessing and uploading Context Library to namespace: <span class="hljs-subst">{NAMESPACE_CONTEXT}</span>"</span>)
vectors_context = []
<span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> tqdm(context_blueprints):
    <span class="hljs-comment"># We embed the DESCRIPTION (the intent)</span>
    embedding = get_embeddings_batch([item[<span class="hljs-string">'description'</span>]])[<span class="hljs-number">0</span>]
    vectors_context.append({
        <span class="hljs-string">"id"</span>: item[<span class="hljs-string">'id'</span>],
        <span class="hljs-string">"values"</span>: embedding,
        <span class="hljs-string">"metadata"</span>: {
            <span class="hljs-string">"description"</span>: item[<span class="hljs-string">'description'</span>],
            <span class="hljs-comment"># The blueprint itself (JSON string) is stored as metadata</span>
            <span class="hljs-string">"blueprint_json"</span>: item[<span class="hljs-string">'blueprint'</span>]
        }
    })
</code></pre>
<p>å½“æ‰€æœ‰å‘é‡å‡†å¤‡å¥½ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå®ƒä»¬<strong>upsert</strong> åˆ° Pinecone é‡Œã€‚</p>
<blockquote>
<p>upsert = å¦‚æœ ID å·²å­˜åœ¨åˆ™æ›´æ–°ï¼Œå¦åˆ™æ’å…¥æ–°æ•°æ®ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å°†è¿™äº›å‘é‡ä¸Šä¼ åˆ° <code>NAMESPACE_CONTEXT</code> å¯¹åº”çš„ namespace ä¸­ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Upsert data</span>
<span class="hljs-keyword">if</span> vectors_context:
    index.upsert(vectors=vectors_context, namespace=NAMESPACE_CONTEXT)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Successfully uploaded <span class="hljs-subst">{<span class="hljs-built_in">len</span>(vectors_context)}</span> context vectors."</span>)
</code></pre>
<p>å¦‚æœè¿è¡ŒæˆåŠŸï¼Œä½ ä¼šçœ‹åˆ°ä¸€æ¡ç¡®è®¤ä¿¡æ¯ï¼Œè¯´æ˜ä¸Šä¼ äº†å¤šå°‘æ¡å‘é‡ã€‚<br/>
åˆ°è¿™ä¸€æ­¥ä¸ºæ­¢ï¼Œ<strong>ä¸Šä¸‹æ–‡åº“å·²ç»å†™å…¥ ContextLibrary å‘½åç©ºé—´</strong>ï¼Œè¿è¡Œæ—¶ Librarian æ™ºèƒ½ä½“å°±å¯ä»¥å¼€å§‹æŸ¥è¯¢å®ƒäº†ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¤„ç†åŒ RAG çš„å¦ä¸€åŠï¼š<strong>çŸ¥è¯†åº“</strong>ã€‚</p>
<h4 data-id="heading-11">çŸ¥è¯†åº“ï¼ˆKnowledge Baseï¼‰</h4>
<p>ç°åœ¨æ¥å¡«å……çŸ¥è¯†åº“ â€”â€” è¿™é‡Œå­˜æ”¾äº‹å®æ•°æ®ï¼Œä¾› Researcher æ™ºèƒ½ä½“æ£€ç´¢ã€‚</p>
<p>ç¬¬ä¸€æ­¥æ˜¯å¯¹åŸå§‹çŸ¥è¯†å­—ç¬¦ä¸² <code>knowledge_data_raw</code> è°ƒç”¨ <code>chunk_text</code>ï¼Œ<br/>
æŠŠå®ƒåˆ‡æˆæ›´å°ã€æ˜“äºæ£€ç´¢çš„ç‰‡æ®µï¼ˆchunksï¼‰ã€‚</p>
<p>ç„¶åæˆ‘ä»¬æŒ‰æ‰¹æ¬¡å¤„ç†è¿™äº› chunksã€‚<br/>
ç¤ºä¾‹ä¸­ä½¿ç”¨çš„æ‰¹å¤§å°æ˜¯ 100ï¼š</p>
<ul>
<li>
<p>é€æ‰¹ç”Ÿæˆ embeddingsï¼ˆ<code>get_embeddings_batch</code>ï¼‰ï¼›</p>
</li>
<li>
<p>ä¸º Pinecone å‡†å¤‡å‘é‡ç»“æ„ï¼š</p>
<ul>
<li>æ¯ä¸ª chunk åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ <code>id</code>ï¼›</li>
<li><code>metadata</code> ä¸­å­˜å‚¨åŸå§‹æ–‡æœ¬ <code>text</code>ï¼Œä¾¿äºæ£€ç´¢æ—¶è¿”å›ã€‚</li>
</ul>
</li>
</ul>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># --- 6.2. Knowledge Base ---</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nProcessing and uploading Knowledge Base to namespace: <span class="hljs-subst">{NAMESPACE_KNOWLEDGE}</span>"</span>)
<span class="hljs-comment"># Chunk the knowledge data</span>
knowledge_chunks = chunk_text(knowledge_data_raw)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"Created <span class="hljs-subst">{<span class="hljs-built_in">len</span>(knowledge_chunks)}</span> knowledge chunks."</span>)
vectors_knowledge = []
batch_size = <span class="hljs-number">100</span> <span class="hljs-comment"># Process in batches</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(knowledge_chunks), batch_size)):
    batch_texts = knowledge_chunks[i:i+batch_size]
    batch_embeddings = get_embeddings_batch(batch_texts)

    batch_vectors = []
    <span class="hljs-keyword">for</span> j, embedding <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(batch_embeddings):
        chunk_id = <span class="hljs-string">f"knowledge_chunk_<span class="hljs-subst">{i+j}</span>"</span>
        batch_vectors.append({
            <span class="hljs-string">"id"</span>: chunk_id,
            <span class="hljs-string">"values"</span>: embedding,
            <span class="hljs-string">"metadata"</span>: {
                <span class="hljs-string">"text"</span>: batch_texts[j]
            }
        })
    <span class="hljs-comment"># Upsert the batch</span>
    index.upsert(vectors=batch_vectors, namespace=NAMESPACE_KNOWLEDGE)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"Successfully uploaded <span class="hljs-subst">{<span class="hljs-built_in">len</span>(knowledge_chunks)}</span> knowledge vectors."</span>)
</code></pre>
<p>è¿è¡Œåï¼Œè¾“å‡ºä¼šåŒæ—¶å±•ç¤ºä¸Šä¸‹æ–‡åº“ä¸çŸ¥è¯†åº“çš„ä¸Šä¼ è¿›åº¦ï¼š</p>
<ul>
<li>
<p><code>tqdm</code> è¿›åº¦æ¡ä¼šå®æ—¶æ˜¾ç¤ºæ¯ä¸€æ­¥åµŒå…¥çš„æƒ…å†µï¼›</p>
</li>
<li>
<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼š</p>
<ul>
<li>
<p>ä¸Šä¸‹æ–‡åº“ç¡®è®¤æˆåŠŸä¸Šä¼ äº† 3 æ¡è“å›¾å‘é‡ï¼›</p>
</li>
<li>
<p>çŸ¥è¯†åº“æ•°æ®å¾ˆå°ï¼Œè¢«åˆ‡æˆ 2 ä¸ª chunkï¼›</p>
<ul>
<li>å®ƒä»¬éƒ½è½åœ¨äº†åŒä¸€æ‰¹ï¼ˆbatchï¼‰100 æ¡çš„èŒƒå›´å†…ï¼›</li>
</ul>
</li>
<li>
<p>æœ€ç»ˆè¾“å‡ºç¡®è®¤è¿™ 2 ä¸ªå‘é‡ä¹Ÿéƒ½æˆåŠŸå†™å…¥ï¼š</p>
</li>
</ul>
</li>
</ul>

<pre><code class="hljs language-vbnet" lang="vbnet">Processing <span class="hljs-built_in">and</span> uploading Context Library <span class="hljs-keyword">to</span> <span class="hljs-keyword">namespace</span>: ContextLibrary
[Tqdm output <span class="hljs-keyword">for</span> <span class="hljs-number">3</span>/<span class="hljs-number">3</span> iterations]
Successfully uploaded <span class="hljs-number">3</span> context vectors.
Processing <span class="hljs-built_in">and</span> uploading Knowledge Base <span class="hljs-keyword">to</span> <span class="hljs-keyword">namespace</span>: KnowledgeStore
Created <span class="hljs-number">2</span> knowledge chunks.
[Tqdm output <span class="hljs-keyword">for</span> <span class="hljs-number">1</span>/<span class="hljs-number">1</span> iterations]
Successfully uploaded <span class="hljs-number">2</span> knowledge vectors.
</code></pre>
<p>è‡³æ­¤ï¼š</p>
<ul>
<li><strong>ä¸Šä¸‹æ–‡åº“ï¼ˆContextLibraryï¼‰</strong> å’Œ</li>
<li><strong>çŸ¥è¯†åº“ï¼ˆKnowledgeStoreï¼‰</strong></li>
</ul>
<p>éƒ½å·²ç»æˆåŠŸå†™å…¥å‘é‡å­˜å‚¨ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨è¿è¡Œæ—¶æ„å»ºçœŸæ­£çš„<strong>ä¸Šä¸‹æ–‡æ„ŸçŸ¥å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ</strong>ï¼ˆcontext-aware MASï¼‰ï¼Œ<br/>
è®©æ™ºèƒ½ä½“ä¸€è¾¹æŸ¥äº‹å®ï¼Œä¸€è¾¹æŸ¥â€œå†™ä½œè“å›¾â€ï¼Œå†æŠŠä¸¤è€…åœ¨ç”Ÿæˆé˜¶æ®µç»„åˆèµ·æ¥ã€‚</p>
<h3 data-id="heading-12">æ„å»ºä¸Šä¸‹æ–‡æ„ŸçŸ¥ç³»ç»Ÿ</h3>
<p>ç°åœ¨æˆ‘ä»¬çš„æ•°æ®å·²ç» idx_4273754a å‡†å¤‡å¥½å¹¶å­˜å…¥äº† Pineconeï¼Œæ˜¯æ—¶å€™æŠŠæ‰€æœ‰ä¸œè¥¿ç»„åˆèµ·æ¥äº†ã€‚æœ¬èŠ‚æˆ‘ä»¬å°†å®ç°å›¾ 3.3 å±•ç¤ºçš„<strong>ä¸Šä¸‹æ–‡æ„ŸçŸ¥ç³»ç»Ÿï¼ˆcontext-aware systemï¼‰</strong> ã€‚å…·ä½“æ­¥éª¤åœ¨ <code>Context_Aware_MAS.ipynb</code> ç¬”è®°æœ¬ä¸­ï¼Œå¯¹åº”çš„æ˜¯æ•´å¥—æ¶æ„çš„<strong>è¿è¡Œæ—¶æ‰§è¡Œé˜¶æ®µ</strong>ã€‚æˆ‘ä»¬ä¼šå…ˆå®šä¹‰è´Ÿè´£æ ¸å¿ƒä»»åŠ¡çš„ä¸“ä¸šæ™ºèƒ½ä½“ï¼Œç„¶åå†çœ‹ Orchestrator æ˜¯å¦‚ä½•åè°ƒæ•´ä¸ªæµç¨‹çš„ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57404632b2ae45b596e225130c098884~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWw5o2u5pm66IO96ICB5Y-45py6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1764172772&amp;x-signature=w0Ao0eRpiNGOopemU4GPtQZHyYY%3D" alt="image.png" loading="lazy"/></p>
<p>å›¾ 3.3ï¼šä¸Šä¸‹æ–‡æ„ŸçŸ¥ MAS æµç¨‹å›¾</p>
<p>è¿™å¼ æµç¨‹å›¾å±•ç¤ºäº†ä¸€ä¸ªé«˜å±‚ç”¨æˆ·ç›®æ ‡å¦‚ä½•è¢«è½¬åŒ–ä¸ºç»“æ„åŒ–çš„å·¥ä½œæµã€‚å®ƒå¾ˆå¥½åœ°æé†’æˆ‘ä»¬ï¼šç”Ÿæˆå¼ AI å¹¶ä¸æ˜¯â€œå¼€ç®±å³ç”¨å°± magically å·¥ä½œâ€ã€‚<strong>è°¨æ…çš„å·¥ç¨‹è®¾è®¡å’Œä¸Šä¸‹æ–‡ç®¡ç†</strong>æ‰æ˜¯ç³»ç»Ÿå¯é è¿è¡Œçš„å…³é”®ã€‚</p>
<p>åœ¨å›¾ä¸­ï¼Œè“è‰²æ–¹å—ä»£è¡¨ Orchestratorï¼ˆç¼–æ’å™¨ï¼‰ï¼Œå®ƒä½œä¸ºä¸­å¤®åè°ƒè€…ï¼ŒæŠŠä»»åŠ¡åˆ†æ´¾ç»™è‹¥å¹²<strong>ä¸“ä¸šæ™ºèƒ½ä½“ï¼ˆç»¿è‰²æ–¹å—ï¼‰</strong> ï¼šLibrarianã€Researcher å’Œ Writerã€‚è¿™äº›æ™ºèƒ½ä½“ä¼šä¸å¤–éƒ¨æœåŠ¡ï¼ˆæ©™è‰²æ–¹å—ï¼‰äº¤äº’ï¼Œä¾‹å¦‚ Pineconeï¼ˆç”¨äºçŸ¥è¯†å’Œè“å›¾æ£€ç´¢ï¼‰ä»¥åŠ LLMï¼ˆç”¨äºå‘é‡åŒ–ã€åˆ†æä¸ç”Ÿæˆï¼‰ã€‚</p>
<p>æœ‰äº†è¿™ä¸ªå…¨å±€å›¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ·±å…¥ç»†èŠ‚ï¼Œä»æ™ºèƒ½ä½“æœ¬èº«å¼€å§‹ã€‚</p>
<h4 data-id="heading-13">å®šä¹‰æ™ºèƒ½ä½“</h4>
<p>æ•´ä¸ª MAS ä¾èµ–ä¸‰ä¸ª idx_82f9cb5d ä¸“é—¨çš„æ™ºèƒ½ä½“ï¼Œæ¯ä¸ªæ™ºèƒ½ä½“éƒ½æœ‰æ˜ç¡®çš„èŒè´£ï¼š</p>
<ul>
<li><strong>Context Librarianï¼ˆä¸Šä¸‹æ–‡é¦†å‘˜ï¼‰</strong> ï¼šä»ä¸Šä¸‹æ–‡åº“ä¸­æ£€ç´¢ idx_71e1c2b3 è¿‡ç¨‹æ€§ idx_0bbfccaf æŒ‡ä»¤</li>
<li><strong>Researcherï¼ˆç ”ç©¶å‘˜ï¼‰</strong> ï¼šä»çŸ¥è¯†åº“ä¸­æŠ½å– idx_4f52270a å¹¶ç»¼åˆ idx_6e261e5c äº‹å®æ•°æ®</li>
<li><strong>Writerï¼ˆå†™ä½œè€…ï¼‰</strong> ï¼šå°† idx_3873fac6 è¿‡ç¨‹æ€§æŒ‡ä»¤ idx_8039414a ä¸äº‹å®æ•°æ®ç»“åˆï¼Œç”Ÿæˆæœ€ç»ˆè¾“å‡º</li>
</ul>
<p>æ‰€æœ‰æ™ºèƒ½ä½“éƒ½é€šè¿‡ MCP è¿›è¡Œé€šä¿¡ã€‚æˆ‘ä»¬å…ˆä» Librarian æ™ºèƒ½ä½“å¼€å§‹ã€‚</p>
<h5 data-id="heading-14">Context Librarian æ™ºèƒ½ä½“</h5>
<p>Context idx_975aad91 Librarian çš„èŒè´£æ˜¯ä»å‘é‡åº“ä¸­æ£€ç´¢æ­£ç¡®çš„<strong>è¯­ä¹‰è“å›¾ï¼ˆSemantic Blueprintï¼‰</strong> ã€‚<br/>
è¿™æ˜¯ä¸€ç§æ›´é«˜çº§çš„ RAG ç”¨æ³•ï¼šæ£€ç´¢çš„ä¸æ˜¯â€œäº‹å®â€ï¼Œè€Œæ˜¯**â€œå†™ä½œæ–¹å¼â€** â€”â€” ä¹Ÿå°±æ˜¯è¿‡ç¨‹æ€§æŒ‡ä»¤ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">agent_context_librarian</span>(<span class="hljs-params">mcp_message</span>):
    <span class="hljs-string">"""
    Retrieves the appropriate Semantic Blueprint from the Context Library.
    """</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n[Librarian] Activated. Analyzing intent..."</span>)
    requested_intent = mcp_message[<span class="hljs-string">'content'</span>][<span class="hljs-string">'intent_query'</span>]
    results = query_pinecone(requested_intent, NAMESPACE_CONTEXT, top_k=<span class="hljs-number">1</span>)

    <span class="hljs-keyword">if</span> results:
        <span class="hljs-keyword">match</span> = results[<span class="hljs-number">0</span>]
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[Librarian] Found blueprint '<span class="hljs-subst">{<span class="hljs-keyword">match</span>[<span class="hljs-string">'id'</span>]}</span>' (Score: <span class="hljs-subst">{<span class="hljs-keyword">match</span>[<span class="hljs-string">'score'</span>]:<span class="hljs-number">.2</span>f}</span>)"</span>)
        blueprint_json = <span class="hljs-keyword">match</span>[<span class="hljs-string">'metadata'</span>][<span class="hljs-string">'blueprint_json'</span>]
        content = {<span class="hljs-string">"blueprint"</span>: blueprint_json}
    <span class="hljs-keyword">else</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"[Librarian] No specific blueprint found. Returning default."</span>)
        content = {<span class="hljs-string">"blueprint"</span>: json.dumps({<span class="hljs-string">"instruction"</span>: <span class="hljs-string">"Generate the content neutrally."</span>})}

    <span class="hljs-keyword">return</span> create_mcp_message(<span class="hljs-string">"Librarian"</span>, content)
</code></pre>
<p>è¿™é‡Œå‘ç”Ÿçš„äº‹æƒ…æ˜¯ï¼š</p>
<ul>
<li>Librarian ä½¿ç”¨ç”¨æˆ·çš„æ„å›¾ <code>intent_query</code>ï¼Œåœ¨ <code>ContextLibrary</code> å‘½åç©ºé—´é‡Œåšè¯­ä¹‰æ£€ç´¢ï¼›</li>
<li>æ‰¾åˆ°åŒ¹é…çš„ blueprint åï¼Œä» metadata ä¸­å–å‡º JSON æ ¼å¼çš„æŒ‡ä»¤ï¼›</li>
<li>å†æŠŠè¿™äº›æŒ‡ä»¤å°è£…åˆ°ä¸€ä¸ªæ–°çš„ MCP æ¶ˆæ¯ä¸­è¿”å›ã€‚</li>
</ul>
<p>è¿™æ ·ï¼ŒWriter æ™ºèƒ½ä½“å°±èƒ½æ ¹æ®<strong>åŠ¨æ€æ£€ç´¢åˆ°çš„ç¨‹åºæ€§æŒ‡å—</strong>æ¥å†™ä½œã€‚</p>
<p>ä»£ç ä¸­è¿˜åŒ…å«äº†ä¸€ä¸ªé‡è¦çš„<strong>å…œåº•æœºåˆ¶</strong>ï¼š<br/>
å¦‚æœ Librarian æ²¡æ‰¾åˆ°ä»»ä½•åŒ¹é…çš„è¯­ä¹‰è“å›¾ï¼Œå®ƒå°±ä¸ä¼šç›´æ¥æŠ¥é”™ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ª<strong>é»˜è®¤è“å›¾</strong>ï¼š</p>
<blockquote>
<p><code>{"instruction": "Generate the content neutrally."}</code></p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœç”¨æˆ·çš„æ„å›¾ä¸ç°æœ‰è“å›¾éƒ½ä¸åŒ¹é…ï¼Œç³»ç»Ÿä¸ä¼šåœæ‘†ï¼Œè€Œæ˜¯é€€å›åˆ°â€œä¸­æ€§ç”Ÿæˆâ€çš„ç®€å•ç­–ç•¥ã€‚<br/>
è¿™æ · Writer ä¾ç„¶èƒ½æ‹¿åˆ°ä¸€å¥—è¿‡ç¨‹æ€§æŒ‡å¯¼ï¼Œå“ªæ€•åªæ˜¯â€œä¸­æ€§å†™ä½œâ€ï¼Œç³»ç»Ÿä¹Ÿèƒ½ç»§ç»­å®Œæˆä»»åŠ¡ï¼Œè€Œä¸æ˜¯ idx_3aa5ac30 æ•´ä¸ªæµç¨‹ä¸­æ–­ã€‚</p>
<h5 data-id="heading-15">Researcher æ™ºèƒ½ä½“</h5>
<p>Researcher æ™ºèƒ½ä½“ idx_5affbcf7 ä¸“æ³¨äºä»çŸ¥è¯†åº“ä¸­æŠ½å– idx_2c1b5574 ç›¸å…³äº‹å®ï¼Œå¹¶æŠŠè¿™äº›ä¿¡æ¯ç»¼åˆæˆç®€æ˜çš„æ‘˜è¦ï¼Œæ–¹ä¾¿ Writer ç›´æ¥ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">agent_researcher</span>(<span class="hljs-params">mcp_message</span>):
    <span class="hljs-string">"""
    Retrieves and synthesizes factual information from the Knowledge Base.
    """</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n[Researcher] Activated. Investigating topic..."</span>)
    topic = mcp_message[<span class="hljs-string">'content'</span>][<span class="hljs-string">'topic_query'</span>]

    results = query_pinecone(topic, NAMESPACE_KNOWLEDGE, top_k=<span class="hljs-number">3</span>)

    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> results:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"[Researcher] No relevant information found."</span>)
        <span class="hljs-keyword">return</span> create_mcp_message(<span class="hljs-string">"Researcher"</span>, {<span class="hljs-string">"facts"</span>: <span class="hljs-string">"No data found."</span>})

    source_texts = [<span class="hljs-keyword">match</span>[<span class="hljs-string">'metadata'</span>][<span class="hljs-string">'text'</span>] <span class="hljs-keyword">for</span> <span class="hljs-keyword">match</span> <span class="hljs-keyword">in</span> results]
    system_prompt = <span class="hljs-string">"""You are an expert research synthesis AI. Synthesize the provided source texts into a concise, bullet-pointed summary relevant to the user's topic. Focus strictly on the facts provided in the sources. Do not add outside information."""</span>
    user_prompt = <span class="hljs-string">f"Topic: <span class="hljs-subst">{topic}</span>\n\nSources:\n"</span> + <span class="hljs-string">"\n\n---\n\n"</span>.join(source_texts)

    findings = call_llm(system_prompt, user_prompt)

    <span class="hljs-keyword">return</span> create_mcp_message(<span class="hljs-string">"Researcher"</span>, {<span class="hljs-string">"facts"</span>: findings})
</code></pre>
<p>åœ¨è¿™é‡Œï¼ŒResearcher ä¿æŒè¾“å‡º<strong>ç®€æ´ä¸”äº‹å®å¯¼å‘</strong>ï¼š</p>
<ul>
<li>
<p>åªå…³å¿ƒä»çŸ¥è¯†åº“ä¸­å¬å›çš„æ–‡æœ¬ï¼›</p>
</li>
<li>
<p>ç³»ç»Ÿæç¤ºï¼ˆsystem_promptï¼‰æ˜ç¡®è¦æ±‚ï¼š</p>
<ul>
<li><strong>ä¸¥æ ¼åŸºäºç»™å®šæ¥æº</strong>ï¼›</li>
<li><strong>ä¸å¾—æ·»åŠ å¤–éƒ¨ä¿¡æ¯</strong>ï¼›</li>
</ul>
</li>
</ul>
<p>å³ä½¿åœ¨æ›´å¤§çš„ç³»ç»Ÿä¸­ï¼Œè¿™ç§å—æ§çš„â€œäº‹å®æ‘˜è¦â€æ­¥éª¤ä¹Ÿå¾ˆå…³é”®ï¼Œå®ƒå¯ä»¥é¿å… Writer è¢«ä¸€å¤§å †åŸå§‹æ–‡æœ¬æ·¹æ²¡ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ª Writer æ™ºèƒ½ä½“æ¥çœŸæ­£å†™å‡ºå†…å®¹ã€‚</p>
<h5 data-id="heading-16">Writer æ™ºèƒ½ä½“</h5>
<p>Writer æ™ºèƒ½ä½“æ˜¯ä¸¤ä¸ªä¿¡æ¯æµçš„æ±‡åˆç‚¹ï¼š<br/>
å®ƒæŠŠ<strong>è¯­ä¹‰è“å›¾ï¼ˆè¿‡ç¨‹æ€§æŒ‡ä»¤ï¼‰<strong>å’Œ</strong>äº‹å®æ‘˜è¦</strong>ç»“åˆèµ·æ¥ï¼Œç”Ÿæˆæœ€ç»ˆç»“æ„åŒ–çš„è¾“å‡ºï¼š</p>
<pre><code class="hljs language-ini" lang="ini">def agent_writer(mcp_message):
    """
    Combines factual research with the semantic blueprint to generate final output.
    """
    print("\n<span class="hljs-section">[Writer]</span> Activated. Applying blueprint to facts...")

    <span class="hljs-attr">facts</span> = mcp_message[<span class="hljs-string">'content'</span>][<span class="hljs-string">'facts'</span>]
    <span class="hljs-attr">blueprint_json_string</span> = mcp_message[<span class="hljs-string">'content'</span>][<span class="hljs-string">'blueprint'</span>]
    <span class="hljs-comment"># The Writer's System Prompt incorporates the dynamically retrieved blueprint</span>
    <span class="hljs-attr">system_prompt</span> = f<span class="hljs-string">"""You are an expert content generation AI.
Your task is to generate content based on the provided RESEARCH FINDINGS.
Crucially, you MUST structure, style, and constrain your output according to the rules defined in the SEMANTIC BLUEPRINT provided below.

    --- SEMANTIC BLUEPRINT (JSON) ---
    {blueprint_json_string}
    --- END SEMANTIC BLUEPRINT ---

Adhere strictly to the blueprint's instructions, style guides, and goals. The blueprint defines HOW you write; the research defines WHAT you write about.
    """</span>

    <span class="hljs-attr">user_prompt</span> = f<span class="hljs-string">"--- RESEARCH FINDINGS ---\n{facts}\n--- END RESEARCH FINDINGS ---\nGenerate the content now."</span>
    <span class="hljs-attr">final_output</span> = call_llm(system_prompt, user_prompt)

    return create_mcp_message("Writer", {"output": final_output})
</code></pre>
<p>è¿™ä¸ªæ™ºèƒ½ä½“çš„å…³é”®ç‚¹åœ¨äºï¼Œå®ƒé€šè¿‡ blueprint å¯¹ LLM è¿›è¡Œ<strong>åŠ¨æ€â€œç¼–ç¨‹â€</strong> ï¼š</p>
<ul>
<li>blueprint è§„å®šâ€œ<strong>æ€ä¹ˆå†™ï¼ˆHOWï¼‰</strong> â€ï¼›</li>
<li>facts å†³å®šâ€œ<strong>å†™ä»€ä¹ˆï¼ˆWHATï¼‰</strong> â€ã€‚</li>
</ul>
<p>ç³»ç»Ÿæç¤ºé‡Œåˆ»æ„ç”»äº†ä¸€æ¡æ¸…æ™°çš„ç•Œçº¿ï¼š</p>
<blockquote>
<p>â€œThe blueprint defines HOW you write; the research defines WHAT you write about.â€</p>
</blockquote>
<p>æ­£æ˜¯è¿™ç§â€œèŒè´£åˆ†ç¦»â€ idx_3b44a307 è®©æ•´ä¸ªç³»ç»Ÿå…·æœ‰å¾ˆå¼ºçš„å¯é€‚é…æ€§å’Œå¯æ‰©å±•æ€§ idx_ab0e706d â€”â€”<br/>
ä½ å¯ä»¥æ›´æ–°çŸ¥è¯†åº“è€Œä¸æ”¹å†™ä½œé£æ ¼è“å›¾ï¼Œä¹Ÿå¯ä»¥æ–°å¢è“å›¾è€Œä¸åŠ¨äº‹å®å­˜å‚¨ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦æ„å»ºæŠŠè¿™ä¸€åˆ‡ä¸²èµ·æ¥çš„ Orchestratorã€‚</p>
<h4 data-id="heading-17">æ„å»º Orchestratorï¼ˆç¼–æ’å™¨ï¼‰</h4>
<p>Orchestratorï¼ˆç¼–æ’å™¨ï¼‰æ˜¯æ•´ä¸ªç³»ç»Ÿçš„â€œæŒ‡æŒ¥å®¶â€ã€‚å®ƒçš„èŒè´£æ˜¯ï¼šæ¥æ”¶ä¸€ä¸ªé«˜å±‚ç›®æ ‡ï¼ŒæŠŠå®ƒæ‹†è§£æˆå¯æ‰§è¡Œçš„æŸ¥è¯¢ï¼Œç„¶ååè°ƒå„ä¸ªæ™ºèƒ½ä½“ï¼Œæœ€ç»ˆç”Ÿæˆç»“æœã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªé¡¹ç›®ç»ç†ï¼šè‡ªå·±ä¸å¹²å…·ä½“æ´»å„¿ï¼Œä½†è¦ç¡®ä¿æ¯ä¸ªäººéƒ½åœ¨æ­£ç¡®çš„èŠ‚å¥ä¸ŠååŒå·¥ä½œã€‚</p>
<h5 data-id="heading-18">ç›®æ ‡åˆ†æï¼ˆGoal analysisï¼‰</h5>
<p>Orchestrator é¦–å…ˆä¼šæŠŠç”¨æˆ·çš„é«˜å±‚ç›®æ ‡æ‹†è§£æˆä¸¤ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li><strong>intent_query</strong>ï¼šæƒ³è¦çš„é£æ ¼ã€è¯­æ°”æˆ–æ ¼å¼ï¼ˆä¾‹å¦‚â€œæ‚¬ç–‘å™äº‹è“å›¾â€â€œå®¢è§‚æŠ€æœ¯è§£é‡Šç»“æ„â€ï¼‰</li>
<li><strong>topic_query</strong>ï¼šè¦å¤„ç†çš„äº‹å®ä¸»é¢˜ï¼ˆä¾‹å¦‚â€œæœ±è¯ºå·ä»»åŠ¡ç›®æ ‡ä¸ä¾›ç”µæ–¹å¼â€â€œé˜¿æ³¢ç½— 11 å·ç™»æœˆç»†èŠ‚â€ï¼‰</li>
</ul>
<p>ä»£ç å¤§è‡´å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">orchestrator</span>(<span class="hljs-params">high_level_goal</span>):
    <span class="hljs-string">"""
    Manages the workflow of the Context-Aware MAS.
    """</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"=== [Orchestrator] Starting New Task ==="</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Goal: <span class="hljs-subst">{high_level_goal}</span>"</span>)

    <span class="hljs-comment"># Step 0: Analyze Goal (Determine Intent and Topic)</span>
    <span class="hljs-comment"># We use the LLM to separate the desired style (intent) from the subject matter (topic).</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n[Orchestrator] Analyzing Goal..."</span>)
    analysis_system_prompt = <span class="hljs-string">"""You are an expert goal analyst.    Analyze the user's high-level goal and extract two components:
    1. 'intent_query': A descriptive phrase summarizing the desired style, tone, or format, optimized for searching a context library (e.g., "suspenseful narrative blueprint", "objective technical explanation structure").
    2. 'topic_query': A concise phrase summarizing the factual subject matter required (e.g., "Juno mission objectives and power", "Apollo 11 landing details").

    Respond ONLY with a JSON object containing these two keys."""</span>

    <span class="hljs-comment"># We request JSON mode for reliable parsing</span>
    analysis_result = call_llm(
        analysis_system_prompt, high_level_goal, json_mode=<span class="hljs-literal">True</span>)
)

    <span class="hljs-keyword">try</span>:
        analysis = json.loads(analysis_result)
        intent_query = analysis[<span class="hljs-string">'intent_query'</span>]
        topic_query = analysis[<span class="hljs-string">'topic_query'</span>]
    <span class="hljs-keyword">except</span> (json.JSONDecodeError, KeyError):
        <span class="hljs-keyword">return</span>
</code></pre>
<p>åœ¨è¿™é‡Œï¼ŒOrchestrator è‡ªå·±ä¼šè°ƒç”¨ä¸€æ¬¡ LLMï¼ŒæŠŠè¿™ä¸ªé«˜å±‚ç›®æ ‡è§£ææˆç»“æ„åŒ– JSONã€‚<br/>
å¦‚æœè§£æå¤±è´¥ï¼Œå‡½æ•°å°±ç›´æ¥ <code>return</code>ï¼Œä»è€Œé¿å…åé¢æ•´æ¡é“¾è·¯å› ä¸ºè„æ•°æ®è€Œå´©æ‰ã€‚</p>
<p>è¿™ä¸ª <code>try...except</code> å—å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ª<strong>å›é€€æœºåˆ¶</strong>ï¼š<br/>
å¦‚æœ LLM è¿”å›çš„ JSON æ— æ³•è§£ææˆ–å­—æ®µç¼ºå¤±ï¼ŒOrchestrator ä¼š<strong>ä¼˜é›…ç»ˆæ­¢</strong>ï¼Œè€Œä¸æ˜¯æŠŠé”™è¯¯æ•°æ®ç»§ç»­å¾€ä¸‹ä¼ ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½ è¿˜å¯ä»¥ç”¨æ›´ä¸¥æ ¼çš„ç»“æ„åŒ–æç¤ºæˆ–è€…æ¨¡å¼æ ¡éªŒï¼ˆschema validationï¼‰æ¥å¼ºåŒ–è¿™ä¸€æ­¥ï¼Œä½†å¯¹å½“å‰åŸå‹æ¥è¯´ï¼Œè¿™ç§è½»é‡åšæ³•å·²ç»å…¼é¡¾äº†<strong>éŸ§æ€§</strong>å’Œ<strong>å¯è¯»æ€§</strong>ã€‚</p>
<h5 data-id="heading-19">æ™ºèƒ½ä½“åè°ƒï¼ˆAgent coordinationï¼‰</h5>
<p>ä¸€æ—¦ç›®æ ‡è¢«æ‹†è§£å®Œæˆï¼ŒOrchestrator å°±å¼€å§‹åè°ƒå„ä¸ªæ™ºèƒ½ä½“ä¹‹é—´çš„ä¿¡æ¯æµï¼š</p>
<ul>
<li>æŠŠ <strong>intent_query</strong> å‘ç»™ Librarianï¼ˆä¸Šä¸‹æ–‡é¦†å‘˜ï¼‰ï¼Œç”¨äºæ£€ç´¢è¯­ä¹‰è“å›¾ï¼›</li>
<li>æŠŠ <strong>topic_query</strong> å‘ç»™ Researcherï¼ˆç ”ç©¶å‘˜ï¼‰ï¼Œç”¨äºæ£€ç´¢äº‹å®ä¿¡æ¯ï¼›</li>
<li>ç„¶åæŠŠä¸¤è€…ç»“æœä¸€èµ·äº¤ç»™ Writerï¼ˆå†™ä½œè€…ï¼‰ã€‚</li>
</ul>
<h6 data-id="heading-20">1. å‘ Librarian è¯·æ±‚ä¸Šä¸‹æ–‡è“å›¾ï¼ˆProcedural RAGï¼‰</h6>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Step 1: Get the Context Blueprint (Procedural RAG)</span>
<span class="hljs-attr">mcp_to_librarian</span> = create_mcp_message(
    <span class="hljs-attr">sender</span>=<span class="hljs-string">"Orchestrator"</span>,
    <span class="hljs-attr">content</span>={<span class="hljs-string">"intent_query"</span>: intent_query}
)
<span class="hljs-comment"># display_mcp(mcp_to_librarian, "Orchestrator -&gt; Librarian")</span>
<span class="hljs-attr">mcp_from_librarian</span> = agent_context_librarian(mcp_to_librarian)
display_mcp(mcp_from_librarian, "Librarian -&gt; Orchestrator")

<span class="hljs-attr">context_blueprint</span> = mcp_from_librarian[<span class="hljs-string">'content'</span>].get(<span class="hljs-string">'blueprint'</span>)
if not context_blueprint: return
</code></pre>
<p>è¿™é‡Œ Orchestrator é€šè¿‡ MCP æ¶ˆæ¯ï¼ŒæŠŠ <code>intent_query</code> å‘é€ç»™ Librarianï¼›<br/>
è¿”å›åï¼Œä»æ¶ˆæ¯å†…å®¹é‡Œæ‹¿åˆ° <code>blueprint</code>ï¼ˆè“å›¾ï¼‰ã€‚å¦‚æœæ²¡æ‹¿åˆ°ï¼Œå°±ç›´æ¥è¿”å›ã€‚</p>
<h6 data-id="heading-21">2. å‘ Researcher è¯·æ±‚äº‹å®çŸ¥è¯†ï¼ˆFactual RAGï¼‰</h6>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Step 2: Get the Factual Knowledge (Factual RAG)</span>
<span class="hljs-attr">mcp_to_researcher</span> = create_mcp_message(
    <span class="hljs-attr">sender</span>=<span class="hljs-string">"Orchestrator"</span>,
    <span class="hljs-attr">content</span>={<span class="hljs-string">"topic_query"</span>: topic_query}
)
<span class="hljs-comment"># display_mcp(mcp_to_researcher, "Orchestrator -&gt; Researcher")</span>
<span class="hljs-attr">mcp_from_researcher</span> = agent_researcher(mcp_to_researcher)
display_mcp(mcp_from_researcher, "Researcher -&gt; Orchestrator")

<span class="hljs-attr">research_findings</span> = mcp_from_researcher[<span class="hljs-string">'content'</span>].get(<span class="hljs-string">'facts'</span>)
if not research_findings: return
</code></pre>
<p>è¿™ä¸€æ­¥ Orchestrator è®© Researcher ä»çŸ¥è¯†åº“ä¸­æ£€ç´¢ä¸ <code>topic_query</code> ç›¸å…³çš„äº‹å®ï¼Œå¹¶ç»¼åˆæˆä¸€ä¸ªç®€æ˜æ‘˜è¦ <code>facts</code>ã€‚å¦‚æœæ²¡æœ‰ç»“æœï¼ŒåŒæ ·ç›´æ¥é€€å‡ºã€‚</p>
<h6 data-id="heading-22">3. äº¤ç»™ Writer ç”Ÿæˆæœ€ç»ˆå†…å®¹</h6>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Step 3: Generate the Final Output</span>
<span class="hljs-comment"># Combine the outputs for the Writer Agent</span>
<span class="hljs-attr">writer_task</span> = {
    "blueprint": context_blueprint,
    "facts": research_findings
}

<span class="hljs-attr">mcp_to_writer</span> = create_mcp_message(
    <span class="hljs-attr">sender</span>=<span class="hljs-string">"Orchestrator"</span>,
    <span class="hljs-attr">content</span>=writer_task
)
<span class="hljs-comment"># display_mcp(mcp_to_writer, "Orchestrator -&gt; Writer")</span>
<span class="hljs-attr">mcp_from_writer</span> = agent_writer(mcp_to_writer)
display_mcp(mcp_from_writer, "Writer -&gt; Orchestrator")

<span class="hljs-attr">final_result</span> = mcp_from_writer[<span class="hljs-string">'content'</span>].get(<span class="hljs-string">'output'</span>)

print("\<span class="hljs-attr">n</span>=== [Orchestrator] Task Complete ===<span class="hljs-string">")
return final_result
</span></code></pre>
<p>è¿™ä¸€æ¨¡å¼è®©å„è‡ªçš„èŒè´£æå…¶æ¸…æ™°ï¼š</p>
<ul>
<li><strong>Librarian</strong> åªè´Ÿè´£å–â€œæ€ä¹ˆå†™â€çš„è¿‡ç¨‹æŒ‡å¯¼ï¼ˆç¨‹åºæ€§ä¸Šä¸‹æ–‡ï¼‰ï¼›</li>
<li><strong>Researcher</strong> åªè´Ÿè´£å–â€œå†™ä»€ä¹ˆâ€çš„äº‹å®å†…å®¹ï¼›</li>
<li><strong>Writer</strong> æŠŠâ€œæ€ä¹ˆå†™â€å’Œâ€œå†™ä»€ä¹ˆâ€ç»„åˆèµ·æ¥ï¼Œç”Ÿæˆæœ€ç»ˆæ–‡æœ¬ã€‚</li>
</ul>
<p>åŒæ—¶ï¼Œè¿™ä¸ªæ¶æ„ä¹‹æ‰€ä»¥ç¨³å¥ï¼Œæ˜¯å› ä¸ºå®ƒæ—¢<strong>æ¨¡å—åŒ–</strong>åˆ<strong>å¯æ‰©å±•</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ªæ™ºèƒ½ä½“åªåšä¸€ä»¶äº‹ï¼ˆSingle Responsibilityï¼‰ï¼›</li>
<li>ç³»ç»Ÿä¸¥æ ¼æŒ‰ç…§ä½ æä¾›çš„è¿‡ç¨‹æ€§æŒ‡ä»¤ï¼ˆè¯­ä¹‰è“å›¾ï¼‰æ¥æ‰§è¡Œï¼›</li>
<li>Orchestrator åƒä¸€ä¸ªä¼˜ç§€çš„é¡¹ç›®ç»ç†ï¼šåªç®¡æ‹†ä»»åŠ¡å’Œæ´¾ä»»åŠ¡ï¼Œè€Œä¸å‚ä¸å…·ä½“å®ç°ï¼ŒæŠŠç»†èŠ‚äº¤ç»™å„ä¸ªä¸“å®¶æ™ºèƒ½ä½“ã€‚</li>
</ul>
<p>çœŸæ­£çš„æ€æ‰‹é”åœ¨äºâ€”â€”<strong>æŠŠ â€œwhatï¼ˆå†…å®¹ï¼‰â€ å’Œ â€œhowï¼ˆè¡¨ç°å½¢å¼ï¼‰â€ å½»åº•åˆ†ç¦»</strong>ï¼š</p>
<ul>
<li>äº‹å®æ£€ç´¢ï¼ˆçŸ¥è¯†åº“ï¼‰ä¸é£æ ¼/è¿‡ç¨‹æŒ‡ä»¤ï¼ˆä¸Šä¸‹æ–‡åº“ï¼‰å®Œå…¨ç‹¬ç«‹ï¼›</li>
<li>è¿™æ ·ä½ å¯ä»¥åªæ›´æ–°çŸ¥è¯†åº“ï¼Œè€Œä¸ç”¨åŠ¨ä»»ä½•é£æ ¼è§„åˆ™ï¼›</li>
<li>æˆ–è€…åªæ–°å¢/è°ƒæ•´è“å›¾ï¼Œè€Œä¸ç”¨åŠ¨äº‹å®æ•°æ®ã€‚</li>
</ul>
<p>è¿™è®©è¿­ä»£é€Ÿåº¦éå¸¸å¿«ï¼Œä¹Ÿè®©ç³»ç»Ÿå˜å¾—æçµæ´»ï¼š<br/>
åªè¦æ›´æ¢è¯­ä¹‰è“å›¾ï¼Œå°±èƒ½åœ¨åŒä¸€æ‰¹äº‹å®çš„åŸºç¡€ä¸Šï¼Œç¬é—´æ¢ä¸€ç§é£æ ¼ã€ç»“æ„æˆ–è¯­æ°”æ¥ç”Ÿæˆå†…å®¹ã€‚</p>
<p>æœ€ç»ˆï¼Œè¿™ä¸ä»…ä»…æ˜¯ä¸€ä¸ªâ€œæ•™å­¦ç¤ºä¾‹â€ï¼Œè€Œæ˜¯ä¸€å¥—<strong>å¯è½åœ°çš„å·¥ç¨‹è“å›¾</strong>ï¼Œç”¨äºæ„å»ºçœŸæ­£èƒ½å¤„ç†å¤æ‚ã€ä¸Šä¸‹æ–‡æ•æ„Ÿä»»åŠ¡çš„å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼ˆMASï¼‰ã€‚</p>
<h2 data-id="heading-23">å°ç»“ï¼ˆSummaryï¼‰</h2>
<p>æœ¬ç« æˆ‘ä»¬ä»ç¬¬ 2 ç« çš„ MAS ç»§ç»­æ¼”åŒ–ï¼Œæ ¸å¿ƒå‡çº§æ˜¯å¼•å…¥äº†<strong>åŒé‡ RAG æ¶æ„ï¼ˆdual RAGï¼‰</strong> ã€‚</p>
<ul>
<li>
<p>åœ¨åŒä¸€ä¸ª Pinecone ç´¢å¼•ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªå®Œå…¨ç‹¬ç«‹çš„æ•°æ®åº“ï¼š</p>
<ul>
<li><strong>Knowledge Baseï¼ˆçŸ¥è¯†åº“ï¼‰</strong> ï¼šä¸º Researcher æ™ºèƒ½ä½“å­˜å‚¨äº‹å®ä¿¡æ¯ï¼›</li>
<li><strong>Context Libraryï¼ˆä¸Šä¸‹æ–‡åº“ï¼‰</strong> ï¼šä¸ºæ–°å¼•å…¥çš„ Context Librarian æ™ºèƒ½ä½“å­˜å‚¨è¿‡ç¨‹æ€§è¯­ä¹‰è“å›¾ã€‚</li>
</ul>
</li>
</ul>
<p>è¿™ç§åˆ†ç¦»è®©ç³»ç»Ÿå¯ä»¥<strong>ç‹¬ç«‹ç®¡ç†â€œçŸ¥é“ä»€ä¹ˆâ€å’Œâ€œå¦‚ä½•è¡ŒåŠ¨â€</strong> ã€‚</p>
<p>å®ç°ä¸Šåˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼š</p>
<ol>
<li>
<p><strong>æ•°æ®å‡†å¤‡é˜¶æ®µï¼ˆç¬¬ä¸€ä¸ª notebookï¼‰</strong></p>
<ul>
<li>é¢„å¤„ç†å¹¶ä¸Šä¼ æ•°æ®åˆ°ä¸¤ä¸ª Pinecone å‘½åç©ºé—´ï¼›</li>
<li>ä¸€ä¸ªç”¨äºçŸ¥è¯†å‘é‡ï¼ˆçŸ¥è¯†åº“ï¼‰ï¼Œä¸€ä¸ªç”¨äºè“å›¾å‘é‡ï¼ˆä¸Šä¸‹æ–‡åº“ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>è¿è¡Œæ—¶æ‰§è¡Œé˜¶æ®µï¼ˆç¬¬äºŒä¸ª notebookï¼‰</strong></p>
<ul>
<li>
<p>å®šä¹‰å¤šæ™ºèƒ½ä½“å·¥ä½œæµï¼š</p>
<ul>
<li>Orchestrator åˆ†æç”¨æˆ·ç›®æ ‡ï¼›</li>
<li>æŠŠâ€œäº‹å®æŸ¥è¯¢â€äº¤ç»™ Researcherï¼›</li>
<li>æŠŠâ€œé£æ ¼/ç»“æ„æ£€ç´¢â€äº¤ç»™ Librarianï¼›</li>
<li>Writer åŒæ—¶æ¥æ”¶äº‹å®å’Œè¯­ä¹‰è“å›¾ï¼ŒæŒ‰è“å›¾çº¦æŸæ¥ç”Ÿæˆæœ€ç»ˆè¾“å‡ºã€‚</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>ç°åœ¨ï¼Œè¿™ä¸ªç³»ç»Ÿå·²ç»å¯ä»¥<strong>åŠ¨æ€æ§åˆ¶ç”Ÿæˆè¿‡ç¨‹</strong>ï¼š<br/>
æ—¢ä¿è¯å†…å®¹æ¥è‡ªæ£€ç´¢åˆ°çš„äº‹å®ï¼Œåˆä¿è¯è¡¨è¾¾å½¢å¼ä¸¥æ ¼éµä»è¯­ä¹‰è“å›¾ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åŸºäºæœ¬ç« æ„å»ºçš„èƒ½åŠ›ï¼Œè®¾è®¡ä¸€ä¸ªçœŸæ­£æ„ä¹‰ä¸Šçš„<strong>ä¸Šä¸‹æ–‡å¼•æ“ï¼ˆcontext engineï¼‰</strong> ï¼ŒæŠŠè¿™ä¸€ MAS æå‡åˆ°æ–°çš„å±‚çº§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸å¤§æ¨¡å‹å…±èˆï¼šä» DeepSeek åˆ°æ¨¡å—åŒ–æ™ºèƒ½åº”ç”¨å¼€å‘]]></title>    <link>https://juejin.cn/post/7574343024324902953</link>    <guid>https://juejin.cn/post/7574343024324902953</guid>    <pubDate>2025-11-20T02:03:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7574343024324902953" data-draft-id="7574306374917390355" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸å¤§æ¨¡å‹å…±èˆï¼šä» DeepSeek åˆ°æ¨¡å—åŒ–æ™ºèƒ½åº”ç”¨å¼€å‘"/> <meta itemprop="keywords" content="DeepSeek"/> <meta itemprop="datePublished" content="2025-11-20T02:03:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="www_stdio"/> <meta itemprop="url" content="https://juejin.cn/user/631558156323657"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸å¤§æ¨¡å‹å…±èˆï¼šä» DeepSeek åˆ°æ¨¡å—åŒ–æ™ºèƒ½åº”ç”¨å¼€å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/631558156323657/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    www_stdio
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-11-20T02:03:38.000Z" title="Thu Nov 20 2025 02:03:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-11-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸å¤§æ¨¡å‹å…±èˆï¼šä» DeepSeek åˆ°æ¨¡å—åŒ–æ™ºèƒ½åº”ç”¨å¼€å‘</h2>
<p>åœ¨äººå·¥æ™ºèƒ½å¿«é€Ÿå‘å±•çš„ä»Šå¤©ï¼Œå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å·²æˆä¸ºå¼€å‘è€…æ¢ç´¢æ™ºèƒ½åº”ç”¨çš„é‡è¦å·¥å…·ã€‚ä»¥ DeepSeek ä¸ºä»£è¡¨çš„å¼€æºå¤§æ¨¡å‹ï¼Œä¾æ‰˜æµ·é‡é¢„è®­ç»ƒæ•°æ®ä¸­çš„æ–‡æœ¬æ¨¡å¼è¿›è¡Œæ¨ç†ä¸å›ç­”ï¼Œå±•ç°å‡ºå¼ºå¤§çš„è¯­è¨€ç†è§£ä¸ç”Ÿæˆèƒ½åŠ›ã€‚ç„¶è€Œï¼Œæ­£å¦‚æ‰€æœ‰åŸºäºé™æ€æ•°æ®è®­ç»ƒçš„æ¨¡å‹ä¸€æ ·ï¼ŒDeepSeek å¹¶ä¸å…·å¤‡å¯¹æ–°é—»ã€è‚¡ä»·ç­‰å®æ—¶ä¿¡æ¯çš„æ„ŸçŸ¥èƒ½åŠ›â€”â€”è¿™æ°æ°å¼•å‡ºäº†ä¸€ä¸ªå…³é”®å‘½é¢˜ï¼šå¦‚ä½•è®©å¤§æ¨¡å‹â€œèµ°å‡ºå°é—­â€ï¼Œä¸çœŸå®ä¸–ç•Œäº’åŠ¨ï¼Ÿæœ¬æ–‡å°†ç»“åˆ ModelScopeï¼ˆé­”æ­ï¼‰ã€Jupyter Notebook ä¸ OpenAI SDK ç­‰æŠ€æœ¯ç”Ÿæ€ï¼Œæ¢è®¨æ„å»ºæ¨¡å—åŒ–ã€å¯æ‰©å±•çš„å¤§æ¨¡å‹åº”ç”¨å®è·µè·¯å¾„ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ModelScopeï¼šé™ä½ AI åº”ç”¨é—¨æ§›çš„å¼€æ”¾å¹³å°</h3>
<p>é˜¿é‡Œäº‘æ¨å‡ºçš„ <strong>ModelScopeï¼ˆé­”æ­ï¼‰</strong> æ˜¯ä¸€ä¸ªé¢å‘å¼€å‘è€…çš„æ¨¡å‹å¼€æ”¾å¹³å°ï¼Œæ±‡é›†äº†è¦†ç›–è¯­éŸ³ã€è§†è§‰ã€è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ç­‰é¢†åŸŸçš„æµ·é‡å¼€æºæœºå™¨å­¦ä¹ ä¸æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚å¯¹äºå¸Œæœ›å¿«é€Ÿä¸Šæ‰‹å¤§æ¨¡å‹çš„å¼€å‘è€…è€Œè¨€ï¼ŒModelScope ä¸ä»…æä¾›ä¸€é”®ä¸‹è½½ä¸éƒ¨ç½²èƒ½åŠ›ï¼Œè¿˜æ”¯æŒå¯¹æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼ˆfine-tuningï¼‰ï¼Œä»è€Œé€‚é…ç‰¹å®šä¸šåŠ¡åœºæ™¯ã€‚è¿™ç§â€œæ¨¡å‹å³æœåŠ¡â€ï¼ˆMaaSï¼‰çš„ç†å¿µï¼Œæå¤§é™ä½äº† AI æŠ€æœ¯çš„åº”ç”¨é—¨æ§›ï¼Œä½¿æ›´å¤šå›¢é˜Ÿèƒ½å¤Ÿèšç„¦äºåˆ›æ–°è€Œéåº•å±‚åŸºç¡€è®¾æ–½ã€‚</p>
<h3 data-id="heading-2">äºŒã€Jupyter Notebookï¼šå®éªŒé©±åŠ¨çš„äº¤äº’å¼å¼€å‘</h3>
<p>åœ¨æ¢ç´¢å¤§æ¨¡å‹èƒ½åŠ›çš„è¿‡ç¨‹ä¸­ï¼Œ<strong>Jupyter Notebookï¼ˆ.ipynb æ–‡ä»¶ï¼‰</strong> æˆä¸ºä¸å¯æˆ–ç¼ºçš„å·¥å…·ã€‚Python å¤©ç”Ÿé€‚åˆç§‘å­¦è®¡ç®—ä¸æœºå™¨å­¦ä¹ ï¼Œè€Œ Jupyter çš„äº¤äº’å¼ç‰¹æ€§å…è®¸å¼€å‘è€…é€æ¡è¿è¡Œä»£ç ã€å³æ—¶æŸ¥çœ‹ç»“æœï¼Œéå¸¸é€‚åˆç”¨äºï¼š</p>
<ul>
<li>éªŒè¯ç®—æ³•é€»è¾‘</li>
<li>æ¨å¯¼æ•°å­¦å…¬å¼</li>
<li>æµ‹è¯•å¤§æ¨¡å‹åœ¨ä¸åŒæç¤ºï¼ˆpromptï¼‰ä¸‹çš„è¡¨ç°</li>
</ul>
<p>è¿™ç§â€œæ‰€è§å³æ‰€å¾—â€çš„å®éªŒç¯å¢ƒï¼Œä½¿å¾—ä»æƒ³æ³•åˆ°åŸå‹çš„è½¬åŒ–è¿‡ç¨‹å˜å¾—å¼‚å¸¸é«˜æ•ˆï¼Œå°¤å…¶é€‚åˆç ”ç©¶å‹æˆ–æ¢ç´¢å‹é¡¹ç›®ã€‚</p>
<h3 data-id="heading-3">ä¸‰ã€æ¨¡å—åŒ–è®¾è®¡ï¼šæ„å»ºå¯ç»´æŠ¤çš„å¤§æ¨¡å‹åº”ç”¨</h3>
<p>ç°ä»£è½¯ä»¶å·¥ç¨‹å¼ºè°ƒ <strong>æ¨¡å—åŒ–</strong> ä¸ <strong>å…³æ³¨ç‚¹åˆ†ç¦»</strong>ã€‚åœ¨å¤§æ¨¡å‹åº”ç”¨å¼€å‘ä¸­ï¼Œè¿™ä¸€åŸåˆ™åŒæ ·é€‚ç”¨ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡å¼•å…¥ OpenAI SDKï¼ˆå°½ç®¡ DeepSeek å¯èƒ½ä½¿ç”¨å…¼å®¹æ¥å£ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ç»„ç»‡ä»£ç ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">from openai import OpenAI

<span class="hljs-attr">client</span> = OpenAI(
    <span class="hljs-attr">api_key</span>=<span class="hljs-string">"your-api-key"</span>,
    <span class="hljs-attr">base_url</span>=<span class="hljs-string">"https://your-deepseek-endpoint/v1"</span>
)
</code></pre>
<p>è¿™ç§å†™æ³•ä¸ä»…æ¸…æ™°è¡¨è¾¾äº†ä¾èµ–å…³ç³»ï¼Œè¿˜ä¾¿äºåç»­æ›¿æ¢æ¨¡å‹åç«¯æˆ–è°ƒæ•´é…ç½®ã€‚æ¯ä¸ªæ¨¡å—ä¸“æ³¨å•ä¸€èŒè´£â€”â€”å¦‚æç¤ºå·¥ç¨‹ã€ä¸Šä¸‹æ–‡ç®¡ç†ã€å·¥å…·è°ƒç”¨ç­‰â€”â€”ä»è€Œæå‡ä»£ç çš„å¯è¯»æ€§ã€å¯æµ‹è¯•æ€§ä¸å¯æ‰©å±•æ€§ã€‚</p>
<h3 data-id="heading-4">å››ã€å¤šè½®å¯¹è¯ä¸è§’è‰²è®¾å®šï¼šæ„å»ºæœ‰è®°å¿†çš„æ™ºèƒ½ä½“</h3>
<p>å¤§æ¨¡å‹çš„ <code>chat.completions</code> æ¥å£æ”¯æŒå¤šè½®å¯¹è¯ï¼Œå…¶æ ¸å¿ƒåœ¨äº <strong>æ¶ˆæ¯å†å²ï¼ˆmessage historyï¼‰</strong> çš„ä¼ é€’ã€‚æ¯æ¡æ¶ˆæ¯åŒ…å«ä¸€ä¸ª <code>role</code> å­—æ®µï¼Œé€šå¸¸åˆ†ä¸ºä¸‰ç±»ï¼š</p>
<ul>
<li><code>system</code>ï¼šå®šä¹‰ AI çš„èº«ä»½ã€è¡Œä¸ºå‡†åˆ™æˆ–ä»»åŠ¡ç›®æ ‡ï¼Œä¸€èˆ¬åœ¨å¯¹è¯å¼€å§‹æ—¶è®¾å®šä¸€æ¬¡ï¼›</li>
<li><code>user</code>ï¼šç”¨æˆ·è¾“å…¥çš„é—®é¢˜æˆ–æŒ‡ä»¤ï¼›</li>
<li><code>assistant</code>ï¼šæ¨¡å‹ç”Ÿæˆçš„å›å¤ã€‚</li>
</ul>
<p>é€šè¿‡ç²¾å¿ƒè®¾è®¡ system prompt ä¸ç»´æŠ¤ä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å¯¼æ¨¡å‹æ‰®æ¼”å®¢æœã€æ•™å¸ˆã€ç¼–ç¨‹åŠ©æ‰‹ç­‰è§’è‰²ï¼Œå®ç°æ›´è¿è´¯ã€æ›´ä¸“ä¸šçš„äº¤äº’ä½“éªŒã€‚</p>
<h3 data-id="heading-5">äº”ã€è¶…è¶Šé™æ€çŸ¥è¯†ï¼šæ•™å¤§æ¨¡å‹â€œä½¿ç”¨å·¥å…·â€</h3>
<p>å°½ç®¡ DeepSeek ç­‰æ¨¡å‹æ— æ³•ç›´æ¥è·å–å®æ—¶æ•°æ®ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ <strong>å·¥å…·è°ƒç”¨ï¼ˆTool Callingï¼‰</strong> èµ‹äºˆå…¶â€œè¡ŒåŠ¨åŠ›â€ã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li>å½“ç”¨æˆ·è¯¢é—®â€œä»Šå¤©åŒ—äº¬å¤©æ°”å¦‚ä½•ï¼Ÿâ€ï¼Œæ¨¡å‹å¯è¯†åˆ«å‡ºéœ€è¦è°ƒç”¨å¤©æ°” APIï¼›</li>
<li>å½“ç”¨æˆ·é—®â€œç‰¹æ–¯æ‹‰æœ€æ–°è‚¡ä»·æ˜¯å¤šå°‘ï¼Ÿâ€ï¼Œæ¨¡å‹å¯è§¦å‘é‡‘èæ•°æ®æ¥å£ã€‚</li>
</ul>
<p>è¿™ä¸€è¿‡ç¨‹æœ¬è´¨ä¸Šæ˜¯ <strong>æ•™ä¼š LLM ä½¿ç”¨å¤–éƒ¨å·¥å…·</strong>ï¼šé€šè¿‡å‡½æ•°æè¿°ï¼ˆfunction schemaï¼‰å‘Šè¯‰æ¨¡å‹æœ‰å“ªäº›å·¥å…·å¯ç”¨ï¼Œæ¨¡å‹åœ¨æ¨ç†æ—¶å†³å®šæ˜¯å¦è°ƒç”¨ï¼Œå¹¶è§£æè¿”å›ç»“æœç”Ÿæˆè‡ªç„¶è¯­è¨€å›ç­”ã€‚è¿™ç§â€œæ¨ç† + å·¥å…·â€çš„æ¶æ„ï¼Œæ­£æˆä¸ºæ„å»ºå®ç”¨å‹ AI åº”ç”¨çš„ä¸»æµèŒƒå¼ã€‚</p>
<h3 data-id="heading-6">ç»“è¯­</h3>
<p>ä» ModelScope è·å–æ¨¡å‹ï¼Œåˆ° Jupyter ä¸­å®éªŒéªŒè¯ï¼Œå†åˆ°æ¨¡å—åŒ–å°è£…ä¸å·¥å…·é›†æˆï¼Œæˆ‘ä»¬æ­£åœ¨æ„å»ºä¸€ä¸ªå¼€æ”¾ã€çµæ´»ä¸”å¼ºå¤§çš„å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç”Ÿæ€ã€‚DeepSeek è¿™æ ·çš„å¼€æºæ¨¡å‹ä¸ä»…æ˜¯æŠ€æœ¯æˆæœï¼Œæ›´æ˜¯åˆ›æ–°çš„èµ·ç‚¹ã€‚æœªæ¥ï¼Œéšç€å·¥å…·è°ƒç”¨ã€è®°å¿†æœºåˆ¶ä¸å¤šæ¨¡æ€èƒ½åŠ›çš„èåˆï¼Œå¤§æ¨¡å‹å°†çœŸæ­£ä»â€œçŸ¥è¯†åº“â€è¿›åŒ–ä¸ºâ€œæ™ºèƒ½ä½“â€ï¼Œåœ¨ç°å®ä¸–ç•Œä¸­å‘æŒ¥æ›´å¤§ä»·å€¼ã€‚</p>
<blockquote>
<p>æ­£å¦‚ä¸€å¥å¼€å‘è€…æ ¼è¨€æ‰€è¯´ï¼šâ€œæ¨¡å‹æä¾›å¯èƒ½æ€§ï¼Œå·¥ç¨‹å®ç°ä»·å€¼ã€‚â€ åœ¨è¿™åœºäººä¸æ™ºèƒ½ååŒè¿›åŒ–çš„æ—…ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ—¢æ˜¯ä½¿ç”¨è€…ï¼Œä¹Ÿæ˜¯å¡‘é€ è€…ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>