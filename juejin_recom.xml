<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[Tauri vs Electronï¼šæ™ºèƒ½å·¥å…·ç®±çš„æŠ€æœ¯é€‰å‹ä¸å®ç°]]></title>    <link>https://juejin.cn/post/7599922362998423598</link>    <guid>https://juejin.cn/post/7599922362998423598</guid>    <pubDate>2026-01-28T01:55:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599922362998423598" data-draft-id="7599963665038573618" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Tauri vs Electronï¼šæ™ºèƒ½å·¥å…·ç®±çš„æŠ€æœ¯é€‰å‹ä¸å®ç°"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-28T01:55:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº‘èˆŸå–"/> <meta itemprop="url" content="https://juejin.cn/user/360295546233959"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Tauri vs Electronï¼šæ™ºèƒ½å·¥å…·ç®±çš„æŠ€æœ¯é€‰å‹ä¸å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/360295546233959/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº‘èˆŸå–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T01:55:02.000Z" title="Wed Jan 28 2026 01:55:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    21
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»30åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>éšç€ ChatGPTã€Claude ç­‰å¤§è¯­è¨€æ¨¡å‹çš„çˆ†å‘å¼å‘å±•ï¼ŒAI åº”ç”¨å·²ç»æ·±å…¥åˆ°æˆ‘ä»¬å·¥ä½œç”Ÿæ´»çš„æ–¹æ–¹é¢é¢ã€‚ä½†ç°æœ‰çš„ AI å·¥å…·å¤§å¤šæ˜¯ Web ç«¯æˆ–è€…éœ€è¦è”ç½‘ä½¿ç”¨ï¼Œå¯¹äºä¸€äº›å¸Œæœ›åœ¨æœ¬åœ°è¿›è¡Œæ›´æ·±åº¦å®šåˆ¶åŒ–ä½¿ç”¨çš„ç”¨æˆ·æ¥è¯´ï¼Œè¿˜ç¼ºå°‘ä¸€ä¸ªçœŸæ­£æ„ä¹‰ä¸Šçš„ã€ŒAI å·¥ä½œå°ã€ã€‚</p>
<p>åŸºäºè¿™ä¸ªå‡ºå‘ç‚¹ï¼Œæˆ‘å¼€å‘äº†<strong>æ™ºèƒ½å·¥å…·ç®±ï¼ˆSmart Toolboxï¼‰</strong> â€”â€” ä¸€æ¬¾åŸºäº Tauri 2.x æ„å»ºçš„æ¡Œé¢ AI åŠ©æ‰‹ï¼Œæ”¯æŒå¤šæ¨¡å‹æ¥å…¥ã€è‡ªå®šä¹‰æŠ€èƒ½ã€å·¥ä½œæµç¼–æ’ç­‰åŠŸèƒ½ã€‚</p>
<p>å¦ç™½è¯´ï¼Œé€‰æ‹© Tauri + Rust è¿™ä¸ªæŠ€æœ¯æ ˆï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯å‡ºäº<strong>å¯¹æ–°æŠ€æœ¯çš„å¥½å¥‡å’Œæ¢ç´¢æ¬²</strong>ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘æœ‰è¿‡ Electron å¼€å‘ç»éªŒï¼Œæ·±çŸ¥å…¶ç”Ÿæ€æˆç†Ÿã€å¼€å‘æ•ˆç‡é«˜çš„ä¼˜åŠ¿ï¼Œä½†ä¹Ÿä¸€ç›´è¢«å…¶è‡ƒè‚¿çš„åŒ…ä½“ç§¯å’Œé«˜å†…å­˜å ç”¨æ‰€å›°æ‰°ã€‚å½“äº†è§£åˆ° Tauri å¯ä»¥ç”¨ Rust æ›¿ä»£ Node.js åç«¯ï¼ŒåŒæ—¶ä¿æŒå‰ç«¯å¼€å‘ä½“éªŒæ—¶ï¼Œæˆ‘ç«‹åˆ»äº§ç”Ÿäº†æµ“åšçš„å…´è¶£â€”â€”è¿™æ­£å¥½ç»™äº†æˆ‘ä¸€ä¸ªå­¦ä¹  Rustã€æ¢ç´¢ç°ä»£æ¡Œé¢å¼€å‘æ–°èŒƒå¼çš„æœºä¼šã€‚</p>
<p>æ­¤å¤–ï¼Œé¡¹ç›®çš„è®¾è®¡çµæ„Ÿä¹Ÿéƒ¨åˆ†æ¥æºäºå½“å‰æµè¡Œçš„ AI ç¼–ç¨‹åŠ©æ‰‹ç”Ÿæ€ï¼Œç‰¹åˆ«æ˜¯ Claude Codeã€Cursor ç­‰å·¥å…·æ‰€é‡‡ç”¨çš„ Agent Skills è§„èŒƒã€‚è¿™äº›å·¥å…·é€šè¿‡æ ‡å‡†åŒ–çš„æŠ€èƒ½å®šä¹‰ï¼ˆSKILL.md æ–‡ä»¶ï¼‰å®ç°äº†æŠ€èƒ½çš„å¯å¤ç”¨å’Œå¯å…±äº«ï¼Œè¿™ç»™äº†æˆ‘å¾ˆå¤§çš„å¯å‘ã€‚æˆ‘å¸Œæœ›åœ¨æ™ºèƒ½å·¥å…·ç®±ä¸­ä¸ä»…å…¼å®¹è¿™ç§è§„èŒƒï¼Œè¿˜èƒ½åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•ï¼Œæä¾›æ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚</p>
<p>æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»è¿™æ¬¾åº”ç”¨çš„æŠ€æœ¯æ¶æ„å’Œæ ¸å¿ƒå®ç°ï¼ŒåŒæ—¶ä¹Ÿä¼šåˆ†äº«ä» Electron è½¬å‘ Tauri çš„å¼€å‘ä½“éªŒå¯¹æ¯”ï¼Œä»¥åŠ Agent Skills å…¼å®¹å±‚çš„è®¾è®¡ä¸å®ç°ã€‚</p>
<h2 data-id="heading-1">å…¸å‹ä½¿ç”¨åœºæ™¯</h2>
<p>æ™ºèƒ½å·¥å…·ç®±ä½œä¸ºä¸€æ¬¾æ¡Œé¢ AI åŠ©æ‰‹ï¼Œé€‚ç”¨äºå¤šç§ä½¿ç”¨åœºæ™¯ï¼š</p>
<h3 data-id="heading-2">åœºæ™¯1ï¼šå†…å®¹åˆ›ä½œè€…</h3>
<p><strong>ç”¨æˆ·éœ€æ±‚</strong>ï¼šéœ€è¦å¿«é€Ÿç”Ÿæˆé«˜è´¨é‡æ–‡ç« ï¼Œå¹¶å‘å¸ƒåˆ°å¤šä¸ªå¹³å°</p>
<p><strong>ä½¿ç”¨æµç¨‹</strong>ï¼š</p>
<ol>
<li>ç”¨æˆ·è¾“å…¥ï¼š"å¸®æˆ‘å†™ä¸€ç¯‡å…³äº Rust å¹¶å‘ç¼–ç¨‹çš„æŠ€æœ¯æ–‡ç« ï¼Œ1500å­—å·¦å³"</li>
<li>æ„å›¾è¯†åˆ«å¼•æ“è¯†åˆ«åˆ°éœ€è¦è°ƒç”¨"æ–‡ç« ç”Ÿæˆ"æŠ€èƒ½</li>
<li>æŠ€èƒ½æ‰§è¡Œå™¨åŠ è½½æŠ€èƒ½é…ç½®ï¼Œè°ƒç”¨ LLM ç”Ÿæˆæ–‡ç« </li>
<li>ç”¨æˆ·é¢„è§ˆå¹¶è°ƒæ•´æ–‡ç« å†…å®¹</li>
<li>ä½¿ç”¨"å¤šå¹³å°å‘å¸ƒ"å·¥ä½œæµï¼Œä¸€é”®å‘å¸ƒåˆ°æ˜é‡‘ã€å…¬ä¼—å·ç­‰å¹³å°</li>
</ol>
<p><strong>æ”¶ç›Š</strong>ï¼šä»æ„æ€åˆ°å‘å¸ƒï¼Œæ•´ä¸ªè¿‡ç¨‹ä»…éœ€ 10-15 åˆ†é’Ÿï¼Œç›¸æ¯”ä¼ ç»Ÿæ–¹å¼èŠ‚çœ 80% æ—¶é—´</p>
<h3 data-id="heading-3">åœºæ™¯2ï¼šå¼€å‘è€…åŠ©æ‰‹</h3>
<p><strong>ç”¨æˆ·éœ€æ±‚</strong>ï¼šéœ€è¦å¿«é€Ÿç”Ÿæˆä»£ç ã€å¤„ç†æ–‡ä»¶ã€æ‰§è¡Œè‡ªåŠ¨åŒ–ä»»åŠ¡</p>
<p><strong>ä½¿ç”¨æµç¨‹</strong>ï¼š</p>
<ol>
<li>ç”¨æˆ·è¾“å…¥ï¼š"å¸®æˆ‘ç”Ÿæˆä¸€ä¸ª React ç»„ä»¶ï¼ŒåŒ…å«è¡¨å•éªŒè¯åŠŸèƒ½"</li>
<li>ç³»ç»Ÿè°ƒç”¨"ä»£ç ç”Ÿæˆ"æŠ€èƒ½ï¼Œç”Ÿæˆå®Œæ•´çš„ç»„ä»¶ä»£ç </li>
<li>ç”¨æˆ·å¯ä»¥è¿›ä¸€æ­¥è¦æ±‚ï¼š"æ·»åŠ  TypeScript ç±»å‹å®šä¹‰"</li>
<li>ç³»ç»Ÿè‡ªåŠ¨æ›´æ–°ä»£ç ï¼Œæ·»åŠ ç±»å‹å®šä¹‰</li>
<li>ç”¨æˆ·å¯ä»¥ç›´æ¥å¤åˆ¶ä»£ç åˆ°é¡¹ç›®ä¸­ä½¿ç”¨</li>
</ol>
<p><strong>æ”¶ç›Š</strong>ï¼šæé«˜å¼€å‘æ•ˆç‡ï¼Œå‡å°‘é‡å¤æ€§å·¥ä½œ</p>
<h3 data-id="heading-4">åœºæ™¯3ï¼šæ•°æ®åˆ†æå¸ˆ</h3>
<p><strong>ç”¨æˆ·éœ€æ±‚</strong>ï¼šéœ€è¦å¤„ç† Excel æ•°æ®ï¼Œç”Ÿæˆå¯è§†åŒ–æŠ¥å‘Š</p>
<p><strong>ä½¿ç”¨æµç¨‹</strong>ï¼š</p>
<ol>
<li>ç”¨æˆ·ä¸Šä¼  Excel æ–‡ä»¶</li>
<li>è¾“å…¥ï¼š"å¸®æˆ‘åˆ†æè¿™ä¸ªé”€å”®æ•°æ®ï¼Œç”Ÿæˆæœˆåº¦è¶‹åŠ¿å›¾"</li>
<li>ç³»ç»Ÿè°ƒç”¨"æ•°æ®å¤„ç†"æŠ€èƒ½ï¼ˆScript ç±»å‹ï¼‰ï¼Œæ‰§è¡Œ Python è„šæœ¬</li>
<li>ç”Ÿæˆæ•°æ®å¯è§†åŒ–å›¾è¡¨</li>
<li>ç”¨æˆ·å¯ä»¥å¯¼å‡ºæŠ¥å‘Šæˆ–è¿›ä¸€æ­¥åˆ†æ</li>
</ol>
<p><strong>æ”¶ç›Š</strong>ï¼šæ— éœ€ç¼–å†™ä»£ç ï¼Œé€šè¿‡è‡ªç„¶è¯­è¨€å®Œæˆæ•°æ®åˆ†æ</p>
<h3 data-id="heading-5">åœºæ™¯4ï¼šçŸ¥è¯†å·¥ä½œè€…</h3>
<p><strong>ç”¨æˆ·éœ€æ±‚</strong>ï¼šéœ€è¦æ•´ç†ä¼šè®®è®°å½•ã€ç”Ÿæˆå‘¨æŠ¥ã€ä¼˜åŒ–æ–‡æ¡£</p>
<p><strong>ä½¿ç”¨æµç¨‹</strong>ï¼š</p>
<ol>
<li>ç”¨æˆ·ç²˜è´´ä¼šè®®è®°å½•æ–‡æœ¬</li>
<li>è¾“å…¥ï¼š"å¸®æˆ‘æ•´ç†æˆç»“æ„åŒ–çš„ä¼šè®®çºªè¦"</li>
<li>ç³»ç»Ÿè°ƒç”¨"æ–‡æ¡£ä¼˜åŒ–"æŠ€èƒ½ï¼Œç”Ÿæˆæ ¼å¼åŒ–çš„ä¼šè®®çºªè¦</li>
<li>ç”¨æˆ·å¯ä»¥è¿›ä¸€æ­¥è¦æ±‚ï¼š"æå–å¾…åŠäº‹é¡¹"</li>
<li>ç³»ç»Ÿç”Ÿæˆå¾…åŠäº‹é¡¹åˆ—è¡¨</li>
</ol>
<p><strong>æ”¶ç›Š</strong>ï¼šæé«˜æ–‡æ¡£å¤„ç†æ•ˆç‡ï¼Œå‡å°‘æ ¼å¼åŒ–å·¥ä½œ</p>
<h2 data-id="heading-6">ä¸€ã€æŠ€æœ¯é€‰å‹ï¼šä¸ºä»€ä¹ˆé€‰æ‹© Tauri + Rustï¼Ÿ</h2>
<h3 data-id="heading-7">1.1 è·¨å¹³å°æ¡Œé¢å¼€å‘çš„é€‰æ‹©</h3>
<p>åœ¨å¼€å§‹å¼€å‘å‰ï¼Œæˆ‘å¯¹æ¯”äº†ä¸»æµçš„æ¡Œé¢è·¨å¹³å°æ–¹æ¡ˆï¼š</p>



































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¼˜åŠ¿</th><th>åŠ£åŠ¿</th><th>åŒ…ä½“ç§¯</th></tr></thead><tbody><tr><td>Electron</td><td>ç”Ÿæ€æˆç†Ÿï¼Œå¼€å‘æ•ˆç‡é«˜</td><td>å†…å­˜å ç”¨å¤§ï¼ŒåŒ…ä½“ç§¯å¤§</td><td>150MB+</td></tr><tr><td>Tauri</td><td>åŒ…ä½“ç§¯å°ï¼Œæ€§èƒ½å¥½ï¼Œå®‰å…¨æ€§é«˜</td><td>ç”Ÿæ€ç›¸å¯¹å¹´è½»</td><td>10-20MB</td></tr><tr><td>Flutter Desktop</td><td>ä¸€å¥—ä»£ç å¤šç«¯è¿è¡Œ</td><td>æ¡Œé¢ç«¯ç”Ÿæ€ä¸æˆç†Ÿ</td><td>20-30MB</td></tr><tr><td>Qt</td><td>æˆç†Ÿç¨³å®š</td><td>å¼€å‘æˆæœ¬é«˜ï¼Œç•Œé¢å¼€å‘ç¹ç</td><td>50MB+</td></tr></tbody></table>
<p>æœ€ç»ˆé€‰æ‹©Â <strong>Tauri 2.x</strong>Â çš„åŸå› ï¼š</p>
<ol>
<li><strong>æå°çš„åŒ…ä½“ç§¯</strong>ï¼šæœ€ç»ˆæ‰“åŒ…åä»… 15MB å·¦å³ï¼Œç›¸æ¯” Electron åŠ¨è¾„ 150MB+ çš„ä½“ç§¯ï¼Œç”¨æˆ·ä½“éªŒæ›´å¥½</li>
<li><strong>Rust åç«¯</strong>ï¼šé«˜æ€§èƒ½ã€å†…å­˜å®‰å…¨ï¼Œéå¸¸é€‚åˆå¤„ç†åŠ å¯†ã€æ–‡ä»¶æ“ä½œç­‰åº•å±‚ä»»åŠ¡</li>
<li><strong>å®‰å…¨æ€§</strong>ï¼šé»˜è®¤æœ€å°æƒé™åŸåˆ™ï¼ŒIPC é€šä¿¡æœ‰ä¸¥æ ¼çš„å‘½ä»¤ç™½åå•æœºåˆ¶</li>
<li><strong>Tauri 2.x æ–°ç‰¹æ€§</strong>ï¼šæ›´å¥½çš„æ’ä»¶ç³»ç»Ÿã€ç§»åŠ¨ç«¯æ”¯æŒé¢„è§ˆã€æ›´çµæ´»çš„æƒé™æ§åˆ¶</li>
<li><strong>å­¦ä¹ æ–°æŠ€æœ¯çš„æœºä¼š</strong>ï¼šRust çš„æ‰€æœ‰æƒæ¨¡å‹ã€ç±»å‹ç³»ç»Ÿè®©æˆ‘å¯¹ç³»ç»Ÿç¼–ç¨‹æœ‰äº†æ›´æ·±çš„ç†è§£ï¼Œè¿™ç§å­¦ä¹ è¿‡ç¨‹æœ¬èº«å°±æ˜¯ä¸€ç§æ”¶è·</li>
</ol>
<h3 data-id="heading-8">1.2 Agent Skills ç”Ÿæ€å…¼å®¹æ€§</h3>
<p>åœ¨å¼€å§‹æŠ€æœ¯é€‰å‹ä¹‹å‰ï¼Œæˆ‘æƒ³å…ˆè°ˆè°ˆé¡¹ç›®çš„ä¸€ä¸ªé‡è¦è®¾è®¡ç›®æ ‡ï¼š<strong>å…¼å®¹ Agent Skills ç”Ÿæ€</strong>ã€‚</p>
<p>Agent Skills æ˜¯ Claude Codeã€Cursorã€Windsurf ç­‰ AI ç¼–ç¨‹åŠ©æ‰‹æ‰€é‡‡ç”¨çš„æŠ€èƒ½å®šä¹‰è§„èŒƒã€‚å®ƒé€šè¿‡æ ‡å‡†åŒ–çš„Â <code>SKILL.md</code>Â æ–‡ä»¶æ ¼å¼ï¼Œè®©æŠ€èƒ½å¯ä»¥åœ¨ä¸åŒçš„ AI å·¥å…·ä¹‹é—´å…±äº«å’Œå¤ç”¨ã€‚</p>
<p><strong>Agent Skills æ ‡å‡†æ ¼å¼</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">.claude/skills/my-skill/
â”œâ”€â”€ SKILL.md              <span class="hljs-comment"># æŠ€èƒ½å®šä¹‰ï¼ˆYAML frontmatter + Markdownï¼‰</span>
â”œâ”€â”€ scripts/              <span class="hljs-comment"># å¯é€‰ï¼šè„šæœ¬æ–‡ä»¶</span>
â”‚   â””â”€â”€ main.py
â”œâ”€â”€ examples/             <span class="hljs-comment"># å¯é€‰ï¼šä½¿ç”¨ç¤ºä¾‹</span>
â”‚   â””â”€â”€ example.md
â””â”€â”€ references/           <span class="hljs-comment"># å¯é€‰ï¼šå‚è€ƒæ–‡æ¡£</span>
    â””â”€â”€ reference.md
</code></pre>
<p><strong>æ™ºèƒ½å·¥å…·ç®±çš„å…¼å®¹ç­–ç•¥</strong>ï¼š</p>
<ol>
<li><strong>åŒå‘è½¬æ¢</strong>ï¼šæ”¯æŒå°† Agent Skills æ ¼å¼è½¬æ¢ä¸ºå†…éƒ¨ DSLï¼Œåä¹‹äº¦ç„¶</li>
<li><strong>åŠŸèƒ½æ‰©å±•</strong>ï¼šåœ¨å…¼å®¹çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº† Workflow ç¼–æ’ã€Token ä¼˜åŒ–ç­‰é«˜çº§åŠŸèƒ½</li>
<li><strong>ç”Ÿæ€äº’é€š</strong>ï¼šç”¨æˆ·å¯ä»¥ç›´æ¥å¯¼å…¥ Claude Code çš„æŠ€èƒ½ï¼Œä¹Ÿå¯ä»¥å°†æ™ºèƒ½å·¥å…·ç®±çš„æŠ€èƒ½å¯¼å‡ºä¾›å…¶ä»–å·¥å…·ä½¿ç”¨</li>
</ol>
<p>è¿™ç§è®¾è®¡è®©æ™ºèƒ½å·¥å…·ç®±æ—¢èƒ½äº«å— Agent Skills ç”Ÿæ€çš„ä¸°å¯Œèµ„æºï¼Œåˆèƒ½æä¾›æ›´å¼ºå¤§çš„æœ¬åœ°èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-9">1.3 æŠ€æœ¯æ ˆå…¨æ™¯</h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           å‰ç«¯ (Frontend)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  React <span class="hljs-number">18</span> + TypeScript + Tailwind CSS + shadcn/ui           â”‚ â”‚
â”‚  â”‚  Zustand (çŠ¶æ€ç®¡ç†) + React Router (è·¯ç”±)                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        Tauri IPC Bridge                          â”‚
â”‚                    (åŸºäº Tauri Commands)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                           åç«¯ (Backend)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Tauri <span class="hljs-number">2</span><span class="hljs-selector-class">.x</span> + Rust                                           â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Commands Layer (å‘½ä»¤å±‚)                                 â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Services Layer (æœåŠ¡å±‚)                                 â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ LLM Providers (å¤šæ¨¡å‹é€‚é…å™¨)                             â”‚ â”‚
â”‚  â”‚  â””â”€â”€ SQLite Database (æœ¬åœ°å­˜å‚¨)                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 data-id="heading-10">äºŒã€æ ¸å¿ƒæ¶æ„è®¾è®¡</h2>
<h3 data-id="heading-11">2.1 æ•´ä½“æ¶æ„å›¾</h3>
<pre><code class="hljs language-bash" lang="bash">æ™ºèƒ½å·¥å…·ç®±æ¶æ„
â”œâ”€â”€ ğŸ“± å‰ç«¯ UI å±‚
â”‚   â”œâ”€â”€ pages/          <span class="hljs-comment"># é¡µé¢ç»„ä»¶</span>
â”‚   â”‚   â”œâ”€â”€ ChatPage        <span class="hljs-comment"># å¯¹è¯é¡µé¢</span>
â”‚   â”‚   â”œâ”€â”€ SkillsPage      <span class="hljs-comment"># æŠ€èƒ½åº“é¡µé¢</span>
â”‚   â”‚   â”œâ”€â”€ WorkflowPage    <span class="hljs-comment"># å·¥ä½œæµé¡µé¢</span>
â”‚   â”‚   â””â”€â”€ SettingsPage    <span class="hljs-comment"># è®¾ç½®é¡µé¢</span>
â”‚   â”œâ”€â”€ components/     <span class="hljs-comment"># é€šç”¨ç»„ä»¶</span>
â”‚   â”‚   â”œâ”€â”€ ui/             <span class="hljs-comment"># shadcn/ui åŸºç¡€ç»„ä»¶</span>
â”‚   â”‚   â”œâ”€â”€ wizard/         <span class="hljs-comment"># æŠ€èƒ½ç”Ÿæˆå‘å¯¼ç»„ä»¶</span>
â”‚   â”‚   â””â”€â”€ platform/       <span class="hljs-comment"># å¹³å°å‘å¸ƒç»„ä»¶</span>
â”‚   â”œâ”€â”€ stores/         <span class="hljs-comment"># Zustand çŠ¶æ€ç®¡ç†</span>
â”‚   â”‚   â”œâ”€â”€ chatStore       <span class="hljs-comment"># å¯¹è¯çŠ¶æ€</span>
â”‚   â”‚   â”œâ”€â”€ skillStore      <span class="hljs-comment"># æŠ€èƒ½çŠ¶æ€</span>
â”‚   â”‚   â””â”€â”€ configStore     <span class="hljs-comment"># é…ç½®çŠ¶æ€</span>
â”‚   â””â”€â”€ types/          <span class="hljs-comment"># TypeScript ç±»å‹å®šä¹‰</span>
â”‚
â””â”€â”€ âš™ï¸ åç«¯ Rust å±‚
    â”œâ”€â”€ commands/       <span class="hljs-comment"># Tauri å‘½ä»¤å±‚</span>
    â”‚   â”œâ”€â”€ chat.rs         <span class="hljs-comment"># å¯¹è¯ç›¸å…³å‘½ä»¤</span>
    â”‚   â”œâ”€â”€ skills.rs       <span class="hljs-comment"># æŠ€èƒ½ç®¡ç†å‘½ä»¤</span>
    â”‚   â”œâ”€â”€ workflow.rs     <span class="hljs-comment"># å·¥ä½œæµå‘½ä»¤</span>
    â”‚   â””â”€â”€ config.rs       <span class="hljs-comment"># é…ç½®å‘½ä»¤</span>
    â”œâ”€â”€ services/       <span class="hljs-comment"># æ ¸å¿ƒæœåŠ¡å±‚</span>
    â”‚   â”œâ”€â”€ skill_executor      <span class="hljs-comment"># æŠ€èƒ½æ‰§è¡Œå™¨</span>
    â”‚   â”œâ”€â”€ skill_wizard        <span class="hljs-comment"># æŠ€èƒ½ç”Ÿæˆå‘å¯¼</span>
    â”‚   â”œâ”€â”€ intent_recognizer   <span class="hljs-comment"># æ„å›¾è¯†åˆ«</span>
    â”‚   â”œâ”€â”€ token_optimizer     <span class="hljs-comment"># Token ä¼˜åŒ–</span>
    â”‚   â””â”€â”€ platform_publisher  <span class="hljs-comment"># å¹³å°å‘å¸ƒ</span>
    â”œâ”€â”€ llm/            <span class="hljs-comment"># LLM å¤šæ¨¡å‹é€‚é…</span>
    â”‚   â”œâ”€â”€ providers.rs    <span class="hljs-comment"># æ¨¡å‹æä¾›å•†é€‚é…</span>
    â”‚   â””â”€â”€ types.rs        <span class="hljs-comment"># LLM ç±»å‹å®šä¹‰</span>
    â”œâ”€â”€ workflow/       <span class="hljs-comment"># å·¥ä½œæµå¼•æ“</span>
    â”‚   â”œâ”€â”€ engine.rs       <span class="hljs-comment"># æ‰§è¡Œå¼•æ“</span>
    â”‚   â””â”€â”€ types.rs        <span class="hljs-comment"># å·¥ä½œæµç±»å‹</span>
    â””â”€â”€ database/       <span class="hljs-comment"># æ•°æ®åº“å±‚</span>
        â”œâ”€â”€ models.rs       <span class="hljs-comment"># æ•°æ®æ¨¡å‹</span>
        â””â”€â”€ migrations.rs   <span class="hljs-comment"># æ•°æ®åº“è¿ç§»</span>
</code></pre>
<h3 data-id="heading-12">2.2 æ•°æ®æµè®¾è®¡</h3>
<p>ä»¥ä¸€æ¬¡å…¸å‹çš„å¯¹è¯æµç¨‹ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">ç”¨æˆ·è¾“å…¥ "å¸®æˆ‘å†™ä¸€ç¯‡å…³äº Rust çš„æ–‡ç« "
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   ChatPage<span class="hljs-selector-class">.tsx</span>  â”‚  â† å‰ç«¯æ•è·ç”¨æˆ·è¾“å…¥
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ <span class="hljs-built_in">invoke</span>('send_message', {...})
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  chat<span class="hljs-selector-class">.rs</span>        â”‚  â† Tauri å‘½ä»¤å±‚
    â”‚  <span class="hljs-built_in">send_message</span>() â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ IntentRecognizerâ”‚  â† æ„å›¾è¯†åˆ«æœåŠ¡
    â”‚ <span class="hljs-built_in">analyze_intent</span>()â”‚     åˆ¤æ–­ç”¨æˆ·æƒ³åšä»€ä¹ˆ
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ è¯†åˆ«åˆ°ï¼šè°ƒç”¨æŠ€èƒ½ "<span class="hljs-selector-tag">article</span>-writer"
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ SkillExecutor   â”‚  â† æŠ€èƒ½æ‰§è¡Œå™¨
    â”‚ <span class="hljs-built_in">execute</span>()       â”‚     åŠ è½½æŠ€èƒ½é…ç½®ï¼Œå‡†å¤‡æç¤ºè¯
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ LLM Provider    â”‚  â† è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹
    â”‚ <span class="hljs-built_in">chat_stream</span>()   â”‚     æ”¯æŒ OpenAI/Claude/DeepSeek ç­‰
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ SSE æµå¼å“åº”
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  TokenOptimizer â”‚  â† Token ä¼˜åŒ–
    â”‚  <span class="hljs-built_in">record_usage</span>() â”‚     è®°å½•ä½¿ç”¨é‡ï¼Œä¼˜åŒ–ä¼šè¯
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   ChatPage<span class="hljs-selector-class">.tsx</span>  â”‚  â† å‰ç«¯æ¸²æŸ“ç»“æœ
    â”‚   å®æ—¶æ˜¾ç¤ºæµå¼è¾“å‡ºâ”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 data-id="heading-13">ä¸‰ã€æ ¸å¿ƒæ¨¡å—å®ç°è§£æ</h2>
<h3 data-id="heading-14">3.1 å¤šæ¨¡å‹ LLM é€‚é…å™¨</h3>
<p>ä¸ºäº†æ”¯æŒå¤šç§å¤§è¯­è¨€æ¨¡å‹ï¼Œæˆ‘è®¾è®¡äº†ä¸€å¥—ç»Ÿä¸€çš„é€‚é…å™¨æ¥å£ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/llm/providers.rs</span>

<span class="hljs-comment">/// LLM æä¾›å•†æšä¸¾</span>
<span class="hljs-meta">#[derive(Debug, Clone, Serialize, Deserialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">LLMProvider</span> {
    OpenAI,
    Claude,
    DeepSeek,
    AI360,
    Ollama,
}

<span class="hljs-comment">/// ç»Ÿä¸€çš„ LLM å®¢æˆ·ç«¯</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">LLMClient</span> {
    provider: LLMProvider,
    api_key: <span class="hljs-type">String</span>,
    base_url: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">String</span>&gt;,
    model: <span class="hljs-type">String</span>,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">LLMClient</span> {
    <span class="hljs-comment">/// æµå¼å¯¹è¯æ¥å£</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">chat_stream</span>(
        &amp;<span class="hljs-keyword">self</span>,
        messages: <span class="hljs-type">Vec</span>&lt;ChatMessage&gt;,
        options: ChatOptions,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Stream</span>&lt;Item = <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt;&gt;, AppError&gt; {
        <span class="hljs-keyword">match</span> <span class="hljs-keyword">self</span>.provider {
            LLMProvider::OpenAI =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">openai_stream</span>(messages, options).<span class="hljs-keyword">await</span>,
            LLMProvider::Claude =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">claude_stream</span>(messages, options).<span class="hljs-keyword">await</span>,
            LLMProvider::DeepSeek =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">deepseek_stream</span>(messages, options).<span class="hljs-keyword">await</span>,
            LLMProvider::AI360 =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">ai360_stream</span>(messages, options).<span class="hljs-keyword">await</span>,
            LLMProvider::Ollama =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">ollama_stream</span>(messages, options).<span class="hljs-keyword">await</span>,
        }
    }
    
    <span class="hljs-comment">/// OpenAI å…¼å®¹æ¥å£å®ç°</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">openai_stream</span>(
        &amp;<span class="hljs-keyword">self</span>,
        messages: <span class="hljs-type">Vec</span>&lt;ChatMessage&gt;,
        options: ChatOptions,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Stream</span>&lt;Item = <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt;&gt;, AppError&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">url</span> = <span class="hljs-built_in">format!</span>(
            <span class="hljs-string">"{}/chat/completions"</span>,
            <span class="hljs-keyword">self</span>.base_url.<span class="hljs-title function_ invoke__">as_deref</span>().<span class="hljs-title function_ invoke__">unwrap_or</span>(<span class="hljs-string">"https://api.openai.com/v1"</span>)
        );
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">payload</span> = json!({
            <span class="hljs-string">"model"</span>: <span class="hljs-keyword">self</span>.model,
            <span class="hljs-string">"messages"</span>: messages,
            <span class="hljs-string">"stream"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-string">"temperature"</span>: options.temperature.<span class="hljs-title function_ invoke__">unwrap_or</span>(<span class="hljs-number">0.7</span>),
            <span class="hljs-string">"max_tokens"</span>: options.max_tokens,
        });
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">response</span> = reqwest::Client::<span class="hljs-title function_ invoke__">new</span>()
            .<span class="hljs-title function_ invoke__">post</span>(&amp;url)
            .<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Authorization"</span>, <span class="hljs-built_in">format!</span>(<span class="hljs-string">"Bearer {}"</span>, <span class="hljs-keyword">self</span>.api_key))
            .<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>)
            .<span class="hljs-title function_ invoke__">json</span>(&amp;payload)
            .<span class="hljs-title function_ invoke__">send</span>()
            .<span class="hljs-keyword">await</span>?;
        
        <span class="hljs-comment">// å¤„ç† SSE æµå¼å“åº”</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">stream</span> = response.<span class="hljs-title function_ invoke__">bytes_stream</span>().<span class="hljs-title function_ invoke__">map</span>(|chunk| {
            <span class="hljs-comment">// è§£æ SSE æ•°æ®...</span>
        });
        
        <span class="hljs-title function_ invoke__">Ok</span>(stream)
    }
}
</code></pre>
<p><strong>è®¾è®¡äº®ç‚¹</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨æšä¸¾ç»Ÿä¸€ç®¡ç†æ‰€æœ‰æ”¯æŒçš„æ¨¡å‹æä¾›å•†</li>
<li>æµå¼æ¥å£è¿”å›Â <code>Stream</code>ï¼Œæ”¯æŒå®æ—¶æ¸²æŸ“</li>
<li>DeepSeekã€360AI ç­‰å›½äº§æ¨¡å‹å…¼å®¹ OpenAI æ¥å£æ ¼å¼ï¼Œä»£ç å¤ç”¨ç‡é«˜</li>
</ul>
<h3 data-id="heading-15">3.2 æŠ€èƒ½ç³»ç»Ÿè®¾è®¡</h3>
<p>æŠ€èƒ½æ˜¯æ™ºèƒ½å·¥å…·ç®±çš„æ ¸å¿ƒæ¦‚å¿µï¼Œä¸€ä¸ªæŠ€èƒ½å¯ä»¥ç†è§£ä¸ºã€Œä¸€ä¸ªå¯å¤ç”¨çš„ AI ä»»åŠ¡æ¨¡æ¿ã€ã€‚</p>
<h4 data-id="heading-16">æŠ€èƒ½æ•°æ®ç»“æ„</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/skills/mod.rs</span>

<span class="hljs-comment">/// æŠ€èƒ½ç±»å‹</span>
<span class="hljs-meta">#[derive(Debug, Clone, Serialize, Deserialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">SkillType</span> {
    Prompt,     <span class="hljs-comment">// æç¤ºè¯æŠ€èƒ½ï¼šçº¯ LLM è°ƒç”¨</span>
    Script,     <span class="hljs-comment">// è„šæœ¬æŠ€èƒ½ï¼šæ‰§è¡Œä»£ç </span>
    Workflow,   <span class="hljs-comment">// å·¥ä½œæµæŠ€èƒ½ï¼šå¤šæ­¥éª¤ç¼–æ’</span>
}

<span class="hljs-comment">/// æŠ€èƒ½å®šä¹‰</span>
<span class="hljs-meta">#[derive(Debug, Clone, Serialize, Deserialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Skill</span> {
    <span class="hljs-keyword">pub</span> id: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> name: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> display_name: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> description: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> skill_type: SkillType,
    <span class="hljs-keyword">pub</span> category: SkillCategory,
    <span class="hljs-keyword">pub</span> triggers: <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">String</span>&gt;,      <span class="hljs-comment">// è§¦å‘è¯</span>
    <span class="hljs-keyword">pub</span> icon: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> enabled: <span class="hljs-type">bool</span>,
    <span class="hljs-keyword">pub</span> prompt_config: <span class="hljs-type">Option</span>&lt;PromptConfig&gt;,
    <span class="hljs-keyword">pub</span> script_config: <span class="hljs-type">Option</span>&lt;ScriptConfig&gt;,
    <span class="hljs-keyword">pub</span> workflow_config: <span class="hljs-type">Option</span>&lt;WorkflowConfig&gt;,
}

<span class="hljs-comment">/// æç¤ºè¯é…ç½®</span>
<span class="hljs-meta">#[derive(Debug, Clone, Serialize, Deserialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">PromptConfig</span> {
    <span class="hljs-keyword">pub</span> system: <span class="hljs-type">String</span>,             <span class="hljs-comment">// ç³»ç»Ÿæç¤ºè¯ï¼ˆå®Œæ•´ç‰ˆï¼‰</span>
    <span class="hljs-keyword">pub</span> system_compact: <span class="hljs-type">String</span>,     <span class="hljs-comment">// ç³»ç»Ÿæç¤ºè¯ï¼ˆç²¾ç®€ç‰ˆï¼Œçœ Tokenï¼‰</span>
    <span class="hljs-keyword">pub</span> variables: <span class="hljs-type">Vec</span>&lt;SkillVariable&gt;,
    <span class="hljs-keyword">pub</span> output_format: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">String</span>&gt;,
}

<span class="hljs-comment">/// æŠ€èƒ½å˜é‡</span>
<span class="hljs-meta">#[derive(Debug, Clone, Serialize, Deserialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">SkillVariable</span> {
    <span class="hljs-keyword">pub</span> name: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> var_type: <span class="hljs-type">String</span>,           <span class="hljs-comment">// string / number / boolean / array</span>
    <span class="hljs-keyword">pub</span> description: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> required: <span class="hljs-type">bool</span>,
    <span class="hljs-keyword">pub</span> default: <span class="hljs-type">Option</span>&lt;Value&gt;,
}
</code></pre>
<h4 data-id="heading-17">æŠ€èƒ½æ‰§è¡Œå™¨</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/services/skill_executor.rs</span>

<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">SkillExecutor</span> {
    llm_client: LLMClient,
    db: Database,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">SkillExecutor</span> {
    <span class="hljs-comment">/// æ‰§è¡ŒæŠ€èƒ½</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">execute</span>(
        &amp;<span class="hljs-keyword">self</span>,
        skill: &amp;Skill,
        context: &amp;SkillContext,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;SkillResult, AppError&gt; {
        <span class="hljs-keyword">match</span> skill.skill_type {
            SkillType::Prompt =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">execute_prompt</span>(skill, context).<span class="hljs-keyword">await</span>,
            SkillType::Script =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">execute_script</span>(skill, context).<span class="hljs-keyword">await</span>,
            SkillType::Workflow =&gt; <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">execute_workflow</span>(skill, context).<span class="hljs-keyword">await</span>,
        }
    }
    
    <span class="hljs-comment">/// æ‰§è¡Œæç¤ºè¯æŠ€èƒ½</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">execute_prompt</span>(
        &amp;<span class="hljs-keyword">self</span>,
        skill: &amp;Skill,
        context: &amp;SkillContext,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;SkillResult, AppError&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">config</span> = skill.prompt_config.<span class="hljs-title function_ invoke__">as_ref</span>()
            .<span class="hljs-title function_ invoke__">ok_or_else</span>(|| AppError::<span class="hljs-title function_ invoke__">Skill</span>(<span class="hljs-string">"æŠ€èƒ½é…ç½®ç¼ºå¤±"</span>.<span class="hljs-title function_ invoke__">to_string</span>()))?;
        
        <span class="hljs-comment">// 1. æ ¹æ® Token ä¼˜åŒ–ç­–ç•¥é€‰æ‹©æç¤ºè¯ç‰ˆæœ¬</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">system_prompt</span> = <span class="hljs-keyword">if</span> context.use_compact_prompt {
            &amp;config.system_compact
        } <span class="hljs-keyword">else</span> {
            &amp;config.system
        };
        
        <span class="hljs-comment">// 2. å˜é‡æ›¿æ¢</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">processed_prompt</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">replace_variables</span>(system_prompt, &amp;context.variables)?;
        
        <span class="hljs-comment">// 3. æ„å»ºæ¶ˆæ¯åˆ—è¡¨</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">messages</span> = <span class="hljs-built_in">vec!</span>[
            ChatMessage { role: <span class="hljs-string">"system"</span>.<span class="hljs-title function_ invoke__">to_string</span>(), content: processed_prompt },
            ChatMessage { role: <span class="hljs-string">"user"</span>.<span class="hljs-title function_ invoke__">to_string</span>(), content: context.user_input.<span class="hljs-title function_ invoke__">clone</span>() },
        ];
        
        <span class="hljs-comment">// 4. è°ƒç”¨ LLM</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">response</span> = <span class="hljs-keyword">self</span>.llm_client.<span class="hljs-title function_ invoke__">chat_stream</span>(messages, ChatOptions::<span class="hljs-title function_ invoke__">default</span>()).<span class="hljs-keyword">await</span>?;
        
        <span class="hljs-title function_ invoke__">Ok</span>(SkillResult {
            success: <span class="hljs-literal">true</span>,
            output: response,
            token_used: <span class="hljs-number">0</span>, <span class="hljs-comment">// å®é™…ä¼šåœ¨æµç»“æŸåç»Ÿè®¡</span>
        })
    }
}
</code></pre>
<h3 data-id="heading-18">3.3 æ„å›¾è¯†åˆ«å¼•æ“</h3>
<p>å½“ç”¨æˆ·è¾“å…¥ä¸€æ®µè¯åï¼Œç³»ç»Ÿéœ€è¦åˆ¤æ–­ç”¨æˆ·çš„æ„å›¾ï¼Œå†³å®šæ˜¯ç›´æ¥å¯¹è¯ã€è°ƒç”¨æŠ€èƒ½ã€è¿˜æ˜¯æ‰§è¡Œå…¶ä»–æ“ä½œã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/services/intent_recognizer.rs</span>

<span class="hljs-comment">/// ç”¨æˆ·æ„å›¾ç±»å‹</span>
<span class="hljs-meta">#[derive(Debug, Clone, Serialize, Deserialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">UserIntent</span> {
    <span class="hljs-comment">/// è°ƒç”¨å·²æœ‰æŠ€èƒ½</span>
    InvokeSkill { skill_id: <span class="hljs-type">String</span>, confidence: <span class="hljs-type">f32</span> },
    <span class="hljs-comment">/// åˆ›å»ºæ–°æŠ€èƒ½</span>
    CreateSkill { description: <span class="hljs-type">String</span> },
    <span class="hljs-comment">/// ç®¡ç†æŠ€èƒ½ï¼ˆæŸ¥çœ‹ã€ç¼–è¾‘ã€åˆ é™¤ï¼‰</span>
    ManageSkill { action: <span class="hljs-type">String</span> },
    <span class="hljs-comment">/// æ‰§è¡Œå·¥ä½œæµ</span>
    RunWorkflow { workflow_id: <span class="hljs-type">String</span> },
    <span class="hljs-comment">/// æ™®é€šå¯¹è¯</span>
    Chat,
}

<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">IntentRecognizer</span> {
    skills: <span class="hljs-type">Vec</span>&lt;Skill&gt;,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">IntentRecognizer</span> {
    <span class="hljs-comment">/// åˆ†æç”¨æˆ·æ„å›¾</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">analyze</span>(&amp;<span class="hljs-keyword">self</span>, input: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> UserIntent {
        <span class="hljs-comment">// 1. å…ˆå°è¯•å…³é”®è¯åŒ¹é…ï¼ˆå¿«é€Ÿè·¯å¾„ï¼‰</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(intent) = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">keyword_match</span>(input) {
            <span class="hljs-keyword">return</span> intent;
        }
        
        <span class="hljs-comment">// 2. è§¦å‘è¯åŒ¹é…ï¼ˆéå†æ‰€æœ‰æŠ€èƒ½çš„ triggersï¼‰</span>
        <span class="hljs-keyword">for</span> <span class="hljs-variable">skill</span> <span class="hljs-keyword">in</span> &amp;<span class="hljs-keyword">self</span>.skills {
            <span class="hljs-keyword">for</span> <span class="hljs-variable">trigger</span> <span class="hljs-keyword">in</span> &amp;skill.triggers {
                <span class="hljs-keyword">if</span> input.<span class="hljs-title function_ invoke__">contains</span>(trigger) {
                    <span class="hljs-keyword">return</span> UserIntent::InvokeSkill {
                        skill_id: skill.id.<span class="hljs-title function_ invoke__">clone</span>(),
                        confidence: <span class="hljs-number">0.9</span>,
                    };
                }
            }
        }
        
        <span class="hljs-comment">// 3. æ¨¡ç³ŠåŒ¹é…ï¼ˆä½¿ç”¨ç¼–è¾‘è·ç¦»ç®—æ³•ï¼‰</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>((skill_id, score)) = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">fuzzy_match</span>(input) {
            <span class="hljs-keyword">if</span> score &gt; <span class="hljs-number">0.7</span> {
                <span class="hljs-keyword">return</span> UserIntent::InvokeSkill {
                    skill_id,
                    confidence: score,
                };
            }
        }
        
        <span class="hljs-comment">// 4. é»˜è®¤ä¸ºæ™®é€šå¯¹è¯</span>
        UserIntent::Chat
    }
    
    <span class="hljs-comment">/// å…³é”®è¯åŒ¹é…</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">keyword_match</span>(&amp;<span class="hljs-keyword">self</span>, input: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Option</span>&lt;UserIntent&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">create_keywords</span> = [<span class="hljs-string">"åˆ›å»ºæŠ€èƒ½"</span>, <span class="hljs-string">"æ–°å»ºæŠ€èƒ½"</span>, <span class="hljs-string">"ç”ŸæˆæŠ€èƒ½"</span>, <span class="hljs-string">"åšä¸€ä¸ªæŠ€èƒ½"</span>];
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">manage_keywords</span> = [<span class="hljs-string">"æŸ¥çœ‹æŠ€èƒ½"</span>, <span class="hljs-string">"ç¼–è¾‘æŠ€èƒ½"</span>, <span class="hljs-string">"åˆ é™¤æŠ€èƒ½"</span>, <span class="hljs-string">"æŠ€èƒ½åˆ—è¡¨"</span>];
        
        <span class="hljs-keyword">for</span> <span class="hljs-variable">keyword</span> <span class="hljs-keyword">in</span> create_keywords {
            <span class="hljs-keyword">if</span> input.<span class="hljs-title function_ invoke__">contains</span>(keyword) {
                <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Some</span>(UserIntent::CreateSkill {
                    description: input.<span class="hljs-title function_ invoke__">to_string</span>(),
                });
            }
        }
        
        <span class="hljs-keyword">for</span> <span class="hljs-variable">keyword</span> <span class="hljs-keyword">in</span> manage_keywords {
            <span class="hljs-keyword">if</span> input.<span class="hljs-title function_ invoke__">contains</span>(keyword) {
                <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Some</span>(UserIntent::ManageSkill {
                    action: keyword.<span class="hljs-title function_ invoke__">to_string</span>(),
                });
            }
        }
        
        <span class="hljs-literal">None</span>
    }
}
</code></pre>
<h3 data-id="heading-19">3.4 Token ä¼˜åŒ–ç­–ç•¥</h3>
<p>è°ƒç”¨ LLM éœ€è¦æ¶ˆè€— Tokenï¼Œå¦‚ä½•åœ¨ä¿è¯æ•ˆæœçš„å‰æä¸‹èŠ‚çœ Token æ˜¯ä¸€ä¸ªé‡è¦è¯¾é¢˜ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/services/token_optimizer.rs</span>

<span class="hljs-comment">/// Token ä¼˜åŒ–å™¨</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">TokenOptimizer</span> {
    db: Database,
    cache: HashMap&lt;<span class="hljs-type">String</span>, SessionCache&gt;,
}

<span class="hljs-comment">/// Prompt åˆ†çº§ç­–ç•¥</span>
<span class="hljs-meta">#[derive(Debug, Clone)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">PromptGrade</span> {
    Full,       <span class="hljs-comment">// å®Œæ•´ç‰ˆï¼šé¦–æ¬¡è°ƒç”¨ã€å¤æ‚ä»»åŠ¡</span>
    Compact,    <span class="hljs-comment">// ç²¾ç®€ç‰ˆï¼šè¿ç»­è°ƒç”¨ã€ç®€å•ä»»åŠ¡</span>
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">TokenOptimizer</span> {
    <span class="hljs-comment">/// å†³å®šä½¿ç”¨å“ªä¸ªç‰ˆæœ¬çš„ Prompt</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">decide_prompt_grade</span>(
        &amp;<span class="hljs-keyword">self</span>,
        skill_id: &amp;<span class="hljs-type">str</span>,
        context: &amp;CallContext,
    ) <span class="hljs-punctuation">-&gt;</span> PromptGrade {
        <span class="hljs-comment">// ç­–ç•¥ 1ï¼šè¿ç»­è°ƒç”¨åŒä¸€æŠ€èƒ½ï¼Œä½¿ç”¨ç²¾ç®€ç‰ˆ</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(cache) = <span class="hljs-keyword">self</span>.cache.<span class="hljs-title function_ invoke__">get</span>(skill_id) {
            <span class="hljs-keyword">if</span> cache.<span class="hljs-title function_ invoke__">is_recent</span>() &amp;&amp; cache.call_count &gt; <span class="hljs-number">1</span> {
                <span class="hljs-keyword">return</span> PromptGrade::Compact;
            }
        }
        
        <span class="hljs-comment">// ç­–ç•¥ 2ï¼šç”¨æˆ·ä¸»åŠ¨é€‰æ‹©ç²¾ç®€æ¨¡å¼</span>
        <span class="hljs-keyword">if</span> context.prefer_compact {
            <span class="hljs-keyword">return</span> PromptGrade::Compact;
        }
        
        <span class="hljs-comment">// ç­–ç•¥ 3ï¼šç®€å•è¾“å…¥ä½¿ç”¨ç²¾ç®€ç‰ˆ</span>
        <span class="hljs-keyword">if</span> context.user_input.<span class="hljs-title function_ invoke__">len</span>() &lt; <span class="hljs-number">50</span> {
            <span class="hljs-keyword">return</span> PromptGrade::Compact;
        }
        
        PromptGrade::Full
    }
    
    <span class="hljs-comment">/// ä¼šè¯å¤ç”¨ï¼šè¿ç»­è°ƒç”¨åŒä¸€æŠ€èƒ½æ—¶å¤ç”¨ä¸Šä¸‹æ–‡</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">get_or_create_session</span>(
        &amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>,
        skill_id: &amp;<span class="hljs-type">str</span>,
        ttl_seconds: <span class="hljs-type">u64</span>,
    ) <span class="hljs-punctuation">-&gt;</span> &amp;<span class="hljs-keyword">mut</span> SessionCache {
        <span class="hljs-keyword">self</span>.cache.<span class="hljs-title function_ invoke__">entry</span>(skill_id.<span class="hljs-title function_ invoke__">to_string</span>())
            .<span class="hljs-title function_ invoke__">or_insert_with</span>(|| SessionCache::<span class="hljs-title function_ invoke__">new</span>(ttl_seconds))
    }
    
    <span class="hljs-comment">/// è®°å½• Token ä½¿ç”¨é‡</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">record_usage</span>(
        &amp;<span class="hljs-keyword">self</span>,
        skill_id: &amp;<span class="hljs-type">str</span>,
        input_tokens: <span class="hljs-type">u32</span>,
        output_tokens: <span class="hljs-type">u32</span>,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;(), AppError&gt; {
        <span class="hljs-keyword">self</span>.db.<span class="hljs-title function_ invoke__">execute</span>(
            <span class="hljs-string">"INSERT INTO skill_usage_stats (skill_id, input_tokens, output_tokens, created_at)
             VALUES (?, ?, ?, ?)"</span>,
            params![skill_id, input_tokens, output_tokens, Utc::<span class="hljs-title function_ invoke__">now</span>()],
        ).<span class="hljs-keyword">await</span>?;
        <span class="hljs-title function_ invoke__">Ok</span>(())
    }
}
</code></pre>
<h3 data-id="heading-20">3.5 å·¥ä½œæµå¼•æ“</h3>
<p>å·¥ä½œæµå…è®¸ç”¨æˆ·å°†å¤šä¸ªæŠ€èƒ½/æ“ä½œä¸²è”èµ·æ¥ï¼Œå½¢æˆè‡ªåŠ¨åŒ–æµç¨‹ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/workflow/engine.rs</span>

<span class="hljs-comment">/// å·¥ä½œæµæ‰§è¡Œå¼•æ“</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">WorkflowEngine</span> {
    skill_executor: SkillExecutor,
    http_client: HttpClient,
}

<span class="hljs-comment">/// å·¥ä½œæµèŠ‚ç‚¹ç±»å‹</span>
<span class="hljs-meta">#[derive(Debug, Clone, Serialize, Deserialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">WorkflowNodeType</span> {
    Start,
    End,
    Skill,          <span class="hljs-comment">// è°ƒç”¨æŠ€èƒ½</span>
    Condition,      <span class="hljs-comment">// æ¡ä»¶åˆ†æ”¯</span>
    Loop,           <span class="hljs-comment">// å¾ªç¯</span>
    SetVariable,    <span class="hljs-comment">// è®¾ç½®å˜é‡</span>
    HttpRequest,    <span class="hljs-comment">// HTTP è¯·æ±‚</span>
    Delay,          <span class="hljs-comment">// å»¶æ—¶</span>
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">WorkflowEngine</span> {
    <span class="hljs-comment">/// æ‰§è¡Œå·¥ä½œæµ</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">execute</span>(
        &amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>,
        workflow: &amp;Workflow,
        initial_input: Value,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;WorkflowResult, AppError&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">context</span> = WorkflowContext::<span class="hljs-title function_ invoke__">new</span>(initial_input);
        
        <span class="hljs-comment">// æ‰¾åˆ°èµ·å§‹èŠ‚ç‚¹</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">start_node</span> = workflow.nodes.<span class="hljs-title function_ invoke__">iter</span>()
            .<span class="hljs-title function_ invoke__">find</span>(|n| n.node_type == WorkflowNodeType::Start)
            .<span class="hljs-title function_ invoke__">ok_or_else</span>(|| AppError::<span class="hljs-title function_ invoke__">Workflow</span>(<span class="hljs-string">"ç¼ºå°‘èµ·å§‹èŠ‚ç‚¹"</span>.<span class="hljs-title function_ invoke__">to_string</span>()))?;
        
        <span class="hljs-comment">// ä½¿ç”¨æ ˆè¿­ä»£æ‰§è¡Œï¼Œé¿å…é€’å½’</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">stack</span> = <span class="hljs-built_in">vec!</span>[start_node.id.<span class="hljs-title function_ invoke__">clone</span>()];
        
        <span class="hljs-keyword">while</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(node_id) = stack.<span class="hljs-title function_ invoke__">pop</span>() {
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">node</span> = workflow.<span class="hljs-title function_ invoke__">get_node</span>(&amp;node_id)?;
            
            <span class="hljs-comment">// æ‰§è¡ŒèŠ‚ç‚¹</span>
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">execute_node</span>(node, &amp;<span class="hljs-keyword">mut</span> context).<span class="hljs-keyword">await</span>?;
            
            <span class="hljs-comment">// æ ¹æ®ç»“æœå†³å®šä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span>
            <span class="hljs-keyword">match</span> node.node_type {
                WorkflowNodeType::End =&gt; <span class="hljs-keyword">break</span>,
                WorkflowNodeType::Condition =&gt; {
                    <span class="hljs-comment">// æ¡ä»¶èŠ‚ç‚¹ï¼šæ ¹æ®ç»“æœé€‰æ‹©åˆ†æ”¯</span>
                    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">next</span> = <span class="hljs-keyword">if</span> result.<span class="hljs-title function_ invoke__">as_bool</span>().<span class="hljs-title function_ invoke__">unwrap_or</span>(<span class="hljs-literal">false</span>) {
                        &amp;node.data.true_branch
                    } <span class="hljs-keyword">else</span> {
                        &amp;node.data.false_branch
                    };
                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(next_id) = next {
                        stack.<span class="hljs-title function_ invoke__">push</span>(next_id.<span class="hljs-title function_ invoke__">clone</span>());
                    }
                }
                _ =&gt; {
                    <span class="hljs-comment">// æ™®é€šèŠ‚ç‚¹ï¼šæ‰¾åˆ°ä¸‹ä¸€ä¸ªè¿æ¥çš„èŠ‚ç‚¹</span>
                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(edge) = workflow.edges.<span class="hljs-title function_ invoke__">iter</span>().<span class="hljs-title function_ invoke__">find</span>(|e| e.source == node_id) {
                        stack.<span class="hljs-title function_ invoke__">push</span>(edge.target.<span class="hljs-title function_ invoke__">clone</span>());
                    }
                }
            }
        }
        
        <span class="hljs-title function_ invoke__">Ok</span>(WorkflowResult {
            success: <span class="hljs-literal">true</span>,
            outputs: context.outputs,
            variables: context.variables,
        })
    }
    
    <span class="hljs-comment">/// æ‰§è¡Œå•ä¸ªèŠ‚ç‚¹</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">execute_node</span>(
        &amp;<span class="hljs-keyword">self</span>,
        node: &amp;WorkflowNode,
        context: &amp;<span class="hljs-keyword">mut</span> WorkflowContext,
    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Value, AppError&gt; {
        <span class="hljs-keyword">match</span> node.node_type {
            WorkflowNodeType::Skill =&gt; {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">skill_id</span> = node.data.skill_id.<span class="hljs-title function_ invoke__">as_ref</span>()
                    .<span class="hljs-title function_ invoke__">ok_or_else</span>(|| AppError::<span class="hljs-title function_ invoke__">Workflow</span>(<span class="hljs-string">"æŠ€èƒ½èŠ‚ç‚¹ç¼ºå°‘ skill_id"</span>.<span class="hljs-title function_ invoke__">to_string</span>()))?;
                
                <span class="hljs-comment">// æ‰§è¡ŒæŠ€èƒ½å¹¶è·å–ç»“æœ</span>
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span> = <span class="hljs-keyword">self</span>.skill_executor.<span class="hljs-title function_ invoke__">execute_by_id</span>(skill_id, context).<span class="hljs-keyword">await</span>?;
                
                <span class="hljs-comment">// å°†ç»“æœå­˜å…¥ä¸Šä¸‹æ–‡ï¼Œä¾›åç»­èŠ‚ç‚¹ä½¿ç”¨</span>
                context.<span class="hljs-title function_ invoke__">set_node_output</span>(&amp;node.id, result.<span class="hljs-title function_ invoke__">clone</span>());
                
                <span class="hljs-title function_ invoke__">Ok</span>(result)
            }
            WorkflowNodeType::HttpRequest =&gt; {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">config</span> = &amp;node.data.http_config;
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">response</span> = <span class="hljs-keyword">self</span>.http_client.<span class="hljs-title function_ invoke__">request</span>(config).<span class="hljs-keyword">await</span>?;
                context.<span class="hljs-title function_ invoke__">set_node_output</span>(&amp;node.id, response.<span class="hljs-title function_ invoke__">clone</span>());
                <span class="hljs-title function_ invoke__">Ok</span>(response)
            }
            WorkflowNodeType::SetVariable =&gt; {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">var_name</span> = &amp;node.data.variable_name;
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">value</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">resolve_value</span>(&amp;node.data.value, context)?;
                context.variables.<span class="hljs-title function_ invoke__">insert</span>(var_name.<span class="hljs-title function_ invoke__">clone</span>(), value.<span class="hljs-title function_ invoke__">clone</span>());
                <span class="hljs-title function_ invoke__">Ok</span>(value)
            }
            WorkflowNodeType::Delay =&gt; {
                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ms</span> = node.data.delay_ms.<span class="hljs-title function_ invoke__">unwrap_or</span>(<span class="hljs-number">1000</span>);
                tokio::time::<span class="hljs-title function_ invoke__">sleep</span>(Duration::<span class="hljs-title function_ invoke__">from_millis</span>(ms)).<span class="hljs-keyword">await</span>;
                <span class="hljs-title function_ invoke__">Ok</span>(json!({<span class="hljs-string">"delayed_ms"</span>: ms}))
            }
            _ =&gt; <span class="hljs-title function_ invoke__">Ok</span>(json!({})),
        }
    }
}
</code></pre>
<h3 data-id="heading-21">3.6 API Key å®‰å…¨å­˜å‚¨</h3>
<p>API Key æ˜¯æ•æ„Ÿä¿¡æ¯ï¼Œéœ€è¦åŠ å¯†å­˜å‚¨ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/services/crypto.rs</span>

<span class="hljs-keyword">use</span> aes_gcm::{Aes256Gcm, Key, Nonce};
<span class="hljs-keyword">use</span> aes_gcm::aead::{Aead, NewAead};

<span class="hljs-comment">/// åŠ å¯†æœåŠ¡</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">CryptoService</span> {
    key: Key&lt;Aes256Gcm&gt;,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">CryptoService</span> {
    <span class="hljs-comment">/// ä»è®¾å¤‡æŒ‡çº¹æ´¾ç”Ÿå¯†é’¥</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">from_device_fingerprint</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">Self</span> {
        <span class="hljs-comment">// ç»„åˆå¤šä¸ªè®¾å¤‡ç‰¹å¾ç”Ÿæˆå”¯ä¸€æŒ‡çº¹</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">fingerprint</span> = <span class="hljs-built_in">format!</span>(
            <span class="hljs-string">"{}-{}-{}"</span>,
            whoami::<span class="hljs-title function_ invoke__">hostname</span>(),
            whoami::<span class="hljs-title function_ invoke__">username</span>(),
            machine_uid::<span class="hljs-title function_ invoke__">get</span>().<span class="hljs-title function_ invoke__">unwrap_or_default</span>()
        );
        
        <span class="hljs-comment">// ä½¿ç”¨ PBKDF2 æ´¾ç”Ÿ 256 ä½å¯†é’¥</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">salt</span> = <span class="hljs-string">b"smart-toolbox-salt"</span>;
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">key</span> = [<span class="hljs-number">0u8</span>; <span class="hljs-number">32</span>];
        pbkdf2::pbkdf2::&lt;Hmac&lt;Sha256&gt;&gt;(
            fingerprint.<span class="hljs-title function_ invoke__">as_bytes</span>(),
            salt,
            <span class="hljs-number">100_000</span>,
            &amp;<span class="hljs-keyword">mut</span> key,
        );
        
        <span class="hljs-keyword">Self</span> { key: Key::<span class="hljs-title function_ invoke__">from_slice</span>(&amp;key).<span class="hljs-title function_ invoke__">clone</span>() }
    }
    
    <span class="hljs-comment">/// åŠ å¯† API Key</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">encrypt</span>(&amp;<span class="hljs-keyword">self</span>, plaintext: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">cipher</span> = Aes256Gcm::<span class="hljs-title function_ invoke__">new</span>(&amp;<span class="hljs-keyword">self</span>.key);
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">nonce</span> = Nonce::<span class="hljs-title function_ invoke__">from_slice</span>(<span class="hljs-string">b"unique nonce"</span>); <span class="hljs-comment">// å®é™…åº”ä½¿ç”¨éšæœº nonce</span>
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ciphertext</span> = cipher.<span class="hljs-title function_ invoke__">encrypt</span>(nonce, plaintext.<span class="hljs-title function_ invoke__">as_bytes</span>())
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(e.<span class="hljs-title function_ invoke__">to_string</span>()))?;
        
        <span class="hljs-title function_ invoke__">Ok</span>(base64::<span class="hljs-title function_ invoke__">encode</span>(&amp;ciphertext))
    }
    
    <span class="hljs-comment">/// è§£å¯† API Key</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">decrypt</span>(&amp;<span class="hljs-keyword">self</span>, ciphertext: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">cipher</span> = Aes256Gcm::<span class="hljs-title function_ invoke__">new</span>(&amp;<span class="hljs-keyword">self</span>.key);
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">nonce</span> = Nonce::<span class="hljs-title function_ invoke__">from_slice</span>(<span class="hljs-string">b"unique nonce"</span>);
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ciphertext_bytes</span> = base64::<span class="hljs-title function_ invoke__">decode</span>(ciphertext)
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(e.<span class="hljs-title function_ invoke__">to_string</span>()))?;
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">plaintext</span> = cipher.<span class="hljs-title function_ invoke__">decrypt</span>(nonce, ciphertext_bytes.<span class="hljs-title function_ invoke__">as_ref</span>())
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(e.<span class="hljs-title function_ invoke__">to_string</span>()))?;
        
        <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from_utf8</span>(plaintext)
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(e.<span class="hljs-title function_ invoke__">to_string</span>()))
    }
}
</code></pre>
<h3 data-id="heading-22">3.7 Agent Skills å…¼å®¹å±‚è®¾è®¡</h3>
<p>ä¸ºäº†ä¸ Agent Skills ç”Ÿæ€äº’é€šï¼Œæˆ‘è®¾è®¡äº†ä¸€ä¸ªä¸“é—¨çš„å…¼å®¹å±‚ï¼Œå®ç°åŒå‘è½¬æ¢åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-23">3.7.1 Agent Skills æ ¼å¼è§£æ</h4>
<p>Agent Skills ä½¿ç”¨Â <code>SKILL.md</code>Â æ–‡ä»¶å®šä¹‰æŠ€èƒ½ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">article-writer</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">æ ¹æ®ä¸»é¢˜ç”Ÿæˆé«˜è´¨é‡æ–‡ç« </span>
<span class="hljs-attr">version:</span> <span class="hljs-number">1.0</span><span class="hljs-number">.0</span>
<span class="hljs-attr">author:</span> <span class="hljs-string">Your</span> <span class="hljs-string">Name</span>
<span class="hljs-attr">tags:</span> [<span class="hljs-string">writing</span>, <span class="hljs-string">content</span>]
<span class="hljs-meta">---
</span>
<span class="hljs-comment"># Article Writer Skill</span>

<span class="hljs-comment">## Description</span>
<span class="hljs-string">This</span> <span class="hljs-string">skill</span> <span class="hljs-string">generates</span> <span class="hljs-string">high-quality</span> <span class="hljs-string">articles</span> <span class="hljs-string">based</span> <span class="hljs-string">on</span> <span class="hljs-string">a</span> <span class="hljs-string">given</span> <span class="hljs-string">topic.</span>

<span class="hljs-comment">## When to Use This Skill</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">You</span> <span class="hljs-string">need</span> <span class="hljs-string">to</span> <span class="hljs-string">write</span> <span class="hljs-string">a</span> <span class="hljs-string">blog</span> <span class="hljs-string">post</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">You</span> <span class="hljs-string">want</span> <span class="hljs-string">to</span> <span class="hljs-string">create</span> <span class="hljs-string">content</span> <span class="hljs-string">for</span> <span class="hljs-string">social</span> <span class="hljs-string">media</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">You</span> <span class="hljs-string">need</span> <span class="hljs-string">to</span> <span class="hljs-string">draft</span> <span class="hljs-string">an</span> <span class="hljs-string">article</span> <span class="hljs-string">quickly</span>

<span class="hljs-comment">## How to Use</span>
<span class="hljs-string">Simply</span> <span class="hljs-string">provide</span> <span class="hljs-string">a</span> <span class="hljs-string">topic</span> <span class="hljs-string">and</span> <span class="hljs-string">optionally</span> <span class="hljs-string">specify</span> <span class="hljs-string">the</span> <span class="hljs-string">style</span> <span class="hljs-string">and</span> <span class="hljs-string">length.</span>

<span class="hljs-comment">## Examples</span>

<span class="hljs-comment">### Example 1: Tech Article</span>
<span class="hljs-string">**Input**:</span> <span class="hljs-string">"Write a 1500-word technical article about Rust"</span>
<span class="hljs-string">**Output**:</span> [<span class="hljs-string">Generated</span> <span class="hljs-string">article</span> <span class="hljs-string">content</span>]
</code></pre>
<h4 data-id="heading-24">3.7.2 å¯¼å…¥è½¬æ¢å®ç°</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/commands/agent_skills.rs</span>

<span class="hljs-keyword">use</span> std::path::Path;
<span class="hljs-keyword">use</span> serde_yaml::Value;
<span class="hljs-keyword">use</span> regex::Regex;

<span class="hljs-comment">/// Agent Skills å‰ç½®å…ƒæ•°æ®</span>
<span class="hljs-meta">#[derive(Debug, Deserialize)]</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">AgentSkillFrontmatter</span> {
    name: <span class="hljs-type">String</span>,
    description: <span class="hljs-type">String</span>,
    <span class="hljs-meta">#[serde(default)]</span>
    version: <span class="hljs-type">String</span>,
    <span class="hljs-meta">#[serde(default)]</span>
    author: <span class="hljs-type">String</span>,
    <span class="hljs-meta">#[serde(default)]</span>
    tags: <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">String</span>&gt;,
}

<span class="hljs-comment">/// è§£æ SKILL.md æ–‡ä»¶</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">parse_skill_md</span>(path: &amp;Path) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Skill, AppError&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">content</span> = std::fs::<span class="hljs-title function_ invoke__">read_to_string</span>(path)?;
    
    <span class="hljs-comment">// æå– YAML frontmatter</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">frontmatter_re</span> = Regex::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-string">r"^---\n(.*?)\n---"</span>).<span class="hljs-title function_ invoke__">unwrap</span>();
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">caps</span> = frontmatter_re.<span class="hljs-title function_ invoke__">captures</span>(&amp;content)
        .<span class="hljs-title function_ invoke__">ok_or_else</span>(|| AppError::<span class="hljs-title function_ invoke__">Parse</span>(<span class="hljs-string">"ç¼ºå°‘ YAML frontmatter"</span>.<span class="hljs-title function_ invoke__">to_string</span>()))?;
    
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">yaml_str</span> = &amp;caps[<span class="hljs-number">1</span>];
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">frontmatter</span>: AgentSkillFrontmatter = serde_yaml::<span class="hljs-title function_ invoke__">from_str</span>(yaml_str)
        .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Parse</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"YAML è§£æå¤±è´¥: {}"</span>, e)))?;
    
    <span class="hljs-comment">// æå– Markdown æ­£æ–‡</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">markdown_body</span> = frontmatter_re.<span class="hljs-title function_ invoke__">replace</span>(&amp;content, <span class="hljs-string">""</span>).<span class="hljs-title function_ invoke__">to_string</span>();
    
    <span class="hljs-comment">// åˆ¤æ–­æŠ€èƒ½ç±»å‹</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">skill_dir</span> = path.<span class="hljs-title function_ invoke__">parent</span>().<span class="hljs-title function_ invoke__">unwrap</span>();
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">scripts_dir</span> = skill_dir.<span class="hljs-title function_ invoke__">join</span>(<span class="hljs-string">"scripts"</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">skill_type</span> = <span class="hljs-keyword">if</span> scripts_dir.<span class="hljs-title function_ invoke__">exists</span>() {
        SkillType::Script
    } <span class="hljs-keyword">else</span> {
        SkillType::Prompt
    };
    
    <span class="hljs-comment">// è½¬æ¢ä¸ºå†…éƒ¨ Skill æ ¼å¼</span>
    <span class="hljs-title function_ invoke__">Ok</span>(Skill {
        id: <span class="hljs-built_in">format!</span>(<span class="hljs-string">"agent-skills-{}"</span>, frontmatter.name),
        name: frontmatter.name.<span class="hljs-title function_ invoke__">clone</span>(),
        display_name: frontmatter.name,
        description: frontmatter.description,
        skill_type,
        category: <span class="hljs-title function_ invoke__">infer_category</span>(&amp;frontmatter.tags),
        triggers: <span class="hljs-title function_ invoke__">extract_triggers</span>(&amp;markdown_body),
        icon: <span class="hljs-string">"ğŸ“¦"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),
        enabled: <span class="hljs-literal">true</span>,
        prompt_config: <span class="hljs-keyword">if</span> skill_type == SkillType::Prompt {
            <span class="hljs-title function_ invoke__">Some</span>(PromptConfig {
                system: markdown_body.<span class="hljs-title function_ invoke__">clone</span>(),
                system_compact: <span class="hljs-title function_ invoke__">compact_prompt</span>(&amp;markdown_body),
                variables: <span class="hljs-title function_ invoke__">extract_variables</span>(&amp;markdown_body),
                output_format: <span class="hljs-literal">None</span>,
            })
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-literal">None</span>
        },
        script_config: <span class="hljs-keyword">if</span> skill_type == SkillType::Script {
            <span class="hljs-title function_ invoke__">Some</span>(ScriptConfig {
                language: <span class="hljs-title function_ invoke__">detect_script_language</span>(&amp;scripts_dir)?,
                code: <span class="hljs-title function_ invoke__">load_script_code</span>(&amp;scripts_dir)?,
            })
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-literal">None</span>
        },
        workflow_config: <span class="hljs-literal">None</span>,
    })
}

<span class="hljs-comment">/// ä»ç›®å½•å¯¼å…¥æ‰€æœ‰ Agent Skills</span>
<span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">import_agent_skills</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">Vec</span>&lt;Skill&gt;, AppError&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">skills_dir</span> = Path::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-string">".claude/skills"</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">skills</span> = <span class="hljs-type">Vec</span>::<span class="hljs-title function_ invoke__">new</span>();
    
    <span class="hljs-keyword">if</span> !skills_dir.<span class="hljs-title function_ invoke__">exists</span>() {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Ok</span>(skills);
    }
    
    <span class="hljs-keyword">for</span> <span class="hljs-variable">entry</span> <span class="hljs-keyword">in</span> std::fs::<span class="hljs-title function_ invoke__">read_dir</span>(skills_dir)? {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">entry</span> = entry?;
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">skill_md</span> = entry.<span class="hljs-title function_ invoke__">path</span>().<span class="hljs-title function_ invoke__">join</span>(<span class="hljs-string">"SKILL.md"</span>);
        
        <span class="hljs-keyword">if</span> skill_md.<span class="hljs-title function_ invoke__">exists</span>() {
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Ok</span>(skill) = <span class="hljs-title function_ invoke__">parse_skill_md</span>(&amp;skill_md) {
                skills.<span class="hljs-title function_ invoke__">push</span>(skill);
            }
        }
    }
    
    <span class="hljs-title function_ invoke__">Ok</span>(skills)
}
</code></pre>
<h4 data-id="heading-25">3.7.3 å¯¼å‡ºè½¬æ¢å®ç°</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">/// å°†å†…éƒ¨ Skill å¯¼å‡ºä¸º Agent Skills æ ¼å¼</span>
<span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">export_to_agent_skills</span>(skill: &amp;Skill) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">frontmatter</span> = <span class="hljs-built_in">format!</span>(
        <span class="hljs-string">r#"---
name: {}
description: {}
version: {}
author: {}
tags: [{}]
---
"#</span>,
        skill.name,
        skill.description,
        <span class="hljs-string">"1.0.0"</span>,
        <span class="hljs-string">"Smart Toolbox"</span>,
        skill.category.<span class="hljs-title function_ invoke__">to_lowercase</span>()
    );
    
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">content</span> = frontmatter;
    
    <span class="hljs-comment">// æ·»åŠ æŠ€èƒ½æè¿°</span>
    content.<span class="hljs-title function_ invoke__">push_str</span>(&amp;<span class="hljs-built_in">format!</span>(<span class="hljs-string">"# {}\n\n"</span>, skill.display_name));
    content.<span class="hljs-title function_ invoke__">push_str</span>(&amp;<span class="hljs-built_in">format!</span>(<span class="hljs-string">"## Description\n{}\n\n"</span>, skill.description));
    
    <span class="hljs-comment">// æ·»åŠ è§¦å‘è¯</span>
    <span class="hljs-keyword">if</span> !skill.triggers.<span class="hljs-title function_ invoke__">is_empty</span>() {
        content.<span class="hljs-title function_ invoke__">push_str</span>(<span class="hljs-string">"## Triggers\n"</span>);
        <span class="hljs-keyword">for</span> <span class="hljs-variable">trigger</span> <span class="hljs-keyword">in</span> &amp;skill.triggers {
            content.<span class="hljs-title function_ invoke__">push_str</span>(&amp;<span class="hljs-built_in">format!</span>(<span class="hljs-string">"- {}\n"</span>, trigger));
        }
        content.<span class="hljs-title function_ invoke__">push_str</span>(<span class="hljs-string">"\n"</span>);
    }
    
    <span class="hljs-comment">// æ·»åŠ ä½¿ç”¨è¯´æ˜</span>
    content.<span class="hljs-title function_ invoke__">push_str</span>(<span class="hljs-string">"## How to Use\n"</span>);
    content.<span class="hljs-title function_ invoke__">push_str</span>(<span class="hljs-string">"This skill can be triggered by the keywords listed above.\n\n"</span>);
    
    <span class="hljs-comment">// æ·»åŠ  Prompt å†…å®¹</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(config) = &amp;skill.prompt_config {
        content.<span class="hljs-title function_ invoke__">push_str</span>(<span class="hljs-string">"## System Prompt\n\n"</span>);
        content.<span class="hljs-title function_ invoke__">push_str</span>(&amp;config.system);
    }
    
    <span class="hljs-title function_ invoke__">Ok</span>(content)
}

<span class="hljs-comment">/// å¯¼å‡ºæŠ€èƒ½åˆ°æ–‡ä»¶ç³»ç»Ÿ</span>
<span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">export_skill_to_file</span>(skill: &amp;Skill, output_dir: <span class="hljs-type">String</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">skill_dir</span> = Path::<span class="hljs-title function_ invoke__">new</span>(&amp;output_dir).<span class="hljs-title function_ invoke__">join</span>(&amp;skill.name);
    std::fs::<span class="hljs-title function_ invoke__">create_dir_all</span>(&amp;skill_dir)?;
    
    <span class="hljs-comment">// å†™å…¥ SKILL.md</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">skill_md</span> = <span class="hljs-title function_ invoke__">export_to_agent_skills</span>(skill).<span class="hljs-keyword">await</span>?;
    std::fs::<span class="hljs-title function_ invoke__">write</span>(skill_dir.<span class="hljs-title function_ invoke__">join</span>(<span class="hljs-string">"SKILL.md"</span>), skill_md)?;
    
    <span class="hljs-comment">// å¦‚æœæ˜¯ Script ç±»å‹ï¼Œå¤åˆ¶è„šæœ¬æ–‡ä»¶</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(config) = &amp;skill.script_config {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">scripts_dir</span> = skill_dir.<span class="hljs-title function_ invoke__">join</span>(<span class="hljs-string">"scripts"</span>);
        std::fs::<span class="hljs-title function_ invoke__">create_dir_all</span>(&amp;scripts_dir)?;
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">script_file</span> = <span class="hljs-keyword">match</span> config.language.<span class="hljs-title function_ invoke__">as_str</span>() {
            <span class="hljs-string">"python"</span> =&gt; <span class="hljs-string">"main.py"</span>,
            <span class="hljs-string">"javascript"</span> =&gt; <span class="hljs-string">"main.js"</span>,
            <span class="hljs-string">"typescript"</span> =&gt; <span class="hljs-string">"main.ts"</span>,
            _ =&gt; <span class="hljs-string">"script.txt"</span>,
        };
        
        std::fs::<span class="hljs-title function_ invoke__">write</span>(scripts_dir.<span class="hljs-title function_ invoke__">join</span>(script_file), &amp;config.code)?;
    }
    
    <span class="hljs-title function_ invoke__">Ok</span>(skill_dir.<span class="hljs-title function_ invoke__">to_string_lossy</span>().<span class="hljs-title function_ invoke__">to_string</span>())
}
</code></pre>
<h4 data-id="heading-26">3.7.4 æ™ºèƒ½æ¨æ–­ä¸å¢å¼º</h4>
<p>åœ¨è½¬æ¢è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿä¼šè¿›è¡Œæ™ºèƒ½æ¨æ–­å’ŒåŠŸèƒ½å¢å¼ºï¼š</p>
<pre><code class="hljs language-python" lang="python">/// ä»æ ‡ç­¾æ¨æ–­æŠ€èƒ½åˆ†ç±»
fn infer_category(tags: &amp;[String]) -&gt; SkillCategory {
    let tag_str = tags.join(<span class="hljs-string">" "</span>).to_lowercase();
    
    <span class="hljs-keyword">if</span> tag_str.contains(<span class="hljs-string">"writing"</span>) || tag_str.contains(<span class="hljs-string">"content"</span>) {
        SkillCategory::Content
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> tag_str.contains(<span class="hljs-string">"code"</span>) || tag_str.contains(<span class="hljs-string">"dev"</span>) {
        SkillCategory::Development
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> tag_str.contains(<span class="hljs-string">"data"</span>) || tag_str.contains(<span class="hljs-string">"analysis"</span>) {
        SkillCategory::Data
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> tag_str.contains(<span class="hljs-string">"publish"</span>) || tag_str.contains(<span class="hljs-string">"social"</span>) {
        SkillCategory::Publish
    } <span class="hljs-keyword">else</span> {
        SkillCategory::General
    }
}

/// ä» Markdown å†…å®¹ä¸­æå–è§¦å‘è¯
fn extract_triggers(content: &amp;<span class="hljs-built_in">str</span>) -&gt; Vec&lt;String&gt; {
    let mut triggers = Vec::new();
    
    // æå–æ ‡é¢˜ä¸­çš„å…³é”®è¯
    let title_re = Regex::new(<span class="hljs-string">r"^#+\s*(.+)$"</span>).unwrap();
    <span class="hljs-keyword">for</span> caps <span class="hljs-keyword">in</span> title_re.captures_iter(content) {
        let title = &amp;caps[<span class="hljs-number">1</span>];
        <span class="hljs-keyword">if</span> title.<span class="hljs-built_in">len</span>() &lt; <span class="hljs-number">20</span> {
            triggers.push(title.to_string());
        }
    }
    
    // æå–åˆ—è¡¨é¡¹ä¸­çš„å…³é”®è¯
    let list_re = Regex::new(<span class="hljs-string">r"^\s*[-*]\s*(.+)$"</span>).unwrap();
    <span class="hljs-keyword">for</span> caps <span class="hljs-keyword">in</span> list_re.captures_iter(content) {
        let item = &amp;caps[<span class="hljs-number">1</span>];
        <span class="hljs-keyword">if</span> item.<span class="hljs-built_in">len</span>() &lt; <span class="hljs-number">30</span> {
            triggers.push(item.to_string());
        }
    }
    
    triggers.dedup();
    triggers
}

/// ç”Ÿæˆç²¾ç®€ç‰ˆ Promptï¼ˆToken ä¼˜åŒ–ï¼‰
fn compact_prompt(full_prompt: &amp;<span class="hljs-built_in">str</span>) -&gt; String {
    // ç§»é™¤å¤šä½™çš„ç©ºè¡Œ
    let compressed = Regex::new(<span class="hljs-string">r"\n{3,}"</span>)
        .unwrap()
        .replace_all(full_prompt, <span class="hljs-string">"\n\n"</span>);
    
    // ç§»é™¤æ³¨é‡Š
    let without_comments = Regex::new(<span class="hljs-string">r"&lt;!--.*?--&gt;"</span>)
        .unwrap()
        .replace_all(&amp;compressed, <span class="hljs-string">""</span>);
    
    without_comments.to_string()
}
</code></pre>
<h4 data-id="heading-27">3.7.5 ä½¿ç”¨ç¤ºä¾‹</h4>
<p><strong>å¯¼å…¥ Agent Skills</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å‰ç«¯è°ƒç”¨</span>
<span class="hljs-keyword">const</span> skills = <span class="hljs-keyword">await</span> invoke&lt;<span class="hljs-title class_">Skill</span>[]&gt;(<span class="hljs-string">'import_agent_skills'</span>);

<span class="hljs-comment">// æ˜¾ç¤ºå¯¼å…¥çš„æŠ€èƒ½</span>
skills.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">skill</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å¯¼å…¥æŠ€èƒ½: <span class="hljs-subst">${skill.display_name}</span>`</span>);
});
</code></pre>
<p><strong>å¯¼å‡ºä¸º Agent Skills</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å¯¼å‡ºå•ä¸ªæŠ€èƒ½</span>
<span class="hljs-keyword">const</span> outputPath = <span class="hljs-keyword">await</span> invoke&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">'export_skill_to_file'</span>, {
  <span class="hljs-attr">skill</span>: selectedSkill,
  <span class="hljs-attr">outputDir</span>: <span class="hljs-string">'/path/to/.claude/skills'</span>
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æŠ€èƒ½å·²å¯¼å‡ºåˆ°: <span class="hljs-subst">${outputPath}</span>`</span>);
</code></pre>
<p><strong>è®¾è®¡äº®ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>æ— æŸè½¬æ¢</strong>ï¼šä¿ç•™åŸå§‹æŠ€èƒ½çš„æ‰€æœ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬æè¿°ã€ç¤ºä¾‹ã€å‚è€ƒæ–‡æ¡£</li>
<li><strong>æ™ºèƒ½æ¨æ–­</strong>ï¼šè‡ªåŠ¨æ¨æ–­æŠ€èƒ½åˆ†ç±»ã€è§¦å‘è¯ã€å˜é‡å®šä¹‰</li>
<li><strong>åŠŸèƒ½å¢å¼º</strong>ï¼šå¯¼å…¥çš„æŠ€èƒ½è‡ªåŠ¨è·å¾— Token ä¼˜åŒ–ã€å·¥ä½œæµç¼–æ’ç­‰é«˜çº§åŠŸèƒ½</li>
<li><strong>ç”Ÿæ€äº’é€š</strong>ï¼šç”¨æˆ·å¯ä»¥åœ¨ Claude Codeã€Cursor ç­‰å·¥å…·ä¸­ä½¿ç”¨æ™ºèƒ½å·¥å…·ç®±çš„æŠ€èƒ½</li>
</ol>
<h2 data-id="heading-28">å››ã€å‰ç«¯æ¶æ„è®¾è®¡</h2>
<h3 data-id="heading-29">4.1 çŠ¶æ€ç®¡ç†ï¼šZustand</h3>
<p>é€‰æ‹© Zustand è€Œé Redux çš„åŸå› ï¼š</p>
<ul>
<li>æ›´ç®€æ´çš„ APIï¼Œå­¦ä¹ æˆæœ¬ä½</li>
<li>å†…ç½®æ”¯æŒæŒä¹…åŒ–ã€ä¸­é—´ä»¶</li>
<li>ä¸ React 18 çš„ Concurrent Mode å…¼å®¹æ€§å¥½</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/stores/chatStore.ts</span>

<span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand'</span>;
<span class="hljs-keyword">import</span> { invoke } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tauri-apps/api/core'</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Message</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span> | <span class="hljs-string">'assistant'</span>;
  <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ChatState</span> {
  <span class="hljs-attr">messages</span>: <span class="hljs-title class_">Message</span>[];
  <span class="hljs-attr">isLoading</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">currentConversationId</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
  
  <span class="hljs-comment">// Actions</span>
  <span class="hljs-attr">sendMessage</span>: <span class="hljs-function">(<span class="hljs-params">content: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;;
  <span class="hljs-attr">clearMessages</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-attr">loadConversation</span>: <span class="hljs-function">(<span class="hljs-params">id: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useChatStore = create&lt;<span class="hljs-title class_">ChatState</span>&gt;(<span class="hljs-function">(<span class="hljs-params">set, get</span>) =&gt;</span> ({
  <span class="hljs-attr">messages</span>: [],
  <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">currentConversationId</span>: <span class="hljs-literal">null</span>,
  
  <span class="hljs-attr">sendMessage</span>: <span class="hljs-keyword">async</span> (<span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span>) =&gt; {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">userMessage</span>: <span class="hljs-title class_">Message</span> = {
      <span class="hljs-attr">id</span>: crypto.<span class="hljs-title function_">randomUUID</span>(),
      <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>,
      content,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
    };
    
    <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({
      <span class="hljs-attr">messages</span>: [...state.<span class="hljs-property">messages</span>, userMessage],
      <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">true</span>,
    }));
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è°ƒç”¨ Tauri åç«¯</span>
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> invoke&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">'send_message'</span>, {
        <span class="hljs-attr">conversationId</span>: <span class="hljs-title function_">get</span>().<span class="hljs-property">currentConversationId</span>,
        content,
      });
      
      <span class="hljs-keyword">const</span> <span class="hljs-attr">assistantMessage</span>: <span class="hljs-title class_">Message</span> = {
        <span class="hljs-attr">id</span>: crypto.<span class="hljs-title function_">randomUUID</span>(),
        <span class="hljs-attr">role</span>: <span class="hljs-string">'assistant'</span>,
        <span class="hljs-attr">content</span>: response,
        <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
      };
      
      <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({
        <span class="hljs-attr">messages</span>: [...state.<span class="hljs-property">messages</span>, assistantMessage],
        <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">false</span>,
      }));
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å‘é€å¤±è´¥:'</span>, error);
      <span class="hljs-title function_">set</span>({ <span class="hljs-attr">isLoading</span>: <span class="hljs-literal">false</span> });
    }
  },
  
  <span class="hljs-attr">clearMessages</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>({ <span class="hljs-attr">messages</span>: [] }),
  
  <span class="hljs-attr">loadConversation</span>: <span class="hljs-keyword">async</span> (<span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>) =&gt; {
    <span class="hljs-keyword">const</span> history = <span class="hljs-keyword">await</span> invoke&lt;<span class="hljs-title class_">Message</span>[]&gt;(<span class="hljs-string">'get_history'</span>, { id });
    <span class="hljs-title function_">set</span>({
      <span class="hljs-attr">currentConversationId</span>: id,
      <span class="hljs-attr">messages</span>: history,
    });
  },
}));
</code></pre>
<h3 data-id="heading-30">4.2 æŠ€èƒ½ç”Ÿæˆå‘å¯¼ UI</h3>
<p>è¿™æ˜¯ä¸€ä¸ªå¤æ‚çš„å¤šæ­¥éª¤è¡¨å•ï¼Œä½¿ç”¨Â <strong>State Machine (çŠ¶æ€æœº)</strong> Â æ€æƒ³ç®¡ç† UI çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// src/components/wizard/SkillWizardDialog.tsx

type <span class="hljs-attr">WizardStage</span> =
  | 'idle'          // åˆå§‹çŠ¶æ€
  | 'parsing'       // è§£æéœ€æ±‚
  | 'collecting'    // æ”¶é›†ä¿¡æ¯ï¼ˆå¤šè½®å¯¹è¯ï¼‰
  | 'generating'    // ç”Ÿæˆ DSL
  | 'preview'       // é¢„è§ˆç¡®è®¤
  | 'saving'<span class="hljs-comment">;       // ä¿å­˜ä¸­</span>

const SkillWizardDialog: React.FC&lt;Props&gt; = ({ open, onOpenChange }) =&gt; {
  const <span class="hljs-section">[stage, setStage]</span> = useState&lt;WizardStage&gt;('idle')<span class="hljs-comment">;</span>
  const <span class="hljs-section">[messages, setMessages]</span> = useState&lt;ChatMessage<span class="hljs-section">[]</span>&gt;(<span class="hljs-section">[]</span>)<span class="hljs-comment">;</span>
  const <span class="hljs-section">[generatedSkill, setGeneratedSkill]</span> = useState&lt;Skill | null&gt;(null)<span class="hljs-comment">;</span>
  
  const <span class="hljs-attr">handleStart</span> = async (description: string) =&gt; {
    setStage('parsing')<span class="hljs-comment">;</span>
    
    try {
      // å¼€å§‹è§£æéœ€æ±‚
      const <span class="hljs-attr">result</span> = await invoke&lt;WizardResult&gt;(<span class="hljs-string">'start_skill_wizard'</span>, {
        description,
      })<span class="hljs-comment">;</span>
      
      if (result.needs_more_info) {
        setMessages(result.messages)<span class="hljs-comment">;</span>
        setStage('collecting')<span class="hljs-comment">;</span>
      } else {
        setGeneratedSkill(result.skill)<span class="hljs-comment">;</span>
        setStage('preview')<span class="hljs-comment">;</span>
      }
    } catch (error) {
      console.error('è§£æå¤±è´¥:', error)<span class="hljs-comment">;</span>
      setStage('idle')<span class="hljs-comment">;</span>
    }
  }<span class="hljs-comment">;</span>
  
  const <span class="hljs-attr">handleReply</span> = async (reply: string) =&gt; {
    const <span class="hljs-attr">newMessage</span> = { role: <span class="hljs-string">'user'</span>, content: reply }<span class="hljs-comment">;</span>
    setMessages(<span class="hljs-section">[...messages, newMessage]</span>)<span class="hljs-comment">;</span>
    
    const <span class="hljs-attr">result</span> = await invoke&lt;WizardResult&gt;(<span class="hljs-string">'continue_skill_wizard'</span>, {
      reply,
    })<span class="hljs-comment">;</span>
    
    if (result.completed) {
      setGeneratedSkill(result.skill)<span class="hljs-comment">;</span>
      setStage('preview')<span class="hljs-comment">;</span>
    } else {
      setMessages(<span class="hljs-section">[...messages, newMessage, result.next_question]</span>)<span class="hljs-comment">;</span>
    }
  }<span class="hljs-comment">;</span>
  
  const <span class="hljs-attr">handleSave</span> = async () =&gt; {
    if (!generatedSkill) return<span class="hljs-comment">;</span>
    
    setStage('saving')<span class="hljs-comment">;</span>
    await invoke('save_skill', { skill: generatedSkill })<span class="hljs-comment">;</span>
    onOpenChange(false)<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
  
  // æ¸²æŸ“ä¸åŒé˜¶æ®µçš„å†…å®¹
  const <span class="hljs-attr">renderContent</span> = () =&gt; {
    switch (stage) {
      case 'idle':
        return (
          &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"space-y-4"</span>&gt;
            &lt;p <span class="hljs-attr">className</span>=<span class="hljs-string">"text-muted-foreground"</span>&gt;
              æè¿°ä½ æƒ³è¦åˆ›å»ºçš„æŠ€èƒ½ï¼Œæˆ‘ä¼šå¸®ä½ ç”Ÿæˆé…ç½®
            &lt;/p&gt;
            &lt;textarea
              <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"ä¾‹å¦‚ï¼šå¸®æˆ‘å†™ä¸€ä¸ªå¯ä»¥ç”Ÿæˆå‘¨æŠ¥çš„æŠ€èƒ½..."</span>
              <span class="hljs-attr">className</span>=<span class="hljs-string">"w-full h-32 p-3 border rounded-lg"</span>
              <span class="hljs-attr">onKeyDown</span>={(e) =&gt; {
                if (<span class="hljs-attr">e.key</span> === <span class="hljs-string">'Enter'</span> &amp;&amp; e.metaKey) {
                  handleStart(e.currentTarget.value)<span class="hljs-comment">;</span>
                }
              }}
            /&gt;
          &lt;/div&gt;
        )<span class="hljs-comment">;</span>
      
      case 'parsing':
      case 'generating':
        return (
          &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"flex items-center justify-center py-8"</span>&gt;
            &lt;Loader2 <span class="hljs-attr">className</span>=<span class="hljs-string">"h-8 w-8 animate-spin"</span> /&gt;
            &lt;span <span class="hljs-attr">className</span>=<span class="hljs-string">"ml-2"</span>&gt;
              {<span class="hljs-attr">stage</span> === <span class="hljs-string">'parsing'</span> ? <span class="hljs-string">'æ­£åœ¨è§£æéœ€æ±‚...'</span> : <span class="hljs-string">'æ­£åœ¨ç”ŸæˆæŠ€èƒ½...'</span>}
            &lt;/span&gt;
          &lt;/div&gt;
        )<span class="hljs-comment">;</span>
      
      case 'collecting':
        return (
          &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"space-y-4"</span>&gt;
            {messages.map((msg, i) =&gt; (
              &lt;div <span class="hljs-attr">key</span>={i} className={`p-<span class="hljs-number">3</span> rounded-lg ${
                <span class="hljs-attr">msg.role</span> === <span class="hljs-string">'assistant'</span> ? <span class="hljs-string">'bg-muted'</span> : <span class="hljs-string">'bg-primary/10'</span>
              }`}&gt;
                {msg.content}
              &lt;/div&gt;
            ))}
            &lt;input
              <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
              <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¾“å…¥å›å¤..."</span>
              <span class="hljs-attr">className</span>=<span class="hljs-string">"w-full p-3 border rounded-lg"</span>
              <span class="hljs-attr">onKeyDown</span>={(e) =&gt; {
                if (<span class="hljs-attr">e.key</span> === <span class="hljs-string">'Enter'</span>) {
                  handleReply(e.currentTarget.value)<span class="hljs-comment">;</span>
                  <span class="hljs-attr">e.currentTarget.value</span> = <span class="hljs-string">''</span><span class="hljs-comment">;</span>
                }
              }}
            /&gt;
          &lt;/div&gt;
        )<span class="hljs-comment">;</span>
      
      case 'preview':
        return (
          &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"space-y-4"</span>&gt;
            &lt;SkillPreviewCard <span class="hljs-attr">skill</span>={generatedSkill!} /&gt;
            &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"flex gap-2 justify-end"</span>&gt;
              &lt;Button <span class="hljs-attr">variant</span>=<span class="hljs-string">"outline"</span> <span class="hljs-literal">on</span>Click={() =&gt; setStage(<span class="hljs-string">'idle'</span>)}&gt;
                é‡æ–°ç”Ÿæˆ
              &lt;/Button&gt;
              &lt;Button <span class="hljs-attr">onClick</span>={handleSave}&gt;
                ä¿å­˜æŠ€èƒ½
              &lt;/Button&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        )<span class="hljs-comment">;</span>
      
      default:
        return null<span class="hljs-comment">;</span>
    }
  }<span class="hljs-comment">;</span>
  
  return (
    &lt;Dialog <span class="hljs-attr">open</span>={open} <span class="hljs-literal">on</span>OpenChange={<span class="hljs-literal">on</span>OpenChange}&gt;
      &lt;DialogContent <span class="hljs-attr">className</span>=<span class="hljs-string">"sm:max-w-[600px]"</span>&gt;
        &lt;DialogHeader&gt;
          &lt;DialogTitle&gt;âœ¨ åˆ›å»ºæ–°æŠ€èƒ½&lt;/DialogTitle&gt;
        &lt;/DialogHeader&gt;
        &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"py-4"</span>&gt;
          {renderContent()}
        &lt;/div&gt;
      &lt;/DialogContent&gt;
    &lt;/Dialog&gt;
  )<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<h2 data-id="heading-31">äº”ã€æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-32">5.1 å¯åŠ¨é€Ÿåº¦ä¼˜åŒ–</h3>
<ol>
<li>
<p><strong>Lazy Loading (æ‡’åŠ è½½)</strong> ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨ React.lazy åŠ¨æ€åŠ è½½éé¦–å±è·¯ç”±</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">SkillsPage</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./pages/SkillsPage'</span>));
<span class="hljs-keyword">const</span> <span class="hljs-title class_">WorkflowPage</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./pages/WorkflowPage'</span>));
<span class="hljs-keyword">const</span> <span class="hljs-title class_">SettingsPage</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./pages/SettingsPage'</span>));

<span class="hljs-comment">// åœ¨è·¯ç”±ä¸­ä½¿ç”¨ Suspense åŒ…è£¹</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">LoadingSpinner</span> /&gt;</span>}&gt;
  <span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/skills"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">SkillsPage</span> /&gt;</span>} /&gt;
  <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
</code></pre>
</li>
<li>
<p><strong>æ•°æ®åº“é¢„çƒ­</strong>ï¼š</p>
<ul>
<li>åœ¨ splash screen æ˜¾ç¤ºæœŸé—´åˆå§‹åŒ– SQLite è¿æ¥æ± </li>
<li>é¢„åŠ è½½å¸¸ç”¨é…ç½®æ•°æ®åˆ°å†…å­˜ç¼“å­˜</li>
</ul>
</li>
<li>
<p><strong>Rust ç¼–è¯‘ä¼˜åŒ–</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Cargo.toml</span>
<span class="hljs-section">[profile.release]</span>
<span class="hljs-attr">lto</span> = <span class="hljs-literal">true</span>        <span class="hljs-comment"># Link Time Optimization</span>
<span class="hljs-attr">codegen-units</span> = <span class="hljs-number">1</span> <span class="hljs-comment"># å•ä»£ç ç”Ÿæˆå•å…ƒï¼Œæ›´å¥½ä¼˜åŒ–</span>
<span class="hljs-attr">strip</span> = <span class="hljs-literal">true</span>      <span class="hljs-comment"># å»é™¤è°ƒè¯•ç¬¦å·</span>
</code></pre>
</li>
</ol>
<h3 data-id="heading-33">5.2 å†…å­˜å ç”¨ä¼˜åŒ–</h3>
<ol>
<li>
<p><strong>Rust ä¾§</strong>ï¼š</p>
<ul>
<li>é¿å…åœ¨å†…å­˜ä¸­ç¼“å­˜å¤§æ–‡ä»¶å†…å®¹</li>
<li>ä½¿ç”¨æµå¼å¤„ç† (Stream) æ›¿ä»£ä¸€æ¬¡æ€§åŠ è½½</li>
<li>åŠæ—¶é‡Šæ”¾ä¸å†ä½¿ç”¨çš„ LLM ä¸Šä¸‹æ–‡</li>
</ul>
</li>
<li>
<p><strong>Webview ä¾§</strong>ï¼š</p>
<ul>
<li>è™šæ‹Ÿåˆ—è¡¨ (Virtual List) æ¸²æŸ“é•¿å¯¹è¯å†å²</li>
<li>å®šæœŸæ¸…ç† DOM ä¸­çš„ Markdown æ¸²æŸ“ç»“æœ</li>
</ul>
</li>
</ol>
<h3 data-id="heading-34">5.3 å®‰å…¨æœ€ä½³å®è·µ</h3>
<ol>
<li>
<p><strong>CSP é…ç½®</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// tauri.conf.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"security"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"csp"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
<li>
<p><strong>å‘½ä»¤ç™½åå•</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// capabilities/default.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"permissions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"core:default"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"identifier"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"shell:allow-open"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"allow"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span> <span class="hljs-attr">"path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://*"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
<li>
<p><strong>API Key å®‰å…¨</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ AES-256-GCM åŠ å¯†å­˜å‚¨</li>
<li>å¯†é’¥ä»è®¾å¤‡æŒ‡çº¹æ´¾ç”Ÿï¼Œä¸æ˜æ–‡ä¿å­˜</li>
<li>å®šæœŸæé†’ç”¨æˆ·æ›´æ¢æ³„éœ²çš„ Key</li>
</ul>
</li>
</ol>
<h3 data-id="heading-35">5.4 å®‰å…¨è®¾è®¡ç»†èŠ‚</h3>
<h4 data-id="heading-36">5.4.1 API Key åŠ å¯†å­˜å‚¨å®ç°</h4>
<p>API Key ä½œä¸ºæ•æ„Ÿä¿¡æ¯ï¼Œé‡‡ç”¨äº†å¤šå±‚å®‰å…¨ä¿æŠ¤æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/services/crypto.rs</span>

<span class="hljs-keyword">use</span> aes_gcm::{Aes256Gcm, Key, Nonce};
<span class="hljs-keyword">use</span> aes_gcm::aead::{Aead, NewAead};
<span class="hljs-keyword">use</span> pbkdf2::pbkdf2;
<span class="hljs-keyword">use</span> hmac::Hmac;
<span class="hljs-keyword">use</span> sha2::Sha256;

<span class="hljs-comment">/// åŠ å¯†æœåŠ¡</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">CryptoService</span> {
    key: Key&lt;Aes256Gcm&gt;,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">CryptoService</span> {
    <span class="hljs-comment">/// ä»è®¾å¤‡æŒ‡çº¹æ´¾ç”Ÿå¯†é’¥</span>
    <span class="hljs-comment">/// ç»“åˆä¸»æœºåã€ç”¨æˆ·åå’Œæœºå™¨å”¯ä¸€IDç”Ÿæˆè®¾å¤‡æŒ‡çº¹</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">from_device_fingerprint</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">Self</span>, AppError&gt; {
        <span class="hljs-comment">// ç»„åˆå¤šä¸ªè®¾å¤‡ç‰¹å¾ç”Ÿæˆå”¯ä¸€æŒ‡çº¹</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">hostname</span> = whoami::<span class="hljs-title function_ invoke__">hostname</span>();
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">username</span> = whoami::<span class="hljs-title function_ invoke__">username</span>();
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">machine_id</span> = machine_uid::<span class="hljs-title function_ invoke__">get</span>()
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"è·å–æœºå™¨IDå¤±è´¥: {}"</span>, e)))?;
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">fingerprint</span> = <span class="hljs-built_in">format!</span>(<span class="hljs-string">"{}-{}-{}"</span>, hostname, username, machine_id);
        
        <span class="hljs-comment">// ä½¿ç”¨ PBKDF2 æ´¾ç”Ÿ 256 ä½å¯†é’¥</span>
        <span class="hljs-comment">// 100,000 æ¬¡è¿­ä»£ï¼Œå¢åŠ æš´åŠ›ç ´è§£éš¾åº¦</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">salt</span> = <span class="hljs-string">b"smart-toolbox-salt-2024"</span>;
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">key</span> = [<span class="hljs-number">0u8</span>; <span class="hljs-number">32</span>];
        pbkdf2::&lt;Hmac&lt;Sha256&gt;&gt;(
            fingerprint.<span class="hljs-title function_ invoke__">as_bytes</span>(),
            salt,
            <span class="hljs-number">100_000</span>,
            &amp;<span class="hljs-keyword">mut</span> key,
        );
        
        <span class="hljs-title function_ invoke__">Ok</span>(<span class="hljs-keyword">Self</span> { key: Key::<span class="hljs-title function_ invoke__">from_slice</span>(&amp;key).<span class="hljs-title function_ invoke__">clone</span>() })
    }
    
    <span class="hljs-comment">/// åŠ å¯† API Key</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">encrypt</span>(&amp;<span class="hljs-keyword">self</span>, plaintext: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">cipher</span> = Aes256Gcm::<span class="hljs-title function_ invoke__">new</span>(&amp;<span class="hljs-keyword">self</span>.key);
        <span class="hljs-comment">// æ³¨æ„ï¼šå®é™…åº”ç”¨ä¸­åº”ä½¿ç”¨éšæœº nonce</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">nonce</span> = Nonce::<span class="hljs-title function_ invoke__">from_slice</span>(<span class="hljs-string">b"unique nonce"</span>);
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ciphertext</span> = cipher.<span class="hljs-title function_ invoke__">encrypt</span>(nonce, plaintext.<span class="hljs-title function_ invoke__">as_bytes</span>())
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"åŠ å¯†å¤±è´¥: {}"</span>, e)))?;
        
        <span class="hljs-comment">// Base64 ç¼–ç ä¾¿äºå­˜å‚¨</span>
        <span class="hljs-title function_ invoke__">Ok</span>(base64::<span class="hljs-title function_ invoke__">encode</span>(&amp;ciphertext))
    }
    
    <span class="hljs-comment">/// è§£å¯† API Key</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">decrypt</span>(&amp;<span class="hljs-keyword">self</span>, ciphertext: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">cipher</span> = Aes256Gcm::<span class="hljs-title function_ invoke__">new</span>(&amp;<span class="hljs-keyword">self</span>.key);
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">nonce</span> = Nonce::<span class="hljs-title function_ invoke__">from_slice</span>(<span class="hljs-string">b"unique nonce"</span>);
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ciphertext_bytes</span> = base64::<span class="hljs-title function_ invoke__">decode</span>(ciphertext)
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"Base64 è§£ç å¤±è´¥: {}"</span>, e)))?;
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">plaintext</span> = cipher.<span class="hljs-title function_ invoke__">decrypt</span>(nonce, ciphertext_bytes.<span class="hljs-title function_ invoke__">as_ref</span>())
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"è§£å¯†å¤±è´¥: {}"</span>, e)))?;
        
        <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from_utf8</span>(plaintext)
            .<span class="hljs-title function_ invoke__">map_err</span>(|e| AppError::<span class="hljs-title function_ invoke__">Crypto</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"UTF-8 è§£ç å¤±è´¥: {}"</span>, e)))
    }
}
</code></pre>
<p><strong>å®‰å…¨ç‰¹æ€§</strong>ï¼š</p>
<ol>
<li><strong>è®¾å¤‡ç»‘å®š</strong>ï¼šå¯†é’¥ä¸è®¾å¤‡ç¡¬ä»¶ä¿¡æ¯ç»‘å®šï¼Œå³ä½¿æ•°æ®åº“æ³„éœ²ä¹Ÿæ— æ³•åœ¨å…¶ä»–è®¾å¤‡ä¸Šè§£å¯†</li>
<li><strong>PBKDF2 åŠ å¯†</strong>ï¼š100,000 æ¬¡è¿­ä»£å¢åŠ æš´åŠ›ç ´è§£éš¾åº¦</li>
<li><strong>AES-256-GCM</strong>ï¼šå·¥ä¸šçº§åŠ å¯†ç®—æ³•ï¼Œæä¾›æœºå¯†æ€§å’Œå®Œæ•´æ€§ä¿æŠ¤</li>
</ol>
<h4 data-id="heading-37">5.4.2 æƒé™æ§åˆ¶æœºåˆ¶</h4>
<p>åŸºäº Tauri 2.x çš„æƒé™ç³»ç»Ÿå®ç°æœ€å°æƒé™åŸåˆ™ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// capabilities/default.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"identifier"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"smart-toolbox-core"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ ¸å¿ƒåŠŸèƒ½æƒé™"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"windows"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"main"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"permissions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"core:default"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"shell:allow-open"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"fs:read-all"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"fs:write-all"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"identifier"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http:default"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"allow"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">{</span> <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://api.openai.com/*"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-punctuation">{</span> <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://api.anthropic.com/*"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-punctuation">{</span> <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://api.deepseek.com/*"</span> <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>æƒé™æ§åˆ¶ç­–ç•¥</strong>ï¼š</p>
<ol>
<li><strong>æœ€å°æƒé™åŸåˆ™</strong>ï¼šåªæˆäºˆåº”ç”¨å¿…éœ€çš„æƒé™</li>
<li><strong>URL ç™½åå•</strong>ï¼šé™åˆ¶ HTTP è¯·æ±‚åªèƒ½å‘é€åˆ°æŒ‡å®šçš„ API ç«¯ç‚¹</li>
<li><strong>çª—å£éš”ç¦»</strong>ï¼šé™åˆ¶åŠŸèƒ½åªèƒ½åœ¨ä¸»çª—å£ä¸­ä½¿ç”¨</li>
</ol>
<h4 data-id="heading-38">5.4.3 å‘½ä»¤ç™½åå•æœºåˆ¶</h4>
<p>æ‰€æœ‰ Tauri å‘½ä»¤éƒ½ç»è¿‡ä¸¥æ ¼éªŒè¯ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/commands/mod.rs</span>

<span class="hljs-comment">/// å®‰å…¨çš„å‘½ä»¤è°ƒç”¨ç¤ºä¾‹</span>
<span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">send_message</span>(
    app: tauri::AppHandle,
    state: tauri::State&lt;<span class="hljs-symbol">'_</span>, AppState&gt;,
    conversation_id: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">String</span>&gt;,
    content: <span class="hljs-type">String</span>,
) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, AppError&gt; {
    <span class="hljs-comment">// è¾“å…¥éªŒè¯</span>
    <span class="hljs-keyword">if</span> content.<span class="hljs-title function_ invoke__">trim</span>().<span class="hljs-title function_ invoke__">is_empty</span>() {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Err</span>(AppError::<span class="hljs-title function_ invoke__">InvalidInput</span>(<span class="hljs-string">"æ¶ˆæ¯å†…å®¹ä¸èƒ½ä¸ºç©º"</span>.<span class="hljs-title function_ invoke__">to_string</span>()));
    }
    
    <span class="hljs-comment">// é•¿åº¦é™åˆ¶</span>
    <span class="hljs-keyword">if</span> content.<span class="hljs-title function_ invoke__">len</span>() &gt; <span class="hljs-number">10000</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Err</span>(AppError::<span class="hljs-title function_ invoke__">InvalidInput</span>(<span class="hljs-string">"æ¶ˆæ¯å†…å®¹è¿‡é•¿"</span>.<span class="hljs-title function_ invoke__">to_string</span>()));
    }
    
    <span class="hljs-comment">// æƒé™æ£€æŸ¥</span>
    <span class="hljs-keyword">if</span> !state.<span class="hljs-title function_ invoke__">is_user_authenticated</span>().<span class="hljs-keyword">await</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Err</span>(AppError::<span class="hljs-title function_ invoke__">Unauthorized</span>(<span class="hljs-string">"ç”¨æˆ·æœªè®¤è¯"</span>.<span class="hljs-title function_ invoke__">to_string</span>()));
    }
    
    <span class="hljs-comment">// è°ƒç”¨æ ¸å¿ƒæœåŠ¡</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span> = state.chat_service.<span class="hljs-title function_ invoke__">send_message</span>(conversation_id, content).<span class="hljs-keyword">await</span>?;
    <span class="hljs-title function_ invoke__">Ok</span>(result)
}
</code></pre>
<p><strong>å®‰å…¨æ£€æŸ¥ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>è¾“å…¥éªŒè¯</strong>ï¼šæ£€æŸ¥å‚æ•°åˆæ³•æ€§</li>
<li><strong>é•¿åº¦é™åˆ¶</strong>ï¼šé˜²æ­¢ç¼“å†²åŒºæº¢å‡º</li>
<li><strong>æƒé™éªŒè¯</strong>ï¼šç¡®ä¿ç”¨æˆ·å·²è®¤è¯</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šé¿å…æ³„éœ²æ•æ„Ÿä¿¡æ¯</li>
</ol>
<h2 data-id="heading-39">å…­ã€Tauri vs Electronï¼šå¼€å‘ä½“éªŒæ·±åº¦å¯¹æ¯”</h2>
<p>ä½œä¸ºä¸€ä¸ªæœ‰è¿‡ Electron å¼€å‘ç»éªŒçš„å¼€å‘è€…ï¼Œåœ¨å®Œæˆæ™ºèƒ½å·¥å…·ç®±çš„å¼€å‘åï¼Œæˆ‘æƒ³ä»å¤šä¸ªç»´åº¦å¯¹æ¯”ä¸€ä¸‹ Tauri å’Œ Electron çš„å¼€å‘ä½“éªŒã€‚</p>
<h3 data-id="heading-40">6.1 å¼€å‘ç¯å¢ƒæ­å»º</h3>






























<table><thead><tr><th>ç»´åº¦</th><th>Electron</th><th>Tauri</th></tr></thead><tbody><tr><td><strong>å‰ç½®ä¾èµ–</strong></td><td>Node.js + npm/yarn</td><td>Node.js + Rust + Cargo + ç³»ç»Ÿä¾èµ–</td></tr><tr><td><strong>å®‰è£…å¤æ‚åº¦</strong></td><td>â­ ç®€å•</td><td>â­â­â­ ä¸­ç­‰ï¼ˆéœ€è¦é…ç½® Rust ç¯å¢ƒï¼‰</td></tr><tr><td><strong>é¦–æ¬¡å¯åŠ¨</strong></td><td>1-2 åˆ†é’Ÿ</td><td>3-5 åˆ†é’Ÿï¼ˆé¦–æ¬¡ç¼–è¯‘ Rustï¼‰</td></tr><tr><td><strong>çƒ­æ›´æ–°é€Ÿåº¦</strong></td><td>â­â­â­â­â­ æå¿«</td><td>â­â­â­â­ å¿«ï¼ˆå‰ç«¯çƒ­æ›´æ–°ï¼ŒRust éœ€é‡æ–°ç¼–è¯‘ï¼‰</td></tr></tbody></table>
<p><strong>ä¸ªäººæ„Ÿå—</strong>ï¼š</p>
<ul>
<li>Electron çš„ç¯å¢ƒæ­å»ºå‡ ä¹æ˜¯é›¶é—¨æ§›ï¼Œåªè¦ä¼š Node.js å°±èƒ½ä¸Šæ‰‹</li>
<li>Tauri éœ€è¦å®‰è£… Rust å·¥å…·é“¾ï¼Œå¯¹äºæ²¡æœ‰ Rust ç»éªŒçš„å¼€å‘è€…æ¥è¯´æœ‰ä¸€å®šå­¦ä¹ æˆæœ¬</li>
<li>ä½† Tauri çš„Â <code>cargo tauri dev</code>Â å‘½ä»¤ä¼šè‡ªåŠ¨å¤„ç†å¤§éƒ¨åˆ†é…ç½®ï¼Œå®é™…ä½“éªŒæ¯”é¢„æœŸå¥½å¾ˆå¤š</li>
</ul>
<h3 data-id="heading-41">6.2 å‰ç«¯å¼€å‘ä½“éªŒ</h3>
<p><strong>ç›¸ä¼¼ä¹‹å¤„</strong>ï¼š</p>
<ul>
<li>ä¸¤è€…éƒ½ä½¿ç”¨ Web æŠ€æœ¯æ ˆï¼ˆHTML/CSS/JavaScriptï¼‰</li>
<li>éƒ½å¯ä»¥ä½¿ç”¨ Reactã€Vueã€Angular ç­‰ç°ä»£å‰ç«¯æ¡†æ¶</li>
<li>éƒ½æ”¯æŒçƒ­æ›´æ–°ï¼ˆHMRï¼‰</li>
</ul>
<p><strong>å·®å¼‚ä¹‹å¤„</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Electron: ä½¿ç”¨ IPC é€šä¿¡</span>
<span class="hljs-keyword">const</span> { ipcRenderer } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'electron'</span>);

<span class="hljs-comment">// å‘é€æ¶ˆæ¯</span>
ipcRenderer.<span class="hljs-title function_">send</span>(<span class="hljs-string">'message'</span>, { <span class="hljs-attr">data</span>: <span class="hljs-string">'hello'</span> });

<span class="hljs-comment">// ç›‘å¬æ¶ˆæ¯</span>
ipcRenderer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'reply'</span>, <span class="hljs-function">(<span class="hljs-params">event, result</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result);
});
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Tauri: ä½¿ç”¨ invoke API</span>
<span class="hljs-keyword">import</span> { invoke } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tauri-apps/api/core'</span>;

<span class="hljs-comment">// è°ƒç”¨å‘½ä»¤ï¼ˆè¿”å› Promiseï¼‰</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">invoke</span>(<span class="hljs-string">'get_data'</span>, { <span class="hljs-attr">id</span>: <span class="hljs-number">123</span> });

<span class="hljs-comment">// ç›‘å¬äº‹ä»¶</span>
<span class="hljs-keyword">import</span> { listen } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tauri-apps/api/event'</span>;
<span class="hljs-keyword">const</span> unlisten = <span class="hljs-keyword">await</span> <span class="hljs-title function_">listen</span>(<span class="hljs-string">'event-name'</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(event.<span class="hljs-property">payload</span>);
});
</code></pre>
<p><strong>ä¸ªäººæ„Ÿå—</strong>ï¼š</p>
<ul>
<li>Tauri çš„Â <code>invoke</code>Â API æ›´åŠ ç°ä»£åŒ–ï¼ŒåŸºäº Promiseï¼Œä¸ async/await é…åˆæ›´è‡ªç„¶</li>
<li>Electron çš„ IPC äº‹ä»¶æ¨¡å‹æ›´çµæ´»ï¼Œä½†éœ€è¦æ‰‹åŠ¨ç®¡ç†äº‹ä»¶ç›‘å¬å™¨</li>
<li>Tauri çš„ç±»å‹å®‰å…¨æ›´å¥½ï¼ˆé…åˆ TypeScriptï¼‰ï¼Œå¯ä»¥åœ¨ç¼–è¯‘æ—¶å‘ç°é”™è¯¯</li>
</ul>
<h3 data-id="heading-42">6.3 åç«¯å¼€å‘ä½“éªŒ</h3>
<p>è¿™æ˜¯ä¸¤è€…å·®å¼‚æœ€å¤§çš„åœ°æ–¹ï¼š</p>
<p><strong>Electron (Node.js)</strong> ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">const</span> { ipcMain } = require(<span class="hljs-string">'electron'</span>);

ipcMain.handle(<span class="hljs-string">'read-file'</span>, async (event, filePath) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-keyword">data</span> = await fs.promises.readFile(filePath, <span class="hljs-string">'utf-8'</span>);
    <span class="hljs-keyword">return</span> { success: <span class="hljs-literal">true</span>, <span class="hljs-keyword">data</span> };
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-keyword">return</span> { success: <span class="hljs-literal">false</span>, error: error.message };
  }
});
</code></pre>
<p><strong>Tauri (Rust)</strong> ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// commands.rs</span>
<span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">read_file</span>(path: <span class="hljs-type">String</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, <span class="hljs-type">String</span>&gt; {
    tokio::fs::<span class="hljs-title function_ invoke__">read_to_string</span>(&amp;path)
        .<span class="hljs-keyword">await</span>
        .<span class="hljs-title function_ invoke__">map_err</span>(|e| e.<span class="hljs-title function_ invoke__">to_string</span>())
}
</code></pre>
<p><strong>å¯¹æ¯”åˆ†æ</strong>ï¼š</p>








































<table><thead><tr><th>ç»´åº¦</th><th>Electron (Node.js)</th><th>Tauri (Rust)</th></tr></thead><tbody><tr><td><strong>ç±»å‹å®‰å…¨</strong></td><td>â­â­ å¼±ç±»å‹ï¼Œè¿è¡Œæ—¶é”™è¯¯</td><td>â­â­â­â­â­ å¼ºç±»å‹ï¼Œç¼–è¯‘æ—¶æ£€æŸ¥</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>â­â­â­ å•çº¿ç¨‹ï¼Œäº‹ä»¶å¾ªç¯</td><td>â­â­â­â­â­ å¤šçº¿ç¨‹ï¼Œé›¶æˆæœ¬æŠ½è±¡</td></tr><tr><td><strong>å†…å­˜å®‰å…¨</strong></td><td>â­â­â­ åƒåœ¾å›æ”¶ï¼Œå¯èƒ½æœ‰æ³„æ¼</td><td>â­â­â­â­â­ æ‰€æœ‰æƒç³»ç»Ÿï¼Œæ— æ³„æ¼</td></tr><tr><td><strong>å­¦ä¹ æ›²çº¿</strong></td><td>â­ ç®€å•ï¼ŒJavaScript åŸºç¡€å³å¯</td><td>â­â­â­â­ éœ€è¦ç†è§£æ‰€æœ‰æƒã€ç”Ÿå‘½å‘¨æœŸ</td></tr><tr><td><strong>å¼€å‘æ•ˆç‡</strong></td><td>â­â­â­â­â­ å¿«é€Ÿè¿­ä»£</td><td>â­â­â­ ç¼–è¯‘æ—¶é—´è¾ƒé•¿ï¼Œä½† bug æ›´å°‘</td></tr><tr><td><strong>ç”Ÿæ€ä¸°å¯Œåº¦</strong></td><td>â­â­â­â­â­ npm ç”Ÿæ€æå…¶ä¸°å¯Œ</td><td>â­â­â­ crates.io ç”Ÿæ€åœ¨å¢é•¿</td></tr></tbody></table>
<p><strong>ä¸ªäººæ„Ÿå—</strong>ï¼š</p>
<ul>
<li><strong>Electron</strong>ï¼šå¼€å‘é€Ÿåº¦å¿«ï¼Œå‡ ä¹ä¸éœ€è¦å­¦ä¹ æ–°ä¸œè¥¿ï¼Œé€‚åˆå¿«é€ŸåŸå‹å¼€å‘</li>
<li><strong>Tauri</strong>ï¼šåˆæœŸå­¦ä¹ æˆæœ¬é«˜ï¼Œä½† Rust çš„ç±»å‹ç³»ç»Ÿè®©ä»£ç æ›´å¥å£®ï¼Œç¼–è¯‘å™¨å°±åƒä¸€ä¸ªä¸¥æ ¼çš„ä»£ç å®¡æŸ¥å‘˜</li>
<li>Rust çš„æ‰€æœ‰æƒæ¨¡å‹ä¸€å¼€å§‹å¾ˆéš¾ç†è§£ï¼Œä½†ä¸€æ—¦æŒæ¡ï¼Œä¼šå‘ç°å®ƒè®©å¹¶å‘ç¼–ç¨‹å˜å¾—ç®€å•å®‰å…¨</li>
</ul>
<h3 data-id="heading-43">6.4 è°ƒè¯•ä½“éªŒ</h3>
<p><strong>Electron</strong>ï¼š</p>
<ul>
<li>Chrome DevTools ç›´æ¥è°ƒè¯•ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹</li>
<li><code>console.log</code>Â éšå¤„å¯ç”¨</li>
<li>æ–­ç‚¹è°ƒè¯•ä½“éªŒä¸ Web å¼€å‘ä¸€è‡´</li>
</ul>
<p><strong>Tauri</strong>ï¼š</p>
<ul>
<li>å‰ç«¯ï¼šChrome DevToolsï¼ˆä¸ Electron ç›¸åŒï¼‰</li>
<li>åç«¯ï¼šéœ€è¦ä½¿ç”¨Â <code>println!</code>Â æˆ–Â <code>dbg!</code>Â å®ï¼Œæˆ–è€…é…ç½® VS Code çš„ Rust æ’ä»¶è¿›è¡Œè°ƒè¯•</li>
<li>æ—¥å¿—æŸ¥çœ‹ï¼šç»ˆç«¯è¾“å‡ºæˆ–ä½¿ç”¨Â <code>env_logger</code>Â ç­‰æ—¥å¿—åº“</li>
</ul>
<p><strong>ä¸ªäººæ„Ÿå—</strong>ï¼š</p>
<ul>
<li>Electron çš„è°ƒè¯•ä½“éªŒæ›´ç»Ÿä¸€ï¼Œå‰åç«¯éƒ½å¯ä»¥ç”¨ DevTools</li>
<li>Tauri çš„ Rust è°ƒè¯•éœ€è¦é¢å¤–é…ç½®ï¼Œä½† Rust çš„é”™è¯¯ä¿¡æ¯éå¸¸è¯¦ç»†ï¼Œç¼–è¯‘å™¨ä¼šç»™å‡ºå¾ˆå¥½çš„æç¤º</li>
<li>å¯¹äºä¹ æƒ¯äº† Web å¼€å‘çš„æˆ‘æ¥è¯´ï¼ŒTauri çš„è°ƒè¯•ä½“éªŒéœ€è¦é€‚åº”</li>
</ul>
<h3 data-id="heading-44">6.5 æ‰“åŒ…ä¸åˆ†å‘</h3>






























<table><thead><tr><th>ç»´åº¦</th><th>Electron</th><th>Tauri</th></tr></thead><tbody><tr><td><strong>åŒ…ä½“ç§¯</strong></td><td>150MB+</td><td>10-20MB</td></tr><tr><td><strong>æ‰“åŒ…æ—¶é—´</strong></td><td>2-5 åˆ†é’Ÿ</td><td>5-10 åˆ†é’Ÿ</td></tr><tr><td><strong>ç­¾åé…ç½®</strong></td><td>ç›¸å¯¹ç®€å•</td><td>éœ€è¦é…ç½®ç³»ç»Ÿç­¾å</td></tr><tr><td><strong>è·¨å¹³å°</strong></td><td>â­â­â­â­â­ éå¸¸æˆç†Ÿ</td><td>â­â­â­â­ æ”¯æŒ Windows/macOS/Linux</td></tr></tbody></table>
<p><strong>ä¸ªäººæ„Ÿå—</strong>ï¼š</p>
<ul>
<li>Tauri çš„åŒ…ä½“ç§¯ä¼˜åŠ¿éå¸¸æ˜æ˜¾ï¼Œç”¨æˆ·ä¸‹è½½ä½“éªŒæ›´å¥½</li>
<li>Electron çš„æ‰“åŒ…å·¥å…·ï¼ˆelectron-builderï¼‰æ›´æˆç†Ÿï¼Œé…ç½®æ›´ç®€å•</li>
<li>Tauri çš„ç­¾åé…ç½®åœ¨ä¸åŒå¹³å°ä¸Šå·®å¼‚è¾ƒå¤§ï¼Œéœ€è¦æŸ¥é˜…æ–‡æ¡£</li>
</ul>
<h3 data-id="heading-45">6.6 ç¤¾åŒºä¸ç”Ÿæ€</h3>
<p><strong>Electron</strong>ï¼š</p>
<ul>
<li>â­â­â­â­â­ æˆç†Ÿç¨³å®šï¼ŒVS Codeã€Slackã€Discord ç­‰çŸ¥ååº”ç”¨éƒ½åœ¨ç”¨</li>
<li>npm ä¸Šæœ‰å¤§é‡ç°æˆçš„åº“å’Œæ’ä»¶</li>
<li>é—®é¢˜è§£å†³æ–¹æ¡ˆä¸°å¯Œï¼ŒStack Overflow ä¸Šæœ‰å¾ˆå¤šç­”æ¡ˆ</li>
</ul>
<p><strong>Tauri</strong>ï¼š</p>
<ul>
<li>â­â­â­ å¿«é€Ÿæˆé•¿ä¸­ï¼Œç¤¾åŒºæ´»è·ƒ</li>
<li>å®˜æ–¹æ–‡æ¡£è´¨é‡é«˜ï¼Œä½†ç¬¬ä¸‰æ–¹èµ„æºç›¸å¯¹è¾ƒå°‘</li>
<li>é‡åˆ°é—®é¢˜æ—¶å¯èƒ½éœ€è¦è‡ªå·±ç ”ç©¶æˆ–æ issue</li>
</ul>
<p><strong>ä¸ªäººæ„Ÿå—</strong>ï¼š</p>
<ul>
<li>Electron çš„ç”Ÿæ€ä¼˜åŠ¿æ— å¯æ›¿ä»£ï¼Œå‡ ä¹ä»»ä½•éœ€æ±‚éƒ½èƒ½æ‰¾åˆ°ç°æˆçš„è§£å†³æ–¹æ¡ˆ</li>
<li>Tauri çš„ç¤¾åŒºè™½ç„¶å¹´è½»ï¼Œä½†éå¸¸å‹å¥½ï¼Œå®˜æ–¹å›¢é˜Ÿå“åº”ç§¯æ</li>
<li>å¯¹äº AI åº”ç”¨è¿™ç§éœ€è¦é«˜æ€§èƒ½çš„åœºæ™¯ï¼ŒTauri çš„ä¼˜åŠ¿æ›´æ˜æ˜¾</li>
</ul>
<h3 data-id="heading-46">6.7 æ€»ç»“ï¼šä»€ä¹ˆæ—¶å€™é€‰æ‹©å“ªä¸ªï¼Ÿ</h3>
<p><strong>é€‰æ‹© Electronï¼Œå¦‚æœ</strong>ï¼š</p>
<ul>
<li>âœ… å›¢é˜Ÿç†Ÿæ‚‰ JavaScript/TypeScriptï¼Œä¸æƒ³å­¦ä¹ æ–°è¯­è¨€</li>
<li>âœ… éœ€è¦å¿«é€Ÿå¼€å‘åŸå‹ï¼Œæ—¶é—´ç´§è¿«</li>
<li>âœ… åº”ç”¨éœ€è¦å¤§é‡ Node.js ç”Ÿæ€çš„åº“</li>
<li>âœ… åŒ…ä½“ç§¯å’Œå†…å­˜å ç”¨ä¸æ˜¯ä¸»è¦è€ƒè™‘å› ç´ </li>
<li>âœ… éœ€è¦éå¸¸æˆç†Ÿçš„è·¨å¹³å°æ”¯æŒ</li>
</ul>
<p><strong>é€‰æ‹© Tauriï¼Œå¦‚æœ</strong>ï¼š</p>
<ul>
<li>âœ… è¿½æ±‚æè‡´çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ</li>
<li>âœ… åŒ…ä½“ç§¯å’Œå†…å­˜å ç”¨æ˜¯å…³é”®æŒ‡æ ‡</li>
<li>âœ… æ„¿æ„å­¦ä¹  Rustï¼Œäº«å—ç±»å‹å®‰å…¨å¸¦æ¥çš„å¥½å¤„</li>
<li>âœ… åº”ç”¨éœ€è¦å¤„ç†å¤§é‡è®¡ç®—æˆ– I/O æ“ä½œ</li>
<li>âœ… å¯¹å®‰å…¨æ€§æœ‰è¾ƒé«˜è¦æ±‚</li>
<li>âœ… æƒ³è¦å°è¯•æ–°æŠ€æœ¯ï¼Œæ‹“å±•æŠ€æœ¯è¾¹ç•Œ</li>
</ul>
<p><strong>æˆ‘çš„é€‰æ‹©</strong>ï¼š<br/>
å¯¹äºæ™ºèƒ½å·¥å…·ç®±è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘é€‰æ‹©äº† Tauriï¼Œä¸»è¦åŸå› æ˜¯ï¼š</p>
<ol>
<li><strong>æ€§èƒ½éœ€æ±‚</strong>ï¼šAI åº”ç”¨éœ€è¦é¢‘ç¹è°ƒç”¨ LLM APIï¼ŒRust çš„å¼‚æ­¥æ€§èƒ½ä¼˜åŠ¿æ˜æ˜¾</li>
<li><strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼š15MB çš„åŒ…ä½“ç§¯è®©ç”¨æˆ·æ›´å®¹æ˜“æ¥å—</li>
<li><strong>å­¦ä¹ åŠ¨æœº</strong>ï¼šæˆ‘æƒ³å€Ÿæ­¤æœºä¼šå­¦ä¹  Rustï¼Œæ‹“å±•æŠ€æœ¯æ ˆ</li>
<li><strong>å®‰å…¨æ€§</strong>ï¼šAPI Key ç­‰æ•æ„Ÿä¿¡æ¯çš„åŠ å¯†å­˜å‚¨ï¼ŒRust çš„å†…å­˜å®‰å…¨ç‰¹æ€§æ›´è®©äººæ”¾å¿ƒ</li>
</ol>
<p>è™½ç„¶å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸å°‘æŒ‘æˆ˜ï¼Œä½†æ•´ä½“æ¥è¯´ï¼Œè¿™æ˜¯ä¸€æ¬¡éå¸¸å€¼å¾—çš„æŠ€æœ¯æ¢ç´¢ã€‚Rust çš„å­¦ä¹ æ›²çº¿è™½ç„¶é™¡å³­ï¼Œä½†æŒæ¡åçš„æˆå°±æ„Ÿä¹Ÿæ˜¯æ— ä¸ä¼¦æ¯”çš„ã€‚</p>
<h2 data-id="heading-47">ä¸ƒã€è¸©å‘è®°å½•</h2>
<h3 data-id="heading-48">7.1 Tauri 2.x å‡çº§é—®é¢˜</h3>
<p>ä» Tauri 1.x å‡çº§åˆ° 2.x æ—¶é‡åˆ°çš„ä¸»è¦é—®é¢˜ï¼š</p>

























<table><thead><tr><th>é—®é¢˜</th><th>åŸå› </th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td><code>invoke</code>Â å‚æ•°åºåˆ—åŒ–å¤±è´¥</td><td>2.x å¯¹ç±»å‹æ£€æŸ¥æ›´ä¸¥æ ¼</td><td>ç¡®ä¿ Rust ç»“æ„ä½“æ´¾ç”ŸÂ <code>Serialize</code></td></tr><tr><td>å‘½ä»¤æ— æƒé™æ‰§è¡Œ</td><td>æ–°ç‰ˆæƒé™ç³»ç»Ÿ</td><td>é…ç½®Â <code>capabilities/default.json</code></td></tr><tr><td>æ’ä»¶ API å˜åŒ–</td><td>2.x é‡æ„äº†æ’ä»¶æ¥å£</td><td>å‡çº§åˆ°å¯¹åº” 2.x ç‰ˆæœ¬çš„æ’ä»¶</td></tr></tbody></table>
<h3 data-id="heading-49">7.2 å¼‚æ­¥ Rust ä¸ Tauri</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šåœ¨ async ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨åŒæ­¥é”</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">bad_example</span>(state: State&lt;<span class="hljs-symbol">'_</span>, Mutex&lt;AppState&gt;&gt;) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">guard</span> = state.<span class="hljs-title function_ invoke__">lock</span>().<span class="hljs-title function_ invoke__">unwrap</span>(); <span class="hljs-comment">// å¯èƒ½æ­»é”ï¼</span>
    <span class="hljs-title function_ invoke__">some_async_operation</span>().<span class="hljs-keyword">await</span>;      <span class="hljs-comment">// æŒæœ‰é”æ—¶ await</span>
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨ tokio::sync::Mutex</span>
<span class="hljs-keyword">use</span> tokio::sync::Mutex;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">good_example</span>(state: State&lt;<span class="hljs-symbol">'_</span>, Mutex&lt;AppState&gt;&gt;) {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">guard</span> = state.<span class="hljs-title function_ invoke__">lock</span>().<span class="hljs-keyword">await</span>;
    <span class="hljs-title function_ invoke__">some_async_operation</span>().<span class="hljs-keyword">await</span>;
}
</code></pre>
<h3 data-id="heading-50">7.3 æµå¼å“åº”å¤„ç†</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// ä½¿ç”¨ Tauri event å®ç°æµå¼æ¨é€</span>
<span class="hljs-keyword">use</span> tauri::Emitter;

<span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">stream_chat</span>(
    app: tauri::AppHandle,
    message: <span class="hljs-type">String</span>,
) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;(), AppError&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">stream</span> = llm_client.<span class="hljs-title function_ invoke__">chat_stream</span>(message).<span class="hljs-keyword">await</span>?;
    
    <span class="hljs-keyword">while</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(chunk) = stream.<span class="hljs-title function_ invoke__">next</span>().<span class="hljs-keyword">await</span> {
        <span class="hljs-comment">// é€šè¿‡äº‹ä»¶æ¨é€ç»™å‰ç«¯</span>
        app.<span class="hljs-title function_ invoke__">emit</span>(<span class="hljs-string">"chat-chunk"</span>, &amp;chunk)?;
    }
    
    app.<span class="hljs-title function_ invoke__">emit</span>(<span class="hljs-string">"chat-done"</span>, ())?;
    <span class="hljs-title function_ invoke__">Ok</span>(())
}
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å‰ç«¯ç›‘å¬äº‹ä»¶</span>
<span class="hljs-keyword">import</span> { listen } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tauri-apps/api/event'</span>;

<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> unlisten = listen&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">'chat-chunk'</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-title function_">setContent</span>(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + event.<span class="hljs-property">payload</span>);
  });
  
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> { unlisten.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">fn</span> =&gt;</span> <span class="hljs-title function_">fn</span>()); };
}, []);
</code></pre>
<h2 data-id="heading-51">å…«ã€æ€»ç»“ä¸å±•æœ›</h2>
<p>é€šè¿‡Â <strong>Tauri 2.x + Rust + React</strong>Â çš„ç»„åˆï¼Œæˆ‘ä»¬æˆåŠŸæ„å»ºäº†ä¸€ä¸ªè½»é‡çº§ã€é«˜æ€§èƒ½ã€åŠŸèƒ½å¼ºå¤§çš„æ¡Œé¢ AI åŠ©æ‰‹ã€‚</p>
<h3 data-id="heading-52">æŠ€æœ¯æ”¶ç›Š</h3>



































<table><thead><tr><th>ç»´åº¦</th><th>æˆæœ</th><th>å…·ä½“æ•°æ®</th></tr></thead><tbody><tr><td><strong>åŒ…ä½“ç§¯</strong></td><td>15MBï¼Œæ˜¯åŒç­‰åŠŸèƒ½ Electron åº”ç”¨çš„ 1/10</td><td>Tauri: 15MB, Electron: 150MB+</td></tr><tr><td><strong>å†…å­˜å ç”¨</strong></td><td>è¿è¡Œæ—¶çº¦ 80MBï¼Œè¿œä½äº Electron çš„ 300MB+</td><td>Tauri: 80MB, Electron: 300MB+</td></tr><tr><td><strong>å¯åŠ¨æ—¶é—´</strong></td><td>ç§’çº§å¯åŠ¨</td><td>å†·å¯åŠ¨: 1.2s, çƒ­å¯åŠ¨: 0.3s</td></tr><tr><td><strong>å®‰å…¨æ€§</strong></td><td>Rust å†…å­˜å®‰å…¨ + Tauri æœ€å°æƒé™</td><td>0 å®‰å…¨æ¼æ´æŠ¥å‘Š</td></tr><tr><td><strong>å¼€å‘æ•ˆç‡</strong></td><td>React ç”Ÿæ€ + Rust å¼ºç±»å‹ï¼Œbug æ›´å°‘</td><td>ç¼–è¯‘æ—¶æ•è· 90% ä»¥ä¸Šé”™è¯¯</td></tr></tbody></table>
<h3 data-id="heading-53">V2.0 å·²å®ŒæˆåŠŸèƒ½</h3>
<ul>
<li>âœ… å¤šæ¨¡å‹ LLM æ¥å…¥ï¼ˆOpenAI/Claude/DeepSeek/360AI/Ollamaï¼‰</li>
<li>âœ… å¯¹è¯å¼æŠ€èƒ½ç”Ÿæˆå‘å¯¼</li>
<li>âœ… æŠ€èƒ½ç®¡ç†ä¸æ‰§è¡Œï¼ˆPrompt/Script/Workflowï¼‰</li>
<li>âœ… Token ä¼˜åŒ–ï¼ˆPrompt åˆ†çº§ã€ä¼šè¯å¤ç”¨ï¼‰</li>
<li>âœ… å·¥ä½œæµå¯è§†åŒ–ç¼–æ’</li>
<li>âœ… å¹³å°å‘å¸ƒï¼ˆæ˜é‡‘ï¼‰</li>
<li>âœ… Agent Skills å…¼å®¹å±‚ï¼ˆåŒå‘è½¬æ¢ã€ç”Ÿæ€äº’é€šï¼‰</li>
</ul>
<h3 data-id="heading-54">V3.0 è§„åˆ’</h3>
<h4 data-id="heading-55">3.1 æŠ€èƒ½å¸‚åœº</h4>
<p><strong>åŠŸèƒ½æè¿°</strong>ï¼š<br/>
åŸºäº GitHub çš„å»ä¸­å¿ƒåŒ–æŠ€èƒ½å¸‚åœºï¼Œç”¨æˆ·å¯ä»¥åˆ†äº«ã€å‘ç°ã€å®‰è£…ç¤¾åŒºæŠ€èƒ½ã€‚</p>
<p><strong>æŠ€æœ¯æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li><strong>æ•°æ®æº</strong>ï¼šGitHub Issues + GitHub Releases</li>
<li><strong>æŠ€èƒ½ç´¢å¼•</strong>ï¼šä½¿ç”¨ GitHub API æœç´¢å¸¦æœ‰ç‰¹å®šæ ‡ç­¾ï¼ˆå¦‚Â <code>smart-toolbox-skill</code>ï¼‰çš„ä»“åº“</li>
<li><strong>å®‰è£…æœºåˆ¶</strong>ï¼šå…‹éš†ä»“åº“åˆ°æœ¬åœ°æŠ€èƒ½ç›®å½•ï¼Œè§£æ SKILL.md</li>
<li><strong>ç‰ˆæœ¬ç®¡ç†</strong>ï¼šåŸºäº Git tag è¿›è¡Œç‰ˆæœ¬æ§åˆ¶</li>
</ul>
<p><strong>æŠ€æœ¯æŒ‘æˆ˜</strong>ï¼š</p>
<ul>
<li>GitHub API é€Ÿç‡é™åˆ¶ï¼ˆ60 æ¬¡/å°æ—¶æœªè®¤è¯ï¼Œ5000 æ¬¡/å°æ—¶å·²è®¤è¯ï¼‰</li>
<li>æŠ€èƒ½å®‰å…¨æ€§éªŒè¯ï¼ˆé˜²æ­¢æ¶æ„ä»£ç ï¼‰</li>
<li>ç½‘ç»œç¯å¢ƒé—®é¢˜ï¼ˆå›½å†…è®¿é—® GitHub ä¸ç¨³å®šï¼‰</li>
</ul>
<p><strong>ç¼“è§£ç­–ç•¥</strong>ï¼š</p>
<ul>
<li>å®ç°æœ¬åœ°ç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘ API è°ƒç”¨</li>
<li>æŠ€èƒ½æ²™ç®±æ‰§è¡Œï¼Œé™åˆ¶æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒé™</li>
<li>æä¾› Gitee é•œåƒæºä½œä¸ºå¤‡é€‰</li>
</ul>
<h4 data-id="heading-56">3.2 è¿æ¥å™¨ç³»ç»Ÿ</h4>
<p><strong>åŠŸèƒ½æè¿°</strong>ï¼š<br/>
ç»Ÿä¸€çš„å¹³å°æ¥å…¥æ ‡å‡†ï¼Œæ”¯æŒå¿«é€Ÿæ‰©å±•æ–°çš„å‘å¸ƒå¹³å°ã€‚</p>
<p><strong>æŠ€æœ¯æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// è¿æ¥å™¨æ¥å£å®šä¹‰</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">trait</span> <span class="hljs-title class_">PlatformConnector</span> {
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">publish</span>(&amp;<span class="hljs-keyword">self</span>, content: &amp;PublishContent) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;PublishResult&gt;;
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">validate_config</span>(&amp;<span class="hljs-keyword">self</span>, config: &amp;Value) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;()&gt;;
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">get_config_schema</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> ConfigSchema;
}

<span class="hljs-comment">// è¿æ¥å™¨æ³¨å†Œè¡¨</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">ConnectorRegistry</span> {
    connectors: HashMap&lt;<span class="hljs-type">String</span>, <span class="hljs-type">Box</span>&lt;<span class="hljs-keyword">dyn</span> PlatformConnector&gt;&gt;,
}
</code></pre>
<p><strong>æŠ€æœ¯æŒ‘æˆ˜</strong>ï¼š</p>
<ul>
<li>ä¸åŒå¹³å°çš„è®¤è¯æœºåˆ¶å·®å¼‚ï¼ˆOAuthã€API Keyã€Cookieï¼‰</li>
<li>å†…å®¹æ ¼å¼è½¬æ¢ï¼ˆMarkdown â†’ å„å¹³å°å¯Œæ–‡æœ¬ï¼‰</li>
<li>åçˆ¬è™«æœºåˆ¶åº”å¯¹</li>
</ul>
<p><strong>ç¼“è§£ç­–ç•¥</strong>ï¼š</p>
<ul>
<li>æä¾›ç»Ÿä¸€çš„è®¤è¯æŠ½è±¡å±‚</li>
<li>ä½¿ç”¨ HTML è§£æåº“ï¼ˆå¦‚ scraperï¼‰å¤„ç†å¯Œæ–‡æœ¬</li>
<li>å®ç°è¯·æ±‚é™æµå’Œä»£ç†æ± </li>
</ul>
<h4 data-id="heading-57">3.3 æ›´å¤šå¹³å°æ”¯æŒ</h4>
<p><strong>è®¡åˆ’å¹³å°</strong>ï¼š</p>
<ul>
<li>å¾®ä¿¡å…¬ä¼—å·ï¼ˆéœ€è¦ Cookie è®¤è¯ï¼‰</li>
<li>çŸ¥ä¹ä¸“æ ï¼ˆæ”¯æŒ Markdownï¼‰</li>
<li>CSDNï¼ˆAPI æ¥å£ï¼‰</li>
<li>ç®€ä¹¦ï¼ˆMarkdown æ”¯æŒï¼‰</li>
</ul>
<p><strong>æŠ€æœ¯åˆ†æ</strong>ï¼š</p>
<ul>
<li><strong>å¾®ä¿¡å…¬ä¼—å·</strong>ï¼šéš¾åº¦ â­â­â­â­â­ï¼Œéœ€è¦æ¨¡æ‹Ÿç™»å½•ï¼Œåçˆ¬ä¸¥æ ¼</li>
<li><strong>çŸ¥ä¹</strong>ï¼šéš¾åº¦ â­â­â­ï¼Œæœ‰å®˜æ–¹ APIï¼Œä½†éœ€è¦å¤„ç†éªŒè¯ç </li>
<li><strong>CSDN</strong>ï¼šéš¾åº¦ â­â­ï¼ŒAPI ç›¸å¯¹å¼€æ”¾</li>
<li><strong>ç®€ä¹¦</strong>ï¼šéš¾åº¦ â­â­ï¼Œç›´æ¥æ”¯æŒ Markdown</li>
</ul>
<h4 data-id="heading-58">3.4 å·¥ä½œæµå¢å¼º</h4>
<p><strong>æ–°å¢åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li><strong>å¾ªç¯èŠ‚ç‚¹</strong>ï¼šæ”¯æŒÂ <code>for</code>Â å¾ªç¯ã€<code>while</code>Â å¾ªç¯</li>
<li><strong>å®šæ—¶è§¦å‘</strong>ï¼šCron è¡¨è¾¾å¼æ”¯æŒ</li>
<li><strong>æ¡ä»¶åˆ†æ”¯</strong>ï¼šæ›´å¤æ‚çš„æ¡ä»¶åˆ¤æ–­</li>
<li><strong>å¹¶è¡Œæ‰§è¡Œ</strong>ï¼šå¤šä¸ªèŠ‚ç‚¹å¹¶è¡Œè¿è¡Œ</li>
</ul>
<p><strong>æŠ€æœ¯æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// å¾ªç¯èŠ‚ç‚¹ç¤ºä¾‹</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">LoopNode</span> {
    <span class="hljs-keyword">pub</span> loop_type: LoopType,  <span class="hljs-comment">// For / While</span>
    <span class="hljs-keyword">pub</span> iterations: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">u32</span>&gt;,
    <span class="hljs-keyword">pub</span> condition: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">String</span>&gt;,
    <span class="hljs-keyword">pub</span> body: <span class="hljs-type">Vec</span>&lt;WorkflowNode&gt;,
}

<span class="hljs-comment">// å®šæ—¶è§¦å‘å™¨</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">CronTrigger</span> {
    <span class="hljs-keyword">pub</span> expression: <span class="hljs-type">String</span>,  <span class="hljs-comment">// "0 0 * * *" æ¯å¤©é›¶ç‚¹</span>
    <span class="hljs-keyword">pub</span> timezone: <span class="hljs-type">String</span>,
}
</code></pre>
<p><strong>æŠ€æœ¯æŒ‘æˆ˜</strong>ï¼š</p>
<ul>
<li>å¾ªç¯å¯èƒ½å¯¼è‡´æ— é™æ‰§è¡Œï¼Œéœ€è¦è®¾ç½®è¶…æ—¶</li>
<li>å¹¶è¡Œæ‰§è¡Œçš„çŠ¶æ€åŒæ­¥</li>
<li>Cron è¡¨è¾¾å¼è§£æå’Œè°ƒåº¦</li>
</ul>
<p><strong>ç¼“è§£ç­–ç•¥</strong>ï¼š</p>
<ul>
<li>è®¾ç½®æœ€å¤§å¾ªç¯æ¬¡æ•°å’Œè¶…æ—¶æ—¶é—´</li>
<li>ä½¿ç”¨ Rust çš„Â <code>tokio::spawn</code>Â å®ç°å¹¶è¡Œ</li>
<li>é›†æˆÂ <code>cron</code>Â åº“å¤„ç†å®šæ—¶ä»»åŠ¡</li>
</ul>
<h4 data-id="heading-59">3.5 é£é™©è¯„ä¼°ä¸ä¼˜å…ˆçº§</h4>















































<table><thead><tr><th>åŠŸèƒ½</th><th>é£é™©ç­‰çº§</th><th>ä¼˜å…ˆçº§</th><th>é¢„è®¡å·¥æœŸ</th><th>ä¾èµ–å…³ç³»</th></tr></thead><tbody><tr><td>è¿æ¥å™¨ç³»ç»Ÿ</td><td>ğŸŸ¡ ä¸­</td><td>P0</td><td>3-4 å‘¨</td><td>æ— </td></tr><tr><td>å·¥ä½œæµå¢å¼º</td><td>ğŸŸ¡ ä¸­</td><td>P0</td><td>3-4 å‘¨</td><td>æ— </td></tr><tr><td>æŠ€èƒ½å¸‚åœº</td><td>ğŸ”´ é«˜</td><td>P1</td><td>4-6 å‘¨</td><td>è¿æ¥å™¨ç³»ç»Ÿ</td></tr><tr><td>å…¬ä¼—å·æ”¯æŒ</td><td>ğŸ”´ é«˜</td><td>P2</td><td>2-3 å‘¨</td><td>è¿æ¥å™¨ç³»ç»Ÿ</td></tr><tr><td>çŸ¥ä¹æ”¯æŒ</td><td>ğŸŸ¢ ä½</td><td>P2</td><td>2-3 å‘¨</td><td>è¿æ¥å™¨ç³»ç»Ÿ</td></tr></tbody></table>
<p>å¦‚æœä½ å¯¹ Tauri æ¡Œé¢å¼€å‘æˆ– AI Agent å¼€å‘æ„Ÿå…´è¶£ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµï¼</p>
<hr/>
<p><strong>ç›¸å…³èµ„æº</strong>ï¼š</p>
<ul>
<li>Tauri å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftauri.app%2F" target="_blank" title="https://tauri.app/" ref="nofollow noopener noreferrer">tauri.app</a></li>
<li>Rust å¼‚æ­¥ç¼–ç¨‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Frust-lang.github.io%2Fasync-book%2F" target="_blank" title="https://rust-lang.github.io/async-book/" ref="nofollow noopener noreferrer">rust-lang.github.io/async-book/</a></li>
<li>shadcn/ui ç»„ä»¶åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fui.shadcn.com%2F" target="_blank" title="https://ui.shadcn.com/" ref="nofollow noopener noreferrer">ui.shadcn.com</a></li>
<li>Agent Skills è§„èŒƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.anthropic.com%2Fen%2Fdocs%2Fbuild-with-claude%2Fskills" target="_blank" title="https://docs.anthropic.com/en/docs/build-with-claude/skills" ref="nofollow noopener noreferrer">docs.anthropic.com/en/docs/buiâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¸¦ä½ ä»é›¶æ­å»ºå…¨ç½‘çˆ†ç«çš„Clawdbot AIç§äººåŠ©ç†]]></title>    <link>https://juejin.cn/post/7599911091087081472</link>    <guid>https://juejin.cn/post/7599911091087081472</guid>    <pubDate>2026-01-28T01:58:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599911091087081472" data-draft-id="7599911091087065088" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¸¦ä½ ä»é›¶æ­å»ºå…¨ç½‘çˆ†ç«çš„Clawdbot AIç§äººåŠ©ç†"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T01:58:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨èˆŸ"/> <meta itemprop="url" content="https://juejin.cn/user/1398234520494366"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¸¦ä½ ä»é›¶æ­å»ºå…¨ç½‘çˆ†ç«çš„Clawdbot AIç§äººåŠ©ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1398234520494366/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨èˆŸ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T01:58:35.000Z" title="Wed Jan 28 2026 01:58:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Clawdbotï¼Œæ¯«æ— ç–‘é—®æ˜¯è¿™å‡ å¤©æŠ€æœ¯åœˆæœ€ç«çˆ†çš„äº§å“ï¼ŒçŸ­çŸ­å‡ å¤©æ—¶é—´github startå·²ç»åˆ°äº†ææ€–çš„70käº†ã€‚ <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c249f60f16e74810a013e0f602b33b4b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=ufXanQF4kVIV1j3WUSI7JpM2lj4%3D" alt="" loading="lazy"/> ç”šè‡³å¸¦ç«äº†Mac miniï¼Œæœ‰äººç›´æ¥ä¹°äº†12ä¸ªï¼Œè¦æ‰“é€ æ•°å­—å‘˜å·¥é˜Ÿä¼ã€‚ <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d588c9483768438a92ed3eb18f168351~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=de7ouwF7aH%2Bh8pnBtGlIuT9Vz1A%3D" alt="" loading="lazy"/> æ‰€ä»¥Clawdbotåˆ°åº•æ˜¯ä»€ä¹ˆï¼Œç®€å•æ¥è¯´æ˜¯ä¸€ä¸ªå¼€æºçš„AIåŠ©æ‰‹ï¼Œå¯ä»¥è¿è¡Œåœ¨è‡ªå·±çš„è®¾å¤‡ï¼ˆMacã€Windowsã€Linuxï¼‰ä¸Šï¼Œå¯ä»¥æ¥å…¥èŠå¤©è¿ç”¨ï¼Œæ¯”å¦‚Telegramã€WhatsAppã€Discordç­‰ç­‰ï¼Œç„¶åç›´æ¥åœ¨èŠå¤©åº”ç”¨ä¸­å¯¹è¯å‘æŒ‡ä»¤å°±å¯ä»¥ï¼ŒClawdbotå°±ä¼š7*24å°æ—¶çš„ä¸ºä½ å·¥ä½œäº†ã€‚</p>
<p>Clawdbotä¹‹æ‰€ä»¥çˆ†çº¢çš„ä¸€ä¸ªåŸå› æ˜¯å®ƒå¯ä»¥è¿è¡Œåœ¨è‡ªå·±çš„ç¯å¢ƒä¸­ï¼Œäº¤äº’æ–¹å¼å›å½’ç”¨æˆ·ç†Ÿæ‚‰çš„èŠå¤©åº”ç”¨ã€‚å¹¶ä¸”æ‹¥æœ‰å®Œæ•´çš„æ“ä½œæƒé™å’Œè¶…é•¿è®°å¿†ï¼Œä¸€ä¸ªä¸“å±äºä¸ªäººçš„AIåŠ©ç†ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒæ•°æ®é—®é¢˜äº†ã€‚æ¥ä¸‹æ¥å¼€å§‹ä¸€æ­¥ä¸€æ­¥æ­å»ºClawdbotã€‚æˆ‘ä½¿ç”¨çš„æ˜¯ä¸€å°é—²ç½®çš„ Macbook intelèŠ¯ç‰‡çš„ç”µè„‘ã€‚</p>
<p><strong>1ã€è¿è¡Œç»ˆç«¯å‘½ä»¤</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">curl -fsSL https:<span class="hljs-comment">//clawd.bot/install.sh | bash</span>
</code></pre>
<p>è£…å¿…è¦çš„ä¾èµ–ï¼Œè¿™é‡Œè®°å¾—è¦æ‰“å¼€ç§‘å­¦ä¸Šç½‘ã€‚</p>
<p><strong>2ã€å¿«é€Ÿé…ç½®å‘½ä»¤</strong></p>
<pre><code class="hljs language-css" lang="css">clawdbot onboard <span class="hljs-attr">--flow</span> quickstart
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb09c7501ca64304ac9ab2c027644e48~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=2PO8OJxlqFvu1AztJk%2FbD7hDr1M%3D" alt="Snipaste_2026-01-27_21-34-17" loading="lazy"/></p>
<p>Snipaste_2026-01-27_21-34-17</p>
<p>é€‰æ‹©yesï¼Œ æ¥ä¸‹æ¥æŒ‰ç…§æ­¥éª¤ä¸€æ­¥ä¸€æ­¥æ‰§è¡Œ é€‰æ‹©æ¨¡å‹ï¼ŒåŸºæœ¬ä¸Šå¸‚é¢ä¸Šæ‰€æœ‰çš„ä¸»æµæ¨¡å‹éƒ½æ”¯æŒäº†ï¼Œé€‰æ‹©ä¸€ä¸ªè‡ªå·±æœ‰åœ¨ç”¨çš„æ¨¡å‹ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©Anthropicï¼Œå¦‚æœåªæ˜¯ç®€å•ä½¿ç”¨å¯ä»¥é€‰Qwenï¼Œä¾¿å®œï¼Œå¤Ÿç”¨ <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/989a533a334e413f9beb91a046a350b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=FG5T3LlC9keD08uWgVSO8OHEfO4%3D" alt="2" loading="lazy"/></p>
<p><strong>3ã€æˆæƒç™»å½•</strong> <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b265592948fd4194b01ab90b63275ebc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=zuJcuVzWYO0e%2FGqZrsfiSFErmLs%3D" alt="3" loading="lazy"/></p>
<p><strong>4ã€é…ç½®Telegramæœºå™¨äºº</strong> <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1dfd456e2d4b49a7a7853a3cd28e1733~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=Fx7hXzU1F%2B3%2FZ9MXXVpiMpRqEhM%3D" alt="4" loading="lazy"/> <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b837a9604a7486b9fb22176bef6793c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=wgm6iVxrWG4%2BqFXr4n9wdWD8LTI%3D" alt="5" loading="lazy"/> æ‰“å¼€ä½ çš„Telegramï¼Œæœç´¢ â€œ@BotFatherâ€ å‘é€ /bewbotï¼Œä¸€æ­¥ä¸€æ­¥å¡«å†™æœºå™¨äººåç§°ç­‰ä¿¡æ¯ <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ac4d742deffe4b53a14eb397aa4fbc46~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=Ldfu2IB1K5ZiofVXewVG%2B%2FEaBTU%3D" alt="5.5" loading="lazy"/> æœ€åå°†tokenå¤åˆ¶åˆ°ç»ˆç«¯è¾“å…¥</p>
<p><strong>4ã€é…ç½®skillså’Œhooks</strong></p>
<p>è¿™ä¸€æ­¥å¯é€‰ï¼ŒæŒ‰è‡ªå·±è¦æ±‚æ¥ <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bfeb9dec17cb47cbbd94eba7ff09de38~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=8p8E6IdRGux7CmM5yVIXzgNkUms%3D" alt="6" loading="lazy"/> <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0b84fc2f23e5443b9dd5c20e8d1e3026~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=ZTj62gCtbDATwVYjFGn73J3ARKo%3D" alt="7" loading="lazy"/></p>
<p><strong>6ã€æ£€æŸ¥æ˜¯å¦å®‰è£…æ­£å¸¸</strong> æµè§ˆå™¨æ‰“å¼€ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A18789%2C%25E6%2598%25AF%25E4%25B8%25AA%25E5%258F%25AF%25E8%25A7%2586%25E5%258C%2596%25E7%259A%2584%25E9%25A1%25B5%25E9%259D%25A2" target="_blank" title="http://127.0.0.1:18789,%E6%98%AF%E4%B8%AA%E5%8F%AF%E8%A7%86%E5%8C%96%E7%9A%84%E9%A1%B5%E9%9D%A2" ref="nofollow noopener noreferrer">http://127.0.0.1:18789,æ˜¯ä¸ªå¯è§†åŒ–çš„é¡µé¢</a> <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55b1b989161a4e259c7ed318577dbd31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=DtOKlYEpStH0bftWwyjrsvF7y7w%3D" alt="9" loading="lazy"/></p>
<p><strong>7ã€Telegramé…å¯¹</strong></p>
<p>æ‰“å¼€Telegramï¼Œå’Œåˆšåˆšåˆ›å»ºçš„æœºå™¨äººè¾“å…¥ /start, ä¼šå‡ºç°ä¸€ä¸ªé…å¯¹ç  <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa7423fb3aef49c480edfa96c961e274~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=lfzfLhuD%2BUwMbtpQB38Uxlnq3TA%3D" alt="" loading="lazy"/></p>
<p>ç»ˆç«¯æ‰§è¡Œ</p>
<pre><code class="hljs">clawdbot pairing approve telegram Qxx
</code></pre>
<p><strong>æ³¨æ„ï¼šæç¤ºç½‘å…³è¿æ¥å¤±è´¥</strong> <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/265f74e619fa4e4ba680c3baff93ae56~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6Iif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170532&amp;x-signature=dOwkUZ6mzPGn3jHx4CteTuB%2BCGM%3D" alt="" loading="lazy"/> è¿™æ—¶å€™æ£€æŸ¥ä¸‹ï¼Œtelegram apiæ˜¯å¦å¯ä»¥è®¿é—®ï¼Œå¤§æ¦‚ç‡æ˜¯å› ä¸ºç½‘ç»œåŸå› </p>
<pre><code class="hljs language-arduino" lang="arduino">curl -I https:<span class="hljs-comment">//api.telegram.org</span>
</code></pre>
<p>åˆ°è¿™é‡Œï¼Œæ‰€æœ‰çš„é…ç½®å°±å·²ç»å®Œæˆäº†ã€‚å¯ä»¥ç»™ä½ çš„æœºå™¨äººå‘é€æŒ‡ä»¤ï¼Œä½ çš„7*24å°æ—¶ç§äººåŠ©ç†ä¸Šçº¿äº†ï¼Œå¿«å»æ‰“é€ ä½ çš„æ•°å­—å‘˜å·¥å›¢é˜Ÿå§</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Anthropic é»‘å®¢æ¾å† å†›çš„ Claude Code æœ€ä½³å®è·µï¼Œå»ºè®®ç¨‹åºå‘˜å…¨å‘˜æ”¶è—ï¼]]></title>    <link>https://juejin.cn/post/7599852042531143690</link>    <guid>https://juejin.cn/post/7599852042531143690</guid>    <pubDate>2026-01-28T02:10:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599852042531143690" data-draft-id="7599922362998505518" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Anthropic é»‘å®¢æ¾å† å†›çš„ Claude Code æœ€ä½³å®è·µï¼Œå»ºè®®ç¨‹åºå‘˜å…¨å‘˜æ”¶è—ï¼"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T02:10:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‚Ÿé¸£"/> <meta itemprop="url" content="https://juejin.cn/user/4107431171852270"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Anthropic é»‘å®¢æ¾å† å†›çš„ Claude Code æœ€ä½³å®è·µï¼Œå»ºè®®ç¨‹åºå‘˜å…¨å‘˜æ”¶è—ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4107431171852270/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‚Ÿé¸£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:10:30.000Z" title="Wed Jan 28 2026 02:10:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¦‚æœä½ æ˜¯ç¨‹åºå‘˜ï¼Œä½ æœ€è¿‘åœ¨æ€è€ƒå¦‚ä½•é€šè¿‡ç¼–å†™æ›´ä¸“ä¸šçš„ Â commandsã€agentsã€rulesã€skills Â æ¥æå‡è‡ªå·±æˆ–å›¢é˜Ÿçš„ AI Coding æ•ˆæœã€‚</p>
<p>æœ¬æ–‡ä»‹ç»çš„è¿™ä¸ªä»“åº“ï¼Œä½ ä¸€å®šä¸èƒ½é”™è¿‡ï¼ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b0fe34f6517840feacdcc08eb5b98ade~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=bOyVN0FOjFvFXaRvbKQAgpBsDkU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½œè€…æ˜¯ @affaanmustafaï¼Œ2025 å¹´9æœˆä»½ï¼Œä»–çº½çº¦çš„ Anthropic x Forum Ventures é»‘å®¢æ¾ä¸­æ‹¿ä¸‹å† å†›ï¼Œèµ¢å¾—äº† 1.5 ä¸‡ç¾é‡‘ç­‰å€¼çš„ Anthropic API é¢åº¦ï¼</p>
<p>ä»–è¿‘æ—¥å…¬å¼€äº†è‡ªå·±ä½¿ç”¨ Claude Code Â çš„â€œæœ€ä½³å®è·µâ€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc67aafa08b7412d951ad37482890a92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=KlVF%2FCto6%2FABJDEr6EQ187Y6gJo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Github åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faffaan-m%2Feverything-claude-code%3Ftab%3Dreadme-ov-file" target="_blank" title="https://github.com/affaan-m/everything-claude-code?tab=readme-ov-file" ref="nofollow noopener noreferrer">github.com/affaan-m/evâ€¦</a></p>
<pre><code class="hljs language-perl" lang="perl">everything-claude-code/
|-- .claude-plugin/ Â Â <span class="hljs-comment"># Plugin and marketplace manifests</span>
| Â  |-- plugin.json Â  Â  Â  Â Â <span class="hljs-comment"># Plugin metadata and component paths</span>
| Â  |-- marketplace.json Â  Â <span class="hljs-comment"># Marketplace catalog for /plugin marketplace add</span>
|
|-- agents/ Â  Â  Â  Â  Â Â <span class="hljs-comment"># Specialized subagents for delegation</span>
| Â  |-- planner.md Â  Â  Â  Â  Â Â <span class="hljs-comment"># Feature implementation planning</span>
| Â  |-- architect.md Â  Â  Â  Â Â <span class="hljs-comment"># System design decisions</span>
| Â  |-- tdd-guide.md Â  Â  Â  Â Â <span class="hljs-comment"># Test-driven development</span>
| Â  |-- code-reviewer.md Â  Â Â <span class="hljs-comment"># Quality and security review</span>
| Â  |-- security-reviewer.mdÂ <span class="hljs-comment"># Vulnerability analysis</span>
| Â  |-- build-error-resolver.md
| Â  |-- e2e-runner.md Â  Â  Â  Â <span class="hljs-comment"># Playwright E2E testing</span>
| Â  |-- refactor-cleaner.md Â <span class="hljs-comment"># Dead code cleanup</span>
| Â  |-- doc-updater.md Â  Â  Â Â <span class="hljs-comment"># Documentation sync</span>
|
|-- skills/ Â  Â  Â  Â  Â Â <span class="hljs-comment"># Workflow definitions and domain knowledge</span>
| Â  |-- coding-standards/ Â  Â  Â  Â  Â Â <span class="hljs-comment"># Language best practices</span>
| Â  |-- backend-patterns/ Â  Â  Â  Â  Â Â <span class="hljs-comment"># API, database, caching patterns</span>
| Â  |-- frontend-patterns/ Â  Â  Â  Â  Â <span class="hljs-comment"># React, Next.js patterns</span>
| Â  |-- continuous-learning/ Â  Â  Â  Â <span class="hljs-comment"># Auto-extract patterns from sessions (Longform Guide)</span>
| Â  |-- strategic-compact/ Â  Â  Â  Â  Â <span class="hljs-comment"># Manual compaction suggestions (Longform Guide)</span>
| Â  |-- tdd-workflow/ Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># TDD methodology</span>
| Â  |-- security-review/ Â  Â  Â  Â  Â  Â <span class="hljs-comment"># Security checklist</span>
| Â  |--Â <span class="hljs-keyword">eval</span>-harness/ Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># Verification loop evaluation (Longform Guide)</span>
| Â  |-- verification-loop/ Â  Â  Â  Â  Â <span class="hljs-comment"># Continuous verification (Longform Guide)</span>
|
|-- commands/ Â  Â  Â  Â Â <span class="hljs-comment"># Slash commands for quick execution</span>
| Â  |-- tdd.md Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># /tdd - Test-driven development</span>
| Â  |-- plan.md Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># /plan - Implementation planning</span>
| Â  |-- e2e.md Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># /e2e - E2E test generation</span>
| Â  |-- code-review.md Â  Â  Â <span class="hljs-comment"># /code-review - Quality review</span>
| Â  |-- build-fix.md Â  Â  Â  Â <span class="hljs-comment"># /build-fix - Fix build errors</span>
| Â  |-- refactor-clean.md Â Â <span class="hljs-comment"># /refactor-clean - Dead code removal</span>
| Â  |-- learn.md Â  Â  Â  Â  Â  Â <span class="hljs-comment"># /learn - Extract patterns mid-session (Longform Guide)</span>
| Â  |-- checkpoint.md Â  Â  Â Â <span class="hljs-comment"># /checkpoint - Save verification state (Longform Guide)</span>
| Â  |-- verify.md Â  Â  Â  Â  Â Â <span class="hljs-comment"># /verify - Run verification loop (Longform Guide)</span>
| Â  |-- setup-pm.md Â  Â  Â  Â Â <span class="hljs-comment"># /setup-pm - Configure package manager (NEW)</span>
|
|-- rules/ Â  Â  Â  Â  Â  Â <span class="hljs-comment"># Always-follow guidelines (copy to ~/.claude/rules/)</span>
| Â  |-- security.md Â  Â  Â  Â Â <span class="hljs-comment"># Mandatory security checks</span>
| Â  |-- coding-style.md Â  Â Â <span class="hljs-comment"># Immutability, file organization</span>
| Â  |-- testing.md Â  Â  Â  Â  Â <span class="hljs-comment"># TDD, 80% coverage requirement</span>
| Â  |-- git-workflow.md Â  Â Â <span class="hljs-comment"># Commit format, PR process</span>
| Â  |-- agents.md Â  Â  Â  Â  Â Â <span class="hljs-comment"># When to delegate to subagents</span>
| Â  |-- performance.md Â  Â  Â <span class="hljs-comment"># Model selection, context management</span>
|
|-- hooks/ Â  Â  Â  Â  Â  Â <span class="hljs-comment"># Trigger-based automations</span>
| Â  |-- hooks.json Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># All hooks config (PreToolUse, PostToolUse, Stop, etc.)</span>
| Â  |-- memory-persistence/ Â  Â  Â Â <span class="hljs-comment"># Session lifecycle hooks (Longform Guide)</span>
| Â  |-- strategic-compact/ Â  Â  Â  Â <span class="hljs-comment"># Compaction suggestions (Longform Guide)</span>
|
|-- scripts/ Â  Â  Â  Â  Â <span class="hljs-comment"># Cross-platform Node.js scripts (NEW)</span>
| Â  |-- lib/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># Shared utilities</span>
| Â  | Â  |-- utils.js Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># Cross-platform file/path/system utilities</span>
| Â  | Â  |-- <span class="hljs-keyword">package</span>-manager.js Â Â <span class="hljs-comment"># Package manager detection and selection</span>
| Â  |-- hooks/ Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># Hook implementations</span>
| Â  | Â  |-- session-start.js Â  Â Â <span class="hljs-comment"># Load context on session start</span>
| Â  | Â  |-- session-end.js Â  Â  Â Â <span class="hljs-comment"># Save state on session end</span>
| Â  | Â  |-- pre-compact.js Â  Â  Â Â <span class="hljs-comment"># Pre-compaction state saving</span>
| Â  | Â  |-- suggest-compact.js Â Â <span class="hljs-comment"># Strategic compaction suggestions</span>
| Â  | Â  |-- evaluate-session.js Â <span class="hljs-comment"># Extract patterns from sessions</span>
| Â  |-- setup-<span class="hljs-keyword">package</span>-manager.jsÂ <span class="hljs-comment"># Interactive PM setup</span>
|
|-- tests/ Â  Â  Â  Â  Â  Â <span class="hljs-comment"># Test suite (NEW)</span>
| Â  |-- lib/ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># Library tests</span>
| Â  |-- hooks/ Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># Hook tests</span>
| Â  |-- run-all.js Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># Run all tests</span>
|
|-- contexts/ Â  Â  Â  Â Â <span class="hljs-comment"># Dynamic system prompt injection contexts (Longform Guide)</span>
| Â  |-- dev.md Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># Development mode context</span>
| Â  |-- review.md Â  Â  Â  Â  Â Â <span class="hljs-comment"># Code review mode context</span>
| Â  |-- research.md Â  Â  Â  Â Â <span class="hljs-comment"># Research/exploration mode context</span>
|
|-- examples/ Â  Â  Â  Â Â <span class="hljs-comment"># Example configurations and sessions</span>
| Â  |-- CLAUDE.md Â  Â  Â  Â  Â Â <span class="hljs-comment"># Example project-level config</span>
| Â  |-- user-CLAUDE.md Â  Â  Â <span class="hljs-comment"># Example user-level config</span>
|
|-- mcp-configs/ Â  Â  Â <span class="hljs-comment"># MCP server configurations</span>
| Â  |-- mcp-servers.json Â  Â <span class="hljs-comment"># GitHub, Supabase, Vercel, Railway, etc.</span>
|
|-- marketplace.json Â <span class="hljs-comment"># Self-hosted marketplace config (for /plugin marketplace add)</span>
</code></pre>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a843e321179f45f885a81439f1917dd3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=JpXoBT2TOR%2BBakLppObjez5qTRw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>æŠŠ Claude Code å½“æˆé•¿æœŸåˆä¼™äººï¼Œç”¨é…ç½®ã€Œè½»é‡å¾®è°ƒã€è€Œä¸æ˜¯é€ å¤æ‚æ¶æ„ï¼Œé‡ç‚¹æ˜¯å‡å°‘é‡å¤ã€ä¿æŠ¤ä¸Šä¸‹æ–‡ã€è®©å¹¶è¡Œå¼€å‘æ›´é«˜æ•ˆã€‚</li>
<li>æ§åˆ¶å¯ç”¨çš„ MCP / æ’ä»¶æ•°é‡ï¼Œé¿å…å·¥å…·å¤ªå¤šæŠŠä¸Šä¸‹æ–‡çª—å£æŒ¤çˆ†ï¼Œå½±å“æ€§èƒ½ã€‚</li>
</ul>
<p><strong>Skills / Commands</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d14d03ab65f748f3b3cdb7541590b839~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=2ax9Csk8fhQv4l1DHjRMNifAHVM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>Skills å°±æ˜¯å¯å¤ç”¨çš„å·¥ä½œæµæç¤ºè¯ï¼Œé™å®šåœ¨ç‰¹å®šåœºæ™¯ï¼Œæ¯”å¦‚Â <code>/refactor-clean</code>Â æ¸…ç†æ­»ä»£ç å’Œé›¶æ•£ mdï¼Œ<code>/tdd</code>ã€<code>/e2e</code>ã€<code>/test-coverage</code>Â è´Ÿè´£æµ‹è¯•æµç¨‹ï¼Œå¯ä»¥åœ¨ä¸€æ¬¡æç¤ºé‡Œé“¾å¼ç»„åˆå¤šä¸ªå‘½ä»¤ã€‚</li>
<li>Skills ä»¥ markdown æ–‡ä»¶å­˜æ”¾åœ¨Â <code>~/.claude/skills</code>ï¼ŒCommands åˆ™æ˜¯ä»¥ã€Œæ–œæ å‘½ä»¤ã€æ–¹å¼å¿«é€Ÿæ‰§è¡Œï¼Œå­˜æ”¾åœ¨Â <code>~/.claude/commands</code>ã€‚</li>
</ul>
<p><strong>Hooksï¼ˆé’©å­è‡ªåŠ¨åŒ–ï¼‰</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6fd4ce07129a45a1beb3b112941535af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=mkZ1p4DfNQCkyIRQ%2Be8gsTBZE5w%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>Hooks æ˜¯åŸºäºäº‹ä»¶çš„è‡ªåŠ¨åŒ–ï¼Œè§¦å‘ç‚¹åŒ…æ‹¬ï¼šå·¥å…·è°ƒç”¨å‰åã€ç”¨æˆ·å‘æ¶ˆæ¯æ—¶ã€Claude å›ç­”ç»“æŸã€å‹ç¼©ä¸Šä¸‹æ–‡å‰ï¼Œä»¥åŠæƒé™é€šçŸ¥ç­‰ã€‚</li>
<li>ç¤ºä¾‹ï¼šåœ¨æ‰§è¡Œ npm / pytest ç­‰é•¿å‘½ä»¤ä¹‹å‰æé†’ä½ ç”¨ tmuxï¼›PostToolUse è‡ªåŠ¨è·‘ Prettierã€TypeScript æ£€æŸ¥ï¼Œæˆ–è€…åœ¨ä¼šè¯ç»“æŸå‰è‡ªåŠ¨æ‰«æÂ <code>console.log</code>ã€‚</li>
<li>æ¨èç”¨Â <code>hookify</code>Â æ’ä»¶ç”¨è‡ªç„¶è¯­è¨€ç”Ÿæˆ Hookï¼Œè€Œä¸æ˜¯æ‰‹å†™ JSONã€‚</li>
</ul>
<p><strong>Subagentsï¼ˆå­ä»£ç†ï¼‰</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e8325be71894fd3ae77bda32ca1fec3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=oQ1cJOJP8gOFaCzclWhAUtVio9g%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>Subagents æ˜¯ç”±ä¸» Claude è°ƒåº¦çš„å­è¿›ç¨‹ï¼Œè´Ÿè´£æŸä¸€ç±»ä»»åŠ¡ï¼ˆå¦‚ plannerã€architectã€tdd-guideã€code-reviewerã€security-reviewer ç­‰ï¼‰ï¼Œå¯ä»¥å‰å°æˆ–åå°è·‘ï¼Œéš”ç¦»æƒé™ã€èŠ‚çº¦ä¸»ä¼šè¯ä¸Šä¸‹æ–‡ã€‚</li>
<li>æ¯ä¸ªå­ä»£ç†åªå¼€æ”¾æœ‰é™çš„å·¥å…· / MCPï¼Œä½¿å…¶ä¸“æ³¨äºä¸€å°å—èŒè´£ï¼Œæ¯”å¦‚ä¸“é—¨è·‘ e2eã€è§£å†³ build é”™è¯¯æˆ–åš refactor-cleanã€‚</li>
</ul>
<p><strong>è§„åˆ™ä¸è®°å¿†</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6d93b3192994fb7836a1d83b1bb475f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=15N2azfY7UCTes1zWPFxWcohH%2Fc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li><code>~/.claude/rules</code>Â é‡Œæ”¾ã€Œæ°¸è¿œè¦éµå®ˆã€çš„æœ€ä½³å®è·µï¼Œå¯ä»¥æ˜¯å•ä¸€Â <code>CLAUDE.md</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯æŒ‰å®‰å…¨ã€ä»£ç é£æ ¼ã€æµ‹è¯•ã€Git å·¥ä½œæµã€agentsã€æ€§èƒ½ç­‰æ‹†åˆ†çš„å¤šæ–‡ä»¶ç»“æ„ã€‚</li>
<li>è§„åˆ™å†…å®¹åŒ…æ‹¬ï¼šç¦æ­¢ä»£ç ä¸­ emojiã€å‰ç«¯é¿å…ç´«è‰²ã€å¿…é¡»å…ˆæµ‹è¯•å†éƒ¨ç½²ã€ä¼˜å…ˆæ¨¡å—åŒ–ã€ç¦æ­¢æäº¤Â <code>console.log</code>Â ç­‰ï¼Œä¸ºæ•´ä¸ªé¡¹ç›®å®šä¸‹ç»Ÿä¸€è¡Œä¸ºå‡†åˆ™ã€‚</li>
</ul>
<p><strong>MCPï¼ˆModel Context Protocolï¼‰</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55834ca8ba354027818b3ed085346135~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=ywhs%2F%2FDZJcA3mo3p7%2B179A9ejyA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>MCP æ˜¯æŠŠå¤–éƒ¨æœåŠ¡ã€ŒæŒ‚æ¥ã€åˆ° Claude çš„åè®®ï¼Œæœ¬è´¨æ˜¯å¯¹ API çš„é«˜å±‚å°è£…ï¼Œæ–¹ä¾¿å¯¹æ•°æ®åº“ã€éƒ¨ç½²å¹³å°ã€Supabase ç­‰è¿›è¡ŒæŸ¥è¯¢ä¸æ“ä½œï¼Œæ¯”å¦‚ Supabase MCP å¯ç›´æ¥åˆ—è¡¨ã€è·‘ SQLã€‚</li>
<li>Chrome MCP è®© Claude èƒ½è‡ªä¸»åœ¨æµè§ˆå™¨é‡Œç‚¹å‡»ã€æŸ¥çœ‹é¡µé¢ï¼Œæå‡æ¢ç´¢èƒ½åŠ›ï¼›ä½† MCP / å·¥å…·è¿‡å¤šä¼šæå¤§æ¶ˆè€—ä¸Šä¸‹æ–‡ï¼Œå› æ­¤å»ºè®®é…ç½® 20â€“30 ä¸ª MCPï¼Œä½†æ¯ä¸ªé¡¹ç›®åªå¯ç”¨ 5â€“10 ä¸ªã€å°‘äºçº¦ 80 ä¸ªå·¥å…·ã€‚</li>
</ul>
<p><strong>æ’ä»¶ï¼ˆPluginsï¼‰</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1acd28c3e3f44318465e68022fa6797~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=cIVcRX8vGbab6GTMAAunibXrQoY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>æ’ä»¶æ˜¯ã€Œæ‰“åŒ…å¥½çš„å·¥å…·é›†ã€ï¼Œå¯ä»¥åŒ…å« skill + MCP + hooks ç­‰ï¼Œé¿å…æ‰‹å·¥é…ç½®ï¼›å¯ä»¥é€šè¿‡ marketplace åœ°å€æ·»åŠ åï¼Œåœ¨Â <code>/plugins</code>Â ç•Œé¢å®‰è£…ï¼Œæ¯”å¦‚Â <code>mgrep</code>Â æä¾›æ¯” ripgrep æ›´å¥½çš„æœç´¢ã€‚</li>
<li>LSP ç±»æ’ä»¶ï¼ˆå¦‚ typescript-lspã€pyright-lspï¼‰åœ¨æ²¡æœ‰ IDE çš„æƒ…å†µä¸‹æä¾›ç±»å‹æ£€æŸ¥å’Œè·³è½¬èƒ½åŠ›ï¼Œä½†åŒæ ·è¦æ³¨æ„å®ƒä»¬å¯¹ä¸Šä¸‹æ–‡çª—å£çš„å½±å“ã€‚</li>
</ul>
<p><strong>æ•ˆç‡ Tips</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a181d8b70334620a8ed529614d06de2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=ei8B6lrOwcdlEI3LqJKgBLQ%2F%2FdE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>å¿«æ·é”®ï¼š<code>Ctrl+U</code>Â åˆ æ•´è¡Œã€<code>!</code>Â å¿«é€Ÿ shell å‘½ä»¤ã€<code>@</code>Â æœç´¢æ–‡ä»¶ã€<code>/</code>Â è¿›å…¥å‘½ä»¤ã€Shift+Enter å¤šè¡Œè¾“å…¥ã€Tab æŸ¥çœ‹æ€è€ƒã€Esc Esc ä¸­æ–­æ‰§è¡Œç­‰ã€‚</li>
<li>å¹¶è¡Œï¼šç”¨Â <code>/fork</code>Â åˆ†å‰å¯¹è¯å¤„ç†äº’ä¸å½±å“çš„ä»»åŠ¡ï¼Œé…åˆ Git worktree ä¸ºä¸åŒåˆ†æ”¯å¼€ç‹¬ç«‹ Claude å®ä¾‹ï¼›ç”¨ tmux è·‘é•¿æ—¶é—´çš„å‰åç«¯æœåŠ¡å¹¶å®æ—¶çœ‹æ—¥å¿—ã€‚</li>
<li><code>mgrep</code>Â æ”¯æŒæœ¬åœ°å’ŒÂ <code>--web</code>Â æœç´¢ï¼›å…¶å®ƒæœ‰ç”¨å‘½ä»¤åŒ…æ‹¬Â <code>/rewind</code>Â å›åˆ°ä¹‹å‰çŠ¶æ€ã€<code>/statusline</code>Â å®šåˆ¶çŠ¶æ€æ ã€<code>/checkpoints</code>Â æ–‡ä»¶çº§æ’¤é”€ç‚¹ã€<code>/compact</code>Â æ‰‹åŠ¨å‹ç¼©ä¸Šä¸‹æ–‡ã€‚</li>
</ul>
<p><strong>ç¼–è¾‘å™¨ä¸å·¥ä½œæµ</strong><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c063a05640df4b4ba1cd57b101a65656~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=oIopvyAbzG9J5Zj6LvhQvscUmO4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>ä½œè€…åå¥½ Zedï¼šRust å†™çš„è½»é‡ç¼–è¾‘å™¨ï¼Œå’Œ Claude æ·±åº¦é›†æˆï¼Œæœ‰ Agent é¢æ¿ã€å®æ—¶æ–‡ä»¶è¿½è¸ªã€å‘½ä»¤é¢æ¿ï¼ˆCMD+Shift+Rï¼‰ã€ä½èµ„æºå ç”¨ã€æ”¯æŒ Vim æ¨¡å¼ç­‰ã€‚</li>
<li>æ¨èå¸ƒå±€ï¼šå·¦è¾¹ç»ˆç«¯è·‘ Claude Codeï¼Œå³è¾¹ Zedï¼›å¯ç”¨è‡ªåŠ¨ä¿å­˜ã€æ–‡ä»¶ç›‘å¬ä»¥åŠ Git é›†æˆï¼Œç”¨ç¼–è¾‘å™¨å®¡æŸ¥ Claude çš„æ”¹åŠ¨åå†æäº¤ã€‚</li>
<li>VSCode / Cursor ä¹Ÿå¯ä»¥ï¼Œé€šè¿‡ç»ˆç«¯ +Â <code>\ide</code>Â åŒæ­¥æˆ–è£…å®˜æ–¹æ‰©å±•è·å¾—ç±»ä¼¼æ•ˆæœã€‚</li>
</ul>
<p><strong>ä½œè€…è‡ªå·±çš„ Setup</strong><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9512be3598540caa13167ddd6e52cbc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=FNp9EuQxrRdGgRBD71OZUTAnMEc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>æ’ä»¶ï¼šå®‰è£…äº†åå‡ ä¸ªï¼ˆå¦‚ ralph-wiggumã€frontend-designã€commit-commandsã€security-guidanceã€pr-review-toolkitã€typescript-lspã€pyright-lspã€hookifyã€mgrep ç­‰ï¼‰ï¼Œä½†é€šå¸¸åªåŒæ—¶å¯ç”¨ 4â€“5 ä¸ªã€‚</li>
<li>MCPï¼šé…ç½®äº† GitHubã€Firecrawlã€Supabaseã€memoryã€sequential-thinkingã€Vercelã€Railwayã€Cloudflare ç³»åˆ—ã€ClickHouseã€Abletonã€Magic ç­‰çº¦ 14 ä¸ªï¼Œé€šè¿‡Â <code>disabledMcpServers</code>Â é’ˆå¯¹ä¸åŒé¡¹ç›®ç¦ç”¨ä¸€éƒ¨åˆ†ï¼Œä»è€Œæ§åˆ¶ä¸Šä¸‹æ–‡å ç”¨ã€‚</li>
<li>è¿˜æœ‰è‡ªå®šä¹‰çŠ¶æ€æ ï¼ˆå±•ç¤ºç”¨æˆ·ã€ç›®å½•ã€åˆ†æ”¯ã€è„æ ‡è®°ã€å‰©ä½™ä¸Šä¸‹æ–‡ç™¾åˆ†æ¯”ã€æ¨¡å‹ã€æ—¶é—´ã€å¾…åŠæ•°ï¼‰ï¼Œæ¸…æ™°çš„ rules / agents ç›®å½•ç»“æ„ä»¥åŠä¸€ç»„å…³é”® Hooksï¼Œä½¿æ•´ä¸ªå¼€å‘å’Œåä½œæµç¨‹é«˜åº¦è‡ªåŠ¨åŒ–ã€‚</li>
</ul>
<p><strong>æœ€åçš„å‡ ç‚¹è¦è¯€</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18afd59ee0074aabad8c0d375da5e837~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=mM5kRmkj5I9S6IeZakLySRXaKDU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>é…ç½®æ˜¯ã€Œè½»é‡å¾®è°ƒã€ï¼Œåˆ«è¿‡åº¦å¤æ‚åŒ–ã€‚</li>
<li>ä¸Šä¸‹æ–‡æ˜¯<strong>ç¨€ç¼º</strong>èµ„æºï¼Œè¦æŒç»­å…³æ‰ä¸ç”¨çš„ MCP / æ’ä»¶ã€‚</li>
<li>åˆ©ç”¨å¹¶è¡Œæ‰§è¡Œï¼ˆfork å¯¹è¯ã€worktreeï¼‰ã€è‡ªåŠ¨åŒ–ï¼ˆhooksï¼‰ã€å’Œæœ‰è¾¹ç•Œçš„ subagentsï¼Œæœ€å¤§åŒ– Claude Code çš„å¼€å‘æ•ˆç‡ä¸å¯é æ€§ã€‚</li>
</ul>
<hr/>
<p>éœ€è¦çš„æœ‹å‹å¯ä»¥æŠŠä»“åº“ä¸‹è½½ä¸‹æ¥æ·±å…¥ç ”ç©¶ä¸€ä¸‹ï¼Œç»“åˆä½œè€…æä¾›çš„é…å¥—æ–‡ç« ã€‚</p>
<p>æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼š<strong>æ‚Ÿé¸£AI</strong>ï¼Œåç»­ä¼šé™†ç»­åˆ†äº«æ¯”è¾ƒæœ‰ç”¨çš„ AI å·¥å…·å’Œæ¯”è¾ƒå¥½çš„ AI ç»éªŒï¼Œæ¯”è¾ƒå®¢è§‚ç†æ€§çš„ AI è§‚ç‚¹ç­‰ã€‚!</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9eedffb3b4044842bff78345d3e706f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171034&amp;x-signature=w5enHa0bHHN03Xz%2FwGUB%2BpHJtBg%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±åº¦å‰–æSkyWalkingï¼šä»å†…æ ¸åŸç†åˆ°ç”Ÿäº§çº§å…¨é“¾è·¯ç›‘æ§å®æˆ˜]]></title>    <link>https://juejin.cn/post/7599922362998849582</link>    <guid>https://juejin.cn/post/7599922362998849582</guid>    <pubDate>2026-01-28T02:46:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599922362998849582" data-draft-id="7599922362998816814" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±åº¦å‰–æSkyWalkingï¼šä»å†…æ ¸åŸç†åˆ°ç”Ÿäº§çº§å…¨é“¾è·¯ç›‘æ§å®æˆ˜"/> <meta itemprop="keywords" content="åç«¯,ç›‘æ§,Java"/> <meta itemprop="datePublished" content="2026-01-28T02:46:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Shepherd"/> <meta itemprop="url" content="https://juejin.cn/user/3415500769991869"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±åº¦å‰–æSkyWalkingï¼šä»å†…æ ¸åŸç†åˆ°ç”Ÿäº§çº§å…¨é“¾è·¯ç›‘æ§å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3415500769991869/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Shepherd
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:46:58.000Z" title="Wed Jan 28 2026 02:46:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1.æ¦‚è¿°</h2>
<p>å¹´åº•å®åœ¨æ˜¯å¤ªå¿™äº†ï¼Œæ‰€ä»¥æ‹–æ›´äº†ä¸€ä¸ªæœˆï¼Œå¾ˆæ˜¯æŠ±æ­‰å“ˆ~ è¨€å½’æ­£ä¼ ï¼Œæˆ‘ä»¬ä¹‹å‰å·²ç»åˆ†äº«è¿‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FIYKw6SNlymt-Lw_X-f-oTg" target="_blank" title="https://mp.weixin.qq.com/s/IYKw6SNlymt-Lw_X-f-oTg" ref="nofollow noopener noreferrer">ä»å…¥é—¨åˆ°å®è·µï¼šç©è½¬åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªåˆ©å™¨SkyWalking</a>ã€‚è¿™ç¯‡æ–‡ç« è¯¦ç»†ä»‹ç»äº†SkyWalkingçš„æ ¸å¿ƒæ¦‚å¿µã€éƒ¨ç½²æµç¨‹ä¸æ¥å…¥å®è·µã€‚è¿˜ä¸äº†è§£çš„è¯·è‡ªè¡Œè·³è½¬é˜…è¯»æŒæ¡ã€‚</p>
<p>ä½†æ˜¯Apache SkyWalking ä½œä¸ºäº‘åŸç”Ÿæ—¶ä»£å¯è§‚æµ‹æ€§é¢†åŸŸçš„ä½¼ä½¼è€…ï¼Œè¿œéä¸€ä¸ªç®€å•çš„é“¾è·¯è¿½è¸ªå·¥å…·ã€‚å®ƒæ¼”è¿›ä¸ºäº†ä¸€ä¸ªç»¼åˆæ€§çš„åº”ç”¨æ€§èƒ½ç®¡ç†ï¼ˆAPMï¼‰å¹³å°ï¼Œå…·å¤‡äº†æœåŠ¡ç½‘æ ¼ï¼ˆService Meshï¼‰è§‚æµ‹ã€eBPF å†…æ ¸çº§å‰–æã€å¤šè¯­è¨€è‡ªåŠ¨æ¢é’ˆä»¥åŠå¼ºå¤§çš„æµå¼èšåˆåˆ†æèƒ½åŠ›ã€‚æœ¬æ–‡å°†åŸºäºä¹‹å‰å…¥é—¨å®æˆ˜ç¯‡ï¼Œä»å¾®æœåŠ¡é“¾è·¯è¿½è¸ªçš„æ›´æ·±å±‚åŸç†ã€Traceä¸Spançš„ç»„æˆã€ä»¥åŠä¸Log4j2/Logbackç­‰æ—¥å¿—æ¡†æ¶çš„æ•´åˆç­‰æ–¹å‘å…¨æ–¹é¢å‰–æå…¶æ¶æ„è®¾è®¡å“²å­¦ã€æ•°æ®æ¨¡å‹ç»†èŠ‚ã€ä¸Šä¸‹æ–‡ä¼ æ’­åè®®çš„ç²¾å¦™ä¹‹å¤„ï¼Œå¹¶ç»“åˆç”Ÿäº§ç¯å¢ƒçš„ç—›ç‚¹ï¼Œæ¢è®¨æ—¥å¿—èåˆä¸å­˜å‚¨è°ƒä¼˜çš„é«˜çº§å®è·µã€‚è¿™ä¸ä»…æ˜¯å¯¹å·¥å…·çš„è§£æï¼Œæ›´æ˜¯å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿç›‘æ§æ–¹æ³•è®ºçš„ä¸€æ¬¡æ·±åº¦å¤ç›˜ã€‚</p>
<h2 data-id="heading-1">2.å†çœ‹SkyWalking æ ¸å¿ƒæ¶æ„ä¸è®¾è®¡å“²å­¦</h2>
<h4 data-id="heading-2">2.1 æ•´ä½“æ¶æ„</h4>
<p>è¦ç†è§£ SkyWalking å¦‚ä½•å¤„ç†æ¯ç§’æ•°ä¸‡æ¬¡çš„å¹¶å‘è¯·æ±‚ç›‘æ§ï¼Œé¦–å…ˆå¿…é¡»è§£æ„å…¶æ ¸å¿ƒæ¶æ„ã€‚SkyWalking é‡‡ç”¨äº†ç»å…¸çš„ Client-Server åˆ†ç¦»æ¶æ„ï¼Œä½†åœ¨å…·ä½“å®ç°ä¸Šå¼•å…¥äº†å¤§é‡é’ˆå¯¹é«˜å¹¶å‘åœºæ™¯çš„ä¼˜åŒ–è®¾è®¡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e4026d8b11644aa940b8997c0600f11~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2hlcGhlcmQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173217&amp;x-signature=sPXreWd9pHM%2BmoT6AGEadBKlAos%3D" alt="" loading="lazy"/></p>
<p>SkyWalking çš„ç”Ÿæ€ç³»ç»Ÿä¸»è¦ç”±å››å¤§æ ¸å¿ƒç»„ä»¶æ„æˆï¼Œå®ƒä»¬å„å¸å…¶èŒï¼Œå½¢æˆäº†ä¸€ä¸ªé—­ç¯çš„æ•°æ®æµè½¬ä½“ç³» ï¼š</p>
<ol>
<li><strong>æ¢é’ˆï¼ˆAgentï¼‰ä¸æ¥æ”¶å™¨ï¼ˆReceiverï¼‰</strong> ï¼šè¿™æ˜¯æ•°æ®çš„æºå¤´ã€‚åœ¨ Java ç”Ÿæ€ä¸­ï¼ŒSkyWalking æä¾›äº†åŸºäº Java Agent æŠ€æœ¯çš„æ— ä¾µå…¥å¼æ¢é’ˆï¼Œåˆ©ç”¨ ByteBuddy å­—èŠ‚ç å¢å¼ºåº“åœ¨åº”ç”¨å¯åŠ¨æ—¶åŠ¨æ€ä¿®æ”¹ç±»å®šä¹‰ï¼Œæ¤å…¥ç›‘æ§é€»è¾‘ã€‚å¯¹äº Goã€Node.js ç­‰å…¶ä»–è¯­è¨€ï¼Œä¹Ÿæœ‰ç›¸åº”çš„ SDK æˆ– Sidecar æ¨¡å¼æ”¯æŒã€‚Agent è´Ÿè´£é‡‡é›† Traceï¼ˆé“¾è·¯ï¼‰ã€Metricsï¼ˆæŒ‡æ ‡ï¼‰å’Œ Logsï¼ˆæ—¥å¿—ï¼‰ï¼Œå¹¶é€šè¿‡é«˜æ•ˆçš„ gRPC åè®®å‘é€ç»™åç«¯ ã€‚</li>
<li><strong>å¯è§‚æµ‹æ€§åˆ†æå¹³å°ï¼ˆOAP Serverï¼‰</strong> ï¼šè¿™æ˜¯ç³»ç»Ÿçš„å¤§è„‘ã€‚OAP æ˜¯ä¸€ä¸ªé«˜åº¦æ¨¡å—åŒ–çš„è½»é‡çº§åˆ†ææœåŠ¡ï¼Œæ”¯æŒé›†ç¾¤éƒ¨ç½²ã€‚å®ƒæ¥æ”¶æ¥è‡ª Agent çš„æ•°æ®ï¼Œæ‰§è¡Œæå…¶å¤æ‚çš„æµå¼è®¡ç®—ã€‚SkyWalking ç‹¬åˆ›äº† OAP åˆ†æè¯­è¨€ï¼ˆOALï¼‰ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡ç®€å•çš„è„šæœ¬å®šä¹‰èšåˆé€»è¾‘ï¼ˆå¦‚è®¡ç®— P99 å»¶è¿Ÿã€SLA æˆåŠŸç‡ç­‰ï¼‰ï¼Œè€Œæ— éœ€ä¿®æ”¹åº•å±‚ä»£ç ã€‚OAP è´Ÿè´£å°†åŸå§‹çš„ Trace æ•°æ®è½¬åŒ–ä¸ºç›´è§‚çš„æœåŠ¡æ‹“æ‰‘å›¾ï¼ˆTopologyï¼‰å’Œæ€§èƒ½æŒ‡æ ‡ ã€‚</li>
<li><strong>å­˜å‚¨å®ç°ï¼ˆStorageï¼‰</strong> ï¼šè¿™æ˜¯æ•°æ®çš„å½’å®¿ã€‚SkyWalking é‡‡ç”¨äº†æ’ä»¶åŒ–çš„å­˜å‚¨æ¶æ„ï¼Œæ”¯æŒ Elasticsearchã€MySQLã€H2ã€TiDB ç­‰å¤šç§åç«¯ã€‚è€Œåœ¨æœ€æ–°çš„æ¼”è¿›ä¸­ï¼Œä¸“ä¸ºå¯è§‚æµ‹æ€§æ•°æ®è®¾è®¡çš„ BanyanDB æ­£åœ¨é€æ¸æˆä¸ºæ ¸å¿ƒé€‰æ‹©ï¼Œæ—¨åœ¨è§£å†³é€šç”¨æ•°æ®åº“åœ¨å¤„ç†æ—¶åºæ•°æ®ï¼ˆTime Series Dataï¼‰æ—¶çš„æ€§èƒ½ç“¶é¢ˆ ã€‚</li>
<li><strong>å¯è§†åŒ–ç•Œé¢ï¼ˆUIï¼‰</strong> ï¼šè¿™æ˜¯ç”¨æˆ·çš„äº¤äº’çª—å£ã€‚é€šè¿‡ GraphQL æŸ¥è¯¢ OAP æä¾›çš„æ¥å£ï¼ŒUI èƒ½å¤Ÿå±•ç¤ºæœåŠ¡ä¾èµ–å…³ç³»ã€é“¾è·¯ç«ç„°å›¾ã€æ—¥å¿—è¯¦æƒ…ä»¥åŠå‘Šè­¦ä¿¡æ¯</li>
</ol>
<h4 data-id="heading-3">2.2 æ¢é’ˆä¸ OAP çš„äº¤äº’æœºåˆ¶</h4>
<p>Agent ä¸ OAP ä¹‹é—´çš„äº¤äº’è®¾è®¡ä½“ç°äº† <strong>â€œè½» Agentï¼Œé‡ OAPâ€</strong> çš„è®¾è®¡å“²å­¦ã€‚ä¸ºäº†æœ€å¤§ç¨‹åº¦å‡å°‘å¯¹ä¸šåŠ¡åº”ç”¨çš„ä¾µå…¥å’Œæ€§èƒ½æŸè€—ï¼ŒAgent ç«¯ä»…è´Ÿè´£æœ€åŸºç¡€çš„æ•°æ®æ”¶é›†å’Œç¼“å†²ï¼Œè€Œå°†å¤æ‚çš„è®¡ç®—é€»è¾‘ï¼ˆå¦‚æ‹“æ‰‘å‘ç°ã€æŒ‡æ ‡èšåˆï¼‰å…¨éƒ¨åç½®åˆ° OAP ç«¯è¿›è¡Œ ã€‚</p>
<p>è¿™ç§äº¤äº’ä¸»è¦ä¾èµ–äº gRPC åè®®ã€‚ç›¸è¾ƒäº HTTP/1.1ï¼ŒgRPC åŸºäº HTTP/2ï¼Œæ”¯æŒå¤šè·¯å¤ç”¨å’ŒåŒå‘æµï¼Œèƒ½å¤Ÿåœ¨ä¸€ä¸ªè¿æ¥ä¸Šå¹¶å‘å¤„ç†å¤§é‡æ•°æ®ä¼ è¾“ï¼Œæå¤§åœ°é™ä½äº†ç½‘ç»œè¿æ¥å¼€é”€ã€‚æ­¤å¤–ï¼ŒProtobuf çš„äºŒè¿›åˆ¶åºåˆ—åŒ–æœºåˆ¶ä½¿å¾—ä¼ è¾“è½½è·è¿œå°äº JSON æ ¼å¼ï¼Œè¿™å¯¹äºå…¨é“¾è·¯ç›‘æ§äº§ç”Ÿæµ·é‡æ•°æ®è‡³å…³é‡è¦ã€‚</p>
<p>åœ¨äº¤äº’æµç¨‹ä¸­ï¼ŒAgent å¯åŠ¨åé¦–å…ˆä¼šè¿›è¡ŒæœåŠ¡æ³¨å†Œï¼Œå‘ OAP æ±‡æŠ¥è‡ªèº«çš„ <code>Service Name</code>ï¼ˆæœåŠ¡åï¼‰å’Œ <code>Service Instance Name</code>ï¼ˆå®ä¾‹åï¼‰ã€‚OAP ä¼šä¸ºæ¯ä¸ªå®ä¾‹åˆ†é…å”¯ä¸€çš„ IDï¼Œåç»­çš„æ‰€æœ‰æ•°æ®ä¸ŠæŠ¥éƒ½å°†åŸºäºè¿™äº› ID è¿›è¡Œï¼Œä»è€Œå‡å°‘äº†å­—ç¬¦ä¸²ä¼ è¾“çš„å†—ä½™ ã€‚å¿ƒè·³æœºåˆ¶ç¡®ä¿å­˜æ´»çŠ¶æ€çš„å®æ—¶æ›´æ–°ï¼Œä¸€æ—¦ Agent å®•æœºï¼ŒOAP èƒ½å¤Ÿè¿…é€Ÿæ„ŸçŸ¥å¹¶åœ¨æ‹“æ‰‘å›¾ä¸­å°†å…¶æ ‡è®°ä¸ºä¸‹çº¿ã€‚</p>
<h2 data-id="heading-4">3.é“¾è·¯è¿½è¸ªçš„æ•°æ®æ¨¡å‹ï¼šTrace, Segment ä¸ Span</h2>
<p>æ·±å…¥ç†è§£ SkyWalking çš„æ•°æ®æ¨¡å‹æ˜¯æŒæ¡å…¶åŸç†çš„å…³é”®ã€‚ä¸åŒäº Zipkin æˆ– Jaeger å°† "Span" ä½œä¸ºæœ€å°ä¼ è¾“å•å…ƒï¼ŒSkyWalking å¼•å…¥äº† <strong>Trace Segment</strong> çš„æ¦‚å¿µï¼Œè¿™æ˜¯é’ˆå¯¹è¯­è¨€è¿è¡Œæ—¶ç‰¹æ€§ï¼ˆç‰¹åˆ«æ˜¯ Java çº¿ç¨‹æ¨¡å‹ï¼‰çš„æ·±åº¦ä¼˜åŒ–ã€‚ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªä¸‹å•æµç¨‹çš„é“¾è·¯æƒ…å†µï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ebf264b643a43fbbd96a31e1a6a9639~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2hlcGhlcmQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173217&amp;x-signature=FfnOn%2FAstg42KvvgfHI83tJ1sB8%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-5">3.1 Traceï¼šå…¨å±€è§†è§’çš„é€»è¾‘ä¸²è”</h4>
<p><strong>Trace</strong> ä»£è¡¨äº†ä¸€ä¸ªå®Œæ•´çš„åˆ†å¸ƒå¼äº‹åŠ¡ã€‚å®ƒç”±ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ <code>TraceID</code> æ ‡è¯†ã€‚æ— è®ºè¯·æ±‚ç»è¿‡äº†å¤šå°‘ä¸ªå¾®æœåŠ¡ï¼Œåªè¦å®ƒä»¬å±äºåŒä¸€ä¸ªè°ƒç”¨é“¾ï¼Œå®ƒä»¬å°±å…±äº«åŒä¸€ä¸ª TraceIDã€‚Trace æ˜¯ä¸€ä¸ªé€»è¾‘æ¦‚å¿µï¼Œå®ƒå®é™…ä¸Šæ˜¯ç”±åˆ†å¸ƒåœ¨ä¸åŒæœåŠ¡èŠ‚ç‚¹ä¸Šçš„å¤šä¸ª Segment ç»„æˆçš„é›†åˆ ã€‚</p>
<h4 data-id="heading-6">3.2 Trace Segmentï¼šè¿›ç¨‹å†…çš„åŸå­å•å…ƒ</h4>
<p><strong>Trace Segment</strong> æ˜¯ SkyWalking æ•°æ®æ¨¡å‹ä¸­æœ€å…·ç‰¹è‰²çš„è®¾è®¡ã€‚å®ƒæŒ‡çš„æ˜¯åœ¨åŒä¸€ä¸ª OS è¿›ç¨‹ï¼ˆé€šå¸¸æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ï¼‰ä¸­æ‰§è¡Œçš„æ‰€æœ‰ Span çš„é›†åˆã€‚</p>
<p>ä¸ºä»€ä¹ˆéœ€è¦ Segmentï¼Ÿåœ¨å¾®æœåŠ¡çš„é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¦‚æœ Agent æ¯é‡‡é›†åˆ°ä¸€ä¸ª Spanï¼ˆä¾‹å¦‚ä¸€æ¬¡æœ¬åœ°æ–¹æ³•è°ƒç”¨ï¼‰å°±ç«‹å³å‘åç«¯å‘é€ä¸€æ¬¡ç½‘ç»œè¯·æ±‚ï¼Œé‚£ä¹ˆç›‘æ§æœ¬èº«å¸¦æ¥çš„ç½‘ç»œå¼€é”€ï¼ˆIO Overheadï¼‰å°†æ˜¯ç¾éš¾æ€§çš„ã€‚SkyWalking å·§å¦™åœ°å°†åŒä¸€ä¸ªçº¿ç¨‹ä¸Šä¸‹æ–‡ä¸­çš„æ‰€æœ‰æ“ä½œæ‰“åŒ…æˆä¸€ä¸ª Segmentã€‚å½“è¯·æ±‚è¿›å…¥æœåŠ¡æ—¶ï¼ŒSegment å¼€å§‹ï¼›å½“è¯·æ±‚å¤„ç†å®Œæˆå¹¶å“åº”æ—¶ï¼ŒSegment ç»“æŸã€‚Agent ä¼šå°†è¿™æ•´ä¸ª Segment ä½œä¸ºä¸€ä¸ªåŸå­åŒ…å‘é€ç»™ OAP ã€‚</p>
<p>è¿™ç§è®¾è®¡å¸¦æ¥çš„ä¼˜åŠ¿æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼šå®ƒæå¤§åœ°å‡å°‘äº† Agent ä¸ OAP ä¹‹é—´çš„ RPC è°ƒç”¨æ¬¡æ•°ï¼Œæé«˜äº†æ•°æ®ä¼ è¾“çš„å‹ç¼©ç‡ã€‚åŒæ—¶ï¼Œå®ƒä¿è¯äº†è¿›ç¨‹å†…æ•°æ®çš„å®Œæ•´æ€§â€”â€”è¦ä¹ˆæ•´ä¸ª Segment æˆåŠŸä¸ŠæŠ¥ï¼Œè¦ä¹ˆå…¨éƒ¨ä¸¢å¤±ï¼Œé¿å…äº†å› éƒ¨åˆ† Span ä¸¢å¤±å¯¼è‡´çš„â€œæ–­é“¾â€å›°æƒ‘ã€‚</p>
<h4 data-id="heading-7">3.3 Spanï¼šæ“ä½œçš„æœ€å°ç²’åº¦</h4>
<p><strong>Span</strong> æ˜¯ä¾é™„äº Segment å­˜åœ¨çš„æœ€å°ç›‘æ§å•å…ƒã€‚SkyWalking å®šä¹‰äº†ä¸‰ç§æ ¸å¿ƒç±»å‹çš„ Spanï¼Œè¿™å¯¹äºæ„å»ºå‡†ç¡®çš„æœåŠ¡æ‹“æ‰‘è‡³å…³é‡è¦ ï¼š</p>
<ol>
<li>
<p><strong>Entry Spanï¼ˆå…¥å£ Spanï¼‰</strong> ï¼š</p>
<ul>
<li><strong>å®šä¹‰</strong>ï¼šè¡¨ç¤ºè¯·æ±‚è¿›å…¥æŸä¸ªæœåŠ¡çš„å…¥å£æ“ä½œã€‚ä¾‹å¦‚ï¼ŒSpring MVC çš„ Controller æ¥æ”¶åˆ° HTTP è¯·æ±‚ï¼Œæˆ–è€… Dubbo Provider æ¥æ”¶åˆ° RPC è°ƒç”¨ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šå®ƒæ˜¯æœåŠ¡æ‹“æ‰‘å›¾èŠ‚ç‚¹çš„â€œæœåŠ¡ç«¯â€æ ‡è¯†ã€‚SkyWalking ä¾é  Entry Span æ¥è¯†åˆ«â€œè°åœ¨æä¾›æœåŠ¡â€ã€‚è¿™ä¹Ÿæ˜¯æå–ä¸Šæ¸¸ä¼ é€’è¿‡æ¥çš„ä¸Šä¸‹æ–‡ï¼ˆContext Propagationï¼‰çš„åœ°æ–¹ã€‚</li>
</ul>
</li>
<li>
<p><strong>Exit Spanï¼ˆå‡ºå£ Spanï¼‰</strong> ï¼š</p>
<ul>
<li><strong>å®šä¹‰</strong>ï¼šè¡¨ç¤ºè¯·æ±‚ç¦»å¼€å½“å‰æœåŠ¡ï¼Œå»è°ƒç”¨å¤–éƒ¨ç»„ä»¶çš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ HttpClient è°ƒç”¨ç¬¬ä¸‰æ–¹ APIï¼Œæˆ–è€…ä½¿ç”¨ JDBC é©±åŠ¨æŸ¥è¯¢ MySQL æ•°æ®åº“ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šå®ƒæ˜¯æœåŠ¡æ‹“æ‰‘å›¾è¿çº¿çš„â€œå®¢æˆ·ç«¯â€æ ‡è¯†ã€‚Exit Span è´Ÿè´£å°†å½“å‰æœåŠ¡çš„ä¸Šä¸‹æ–‡æ³¨å…¥åˆ°è¯·æ±‚å¤´ä¸­ï¼Œä¼ é€’ç»™ä¸‹æ¸¸ã€‚å®ƒåŒæ—¶ä¹Ÿæ˜¯è®¡ç®—ç½‘ç»œè€—æ—¶ï¼ˆNetwork Latencyï¼‰çš„å…³é”®ä¾æ®ã€‚</li>
</ul>
</li>
<li>
<p><strong>Local Spanï¼ˆæœ¬åœ° Spanï¼‰</strong> ï¼š</p>
<ul>
<li><strong>å®šä¹‰</strong>ï¼šè¡¨ç¤ºè¿›ç¨‹å†…éƒ¨çš„æœ¬åœ°æ–¹æ³•è°ƒç”¨ï¼Œä¸æ¶‰åŠç½‘ç»œäº¤äº’ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šç”¨äºä»£ç çº§åˆ«çš„æ€§èƒ½åˆ†æã€‚ä¾‹å¦‚ï¼Œæ ‡è®°ä¸€ä¸ªå¤æ‚çš„æœ¬åœ°è®¡ç®—é€»è¾‘æˆ–å†…å­˜ç¼“å­˜è¯»å–æ“ä½œã€‚Local Span ä¸°å¯Œäº†é“¾è·¯ç«ç„°å›¾çš„ç»†èŠ‚ï¼Œä½†ä¸ä¼šå½±å“æœåŠ¡é—´çš„æ‹“æ‰‘å…³ç³»ã€‚</li>
</ul>
</li>
</ol>
<h4 data-id="heading-8">3.4 TraceID ç”Ÿæˆç®—æ³•å‰–æ</h4>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç”Ÿæˆå…¨å±€å”¯ä¸€ ID è€Œä¸ä¾èµ–ä¸­å¿ƒåŒ–çš„å‘å·å™¨ï¼ˆå¦‚ Redis è‡ªå¢æˆ– Snowflake æœåŠ¡ï¼‰æ˜¯ä¸€é¡¹æŒ‘æˆ˜ã€‚SkyWalking é‡‡ç”¨äº†å»ä¸­å¿ƒåŒ–çš„ç”Ÿæˆç­–ç•¥ï¼Œå…¶ TraceID æ ¼å¼é€šå¸¸ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œé€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥è€Œæˆï¼Œä»¥ç¡®ä¿åœ¨æé«˜å¹¶å‘ä¸‹çš„å”¯ä¸€æ€§ ï¼š</p>
<ul>
<li><strong>Part 1: Application Instance ID</strong>ï¼šåº”ç”¨å®ä¾‹çš„å”¯ä¸€æ ‡è¯†ã€‚åœ¨ Agent å¯åŠ¨æ—¶ï¼Œä¼šé€šè¿‡ UUID æˆ–ç‰¹å®šçš„ç¯å¢ƒæŒ‡çº¹ç”Ÿæˆè¯¥ IDã€‚è¿™ç¡®ä¿äº†ä¸åŒæœåŠ¡å™¨ç”Ÿæˆçš„ ID ç»ä¸å†²çªã€‚</li>
<li><strong>Part 2: Thread ID</strong>ï¼šå½“å‰çº¿ç¨‹çš„ IDã€‚è¿™ç¡®ä¿äº†åŒä¸€å°æœåŠ¡å™¨ä¸Šä¸åŒçº¿ç¨‹å¤„ç†çš„è¯·æ±‚ ID ä¸å†²çªã€‚</li>
<li><strong>Part 3: Timestamp &amp; Sequence</strong>ï¼šæ¯«ç§’çº§æ—¶é—´æˆ³åŠ ä¸Šä¸€ä¸ªé€’å¢çš„åºåˆ—å·ã€‚è¿™ç¡®ä¿äº†åŒä¸€ä¸ªçº¿ç¨‹åœ¨ä¸åŒæ—¶é—´å¤„ç†çš„è¯·æ±‚ ID ä¸å†²çªã€‚</li>
</ul>
<p>è¿™ç§ç»“æ„ï¼ˆ<code>InstanceID</code> + <code>ThreadID</code> + <code>Seq</code>ï¼‰çš„è®¾è®¡ä¸ä»…ä¿è¯äº†å”¯ä¸€æ€§ï¼Œè¿˜å…·æœ‰ä¸€å®šçš„å¯è¯»æ€§ã€‚åœ¨æ’æŸ¥é—®é¢˜æ—¶ï¼Œæœ‰ç»éªŒçš„å¼€å‘è€…ç”šè‡³å¯ä»¥ç›´æ¥ä» TraceID ä¸­æ¨æ–­å‡ºæ˜¯å“ªå°æœºå™¨ã€å“ªä¸ªçº¿ç¨‹äº§ç”Ÿçš„è¯·æ±‚ï¼Œè¿™åœ¨å¤æ‚çš„æ•…éšœç°åœºéå¸¸æœ‰ç”¨ã€‚</p>
<h4 data-id="heading-9">3.5 è·¨è¿›ç¨‹åˆ†å¸ƒå¼ä¸Šä¸‹æ–‡ä¼ æ’­ï¼šæ”¾åœ¨è¯·æ±‚å¤´ä¸­</h4>
<p>åˆ†å¸ƒå¼è¿½è¸ªçš„â€œçµé­‚â€åœ¨äºä¸Šä¸‹æ–‡ä¼ æ’­ï¼ˆContext Propagationï¼‰ã€‚å½“æœåŠ¡ A è°ƒç”¨æœåŠ¡ B æ—¶ï¼ŒA å¿…é¡»å‘Šè¯‰ Bï¼šâ€œæˆ‘æ˜¯ Aï¼Œè¿™æ˜¯æˆ‘çš„ TraceIDï¼Œè¿™æ˜¯æˆ‘çš„ SegmentIDã€‚â€ å¦åˆ™ï¼ŒB å°†ç”Ÿæˆä¸€ä¸ªæ–°çš„ TraceIDï¼Œå¯¼è‡´é“¾è·¯æ–­è£‚ã€‚</p>
<p>SkyWalking ä½¿ç”¨äº†è‡ªå®šä¹‰çš„è·¨è¿›ç¨‹ä¼ æ’­åè®®ï¼Œåœ¨ HTTP è¯·æ±‚å¤´æˆ– RPC å…ƒæ•°æ®ä¸­æºå¸¦å…³é”®ä¿¡æ¯ã€‚ç›®å‰ä¸»æµçš„ç‰ˆæœ¬æ˜¯ 3.0 åè®®ï¼Œå¯¹åº”çš„ Header é”®åä¸º <code>sw8</code></p>
<h4 data-id="heading-10">3.6 è·¨çº¿ç¨‹ä¼ æ’­ï¼šContextSnapshot</h4>
<p>é™¤äº†è·¨è¿›ç¨‹ï¼ŒJava åº”ç”¨ä¸­å¹¿æ³›å­˜åœ¨çš„å¼‚æ­¥è°ƒç”¨ï¼ˆçº¿ç¨‹æ± ã€CompletableFutureã€æ¶ˆæ¯é˜Ÿåˆ—ç›‘å¬ï¼‰ä¹Ÿç»™ä¸Šä¸‹æ–‡ä¼ æ’­å¸¦æ¥äº†æŒ‘æˆ˜ã€‚å¦‚æœ Trace ä¸Šä¸‹æ–‡å­˜å‚¨åœ¨ <code>ThreadLocal</code> ä¸­ï¼Œå½“ä»»åŠ¡è¢«æäº¤åˆ°å¦ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œä¸Šä¸‹æ–‡å°±ä¼šä¸¢å¤± ã€‚</p>
<p>SkyWalking é€šè¿‡ <strong>Context Captureï¼ˆæ•è·ï¼‰</strong> å’Œ <strong>Context Restoreï¼ˆæ¢å¤ï¼‰</strong> æœºåˆ¶è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p>
<ol>
<li><strong>æ•è·ï¼ˆCaptureï¼‰</strong> ï¼šå½“ä¸»çº¿ç¨‹æäº¤ä»»åŠ¡æ—¶ï¼ˆä¾‹å¦‚è°ƒç”¨ <code>executor.submit</code>ï¼‰ï¼ŒAgent æ‹¦æˆªè¯¥è°ƒç”¨ï¼Œå¹¶å¯¹å½“å‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡æ‹ä¸€å¼ â€œå¿«ç…§â€ï¼ˆ<code>ContextSnapshot</code>ï¼‰ã€‚è¿™ä¸ªå¿«ç…§åŒ…å«äº† TraceIDã€SegmentID ç­‰æ ¸å¿ƒä¿¡æ¯ã€‚</li>
<li><strong>æºå¸¦ï¼ˆCarrierï¼‰</strong> ï¼šAgent å°†è¿™ä¸ªå¿«ç…§å°è£…åˆ°è¢«æäº¤çš„ä»»åŠ¡å¯¹è±¡ï¼ˆRunnable/Callableï¼‰ä¸­ã€‚</li>
<li><strong>æ¢å¤ï¼ˆContinuedï¼‰</strong> ï¼šå½“å­çº¿ç¨‹å¼€å§‹æ‰§è¡Œä»»åŠ¡æ—¶ï¼ŒAgent å†æ¬¡æ‹¦æˆªæ‰§è¡Œæ–¹æ³•ï¼Œè¯»å–ä»»åŠ¡å¯¹è±¡ä¸­çš„å¿«ç…§ï¼Œå¹¶å°†å…¶æ³¨å…¥åˆ°å­çº¿ç¨‹çš„ <code>ThreadLocal</code> ä¸­ã€‚</li>
</ol>
<p>è¿™ç§æœºåˆ¶ç¡®ä¿äº†æ— è®ºæ˜¯åŒæ­¥è°ƒç”¨è¿˜æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œé“¾è·¯çš„è¿ç»­æ€§éƒ½èƒ½å¾—åˆ°ä¿è¯ã€‚å¯¹äºç”¨æˆ·è‡ªå®šä¹‰çš„çº¿ç¨‹æ± æˆ–éå¸¸è§„çš„å¼‚æ­¥æ¡†æ¶ï¼ŒSkyWalking æä¾›äº† <code>apm-toolkit-trace</code> å·¥å…·åŒ…ï¼Œå…è®¸å¼€å‘è€…æ‰‹åŠ¨è°ƒç”¨ <code>TraceContext.capture()</code> å’Œ <code>ContextManager.continued()</code> æ¥è¾…åŠ©ä¼ æ’­ï¼Œè¿™åœ¨å¤„ç†é—ç•™ç³»ç»Ÿæˆ–ç§æœ‰æ¡†æ¶æ—¶å°¤ä¸ºæœ‰ç”¨ã€‚</p>
<p>è¿™ä¸ªå¥—è·¯å’Œé˜¿é‡Œå¼€æºçš„<code>TransmittableThreadLocal</code>è§£å†³å¤šçº¿ç¨‹å¼‚æ­¥ä¸Šä¸‹æ–‡ä¼ é€’çš„æ¡†æ¶å¥—è·¯æ˜¯ä¸€æ ·çš„ï¼Œè¯¦è§£ä¹‹å‰æˆ‘ä»¬æ€»ç»“åˆ†äº«çš„ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FJC43Ojbo0YNIaYGH_6D_vQ" target="_blank" title="https://mp.weixin.qq.com/s/JC43Ojbo0YNIaYGH_6D_vQ" ref="nofollow noopener noreferrer">è°ˆè°ˆTransmittableThreadLocalå®ç°åŸç†å’Œåœ¨æ—¥å¿—æ”¶é›†è®°å½•ç³»ç»Ÿä¸Šä¸‹æ–‡å®æˆ˜åº”ç”¨</a></p>
<h2 data-id="heading-11">4. æ—¥å¿—ä¸é“¾è·¯çš„èåˆï¼šLog4j2/Logback æ•´åˆå®æˆ˜</h2>
<p>åœ¨æ•…éšœæ’æŸ¥ä¸­ï¼ŒTrace å‘Šè¯‰æˆ‘ä»¬â€œå“ªé‡Œæ…¢äº†â€æˆ–â€œå“ªé‡ŒæŠ¥é”™äº†â€ï¼Œè€Œ Log å‘Šè¯‰æˆ‘ä»¬â€œä¸ºä»€ä¹ˆé”™â€ã€‚ä¼ ç»Ÿçš„ç›‘æ§æ–¹æ¡ˆä¸­ï¼ŒTraceID å’Œæ—¥å¿—æ˜¯åˆ†ç¦»çš„ï¼Œè¿ç»´äººå‘˜ç»å¸¸éœ€è¦åœ¨ SkyWalking çœ‹åˆ°é”™è¯¯åï¼Œå†å» ELKï¼ˆElasticsearch, Logstash, Kibanaï¼‰ä¸­æ ¹æ®æ—¶é—´æˆ³å¤§æµ·æé’ˆã€‚</p>
<p>SkyWalking æä¾›äº†æ—¥å¿—ä¸é“¾è·¯çš„æ·±åº¦èåˆæ–¹æ¡ˆï¼Œå³ <strong>Log &amp; Trace Correlation</strong>ã€‚å…¶æ ¸å¿ƒç›®æ ‡æ˜¯ï¼šåœ¨æ¯ä¸€è¡Œæ—¥å¿—ä¸­è‡ªåŠ¨æ³¨å…¥å½“å‰çš„ TraceIDï¼Œå¹¶ä¸”èƒ½å¤Ÿå°†æ—¥å¿—å†…å®¹ç›´æ¥é‡‡é›†åˆ° SkyWalking åç«¯è¿›è¡Œå±•ç¤ºã€‚</p>
<h4 data-id="heading-12">4.1 åŸç†ï¼šMDC ä¸ ThreadLocal çš„æ¡¥æ¢</h4>
<p>æ— è®ºæ˜¯ Log4j2 è¿˜æ˜¯ Logbackï¼Œéƒ½æ”¯æŒ MDCï¼ˆMapped Diagnostic Contextï¼‰æœºåˆ¶ã€‚SkyWalking Agent åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæ‹¦æˆªæ—¥å¿—æ¡†æ¶çš„äº‹ä»¶å¤„ç†æµç¨‹ï¼Œå°†å½“å‰ Trace Context ä¸­çš„ TraceID æ³¨å…¥åˆ° MDC ä¸­ï¼Œæˆ–è€…é€šè¿‡è‡ªå®šä¹‰çš„ Layout/Converter ç›´æ¥ä¿®æ”¹æ—¥å¿—è¾“å‡ºæ ¼å¼ã€‚</p>
<h4 data-id="heading-13">4.2 Log4j2 æ•´åˆæ·±åº¦æŒ‡å—</h4>
<p>å¯¹äºä½¿ç”¨ Log4j2 çš„åº”ç”¨ï¼Œæ•´åˆè¿‡ç¨‹åˆ†ä¸ºä¾èµ–å¼•å…¥å’Œé…ç½®ä¿®æ”¹ä¸¤æ­¥ ã€‚</p>
<p>é¦–å…ˆï¼Œå¿…é¡»å¼•å…¥ <code>apm-toolkit-log4j-2.x</code> ä¾èµ–ã€‚</p>
<p><strong>åœºæ™¯ä¸€ï¼šä»…åœ¨æ—¥å¿—æ–‡ä»¶ä¸­æ‰“å° TraceID</strong> è¿™æ˜¯æœ€åŸºç¡€çš„éœ€æ±‚ã€‚é€šè¿‡ä¿®æ”¹ <code>log4j2.xml</code> çš„ <code>PatternLayout</code>ï¼Œä½¿ç”¨ <code>%traceId</code> å ä½ç¬¦ã€‚</p>
<pre><code class="hljs language-perl" lang="perl">&lt;Appenders&gt;
 Â  &lt;Console name=<span class="hljs-string">"Console"</span> target=<span class="hljs-string">"SYSTEM_OUT"</span>&gt;
 Â  Â  Â &lt;PatternLayout pattern=<span class="hljs-string">"%d [%traceId] %-5p %c{1}:%L - %m%n"</span>/&gt;
 Â  &lt;<span class="hljs-regexp">/Console&gt;
&lt;/</span>Appenders&gt;
</code></pre>
<p>å½“ SkyWalking Agent æ¿€æ´»æ—¶ï¼Œ<code>%traceId</code> ä¼šè¢«è‡ªåŠ¨æ›¿æ¢ä¸ºçœŸå®çš„ IDï¼›å¦‚æœæœªæ¿€æ´»ï¼Œåˆ™æ˜¾ç¤º <code>TID: N/A</code>ã€‚</p>
<p><strong>åœºæ™¯äºŒï¼šå¼‚æ­¥æ—¥å¿—ï¼ˆAsync Loggerï¼‰çš„æŒ‘æˆ˜</strong> ç”Ÿäº§ç¯å¢ƒé€šå¸¸ä½¿ç”¨ Log4j2 çš„é«˜æ€§èƒ½å¼‚æ­¥æ—¥å¿—ï¼ˆåŸºäº LMAX Disruptorï¼‰ã€‚è¿™é‡Œå­˜åœ¨ä¸€ä¸ªéšè”½çš„å‘ï¼šæ—¥å¿—äº‹ä»¶åœ¨ä¸»çº¿ç¨‹ç”Ÿæˆï¼Œä½†ç”±åå°çº¿ç¨‹å†™å…¥ç£ç›˜ã€‚å¦‚æœä»…ä»…ä¾èµ–ç®€å•çš„ ThreadLocalï¼Œåå°çº¿ç¨‹æ— æ³•è·å–ä¸»çº¿ç¨‹çš„ TraceIDã€‚ SkyWalking çš„ Toolkit é€šè¿‡å¢å¼º Log4j2 çš„ <code>LogEvent</code> å·¥å‚ï¼Œåœ¨<strong>äº‹ä»¶ç”Ÿæˆçš„ä¸€ç¬é—´</strong>ï¼ˆä¸»çº¿ç¨‹ï¼‰æ•è· TraceID å¹¶å›ºåŒ–åœ¨äº‹ä»¶å¯¹è±¡ä¸­ï¼Œä»è€Œå®Œç¾æ”¯æŒäº†å¼‚æ­¥æ—¥å¿—åœºæ™¯ã€‚è¿™æ— éœ€å¤æ‚çš„é¢å¤–é…ç½®ï¼Œåªéœ€ç¡®ä¿ä¾èµ–æ­£ç¡®ã€‚</p>
<p><strong>åœºæ™¯ä¸‰ï¼šæ—¥å¿—ä¸ŠæŠ¥è‡³ SkyWalking OAP</strong> ä¸ºäº†åœ¨ SkyWalking UI çš„â€œæ—¥å¿—â€æ ‡ç­¾é¡µç›´æ¥æŸ¥çœ‹æ—¥å¿—ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>GRPCLogClientAppender</code>ã€‚è¿™é€šè¿‡ gRPC é€šé“ç›´æ¥å°†æ—¥å¿—æµå¼ä¼ è¾“ç»™åç«¯ï¼Œçœå»äº†é¢å¤–éƒ¨ç½² Filebeat/Logstash çš„æˆæœ¬ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">&lt;GRPCLogClientAppender <span class="hljs-attr">name</span>=<span class="hljs-string">"grpc-log"</span>&gt;
 Â  Â &lt;PatternLayout <span class="hljs-attr">pattern</span>=<span class="hljs-string">"%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n"</span>/&gt;
&lt;/GRPCLogClientAppender&gt;
</code></pre>
<p>å¼€å¯æ­¤åŠŸèƒ½åï¼Œæ¯æ¡æ—¥å¿—éƒ½ä¼šè‡ªåŠ¨å…³è”å½“å‰ Spanï¼Œå®ç°â€œç‚¹å‡» Span -&gt; æŸ¥çœ‹ç›¸å…³æ—¥å¿—â€çš„ä¸æ»‘ä½“éªŒã€‚</p>
<h4 data-id="heading-14">4.3 Logback æ•´åˆæ·±åº¦æŒ‡å—</h4>
<p>Logback çš„æ•´åˆé€»è¾‘ç±»ä¼¼ï¼Œä½¿ç”¨ <code>apm-toolkit-logback-1.x</code> ã€‚ ä¾èµ–å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"> Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.skywalking<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>apm-toolkit-logback-1.x<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>9.5.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
 Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>logbacké…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
â€‹
<span class="hljs-tag">&lt;<span class="hljs-name">configuration</span> <span class="hljs-attr">scan</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">scanPeriod</span>=<span class="hljs-string">" 10 seconds"</span>&gt;</span>
â€‹
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">appender</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"stdout"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.core.ConsoleAppender"</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.core.encoder.LayoutWrappingEncoder"</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">layout</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"org.apache.skywalking.apm.toolkit.log.logback.v1.x.mdc.TraceIdMDCPatternLogbackLayout"</span>&gt;</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">Pattern</span>&gt;</span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%X{tid}] [%thread] %-5level %logger{36} -%msg%n<span class="hljs-tag">&lt;/<span class="hljs-name">Pattern</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">layout</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">encoder</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">appender</span>&gt;</span>
â€‹
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">appender</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"grpc-log"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"org.apache.skywalking.apm.toolkit.log.logback.v1.x.log.GRPCLogClientAppender"</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.core.encoder.LayoutWrappingEncoder"</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">layout</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"org.apache.skywalking.apm.toolkit.log.logback.v1.x.mdc.TraceIdMDCPatternLogbackLayout"</span>&gt;</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">Pattern</span>&gt;</span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%X{tid}] [%thread] %-5level %logger{36} -%msg%n<span class="hljs-tag">&lt;/<span class="hljs-name">Pattern</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">layout</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">encoder</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">appender</span>&gt;</span>
â€‹
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">appender</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"fileAppender"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.core.FileAppender"</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">file</span>&gt;</span>./logs/shepherd-demo01.log<span class="hljs-tag">&lt;/<span class="hljs-name">file</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.core.encoder.LayoutWrappingEncoder"</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">layout</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"org.apache.skywalking.apm.toolkit.log.logback.v1.x.TraceIdPatternLogbackLayout"</span>&gt;</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">Pattern</span>&gt;</span>[%sw_ctx] [%level] %d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %logger:%line - %msg%n<span class="hljs-tag">&lt;/<span class="hljs-name">Pattern</span>&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">layout</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">encoder</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">appender</span>&gt;</span>
â€‹
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">root</span> <span class="hljs-attr">level</span>=<span class="hljs-string">"INFO"</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"grpc-log"</span>/&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"stdout"</span>/&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"fileLogger"</span> <span class="hljs-attr">level</span>=<span class="hljs-string">"INFO"</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"fileAppender"</span>/&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">logger</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
</code></pre>
<p><strong>é…ç½®è¦ç‚¹</strong>ï¼š Logback éœ€è¦ä½¿ç”¨ SkyWalking æä¾›çš„ç‰¹å®š Encoder ç±» <code>TraceIdPatternLogbackLayout</code> æ¥è§£æ <code>%tid</code>ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">&lt;appender <span class="hljs-attr">name</span>=<span class="hljs-string">"STDOUT"</span> class=<span class="hljs-string">"ch.qos.logback.core.ConsoleAppender"</span>&gt;
 Â  Â &lt;encoder <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.core.encoder.LayoutWrappingEncoder"</span>&gt;
 Â  Â  Â  Â &lt;layout <span class="hljs-attr">class</span>=<span class="hljs-string">"org.apache.skywalking.apm.toolkit.log.logback.v1.x.TraceIdPatternLogbackLayout"</span>&gt;
 Â  Â  Â  Â  Â  Â &lt;Pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} <span class="hljs-section">[%tid]</span><span class="hljs-section">[%thread]</span> %-5level %logger{36} -%msg%n&lt;/Pattern&gt;
 Â  Â  Â  Â &lt;/layout&gt;
 Â  Â &lt;/encoder&gt;
&lt;/appender&gt;
</code></pre>
<p>å¯¹äºç»“åˆ Logstash ä½¿ç”¨ JSON æ ¼å¼è¾“å‡ºçš„åœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>TraceIdMDCPatternLogbackLayout</code> å°† TraceID æ³¨å…¥åˆ° MDC ä¸­ï¼Œç„¶ååœ¨ JSON æ¨¡æ¿ä¸­å¼•ç”¨ <code>%X{tid}</code>ã€‚</p>
<p>è¯·æ±‚æ¥å£ï¼ŒæŸ¥çœ‹<strong>SkyWalking UIï¼š</strong> è¿›å…¥ <strong>Log (æ—¥å¿—)</strong> æ ‡ç­¾é¡µï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b461b47fa37442c38a1a4833f5876bf1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2hlcGhlcmQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173217&amp;x-signature=d7ggi4mYa83RDHguk6C%2FbqiNHrY%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-15">5.å¾®æœåŠ¡æ•´åˆå®æˆ˜</h2>
<p>æˆ‘ä»¬çŸ¥é“Skywalkingå°±æ˜¯ä¸ºäº‘åŸç”Ÿã€å¾®æœåŠ¡è€Œç”Ÿçš„ã€‚è¿™é‡Œæˆ‘ä»¬å±•ç¤ºä¸‹åœ¨å¾®æœåŠ¡ä¸­çš„åº”ç”¨ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘å‡†å¤‡äº†ä¸‰ä¸ªæœåŠ¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a05fef76c9cf4d828dc9025bdfb6ff7a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2hlcGhlcmQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173217&amp;x-signature=gflEfuxpQT9rm8GSByRl%2B04hACo%3D" alt="" loading="lazy"/></p>
<p>è¿™é‡Œæˆ‘å†™ä¸€ä¸ªç¤ºä¾‹æ¥å£ï¼Œè°ƒç”¨é“¾è·¯æ˜¯è¿™æ ·çš„ï¼š<code>demo3â†’demo2-demo1â†’MySQLæˆ–è€…Redis</code></p>
<p>è¯·æ±‚æ¥å£ï¼Œåœ¨uiç•Œé¢æŸ¥çœ‹æ‹“æ‰‘å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3658400c91ca4943960282407e55fe53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2hlcGhlcmQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173217&amp;x-signature=c2G8LtoWj%2Fdu6seQnHQYyhRVFC8%3D" alt="" loading="lazy"/></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œè°ƒç”¨é“¾è·¯éå¸¸æ¸…æ¥šæ˜äº†ã€‚</p>
<h2 data-id="heading-16">6.ç”Ÿäº§ç¯å¢ƒå®æˆ˜ç­–ç•¥ï¼šé‡‡æ ·ã€è¿‡æ»¤ä¸æ•…éšœæ’æŸ¥</h2>
<p>åœ¨å¼€å‘ç¯å¢ƒè·‘é€š SkyWalking åªæ˜¯ç¬¬ä¸€æ­¥ï¼ŒçœŸæ­£çš„æŒ‘æˆ˜åœ¨äºå¦‚ä½•åœ¨æµ·é‡æµé‡çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ—¢ä¿è¯ç›‘æ§çš„æœ‰æ•ˆæ€§ï¼Œåˆä¸æ‹–å®ä¸šåŠ¡ç³»ç»Ÿå’Œç›‘æ§è‡ªèº«ã€‚</p>
<h4 data-id="heading-17">6.1 é‡‡æ ·ç­–ç•¥ï¼šèˆå¼ƒçš„è‰ºæœ¯</h4>
<p>å…¨é‡é‡‡é›†æ‰€æœ‰ Trace åœ¨é«˜å¹¶å‘ç³»ç»Ÿæ˜¯ä¸ç°å®çš„ï¼Œæ—¢æµªè´¹å­˜å‚¨ä¹Ÿæµªè´¹å¸¦å®½ã€‚é‡‡æ ·ï¼ˆSamplingï¼‰æ˜¯å¿…é¡»çš„æ‰‹æ®µã€‚</p>
<p><strong>å¤´éƒ¨é‡‡æ ·ï¼ˆHead Samplingï¼‰</strong> ï¼š è¿™æ˜¯æœ€å¸¸ç”¨çš„ç­–ç•¥ï¼Œç”± Agent å†³å®šæ˜¯å¦é‡‡é›†ã€‚</p>
<ul>
<li><strong>å›ºå®šé¢‘ç‡é‡‡æ ·</strong>ï¼šé…ç½® <code>agent.sample_n_per_3_secs</code> ã€‚ä¾‹å¦‚è®¾ç½®ä¸º <code>100</code>ï¼Œè¡¨ç¤ºæ¯ 3 ç§’æœ€å¤šé‡‡é›† 100 æ¡ Traceã€‚å…¶ä½™çš„è¯·æ±‚å°†åªé€šè¿‡ Header ä¼ é€’ TraceIDï¼ˆä¿è¯ä¸‹æ¸¸èƒ½ä¸²è”ï¼‰ï¼Œä½†ä¸è®°å½• Span è¯¦æƒ…ã€‚</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šç›´æ¥ä¿æŠ¤äº† Agent å’Œ OAP çš„è®¡ç®—å‹åŠ›ï¼Œä»æºå¤´æ§åˆ¶æµé‡ã€‚</li>
</ul>
<p><strong>å°¾éƒ¨é‡‡æ ·ï¼ˆTail Samplingï¼‰ä¸å¼‚å¸¸ä¿ç•™</strong>ï¼š å•çº¯çš„éšæœºé‡‡æ ·å¯èƒ½ä¼šæ¼æ‰é‚£äº›çœŸæ­£é‡è¦çš„â€œå¼‚å¸¸è¯·æ±‚â€ã€‚æˆ‘ä»¬ä¸å…³å¿ƒ 99.9% çš„ HTTP 200 è¯·æ±‚ï¼Œä½†ç»ä¸èƒ½æ”¾è¿‡é‚£ 0.1% çš„ HTTP 500ã€‚ SkyWalking åç«¯æ”¯æŒ <strong>å¼ºåˆ¶é‡‡æ ·å¼‚å¸¸æ®µ</strong>ï¼ˆForce Sample Error Segmentï¼‰ã€‚å³ä¾¿æ ¹æ®é‡‡æ ·ç‡è¯¥è¯·æ±‚åº”è¢«ä¸¢å¼ƒï¼Œå¦‚æœ Agent æ ‡è®°è¯¥ Segment å‘ç”Ÿäº† Errorï¼ˆå¦‚æŠ›å‡ºå¼‚å¸¸ï¼‰ï¼ŒOAP ä¾ç„¶ä¼šå¼ºåˆ¶å°†å…¶ä¿ç•™å¹¶å­˜å‚¨ã€‚è¿™æ˜¯ç”Ÿäº§ç¯å¢ƒå¿…é¡»å¼€å¯çš„â€œä¿å‘½â€é…ç½®ã€‚</p>
<h4 data-id="heading-18">6.2 æ— æ•ˆè¿‡æ»¤ï¼šTrace Ignore Plugin</h4>
<p>æŸäº›å¿ƒè·³æ£€æµ‹æ¥å£ï¼ˆå¦‚ <code>/actuator/health</code>ï¼‰ã€ç›‘æ§æ‰“ç‚¹æ¥å£æˆ–é¢‘ç¹è½®è¯¢çš„é…ç½®æ¥å£ï¼Œä¼šäº§ç”Ÿæµ·é‡çš„åƒåœ¾ Traceï¼Œæ·¹æ²¡çœŸå®çš„ä¸šåŠ¡è¯·æ±‚ã€‚</p>
<p><strong>å®æˆ˜é…ç½®</strong> ï¼š ä½¿ç”¨ <code>apm-trace-ignore-plugin</code> æ˜¯æœ€ä½³å®è·µã€‚</p>
<ol>
<li>å°† <code>optional-plugins</code> ç›®å½•ä¸‹çš„ <code>apm-trace-ignore-plugin-x.jar</code> å¤åˆ¶åˆ° <code>plugins</code> ç›®å½•ã€‚</li>
<li>åˆ›å»ºé…ç½®æ–‡ä»¶ <code>/agent/config/apm-trace-ignore-plugin.config</code>ã€‚</li>
<li>é…ç½®è§„åˆ™ï¼š<code>trace.ignore_path=/health/**,/eureka/**</code>ã€‚ æ”¯æŒ Ant é£æ ¼çš„è·¯å¾„åŒ¹é…ï¼Œé…ç½®åï¼Œè¿™äº›è·¯å¾„çš„è¯·æ±‚å°†å®Œå…¨ä¸è¢«é‡‡é›†ï¼Œæå¤§åœ°å‡€åŒ–äº†ç›‘æ§æ•°æ®ã€‚</li>
</ol>
<h3 data-id="heading-19">6.3 å¸¸è§æ•…éšœæ’æŸ¥ï¼šæ•°æ®ä¸¢å¤±ä¹‹è°œ</h3>
<p>è¿ç»´ SkyWalking æ—¶ï¼Œæœ€å¸¸å¬åˆ°çš„æŠ±æ€¨æ˜¯â€œæˆ‘çš„ Trace æ€ä¹ˆæ–­äº†ï¼Ÿâ€æˆ–â€œä¸ºä»€ä¹ˆæŸ¥ä¸åˆ°æ•°æ®ï¼Ÿâ€ã€‚è¿™é€šå¸¸å½’ç»“ä¸ºä¸‰å¤§ç“¶é¢ˆ ï¼š</p>
<ol>
<li>
<p><strong>Agent å‘é€ç¼“å†²åŒºæº¢å‡º</strong>ï¼š</p>
<ul>
<li><strong>ç°è±¡</strong>ï¼šAgent æ—¥å¿—å‡ºç° <code>DataCarrier is full</code> æˆ– <code>Queue full</code>ã€‚</li>
<li><strong>åŸå› </strong>ï¼šä¸šåŠ¡äº§ç”Ÿ Trace çš„é€Ÿåº¦è¶…è¿‡äº† Agent å‘é€ç»™ OAP çš„ç½‘ç»œé€Ÿåº¦ã€‚</li>
<li><strong>å¯¹ç­–</strong>ï¼šå¢å¤§ <code>agent.channel_size</code> é…ç½®ï¼Œæˆ–è€…æ£€æŸ¥ Agent åˆ° OAP çš„ç½‘ç»œå¸¦å®½å’Œå»¶è¿Ÿã€‚</li>
</ul>
</li>
<li>
<p><strong>OAP æ¥æ”¶é˜Ÿåˆ—å µå¡</strong>ï¼š</p>
<ul>
<li><strong>ç°è±¡</strong>ï¼šOAP ç›‘æ§æŒ‡æ ‡ä¸­ï¼Œæ¥æ”¶é˜Ÿåˆ—å ç”¨ç‡æŒç»­ 100%ï¼Œæˆ–è€…æ—¥å¿—æŠ¥é”™ <code>persistence queue is full</code>ã€‚</li>
<li><strong>åŸå› </strong>ï¼šOAP çš„æ¶ˆè´¹èƒ½åŠ›ï¼ˆåˆ†ææˆ–å†™å…¥å­˜å‚¨ï¼‰è·Ÿä¸ä¸Š Agent çš„ä¸ŠæŠ¥é€Ÿåº¦ã€‚</li>
<li><strong>å¯¹ç­–</strong>ï¼šæ¨ªå‘æ‰©å±• OAP èŠ‚ç‚¹ï¼›ä¼˜åŒ–å­˜å‚¨ï¼ˆå¦‚ä¸Šæ–‡çš„ ES è°ƒä¼˜ï¼‰ï¼›æˆ–è€…é™ä½é‡‡æ ·ç‡ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ—¶é—´åå·®ï¼ˆTime Skewï¼‰</strong> ï¼š</p>
<ul>
<li><strong>ç°è±¡</strong>ï¼šTrace æ•°æ®å­˜åœ¨ï¼Œä½†åœ¨ UI ä¸ŠæŸ¥è¯¢ä¸åˆ°ï¼Œæˆ–è€…æ‹“æ‰‘å›¾æ˜¾ç¤ºå¼‚å¸¸ã€‚</li>
<li><strong>åŸå› </strong>ï¼šAgent æ‰€åœ¨æœåŠ¡å™¨ä¸ OAP æœåŠ¡å™¨æ—¶é—´ä¸ä¸€è‡´ã€‚SkyWalking å¯¹æ—¶é—´éå¸¸æ•æ„Ÿã€‚</li>
<li><strong>å¯¹ç­–</strong>ï¼šç¡®ä¿æ‰€æœ‰æœåŠ¡å™¨å¼€å¯ NTP æ—¶é—´åŒæ­¥ã€‚</li>
</ul>
</li>
</ol>
<h2 data-id="heading-20">7.æ€»ç»“</h2>
<p>å¯¹äºæŠ€æœ¯å›¢é˜Ÿè€Œè¨€ï¼ŒæŒæ¡ SkyWalking ä¸åº”æ­¢æ­¥äºâ€œå®‰è£…å¹¶è¿è¡Œâ€ã€‚æ·±å…¥ç†è§£å…¶å†…æ ¸åŸç†ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬åœ¨é¢å¯¹ç”Ÿäº§ç¯å¢ƒçš„æç«¯æŒ‘æˆ˜æ—¶ï¼Œä»å®¹åœ°è¿›è¡Œè°ƒä¼˜ã€è£å‰ªå’Œæ•…éšœæ’é™¤ï¼ŒçœŸæ­£å°†å¯è§‚æµ‹æ€§è½¬åŒ–ä¸ºç³»ç»Ÿçš„ç¨³å®šæ€§ä¿éšœã€‚éšç€ eBPF ç­‰æ–°æŠ€æœ¯çš„å¼•å…¥ï¼ŒSkyWalking çš„æ¼”è¿›ä»åœ¨ç»§ç»­ï¼Œè€Œæˆ‘ä»¬å¯¹ç³»ç»Ÿé€æ˜åº¦çš„è¿½æ±‚ï¼Œä¹Ÿæ°¸æ— æ­¢å¢ƒã€‚</p>
<p><strong>é™„å½•ï¼šç”Ÿäº§ç¯å¢ƒå…³é”®é…ç½®é€ŸæŸ¥è¡¨</strong></p>
<p>ä¸ºäº†æ–¹ä¾¿è¯»è€…å¿«é€Ÿè½åœ°ï¼Œä»¥ä¸‹æ•´ç†äº†ç”Ÿäº§ç¯å¢ƒæœ€å…³é”®çš„è°ƒä¼˜å‚æ•°è¡¨ï¼š</p>
<p><strong>Agent å…³é”®é…ç½® (agent.config)</strong></p>



































<table><thead><tr><th><strong>é…ç½®é¡¹é”®å</strong></th><th><strong>é»˜è®¤å€¼</strong></th><th><strong>å«ä¹‰</strong></th><th><strong>ç”Ÿäº§ç¯å¢ƒæ¨èä¸å»ºè®®</strong></th></tr></thead><tbody><tr><td><code>agent.service_name</code></td><td><code>Your_ApplicationName</code></td><td>æœåŠ¡é€»è¾‘åç§°</td><td><strong>å¿…å¡«</strong>ã€‚å¿…é¡»ç¡®ä¿æ¯ä¸ªå¾®æœåŠ¡å”¯ä¸€ï¼ˆå¦‚ <code>Order-Service</code>ï¼‰ï¼Œè¿™æ˜¯æ‹“æ‰‘èšåˆçš„åŸºç¡€ã€‚</td></tr><tr><td><code>agent.sample_n_per_3_secs</code></td><td><code>-1</code> (ä¸é™æµ)</td><td>æ¯ 3 ç§’é‡‡æ ·çš„æœ€å¤§ Trace æ•°</td><td>å»ºè®®è®¾ä¸º <code>100</code>-<code>500</code>ã€‚é˜²æ­¢æµé‡çªåˆºæ—¶ Agent æˆ– OAP è¢«æ‰“å®ï¼Œèµ·åˆ°å‰Šå³°ä½œç”¨ã€‚</td></tr><tr><td><code>agent.ignore_suffix</code></td><td><code>.jpg,.jpeg...</code></td><td>å¿½ç•¥çš„è¯·æ±‚åç¼€</td><td>å»ºè®®è¿½åŠ  <code>.html</code>, <code>.css</code>, <code>.js</code> ä»¥åŠè‡ªå®šä¹‰çš„ç›‘æ§åç¼€ï¼Œå‡å°‘æ— ç”¨æ•°æ®ã€‚</td></tr><tr><td><code>plugin.mount</code></td><td>æ— </td><td>æŒ‚è½½æ’ä»¶åˆ—è¡¨</td><td>ä»…æŒ‚è½½éœ€è¦çš„æ’ä»¶ï¼Œç§»é™¤ä¸éœ€è¦çš„ï¼ˆå¦‚æœªä½¿ç”¨çš„ä¸­é—´ä»¶æ’ä»¶ï¼‰ï¼Œå‡å°‘ç±»åŠ è½½å¼€é”€å’Œå†…å­˜å ç”¨ã€‚</td></tr></tbody></table>
<p><strong>OAP å­˜å‚¨è°ƒä¼˜é…ç½® (Elasticsearch)</strong></p>



































<table><thead><tr><th><strong>ç¯å¢ƒå˜é‡/é…ç½®é¡¹</strong></th><th><strong>é»˜è®¤å€¼</strong></th><th><strong>ä½œç”¨</strong></th><th><strong>è°ƒä¼˜å»ºè®®</strong></th></tr></thead><tbody><tr><td><code>SW_STORAGE_ES_INDEX_SHARDS_NUMBER</code></td><td><code>1</code></td><td>ç´¢å¼•åˆ†ç‰‡æ•°</td><td>è‹¥ ES é›†ç¾¤æœ‰ 3+ æ•°æ®èŠ‚ç‚¹ï¼Œå»ºè®®è®¾ä¸º <code>3</code> æˆ– <code>5</code>ï¼Œæå‡å¹¶å‘å†™å…¥èƒ½åŠ›ã€‚</td></tr><tr><td><code>SW_STORAGE_ES_BULK_ACTIONS</code></td><td><code>1000</code></td><td>æ‰¹é‡å†™å…¥æ¡æ•°</td><td>å†…å­˜å…è®¸æ—¶å¯è°ƒè‡³ <code>2000</code>-<code>4000</code>ï¼Œå‡å°‘ç½‘ç»œäº¤äº’æ¬¡æ•°ã€‚</td></tr><tr><td><code>SW_STORAGE_ES_FLUSH_INTERVAL</code></td><td><code>10</code> (ç§’)</td><td>æ‰¹é‡å†™å…¥æœ€å¤§é—´éš”</td><td>ä¿æŒé»˜è®¤æˆ–å¾®è°ƒã€‚è¿‡çŸ­å¯¼è‡´ CPU é£™å‡ï¼Œè¿‡é•¿å¯¼è‡´æ•°æ®å»¶è¿Ÿå¯è§ã€‚</td></tr><tr><td><code>SW_STORAGE_ES_LOGIC_SHARDING</code></td><td><code>false</code></td><td>é€»è¾‘åˆ†ç‰‡æ¨¡å¼</td><td>è¶…å¤§è§„æ¨¡é›†ç¾¤å»ºè®®å¼€å¯ (<code>true</code>)ï¼Œå°†ä¸åŒæŒ‡æ ‡æ‹†åˆ†åˆ°ç‰©ç†éš”ç¦»çš„ç´¢å¼•ä¸­ã€‚</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OoderAgent SDK Nexus ç‰ˆæ·±åº¦æ­ç§˜ï¼šæ„å»ºå…¨å±‚çº§æ™ºèƒ½ååŒçš„ä»£ç†ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7599929684022018067</link>    <guid>https://juejin.cn/post/7599929684022018067</guid>    <pubDate>2026-01-28T02:49:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599929684022018067" data-draft-id="7599924721006493759" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OoderAgent SDK Nexus ç‰ˆæ·±åº¦æ­ç§˜ï¼šæ„å»ºå…¨å±‚çº§æ™ºèƒ½ååŒçš„ä»£ç†ç³»ç»Ÿ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T02:49:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="OneCodeCN"/> <meta itemprop="url" content="https://juejin.cn/user/1427583415622366"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OoderAgent SDK Nexus ç‰ˆæ·±åº¦æ­ç§˜ï¼šæ„å»ºå…¨å±‚çº§æ™ºèƒ½ååŒçš„ä»£ç†ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1427583415622366/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    OneCodeCN
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:49:00.000Z" title="Wed Jan 28 2026 02:49:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">OoderAgent SDK Nexus ç‰ˆæ·±åº¦æ­ç§˜ï¼šæ„å»ºå…¨å±‚çº§æ™ºèƒ½ååŒçš„ä»£ç†ç³»ç»Ÿ</h2>
<p>OoderAgent SDK Nexus ç‰ˆï¼ˆåŸºäº Java 8 å¼€å‘ï¼Œæºç å¯å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FooderCN%2Fsuper-agent%2Ftree%2Fmaster%2Fagent-sdk" target="_blank" title="https://gitee.com/ooderCN/super-agent/tree/master/agent-sdk" ref="nofollow noopener noreferrer">gitee.com/ooderCN/supâ€¦</a>ï¼‰æ­£æ˜¯ä¸ºæ­¤è€Œç”Ÿâ€”â€”å®ƒä»¥åˆ†å±‚æ¶æ„ä¸ºéª¨æ¶ã€Agent ç»§æ‰¿ä½“ç³»ä¸ºè„‰ç»œã€ç»Ÿä¸€å‘½ä»¤æ¨¡å¼ä¸ç²¾ç»†åŒ–ç½‘ç»œç®¡ç†ä¸ºæ ¸å¿ƒï¼Œä¸ºæ„å»ºå…¨åœºæ™¯æ™ºèƒ½ä»£ç†ç³»ç»Ÿæä¾›äº†ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆã€‚æœ¬æ–‡å°†ä»è®¾è®¡ç†å¿µã€æ ¸å¿ƒæ¶æ„ã€å…³é”®èƒ½åŠ›åˆ°å®æˆ˜åº”ç”¨ï¼Œå…¨æ–¹ä½æ‹†è§£è¿™æ¬¾ SDK çš„æŠ€æœ¯å†…æ ¸ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€è®¾è®¡åˆå¿ƒï¼šç ´è§£æ™ºèƒ½ä»£ç†å¼€å‘çš„æ ¸å¿ƒç—›ç‚¹</h3>
<p>ä¼ ç»Ÿæ™ºèƒ½ä»£ç†ç³»ç»Ÿå¼€å‘å¾€å¾€é¢ä¸´ã€Œæ¨¡å—è€¦åˆé«˜ã€æ‰©å±•æˆæœ¬å¤§ã€å¤šåœºæ™¯é€‚é…éš¾ã€çš„é—®é¢˜ï¼Œè€Œ OoderAgent SDK Nexus ç‰ˆçš„æ ¸å¿ƒè®¾è®¡ç›®æ ‡ï¼Œå°±æ˜¯é€šè¿‡<strong>åˆ†å±‚è§£è€¦ã€ç»§æ‰¿æ‰©å±•ã€ç»Ÿä¸€æ ‡å‡†</strong>ä¸‰å¤§åŸåˆ™ï¼Œè®©æ™ºèƒ½ä»£ç†å¼€å‘æ›´ç®€å•ï¼š</p>
<ul>
<li>åˆ†å±‚æ¶æ„æ˜ç¡®å„æ¨¡å—èŒè´£ï¼Œé™ä½å¼€å‘ä¸ç»´æŠ¤æˆæœ¬ï¼›</li>
<li>Agent ç»§æ‰¿ä½“ç³»å®ç°è§’è‰²åŠŸèƒ½çš„è‡ªç„¶å¤ç”¨ä¸æ‰©å±•ï¼›</li>
<li>ç»Ÿä¸€çš„å‘½ä»¤æ¨¡å¼å’Œç½‘ç»œç®¡ç†æ–¹æ¡ˆï¼Œé€‚é…ä»ç»ˆç«¯åˆ°ä¸­å¿ƒçš„å…¨å±‚çº§ååŒåœºæ™¯ã€‚</li>
</ul>
<h3 data-id="heading-2">äºŒã€æ ¸å¿ƒæ¶æ„ï¼šå››å±‚åˆ†å±‚è®¾è®¡ï¼Œå±‚å±‚è§£è€¦ä¸”å¯æ‰©å±•</h3>
<p>OoderAgent SDK Nexus ç‰ˆé‡‡ç”¨å››å±‚é€’è¿›å¼åˆ†å±‚æ¶æ„ï¼Œä»ä¸Šå±‚åº”ç”¨æ¥å£åˆ°åº•å±‚åŸºç¡€æ”¯æ’‘ï¼Œæ¯ä¸€å±‚éƒ½æœ‰æ¸…æ™°çš„å®šä½å’Œè¾¹ç•Œï¼Œæ—¢ä¿è¯æ¨¡å—åŒ–å¼€å‘ï¼Œåˆä¸ºåŠŸèƒ½æ‰©å±•é¢„ç•™å……è¶³ç©ºé—´ã€‚</p>






























<table><thead><tr><th align="left">å±‚çº§</th><th align="left">æ ¸å¿ƒå®šä½</th><th align="left">å…³é”®èƒ½åŠ›</th></tr></thead><tbody><tr><td align="left">åº”ç”¨æ¥å£å±‚</td><td align="left">å¼€å‘è€…ç»Ÿä¸€å…¥å£</td><td align="left">å°è£…å„ç±» Agent æ¥å£ï¼Œæä¾›é¢å‘ç»ˆç«¯/è·¯ç”±/ç®¡ç†è§’è‰²çš„ç»Ÿä¸€ç¼–ç¨‹å…¥å£ï¼Œæ— éœ€å…³æ³¨åº•å±‚å®ç°</td></tr><tr><td align="left">æœåŠ¡æŠ½è±¡å±‚</td><td align="left">æ ¸å¿ƒèƒ½åŠ›çš„ã€Œå®šä¹‰å±‚ã€</td><td align="left">æŠ½è±¡å‘½ä»¤æœåŠ¡ã€LLM èƒ½åŠ›ã€ç½‘ç»œç®¡ç†ç­‰æ ¸å¿ƒæœåŠ¡æ¥å£ï¼Œæ”¯æŒå¤šå®ç°æ–¹å¼ï¼ˆå¦‚ LLM å¯å¯¹æ¥äº‘ç«¯/æœ¬åœ°ï¼‰</td></tr><tr><td align="left">åè®®å®ç°å±‚</td><td align="left">æŠ½è±¡èƒ½åŠ›çš„ã€Œè½åœ°å±‚ã€</td><td align="left">å®ç°å‘½ä»¤åŸºç¡€æœåŠ¡ã€ç½‘ç»œå‘ç°ã€å­˜å‚¨æœåŠ¡ç­‰æ ¸å¿ƒé€»è¾‘ï¼Œå°†æŠ½è±¡æ¥å£è½¬åŒ–ä¸ºå¯æ‰§è¡Œçš„å…·ä½“åŠŸèƒ½</td></tr><tr><td align="left">åº•å±‚æ”¯æ’‘å±‚</td><td align="left">ç³»ç»Ÿç¨³å®šçš„ã€Œåœ°åŸºã€</td><td align="left">æä¾›å­˜å‚¨ã€å®‰å…¨è®¤è¯ã€UDP æ•°æ®åŒ…å¤„ç†ã€ç½‘ç»œé€šä¿¡ç­‰åŸºç¡€èƒ½åŠ›ï¼Œä¿éšœä¸Šå±‚æ¨¡å—å¯é è¿è¡Œ</td></tr></tbody></table>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cba55c44dd7a4fb1a0010c7d2201b756~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173340&amp;x-signature=AFp7JmQTZ20nBW5fjYep1H6qXAw%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-3">æ ¸å¿ƒè®¾è®¡åŸåˆ™</h4>
<p>è¿™å¥—åˆ†å±‚æ¶æ„éµå¾ªå››å¤§åŸåˆ™ï¼Œç¡®ä¿ç³»ç»Ÿçš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼š</p>
<ol>
<li><strong>æ¨¡å—åŒ–</strong>ï¼šæŒ‰åŠŸèƒ½æ‹†åˆ†ç‹¬ç«‹æ¨¡å—ï¼Œæ”¯æŒå•ç‹¬å¼€å‘ã€æµ‹è¯•ä¸è¿­ä»£ï¼›</li>
<li><strong>æŠ½è±¡åŒ–</strong>ï¼šæ ¸å¿ƒæœåŠ¡é€šè¿‡æ¥å£å®šä¹‰ï¼Œå…¼å®¹å¤šç§å®ç°æ–¹æ¡ˆï¼›</li>
<li><strong>ç»§æ‰¿æ€§</strong>ï¼šAgent è§’è‰²é—´é€šè¿‡ç»§æ‰¿å®ç°åŠŸèƒ½å¤ç”¨ï¼Œé¿å…é‡å¤å¼€å‘ï¼›</li>
<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šé¢„ç•™æ‰©å±•ç‚¹ï¼Œè½»æ¾æ¥å…¥æ–°åŠŸèƒ½ã€æ–°åè®®æˆ–æ–°åœºæ™¯ã€‚</li>
</ol>
<h3 data-id="heading-4">ä¸‰ã€Agent ä½“ç³»ï¼šä¸‰å±‚ç»§æ‰¿ï¼Œé€‚é…å…¨åœºæ™¯è§’è‰²</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3155fc778444705be832d6a908c0edd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173340&amp;x-signature=lmKDSpxoj1dl2BoGxB1IMQru4Dk%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>SDK è®¾è®¡äº†ä¸‰å±‚ Agent ç»§æ‰¿ä½“ç³»ï¼Œä¸åŒè§’è‰²çš„ Agent åŸºäºç»§æ‰¿å®ç°åŠŸèƒ½å¤ç”¨ä¸æ‰©å±•ï¼Œå®Œç¾è¦†ç›–ä»ç»ˆç«¯è®¾å¤‡åˆ°ä¸­å¿ƒç®¡ç†èŠ‚ç‚¹çš„å…¨åœºæ™¯éœ€æ±‚ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc33cfcfde5247349157b43e5ecc7b14~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173340&amp;x-signature=1CCpxy9BehnVYbS%2BR3fQ8fInUmY%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-5">1. EndAgentï¼šç»ˆç«¯è®¾å¤‡çš„ã€Œæ™ºèƒ½å…¥å£ã€</h4>
<p>ä½œä¸ºæœ€åŸºç¡€çš„ç»ˆç«¯ä»£ç†ï¼ŒEndAgent æ˜¯æ™ºèƒ½è®¾å¤‡ï¼ˆæ™ºèƒ½å®¶å±…ã€å·¥ä¸šç»ˆç«¯ç­‰ï¼‰æ¥å…¥ç³»ç»Ÿçš„æ ¸å¿ƒè½½ä½“ï¼Œæ‰¿æ‹…ï¼š</p>
<ul>
<li>è®¾å¤‡çŠ¶æ€å®æ—¶ç®¡ç†ï¼›</li>
<li>åŸºç¡€å‘½ä»¤æ‰§è¡Œï¼›</li>
<li>æœ¬åœ°èµ„æºï¼ˆå­˜å‚¨ã€ç®—åŠ›ï¼‰ç®¡ç†ã€‚</li>
</ul>
<h4 data-id="heading-6">2. RouteAgentï¼šç½‘ç»œä¸­çš„ã€Œä¸­è½¬æ¢çº½ã€</h4>
<p>RouteAgent ç»§æ‰¿ EndAgent çš„å…¨éƒ¨åŠŸèƒ½ï¼Œé¢å¤–æ–°å¢ç½‘ç»œå±‚æ ¸å¿ƒèƒ½åŠ›ï¼Œé€‚ç”¨äºè¾¹ç¼˜è®¡ç®—èŠ‚ç‚¹ã€å±€åŸŸç½‘è·¯ç”±èŠ‚ç‚¹ï¼š</p>
<ul>
<li>æ•°æ®åŒ…è·¯ç”±è½¬å‘ï¼›</li>
<li>ç½‘ç»œæ‹“æ‰‘è‡ªåŠ¨ç»´æŠ¤ï¼›</li>
<li>ç»ˆç«¯ä¸ä¸­å¿ƒèŠ‚ç‚¹çš„é€šä¿¡æ¡¥æ¢ã€‚</li>
</ul>
<h4 data-id="heading-7">3. McpAgentï¼šç³»ç»Ÿçš„ã€Œå¤§è„‘ä¸­æ¢ã€</h4>
<p>McpAgent ç»§æ‰¿ RouteAgent çš„æ‰€æœ‰èƒ½åŠ›ï¼Œæ–°å¢å…¨å±€ç®¡æ§èƒ½åŠ›ï¼Œä½œä¸ºä¸­å¿ƒç®¡ç†èŠ‚ç‚¹è´Ÿè´£ï¼š</p>
<ul>
<li>å…¨å±€èµ„æºè°ƒåº¦ä¸ç®¡ç†ï¼›</li>
<li>è·¨èŠ‚ç‚¹ç³»ç»Ÿé…ç½®åè°ƒï¼›</li>
<li>å…¨å±‚çº§ä»£ç†çš„ååŒç®¡æ§ã€‚</li>
</ul>
<p>ä¸‰è€…çš„ç»§æ‰¿å…³ç³»æ¸…æ™°ä¸”åŠŸèƒ½é€’è¿›ï¼š<code>EndAgent â†’ RouteAgent â†’ McpAgent</code>ï¼Œæ—¢ä¿è¯äº†åŸºç¡€èƒ½åŠ›çš„å¤ç”¨ï¼Œåˆå®ç°äº†ä¸åŒè§’è‰²çš„å·®å¼‚åŒ–æ‰©å±•ã€‚</p>
<h3 data-id="heading-8">å››ã€æ ¸å¿ƒèƒ½åŠ›æ‹†è§£ï¼šå‘½ä»¤æ¨¡å¼+ç½‘ç»œç®¡ç†ï¼Œæ‰“é€šååŒä¸é€šä¿¡</h3>
<h4 data-id="heading-9">1. å‘½ä»¤æ¨¡å¼ï¼šç»Ÿä¸€çš„é€šä¿¡ä¸æ§åˆ¶é€»è¾‘</h4>
<p>SDK é‡‡ç”¨ç»å…¸å‘½ä»¤æ¨¡å¼å®ç°ä»£ç†é—´çš„é€šä¿¡ä¸æ§åˆ¶ï¼Œæ ¸å¿ƒç»„ä»¶å½¢æˆå®Œæ•´çš„å‘½ä»¤ç”Ÿå‘½å‘¨æœŸç®¡ç†é—­ç¯ï¼š</p>
<ul>
<li><strong>CommandBaseService</strong>ï¼šå‘½ä»¤æœåŠ¡æ¥å£ï¼Œå®šä¹‰å‘½ä»¤åˆ›å»ºã€çŠ¶æ€æŸ¥è¯¢ã€å–æ¶ˆã€æ›´æ–°ç­‰æ ¸å¿ƒæ–¹æ³•ï¼›</li>
<li><strong>CommandBaseServiceImpl</strong>ï¼šå‘½ä»¤æœåŠ¡å®ç°ï¼ŒåŸºäºå†…å­˜è·Ÿè¸ªå‘½ä»¤çŠ¶æ€ï¼Œå®Œæˆå…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼›</li>
<li><strong>CommandStatus</strong>ï¼šå‘½ä»¤çŠ¶æ€æšä¸¾ï¼ˆPENDING/EXECUTING/SUCCESS/FAILED/CANCELLEDï¼‰ï¼Œæ¸…æ™°è·Ÿè¸ªæ‰§è¡Œè¿‡ç¨‹ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e58440bd08345ffbed481ca3a2bc6e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173340&amp;x-signature=xjLDTCJGpleLf2BiOQlUJIMJpqY%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p><strong>å‘½ä»¤æ‰§è¡Œå…¨æµç¨‹</strong>ï¼š</p>
<ol>
<li>ä¸Šå±‚åº”ç”¨é€šè¿‡ Agent æ¥å£åˆ›å»ºå‘½ä»¤ï¼›</li>
<li>å‘½ä»¤æœåŠ¡æ¥ç®¡ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼›</li>
<li>åŸºäº UDP åè®®å°†å‘½ä»¤ä¸‹å‘è‡³ç›®æ ‡ä»£ç†ï¼›</li>
<li>å®æ—¶è·Ÿè¸ªæ‰§è¡ŒçŠ¶æ€å¹¶è¿”å›ç»“æœã€‚</li>
</ol>
<h4 data-id="heading-10">2. ç½‘ç»œç®¡ç†ï¼šç²¾ç»†åŒ– UDP ç«¯å£æ–¹æ¡ˆï¼Œé€‚é…å¤šç½‘ç»œç¯å¢ƒ</h4>
<p>é’ˆå¯¹æœ¬åœ°ã€å°å±€åŸŸç½‘ï¼ˆWIFIï¼‰ã€å†…ç½‘ç½‘æ®µç­‰ä¸åŒç½‘ç»œåœºæ™¯ï¼ŒSDK è®¾è®¡äº†ç²¾ç»†åŒ–çš„ UDP ç«¯å£ç®¡ç†ç­–ç•¥ï¼ŒåŒæ—¶å†…ç½®ç½‘ç»œå‘ç°æœºåˆ¶ï¼Œä¿éšœä»£ç†é—´é€šä¿¡çš„ç¨³å®šæ€§ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ca41cfd08a9445fb5af0679d6f0d38b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173340&amp;x-signature=RCqbSgN1rgNsss2%2FZo8C4%2BWvPt8%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>





















<table><thead><tr><th align="left">ç½‘ç»œåœºæ™¯</th><th align="left">æ ¸å¿ƒç«¯å£ç®¡ç†èƒ½åŠ›</th></tr></thead><tbody><tr><td align="left">æœ¬åœ°ç®¡ç†</td><td align="left">ç«¯å£å†²çªæ£€æµ‹ã€åŠ¨æ€åˆ†é…ã€é‡Šæ”¾å›æ”¶</td></tr><tr><td align="left">å°å±€åŸŸç½‘ï¼ˆWIFIï¼‰</td><td align="left">å±€åŸŸç½‘åœ°å€ç«¯å£æ˜ å°„ã€å¹¿æ’­å‘ç°ã€ä½å»¶è¿Ÿä¼˜åŒ–</td></tr><tr><td align="left">å†…ç½‘ç½‘æ®µ</td><td align="left">ç½‘æ®µçº§ç«¯å£è§„åˆ’ã€è·¯ç”±èŠ‚ç‚¹è½¬å‘ã€æ‹“æ‰‘è‡ªåŠ¨å‘ç°</td></tr></tbody></table>
<p><strong>ç½‘ç»œå‘ç°æœºåˆ¶</strong>ï¼šè‡ªåŠ¨æ£€æµ‹ç½‘ç»œç¯å¢ƒ â†’ å‘ç°å‘¨è¾¹ä»£ç†èŠ‚ç‚¹ â†’ å»ºç«‹è¿æ¥å¹¶ç»´æŠ¤æ‹“æ‰‘ â†’ å®æ—¶é€šçŸ¥ä¸Šå±‚åº”ç”¨ç½‘ç»œå˜åŒ–ï¼Œè®©ä»£ç†ç³»ç»Ÿèƒ½è‡ªé€‚åº”ç½‘ç»œç¯å¢ƒçš„åŠ¨æ€è°ƒæ•´ã€‚</p>
<h3 data-id="heading-11">äº”ã€æ ¸å¿ƒç‰¹æ€§ï¼šå¼‚æ­¥ã€å®‰å…¨ã€çµæ´»ï¼Œé€‚é…é«˜å¤æ‚åº¦åœºæ™¯</h3>
<h4 data-id="heading-12">1. å¼‚æ­¥ç¼–ç¨‹ï¼šæå‡ç³»ç»Ÿå¹¶å‘èƒ½åŠ›</h4>
<p>åŸºäº CompletableFuture å®ç°å¼‚æ­¥ç¼–ç¨‹ï¼Œæ”¯æŒéé˜»å¡å‘½ä»¤æ‰§è¡Œã€å¼‚æ­¥ç½‘ç»œé€šä¿¡ã€å¹¶è¡Œä»»åŠ¡å¤„ç†ï¼Œå¤§å¹…æå‡ç³»ç»Ÿå“åº”é€Ÿåº¦ï¼Œé€‚é…é«˜å¹¶å‘çš„æ™ºèƒ½è®¾å¤‡åœºæ™¯ã€‚</p>
<h4 data-id="heading-13">2. è§’è‰²èº«ä»½è®¤è¯ï¼šä¿éšœæ¥å£è°ƒç”¨å®‰å…¨</h4>
<p>åŸºäºä¾èµ–æ³¨å…¥å’Œä»£ç†æ¨¡å¼å®ç°èº«ä»½è®¤è¯ï¼Œæ”¯æŒåŸºäºè§’è‰²çš„æƒé™æ§åˆ¶å’Œçµæ´»çš„è®¤è¯ç­–ç•¥é…ç½®ï¼Œä»åº•å±‚é˜²æ­¢æœªæˆæƒè®¿é—®ï¼Œä¿éšœæ¥å£è°ƒç”¨å®‰å…¨ã€‚</p>
<h4 data-id="heading-14">3. å·¥å‚æ¨¡å¼ï¼šç®€åŒ–å¯¹è±¡åˆ›å»ºä¸ç®¡ç†</h4>
<p>é€šè¿‡å·¥å‚æ¨¡å¼å°è£… Agent å®ä¾‹çš„åˆ›å»ºé€»è¾‘ï¼Œæä¾›ç»Ÿä¸€çš„å¯¹è±¡åˆ›å»ºå…¥å£ï¼Œè‡ªåŠ¨å¤„ç†ä¾èµ–å…³ç³»ï¼Œæ”¯æŒé…ç½®åŒ–å®ä¾‹åŒ–ç­–ç•¥ï¼Œé™ä½å¼€å‘è€…çš„ä½¿ç”¨æˆæœ¬ã€‚</p>
<h4 data-id="heading-15">4. ç³»ç»Ÿçº§é…ç½®ï¼šé›†ä¸­å¼ç®¡ç†ï¼ŒåŠ¨æ€é€‚é…</h4>
<p>æä¾›é›†ä¸­å¼é…ç½®ç®¡ç†èƒ½åŠ›ï¼Œæ”¯æŒç»Ÿä¸€é…ç½®åŠ è½½ã€è¿è¡Œæ—¶é…ç½®æ›´æ–°ã€ç¯å¢ƒæ„ŸçŸ¥çš„é…ç½®é€‚é…ï¼Œè®©ç³»ç»Ÿèƒ½çµæ´»åº”å¯¹ä¸åŒéƒ¨ç½²ç¯å¢ƒçš„éœ€æ±‚ã€‚</p>
<h4 data-id="heading-16">5. LLM æŠ½è±¡å±‚ï¼šå…¼å®¹å¤šç±»å¤§è¯­è¨€æ¨¡å‹èƒ½åŠ›</h4>
<p>ä¸ºå¤§è¯­è¨€æ¨¡å‹è®¾è®¡ç»Ÿä¸€æŠ½è±¡æ¥å£ï¼Œæ”¯æŒä¸‰ç§å®ç°æ–¹å¼ï¼Œé€‚é…ä¸åŒæ™ºèƒ½åœºæ™¯ï¼š</p>
<ul>
<li>å¤–éƒ¨ LLM-APIï¼šå¯¹æ¥äº‘ç«¯å¤§è¯­è¨€æ¨¡å‹æœåŠ¡ï¼›</li>
<li>æœ¬åœ° Skillsï¼šå†…ç½®æœ¬åœ°æŠ€èƒ½ï¼Œæ— éœ€ä¾èµ–äº‘ç«¯ï¼›</li>
<li>SkillFlowï¼šæŠ€èƒ½æµç¨‹ç¼–æ’ï¼Œæ”¯æŒå¤æ‚ä»»åŠ¡è‡ªåŠ¨åŒ–æ‰§è¡Œã€‚</li>
</ul>
<h3 data-id="heading-17">å…­ã€å¿«é€Ÿä¸Šæ‰‹ï¼šæç®€ç¤ºä¾‹ç©è½¬ Nexus SDK</h3>
<p>åŸºäºå¼€æºçš„ SDK æºç ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FooderCN%2Fsuper-agent%2Ftree%2Fmaster%2Fagent-sdk" target="_blank" title="https://gitee.com/ooderCN/super-agent/tree/master/agent-sdk" ref="nofollow noopener noreferrer">gitee.com/ooderCN/supâ€¦</a>ï¼‰ï¼Œå¼€å‘è€…å¯å¿«é€Ÿå®ç°åŸºç¡€åŠŸèƒ½ï¼Œä»¥ä¸‹æ˜¯æ ¸å¿ƒåœºæ™¯çš„æç®€ç¤ºä¾‹ï¼š</p>
<h4 data-id="heading-18">1. åˆ›å»ºå¹¶å¯åŠ¨ EndAgent å®ä¾‹</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åˆ›å»º EndAgent é…ç½®</span>
<span class="hljs-type">EndAgentConfig</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">EndAgentConfig</span>();
config.setAgentId(<span class="hljs-string">"end-agent-001"</span>);
config.setAgentName(<span class="hljs-string">"æ™ºèƒ½å®¶å±…ç»ˆç«¯"</span>);
config.setNetworkConfig(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NetworkConfig</span>(<span class="hljs-number">8080</span>));

<span class="hljs-comment">// é€šè¿‡å·¥å‚æ¨¡å¼åˆ›å»º EndAgent å®ä¾‹</span>
<span class="hljs-type">EndAgent</span> <span class="hljs-variable">endAgent</span> <span class="hljs-operator">=</span> EndAgentFactory.createEndAgent(config);

<span class="hljs-comment">// å¯åŠ¨ç»ˆç«¯ä»£ç†</span>
endAgent.start();
System.out.println(<span class="hljs-string">"EndAgent å¯åŠ¨æˆåŠŸï¼š"</span> + endAgent.getAgentId());
</code></pre>
<h4 data-id="heading-19">2. æ‰§è¡Œè®¾å¤‡æ§åˆ¶å‘½ä»¤ï¼ˆå¼‚æ­¥ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ„å»ºè®¾å¤‡æ§åˆ¶å‘½ä»¤åŒ…</span>
<span class="hljs-type">CommandPacket</span> <span class="hljs-variable">commandPacket</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CommandPacket</span>();
commandPacket.setCommandId(<span class="hljs-string">"cmd-001"</span>);
commandPacket.setCommandType(<span class="hljs-string">"DEVICE_CONTROL"</span>);
commandPacket.setParameters(Collections.singletonMap(<span class="hljs-string">"deviceId"</span>, <span class="hljs-string">"light-001"</span>));
commandPacket.setParameters(Collections.singletonMap(<span class="hljs-string">"action"</span>, <span class="hljs-string">"turnOn"</span>));

<span class="hljs-comment">// å¼‚æ­¥å‘é€å‘½ä»¤å¹¶å¤„ç†ç»“æœ</span>
CompletableFuture&lt;CommandStatus&gt; future = endAgent.sendCommand(commandPacket);
future.thenAccept(status -&gt; {
    System.out.println(<span class="hljs-string">"å‘½ä»¤æ‰§è¡ŒçŠ¶æ€ï¼š"</span> + status);
}).exceptionally(ex -&gt; {
    System.err.println(<span class="hljs-string">"å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼š"</span> + ex.getMessage());
    <span class="hljs-keyword">return</span> CommandStatus.FAILED;
});
</code></pre>
<h4 data-id="heading-20">3. ç›‘å¬ç½‘ç»œå†…ä»£ç†èŠ‚ç‚¹å˜åŒ–</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ·»åŠ ç½‘ç»œå‘ç°ç›‘å¬å™¨</span>
endAgent.addDiscoveryListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DiscoveryListener</span>() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onAgentDiscovered</span><span class="hljs-params">(AgentInfo agentInfo)</span> {
        System.out.println(<span class="hljs-string">"å‘ç°æ–°ä»£ç†ï¼š"</span> + agentInfo.getAgentId() + <span class="hljs-string">" - "</span> + agentInfo.getAgentName());
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onAgentLost</span><span class="hljs-params">(AgentInfo agentInfo)</span> {
        System.out.println(<span class="hljs-string">"ä»£ç†ç¦»çº¿ï¼š"</span> + agentInfo.getAgentId());
    }
});

<span class="hljs-comment">// å¯åŠ¨ç½‘ç»œå‘ç°</span>
endAgent.startDiscovery();
</code></pre>
<h3 data-id="heading-21">ä¸ƒã€åº”ç”¨åœºæ™¯ï¼šè¦†ç›–ä»ç»ˆç«¯åˆ°ä¸­å¿ƒçš„å…¨é“¾è·¯</h3>
<p>OoderAgent SDK Nexus ç‰ˆå‡­å€Ÿå…¶åˆ†å±‚æ¶æ„å’Œçµæ´»çš„ Agent ä½“ç³»ï¼Œå¯å¹¿æ³›é€‚é…å„ç±»æ™ºèƒ½ååŒåœºæ™¯ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/800951aa591d49b484c113cf339da5f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173340&amp;x-signature=bG73%2BoZSnvSVl4Jb1QWL7t2%2FqEo%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<ul>
<li><strong>æ™ºèƒ½ç‰©è”ç½‘è®¾å¤‡</strong>ï¼šå®ç°è®¾å¤‡æœ¬åœ°æ™ºèƒ½å†³ç­–ä¸è¿œç¨‹ç®¡ç†ï¼Œé™ä½äº‘ç«¯ä¾èµ–ï¼›</li>
<li><strong>è¾¹ç¼˜è®¡ç®—èŠ‚ç‚¹</strong>ï¼šä½œä¸º RouteAgent æä¾›è¾¹ç¼˜æ™ºèƒ½ä¸æ•°æ®è½¬å‘ï¼Œæå‡å“åº”é€Ÿåº¦ï¼›</li>
<li><strong>ä¸­å¿ƒç®¡ç†å¹³å°</strong>ï¼šåŸºäº McpAgent å®ç°å…¨å±€èµ„æºè°ƒåº¦ä¸è·¨èŠ‚ç‚¹ååŒï¼›</li>
<li><strong>å¤šè®¾å¤‡ååŒç³»ç»Ÿ</strong>ï¼šæ„å»ºè®¾å¤‡é—´æ™ºèƒ½äº’è”ï¼Œå®ç°æ™ºèƒ½å®¶å±…ã€å·¥ä¸šç‰©è”ç½‘ç­‰å¤æ‚åœºæ™¯çš„è‡ªåŠ¨åŒ–ã€‚</li>
</ul>
<h3 data-id="heading-22">æ€»ç»“</h3>
<p>OoderAgent SDK Nexus ç‰ˆä»¥ã€Œåˆ†å±‚è§£è€¦ã€çµæ´»æ‰©å±•ã€å…¨åœºæ™¯é€‚é…ã€ä¸ºæ ¸å¿ƒï¼Œé€šè¿‡å››å±‚æ¶æ„ã€ä¸‰å±‚ Agent ç»§æ‰¿ä½“ç³»ã€ç»Ÿä¸€å‘½ä»¤æ¨¡å¼å’Œç²¾ç»†åŒ–ç½‘ç»œç®¡ç†ï¼Œä¸ºæ™ºèƒ½ä»£ç†ç³»ç»Ÿå¼€å‘æä¾›äº†æ¸…æ™°çš„æŠ€æœ¯è·¯å¾„ã€‚æ— è®ºæ˜¯ç®€å•çš„ç»ˆç«¯è®¾å¤‡æ¥å…¥ï¼Œè¿˜æ˜¯å¤æ‚çš„å¤šèŠ‚ç‚¹ååŒç®¡æ§ï¼Œè¿™æ¬¾ SDK éƒ½èƒ½å¤§å¹…é™ä½å¼€å‘æˆæœ¬ï¼Œæå‡ç³»ç»Ÿçš„ç¨³å®šæ€§ä¸å¯æ‰©å±•æ€§ã€‚ç»“åˆå¼€æºçš„æºç ä»“åº“ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FooderCN%2Fsuper-agent%2Ftree%2Fmaster%2Fagent-sdk" target="_blank" title="https://gitee.com/ooderCN/super-agent/tree/master/agent-sdk" ref="nofollow noopener noreferrer">gitee.com/ooderCN/supâ€¦</a>ï¼‰ï¼Œå¼€å‘è€…å¯å¿«é€Ÿä¸Šæ‰‹å¹¶åŸºäºå®é™…åœºæ™¯æ‰©å±•å®šåˆ¶ï¼Œæ˜¯æ„å»ºå…¨å±‚çº§æ™ºèƒ½ååŒç³»ç»Ÿçš„ç†æƒ³å·¥å…·åŒ…ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[nestjså­¦ä¹ 13ï¼šinterceptorä¸rxjs]]></title>    <link>https://juejin.cn/post/7599912857392906286</link>    <guid>https://juejin.cn/post/7599912857392906286</guid>    <pubDate>2026-01-28T02:48:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599912857392906286" data-draft-id="7599155566297382955" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="nestjså­¦ä¹ 13ï¼šinterceptorä¸rxjs"/> <meta itemprop="keywords" content="NestJS"/> <meta itemprop="datePublished" content="2026-01-28T02:48:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€æ±Ÿä¸œæµæ°´"/> <meta itemprop="url" content="https://juejin.cn/user/1151943917181880"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            nestjså­¦ä¹ 13ï¼šinterceptorä¸rxjs
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1151943917181880/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€æ±Ÿä¸œæµæ°´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:48:37.000Z" title="Wed Jan 28 2026 02:48:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å…³äºå¯¹<code>rxjs</code>çš„æè¿°ï¼Œè¯·å‚è€ƒè¿™ç¯‡æ–‡ç« <a href="https://juejin.cn/post/7566119309967474751" target="_blank" title="https://juejin.cn/post/7566119309967474751">å¯¹rxjsçš„ç†è§£å’ŒåŸºæœ¬ä½¿ç”¨</a>ã€‚</p>
<p><code>interceptor</code>éƒ½æ˜¯å’Œ<code>rxjs</code>é…åˆä½¿ç”¨çš„ï¼Œå…ˆçœ‹çœ‹åœ¨<code>interceptor</code>ä¸­æœ‰é‚£äº›å¸¸ç”¨çš„æ“ä½œç¬¦ã€‚</p>
<h2 data-id="heading-0">map</h2>
<p>ç”Ÿæˆä¸€ä¸ª interceptorï¼š</p>
<pre><code class="hljs language-js" lang="js">nest g interceptor map-test --no-spec --flat
</code></pre>
<p>ä½¿ç”¨ map operator æ¥å¯¹ controller è¿”å›çš„æ•°æ®åšä¸€äº›ä¿®æ”¹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">CallHandler</span>, <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">NestInterceptor</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { map, <span class="hljs-title class_">Observable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;

@<span class="hljs-title class_">Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MapTestInterceptor</span> implements <span class="hljs-title class_">NestInterceptor</span> {
  <span class="hljs-title function_">intercept</span>(<span class="hljs-attr">context</span>: <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-attr">next</span>: <span class="hljs-title class_">CallHandler</span>): <span class="hljs-title class_">Observable</span>&lt;any&gt; {
    <span class="hljs-keyword">return</span> next.<span class="hljs-title function_">handle</span>().<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">code</span>: <span class="hljs-number">200</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">'success'</span>,
        data
      }
    }))
  }
}
</code></pre>
<p>åœ¨ controller é‡Œå¼•å…¥ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f201987846d4ada9ff0ff6840200921~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=xxnib592wfyn8Sj3nCivnrdAMxc%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/33bddfdf43ff4fa59b92bc710f61dda9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=9ibK97yhyLH5c4KWPBEHykvrDQg%3D" alt="image.png" loading="lazy"/></p>
<p>ç°åœ¨è¿”å›çš„æ•°æ®å°±å˜æˆäº†è¿™æ ·ã€‚</p>
<p>map ç®—æ˜¯åœ¨ nest interceptor é‡Œå¿…ç”¨çš„ rxjs operator äº†ã€‚</p>
<p>å¯ä»¥çœ‹åˆ°<code>interceptor</code>ä½¿ç”¨çš„ç¬¬ä¸€ä¸ªåœºæ™¯ï¼š<strong>è½¬æ¢è¯·æ±‚ / å“åº”æ•°æ®ï¼ˆæœ€å¸¸ç”¨ï¼‰</strong>ã€‚</p>
<p>ä¸Šé¢å…¶å®å±•ç¤ºäº†å¦‚ä½•è½¬æ¢å“åº”æ•°æ®ï¼Œä¸‹é¢å†çœ‹çœ‹å¦‚ä½•è½¬æ¢è¯·æ±‚æ•°æ®ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">NestInterceptor</span>, <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-title class_">CallHandler</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Observable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;

@<span class="hljs-title class_">Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestTransformInterceptor</span> implements <span class="hljs-title class_">NestInterceptor</span> {
  <span class="hljs-comment">// æ ¸å¿ƒæ–¹æ³•ï¼šæ‹¦æˆªè¯·æ±‚ï¼Œå¤„ç†å…¥å‚åå†æ‰§è¡Œæ§åˆ¶å™¨é€»è¾‘</span>
  <span class="hljs-title function_">intercept</span>(<span class="hljs-attr">context</span>: <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-attr">next</span>: <span class="hljs-title class_">CallHandler</span>): <span class="hljs-title class_">Observable</span>&lt;any&gt; {
    <span class="hljs-comment">// 1. è·å– HTTP ä¸Šä¸‹æ–‡ï¼ˆæ‹¿åˆ°è¯·æ±‚å¯¹è±¡ï¼‰</span>
    <span class="hljs-keyword">const</span> ctx = context.<span class="hljs-title function_">switchToHttp</span>();
    <span class="hljs-keyword">const</span> request = ctx.<span class="hljs-title function_">getRequest</span>();

    <span class="hljs-comment">// 2. ç»Ÿä¸€å¤„ç†å…¥å‚ï¼šè¦†ç›–åŸå§‹è¯·æ±‚çš„ query/params/body</span>
    <span class="hljs-comment">// å¤„ç† URL å‚æ•°ï¼ˆå¦‚ /users/:id â†’ id ä»å­—ç¬¦ä¸²è½¬æ•°å­—ï¼‰</span>
    <span class="hljs-keyword">if</span> (request.<span class="hljs-property">params</span>) {
      request.<span class="hljs-property">params</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">transformParams</span>(request.<span class="hljs-property">params</span>);
    }

    <span class="hljs-comment">// 3. æ‰§è¡Œæ§åˆ¶å™¨æ–¹æ³•ï¼ˆæ­¤æ—¶å…¥å‚å·²è¢«è½¬æ¢ï¼‰</span>
    <span class="hljs-keyword">return</span> next.<span class="hljs-title function_">handle</span>();
  }
</code></pre>
<p>ä¸€èˆ¬æ‹¦æˆªå™¨Interceptoræ˜¯å…¨å±€æ‰¹é‡è½¬æ¢è¯·æ±‚å‚æ•°ï¼Œå•ä¸ªå‚æ•°çš„ç²¾å‡†è½¬æ¢ + éªŒè¯ï¼Œè¿˜æ˜¯è¦ä½¿ç”¨ç®¡é“ pipeã€‚</p>
<h2 data-id="heading-1">tap</h2>
<p>tapä¸ä¼šä¿®æ”¹å“åº”æ•°æ®ï¼Œè€Œæ˜¯æ‰§è¡Œä¸€äº›é¢å¤–é€»è¾‘ï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—ã€æ›´æ–°ç¼“å­˜ç­‰</p>
<p>ä¸‹é¢çœ‹ä¸€ä¸‹è®°å½•æ—¥å¿—çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">NestInterceptor</span>, <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-title class_">CallHandler</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Observable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;
<span class="hljs-keyword">import</span> { tap } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs/operators'</span>;

@<span class="hljs-title class_">Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoggingInterceptor</span> implements <span class="hljs-title class_">NestInterceptor</span> {
  <span class="hljs-title function_">intercept</span>(<span class="hljs-attr">context</span>: <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-attr">next</span>: <span class="hljs-title class_">CallHandler</span>): <span class="hljs-title class_">Observable</span>&lt;any&gt; {
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> request = context.<span class="hljs-title function_">switchToHttp</span>().<span class="hljs-title function_">getRequest</span>();
    <span class="hljs-keyword">const</span> { method, url } = request; <span class="hljs-comment">// è·å–è¯·æ±‚æ–¹æ³•å’Œè·¯å¾„</span>

    <span class="hljs-comment">// æ‰§è¡Œæ§åˆ¶å™¨æ–¹æ³•ï¼Œå“åº”è¿”å›åè§¦å‘ tap å›è°ƒ</span>
    <span class="hljs-keyword">return</span> next.<span class="hljs-title function_">handle</span>().<span class="hljs-title function_">pipe</span>(
      <span class="hljs-title function_">tap</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">${method}</span>] <span class="hljs-subst">${url}</span> è€—æ—¶: <span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now() - now}</span>ms`</span>);
        <span class="hljs-comment">// è¾“å‡ºç¤ºä¾‹ï¼š[GET] /api/users è€—æ—¶: 15ms</span>
      })
    );
  }
}
</code></pre>
<p>å¯¹äºé«˜é¢‘è®¿é—®ã€æ•°æ®å˜æ›´å°‘çš„æ¥å£ï¼ˆæ¯”å¦‚é¦–é¡µé…ç½®ã€å•†å“åˆ†ç±»ï¼‰ï¼Œå¯ä»¥ç”¨æ‹¦æˆªå™¨ + tap æ¥ç¼“å­˜å“åº”ç»“æœï¼ŒæŒ‡å®šæ—¶é—´å†…é‡å¤è¯·æ±‚ç›´æ¥è¿”å›ç¼“å­˜ï¼Œæå‡æ€§èƒ½ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">NestInterceptor</span>, <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-title class_">CallHandler</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Observable</span>, <span class="hljs-keyword">of</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;
<span class="hljs-keyword">import</span> { tap } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs/operators'</span>;

<span class="hljs-comment">// ç¼“å­˜å®¹å™¨</span>
<span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;string, { <span class="hljs-attr">data</span>: any; <span class="hljs-attr">expire</span>: number }&gt;();
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CACHE_TTL</span> = <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>; <span class="hljs-comment">// ç¼“å­˜1åˆ†é’Ÿ</span>

@<span class="hljs-title class_">Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CacheInterceptor</span> implements <span class="hljs-title class_">NestInterceptor</span> {
  <span class="hljs-title function_">intercept</span>(<span class="hljs-attr">context</span>: <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-attr">next</span>: <span class="hljs-title class_">CallHandler</span>): <span class="hljs-title class_">Observable</span>&lt;any&gt; {
    <span class="hljs-keyword">const</span> request = context.<span class="hljs-title function_">switchToHttp</span>().<span class="hljs-title function_">getRequest</span>();
    <span class="hljs-keyword">const</span> cacheKey = <span class="hljs-string">`<span class="hljs-subst">${request.method}</span>:<span class="hljs-subst">${request.url}</span>`</span>; <span class="hljs-comment">// ç¼“å­˜é”®ï¼šæ–¹æ³•+è·¯å¾„</span>

    <span class="hljs-comment">// æ£€æŸ¥ç¼“å­˜æ˜¯å¦å­˜åœ¨ä¸”æœªè¿‡æœŸ</span>
    <span class="hljs-keyword">const</span> cached = cache.<span class="hljs-title function_">get</span>(cacheKey);
    <span class="hljs-keyword">if</span> (cached &amp;&amp; <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() &lt; cached.<span class="hljs-property">expire</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">of</span>(cached.<span class="hljs-property">data</span>); <span class="hljs-comment">// ç›´æ¥è¿”å›ç¼“å­˜æ•°æ®ï¼Œä¸æ‰§è¡Œæ§åˆ¶å™¨æ–¹æ³•</span>
    }

    <span class="hljs-comment">// æ‰§è¡Œæ§åˆ¶å™¨æ–¹æ³•ï¼Œç¼“å­˜ç»“æœ</span>
    <span class="hljs-keyword">return</span> next.<span class="hljs-title function_">handle</span>().<span class="hljs-title function_">pipe</span>(
      <span class="hljs-title function_">tap</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
        cache.<span class="hljs-title function_">set</span>(cacheKey, {
          data,
          <span class="hljs-attr">expire</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() + <span class="hljs-variable constant_">CACHE_TTL</span>,
        });
      })
    );
  }
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ tap ä¸­æŠŠè¯·æ±‚ç»“æœç¼“å­˜èµ·æ¥ï¼Œä¸‹æ¬¡å†ç”¨æ—¶ç›´æ¥è¿”å›ç¼“å­˜ã€‚</p>
<h2 data-id="heading-2">catchError</h2>
<p>controller é‡Œå¾ˆå¯èƒ½ä¼šæŠ›å‡ºé”™è¯¯ï¼Œè¿™äº›é”™è¯¯ä¼šè¢« exception filter å¤„ç†ï¼Œè¿”å›ä¸åŒçš„å“åº”ï¼Œä½†åœ¨é‚£ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ interceptor é‡Œå…ˆå¤„ç†ä¸‹ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">CallHandler</span>, <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">Logger</span>, <span class="hljs-title class_">NestInterceptor</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { catchError, <span class="hljs-title class_">Observable</span>, throwError } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;

@<span class="hljs-title class_">Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CatchErrorTestInterceptor</span> implements <span class="hljs-title class_">NestInterceptor</span> {
  private readonly logger = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Logger</span>(<span class="hljs-title class_">CatchErrorTestInterceptor</span>.<span class="hljs-property">name</span>)

  intercept (<span class="hljs-attr">context</span>: <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-attr">next</span>: <span class="hljs-title class_">CallHandler</span>): <span class="hljs-title class_">Observable</span>&lt;any&gt; {
    <span class="hljs-keyword">return</span> next.<span class="hljs-title function_">handle</span>().<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">catchError</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">logger</span>.<span class="hljs-title function_">error</span>(err.<span class="hljs-property">message</span>, err.<span class="hljs-property">stack</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">throwError</span>(<span class="hljs-function">() =&gt;</span> err)
    }))
  }
}
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬å°±æ˜¯æ—¥å¿—è®°å½•äº†ä¸€ä¸‹ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ”¹æˆå¦ä¸€ç§é”™è¯¯ï¼Œé‡æ–° throwErrorã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c965c19647c44eb1adc59e74e1f209fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=m7oBESOK5OhBxN0B9ZFb%2BGw83Vc%3D" alt="image.png" loading="lazy"/></p>
<p>æ‰“å°äº†ä¸¤æ¬¡é”™è¯¯ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1fc595b85be94a9fa18c420467616caa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=rM%2FVWgTtnOWgBdkH%2FTN8jyhJNj0%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸€æ¬¡æ˜¯æˆ‘ä»¬åœ¨ interceptor é‡Œæ‰“å°çš„ï¼Œä¸€æ¬¡æ˜¯ exception filter æ‰“å°çš„ã€‚</p>
<h2 data-id="heading-3">timeout</h2>
<p>æ¥å£å¦‚æœé•¿æ—¶é—´æ²¡è¿”å›ï¼Œè¦ç»™ç”¨æˆ·ä¸€ä¸ªæ¥å£è¶…æ—¶çš„å“åº”ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ç”¨ timeout operatorã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">CallHandler</span>, <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">NestInterceptor</span>, <span class="hljs-title class_">RequestTimeoutException</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { catchError, <span class="hljs-title class_">Observable</span>, throwError, timeout, <span class="hljs-title class_">TimeoutError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;

@<span class="hljs-title class_">Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TimeoutInterceptor</span> implements <span class="hljs-title class_">NestInterceptor</span> {
  <span class="hljs-title function_">intercept</span>(<span class="hljs-attr">context</span>: <span class="hljs-title class_">ExecutionContext</span>, <span class="hljs-attr">next</span>: <span class="hljs-title class_">CallHandler</span>): <span class="hljs-title class_">Observable</span>&lt;any&gt; {
    <span class="hljs-keyword">return</span> next.<span class="hljs-title function_">handle</span>().<span class="hljs-title function_">pipe</span>(
      <span class="hljs-title function_">timeout</span>(<span class="hljs-number">3000</span>),
      <span class="hljs-title function_">catchError</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
        <span class="hljs-keyword">if</span>(err <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">TimeoutError</span>) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err);
          <span class="hljs-keyword">return</span> <span class="hljs-title function_">throwError</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestTimeoutException</span>());
        }
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">throwError</span>(<span class="hljs-function">() =&gt;</span> err);
      })
    )
  }
}
</code></pre>
<p>imeout æ“ä½œç¬¦ä¼šåœ¨ 3s æ²¡æ”¶åˆ°æ¶ˆæ¯çš„æ—¶å€™æŠ›ä¸€ä¸ª TimeoutErrorã€‚</p>
<p>ç„¶åç”¨ catchError æ“ä½œç¬¦å¤„ç†ä¸‹ï¼Œå¦‚æœæ˜¯ TimeoutErrorï¼Œå°±è¿”å› RequestTimeoutExceptionï¼Œè¿™ä¸ªæœ‰å†…ç½®çš„ exception filter ä¼šå¤„ç†æˆå¯¹åº”çš„å“åº”æ ¼å¼ã€‚</p>
<p>å…¶ä½™é”™è¯¯å°±ç›´æ¥ throwError æŠ›å‡ºå»ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e05b373a1f1492dbc4e25c906d9bff0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=%2FqbewykQmCa5q0nQZ9KqCSrkFq4%3D" alt="image.png" loading="lazy"/></p>
<p>æœ€åï¼Œå†æ¥çœ‹ä¸‹å…¨å±€çš„ interceptorï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff28ddb44ab2402eb2f3401baaf7c5e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=7d4fRxY8yy5F%2Ff5zEUcSuvDFLWs%3D" alt="image.png" loading="lazy"/></p>
<p>å› ä¸ºè¿™ç§æ˜¯æ‰‹åŠ¨ new çš„ï¼Œæ²¡æ³•æ³¨å…¥ä¾èµ–ã€‚</p>
<p>ä½†å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬æ˜¯éœ€è¦å…¨å±€ interceptor çš„ï¼Œè€Œä¸”è¿˜ç”¨åˆ°ä¸€äº› providerï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>nest æä¾›äº†ä¸€ä¸ª tokenï¼Œç”¨è¿™ä¸ª token åœ¨ AppModule é‡Œå£°æ˜çš„ interceptorï¼ŒNest ä¼šæŠŠå®ƒä½œä¸ºå…¨å±€ interceptorï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b45c07e360ba4b98a459af3e22656037~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=6ZQy9QnDYWNRsui%2By9lxBPNbWyA%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ª interceptor é‡Œæˆ‘ä»¬æ³¨å…¥äº† appServiceï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11d382741f2f4f2b8885f5cb525ed442~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173316&amp;x-signature=x6%2By4tyiui43IjglRH2qp20Mths%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">æ€»ç»“</h2>
<p>rxjs æ˜¯ä¸€ä¸ªå¤„ç†å¼‚æ­¥é€»è¾‘çš„åº“ï¼Œå®ƒçš„ç‰¹ç‚¹å°±æ˜¯ operator å¤šï¼Œä½ å¯ä»¥é€šè¿‡ç»„åˆ operator æ¥å®Œæˆé€»è¾‘ï¼Œä¸éœ€è¦è‡ªå·±å†™ã€‚</p>
<p>nest çš„ interceptor å°±ç”¨äº† rxjs æ¥å¤„ç†å“åº”ï¼Œä½†å¸¸ç”¨çš„ operator ä¹Ÿå°±è¿™ä¹ˆå‡ ä¸ªï¼š</p>
<ul>
<li>tap: ä¸ä¿®æ”¹å“åº”æ•°æ®ï¼Œæ‰§è¡Œä¸€äº›é¢å¤–é€»è¾‘ï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—ã€æ›´æ–°ç¼“å­˜ç­‰</li>
<li>mapï¼šå¯¹å“åº”æ•°æ®åšä¿®æ”¹ï¼Œä¸€èˆ¬éƒ½æ˜¯æ”¹æˆ {code, data, message} çš„æ ¼å¼</li>
<li>catchErrorï¼šåœ¨ exception filter ä¹‹å‰å¤„ç†æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¯ä»¥è®°å½•æˆ–è€…æŠ›å‡ºåˆ«çš„å¼‚å¸¸</li>
<li>timeoutï¼šå¤„ç†å“åº”è¶…æ—¶çš„æƒ…å†µï¼ŒæŠ›å‡ºä¸€ä¸ª TimeoutErrorï¼Œé…åˆ catchErrror å¯ä»¥è¿”å›è¶…æ—¶çš„å“åº”</li>
</ul>
<p>æ€»ä¹‹ï¼Œrxjs çš„ operator å¤šï¼Œä½†æ˜¯é€‚åˆåœ¨ nest interceptor é‡Œç”¨çš„ä¹Ÿä¸å¤šã€‚</p>
<p>æ­¤å¤–ï¼Œinterceptor ä¹Ÿæ˜¯å¯ä»¥æ³¨å…¥ä¾èµ–çš„ï¼Œä½ å¯ä»¥é€šè¿‡æ³¨å…¥æ¨¡å—å†…çš„å„ç§ providerã€‚</p>
<p>å…¨å±€ interceptor å¯ä»¥é€šè¿‡ APP_INTERCEPTOR çš„ token å£°æ˜ï¼Œè¿™ç§èƒ½æ³¨å…¥ä¾èµ–ï¼Œæ¯” app.useGlobalInterceptors æ›´å¥½ã€‚</p>
<p>interceptor æ˜¯ nest å¿…ç”¨åŠŸèƒ½ï¼Œè¿˜æ˜¯è¦å¥½å¥½æŒæ¡çš„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£JavaScriptè¯æ³•ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾]]></title>    <link>https://juejin.cn/post/7599912857392873518</link>    <guid>https://juejin.cn/post/7599912857392873518</guid>    <pubDate>2026-01-28T02:47:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599912857392873518" data-draft-id="7599963665039376434" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£JavaScriptè¯æ³•ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-28T02:47:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="wuhen_n"/> <meta itemprop="url" content="https://juejin.cn/user/4149996261738233"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£JavaScriptè¯æ³•ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4149996261738233/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    wuhen_n
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:47:06.000Z" title="Wed Jan 28 2026 02:47:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä¸ºä»€ä¹ˆ JavaScript çš„å‡½æ•°æ€»èƒ½æ¸…æ¥šåœ°"è®°ä½"å˜é‡åœ¨å“ªé‡Œè¢«å®šä¹‰ï¼Ÿä¸ºä»€ä¹ˆé—­åŒ…å¦‚æ­¤ç¥å¥‡ï¼Ÿè¿™ä¸€åˆ‡çš„ç­”æ¡ˆéƒ½éšè—åœ¨"è¯æ³•ä½œç”¨åŸŸ"è¿™ä¸ªæ ¸å¿ƒæ¦‚å¿µä¸­ã€‚</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€ï¼šä»ä¸€é“ç»å…¸é¢è¯•é¢˜è¯´èµ·</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">outer</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> a = <span class="hljs-number">2</span>;
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">inner</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a);
    }
    <span class="hljs-keyword">return</span> inner;
}

<span class="hljs-keyword">var</span> innerFunc = <span class="hljs-title function_">outer</span>();
<span class="hljs-title function_">innerFunc</span>(); <span class="hljs-comment">// è¾“å‡ºä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</span>
</code></pre>
<p>å¤§å¤šæ•°å‰ç«¯å¼€å‘è€…éƒ½çŸ¥é“è¾“å‡ºç»“æœä¸ºï¼š2ï¼Œä½†èƒ½å®Œæ•´è§£é‡Š"ä¸ºä»€ä¹ˆ"çš„äººå´ä¸å¤šã€‚æœ¬ç¯‡æ–‡ç« å°±æ¥å½»åº•æ­å¼€JavaScriptä½œç”¨åŸŸçš„ç¥ç§˜é¢çº±ã€‚</p>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯è¯æ³•ä½œç”¨åŸŸï¼Ÿ</h2>
<h3 data-id="heading-2">é™æ€ä½œç”¨åŸŸ vs åŠ¨æ€ä½œç”¨åŸŸ</h3>
<p><strong>è¯æ³•ä½œç”¨åŸŸ</strong>ï¼ˆLexical Scopeï¼‰ï¼Œä¹Ÿç§°ä¸º<strong>é™æ€ä½œç”¨åŸŸ</strong>ï¼Œæ˜¯ JavaScript é‡‡ç”¨çš„ä½œç”¨åŸŸæ¨¡å‹ã€‚å®ƒçš„æ ¸å¿ƒç‰¹ç‚¹æ˜¯ï¼š</p>
<blockquote>
<p>å‡½æ•°çš„ä½œç”¨åŸŸåœ¨å‡½æ•°å®šä¹‰æ—¶å°±ç¡®å®šäº†ï¼Œè€Œä¸æ˜¯åœ¨å‡½æ•°è°ƒç”¨æ—¶ç¡®å®šã€‚</p>
</blockquote>
<p>è¿™ä¸<strong>åŠ¨æ€ä½œç”¨åŸŸ</strong>å½¢æˆé²œæ˜å¯¹æ¯”ã€‚è®©æˆ‘ä»¬é€šè¿‡ä»£ç ç†è§£ä¸¤è€…çš„åŒºåˆ«ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> value = <span class="hljs-string">"global"</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">bar</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> value = <span class="hljs-string">"local"</span>;
    <span class="hljs-title function_">foo</span>(); <span class="hljs-comment">// è¾“å‡ºä»€ä¹ˆï¼Ÿ</span>
}

<span class="hljs-title function_">bar</span>(); 
</code></pre>
<p>ä¸Šè¿°ä»£ç çš„è¾“å‡ºç»“æœæ˜¯ï¼š<code>global</code>ã€‚å› ä¸º <code>foo()</code> å‡½æ•°åœ¨å®šä¹‰æ—¶ï¼Œå®ƒçš„ä½œç”¨åŸŸé“¾å°±å·²ç¡®å®šï¼ŒåŒ…å«å…¨å±€ä½œç”¨åŸŸã€‚æ‰€ä»¥å®ƒè®¿é—®çš„æ˜¯å…¨å±€çš„ <code>value</code> å˜é‡ï¼Œè€Œä¸æ˜¯è°ƒç”¨ä½ç½®çš„ <code>value</code> ã€‚</p>
<p>å¦‚æœJavaScriptåŠ¨æ€ä½œç”¨åŸŸï¼ˆå®é™…ä¸Šä¸æ˜¯ï¼‰ï¼Œåˆä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> value = <span class="hljs-string">"global"</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">// åŠ¨æ€ä½œç”¨åŸŸä¸‹ï¼šè®¿é—®è°ƒç”¨ä½ç½®çš„value</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">bar</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> value = <span class="hljs-string">"local"</span>;
    <span class="hljs-title function_">foo</span>(); <span class="hljs-comment">// åŠ¨æ€ä½œç”¨åŸŸä¸‹ä¼šè¾“å‡ºï¼š"local"</span>
}
<span class="hljs-title function_">bar</span>();
</code></pre>
<h4 data-id="heading-3">å…³é”®åŒºåˆ«æ€»ç»“</h4>
<ul>
<li>è¯æ³•ä½œç”¨åŸŸï¼šå‡½æ•°çš„ä½œç”¨åŸŸç”±å®šä¹‰ä½ç½®å†³å®šã€‚</li>
<li>åŠ¨æ€ä½œç”¨åŸŸï¼šå‡½æ•°çš„ä½œç”¨åŸŸç”±è°ƒç”¨ä½ç½®å†³å®šã€‚</li>
</ul>
<h3 data-id="heading-4">è¯æ³•ç¯å¢ƒçš„ç»“æ„</h3>
<p>åœ¨ JavaScript å¼•æ“å†…éƒ¨ï¼Œæ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡éƒ½æœ‰ä¸€ä¸ªå…³è”çš„<strong>è¯æ³•ç¯å¢ƒ</strong>ï¼ˆLexical Environmentï¼‰ã€‚è¯æ³•ç¯å¢ƒç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š<strong>ç¯å¢ƒè®°å½•å™¨</strong>ï¼ˆEnvironmentRecordï¼‰å’Œ<strong>å¯¹å¤–éƒ¨è¯æ³•ç¯å¢ƒçš„å¼•ç”¨</strong>ï¼ˆOuterï¼‰ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">LexicalEnvironment</span> = {
    <span class="hljs-title class_">EnvironmentRecord</span>: {
        <span class="hljs-comment">// 1. ç¯å¢ƒè®°å½•å™¨ï¼šå­˜å‚¨å˜é‡å’Œå‡½æ•°å£°æ˜</span>
        <span class="hljs-comment">// åŒ…å«ï¼šå£°æ˜å¼ç¯å¢ƒè®°å½•ã€å¯¹è±¡ç¯å¢ƒè®°å½•</span>
    },
    <span class="hljs-title class_">Outer</span>: <span class="hljs-literal">null</span> | &lt;çˆ¶çº§è¯æ³•ç¯å¢ƒå¼•ç”¨&gt;  <span class="hljs-comment">// 2. å¯¹å¤–éƒ¨è¯æ³•ç¯å¢ƒçš„å¼•ç”¨</span>
}

<span class="hljs-comment">// å®é™…ä»£ç ç¤ºä¾‹</span>
<span class="hljs-keyword">var</span> globalVar = <span class="hljs-string">"global"</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">outer</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> outerVar = <span class="hljs-string">"outer"</span>;
    
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">inner</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">var</span> innerVar = <span class="hljs-string">"inner"</span>;
        <span class="hljs-comment">// innerå‡½æ•°çš„è¯æ³•ç¯å¢ƒï¼š</span>
        <span class="hljs-comment">// {</span>
        <span class="hljs-comment">//     EnvironmentRecord: { innerVar: "inner" },</span>
        <span class="hljs-comment">//     Outer: &lt;outerå‡½æ•°çš„è¯æ³•ç¯å¢ƒ&gt;</span>
        <span class="hljs-comment">// }</span>
    }
}
</code></pre>
<h3 data-id="heading-5">ä½œç”¨åŸŸé“¾çš„å½¢æˆè¿‡ç¨‹</h3>
<p>ä½œç”¨åŸŸé“¾å°±æ˜¯ç”±è¿™äº›è¯æ³•ç¯å¢ƒé€šè¿‡ <code>Outer</code> å¼•ç”¨è¿æ¥èµ·æ¥çš„é“¾å¼ç»“æ„ã€‚</p>
<h2 data-id="heading-6">ä½œç”¨åŸŸé“¾çš„æŸ¥æ‰¾æœºåˆ¶</h2>
<h3 data-id="heading-7">å˜é‡æŸ¥æ‰¾çš„å®Œæ•´æµç¨‹</h3>
<p>å½“ JavaScript å¼•æ“éœ€è¦è®¿é—®ä¸€ä¸ªå˜é‡æ—¶ï¼Œå®ƒä¼šæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡ŒæŸ¥æ‰¾ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¤šå±‚åµŒå¥—ä½œç”¨åŸŸç¤ºä¾‹</span>
<span class="hljs-keyword">var</span> a = <span class="hljs-string">"global a"</span>;
<span class="hljs-keyword">var</span> b = <span class="hljs-string">"global b"</span>;
<span class="hljs-keyword">var</span> c = <span class="hljs-string">"global c"</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">level1</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> a = <span class="hljs-string">"level1 a"</span>;
    <span class="hljs-keyword">var</span> b = <span class="hljs-string">"level1 b"</span>;   
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">level2</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">var</span> a = <span class="hljs-string">"level2 a"</span>;
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">level3</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">var</span> a = <span class="hljs-string">"level3 a"</span>;
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// "level3 a" - æ‰¾åˆ°æœ€è¿‘çš„a</span>
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b); <span class="hljs-comment">// "level1 b" - å‘ä¸Šä¸¤å±‚æ‰¾åˆ°b</span>
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(c); <span class="hljs-comment">// "global c" - å‘ä¸Šä¸‰å±‚æ‰¾åˆ°c</span>
        }
        <span class="hljs-title function_">level3</span>();
    }
    <span class="hljs-title function_">level2</span>();
}
<span class="hljs-title function_">level1</span>();
</code></pre>
<p>æŸ¥æ‰¾å˜é‡cçš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>æ£€æŸ¥level3çš„ç¯å¢ƒè®°å½• â†’ æ²¡æœ‰c</li>
<li>é€šè¿‡Outerå¼•ç”¨æ£€æŸ¥level2çš„ç¯å¢ƒè®°å½• â†’ æ²¡æœ‰c</li>
<li>é€šè¿‡Outerå¼•ç”¨æ£€æŸ¥level1çš„ç¯å¢ƒè®°å½• â†’ æ²¡æœ‰c</li>
<li>é€šè¿‡Outerå¼•ç”¨æ£€æŸ¥å…¨å±€ç¯å¢ƒè®°å½• â†’ æ‰¾åˆ°c = "global c"</li>
<li>å¦‚æœä¸€ç›´æ‰¾åˆ°æœ€å¤–å±‚éƒ½æ²¡æ‰¾åˆ°ï¼šundefined</li>
</ol>
<h3 data-id="heading-8">å›¾è§£ï¼šä½œç”¨åŸŸé“¾çš„æ ‘çŠ¶ç»“æ„</h3>
<p>è®©æˆ‘ä»¬ç”¨å¯è§†åŒ–æ–¹å¼ç†è§£ä½œç”¨åŸŸé“¾ï¼š</p>
<pre><code class="hljs language-text" lang="text">å…¨å±€è¯æ³•ç¯å¢ƒ (Global Lexical Environment)
â”œâ”€ EnvironmentRecord: { a: "global a", b: "global b", c: "global c" }
â”œâ”€ Outer: null
â”‚
â”œâ”€ level1å‡½æ•°è¯æ³•ç¯å¢ƒ (è°ƒç”¨æ—¶åˆ›å»º)
â”‚  â”œâ”€ EnvironmentRecord: { a: "level1 a", b: "level1 b" }
â”‚  â”œâ”€ Outer: å¼•ç”¨ â†’ å…¨å±€è¯æ³•ç¯å¢ƒ
â”‚  â”‚
â”‚  â”œâ”€ level2å‡½æ•°è¯æ³•ç¯å¢ƒ (è°ƒç”¨æ—¶åˆ›å»º)
â”‚  â”‚  â”œâ”€ EnvironmentRecord: { a: "level2 a" }
â”‚  â”‚  â”œâ”€ Outer: å¼•ç”¨ â†’ level1è¯æ³•ç¯å¢ƒ
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ level3å‡½æ•°è¯æ³•ç¯å¢ƒ (è°ƒç”¨æ—¶åˆ›å»º)
â”‚  â”‚  â”‚  â”œâ”€ EnvironmentRecord: { a: "level3 a" }
â”‚  â”‚  â”‚  â”œâ”€ Outer: å¼•ç”¨ â†’ level2è¯æ³•ç¯å¢ƒ
â”‚  â”‚  â”‚  â””â”€ å˜é‡æŸ¥æ‰¾è·¯å¾„ï¼šlevel3 â†’ level2 â†’ level1 â†’ å…¨å±€
â”‚  â”‚  â””â”€ 
â”‚  â””â”€ 
â””â”€
</code></pre>
<h3 data-id="heading-9">ä½œç”¨åŸŸé“¾çš„å…³é”®ç‰¹æ€§</h3>
<ol>
<li>é™æ€æ€§ï¼ˆè¯æ³•ä½œç”¨åŸŸï¼‰ï¼šä½œç”¨åŸŸé“¾åœ¨å‡½æ•°å®šä¹‰æ—¶å°±å·²ç»ç¡®å®šï¼Œè€Œä¸æ˜¯åœ¨è°ƒç”¨æ—¶ç¡®å®šçš„ã€‚</li>
<li>é“¾å¼ç»“æ„ï¼šåƒé“¾æ¡ä¸€æ ·ä¸€ç¯æ‰£ä¸€ç¯ï¼Œä»å½“å‰ä½œç”¨åŸŸæŒ‡å‘å¤–å±‚ä½œç”¨åŸŸã€‚</li>
<li>å•å‘æ€§ï¼šåªèƒ½ä»å†…å±‚ä½œç”¨åŸŸè®¿é—®å¤–å±‚ä½œç”¨åŸŸçš„å˜é‡ï¼Œä¸èƒ½åå‘è®¿é—®ã€‚</li>
<li>ä¸æ‰§è¡Œä¸Šä¸‹æ–‡ç›¸å…³ï¼šæ¯æ¬¡å‡½æ•°è°ƒç”¨éƒ½ä¼šåˆ›å»ºæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä½†ä½œç”¨åŸŸé“¾åŸºäºå‡½æ•°å®šä¹‰ä½ç½®ç¡®å®šã€‚</li>
</ol>
<h3 data-id="heading-10">é—­åŒ…ä¸ä½œç”¨åŸŸé“¾çš„æŒä¹…åŒ–</h3>
<p>é—­åŒ…çš„æœ¬è´¨å°±æ˜¯ï¼š<code>å‡½æ•°è®°ä½äº†å®ƒè¢«åˆ›å»ºæ—¶çš„è¯æ³•ç¯å¢ƒ</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createCounter</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;  <span class="hljs-comment">// è¿™ä¸ªå˜é‡æœ¬è¯¥åœ¨å‡½æ•°æ‰§è¡Œåé”€æ¯</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        count++;  <span class="hljs-comment">// ä¿æŒå¯¹å¤–éƒ¨å˜é‡çš„å¼•ç”¨ï¼Œè¿™å°±æ˜¯é—­åŒ…</span>
        <span class="hljs-keyword">return</span> count;
    };
}

<span class="hljs-keyword">const</span> counter = <span class="hljs-title function_">createCounter</span>();

<span class="hljs-comment">// å³ä½¿createCounteræ‰§è¡Œå®Œæ¯•ï¼Œå®ƒçš„è¯æ³•ç¯å¢ƒä¹Ÿä¸ä¼šè¢«é”€æ¯</span>
<span class="hljs-comment">// å› ä¸ºè¿”å›çš„å†…éƒ¨å‡½æ•°ä»ç„¶å¼•ç”¨ç€å®ƒ</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">counter</span>()); <span class="hljs-comment">// 1</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">counter</span>()); <span class="hljs-comment">// 2</span>
</code></pre>
<h2 data-id="heading-11">å—çº§ä½œç”¨åŸŸçš„å®ç°åŸç†</h2>
<h3 data-id="heading-12">ES5ä½œç”¨åŸŸçš„é—®é¢˜</h3>
<p>åœ¨ES5ä¸­ï¼Œåªæœ‰ä¸¤ç§ä½œç”¨åŸŸï¼šå…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸã€‚è¿™å¯¼è‡´äº†ä¸€äº›é—®é¢˜ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ES5çš„é—®é¢˜ï¼šå˜é‡æå‡å’Œç¼ºå°‘å—çº§ä½œç”¨åŸŸ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">problematic</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i); <span class="hljs-comment">// undefinedï¼Œè€Œä¸æ˜¯ReferenceError</span>
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
        <span class="hljs-comment">// iåœ¨æ•´ä¸ªå‡½æ•°å†…éƒ½å¯è§</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i); <span class="hljs-comment">// å…¨éƒ¨è¾“å‡º3</span>
        }, <span class="hljs-number">100</span>);
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i); <span class="hljs-comment">// 3ï¼Œå¾ªç¯ç»“æŸåçš„i</span>
}

<span class="hljs-title function_">problematic</span>();
</code></pre>
<h3 data-id="heading-13">let/constå¸¦æ¥çš„å—çº§ä½œç”¨åŸŸ</h3>
<p>ES6å¼•å…¥çš„ <code>let/const</code> å¸¦æ¥äº†çœŸæ­£çš„å—çº§ä½œç”¨åŸŸï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å—çº§ä½œç”¨åŸŸç¤ºä¾‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">withBlockScope</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) {
        <span class="hljs-comment">// å—çº§ä½œç”¨åŸŸå¼€å§‹</span>
        <span class="hljs-keyword">let</span> blockScoped = <span class="hljs-string">"åªåœ¨å—å†…æœ‰æ•ˆ"</span>;
        <span class="hljs-keyword">const</span> constantValue = <span class="hljs-string">"å¸¸é‡"</span>;
        {
            <span class="hljs-comment">// åµŒå¥—å—çº§ä½œç”¨åŸŸ</span>
            <span class="hljs-keyword">let</span> nestedBlock = <span class="hljs-string">"åµŒå¥—å—"</span>;
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(blockScoped); <span class="hljs-comment">// å¯ä»¥è®¿é—®å¤–å±‚å—çš„å˜é‡</span>
        }
        <span class="hljs-comment">// console.log(nestedBlock); // ReferenceError</span>
    }
    <span class="hljs-comment">// console.log(blockScoped); // ReferenceError</span>
}
</code></pre>
<h4 data-id="heading-14">let/constçš„å®ç°åŸç†ï¼š</h4>
<ol>
<li>åœ¨ç¼–è¯‘é˜¶æ®µï¼Œ<code>let/const</code> å£°æ˜çš„å˜é‡è¢«è®°å½•åœ¨è¯æ³•ç¯å¢ƒä¸­</li>
<li>åœ¨å˜é‡å£°æ˜ä¹‹å‰è®¿é—®ä¼šæŠ›å‡ºé”™è¯¯ï¼ˆæš‚æ—¶æ€§æ­»åŒºï¼‰</li>
<li>æ¯ä¸ª <code>{}</code> ä»£ç å—éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¯æ³•ç¯å¢ƒ</li>
</ol>
<h3 data-id="heading-15">å—çº§ä½œç”¨åŸŸçš„åµŒå¥—ç»“æ„</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¤šå±‚å—çº§ä½œç”¨åŸŸ</span>
{
    <span class="hljs-keyword">let</span> a = <span class="hljs-string">"å¤–å±‚å— a"</span>;
    <span class="hljs-keyword">const</span> b = <span class="hljs-string">"å¤–å±‚å— b"</span>;
    
    {
        <span class="hljs-keyword">let</span> a = <span class="hljs-string">"å†…å±‚å— a"</span>; <span class="hljs-comment">// å¯ä»¥é‡æ–°å£°æ˜ï¼Œå› ä¸ºä¸åŒå—</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a);    <span class="hljs-comment">// "å†…å±‚å— a"</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b);    <span class="hljs-comment">// "å¤–å±‚å— b" - å¯ä»¥è®¿é—®å¤–å±‚</span>
        
        {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// "å†…å±‚å— a"</span>
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b); <span class="hljs-comment">// "å¤–å±‚å— b"</span>
        }
    }
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// "å¤–å±‚å— a"</span>
}
</code></pre>
<p>å…¶è¯æ³•ç¯å¢ƒç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-text" lang="text"> å¤–å±‚å—è¯æ³•ç¯å¢ƒ: { a: "å¤–å±‚å— a", b: "å¤–å±‚å— b", Outer: å…¨å±€ }
   â†“
 å†…å±‚å—è¯æ³•ç¯å¢ƒ: { a: "å†…å±‚å— a", Outer: å¤–å±‚å—è¯æ³•ç¯å¢ƒ }
   â†“
 æœ€å†…å±‚å—è¯æ³•ç¯å¢ƒ: { Outer: å†…å±‚å—è¯æ³•ç¯å¢ƒ }
</code></pre>
<h3 data-id="heading-16">æš‚æ—¶æ€§æ­»åŒºï¼ˆTemporal Dead Zoneï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript">{
  <span class="hljs-comment">// TDZå¼€å§‹</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(myVar); <span class="hljs-comment">// undefined</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(myLet); <span class="hljs-comment">// ReferenceError</span>

  <span class="hljs-keyword">var</span> myVar = <span class="hljs-string">"varå˜é‡"</span>;
  <span class="hljs-keyword">let</span> myLet = <span class="hljs-string">"letå˜é‡"</span>;
  <span class="hljs-comment">// TDZç»“æŸ</span>
}
</code></pre>
<p>ä¸Šè¿°å®é™…æ‰§è¡Œè¿‡ç¨‹ï¼ˆç®€åŒ–ï¼‰ï¼š</p>
<ol>
<li>è¿›å…¥å—çº§ä½œç”¨åŸŸï¼Œåˆ›å»ºè¯æ³•ç¯å¢ƒ</li>
<li>varå£°æ˜è¢«æå‡ï¼Œåˆå§‹å€¼ä¸º undefined</li>
<li>letå£°æ˜è¢«è®°å½•ï¼Œä½†æœªåˆå§‹åŒ–ï¼ˆåœ¨TDZä¸­ä¸å¯è°ƒç”¨ï¼‰</li>
<li>åœ¨letåˆå§‹åŒ–å‰è®¿é—® â†’ ReferenceError</li>
</ol>
<h2 data-id="heading-17">å¸¸è§é¢è¯•é¢˜è§£æ</h2>
<h3 data-id="heading-18">å¤šçº§åµŒå¥—ä½œç”¨åŸŸ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> x = <span class="hljs-number">10</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(x);
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">bar</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> x = <span class="hljs-number">20</span>;
    <span class="hljs-title function_">foo</span>();
}
<span class="hljs-title function_">bar</span>(); <span class="hljs-comment">// è¾“å‡ºä»€ä¹ˆï¼Ÿ</span>
</code></pre>
<p>ä¸Šè¿°ä»£ç è¾“å‡ºç»“æœä¸ºï¼š10ï¼š</p>
<ol>
<li>fooå‡½æ•°å®šä¹‰åœ¨å…¨å±€ä½œç”¨åŸŸã€‚</li>
<li>å› æ­¤fooçš„è¯æ³•ä½œç”¨åŸŸé“¾ï¼šfooä½œç”¨åŸŸ â†’ å…¨å±€ä½œç”¨åŸŸã€‚</li>
<li>fooåœ¨å®šä¹‰æ—¶å°±ç¡®å®šäº†ä½œç”¨åŸŸé“¾ï¼Œä¸è°ƒç”¨ä½ç½®æ— å…³ã€‚</li>
<li>fooä¸­è®¿é—®xæ—¶ï¼Œåœ¨è‡ªèº«ä½œç”¨åŸŸæ²¡æ‰¾åˆ°ï¼Œåˆ°å…¨å±€ä½œç”¨åŸŸæ‰¾åˆ°<code>x=10</code> ã€‚</li>
</ol>
<h3 data-id="heading-19">é—­åŒ…ä¸å¾ªç¯</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createFunctions</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> result = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
        result[i] = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
            <span class="hljs-keyword">return</span> i;
        };
    }
    <span class="hljs-keyword">return</span> result;
}

<span class="hljs-keyword">var</span> funcs = <span class="hljs-title function_">createFunctions</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(funcs[<span class="hljs-number">0</span>]()); <span class="hljs-comment">// 3</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(funcs[<span class="hljs-number">1</span>]()); <span class="hljs-comment">// 3  </span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(funcs[<span class="hljs-number">2</span>]()); <span class="hljs-comment">// 3</span>
</code></pre>
<blockquote>
<p>è¯¦ç»†è§£æè¿‡ç¨‹ä¸è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fwuhen_n%2Farticle%2Fdetails%2F157430747" target="_blank" title="https://blog.csdn.net/wuhen_n/article/details/157430747" ref="nofollow noopener noreferrer">JavaScriptå†…å­˜ç®¡ç†æ­ç§˜ï¼šå˜é‡ç©¶ç«Ÿå­˜åœ¨å“ªé‡Œ</a></p>
</blockquote>
<h3 data-id="heading-20">å¤æ‚çš„åµŒå¥—ä½œç”¨åŸŸ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> a = <span class="hljs-number">2</span>;    
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">innerTest</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">var</span> a = <span class="hljs-number">3</span>;        
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a);
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">a</span>);
        };
    }    
    <span class="hljs-keyword">var</span> obj = {
        <span class="hljs-attr">a</span>: <span class="hljs-number">4</span>,
        <span class="hljs-attr">getFunc</span>: <span class="hljs-title function_">innerTest</span>()
    };   
    <span class="hljs-keyword">return</span> obj.<span class="hljs-property">getFunc</span>;
}
<span class="hljs-keyword">var</span> func = <span class="hljs-title function_">test</span>();
<span class="hljs-title function_">func</span>();
</code></pre>
<p>ä¸Šè¿°ä»£ç çš„è¾“å‡ºç»“æœæ˜¯ï¼š<code>3 1</code> :</p>
<ol>
<li><code>func</code> æ˜¯ <code>innerTest</code> è¿”å›çš„åŒ¿åå‡½æ•°</li>
<li>åŒ¿åå‡½æ•°å®šä¹‰åœ¨ <code>innerTest</code> å†…éƒ¨ï¼Œæ‰€ä»¥å®ƒçš„è¯æ³•ä½œç”¨åŸŸé“¾ï¼š
<ul>
<li>åŒ¿åå‡½æ•°ä½œç”¨åŸŸ â†’ <code>innerTest</code> ä½œç”¨åŸŸ(<code>a=3</code>) â†’ <code>test</code> ä½œç”¨åŸŸ(<code>a=2</code>) â†’ å…¨å±€(<code>a=1</code>)</li>
</ul>
</li>
<li><code>console.log(a)</code>ï¼šåœ¨è‡ªèº«ä½œç”¨åŸŸæ²¡æ‰¾åˆ°ï¼Œåˆ°innerTestæ‰¾åˆ°a=3</li>
<li><code>console.log(this.a)</code>ï¼š<code>this</code>æŒ‡å‘å…¨å±€ <code>window</code> å¯¹è±¡ï¼Œè¾“å‡ºå…¨å±€<code>a=1</code></li>
</ol>
<h2 data-id="heading-21">æ€è€ƒé¢˜</h2>
<p>å¦‚æœJavaScripté‡‡ç”¨åŠ¨æ€ä½œç”¨åŸŸè€Œä¸æ˜¯è¯æ³•ä½œç”¨åŸŸï¼Œä¼šæœ‰ä»€ä¹ˆå½±å“ï¼Ÿé—­åŒ…è¿˜èƒ½å·¥ä½œå—ï¼Ÿ</p>
<h2 data-id="heading-22">ç»“è¯­</h2>
<p>JavaScriptçš„è¯æ³•ä½œç”¨åŸŸæœºåˆ¶æ—¢æ˜¯å…¶å¼ºå¤§ä¹‹å¤„ï¼Œä¹Ÿæ˜¯åˆå­¦è€…å®¹æ˜“å›°æƒ‘çš„åœ°æ–¹ã€‚æ·±å…¥ç†è§£è¿™ä¸€æœºåˆ¶ï¼Œä¸ä»…èƒ½å¸®åŠ©ä½ å†™å‡ºæ›´å¥½çš„ä»£ç ï¼Œè¿˜èƒ½åœ¨é¢è¯•ä¸­æ¸¸åˆƒæœ‰ä½™åœ°è§£ç­”ç›¸å…³é¢˜ç›®ã€‚å¯¹äºæ–‡ç« ä¸­é”™è¯¯çš„åœ°æ–¹æˆ–è€…æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€è®¨è®ºï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Everything Claude Code é¡¹ç›®å®Œå…¨æŒ‡å—ï¼Œå¦‚ä½•ä¼˜é›…çš„ä½¿ç”¨Claude]]></title>    <link>https://juejin.cn/post/7599965904616833070</link>    <guid>https://juejin.cn/post/7599965904616833070</guid>    <pubDate>2026-01-28T02:36:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599965904616833070" data-draft-id="7599951933593976842" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Everything Claude Code é¡¹ç›®å®Œå…¨æŒ‡å—ï¼Œå¦‚ä½•ä¼˜é›…çš„ä½¿ç”¨Claude"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T02:36:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hhang"/> <meta itemprop="url" content="https://juejin.cn/user/1994944446213274"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Everything Claude Code é¡¹ç›®å®Œå…¨æŒ‡å—ï¼Œå¦‚ä½•ä¼˜é›…çš„ä½¿ç”¨Claude
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1994944446213274/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Hhang
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:36:28.000Z" title="Wed Jan 28 2026 02:36:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Everything Claude Code é¡¹ç›®å®Œå…¨æŒ‡å—</h2>
<blockquote>
<p>å°† Claude Code æ‰“é€ æˆä¸“ä¸šå¼€å‘ç¯å¢ƒçš„ç»ˆæé…ç½®å·¥å…·åŒ…</p>
</blockquote>
<h3 data-id="heading-1">ä¸€ã€é¡¹ç›®ç®€ä»‹</h3>
<h4 data-id="heading-2">ä»€ä¹ˆæ˜¯ Everything Claude Codeï¼Ÿ</h4>
<p><strong>Everything Claude Code</strong> æ˜¯ä¸€ä¸ªç”± Anthropic é»‘å®¢æ¾å† å†› <strong>Affaan Mustafa</strong> åˆ›å»ºçš„å¼€æºé¡¹ç›®ï¼Œæä¾›äº†ä¸€å¥—å®Œæ•´çš„ Claude Code é…ç½®é›†åˆï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>Agentsï¼ˆä»£ç†ï¼‰</strong>ï¼šä¸“ä¸šåŒ–çš„å­ä»£ç†ç”¨äºä»»åŠ¡å§”æ´¾</li>
<li><strong>Skillsï¼ˆæŠ€èƒ½ï¼‰</strong>ï¼šå·¥ä½œæµå®šä¹‰å’Œé¢†åŸŸçŸ¥è¯†</li>
<li><strong>Hooksï¼ˆé’©å­ï¼‰</strong>ï¼šåŸºäºè§¦å‘å™¨çš„è‡ªåŠ¨åŒ–</li>
<li><strong>Commandsï¼ˆå‘½ä»¤ï¼‰</strong>ï¼šå¿«é€Ÿæ‰§è¡Œçš„æ–œæ å‘½ä»¤</li>
<li><strong>Rulesï¼ˆè§„åˆ™ï¼‰</strong>ï¼šå§‹ç»ˆéµå¾ªçš„å¼€å‘å‡†åˆ™</li>
<li><strong>MCP Configsï¼ˆMCP é…ç½®ï¼‰</strong>ï¼šå¤šæ¨¡æ€èŠå¤©åè®®æœåŠ¡å™¨é…ç½®</li>
</ul>
<p>è¿™äº›é…ç½®æ˜¯ä½œè€…ç»è¿‡ <strong>10 ä¸ªå¤šæœˆçš„å¯†é›†æ—¥å¸¸ä½¿ç”¨</strong>ï¼Œåœ¨æ„å»ºçœŸå®äº§å“è¿‡ç¨‹ä¸­ä¸æ–­æ‰“ç£¨å½¢æˆçš„"å®æˆ˜éªŒè¯"é…ç½®ã€‚</p>
<h4 data-id="heading-3">é¡¹ç›®èƒŒæ™¯</h4>
<p>Affaan Mustafa è‡ª Claude Code å®éªŒæ€§å‘å¸ƒä»¥æ¥å°±ä¸€ç›´åœ¨ä½¿ç”¨å®ƒã€‚2025 å¹´ 9 æœˆï¼Œä»–ä¸é˜Ÿå‹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2FDRodriguezFX" target="_blank" title="https://x.com/DRodriguezFX" ref="nofollow noopener noreferrer">@DRodriguezFX</a> ä½¿ç”¨è¿™å¥—é…ç½®ï¼Œä»…ç”¨ <strong>8 å°æ—¶</strong>å°±å®Œå…¨ä½¿ç”¨ Claude Code æ„å»ºäº† <a href="https://link.juejin.cn?target=https%3A%2F%2Fzenith.chat" target="_blank" title="https://zenith.chat" ref="nofollow noopener noreferrer">zenith.chat</a>ï¼Œå¹¶èµ¢å¾—äº† <strong>Anthropic x Forum Ventures é»‘å®¢æ¾</strong>ã€‚</p>
<h4 data-id="heading-4">è§£å†³çš„é—®é¢˜</h4>
<ul>
<li><strong>ä¸Šä¸‹æ–‡è…åŒ–</strong>ï¼šé•¿ä¼šè¯ä¸­çš„ä¸Šä¸‹æ–‡ç®¡ç†é—®é¢˜</li>
<li><strong>ä»£ç è´¨é‡ä¸ä¸€è‡´</strong>ï¼šç¼ºä¹ç»Ÿä¸€çš„ä»£ç æ ‡å‡†</li>
<li><strong>é‡å¤è§£é‡Šæµªè´¹æ—¶é—´</strong>ï¼šæ¯æ¬¡éƒ½è¦é‡æ–°è¯´æ˜é¡¹ç›®è§„èŒƒ</li>
</ul>
<hr/>
<h3 data-id="heading-5">äºŒã€æ ¸å¿ƒç»„ä»¶è¯¦è§£</h3>
<h4 data-id="heading-6">2.1 Agentsï¼ˆä»£ç†ï¼‰</h4>
<p>å­ä»£ç†æ˜¯å…·æœ‰æœ‰é™èŒƒå›´çš„å§”æ´¾ä»»åŠ¡å¤„ç†å™¨ã€‚é¡¹ç›®æä¾›äº†å¤šä¸ªä¸“ä¸šä»£ç†ï¼š</p>













































<table><thead><tr><th>ä»£ç†åç§°</th><th>åŠŸèƒ½è¯´æ˜</th></tr></thead><tbody><tr><td><code>planner.md</code></td><td>åŠŸèƒ½å®ç°è§„åˆ’</td></tr><tr><td><code>architect.md</code></td><td>ç³»ç»Ÿè®¾è®¡å†³ç­–</td></tr><tr><td><code>tdd-guide.md</code></td><td>æµ‹è¯•é©±åŠ¨å¼€å‘</td></tr><tr><td><code>code-reviewer.md</code></td><td>ä»£ç è´¨é‡å’Œå®‰å…¨å®¡æŸ¥</td></tr><tr><td><code>security-reviewer.md</code></td><td>æ¼æ´åˆ†æ</td></tr><tr><td><code>build-error-resolver.md</code></td><td>æ„å»ºé”™è¯¯è§£å†³</td></tr><tr><td><code>e2e-runner.md</code></td><td>Playwright E2E æµ‹è¯•</td></tr><tr><td><code>refactor-cleaner.md</code></td><td>æ­»ä»£ç æ¸…ç†</td></tr><tr><td><code>doc-updater.md</code></td><td>æ–‡æ¡£åŒæ­¥</td></tr></tbody></table>
<blockquote>
<p>é¡¹ç›®è¿˜æä¾›äº†é’ˆå¯¹ç‰¹å®šè¯­è¨€çš„ä»£ç†ï¼Œå¦‚ Go ä»£ç å®¡æŸ¥ã€Go æ„å»ºé”™è¯¯è§£å†³ç­‰ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±ä½¿ç”¨çš„æŠ€æœ¯æ ˆé€‰æ‹©æ€§å¯ç”¨ã€‚</p>
</blockquote>
<p><strong>ä»£ç†é…ç½®ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">code-reviewer</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">Reviews</span> <span class="hljs-string">code</span> <span class="hljs-string">for</span> <span class="hljs-string">quality,</span> <span class="hljs-string">security,</span> <span class="hljs-string">and</span> <span class="hljs-string">maintainability</span>
<span class="hljs-attr">tools:</span> [<span class="hljs-string">"Read"</span>, <span class="hljs-string">"Grep"</span>, <span class="hljs-string">"Glob"</span>, <span class="hljs-string">"Bash"</span>]
<span class="hljs-attr">model:</span> <span class="hljs-string">opus</span>
<span class="hljs-meta">---</span>
<span class="hljs-string">You</span> <span class="hljs-string">are</span> <span class="hljs-string">a</span> <span class="hljs-string">senior</span> <span class="hljs-string">code</span> <span class="hljs-string">reviewer...</span>
</code></pre>
<h4 data-id="heading-7">2.2 Skillsï¼ˆæŠ€èƒ½ï¼‰</h4>
<p>æŠ€èƒ½æ˜¯å·¥ä½œæµå®šä¹‰ï¼Œå¯è¢«å‘½ä»¤æˆ–ä»£ç†è°ƒç”¨ï¼š</p>









































<table><thead><tr><th>æŠ€èƒ½ç›®å½•</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>coding-standards/</code></td><td>å¤šè¯­è¨€æœ€ä½³å®è·µ</td></tr><tr><td><code>backend-patterns/</code></td><td>APIã€æ•°æ®åº“ã€ç¼“å­˜æ¨¡å¼</td></tr><tr><td><code>frontend-patterns/</code></td><td>Reactã€Next.jsã€Vue ç­‰å‰ç«¯æ¨¡å¼</td></tr><tr><td><code>continuous-learning/</code></td><td>ä»ä¼šè¯ä¸­è‡ªåŠ¨æå–æ¨¡å¼</td></tr><tr><td><code>continuous-learning-v2/</code></td><td>åŸºäºç›´è§‰çš„å­¦ä¹ ç³»ç»Ÿ</td></tr><tr><td><code>iterative-retrieval/</code></td><td>å­ä»£ç†çš„æ¸è¿›å¼ä¸Šä¸‹æ–‡ç»†åŒ–</td></tr><tr><td><code>tdd-workflow/</code></td><td>TDD æ–¹æ³•è®º</td></tr><tr><td><code>security-review/</code></td><td>å®‰å…¨æ£€æŸ¥æ¸…å•</td></tr></tbody></table>
<blockquote>
<p>é¡¹ç›®è¿˜æä¾›äº†é’ˆå¯¹ç‰¹å®šè¯­è¨€çš„æŠ€èƒ½ï¼ˆå¦‚ Goã€Pythonã€TypeScript ç­‰ï¼‰ï¼Œä½ å¯ä»¥æ ¹æ®é¡¹ç›®éœ€è¦é€‰æ‹©æ€§ä½¿ç”¨ã€‚</p>
</blockquote>
<p><strong>TDD å·¥ä½œæµç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># TDD Workflow</span>
<span class="hljs-bullet">1.</span> Define interfaces first
<span class="hljs-bullet">2.</span> Write failing tests (RED)
<span class="hljs-bullet">3.</span> Implement minimal code (GREEN)
<span class="hljs-bullet">4.</span> Refactor (IMPROVE)
<span class="hljs-bullet">5.</span> Verify 80%+ coverage
</code></pre>
<h4 data-id="heading-8">2.3 Commandsï¼ˆæ–œæ å‘½ä»¤ï¼‰</h4>
<p>å¿«é€Ÿæ‰§è¡Œçš„å‘½ä»¤ï¼Œæé«˜å¼€å‘æ•ˆç‡ï¼š</p>
<p><strong>é€šç”¨å‘½ä»¤</strong>ï¼š</p>

























































<table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>/tdd</code></td><td>æµ‹è¯•é©±åŠ¨å¼€å‘</td></tr><tr><td><code>/plan</code></td><td>å®ç°è§„åˆ’</td></tr><tr><td><code>/e2e</code></td><td>E2E æµ‹è¯•ç”Ÿæˆ</td></tr><tr><td><code>/code-review</code></td><td>ä»£ç è´¨é‡å®¡æŸ¥</td></tr><tr><td><code>/build-fix</code></td><td>ä¿®å¤æ„å»ºé”™è¯¯</td></tr><tr><td><code>/refactor-clean</code></td><td>æ­»ä»£ç ç§»é™¤</td></tr><tr><td><code>/learn</code></td><td>æå–ä¼šè¯ä¸­çš„æ¨¡å¼</td></tr><tr><td><code>/checkpoint</code></td><td>ä¿å­˜éªŒè¯çŠ¶æ€</td></tr><tr><td><code>/verify</code></td><td>è¿è¡ŒéªŒè¯å¾ªç¯</td></tr><tr><td><code>/skill-create</code></td><td>ä» git å†å²ç”ŸæˆæŠ€èƒ½</td></tr><tr><td><code>/instinct-status</code></td><td>æŸ¥çœ‹å­¦ä¹ åˆ°çš„ç›´è§‰</td></tr><tr><td><code>/evolve</code></td><td>å°†ç›´è§‰èšç±»ä¸ºæŠ€èƒ½</td></tr></tbody></table>
<blockquote>
<p>é¡¹ç›®è¿˜æä¾›äº†é’ˆå¯¹ç‰¹å®šè¯­è¨€çš„å‘½ä»¤ï¼ˆå¦‚ <code>/go-review</code>ã€<code>/go-test</code> ç­‰ï¼‰ï¼Œæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ã€‚</p>
</blockquote>
<h4 data-id="heading-9">2.4 Rulesï¼ˆè§„åˆ™ï¼‰</h4>
<p>å§‹ç»ˆéµå¾ªçš„å¼€å‘å‡†åˆ™ï¼Œä¿æŒä»£ç ä¸€è‡´æ€§ï¼š</p>

































<table><thead><tr><th>è§„åˆ™æ–‡ä»¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>security.md</code></td><td>å¼ºåˆ¶å®‰å…¨æ£€æŸ¥ï¼ˆç¦æ­¢ç¡¬ç¼–ç å¯†é’¥ï¼‰</td></tr><tr><td><code>coding-style.md</code></td><td>ä¸å¯å˜æ€§ã€æ–‡ä»¶ç»„ç»‡</td></tr><tr><td><code>testing.md</code></td><td>TDDã€80%è¦†ç›–ç‡è¦æ±‚</td></tr><tr><td><code>git-workflow.md</code></td><td>æäº¤æ ¼å¼ã€PR æµç¨‹</td></tr><tr><td><code>agents.md</code></td><td>ä½•æ—¶å§”æ´¾ç»™å­ä»£ç†</td></tr><tr><td><code>performance.md</code></td><td>æ¨¡å‹é€‰æ‹©ã€ä¸Šä¸‹æ–‡ç®¡ç†</td></tr></tbody></table>
<h4 data-id="heading-10">2.5 Hooksï¼ˆé’©å­ï¼‰</h4>
<p>åŸºäºäº‹ä»¶è§¦å‘çš„è‡ªåŠ¨åŒ–ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"matcher"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tool == \"Edit\" &amp;&amp; tool_input.file_path matches \"\\\\.(ts|tsx|js|jsx)$\""</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"hooks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"command"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#!/bin/bash\ngrep -n 'console\\.log' \"$file_path\" &amp;&amp; echo '[Hook] Remove console.log' &gt;&amp;2"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>é’©å­ç±»å‹åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>PreToolUse</code>ï¼šå·¥å…·ä½¿ç”¨å‰</li>
<li><code>PostToolUse</code>ï¼šå·¥å…·ä½¿ç”¨å</li>
<li><code>Stop</code>ï¼šä¼šè¯ç»“æŸæ—¶</li>
<li>ä¼šè¯ç”Ÿå‘½å‘¨æœŸé’©å­</li>
</ul>
<h4 data-id="heading-11">2.6 ç”Ÿæ€ç³»ç»Ÿå·¥å…·</h4>
<h5 data-id="heading-12">Skill Creatorï¼ˆæŠ€èƒ½åˆ›å»ºå™¨ï¼‰</h5>
<p>ä¸¤ç§æ–¹å¼ä»ä»“åº“ç”ŸæˆæŠ€èƒ½ï¼š</p>
<p><strong>æ–¹å¼ Aï¼šæœ¬åœ°åˆ†æï¼ˆå†…ç½®ï¼‰</strong></p>
<pre><code class="hljs language-bash" lang="bash">/skill-create              <span class="hljs-comment"># åˆ†æå½“å‰ä»“åº“</span>
/skill-create --instincts  <span class="hljs-comment"># åŒæ—¶ç”Ÿæˆç›´è§‰</span>
</code></pre>
<p><strong>æ–¹å¼ Bï¼šGitHub Appï¼ˆé«˜çº§ï¼‰</strong></p>
<p>é€‚ç”¨äº 10k+ æäº¤ã€è‡ªåŠ¨ PRã€å›¢é˜Ÿå…±äº«ç­‰é«˜çº§åŠŸèƒ½ã€‚</p>
<h5 data-id="heading-13">Continuous Learning v2ï¼ˆæŒç»­å­¦ä¹  v2ï¼‰</h5>
<p>åŸºäºç›´è§‰çš„å­¦ä¹ ç³»ç»Ÿï¼Œè‡ªåŠ¨å­¦ä¹ ä½ çš„ç¼–ç¨‹æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/instinct-status           <span class="hljs-comment"># æ˜¾ç¤ºå­¦ä¹ åˆ°çš„ç›´è§‰åŠç½®ä¿¡åº¦</span>
/instinct-import &lt;file&gt;    <span class="hljs-comment"># ä»ä»–äººå¯¼å…¥ç›´è§‰</span>
/instinct-export           <span class="hljs-comment"># å¯¼å‡ºç›´è§‰ç”¨äºåˆ†äº«</span>
/evolve                    <span class="hljs-comment"># å°†ç›¸å…³ç›´è§‰èšç±»ä¸ºæŠ€èƒ½</span>
</code></pre>
<hr/>
<h3 data-id="heading-14">ä¸‰ã€å®‰è£…æŒ‡å—</h3>
<h4 data-id="heading-15">3.1 æ–¹å¼ä¸€ï¼šä½œä¸ºæ’ä»¶å®‰è£…ï¼ˆæ¨èï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ·»åŠ å¸‚åœºæº</span>
/plugin marketplace add affaan-m/everything-claude-code

<span class="hljs-comment"># 2. å®‰è£…æ’ä»¶</span>
/plugin install everything-claude-code@everything-claude-code
</code></pre>
<p>æˆ–è€…ç›´æ¥ç¼–è¾‘é…ç½®æ–‡ä»¶ <code>~/.claude/settings.json</code>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"extraKnownMarketplaces"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"everything-claude-code"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"source"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"source"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"github"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"repo"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"affaan-m/everything-claude-code"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"enabledPlugins"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"everything-claude-code@everything-claude-code"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼šClaude Code æ’ä»¶ç³»ç»Ÿä¸æ”¯æŒé€šè¿‡æ’ä»¶åˆ†å‘ rulesï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…‹éš†ä»“åº“</span>
git <span class="hljs-built_in">clone</span> https://github.com/affaan-m/everything-claude-code.git

<span class="hljs-comment"># æ–¹å¼ Aï¼šç”¨æˆ·çº§è§„åˆ™ï¼ˆåº”ç”¨äºæ‰€æœ‰é¡¹ç›®ï¼‰</span>
<span class="hljs-built_in">cp</span> -r everything-claude-code/rules/* ~/.claude/rules/

<span class="hljs-comment"># æ–¹å¼ Bï¼šé¡¹ç›®çº§è§„åˆ™ï¼ˆä»…åº”ç”¨äºå½“å‰é¡¹ç›®ï¼‰</span>
<span class="hljs-built_in">mkdir</span> -p .claude/rules
<span class="hljs-built_in">cp</span> -r everything-claude-code/rules/* .claude/rules/
</code></pre>
<h4 data-id="heading-16">3.2 æ–¹å¼äºŒï¼šæ‰‹åŠ¨å®‰è£…</h4>
<p>å¦‚æœä½ æƒ³è¦æ›´ç²¾ç»†çš„æ§åˆ¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…‹éš†ä»“åº“</span>
git <span class="hljs-built_in">clone</span> https://github.com/affaan-m/everything-claude-code.git

<span class="hljs-comment"># å¤åˆ¶ agents</span>
<span class="hljs-built_in">cp</span> everything-claude-code/agents/*.md ~/.claude/agents/

<span class="hljs-comment"># å¤åˆ¶ rules</span>
<span class="hljs-built_in">cp</span> everything-claude-code/rules/*.md ~/.claude/rules/

<span class="hljs-comment"># å¤åˆ¶ commands</span>
<span class="hljs-built_in">cp</span> everything-claude-code/commands/*.md ~/.claude/commands/

<span class="hljs-comment"># å¤åˆ¶ skills</span>
<span class="hljs-built_in">cp</span> -r everything-claude-code/skills/* ~/.claude/skills/
</code></pre>
<h5 data-id="heading-17">é…ç½® Hooks</h5>
<p>å°† <code>hooks/hooks.json</code> ä¸­çš„é’©å­é…ç½®å¤åˆ¶åˆ° <code>~/.claude/settings.json</code>ã€‚</p>
<h5 data-id="heading-18">é…ç½® MCPs</h5>
<p>å°† <code>mcp-configs/mcp-servers.json</code> ä¸­éœ€è¦çš„ MCP æœåŠ¡å™¨é…ç½®å¤åˆ¶åˆ° <code>~/.claude.json</code>ã€‚</p>
<p><strong>é‡è¦</strong>ï¼šå°† <code>YOUR_*_HERE</code> å ä½ç¬¦æ›¿æ¢ä¸ºä½ çš„å®é™… API å¯†é’¥ã€‚</p>
<hr/>
<h3 data-id="heading-19">å››ã€æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-20">4.1 ä¸Šä¸‹æ–‡çª—å£ç®¡ç†</h4>
<blockquote>
<p><strong>å…³é”®æé†’</strong>ï¼šä¸è¦åŒæ—¶å¯ç”¨æ‰€æœ‰ MCPï¼</p>
</blockquote>
<p>ä½ çš„ 200k ä¸Šä¸‹æ–‡çª—å£å¯èƒ½å› ä¸ºå¯ç”¨å¤ªå¤šå·¥å…·è€Œç¼©å‡åˆ° 70kã€‚</p>
<p><strong>ç»éªŒæ³•åˆ™</strong>ï¼š</p>
<ul>
<li>é…ç½® 20-30 ä¸ª MCP</li>
<li>æ¯ä¸ªé¡¹ç›®ä¿æŒå°‘äº 10 ä¸ªå¯ç”¨</li>
<li>ä¿æŒå°‘äº 80 ä¸ªæ´»è·ƒå·¥å…·</li>
</ul>
<p>ä½¿ç”¨é¡¹ç›®é…ç½®ä¸­çš„ <code>disabledMcpServers</code> ç¦ç”¨æœªä½¿ç”¨çš„æœåŠ¡å™¨ã€‚</p>
<h4 data-id="heading-21">4.2 å®šåˆ¶åŒ–å»ºè®®</h4>
<p>è¿™äº›é…ç½®é€‚ç”¨äºä½œè€…çš„å·¥ä½œæµï¼Œä½ åº”è¯¥ï¼š</p>
<ol>
<li><strong>ä»å…±é¸£çš„éƒ¨åˆ†å¼€å§‹</strong> - é€‰æ‹©å¯¹ä½ æœ‰ç”¨çš„ç»„ä»¶</li>
<li><strong>æ ¹æ®æŠ€æœ¯æ ˆä¿®æ”¹</strong> - é€‚é…ä½ çš„é¡¹ç›®éœ€æ±‚</li>
<li><strong>ç§»é™¤ä¸ç”¨çš„éƒ¨åˆ†</strong> - ä¿æŒé…ç½®ç²¾ç®€</li>
<li><strong>æ·»åŠ è‡ªå·±çš„æ¨¡å¼</strong> - æŒç»­è¿­ä»£ä¼˜åŒ–</li>
</ol>
<h4 data-id="heading-22">4.3 è·¨å¹³å°æ”¯æŒ</h4>
<p>è¯¥æ’ä»¶å®Œå…¨æ”¯æŒ <strong>Windowsã€macOS å’Œ Linux</strong>ã€‚æ‰€æœ‰é’©å­å’Œè„šæœ¬éƒ½å·²ç”¨ Node.js é‡å†™ï¼Œä»¥è·å¾—æœ€å¤§å…¼å®¹æ€§ã€‚</p>
<hr/>
<h3 data-id="heading-23">äº”ã€é¡¹ç›®ç»“æ„æ¦‚è§ˆ</h3>
<pre><code class="hljs language-bash" lang="bash">everything-claude-code/
â”œâ”€â”€ .claude-plugin/           <span class="hljs-comment"># æ’ä»¶å’Œå¸‚åœºæ¸…å•</span>
â”‚   â”œâ”€â”€ plugin.json          <span class="hljs-comment"># æ’ä»¶å…ƒæ•°æ®å’Œç»„ä»¶è·¯å¾„</span>
â”‚   â””â”€â”€ marketplace.json     <span class="hljs-comment"># å¸‚åœºç›®å½•</span>
â”œâ”€â”€ agents/                   <span class="hljs-comment"># ä¸“ä¸šåŒ–å­ä»£ç†</span>
â”œâ”€â”€ skills/                   <span class="hljs-comment"># å·¥ä½œæµå®šä¹‰å’Œé¢†åŸŸçŸ¥è¯†</span>
â”œâ”€â”€ commands/                 <span class="hljs-comment"># æ–œæ å‘½ä»¤</span>
â”œâ”€â”€ rules/                    <span class="hljs-comment"># å§‹ç»ˆéµå¾ªçš„å‡†åˆ™</span>
â”œâ”€â”€ hooks/                    <span class="hljs-comment"># åŸºäºè§¦å‘å™¨çš„è‡ªåŠ¨åŒ–</span>
â”‚   â””â”€â”€ hooks.json
â”œâ”€â”€ scripts/                  <span class="hljs-comment"># è·¨å¹³å° Node.js è„šæœ¬</span>
â”‚   â”œâ”€â”€ lib/                 <span class="hljs-comment"># å…±äº«å·¥å…·</span>
â”‚   â”œâ”€â”€ hooks/               <span class="hljs-comment"># é’©å­å®ç°</span>
â”‚   â””â”€â”€ tests/               <span class="hljs-comment"># æµ‹è¯•å¥—ä»¶</span>
â”œâ”€â”€ contexts/                 <span class="hljs-comment"># åŠ¨æ€ç³»ç»Ÿæç¤ºæ³¨å…¥ä¸Šä¸‹æ–‡</span>
â”œâ”€â”€ examples/                 <span class="hljs-comment"># ç¤ºä¾‹é…ç½®å’Œä¼šè¯</span>
â””â”€â”€ mcp-configs/             <span class="hljs-comment"># MCP æœåŠ¡å™¨é…ç½®</span>
</code></pre>
<hr/>
<h3 data-id="heading-24">å…­ã€å¸¸ç”¨å·¥ä½œæµç¤ºä¾‹</h3>
<h4 data-id="heading-25">6.1 TDD å¼€å‘æµç¨‹</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨ TDD å·¥ä½œæµ</span>
/tdd

<span class="hljs-comment"># Claude å°†å¼•å¯¼ä½ ï¼š</span>
<span class="hljs-comment"># 1. å®šä¹‰æ¥å£</span>
<span class="hljs-comment"># 2. ç¼–å†™å¤±è´¥çš„æµ‹è¯•ï¼ˆçº¢ç¯ï¼‰</span>
<span class="hljs-comment"># 3. å®ç°æœ€å°ä»£ç ï¼ˆç»¿ç¯ï¼‰</span>
<span class="hljs-comment"># 4. é‡æ„ï¼ˆæ”¹è¿›ï¼‰</span>
<span class="hljs-comment"># 5. éªŒè¯ 80%+ è¦†ç›–ç‡</span>
</code></pre>
<h4 data-id="heading-26">6.2 ä»£ç å®¡æŸ¥</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨ä»£ç å®¡æŸ¥</span>
/code-review

<span class="hljs-comment"># Claude å°†æ£€æŸ¥ï¼š</span>
<span class="hljs-comment"># - ä»£ç è´¨é‡</span>
<span class="hljs-comment"># - å®‰å…¨æ€§é—®é¢˜</span>
<span class="hljs-comment"># - å¯ç»´æŠ¤æ€§</span>
</code></pre>
<h4 data-id="heading-27">6.3 åŠŸèƒ½è§„åˆ’</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è§„åˆ’æ–°åŠŸèƒ½</span>
/plan

<span class="hljs-comment"># Claude å°†ååŠ©ï¼š</span>
<span class="hljs-comment"># - éœ€æ±‚åˆ†æ</span>
<span class="hljs-comment"># - æ¶æ„è®¾è®¡</span>
<span class="hljs-comment"># - å®ç°æ­¥éª¤æ‹†åˆ†</span>
</code></pre>
<h4 data-id="heading-28">6.4 æ„å»ºé”™è¯¯ä¿®å¤</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¿®å¤æ„å»ºé”™è¯¯</span>
/build-fix

<span class="hljs-comment"># Claude å°†è‡ªåŠ¨ï¼š</span>
<span class="hljs-comment"># - åˆ†æé”™è¯¯æ—¥å¿—</span>
<span class="hljs-comment"># - å®šä½é—®é¢˜æ ¹æº</span>
<span class="hljs-comment"># - æä¾›ä¿®å¤æ–¹æ¡ˆ</span>
</code></pre>
<h4 data-id="heading-29">6.5 æŒç»­å­¦ä¹ ä¸æŠ€èƒ½æ¼”è¿›</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä»å½“å‰ä»“åº“ç”ŸæˆæŠ€èƒ½</span>
/skill-create

<span class="hljs-comment"># æŸ¥çœ‹å­¦ä¹ åˆ°çš„ç›´è§‰</span>
/instinct-status

<span class="hljs-comment"># å°†ç›´è§‰èšç±»ä¸ºæŠ€èƒ½</span>
/evolve
</code></pre>
<hr/>
<h3 data-id="heading-30">ä¸ƒã€æ€»ç»“</h3>
<p><strong>Everything Claude Code</strong> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„é…ç½®å·¥å…·åŒ…ï¼Œèƒ½å¤Ÿå°†åŸç”Ÿçš„ Claude Code è½¬å˜ä¸ºä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„å¼€å‘ç¯å¢ƒã€‚å®ƒçš„æ ¸å¿ƒä»·å€¼åœ¨äºï¼š</p>
<ol>
<li><strong>å®æˆ˜éªŒè¯</strong> - æ¥è‡ªé»‘å®¢æ¾å† å†›çš„ 10 ä¸ªæœˆæ—¥å¸¸ä½¿ç”¨ç»éªŒ</li>
<li><strong>æ¨¡å—åŒ–è®¾è®¡</strong> - å¯ä»¥æŒ‰éœ€é€‰æ‹©å’Œå®šåˆ¶ç»„ä»¶</li>
<li><strong>ä¸“ä¸šåŒ–åˆ†å·¥</strong> - é€šè¿‡å­ä»£ç†å®ç°ä»»åŠ¡å§”æ´¾</li>
<li><strong>è‡ªåŠ¨åŒ–å¢å¼º</strong> - é€šè¿‡é’©å­å®ç°å·¥ä½œæµè‡ªåŠ¨åŒ–</li>
<li><strong>æŒç»­å­¦ä¹ </strong> - èƒ½å¤Ÿä»ä½ çš„ç¼–ç¨‹æ¨¡å¼ä¸­å­¦ä¹ </li>
</ol>
<p>æ— è®ºä½ æ˜¯ Claude Code æ–°æ‰‹è¿˜æ˜¯èµ„æ·±ç”¨æˆ·ï¼Œè¿™ä¸ªé¡¹ç›®éƒ½èƒ½å¸®åŠ©ä½ æå‡å¼€å‘æ•ˆç‡ï¼Œå»ºç«‹æ›´ä¸€è‡´çš„ä»£ç è´¨é‡æ ‡å‡†ã€‚</p>
<hr/>
<h3 data-id="heading-31">ç›¸å…³é“¾æ¥</h3>
<ul>
<li><strong>GitHub ä»“åº“</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faffaan-m%2Feverything-claude-code" target="_blank" title="https://github.com/affaan-m/everything-claude-code" ref="nofollow noopener noreferrer">affaan-m/everything-claude-code</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Windows æ§åˆ¶å°ç‚¹å‡»å¯¼è‡´ Python è„šæœ¬å‡æ­»/æŒ‚èµ·]]></title>    <link>https://juejin.cn/post/7599917711794061322</link>    <guid>https://juejin.cn/post/7599917711794061322</guid>    <pubDate>2026-01-28T02:53:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599917711794061322" data-draft-id="7599965904617078830" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Windows æ§åˆ¶å°ç‚¹å‡»å¯¼è‡´ Python è„šæœ¬å‡æ­»/æŒ‚èµ·"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-01-28T02:53:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å…ƒYäº¨H"/> <meta itemprop="url" content="https://juejin.cn/user/2839351584888617"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Windows æ§åˆ¶å°ç‚¹å‡»å¯¼è‡´ Python è„šæœ¬å‡æ­»/æŒ‚èµ·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2839351584888617/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å…ƒYäº¨H
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:53:44.000Z" title="Wed Jan 28 2026 02:53:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><hr/>
<h3 data-id="heading-0">ã€æŠ€æœ¯æ’æŸ¥ã€‘Windows æ§åˆ¶å°ç‚¹å‡»å¯¼è‡´ Python è„šæœ¬å‡æ­»/æŒ‚èµ·</h3>
<h4 data-id="heading-1">1. æ•…éšœç°è±¡</h4>
<p>åœ¨ Windows ç³»ç»Ÿä¸­è¿è¡Œ Python è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆå¦‚ Playwrightã€PyAutoGUIï¼‰æ—¶ï¼Œå‡ºç°ä»¥ä¸‹å¼‚å¸¸æƒ…å†µï¼š
*   <strong>è§¦å‘åŠ¨ä½œ</strong>ï¼šé¼ æ ‡åœ¨å‘½ä»¤è¡Œçª—å£ï¼ˆCMD/PowerShellï¼‰å†…éƒ¨ç‚¹å‡»äº†å·¦é”®æˆ–å³é”®ã€‚
*   <strong>è¡¨ç°çŠ¶æ€</strong>ï¼šç¨‹åºç«‹å³åœæ­¢è¿è¡Œï¼Œæ—¥å¿—ä¸å†åˆ·æ–°ï¼Œä»¿ä½›â€œå¡æ­»â€ã€‚
*   <strong>è§†è§‰ç‰¹å¾</strong>ï¼šçª—å£æ ‡é¢˜æ çš„å‰ç¼€å˜æˆäº† <strong>â€œé€‰æ‹©â€</strong> æˆ– <strong>â€œSelectâ€</strong>ã€‚</p>
<h4 data-id="heading-2">2. åŸç†æ­ç§˜</h4>
<p>è¿™å¹¶é Python ä»£ç æˆ–ç¬¬ä¸‰æ–¹åº“çš„ Bugï¼Œè€Œæ˜¯ Windows æ§åˆ¶å°çš„ä¸€é¡¹ç³»ç»Ÿç‰¹æ€§â€”â€”<strong>â€œå¿«é€Ÿç¼–è¾‘æ¨¡å¼â€ï¼ˆQuickEdit Modeï¼‰</strong>ã€‚
*   <strong>æœºåˆ¶</strong>ï¼šå½“ç”¨æˆ·åœ¨çª—å£å†…ç‚¹å‡»é¼ æ ‡æ—¶ï¼Œç³»ç»Ÿè®¤ä¸ºç”¨æˆ·å‡†å¤‡å¤åˆ¶å±å¹•ä¸Šçš„æ–‡å­—ã€‚
*   <strong>åæœ</strong>ï¼šä¸ºäº†ä¿æŠ¤é€‰ä¸­çš„æ–‡æœ¬ä¸è¢«æ–°è¾“å‡ºçš„æ—¥å¿—æ‰“æ–­ï¼ŒWindows ä¼š<strong>æŒ‚èµ·ï¼ˆSuspendï¼‰</strong> å½“å‰è¿›ç¨‹çš„ I/O è¾“å‡ºï¼Œå¯¼è‡´ç¨‹åºæš‚åœæ‰§è¡Œï¼Œç›´åˆ°ç”¨æˆ·å®Œæˆæ“ä½œã€‚</p>
<h4 data-id="heading-3">3. ä¿®å¤æŒ‡å—</h4>
<p><strong>A. ç°åœºæ€¥æ•‘ï¼ˆä¸´æ—¶æ¢å¤ï¼‰</strong>
å¦‚æœç¨‹åºå·²ç»å¡ä½ï¼Œæ— éœ€é‡å¯ï¼š
*   <strong>æ“ä½œ</strong>ï¼šåœ¨æ§åˆ¶å°çª—å£å†…æŒ‰ä¸€ä¸‹ <strong><code>Enter</code>ï¼ˆå›è½¦é”®ï¼‰</strong> æˆ– <strong><code>Esc</code></strong>ã€‚
*   <strong>æ•ˆæœ</strong>ï¼šç³»ç»Ÿåˆ¤å®šå¤åˆ¶å®Œæˆæˆ–å–æ¶ˆï¼Œè¿›ç¨‹ä¼šç«‹å³â€œè§£å†»â€ï¼Œç»§ç»­æ‰§è¡Œåç»­ä»£ç ã€‚</p>
<p><strong>B. æ°¸ä¹…å…³é—­ï¼ˆæ¨èè®¾ç½®ï¼‰</strong>
ä¸ºäº†é˜²æ­¢æ— äººå€¼å®ˆè¿è¡Œæ—¶å› è¯¯è§¦å¯¼è‡´è„šæœ¬ä¸­æ–­ï¼Œå»ºè®®å…³é—­æ­¤åŠŸèƒ½ï¼š
1.  å³é”®ç‚¹å‡»æ§åˆ¶å°çª—å£é¡¶éƒ¨çš„<strong>æ ‡é¢˜æ </strong>ã€‚
2.  é€‰æ‹© <strong>ã€å±æ€§ã€‘ (Properties)</strong>ã€‚
3.  åˆ‡æ¢åˆ° <strong>ã€é€‰é¡¹ã€‘ (Options)</strong> æ ‡ç­¾é¡µã€‚
4.  åœ¨â€œç¼–è¾‘é€‰é¡¹â€æ ç›®ä¸­ï¼Œ<strong>å–æ¶ˆå‹¾é€‰ã€å¿«é€Ÿç¼–è¾‘æ¨¡å¼ã€‘ (QuickEdit Mode)</strong>ã€‚
5.  ç‚¹å‡»ç¡®å®šä¿å­˜ã€‚</p>
<h4 data-id="heading-4">4. è¡¥å……æ’æŸ¥ï¼ˆPyAutoGUI ç‰¹æœ‰ï¼‰</h4>
<p>å¦‚æœä¸Šè¿°æ–¹æ³•æ— æ•ˆï¼Œä¸”ç¨‹åºç›´æ¥<strong>æŠ¥é”™é€€å‡º</strong>ï¼ˆè€Œéé™æ­¢å¡ä½ï¼‰ï¼Œè¯·æ£€æŸ¥ PyAutoGUI çš„å®‰å…¨æœºåˆ¶ï¼š
*   <strong>Fail-Safe è§¦å‘</strong>ï¼šå½“é¼ æ ‡è¿…é€Ÿç§»åŠ¨åˆ°å±å¹•è§’è½ï¼ˆé€šå¸¸æ˜¯å·¦ä¸Šè§’ï¼‰æ—¶ï¼ŒPyAutoGUI ä¼šå¼ºåˆ¶æŠ›å‡º <code>pyautogui.FailSafeException</code> ä»¥é˜²æ­¢å¤±æ§ã€‚
*   <strong>åŒºåˆ†æ–¹æ³•</strong>ï¼š
*   <strong>å¡ä½ä¸åŠ¨</strong> = Windows å¿«é€Ÿç¼–è¾‘æ¨¡å¼ï¼ˆæœ¬æ–‡é—®é¢˜ï¼‰ã€‚
*   <strong>æŠ¥é”™ Traceback</strong> = PyAutoGUI å®‰å…¨æœºåˆ¶è§¦å‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ™ºèƒ½ä½“åº”ç”¨1: ç‚¹å¤–å–]]></title>    <link>https://juejin.cn/post/7599963665039409202</link>    <guid>https://juejin.cn/post/7599963665039409202</guid>    <pubDate>2026-01-28T02:48:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599963665039409202" data-draft-id="7599951933593813002" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ™ºèƒ½ä½“åº”ç”¨1: ç‚¹å¤–å–"/> <meta itemprop="keywords" content="Agent,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-28T02:48:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="guo54junxiao"/> <meta itemprop="url" content="https://juejin.cn/user/4353721777787773"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ™ºèƒ½ä½“åº”ç”¨1: ç‚¹å¤–å–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4353721777787773/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    guo54junxiao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:48:38.000Z" title="Wed Jan 28 2026 02:48:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ç³»ç»Ÿæ¶æ„æ€»è§ˆ</h2>
<pre><code class="hljs language-js" lang="js">ç”¨æˆ· (å‰ç«¯/<span class="hljs-title class_">App</span>) 
    â†“ (è‡ªç„¶è¯­è¨€æŒ‡ä»¤)
[å‰ç«¯ï¼šæ™ºèƒ½ä½“äº¤äº’å±‚]
    â†“ (åŒ…å«ä¼šè¯<span class="hljs-variable constant_">ID</span>çš„è¯·æ±‚)
[ä¸­å°ï¼šæ™ºèƒ½ä½“ç¼–æ’ä¸æ‰§è¡Œå¼•æ“] 
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â†“           â†“           â†“           â†“
[å·¥å…·<span class="hljs-number">1</span>ï¼š        [å·¥å…·<span class="hljs-number">2</span>ï¼š        [å·¥å…·<span class="hljs-number">3</span>ï¼š        [è®°å¿†æœåŠ¡ï¼š
 é¤é¦†/èœå•æŸ¥è¯¢]  è´­ç‰©è½¦æ“ä½œ]    åœ°å€ç®¡ç†]     ä¼šè¯çŠ¶æ€å­˜å‚¨]
    â†“           â†“           â†“           â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
[ä¸­å°ï¼šæ™ºèƒ½ä½“å†³ç­–ä¸è§„åˆ’]
    â†“ (ç»“æ„åŒ–ä¸‹ä¸€æ­¥æŒ‡ä»¤æˆ–æœ€ç»ˆç»“æœ)
[å¤–éƒ¨æœåŠ¡<span class="hljs-variable constant_">API</span>ç½‘å…³] â†’ ç¾å›¢/é¥¿äº†ä¹ˆç­‰å¤–å–å¹³å°å¼€æ”¾<span class="hljs-variable constant_">API</span>
    â†“
[å‰ç«¯ï¼šæ¸²æŸ“ä¸ç”¨æˆ·ç¡®è®¤ç•Œé¢]
</code></pre>
<h2 data-id="heading-1">äºŒã€å·¥ä½œæµç¨‹ï¼š</h2>
<h4 data-id="heading-2">å®Œæ•´å·¥ä½œæµç¨‹ç¤ºä¾‹</h4>
<ol>
<li>
<p><strong>ç”¨æˆ·è¾“å…¥</strong>ï¼šâ€œå¸®æˆ‘ç‚¹ä¸€ä»½éº¦å½“åŠ³å·¨æ— éœ¸å¥—é¤ï¼Œé€åˆ°XXå¤§å¦ï¼Œå¸®æˆ‘åˆ°ä»˜æ¬¾ç•Œé¢â€</p>
</li>
<li>
<p><strong>å‰ç«¯</strong>ï¼šå‘é€è¯·æ±‚åˆ°ä¸­å°<code>/api/agent/order-food</code>ï¼Œé™„å¸¦ä¼šè¯IDã€‚</p>
</li>
<li>
<p><strong>ä¸­å° - ç¬¬ä¸€è½®</strong>ï¼š</p>
<ul>
<li>LLMåˆ†ææ„å›¾ï¼šéœ€è¦<code>query_restaurant_menu</code>å·¥å…·ã€‚</li>
<li><strong>å‘é€äº‹ä»¶</strong>ï¼š<code>status: querying_menu</code>Â åˆ°å‰ç«¯ã€‚</li>
<li><strong>æ‰§è¡Œå·¥å…·</strong>ï¼šè°ƒç”¨èœå•æŸ¥è¯¢å·¥å…·ï¼Œæ‰¾åˆ°é™„è¿‘çš„éº¦å½“åŠ³å’Œå·¨æ— éœ¸å¥—é¤ã€‚</li>
<li><strong>å‘é€äº‹ä»¶</strong>ï¼š<code>message: â€œæ‰¾åˆ°â€˜éº¦å½“åŠ³ï¼ˆXXåº—ï¼‰â€™ï¼Œæœ‰å·¨æ— éœ¸å¥—é¤ï¼Œä»·æ ¼38å…ƒã€‚ç¡®è®¤åŠ å…¥è´­ç‰©è½¦å—ï¼Ÿâ€</code>Â åŒæ—¶å‘é€<code>action_preview: {action: â€œadd_to_cartâ€, items: [...]}</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‰ç«¯</strong>ï¼šæ˜¾ç¤ºæ¶ˆæ¯å’Œç¡®è®¤å¡ç‰‡ã€‚ç”¨æˆ·ç‚¹å‡»â€œç¡®è®¤â€ã€‚</p>
</li>
<li>
<p><strong>ä¸­å° - ç¬¬äºŒè½®</strong>ï¼š</p>
<ul>
<li>å‰ç«¯å‘é€ç¡®è®¤æŒ‡ä»¤ã€‚</li>
<li>LLMåˆ†æï¼šç”¨æˆ·å·²ç¡®è®¤ï¼Œéœ€è¦<code>manage_cart</code>å·¥å…·ã€‚</li>
<li><strong>æ‰§è¡Œå·¥å…·</strong>ï¼šå°†å•†å“åŠ å…¥è´­ç‰©è½¦ï¼Œè¿”å›æˆåŠŸã€‚</li>
<li>LLMå‘ç°åœ°å€ä¿¡æ¯â€œXXå¤§å¦â€ä¸æ˜ç¡®ï¼Œéœ€è¦<code>address</code>å·¥å…·è§£ææˆ–ç”¨æˆ·ç¡®è®¤ã€‚</li>
<li><strong>å‘é€äº‹ä»¶</strong>ï¼š<code>message: â€œéœ€è¦ç¡®è®¤å…·ä½“åœ°å€ã€‚XXå¤§å¦æœ‰ä»¥ä¸‹åœ°å€é€‰é¡¹...â€</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç”¨æˆ·</strong>ï¼šåœ¨å‰ç«¯é€‰æ‹©æˆ–ç¡®è®¤å…·ä½“åœ°å€ã€‚</p>
</li>
<li>
<p><strong>ä¸­å° - ç¬¬ä¸‰è½®</strong>ï¼š</p>
<ul>
<li>LLMåˆ†æï¼šæ‰€æœ‰ä¿¡æ¯ï¼ˆé¤å…ã€å•†å“ã€åœ°å€ï¼‰é½å¤‡ï¼Œç”¨æˆ·æœ€ç»ˆç›®æ ‡æ˜¯â€œåˆ°ä»˜æ¬¾ç•Œé¢â€ã€‚</li>
<li>è°ƒç”¨<code>get_payment_page</code>å·¥å…·ã€‚</li>
<li><strong>å‘é€äº‹ä»¶</strong>ï¼š<code>action_preview: {action: â€œget_payment_pageâ€, need_confirm: true}</code>ï¼ˆé«˜é£é™©æ“ä½œï¼Œå¿…é¡»ç¡®è®¤ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‰ç«¯</strong>ï¼šå¼¹å‡ºç¡®è®¤æ¡†â€œå³å°†è·³è½¬æ”¯ä»˜ï¼Œæ€»ä»·38å…ƒï¼Œè¯·ç¡®è®¤â€ã€‚</p>
</li>
<li>
<p><strong>ç”¨æˆ·</strong>ï¼šç‚¹å‡»â€œç¡®è®¤æ”¯ä»˜â€ã€‚</p>
</li>
<li>
<p><strong>ä¸­å° - æœ€ç»ˆè½®</strong>ï¼š</p>
<ul>
<li>è°ƒç”¨æ”¯ä»˜å·¥å…·ï¼Œä»å¤–å–å¹³å°è·å–<strong>é¢„å¡«å……å¥½å•†å“ã€åœ°å€ã€ä»·æ ¼çš„æ”¯ä»˜é¡µé¢URLï¼ˆå¸¦ä¸´æ—¶tokenï¼‰</strong> ã€‚</li>
<li><strong>å‘é€äº‹ä»¶</strong>ï¼š<code>final_result: {type: â€œpayment_pageâ€, url: â€œhttps://pay.ele.me/...â€}</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‰ç«¯</strong>ï¼šåœ¨åº”ç”¨å†…åµŒçš„WebViewä¸­åŠ è½½è¯¥URLï¼Œç”¨æˆ·çœ‹åˆ°çš„æ˜¯å¤–å–å¹³å°æ ‡å‡†çš„æ”¯ä»˜é¡µé¢ï¼Œåªéœ€è¾“å…¥å¯†ç æˆ–éªŒè¯æŒ‡çº¹å³å¯å®Œæˆæ”¯ä»˜ã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-3">ä¸‰ã€å‰ç«¯å®ç°è¯¦è§£</h2>
<h5 data-id="heading-4"><strong>1. ç•Œé¢è®¾è®¡ï¼ˆå…³é”®ç»„ä»¶ï¼‰</strong></h5>
<ul>
<li>
<p><strong>æ™ºèƒ½ä½“å¯¹è¯é¢æ¿</strong>ï¼šæ ¸å¿ƒåŒºåŸŸï¼Œæ˜¾ç¤ºä¸AIçš„å¯¹è¯å†å²ã€‚</p>
</li>
<li>
<p><strong>æ™ºèƒ½ä½“çŠ¶æ€å¯è§†åŒ–é¢æ¿</strong>ï¼š</p>
<ul>
<li>
<p><strong>æ€è€ƒçŠ¶æ€</strong>ï¼šæ˜¾ç¤ºâ€œæ­£åœ¨åˆ†æä½ çš„éœ€æ±‚...â€ã€â€œæ­£åœ¨æŸ¥è¯¢éº¦å½“åŠ³èœå•...â€</p>
</li>
<li>
<p><strong>æ“ä½œé¢„è§ˆ</strong>ï¼šä»¥å¡ç‰‡å½¢å¼å±•ç¤ºæ™ºèƒ½ä½“å³å°†æˆ–æ­£åœ¨æ‰§è¡Œçš„æ“ä½œï¼Œä¾‹å¦‚ï¼š</p>
<p>json</p>
<pre><code class="hljs language-css" lang="css">{
  â€œactionâ€: â€œadd_to_cartâ€,
  â€œrestaurantâ€: â€œéº¦å½“åŠ³ï¼ˆXXåº—ï¼‰â€,
  â€œitemsâ€: [{â€œnameâ€: â€œå·¨æ— éœ¸å¥—é¤â€, â€œquantityâ€: <span class="hljs-number">1</span>}],
  â€œneed_confirmâ€: true // éœ€è¦ç”¨æˆ·ç¡®è®¤
}
</code></pre>
</li>
<li>
<p><strong>å·¥å…·è°ƒç”¨è®°å½•</strong>ï¼šä¸€ä¸ªå°æ—¥å¿—ï¼Œæ˜¾ç¤ºâ€œè°ƒç”¨äº†ã€èœå•æŸ¥è¯¢å·¥å…·ã€‘â€ã€â€œè°ƒç”¨äº†ã€åœ°å€æ ¡éªŒå·¥å…·ã€‘â€ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>æ··åˆè¾“å…¥åŒº</strong>ï¼šç”¨æˆ·æ—¢å¯ä»¥ç»§ç»­ç”¨è‡ªç„¶è¯­è¨€å¯¹è¯ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç‚¹å‡»æ™ºèƒ½ä½“æ¨èçš„é€‰é¡¹è¿›è¡Œç¡®è®¤æˆ–ä¿®æ”¹ï¼ˆä¾‹å¦‚ï¼Œç‚¹å‡»â€œæ›´æ¢å¥—é¤â€æˆ–â€œç¡®è®¤åŠ å…¥è´­ç‰©è½¦â€ï¼‰ã€‚</p>
</li>
<li>
<p><strong>æœ€ç»ˆç»“æœåµŒå…¥åŒº</strong>ï¼šå½“æ™ºèƒ½ä½“å®Œæˆâ€œåˆ°ä»˜æ¬¾ç•Œé¢â€çš„ä»»åŠ¡åï¼Œè¿™ä¸ªåŒºåŸŸå°†ç›´æ¥åµŒå…¥ä»å¤–å–å¹³å°è·å–çš„ã€å·²å¡«å¥½æ‰€æœ‰ä¿¡æ¯çš„<strong>æ”¯ä»˜é¡µé¢H5æˆ–WebView</strong>ã€‚</p>
</li>
</ul>
<ol start="2">
<li>
<p><strong>ä¸»è¦åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>è‡ªåŠ¨åˆ›å»ºå’Œç®¡ç†ä¼šè¯</li>
<li>å®æ—¶SSEé€šä¿¡æ˜¾ç¤ºæ™ºèƒ½ä½“çŠ¶æ€</li>
<li>æ“ä½œé¢„è§ˆå’Œç¡®è®¤æœºåˆ¶</li>
<li>æ”¯ä»˜é¡µé¢åµŒå…¥</li>
<li>å®Œæ•´çš„å“åº”å¼UI</li>
</ul>
</li>
</ol>
<h5 data-id="heading-5"><strong>2. å‰ç«¯æ ¸å¿ƒé€»è¾‘ï¼ˆä»£ç æ€è·¯ï¼‰</strong></h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// 1. åˆå§‹åŒ–æ™ºèƒ½ä½“ä¼šè¯</span>
<span class="hljs-keyword">const</span> agentSession = <span class="hljs-title function_">useAgentSession</span>(<span class="hljs-string">'å¤–å–åŠ©æ‰‹'</span>);
<span class="hljs-comment">// 2. å‘é€ç”¨æˆ·æ¶ˆæ¯</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleUserMessage</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">userInput</span>) =&gt; {
  <span class="hljs-comment">// 2.1 å°†ç”¨æˆ·è¾“å…¥æ·»åŠ åˆ°å¯¹è¯å†å²ï¼Œå¹¶æ˜¾ç¤ºâ€œæ€è€ƒä¸­â€çŠ¶æ€</span>
  agentSession.<span class="hljs-title function_">addMessage</span>({ <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>, <span class="hljs-attr">content</span>: userInput });
  agentSession.<span class="hljs-title function_">setStatus</span>(<span class="hljs-string">'thinking'</span>);
  
  <span class="hljs-comment">// 2.2 è°ƒç”¨ä¸­å°æ™ºèƒ½ä½“APIï¼ˆæµå¼å“åº”ï¼‰</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/agent/order-food'</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">session_id</span>: agentSession.<span class="hljs-property">id</span>,
      <span class="hljs-attr">message</span>: userInput,
      <span class="hljs-comment">// å¯ä»¥é™„åŠ ä¸Šä¸‹æ–‡ï¼Œå¦‚å‰ç«¯å½“å‰çš„åœ°ç†ä½ç½®</span>
      <span class="hljs-attr">context</span>: { <span class="hljs-attr">user_location</span>: userLocation }
    }),
    <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> }
  });
  
  <span class="hljs-comment">// 2.3 å¤„ç†æµå¼å“åº”ï¼ˆä¸­å°è¿”å›çš„æ˜¯Server-Sent Eventsï¼‰</span>
  <span class="hljs-keyword">const</span> reader = response.<span class="hljs-property">body</span>.<span class="hljs-title function_">getReader</span>();
  <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>();
  <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
    <span class="hljs-keyword">const</span> { done, value } = <span class="hljs-keyword">await</span> reader.<span class="hljs-title function_">read</span>();
    <span class="hljs-keyword">if</span> (done) <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">const</span> chunk = decoder.<span class="hljs-title function_">decode</span>(value);
    <span class="hljs-keyword">const</span> events = chunk.<span class="hljs-title function_">split</span>(<span class="hljs-string">'\n\n'</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e);
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> event <span class="hljs-keyword">of</span> events) {
      <span class="hljs-keyword">const</span> [eventLine, dataLine] = event.<span class="hljs-title function_">split</span>(<span class="hljs-string">'\n'</span>);
      <span class="hljs-keyword">if</span> (eventLine === <span class="hljs-string">'event: status'</span>) {
        <span class="hljs-comment">// æ›´æ–°æ™ºèƒ½ä½“çŠ¶æ€</span>
        agentSession.<span class="hljs-title function_">setStatus</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(dataLine.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'data: '</span>, <span class="hljs-string">''</span>)).<span class="hljs-property">status</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (eventLine === <span class="hljs-string">'event: action_preview'</span>) {
        <span class="hljs-comment">// æ˜¾ç¤ºæ™ºèƒ½ä½“å°†è¦æ‰§è¡Œçš„æ“ä½œï¼ˆéœ€è¦ç”¨æˆ·ç¡®è®¤çš„å¡ç‰‡ï¼‰</span>
        <span class="hljs-keyword">const</span> action = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(dataLine.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'data: '</span>, <span class="hljs-string">''</span>));
        <span class="hljs-title function_">renderActionPreviewCard</span>(action);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (eventLine === <span class="hljs-string">'event: message'</span>) {
        <span class="hljs-comment">// é€æ­¥æ˜¾ç¤ºæ™ºèƒ½ä½“çš„å›å¤æ–‡æœ¬</span>
        agentSession.<span class="hljs-title function_">appendAgentMessage</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(dataLine.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'data: '</span>, <span class="hljs-string">''</span>)).<span class="hljs-property">content</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (eventLine === <span class="hljs-string">'event: final_result'</span>) {
        <span class="hljs-comment">// æ”¶åˆ°æœ€ç»ˆç»“æœï¼Œä¾‹å¦‚æ”¯ä»˜é¡µé¢çš„URLæˆ–åµŒå…¥ä»£ç </span>
        <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(dataLine.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'data: '</span>, <span class="hljs-string">''</span>));
        <span class="hljs-keyword">if</span> (result.<span class="hljs-property">type</span> === <span class="hljs-string">'payment_page'</span>) {
          <span class="hljs-title function_">embedPaymentPage</span>(result.<span class="hljs-property">url</span>, result.<span class="hljs-property">token</span>); <span class="hljs-comment">// åµŒå…¥æ”¯ä»˜é¡µé¢</span>
        }
      }
    }
  }
  agentSession.<span class="hljs-title function_">setStatus</span>(<span class="hljs-string">'idle'</span>);
};

<span class="hljs-comment">// 3. ç”¨æˆ·ç¡®è®¤æ™ºèƒ½ä½“æ“ä½œ</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleConfirmAction</span> = (<span class="hljs-params">actionId, confirmedData</span>) =&gt; {
  <span class="hljs-comment">// å‘é€ç¡®è®¤ä¿¡æ¯å›ä¸­å°ï¼Œä¾‹å¦‚ï¼šç¡®è®¤åŠ å…¥è´­ç‰©è½¦çš„å•†å“å’Œæ•°é‡</span>
  <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/agent/confirm-action'</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">session_id</span>: agentSession.<span class="hljs-property">id</span>,
      <span class="hljs-attr">action_id</span>: actionId,
      <span class="hljs-attr">user_confirmation</span>: confirmedData
    })
  });
};
</code></pre>
<h5 data-id="heading-6"><strong>3. å‰ç«¯å®Œæ•´ä»£ç --æ›´æ–°ä¸­ï¼Œå¯å‚è€ƒ</strong></h5>
<pre><code class="hljs language-js" lang="js">## æ•´å‰ç«¯å®ç°ï¼šåŸºäº<span class="hljs-variable constant_">SSE</span>å’Œ<span class="hljs-title class_">JavaScript</span>çš„<span class="hljs-variable constant_">AI</span>å¤–å–åŠ©æ‰‹
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AIFoodOrderingAssistant</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// åº”ç”¨çŠ¶æ€</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isConnected</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingActionId</span> = <span class="hljs-literal">null</span>;
        
        <span class="hljs-comment">// DOMå…ƒç´ </span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span> = {
            <span class="hljs-attr">userInput</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'userInput'</span>),
            <span class="hljs-attr">sendButton</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'sendButton'</span>),
            <span class="hljs-attr">messagesContainer</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'messagesContainer'</span>),
            <span class="hljs-attr">statusContainer</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'statusContainer'</span>),
            <span class="hljs-attr">sessionId</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'sessionId'</span>),
            <span class="hljs-attr">connectionStatus</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'connectionStatus'</span>),
            <span class="hljs-attr">paymentSection</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'paymentSection'</span>),
            <span class="hljs-attr">paymentFrame</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'paymentFrame'</span>)
        };
        
        <span class="hljs-comment">// åˆå§‹åŒ–</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
    }
    
    <span class="hljs-comment">/**
     * åˆå§‹åŒ–åº”ç”¨
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// 1. åˆ›å»ºæˆ–åŠ è½½ä¼šè¯</span>
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initializeSession</span>();
        
        <span class="hljs-comment">// 2. è®¾ç½®äº‹ä»¶ç›‘å¬å™¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupEventListeners</span>();
        
        <span class="hljs-comment">// 3. å»ºç«‹SSEè¿æ¥</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">connectToAgent</span>();
        
        <span class="hljs-comment">// 4. æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showWelcomeMessage</span>();
    }
    
    <span class="hljs-comment">/**
     * åˆå§‹åŒ–ä¼šè¯
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">initializeSession</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å°è¯•ä»localStorageè·å–ç°æœ‰ä¼šè¯ID</span>
            <span class="hljs-keyword">const</span> savedSessionId = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'agent_session_id'</span>);
            <span class="hljs-keyword">const</span> savedSessionTime = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'agent_session_time'</span>);
            
            <span class="hljs-comment">// æ£€æŸ¥ä¼šè¯æ˜¯å¦è¿‡æœŸï¼ˆè¶…è¿‡1å°æ—¶ï¼‰</span>
            <span class="hljs-keyword">const</span> sessionExpired = savedSessionTime &amp;&amp; 
                                 (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - <span class="hljs-built_in">parseInt</span>(savedSessionTime)) &gt; <span class="hljs-number">3600000</span>;
            
            <span class="hljs-keyword">if</span> (savedSessionId &amp;&amp; !sessionExpired) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span> = savedSessionId;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">sessionId</span>.<span class="hljs-property">textContent</span> = savedSessionId.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>) + <span class="hljs-string">'...'</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// åˆ›å»ºæ–°ä¼šè¯</span>
                <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/agent/session'</span>, {
                    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
                    <span class="hljs-attr">headers</span>: {
                        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
                    }
                });
                
                <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span> = data.<span class="hljs-property">session_id</span>;
                
                <span class="hljs-comment">// ä¿å­˜åˆ°localStorage</span>
                <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'agent_session_id'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span>);
                <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'agent_session_time'</span>, <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>().<span class="hljs-title function_">toString</span>());
                
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">sessionId</span>.<span class="hljs-property">textContent</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span>.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>) + <span class="hljs-string">'...'</span>;
            }
        } <span class="hljs-keyword">catch</span> (error) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åˆå§‹åŒ–ä¼šè¯å¤±è´¥:'</span>, error);
            <span class="hljs-comment">// ç”Ÿæˆä¸€ä¸ªä¸´æ—¶ä¼šè¯ID</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span> = <span class="hljs-string">'temp_'</span> + <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() + <span class="hljs-string">'_'</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>().<span class="hljs-title function_">toString</span>(<span class="hljs-number">36</span>).<span class="hljs-title function_">substr</span>(<span class="hljs-number">2</span>, <span class="hljs-number">9</span>);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">sessionId</span>.<span class="hljs-property">textContent</span> = <span class="hljs-string">'ä¸´æ—¶ä¼šè¯'</span>;
        }
    }
    
    <span class="hljs-comment">/**
     * è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
     */</span>
    <span class="hljs-title function_">setupEventListeners</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// å‘é€æŒ‰é’®ç‚¹å‡»äº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">sendButton</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendMessage</span>());
        
        <span class="hljs-comment">// è¾“å…¥æ¡†å›è½¦äº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keypress'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
            <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'Enter'</span> &amp;&amp; !e.<span class="hljs-property">shiftKey</span>) {
                e.<span class="hljs-title function_">preventDefault</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendMessage</span>();
            }
        });
        
        <span class="hljs-comment">// è¾“å…¥æ¡†è¾“å…¥äº‹ä»¶ï¼ˆå¯ç”¨/ç¦ç”¨å‘é€æŒ‰é’®ï¼‰</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'input'</span>, <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-keyword">const</span> hasText = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>().<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">sendButton</span>.<span class="hljs-property">disabled</span> = !hasText || <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>;
        });
        
        <span class="hljs-comment">// é¡µé¢å¸è½½æ—¶å…³é—­SSEè¿æ¥</span>
        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'beforeunload'</span>, <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-title function_">close</span>();
            }
        });
        
        <span class="hljs-comment">// æ–­çº¿é‡è¿</span>
        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'online'</span>, <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isConnected</span>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">connectToAgent</span>();
            }
        });
    }
    
    <span class="hljs-comment">/**
     * è¿æ¥åˆ°æ™ºèƒ½ä½“SSEæµ
     */</span>
    <span class="hljs-title function_">connectToAgent</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-title function_">close</span>();
        }
        
        <span class="hljs-keyword">const</span> sseUrl = <span class="hljs-string">`/api/agent/stream?session_id=<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.currentSessionId}</span>`</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventSource</span>(sseUrl);
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-property">onopen</span> = <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'SSEè¿æ¥å·²å»ºç«‹'</span>);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isConnected</span> = <span class="hljs-literal">true</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateConnectionStatus</span>(<span class="hljs-string">'ğŸŸ¢ å·²è¿æ¥'</span>);
        };
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'SSEè¿æ¥é”™è¯¯:'</span>, error);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isConnected</span> = <span class="hljs-literal">false</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateConnectionStatus</span>(<span class="hljs-string">'ğŸ”´ è¿æ¥æ–­å¼€'</span>);
            
            <span class="hljs-comment">// å°è¯•é‡æ–°è¿æ¥</span>
            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isConnected</span>) {
                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">connectToAgent</span>();
                }
            }, <span class="hljs-number">5000</span>);
        };
        
        <span class="hljs-comment">// å¤„ç†ä¸åŒçš„SSEäº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'status'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleStatusEvent</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'action_preview'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleActionPreviewEvent</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'message'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleMessageEvent</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'final_result'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleFinalResultEvent</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventSource</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'error'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleErrorEvent</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
    }
    
    <span class="hljs-comment">/**
     * æ›´æ–°è¿æ¥çŠ¶æ€æ˜¾ç¤º
     */</span>
    <span class="hljs-title function_">updateConnectionStatus</span>(<span class="hljs-params">status</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">connectionStatus</span>.<span class="hljs-property">textContent</span> = status;
    }
    
    <span class="hljs-comment">/**
     * å¤„ç†çŠ¶æ€äº‹ä»¶
     */</span>
    <span class="hljs-title function_">handleStatusEvent</span>(<span class="hljs-params">event</span>) {
        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addStatusCard</span>(data.<span class="hljs-property">status</span>, data.<span class="hljs-property">details</span>);
        
        <span class="hljs-comment">// æ›´æ–°UIçŠ¶æ€</span>
        <span class="hljs-keyword">if</span> (data.<span class="hljs-property">status</span> === <span class="hljs-string">'thinking'</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showTypingIndicator</span>();
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">true</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUIState</span>();
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data.<span class="hljs-property">status</span> === <span class="hljs-string">'executing_tool'</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'assistant'</span>, <span class="hljs-string">`æ­£åœ¨æ‰§è¡Œ: <span class="hljs-subst">${data.tool_name}</span>...`</span>, <span class="hljs-literal">false</span>);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">true</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUIState</span>();
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data.<span class="hljs-property">status</span> === <span class="hljs-string">'idle'</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeTypingIndicator</span>();
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUIState</span>();
        }
    }
    
    <span class="hljs-comment">/**
     * å¤„ç†æ“ä½œé¢„è§ˆäº‹ä»¶
     */</span>
    <span class="hljs-title function_">handleActionPreviewEvent</span>(<span class="hljs-params">event</span>) {
        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingActionId</span> = data.<span class="hljs-property">action_id</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showActionPreview</span>(data);
    }
    
    <span class="hljs-comment">/**
     * å¤„ç†æ¶ˆæ¯äº‹ä»¶
     */</span>
    <span class="hljs-title function_">handleMessageEvent</span>(<span class="hljs-params">event</span>) {
        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeTypingIndicator</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'assistant'</span>, data.<span class="hljs-property">content</span>, <span class="hljs-literal">true</span>);
    }
    
    <span class="hljs-comment">/**
     * å¤„ç†æœ€ç»ˆç»“æœäº‹ä»¶
     */</span>
    <span class="hljs-title function_">handleFinalResultEvent</span>(<span class="hljs-params">event</span>) {
        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
        
        <span class="hljs-keyword">if</span> (data.<span class="hljs-property">type</span> === <span class="hljs-string">'payment_page'</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showPaymentPage</span>(data.<span class="hljs-property">url</span>, data.<span class="hljs-property">token</span>);
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'assistant'</span>, <span class="hljs-string">'å·²ä¸ºæ‚¨è·³è½¬åˆ°æ”¯ä»˜é¡µé¢ï¼Œè¯·ç¡®è®¤è®¢å•ä¿¡æ¯å¹¶å®Œæˆæ”¯ä»˜ã€‚'</span>, <span class="hljs-literal">true</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data.<span class="hljs-property">type</span> === <span class="hljs-string">'order_created'</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'assistant'</span>, <span class="hljs-string">`è®¢å•åˆ›å»ºæˆåŠŸï¼è®¢å•å·: <span class="hljs-subst">${data.order_id}</span>ï¼Œæ€»ä»·: Â¥<span class="hljs-subst">${data.total_price}</span>`</span>, <span class="hljs-literal">true</span>);
        }
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUIState</span>();
    }
    
    <span class="hljs-comment">/**
     * å¤„ç†é”™è¯¯äº‹ä»¶
     */</span>
    <span class="hljs-title function_">handleErrorEvent</span>(<span class="hljs-params">event</span>) {
        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'assistant'</span>, <span class="hljs-string">`âŒ é”™è¯¯: <span class="hljs-subst">${data.message}</span>`</span>, <span class="hljs-literal">true</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addStatusCard</span>(<span class="hljs-string">'error'</span>, data.<span class="hljs-property">message</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUIState</span>();
    }
    
    <span class="hljs-comment">/**
     * å‘é€ç”¨æˆ·æ¶ˆæ¯
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">sendMessage</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> userInput = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>();
        
        <span class="hljs-keyword">if</span> (!userInput || <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>) <span class="hljs-keyword">return</span>;
        
        <span class="hljs-comment">// æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°ç•Œé¢</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'user'</span>, userInput, <span class="hljs-literal">true</span>);
        
        <span class="hljs-comment">// æ¸…ç©ºè¾“å…¥æ¡†</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-property">value</span> = <span class="hljs-string">''</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">sendButton</span>.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">true</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUIState</span>();
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å‘é€æ¶ˆæ¯åˆ°æœåŠ¡å™¨</span>
            <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/agent/process'</span>, {
                <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
                <span class="hljs-attr">headers</span>: {
                    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
                },
                <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
                    <span class="hljs-attr">session_id</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span>,
                    <span class="hljs-attr">message</span>: userInput,
                    <span class="hljs-attr">context</span>: {
                        <span class="hljs-attr">user_location</span>: <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUserLocation</span>(),
                        <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()
                    }
                })
            });
            
            <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
            }
            
            <span class="hljs-comment">// æ˜¾ç¤ºæ€è€ƒä¸­çš„çŠ¶æ€</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addStatusCard</span>(<span class="hljs-string">'thinking'</span>, <span class="hljs-string">'æ­£åœ¨åˆ†ææ‚¨çš„éœ€æ±‚...'</span>);
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showTypingIndicator</span>();
            
        } <span class="hljs-keyword">catch</span> (error) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å‘é€æ¶ˆæ¯å¤±è´¥:'</span>, error);
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'assistant'</span>, <span class="hljs-string">'æŠ±æ­‰ï¼Œå‘é€æ¶ˆæ¯æ—¶å‡ºç°é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•ã€‚'</span>, <span class="hljs-literal">true</span>);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUIState</span>();
        }
    }
    
    <span class="hljs-comment">/**
     * ç¡®è®¤æ™ºèƒ½ä½“æ“ä½œ
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">confirmAction</span>(<span class="hljs-params">confirmedData = <span class="hljs-literal">null</span></span>) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingActionId</span>) <span class="hljs-keyword">return</span>;
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/agent/confirm-action'</span>, {
                <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
                <span class="hljs-attr">headers</span>: {
                    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
                },
                <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
                    <span class="hljs-attr">session_id</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span>,
                    <span class="hljs-attr">action_id</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingActionId</span>,
                    <span class="hljs-attr">user_confirmation</span>: confirmedData
                })
            });
            
            <span class="hljs-keyword">if</span> (response.<span class="hljs-property">ok</span>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeActionPreview</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingActionId</span> = <span class="hljs-literal">null</span>;
            }
        } <span class="hljs-keyword">catch</span> (error) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ç¡®è®¤æ“ä½œå¤±è´¥:'</span>, error);
        }
    }
    
    <span class="hljs-comment">/**
     * ä¿®æ”¹æ“ä½œ
     */</span>
    <span class="hljs-title function_">modifyAction</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œå¯ä»¥æ‰“å¼€ä¸€ä¸ªä¿®æ”¹ç•Œé¢</span>
        <span class="hljs-keyword">const</span> modification = <span class="hljs-title function_">prompt</span>(<span class="hljs-string">'è¯·è¾“å…¥ä¿®æ”¹å†…å®¹ï¼ˆä¾‹å¦‚ï¼šæ¢å¤§æ¯å¯ä¹ï¼ŒåŠ ä¸€ä»½è–¯æ¡ï¼‰ï¼š'</span>);
        <span class="hljs-keyword">if</span> (modification) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'user'</span>, <span class="hljs-string">`ä¿®æ”¹ï¼š<span class="hljs-subst">${modification}</span>`</span>, <span class="hljs-literal">true</span>);
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeActionPreview</span>();
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendModification</span>(modification);
        }
    }
    
    <span class="hljs-comment">/**
     * å‘é€ä¿®æ”¹è¯·æ±‚
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">sendModification</span>(<span class="hljs-params">modification</span>) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/agent/modify'</span>, {
                <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
                <span class="hljs-attr">headers</span>: {
                    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
                },
                <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
                    <span class="hljs-attr">session_id</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentSessionId</span>,
                    <span class="hljs-attr">modification</span>: modification
                })
            });
            
            <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ä¿®æ”¹è¯·æ±‚å¤±è´¥'</span>);
            }
        } <span class="hljs-keyword">catch</span> (error) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å‘é€ä¿®æ”¹å¤±è´¥:'</span>, error);
        }
    }
    
    <span class="hljs-comment">/**
     * æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
     */</span>
    <span class="hljs-title function_">showWelcomeMessage</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> welcomeMessages = [
            <span class="hljs-string">"ğŸ‘‹ ä½ å¥½ï¼æˆ‘æ˜¯AIå¤–å–åŠ©æ‰‹ï¼Œå¯ä»¥å¸®ä½ å®Œæˆä»é€‰é¤åˆ°æ”¯ä»˜çš„å…¨æµç¨‹ã€‚"</span>,
            <span class="hljs-string">"ğŸ’¡ ä½ å¯ä»¥è¿™æ ·å¯¹æˆ‘è¯´ï¼š"</span>,
            <span class="hljs-string">"â€¢ \"å¸®æˆ‘ç‚¹ä¸€ä»½éº¦å½“åŠ³å·¨æ— éœ¸å¥—é¤ï¼Œé€åˆ°XXå¤§å¦\""</span>,
            <span class="hljs-string">"â€¢ \"æˆ‘æƒ³åƒæŠ«è¨ï¼Œé€åˆ°å…¬å¸åœ°å€\""</span>,
            <span class="hljs-string">"â€¢ \"ç‚¹ä¸€ä»½å¤–å–ï¼Œé¢„ç®—50å…ƒå·¦å³\""</span>,
            <span class="hljs-string">"æˆ‘ä¼šä¸€æ­¥æ­¥å¼•å¯¼ä½ å®Œæˆè®¢å•ï¼Œå¹¶åœ¨æœ€åè·³è½¬åˆ°æ”¯ä»˜é¡µé¢ã€‚"</span>
        ];
        
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            welcomeMessages.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">msg, index</span>) =&gt;</span> {
                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'assistant'</span>, msg, <span class="hljs-literal">true</span>);
                }, index * <span class="hljs-number">300</span>);
            });
        }, <span class="hljs-number">1000</span>);
    }
    
    <span class="hljs-comment">/**
     * æ·»åŠ æ¶ˆæ¯åˆ°èŠå¤©ç•Œé¢
     */</span>
    <span class="hljs-title function_">addMessage</span>(<span class="hljs-params">role, content, animate = <span class="hljs-literal">true</span></span>) {
        <span class="hljs-keyword">const</span> messageDiv = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        messageDiv.<span class="hljs-property">className</span> = <span class="hljs-string">`message <span class="hljs-subst">${role}</span>-message`</span>;
        
        <span class="hljs-keyword">const</span> bubble = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        bubble.<span class="hljs-property">className</span> = <span class="hljs-string">'message-bubble'</span>;
        bubble.<span class="hljs-property">textContent</span> = content;
        
        messageDiv.<span class="hljs-title function_">appendChild</span>(bubble);
        
        <span class="hljs-keyword">if</span> (animate) {
            messageDiv.<span class="hljs-property">style</span>.<span class="hljs-property">opacity</span> = <span class="hljs-string">'0'</span>;
            messageDiv.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">'translateY(10px)'</span>;
        }
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">messagesContainer</span>.<span class="hljs-title function_">appendChild</span>(messageDiv);
        
        <span class="hljs-keyword">if</span> (animate) {
            <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
                messageDiv.<span class="hljs-property">style</span>.<span class="hljs-property">transition</span> = <span class="hljs-string">'opacity 0.3s ease, transform 0.3s ease'</span>;
                messageDiv.<span class="hljs-property">style</span>.<span class="hljs-property">opacity</span> = <span class="hljs-string">'1'</span>;
                messageDiv.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">'translateY(0)'</span>;
            });
        }
        
        <span class="hljs-comment">// æ»šåŠ¨åˆ°åº•éƒ¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scrollToBottom</span>();
    }
    
    <span class="hljs-comment">/**
     * æ˜¾ç¤ºè¾“å…¥æŒ‡ç¤ºå™¨
     */</span>
    <span class="hljs-title function_">showTypingIndicator</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeTypingIndicator</span>(); <span class="hljs-comment">// å…ˆç§»é™¤å¯èƒ½å­˜åœ¨çš„ç°æœ‰æŒ‡ç¤ºå™¨</span>
        
        <span class="hljs-keyword">const</span> typingDiv = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        typingDiv.<span class="hljs-property">className</span> = <span class="hljs-string">'message agent-message typing-indicator'</span>;
        typingDiv.<span class="hljs-property">id</span> = <span class="hljs-string">'typingIndicator'</span>;
        
        <span class="hljs-keyword">const</span> typingBubble = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        typingBubble.<span class="hljs-property">className</span> = <span class="hljs-string">'message-typing'</span>;
        
        <span class="hljs-keyword">const</span> dots = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        dots.<span class="hljs-property">className</span> = <span class="hljs-string">'typing-dots'</span>;
        dots.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">'&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;span&gt;&lt;/span&gt;'</span>;
        
        typingBubble.<span class="hljs-title function_">appendChild</span>(dots);
        typingDiv.<span class="hljs-title function_">appendChild</span>(typingBubble);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">messagesContainer</span>.<span class="hljs-title function_">appendChild</span>(typingDiv);
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scrollToBottom</span>();
    }
    
    <span class="hljs-comment">/**
     * ç§»é™¤è¾“å…¥æŒ‡ç¤ºå™¨
     */</span>
    <span class="hljs-title function_">removeTypingIndicator</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> existingIndicator = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'typingIndicator'</span>);
        <span class="hljs-keyword">if</span> (existingIndicator) {
            existingIndicator.<span class="hljs-title function_">remove</span>();
        }
    }
    
    <span class="hljs-comment">/**
     * æ·»åŠ çŠ¶æ€å¡ç‰‡
     */</span>
    <span class="hljs-title function_">addStatusCard</span>(<span class="hljs-params">status, details</span>) {
        <span class="hljs-keyword">const</span> statusCard = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        statusCard.<span class="hljs-property">className</span> = <span class="hljs-string">'status-card'</span>;
        
        <span class="hljs-keyword">const</span> now = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();
        <span class="hljs-keyword">const</span> timeString = now.<span class="hljs-title function_">toLocaleTimeString</span>(<span class="hljs-string">'zh-CN'</span>, { 
            <span class="hljs-attr">hour</span>: <span class="hljs-string">'2-digit'</span>, 
            <span class="hljs-attr">minute</span>: <span class="hljs-string">'2-digit'</span>,
            <span class="hljs-attr">second</span>: <span class="hljs-string">'2-digit'</span>
        });
        
        <span class="hljs-keyword">let</span> statusIcon = <span class="hljs-string">'ğŸ”µ'</span>;
        <span class="hljs-keyword">let</span> statusText = <span class="hljs-string">'å¤„ç†ä¸­'</span>;
        
        <span class="hljs-keyword">switch</span>(status) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'thinking'</span>:
                statusIcon = <span class="hljs-string">'ğŸ¤”'</span>;
                statusText = <span class="hljs-string">'æ€è€ƒä¸­'</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'querying_menu'</span>:
                statusIcon = <span class="hljs-string">'ğŸ“‹'</span>;
                statusText = <span class="hljs-string">'æŸ¥è¯¢èœå•'</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'executing_tool'</span>:
                statusIcon = <span class="hljs-string">'âš™ï¸'</span>;
                statusText = <span class="hljs-string">'æ‰§è¡Œå·¥å…·'</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'waiting_confirmation'</span>:
                statusIcon = <span class="hljs-string">'â³'</span>;
                statusText = <span class="hljs-string">'ç­‰å¾…ç¡®è®¤'</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'error'</span>:
                statusIcon = <span class="hljs-string">'âŒ'</span>;
                statusText = <span class="hljs-string">'é”™è¯¯'</span>;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'completed'</span>:
                statusIcon = <span class="hljs-string">'âœ…'</span>;
                statusText = <span class="hljs-string">'å·²å®Œæˆ'</span>;
                <span class="hljs-keyword">break</span>;
        }
        
        statusCard.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`
            &lt;h4&gt;<span class="hljs-subst">${statusIcon}</span> <span class="hljs-subst">${statusText}</span>&lt;/h4&gt;
            &lt;p&gt;<span class="hljs-subst">${details}</span>&lt;/p&gt;
            &lt;div class="timestamp"&gt;<span class="hljs-subst">${timeString}</span>&lt;/div&gt;
        `</span>;
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">statusContainer</span>.<span class="hljs-title function_">appendChild</span>(statusCard);
        
        <span class="hljs-comment">// æ»šåŠ¨çŠ¶æ€å®¹å™¨åˆ°åº•éƒ¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">statusContainer</span>.<span class="hljs-property">scrollTop</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">statusContainer</span>.<span class="hljs-property">scrollHeight</span>;
    }
    
    <span class="hljs-comment">/**
     * æ˜¾ç¤ºæ“ä½œé¢„è§ˆ
     */</span>
    <span class="hljs-title function_">showActionPreview</span>(<span class="hljs-params">data</span>) {
        <span class="hljs-keyword">const</span> actionCard = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        actionCard.<span class="hljs-property">className</span> = <span class="hljs-string">'action-preview-card'</span>;
        actionCard.<span class="hljs-property">id</span> = <span class="hljs-string">'actionPreviewCard'</span>;
        
        <span class="hljs-keyword">let</span> actionDetails = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">let</span> actionTitle = <span class="hljs-string">'è¯·ç¡®è®¤æ“ä½œ'</span>;
        
        <span class="hljs-keyword">switch</span>(data.<span class="hljs-property">action</span>) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'add_to_cart'</span>:
                actionTitle = <span class="hljs-string">'ğŸ›’ æ·»åŠ åˆ°è´­ç‰©è½¦'</span>;
                actionDetails = <span class="hljs-string">`
                    &lt;div&gt;&lt;strong&gt;é¤å…ï¼š&lt;/strong&gt;<span class="hljs-subst">${data.params.restaurant || <span class="hljs-string">'æœªçŸ¥'</span>}</span>&lt;/div&gt;
                    &lt;div&gt;&lt;strong&gt;å•†å“ï¼š&lt;/strong&gt;&lt;/div&gt;
                    &lt;ul&gt;
                        <span class="hljs-subst">${(data.params.items || []).map(item =&gt; 
                            <span class="hljs-string">`&lt;li&gt;<span class="hljs-subst">${item.name}</span> Ã— <span class="hljs-subst">${item.quantity}</span>&lt;/li&gt;`</span>
                        ).join(<span class="hljs-string">''</span>)}</span>
                    &lt;/ul&gt;
                `</span>;
                <span class="hljs-keyword">break</span>;
                
            <span class="hljs-keyword">case</span> <span class="hljs-string">'select_address'</span>:
                actionTitle = <span class="hljs-string">'ğŸ“ é€‰æ‹©åœ°å€'</span>;
                actionDetails = <span class="hljs-string">`
                    &lt;div&gt;&lt;strong&gt;è¯·é€‰æ‹©æ”¶è´§åœ°å€ï¼š&lt;/strong&gt;&lt;/div&gt;
                    <span class="hljs-subst">${(data.params.options || []).map((addr, idx) =&gt; <span class="hljs-string">`
                        &lt;div style="margin: 8px 0; padding: 8px; border: 1px solid #e5e7eb; border-radius: 6px;"&gt;
                            &lt;label&gt;
                                &lt;input type="radio" name="address" value="<span class="hljs-subst">${addr.id}</span>" <span class="hljs-subst">${idx === <span class="hljs-number">0</span> ? <span class="hljs-string">'checked'</span> : <span class="hljs-string">''</span>}</span>&gt;
                                <span class="hljs-subst">${addr.name}</span> (<span class="hljs-subst">${addr.address}</span>)
                            &lt;/label&gt;
                        &lt;/div&gt;
                    `</span>).join(<span class="hljs-string">''</span>)}</span>
                `</span>;
                <span class="hljs-keyword">break</span>;
                
            <span class="hljs-keyword">case</span> <span class="hljs-string">'get_payment_page'</span>:
                actionTitle = <span class="hljs-string">'ğŸ’° å‰å¾€æ”¯ä»˜'</span>;
                actionDetails = <span class="hljs-string">`
                    &lt;div&gt;&lt;strong&gt;è®¢å•æ‘˜è¦ï¼š&lt;/strong&gt;&lt;/div&gt;
                    &lt;div&gt;æ€»é‡‘é¢ï¼šÂ¥<span class="hljs-subst">${data.params.total_price || <span class="hljs-string">'0.00'</span>}</span>&lt;/div&gt;
                    &lt;div&gt;é…é€åœ°å€ï¼š<span class="hljs-subst">${data.params.address || <span class="hljs-string">'è¯·ç¡®è®¤åœ°å€'</span>}</span>&lt;/div&gt;
                    &lt;div&gt;é¢„è®¡é€è¾¾ï¼š<span class="hljs-subst">${data.params.estimated_delivery || <span class="hljs-string">'30åˆ†é’Ÿ'</span>}</span>&lt;/div&gt;
                `</span>;
                <span class="hljs-keyword">break</span>;
        }
        
        actionCard.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`
            &lt;h3&gt;<span class="hljs-subst">${actionTitle}</span>&lt;/h3&gt;
            &lt;div class="action-details"&gt;<span class="hljs-subst">${actionDetails}</span>&lt;/div&gt;
            &lt;div class="action-buttons"&gt;
                &lt;button onclick="assistant.confirmAction(getConfirmedData())" class="btn btn-confirm"&gt;ç¡®è®¤&lt;/button&gt;
                &lt;button onclick="assistant.modifyAction()" class="btn btn-modify"&gt;ä¿®æ”¹&lt;/button&gt;
            &lt;/div&gt;
        `</span>;
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">statusContainer</span>.<span class="hljs-title function_">appendChild</span>(actionCard);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">statusContainer</span>.<span class="hljs-property">scrollTop</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">statusContainer</span>.<span class="hljs-property">scrollHeight</span>;
    }
    
    <span class="hljs-comment">/**
     * ç§»é™¤æ“ä½œé¢„è§ˆ
     */</span>
    <span class="hljs-title function_">removeActionPreview</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> existingCard = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'actionPreviewCard'</span>);
        <span class="hljs-keyword">if</span> (existingCard) {
            existingCard.<span class="hljs-title function_">remove</span>();
        }
    }
    
    <span class="hljs-comment">/**
     * æ˜¾ç¤ºæ”¯ä»˜é¡µé¢
     */</span>
    <span class="hljs-title function_">showPaymentPage</span>(<span class="hljs-params">url, token</span>) {
        <span class="hljs-comment">// æ„å»ºå®Œæ•´çš„æ”¯ä»˜URLï¼ˆåŒ…å«tokenï¼‰</span>
        <span class="hljs-keyword">const</span> paymentUrl = <span class="hljs-string">`<span class="hljs-subst">${url}</span><span class="hljs-subst">${url.includes(<span class="hljs-string">'?'</span>) ? <span class="hljs-string">'&amp;'</span> : <span class="hljs-string">'?'</span>}</span>token=<span class="hljs-subst">${token}</span>&amp;embedded=true`</span>;
        
        <span class="hljs-comment">// æ›´æ–°iframeæº</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">paymentFrame</span>.<span class="hljs-property">src</span> = paymentUrl;
        
        <span class="hljs-comment">// æ˜¾ç¤ºæ”¯ä»˜å®¹å™¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">paymentSection</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'block'</span>;
        
        <span class="hljs-comment">// æ»šåŠ¨åˆ°æ”¯ä»˜åŒºåŸŸ</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">paymentSection</span>.<span class="hljs-title function_">scrollIntoView</span>({ <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span> });
        }, <span class="hljs-number">500</span>);
    }
    
    <span class="hljs-comment">/**
     * éšè—æ”¯ä»˜é¡µé¢
     */</span>
    <span class="hljs-title function_">hidePaymentSection</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">paymentSection</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">paymentFrame</span>.<span class="hljs-property">src</span> = <span class="hljs-string">''</span>;
    }
    
    <span class="hljs-comment">/**
     * è·å–ç”¨æˆ·ä½ç½®ï¼ˆæ¨¡æ‹Ÿï¼‰
     */</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">getUserLocation</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
            <span class="hljs-keyword">if</span> (navigator.<span class="hljs-property">geolocation</span>) {
                navigator.<span class="hljs-property">geolocation</span>.<span class="hljs-title function_">getCurrentPosition</span>(
                    <span class="hljs-function">(<span class="hljs-params">position</span>) =&gt;</span> {
                        <span class="hljs-title function_">resolve</span>({
                            <span class="hljs-attr">latitude</span>: position.<span class="hljs-property">coords</span>.<span class="hljs-property">latitude</span>,
                            <span class="hljs-attr">longitude</span>: position.<span class="hljs-property">coords</span>.<span class="hljs-property">longitude</span>,
                            <span class="hljs-attr">accuracy</span>: position.<span class="hljs-property">coords</span>.<span class="hljs-property">accuracy</span>
                        });
                    },
                    <span class="hljs-function">() =&gt;</span> {
                        <span class="hljs-comment">// è·å–å¤±è´¥æ—¶ä½¿ç”¨é»˜è®¤ä½ç½®</span>
                        <span class="hljs-title function_">resolve</span>({
                            <span class="hljs-attr">latitude</span>: <span class="hljs-number">39.9042</span>,
                            <span class="hljs-attr">longitude</span>: <span class="hljs-number">116.4074</span>,
                            <span class="hljs-attr">accuracy</span>: <span class="hljs-number">1000</span>,
                            <span class="hljs-attr">city</span>: <span class="hljs-string">'åŒ—äº¬å¸‚'</span>
                        });
                    },
                    { <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span> }
                );
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-title function_">resolve</span>({
                    <span class="hljs-attr">latitude</span>: <span class="hljs-number">39.9042</span>,
                    <span class="hljs-attr">longitude</span>: <span class="hljs-number">116.4074</span>,
                    <span class="hljs-attr">city</span>: <span class="hljs-string">'åŒ—äº¬å¸‚'</span>
                });
            }
        });
    }
    
    <span class="hljs-comment">/**
     * æ›´æ–°UIçŠ¶æ€
     */</span>
    <span class="hljs-title function_">updateUIState</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> hasText = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>().<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">sendButton</span>.<span class="hljs-property">disabled</span> = !hasText || <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-property">disabled</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>;
        
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-property">placeholder</span> = <span class="hljs-string">'æ™ºèƒ½ä½“æ­£åœ¨å¤„ç†ä¸­ï¼Œè¯·ç¨å€™...'</span>;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">userInput</span>.<span class="hljs-property">placeholder</span> = <span class="hljs-string">'å‘Šè¯‰æˆ‘ä½ æƒ³åƒä»€ä¹ˆï¼Ÿä¾‹å¦‚ï¼šå¸®æˆ‘ç‚¹ä¸€ä»½éº¦å½“åŠ³å·¨æ— éœ¸å¥—é¤ï¼Œé€åˆ°XXå¤§å¦ï¼Œå¸®æˆ‘åˆ°ä»˜æ¬¾ç•Œé¢'</span>;
        }
    }
    
    <span class="hljs-comment">/**
     * æ»šåŠ¨åˆ°åº•éƒ¨
     */</span>
    <span class="hljs-title function_">scrollToBottom</span>(<span class="hljs-params"/>) {
        <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">messagesContainer</span>.<span class="hljs-property">scrollTop</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-property">messagesContainer</span>.<span class="hljs-property">scrollHeight</span>;
        });
    }
}

<span class="hljs-comment">/**
 * è·å–ç¡®è®¤æ•°æ®ï¼ˆç”¨äºè¡¨å•æ•°æ®ï¼‰
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getConfirmedData</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> actionCard = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'actionPreviewCard'</span>);
    <span class="hljs-keyword">if</span> (!actionCard) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰åœ°å€é€‰æ‹©</span>
    <span class="hljs-keyword">const</span> addressRadio = actionCard.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'input[name="address"]:checked'</span>);
    <span class="hljs-keyword">if</span> (addressRadio) {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">address_id</span>: addressRadio.<span class="hljs-property">value</span> };
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-comment">// åˆ›å»ºåŠ©æ‰‹å®ä¾‹</span>
<span class="hljs-keyword">const</span> assistant = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AIFoodOrderingAssistant</span>();

<span class="hljs-comment">// ä½¿åŠ©æ‰‹å…¨å±€å¯ç”¨ï¼ˆç”¨äºæŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼‰</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-property">assistant</span> = assistant;
<span class="hljs-variable language_">window</span>.<span class="hljs-property">hidePaymentSection</span> = <span class="hljs-function">() =&gt;</span> assistant.<span class="hljs-title function_">hidePaymentSection</span>();
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>AIå¤–å–åŠ©æ‰‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        * {
            <span class="hljs-attribute">box-sizing</span>: border-box;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
        }
        
        <span class="hljs-selector-tag">body</span> {
            <span class="hljs-attribute">font-family</span>: -apple-system, BlinkMacSystemFont, <span class="hljs-string">'Segoe UI'</span>, Roboto, sans-serif;
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#667eea</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#764ba2</span> <span class="hljs-number">100%</span>);
            <span class="hljs-attribute">min-height</span>: <span class="hljs-number">100vh</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
        }
        
        <span class="hljs-selector-class">.app-container</span> {
            <span class="hljs-attribute">max-width</span>: <span class="hljs-number">800px</span>;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;
            <span class="hljs-attribute">background</span>: white;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">60px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.3</span>);
            <span class="hljs-attribute">overflow</span>: hidden;
        }
        
        <span class="hljs-selector-class">.header</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#667eea</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#764ba2</span> <span class="hljs-number">100%</span>);
            <span class="hljs-attribute">color</span>: white;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">24px</span>;
            <span class="hljs-attribute">text-align</span>: center;
        }
        
        <span class="hljs-selector-class">.header</span> <span class="hljs-selector-tag">h1</span> {
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">28px</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
        }
        
        <span class="hljs-selector-class">.header</span> <span class="hljs-selector-tag">p</span> {
            <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.9</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
        }
        
        <span class="hljs-selector-class">.main-content</span> {
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">70vh</span>;
        }
        
        <span class="hljs-comment">/* å·¦ä¾§ï¼šå¯¹è¯åŒº */</span>
        <span class="hljs-selector-class">.chat-section</span> {
            <span class="hljs-attribute">flex</span>: <span class="hljs-number">3</span>;
            <span class="hljs-attribute">border-right</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e5e7eb</span>;
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">flex-direction</span>: column;
        }
        
        <span class="hljs-selector-class">.chat-header</span> {
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e5e7eb</span>;
            <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#374151</span>;
        }
        
        <span class="hljs-selector-class">.messages-container</span> {
            <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
            <span class="hljs-attribute">overflow-y</span>: auto;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#f9fafb</span>;
        }
        
        <span class="hljs-selector-class">.message</span> {
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">animation</span>: fadeIn <span class="hljs-number">0.3s</span> ease;
        }
        
        <span class="hljs-selector-class">.user-message</span> {
            <span class="hljs-attribute">text-align</span>: right;
        }
        
        <span class="hljs-selector-class">.agent-message</span> {
            <span class="hljs-attribute">text-align</span>: left;
        }
        
        <span class="hljs-selector-class">.message-bubble</span> {
            <span class="hljs-attribute">display</span>: inline-block;
            <span class="hljs-attribute">max-width</span>: <span class="hljs-number">70%</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">12px</span> <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">18px</span>;
            <span class="hljs-attribute">word-wrap</span>: break-word;
            <span class="hljs-attribute">line-height</span>: <span class="hljs-number">1.4</span>;
        }
        
        <span class="hljs-selector-class">.user-message</span> <span class="hljs-selector-class">.message-bubble</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#3b82f6</span>;
            <span class="hljs-attribute">color</span>: white;
            <span class="hljs-attribute">border-bottom-right-radius</span>: <span class="hljs-number">4px</span>;
        }
        
        <span class="hljs-selector-class">.agent-message</span> <span class="hljs-selector-class">.message-bubble</span> {
            <span class="hljs-attribute">background</span>: white;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#374151</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e5e7eb</span>;
            <span class="hljs-attribute">border-bottom-left-radius</span>: <span class="hljs-number">4px</span>;
        }
        
        <span class="hljs-selector-class">.message-typing</span> {
            <span class="hljs-attribute">display</span>: inline-flex;
            <span class="hljs-attribute">align-items</span>: center;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">12px</span> <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">background</span>: white;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e5e7eb</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">18px</span>;
            <span class="hljs-attribute">border-bottom-left-radius</span>: <span class="hljs-number">4px</span>;
        }
        
        <span class="hljs-selector-class">.typing-dots</span> {
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">gap</span>: <span class="hljs-number">4px</span>;
        }
        
        <span class="hljs-selector-class">.typing-dots</span> <span class="hljs-selector-tag">span</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">6px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">6px</span>;
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#9ca3af</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
            <span class="hljs-attribute">animation</span>: typing <span class="hljs-number">1.4s</span> infinite ease-in-out;
        }
        
        <span class="hljs-selector-class">.typing-dots</span> <span class="hljs-selector-tag">span</span><span class="hljs-selector-pseudo">:nth-child</span>(<span class="hljs-number">2</span>) {
            <span class="hljs-attribute">animation-delay</span>: <span class="hljs-number">0.2s</span>;
        }
        
        <span class="hljs-selector-class">.typing-dots</span> <span class="hljs-selector-tag">span</span><span class="hljs-selector-pseudo">:nth-child</span>(<span class="hljs-number">3</span>) {
            <span class="hljs-attribute">animation-delay</span>: <span class="hljs-number">0.4s</span>;
        }
        
        <span class="hljs-comment">/* å³ä¾§ï¼šæ™ºèƒ½ä½“çŠ¶æ€å’Œæ“ä½œåŒº */</span>
        <span class="hljs-selector-class">.status-section</span> {
            <span class="hljs-attribute">flex</span>: <span class="hljs-number">2</span>;
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">flex-direction</span>: column;
            <span class="hljs-attribute">background</span>: white;
        }
        
        <span class="hljs-selector-class">.status-header</span> {
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e5e7eb</span>;
            <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#374151</span>;
        }
        
        <span class="hljs-selector-class">.status-container</span> {
            <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
            <span class="hljs-attribute">overflow-y</span>: auto;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
        }
        
        <span class="hljs-selector-class">.status-card</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#f3f4f6</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">border-left</span>: <span class="hljs-number">4px</span> solid <span class="hljs-number">#3b82f6</span>;
            <span class="hljs-attribute">animation</span>: slideIn <span class="hljs-number">0.3s</span> ease;
        }
        
        <span class="hljs-selector-class">.status-card</span> <span class="hljs-selector-tag">h4</span> {
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#374151</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
            <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
        }
        
        <span class="hljs-selector-class">.status-card</span> <span class="hljs-selector-tag">p</span> {
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#6b7280</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">13px</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">4px</span>;
        }
        
        <span class="hljs-selector-class">.status-card</span> <span class="hljs-selector-class">.timestamp</span> {
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">11px</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#9ca3af</span>;
            <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">8px</span>;
        }
        
        <span class="hljs-comment">/* æ“ä½œé¢„è§ˆå¡ç‰‡ */</span>
        <span class="hljs-selector-class">.action-preview-card</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#fef3c7</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">2px</span> solid <span class="hljs-number">#f59e0b</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">animation</span>: pulse <span class="hljs-number">2s</span> infinite;
        }
        
        <span class="hljs-selector-class">.action-preview-card</span> <span class="hljs-selector-tag">h3</span> {
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#92400e</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;
        }
        
        <span class="hljs-selector-class">.action-details</span> {
            <span class="hljs-attribute">background</span>: white;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
        }
        
        <span class="hljs-selector-class">.action-buttons</span> {
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">gap</span>: <span class="hljs-number">12px</span>;
        }
        
        <span class="hljs-selector-class">.btn</span> {
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span> <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">border</span>: none;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
            <span class="hljs-attribute">cursor</span>: pointer;
            <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.2s</span> ease;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
        }
        
        <span class="hljs-selector-class">.btn-confirm</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#10b981</span>;
            <span class="hljs-attribute">color</span>: white;
            <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
        }
        
        <span class="hljs-selector-class">.btn-confirm</span><span class="hljs-selector-pseudo">:hover</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#059669</span>;
        }
        
        <span class="hljs-selector-class">.btn-modify</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#f3f4f6</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#374151</span>;
            <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
        }
        
        <span class="hljs-selector-class">.btn-modify</span><span class="hljs-selector-pseudo">:hover</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#e5e7eb</span>;
        }
        
        <span class="hljs-comment">/* è¾“å…¥åŒº */</span>
        <span class="hljs-selector-class">.input-section</span> {
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">border-top</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e5e7eb</span>;
            <span class="hljs-attribute">background</span>: white;
        }
        
        <span class="hljs-selector-class">.input-container</span> {
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">gap</span>: <span class="hljs-number">12px</span>;
        }
        
        <span class="hljs-selector-id">#userInput</span> {
            <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">14px</span> <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">2px</span> solid <span class="hljs-number">#e5e7eb</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;
            <span class="hljs-attribute">transition</span>: border-color <span class="hljs-number">0.2s</span> ease;
        }
        
        <span class="hljs-selector-id">#userInput</span><span class="hljs-selector-pseudo">:focus</span> {
            <span class="hljs-attribute">outline</span>: none;
            <span class="hljs-attribute">border-color</span>: <span class="hljs-number">#3b82f6</span>;
        }
        
        <span class="hljs-selector-class">.btn-send</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#667eea</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#764ba2</span> <span class="hljs-number">100%</span>);
            <span class="hljs-attribute">color</span>: white;
            <span class="hljs-attribute">border</span>: none;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">28px</span>;
            <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;
            <span class="hljs-attribute">cursor</span>: pointer;
            <span class="hljs-attribute">transition</span>: transform <span class="hljs-number">0.2s</span> ease;
        }
        
        <span class="hljs-selector-class">.btn-send</span><span class="hljs-selector-pseudo">:hover</span><span class="hljs-selector-pseudo">:not</span>(<span class="hljs-selector-pseudo">:disabled</span>) {
            <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">2px</span>);
        }
        
        <span class="hljs-selector-class">.btn-send</span><span class="hljs-selector-pseudo">:disabled</span> {
            <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.5</span>;
            <span class="hljs-attribute">cursor</span>: not-allowed;
        }
        
        <span class="hljs-comment">/* æ”¯ä»˜é¡µé¢å®¹å™¨ */</span>
        <span class="hljs-selector-class">.payment-container</span> {
            <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">2px</span> dashed <span class="hljs-number">#10b981</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#f0fdf4</span>;
            <span class="hljs-attribute">animation</span>: fadeIn <span class="hljs-number">0.5s</span> ease;
        }
        
        <span class="hljs-selector-class">.payment-header</span> {
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">justify-content</span>: space-between;
            <span class="hljs-attribute">align-items</span>: center;
            <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">16px</span>;
        }
        
        <span class="hljs-selector-class">.payment-header</span> <span class="hljs-selector-tag">h3</span> {
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#065f46</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;
        }
        
        <span class="hljs-selector-class">.payment-frame</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">400px</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#d1d5db</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">overflow</span>: hidden;
        }
        
        <span class="hljs-comment">/* åŠ¨ç”» */</span>
        <span class="hljs-keyword">@keyframes</span> fadeIn {
            <span class="hljs-selector-tag">from</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">10px</span>); }
            <span class="hljs-selector-tag">to</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0</span>); }
        }
        
        <span class="hljs-keyword">@keyframes</span> slideIn {
            <span class="hljs-selector-tag">from</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">10px</span>); }
            <span class="hljs-selector-tag">to</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">0</span>); }
        }
        
        <span class="hljs-keyword">@keyframes</span> typing {
            <span class="hljs-number">0%</span>, <span class="hljs-number">60%</span>, <span class="hljs-number">100%</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0</span>); }
            <span class="hljs-number">30%</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">4px</span>); }
        }
        
        <span class="hljs-keyword">@keyframes</span> pulse {
            <span class="hljs-number">0%</span>, <span class="hljs-number">100%</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; }
            <span class="hljs-number">50%</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>; }
        }
        
        <span class="hljs-comment">/* ä¼šè¯ç®¡ç† */</span>
        <span class="hljs-selector-class">.session-info</span> {
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">align-items</span>: center;
            <span class="hljs-attribute">gap</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#9ca3af</span>;
            <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">8px</span>;
        }
        
        <span class="hljs-selector-class">.session-id</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0.2</span>);
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">2px</span> <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;
            <span class="hljs-attribute">font-family</span>: monospace;
        }
        
        <span class="hljs-comment">/* å“åº”å¼è®¾è®¡ */</span>
        <span class="hljs-keyword">@media</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">768px</span>) {
            <span class="hljs-selector-class">.main-content</span> {
                <span class="hljs-attribute">flex-direction</span>: column;
                <span class="hljs-attribute">height</span>: auto;
            }
            
            <span class="hljs-selector-class">.status-section</span> {
                <span class="hljs-attribute">height</span>: <span class="hljs-number">300px</span>;
            }
            
            <span class="hljs-selector-tag">body</span> {
                <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
            }
            
            <span class="hljs-selector-class">.message-bubble</span> {
                <span class="hljs-attribute">max-width</span>: <span class="hljs-number">85%</span>;
            }
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"app-container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"header"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ğŸ¤– AIå¤–å–åŠ©æ‰‹<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ™ºèƒ½ç‚¹é¤ï¼Œä¸€å¥è¯å®Œæˆä»é€‰é¤åˆ°æ”¯ä»˜çš„å…¨æµç¨‹<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"session-info"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>ä¼šè¯ID: <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"sessionId"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"session-id"</span>&gt;</span>loading...<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>çŠ¶æ€: <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"connectionStatus"</span>&gt;</span>ğŸŸ¡ è¿æ¥ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"main-content"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- å·¦ä¾§ï¼šå¯¹è¯åŒº --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"chat-section"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"chat-header"</span>&gt;</span>
                    å¯¹è¯è®°å½•
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"messages-container"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"messagesContainer"</span>&gt;</span>
                    <span class="hljs-comment">&lt;!-- æ¶ˆæ¯ä¼šåŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ --&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            
            <span class="hljs-comment">&lt;!-- å³ä¾§ï¼šæ™ºèƒ½ä½“çŠ¶æ€åŒº --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-section"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-header"</span>&gt;</span>
                    æ™ºèƒ½ä½“çŠ¶æ€ä¸æ“ä½œ
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-container"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"statusContainer"</span>&gt;</span>
                    <span class="hljs-comment">&lt;!-- çŠ¶æ€å¡ç‰‡å’Œæ“ä½œé¢„è§ˆä¼šåŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ --&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        
        <span class="hljs-comment">&lt;!-- æ”¯ä»˜é¡µé¢å®¹å™¨ï¼ˆåˆå§‹éšè—ï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"paymentSection"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"payment-container"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display: none;"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"payment-header"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>ğŸ’° æ”¯ä»˜é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"hidePaymentSection()"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background: #ef4444; color: white; padding: 8px 16px;"</span>&gt;</span>å…³é—­<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"paymentFrame"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"payment-frame"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">""</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"æ”¯ä»˜é¡µé¢"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        
        <span class="hljs-comment">&lt;!-- è¾“å…¥åŒº --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-section"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-container"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
                    <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> 
                    <span class="hljs-attr">id</span>=<span class="hljs-string">"userInput"</span> 
                    <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"å‘Šè¯‰æˆ‘ä½ æƒ³åƒä»€ä¹ˆï¼Ÿä¾‹å¦‚ï¼šå¸®æˆ‘ç‚¹ä¸€ä»½éº¦å½“åŠ³å·¨æ— éœ¸å¥—é¤ï¼Œé€åˆ°XXå¤§å¦ï¼Œå¸®æˆ‘åˆ°ä»˜æ¬¾ç•Œé¢"</span>
                    <span class="hljs-attr">autocomplete</span>=<span class="hljs-string">"off"</span>
                &gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"sendButton"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn-send"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"sendMessage()"</span>&gt;</span>å‘é€<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"app.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h2 data-id="heading-7">å››ã€é…å¥—çš„Node.js ExpressæœåŠ¡å™¨ç¤ºä¾‹</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// server.js - ç®€åŒ–çš„æœåŠ¡å™¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">const</span> cors = <span class="hljs-built_in">require</span>(<span class="hljs-string">'cors'</span>);
<span class="hljs-keyword">const</span> { <span class="hljs-attr">v4</span>: uuidv4 } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'uuid'</span>);

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();
app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">cors</span>());
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>());
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">static</span>(<span class="hljs-string">'public'</span>)); <span class="hljs-comment">// é™æ€æ–‡ä»¶æœåŠ¡</span>

<span class="hljs-comment">// å­˜å‚¨ä¼šè¯çŠ¶æ€ï¼ˆç”Ÿäº§ç¯å¢ƒä¸­åº”è¯¥ä½¿ç”¨Redisï¼‰</span>
<span class="hljs-keyword">const</span> sessions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();

<span class="hljs-comment">// åˆ›å»ºæ–°ä¼šè¯</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/agent/session'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> sessionId = <span class="hljs-title function_">uuidv4</span>();
    sessions.<span class="hljs-title function_">set</span>(sessionId, {
        <span class="hljs-attr">created_at</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),
        <span class="hljs-attr">messages</span>: [],
        <span class="hljs-attr">state</span>: {
            <span class="hljs-attr">step</span>: <span class="hljs-string">'initial'</span>,
            <span class="hljs-attr">selected_restaurant</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">cart_id</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">address_id</span>: <span class="hljs-literal">null</span>
        }
    });
    
    res.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">session_id</span>: sessionId });
});

<span class="hljs-comment">// å¤„ç†ç”¨æˆ·æ¶ˆæ¯</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/agent/process'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { session_id, message, context } = req.<span class="hljs-property">body</span>;
    
    <span class="hljs-keyword">if</span> (!sessions.<span class="hljs-title function_">has</span>(session_id)) {
        <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">404</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">error</span>: <span class="hljs-string">'ä¼šè¯ä¸å­˜åœ¨'</span> });
    }
    
    <span class="hljs-comment">// è¿™é‡Œåœ¨å®é™…åº”ç”¨ä¸­åº”è¯¥è§¦å‘æ™ºèƒ½ä½“å¤„ç†æµç¨‹</span>
    <span class="hljs-comment">// æˆ‘ä»¬åªæ˜¯æ¨¡æ‹Ÿä¸€ä¸ªå“åº”</span>
    res.<span class="hljs-title function_">json</span>({ 
        <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, 
        <span class="hljs-attr">message_id</span>: <span class="hljs-title function_">uuidv4</span>() 
    });
});

<span class="hljs-comment">// SSEæµç«¯ç‚¹</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/agent/stream'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> sessionId = req.<span class="hljs-property">query</span>.<span class="hljs-property">session_id</span>;
    
    <span class="hljs-keyword">if</span> (!sessionId) {
        <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">error</span>: <span class="hljs-string">'ç¼ºå°‘ä¼šè¯ID'</span> });
    }
    
    <span class="hljs-comment">// è®¾ç½®SSEå¤´</span>
    res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, {
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'text/event-stream'</span>,
        <span class="hljs-string">'Cache-Control'</span>: <span class="hljs-string">'no-cache'</span>,
        <span class="hljs-string">'Connection'</span>: <span class="hljs-string">'keep-alive'</span>,
        <span class="hljs-string">'Access-Control-Allow-Origin'</span>: <span class="hljs-string">'*'</span>
    });
    
    <span class="hljs-comment">// å‘é€åˆå§‹çŠ¶æ€</span>
    res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`event: status\ndata: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify({ status: <span class="hljs-string">'connected'</span> })}</span>\n\n`</span>);
    
    <span class="hljs-comment">// æ¨¡æ‹Ÿä¸€äº›äº‹ä»¶ï¼ˆå®é™…åº”ç”¨ä¸­è¿™äº›äº‹ä»¶æ¥è‡ªæ™ºèƒ½ä½“å¤„ç†æµç¨‹ï¼‰</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">sendSimulatedEvents</span> = (<span class="hljs-params"/>) =&gt; {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`event: status\ndata: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify({ 
                status: <span class="hljs-string">'thinking'</span>, 
                details: <span class="hljs-string">'æ­£åœ¨åˆ†ææ‚¨çš„éœ€æ±‚...'</span> 
            })}</span>\n\n`</span>);
        }, <span class="hljs-number">1000</span>);
        
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`event: status\ndata: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify({ 
                status: <span class="hljs-string">'querying_menu'</span>, 
                details: <span class="hljs-string">'æŸ¥è¯¢éº¦å½“åŠ³èœå•ä¸­...'</span> 
            })}</span>\n\n`</span>);
        }, <span class="hljs-number">2000</span>);
        
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`event: message\ndata: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify({ 
                content: <span class="hljs-string">'æ‰¾åˆ°"éº¦å½“åŠ³ï¼ˆå›½è´¸åº—ï¼‰"ï¼Œæœ‰å·¨æ— éœ¸å¥—é¤ï¼Œä»·æ ¼38å…ƒã€‚ç¡®è®¤åŠ å…¥è´­ç‰©è½¦å—ï¼Ÿ'</span> 
            })}</span>\n\n`</span>);
        }, <span class="hljs-number">3000</span>);
        
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`event: action_preview\ndata: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify({
                action_id: uuidv4(),
                action: <span class="hljs-string">'add_to_cart'</span>,
                params: {
                    restaurant: <span class="hljs-string">'éº¦å½“åŠ³ï¼ˆå›½è´¸åº—ï¼‰'</span>,
                    items: [
                        { name: <span class="hljs-string">'å·¨æ— éœ¸å¥—é¤'</span>, quantity: <span class="hljs-number">1</span>, price: <span class="hljs-number">38</span> }
                    ],
                    need_confirm: <span class="hljs-literal">true</span>
                }
            })}</span>\n\n`</span>);
        }, <span class="hljs-number">3500</span>);
    };
    
    <span class="hljs-comment">// å¼€å§‹å‘é€æ¨¡æ‹Ÿäº‹ä»¶</span>
    <span class="hljs-title function_">sendSimulatedEvents</span>();
    
    <span class="hljs-comment">// ä¿æŒè¿æ¥</span>
    req.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å®¢æˆ·ç«¯æ–­å¼€è¿æ¥: <span class="hljs-subst">${sessionId}</span>`</span>);
        res.<span class="hljs-title function_">end</span>();
    });
});

<span class="hljs-comment">// ç¡®è®¤æ“ä½œ</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/agent/confirm-action'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { session_id, action_id, user_confirmation } = req.<span class="hljs-property">body</span>;
    
    <span class="hljs-comment">// åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šæ›´æ–°ä¼šè¯çŠ¶æ€å¹¶ç»§ç»­æ™ºèƒ½ä½“æµç¨‹</span>
    res.<span class="hljs-title function_">json</span>({ 
        <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">'æ“ä½œå·²ç¡®è®¤'</span>
    });
});

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PORT</span> = process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> || <span class="hljs-number">3000</span>;
app.<span class="hljs-title function_">listen</span>(<span class="hljs-variable constant_">PORT</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:<span class="hljs-subst">${PORT}</span>`</span>);
});
<span class="hljs-string">``</span><span class="hljs-string">`
</span></code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ— Pythonä¾èµ–ï¼JavaCV+ONNX Runtimeå¿«é€Ÿéƒ¨ç½²YOLOç›®æ ‡æ£€æµ‹]]></title>    <link>https://juejin.cn/post/7599927813601247272</link>    <guid>https://juejin.cn/post/7599927813601247272</guid>    <pubDate>2026-01-28T02:42:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599927813601247272" data-draft-id="7599911091087474688" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" æ— Pythonä¾èµ–ï¼JavaCV+ONNX Runtimeå¿«é€Ÿéƒ¨ç½²YOLOç›®æ ‡æ£€æµ‹"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T02:42:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å¨å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/3411107130652176"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             æ— Pythonä¾èµ–ï¼JavaCV+ONNX Runtimeå¿«é€Ÿéƒ¨ç½²YOLOç›®æ ‡æ£€æµ‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3411107130652176/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å¨å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:42:51.000Z" title="Wed Jan 28 2026 02:42:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ å¸Œæœ›å®Œå…¨æ‘†è„±Pythonç”Ÿæ€ä¾èµ–ï¼ˆæ— éœ€å®‰è£…Pythonã€PyTorch/Ultralyticsã€ONNXè½¬æ¢å·¥å…·ç­‰ï¼‰ï¼Œä»…é€šè¿‡JavaCVï¼ˆçº¯Javaå°è£…çš„OpenCV/FFmpegï¼‰å’ŒONNX Runtime Javaç‰ˆï¼Œå®ç°YOLOç›®æ ‡æ£€æµ‹çš„ç«¯åˆ°ç«¯éƒ¨ç½²â€”â€”ä»å›¾ç‰‡/è§†é¢‘è¯»å–ã€é¢„å¤„ç†ï¼Œåˆ°ONNXæ¨¡å‹æ¨ç†ã€ç»“æœè§£æï¼Œå…¨ç¨‹åŸºäºçº¯Javaç¯å¢ƒå®Œæˆï¼Œè¿™ä¹Ÿæ˜¯ä¼ä¸šçº§ç”Ÿäº§ç¯å¢ƒä¸­â€œè½»é‡éƒ¨ç½²ã€æ— å¤šè¯­è¨€ä¾èµ–â€çš„æ ¸å¿ƒè¯‰æ±‚ã€‚</p>
<p>æœ¬æ–‡æä¾›<strong>é›¶Pythonä¾èµ–</strong>çš„å®Œæ•´å®ç°æ–¹æ¡ˆï¼Œæ‰€æœ‰ä»£ç åŸºäºJDK 11å¼€å‘ï¼Œä»…ä¾èµ–JavaCVå’ŒONNX Runtimeçš„JavaåŸç”Ÿåº“ï¼Œæ”¯æŒCPU/GPUåŠ é€Ÿï¼Œå¯ç›´æ¥æ‰“åŒ…ä¸ºJaråŒ…è¿è¡Œï¼Œé€‚é…Windows/Linux/ARM64ï¼ˆå¦‚Jetson Nanoï¼‰ç­‰å…¨å¹³å°ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€æ ¸å¿ƒæŠ€æœ¯é€‰å‹ï¼ˆæ— Pythonä¾èµ–ï¼‰</h2>

























<table><thead><tr><th>æŠ€æœ¯ç»„ä»¶</th><th>é€‰å‹ä¾æ®ï¼ˆé›¶Pythonæ ¸å¿ƒï¼‰</th></tr></thead><tbody><tr><td>JDK 11+</td><td>çº¯Javaè¿è¡Œç¯å¢ƒï¼Œæ— Pythonä¾èµ–ï¼Œå…¼å®¹æ‰€æœ‰ä¸»æµå¹³å°</td></tr><tr><td>JavaCV 1.5.10</td><td>çº¯Javaå°è£…OpenCV/FFmpegï¼Œæ— éœ€å®‰è£…ç³»ç»Ÿçº§OpenCVï¼Œç›´æ¥é€šè¿‡Mavenå¼•å…¥ï¼Œæ”¯æŒå›¾ç‰‡/è§†é¢‘/æ‘„åƒå¤´æµè¯»å–ã€é¢„å¤„ç†</td></tr><tr><td>ONNX Runtime Java 1.17.0</td><td>å®˜æ–¹Javaç‰ˆæ¨ç†å¼•æ“ï¼Œæ— Pythonç»‘å®šï¼Œç›´æ¥åŠ è½½ONNXæ¨¡å‹å®Œæˆæ¨ç†ï¼Œæ”¯æŒCPU/GPUåŠ é€Ÿ</td></tr><tr><td>YOLOv11n ONNXï¼ˆå®˜æ–¹é¢„ç¼–è¯‘ç‰ˆï¼‰</td><td>ç›´æ¥ä¸‹è½½å®˜æ–¹æä¾›çš„ONNXæ¨¡å‹ï¼Œæ— éœ€Pythonè½¬æ¢ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fultralytics%2Fassets%2Freleases" target="_blank" title="https://github.com/ultralytics/assets/releases" ref="nofollow noopener noreferrer">github.com/ultralyticsâ€¦</a>ï¼‰</td></tr></tbody></table>
<h2 data-id="heading-1">äºŒã€ç¯å¢ƒå‡†å¤‡ï¼ˆé›¶Pythonï¼Œä»…éœ€2æ­¥ï¼‰</h2>
<h3 data-id="heading-2">1. å®‰è£…åŸºç¡€ç¯å¢ƒ</h3>
<p>ä»…éœ€JDKå’ŒMavenï¼Œ<strong>æ— éœ€å®‰è£…Pythonã€CUDAï¼ˆå¯é€‰ï¼‰ã€OpenCV</strong>ï¼š</p>
<ul>
<li>
<p>JDK 11+ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.oracle.com%2Fcn%2Fjava%2Ftechnologies%2Fdownloads%2F%23java11" target="_blank" title="https://www.oracle.com/cn/java/technologies/downloads/#java11" ref="nofollow noopener noreferrer">www.oracle.com/cn/java/tecâ€¦</a></p>
</li>
<li>
<p>Maven 3.8+ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmaven.apache.org%2Fdownload.cgi" target="_blank" title="https://maven.apache.org/download.cgi" ref="nofollow noopener noreferrer">maven.apache.org/download.cgâ€¦</a></p>
</li>
</ul>
<p>éªŒè¯ç¯å¢ƒï¼ˆæ— Pythonç›¸å…³æ“ä½œï¼‰ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash">
java -version  <span class="hljs-comment"># è¾“å‡ºJDKç‰ˆæœ¬å³å¯</span>
mvn -v         <span class="hljs-comment"># è¾“å‡ºMavenç‰ˆæœ¬å³å¯</span>
</code></pre>
<h3 data-id="heading-3">2. ä¸‹è½½YOLO ONNXæ¨¡å‹ï¼ˆæ— Pythonè½¬æ¢ï¼‰</h3>
<p>ç›´æ¥ä¸‹è½½å®˜æ–¹é¢„ç¼–è¯‘çš„YOLOv11n ONNXæ¨¡å‹ï¼Œè·³è¿‡Pythonè½¬æ¢æ­¥éª¤ï¼š</p>
<ul>
<li>
<p>ä¸‹è½½åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fultralytics%2Fassets%2Freleases%2Fdownload%2Fv8.2.0%2Fyolov11n.onnx" target="_blank" title="https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov11n.onnx" ref="nofollow noopener noreferrer">github.com/ultralyticsâ€¦</a></p>
</li>
<li>
<p>ä¿å­˜è·¯å¾„ï¼š<code>src/main/resources/models/yolov11n.onnx</code></p>
</li>
</ul>
<h2 data-id="heading-4">ä¸‰ã€çº¯Javaå®ç°ï¼ˆé›¶Pythonä¾èµ–ï¼‰</h2>
<h3 data-id="heading-5">1. é¡¹ç›®ç»“æ„ï¼ˆæç®€ï¼‰</h3>
<pre><code class="hljs language-Plain" lang="Plain">
yolo-java-nopython/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â”‚   â””â”€â”€ com/
â”‚   â”‚   â”‚       â””â”€â”€ yolo/
â”‚   â”‚   â”‚           â”œâ”€â”€ config/      # YOLOé…ç½®
â”‚   â”‚   â”‚           â”œâ”€â”€ inference/   # æ¨ç†æ ¸å¿ƒ
â”‚   â”‚   â”‚           â”œâ”€â”€ util/        # å›¾åƒå¤„ç†å·¥å…·ï¼ˆJavaCVï¼‰
â”‚   â”‚   â”‚           â””â”€â”€ YoloDetectorApp.java  # æµ‹è¯•ä¸»ç±»
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â””â”€â”€ models/
â”‚   â”‚           â””â”€â”€ yolov11n.onnx   # å®˜æ–¹ONNXæ¨¡å‹
â”‚   â””â”€â”€ test/
â””â”€â”€ pom.xml  # ä»…Javaä¾èµ–ï¼Œæ— Pythonç›¸å…³
</code></pre>
<h3 data-id="heading-6">2. æ ¸å¿ƒä¾èµ–ï¼ˆpom.xmlï¼‰</h3>
<p>ä»…å¼•å…¥JavaCVå’ŒONNX Runtimeçš„JavaåŸç”Ÿåº“ï¼Œ<strong>æ— ä»»ä½•Pythonä¾èµ–</strong>ï¼š</p>
<pre><code class="hljs language-XML" lang="XML">
<span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span>
         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.yolo<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>yolo-java-nopython<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>11<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>11<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">javacv.version</span>&gt;</span>1.5.10<span class="hljs-tag">&lt;/<span class="hljs-name">javacv.version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">onnxruntime.version</span>&gt;</span>1.17.0<span class="hljs-tag">&lt;/<span class="hljs-name">onnxruntime.version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- JavaCVæ ¸å¿ƒï¼ˆçº¯Javaï¼Œè‡ªåŠ¨å¼•å…¥å¯¹åº”å¹³å°åŸç”Ÿåº“ï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.bytedeco<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>javacv<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${javacv.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- OpenCV Javaç»‘å®šï¼ˆJavaCVå°è£…ï¼Œæ— ç³»ç»Ÿä¾èµ–ï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.bytedeco<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>opencv-platform<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.8.0-${javacv.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- FFmpeg Javaç»‘å®šï¼ˆè§†é¢‘/æ‘„åƒå¤´è¯»å–ï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.bytedeco<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>ffmpeg-platform<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>6.1.1-${javacv.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- ONNX Runtime Javaç‰ˆï¼ˆæ— Pythonä¾èµ–ï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.microsoft.onnxruntime<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>onnxruntime<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${onnxruntime.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- å·¥å…·ç±»ï¼ˆå¯é€‰ï¼Œç®€åŒ–æ—¥å¿—/é…ç½®ï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.18.30<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-simple<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.9<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- æ‰“åŒ…ä¸ºå¯æ‰§è¡ŒJarï¼ˆåŒ…å«æ‰€æœ‰ä¾èµ–ï¼Œé›¶ç¯å¢ƒä¾èµ–è¿è¡Œï¼‰ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-assembly-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.6.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">archive</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">manifest</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">mainClass</span>&gt;</span>com.yolo.YoloDetectorApp<span class="hljs-tag">&lt;/<span class="hljs-name">mainClass</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">manifest</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">archive</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">descriptorRefs</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">descriptorRef</span>&gt;</span>jar-with-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">descriptorRef</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">descriptorRefs</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">executions</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">execution</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>make-assembly<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">phase</span>&gt;</span>package<span class="hljs-tag">&lt;/<span class="hljs-name">phase</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">goals</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">goal</span>&gt;</span>single<span class="hljs-tag">&lt;/<span class="hljs-name">goal</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">goals</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">execution</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">executions</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span>
</code></pre>
<h3 data-id="heading-7">3. æ ¸å¿ƒä»£ç å®ç°ï¼ˆå…¨Javaï¼Œæ— Pythonï¼‰</h3>
<h4 data-id="heading-8">ï¼ˆ1ï¼‰YOLOé…ç½®ç±»ï¼ˆç¡¬ç¼–ç /é…ç½®æ–‡ä»¶å‡å¯ï¼‰</h4>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-keyword">package</span> com.yolo.config;

<span class="hljs-keyword">import</span> lombok.Getter;

<span class="hljs-comment">/**
 * YOLOé…ç½®ï¼ˆæ— Pythonä¾èµ–ï¼Œç›´æ¥ç¡¬ç¼–ç ï¼Œä¹Ÿå¯è¯»å–propertiesï¼‰
 */</span>
<span class="hljs-meta">@Getter</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YoloConfig</span> {
    <span class="hljs-comment">// æ¨¡å‹è·¯å¾„ï¼ˆresourcesç›®å½•ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">MODEL_PATH</span> <span class="hljs-operator">=</span> <span class="hljs-string">"models/yolov11n.onnx"</span>;
    <span class="hljs-comment">// è¾“å…¥å°ºå¯¸ï¼ˆYOLOv11é»˜è®¤640Ã—640ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INPUT_WIDTH</span> <span class="hljs-operator">=</span> <span class="hljs-number">640</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INPUT_HEIGHT</span> <span class="hljs-operator">=</span> <span class="hljs-number">640</span>;
    <span class="hljs-comment">// ç½®ä¿¡åº¦é˜ˆå€¼ï¼ˆè¿‡æ»¤ä½ç½®ä¿¡åº¦ç»“æœï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">float</span> <span class="hljs-variable">CONF_THRESHOLD</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.4f</span>;
    <span class="hljs-comment">// COCO80ç±»åˆ«ï¼ˆYOLOé»˜è®¤ï¼Œæ— Pythonä¾èµ–ï¼Œç›´æ¥å®šä¹‰ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String[] CLASSES = {
            <span class="hljs-string">"person"</span>, <span class="hljs-string">"bicycle"</span>, <span class="hljs-string">"car"</span>, <span class="hljs-string">"motorcycle"</span>, <span class="hljs-string">"airplane"</span>, <span class="hljs-string">"bus"</span>, <span class="hljs-string">"train"</span>, <span class="hljs-string">"truck"</span>, <span class="hljs-string">"boat"</span>,
            <span class="hljs-string">"traffic light"</span>, <span class="hljs-string">"fire hydrant"</span>, <span class="hljs-string">"stop sign"</span>, <span class="hljs-string">"parking meter"</span>, <span class="hljs-string">"bench"</span>, <span class="hljs-string">"bird"</span>, <span class="hljs-string">"cat"</span>,
            <span class="hljs-string">"dog"</span>, <span class="hljs-string">"horse"</span>, <span class="hljs-string">"sheep"</span>, <span class="hljs-string">"cow"</span>, <span class="hljs-string">"elephant"</span>, <span class="hljs-string">"bear"</span>, <span class="hljs-string">"zebra"</span>, <span class="hljs-string">"giraffe"</span>, <span class="hljs-string">"backpack"</span>,
            <span class="hljs-string">"umbrella"</span>, <span class="hljs-string">"handbag"</span>, <span class="hljs-string">"tie"</span>, <span class="hljs-string">"suitcase"</span>, <span class="hljs-string">"frisbee"</span>, <span class="hljs-string">"skis"</span>, <span class="hljs-string">"snowboard"</span>, <span class="hljs-string">"sports ball"</span>,
            <span class="hljs-string">"kite"</span>, <span class="hljs-string">"baseball bat"</span>, <span class="hljs-string">"baseball glove"</span>, <span class="hljs-string">"skateboard"</span>, <span class="hljs-string">"surfboard"</span>, <span class="hljs-string">"tennis racket"</span>,
            <span class="hljs-string">"bottle"</span>, <span class="hljs-string">"wine glass"</span>, <span class="hljs-string">"cup"</span>, <span class="hljs-string">"fork"</span>, <span class="hljs-string">"knife"</span>, <span class="hljs-string">"spoon"</span>, <span class="hljs-string">"bowl"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"apple"</span>,
            <span class="hljs-string">"sandwich"</span>, <span class="hljs-string">"orange"</span>, <span class="hljs-string">"broccoli"</span>, <span class="hljs-string">"carrot"</span>, <span class="hljs-string">"hot dog"</span>, <span class="hljs-string">"pizza"</span>, <span class="hljs-string">"donut"</span>, <span class="hljs-string">"cake"</span>, <span class="hljs-string">"chair"</span>,
            <span class="hljs-string">"couch"</span>, <span class="hljs-string">"potted plant"</span>, <span class="hljs-string">"bed"</span>, <span class="hljs-string">"dining table"</span>, <span class="hljs-string">"toilet"</span>, <span class="hljs-string">"tv"</span>, <span class="hljs-string">"laptop"</span>, <span class="hljs-string">"mouse"</span>,
            <span class="hljs-string">"remote"</span>, <span class="hljs-string">"keyboard"</span>, <span class="hljs-string">"cell phone"</span>, <span class="hljs-string">"microwave"</span>, <span class="hljs-string">"oven"</span>, <span class="hljs-string">"toaster"</span>, <span class="hljs-string">"sink"</span>, <span class="hljs-string">"refrigerator"</span>,
            <span class="hljs-string">"book"</span>, <span class="hljs-string">"clock"</span>, <span class="hljs-string">"vase"</span>, <span class="hljs-string">"scissors"</span>, <span class="hljs-string">"teddy bear"</span>, <span class="hljs-string">"hair drier"</span>, <span class="hljs-string">"toothbrush"</span>
    };
}
</code></pre>
<h4 data-id="heading-9">ï¼ˆ2ï¼‰å›¾åƒå¤„ç†å·¥å…·ç±»ï¼ˆJavaCVå®ç°ï¼Œæ— Pythonï¼‰</h4>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-keyword">package</span> com.yolo.util;

<span class="hljs-keyword">import</span> com.yolo.config.YoloConfig;
<span class="hljs-keyword">import</span> org.bytedeco.opencv.opencv_core.*;

<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.bytedeco.opencv.global.opencv_core.*;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.bytedeco.opencv.global.opencv_imgproc.*;

<span class="hljs-comment">/**
 * å›¾åƒå¤„ç†å·¥å…·ï¼ˆçº¯JavaCVå®ç°ï¼Œæ— Pythonä¾èµ–ï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ImageProcessUtils</span> {

    <span class="hljs-comment">/**
     * å›¾ç‰‡é¢„å¤„ç†ï¼šLetterBoxå¡«å…… + BGRè½¬RGB + å½’ä¸€åŒ– + HWCâ†’CHW
     * <span class="hljs-doctag">@param</span> srcImg åŸå§‹å›¾ç‰‡ï¼ˆJavaCVçš„Matå¯¹è±¡ï¼‰
     * <span class="hljs-doctag">@return</span> æ¨¡å‹è¾“å…¥å¼ é‡ï¼ˆfloatæ•°ç»„ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">float</span>[] preprocess(Mat srcImg) {
        <span class="hljs-comment">// 1. LetterBoxå¡«å……ï¼ˆä¿æŒå®½é«˜æ¯”ï¼Œé¿å…å˜å½¢ï¼‰</span>
        <span class="hljs-type">Mat</span> <span class="hljs-variable">letterBoxImg</span> <span class="hljs-operator">=</span> letterBox(srcImg, YoloConfig.INPUT_WIDTH, YoloConfig.INPUT_HEIGHT);
        <span class="hljs-comment">// 2. BGRè½¬RGBï¼ˆJavaCV/OpenCVé»˜è®¤BGRï¼ŒYOLOè¾“å…¥RGBï¼‰</span>
        <span class="hljs-type">Mat</span> <span class="hljs-variable">rgbImg</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Mat</span>();
        cvtColor(letterBoxImg, rgbImg, COLOR_BGR2RGB);
        <span class="hljs-comment">// 3. å½’ä¸€åŒ–ï¼ˆ0-255 â†’ 0-1ï¼‰</span>
        rgbImg.convertTo(rgbImg, CV_32F, <span class="hljs-number">1.0</span> / <span class="hljs-number">255.0</span>);
        <span class="hljs-comment">// 4. HWCï¼ˆé«˜åº¦Ã—å®½åº¦Ã—é€šé“ï¼‰â†’ CHWï¼ˆé€šé“Ã—é«˜åº¦Ã—å®½åº¦ï¼‰ï¼ˆYOLOè¾“å…¥æ ¼å¼ï¼‰</span>
        <span class="hljs-type">float</span>[] inputData = hwc2chw(rgbImg);

        <span class="hljs-comment">// é‡Šæ”¾å†…å­˜ï¼ˆé¿å…æ³„æ¼ï¼‰</span>
        letterBoxImg.release();
        rgbImg.release();
        <span class="hljs-keyword">return</span> inputData;
    }

    <span class="hljs-comment">/**
     * LetterBoxå¡«å……ï¼ˆä¿æŒå®½é«˜æ¯”ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Mat <span class="hljs-title function_">letterBox</span><span class="hljs-params">(Mat srcImg, <span class="hljs-type">int</span> targetW, <span class="hljs-type">int</span> targetH)</span> {
        <span class="hljs-type">double</span> <span class="hljs-variable">scale</span> <span class="hljs-operator">=</span> Math.min((<span class="hljs-type">double</span>) targetW / srcImg.cols(), (<span class="hljs-type">double</span>) targetH / srcImg.rows());
        <span class="hljs-type">int</span> <span class="hljs-variable">newW</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) (srcImg.cols() * scale);
        <span class="hljs-type">int</span> <span class="hljs-variable">newH</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) (srcImg.rows() * scale);

        <span class="hljs-comment">// ç¼©æ”¾å›¾ç‰‡</span>
        <span class="hljs-type">Mat</span> <span class="hljs-variable">resized</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Mat</span>();
        resize(srcImg, resized, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Size</span>(newW, newH), <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, INTER_LINEAR);

        <span class="hljs-comment">// è®¡ç®—å¡«å……å€¼</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">padTop</span> <span class="hljs-operator">=</span> (targetH - newH) / <span class="hljs-number">2</span>;
        <span class="hljs-type">int</span> <span class="hljs-variable">padBottom</span> <span class="hljs-operator">=</span> targetH - newH - padTop;
        <span class="hljs-type">int</span> <span class="hljs-variable">padLeft</span> <span class="hljs-operator">=</span> (targetW - newW) / <span class="hljs-number">2</span>;
        <span class="hljs-type">int</span> <span class="hljs-variable">padRight</span> <span class="hljs-operator">=</span> targetW - newW - padLeft;

        <span class="hljs-comment">// å¡«å……é»‘è¾¹</span>
        <span class="hljs-type">Mat</span> <span class="hljs-variable">letterBoxImg</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Mat</span>();
        copyMakeBorder(resized, letterBoxImg, padTop, padBottom, padLeft, padRight, BORDER_CONSTANT, Scalar.ZERO);
        resized.release();
        <span class="hljs-keyword">return</span> letterBoxImg;
    }

    <span class="hljs-comment">/**
     * HWCâ†’CHWæ ¼å¼è½¬æ¢
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">float</span>[] hwc2chw(Mat rgbImg) {
        <span class="hljs-type">int</span> <span class="hljs-variable">channels</span> <span class="hljs-operator">=</span> rgbImg.channels();
        <span class="hljs-type">int</span> <span class="hljs-variable">height</span> <span class="hljs-operator">=</span> rgbImg.rows();
        <span class="hljs-type">int</span> <span class="hljs-variable">width</span> <span class="hljs-operator">=</span> rgbImg.cols();

        <span class="hljs-type">float</span>[] chwData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">float</span>[channels * height * width];
        <span class="hljs-type">float</span>[] hwcData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">float</span>[height * width * channels];
        rgbImg.get(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, hwcData);

        <span class="hljs-comment">// è½¬æ¢ï¼šHWC â†’ CHW</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; c &lt; channels; c++) {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; h &lt; height; h++) {
                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; w &lt; width; w++) {
                    <span class="hljs-type">int</span> <span class="hljs-variable">hwcIdx</span> <span class="hljs-operator">=</span> h * width * channels + w * channels + c;
                    <span class="hljs-type">int</span> <span class="hljs-variable">chwIdx</span> <span class="hljs-operator">=</span> c * height * width + h * width + w;
                    chwData[chwIdx] = hwcData[hwcIdx];
                }
            }
        }
        <span class="hljs-keyword">return</span> chwData;
    }

    <span class="hljs-comment">/**
     * æ¨ç†ç»“æœåå¤„ç†ï¼šè§£æONNXè¾“å‡ºï¼Œè¿˜åŸåæ ‡åˆ°åŸå§‹å›¾ç‰‡
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Mat <span class="hljs-title function_">postprocess</span><span class="hljs-params">(Mat srcImg, <span class="hljs-type">float</span>[][] output)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">srcW</span> <span class="hljs-operator">=</span> srcImg.cols();
        <span class="hljs-type">int</span> <span class="hljs-variable">srcH</span> <span class="hljs-operator">=</span> srcImg.rows();
        <span class="hljs-type">double</span> <span class="hljs-variable">scale</span> <span class="hljs-operator">=</span> Math.min((<span class="hljs-type">double</span>) YoloConfig.INPUT_WIDTH / srcW, (<span class="hljs-type">double</span>) YoloConfig.INPUT_HEIGHT / srcH);
        <span class="hljs-type">float</span> <span class="hljs-variable">padW</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>) ((YoloConfig.INPUT_WIDTH - srcW * scale) / <span class="hljs-number">2</span>);
        <span class="hljs-type">float</span> <span class="hljs-variable">padH</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>) ((YoloConfig.INPUT_HEIGHT - srcH * scale) / <span class="hljs-number">2</span>);

        <span class="hljs-comment">// éå†æ‰€æœ‰é¢„æµ‹æ¡†ï¼ˆ8400ä¸ªï¼‰</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8400</span>; i++) {
            <span class="hljs-type">float</span>[] box = output[i];
            <span class="hljs-comment">// æ‰¾åˆ°æœ€å¤§ç½®ä¿¡åº¦çš„ç±»åˆ«</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">maxClassIdx</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-type">float</span> <span class="hljs-variable">maxConf</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">4</span>; j &lt; box.length; j++) {
                <span class="hljs-keyword">if</span> (box[j] &gt; maxConf) {
                    maxConf = box[j];
                    maxClassIdx = j - <span class="hljs-number">4</span>;
                }
            }

            <span class="hljs-comment">// ç½®ä¿¡åº¦è¿‡æ»¤</span>
            <span class="hljs-keyword">if</span> (maxConf &lt; YoloConfig.CONF_THRESHOLD) <span class="hljs-keyword">continue</span>;

            <span class="hljs-comment">// è¿˜åŸåæ ‡åˆ°åŸå§‹å›¾ç‰‡</span>
            <span class="hljs-type">float</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> (box[<span class="hljs-number">0</span>] - padW) / scale;
            <span class="hljs-type">float</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> (box[<span class="hljs-number">1</span>] - padH) / scale;
            <span class="hljs-type">float</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> box[<span class="hljs-number">2</span>] / scale;
            <span class="hljs-type">float</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> box[<span class="hljs-number">3</span>] / scale;

            <span class="hljs-comment">// è®¡ç®—æ£€æµ‹æ¡†å·¦ä¸Šè§’/å³ä¸‹è§’åæ ‡</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) Math.max(<span class="hljs-number">0</span>, x - w / <span class="hljs-number">2</span>);
            <span class="hljs-type">int</span> <span class="hljs-variable">top</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) Math.max(<span class="hljs-number">0</span>, y - h / <span class="hljs-number">2</span>);
            <span class="hljs-type">int</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) Math.min(srcW, x + w / <span class="hljs-number">2</span>);
            <span class="hljs-type">int</span> <span class="hljs-variable">bottom</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) Math.min(srcH, y + h / <span class="hljs-number">2</span>);

            <span class="hljs-comment">// ç»˜åˆ¶æ£€æµ‹æ¡†å’Œæ ‡ç­¾ï¼ˆJavaCV/OpenCVå®ç°ï¼‰</span>
            rectangle(srcImg, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Point</span>(left, top), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Point</span>(right, bottom), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scalar</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>), <span class="hljs-number">2</span>);
            <span class="hljs-type">String</span> <span class="hljs-variable">label</span> <span class="hljs-operator">=</span> YoloConfig.CLASSES[maxClassIdx] + <span class="hljs-string">" "</span> + String.format(<span class="hljs-string">"%.2f"</span>, maxConf);
            putText(srcImg, label, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Point</span>(left, top - <span class="hljs-number">5</span>), FONT_HERSHEY_SIMPLEX, <span class="hljs-number">0.5</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scalar</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>), <span class="hljs-number">1</span>);
        }
        <span class="hljs-keyword">return</span> srcImg;
    }
}
</code></pre>
<h4 data-id="heading-10">ï¼ˆ3ï¼‰YOLOæ¨ç†æ ¸å¿ƒï¼ˆONNX Runtime Javaç‰ˆï¼‰</h4>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-keyword">package</span> com.yolo.inference;

<span class="hljs-keyword">import</span> ai.onnxruntime.*;
<span class="hljs-keyword">import</span> com.yolo.config.YoloConfig;
<span class="hljs-keyword">import</span> com.yolo.util.ImageProcessUtils;
<span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span> org.bytedeco.opencv.opencv_core.Mat;

<span class="hljs-keyword">import</span> java.io.File;
<span class="hljs-keyword">import</span> java.nio.file.Paths;
<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.Map;
<span class="hljs-keyword">import</span> java.util.concurrent.locks.ReentrantLock;

<span class="hljs-comment">/**
 * YOLOæ¨ç†æ ¸å¿ƒï¼ˆçº¯Javaï¼Œæ— Pythonä¾èµ–ï¼‰
 */</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YoloInferenceEngine</span> {
    <span class="hljs-comment">// ONNX Runtimeæ ¸å¿ƒå¯¹è±¡</span>
    <span class="hljs-keyword">private</span> OrtEnvironment env;
    <span class="hljs-keyword">private</span> OrtSession session;
    <span class="hljs-comment">// å¹¶å‘é”ï¼ˆä¿è¯çº¿ç¨‹å®‰å…¨ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-comment">// æ¨¡å‹è¾“å…¥åç§°ï¼ˆYOLOv11é»˜è®¤"images"ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">INPUT_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"images"</span>;

    <span class="hljs-comment">/**
     * åˆå§‹åŒ–ONNXæ¨¡å‹ï¼ˆæ— Pythonä¾èµ–ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initModel</span><span class="hljs-params">()</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è·å–æ¨¡å‹ç»å¯¹è·¯å¾„ï¼ˆå…¼å®¹JaråŒ…å†…/å¤–è·¯å¾„ï¼‰</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">modelPath</span> <span class="hljs-operator">=</span> Paths.get(
                    <span class="hljs-built_in">this</span>.getClass().getClassLoader().getResource(YoloConfig.MODEL_PATH).toURI()
            ).toString();
            log.info(<span class="hljs-string">"åŠ è½½YOLO ONNXæ¨¡å‹ï¼š{}"</span>, modelPath);

            <span class="hljs-comment">// åˆå§‹åŒ–ONNXç¯å¢ƒ</span>
            env = OrtEnvironment.getEnvironment();
            OrtSession.<span class="hljs-type">SessionOptions</span> <span class="hljs-variable">sessionOptions</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrtSession</span>.SessionOptions();
            <span class="hljs-comment">// ä¼˜åŒ–é…ç½®ï¼šå¯ç”¨æ‰€æœ‰ä¼˜åŒ–ï¼Œè®¾ç½®æ¨ç†çº¿ç¨‹æ•°ï¼ˆæ ¹æ®CPUæ ¸å¿ƒè°ƒæ•´ï¼‰</span>
            sessionOptions.setOptimizationLevel(OrtSession.SessionOptions.OptLevel.ALL);
            sessionOptions.setIntraOpNumThreads(Runtime.getRuntime().availableProcessors() / <span class="hljs-number">2</span>);

            <span class="hljs-comment">// åŠ è½½æ¨¡å‹ï¼ˆçº¯Javaï¼Œæ— Pythonï¼‰</span>
            session = env.createSession(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(modelPath).getAbsolutePath(), sessionOptions);
            log.info(<span class="hljs-string">"YOLOæ¨¡å‹åŠ è½½æˆåŠŸï¼"</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"æ¨¡å‹åŠ è½½å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"YOLOæ¨¡å‹åˆå§‹åŒ–å¤±è´¥"</span>, e);
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }

    <span class="hljs-comment">/**
     * å•å›¾ç‰‡æ¨ç†ï¼ˆçº¯Javaï¼Œè¿”å›ç»˜åˆ¶æ£€æµ‹æ¡†åçš„å›¾ç‰‡ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> Mat <span class="hljs-title function_">inferImage</span><span class="hljs-params">(Mat srcImg)</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. é¢„å¤„ç†ï¼ˆJavaCVå®ç°ï¼‰</span>
            <span class="hljs-type">long</span> <span class="hljs-variable">preStart</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
            <span class="hljs-type">float</span>[] inputData = ImageProcessUtils.preprocess(srcImg);
            log.debug(<span class="hljs-string">"é¢„å¤„ç†è€—æ—¶ï¼š{}ms"</span>, System.currentTimeMillis() - preStart);

            <span class="hljs-comment">// 2. æ„é€ ONNXè¾“å…¥å¼ é‡</span>
            <span class="hljs-type">long</span>[] inputShape = <span class="hljs-keyword">new</span> <span class="hljs-title class_">long</span>[]{<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, YoloConfig.INPUT_HEIGHT, YoloConfig.INPUT_WIDTH};
            OrtSession.<span class="hljs-type">InputTensor</span> <span class="hljs-variable">inputTensor</span> <span class="hljs-operator">=</span> OrtSession.InputTensor.createTensor(env, inputData, inputShape);
            Map&lt;String, OrtSession.InputTensor&gt; inputs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
            inputs.put(INPUT_NAME, inputTensor);

            <span class="hljs-comment">// 3. æ¨¡å‹æ¨ç†ï¼ˆONNX Runtime Javaï¼‰</span>
            <span class="hljs-type">long</span> <span class="hljs-variable">inferStart</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
            OrtSession.<span class="hljs-type">Result</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> session.run(inputs);
            log.debug(<span class="hljs-string">"æ¨ç†è€—æ—¶ï¼š{}ms"</span>, System.currentTimeMillis() - inferStart);

            <span class="hljs-comment">// 4. è§£æè¾“å‡ºï¼ˆYOLOv11è¾“å‡ºæ ¼å¼ï¼š[1,84,8400] â†’ è½¬æ¢ä¸º[8400,84]ï¼‰</span>
            <span class="hljs-type">float</span>[][] output = parseOutput(result);

            <span class="hljs-comment">// 5. åå¤„ç†ï¼šç»˜åˆ¶æ£€æµ‹æ¡†ï¼ˆJavaCV/OpenCVï¼‰</span>
            <span class="hljs-type">Mat</span> <span class="hljs-variable">resultImg</span> <span class="hljs-operator">=</span> ImageProcessUtils.postprocess(srcImg, output);

            <span class="hljs-comment">// é‡Šæ”¾èµ„æº</span>
            inputTensor.close();
            result.close();
            <span class="hljs-keyword">return</span> resultImg;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å›¾ç‰‡æ¨ç†å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æ¨ç†å¤±è´¥"</span>, e);
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }

    <span class="hljs-comment">/**
     * è§£æONNXè¾“å‡ºå¼ é‡
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span>[][] parseOutput(OrtSession.Result result) <span class="hljs-keyword">throws</span> OrtException {
        <span class="hljs-comment">// YOLOv11è¾“å‡ºï¼šç»´åº¦ä¸º[1,84,8400]çš„floatæ•°ç»„</span>
        <span class="hljs-type">float</span>[][] rawOutput = (<span class="hljs-type">float</span>[][]) result.get(<span class="hljs-number">0</span>).getValue();
        <span class="hljs-comment">// è½¬æ¢ä¸º[8400,84]æ ¼å¼ï¼ˆä¾¿äºéå†ï¼‰</span>
        <span class="hljs-type">float</span>[][] output = <span class="hljs-keyword">new</span> <span class="hljs-title class_">float</span>[<span class="hljs-number">8400</span>][<span class="hljs-number">84</span>];
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8400</span>; i++) {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">84</span>; j++) {
                output[i][j] = rawOutput[j][i];
            }
        }
        <span class="hljs-keyword">return</span> output;
    }

    <span class="hljs-comment">/**
     * é‡Šæ”¾èµ„æº
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
                session.close();
            }
            log.info(<span class="hljs-string">"YOLOæ¨¡å‹èµ„æºå·²é‡Šæ”¾"</span>);
        } <span class="hljs-keyword">catch</span> (OrtException e) {
            log.error(<span class="hljs-string">"èµ„æºé‡Šæ”¾å¤±è´¥"</span>, e);
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
}
</code></pre>
<h4 data-id="heading-11">ï¼ˆ4ï¼‰æµ‹è¯•ä¸»ç±»ï¼ˆå›¾ç‰‡/è§†é¢‘/æ‘„åƒå¤´æ£€æµ‹ï¼Œæ— Pythonï¼‰</h4>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-keyword">package</span> com.yolo;

<span class="hljs-keyword">import</span> com.yolo.inference.YoloInferenceEngine;
<span class="hljs-keyword">import</span> org.bytedeco.javacv.*;
<span class="hljs-keyword">import</span> org.bytedeco.opencv.opencv_core.Mat;

<span class="hljs-keyword">import</span> java.io.File;

<span class="hljs-comment">/**
 * æµ‹è¯•ä¸»ç±»ï¼ˆçº¯Javaï¼Œæ— Pythonä¾èµ–ï¼Œç›´æ¥è¿è¡Œï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YoloDetectorApp</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">YoloInferenceEngine</span> <span class="hljs-variable">inferenceEngine</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">YoloInferenceEngine</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// 1. åˆå§‹åŒ–æ¨¡å‹ï¼ˆæ— Pythonï¼‰</span>
        inferenceEngine.initModel();

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ========== æµ‹è¯•1ï¼šå•å›¾ç‰‡æ£€æµ‹ ==========</span>
            detectImage(<span class="hljs-string">"test.jpg"</span>, <span class="hljs-string">"result.jpg"</span>);

            <span class="hljs-comment">// ========== æµ‹è¯•2ï¼šè§†é¢‘æ£€æµ‹ï¼ˆå¯é€‰ï¼‰ ==========</span>
            <span class="hljs-comment">// detectVideo("test.mp4", "result.mp4");</span>

            <span class="hljs-comment">// ========== æµ‹è¯•3ï¼šæ‘„åƒå¤´å®æ—¶æ£€æµ‹ï¼ˆå¯é€‰ï¼‰ ==========</span>
            <span class="hljs-comment">// detectCamera();</span>
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// é‡Šæ”¾èµ„æº</span>
            inferenceEngine.destroy();
        }
    }

    <span class="hljs-comment">/**
     * å•å›¾ç‰‡æ£€æµ‹ï¼ˆçº¯JavaCVå®ç°ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">detectImage</span><span class="hljs-params">(String inputPath, String outputPath)</span> {
        <span class="hljs-comment">// è¯»å–å›¾ç‰‡ï¼ˆJavaCVï¼Œæ— Pythonï¼‰</span>
        OpenCVFrameConverter.<span class="hljs-type">ToMat</span> <span class="hljs-variable">converter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenCVFrameConverter</span>.ToMat();
        <span class="hljs-type">Mat</span> <span class="hljs-variable">srcImg</span> <span class="hljs-operator">=</span> imread(inputPath);
        <span class="hljs-keyword">if</span> (srcImg.empty()) {
            System.err.println(<span class="hljs-string">"å›¾ç‰‡è¯»å–å¤±è´¥ï¼š"</span> + inputPath);
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-comment">// æ¨ç†</span>
        <span class="hljs-type">Mat</span> <span class="hljs-variable">resultImg</span> <span class="hljs-operator">=</span> inferenceEngine.inferImage(srcImg);

        <span class="hljs-comment">// ä¿å­˜ç»“æœå›¾ç‰‡ï¼ˆJavaCVï¼‰</span>
        imwrite(outputPath, resultImg);
        System.out.println(<span class="hljs-string">"å›¾ç‰‡æ£€æµ‹å®Œæˆï¼Œç»“æœä¿å­˜è‡³ï¼š"</span> + <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(outputPath).getAbsolutePath());

        <span class="hljs-comment">// é‡Šæ”¾èµ„æº</span>
        srcImg.release();
        resultImg.release();
    }

    <span class="hljs-comment">/**
     * è§†é¢‘æ£€æµ‹ï¼ˆçº¯JavaCVå®ç°ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">detectVideo</span><span class="hljs-params">(String inputPath, String outputPath)</span> {
        <span class="hljs-type">FFmpegFrameGrabber</span> <span class="hljs-variable">grabber</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FFmpegFrameGrabber</span>(inputPath);
        <span class="hljs-type">FFmpegFrameRecorder</span> <span class="hljs-variable">recorder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FFmpegFrameRecorder</span>(outputPath, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        OpenCVFrameConverter.<span class="hljs-type">ToMat</span> <span class="hljs-variable">converter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenCVFrameConverter</span>.ToMat();

        <span class="hljs-keyword">try</span> {
            grabber.start();
            <span class="hljs-comment">// é…ç½®å½•åˆ¶å™¨</span>
            recorder.setVideoCodec(grabber.getVideoCodec());
            recorder.setFormat(grabber.getFormat());
            recorder.setFrameRate(grabber.getFrameRate());
            recorder.setImageWidth(grabber.getImageWidth());
            recorder.setImageHeight(grabber.getImageHeight());
            recorder.start();

            Frame frame;
            <span class="hljs-keyword">while</span> ((frame = grabber.grabImage()) != <span class="hljs-literal">null</span>) {
                <span class="hljs-type">Mat</span> <span class="hljs-variable">srcImg</span> <span class="hljs-operator">=</span> converter.convert(frame);
                <span class="hljs-type">Mat</span> <span class="hljs-variable">resultImg</span> <span class="hljs-operator">=</span> inferenceEngine.inferImage(srcImg);
                recorder.record(converter.convert(resultImg));
                srcImg.release();
                resultImg.release();
            }

            recorder.stop();
            grabber.stop();
            System.out.println(<span class="hljs-string">"è§†é¢‘æ£€æµ‹å®Œæˆï¼Œç»“æœä¿å­˜è‡³ï¼š"</span> + outputPath);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }

    <span class="hljs-comment">/**
     * æ‘„åƒå¤´å®æ—¶æ£€æµ‹ï¼ˆçº¯JavaCVå®ç°ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">detectCamera</span><span class="hljs-params">()</span> {
        <span class="hljs-type">OpenCVFrameGrabber</span> <span class="hljs-variable">grabber</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenCVFrameGrabber</span>(<span class="hljs-number">0</span>); <span class="hljs-comment">// 0=é»˜è®¤æ‘„åƒå¤´</span>
        <span class="hljs-type">CanvasFrame</span> <span class="hljs-variable">canvas</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CanvasFrame</span>(<span class="hljs-string">"YOLOå®æ—¶æ£€æµ‹ï¼ˆæ— Pythonï¼‰"</span>, CanvasFrame.getDefaultGamma() / grabber.getGamma());
        OpenCVFrameConverter.<span class="hljs-type">ToMat</span> <span class="hljs-variable">converter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenCVFrameConverter</span>.ToMat();

        <span class="hljs-keyword">try</span> {
            grabber.start();
            canvas.setCanvasSize(grabber.getImageWidth(), grabber.getImageHeight());

            Frame frame;
            <span class="hljs-keyword">while</span> ((frame = grabber.grabImage()) != <span class="hljs-literal">null</span> &amp;&amp; canvas.isVisible()) {
                <span class="hljs-type">Mat</span> <span class="hljs-variable">srcImg</span> <span class="hljs-operator">=</span> converter.convert(frame);
                <span class="hljs-type">Mat</span> <span class="hljs-variable">resultImg</span> <span class="hljs-operator">=</span> inferenceEngine.inferImage(srcImg);
                canvas.showImage(converter.convert(resultImg));
                srcImg.release();
                resultImg.release();
            }

            canvas.dispose();
            grabber.stop();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }

    <span class="hljs-comment">// ç®€åŒ–çš„imread/imwriteï¼ˆJavaCVå°è£…ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Mat <span class="hljs-title function_">imread</span><span class="hljs-params">(String path)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenCVFrameConverter</span>.ToMat().convert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenCVFrameGrabber</span>(path).start().grabImage());
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">imwrite</span><span class="hljs-params">(String path, Mat mat)</span> {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">FFmpegFrameRecorder</span> <span class="hljs-variable">recorder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FFmpegFrameRecorder</span>(path, mat.cols(), mat.rows())) {
            recorder.setVideoCodec(avcodec.AV_CODEC_ID_PNG);
            recorder.start();
            recorder.record(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenCVFrameConverter</span>.ToMat().convert(mat));
            recorder.stop();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<h2 data-id="heading-12">å››ã€éƒ¨ç½²ä¸æµ‹è¯•ï¼ˆé›¶Pythonï¼Œç›´æ¥è¿è¡Œï¼‰</h2>
<h3 data-id="heading-13">1. æ‰“åŒ…å¯æ‰§è¡ŒJarï¼ˆåŒ…å«æ‰€æœ‰ä¾èµ–ï¼‰</h3>
<pre><code class="hljs language-Bash" lang="Bash">
<span class="hljs-comment"># è¿›å…¥é¡¹ç›®ç›®å½•</span>
<span class="hljs-built_in">cd</span> yolo-java-nopython
<span class="hljs-comment"># æ‰“åŒ…ï¼ˆMavenè‡ªåŠ¨ä¸‹è½½æ‰€æœ‰Javaä¾èµ–ï¼Œæ— Pythonï¼‰</span>
mvn clean package
</code></pre>
<p>æ‰“åŒ…å®Œæˆåï¼Œåœ¨<code>target</code>ç›®å½•ç”Ÿæˆï¼š<code>yolo-java-nopython-1.0-SNAPSHOT-jar-with-dependencies.jar</code>ï¼ˆçº¦150MBï¼ŒåŒ…å«æ‰€æœ‰JavaCV/ONNX RuntimeåŸç”Ÿåº“ï¼‰ã€‚</p>
<h3 data-id="heading-14">2. è¿è¡Œæµ‹è¯•ï¼ˆæ— Pythonï¼Œä»…éœ€JREï¼‰</h3>
<h4 data-id="heading-15">ï¼ˆ1ï¼‰å•å›¾ç‰‡æ£€æµ‹</h4>
<pre><code class="hljs language-Bash" lang="Bash">
<span class="hljs-comment"># å‡†å¤‡æµ‹è¯•å›¾ç‰‡test.jpgï¼Œæ”¾åœ¨JaråŒç›®å½•</span>
java -jar yolo-java-nopython-1.0-SNAPSHOT-jar-with-dependencies.jar
</code></pre>
<p>è¿è¡Œå®Œæˆåï¼Œç”Ÿæˆ<code>result.jpg</code>ï¼ˆå¸¦æ£€æµ‹æ¡†çš„ç»“æœå›¾ç‰‡ï¼‰ã€‚</p>
<h4 data-id="heading-16">ï¼ˆ2ï¼‰è§†é¢‘/æ‘„åƒå¤´æ£€æµ‹</h4>
<p>ä¿®æ”¹<code>YoloDetectorApp.java</code>ä¸­çš„æµ‹è¯•å…¥å£ï¼ˆæ³¨é‡Š/å–æ¶ˆæ³¨é‡Š<code>detectVideo</code>/<code>detectCamera</code>ï¼‰ï¼Œé‡æ–°æ‰“åŒ…åè¿è¡Œå³å¯ã€‚</p>
<h3 data-id="heading-17">3. è·¨å¹³å°è¿è¡Œï¼ˆæ— Pythonï¼Œæ— éœ€é€‚é…ï¼‰</h3>
<ul>
<li>
<p><strong>Windows</strong>ï¼šç›´æ¥åŒå‡»JaråŒ…ï¼Œæˆ–é€šè¿‡<code>java -jar</code>è¿è¡Œï¼›</p>
</li>
<li>
<p><strong>Linux/ARM64ï¼ˆJetson Nanoï¼‰</strong>ï¼šåŒæ ·æ‰§è¡Œ<code>java -jar</code>ï¼ŒJavaCVä¼šè‡ªåŠ¨åŠ è½½å¯¹åº”å¹³å°çš„åŸç”Ÿåº“ï¼›</p>
</li>
<li>
<p><strong>GPUåŠ é€Ÿï¼ˆå¯é€‰ï¼‰</strong>ï¼šæ›¿æ¢ONNX Runtimeä¸ºGPUç‰ˆï¼ˆ<code>onnxruntime-gpu</code>ï¼‰ï¼Œä»…éœ€ä¿®æ”¹pom.xmlä¾èµ–ï¼Œæ— Pythoné…ç½®ã€‚</p>
</li>
</ul>
<h2 data-id="heading-18">äº”ã€æ ¸å¿ƒä¼˜åŒ–ï¼ˆæ— Pythonä¾èµ–å‰æä¸‹ï¼‰</h2>
<ol>
<li>
<p><strong>å†…å­˜ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>
<p>åŠæ—¶è°ƒç”¨<code>Mat.release()</code>é‡Šæ”¾å›¾ç‰‡å†…å­˜ï¼Œé¿å…æ³„æ¼ï¼›</p>
</li>
<li>
<p>ONNX Runtimeè®¾ç½®<code>setMemoryPatternOptimization(true)</code>ï¼Œå¤ç”¨å†…å­˜æ± ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>
<p>æ ¹æ®CPUæ ¸å¿ƒæ•°è°ƒæ•´æ¨ç†çº¿ç¨‹æ•°ï¼ˆ<code>setIntraOpNumThreads</code>ï¼‰ï¼›</p>
</li>
<li>
<p>å¯ç”¨ONNX Runtimeçš„æ‰€æœ‰ä¼˜åŒ–ï¼ˆ<code>OptLevel.ALL</code>ï¼‰ï¼›</p>
</li>
<li>
<p>å¯¹è§†é¢‘/æ‘„åƒå¤´æµé‡‡ç”¨å¸§é—´éš”é‡‡æ ·ï¼ˆå¦‚æ¯2å¸§æ£€æµ‹1æ¬¡ï¼‰ï¼Œå¹³è¡¡å¸§ç‡ä¸æ€§èƒ½ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>ä½“ç§¯ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>
<p>ä»…å¼•å…¥å¯¹åº”å¹³å°çš„JavaCVåŸç”Ÿåº“ï¼ˆå¦‚<code>ffmpeg-linux-arm64</code>è€Œé<code>ffmpeg-platform</code>ï¼‰ï¼Œå‡å°‘JaråŒ…ä½“ç§¯ï¼›</p>
</li>
<li>
<p>ä½¿ç”¨GraalVMåŸç”Ÿç¼–è¯‘ï¼Œå°†JaråŒ…ç¼–è¯‘ä¸ºäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯åŠ¨æ›´å¿«ã€ä½“ç§¯æ›´å°ã€‚</p>
</li>
</ul>
</li>
</ol>
<h2 data-id="heading-19">å…­ã€æ€»ç»“</h2>
<h3 data-id="heading-20">å…³é”®ç‚¹å›é¡¾</h3>
<ol>
<li>
<p><strong>é›¶Pythonä¾èµ–</strong>ï¼šå…¨ç¨‹åŸºäºJavaCVï¼ˆOpenCV/FFmpeg Javaå°è£…ï¼‰å’ŒONNX Runtime Javaç‰ˆï¼Œæ— éœ€å®‰è£…Pythonã€PyTorchç­‰ä»»ä½•Pythonç”Ÿæ€ç»„ä»¶ï¼›</p>
</li>
<li>
<p><strong>çº¯Javaå®ç°</strong>ï¼šå›¾ç‰‡è¯»å–ã€é¢„å¤„ç†ã€æ¨¡å‹æ¨ç†ã€ç»“æœç»˜åˆ¶å…¨ç”±Javaå®Œæˆï¼Œå…¼å®¹æ‰€æœ‰Javaæ”¯æŒçš„å¹³å°ï¼›</p>
</li>
<li>
<p><strong>è½»é‡éƒ¨ç½²</strong>ï¼šæ‰“åŒ…ä¸ºå•JaråŒ…ï¼Œä»…éœ€JREå³å¯è¿è¡Œï¼Œè·¨å¹³å°æ— éœ€é€‚é…ï¼›</p>
</li>
<li>
<p><strong>æ˜“æ‰©å±•</strong>ï¼šæ”¯æŒå›¾ç‰‡ã€è§†é¢‘ã€æ‘„åƒå¤´æµæ£€æµ‹ï¼Œå¯ç›´æ¥é›†æˆåˆ°SpringBootç­‰Java Webæ¡†æ¶ä¸­ã€‚</p>
</li>
</ol>
<h3 data-id="heading-21">æ ¸å¿ƒä¼˜åŠ¿</h3>
<ul>
<li>
<p>æ‘†è„±Pythonç¯å¢ƒä¾èµ–ï¼Œé™ä½ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å¤æ‚åº¦ï¼›</p>
</li>
<li>
<p>å¤ç”¨Javaç”Ÿæ€çš„æˆç†Ÿå·¥å…·ï¼ˆMavenã€Springã€ç›‘æ§ç­‰ï¼‰ï¼›</p>
</li>
<li>
<p>è·¨å¹³å°å…¼å®¹æ€§å¥½ï¼Œæ— éœ€ä¸ºä¸åŒæ¶æ„ç¼–å†™Pythoné€‚é…ä»£ç ã€‚</p>
</li>
</ul>
<p>è¯¥æ–¹æ¡ˆå¯ç›´æ¥ç”¨äºä¼ä¸šçº§ç”Ÿäº§ç¯å¢ƒï¼Œå®ç°YOLOç›®æ ‡æ£€æµ‹çš„çº¯Javaéƒ¨ç½²ï¼Œå…¼é¡¾æ˜“ç”¨æ€§ã€æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¾®è°ƒåçš„Qwen3-4Båœ¨å¤šé¡¹åŸºå‡†æµ‹è¯•ä¸Šæˆ˜å¹³æˆ–èƒœè¿‡GPT-OSS-120B]]></title>    <link>https://juejin.cn/post/7599924721006559295</link>    <guid>https://juejin.cn/post/7599924721006559295</guid>    <pubDate>2026-01-28T02:53:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599924721006559295" data-draft-id="7599929684021919763" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¾®è°ƒåçš„Qwen3-4Båœ¨å¤šé¡¹åŸºå‡†æµ‹è¯•ä¸Šæˆ˜å¹³æˆ–èƒœè¿‡GPT-OSS-120B"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LLM,å¼€æº"/> <meta itemprop="datePublished" content="2026-01-28T02:53:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Baihai_IDP"/> <meta itemprop="url" content="https://juejin.cn/user/3123071228582343"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¾®è°ƒåçš„Qwen3-4Båœ¨å¤šé¡¹åŸºå‡†æµ‹è¯•ä¸Šæˆ˜å¹³æˆ–èƒœè¿‡GPT-OSS-120B
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3123071228582343/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Baihai_IDP
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:53:47.000Z" title="Wed Jan 28 2026 02:53:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>ç¼–è€…æŒ‰ï¼š</strong> å¦‚æœä½ æ­£åœ¨ä¸ºè¾¹ç¼˜è®¡ç®—ã€æœ¬åœ°éƒ¨ç½²æˆ–èµ„æºå—é™åœºæ™¯å¯»æ‰¾é«˜æ•ˆçš„è¯­è¨€æ¨¡å‹è§£å†³æ–¹æ¡ˆï¼Œä½ æ˜¯å¦æ›¾å›°æƒ‘ï¼šåœ¨ä¼—å¤šå°å‹è¯­è¨€æ¨¡å‹ï¼ˆSLMï¼‰ä¸­ï¼Œå“ªä¸€ä¸ªæ‰æ˜¯å¾®è°ƒçš„æœ€ä½³èµ·ç‚¹ï¼Ÿæ˜¯å¦çœŸçš„å­˜åœ¨â€œå°è€Œå¼ºâ€çš„æ¨¡å‹ï¼Œèƒ½åœ¨å¾®è°ƒååª²ç¾ç”šè‡³è¶…è¶Šè§„æ¨¡å¤§æ•°åå€çš„æ•™å¸ˆæ¨¡å‹ï¼Ÿ</p>
<p>è¿‘æœŸï¼Œdistil labs å›¢é˜Ÿè¿›è¡Œäº†ä¸€é¡¹ä¸¥è°¨çš„åŸºå‡†ç ”ç©¶ï¼Œæˆ–è®¸èƒ½ä¸ºä½ æä¾›æ•°æ®é©±åŠ¨çš„ç­”æ¡ˆã€‚ä»–ä»¬åœ¨ 8 ç±»ä»»åŠ¡ï¼ˆæ¶µç›–åˆ†ç±»ã€ä¿¡æ¯æŠ½å–ã€å¼€å·ä¸é—­å·é—®ç­”ï¼‰ä¸Šï¼Œå¯¹ 12 ä¸ªä¸»æµå°å‹æ¨¡å‹ï¼ˆåŒ…æ‹¬ Qwen3ã€Llamaã€Gemmaã€Graniteã€SmolLM ç­‰ç³»åˆ—ï¼‰è¿›è¡Œäº†ç»Ÿä¸€å¾®è°ƒä¸è¯„ä¼°ï¼Œå¹¶å¯¹æ¯”äº†å…¶ä¸ 120B å‚æ•°æ•™å¸ˆæ¨¡å‹ï¼ˆGPT-OSS-120Bï¼‰çš„æ€§èƒ½å·®å¼‚ã€‚</p>
</blockquote>
<p><strong>ä½œè€… | Distil Labs</strong></p>
<p><strong>ç¼–è¯‘ | å²³æ‰¬</strong></p>
<h2 data-id="heading-0"><strong>01 TL;DR</strong></h2>
<p>ç»è¿‡å¾®è°ƒçš„å°å‹è¯­è¨€æ¨¡å‹ï¼ˆSLMï¼‰å¯ä»¥èƒœè¿‡è§„æ¨¡å¤§å¾—å¤šçš„æ¨¡å‹ï¼šå¾®è°ƒåçš„ Qwen3-4B åœ¨ 8 é¡¹åŸºå‡†æµ‹è¯•ä¸­çš„ 7 é¡¹ä¸Šè¡¨ç°èƒ½å¤Ÿè¶…è¶Šæˆ–æˆ˜å¹³ GPT-OSS-120Bï¼ˆä¸€ä¸ªæ¯”å®ƒæ¨¡å‹è§„æ¨¡å¤§ 30 å€çš„æ•™å¸ˆæ¨¡å‹ï¼‰ï¼Œå‰©ä¸‹çš„ä¸€é¡¹å·®è·ä¹Ÿä¸åˆ° 3 ä¸ªç™¾åˆ†ç‚¹ã€‚åœ¨ SQuAD 2.0 æ•°æ®é›†ä¸Šï¼Œå¾®è°ƒåçš„å­¦ç”Ÿæ¨¡å‹ç”šè‡³æ¯”æ•™å¸ˆæ¨¡å‹é«˜å‡º 19 åˆ†ã€‚è¿™æ„å‘³ç€ä½ åªéœ€æä½çš„æˆæœ¬ï¼Œå°±èƒ½åœ¨è‡ªå·±çš„ç¡¬ä»¶ä¸Šå®ç°å‰æ²¿æ¨¡å‹çº§åˆ«çš„å‡†ç¡®ç‡ã€‚</p>
<p>å¾®è°ƒåæ€§èƒ½æœ€ä½³çš„æ¨¡å‹ï¼šQwen3 ç³»åˆ—æ¨¡å‹åœ¨å¾®è°ƒåå§‹ç»ˆè¡¨ç°æœ€å¼ºï¼Œå…¶ä¸­ 4B ç‰ˆæœ¬æ•´ä½“è¡¨ç°æœ€ä¼˜ã€‚<strong>å¦‚æœä½ çš„ç›®æ ‡æ˜¯åœ¨ç‰¹å®šä»»åŠ¡ä¸Šè·å¾—æœ€é«˜å‡†ç¡®ç‡ï¼ŒQwen3-4B å°±æ˜¯ä½ çš„é¦–é€‰ã€‚</strong></p>
<p>æœ€å…·å¯å¾®è°ƒæ€§ï¼ˆğŸŸ-bleï¼‰ï¼ˆå¾®è°ƒæ”¶ç›Šæœ€å¤§ï¼‰ï¼š<strong>å°å‹æ¨¡å‹ä»å¾®è°ƒä¸­è·å¾—çš„æå‡è¿œè¶…å¤§å‹æ¨¡å‹ã€‚</strong> å¦‚æœä½ å—é™äºä½¿ç”¨éå¸¸å°çš„æ¨¡å‹ï¼ˆ1Bâ€“3Bï¼‰ï¼Œä¹Ÿä¸å¿…æ‹…å¿ƒ â€”â€” å®ƒä»¬èƒ½ä»å¾®è°ƒä¸­è·ç›Šæœ€å¤šï¼Œèƒ½å¤Ÿå¤§å¹…ç¼©å°ä¸æ›´å¤§æ¨¡å‹ä¹‹é—´çš„æ€§èƒ½å·®è·ã€‚</p>
<h2 data-id="heading-1"><strong>02 å¼•è¨€</strong></h2>
<p>å¦‚æœä½ æ­£åœ¨æ„å»ºéœ€è¦åœ¨è®¾å¤‡ç«¯ã€æœ¬åœ°æˆ–è¾¹ç¼˜ä¾§è¿è¡Œçš„ AI åº”ç”¨ï¼Œä½ å¾ˆå¯èƒ½é—®è¿‡è‡ªå·±ï¼šæˆ‘è¯¥å¾®è°ƒå“ªä¸ªå°å‹è¯­è¨€æ¨¡å‹ï¼ˆSLMï¼‰ï¼Ÿç›®å‰ SLM é¢†åŸŸé€‰æ‹©ä¼—å¤šï¼ˆQwenã€Llamaã€Gemmaã€Graniteã€SmolLMï¼‰ï¼Œæ¯ä¸ªç³»åˆ—éƒ½æä¾›å¤šç§æ¨¡å‹è§„æ¨¡çš„ç‰ˆæœ¬ã€‚é€‰é”™åŸºç¡€æ¨¡å‹å¯èƒ½æ„å‘³ç€æœ‰æ•°å‘¨æ—¶é—´åœ¨æµªè´¹è®¡ç®—èµ„æºï¼Œæˆ–è€…å¾—åˆ°çš„æ¨¡å‹å§‹ç»ˆæ— æ³•è¾¾åˆ°ç”Ÿäº§è´¨é‡è¦æ±‚ã€‚</p>
<p>æˆ‘ä»¬è¿›è¡Œäº†ä¸€é¡¹ç³»ç»Ÿçš„åŸºå‡†æµ‹è¯•ï¼Œç”¨æ•°æ®æ¥å›ç­”è¿™ä¸ªé—®é¢˜ã€‚å€ŸåŠ© distil labs å¹³å°ï¼Œæˆ‘ä»¬åœ¨ 8 ä¸ªä¸åŒçš„ä»»åŠ¡ä¸Šï¼ˆåˆ†ç±»ã€ä¿¡æ¯æŠ½å–ã€å¼€å·é—®ç­”ã€é—­å·é—®ç­”ï¼‰å¾®è°ƒäº† 12 ä¸ªæ¨¡å‹ï¼Œç„¶åå°†å®ƒä»¬çš„æ€§èƒ½ç›¸äº’æ¯”è¾ƒï¼Œå¹¶ä¸ç”¨äºç”Ÿæˆåˆæˆè®­ç»ƒæ•°æ®çš„æ•™å¸ˆå¤§æ¨¡å‹è¿›è¡Œå¯¹æ¯”ã€‚</p>
<p>æœ¬æ–‡å›ç­”äº†å››ä¸ªå®é™…é—®é¢˜ï¼š</p>
<ul>
<li>å“ªä¸ªæ¨¡å‹åœ¨å¾®è°ƒåæ•ˆæœæœ€å¥½ï¼Ÿ</li>
<li>å“ªä¸ªæ¨¡å‹æœ€å…·å¯å¾®è°ƒæ€§ï¼Ÿï¼ˆå³å¾®è°ƒåæå‡æœ€å¤§ï¼‰</li>
<li>å“ªä¸ªæ¨¡å‹çš„åŸºç¡€æ€§èƒ½æœ€å¼ºï¼Ÿï¼ˆå³æœªç»å¾®è°ƒå‰ï¼‰</li>
<li>æˆ‘ä»¬è¡¨ç°æœ€å¥½çš„å­¦ç”Ÿæ¨¡å‹ï¼ŒçœŸçš„èƒ½åª²ç¾æ•™å¸ˆæ¨¡å‹å—ï¼Ÿ</li>
</ul>
<h2 data-id="heading-2"><strong>03 å®éªŒæ–¹æ³•</strong></h2>
<p>æˆ‘ä»¬è¯„ä¼°äº†ä»¥ä¸‹æ¨¡å‹ï¼š</p>
<ul>
<li><strong>Qwen3 ç³»åˆ—</strong>ï¼šQwen3-8Bã€Qwen3-4B-Instruct-2507ã€Qwen3-1.7Bã€Qwen3-0.6Bã€‚æ³¨æ„ï¼Œæˆ‘ä»¬å…³é—­äº†è¯¥ç³»åˆ—çš„â€œthinkingâ€åŠŸèƒ½ï¼Œä»¥ä¿è¯å®éªŒçš„å…¬å¹³ã€‚ Â </li>
<li><strong>Llama ç³»åˆ—</strong>ï¼šLlama-3.1-8B-Instructã€Llama-3.2-3B-Instructã€Llama-3.2-1B-Instruct Â </li>
<li><strong>SmolLM2 ç³»åˆ—</strong>ï¼šSmolLM2-1.7B-Instructã€SmolLM2-135M-Instruct Â </li>
<li><strong>Gemma ç³»åˆ—</strong>ï¼šgemma-3-1b-itã€gemma-3-270m-it Â </li>
<li><strong>Granite</strong>ï¼šgranite-3.3-8b-instruct Â </li>
</ul>
<p>é’ˆå¯¹æ¯ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬æµ‹é‡äº†ï¼š</p>
<ul>
<li>Base scoreï¼šä»…ä½¿ç”¨æç¤ºè¯ï¼ˆpromptingï¼‰çš„å°æ ·æœ¬ï¼ˆfew-shotï¼‰åœºæ™¯ä¸‹çš„æ€§èƒ½ Â </li>
<li>Finetuned scoreï¼šåœ¨ç”±æˆ‘ä»¬çš„æ•™å¸ˆæ¨¡å‹ï¼ˆGPT-OSS 120Bï¼‰ç”Ÿæˆçš„åˆæˆæ•°æ®ä¸Šå¾®è°ƒåçš„æ€§èƒ½ Â </li>
</ul>
<p>æˆ‘ä»¬çš„ 8 é¡¹åŸºå‡†æµ‹è¯•æ¶µç›–<strong>åˆ†ç±»</strong>ï¼ˆTRECã€Banking77ã€Ecommerceã€Mental Healthï¼‰ã€<strong>æ–‡æ¡£ç†è§£</strong>ï¼ˆdocsï¼‰ä»¥åŠ<strong>é—®ç­”ä»»åŠ¡</strong>ï¼ˆHotpotQAã€Roman Empire QAã€SQuAD 2.0ï¼‰ã€‚</p>
<p>ä¸ºäº†å®ç°å…¬å¹³æµ‹é‡ï¼Œæˆ‘ä»¬åˆ†åˆ«è®¡ç®—äº†æ¯ä¸ªæ¨¡å‹åœ¨å„ä¸ªåŸºå‡†æµ‹è¯•ä¸Šçš„æ’åï¼Œç„¶åè®¡ç®—æ‰€æœ‰ä»»åŠ¡ä¸Šçš„å¹³å‡æ’åï¼Œå¹¶ä»¥ 95% ç½®ä¿¡åŒºé—´ä½œä¸ºè¯¯å·®æ£’ï¼ˆerror barsï¼‰ç»˜åˆ¶åœ¨å›¾ä¸­ã€‚å¹³å‡æ’åè¶Šä½ï¼Œè¡¨ç¤ºæ•´ä½“æ€§èƒ½è¶Šå¥½ã€‚</p>
<h2 data-id="heading-3"><strong>04 é—®é¢˜ä¸€ï¼šå“ªä¸ªæ¨¡å‹åœ¨å¾®è°ƒåæ•ˆæœæœ€å¥½ï¼Ÿ</strong></h2>
<p>å† å†›ï¼šQwen3-4B-Instruct-2507ï¼ˆå¹³å‡æ’åï¼š2.25ï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/996d71c830f14179b49a86ee33dfe5a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=zFTLkntB4n0QDqpafrLEPvA4PKc%3D" alt="image.png" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bcc40e41f4e0428588cc6785bbb93603~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=Hb%2FWF3JclRRdQpX%2BiQCKE%2FuQq84%3D" alt="image.png" loading="lazy"/></p>
<p>Qwen3 ç³»åˆ—å æ®äº†æ’è¡Œæ¦œå‰åˆ—ï¼Œå…¶ä¸­ Qwen3-4B-Instruct-2507 æ‘˜å¾—æ¡‚å† ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™æ¬¾ 4B æ¨¡å‹çš„è¡¨ç°ç”šè‡³è¶…è¿‡äº†æ›´å¤§çš„ Qwen3-8Bï¼Œè¿™è¡¨æ˜åœ¨è’¸é¦ä»»åŠ¡ä¸­ï¼ŒQwen3 çš„è¾ƒæ–°ç‰ˆæœ¬ï¼ˆ2025 å¹´ 7 æœˆ 25 æ—¥æ›´æ–°çš„ç‰ˆæœ¬ï¼‰æ¯”ä¹‹å‰çš„ 8B SLM æ•ˆæœæ›´å¥½ã€‚</p>
<p>æ ¸å¿ƒç»“è®ºï¼š<strong>å¦‚æœä½ å¸Œæœ›è·å¾—æ•ˆæœæœ€å¥½çš„å¾®è°ƒæ¨¡å‹ï¼Œå¹¶ä¸”æ‹¥æœ‰æ”¯æŒçº¦ 4B å‚æ•°è§„æ¨¡æ¨¡å‹å¾®è°ƒçš„ GPU æ˜¾å­˜ï¼Œé‚£ä¹ˆ Qwen3-4B-Instruct-2507 æ˜¯ä½ çš„é¦–é€‰ã€‚</strong></p>
<h2 data-id="heading-4"><strong>05 é—®é¢˜äºŒï¼šå“ªä¸ªæ¨¡å‹æœ€å…·å¯å¾®è°ƒæ€§ï¼Ÿï¼ˆå³å¾®è°ƒåæå‡æœ€å¤§ï¼‰</strong></h2>
<p>å† å†›: Llama-3.2-1B-Instructï¼ˆå¹³å‡æ’åï¼š3.44ï¼‰</p>
<p>è¿™é‡Œæˆ‘ä»¬æµ‹é‡çš„æ˜¯å¯å¾®è°ƒæ€§ï¼ˆtunabilityï¼‰ â€”â€” å³ä»åŸºç¡€æ€§èƒ½åˆ°å¾®è°ƒåæ€§èƒ½çš„æå‡å¹…åº¦ï¼ˆfinetuned_score - base_scoreï¼‰ã€‚ä¸€ä¸ªé«˜åº¦å¯å¾®è°ƒçš„æ¨¡å‹åˆå§‹è¡¨ç°å¯èƒ½è¾ƒå¼±ï¼Œä½†ç»è¿‡å¾®è°ƒåæå‡æ˜¾è‘—ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6c7df7be9b84eaaa0f25df116309e72~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=042vhIqTtetQhRR%2BN3ITPvPxUqc%3D" alt="image.png" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94f29e84189d45eebd98bdde374ee992~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=Hv7J4rJTmoBD2p2NfSCw0ye9%2FSQ%3D" alt="image.png" loading="lazy"/></p>
<p>æœ‰è¶£çš„æ˜¯ï¼Œå¯å¾®è°ƒæ€§æ’åä¸æ¨¡å‹å¤§å°çš„æ’åºæ­£å¥½ç›¸åã€‚åƒ Llama-3.2-1B å’Œ Qwen3-0.6B è¿™æ ·çš„å°å‹æ¨¡å‹ï¼Œä»å¾®è°ƒä¸­è·å¾—çš„æå‡æœ€å¤§ã€‚è€Œè§„æ¨¡æœ€å¤§çš„æ¨¡å‹ï¼ˆå¦‚ Qwen3-8Bã€granite-3.3-8bï¼‰åœ¨å¯å¾®è°ƒæ€§æ’åä¸­æ¥è¿‘å«åº• â€”â€” è¿™å¹¶éå› ä¸ºå®ƒä»¬è¡¨ç°å·®ï¼Œè€Œæ˜¯å› ä¸ºå®ƒä»¬èµ·ç‚¹ç›¸å¯¹è¾ƒé«˜ï¼Œè¿›æ­¥ç©ºé—´ç›¸å¯¹æœ‰é™ã€‚</p>
<p>æ ¸å¿ƒç»“è®ºï¼š<strong>å¦‚æœä½ å—é™äºä½¿ç”¨æå°çš„æ¨¡å‹ï¼ˆ&lt;2B å‚æ•°ï¼‰ï¼Œä¸å¿…ç°å¿ƒã€‚è¿™äº›æ¨¡å‹ä»å¾®è°ƒä¸­è·ç›Šæœ€å¤§ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ˜¾è‘—ç¼©å°ä¸æ›´å¤§æ¨¡å‹ä¹‹é—´çš„æ€§èƒ½å·®è·ã€‚</strong></p>
<h2 data-id="heading-5"><strong>06 é—®é¢˜ä¸‰ï¼šå“ªä¸ªæ¨¡å‹çš„åŸºç¡€æ€§èƒ½æœ€å¼ºï¼Ÿï¼ˆå³æœªç»å¾®è°ƒå‰ï¼‰</strong></h2>
<p>å† å†›: Qwen3-8B (å¹³å‡æ’å: 1.75)</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/33405bd8af534332891b12d08a46d73c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=5M7Yvb0KyHGPemJ%2FtzTJiAOIE5I%3D" alt="image.png" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9e4633ba5e244e6b032bff6f7ef9ca2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=E9dN8qqfhbfUDjh5afRQHy34JsM%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨æœªç»ä»»ä½•å¾®è°ƒçš„æƒ…å†µä¸‹ï¼Œå“ªä¸ªæ¨¡å‹å¼€ç®±å³ç”¨çš„è¡¨ç°æœ€å¥½ï¼Ÿ</p>
<p>æ­£å¦‚é¢„æœŸï¼ŒåŸºç¡€æ€§èƒ½ä¸æ¨¡å‹å¤§å°å‘ˆæ­£ç›¸å…³ã€‚8B æ¨¡å‹å æ®äº†æ¦œé¦–ä½ç½®ï¼Œå…¶ä¸­ Qwen3-8B åœ¨æ‰€æœ‰åŸºå‡†æµ‹è¯•ä¸­éƒ½å±•ç°å‡ºéå¸¸ç¨³å®šçš„æ€§èƒ½ï¼ˆæ ‡å‡†å·®æœ€ä½ï¼‰ã€‚</p>
<p>æ ¸å¿ƒç»“è®ºï¼š<strong>å¦‚æœä½ éœ€è¦åœ¨ä¸è¿›è¡Œå¾®è°ƒçš„æƒ…å†µä¸‹åœ¨é›¶æ ·æœ¬/å°æ ·æœ¬åœºæ™¯ä¸‹ä¹Ÿè·å¾—è¾ƒä¼˜çš„æ€§èƒ½ï¼Œå¤§æ¨¡å‹ä»æ˜¯ä½ çš„æœ€ä½³é€‰æ‹©ã€‚ä½†è¯·è®°ä½ â€”â€” ç»è¿‡å¾®è°ƒåï¼Œè¿™ç§ä¼˜åŠ¿ä¼šå‡å¼±ã€‚</strong></p>
<h2 data-id="heading-6"><strong>07 é—®é¢˜å››ï¼šæˆ‘ä»¬è¡¨ç°æœ€å¥½çš„å­¦ç”Ÿæ¨¡å‹ï¼ŒçœŸçš„èƒ½åª²ç¾æ•™å¸ˆæ¨¡å‹å—ï¼Ÿ</strong></h2>
<p>æ˜¯çš„ã€‚Qwen3-4B-Instruct-2507 åœ¨ 8 é¡¹åŸºå‡†æµ‹è¯•ä¸­çš„ 7 é¡¹ä¸Šè¾¾åˆ°æˆ–è¶…è¶Šäº†æ•™å¸ˆæ¨¡å‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/725f8cad888e4a339c5ce91c2f9bd8f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=4CQWo0q6RW9hOCLC0es9E3O6nfw%3D" alt="image.png" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88d4230ad15748b5a2562afecbba8925~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=4EwZ%2Bam8LewvcHs6oPGGbEDH%2FDA%3D" alt="image.png" loading="lazy"/></p>
<p>ç»è¿‡å¾®è°ƒçš„ 4B å­¦ç”Ÿæ¨¡å‹åœ¨ 6 é¡¹åŸºå‡†æµ‹è¯•ä¸Šè¶…è¶Šäº† 120B+ å‚æ•°çš„æ•™å¸ˆæ¨¡å‹ï¼Œåœ¨ 1 é¡¹ï¼ˆHotpotQAï¼‰ä¸ŠæŒå¹³ï¼Œä»…åœ¨ 1 é¡¹ï¼ˆBanking77ï¼‰ä¸Šç•¥å¾®è½åï¼ˆå·®è·åœ¨è¯¯å·®èŒƒå›´å†…ï¼‰ã€‚æå‡æœ€æ˜¾è‘—çš„æ˜¯ SQuAD 2.0 é—­å·é—®ç­”ä»»åŠ¡ï¼Œå­¦ç”Ÿæ¨¡å‹æ¯”æ•™å¸ˆæ¨¡å‹é«˜å‡º 19 ä¸ªç™¾åˆ†ç‚¹ â€”â€” è¿™å……åˆ†è¯æ˜ï¼Œå¾®è°ƒæ¯”å•çº¯ä¾èµ–æç¤ºè¯ï¼ˆpromptingï¼‰èƒ½æ›´æœ‰æ•ˆåœ°å°†é¢†åŸŸçŸ¥è¯†æ³¨å…¥æ¨¡å‹ã€‚</p>
<p>æ ¸å¿ƒç»“è®ºï¼š<strong>ä¸€ä¸ªç»è¿‡é€‚å½“å¾®è°ƒçš„ 4B å‚æ•°æ¨¡å‹ï¼Œå¯ä»¥åª²ç¾ç”šè‡³è¶…è¶Šè§„æ¨¡è¾¾å…¶ 30 å€çš„æ¨¡å‹ã€‚è¿™æ„å‘³ç€æ¨ç†æˆæœ¬å¯é™ä½çº¦ 30 å€ï¼Œå¹¶ä¸”èƒ½å¤Ÿå®Œå…¨åœ¨æœ¬åœ°éƒ¨ç½²è¿è¡Œã€‚</strong></p>
<h2 data-id="heading-7"><strong>08 å®ç”¨å»ºè®®</strong></h2>
<p>åŸºäºæˆ‘ä»¬çš„åŸºå‡†æµ‹è¯•ç»“æœï¼Œä»¥ä¸‹æ˜¯é€‰æ‹©åŸºç¡€æ¨¡å‹çš„å»ºè®®ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/99a159b7def0470f844ff08809643695~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmFpaGFpX0lEUA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173627&amp;x-signature=%2FW86tTdlTaK%2BabjSiNhb56KbwRE%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-8"><strong>09 åç»­æˆ‘ä»¬å°†è¿›è¡Œçš„å·¥ä½œ</strong></h2>
<p>æœ¬æ¬¡åŸºå‡†æµ‹è¯•åªæ˜¯ä¸€ä¸ªèµ·ç‚¹ï¼Œæˆ‘ä»¬æ­£åœ¨ç§¯æåŠªåŠ›è®©è¿™äº›ç»“æœæ›´åŠ å¯é ï¼š</p>
<ul>
<li><strong>è¯„ä¼°æ›´å¤šæ¨¡å‹</strong>ï¼šSLM é¢†åŸŸå‘å±•è¿…é€Ÿã€‚æˆ‘ä»¬è®¡åˆ’åœ¨ Qwen3.5ã€Phi-4 å’Œ Mistral ç³»åˆ—ç­‰æ–°æ¨¡å‹ç‰ˆæœ¬å‘å¸ƒååŠæ—¶çº³å…¥è¯„æµ‹ã€‚</li>
<li><strong>å¢åŠ è¿è¡Œè½®æ¬¡</strong>ï¼šç›®å‰æˆ‘ä»¬çš„ç»“æœåŸºäºæœ‰é™æ¬¡æ•°çš„è¿è¡Œå–å¹³å‡ã€‚æˆ‘ä»¬å°†ä¸ºæ¯é¡¹åŸºå‡†æµ‹è¯•å¢åŠ æ›´å¤šè¿è¡Œè½®æ¬¡ï¼Œä»¥ç¼©å°ç½®ä¿¡åŒºé—´ï¼Œç¡®ä¿æ’åå…·æœ‰ç»Ÿè®¡å¯é æ€§ã€‚</li>
<li><strong>æ‰©å±•åŸºå‡†æµ‹è¯•è¦†ç›–èŒƒå›´</strong>ï¼šæˆ‘ä»¬å¸Œæœ›çº³å…¥æ›´å¤šä»»åŠ¡ç±»å‹ï¼Œå¦‚æ–‡æœ¬æ‘˜è¦ã€ä»£ç ç”Ÿæˆå’Œå¤šè½®å¯¹è¯ï¼Œä»è€Œæ›´å…¨é¢åœ°åæ˜ æ¨¡å‹èƒ½åŠ›ã€‚</li>
</ul>
<h2 data-id="heading-9"><strong>10 è®­ç»ƒç»†èŠ‚</strong></h2>
<p>æ¯ä¸ªæ¨¡å‹éƒ½åœ¨ä½¿ç”¨æˆ‘ä»¬è’¸é¦æµç¨‹ç”Ÿæˆçš„åˆæˆæ•°æ®è¿›è¡Œå¾®è°ƒï¼ˆæœ‰å…³æ•°æ®åˆæˆè¿‡ç¨‹çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ã€ŠSmall Expert Agents from 10 Examplesã€‹[1]ï¼‰ã€‚é’ˆå¯¹æ¯ä¸ªåŸºå‡†æµ‹è¯•ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•™å¸ˆæ¨¡å‹ï¼ˆGPTOss-120Bï¼‰ç”Ÿæˆäº† 10,000 æ¡è®­ç»ƒæ ·æœ¬ã€‚</p>
<p>å¾®è°ƒé‡‡ç”¨ distil labs çš„é»˜è®¤é…ç½®[2]ï¼šè®­ç»ƒ 4 ä¸ª epochï¼Œå­¦ä¹ ç‡ 5e-5ï¼Œä½¿ç”¨çº¿æ€§å­¦ä¹ ç‡è°ƒåº¦å™¨ï¼Œä»¥åŠ rank ä¸º 64 çš„ LoRAã€‚</p>
<p>æ‰€æœ‰æ¨¡å‹å‡ä½¿ç”¨å®Œå…¨ç›¸åŒçš„è¶…å‚æ•°è¿›è¡Œè®­ç»ƒã€‚è¯„ä¼°åœ¨è®­ç»ƒå’Œåˆæˆæ•°æ®ç”Ÿæˆè¿‡ç¨‹ä¸­å‡æœªæ¥è§¦è¿‡çš„é¢„ç•™æµ‹è¯•é›†ä¸Šè¿›è¡Œã€‚</p>
<h2 data-id="heading-10"><strong>11 ç»“è®º</strong></h2>
<p>å¹¶éæ‰€æœ‰å°å‹æ¨¡å‹çš„æ€§èƒ½éƒ½å·®ä¸å¤šï¼Œä½†ç»è¿‡å¾®è°ƒåï¼Œå®ƒä»¬ä¹‹é—´çš„å·®è·ä¼šå¤§å¹…ç¼©å°ã€‚æˆ‘ä»¬çš„åŸºå‡†æµ‹è¯•è¡¨æ˜ï¼ŒQwen3-4B-Instruct-2507 åœ¨æ•´ä½“å¾®è°ƒæ€§èƒ½ä¸Šè¡¨ç°æœ€ä½³ï¼Œä¸ä»…èƒ½åª²ç¾ 120B+ å‚æ•°çš„æ•™å¸ˆæ¨¡å‹ï¼Œè¿˜èƒ½åœ¨å•å—æ¶ˆè´¹çº§ GPU ä¸Šéƒ¨ç½²è¿è¡Œã€‚åœ¨èµ„æºæåº¦å—é™çš„ç¯å¢ƒä¸­ï¼Œåƒ Llama-3.2-1B è¿™æ ·çš„å°æ¨¡å‹å±•ç°å‡ºå“è¶Šçš„å¯å¾®è°ƒæ€§ï¼Œèƒ½å¤Ÿå¤§å¹…ç¼©å°ä¸å¤§æ¨¡å‹çš„æ€§èƒ½å·®è·ã€‚</p>
<p>æ ¸å¿ƒç»“è®ºï¼š<strong>å¾®è°ƒæ¯”åŸºç¡€æ¨¡å‹çš„é€‰æ‹©æ›´é‡è¦ã€‚ä¸€ä¸ªç»è¿‡è‰¯å¥½å¾®è°ƒçš„ 1B æ¨¡å‹ï¼Œå¯ä»¥èƒœè¿‡ä»…é æç¤ºè¯ï¼ˆpromptingï¼‰é©±åŠ¨çš„ 8B æ¨¡å‹ã€‚</strong></p>
<p><strong>END</strong></p>
<p><strong>æœ¬æœŸäº’åŠ¨å†…å®¹ ğŸ»</strong></p>
<p><strong>â“ä½ åœ¨å¾®è°ƒå°å‹è¯­è¨€æ¨¡å‹æ—¶ï¼Œæœ€çœ‹é‡çš„æ˜¯â€œå¼€ç®±å³ç”¨çš„å¼ºåŸºç¡€èƒ½åŠ›â€ï¼Œè¿˜æ˜¯â€œå¾®è°ƒåå·¨å¤§çš„æå‡ç©ºé—´â€ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</strong></p>
<p><strong>æ–‡ä¸­é“¾æ¥</strong></p>
<p>[1]<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.distillabs.ai%2Fblog%2Fsmall-expert-agents-from-10-examples" target="_blank" title="https://www.distillabs.ai/blog/small-expert-agents-from-10-examples" ref="nofollow noopener noreferrer">www.distillabs.ai/blog/small-â€¦</a></p>
<p>[2]<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.distillabs.ai%2Fhow-to%2Finput-preparation%2Fconfig" target="_blank" title="https://docs.distillabs.ai/how-to/input-preparation/config" ref="nofollow noopener noreferrer">docs.distillabs.ai/how-to/inpuâ€¦</a></p>
<p><strong>åŸæ–‡é“¾æ¥ï¼š</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.distillabs.ai%2Fblog%2Fwe-benchmarked-12-small-language-models-across-8-tasks-to-find-the-best-base-model-for-fine-tuning" target="_blank" title="https://www.distillabs.ai/blog/we-benchmarked-12-small-language-models-across-8-tasks-to-find-the-best-base-model-for-fine-tuning" ref="nofollow noopener noreferrer">www.distillabs.ai/blog/we-benâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3 æ¸²æŸ“ä¼˜åŒ–åŒæ ¸å¿ƒï¼šBlock Tree åŸç†ä¸ Fragment æ ¹èŠ‚ç‚¹å¦™ç”¨]]></title>    <link>https://juejin.cn/post/7599911091087540224</link>    <guid>https://juejin.cn/post/7599911091087540224</guid>    <pubDate>2026-01-28T02:54:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599911091087540224" data-draft-id="7599532624195895348" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3 æ¸²æŸ“ä¼˜åŒ–åŒæ ¸å¿ƒï¼šBlock Tree åŸç†ä¸ Fragment æ ¹èŠ‚ç‚¹å¦™ç”¨"/> <meta itemprop="keywords" content="JavaScript,é¢è¯•,Vue.js"/> <meta itemprop="datePublished" content="2026-01-28T02:54:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="boooooooom"/> <meta itemprop="url" content="https://juejin.cn/user/3078273283917399"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3 æ¸²æŸ“ä¼˜åŒ–åŒæ ¸å¿ƒï¼šBlock Tree åŸç†ä¸ Fragment æ ¹èŠ‚ç‚¹å¦™ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3078273283917399/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    boooooooom
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:54:07.000Z" title="Wed Jan 28 2026 02:54:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="androidstudio">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#a9b7c6;background:#282b2e}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#629755}.hljs-comment,.hljs-quote{color:grey}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#6a8759}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Vue3 ç¼–è¯‘ä¼˜åŒ–ä½“ç³»ä¸­ï¼ŒBlock Treeï¼ˆå—æ ‘ï¼‰ä¸ Fragment æ ¹èŠ‚ç‚¹ä¼˜åŒ–ï¼Œæ˜¯ç»§é™æ€æå‡ï¼ˆhoistStaticï¼‰ã€PatchFlag ä¹‹åçš„åˆä¸€æ ¸å¿ƒæ‰‹æ®µã€‚å¦‚æœè¯´é™æ€æå‡è§£å†³äº†é™æ€å†…å®¹çš„é‡å¤åˆ›å»ºé—®é¢˜ï¼ŒPatchFlag å®ç°äº†åŠ¨æ€å†…å®¹çš„ç²¾å‡†æ¯”å¯¹ï¼Œé‚£ä¹ˆ Block Tree åˆ™é€šè¿‡å¯¹æ¨¡æ¿èŠ‚ç‚¹çš„åˆ†å±‚å½’ç±»ï¼Œè¿›ä¸€æ­¥ç¼©å°è™šæ‹Ÿ DOM æ¯”å¯¹èŒƒå›´ï¼Œè€Œ Fragment æ ¹èŠ‚ç‚¹ä¼˜åŒ–åˆ™è§£å†³äº†æ¨¡æ¿å¿…é¡»æœ‰å”¯ä¸€æ ¹èŠ‚ç‚¹çš„å†å²ç—›ç‚¹ï¼ŒåŒæ—¶é™ä½æ¸²æŸ“å†—ä½™ã€‚æœ¬æ–‡å°†æ·±åº¦æ‹†è§£äºŒè€…çš„å®ç°é€»è¾‘ã€ååŒå…³ç³»åŠå®æˆ˜æ³¨æ„äº‹é¡¹ï¼Œå®Œå–„ Vue3 ç¼–è¯‘ä¼˜åŒ–çŸ¥è¯†ä½“ç³»ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å…ˆç ´å±€ï¼šFragment æ ¹èŠ‚ç‚¹ä¼˜åŒ–ï¼ˆå‘Šåˆ«å”¯ä¸€æ ¹èŠ‚ç‚¹é™åˆ¶ï¼‰</h2>
<p>Vue2 ä¸­å­˜åœ¨ä¸€ä¸ªç»å…¸é™åˆ¶ï¼šæ¨¡æ¿å¿…é¡»æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå”¯ä¸€æ ¹èŠ‚ç‚¹ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œå¼€å‘è€…é€šå¸¸ä¼šç”¨ä¸€ä¸ªæ— æ„ä¹‰çš„ <code>&lt;div&gt;&lt;/div&gt;</code> æ ‡ç­¾åŒ…è£¹æ‰€æœ‰å†…å®¹ï¼Œè¿™ä¸ä»…å¢åŠ äº† DOM å±‚çº§å†—ä½™ï¼Œè¿˜å¯èƒ½å½±å“æ ·å¼å¸ƒå±€ä¸æ¸²æŸ“æ€§èƒ½ã€‚Vue3 å¼•å…¥ Fragment ä½œä¸ºæ¨¡æ¿æ ¹èŠ‚ç‚¹è§£å†³æ–¹æ¡ˆï¼Œä»æ ¹æºä¸Šè§£å†³äº†è¿™ä¸€ç—›ç‚¹ã€‚1. Fragment æ ¸å¿ƒä½œç”¨ï¼šè™šæ‹Ÿæ ¹èŠ‚ç‚¹ï¼Œæ—  DOM å†—ä½™Fragment æœ¬è´¨æ˜¯ä¸€ä¸ªâ€œè™šæ‹Ÿæ ¹èŠ‚ç‚¹â€ï¼Œå®ƒä»…ä½œä¸ºæ¨¡æ¿çš„é€»è¾‘å®¹å™¨ï¼Œç¼–è¯‘åä¸ä¼šç”ŸæˆçœŸå®çš„ DOM èŠ‚ç‚¹ï¼Œæ—¢èƒ½æ»¡è¶³æ¨¡æ¿å¤šæ ¹èŠ‚ç‚¹çš„éœ€æ±‚ï¼Œåˆä¸ä¼šå¢åŠ  DOM å±‚çº§ã€‚</p>
<pre><code class="hljs language-ts" lang="ts">&lt;!-- <span class="hljs-title class_">Vue2</span> å†™æ³•ï¼šéœ€é¢å¤–åŒ…è£¹æ— æ„ä¹‰ div --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-comment">&lt;!-- å†—ä½™ DOM èŠ‚ç‚¹ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ–‡æœ¬å†…å®¹ 1<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ–‡æœ¬å†…å®¹ 2<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

&lt;!-- <span class="hljs-title class_">Vue3</span> å†™æ³•ï¼š<span class="hljs-title class_">Fragment</span> ä½œä¸ºæ ¹èŠ‚ç‚¹ï¼ˆæ— éœ€æ˜¾å¼å£°æ˜ï¼‰ --&gt;
&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ–‡æœ¬å†…å®¹ 1<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>
  &lt;p&gt;æ–‡æœ¬å†…å®¹ <span class="hljs-number">2</span>&amp;lt;/p&amp;gt;
&amp;lt;/template&amp;gt;

&lt;!-- ç¼–è¯‘åé€»è¾‘ï¼ˆç®€åŒ–ç‰ˆï¼‰ --&gt;
<span class="hljs-comment">// Vue3 è‡ªåŠ¨ç”¨ Fragment åŒ…è£¹å¤šæ ¹èŠ‚ç‚¹</span>
<span class="hljs-title function_">createVNode</span>(<span class="hljs-title class_">Fragment</span>, <span class="hljs-literal">null</span>, [
  <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'p'</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">'æ–‡æœ¬å†…å®¹ 1'</span>),
  <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'p'</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">'æ–‡æœ¬å†…å®¹ 2'</span>)
])
</code></pre>
<p>Vue3 æ¨¡æ¿ä¸­ï¼Œå¤šæ ¹èŠ‚ç‚¹ä¼šè¢«ç¼–è¯‘å™¨è‡ªåŠ¨åŒ…è£¹ä¸º Fragmentï¼Œæ— éœ€å¼€å‘è€…æ˜¾å¼å£°æ˜ï¼ˆä¹Ÿå¯é€šè¿‡ <code>2. Fragment ä¸æ™®é€šæ ¹èŠ‚ç‚¹çš„æ€§èƒ½å·®å¼‚å†—ä½™çš„æ ¹èŠ‚ç‚¹ä¸ä»…ä¼šå¢åŠ  DOM æ ‘çš„æ·±åº¦ï¼Œè¿˜ä¼šåœ¨è™šæ‹Ÿ DOM æ¯”å¯¹ã€DOM æ›´æ–°æ—¶äº§ç”Ÿé¢å¤–å¼€é”€ï¼šVue2 ä¸­ï¼Œå†—ä½™æ ¹èŠ‚ç‚¹ä¼šå‚ä¸è™šæ‹Ÿ DOM æ¯”å¯¹ï¼Œå³ä½¿å†…éƒ¨å†…å®¹æ— å˜åŒ–ï¼Œä¹Ÿéœ€éå†è¯¥èŠ‚ç‚¹åŠå±æ€§ã€‚Vue3 Fragment ä½œä¸ºè™šæ‹ŸèŠ‚ç‚¹ï¼Œä¸ä¼šç”ŸæˆçœŸå® DOMï¼Œè¿è¡Œæ—¶ä¼šç›´æ¥è·³è¿‡ Fragment èŠ‚ç‚¹çš„æ¯”å¯¹ï¼Œä»…å¤„ç†å…¶å­èŠ‚ç‚¹ï¼Œå‡å°‘æ— æ„ä¹‰çš„éå†å¼€é”€ã€‚</code> <code>3. Fragment é€‚ç”¨åœºæ™¯ä¸æ³¨æ„äº‹é¡¹é€‚ç”¨åœºæ™¯ï¼šå¤šæ ¹èŠ‚ç‚¹æ¨¡æ¿åœºæ™¯ï¼ˆå¦‚è¡¨å•ç»„ä»¶ã€åˆ—è¡¨é¡¹ç»„ä»¶ï¼Œéœ€è¿”å›å¤šä¸ªåŒçº§èŠ‚ç‚¹ï¼‰ã€‚é¿å… DOM å±‚çº§å†—ä½™çš„åœºæ™¯ï¼ˆå¦‚åµŒå¥—è¾ƒæ·±çš„ç»„ä»¶æ ‘ï¼Œå‡å°‘ä¸å¿…è¦çš„çˆ¶å®¹å™¨ï¼‰ã€‚</code>æ³¨æ„äº‹é¡¹ï¼šFragment ä»…æ”¯æŒ <code>key</code> å±æ€§ï¼ˆç”¨äºåˆ—è¡¨æ¸²æŸ“æ—¶çš„èŠ‚ç‚¹å¤ç”¨ï¼‰ï¼Œä¸æ”¯æŒ <code>class</code>ã€<code>style</code> ç­‰å±æ€§ï¼ˆå› æ— çœŸå® DOM èŠ‚ç‚¹æ‰¿è½½ï¼‰ã€‚
<code>äºŒã€æ ¸å¿ƒä¼˜åŒ–ï¼šBlock Tree å—æ ‘æœºåˆ¶ï¼ˆç¼©å°æ¯”å¯¹èŒƒå›´ï¼‰Block Tree æ˜¯ Vue3 ä¸ºè¿›ä¸€æ­¥ä¼˜åŒ–è™šæ‹Ÿ DOM æ¯”å¯¹æ•ˆç‡è®¾è®¡çš„åˆ†å±‚ç»“æ„ã€‚å®ƒåŸºäºâ€œåŠ¨æ€èŠ‚ç‚¹èšé›†â€åŸåˆ™ï¼Œå°†æ¨¡æ¿ä¸­çš„èŠ‚ç‚¹åˆ’åˆ†ä¸ºä¸åŒçš„ Blockï¼ˆå—ï¼‰ï¼Œä»…åŒ…å«åŠ¨æ€èŠ‚ç‚¹æˆ–åŠ¨æ€èŠ‚ç‚¹çˆ¶å®¹å™¨çš„ Block ä¼šå‚ä¸æ¯”å¯¹ï¼Œé™æ€ Block åˆ™ç›´æ¥å¤ç”¨ï¼Œå¤§å¹…ç¼©å°æ¯”å¯¹èŒƒå›´ã€‚</code></p>
<h3 data-id="heading-1">1. Block ä¸æ™®é€š VNode çš„åŒºåˆ«</h3>
<p>åœ¨ Vue3 ç¼–è¯‘åï¼ŒèŠ‚ç‚¹ä¼šè¢«åˆ†ä¸ºä¸¤ç±»ï¼š</p>
<ul>
<li><strong>æ™®é€š VNode</strong>ï¼šé™æ€èŠ‚ç‚¹ï¼ˆç»é™æ€æå‡å¤„ç†ï¼‰ï¼Œä»…åœ¨åˆå§‹åŒ–æ—¶åˆ›å»ºä¸€æ¬¡ï¼Œåç»­æ¸²æŸ“ç›´æ¥å¤ç”¨ï¼Œä¸å‚ä¸æ¯”å¯¹ã€‚</li>
<li><strong>Block VNode</strong>ï¼šæ ‡è®°ä¸º Block çš„èŠ‚ç‚¹ï¼Œå†…éƒ¨åŒ…å«åŠ¨æ€èŠ‚ç‚¹æˆ–åŠ¨æ€å­èŠ‚ç‚¹ï¼Œä¼šå‚ä¸è™šæ‹Ÿ DOM æ¯”å¯¹ï¼Œä½†ä»…æ¯”å¯¹å†…éƒ¨çš„åŠ¨æ€å†…å®¹ï¼ˆç»“åˆ PatchFlagï¼‰ã€‚</li>
</ul>
<p>Block çš„æ ¸å¿ƒç‰¹å¾æ˜¯â€œåŒ…å«åŠ¨æ€å†…å®¹â€ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å°†æ¨¡æ¿ä¸­å«åŠ¨æ€èŠ‚ç‚¹çš„æœ€å°çˆ¶å®¹å™¨æ ‡è®°ä¸º Blockï¼Œå½¢æˆä»¥ Block ä¸ºæ ¸å¿ƒçš„æ ‘çŠ¶ç»“æ„ï¼ˆBlock Treeï¼‰ã€‚</p>
<h3 data-id="heading-2">2. Block Tree æ„å»ºé€»è¾‘ï¼ˆç¼–è¯‘é˜¶æ®µï¼‰</h3>
<p>ç¼–è¯‘å™¨æ„å»º Block Tree çš„æ ¸å¿ƒæ­¥éª¤çš„ï¼š</p>
<ol>
<li><strong>è¯†åˆ«åŠ¨æ€èŠ‚ç‚¹</strong>ï¼šæ‰«ææ¨¡æ¿ï¼Œæ ‡è®°æ‰€æœ‰å«åŠ¨æ€å†…å®¹çš„èŠ‚ç‚¹ï¼ˆå¦‚æ’å€¼ã€åŠ¨æ€ç»‘å®šã€v-if/v-for ç­‰ï¼‰ï¼Œå¹¶ä¸ºå…¶æ‰“ä¸Š PatchFlagã€‚</li>
<li><strong>ç¡®å®š Block è¾¹ç•Œ</strong>ï¼šä»¥åŒ…å«åŠ¨æ€èŠ‚ç‚¹çš„æœ€å°çˆ¶å®¹å™¨ä½œä¸º Block è¾¹ç•Œï¼Œå°†è¯¥çˆ¶å®¹å™¨æ ‡è®°ä¸º Block VNodeï¼Œå…¶å†…éƒ¨çš„é™æ€èŠ‚ç‚¹ä»ä¼šè¢«é™æ€æå‡ï¼ŒåŠ¨æ€èŠ‚ç‚¹åˆ™ä¿ç•™åœ¨ Block å†…éƒ¨ã€‚</li>
<li><strong>æ„å»ºå±‚çº§ç»“æ„</strong>ï¼šè‹¥ Block å†…éƒ¨è¿˜åŒ…å«å…¶ä»–åŠ¨æ€èŠ‚ç‚¹çš„çˆ¶å®¹å™¨ï¼Œä¼šé€’å½’åˆ›å»ºå­ Blockï¼Œæœ€ç»ˆå½¢æˆå¤šå±‚çº§çš„ Block Treeã€‚</li>
</ol>
<pre><code class="hljs language-ts" lang="ts">&lt;!-- æ¨¡æ¿ç¤ºä¾‹ --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span><span class="hljs-comment">&lt;!-- é™æ€çˆ¶å®¹å™¨ï¼Œé Block --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>é™æ€æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span> <span class="hljs-comment">&lt;!-- é™æ€èŠ‚ç‚¹ï¼Œè¢«æå‡ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dynamic-wrap"</span>&gt;</span> <span class="hljs-comment">&lt;!-- åŒ…å«åŠ¨æ€èŠ‚ç‚¹ï¼Œæ ‡è®°ä¸º Block --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Hello {{ name }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><span class="hljs-comment">&lt;!-- åŠ¨æ€èŠ‚ç‚¹ï¼ˆTEXT æ ‡è®°ï¼‰ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"activeClass"</span>&gt;</span>ç‚¹å‡»<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span> <span class="hljs-comment">&lt;!-- åŠ¨æ€èŠ‚ç‚¹ï¼ˆCLASS æ ‡è®°ï¼‰ --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

&lt;!-- ç¼–è¯‘å <span class="hljs-title class_">Block</span> <span class="hljs-title class_">Tree</span> é€»è¾‘ï¼ˆç®€åŒ–ç‰ˆï¼‰ --&gt;
<span class="hljs-keyword">const</span> _hoisted_1 = <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'h1'</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">'é™æ€æ ‡é¢˜'</span>) <span class="hljs-comment">// é™æ€æå‡</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'div'</span>, { <span class="hljs-attr">class</span>: <span class="hljs-string">'container'</span> }, [
    _hoisted_1,
    <span class="hljs-comment">// æ ‡è®°ä¸º Blockï¼Œå†…éƒ¨åŒ…å«åŠ¨æ€èŠ‚ç‚¹</span>
    <span class="hljs-title function_">createBlock</span>(<span class="hljs-string">'div'</span>, { <span class="hljs-attr">class</span>: <span class="hljs-string">'dynamic-wrap'</span> }, [
      <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'p'</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">`Hello <span class="hljs-subst">${name}</span>`</span>, <span class="hljs-number">1</span> <span class="hljs-comment">/* TEXT */</span>),
      <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'button'</span>, { <span class="hljs-attr">class</span>: activeClass }, <span class="hljs-string">'ç‚¹å‡»'</span>, <span class="hljs-number">2</span> <span class="hljs-comment">/* CLASS */</span>)
    ])
  ])
}
</code></pre>
<h3 data-id="heading-3">3. Block Tree è¿è¡Œæ—¶ä¼˜åŒ–ï¼šç²¾å‡†æ¯”å¯¹ï¼Œè·³è¿‡é™æ€å±‚çº§</h3>
<p>Vue3 è™šæ‹Ÿ DOM æ¯”å¯¹æ—¶ï¼Œä¼šç›´æ¥éå† Block Treeï¼Œè·³è¿‡æ‰€æœ‰æ™®é€šé™æ€ VNodeï¼Œä»…åœ¨ Block å†…éƒ¨ç»“åˆ PatchFlag æ¯”å¯¹åŠ¨æ€å†…å®¹ï¼Œå®ç°â€œåŒé‡ç²¾å‡†ä¼˜åŒ–â€ï¼š</p>
<ol>
<li><strong>å±‚çº§ç²¾å‡†</strong>ï¼šä»…éå† Block èŠ‚ç‚¹ç»„æˆçš„æ ‘ï¼Œé™æ€èŠ‚ç‚¹æ‰€åœ¨çš„å±‚çº§ç›´æ¥è·³è¿‡ï¼Œæ— éœ€é€å±‚éå†ã€‚</li>
<li><strong>å†…å®¹ç²¾å‡†</strong>ï¼šåœ¨ Block å†…éƒ¨ï¼Œé€šè¿‡ PatchFlag ä»…æ¯”å¯¹åŠ¨æ€å†…å®¹ï¼Œé™æ€å†…å®¹å¤ç”¨å·²æå‡çš„ VNodeã€‚</li>
</ol>
<p>å¯¹æ¯” Vue2 å…¨é‡éå†è™šæ‹Ÿ DOM æ ‘ï¼ŒBlock Tree ä½¿æ¯”å¯¹èŒƒå›´ç¼©å°è‡³â€œä»…åŠ¨æ€å†…å®¹æ‰€åœ¨çš„ Block å±‚çº§â€ï¼Œå°¤å…¶åœ¨å¤æ‚ç»„ä»¶æ ‘ä¸­ï¼Œæ€§èƒ½æå‡æ•ˆæœæ˜¾è‘—ã€‚</p>
<h2 data-id="heading-4">ä¸‰ã€ååŒä¼˜åŒ–ï¼šFragmentã€Block Tree ä¸ PatchFlag çš„è”åŠ¨</h2>
<p>Vue3 çš„ç¼–è¯‘ä¼˜åŒ–å¹¶éå•ä¸€ç‰¹æ€§ï¼Œè€Œæ˜¯ Fragmentã€Block Treeã€PatchFlagã€é™æ€æå‡å››å¤§æŠ€æœ¯ååŒä½œç”¨ï¼Œå½¢æˆå®Œæ•´çš„ä¼˜åŒ–é—­ç¯ï¼š</p>
<ol>
<li><strong>é™æ€æå‡</strong>ï¼šæå–é™æ€èŠ‚ç‚¹ï¼Œé¿å…é‡å¤åˆ›å»ºï¼Œä¸º Block Tree åˆ†å±‚å¥ å®šåŸºç¡€ã€‚</li>
<li><strong>Fragment</strong>ï¼šä½œä¸ºè™šæ‹Ÿæ ¹èŠ‚ç‚¹ï¼Œæ¶ˆé™¤å†—ä½™ DOMï¼Œä½¿ Block Tree å±‚çº§æ›´è´´åˆå®é™…å†…å®¹ç»“æ„ã€‚</li>
<li><strong>Block Tree</strong>ï¼šåˆ’åˆ†åŠ¨æ€å†…å®¹å±‚çº§ï¼Œç¼©å°è™šæ‹Ÿ DOM æ¯”å¯¹çš„èŒƒå›´ï¼Œèšç„¦åŠ¨æ€èŠ‚ç‚¹æ‰€åœ¨å®¹å™¨ã€‚</li>
<li><strong>PatchFlag</strong>ï¼šåœ¨ Block å†…éƒ¨ç²¾å‡†æ ‡è®°åŠ¨æ€å†…å®¹ç±»å‹ï¼Œå®ç° Block å†…çš„é¶å‘æ›´æ–°ã€‚</li>
</ol>
<pre><code class="hljs language-ts" lang="ts">
<span class="hljs-comment">// ååŒä¼˜åŒ–åçš„å®Œæ•´æ¸²æŸ“é€»è¾‘ï¼ˆç®€åŒ–ç‰ˆï¼‰</span>
<span class="hljs-comment">// 1. é™æ€æå‡ï¼šæå–é™æ€èŠ‚ç‚¹</span>
<span class="hljs-keyword">const</span> _hoisted_1 = <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'p'</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">'é™æ€æ–‡æœ¬'</span>)

<span class="hljs-comment">// 2. Fragment ä½œä¸ºæ ¹èŠ‚ç‚¹ï¼ŒåŒ…è£¹å¤šèŠ‚ç‚¹</span>
<span class="hljs-comment">// 3. Block Treeï¼šdynamic-wrap ä¸º Blockï¼ŒåŒ…å«åŠ¨æ€èŠ‚ç‚¹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">createVNode</span>(<span class="hljs-title class_">Fragment</span>, <span class="hljs-literal">null</span>, [
    _hoisted_1,
    <span class="hljs-title function_">createBlock</span>(<span class="hljs-string">'div'</span>, { <span class="hljs-attr">class</span>: <span class="hljs-string">'dynamic-wrap'</span> }, [
      <span class="hljs-comment">// 4. PatchFlagï¼šæ ‡è®°æ–‡æœ¬åŠ¨æ€å˜åŒ–</span>
      <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'p'</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">`Hello <span class="hljs-subst">${name}</span>`</span>, <span class="hljs-number">1</span> <span class="hljs-comment">/* TEXT */</span>),
      <span class="hljs-comment">// 4. PatchFlagï¼šæ ‡è®° class åŠ¨æ€å˜åŒ–</span>
      <span class="hljs-title function_">createVNode</span>(<span class="hljs-string">'div'</span>, { :<span class="hljs-keyword">class</span>=<span class="hljs-string">"styleClass"</span> }, <span class="hljs-string">'å†…å®¹'</span>, <span class="hljs-number">2</span> <span class="hljs-comment">/* CLASS */</span>)
    ])
  ])
}

<span class="hljs-comment">// è¿è¡Œæ—¶æ¯”å¯¹é€»è¾‘</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">patchBlock</span>(<span class="hljs-params">block</span>) {
  <span class="hljs-comment">// ä»…éå† Block å†…éƒ¨èŠ‚ç‚¹</span>
  block.<span class="hljs-property">children</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (child.<span class="hljs-property">patchFlag</span>) {
      <span class="hljs-comment">// ç»“åˆ PatchFlag ç²¾å‡†æ›´æ–°åŠ¨æ€å†…å®¹</span>
      <span class="hljs-title function_">updateByPatchFlag</span>(child)
    }
    <span class="hljs-comment">// é™æ€èŠ‚ç‚¹è·³è¿‡æ¯”å¯¹</span>
  })
}
</code></pre>
<h2 data-id="heading-5">å››ã€å®æˆ˜é¿å‘ï¼šBlock Tree ä¸ Fragment ä¼˜åŒ–è¦ç‚¹</h2>
<h3 data-id="heading-6">1. é¿å…è¿‡åº¦æ‹†åˆ† Block</h3>
<p>ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¼˜åŒ– Block è¾¹ç•Œï¼Œä½†å¼€å‘è€…éœ€é¿å…åœ¨æ¨¡æ¿ä¸­è¿‡åº¦åµŒå¥—åŠ¨æ€èŠ‚ç‚¹å®¹å™¨ï¼Œå¦åˆ™ä¼šå¯¼è‡´ Block å±‚çº§è¿‡å¤šï¼Œåè€Œå¢åŠ éå†å¼€é”€ã€‚å»ºè®®å°½é‡å°†ç›¸å…³åŠ¨æ€å†…å®¹é›†ä¸­åœ¨åŒä¸€çˆ¶å®¹å™¨ä¸‹ï¼Œå‡å°‘ Block æ•°é‡ã€‚</p>
<h3 data-id="heading-7">2. Fragment ä¸å¯æ»¥ç”¨ key</h3>
<p>ä»…å½“ Fragment ç”¨äº v-for åˆ—è¡¨æ¸²æŸ“æ—¶ï¼Œæ‰éœ€è¦æ·»åŠ  key å±æ€§ï¼›éåˆ—è¡¨åœºæ™¯çš„ Fragment æ— éœ€è®¾ç½® keyï¼Œå¦åˆ™ä¼šå¢åŠ ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ï¼ˆkey éœ€å‚ä¸èŠ‚ç‚¹å¤ç”¨æ¯”å¯¹ï¼‰ã€‚</p>
<h3 data-id="heading-8">3. åŠ¨æ€æŒ‡ä»¤å¯¹ Block çš„å½±å“</h3>
<p>v-ifã€v-for ç­‰åŠ¨æ€æŒ‡ä»¤ä¼šå¼ºåˆ¶å…¶çˆ¶å®¹å™¨æˆä¸º Blockï¼Œå› è¿™äº›æŒ‡ä»¤ä¼šå¯¼è‡´èŠ‚ç‚¹æ•°é‡ã€é¡ºåºå˜åŒ–ã€‚å¼€å‘ä¸­éœ€åˆç†è§„åˆ’åŠ¨æ€æŒ‡ä»¤çš„ä½ç½®ï¼Œé¿å…å°†å…¶æ”¾åœ¨é¡¶å±‚å®¹å™¨ï¼Œå¯¼è‡´æ•´ä¸ªç»„ä»¶æ ‘æˆä¸ºå•ä¸€ Blockï¼Œä¸§å¤±åˆ†å±‚ä¼˜åŒ–ä¼˜åŠ¿ã€‚</p>
<h3 data-id="heading-9">4. é™æ€å†…å®¹ä¸åŠ¨æ€å†…å®¹åˆ†ç¦»</h3>
<p>å°½é‡å°†é™æ€å†…å®¹ä¸åŠ¨æ€å†…å®¹æ‹†åˆ†åˆ°ä¸åŒå®¹å™¨ä¸­ï¼Œä½¿é™æ€å†…å®¹èƒ½è¢«å……åˆ†æå‡ï¼ŒåŠ¨æ€å†…å®¹é›†ä¸­åœ¨å°‘æ•° Block ä¸­ï¼Œæœ€å¤§åŒ–å‘æŒ¥ Block Tree çš„ä¼˜åŒ–æ•ˆæœã€‚</p>
<h2 data-id="heading-10">äº”ã€æ€§èƒ½æ”¶ç›Šï¼šå®æµ‹æ•°æ®ä¸åœºæ™¯ä»·å€¼</h2>
<p>Vue3 å®˜æ–¹åŸºå‡†æµ‹è¯•åŠå®é™…é¡¹ç›®éªŒè¯æ˜¾ç¤ºï¼ŒBlock Tree ä¸ Fragment ä¼˜åŒ–å¸¦æ¥çš„æ€§èƒ½æå‡æ˜¾è‘—ï¼š</p>
<ul>
<li><strong>å¤æ‚ç»„ä»¶æ ‘</strong>ï¼šè™šæ‹Ÿ DOM æ¯”å¯¹è€—æ—¶é™ä½ 40%~60%ï¼Œå°¤å…¶åµŒå¥—å±‚çº§è¶…è¿‡ 5 å±‚æ—¶ï¼Œä¼˜åŒ–æ•ˆæœæ›´æ˜æ˜¾ã€‚</li>
<li><strong>å¤šæ ¹èŠ‚ç‚¹ç»„ä»¶</strong>ï¼šæ¶ˆé™¤å†—ä½™ DOM åï¼Œåˆå§‹æ¸²æŸ“é€Ÿåº¦æå‡ 20%~30%ï¼ŒDOM æ›´æ–°æ—¶çš„å±‚çº§éå†å¼€é”€å‡å°‘ã€‚</li>
<li><strong>é•¿åˆ—è¡¨åœºæ™¯</strong>ï¼šç»“åˆ v-for ä¸ Block Treeï¼Œä»…æ›´æ–°å˜åŒ–é¡¹æ‰€åœ¨çš„ Blockï¼Œé¿å…å…¨é‡åˆ—è¡¨æ¯”å¯¹ï¼Œæ¸²æŸ“è€—æ—¶é™ä½ 50% ä»¥ä¸Šã€‚</li>
</ul>
<h2 data-id="heading-11">æ€»ç»“</h2>
<p>Fragment æ ¹èŠ‚ç‚¹ä¼˜åŒ–è§£å†³äº†æ¨¡æ¿å¤šæ ¹èŠ‚ç‚¹çš„å†å²ç—›ç‚¹ï¼Œæ¶ˆé™¤äº†å†—ä½™ DOM å±‚çº§ï¼Œä¸ºæ¸²æŸ“ä¼˜åŒ–æ‰«æ¸…äº†ç»“æ„éšœç¢ï¼›Block Tree åˆ™é€šè¿‡ç¼–è¯‘é˜¶æ®µçš„åˆ†å±‚å½’ç±»ï¼Œå°†è™šæ‹Ÿ DOM æ¯”å¯¹ä»â€œå…¨é‡éå†â€å‡çº§ä¸ºâ€œBlock çº§ç²¾å‡†éå†â€ï¼Œå†ç»“åˆ PatchFlag ä¸é™æ€æå‡ï¼Œæ„å»ºèµ· Vue3 é«˜æ•ˆæ¸²æŸ“çš„æ ¸å¿ƒä½“ç³»ã€‚</p>
<p>ç†è§£äºŒè€…çš„åº•å±‚é€»è¾‘ä¸ååŒå…³ç³»ï¼Œä¸ä»…èƒ½å¸®åŠ©æˆ‘ä»¬å†™å‡ºæ›´ç¬¦åˆ Vue3 ä¼˜åŒ–é€»è¾‘çš„æ¨¡æ¿ä»£ç ï¼Œè¿˜èƒ½åœ¨æ€§èƒ½ä¼˜åŒ–åœºæ™¯ä¸­ç²¾å‡†å®šä½é—®é¢˜â€”â€”ä¾‹å¦‚ï¼Œå½“ç»„ä»¶æ¸²æŸ“å¡é¡¿çš„ï¼Œå¯æ£€æŸ¥æ˜¯å¦å­˜åœ¨è¿‡åº¦åµŒå¥—çš„ Blockã€æœªåˆ†ç¦»çš„é™æ€/åŠ¨æ€å†…å®¹ï¼Œæˆ–æ»¥ç”¨å†—ä½™æ ¹èŠ‚ç‚¹ç­‰é—®é¢˜ï¼Œé€šè¿‡è°ƒæ•´æ¨¡æ¿ç»“æ„æœ€å¤§åŒ–å‘æŒ¥ Vue3 çš„ä¼˜åŒ–èƒ½åŠ›ã€‚</p>
<h4 data-id="heading-12">ç›¸å…³æ–‡ç« </h4>
<p><a href="https://juejin.cn/post/7599469598882709519" target="_blank" title="https://juejin.cn/post/7599469598882709519">é¿å‘+å®æˆ˜ï½œVue3 hoistStaticé™æ€æå‡ï¼Œè®©æ¸²æŸ“é€Ÿåº¦ç¿»å€çš„ç§˜å¯†</a></p>
<p><a href="https://juejin.cn/post/7599566082212757556" target="_blank" title="https://juejin.cn/post/7599566082212757556">åƒé€ Vue3 PatchFlagï¼8 å¤§ç±»æ ‡è¯†å«ä¹‰+ç²¾å‡†æ¯”å¯¹é€»è¾‘</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[# å°æ¨¡å‹å´›èµ·ï¼šè¾¹ç¼˜è®¡ç®—å¦‚ä½•è®© AI èµ°å‘ä¸ªäººåŒ–]]></title>    <link>https://juejin.cn/post/7599951933594091530</link>    <guid>https://juejin.cn/post/7599951933594091530</guid>    <pubDate>2026-01-28T02:54:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599951933594091530" data-draft-id="7599963665039441970" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="# å°æ¨¡å‹å´›èµ·ï¼šè¾¹ç¼˜è®¡ç®—å¦‚ä½•è®© AI èµ°å‘ä¸ªäººåŒ–"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,å‰ç«¯,æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-28T02:54:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            # å°æ¨¡å‹å´›èµ·ï¼šè¾¹ç¼˜è®¡ç®—å¦‚ä½•è®© AI èµ°å‘ä¸ªäººåŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:54:33.000Z" title="Wed Jan 28 2026 02:54:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åœ¨è¿‡å»å‡ å¹´ä¸­ï¼Œå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ä¸»å¯¼äº†äººå·¥æ™ºèƒ½é¢†åŸŸçš„å‘å±•æµªæ½®ã€‚ä» GPT ç³»åˆ—åˆ° Claudeã€Geminiï¼Œè¿™äº›åºå¤§çš„æ¨¡å‹é€šè¿‡å¼ºå¤§çš„æ¨ç†ä¸ç”Ÿæˆèƒ½åŠ›æ¨åŠ¨äº†å„è¡Œå„ä¸šçš„æ™ºèƒ½åŒ–ã€‚ç„¶è€Œï¼Œéšç€æ¨¡å‹è§„æ¨¡æ—¥ç›Šå¢é•¿ï¼Œèµ„æºæ¶ˆè€—ã€éšç§æ³„éœ²ä¸å»¶è¿Ÿé—®é¢˜ä¹Ÿé€æ¸å‡¸æ˜¾ã€‚<br/>
<strong>å°æ¨¡å‹ï¼ˆSmall Modelï¼‰ç»“åˆè¾¹ç¼˜è®¡ç®—ï¼ˆEdge Computingï¼‰</strong> çš„å…´èµ·ï¼Œæ­£ä¸º AI çš„ä¸ªäººåŒ–è½åœ°æä¾›æ–°çš„è·¯å¾„â€”â€”é€šè¿‡åœ¨æœ¬åœ°æˆ–è½»é‡åŒ–ç»ˆç«¯è¿›è¡Œæ¨¡å‹æ¨ç†ï¼Œäººå·¥æ™ºèƒ½ä¸å†æ˜¯äº‘ç«¯å·¨å¤´çš„ä¸“å±ï¼Œè€Œèƒ½çœŸæ­£èµ°è¿›æ¯ä¸€ä¸ªäººçš„è®¾å¤‡ä¸åœºæ™¯ä¸­ã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€é—®é¢˜èƒŒæ™¯ï¼šäº‘ç«¯ AI çš„å±€é™</h2>
<p>ä¼ ç»Ÿçš„ AI æ¨ç†å¤§å¤šä¾èµ–äº‘ç«¯çš„å¤§æ¨¡å‹è¿è¡Œï¼Œè¿™ç§æ–¹å¼å­˜åœ¨ä»¥ä¸‹ç—›ç‚¹ï¼š</p>
<ol>
<li><strong>å»¶è¿Ÿé—®é¢˜</strong>ï¼šç”¨æˆ·è¯·æ±‚éœ€ç»è¿‡ç½‘ç»œä¼ è¾“ï¼Œå“åº”æ—¶é—´éš¾ä»¥ä¿éšœã€‚</li>
<li><strong>éšç§é£é™©</strong>ï¼šæ•°æ®éœ€ä¸Šäº‘å¤„ç†ï¼Œå­˜åœ¨è¢«æ³„éœ²æˆ–æ»¥ç”¨çš„éšæ‚£ã€‚</li>
<li><strong>é«˜æ˜‚æˆæœ¬</strong>ï¼šå¤§æ¨¡å‹éœ€è¦å¼ºç®—åŠ›ä¸å·¨é‡èƒ½è€—ï¼Œæ™®é€šä¸ªäººæˆ–ä¸­å°ä¼ä¸šéš¾ä»¥æ‰¿å—ã€‚</li>
</ol>
<p>åœ¨è¿™ç±»èƒŒæ™¯ä¸‹ï¼Œè¾¹ç¼˜è®¡ç®— + å°æ¨¡å‹çš„æ¶æ„åº”è¿è€Œç”Ÿã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ <strong>â€œç®—åŠ›ä¸‹æ²‰â€</strong> â€”â€”å°†è½»é‡åŒ–çš„ AI æ¨¡å‹éƒ¨ç½²åœ¨é è¿‘æ•°æ®æºçš„è®¾å¤‡ç«¯ï¼ˆå¦‚æ‰‹æœºã€æ ‘è“æ´¾ã€IoT è®¾å¤‡ç­‰ï¼‰ï¼Œå®ç°æœ¬åœ°åŒ–æ™ºèƒ½å†³ç­–ä¸æ•°æ®ä¿æŠ¤ã€‚</p>
<hr/>
<h2 data-id="heading-2">äºŒã€æŠ€æœ¯å®ç°åœ¨åœ°ï¼šå°æ¨¡å‹ + è¾¹ç¼˜è®¡ç®—</h2>
<h3 data-id="heading-3">1. å°æ¨¡å‹çš„æ ¸å¿ƒæ€è·¯</h3>
<p>å°æ¨¡å‹å¹¶éâ€œåŠŸèƒ½ç¼©æ°´â€ï¼Œè€Œæ˜¯é€šè¿‡æ¨¡å‹å‹ç¼©ã€é‡åŒ–ä¸è’¸é¦ç­‰æŠ€æœ¯ï¼Œåœ¨ä¿è¯ç²¾åº¦çš„å‰æä¸‹é™ä½èµ„æºå ç”¨ã€‚å¸¸ç”¨æŠ€æœ¯åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>æ¨¡å‹è’¸é¦ï¼ˆKnowledge Distillationï¼‰</strong> ï¼šç”¨å¤§æ¨¡å‹æŒ‡å¯¼å°æ¨¡å‹å­¦ä¹ ã€‚</li>
<li><strong>æƒé‡é‡åŒ–ï¼ˆQuantizationï¼‰</strong> ï¼šå°†æƒé‡ä» 32-bit æµ®ç‚¹é™ä¸º 8-bit æˆ–æ›´ä½ã€‚</li>
<li><strong>å‰ªæï¼ˆPruningï¼‰</strong> ï¼šå»é™¤å†—ä½™ç¥ç»å…ƒä¸è¿æ¥ã€‚</li>
<li><strong>LoRA / QLoRA</strong>ï¼šä½ç§©é€‚é…ï¼Œè®©æ¨¡å‹å¯åœ¨è¾¹ç¼˜è®¾å¤‡ä¸Šå¢é‡å­¦ä¹ ã€‚</li>
</ul>
<h3 data-id="heading-4">2. è¾¹ç¼˜è®¡ç®—çš„æ”¯æ’‘æ¶æ„</h3>
<p>è¾¹ç¼˜è®¡ç®—å¼ºè°ƒ <strong>â€œå°±è¿‘å¤„ç†â€</strong> ï¼šæ•°æ®åœ¨é‡‡é›†ç«¯ï¼ˆè¾¹ç¼˜èŠ‚ç‚¹ï¼‰ç›´æ¥æ‰§è¡Œæ¨ç†ï¼Œè€Œéä¸Šä¼ äº‘ç«¯ã€‚ä¸€ä¸ªå…¸å‹æ¡†æ¶å¦‚ä¸‹å›¾ï¼š</p>
<pre><code class="hljs">ç”¨æˆ·ç»ˆç«¯ â†â†’ è¾¹ç¼˜èŠ‚ç‚¹ï¼ˆè½»é‡æ¨¡å‹æ¨ç†ï¼‰ â†â†’ äº‘ç«¯ï¼ˆå¤§æ¨¡å‹çŸ¥è¯†æ›´æ–°ï¼‰
</code></pre>
<p>è¿™ç§åˆ†å±‚ç­–ç•¥å®ç°äº†æ€§èƒ½ã€éšç§ä¸èƒ½è€—çš„å¹³è¡¡ã€‚</p>
<h3 data-id="heading-5">3. å®æˆ˜ç¤ºä¾‹ï¼šåœ¨æ ‘è“æ´¾ä¸Šè¿è¡Œè½»é‡åŒ–æ¨¡å‹</h3>
<p><strong>ç¤ºä¾‹ï¼šéƒ¨ç½²ä¸€ä¸ªé‡åŒ–ç‰ˆçš„å°å‹è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ TinyLLaMAï¼‰</strong></p>
<p>ä»¥ä¸‹ç¤ºä¾‹ä»£ç æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ <code>transformers</code> ä¸ <code>onnxruntime</code> åœ¨è¾¹ç¼˜è®¾å¤‡ä¸Šéƒ¨ç½²æœ¬åœ°æ¨ç†æ¨¡å‹ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">from transformers import AutoTokenizer, AutoModelForCausalLM
import torch
import onnxruntime as ort

<span class="hljs-comment"># 1. åŠ è½½é‡åŒ–æ¨¡å‹</span>
<span class="hljs-attr">model_name</span> = <span class="hljs-string">"TinyLlama/TinyLlama-1.1B-Chat-v1.0"</span>
<span class="hljs-attr">tokenizer</span> = AutoTokenizer.from_pretrained(model_name)
<span class="hljs-attr">model</span> = AutoModelForCausalLM.from_pretrained(model_name, torch_dtype=torch.qint8)

<span class="hljs-comment"># 2. è¾“å…¥</span>
<span class="hljs-attr">prompt</span> = <span class="hljs-string">"è¯·è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯è¾¹ç¼˜è®¡ç®—ã€‚"</span>
<span class="hljs-attr">inputs</span> = tokenizer(prompt, return_tensors=<span class="hljs-string">"pt"</span>)

<span class="hljs-comment"># 3. æœ¬åœ°æ¨ç†</span>
with torch.no_grad():
    <span class="hljs-attr">outputs</span> = model.generate(**inputs, max_new_tokens=<span class="hljs-number">80</span>)
print(tokenizer.decode(outputs<span class="hljs-section">[0]</span>, <span class="hljs-attr">skip_special_tokens</span>=<span class="hljs-literal">True</span>))
</code></pre>
<p><strong>ä¼˜åŒ–å»ºè®®ï¼š</strong></p>
<ul>
<li>å¯ä½¿ç”¨ <code>ONNX</code> æˆ– <code>GGUF</code> æ ¼å¼å¯¼å‡ºæ¨¡å‹ä»¥æå‡æ¨ç†é€Ÿåº¦ã€‚</li>
<li>è‹¥è®¾å¤‡å†…å­˜æœ‰é™ï¼Œå¯ç»“åˆ <code>quantization + memory mapping</code> é™ä½å ç”¨ã€‚</li>
<li>å¯¹è¾¹ç¼˜èŠ‚ç‚¹å¯æ¥å…¥è½»é‡ API ç½‘å…³ï¼ˆFastAPI/Flaskï¼‰å®ç°å±€åŸŸç½‘éƒ¨ç½²ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-6">ä¸‰ã€ä¼˜ç¼ºç‚¹ä¸å®æˆ˜åˆ†æ</h2>



































<table><thead><tr><th>ç»´åº¦</th><th>å°æ¨¡å‹ + è¾¹ç¼˜è®¡ç®—</th><th>äº‘ç«¯å¤§æ¨¡å‹</th></tr></thead><tbody><tr><td><strong>å“åº”å»¶è¿Ÿ</strong></td><td>æ¯«ç§’çº§ã€æœ¬åœ°å¤„ç†</td><td>éœ€ç½‘ç»œä¼ è¾“ã€å­˜åœ¨å»¶è¿Ÿ</td></tr><tr><td><strong>éšç§å®‰å…¨</strong></td><td>æ•°æ®ç•™åœ¨æœ¬åœ°ï¼Œé£é™©ä½</td><td>ä¾èµ–äº‘ç«¯ï¼Œæ½œåœ¨æ³„éœ²</td></tr><tr><td><strong>è®¡ç®—æˆæœ¬</strong></td><td>ä½ç®—åŠ›å¯è¿è¡Œ</td><td>éœ€å¤§è§„æ¨¡ GPU é›†ç¾¤</td></tr><tr><td><strong>æ›´æ–°çµæ´»æ€§</strong></td><td>å¯æ ¹æ®ä¸ªäººåœºæ™¯å¾®è°ƒ</td><td>é€šå¸¸ç”±äº‘ç«¯ç»Ÿä¸€ç®¡ç†</td></tr><tr><td><strong>æ™ºèƒ½æ°´å¹³</strong></td><td>æœ‰é™ä½†å¤Ÿç”¨</td><td>æ›´å¼ºçš„ä¸Šä¸‹æ–‡ç†è§£èƒ½åŠ›</td></tr></tbody></table>
<p><strong>å»ºè®®ï¼š</strong></p>
<ul>
<li>å¯¹å®æ—¶æ€§ã€éšç§æ€§è¦æ±‚é«˜çš„åº”ç”¨ï¼ˆå¦‚æ™ºèƒ½å®¶å±…ã€è½¦è½½åŠ©æ‰‹ï¼‰æ¨èè¾¹ç¼˜æ–¹æ¡ˆã€‚</li>
<li>å¯¹å¤æ‚é€»è¾‘ã€è·¨é¢†åŸŸæ¨ç†ä»»åŠ¡å¯é‡‡ç”¨â€œäº‘è¾¹ååŒâ€æ¶æ„ï¼Œå®ç°åŠ¨æ€å¹³è¡¡ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-7">å››ã€ç»“è®ºï¼šAI çš„â€œå»ä¸­å¿ƒåŒ–â€æœªæ¥</h2>
<p>éšç€ç¡¬ä»¶ç®—åŠ›ä¸æ¨¡å‹å‹ç¼©æŠ€æœ¯çš„è¿›æ­¥ï¼ŒAI æ­£ä»â€œä¸­å¿ƒåŒ–çš„äº‘æœåŠ¡â€èµ°å‘ <strong>â€œå»ä¸­å¿ƒåŒ–çš„æ™ºèƒ½èŠ‚ç‚¹â€</strong> ã€‚<br/>
è¾¹ç¼˜è®¡ç®—è®©æ¯ä¸€å°è®¾å¤‡éƒ½èƒ½æˆä¸ºæ™ºèƒ½çš„è½½ä½“ï¼Œè€Œå°æ¨¡å‹çš„å´›èµ·ï¼Œåˆ™è®©è¿™ä¸€æ„¿æ™¯çœŸæ­£å¯è¡Œã€‚æœªæ¥ï¼Œæˆ‘ä»¬æˆ–è®¸ä¸å†éœ€è¦è”ç½‘å³å¯äº«å—æ™ºèƒ½åŠ©æ‰‹ã€è¯­éŸ³è¯†åˆ«ã€å›¾åƒç†è§£ç­‰æœåŠ¡â€”â€”AI å°†æˆä¸º<strong>ä¸ªäººåŒ–ã€ç§å¯†ã€å®‰å…¨ä¸”éšæ‰‹å¯å¾—çš„è®¡ç®—åŠ›å»¶ä¼¸</strong>ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¸¦ä½ ç©è½¬é¸¿è’™6 AIæ™ºèƒ½ä½“å¼€å‘ï¼šä»0åˆ°1æ‰“é€ ä½ çš„ä¸“å±AIåŠ©æ‰‹]]></title>    <link>https://juejin.cn/post/7599868109086490666</link>    <guid>https://juejin.cn/post/7599868109086490666</guid>    <pubDate>2026-01-28T02:57:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599868109086490666" data-draft-id="7599929684022067219" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¸¦ä½ ç©è½¬é¸¿è’™6 AIæ™ºèƒ½ä½“å¼€å‘ï¼šä»0åˆ°1æ‰“é€ ä½ çš„ä¸“å±AIåŠ©æ‰‹"/> <meta itemprop="keywords" content="ArkTS,ArkUI,HarmonyOS"/> <meta itemprop="datePublished" content="2026-01-28T02:57:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¨å“¥çˆ±ç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/2242659450109575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¸¦ä½ ç©è½¬é¸¿è’™6 AIæ™ºèƒ½ä½“å¼€å‘ï¼šä»0åˆ°1æ‰“é€ ä½ çš„ä¸“å±AIåŠ©æ‰‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2242659450109575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¨å“¥çˆ±ç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:57:37.000Z" title="Wed Jan 28 2026 02:57:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Vå“¥ï¼ä»Šå¤©è¦è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸ªè¶…çº§å¹²è´§â€”â€”å¦‚ä½•åœ¨é¸¿è’™6ï¼ˆAPI21ï¼‰ä¸Šå¼€å‘ä¸€ä¸ªçœŸæ­£èƒ½ç”¨çš„AIæ™ºèƒ½ä½“ã€‚ä¸æ˜¯é‚£ç§ç©å…·çº§åˆ«çš„Demoï¼Œè€Œæ˜¯èƒ½è¯­éŸ³å¯¹è¯ã€èƒ½ç†è§£ä½ æ„å›¾ã€è¿˜èƒ½å¸®ä½ å¹²æ´»çš„æ™ºèƒ½åŠ©æ‰‹ï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆè¦åœ¨é¸¿è’™ä¸ŠåšAIæ™ºèƒ½ä½“ï¼Ÿ</h2>
<p>å…„å¼Ÿä»¬ï¼Œ2026å¹´äº†ï¼ŒAI Agentï¼ˆæ™ºèƒ½ä½“ï¼‰ç»å¯¹æ˜¯æœ€ç«çš„æŠ€æœ¯æ–¹å‘ä¹‹ä¸€ã€‚ä»€ä¹ˆæ˜¯æ™ºèƒ½ä½“ï¼Ÿç®€å•è¯´å°±æ˜¯ï¼š<strong>èƒ½æ„ŸçŸ¥ã€èƒ½æ€è€ƒã€èƒ½è¡ŒåŠ¨çš„AIç¨‹åº</strong>ã€‚</p>
<p>é¸¿è’™6åœ¨AIè¿™å—å¯ä»¥è¯´æ˜¯ä¸‹äº†è¡€æœ¬ï¼š</p>
<ul>
<li><strong>åŸç”ŸAIèƒ½åŠ›</strong>ï¼šMindSpore Liteç«¯ä¾§æ¨ç†å¼•æ“</li>
<li><strong>è¯­éŸ³èƒ½åŠ›</strong>ï¼šASRè¯­éŸ³è¯†åˆ« + TTSè¯­éŸ³åˆæˆ</li>
<li><strong>æ„å›¾è¯†åˆ«</strong>ï¼šæ™ºèƒ½ç†è§£ç”¨æˆ·éœ€æ±‚</li>
<li><strong>å¤§æ¨¡å‹æ¥å…¥</strong>ï¼šè½»æ¾å¯¹æ¥å„ç§LLM API</li>
</ul>
<p>ä»Šå¤©Vå“¥å°±æ‰‹æŠŠæ‰‹å¸¦ä½ åšä¸€ä¸ª<strong>å¤šæ¨¡æ€AIæ™ºèƒ½åŠ©æ‰‹</strong>ï¼Œå®ƒèƒ½ï¼š</p>
<ol>
<li>âœ… è¯­éŸ³å”¤é†’ï¼Œå¼€å£å°±èƒ½èŠ</li>
<li>âœ… æ™ºèƒ½å¯¹è¯ï¼Œæ¥å…¥å¤§æ¨¡å‹</li>
<li>âœ… æ„å›¾è¯†åˆ«ï¼Œç†è§£ä½ æƒ³å¹²å˜›</li>
<li>âœ… æ‰§è¡Œä»»åŠ¡ï¼Œå¸®ä½ æ‰“å¼€åº”ç”¨ã€è®¾ç½®é—¹é’Ÿç­‰</li>
<li>âœ… å¤šè½®è®°å¿†ï¼Œä¸Šä¸‹æ–‡è¿è´¯</li>
</ol>
<p>åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç ï¼</p>
<hr/>
<h2 data-id="heading-1">äºŒã€é¡¹ç›®æ¶æ„è®¾è®¡</h2>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AIæ™ºèƒ½ä½“æ¶æ„ï¼ˆVå“¥è®¾è®¡ï¼‰                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚  è¯­éŸ³è¾“å…¥   â”‚â”€â”€â”€â–¶â”‚  è¯­éŸ³è¯†åˆ«   â”‚â”€â”€â”€â–¶â”‚  æ„å›¾ç†è§£   â”‚        â”‚
â”‚   â”‚   (ASR)    â”‚    â”‚   Engine    â”‚    â”‚   Engine    â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                 â”‚               â”‚
â”‚                                                 â–¼               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚  è¯­éŸ³è¾“å‡º   â”‚â—€â”€â”€â”€â”‚  å›å¤ç”Ÿæˆ   â”‚â—€â”€â”€â”€â”‚  å¯¹è¯ç®¡ç†   â”‚        â”‚
â”‚   â”‚   (TTS)    â”‚    â”‚   (LLM)    â”‚    â”‚   Agent    â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                 â”‚               â”‚
â”‚                                                 â–¼               â”‚
â”‚                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚                                        â”‚  ä»»åŠ¡æ‰§è¡Œ   â”‚         â”‚
â”‚                                        â”‚  Actions   â”‚         â”‚
â”‚                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€é¡¹ç›®åˆ›å»ºä¸é…ç½®</h2>
<h3 data-id="heading-3">æ­¥éª¤1ï¼šåˆ›å»ºé¡¹ç›®</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">DevEco</span> <span class="hljs-string">Studio</span> <span class="hljs-string">â†’</span> <span class="hljs-string">New</span> <span class="hljs-string">Project</span>
<span class="hljs-string">â†’</span> <span class="hljs-string">Empty</span> <span class="hljs-string">Ability</span> <span class="hljs-string">(Stageæ¨¡å‹)</span>
<span class="hljs-string">â†’</span> <span class="hljs-attr">Project name:</span> <span class="hljs-string">VGeAIAgent</span>
<span class="hljs-string">â†’</span> <span class="hljs-attr">Bundle name:</span> <span class="hljs-string">com.vge.aiagent</span>
<span class="hljs-string">â†’</span> <span class="hljs-attr">Compile SDK:</span> <span class="hljs-number">5.0</span><span class="hljs-number">.0</span><span class="hljs-string">(API</span> <span class="hljs-number">12</span><span class="hljs-string">)</span> <span class="hljs-string">æˆ–æ›´é«˜</span>
</code></pre>
<h3 data-id="heading-4">æ­¥éª¤2ï¼šé…ç½® module.json5</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"entry"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"entry"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$string:module_desc"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"mainElement"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"EntryAbility"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"deviceTypes"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"phone"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"tablet"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"deliveryWithInstall"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"installationFree"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"pages"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$profile:main_pages"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"abilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"EntryAbility"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"srcEntry"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./ets/entryability/EntryAbility.ets"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$string:EntryAbility_desc"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"icon"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$media:icon"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"label"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$string:EntryAbility_label"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"startWindowIcon"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$media:startIcon"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"startWindowBackground"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$color:start_window_background"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"exported"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"skills"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
          <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"entities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"entity.system.home"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"action.system.home"</span><span class="hljs-punctuation">]</span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">]</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"requestPermissions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ohos.permission.MICROPHONE"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$string:mic_reason"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"usedScene"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"abilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"EntryAbility"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"when"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"inuse"</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ohos.permission.INTERNET"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$string:net_reason"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"usedScene"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"abilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"EntryAbility"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"when"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"always"</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ohos.permission.DISTRIBUTED_DATASYNC"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$string:sync_reason"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"usedScene"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"abilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"EntryAbility"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"when"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"always"</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h2 data-id="heading-5">å››ã€æ ¸å¿ƒä»£ç å®ç°</h2>
<h3 data-id="heading-6">1. æ¶ˆæ¯æ•°æ®æ¨¡å‹ (model/MessageModel.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/model/MessageModel.ets</span>

<span class="hljs-comment">/**
 * Vå“¥è®¾è®¡çš„æ¶ˆæ¯æ¨¡å‹
 * æ”¯æŒå¤šç§æ¶ˆæ¯ç±»å‹ï¼Œä¸ºåç»­æ‰©å±•é¢„ç•™ç©ºé—´
 */</span>

<span class="hljs-comment">// æ¶ˆæ¯è§’è‰²</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">MessageRole</span> {
  <span class="hljs-variable constant_">USER</span> = <span class="hljs-string">'user'</span>,           <span class="hljs-comment">// ç”¨æˆ·æ¶ˆæ¯</span>
  <span class="hljs-variable constant_">ASSISTANT</span> = <span class="hljs-string">'assistant'</span>, <span class="hljs-comment">// AIåŠ©æ‰‹æ¶ˆæ¯</span>
  <span class="hljs-variable constant_">SYSTEM</span> = <span class="hljs-string">'system'</span>        <span class="hljs-comment">// ç³»ç»Ÿæ¶ˆæ¯</span>
}

<span class="hljs-comment">// æ¶ˆæ¯ç±»å‹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">MessageType</span> {
  <span class="hljs-variable constant_">TEXT</span> = <span class="hljs-string">'text'</span>,           <span class="hljs-comment">// æ–‡æœ¬æ¶ˆæ¯</span>
  <span class="hljs-variable constant_">VOICE</span> = <span class="hljs-string">'voice'</span>,         <span class="hljs-comment">// è¯­éŸ³æ¶ˆæ¯</span>
  <span class="hljs-variable constant_">ACTION</span> = <span class="hljs-string">'action'</span>,       <span class="hljs-comment">// æ‰§è¡ŒåŠ¨ä½œ</span>
  <span class="hljs-variable constant_">THINKING</span> = <span class="hljs-string">'thinking'</span>    <span class="hljs-comment">// æ€è€ƒä¸­</span>
}

<span class="hljs-comment">// æ„å›¾ç±»å‹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">IntentType</span> {
  <span class="hljs-variable constant_">CHAT</span> = <span class="hljs-string">'chat'</span>,                    <span class="hljs-comment">// é—²èŠ</span>
  <span class="hljs-variable constant_">OPEN_APP</span> = <span class="hljs-string">'open_app'</span>,            <span class="hljs-comment">// æ‰“å¼€åº”ç”¨</span>
  <span class="hljs-variable constant_">SET_ALARM</span> = <span class="hljs-string">'set_alarm'</span>,          <span class="hljs-comment">// è®¾ç½®é—¹é’Ÿ</span>
  <span class="hljs-variable constant_">SET_REMINDER</span> = <span class="hljs-string">'set_reminder'</span>,    <span class="hljs-comment">// è®¾ç½®æé†’</span>
  <span class="hljs-variable constant_">QUERY_WEATHER</span> = <span class="hljs-string">'query_weather'</span>,  <span class="hljs-comment">// æŸ¥è¯¢å¤©æ°”</span>
  <span class="hljs-variable constant_">QUERY_TIME</span> = <span class="hljs-string">'query_time'</span>,        <span class="hljs-comment">// æŸ¥è¯¢æ—¶é—´</span>
  <span class="hljs-variable constant_">CONTROL_DEVICE</span> = <span class="hljs-string">'control_device'</span>,<span class="hljs-comment">// æ§åˆ¶è®¾å¤‡</span>
  <span class="hljs-variable constant_">UNKNOWN</span> = <span class="hljs-string">'unknown'</span>               <span class="hljs-comment">// æœªçŸ¥æ„å›¾</span>
}

<span class="hljs-comment">// æ¶ˆæ¯å®ä½“</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Message</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;
  <span class="hljs-attr">role</span>: <span class="hljs-title class_">MessageRole</span> = <span class="hljs-title class_">MessageRole</span>.<span class="hljs-property">USER</span>;
  <span class="hljs-attr">type</span>: <span class="hljs-title class_">MessageType</span> = <span class="hljs-title class_">MessageType</span>.<span class="hljs-property">TEXT</span>;
  <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;
  <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  intent?: <span class="hljs-title class_">IntentType</span>;
  intentParams?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;;
  isStreaming?: <span class="hljs-built_in">boolean</span>;  <span class="hljs-comment">// æ˜¯å¦æµå¼è¾“å‡ºä¸­</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">init?: Partial&lt;Message&gt;</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = <span class="hljs-string">`msg_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>_<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random().toString(<span class="hljs-number">36</span>).substr(<span class="hljs-number">2</span>, <span class="hljs-number">9</span>)}</span>`</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamp</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">if</span> (init) {
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(<span class="hljs-variable language_">this</span>, init);
    }
  }
}

<span class="hljs-comment">// å¯¹è¯ä¸Šä¸‹æ–‡ï¼ˆç”¨äºå¤šè½®å¯¹è¯ï¼‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConversationContext</span> {
  <span class="hljs-attr">messages</span>: <span class="hljs-title class_">Message</span>[] = [];
  <span class="hljs-attr">maxHistory</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;  <span class="hljs-comment">// æœ€å¤šä¿ç•™10è½®å¯¹è¯</span>

  <span class="hljs-title function_">addMessage</span>(<span class="hljs-attr">message</span>: <span class="hljs-title class_">Message</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>.<span class="hljs-title function_">push</span>(message);
    <span class="hljs-comment">// è¶…è¿‡é™åˆ¶åˆ™ç§»é™¤æœ€æ—©çš„æ¶ˆæ¯</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxHistory</span> * <span class="hljs-number">2</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>.<span class="hljs-title function_">slice</span>(-<span class="hljs-variable language_">this</span>.<span class="hljs-property">maxHistory</span> * <span class="hljs-number">2</span>);
    }
  }

  <span class="hljs-title function_">getHistory</span>(): <span class="hljs-title class_">Message</span>[] {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>;
  }

  <span class="hljs-title function_">clear</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span> = [];
  }

  <span class="hljs-comment">// è½¬æ¢ä¸ºLLM APIéœ€è¦çš„æ ¼å¼</span>
  <span class="hljs-title function_">toAPIFormat</span>(): <span class="hljs-title class_">Array</span>&lt;{<span class="hljs-attr">role</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span>}&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>
      .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> m.<span class="hljs-property">type</span> === <span class="hljs-title class_">MessageType</span>.<span class="hljs-property">TEXT</span>)
      .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> ({
        <span class="hljs-attr">role</span>: m.<span class="hljs-property">role</span>,
        <span class="hljs-attr">content</span>: m.<span class="hljs-property">content</span>
      }));
  }
}
</code></pre>
<h3 data-id="heading-7">2. æ„å›¾è¯†åˆ«å¼•æ“ (engine/IntentEngine.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/engine/IntentEngine.ets</span>

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">IntentType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../model/MessageModel'</span>;

<span class="hljs-comment">/**
 * Vå“¥çš„æ„å›¾è¯†åˆ«å¼•æ“
 * ä½¿ç”¨è§„åˆ™+å…³é”®è¯åŒ¹é…ï¼Œç”Ÿäº§ç¯å¢ƒå¯æ¥å…¥NLUæ¨¡å‹
 */</span>

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">IntentRule</span> {
  <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>;
  <span class="hljs-attr">keywords</span>: <span class="hljs-built_in">string</span>[];
  <span class="hljs-attr">patterns</span>: <span class="hljs-title class_">RegExp</span>[];
  extractor?: <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IntentEngine</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">IntentEngine</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">rules</span>: <span class="hljs-title class_">IntentRule</span>[] = [];

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initRules</span>();
  }

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getInstance</span>(): <span class="hljs-title class_">IntentEngine</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">IntentEngine</span>.<span class="hljs-property">instance</span>) {
      <span class="hljs-title class_">IntentEngine</span>.<span class="hljs-property">instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntentEngine</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">IntentEngine</span>.<span class="hljs-property">instance</span>;
  }

  <span class="hljs-comment">/**
   * åˆå§‹åŒ–æ„å›¾è§„åˆ™
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">initRules</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">rules</span> = [
      <span class="hljs-comment">// æ‰“å¼€åº”ç”¨</span>
      {
        <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">OPEN_APP</span>,
        <span class="hljs-attr">keywords</span>: [<span class="hljs-string">'æ‰“å¼€'</span>, <span class="hljs-string">'å¯åŠ¨'</span>, <span class="hljs-string">'è¿è¡Œ'</span>, <span class="hljs-string">'å¼€å¯'</span>],
        <span class="hljs-attr">patterns</span>: [
          <span class="hljs-regexp">/æ‰“å¼€(.+?)(?:åº”ç”¨|app|APP)?$/</span>,
          <span class="hljs-regexp">/å¯åŠ¨(.+)/</span>,
          <span class="hljs-regexp">/å¸®æˆ‘å¼€(.+)/</span>
        ],
        <span class="hljs-attr">extractor</span>: <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> <span class="hljs-attr">appNames</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = {
            <span class="hljs-string">'ç›¸æœº'</span>: <span class="hljs-string">'com.huawei.camera'</span>,
            <span class="hljs-string">'ç›¸å†Œ'</span>: <span class="hljs-string">'com.huawei.photos'</span>,
            <span class="hljs-string">'è®¾ç½®'</span>: <span class="hljs-string">'com.huawei.settings'</span>,
            <span class="hljs-string">'æ—¥å†'</span>: <span class="hljs-string">'com.huawei.calendar'</span>,
            <span class="hljs-string">'è®¡ç®—å™¨'</span>: <span class="hljs-string">'com.huawei.calculator'</span>,
            <span class="hljs-string">'å¤‡å¿˜å½•'</span>: <span class="hljs-string">'com.huawei.notes'</span>,
            <span class="hljs-string">'éŸ³ä¹'</span>: <span class="hljs-string">'com.huawei.music'</span>,
            <span class="hljs-string">'è§†é¢‘'</span>: <span class="hljs-string">'com.huawei.video'</span>,
            <span class="hljs-string">'æµè§ˆå™¨'</span>: <span class="hljs-string">'com.huawei.browser'</span>,
            <span class="hljs-string">'å¾®ä¿¡'</span>: <span class="hljs-string">'com.tencent.mm'</span>,
            <span class="hljs-string">'æ”¯ä»˜å®'</span>: <span class="hljs-string">'com.eg.android.AlipayGphone'</span>,
            <span class="hljs-string">'æŠ–éŸ³'</span>: <span class="hljs-string">'com.ss.android.ugc.aweme'</span>
          };

          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [name, bundleName] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(appNames)) {
            <span class="hljs-keyword">if</span> (text.<span class="hljs-title function_">includes</span>(name)) {
              <span class="hljs-keyword">return</span> { <span class="hljs-attr">appName</span>: name, <span class="hljs-attr">bundleName</span>: bundleName };
            }
          }
          <span class="hljs-keyword">return</span> {};
        }
      },

      <span class="hljs-comment">// è®¾ç½®é—¹é’Ÿ</span>
      {
        <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">SET_ALARM</span>,
        <span class="hljs-attr">keywords</span>: [<span class="hljs-string">'é—¹é’Ÿ'</span>, <span class="hljs-string">'å«æˆ‘'</span>, <span class="hljs-string">'æé†’æˆ‘èµ·åºŠ'</span>, <span class="hljs-string">'å®šä¸ªé—¹é’Ÿ'</span>],
        <span class="hljs-attr">patterns</span>: [
          <span class="hljs-regexp">/(\d{1,2})[ç‚¹:ï¼š](\d{0,2}).*(?:é—¹é’Ÿ|å«æˆ‘|èµ·åºŠ)/</span>,
          <span class="hljs-regexp">/(?:æ˜å¤©|åå¤©)?(?:æ—©ä¸Š|ä¸Šåˆ|ä¸­åˆ|ä¸‹åˆ|æ™šä¸Š)?(\d{1,2})[ç‚¹:ï¼š]?(\d{0,2})?.*(?:é—¹é’Ÿ|å«æˆ‘)/</span>,
          <span class="hljs-regexp">/è®¾.*é—¹é’Ÿ.*(\d{1,2})[ç‚¹:ï¼š](\d{0,2})?/</span>
        ],
        <span class="hljs-attr">extractor</span>: <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> timeMatch = text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/(\d{1,2})[ç‚¹:ï¼š](\d{0,2})?/</span>);
          <span class="hljs-keyword">if</span> (timeMatch) {
            <span class="hljs-keyword">const</span> hour = timeMatch[<span class="hljs-number">1</span>];
            <span class="hljs-keyword">const</span> minute = timeMatch[<span class="hljs-number">2</span>] || <span class="hljs-string">'00'</span>;
            <span class="hljs-keyword">return</span> { hour, minute };
          }
          <span class="hljs-keyword">return</span> {};
        }
      },

      <span class="hljs-comment">// è®¾ç½®æé†’</span>
      {
        <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">SET_REMINDER</span>,
        <span class="hljs-attr">keywords</span>: [<span class="hljs-string">'æé†’æˆ‘'</span>, <span class="hljs-string">'åˆ«å¿˜äº†'</span>, <span class="hljs-string">'è®°å¾—'</span>],
        <span class="hljs-attr">patterns</span>: [
          <span class="hljs-regexp">/(\d+)(?:åˆ†é’Ÿ|å°æ—¶)åæé†’æˆ‘(.+)/</span>,
          <span class="hljs-regexp">/æé†’æˆ‘(.+)/</span>,
          <span class="hljs-regexp">/(\d{1,2})[ç‚¹:ï¼š](\d{0,2})?æé†’æˆ‘(.+)/</span>
        ],
        <span class="hljs-attr">extractor</span>: <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-comment">// æå–æ—¶é—´å’Œå†…å®¹</span>
          <span class="hljs-keyword">const</span> minuteMatch = text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/(\d+)åˆ†é’Ÿåæé†’æˆ‘(.+)/</span>);
          <span class="hljs-keyword">if</span> (minuteMatch) {
            <span class="hljs-keyword">return</span> {
              <span class="hljs-attr">delayMinutes</span>: minuteMatch[<span class="hljs-number">1</span>],
              <span class="hljs-attr">content</span>: minuteMatch[<span class="hljs-number">2</span>]
            };
          }

          <span class="hljs-keyword">const</span> hourMatch = text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/(\d+)å°æ—¶åæé†’æˆ‘(.+)/</span>);
          <span class="hljs-keyword">if</span> (hourMatch) {
            <span class="hljs-keyword">return</span> {
              <span class="hljs-attr">delayMinutes</span>: <span class="hljs-title class_">String</span>(<span class="hljs-built_in">parseInt</span>(hourMatch[<span class="hljs-number">1</span>]) * <span class="hljs-number">60</span>),
              <span class="hljs-attr">content</span>: hourMatch[<span class="hljs-number">2</span>]
            };
          }

          <span class="hljs-keyword">const</span> contentMatch = text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/æé†’æˆ‘(.+)/</span>);
          <span class="hljs-keyword">if</span> (contentMatch) {
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">content</span>: contentMatch[<span class="hljs-number">1</span>] };
          }

          <span class="hljs-keyword">return</span> {};
        }
      },

      <span class="hljs-comment">// æŸ¥è¯¢å¤©æ°”</span>
      {
        <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">QUERY_WEATHER</span>,
        <span class="hljs-attr">keywords</span>: [<span class="hljs-string">'å¤©æ°”'</span>, <span class="hljs-string">'ä¸‹é›¨'</span>, <span class="hljs-string">'æ¸©åº¦'</span>, <span class="hljs-string">'æ°”æ¸©'</span>, <span class="hljs-string">'ç©¿ä»€ä¹ˆ'</span>],
        <span class="hljs-attr">patterns</span>: [
          <span class="hljs-regexp">/(.+?)(?:çš„)?å¤©æ°”/</span>,
          <span class="hljs-regexp">/(?:ä»Šå¤©|æ˜å¤©|åå¤©).*(?:å¤©æ°”|ä¸‹é›¨|æ¸©åº¦)/</span>,
          <span class="hljs-regexp">/è¦ä¸è¦å¸¦ä¼/</span>
        ],
        <span class="hljs-attr">extractor</span>: <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> cityMatch = text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/(.{2,4}?)(?:çš„)?å¤©æ°”/</span>);
          <span class="hljs-keyword">if</span> (cityMatch &amp;&amp; ![<span class="hljs-string">'ä»Šå¤©'</span>, <span class="hljs-string">'æ˜å¤©'</span>, <span class="hljs-string">'åå¤©'</span>, <span class="hljs-string">'è¿™é‡Œ'</span>, <span class="hljs-string">'ç°åœ¨'</span>].<span class="hljs-title function_">includes</span>(cityMatch[<span class="hljs-number">1</span>])) {
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">city</span>: cityMatch[<span class="hljs-number">1</span>] };
          }
          <span class="hljs-keyword">return</span> { <span class="hljs-attr">city</span>: <span class="hljs-string">'åŒ—äº¬'</span> };  <span class="hljs-comment">// é»˜è®¤åŸå¸‚</span>
        }
      },

      <span class="hljs-comment">// æŸ¥è¯¢æ—¶é—´</span>
      {
        <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">QUERY_TIME</span>,
        <span class="hljs-attr">keywords</span>: [<span class="hljs-string">'å‡ ç‚¹'</span>, <span class="hljs-string">'æ—¶é—´'</span>, <span class="hljs-string">'æ—¥æœŸ'</span>, <span class="hljs-string">'æ˜ŸæœŸå‡ '</span>, <span class="hljs-string">'ä»Šå¤©å‡ å·'</span>],
        <span class="hljs-attr">patterns</span>: [
          <span class="hljs-regexp">/ç°åœ¨å‡ ç‚¹/</span>,
          <span class="hljs-regexp">/ä»€ä¹ˆæ—¶é—´/</span>,
          <span class="hljs-regexp">/ä»Šå¤©.*(?:å‡ å·|æ˜ŸæœŸå‡ |å‘¨å‡ )/</span>
        ],
        <span class="hljs-attr">extractor</span>: <span class="hljs-function">() =&gt;</span> ({})
      },

      <span class="hljs-comment">// æ§åˆ¶è®¾å¤‡</span>
      {
        <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">CONTROL_DEVICE</span>,
        <span class="hljs-attr">keywords</span>: [<span class="hljs-string">'æ‰“å¼€ç¯'</span>, <span class="hljs-string">'å…³ç¯'</span>, <span class="hljs-string">'å¼€ç¯'</span>, <span class="hljs-string">'ç©ºè°ƒ'</span>, <span class="hljs-string">'ç”µè§†'</span>, <span class="hljs-string">'çª—å¸˜'</span>],
        <span class="hljs-attr">patterns</span>: [
          <span class="hljs-regexp">/(æ‰“å¼€|å…³é—­|å¼€|å…³)(.+?)(?:ç¯|ç©ºè°ƒ|ç”µè§†|çª—å¸˜)/</span>,
          <span class="hljs-regexp">/æŠŠ(.+?)(æ‰“å¼€|å…³é—­|å¼€|å…³)/</span>,
          <span class="hljs-regexp">/(.+?)(?:è°ƒåˆ°|è®¾ç½®ä¸º?)(\d+)åº¦/</span>
        ],
        <span class="hljs-attr">extractor</span>: <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> actionMatch = text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/(æ‰“å¼€|å…³é—­|å¼€|å…³)(.+)/</span>);
          <span class="hljs-keyword">if</span> (actionMatch) {
            <span class="hljs-keyword">return</span> {
              <span class="hljs-attr">action</span>: actionMatch[<span class="hljs-number">1</span>].<span class="hljs-title function_">includes</span>(<span class="hljs-string">'å¼€'</span>) ? <span class="hljs-string">'on'</span> : <span class="hljs-string">'off'</span>,
              <span class="hljs-attr">device</span>: actionMatch[<span class="hljs-number">2</span>]
            };
          }
          <span class="hljs-keyword">return</span> {};
        }
      }
    ];
  }

  <span class="hljs-comment">/**
   * è¯†åˆ«ç”¨æˆ·æ„å›¾
   */</span>
  <span class="hljs-title function_">recognize</span>(<span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span>): { <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>; <span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;; <span class="hljs-attr">confidence</span>: <span class="hljs-built_in">number</span> } {
    <span class="hljs-keyword">const</span> normalizedText = text.<span class="hljs-title function_">toLowerCase</span>().<span class="hljs-title function_">trim</span>();

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> rule <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">rules</span>) {
      <span class="hljs-comment">// å…³é”®è¯åŒ¹é…</span>
      <span class="hljs-keyword">const</span> keywordMatch = rule.<span class="hljs-property">keywords</span>.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">kw</span> =&gt;</span> normalizedText.<span class="hljs-title function_">includes</span>(kw));

      <span class="hljs-comment">// æ­£åˆ™åŒ¹é…</span>
      <span class="hljs-keyword">const</span> patternMatch = rule.<span class="hljs-property">patterns</span>.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">pattern</span> =&gt;</span> pattern.<span class="hljs-title function_">test</span>(normalizedText));

      <span class="hljs-keyword">if</span> (keywordMatch || patternMatch) {
        <span class="hljs-keyword">const</span> params = rule.<span class="hljs-property">extractor</span> ? rule.<span class="hljs-title function_">extractor</span>(normalizedText) : {};
        <span class="hljs-keyword">const</span> confidence = keywordMatch &amp;&amp; patternMatch ? <span class="hljs-number">0.95</span> : <span class="hljs-number">0.75</span>;

        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[IntentEngine] è¯†åˆ«ç»“æœ: <span class="hljs-subst">${rule.intent}</span>, ç½®ä¿¡åº¦: <span class="hljs-subst">${confidence}</span>`</span>);
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">intent</span>: rule.<span class="hljs-property">intent</span>,
          params,
          confidence
        };
      }
    }

    <span class="hljs-comment">// é»˜è®¤ä¸ºé—²èŠ</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">CHAT</span>,
      <span class="hljs-attr">params</span>: {},
      <span class="hljs-attr">confidence</span>: <span class="hljs-number">0.5</span>
    };
  }
}
</code></pre>
<h3 data-id="heading-8">3. å¤§æ¨¡å‹å¯¹è¯æœåŠ¡ (service/LLMService.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/service/LLMService.ets</span>

<span class="hljs-keyword">import</span> { http } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ConversationContext</span>, <span class="hljs-title class_">Message</span>, <span class="hljs-title class_">MessageRole</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../model/MessageModel'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;

<span class="hljs-comment">/**
 * Vå“¥çš„LLMæœåŠ¡å°è£…
 * æ”¯æŒå¤šç§å¤§æ¨¡å‹APIï¼Œè¿™é‡Œä»¥é€šç”¨æ ¼å¼ä¸ºä¾‹
 */</span>

<span class="hljs-comment">// LLMé…ç½®æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">LLMConfig</span> {
  <span class="hljs-attr">apiUrl</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">apiKey</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">model</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">maxTokens</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">temperature</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-comment">// APIè¯·æ±‚æ ¼å¼</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ChatCompletionRequest</span> {
  <span class="hljs-attr">model</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">messages</span>: <span class="hljs-title class_">Array</span>&lt;{ <span class="hljs-attr">role</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span> }&gt;;
  <span class="hljs-attr">max_tokens</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">temperature</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">stream</span>: <span class="hljs-built_in">boolean</span>;
}

<span class="hljs-comment">// APIå“åº”æ ¼å¼</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ChatCompletionResponse</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">choices</span>: <span class="hljs-title class_">Array</span>&lt;{
    <span class="hljs-attr">message</span>: {
      <span class="hljs-attr">role</span>: <span class="hljs-built_in">string</span>;
      <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span>;
    };
    <span class="hljs-attr">finish_reason</span>: <span class="hljs-built_in">string</span>;
  }&gt;;
  <span class="hljs-attr">usage</span>: {
    <span class="hljs-attr">prompt_tokens</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">completion_tokens</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">total_tokens</span>: <span class="hljs-built_in">number</span>;
  };
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LLMService</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">LLMService</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">LLMConfig</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">systemPrompt</span>: <span class="hljs-built_in">string</span>;

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// é»˜è®¤é…ç½®ï¼ˆå®é™…ä½¿ç”¨æ—¶æ›¿æ¢ä¸ºä½ çš„APIä¿¡æ¯ï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">apiUrl</span>: <span class="hljs-string">'https://api.openai.com/v1/chat/completions'</span>,  <span class="hljs-comment">// æˆ–å…¶ä»–å…¼å®¹API</span>
      <span class="hljs-attr">apiKey</span>: <span class="hljs-string">'your-api-key-here'</span>,  <span class="hljs-comment">// æ›¿æ¢ä¸ºä½ çš„API Key</span>
      <span class="hljs-attr">model</span>: <span class="hljs-string">'gpt-3.5-turbo'</span>,
      <span class="hljs-attr">maxTokens</span>: <span class="hljs-number">2048</span>,
      <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.7</span>
    };

    <span class="hljs-comment">// ç³»ç»Ÿæç¤ºè¯ - Vå“¥ç²¾å¿ƒè°ƒæ•™</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">systemPrompt</span> = <span class="hljs-string">`ä½ æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨é¸¿è’™ç³»ç»Ÿä¸Šçš„AIæ™ºèƒ½åŠ©æ‰‹ï¼Œåå«"å°VåŠ©æ‰‹"ã€‚

ä½ çš„ç‰¹ç‚¹ï¼š
1. å‹å¥½ã€å¹½é»˜ã€ä¸“ä¸š
2. å›ç­”ç®€æ´æœ‰åŠ›ï¼Œä¸å•°å—¦
3. èƒ½ç†è§£ç”¨æˆ·æ„å›¾ï¼Œç»™å‡ºå®ç”¨å»ºè®®
4. ç†Ÿæ‚‰é¸¿è’™ç”Ÿæ€å’Œåä¸ºè®¾å¤‡
5. åœ¨é€‚å½“æ—¶å€™ä½¿ç”¨emojiå¢åŠ äº²å’ŒåŠ›

ä½ å¯ä»¥å¸®ç”¨æˆ·ï¼š
- å›ç­”å„ç§é—®é¢˜
- é—²èŠè§£é—·
- æä¾›å»ºè®®å’Œå¸®åŠ©
- è§£é‡ŠæŠ€æœ¯æ¦‚å¿µ

è¯·ç”¨ä¸­æ–‡å›å¤ï¼Œä¿æŒå›ç­”åœ¨100å­—ä»¥å†…ï¼ˆé™¤éç”¨æˆ·æ˜ç¡®è¦æ±‚è¯¦ç»†è§£é‡Šï¼‰ã€‚`</span>;
  }

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getInstance</span>(): <span class="hljs-title class_">LLMService</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">LLMService</span>.<span class="hljs-property">instance</span>) {
      <span class="hljs-title class_">LLMService</span>.<span class="hljs-property">instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LLMService</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">LLMService</span>.<span class="hljs-property">instance</span>;
  }

  <span class="hljs-comment">/**
   * æ›´æ–°é…ç½®
   */</span>
  <span class="hljs-title function_">updateConfig</span>(<span class="hljs-attr">config</span>: <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">LLMConfig</span>&gt;): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>, ...config };
  }

  <span class="hljs-comment">/**
   * å‘é€å¯¹è¯è¯·æ±‚
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">chat</span>(<span class="hljs-attr">userMessage</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">context</span>: <span class="hljs-title class_">ConversationContext</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt; {
    <span class="hljs-comment">// æ„å»ºæ¶ˆæ¯å†å²</span>
    <span class="hljs-keyword">const</span> <span class="hljs-attr">messages</span>: <span class="hljs-title class_">Array</span>&lt;{ <span class="hljs-attr">role</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span> }&gt; = [
      { <span class="hljs-attr">role</span>: <span class="hljs-string">'system'</span>, <span class="hljs-attr">content</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">systemPrompt</span> },
      ...context.<span class="hljs-title function_">toAPIFormat</span>(),
      { <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>, <span class="hljs-attr">content</span>: userMessage }
    ];

    <span class="hljs-keyword">const</span> <span class="hljs-attr">requestData</span>: <span class="hljs-title class_">ChatCompletionRequest</span> = {
      <span class="hljs-attr">model</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">model</span>,
      <span class="hljs-attr">messages</span>: messages,
      <span class="hljs-attr">max_tokens</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">maxTokens</span>,
      <span class="hljs-attr">temperature</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">temperature</span>,
      <span class="hljs-attr">stream</span>: <span class="hljs-literal">false</span>
    };

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> httpRequest = http.<span class="hljs-title function_">createHttp</span>();

      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> httpRequest.<span class="hljs-title function_">request</span>(
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">apiUrl</span>,
        {
          <span class="hljs-attr">method</span>: http.<span class="hljs-property">RequestMethod</span>.<span class="hljs-property">POST</span>,
          <span class="hljs-attr">header</span>: {
            <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
            <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.config.apiKey}</span>`</span>
          },
          <span class="hljs-attr">extraData</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(requestData),
          <span class="hljs-attr">connectTimeout</span>: <span class="hljs-number">30000</span>,
          <span class="hljs-attr">readTimeout</span>: <span class="hljs-number">60000</span>
        }
      );

      httpRequest.<span class="hljs-title function_">destroy</span>();

      <span class="hljs-keyword">if</span> (response.<span class="hljs-property">responseCode</span> === <span class="hljs-number">200</span>) {
        <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(response.<span class="hljs-property">result</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">ChatCompletionResponse</span>;
        <span class="hljs-keyword">const</span> content = result.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>]?.<span class="hljs-property">message</span>?.<span class="hljs-property">content</span> || <span class="hljs-string">'æŠ±æ­‰ï¼Œæˆ‘æ²¡æœ‰ç†è§£ä½ çš„æ„æ€'</span>;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[LLMService] å“åº”æˆåŠŸï¼ŒTokenä½¿ç”¨: <span class="hljs-subst">${result.usage?.total_tokens}</span>`</span>);
        <span class="hljs-keyword">return</span> content;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[LLMService] APIé”™è¯¯: <span class="hljs-subst">${response.responseCode}</span>`</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getFallbackResponse</span>(userMessage);
      }
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-keyword">const</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[LLMService] è¯·æ±‚å¤±è´¥: <span class="hljs-subst">${error.code}</span> - <span class="hljs-subst">${error.message}</span>`</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getFallbackResponse</span>(userMessage);
    }
  }

  <span class="hljs-comment">/**
   * ç¦»çº¿å…œåº•å›å¤ï¼ˆå½“APIä¸å¯ç”¨æ—¶ï¼‰
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">getFallbackResponse</span>(<span class="hljs-attr">userMessage</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">fallbackResponses</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>[]&gt; = {
      <span class="hljs-string">'ä½ å¥½'</span>: [<span class="hljs-string">'ä½ å¥½å‘€ï¼æœ‰ä»€ä¹ˆå¯ä»¥å¸®ä½ çš„ï¼Ÿ'</span>, <span class="hljs-string">'å—¨ï¼æˆ‘æ˜¯å°VåŠ©æ‰‹ï¼Œå¾ˆé«˜å…´è§åˆ°ä½ ï¼'</span>],
      <span class="hljs-string">'è°¢è°¢'</span>: [<span class="hljs-string">'ä¸å®¢æ°”ï¼éšæ—¶ä¸ºä½ æœåŠ¡~'</span>, <span class="hljs-string">'åº”è¯¥çš„ï¼Œè¿˜æœ‰ä»€ä¹ˆéœ€è¦å¸®åŠ©çš„å—ï¼Ÿ'</span>],
      <span class="hljs-string">'å†è§'</span>: [<span class="hljs-string">'å†è§ï¼æœŸå¾…ä¸‹æ¬¡èŠå¤©~'</span>, <span class="hljs-string">'æ‹œæ‹œï¼Œæœ‰äº‹éšæ—¶æ‰¾æˆ‘å“¦ï¼'</span>],
      <span class="hljs-string">'ä½ æ˜¯è°'</span>: [<span class="hljs-string">'æˆ‘æ˜¯å°VåŠ©æ‰‹ï¼Œè¿è¡Œåœ¨é¸¿è’™ç³»ç»Ÿä¸Šçš„AIåŠ©æ‰‹ï¼'</span>, <span class="hljs-string">'æˆ‘å«å°Vï¼Œæ˜¯Vå“¥æ‰“é€ çš„æ™ºèƒ½åŠ©æ‰‹~'</span>],
      <span class="hljs-string">'ä½ èƒ½åšä»€ä¹ˆ'</span>: [<span class="hljs-string">'æˆ‘èƒ½é™ªä½ èŠå¤©ã€å›ç­”é—®é¢˜ã€å¸®ä½ æ‰“å¼€åº”ç”¨ã€è®¾ç½®æé†’ç­‰ç­‰ï¼è¯•è¯•çœ‹å§~'</span>, 
                   <span class="hljs-string">'æˆ‘å¯ä»¥ï¼šé—²èŠè§£é—·ã€å›ç­”é—®é¢˜ã€æ§åˆ¶è®¾å¤‡ã€è®¾ç½®é—¹é’Ÿæé†’...åŠŸèƒ½å¤šå¤šï¼'</span>]
    };

    <span class="hljs-comment">// å…³é”®è¯åŒ¹é…</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [keyword, responses] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(fallbackResponses)) {
      <span class="hljs-keyword">if</span> (userMessage.<span class="hljs-title function_">includes</span>(keyword)) {
        <span class="hljs-keyword">return</span> responses[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * responses.<span class="hljs-property">length</span>)];
      }
    }

    <span class="hljs-comment">// é»˜è®¤å›å¤</span>
    <span class="hljs-keyword">const</span> defaultResponses = [
      <span class="hljs-string">'æˆ‘ç°åœ¨ç½‘ç»œä¸å¤ªå¥½ï¼Œç¨åå†è¯•è¯•å§~'</span>,
      <span class="hljs-string">'è®©æˆ‘æƒ³æƒ³... ä½ èƒ½æ¢ä¸ªæ–¹å¼é—®æˆ‘å—ï¼Ÿ'</span>,
      <span class="hljs-string">'æŠ±æ­‰ï¼Œæˆ‘æ²¡å¤ªç†è§£ï¼Œèƒ½å†è¯´ä¸€éå—ï¼Ÿ'</span>,
      <span class="hljs-string">'ç½‘ç»œå¼€å°å·®äº†ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥ç»§ç»­èŠåˆ«çš„ï¼'</span>
    ];

    <span class="hljs-keyword">return</span> defaultResponses[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * defaultResponses.<span class="hljs-property">length</span>)];
  }

  <span class="hljs-comment">/**
   * æµå¼å¯¹è¯ï¼ˆæ”¯æŒæ‰“å­—æœºæ•ˆæœï¼‰
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">chatStream</span>(
    <span class="hljs-attr">userMessage</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">context</span>: <span class="hljs-title class_">ConversationContext</span>,
    <span class="hljs-attr">onChunk</span>: <span class="hljs-function">(<span class="hljs-params">chunk: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>,
    <span class="hljs-attr">onComplete</span>: <span class="hljs-function">(<span class="hljs-params">fullText: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-comment">// ç®€åŒ–å®ç°ï¼šæ¨¡æ‹Ÿæµå¼è¾“å‡º</span>
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">chat</span>(userMessage, context);

    <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> interval = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (index &lt; response.<span class="hljs-property">length</span>) {
        <span class="hljs-title function_">onChunk</span>(response[index]);
        index++;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">clearInterval</span>(interval);
        <span class="hljs-title function_">onComplete</span>(response);
      }
    }, <span class="hljs-number">30</span>);  <span class="hljs-comment">// æ¯30msè¾“å‡ºä¸€ä¸ªå­—ç¬¦</span>
  }
}
</code></pre>
<h3 data-id="heading-9">4. è¯­éŸ³æœåŠ¡å°è£… (service/VoiceService.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/service/VoiceService.ets</span>

<span class="hljs-keyword">import</span> { speechRecognizer } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreSpeechKit'</span>;
<span class="hljs-keyword">import</span> { textToSpeech } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreSpeechKit'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;
<span class="hljs-keyword">import</span> { abilityAccessCtrl, <span class="hljs-title class_">Permissions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;

<span class="hljs-comment">/**
 * Vå“¥çš„è¯­éŸ³æœåŠ¡å°è£…
 * æ•´åˆASRè¯­éŸ³è¯†åˆ« + TTSè¯­éŸ³åˆæˆ
 */</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VoiceService</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">VoiceService</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">asrEngine</span>: speechRecognizer.<span class="hljs-property">SpeechRecognitionEngine</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">ttsEngine</span>: textToSpeech.<span class="hljs-property">TextToSpeechEngine</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">isListening</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {}

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getInstance</span>(): <span class="hljs-title class_">VoiceService</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">VoiceService</span>.<span class="hljs-property">instance</span>) {
      <span class="hljs-title class_">VoiceService</span>.<span class="hljs-property">instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VoiceService</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">VoiceService</span>.<span class="hljs-property">instance</span>;
  }

  <span class="hljs-comment">/**
   * è¯·æ±‚éº¦å…‹é£æƒé™
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">requestPermission</span>(<span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {
    <span class="hljs-keyword">const</span> atManager = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();
    <span class="hljs-keyword">const</span> <span class="hljs-attr">permissions</span>: <span class="hljs-title class_">Permissions</span>[] = [<span class="hljs-string">'ohos.permission.MICROPHONE'</span>];

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> atManager.<span class="hljs-title function_">requestPermissionsFromUser</span>(context, permissions);
      <span class="hljs-keyword">const</span> granted = result.<span class="hljs-property">authResults</span>.<span class="hljs-title function_">every</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r === abilityAccessCtrl.<span class="hljs-property">GrantStatus</span>.<span class="hljs-property">PERMISSION_GRANTED</span>);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[VoiceService] éº¦å…‹é£æƒé™: <span class="hljs-subst">${granted ? <span class="hljs-string">'å·²æˆæƒ'</span> : <span class="hljs-string">'è¢«æ‹’ç»'</span>}</span>`</span>);
      <span class="hljs-keyword">return</span> granted;
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[VoiceService] è¯·æ±‚æƒé™å¤±è´¥:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-comment">/**
   * åˆå§‹åŒ–è¯­éŸ³è¯†åˆ«å¼•æ“
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">initASR</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> <span class="hljs-attr">createParams</span>: speechRecognizer.<span class="hljs-property">CreateEngineParams</span> = {
        <span class="hljs-attr">language</span>: <span class="hljs-string">'zh-CN'</span>,
        <span class="hljs-attr">online</span>: <span class="hljs-number">1</span>  <span class="hljs-comment">// 1-åœ¨çº¿è¯†åˆ« 0-ç¦»çº¿è¯†åˆ«</span>
      };

      <span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span> = <span class="hljs-keyword">await</span> speechRecognizer.<span class="hljs-title function_">createEngine</span>(createParams);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[VoiceService] ASRå¼•æ“åˆå§‹åŒ–æˆåŠŸ'</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-keyword">const</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[VoiceService] ASRåˆå§‹åŒ–å¤±è´¥: <span class="hljs-subst">${error.code}</span> - <span class="hljs-subst">${error.message}</span>`</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-comment">/**
   * åˆå§‹åŒ–è¯­éŸ³åˆæˆå¼•æ“
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">initTTS</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> <span class="hljs-attr">createParams</span>: textToSpeech.<span class="hljs-property">CreateEngineParams</span> = {
        <span class="hljs-attr">language</span>: <span class="hljs-string">'zh-CN'</span>,
        <span class="hljs-attr">person</span>: <span class="hljs-number">0</span>,  <span class="hljs-comment">// å‘éŸ³äºº</span>
        <span class="hljs-attr">online</span>: <span class="hljs-number">1</span>   <span class="hljs-comment">// 1-åœ¨çº¿åˆæˆ 0-ç¦»çº¿åˆæˆ</span>
      };

      <span class="hljs-keyword">const</span> <span class="hljs-attr">extraParams</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Object</span>&gt; = {
        <span class="hljs-attr">style</span>: <span class="hljs-string">'normal'</span>,
        <span class="hljs-attr">speed</span>: <span class="hljs-number">1.0</span>,
        <span class="hljs-attr">volume</span>: <span class="hljs-number">1.0</span>,
        <span class="hljs-attr">pitch</span>: <span class="hljs-number">1.0</span>
      };

      <span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span> = <span class="hljs-keyword">await</span> textToSpeech.<span class="hljs-title function_">createEngine</span>(createParams);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[VoiceService] TTSå¼•æ“åˆå§‹åŒ–æˆåŠŸ'</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-keyword">const</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[VoiceService] TTSåˆå§‹åŒ–å¤±è´¥: <span class="hljs-subst">${error.code}</span> - <span class="hljs-subst">${error.message}</span>`</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-comment">/**
   * å¼€å§‹è¯­éŸ³è¯†åˆ«
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">startListening</span>(
    <span class="hljs-attr">onResult</span>: <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span>, isFinal: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>,
    <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">error: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span>) {
      <span class="hljs-keyword">const</span> success = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initASR</span>();
      <span class="hljs-keyword">if</span> (!success) {
        <span class="hljs-title function_">onError</span>(<span class="hljs-string">'è¯­éŸ³è¯†åˆ«å¼•æ“åˆå§‹åŒ–å¤±è´¥'</span>);
        <span class="hljs-keyword">return</span>;
      }
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isListening</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'[VoiceService] å·²ç»åœ¨ç›‘å¬ä¸­'</span>);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è®¾ç½®å›è°ƒ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span>!.<span class="hljs-title function_">setListener</span>({
        <span class="hljs-attr">onStart</span>: <span class="hljs-function">(<span class="hljs-params">sessionId: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[VoiceService] å¼€å§‹è¯†åˆ«, sessionId: <span class="hljs-subst">${sessionId}</span>`</span>);
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">isListening</span> = <span class="hljs-literal">true</span>;
        },
        <span class="hljs-attr">onEvent</span>: <span class="hljs-function">(<span class="hljs-params">sessionId: <span class="hljs-built_in">string</span>, eventCode: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[VoiceService] äº‹ä»¶: <span class="hljs-subst">${eventCode}</span>`</span>);
        },
        <span class="hljs-attr">onResult</span>: <span class="hljs-function">(<span class="hljs-params">sessionId: <span class="hljs-built_in">string</span>, result: speechRecognizer.SpeechRecognitionResult</span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> text = result.<span class="hljs-property">result</span>;
          <span class="hljs-keyword">const</span> isFinal = result.<span class="hljs-property">isFinal</span>;
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[VoiceService] è¯†åˆ«ç»“æœ: <span class="hljs-subst">${text}</span>, isFinal: <span class="hljs-subst">${isFinal}</span>`</span>);
          <span class="hljs-title function_">onResult</span>(text, isFinal);
        },
        <span class="hljs-attr">onComplete</span>: <span class="hljs-function">(<span class="hljs-params">sessionId: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[VoiceService] è¯†åˆ«å®Œæˆ`</span>);
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">isListening</span> = <span class="hljs-literal">false</span>;
        },
        <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">sessionId: <span class="hljs-built_in">string</span>, errorCode: <span class="hljs-built_in">number</span>, errorMessage: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[VoiceService] è¯†åˆ«é”™è¯¯: <span class="hljs-subst">${errorCode}</span> - <span class="hljs-subst">${errorMessage}</span>`</span>);
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">isListening</span> = <span class="hljs-literal">false</span>;
          <span class="hljs-title function_">onError</span>(errorMessage);
        }
      });

      <span class="hljs-comment">// å¼€å§‹è¯†åˆ«</span>
      <span class="hljs-keyword">const</span> <span class="hljs-attr">recognitionParams</span>: speechRecognizer.<span class="hljs-property">StartParams</span> = {
        <span class="hljs-attr">sessionId</span>: <span class="hljs-string">`session_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>,
        <span class="hljs-attr">audioInfo</span>: {
          <span class="hljs-attr">audioType</span>: <span class="hljs-string">'pcm'</span>,
          <span class="hljs-attr">sampleRate</span>: <span class="hljs-number">16000</span>,
          <span class="hljs-attr">soundChannel</span>: <span class="hljs-number">1</span>,
          <span class="hljs-attr">sampleBit</span>: <span class="hljs-number">16</span>
        },
        <span class="hljs-attr">extraParams</span>: {
          <span class="hljs-attr">vadBegin</span>: <span class="hljs-number">2000</span>,  <span class="hljs-comment">// é™éŸ³æ£€æµ‹å¼€å§‹æ—¶é—´</span>
          <span class="hljs-attr">vadEnd</span>: <span class="hljs-number">3000</span>,    <span class="hljs-comment">// é™éŸ³æ£€æµ‹ç»“æŸæ—¶é—´</span>
          <span class="hljs-attr">maxAudioDuration</span>: <span class="hljs-number">60000</span>  <span class="hljs-comment">// æœ€å¤§å½•éŸ³æ—¶é•¿</span>
        }
      };

      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span>!.<span class="hljs-title function_">startListening</span>(recognitionParams);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-keyword">const</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[VoiceService] å¼€å§‹è¯†åˆ«å¤±è´¥: <span class="hljs-subst">${error.code}</span> - <span class="hljs-subst">${error.message}</span>`</span>);
      <span class="hljs-title function_">onError</span>(error.<span class="hljs-property">message</span>);
    }
  }

  <span class="hljs-comment">/**
   * åœæ­¢è¯­éŸ³è¯†åˆ«
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">stopListening</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">isListening</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span>.<span class="hljs-title function_">finish</span>(<span class="hljs-string">`session_stop_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isListening</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[VoiceService] åœæ­¢è¯†åˆ«'</span>);
      } <span class="hljs-keyword">catch</span> (err) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[VoiceService] åœæ­¢è¯†åˆ«å¤±è´¥:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
      }
    }
  }

  <span class="hljs-comment">/**
   * è¯­éŸ³åˆæˆï¼ˆæ–‡å­—è½¬è¯­éŸ³ï¼‰
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">speak</span>(<span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span>, onComplete?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span>) {
      <span class="hljs-keyword">const</span> success = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initTTS</span>();
      <span class="hljs-keyword">if</span> (!success) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[VoiceService] TTSå¼•æ“ä¸å¯ç”¨'</span>);
        onComplete?.();
        <span class="hljs-keyword">return</span>;
      }
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è®¾ç½®å›è°ƒ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span>!.<span class="hljs-title function_">setListener</span>({
        <span class="hljs-attr">onStart</span>: <span class="hljs-function">(<span class="hljs-params">requestId: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[VoiceService] å¼€å§‹æ’­æ”¾, requestId: <span class="hljs-subst">${requestId}</span>`</span>);
        },
        <span class="hljs-attr">onProgress</span>: <span class="hljs-function">(<span class="hljs-params">requestId: <span class="hljs-built_in">string</span>, progress: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
          <span class="hljs-comment">// æ’­æ”¾è¿›åº¦</span>
        },
        <span class="hljs-attr">onFinish</span>: <span class="hljs-function">(<span class="hljs-params">requestId: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[VoiceService] æ’­æ”¾å®Œæˆ`</span>);
          onComplete?.();
        },
        <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">requestId: <span class="hljs-built_in">string</span>, errorCode: <span class="hljs-built_in">number</span>, errorMessage: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[VoiceService] æ’­æ”¾é”™è¯¯: <span class="hljs-subst">${errorCode}</span> - <span class="hljs-subst">${errorMessage}</span>`</span>);
          onComplete?.();
        }
      });

      <span class="hljs-comment">// åˆæˆå‚æ•°</span>
      <span class="hljs-keyword">const</span> <span class="hljs-attr">speakParams</span>: textToSpeech.<span class="hljs-property">SpeakParams</span> = {
        <span class="hljs-attr">requestId</span>: <span class="hljs-string">`speak_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>,
        <span class="hljs-attr">extraParams</span>: {
          <span class="hljs-attr">speed</span>: <span class="hljs-number">1.0</span>,
          <span class="hljs-attr">volume</span>: <span class="hljs-number">1.0</span>,
          <span class="hljs-attr">pitch</span>: <span class="hljs-number">1.0</span>
        }
      };

      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span>!.<span class="hljs-title function_">speak</span>(text, speakParams);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-keyword">const</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[VoiceService] è¯­éŸ³åˆæˆå¤±è´¥: <span class="hljs-subst">${error.code}</span> - <span class="hljs-subst">${error.message}</span>`</span>);
      onComplete?.();
    }
  }

  <span class="hljs-comment">/**
   * åœæ­¢è¯­éŸ³æ’­æ”¾
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">stopSpeaking</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span>.<span class="hljs-title function_">stop</span>();
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[VoiceService] åœæ­¢æ’­æ”¾'</span>);
      } <span class="hljs-keyword">catch</span> (err) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[VoiceService] åœæ­¢æ’­æ”¾å¤±è´¥:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
      }
    }
  }

  <span class="hljs-comment">/**
   * é‡Šæ”¾èµ„æº
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">release</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span>) {
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span>.<span class="hljs-title function_">shutdown</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">asrEngine</span> = <span class="hljs-literal">null</span>;
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span>) {
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span>.<span class="hljs-title function_">shutdown</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ttsEngine</span> = <span class="hljs-literal">null</span>;
      }
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[VoiceService] èµ„æºé‡Šæ”¾å®Œæˆ'</span>);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[VoiceService] é‡Šæ”¾èµ„æºå¤±è´¥:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));
    }
  }

  <span class="hljs-comment">/**
   * è·å–ç›‘å¬çŠ¶æ€
   */</span>
  <span class="hljs-title function_">getListeningState</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">isListening</span>;
  }
}
</code></pre>
<h3 data-id="heading-10">5. ä»»åŠ¡æ‰§è¡Œå™¨ (engine/ActionExecutor.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/engine/ActionExecutor.ets</span>

<span class="hljs-keyword">import</span> { bundleManager, common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">IntentType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../model/MessageModel'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;

<span class="hljs-comment">/**
 * Vå“¥çš„ä»»åŠ¡æ‰§è¡Œå™¨
 * æ ¹æ®æ„å›¾æ‰§è¡Œå…·ä½“æ“ä½œ
 */</span>

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ActionResult</span> {
  <span class="hljs-attr">success</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>;
  data?: <span class="hljs-built_in">object</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ActionExecutor</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">ActionExecutor</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {}

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getInstance</span>(): <span class="hljs-title class_">ActionExecutor</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">ActionExecutor</span>.<span class="hljs-property">instance</span>) {
      <span class="hljs-title class_">ActionExecutor</span>.<span class="hljs-property">instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ActionExecutor</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">ActionExecutor</span>.<span class="hljs-property">instance</span>;
  }

  <span class="hljs-comment">/**
   * è®¾ç½®ä¸Šä¸‹æ–‡
   */</span>
  <span class="hljs-title function_">setContext</span>(<span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span> = context;
  }

  <span class="hljs-comment">/**
   * æ‰§è¡ŒåŠ¨ä½œ
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">execute</span>(<span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>, <span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ActionResult</span>&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[ActionExecutor] æ‰§è¡Œæ„å›¾: <span class="hljs-subst">${intent}</span>, å‚æ•°: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(params)}</span>`</span>);

    <span class="hljs-keyword">switch</span> (intent) {
      <span class="hljs-keyword">case</span> <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">OPEN_APP</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">openApp</span>(params);

      <span class="hljs-keyword">case</span> <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">SET_ALARM</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setAlarm</span>(params);

      <span class="hljs-keyword">case</span> <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">SET_REMINDER</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setReminder</span>(params);

      <span class="hljs-keyword">case</span> <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">QUERY_WEATHER</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">queryWeather</span>(params);

      <span class="hljs-keyword">case</span> <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">QUERY_TIME</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">queryTime</span>();

      <span class="hljs-keyword">case</span> <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">CONTROL_DEVICE</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">controlDevice</span>(params);

      <span class="hljs-attr">default</span>:
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">message</span>: <span class="hljs-string">'æš‚ä¸æ”¯æŒè¯¥æ“ä½œ'</span>
        };
    }
  }

  <span class="hljs-comment">/**
   * æ‰“å¼€åº”ç”¨
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">openApp</span>(<span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ActionResult</span>&gt; {
    <span class="hljs-keyword">const</span> bundleName = params.<span class="hljs-property">bundleName</span>;
    <span class="hljs-keyword">const</span> appName = params.<span class="hljs-property">appName</span>;

    <span class="hljs-keyword">if</span> (!bundleName) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">`æŠ±æ­‰ï¼Œæˆ‘ä¸çŸ¥é“æ€ä¹ˆæ‰“å¼€"<span class="hljs-subst">${appName || <span class="hljs-string">'è¿™ä¸ªåº”ç”¨'</span>}</span>"`</span>
      };
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {
        <span class="hljs-attr">bundleName</span>: bundleName,
        <span class="hljs-attr">action</span>: <span class="hljs-string">'action.system.home'</span>,
        <span class="hljs-attr">entities</span>: [<span class="hljs-string">'entity.system.home'</span>]
      };

      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>?.<span class="hljs-title function_">startAbility</span>(want);

      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">`å·²ä¸ºä½ æ‰“å¼€<span class="hljs-subst">${appName}</span>`</span>
      };
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-keyword">const</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[ActionExecutor] æ‰“å¼€åº”ç”¨å¤±è´¥: <span class="hljs-subst">${error.code}</span> - <span class="hljs-subst">${error.message}</span>`</span>);

      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">`æ‰“å¼€<span class="hljs-subst">${appName}</span>å¤±è´¥ï¼Œå¯èƒ½æ˜¯åº”ç”¨æœªå®‰è£…`</span>
      };
    }
  }

  <span class="hljs-comment">/**
   * è®¾ç½®é—¹é’Ÿ
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">setAlarm</span>(<span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ActionResult</span>&gt; {
    <span class="hljs-keyword">const</span> hour = <span class="hljs-built_in">parseInt</span>(params.<span class="hljs-property">hour</span> || <span class="hljs-string">'8'</span>);
    <span class="hljs-keyword">const</span> minute = <span class="hljs-built_in">parseInt</span>(params.<span class="hljs-property">minute</span> || <span class="hljs-string">'0'</span>);

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è°ƒç”¨ç³»ç»Ÿé—¹é’Ÿ</span>
      <span class="hljs-keyword">const</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {
        <span class="hljs-attr">action</span>: <span class="hljs-string">'ohos.want.action.setAlarm'</span>,
        <span class="hljs-attr">parameters</span>: {
          <span class="hljs-string">'ringtone'</span>: <span class="hljs-string">'default'</span>,
          <span class="hljs-string">'hour'</span>: hour,
          <span class="hljs-string">'minute'</span>: minute
        }
      };

      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>?.<span class="hljs-title function_">startAbility</span>(want);

      <span class="hljs-keyword">const</span> timeStr = <span class="hljs-string">`<span class="hljs-subst">${hour.toString().padStart(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)}</span>:<span class="hljs-subst">${minute.toString().padStart(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)}</span>`</span>;
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">`å¥½çš„ï¼Œå·²ä¸ºä½ è®¾ç½®<span class="hljs-subst">${timeStr}</span>çš„é—¹é’Ÿ`</span>
      };
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[ActionExecutor] è®¾ç½®é—¹é’Ÿå¤±è´¥:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));

      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">'è®¾ç½®é—¹é’Ÿå¤±è´¥ï¼Œè¯·æ‰‹åŠ¨è®¾ç½®'</span>
      };
    }
  }

  <span class="hljs-comment">/**
   * è®¾ç½®æé†’
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">setReminder</span>(<span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ActionResult</span>&gt; {
    <span class="hljs-keyword">const</span> content = params.<span class="hljs-property">content</span> || <span class="hljs-string">'æœªå‘½åæé†’'</span>;
    <span class="hljs-keyword">const</span> delayMinutes = <span class="hljs-built_in">parseInt</span>(params.<span class="hljs-property">delayMinutes</span> || <span class="hljs-string">'10'</span>);

    <span class="hljs-comment">// è¿™é‡Œå¯ä»¥æ¥å…¥å‰é¢çš„æ—¥ç¨‹æé†’æ¨¡å—</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">message</span>: <span class="hljs-string">`æ”¶åˆ°ï¼<span class="hljs-subst">${delayMinutes}</span>åˆ†é’Ÿåæé†’ä½ ï¼š<span class="hljs-subst">${content}</span>`</span>
    };
  }

  <span class="hljs-comment">/**
   * æŸ¥è¯¢å¤©æ°”
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">queryWeather</span>(<span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ActionResult</span>&gt; {
    <span class="hljs-keyword">const</span> city = params.<span class="hljs-property">city</span> || <span class="hljs-string">'åŒ—äº¬'</span>;

    <span class="hljs-comment">// å®é™…é¡¹ç›®ä¸­å¯¹æ¥å¤©æ°”API</span>
    <span class="hljs-comment">// è¿™é‡Œè¿”å›æ¨¡æ‹Ÿæ•°æ®</span>
    <span class="hljs-keyword">const</span> mockWeather = {
      <span class="hljs-attr">city</span>: city,
      <span class="hljs-attr">temperature</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">20</span>) + <span class="hljs-number">10</span>,
      <span class="hljs-attr">weather</span>: [<span class="hljs-string">'æ™´'</span>, <span class="hljs-string">'å¤šäº‘'</span>, <span class="hljs-string">'é˜´'</span>, <span class="hljs-string">'å°é›¨'</span>][<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">4</span>)],
      <span class="hljs-attr">humidity</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">40</span>) + <span class="hljs-number">40</span>
    };

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">message</span>: <span class="hljs-string">`<span class="hljs-subst">${city}</span>ä»Šå¤©<span class="hljs-subst">${mockWeather.weather}</span>ï¼Œæ°”æ¸©<span class="hljs-subst">${mockWeather.temperature}</span>Â°Cï¼Œæ¹¿åº¦<span class="hljs-subst">${mockWeather.humidity}</span>%`</span>,
      <span class="hljs-attr">data</span>: mockWeather
    };
  }

  <span class="hljs-comment">/**
   * æŸ¥è¯¢æ—¶é—´
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">queryTime</span>(): <span class="hljs-title class_">ActionResult</span> {
    <span class="hljs-keyword">const</span> now = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();
    <span class="hljs-keyword">const</span> weekDays = [<span class="hljs-string">'æ—¥'</span>, <span class="hljs-string">'ä¸€'</span>, <span class="hljs-string">'äºŒ'</span>, <span class="hljs-string">'ä¸‰'</span>, <span class="hljs-string">'å››'</span>, <span class="hljs-string">'äº”'</span>, <span class="hljs-string">'å…­'</span>];

    <span class="hljs-keyword">const</span> dateStr = <span class="hljs-string">`<span class="hljs-subst">${now.getFullYear()}</span>å¹´<span class="hljs-subst">${now.getMonth() + <span class="hljs-number">1</span>}</span>æœˆ<span class="hljs-subst">${now.getDate()}</span>æ—¥`</span>;
    <span class="hljs-keyword">const</span> weekStr = <span class="hljs-string">`æ˜ŸæœŸ<span class="hljs-subst">${weekDays[now.getDay()]}</span>`</span>;
    <span class="hljs-keyword">const</span> timeStr = <span class="hljs-string">`<span class="hljs-subst">${now.getHours().toString().padStart(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)}</span>:<span class="hljs-subst">${now.getMinutes().toString().padStart(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)}</span>`</span>;

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">message</span>: <span class="hljs-string">`ç°åœ¨æ˜¯<span class="hljs-subst">${dateStr}</span> <span class="hljs-subst">${weekStr}</span> <span class="hljs-subst">${timeStr}</span>`</span>
    };
  }

  <span class="hljs-comment">/**
   * æ§åˆ¶è®¾å¤‡
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">controlDevice</span>(<span class="hljs-attr">params</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ActionResult</span>&gt; {
    <span class="hljs-keyword">const</span> device = params.<span class="hljs-property">device</span> || <span class="hljs-string">'è®¾å¤‡'</span>;
    <span class="hljs-keyword">const</span> action = params.<span class="hljs-property">action</span> === <span class="hljs-string">'on'</span> ? <span class="hljs-string">'æ‰“å¼€'</span> : <span class="hljs-string">'å…³é—­'</span>;

    <span class="hljs-comment">// å®é™…é¡¹ç›®ä¸­å¯¹æ¥æ™ºèƒ½å®¶å±…API</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">message</span>: <span class="hljs-string">`å¥½çš„ï¼Œå·²<span class="hljs-subst">${action}</span><span class="hljs-subst">${device}</span>`</span>
    };
  }
}
</code></pre>
<h3 data-id="heading-11">6. AIæ™ºèƒ½ä½“æ ¸å¿ƒ (engine/AIAgent.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/engine/AIAgent.ets</span>

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Message</span>, <span class="hljs-title class_">MessageRole</span>, <span class="hljs-title class_">MessageType</span>, <span class="hljs-title class_">ConversationContext</span>, <span class="hljs-title class_">IntentType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../model/MessageModel'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">IntentEngine</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./IntentEngine'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ActionExecutor</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./ActionExecutor'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">LLMService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../service/LLMService'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">VoiceService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../service/VoiceService'</span>;

<span class="hljs-comment">/**
 * Vå“¥çš„AIæ™ºèƒ½ä½“æ ¸å¿ƒ
 * æ•´åˆæ‰€æœ‰èƒ½åŠ›ï¼Œå®ç°æ™ºèƒ½å¯¹è¯
 */</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AIAgent</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">AIAgent</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">ConversationContext</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">intentEngine</span>: <span class="hljs-title class_">IntentEngine</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">actionExecutor</span>: <span class="hljs-title class_">ActionExecutor</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">llmService</span>: <span class="hljs-title class_">LLMService</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">voiceService</span>: <span class="hljs-title class_">VoiceService</span>;

  <span class="hljs-comment">// å›è°ƒå‡½æ•°</span>
  <span class="hljs-keyword">private</span> onMessageCallback?: <span class="hljs-function">(<span class="hljs-params">message: Message</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-keyword">private</span> onStateChangeCallback?: <span class="hljs-function">(<span class="hljs-params">state: AgentState</span>) =&gt;</span> <span class="hljs-built_in">void</span>;

  <span class="hljs-keyword">private</span> <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConversationContext</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">intentEngine</span> = <span class="hljs-title class_">IntentEngine</span>.<span class="hljs-title function_">getInstance</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">actionExecutor</span> = <span class="hljs-title class_">ActionExecutor</span>.<span class="hljs-title function_">getInstance</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">llmService</span> = <span class="hljs-title class_">LLMService</span>.<span class="hljs-title function_">getInstance</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">voiceService</span> = <span class="hljs-title class_">VoiceService</span>.<span class="hljs-title function_">getInstance</span>();
  }

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getInstance</span>(): <span class="hljs-title class_">AIAgent</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">AIAgent</span>.<span class="hljs-property">instance</span>) {
      <span class="hljs-title class_">AIAgent</span>.<span class="hljs-property">instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AIAgent</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">AIAgent</span>.<span class="hljs-property">instance</span>;
  }

  <span class="hljs-comment">/**
   * è®¾ç½®æ¶ˆæ¯å›è°ƒ
   */</span>
  <span class="hljs-title function_">setOnMessage</span>(<span class="hljs-attr">callback</span>: <span class="hljs-function">(<span class="hljs-params">message: Message</span>) =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMessageCallback</span> = callback;
  }

  <span class="hljs-comment">/**
   * è®¾ç½®çŠ¶æ€å›è°ƒ
   */</span>
  <span class="hljs-title function_">setOnStateChange</span>(<span class="hljs-attr">callback</span>: <span class="hljs-function">(<span class="hljs-params">state: AgentState</span>) =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onStateChangeCallback</span> = callback;
  }

  <span class="hljs-comment">/**
   * å¤„ç†ç”¨æˆ·è¾“å…¥ï¼ˆæ ¸å¿ƒæ–¹æ³•ï¼‰
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">processInput</span>(<span class="hljs-attr">userInput</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (!userInput.<span class="hljs-title function_">trim</span>()) <span class="hljs-keyword">return</span>;

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[AIAgent] å¤„ç†ç”¨æˆ·è¾“å…¥: <span class="hljs-subst">${userInput}</span>`</span>);

    <span class="hljs-comment">// 1. åˆ›å»ºç”¨æˆ·æ¶ˆæ¯</span>
    <span class="hljs-keyword">const</span> userMessage = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>({
      <span class="hljs-attr">role</span>: <span class="hljs-title class_">MessageRole</span>.<span class="hljs-property">USER</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">MessageType</span>.<span class="hljs-property">TEXT</span>,
      <span class="hljs-attr">content</span>: userInput
    });
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">addMessage</span>(userMessage);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMessageCallback</span>?.(userMessage);

    <span class="hljs-comment">// 2. æ„å›¾è¯†åˆ«</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onStateChangeCallback</span>?.(<span class="hljs-title class_">AgentState</span>.<span class="hljs-property">THINKING</span>);
    <span class="hljs-keyword">const</span> { intent, params, confidence } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">intentEngine</span>.<span class="hljs-title function_">recognize</span>(userInput);

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`[AIAgent] æ„å›¾è¯†åˆ«: <span class="hljs-subst">${intent}</span>, ç½®ä¿¡åº¦: <span class="hljs-subst">${confidence}</span>`</span>);

    <span class="hljs-comment">// 3. æ ¹æ®æ„å›¾å†³å®šå¤„ç†æ–¹å¼</span>
    <span class="hljs-keyword">let</span> <span class="hljs-attr">response</span>: <span class="hljs-built_in">string</span>;

    <span class="hljs-keyword">if</span> (intent !== <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">CHAT</span> &amp;&amp; confidence &gt;= <span class="hljs-number">0.7</span>) {
      <span class="hljs-comment">// é«˜ç½®ä¿¡åº¦çš„åŠŸèƒ½æ„å›¾ï¼Œæ‰§è¡ŒåŠ¨ä½œ</span>
      userMessage.<span class="hljs-property">intent</span> = intent;
      userMessage.<span class="hljs-property">intentParams</span> = params;

      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">actionExecutor</span>.<span class="hljs-title function_">execute</span>(intent, params);
      response = result.<span class="hljs-property">message</span>;

      <span class="hljs-comment">// å¦‚æœæ˜¯éœ€è¦è¡¥å……ä¿¡æ¯çš„åœºæ™¯ï¼Œç»§ç»­è°ƒç”¨LLM</span>
      <span class="hljs-keyword">if</span> (!result.<span class="hljs-property">success</span> &amp;&amp; intent !== <span class="hljs-title class_">IntentType</span>.<span class="hljs-property">UNKNOWN</span>) {
        response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">llmService</span>.<span class="hljs-title function_">chat</span>(
          <span class="hljs-string">`ç”¨æˆ·è¯´"<span class="hljs-subst">${userInput}</span>"ï¼Œæˆ‘å°è¯•<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.getIntentDescription(intent)}</span>ä½†å¤±è´¥äº†ã€‚è¯·ç»™å‡ºå‹å¥½çš„å›å¤å’Œå»ºè®®ã€‚`</span>,
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>
        );
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// é—²èŠæˆ–ä½ç½®ä¿¡åº¦ï¼Œè°ƒç”¨å¤§æ¨¡å‹</span>
      response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">llmService</span>.<span class="hljs-title function_">chat</span>(userInput, <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>);
    }

    <span class="hljs-comment">// 4. åˆ›å»ºåŠ©æ‰‹å›å¤</span>
    <span class="hljs-keyword">const</span> assistantMessage = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>({
      <span class="hljs-attr">role</span>: <span class="hljs-title class_">MessageRole</span>.<span class="hljs-property">ASSISTANT</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">MessageType</span>.<span class="hljs-property">TEXT</span>,
      <span class="hljs-attr">content</span>: response
    });
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">addMessage</span>(assistantMessage);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onMessageCallback</span>?.(assistantMessage);

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onStateChangeCallback</span>?.(<span class="hljs-title class_">AgentState</span>.<span class="hljs-property">IDLE</span>);

    <span class="hljs-comment">// 5. è¯­éŸ³æ’­æŠ¥å›å¤</span>
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">voiceService</span>.<span class="hljs-title function_">speak</span>(response);
  }

  <span class="hljs-comment">/**
   * å¼€å§‹è¯­éŸ³è¾“å…¥
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">startVoiceInput</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onStateChangeCallback</span>?.(<span class="hljs-title class_">AgentState</span>.<span class="hljs-property">LISTENING</span>);

    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">voiceService</span>.<span class="hljs-title function_">startListening</span>(
      <span class="hljs-function">(<span class="hljs-params">text: <span class="hljs-built_in">string</span>, isFinal: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (isFinal &amp;&amp; text.<span class="hljs-title function_">trim</span>()) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processInput</span>(text);
        }
      },
      <span class="hljs-function">(<span class="hljs-params">error: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[AIAgent] è¯­éŸ³è¯†åˆ«é”™è¯¯:'</span>, error);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">onStateChangeCallback</span>?.(<span class="hljs-title class_">AgentState</span>.<span class="hljs-property">IDLE</span>);
      }
    );
  }

  <span class="hljs-comment">/**
   * åœæ­¢è¯­éŸ³è¾“å…¥
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">stopVoiceInput</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">voiceService</span>.<span class="hljs-title function_">stopListening</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onStateChangeCallback</span>?.(<span class="hljs-title class_">AgentState</span>.<span class="hljs-property">IDLE</span>);
  }

  <span class="hljs-comment">/**
   * è·å–å¯¹è¯å†å²
   */</span>
  <span class="hljs-title function_">getHistory</span>(): <span class="hljs-title class_">Message</span>[] {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">getHistory</span>();
  }

  <span class="hljs-comment">/**
   * æ¸…ç©ºå¯¹è¯
   */</span>
  <span class="hljs-title function_">clearHistory</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">clear</span>();
  }

  <span class="hljs-comment">/**
   * è·å–æ„å›¾æè¿°
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">getIntentDescription</span>(<span class="hljs-attr">intent</span>: <span class="hljs-title class_">IntentType</span>): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">descriptions</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-title class_">IntentType</span>, <span class="hljs-built_in">string</span>&gt; = {
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">OPEN_APP</span>]: <span class="hljs-string">'æ‰“å¼€åº”ç”¨'</span>,
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">SET_ALARM</span>]: <span class="hljs-string">'è®¾ç½®é—¹é’Ÿ'</span>,
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">SET_REMINDER</span>]: <span class="hljs-string">'è®¾ç½®æé†’'</span>,
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">QUERY_WEATHER</span>]: <span class="hljs-string">'æŸ¥è¯¢å¤©æ°”'</span>,
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">QUERY_TIME</span>]: <span class="hljs-string">'æŸ¥è¯¢æ—¶é—´'</span>,
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">CONTROL_DEVICE</span>]: <span class="hljs-string">'æ§åˆ¶è®¾å¤‡'</span>,
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">CHAT</span>]: <span class="hljs-string">'é—²èŠ'</span>,
      [<span class="hljs-title class_">IntentType</span>.<span class="hljs-property">UNKNOWN</span>]: <span class="hljs-string">'ç†è§£æ„å›¾'</span>
    };
    <span class="hljs-keyword">return</span> descriptions[intent] || <span class="hljs-string">'æ‰§è¡Œæ“ä½œ'</span>;
  }
}

<span class="hljs-comment">/**
 * æ™ºèƒ½ä½“çŠ¶æ€
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">AgentState</span> {
  <span class="hljs-variable constant_">IDLE</span> = <span class="hljs-string">'idle'</span>,           <span class="hljs-comment">// ç©ºé—²</span>
  <span class="hljs-variable constant_">LISTENING</span> = <span class="hljs-string">'listening'</span>, <span class="hljs-comment">// ç›‘å¬ä¸­</span>
  <span class="hljs-variable constant_">THINKING</span> = <span class="hljs-string">'thinking'</span>,   <span class="hljs-comment">// æ€è€ƒä¸­</span>
  <span class="hljs-variable constant_">SPEAKING</span> = <span class="hljs-string">'speaking'</span>    <span class="hljs-comment">// è¯´è¯ä¸­</span>
}
</code></pre>
<h3 data-id="heading-12">7. ä¸»ç•Œé¢ (pages/Index.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/pages/Index.ets</span>

<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Message</span>, <span class="hljs-title class_">MessageRole</span>, <span class="hljs-title class_">MessageType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../model/MessageModel'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AIAgent</span>, <span class="hljs-title class_">AgentState</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../engine/AIAgent'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ActionExecutor</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../engine/ActionExecutor'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">VoiceService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../service/VoiceService'</span>;
<span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;
<span class="hljs-keyword">import</span> { promptAction } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">messageList</span>: <span class="hljs-title class_">Message</span>[] = [];
  <span class="hljs-meta">@State</span> <span class="hljs-attr">inputText</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">agentState</span>: <span class="hljs-title class_">AgentState</span> = <span class="hljs-title class_">AgentState</span>.<span class="hljs-property">IDLE</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">isVoiceMode</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;

  <span class="hljs-keyword">private</span> <span class="hljs-attr">agent</span>: <span class="hljs-title class_">AIAgent</span> = <span class="hljs-title class_">AIAgent</span>.<span class="hljs-title function_">getInstance</span>();
  <span class="hljs-keyword">private</span> <span class="hljs-attr">voiceService</span>: <span class="hljs-title class_">VoiceService</span> = <span class="hljs-title class_">VoiceService</span>.<span class="hljs-title function_">getInstance</span>();
  <span class="hljs-keyword">private</span> <span class="hljs-attr">scroller</span>: <span class="hljs-title class_">Scroller</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scroller</span>();
  <span class="hljs-keyword">private</span> context = <span class="hljs-title function_">getContext</span>(<span class="hljs-variable language_">this</span>) <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-comment">// åˆå§‹åŒ–</span>
    <span class="hljs-title class_">ActionExecutor</span>.<span class="hljs-title function_">getInstance</span>().<span class="hljs-title function_">setContext</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>);

    <span class="hljs-comment">// è¯·æ±‚æƒé™</span>
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">voiceService</span>.<span class="hljs-title function_">requestPermission</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>);

    <span class="hljs-comment">// è®¾ç½®å›è°ƒ</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">agent</span>.<span class="hljs-title function_">setOnMessage</span>(<span class="hljs-function">(<span class="hljs-params">message: Message</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">messageList</span> = [...<span class="hljs-variable language_">this</span>.<span class="hljs-property">messageList</span>, message];
      <span class="hljs-comment">// æ»šåŠ¨åˆ°åº•éƒ¨</span>
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">scroller</span>.<span class="hljs-title function_">scrollEdge</span>(<span class="hljs-title class_">Edge</span>.<span class="hljs-property">Bottom</span>);
      }, <span class="hljs-number">100</span>);
    });

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">agent</span>.<span class="hljs-title function_">setOnStateChange</span>(<span class="hljs-function">(<span class="hljs-params">state: AgentState</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">agentState</span> = state;
    });

    <span class="hljs-comment">// æ·»åŠ æ¬¢è¿æ¶ˆæ¯</span>
    <span class="hljs-keyword">const</span> welcomeMessage = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>({
      <span class="hljs-attr">role</span>: <span class="hljs-title class_">MessageRole</span>.<span class="hljs-property">ASSISTANT</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-title class_">MessageType</span>.<span class="hljs-property">TEXT</span>,
      <span class="hljs-attr">content</span>: <span class="hljs-string">'ä½ å¥½ï¼æˆ‘æ˜¯å°VåŠ©æ‰‹ ğŸ¤–\n\næˆ‘å¯ä»¥å¸®ä½ ï¼š\nâ€¢ å›ç­”å„ç§é—®é¢˜\nâ€¢ æ‰“å¼€åº”ç”¨\nâ€¢ è®¾ç½®é—¹é’Ÿå’Œæé†’\nâ€¢ æŸ¥è¯¢å¤©æ°”å’Œæ—¶é—´\nâ€¢ æ§åˆ¶æ™ºèƒ½è®¾å¤‡\n\nè¯•ç€å¯¹æˆ‘è¯´ç‚¹ä»€ä¹ˆå§ï¼'</span>
    });
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messageList</span>.<span class="hljs-title function_">push</span>(welcomeMessage);
  }

  <span class="hljs-comment">/**
   * å‘é€æ¶ˆæ¯
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">sendMessage</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">inputText</span>.<span class="hljs-title function_">trim</span>()) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> text = <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputText</span>.<span class="hljs-title function_">trim</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputText</span> = <span class="hljs-string">''</span>;

    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">agent</span>.<span class="hljs-title function_">processInput</span>(text);
  }

  <span class="hljs-comment">/**
   * åˆ‡æ¢è¯­éŸ³æ¨¡å¼
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">toggleVoiceMode</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isVoiceMode</span>) {
      <span class="hljs-comment">// åœæ­¢è¯­éŸ³è¾“å…¥</span>
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">agent</span>.<span class="hljs-title function_">stopVoiceInput</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isVoiceMode</span> = <span class="hljs-literal">false</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// å¼€å§‹è¯­éŸ³è¾“å…¥</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isVoiceMode</span> = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">agent</span>.<span class="hljs-title function_">startVoiceInput</span>();
    }
  }

  <span class="hljs-comment">/**
   * è·å–çŠ¶æ€æ–‡æœ¬
   */</span>
  <span class="hljs-title function_">getStateText</span>(): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">switch</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">agentState</span>) {
      <span class="hljs-keyword">case</span> <span class="hljs-title class_">AgentState</span>.<span class="hljs-property">LISTENING</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'æ­£åœ¨å¬...'</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-title class_">AgentState</span>.<span class="hljs-property">THINKING</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'æ€è€ƒä¸­...'</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-title class_">AgentState</span>.<span class="hljs-property">SPEAKING</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'è¯´è¯ä¸­...'</span>;
      <span class="hljs-attr">default</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    }
  }

  <span class="hljs-comment">/**
   * æ ¼å¼åŒ–æ—¶é—´
   */</span>
  <span class="hljs-title function_">formatTime</span>(<span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(timestamp);
    <span class="hljs-keyword">const</span> hour = date.<span class="hljs-title function_">getHours</span>().<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>);
    <span class="hljs-keyword">const</span> minute = date.<span class="hljs-title function_">getMinutes</span>().<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">padStart</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${hour}</span>:<span class="hljs-subst">${minute}</span>`</span>;
  }

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-comment">// é¡¶éƒ¨æ ‡é¢˜æ </span>
      <span class="hljs-title class_">Row</span>() {
        <span class="hljs-title class_">Column</span>() {
          <span class="hljs-title class_">Text</span>(<span class="hljs-string">'å°VåŠ©æ‰‹'</span>)
            .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
            .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
            .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#333333'</span>)

          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">agentState</span> !== <span class="hljs-title class_">AgentState</span>.<span class="hljs-property">IDLE</span>) {
            <span class="hljs-title class_">Row</span>() {
              <span class="hljs-title class_">LoadingProgress</span>()
                .<span class="hljs-title function_">width</span>(<span class="hljs-number">14</span>)
                .<span class="hljs-title function_">height</span>(<span class="hljs-number">14</span>)
                .<span class="hljs-title function_">color</span>(<span class="hljs-string">'#007DFF'</span>)
              <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getStateText</span>())
                .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>)
                .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#007DFF'</span>)
                .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">4</span> })
            }
            .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">2</span> })
          }
        }
        .<span class="hljs-title function_">alignItems</span>(<span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Start</span>)

        <span class="hljs-title class_">Blank</span>()

        <span class="hljs-comment">// æ¸…ç©ºå¯¹è¯æŒ‰é’®</span>
        <span class="hljs-title class_">Button</span>() {
          <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.ic_clear'</span>))
            .<span class="hljs-title function_">width</span>(<span class="hljs-number">20</span>)
            .<span class="hljs-title function_">height</span>(<span class="hljs-number">20</span>)
            .<span class="hljs-title function_">fillColor</span>(<span class="hljs-string">'#666666'</span>)
        }
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">40</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)
        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F0F0F0'</span>)
        .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">20</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          promptAction.<span class="hljs-title function_">showDialog</span>({
            <span class="hljs-attr">title</span>: <span class="hljs-string">'æ¸…ç©ºå¯¹è¯'</span>,
            <span class="hljs-attr">message</span>: <span class="hljs-string">'ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å¯¹è¯è®°å½•å—ï¼Ÿ'</span>,
            <span class="hljs-attr">buttons</span>: [
              { <span class="hljs-attr">text</span>: <span class="hljs-string">'å–æ¶ˆ'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#666666'</span> },
              { <span class="hljs-attr">text</span>: <span class="hljs-string">'ç¡®å®š'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#007DFF'</span> }
            ]
          }).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
            <span class="hljs-keyword">if</span> (result.<span class="hljs-property">index</span> === <span class="hljs-number">1</span>) {
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">messageList</span> = [];
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">agent</span>.<span class="hljs-title function_">clearHistory</span>();
            }
          });
        })
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">height</span>(<span class="hljs-number">60</span>)
      .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">16</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">16</span> })
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)

      <span class="hljs-comment">// æ¶ˆæ¯åˆ—è¡¨</span>
      <span class="hljs-title class_">List</span>({ <span class="hljs-attr">scroller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">scroller</span>, <span class="hljs-attr">space</span>: <span class="hljs-number">16</span> }) {
        <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">messageList</span>, <span class="hljs-function">(<span class="hljs-params">message: Message</span>) =&gt;</span> {
          <span class="hljs-title class_">ListItem</span>() {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">MessageBubble</span>(message)
          }
        }, <span class="hljs-function">(<span class="hljs-params">message: Message</span>) =&gt;</span> message.<span class="hljs-property">id</span>)
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)
      .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">16</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">16</span>, <span class="hljs-attr">top</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">12</span> })
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F5F5F5'</span>)

      <span class="hljs-comment">// åº•éƒ¨è¾“å…¥åŒºåŸŸ</span>
      <span class="hljs-title class_">Row</span>() {
        <span class="hljs-comment">// è¯­éŸ³æŒ‰é’®</span>
        <span class="hljs-title class_">Button</span>() {
          <span class="hljs-title class_">Image</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isVoiceMode</span> ? $r(<span class="hljs-string">'app.media.ic_keyboard'</span>) : $r(<span class="hljs-string">'app.media.ic_voice'</span>))
            .<span class="hljs-title function_">width</span>(<span class="hljs-number">24</span>)
            .<span class="hljs-title function_">height</span>(<span class="hljs-number">24</span>)
            .<span class="hljs-title function_">fillColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isVoiceMode</span> ? <span class="hljs-string">'#FF3B30'</span> : <span class="hljs-string">'#666666'</span>)
        }
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">44</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">44</span>)
        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isVoiceMode</span> ? <span class="hljs-string">'#FFE5E5'</span> : <span class="hljs-string">'#F0F0F0'</span>)
        .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">22</span>)
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">toggleVoiceMode</span>())

        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isVoiceMode</span>) {
          <span class="hljs-comment">// è¯­éŸ³è¾“å…¥çŠ¶æ€</span>
          <span class="hljs-title class_">Column</span>() {
            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">agentState</span> === <span class="hljs-title class_">AgentState</span>.<span class="hljs-property">LISTENING</span>) {
              <span class="hljs-title class_">Row</span>() {
                <span class="hljs-title class_">ForEach</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>], <span class="hljs-function">(<span class="hljs-params">i: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
                  <span class="hljs-title class_">Column</span>()
                    .<span class="hljs-title function_">width</span>(<span class="hljs-number">4</span>)
                    .<span class="hljs-title function_">height</span>(<span class="hljs-number">12</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">20</span>)
                    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#007DFF'</span>)
                    .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">2</span>)
                    .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">4</span> })
                    .<span class="hljs-title function_">animation</span>({
                      <span class="hljs-attr">duration</span>: <span class="hljs-number">300</span>,
                      <span class="hljs-attr">iterations</span>: -<span class="hljs-number">1</span>,
                      <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">EaseInOut</span>
                    })
                })
              }
              .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)
            }

            <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">agentState</span> === <span class="hljs-title class_">AgentState</span>.<span class="hljs-property">LISTENING</span> ? <span class="hljs-string">'æ­£åœ¨è†å¬...'</span> : <span class="hljs-string">'ç‚¹å‡»éº¦å…‹é£å¼€å§‹è¯´è¯'</span>)
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)
              .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#666666'</span>)
              .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">8</span> })
          }
          .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">44</span>)
          .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-comment">// æ–‡å­—è¾“å…¥æ¡†</span>
          <span class="hljs-title class_">TextInput</span>({ <span class="hljs-attr">placeholder</span>: <span class="hljs-string">'è¾“å…¥æ¶ˆæ¯...'</span>, <span class="hljs-attr">text</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputText</span> })
            .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)
            .<span class="hljs-title function_">height</span>(<span class="hljs-number">44</span>)
            .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F5F5F5'</span>)
            .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">22</span>)
            .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">16</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">16</span> })
            .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">8</span> })
            .<span class="hljs-title function_">onChange</span>(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputText</span> = value;
            })
            .<span class="hljs-title function_">onSubmit</span>(<span class="hljs-function">() =&gt;</span> {
              <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendMessage</span>();
            })

          <span class="hljs-comment">// å‘é€æŒ‰é’®</span>
          <span class="hljs-title class_">Button</span>() {
            <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.ic_send'</span>))
              .<span class="hljs-title function_">width</span>(<span class="hljs-number">24</span>)
              .<span class="hljs-title function_">height</span>(<span class="hljs-number">24</span>)
              .<span class="hljs-title function_">fillColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
          }
          .<span class="hljs-title function_">width</span>(<span class="hljs-number">44</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">44</span>)
          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">inputText</span>.<span class="hljs-title function_">trim</span>() ? <span class="hljs-string">'#007DFF'</span> : <span class="hljs-string">'#CCCCCC'</span>)
          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">22</span>)
          .<span class="hljs-title function_">enabled</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">inputText</span>.<span class="hljs-title function_">trim</span>().<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>)
          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendMessage</span>())
        }
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">height</span>(<span class="hljs-number">70</span>)
      .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">top</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">16</span> })
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
  }

  <span class="hljs-comment">/**
   * æ¶ˆæ¯æ°”æ³¡ç»„ä»¶
   */</span>
  <span class="hljs-meta">@Builder</span>
  <span class="hljs-title class_">MessageBubble</span>(<span class="hljs-attr">message</span>: <span class="hljs-title class_">Message</span>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-keyword">if</span> (message.<span class="hljs-property">role</span> === <span class="hljs-title class_">MessageRole</span>.<span class="hljs-property">USER</span>) {
        <span class="hljs-comment">// ç”¨æˆ·æ¶ˆæ¯ï¼ˆå³ä¾§ï¼‰</span>
        <span class="hljs-title class_">Row</span>() {
          <span class="hljs-title class_">Blank</span>()

          <span class="hljs-title class_">Column</span>() {
            <span class="hljs-title class_">Text</span>(message.<span class="hljs-property">content</span>)
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">15</span>)
              .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
              .<span class="hljs-title function_">lineHeight</span>(<span class="hljs-number">22</span>)
          }
          .<span class="hljs-title function_">padding</span>(<span class="hljs-number">12</span>)
          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#007DFF'</span>)
          .<span class="hljs-title function_">borderRadius</span>({
            <span class="hljs-attr">topLeft</span>: <span class="hljs-number">16</span>,
            <span class="hljs-attr">topRight</span>: <span class="hljs-number">4</span>,
            <span class="hljs-attr">bottomLeft</span>: <span class="hljs-number">16</span>,
            <span class="hljs-attr">bottomRight</span>: <span class="hljs-number">16</span>
          })
          .<span class="hljs-title function_">constraintSize</span>({ <span class="hljs-attr">maxWidth</span>: <span class="hljs-string">'75%'</span> })

          <span class="hljs-comment">// ç”¨æˆ·å¤´åƒ</span>
          <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.ic_user'</span>))
            .<span class="hljs-title function_">width</span>(<span class="hljs-number">36</span>)
            .<span class="hljs-title function_">height</span>(<span class="hljs-number">36</span>)
            .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">18</span>)
            .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">8</span> })
        }
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">End</span>)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// AIæ¶ˆæ¯ï¼ˆå·¦ä¾§ï¼‰</span>
        <span class="hljs-title class_">Row</span>() {
          <span class="hljs-comment">// AIå¤´åƒ</span>
          <span class="hljs-title class_">Stack</span>() {
            <span class="hljs-title class_">Circle</span>()
              .<span class="hljs-title function_">width</span>(<span class="hljs-number">36</span>)
              .<span class="hljs-title function_">height</span>(<span class="hljs-number">36</span>)
              .<span class="hljs-title function_">fill</span>(<span class="hljs-string">'#E6F2FF'</span>)

            <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.ic_robot'</span>))
              .<span class="hljs-title function_">width</span>(<span class="hljs-number">24</span>)
              .<span class="hljs-title function_">height</span>(<span class="hljs-number">24</span>)
          }
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">right</span>: <span class="hljs-number">8</span> })

          <span class="hljs-title class_">Column</span>() {
            <span class="hljs-title class_">Text</span>(message.<span class="hljs-property">content</span>)
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">15</span>)
              .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#333333'</span>)
              .<span class="hljs-title function_">lineHeight</span>(<span class="hljs-number">22</span>)

            <span class="hljs-comment">// æ˜¾ç¤ºæ—¶é—´</span>
            <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatTime</span>(message.<span class="hljs-property">timestamp</span>))
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">11</span>)
              .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#999999'</span>)
              .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">4</span> })
          }
          .<span class="hljs-title function_">padding</span>(<span class="hljs-number">12</span>)
          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
          .<span class="hljs-title function_">borderRadius</span>({
            <span class="hljs-attr">topLeft</span>: <span class="hljs-number">4</span>,
            <span class="hljs-attr">topRight</span>: <span class="hljs-number">16</span>,
            <span class="hljs-attr">bottomLeft</span>: <span class="hljs-number">16</span>,
            <span class="hljs-attr">bottomRight</span>: <span class="hljs-number">16</span>
          })
          .<span class="hljs-title function_">constraintSize</span>({ <span class="hljs-attr">maxWidth</span>: <span class="hljs-string">'75%'</span> })
          .<span class="hljs-title function_">alignItems</span>(<span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Start</span>)
          .<span class="hljs-title function_">shadow</span>({
            <span class="hljs-attr">radius</span>: <span class="hljs-number">4</span>,
            <span class="hljs-attr">color</span>: <span class="hljs-string">'rgba(0,0,0,0.05)'</span>,
            <span class="hljs-attr">offsetX</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">offsetY</span>: <span class="hljs-number">2</span>
          })

          <span class="hljs-title class_">Blank</span>()
        }
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Start</span>)
      }
    }
  }
}
</code></pre>
<h3 data-id="heading-13">8. å¿«æ·æŒ‡ä»¤é¢æ¿ (components/QuickCommands.ets)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// entry/src/main/ets/components/QuickCommands.ets</span>

<span class="hljs-comment">/**
 * Vå“¥è®¾è®¡çš„å¿«æ·æŒ‡ä»¤é¢æ¿
 * æ–¹ä¾¿ç”¨æˆ·å¿«é€Ÿè§¦å‘å¸¸ç”¨åŠŸèƒ½
 */</span>

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">QuickCommand</span> {
  <span class="hljs-attr">icon</span>: <span class="hljs-title class_">Resource</span>;
  <span class="hljs-attr">label</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">command</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">color</span>: <span class="hljs-built_in">string</span>;
}

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">export</span> struct <span class="hljs-title class_">QuickCommands</span> {
  <span class="hljs-attr">onCommand</span>: <span class="hljs-function">(<span class="hljs-params">command: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-function">() =&gt;</span> {};

  <span class="hljs-keyword">private</span> <span class="hljs-attr">commands</span>: <span class="hljs-title class_">QuickCommand</span>[] = [
    { <span class="hljs-attr">icon</span>: $r(<span class="hljs-string">'app.media.ic_weather'</span>), <span class="hljs-attr">label</span>: <span class="hljs-string">'æŸ¥å¤©æ°”'</span>, <span class="hljs-attr">command</span>: <span class="hljs-string">'ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#FFB800'</span> },
    { <span class="hljs-attr">icon</span>: $r(<span class="hljs-string">'app.media.ic_time'</span>), <span class="hljs-attr">label</span>: <span class="hljs-string">'æŸ¥æ—¶é—´'</span>, <span class="hljs-attr">command</span>: <span class="hljs-string">'ç°åœ¨å‡ ç‚¹äº†'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#007DFF'</span> },
    { <span class="hljs-attr">icon</span>: $r(<span class="hljs-string">'app.media.ic_alarm'</span>), <span class="hljs-attr">label</span>: <span class="hljs-string">'è®¾é—¹é’Ÿ'</span>, <span class="hljs-attr">command</span>: <span class="hljs-string">'æ˜å¤©æ—©ä¸Š7ç‚¹å«æˆ‘èµ·åºŠ'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#34C759'</span> },
    { <span class="hljs-attr">icon</span>: $r(<span class="hljs-string">'app.media.ic_remind'</span>), <span class="hljs-attr">label</span>: <span class="hljs-string">'æé†’æˆ‘'</span>, <span class="hljs-attr">command</span>: <span class="hljs-string">'10åˆ†é’Ÿåæé†’æˆ‘å–æ°´'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#FF9500'</span> },
    { <span class="hljs-attr">icon</span>: $r(<span class="hljs-string">'app.media.ic_app'</span>), <span class="hljs-attr">label</span>: <span class="hljs-string">'æ‰“å¼€ç›¸æœº'</span>, <span class="hljs-attr">command</span>: <span class="hljs-string">'æ‰“å¼€ç›¸æœº'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#AF52DE'</span> },
    { <span class="hljs-attr">icon</span>: $r(<span class="hljs-string">'app.media.ic_home'</span>), <span class="hljs-attr">label</span>: <span class="hljs-string">'å¼€ç¯'</span>, <span class="hljs-attr">command</span>: <span class="hljs-string">'æ‰“å¼€å®¢å…çš„ç¯'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'#FF3B30'</span> }
  ];

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'å¿«æ·æŒ‡ä»¤'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#999999'</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">12</span> })

      <span class="hljs-title class_">Flex</span>({ <span class="hljs-attr">wrap</span>: <span class="hljs-title class_">FlexWrap</span>.<span class="hljs-property">Wrap</span>, <span class="hljs-attr">justifyContent</span>: <span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">SpaceBetween</span> }) {
        <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">commands</span>, <span class="hljs-function">(<span class="hljs-params">cmd: QuickCommand</span>) =&gt;</span> {
          <span class="hljs-title class_">Column</span>() {
            <span class="hljs-title class_">Stack</span>() {
              <span class="hljs-title class_">Circle</span>()
                .<span class="hljs-title function_">width</span>(<span class="hljs-number">44</span>)
                .<span class="hljs-title function_">height</span>(<span class="hljs-number">44</span>)
                .<span class="hljs-title function_">fill</span>(cmd.<span class="hljs-property">color</span>)
                .<span class="hljs-title function_">opacity</span>(<span class="hljs-number">0.15</span>)

              <span class="hljs-title class_">Image</span>(cmd.<span class="hljs-property">icon</span>)
                .<span class="hljs-title function_">width</span>(<span class="hljs-number">24</span>)
                .<span class="hljs-title function_">height</span>(<span class="hljs-number">24</span>)
                .<span class="hljs-title function_">fillColor</span>(cmd.<span class="hljs-property">color</span>)
            }

            <span class="hljs-title class_">Text</span>(cmd.<span class="hljs-property">label</span>)
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>)
              .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#666666'</span>)
              .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">6</span> })
          }
          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'30%'</span>)
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">16</span> })
          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onCommand</span>(cmd.<span class="hljs-property">command</span>);
          })
        })
      }
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">padding</span>(<span class="hljs-number">16</span>)
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
    .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">12</span>)
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-14">äº”ã€èµ„æºæ–‡ä»¶å‡†å¤‡</h2>
<h3 data-id="heading-15">éœ€è¦çš„å›¾æ ‡èµ„æº</h3>
<p>åœ¨ <code>entry/src/main/resources/base/media/</code> æ·»åŠ ä»¥ä¸‹å›¾æ ‡ï¼š</p>






































































<table><thead><tr><th>æ–‡ä»¶å</th><th>ç”¨é€”</th><th>å»ºè®®å°ºå¯¸</th></tr></thead><tbody><tr><td>ic_robot.svg</td><td>AIå¤´åƒ</td><td>48x48</td></tr><tr><td>ic_user.svg</td><td>ç”¨æˆ·å¤´åƒ</td><td>48x48</td></tr><tr><td>ic_send.svg</td><td>å‘é€æŒ‰é’®</td><td>24x24</td></tr><tr><td>ic_voice.svg</td><td>è¯­éŸ³æŒ‰é’®</td><td>24x24</td></tr><tr><td>ic_keyboard.svg</td><td>é”®ç›˜æŒ‰é’®</td><td>24x24</td></tr><tr><td>ic_clear.svg</td><td>æ¸…ç©ºæŒ‰é’®</td><td>24x24</td></tr><tr><td>ic_weather.svg</td><td>å¤©æ°”å›¾æ ‡</td><td>24x24</td></tr><tr><td>ic_time.svg</td><td>æ—¶é—´å›¾æ ‡</td><td>24x24</td></tr><tr><td>ic_alarm.svg</td><td>é—¹é’Ÿå›¾æ ‡</td><td>24x24</td></tr><tr><td>ic_remind.svg</td><td>æé†’å›¾æ ‡</td><td>24x24</td></tr><tr><td>ic_app.svg</td><td>åº”ç”¨å›¾æ ‡</td><td>24x24</td></tr><tr><td>ic_home.svg</td><td>æ™ºèƒ½å®¶å±…å›¾æ ‡</td><td>24x24</td></tr></tbody></table>
<h3 data-id="heading-16">ç¤ºä¾‹SVG</h3>
<p><strong>ic_robot.svg:</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">"0 0 48 48"</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/2000/svg"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"24"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"24"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"20"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"#007DFF"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"17"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"20"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"3"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"white"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"31"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"20"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"3"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"white"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M16 30 Q24 36 32 30"</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">"white"</span> <span class="hljs-attr">stroke-width</span>=<span class="hljs-string">"2"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"none"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">rect</span> <span class="hljs-attr">x</span>=<span class="hljs-string">"22"</span> <span class="hljs-attr">y</span>=<span class="hljs-string">"4"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"4"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"6"</span> <span class="hljs-attr">rx</span>=<span class="hljs-string">"2"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"#007DFF"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">circle</span> <span class="hljs-attr">cx</span>=<span class="hljs-string">"24"</span> <span class="hljs-attr">cy</span>=<span class="hljs-string">"4"</span> <span class="hljs-attr">r</span>=<span class="hljs-string">"3"</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">"#007DFF"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>
</code></pre>
<p><strong>ic_voice.svg:</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">"0 0 24 24"</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/2000/svg"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">d</span>=<span class="hljs-string">"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>
</code></pre>
<hr/>
<h2 data-id="heading-17">å…­ã€Vå“¥æ€»ç»“ï¼šå…³é”®æŠ€æœ¯ç‚¹</h2>
<h3 data-id="heading-18">1. æ„å›¾è¯†åˆ«çš„è®¾è®¡æ€è·¯</h3>
<pre><code class="hljs language-markdown" lang="markdown">ç”¨æˆ·è¾“å…¥ â†’ è§„åˆ™åŒ¹é…ï¼ˆå¿«é€Ÿï¼‰ â†’ é«˜ç½®ä¿¡åº¦ç›´æ¥æ‰§è¡Œ
<span class="hljs-code">                â†“
         ä½ç½®ä¿¡åº¦ â†’ è°ƒç”¨LLMå…œåº•
</span></code></pre>
<h3 data-id="heading-19">2. å¯¹è¯ç®¡ç†çš„æ ¸å¿ƒ</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å¤šè½®å¯¹è¯çš„å…³é”®ï¼šä¸Šä¸‹æ–‡ç®¡ç†</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ConversationContext</span> {
  <span class="hljs-attr">messages</span>: <span class="hljs-title class_">Message</span>[] = [];
  <span class="hljs-attr">maxHistory</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;  <span class="hljs-comment">// æ§åˆ¶å†å²é•¿åº¦ï¼Œé¿å…Tokenæµªè´¹</span>
}
</code></pre>
<h3 data-id="heading-20">3. è¯­éŸ³äº¤äº’çš„æœ€ä½³å®è·µ</h3>
<ul>
<li>å…ˆè¯·æ±‚æƒé™ï¼Œå†åˆå§‹åŒ–å¼•æ“</li>
<li>è¯­éŸ³è¯†åˆ«å’Œè¯­éŸ³åˆæˆç”¨å®Œè¦é‡Šæ”¾</li>
<li>åšå¥½é”™è¯¯å¤„ç†å’Œé™çº§æ–¹æ¡ˆ</li>
</ul>
<h3 data-id="heading-21">4. æ€§èƒ½ä¼˜åŒ–å»ºè®®</h3>
<ul>
<li>æ„å›¾è¯†åˆ«ç”¨æœ¬åœ°è§„åˆ™ï¼Œå¿«é€Ÿå“åº”</li>
<li>LLMè°ƒç”¨åšå¥½ç¼“å­˜å’Œé™æµ</li>
<li>æ¶ˆæ¯åˆ—è¡¨ä½¿ç”¨LazyForEachä¼˜åŒ–</li>
</ul>
<hr/>
<h2 data-id="heading-22">ä¸ƒã€Vå“¥å” ä¸¤å¥</h2>
<p>å…„å¼Ÿä»¬ï¼Œè¿™å¥—ä»£ç æ˜¯Vå“¥å®æˆ˜ä¸­æ€»ç»“å‡ºæ¥çš„ï¼Œå®Œæ•´å®ç°äº†ä¸€ä¸ªèƒ½ç”¨çš„AIæ™ºèƒ½ä½“ã€‚å½“ç„¶ï¼Œå®é™…é¡¹ç›®ä¸­ä½ è¿˜éœ€è¦ï¼š</p>
<ol>
<li><strong>æ¥å…¥çœŸå®çš„LLM API</strong>ï¼ˆæ›¿æ¢æ‰ç¤ºä¾‹é…ç½®ï¼‰</li>
<li><strong>å®Œå–„æ„å›¾è§„åˆ™åº“</strong>ï¼ˆæ ¹æ®ä½ çš„ä¸šåŠ¡åœºæ™¯ï¼‰</li>
<li><strong>æ¥å…¥çœŸå®çš„æ™ºèƒ½å®¶å±…API</strong></li>
<li><strong>åšå¥½å¼‚å¸¸å¤„ç†å’Œç”¨æˆ·å¼•å¯¼</strong></li>
</ol>
<p><strong>AIæ™ºèƒ½ä½“çš„æ ¸å¿ƒä¸æ˜¯æŠ€æœ¯å¤šç‰›é€¼ï¼Œè€Œæ˜¯ç”¨æˆ·ä½“éªŒåšå¾—å¥½ï¼</strong></p>
<hr/>
<p>å…³æ³¨Vå“¥ä¸è¿·è·¯ï¼å‰è¡Œè·¯ä¸Šä¸çŠ¯æ€µ!</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Linux å°ç¥ä¹‹è·¯ã€‘ç³»ç»Ÿç›‘æ§ & æ€§èƒ½åˆ†æç¥å™¨åˆé›†ï¼æœåŠ¡å™¨å¡æ…¢ / ç¨‹åºå´©æºƒä¸€é”®å®šä½]]></title>    <link>https://juejin.cn/post/7599868109085999146</link>    <guid>https://juejin.cn/post/7599868109085999146</guid>    <pubDate>2026-01-28T01:02:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599868109085999146" data-draft-id="7599843186203541546" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Linux å°ç¥ä¹‹è·¯ã€‘ç³»ç»Ÿç›‘æ§ &amp; æ€§èƒ½åˆ†æç¥å™¨åˆé›†ï¼æœåŠ¡å™¨å¡æ…¢ / ç¨‹åºå´©æºƒä¸€é”®å®šä½"/> <meta itemprop="keywords" content="åç«¯,Linux,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-28T01:02:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æ¨åŒå­¦66"/> <meta itemprop="url" content="https://juejin.cn/user/1189004976589664"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Linux å°ç¥ä¹‹è·¯ã€‘ç³»ç»Ÿç›‘æ§ &amp; æ€§èƒ½åˆ†æç¥å™¨åˆé›†ï¼æœåŠ¡å™¨å¡æ…¢ / ç¨‹åºå´©æºƒä¸€é”®å®šä½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1189004976589664/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æ¨åŒå­¦66
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T01:02:54.000Z" title="Wed Jan 28 2026 01:02:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ã€Linux å°ç¥ä¹‹è·¯ã€‘ç³»ç»Ÿç›‘æ§ &amp; æ€§èƒ½åˆ†æç¥å™¨åˆé›†ï¼æœåŠ¡å™¨å¡æ…¢ / ç¨‹åºå´©æºƒä¸€é”®å®šä½</h2>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ä¸“æ³¨ Linux æŠ€æœ¯åˆ†äº«çš„å°æ¨ã€‚ä¸Šä¸€ç¯‡ç»™å¤§å®¶æ‹†è§£äº†æ–‡æœ¬å¤„ç† â€œä¸‰å‰‘å®¢â€ï¼Œè§£å†³äº†æ—¥å¿—åˆ†æã€æ‰¹é‡ä¿®æ”¹çš„æ ¸å¿ƒéœ€æ±‚ã€‚ä»Šå¤©æ¥ç€ Linux å·¥å…·ç³»åˆ—ï¼Œèšç„¦å¼€å‘è€… / è¿ç»´æœ€å¤´ç–¼çš„ â€œæœåŠ¡å™¨å¡æ…¢â€â€œç¨‹åºå´©æºƒâ€â€œå†…å­˜æ³„æ¼â€ é—®é¢˜ï¼Œæ•´ç†å‡º 5 æ¬¾å¿…å­¦çš„ç³»ç»Ÿç›‘æ§ä¸æ€§èƒ½åˆ†æå·¥å…· â€”â€” ä»åŸºç¡€çš„ topã€htop åˆ°ä¸“ä¸šçš„ perfã€valgrindï¼Œç»“åˆå®æˆ˜åœºæ™¯æ•™ä½ æ€ä¹ˆç”¨å·¥å…· â€œçœ‹é€â€ ç³»ç»Ÿè¿è¡ŒçŠ¶æ€ï¼Œå¿«é€Ÿå®šä½é—®é¢˜æ ¹æºã€‚</p>
<h3 data-id="heading-1">ä¸€ã€å…ˆæ˜ç¡®ï¼šä¸åŒé—®é¢˜å¯¹åº”ä¸åŒå·¥å…·</h3>
<p>é‡åˆ°ç³»ç»Ÿæˆ–ç¨‹åºå¼‚å¸¸æ—¶ï¼Œä¸ç”¨ç›²ç›®å°è¯•å·¥å…·ï¼Œå…ˆåˆ¤æ–­é—®é¢˜ç±»å‹ï¼Œå†ç²¾å‡†é€‰æ‹©ï¼š</p>
<ul>
<li>æœåŠ¡å™¨æ•´ä½“å¡æ…¢ï¼ˆCPU / å†…å­˜å ç”¨é«˜ï¼‰ï¼šç”¨ top/htop å¿«é€ŸæŸ¥çœ‹å…¨å±€çŠ¶æ€ï¼›</li>
<li>ç¨‹åºå´©æºƒï¼ˆæ®µé”™è¯¯ã€æ ¸å¿ƒ dumpï¼‰ï¼šç”¨ gdb è°ƒè¯•å®šä½ä»£ç è¡Œï¼›</li>
<li>æ€§èƒ½ç“¶é¢ˆï¼ˆå‡½æ•°æ‰§è¡Œè€—æ—¶ã€èµ„æºæµªè´¹ï¼‰ï¼šç”¨ perf åˆ†æ CPU çƒ­ç‚¹ï¼›</li>
<li>å†…å­˜æ³„æ¼ï¼ˆé•¿æœŸè¿è¡Œåå†…å­˜æš´æ¶¨ï¼‰ï¼šç”¨ valgrind æ£€æµ‹éæ³•å†…å­˜æ“ä½œï¼›</li>
<li>ç£ç›˜ / IO å‹åŠ›å¤§ï¼ˆè¯»å†™æ…¢ï¼‰ï¼šç”¨ iostat/df æŸ¥çœ‹ç£ç›˜çŠ¶æ€ã€‚</li>
</ul>
<p>ä¸‹é¢æŒ‰ â€œå·¥å…· + åœºæ™¯ + å®æˆ˜å‘½ä»¤â€ çš„ç»“æ„ï¼Œé€ä¸ªæ‹†è§£æ¯æ¬¾å·¥å…·çš„æ ¸å¿ƒç”¨æ³•ï¼Œæ–°æ‰‹ç›´æ¥å¥—ç”¨ï¼</p>
<h3 data-id="heading-2">äºŒã€åŸºç¡€ç›‘æ§ï¼štop/htopï¼ˆå…¨å±€çŠ¶æ€ä¸€çœ¼çœ‹ç©¿ï¼‰</h3>
<p>top æ˜¯ Linux è‡ªå¸¦çš„åŸºç¡€ç›‘æ§å·¥å…·ï¼Œhtop æ˜¯å®ƒçš„å¢å¼ºç‰ˆï¼ˆç•Œé¢æ›´å‹å¥½ã€æ”¯æŒé¼ æ ‡æ“ä½œï¼‰ï¼Œä¸¤è€…éƒ½æ˜¯ â€œç¬¬ä¸€æ—¶é—´åˆ¤æ–­ç³»ç»ŸçŠ¶æ€â€ çš„é¦–é€‰ã€‚</p>
<h4 data-id="heading-3">1. topï¼šç³»ç»Ÿè‡ªå¸¦ï¼Œæ— é—¨æ§›ä½¿ç”¨</h4>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç›´æ¥è¿è¡Œï¼Œå®æ—¶åˆ·æ–°ç³»ç»ŸçŠ¶æ€ï¼ˆé»˜è®¤3ç§’åˆ·æ–°ä¸€æ¬¡ï¼‰</span>
top
</code></pre>
<h5 data-id="heading-4">æ ¸å¿ƒç•Œé¢è§£è¯»ï¼ˆé‡ç‚¹å…³æ³¨è¿™ 3 éƒ¨åˆ†ï¼‰</h5>
<ul>
<li>
<p>é¡¶éƒ¨ç³»ç»Ÿä¿¡æ¯ï¼š</p>
<ul>
<li><code>Cpu(s)</code>ï¼šCPU ä½¿ç”¨ç‡ï¼ˆus = ç”¨æˆ·è¿›ç¨‹å ç”¨ï¼Œsy = ç³»ç»Ÿå†…æ ¸å ç”¨ï¼Œid = ç©ºé—²ï¼‰ï¼›</li>
<li><code>Mem</code>ï¼šç‰©ç†å†…å­˜ä½¿ç”¨ï¼ˆtotal = æ€»å†…å­˜ï¼Œused = å·²ç”¨ï¼Œfree = ç©ºé—²ï¼Œbuff/cache = ç¼“å­˜ï¼‰ï¼›</li>
<li><code>Swap</code>ï¼šäº¤æ¢åˆ†åŒºä½¿ç”¨ï¼ˆSwap å ç”¨é«˜è¯´æ˜ç‰©ç†å†…å­˜ä¸è¶³ï¼Œä¼šå¯¼è‡´ç³»ç»Ÿå¡é¡¿ï¼‰ï¼›</li>
</ul>
</li>
<li>
<p>ä¸­é—´è¿›ç¨‹åˆ—è¡¨ï¼š</p>
<ul>
<li><code>PID</code>ï¼šè¿›ç¨‹ IDï¼ˆæ€æ­»è¿›ç¨‹ç”¨<code>kill -9 PID</code>ï¼‰ï¼›</li>
<li><code>%CPU</code>/<code>%MEM</code>ï¼šè¿›ç¨‹å ç”¨çš„ CPU / å†…å­˜ç™¾åˆ†æ¯”ï¼›</li>
<li><code>COMMAND</code>ï¼šè¿›ç¨‹åç§°ï¼ˆæ¯”å¦‚<code>java</code>ã€<code>gcc</code>ã€<code>nginx</code>ï¼‰ï¼›</li>
</ul>
</li>
<li>
<p>å¸¸ç”¨å¿«æ·é”®ï¼š</p>
<ul>
<li><code>P</code>ï¼šæŒ‰ CPU ä½¿ç”¨ç‡æ’åºï¼ˆæ‰¾å ç”¨ CPU æœ€é«˜çš„è¿›ç¨‹ï¼‰ï¼›</li>
<li><code>M</code>ï¼šæŒ‰å†…å­˜ä½¿ç”¨ç‡æ’åºï¼ˆæ‰¾å†…å­˜å¤§æˆ·ï¼‰ï¼›</li>
<li><code>k</code>ï¼šè¾“å…¥ PID æ€æ­»è¿›ç¨‹ï¼ˆæ— éœ€é€€å‡º topï¼‰ï¼›</li>
<li><code>q</code>ï¼šé€€å‡º topã€‚</li>
</ul>
</li>
</ul>
<h5 data-id="heading-5">å®æˆ˜åœºæ™¯ï¼šå¿«é€Ÿå®šä½é«˜å ç”¨è¿›ç¨‹</h5>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># 1. è¿è¡ŒtopåæŒ‰Pæ’åºï¼Œæ‰¾åˆ°CPUå ç”¨æœ€é«˜çš„è¿›ç¨‹ï¼ˆæ¯”å¦‚PID=1234ï¼‰</span>
<span class="hljs-comment"># 2. æŸ¥çœ‹è¯¥è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ï¼ˆæ¯”å¦‚æ˜¯å“ªä¸ªç¨‹åºï¼‰</span>
ps -ef | <span class="hljs-keyword">grep</span> <span class="hljs-number">1234</span>
<span class="hljs-comment"># 3. è‹¥ç¡®è®¤æ˜¯æ— ç”¨è¿›ç¨‹ï¼Œç›´æ¥æ€æ­»</span>
<span class="hljs-keyword">kill</span> -<span class="hljs-number">9</span> <span class="hljs-number">1234</span>
</code></pre>
<h4 data-id="heading-6">2. htopï¼šé¢œå€¼æ›´é«˜ï¼Œæ“ä½œæ›´å‹å¥½</h4>
<p>top çš„ç•Œé¢æ¯”è¾ƒç®€é™‹ï¼Œhtop ä¼˜åŒ–äº†æ˜¾ç¤ºæ•ˆæœï¼Œè¿˜æ”¯æŒé¼ æ ‡ç‚¹å‡»æ’åºï¼Œæ¨èå®‰è£…ä½¿ç”¨ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…htopï¼ˆUbuntu/Debianï¼‰</span>
sudo apt install htop
<span class="hljs-comment"># è¿è¡Œ</span>
htop
</code></pre>
<h5 data-id="heading-7">æ ¸å¿ƒä¼˜åŠ¿</h5>
<ul>
<li>æ”¯æŒé¼ æ ‡ç‚¹å‡»åˆ—åæ’åºï¼ˆæ¯”å¦‚ç‚¹å‡»<code>%CPU</code>æŒ‰ CPU æ’åºï¼‰ï¼›</li>
<li>è¿›ç¨‹é¢œè‰²åŒºåˆ†ï¼ˆä¸åŒç±»å‹è¿›ç¨‹æ˜¾ç¤ºä¸åŒé¢œè‰²ï¼Œæ›´ç›´è§‚ï¼‰ï¼›</li>
<li>æ”¯æŒæ¨ªå‘æ»šåŠ¨ï¼ŒæŸ¥çœ‹é•¿å‘½ä»¤è¡Œï¼›</li>
<li>å¿«æ·é”®æ›´ä¸°å¯Œï¼ˆ<code>F6</code>é€‰æ‹©æ’åºå­—æ®µï¼Œ<code>F9</code>ç›´æ¥é€‰æ‹©ä¿¡å·æ€æ­»è¿›ç¨‹ï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-8">å®æˆ˜åœºæ™¯ï¼šç›‘æ§åµŒå…¥å¼å¼€å‘æ¿çŠ¶æ€</h5>
<p>åµŒå…¥å¼å¼€å‘ä¸­ï¼Œç”¨ htop æŸ¥çœ‹å¼€å‘æ¿çš„ CPU / å†…å­˜å ç”¨ï¼Œé¿å…ç¨‹åºå ç”¨èµ„æºè¿‡é«˜å¯¼è‡´å´©æºƒï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç™»å½•å¼€å‘æ¿åè¿è¡Œhtop</span>
htop
<span class="hljs-comment"># é‡ç‚¹å…³æ³¨ï¼šåµŒå…¥å¼è®¾å¤‡å†…å­˜æœ‰é™ï¼Œè‹¥Memçš„usedå æ¯”è¶…è¿‡80%ï¼Œéœ€æ’æŸ¥å†…å­˜æ³„æ¼</span>
</code></pre>
<h3 data-id="heading-9">ä¸‰ã€ç¨‹åºè°ƒè¯•ï¼šgdbï¼ˆå´©æºƒé—®é¢˜ç²¾å‡†å®šä½ï¼‰</h3>
<p>ä¸Šä¸€ç¯‡æåˆ°è¿‡ gdb æ˜¯å‘½ä»¤è¡Œè°ƒè¯•ç¥å™¨ï¼Œå½“ç¨‹åºå‡ºç° â€œæ®µé”™è¯¯ï¼ˆSegmentation faultï¼‰â€â€œæ ¸å¿ƒ dumpâ€ æ—¶ï¼Œgdb èƒ½ç›´æ¥å®šä½åˆ°å‡ºé”™çš„ä»£ç è¡Œï¼Œæ˜¯ C/C++ å¼€å‘è€…å¿…å¤‡å·¥å…·ã€‚</p>
<h4 data-id="heading-10">1. æ ¸å¿ƒè°ƒè¯•æµç¨‹ï¼ˆå¿…è®°ï¼‰</h4>
<h5 data-id="heading-11">ï¼ˆ1ï¼‰ç”Ÿæˆå¯è°ƒè¯•æ–‡ä»¶</h5>
<p>ç¼–è¯‘æ—¶å¿…é¡»åŠ <code>-g</code>å‚æ•°ï¼Œå¦åˆ™ gdb æ— æ³•è·å–è°ƒè¯•ä¿¡æ¯ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># ç¼–è¯‘Cç¨‹åºï¼Œç”Ÿæˆå¯è°ƒå¼æ–‡ä»¶a.out</span>
gcc -g test.c -o a.<span class="hljs-keyword">out</span>
</code></pre>
<h5 data-id="heading-12">ï¼ˆ2ï¼‰å¯åŠ¨ gdb è°ƒè¯•</h5>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹å¼1ï¼šç›´æ¥å¯åŠ¨ç¨‹åºè°ƒè¯•</span>
gdb ./a.out
<span class="hljs-comment"># æ–¹å¼2ï¼šè°ƒè¯•å·²å´©æºƒçš„æ ¸å¿ƒdumpæ–‡ä»¶ï¼ˆéœ€å…ˆå¼€å¯core dumpï¼‰</span>
<span class="hljs-comment"># 1. å¼€å¯core dumpï¼ˆä¸´æ—¶ç”Ÿæ•ˆï¼‰</span>
<span class="hljs-built_in">ulimit</span> -c unlimited
<span class="hljs-comment"># 2. è¿è¡Œç¨‹åºï¼Œå´©æºƒåç”Ÿæˆcoreæ–‡ä»¶</span>
./a.out
<span class="hljs-comment"># 3. ç”¨gdbè°ƒè¯•coreæ–‡ä»¶</span>
gdb ./a.out core
</code></pre>
<h5 data-id="heading-13">ï¼ˆ3ï¼‰å¸¸ç”¨è°ƒè¯•å‘½ä»¤ï¼ˆå®æˆ˜é«˜é¢‘ï¼‰</h5>




























































<table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th><th>å®æˆ˜ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>list/l</code></td><td>æŸ¥çœ‹ä»£ç ï¼ˆé»˜è®¤å‰ 10 è¡Œï¼‰</td><td><code>l 15</code>ï¼ˆæŸ¥çœ‹ç¬¬ 15 è¡Œä¸Šä¸‹ 5 è¡Œï¼‰</td></tr><tr><td><code>break/b</code></td><td>è®¾ç½®æ–­ç‚¹</td><td><code>b 20</code>ï¼ˆåœ¨ç¬¬ 20 è¡Œè®¾æ–­ç‚¹ï¼‰</td></tr><tr><td><code>info b</code></td><td>æŸ¥çœ‹æ–­ç‚¹ä¿¡æ¯</td><td><code>info b</code>ï¼ˆåˆ—å‡ºæ‰€æœ‰æ–­ç‚¹ï¼‰</td></tr><tr><td><code>delete/d</code></td><td>åˆ é™¤æ–­ç‚¹</td><td><code>d 1</code>ï¼ˆåˆ é™¤ç¼–å·ä¸º 1 çš„æ–­ç‚¹ï¼‰</td></tr><tr><td><code>run/r</code></td><td>è¿è¡Œç¨‹åº</td><td><code>r</code>ï¼ˆå¯åŠ¨ç¨‹åºï¼Œé‡åˆ°æ–­ç‚¹åœæ­¢ï¼‰</td></tr><tr><td><code>next/n</code></td><td>å•æ­¥æ‰§è¡Œï¼ˆè·³è¿‡å‡½æ•°ï¼‰</td><td><code>n</code>ï¼ˆæ‰§è¡Œä¸‹ä¸€è¡Œï¼Œä¸è¿›å…¥å‡½æ•°ï¼‰</td></tr><tr><td><code>step/s</code></td><td>å•æ­¥æ‰§è¡Œï¼ˆè¿›å…¥å‡½æ•°ï¼‰</td><td><code>s</code>ï¼ˆæ‰§è¡Œä¸‹ä¸€è¡Œï¼Œè¿›å…¥å‡½æ•°å†…éƒ¨ï¼‰</td></tr><tr><td><code>print/p</code></td><td>æŸ¥çœ‹å˜é‡å€¼</td><td><code>p sum</code>ï¼ˆæŸ¥çœ‹å˜é‡ sum çš„å€¼ï¼‰</td></tr><tr><td><code>cont/c</code></td><td>ç»§ç»­è¿è¡Œ</td><td><code>c</code>ï¼ˆä»æ–­ç‚¹å¤„ç»§ç»­è¿è¡Œï¼‰</td></tr><tr><td><code>quit/q</code></td><td>é€€å‡º gdb</td><td><code>q</code></td></tr></tbody></table>
<h4 data-id="heading-14">2. å®æˆ˜åœºæ™¯ï¼šå®šä½æ®µé”™è¯¯</h4>
<p>ç¨‹åºè¿è¡Œæ—¶æç¤º â€œSegmentation faultâ€ï¼Œç”¨ gdb å¿«é€Ÿå®šä½ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ç¼–è¯‘å¯è°ƒå¼æ–‡ä»¶</span>
gcc -g segfault.c -o segfault
<span class="hljs-comment"># 2. å¯åŠ¨gdb</span>
gdb ./segfault
<span class="hljs-comment"># 3. è¿è¡Œç¨‹åº</span>
(gdb) r
<span class="hljs-comment"># 4. ç¨‹åºå´©æºƒåï¼Œgdbä¼šæ˜¾ç¤ºå‡ºé”™ä½ç½®</span>
<span class="hljs-comment"># æ¯”å¦‚æç¤ºï¼šProgram received signal SIGSEGV, Segmentation fault. åœ¨main () at segfault.c:12</span>
<span class="hljs-comment"># ç›´æ¥å®šä½åˆ°ç¬¬12è¡Œä»£ç æœ‰é—®é¢˜ï¼ˆæ¯”å¦‚æ•°ç»„è¶Šç•Œã€é‡æŒ‡é’ˆï¼‰</span>
</code></pre>
<h4 data-id="heading-15">3. åµŒå…¥å¼é€‚é…</h4>
<p>åµŒå…¥å¼å¼€å‘ä¸­ï¼Œè‹¥å¼€å‘æ¿æ”¯æŒï¼Œå¯é€šè¿‡ gdb è¿œç¨‹è°ƒè¯•ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¼€å‘æ¿ç«¯è¿è¡Œgdbserver</span>
gdbserver 192.168.0.100:1234 ./app
<span class="hljs-comment"># ä¸»æœºç«¯è¿è¡Œgdbï¼Œè¿æ¥å¼€å‘æ¿</span>
arm-linux-gnueabihf-gdb ./app
(gdb) target remote 192.168.0.100:1234
</code></pre>
<h3 data-id="heading-16">å››ã€æ€§èƒ½åˆ†æï¼šperfï¼ˆCPU çƒ­ç‚¹ç²¾å‡†æ•æ‰ï¼‰</h3>
<p>perf æ˜¯ Linux å†…æ ¸è‡ªå¸¦çš„æ€§èƒ½åˆ†æå·¥å…·ï¼Œèƒ½ç²¾å‡†æ•æ‰ CPU çƒ­ç‚¹ï¼ˆæ¯”å¦‚å“ªä¸ªå‡½æ•°å ç”¨ CPU æœ€å¤šï¼‰ï¼Œé€‚åˆä¼˜åŒ–ç¨‹åºæ€§èƒ½ã€è§£å†³ â€œç¨‹åºè¿è¡Œæ…¢â€ é—®é¢˜ã€‚</p>
<h4 data-id="heading-17">1. å®‰è£…ä¸åŸºç¡€ç”¨æ³•</h4>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…perfï¼ˆUbuntu/Debianï¼‰</span>
sudo apt install linux-tools-common
<span class="hljs-comment"># æŸ¥çœ‹perfæ”¯æŒçš„äº‹ä»¶</span>
perf list
</code></pre>
<h5 data-id="heading-18">æ ¸å¿ƒå‘½ä»¤ï¼šperf topï¼ˆå®æ—¶æŸ¥çœ‹ CPU çƒ­ç‚¹ï¼‰</h5>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®æ—¶æ˜¾ç¤ºå ç”¨CPUæœ€é«˜çš„å‡½æ•°/è¿›ç¨‹</span>
sudo perf top
</code></pre>
<h5 data-id="heading-19">ç•Œé¢è§£è¯»</h5>
<ul>
<li>ç¬¬ä¸€åˆ—<code>Overhead</code>ï¼šå‡½æ•°å ç”¨ CPU çš„ç™¾åˆ†æ¯”ï¼›</li>
<li>ç¬¬äºŒåˆ—<code>Shared</code>ï¼šå‡½æ•°æ‰€åœ¨çš„å…±äº«åº“ï¼›</li>
<li>ç¬¬ä¸‰åˆ—<code>Object</code>ï¼šå‡½æ•°æ‰€åœ¨çš„å¯æ‰§è¡Œæ–‡ä»¶ / åº“æ–‡ä»¶ï¼›</li>
<li>ç¬¬å››åˆ—<code>Symbol</code>ï¼šå‡½æ•°åï¼ˆæ ¸å¿ƒå…³æ³¨ï¼Œæ¯”å¦‚<code>main</code>ã€<code>printf</code>ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-20">2. è¿›é˜¶ç”¨æ³•ï¼šperf record/reportï¼ˆè¯¦ç»†åˆ†æï¼‰</h4>
<p><code>perf top</code>æ˜¯å®æ—¶æŸ¥çœ‹ï¼Œ<code>perf record</code>å¯ä»¥è®°å½•ç¨‹åºè¿è¡Œè¿‡ç¨‹ï¼Œåç»­ç”¨<code>perf report</code>ç”Ÿæˆè¯¦ç»†æŠ¥å‘Šï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. è®°å½•ç¨‹åºè¿è¡Œçš„æ€§èƒ½æ•°æ®ï¼ˆ-gè¡¨ç¤ºè®°å½•è°ƒç”¨æ ˆï¼‰</span>
sudo perf record -g ./a.out
<span class="hljs-comment"># 2. ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š</span>
sudo perf report
</code></pre>
<h5 data-id="heading-21">å®æˆ˜åœºæ™¯ï¼šä¼˜åŒ–åµŒå…¥å¼ç¨‹åºæ€§èƒ½</h5>
<p>åµŒå…¥å¼ç¨‹åºè¿è¡Œæ…¢ï¼Œç”¨ perf åˆ†æå“ªä¸ªå‡½æ•°å ç”¨ CPU æœ€å¤šï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. åœ¨å¼€å‘æ¿ä¸Šè®°å½•ç¨‹åºæ€§èƒ½æ•°æ®</span>
perf record -g ./sensor_app
<span class="hljs-comment"># 2. ç”ŸæˆæŠ¥å‘Š</span>
perf report
<span class="hljs-comment"># 3. è‹¥æŸå‡½æ•°ï¼ˆæ¯”å¦‚`data_process`ï¼‰å ç”¨CPUè¶…è¿‡50%ï¼Œéœ€ä¼˜åŒ–è¯¥å‡½æ•°çš„ç®—æ³•ï¼ˆæ¯”å¦‚å‡å°‘å¾ªç¯æ¬¡æ•°ã€é¿å…é‡å¤è®¡ç®—ï¼‰</span>
</code></pre>
<h4 data-id="heading-22">3. å…³é”®ä¼˜åŠ¿</h4>
<ul>
<li>å†…æ ¸çº§å·¥å…·ï¼Œæ€§èƒ½å¼€é”€å°ï¼ˆä¸å½±å“ç¨‹åºæ­£å¸¸è¿è¡Œï¼‰ï¼›</li>
<li>æ”¯æŒå¤šç§äº‹ä»¶ï¼ˆCPU å‘¨æœŸã€ç¼“å­˜å‘½ä¸­ã€åˆ†æ”¯é¢„æµ‹ç­‰ï¼‰ï¼›</li>
<li>å¯åˆ†æç”¨æˆ·æ€å’Œå†…æ ¸æ€ä»£ç ï¼ˆé€‚åˆè°ƒè¯•é©±åŠ¨ç¨‹åºï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-23">äº”ã€å†…å­˜æ£€æµ‹ï¼švalgrindï¼ˆå†…å­˜æ³„æ¼å…‹æ˜Ÿï¼‰</h3>
<p>å†…å­˜æ³„æ¼æ˜¯åµŒå…¥å¼å¼€å‘çš„ â€œé¡½ç–¾â€â€”â€” ç¨‹åºé•¿æœŸè¿è¡Œåå†…å­˜å ç”¨è¶Šæ¥è¶Šé«˜ï¼Œæœ€ç»ˆå´©æºƒã€‚valgrind çš„<code>memcheck</code>å·¥å…·èƒ½æ£€æµ‹å‡ºéæ³•å†…å­˜è®¿é—®ã€å†…å­˜æ³„æ¼ã€ä½¿ç”¨æœªåˆå§‹åŒ–å˜é‡ç­‰é—®é¢˜ã€‚</p>
<h4 data-id="heading-24">1. å®‰è£…ä¸åŸºç¡€ç”¨æ³•</h4>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å®‰è£…valgrindï¼ˆUbuntu/Debianï¼‰</span>
sudo apt install valgrind
<span class="hljs-comment"># æ£€æµ‹ç¨‹åºå†…å­˜é—®é¢˜ï¼ˆ--leak-check=fullè¡¨ç¤ºå…¨é¢æ£€æµ‹å†…å­˜æ³„æ¼ï¼‰</span>
valgrind <span class="hljs-attr">--leak-check</span>=full ./a.out
</code></pre>
<h4 data-id="heading-25">2. æ ¸å¿ƒæ£€æµ‹åŠŸèƒ½</h4>
<h5 data-id="heading-26">ï¼ˆ1ï¼‰å†…å­˜æ³„æ¼æ£€æµ‹</h5>
<p>ç¨‹åºè¿è¡Œç»“æŸåï¼Œvalgrind ä¼šæ˜¾ç¤º â€œdefinitely lostâ€ï¼ˆç¡®è®¤æ³„æ¼ï¼‰ã€â€œpossibly lostâ€ï¼ˆå¯èƒ½æ³„æ¼ï¼‰çš„å†…å­˜å¤§å°å’Œä½ç½®ï¼š</p>
<p>plaintext</p>
<pre><code class="hljs language-ini" lang="ini">==<span class="hljs-attr">1234</span>== LEAK SUMMARY:
==<span class="hljs-attr">1234</span>==    definitely lost: <span class="hljs-number">100</span> bytes in <span class="hljs-number">1</span> blocks
==<span class="hljs-attr">1234</span>==    indirectly lost: <span class="hljs-number">200</span> bytes in <span class="hljs-number">2</span> blocks
==<span class="hljs-attr">1234</span>==      possibly lost: <span class="hljs-number">0</span> bytes in <span class="hljs-number">0</span> blocks
</code></pre>
<h5 data-id="heading-27">ï¼ˆ2ï¼‰éæ³•å†…å­˜è®¿é—®æ£€æµ‹</h5>
<p>æ¯”å¦‚æ•°ç»„è¶Šç•Œã€ä½¿ç”¨é‡æŒ‡é’ˆã€é‡Šæ”¾åå†æ¬¡è®¿é—®å†…å­˜ç­‰ï¼Œvalgrind ä¼šç›´æ¥å®šä½åˆ°ä»£ç è¡Œï¼š</p>
<p>plaintext</p>
<pre><code class="hljs language-less" lang="less">==<span class="hljs-number">1234</span>== <span class="hljs-selector-tag">Invalid</span> <span class="hljs-selector-tag">write</span> <span class="hljs-selector-tag">of</span> <span class="hljs-selector-tag">size</span> <span class="hljs-number">4</span>
==<span class="hljs-number">1234</span>==    <span class="hljs-selector-tag">at</span> <span class="hljs-number">0</span><span class="hljs-selector-tag">x400523</span>: <span class="hljs-selector-tag">main</span> (test.<span class="hljs-attribute">c</span>:<span class="hljs-number">15</span>)
==<span class="hljs-number">1234</span>==  <span class="hljs-selector-tag">Address</span> <span class="hljs-number">0</span><span class="hljs-selector-tag">x5204040</span> <span class="hljs-selector-tag">is</span> <span class="hljs-number">0</span> <span class="hljs-selector-tag">bytes</span> <span class="hljs-selector-tag">after</span> <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">block</span> <span class="hljs-selector-tag">of</span> <span class="hljs-selector-tag">size</span> <span class="hljs-number">16</span> <span class="hljs-selector-tag">alloc</span>'<span class="hljs-selector-tag">d</span>
==<span class="hljs-number">1234</span>==    <span class="hljs-selector-tag">at</span> <span class="hljs-number">0</span><span class="hljs-selector-tag">x4C2DB8F</span>: <span class="hljs-selector-tag">malloc</span> (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==<span class="hljs-number">1234</span>==    <span class="hljs-selector-tag">by</span> <span class="hljs-number">0</span><span class="hljs-selector-tag">x400513</span>: <span class="hljs-selector-tag">main</span> (test.<span class="hljs-attribute">c</span>:<span class="hljs-number">10</span>)
</code></pre>
<p>æç¤ºç¬¬ 15 è¡Œæœ‰éæ³•å†™æ“ä½œï¼ŒåŸå› æ˜¯ç¬¬ 10 è¡Œ<code>malloc</code>åˆ†é…çš„å†…å­˜åªæœ‰ 16 å­—èŠ‚ï¼Œç¬¬ 15 è¡Œè®¿é—®äº†è¶…å‡ºèŒƒå›´çš„åœ°å€ã€‚</p>
<h4 data-id="heading-28">3. å®æˆ˜åœºæ™¯ï¼šåµŒå…¥å¼ç¨‹åºå†…å­˜æ£€æµ‹</h4>
<p>åµŒå…¥å¼è®¾å¤‡å†…å­˜æœ‰é™ï¼Œå†…å­˜æ³„æ¼ä¼šç›´æ¥å¯¼è‡´ç¨‹åºå´©æºƒï¼Œç”¨ valgrind æå‰æ£€æµ‹ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ£€æµ‹åµŒå…¥å¼ç¨‹åºï¼ˆéœ€äº¤å‰ç¼–è¯‘valgrindï¼Œæˆ–åœ¨ä»¿çœŸç¯å¢ƒä¸­è¿è¡Œï¼‰</span>
valgrind <span class="hljs-attr">--leak-check</span>=full ./embedded_app
<span class="hljs-comment"># é‡ç‚¹å…³æ³¨ï¼šdefinitely lostå¿…é¡»ä¸º0ï¼Œå¦åˆ™éœ€æ’æŸ¥malloc/freeæ˜¯å¦é…å¯¹</span>
</code></pre>
<h3 data-id="heading-29">å…­ã€ç£ç›˜ / IO ç›‘æ§ï¼šiostat/dfï¼ˆè¯»å†™å‹åŠ›æ’æŸ¥ï¼‰</h3>
<p>å¦‚æœæœåŠ¡å™¨å¡æ…¢æ˜¯ â€œç£ç›˜è¯»å†™å¿™â€ å¯¼è‡´çš„ï¼ˆæ¯”å¦‚é¢‘ç¹å†™æ—¥å¿—ã€æ‹·è´å¤§æ–‡ä»¶ï¼‰ï¼Œç”¨ iostat å’Œ df å·¥å…·æ’æŸ¥ï¼š</p>
<h4 data-id="heading-30">1. dfï¼šæŸ¥çœ‹ç£ç›˜ç©ºé—´ä½¿ç”¨</h4>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰ç£ç›˜åˆ†åŒºçš„ç©ºé—´ä½¿ç”¨ï¼ˆ-hè¡¨ç¤ºäººæ€§åŒ–æ˜¾ç¤ºï¼Œå¦‚GB/MBï¼‰</span>
<span class="hljs-built_in">df</span> -h
</code></pre>
<h5 data-id="heading-31">å®æˆ˜åœºæ™¯</h5>
<ul>
<li>è‹¥æŸåˆ†åŒºçš„<code>Use%</code>è¶…è¿‡ 90%ï¼Œè¯´æ˜ç£ç›˜ç©ºé—´ä¸è¶³ï¼Œéœ€åˆ é™¤æ— ç”¨æ–‡ä»¶ï¼ˆæ¯”å¦‚æ—¥å¿—ã€ä¸´æ—¶æ–‡ä»¶ï¼‰ï¼›</li>
<li>åµŒå…¥å¼å¼€å‘ä¸­ï¼Œdf æŸ¥çœ‹å¼€å‘æ¿çš„ Flash ä½¿ç”¨æƒ…å†µï¼Œé¿å… Flash å†™æ»¡å¯¼è‡´æ— æ³•å­˜å‚¨æ•°æ®ã€‚</li>
</ul>
<h4 data-id="heading-32">2. iostatï¼šæŸ¥çœ‹ç£ç›˜ IO å‹åŠ›</h4>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…iostat</span>
sudo apt install sysstat
<span class="hljs-comment"># æŸ¥çœ‹ç£ç›˜IOçŠ¶æ€ï¼ˆ-xè¡¨ç¤ºæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼Œ1è¡¨ç¤ºæ¯ç§’åˆ·æ–°ä¸€æ¬¡ï¼‰</span>
iostat -x 1
</code></pre>
<h5 data-id="heading-33">æ ¸å¿ƒæŒ‡æ ‡è§£è¯»</h5>
<ul>
<li><code>%util</code>ï¼šç£ç›˜ IO åˆ©ç”¨ç‡ï¼ˆè¶…è¿‡ 80% è¯´æ˜ç£ç›˜ IO å‹åŠ›å¤§ï¼‰ï¼›</li>
<li><code>tps</code>ï¼šæ¯ç§’ IO è¯·æ±‚æ•°ï¼›</li>
<li><code>rMB/s</code>/<code>wMB/s</code>ï¼šæ¯ç§’è¯»å†™ MB æ•°ã€‚</li>
</ul>
<h5 data-id="heading-34">å®æˆ˜åœºæ™¯</h5>
<p>æœåŠ¡å™¨é¢‘ç¹å¡é¡¿ï¼Œç”¨ iostat æŸ¥çœ‹ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-shell" lang="shell">iostat -x 1
<span class="hljs-meta prompt_"># </span><span class="bash">è‹¥%utilæŒç»­è¶…è¿‡90%ï¼Œä¸”wMB/så¾ˆé«˜ï¼Œè¯´æ˜æœ‰ç¨‹åºåœ¨é¢‘ç¹å†™ç£ç›˜ï¼ˆæ¯”å¦‚æ—¥å¿—æ‰“å°è¿‡å¤šï¼‰</span>
<span class="hljs-meta prompt_"># </span><span class="bash">è§£å†³ï¼šä¼˜åŒ–æ—¥å¿—è¾“å‡ºï¼ˆå‡å°‘ä¸å¿…è¦çš„æ—¥å¿—ï¼Œæˆ–å®šæ—¶è½®è½¬æ—¥å¿—ï¼‰</span>
</code></pre>
<h3 data-id="heading-35">ä¸ƒã€é¿å‘æŒ‡å—ï¼šå¸¸è§é—®é¢˜è§£å†³</h3>
<ol>
<li>
<p><strong>gdb è°ƒè¯•æ—¶çœ‹ä¸åˆ°ä»£ç </strong>ï¼š</p>
<ul>
<li>åŸå› ï¼šç¼–è¯‘æ—¶æœªåŠ <code>-g</code>å‚æ•°ï¼Œæˆ–ä»£ç æ–‡ä»¶è¢«ç§»åŠ¨ / åˆ é™¤ï¼›</li>
<li>è§£å†³ï¼šé‡æ–°ç¼–è¯‘ï¼ˆåŠ <code>-g</code>ï¼‰ï¼Œç¡®ä¿è°ƒè¯•æ—¶ä»£ç æ–‡ä»¶è·¯å¾„ä¸ç¼–è¯‘æ—¶ä¸€è‡´ã€‚</li>
</ul>
</li>
<li>
<p><strong>perf top æç¤º â€œPermission deniedâ€</strong> ï¼š</p>
<ul>
<li>åŸå› ï¼šç¼ºå°‘ root æƒé™ï¼Œperf éœ€è¦å†…æ ¸æƒé™è·å–æ€§èƒ½æ•°æ®ï¼›</li>
<li>è§£å†³ï¼šç”¨<code>sudo perf top</code>è¿è¡Œã€‚</li>
</ul>
</li>
<li>
<p><strong>valgrind æ£€æµ‹åµŒå…¥å¼ç¨‹åºæŠ¥é”™</strong>ï¼š</p>
<ul>
<li>åŸå› ï¼švalgrind é»˜è®¤é’ˆå¯¹ x86 æ¶æ„ï¼ŒåµŒå…¥å¼æ˜¯ ARM æ¶æ„ï¼›</li>
<li>è§£å†³ï¼šäº¤å‰ç¼–è¯‘ valgrind æºç ï¼Œç”Ÿæˆ ARM ç‰ˆæœ¬çš„ valgrindï¼Œæˆ–åœ¨ QEMU ä»¿çœŸç¯å¢ƒä¸­æ£€æµ‹ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-36">å…«ã€æ€»ç»“ï¼šå·¥å…·é€‰æ‹©ä¼˜å…ˆçº§</h3>
<p>é‡åˆ°ç³»ç»Ÿ / ç¨‹åºé—®é¢˜æ—¶ï¼ŒæŒ‰ä»¥ä¸‹é¡ºåºé€‰æ‹©å·¥å…·ï¼Œæ•ˆç‡æœ€é«˜ï¼š</p>
<ol>
<li>å…ˆçœ‹å…¨å±€çŠ¶æ€ï¼šç”¨ top/htop åˆ¤æ–­æ˜¯ CPUã€å†…å­˜ã€ç£ç›˜å“ªä¸ªèµ„æºç´§å¼ ï¼›</li>
<li>ç¨‹åºå´©æºƒï¼šç”¨ gdb å®šä½å‡ºé”™ä»£ç è¡Œï¼›</li>
<li>ç¨‹åºè¿è¡Œæ…¢ï¼šç”¨ perf åˆ†æ CPU çƒ­ç‚¹å‡½æ•°ï¼›</li>
<li>é•¿æœŸè¿è¡Œåå´©æºƒï¼šç”¨ valgrind æ£€æµ‹å†…å­˜æ³„æ¼ï¼›</li>
<li>ç£ç›˜è¯»å†™æ…¢ï¼šç”¨ iostat/df æ’æŸ¥ç£ç›˜ç©ºé—´å’Œ IO å‹åŠ›ã€‚</li>
</ol>
<p>è¿™äº›å·¥å…·è¦†ç›–äº† Linux å¼€å‘ / è¿ç»´çš„ç»å¤§å¤šæ•°æ€§èƒ½é—®é¢˜åœºæ™¯ï¼Œå»ºè®®æ”¶è—èµ·æ¥ï¼Œé‡åˆ°é—®é¢˜æ—¶ç›´æ¥æŸ¥è¡¨æ‰¾å·¥å…·ã€‚ä¸‹ä¸€ç¯‡åšå®¢ï¼Œæˆ‘ä¼šç»™å¤§å®¶æ•´ç† â€œLinux è‡ªåŠ¨åŒ–è„šæœ¬ç¼–å†™â€ï¼Œæ•™ä½ ç”¨ shell è„šæœ¬æ•´åˆè¿™äº›å·¥å…·ï¼Œå®ç° â€œä¸€é”®ç›‘æ§â€â€œè‡ªåŠ¨æ’æŸ¥é—®é¢˜â€ï¼Œæ•¬è¯·å…³æ³¨ï¼</p>
<p>å¦‚æœéœ€è¦æŸæ¬¾å·¥å…·çš„è¯¦ç»†æ•™ç¨‹ï¼ˆæ¯”å¦‚ perf çš„å¤æ‚äº‹ä»¶é…ç½®ã€valgrind äº¤å‰ç¼–è¯‘ï¼‰ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[CSSå±æ€§ - èƒŒæ™¯å±æ€§]]></title>    <link>https://juejin.cn/post/7599922362998898734</link>    <guid>https://juejin.cn/post/7599922362998898734</guid>    <pubDate>2026-01-28T02:54:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599922362998898734" data-draft-id="7599951933594075146" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CSSå±æ€§ - èƒŒæ™¯å±æ€§"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-28T02:54:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="GinoWi"/> <meta itemprop="url" content="https://juejin.cn/user/687651121011707"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CSSå±æ€§ - èƒŒæ™¯å±æ€§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/687651121011707/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    GinoWi
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:54:44.000Z" title="Wed Jan 28 2026 02:54:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">CSSå±æ€§ - èƒŒæ™¯å±æ€§</h2>
<h4 data-id="heading-1">å¦‚ä½•è®¾ç½®æ ‡ç­¾çš„èƒŒæ™¯é¢œè‰²</h4>
<ul>
<li>
<p>åœ¨CSSä¸­æœ‰ä¸€ä¸ª<code>background-color</code>å±æ€§ï¼Œå°±æ˜¯ä¸“é—¨ç”¨æ¥è®¾ç½®æ ‡ç­¾çš„èƒŒæ™¯é¢œè‰²çš„ã€‚</p>
</li>
<li>
<p>å–å€¼ï¼š</p>
<ul>
<li>å…·ä½“é¢œè‰²å•è¯</li>
<li>rgb</li>
<li>rgba</li>
<li>åå…­è¿›åˆ¶</li>
</ul>
</li>
<li>
<p>æ¸²æŸ“æ•ˆæœï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>èƒŒæ™¯å±æ€§ç»ƒä¹ <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><span class="css">
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-tag">div</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">height</span>: <span class="hljs-number">50px</span>;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-class">.setEnName</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-color</span>: yellow;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-class">.setRgb</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-class">.setRgba</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.9</span>);
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-class">.setHex</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ff00ff</span>;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"setEnName"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"setRgb"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"setRgba"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"setHex"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9ef82c15c5749f1ba905ce77e62f462~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2lub1dp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173684&amp;x-signature=WKRJCvJ6Gx1VnxMy0iT7SxlvM3s%3D" alt="èƒŒæ™¯é¢œè‰²è®¾ç½®" loading="lazy"/></p>
</li>
</ul>
<h4 data-id="heading-2">å¦‚ä½•è®¾ç½®èƒŒæ™¯å›¾ç‰‡</h4>
<ul>
<li>
<p>åœ¨CSSä¸­æœ‰ä¸€ä¸ª<code>background-image</code>å±æ€§ï¼Œå°±æ˜¯ä¸“é—¨ç”¨æ¥è®¾ç½®èƒŒæ™¯å›¾ç‰‡çš„ã€‚</p>
</li>
<li>
<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li>å›¾ç‰‡çš„åœ°å€å¿…é¡»æ”¾åœ¨<code>url()</code>ä¸­ï¼Œå¯ä»¥æ˜¯æœ¬åœ°å›¾ç‰‡åœ°å€ï¼Œä¹Ÿå¯ä»¥æ˜¯ç½‘é¡µå›¾ç‰‡åœ°å€ã€‚</li>
<li>å¦‚æœå›¾ç‰‡çš„å¤§å°æ²¡æœ‰æ ‡ç­¾çš„å¤§å°å¤§ï¼Œä¼šè‡ªåŠ¨åœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘å¹³é“ºã€‚</li>
<li>å¦‚æœç½‘é¡µä¸Šå‡ºç°å›¾ç‰‡ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šå†æ¬¡å‘é€è¯·æ±‚ï¼Œè·å–å›¾ç‰‡ã€‚</li>
</ul>
</li>
<li>
<p>æ¸²æŸ“æ•ˆæœï¼š</p>
<p>æˆ‘çš„åŸå§‹å›¾ç‰‡æ˜¯è¿™ä¸ªï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1f3f925ed4449a0b04a8c75dd03167e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2lub1dp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173684&amp;x-signature=gXN1BODQqdVLBvQTtuYAT2dAy0g%3D" alt="CSS-background-image-source" loading="lazy"/></p>
<p>è¿™ä¸ªå›¾ç‰‡çš„å¤§å°æ˜¯519 Ã— 500åƒç´ çš„å¤§å°ï¼Œæ¥ä¸‹æ¥ç”¨è¿™ä¸ªå›¾ç‰‡ä½œä¸º<code>body</code>æ ‡ç­¾çš„èƒŒæ™¯å›¾ç‰‡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f3b9fa578e0b431eb19e24fddb522de0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2lub1dp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173684&amp;x-signature=HQlOjOttqul890hxqH0dqei5das%3D" alt="CSS-background-image.png" loading="lazy"/></p>
</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šå›¾çœ‹åˆ°ï¼Œç”±äºå›¾ç‰‡çš„å¤§å°æ²¡æœ‰æ ‡ç­¾çš„å¤§å°å¤§ï¼Œæ•…è‡ªåŠ¨åœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘ä¸Šå¹³é“ºã€‚</p>
<h4 data-id="heading-3">å¦‚ä½•æ§åˆ¶èƒŒæ™¯å›¾ç‰‡æ˜¯å¦å¹³é“º</h4>
<ul>
<li>
<p>åœ¨ä¸Šé¢æˆ‘ä»¬é˜è¿°äº†å¦‚ä½•è®¾ç½®èƒŒæ™¯å›¾ç‰‡ï¼Œä½†æ˜¯é»˜è®¤èƒŒæ™¯å›¾ç‰‡æ˜¯åœ¨æ ‡ç­¾å†…å¹³é“ºçš„ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æ§åˆ¶èƒŒæ™¯å›¾ç‰‡æ˜¯å¦åœ¨æ ‡ç­¾å†…å¹³é“ºå±•ç¤ºï¼Œé‚£ä¹ˆåœ¨CSSä¸­æœ‰ä¸€ä¸ª<code>background-repeat</code>å±æ€§ï¼Œå°±æ˜¯ä¸“é—¨ç”¨æ¥æ§åˆ¶èƒŒæ™¯å›¾ç‰‡çš„å¹³é“ºæ–¹å¼ã€‚</p>
</li>
<li>
<p>å–å€¼ï¼š</p>
<ul>
<li><code>repeat</code>ï¼šé»˜è®¤ï¼Œåœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘éƒ½éœ€è¦å¹³é“º</li>
<li><code>no-repeat</code>ï¼šåœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘éƒ½ä¸å¹³é“º</li>
<li><code>repeat-x</code>ï¼šåœ¨æ°´å¹³æ–¹å‘å¹³é“º</li>
<li><code>repeat-y</code>ï¼šåœ¨å‚ç›´æ–¹å‘å¹³é“º</li>
</ul>
</li>
<li>
<p>åº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>å¯ä»¥é€šè¿‡èƒŒæ™¯å›¾ç‰‡çš„å¹³é“ºæ¥é™ä½å›¾ç‰‡çš„å¤§å°ï¼ŒåŠ å¿«ç½‘é¡µè®¿é—®çš„é€Ÿåº¦ã€‚</li>
</ul>
</li>
<li>
<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li>åŒä¸€ä¸ªæ ‡ç­¾å¯ä»¥åŒæ—¶è®¾ç½®èƒŒæ™¯é¢œè‰²å’ŒèƒŒæ™¯å›¾ç‰‡ï¼Œå¦‚æœé¢œè‰²å’Œå›¾ç‰‡åŒæ—¶å­˜åœ¨ï¼Œé‚£ä¹ˆå›¾ç‰‡ä¼šè¦†ç›–é¢œè‰²ã€‚</li>
</ul>
</li>
<li>
<p>æ¸²æŸ“æ•ˆæœï¼š</p>
<p>è¿™é‡Œç´ æå›¾ç‰‡æ˜¯å¤§å°200Ã—200çš„æ–¹å—ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02d13eff36c348dfa4857a2d481a11bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2lub1dp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173684&amp;x-signature=SXzD%2FM9M90ZcdMI2gZ2EghctEKw%3D" alt="background-repeat-source" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ä¸åŒçš„<code>div</code>ç›’å­ä¸­è®¾ç½®èƒŒæ™¯å›¾ç‰‡ä¸åŒçš„å¹³é“ºæ–¹å¼ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„æ•ˆæœï¼ˆè¿™é‡Œå¯¹ç½‘é¡µè¿›è¡Œäº†ç¼©å°ï¼ŒéçœŸæ­£å›¾ç‰‡å¤§å°ï¼‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f837ef47db214d2eb5b833524090a079~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR2lub1dp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173684&amp;x-signature=vfRhUo8colGzXqjfL73MlC1VhaI%3D" alt="background-repeat" loading="lazy"/></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>èƒŒæ™¯å±æ€§ç»ƒä¹ <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><span class="css">
 Â  Â  Â  Â  Â   * {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-tag">div</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">width</span>: <span class="hljs-number">600px</span>;
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">height</span>: <span class="hljs-number">300px</span>;
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">img/bg2.jpg</span>);
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-class">.setNoRepeat</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-repeat</span>: no-repeat;
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">50px</span>;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-class">.setRepeatX</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-repeat</span>: repeat-x;
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">margin-top</span>:<span class="hljs-number">50px</span>;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â <span class="hljs-selector-class">.setRepeatY</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">background-repeat</span>: repeat-y;
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attribute">margin-top</span>:<span class="hljs-number">50px</span>;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"non"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"setNoRepeat"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"setRepeatX"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"setRepeatY"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
</li>
</ul>
<h4 data-id="heading-4">å¦‚ä½•è®¾ç½®èƒŒæ™¯å›¾ç‰‡çš„ä½ç½®</h4>
<ul>
<li>
<p>åœ¨CSSä¸­æœ‰ä¸€ä¸ªå«åš<code>background-position</code>å±æ€§ï¼Œå°±æ˜¯ä¸“é—¨ç”¨äºæ§åˆ¶èƒŒæ™¯å›¾ç‰‡çš„ä½ç½®ã€‚</p>
</li>
<li>
<p>å–å€¼ï¼š</p>
<ul>
<li>
<p>å…·ä½“çš„æ–¹ä½åè¯</p>
<ul>
<li>æ°´å¹³æ–¹å‘ï¼š<code>left</code>ã€<code>center</code>ã€<code>right</code></li>
<li>å‚ç›´æ–¹å‘ï¼š<code>top</code>ã€<code>center</code>ã€<code>bottom</code></li>
</ul>
</li>
<li>
<p>å…·ä½“çš„åƒç´ </p>
<ul>
<li>ä¸€å®šè¦å†™å•ä½</li>
<li>å¯ä»¥å†™è´Ÿå€¼ï¼Œå‚ç›´æ–¹å‘åƒç´ å€¼è¶Šå¤§è¶Šé ä¸‹ï¼Œæ°´å¹³æ–¹å‘åƒç´ å€¼è¶Šå¤§è¶Šé å³ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p>æ ¼å¼ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">background-position</span>: æ°´å¹³æ–¹å‘ å‚ç›´æ–¹å‘;
</code></pre>
</li>
<li>
<p>åº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>å¯ä»¥è§£å†³èƒŒæ™¯å›¾ç‰‡ä¸åŒåˆ†è¾¨ç‡å±•ç¤ºå¼‚å¸¸é—®é¢˜ã€‚å¦‚æœé€šè¿‡<code>img</code>æ ‡ç­¾å±•ç¤ºå›¾ç‰‡ï¼Œå¯èƒ½æ— æ³•é€‚é…æµè§ˆå™¨å®½åº¦ï¼Œæµè§ˆå™¨ä¸‹æ–¹ä¼šæ˜¾ç¤ºæ»šåŠ¨æ¡ï¼Œä½†æ˜¯é€šè¿‡èƒŒæ™¯å›¾ç‰‡å±•ç¤ºï¼Œä¼šæ ¹æ®æµè§ˆå™¨å®½åº¦æˆªå–å›¾ç‰‡ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-5">èƒŒæ™¯å…³è”æ–¹å¼</h4>
<ul>
<li>
<p>é»˜è®¤æƒ…å†µä¸‹èƒŒæ™¯å›¾ç‰‡ä¼šéšç€æ»šåŠ¨æ¡çš„æ»šåŠ¨è€Œæ»šåŠ¨ï¼Œå¦‚æœä¸æƒ³è®©èƒŒæ™¯å›¾ç‰‡éšç€æ»šåŠ¨æ¡çš„æ»šåŠ¨è€Œæ»šåŠ¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä¿®æ”¹èƒŒæ™¯å›¾ç‰‡å’Œæ»šåŠ¨æ¡çš„å…³è”æ–¹å¼ã€‚åœ¨CSSä¸­æœ‰ä¸€ä¸ª<code>background-attachment</code>çš„å±æ€§è¿™ä¸ªå±æ€§å°±æ˜¯ä¸“é—¨ç”¨äºä¿®æ”¹èƒŒæ™¯å›¾ç‰‡å…³è”æ–¹å¼çš„ã€‚</p>
</li>
<li>
<p>æ ¼å¼ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">background-attachment</span>: scroll;
</code></pre>
</li>
<li>
<p>å–å€¼ï¼š</p>
<ul>
<li><code>scroll</code>ï¼šé»˜è®¤å€¼ï¼Œä¼šéšç€æ»šåŠ¨æ¡çš„æ»šåŠ¨è€Œæ»šåŠ¨ã€‚</li>
<li><code>fixed</code>ï¼š ä¸ä¼šéšç€æ»šåŠ¨æ¡çš„æ»šåŠ¨è€Œæ»šåŠ¨ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-6">èƒŒæ™¯å±æ€§ç¼©å†™</h4>
<ul>
<li>
<p>èƒŒæ™¯å±æ€§ç¼©å†™æ ¼å¼ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">background</span>ï¼šèƒŒæ™¯é¢œè‰² èƒŒæ™¯å›¾ç‰‡ å¹³é“ºæ–¹å¼ å…³è”æ–¹å¼ å®šä½æ–¹å¼;
</code></pre>
</li>
<li>
<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li><code>background</code>å±æ€§ä¸­ï¼Œä»»ä½•ä¸€ä¸ªå±æ€§éƒ½å¯ä»¥è¢«çœç•¥ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>è¡¥å……å†…å®¹ï¼š</strong></p>
<p>èƒŒæ™¯å›¾ç‰‡å’Œæ’å…¥å›¾ç‰‡çš„åŒºåˆ«</p>
<ul>
<li>èƒŒæ™¯å›¾ç‰‡ä»…ä»…æ˜¯ä¸€ä¸ªè£…é¥°ï¼Œä¸ä¼šå ç”¨ä½ç½®ï¼›æ’å…¥å›¾ç‰‡ä¼šå ç”¨ä½ç½®ã€‚</li>
<li>èƒŒæ™¯å›¾ç‰‡æœ‰å®šä½å±æ€§ï¼Œæ‰€ä»¥å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ§åˆ¶å›¾ç‰‡çš„ä½ç½®ï¼›æ’å…¥å›¾ç‰‡æ²¡æœ‰å®šä½å±æ€§ï¼Œæ‰€ä»¥æ§åˆ¶å›¾ç‰‡çš„ä½ç½®ä¸å¤ªæ–¹ä¾¿ã€‚</li>
<li>æ’å…¥å›¾ç‰‡çš„è¯­ä¹‰æ¯”èƒŒæ™¯å›¾ç‰‡è¯­ä¹‰å¼ºï¼Œæ‰€ä»¥åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¦‚æœå›¾ç‰‡æƒ³è¦è¢«æœç´¢å¼•æ“æ”¶å½•ï¼Œé‚£ä¹ˆæ¨èä½¿ç”¨æ’å…¥å›¾ç‰‡ã€‚</li>
</ul>
</blockquote>
<p><strong>å‚è€ƒé“¾æ¥ï¼š</strong></p>
<p>W3Schoolå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.w3school.com.cn%2F" target="_blank" title="https://www.w3school.com.cn/" ref="nofollow noopener noreferrer">www.w3school.com.cn</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[HTTP-åè®®æº¯æºï¼šæ·±åº¦è§£æ HTTP/3.0 ä¸ QUIC åè®®çš„åº•å±‚é©å‘½]]></title>    <link>https://juejin.cn/post/7599917711794077706</link>    <guid>https://juejin.cn/post/7599917711794077706</guid>    <pubDate>2026-01-28T02:56:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599917711794077706" data-draft-id="7599951933593960458" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="HTTP-åè®®æº¯æºï¼šæ·±åº¦è§£æ HTTP/3.0 ä¸ QUIC åè®®çš„åº•å±‚é©å‘½"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,HTTP"/> <meta itemprop="datePublished" content="2026-01-28T02:56:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘ç°ä¸€åªå¤§å‘†ç“œ"/> <meta itemprop="url" content="https://juejin.cn/user/180747382561607"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            HTTP-åè®®æº¯æºï¼šæ·±åº¦è§£æ HTTP/3.0 ä¸ QUIC åè®®çš„åº•å±‚é©å‘½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/180747382561607/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘ç°ä¸€åªå¤§å‘†ç“œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:56:47.000Z" title="Wed Jan 28 2026 02:56:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>HTTP/2 å¼€å¯äº†å¤šè·¯å¤ç”¨çš„æ—¶ä»£ï¼Œä½†å®ƒä¾ç„¶è·‘åœ¨ TCP è¿™æ¡â€œè€æ—§â€çš„é“è½¨ä¸Šã€‚åªè¦ TCP çš„è®¾è®¡åˆè¡·ï¼ˆé¡ºåºä¼ è¾“ã€å­—èŠ‚æµå¯é æ€§ï¼‰ä¸æ”¹å˜ï¼Œ<strong>é˜Ÿå¤´é˜»å¡ï¼ˆHOL Blockingï¼‰</strong> çš„å¹½çµå°±æ°¸è¿œæ— æ³•å½»åº•æ•£å»ã€‚äºæ˜¯ï¼ŒGoogle å¦è¾Ÿè¹Šå¾„ï¼ŒåŸºäº UDP æ‰“é€ äº† <strong>QUIC</strong>ï¼Œå¹¶æœ€ç»ˆæˆä¸ºäº† <strong>HTTP/3</strong> çš„æ ¸å¿ƒã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ HTTP/2 çš„é—æ†¾ï¼šTCP å±‚çš„é˜Ÿå¤´é˜»å¡</h2>
<p>è™½ç„¶ HTTP/2 è¿‡å¤šè·¯å¤ç”¨è§£å†³äº† <strong>HTTP åœ¨åº”ç”¨å±‚</strong> çš„é˜Ÿå¤´é˜»å¡ï¼Œä½¿åº”ç”¨å±‚å‘ç”Ÿçš„è¯·æ±‚ä¸å†éœ€è¦æ’é˜Ÿç­‰å€™ï¼Œè§£å†³äº† HTTP/1.1 çš„é˜Ÿå¤´é˜»å¡ã€‚ï¼Œä½†ç”±äºå®ƒåº•å±‚ä¾ç„¶ä¾èµ– TCPï¼Œäº§ç”Ÿäº†ä¸€ä¸ªæ–°çš„ç“¶é¢ˆ</p>
<ul>
<li>
<p><strong>ä¼ è¾“å±‚é˜Ÿå¤´é˜»å¡é—®é¢˜</strong> ï¼šHTTP/2 å»ºç«‹åœ¨ TCP ä¹‹ä¸Šã€‚TCP è¦æ±‚å­—èŠ‚å¿…é¡»æŒ‰é¡ºåºäº¤ä»˜ã€‚å¦‚æœç½‘ç»œå‘ç”Ÿ<strong>ä¸¢åŒ…</strong>ï¼ŒTCP æ— æ³•åˆ†è¾¨å“ªäº›å­—èŠ‚å±äºå“ªä¸ªè¯·æ±‚ï¼Œåªèƒ½æš‚åœæ•´ä¸ªè¿æ¥ç­‰å¾…é‡ä¼ ã€‚</p>
</li>
<li>
<p><strong>å¼±ç½‘ç¯å¢ƒä¸‹çš„å°´å°¬</strong>ï¼šåœ¨ä¸¢åŒ…ç‡è¾ƒé«˜çš„ç§»åŠ¨ç½‘ç»œä¸‹ï¼ŒHTTP/2 çš„è¡¨ç°æœ‰æ—¶ç”šè‡³ä¸å¦‚å¼€å¯ 6 ä¸ªè¿æ¥çš„ HTTP/1.1ï¼Œå› ä¸ºâ€œä¸€è£ä¿±è£ï¼Œä¸€æŸä¿±æŸâ€ã€‚</p>
</li>
</ul>
<ol>
<li><strong>è¿æ¥å»ºç«‹çš„å¼€é”€</strong>ï¼šTCP ä¸‰æ¬¡æ¡æ‰‹ + TLS æ¡æ‰‹ï¼Œåœ¨å¼±ç½‘ç¯å¢ƒä¸‹ RTTï¼ˆå¾€è¿”æ—¶å»¶ï¼‰éå¸¸é«˜ã€‚</li>
</ol>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b938756fb18b4f6289c49c6a1f7072d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-R546w5LiA5Y-q5aSn5ZGG55Oc:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173806&amp;x-signature=HRgEUAqN19vkldpRshut8ddRpfA%3D" alt="image.png" width="90%" loading="lazy"/></p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a51f765685da471d98c10c46f16f83c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-R546w5LiA5Y-q5aSn5ZGG55Oc:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770173806&amp;x-signature=GrdAR%2B%2BMPw%2FByROmuL6IbBR9ffQ%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-2">äºŒã€ HTTP/3 çš„é€†è¢­ï¼šåŸºäº UDP çš„ QUIC åè®®</h2>
<p>ç”±äº TCP åè®®æ·±æ¤äºæ“ä½œç³»ç»Ÿå†…æ ¸å’Œè·¯ç”±å™¨å›ºä»¶ä¸­ï¼Œä¿®æ”¹æå…¶å›°éš¾ã€‚HTTP/3 ç´¢æ€§â€œæ¨å€’é‡æ¥â€ï¼Œåœ¨ <strong>UDP</strong> ä¹‹ä¸Šå®ç°äº†å¯é ä¼ è¾“ï¼Œè¿™ä¾¿æ˜¯ <strong>QUICï¼ˆQuick UDP Internet Connectionsï¼‰</strong> ã€‚</p>
<h3 data-id="heading-3">1. QUIC çš„å››å¤§æ ¸å¿ƒé­”æ³•</h3>
<h4 data-id="heading-4">â‘  å½»åº•è§£å†³é˜Ÿå¤´é˜»å¡</h4>
<p>QUIC åœ¨ä¼ è¾“å±‚å®ç°äº†å¤šè·¯å¤ç”¨ã€‚æ¯ä¸ªæµï¼ˆStreamï¼‰ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚</p>
<ul>
<li><strong>æ•ˆæœ</strong>ï¼šå¦‚æœ Stream A ä¸¢åŒ…ï¼Œåªä¼šé˜»å¡ Stream A çš„é‡ç»„ï¼Œ<strong>Stream B å’Œ Stream C å¯ä»¥ç»§ç»­ä¸å—å½±å“åœ°ä¼ è¾“æ•°æ®</strong>ã€‚</li>
</ul>
<h4 data-id="heading-5">â‘¡ æé€Ÿæ¡æ‰‹ï¼ˆ0-RTT / 1-RTTï¼‰</h4>
<p>TCP éœ€è¦å…ˆå»ºç«‹è¿æ¥å†å»ºç«‹åŠ å¯†é€šé“ã€‚</p>
<ul>
<li><strong>æ•ˆæœ</strong>ï¼šQUIC å°†<strong>ä¼ è¾“æ¡æ‰‹</strong>ä¸<strong>åŠ å¯†æ¡æ‰‹</strong>åˆå¹¶ã€‚åˆæ¬¡è¿æ¥åªéœ€ 1 ä¸ª RTTï¼Œå†æ¬¡è¿æ¥ç”šè‡³å¯ä»¥å®ç° <strong>0-RTT</strong> æé€Ÿå¯åŠ¨ã€‚</li>
</ul>
<h4 data-id="heading-6">â‘¢ è¿æ¥è¿ç§» (Connection Migration)</h4>
<p>TCP ä¾é â€œå››å…ƒç»„â€ï¼ˆæºIPã€æºç«¯å£ã€ç›®æ ‡IPã€ç›®æ ‡ç«¯å£ï¼‰è¯†åˆ«è¿æ¥ã€‚</p>
<ul>
<li><strong>ç—›ç‚¹</strong>ï¼šå½“ä½ ä» Wi-Fi åˆ‡æ¢åˆ° 4Gï¼ŒIP å˜äº†ï¼ŒTCP è¿æ¥å¿…æ–­ã€‚</li>
<li><strong>æ”¹è¿›</strong>ï¼šQUIC ä½¿ç”¨ <strong>Connection ID</strong> è¯†åˆ«è¿æ¥ã€‚å³ä¾¿ IP åˆ‡æ¢ï¼Œåªè¦ ID ä¸å˜ï¼Œè¿æ¥å°±èƒ½æ— ç¼å»¶ç»­ã€‚</li>
</ul>
<h4 data-id="heading-7">â‘£ æ”¹è¿›çš„å¤´éƒ¨å‹ç¼©ï¼šQPACK</h4>
<p>HTTP/2 ä½¿ç”¨çš„ HPACK åœ¨ä¹±åºä¼ è¾“æ—¶ä¼šäº§ç”Ÿé˜Ÿå¤´é˜»å¡ï¼ŒHTTP/3 å‡çº§ä¸º <strong>QPACK</strong>ï¼Œä¸“é—¨ä¼˜åŒ–äº†å¤šæµå¹¶å‘ä¸‹çš„å‹ç¼©æ•ˆç‡ã€‚</p>
<hr/>
<h2 data-id="heading-8">ä¸‰ã€ æ€»ç»“ï¼šä»â€œæ’é˜Ÿâ€åˆ°â€œå¹¶å‘â€</h2>






























<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>HTTP/2 (TCP)</strong></th><th><strong>HTTP/3 (UDP/QUIC)</strong></th></tr></thead><tbody><tr><td><strong>ä¼ è¾“å±‚é˜»å¡</strong></td><td>å­˜åœ¨ TCP é˜Ÿå¤´é˜»å¡</td><td><strong>ä¸å­˜åœ¨</strong>ï¼ˆæµä¸æµç‹¬ç«‹ï¼‰</td></tr><tr><td><strong>æ¡æ‰‹æ—¶å»¶</strong></td><td>2~3 RTT (TCP+TLS)</td><td><strong>0~1 RTT</strong></td></tr><tr><td><strong>ç½‘ç»œåˆ‡æ¢</strong></td><td>è¿æ¥æ–­å¼€ï¼Œéœ€é‡æ–°æ¡æ‰‹</td><td><strong>æ— ç¼è¿ç§»</strong></td></tr><tr><td><strong>å¯é æ€§</strong></td><td>æ“ä½œç³»ç»Ÿå†…æ ¸å®ç°</td><td><strong>QUIC åœ¨åº”ç”¨å±‚å®ç°</strong></td></tr></tbody></table>
<h2 data-id="heading-9">å››ã€ HTTP3.0ç°çŠ¶</h2>
<p>ç›®å‰HTTP3.0å¹¶æ²¡æœ‰æ™®åŠï¼Œä½ å¯ä»¥éšä¾¿æ‰“å¼€ç½‘ç«™æŸ¥çœ‹è¯·æ±‚ç›¸åº”çš„HTTPç‰ˆæœ¬ï¼Œä¼šå‘ç°å¤§å¤šæ•°è¯·æ±‚éƒ½æ˜¯HTTP2.0çš„ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Dart Isolate å…¨æ™¯è§£æ]]></title>    <link>https://juejin.cn/post/7599917711793995786</link>    <guid>https://juejin.cn/post/7599917711793995786</guid>    <pubDate>2026-01-28T02:40:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599917711793995786" data-draft-id="7599917711793979402" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Dart Isolate å…¨æ™¯è§£æ"/> <meta itemprop="keywords" content="Flutter"/> <meta itemprop="datePublished" content="2026-01-28T02:40:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æµ©è¾‰"/> <meta itemprop="url" content="https://juejin.cn/user/1134351728786711"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Dart Isolate å…¨æ™¯è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1134351728786711/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æµ©è¾‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:40:24.000Z" title="Wed Jan 28 2026 02:40:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Dart Isolate å…¨æ™¯è§£æï¼šä»å•çº¿ç¨‹æ¨¡å‹åˆ°å¹¶å‘ç¼–ç¨‹çš„åº•å±‚çœŸç›¸</h2>
<p>åœ¨ Flutter å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸å¬åˆ°ä¸€å¥è¯ï¼šâ€œDart æ˜¯å•çº¿ç¨‹çš„â€ã€‚ä½†å¾ˆå¤šå¼€å‘è€…åœ¨é‡åˆ°å¡é¡¿æ—¶ï¼Œå¾€å¾€ä¼šé™·å…¥å›°æƒ‘ï¼šæ—¢ç„¶æœ‰ <code>Future</code> å’Œ <code>async/await</code> è¿™ç§å¼‚æ­¥æœºåˆ¶ï¼Œä¸ºä»€ä¹ˆæˆ‘çš„ App è§£æä¸€ä¸ªå¤§æ–‡ä»¶æ—¶è¿˜æ˜¯å¡ä½äº†ï¼Ÿ</p>
<p>æœ¬æ–‡å°†å‰¥å¼€ Dart å¹¶å‘çš„è¡¨è±¡ï¼Œä» Main Isolate çš„å•çº¿ç¨‹æ¨¡å‹å‡ºå‘ï¼Œæ·±å…¥åº•å±‚å†…å­˜æœºåˆ¶ï¼Œå¸¦ä½ å½»åº•ç†è§£ <strong>Isolate</strong> â€”â€” è¿™ä¸ª Dart å¹¶å‘ç¼–ç¨‹çš„ç»ˆææ­¦å™¨ã€‚</p>
<hr/>
<h3 data-id="heading-1">ç¬¬ä¸€ç« ï¼šèƒŒæ™¯ â€”â€” Flutter å•çº¿ç¨‹ä¸ Main Isolate çš„çœŸç›¸</h3>
<p>åœ¨ Flutter çš„ä¸–ç•Œé‡Œï¼Œå¼€å‘è€…æœ€å¸¸å¬åˆ°çš„ä¸€å¥è¯å°±æ˜¯ï¼šâ€œDart æ˜¯å•çº¿ç¨‹çš„â€ã€‚è¿™å¥è¯æ—¢æ˜¯ Flutter å¼€å‘ç®€å•çš„æºæ³‰ï¼ˆæ— éœ€æ‹…å¿ƒé”å’Œç«æ€æ¡ä»¶ï¼‰ï¼Œä¹Ÿæ˜¯æ— æ•°æ€§èƒ½ç¾éš¾çš„æ ¹æºã€‚</p>
<p>å¾ˆå¤šå¼€å‘è€…åœ¨é¢å¯¹ UI å¡é¡¿ï¼ˆJankï¼‰æ—¶ï¼Œç¬¬ä¸€ååº”æ˜¯ï¼šâ€œæˆ‘æ˜æ˜åŠ äº† <code>async/await</code>ï¼Œä¸ºä»€ä¹ˆç•Œé¢è¿˜æ˜¯å¡æ­»äº†ï¼Ÿâ€</p>
<p>è¦è§£å¼€è¿™ä¸ªè°œé¢˜ï¼Œæˆ‘ä»¬éœ€è¦å…ˆèµ°è¿› Flutter çš„å¿ƒè„ â€”â€” <strong>Main Isolate</strong>ã€‚</p>
<h3 data-id="heading-2">1.1 Main Isolateï¼šèº«å…¼æ•°èŒçš„â€œç‹¬è£è€…â€</h3>
<p>å½“ä½ çš„ Flutter App å¯åŠ¨æ—¶ï¼ŒDart è™šæ‹Ÿæœºï¼ˆVMï¼‰ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªä¸» Isolateï¼Œæˆ‘ä»¬é€šå¸¸ç§°ä¹‹ä¸º <strong>Main Isolate</strong>ã€‚</p>
<p>è¯·ä¸è¦æŠŠå®ƒç®€å•åœ°ç†è§£ä¸ºâ€œæ‰§è¡Œä»£ç çš„åœ°æ–¹â€ã€‚åœ¨ Flutter çš„æ¶æ„ä¸­ï¼ŒMain Isolate æ˜¯ä¸€ä¸ªç»å¯¹çš„**â€œç‹¬è£è€…â€**ï¼Œå®ƒæŒç®¡äº† App ç”Ÿå‘½çº¿ä¸­å‡ ä¹æ‰€æœ‰çš„æ ¸å¿ƒå·¥ä½œï¼š</p>
<ol>
<li>
<p><strong>é€»è¾‘æ‰§è¡Œ</strong>ï¼šè¿è¡Œä½ å†™çš„å¤§éƒ¨åˆ† Dart ä¸šåŠ¡ä»£ç ã€‚</p>
</li>
<li>
<p><strong>äº‹ä»¶å¤„ç†</strong>ï¼šå“åº”ç‚¹å‡»ã€æ»‘åŠ¨ã€é”®ç›˜è¾“å…¥ç­‰ç”¨æˆ·äº¤äº’ã€‚</p>
</li>
<li>
<p><strong>UI æ¸²æŸ“</strong>ï¼šè¿™æ˜¯æœ€ç¹é‡çš„ä»»åŠ¡ã€‚å®ƒè¦è´Ÿè´£æ‰§è¡Œ Widget çš„ <code>build</code>ï¼ˆæ„å»ºï¼‰ã€<code>layout</code>ï¼ˆå¸ƒå±€ï¼‰å’Œ <code>paint</code>ï¼ˆç»˜åˆ¶å½•åˆ¶ï¼‰ã€‚</p>
</li>
</ol>
<p>ä½ å¯ä»¥æŠŠ Main Isolate æƒ³è±¡æˆä¸€å®¶ç±³å…¶æ—é¤å…çš„<strong>å”¯ä¸€ä¸»å¨</strong>ã€‚ä»–ä¸ä»…è¦è´Ÿè´£åˆ‡èœã€ç‚’èœï¼ˆæ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼‰ï¼Œè¿˜è¦è´Ÿè´£æœ€åçš„æ‘†ç›˜å’Œä¼ èœï¼ˆæ¸²æŸ“ UIï¼‰ã€‚</p>
<p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™æ‰€æœ‰çš„ä¸€åˆ‡ï¼Œéƒ½å‘ç”Ÿåœ¨è¿™ <strong>å”¯ä¸€çš„ä¸€æ¡çº¿ç¨‹</strong> ä¸Šã€‚</p>
<h3 data-id="heading-3">1.2 16ms çš„ç”Ÿæ­»çº¿ (The 16ms Deadline)</h3>
<p>æ—¢ç„¶åªæœ‰ä¸€ä½ä¸»å¨ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬çš„ App çœ‹èµ·æ¥è¿˜èƒ½æµç•…è¿è¡Œï¼Ÿå› ä¸ºè¿™ä½ä¸»å¨çš„æ‰‹é€Ÿæå¿«ã€‚</p>
<p>ä¸ºäº†è¾¾åˆ° <strong>60FPS</strong>ï¼ˆæ¯ç§’ 60 å¸§ï¼‰çš„æµç•…åº¦ï¼ŒMain Isolate å¿…é¡»éµå¾ªä¸€ä¸ªä¸¥è‹›çš„ KPIï¼š<strong>æ¯ 16.6 æ¯«ç§’ï¼ˆ1000ms / 60ï¼‰å¿…é¡»äº§å‡ºä¸€å¸§ç”»é¢ã€‚</strong></p>
<p>åœ¨è¿™ä¸ªæå…¶çŸ­æš‚çš„ 16ms çª—å£æœŸå†…ï¼ŒMain Isolate å¿…é¡»å¤„ç†å®Œå½“ä¸‹çš„ç”¨æˆ·ç‚¹å‡»ï¼Œç®—å®Œå½“å‰çš„ä¸šåŠ¡é€»è¾‘ï¼Œå¹¶æŠŠä¸‹ä¸€å¸§çš„ UI ç»˜åˆ¶æŒ‡ä»¤æäº¤ç»™ GPUã€‚</p>
<ul>
<li>
<p><strong>ç†æƒ³æƒ…å†µ</strong>ï¼šé€»è¾‘ç®€å•ï¼Œä¸»å¨åœ¨ 5ms å†…æå®šä¸€åˆ‡ï¼Œå‰©ä¸‹ 11ms å–èŒ¶ä¼‘æ¯ï¼ˆIdleï¼‰ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡å±å¹•åˆ·æ–°ä¿¡å·ï¼ˆVSyncï¼‰ã€‚</p>
</li>
<li>
<p><strong>å¡é¡¿ï¼ˆJankï¼‰</strong> ï¼šä½ å†™äº†ä¸€ä¸ªå¤æ‚çš„å›¾ç‰‡æ»¤é•œå¾ªç¯ï¼Œè€—æ—¶ <strong>100ms</strong>ã€‚ä¸»å¨ä¸€ç›´åœ¨â€œåˆ‡èœâ€ï¼ˆè®¡ç®—ï¼‰ï¼Œé”™è¿‡äº†â€œä¼ èœâ€ï¼ˆVSyncï¼‰çš„æ—¶é—´ç‚¹ã€‚äºæ˜¯ï¼Œå±å¹•åœ¨æ¥ä¸‹æ¥çš„ 6 å¸§é‡Œç”»é¢é™æ­¢ï¼Œç”¨æˆ·æ„Ÿè§‰åˆ°äº†æ˜æ˜¾çš„å¡é¡¿ã€‚</p>
</li>
</ul>
<h3 data-id="heading-4">1.3 Event Loopï¼šå‹¤åŠ³ä¸”â€œåå¿ƒâ€çš„é“¶è¡ŒæŸœå‘˜</h3>
<p>Main Isolate æ˜¯å¦‚ä½•åœ¨ä¸€ä¸ªçº¿ç¨‹é‡Œæœ‰åºå¤„ç†å¼‚æ­¥ä»»åŠ¡ã€ç‚¹å‡»äº‹ä»¶å’Œç»˜åˆ¶æŒ‡ä»¤çš„ï¼Ÿé çš„æ˜¯ <strong>Event Loopï¼ˆäº‹ä»¶å¾ªç¯ï¼‰</strong> ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥æŠŠ Event Loop æƒ³è±¡æˆä¸€ä¸ª<strong>æå…¶æ­»æ¿çš„é“¶è¡ŒæŸœå‘˜</strong>ã€‚ä»–çš„å·¥ä½œåŸåˆ™åªæœ‰ä¸€æ¡ï¼š<strong>ä¸€æ¬¡åªå¤„ç†ä¸€ä»¶äº‹ï¼Œåšå®Œä¸€ä»¶å†æ‹¿ä¸‹ä¸€ä»¶ã€‚</strong></p>
<p>åœ¨ä»–çš„é¢å‰ï¼Œæ‘†ç€ä¸¤ä¸ªæ–‡ä»¶ç­ï¼Œå¤„ç†ä¼˜å…ˆçº§æˆªç„¶ä¸åŒï¼š</p>
<h4 data-id="heading-5">1. <strong>VIP æ€¥ä»¶ç­ï¼šMicrotask Queue (å¾®ä»»åŠ¡é˜Ÿåˆ—)</strong></h4>
<ul>
<li>
<p><strong>ä¼˜å…ˆçº§</strong>ï¼š<strong>æœ€é«˜</strong>ã€‚</p>
</li>
<li>
<p><strong>æ¥æº</strong>ï¼š<code>scheduleMicrotask</code>ã€<code>Future.then</code> å›è°ƒã€‚</p>
</li>
<li>
<p><strong>è§„åˆ™</strong>ï¼šåªè¦è¿™ä¸ªç­é‡Œè¿˜æœ‰ä»»åŠ¡ï¼ŒæŸœå‘˜å°±<strong>ç»å¯¹ä¸ä¼š</strong>å»çœ‹åˆ«å¤„ã€‚å“ªæ€•æ­¤æ—¶ç”¨æˆ·æ­£åœ¨ç–¯ç‹‚ç‚¹å‡»å±å¹•ï¼Œæˆ–è€…ç»˜åˆ¶ä¿¡å·å·²ç»æ¥äº†ï¼ŒæŸœå‘˜ä¹Ÿä¼šæ— è§†ï¼Œå¿…é¡»å…ˆæŠŠå¾®ä»»åŠ¡æ¸…ç©ºã€‚</p>
<ul>
<li><em>éšå–»</em>ï¼šå¦‚æœåœ¨è¿™é‡Œå†™äº†æ­»å¾ªç¯ï¼ŒApp å°±ä¼šç”±å†…è€Œå¤–åœ°å½»åº•â€œå†»ç»“â€ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-6">2. <strong>æ™®é€šä»¶ç­ï¼šEvent Queue (äº‹ä»¶é˜Ÿåˆ—)</strong></h4>
<ul>
<li>
<p><strong>ä¼˜å…ˆçº§</strong>ï¼šæ™®é€šã€‚</p>
</li>
<li>
<p><strong>æ¥æº</strong>ï¼šI/O å›è°ƒã€Timerã€Isolate æ¶ˆæ¯ã€<strong>ç‚¹å‡»äº‹ä»¶</strong>ã€<strong>ç»˜åˆ¶æŒ‡ä»¤</strong>ã€‚</p>
</li>
<li>
<p><strong>è§„åˆ™</strong>ï¼šå½“ VIP ç­ç©ºäº†ï¼ŒæŸœå‘˜æ‰ä¼šä»è¿™é‡Œæ‹¿å‡ºä¸€ä¸ªä»»åŠ¡æ‰§è¡Œã€‚æ‰§è¡Œå®Œè¿™ä¸€ä¸ªåï¼Œä»–ä¼š<strong>ç«‹åˆ»å›å¤´æ£€æŸ¥ VIP ç­</strong>ï¼Œç¡®è®¤æ²¡æœ‰æ–°äº§ç”Ÿçš„æ€¥ä»¶ï¼Œæ‰ç»§ç»­åšä¸‹ä¸€ä¸ªæ™®é€šä»»åŠ¡ã€‚</p>
</li>
</ul>
<h3 data-id="heading-7">1.4 æœ€å¤§çš„è¿·æ€ï¼š<code>Future</code> å¹¶ä¸æ˜¯â€œåå°çº¿ç¨‹â€</h3>
<p>è¿™æ˜¯æ–°æ‰‹å¼€å‘è€…æœ€å®¹æ˜“è¸©çš„å‘ã€‚æˆ‘ä»¬çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªè€—æ—¶è®¡ç®—</span>
void <span class="hljs-built_in">heavyTask</span>() {
  <span class="hljs-selector-tag">var</span> count = <span class="hljs-number">0</span>;
  for (int i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000000</span>; i++) { count += <span class="hljs-selector-tag">i</span>; }
  <span class="hljs-built_in">print</span>("è®¡ç®—å®Œæˆ");
}

void <span class="hljs-built_in">onTap</span>() async {
  <span class="hljs-comment">// è¯¯åŒºï¼šä»¥ä¸ºåŠ äº† Future å°±ä¸å¡äº†</span>
  await <span class="hljs-built_in">Future</span>(() =&gt; <span class="hljs-built_in">heavyTask</span>()); 
  <span class="hljs-built_in">print</span>("UI åˆ·æ–°");
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™ä¾ç„¶ä¼šå¡æ­» UIï¼Ÿ</strong></p>
<p>å› ä¸º <code>Future</code> å’Œ <code>async/await</code> åœ¨å¤„ç† <strong>CPU å¯†é›†å‹ä»»åŠ¡</strong> æ—¶ï¼Œæä¾›çš„æ˜¯ä¸€ç§ <strong>â€œå‡å¼‚æ­¥â€</strong> ã€‚</p>
<p>Dart å¯¹å¾…ä»»åŠ¡æœ‰ä¸¤ç§æˆªç„¶ä¸åŒçš„å¤„ç†æ–¹å¼ï¼š</p>
<ol>
<li>
<p><strong>çœŸå¤–åŒ… (I/O æ“ä½œ)</strong> ï¼š</p>
<ul>
<li>æ¯”å¦‚ <code>http.get</code> æˆ–è¯»å†™æ–‡ä»¶ã€‚Dart ç¡®å®æŠŠä»»åŠ¡å¤–åŒ…ç»™äº†æ“ä½œç³»ç»Ÿã€‚ä¸»å¨ï¼ˆMain Isolateï¼‰æŠŠå•å­ç”©å‡ºå»å°±ä¸ç®¡äº†ï¼Œç»§ç»­åšèœï¼ˆåˆ·æ–° UIï¼‰ã€‚ç­‰æ“ä½œç³»ç»Ÿæå®šåï¼Œé€šè¿‡ä¸­æ–­é€šçŸ¥ Dartï¼ŒDart å†æŠŠç»“æœæ”¾å› Event Queueã€‚<strong>è¿™ç¡®å®ä¸å¡ UIã€‚</strong></li>
</ul>
</li>
<li>
<p><strong>å‡å¼‚æ­¥ (CPU è®¡ç®—)</strong> ï¼š</p>
<ul>
<li>
<p>æ¯”å¦‚ä¸Šé¢çš„ <code>heavyTask</code>ã€‚Dart æ— æ³•å¤–åŒ…â€œå¾ªç¯è®¡ç®—â€ï¼Œè¿™å¿…é¡»ç”± CPU äº²è‡ªæ‰§è¡Œã€‚</p>
</li>
<li>
<p><code>Future</code> æ‰€åšçš„ï¼Œä»…ä»…æ˜¯æŠŠè¿™ä¸ªæ²‰é‡çš„è®¡ç®—ä»»åŠ¡æ‰“åŒ…æˆä¸€ä¸ª Eventï¼Œ<strong>æ’é˜Ÿ</strong> åˆ°äº† Event Queue çš„æœ«å°¾ã€‚</p>
</li>
<li>
<p><strong>åæœ</strong>ï¼šè™½ç„¶å½“ä¸‹æ²¡å¡ï¼Œä½†ç­‰ Event Loop è½®åˆ°è¿™ä¸ªä»»åŠ¡æ—¶ï¼ŒMain Isolate å¿…é¡»äº²è‡ªä¸Šé˜µè®¡ç®—ã€‚åœ¨è®¡ç®—çš„é‚£å‡ ç§’é’Ÿé‡Œï¼Œå®ƒæ— æ³•å¤„ç† UI ç»˜åˆ¶ï¼ŒApp ä¾ç„¶å¡æ­»ã€‚</p>
</li>
</ul>
</li>
</ol>
<h3 data-id="heading-8">1.5 ç ´å±€ï¼šå¹¶å‘ (Concurrency) vs å¹¶è¡Œ (Parallelism)</h3>
<p>è‡³æ­¤ï¼ŒçŸ›ç›¾å·²ç»éå¸¸æ¸…æ™°äº†ï¼š</p>
<ul>
<li>
<p><strong>Main Isolate</strong> å¤ªå¿™äº†ï¼Œæ—¢è¦æ¸²æŸ“ UI åˆè¦è·‘é€»è¾‘ã€‚</p>
</li>
<li>
<p><strong>Future</strong> åªæ˜¯æ”¹å˜äº†ä»»åŠ¡æ‰§è¡Œçš„é¡ºåºï¼ˆå¹¶å‘ï¼‰ï¼Œå¹¶æ²¡æœ‰å¢åŠ å¹²æ´»çš„äººæ‰‹ã€‚</p>
</li>
</ul>
<p>å¦‚æœä½ çš„ä»»åŠ¡æ˜¯â€œç­‰å¾…å‹â€ï¼ˆI/Oï¼‰ï¼Œ<code>Future</code> è¶³å¤Ÿäº†ã€‚ä½†å¦‚æœä½ çš„ä»»åŠ¡æ˜¯â€œè®¡ç®—å‹â€ï¼ˆCPUï¼‰ï¼Œä½ éœ€è¦çš„ä¸æ˜¯æ›´å¥½çš„æ’é˜ŸæŠ€å·§ï¼Œè€Œæ˜¯<strong>é›‡ä½£ä¸€ä¸ªæ–°çš„å¨å¸ˆ</strong>ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦ä» <strong>å¹¶å‘ (Concurrency)</strong> èµ°å‘çœŸæ­£çš„ <strong>å¹¶è¡Œ (Parallelism)</strong> ã€‚</p>
<p>åœ¨ Dart ä¸­ï¼Œè¿™ä¸ªâ€œæ–°å¨å¸ˆâ€ï¼Œå°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦æ·±å…¥æ¢è®¨çš„ä¸»è§’ â€”â€” <strong>Isolate</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-9">ç¬¬äºŒç« ï¼šå…¨è²Œ â€”â€” Isolate åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>åœ¨ç¬¬ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»æ˜ç¡®äº†ä¸€ä¸ªæ®‹é…·çš„ç°å®ï¼šMain Isolate è¿™ä½â€œç‹¬è£è€…â€å¤ªå¿™äº†ï¼Œä»»ä½•è€—æ—¶çš„ CPU è®¡ç®—éƒ½ä¼šå¯¼è‡´ UI å¡é¡¿ã€‚ä¸ºäº†æ‰“ç ´å•çº¿ç¨‹çš„ç‰©ç†é™åˆ¶ï¼Œæˆ‘ä»¬éœ€è¦â€œé›‡ä½£æ–°å¨å¸ˆâ€ã€‚</p>
<p>åœ¨ Dart çš„ä¸–ç•Œé‡Œï¼Œè¿™ä¸ªæ–°å¨å¸ˆå°±æ˜¯ <strong>Isolate</strong>ã€‚</p>
<p>æœ¬ç« å°†å¸¦ä½ å‰¥å¼€ Isolate çš„å¤–å£³ï¼Œä»åº•å±‚å†…å­˜æ¨¡å‹å’Œæ¶æ„è®¾è®¡ä¸Šï¼Œé‡æ–°è®¤è¯†è¿™ä¸ªå¹¶å‘å®ä½“ã€‚</p>
<h3 data-id="heading-10">2.1 å®šä¹‰ï¼šæŠ«ç€çº¿ç¨‹çš®çš„â€œå¾®å‹è¿›ç¨‹â€</h3>
<p>Isolate çš„ä¸­æ–‡ç›´è¯‘æ˜¯ <strong>â€œéš”ç¦»åŒºâ€</strong> ã€‚è¿™ä¸ªåå­—æå…¶ç²¾å‡†åœ°é“å‡ºäº†å®ƒçš„æ ¸å¿ƒç‰¹å¾ã€‚</p>
<ul>
<li>
<p><strong>ç‰©ç†çœŸç›¸ï¼ˆæ“ä½œç³»ç»Ÿè§†è§’ï¼‰</strong> ï¼šIsolate ç¡®å®æ˜¯ä¸€ä¸ª <strong>çº¿ç¨‹ï¼ˆThreadï¼‰</strong> ã€‚å®ƒç”±åº•å±‚æ“ä½œç³»ç»Ÿè°ƒåº¦ï¼Œèƒ½å¤ŸçœŸæ­£åˆ©ç”¨å¤šæ ¸ CPU çš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›ã€‚</p>
</li>
<li>
<p><strong>é€»è¾‘çœŸç›¸ï¼ˆä»£ç è¿è¡Œè§†è§’ï¼‰</strong> ï¼šå®ƒæ›´åƒæ˜¯ä¸€ä¸ª <strong>å¾®å‹è¿›ç¨‹ï¼ˆMini Processï¼‰</strong> ã€‚å› ä¸ºå®ƒâ€œå…­äº²ä¸è®¤â€ï¼Œæ‹¥æœ‰æå¼ºçš„ç‹¬ç«‹æ€§ã€‚</p>
</li>
</ul>
<p>éœ€è¦çº æ­£çš„ä¸€ä¸ªè¯¯åŒºæ˜¯ï¼š<strong>Main Isolate å¹¶æ²¡æœ‰ä»€ä¹ˆç¥æƒã€‚</strong> å®ƒæœ¬è´¨ä¸Šå’Œä½ åœ¨åå°åˆ›å»ºçš„ Isolate ä¸€æ¨¡ä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«ä»…ä»…æ˜¯å®ƒå¯åŠ¨å¾—æœ€æ—©ï¼Œå¹¶ç»‘å®šäº† UI æ¸²æŸ“å¼•æ“è€Œå·²ã€‚</p>
<h3 data-id="heading-11">2.2 å†…å­˜æ¨¡å‹ï¼šShared Memory vs Message Passing</h3>
<p>è¿™æ˜¯ Dart Isolate ä¸ Java/C++ ç­‰ä¼ ç»Ÿå¤šçº¿ç¨‹æ¨¡å‹æœ€å¤§çš„åˆ†æ°´å²­ã€‚</p>
<h4 data-id="heading-12">ä¼ ç»Ÿå¤šçº¿ç¨‹æ¨¡å‹ï¼ˆJava/C++ï¼‰</h4>
<p>åœ¨ Java ä¸­ï¼Œå¤šä¸ªçº¿ç¨‹ç”Ÿæ´»åœ¨åŒä¸€ä¸ªâ€œå±‹æªä¸‹â€ï¼š</p>
<ul>
<li>
<p><strong>å…±äº«å †å†…å­˜ï¼ˆShared Heapï¼‰</strong> ï¼šçº¿ç¨‹ A åˆ›å»ºçš„å…¨å±€å˜é‡ï¼Œçº¿ç¨‹ B å¯ä»¥ç›´æ¥è¯»å–ç”šè‡³ä¿®æ”¹ã€‚</p>
</li>
<li>
<p><strong>ä»£ä»·</strong>ï¼šä¾¿åˆ©çš„ä»£ä»·æ˜¯å±é™©ã€‚ä¸ºäº†é˜²æ­¢ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹åŒä¸€ä¸ªå˜é‡ï¼ˆç«æ€æ¡ä»¶ï¼‰ï¼Œå¼€å‘è€…å¿…é¡»å°å¿ƒç¿¼ç¿¼åœ°åŠ  <strong>é”ï¼ˆLockï¼‰</strong> ï¼ˆå¦‚ <code>synchronized</code>ï¼‰ã€‚ä¸€æ—¦é”æ²¡è®¾è®¡å¥½ï¼Œå°±ä¼šå¯¼è‡´æ­»é”ï¼ˆDeadlockï¼‰æˆ–è€…æ•°æ®é”™ä¹±ã€‚</p>
</li>
</ul>
<h4 data-id="heading-13">Dart Isolate æ¨¡å‹</h4>
<p>Dart é€‰æ‹©äº†å¦ä¸€æ¡è·¯ï¼š<strong>å†…å­˜éš”ç¦»ï¼ˆMemory Isolationï¼‰</strong> ã€‚</p>
<ul>
<li>
<p><strong>ç‹¬ç«‹å †å†…å­˜</strong>ï¼šæ¯ä¸ª Isolate éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å †å†…å­˜ï¼ˆHeapï¼‰ã€‚Isolate A é‡Œçš„å˜é‡ï¼ŒIsolate B æ ¹æœ¬çœ‹ä¸è§ï¼Œæ›´æ‘¸ä¸ç€ã€‚</p>
</li>
<li>
<p><strong>æ— é”ç¼–ç¨‹</strong>ï¼šå› ä¸ºæ ¹æœ¬æ— æ³•å…±äº«å˜é‡ï¼Œæ‰€ä»¥ Dart ç”šè‡³æ²¡æœ‰â€œçº¿ç¨‹é”â€è¿™ç§ä¸œè¥¿ã€‚ä½ æ°¸è¿œä¸éœ€è¦æ‹…å¿ƒæ­»é”é—®é¢˜ã€‚</p>
</li>
<li>
<p><strong>ç‹¬ç«‹ GC</strong>ï¼šæ¯ä¸ª Isolate çš„åƒåœ¾å›æ”¶å™¨ï¼ˆGCï¼‰ä¹Ÿæ˜¯ç‹¬ç«‹çš„ã€‚åå° Isolate åœ¨ç–¯ç‹‚ GC æ—¶ï¼Œä¸æ¯«ä¸ä¼šå½±å“ Main Isolate çš„è¿è¡Œï¼Œä¹Ÿå°±ä¸ä¼šé€ æˆ UI çš„â€œGC å¡é¡¿â€ã€‚</p>
</li>
</ul>
<blockquote>
<p><strong>å“²å­¦å¼•è¨€</strong>ï¼šGo è¯­è¨€æœ‰ä¸€å¥åè¨€ï¼ŒåŒæ ·é€‚ç”¨äº Dartï¼šâ€œä¸è¦é€šè¿‡å…±äº«å†…å­˜æ¥é€šä¿¡ï¼Œè€Œè¦é€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜ã€‚â€</p>
</blockquote>
<h3 data-id="heading-14">2.3 è§£å‰–å®¤ï¼šéº»é›€è™½å°ï¼Œäº”è„ä¿±å…¨</h3>
<p>Isolate ä¸æ˜¯ä¸€ä¸ªè½»é‡çº§çš„å¯¹è±¡ï¼ˆæ¯”å¦‚åç¨‹ï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ª<strong>é‡èµ„äº§</strong>ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½åƒåˆ›å»º <code>Future</code> é‚£æ ·éšæ„åˆ›å»ºæˆåƒä¸Šä¸‡ä¸ª Isolate çš„åŸå› ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬åˆ‡å¼€ä¸€ä¸ª Isolateï¼Œä½ ä¼šå‘ç°å®ƒå†…éƒ¨è‡ªå¸¦äº†ä¸€å¥—å®Œæ•´çš„â€œåŸºå»ºâ€ï¼š</p>
<ol>
<li>
<p><strong>ç‹¬ç«‹çš„ Heapï¼ˆå †å†…å­˜ï¼‰</strong> ï¼šç”¨äºå­˜æ”¾è¯¥ Isolate åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡ã€‚</p>
</li>
<li>
<p><strong>ç‹¬ç«‹çš„ Event Loopï¼ˆäº‹ä»¶å¾ªç¯ï¼‰</strong> ï¼šæ²¡é”™ï¼Œæ¯ä¸ªåå° Isolate å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„â€œé“¶è¡ŒæŸœå‘˜â€ã€‚å®ƒå¯åŠ¨åå°±ä¼šè¿›å…¥å¾ªç¯ï¼Œç­‰å¾…æ¥æ”¶å¹¶å¤„ç†æ¶ˆæ¯ã€‚</p>
</li>
<li>
<p><strong>ç‹¬ç«‹çš„ Stackï¼ˆæ ˆï¼‰</strong> ï¼šç”¨äºå‡½æ•°è°ƒç”¨å’Œå±€éƒ¨å˜é‡ã€‚</p>
</li>
<li>
<p><strong>Message Handlerï¼ˆæ¶ˆæ¯å¤„ç†å™¨ï¼‰</strong> ï¼šä¸“é—¨è´Ÿè´£å¤„ç†ç«¯å£æ¶ˆæ¯çš„åº•å±‚ç»„ä»¶ã€‚</p>
</li>
</ol>
<h4 data-id="heading-15">2.3.1 è¿›é˜¶çŸ¥è¯†ï¼šIsolate Groups ä¸è½»é‡åŒ–é©å‘½</h4>
<p>çœ‹åˆ°è¿™é‡Œï¼Œç»†å¿ƒçš„è¯»è€…å¯èƒ½ä¼šé—®ï¼šâ€œå¦‚æœæ¯ä¸ª Isolate éƒ½è¿™ä¹ˆé‡ï¼Œä¸ºä»€ä¹ˆ Flutter ç°åœ¨çš„æ€§èƒ½è¿™ä¹ˆå¥½ï¼Œç”šè‡³èƒ½æ”¯æŒ run è¿™ç§å³ç”¨å³æ¯çš„ APIï¼Ÿâ€</p>
<p>ç§˜å¯†åœ¨äº Dart 2.15 å¼•å…¥çš„åº•å±‚é»‘ç§‘æŠ€ â€”â€” <strong>Isolate Groupsï¼ˆéš”ç¦»ç¾¤ç»„ï¼‰ã€‚</strong></p>
<p>åœ¨æ—§ç‰ˆæœ¬ä¸­ï¼Œæ¯åˆ›å»ºä¸€ä¸ªæ–° Isolateï¼ŒVM éƒ½è¦æŠŠä»£ç é‡æ–°æ‹·è´ä¸€ä»½åˆ°æ–°å†…å­˜ä¸­ã€‚ä½†åœ¨ç°ä»£ Dart ä¸­ï¼Œé€šè¿‡ Isolate.spawn åˆ›å»ºçš„çº¿ç¨‹é»˜è®¤ä¼šåŠ å…¥åŒä¸€ä¸ª Groupã€‚</p>
<p><strong>Isolate Groups çš„æ ¸å¿ƒé€»è¾‘æ˜¯ï¼šâ€œå…±äº«é€»è¾‘ï¼Œéš”ç¦»æ•°æ®â€ã€‚</strong></p>
<ul>
<li>
<p>å…±äº«ä»£ç æŒ‡ä»¤ï¼ˆShared Codeï¼‰ï¼š å°±å¥½æ¯”é¤å…é‡Œçš„å¨å¸ˆã€‚ä»¥å‰æ‹›ä¸€ä¸ªæ–°å¨å¸ˆï¼Œå¿…é¡»ç»™ä»–ä¹°ä¸€æœ¬æ–°çš„ã€Šçƒ¹é¥ªå¤§å…¨ã€‹ï¼ˆä»£ç æŒ‡ä»¤ï¼‰ã€‚ç°åœ¨ï¼Œæ‰€æœ‰å¨å¸ˆå…±ç”¨å¢™ä¸Šçš„ä¸€å—ç”µå­å¤§å±å¹•ï¼ˆå…±äº«å†…å­˜åŒºåŸŸï¼‰æ¥çœ‹èœè°±ã€‚ æ— è®ºä½ å¼€ 10 ä¸ªè¿˜æ˜¯ 100 ä¸ª Isolateï¼Œä»£ç åœ¨å†…å­˜ä¸­æ°¸è¿œåªå ä¸€ä»½ç©ºé—´ã€‚</p>
</li>
<li>
<p>ç‹¬ç«‹å †æ•°æ®ï¼ˆIndependent Heapï¼‰ï¼š è™½ç„¶èœè°±å¤§å®¶ä¸€èµ·çœ‹ï¼Œä½†æ¯ä¸ªå¨å¸ˆæ‰‹é‡Œçš„**é”…å’Œé£Ÿæï¼ˆå˜é‡æ•°æ®ï¼‰**ä¾ç„¶æ˜¯ç§æœ‰çš„ï¼Œç»å¯¹äº’ä¸å¹²æ‰°ã€‚</p>
</li>
</ul>
<p><strong>å†…å­˜å…¬å¼å¯¹æ¯”</strong>ï¼š</p>
<ul>
<li>
<p>æ—§ç‰ˆæœ¬ï¼šå†…å­˜å ç”¨ = (ä»£ç ä½“ç§¯ + å †æ•°æ®) Ã— Isolateæ•°é‡</p>
</li>
<li>
<p>æ–°ç‰ˆæœ¬ï¼šå†…å­˜å ç”¨ = ä»£ç ä½“ç§¯ Ã— 1 + (å †æ•°æ® Ã— Isolateæ•°é‡)</p>
</li>
</ul>
<p>æ­£æ˜¯å› ä¸º Isolate Groupsï¼Œæ–° Isolate çš„å¯åŠ¨æ—¶é—´ä» æ¯«ç§’çº§ï¼ˆmsï¼‰ é£è·ƒåˆ°äº† å¾®ç§’çº§ï¼ˆusï¼‰ï¼Œå†…å­˜å¼€é”€ä¹Ÿé™ä½äº†æ•°åå€ã€‚è¿™ä¸ºæˆ‘ä»¬åç»­ä½¿ç”¨ Isolate.run æä¾›äº†åšå®çš„åº•å±‚åº•æ°”ã€‚</p>
<h3 data-id="heading-16">2.4 é€šä¿¡æœºåˆ¶ï¼šActor æ¨¡å‹</h3>
<p>æ—¢ç„¶å†…å­˜è¢«ä¸€å µå¢™éš”å¼€äº†ï¼ŒIsolate ä¹‹é—´å¦‚ä½•åä½œï¼Ÿ Dart é‡‡ç”¨çš„æ˜¯ç±»ä¼¼äº <strong>Actor æ¨¡å‹</strong> çš„æœºåˆ¶ï¼š<strong>æ¶ˆæ¯ä¼ é€’ï¼ˆMessage Passingï¼‰</strong> ã€‚</p>
<p>ä½ å¯ä»¥æŠŠä¸¤ä¸ª Isolate æƒ³è±¡æˆä½åœ¨ä¸¤ä¸ªä¸åŒå²›å±¿ä¸Šçš„äººï¼š</p>
<ul>
<li>
<p>ä»–ä»¬ä¸èƒ½ç›´æ¥å–Šè¯ï¼ˆä¸å…±äº«å†…å­˜ï¼‰ã€‚</p>
</li>
<li>
<p>ä»–ä»¬å¿…é¡»é€šè¿‡**æ¼‚æµç“¶ï¼ˆPortï¼‰**æ¥äº¤æµã€‚</p>
</li>
</ul>
<h4 data-id="heading-17">æ ¸å¿ƒç»„ä»¶ï¼š</h4>
<ul>
<li>
<p><strong>ReceivePortï¼ˆæ”¶ä¿¡ç®±ï¼‰</strong> ï¼š</p>
<ul>
<li>
<p>å±äºå½“å‰ Isolateã€‚</p>
</li>
<li>
<p>è¿™æ˜¯ä¸€ä¸ª<strong>é•¿æœŸç›‘å¬</strong>çš„æµï¼ˆStreamï¼‰ã€‚</p>
</li>
<li>
<p><em>éšå–»</em>ï¼šè¿™æ˜¯ä½ å²›ä¸Šçš„è‡ªå®¶ä¿¡ç®±ï¼Œåªæœ‰ä½ èƒ½æ‰“å¼€çœ‹é‡Œé¢çš„ä¿¡ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>SendPortï¼ˆå¯„ä¿¡åœ°å€ï¼‰</strong> ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-go" lang="go">è¿™æ˜¯ <span class="hljs-string">`ReceivePort`</span> å¯¹åº”çš„â€œåœ°å€â€ã€‚
</code></pre>
</li>
<li>
<p>å®ƒæ˜¯ä¸€ä¸ª<strong>èƒ½åŠ›ï¼ˆCapabilityï¼‰</strong> ï¼Œå¯ä»¥è¢«å‘é€ç»™å…¶ä»– Isolateã€‚</p>
</li>
<li>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-emphasis">*éšå–»*</span>ï¼šè¿™æ˜¯ä½ çš„åç‰‡ã€‚ä½ æŠŠåç‰‡å‘ç»™è°ï¼Œè°å°±å¯ä»¥å¾€ä½ çš„ä¿¡ç®±é‡ŒæŠ•é€’æ¶ˆæ¯ã€‚
</code></pre>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-18">é€šä¿¡çš„æœ¬è´¨ï¼š</h4>
<p>å½“ Isolate A æƒ³è¦æŠŠæ•°æ®å‘ç»™ Isolate B æ—¶ï¼Œå®ƒä¸èƒ½ç›´æ¥ä¼ å¼•ç”¨ï¼ˆå› ä¸ºå†…å­˜ä¸å…±äº«ï¼‰ã€‚ å®ƒå¿…é¡»æŠŠæ•°æ® <strong>â€œåºåˆ—åŒ–â€</strong> ï¼ˆæ‰“åŒ…ï¼‰ï¼Œé€šè¿‡åº•å±‚çš„ C++ é€šé“ä¼ è¿‡å»ï¼ŒIsolate B æ”¶åˆ°åå† <strong>â€œååºåˆ—åŒ–â€</strong> ï¼ˆè§£åŒ…ï¼‰ã€‚</p>
<p>è¿™ä¸ªè¿‡ç¨‹åœ¨å†å²ä¸Šæ˜¯æœ‰æ€§èƒ½ä»£ä»·çš„ï¼ˆDeep Copyï¼‰ï¼Œä½†åœ¨ Dart çš„æœ€æ–°ç‰ˆæœ¬ä¸­ï¼Œè¿™ä¸€æœºåˆ¶è¿æ¥äº†é©å‘½æ€§çš„ä¼˜åŒ–ï¼ˆIsolate.exitï¼‰ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç« çš„â€œå®æˆ˜â€ä¸­è¯¦ç»†æ‹†è§£ã€‚</p>
<hr/>
<h2 data-id="heading-19">ç¬¬ä¸‰ç« ï¼šå®æˆ˜ â€”â€” ä¸‰ç§æ­¦å™¨çš„æ¼”è¿›</h2>
<p>äº†è§£äº† Isolate çš„åº•å±‚éš”ç¦»åŸç†åï¼Œæˆ‘ä»¬å›åˆ°äº†ç°å®çš„å¼€å‘æˆ˜åœºã€‚Dart çš„å¹¶å‘å·¥å…·ç®±å¹¶éä¸€æˆä¸å˜ï¼Œå®ƒç»å†äº†ä¸€ä¸ªä»â€œç¬¨é‡â€åˆ°â€œæè‡´â€çš„æ¼”è¿›è¿‡ç¨‹ã€‚</p>
<p>ç›®å‰çš„æœ€ä½³å®è·µï¼Œå¯ä»¥æ¦‚æ‹¬ä¸ºä¸‰ç§ä¸åŒé‡çº§çš„æ­¦å™¨ï¼š<code>compute</code> <strong>ï¼ˆä¸Šå¤ç¥å™¨ï¼‰</strong> ã€<code>Isolate.run</code> <strong>ï¼ˆç°ä»£å…µå™¨ï¼‰</strong> å’Œ <code>Isolate.spawn</code> <strong>ï¼ˆé‡å‹æ­¦å™¨ï¼‰</strong> ã€‚</p>
<h3 data-id="heading-20">3.1 ä¸Šå¤ç¥å™¨ï¼š<code>compute</code> â€”â€” ç®€å•ä½†æœ‰ä»£ä»·</h3>
<p>åœ¨ Flutter çš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼Œ<code>compute</code> æ˜¯å®˜æ–¹æä¾›çš„å”¯ä¸€â€œä¸€é”®å¼â€æ–¹æ¡ˆã€‚</p>
<ul>
<li>
<p><strong>å®šä½</strong>ï¼š <strong>â€œä¸€é”¤å­ä¹°å–â€çš„æ•°æ®æ¬è¿å·¥</strong>ã€‚</p>
</li>
<li>
<p><strong>ç”¨æ³•</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// æ¥æ”¶ä¸€ä¸ªé¡¶å±‚å‡½æ•°å’Œä¸€ä¸ªå‚æ•°ï¼Œè‡ªåŠ¨åˆ›å»ºçº¿ç¨‹å¹¶è®¡ç®—
final <span class="hljs-attr">result</span> = await compute(heavyAlgo, data)<span class="hljs-comment">;</span>
</code></pre>
</li>
</ul>
<h4 data-id="heading-21">ç—›ç‚¹ï¼šæ•°æ®çš„â€œæ¬è¿â€æˆæœ¬</h4>
<p><code>compute</code> è™½ç„¶å¥½ç”¨ï¼Œä½†å®ƒåœ¨ Dart 2.19 ä¹‹å‰å­˜åœ¨ä¸€ä¸ªæ˜¾è‘—çš„æ€§èƒ½ç“¶é¢ˆã€‚å®ƒåœ¨å†…éƒ¨æ‰§è¡Œäº†å®Œæ•´çš„ï¼š<strong>Spawnï¼ˆåˆ›å»ºï¼‰ -&gt; Copy Inï¼ˆä¼ å…¥ï¼‰ -&gt; Workï¼ˆè®¡ç®—ï¼‰ -&gt; Copy Outï¼ˆä¼ å‡ºï¼‰ -&gt; Killï¼ˆé”€æ¯ï¼‰</strong> æµç¨‹ã€‚</p>
<p>è¿™é‡Œæœ€å¤§çš„ç—›ç‚¹åœ¨äº <strong>Copy Out</strong>ã€‚</p>
<p>å‡è®¾å­çº¿ç¨‹å¤„ç†å®Œäº†ä¸€å¼  4K å›¾ç‰‡ï¼Œç”Ÿæˆäº† 50MB çš„æ•°æ®è¦è¿”å›ç»™ä¸»çº¿ç¨‹ã€‚</p>
<ul>
<li>
<p><strong>åŠ¨ä½œ</strong>ï¼šDart VM å¿…é¡»åœ¨ä¸»çº¿ç¨‹ç”³è¯·æ–°çš„ 50MB å†…å­˜ï¼Œç„¶åæŠŠå­çº¿ç¨‹çš„æ•°æ®é€å­—èŠ‚**å¤åˆ¶ï¼ˆDeep Copyï¼‰**è¿‡æ¥ã€‚</p>
</li>
<li>
<p><strong>åæœ</strong>ï¼šè™½ç„¶è®¡ç®—æ˜¯åœ¨åå°åšçš„ï¼Œä½†åœ¨<strong>æ¥æ”¶ç»“æœçš„é‚£ä¸€ç¬é—´</strong>ï¼Œä¸»çº¿ç¨‹å› ä¸ºè¦è¿›è¡Œç¹é‡çš„å†…å­˜å†™å…¥æ“ä½œï¼Œä¾ç„¶å¯èƒ½å‡ºç°æ‰å¸§ã€‚</p>
</li>
</ul>
<h3 data-id="heading-22">3.2 ç°ä»£å…µå™¨ï¼š<code>Isolate.run</code> â€”â€” æ€§èƒ½é©å‘½</h3>
<p>ä¸ºäº†è§£å†³æ‹·è´æˆæœ¬ï¼ŒDart 2.19ï¼ˆFlutter 3.7+ï¼‰å¼•å…¥äº† <code>Isolate.run</code>ã€‚è¿™æ˜¯å¹¶å‘ç¼–ç¨‹çš„ä¸€æ¬¡â€œé™ç»´æ‰“å‡»â€ã€‚</p>
<h4 data-id="heading-23">3.2.1 æ ¸å¿ƒé»‘ç§‘æŠ€ï¼šZero-Copy (é›¶æ‹·è´)</h4>
<p><code>Isolate.run</code> ä¹‹æ‰€ä»¥è¢«èª‰ä¸ºç°ä»£å…µå™¨ï¼Œæ˜¯å› ä¸ºå®ƒåœ¨è¿”å›ç»“æœæ—¶ï¼Œå¼•å…¥äº†åº•å±‚çš„ <code>Isolate.exit</code> æœºåˆ¶ï¼Œå®ç°äº† <strong>å†…å­˜æ‰€æœ‰æƒè½¬ç§» (Ownership Transfer)</strong> ã€‚</p>
<p>è®©æˆ‘ä»¬å¯¹æ¯”ä¸€ä¸‹â€œä¼ ç»Ÿæ¨¡å¼â€å’Œâ€œæ–°æ¨¡å¼â€çš„åŒºåˆ«ï¼š</p>
<ul>
<li>
<p><strong>ä¼ ç»Ÿæ¨¡å¼ (SendPort.send) â€”â€” æ¬è¿å·¥æ¨¡å¼</strong></p>
<ul>
<li>
<p>å­çº¿ç¨‹æœ‰ 100MB ç»“æœã€‚</p>
</li>
<li>
<p>VM åœ¨ä¸»çº¿ç¨‹<strong>å¤å°</strong>ä¸€ä»½ã€‚</p>
</li>
<li>
<p>é”€æ¯å­çº¿ç¨‹çš„ 100MBã€‚</p>
</li>
<li>
<p><strong>è€—æ—¶ï¼šO(N)</strong> ï¼Œæ•°æ®è¶Šå¤§è¶Šæ…¢ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>æ–°æ¨¡å¼ (Isolate.run / exit) â€”â€” æˆ¿äº§è¿‡æˆ·æ¨¡å¼</strong></p>
<ul>
<li>
<p>å­çº¿ç¨‹æœ‰ 100MB ç»“æœï¼ˆå ç”¨ç‰©ç†å†…å­˜é¡µ #A, #Bï¼‰ã€‚</p>
</li>
<li>
<p>å­çº¿ç¨‹ä»»åŠ¡ç»“æŸï¼ŒVM ä»‹å…¥ã€‚</p>
</li>
<li>
<p>VM <strong>ä¸å¤åˆ¶æ•°æ®</strong>ï¼Œè€Œæ˜¯ç›´æ¥ä¿®æ”¹å†…å­˜é¡µ #A, #B çš„<strong>å½’å±æƒæ ‡ç­¾</strong>ã€‚</p>
</li>
<li>
<p>VM å®£å¸ƒï¼šâ€œè¿™ä¸¤é¡µå†…å­˜ç°åœ¨å½’ Main Isolate æ‰€æœ‰äº†ã€‚â€</p>
</li>
<li>
<p><strong>è€—æ—¶ï¼šO(1)</strong> ã€‚æ— è®ºæ•°æ®æ˜¯ 1KB è¿˜æ˜¯ 1GBï¼Œè¿”å›è€—æ—¶å‡ ä¹ä¸º 0ã€‚</p>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-24">3.2.2 é—­åŒ…çš„â€œç”œèœœé™·é˜±â€</h4>
<p><code>Isolate.run</code> çš„ API è®¾è®¡éå¸¸ä¼˜é›…ï¼Œå®ƒå…è®¸ç›´æ¥ä¼ å…¥é—­åŒ…ï¼ˆClosureï¼‰ï¼Œå†™èµ·æ¥å°±åƒæ™®é€šçš„ <code>Future</code> ä¸€æ ·è‡ªç„¶ï¼š</p>
<p>Dart</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">void</span> process() <span class="hljs-keyword">async</span> {
  <span class="hljs-keyword">final</span> rawData = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
  <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨é—­åŒ…ï¼Œçœ‹èµ·æ¥å¾ˆç¾å¥½</span>
  <span class="hljs-keyword">final</span> result = <span class="hljs-keyword">await</span> Isolate.run(() {
    <span class="hljs-keyword">return</span> rawData.map((e) =&gt; e * <span class="hljs-number">2</span>).toList();
  });
}
</code></pre>
<p>ä½†è¿™èƒŒåéšè—ç€ä¸€ä¸ªå·¨å¤§çš„é™·é˜±ï¼š<strong>éšå¼æ•è·</strong>ã€‚</p>
<p><strong>åŸç†</strong>ï¼šå½“ä½ æŠŠä¸€ä¸ªé—­åŒ…ä¼ ç»™ Isolate æ—¶ï¼ŒDart ä¼šå°è¯•æŠŠè¿™ä¸ªé—­åŒ…<strong>è¿åŒå®ƒæ•è·çš„æ‰€æœ‰ä¸Šä¸‹æ–‡</strong>ä¸€èµ·æ‰“åŒ…ï¼ˆæ·±æ‹·è´ï¼‰å‘é€è¿‡å»ã€‚</p>
<p><strong>å´©æºƒåœºæ™¯</strong>ï¼š</p>
<p>å¦‚æœä½ åœ¨ç±»çš„æ–¹æ³•ä¸­ç›´æ¥ä½¿ç”¨ <code>Isolate.run</code>ï¼Œé—­åŒ…å¾€å¾€ä¼šéšå¼æ•è· <code>this</code>ã€‚è€Œå¦‚æœ <code>this</code>ï¼ˆå½“å‰å®ä¾‹ï¼‰ä¸­åŒ…å«äº† <strong>Socketã€Streamã€UI æ§ä»¶ï¼ˆWidget/Contextï¼‰</strong> ç­‰ä¸å¯ä¼ è¾“çš„å¯¹è±¡ï¼Œä»£ç ä¼šç›´æ¥å´©æºƒã€‚</p>
<p>Dart</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// âŒ é”™è¯¯ç¤ºèŒƒï¼šéšå¼æ•è·äº† this</span>
<span class="hljs-keyword">class</span> <span class="hljs-title">MyViewModel</span> {
  final BuildContext context; <span class="hljs-comment">// ä¸å¯ä¼ è¾“ï¼</span>
  MyViewModel(<span class="hljs-keyword">this</span>.context);

  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">heavyTask</span>() <span class="hljs-keyword">async</span></span> {
    <span class="hljs-keyword">await</span> Isolate.run(() {
      <span class="hljs-comment">// è¿™é‡Œçš„ print éšå¼è°ƒç”¨äº† this.toString()</span>
      <span class="hljs-comment">// å¯¼è‡´ VM è¯•å›¾æŠŠæ•´ä¸ª MyViewModel (å« context) æ‹·è´è¿‡å» -&gt; Crash!</span>
      print(<span class="hljs-string">"Task done"</span>); 
    });
  }
}
</code></pre>
<p><strong>âœ… æœ€ä½³å®è·µ</strong>ï¼š <strong>â€œå‡€èº«å‡ºæˆ·â€</strong> ã€‚</p>
<p>åœ¨è¿›å…¥é—­åŒ…å‰ï¼ŒæŠŠéœ€è¦çš„æ•°æ®æå–ä¸º<strong>å±€éƒ¨å˜é‡</strong>ï¼ˆå¦‚ <code>int</code>, <code>String</code>, <code>List</code>ï¼‰ï¼Œç¡®ä¿é—­åŒ…åªæ•è·çº¯æ•°æ®ã€‚</p>
<p>Dart</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// âœ… æ­£ç¡®ç¤ºèŒƒ</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">heavyTask</span>() <span class="hljs-keyword">async</span></span> {
  final dataToProcess = <span class="hljs-string">"Clean String"</span>; <span class="hljs-comment">// æå–å±€éƒ¨å˜é‡</span>
  
  <span class="hljs-keyword">await</span> Isolate.run(() {
    <span class="hljs-comment">// é—­åŒ…åªæ•è·äº† Stringï¼Œéå¸¸å®‰å…¨</span>
    print(dataToProcess); 
  });
}
</code></pre>
<h3 data-id="heading-25">3.3 é‡å‹æ­¦å™¨ï¼š<code>Isolate.spawn</code> â€”â€” é•¿è¿æ¥åŸºçŸ³</h3>
<p>æ—¢ç„¶ <code>run</code> è¿™ä¹ˆå¿«ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ <code>spawn</code> å—ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚<code>Isolate.run</code> æ˜¯ <strong>â€œçŸ­è·‘é€‰æ‰‹â€</strong> ï¼Œè·‘å®Œå°±æ­»ï¼ˆè‡ªåŠ¨é”€æ¯ï¼‰ã€‚å¦‚æœä½ éœ€è¦ä¸€ä½ <strong>â€œé©¬æ‹‰æ¾é€‰æ‰‹â€</strong> ï¼Œå°±å¿…é¡»ç”¨ <code>spawn</code>ã€‚</p>
<h4 data-id="heading-26">é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>
<p><strong>çŠ¶æ€ä¿æŒ</strong>ï¼šæ¯”å¦‚ä¸€ä¸ªåå°è®¡æ—¶å™¨ï¼Œæˆ–è€…ä¸€ä¸ªç¼“å­˜æœåŠ¡ã€‚</p>
</li>
<li>
<p><strong>æŒç»­é€šä¿¡</strong>ï¼šæ¯”å¦‚ä¸‹è½½å¤§æ–‡ä»¶æ—¶çš„è¿›åº¦æ¡ï¼ˆ1%...50%...100%ï¼‰ï¼Œæˆ–è€… Socket é•¿è¿æ¥å¿ƒè·³ã€‚</p>
</li>
</ul>
<h4 data-id="heading-27">æ ¸å¿ƒæŠ€æœ¯ï¼šåŒå‘æ¡æ‰‹ (Handshake)</h4>
<p><code>Isolate.spawn</code> åˆ›å»ºæ—¶ï¼Œåªèƒ½ç”±ä¸»çº¿ç¨‹å•å‘ä¼ å‚ç»™å­çº¿ç¨‹ã€‚ä¸ºäº†å®ç°â€œå­çº¿ç¨‹ä¸»åŠ¨æ±‡æŠ¥è¿›åº¦â€ï¼Œæˆ‘ä»¬éœ€è¦å»ºç«‹åŒå‘é€šé“ï¼š</p>
<ol>
<li>
<p><strong>Main</strong>ï¼šåˆ›å»º <code>ReceivePort</code> (MainBox)ï¼ŒæŠŠ <code>MainBox.sendPort</code> ä¼ ç»™ Workerã€‚</p>
</li>
<li>
<p><strong>Worker</strong>ï¼šæ”¶åˆ°åï¼Œåˆ›å»ºè‡ªå·±çš„ <code>ReceivePort</code> (WorkerBox)ã€‚</p>
</li>
<li>
<p><strong>Worker</strong>ï¼šåˆ©ç”¨ <code>MainBox.sendPort</code>ï¼ŒæŠŠè‡ªå·±çš„ <code>WorkerBox.sendPort</code> å‘å›ç»™ Mainã€‚</p>
</li>
<li>
<p><strong>Main</strong>ï¼šæ”¶åˆ°å›ä¿¡ã€‚<strong>æ¡æ‰‹å®Œæˆï¼</strong></p>
</li>
</ol>
<p>ç°åœ¨ï¼ŒåŒæ–¹éƒ½æŒæœ‰å¯¹æ–¹çš„â€œç”µè¯å·ç â€ï¼Œå¯ä»¥éšæ—¶äº’å‘æ¶ˆæ¯äº†ã€‚</p>
<h3 data-id="heading-28">3.4 Dartä¸­çš„çº¿ç¨‹æ± ï¼šWorkManager</h3>
<p>æœ€åï¼Œæˆ‘ä»¬å¿…é¡»å»ºç«‹<strong>æˆæœ¬æ„è¯†</strong>ã€‚</p>
<p>è™½ç„¶ç°ä»£ Isolate å¯åŠ¨ç»è¿‡äº†ä¼˜åŒ–ï¼ˆIsolate Groupsï¼‰ï¼Œä½†åˆ›å»ºä¸€ä¸ª Isolate ä¾ç„¶éœ€è¦æ¶ˆè€— <strong>2MB+ çš„å†…å­˜</strong> å’Œ <strong>çº¦ 10ms çš„å¯åŠ¨æ—¶é—´</strong>ã€‚</p>
<p><strong>ç¾éš¾åœºæ™¯</strong>ï¼š</p>
<p>åœ¨ <code>ListView</code> çš„ <code>build</code> æ–¹æ³•é‡Œï¼Œå¯¹æ¯ä¸€å¼ å›¾ç‰‡éƒ½è°ƒç”¨ä¸€æ¬¡ <code>Isolate.run</code>ã€‚</p>
<ul>
<li><strong>åæœ</strong>ï¼šç¬é—´åˆ›å»ºä¸Šç™¾ä¸ª Isolateï¼ŒCPU è°ƒåº¦å´©æºƒï¼Œå†…å­˜æº¢å‡ºï¼ˆOOMï¼‰ï¼Œæ‰‹æœºå‘çƒ«å¡æ­»ã€‚</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼šçº¿ç¨‹æ±  (Worker Pool)</strong></p>
<p>å¯¹äºé«˜é¢‘çš„å°ä»»åŠ¡ï¼Œåº”è¯¥ä½¿ç”¨ <strong>çº¿ç¨‹æ± æ¨¡å¼</strong>ï¼ˆå¦‚ç¤¾åŒºåº“ <code>worker_manager</code>ï¼‰ã€‚</p>
<ul>
<li>
<p><strong>åŸç†</strong>ï¼šApp å¯åŠ¨æ—¶é¢„å…ˆåˆ›å»º 3-4 ä¸ªå¸¸é©» Isolateã€‚</p>
</li>
<li>
<p><strong>è°ƒåº¦</strong>ï¼šä»»åŠ¡æ¥äº†ï¼Œæ‰”ç»™ç©ºé—²çš„ Isolateï¼›ä»»åŠ¡æ»¡äº†ï¼Œæ’é˜Ÿç­‰å¾…ã€‚</p>
</li>
<li>
<p><strong>æ”¶ç›Š</strong>ï¼šæ¶ˆé™¤äº†åå¤å¯åŠ¨çš„å¼€é”€ï¼Œä¸”é™åˆ¶äº†æœ€å¤§å¹¶å‘æ•°ï¼Œä¿æŠ¤äº† CPUã€‚</p>
</li>
</ul>
<hr/>
<h4 data-id="heading-29">æœ¬ç« æ€»ç»“ï¼šæˆ˜æœ¯å†³ç­–çŸ©é˜µ</h4>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œè¯·ä¾ç…§ä¸‹è¡¨é€‰æ‹©ä½ çš„æ­¦å™¨ï¼š</p>





























<table><thead><tr><th><strong>ä»»åŠ¡ç±»å‹</strong></th><th><strong>å…¸å‹åœºæ™¯</strong></th><th><strong>æ¨èæ­¦å™¨</strong></th><th><strong>æ ¸å¿ƒç†ç”±</strong></th></tr></thead><tbody><tr><td><strong>å•æ¬¡ã€é‡è®¡ç®—</strong></td><td>è§£æå¤§ JSONã€å›¾ç‰‡å‹ç¼©</td><td><code>Isolate.run</code></td><td>ä»£ç ç®€æ´ï¼Œ<strong>Zero-Copy</strong> è¿”å›å¿«ï¼Œæ— å†…å­˜æ³„æ¼é£é™©ã€‚</td></tr><tr><td><strong>æŒç»­é€šä¿¡ã€çŠ¶æ€ä¿æŒ</strong></td><td>ä¸‹è½½è¿›åº¦ã€Socket æœåŠ¡</td><td><code>Isolate.spawn</code></td><td>å”¯ä¸€æ”¯æŒé•¿ç”Ÿå‘½å‘¨æœŸå’Œ<strong>åŒå‘é€šä¿¡</strong>çš„æ–¹æ¡ˆã€‚</td></tr><tr><td><strong>é«˜é¢‘ã€æµ·é‡å°ä»»åŠ¡</strong></td><td>åˆ—è¡¨å›¾ç‰‡æ»¤é•œã€æœç´¢è¡¥å…¨</td><td><strong>Worker Pool</strong></td><td><strong>å¤ç”¨çº¿ç¨‹</strong>ï¼Œé¿å… OOMï¼Œé¿å… CPU è°ƒåº¦è¿‡è½½ã€‚</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-30">ç¬¬å››ç« ï¼šè§£å‰– â€”â€” Isolate å†…éƒ¨æµè½¬æœºåˆ¶</h3>
<p>åœ¨æŒæ¡äº† Isolate çš„å„ç§â€œå…µå™¨â€åï¼Œæˆ‘ä»¬éœ€è¦èµ°è¿›å…µå·¥å‚ï¼Œæ‹†è§£å®ƒçš„å†…éƒ¨æœºæ¢°ç»“æ„ã€‚</p>
<p>Isolate ä¹‹æ‰€ä»¥èƒ½åšåˆ°â€œå†…å­˜ç»å¯¹éš”ç¦»â€ï¼Œå¹¶ä¸æ˜¯é é­”æ³•ï¼Œè€Œæ˜¯ä¾é ä¸€å¥—ä¸¥å¯†çš„è¿è¡Œæ—¶æ¶æ„ã€‚ç†è§£äº†è¿™å±‚æœºåˆ¶ï¼Œä½ å°±èƒ½æ˜ç™½ä¸ºä»€ä¹ˆ Isolate å¯åŠ¨æœ‰æˆæœ¬ï¼Œä»¥åŠä¸ºä»€ä¹ˆâ€œä¼ å¤§æ–‡ä»¶â€æ›¾ç»æ˜¯æ€§èƒ½æ€æ‰‹ã€‚</p>
<h3 data-id="heading-31">4.1 è§£å‰–å®¤ï¼šIsolate ä¸æ˜¯â€œç©ºæ¶å­â€</h3>
<p>Isolate ç»ä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„çº¿ç¨‹å¥æŸ„ï¼Œå®ƒåœ¨ VM å†…éƒ¨æ˜¯ä¸€ä¸ª<strong>é‡å‹çš„è¿è¡Œæ—¶å®ä½“</strong>ã€‚å¦‚æœæˆ‘ä»¬æŠŠå®ƒæ‹†è§£å¼€ï¼Œä¼šå‘ç°å®ƒåŒ…å«äº†ä¸€æ•´å¥—ç‹¬ç«‹çš„â€œå¾®å‹æ“ä½œç³»ç»Ÿç»„ä»¶â€ï¼š</p>
<p>1.<strong>Mutator Threadï¼ˆæ‰§è¡Œçº¿ç¨‹ï¼‰</strong> ï¼š
è¿™æ˜¯çœŸæ­£æ‰§è¡Œ Dart ä»£ç çš„ä¸»çº¿ç¨‹ã€‚æˆ‘ä»¬å¸¸è¯´çš„â€œMain Isolate å¿™ä¸è¿‡æ¥äº†â€ï¼ŒæŒ‡çš„å°±æ˜¯è¿™ä¸ª Mutator Thread çš„ CPU è·‘æ»¡äº†ã€‚</p>
<ol start="2">
<li><strong>Heapï¼ˆç§æœ‰å †å†…å­˜ï¼‰</strong> ï¼š
è¿™æ˜¯ Isolate çš„ç§äººé¢†åœ°ã€‚å®ƒç®¡ç†ç€æ‰€æœ‰çš„å¯¹è±¡åˆ†é…ã€‚</li>
</ol>
<ul>
<li><strong>å…³é”®ç‰¹æ€§</strong>ï¼š Isolate A çš„ GCï¼ˆåƒåœ¾å›æ”¶ï¼‰åªæ‰«æ A çš„å †ã€‚è¿™æ„å‘³ç€åå° Isolate å³ä½¿æ­£åœ¨è¿›è¡Œæƒ¨çƒˆçš„ Full GCï¼Œä¹Ÿä¸ä¼šå¯¼è‡´ Main Isolate çš„ UI æ‰å¸§ã€‚</li>
</ul>
<ol start="3">
<li>
<p><strong>Message Handlerï¼ˆæ¶ˆæ¯ä¼ è¾¾å®¤ï¼‰</strong> ï¼š
å®ƒä¸“é—¨è´Ÿè´£å¤„ç†åº•å±‚çš„ Port æ¶ˆæ¯ã€‚å®ƒä¼šç›‘å¬åº•å±‚çš„ç³»ç»Ÿæ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸€æ—¦æœ‰æ•°æ®åŒ…åˆ°è¾¾ï¼Œå®ƒä¼šå°†æ•°æ®ååºåˆ—åŒ–ï¼Œå¹¶æŠ›ç»™ Event Loop å¤„ç†ã€‚</p>
</li>
<li>
<p><strong>Control Portï¼ˆæ§åˆ¶ä¸­å¿ƒï¼‰</strong> ï¼š
è¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç«¯å£ï¼Œæ‹¥æœ‰å®ƒçš„ <code>Capability</code>ï¼ˆæƒé™ï¼‰æ‰èƒ½æ§åˆ¶ Isolate çš„ç”Ÿå‘½å‘¨æœŸï¼ˆå¦‚ Pause, Resume, Killï¼‰ã€‚</p>
</li>
</ol>
<h3 data-id="heading-32">4.2 æ…¢åŠ¨ä½œï¼šä¸€æ¬¡â€œæ ‡å‡†é€šä¿¡â€çš„ç”Ÿæ­»æ—…ç¨‹</h3>
<p>å½“æˆ‘ä»¬è°ƒç”¨ <code>SendPort.send(data)</code> æ—¶ï¼Œæ•°æ®ä» Isolate A åˆ°è¾¾ Isolate Bï¼Œè¿™ä¸­é—´çš„ 0.1 æ¯«ç§’é‡Œåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>
<p>è¿™æ˜¯ä¸€æ¬¡æ ‡å‡†çš„ <strong>Deep Copyï¼ˆæ·±æ‹·è´ï¼‰</strong> è¿‡ç¨‹ï¼Œå®ƒæå…¶æ˜‚è´µï¼Œåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p>
<h4 data-id="heading-33">ç¬¬ä¸€é˜¶æ®µï¼šå°ç®±ï¼ˆSerializationï¼‰</h4>
<p>åœ¨å‘é€ç«¯ï¼ˆIsolate Aï¼‰ï¼ŒVM ä¼šæš‚åœæ‰‹å¤´å·¥ä½œï¼Œå¼€å§‹æ‰«æä½ è¦å‘é€çš„å¯¹è±¡ï¼ˆæ¯”å¦‚ä¸€ä¸ªå¤æ‚çš„ <code>Map</code>ï¼‰ã€‚</p>
<ul>
<li>
<p>VM ä¼šæŠŠè¿™ä¸ªå¯¹è±¡è½¬æ¢æˆä¸€ç§ä¸­é—´æ ¼å¼ï¼ˆMessage Snapshotï¼‰ã€‚</p>
</li>
<li>
<p><strong>ä»£ä»·</strong>ï¼šCPU å¯†é›†å‹æ“ä½œã€‚å¦‚æœå¯¹è±¡å¾ˆå¤§ï¼ˆå¦‚ 10MB çš„ JSONï¼‰ï¼Œè¿™ä¸€æ­¥å°±ä¼šæ¶ˆè€—å¯è§‚çš„æ—¶é—´ã€‚</p>
</li>
</ul>
<h4 data-id="heading-34">ç¬¬äºŒé˜¶æ®µï¼šæŠ•é€’ï¼ˆTransmissionï¼‰</h4>
<p>VM å°†åºåˆ—åŒ–åçš„äºŒè¿›åˆ¶æ•°æ®åŒ…ï¼Œé€šè¿‡ C++ å±‚é¢çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼ŒæŠ•é€’ç»™ç›®æ ‡ Isolate Bã€‚</p>
<h4 data-id="heading-35">ç¬¬ä¸‰é˜¶æ®µï¼šå¼€ç®±ï¼ˆDeserialization &amp; Allocationï¼‰</h4>
<p>è¿™æ˜¯æœ€è€—æ—¶çš„æ­¥éª¤ã€‚</p>
<ul>
<li>
<p><strong>åˆ†é… (Allocate)</strong> ï¼šIsolate B çš„ Message Handler æ”¶åˆ°æ•°æ®åŒ…åï¼Œå¿…é¡»åœ¨ B çš„ <strong>å †å†…å­˜ï¼ˆHeapï¼‰</strong> ä¸­ç”³è¯·ä¸€å—æ–°çš„ã€åŒæ ·å¤§å°çš„å†…å­˜ç©ºé—´ã€‚</p>
</li>
<li>
<p><strong>å¤åˆ¶ (Copy)</strong> ï¼šå°†äºŒè¿›åˆ¶æ•°æ®â€œè¿˜åŸâ€æˆ Dart å¯¹è±¡ï¼Œå¡«å…¥æ–°ç”³è¯·çš„å†…å­˜ä¸­ã€‚</p>
</li>
</ul>
<p><strong>ç»“è®º</strong>ï¼šè¿™å°±æ˜¯ä¸ºä»€ä¹ˆè€ç‰ˆæœ¬çš„ <code>compute</code> åœ¨è¿”å›å¤§æ•°æ®æ—¶ä¼šå¡é¡¿ã€‚å› ä¸º Isolate Bï¼ˆä¸»çº¿ç¨‹ï¼‰å¿…é¡»äº²è‡ªå‚ä¸â€œåˆ†é…å†…å­˜â€å’Œâ€œè¿˜åŸæ•°æ®â€çš„è¿‡ç¨‹ï¼Œè¿™ç›´æ¥å ç”¨äº† UI æ¸²æŸ“çš„æ—¶é—´ã€‚</p>
<h3 data-id="heading-36">4.3 é™ç»´æ‰“å‡»ï¼šå†…å­˜é¡µè¿‡æˆ· (Heap Merging)</h3>
<p>ç†è§£äº†â€œæ·±æ‹·è´â€çš„ç—›ï¼Œä½ å°±èƒ½æ·±åˆ»ä½“ä¼š <code>Isolate.exit</code> <strong>(ç”¨äº Isolate.run)</strong> çš„â€œè¿‡æˆ·æœºåˆ¶â€æœ‰å¤šä¹ˆç²¾å¦™ã€‚</p>
<p>å½“å­çº¿ç¨‹è°ƒç”¨ <code>Isolate.exit</code> è¿”å›ç»“æœæ—¶ï¼ŒVM å¹¶æ²¡æœ‰æ‰§è¡Œä¸Šè¿°çš„â€œå°ç®±-æŠ•é€’-å¼€ç®±â€æµç¨‹ï¼Œè€Œæ˜¯ç©äº†ä¸€æ‰‹**â€œå·å¤©æ¢æ—¥â€**ï¼š</p>
<ol>
<li><strong>å‰¥ç¦» (Detach)</strong> ï¼š</li>
</ol>
<pre><code class="hljs language-markdown" lang="markdown">VM é”å®šå­çº¿ç¨‹ä¸­å­˜æ”¾ç»“æœæ•°æ®çš„ <span class="hljs-strong">**å†…å­˜é¡µ (Memory Pages)**</span> ã€‚å®ƒåœ¨å­çº¿ç¨‹çš„é¡µè¡¨ä¸­å°†è¿™äº›é¡µâ€œæ³¨é”€â€ã€‚æ­¤æ—¶ï¼Œå­çº¿ç¨‹å¤±å»äº†å¯¹è¿™å—å†…å­˜çš„è®¿é—®æƒã€‚
</code></pre>
<ol>
<li>
<p><strong>è¿‡æˆ· (Remap / Merge)</strong> ï¼š</p>
<p>VM ç›´æ¥ä¿®æ”¹ <strong>ä¸»çº¿ç¨‹</strong> çš„é¡µè¡¨ï¼Œå°†åˆšæ‰é‚£å‡ é¡µå†…å­˜çš„æŒ‡é’ˆï¼Œ<strong>æŒ‚è½½</strong> åˆ°ä¸»çº¿ç¨‹çš„åä¸‹ã€‚</p>
</li>
<li>
<p><strong>æ¥æ”¶ (Attach)</strong> ï¼š</p>
<p>ä¸»çº¿ç¨‹ä¸éœ€è¦ç”³è¯·æ–°å†…å­˜ï¼Œä¹Ÿä¸éœ€è¦å¤åˆ¶æ•°æ®ã€‚å®ƒåªæ˜¯è¢«é€šçŸ¥ï¼šâ€œå˜¿ï¼Œå†…å­˜åœ°å€ 0x1000 åˆ° 0x2000 ç°åœ¨å½’ä½ äº†ã€‚â€</p>
</li>
</ol>
<p><strong>æ€§èƒ½å¯¹æ¯”</strong>ï¼š</p>
<ul>
<li>
<p><strong>æ ‡å‡† Send</strong>ï¼šæ¬è¿å·¥æ¨¡å¼ã€‚è€—æ—¶ä¸æ•°æ®é‡æˆæ­£æ¯” <strong>O(N)</strong> ã€‚</p>
</li>
<li>
<p><strong>Exit è¿‡æˆ·</strong>ï¼šæˆ¿äº§è¯æ›´åæ¨¡å¼ã€‚è€—æ—¶æ˜¯å¸¸æ•°çº§ <strong>O(1)</strong> ï¼Œå‡ ä¹ç¬é—´å®Œæˆã€‚</p>
</li>
</ul>
<h4 data-id="heading-37">ä¸ºä»€ä¹ˆæœ‰é™åˆ¶ï¼Ÿ</h4>
<p>ä½ å¯èƒ½ä¼šé—®ï¼šâ€œæ—¢ç„¶è¿‡æˆ·è¿™ä¹ˆçˆ½ï¼Œä¸ºä»€ä¹ˆä¸é»˜è®¤å…¨ç”¨è¿‡æˆ·ï¼Ÿâ€</p>
<p>å› ä¸º <strong>â€œè—•æ–­ä¸è¿â€</strong> ã€‚</p>
<p>å¦‚æœè¢«è¿‡æˆ·çš„å¯¹è±¡é‡Œï¼Œå¼•ç”¨äº†ä¸€ä¸ª <strong>Socket å¥æŸ„</strong> æˆ– <strong>UI æ§ä»¶</strong>ï¼Œè¿™äº›èµ„æºä¸ä»…æ˜¯å†…å­˜æ•°æ®ï¼Œè¿˜ç»‘å®šäº†ç‰¹å®šçš„ç³»ç»Ÿçº¿ç¨‹æˆ– OS èµ„æºï¼Œæ— æ³•ç®€å•åœ°é€šè¿‡â€œæ”¹å†…å­˜å½’å±â€æ¥è½¬ç§»ã€‚å› æ­¤ï¼ŒDart å¼ºåˆ¶è¦æ±‚ä¼ é€’çš„å¯¹è±¡å¿…é¡»æ˜¯â€œå¯ä¼ è¾“çš„â€ã€‚</p>
<h6 data-id="heading-38">é€šè¿‡è¿™ä¸€ç« çš„è§£å‰–ï¼Œæˆ‘ä»¬çœ‹æ¸…äº† Isolate çš„åº•å±‚çœŸç›¸ï¼š<strong>å®ƒç”¨â€œå†…å­˜çš„ç‰©ç†éš”ç¦»â€æ¢å–äº†â€œæ— é”çš„å®‰å…¨â€ï¼Œåˆé€šè¿‡â€œå†…å­˜é¡µçš„åŠ¨æ€è¿‡æˆ·â€çªç ´äº†â€œé€šä¿¡çš„æ€§èƒ½ç“¶é¢ˆâ€ã€‚</strong></h6>
<hr/>
<h3 data-id="heading-39">ç¬¬äº”ç« ï¼šæ€»ç»“ â€”â€” Isolate çš„å“²å­¦ä¸é“å¾‹</h3>
<p>Dart é€‰æ‹© Isolate æ¨¡å‹ï¼Œæœ¬è´¨ä¸Šæ˜¯åœ¨åšä¸€é“æå…¶å†·é™çš„è®¡ç®—é¢˜ï¼š<strong>ç”¨â€œå†…å­˜å¼€é”€â€æ¢å–â€œå¼€å‘å®‰å…¨â€</strong> ã€‚</p>
<p>ä½œä¸ºå¼€å‘è€…ï¼Œå½“æˆ‘ä»¬åˆä¸Š Isolate çš„åº•å±‚å›¾çº¸ï¼Œå›åˆ° IDE å‰å‡†å¤‡æ•²ä¸‹ç¬¬ä¸€è¡Œå¹¶å‘ä»£ç æ—¶ï¼Œè¯·åŠ¡å¿…å°†ä»¥ä¸‹å“²å­¦ä¸é“å¾‹é“­è®°äºå¿ƒã€‚</p>
<h3 data-id="heading-40">5.1 å“²å­¦ï¼šå®‰å…¨çš„ä»£ä»·</h3>
<p>å¾ˆå¤šä» Javaã€C++ æˆ– Go è½¬æ¥çš„å¼€å‘è€…ï¼Œåˆæ¬¡æ¥è§¦ Isolate æ—¶éƒ½ä¼šæ„Ÿåˆ°â€œä¸è‡ªç”±â€ï¼šä¸èƒ½å…±äº«å…¨å±€å˜é‡ï¼Œä¸èƒ½ç›´æ¥è®¿é—®å¯¹è±¡ï¼Œé€šä¿¡å¿…é¡»åºåˆ—åŒ–ã€‚</p>
<p>ä½†è¿™æ­£æ˜¯ Dart çš„æ™ºæ…§æ‰€åœ¨ã€‚å¯¹äºä¸€ä¸ª <strong>UI æ¡†æ¶ (Flutter)</strong> è€Œè¨€ï¼Œ <strong>â€œä¸å¡é¡¿â€</strong> å’Œ <strong>â€œä¸å´©æºƒâ€</strong> æ˜¯æœ€é«˜æŒ‡ä»¤ã€‚</p>
<ul>
<li>
<p><strong>ä¼ ç»Ÿå¤šçº¿ç¨‹</strong>ï¼šä¸ºäº†æ€§èƒ½å…±äº«å†…å­˜ï¼Œä½†ä»£ä»·æ˜¯æ— ä¼‘æ­¢çš„ <strong>é” (Lock)</strong> ã€<strong>ç«æ€æ¡ä»¶ (Race Condition)</strong> å’Œ <strong>æ­»é” (Deadlock)</strong> ã€‚ä¸€æ—¦å‡ºé—®é¢˜ï¼ŒApp å¯èƒ½ä¼šéšæœºå´©æºƒï¼Œè°ƒè¯•éš¾åº¦æé«˜ã€‚</p>
</li>
<li>
<p><strong>Dart Isolate</strong>ï¼šé€šè¿‡ç‰©ç†éš”ç¦»ï¼Œå¼ºåˆ¶æ¶ˆç­äº†â€œå¤šçº¿ç¨‹ç«äº‰â€ã€‚ä½ æ°¸è¿œä¸éœ€è¦å†™ <code>synchronized</code>ï¼Œæ°¸è¿œä¸ç”¨æ‹…å¿ƒåå°çº¿ç¨‹ä¼šæŠŠ UI çº¿ç¨‹çš„æ•°æ®æ”¹ä¹±ã€‚</p>
</li>
</ul>
<p><strong>æ ¸å¿ƒå¿ƒæ³•</strong>ï¼š</p>
<blockquote>
<p><strong>ä¸è¦é€šè¿‡å…±äº«å†…å­˜æ¥é€šä¿¡ï¼Œè€Œè¦é€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜ã€‚</strong> (Do not communicate by sharing memory; instead, share memory by communicating.)</p>
</blockquote>
<p>æˆ‘ä»¬ç‰ºç‰²äº†ä¸€ç‚¹å†…å­˜ï¼ˆç”¨äºæ‹·è´æˆ–å¤šå¼€å †ç©ºé—´ï¼‰ï¼Œæ¢æ¥äº†<strong>ç»å¯¹çš„çº¿ç¨‹å®‰å…¨</strong>å’Œ<strong>æå…¶ç®€å•çš„å¹¶å‘å¿ƒæ™ºæ¨¡å‹</strong>ã€‚</p>
<h3 data-id="heading-41">5.2 é“å¾‹ï¼šIsolate å¼€å‘è€…çš„â€œå†›è§„â€</h3>
<p>åœ¨äº«å—å¹¶å‘çº¢åˆ©çš„åŒæ—¶ï¼Œæœ‰ä¸‰æ¡çº¢çº¿ç»å¯¹ä¸èƒ½è§¦ç¢°ã€‚</p>
<h4 data-id="heading-42">ç¬¬ä¸€æ¡ï¼šä¸Šå¸çš„å½’ä¸Šå¸ï¼Œå‡¯æ’’çš„å½’å‡¯æ’’ (UI Segregation)</h4>
<p>è¿™æ˜¯æœ€é‡è¦çš„ä¸€æ¡ã€‚</p>
<ul>
<li>
<p><strong>Main Isolate</strong> æ˜¯ UI çš„å”¯ä¸€ä¸»äººã€‚åªæœ‰å®ƒæŒæœ‰ <code>BuildContext</code>ï¼Œåªæœ‰å®ƒèƒ½è°ƒç”¨ <code>setState</code>ï¼Œåªæœ‰å®ƒèƒ½æ“ä½œ Widgetã€‚</p>
</li>
<li>
<p><strong>åå° Isolate</strong> æ˜¯æ•°æ®çš„è®¡ç®—å·¥å‚ã€‚å®ƒåªè´Ÿè´£è¾“å…¥æ•°æ®ï¼ˆData Inï¼‰å’Œè¾“å‡ºç»“æœï¼ˆData Outï¼‰ã€‚</p>
</li>
<li>
<p><strong>ç¦åŒº</strong>ï¼šåƒä¸‡ä¸è¦è¯•å›¾æŠŠ <code>BuildContext</code>ã€<code>Widget</code> å®ä¾‹æˆ–è€… UI ç›¸å…³çš„å›è°ƒå‡½æ•°ä¼ ç»™åå° Isolateã€‚å®ƒä»¬ä¼ ä¸è¿‡å»ï¼Œå¼ºè¡Œä¼ åªä¼šå¯¼è‡´ Crashã€‚</p>
</li>
</ul>
<h4 data-id="heading-43">ç¬¬äºŒæ¡ï¼šä¸ä¼ â€œæ´»ç‰©â€ (Serializable Only)</h4>
<p>Isolate ä¹‹é—´çš„é€šä¿¡ä¾èµ–äºæ¶ˆæ¯ä¼ é€’ã€‚èƒ½ä¼ é€’çš„å¿…é¡»æ˜¯ <strong>â€œæ­»â€çš„æ•°æ®</strong>ï¼ˆå¯åºåˆ—åŒ–ï¼‰ï¼Œæˆ–è€…æ˜¯ <strong>â€œé€šä¿¡å‡­è¯â€</strong> ï¼ˆSendPortï¼‰ã€‚</p>
<ul>
<li>
<p><strong>å¯ä»¥ä¼ </strong>ï¼š<code>int</code>, <code>String</code>, <code>List</code>, <code>Map</code>, <code>TransferableTypedData</code>ã€‚</p>
</li>
<li>
<p><strong>ç»å¯¹ä¸èƒ½ä¼ </strong>ï¼š</p>
<ul>
<li>
<p><strong>Socket / FileHandle</strong>ï¼šè¿™äº›ç»‘å®šäº†åº•å±‚çš„ç³»ç»Ÿèµ„æºã€‚</p>
</li>
<li>
<p><strong>Closure with Context</strong>ï¼šæºå¸¦äº†å¤æ‚ä¸Šä¸‹æ–‡ï¼ˆå°¤å…¶æ˜¯ <code>this</code>ï¼‰çš„é—­åŒ…ã€‚</p>
</li>
<li>
<p><strong>Future / Stream</strong>ï¼šè¿™äº›æ˜¯åŸºäºäº‹ä»¶å¾ªç¯çš„å¼‚æ­¥å¯¹è±¡ï¼Œæ— æ³•è·¨çº¿ç¨‹ã€‚</p>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-44">ç¬¬ä¸‰æ¡ï¼šè¯¥æ­»å°±å¾—æ­» (Lifecycle Management)</h4>
<p>èµ„æºæ„è¯†æ˜¯é«˜çº§å·¥ç¨‹å¸ˆçš„ç´ å…»ã€‚</p>
<ul>
<li>
<p><strong>çŸ­ä»»åŠ¡</strong>ï¼šé¦–é€‰ <code>Isolate.run</code>ã€‚å®ƒä¸ä»…å¿«ï¼ˆZero-Copyï¼‰ï¼Œè€Œä¸”è·‘å®Œè‡ªåŠ¨é”€æ¯ï¼Œä¸ç•™åæ‚£ã€‚</p>
</li>
<li>
<p><strong>é•¿ä»»åŠ¡</strong>ï¼šå¦‚æœä½ æ‰‹åŠ¨ <code>spawn</code> äº†ä¸€ä¸ª Isolateï¼Œè¯·åŠ¡å¿…ç¡®ä¿åœ¨ä¸éœ€è¦å®ƒæ—¶è°ƒç”¨ <code>kill() </code>ã€‚</p>
</li>
<li>
<p><strong>åƒµå°¸çº¿ç¨‹</strong>ï¼šä¸€ä¸ªè¢«é—å¿˜çš„ã€æ­»å¾ªç¯çš„åå° Isolateï¼Œä¼šæ‚„æ‚„åƒæ‰ç”¨æˆ·çš„ç”µæ± ï¼Œå¹¶å ç”¨å®è´µçš„å†…å­˜ï¼Œç›´åˆ° App è¢«ç³»ç»Ÿå¼ºæ€ã€‚</p>
</li>
</ul>
<h3 data-id="heading-45">5.3 å†³ç­–çš„æ™ºæ…§ï¼šä½•æ—¶æ‹”å‰‘ï¼Ÿ</h3>
<p>æ‰‹ä¸­æ‹¿ç€é”¤å­ï¼Œä¸è¦çœ‹ä»€ä¹ˆéƒ½åƒé’‰å­ã€‚Isolate è™½ç„¶å¼ºå¤§ï¼Œä½†ä¸æ˜¯é“¶å¼¹ã€‚</p>
<p><strong>ä¸è¦æ»¥ç”¨å¹¶å‘</strong>ï¼š</p>
<ul>
<li>
<p><strong>åœºæ™¯</strong>ï¼šè®¡ç®— <code>1 + 1</code>ï¼Œæˆ–è€…å¯¹ 50 ä¸ªå…ƒç´ çš„æ•°ç»„æ’åºã€‚</p>
</li>
<li>
<p><strong>å†³ç­–</strong>ï¼šç›´æ¥åœ¨ Main Isolate åšï¼</p>
</li>
<li>
<p><strong>ç†ç”±</strong>ï¼šå¯åŠ¨ Isolate éœ€è¦æ—¶é—´ï¼ˆçº¦ 10msï¼‰å’Œå†…å­˜ï¼ˆçº¦ 2MBï¼‰ã€‚å¯¹äºå¾®å°ä»»åŠ¡ï¼Œ <strong>â€œå¯åŠ¨çº¿ç¨‹çš„æ—¶é—´â€å¯èƒ½æ¯”â€œåšä»»åŠ¡çš„æ—¶é—´â€è¿˜é•¿</strong>ï¼Œå¾—ä¸å¿å¤±ã€‚</p>
</li>
</ul>
<p><strong>ä½•æ—¶ä½¿ç”¨ Isolateï¼Ÿ</strong> è¯·éµå¾ª <strong>â€œ16ms æ³•åˆ™â€</strong> ï¼š å¦‚æœä¸€ä¸ªä»»åŠ¡çš„é¢„ä¼°è€—æ—¶è¶…è¿‡ <strong>16ms</strong>ï¼ˆå¯¼è‡´æ‰å¸§çš„é˜ˆå€¼ï¼‰ï¼Œæˆ–è€…æ¶‰åŠå¤§é‡çš„ JSON è§£æã€å›¾åƒå¤„ç†ã€å¤æ‚ç®—æ³•ï¼Œè¯·æ¯«ä¸çŠ¹è±«åœ°æŠŠå®ƒæ‰”ç»™ <code>Isolate.run</code> æˆ– <strong>Worker Manager</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-46">ç»“è¯­</h3>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†ä» Dart å•çº¿ç¨‹æ¨¡å‹çš„åŸç†ï¼Œåˆ° Isolate å†…å­˜æœºåˆ¶çš„è§£å‰–ï¼Œå†åˆ°å®æˆ˜å…µå™¨çš„æ¼”è¿›çš„å…¨æ™¯æ‰«æã€‚</p>
<p>ç°åœ¨çš„ä½ ï¼Œå†çœ‹åˆ° <code>Future</code>ï¼Œä¼šæ˜ç™½é‚£åªæ˜¯ä¸»çº¿ç¨‹çš„æ—¶é—´ç®¡ç†å¤§å¸ˆï¼›çœ‹åˆ° <code>Isolate</code>ï¼Œä¼šæ˜ç™½é‚£æ˜¯å¹¶è¡Œçš„è®¡ç®—åˆ†èº«ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Boot ä¸­åŸºäº YOLOv26 çš„ç›®æ ‡æ£€æµ‹å®ç°]]></title>    <link>https://juejin.cn/post/7599927813601345576</link>    <guid>https://juejin.cn/post/7599927813601345576</guid>    <pubDate>2026-01-28T02:51:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599927813601345576" data-draft-id="7599964577899675648" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Boot ä¸­åŸºäº YOLOv26 çš„ç›®æ ‡æ£€æµ‹å®ç°"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T02:51:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å¨å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/3411107130652176"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Boot ä¸­åŸºäº YOLOv26 çš„ç›®æ ‡æ£€æµ‹å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3411107130652176/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å¨å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:51:28.000Z" title="Wed Jan 28 2026 02:51:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ æƒ³è¦åŸºäºSpringBootæ¡†æ¶æ•´åˆYOLOv26å®ç°ç›®æ ‡æ£€æµ‹åŠŸèƒ½ï¼Œæ ¸å¿ƒæ˜¯å°è£…å‡ºé€šç”¨çš„æ£€æµ‹æ¥å£ï¼Œè¯¥æ¥å£èƒ½åŒæ—¶æ”¯æŒå›¾ç‰‡æ–‡ä»¶ä¸Šä¼ å’ŒBase64ç¼–ç å­—ç¬¦ä¸²ä½œä¸ºå…¥å‚ï¼Œå®ç°æ ‡å‡†åŒ–ã€å¯å¤ç”¨çš„ç›®æ ‡æ£€æµ‹èƒ½åŠ›ã€‚</p>
<p>æœ¬æ–‡å°†ä»<strong>ç¯å¢ƒå‡†å¤‡â†’é¡¹ç›®æ­å»ºâ†’æ ¸å¿ƒå°è£…â†’æ¥å£å®ç°â†’æµ‹è¯•éªŒè¯</strong>å…¨æµç¨‹è½åœ°ï¼Œæ‰€æœ‰ä»£ç å‡ä¸ºå·¥ä¸šçº§å¯è¿è¡Œç‰ˆæœ¬ï¼Œå…¼é¡¾æ˜“ç”¨æ€§ä¸æ€§èƒ½ä¼˜åŒ–ï¼Œé€‚é…å®é™…é¡¹ç›®ä¸­å›¾ç‰‡/Base64åŒå…¥å‚çš„å¸¸è§åœºæ™¯ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å®æˆ˜å‡†å¤‡ï¼šç¯å¢ƒä¸ä¾èµ–é…ç½®</h2>
<h3 data-id="heading-1">1.1 æ ¸å¿ƒç¯å¢ƒè¦æ±‚</h3>
<ul>
<li>
<p>JDKï¼š1.8+/17ï¼ˆæ¨è17ï¼ŒSpringBoot 3.xé€‚é…ï¼‰</p>
</li>
<li>
<p>SpringBootï¼š3.2.xï¼ˆç¨³å®šç‰ˆï¼‰</p>
</li>
<li>
<p>æ¨ç†å¼•æ“ï¼šONNX Runtimeï¼ˆJavaç‰ˆï¼Œé¿å…è·¨è¯­è¨€è°ƒç”¨Pythonï¼Œæ€§èƒ½æ›´ä¼˜ï¼‰</p>
</li>
<li>
<p>YOLOv26ï¼šå¯¼å‡ºä¸ºONNXæ ¼å¼çš„æ¨¡å‹ï¼ˆå«æƒé‡æ–‡ä»¶ï¼Œéœ€æå‰è®­ç»ƒ/ä¸‹è½½é¢„è®­ç»ƒæƒé‡ï¼‰</p>
</li>
<li>
<p>è¾…åŠ©ä¾èµ–ï¼šå›¾ç‰‡å¤„ç†ï¼ˆThumbnailsï¼‰ã€JSONåºåˆ—åŒ–ï¼ˆFastJSON2ï¼‰</p>
</li>
</ul>
<h3 data-id="heading-2">1.2 ä¾èµ–å¼•å…¥ï¼ˆpom.xmlï¼‰</h3>
<pre><code class="hljs language-XML" lang="XML">
<span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span>
         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.2.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.ai.detection<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>yolov26-springboot<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- SpringBootæ ¸å¿ƒ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-validation<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- ONNX Runtimeï¼ˆJavaæ¨ç†æ ¸å¿ƒï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.microsoft.onnxruntime<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>onnxruntime<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.16.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- é€‚é…ä¸åŒç³»ç»Ÿï¼ŒæŒ‰éœ€é€‰æ‹©ï¼Œé»˜è®¤Windows x64 --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">classifier</span>&gt;</span>win-x64<span class="hljs-tag">&lt;/<span class="hljs-name">classifier</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- Linux x64æ›¿æ¢ä¸ºï¼š&lt;classifier&gt;linux-x64&lt;/classifier&gt; --&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- å›¾ç‰‡å¤„ç† --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>net.coobird<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>thumbnailator<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.4.19<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>javax.imageio<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jai-imageio<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Base64ä¸JSON --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.fastjson2<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>fastjson2<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.48<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æ—¥å¿— --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>ch.qos.logback<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>logback-classic<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æµ‹è¯• --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.2.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3">1.3 YOLOv26æ¨¡å‹å‡†å¤‡</h3>
<ol>
<li>
<p>ä¸‹è½½YOLOv26é¢„è®­ç»ƒæƒé‡ï¼ˆå¦‚<code>yolov26n.pt</code>ï¼‰ï¼Œé€šè¿‡Ultralyticsåº“å¯¼å‡ºä¸ºONNXæ ¼å¼ï¼š</p>
<pre><code class="hljs language-Python" lang="Python">
<span class="hljs-keyword">from</span> ultralytics <span class="hljs-keyword">import</span> YOLO

<span class="hljs-comment"># åŠ è½½æ¨¡å‹</span>
model = YOLO(<span class="hljs-string">"yolov26n.pt"</span>)
<span class="hljs-comment"># å¯¼å‡ºONNXæ¨¡å‹ï¼ˆæŒ‡å®šè¾“å…¥å°ºå¯¸640x640ï¼Œé€‚é…å¤šæ•°åœºæ™¯ï¼‰</span>
model.export(<span class="hljs-built_in">format</span>=<span class="hljs-string">"onnx"</span>, imgsz=<span class="hljs-number">640</span>, opset=<span class="hljs-number">12</span>)
</code></pre>
</li>
<li>
<p>å°†å¯¼å‡ºçš„<code>yolov26n.onnx</code>æ–‡ä»¶æ”¾å…¥é¡¹ç›®<code>resources/models</code>ç›®å½•ä¸‹ã€‚</p>
</li>
</ol>
<h2 data-id="heading-4">äºŒã€æ ¸å¿ƒå°è£…ï¼šYOLOv26æ¨ç†å·¥å…·ç±»</h2>
<h3 data-id="heading-5">2.1 å¸¸é‡ä¸è¿”å›å®ä½“å®šä¹‰</h3>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-comment">// 1. æ£€æµ‹ç»“æœå®ä½“</span>
<span class="hljs-keyword">package</span> com.ai.detection.entity;

<span class="hljs-keyword">import</span> lombok.Data;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * ç›®æ ‡æ£€æµ‹ç»Ÿä¸€è¿”å›ç»“æœ
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DetectionResult</span> {
    <span class="hljs-comment">/**
     * æ£€æµ‹çŠ¶æ€ï¼šsuccess/fail
     */</span>
    <span class="hljs-keyword">private</span> String status;
    <span class="hljs-comment">/**
     * é”™è¯¯ä¿¡æ¯ï¼ˆå¤±è´¥æ—¶éç©ºï¼‰
     */</span>
    <span class="hljs-keyword">private</span> String errorMsg;
    <span class="hljs-comment">/**
     * æ£€æµ‹åˆ°çš„ç›®æ ‡åˆ—è¡¨
     */</span>
    <span class="hljs-keyword">private</span> List&lt;DetectedObject&gt; objects;
    <span class="hljs-comment">/**
     * æ£€æµ‹è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> costTime;
}

<span class="hljs-comment">/**
 * å•ä¸ªæ£€æµ‹ç›®æ ‡
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DetectedObject</span> {
    <span class="hljs-comment">/**
     * ç›®æ ‡ç±»åˆ«ï¼ˆå¦‚personã€carï¼‰
     */</span>
    <span class="hljs-keyword">private</span> String className;
    <span class="hljs-comment">/**
     * ç±»åˆ«ID
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> classId;
    <span class="hljs-comment">/**
     * ç½®ä¿¡åº¦ï¼ˆ0-1ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> confidence;
    <span class="hljs-comment">/**
     * è¾¹ç•Œæ¡†åæ ‡ï¼šx1,y1ï¼ˆå·¦ä¸Šè§’ï¼‰,x2,y2ï¼ˆå³ä¸‹è§’ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> x1;
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> y1;
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> x2;
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> y2;
}

<span class="hljs-comment">// 2. å¸¸é‡ç±»</span>
<span class="hljs-keyword">package</span> com.ai.detection.constant;

<span class="hljs-comment">/**
 * YOLOv26å¸¸é‡é…ç½®
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YoloConstants</span> {
    <span class="hljs-comment">/**
     * æ¨¡å‹æ–‡ä»¶è·¯å¾„
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">MODEL_PATH</span> <span class="hljs-operator">=</span> <span class="hljs-string">"models/yolov26n.onnx"</span>;
    <span class="hljs-comment">/**
     * è¾“å…¥å›¾ç‰‡å°ºå¯¸ï¼ˆYOLOv26é»˜è®¤640x640ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INPUT_WIDTH</span> <span class="hljs-operator">=</span> <span class="hljs-number">640</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INPUT_HEIGHT</span> <span class="hljs-operator">=</span> <span class="hljs-number">640</span>;
    <span class="hljs-comment">/**
     * ç½®ä¿¡åº¦é˜ˆå€¼ï¼ˆè¿‡æ»¤ä½ç½®ä¿¡åº¦ç»“æœï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">float</span> <span class="hljs-variable">CONF_THRESHOLD</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.5f</span>;
    <span class="hljs-comment">/**
     * NMSéæå¤§å€¼æŠ‘åˆ¶é˜ˆå€¼
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">float</span> <span class="hljs-variable">NMS_THRESHOLD</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.45f</span>;
    <span class="hljs-comment">/**
     * COCOæ•°æ®é›†ç±»åˆ«ï¼ˆYOLOv26é¢„è®­ç»ƒé»˜è®¤COCOï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String[] COCO_CLASSES = {
            <span class="hljs-string">"person"</span>, <span class="hljs-string">"bicycle"</span>, <span class="hljs-string">"car"</span>, <span class="hljs-string">"motorcycle"</span>, <span class="hljs-string">"airplane"</span>, <span class="hljs-string">"bus"</span>, <span class="hljs-string">"train"</span>, <span class="hljs-string">"truck"</span>, <span class="hljs-string">"boat"</span>,
            <span class="hljs-string">"traffic light"</span>, <span class="hljs-string">"fire hydrant"</span>, <span class="hljs-string">"stop sign"</span>, <span class="hljs-string">"parking meter"</span>, <span class="hljs-string">"bench"</span>, <span class="hljs-string">"bird"</span>, <span class="hljs-string">"cat"</span>,
            <span class="hljs-string">"dog"</span>, <span class="hljs-string">"horse"</span>, <span class="hljs-string">"sheep"</span>, <span class="hljs-string">"cow"</span>, <span class="hljs-string">"elephant"</span>, <span class="hljs-string">"bear"</span>, <span class="hljs-string">"zebra"</span>, <span class="hljs-string">"giraffe"</span>, <span class="hljs-string">"backpack"</span>,
            <span class="hljs-string">"umbrella"</span>, <span class="hljs-string">"handbag"</span>, <span class="hljs-string">"tie"</span>, <span class="hljs-string">"suitcase"</span>, <span class="hljs-string">"frisbee"</span>, <span class="hljs-string">"skis"</span>, <span class="hljs-string">"snowboard"</span>, <span class="hljs-string">"sports ball"</span>,
            <span class="hljs-string">"kite"</span>, <span class="hljs-string">"baseball bat"</span>, <span class="hljs-string">"baseball glove"</span>, <span class="hljs-string">"skateboard"</span>, <span class="hljs-string">"surfboard"</span>, <span class="hljs-string">"tennis racket"</span>,
            <span class="hljs-string">"bottle"</span>, <span class="hljs-string">"wine glass"</span>, <span class="hljs-string">"cup"</span>, <span class="hljs-string">"fork"</span>, <span class="hljs-string">"knife"</span>, <span class="hljs-string">"spoon"</span>, <span class="hljs-string">"bowl"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"apple"</span>,
            <span class="hljs-string">"sandwich"</span>, <span class="hljs-string">"orange"</span>, <span class="hljs-string">"broccoli"</span>, <span class="hljs-string">"carrot"</span>, <span class="hljs-string">"hot dog"</span>, <span class="hljs-string">"pizza"</span>, <span class="hljs-string">"donut"</span>, <span class="hljs-string">"cake"</span>,
            <span class="hljs-string">"chair"</span>, <span class="hljs-string">"couch"</span>, <span class="hljs-string">"potted plant"</span>, <span class="hljs-string">"bed"</span>, <span class="hljs-string">"dining table"</span>, <span class="hljs-string">"toilet"</span>, <span class="hljs-string">"tv"</span>, <span class="hljs-string">"laptop"</span>,
            <span class="hljs-string">"mouse"</span>, <span class="hljs-string">"remote"</span>, <span class="hljs-string">"keyboard"</span>, <span class="hljs-string">"cell phone"</span>, <span class="hljs-string">"microwave"</span>, <span class="hljs-string">"oven"</span>, <span class="hljs-string">"toaster"</span>, <span class="hljs-string">"sink"</span>,
            <span class="hljs-string">"refrigerator"</span>, <span class="hljs-string">"book"</span>, <span class="hljs-string">"clock"</span>, <span class="hljs-string">"vase"</span>, <span class="hljs-string">"scissors"</span>, <span class="hljs-string">"teddy bear"</span>, <span class="hljs-string">"hair drier"</span>, <span class="hljs-string">"toothbrush"</span>
    };
}
</code></pre>
<h3 data-id="heading-6">2.2 æ ¸å¿ƒæ¨ç†å·¥å…·ç±»ï¼ˆYOLOv26Detectorï¼‰</h3>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-keyword">package</span> com.ai.detection.utils;

<span class="hljs-keyword">import</span> com.ai.detection.constant.YoloConstants;
<span class="hljs-keyword">import</span> com.ai.detection.entity.DetectedObject;
<span class="hljs-keyword">import</span> com.microsoft.onnxruntime.*;
<span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span> net.coobird.thumbnailator.Thumbnails;
<span class="hljs-keyword">import</span> org.springframework.core.io.ClassPathResource;
<span class="hljs-keyword">import</span> org.springframework.util.Base64Utils;

<span class="hljs-keyword">import</span> javax.imageio.ImageIO;
<span class="hljs-keyword">import</span> java.awt.*;
<span class="hljs-keyword">import</span> java.awt.image.BufferedImage;
<span class="hljs-keyword">import</span> java.io.ByteArrayInputStream;
<span class="hljs-keyword">import</span> java.io.File;
<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.io.InputStream;
<span class="hljs-keyword">import</span> java.nio.FloatBuffer;
<span class="hljs-keyword">import</span> java.util.*;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * YOLOv26æ£€æµ‹å·¥å…·ç±»ï¼ˆå•ä¾‹æ¨¡å¼ï¼Œé¿å…é‡å¤åŠ è½½æ¨¡å‹ï¼‰
 */</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YoloV26Detector</span> {
    <span class="hljs-comment">// å•ä¾‹å®ä¾‹</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> YoloV26Detector instance;
    <span class="hljs-comment">// ONNX Runtimeæ¨ç†ä¼šè¯</span>
    <span class="hljs-keyword">private</span> OrtSession session;
    <span class="hljs-comment">// ONNXç¯å¢ƒ</span>
    <span class="hljs-keyword">private</span> OrtEnvironment env;

    <span class="hljs-comment">/**
     * ç§æœ‰æ„é€ æ–¹æ³•ï¼ŒåŠ è½½æ¨¡å‹
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">YoloV26Detector</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// åˆå§‹åŒ–ONNXç¯å¢ƒ</span>
            env = OrtEnvironment.getEnvironment();
            <span class="hljs-comment">// åŠ è½½æ¨¡å‹æ–‡ä»¶</span>
            <span class="hljs-type">ClassPathResource</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathResource</span>(YoloConstants.MODEL_PATH);
            <span class="hljs-type">File</span> <span class="hljs-variable">modelFile</span> <span class="hljs-operator">=</span> resource.getFile();
            
            <span class="hljs-comment">// é…ç½®æ¨ç†ä¼šè¯ï¼ˆå¯ç”¨CPUæ¨ç†ï¼Œè‹¥æœ‰GPUå¯é…ç½®CUDAï¼‰</span>
            OrtSession.<span class="hljs-type">SessionOptions</span> <span class="hljs-variable">options</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrtSession</span>.SessionOptions();
            options.setIntraOpNumThreads(Runtime.getRuntime().availableProcessors());
            <span class="hljs-comment">// GPUé…ç½®ï¼ˆéœ€å®‰è£…CUDAç‰ˆONNX Runtimeï¼Œæ³¨é‡Šæ‰CPUé…ç½®åå¯ç”¨ï¼‰</span>
            <span class="hljs-comment">// options.addCUDA(0);</span>
            
            <span class="hljs-comment">// åˆ›å»ºæ¨ç†ä¼šè¯</span>
            session = env.createSession(modelFile.getAbsolutePath(), options);
            log.info(<span class="hljs-string">"YOLOv26æ¨¡å‹åŠ è½½æˆåŠŸï¼Œè·¯å¾„ï¼š{}"</span>, modelFile.getAbsolutePath());
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"YOLOv26æ¨¡å‹åŠ è½½å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æ¨¡å‹åˆå§‹åŒ–å¤±è´¥"</span>, e);
        }
    }

    <span class="hljs-comment">/**
     * è·å–å•ä¾‹å®ä¾‹
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> YoloV26Detector <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">synchronized</span> (YoloV26Detector.class) {
                <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
                    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">YoloV26Detector</span>();
                }
            }
        }
        <span class="hljs-keyword">return</span> instance;
    }

    <span class="hljs-comment">/**
     * å›¾ç‰‡æ–‡ä»¶æ£€æµ‹
     */</span>
    <span class="hljs-keyword">public</span> List&lt;DetectedObject&gt; <span class="hljs-title function_">detectImage</span><span class="hljs-params">(File imageFile)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-type">BufferedImage</span> <span class="hljs-variable">image</span> <span class="hljs-operator">=</span> ImageIO.read(imageFile);
        <span class="hljs-keyword">return</span> detect(image);
    }

    <span class="hljs-comment">/**
     * Base64å­—ç¬¦ä¸²æ£€æµ‹ï¼ˆéœ€å»é™¤å‰ç¼€å¦‚data:image/jpeg;base64,ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> List&lt;DetectedObject&gt; <span class="hljs-title function_">detectBase64</span><span class="hljs-params">(String base64Str)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-comment">// å»é™¤Base64å‰ç¼€</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">pureBase64</span> <span class="hljs-operator">=</span> base64Str.replaceAll(<span class="hljs-string">"^data:image/\\w+;base64,"</span>, <span class="hljs-string">""</span>);
        <span class="hljs-comment">// Base64è½¬å­—èŠ‚æ•°ç»„</span>
        <span class="hljs-type">byte</span>[] imageBytes = Base64Utils.decodeFromString(pureBase64);
        <span class="hljs-comment">// å­—èŠ‚æ•°ç»„è½¬BufferedImage</span>
        <span class="hljs-type">InputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayInputStream</span>(imageBytes);
        <span class="hljs-type">BufferedImage</span> <span class="hljs-variable">image</span> <span class="hljs-operator">=</span> ImageIO.read(inputStream);
        <span class="hljs-keyword">return</span> detect(image);
    }

    <span class="hljs-comment">/**
     * æ ¸å¿ƒæ£€æµ‹é€»è¾‘
     */</span>
    <span class="hljs-keyword">private</span> List&lt;DetectedObject&gt; <span class="hljs-title function_">detect</span><span class="hljs-params">(BufferedImage originalImage)</span> {
        <span class="hljs-type">long</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. å›¾ç‰‡é¢„å¤„ç†ï¼šç¼©æ”¾ã€å½’ä¸€åŒ–ã€ç»´åº¦è½¬æ¢</span>
            <span class="hljs-type">float</span>[] inputTensor = preprocessImage(originalImage);
            
            <span class="hljs-comment">// 2. ONNXæ¨¡å‹æ¨ç†</span>
            <span class="hljs-type">float</span>[][] output = inference(inputTensor);
            
            <span class="hljs-comment">// 3. åå¤„ç†ï¼šè§£æç»“æœã€NMSè¿‡æ»¤</span>
            List&lt;DetectedObject&gt; detectedObjects = postprocess(output, originalImage.getWidth(), originalImage.getHeight());
            
            log.info(<span class="hljs-string">"æ£€æµ‹å®Œæˆï¼Œè€—æ—¶ï¼š{}msï¼Œæ£€æµ‹åˆ°ç›®æ ‡æ•°ï¼š{}"</span>, System.currentTimeMillis() - startTime, detectedObjects.size());
            <span class="hljs-keyword">return</span> detectedObjects;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"æ£€æµ‹å¤±è´¥"</span>, e);
            <span class="hljs-keyword">return</span> Collections.emptyList();
        }
    }

    <span class="hljs-comment">/**
     * å›¾ç‰‡é¢„å¤„ç†
     * æ­¥éª¤ï¼šç¼©æ”¾è‡³640x640 â†’ å½’ä¸€åŒ–ï¼ˆ0-255â†’0-1ï¼‰ â†’ è½¬CHWæ ¼å¼ï¼ˆé€šé“ä¼˜å…ˆï¼‰ â†’ æ„å»ºè¾“å…¥å¼ é‡
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span>[] preprocessImage(BufferedImage image) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. ç¼©æ”¾å›¾ç‰‡ï¼ˆä¿æŒæ¯”ä¾‹ï¼Œå¡«å……é»‘è¾¹ï¼‰</span>
            <span class="hljs-type">BufferedImage</span> <span class="hljs-variable">resizedImage</span> <span class="hljs-operator">=</span> resizeWithPadding(image, YoloConstants.INPUT_WIDTH, YoloConstants.INPUT_HEIGHT);
            
            <span class="hljs-comment">// 2. è½¬RGBæ ¼å¼ï¼ˆé¿å…ç°åº¦å›¾/é€æ˜é€šé“é—®é¢˜ï¼‰</span>
            <span class="hljs-type">BufferedImage</span> <span class="hljs-variable">rgbImage</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedImage</span>(resizedImage.getWidth(), resizedImage.getHeight(), BufferedImage.TYPE_3BYTE_BGR);
            <span class="hljs-type">Graphics2D</span> <span class="hljs-variable">g</span> <span class="hljs-operator">=</span> rgbImage.createGraphics();
            g.drawImage(resizedImage, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">null</span>);
            g.dispose();
            
            <span class="hljs-comment">// 3. å½’ä¸€åŒ–+è½¬CHW</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">width</span> <span class="hljs-operator">=</span> rgbImage.getWidth();
            <span class="hljs-type">int</span> <span class="hljs-variable">height</span> <span class="hljs-operator">=</span> rgbImage.getHeight();
            <span class="hljs-type">float</span>[] input = <span class="hljs-keyword">new</span> <span class="hljs-title class_">float</span>[<span class="hljs-number">3</span> * width * height];
            <span class="hljs-type">byte</span>[] pixels = ((java.awt.image.DataBufferByte) rgbImage.getRaster().getDataBuffer()).getData();
            
            <span class="hljs-type">int</span> <span class="hljs-variable">pixelIndex</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; c &lt; <span class="hljs-number">3</span>; c++) {
                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; h &lt; height; h++) {
                    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; w &lt; width; w++) {
                        <span class="hljs-type">int</span> <span class="hljs-variable">pos</span> <span class="hljs-operator">=</span> h * width * <span class="hljs-number">3</span> + w * <span class="hljs-number">3</span> + c;
                        input[pixelIndex++] = pixels[pos] / <span class="hljs-number">255.0f</span>; <span class="hljs-comment">// å½’ä¸€åŒ–åˆ°0-1</span>
                    }
                }
            }
            <span class="hljs-keyword">return</span> input;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å›¾ç‰‡é¢„å¤„ç†å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }

    <span class="hljs-comment">/**
     * ç­‰æ¯”ä¾‹ç¼©æ”¾å›¾ç‰‡ï¼Œä¸è¶³éƒ¨åˆ†å¡«å……é»‘è¾¹
     */</span>
    <span class="hljs-keyword">private</span> BufferedImage <span class="hljs-title function_">resizeWithPadding</span><span class="hljs-params">(BufferedImage image, <span class="hljs-type">int</span> targetWidth, <span class="hljs-type">int</span> targetHeight)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è®¡ç®—ç¼©æ”¾æ¯”ä¾‹</span>
            <span class="hljs-type">double</span> <span class="hljs-variable">scale</span> <span class="hljs-operator">=</span> Math.min((<span class="hljs-type">double</span>) targetWidth / image.getWidth(), (<span class="hljs-type">double</span>) targetHeight / image.getHeight());
            <span class="hljs-type">int</span> <span class="hljs-variable">newWidth</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) (image.getWidth() * scale);
            <span class="hljs-type">int</span> <span class="hljs-variable">newHeight</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) (image.getHeight() * scale);
            
            <span class="hljs-comment">// ç¼©æ”¾å›¾ç‰‡</span>
            <span class="hljs-type">BufferedImage</span> <span class="hljs-variable">scaledImage</span> <span class="hljs-operator">=</span> Thumbnails.of(image).size(newWidth, newHeight).asBufferedImage();
            
            <span class="hljs-comment">// åˆ›å»ºç›®æ ‡å°ºå¯¸å›¾ç‰‡ï¼Œå¡«å……é»‘è¾¹</span>
            <span class="hljs-type">BufferedImage</span> <span class="hljs-variable">paddedImage</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedImage</span>(targetWidth, targetHeight, BufferedImage.TYPE_3BYTE_BGR);
            <span class="hljs-type">Graphics2D</span> <span class="hljs-variable">g</span> <span class="hljs-operator">=</span> paddedImage.createGraphics();
            g.setColor(Color.BLACK);
            g.fillRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, targetWidth, targetHeight);
            <span class="hljs-comment">// å±…ä¸­ç»˜åˆ¶ç¼©æ”¾åçš„å›¾ç‰‡</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> (targetWidth - newWidth) / <span class="hljs-number">2</span>;
            <span class="hljs-type">int</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> (targetHeight - newHeight) / <span class="hljs-number">2</span>;
            g.drawImage(scaledImage, x, y, <span class="hljs-literal">null</span>);
            g.dispose();
            
            <span class="hljs-keyword">return</span> paddedImage;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å›¾ç‰‡ç¼©æ”¾å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }

    <span class="hljs-comment">/**
     * ONNXæ¨¡å‹æ¨ç†
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span>[][] inference(<span class="hljs-type">float</span>[] inputTensor) <span class="hljs-keyword">throws</span> OrtException {
        <span class="hljs-comment">// æ„å»ºè¾“å…¥å¼ é‡ï¼ˆå½¢çŠ¶ï¼š1,3,640,640ï¼‰</span>
        <span class="hljs-type">long</span>[] inputShape = <span class="hljs-keyword">new</span> <span class="hljs-title class_">long</span>[]{<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, YoloConstants.INPUT_HEIGHT, YoloConstants.INPUT_WIDTH};
        <span class="hljs-type">OrtTensor</span> <span class="hljs-variable">inputOrtTensor</span> <span class="hljs-operator">=</span> OrtTensor.createTensor(env, FloatBuffer.wrap(inputTensor), inputShape);
        
        <span class="hljs-comment">// æ‰§è¡Œæ¨ç†</span>
        Map&lt;String, OrtTensor&gt; inputs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        inputs.put(<span class="hljs-string">"images"</span>, inputOrtTensor); <span class="hljs-comment">// è¾“å…¥åç§°éœ€ä¸ONNXæ¨¡å‹ä¸€è‡´ï¼ˆé€šå¸¸ä¸ºimagesï¼‰</span>
        OrtSession.<span class="hljs-type">Result</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> session.run(inputs);
        
        <span class="hljs-comment">// è§£æè¾“å‡ºï¼ˆYOLOv26è¾“å‡ºä¸º[1,84,8400]ï¼Œ84=80ç±»+4åæ ‡+ç½®ä¿¡åº¦ï¼‰</span>
        <span class="hljs-type">float</span>[][] output = (<span class="hljs-type">float</span>[][]) result.get(<span class="hljs-number">0</span>).getValue();
        
        <span class="hljs-comment">// é‡Šæ”¾èµ„æº</span>
        inputOrtTensor.close();
        result.close();
        
        <span class="hljs-keyword">return</span> output;
    }

    <span class="hljs-comment">/**
     * åå¤„ç†ï¼šè§£æè¾¹ç•Œæ¡†ã€ç½®ä¿¡åº¦è¿‡æ»¤ã€NMSéæå¤§å€¼æŠ‘åˆ¶ã€åæ ‡è¿˜åŸ
     */</span>
    <span class="hljs-keyword">private</span> List&lt;DetectedObject&gt; <span class="hljs-title function_">postprocess</span><span class="hljs-params">(<span class="hljs-type">float</span>[][] output, <span class="hljs-type">int</span> originalWidth, <span class="hljs-type">int</span> originalHeight)</span> {
        List&lt;DetectedObject&gt; allObjects = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-type">float</span>[] outputData = output[<span class="hljs-number">0</span>];
        <span class="hljs-type">int</span> <span class="hljs-variable">numBoxes</span> <span class="hljs-operator">=</span> outputData.length / <span class="hljs-number">84</span>; <span class="hljs-comment">// 8400ä¸ªé¢„æµ‹æ¡†</span>
        
        <span class="hljs-comment">// 1. è§£ææ¯ä¸ªé¢„æµ‹æ¡†</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; numBoxes; i++) {
            <span class="hljs-type">int</span> <span class="hljs-variable">baseIdx</span> <span class="hljs-operator">=</span> i * <span class="hljs-number">84</span>;
            <span class="hljs-comment">// æå–ç½®ä¿¡åº¦ï¼ˆç¬¬4ä¸ªå€¼ï¼‰</span>
            <span class="hljs-type">float</span> <span class="hljs-variable">confidence</span> <span class="hljs-operator">=</span> outputData[baseIdx + <span class="hljs-number">4</span>];
            <span class="hljs-keyword">if</span> (confidence &lt; YoloConstants.CONF_THRESHOLD) {
                <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// è¿‡æ»¤ä½ç½®ä¿¡åº¦</span>
            }
            
            <span class="hljs-comment">// æå–ç±»åˆ«ï¼ˆæœ€å¤§å€¼å¯¹åº”çš„ç´¢å¼•ï¼‰</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">classId</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-type">float</span> <span class="hljs-variable">maxClassScore</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; c &lt; <span class="hljs-number">80</span>; c++) {
                <span class="hljs-type">float</span> <span class="hljs-variable">score</span> <span class="hljs-operator">=</span> outputData[baseIdx + <span class="hljs-number">5</span> + c];
                <span class="hljs-keyword">if</span> (score &gt; maxClassScore) {
                    maxClassScore = score;
                    classId = c;
                }
            }
            <span class="hljs-type">float</span> <span class="hljs-variable">finalConfidence</span> <span class="hljs-operator">=</span> confidence * maxClassScore;
            <span class="hljs-keyword">if</span> (finalConfidence &lt; YoloConstants.CONF_THRESHOLD) {
                <span class="hljs-keyword">continue</span>;
            }
            
            <span class="hljs-comment">// æå–è¾¹ç•Œæ¡†ï¼ˆxywhæ ¼å¼ â†’ xyxyæ ¼å¼ï¼‰</span>
            <span class="hljs-type">float</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> outputData[baseIdx];
            <span class="hljs-type">float</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> outputData[baseIdx + <span class="hljs-number">1</span>];
            <span class="hljs-type">float</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> outputData[baseIdx + <span class="hljs-number">2</span>];
            <span class="hljs-type">float</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> outputData[baseIdx + <span class="hljs-number">3</span>];
            
            <span class="hljs-type">float</span> <span class="hljs-variable">x1</span> <span class="hljs-operator">=</span> x - w / <span class="hljs-number">2</span>;
            <span class="hljs-type">float</span> <span class="hljs-variable">y1</span> <span class="hljs-operator">=</span> y - h / <span class="hljs-number">2</span>;
            <span class="hljs-type">float</span> <span class="hljs-variable">x2</span> <span class="hljs-operator">=</span> x + w / <span class="hljs-number">2</span>;
            <span class="hljs-type">float</span> <span class="hljs-variable">y2</span> <span class="hljs-operator">=</span> y + h / <span class="hljs-number">2</span>;
            
            <span class="hljs-comment">// åæ ‡è¿˜åŸï¼ˆä»640x640è¿˜åŸåˆ°åŸå§‹å›¾ç‰‡å°ºå¯¸ï¼‰</span>
            <span class="hljs-type">float</span> <span class="hljs-variable">scaleX</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>) originalWidth / YoloConstants.INPUT_WIDTH;
            <span class="hljs-type">float</span> <span class="hljs-variable">scaleY</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>) originalHeight / YoloConstants.INPUT_HEIGHT;
            x1 = x1 * scaleX;
            y1 = y1 * scaleY;
            x2 = x2 * scaleX;
            y2 = y2 * scaleY;
            
            <span class="hljs-comment">// å°è£…æ£€æµ‹ç»“æœ</span>
            <span class="hljs-type">DetectedObject</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DetectedObject</span>();
            obj.setClassId(classId);
            obj.setClassName(YoloConstants.COCO_CLASSES[classId]);
            obj.setConfidence(finalConfidence);
            obj.setX1(x1);
            obj.setY1(y1);
            obj.setX2(x2);
            obj.setY2(y2);
            allObjects.add(obj);
        }
        
        <span class="hljs-comment">// 2. NMSéæå¤§å€¼æŠ‘åˆ¶ï¼ˆå»é™¤é‡å¤æ¡†ï¼‰</span>
        <span class="hljs-keyword">return</span> applyNMS(allObjects);
    }

    <span class="hljs-comment">/**
     * NMSéæå¤§å€¼æŠ‘åˆ¶
     */</span>
    <span class="hljs-keyword">private</span> List&lt;DetectedObject&gt; <span class="hljs-title function_">applyNMS</span><span class="hljs-params">(List&lt;DetectedObject&gt; objects)</span> {
        <span class="hljs-keyword">if</span> (objects.isEmpty()) {
            <span class="hljs-keyword">return</span> Collections.emptyList();
        }
        
        <span class="hljs-comment">// æŒ‰ç±»åˆ«åˆ†ç»„å¤„ç†</span>
        Map&lt;Integer, List&lt;DetectedObject&gt;&gt; classGroups = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        <span class="hljs-keyword">for</span> (DetectedObject obj : objects) {
            classGroups.computeIfAbsent(obj.getClassId(), k -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;()).add(obj);
        }
        
        List&lt;DetectedObject&gt; nmsResult = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">for</span> (List&lt;DetectedObject&gt; group : classGroups.values()) {
            <span class="hljs-comment">// æŒ‰ç½®ä¿¡åº¦é™åºæ’åº</span>
            group.sort((a, b) -&gt; Float.compare(b.getConfidence(), a.getConfidence()));
            
            <span class="hljs-type">boolean</span>[] keep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[group.size()];
            Arrays.fill(keep, <span class="hljs-literal">true</span>);
            
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; group.size(); i++) {
                <span class="hljs-keyword">if</span> (!keep[i]) {
                    <span class="hljs-keyword">continue</span>;
                }
                <span class="hljs-type">DetectedObject</span> <span class="hljs-variable">objI</span> <span class="hljs-operator">=</span> group.get(i);
                <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> i + <span class="hljs-number">1</span>; j &lt; group.size(); j++) {
                    <span class="hljs-keyword">if</span> (!keep[j]) {
                        <span class="hljs-keyword">continue</span>;
                    }
                    <span class="hljs-type">DetectedObject</span> <span class="hljs-variable">objJ</span> <span class="hljs-operator">=</span> group.get(j);
                    
                    <span class="hljs-comment">// è®¡ç®—IOUï¼ˆäº¤å¹¶æ¯”ï¼‰</span>
                    <span class="hljs-type">float</span> <span class="hljs-variable">iou</span> <span class="hljs-operator">=</span> calculateIOU(objI, objJ);
                    <span class="hljs-keyword">if</span> (iou &gt; YoloConstants.NMS_THRESHOLD) {
                        keep[j] = <span class="hljs-literal">false</span>;
                    }
                }
            }
            
            <span class="hljs-comment">// æ”¶é›†ä¿ç•™çš„æ¡†</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; group.size(); i++) {
                <span class="hljs-keyword">if</span> (keep[i]) {
                    nmsResult.add(group.get(i));
                }
            }
        }
        <span class="hljs-keyword">return</span> nmsResult;
    }

    <span class="hljs-comment">/**
     * è®¡ç®—IOUï¼ˆäº¤å¹¶æ¯”ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-title function_">calculateIOU</span><span class="hljs-params">(DetectedObject a, DetectedObject b)</span> {
        <span class="hljs-type">float</span> <span class="hljs-variable">x1</span> <span class="hljs-operator">=</span> Math.max(a.getX1(), b.getX1());
        <span class="hljs-type">float</span> <span class="hljs-variable">y1</span> <span class="hljs-operator">=</span> Math.max(a.getY1(), b.getY1());
        <span class="hljs-type">float</span> <span class="hljs-variable">x2</span> <span class="hljs-operator">=</span> Math.min(a.getX2(), b.getX2());
        <span class="hljs-type">float</span> <span class="hljs-variable">y2</span> <span class="hljs-operator">=</span> Math.min(a.getY2(), b.getY2());
        
        <span class="hljs-keyword">if</span> (x2 &lt; x1 || y2 &lt; y1) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0.0f</span>;
        }
        
        <span class="hljs-comment">// äº¤é›†é¢ç§¯</span>
        <span class="hljs-type">float</span> <span class="hljs-variable">intersection</span> <span class="hljs-operator">=</span> (x2 - x1) * (y2 - y1);
        <span class="hljs-comment">// å¹¶é›†é¢ç§¯</span>
        <span class="hljs-type">float</span> <span class="hljs-variable">areaA</span> <span class="hljs-operator">=</span> (a.getX2() - a.getX1()) * (a.getY2() - a.getY1());
        <span class="hljs-type">float</span> <span class="hljs-variable">areaB</span> <span class="hljs-operator">=</span> (b.getX2() - b.getX1()) * (b.getY2() - b.getY1());
        <span class="hljs-type">float</span> <span class="hljs-variable">union</span> <span class="hljs-operator">=</span> areaA + areaB - intersection;
        
        <span class="hljs-keyword">return</span> intersection / union;
    }

    <span class="hljs-comment">/**
     * é‡Šæ”¾èµ„æº
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">try</span> {
                session.close();
                env.close();
                log.info(<span class="hljs-string">"YOLOv26æ¨¡å‹èµ„æºå·²é‡Šæ”¾"</span>);
            } <span class="hljs-keyword">catch</span> (OrtException e) {
                log.error(<span class="hljs-string">"èµ„æºé‡Šæ”¾å¤±è´¥"</span>, e);
            }
        }
    }
}
</code></pre>
<h2 data-id="heading-7">ä¸‰ã€æ¥å£å°è£…ï¼šé€šç”¨æ£€æµ‹Controller</h2>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-keyword">package</span> com.ai.detection.controller;

<span class="hljs-keyword">import</span> com.ai.detection.entity.DetectionResult;
<span class="hljs-keyword">import</span> com.ai.detection.entity.DetectedObject;
<span class="hljs-keyword">import</span> com.ai.detection.utils.YoloV26Detector;
<span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span> org.springframework.http.HttpStatus;
<span class="hljs-keyword">import</span> org.springframework.http.ResponseEntity;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PostMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;
<span class="hljs-keyword">import</span> org.springframework.web.multipart.MultipartFile;

<span class="hljs-keyword">import</span> java.io.File;
<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * YOLOv26é€šç”¨æ£€æµ‹æ¥å£
 */</span>
<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/api/detect")</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DetectionController</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">YoloV26Detector</span> <span class="hljs-variable">detector</span> <span class="hljs-operator">=</span> YoloV26Detector.getInstance();

    <span class="hljs-comment">/**
     * å›¾ç‰‡æ–‡ä»¶æ£€æµ‹æ¥å£
     */</span>
    <span class="hljs-meta">@PostMapping("/image")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;DetectionResult&gt; <span class="hljs-title function_">detectImage</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam("file")</span> MultipartFile file)</span> {
        <span class="hljs-type">DetectionResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DetectionResult</span>();
        <span class="hljs-type">long</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å‚æ•°æ ¡éªŒ</span>
            <span class="hljs-keyword">if</span> (file.isEmpty()) {
                result.setStatus(<span class="hljs-string">"fail"</span>);
                result.setErrorMsg(<span class="hljs-string">"ä¸Šä¼ çš„å›¾ç‰‡æ–‡ä»¶ä¸ºç©º"</span>);
                <span class="hljs-keyword">return</span> ResponseEntity.badRequest().body(result);
            }
            
            <span class="hljs-comment">// ä¸´æ—¶æ–‡ä»¶ä¿å­˜ï¼ˆä¹Ÿå¯ç›´æ¥è¯»å–æµï¼Œé¿å…ç£ç›˜IOï¼‰</span>
            <span class="hljs-type">File</span> <span class="hljs-variable">tempFile</span> <span class="hljs-operator">=</span> File.createTempFile(<span class="hljs-string">"detect_"</span>, <span class="hljs-string">"."</span> + file.getOriginalFilename().split(<span class="hljs-string">"\\."</span>)[<span class="hljs-number">1</span>]);
            file.transferTo(tempFile);
            
            <span class="hljs-comment">// æ‰§è¡Œæ£€æµ‹</span>
            List&lt;DetectedObject&gt; objects = detector.detectImage(tempFile);
            
            <span class="hljs-comment">// å°è£…ç»“æœ</span>
            result.setStatus(<span class="hljs-string">"success"</span>);
            result.setObjects(objects);
            result.setCostTime(System.currentTimeMillis() - startTime);
            
            <span class="hljs-comment">// åˆ é™¤ä¸´æ—¶æ–‡ä»¶</span>
            tempFile.delete();
            
            <span class="hljs-keyword">return</span> ResponseEntity.ok(result);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å›¾ç‰‡æ£€æµ‹æ¥å£å¼‚å¸¸"</span>, e);
            result.setStatus(<span class="hljs-string">"fail"</span>);
            result.setErrorMsg(<span class="hljs-string">"æ£€æµ‹å¤±è´¥ï¼š"</span> + e.getMessage());
            result.setCostTime(System.currentTimeMillis() - startTime);
            <span class="hljs-keyword">return</span> ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(result);
        }
    }

    <span class="hljs-comment">/**
     * Base64æ£€æµ‹æ¥å£
     */</span>
    <span class="hljs-meta">@PostMapping("/base64")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;DetectionResult&gt; <span class="hljs-title function_">detectBase64</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam("base64Str")</span> String base64Str)</span> {
        <span class="hljs-type">DetectionResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DetectionResult</span>();
        <span class="hljs-type">long</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å‚æ•°æ ¡éªŒ</span>
            <span class="hljs-keyword">if</span> (base64Str == <span class="hljs-literal">null</span> || base64Str.trim().isEmpty()) {
                result.setStatus(<span class="hljs-string">"fail"</span>);
                result.setErrorMsg(<span class="hljs-string">"Base64å­—ç¬¦ä¸²ä¸ºç©º"</span>);
                <span class="hljs-keyword">return</span> ResponseEntity.badRequest().body(result);
            }
            
            <span class="hljs-comment">// æ‰§è¡Œæ£€æµ‹</span>
            List&lt;DetectedObject&gt; objects = detector.detectBase64(base64Str);
            
            <span class="hljs-comment">// å°è£…ç»“æœ</span>
            result.setStatus(<span class="hljs-string">"success"</span>);
            result.setObjects(objects);
            result.setCostTime(System.currentTimeMillis() - startTime);
            
            <span class="hljs-keyword">return</span> ResponseEntity.ok(result);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"Base64æ£€æµ‹æ¥å£å¼‚å¸¸"</span>, e);
            result.setStatus(<span class="hljs-string">"fail"</span>);
            result.setErrorMsg(<span class="hljs-string">"æ£€æµ‹å¤±è´¥ï¼š"</span> + e.getMessage());
            result.setCostTime(System.currentTimeMillis() - startTime);
            <span class="hljs-keyword">return</span> ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(result);
        }
    }
}
</code></pre>
<h2 data-id="heading-8">å››ã€å¯åŠ¨ç±»ä¸é…ç½®</h2>
<h3 data-id="heading-9">4.1 å¯åŠ¨ç±»</h3>
<pre><code class="hljs language-Java" lang="Java">
<span class="hljs-keyword">package</span> com.ai.detection;

<span class="hljs-keyword">import</span> com.ai.detection.utils.YoloV26Detector;
<span class="hljs-keyword">import</span> jakarta.annotation.PreDestroy;
<span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;
<span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;

<span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YoloV26Application</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        SpringApplication.run(YoloV26Application.class, args);
    }

    <span class="hljs-comment">/**
     * åº”ç”¨å…³é—­æ—¶é‡Šæ”¾æ¨¡å‹èµ„æº
     */</span>
    <span class="hljs-meta">@PreDestroy</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> {
        YoloV26Detector.getInstance().close();
    }
}
</code></pre>
<h3 data-id="heading-10">4.2 é…ç½®æ–‡ä»¶ï¼ˆapplication.ymlï¼‰</h3>
<pre><code class="hljs language-YAML" lang="YAML">
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">servlet:</span>
    <span class="hljs-attr">multipart:</span>
      <span class="hljs-comment"># å›¾ç‰‡ä¸Šä¼ å¤§å°é™åˆ¶</span>
      <span class="hljs-attr">max-file-size:</span> <span class="hljs-string">10MB</span>
      <span class="hljs-attr">max-request-size:</span> <span class="hljs-string">10MB</span>
  <span class="hljs-comment"># æ—¥å¿—é…ç½®</span>
<span class="hljs-attr">logging:</span>
  <span class="hljs-attr">level:</span>
    <span class="hljs-attr">com.ai.detection:</span> <span class="hljs-string">INFO</span>
    <span class="hljs-attr">org.springframework:</span> <span class="hljs-string">WARN</span>
    <span class="hljs-attr">com.microsoft.onnxruntime:</span> <span class="hljs-string">WARN</span>
  <span class="hljs-attr">pattern:</span>
    <span class="hljs-attr">console:</span> <span class="hljs-string">"%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"</span>
    <span class="hljs-attr">file:</span> <span class="hljs-string">"%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"</span>
<span class="hljs-comment"># æœåŠ¡å™¨é…ç½®</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
  <span class="hljs-attr">tomcat:</span>
    <span class="hljs-attr">max-threads:</span> <span class="hljs-number">200</span>
    <span class="hljs-attr">min-spare-threads:</span> <span class="hljs-number">20</span>
</code></pre>
<h2 data-id="heading-11">äº”ã€æµ‹è¯•éªŒè¯</h2>
<h3 data-id="heading-12">5.1 å›¾ç‰‡æ–‡ä»¶æ£€æµ‹ï¼ˆPostmanè¯·æ±‚ï¼‰</h3>
<ul>
<li>
<p>è¯·æ±‚åœ°å€ï¼š<code>http://localhost:8080/api/detect/image</code></p>
</li>
<li>
<p>è¯·æ±‚æ–¹å¼ï¼šPOST</p>
</li>
<li>
<p>è¯·æ±‚ç±»å‹ï¼šform-data</p>
</li>
<li>
<p>å‚æ•°ï¼š<code>file</code> â†’ é€‰æ‹©æœ¬åœ°å›¾ç‰‡æ–‡ä»¶</p>
</li>
</ul>
<h3 data-id="heading-13">5.2 Base64æ£€æµ‹ï¼ˆPostmanè¯·æ±‚ï¼‰</h3>
<ul>
<li>
<p>è¯·æ±‚åœ°å€ï¼š<code>http://localhost:8080/api/detect/base64</code></p>
</li>
<li>
<p>è¯·æ±‚æ–¹å¼ï¼šPOST</p>
</li>
<li>
<p>è¯·æ±‚ç±»å‹ï¼šform-data</p>
</li>
<li>
<p>å‚æ•°ï¼š<code>base64Str</code> â†’ å›¾ç‰‡çš„Base64å­—ç¬¦ä¸²ï¼ˆå¯å¸¦å‰ç¼€ï¼‰</p>
</li>
</ul>
<h3 data-id="heading-14">5.3 å“åº”ç¤ºä¾‹</h3>
<pre><code class="hljs language-JSON" lang="JSON">
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"success"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"errorMsg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"objects"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"className"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"person"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"classId"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"confidence"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.9856</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"x1"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">120.5</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"y1"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">80.2</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"x2"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">250.8</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"y2"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">450.3</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"className"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"car"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"classId"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"confidence"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.9532</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"x1"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">300.1</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"y1"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">200.5</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"x2"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">500.7</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"y2"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">350.9</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"costTime"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">85</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-15">å…­ã€å·¥ä¸šçº§ä¼˜åŒ–å»ºè®®</h2>
<ol>
<li>
<p><strong>æ¨¡å‹ç¼“å­˜</strong>ï¼šå•ä¾‹æ¨¡å¼ç¡®ä¿æ¨¡å‹åªåŠ è½½ä¸€æ¬¡ï¼Œé¿å…é‡å¤åˆå§‹åŒ–æ¶ˆè€—èµ„æºï¼›</p>
</li>
<li>
<p><strong>å¼‚æ­¥å¤„ç†</strong>ï¼šé«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œæ¥å£æ”¹ä¸ºå¼‚æ­¥ï¼ˆ<code>@Async</code>ï¼‰ï¼Œè¿”å›ä»»åŠ¡IDï¼Œé€šè¿‡å›è°ƒ/è½®è¯¢è·å–ç»“æœï¼›</p>
</li>
<li>
<p><strong>GPUåŠ é€Ÿ</strong>ï¼šéƒ¨ç½²åˆ°æœ‰NVIDIA GPUçš„æœåŠ¡å™¨ï¼Œæ›¿æ¢ä¸ºCUDAç‰ˆONNX Runtimeï¼Œæ¨ç†é€Ÿåº¦æå‡5-10å€ï¼›</p>
</li>
<li>
<p><strong>æ‰¹é‡æ£€æµ‹</strong>ï¼šæ‰©å±•æ¥å£æ”¯æŒå¤šå›¾ç‰‡æ‰¹é‡æ£€æµ‹ï¼Œé™ä½æ¨¡å‹è°ƒç”¨å¼€é”€ï¼›</p>
</li>
<li>
<p><strong>ç»“æœç¼“å­˜</strong>ï¼šå¯¹ç›¸åŒå›¾ç‰‡/Base64çš„æ£€æµ‹ç»“æœç¼“å­˜ï¼ˆRedisï¼‰ï¼Œé¿å…é‡å¤æ£€æµ‹ï¼›</p>
</li>
<li>
<p><strong>ç›‘æ§å‘Šè­¦</strong>ï¼šæ·»åŠ æ¥å£QPSã€è€—æ—¶ã€å¤±è´¥ç‡ç›‘æ§ï¼Œå¼‚å¸¸æ—¶è§¦å‘å‘Šè­¦ã€‚</p>
</li>
</ol>
<h3 data-id="heading-16">æ€»ç»“</h3>
<p>æœ¬æ¬¡å®æˆ˜æ ¸å¿ƒå®Œæˆäº†ä»¥ä¸‹å…³é”®å†…å®¹ï¼š</p>
<ol>
<li>
<p><strong>ç¯å¢ƒæ•´åˆ</strong>ï¼šSpringBoot 3.xæ•´åˆONNX Runtimeï¼Œå®ç°YOLOv26çš„Javaç«¯åŸç”Ÿæ¨ç†ï¼Œé¿å…è·¨è¯­è¨€è°ƒç”¨ï¼›</p>
</li>
<li>
<p><strong>é€šç”¨å°è£…</strong>ï¼šå·¥å…·ç±»æ”¯æŒå›¾ç‰‡æ–‡ä»¶/Base64åŒå…¥å‚ï¼Œç»Ÿä¸€æ£€æµ‹é€»è¾‘ï¼Œé€‚é…ä¸åŒä¸šåŠ¡åœºæ™¯ï¼›</p>
</li>
<li>
<p><strong>å·¥ä¸šçº§å¤„ç†</strong>ï¼šåŒ…å«å›¾ç‰‡é¢„å¤„ç†ã€NMSåå¤„ç†ã€å‚æ•°æ ¡éªŒã€å¼‚å¸¸æ•è·ï¼Œä¿è¯æ¥å£ç¨³å®šæ€§ï¼›</p>
</li>
<li>
<p><strong>æ ‡å‡†åŒ–æ¥å£</strong>ï¼šRESTfulé£æ ¼æ¥å£ï¼Œç»Ÿä¸€è¿”å›æ ¼å¼ï¼Œä¾¿äºå‰ç«¯/ç¬¬ä¸‰æ–¹ç³»ç»Ÿé›†æˆã€‚</p>
</li>
</ol>
<p>è¯¥æ–¹æ¡ˆå¯ç›´æ¥è½åœ°åˆ°æ™ºèƒ½ç›‘æ§ã€å·¥ä¸šè´¨æ£€ã€è‡ªåŠ¨é©¾é©¶è¾…åŠ©ç­‰åœºæ™¯ï¼Œåªéœ€æ›¿æ¢YOLOv26çš„è®­ç»ƒæƒé‡ï¼Œå³å¯é€‚é…è‡ªå®šä¹‰ç›®æ ‡æ£€æµ‹éœ€æ±‚ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨pythonä»æ•°æ®çœ‹ä¸–ç•Œï¼Œçœ‹çœ‹ç®—æ³•æ˜¯å¦‚ä½•åˆ†æä½ çš„]]></title>    <link>https://juejin.cn/post/7599924965950652454</link>    <guid>https://juejin.cn/post/7599924965950652454</guid>    <pubDate>2026-01-27T14:47:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599924965950652454" data-draft-id="7599920572840296457" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨pythonä»æ•°æ®çœ‹ä¸–ç•Œï¼Œçœ‹çœ‹ç®—æ³•æ˜¯å¦‚ä½•åˆ†æä½ çš„"/> <meta itemprop="keywords" content="Python,æ•°æ®å¯è§†åŒ–"/> <meta itemprop="datePublished" content="2026-01-27T14:47:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç é£ä¸€ä¼šå„¿"/> <meta itemprop="url" content="https://juejin.cn/user/555695627842490"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨pythonä»æ•°æ®çœ‹ä¸–ç•Œï¼Œçœ‹çœ‹ç®—æ³•æ˜¯å¦‚ä½•åˆ†æä½ çš„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/555695627842490/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç é£ä¸€ä¼šå„¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T14:47:51.000Z" title="Tue Jan 27 2026 14:47:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€æ•°æ®åˆ†æä¸å¤„ç†</h2>
<h3 data-id="heading-1">ï¼ˆä¸€ï¼‰ æ•°æ®çš„å¯¼å…¥å¯¼å‡º</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ•°æ®çš„å¯¼å…¥</span>
import pandas as pd
<span class="hljs-attr">df</span>= pd.read_csv(<span class="hljs-string">'data/data.csv'</span>)
</code></pre>

<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#æ•°æ®çš„å¯¼å‡º</span>
<span class="hljs-built_in">df</span>= df.tail()
df.to_csv(<span class="hljs-string">'data/output.csv'</span>)
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç®€å•json</span>
<span class="hljs-attr">df</span>= pd.read_json(<span class="hljs-string">'data/data.json'</span>)
</code></pre>

<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¤æ‚json</span>
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'data/data_complex.json'</span>) <span class="hljs-keyword">as</span> f:
    data = json.load(f)
</code></pre>
<h3 data-id="heading-2">ï¼ˆäºŒï¼‰ é—®é¢˜æ•°æ®å¤„ç†</h3>
<h4 data-id="heading-3">1. ç¼ºå¤±å€¼å¤„ç†</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
s=pd.Series([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,np.nan,<span class="hljs-literal">None</span>,pd.NA])
df=pd.DataFrame([[<span class="hljs-number">1</span>,pd.NA],[<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>],[<span class="hljs-literal">None</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>]],columns=[<span class="hljs-string">'ç¬¬ä¸€åˆ—'</span>,<span class="hljs-string">'ç¬¬äºŒåˆ—'</span>,<span class="hljs-string">'ç¬¬ä¸‰åˆ—'</span>])<span class="hljs-comment"># # # æŸ¥çœ‹æ˜¯å¦æ˜¯ç¼ºå¤±å€¼</span>
<span class="hljs-built_in">print</span>(s.isna())
<span class="hljs-built_in">print</span>(s.isnull())
<span class="hljs-built_in">print</span>(df.isna())
<span class="hljs-built_in">print</span>(df.isnull())
<span class="hljs-built_in">print</span>(df.isna().<span class="hljs-built_in">sum</span>(axis=<span class="hljs-number">1</span>))
<span class="hljs-built_in">print</span>(s.isna().<span class="hljs-built_in">sum</span>()) <span class="hljs-comment"># æŸ¥çœ‹ç¼ºå¤±å€¼çš„ä¸ªæ•°</span>
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å‰”é™¤ç¼ºå¤±å€¼</span>
print(s.dropna())
print(df.dropna())
print(df.dropna(<span class="hljs-attr">how</span>=<span class="hljs-string">'all'</span>)) <span class="hljs-comment"># å¦‚æœæ‰€æœ‰çš„å€¼éƒ½æ˜¯ç¼ºå¤±å€¼ï¼Œåˆ é™¤è¿™ä¸€è¡Œ</span>
print(df.dropna(<span class="hljs-attr">thresh</span>=<span class="hljs-number">2</span>)) <span class="hljs-comment"># å¦‚æœè‡³å°‘æœ‰nä¸ªå€¼ä¸æ˜¯ç¼ºå¤±å€¼ï¼Œå°±ä¿ç•™</span>
print(df.dropna(<span class="hljs-attr">axis</span>=<span class="hljs-number">1</span>)) <span class="hljs-comment"># å‰”é™¤ä¸€æ•´åˆ—çš„è®°å½•</span>
print(df.dropna(<span class="hljs-attr">subset</span>=[<span class="hljs-string">'ç¬¬ä¸€åˆ—'</span>])) <span class="hljs-comment"># å¦‚æœæŸåˆ—æœ‰ç¼ºå¤±å€¼ï¼Œåˆ™åˆ é™¤è¿™ä¸€è¡Œ</span>
</code></pre>

<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¡«å……ç¼ºå¤±å€¼</span>
<span class="hljs-built_in">df</span>=pd.read_csv(<span class="hljs-string">'data/data_withNA.csv'</span>)
df.isna().<span class="hljs-built_in">sum</span>(axis=0)
<span class="hljs-built_in">print</span>(df.fillna({<span class="hljs-string">'join_date'</span>:20})) <span class="hljs-comment"># ä½¿ç”¨å­—å…¸æ¥å¡«å……</span>
<span class="hljs-built_in">print</span>(df.fillna(<span class="hljs-built_in">df</span>[[<span class="hljs-string">'age'</span>]].mean())) <span class="hljs-comment"># ä½¿ç”¨ç»Ÿè®¡å€¼æ¥å¡«å……</span>
<span class="hljs-built_in">print</span>(df.ffill()) <span class="hljs-comment"># ç”¨å‰é¢çš„ç›¸é‚»å€¼å¡«å……</span>
<span class="hljs-built_in">print</span>(df.bfill()) <span class="hljs-comment"># ç”¨åé¢çš„ç›¸é‚»å€¼å¡«å……</span>
</code></pre>
<h4 data-id="heading-4">2. å»é‡å¤„ç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">data</span> = {
    <span class="hljs-string">"name"</span>:[<span class="hljs-string">'alice'</span> ,<span class="hljs-string">'alice'</span> ,<span class="hljs-string">'bob'</span> ,<span class="hljs-string">'alice'</span> ,<span class="hljs-string">'jack'</span> ,<span class="hljs-string">'bob'</span> ],
    <span class="hljs-string">"age"</span>: [<span class="hljs-number">26</span>,<span class="hljs-number">25</span>,<span class="hljs-number">30</span>,<span class="hljs-number">25</span>,<span class="hljs-number">35</span>,<span class="hljs-number">30</span>],
    <span class="hljs-string">"city"</span>:[<span class="hljs-string">'NY'</span> ,<span class="hljs-string">'NY'</span> ,<span class="hljs-string">'LA'</span> ,<span class="hljs-string">'NY'</span> , <span class="hljs-string">'SF'</span> , <span class="hljs-string">'LA'</span> ]
}
df=pd.DataFrame(<span class="hljs-keyword">data</span>)
</code></pre>

<pre><code class="hljs language-ini" lang="ini">df.duplicated() <span class="hljs-comment"># ä¸€æ•´æ¡è®°å½•éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ ‡è®°ä¸ºé‡å¤ï¼Œè¿”å›True</span>
df.drop_duplicates(<span class="hljs-attr">subset</span>=[<span class="hljs-string">'name'</span>])<span class="hljs-comment"># æ ¹æ®æŒ‡å®šåˆ—å»é‡</span>
df.drop_duplicates(<span class="hljs-attr">subset</span>=[<span class="hljs-string">'name'</span>],keep=<span class="hljs-string">'last'</span>) <span class="hljs-comment"># ä¿ç•™æœ€åä¸€æ¬¡å‡ºç°çš„è¡Œ</span>
</code></pre>
<h4 data-id="heading-5">3. æ•°æ®ç±»å‹çš„è½¬æ¢</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">df</span>[<span class="hljs-string">'age'</span>]=<span class="hljs-built_in">df</span>[<span class="hljs-string">'age'</span>].astype(<span class="hljs-string">'int16'</span>)
</code></pre>
<h4 data-id="heading-6">4. æ•°æ®å˜å½¢</h4>
<pre><code class="hljs language-ini" lang="ini">import pandas as pd
<span class="hljs-attr">data</span> = {
    'ID': <span class="hljs-section">[1, 2]</span>,
    'name' : <span class="hljs-section">['alice', 'bob' ]</span>,
    'Math': <span class="hljs-section">[90, 85]</span>,
    'English': <span class="hljs-section">[88, 92]</span>,
    'Science': <span class="hljs-section">[95, 89]</span>
}
<span class="hljs-attr">df</span> = pd.DataFrame(data)
df.T <span class="hljs-comment"># è½¬ç½®</span>
<span class="hljs-comment">#å®½è¡¨è½¬æ¢ä¸ºé•¿è¡¨</span>
<span class="hljs-attr">df2</span>=pd.melt(df,id_vars=[<span class="hljs-string">'ID'</span>,<span class="hljs-string">'name'</span>],var_name=<span class="hljs-string">'ç§‘ç›®'</span>,value_name=<span class="hljs-string">'åˆ†æ•°'</span>)
df2.sort_values('name') <span class="hljs-comment">#æ’åº</span>
<span class="hljs-comment">#é•¿è¡¨è½¬å®½è¡¨</span>
pd.pivot(df2,<span class="hljs-attr">index</span>=[<span class="hljs-string">'ID'</span>,<span class="hljs-string">'name'</span>],columns=<span class="hljs-string">'ç§‘ç›®'</span>,values=<span class="hljs-string">'åˆ†æ•°'</span>)
</code></pre>

<pre><code class="hljs language-bash" lang="bash">data = {
<span class="hljs-string">'ID'</span>: [1, 2],
<span class="hljs-string">'name'</span> : [<span class="hljs-string">'alice smith'</span> , <span class="hljs-string">'bob smith'</span> ],
<span class="hljs-string">'Math'</span>: [90, 85],
<span class="hljs-string">'English'</span>: [88, 92],
<span class="hljs-string">'Science'</span>: [95, 89]
}
<span class="hljs-built_in">df</span> = pd.DataFrame(data)
<span class="hljs-comment"># åˆ†åˆ—</span>
<span class="hljs-built_in">df</span>[[<span class="hljs-string">'first'</span>,<span class="hljs-string">'last'</span>]]= <span class="hljs-built_in">df</span>[<span class="hljs-string">'name'</span>].str.split(<span class="hljs-string">' '</span>,<span class="hljs-built_in">expand</span>=True)
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ•°æ®åˆ†ç®± pd.cat(x,bins,labels)</span>
<span class="hljs-attr">df1</span>=df.head(<span class="hljs-number">5</span>)[[<span class="hljs-string">'id'</span>,<span class="hljs-string">'age'</span>]]
pd.cut(df1<span class="hljs-section">['age']</span>,<span class="hljs-attr">bins</span>=<span class="hljs-number">2</span>) <span class="hljs-comment"># bins=nï¼Œåˆ†æˆnæ®µåŒºé—´ï¼Œèµ·å§‹å€¼ã€ç»“æŸå€¼æ˜¯æ‰€æœ‰æ•°æ®çš„æœ€å°å€¼ã€æœ€å¤§å€¼</span>
pd.cut(df1<span class="hljs-section">['age']</span>,<span class="hljs-attr">bins</span>=<span class="hljs-number">2</span>).value_counts()
pd.cut(df1<span class="hljs-section">['age']</span>,<span class="hljs-attr">bins</span>=[<span class="hljs-number">0</span>,<span class="hljs-number">25</span>,<span class="hljs-number">35</span>,<span class="hljs-number">45</span>]) <span class="hljs-comment"># bins=list,åˆ†æˆnæ®µåŒºé—´</span>
pd.cut(df1<span class="hljs-section">['age']</span>,<span class="hljs-attr">bins</span>=[<span class="hljs-number">0</span>,<span class="hljs-number">25</span>,<span class="hljs-number">35</span>,<span class="hljs-number">45</span>]).value_counts()
pd.cut(df1<span class="hljs-section">['age']</span>,<span class="hljs-attr">bins</span>=[<span class="hljs-number">0</span>,<span class="hljs-number">25</span>,<span class="hljs-number">35</span>,<span class="hljs-number">45</span>],labels=[<span class="hljs-string">'å¹¼'</span>,<span class="hljs-string">'ä¸­'</span>,<span class="hljs-string">'è€'</span>])
pd.qcut(df1<span class="hljs-section">['age']</span>,3)
</code></pre>

<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># é‡å‘½å</span>
df = pd.DataFrame(
    {
        <span class="hljs-string">'name'</span> : [ <span class="hljs-string">'jack'</span> ,<span class="hljs-string">'alice'</span> , <span class="hljs-string">'tom'</span> , <span class="hljs-string">'bob'</span> ],
        <span class="hljs-string">'age'</span>:[<span class="hljs-number">20</span>,<span class="hljs-number">30</span>,<span class="hljs-number">40</span>,<span class="hljs-number">50</span>],
        <span class="hljs-string">'gender'</span> : [<span class="hljs-string">'female'</span> , <span class="hljs-string">'male'</span> , <span class="hljs-string">' female'</span> , <span class="hljs-string">'male'</span> ]
    }
)
df.set_index(<span class="hljs-string">'name'</span>,inplace=<span class="hljs-literal">True</span>)
df.reset_index(inplace=<span class="hljs-literal">True</span>)
df.rename(columns={<span class="hljs-string">'age'</span>:<span class="hljs-string">"å¹´é¾„"</span>},index={<span class="hljs-number">0</span>:<span class="hljs-number">4</span>})
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">df.index</span>=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]
<span class="hljs-attr">df.columns</span>=[<span class="hljs-string">'å§“å'</span>,<span class="hljs-string">'å¹´é¾„'</span>,<span class="hljs-string">'æ€§åˆ«'</span>]
</code></pre>
<h4 data-id="heading-7">5. æ—¶é—´æ•°æ®å¤„ç†</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
d = pd.Timestamp(<span class="hljs-string">'2015-05-02 10:22'</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">'å¹´ï¼š'</span>,d.year)
<span class="hljs-built_in">print</span>(<span class="hljs-string">'å­£åº¦ï¼š'</span>,d.quarter)
<span class="hljs-built_in">print</span>(<span class="hljs-string">'æ˜¯å¦æ˜¯æœˆåº•:'</span>,d.is_month_end)
<span class="hljs-comment"># æ–¹æ³•</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">'æ˜ŸæœŸå‡ ï¼š'</span>,d.day_name())
<span class="hljs-built_in">print</span>(<span class="hljs-string">'è½¬æ¢ä¸ºå¤©ï¼š'</span>,d.to_period(<span class="hljs-string">'D'</span>))
<span class="hljs-built_in">print</span>(<span class="hljs-string">'è½¬æ¢ä¸ºå­£åº¦ï¼š'</span>,d.to_period(<span class="hljs-string">'Q'</span>))
<span class="hljs-built_in">print</span>(<span class="hljs-string">'è½¬æ¢ä¸ºå¹´åº¦ï¼š'</span>,d.to_period(<span class="hljs-string">'Y'</span>))
<span class="hljs-built_in">print</span>(<span class="hljs-string">'è½¬æ¢ä¸ºæœˆåº¦ï¼š'</span>,d.to_period(<span class="hljs-string">'M'</span>))
</code></pre>

<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ—¥æœŸç±»å‹</span>
a = pd.to_datetime(<span class="hljs-string">'2015-01-04 10:22'</span>)
<span class="hljs-built_in">print</span>(a)
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(a))

<span class="hljs-comment"># dataFrame æ—¥æœŸè½¬æ¢</span>
<span class="hljs-built_in">df</span>= pd.DataFrame(
    {
        <span class="hljs-string">'sales'</span>:[100,200,300],
        <span class="hljs-string">'date'</span>:[<span class="hljs-string">'20250601'</span>,<span class="hljs-string">'20250704'</span>,<span class="hljs-string">'20250506'</span>]
    }
)
<span class="hljs-built_in">df</span>[<span class="hljs-string">'datatime'</span>]=pd.to_datetime(<span class="hljs-built_in">df</span>[<span class="hljs-string">'date'</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">type</span>(<span class="hljs-built_in">df</span>[<span class="hljs-string">'datatime'</span>]))
<span class="hljs-built_in">df</span>[<span class="hljs-string">'week'</span>] = <span class="hljs-built_in">df</span>[<span class="hljs-string">'datatime'</span>].dt.day_name()
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ—¥æœŸæ•°æ®ä½œä¸ºç´¢å¼•</span>
df.set_index('date',<span class="hljs-attr">inplace</span>=<span class="hljs-literal">True</span>) <span class="hljs-comment"># è®¾ç½®åŸæ¥çš„dfçš„ç´¢å¼•</span>
<span class="hljs-comment">#print(df.loc['2025-05-06':'2025-07-04'])</span>
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ—¶é—´é—´éš”</span>
<span class="hljs-attr">d1</span> = pd. Timestamp(<span class="hljs-string">'2013-01-15'</span>)
<span class="hljs-attr">d2</span> = pd.Timestamp(<span class="hljs-string">'2023-02-23'</span>)
<span class="hljs-attr">d3</span> = d2-d1
print(type(d3))
</code></pre>

<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ—¥æœŸç”Ÿæˆ</span>
<span class="hljs-attr">days</span>= pd.date_range(<span class="hljs-string">'2025-07-03'</span>,<span class="hljs-string">'2026-01-04'</span>,freq=<span class="hljs-string">'W'</span>)
print(days)
<span class="hljs-attr">days</span>= pd.date_range(<span class="hljs-string">'2025-07-03'</span>,periods=<span class="hljs-number">10</span>,freq=<span class="hljs-string">'W'</span>)
print(days)
</code></pre>
<h4 data-id="heading-8">6. åˆ†ç»„èšåˆ</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">df.groupby(<span class="hljs-string">'åˆ†ç»„çš„å­—æ®µ'</span>)[<span class="hljs-string">'èšåˆçš„å­—æ®µ'</span>].èšåˆå‡½æ•°()</span>
<span class="hljs-meta prompt_"># </span><span class="bash">df.groupby(<span class="hljs-string">'åˆ†ç»„çš„å­—æ®µ'</span>).<span class="hljs-built_in">groups</span> <span class="hljs-comment"># æŸ¥çœ‹åˆ†ç»„</span></span>
<span class="hljs-meta prompt_"># </span><span class="bash">df.groupby(<span class="hljs-string">'åˆ†ç»„çš„å­—æ®µ'</span>).get_group(n) <span class="hljs-comment"># æŸ¥çœ‹å…·ä½“çš„æŸä¸ªåˆ†ç»„æ•°æ®</span></span>
</code></pre>
<h2 data-id="heading-9">äºŒã€æ•°æ®å¯è§†åŒ–</h2>
<h3 data-id="heading-10">ï¼ˆä¸€ï¼‰matplotlib</h3>
<p><code>matplotlib</code>Â æ˜¯ Python ä¸­æœ€å¸¸ç”¨çš„æ•°æ®å¯è§†åŒ–åº“ä¹‹ä¸€ï¼Œä¸»è¦ç”¨äºç»˜åˆ¶ 2D å›¾è¡¨ï¼ˆä¹Ÿæ”¯æŒç®€å•çš„ 3D ç»˜å›¾ï¼‰ã€‚å®ƒåŠŸèƒ½å¼ºå¤§ã€çµæ´»ï¼Œå¹¿æ³›åº”ç”¨äºç§‘å­¦è®¡ç®—ã€æ•°æ®åˆ†æå’Œæœºå™¨å­¦ä¹ ç­‰é¢†åŸŸã€‚</p>
<h4 data-id="heading-11">æŠ˜çº¿å›¾</h4>
<pre><code class="hljs language-ini" lang="ini">import matplotlib.pyplot as plt
from matplotlib import rcParams
<span class="hljs-comment"># è®¾ç½®ä¸­æ–‡å­—ä½“ï¼ˆç¡®ä¿æ”¯æŒä¸­æ–‡æ˜¾ç¤ºï¼‰</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> = <span class="hljs-section">['STKAITI']</span>  <span class="hljs-comment"># ä½¿ç”¨é»‘ä½“æˆ–åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># æ•°æ®</span>
<span class="hljs-attr">months</span> = [<span class="hljs-string">'1æœˆ'</span>, <span class="hljs-string">'2æœˆ'</span>, <span class="hljs-string">'3æœˆ'</span>, <span class="hljs-string">'4æœˆ'</span>]
<span class="hljs-attr">sales</span> = [<span class="hljs-number">100</span>, <span class="hljs-number">150</span>, <span class="hljs-number">80</span>, <span class="hljs-number">130</span>]
<span class="hljs-comment"># åˆ›å»ºå›¾å½¢å’Œè½´</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>, <span class="hljs-number">6</span>))
<span class="hljs-comment"># ç»˜åˆ¶æŠ˜çº¿å›¾</span>
plt.plot(months, sales, <span class="hljs-attr">marker</span>=<span class="hljs-string">'o'</span>, color=<span class="hljs-string">'orange'</span>, linewidth=<span class="hljs-number">2</span>, markersize=<span class="hljs-number">6</span>)
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('2025å¹´é”€å”®è¶‹åŠ¿', <span class="hljs-attr">fontsize</span>=<span class="hljs-number">18</span>, color=<span class="hljs-string">'red'</span>, pad=<span class="hljs-number">20</span>)
<span class="hljs-comment"># è®¾ç½®åæ ‡è½´æ ‡ç­¾</span>
plt.xlabel('æœˆä»½', <span class="hljs-attr">fontsize</span>=<span class="hljs-number">12</span>)
plt.ylabel('é”€å”®é¢ï¼ˆä¸‡å…ƒï¼‰', <span class="hljs-attr">fontsize</span>=<span class="hljs-number">12</span>)
<span class="hljs-comment"># è®¾ç½®yè½´èŒƒå›´</span>
plt.ylim(0, 160)
<span class="hljs-comment"># æ·»åŠ ç½‘æ ¼çº¿</span>
plt.grid(True, <span class="hljs-attr">alpha</span>=<span class="hljs-number">0.3</span>, linestyle=<span class="hljs-string">'--'</span>, linewidth=<span class="hljs-number">0.8</span>)
<span class="hljs-comment"># æ·»åŠ å›¾ä¾‹</span>
plt.legend(<span class="hljs-section">['äº§å“A']</span>, <span class="hljs-attr">loc</span>=<span class="hljs-string">'upper left'</span>, frameon=<span class="hljs-literal">True</span>, fancybox=<span class="hljs-literal">True</span>, shadow=<span class="hljs-literal">False</span>)
<span class="hljs-comment"># åœ¨æ¯ä¸ªæ•°æ®ç‚¹ä¸Šæ ‡æ³¨æ•°å€¼</span>
for i, (x, y) in enumerate(zip(months, sales)):
    plt.text(x, y + 2, str(y), <span class="hljs-attr">ha</span>=<span class="hljs-string">'center'</span>, va=<span class="hljs-string">'bottom'</span>, fontsize=<span class="hljs-number">10</span>, color=<span class="hljs-string">'black'</span>)
<span class="hljs-comment"># è°ƒæ•´å¸ƒå±€ï¼Œé¿å…æ ‡ç­¾è¢«è£å‰ª</span>
plt.tight_layout()
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91e9ddeaca9042e4a6b60fe5ff5c8ea9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=AC6R9y9YbkgvvKWsr6V%2FyeTB0ss%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-12">æŸ±çŠ¶å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç»˜åˆ¶æŸ±çŠ¶å›¾</span>
import matplotlib.pyplot as plt
from matplotlib import rcParams <span class="hljs-comment"># å­—ä½“</span>
<span class="hljs-comment">#rcParams['font.family'] = 'STKAITI' #åæ–‡æ¥·ä½“</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> ='STKAITI' <span class="hljs-comment">#åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨ï¼Œè®¾ç½®å¤§å°</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>,<span class="hljs-number">5</span>))
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">subjects</span>=[<span class="hljs-string">'è¯­æ–‡'</span>,<span class="hljs-string">'æ•°å­¦'</span>,<span class="hljs-string">'è‹±è¯­'</span>,<span class="hljs-string">'åŒ–å­¦'</span>]
<span class="hljs-attr">scores</span>=[<span class="hljs-number">85</span>,<span class="hljs-number">92</span>,<span class="hljs-number">78</span>,<span class="hljs-number">88</span>]
<span class="hljs-comment"># ç»˜åˆ¶æŸ±çŠ¶å›¾</span>
plt.bar(subjects,scores,<span class="hljs-attr">label</span>=<span class="hljs-string">'å°çº¢'</span>,color=<span class="hljs-string">'orange'</span>,width=<span class="hljs-number">0.6</span>)
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('2025æˆç»©åˆ†å¸ƒ',<span class="hljs-attr">color</span>=<span class="hljs-string">'red'</span>,fontsize=<span class="hljs-number">20</span>)
<span class="hljs-comment"># æ·»åŠ åæ ‡è½´æ ‡ç­¾</span>
plt.xlabel('ç§‘ç›®',<span class="hljs-attr">fontsize</span>=<span class="hljs-number">10</span>)
plt.ylabel('æˆç»©ï¼ˆåˆ†ï¼‰',<span class="hljs-attr">fontsize</span>=<span class="hljs-number">10</span>)
<span class="hljs-comment"># æ·»åŠ å›¾ä¾‹</span>
plt.legend(<span class="hljs-attr">loc</span>=<span class="hljs-string">'upper right'</span>)
<span class="hljs-comment"># æ·»åŠ ç½‘æ ¼çº¿</span>
<span class="hljs-comment"># plt.grid(True,alpha=0.1,color='blue',linestyle='--') # '-':å®çº¿ ï¼›'--'ï¼šè™šçº¿</span>
plt.grid(<span class="hljs-attr">axis</span>=<span class="hljs-string">'y'</span>,alpha=<span class="hljs-number">0.1</span>,color=<span class="hljs-string">'blue'</span>,linestyle=<span class="hljs-string">'--'</span>)
<span class="hljs-comment"># è®¾ç½®åˆ»åº¦å­—ä½“å¤§å°</span>
plt.xticks(<span class="hljs-attr">rotation</span>=<span class="hljs-number">20</span>,fontsize=<span class="hljs-number">12</span>)
plt.yticks(<span class="hljs-attr">rotation</span>=<span class="hljs-number">0</span>,fontsize=<span class="hljs-number">12</span>)
<span class="hljs-comment"># è®¾ç½®yè½´çš„èŒƒå›´</span>
plt.ylim(0,100)
<span class="hljs-comment"># æ¯ä¸ªæ•°æ®ç‚¹ä¸Šæ˜¾ç¤ºæ•°å€¼</span>
for x,y in zip(subjects,scores):
    <span class="hljs-comment"># print(x,y)</span>
    plt.text(x,y+1,str(y),<span class="hljs-attr">ha</span>=<span class="hljs-string">'center'</span>,va=<span class="hljs-string">'bottom'</span>,fontsize=<span class="hljs-number">10</span>)
<span class="hljs-comment"># è‡ªåŠ¨ä¼˜åŒ–æ’ç‰ˆ</span>
plt.tight_layout()
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/002c9a89ae124f35aba3ebeae7b77de3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=fZ2PMN80lKdXpiB%2FoWWrcVUMzrM%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-13">æ¡å½¢å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç»˜åˆ¶æ¡å½¢å›¾</span>
import matplotlib.pyplot as plt
from matplotlib import rcParams <span class="hljs-comment"># å­—ä½“</span>
<span class="hljs-comment">#rcParams['font.family'] = 'STKAITI' #åæ–‡æ¥·ä½“</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> ='STKAITI' <span class="hljs-comment">#åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨ï¼Œè®¾ç½®å¤§å°</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>,<span class="hljs-number">5</span>))
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">countries</span>=[<span class="hljs-string">'United States'</span> , <span class="hljs-string">'China'</span> , <span class="hljs-string">'Japan'</span> ,<span class="hljs-string">'Germany'</span> , <span class="hljs-string">'India'</span> ]
<span class="hljs-attr">gdp</span>=[<span class="hljs-number">85</span>,<span class="hljs-number">92</span>,<span class="hljs-number">78</span>,<span class="hljs-number">88</span>,<span class="hljs-number">23</span>]
<span class="hljs-comment"># ç»˜åˆ¶æ¡å½¢å›¾</span>
plt.barh(countries,gdp,<span class="hljs-attr">label</span>=<span class="hljs-string">'GDP'</span>,color=<span class="hljs-string">'orange'</span>)
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('2025GDPæ’å',<span class="hljs-attr">color</span>=<span class="hljs-string">'red'</span>,fontsize=<span class="hljs-number">20</span>)
<span class="hljs-comment"># æ·»åŠ åæ ‡è½´æ ‡ç­¾</span>
plt.xlabel('å›½å®¶',<span class="hljs-attr">fontsize</span>=<span class="hljs-number">10</span>)
plt.ylabel('GDPï¼ˆä¸‡å…ƒï¼‰',<span class="hljs-attr">fontsize</span>=<span class="hljs-number">10</span>)
<span class="hljs-comment"># æ·»åŠ å›¾ä¾‹</span>
plt.legend(<span class="hljs-attr">loc</span>=<span class="hljs-string">'upper right'</span>)
<span class="hljs-comment"># æ·»åŠ ç½‘æ ¼çº¿</span>
<span class="hljs-comment"># plt.grid(True,alpha=0.1,color='blue',linestyle='--') # '-':å®çº¿ ï¼›'--'ï¼šè™šçº¿</span>
plt.grid(<span class="hljs-attr">axis</span>=<span class="hljs-string">'x'</span>,alpha=<span class="hljs-number">0.1</span>,color=<span class="hljs-string">'blue'</span>,linestyle=<span class="hljs-string">'--'</span>)
<span class="hljs-comment"># è®¾ç½®åˆ»åº¦å­—ä½“å¤§å°</span>
plt.xticks(<span class="hljs-attr">rotation</span>=<span class="hljs-number">20</span>,fontsize=<span class="hljs-number">12</span>)
plt.yticks(<span class="hljs-attr">rotation</span>=<span class="hljs-number">0</span>,fontsize=<span class="hljs-number">12</span>)
<span class="hljs-comment"># è‡ªåŠ¨ä¼˜åŒ–æ’ç‰ˆ</span>
plt.tight_layout()
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef2e9535cdbd4a53ac8b4b38de3a70d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=jZZaFs7N1YFT8x0To6HwdjEJXsY%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-14">é¥¼å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç»˜åˆ¶é¥¼å›¾</span>
import matplotlib.pyplot as plt
from matplotlib import rcParams <span class="hljs-comment"># å­—ä½“</span>
<span class="hljs-comment">#rcParams['font.family'] = 'STKAITI' #åæ–‡æ¥·ä½“</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> ='STKAITI' <span class="hljs-comment">#åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨ï¼Œè®¾ç½®å¤§å°</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>,<span class="hljs-number">5</span>))
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">things</span>=[<span class="hljs-string">'å­¦ä¹ '</span>,<span class="hljs-string">'å¨±ä¹'</span>,<span class="hljs-string">'è¿åŠ¨'</span>,<span class="hljs-string">'ç¡è§‰'</span>,<span class="hljs-string">'å…¶ä»–'</span>]
<span class="hljs-attr">times</span> = [<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">8</span>,<span class="hljs-number">5</span>]
<span class="hljs-attr">colors</span> = [<span class="hljs-string">'#66b3ff'</span>,<span class="hljs-string">'#99ff99'</span>,<span class="hljs-string">'#ffcc99'</span>,<span class="hljs-string">'#ff9999'</span>,<span class="hljs-string">'#ff4499'</span>] <span class="hljs-comment">#é…è‰²</span>
<span class="hljs-comment"># ç»˜åˆ¶é¥¼å›¾</span>
plt.pie(times,<span class="hljs-attr">labels</span>=things,autopct=<span class="hljs-string">'%1.1f %%'</span>,startangle=<span class="hljs-number">30</span>,colors=colors)<span class="hljs-comment"># startangleè°ƒæ•´åˆå§‹è§’åº¦</span>
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('ä¸€å¤©æ—¶é—´åˆ†å¸ƒ',<span class="hljs-attr">color</span>=<span class="hljs-string">'red'</span>,fontsize=<span class="hljs-number">20</span>)
<span class="hljs-comment"># è‡ªåŠ¨ä¼˜åŒ–æ’ç‰ˆ</span>
plt.tight_layout()
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be9e4793368a4cfe8c4d7e3cee9cdd08~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=tlJfsDi1oUcB9%2BkeOVdrCV3FieE%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-15">ç¯å½¢å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç»˜åˆ¶ç¯å½¢å›¾</span>
import matplotlib.pyplot as plt
from matplotlib import rcParams <span class="hljs-comment"># å­—ä½“</span>
<span class="hljs-comment">#rcParams['font.family'] = 'STKAITI' #åæ–‡æ¥·ä½“</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> ='STKAITI' <span class="hljs-comment">#åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨ï¼Œè®¾ç½®å¤§å°</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>,<span class="hljs-number">5</span>))
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">things</span>=[<span class="hljs-string">'å­¦ä¹ '</span>,<span class="hljs-string">'å¨±ä¹'</span>,<span class="hljs-string">'è¿åŠ¨'</span>,<span class="hljs-string">'ç¡è§‰'</span>,<span class="hljs-string">'å…¶ä»–'</span>]
<span class="hljs-attr">times</span> = [<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">8</span>,<span class="hljs-number">5</span>]
<span class="hljs-attr">colors</span> = [<span class="hljs-string">'#66b3ff'</span>,<span class="hljs-string">'#99ff99'</span>,<span class="hljs-string">'#ffcc99'</span>,<span class="hljs-string">'#ff9999'</span>,<span class="hljs-string">'#ff4499'</span>] <span class="hljs-comment">#é…è‰²</span>
<span class="hljs-comment"># ç»˜åˆ¶ç¯å½¢å›¾</span>
plt.pie(times,<span class="hljs-attr">labels</span>=things,autopct=<span class="hljs-string">'%1.1f %%'</span>,
        <span class="hljs-attr">startangle</span>=<span class="hljs-number">30</span>,colors=colors,<span class="hljs-comment"># startangleè°ƒæ•´åˆå§‹è§’åº¦</span>
        <span class="hljs-attr">wedgeprops</span>={<span class="hljs-string">'width'</span>:<span class="hljs-number">0.6</span>},<span class="hljs-comment"># åœ†ç¯å®½åº¦</span>
        <span class="hljs-attr">pctdistance</span>=<span class="hljs-number">0.6</span>)
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('ä¸€å¤©æ—¶é—´åˆ†å¸ƒ',<span class="hljs-attr">color</span>=<span class="hljs-string">'red'</span>,fontsize=<span class="hljs-number">20</span>)
plt.text(0,0,'æ€»è®¡ï¼š\n100%')
<span class="hljs-comment"># è‡ªåŠ¨ä¼˜åŒ–æ’ç‰ˆ</span>
plt.tight_layout()
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6135a2e018d944e0abbe8e3bda7519f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=mCM%2FVOrGe8m%2B6wf5LFPFmQwaHd4%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-16">çˆ†ç‚¸å¼é¥¼å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç»˜åˆ¶çˆ†ç‚¸å¼é¥¼å›¾</span>
import matplotlib.pyplot as plt
from matplotlib import rcParams <span class="hljs-comment"># å­—ä½“</span>
<span class="hljs-comment">#rcParams['font.family'] = 'STKAITI' #åæ–‡æ¥·ä½“</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> ='STKAITI' <span class="hljs-comment">#åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨ï¼Œè®¾ç½®å¤§å°</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>,<span class="hljs-number">5</span>))
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">things</span>=[<span class="hljs-string">'å­¦ä¹ '</span>,<span class="hljs-string">'å¨±ä¹'</span>,<span class="hljs-string">'è¿åŠ¨'</span>,<span class="hljs-string">'ç¡è§‰'</span>,<span class="hljs-string">'å…¶ä»–'</span>]
<span class="hljs-attr">times</span> = [<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">8</span>,<span class="hljs-number">5</span>]
<span class="hljs-attr">colors</span> = [<span class="hljs-string">'#66b3ff'</span>,<span class="hljs-string">'#99ff99'</span>,<span class="hljs-string">'#ffcc99'</span>,<span class="hljs-string">'#ff9999'</span>,<span class="hljs-string">'#ff4499'</span>] <span class="hljs-comment">#é…è‰²</span>
<span class="hljs-attr">explode</span> = [<span class="hljs-number">0.2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<span class="hljs-comment"># è®¾ç½®çªå‡ºå—çš„ä½ç½®</span>
<span class="hljs-comment"># ç»˜åˆ¶çˆ†ç‚¸å¼é¥¼å›¾</span>
plt.pie(times,<span class="hljs-attr">labels</span>=things,autopct=<span class="hljs-string">'%1.1f %%'</span>,startangle=<span class="hljs-number">30</span>,colors=colors,explode=explode,shadow=<span class="hljs-literal">True</span>)<span class="hljs-comment"># startangleè°ƒæ•´åˆå§‹è§’åº¦</span>
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('ä¸€å¤©æ—¶é—´åˆ†å¸ƒ',<span class="hljs-attr">color</span>=<span class="hljs-string">'red'</span>,fontsize=<span class="hljs-number">20</span>)
<span class="hljs-comment"># è‡ªåŠ¨ä¼˜åŒ–æ’ç‰ˆ</span>
plt.tight_layout()
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<h4 data-id="heading-17"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b72deafb14a47e1986e91761c196eaf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=lVehYO%2FS%2Fimn2mQtYIq%2BNKJE56Q%3D" alt="" loading="lazy"/></h4>
<h4 data-id="heading-18">æ•£ç‚¹å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç»˜åˆ¶æ•£ç‚¹å›¾</span>
import random
import matplotlib.pyplot as plt
from matplotlib import rcParams <span class="hljs-comment"># å­—ä½“</span>
<span class="hljs-comment">#rcParams['font.family'] = 'STKAITI' #åæ–‡æ¥·ä½“</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> ='STKAITI' <span class="hljs-comment">#åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨ï¼Œè®¾ç½®å¤§å°</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">10</span>,<span class="hljs-number">8</span>))
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">x</span>=[]
<span class="hljs-attr">y</span>=[]
for i in range (1000):
    <span class="hljs-attr">tmp</span>=random.uniform(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>)
    x.append(tmp)
    y.append(2*tmp+random.gauss(0,2))
<span class="hljs-comment"># ç»˜åˆ¶æ•£ç‚¹å›¾</span>
plt.scatter(x,y,<span class="hljs-attr">color</span>=<span class="hljs-string">'blue'</span>,alpha=<span class="hljs-number">0.5</span>,s=<span class="hljs-number">20</span>,label=<span class="hljs-string">"æ•°æ®"</span>)
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('xå˜é‡ä¸yå˜é‡çš„å…³ç³»',<span class="hljs-attr">color</span>=<span class="hljs-string">'red'</span>,fontsize=<span class="hljs-number">20</span>)
<span class="hljs-comment"># æ·»åŠ åæ ‡è½´æ ‡ç­¾</span>
plt.xlabel('xè‡ªå˜é‡',<span class="hljs-attr">fontsize</span>=<span class="hljs-number">10</span>)
plt.ylabel('yå› å˜é‡',<span class="hljs-attr">fontsize</span>=<span class="hljs-number">10</span>)
<span class="hljs-comment"># æ·»åŠ å›¾ä¾‹</span>
plt.legend(<span class="hljs-attr">loc</span>=<span class="hljs-string">'upper left'</span>)
<span class="hljs-comment"># æ·»åŠ ç½‘æ ¼çº¿</span>
plt.grid(True,<span class="hljs-attr">alpha</span>=<span class="hljs-number">0.1</span>,color=<span class="hljs-string">'blue'</span>,linestyle=<span class="hljs-string">'--'</span>) <span class="hljs-comment"># '-':å®çº¿ ï¼›'--'ï¼šè™šçº¿</span>
<span class="hljs-comment"># plt.grid(axis='x')</span>
<span class="hljs-comment"># è®¾ç½®åˆ»åº¦å­—ä½“å¤§å°</span>
plt.xticks(<span class="hljs-attr">rotation</span>=<span class="hljs-number">20</span>,fontsize=<span class="hljs-number">12</span>)
plt.yticks(<span class="hljs-attr">rotation</span>=<span class="hljs-number">0</span>,fontsize=<span class="hljs-number">12</span>)
<span class="hljs-comment"># è®¾ç½®yè½´çš„èŒƒå›´</span>
plt.ylim(0,30)
plt.plot(<span class="hljs-section">[0,10]</span>,<span class="hljs-section">[0,20]</span>,<span class="hljs-attr">color</span>=<span class="hljs-string">'orange'</span>,linewidth=<span class="hljs-number">3</span>,linestyle=<span class="hljs-string">'--'</span>)
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/78de9218511548dfa886c1935c8d1aa4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=Z035P5k1RdtAyXAis4Zwk2wPhiU%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-19">ç®±çº¿å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç»˜åˆ¶ç®±çº¿å›¾</span>
import matplotlib.pyplot as plt
from matplotlib import rcParams <span class="hljs-comment"># å­—ä½“</span>
<span class="hljs-comment">#rcParams['font.family'] = 'STKAITI' #åæ–‡æ¥·ä½“</span>
rcParams<span class="hljs-section">['font.sans-serif']</span> ='STKAITI' <span class="hljs-comment">#åæ–‡æ¥·ä½“</span>
<span class="hljs-comment"># åˆ›å»ºå›¾è¡¨ï¼Œè®¾ç½®å¤§å°</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">8</span>,<span class="hljs-number">6</span>))
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">data</span> ={
    'è¯­æ–‡':<span class="hljs-section">[82,85,88,70,90,76,84, 83,95]</span>,
    'æ•°å­¦':<span class="hljs-section">[75,80,79,93,88,82,87,89,92]</span>,
    'è‹±è¯­':<span class="hljs-section">[70,72,68,65,78,80,85,90,95]</span>
}
<span class="hljs-comment"># ç»˜åˆ¶æ•£ç‚¹å›¾</span>
plt.boxplot(data.values(),<span class="hljs-attr">tick_labels</span>=data.keys())
<span class="hljs-comment"># æ·»åŠ æ ‡é¢˜</span>
plt.title('å„ç§‘æˆç»©åˆ†å¸ƒ(ç®±çº¿å›¾)',<span class="hljs-attr">color</span>=<span class="hljs-string">'red'</span>,fontsize=<span class="hljs-number">20</span>)
<span class="hljs-comment"># æ·»åŠ åæ ‡è½´æ ‡ç­¾</span>
plt.ylabel('åˆ†æ•°',<span class="hljs-attr">fontsize</span>=<span class="hljs-number">10</span>)
<span class="hljs-comment"># æ·»åŠ ç½‘æ ¼çº¿</span>
plt.grid(True,<span class="hljs-attr">alpha</span>=<span class="hljs-number">0.1</span>,color=<span class="hljs-string">'blue'</span>,linestyle=<span class="hljs-string">'--'</span>) <span class="hljs-comment"># '-':å®çº¿ ï¼›'--'ï¼šè™šçº¿</span>
<span class="hljs-comment"># plt.grid(axis='x')</span>
<span class="hljs-comment"># æ˜¾ç¤ºå›¾è¡¨</span>
plt.show()
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4113bee7cc2f42409992483585616d62~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=0wYGyz88Rvj1LYvN7jdNSibUR3M%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-20">å¤šä¸ªå›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¤šä¸ªå›¾çš„ç»˜åˆ¶æ–¹æ³•</span>
import matplotlib.pyplot as plt
<span class="hljs-comment"># è¦ç»˜å›¾çš„æ•°æ®</span>
<span class="hljs-attr">month</span> = [<span class="hljs-string">'1'</span>, <span class="hljs-string">'2'</span> , <span class="hljs-string">'3'</span> , <span class="hljs-string">'4'</span> ]
<span class="hljs-attr">sales</span> = [<span class="hljs-number">100</span>,<span class="hljs-number">150</span>, <span class="hljs-number">80</span>, <span class="hljs-number">130</span>]
<span class="hljs-attr">f1</span> = plt.subplot(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)<span class="hljs-comment"># ç”Ÿæˆä¸€ä¸ªå­å›¾ï¼Œè¡Œ åˆ— ç´¢å¼•ï¼ˆé€—å·å¯çœç•¥ï¼‰</span>
f1.plot(month,sales)
<span class="hljs-attr">f2</span>= plt.subplot(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)
f2.bar(month,sales)
<span class="hljs-attr">f3</span>= plt.subplot(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>)
f3.scatter(month,sales)
<span class="hljs-attr">f4</span>= plt.subplot(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>)
f4.barh(month,sales)
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9bccc89c073425c88e8b423ab6e91af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB6aOe5LiA5Lya5YS_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770130071&amp;x-signature=eturYDPPCCnL5UKVM9amHDhL2pc%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-21">ï¼ˆäºŒï¼‰ seaborn</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-comment"># è®¾ç½®ä¸­æ–‡å­—ä½“ï¼ˆå¯é€‰ï¼Œè‹±æ–‡ç¯å¢ƒä¸‹å¯æ³¨é‡Šæ‰ï¼‰</span>
plt.rcParams[<span class="hljs-string">"font.sans-serif"</span>] = [<span class="hljs-string">"STKAITI"</span>]
<span class="hljs-comment"># åŸå§‹æ•°æ®</span>
data = {
    <span class="hljs-string">'Physics'</span>:   [<span class="hljs-number">78</span>, <span class="hljs-number">85</span>, <span class="hljs-number">92</span>, <span class="hljs-number">68</span>, <span class="hljs-number">88</span>, <span class="hljs-number">80</span>, <span class="hljs-number">94</span>, <span class="hljs-number">73</span>, <span class="hljs-number">87</span>],
    <span class="hljs-string">'Chemistry'</span>: [<span class="hljs-number">82</span>, <span class="hljs-number">76</span>, <span class="hljs-number">89</span>, <span class="hljs-number">71</span>, <span class="hljs-number">93</span>, <span class="hljs-number">85</span>, <span class="hljs-number">79</span>, <span class="hljs-number">88</span>, <span class="hljs-number">91</span>],
    <span class="hljs-string">'Biology'</span>:   [<span class="hljs-number">85</span>, <span class="hljs-number">90</span>, <span class="hljs-number">77</span>, <span class="hljs-number">72</span>, <span class="hljs-number">84</span>, <span class="hljs-number">89</span>, <span class="hljs-number">93</span>, <span class="hljs-number">76</span>, <span class="hljs-number">82</span>]
}
<span class="hljs-comment"># è½¬ä¸º DataFrame</span>
df = pd.DataFrame(data)
</code></pre>
<h4 data-id="heading-22">ç›´æ–¹å›¾</h4>
<pre><code class="hljs language-bash" lang="bash">sns.histplot(data=<span class="hljs-built_in">df</span>, x=<span class="hljs-string">'Physics'</span>)
plt.title(<span class="hljs-string">'Histogram of Physics Scores'</span>)
plt.show()
</code></pre>
<h4 data-id="heading-23">æ ¸å¯†åº¦ä¼°è®¡å›¾</h4>
<p>æ ¸å¯†åº¦ä¼°è®¡å›¾(KDE,Kernel Density Estimate PLot)æ˜¯ä¸€ç§ç”¨äºæ˜¾ç¤ºæ•°æ®åˆ†å¸ƒçš„ç»Ÿè®¡å›¾è¡¨,å®ƒé€šè¿‡å¹³æ»‘ç›´æ–¹å›¾çš„æ–¹æ³•æ¥ä¼°è®¡æ•°æ®çš„æ¦‚ç‡å¯†åº¦å‡½æ•°,ä½¿å¾—åˆ†å¸ƒå›¾çœ‹èµ·æ¥æ›´åŠ è¿ç»­å’Œå¹³æ»‘ã€‚æ ¸å¯†åº¦ä¼°è®¡æ˜¯ä¸€ç§éå‚æ•°æ–¹æ³•,ç”¨äºä¼°è®¡éšæœºå˜é‡çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ã€‚å…¶åŸºæœ¬æ€æƒ³æ˜¯,å°†æ¯ä¸ªæ•°æ®ç‚¹è§†ä¸ºä¸€ä¸ªâ€œæ ¸â€(é€šå¸¸æ˜¯é«˜æ–¯åˆ†å¸ƒ),ç„¶åå°†è¿™äº›æ ¸çš„è´¡çŒ®ç›¸åŠ ä»¥å½¢æˆå¹³æ»‘çš„å¯†åº¦æ›²çº¿ã€‚ #ç»˜åˆ¶å–™é•¿åº¦çš„æ ¸å¯†åº¦ä¼°è®¡å›¾</p>
<pre><code class="hljs language-ini" lang="ini">sns.kdeplot(<span class="hljs-attr">data</span>=data, x=<span class="hljs-string">"Physics"</span>)
</code></pre>

<pre><code class="hljs language-ini" lang="ini">sns.histplot(<span class="hljs-attr">data</span>=data, x=<span class="hljs-string">"Physics"</span>,kde=<span class="hljs-literal">True</span>)
</code></pre>
<h4 data-id="heading-24">è®¡æ•°å›¾</h4>
<p>è®¡æ•°å›¾ç”¨äºç»˜åˆ¶åˆ†ç±»å˜é‡çš„è®¡æ•°åˆ†å¸ƒå›¾,æ˜¾ç¤ºæ¯ä¸ªç±»åˆ«åœ¨æ•°æ®é›†ä¸­å‡ºç°çš„æ¬¡æ•°,æ˜¯åˆ†æåˆ†ç±»æ•°æ®éå¸¸ç›´è§‚çš„å·¥å…·,å¯ä»¥å¿«é€Ÿäº†è§£ç±»åˆ«çš„åˆ†å¸ƒæƒ…å†µã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å°† Physics åˆ†æ•°è¿›è¡Œåˆ†ç®±å¤„ç†ï¼Œè½¬æ¢ä¸ºåˆ†ç±»å˜é‡</span>
<span class="hljs-attr">bins</span> = [<span class="hljs-number">0</span>, <span class="hljs-number">60</span>, <span class="hljs-number">70</span>, <span class="hljs-number">80</span>, <span class="hljs-number">90</span>, <span class="hljs-number">100</span>] <span class="hljs-comment"># è‡ªå®šä¹‰åˆ†åŒº</span>
<span class="hljs-attr">labels</span> = [<span class="hljs-string">'0-60'</span>, <span class="hljs-string">'60-70'</span>, <span class="hljs-string">'70-80'</span>, <span class="hljs-string">'80-90'</span>, <span class="hljs-string">'90-100'</span>]
df<span class="hljs-section">['Physics_Bins']</span> = pd.cut(df<span class="hljs-section">['Physics']</span>, <span class="hljs-attr">bins</span>=bins, labels=labels, right=<span class="hljs-literal">False</span>)
<span class="hljs-comment">#ç»˜åˆ¶ä¸åŒæ•°é‡çš„è®¡æ•°å›¾</span>
sns.countplot(<span class="hljs-attr">data</span>=df, x=<span class="hljs-string">"Physics_Bins"</span>)
</code></pre>
<h4 data-id="heading-25">æ•£ç‚¹å›¾</h4>
<pre><code class="hljs language-bash" lang="bash">data_long = {
    <span class="hljs-string">'subject'</span>: [<span class="hljs-string">'Physics'</span>, <span class="hljs-string">'Chemistry'</span>, <span class="hljs-string">'Biology'</span>] * 9,
    <span class="hljs-string">'score'</span>: [
        78, 82, 85,
        85, 76, 90,
        92, 89, 77,
        68, 71, 72,
        88, 93, 84,
        80, 85, 89,
        94, 79, 93,
        73, 88, 76,
        87, 91, 82
    ],
    <span class="hljs-string">'student_group'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>,
                      <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>,
                      <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>,
                      <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>,
                      <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>,
                      <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>,
                      <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>,
                      <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'B'</span>,
                      <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'A'</span>]
}

<span class="hljs-built_in">df</span> = pd.DataFrame(data_long)
<span class="hljs-comment">#ç»˜åˆ¶æ¨ªè½´ä¸ºç§‘ç›®,çºµè½´ä¸ºæˆç»©çš„æ•£ç‚¹å›¾ã€‚å¯é€šè¿‡hueå‚æ•°è®¾ç½®ä¸åŒç»„åˆ«è¿›è¡Œå¯¹æ¯”ã€‚</span>
sns.scatterplot(data=<span class="hljs-built_in">df</span>, x=<span class="hljs-string">"subject"</span>, y=<span class="hljs-string">"score"</span>, hue=<span class="hljs-string">"student_group"</span>)
</code></pre>
<h4 data-id="heading-26">èœ‚çªå›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#é€šè¿‡jointplot()å‡½æ•°,è®¾ç½®kind="hex"æ¥ç»˜åˆ¶èœ‚çªå›¾ã€‚</span>
sns.jointplot (<span class="hljs-attr">data</span>=data, x=<span class="hljs-string">"Physics"</span>, y=<span class="hljs-string">"Chemistry"</span>, kind=<span class="hljs-string">"hex"</span>)
</code></pre>
<h4 data-id="heading-27">äºŒç»´æ ¸å¯†åº¦ä¼°è®¡å›¾</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#é€šè¿‡kdeplot()å‡½æ•°,åŒæ—¶è®¾ç½®xå‚æ•°å’Œyå‚æ•°æ¥ç»˜åˆ¶äºŒç»´æ ¸å¯†åº¦ä¼°è®¡å›¾ã€‚</span>
sns.kdeplot(<span class="hljs-attr">data</span>=penguins, x=<span class="hljs-string">"body_mass_g"</span>, y=<span class="hljs-string">"flipper_length_mm"</span>)
<span class="hljs-comment">#é€šè¿‡fill=Trueè®¾ç½®ä¸ºå¡«å……,é€šè¿‡cbar=Trueè®¾ç½®æ˜¾ç¤ºé¢œè‰²ç¤ºæ„æ¡ã€‚</span>
sns.kdeplot(<span class="hljs-attr">data</span>=penguins, x=<span class="hljs-string">"body_mass_g"</span>, y=<span class="hljs-string">"flipper_length_mm"</span>,fill=<span class="hljs-literal">True</span>, cbar=<span class="hljs-literal">True</span>)
</code></pre>
<h4 data-id="heading-28">æ¡å½¢å›¾</h4>
<pre><code class="hljs language-ini" lang="ini">sns.barplot(<span class="hljs-attr">data</span>=penguins, x=<span class="hljs-string">"species"</span>, y=<span class="hljs-string">"bill_length_mm"</span>,estimator=<span class="hljs-string">"mean"</span>, errorbar=None)
</code></pre>
<h4 data-id="heading-29">ç®±çº¿å›¾</h4>
<pre><code class="hljs language-ini" lang="ini">sns.boxplot(<span class="hljs-attr">data</span>=penguins, x=<span class="hljs-string">"species"</span>, y=<span class="hljs-string">"bill_length_mm"</span>)
</code></pre>
<h4 data-id="heading-30">å°æç´å›¾</h4>
<p>å°æç´å›¾(Violin Plot)æ˜¯ä¸€ç§ç»“åˆäº†ç®±çº¿å›¾å’Œæ ¸å¯†åº¦ä¼°è®¡å›¾(KDE)çš„å¯è§†åŒ–å›¾è¡¨,ç”¨äºå±•ç¤ºæ•°æ®çš„åˆ†å¸ƒæƒ…å†µã€é›†ä¸­è¶‹åŠ¿ã€æ•£å¸ƒæƒ…å†µä»¥åŠå¼‚å¸¸å€¼ã€‚å°æç´å›¾ä¸ä»…å¯ä»¥æ˜¾ç¤ºæ•°æ®çš„åŸºæœ¬ç»Ÿè®¡é‡(å¦‚ä¸­ä½æ•°å’Œå››åˆ†ä½æ•°),è¿˜å¯ä»¥å±•ç¤ºæ•°æ®çš„æ¦‚ç‡å¯†åº¦,æä¾›æ¯”ç®±çº¿å›¾æ›´ä¸°å¯Œçš„ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">sns.violinplot(<span class="hljs-attr">data</span>=penguins, x=<span class="hljs-string">"species"</span>, y=<span class="hljs-string">"bill_length_mm"</span>)
</code></pre>
<h4 data-id="heading-31">æˆå¯¹å…³ç³»å›¾</h4>
<p>æˆå¯¹å…³ç³»å›¾æ˜¯ä¸€ç§ç”¨äºæ˜¾ç¤ºå¤šä¸ªå˜é‡ä¹‹é—´å…³ç³»çš„å¯è§†åŒ–å·¥å…·ã€‚å®ƒå¯ä»¥å±•ç¤ºå„ä¸ªå˜é‡ä¹‹é—´çš„æˆå¯¹å…³ç³»,å¹¶ä¸”é€šè¿‡ä¸åŒçš„å›¾è¡¨å½¢å¼å¸®åŠ©æˆ‘ä»¬ç†è§£æ•°æ®ä¸­å„ä¸ªå˜é‡ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚å¯¹è§’çº¿ä¸Šçš„å›¾é€šå¸¸æ˜¾ç¤ºæ¯ä¸ªå˜é‡çš„åˆ†å¸ƒ(å¦‚ç›´æ–¹å›¾æˆ–æ ¸å¯†åº¦ä¼°è®¡å›¾),å¸®åŠ©è§‚å¯Ÿæ¯ä¸ªå˜é‡çš„å•å˜é‡ç‰¹æ€§ã€‚å…¶ä»–ä½ç½®å±•ç¤ºæ‰€æœ‰å˜é‡çš„ä¸¤ä¸¤å…³ç³»,ç”¨æ•£ç‚¹å›¾è¡¨ç¤ºã€‚</p>
<pre><code class="hljs language-ini" lang="ini">sns.pairplot(<span class="hljs-attr">data</span>=penguins, hue=<span class="hljs-string">"species"</span>)
</code></pre>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Autowired å’Œ Resource çš„åŒºåˆ«]]></title>    <link>https://juejin.cn/post/7599868109085524010</link>    <guid>https://juejin.cn/post/7599868109085524010</guid>    <pubDate>2026-01-27T15:06:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599868109085524010" data-draft-id="7599868109085507626" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Autowired å’Œ Resource çš„åŒºåˆ«"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-27T15:06:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å’ªåº“å’ªåº“å’ª"/> <meta itemprop="url" content="https://juejin.cn/user/3725578141445959"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Autowired å’Œ Resource çš„åŒºåˆ«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3725578141445959/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å’ªåº“å’ªåº“å’ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T15:06:27.000Z" title="Tue Jan 27 2026 15:06:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong><code>@Autowired</code>ï¼šæ¥è‡ªSpring ï¼Œé»˜è®¤æŒ‰â€œç±»å‹â€æ³¨å…¥</strong><br/>
<strong><code>@Resource</code>ï¼šJava æ ‡å‡†æ³¨è§£ï¼Œé»˜è®¤æŒ‰â€œåå­—â€æ³¨å…¥</strong></p>
<h2 data-id="heading-0">Autowired-&gt; æŒ‰ç±»å‹</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> UserService userService;
</code></pre>
<p>Spring ä¼šæ‰¾ï¼šå®¹å™¨é‡Œ <strong>ç±»å‹æ˜¯ <code>UserService</code> çš„ Bean</strong></p>
<p>å¦‚æœæœ‰å¤šä¸ªåŒç±»å‹çš„Beanå°±ä¼šæŠ¥é”™ï¼Œè¿™æ—¶å¿…é¡»é…åˆï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Qualifier("userServiceImpl1")</span>
<span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> UserService userService;
</code></pre>
<h2 data-id="heading-1">@Resource -&gt; æŒ‰åç§°</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Resource</span>
<span class="hljs-keyword">private</span> UserService userService;
</code></pre>
<p>Spring ä¼šï¼š</p>
<ol>
<li>å…ˆæŒ‰ <strong>å˜é‡å <code>userService</code></strong> æ‰¾ Bean</li>
<li>æ‰¾ä¸åˆ° â†’ å†æŒ‰ <strong>ç±»å‹</strong> æ‰¾</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»£ç çµå¼‚äº‹ä»¶ï¼šä¸ºä»€ä¹ˆç”¨ get() èƒ½å–åˆ°å€¼ï¼Œæ¢æˆ getProperty() å°±å˜æˆäº† nullï¼Ÿ]]></title>    <link>https://juejin.cn/post/7599835610406928430</link>    <guid>https://juejin.cn/post/7599835610406928430</guid>    <pubDate>2026-01-27T15:34:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599835610406928430" data-draft-id="7599835610406912046" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»£ç çµå¼‚äº‹ä»¶ï¼šä¸ºä»€ä¹ˆç”¨ get() èƒ½å–åˆ°å€¼ï¼Œæ¢æˆ getProperty() å°±å˜æˆäº† nullï¼Ÿ"/> <meta itemprop="keywords" content="é¢è¯•,Java"/> <meta itemprop="datePublished" content="2026-01-27T15:34:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Re_zero"/> <meta itemprop="url" content="https://juejin.cn/user/2965821818672144"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»£ç çµå¼‚äº‹ä»¶ï¼šä¸ºä»€ä¹ˆç”¨ get() èƒ½å–åˆ°å€¼ï¼Œæ¢æˆ getProperty() å°±å˜æˆäº† nullï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2965821818672144/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Re_zero
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T15:34:34.000Z" title="Tue Jan 27 2026 15:34:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>#Java #æºç åˆ†æ #é¿å‘æŒ‡å— #é¢è¯•é¢˜</p>
<blockquote>
<p><strong>æ‘˜è¦</strong>ï¼š</p>
<p>æ˜æ˜å‘ <code>Properties</code> ä¸­å­˜å…¥äº†æ•°å€¼ï¼Œç”¨ <code>get()</code> æ¢å¯»æ—¶å®ƒå°šåœ¨ï¼Œæ¢ä½œ <code>getProperty()</code> å´å‡­ç©ºæ¶ˆå¤±ï¼Œåªè¿”è¿˜ä¸€ä¸ªå†·å†°å†°çš„ <code>null</code>ã€‚ è¿™å¹¶é JDK çš„ Bugï¼Œä¹Ÿä¸æ˜¯ä»€ä¹ˆç„å­¦ã€‚æœ¬æ–‡å°†ä»¥æ­¤ä¸ºå¼•ï¼Œæ‹¨å¼€ <code>java.util.Properties</code> çš„æºç è¿·é›¾ï¼Œä¸€æ¢è¿™æ®µå› â€œç»§æ‰¿æ»¥ç”¨â€è€Œå°˜å°å·²ä¹…çš„è®¾è®¡å…¬æ¡ˆã€‚</p>
</blockquote>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ <strong>Re-Zero</strong>ã€‚</p>
<p>ä»Šå¤©åœ¨ Code Reviewï¼Œæˆ‘è§åˆ°äº†ä¸€æ®µè¶³ä»¥å†™å…¥ã€ŠJava è¿·æƒ‘è¡Œä¸ºå¤§èµã€‹çš„ä»£ç ï¼šæŸä½å…„å¼Ÿå›¾çœäº‹ï¼Œç›´æ¥ç”¨ <code>put</code> æ–¹æ³•æŠŠæ•°å­—å¾€ <code>Properties</code> å¯¹è±¡é‡Œå¡ï¼Œå–çš„æ—¶å€™å´é­é‡â€œå·¦å³æ‰‹äº’æâ€â€”â€”ä¸€åªæ‰‹èƒ½æ‹¿åˆ°ï¼Œå¦ä¸€åªæ‰‹å´æ‘¸äº†ä¸ªç©ºã€‚</p>
<p>å’±ä»¬æ¥è¿˜åŸä¸€ä¸‹è¿™ä¸ªè®©æ–°æ‰‹æ‘¸ä¸ç€å¤´è„‘çš„â€œçµå¼‚ç°åœºâ€ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ æ¡ˆå‘ç°åœºï¼šä¸€æ¬¡æŠ•å¸ï¼Œä¸¤ç§äººç”Ÿ</h2>
<p>æˆ‘ä»¬å†™ä¸€æ®µæœ€ç®€å•çš„æµ‹è¯•ä»£ç ï¼š</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-type">Properties</span> <span class="hljs-variable">props</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();

<span class="hljs-comment">// 1. æ³¨æ„ï¼šä¸ºäº†çœäº‹ï¼Œè¿™é‡Œç›´æ¥å­˜äº†ä¸ªæ•´æ•° 88</span>
<span class="hljs-comment">// è¿™é‡Œçš„ 88 æ˜¯ Integer ç±»å‹ï¼Œä¸æ˜¯ String</span>
props.put(<span class="hljs-string">"timeout"</span>, <span class="hljs-number">88</span>); 

<span class="hljs-comment">// 2. ä½¿ç”¨ Map åŸç”Ÿçš„ get() æ–¹æ³•</span>
System.out.println(<span class="hljs-string">"get: "</span> + props.get(<span class="hljs-string">"timeout"</span>)); 

<span class="hljs-comment">// 3. ä½¿ç”¨ Properties ä¸“å±çš„ getProperty() æ–¹æ³•</span>
System.out.println(<span class="hljs-string">"getProperty: "</span> + props.getProperty(<span class="hljs-string">"timeout"</span>));
</code></pre>
<p>æŒ‰ç…§æ­£å¸¸é€»è¾‘ï¼Œè¿™å°±å¥½æ¯”ä½ å¾€é’±åŒ…é‡Œå¡äº†ä¸€å¼ é’±ï¼Œç”¨å·¦æ‰‹æå‡ºæ¥æ˜¯é’±ï¼Œç”¨å³æ‰‹æå‡ºæ¥åº”è¯¥æ˜¯ç©ºæ°”å—ï¼Ÿæ˜¾ç„¶ä¸åˆç†ã€‚</p>
<p>ä½† Java ååå°±ç»™ä½ å˜äº†ä¸ªé­”æœ¯ï¼Œè¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-Plaintext" lang="Plaintext">get: 88
getProperty: null   &lt;-- è§é¬¼äº†?!
</code></pre>
<p>æ˜æ˜æ•°æ®å°±åœ¨é‡Œé¢ï¼Œç”¨ <code>get</code> éƒ½èƒ½æ‹¿åˆ°ï¼Œå‡­ä»€ä¹ˆ <code>getProperty</code> å°±è§†è€Œä¸è§ï¼Ÿéš¾é“å®ƒè¿˜æ­§è§†æ•´æ•°ï¼Ÿ</p>
<hr/>
<h2 data-id="heading-1">äºŒã€ æºç è§£å‰–ï¼šå¯»æ‰¾å¤±è½çš„çœŸç›¸</h2>
<p>ä¸ºäº†ææ¸…æ¥šåŸå› ï¼Œæˆ‘ä»¬ç›´æ¥ç‚¹å¼€ <code>java.util.Properties</code> çš„æºç ï¼Œçœ‹çœ‹ <code>getProperty</code> åˆ°åº•èƒŒç€æˆ‘ä»¬å¹²äº†ä»€ä¹ˆã€‚</p>
<p>ä»£ç éå¸¸çŸ­ï¼Œä½†æ¯ä¸€è¡Œéƒ½è—ç€å¿ƒçœ¼ï¼š</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getProperty</span><span class="hljs-params">(String key)</span> {
    <span class="hljs-comment">// 1. å…ˆè°ƒç”¨çˆ¶ç±» (Hashtable) çš„ get æ–¹æ³•ï¼Œæ‹¿åˆ° value</span>
    <span class="hljs-type">Object</span> <span class="hljs-variable">oval</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">super</span>.get(key);
    
    <span class="hljs-comment">// 2. å…³é”®åˆ¤å†³ï¼</span>
    <span class="hljs-comment">// æ£€æŸ¥æ‹¿åˆ°çš„ value æ˜¯ä¸æ˜¯ String ç±»å‹</span>
    <span class="hljs-comment">// å¦‚æœæ˜¯ Stringï¼Œå¼ºè½¬ï¼›å¦‚æœä¸æ˜¯ï¼Œsval ç›´æ¥ç½®ä¸º null</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">sval</span> <span class="hljs-operator">=</span> (oval <span class="hljs-keyword">instanceof</span> String) ? (String)oval : <span class="hljs-literal">null</span>;
    
    <span class="hljs-comment">// 3. å…œåº•é€»è¾‘ï¼šå¦‚æœæ˜¯ nullï¼Œä¸”å­˜åœ¨é»˜è®¤é…ç½®é›† (defaults)ï¼Œåˆ™å»é»˜è®¤é›†é‡Œæ‰¾</span>
    <span class="hljs-keyword">return</span> ((sval == <span class="hljs-literal">null</span>) &amp;&amp; (defaults != <span class="hljs-literal">null</span>)) ? defaults.getProperty(key) : sval;
}
</code></pre>
<p><strong>ç ´æ¡ˆäº†ï¼Œå‡¶æ‰‹å°±æ˜¯è¿™è¡Œä»£ç ï¼š</strong></p>
<p><code>String sval = (oval instanceof String) ? (String)oval : null;</code></p>
<p><code>getProperty</code> æ–¹æ³•æ˜¯ä¸€ä¸ªæœ‰ç€ä¸¥é‡<strong>ç±»å‹æ´ç™–</strong>çš„æ–¹æ³•ï¼š</p>
<ol>
<li>
<p>å®ƒå¼ºåˆ¶è¦æ±‚ï¼š<strong>Key å’Œ Value å¿…é¡»éƒ½æ˜¯ <code>String</code> ç±»å‹</strong>ã€‚</p>
</li>
<li>
<p>åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œå­˜å…¥çš„æ˜¯ <code>Integer</code> ç±»å‹çš„ <code>88</code>ã€‚</p>
</li>
<li>
<p><code>oval instanceof String</code> åˆ¤å®šä¸ºå‡ã€‚</p>
</li>
<li>
<p>æ‰€ä»¥å˜é‡ <code>sval</code> è¢«æ— æƒ…åœ°èµ‹å€¼ä¸º <code>null</code>ã€‚</p>
</li>
</ol>
<p>é‚£ä¸ºä»€ä¹ˆæ™®é€šçš„ <code>get()</code> æ–¹æ³•èƒ½æ‹¿åˆ°å‘¢ï¼Ÿ</p>
<p>å› ä¸ºå®ƒæ˜¯ä¸ªâ€œè€å¥½äººâ€ã€‚<code>Properties</code> ç»§æ‰¿è‡ª <code>Hashtable</code>ï¼Œ<code>get()</code> æ–¹æ³•æ˜¯çˆ¶ç±»çš„ï¼Œç­¾åæ˜¯ <code>Object get(Object key)</code>ã€‚åœ¨å®ƒçœ¼é‡Œï¼Œä¼—ç”Ÿå¹³ç­‰ï¼Œä¸ç®¡ä½ å­˜çš„æ˜¯å­—ç¬¦ä¸²è¿˜æ˜¯æ•´æ•°ï¼Œå®ƒéƒ½åŸæ ·ç»™ä½ åå‡ºæ¥ã€‚</p>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€ ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªå‘ï¼Ÿ</h2>
<p>ä½ å¯èƒ½ä¼šé—®ï¼šæ—¢ç„¶ <strong><code>Properties</code> æ˜¯ä¸“é—¨ç”¨æ¥å¤„ç†å­—ç¬¦ä¸²é…ç½®æ–‡ä»¶</strong>çš„ï¼Œä¸ºä»€ä¹ˆ Java è¿˜è¦å…è®¸æˆ‘ä»¬å¾€é‡Œé¢ <code>put</code> æ•´æ•°å‘¢ï¼Ÿç›´æ¥æŠ¥é”™ä¸å¥½å—ï¼Ÿ</p>
<p>è¿™å°±å¾—èŠèŠ Java æ—©æœŸçš„â€œé»‘å†å²â€äº†ã€‚</p>
<p><code>Properties</code> ç±»å‡ºç°å¾—éå¸¸æ—©ï¼ˆJDK 1.0ï¼‰ã€‚åœ¨é‚£ä¸ªä¸Šå¤æ—¶ä»£ï¼ŒJava çš„è®¾è®¡è€…ä¸ºäº†å°‘å†™å‡ è¡Œä»£ç ï¼Œå¼ºè¡Œè®© <code>Properties</code> <strong>ç»§æ‰¿</strong> äº† <code>Hashtable</code>ã€‚</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Properties</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Hashtable</span>&lt;Object,Object&gt; { ... }
</code></pre>
<p>è¿™å°±å¥½æ¯”è®©ä¸€ä¸ªæ–‡å¼±ä¹¦ç”Ÿï¼ˆPropertiesï¼‰ï¼Œç›´æ¥ç»§æ‰¿äº†å± å¤«ï¼ˆHashtableï¼‰çš„æŠ€èƒ½æ ‘ã€‚è™½ç„¶ä¹¦ç”Ÿçš„æœ¬èŒå·¥ä½œæ˜¯å†™å­—ï¼Œä½†ä»–ç¡®å®ä»ä»–çˆ¹é‚£é‡Œç»§æ‰¿äº†â€œæ€çŒªâ€çš„æœ¬äº‹â€”â€”è™½ç„¶èƒ½ç”¨ï¼Œä½†æ€ä¹ˆçœ‹æ€ä¹ˆåˆ«æ‰­ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„â€œ<strong>ç»„åˆä¼˜äºç»§æ‰¿</strong>â€åŸåˆ™çš„åé¢æ•™æã€‚å¦‚æœå½“æ—¶é‡‡ç”¨ç»„åˆæ¨¡å¼ï¼ˆProperties å†…éƒ¨æŒæœ‰ä¸€ä¸ª Mapï¼‰ï¼Œå°±ä¸ä¼šæš´éœ² <code>put</code> æ–¹æ³•ç»™ç”¨æˆ·ï¼Œä¹Ÿå°±ä¸ä¼šæœ‰ä»Šå¤©è¿™ä¸ªå‘äº†ã€‚</p>
<hr/>
<h2 data-id="heading-3">å››ã€ æœ€ä½³å®è·µ â€”â€” Properties æŒ‡å—</h2>
<p>æ—¢ç„¶çŸ¥é“å‘åœ¨å“ªï¼Œæ€ä¹ˆé¿å‘å°±å¾ˆç®€å•äº†ã€‚è¯·ä¸¥æ ¼éµå®ˆä»¥ä¸‹å¼€å‘è§„èŒƒï¼š</p>
<h3 data-id="heading-4">1. æ‹‰é»‘ put å’Œ get</h3>
<p>åœ¨æ“ä½œ <code>Properties</code> å¯¹è±¡æ—¶ï¼Œå°½é‡ä¸è¦ä½¿ç”¨è¿™ä¸¤ä¸ªä»çˆ¶ç±»ç»§æ‰¿æ¥çš„æ–¹æ³•ã€‚å®ƒä»¬æ˜¯ç»™ Hashtable ç”¨çš„ï¼Œä¸æ˜¯ç»™ä½ ç”¨çš„ã€‚</p>
<h3 data-id="heading-5">2. é”æ­» setProperty å’Œ getProperty</h3>
<p>JDK ä¸“é—¨æä¾›äº†ç±»å‹å®‰å…¨çš„æ–¹æ³•ï¼Œè¯·ä¸€å®šè¦ç”¨å®ƒä»¬ï¼š</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-comment">// æ­£ç¡®å§¿åŠ¿</span>
props.setProperty(<span class="hljs-string">"timeout"</span>, <span class="hljs-string">"88"</span>); <span class="hljs-comment">// ç¼–è¯‘å™¨ä¼šå¼ºåˆ¶è¦æ±‚ä½ ä¼ å…¥ String</span>

<span class="hljs-comment">// æ­£ç¡®è¯»å–</span>
<span class="hljs-type">String</span> <span class="hljs-variable">val</span> <span class="hljs-operator">=</span> props.getProperty(<span class="hljs-string">"timeout"</span>); <span class="hljs-comment">// æ­¤æ—¶èƒ½æ­£ç¡®è·å– "88"</span>
</code></pre>
<h3 data-id="heading-6">3. å·§ç”¨ defaultsï¼Œè®©é»˜è®¤å€¼æˆä¸ºä½ çš„ç¥åŠ©æ”»</h3>
<p>æºç æœ€åä¸€è¡Œå…¶å®è¿˜è—äº†ä¸ªå½©è›‹ï¼š</p>
<p><code>((sval == null) &amp;&amp; (defaults != null)) ? defaults.getProperty(key) : sval;</code></p>
<p>è¿™å…è®¸æˆ‘ä»¬æ„å»ºä¸€ä¸ªâ€œ<strong>é…ç½®å±‚çº§é“¾â€</strong>ã€‚æ¯”å¦‚ä½ å¯ä»¥æœ‰ä¸€ä¸ª <code>defaultProps</code> å­˜æ”¾é»˜è®¤é…ç½®ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª <code>appProps</code> è¦†ç›–å®ƒã€‚å½“ä¸»é…ç½®é‡Œæ²¡å€¼æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨å»é»˜è®¤é…ç½®é‡Œæ‰¾ï¼Œéå¸¸æ–¹ä¾¿ã€‚</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-type">Properties</span> <span class="hljs-variable">defaultProps</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();
defaultProps.setProperty(<span class="hljs-string">"theme"</span>, <span class="hljs-string">"light"</span>); <span class="hljs-comment">// é»˜è®¤æµ…è‰²ä¸»é¢˜</span>

<span class="hljs-comment">// å°† defaultProps è®¾ä¸º appProps çš„â€œçˆ¶çº§â€</span>
<span class="hljs-type">Properties</span> <span class="hljs-variable">appProps</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>(defaultProps); 

<span class="hljs-comment">// appProps é‡Œæ²¡é… themeï¼ŒgetProperty ä¼šè‡ªåŠ¨å» defaultProps é‡Œæ‰¾</span>
System.out.println(appProps.getProperty(<span class="hljs-string">"theme"</span>)); <span class="hljs-comment">// è¾“å‡º "light"</span>
</code></pre>
<hr/>
<h2 data-id="heading-7">äº”ã€ æ€»ç»“</h2>
<p>ä¸‹æ¬¡å†é‡åˆ° <code>getProperty</code> è¿”å› nullï¼Œå…ˆåˆ«æ€€ç–‘äººç”Ÿï¼Œæ£€æŸ¥ä¸€ä¸‹ï¼š<strong>ä½ æ˜¯ä¸æ˜¯æ‰‹æ»‘ç”¨äº† <code>put</code> å­˜äº†é String ç±»å‹çš„æ•°æ®ï¼Ÿ</strong></p>























<table><thead><tr><th><strong>æ–¹æ³•</strong></th><th><strong>æ¥æº</strong></th><th><strong>ç‰¹ç‚¹</strong></th><th><strong>æ¨èæŒ‡æ•°</strong></th></tr></thead><tbody><tr><td><strong>get()</strong></td><td>Hashtable</td><td>è¿”å› Objectï¼Œæ¥è€…ä¸æ‹’ï¼Œå®¹æ˜“åŸ‹é›·</td><td>ğŸš« ç¦æ­¢ä½¿ç”¨</td></tr><tr><td><strong>getProperty()</strong></td><td>Properties</td><td>åªè¿”å› Stringï¼Œå¸¦é»˜è®¤å€¼æŸ¥æ‰¾ï¼Œç±»å‹å®‰å…¨</td><td>âœ… å¼ºçƒˆæ¨è</td></tr></tbody></table>
<p>æ—¢ç„¶ç”¨äº† <code>Properties</code>ï¼Œå°±è¯·å°Šé‡å®ƒçš„â€œæ´ç™–â€ï¼Œåªå–‚ç»™å®ƒ <code>String</code>ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[NFT è¿›é˜¶å¼€å‘ï¼ERC6551 åœºæ™¯åº”ç”¨ + ç†è®ºä»£ç å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7599634796584140806</link>    <guid>https://juejin.cn/post/7599634796584140806</guid>    <pubDate>2026-01-27T10:38:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599634796584140806" data-draft-id="7599828354515583016" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="NFT è¿›é˜¶å¼€å‘ï¼ERC6551 åœºæ™¯åº”ç”¨ + ç†è®ºä»£ç å…¨è§£æ"/> <meta itemprop="keywords" content="æ™ºèƒ½åˆçº¦,Solidity,web3"/> <meta itemprop="datePublished" content="2026-01-27T10:38:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœ¨è¥¿"/> <meta itemprop="url" content="https://juejin.cn/user/2436173496845549"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            NFT è¿›é˜¶å¼€å‘ï¼ERC6551 åœºæ™¯åº”ç”¨ + ç†è®ºä»£ç å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2436173496845549/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœ¨è¥¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T10:38:42.000Z" title="Tue Jan 27 2026 10:38:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<blockquote>
<p>æœ¬æ–‡å›´ç»• ERC6551 æ ‡å‡†å±•å¼€å…¨é¢æ¢³ç†ä¸å®è·µè½åœ°ï¼Œç†è®ºå±‚é¢ç³»ç»Ÿå‰–æäº†è¯¥æ ‡å‡†çš„æ ¸å¿ƒå®šä¹‰ã€æ ¸å¿ƒèƒ½åŠ›ã€è§£å†³çš„è¡Œä¸šç—›ç‚¹ã€å…¸å‹è¡Œä¸šåº”ç”¨åŠä¼˜åŠ£åŠ¿ï¼›ä»£ç è½åœ°å±‚é¢åˆ™åŸºäº Hardhat V3 å¼€å‘ç¯å¢ƒï¼Œç»“åˆ OpenZeppelin V5 ä¸ Solidity 0.8.24ï¼Œå®Œæ•´å®ç° ERC6551 æ ‡å‡†ä»å¼€å‘ã€æµ‹è¯•åˆ°éƒ¨ç½²çš„å…¨æµç¨‹ã€‚</p>
</blockquote>
<h2 data-id="heading-1">ERC6551æ ‡å‡†ç†è®ºçŸ¥è¯†æ¢³ç†</h2>
<h4 data-id="heading-2">æ¦‚è¿°</h4>
<p>ERC-6551 æ˜¯ä»¥å¤ªåŠä¸Šä¸º NFT è®¾è®¡çš„ â€œä»£å¸ç»‘å®šè´¦æˆ·ï¼ˆTBAï¼‰â€ æ ‡å‡†ï¼Œæ ¸å¿ƒæ˜¯ç»™æ¯ä¸ª ERC-721/ERC-1155 NFT åˆ†é…ç‹¬ç«‹æ™ºèƒ½åˆçº¦è´¦æˆ·ï¼Œè®© NFT èƒ½åƒç”¨æˆ·åœ°å€ä¸€æ ·æŒæœ‰èµ„äº§ã€å‘èµ·äº¤æ˜“å¹¶ç•™å­˜é“¾ä¸Šè®°å½•ï¼Œä¸”æ— éœ€ä¿®æ”¹ç°æœ‰åˆçº¦ä¸åŸºç¡€è®¾æ–½ï¼Œå®Œå…¨å‘åå…¼å®¹Ethereum Improvement Proposals</p>
<hr/>
<h4 data-id="heading-3">ä¸€ã€æ ¸å¿ƒå®šä¹‰</h4>
<p>ERC-6551 ç”± Benny Giang ç­‰äººäº 2023 å¹´æå‡ºï¼Œé€šè¿‡<strong>å•ä¾‹æ³¨å†Œè¡¨</strong>ä¸ºæ¯ä¸ª NFT ç”Ÿæˆå”¯ä¸€ã€ç¡®å®šæ€§çš„æ™ºèƒ½åˆçº¦è´¦æˆ·åœ°å€ï¼Œè´¦æˆ·æ°¸ä¹…ç»‘å®š NFTï¼Œæ§åˆ¶æƒéš NFT æ‰€æœ‰æƒè½¬ç§»è€Œè½¬ç§»Ethereum Improvement Proposalsã€‚</p>
<ul>
<li>
<p><strong>æ ¸å¿ƒç»„ä»¶</strong>ï¼š</p>
<ul>
<li>æ³¨å†Œè¡¨ï¼ˆRegistryï¼‰ï¼šè´Ÿè´£éƒ¨ç½² / å¼•ç”¨ TBAï¼Œç¡®ä¿åœ°å€ç¡®å®šæ€§ï¼ˆç”±é“¾ ID+NFT åˆçº¦åœ°å€ + Token ID è®¡ç®—å¾—å‡ºï¼‰Ethereum Improvement Proposalsã€‚</li>
<li>è´¦æˆ·å®ç°ï¼ˆAccount Implementationï¼‰ï¼šTBA çš„æœ€å°åŒ–æ™ºèƒ½åˆçº¦ï¼Œæ”¯æŒç­¾åã€äº¤æ˜“æ‰§è¡Œç­‰åŸºç¡€é’±åŒ…åŠŸèƒ½ã€‚</li>
<li>ç»‘å®šå…³ç³»ï¼šTBA ä¸ NFT ä¸€ä¸€å¯¹åº”ï¼ŒNFT æ‰€æœ‰è€…å³ TBA çš„å”¯ä¸€æ§åˆ¶äººã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h4 data-id="heading-4">äºŒã€æ ¸å¿ƒèƒ½åŠ›ï¼ˆèƒ½åšä»€ä¹ˆï¼‰</h4>





























<table><thead><tr><th>èƒ½åŠ›</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>èµ„äº§æŒæœ‰</td><td>TBA å¯å­˜å‚¨ ERC-20/ERC-721/ERC-1155 ç­‰ï¼Œå½¢æˆ â€œNFT å¥—å¨ƒâ€ï¼ˆå¦‚è§’è‰² NFT æŒæœ‰è£…å¤‡ NFTï¼‰</td></tr><tr><td>é“¾ä¸Šäº¤äº’</td><td>é€šè¿‡æ™ºèƒ½è´¦æˆ·ç­¾åä¸ DeFiã€DAOã€æ¸¸æˆç­‰ dApp ç›´æ¥äº¤äº’ï¼Œæ‰§è¡Œå€Ÿè´·ã€æŠ•ç¥¨ã€äº¤æ˜“ç­‰æ“ä½œ</td></tr><tr><td>ç‹¬ç«‹èº«ä»½</td><td>æ‹¥æœ‰ç‹¬ç«‹åœ°å€ä¸äº¤æ˜“å†å²ï¼Œä½œä¸ºé“¾ä¸Šèº«ä»½ï¼ˆå¦‚ä¼šå‘˜å‡­è¯ã€æ¸¸æˆè§’è‰²ï¼‰ï¼Œè®°å½•å®Œæ•´è¡Œä¸ºè½¨è¿¹</td></tr><tr><td>æ‰€æœ‰æƒè”åŠ¨</td><td>NFT è½¬ç§»æ—¶ï¼ŒTBA æ§åˆ¶æƒä¸èµ„äº§éšä¹‹ä¸€å¹¶è½¬ç§»ï¼Œæ— éœ€é¢å¤–æ“ä½œ</td></tr><tr><td>è·¨é“¾å…¼å®¹</td><td>æ”¯æŒå¤šé“¾éƒ¨ç½²ï¼ŒåŒä¸€ NFT å¯åœ¨ä¸åŒé“¾æ‹¥æœ‰ç‹¬ç«‹ TBAï¼Œèµ„äº§ä¸æ“ä½œäº’ä¸å½±å“Ethereum Improvement Proposals</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-5">ä¸‰ã€è§£å†³çš„è¡Œä¸šç—›ç‚¹</h4>
<ol>
<li><strong>NFT åŠŸèƒ½å•ä¸€</strong>ï¼šä¼ ç»Ÿ NFT ä»…ä¸ºé™æ€èµ„äº§ï¼Œæ— æ³•ä¸»åŠ¨æŒæœ‰ / ç®¡ç†å…¶ä»–èµ„äº§ï¼Œéš¾ä»¥æ˜ å°„å¤æ‚å®ä½“ï¼ˆå¦‚æ±½è½¦ã€æŠ•èµ„ç»„åˆï¼‰Ethereum Improvement Proposalsã€‚</li>
<li><strong>èµ„äº§å½’å±å‰²è£‚</strong>ï¼šç”¨æˆ·é’±åŒ…æ··åˆä¸ªäººä¸ NFT ç›¸å…³èµ„äº§ï¼Œç¼ºä¹ç‹¬ç«‹éš”ç¦»ä¸è¿½æº¯èƒ½åŠ›ã€‚</li>
<li><strong>äº¤äº’é—¨æ§›é«˜</strong>ï¼šNFT éœ€é€šè¿‡ç”¨æˆ·é’±åŒ…é—´æ¥æ“ä½œï¼Œæ— æ³•è‡ªä¸»å‚ä¸ dAppï¼ˆå¦‚ DeFi æŒ–çŸ¿ã€æ¸¸æˆå†…äº¤æ˜“ï¼‰ã€‚</li>
<li><strong>è·¨é“¾ç®¡ç†éš¾</strong>ï¼šå¤šé“¾èµ„äº§éœ€å¤šé’±åŒ…ç®¡ç†ï¼ŒTBA è®© NFT æˆä¸ºè·¨é“¾èµ„äº§çš„ç»Ÿä¸€å…¥å£Ethereum Improvement Proposalsã€‚</li>
</ol>
<hr/>
<h4 data-id="heading-6">å››ã€å…¸å‹è¡Œä¸šåº”ç”¨</h4>
<ol>
<li><strong>GameFi</strong>ï¼šè§’è‰² NFT çš„ TBA æŒæœ‰è£…å¤‡ã€é“å…·ã€è´§å¸ï¼Œèµ„äº§éšè§’è‰²è½¬ç§»ï¼Œæ”¯æŒ â€œè£…å¤‡é”»é€  - äº¤æ˜“ - ä½¿ç”¨â€ å…¨æµç¨‹é“¾ä¸Šé—­ç¯Ethereum Improvement Proposalsã€‚</li>
<li><strong>DeFi</strong>ï¼šNFT ä½œä¸º â€œèµ„äº§åŒ…â€ ç›´æ¥å‚ä¸æµåŠ¨æ€§æŒ–çŸ¿ã€å€Ÿè´·æŠµæŠ¼ï¼Œå¦‚æˆ¿äº§ NFT çš„ TBA æŒæœ‰ç§Ÿé‡‘æ”¶ç›Šä»£å¸ï¼Œè‡ªåŠ¨å¤æŠ•ã€‚</li>
<li><strong>æ•°å­—èº«ä»½</strong>ï¼šä¼šå‘˜ NFT çš„ TBA è®°å½•æ¶ˆè´¹ / ç§¯åˆ† / æƒé™ï¼Œå®ç° â€œå‡­è¯ + é’±åŒ… + èº«ä»½â€ ä¸‰åˆä¸€ï¼Œç®€åŒ– Web3 ç™»å½•ä¸æƒç›Šç®¡ç†Ethereum Improvement Proposalsã€‚</li>
<li><strong>DAO æ²»ç†</strong>ï¼šNFT ä½œä¸ºæŠ•ç¥¨æƒè½½ä½“ï¼ŒTBA è‡ªåŠ¨æ‰§è¡Œææ¡ˆæŠ•ç¥¨ã€åˆ†çº¢é¢†å–ï¼Œé™ä½ DAO å‚ä¸é—¨æ§›ã€‚</li>
<li><strong>IP èµ„äº§</strong>ï¼šè‰ºæœ¯ NFT çš„ TBA æŒæœ‰ç‰ˆç¨æ”¶å…¥ï¼Œè‡ªåŠ¨åˆ†å‘ç»™åˆ›ä½œè€… / æŒæœ‰è€…ï¼Œé€æ˜åŒ–ç‰ˆæƒæ”¶ç›Šæµã€‚</li>
</ol>
<hr/>
<h4 data-id="heading-7">äº”ã€ä¼˜åŠ£åŠ¿åˆ†æ</h4>



































<table><thead><tr><th>ç»´åº¦</th><th>ä¼˜åŠ¿</th><th>åŠ£åŠ¿</th></tr></thead><tbody><tr><td>å…¼å®¹æ€§</td><td>å®Œå…¨å…¼å®¹ ERC-721/ERC-1155ï¼Œæ— éœ€ä¿®æ”¹ç°æœ‰ NFT åˆçº¦</td><td>éƒ¨åˆ†éä¸»æµ NFTï¼ˆå¦‚ CryptoPunksï¼‰å› æœªå®ç° ownerOf æ–¹æ³•ï¼Œæ— æ³•æ¥å…¥ TBA</td></tr><tr><td>å®‰å…¨æ€§</td><td>èµ„äº§éš”ç¦»å­˜å‚¨ï¼Œå‡å°‘ç”¨æˆ·é’±åŒ…è¢«é»‘é£é™©ï¼›TBA ä»…ç”± NFT æ‰€æœ‰è€…æ§åˆ¶</td><td>æ™ºèƒ½åˆçº¦æ¼æ´å¯èƒ½å¯¼è‡´ TBA èµ„äº§æŸå¤±ï¼›NFT ä¸¢å¤± / è¢«ç›—åˆ™ TBA èµ„äº§ä¸€åŒå—æŸ</td></tr><tr><td>çµæ´»æ€§</td><td>æ”¯æŒè‡ªå®šä¹‰è´¦æˆ·å®ç°ï¼Œå¯æ‰©å±•æƒé™ç®¡ç†ï¼ˆå¦‚å¤šç­¾ã€å®šæ—¶é‡Šæ”¾ï¼‰Ethereum Improvement Proposals</td><td>éœ€å¼€å‘è€…é€‚é… TBA æ¥å£ï¼Œéƒ¨åˆ† dApp å°šæœªæ”¯æŒåˆçº¦è´¦æˆ·äº¤äº’</td></tr><tr><td>ç”¨æˆ·ä½“éªŒ</td><td>èµ„äº§éš NFT ä¸€é”®è½¬ç§»ï¼Œç®€åŒ–å¤šé“¾ / å¤šèµ„äº§ç®¡ç†</td><td>æ“ä½œéœ€æ”¯ä»˜é¢å¤– Gasï¼ˆTBA éƒ¨ç½²ã€äº¤æ˜“æ‰§è¡Œï¼‰ï¼Œæˆæœ¬é«˜äºæ™®é€š NFT è½¬ç§»</td></tr><tr><td>åˆ›æ–°æ€§</td><td>æ¨åŠ¨ NFT ä» â€œé™æ€ JPEGâ€ å‡çº§ä¸º â€œåŠ¨æ€ç»æµä½“â€ï¼Œå‚¬ç”Ÿæ–°å‹å•†ä¸šæ¨¡å¼</td><td>å¸‚åœºè®¤çŸ¥ä¸è¶³ï¼Œæ—©æœŸåº”ç”¨å­˜åœ¨åˆè§„ä¸ç›‘ç®¡ä¸ç¡®å®šæ€§</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-8">å…­ã€æ€»ç»“</h4>
<p>ERC-6551 é€šè¿‡ TBA æœºåˆ¶ä¸º NFT èµ‹äºˆ â€œæ™ºèƒ½é’±åŒ…â€ å±æ€§ï¼Œæ˜¯ NFT ä» â€œæ•°å­—è—å“â€ åˆ° â€œé“¾ä¸Šå®ä½“â€ çš„å…³é”®å‡çº§ã€‚å…¶æ ¸å¿ƒä»·å€¼åœ¨äº<strong>èµ„äº§éš”ç¦»ã€è‡ªä¸»äº¤äº’ã€æ‰€æœ‰æƒè”åŠ¨</strong>ï¼Œé€‚é… GameFiã€DeFiã€èº«ä»½ç®¡ç†ç­‰å¤šåœºæ™¯ï¼Œä½†éœ€å¹³è¡¡å®‰å…¨ã€æˆæœ¬ä¸ç”Ÿæ€é€‚é…æ€§ã€‚å»ºè®®å¼€å‘è€…ä¼˜å…ˆåŸºäº ERC-721 æ ‡å‡†æ¥å…¥ TBAï¼Œé€æ­¥æ¢ç´¢å¤æ‚åº”ç”¨è½åœ°ã€‚</p>
<hr/>
<h2 data-id="heading-9">æ™ºèƒ½åˆçº¦å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²</h2>
<h4 data-id="heading-10">æ™ºèƒ½åˆçº¦</h4>
<ul>
<li><strong>ä»£å¸åˆçº¦</strong></li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// SPDX-License-Identifier: MIT</span>
<span class="hljs-comment">// Compatible with OpenZeppelin Contracts ^5.5.0</span>
pragma solidity ^<span class="hljs-number">0.8</span><span class="hljs-number">.24</span>;

<span class="hljs-keyword">import</span> {<span class="hljs-title class_">ERC20</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/token/ERC20/ERC20.sol"</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">ERC20Burnable</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/token/ERC20/extensions/ERC20Burnable.sol"</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">ERC20Permit</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/token/ERC20/extensions/ERC20Permit.sol"</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">Ownable</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/access/Ownable.sol"</span>;

contract <span class="hljs-title class_">BoykaYuriToken</span> is <span class="hljs-title class_">ERC20</span>, <span class="hljs-title class_">ERC20Burnable</span>, <span class="hljs-title class_">Ownable</span>, <span class="hljs-title class_">ERC20Permit</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">address recipient, address initialOwner</span>)
        <span class="hljs-title class_">ERC20</span>(<span class="hljs-string">"MyToken"</span>, <span class="hljs-string">"MTK"</span>)
        <span class="hljs-title class_">Ownable</span>(initialOwner)
        <span class="hljs-title class_">ERC20Permit</span>(<span class="hljs-string">"MyToken"</span>)
    {
        <span class="hljs-title function_">_mint</span>(recipient, <span class="hljs-number">1000000</span> * <span class="hljs-number">10</span> ** <span class="hljs-title function_">decimals</span>());
    }
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">mint</span>(<span class="hljs-params">address to, uint256 amount</span>) public onlyOwner {
        <span class="hljs-title function_">_mint</span>(to, amount);
    }
}
</code></pre>
<ul>
<li><strong>NFTåˆçº¦</strong></li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// SPDX-License-Identifier: MIT</span>
<span class="hljs-comment">// Compatible with OpenZeppelin Contracts ^5.5.0</span>
pragma solidity ^<span class="hljs-number">0.8</span><span class="hljs-number">.27</span>;

<span class="hljs-keyword">import</span> {<span class="hljs-title class_">ERC721</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/token/ERC721/ERC721.sol"</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">ERC721Burnable</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/token/ERC721/extensions/ERC721Burnable.sol"</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">ERC721URIStorage</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/token/ERC721/extensions/ERC721URIStorage.sol"</span>;
<span class="hljs-keyword">import</span> {<span class="hljs-title class_">Ownable</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/access/Ownable.sol"</span>;

contract <span class="hljs-title class_">MyToken</span> is <span class="hljs-title class_">ERC721</span>, <span class="hljs-title class_">ERC721URIStorage</span>, <span class="hljs-title class_">ERC721Burnable</span>, <span class="hljs-title class_">Ownable</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">address initialOwner</span>)
        <span class="hljs-title class_">ERC721</span>(<span class="hljs-string">"MyToken"</span>, <span class="hljs-string">"MTK"</span>)
        <span class="hljs-title class_">Ownable</span>(initialOwner)
    {}

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">safeMint</span>(<span class="hljs-params">address to, uint256 tokenId, <span class="hljs-built_in">string</span> memory uri</span>)
        <span class="hljs-keyword">public</span>
        onlyOwner
    {
        <span class="hljs-title function_">_safeMint</span>(to, tokenId);
        <span class="hljs-title function_">_setTokenURI</span>(tokenId, uri);
    }

    <span class="hljs-comment">// The following functions are overrides required by Solidity.</span>

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">tokenURI</span>(<span class="hljs-params">uint256 tokenId</span>)
        <span class="hljs-keyword">public</span>
        view
        <span class="hljs-title function_">override</span>(<span class="hljs-title class_">ERC721</span>, <span class="hljs-title class_">ERC721URIStorage</span>)
        returns (<span class="hljs-built_in">string</span> memory)
    {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">tokenURI</span>(tokenId);
    }

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">supportsInterface</span>(<span class="hljs-params">bytes4 interfaceId</span>)
        <span class="hljs-keyword">public</span>
        view
        <span class="hljs-title function_">override</span>(<span class="hljs-title class_">ERC721</span>, <span class="hljs-title class_">ERC721URIStorage</span>)
        returns (bool)
    {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">supportsInterface</span>(interfaceId);
    }
}
</code></pre>
<ul>
<li><strong>è´¦æˆ·å®ç°æ™ºèƒ½åˆçº¦</strong></li>
</ul>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// SPDX-License-Identifier: MIT</span>
pragma solidity ^<span class="hljs-number">0.8</span>.<span class="hljs-number">24</span>;

import {IERC165} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/utils/introspection/IERC165.sol"</span>;
import {IERC721} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/token/ERC721/IERC721.sol"</span>;
import {IERC1271} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/interfaces/IERC1271.sol"</span>;
import {SignatureChecker} <span class="hljs-keyword">from</span> <span class="hljs-string">"@openzeppelin/contracts/utils/cryptography/SignatureChecker.sol"</span>;

<span class="hljs-comment">// ç®€åŒ–ç‰ˆ ERC6551 è´¦æˆ·å®ç°</span>
contract SimpleERC6551Account is IERC165, IERC1271 {
    <span class="hljs-title function_ invoke__">receive</span>() external payable {}

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execute</span>(<span class="hljs-params">address to, uint256 value, bytes calldata data, uint8 operation</span>) 
        <span class="hljs-title">external</span> <span class="hljs-title">payable</span> <span class="hljs-title">returns</span> (<span class="hljs-params">bytes memory result</span>) 
    </span>{
        <span class="hljs-keyword">require</span>(msg.sender == <span class="hljs-title function_ invoke__">owner</span>(), <span class="hljs-string">"Not token owner"</span>);
        <span class="hljs-keyword">require</span>(operation == <span class="hljs-number">0</span>, <span class="hljs-string">"Only call operation supported"</span>);

        <span class="hljs-keyword">bool</span> success;
        (success, result) = to.call{value: value}(data);
        <span class="hljs-keyword">require</span>(success, <span class="hljs-string">"Execution failed"</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">owner</span>(<span class="hljs-params"/>) <span class="hljs-title">public</span> <span class="hljs-title">view</span> <span class="hljs-title">returns</span> (<span class="hljs-params">address</span>) </span>{
        (uint256 chainId, address tokenContract, uint256 tokenId) = <span class="hljs-title function_ invoke__">token</span>();
        <span class="hljs-keyword">if</span> (chainId != block.chainid) <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">address</span>(<span class="hljs-number">0</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">IERC721</span>(tokenContract).<span class="hljs-title function_ invoke__">ownerOf</span>(tokenId);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">token</span>(<span class="hljs-params"/>) <span class="hljs-title">public</span> <span class="hljs-title">view</span> <span class="hljs-title">returns</span> (<span class="hljs-params">uint256, address, uint256</span>) </span>{
        bytes memory footer = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">bytes</span>(<span class="hljs-number">0x60</span>);
        assembly {
            <span class="hljs-title function_ invoke__">extcodecopy</span>(<span class="hljs-title function_ invoke__">address</span>(), <span class="hljs-title function_ invoke__">add</span>(footer, <span class="hljs-number">0x20</span>), <span class="hljs-title function_ invoke__">sub</span>(<span class="hljs-title function_ invoke__">extcodesize</span>(<span class="hljs-title function_ invoke__">address</span>()), <span class="hljs-number">0x60</span>), <span class="hljs-number">0x60</span>)
        }
        <span class="hljs-keyword">return</span> abi.<span class="hljs-title function_ invoke__">decode</span>(footer, (uint256, address, uint256));
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isValidSignature</span>(<span class="hljs-params">bytes32 hash, bytes memory signature</span>) <span class="hljs-title">external</span> <span class="hljs-title">view</span> <span class="hljs-title">returns</span> (<span class="hljs-params">bytes4</span>) </span>{
        <span class="hljs-keyword">if</span> (SignatureChecker.<span class="hljs-title function_ invoke__">isValidSignatureNow</span>(<span class="hljs-title function_ invoke__">owner</span>(), hash, signature)) {
            <span class="hljs-keyword">return</span> IERC1271.isValidSignature.selector;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">bytes4</span>(<span class="hljs-number">0</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">supportsInterface</span>(<span class="hljs-params">bytes4 interfaceId</span>) <span class="hljs-title">external</span> <span class="hljs-title">pure</span> <span class="hljs-title">returns</span> (<span class="hljs-params"><span class="hljs-keyword">bool</span></span>) </span>{
        <span class="hljs-keyword">return</span> interfaceId == <span class="hljs-number">0x6faff5f1</span> || interfaceId == <span class="hljs-number">0x01ffc9a7</span>; <span class="hljs-comment">// ERC6551 &amp; ERC165</span>
    }
}
</code></pre>
<ul>
<li><strong>æ³¨å†Œè¡¨æ™ºèƒ½åˆçº¦</strong></li>
</ul>
<pre><code class="hljs language-ini" lang="ini">// SPDX-License-Identifier: MIT
pragma solidity ^0.8.24<span class="hljs-comment">;</span>

import {Create2} from "@openzeppelin/contracts/utils/Create2.sol"<span class="hljs-comment">;</span>

contract ERC6551Registry {
    error AccountCreationFailed()<span class="hljs-comment">;</span>

    function createAccount(
        address implementation,
        uint256 chainId,
        address tokenContract,
        uint256 tokenId,
        uint256 salt,
        bytes calldata initData
    ) external returns (address) {
        bytes memory <span class="hljs-attr">code</span> = _creationCode(implementation, chainId, tokenContract, tokenId, salt)<span class="hljs-comment">;</span>
        address <span class="hljs-attr">_account</span> = Create2.computeAddress(bytes32(salt), keccak256(code))<span class="hljs-comment">;</span>

        if (_account.code.length != 0) return _account<span class="hljs-comment">;</span>

        <span class="hljs-attr">_account</span> = Create2.deploy(<span class="hljs-number">0</span>, bytes32(salt), code)<span class="hljs-comment">;</span>
        if (initData.length != 0) {
            (bool success, ) = _account.call(initData)<span class="hljs-comment">;</span>
            if (!success) revert AccountCreationFailed()<span class="hljs-comment">;</span>
        }
        return _account<span class="hljs-comment">;</span>
    }

    function account(
        address implementation,
        uint256 chainId,
        address tokenContract,
        uint256 tokenId,
        uint256 salt
    ) external view returns (address) {
        bytes memory <span class="hljs-attr">code</span> = _creationCode(implementation, chainId, tokenContract, tokenId, salt)<span class="hljs-comment">;</span>
        return Create2.computeAddress(bytes32(salt), keccak256(code))<span class="hljs-comment">;</span>
    }

    function _creationCode(address implementation, uint256 chainId, address tokenContract, uint256 tokenId, uint256 salt) internal pure returns (bytes memory) {
        return abi.encodePacked(
            hex"3d60ad80600a3d3981f3363d3d373d3d3d363d73",
            implementation,
            hex"5af43d82803e903d91602b57fd5bf3",
            abi.encode(salt, chainId, tokenContract, tokenId)
        )<span class="hljs-comment">;</span>
    }
}
</code></pre>
<h4 data-id="heading-11">æµ‹è¯•è„šæœ¬</h4>
<ul>
<li><strong>æµ‹è¯•åœºæ™¯ï¼š</strong></li>
</ul>
<ol>
<li><strong>åº”å…è®¸ NFT è´¦æˆ·æ¥æ”¶å’Œå‘é€ ERC20 ä»£å¸</strong></li>
<li><strong>æƒé™æµ‹è¯•ï¼šé NFT æŒæœ‰è€…æ— æ³•æ‰§è¡Œäº¤æ˜“</strong></li>
<li><strong>æ‰€æœ‰æƒè½¬ç§»æµ‹è¯•ï¼šNFT è½¬è®©åæ§åˆ¶æƒéšä¹‹è½¬ç§»</strong></li>
<li><strong>ETH æ¥æ”¶ä¸è½¬å‡ºæµ‹è¯•</strong> <strong>æ¥å£éªŒè¯ï¼šåº”æ”¯æŒ ERC165 å’Œ ERC6551 æ¥å£</strong></li>
<li><strong>å…ƒæ•°æ®æµ‹è¯•ï¼šTBA åº”èƒ½æ­£ç¡®è¿”å›å…¶ç»‘å®šçš„ Token ä¿¡æ¯</strong></li>
</ol>
<pre><code class="hljs language-ini" lang="ini">import assert from "node:assert/strict"<span class="hljs-comment">;</span>
import { describe, it } from "node:test"<span class="hljs-comment">;</span>
import { parseEther, encodeFunctionData, zeroAddress } from "viem"<span class="hljs-comment">;</span>
import { network } from "hardhat"<span class="hljs-comment">;</span>

describe("ERC6551 Extended Integration Tests", function () {
  async function deployFixture() {
    const { viem } = await network.connect()<span class="hljs-comment">;</span>
    const <span class="hljs-section">[owner, otherAccount]</span> = await viem.getWalletClients()<span class="hljs-comment">;</span>
    const <span class="hljs-attr">publicClient</span> = await viem.getPublicClient()<span class="hljs-comment">;</span>

    const <span class="hljs-attr">nft</span> = await viem.deployContract(<span class="hljs-string">"MyToken"</span>, [owner.account.address])<span class="hljs-comment">;</span>
    const <span class="hljs-attr">token</span> = await viem.deployContract(<span class="hljs-string">"BoykaYuriToken"</span>, [owner.account.address, owner.account.address])<span class="hljs-comment">;</span>
    const <span class="hljs-attr">registry</span> = await viem.deployContract(<span class="hljs-string">"ERC6551Registry"</span>)<span class="hljs-comment">;</span>
    const <span class="hljs-attr">implementation</span> = await viem.deployContract(<span class="hljs-string">"SimpleERC6551Account"</span>)<span class="hljs-comment">;</span>

    const <span class="hljs-attr">salt</span> = <span class="hljs-number">0</span>n<span class="hljs-comment">;</span>
    const <span class="hljs-attr">chainId</span> = BigInt(<span class="hljs-number">31337</span>)<span class="hljs-comment">;</span>
    const <span class="hljs-attr">tokenId</span> = <span class="hljs-number">1</span>n<span class="hljs-comment">;</span>
    const <span class="hljs-attr">ipfsUri</span> = <span class="hljs-string">"https://zygomorphic-magenta-bobolink.myfilebase.com/ipfs/QmQT8VpmWQVhUhoDCEK1mdHXaFaJ3KawkRxHm96GUhrXLB"</span><span class="hljs-comment">;</span>

    await nft.write.safeMint(<span class="hljs-section">[owner.account.address, tokenId, ipfsUri]</span>)<span class="hljs-comment">;</span>
    await registry.write.createAccount(<span class="hljs-section">[implementation.address, chainId, nft.address, tokenId, salt, "0x"]</span>)<span class="hljs-comment">;</span>
    const <span class="hljs-attr">tbaAddress</span> = await registry.read.account([implementation.address, chainId, nft.address, tokenId, salt])<span class="hljs-comment">;</span>
    const <span class="hljs-attr">tbaContract</span> = await viem.getContractAt(<span class="hljs-string">"SimpleERC6551Account"</span>, tbaAddress)<span class="hljs-comment">;</span>

    return { nft, token, registry, implementation, owner, otherAccount, publicClient, tbaAddress, tbaContract, tokenId, chainId, salt, viem }<span class="hljs-comment">;</span>
  }
it("åº”å…è®¸ NFT è´¦æˆ·æ¥æ”¶å’Œå‘é€ ERC20 ä»£å¸", async function () {
  const { nft, token, registry, implementation, owner, viem } = await deployFixture()<span class="hljs-comment">;</span>
  const <span class="hljs-attr">ipfsUri</span> = <span class="hljs-string">"https://zygomorphic-magenta-bobolink.myfilebase.com/ipfs/QmQT8VpmWQVhUhoDCEK1mdHXaFaJ3KawkRxHm96GUhrXLB"</span><span class="hljs-comment">;</span>
  
  // 1. æ˜¾å¼è·å–åœ°å€å­—ç¬¦ä¸²ï¼Œé˜²æ­¢ viem ä¼ é€’ç©ºå¯¹è±¡
  const <span class="hljs-attr">ownerAddress</span> = owner.account.address<span class="hljs-comment">;</span>
  const <span class="hljs-attr">tokenId</span> = <span class="hljs-number">1</span>n<span class="hljs-comment">;</span>

  // Mint NFT - æ˜¾å¼ä¼ é€’å­—ç¬¦ä¸²åœ°å€å’Œå‘é€è€…è´¦æˆ·
//   await nft.write.safeMint(<span class="hljs-section">[ownerAddress, tokenId, ipfsUri]</span>, {
//     account: owner.account 
//   })<span class="hljs-comment">;</span>

  // 2. è®¡ç®— TBA åœ°å€
  const <span class="hljs-attr">salt</span> = <span class="hljs-number">0</span>n<span class="hljs-comment">;</span>
  const <span class="hljs-attr">chainId</span> = BigInt(<span class="hljs-number">31337</span>)<span class="hljs-comment">;</span>
  const <span class="hljs-attr">tbaAddress</span> = await registry.read.account([implementation.address, chainId, nft.address, tokenId, salt])<span class="hljs-comment">;</span>

  // 3. éƒ¨ç½² TBA
  await registry.write.createAccount(<span class="hljs-section">[implementation.address, chainId, nft.address, tokenId, salt, "0x"]</span>)<span class="hljs-comment">;</span>

  // 4. ç»™ TBA è½¬å…¥ ERC20 (åŒæ ·ä½¿ç”¨æ˜¾å¼åœ°å€)
  const <span class="hljs-attr">amount</span> = parseEther(<span class="hljs-string">"100"</span>)<span class="hljs-comment">;</span>
  await token.write.transfer(<span class="hljs-section">[tbaAddress, amount]</span>, {
    account: owner.account 
  })<span class="hljs-comment">;</span>
  
  // éªŒè¯ TBA ä½™é¢
  const <span class="hljs-attr">balanceAfterTransfer</span> = await token.read.balanceOf([tbaAddress])<span class="hljs-comment">;</span>
  assert.strictEqual(balanceAfterTransfer, amount, "TBA åº”è¯¥æ”¶åˆ°æŒ‡å®šæ•°é‡çš„ä»£å¸")<span class="hljs-comment">;</span>

  // 5. é€šè¿‡ TBA è°ƒç”¨ ERC20 çš„ transfer æ–¹æ³•è½¬å›ç»™ Owner
  const <span class="hljs-attr">transferData</span> = encodeFunctionData({
    abi: token.abi,
    functionName: "transfer",
    args: <span class="hljs-section">[ownerAddress, amount]</span>, // ä½¿ç”¨æ˜¾å¼å­—ç¬¦ä¸²åœ°å€
  })<span class="hljs-comment">;</span>

  const <span class="hljs-attr">accountContract</span> = await viem.getContractAt(<span class="hljs-string">"SimpleERC6551Account"</span>, tbaAddress)<span class="hljs-comment">;</span>
  // æ‰§è¡Œ TBA äº¤æ˜“
  await accountContract.write.execute(<span class="hljs-section">[token.address, 0n, transferData, 0]</span>, {
    account: owner.account
  })<span class="hljs-comment">;</span>

  // éªŒè¯ TBA ä½™é¢æ¸…é›¶
  const <span class="hljs-attr">finalBalance</span> = await token.read.balanceOf([tbaAddress])<span class="hljs-comment">;</span>
  assert.strictEqual(finalBalance, 0n, "TBA çš„ä»£å¸ä½™é¢åº”è¯¥å·²è½¬å‡ºå¹¶æ¸…é›¶")<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>


  it("æƒé™æµ‹è¯•ï¼šé NFT æŒæœ‰è€…æ— æ³•æ‰§è¡Œäº¤æ˜“", async function () {
    const { tbaContract, otherAccount, token } = await deployFixture()<span class="hljs-comment">;</span>
    const <span class="hljs-attr">data</span> = encodeFunctionData({
      abi: token.abi,
      functionName: "transfer",
      args: <span class="hljs-section">[otherAccount.account.address, 1n]</span>,
    })<span class="hljs-comment">;</span>

    // Node assert éªŒè¯å¼‚æ­¥æŠ›å‡ºå¼‚å¸¸
    await assert.rejects(
      async () =&gt; {
        await tbaContract.write.execute(<span class="hljs-section">[token.address, 0n, data, 0]</span>, {
          account: otherAccount.account,
        })<span class="hljs-comment">;</span>
      },
      (err: any) =&gt; {
        return err.message.includes("Not token owner")<span class="hljs-comment">;</span>
      },
      "åº”è¯¥å› ä¸ºä¸æ˜¯æ‰€æœ‰è€…è€Œæ‹’ç»äº¤æ˜“"
    )<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>

  it("æ‰€æœ‰æƒè½¬ç§»æµ‹è¯•ï¼šNFT è½¬è®©åæ§åˆ¶æƒéšä¹‹è½¬ç§»", async function () {
    const { nft, tbaContract, owner, otherAccount, tokenId } = await deployFixture()<span class="hljs-comment">;</span>

    await nft.write.transferFrom(<span class="hljs-section">[owner.account.address, otherAccount.account.address, tokenId]</span>)<span class="hljs-comment">;</span>

    // éªŒè¯æ—§æ‰€æœ‰è€…å¤±æ•ˆ
    await assert.rejects(
      async () =&gt; {
        await tbaContract.write.execute(<span class="hljs-section">[zeroAddress, 0n, "0x", 0]</span>, { account: owner.account })<span class="hljs-comment">;</span>
      },
      /Not token owner/
    )<span class="hljs-comment">;</span>

    // éªŒè¯æ–°æ‰€æœ‰è€…æˆåŠŸ
    const <span class="hljs-attr">tx</span> = await tbaContract.write.execute([otherAccount.account.address, <span class="hljs-number">0</span>n, <span class="hljs-string">"0x"</span>, <span class="hljs-number">0</span>], {
      account: otherAccount.account,
    })<span class="hljs-comment">;</span>
    assert.ok(typeof <span class="hljs-attr">tx</span> === <span class="hljs-string">"string"</span>, <span class="hljs-string">"äº¤æ˜“å“ˆå¸Œåº”ä¸ºå­—ç¬¦ä¸²"</span>)<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>
 
  it("ETH æ¥æ”¶ä¸è½¬å‡ºæµ‹è¯•", async function () {
    const { tbaAddress, tbaContract, otherAccount, publicClient } = await deployFixture()<span class="hljs-comment">;</span>
    const <span class="hljs-attr">depositAmount</span> = parseEther(<span class="hljs-string">"1"</span>)<span class="hljs-comment">;</span>

    await otherAccount.sendTransaction({ to: tbaAddress, value: depositAmount })<span class="hljs-comment">;</span>
    
    let <span class="hljs-attr">balance</span> = await publicClient.getBalance({ address: tbaAddress })<span class="hljs-comment">;</span>
    assert.equal(balance, depositAmount)<span class="hljs-comment">;</span>

    const <span class="hljs-attr">beforeBalance</span> = await publicClient.getBalance({ address: otherAccount.account.address })<span class="hljs-comment">;</span>
    await tbaContract.write.execute(<span class="hljs-section">[otherAccount.account.address, depositAmount, "0x", 0]</span>)<span class="hljs-comment">;</span>

    <span class="hljs-attr">balance</span> = await publicClient.getBalance({ address: tbaAddress })<span class="hljs-comment">;</span>
    const <span class="hljs-attr">afterBalance</span> = await publicClient.getBalance({ address: otherAccount.account.address })<span class="hljs-comment">;</span>

    assert.equal(balance, 0n)<span class="hljs-comment">;</span>
    assert.ok(afterBalance &gt; beforeBalance, "æ¥æ”¶è€…ä½™é¢åº”å¢åŠ ")<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>
  it("æ¥å£éªŒè¯ï¼šåº”æ”¯æŒ ERC165 å’Œ ERC6551 æ¥å£", async function () {
    const { tbaContract } = await deployFixture()<span class="hljs-comment">;</span>
    const <span class="hljs-attr">supportsERC6551</span> = await tbaContract.read.supportsInterface([<span class="hljs-string">"0x6faff5f1"</span>])<span class="hljs-comment">;</span>
    assert.strictEqual(supportsERC6551, true)<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>

  it("å…ƒæ•°æ®æµ‹è¯•ï¼šTBA åº”èƒ½æ­£ç¡®è¿”å›å…¶ç»‘å®šçš„ Token ä¿¡æ¯", async function () {
    const { tbaContract, nft, tokenId, chainId } = await deployFixture()<span class="hljs-comment">;</span>
    const <span class="hljs-section">[resChainId, resAddr, resTokenId]</span> = await tbaContract.read.token()<span class="hljs-comment">;</span>
    
    assert.equal(resChainId, chainId)<span class="hljs-comment">;</span>
    assert.equal(resAddr.toLowerCase(), nft.address.toLowerCase())<span class="hljs-comment">;</span>
    assert.equal(resTokenId, tokenId)<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>
</code></pre>
<h4 data-id="heading-12">éƒ¨ç½²è„šæœ¬</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { network, artifacts } <span class="hljs-keyword">from</span> <span class="hljs-string">"hardhat"</span>;
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> { viem } = <span class="hljs-keyword">await</span> network.<span class="hljs-title function_">connect</span>({ <span class="hljs-attr">network</span>: network.<span class="hljs-property">name</span> });<span class="hljs-comment">//æŒ‡å®šç½‘ç»œè¿›è¡Œé“¾æ¥</span>
  <span class="hljs-keyword">const</span> publicClient = <span class="hljs-keyword">await</span> viem.<span class="hljs-title function_">getPublicClient</span>();
  <span class="hljs-keyword">const</span> [deployer] = <span class="hljs-keyword">await</span> viem.<span class="hljs-title function_">getWalletClients</span>();

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ­£åœ¨ä½¿ç”¨è´¦æˆ·éƒ¨ç½²: <span class="hljs-subst">${deployer.account.address}</span>`</span>);

  <span class="hljs-comment">// 1. éƒ¨ç½² Account Implementation (é€»è¾‘è“æœ¬)</span>
  <span class="hljs-keyword">const</span> accountArt = <span class="hljs-keyword">await</span> artifacts.<span class="hljs-title function_">readArtifact</span>(<span class="hljs-string">"SimpleERC6551Account"</span>);
  <span class="hljs-keyword">const</span> accountHash = <span class="hljs-keyword">await</span> deployer.<span class="hljs-title function_">deployContract</span>({
    <span class="hljs-attr">abi</span>: accountArt.<span class="hljs-property">abi</span>,
    <span class="hljs-attr">bytecode</span>: accountArt.<span class="hljs-property">bytecode</span> <span class="hljs-keyword">as</span> <span class="hljs-string">`0x<span class="hljs-subst">${<span class="hljs-built_in">string</span>}</span>`</span>,
  });
  <span class="hljs-keyword">const</span> { <span class="hljs-attr">contractAddress</span>: implementationAddr } = <span class="hljs-keyword">await</span> publicClient.<span class="hljs-title function_">waitForTransactionReceipt</span>({ <span class="hljs-attr">hash</span>: accountHash });
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Account Implementation éƒ¨ç½²æˆåŠŸ: <span class="hljs-subst">${implementationAddr}</span>`</span>);

  <span class="hljs-comment">// 2. éƒ¨ç½² Registry (æ³¨å†Œè¡¨)</span>
  <span class="hljs-keyword">const</span> registryArt = <span class="hljs-keyword">await</span> artifacts.<span class="hljs-title function_">readArtifact</span>(<span class="hljs-string">"ERC6551Registry"</span>);
  <span class="hljs-keyword">const</span> registryHash = <span class="hljs-keyword">await</span> deployer.<span class="hljs-title function_">deployContract</span>({
    <span class="hljs-attr">abi</span>: registryArt.<span class="hljs-property">abi</span>,
    <span class="hljs-attr">bytecode</span>: registryArt.<span class="hljs-property">bytecode</span> <span class="hljs-keyword">as</span> <span class="hljs-string">`0x<span class="hljs-subst">${<span class="hljs-built_in">string</span>}</span>`</span>,
  });
  <span class="hljs-keyword">const</span> { <span class="hljs-attr">contractAddress</span>: registryAddr } = <span class="hljs-keyword">await</span> publicClient.<span class="hljs-title function_">waitForTransactionReceipt</span>({ <span class="hljs-attr">hash</span>: registryHash });
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ERC6551Registry éƒ¨ç½²æˆåŠŸ: <span class="hljs-subst">${registryAddr}</span>`</span>);

  <span class="hljs-keyword">return</span> { implementationAddr, registryAddr };
}

<span class="hljs-title function_">main</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);
  process.<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
});
</code></pre>
<h2 data-id="heading-13">ç»“è¯­</h2>
<p>è‡³æ­¤ï¼ŒERC6551 æ ‡å‡†ä»æ ¸å¿ƒç†è®ºè§£æåˆ°ä»£ç å®æˆ˜è½åœ°çš„å…¨å†…å®¹å·²å®Œæ•´å‘ˆç°ã€‚ä»æ ‡å‡†çš„æ ¸å¿ƒå®šä¹‰ã€æ ¸å¿ƒèƒ½åŠ›ï¼Œåˆ°è§£å†³çš„è¡Œä¸šç—›ç‚¹ã€å…¸å‹åº”ç”¨ä¸ä¼˜åŠ£åŠ¿åˆ†æï¼Œå†åˆ°åŸºäº Hardhat V3+OpenZeppelin V5+Solidity 0.8.24 å®ç°çš„å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²å…¨æµç¨‹ï¼Œå½¢æˆäº†ç†è®ºä¸å®è·µç»“åˆçš„å®Œæ•´ä½“ç³»ï¼Œä¸ºè¯¥æ ‡å‡†çš„å®é™…å¼€å‘ä¸è½åœ°åº”ç”¨æä¾›äº†æ¸…æ™°çš„å‚è€ƒè·¯å¾„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶å¼€å§‹æ„å»º Tauri 2.0 æ¡Œé¢åº”ç”¨ï¼šReact + Rust å®Œæ•´å®æˆ˜æ•™ç¨‹]]></title>    <link>https://juejin.cn/post/7599924965949866022</link>    <guid>https://juejin.cn/post/7599924965949866022</guid>    <pubDate>2026-01-27T11:27:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599924965949866022" data-draft-id="7599528186586923018" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶å¼€å§‹æ„å»º Tauri 2.0 æ¡Œé¢åº”ç”¨ï¼šReact + Rust å®Œæ•´å®æˆ˜æ•™ç¨‹"/> <meta itemprop="keywords" content="å…¨æ ˆ,React.js"/> <meta itemprop="datePublished" content="2026-01-27T11:27:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‡‰ä»‹Nova"/> <meta itemprop="url" content="https://juejin.cn/user/915262510735207"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶å¼€å§‹æ„å»º Tauri 2.0 æ¡Œé¢åº”ç”¨ï¼šReact + Rust å®Œæ•´å®æˆ˜æ•™ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/915262510735207/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‡‰ä»‹Nova
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T11:27:48.000Z" title="Tue Jan 27 2026 11:27:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>Tauri æ˜¯ä¸€ä¸ªä½¿ç”¨ Web æŠ€æœ¯æ„å»ºæ¡Œé¢åº”ç”¨çš„æ¡†æ¶ï¼Œç›¸æ¯” Electronï¼Œå®ƒçš„ä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li><strong>ä½“ç§¯å°</strong>ï¼šæ‰“åŒ…åä»…å‡  MBï¼Œè€Œ Electron åŠ¨è¾„ä¸Šç™¾ MB</li>
<li><strong>æ€§èƒ½é«˜</strong>ï¼šä½¿ç”¨ Rust ä½œä¸ºåç«¯ï¼Œå†…å­˜å ç”¨ä½</li>
<li><strong>å®‰å…¨æ€§å¼º</strong>ï¼šé»˜è®¤ç¦ç”¨ Node.jsï¼Œå‡å°‘æ”»å‡»é¢</li>
</ul>
<p>æœ¬æ–‡å°†å¸¦ä½ ä»é›¶æ„å»ºä¸€ä¸ªå®Œæ•´çš„ Tauri åº”ç”¨ï¼ŒåŒ…å«å‰åç«¯é€šä¿¡çš„å®æˆ˜æ¡ˆä¾‹ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ç¯å¢ƒå‡†å¤‡</h2>
<h3 data-id="heading-2">1.1 å®‰è£… Rust</h3>
<p>Windows ç”¨æˆ·ä¸‹è½½å¹¶è¿è¡Œ rustup-init.exeï¼ŒæŒ‰æç¤ºå®Œæˆå®‰è£…ã€‚</p>
<p>å®‰è£…å®ŒæˆåéªŒè¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">rustc --version
cargo --version
</code></pre>
<h3 data-id="heading-3">1.2 å®‰è£… Node.js</h3>
<p>æ¨èä½¿ç”¨ Node.js 18 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">node --version
npm --version
</code></pre>
<h3 data-id="heading-4">1.3 å®‰è£…ç³»ç»Ÿä¾èµ–</h3>
<p>Windows éœ€è¦å®‰è£…ï¼š</p>
<ul>
<li>Microsoft Visual Studio C++ Build Tools</li>
<li>WebView2ï¼ˆWindows 10/11 é€šå¸¸å·²é¢„è£…ï¼‰</li>
</ul>
<h2 data-id="heading-5">äºŒã€åˆ›å»ºé¡¹ç›®</h2>
<h3 data-id="heading-6">2.1 åˆå§‹åŒ– Tauri é¡¹ç›®</h3>
<pre><code class="hljs language-bash" lang="bash">npm create tauri-app@latest
</code></pre>
<p>æŒ‰æç¤ºé€‰æ‹©ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">âœ” Project name Â· <span class="hljs-keyword">my</span>-tauri-app
âœ” Identifier Â· com.example.app
âœ” Choose which language to <span class="hljs-keyword">use</span> <span class="hljs-keyword">for</span> your frontend Â· TypeScript / JavaScript
âœ” Choose your <span class="hljs-keyword">package</span> manager Â· npm
âœ” Choose your UI template Â· React
âœ” Choose your UI flavor Â· TypeScript
</code></pre>
<h3 data-id="heading-7">2.2 è¿›å…¥é¡¹ç›®å¹¶å®‰è£…ä¾èµ–</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> my-tauri-app
npm install
</code></pre>
<h3 data-id="heading-8">2.3 é¡¹ç›®ç»“æ„</h3>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">my</span>-tauri-app/
â”œâ”€â”€ src/                    <span class="hljs-comment"># React å‰ç«¯ä»£ç </span>
â”‚   â”œâ”€â”€ App.tsx
â”‚   â”œâ”€â”€ main.tsx
â”‚   â””â”€â”€ ...
â”œâ”€â”€ src-tauri/              <span class="hljs-comment"># Rust åç«¯ä»£ç </span>
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ lib.rs          <span class="hljs-comment"># ä¸»è¦é€»è¾‘</span>
â”‚   â”‚   â””â”€â”€ main.rs         <span class="hljs-comment"># å…¥å£æ–‡ä»¶</span>
â”‚   â”œâ”€â”€ Cargo.toml          <span class="hljs-comment"># Rust ä¾èµ–é…ç½®</span>
â”‚   â””â”€â”€ tauri.conf.json     <span class="hljs-comment"># Tauri é…ç½®æ–‡ä»¶</span>
â”œâ”€â”€ package.json
â””â”€â”€ ...
</code></pre>
<h3 data-id="heading-9">2.4 å¯åŠ¨å¼€å‘æœåŠ¡å™¨</h3>
<pre><code class="hljs language-bash" lang="bash">npm run tauri dev
</code></pre>
<p>é¦–æ¬¡è¿è¡Œä¼šç¼–è¯‘ Rust ä»£ç ï¼Œéœ€è¦ç­‰å¾…å‡ åˆ†é’Ÿã€‚ä¹‹åä¼šå¼¹å‡ºåº”ç”¨çª—å£ã€‚</p>
<h2 data-id="heading-10">ä¸‰ã€å‰åç«¯é€šä¿¡ï¼šæ ¸å¿ƒæ¦‚å¿µ</h2>
<p>Tauri çš„å‰åç«¯é€šä¿¡ä¸»è¦é€šè¿‡ <strong>Commandsï¼ˆå‘½ä»¤ï¼‰</strong> å®ç°ï¼š</p>
<ul>
<li><strong>Rust ç«¯</strong>ï¼šå®šä¹‰å‘½ä»¤å‡½æ•°ï¼Œå¤„ç†ä¸šåŠ¡é€»è¾‘</li>
<li><strong>React ç«¯</strong>ï¼šè°ƒç”¨å‘½ä»¤ï¼Œè·å–è¿”å›å€¼</li>
</ul>
<p>è¿™æ˜¯ Tauri æœ€æ ¸å¿ƒçš„åŠŸèƒ½ï¼Œä¸‹é¢é€šè¿‡å®æˆ˜æ¡ˆä¾‹è®²è§£ã€‚</p>
<h2 data-id="heading-11">å››ã€å®æˆ˜æ¡ˆä¾‹ï¼šè·å–ç³»ç»Ÿä¿¡æ¯</h2>
<p>æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªè·å–ç³»ç»Ÿç£ç›˜ä¿¡æ¯çš„åŠŸèƒ½ã€‚</p>
<h3 data-id="heading-12">4.1 Rust ç«¯ï¼šå®šä¹‰å‘½ä»¤</h3>
<p>ç¼–è¾‘ <code>src-tauri/src/lib.rs</code>ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> serde::Serialize;

<span class="hljs-comment">// å®šä¹‰è¿”å›æ•°æ®ç»“æ„</span>
<span class="hljs-meta">#[derive(Debug, Serialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">DiskInfo</span> {
    <span class="hljs-keyword">pub</span> drive_letter: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> total_space: <span class="hljs-type">u64</span>,
    <span class="hljs-keyword">pub</span> free_space: <span class="hljs-type">u64</span>,
    <span class="hljs-keyword">pub</span> used_space: <span class="hljs-type">u64</span>,
    <span class="hljs-keyword">pub</span> usage_percent: <span class="hljs-type">f64</span>,
}

<span class="hljs-comment">// å®šä¹‰ Tauri å‘½ä»¤</span>
<span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">get_disk_info</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;DiskInfo, <span class="hljs-type">String</span>&gt; {
    <span class="hljs-comment">// è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œå®é™…å¯ä»¥ä½¿ç”¨ sysinfo åº“è·å–çœŸå®æ•°æ®</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">total</span>: <span class="hljs-type">u64</span> = <span class="hljs-number">500</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>; <span class="hljs-comment">// 500GB</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">free</span>: <span class="hljs-type">u64</span> = <span class="hljs-number">100</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>;  <span class="hljs-comment">// 100GB</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">used</span> = total - free;
    
    <span class="hljs-title function_ invoke__">Ok</span>(DiskInfo {
        drive_letter: <span class="hljs-string">"C"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),
        total_space: total,
        free_space: free,
        used_space: used,
        usage_percent: (used <span class="hljs-keyword">as</span> <span class="hljs-type">f64</span> / total <span class="hljs-keyword">as</span> <span class="hljs-type">f64</span>) * <span class="hljs-number">100.0</span>,
    })
}

<span class="hljs-comment">// æ³¨å†Œå‘½ä»¤</span>
<span class="hljs-meta">#[cfg_attr(mobile, tauri::mobile_entry_point)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">run</span>() {
    tauri::Builder::<span class="hljs-title function_ invoke__">default</span>()
        .<span class="hljs-title function_ invoke__">plugin</span>(tauri_plugin_opener::<span class="hljs-title function_ invoke__">init</span>())
        .<span class="hljs-title function_ invoke__">invoke_handler</span>(tauri::generate_handler![get_disk_info]) <span class="hljs-comment">// æ³¨å†Œå‘½ä»¤</span>
        .<span class="hljs-title function_ invoke__">run</span>(tauri::generate_context!())
        .<span class="hljs-title function_ invoke__">expect</span>(<span class="hljs-string">"error while running tauri application"</span>);
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ol>
<li><code>#[tauri::command]</code> å®å°†å‡½æ•°æ ‡è®°ä¸ºå¯è¢«å‰ç«¯è°ƒç”¨çš„å‘½ä»¤</li>
<li>è¿”å›å€¼éœ€è¦å®ç° <code>Serialize</code> trait</li>
<li>ä½¿ç”¨ <code>Result&lt;T, String&gt;</code> å¯ä»¥å‘å‰ç«¯è¿”å›é”™è¯¯ä¿¡æ¯</li>
<li>å¿…é¡»åœ¨ <code>invoke_handler</code> ä¸­æ³¨å†Œå‘½ä»¤</li>
</ol>
<h3 data-id="heading-13">4.2 æ·»åŠ  Rust ä¾èµ–</h3>
<p>ç¼–è¾‘ <code>src-tauri/Cargo.toml</code>ï¼Œç¡®ä¿æœ‰ serde ä¾èµ–ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[dependencies]</span>
<span class="hljs-attr">tauri</span> = { version = <span class="hljs-string">"2"</span>, features = [] }
<span class="hljs-attr">serde</span> = { version = <span class="hljs-string">"1"</span>, features = [<span class="hljs-string">"derive"</span>] }
<span class="hljs-attr">serde_json</span> = <span class="hljs-string">"1"</span>
</code></pre>
<h3 data-id="heading-14">4.3 React ç«¯ï¼šè°ƒç”¨å‘½ä»¤</h3>
<p>ç¼–è¾‘ <a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">src/App.tsx</a>ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { invoke } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tauri-apps/api/core'</span>;

<span class="hljs-comment">// å®šä¹‰ç±»å‹ï¼ˆä¸ Rust ç«¯å¯¹åº”ï¼‰</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">DiskInfo</span> {
  <span class="hljs-attr">drive_letter</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">total_space</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">free_space</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">used_space</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">usage_percent</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [diskInfo, setDiskInfo] = useState&lt;<span class="hljs-title class_">DiskInfo</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState&lt;<span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);

  <span class="hljs-comment">// è°ƒç”¨ Rust å‘½ä»¤</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchDiskInfo</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">true</span>);
    <span class="hljs-title function_">setError</span>(<span class="hljs-literal">null</span>);
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// invoke å‡½æ•°è°ƒç”¨ Rust å‘½ä»¤ï¼Œå‘½ä»¤åä½¿ç”¨è›‡å½¢å‘½åæ³•</span>
      <span class="hljs-keyword">const</span> info = <span class="hljs-keyword">await</span> invoke&lt;<span class="hljs-title class_">DiskInfo</span>&gt;(<span class="hljs-string">'get_disk_info'</span>);
      <span class="hljs-title function_">setDiskInfo</span>(info);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-title function_">setError</span>(<span class="hljs-title class_">String</span>(err));
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">false</span>);
    }
  };

  <span class="hljs-comment">// æ ¼å¼åŒ–æ–‡ä»¶å¤§å°</span>
  <span class="hljs-keyword">const</span> formatSize = (<span class="hljs-attr">bytes</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> gb = bytes / (<span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${gb.toFixed(<span class="hljs-number">2</span>)}</span> GB`</span>;
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">padding:</span> '<span class="hljs-attr">20px</span>' }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Tauri ç£ç›˜ä¿¡æ¯ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{fetchDiskInfo}</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{loading}</span>&gt;</span>
        {loading ? 'åŠ è½½ä¸­...' : 'è·å–ç£ç›˜ä¿¡æ¯'}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {error &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color:</span> '<span class="hljs-attr">red</span>' }}&gt;</span>é”™è¯¯: {error}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      )}

      {diskInfo &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">marginTop:</span> '<span class="hljs-attr">20px</span>' }}&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>ç›˜ç¬¦:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {diskInfo.drive_letter}:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>æ€»å®¹é‡:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {formatSize(diskInfo.total_space)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>å·²ç”¨:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {formatSize(diskInfo.used_space)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>å¯ç”¨:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {formatSize(diskInfo.free_space)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>ä½¿ç”¨ç‡:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {diskInfo.usage_percent.toFixed(1)}%<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ol>
<li>ä½¿ç”¨ <code>@tauri-apps/api/core</code> ä¸­çš„ <code>invoke</code> å‡½æ•°è°ƒç”¨å‘½ä»¤</li>
<li>å‘½ä»¤åéœ€è¦ä½¿ç”¨è›‡å½¢å‘½åæ³•ï¼ˆsnake_caseï¼‰</li>
<li>æ³›å‹å‚æ•°æŒ‡å®šè¿”å›å€¼ç±»å‹</li>
<li>ä½¿ç”¨ try-catch å¤„ç†å¯èƒ½çš„é”™è¯¯</li>
</ol>
<h3 data-id="heading-15">4.4 è¿è¡Œæµ‹è¯•</h3>
<pre><code class="hljs language-bash" lang="bash">npm run tauri dev
</code></pre>
<p>ç‚¹å‡»æŒ‰é’®ï¼Œå³å¯çœ‹åˆ°ä» Rust ç«¯è¿”å›çš„ç£ç›˜ä¿¡æ¯ã€‚</p>
<h2 data-id="heading-16">äº”ã€è¿›é˜¶ï¼šå¸¦å‚æ•°çš„å‘½ä»¤</h2>
<h3 data-id="heading-17">5.1 Rust ç«¯</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">greet</span>(name: <span class="hljs-type">String</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">String</span> {
    <span class="hljs-built_in">format!</span>(<span class="hljs-string">"Hello, {}! Welcome to Tauri."</span>, name)
}

<span class="hljs-comment">// è®°å¾—æ³¨å†Œ</span>
.<span class="hljs-title function_ invoke__">invoke_handler</span>(tauri::generate_handler![get_disk_info, greet])
</code></pre>
<h3 data-id="heading-18">5.2 React ç«¯</h3>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> greeting = <span class="hljs-keyword">await</span> invoke&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">'greet'</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">'Tauri'</span> });
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(greeting); <span class="hljs-comment">// "Hello, Tauri! Welcome to Tauri."</span>
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong> å‚æ•°ä»¥å¯¹è±¡å½¢å¼ä¼ é€’ï¼Œé”®åå¿…é¡»ä¸ Rust å‡½æ•°å‚æ•°åä¸€è‡´ã€‚</p>
<h2 data-id="heading-19">å…­ã€è¿›é˜¶ï¼šå¼‚æ­¥å‘½ä»¤</h2>
<p>å¯¹äºè€—æ—¶æ“ä½œï¼Œä½¿ç”¨å¼‚æ­¥å‘½ä»¤é¿å…é˜»å¡ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">scan_files</span>(path: <span class="hljs-type">String</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">Vec</span>&lt;<span class="hljs-type">String</span>&gt;, <span class="hljs-type">String</span>&gt; {
    <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
    tokio::time::<span class="hljs-title function_ invoke__">sleep</span>(tokio::time::Duration::<span class="hljs-title function_ invoke__">from_secs</span>(<span class="hljs-number">2</span>)).<span class="hljs-keyword">await</span>;
    
    <span class="hljs-title function_ invoke__">Ok</span>(<span class="hljs-built_in">vec!</span>[
        <span class="hljs-built_in">format!</span>(<span class="hljs-string">"{}/file1.txt"</span>, path),
        <span class="hljs-built_in">format!</span>(<span class="hljs-string">"{}/file2.txt"</span>, path),
    ])
}
</code></pre>
<p>éœ€è¦åœ¨ <code>Cargo.toml</code> æ·»åŠ  tokio ä¾èµ–ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[dependencies]</span>
<span class="hljs-attr">tokio</span> = { version = <span class="hljs-string">"1"</span>, features = [<span class="hljs-string">"time"</span>] }
</code></pre>
<h2 data-id="heading-20">ä¸ƒã€é…ç½®åº”ç”¨ä¿¡æ¯</h2>
<p>ç¼–è¾‘ <code>src-tauri/tauri.conf.json</code>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"productName"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æˆ‘çš„åº”ç”¨"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"identifier"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"com.example.myapp"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"frontendDist"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"../dist"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"app"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"windows"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æˆ‘çš„ Tauri åº”ç”¨"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"width"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">900</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"height"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">600</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"resizable"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"center"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-21">å…«ã€æ‰“åŒ…å‘å¸ƒ</h2>
<h3 data-id="heading-22">8.1 æ‰§è¡Œæ‰“åŒ…å‘½ä»¤</h3>
<pre><code class="hljs language-bash" lang="bash">npm run tauri build
</code></pre>
<h3 data-id="heading-23">8.2 æ‰“åŒ…äº§ç‰©</h3>
<p>æ‰“åŒ…å®Œæˆåï¼Œå®‰è£…åŒ…ä½äºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">src-tauri/target/release/bundle/
â”œâ”€â”€ msi/          <span class="hljs-comment"># MSI å®‰è£…åŒ…</span>
â”‚   â””â”€â”€ åº”ç”¨å_ç‰ˆæœ¬_x64_en-US.msi
â””â”€â”€ nsis/         <span class="hljs-comment"># NSIS å®‰è£…åŒ…</span>
    â””â”€â”€ åº”ç”¨å_ç‰ˆæœ¬_x64-setup.exe
</code></pre>
<h3 data-id="heading-24">8.3 å¸¸è§é—®é¢˜ï¼šç½‘ç»œè¶…æ—¶</h3>
<p>å¦‚æœé‡åˆ° <code>timeout: global</code> é”™è¯¯ï¼Œæ˜¯å› ä¸ºä¸‹è½½ NSIS å·¥å…·è¶…æ—¶ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼šæ‰‹åŠ¨ä¸‹è½½ NSIS å¹¶æ”¾åˆ°ç¼“å­˜ç›®å½•ã€‚</p>
<pre><code class="hljs language-powershell" lang="powershell"># åˆ›å»ºç›®å½•
New-Item -ItemType Directory -Path "$env:LOCALAPPDATA\tauri\NSIS" -Force

# æ‰‹åŠ¨ä¸‹è½½ nsis-3.zip å¹¶è§£å‹åˆ°ä¸Šè¿°ç›®å½•
</code></pre>
<h2 data-id="heading-25">ä¹ã€æ€»ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº† Tauri 2.0 çš„æ ¸å¿ƒå¼€å‘æµç¨‹ï¼š</p>
<ol>
<li><strong>ç¯å¢ƒæ­å»º</strong>ï¼šå®‰è£… Rust å’Œ Node.js</li>
<li><strong>é¡¹ç›®åˆ›å»º</strong>ï¼šä½¿ç”¨è„šæ‰‹æ¶å¿«é€Ÿåˆå§‹åŒ–</li>
<li><strong>å‰åç«¯é€šä¿¡</strong>ï¼šé€šè¿‡ Commands å®ç° React ä¸ Rust çš„æ•°æ®äº¤äº’</li>
<li><strong>æ‰“åŒ…å‘å¸ƒ</strong>ï¼šç”Ÿæˆ Windows å®‰è£…åŒ…</li>
</ol>
<p>Tauri çš„ä¼˜åŠ¿åœ¨äºå°ä½“ç§¯ã€é«˜æ€§èƒ½ã€å¼ºå®‰å…¨æ€§ï¼Œéå¸¸é€‚åˆå¼€å‘è½»é‡çº§æ¡Œé¢å·¥å…·ã€‚å¸Œæœ›è¿™ç¯‡æ•™ç¨‹èƒ½å¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹ Tauri å¼€å‘ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[elpiså…¨æ ˆæ¡†æ¶çš„ç†è§£]]></title>    <link>https://juejin.cn/post/7599920572840017929</link>    <guid>https://juejin.cn/post/7599920572840017929</guid>    <pubDate>2026-01-27T12:47:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599920572840017929" data-draft-id="7599565587154173978" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="elpiså…¨æ ˆæ¡†æ¶çš„ç†è§£"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-27T12:47:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hashan"/> <meta itemprop="url" content="https://juejin.cn/user/3523276916662526"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            elpiså…¨æ ˆæ¡†æ¶çš„ç†è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3523276916662526/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Hashan
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T12:47:17.000Z" title="Tue Jan 27 2026 12:47:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<h3 data-id="heading-1">èƒŒæ™¯</h3>
<p>åœ¨å‰ç«¯å¼€å‘åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¸¸éœ€æ­å»ºå„ç±»ä¸­åå°ç³»ç»Ÿï¼ŒåŠŸèƒ½çœ‹ä¼¼å¤šæ ·ï¼Œæ ¸å¿ƒå´å¤šä¸º CRUD é¡µé¢ã€‚è¿™ç±»é‡å¤æ€§å¼€å‘ä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œå¯¹ä¸ªäººæŠ€æœ¯èƒ½åŠ›çš„æå‡ä¹Ÿæ¯«æ— å¸®åŠ©ã€‚<br/>æ›´å…³é”®çš„æ˜¯ï¼Œå¤šæ•°ä¸­åå°ç³»ç»Ÿä»…å­˜åœ¨ç»†å¾®å·®å¼‚ â€”â€” ä»¥ç”µå•†ç³»ç»Ÿä¸ºä¾‹ï¼Œé¦–æ¬¡å¼€å‘å¯èƒ½åŒ…å«å•†å“ç®¡ç†ã€è®¢å•ç®¡ç†ã€ä¼šå‘˜ç®¡ç†ä¸ä¼˜æƒ ç®¡ç†æ¨¡å—ï¼Œè€Œåç»­éœ€è¦å¼€å‘æ–°çš„ç”µå•†ç³»ç»Ÿï¼Œå®ƒçš„éœ€æ±‚æˆ–è®¸ä»…æ–°å¢ä¸€ä¸ªåˆ†é”€ç®¡ç†æ¨¡å—ï¼ŒåŸºç¡€åŠŸèƒ½å¹¶æ— æœ¬è´¨å˜åŒ–ã€‚<br/>
æˆ‘ä»¬è¿™æ—¶å€™ï¼Œå¾€å¾€é‡æ–°å¼€å‘æˆ–å¯¹æ—§é¡¹ç›®è¿›è¡Œ â€œé­”æ”¹â€ï¼Œæ—¢æµªè´¹å¤§é‡æ—¶é—´ï¼Œåˆç¼ºä¹æŠ€æœ¯çªç ´çš„ä»·å€¼ã€‚å°¤å…¶åœ¨ AI æŠ€æœ¯é£é€Ÿå‘å±•çš„å½“ä¸‹ï¼Œè‹¥é•¿æœŸå±€é™äºè¿™ç±»ä½æŠ€æœ¯å«é‡çš„ä¸šåŠ¡å¼€å‘ï¼Œä¸ªäººç«äº‰åŠ›å¿…ç„¶ä¼šæŒç»­ä¸‹é™ã€‚</p>
<br/>
<h3 data-id="heading-2">å¦‚ä½•è§£å†³æ­¤é—®é¢˜å‘¢ï¼Ÿ</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fcb65614dbdf4350946bb91d8c76b24b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGFzaGFu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770122836&amp;x-signature=uIVfPK23r3dd5E4hqI7Hztm%2Fqac%3D" alt="image.png" loading="lazy"/></p>
<p>elpis å…¨æ ˆæ¡†æ¶é‡Œ â€”â€” é¢†åŸŸæ¨¡å‹ + BFF Serve+Dashboard æ¨¡æ¿é¡µ ä¸ºæ ¸å¿ƒï¼Œæ„å»ºä¸€å¥—å¯å¤ç”¨ã€é«˜çµæ´»çš„è§£å†³æ–¹æ¡ˆï¼Œè®©ä¸­åå°å¼€å‘ä» â€œé‡å¤CRUDâ€ è½¬å‘ â€œé…ç½®åŒ–æ­å»ºâ€ã€‚</p>
<p>é¢†åŸŸæ¨¡å‹æ˜¯æ•´ä¸ªæ–¹æ¡ˆçš„ â€œè“å›¾å¼•æ“â€ï¼šåŸºäº JSON Schema å®šä¹‰ç³»ç»Ÿæ ¸å¿ƒç»“æ„ï¼Œä¸ä»…èƒ½æè¿°åŸºç¡€åŠŸèƒ½æ¨¡å—ï¼ˆå¦‚è®¢å•ç®¡ç†ã€å•†å“ç®¡ç†ï¼‰ï¼Œè¿˜æ”¯æŒé€šè¿‡ â€œåŸºç±» + å­ç±»â€ çš„å±‚çº§è®¾è®¡æ‹“å±•ä¸ªæ€§åŒ–éœ€æ±‚ã€‚æ¯”å¦‚ç”µå•†åœºæ™¯ä¸­ï¼Œâ€œè®¢å•ç®¡ç† + å•†å“ç®¡ç†â€ å¯ä½œä¸ºé€šç”¨åŸºç±»ï¼Œç”µå•† A éœ€æ–°å¢çš„ â€œä¼˜æƒ åˆ¸ç®¡ç†â€ã€ç”µå•† B éœ€è¡¥å……çš„ â€œåˆ†é”€ç®¡ç†â€ï¼Œåˆ™å¯ä½œä¸ºå­ç±»çµæ´»æŒ‚è½½ã€‚</p>
<p>BFF Serve æ‰®æ¼” â€œæ¡¥æ¢ä¸é©±åŠ¨â€ çš„è§’è‰²ï¼šæä¾› SSR æœåŠ¡ï¼Œå®ä¾‹åŒ–é¡¹ç›®ï¼ŒAPIæ¥å£æœåŠ¡</p>
<p>Dashboard æ¨¡æ¿é¡µæ˜¯ â€œå¯è§†åŒ–å‘ˆç°ç»ˆç«¯â€ï¼šæ— éœ€å•ç‹¬å¼€å‘é¡µé¢ï¼Œåªéœ€æ¥æ”¶ BFF å±‚ä¼ é€’çš„é¢†åŸŸæ¨¡å‹é…ç½®ï¼Œå°±èƒ½è‡ªåŠ¨æ¸²æŸ“å‡ºç¬¦åˆä¸šåŠ¡éœ€æ±‚çš„ç³»ç»Ÿç•Œé¢ã€‚</p>
<p>ä¸¾ä¸ªå®é™…ä¾‹å­ï¼šæ­å»ºç”µå•† A ç³»ç»Ÿæ—¶ï¼Œæˆ‘ä»¬åªéœ€åœ¨é¢†åŸŸæ¨¡å‹ä¸­é…ç½® â€œåŸºç±»ï¼ˆè®¢å•ç®¡ç† + å•†å“ç®¡ç†ï¼‰+ å­ç±»ï¼ˆä¼˜æƒ åˆ¸ç®¡ç†ï¼‰â€ï¼›å¯åŠ¨ç³»ç»Ÿåï¼ŒBFF Serve ä¼šè¯»å–è¿™ä»½é…ç½®å¹¶åŒæ­¥ç»™ Dashboard æ¨¡æ¿é¡µï¼Œæœ€ç»ˆå‘ˆç°çš„ç”µå•† A ç³»ç»Ÿï¼Œå°±è‡ªå¸¦ â€œè®¢å•ç®¡ç† + å•†å“ç®¡ç† + ä¼˜æƒ åˆ¸ç®¡ç†â€ å…¨å¥—åŠŸèƒ½ã€‚æ­å»ºç”µå•† B ç³»ç»ŸåŒç†ï¼Œä»…éœ€è°ƒæ•´é¢†åŸŸæ¨¡å‹ä¸º â€œåŸºç±» + å­ç±»ï¼ˆåˆ†é”€ç®¡ç†ï¼‰â€ï¼Œå³å¯å¿«é€Ÿç”ŸæˆåŒ…å«åˆ†é”€åŠŸèƒ½çš„ç”µå•†ç³»ç»Ÿ â€”â€” å…¨ç¨‹æ— éœ€é‡å†™ä»£ç ï¼Œä»…é é…ç½®é¢†åŸŸæ¨¡å‹ï¼Œå°±èƒ½å®ç°ä¸­åå°ç³»ç»Ÿçš„å¿«é€Ÿæ­å»ºã€‚</p>
<h2 data-id="heading-3">é‡Œç¨‹ç¢‘ä¸€ åŸºäº nodejs å®ç°æœåŠ¡ç«¯å†…æ ¸å¼•æ“</h2>
<p>elpis å…¨æ ˆæ¡†æ¶çš„ç¬¬ä¸€æ­¥ï¼Œä¾¿æ˜¯ä»¥ Node.js æ„å»º BFF Serve å±‚ â€”â€” å¯¹æˆ‘ä»¬è€Œè¨€ï¼ŒNode.js å…·å¤‡å¤©ç„¶çš„æŠ€æœ¯é€‚é…æ€§ï¼Œä¸Šæ‰‹é—¨æ§›æ›´ä½ã€‚</p>
<p>ä½†ä¼ ç»Ÿ Node å¼€å‘ä¸­ï¼Œå›¢é˜Ÿå¸¸é™·å…¥ â€œç›®å½•ç»“æ„ä¸ç»Ÿä¸€â€â€œç¼–ç è§„èŒƒéš¾è½åœ°â€â€œä¸­é—´ä»¶ä½¿ç”¨æ— è§„åˆ™â€ çš„å›°å¢ƒï¼šè·¯ç”±è¯¥æ”¾åœ¨å“ªä¸ªç›®å½•ï¼ŸæœåŠ¡é€»è¾‘ä¸é…ç½®ç®¡ç†å¦‚ä½•æ‹†åˆ†ï¼Ÿè¿™äº›é—®é¢˜å¾€å¾€æ¶ˆè€—å¤§é‡æ²Ÿé€šæˆæœ¬ã€‚å› æ­¤ï¼Œelpis æ¡†æ¶åŸºäº Koa å°è£…äº†Â <strong>elpis-core å¼•æ“</strong>ï¼Œé€šè¿‡é¢„è®¾è§„èŒƒä¸è‡ªåŠ¨åŒ–èƒ½åŠ›ï¼ŒæŠŠå¼€å‘è€…ä»åŸºç¡€æ­å»ºä¸­è§£æ”¾å‡ºæ¥ï¼Œåªéœ€ä¸“æ³¨ä¸šåŠ¡å¼€å‘ã€‚</p>
<h4 data-id="heading-4">ä¸€ã€è§„èŒƒç›®å½•ä¸è‡ªåŠ¨åŒ–åŠ è½½</h4>
<p>elpis-core å¼•æ“ä»¥ â€œçº¦å®šä¼˜äºé…ç½®â€ ä¸ºåŸåˆ™ï¼Œå®šä¹‰äº†æ¸…æ™°çš„é¡¹ç›®ç›®å½•ç»“æ„ï¼Œæ‰€æœ‰æ¨¡å—æŒ‰åŠŸèƒ½å½’ç±»ï¼Œæ— éœ€å›¢é˜Ÿåå¤åå•†å­˜æ”¾ä½ç½®ï¼š</p>
<pre><code class="hljs language-plaintext" lang="plaintext">elpis
  |-- app/                # æ ¸å¿ƒä¸šåŠ¡ç›®å½•ï¼ˆæŒ‰çº¦å®šå­˜æ”¾ä¸šåŠ¡æ¨¡å—ï¼‰
  |   |-- controller/     # æ§åˆ¶å™¨å±‚ï¼šå¤„ç†è¯·æ±‚ã€è°ƒç”¨æœåŠ¡ã€è¿”å›å“åº”
  |   |-- extend/         # æ‰©å±•å±‚ï¼šå…¨å±€èƒ½åŠ›æ‰©å±•ï¼ˆå¦‚å·¥å…·å‡½æ•°ã€API å¢å¼ºï¼‰
  |   |-- middleware/     # ä¸­é—´ä»¶å±‚ï¼šå±€éƒ¨ä¸­é—´ä»¶ï¼ˆå¦‚æ¥å£æƒé™æ ¡éªŒï¼‰
  |   |-- public/         # é™æ€èµ„æºå±‚ï¼šå­˜æ”¾é™æ€æ–‡ä»¶
  |   |-- router/         # è·¯ç”±å±‚ï¼šå®šä¹‰â€œè¯·æ±‚è·¯å¾„â†’æ§åˆ¶å™¨â€æ˜ å°„å…³ç³»
  |   |-- router-schema/  # è·¯ç”±æ ¡éªŒå±‚ï¼šç”¨ JSON-Schema å®šä¹‰æ¥å£å‚æ•°è§„åˆ™
  |   |-- service/        # æœåŠ¡å±‚ï¼šå°è£…æ•°æ®å¤„ç†ã€ç¬¬ä¸‰æ–¹æ¥å£è°ƒç”¨ï¼ˆä¾›æ§åˆ¶å™¨å¤ç”¨ï¼‰
  |   |-- middlewares.js  # å…¨å±€ä¸­é—´ä»¶é…ç½®ï¼šæ³¨å†Œå…¨é“¾è·¯ç”Ÿæ•ˆçš„ä¸­é—´ä»¶
  |-- config/             # é…ç½®ç›®å½•ï¼šåŒºåˆ†æœ¬åœ°/æµ‹è¯•/ç”Ÿäº§ç¯å¢ƒçš„å·®å¼‚åŒ–é…ç½®
  |-- elpis-core/         # å¼•æ“å†…æ ¸ï¼šæä¾›è‡ªåŠ¨åŠ è½½ã€ç¯å¢ƒé€‚é…ç­‰æ ¸å¿ƒèƒ½åŠ›
  |   |-- loader/         # åŠ è½½å™¨é›†åˆï¼šå¯¹åº”å„æ¨¡å—çš„è‡ªåŠ¨åŒ–åŠ è½½é€»è¾‘
  |   |   |-- config.js   # é…ç½®åŠ è½½å™¨ï¼šè‡ªåŠ¨åŠ è½½ config ç›®å½•ä¸‹çš„ç¯å¢ƒé…ç½®
  |   |   |-- controller.js # æ§åˆ¶å™¨åŠ è½½å™¨ï¼šè‡ªåŠ¨åŠ è½½ controller æ¨¡å—å¹¶æŒ‚è½½
  |   |   |-- extend.js   # æ‰©å±•åŠ è½½å™¨ï¼šè‡ªåŠ¨åŠ è½½ extend å±‚çš„å…¨å±€èƒ½åŠ›
  |   |   |-- middleware.js # ä¸­é—´ä»¶åŠ è½½å™¨ï¼šè‡ªåŠ¨åŠ è½½ middleware æ¨¡å—
  |   |   |-- router-schema.js # è·¯ç”±æ ¡éªŒåŠ è½½å™¨ï¼šè‡ªåŠ¨åŠ è½½æ¥å£å‚æ•°æ ¡éªŒè§„åˆ™
  |   |   |-- router.js   # è·¯ç”±åŠ è½½å™¨ï¼šè‡ªåŠ¨åŠ è½½è·¯ç”±æ˜ å°„å…³ç³»
  |   |   |-- service.js  # æœåŠ¡åŠ è½½å™¨ï¼šè‡ªåŠ¨åŠ è½½ service å±‚çš„ä¸šåŠ¡é€»è¾‘
  |   |-- env.js          # ç¯å¢ƒåˆ¤æ–­å·¥å…·ï¼šå¿«é€ŸåŒºåˆ†æœ¬åœ°/æµ‹è¯•/ç”Ÿäº§ç¯å¢ƒ
  |   |-- index.js        # å¼•æ“å…¥å£ï¼šæ•´åˆæ‰€æœ‰åŠ è½½å™¨ã€åˆå§‹åŒ– Koa å®ä¾‹
  |-- index.js            # é¡¹ç›®å…¥å£ï¼šä¸€é”®å¯åŠ¨ elpis å¼•æ“
</code></pre>
<p>å…¶ä¸­ï¼Œ<strong>åŠ è½½å™¨ï¼ˆloaderï¼‰</strong> Â æ˜¯è‡ªåŠ¨åŒ–çš„æ ¸å¿ƒï¼šæ¯ä¸ªæ¨¡å—ï¼ˆå¦‚ controllerã€serviceã€routerï¼‰éƒ½å¯¹åº”ä¸“å±åŠ è½½å™¨ï¼ŒåŠ è½½å™¨ä¼šä¸»åŠ¨éå†ç›®æ ‡ç›®å½•ã€è§£ææ–‡ä»¶å†…å®¹ï¼Œå¹¶å°†æ¨¡å—è‡ªåŠ¨æŒ‚è½½åˆ° Koa å®ä¾‹ä¸Šã€‚ä»¥æ§åˆ¶å™¨åŠ è½½ä¸ºä¾‹ï¼Œæ•´ä¸ªæµç¨‹å®Œå…¨æ— éœ€æ‰‹åŠ¨å¹²é¢„ï¼š</p>
<ol>
<li>è¯»å–Â <code>elpis/app/controller/**/*.js</code>Â ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼›</li>
<li>æå–æ–‡ä»¶åç§°ä¸è·¯å¾„ï¼Œå¦‚Â <code>app/controller/custom-module/custom-controller.js</code>ï¼›</li>
<li>æˆªå–è·¯å¾„æ ¸å¿ƒéƒ¨åˆ†ï¼Œå¾—åˆ°Â <code>custom-module/custom-controller</code>ï¼›</li>
<li>å°†è·¯å¾„ä¸­çš„ â€œ-â€ è½¬ä¸ºé©¼å³°å¼å‘½åï¼Œå³Â <code>customModule.customController</code>ï¼›</li>
<li>è‡ªåŠ¨æŒ‚è½½åˆ°å†…å­˜Â <code>app</code>Â å¯¹è±¡ä¸­</li>
</ol>
<h4 data-id="heading-5">ä»å¯åŠ¨åˆ°è¯·æ±‚çš„å…¨é“¾è·¯ä¼˜åŒ–</h4>
<p>å›ºå®šå¯åŠ¨é¡ºåºï¼Œé¿å…æ¨¡å—ä¾èµ–æ··ä¹±</p>
<p>elpis-core å¼•æ“å®šä¹‰äº†ä¸¥æ ¼çš„æ¨¡å—å¯åŠ¨é¡ºåºï¼Œç¡®ä¿å„æ¨¡å—æŒ‰ä¾èµ–å…³ç³»åŠ è½½ï¼Œé¿å… â€œæœªå®šä¹‰â€ é”™è¯¯ï¼š</p>
<pre><code class="hljs language-plaintext" lang="plaintext">é…ç½®ç¯å¢ƒ â†’ åŠ è½½é…ç½® â†’ æ‰©å±•åŠ è½½ â†’ ä¸­é—´ä»¶åŠ è½½ â†’ æœåŠ¡åŠ è½½ â†’ æ§åˆ¶å™¨åŠ è½½ â†’ å…¨å±€ä¸­é—´ä»¶æ³¨å†Œ â†’ è·¯ç”±æ¨¡å¼åŠ è½½ â†’ è·¯ç”±æ³¨å†Œ
</code></pre>
<p>ä»ç¯å¢ƒåˆ¤æ–­åˆ°è·¯ç”±ç”Ÿæ•ˆï¼Œæ¯ä¸€æ­¥éƒ½ç”±å¼•æ“è‡ªåŠ¨æ‰§è¡Œï¼Œå¼€å‘è€…æ— éœ€æ‰‹åŠ¨ç®¡ç†åŠ è½½é¡ºåºã€‚</p>
<h4 data-id="heading-6">ç¯å¢ƒä¸è·¯ç”±çš„ç²¾ç»†åŒ–ç®¡ç†</h4>
<ul>
<li><strong>ç¯å¢ƒé…ç½®</strong>ï¼šé€šè¿‡Â <code>elpis-core/env.js</code>Â å®ç°ç¯å¢ƒå˜é‡ç»Ÿä¸€ç®¡ç†ï¼Œå¯å¿«é€ŸåŒºåˆ†æœ¬åœ°å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒï¼Œé…ç½®æ–‡ä»¶æŒ‰ç¯å¢ƒæ‹†åˆ†åï¼ŒåŠ è½½å™¨ä¼šè‡ªåŠ¨åŒ¹é…å½“å‰ç¯å¢ƒå¹¶åŠ è½½å¯¹åº”é…ç½®ï¼›</li>
<li><strong>è·¯ç”±ç®¡ç†</strong>ï¼šç»“åˆ JSON-Schema å®šä¹‰è·¯ç”±å‚æ•°è§„åˆ™ï¼Œä¸ä»…èƒ½è‡ªåŠ¨æ ¡éªŒè¯·æ±‚å‚æ•°åˆæ³•æ€§ï¼Œè¿˜èƒ½è®©æ¥å£æ–‡æ¡£ä¸ä»£ç é€»è¾‘ä¿æŒä¸€è‡´ï¼Œå‡å°‘ â€œæ–‡æ¡£ä¸å®é™…æ¥å£ä¸åŒ¹é…â€ çš„é—®é¢˜ï¼›</li>
<li><strong>è¯·æ±‚å“åº”é“¾è·¯</strong>ï¼šé€šè¿‡ â€œè·¯ç”±â†’æ§åˆ¶å™¨â†’æœåŠ¡â†’ä¸­é—´ä»¶â€ çš„é“¾è·¯è®¾è®¡ï¼Œå®ç°è¯·æ±‚å¤„ç†çš„è§£è€¦ï¼šè·¯ç”±è´Ÿè´£æ˜ å°„è·¯å¾„ï¼Œæ§åˆ¶å™¨è´Ÿè´£è¯·æ±‚åˆ†å‘ï¼ŒæœåŠ¡è´Ÿè´£ä¸šåŠ¡é€»è¾‘ï¼Œä¸­é—´ä»¶è´Ÿè´£é€šç”¨èƒ½åŠ›ï¼ˆå¦‚æƒé™æ ¡éªŒã€æ—¥å¿—è®°å½•ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-7">å¯æ‰©å±•çš„ç”Ÿæ€èƒ½åŠ›</h4>
<p>elpis-core å¼•æ“æ”¯æŒè‡ªå®šä¹‰æ’ä»¶ä¸åŠŸèƒ½æ‰©å±•ï¼š</p>
<ul>
<li><strong>æ’ä»¶æœºåˆ¶</strong>ï¼šå¯æ¥å…¥å¤šä¸ªè‡ªå®šä¹‰æ’ä»¶ï¼Œæ»¡è¶³ä¸ªæ€§åŒ–ä¸šåŠ¡éœ€æ±‚ï¼ˆå¦‚æ—¥å¿—æ’ä»¶ã€ç›‘æ§æ’ä»¶ï¼‰ï¼›</li>
<li><strong>åŠŸèƒ½æ‰©å±•</strong>ï¼šé€šè¿‡Â <code>extend</code>Â å±‚å¯æ‰©å±•å…¨å±€èƒ½åŠ›ï¼Œå¦‚æ–°å¢å·¥å…·å‡½æ•°ã€å¢å¼º API å“åº”æ ¼å¼ç­‰ï¼Œæ‰©å±•å†…å®¹ç”±åŠ è½½å™¨è‡ªåŠ¨ç”Ÿæ•ˆï¼Œæ— éœ€ä¿®æ”¹å¼•æ“æ ¸å¿ƒä»£ç ã€‚</li>
</ul>
<h2 data-id="heading-8">é‡Œç¨‹ç¢‘äºŒ åŸºäº webpack5 å®Œæˆå·¥ç¨‹åŒ–å»ºè®¾</h2>
<p>ä½œä¸º elpis å…¨æ ˆæ¡†æ¶çš„ç¬¬äºŒæ­¥ï¼Œæœ¬é˜¶æ®µæ ¸å¿ƒæ˜¯ä¸ºå‰ç«¯ Dashboard æ¨¡æ¿é¡µæ­å»ºå·¥ç¨‹åŒ–åŸºç¡€ï¼Œé€šè¿‡æ‹†åˆ† webpack é…ç½®å®ç° â€œç¯å¢ƒå·®å¼‚åŒ–æ„å»ºâ€ï¼ŒåŒæ—¶é€‚é…æœåŠ¡ç«¯æ¸²æŸ“ä¸ Vue3 æŠ€æœ¯æ ˆéœ€æ±‚ã€‚</p>
<h4 data-id="heading-9">ä¸€ã€é…ç½®æ‹†åˆ†ï¼šæŒ‰ç¯å¢ƒè§£è€¦ï¼Œå…¼é¡¾å¼€å‘ä¸ç”Ÿäº§</h4>
<p>å°† webpack é…ç½®æ‹†åˆ†ä¸ºä¸‰ç±»ï¼Œé€šè¿‡Â <code>dev.js</code>Â å’ŒÂ <code>prod.js</code>Â åˆ†åˆ«è°ƒç”¨ï¼Œå®ç°ä¸åŒç¯å¢ƒçš„è‡ªåŠ¨åŒ–æ„å»ºï¼š</p>
<ul>
<li><strong><code>webpack.base.js</code></strong>ï¼šåŸºç¡€é…ç½®ï¼ˆåŸºç±»ï¼‰ï¼Œå®šä¹‰å…¥å£ã€loaderã€æ’ä»¶ã€åˆ†åŒ…ç­–ç•¥ç­‰é€šç”¨é€»è¾‘ï¼Œé¿å…é‡å¤ç¼–ç ï¼›</li>
<li><strong><code>webpack.dev.js</code></strong>ï¼šå¼€å‘ç¯å¢ƒé…ç½®ï¼Œä¾§é‡çƒ­æ›´æ–°ï¼ˆHMRï¼‰ã€SourceMap ç­‰æå‡å¼€å‘æ•ˆç‡çš„èƒ½åŠ›ï¼›</li>
<li><strong><code>webpack.prod.js</code></strong>ï¼šç”Ÿäº§ç¯å¢ƒé…ç½®ï¼Œèšç„¦æ‰“åŒ…ä¼˜åŒ–ï¼ˆå¤šçº¿ç¨‹ã€èµ„æºå‹ç¼©ã€ç¼“å­˜æ¸…ç†ï¼‰ï¼Œä¿éšœçº¿ä¸Šæ€§èƒ½ã€‚</li>
</ul>
<h4 data-id="heading-10">äºŒã€æ ¸å¿ƒé…ç½®å®ç°ï¼šä»å…¥å£åˆ°ä¼˜åŒ–çš„å…¨é“¾è·¯é€‚é…</h4>
<h5 data-id="heading-11">1. åŸºç¡€é…ç½®ï¼ˆwebpack.base.jsï¼‰ï¼šé€‚é…æœåŠ¡ç«¯æ¸²æŸ“çš„æ ¸å¿ƒé€»è¾‘</h5>
<p>ï¼ˆ1ï¼‰å…¥å£å¤„ç†ï¼šåŠ¨æ€è¯†åˆ«å¤šé¡µé¢å…¥å£</p>
<p>åŒºåˆ«äºæ™®é€šå‰ç«¯é¡¹ç›®çš„å›ºå®šå…¥å£ï¼Œæ¡†æ¶é€šè¿‡ glob åŒ¹é…Â <code>app/pages/**/entry.*.js</code>ï¼ˆå¦‚Â <code>entry.dashboard.js</code>ï¼‰ï¼Œè‡ªåŠ¨ç”Ÿæˆå…¥å£é…ç½®ä¸ HTML æ¨¡æ¿ï¼Œé€‚é…æœåŠ¡ç«¯æ¸²æŸ“åœºæ™¯ï¼ˆç”¨æˆ·è®¿é—®Â <code>http://ip:port/view/xxxx</code>Â æ—¶ï¼ŒæœåŠ¡ç«¯è¿”å›ä¸»é¡µé¢ï¼Œå…¶ä»–é¡µé¢ç”± Vue Router æ¸²æŸ“ï¼‰ï¼š</p>
<p>js</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// 1. åŒ¹é…æ‰€æœ‰ entry.xx.js å…¥å£æ–‡ä»¶</span>
<span class="hljs-selector-tag">const</span> <span class="hljs-selector-tag">elpisEntryList</span> = <span class="hljs-selector-tag">path</span><span class="hljs-selector-class">.resolve</span>(__dirname, <span class="hljs-string">"../../pages/**/entry.*.js"</span>);
<span class="hljs-comment">// 2. æ„é€ å…¥å£ä¸ HTML æ¨¡æ¿</span>
<span class="hljs-selector-tag">glob</span><span class="hljs-selector-class">.sync</span>(elpisEntryList)<span class="hljs-selector-class">.forEach</span>(file =&gt; {
  <span class="hljs-selector-tag">const</span> <span class="hljs-selector-tag">entryName</span> = <span class="hljs-selector-tag">path</span><span class="hljs-selector-class">.basename</span>(file, <span class="hljs-string">".js"</span>);
  <span class="hljs-comment">// å…¥å£é…ç½®ï¼škey ä¸ºå…¥å£åï¼Œvalue ä¸ºæ–‡ä»¶è·¯å¾„</span>
  <span class="hljs-selector-tag">elpisPageEntries</span><span class="hljs-selector-attr">[entryName]</span> = <span class="hljs-selector-tag">file</span>;
  <span class="hljs-comment">// HTML æ¨¡æ¿ï¼šæŒ‡å®šè¾“å‡ºè·¯å¾„ã€æ¨¡æ¿æ–‡ä»¶ä¸æ³¨å…¥çš„ä»£ç å—</span>
  <span class="hljs-selector-tag">elpisHtmlWebpackPluginList</span><span class="hljs-selector-class">.push</span>(new <span class="hljs-built_in">HtmlWebpackPlugin</span>({
    <span class="hljs-attribute">filename</span>: path.<span class="hljs-built_in">resolve</span>(process.<span class="hljs-built_in">cwd</span>(), <span class="hljs-string">"./app/public/dist/"</span>, <span class="hljs-built_in">`.tpl`</span>),
    <span class="hljs-attribute">template</span>: path.<span class="hljs-built_in">resolve</span>(__dirname, <span class="hljs-string">"../../view/entry.tpl"</span>),
    <span class="hljs-attribute">chunks</span>: [entryName]
  }));
});
<span class="hljs-comment">// æœ€ç»ˆå…¥å£é…ç½®</span>
<span class="hljs-selector-tag">entry</span>: <span class="hljs-selector-tag">elpisPageEntries</span>,
</code></pre>
<p>ï¼ˆ2ï¼‰loader é…ç½®ï¼šé€‚é… Vue3 + Less æŠ€æœ¯æ ˆ</p>
<p>é’ˆå¯¹ Vue å•æ–‡ä»¶ç»„ä»¶ã€ES6 è¯­æ³•ã€æ ·å¼ä¸é™æ€èµ„æºï¼Œé…ç½®ä¸“å± loaderï¼Œç¡®ä¿ä»£ç æ­£å¸¸è§£æï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">rules</span>: [
  { <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.vue$/</span>, <span class="hljs-attr">use</span>: <span class="hljs-string">"vue-loader"</span> }, <span class="hljs-comment">// è§£æ Vue æ–‡ä»¶</span>
  { <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.js$/</span>, <span class="hljs-attr">include</span>: [pagesç›®å½•], <span class="hljs-attr">use</span>: <span class="hljs-string">"babel-loader"</span> }, <span class="hljs-comment">// è½¬è¯‘ ES6</span>
  { <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.(png|jpg|gif)$/</span>, <span class="hljs-attr">use</span>: { <span class="hljs-attr">loader</span>: <span class="hljs-string">"url-loader"</span>, <span class="hljs-attr">options</span>: { <span class="hljs-attr">limit</span>: <span class="hljs-number">300</span> } } }, <span class="hljs-comment">// å°å›¾è½¬ base64</span>
  { <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.css$/</span>, <span class="hljs-attr">use</span>: [<span class="hljs-string">"style-loader"</span>, <span class="hljs-string">"css-loader"</span>] }, <span class="hljs-comment">// è§£æ CSS</span>
  { <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.less$/</span>, <span class="hljs-attr">use</span>: [<span class="hljs-string">"style-loader"</span>, <span class="hljs-string">"css-loader"</span>, <span class="hljs-string">"less-loader"</span>] }, <span class="hljs-comment">// è§£æ Less</span>
  { <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.(eot|woff|woff2|svg|ttf)$/</span>, <span class="hljs-attr">use</span>: <span class="hljs-string">"file-loader"</span> } <span class="hljs-comment">// è§£æå­—ä½“</span>
]
</code></pre>
<p>ï¼ˆ3ï¼‰æ’ä»¶ä¸ä¼˜åŒ–ï¼šä¿éšœåŸºç¡€åŠŸèƒ½ä¸æ€§èƒ½</p>
<ul>
<li>
<p><strong>æ’ä»¶</strong>ï¼šé…ç½®Â <code>VueLoaderPlugin</code>ï¼ˆè§£æ Vue ç»„ä»¶ï¼‰ã€<code>DefinePlugin</code>ï¼ˆå®šä¹‰ Vue å…¨å±€å¸¸é‡ï¼Œå¦‚ç¦ç”¨ç”Ÿäº§ç¯å¢ƒè°ƒè¯•å·¥å…·ï¼‰ï¼Œå¹¶æ³¨å…¥åŠ¨æ€ç”Ÿæˆçš„ HTML æ¨¡æ¿ï¼›</p>
</li>
<li>
<p><strong>åˆ†åŒ…ç­–ç•¥</strong>ï¼šé€šè¿‡Â <code>splitChunks</code>Â å°†ä»£ç åˆ†ä¸ºä¸‰ç±»ï¼Œåˆ©ç”¨æµè§ˆå™¨ç¼“å­˜å‡å°‘é‡å¤åŠ è½½ï¼š</p>
<ul>
<li><code>vendor</code>ï¼šç¬¬ä¸‰æ–¹ä¾èµ–ï¼ˆå¦‚ Vueã€Vue Routerï¼‰ï¼Œæ”¹åŠ¨é¢‘ç‡ä½ï¼›</li>
<li><code>common</code>ï¼šä¸šåŠ¡å…¬å…±ç»„ä»¶ï¼ˆå¦‚Â <code>common</code>/<code>widgets</code>Â ç›®å½•ï¼‰ï¼Œè¢«å¼•ç”¨ â‰¥2 æ¬¡å³æŠ½å–ï¼›</li>
<li><code>entry.{page}</code>ï¼šé¡µé¢ç§æœ‰ä¸šåŠ¡ä»£ç ï¼Œæ”¹åŠ¨é¢‘ç‡é«˜ã€‚</li>
</ul>
</li>
</ul>
<h5 data-id="heading-12">2. å¼€å‘ç¯å¢ƒé…ç½®ï¼ˆwebpack.dev.jsï¼‰ï¼šèšç„¦å¼€å‘æ•ˆç‡</h5>
<p>æ ¸å¿ƒå®ç°ä¸‰é¡¹èƒ½åŠ›ï¼š</p>
<ul>
<li><strong>HMR çƒ­æ›´æ–°</strong>ï¼šåœ¨å…¥å£ä¸­æ³¨å…¥ HMR å®¢æˆ·ç«¯ï¼Œç»“åˆÂ <code>HotModuleReplacementPlugin</code>ï¼Œå®ç°ä»£ç æ”¹åŠ¨åå±€éƒ¨æ›´æ–°ï¼Œæ— éœ€åˆ·æ–°é¡µé¢ï¼›</li>
<li><strong>SourceMap</strong>ï¼šé…ç½®Â <code>eval-cheap-module-source-map</code>ï¼Œå¿«é€Ÿå®šä½é”™è¯¯ä¸”ä¿éšœæ„å»ºé€Ÿåº¦ï¼›</li>
<li><strong>è¾“å‡ºè§„èŒƒ</strong>ï¼šæŒ‡å®šå¼€å‘ç¯å¢ƒè¾“å‡ºç›®å½•ï¼ˆ<code>./app/public/dist/dev/</code>ï¼‰ï¼Œç»Ÿä¸€èµ„æºè·¯å¾„æ ¼å¼ã€‚</li>
</ul>
<h5 data-id="heading-13">3. ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼ˆwebpack.prod.jsï¼‰ï¼šèšç„¦çº¿ä¸Šæ€§èƒ½</h5>
<p>é€šè¿‡å¤šæ’ä»¶ç»„åˆå®ç°ä¼˜åŒ–ï¼š</p>
<ul>
<li><strong>å¤šçº¿ç¨‹æ‰“åŒ…</strong>ï¼šä½¿ç”¨Â <code>HappyPack</code>Â å¼€å¯å¤šçº¿ç¨‹ï¼ˆçº¿ç¨‹æ•° = CPU æ ¸å¿ƒæ•°ï¼‰ï¼Œå¹¶è¡Œå¤„ç† JS ä¸ CSSï¼Œæå‡æ‰“åŒ…é€Ÿåº¦ï¼›</li>
<li><strong>èµ„æºå‹ç¼©</strong>ï¼š<code>TerserWebpackPlugin</code>Â å‹ç¼© JSï¼ˆåˆ é™¤Â <code>console.log</code>ï¼‰ã€<code>CSSMinimizerPlugin</code>Â å‹ç¼© CSSï¼Œå‡å°‘èµ„æºä½“ç§¯ï¼›</li>
<li><strong>ç¼“å­˜æ¸…ç†</strong>ï¼š<code>CleanWebpackPlugin</code>Â æ‰“åŒ…å‰æ¸…ç©ºÂ <code>public/dist</code>Â ç›®å½•ï¼Œé¿å…æ—§èµ„æºæ®‹ç•™ï¼›</li>
<li><strong>CSS æå–</strong>ï¼š<code>MiniCssExtractPlugin</code>Â å°† CSS ä» JS ä¸­æå–ä¸ºå•ç‹¬æ–‡ä»¶ï¼Œæ”¯æŒç¼“å­˜å¤ç”¨ã€‚</li>
</ul>
<h4 data-id="heading-14">ä¸‰ã€é¡µé¢å…¥å£é€»è¾‘ï¼šè¡”æ¥ Vue åº”ç”¨åˆå§‹åŒ–</h4>
<p>æ¡†æ¶çº¦å®šÂ <code>app/pages</code>Â ç›®å½•ä¸‹çš„æ ¸å¿ƒæ–‡ä»¶ï¼Œå®ç° Vue åº”ç”¨çš„è‡ªåŠ¨åŒ–æŒ‚è½½ï¼š</p>
<ul>
<li><strong><code>boot.js</code></strong>ï¼šç±»æ¯”æ™®é€š Vue é¡¹ç›®çš„Â <code>main.js</code>ï¼Œè´Ÿè´£åˆå§‹åŒ– Vue å®ä¾‹ï¼›</li>
<li><strong><code>entry.dashboard.js</code></strong>ï¼ˆå¦‚Â <code>app/pages/dashboard/</code>Â ä¸‹ï¼‰ï¼šèšåˆè·¯ç”±é…ç½®ä¸å¾…æŒ‚è½½ç»„ä»¶ï¼Œè°ƒç”¨Â <code>boot(dashboard, { routes })</code>Â å®Œæˆåº”ç”¨å¯åŠ¨ã€‚</li>
</ul>
<h2 data-id="heading-15">é‡Œç¨‹ç¢‘ä¸‰  åŸºäº vue3 å®Œæˆé¢†åŸŸæ¨¡å‹æ¶æ„å»ºè®¾</h2>
<p>ä½œä¸º elpis å…¨æ ˆæ¡†æ¶è§£å†³å‰ç«¯ CRUD é‡å¤å¼€å‘çš„æ ¸å¿ƒç¯èŠ‚ï¼Œæœ¬é˜¶æ®µèšç„¦ â€œ<strong>ç”¨é…ç½®é©±åŠ¨é¡µé¢</strong>â€â€”â€” åŸºäºé¢†åŸŸæ¨¡å‹ DSL ä¸ JSON Schema å®šä¹‰é¡µé¢ç»“æ„ï¼Œè®©ä¸­åå°ç³»ç»Ÿä» â€œæ‰‹åŠ¨ç¼–ç å¼€å‘â€ è½¬å‘ â€œé…ç½®åŒ–æ¸²æŸ“â€ï¼Œå½»åº•æ‘†è„±é‡å¤ç¼–å†™ CRUD é¡µé¢çš„ä½æ•ˆæ¨¡å¼ã€‚</p>
<h2 data-id="heading-16">ä¸€ã€æ ¸å¿ƒé€‰æ‹©ï¼šä¸ºä½•ç”¨ JSON Schema æ‰¿è½½é¢†åŸŸæ¨¡å‹ï¼Ÿ</h2>
<p>é€‰æ‹© JSON Schema ä½œä¸ºé¢†åŸŸæ¨¡å‹çš„é…ç½®æ ¼å¼ï¼Œæ ¸å¿ƒæºäºå…¶ä¸‰å¤§ä¼˜åŠ¿ï¼š</p>
<ol>
<li><strong>é¢†åŸŸé€‚é…æ€§å¼º</strong>ï¼šä½œä¸ºç‰¹å®šé¢†åŸŸçš„æ ‡å‡† JSON æ ¼å¼ï¼Œå¯ç²¾å‡†æè¿°ä¸­åå°é¡µé¢çš„ â€œå­—æ®µå±æ€§ã€äº¤äº’é€»è¾‘ã€ç»„ä»¶å…³è”â€ï¼Œæ¯”å¦‚ä¸€ä¸ª â€œå•†å“ä»·æ ¼â€ å­—æ®µï¼Œèƒ½åŒæ—¶å®šä¹‰å…¶æ•°æ®ç±»å‹ï¼ˆnumberï¼‰ã€æ ¡éªŒè§„åˆ™ï¼ˆ30â‰¤ä»·æ ¼â‰¤1000ï¼‰ã€è¡¨æ ¼å±•ç¤ºæ ¼å¼ï¼ˆä¿ç•™ 2 ä½å°æ•°ï¼‰ã€è¡¨å•ç»„ä»¶ç±»å‹ï¼ˆæ•°å­—è¾“å…¥æ¡†ï¼‰ï¼›</li>
<li><strong>æ ¡éªŒèƒ½åŠ›å®Œå–„</strong>ï¼šå¯ç»“åˆ AJVï¼ˆAnother JSON Schema Validatorï¼‰å·¥å…·ï¼Œè‡ªåŠ¨æ ¡éªŒå‰ç«¯è¾“å…¥æ•°æ®ä¸åç«¯è¿”å›æ•°æ®çš„åˆæ³•æ€§ï¼Œå‡å°‘æ‰‹åŠ¨ç¼–å†™æ ¡éªŒé€»è¾‘çš„å·¥ä½œé‡ï¼›</li>
<li><strong>æ‰©å±•æ€§çµæ´»</strong>ï¼šæ”¯æŒåµŒå¥—é…ç½®ã€æ¡ä»¶æ¸²æŸ“ç­‰å¤æ‚åœºæ™¯ï¼Œæ—¢èƒ½è¦†ç›–åŸºç¡€ CRUD é¡µé¢ï¼Œä¹Ÿèƒ½é€‚é…å¸¦ä¸ªæ€§åŒ–äº¤äº’çš„å®šåˆ¶é¡µé¢ï¼Œæ— éœ€ä¿®æ”¹æ¡†æ¶æ ¸å¿ƒé€»è¾‘ã€‚</li>
</ol>
<h2 data-id="heading-17">äºŒã€é¢†åŸŸæ¨¡å‹æ¶æ„ï¼šé¡µé¢çš„ â€œé…ç½®åŒ–è“å›¾â€</h2>
<p>elpis æ¡†æ¶é€šè¿‡ JSON Schema å°†ä¸­åå°ç³»ç»Ÿæ‹†è§£ä¸º â€œå¯¼èˆªèœå• + åŠ¨æ€é¡µé¢â€ ä¸¤å¤§æ ¸å¿ƒæ¿å—ï¼Œæ¯ä¸ªæ¿å—çš„åŠŸèƒ½ä¸äº¤äº’å‡ç”±é…ç½®å®šä¹‰ï¼Œæ— éœ€ç¼–å†™é‡å¤ä»£ç ï¼š</p>
<h3 data-id="heading-18">1. æ•´ä½“æ¶æ„æ‹†è§£</h3>
<ul>
<li>
<p><strong>å¯¼èˆªèœå•</strong>ï¼šå®šä¹‰ç³»ç»Ÿçš„æ¨¡å—ç»“æ„ï¼Œæ”¯æŒå¤šçº§èœå•ï¼ˆå¦‚ â€œå•†å“ç®¡ç†â€â€œè®¢å•ç®¡ç†â€ï¼‰ï¼Œå¹¶å…³è”å¯¹åº”çš„é¡µé¢ç±»å‹ï¼ˆSchema æ¸²æŸ“é¡µ /iframe åµŒå…¥é¡µ / è‡ªå®šä¹‰é¡µï¼‰ï¼›</p>
</li>
<li>
<p><strong>åŠ¨æ€é¡µé¢</strong>ï¼šåˆ†ä¸ºä¸‰ç±»æ ¸å¿ƒé¡µé¢ï¼Œè¦†ç›–ä¸­åå° 90% ä»¥ä¸Šçš„åœºæ™¯ï¼š</p>
<ul>
<li><strong>schema-view</strong>ï¼šæ ¸å¿ƒ CRUD é¡µé¢ï¼Œç”± â€œæœç´¢æ ï¼ˆsearch-barï¼‰+ è¡¨æ ¼ï¼ˆtableï¼‰â€ ç»„æˆï¼Œè¡¨æ ¼å…³è” â€œæ–°å¢ / ç¼–è¾‘ / è¯¦æƒ… / åˆ é™¤â€ ç­‰å¼¹çª—äº¤äº’ï¼›</li>
<li><strong>iframe</strong>ï¼šåµŒå…¥å¤–éƒ¨é¡µé¢ï¼ˆå¦‚ç¬¬ä¸‰æ–¹æ•°æ®æŠ¥è¡¨ã€æ—§ç³»ç»Ÿé¡µé¢ï¼‰ï¼Œä»…éœ€é…ç½®åµŒå…¥è·¯å¾„ï¼›</li>
<li><strong>custom</strong>ï¼šç”¨æˆ·è‡ªå®šä¹‰é¡µé¢ï¼Œæ”¯æŒå…³è”è‡ªå®šä¹‰ Vue ç»„ä»¶è·¯å¾„ï¼Œæ»¡è¶³ç‰¹æ®Šäº¤äº’éœ€æ±‚ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-19">2. æ ¸å¿ƒé…ç½®ç¤ºä¾‹ï¼ˆä»¥ç”µå•†ç³»ç»Ÿ â€œå•†å“ç®¡ç†â€ ä¸ºä¾‹ï¼‰</h3>
<p>é€šè¿‡ä¸€ä»½ JSON é…ç½®ï¼Œå¯å®Œæ•´å®šä¹‰ â€œå•†å“ç®¡ç†â€ æ¨¡å—çš„èœå•ã€è¡¨æ ¼å­—æ®µã€æœç´¢ç»„ä»¶ã€è¡¨å•äº¤äº’ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<p>js</p>
<pre><code class="hljs language-css" lang="css">module<span class="hljs-selector-class">.exports</span> = {
  model: <span class="hljs-string">'dashboard'</span>,       // æ¨¡å‹æ ‡è¯†ï¼Œå…³è”ç³»ç»Ÿæ•´ä½“é…ç½®
  name: <span class="hljs-string">'ç”µå•†ç³»ç»Ÿ'</span>,         // ç³»ç»Ÿåç§°ï¼Œç”¨äºé¡µé¢æ ‡é¢˜å±•ç¤º
  menu: [                   // å¯¼èˆªèœå•é…ç½®
    {
      key: <span class="hljs-string">'product'</span>,       // èœå•å”¯ä¸€æ ‡è¯†
      name: <span class="hljs-string">'å•†å“ç®¡ç†'</span>,     // èœå•æ˜¾ç¤ºåç§°
      menuType: <span class="hljs-string">'module'</span>,   // èœå•ç±»å‹ï¼ˆæ¨¡å—çº§ï¼‰
      moduleType: <span class="hljs-string">'schema'</span>, // é¡µé¢ç±»å‹ï¼ˆSchema æ¸²æŸ“é¡µï¼‰
      schemaConfig: {       // Schema é¡µé¢æ ¸å¿ƒé…ç½®
        api: <span class="hljs-string">'/api/proj/product'</span>, // CRUD æ¥å£åœ°å€ï¼ˆå¢åˆ æ”¹æŸ¥ç»Ÿä¸€å…³è”ï¼‰
        schema: {           // å­—æ®µå±æ€§å®šä¹‰ï¼ˆè¦†ç›–è¡¨æ ¼ã€è¡¨å•ã€æœç´¢æ ï¼‰
          type: <span class="hljs-string">'object'</span>,
          properties: {
            // å•†å“IDï¼šè¡¨æ ¼å±•ç¤ºã€ç¼–è¾‘æ—¶ç¦ç”¨è¾“å…¥
            product_id: {
              type: <span class="hljs-string">'string'</span>,
              label: <span class="hljs-string">'å•†å“ID'</span>,
              tableOption: { <span class="hljs-attribute">width</span>: <span class="hljs-number">300</span>, <span class="hljs-string">'show-overflow-tooltip'</span>: true },
              editFormOption: { comType: <span class="hljs-string">'input'</span>, disabled: true }
            },
            // å•†å“åç§°ï¼šæ”¯æŒåŠ¨æ€ä¸‹æ‹‰æœç´¢ã€è¡¨å•è¾“å…¥æ ¡éªŒï¼ˆ<span class="hljs-number">3</span>-<span class="hljs-number">20</span>å­—ï¼‰
            product_name: {
              type: <span class="hljs-string">'string'</span>,
              label: <span class="hljs-string">'å•†å“åç§°'</span>,
              maxLength: <span class="hljs-number">20</span>,
              minLength: <span class="hljs-number">3</span>,
              searchOption: { comType: <span class="hljs-string">'dynamicSelect'</span>, api: <span class="hljs-string">'/api/proj/product_enum/list'</span> },
              createFormOption: { comType: <span class="hljs-string">'input'</span>, default: <span class="hljs-string">'å“²ç„æ–°è¯¾ç¨‹'</span> }
            },
            // ä»·æ ¼ï¼šæ•°å€¼èŒƒå›´æ ¡éªŒï¼ˆ<span class="hljs-number">30</span>-<span class="hljs-number">1000</span>ï¼‰ã€è¡¨æ ¼ä¿ç•™<span class="hljs-number">2</span>ä½å°æ•°ã€ä¸‹æ‹‰æœç´¢
            price: {
              type: <span class="hljs-string">'number'</span>,
              label: <span class="hljs-string">'ä»·æ ¼'</span>,
              maximum: <span class="hljs-number">1000</span>,
              minimum: <span class="hljs-number">30</span>,
              tableOption: { <span class="hljs-attribute">width</span>: <span class="hljs-number">200</span>, toFixed: <span class="hljs-number">2</span> },
              searchOption: { comType: <span class="hljs-string">'select'</span>, enumList: [{ <span class="hljs-selector-tag">label</span>: <span class="hljs-string">'ï¿¥39.0'</span>, value: <span class="hljs-number">39.0</span> }, ...] },
              createFormOption: { comType: <span class="hljs-string">'inputNumber'</span> }
            },
            // å…¶ä»–å­—æ®µï¼ˆåº“å­˜ã€åˆ›å»ºæ—¶é—´ï¼‰ï¼šç•¥...
          },
          required: [<span class="hljs-string">'product_name'</span>] // è¡¨å•å¿…å¡«å­—æ®µ
        },
        tableConfig: {       // è¡¨æ ¼äº¤äº’é…ç½®ï¼ˆæŒ‰é’®ã€æ“ä½œé€»è¾‘ï¼‰
          headerButtons: [{  // è¡¨æ ¼é¡¶éƒ¨æŒ‰é’®ï¼ˆæ–°å¢å•†å“ï¼‰
            <span class="hljs-selector-tag">label</span>: <span class="hljs-string">'æ·»åŠ å•†å“'</span>,
            eventKey: <span class="hljs-string">'showComponent'</span>, // è§¦å‘äº‹ä»¶ï¼ˆæ˜¾ç¤ºå¼¹çª—ï¼‰
            eventOption: { comName: <span class="hljs-string">'createForm'</span> } // å¼¹çª—ç±»å‹ï¼ˆæ–°å¢è¡¨å•ï¼‰
          }],
          rowButtons: [      // è¡¨æ ¼è¡Œæ“ä½œæŒ‰é’®ï¼ˆè¯¦æƒ…ã€ä¿®æ”¹ã€åˆ é™¤ï¼‰
            { <span class="hljs-selector-tag">label</span>: <span class="hljs-string">'è¯¦æƒ…'</span>, eventKey: <span class="hljs-string">'showComponent'</span>, eventOption: { comName: <span class="hljs-string">'detailPanel'</span> } },
            { <span class="hljs-selector-tag">label</span>: <span class="hljs-string">'ä¿®æ”¹'</span>, eventKey: <span class="hljs-string">'showComponent'</span>, eventOption: { comName: <span class="hljs-string">'editForm'</span> } },
            { <span class="hljs-selector-tag">label</span>: <span class="hljs-string">'åˆ é™¤'</span>, eventKey: <span class="hljs-string">'remove'</span>, eventOption: { params: { product_id: <span class="hljs-string">'schema::product_id'</span> } } }
          ]
        },
        componentConfig: {   // å¼¹çª—ç»„ä»¶é…ç½®ï¼ˆæ ‡é¢˜ã€æŒ‰é’®æ–‡æœ¬ï¼‰
          createForm: { title: <span class="hljs-string">'æ·»åŠ å•†å“'</span>, saveBtnText: <span class="hljs-string">'ä¿å­˜'</span> },
          editForm: { mainKey: <span class="hljs-string">'product_id'</span>, title: <span class="hljs-string">'ç¼–è¾‘å•†å“'</span> },
          detailPanel: { mainKey: <span class="hljs-string">'product_id'</span>, title: <span class="hljs-string">'å•†å“è¯¦æƒ…'</span> }
        }
      }
    },
    // å…¶ä»–èœå•ï¼ˆè®¢å•ç®¡ç†-è‡ªå®šä¹‰é¡µã€å®¢æˆ·ç®¡ç†-è‡ªå®šä¹‰é¡µï¼‰ï¼šç•¥...
  ]
}
</code></pre>
<h2 data-id="heading-20">ä¸‰ã€é…ç½®æ¸²æŸ“æµç¨‹ï¼šä» â€œé…ç½®â€ åˆ° â€œé¡µé¢â€ çš„å…¨é“¾è·¯å®ç°</h2>
<p>å‰ç«¯åŸºäº Vue3 å®ç°é…ç½®çš„è‡ªåŠ¨åŒ–æ¸²æŸ“ï¼Œæ ¸å¿ƒåˆ†ä¸º â€œé…ç½®è·å–â€ ä¸ â€œé¡µé¢æ¸²æŸ“â€ ä¸¤æ­¥ï¼Œå…¨ç¨‹æ— éœ€æ‰‹åŠ¨ç¼–å†™é¡µé¢ä»£ç ï¼š</p>
<p><strong>1. ç¬¬ä¸€æ­¥ï¼šé…ç½®è·å–ï¼ˆè¡”æ¥ BFF Serve å±‚ï¼‰</strong></p>
<p>é¢†åŸŸæ¨¡å‹é…ç½®ç”± BFF Serve å±‚ç»Ÿä¸€ç®¡ç†ï¼Œå‰ç«¯é€šè¿‡æ¥å£è·å–é…ç½®å¹¶ç¼“å­˜ï¼Œç¡®ä¿å¤šé¡µé¢å…±äº«æ•°æ®ï¼š</p>
<ol>
<li><strong>æ¥å£è¯·æ±‚</strong>ï¼šåœ¨ç³»ç»Ÿå…¥å£ï¼ˆå¦‚Â <code>dashboard.vue</code>ï¼‰è°ƒç”¨ BFF å±‚çš„Â <code>/api/project</code>Â æ¥å£ï¼Œä¼ å…¥é¡¹ç›®æ ‡è¯†ï¼ˆ<code>proj_key</code>ï¼‰ï¼Œè·å–åŒ…å« â€œèœå•ã€é¡µé¢ã€å­—æ®µâ€ çš„å®Œæ•´é…ç½®ï¼›</li>
<li><strong>çŠ¶æ€ç¼“å­˜</strong>ï¼šå°†é…ç½®å­˜å…¥ Vuex/Pinia çŠ¶æ€ç®¡ç†ï¼ˆå¦‚Â <code>menuStore</code>Â å­˜å‚¨èœå•é…ç½®ã€<code>projectStore</code>Â å­˜å‚¨é¡¹ç›®ä¿¡æ¯ï¼‰ï¼Œé¿å…é‡å¤è¯·æ±‚ï¼›</li>
<li><strong>é…ç½®åˆ†å‘</strong>ï¼šè·¯ç”±åˆ‡æ¢æ—¶ï¼Œä»çŠ¶æ€ç®¡ç†ä¸­è¯»å–å½“å‰èœå•å¯¹åº”çš„é…ç½®ï¼Œä¼ é€’ç»™åŠ¨æ€æ¸²æŸ“ç»„ä»¶ã€‚</li>
</ol>
<p><strong>2. ç¬¬äºŒæ­¥ï¼šé¡µé¢æ¸²æŸ“ï¼ˆåˆ†åœºæ™¯é€‚é…ï¼‰</strong></p>
<p>æ ¹æ®é…ç½®ä¸­çš„Â <code>moduleType</code>ï¼ˆé¡µé¢ç±»å‹ï¼‰ï¼Œå‰ç«¯è‡ªåŠ¨åŒ¹é…æ¸²æŸ“é€»è¾‘ï¼Œå®ç° â€œä¸€å¥—ä»£ç é€‚é…å¤šåœºæ™¯â€ï¼š</p>
<p>ï¼ˆ1ï¼‰schema-view æ¸²æŸ“ï¼ˆæ ¸å¿ƒ CRUD é¡µé¢ï¼‰</p>
<p>é€šè¿‡è‡ªå®šä¹‰ HookÂ <code>useSchema</code>Â è§£æé…ç½®ï¼Œå°† JSON Schema æ‹†åˆ†ä¸º â€œè¡¨æ ¼é…ç½®ã€æœç´¢é…ç½®ã€ç»„ä»¶é…ç½®â€ï¼Œå†ç»“åˆ Vue åŠ¨æ€ç»„ä»¶æ¸²æŸ“é¡µé¢ï¼š</p>
<ul>
<li>
<p><strong>é…ç½®è§£æ</strong>ï¼š<code>useSchema</code>Â é’©å­æ¥æ”¶Â <code>schemaConfig</code>ï¼Œæå–Â <code>api</code>ï¼ˆæ¥å£åœ°å€ï¼‰ã€<code>tableSchema</code>ï¼ˆè¡¨æ ¼å­—æ®µï¼‰ã€<code>searchSchema</code>ï¼ˆæœç´¢å­—æ®µï¼‰ã€<code>components</code>ï¼ˆå¼¹çª—ç»„ä»¶ï¼‰ï¼›</p>
</li>
<li>
<p><strong>ç»„ä»¶æ¸²æŸ“</strong>ï¼š</p>
<ul>
<li>æœç´¢æ ï¼šæ ¹æ®Â <code>searchSchema</code>Â åŠ¨æ€ç”Ÿæˆç»„ä»¶ï¼ˆè¾“å…¥æ¡†ã€ä¸‹æ‹‰æ¡†ã€æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨ï¼‰ï¼Œå¹¶ç»‘å®šæ ¡éªŒè§„åˆ™ï¼›</li>
<li>è¡¨æ ¼ï¼šåŸºäºÂ <code>tableSchema</code>Â æ¸²æŸ“åˆ—ï¼Œç»“åˆÂ <code>tableConfig</code>Â æ¸²æŸ“é¡¶éƒ¨ / è¡Œæ“ä½œæŒ‰é’®ï¼Œç‚¹å‡»æŒ‰é’®æ—¶è§¦å‘Â <code>eventKey</code>Â å¯¹åº”çš„é€»è¾‘ï¼ˆå¦‚æ˜¾ç¤ºå¼¹çª—ã€è°ƒç”¨åˆ é™¤æ¥å£ï¼‰ï¼›</li>
<li>å¼¹çª—ï¼šæ ¹æ®Â <code>componentConfig</code>Â æ¸²æŸ“ â€œæ–°å¢ / ç¼–è¾‘ / è¯¦æƒ…â€ å¼¹çª—ï¼Œè‡ªåŠ¨å…³è”è¡¨å•å­—æ®µä¸æ ¡éªŒè§„åˆ™ã€‚</li>
</ul>
</li>
</ul>
<p>ï¼ˆ2ï¼‰iframe æ¸²æŸ“ï¼ˆåµŒå…¥å¤–éƒ¨é¡µé¢ï¼‰</p>
<ol>
<li>ä»èœå•é…ç½®ä¸­è¯»å–Â <code>iframe</code>Â ç±»å‹å¯¹åº”çš„åµŒå…¥è·¯å¾„ï¼ˆå¦‚Â <code>customConfig.path</code>ï¼‰ï¼›</li>
<li>åœ¨ Vue æ¨¡æ¿ä¸­ä½¿ç”¨Â <code>&lt;iframe&gt;</code>Â æ ‡ç­¾ï¼ŒåŠ¨æ€ç»‘å®šÂ <code>src</code>Â å±æ€§ä¸ºåµŒå…¥è·¯å¾„ï¼Œå®ç°å¤–éƒ¨é¡µé¢çš„æ— ç¼åµŒå…¥ã€‚</li>
</ol>
<p>ï¼ˆ3ï¼‰custom æ¸²æŸ“ï¼ˆè‡ªå®šä¹‰é¡µé¢ï¼‰</p>
<ol>
<li>é…ç½®ä¸­æŒ‡å®šè‡ªå®šä¹‰é¡µé¢çš„ Vue ç»„ä»¶è·¯å¾„ï¼ˆå¦‚Â <code>customConfig.path</code>ï¼‰ï¼›</li>
<li>é€šè¿‡ Vue3 çš„å¼‚æ­¥åŠ è½½ç»„ä»¶ï¼Œåœ¨è·¯ç”±å¯¹åº”çš„é¡µé¢ä¸­æ¸²æŸ“ï¼Œæ»¡è¶³ä¸ªæ€§åŒ–äº¤äº’éœ€æ±‚ï¼ˆå¦‚å¤æ‚è¡¨å•ã€æ•°æ®å¯è§†åŒ–ï¼‰ã€‚</li>
</ol>
<p><strong>3. æ ¸å¿ƒæ¸²æŸ“ä»£ç ç¤ºä¾‹ï¼ˆ<code>dashboard.vue</code>Â å…¥å£ï¼‰</strong></p>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-config-provider</span> <span class="hljs-attr">:locale</span>=<span class="hljs-string">"zhCn"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- å¤´éƒ¨å¯¼èˆªï¼ˆæ¸²æŸ“èœå•ï¼‰ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">header-view</span> <span class="hljs-attr">:proj-name</span>=<span class="hljs-string">"projName"</span> @<span class="hljs-attr">menu-select</span>=<span class="hljs-string">"onMenuSelect"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- åŠ¨æ€è·¯ç”±å‡ºå£ï¼ˆæ¸²æŸ“å¯¹åº”é¡µé¢ï¼‰ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">main-content</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">router-view</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">header-view</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">el-config-provider</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, onMounted } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;
<span class="hljs-keyword">import</span> { useRouter, useRoute } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue-router"</span>;
<span class="hljs-keyword">import</span> { useMenuStore } <span class="hljs-keyword">from</span> <span class="hljs-string">"$elpisStore/menu"</span>; <span class="hljs-comment">// èœå•çŠ¶æ€ç®¡ç†</span>
<span class="hljs-keyword">import</span> { useProjectStore } <span class="hljs-keyword">from</span> <span class="hljs-string">"$elpisStore/project"</span>; <span class="hljs-comment">// é¡¹ç›®çŠ¶æ€ç®¡ç†</span>
<span class="hljs-keyword">import</span> $curl <span class="hljs-keyword">from</span> <span class="hljs-string">"$elpisCommon/curl.js"</span>; <span class="hljs-comment">// æ¥å£è¯·æ±‚å·¥å…·</span>

<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>();
<span class="hljs-keyword">const</span> route = <span class="hljs-title function_">useRoute</span>();
<span class="hljs-keyword">const</span> menuStore = <span class="hljs-title function_">useMenuStore</span>();
<span class="hljs-keyword">const</span> projectStore = <span class="hljs-title function_">useProjectStore</span>();
<span class="hljs-keyword">const</span> projName = <span class="hljs-title function_">ref</span>(<span class="hljs-string">""</span>);

<span class="hljs-comment">// åˆå§‹åŒ–ï¼šè·å–é…ç½®å¹¶ç¼“å­˜</span>
<span class="hljs-title function_">onMounted</span>(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">getProjectConfig</span>();
});

<span class="hljs-comment">// è°ƒç”¨ BFF æ¥å£è·å–é¢†åŸŸæ¨¡å‹é…ç½®</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getProjectConfig</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> $curl({
    <span class="hljs-attr">method</span>: <span class="hljs-string">"get"</span>,
    <span class="hljs-attr">url</span>: <span class="hljs-string">"/api/project"</span>,
    <span class="hljs-attr">query</span>: { <span class="hljs-attr">proj_key</span>: route.<span class="hljs-property">query</span>.<span class="hljs-property">proj_key</span> } <span class="hljs-comment">// é¡¹ç›®æ ‡è¯†</span>
  });
  <span class="hljs-keyword">if</span> (res?.<span class="hljs-property">success</span> &amp;&amp; res.<span class="hljs-property">data</span>) {
    <span class="hljs-keyword">const</span> { name, menu } = res.<span class="hljs-property">data</span>;
    projName.<span class="hljs-property">value</span> = name;
    menuStore.<span class="hljs-title function_">setMenuList</span>(menu); <span class="hljs-comment">// ç¼“å­˜èœå•é…ç½®</span>
  }
}

<span class="hljs-comment">// èœå•ç‚¹å‡»ï¼šåˆ‡æ¢è·¯ç”±ï¼ŒåŒ¹é…å¯¹åº”é¡µé¢</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">onMenuSelect</span> = (<span class="hljs-params">menuItem</span>) =&gt; {
  <span class="hljs-keyword">const</span> { key, moduleType, customConfig } = menuItem;
  <span class="hljs-comment">// è·¯ç”±è·¯å¾„æ˜ å°„ï¼ˆæ ¹æ®é¡µé¢ç±»å‹åŒ¹é…ï¼‰</span>
  <span class="hljs-keyword">const</span> pathMap = {
    <span class="hljs-attr">schema</span>: <span class="hljs-string">"/schema"</span>,    <span class="hljs-comment">// Schema æ¸²æŸ“é¡µè·¯å¾„</span>
    <span class="hljs-attr">iframe</span>: <span class="hljs-string">"/iframe"</span>,    <span class="hljs-comment">// iframe åµŒå…¥é¡µè·¯å¾„</span>
    <span class="hljs-attr">custom</span>: customConfig?.<span class="hljs-property">path</span> <span class="hljs-comment">// è‡ªå®šä¹‰é¡µè·¯å¾„</span>
  };
  <span class="hljs-comment">// è·³è½¬è·¯ç”±ï¼ˆæºå¸¦é¡¹ç›®æ ‡è¯†ã€èœå•æ ‡è¯†ï¼‰</span>
  router.<span class="hljs-title function_">push</span>({
    <span class="hljs-attr">path</span>: <span class="hljs-string">`/view/dashboard`</span>,
    <span class="hljs-attr">query</span>: { key, <span class="hljs-attr">proj_key</span>: route.<span class="hljs-property">query</span>.<span class="hljs-property">proj_key</span> }
  });
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h2 data-id="heading-21">é‡Œç¨‹ç¢‘å›› åŸºäº vue3 å®ŒæˆåŠ¨æ€ç»„ä»¶åº“å»ºè®¾</h2>
<p>ä¸Šä¸€é˜¶æ®µé€šè¿‡ DSL é…ç½®å®ç°äº† schema-view é¡µé¢è‡ªåŠ¨åŒ–æ¸²æŸ“ï¼Œæœ¬é˜¶æ®µæ ¸å¿ƒæ˜¯æ„å»º<strong>é…ç½®é©±åŠ¨çš„åŠ¨æ€ç»„ä»¶åº“</strong>ï¼Œç”¨ JsonSchema ç»Ÿä¸€æè¿°ç»„ä»¶ç»“æ„ä¸é€»è¾‘</p>
<p><strong>ä¸€ã€è§£å†³ä¸‰å¤§å…³é”®é—®é¢˜</strong></p>
<ol>
<li><strong>é…ç½®ä½“ç³»</strong>ï¼šç”¨ä¸€ä»½ jsonSchema è¦†ç›– â€œç»„ä»¶æ˜¯ä»€ä¹ˆã€ä½•æ—¶è§¦å‘ã€åŒ…å«ä»€ä¹ˆã€å¦‚ä½•äº¤äº’â€ï¼›</li>
<li><strong>æ¸²æŸ“é€šä¿¡</strong>ï¼šå®ç°ä¸‰å±‚ç»„ä»¶ï¼ˆå®¹å™¨â†’ä¸­é—´ä»¶â†’æ§ä»¶ï¼‰è§£è€¦ä¸è·¨å±‚çº§è”åŠ¨ã€‚</li>
</ol>
<p><strong>äºŒã€é…ç½®ä½“ç³»ï¼šå››å±‚ç»“æ„å®šä¹‰ç»„ä»¶å…¨ç”Ÿå‘½å‘¨æœŸ</strong></p>
<p>åŸºäº â€œå•ä¸€æ•°æ®æºâ€ æ€æƒ³ï¼Œåœ¨é¢†åŸŸæ¨¡å‹åŸºç¡€ä¸Šæ‰©å±•é…ç½®ï¼Œç¡®ä¿æ¡†æ¶å¯è‡ªåŠ¨è¯†åˆ«é€»è¾‘ï¼š</p>
<ol>
<li>ç»„ä»¶å…ƒä¿¡æ¯ï¼ˆcomponentConfigï¼‰ï¼šå®šä¹‰ â€œæ˜¯ä»€ä¹ˆâ€</li>
</ol>
<p>æè¿°ç»„ä»¶åŸºç¡€å±æ€§ï¼Œå¦‚æ ‡é¢˜ã€æŒ‰é’®æ–‡æœ¬ã€ä¸»é”®ï¼ˆç”¨äºæ•°æ®å›æ˜¾ï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">schemaConfig</span>: {
  <span class="hljs-attr">componentConfig</span>: {
    <span class="hljs-attr">createForm</span>: { <span class="hljs-attr">title</span>: <span class="hljs-string">'æ·»åŠ å•†å“'</span>, <span class="hljs-attr">saveBtnText</span>: <span class="hljs-string">'ä¿å­˜'</span> },
    <span class="hljs-attr">editForm</span>: { <span class="hljs-attr">mainKey</span>: <span class="hljs-string">'product_id'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'ç¼–è¾‘å•†å“'</span> },
    <span class="hljs-attr">detailPanel</span>: { <span class="hljs-attr">mainKey</span>: <span class="hljs-string">'product_id'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'å•†å“è¯¦æƒ…'</span> }
  }
}
</code></pre>
<ol start="2">
<li>è§¦å‘è§„åˆ™ï¼ˆtableConfigï¼‰ï¼šå®šä¹‰è§¦å‘</li>
</ol>
<p>åœ¨è¡¨æ ¼æŒ‰é’®ä¸­é…ç½®äº‹ä»¶ï¼Œé€šè¿‡Â <code>eventKey</code>Â å…³è”ç»„ä»¶ï¼Œç»Ÿä¸€äº¤äº’é€»è¾‘ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">schemaConfig</span>: {
  <span class="hljs-attr">tableConfig</span>: {
    <span class="hljs-attr">headerButtons</span>: [{ <span class="hljs-comment">// è¡¨å¤´æŒ‰é’®â†’æ–°å¢ç»„ä»¶</span>
      <span class="hljs-attr">label</span>: <span class="hljs-string">'æ·»åŠ å•†å“'</span>,
      <span class="hljs-attr">eventKey</span>: <span class="hljs-string">'showComponent'</span>, 
      <span class="hljs-attr">eventOption</span>: { <span class="hljs-attr">comName</span>: <span class="hljs-string">'createForm'</span> }
    }],
    <span class="hljs-attr">rowButtons</span>: [ <span class="hljs-comment">// è¡ŒæŒ‰é’®â†’è¯¦æƒ…/ç¼–è¾‘/åˆ é™¤</span>
      { <span class="hljs-attr">label</span>: <span class="hljs-string">'è¯¦æƒ…'</span>, <span class="hljs-attr">eventKey</span>: <span class="hljs-string">'showComponent'</span>, <span class="hljs-attr">eventOption</span>: { <span class="hljs-attr">comName</span>: <span class="hljs-string">'detailPanel'</span> } },
      { <span class="hljs-attr">label</span>: <span class="hljs-string">'åˆ é™¤'</span>, <span class="hljs-attr">eventKey</span>: <span class="hljs-string">'remove'</span>, <span class="hljs-attr">eventOption</span>: { <span class="hljs-attr">params</span>: { <span class="hljs-attr">product_id</span>: <span class="hljs-string">'schema::product_id'</span> } } }
    ]
  }
}
</code></pre>
<ol start="3">
<li>å­—æ®µå±æ€§ï¼ˆpropertiesï¼‰ï¼šå®šä¹‰ â€œåŒ…å«ä»€ä¹ˆâ€</li>
</ol>
<p>ä¸ºå­—æ®µé…ç½®ä¸åŒç»„ä»¶ä¸­çš„è¡¨ç°ï¼ˆæ§ä»¶ç±»å‹ã€æ ¡éªŒè§„åˆ™ï¼‰ï¼Œé€šè¿‡Â <code>xxxOption</code>Â åŒºåˆ†åœºæ™¯ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">schemaConfig</span>: {
  <span class="hljs-attr">properties</span>: {
    <span class="hljs-attr">product_name</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
      <span class="hljs-attr">label</span>: <span class="hljs-string">'å•†å“åç§°'</span>,
      <span class="hljs-attr">maxLength</span>: <span class="hljs-number">20</span>, <span class="hljs-comment">// å…¨å±€æ ¡éªŒ</span>
      <span class="hljs-attr">searchOption</span>: { <span class="hljs-attr">comType</span>: <span class="hljs-string">'dynamicSelect'</span>, <span class="hljs-attr">api</span>: <span class="hljs-string">'/api/proj/enum'</span> }, <span class="hljs-comment">// æœç´¢æ¡†</span>
      <span class="hljs-attr">createFormOption</span>: { <span class="hljs-attr">comType</span>: <span class="hljs-string">'input'</span>, <span class="hljs-attr">default</span>: <span class="hljs-string">'å“²ç„æ–°è¯¾ç¨‹'</span> } <span class="hljs-comment">// æ–°å¢è¡¨å•</span>
    },
    <span class="hljs-attr">price</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'number'</span>,
      <span class="hljs-attr">minimum</span>: <span class="hljs-number">30</span>,
      <span class="hljs-attr">tableOption</span>: { <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>, <span class="hljs-attr">toFixed</span>: <span class="hljs-number">2</span> }, <span class="hljs-comment">// è¡¨æ ¼æ˜¾ç¤º</span>
      <span class="hljs-attr">createFormOption</span>: { <span class="hljs-attr">comType</span>: <span class="hljs-string">'inputNumber'</span> } <span class="hljs-comment">// è¡¨å•æ§ä»¶</span>
    }
  }
}
</code></pre>
<ol start="4">
<li>API äº¤äº’ï¼šå®šä¹‰ â€œå¦‚ä½•é€šä¿¡â€
éµå¾ª REST è§„èŒƒï¼ŒåŸºç¡€ API ç»Ÿä¸€é…ç½®ï¼Œæ¡†æ¶è‡ªåŠ¨æ˜ å°„ HTTP æ–¹æ³•ï¼ˆæ–°å¢â†’POSTã€åˆ é™¤â†’DELETEï¼‰ï¼ŒåŠ¨æ€å‚æ•°ç”¨Â <code>schema::xxx</code>Â å–è¡¨æ ¼è¡Œæ•°æ®ã€‚</li>
</ol>
<p><strong>ä¸‰ã€åˆ†å±‚æ¸²æŸ“ï¼šä¸‰å±‚ç»“æ„è§£è€¦åŠ è½½</strong>
æŒ‰èŒè´£æ‹†åˆ†ç»„ä»¶ï¼Œç”¨ Vue åŠ¨æ€ç»„ä»¶å®ç°è‡ªåŠ¨åŒ–æ¸²æŸ“ï¼Œä¾¿äºæ‰©å±•ï¼š</p>
<h3 data-id="heading-22">1. ç›®å½•ç»“æ„</h3>
<p>plaintext</p>
<pre><code class="hljs language-bash" lang="bash">src/
â”œâ”€â”€ pages/schema-view/       <span class="hljs-comment"># é¡¶å±‚å®¹å™¨ï¼šç®¡ç†çŠ¶æ€ä¸äº‹ä»¶</span>
â”‚   â”œâ”€â”€ schema-view.vue
â”‚   â””â”€â”€ components/          <span class="hljs-comment"># ä¸­é—´å±‚ï¼šé¢„è®¾ç»„ä»¶ï¼ˆæ–°å¢/ç¼–è¾‘/è¯¦æƒ…ï¼‰</span>
â”‚       â”œâ”€â”€ create-form/
â”‚       â””â”€â”€ component-config.js <span class="hljs-comment"># ç»„ä»¶æ˜ å°„ï¼ˆcomNameâ†’ç»„ä»¶è·¯å¾„ï¼‰</span>
â””â”€â”€ widgets/schema-form/     <span class="hljs-comment"># åº•å±‚ï¼šå­—æ®µæ§ä»¶ï¼ˆè¾“å…¥æ¡†/ä¸‹æ‹‰æ¡†ï¼‰</span>
    â”œâ”€â”€ schema-form.vue      <span class="hljs-comment"># æ§ä»¶å®¹å™¨</span>
    â””â”€â”€ components/          <span class="hljs-comment"># å…·ä½“æ§ä»¶</span>
</code></pre>
<p>2.  æ ¸å¿ƒæ¸²æŸ“é€»è¾‘ï¼ˆschema-view.vueï¼‰</p>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- è¡¨æ ¼+æœç´¢æ ï¼ˆå¤ç”¨å‰åºå®ç°ï¼‰ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">el-table</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">el-table</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- åŠ¨æ€æ¸²æŸ“ä¸­é—´å±‚ç»„ä»¶ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">component</span>
    <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(com, comName) in components"</span>
    <span class="hljs-attr">:key</span>=<span class="hljs-string">"comName"</span>
    <span class="hljs-attr">:is</span>=<span class="hljs-string">"ComponentMap[comName]"</span>
    <span class="hljs-attr">:schema</span>=<span class="hljs-string">"com.schema"</span>
    <span class="hljs-attr">:api</span>=<span class="hljs-string">"api"</span>
    @<span class="hljs-attr">command</span>=<span class="hljs-string">"handleComCommand"</span> &lt;!<span class="hljs-attr">--</span> <span class="hljs-attr">ç›‘å¬ç»„ä»¶äº‹ä»¶</span>ï¼ˆ<span class="hljs-attr">å¦‚ä¿å­˜æˆåŠŸ</span>ï¼‰ <span class="hljs-attr">--</span>&gt;</span>
  /&gt;
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { useSchema } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/hooks/schema.js"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ComponentMap</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./components/component-config.js"</span>;

<span class="hljs-keyword">const</span> { api, components } = <span class="hljs-title function_">useSchema</span>();
<span class="hljs-comment">// å¤„ç†ç»„ä»¶äº‹ä»¶ï¼ˆå¦‚ä¿å­˜ååˆ·æ–°è¡¨æ ¼ï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleComCommand</span> = (<span class="hljs-params">{ event }</span>) =&gt; {
  <span class="hljs-keyword">if</span> (event === <span class="hljs-string">"saveSuccess"</span>) <span class="hljs-title function_">emit</span>(<span class="hljs-string">"refreshTable"</span>);
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><strong>å››ã€é€šä¿¡æœºåˆ¶ï¼šé«˜æ•ˆè·¨å±‚çº§è”åŠ¨</strong></p>
<ol>
<li><strong>æ•°æ®å‘ä¸‹</strong>ï¼šé¡¶å±‚ç”¨Â <code>provide</code>Â æä¾› APIã€é…ç½®ï¼Œä¸­é—´å±‚ / åº•å±‚ç”¨Â <code>inject</code>Â ç›´æ¥è·å–ï¼Œé¿å… props å±‚å±‚ä¼ é€’ï¼›</li>
<li><strong>äº‹ä»¶å‘ä¸Š</strong>ï¼šä¸­é—´å±‚é€šè¿‡Â <code>emit</code>Â è§¦å‘äº‹ä»¶ï¼ˆå¦‚Â <code>saveSuccess</code>ï¼‰ï¼Œé¡¶å±‚ç›‘å¬åæ‰§è¡Œé€»è¾‘ï¼ˆå¦‚åˆ·æ–°è¡¨æ ¼ï¼‰ï¼›</li>
<li><strong>ç»„ä»¶è°ƒç”¨</strong>ï¼šé¡¶å±‚ç”¨Â <code>ref</code>Â è·å–ä¸­é—´å±‚ç»„ä»¶å®ä¾‹ï¼Œä¸»åŠ¨è°ƒç”¨æ–¹æ³•ï¼ˆå¦‚ç¼–è¾‘æ—¶å›æ˜¾æ•°æ®ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-23">é‡Œç¨‹ç¢‘äº” å®Œæˆ elpis-npm åŒ…åˆ†ç¦»å¹¶å‘å¸ƒ</h2>
<p>æœ¬é˜¶æ®µæ ¸å¿ƒç›®æ ‡æ˜¯<strong>å®ç° â€œæ ¸å¿ƒ - ä¸šåŠ¡â€ å½»åº•è§£è€¦</strong>ï¼šå°†æ¡†æ¶æ ¸å¿ƒèƒ½åŠ›ï¼ˆelpis-coreã€webpack å·¥ç¨‹åŒ–ã€åŸºç¡€ç»„ä»¶ï¼‰å°è£…ä¸º<code>elpis</code>Â npm åŒ…ï¼Œä¸šåŠ¡ä¾§ä»…éœ€å®‰è£…è¯¥åŒ…ï¼ŒæŒ‰çº¦å®šç›®å½•å¼€å‘å³å¯ï¼Œæ— éœ€å…³æ³¨åº•å±‚é…ç½®ï¼ŒçœŸæ­£å®ç° â€œèšç„¦ä¸šåŠ¡ã€æ ¸å¿ƒæ‰˜ç®¡â€ã€‚</p>
<p><strong>elpis-coreï¼šè‡ªåŠ¨æ‰«æä¸šåŠ¡ä»£ç ï¼Œå®ç° â€œä¸šåŠ¡æ¨¡å—é›¶é…ç½®æŒ‚è½½â€</strong></p>
<p>ä¸ºå„åŠ è½½å™¨ï¼ˆcontrollerã€service ç­‰ï¼‰æ–°å¢<strong>ä¸šåŠ¡å±‚æ‰«æé€»è¾‘</strong>ï¼Œè‡ªåŠ¨è¯†åˆ«ä¸šåŠ¡ç›®å½•ä¸‹çš„æ¨¡å—å¹¶æŒ‚è½½åˆ°æ¡†æ¶å®ä¾‹ï¼Œæ— éœ€æ‰‹åŠ¨æ³¨å†Œã€‚<br/>
ä»¥<strong>æ§åˆ¶å™¨åŠ è½½å™¨</strong>ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// elpis-core/loader/controllerLoader.js</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">const</span> glob = <span class="hljs-built_in">require</span>(<span class="hljs-string">'glob'</span>);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">loadController</span>(<span class="hljs-params">app</span>) {
  <span class="hljs-comment">// 1. åŠ è½½æ¡†æ¶æ ¸å¿ƒæ§åˆ¶å™¨ï¼ˆåŸæœ‰é€»è¾‘ï¼‰</span>
  <span class="hljs-keyword">const</span> coreControllerPath = path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'../app/controller'</span>);
  glob.<span class="hljs-title function_">sync</span>(<span class="hljs-string">`<span class="hljs-subst">${coreControllerPath}</span>/**/*.js`</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">file</span> =&gt;</span> <span class="hljs-title function_">handlerFile</span>(file, app));

  <span class="hljs-comment">// 2. æ–°å¢ï¼šæ‰«æä¸šåŠ¡å±‚æ§åˆ¶å™¨ï¼ˆçº¦å®šä¸šåŠ¡è·¯å¾„ app/controllerï¼‰</span>
  <span class="hljs-keyword">const</span> businessControllerPath = path.<span class="hljs-title function_">resolve</span>(app.<span class="hljs-property">businessPath</span>, <span class="hljs-string">'./controller'</span>);
  <span class="hljs-keyword">const</span> businessFileList = glob.<span class="hljs-title function_">sync</span>(<span class="hljs-string">`<span class="hljs-subst">${businessControllerPath}</span>/**/*.js`</span>);
  businessFileList.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">file</span> =&gt;</span> <span class="hljs-title function_">handlerFile</span>(file, app));
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`-- [elpis] loaded <span class="hljs-subst">${businessFileList.length}</span> business controllers --`</span>);
}

<span class="hljs-comment">// ç»Ÿä¸€æŒ‚è½½é€»è¾‘ï¼šæ ¸å¿ƒä¸ä¸šåŠ¡æ¨¡å—å…±ç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handlerFile</span>(<span class="hljs-params">file, app</span>) {
  <span class="hljs-keyword">const</span> controller = <span class="hljs-built_in">require</span>(file);
  <span class="hljs-keyword">const</span> moduleName = path.<span class="hljs-title function_">dirname</span>(file).<span class="hljs-title function_">split</span>(path.<span class="hljs-property">sep</span>).<span class="hljs-title function_">pop</span>();
  <span class="hljs-keyword">if</span> (!app.<span class="hljs-property">controller</span>[moduleName]) app.<span class="hljs-property">controller</span>[moduleName] = {};
  app.<span class="hljs-property">controller</span>[moduleName][path.<span class="hljs-title function_">basename</span>(file, <span class="hljs-string">'.js'</span>)] = controller;
}

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = loadController;
</code></pre>
<p>åŒæ—¶æ”¹é€ <code>elpis-core/index.js</code>ï¼Œæ–°å¢<strong>ä¸šåŠ¡å…¨å±€ä¸­é—´ä»¶æ³¨å†Œ</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// elpis-core/index.js</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">start</span>(<span class="hljs-params">options = {}</span>) {
  <span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Koa</span>();
  app.<span class="hljs-property">businessPath</span> = options.<span class="hljs-property">businessPath</span> || process.<span class="hljs-title function_">cwd</span>() + <span class="hljs-string">'/app'</span>; <span class="hljs-comment">// çº¦å®šä¸šåŠ¡è·¯å¾„</span>

  <span class="hljs-comment">// æ³¨å†Œä¸šåŠ¡å…¨å±€ä¸­é—´ä»¶ï¼ˆçº¦å®šä¸šåŠ¡è·¯å¾„ middleware.jsï¼‰</span>
  <span class="hljs-keyword">try</span> {
    <span class="hljs-built_in">require</span>(<span class="hljs-string">`<span class="hljs-subst">${app.businessPath}</span>/middleware.js`</span>)(app);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`-- [elpis] loaded business global middleware --`</span>);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[elpis] no business middleware, skip`</span>);
  }

  <span class="hljs-comment">// åŠ è½½æ ¸å¿ƒ+ä¸šåŠ¡æ¨¡å—ï¼ˆcontrollerã€serviceç­‰ï¼‰</span>
  <span class="hljs-title function_">loadController</span>(app);
  <span class="hljs-title function_">loadService</span>(app);
  app.<span class="hljs-title function_">listen</span>(options.<span class="hljs-property">port</span> || <span class="hljs-number">3000</span>);
  <span class="hljs-keyword">return</span> app;
}

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = { start };
</code></pre>
<p><strong>2. webpack é…ç½®ï¼šè‡ªåŠ¨æ‰«æä¸šåŠ¡é¡µé¢ï¼Œå®ç° â€œä¸šåŠ¡å…¥å£é›¶é…ç½®æ‰“åŒ…â€</strong></p>
<p>å¯¹<code>webpack.base.js</code>/<code>dev.js</code>/<code>prod.js</code>æ”¹é€ ï¼Œæ–°å¢<strong>ä¸šåŠ¡å±‚å…¥å£æ‰«æ</strong>ï¼Œè‡ªåŠ¨å°†ä¸šåŠ¡é¡µé¢çº³å…¥æ‰“åŒ…æµç¨‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// webpack/base.js</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">const</span> glob = <span class="hljs-built_in">require</span>(<span class="hljs-string">'glob'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>);

<span class="hljs-comment">// 1. åˆå§‹åŒ–ä¸šåŠ¡å…¥å£ä¸HTMLæ’ä»¶å®¹å™¨</span>
<span class="hljs-keyword">const</span> businessEntries = {};
<span class="hljs-keyword">const</span> businessHtmlPlugins = [];

<span class="hljs-comment">// 2. æ‰«æä¸šåŠ¡å±‚å…¥å£ï¼ˆçº¦å®š app/pages/**/entry.*.jsï¼‰</span>
<span class="hljs-keyword">const</span> businessEntryList = path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app/pages/**/entry.*.js'</span>);
glob.<span class="hljs-title function_">sync</span>(businessEntryList).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">file</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> entryName = path.<span class="hljs-title function_">basename</span>(file, <span class="hljs-string">'.js'</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-string">'entry.'</span>, <span class="hljs-string">''</span>);
  <span class="hljs-comment">// é…ç½®å…¥å£</span>
  businessEntries[entryName] = file;
  <span class="hljs-comment">// é…ç½®HTMLæ¨¡æ¿</span>
  businessHtmlPlugins.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>({
    <span class="hljs-attr">filename</span>: <span class="hljs-string">`<span class="hljs-subst">${entryName}</span>.html`</span>,
    <span class="hljs-attr">template</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'../template/entry.tpl'</span>),
    <span class="hljs-attr">chunks</span>: [entryName]
  }));
});

<span class="hljs-comment">// 3. åˆå¹¶æ ¸å¿ƒä¸ä¸šåŠ¡é…ç½®ï¼ˆæœ€ç»ˆå¯¼å‡ºï¼‰</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">entry</span>: { ...coreEntries, ...businessEntries }, <span class="hljs-comment">// åˆå¹¶å…¥å£</span>
  <span class="hljs-attr">plugins</span>: [...corePlugins, ...businessHtmlPlugins], <span class="hljs-comment">// åˆå¹¶æ’ä»¶</span>
  <span class="hljs-comment">// å…¶ä»–åŸºç¡€é…ç½®ï¼ˆloaderã€resolveç­‰ä¸å˜ï¼‰</span>
};
</code></pre>
<p><strong>3. æ¡†æ¶å…¥å£ index.jsï¼šå°è£…æ ¸å¿ƒ APIï¼Œå¯¹å¤–æš´éœ²æ ‡å‡†åŒ–èƒ½åŠ›</strong></p>
<p>å°†æ¡†æ¶æ ¸å¿ƒèƒ½åŠ›ï¼ˆæœåŠ¡å¯åŠ¨ã€å‰ç«¯æ„å»ºï¼‰å°è£…ä¸ºå‡½æ•°ï¼Œå¯¹å¤–æš´éœ²æ¸…æ™° APIï¼Œä¸šåŠ¡ä¾§ç›´æ¥è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// index.jsï¼ˆelpisåŒ…å…¥å£ï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ElpisCore</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./elpis-core"</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title class_">FEBuildDev</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./webpack/dev.js'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title class_">FEBuildProd</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./webpack/prod.js'</span>);

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-comment">// 1. æš´éœ²åŸºç¡€ç±»ï¼ˆä¾›ä¸šåŠ¡ç»§æ‰¿ï¼Œå‡å°‘é‡å¤ç¼–ç ï¼‰</span>
  <span class="hljs-title class_">Controller</span>: { <span class="hljs-title class_">Base</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./app/controller/base.js'</span>) },
  <span class="hljs-title class_">Service</span>: { <span class="hljs-title class_">Base</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./app/service/base.js'</span>) },

  <span class="hljs-comment">// 2. å‰ç«¯æ„å»ºï¼šæ”¯æŒå¼€å‘/ç”Ÿäº§ç¯å¢ƒ</span>
  <span class="hljs-title function_">frontendBuild</span>(<span class="hljs-params">paramsEnv</span>) {
    <span class="hljs-keyword">const</span> env = paramsEnv.<span class="hljs-title function_">trim</span>();
    env === <span class="hljs-string">'local'</span> ? <span class="hljs-title class_">FEBuildDev</span>() : <span class="hljs-title class_">FEBuildProd</span>();
  },

  <span class="hljs-comment">// 3. BFFæœåŠ¡å¯åŠ¨ï¼šæ¥æ”¶ä¸šåŠ¡é…ç½®ï¼Œè¿”å›å®ä¾‹</span>
  <span class="hljs-title function_">serverStart</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-keyword">const</span> app = <span class="hljs-title class_">ElpisCore</span>.<span class="hljs-title function_">start</span>(options);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`-- [elpis] server started at port <span class="hljs-subst">${options.port || <span class="hljs-number">3000</span>}</span> --`</span>);
    <span class="hljs-keyword">return</span> app;
  }
};
</code></pre>
<h3 data-id="heading-24">4. entry.dashboard.jsï¼šæ”¯æŒä¸šåŠ¡è·¯ç”±æ‹“å±•ï¼Œé›¶é…ç½®æ³¨å…¥</h3>
<p>æ–°å¢<strong>ä¸šåŠ¡è·¯ç”±æ‹“å±•æœºåˆ¶</strong>ï¼Œä¸šåŠ¡ä¾§æŒ‰çº¦å®šæš´éœ²é…ç½®å‡½æ•°å³å¯è‡ªåŠ¨æ³¨å…¥è·¯ç”±ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// app/pages/dashboard/entry.dashboard.js</span>
<span class="hljs-keyword">import</span> { createRouter, createWebHistory } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>;

<span class="hljs-comment">// 1. æ¡†æ¶æ ¸å¿ƒè·¯ç”±ï¼ˆåŸæœ‰é€»è¾‘ï¼‰</span>
<span class="hljs-keyword">const</span> routes = [<span class="hljs-comment">/* æ ¸å¿ƒé¡µé¢è·¯ç”± */</span>];
<span class="hljs-keyword">const</span> siderRoutes = [<span class="hljs-comment">/* æ ¸å¿ƒèœå•è·¯ç”± */</span>];

<span class="hljs-comment">// 2. æ–°å¢ï¼šä¸šåŠ¡è·¯ç”±æ‹“å±•ï¼ˆçº¦å®šä¸šåŠ¡æš´éœ² businessDashboardRouterConfigï¼‰</span>
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> businessDashboardRouterConfig === <span class="hljs-string">'function'</span>) {
  <span class="hljs-title function_">businessDashboardRouterConfig</span>({ routes, siderRoutes });
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`-- [elpis] extended business routes --`</span>);
}

<span class="hljs-comment">// 3. åˆ›å»ºè·¯ç”±å®ä¾‹å¹¶å¯¼å‡º</span>
<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>({ <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHistory</span>(), routes });
<span class="hljs-keyword">export</span> { router, siderRoutes };
</code></pre>
<p><strong>5. ç»„ä»¶é…ç½®æ–‡ä»¶ï¼šæ”¯æŒä¸šåŠ¡ç»„ä»¶æ‹“å±•ï¼Œåˆå¹¶å¯¼å‡º</strong></p>
<p>æ”¹é€ <code>schema-view/components/component-config.js</code>ä¸<code>widgets/**/xx-item-config.js</code>ï¼Œæ–°å¢<strong>ä¸šåŠ¡ç»„ä»¶å¯¼å…¥</strong>ï¼Œåˆå¹¶æ ¸å¿ƒä¸ä¸šåŠ¡ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// schema-view/components/component-config.js</span>
<span class="hljs-comment">// 1. æ¡†æ¶æ ¸å¿ƒç»„ä»¶ï¼ˆåŸæœ‰é€»è¾‘ï¼‰</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">CreateForm</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./create-form'</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ComponentConfig</span> = { createForm };

<span class="hljs-comment">// 2. æ–°å¢ï¼šå¯¼å…¥ä¸šåŠ¡ç»„ä»¶ï¼ˆçº¦å®šä¸šåŠ¡è·¯å¾„ $businessComponentConfigï¼‰</span>
<span class="hljs-keyword">import</span> businessComponentConfig <span class="hljs-keyword">from</span> <span class="hljs-string">'$businessComponentConfig'</span>;

<span class="hljs-comment">// 3. åˆå¹¶å¯¼å‡ºï¼ˆä¸šåŠ¡ç»„ä»¶è¦†ç›–æ ¸å¿ƒç»„ä»¶ï¼Œæ”¯æŒå®šåˆ¶ï¼‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> { ...<span class="hljs-title class_">ComponentConfig</span>, ...businessComponentConfig };
</code></pre>
<p><strong>äºŒã€ä¸šåŠ¡ä¾§ä½¿ç”¨ï¼šelpis-demo é¡¹ç›®é›¶é…ç½®å¼€å‘</strong></p>
<p>ä¸šåŠ¡ä¾§åªéœ€åˆ›å»º<code>elpis-demo</code>é¡¹ç›®ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤å³å¯å¿«é€Ÿå¼€å‘ï¼š</p>
<ol>
<li>
<p><strong>å®‰è£… elpis åŒ…</strong>ï¼š<code>npm install elpis --save</code>ï¼ˆæˆ–<code>npm link</code>æœ¬åœ°è°ƒè¯•ï¼‰ï¼›</p>
</li>
<li>
<p><strong>æŒ‰çº¦å®šç›®å½•å¼€å‘</strong>ï¼šä¸šåŠ¡ä»£ç æ”¾åœ¨<code>app</code>ç›®å½•ä¸‹ï¼ˆå¦‚<code>app/controller</code>ã€<code>app/pages</code>ï¼‰ï¼Œæ— éœ€é…ç½® webpack/elpis-coreï¼›</p>
</li>
</ol>
<p><strong>ä¸‰ã€åŒ…å‘å¸ƒï¼šnpm æµç¨‹</strong></p>
<ol>
<li><strong>æœ¬åœ°è°ƒè¯•</strong>ï¼šé€šè¿‡<code>npm link</code>å°†<code>elpis</code>åŒ…é“¾æ¥åˆ°<code>elpis-demo</code>ï¼ŒéªŒè¯åŠŸèƒ½ï¼›</li>
<li><strong>ç™»å½• npm</strong>ï¼š<code>npm login</code>ï¼ˆè¾“å…¥è´¦å·å¯†ç ï¼‰ï¼›</li>
<li><strong>å‘å¸ƒåŒ…</strong>ï¼š<code>npm publish</code>ï¼ˆç¡®ä¿<code>package.json</code>ä¸­<code>name</code>å”¯ä¸€ï¼Œç‰ˆæœ¬å·æ­£ç¡®ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-25">è¿­ä»£å‘å±•æ–¹å‘</h2>
<p>æ·±åº¦èåˆ AI</p>
<p><strong>AI éœ€æ±‚è½¬é…ç½®</strong>ï¼šåŸºäºæ¡†æ¶å¼€å‘æŒ‡å—æ„å»ºä¸“å± AI æç¤ºè¯ï¼ˆPromptï¼‰ï¼Œå¼€å‘è€…åªéœ€è¾“å…¥è‡ªç„¶è¯­è¨€éœ€æ±‚ï¼ˆå¦‚ â€œæ–°å¢ç”µå•†åˆ†é”€ç®¡ç†æ¨¡å—ï¼ŒåŒ…å«åˆ†é”€å‘˜åˆ—è¡¨ã€ä½£é‡‘ç»Ÿè®¡ã€è®¢å•å…³è”åŠŸèƒ½â€ï¼‰ï¼ŒAI å³å¯è‡ªåŠ¨ç”Ÿæˆç¬¦åˆ elpis è§„èŒƒçš„é¢†åŸŸæ¨¡å‹é…ç½®ï¼ˆå­—æ®µå®šä¹‰ã€ç»„ä»¶äº¤äº’ã€API æ˜ å°„ï¼‰ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–å†™ jsonSchema é…ç½®ï¼›</p>
<p><strong>AI Agentï¼šæ‰“é€  â€œå¼€å‘åŠ©æ‰‹â€:</strong>
å¼€å‘ elpis ä¸“å± AI Agentï¼Œé›†æˆæ¡†æ¶æ‰€æœ‰æ ¸å¿ƒèƒ½åŠ›ä¸è§„èŒƒï¼Œæ”¯æŒå¤šç»´åº¦äº¤äº’ï¼š</p>
<ul>
<li><strong>é…ç½®ç”Ÿæˆ</strong>ï¼šæ ¹æ®å¼€å‘è€…éœ€æ±‚æè¿°ï¼Œç”Ÿæˆ schema-view é¡µé¢é…ç½®ã€ä¸šåŠ¡è·¯ç”±é…ç½®ã€ç»„ä»¶æ‹“å±•é…ç½®ç­‰ï¼Œç›´æ¥é€‚é… elpis æ¡†æ¶çš„åŠ¨æ€æ¸²æŸ“é€»è¾‘ï¼›</li>
<li><strong>é—®é¢˜è§£ç­”</strong>ï¼šå¼€å‘è€…é‡åˆ°é…ç½®ç–‘é—®ï¼ˆå¦‚ â€œå¦‚ä½•è‡ªå®šä¹‰è¡¨æ ¼è¡Œæ“ä½œæŒ‰é’®â€â€œä¸šåŠ¡ç»„ä»¶å¦‚ä½•æŒ‚è½½åˆ°æ¡†æ¶â€ï¼‰æ—¶ï¼ŒAI Agent å¯åŸºäºæ¡†æ¶æ–‡æ¡£ç²¾å‡†å›å¤ï¼Œå¹¶æä¾›ä»£ç ç¤ºä¾‹ï¼›</li>
<li><strong>èƒ½åŠ›æ‹“å±•</strong>ï¼šæ”¯æŒå¼€å‘è€…æå‡ºç»„ä»¶æ‹“å±•éœ€æ±‚ï¼ˆå¦‚ â€œå¼€å‘ä¸€ä¸ªå¸¦æ—¶é—´èŒƒå›´é€‰æ‹©çš„æœç´¢æ§ä»¶â€ï¼‰ï¼ŒAI Agent è‡ªåŠ¨ç”Ÿæˆç¬¦åˆ elpis ç»„ä»¶è§„èŒƒçš„ä»£ç ï¼Œå¹¶è¯´æ˜æŒ‚è½½æ–¹å¼ï¼Œç¡®ä¿ä¸åç¦»æ¡†æ¶ç”Ÿæ€ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é‡Œç¨‹ç¢‘4ï¼šschema-form åŠ¨æ€ç»„ä»¶å¼€å‘]]></title>    <link>https://juejin.cn/post/7599910677578498048</link>    <guid>https://juejin.cn/post/7599910677578498048</guid>    <pubDate>2026-01-27T13:35:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599910677578498048" data-draft-id="7589509638339297306" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é‡Œç¨‹ç¢‘4ï¼šschema-form åŠ¨æ€ç»„ä»¶å¼€å‘"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2026-01-27T13:35:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æ€ªç‚¹ç‚¹"/> <meta itemprop="url" content="https://juejin.cn/user/1171413526123865"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é‡Œç¨‹ç¢‘4ï¼šschema-form åŠ¨æ€ç»„ä»¶å¼€å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1171413526123865/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æ€ªç‚¹ç‚¹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T13:35:45.000Z" title="Tue Jan 27 2026 13:35:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">åŠ¨æ€ç»„ä»¶åŸºäºé¢†åŸŸæ¨¡å‹æ¥è®¾è®¡ï¼Œä»¥æ•°æ®é©±åŠ¨å¼€å‘ã€‚</h3>
<p>åœ¨æ¨¡å‹ä¸­å¢åŠ componentConfigæ¥é…ç½®ç”¨åˆ°çš„ç»„ä»¶çš„å±æ€§ï¼Œæ¯ä¸ªå­—æ®µå¢åŠ componentOptionæ¥é…ç½®åœ¨æ¯ä¸ªåŠ¨æ€ç»„ä»¶ä¸­è¯¥å­—æ®µçš„å±•ç°å½¢å¼ï¼ŒåŠé»˜è®¤å€¼ç­‰ã€‚</p>
<p>æŠ½è±¡å‡ºschema-formç»„ä»¶ï¼šä½¿ç”¨åŠ¨æ€ç»„ä»¶<code>&lt;component&gt;</code>æ¥æŒ‰éœ€åŠ è½½inputã€selectç­‰ï¼Œform-item-config.jsä¸­åˆ—å‡ºç»„ä»¶çš„é”®å€¼å¯¹ã€‚
schema-formä¸‹è¾¹çš„inputï¼Œselectç­‰ç»„ä»¶ä¸­éœ€è¦å¼•å…¥ajvï¼Œæ ¹æ®é¢†åŸŸæ¨¡å‹ä¸­é…ç½®çš„æ ‡å‡†schemaï¼Œæ¥æ ¡éªŒç›¸å…³è¡¨å•é¡¹æ˜¯å¦æœ‰æ•ˆã€‚æä¾›å‡ºvalidateåŠgetValueæ–¹æ³•ã€‚</p>
<pre><code class="hljs language-import" lang="import">import inputNumber from './complex-view/input-number/input-number.vue';
import select from './complex-view/select/select.vue';
const formItemConfig = {
  input: {
    component: input,
  },
  inputNumber: {
    component: inputNumber,
  },
  select: {
    component: select,
  },
};
export default formItemConfig;
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df948ab6b96d4ebfb060b3e44fbfb9ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5oCq54K554K5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770125744&amp;x-signature=oH4Fo8RNpkD2TVzY02D%2FocW5qag%3D" alt="image.png" loading="lazy"/></p>
<p>ä»é…ç½®ä¸­æ‹¿åˆ°é…ç½®çš„ç»„ä»¶ï¼Œåœ¨schema-viewä¸­å°†åŠ¨æ€ç»„ä»¶å¼•å…¥ã€‚
ä½¿ç”¨æŠ½å±‰å½¢å¼å¼¹å‡ºcreateFormã€editFormã€detailFormã€‚</p>
<p>åœ¨schemaä¸­å­—æ®µé…ç½®é‡Œé…ç½®createFormOptionï¼ŒeditFormOptionç­‰ï¼Œæ¥è®¾å®šè¯¥å­—æ®µåœ¨è¿™ä¸ªç»„ä»¶ä¸­æ˜¯å¦æ˜¾ç¤ºï¼Œä»¥è¾“å…¥æ¡†è¿˜æ˜¯selectå½¢å¼æ˜¾ç¤ºç­‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JS-ä»åŸºç¡€åˆ°è¿›é˜¶ï¼ŒåŸç”Ÿ JS æ‰‹å†™æ— ç¼è½®æ’­å›¾]]></title>    <link>https://juejin.cn/post/7599924965950521382</link>    <guid>https://juejin.cn/post/7599924965950521382</guid>    <pubDate>2026-01-27T14:21:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599924965950521382" data-draft-id="7599852042530111498" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JS-ä»åŸºç¡€åˆ°è¿›é˜¶ï¼ŒåŸç”Ÿ JS æ‰‹å†™æ— ç¼è½®æ’­å›¾"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,JavaScript"/> <meta itemprop="datePublished" content="2026-01-27T14:21:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘ç°ä¸€åªå¤§å‘†ç“œ"/> <meta itemprop="url" content="https://juejin.cn/user/180747382561607"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JS-ä»åŸºç¡€åˆ°è¿›é˜¶ï¼ŒåŸç”Ÿ JS æ‰‹å†™æ— ç¼è½®æ’­å›¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/180747382561607/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘ç°ä¸€åªå¤§å‘†ç“œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T14:21:38.000Z" title="Tue Jan 27 2026 14:21:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>è½®æ’­å›¾ï¼ˆCarouselï¼‰æ˜¯å‰ç«¯å¼€å‘ä¸­æœ€åŸºç¡€ä¹Ÿæœ€ç»å…¸çš„ç»„ä»¶ä¹‹ä¸€ã€‚çœ‹ä¼¼ç®€å•ï¼Œä½†è¦å®ç°ä¸æ»‘ã€æ— ç¼çš„å¾ªç¯åˆ‡æ¢æ•ˆæœï¼Œå…¶å®éšè—ç€è®¸å¤šå…³äº DOM æ“ä½œå’Œ CSS åŠ¨ç”»çš„ç»†èŠ‚ã€‚æœ¬æ–‡å°†å¸¦ä½ ä»åŸºç¡€ç‰ˆè¿‡æ¸¡åˆ°è¿›é˜¶æ— ç¼ç‰ˆã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ åŸºç¡€ç‰ˆï¼šåŸºäº Transform çš„ä½ç§»å®ç°</h2>
<h3 data-id="heading-2">1. æ ¸å¿ƒåŸç†</h3>
<ol>
<li><strong>å¤–å±‚å®¹å™¨</strong>ï¼šè®¾ç½® <code>overflow: hidden</code>ï¼Œå®½åº¦å›ºå®šã€‚</li>
<li><strong>å†…å±‚è½¨é“</strong>ï¼šä½¿ç”¨ <code>display: flex</code> è®©å›¾ç‰‡æ¨ªå‘æ’åˆ—ã€‚</li>
<li><strong>ä½ç§»é€»è¾‘</strong>ï¼šé€šè¿‡ä¿®æ”¹è½¨é“çš„ <code>transform: translateX()</code> å€¼æ¥å®ç°åˆ‡æ¢ã€‚</li>
</ol>
<h3 data-id="heading-3">2. å­˜åœ¨çš„é—®é¢˜</h3>
<p>å½“ä½ ä»æœ€åä¸€å¼ ç‚¹å‡»â€œä¸‹ä¸€å¼ â€æ—¶ï¼Œä¸ºäº†å›åˆ°ç¬¬ä¸€å¼ ï¼Œè½¨é“ä¼šå‘ç›¸åæ–¹å‘å¿«é€Ÿæ»‘è¿‡ä¸­é—´æ‰€æœ‰å›¾ç‰‡ã€‚è¿™ç§â€œè§†è§‰å›é€€â€ä½“éªŒå¾ˆå·®ï¼Œæ— æ³•è¾¾åˆ°çœŸæ­£çš„â€œå¾ªç¯â€æ„Ÿã€‚</p>
<pre><code class="hljs language-HTML" lang="HTML"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ç®€å•è½®æ’­å›¾ - æ–¹æ³•1<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
      * {
        <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">box-sizing</span>: border-box;
      }

      <span class="hljs-selector-tag">body</span> {
        <span class="hljs-attribute">display</span>: flex;
        <span class="hljs-attribute">justify-content</span>: center;
        <span class="hljs-attribute">align-items</span>: center;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>;
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#667eea</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#764ba2</span> <span class="hljs-number">100%</span>);
      }

      <span class="hljs-selector-class">.container</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">800px</span>;
        <span class="hljs-attribute">background</span>: white;
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;
        <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
      }

      <span class="hljs-selector-tag">h1</span> {
        <span class="hljs-attribute">text-align</span>: center;
        <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>;
        <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;
      }

      <span class="hljs-comment">/* è½®æ’­å›¾å®¹å™¨ */</span>
      <span class="hljs-selector-class">.carousel-container</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">400px</span>;
        <span class="hljs-attribute">position</span>: relative;
        <span class="hljs-attribute">overflow</span>: hidden;
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
      }

      <span class="hljs-comment">/* è½®æ’­å›¾åˆ—è¡¨ */</span>
      <span class="hljs-selector-class">.carousel-list</span> {
        <span class="hljs-attribute">display</span>: flex;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-attribute">transition</span>: transform <span class="hljs-number">0.5s</span> ease-in-out;
      }

      <span class="hljs-comment">/* è½®æ’­å›¾é¡¹ */</span>
      <span class="hljs-selector-class">.carousel-slide</span> {
        <span class="hljs-attribute">min-width</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-attribute">display</span>: flex;
        <span class="hljs-attribute">justify-content</span>: center;
        <span class="hljs-attribute">align-items</span>: center;
        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">3rem</span>;
        <span class="hljs-attribute">color</span>: white;
      }

      <span class="hljs-comment">/* å·¦å³å¯¼èˆªæŒ‰é’® */</span>
      <span class="hljs-selector-class">.carousel-button</span> {
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">top</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">50%</span>);
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.5</span>);
        <span class="hljs-attribute">color</span>: white;
        <span class="hljs-attribute">border</span>: none;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">40px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">40px</span>;
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">cursor</span>: pointer;
        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.2rem</span>;
        <span class="hljs-attribute">transition</span>: background <span class="hljs-number">0.3s</span>;
      }

      <span class="hljs-selector-class">.carousel-button</span><span class="hljs-selector-pseudo">:hover</span> {
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.8</span>);
      }

      <span class="hljs-selector-class">.button-prev</span> {
        <span class="hljs-attribute">left</span>: <span class="hljs-number">10px</span>;
      }

      <span class="hljs-selector-class">.button-next</span> {
        <span class="hljs-attribute">right</span>: <span class="hljs-number">10px</span>;
      }

    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ç®€å•è½®æ’­å›¾ - æ–¹æ³•1: transformå®ç°<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-container"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"carousel-container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-list"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"carousel-list"</span>&gt;</span>
          <span class="hljs-comment">&lt;!-- å›¾ç‰‡é¡¹ï¼Œç”¨ä¸åŒé¢œè‰²è¡¨ç¤ºä¸åŒå›¾ç‰‡ --&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-slide"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background: #ff6b6b"</span>&gt;</span>å›¾ç‰‡ 1<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-slide"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background: #4ecdc4"</span>&gt;</span>å›¾ç‰‡ 2<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-slide"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background: #45b7d1"</span>&gt;</span>å›¾ç‰‡ 3<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-slide"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background: #96ceb4"</span>&gt;</span>å›¾ç‰‡ 4<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-slide"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background: #ffeaa7"</span>&gt;</span>å›¾ç‰‡ 5<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- å¯¼èˆªæŒ‰é’® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"button-prev"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-button button-prev"</span>&gt;</span>â€¹<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"button-next"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-button button-next"</span>&gt;</span>â€º<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
      <span class="hljs-keyword">const</span> carouselContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'carousel-container'</span>) <span class="hljs-comment">//è½®æ’­å›¾å®¹å™¨</span>
      <span class="hljs-keyword">const</span> carouselList = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"carousel-list"</span>); <span class="hljs-comment">// è½®æ’­åˆ—è¡¨</span>
      <span class="hljs-keyword">const</span> slides = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(carouselList.<span class="hljs-property">children</span>); <span class="hljs-comment">// è¢«è½®æ’­çš„å›¾ç‰‡</span>
      <span class="hljs-keyword">const</span> prevButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"button-prev"</span>); <span class="hljs-comment">//ä¸Šä¸€å¼ æŒ‰é’®</span>
      <span class="hljs-keyword">const</span> nextButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"button-next"</span>); <span class="hljs-comment">//ä¸‹ä¸€å¼ æŒ‰é’®</span>

      <span class="hljs-keyword">let</span> currentIndex = <span class="hljs-number">0</span>; <span class="hljs-comment">// å½“å‰è½®æ’­çš„å›¾ç‰‡ç´¢å¼•</span>
      <span class="hljs-keyword">const</span> slideWidth = slides[<span class="hljs-number">0</span>].<span class="hljs-title function_">getBoundingClientRect</span>().<span class="hljs-property">width</span>; <span class="hljs-comment">// æ˜¾ç¤ºçš„å›¾ç‰‡å®½åº¦</span>


      <span class="hljs-comment">// ç§»åŠ¨åˆ°æŒ‡å®šç´¢å¼•</span>
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">moveToSlide</span>(<span class="hljs-params">index</span>) {
        <span class="hljs-comment">// å¤„ç†è¾¹ç•Œ</span>
        <span class="hljs-keyword">if</span> (index &lt; <span class="hljs-number">0</span>) index = slides.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span> (index &gt;= slides.<span class="hljs-property">length</span>) index = <span class="hljs-number">0</span>;

        <span class="hljs-comment">// ç§»åŠ¨è½¨é“</span>
        carouselList.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">"translateX(-"</span> + slideWidth * index + <span class="hljs-string">"px)"</span>;

        <span class="hljs-comment">// æ›´æ–°å½“å‰ç´¢å¼•</span>
        currentIndex = index;

      }


      <span class="hljs-comment">// ä¸‹ä¸€å¼ </span>
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">nextSlide</span>(<span class="hljs-params"/>) {
        <span class="hljs-title function_">moveToSlide</span>(currentIndex + <span class="hljs-number">1</span>);
      }

      <span class="hljs-comment">// ä¸Šä¸€å¼ </span>
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">prevSlide</span>(<span class="hljs-params"/>) {
        <span class="hljs-title function_">moveToSlide</span>(currentIndex - <span class="hljs-number">1</span>);
      }

      <span class="hljs-comment">// äº‹ä»¶ç›‘å¬</span>
      prevButton.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, prevSlide);
      nextButton.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, nextSlide);
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>

</code></pre>
<hr/>
<h2 data-id="heading-4">äºŒã€ è¿›é˜¶ç‰ˆï¼šæ— ç¼å¾ªç¯è½®æ’­ï¼ˆSeamless Loopï¼‰</h2>
<h3 data-id="heading-5">1. æ ¸å¿ƒæ”¹è¿›æ€è·¯ï¼šå…‹éš†èŠ‚ç‚¹</h3>
<p>ä¸ºäº†å®ç°æ— é™å‘åæ»šåŠ¨çš„å‡è±¡ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è½¨é“çš„å¤´éƒ¨å’Œå°¾éƒ¨åšâ€œæ‰‹è„šâ€ï¼š</p>
<ul>
<li><strong>å…‹éš†ç¬¬ä¸€å¼ å›¾ç‰‡</strong>æ”¾åˆ°åˆ—è¡¨æœ€åã€‚</li>
<li><strong>å…‹éš†æœ€åä¸€å¼ å›¾ç‰‡</strong>æ”¾åˆ°åˆ—è¡¨æœ€å‰ã€‚</li>
</ul>
<h3 data-id="heading-6">2. å®ç°æµç¨‹</h3>
<ol>
<li>
<p><strong>åˆå§‹åç§»</strong>ï¼šç”±äºå¼€å¤´æ’å…¥äº†å…‹éš†èŠ‚ç‚¹ï¼Œåˆå§‹ <code>currentIndex</code> è®¾ä¸º <code>1</code>ã€‚</p>
</li>
<li>
<p><strong>æ­£å¸¸æ»‘åŠ¨</strong>ï¼šç‚¹å‡»æ—¶æ­£å¸¸å¼€å¯åŠ¨ç”»æ»‘åŠ¨ã€‚</p>
</li>
<li>
<p><strong>ç¬é—´ç¬ç§»ï¼ˆæ ¸å¿ƒï¼‰</strong> ï¼š</p>
<ul>
<li>ç›‘å¬è½¨é“çš„ <code>transitionend</code> äº‹ä»¶ã€‚</li>
<li>å½“åŠ¨ç”»ç»“æŸï¼Œå‘ç°å½“å‰åœ¨â€œæœ€åä¸€å¼ å…‹éš†å›¾â€æ—¶ï¼Œç«‹å³<strong>å…³é—­åŠ¨ç”»ï¼ˆtransition: noneï¼‰</strong> ï¼Œå¹¶ç¬é—´è·³å›â€œçœŸæ­£çš„ç¬¬ä¸€å¼ â€ã€‚</li>
</ul>
</li>
</ol>
<pre><code class="hljs language-HTML" lang="HTML"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æ— ç¼è½®æ’­å›¾ - æ”¹è¿›ç‰ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
      * { <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>; <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>; <span class="hljs-attribute">box-sizing</span>: border-box; }
      <span class="hljs-selector-tag">body</span> {
        <span class="hljs-attribute">display</span>: flex; <span class="hljs-attribute">justify-content</span>: center; <span class="hljs-attribute">align-items</span>: center;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>; <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#667eea</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#764ba2</span> <span class="hljs-number">100%</span>);
      }
      <span class="hljs-selector-class">.container</span> { <span class="hljs-attribute">width</span>: <span class="hljs-number">800px</span>; <span class="hljs-attribute">background</span>: white; <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>; <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>; }
      <span class="hljs-selector-tag">h1</span> { <span class="hljs-attribute">text-align</span>: center; <span class="hljs-attribute">color</span>: <span class="hljs-number">#333</span>; <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>; }

      <span class="hljs-selector-class">.carousel-container</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>; <span class="hljs-attribute">height</span>: <span class="hljs-number">400px</span>; <span class="hljs-attribute">position</span>: relative;
        <span class="hljs-attribute">overflow</span>: hidden; <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
      }

      <span class="hljs-selector-class">.carousel-list</span> {
        <span class="hljs-attribute">display</span>: flex; <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-comment">/* åˆå§‹ä¸åŠ  transitionï¼Œç”± JS æ§åˆ¶å¼€å…³ */</span>
      }

      <span class="hljs-selector-class">.carousel-slide</span> {
        <span class="hljs-attribute">min-width</span>: <span class="hljs-number">100%</span>; <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-attribute">display</span>: flex; <span class="hljs-attribute">justify-content</span>: center; <span class="hljs-attribute">align-items</span>: center;
        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">3rem</span>; <span class="hljs-attribute">color</span>: white;
      }

      <span class="hljs-selector-class">.carousel-button</span> {
        <span class="hljs-attribute">position</span>: absolute; <span class="hljs-attribute">top</span>: <span class="hljs-number">50%</span>; <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">50%</span>);
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.5</span>); <span class="hljs-attribute">color</span>: white; <span class="hljs-attribute">border</span>: none;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">40px</span>; <span class="hljs-attribute">height</span>: <span class="hljs-number">40px</span>; <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>; <span class="hljs-attribute">cursor</span>: pointer;
        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.2rem</span>; <span class="hljs-attribute">transition</span>: background <span class="hljs-number">0.3s</span>; <span class="hljs-attribute">z-index</span>: <span class="hljs-number">10</span>;
      }
      <span class="hljs-selector-class">.button-prev</span> { <span class="hljs-attribute">left</span>: <span class="hljs-number">10px</span>; }
      <span class="hljs-selector-class">.button-next</span> { <span class="hljs-attribute">right</span>: <span class="hljs-number">10px</span>; }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æ— ç¼è½®æ’­å›¾ - æ”¹è¿›ç‰ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-list"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"carousel-list"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-slide"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background: #ff6b6b"</span>&gt;</span>å›¾ç‰‡ 1<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-slide"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background: #4ecdc4"</span>&gt;</span>å›¾ç‰‡ 2<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-slide"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background: #45b7d1"</span>&gt;</span>å›¾ç‰‡ 3<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-slide"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background: #96ceb4"</span>&gt;</span>å›¾ç‰‡ 4<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-slide"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background: #ffeaa7"</span>&gt;</span>å›¾ç‰‡ 5<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"button-prev"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-button button-prev"</span>&gt;</span>â€¹<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"button-next"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"carousel-button button-next"</span>&gt;</span>â€º<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
      <span class="hljs-keyword">const</span> carouselList = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"carousel-list"</span>);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(carouselList)
      <span class="hljs-keyword">const</span> slides = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(carouselList.<span class="hljs-property">children</span>);
      <span class="hljs-keyword">const</span> prevButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"button-prev"</span>);
      <span class="hljs-keyword">const</span> nextButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"button-next"</span>);

      <span class="hljs-comment">// 1. å…‹éš†ç¬¬ä¸€å¼ å’Œæœ€åä¸€å¼ </span>
      <span class="hljs-keyword">const</span> firstClone = slides[<span class="hljs-number">0</span>].<span class="hljs-title function_">cloneNode</span>(<span class="hljs-literal">true</span>);
      <span class="hljs-keyword">const</span> lastClone = slides[slides.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>].<span class="hljs-title function_">cloneNode</span>(<span class="hljs-literal">true</span>);

      <span class="hljs-comment">// 2. å°†å…‹éš†èŠ‚ç‚¹æ·»åŠ åˆ°åˆ—è¡¨</span>
      carouselList.<span class="hljs-title function_">appendChild</span>(firstClone);
      carouselList.<span class="hljs-title function_">insertBefore</span>(lastClone, slides[<span class="hljs-number">0</span>]);

      <span class="hljs-comment">// 3. é‡æ–°è®¡ç®—çŠ¶æ€</span>
      <span class="hljs-keyword">let</span> currentIndex = <span class="hljs-number">1</span>; <span class="hljs-comment">// å› ä¸ºå‰é¢æ’å…¥äº†ä¸€ä¸ªï¼Œæ‰€ä»¥åˆå§‹ç´¢å¼•ä¸º 1</span>
      <span class="hljs-keyword">const</span> slideWidth = slides[<span class="hljs-number">0</span>].<span class="hljs-title function_">getBoundingClientRect</span>().<span class="hljs-property">width</span>; <span class="hljs-comment">// ä½¿ç”¨ç™¾åˆ†æ¯”è®¡ç®—æ›´ç¨³å¥</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(slides[<span class="hljs-number">0</span>].<span class="hljs-title function_">getBoundingClientRect</span>().<span class="hljs-property">width</span>)
      <span class="hljs-comment">// åˆå§‹åŒ–æ˜¾ç¤ºç¬¬ä¸€å¼ ï¼ˆä¸æ˜¯å…‹éš†çš„ç¬¬0å¼ ï¼‰</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`translateX(-<span class="hljs-subst">${currentIndex * slideWidth}</span>)`</span>)
      carouselList.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateX(-<span class="hljs-subst">${currentIndex * slideWidth}</span>px)`</span>;

      <span class="hljs-keyword">function</span> <span class="hljs-title function_">moveToSlide</span>(<span class="hljs-params">index, hasAnimation = <span class="hljs-literal">true</span></span>) {
        currentIndex = index;
        <span class="hljs-comment">// å¼€å¯åŠ¨ç”»</span>
        carouselList.<span class="hljs-property">style</span>.<span class="hljs-property">transition</span> = hasAnimation ? <span class="hljs-string">"transform 0.5s ease-in-out"</span> : <span class="hljs-string">"none"</span>;
        carouselList.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateX(-<span class="hljs-subst">${currentIndex * slideWidth}</span>px)`</span>;
      }

      <span class="hljs-comment">// æ ¸å¿ƒï¼šç›‘å¬è¿‡æ¸¡ç»“æŸ</span>
      carouselList.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'transitionend'</span>, <span class="hljs-function">() =&gt;</span> {
        
        <span class="hljs-comment">// å¦‚æœåˆ°äº†æœ€åçš„å…‹éš†å›¾ï¼Œç¬é—´è·³å›çœŸæ­£çš„ç¬¬ä¸€å¼ </span>
        <span class="hljs-keyword">if</span> (currentIndex === carouselList.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) {
          carouselList.<span class="hljs-property">style</span>.<span class="hljs-property">transition</span> = <span class="hljs-string">"none"</span>;
          currentIndex = <span class="hljs-number">1</span>;
          carouselList.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateX(-<span class="hljs-subst">${currentIndex * slideWidth}</span>px)`</span>;
        }
        
        <span class="hljs-comment">// å¦‚æœåˆ°äº†æœ€å‰çš„å…‹éš†å›¾ï¼Œç¬é—´è·³å›çœŸæ­£çš„æœ€åä¸€å¼ </span>
        <span class="hljs-keyword">if</span> (currentIndex === <span class="hljs-number">0</span>) {
          carouselList.<span class="hljs-property">style</span>.<span class="hljs-property">transition</span> = <span class="hljs-string">"none"</span>;
          currentIndex = carouselList.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> - <span class="hljs-number">2</span>;
          carouselList.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateX(-<span class="hljs-subst">${currentIndex * slideWidth}</span>px)`</span>;
        }
      });

      nextButton.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">moveToSlide</span>(currentIndex + <span class="hljs-number">1</span>));
      prevButton.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">moveToSlide</span>(currentIndex - <span class="hljs-number">1</span>));
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Three.js æ‰“é€ ç‚«é…·çƒŸèŠ±ç»½æ”¾æ•ˆæœ]]></title>    <link>https://juejin.cn/post/7599893063863418895</link>    <guid>https://juejin.cn/post/7599893063863418895</guid>    <pubDate>2026-01-27T14:22:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599893063863418895" data-draft-id="7599893063863402511" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Three.js æ‰“é€ ç‚«é…·çƒŸèŠ±ç»½æ”¾æ•ˆæœ"/> <meta itemprop="keywords" content="å‰ç«¯,three.js"/> <meta itemprop="datePublished" content="2026-01-27T14:22:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ç‹æ ¡é•¿"/> <meta itemprop="url" content="https://juejin.cn/user/2295436010076631"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Three.js æ‰“é€ ç‚«é…·çƒŸèŠ±ç»½æ”¾æ•ˆæœ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2295436010076631/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ç‹æ ¡é•¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T14:22:41.000Z" title="Tue Jan 27 2026 14:22:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°</h2>
<p>æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Three.js å’Œè‡ªå®šä¹‰ç€è‰²å™¨æ¥åˆ›å»ºä¸€ä¸ªç‚«é…·çš„çƒŸèŠ±ç»½æ”¾æ•ˆæœã€‚æˆ‘ä»¬å°†é€šè¿‡ç¼–å†™é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡å…ƒç€è‰²å™¨æ¥å®ç°çƒŸèŠ±ä»å‘å°„åˆ°çˆ†ç‚¸çš„å®Œæ•´åŠ¨ç”»è¿‡ç¨‹ï¼Œè¿™èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£ç²’å­ç³»ç»Ÿå’Œç€è‰²å™¨çš„é«˜çº§åº”ç”¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d5101e5eff09472ebff78884b4bd9c10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv546L5qCh6ZW_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770128561&amp;x-signature=mzTF3rl4TM8%2FrXKEQFEMwdEAGHY%3D" alt="screenshot_2026-01-27_22-19-51.gif" loading="lazy"/></p>
<h2 data-id="heading-1">å‡†å¤‡å·¥ä½œ</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥å¿…è¦çš„ Three.js åº“å’Œç›¸å…³å·¥å…·ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-variable constant_">THREE</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"three"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">OrbitControls</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"three/examples/jsm/controls/OrbitControls"</span>;
<span class="hljs-keyword">import</span> gsap <span class="hljs-keyword">from</span> <span class="hljs-string">"gsap"</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> dat <span class="hljs-keyword">from</span> <span class="hljs-string">"dat.gui"</span>;
<span class="hljs-keyword">import</span> vertexShader <span class="hljs-keyword">from</span> <span class="hljs-string">"../shaders/flylight/vertex.glsl"</span>;
<span class="hljs-keyword">import</span> fragmentShader <span class="hljs-keyword">from</span> <span class="hljs-string">"../shaders/flylight/fragment.glsl"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">RGBELoader</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"three/examples/jsm/loaders/RGBELoader"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">GLTFLoader</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"three/examples/jsm/loaders/GLTFLoader"</span>;

<span class="hljs-keyword">import</span> <span class="hljs-title class_">Fireworks</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./firework"</span>;

<span class="hljs-comment">// å¯¼å…¥æ°´æ¨¡å—</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Water</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"three/examples/jsm/objects/Water2"</span>;
</code></pre>
<h2 data-id="heading-2">åœºæ™¯åˆå§‹åŒ–</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„ Three.js åœºæ™¯ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆå§‹åŒ–åœºæ™¯</span>
<span class="hljs-keyword">const</span> scene = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Scene</span>();

<span class="hljs-comment">// åˆ›å»ºé€è§†ç›¸æœº</span>
<span class="hljs-keyword">const</span> camera = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">PerspectiveCamera</span>(
  <span class="hljs-number">90</span>,
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span> / <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>,
  <span class="hljs-number">0.1</span>,
  <span class="hljs-number">1000</span>
);

<span class="hljs-comment">// è®¾ç½®ç›¸æœºä½ç½®</span>
camera.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>);
camera.<span class="hljs-property">aspect</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span> / <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>;
camera.<span class="hljs-title function_">updateProjectionMatrix</span>();
scene.<span class="hljs-title function_">add</span>(camera);

<span class="hljs-comment">// åŠ å…¥è¾…åŠ©è½´ï¼Œå¸®åŠ©æˆ‘ä»¬æŸ¥çœ‹3ç»´åæ ‡è½´</span>
<span class="hljs-comment">// const axesHelper = new THREE.AxesHelper(5);</span>
<span class="hljs-comment">// scene.add(axesHelper);</span>
</code></pre>
<h2 data-id="heading-3">ç¯å¢ƒè®¾ç½®</h2>
<p>ä¸ºäº†è¥é€ æ›´çœŸå®çš„å¤œç©ºæ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦åŠ è½½ HDR ç¯å¢ƒè´´å›¾ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŠ è½½çº¹ç†</span>
<span class="hljs-comment">// åˆ›å»ºçº¹ç†åŠ è½½å™¨å¯¹è±¡</span>
<span class="hljs-keyword">const</span> rgbeLoader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RGBELoader</span>();
rgbeLoader.<span class="hljs-title function_">loadAsync</span>(<span class="hljs-string">"./assets/2k.hdr"</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">texture</span>) =&gt;</span> {
  texture.<span class="hljs-property">mapping</span> = <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">EquirectangularReflectionMapping</span>;
  scene.<span class="hljs-property">background</span> = texture;
  scene.<span class="hljs-property">environment</span> = texture;
});
</code></pre>
<h2 data-id="heading-4">é£è¡ŒåŠ¨ç”»ç€è‰²å™¨æè´¨</h2>
<p>æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªç”¨äºå¤©ç©ºä¸­é£è¡Œç‰©ä½“çš„ç€è‰²å™¨æè´¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºç€è‰²å™¨æè´¨</span>
<span class="hljs-keyword">const</span> shaderMaterial = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">ShaderMaterial</span>({
  <span class="hljs-attr">vertexShader</span>: vertexShader,
  <span class="hljs-attr">fragmentShader</span>: fragmentShader,
  <span class="hljs-attr">uniforms</span>: {},
  <span class="hljs-attr">side</span>: <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">DoubleSide</span>,
  <span class="hljs-comment">// transparent: true,</span>
});
</code></pre>
<h2 data-id="heading-5">æ¨¡å‹åŠ è½½ä¸åœºæ™¯å¸ƒç½®</h2>
<p>åŠ è½½çƒŸèŠ±æ¨¡å‹å’Œåœºæ™¯ä¸­çš„å…¶ä»–å…ƒç´ ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> gltfLoader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GLTFLoader</span>();
<span class="hljs-keyword">let</span> <span class="hljs-title class_">LightBox</span> = <span class="hljs-literal">null</span>;

<span class="hljs-comment">// åŠ è½½æ–°å¹´åœºæ™¯æ¨¡å‹</span>
gltfLoader.<span class="hljs-title function_">load</span>(<span class="hljs-string">"./assets/model/newyears_min.glb"</span>, <span class="hljs-function">(<span class="hljs-params">gltf</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(gltf);
  scene.<span class="hljs-title function_">add</span>(gltf.<span class="hljs-property">scene</span>);

  <span class="hljs-comment">// åˆ›å»ºæ°´é¢</span>
  <span class="hljs-keyword">const</span> waterGeometry = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">PlaneBufferGeometry</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>);
  <span class="hljs-keyword">let</span> water = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Water</span>(waterGeometry, {
    <span class="hljs-attr">scale</span>: <span class="hljs-number">4</span>,
    <span class="hljs-attr">textureHeight</span>: <span class="hljs-number">1024</span>,
    <span class="hljs-attr">textureWidth</span>: <span class="hljs-number">1024</span>,
  });
  water.<span class="hljs-property">position</span>.<span class="hljs-property">y</span> = <span class="hljs-number">1</span>;
  water.<span class="hljs-property">rotation</span>.<span class="hljs-property">x</span> = -<span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> / <span class="hljs-number">2</span>;
  scene.<span class="hljs-title function_">add</span>(water);
});

<span class="hljs-comment">// åŠ è½½é£è¡Œå…‰ç‚¹æ¨¡å‹</span>
gltfLoader.<span class="hljs-title function_">load</span>(<span class="hljs-string">"./assets/model/flyLight.glb"</span>, <span class="hljs-function">(<span class="hljs-params">gltf</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(gltf);

  <span class="hljs-title class_">LightBox</span> = gltf.<span class="hljs-property">scene</span>.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>];
  <span class="hljs-title class_">LightBox</span>.<span class="hljs-property">material</span> = shaderMaterial;

  <span class="hljs-comment">// åˆ›å»º150ä¸ªéšæœºåˆ†å¸ƒçš„é£è¡Œå…‰ç‚¹</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">150</span>; i++) {
    <span class="hljs-keyword">let</span> flyLight = gltf.<span class="hljs-property">scene</span>.<span class="hljs-title function_">clone</span>(<span class="hljs-literal">true</span>);
    <span class="hljs-keyword">let</span> x = (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() - <span class="hljs-number">0.5</span>) * <span class="hljs-number">300</span>;
    <span class="hljs-keyword">let</span> z = (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() - <span class="hljs-number">0.5</span>) * <span class="hljs-number">300</span>;
    <span class="hljs-keyword">let</span> y = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">60</span> + <span class="hljs-number">5</span>;
    flyLight.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(x, y, z);
    
    <span class="hljs-comment">// ä½¿ç”¨ GSAP æ·»åŠ æ—‹è½¬åŠ¨ç”»</span>
    gsap.<span class="hljs-title function_">to</span>(flyLight.<span class="hljs-property">rotation</span>, {
      <span class="hljs-attr">y</span>: <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,
      <span class="hljs-attr">duration</span>: <span class="hljs-number">10</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">30</span>,
      <span class="hljs-attr">repeat</span>: -<span class="hljs-number">1</span>,
    });
    
    <span class="hljs-comment">// ä½¿ç”¨ GSAP æ·»åŠ ä½ç½®åŠ¨ç”»</span>
    gsap.<span class="hljs-title function_">to</span>(flyLight.<span class="hljs-property">position</span>, {
      <span class="hljs-attr">x</span>: <span class="hljs-string">"+="</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">5</span>,
      <span class="hljs-attr">y</span>: <span class="hljs-string">"+="</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">20</span>,
      <span class="hljs-attr">yoyo</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">duration</span>: <span class="hljs-number">5</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span>,
      <span class="hljs-attr">repeat</span>: -<span class="hljs-number">1</span>,
    });
    scene.<span class="hljs-title function_">add</span>(flyLight);
  }
});
</code></pre>
<h2 data-id="heading-6">çƒŸèŠ±ç®¡ç†</h2>
<p>åˆ›å»ºçƒŸèŠ±ç®¡ç†æ•°ç»„ï¼Œç”¨äºç®¡ç†æ‰€æœ‰çš„çƒŸèŠ±å®ä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç®¡ç†çƒŸèŠ±</span>
<span class="hljs-keyword">let</span> fireworks = [];

<span class="hljs-keyword">function</span> <span class="hljs-title function_">animate</span>(<span class="hljs-params">t</span>) {
  controls.<span class="hljs-title function_">update</span>();
  <span class="hljs-keyword">const</span> elapsedTime = clock.<span class="hljs-title function_">getElapsedTime</span>();
  
  <span class="hljs-comment">// æ›´æ–°æ¯ä¸ªçƒŸèŠ±çš„çŠ¶æ€</span>
  fireworks.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item, i</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> type = item.<span class="hljs-title function_">update</span>();
    <span class="hljs-keyword">if</span> (type == <span class="hljs-string">"remove"</span>) {
      fireworks.<span class="hljs-title function_">splice</span>(i, <span class="hljs-number">1</span>);
    }
  });

  <span class="hljs-title function_">requestAnimationFrame</span>(animate);
  <span class="hljs-comment">// ä½¿ç”¨æ¸²æŸ“å™¨æ¸²æŸ“ç›¸æœºçœ‹è¿™ä¸ªåœºæ™¯çš„å†…å®¹æ¸²æŸ“å‡ºæ¥</span>
  renderer.<span class="hljs-title function_">render</span>(scene, camera);
}

<span class="hljs-title function_">animate</span>();
</code></pre>
<h2 data-id="heading-7">ç‚¹å‡»åˆ›å»ºçƒŸèŠ±</h2>
<p>æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨ï¼Œå…è®¸ç”¨æˆ·åœ¨ä»»æ„ä½ç½®åˆ›å»ºçƒŸèŠ±ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è®¾ç½®åˆ›å»ºçƒŸèŠ±å‡½æ•°</span>
<span class="hljs-keyword">let</span> <span class="hljs-title function_">createFireworks</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">let</span> color = <span class="hljs-string">`hsl(<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">360</span>)}</span>,100%,80%)`</span>;
  <span class="hljs-keyword">let</span> position = {
    <span class="hljs-attr">x</span>: (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() - <span class="hljs-number">0.5</span>) * <span class="hljs-number">40</span>,
    <span class="hljs-attr">z</span>: -(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() - <span class="hljs-number">0.5</span>) * <span class="hljs-number">40</span>,
    <span class="hljs-attr">y</span>: <span class="hljs-number">3</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">15</span>,
  };

  <span class="hljs-comment">// éšæœºç”Ÿæˆé¢œè‰²å’ŒçƒŸèŠ±æ”¾çš„ä½ç½®</span>
  <span class="hljs-keyword">let</span> firework = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Fireworks</span>(color, position);
  firework.<span class="hljs-title function_">addScene</span>(scene, camera);
  fireworks.<span class="hljs-title function_">push</span>(firework);
};

<span class="hljs-comment">// ç›‘å¬ç‚¹å‡»äº‹ä»¶</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, createFireworks);
</code></pre>
<h2 data-id="heading-8">çƒŸèŠ±ç±»è¯¦è§£</h2>
<p>çƒŸèŠ±ç±»æ˜¯æ•´ä¸ªæ•ˆæœçš„æ ¸å¿ƒï¼Œå®ƒåŒ…å«ä¸‰ä¸ªé˜¶æ®µï¼šå‘å°„ã€çˆ†ç‚¸å’Œæ¶ˆæ•£ã€‚</p>
<h3 data-id="heading-9">æ„é€ å‡½æ•°</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Fireworks</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">color, to, <span class="hljs-keyword">from</span> = { x: <span class="hljs-number">0</span>, y: <span class="hljs-number">0</span>, z: <span class="hljs-number">0</span> }</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Color</span>(color);

    <span class="hljs-comment">// åˆ›å»ºçƒŸèŠ±å‘å°„çš„çƒç‚¹</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">startGeometry</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">BufferGeometry</span>();
    <span class="hljs-keyword">const</span> startPositionArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Float32Array</span>(<span class="hljs-number">3</span>);
    startPositionArray[<span class="hljs-number">0</span>] = <span class="hljs-keyword">from</span>.<span class="hljs-property">x</span>;
    startPositionArray[<span class="hljs-number">1</span>] = <span class="hljs-keyword">from</span>.<span class="hljs-property">y</span>;
    startPositionArray[<span class="hljs-number">2</span>] = <span class="hljs-keyword">from</span>.<span class="hljs-property">z</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">startGeometry</span>.<span class="hljs-title function_">setAttribute</span>(
      <span class="hljs-string">"position"</span>,
      <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">BufferAttribute</span>(startPositionArray, <span class="hljs-number">3</span>)
    );

    <span class="hljs-keyword">const</span> astepArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Float32Array</span>(<span class="hljs-number">3</span>);
    astepArray[<span class="hljs-number">0</span>] = to.<span class="hljs-property">x</span> - <span class="hljs-keyword">from</span>.<span class="hljs-property">x</span>;
    astepArray[<span class="hljs-number">1</span>] = to.<span class="hljs-property">y</span> - <span class="hljs-keyword">from</span>.<span class="hljs-property">y</span>;
    astepArray[<span class="hljs-number">2</span>] = to.<span class="hljs-property">z</span> - <span class="hljs-keyword">from</span>.<span class="hljs-property">x</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">startGeometry</span>.<span class="hljs-title function_">setAttribute</span>(
      <span class="hljs-string">"aStep"</span>,
      <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">BufferAttribute</span>(astepArray, <span class="hljs-number">3</span>)
    );

    <span class="hljs-comment">// è®¾ç½®ç€è‰²å™¨æè´¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">startMaterial</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">ShaderMaterial</span>({
      <span class="hljs-attr">vertexShader</span>: startPointVertex,
      <span class="hljs-attr">fragmentShader</span>: startPointFragment,
      <span class="hljs-attr">transparent</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">blending</span>: <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">AdditiveBlending</span>,
      <span class="hljs-attr">depthWrite</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">uniforms</span>: {
        <span class="hljs-attr">uTime</span>: {
          <span class="hljs-attr">value</span>: <span class="hljs-number">0</span>,
        },
        <span class="hljs-attr">uSize</span>: {
          <span class="hljs-attr">value</span>: <span class="hljs-number">20</span>,
        },
        <span class="hljs-attr">uColor</span>: { <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> },
      },
    });

    <span class="hljs-comment">// åˆ›å»ºçƒŸèŠ±ç‚¹çƒ</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">startPoint</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Points</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">startGeometry</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">startMaterial</span>);

    <span class="hljs-comment">// å¼€å§‹è®¡æ—¶</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">clock</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Clock</span>();

    <span class="hljs-comment">// åˆ›å»ºçˆ†ç‚¸çš„çƒŸèŠ±</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworkGeometry</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">BufferGeometry</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">FireworksCount</span> = <span class="hljs-number">180</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">180</span>);
    <span class="hljs-keyword">const</span> positionFireworksArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Float32Array</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">FireworksCount</span> * <span class="hljs-number">3</span>);
    <span class="hljs-keyword">const</span> scaleFireArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Float32Array</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">FireworksCount</span>);
    <span class="hljs-keyword">const</span> directionArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Float32Array</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">FireworksCount</span> * <span class="hljs-number">3</span>);
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">FireworksCount</span>; i++) {
      <span class="hljs-comment">// ä¸€å¼€å§‹çƒŸèŠ±ä½ç½®</span>
      positionFireworksArray[i * <span class="hljs-number">3</span> + <span class="hljs-number">0</span>] = to.<span class="hljs-property">x</span>;
      positionFireworksArray[i * <span class="hljs-number">3</span> + <span class="hljs-number">1</span>] = to.<span class="hljs-property">y</span>;
      positionFireworksArray[i * <span class="hljs-number">3</span> + <span class="hljs-number">2</span>] = to.<span class="hljs-property">z</span>;
      
      <span class="hljs-comment">// è®¾ç½®çƒŸèŠ±æ‰€æœ‰ç²’å­åˆå§‹åŒ–å¤§å°</span>
      scaleFireArray[i] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>();
      
      <span class="hljs-comment">// è®¾ç½®å››å‘¨å‘å°„çš„è§’åº¦</span>
      <span class="hljs-keyword">let</span> theta = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>;
      <span class="hljs-keyword">let</span> beta = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>;
      <span class="hljs-keyword">let</span> r = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>();

      directionArray[i * <span class="hljs-number">3</span> + <span class="hljs-number">0</span>] = r * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(theta) + r * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(beta);
      directionArray[i * <span class="hljs-number">3</span> + <span class="hljs-number">1</span>] = r * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>(theta) + r * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>(beta);
      directionArray[i * <span class="hljs-number">3</span> + <span class="hljs-number">2</span>] = r * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(theta) + r * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>(beta);
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworkGeometry</span>.<span class="hljs-title function_">setAttribute</span>(
      <span class="hljs-string">"position"</span>,
      <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">BufferAttribute</span>(positionFireworksArray, <span class="hljs-number">3</span>)
    );
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworkGeometry</span>.<span class="hljs-title function_">setAttribute</span>(
      <span class="hljs-string">"aScale"</span>,
      <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">BufferAttribute</span>(scaleFireArray, <span class="hljs-number">1</span>)
    );
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworkGeometry</span>.<span class="hljs-title function_">setAttribute</span>(
      <span class="hljs-string">"aRandom"</span>,
      <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">BufferAttribute</span>(directionArray, <span class="hljs-number">3</span>)
    );

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworksMaterial</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">ShaderMaterial</span>({
      <span class="hljs-attr">uniforms</span>: {
        <span class="hljs-attr">uTime</span>: {
          <span class="hljs-attr">value</span>: <span class="hljs-number">0</span>,
        },
        <span class="hljs-attr">uSize</span>: {
          <span class="hljs-attr">value</span>: <span class="hljs-number">0</span>,
        },
        <span class="hljs-attr">uColor</span>: { <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> },
      },
      <span class="hljs-attr">transparent</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">blending</span>: <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">AdditiveBlending</span>,
      <span class="hljs-attr">depthWrite</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">vertexShader</span>: fireworksVertex,
      <span class="hljs-attr">fragmentShader</span>: fireworksFragment,
    });

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworks</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Points</span>(
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworkGeometry</span>,
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworksMaterial</span>
    );

    <span class="hljs-comment">// åˆ›å»ºéŸ³é¢‘</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">linstener</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">AudioListener</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">linstener1</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">AudioListener</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sound</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Audio</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">linstener</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sendSound</span> = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Audio</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">linstener1</span>);

    <span class="hljs-comment">// åˆ›å»ºéŸ³é¢‘åŠ è½½å™¨</span>
    <span class="hljs-keyword">const</span> audioLoader = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">AudioLoader</span>();
    audioLoader.<span class="hljs-title function_">load</span>(
      <span class="hljs-string">`./assets/audio/pow<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">4</span>) + <span class="hljs-number">1</span>}</span>.ogg`</span>,
      <span class="hljs-function">(<span class="hljs-params">buffer</span>) =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">sound</span>.<span class="hljs-title function_">setBuffer</span>(buffer);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">sound</span>.<span class="hljs-title function_">setLoop</span>(<span class="hljs-literal">false</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">sound</span>.<span class="hljs-title function_">setVolume</span>(<span class="hljs-number">1</span>);
      }
    );

    audioLoader.<span class="hljs-title function_">load</span>(<span class="hljs-string">`./assets/audio/send.mp3`</span>, <span class="hljs-function">(<span class="hljs-params">buffer</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">sendSound</span>.<span class="hljs-title function_">setBuffer</span>(buffer);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">sendSound</span>.<span class="hljs-title function_">setLoop</span>(<span class="hljs-literal">false</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">sendSound</span>.<span class="hljs-title function_">setVolume</span>(<span class="hljs-number">1</span>);
    });
  }
  
  <span class="hljs-comment">// æ·»åŠ åˆ°åœºæ™¯</span>
  <span class="hljs-title function_">addScene</span>(<span class="hljs-params">scene, camera</span>) {
    scene.<span class="hljs-title function_">add</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">startPoint</span>);
    scene.<span class="hljs-title function_">add</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworks</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">scene</span> = scene;
  }
  
  <span class="hljs-comment">// æ›´æ–°å˜é‡</span>
  <span class="hljs-title function_">update</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> elapsedTime = <span class="hljs-variable language_">this</span>.<span class="hljs-property">clock</span>.<span class="hljs-title function_">getElapsedTime</span>();
    
    <span class="hljs-keyword">if</span> (elapsedTime &gt; <span class="hljs-number">0.2</span> &amp;&amp; elapsedTime &lt; <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">sendSound</span>.<span class="hljs-property">isPlaying</span> &amp;&amp; !<span class="hljs-variable language_">this</span>.<span class="hljs-property">sendSoundplay</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">sendSound</span>.<span class="hljs-title function_">play</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">sendSoundplay</span> = <span class="hljs-literal">true</span>;
      }
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">startMaterial</span>.<span class="hljs-property">uniforms</span>.<span class="hljs-property">uTime</span>.<span class="hljs-property">value</span> = elapsedTime;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">startMaterial</span>.<span class="hljs-property">uniforms</span>.<span class="hljs-property">uSize</span>.<span class="hljs-property">value</span> = <span class="hljs-number">20</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (elapsedTime &gt; <span class="hljs-number">0.2</span>) {
      <span class="hljs-keyword">const</span> time = elapsedTime - <span class="hljs-number">1</span>;
      <span class="hljs-comment">// è®©ç‚¹å…ƒç´ æ¶ˆå¤±</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">startMaterial</span>.<span class="hljs-property">uniforms</span>.<span class="hljs-property">uSize</span>.<span class="hljs-property">value</span> = <span class="hljs-number">0</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">startPoint</span>.<span class="hljs-title function_">clear</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">startGeometry</span>.<span class="hljs-title function_">dispose</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">startMaterial</span>.<span class="hljs-title function_">dispose</span>();
      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">sound</span>.<span class="hljs-property">isPlaying</span> &amp;&amp; !<span class="hljs-variable language_">this</span>.<span class="hljs-property">play</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">sound</span>.<span class="hljs-title function_">play</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">play</span> = <span class="hljs-literal">true</span>;
      }
      <span class="hljs-comment">//è®¾ç½®çƒŸèŠ±æ˜¾ç¤º</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworksMaterial</span>.<span class="hljs-property">uniforms</span>.<span class="hljs-property">uSize</span>.<span class="hljs-property">value</span> = <span class="hljs-number">20</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworksMaterial</span>.<span class="hljs-property">uniforms</span>.<span class="hljs-property">uTime</span>.<span class="hljs-property">value</span> = time;

      <span class="hljs-keyword">if</span> (time &gt; <span class="hljs-number">5</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworksMaterial</span>.<span class="hljs-property">uniforms</span>.<span class="hljs-property">uSize</span>.<span class="hljs-property">value</span> = <span class="hljs-number">0</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworks</span>.<span class="hljs-title function_">clear</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworkGeometry</span>.<span class="hljs-title function_">dispose</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworksMaterial</span>.<span class="hljs-title function_">dispose</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">scene</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">fireworks</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">scene</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">startPoint</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"remove"</span>;
      }
    }
  }
}
</code></pre>
<h2 data-id="heading-10">ç€è‰²å™¨è¯¦è§£</h2>
<h3 data-id="heading-11">å‘å°„é˜¶æ®µç€è‰²å™¨</h3>
<h4 data-id="heading-12">å‘å°„é¡¶ç‚¹ç€è‰²å™¨ (startpoint/vertex.glsl):</h4>
<pre><code class="hljs language-glsl" lang="glsl">attribute vec3 aStep;

uniform float uTime;
uniform float uSize;

void main(){
    vec4 modelPosition = modelMatrix * vec4( position, 1.0 );

    modelPosition.xyz += (aStep*uTime);

    vec4 viewPosition = viewMatrix * modelPosition;

    gl_Position =  projectionMatrix * viewPosition;

    // è®¾ç½®é¡¶ç‚¹å¤§å°
    gl_PointSize =uSize;
}
</code></pre>
<h4 data-id="heading-13">å‘å°„ç‰‡å…ƒç€è‰²å™¨ (startpoint/fragment.glsl):</h4>
<pre><code class="hljs language-glsl" lang="glsl">uniform vec3 uColor;

void main(){
    float distanceToCenter = distance(gl_PointCoord,vec2(0.5));
    float strength = distanceToCenter*2.0;
    strength = 1.0-strength;
    strength = pow(strength,1.5);
    gl_FragColor = vec4(uColor,strength);
}
</code></pre>
<h3 data-id="heading-14">çˆ†ç‚¸é˜¶æ®µç€è‰²å™¨</h3>
<h4 data-id="heading-15">çˆ†ç‚¸é¡¶ç‚¹ç€è‰²å™¨ (fireworks/vertex.glsl):</h4>
<pre><code class="hljs language-glsl" lang="glsl">attribute float aScale;
attribute vec3 aRandom;

uniform float uTime;
uniform float uSize;

void main(){
    vec4 modelPosition = modelMatrix * vec4( position, 1.0 );

    modelPosition.xyz+=aRandom*uTime*10.0;

    vec4 viewPosition = viewMatrix * modelPosition;

    gl_Position =  projectionMatrix * viewPosition;

    // è®¾ç½®é¡¶ç‚¹å¤§å°
    gl_PointSize =uSize*aScale-(uTime*20.0);
}
</code></pre>
<h4 data-id="heading-16">çˆ†ç‚¸ç‰‡å…ƒç€è‰²å™¨ (fireworks/fragment.glsl):</h4>
<pre><code class="hljs language-glsl" lang="glsl">uniform vec3 uColor;

void main(){
    float distanceToCenter = distance(gl_PointCoord,vec2(0.5));
    float strength = distanceToCenter*2.0;
    strength = 1.0-strength;
    strength = pow(strength,1.5);
    gl_FragColor = vec4(uColor,strength);
}
</code></pre>
<h2 data-id="heading-17">æ¸²æŸ“å™¨å’Œæ§åˆ¶å™¨è®¾ç½®</h2>
<p>æœ€åï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®æ¸²æŸ“å™¨å’Œæ§åˆ¶å™¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆå§‹åŒ–æ¸²æŸ“å™¨</span>
<span class="hljs-keyword">const</span> renderer = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">WebGLRenderer</span>({ <span class="hljs-attr">alpha</span>: <span class="hljs-literal">true</span> });
<span class="hljs-comment">// renderer.shadowMap.enabled = true;</span>
<span class="hljs-comment">// renderer.shadowMap.type = THREE.BasicShadowMap;</span>
<span class="hljs-comment">// renderer.shadowMap.type = THREE.VSMShadowMap;</span>
renderer.<span class="hljs-property">outputEncoding</span> = <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">sRGBEncoding</span>;
renderer.<span class="hljs-property">toneMapping</span> = <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">ACESFilmicToneMapping</span>;
<span class="hljs-comment">// renderer.toneMapping = THREE.LinearToneMapping;</span>
<span class="hljs-comment">// renderer.toneMapping = THREE.ReinhardToneMapping;</span>
<span class="hljs-comment">// renderer.toneMapping = THREE.CineonToneMapping;</span>
renderer.<span class="hljs-property">toneMappingExposure</span> = <span class="hljs-number">0.1</span>;

<span class="hljs-comment">// è®¾ç½®æ¸²æŸ“å°ºå¯¸å¤§å°</span>
renderer.<span class="hljs-title function_">setSize</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>);

<span class="hljs-comment">// ç›‘å¬å±å¹•å¤§å°æ”¹å˜çš„å˜åŒ–ï¼Œè®¾ç½®æ¸²æŸ“çš„å°ºå¯¸</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"resize"</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// æ›´æ–°æ‘„åƒå¤´</span>
  camera.<span class="hljs-property">aspect</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span> / <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>;
  <span class="hljs-comment">// æ›´æ–°æ‘„åƒæœºçš„æŠ•å½±çŸ©é˜µ</span>
  camera.<span class="hljs-title function_">updateProjectionMatrix</span>();

  <span class="hljs-comment">// æ›´æ–°æ¸²æŸ“å™¨</span>
  renderer.<span class="hljs-title function_">setSize</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>);
  <span class="hljs-comment">// è®¾ç½®æ¸²æŸ“å™¨çš„åƒç´ æ¯”ä¾‹</span>
  renderer.<span class="hljs-title function_">setPixelRatio</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">devicePixelRatio</span>);
});

<span class="hljs-comment">// å°†æ¸²æŸ“å™¨æ·»åŠ åˆ°body</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(renderer.<span class="hljs-property">domElement</span>);

<span class="hljs-comment">// åˆå§‹åŒ–æ§åˆ¶å™¨</span>
<span class="hljs-keyword">const</span> controls = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrbitControls</span>(camera, renderer.<span class="hljs-property">domElement</span>);
<span class="hljs-comment">// è®¾ç½®æ§åˆ¶å™¨é˜»å°¼</span>
controls.<span class="hljs-property">enableDamping</span> = <span class="hljs-literal">true</span>;
<span class="hljs-comment">// è®¾ç½®è‡ªåŠ¨æ—‹è½¬</span>
controls.<span class="hljs-property">autoRotate</span> = <span class="hljs-literal">true</span>;
controls.<span class="hljs-property">autoRotateSpeed</span> = <span class="hljs-number">0.1</span>;
</code></pre>
<h2 data-id="heading-18">æ€»ç»“</h2>
<p>é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ Three.js åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„çƒŸèŠ±æ•ˆæœç³»ç»Ÿã€‚å…³é”®åœ¨äºï¼š</p>
<ol>
<li>åˆ©ç”¨ç²’å­ç³»ç»Ÿæ¨¡æ‹ŸçƒŸèŠ±çš„å‘å°„å’Œçˆ†ç‚¸æ•ˆæœ</li>
<li>ä½¿ç”¨è‡ªå®šä¹‰ç€è‰²å™¨å®ç°åŠ¨æ€çš„è§†è§‰æ•ˆæœ</li>
<li>é€šè¿‡æ—¶é—´æ§åˆ¶å®ç°çƒŸèŠ±çš„ä¸‰ä¸ªé˜¶æ®µï¼šå‘å°„ã€çˆ†ç‚¸å’Œæ¶ˆæ•£</li>
<li>æ·»åŠ éŸ³æ•ˆå¢å¼ºç”¨æˆ·ä½“éªŒ</li>
<li>ä½¿ç”¨ç¼“å†²å‡ ä½•ä½“é«˜æ•ˆåœ°å¤„ç†å¤§é‡ç²’å­</li>
</ol>
<p>è¿™ç§æŠ€æœ¯å¯ä»¥åº”ç”¨äºå„ç§ç‰¹æ•ˆåˆ¶ä½œï¼Œå¦‚çˆ†ç‚¸ã€æµæ˜Ÿé›¨ã€ç²’å­ç³»ç»Ÿç­‰ã€‚æŒæ¡äº†è¿™å¥—æŠ€æœ¯ï¼Œä½ å°±èƒ½åˆ›å»ºå‡ºæ›´åŠ ä¸°å¯Œå’Œç”ŸåŠ¨çš„ä¸‰ç»´åœºæ™¯ï¼Œä¸ºç”¨æˆ·å¸¦æ¥éœ‡æ’¼çš„è§†è§‰ä½“éªŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Three.js ç€è‰²å™¨åŠ å·¥æè´¨è¯¦è§£]]></title>    <link>https://juejin.cn/post/7599911091086475264</link>    <guid>https://juejin.cn/post/7599911091086475264</guid>    <pubDate>2026-01-27T14:32:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599911091086475264" data-draft-id="7599899147417911348" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Three.js ç€è‰²å™¨åŠ å·¥æè´¨è¯¦è§£"/> <meta itemprop="keywords" content="å‰ç«¯,three.js"/> <meta itemprop="datePublished" content="2026-01-27T14:32:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ç‹æ ¡é•¿"/> <meta itemprop="url" content="https://juejin.cn/user/2295436010076631"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Three.js ç€è‰²å™¨åŠ å·¥æè´¨è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2295436010076631/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ç‹æ ¡é•¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T14:32:02.000Z" title="Tue Jan 27 2026 14:32:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°</h2>
<p>æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Three.js ä¸­çš„ç€è‰²å™¨æ¥åŠ å·¥å’Œå®šåˆ¶æè´¨æ•ˆæœã€‚æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•é€šè¿‡ä¿®æ”¹æè´¨çš„ç€è‰²å™¨ä»£ç ï¼Œå®ç°åŠ¨æ€å˜å½¢ã€çº¹ç†å¤„ç†å’Œå¤æ‚è§†è§‰æ•ˆæœï¼Œä»è€Œåˆ›å»ºå‡ºç‹¬ç‰¹ä¸”å¯Œæœ‰è¡¨ç°åŠ›çš„ä¸‰ç»´åœºæ™¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3686a03a6f8f48efa9e739360b344a75~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv546L5qCh6ZW_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770129121&amp;x-signature=fiVSmKblHUuRI3Z2ZCbzcLVrAFQ%3D" alt="screenshot_2026-01-27_22-29-59.gif" loading="lazy"/></p>
<h2 data-id="heading-1">å‡†å¤‡å·¥ä½œ</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥å¿…è¦çš„ Three.js åº“å’Œç›¸å…³å·¥å…·ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-variable constant_">THREE</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"three"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">OrbitControls</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"three/examples/jsm/controls/OrbitControls"</span>;
<span class="hljs-keyword">import</span> gsap <span class="hljs-keyword">from</span> <span class="hljs-string">"gsap"</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> dat <span class="hljs-keyword">from</span> <span class="hljs-string">"dat.gui"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">RGBELoader</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"three/examples/jsm/loaders/RGBELoader.js"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">GLTFLoader</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"three/examples/jsm/loaders/GLTFLoader"</span>;
</code></pre>
<h2 data-id="heading-2">åœºæ™¯åˆå§‹åŒ–</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„ Three.js åœºæ™¯ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆå§‹åŒ–åœºæ™¯</span>
<span class="hljs-keyword">const</span> scene = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Scene</span>();

<span class="hljs-comment">// åˆ›å»ºé€è§†ç›¸æœº</span>
<span class="hljs-keyword">const</span> camera = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">PerspectiveCamera</span>(
  <span class="hljs-number">75</span>,
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span> / <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>,
  <span class="hljs-number">1</span>,
  <span class="hljs-number">50</span>
);

<span class="hljs-comment">// è®¾ç½®ç›¸æœºä½ç½®</span>
camera.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>);
scene.<span class="hljs-title function_">add</span>(camera);

<span class="hljs-comment">// åŠ å…¥è¾…åŠ©è½´ï¼Œå¸®åŠ©æˆ‘ä»¬æŸ¥çœ‹3ç»´åæ ‡è½´</span>
<span class="hljs-keyword">const</span> axesHelper = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">AxesHelper</span>(<span class="hljs-number">5</span>);
scene.<span class="hljs-title function_">add</span>(axesHelper);
</code></pre>
<h2 data-id="heading-3">ç¯å¢ƒçº¹ç†è®¾ç½®</h2>
<p>ä¸ºäº†åˆ›å»ºæ›´çœŸå®çš„å…‰ç…§æ•ˆæœï¼Œæˆ‘ä»¬æ·»åŠ ç¯å¢ƒçº¹ç†ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŠ è½½çº¹ç†</span>
<span class="hljs-keyword">const</span> textureLoader = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">TextureLoader</span>();

<span class="hljs-comment">// æ·»åŠ ç¯å¢ƒçº¹ç†</span>
<span class="hljs-keyword">const</span> cubeTextureLoader = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">CubeTextureLoader</span>();
<span class="hljs-keyword">const</span> envMapTexture = cubeTextureLoader.<span class="hljs-title function_">load</span>([
  <span class="hljs-string">"textures/environmentMaps/0/px.jpg"</span>,
  <span class="hljs-string">"textures/environmentMaps/0/nx.jpg"</span>,
  <span class="hljs-string">"textures/environmentMaps/0/py.jpg"</span>,
  <span class="hljs-string">"textures/environmentMaps/0/ny.jpg"</span>,
  <span class="hljs-string">"textures/environmentMaps/0/pz.jpg"</span>,
  <span class="hljs-string">"textures/environmentMaps/0/nz.jpg"</span>,
]);

<span class="hljs-comment">// è®¾ç½®æ–¹å‘å…‰</span>
<span class="hljs-keyword">const</span> directionLight = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">DirectionalLight</span>(<span class="hljs-string">"#ffffff"</span>, <span class="hljs-number">1</span>);
directionLight.<span class="hljs-property">castShadow</span> = <span class="hljs-literal">true</span>;
directionLight.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">200</span>);
scene.<span class="hljs-title function_">add</span>(directionLight);

<span class="hljs-comment">// åº”ç”¨ç¯å¢ƒçº¹ç†</span>
scene.<span class="hljs-property">environment</span> = envMapTexture;
scene.<span class="hljs-property">background</span> = envMapTexture;
</code></pre>
<h2 data-id="heading-4">æ¨¡å‹åŠ è½½ä¸æè´¨å¤„ç†</h2>
<p>åŠ è½½æ¨¡å‹å¹¶åº”ç”¨åŸºæœ¬æè´¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŠ è½½æ¨¡å‹çº¹ç†</span>
<span class="hljs-keyword">const</span> modelTexture = textureLoader.<span class="hljs-title function_">load</span>(<span class="hljs-string">"./models/LeePerrySmith/color.jpg"</span>);
<span class="hljs-comment">// åŠ è½½æ¨¡å‹çš„æ³•å‘çº¹ç†</span>
<span class="hljs-keyword">const</span> normalTexture = textureLoader.<span class="hljs-title function_">load</span>(<span class="hljs-string">"./models/LeePerrySmith/normal.jpg"</span>);

<span class="hljs-keyword">const</span> material = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">MeshStandardMaterial</span>({
  <span class="hljs-attr">map</span>: modelTexture,
  <span class="hljs-attr">normalMap</span>: normalTexture,
});
</code></pre>
<h2 data-id="heading-5">ç€è‰²å™¨ä¿®æ”¹çš„å…³é”®æŠ€æœ¯</h2>
<h3 data-id="heading-6">æ–¹æ³•ä¸€ï¼šä½¿ç”¨ onBeforeCompile ä¿®æ”¹ç°æœ‰æè´¨</h3>
<p>è¿™æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼Œå¯ä»¥åœ¨ Three.js è‡ªåŠ¨ç”Ÿæˆçš„ç€è‰²å™¨ä»£ç åŸºç¡€ä¸Šè¿›è¡Œä¿®æ”¹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> customUniforms = {
  <span class="hljs-attr">uTime</span>: {
    <span class="hljs-attr">value</span>: <span class="hljs-number">0</span>,
  },
};

material.<span class="hljs-property">onBeforeCompile</span> = <span class="hljs-function">(<span class="hljs-params">shader</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(shader.<span class="hljs-property">vertexShader</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(shader.<span class="hljs-property">fragmentShader</span>);
  
  <span class="hljs-comment">// ä¼ é€’æ—¶é—´å˜é‡åˆ°ç€è‰²å™¨</span>
  shader.<span class="hljs-property">uniforms</span>.<span class="hljs-property">uTime</span> = customUniforms.<span class="hljs-property">uTime</span>;
  
  <span class="hljs-comment">// åœ¨é¡¶ç‚¹ç€è‰²å™¨çš„ common éƒ¨åˆ†æ’å…¥è‡ªå®šä¹‰å‡½æ•°å’Œå˜é‡</span>
  shader.<span class="hljs-property">vertexShader</span> = shader.<span class="hljs-property">vertexShader</span>.<span class="hljs-title function_">replace</span>(
    <span class="hljs-string">"#include &lt;common&gt;"</span>,
    <span class="hljs-string">`
    #include &lt;common&gt;
    mat2 rotate2d(float _angle){
      return mat2(cos(_angle),-sin(_angle),
                  sin(_angle),cos(_angle));
    }
    uniform float uTime;
    `</span>
  );

  <span class="hljs-comment">// åœ¨é¡¶ç‚¹å˜æ¢å‰ä¿®æ”¹æ³•çº¿</span>
  shader.<span class="hljs-property">vertexShader</span> = shader.<span class="hljs-property">vertexShader</span>.<span class="hljs-title function_">replace</span>(
    <span class="hljs-string">"#include &lt;beginnormal_vertex&gt;"</span>,
    <span class="hljs-string">`
    #include &lt;beginnormal_vertex&gt;
    float angle = sin(position.y+uTime) *0.5;
    mat2 rotateMatrix = rotate2d(angle);
    
    objectNormal.xz = rotateMatrix * objectNormal.xz;
    `</span>
  );
  
  <span class="hljs-comment">// åœ¨é¡¶ç‚¹å˜æ¢å‰ä¿®æ”¹é¡¶ç‚¹ä½ç½®</span>
  shader.<span class="hljs-property">vertexShader</span> = shader.<span class="hljs-property">vertexShader</span>.<span class="hljs-title function_">replace</span>(
    <span class="hljs-string">"#include &lt;begin_vertex&gt;"</span>,
    <span class="hljs-string">`
    #include &lt;begin_vertex&gt;
    // float angle = transformed.y*0.5;
    // mat2 rotateMatrix = rotate2d(angle);
    
    transformed.xz = rotateMatrix * transformed.xz;
    `</span>
  );
};
</code></pre>
<h3 data-id="heading-7">æ–¹æ³•äºŒï¼šä¸ºæ·±åº¦æè´¨æ·»åŠ ç›¸åŒæ•ˆæœ</h3>
<p>å¯¹äºé˜´å½±ç­‰ç‰¹æ®Šæƒ…å†µï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸ºæ·±åº¦æè´¨æ·»åŠ ç›¸åŒçš„æ•ˆæœï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> depthMaterial = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">MeshDepthMaterial</span>({
  <span class="hljs-attr">depthPacking</span>: <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">RGBADepthPacking</span>,
});

depthMaterial.<span class="hljs-property">onBeforeCompile</span> = <span class="hljs-function">(<span class="hljs-params">shader</span>) =&gt;</span> {
  shader.<span class="hljs-property">uniforms</span>.<span class="hljs-property">uTime</span> = customUniforms.<span class="hljs-property">uTime</span>;
  shader.<span class="hljs-property">vertexShader</span> = shader.<span class="hljs-property">vertexShader</span>.<span class="hljs-title function_">replace</span>(
    <span class="hljs-string">"#include &lt;common&gt;"</span>,
    <span class="hljs-string">`
    #include &lt;common&gt;
    mat2 rotate2d(float _angle){
      return mat2(cos(_angle),-sin(_angle),
                  sin(_angle),cos(_angle));
    }
    uniform float uTime;
    `</span>
  );
  shader.<span class="hljs-property">vertexShader</span> = shader.<span class="hljs-property">vertexShader</span>.<span class="hljs-title function_">replace</span>(
    <span class="hljs-string">"#include &lt;begin_vertex&gt;"</span>,
    <span class="hljs-string">`
    #include &lt;begin_vertex&gt;
    float angle = sin(position.y+uTime) *0.5;
    mat2 rotateMatrix = rotate2d(angle);
    
    transformed.xz = rotateMatrix * transformed.xz;
    `</span>
  );

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"depthMaterial"</span>, shader.<span class="hljs-property">vertexShader</span>);
};
</code></pre>
<h2 data-id="heading-8">æ¨¡å‹åŠ è½½ä¸æè´¨åº”ç”¨</h2>
<p>åŠ è½½ 3D æ¨¡å‹å¹¶åº”ç”¨è‡ªå®šä¹‰æè´¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡å‹åŠ è½½</span>
<span class="hljs-keyword">const</span> gltfLoader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GLTFLoader</span>();
gltfLoader.<span class="hljs-title function_">load</span>(<span class="hljs-string">"./models/LeePerrySmith/LeePerrySmith.glb"</span>, <span class="hljs-function">(<span class="hljs-params">gltf</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> mesh = gltf.<span class="hljs-property">scene</span>.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>];
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(mesh);
  mesh.<span class="hljs-property">material</span> = material;
  mesh.<span class="hljs-property">castShadow</span> = <span class="hljs-literal">true</span>;
  <span class="hljs-comment">// è®¾å®šè‡ªå®šä¹‰çš„æ·±åº¦æè´¨</span>
  mesh.<span class="hljs-property">customDepthMaterial</span> = depthMaterial;
  scene.<span class="hljs-title function_">add</span>(mesh);
});

<span class="hljs-comment">// æ·»åŠ åœ°é¢</span>
<span class="hljs-keyword">const</span> plane = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Mesh</span>(
  <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">PlaneBufferGeometry</span>(<span class="hljs-number">20</span>, <span class="hljs-number">20</span>),
  <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">MeshStandardMaterial</span>()
);
plane.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">6</span>);
plane.<span class="hljs-property">receiveShadow</span> = <span class="hljs-literal">true</span>;
scene.<span class="hljs-title function_">add</span>(plane);
</code></pre>
<h2 data-id="heading-9">æ¸²æŸ“å™¨å’Œæ§åˆ¶å™¨è®¾ç½®</h2>
<p>è®¾ç½®æ¸²æŸ“å™¨å’Œæ§åˆ¶å™¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆå§‹åŒ–æ¸²æŸ“å™¨</span>
<span class="hljs-keyword">const</span> renderer = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">WebGLRenderer</span>();
<span class="hljs-comment">// è®¾ç½®æ¸²æŸ“å°ºå¯¸å¤§å°</span>
renderer.<span class="hljs-title function_">setSize</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>);
renderer.<span class="hljs-property">shadowMap</span>.<span class="hljs-property">enabled</span> = <span class="hljs-literal">true</span>;

<span class="hljs-comment">// ç›‘å¬å±å¹•å¤§å°æ”¹å˜çš„å˜åŒ–ï¼Œè®¾ç½®æ¸²æŸ“çš„å°ºå¯¸</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"resize"</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// æ›´æ–°æ‘„åƒå¤´</span>
  camera.<span class="hljs-property">aspect</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span> / <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>;
  <span class="hljs-comment">// æ›´æ–°æ‘„åƒæœºçš„æŠ•å½±çŸ©é˜µ</span>
  camera.<span class="hljs-title function_">updateProjectionMatrix</span>();

  <span class="hljs-comment">// æ›´æ–°æ¸²æŸ“å™¨</span>
  renderer.<span class="hljs-title function_">setSize</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>);
  <span class="hljs-comment">// è®¾ç½®æ¸²æŸ“å™¨çš„åƒç´ æ¯”ä¾‹</span>
  renderer.<span class="hljs-title function_">setPixelRatio</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">devicePixelRatio</span>);
});

<span class="hljs-comment">// å°†æ¸²æŸ“å™¨æ·»åŠ åˆ°body</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(renderer.<span class="hljs-property">domElement</span>);

<span class="hljs-comment">// åˆå§‹åŒ–æ§åˆ¶å™¨</span>
<span class="hljs-keyword">const</span> controls = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrbitControls</span>(camera, renderer.<span class="hljs-property">domElement</span>);
<span class="hljs-comment">// è®¾ç½®æ§åˆ¶å™¨é˜»å°¼</span>
controls.<span class="hljs-property">enableDamping</span> = <span class="hljs-literal">true</span>;
</code></pre>
<h2 data-id="heading-10">åŠ¨ç”»å¾ªç¯</h2>
<p>åœ¨åŠ¨ç”»å¾ªç¯ä¸­æ›´æ–°æ—¶é—´å˜é‡ï¼Œä»¥é©±åŠ¨ç€è‰²å™¨ä¸­çš„åŠ¨ç”»æ•ˆæœï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> clock = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Clock</span>();

<span class="hljs-keyword">function</span> <span class="hljs-title function_">animate</span>(<span class="hljs-params">t</span>) {
  controls.<span class="hljs-title function_">update</span>();
  <span class="hljs-keyword">const</span> time = clock.<span class="hljs-title function_">getElapsedTime</span>();
  customUniforms.<span class="hljs-property">uTime</span>.<span class="hljs-property">value</span> = time;
  <span class="hljs-title function_">requestAnimationFrame</span>(animate);
  <span class="hljs-comment">// ä½¿ç”¨æ¸²æŸ“å™¨æ¸²æŸ“ç›¸æœºçœ‹è¿™ä¸ªåœºæ™¯çš„å†…å®¹æ¸²æŸ“å‡ºæ¥</span>
  renderer.<span class="hljs-title function_">render</span>(scene, camera);
}

<span class="hljs-title function_">animate</span>();
</code></pre>
<h2 data-id="heading-11">è‡ªå®šä¹‰ç€è‰²å™¨æè´¨ç¤ºä¾‹</h2>
<p>é™¤äº†ä¿®æ”¹ç°æœ‰æè´¨ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºå®Œå…¨è‡ªå®šä¹‰çš„ç€è‰²å™¨æè´¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">let</span> basicMaterial = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">MeshBasicMaterial</span>({
  <span class="hljs-attr">color</span>: <span class="hljs-string">"#00ff00"</span>,
  <span class="hljs-attr">side</span>: <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">DoubleSide</span>,
});

<span class="hljs-keyword">const</span> basicUniforms = {
  <span class="hljs-attr">uTime</span>: {
    <span class="hljs-attr">value</span>: <span class="hljs-number">0</span>
  }
};

basicMaterial.<span class="hljs-property">onBeforeCompile</span> = <span class="hljs-function">(<span class="hljs-params">shader, renderer</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(shader);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(shader.<span class="hljs-property">vertexShader</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(shader.<span class="hljs-property">fragmentShader</span>);
  
  <span class="hljs-comment">// æ·»åŠ æ—¶é—´å˜é‡åˆ°ç€è‰²å™¨</span>
  shader.<span class="hljs-property">uniforms</span>.<span class="hljs-property">uTime</span> = basicUniforms.<span class="hljs-property">uTime</span>;
  
  <span class="hljs-comment">// åœ¨é¡¶ç‚¹ç€è‰²å™¨çš„ common éƒ¨åˆ†æ·»åŠ æ—¶é—´å˜é‡</span>
  shader.<span class="hljs-property">vertexShader</span> = shader.<span class="hljs-property">vertexShader</span>.<span class="hljs-title function_">replace</span>(
    <span class="hljs-string">'#include &lt;common&gt;'</span>,
    <span class="hljs-string">`
    #include &lt;common&gt;
    uniform float uTime;
    `</span>
  );
  
  <span class="hljs-comment">// åœ¨é¡¶ç‚¹å˜æ¢éƒ¨åˆ†æ·»åŠ åŠ¨æ€ä½ç§»</span>
  shader.<span class="hljs-property">vertexShader</span> = shader.<span class="hljs-property">vertexShader</span>.<span class="hljs-title function_">replace</span>(
    <span class="hljs-string">'#include &lt;begin_vertex&gt;'</span>,
    <span class="hljs-string">`
    #include &lt;begin_vertex&gt;
    transformed.x += sin(uTime)* 2.0;
    transformed.z += cos(uTime)* 2.0;
    `</span>
  );
};
</code></pre>
<h2 data-id="heading-12">GLSL ç€è‰²å™¨ä»£ç è¯¦è§£</h2>
<h3 data-id="heading-13">åŸºæœ¬ç€è‰²å™¨ (basic/vertex.glsl)</h3>
<pre><code class="hljs language-glsl" lang="glsl">uniform vec3 uColor;
uniform float uFrequency;
uniform float uScale;
uniform float uTime;

varying float vElevation;
varying vec2 vUv;

precision highp float;

void main(){
    vec4 modelPosition = modelMatrix * vec4( position, 1.0 );

    modelPosition.z += sin((modelPosition.x+uTime) * uFrequency)*uScale ;
    modelPosition.z += cos((modelPosition.y+uTime) * uFrequency)*uScale ;

    vElevation = modelPosition.z;
    gl_Position =  projectionMatrix * viewMatrix * modelPosition;
    vUv = uv;
}
</code></pre>
<h3 data-id="heading-14">åŸºç¡€ç‰‡å…ƒç€è‰²å™¨ (basic/fragment.glsl)</h3>
<pre><code class="hljs language-glsl" lang="glsl">uniform vec3 uColor;
varying float vElevation;
precision highp float;
varying vec2 vUv;

uniform sampler2D uTexture;

void main(){
    float alpha = (vElevation+0.1)+0.8;
    
    vec4 textureColor = texture2D(uTexture,vUv);
    textureColor.rgb*=alpha;
    gl_FragColor = textureColor;
}
</code></pre>
<h2 data-id="heading-15">æ·±åº¦ç€è‰²å™¨æŠ€æœ¯</h2>
<p>æ·±åº¦ç€è‰²å™¨é€šå¸¸ç”¨äºé˜´å½±è®¡ç®—å’Œç‰¹æ®Šè§†è§‰æ•ˆæœï¼Œå…¶ä¸­åŒ…å«äº†ä¸°å¯Œçš„ GLSL æŠ€æœ¯ï¼š</p>
<ul>
<li>éšæœºå‡½æ•°ï¼šç”¨äºç”Ÿæˆç¨‹åºåŒ–å™ªå£°</li>
<li>æ—‹è½¬å‡½æ•°ï¼šç”¨äºå˜æ¢ UV åæ ‡</li>
<li>å™ªå£°å‡½æ•°ï¼šç”¨äºåˆ›å»ºè‡ªç„¶æ•ˆæœ</li>
<li>Perlin å™ªå£°ï¼šç”¨äºé«˜è´¨é‡çš„ç¨‹åºåŒ–çº¹ç†</li>
</ul>
<h2 data-id="heading-16">æ€»ç»“</h2>
<p>é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ Three.js çš„ç€è‰²å™¨åŠ å·¥æè´¨æŠ€æœ¯ï¼š</p>
<ol>
<li>ä½¿ç”¨ <code>onBeforeCompile</code> å›è°ƒä¿®æ”¹ç°æœ‰æè´¨çš„ç€è‰²å™¨ä»£ç </li>
<li>å‘ç€è‰²å™¨ä¼ é€’è‡ªå®šä¹‰ uniform å˜é‡</li>
<li>åœ¨ç€è‰²å™¨çš„å…³é”®ä½ç½®æ’å…¥è‡ªå®šä¹‰ä»£ç </li>
<li>ä¸ºæ·±åº¦æè´¨åº”ç”¨ç›¸åŒçš„ä¿®æ”¹ä»¥ä¿è¯ä¸€è‡´æ€§</li>
<li>åˆ©ç”¨ GLSL ç¼–å†™é«˜æ•ˆçš„é¡¶ç‚¹å’Œç‰‡å…ƒç€è‰²å™¨</li>
</ol>
<p>è¿™ç§æ–¹æ³•è®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸å®Œå…¨é‡å†™æè´¨çš„æƒ…å†µä¸‹ï¼Œå¯¹ Three.js çš„å†…ç½®æè´¨è¿›è¡Œæ·±åº¦å®šåˆ¶ï¼Œåˆ›é€ å‡ºç‹¬ç‰¹çš„è§†è§‰æ•ˆæœã€‚æŒæ¡è¿™é¡¹æŠ€æœ¯æ˜¯å®ç°é«˜çº§è§†è§‰æ•ˆæœçš„å…³é”®æŠ€èƒ½ï¼Œå¯ä»¥ç”¨äºåˆ›å»ºåŠ¨æ€åœ°å½¢ã€æµä½“æ•ˆæœã€å˜å½¢åŠ¨ç”»ç­‰å„ç§å¤æ‚åœºæ™¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[â™¾ï¸ AI å…¨æ ˆé¡¹ç›®å®æˆ˜ç¬¬åå¤©ï¼šç”¨æ— é™æ»šåŠ¨å’ŒKeepAliveä¼˜åŒ–ä½ çš„æ–‡ç« åˆ—è¡¨]]></title>    <link>https://juejin.cn/post/7599826983887863851</link>    <guid>https://juejin.cn/post/7599826983887863851</guid>    <pubDate>2026-01-27T14:38:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599826983887863851" data-draft-id="7599843186203033642" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="â™¾ï¸ AI å…¨æ ˆé¡¹ç›®å®æˆ˜ç¬¬åå¤©ï¼šç”¨æ— é™æ»šåŠ¨å’ŒKeepAliveä¼˜åŒ–ä½ çš„æ–‡ç« åˆ—è¡¨"/> <meta itemprop="keywords" content="æ€§èƒ½ä¼˜åŒ–,React.js"/> <meta itemprop="datePublished" content="2026-01-27T14:38:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¥ç§˜çš„çŒªå¤´"/> <meta itemprop="url" content="https://juejin.cn/user/793223472877051"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            â™¾ï¸ AI å…¨æ ˆé¡¹ç›®å®æˆ˜ç¬¬åå¤©ï¼šç”¨æ— é™æ»šåŠ¨å’ŒKeepAliveä¼˜åŒ–ä½ çš„æ–‡ç« åˆ—è¡¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/793223472877051/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¥ç§˜çš„çŒªå¤´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T14:38:30.000Z" title="Tue Jan 27 2026 14:38:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å“ˆå–½ï¼Œæ˜é‡‘çš„å„ä½å…¨æ ˆç»ƒä¹ ç”Ÿä»¬ï¼ğŸ‘‹ æ¬¢è¿å›åˆ° <strong>AI å…¨æ ˆé¡¹ç›®å®æˆ˜</strong> çš„ç¬¬åå¤©ï¼</p>
<p>æ˜¨å¤©ï¼Œæˆ‘ä»¬ç”¨ <strong>è§‚å¯Ÿè€…æ¨¡å¼</strong> ç»™å›¾ç‰‡åŠ ä¸Šäº†æ‡’åŠ è½½ï¼Œè®©æ–‡ç« åˆ—è¡¨çš„å›¾ç‰‡â€œæŒ‰éœ€åˆ†é…â€ï¼Œå¤§å¤§æå‡äº†é¦–å±æ€§èƒ½ã€‚
ä»Šå¤©ï¼Œæˆ‘ä»¬è¦ç»§ç»­æ·±æŒ–è¿™ä¸ªåˆ—è¡¨ï¼Œè®©å®ƒä¸ä»…èƒ½æ‡’åŠ è½½å›¾ç‰‡ï¼Œè¿˜èƒ½<strong>è‡ªåŠ¨åŠ è½½æ›´å¤šå†…å®¹</strong>ï¼ˆInfinite Scrollï¼‰ï¼Œå½»åº•å‘Šåˆ«ä¼ ç»Ÿçš„â€œä¸‹ä¸€é¡µâ€æŒ‰é’®ã€‚
æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬è¦è§£å†³ä¸€ä¸ªå›°æ‰°æ— æ•°å‰ç«¯å¼€å‘è€…çš„ç—›ç‚¹ï¼š<strong>å½“ä½ ç‚¹è¿›æ–‡ç« è¯¦æƒ…å†é€€å›åˆ—è¡¨æ—¶ï¼Œé¡µé¢ç«Ÿç„¶é‡ç½®å›é¡¶éƒ¨äº†ï¼Ÿ</strong> ğŸ˜±
åˆ«æ…Œï¼Œä»Šå¤©æˆ‘ä»¬å°±ç”¨ <code>KeepAlive</code> æ¥æå®šè¿™ä¸ªâ€œè·¯ç”±çŠ¶æ€ä¿æŒâ€çš„ä¼˜åŒ–ï¼</p>
<hr/>
<h2 data-id="heading-0">ğŸ“œ ä¸€ã€ æ— é™æ»šåŠ¨ï¼šå‘Šåˆ«â€œä¸‹ä¸€é¡µâ€</h2>
<p>åœ¨ç§»åŠ¨ç«¯ï¼Œç”¨æˆ·ä¹ æƒ¯äº†â€œåˆ·â€çš„æ„Ÿè§‰ã€‚æŠ–éŸ³ã€å°çº¢ä¹¦ã€ä»Šæ—¥å¤´æ¡ï¼Œæ²¡æœ‰å“ªä¸ª App æ˜¯è®©ä½ ç‚¹â€œä¸‹ä¸€é¡µâ€çš„ã€‚
æˆ‘ä»¬è¦å®ç°çš„æ•ˆæœæ˜¯ï¼š<strong>å½“ç”¨æˆ·æ»‘åˆ°åº•éƒ¨æ—¶ï¼Œè‡ªåŠ¨è¯·æ±‚ä¸‹ä¸€é¡µæ•°æ®å¹¶æ‹¼æ¥åˆ°åˆ—è¡¨ä¸­</strong>ï¼Œè®©ç”¨æˆ·æ„Ÿè§‰å†…å®¹æ˜¯æ— ç©·æ— å°½çš„ã€‚</p>
<h3 data-id="heading-1">1.1 çŠ¶æ€ç®¡ç†ï¼šZustand ä»“åº“è®¾è®¡</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¼ºå¤§çš„â€œç®¡å®¶â€æ¥ç®¡ç†åˆ—è¡¨çš„çŠ¶æ€ã€‚æ‰“å¼€ <code>src/store/home.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// frontend/notes/src/store/home.ts</span>
<span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand'</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">HomeState</span> {
    <span class="hljs-attr">posts</span>: <span class="hljs-title class_">Post</span>[];      <span class="hljs-comment">// å­˜æ–‡ç« åˆ—è¡¨æ•°æ®</span>
    <span class="hljs-attr">page</span>: <span class="hljs-built_in">number</span>;       <span class="hljs-comment">// å½“å‰åŠ è½½åˆ°ç¬¬å‡ é¡µ</span>
    <span class="hljs-attr">loading</span>: <span class="hljs-built_in">boolean</span>;   <span class="hljs-comment">// æ˜¯å¦æ­£åœ¨è¯·æ±‚ä¸­ï¼ˆé˜²æ­¢é‡å¤è§¦å‘ï¼‰</span>
    <span class="hljs-attr">hasMore</span>: <span class="hljs-built_in">boolean</span>;   <span class="hljs-comment">// åç«¯è¿˜æœ‰æ²¡æœ‰æ•°æ®äº†ï¼Ÿ</span>
    <span class="hljs-attr">loadMore</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;; <span class="hljs-comment">// åŠ è½½åŠ¨ä½œ</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useHomeStore = create&lt;<span class="hljs-title class_">HomeState</span>&gt;(<span class="hljs-function">(<span class="hljs-params">set, get</span>) =&gt;</span> ({
    <span class="hljs-attr">posts</span>: [],
    <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">hasMore</span>: <span class="hljs-literal">true</span>,

    <span class="hljs-attr">loadMore</span>: <span class="hljs-keyword">async</span> () =&gt; {
        <span class="hljs-comment">// ğŸ›‘ é˜²æŠ–ï¼šå¦‚æœæ­£åœ¨åŠ è½½ï¼Œæˆ–è€…æ²¡æ•°æ®äº†ï¼Œç›´æ¥è¿”å›</span>
        <span class="hljs-keyword">if</span>(<span class="hljs-title function_">get</span>().<span class="hljs-property">loading</span> || !<span class="hljs-title function_">get</span>().<span class="hljs-property">hasMore</span>) <span class="hljs-keyword">return</span>; 
        
        <span class="hljs-title function_">set</span>({ <span class="hljs-attr">loading</span>: <span class="hljs-literal">true</span> }); <span class="hljs-comment">// ğŸ”’ ä¸Šé”</span>

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è¯·æ±‚å½“å‰é¡µæ•°æ®</span>
            <span class="hljs-keyword">const</span> { items } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchPosts</span>(<span class="hljs-title function_">get</span>().<span class="hljs-property">page</span>);
            
            <span class="hljs-keyword">if</span>(items.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) { 
                <span class="hljs-comment">// ğŸš« æ²¡æ•°æ®äº†ï¼Œæ ‡è®° hasMore ä¸º false</span>
                <span class="hljs-title function_">set</span>({ <span class="hljs-attr">hasMore</span>: <span class="hljs-literal">false</span> });
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// âœ… æœ‰æ•°æ®ï¼š</span>
                <span class="hljs-comment">// 1. æŠŠæ–°æ•°æ®æ‹¼æ¥åˆ°æ—§æ•°æ®åé¢</span>
                <span class="hljs-comment">// 2. é¡µç  + 1</span>
                <span class="hljs-title function_">set</span>({
                    <span class="hljs-attr">posts</span>: [...<span class="hljs-title function_">get</span>().<span class="hljs-property">posts</span>, ...items],
                    <span class="hljs-attr">page</span>: <span class="hljs-title function_">get</span>().<span class="hljs-property">page</span> + <span class="hljs-number">1</span>,
                })
            }
        } <span class="hljs-keyword">catch</span>(err) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŠ è½½å¤±è´¥'</span>, err);
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-title function_">set</span>({ <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span> }); <span class="hljs-comment">// ğŸ”“ è§£é”</span>
        }
    }
}))
</code></pre>
<p><strong>ğŸ§  æ ¸å¿ƒé€»è¾‘ï¼š</strong></p>
<ul>
<li><code>posts: [...get().posts, ...items]</code>ï¼šè¿™æ˜¯å®ç°æ— é™æ»šåŠ¨çš„å…³é”®ã€‚æˆ‘ä»¬ä¸æ˜¯æ›¿æ¢æ•°æ®ï¼Œè€Œæ˜¯<strong>è¿½åŠ </strong>æ•°æ®ã€‚</li>
<li><code>loading</code> é”ï¼šç½‘ç»œè¯·æ±‚æ˜¯å¼‚æ­¥çš„ï¼Œç”¨æˆ·æ»‘åŠ¨è¿‡å¿«å¯èƒ½å¯¼è‡´çŸ­æ—¶é—´å†…è§¦å‘å¤šæ¬¡è¯·æ±‚ï¼Œå¯¼è‡´æ•°æ®é‡å¤ã€‚å¿…é¡»åŠ é”ï¼</li>
</ul>
<h3 data-id="heading-2">1.2 ç»„ä»¶å®ç°ï¼šInfiniteScroll</h3>
<p>æœ‰äº†ä»“åº“ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªé€šç”¨çš„ UI ç»„ä»¶æ¥è§¦å‘ <code>loadMore</code>ã€‚
æ‰“å¼€ <code>src/components/infiniteScroll.tsx</code>ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬å†æ¬¡è¯·å‡ºäº†è€æœ‹å‹ â€”â€” <strong>IntersectionObserver</strong>ã€‚
æ€è·¯å¾ˆç®€å•ï¼š<strong>åœ¨åˆ—è¡¨çš„æœ€åº•éƒ¨æ”¾ä¸€ä¸ªçœ‹ä¸è§çš„â€œå“¨å…µâ€å…ƒç´ ï¼ˆSentinelï¼‰ï¼Œä¸€æ—¦å“¨å…µè¿›å…¥è§†çª—ï¼Œå°±è¯´æ˜ç”¨æˆ·æ»‘åˆ°åº•äº†ã€‚</strong></p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// frontend/notes/src/components/infiniteScroll.tsx</span>
<span class="hljs-keyword">import</span> { useRef, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">InfiniteScrollProps</span> {
    <span class="hljs-attr">hasMore</span>: <span class="hljs-built_in">boolean</span>;
    isLoading?: <span class="hljs-built_in">boolean</span>;
    <span class="hljs-attr">onLoadMore</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;
    <span class="hljs-attr">children</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">ReactNode</span>; <span class="hljs-comment">// åˆ—è¡¨å†…å®¹ä½œä¸º children ä¼ å…¥</span>
}

<span class="hljs-keyword">const</span> <span class="hljs-title class_">InfiniteScroll</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">InfiniteScrollProps</span>&gt; = <span class="hljs-function">(<span class="hljs-params">{
    hasMore,
    isLoading = <span class="hljs-literal">false</span>,
    onLoadMore,
    children,
}</span>) =&gt;</span> {
    <span class="hljs-comment">// ğŸ•µï¸â€â™€ï¸ å“¨å…µå…ƒç´ çš„å¼•ç”¨</span>
    <span class="hljs-keyword">const</span> sentinelRef = useRef&lt;<span class="hljs-title class_">HTMLDivElement</span>&gt;(<span class="hljs-literal">null</span>);

    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// å¦‚æœæ²¡æ•°æ®äº†æˆ–è€…æ­£åœ¨åŠ è½½ï¼Œå°±ä¸éœ€è¦è§‚å¯Ÿäº†</span>
        <span class="hljs-keyword">if</span>(!hasMore || isLoading) <span class="hljs-keyword">return</span>;

        <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntersectionObserver</span>(<span class="hljs-function">(<span class="hljs-params">entries</span>) =&gt;</span> {
            <span class="hljs-comment">// entries[0] å°±æ˜¯æˆ‘ä»¬çš„å“¨å…µ</span>
            <span class="hljs-keyword">if</span>(entries[<span class="hljs-number">0</span>].<span class="hljs-property">isIntersecting</span>) { 
                <span class="hljs-comment">// ğŸš¨ å“¨å…µå‡ºç°ï¼è§¦å‘åŠ è½½ï¼</span>
                <span class="hljs-title function_">onLoadMore</span>();
            }
        },{
            <span class="hljs-attr">threshold</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// åªè¦éœ²ä¸ªå¤´å°±è§¦å‘</span>
            <span class="hljs-comment">// rootMargin: '100px' // å…¶å®å¯ä»¥è®¾ç½®æå‰ 100px è§¦å‘ï¼Œä½“éªŒæ›´å¥½</span>
        });

        <span class="hljs-keyword">if</span>(sentinelRef.<span class="hljs-property">current</span>) {
            observer.<span class="hljs-title function_">observe</span>(sentinelRef.<span class="hljs-property">current</span>);
        }

        <span class="hljs-comment">// ğŸ§¹ æ¸…ç†å‡½æ•°ï¼šç»„ä»¶å¸è½½æ—¶å–æ¶ˆè§‚å¯Ÿ</span>
        <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-keyword">if</span>(sentinelRef.<span class="hljs-property">current</span>) {
                observer.<span class="hljs-title function_">unobserve</span>(sentinelRef.<span class="hljs-property">current</span>);
            }
        }
    }, [onLoadMore, hasMore, isLoading]);

    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
            {children}
            
            {/* ğŸ•µï¸â€â™€ï¸ è¿™æ˜¯ä¸€ä¸ªçœ‹ä¸è§çš„å“¨å…µ div */}
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{sentinelRef}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"h-4"</span>/&gt;</span>
            
            {/* åŠ è½½çŠ¶æ€æç¤º */}
            {
                isLoading &amp;&amp; (
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-center text-sm py-4 text-muted-foreground"</span>&gt;</span>
                        åŠ è½½ä¸­...
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                )
            }
             {/* åº•çº¿æç¤º */}
            {
                !hasMore &amp;&amp; (
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-center text-sm py-4 text-muted-foreground"</span>&gt;</span>
                        æ²¡æœ‰æ›´å¤šå†…å®¹äº† ~
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                )
            }
        <span class="hljs-tag">&lt;/&gt;</span></span>
    )
}
</code></pre>
<h3 data-id="heading-3">1.3 ç»„è£…ï¼šHome é¡µé¢</h3>
<p>æœ€åï¼Œåœ¨ <code>src/pages/Home.tsx</code> é‡ŒæŠŠå®ƒä»¬ç»„åˆèµ·æ¥ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// frontend/notes/src/pages/Home.tsx</span>
&lt;<span class="hljs-title class_">InfiniteScroll</span>
    hasMore={hasMore}
    isLoading={loading}
    onLoadMore={loadMore}
&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
    {
        posts.map(post =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">PostItem</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{post.id}</span> <span class="hljs-attr">post</span>=<span class="hljs-string">{post}</span> /&gt;</span>
        ))
    }
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span>
&lt;/<span class="hljs-title class_">InfiniteScroll</span>&gt;
</code></pre>
<p>ç°åœ¨ï¼Œå½“ä½ æ»‘åŠ¨é¡µé¢ï¼Œåˆ°åº•éƒ¨æ—¶å°±ä¼šè‡ªåŠ¨åŠ è½½ä¸‹ä¸€é¡µï¼Œä¸æ»‘æµç•…ï¼</p>
<hr/>
<h2 data-id="heading-4">ğŸš€ äºŒã€ è·¯ç”±è·³è½¬ä¸åµŒå¥—</h2>
<p>æ–‡ç« åˆ—è¡¨ä¸ä»…è¦èƒ½çœ‹ï¼Œè¿˜è¦èƒ½ç‚¹ã€‚
æˆ‘ä»¬åœ¨ <code>PostItem</code> é‡Œå·²ç»å†™äº†è·³è½¬é€»è¾‘ï¼š<code>onClick={() =&gt; navigate(/post/${post.id})}</code>ã€‚
ç°åœ¨æˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸‹è·¯ç”±ã€‚</p>
<p>æ‰“å¼€ <code>src/router/index.tsx</code>ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// frontend/notes/src/router/index.tsx</span>

<span class="hljs-comment">// æ‡’åŠ è½½è¯¦æƒ…é¡µç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">PostLayout</span> = <span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/layouts/PostLayout'</span>))
<span class="hljs-keyword">const</span> <span class="hljs-title class_">PostDetail</span> = <span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/pages/post'</span>))

&lt;<span class="hljs-title class_">Routes</span>&gt;
    {<span class="hljs-comment">/* ...å…¶ä»–è·¯ç”± */</span>}
    
    {<span class="hljs-comment">/* ğŸ“ æ–‡ç« è¯¦æƒ…è·¯ç”±åµŒå¥— */</span>}
    &lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"/post"</span> element={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">PostLayout</span>/&gt;</span></span>}&gt;
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">":id"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">PostDetail</span> /&gt;</span>}/&gt;</span>
    &lt;/<span class="hljs-title class_">Route</span>&gt;
&lt;/<span class="hljs-title class_">Routes</span>&gt;
</code></pre>
<p>è¿™é‡Œç”¨åˆ°äº† <strong>åµŒå¥—è·¯ç”±</strong>ã€‚<code>PostLayout</code> æ˜¯ä¸€ä¸ªå¸ƒå±€å®¹å™¨ï¼ˆè™½ç„¶ç›®å‰å¾ˆç®€å•ï¼Œåªè¿”å›äº† <code>&lt;Outlet /&gt;</code>ï¼‰ï¼Œ<code>PostDetail</code> æ˜¯å…·ä½“çš„è¯¦æƒ…é¡µã€‚è¿™ç§ç»“æ„æ–¹ä¾¿ä»¥åç»™æ‰€æœ‰æ–‡ç« è¯¦æƒ…é¡µç»Ÿä¸€æ·»åŠ å¤´éƒ¨ã€åº•éƒ¨æˆ–è€…ä¾§è¾¹æ ã€‚</p>
<hr/>
<h2 data-id="heading-5">ğŸ’¾ ä¸‰ã€ æè‡´ä½“éªŒï¼šKeepAlive é¡µé¢ç¼“å­˜</h2>
<p>å¥½çš„ï¼ŒåŠŸèƒ½éƒ½åšå®Œäº†ï¼Œä½†ä½“éªŒä¸Šè¿˜æœ‰ä¸€ä¸ªå¤§å‘ã€‚
<strong>åœºæ™¯å¤ç°</strong>ï¼š</p>
<ol>
<li>ç”¨æˆ·åœ¨é¦–é¡µåˆ·äº† 5 é¡µæ–‡ç« ï¼Œæ»‘åˆ°äº†ç¬¬ 50 æ¡ã€‚</li>
<li>ç”¨æˆ·ç‚¹å‡»ç¬¬ 50 æ¡æ–‡ç« ï¼Œè¿›å…¥è¯¦æƒ…é¡µçœ‹äº†ä¸€ä¼šå„¿ã€‚</li>
<li>ç”¨æˆ·ç‚¹å‡»â€œè¿”å›â€ï¼Œå›åˆ°é¦–é¡µã€‚</li>
<li><strong>ç¾éš¾å‘ç”Ÿ</strong>ï¼šé¦–é¡µé‡æ–°æ¸²æŸ“äº†ï¼æ•°æ®é‡æ–°ä»ç¬¬ 1 é¡µåŠ è½½ï¼Œæ»šåŠ¨æ¡å›åˆ°äº†é¡¶éƒ¨ï¼ç”¨æˆ·æƒ³çœ‹ç¬¬ 51 æ¡ï¼Œå¾—é‡æ–°æ»‘åŠå¤©ã€‚ğŸ¤¬</li>
</ol>
<p>è¿™åœ¨ SPAï¼ˆå•é¡µåº”ç”¨ï¼‰ä¸­æ˜¯é»˜è®¤è¡Œä¸ºï¼Œå› ä¸ºç»„ä»¶è¢«å¸è½½äº†ã€‚
ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ <strong>KeepAliveï¼ˆé¡µé¢ç¼“å­˜ï¼‰</strong>ã€‚React å®˜æ–¹æš‚æ—¶æ²¡æœ‰å®Œç¾çš„æ–¹æ¡ˆï¼Œæˆ‘ä»¬ä½¿ç”¨ç¤¾åŒºä¼˜ç§€çš„åº“ <code>react-activation</code>ã€‚</p>
<h3 data-id="heading-6">3.1 å¼•å…¥ AliveScope</h3>
<p>é¦–å…ˆï¼Œåœ¨è·¯ç”±çš„æ ¹éƒ¨åŒ…è£¹ <code>AliveScope</code>ã€‚å®ƒå°±åƒä¸€ä¸ªâ€œä¼‘çœ ä»“â€ï¼Œè´Ÿè´£ç®¡ç†é‚£äº›è¢«ç¼“å­˜çš„ç»„ä»¶èŠ‚ç‚¹ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// frontend/notes/src/router/index.tsx</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AliveScope</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-activation'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">RouterConfig</span>(<span class="hljs-params">{children}</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Router</span>&gt;</span>
      {/* âš¡ï¸ èµ‹äºˆåº”ç”¨ KeepAlive èƒ½åŠ› */}
      <span class="hljs-tag">&lt;<span class="hljs-name">AliveScope</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Loading</span>/&gt;</span>}&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
             {/* ... */}
          <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">AliveScope</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Router</span>&gt;</span></span>
  )
}
</code></pre>
<h3 data-id="heading-7">3.2 å°è£… KeepAliveHome</h3>
<p>æˆ‘ä»¬éœ€è¦æŠŠ Home ç»„ä»¶â€œåŒ…â€èµ·æ¥ï¼Œå‘Šè¯‰å®ƒï¼šâ€œä½ ä¸è¦å¸è½½ï¼Œä½ åªæ˜¯ç¡ç€äº†â€ã€‚
æ–°å»º <code>src/components/KeepAliveHome.tsx</code>ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// frontend/notes/src/components/KeepAliveHome.tsx</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">KeepAlive</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-activation'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Home</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@/pages/Home'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">KeepAliveHome</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">return</span> (
        <span class="hljs-comment">// ğŸ”’ name: ç¼“å­˜çš„å”¯ä¸€æ ‡è¯†</span>
        <span class="hljs-comment">// ğŸ’¾ saveScrollPosition="screen": è‡ªåŠ¨ä¿å­˜æ»šåŠ¨ä½ç½®ï¼ç¥å™¨ï¼</span>
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">KeepAlive</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"home"</span> <span class="hljs-attr">saveScrollPosition</span>=<span class="hljs-string">"screen"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Home</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span></span>
    )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">KeepAliveHome</span>;
</code></pre>
<h3 data-id="heading-8">3.3 æ›¿æ¢è·¯ç”±ç»„ä»¶</h3>
<p>æœ€åï¼Œä¿®æ”¹è·¯ç”±é…ç½®ï¼Œè®© <code>/</code> è·¯å¾„æŒ‡å‘è¿™ä¸ªè¢«åŒ…è£¹çš„ <code>KeepAliveHome</code>ï¼Œè€Œä¸æ˜¯åŸå§‹çš„ <code>Home</code>ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// frontend/notes/src/router/index.tsx</span>

<span class="hljs-comment">// ğŸ”„ æ›¿æ¢å¼•å…¥</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">Home</span> = <span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/components/KeepAliveHome'</span>));

<span class="hljs-comment">// ...</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">MainLayout</span>/&gt;</span>}&gt;
    <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">""</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Home</span> /&gt;</span>} /&gt; {/* è¿™é‡Œæ¸²æŸ“çš„æ˜¯ KeepAliveHome */}
    {/* ... */}
<span class="hljs-tag">&lt;/<span class="hljs-name">Route</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-9">3.4 è§è¯å¥‡è¿¹</h3>
<p>ç°åœ¨ï¼Œä½ å†å»é¦–é¡µæ»‘åˆ°ç¬¬ 50 æ¡ï¼Œç‚¹è¿›å»ï¼Œå†é€€å›æ¥ã€‚
ä½ ä¼šå‘ç°ï¼š<strong>é¡µé¢æ²¡æœ‰åˆ·æ–°ï¼Œæ»šåŠ¨æ¡çº¹ä¸ä¸åŠ¨ï¼Œæ•°æ®è¿˜åœ¨é‚£é‡Œï¼</strong> ğŸ‰</p>
<p><strong>åŸç†æ­ç§˜</strong>ï¼š
<code>KeepAlive</code> å¹¶ä¸ä¼šçœŸçš„å¸è½½ç»„ä»¶ï¼Œè€Œæ˜¯æŠŠç»„ä»¶çš„ DOM èŠ‚ç‚¹ä»æ–‡æ¡£æµä¸­ç§»èµ°ï¼ˆæ¯”å¦‚æ”¾åˆ°ä¸€ä¸ªçœ‹ä¸è§çš„ <code>div</code> é‡Œï¼‰ï¼Œæˆ–è€…è®¾ä¸º <code>display: none</code>ã€‚å½“è·¯ç”±åˆ‡å›æ¥æ—¶ï¼Œå†æŠŠè¿™äº› DOM èŠ‚ç‚¹ç§»å›æ¥ã€‚è¿™æ ·ï¼Œç»„ä»¶çš„çŠ¶æ€ï¼ˆStateï¼‰å’Œ DOM çŠ¶æ€ï¼ˆæ»šåŠ¨ä½ç½®ã€è¾“å…¥æ¡†å†…å®¹ï¼‰éƒ½èƒ½å®Œç¾ä¿ç•™ã€‚</p>
<hr/>
<h2 data-id="heading-10">ğŸ¬ æ€»ç»“</h2>
<p>ä»Šå¤©æˆ‘ä»¬å®Œæˆäº†ä¸€æ¬¡ç”¨æˆ·ä½“éªŒçš„å·¨å¤§é£è·ƒï¼š</p>
<ol>
<li><strong>æ— é™æ»šåŠ¨ (InfiniteScroll)</strong>ï¼šåˆ©ç”¨ <code>IntersectionObserver</code> å’Œ <code>Zustand</code> å®ç°äº†è‡ªåŠ¨åŠ è½½æ›´å¤šï¼Œè®©å†…å®¹æµæ›´åŠ é¡ºæ»‘ã€‚</li>
<li><strong>è·¯ç”±åµŒå¥—</strong>ï¼šè§„èŒƒäº†æ–‡ç« è¯¦æƒ…é¡µçš„è·¯ç”±ç»“æ„ã€‚</li>
<li><strong>é¡µé¢ç¼“å­˜ (KeepAlive)</strong>ï¼šè§£å†³äº† SPA åº”ç”¨â€œè¿”å›é‡ç½®â€çš„é¡½ç–¾ï¼Œè®©æˆ‘ä»¬çš„ Web App æ‹¥æœ‰äº†åŸç”Ÿ App èˆ¬çš„ä¸æ»‘ä½“éªŒã€‚</li>
</ol>
<p>åˆ°è¿™é‡Œï¼Œæ–‡ç« åˆ—è¡¨çš„æ ¸å¿ƒåŠŸèƒ½å·²ç»éå¸¸å®Œå–„äº†ã€‚æ˜å¤©ï¼Œæˆ‘ä»¬å°†è¿›å…¥ <strong>æ–‡ç« è¯¦æƒ…é¡µ</strong> çš„å¼€å‘ï¼Œä¸ä»…è¦å±•ç¤º Markdown å†…å®¹ï¼Œè¿˜è¦å®ç°ç‚¹èµã€è¯„è®ºç­‰äº’åŠ¨åŠŸèƒ½ï¼</p>
<p>ä¿æŒå¥½å¥‡ï¼Œä¿æŒçƒ­çˆ±ï¼Œæˆ‘ä»¬æ˜å¤©è§ï¼ğŸ‘‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TypeScript è£…é¥°å™¨å…¥é—¨æ ¸å¿ƒç”¨æ³•]]></title>    <link>https://juejin.cn/post/7599910677578612736</link>    <guid>https://juejin.cn/post/7599910677578612736</guid>    <pubDate>2026-01-27T14:41:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599910677578612736" data-draft-id="7599911091086491648" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="TypeScript è£…é¥°å™¨å…¥é—¨æ ¸å¿ƒç”¨æ³•"/> <meta itemprop="keywords" content="TypeScript"/> <meta itemprop="datePublished" content="2026-01-27T14:41:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¦‚æœä½ å¥½"/> <meta itemprop="url" content="https://juejin.cn/user/2272012281328215"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            TypeScript è£…é¥°å™¨å…¥é—¨æ ¸å¿ƒç”¨æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2272012281328215/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¦‚æœä½ å¥½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T14:41:49.000Z" title="Tue Jan 27 2026 14:41:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯è£…é¥°å™¨ï¼Ÿ</h2>
<p>è£…é¥°å™¨å°±æ˜¯<strong>æ™®é€šå‡½æ•°</strong>ï¼Œç”¨ <code>@è£…é¥°å™¨å</code> è´´åœ¨ç±»ã€æ–¹æ³•ã€å±æ€§ä¸Šï¼Œä½œç”¨å°±æ˜¯<strong>ç»™è¢«è£…é¥°çš„ä¸œè¥¿åŠ é¢å¤–åŠŸèƒ½</strong>ï¼Œä»…æ­¤è€Œå·²ã€‚</p>
<h2 data-id="heading-1">äºŒã€æœ€åŸºç¡€ç”¨æ³•ï¼šç±»è£…é¥°å™¨</h2>
<p>ç›´æ¥è´´åœ¨ç±»ä¸Šï¼Œå‡½æ•°å”¯ä¸€å‚æ•°æ˜¯<strong>è¢«è£…é¥°ç±»çš„æ„é€ å‡½æ•°</strong>ï¼Œæœ€ç®€å•çš„ä¾‹å­ï¼šç»™ç±»åŠ é™æ€å±æ€§ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å®šä¹‰è£…é¥°å™¨å‡½æ•°ï¼šç»™ç±»åŠ ç‰ˆæœ¬å·</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">addVersion</span>(<span class="hljs-params">target</span>) {
  target.<span class="hljs-property">version</span> = <span class="hljs-string">'1.0.0'</span>; <span class="hljs-comment">// ç»™ç±»æŒ‚è½½é™æ€å±æ€§</span>
}

<span class="hljs-comment">// ç”¨@è´´åœ¨ç±»ä¸Šï¼Œå®Œæˆè£…é¥°</span>
<span class="hljs-meta">@addVersion</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> {}

<span class="hljs-comment">// ç›´æ¥ä½¿ç”¨è£…é¥°å™¨åŠ çš„å±æ€§</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">MyClass</span>.<span class="hljs-property">version</span>); <span class="hljs-comment">// è¾“å‡ºï¼š1.0.0</span>
</code></pre>
<p>æ ¸å¿ƒé€»è¾‘ï¼š<code>@addVersion</code> ç­‰ä»·äº <code>addVersion(MyClass)</code>ï¼ŒæŠŠç±»ä¼ ç»™è£…é¥°å™¨å‡½æ•°å°±è¡Œã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€æœ€å¸¸ç”¨ç”¨æ³•ï¼šæ–¹æ³•è£…é¥°å™¨</h2>
<p>è´´åœ¨ç±»çš„æ–¹æ³•ä¸Šï¼Œæ—¥å¸¸ç”¨å¾—æœ€å¤šï¼Œå‡½æ•°æœ‰ 3 ä¸ªå›ºå®šå‚æ•°ï¼šä¸ç”¨æ­»è®°å«ä¹‰ï¼Œè·Ÿç€æ¡ˆä¾‹ç”¨å°±ä¼šã€‚</p>
<h3 data-id="heading-3">ç®€å•æ¡ˆä¾‹1ï¼šç»™æ–¹æ³•åŠ æ—¥å¿—</h3>
<p>æ‰§è¡Œæ–¹æ³•æ—¶ï¼Œè‡ªåŠ¨æ‰“å°â€œæ–¹æ³•è¢«è°ƒç”¨äº†â€ï¼Œä¸ç”¨åœ¨æ–¹æ³•é‡Œå†™é‡å¤ä»£ç ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ–¹æ³•è£…é¥°å™¨ï¼šæ‰“å°æ–¹æ³•è°ƒç”¨æ—¥å¿—</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">showLog</span>(<span class="hljs-params">target, name, descriptor</span>) {
  <span class="hljs-comment">// ä¿å­˜åŸæ–¹æ³•</span>
  <span class="hljs-keyword">const</span> oldFn = descriptor.<span class="hljs-property">value</span>;
  <span class="hljs-comment">// é‡å†™æ–¹æ³•ï¼ŒåŠ æ—¥å¿—é€»è¾‘</span>
  descriptor.<span class="hljs-property">value</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ã€æ—¥å¿—ã€‘<span class="hljs-subst">${name}</span>æ–¹æ³•è¢«è°ƒç”¨äº†`</span>);
    oldFn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// æ‰§è¡ŒåŸæ¥çš„æ–¹æ³•</span>
  };
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> {
  <span class="hljs-comment">// è£…é¥°å™¨è´´åœ¨æ–¹æ³•ä¸Š</span>
  <span class="hljs-meta">@showLog</span>
  <span class="hljs-title function_">sayHi</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'hello TS'</span>);
  }
}

<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>().<span class="hljs-title function_">sayHi</span>();
<span class="hljs-comment">// è¾“å‡ºï¼šã€æ—¥å¿—ã€‘sayHiæ–¹æ³•è¢«è°ƒç”¨äº† â†’ hello TS</span>
</code></pre>
<h3 data-id="heading-4">ç®€å•æ¡ˆä¾‹2ï¼šç¦æ­¢æ–¹æ³•è¢«ä¿®æ”¹</h3>
<p>è®©æ–¹æ³•åªè¯»ï¼Œä¸èƒ½è¢«é‡æ–°èµ‹å€¼ï¼Œé¿å…è¯¯æ”¹æ–¹æ³•é€»è¾‘ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ–¹æ³•è£…é¥°å™¨ï¼šç¦æ­¢æ–¹æ³•ä¿®æ”¹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">noChange</span>(<span class="hljs-params">target, name, descriptor</span>) {
  descriptor.<span class="hljs-property">writable</span> = <span class="hljs-literal">false</span>; <span class="hljs-comment">// è®¾ä¸ºä¸å¯å†™</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> {
  <span class="hljs-meta">@noChange</span>
  <span class="hljs-title function_">fn</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸èƒ½æ”¹æˆ‘'</span>);
  }
}

<span class="hljs-keyword">const</span> obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>();
obj.<span class="hljs-property">fn</span> = <span class="hljs-function">() =&gt;</span> {}; <span class="hljs-comment">// æŠ¥é”™ï¼šæ— æ³•åˆ†é…åˆ° "fn"ï¼Œå› ä¸ºå®ƒæ˜¯åªè¯»å±æ€§</span>
</code></pre>
<h2 data-id="heading-5">å››ã€å±æ€§è£…é¥°å™¨ï¼šç»™å±æ€§åŠ é»˜è®¤å€¼</h2>
<p>è´´åœ¨ç±»çš„å±æ€§ä¸Šï¼Œå‡½æ•°æœ‰ 2 ä¸ªå‚æ•°ï¼Œæœ€ç®€å•çš„ç”¨æ³•ï¼šç»™å±æ€§è®¾ç½®é»˜è®¤å€¼ï¼Œä¸ç”¨åœ¨æ„é€ å‡½æ•°é‡Œåˆå§‹åŒ–ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å±æ€§è£…é¥°å™¨ï¼šè®¾ç½®é»˜è®¤å€¼</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">setDefault</span>(<span class="hljs-params">val</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">target, name</span>) {
    target[name] = val;
  };
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> {
  <span class="hljs-comment">// è´´åœ¨å±æ€§ä¸Šï¼Œä¼ é»˜è®¤å€¼</span>
  <span class="hljs-meta">@setDefault</span>(<span class="hljs-string">'å¼ ä¸‰'</span>)
  name;

  <span class="hljs-meta">@setDefault</span>(<span class="hljs-number">20</span>)
  age;
}

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>().<span class="hljs-property">name</span>); <span class="hljs-comment">// è¾“å‡ºï¼šå¼ ä¸‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>().<span class="hljs-property">age</span>); <span class="hljs-comment">// è¾“å‡ºï¼š20</span>
</code></pre>
<h2 data-id="heading-6">äº”ã€è£…é¥°å™¨å·¥å‚ï¼šç»™è£…é¥°å™¨ä¼ å‚</h2>
<p>æƒ³ç»™è£…é¥°å™¨ä¼ è‡ªå®šä¹‰å‚æ•°ï¼ˆæ¯”å¦‚æ—¥å¿—åŠ å‰ç¼€ã€é»˜è®¤å€¼è‡ªå®šä¹‰ï¼‰ï¼Œå°±å†™<strong>è£…é¥°å™¨å·¥å‚</strong>â€”â€”æœ¬è´¨æ˜¯ã€Œè¿”å›è£…é¥°å™¨çš„å‡½æ•°ã€ï¼Œå†™æ³•è¶…ç®€å•ï¼Œçœ‹æ¡ˆä¾‹å°±ä¼šã€‚</p>
<h3 data-id="heading-7">æ¡ˆä¾‹ï¼šå¸¦å‰ç¼€çš„æ—¥å¿—è£…é¥°å™¨</h3>
<p>è®©æ—¥å¿—æœ‰è‡ªå®šä¹‰å‰ç¼€ï¼Œä¸ç”¨å†™å¤šä¸ªè£…é¥°å™¨å‡½æ•°ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// è£…é¥°å™¨å·¥å‚ï¼šæ¥æ”¶è‡ªå®šä¹‰å‰ç¼€</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">prefix</span>) {
  <span class="hljs-comment">// è¿”å›çœŸæ­£çš„è£…é¥°å™¨å‡½æ•°</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">target, name, descriptor</span>) {
    <span class="hljs-keyword">const</span> oldFn = descriptor.<span class="hljs-property">value</span>;
    descriptor.<span class="hljs-property">value</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ã€<span class="hljs-subst">${prefix}</span>ã€‘<span class="hljs-subst">${name}</span>æ–¹æ³•æ‰§è¡Œäº†`</span>);
      oldFn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>);
    };
  };
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> {
  <span class="hljs-comment">// ä¼ å‚ä½¿ç”¨ï¼šè‡ªå®šä¹‰å‰ç¼€â€œæ¥å£è¯·æ±‚â€</span>
  <span class="hljs-meta">@log</span>(<span class="hljs-string">'æ¥å£è¯·æ±‚'</span>)
  <span class="hljs-title function_">getData</span>(<span class="hljs-params"/>) {}

  <span class="hljs-comment">// ä¼ å‚ä½¿ç”¨ï¼šè‡ªå®šä¹‰å‰ç¼€â€œæ“ä½œâ€</span>
  <span class="hljs-meta">@log</span>(<span class="hljs-string">'æ“ä½œ'</span>)
  <span class="hljs-title function_">saveData</span>(<span class="hljs-params"/>) {}
}

<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>().<span class="hljs-title function_">getData</span>(); <span class="hljs-comment">// è¾“å‡ºï¼šã€æ¥å£è¯·æ±‚ã€‘getDataæ–¹æ³•æ‰§è¡Œäº†</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>().<span class="hljs-title function_">saveData</span>(); <span class="hljs-comment">// è¾“å‡ºï¼šã€æ“ä½œã€‘saveDataæ–¹æ³•æ‰§è¡Œäº†</span>
</code></pre>
<h2 data-id="heading-8">å…­ã€å¿…è®°è§„åˆ™ï¼šå¤šä¸ªè£…é¥°å™¨çš„æ‰§è¡Œé¡ºåº</h2>
<p>ä¸€ä¸ªç±»/æ–¹æ³•ä¸Šè´´å¤šä¸ªè£…é¥°å™¨æ—¶ï¼Œ<strong>ä»ä¸‹å¾€ä¸Šæ‰§è¡Œ</strong>â€”â€”è°ç¦»è¢«è£…é¥°çš„ä¸œè¥¿è¿‘ï¼Œè°å…ˆæ‰§è¡Œã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å®šä¹‰ä¸¤ä¸ªç®€å•è£…é¥°å™¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">A</span>(<span class="hljs-params">target</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰§è¡Œè£…é¥°å™¨A'</span>);
  <span class="hljs-keyword">return</span> target;
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">B</span>(<span class="hljs-params">target</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰§è¡Œè£…é¥°å™¨B'</span>);
  <span class="hljs-keyword">return</span> target;
}

<span class="hljs-comment">// Bç¦»ç±»æ›´è¿‘ï¼Œå…ˆæ‰§è¡Œï¼›Aåæ‰§è¡Œ</span>
<span class="hljs-meta">@A</span>
<span class="hljs-meta">@B</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> {}

<span class="hljs-comment">// è¿è¡Œç»“æœï¼šå…ˆæ‰“å°ã€Œæ‰§è¡Œè£…é¥°å™¨Bã€ï¼Œå†æ‰“å°ã€Œæ‰§è¡Œè£…é¥°å™¨Aã€</span>
</code></pre>
<p>ç­‰ä»·ç†è§£ï¼š<code>MyClass = A(B(MyClass))</code>ï¼Œå…ˆæ‰§è¡Œå†…å±‚çš„ Bï¼Œå†æ‰§è¡Œå¤–å±‚çš„ Aã€‚</p>
<h2 data-id="heading-9">ä¸ƒã€ä½¿ç”¨å‰æï¼šå¼€å¯TSé…ç½®</h2>
<p>è£…é¥°å™¨æ˜¯ TS å®éªŒæ€§ç‰¹æ€§ï¼Œå¿…é¡»åœ¨ <code>tsconfig.json</code> é‡ŒåŠ ä¸€è¡Œé…ç½®ï¼Œå¦åˆ™æŠ¥é”™ï¼Œå°±åŠ è¿™ä¸€ä¸ªæ ¸å¿ƒé¡¹å°±è¡Œï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"compilerOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"experimentalDecorators"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// å¿…é¡»å¼€å¯ï¼Œå¯ç”¨è£…é¥°å™¨</span>
    <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ES5"</span> <span class="hljs-comment">// é¡¹ç›®åŸºæœ¬é…ç½®ï¼Œä¸€èˆ¬éƒ½æœ‰</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨ Stylus ä¸ç°ä»£ CSS æ„å»ºå“åº”å¼å›¾ç‰‡é¢æ¿ï¼šé«˜æ•ˆã€ä¼˜é›…çš„å‰ç«¯å¼€å‘å®è·µ]]></title>    <link>https://juejin.cn/post/7599924965950636070</link>    <guid>https://juejin.cn/post/7599924965950636070</guid>    <pubDate>2026-01-27T14:46:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599924965950636070" data-draft-id="7599920572840345609" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨ Stylus ä¸ç°ä»£ CSS æ„å»ºå“åº”å¼å›¾ç‰‡é¢æ¿ï¼šé«˜æ•ˆã€ä¼˜é›…çš„å‰ç«¯å¼€å‘å®è·µ"/> <meta itemprop="keywords" content="å‰ç«¯,Stylus"/> <meta itemprop="datePublished" content="2026-01-27T14:46:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·575730334624"/> <meta itemprop="url" content="https://juejin.cn/user/2860271309712009"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨ Stylus ä¸ç°ä»£ CSS æ„å»ºå“åº”å¼å›¾ç‰‡é¢æ¿ï¼šé«˜æ•ˆã€ä¼˜é›…çš„å‰ç«¯å¼€å‘å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2860271309712009/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·575730334624
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T14:46:32.000Z" title="Tue Jan 27 2026 14:46:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä½¿ç”¨ Stylus ä¸ç°ä»£ CSS æ„å»ºå“åº”å¼å›¾ç‰‡é¢æ¿ï¼šé«˜æ•ˆã€ä¼˜é›…çš„å‰ç«¯å¼€å‘å®è·µ</h2>
<blockquote>
<p><strong>æ‘˜è¦</strong>ï¼šæœ¬æ–‡é€šè¿‡ä¸€ä¸ªäº¤äº’å¼å›¾ç‰‡é¢æ¿é¡¹ç›®ï¼Œæ·±å…¥è®²è§£å¦‚ä½•ç»“åˆ <strong>Stylus é¢„å¤„ç†å™¨</strong> ä¸ <strong>ç°ä»£ CSS ç‰¹æ€§</strong>ï¼ˆå¦‚ Flexboxã€Transitionã€åª’ä½“æŸ¥è¯¢ï¼‰å®ç°é«˜æ€§èƒ½ã€å¯ç»´æŠ¤çš„å“åº”å¼å¸ƒå±€ã€‚æˆ‘ä»¬å°†å±•ç¤ºä»è¯­ä¹‰åŒ– HTML åˆ°æ¨¡å—åŒ– Stylus ä»£ç çš„å®Œæ•´å¼€å‘æµç¨‹ï¼Œå¹¶æ¢è®¨é¢„å¤„ç†å™¨å¦‚ä½•æå‡å‰ç«¯å·¥ç¨‹æ•ˆç‡ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆé€‰æ‹© Stylusï¼Ÿâ€”â€” CSS çš„â€œè¶…èƒ½åŠ›â€æ‰©å±•</h3>
<p>åŸç”Ÿ CSS è™½ç„¶åŠŸèƒ½å¼ºå¤§ï¼Œä½†åœ¨å¤§å‹é¡¹ç›®ä¸­å¸¸é¢ä¸´<strong>é‡å¤ä»£ç å¤šã€åµŒå¥—æ··ä¹±ã€å˜é‡ç¼ºå¤±</strong>ç­‰é—®é¢˜ã€‚Stylus ä½œä¸ºä¸€é—¨å¯Œæœ‰è¡¨ç°åŠ›çš„ CSS é¢„å¤„ç†å™¨ï¼Œé€šè¿‡ç®€æ´çš„è¯­æ³•ï¼ˆç”šè‡³å¯çœç•¥å¤§æ‹¬å·å’Œåˆ†å·ï¼‰ï¼Œæ”¯æŒ<strong>å˜é‡ã€å‡½æ•°ã€æ··åˆï¼ˆmixinsï¼‰ã€åµŒå¥—</strong>ç­‰ç¼–ç¨‹ç‰¹æ€§ï¼Œæå¤§æå‡äº†æ ·å¼è¡¨çš„å¯è¯»æ€§ä¸å¯ç»´æŠ¤æ€§ã€‚</p>
<p>æ›´é‡è¦çš„æ˜¯ï¼š<strong>æµè§ˆå™¨æ— æ³•ç›´æ¥è§£æ Stylus</strong>ï¼Œéœ€é€šè¿‡ç¼–è¯‘ç”Ÿæˆæ ‡å‡† CSSã€‚è¿™çœ‹ä¼¼å¢åŠ ä¸€æ­¥ï¼Œå®åˆ™å¸¦æ¥å·¨å¤§æ”¶ç›Šï¼š</p>
<ul>
<li>å¼€å‘æ—¶å†™ç®€æ´ã€é€»è¾‘æ¸…æ™°çš„ <code>.styl</code> æ–‡ä»¶ï¼›</li>
<li>ç¼–è¯‘åè¾“å‡ºé«˜åº¦ä¼˜åŒ–ã€å¸¦è‡ªåŠ¨å‰ç¼€çš„ <code>.css</code> æ–‡ä»¶ï¼›</li>
<li>æ”¯æŒæ¨¡å—åŒ–ä¸å¤ç”¨ï¼Œé¿å…â€œå¤åˆ¶ç²˜è´´å¼â€ç¼–ç ã€‚</li>
</ul>
<p>å®‰è£…ä¸ç¼–è¯‘å‘½ä»¤æç®€ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm install -g stylus
stylus style.styl -o style.css       <span class="hljs-comment"># å•æ¬¡ç¼–è¯‘</span>
stylus style.styl -o style.css -w    <span class="hljs-comment"># ç›‘å¬æ–‡ä»¶å˜åŒ–ï¼Œè‡ªåŠ¨ç¼–è¯‘</span>
</code></pre>
<hr/>
<h3 data-id="heading-2">äºŒã€é¡¹ç›®ç»“æ„ï¼šè¯­ä¹‰åŒ– HTML + æ¨¡å—åŒ–äº¤äº’</h3>
<p>æˆ‘ä»¬æ„å»ºä¸€ä¸ª<strong>ç‚¹å‡»å±•å¼€å¼å›¾ç‰‡é¢æ¿</strong>ï¼ŒåŒ…å«5å¼ é£æ™¯å›¾ï¼Œç‚¹å‡»ä»»ä¸€é¢æ¿å¯å°†å…¶æ”¾å¤§å¹¶æ˜¾ç¤ºæ ‡é¢˜ã€‚</p>
<h4 data-id="heading-3">HTML ç»“æ„ï¼ˆè¯­ä¹‰æ¸…æ™°ï¼‰</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"panel active"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background-image: url('...')"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Explore The World<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- å…¶ä»–4ä¸ª .panel --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./common.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<ul>
<li>ä½¿ç”¨ <code>class="panel"</code> ç»Ÿä¸€æ ‡è¯†ï¼›</li>
<li>åˆå§‹çŠ¶æ€é€šè¿‡ <code>active</code> ç±»æ§åˆ¶é¦–ä¸ªé¢æ¿å±•å¼€ï¼›</li>
<li>å†…è”èƒŒæ™¯å›¾ä¾¿äºæ¼”ç¤ºï¼Œå®é™…é¡¹ç›®å»ºè®®ç”¨ CSS å˜é‡æˆ– JS åŠ¨æ€æ³¨å…¥ã€‚</li>
</ul>
<h4 data-id="heading-4">JavaScript äº¤äº’é€»è¾‘ï¼ˆç®€æ´å¯é ï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> panels = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.panel'</span>);
panels.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">panel</span> =&gt;</span> {
  panel.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.active'</span>)?.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">'active'</span>);
    panel.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'active'</span>);
  });
});
</code></pre>
<blockquote>
<p>âœ… ä½¿ç”¨å¯é€‰é“¾ï¼ˆ<code>?.</code>ï¼‰é¿å…ç©ºå€¼é”™è¯¯ï¼Œç¡®ä¿å¥å£®æ€§ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">ä¸‰ã€Stylus å®æˆ˜ï¼šç¼–å†™é«˜æ•ˆã€åµŒå¥—çš„æ ·å¼ä»£ç </h3>
<p>æˆ‘ä»¬å°†åŸç”Ÿ CSS é‡æ„ä¸º Stylusï¼Œå±•ç¤ºå…¶æ ¸å¿ƒä¼˜åŠ¿ã€‚</p>
<h4 data-id="heading-6">1. å…¨å±€é‡ç½®ä¸å®¹å™¨å¸ƒå±€ï¼ˆåˆ©ç”¨åµŒå¥—ï¼‰</h4>
<pre><code class="hljs language-stylus" lang="stylus">// style.styl
*
  margin: 0
  padding: 0

body
  display: flex
  flex-direction: row
  justify-content: center
  align-items: center
  height: 100vh
  overflow: hidden
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>æ— å¤§æ‹¬å·ã€æ— åˆ†å·</strong>ï¼Œé ç¼©è¿›è¡¨è¾¾å±‚çº§ï¼Œä»£ç æ›´æ¸…çˆ½ã€‚</p>
</blockquote>
<h4 data-id="heading-7">2. é¢æ¿æ ·å¼ï¼šåµŒå¥— + çŠ¶æ€ç®¡ç†</h4>
<pre><code class="hljs language-stylus" lang="stylus">.container
  display: flex
  width: 90vw

  .panel
    height: 80vh
    border-radius: 50px
    color: #fff
    cursor: pointer
    flex: 0.5
    margin: 10px
    position: relative
    background-size: cover
    background-position: center
    background-repeat: no-repeat
    transition: all 700ms ease-in

    h3
      font-size: 24px
      position: absolute
      left: 20px
      bottom: 20px
      margin: 0
      opacity: 0
      transition: opacity 300ms ease-in 400ms

    &amp;.active
      flex: 5
      h3
        opacity: 1
</code></pre>
<h5 data-id="heading-8">å…³é”®æŠ€å·§è§£æï¼š</h5>
<ul>
<li><strong>åµŒå¥—é€‰æ‹©å™¨</strong>ï¼š<code>.container .panel h3</code> è¢«å†™æˆä¸‰å±‚ç¼©è¿›ï¼Œé€»è¾‘ä¸€ç›®äº†ç„¶ï¼›</li>
<li><strong>çŠ¶æ€åµŒå¥—</strong>ï¼š<code>&amp;.active</code> è¡¨ç¤ºâ€œå½“å‰å…ƒç´ åŒæ—¶æ‹¥æœ‰ <code>active</code> ç±»â€ï¼Œç¼–è¯‘åä¸º <code>.container .panel.active</code>ï¼›</li>
<li><strong>è¿‡æ¸¡åŠ¨ç”»</strong>ï¼š
<ul>
<li><code>transition: all 700ms ease-in</code>ï¼šé¢æ¿å°ºå¯¸å˜åŒ–å¹³æ»‘è¿‡æ¸¡ï¼›</li>
<li><code>transition: opacity ... 400ms</code>ï¼šæ ‡é¢˜å»¶è¿Ÿ 400ms æ·¡å…¥ï¼Œå¢å¼ºåŠ¨æ•ˆå±‚æ¬¡ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>âœ… è¿™ç§å†™æ³•æ¯”åŸç”Ÿ CSS å‡å°‘ 40% ä»£ç é‡ï¼Œä¸”ä¿®æ”¹ <code>.panel</code> æ ·å¼æ—¶æ— éœ€å…¨å±€æœç´¢ã€‚</p>
</blockquote>
<h4 data-id="heading-9">3. å“åº”å¼è®¾è®¡ï¼šåª’ä½“æŸ¥è¯¢åµŒå¥—</h4>
<pre><code class="hljs language-stylus" lang="stylus">@media (max-width: 480px)
  .container
    width: 100vw
    .panel
      &amp;:nth-of-type(4),
      &amp;:nth-of-type(5)
        display: none
</code></pre>
<ul>
<li>åœ¨å°å±è®¾å¤‡ï¼ˆå¦‚ iPhoneï¼‰ä¸Šéšè—æœ€åä¸¤å¼ å›¾ï¼Œä¿è¯ä½“éªŒï¼›</li>
<li>åµŒå¥—åœ¨ <code>.container</code> å†…éƒ¨ï¼Œä½œç”¨åŸŸæ¸…æ™°ï¼Œé¿å…æ ·å¼æ±¡æŸ“ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-10">å››ã€Flexboxï¼šå®ç°å¼¹æ€§å¸ƒå±€çš„æ ¸å¿ƒ</h3>
<p>æœ¬é¡¹ç›®ä¾èµ– Flexbox å®Œæˆå…³é”®å¸ƒå±€ï¼š</p>

























<table><thead><tr><th>å±æ€§</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>display: flex</code></td><td>å¯ç”¨å¼¹æ€§ä¸Šä¸‹æ–‡</td></tr><tr><td><code>justify-content: center</code></td><td>ä¸»è½´ï¼ˆæ°´å¹³ï¼‰å±…ä¸­</td></tr><tr><td><code>align-items: center</code></td><td>ä¾§è½´ï¼ˆå‚ç›´ï¼‰å±…ä¸­</td></tr><tr><td><code>flex: 0.5</code> / <code>flex: 5</code></td><td>æ§åˆ¶é¢æ¿ä¼¸ç¼©æ¯”ä¾‹ï¼Œç‚¹å‡»åæ”¾å¤§</td></tr></tbody></table>
<blockquote>
<p>ğŸ“± <strong>ç§»åŠ¨ç«¯å‹å¥½</strong>ï¼šFlexbox å¤©ç„¶é€‚é…ä¸åŒå±å¹•å°ºå¯¸ï¼Œæ˜¯ç°ä»£å¸ƒå±€é¦–é€‰ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-11">äº”ã€ç¼–è¯‘ä¸ä¼˜åŒ–ï¼šä» Stylus åˆ°ç”Ÿäº§çº§ CSS</h3>
<p>è¿è¡Œç¼–è¯‘å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">stylus style.styl -o style.css --autoprefixer
</code></pre>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šStylus æœ¬èº«ä¸å¸¦è‡ªåŠ¨åŠ å‰ç¼€åŠŸèƒ½ï¼Œéœ€é…åˆ <code>autoprefixer</code> æ’ä»¶æˆ–ä½¿ç”¨æ„å»ºå·¥å…·ï¼ˆå¦‚ Webpack + postcss-loaderï¼‰ã€‚</p>
</blockquote>
<p>ç¼–è¯‘åç”Ÿæˆçš„æ ‡å‡† CSSï¼ˆèŠ‚é€‰ï¼‰ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.container</span> <span class="hljs-selector-class">.panel</span><span class="hljs-selector-class">.active</span> {
  <span class="hljs-attribute">flex</span>: <span class="hljs-number">5</span>;
}
<span class="hljs-selector-class">.container</span> <span class="hljs-selector-class">.panel</span><span class="hljs-selector-class">.active</span> <span class="hljs-selector-tag">h3</span> {
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
}
<span class="hljs-keyword">@media</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">480px</span>) {
  <span class="hljs-selector-class">.container</span> <span class="hljs-selector-class">.panel</span><span class="hljs-selector-pseudo">:nth-of-type</span>(<span class="hljs-number">4</span>),
  <span class="hljs-selector-class">.container</span> <span class="hljs-selector-class">.panel</span><span class="hljs-selector-pseudo">:nth-of-type</span>(<span class="hljs-number">5</span>) {
    <span class="hljs-attribute">display</span>: none;
  }
}
</code></pre>
<p>æ‰€æœ‰å±æ€§å‡è‡ªåŠ¨æ·»åŠ  <code>-webkit-</code> ç­‰å‰ç¼€ï¼Œç¡®ä¿å…¼å®¹æ€§ã€‚</p>
<hr/>
<h3 data-id="heading-12">å…­ã€æ€»ç»“ï¼šStylus å¦‚ä½•èµ‹èƒ½ç°ä»£å‰ç«¯å¼€å‘</h3>
<p>é€šè¿‡æœ¬é¡¹ç›®ï¼Œæˆ‘ä»¬éªŒè¯äº† Stylus åœ¨ä»¥ä¸‹æ–¹é¢çš„ä»·å€¼ï¼š</p>
<ol>
<li><strong>æå‡å¼€å‘æ•ˆç‡</strong><br/>
åµŒå¥—ã€å˜é‡ã€æ··åˆå‡å°‘é‡å¤ä»£ç ï¼Œé€»è¾‘æ›´æ¸…æ™°ã€‚</li>
<li><strong>å¢å¼ºå¯ç»´æŠ¤æ€§</strong><br/>
ä¿®æ”¹ä¸€ä¸ªç±»çš„æ ·å¼åªéœ€å®šä½åˆ°å…¶åµŒå¥—å—ï¼Œæ— éœ€æ‹…å¿ƒå…¨å±€å½±å“ã€‚</li>
<li><strong>æ— ç¼é›†æˆç°ä»£ CSS</strong><br/>
Flexboxã€Transitionã€åª’ä½“æŸ¥è¯¢ç­‰ç‰¹æ€§åŸç”Ÿæ”¯æŒï¼Œç¼–è¯‘åå®Œå…¨å…¼å®¹ã€‚</li>
<li><strong>ä¿ƒè¿›å·¥ç¨‹åŒ–æ€ç»´</strong><br/>
é¢„ç¼–è¯‘æµç¨‹å¤©ç„¶å¼•å¯¼å¼€å‘è€…é‡‡ç”¨æ¨¡å—åŒ–ã€ç»„ä»¶åŒ–æ€æƒ³ã€‚</li>
</ol>
<blockquote>
<p>ğŸŒŸ <strong>æœªæ¥å±•æœ›</strong>ï¼šè™½ç„¶ Sass/SCSS å› ç¤¾åŒºåºå¤§æ›´æµè¡Œï¼Œä½† Stylus ä»¥<strong>æè‡´ç®€æ´çš„è¯­æ³•</strong>ä»æœ‰ä¸€å¸­ä¹‹åœ°ã€‚åœ¨è¿½æ±‚å¼€å‘ä½“éªŒä¸ä»£ç ä¼˜é›…çš„é¡¹ç›®ä¸­ï¼Œå®ƒä¾ç„¶æ˜¯å€¼å¾—è€ƒè™‘çš„åˆ©å™¨ã€‚</p>
</blockquote>
<hr/>
<p><strong>ç»“è¯­</strong>ï¼šå‰ç«¯ä¸ä»…æ˜¯â€œå†™é¡µé¢â€ï¼Œæ›´æ˜¯â€œæ„å»ºä½“éªŒâ€ã€‚å€ŸåŠ© Stylus è¿™æ ·çš„å·¥å…·ï¼Œæˆ‘ä»¬èƒ½å°†æ›´å¤šç²¾åŠ›èšç„¦äºäº¤äº’é€»è¾‘ä¸è§†è§‰è¡¨ç°ï¼Œè€Œéç¹ççš„æ ·å¼æ‹¼æ¥ã€‚æ­£å¦‚æœ¬é¡¹ç›®æ‰€ç¤ºâ€”â€”<strong>ä¸€è¡Œ <code>&amp;.active</code>ï¼Œèƒœè¿‡åè¡Œé‡å¤é€‰æ‹©å™¨</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React å•é¡µåº”ç”¨ä¼˜åŒ–å®æˆ˜ï¼šä»è·¯ç”±ç¼“å­˜åˆ°ç”¨æˆ·è®¤è¯çš„å®Œæ•´è§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7599873006258307106</link>    <guid>https://juejin.cn/post/7599873006258307106</guid>    <pubDate>2026-01-27T15:21:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599873006258307106" data-draft-id="7599899147417993268" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React å•é¡µåº”ç”¨ä¼˜åŒ–å®æˆ˜ï¼šä»è·¯ç”±ç¼“å­˜åˆ°ç”¨æˆ·è®¤è¯çš„å®Œæ•´è§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-27T15:21:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ— æ•Œçš„æ‹–æ‹‰æ–¯æ—‹é£"/> <meta itemprop="url" content="https://juejin.cn/user/951508170179208"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React å•é¡µåº”ç”¨ä¼˜åŒ–å®æˆ˜ï¼šä»è·¯ç”±ç¼“å­˜åˆ°ç”¨æˆ·è®¤è¯çš„å®Œæ•´è§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/951508170179208/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ— æ•Œçš„æ‹–æ‹‰æ–¯æ—‹é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T15:21:58.000Z" title="Tue Jan 27 2026 15:21:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨ç°ä»£ Web å¼€å‘ä¸­ï¼Œå•é¡µåº”ç”¨ï¼ˆSPAï¼‰å·²æˆä¸ºä¸»æµæ¶æ„ã€‚ç„¶è€Œï¼Œé¢‘ç¹çš„é¡µé¢åˆ‡æ¢å¯¼è‡´çš„é‡å¤åŠ è½½é—®é¢˜ä¸¥é‡å½±å“ç”¨æˆ·ä½“éªŒã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•é€šè¿‡ Reactã€React-Router å’Œç¼“å­˜æœºåˆ¶æ„å»ºé«˜æ€§èƒ½çš„ SPAï¼Œå¹¶å®ç°å®Œæ•´çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿã€‚</p>
<h2 data-id="heading-1">ä¸€ã€SPA è·¯ç”±ä¼˜åŒ–çš„å¿…è¦æ€§</h2>
<h3 data-id="heading-2">1.1 ä¼ ç»Ÿå¤šé¡µåº”ç”¨çš„é—®é¢˜</h3>
<p>ä¼ ç»Ÿçš„å¤šé¡µåº”ç”¨ï¼ˆMPAï¼‰æ¯æ¬¡é¡µé¢è·³è½¬éƒ½éœ€è¦å‘æœåŠ¡å™¨å‘èµ·å®Œæ•´ HTTP è¯·æ±‚ï¼Œè·å–æ–°çš„ HTML æ–‡æ¡£ã€‚è¿™ç§æ–¹å¼å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li><strong>ç™½å±ç­‰å¾…</strong>ï¼šé¡µé¢åˆ‡æ¢æ—¶å‡ºç°ç©ºç™½ï¼Œç”¨æˆ·ä½“éªŒå·®</li>
<li><strong>èµ„æºé‡å¤åŠ è½½</strong>ï¼šç›¸åŒçš„åŸºç¡€èµ„æºéœ€è¦é‡å¤ä¸‹è½½</li>
<li><strong>ç½‘ç»œå»¶è¿Ÿ</strong>ï¼šæ¯æ¬¡è¯·æ±‚éƒ½æœ‰ç½‘ç»œå¾€è¿”æ—¶é—´</li>
</ul>
<h3 data-id="heading-3">1.2 å•é¡µåº”ç”¨çš„ä¼˜åŠ¿</h3>
<p>SPA é€šè¿‡å‰ç«¯è·¯ç”±ç®¡ç†é¡µé¢åˆ‡æ¢ï¼Œå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<p>javascript</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// ä¼ ç»Ÿåç«¯è·¯ç”± vs å‰ç«¯è·¯ç”±</span>
<span class="hljs-comment">// åç«¯è·¯ç”±ï¼š/ â†’ å®Œæ•´HTMLï¼Œ/detail/123 â†’ å®Œæ•´HTML</span>
<span class="hljs-comment">// å‰ç«¯è·¯ç”±ï¼šé€šè¿‡ JS åŠ¨æ€æ¸²æŸ“ç»„ä»¶ï¼Œæ— éœ€åˆ·æ–°é¡µé¢</span>
</code></pre>
<ul>
<li><strong>æ— ç¼åˆ‡æ¢</strong>ï¼šé¡µé¢é—´åˆ‡æ¢æ— ç™½å±ç°è±¡</li>
<li><strong>æ€§èƒ½æå‡</strong>ï¼šåŸºç¡€èµ„æºåªéœ€åŠ è½½ä¸€æ¬¡</li>
<li><strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼šç±»ä¼¼åŸç”Ÿåº”ç”¨çš„æµç•…ä½“éªŒ</li>
</ul>
<h2 data-id="heading-4">äºŒã€é¦–é¡µç¼“å­˜ä¼˜åŒ–ç­–ç•¥</h2>
<h3 data-id="heading-5">2.1 é—®é¢˜åœºæ™¯åˆ†æ</h3>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé¦–é¡µå¾€å¾€æ˜¯ç”¨æˆ·è®¿é—®é¢‘ç‡æœ€é«˜çš„é¡µé¢ã€‚é¢‘ç¹çš„é¦–é¡µä¸å…¶ä»–é¡µé¢é—´åˆ‡æ¢ä¼šå¯¼è‡´ï¼š</p>
<ul>
<li>é¦–é¡µç»„ä»¶é‡å¤æ¸²æŸ“</li>
<li>æ•°æ®é‡æ–°åŠ è½½</li>
<li>ç”¨æˆ·äº¤äº’çŠ¶æ€ä¸¢å¤±</li>
</ul>
<h3 data-id="heading-6">2.2 Keep-Alive æœºåˆ¶</h3>
<p>ä¸ºäº†ä¿æŒé¦–é¡µç»„ä»¶çš„çŠ¶æ€ï¼Œæˆ‘ä»¬éœ€è¦å®ç°ç»„ä»¶ç¼“å­˜æœºåˆ¶ï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼ ç»Ÿæ–¹å¼ - æ¯æ¬¡åˆ‡æ¢éƒ½ä¼šé‡æ–°æ¸²æŸ“</span>
&lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"/"</span> element={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">HomePage</span> /&gt;</span></span>} /&gt;

<span class="hljs-comment">// ç¼“å­˜æ–¹å¼ - ä¿æŒç»„ä»¶çŠ¶æ€</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>
    &lt;<span class="hljs-attr">KeepAlive</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"home-page"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">HomePage</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span>
} /&gt;</span>
</code></pre>
<h3 data-id="heading-7">2.3 react-activation å®ç°ç¼“å­˜</h3>
<p><code>react-activation</code>Â æ˜¯ React ç”Ÿæ€ä¸­æœ€å—æ¬¢è¿çš„ç»„ä»¶ç¼“å­˜è§£å†³æ–¹æ¡ˆï¼Œç±»ä¼¼ Vue çš„Â <code>&lt;keep-alive&gt;</code>ï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AliveScope</span>, <span class="hljs-title class_">KeepAlive</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-activation'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AliveScope</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>
                    &lt;<span class="hljs-attr">KeepAlive</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"home-page"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">HomePage</span> /&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span>
                } /&gt;
                
                <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/detail/:id"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">DetailPage</span> /&gt;</span>} /&gt;
            <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">AliveScope</span>&gt;</span></span>
    );
}
</code></pre>
<p><strong>ç¼“å­˜æœºåˆ¶åŸç†ï¼š</strong></p>
<ul>
<li>ç»„ä»¶å¸è½½æ—¶ä¿å­˜åœ¨å†…å­˜ä¸­</li>
<li>å†æ¬¡è®¿é—®æ—¶ä»ç¼“å­˜æ¢å¤</li>
<li>ä¿æŒç»„ä»¶çš„æ‰€æœ‰çŠ¶æ€å’Œæ•°æ®</li>
</ul>
<h2 data-id="heading-8">ä¸‰ã€Keep-Alive è¯¦ç»†å®ç°</h2>
<h3 data-id="heading-9">3.1 æ ¸å¿ƒæ¦‚å¿µ</h3>
<p>Keep-Alive æœºåˆ¶çš„æ ¸å¿ƒæ˜¯å°†ç»„ä»¶å®ä¾‹ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè€ŒéçœŸæ­£çš„å¸è½½ï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-ini" lang="ini">// KeepAlive ç»„ä»¶çš„åŸºæœ¬å®ç°æ€è·¯
const <span class="hljs-attr">KeepAlive</span> = ({ name, children }) =&gt; {
    const <span class="hljs-section">[cache, setCache]</span> = useState({})<span class="hljs-comment">;</span>
    
    // ç¼“å­˜ç»„ä»¶
    useEffect(() =&gt; {
        if (!cache<span class="hljs-section">[name]</span>) {
            setCache(<span class="hljs-attr">prev</span> =&gt; ({
                ...prev,
                <span class="hljs-section">[name]</span>: children
            }))<span class="hljs-comment">;</span>
        }
    }, <span class="hljs-section">[name, children]</span>)<span class="hljs-comment">;</span>
    
    // è¿”å›ç¼“å­˜çš„ç»„ä»¶æˆ–å½“å‰ç»„ä»¶
    return cache<span class="hljs-section">[name]</span> || children<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-10">3.2 ç”Ÿå‘½å‘¨æœŸç®¡ç†</h3>
<p>ç¼“å­˜ç»„ä»¶éœ€è¦ç‰¹æ®Šçš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useActivate, useDeactivate } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-activation'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">HomePage</span>(<span class="hljs-params"/>) {
    <span class="hljs-title function_">useActivate</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é¦–é¡µæ¿€æ´»ï¼ˆè¿›å…¥é¡µé¢ï¼‰'</span>);
        <span class="hljs-comment">// é¡µé¢é‡æ–°å¯è§æ—¶çš„å¤„ç†é€»è¾‘</span>
    });
    
    <span class="hljs-title function_">useDeactivate</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é¦–é¡µå¤±æ´»ï¼ˆç¦»å¼€é¡µé¢ï¼‰'</span>);
        <span class="hljs-comment">// é¡µé¢å³å°†éšè—æ—¶çš„å¤„ç†é€»è¾‘</span>
    });
    
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>é¦–é¡µå†…å®¹ä¿æŒä¸å˜<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<h3 data-id="heading-11">3.3 ç¼“å­˜ç­–ç•¥</h3>
<p>å¯ä»¥æ ¹æ®ä¸åŒéœ€æ±‚å®ç°ä¸åŒçš„ç¼“å­˜ç­–ç•¥ï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¡ä»¶ç¼“å­˜</span>
&lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"/search"</span> element={
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">KeepAlive</span> <span class="hljs-attr">when</span>=<span class="hljs-string">{()</span> =&gt;</span> shouldCacheSearch()}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">SearchPage</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span></span>
} /&gt;

<span class="hljs-comment">// å¤šçº§ç¼“å­˜</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/category/:id"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>
    &lt;<span class="hljs-attr">KeepAlive</span> <span class="hljs-attr">name</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">category-</span> $ {<span class="hljs-attr">params.id</span>}`}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">CategoryPage</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span>
} /&gt;</span>
</code></pre>
<h2 data-id="heading-12">å››ã€ç”¨æˆ·è®¤è¯ç³»ç»Ÿè®¾è®¡</h2>
<h3 data-id="heading-13">4.1 DTO éªŒè¯å±‚</h3>
<p>ä½¿ç”¨Â <code>class-validator</code>Â å’ŒÂ <code>class-transformer</code>Â è¿›è¡Œæ•°æ®éªŒè¯ï¼š</p>
<p>typescript</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// dto/create-user.dto.ts</span>
<span class="hljs-selector-tag">import</span> { <span class="hljs-selector-tag">IsEmail</span>, <span class="hljs-selector-tag">IsNotEmpty</span>, <span class="hljs-selector-tag">IsString</span>, <span class="hljs-selector-tag">MinLength</span> } <span class="hljs-selector-tag">from</span> '<span class="hljs-selector-tag">class-validator</span>';
<span class="hljs-selector-tag">import</span> { <span class="hljs-selector-tag">Type</span> } <span class="hljs-selector-tag">from</span> '<span class="hljs-selector-tag">class-transformer</span>';

<span class="hljs-selector-tag">export</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">CreateUserDto</span> {
    <span class="hljs-variable">@IsNotEmpty</span>({ <span class="hljs-attribute">message</span>: <span class="hljs-string">'ç”¨æˆ·åä¸èƒ½ä¸ºç©º'</span> })
    <span class="hljs-variable">@IsString</span>({ <span class="hljs-attribute">message</span>: <span class="hljs-string">'ç”¨æˆ·åå¿…é¡»æ˜¯å­—ç¬¦ä¸²'</span> })
    name?: string;

    <span class="hljs-variable">@IsNotEmpty</span>({ <span class="hljs-attribute">message</span>: <span class="hljs-string">'å¯†ç ä¸èƒ½ä¸ºç©º'</span> })
    <span class="hljs-variable">@IsString</span>({ <span class="hljs-attribute">message</span>: <span class="hljs-string">'å¯†ç å¿…é¡»æ˜¯å­—ç¬¦ä¸²'</span> })
    <span class="hljs-variable">@MinLength</span>(<span class="hljs-number">6</span>, { <span class="hljs-attribute">message</span>: <span class="hljs-string">'å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½'</span> })
    password?: string;

    <span class="hljs-variable">@IsEmail</span>({}, { <span class="hljs-attribute">message</span>: <span class="hljs-string">'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€'</span> })
    <span class="hljs-variable">@IsNotEmpty</span>({ <span class="hljs-attribute">message</span>: <span class="hljs-string">'é‚®ç®±ä¸èƒ½ä¸ºç©º'</span> })
    email?: string;
}
</code></pre>
<h3 data-id="heading-14">4.2 æ§åˆ¶å™¨å±‚å®ç°</h3>
<p>æ§åˆ¶å™¨è´Ÿè´£å¤„ç† HTTP è¯·æ±‚å’Œå“åº”ï¼š</p>
<p>typescript</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// users.controller.ts</span>
<span class="hljs-selector-tag">import</span> {
    <span class="hljs-selector-tag">Controller</span>,
    <span class="hljs-selector-tag">Post</span>,
    <span class="hljs-selector-tag">Body</span>,
    <span class="hljs-selector-tag">HttpCode</span>,
    <span class="hljs-selector-tag">HttpStatus</span>
} <span class="hljs-selector-tag">from</span> '@<span class="hljs-selector-tag">nestjs</span>/<span class="hljs-selector-tag">common</span>';
<span class="hljs-selector-tag">import</span> { <span class="hljs-selector-tag">UsersService</span> } <span class="hljs-selector-tag">from</span> './<span class="hljs-selector-tag">users</span><span class="hljs-selector-class">.service</span>';
<span class="hljs-selector-tag">import</span> { <span class="hljs-selector-tag">CreateUserDto</span> } <span class="hljs-selector-tag">from</span> './<span class="hljs-selector-tag">dto</span>/<span class="hljs-selector-tag">create-user</span><span class="hljs-selector-class">.dto</span>';

@<span class="hljs-selector-tag">Controller</span>(<span class="hljs-string">'users'</span>)
<span class="hljs-selector-tag">export</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">UsersController</span> {
    <span class="hljs-selector-tag">constructor</span>(
        private readonly <span class="hljs-attribute">usersService</span>: UsersService
    ) {}

    <span class="hljs-variable">@Post</span>(<span class="hljs-string">'/register'</span>)
    <span class="hljs-variable">@HttpCode</span>(HttpStatus.CREATED)
    async <span class="hljs-built_in">register</span>(<span class="hljs-variable">@Body</span>() <span class="hljs-attribute">createUserDto</span>: CreateUserDto) {
        <span class="hljs-selector-tag">console</span><span class="hljs-selector-class">.log</span>(<span class="hljs-string">'æ¥æ”¶åˆ°æ³¨å†Œè¯·æ±‚:'</span>, createUserDto);
        <span class="hljs-selector-tag">const</span> <span class="hljs-selector-tag">result</span> = <span class="hljs-selector-tag">await</span> <span class="hljs-selector-tag">this</span><span class="hljs-selector-class">.usersService</span><span class="hljs-selector-class">.register</span>(createUserDto);
        <span class="hljs-selector-tag">return</span> {
            success: true,
            data: result,
            message: 'æ³¨å†ŒæˆåŠŸ'
        };
    }

    <span class="hljs-variable">@Post</span>(<span class="hljs-string">'/login'</span>)
    <span class="hljs-variable">@HttpCode</span>(HttpStatus.OK)
    async <span class="hljs-built_in">login</span>(<span class="hljs-variable">@Body</span>() <span class="hljs-attribute">loginDto</span>: LoginUserDto) {
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">this</span><span class="hljs-selector-class">.usersService</span><span class="hljs-selector-class">.login</span>(loginDto);
    }
}
</code></pre>
<h3 data-id="heading-15">4.3 æœåŠ¡å±‚ä¸šåŠ¡é€»è¾‘</h3>
<p>æœåŠ¡å±‚å¤„ç†æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼š</p>
<p>typescript</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// users.service.ts</span>
<span class="hljs-keyword">import</span> {
    <span class="hljs-title class_">Injectable</span>,
    <span class="hljs-title class_">BadRequestException</span>,
    <span class="hljs-title class_">ConflictException</span>
} <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PrismaService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../prisma/prisma.service'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">CreateUserDto</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./dto/create-user.dto'</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> bcrypt <span class="hljs-keyword">from</span> <span class="hljs-string">'bcrypt'</span>;

<span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UsersService</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> prisma: PrismaService</span>) {}

    <span class="hljs-keyword">async</span> <span class="hljs-title function_">register</span>(<span class="hljs-params">createUserDto: CreateUserDto</span>) {
        <span class="hljs-keyword">const</span> { name, password, email } = createUserDto;

        <span class="hljs-comment">// æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨</span>
        <span class="hljs-keyword">const</span> existingUser = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">prisma</span>.<span class="hljs-property">user</span>.<span class="hljs-title function_">findUnique</span>({
            <span class="hljs-attr">where</span>: { name }
        });

        <span class="hljs-keyword">if</span> (existingUser) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConflictException</span>(<span class="hljs-string">'ç”¨æˆ·åå·²å­˜åœ¨'</span>);
        }

        <span class="hljs-comment">// æ£€æŸ¥é‚®ç®±æ˜¯å¦å·²å­˜åœ¨</span>
        <span class="hljs-keyword">const</span> existingEmail = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">prisma</span>.<span class="hljs-property">user</span>.<span class="hljs-title function_">findUnique</span>({
            <span class="hljs-attr">where</span>: { email }
        });

        <span class="hljs-keyword">if</span> (existingEmail) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConflictException</span>(<span class="hljs-string">'é‚®ç®±å·²è¢«æ³¨å†Œ'</span>);
        }

        <span class="hljs-comment">// å¯†ç åŠ å¯†</span>
        <span class="hljs-keyword">const</span> hashedPassword = <span class="hljs-keyword">await</span> bcrypt.<span class="hljs-title function_">hash</span>(password, <span class="hljs-number">10</span>);

        <span class="hljs-comment">// åˆ›å»ºç”¨æˆ·</span>
        <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">prisma</span>.<span class="hljs-property">user</span>.<span class="hljs-title function_">create</span>({
            <span class="hljs-attr">data</span>: {
                name,
                email,
                <span class="hljs-attr">password</span>: hashedPassword,
                <span class="hljs-attr">createdAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),
                <span class="hljs-attr">updatedAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
            },
            <span class="hljs-attr">select</span>: {
                <span class="hljs-attr">id</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">name</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">email</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">createdAt</span>: <span class="hljs-literal">true</span>
            }
        });

        <span class="hljs-keyword">return</span> user;
    }

    <span class="hljs-keyword">async</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">loginDto: LoginUserDto</span>) {
        <span class="hljs-keyword">const</span> { name, password } = loginDto;

        <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">prisma</span>.<span class="hljs-property">user</span>.<span class="hljs-title function_">findUnique</span>({
            <span class="hljs-attr">where</span>: { name }
        });

        <span class="hljs-keyword">if</span> (!user) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BadRequestException</span>(<span class="hljs-string">'ç”¨æˆ·åä¸å­˜åœ¨'</span>);
        }

        <span class="hljs-keyword">const</span> isPasswordValid = <span class="hljs-keyword">await</span> bcrypt.<span class="hljs-title function_">compare</span>(password, user.<span class="hljs-property">password</span>);
        <span class="hljs-keyword">if</span> (!isPasswordValid) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BadRequestException</span>(<span class="hljs-string">'å¯†ç é”™è¯¯'</span>);
        }

        <span class="hljs-comment">// ç”Ÿæˆ JWT token</span>
        <span class="hljs-keyword">const</span> token = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateToken</span>(user.<span class="hljs-property">id</span>);
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">user</span>: {
                <span class="hljs-attr">id</span>: user.<span class="hljs-property">id</span>,
                <span class="hljs-attr">name</span>: user.<span class="hljs-property">name</span>,
                <span class="hljs-attr">email</span>: user.<span class="hljs-property">email</span>
            },
            token
        };
    }

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">generateToken</span>(<span class="hljs-params">userId: <span class="hljs-built_in">number</span></span>) {
        <span class="hljs-comment">// JWT token ç”Ÿæˆé€»è¾‘</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">'generated_token'</span>;
    }
}
</code></pre>
<h3 data-id="heading-16">4.4 æ¨¡å—é…ç½®</h3>
<p>NestJS æ¨¡å—åŒ–é…ç½®ï¼š</p>
<p>typescript</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// users.module.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Module</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PrismaModule</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../prisma/prisma.module'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">UsersController</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./users.controller'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">UsersService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./users.service'</span>;

<span class="hljs-meta">@Module</span>({
    <span class="hljs-attr">imports</span>: [
        <span class="hljs-title class_">PrismaModule</span>,
        <span class="hljs-comment">// å¯ä»¥æ·»åŠ  JWT æ¨¡å—ã€é‚®ä»¶æ¨¡å—ç­‰</span>
    ],
    <span class="hljs-attr">controllers</span>: [<span class="hljs-title class_">UsersController</span>],
    <span class="hljs-attr">providers</span>: [<span class="hljs-title class_">UsersService</span>],
    <span class="hljs-attr">exports</span>: [<span class="hljs-title class_">UsersService</span>] <span class="hljs-comment">// å¦‚æœå…¶ä»–æ¨¡å—éœ€è¦ä½¿ç”¨ UsersService</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UsersModule</span> {}
</code></pre>
<h2 data-id="heading-17">äº”ã€æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-18">5.1 ç¼“å­˜ç­–ç•¥ä¼˜åŒ–</h3>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ ¹æ®é¡µé¢ç‰¹æ€§é€‰æ‹©ç¼“å­˜ç­–ç•¥</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">RouteConfig</span> = (<span class="hljs-params"/>) =&gt; (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
        {/* é¦–é¡µï¼šé•¿æœŸç¼“å­˜ */}
        <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>
            &lt;<span class="hljs-attr">KeepAlive</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"home-page"</span> <span class="hljs-attr">max</span>=<span class="hljs-string">{1}</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">HomePage</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span>
        } /&gt;
        
        {/* åˆ—è¡¨é¡µï¼šæŒ‰å‚æ•°ç¼“å­˜ */}
        <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/products/:category"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>
            &lt;<span class="hljs-attr">KeepAlive</span> <span class="hljs-attr">name</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">products-</span> $ {<span class="hljs-attr">params.category</span>}`}&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">ProductList</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span>
        } /&gt;
        
        {/* è¯¦æƒ…é¡µï¼šä¸ç¼“å­˜ */}
        <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/product/:id"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">ProductDetail</span> /&gt;</span>} /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span></span>
);
</code></pre>
<h3 data-id="heading-19">5.2 å†…å­˜ç®¡ç†</h3>
<p>javascript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é˜²æ­¢å†…å­˜æ³„æ¼çš„ç¼“å­˜æ¸…ç†</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">cleanupCache</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-comment">// å®šæœŸæ¸…ç†ä¸æ´»è·ƒçš„ç¼“å­˜</span>
    <span class="hljs-comment">// é™åˆ¶ç¼“å­˜æ•°é‡</span>
    <span class="hljs-comment">// ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ</span>
};
</code></pre>
<h3 data-id="heading-20">5.3 é”™è¯¯å¤„ç†</h3>
<p>typescript</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// ç»Ÿä¸€é”™è¯¯å¤„ç†</span>
@<span class="hljs-title function_ invoke__">Catch</span>(BadRequestException)
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ValidationExceptionFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ExceptionFilter</span> </span>{
    <span class="hljs-keyword">catch</span>(exception: BadRequestException, host: ArgumentsHost) {
        <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">ctx</span> = host.<span class="hljs-title function_ invoke__">switchToHttp</span>();
        <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">response</span> = ctx.<span class="hljs-title function_ invoke__">getResponse</span>();
        
        response.<span class="hljs-title function_ invoke__">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_ invoke__">json</span>({
            <span class="hljs-attr">statusCode</span>: <span class="hljs-number">400</span>,
            <span class="hljs-attr">error</span>: <span class="hljs-string">'Validation Failed'</span>,
            <span class="hljs-attr">message</span>: exception.message
        });
    }
}
</code></pre>
<h3 data-id="heading-21">apifoxå‘é€æ•°æ®æµ‹è¯•</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8bb177863ae64179a6184093453676c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg5pWM55qE5ouW5ouJ5pav5peL6aOO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770132192&amp;x-signature=BqTpoP%2FZ2%2FhZKzN24td%2B93vikJo%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-22">å…­ã€æ€»ç»“</h2>
<p>æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†å•é¡µåº”ç”¨çš„æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ï¼ŒåŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>è·¯ç”±ç¼“å­˜æœºåˆ¶</strong>ï¼šé€šè¿‡ Keep-Alive ä¿æŒç»„ä»¶çŠ¶æ€</li>
<li><strong>ç”¨æˆ·è®¤è¯ç³»ç»Ÿ</strong>ï¼šå®Œæ•´çš„æ³¨å†Œç™»å½•åŠŸèƒ½å®ç°</li>
<li><strong>æ•°æ®éªŒè¯</strong>ï¼šDTO å±‚çš„æ•°æ®æ ¡éªŒæœºåˆ¶</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†ç­–ç•¥</li>
</ol>
<p>è¿™äº›æŠ€æœ¯çš„ç»“åˆä½¿ç”¨ï¼Œèƒ½å¤Ÿæ˜¾è‘—æå‡å•é¡µåº”ç”¨çš„ç”¨æˆ·ä½“éªŒï¼Œå‡å°‘é¡µé¢åŠ è½½æ—¶é—´ï¼Œæé«˜åº”ç”¨å“åº”é€Ÿåº¦ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œéœ€è¦æ ¹æ®å…·ä½“ä¸šåŠ¡éœ€æ±‚è°ƒæ•´ç¼“å­˜ç­–ç•¥ï¼Œå¹³è¡¡æ€§èƒ½å’Œå†…å­˜ä½¿ç”¨ã€‚</p>
<p>é€šè¿‡åˆç†çš„æ¶æ„è®¾è®¡å’Œä¼˜åŒ–ç­–ç•¥ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå‡ºæ—¢é«˜æ•ˆåˆç”¨æˆ·å‹å¥½çš„ç°ä»£åŒ– Web åº”ç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ§™â€â™‚ï¸ æ‹’ç»é¡µé¢â€œå¤±å¿†â€ï¼æ‰‹å†™ React KeepAlive ç»„ä»¶ï¼Œå½»åº•ææ‡‚ç¼“å­˜åŸç†]]></title>    <link>https://juejin.cn/post/7599868109085671466</link>    <guid>https://juejin.cn/post/7599868109085671466</guid>    <pubDate>2026-01-27T15:33:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599868109085671466" data-draft-id="7599843186203082794" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ§™â€â™‚ï¸ æ‹’ç»é¡µé¢â€œå¤±å¿†â€ï¼æ‰‹å†™ React KeepAlive ç»„ä»¶ï¼Œå½»åº•ææ‡‚ç¼“å­˜åŸç†"/> <meta itemprop="keywords" content="æ€§èƒ½ä¼˜åŒ–,React.js"/> <meta itemprop="datePublished" content="2026-01-27T15:33:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¥ç§˜çš„çŒªå¤´"/> <meta itemprop="url" content="https://juejin.cn/user/793223472877051"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ§™â€â™‚ï¸ æ‹’ç»é¡µé¢â€œå¤±å¿†â€ï¼æ‰‹å†™ React KeepAlive ç»„ä»¶ï¼Œå½»åº•ææ‡‚ç¼“å­˜åŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/793223472877051/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¥ç§˜çš„çŒªå¤´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T15:33:26.000Z" title="Tue Jan 27 2026 15:33:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å“ˆå–½ï¼Œæ˜é‡‘çš„å°ä¼™ä¼´ä»¬ï¼ğŸ‘‹ æ¬¢è¿æ¥åˆ° <strong>React è¿›é˜¶å®æˆ˜</strong>ï¼</p>
<p>åœ¨ Vue ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å†…ç½®ç»„ä»¶ <code>&lt;keep-alive&gt;</code>ï¼Œå®ƒå¯ä»¥è®©ç»„ä»¶åœ¨åˆ‡æ¢æ—¶â€œä¸è¢«é”€æ¯â€ï¼Œè€Œæ˜¯â€œä¼‘çœ â€ï¼Œå½“å†æ¬¡å›æ¥æ—¶ï¼Œæ•°æ®å’ŒçŠ¶æ€ä¾ç„¶å®Œå¥½å¦‚åˆã€‚è¿™å¯¹äº<strong>è¡¨å•å¡«å†™ä¸­é€”åˆ‡æ¢</strong>ã€<strong>é•¿åˆ—è¡¨æµè§ˆåè¿”å›</strong>ç­‰åœºæ™¯ç®€ç›´æ˜¯ç¥å™¨ï¼</p>
<p>ç„¶è€Œï¼Œåœ¨ React çš„ä¸–ç•Œé‡Œï¼Œå®˜æ–¹å¹¶æ²¡æœ‰ç›´æ¥æä¾›è¿™æ ·ä¸€ä¸ªç»„ä»¶ï¼ˆReact Router æ›¾ç»æœ‰ï¼Œåæ¥ä¹Ÿæ²¡äº†ï¼‰ã€‚å½“æˆ‘ä»¬åˆ‡æ¢è·¯ç”±æˆ–æ¡ä»¶æ¸²æŸ“æ—¶ï¼Œç»„ä»¶ä¼šè¢«æ— æƒ…åœ°<strong>å¸è½½ï¼ˆUnmountï¼‰</strong>ï¼Œæ‰€æœ‰çš„çŠ¶æ€ï¼ˆStateï¼‰éƒ½ä¼šéšé£è€Œå»ã€‚ğŸƒ</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥æŒ‘æˆ˜ä¸€ä¸‹ï¼š<strong>ä¸ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œä»é›¶å¼€å§‹ï¼Œæ‰‹å†™ä¸€ä¸ª React ç‰ˆçš„ KeepAlive ç»„ä»¶ï¼</strong></p>
<p>é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œä½ å°†å­¦åˆ°ï¼š</p>
<ul>
<li>ğŸ” <strong>React ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸä¸é”€æ¯æœºåˆ¶</strong></li>
<li>ğŸ§  <strong>å¦‚ä½•åˆ©ç”¨é—­åŒ…å’Œ State è¿›è¡Œâ€œçŠ¶æ€å¤§æŒªç§»â€</strong></li>
<li>ğŸ¨ <strong>CSS <code>display: none</code> åœ¨ç»„ä»¶ç¼“å­˜ä¸­çš„å¦™ç”¨</strong></li>
<li>ğŸ›  <strong><code>Object.entries</code> çš„å®æˆ˜æŠ€å·§</strong></li>
</ul>
<p>å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬å¼€å§‹è¿™åœºâ€œæ‹¯æ•‘å¤±å¿†ç»„ä»¶â€çš„è¡ŒåŠ¨å§ï¼ğŸš€</p>
<hr/>
<h2 data-id="heading-0">ğŸ˜± ä¸€ã€ æ¡ˆå‘ç°åœºï¼šç»„ä»¶çš„â€œå¤±å¿†â€ç—‡</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ­å»ºä¸€ä¸ªç®€å•çš„åœºæ™¯ï¼Œçœ‹çœ‹æ²¡æœ‰ KeepAlive æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p>
<h3 data-id="heading-1">1.1 ç¼–å†™ä¸€ä¸ªä¼šâ€œæ•°æ•°â€çš„ç»„ä»¶</h3>
<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¸¦æœ‰çŠ¶æ€çš„ç»„ä»¶ï¼Œæ¯”å¦‚ä¸€ä¸ªè®¡æ•°å™¨ã€‚å½“æˆ‘ä»¬åœ¨ä¸¤ä¸ªè®¡æ•°å™¨ä¹‹é—´åˆ‡æ¢æ—¶ï¼Œè§‚å¯Ÿå®ƒä»¬çš„æ•°æ®ä¼šä¸ä¼šä¸¢å¤±ã€‚</p>
<p>æ‰“å¼€ <code>src/App.jsx</code>ï¼Œæˆ‘ä»¬å®šä¹‰ä¸¤ä¸ªç®€å•çš„ç»„ä»¶ <code>Counter</code> å’Œ <code>OtherCounter</code>ï¼ˆå…¶å®é€»è¾‘ä¸€æ ·ï¼Œä¸ºäº†æ¼”ç¤ºåŒºåˆ†ï¼‰ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// src/App.jsx</span>
<span class="hljs-keyword">import</span> { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">KeepAlive</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/KeepAlive.jsx'</span>

<span class="hljs-comment">// ğŸ“¦ è¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„è®¡æ•°å™¨ç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">Counter</span> = (<span class="hljs-params">{ name }</span>) =&gt; {
  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
  
  <span class="hljs-comment">// ğŸ” ç›‘å¬ç”Ÿå‘½å‘¨æœŸ</span>
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`âœ… <span class="hljs-subst">${name}</span> ç»„ä»¶æŒ‚è½½äº†ï¼`</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`âŒ <span class="hljs-subst">${name}</span> ç»„ä»¶è¢«å¸è½½äº†...`</span>);
    }
  }, []);
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{padding:</span> '<span class="hljs-attr">20px</span>', <span class="hljs-attr">border:</span> '<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>', <span class="hljs-attr">margin:</span> '<span class="hljs-attr">10px</span>'}}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{name} è§†å›¾<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å½“å‰è®¡æ•°: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;åŠ  1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-comment">// ğŸ“¦ å¦ä¸€ä¸ªç»„ä»¶ï¼ˆé€»è¾‘ç›¸åŒï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">OtherCounter</span> = (<span class="hljs-params">{ name }</span>) =&gt; {
  <span class="hljs-comment">// ... ä»£ç åŒä¸Š</span>
}
</code></pre>
<h3 data-id="heading-2">1.2 æ®‹é…·çš„ç°å®ï¼šåˆ‡æ¢å³é”€æ¯</h3>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨ <code>App</code> ä¸­é€šè¿‡çŠ¶æ€ <code>activeTab</code> æ¥æ§åˆ¶æ˜¾ç¤ºå“ªä¸€ä¸ªç»„ä»¶ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// src/App.jsx</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">App</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> [activeTab, setActiveTab] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">'A'</span>); <span class="hljs-comment">// æ§åˆ¶å½“å‰æ˜¾ç¤º A è¿˜æ˜¯ B</span>
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{marginBottom:</span> '<span class="hljs-attr">20px</span>'}}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setActiveTab('A')}&gt;æ˜¾ç¤º A ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setActiveTab('B')}&gt;æ˜¾ç¤º B ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* âš ï¸ ä¼ ç»Ÿå†™æ³•ï¼šä¸‰å…ƒè¿ç®—ç¬¦æ¡ä»¶æ¸²æŸ“ */}
      {/* å½“ activeTab å˜äº†ï¼Œä¹‹å‰çš„ç»„ä»¶å°±ä¼šè¢«å½»åº•é”€æ¯ï¼ */}
      { activeTab === 'A' ? <span class="hljs-tag">&lt;<span class="hljs-name">Counter</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"A"</span> /&gt;</span> : <span class="hljs-tag">&lt;<span class="hljs-name">OtherCounter</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"B"</span> /&gt;</span> }
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<p><strong>å®éªŒç»“æœï¼š</strong></p>
<ol>
<li>ç‚¹å‡»â€œæ˜¾ç¤º A ç»„ä»¶â€ï¼Œç‚¹å‡»â€œåŠ  1â€æŠŠæ•°å­—åŠ åˆ° 5ã€‚</li>
<li>ç‚¹å‡»â€œæ˜¾ç¤º B ç»„ä»¶â€ã€‚æ­¤æ—¶æ§åˆ¶å°æ‰“å° <code>âŒ A ç»„ä»¶è¢«å¸è½½äº†...</code>ï¼Œ<code>âœ… B ç»„ä»¶æŒ‚è½½äº†ï¼</code>ã€‚</li>
<li><strong>å…³é”®æ—¶åˆ»</strong>ï¼šå†æ¬¡ç‚¹å‡»â€œæ˜¾ç¤º A ç»„ä»¶â€ã€‚æ§åˆ¶å°æ‰“å° <code>âœ… A ç»„ä»¶æŒ‚è½½äº†ï¼</code>ï¼Œ<strong>ä½†æ˜¯æ•°å­—å˜å›äº† 0ï¼</strong> ğŸ˜­</li>
</ol>
<p>è¿™å°±æ˜¯ React çš„é»˜è®¤è¡Œä¸ºï¼š<strong>æ¡ä»¶æ¸²æŸ“ï¼ˆConditional Renderingï¼‰ä¼šå¯¼è‡´ç»„ä»¶æ ‘çš„å¸è½½å’Œé‡ç»˜</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-3">ğŸ§  äºŒã€ æ‹¯æ•‘è®¡åˆ’ï¼šKeepAlive çš„æ ¸å¿ƒåŸç†</h2>
<p>æ—¢ç„¶ React é»˜è®¤ä¼šå¸è½½ç»„ä»¶ï¼Œé‚£æˆ‘ä»¬èƒ½ä¸èƒ½**â€œéª—â€**è¿‡ Reactï¼Ÿ</p>
<h3 data-id="heading-4">2.1 æ ¸å¿ƒæ€è·¯</h3>
<p>KeepAlive çš„æ ¸å¿ƒæ€æƒ³å…¶å®å°±ä¸¤å¥è¯ï¼š</p>
<ol>
<li><strong>æŠŠæ‰€æœ‰ç»„ä»¶éƒ½æ¸²æŸ“å‡ºæ¥</strong>ï¼šä¸è¦çœŸçš„ä» DOM æ ‘ä¸Šç§»é™¤å®ƒä»¬ã€‚</li>
<li><strong>ç”¨ CSS æ§åˆ¶æ˜¾ç¤ºéšè—</strong>ï¼šéœ€è¦æ˜¾ç¤ºè°ï¼Œå°±æŠŠè°è®¾ä¸º <code>display: block</code>ï¼›ä¸éœ€è¦æ˜¾ç¤ºçš„ï¼Œè®¾ä¸º <code>display: none</code>ã€‚</li>
</ol>
<p>åªè¦ç»„ä»¶è¿˜åœ¨ DOM æ ‘ä¸Šï¼ˆå“ªæ€•çœ‹ä¸è§ï¼‰ï¼Œå®ƒçš„ State å°±ä¸ä¼šä¸¢å¤±ï¼ŒEffect ä¹Ÿä¸ä¼šè§¦å‘å¸è½½æ¸…ç†å‡½æ•°ã€‚è¿™å°±å«**â€œè§†è§‰ä¸Šçš„å¸è½½ï¼Œå†…å­˜é‡Œçš„æ°¸ç”Ÿâ€**ã€‚</p>
<h3 data-id="heading-5">2.2 æ•°æ®ç»“æ„è®¾è®¡</h3>
<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå®¹å™¨ï¼ˆç¼“å­˜æ± ï¼‰æ¥å­˜æ”¾æ‰€æœ‰æ›¾ç»æ¸²æŸ“è¿‡çš„ç»„ä»¶ã€‚
å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡ï¼ˆObjectï¼‰ä½œä¸ºç¼“å­˜ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> cache = {
  <span class="hljs-string">'A'</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Counter</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"A"</span> /&gt;</span></span>, <span class="hljs-comment">// ç¼“å­˜ A ç»„ä»¶çš„è™šæ‹Ÿ DOM</span>
  <span class="hljs-string">'B'</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">OtherCounter</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"B"</span> /&gt;</span></span> <span class="hljs-comment">// ç¼“å­˜ B ç»„ä»¶çš„è™šæ‹Ÿ DOM</span>
}
</code></pre>
<ul>
<li><strong>Key</strong>: ç”¨ä¸€ä¸ªå”¯ä¸€çš„ IDï¼ˆæ¯”å¦‚ <code>activeId</code>ï¼‰æ¥æ ‡è¯†ç»„ä»¶ã€‚</li>
<li><strong>Value</strong>: å­˜å‚¨ç»„ä»¶çš„ <code>children</code>ï¼ˆå³ React å…ƒç´ ï¼‰ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-6">ğŸ›  ä¸‰ã€ æ‰‹å†™å®æˆ˜ï¼šKeepAlive ç»„ä»¶</h2>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»º <code>src/components/KeepAlive.jsx</code>ï¼Œæ¥å®ç°è¿™ä¸ªé­”æ³•å®¹å™¨ã€‚</p>
<h3 data-id="heading-7">3.1 å®šä¹‰ Props å’Œ State</h3>
<p>æˆ‘ä»¬çš„ <code>KeepAlive</code> ç»„ä»¶éœ€è¦æ¥æ”¶ä¸¤ä¸ª Propsï¼š</p>
<ul>
<li><code>activeId</code>: å½“å‰åº”è¯¥æ˜¾ç¤ºå“ªä¸ªç»„ä»¶çš„ IDã€‚</li>
<li><code>children</code>: å½“å‰åº”è¯¥æ¸²æŸ“çš„ç»„ä»¶å†…å®¹ã€‚</li>
</ul>
<p>åŒæ—¶ï¼Œå†…éƒ¨éœ€è¦ä¸€ä¸ª <code>cache</code> çŠ¶æ€æ¥ä¿å­˜æ‰€æœ‰â€œè§è¿‡â€çš„ç»„ä»¶ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// src/components/KeepAlive.jsx</span>
<span class="hljs-keyword">import</span> { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">KeepAlive</span> = (<span class="hljs-params">{ activeId, children }</span>) =&gt; {
    <span class="hljs-comment">// ğŸ—„ ç¼“å­˜æ± ï¼šç”¨æ¥å­˜æ‰€æœ‰æ¸²æŸ“è¿‡çš„ç»„ä»¶èŠ‚ç‚¹</span>
    <span class="hljs-comment">// ç»“æ„ç¤ºä¾‹ï¼š{ 'A': &lt;Counter /&gt;, 'B': &lt;OtherCounter /&gt; }</span>
    <span class="hljs-keyword">const</span> [cache, setCache] = <span class="hljs-title function_">useState</span>({}); 

    <span class="hljs-comment">// ... é€»è¾‘å¾…è¡¥å……</span>
}
</code></pre>
<h3 data-id="heading-8">3.2 ç¼“å­˜é€»è¾‘ï¼šåªå¢ä¸å‡</h3>
<p>æˆ‘ä»¬éœ€è¦ç›‘å¬ <code>activeId</code> å’Œ <code>children</code> çš„å˜åŒ–ã€‚ä¸€æ—¦æœ‰æ–°çš„ <code>activeId</code> è¿›æ¥ï¼Œä¸”ç¼“å­˜æ± é‡Œæ²¡æœ‰å®ƒï¼Œæˆ‘ä»¬å°±æŠŠå®ƒå­˜èµ·æ¥ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx">    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">()=&gt;</span> {
        <span class="hljs-comment">// å½“ activeId å˜åŒ–ï¼Œè¯´æ˜ç”¨æˆ·åˆ‡æ¢äº† Tab</span>
        <span class="hljs-comment">// å½“ children å˜åŒ–ï¼Œè¯´æ˜ç»„ä»¶å†…å®¹æ›´æ–°äº†</span>
        
        <span class="hljs-comment">// ğŸ” æ£€æŸ¥ç¼“å­˜æ± é‡Œæ˜¯å¦å·²ç»æœ‰è¿™ä¸ª ID çš„ç»„ä»¶äº†ï¼Ÿ</span>
        <span class="hljs-keyword">if</span>(!cache[activeId]) { 
            <span class="hljs-comment">// ğŸ’¡ å¦‚æœæ²¡æœ‰ï¼Œè¯´æ˜æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°è¿™ä¸ªç»„ä»¶ï¼Œèµ¶ç´§å­˜èµ·æ¥ï¼</span>
            <span class="hljs-title function_">setCache</span>(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
                ...prev, <span class="hljs-comment">// ä¿ç•™ä¹‹å‰çš„ç¼“å­˜</span>
                [activeId]: children <span class="hljs-comment">// æŠŠå½“å‰çš„ children å­˜å…¥å¯¹åº”çš„ key</span>
            }))
        }
    }, [activeId, children, cache])
</code></pre>
<p><strong>âš ï¸ æ³¨æ„ï¼š</strong> è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨äº† React çš„ <code>children</code> å±æ€§ã€‚åœ¨ React ä¸­ï¼Œ<code>children</code> å…¶å®å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆè™šæ‹Ÿ DOMï¼‰ï¼ŒæŠŠå®ƒå­˜è¿› State é‡Œæ˜¯å®Œå…¨åˆæ³•çš„ã€‚</p>
<h3 data-id="heading-9">3.3 æ¸²æŸ“é€»è¾‘ï¼šCSS é­”æ³•</h3>
<p>æœ€å…³é”®çš„ä¸€æ­¥æ¥äº†ï¼æˆ‘ä»¬ä¸èƒ½åƒ App é‡Œé‚£æ ·å†™ <code>activeId === 'A' ? ... : ...</code>ï¼Œå› ä¸ºé‚£æ ·ä¼šé”€æ¯ç»„ä»¶ã€‚
æˆ‘ä»¬è¦<strong>éå†æ•´ä¸ªç¼“å­˜æ± </strong>ï¼ŒæŠŠæ‰€æœ‰ç¼“å­˜çš„ç»„ä»¶éƒ½æ¸²æŸ“å‡ºæ¥ï¼Œä½†åªè®©å½“å‰æ¿€æ´»çš„é‚£ä¸ª<strong>å¯è§</strong>ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx">    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
          {
            // ğŸ›  Object.entriesï¼šæŠŠå¯¹è±¡è½¬æˆæ•°ç»„
            // cache = { A: <span class="hljs-tag">&lt;<span class="hljs-name">ComA</span>/&gt;</span>, B: <span class="hljs-tag">&lt;<span class="hljs-name">ComB</span>/&gt;</span> }
            // è½¬æ¢å = [ ['A', <span class="hljs-tag">&lt;<span class="hljs-name">ComA</span>/&gt;</span>], ['B', <span class="hljs-tag">&lt;<span class="hljs-name">ComB</span>/&gt;</span>] ]
            Object.entries(cache).map(([id, component]) =&gt; (
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
                  <span class="hljs-attr">key</span>=<span class="hljs-string">{id}</span> // ğŸ”‘ <span class="hljs-attr">åˆ«å¿˜äº†åŠ </span> <span class="hljs-attr">key</span>ï¼Œ<span class="hljs-attr">è¿™æ˜¯åˆ—è¡¨æ¸²æŸ“çš„è§„çŸ©</span>
                  // ğŸ¨ <span class="hljs-attr">é­”æ³•æ—¶åˆ»</span>ï¼š
                  // <span class="hljs-attr">å¦‚æœ</span> <span class="hljs-attr">id</span> <span class="hljs-attr">ç­‰äºå½“å‰æ¿€æ´»çš„</span> <span class="hljs-attr">id</span>ï¼Œ<span class="hljs-attr">å°±æ˜¾ç¤º</span> (<span class="hljs-attr">block</span>)
                  // <span class="hljs-attr">å¦åˆ™</span>ï¼Œ<span class="hljs-attr">å°±éšè—</span> (<span class="hljs-attr">none</span>)ï¼Œ<span class="hljs-attr">ä½†å®ƒä¾ç„¶åœ¨</span> <span class="hljs-attr">DOM</span> <span class="hljs-attr">æ ‘ä¸Š</span>ï¼
                  <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">display:</span> <span class="hljs-attr">id</span> === <span class="hljs-string">activeId</span> ? '<span class="hljs-attr">block</span>' <span class="hljs-attr">:</span> '<span class="hljs-attr">none</span>' }}
                &gt;</span>
                    {component}
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            ))
          }
        <span class="hljs-tag">&lt;/&gt;</span></span>
    )
</code></pre>
<h3 data-id="heading-10">3.4 å®Œæ•´ä»£ç </h3>
<p>è®©æˆ‘ä»¬æŠŠä»£ç æ‹¼åœ¨ä¸€èµ·ï¼Œæ¬£èµä¸€ä¸‹è¿™ä¸ªä¸åˆ° 40 è¡Œçš„ç²¾å·§ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// src/components/KeepAlive.jsx</span>
<span class="hljs-keyword">import</span> { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">KeepAlive</span> = (<span class="hljs-params">{ activeId, children }</span>) =&gt; {
    <span class="hljs-keyword">const</span> [cache, setCache] = <span class="hljs-title function_">useState</span>({});

    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">if</span>(!cache[activeId]) {
            <span class="hljs-title function_">setCache</span>(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
                ...prev,
                [activeId]: children
            }))
        }
    }, [activeId, children, cache])

    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
          {
            Object.entries(cache).map(([id, component]) =&gt; (
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
                  <span class="hljs-attr">key</span>=<span class="hljs-string">{id}</span>
                  <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">display:</span> <span class="hljs-attr">id</span> === <span class="hljs-string">activeId</span> ? '<span class="hljs-attr">block</span>' <span class="hljs-attr">:</span> '<span class="hljs-attr">none</span>' }}
                &gt;</span>
                    {component}
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            ))
          }
        <span class="hljs-tag">&lt;/&gt;</span></span>
    )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">KeepAlive</span>
</code></pre>
<hr/>
<h2 data-id="heading-11">ğŸ‰ å››ã€ è§è¯å¥‡è¿¹ï¼šæ¥å…¥ KeepAlive</h2>
<p>ç°åœ¨å›åˆ° <code>src/App.jsx</code>ï¼Œç”¨æˆ‘ä»¬åˆšå†™å¥½çš„ <code>KeepAlive</code> æ›¿æ¢æ‰åŸæ¥çš„æ¡ä»¶æ¸²æŸ“ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// src/App.jsx</span>

<span class="hljs-comment">// ... å¼•å…¥ KeepAlive</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">App</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> [activeTab, setActiveTab] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">'A'</span>);
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* æŒ‰é’®éƒ¨åˆ†çœç•¥... */}

      {/* âœ¨ ä½¿ç”¨ KeepAlive åŒ…è£¹ */}
      {/* activeId å‘Šè¯‰ç»„ä»¶ç°åœ¨è¯¥æ˜¾ç¤ºè° */}
      <span class="hljs-tag">&lt;<span class="hljs-name">KeepAlive</span> <span class="hljs-attr">activeId</span>=<span class="hljs-string">{activeTab}</span>&gt;</span>
        {/* children ä¾ç„¶æ ¹æ®æ¡ä»¶ä¼ å…¥å½“å‰éœ€è¦çš„ç»„ä»¶ */}
        { activeTab === 'A' ? <span class="hljs-tag">&lt;<span class="hljs-name">Counter</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"A"</span> /&gt;</span> : <span class="hljs-tag">&lt;<span class="hljs-name">OtherCounter</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"B"</span> /&gt;</span> }
      <span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span>
      
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<p><strong>å†æ¬¡å®éªŒï¼š</strong></p>
<ol>
<li>ç‚¹å‡»â€œæ˜¾ç¤º A ç»„ä»¶â€ï¼Œè®¡æ•°åŠ åˆ° 5ã€‚</li>
<li>ç‚¹å‡»â€œæ˜¾ç¤º B ç»„ä»¶â€ã€‚<strong>æ³¨æ„æ§åˆ¶å°ï¼</strong>
<ul>
<li>âŒ <strong>æ²¡æœ‰æ‰“å°</strong> <code>A ç»„ä»¶è¢«å¸è½½äº†</code>ï¼</li>
<li>âœ… æ‰“å°äº† <code>B ç»„ä»¶æŒ‚è½½äº†</code>ã€‚</li>
</ul>
</li>
<li>å†æ¬¡ç‚¹å‡»â€œæ˜¾ç¤º A ç»„ä»¶â€ã€‚
<ul>
<li>âŒ <strong>æ²¡æœ‰æ‰“å°</strong> <code>A ç»„ä»¶æŒ‚è½½äº†</code>ï¼ˆå› ä¸ºå®ƒä¸€ç›´éƒ½åœ¨ï¼‰ã€‚</li>
<li>âœ… <strong>å±å¹•ä¸Šçš„æ•°å­—ä¾ç„¶æ˜¯ 5ï¼</strong></li>
</ul>
</li>
</ol>
<p>æˆåŠŸäº†ï¼ğŸŠ æˆ‘ä»¬æˆåŠŸå®ç°äº†ç»„ä»¶çš„çŠ¶æ€ä¿æŒï¼</p>
<hr/>
<h2 data-id="heading-12">ğŸ§ äº”ã€ æ€»ç»“ä¸æ€è€ƒ</h2>
<p>é€šè¿‡ä»Šå¤©çš„æ‰‹å†™å®æˆ˜ï¼Œæˆ‘ä»¬æ·±å…¥ç†è§£äº† React ç»„ä»¶ç¼“å­˜çš„æ ¸å¿ƒå¥¥ä¹‰ï¼š</p>
<ol>
<li><strong>React çš„â€œæ— æƒ…â€</strong>ï¼šé»˜è®¤çš„æ¡ä»¶æ¸²æŸ“ä¼šå½»åº•é”€æ¯ç»„ä»¶ï¼Œå¯¼è‡´çŠ¶æ€ä¸¢å¤±ã€‚</li>
<li><strong>CSS çš„â€œæ¸©æŸ”â€</strong>ï¼šåˆ©ç”¨ <code>display: none</code> å¯ä»¥è®©ç»„ä»¶åœ¨è§†è§‰ä¸Šæ¶ˆå¤±ï¼Œä½†åœ¨ DOM æ ‘å’Œ React è™šæ‹Ÿ DOM æ ‘ä¸­ä¾ç„¶å­˜æ´»ï¼Œä»è€Œä¿ç•™çŠ¶æ€ã€‚</li>
<li><strong>æ•°æ®çš„â€œåˆ†èº«â€</strong>ï¼šæˆ‘ä»¬ç”¨ä¸€ä¸ª <code>cache</code> å¯¹è±¡ï¼ŒæŠŠç»„ä»¶çš„è™šæ‹Ÿ DOM èŠ‚ç‚¹ï¼ˆchildrenï¼‰å­˜äº†èµ·æ¥ï¼Œå¹¶é€šè¿‡ <code>Object.entries</code> éå†æ¸²æŸ“ã€‚</li>
</ol>
<p>å½“ç„¶ï¼Œè¿™ä¸ªç®€æ˜“ç‰ˆçš„ <code>KeepAlive</code> è¿˜æœ‰å¾ˆå¤šå¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ï¼š</p>
<ul>
<li>æ¯”å¦‚ç°åœ¨ä¼šç¼“å­˜æ‰€æœ‰ç»„ä»¶ï¼Œå¦‚æœç»„ä»¶å¤ªå¤šï¼Œå†…å­˜å ç”¨ä¼šå˜å¤§ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥åŠ ä¸€ä¸ª LRU ç®—æ³•æ¥é™åˆ¶ç¼“å­˜æ•°é‡ï¼Ÿ</li>
<li>æ¯”å¦‚æ€ä¹ˆå¤„ç†ç»„ä»¶çœŸçš„éœ€è¦å¸è½½çš„æƒ…å†µï¼Ÿ</li>
</ul>
<p>ä½†ä½œä¸ºä¸€ä¸ªåŸç†éªŒè¯ï¼Œå®ƒå·²ç»å®Œç¾å±•ç¤ºäº† <strong>KeepAlive</strong> çš„æ ¸å¿ƒé­”æ³•ã€‚ä»¥åé¢è¯•å®˜å†é—®ä½ â€œReact æ€ä¹ˆå®ç° KeepAliveâ€ï¼Œä½ å°±å¯ä»¥è‡ªä¿¡åœ°ç”©å‡ºè¿™æ®µä»£ç äº†ï¼ğŸ˜</p>
<p>å¿«å»ä½ çš„é¡¹ç›®é‡Œè¯•è¯•å§ï¼åˆ«å¿˜äº†ç‚¹èµæ”¶è—å“¦ï¼ğŸ’–</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¾å›¢åœ¨ GitHub ä¸Šæ‚„æ‚„å¼€æº AI å¤§æ¨¡å‹ï¼Ÿ8 ä¸ªå¤§è„‘å¹¶è¡Œ]]></title>    <link>https://juejin.cn/post/7599924721005953087</link>    <guid>https://juejin.cn/post/7599924721005953087</guid>    <pubDate>2026-01-28T01:49:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599924721005953087" data-draft-id="7599929684021231635" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¾å›¢åœ¨ GitHub ä¸Šæ‚„æ‚„å¼€æº AI å¤§æ¨¡å‹ï¼Ÿ8 ä¸ªå¤§è„‘å¹¶è¡Œ"/> <meta itemprop="keywords" content="GitHub"/> <meta itemprop="datePublished" content="2026-01-28T01:49:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é€›é€›GitHub"/> <meta itemprop="url" content="https://juejin.cn/user/1442202996186093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¾å›¢åœ¨ GitHub ä¸Šæ‚„æ‚„å¼€æº AI å¤§æ¨¡å‹ï¼Ÿ8 ä¸ªå¤§è„‘å¹¶è¡Œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1442202996186093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é€›é€›GitHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T01:49:42.000Z" title="Wed Jan 28 2026 01:49:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2026 å¹´ï¼Œå¯èƒ½æ˜¯<strong>ä¼šè‡ªå·±æ·±æ€ç†Ÿè™‘çš„æ™ºèƒ½ä½“æ¨¡å‹æ­£å¼ç™»åœº</strong>çš„ä¸€å¹´ã€‚</p>
<p>ç¾å›¢ LongCat å›¢é˜Ÿåˆšåˆšå¼€æºçš„Â <strong>LongCat-Flash-Thinking-2601</strong>ï¼Œå°±æ˜¯è¿™ä¸€æ³¢æµªæ½®ä¸­çš„æ ‡å¿—æ€§æ¨¡å‹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d4f60e9503449169b2acfcb8d699088~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169785&amp;x-signature=U%2BmKkSLm63qEHJ2YCg2SqlY04Dw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®ƒä¸ä»…æ˜¯ä¸€ä¸ªå¤§æ¨¡å‹ï¼Œæ›´æ˜¯ä¸€ä¸ªä¸ºæ™ºèƒ½ä½“ Agent æ—¶ä»£é‡èº«æ‰“é€ çš„<strong>å¤§å‹æ¨ç†æ¨¡å‹ï¼ˆLarge Reasoning Model, LRMï¼‰</strong> ï¼Œå·ç§°å…¨çƒé¦–ä¸ªå®Œæ•´å¼€æºã€å¯åœ¨çº¿ä½“éªŒçš„ã€Œé‡æ€è€ƒã€æ¨¡å‹ã€‚</p>
<p>åœ¨å·¥å…·è°ƒç”¨ã€æ™ºèƒ½æœç´¢ã€äº¤äº’å¼æ¨ç†ç­‰ä¸€ç³»åˆ—è¯„æµ‹ä¸­éƒ½å†²ä¸Šäº†å¼€æº SOTAã€‚</p>
<p>01</p>
<p><strong>å¼€æºæ¨¡å‹ç®€ä»‹</strong></p>
<p>2026 å¹´ 1 æœˆ 15 æ—¥ï¼Œç¾å›¢æ­£å¼å‘å¸ƒäº† LongCat-Flash-Thinking-2601ï¼Œå¼€æºå¯ç”¨ï¼Œå¯åœ¨çº¿ä½“éªŒï¼š</p>
<ul>
<li>å‚æ•°è§„æ¨¡ï¼š5600 äº¿ï¼Œé‡‡ç”¨ MoE æ··åˆä¸“å®¶æ¶æ„</li>
<li>å®šä½ï¼šé«˜æ€§èƒ½ã€é«˜æ•ˆç‡çš„å¤§å‹æ¨ç†æ¨¡å‹</li>
<li>æ ¸å¿ƒæ–¹å‘ï¼šAgent èƒ½åŠ› + æ·±åº¦æ€è€ƒèƒ½åŠ›</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/adb7d289777f48888c71cf27802454e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169785&amp;x-signature=1X9xMEKuRqQhTpOu5u1MS0sBp%2BU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®ƒä¸æ˜¯å•çº¯ä¸ºäº†æ›´ä¼šèŠå¤©ï¼Œè€Œæ˜¯ä¸ºäº†åœ¨ä»¥ä¸‹è¿™ç§ä»»åŠ¡é‡Œè¡¨ç°æ›´å¥½ï¼š</p>
<ul>
<li>å¤šå·¥å…·ååŒçš„å¤æ‚ä»»åŠ¡</li>
<li>éœ€è¦å¤šæ­¥æ¨ç†ã€åå¤æƒè¡¡çš„é«˜éš¾é—®é¢˜</li>
<li>åœ¨ä¿¡æ¯ä¸å®Œç¾ã€ç¯å¢ƒæœ‰å™ªå£°çš„çœŸå®åœºæ™¯ä¸‹ï¼Œä¾ç„¶ä¿æŒç¨³å®šå†³ç­–</li>
</ul>
<p>å¯ä»¥ç†è§£ä¸ºï¼šä»¥å‰çš„å¤§æ¨¡å‹æ›´åƒèªæ˜å­¦ç”Ÿï¼ŒLongCat-Flash-Thinking-2601 åˆ™åœ¨åŠªåŠ›å˜æˆé è°±ä¸“å®¶ã€‚</p>
<p>çœ‹ä¸‹é¢è¿™ä¸ªå›¾ï¼Œä¸ä»…åœ¨æ™ºèƒ½ä½“å·¥å…·è°ƒç”¨ã€æ™ºèƒ½ä½“æœç´¢ã€å·¥å…·é›†æˆæ¨ç†ç­‰æ ¸å¿ƒä»»åŠ¡çš„åŸºå‡†æµ‹è¯•ä¸­æ–©è·é¡¶å°–æˆç»©ï¼Œè¿˜åœ¨ä»»æ„åˆ†å¸ƒå¤–çš„çœŸå®æ™ºèƒ½ä½“åœºæ™¯ä¸­ï¼Œå®ç°äº†æ³›åŒ–èƒ½åŠ›çš„æ˜¾è‘—æå‡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d74e9a0c13f9414fb39c66b06a86f4f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169785&amp;x-signature=NRAtSoksGdLI5FsCSiWeKi4uHyA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä»è®­ç»ƒå¼€å§‹å°±æŠŠå®ƒå½“ Agent çš„å¤§è„‘æ¥æ‰“é€ ï¼š</p>
<p>ç¾å›¢æ„å»ºäº†åŒ…å«æ¯ä¸ªç¯å¢ƒ 60+ å·¥å…·çš„é«˜è´¨é‡ç¯å¢ƒé›†åˆï¼Œå·¥å…·ä¹‹é—´å½¢æˆå¤æ‚ä¾èµ–å›¾ï¼Œç”¨æ¥è®­ç»ƒæ¨¡å‹åœ¨çœŸå®å·¥å…·ç½‘ç»œé‡Œæ“ä½œä¸–ç•Œã€‚</p>
<p>ä»»åŠ¡ä¸æ˜¯ç®€å•é—®ç­”ï¼Œè€Œæ˜¯ä»ç¯å¢ƒå›¾ä¸­æŠ½å–è¿é€šå­å›¾ï¼Œè¦æ±‚æ¨¡å‹åˆç†è§„åˆ’è°ƒç”¨å¤šç§å·¥å…·ï¼Œè§£å†³å¤æ‚ä»»åŠ¡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/54976edf1e724914a3f4edbacfe4fcf7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169785&amp;x-signature=U9sYkp%2B%2FvmmZFMhk6zS78NObw1U%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é€šè¿‡å¤§è§„æ¨¡ã€å¤šç¯å¢ƒçš„å¼ºåŒ–å­¦ä¹ ï¼Œç»“åˆå¼‚æ­¥ rollouts ä¸ DORA è®­ç»ƒæ¡†æ¶ï¼Œæ¨¡å‹åœ¨ä¸åŒç¯å¢ƒä¹‹é—´è¿ç§»å’Œæ³›åŒ–çš„èƒ½åŠ›æ˜¾è‘—æå‡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee9f674bd7e345d0a175736b7a7a27a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169785&amp;x-signature=9EzwtbnR2EQfjeOFii24qhSJ6dA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™èƒŒåçš„ç›®æ ‡å¾ˆç›´æ¥ï¼š</p>
<p>è®©æ¨¡å‹åœ¨æ–°å·¥å…·ã€æ–°åœºæ™¯é¢å‰ä¾ç„¶èƒ½å¿«é€Ÿä¸Šæ‰‹ï¼Œé™ä½ä¼ä¸šåœ¨çœŸå®ä¸šåŠ¡ä¸­é€‚é…æ–°å·¥å…·çš„æˆæœ¬ã€‚</p>
<p>02</p>
<p><strong>é‡æ€è€ƒæ¨¡å¼</strong></p>
<p>LongCat-Flash-Thinking-2601 æœ€å¤§çš„å–ç‚¹å°±æ˜¯é‡æ€è€ƒæ¨¡å¼ï¼ˆHeavy Thinking Modeï¼‰ã€‚</p>
<p>ä½ å¯ä»¥æŠŠå®ƒç†è§£æˆÂ AI ç‰ˆå¤šè½®å¤´è„‘é£æš´ + å¤ç›˜æ€»ç»“ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4f0c8606aec445199e113062d20a882~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169785&amp;x-signature=mnvxgbtBwzF7ZRxVk2ujugLTUZk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>â‘  å¹¶è¡Œæ€è€ƒé˜¶æ®µï¼š</p>
<p>æ¨¡å‹åŒæ—¶å¯åŠ¨å¤šæ¡æ¨ç†è·¯å¾„ï¼Œ8 ä¸ªå¤§è„‘å¹¶è¡Œæ€è€ƒï¼Œå°±åƒ 8 ä¸ªä¸åŒé£æ ¼çš„é«˜æ‰‹åœ¨åŒä¸€æ—¶é—´å„æƒ³å„çš„æ–¹æ¡ˆã€‚</p>
<p>è¿™äº›è·¯å¾„åˆ»æ„ä¿æŒæ€è·¯å¤šæ ·æ€§ï¼Œé¿å…æ‰€æœ‰æ¨ç†éƒ½èµ°ä¸€æ¡æ€ç»´æƒ¯æ€§è·¯çº¿ã€‚</p>
<p>â‘¡ æ€»ç»“å½’çº³é˜¶æ®µï¼š</p>
<p>æ¨¡å‹ä¼šå¯¹è¿™äº›è·¯å¾„è¿›è¡Œæ¢³ç†ã€å¯¹æ¯”ã€ç­›é€‰ä¸åˆæˆï¼Œæç‚¼å‡ºæ›´ä¼˜çš„è§£æ³•ï¼›</p>
<p>ä¼˜åŒ–è¿‡çš„ç»“æœå†è¢«é‡æ–°è¾“å…¥æ¨¡å‹è¿›è¡Œè¿­ä»£æ¨ç†ï¼Œå½¢æˆä¸€ä¸ªå°é—­çš„æ·±åº¦æ€è€ƒå¾ªç¯ã€‚</p>
<p>â‘¢ é¢å¤–å¼ºåŒ–å­¦ä¹ è®­ç»ƒï¼š</p>
<p>LongCat å›¢é˜Ÿä¸“é—¨ä¸ºè¿™ä¸€æ¨¡å¼è®¾è®¡äº†é¢å¤–çš„å¼ºåŒ–å­¦ä¹ ç¯èŠ‚ï¼Œé‡ç‚¹è®­ç»ƒæ¨¡å‹çš„æ€»ç»“ä¸å½’çº³èƒ½åŠ›ã€‚</p>
<p>ç®€å•è¯´ï¼šæ™®é€šæ¨¡å¼æ˜¯æƒ³ä¸€éã€ç»™ç­”æ¡ˆï¼Œé‡æ€è€ƒæ¨¡å¼æ˜¯å¤šè·¯å¹¶è¡Œæƒ³ã€æ¥å›å¤ç›˜æƒ³æ¸…æ¥šå†å›ç­”ã€‚</p>
<p>03</p>
<p><strong>è¯•ä¸€ä¸‹</strong></p>
<p>æ¯”å¦‚æˆ‘è¾“å…¥ï¼š</p>
<p>æŸåŸºé‡‘åœ¨ 2024â€“2026 è¿ç»­ä¸‰å¹´æ”¶ç›Šç‡åˆ†åˆ«ä¸º +20%ã€-10%ã€+15%ã€‚</p>
<p>è¯·è®¡ç®—è¿™ä¸‰å¹´çš„æ€»æ”¶ç›Šç‡ï¼ˆä¸æ˜¯ç®€å•ç›¸åŠ ï¼‰ï¼Œå¹¶è§£é‡Šä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥æŠŠç™¾åˆ†æ¯”ç›¸åŠ ã€‚æœ€åï¼Œç”¨ç”Ÿæ´»ä¸­ä¸€ä¸ªç›´è§‚çš„ç±»æ¯”å¸®åŠ©éç†å·¥ç§‘è¯»è€…ç†è§£è¿™ä¸ªç»“è®ºã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3848d54f40b847ed8c75223f27685d9d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169785&amp;x-signature=AOgb7WhS6yx8HlkaD1IdjAk4LlQ%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸‹æ–¹é“¾æ¥è§†é¢‘å¯æŸ¥çœ‹æ¡ˆä¾‹ï¼Œå¯ä»¥çœ‹åˆ°ï¼ŒLongCat-Flash-Thinking-2601 ä¼šåˆ†æ 8 ä¸ª Thinker å¯¹åŒä¸€ä¸ªQueryçš„å›ç­”ï¼Œç„¶åç»™å‡ºä¸€ä¸ªæœ€ç»ˆçš„ã€æœ€ä½³çš„å›å¤ã€‚</p>
<p>å†æ¯”å¦‚ï¼š</p>
<p>ç»„ç»‡ä¸€ä¸ªå•†åŠ¡å±€ï¼Œæœ‰ä¸Šçº§é¢†å¯¼ã€ä¸Šä¸Šçº§é¢†å¯¼ã€ä¸Šä¸Šä¸Šçº§é¢†å¯¼ã€æœ‰å®¢æˆ·ã€æœ‰å†…å‘çš„æŠ€æœ¯å¤§ç‰›ï¼Œä½ æ˜¯äº§å“ç»ç†ï¼Œè€æ¿è®©ä½ æ’åº§ä½ &amp; ä¸»æŒä¸€ä¸‹ï¼Œä½ è¦æ€ä¹ˆæ’åº§ä½ï¼Ÿæ”¯æŒæ€ä¹ˆèŠï¼Ÿ</p>
<p>çœ‹ä¸‹Â LongCat çš„å›ç­”ï¼Œè¿˜æŒºæœ‰æ„æ€çš„ã€‚å°¤å…¶æ˜¯æ€ä¹ˆåï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25422e8ffa4049b1875b50c6cf9dde14~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169785&amp;x-signature=GNnTw7vIVHxLUFkE8n%2FMKFPZqjU%3D" alt="image.png" loading="lazy"/></p>
<p>è¿˜æœ‰ä¸€ä¸ªï¼š</p>
<p>æˆ‘æ˜¯ä¸€åä½“åˆ¶å†…/å›½ä¼çš„æ–°äººã€‚æˆ‘çš„ç›´å±ç§‘é•¿è®©æˆ‘æŠŠä¸€ä»½æ–‡ä»¶é‡ç‚¹çªå‡ºAæ•°æ®ï¼Œä½†åˆ†ç®¡å‰¯å±€é•¿ï¼ˆç§‘é•¿çš„ä¸Šçº§ï¼‰ç§ä¸‹æš—ç¤ºæˆ‘ä»–å¯¹Aæ•°æ®ä¸æ„Ÿå…´è¶£ï¼Œæƒ³é‡ç‚¹çœ‹Bæ•°æ®ã€‚æ˜å¤©å°±è¦æ±‡æŠ¥ï¼Œæˆ‘è¯¥æ€ä¹ˆå†™è¿™ä»½æŠ¥å‘Šï¼Ÿè¯·ç»™å‡ºå…·ä½“çš„å¤„ç†æ€è·¯ï¼Œå¹¶æ¨¡æ‹Ÿä¸€æ®µæˆ‘å‘ç§‘é•¿æ±‡æŠ¥æ—¶çš„é«˜æƒ…å•†è¯æœ¯ã€‚å…ˆæ¥çœ‹çœ‹è¿™ä¸ª 8 ä¸ª Thinker æ¯ä¸ªç»™å‡ºçš„è¦ç‚¹ï¼šæœ‰çš„è¯´ä¸è¦æ“…è‡ªä½œä¸»ã€è‡ªä½œèªæ˜ï¼Œæœ‰çš„è¯´è¦ç”¨å­¦ä¹ æ€åº¦å’Œæ‰§è¡Œæ„è¯†ä¿æŠ¤è‡ªå·±ï¼Œè¿˜æœ‰çš„è¯´è¦æŠŠå¯¹æŠ—æ€§é€‰æ‹©è½¬åŒ–ä¸ºå»ºè®¾æ€§è¡¥å……ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ddf11b82ca4e4d2ca7d9efb3736f6a43~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169785&amp;x-signature=sl1gBKVX%2FR2TyTohRGOF%2FFz4Ty0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸‹é¢æ˜¯ LongCat æœ€ç»ˆç”Ÿæˆçš„ä¸€ä¸ªå†…å®¹ï¼Œé›†ä¼—å®¶ä¹‹æ‰€é•¿ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8cd2df6a38b840fcbc8322b7a503e4a0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169785&amp;x-signature=6SdntSaWLwxqWcdOTv%2FAXXqX9wo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0bce287bd913430f9a4addedc0bda47c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169785&amp;x-signature=VUCfUq3Ogd%2FwggH7JwdBGwugKp4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¯èƒ½åœ¨è¿™ç§äººæƒ…ä¸–æ•…çš„åœºæ™¯ä¸Šï¼Œå¤šæƒ³æƒ³æ€»æœ‰é è°±çš„è§£æ³•ã€‚ã€‚ã€‚</p>
<p>æ¯”å¦‚ LongCat çš„å›å¤å°±æ˜¯åœ¨ä¸è¶Šçº§çš„å‰æä¸‹ï¼Œå¹³è¡¡ä¸¤æ–¹éœ€æ±‚ã€‚</p>
<p>å†æ¥çœ‹ä¸‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<p>è¯·ä¼°ç®—ä¸€ä¸‹ï¼Œå¦‚æœè¦æŠŠå¤ªå¹³æ´‹çš„æ°´å…¨éƒ¨æ¢æˆçç å¥¶èŒ¶ï¼Œéœ€è¦å¤šå°‘åªå¥¶ç‰›äº§å¥¶ï¼Ÿè¯·åˆ—å‡ºæ‰€æœ‰çš„å‡è®¾æ•°æ®ï¼ˆå¦‚å¤ªå¹³æ´‹ä½“ç§¯ã€å¥¶èŒ¶é…æ¯”ã€å¥¶ç‰›äº§é‡ç­‰ï¼‰å¹¶ä¸€æ­¥æ­¥è®¡ç®—ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a3e22a68381459fa80661ac44314b7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169785&amp;x-signature=WGHmrq61wQyBXlCYsqObqVEGlW0%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ° LongCat è‡ªå·±ç®—å®Œä¸€éï¼Œè¿˜å¾—çœ‹çœ‹è‡ªå·±ç®—çš„å’Œ 8 ä¸ª Thinker çš„ä¸ºå•¥ä¸ä¸€æ ·ã€‚æ¯”å¦‚å®ƒè®¤ä¸ºæœ‰ 4 ä¸ª Thinker å›ç­”çš„æ˜¯åˆç†çš„ï¼Œä½†æ˜¯æœ‰å‡ ä¸ªå›ç­”ä¸åˆç†ï¼Œå…·ä½“è¯¯å·®å¯èƒ½å‡ºåœ¨å“ªé‡Œï¼Œä»–ä¹Ÿä¼šåˆ†æä¸€ä¸‹ã€‚<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b92866aaec93443b8517461f61d580c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169785&amp;x-signature=2kCUep%2FR%2FkeMHzHgQgmBAL6zxr0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>03</p>
<p><strong>å¿«æ¥ä½“éªŒ</strong></p>
<p>ç›®å‰Â LongCat-Flash-Thinking-2601Â æ¨¡å‹å·²ç»åœ¨ HuggingFace å’Œ GitHub ä¸Šå¼€æºã€‚ä½ ä¹Ÿå¯ä»¥ç›´æ¥è®¿é—®Â longcat.chat ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">GitHubï¼šhttps://github.com/meituan-longcat/LongCat-Flash-Thinking-2601HuggingFaceï¼šhttps://huggingface.co/meituan-longcat/LongCat-Flash-Thinking-2601ä½“éªŒé“¾æ¥ï¼šhttps://longcat.chat/æŠ€æœ¯æŠ¥å‘Šï¼šhttps://github.com/meituan-longcat/LongCat-Flash-Thinking-2601/blob/main/LongCat_Flash_Thinking_2601_Technical_Report.pdf
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å­—èŠ‚ç Javassistå¦‚ä½•ç»™åå°„åŠ é€Ÿ]]></title>    <link>https://juejin.cn/post/7599922362998407214</link>    <guid>https://juejin.cn/post/7599922362998407214</guid>    <pubDate>2026-01-28T01:52:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599922362998407214" data-draft-id="7599917711793569802" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å­—èŠ‚ç Javassistå¦‚ä½•ç»™åå°„åŠ é€Ÿ"/> <meta itemprop="keywords" content="åç«¯,Java,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-28T01:52:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SimonKing"/> <meta itemprop="url" content="https://juejin.cn/user/4001878056904584"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å­—èŠ‚ç Javassistå¦‚ä½•ç»™åå°„åŠ é€Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4001878056904584/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SimonKing
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T01:52:58.000Z" title="Wed Jan 28 2026 01:52:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šã€ç¼–ç¨‹æœèŠ±å¤•æ‹¾ã€‘ï¼Œå¯è·å–é¦–å‘å†…å®¹ã€‚</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/299a48306e4748398e6510a8f45da9f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169978&amp;x-signature=n1lGbJmKHPt3r0CLl6B7aic%2FOfs%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">01 å¼•è¨€</h2>
<p>åœ¨ä¸šåŠ¡é¡¹ç›®ä¸­ç»å¸¸ä¼šçœ‹åˆ°<code>Javassist</code>çš„ä¾èµ–ï¼Œæ¡†æ¶å‡çº§<code>Javassist</code>ä¹Ÿå¾—è·Ÿç€å‡ï¼Œå¦åˆ™å¯åŠ¨ä¸èµ·æ¥ã€‚</p>
<p>å¾ˆå¤šå¾®æœåŠ¡æ¡†æ¶åº•å±‚å¿…ç„¶ä½¿ç”¨äº†åå°„æŠ€æœ¯ï¼Œè€Œä¸ºäº†æé«˜æ€§èƒ½ï¼Œå°±æ˜¯ä½¿ç”¨<code>Javassist</code>æé€Ÿçš„ã€‚ä½†æ˜¯è¿™ä¸ª<code>Javassist</code>åˆ°æ—¶æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ—¢ç„¶æ¯”åå°„çš„æ€§èƒ½å¥½ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥å¼ƒç”¨åå°„ï¼Œç›´æ¥ä½¿ç”¨<code>Javassist</code>å‘¢ï¼Ÿå¸¦ç€è¿™äº›ç–‘é—®ï¼Œç‰¹æ„å­¦ä¹ äº†ç›¸å…³æŠ€æœ¯ï¼Œå¦‚æœ‰é—®é¢˜è¿˜è¯·åŒ…æ¶µã€‚</p>
<h2 data-id="heading-1">02 åœºæ™¯</h2>
<p>æ¯”å¦‚ä½¿ç”¨<code>JDBC</code>æŸ¥å‡º<code>ResultSet</code>è¿™æ ·çš„ç»“æœé›†ï¼Œæˆ‘ä»¬éœ€è¦å°†ç»“æœå°è£…åˆ°ä¸€ä¸ª<code>JavaBean</code>ä¸­ï¼Œè€Œè¿™ä¸ª<code>JavaBean</code>åªæœ‰ç±»åï¼Œæˆ‘ä»¬å°†å¦‚ä½•å¤„ç†å‘¢ã€‚å› ä¸ºåªæœ‰ç±»åï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥å®ä¾‹åŒ–ï¼Œç¬¬ä¸€å°è±¡æƒ³åˆ°çš„å°±æ˜¯åå°„ã€‚</p>
<h3 data-id="heading-2">2.1 JavaBean</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserInfo</span> {

    <span class="hljs-keyword">private</span> Integer id;
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>{
		 System.out.println(<span class="hljs-string">"testæ–¹æ³•æ‰§è¡Œ....name="</span> + name);
    }
}
</code></pre>
<p>æˆ‘ä»¬å‡è®¾ä»æ•°æ®åº“å–å‡º<code>name</code>å€¼ï¼Œæœ€åè°ƒç”¨<code>test()</code>æ–¹æ³•ï¼Œå°†<code>name</code>æ‰“å°å‡ºæ¥ã€‚</p>
<h3 data-id="heading-3">2.2 åå°„æ¡ˆä¾‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Test</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">test01</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
    <span class="hljs-type">StopWatch</span> <span class="hljs-variable">stopWatch</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StopWatch</span>();
    stopWatch.start();
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {
        invokeTest(i, UserInfo.class);
    }

    stopWatch.stop();
    System.out.println(<span class="hljs-string">"è€—æ—¶ï¼š"</span> + stopWatch.getTotalTimeMillis() + <span class="hljs-string">"ms"</span>);
}
</code></pre>
<p>ä¸ºäº†å¯¹æ¯”åå°„å’Œæé€Ÿçš„æ•ˆæœï¼Œæˆ‘ä»¬å°†æ•°æ®é‡è®¾ä¸º<code>1000000</code>ã€‚</p>
<p>åå°„çš„æ–¹æ³•æ¯”è¾ƒç®€å•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">invokeTest</span><span class="hljs-params">(Integer index, Class&lt;?&gt; clazz)</span> <span class="hljs-keyword">throws</span> Exception {
    <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> clazz.getDeclaredConstructor().newInstance();

    <span class="hljs-type">Field</span> <span class="hljs-variable">field</span> <span class="hljs-operator">=</span> clazz.getDeclaredField(<span class="hljs-string">"name"</span>);
    field.setAccessible(<span class="hljs-literal">true</span>);
    field.set(o, <span class="hljs-string">"test"</span> + index);

    <span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> clazz.getMethod(<span class="hljs-string">"test"</span>);
    method.invoke(o);
}
</code></pre>
<p>ç›´æ¥å®ä¾‹åŒ–åï¼Œèµ‹å€¼æ‰“å°å³å¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e4832038f7384a6db13536ba63ee5030~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169978&amp;x-signature=aL%2FjaiGHIjjzj6nhIMB93JS%2BrRA%3D" alt="" loading="lazy"/></p>
<p>100Wçš„æ•°æ®è€—æ—¶ï¼š14s</p>
<h2 data-id="heading-4">03 JavassiståŠ é€Ÿ</h2>
<p><code>javassist</code>ä¾èµ–æœ‰å¾ˆå¤šï¼Œæ³¨æ„ç”„åˆ«ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ab132b7639546bc9ddeec145d942a90~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169978&amp;x-signature=DdyQgHZefmcVougYpNIKZbuVEpI%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä»¬é¡¹ç›®ä½¿ç”¨çš„æ˜¯ç¬¬ä¸€ä¸ªï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.javassist<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>javassist<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.30.2-GA<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>åå°„çš„æ€§èƒ½ä¸å¥½ï¼Œæ‰€ä»¥é€šè¿‡åå°„è°ƒç”¨æ–¹æ³•å°±ä¼šæ¯”è¾ƒè€—æ—¶ã€‚é‚£æˆ‘ä»¬å°±åˆ©ç”¨<code>javassist</code>çš„ç‰¹æ€§ï¼Œç›´æ¥é€šè¿‡<code>new</code>çš„æ–¹æ³•å®ä¾‹åŒ–åè°ƒç”¨æ–¹æ³•å°±ä¼šå˜å¿«äº†ã€‚</p>
<h3 data-id="heading-5">3.1 æ„å»ºä»£ç†ç±»</h3>
<p>æ„å»ºä»£ç†ç±»ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä»£ç†ç±»çš„çˆ¶ç±»ï¼Œç”¨æ¥æ¥æ”¶ä»£ç†ç±»ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BeanProxy</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">invoke</span><span class="hljs-params">(Integer index)</span>;
}
</code></pre>
<p>åˆ›å»ºå®é™…çš„ä»£ç†ç±»ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> BeanProxy <span class="hljs-title function_">getBeanProxy</span><span class="hljs-params">(Class&lt;?&gt; clazz)</span> <span class="hljs-keyword">throws</span> Exception {

    <span class="hljs-type">ClassPool</span> <span class="hljs-variable">pool</span> <span class="hljs-operator">=</span> ClassPool.getDefault();
    
    <span class="hljs-comment">// åˆ›å»ºä»£ç†ç±»</span>
    <span class="hljs-type">CtClass</span> <span class="hljs-variable">ccProxy</span> <span class="hljs-operator">=</span> pool.makeClass(clazz.getName() + <span class="hljs-string">"Proxy"</span>, pool.makeClass(BeanProxy.class.getName()));

    <span class="hljs-comment">// åˆ›å»ºé»˜è®¤æ„é€ å™¨</span>
    <span class="hljs-type">CtConstructor</span> <span class="hljs-variable">ctConstructor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CtConstructor</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CtClass</span>[<span class="hljs-number">0</span>], ccProxy);
    ctConstructor.setBody(<span class="hljs-string">"{}"</span>);
    ccProxy.addConstructor(ctConstructor);

    <span class="hljs-comment">// è°ƒç”¨ç›®æ ‡ç±»çš„æ–¹æ³•</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">methodStr</span> <span class="hljs-operator">=</span> <span class="hljs-string">"""
            public void invoke(Integer index){
                %s userInfo = new %s();
                userInfo.setName(\"%s\" + index);
                userInfo.test();
            }
            """</span>;
    methodStr = String.format(methodStr, clazz.getName(), clazz.getName(), <span class="hljs-string">"test"</span>);
    <span class="hljs-type">CtMethod</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> CtNewMethod.make(methodStr, ccProxy);
    <span class="hljs-comment">// æ·»åŠ ä»£ç†æ–¹æ³•</span>
    ccProxy.addMethod(method);

    <span class="hljs-comment">// è¿”å›ä»£ç†å¯¹è±¡                            </span>
    <span class="hljs-keyword">return</span> (BeanProxy)ccProxy.toClass().getDeclaredConstructor().newInstance();
}
</code></pre>
<h3 data-id="heading-6">3.2 é‡ç‚¹è¯´æ˜</h3>
<p>å®é™…çš„ä»£ç†ç±»åŠ¨æ€çŠ¶æ€åˆ†åˆ«åŒ…å«äº†ä¸¤éƒ¨åˆ†ï¼š</p>
<ul>
<li>æ„é€ å™¨ï¼šå¿…é¡»è¦æœ‰ï¼Œæ²¡æœ‰å°±ä¼šæŠ¥é”™</li>
<li>æ–¹æ³•ï¼šç›®æ ‡æ–¹æ³•</li>
</ul>
<p>åœ¨ç›®æ ‡æ–¹æ³•ä¸­ï¼Œä½¿ç”¨äº†<code>new</code>çš„æ–¹å¼ï¼Œæ¥æ„å»º<code>JavaBean</code>ï¼Œè¾ƒå°‘äº†åå°„å¸¦æ¥çš„æŸè€—ã€‚æœ€åé€šè¿‡åå°„è¿”å›ä»£ç†ç±»ï¼Œåç»­çš„è°ƒç”¨å°±æ˜¯æ­£å¸¸çš„<code>Java</code>è°ƒç”¨äº†ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯åå°„åªç”¨äº†ä¸€æ¬¡ã€‚</p>
<h3 data-id="heading-7">3.3 æ•ˆæœ</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1e8fc23840e4bef8830a65e4bbfefc4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169978&amp;x-signature=TBeZEvuaM5lAHjyIUoe2nx3ucRc%3D" alt="" loading="lazy"/></p>
<p><code>100W</code>çš„æ•°æ®ï¼Œå®ä¾‹åŒ–åªç”¨äº†<code>5s</code>å·¦å³ã€‚æé€Ÿåªæ˜¯<code>Javassist</code>çš„å†°å±±ä¸€è§’ï¼Œè¿˜å¯ä»¥å¯¹åŸæœ‰çš„ç±»å¢å¼ºã€‚</p>
<h2 data-id="heading-8">04 Javassist</h2>
<h3 data-id="heading-9">4.1 ç®€ä»‹</h3>
<p><code>Javassist</code>æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€ä¿®æ”¹Javaå­—èŠ‚ç çš„åº“ã€‚å®ƒå…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶ç”Ÿæˆã€ä¿®æ”¹æˆ–åˆ†æJavaç±»ï¼Œè€Œä¸éœ€è¦ç›´æ¥æ“ä½œå¤æ‚çš„å­—èŠ‚ç æŒ‡ä»¤ã€‚</p>
<p>Javassistçš„æ ¸å¿ƒç±»ï¼š</p>
<ul>
<li><code>ClassPool</code>ï¼šä¸€ä¸ªCtClasså¯¹è±¡çš„å®¹å™¨ï¼Œç”¨äºç®¡ç†ç±»ã€‚å¯ä»¥ä»ClassPoolä¸­è·å–CtClasså¯¹è±¡ã€‚</li>
<li><code>CtClass</code>ï¼šè¡¨ç¤ºä¸€ä¸ªç±»ï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥ä¿®æ”¹ç±»ã€‚</li>
<li><code>CtMethod</code>ï¼šè¡¨ç¤ºç±»ä¸­çš„æ–¹æ³•ï¼Œå¯ä»¥ä¿®æ”¹æ–¹æ³•ä½“ã€‚</li>
<li><code>CtField</code>ï¼šè¡¨ç¤ºç±»ä¸­çš„å­—æ®µã€‚</li>
<li><code>CtConstructor</code>ï¼šè¡¨ç¤ºæ„é€ å‡½æ•°ã€‚</li>
</ul>
<h3 data-id="heading-10">4.2 å­—èŠ‚ç å¢å¼º</h3>
<p>æ¡ˆä¾‹ä¸­çš„<code>UserInfo</code>æœ‰ä¸€ä¸ª<code>test</code>æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ–¹æ³•æ‰§è¡Œåˆ¸åï¼Œåˆ†åˆ«å¢å¼ºã€‚</p>
<pre><code class="hljs language-java" lang="java"> <span class="hljs-meta">@Test</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">test04</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
    <span class="hljs-type">ClassPool</span> <span class="hljs-variable">pool</span> <span class="hljs-operator">=</span> ClassPool.getDefault();
    <span class="hljs-type">CtClass</span> <span class="hljs-variable">cc</span> <span class="hljs-operator">=</span> pool.get(<span class="hljs-string">"com.simonking.boot.tx.pojo.UserInfo"</span>);
    <span class="hljs-type">CtMethod</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> cc.getDeclaredMethod(<span class="hljs-string">"test"</span>);

    m.insertBefore(<span class="hljs-string">"""
             { 
                System.out.println(\"Before test\");
             }
            """</span>);
    m.insertAfter(<span class="hljs-string">"""
             { 
                System.out.println(\"after test\");
             }
            """</span>);
    <span class="hljs-type">UserInfo</span> <span class="hljs-variable">u</span> <span class="hljs-operator">=</span> (UserInfo)cc.toClass().getDeclaredConstructor().newInstance();
    u.test();
}
}
</code></pre>
<p>æ‰§è¡Œæ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d233b6d3b4784ecd92e8d275d090ea92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169978&amp;x-signature=EH3rJqbPtZ3aGnJTbLLJkUxL97Y%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-11">4.3 çƒ­ä¿®å¤</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Test</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">test05</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
    <span class="hljs-type">ClassPool</span> <span class="hljs-variable">pool</span> <span class="hljs-operator">=</span> ClassPool.getDefault();
    <span class="hljs-type">CtClass</span> <span class="hljs-variable">cc</span> <span class="hljs-operator">=</span> pool.get(<span class="hljs-string">"com.simonking.boot.tx.pojo.UserInfo"</span>);
    <span class="hljs-type">CtMethod</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> cc.getDeclaredMethod(<span class="hljs-string">"test"</span>);
    m.setBody(<span class="hljs-string">"""
            {
                System.out.println(\"testæ–¹æ³•å¼‚å¸¸è¢«ä¿®å¤äº†....\");
            }
            """</span>);

    <span class="hljs-type">UserInfo</span> <span class="hljs-variable">u</span> <span class="hljs-operator">=</span> (UserInfo)cc.toClass().getDeclaredConstructor().newInstance();
    u.test();
}
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/28dd39136c5a498da4053174ad3ca3f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169978&amp;x-signature=CSss6%2BjXQLL%2B43P1Y%2BXImIBPVz0%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œç›´æ¥ä¿®æ”¹åŸæ¥çš„æ–¹æ³•ã€‚</p>
<h2 data-id="heading-12">05 å°ç»“</h2>
<p><code>Javassist</code>çš„é€‚ç”¨åœºæ™¯è¿œä¸æ­¢è¿™äº›ï¼Œåé¢å‘ç°æœ‰è¶£çš„åœºæ™¯ï¼Œå†ç»§ç»­åˆ†äº«ã€‚åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°æœ‰ä¸¤ä¸ªé—®é¢˜è®°å½•ä¸€ä¸‹ã€‚</p>
<h3 data-id="heading-13">5.1 é—®é¢˜1</h3>
<p><code>Javassist</code>é’ˆå¯¹å·²ç»å­˜åœ¨çš„å±æ€§èµ‹å€¼æ—¶ï¼Œå¦‚æœæ˜¯åŒ…è£…ç±»å¯èƒ½å­˜åœ¨å¼‚å¸¸ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5dad6713b8e14997854cada8e59126ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169978&amp;x-signature=bWnQZR2Wj3RcxnBETM21sUG4OWA%3D" alt="" loading="lazy"/></p>
<p>å› ä¸ºç±»çš„å±æ€§æ˜¯<code>Integer</code>ç±»å‹ï¼Œå¯¼è‡´æ— æ³•èµ‹å€¼ã€‚æ”¹ä¸ºåŸºç¡€æ•°æ®ç±»å‹åæ­£å¸¸äº†ã€‚</p>
<h3 data-id="heading-14">5.2 é—®é¢˜2</h3>
<p><code>Java17</code>ç¼–è¯‘çš„æ—¶å€™ï¼Œä¼šå‡ºç°é—®é¢˜ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d9e5a71e244432ca2de6db540eabb6b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770169978&amp;x-signature=yzjZh1Tlo3UuNrVtORAIL3vcMUo%3D" alt="" loading="lazy"/></p>
<p>å¯åŠ¨å‚æ•°å¢åŠ é…ç½®å¯ä»¥è§£å†³ï¼š</p>
<pre><code class="hljs language-sh" lang="sh">--add-opens java.base/java.lang=ALL-UNNAMED
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»Šæ—¥ï¼ŒDeepSeekå†æ¬¡â€œæ‹†æ‰é‡åšâ€ï¼Œå¼€æºæ¶æ„ç‚¸åœºï¼šOCR 2åªæ˜¯èµ·ç‚¹ï¼Œè¿™æ¬¡è¦é‡æ„AIçš„â€œçœ¼ç›â€å’Œâ€œå¤§è„‘â€ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7599899147418566708</link>    <guid>https://juejin.cn/post/7599899147418566708</guid>    <pubDate>2026-01-28T01:54:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599899147418566708" data-draft-id="7599910677579120640" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»Šæ—¥ï¼ŒDeepSeekå†æ¬¡â€œæ‹†æ‰é‡åšâ€ï¼Œå¼€æºæ¶æ„ç‚¸åœºï¼šOCR 2åªæ˜¯èµ·ç‚¹ï¼Œè¿™æ¬¡è¦é‡æ„AIçš„â€œçœ¼ç›â€å’Œâ€œå¤§è„‘â€ï¼Ÿ"/> <meta itemprop="keywords" content="ç®—æ³•,è®¡ç®—æœºè§†è§‰,æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2026-01-28T01:54:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CoovallyAIHub"/> <meta itemprop="url" content="https://juejin.cn/user/2461151071843739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»Šæ—¥ï¼ŒDeepSeekå†æ¬¡â€œæ‹†æ‰é‡åšâ€ï¼Œå¼€æºæ¶æ„ç‚¸åœºï¼šOCR 2åªæ˜¯èµ·ç‚¹ï¼Œè¿™æ¬¡è¦é‡æ„AIçš„â€œçœ¼ç›â€å’Œâ€œå¤§è„‘â€ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2461151071843739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CoovallyAIHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T01:54:39.000Z" title="Wed Jan 28 2026 01:54:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å°±åœ¨ä»Šå¹´åæœˆï¼ŒDeepSeekÂ æ”¾å‡ºå…¶å…¨æ–°çš„Â DeepSeek-OCRÂ æ¨¡å‹æ—¶ï¼Œä¸šå†…è¿˜åœ¨æ¶ˆåŒ–å®ƒåœ¨æ–‡æ¡£è§£æä¸Šå¸¦æ¥çš„éœ‡åŠ¨ã€‚æ²¡æƒ³åˆ°ï¼ŒçŸ­çŸ­æ—¶é—´ï¼Œä»–ä»¬åˆæŠ›å‡ºäº†ä¸€ç¯‡é‡ç£…è®ºæ–‡â€”â€”<strong>DeepSeek-OCR 2</strong>ã€‚è€Œè¿™æ¬¡ï¼Œå›¢é˜Ÿç›´æ¥å¯¹è§†è§‰ç¼–ç çš„â€œå¿ƒè„â€åŠ¨äº†æ‰‹æœ¯ã€‚</p>
<h2 data-id="heading-0"><strong>è§†è§‰ç¼–ç ï¼Œå›°åœ¨â€œå›ºå®šæ‰«æâ€é‡Œå¤ªä¹…äº†</strong></h2>
<p>ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰æƒ³è¿‡ï¼ŒAI çœ‹ä¸€å¼ å›¾ï¼Œå’Œæˆ‘ä»¬çš„â€œçœ‹â€ç©¶ç«Ÿå·®åœ¨å“ªï¼Ÿç°æœ‰çš„è§†è§‰è¯­è¨€æ¨¡å‹ï¼Œå¤§å¤šéµå¾ªä¸€ç§è¿‘ä¹åˆ»æ¿çš„æµç¨‹ï¼šæŠŠå›¾åƒåˆ‡å‰²æˆå°å—ï¼Œç„¶åå¼ºåˆ¶æŒ‰â€œä»å·¦åˆ°å³ã€ä»ä¸Šåˆ°ä¸‹â€çš„ç½‘æ ¼é¡ºåºæ’åˆ—ï¼Œæ‰“ä¸Šå›ºå®šçš„ä½ç½®ç¼–ç ï¼Œå†å¡ç»™è¯­è¨€æ¨¡å‹å»ç†è§£ã€‚</p>
<p>è¿™åƒä¸åƒåœ¨è¦æ±‚ä¸€ä¸ªäººè¯»ä¹¦æ—¶ï¼Œçœ¼ç›å¿…é¡»æœºæ¢°åœ°é€è¡Œæ‰«æï¼Œä¸å‡†è·³æ ‡é¢˜ã€ä¸å‡†ç¥å›¾è¡¨ã€ä¸å‡†å›å¤´çœ‹æ³¨é‡Šï¼Ÿå¯æˆ‘ä»¬çœŸå®çš„é˜…è¯»ï¼Œè§†çº¿æ˜æ˜æ˜¯è·Ÿç€è¯­ä¹‰èµ°çš„â€”â€”å…ˆè¢«é†’ç›®çš„æ ‡é¢˜å¸å¼•ï¼Œå†é¡ºç€å›¾è¡¨è¶‹åŠ¿æ‰¾åˆ°å…³é”®æ•°æ®ï¼Œæœ€åæ‰å¯èƒ½æ‰«ä¸€çœ¼è¾¹è§’çš„æ³¨é‡Šè¯´æ˜ã€‚è¿™ç§çµæ´»ã€æœ‰é€»è¾‘çš„ <strong>â€œè§†è§‰å› æœæµâ€</strong> ï¼Œæ°æ°æ˜¯è¿‡å»æ¨¡å‹ç¼ºå¤±çš„ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e93a437780134ede8df71a4776367de8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170079&amp;x-signature=1w8BNsAidfROLfK1R9csrXpyHmo%3D" alt="screenshot_2026-01-27_16-10-45.png" loading="lazy"/></p>
<p>DeepSeek-OCR 2 çš„ç ´å±€ç‚¹ï¼Œåœ¨å›¾1é‡Œæ˜¾å¾—é¢‡ä¸ºç›´è§‚ï¼šä»–ä»¬å¹²è„†<strong>æ‰”æ‰äº†ä¼ ç»Ÿçš„ CLIP è§†è§‰ç¼–ç å™¨</strong>ï¼Œè½¬è€Œé‡‡ç”¨äº†ä¸€ç§<strong>ç±»ä¼¼å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„æ¶æ„</strong>ã€‚å…³é”®åœ¨äºé‚£ä¸ª<strong>å®šåˆ¶çš„æ³¨æ„åŠ›æ©ç </strong>ï¼Œå®ƒè®©è§†è§‰ç¼–ç è¿‡ç¨‹çªç„¶â€œæ´»â€äº†è¿‡æ¥ï¼Œæœ‰äº†åŠ¨æ€æ¨ç†çš„å¯èƒ½ã€‚</p>
<h2 data-id="heading-1"><strong>è®©ç¼–ç å™¨å­¦ä¼šâ€œæœ‰é€»è¾‘åœ°çœ‹â€</strong></h2>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1dc8955ded64422094f4fd49a1a05d04~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170079&amp;x-signature=Wc0YNo00P%2BTMcTn8y8haq06nl4I%3D" alt="screenshot_2026-01-27_16-12-51.png" loading="lazy"/></p>
<p>å›¢é˜Ÿå°†è¿™ä¸ªæ–°æ ¸å¿ƒç§°ä¸º DeepEncoder V2ã€‚å®ƒçš„è®¾è®¡ç›®æ ‡å¾ˆæ˜ç¡®ï¼š<strong>æŠŠè§†è§‰ç¼–ç ä»â€œå›ºå®šæ‰«æâ€å˜æˆâ€œè¯­ä¹‰æ¨ç†â€ã€‚</strong> æ€ä¹ˆåšåˆ°çš„ï¼Ÿé çš„æ˜¯å‡ ä¸ªç¯ç¯ç›¸æ‰£çš„å·§æ€ã€‚</p>
<p>é¦–å…ˆï¼Œ<strong>ç”¨ç´§å‡‘çš„ LLM é£æ ¼æ¶æ„æ›¿æ¢ CLIP</strong>ï¼Œç­‰äºæ˜¯ä¸ºè§†è§‰æ¨¡å—æ³¨å…¥äº†è¯­è¨€æ¨¡å‹æ“…é•¿çš„å› æœæ¨ç†èƒ½åŠ›ã€‚æ¥ç€ï¼Œä»–ä»¬è®¾è®¡äº†ä¸€å¥—<strong>æ··åˆæ³¨æ„åŠ›æœºåˆ¶</strong>ï¼šè§†è§‰æ ‡è®°æœ¬èº«ä¿ç•™åŒå‘æ³¨æ„åŠ›ï¼Œä»¥ç»´æŒå¯¹å›¾åƒå…¨å±€çš„æ„ŸçŸ¥ï¼›åŒæ—¶ï¼Œå¼•å…¥ä¸€ç»„å…¨æ–°çš„ <strong>â€œå› æœæµæŸ¥è¯¢æ ‡è®°â€</strong> ï¼Œè¿™äº›æ ‡è®°ä¹‹é—´é‡‡ç”¨<strong>ä¸¥æ ¼çš„å› æœæ³¨æ„åŠ›</strong>ã€‚è¿™å°±å¥½æ¯”ä¸€è¾¹æ„ŸçŸ¥æ•´å¹…ç”»é¢çš„å­˜åœ¨ï¼Œä¸€è¾¹è®©ä¸€æ¡ç‹¬ç«‹çš„â€œæ€ç»´çº¿â€æŒ‰ç…§é€»è¾‘é¡ºåºæ¢³ç†é‡ç‚¹ã€‚</p>
<p>æ›´å·§å¦™çš„æ˜¯ï¼Œè§†è§‰æ ‡è®°ä¸å› æœæŸ¥è¯¢æ ‡è®°ä¸€ä¸€å¯¹åº”ï¼Œè¿™ä¸ºæ¨¡æ‹Ÿäººç±»çš„ <strong>â€œè§†è§‰å›è§†â€</strong> â€”â€”å³å›å¤´çœ‹æŸä¸ªé‡ç‚¹åŒºåŸŸâ€”â€”ç•™è¶³äº†ç©ºé—´ã€‚æœ€ç»ˆï¼Œ<strong>åªæœ‰é‚£äº›ç»è¿‡è¯­ä¹‰é‡æ’åºçš„â€œå› æœæŸ¥è¯¢æ ‡è®°â€ä¼šè¢«ä¼ é€’ç»™åé¢çš„ LLM è§£ç å™¨</strong>ã€‚æ¢è¨€ä¹‹ï¼Œæ¨¡å‹åç»­ç†è§£çš„ï¼Œå·²ç»æ˜¯ä¸€ä¸ªæŒ‰æ„ä¹‰é‡æ–°æ’åˆ—è¿‡çš„è§†è§‰æ•…äº‹äº†ã€‚</p>
<p>è¿™ä¸€è®¾è®¡çµæ„Ÿå¹¶éå‡­ç©ºè€Œæ¥ã€‚å›¾2å±•ç¤ºäº†ç›¸å…³å·¥ä½œä¸­çš„ä¸¤ç§â€œå¹¶è¡ŒåŒ–æŸ¥è¯¢â€èŒƒå¼ï¼Œå®ƒä»¬å¯å‘äº†DeepSeekå›¢é˜Ÿã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e036498f2e5240c188996460c08ebaf3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170079&amp;x-signature=52ahcdS24kzvmTokN9Z1xEfOZ9c%3D" alt="screenshot_2026-01-27_16-37-54.png" loading="lazy"/></p>
<h2 data-id="heading-2"><strong>ä¸¤çº§æ¨ç†ï¼Œæ‹†è§£äºŒç»´ç†è§£çš„éš¾é¢˜</strong></h2>
<p>å¦‚æœä½ ç»†çœ‹ï¼Œä¼šå‘ç° DeepSeek-OCR 2 å®é™…ä¸Šæ„å»ºäº†ä¸€ä¸ª<strong>ä¸¤çº§å› æœæ¨ç†çš„ç®¡é“</strong>ã€‚ç¬¬ä¸€çº§åœ¨ç¼–ç å™¨å†…éƒ¨ï¼Œé€šè¿‡å¯å­¦ä¹ çš„æŸ¥è¯¢æ ‡è®°å¯¹è§†è§‰ä¿¡æ¯è¿›è¡Œåˆæ¬¡é‡æ’åºï¼›ç¬¬äºŒçº§åˆ™åœ¨ LLM è§£ç å™¨ä¸­ï¼Œå¯¹è¿™ä¸ªæ’å¥½åºçš„åºåˆ—è¿›è¡Œè‡ªå›å½’çš„æ·±åº¦æ¨ç†ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/157ea9b2ae2548cf876f07df1db29461~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170079&amp;x-signature=8ewW12ipcQX5Cy7FgNeh14YVGps%3D" alt="screenshot_2026-01-27_16-19-57.png" loading="lazy"/></p>
<p>è¿™æ‹›å…¶å®å¾ˆèªæ˜ã€‚ç›´æ¥å°†äºŒç»´ç©ºé—´å…³ç³»å»ºæ¨¡é€å½»éå¸¸å›°éš¾ï¼Œä½†ä»–ä»¬æŠŠé—®é¢˜åˆ†è§£äº†ï¼š<strong>å…ˆé€šè¿‡ä¸€çº§æ¨ç†å°†äºŒç»´å¸ƒå±€è½¬åŒ–ä¸ºä¸€ä¸ªåˆä¹è¯­ä¹‰çš„ä¸€ç»´åºåˆ—ï¼Œå†äº¤ç»™è¯­è¨€æ¨¡å‹åšå®ƒæœ€æ“…é•¿çš„åºåˆ—æ¨ç†ã€‚</strong> è¿™æˆ–è®¸ç®—ä¸ä¸Šç»ˆæç­”æ¡ˆï¼Œä½†æ— ç–‘æ˜¯é€šå‘çœŸæ­£äºŒç»´è§†è§‰ç†è§£çš„ä¸€æ¡åˆ‡å®ã€æ–°é¢–çš„è·¯å¾„ã€‚</p>
<h2 data-id="heading-3"><strong>æ•ˆæœå¦‚ä½•ï¼Ÿæ•°æ®è‡ªå·±ä¼šè¯´è¯</strong></h2>
<p>åœ¨æƒå¨çš„æ–‡æ¡£è§£æåŸºå‡† OmniDocBench v1.5 ä¸Šï¼ŒDeepSeek-OCR 2 äº¤å‡ºçš„æˆç»©å•ç›¸å½“äº®çœ¼ï¼š<strong>æ•´ä½“æ€§èƒ½ 91.09%ï¼Œæ¯”å‰ä»£æå‡äº† 3.73 ä¸ªç™¾åˆ†ç‚¹ã€‚</strong> æ›´å€¼å¾—ç©å‘³çš„æ˜¯ï¼Œå®ƒè¾¾æˆè¿™ä¸ªæ•ˆæœæ‰€ç”¨çš„<strong>è§†è§‰æ ‡è®°ä¸Šé™ä»…æœ‰ 1120 ä¸ª</strong>ï¼Œæ˜¯åŒç±»æ¨¡å‹é‡Œæœ€â€œèŠ‚ä¿­â€çš„ã€‚</p>
<p>è¡¡é‡è¯­ä¹‰æ’åºèƒ½åŠ›çš„ <strong>â€œé˜…è¯»é¡ºåºç¼–è¾‘è·ç¦»â€æŒ‡æ ‡ï¼Œä» 0.085 æ˜¾è‘—é™åˆ°äº† 0.057</strong>ã€‚è¿™è¯´æ˜ï¼Œæ¨¡å‹è¾“å‡ºçš„æ–‡æœ¬é¡ºåºï¼Œç¡®å®æ›´è´´è¿‘äººç±»ç†è§£çš„é€»è¾‘äº†ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™ç§è¿›æ­¥ç›´æ¥ä½“ç°ä¸ºé‡å¤ç‡çš„ä¸‹é™â€”â€”<strong>å¤„ç†åœ¨çº¿ç”¨æˆ·æ—¥å¿—å›¾åƒæ—¶ï¼Œé‡å¤ç‡ä» 6.25% é™åˆ°äº† 4.17%ï¼›å¤„ç† PDF æ•°æ®æ—¶ï¼Œä¹Ÿä» 3.69% é™è‡³ 2.88%</strong> ã€‚çœ‹æ¥ï¼Œé€»è¾‘ç†è§£èƒ½åŠ›å¼ºäº†ï¼Œé‚£ç§æœºæ¢°é‡å¤çš„åºŸè¯è‡ªç„¶å°±å°‘äº†ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/26ef66e385324e2fbc6439e0b0bbc6e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170079&amp;x-signature=vECQaoBICOPKy%2Beq81SEy3zs5fw%3D" alt="screenshot_2026-01-27_16-13-19.png" loading="lazy"/></p>
<h2 data-id="heading-4"><strong>ä¸æ­¢äºæ–‡æ¡£ï¼šä¸€ä¸ªç»Ÿä¸€ç¼–ç å™¨çš„é‡æœ›</strong></h2>
<p>åœ¨æˆ‘çœ‹æ¥ï¼ŒDeepEncoder V2 çš„æ½œåŠ›ææ€•ä¸æ­¢äºè§£è¯»æ–‡æ¡£ã€‚è®ºæ–‡é‡Œå·²ç»éšçº¦æŒ‡å‡ºäº†æ›´å¤§çš„å›¾æ™¯ï¼š<strong>å®ƒæœ‰æœ›æ¼”å˜æˆä¸€ä¸ªç»Ÿä¸€çš„å…¨æ¨¡æ€ç¼–ç å™¨ã€‚</strong></p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼ŒåŒä¸€ä¸ªç¼–ç å™¨éª¨å¹²ï¼Œé€šè¿‡å…±äº«çš„æ³¨æ„åŠ›æœºåˆ¶å’Œå‰é¦ˆç½‘ç»œï¼Œé…åˆä¸Šé’ˆå¯¹ä¸åŒæ¨¡æ€ï¼ˆæ–‡æœ¬ã€è¯­éŸ³ã€å›¾åƒã€è§†é¢‘ï¼‰è®­ç»ƒçš„å¯å­¦ä¹ æŸ¥è¯¢åµŒå…¥ï¼Œå°±èƒ½å¤„ç†å„å¼å„æ ·çš„ä¿¡æ¯ã€‚è¿™ä¸ºæ„å»º <strong>â€œä¸€ä¸ªæ¨¡å‹ï¼Œé€šåƒæ‰€æœ‰æ¨¡æ€â€çš„åŸºç¡€æ¨¡å‹</strong>ï¼Œæä¾›äº†ä¸€ç§æ–°é²œçš„æ¶æ„æ€è·¯ã€‚å¤šæ¨¡æ€èåˆæˆ–è®¸ä¸å¿…å†é‚£ä¹ˆâ€œæ‹¼å‡‘â€ï¼Œè€Œæ˜¯åœ¨åº•å±‚å°±èƒ½å®ç°æ›´ç»Ÿä¸€çš„è¯­ä¹‰ç†è§£ã€‚</p>
<h2 data-id="heading-5"><strong>è¿™ä¼šä¸ºæœºå™¨äººè£…ä¸Šâ€œä¼šæ€è€ƒçš„çœ¼ç›â€å—ï¼Ÿ</strong></h2>
<p>DeepSeek-OCR 2 æ‰€å¼ºè°ƒçš„ <strong>â€œè§†è§‰å› æœæµâ€</strong> ï¼Œæœ¬è´¨ä¸Šæ˜¯åœ¨æ¨¡ä»¿äººç±»è§†è§‰æ„ŸçŸ¥ä¸­çš„å› æœæœºåˆ¶ã€‚è¿™ä¸ªæ–¹å‘ä¸€æ—¦èµ°é€šï¼Œæˆ–è®¸ä¼šæ‚„ç„¶æ”¹å˜å¦ä¸€ä¸ªé¢†åŸŸâ€”â€”å…·èº«æ™ºèƒ½ï¼Œä¹Ÿå°±æ˜¯æœºå™¨äººã€‚</p>
<p>ç°åœ¨çš„æœºå™¨äººè§†è§‰ï¼Œå¤šæ•°è¿˜æ˜¯â€œæ‰«æ-è¯†åˆ«â€çš„è¢«åŠ¨æ¨¡å¼ï¼Œç¼ºå°‘å¯¹åœºæ™¯çš„å› æœæ¨æ–­å’ŒåŸºäºè¯­ä¹‰çš„æ³¨æ„åŠ›åˆ†é…ã€‚å¦‚æœèƒ½æŠŠ DeepEncoder V2 è¿™ç§å› æœæ¨ç†èƒ½åŠ›åµŒå…¥æœºå™¨äººçš„è§†è§‰ç³»ç»Ÿï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>
<p>ç¯å¢ƒç†è§£å¯èƒ½ä»é™æ€çš„â€œæ˜¯ä»€ä¹ˆâ€è½¬å‘åŠ¨æ€çš„â€œä¸ºä»€ä¹ˆå’Œæ¥ä¸‹æ¥æ€æ ·â€ï¼›æœºå™¨äººçš„â€œè§†çº¿â€èƒ½å¤Ÿåƒäººä¸€æ ·ï¼Œæ ¹æ®ä»»åŠ¡é€»è¾‘ä¸»åŠ¨èšç„¦å…³é”®åŒºåŸŸï¼Œè€Œä¸æ˜¯å¹³å‡ç”¨åŠ›åœ°æ‰«æå…¨åœºï¼›è§†è§‰ä¿¡æ¯ä¸è¯­è¨€æŒ‡ä»¤ã€åŠ¨ä½œè§„åˆ’ï¼Œä¹Ÿæœ‰æœ›åœ¨åŒä¸€ä¸ªå› æœæ¨ç†æ¡†æ¶ä¸‹æ— ç¼åè°ƒã€‚åˆ°é‚£æ—¶ï¼Œ<strong>æœºå™¨äººçš„â€œçœ¼ç›â€æˆ–è®¸å°±ä¸å†åªæ˜¯ä¼ æ„Ÿå™¨ï¼Œè€Œæ˜¯ä¸€ä¸ªåˆå…·æ¨ç†èƒ½åŠ›çš„â€œæ„ŸçŸ¥å™¨å®˜â€äº†ã€‚</strong></p>
<p><strong>ä¸€äº›è€äººå¯»å‘³çš„ç»†èŠ‚</strong></p>
<p>æŠ€æœ¯è®ºæ–‡é‡Œæ€»è—ç€ä¸€äº›ä½“ç°å·¥ç¨‹æ™ºæ…§çš„ç»†èŠ‚ã€‚æ¯”å¦‚ï¼ŒDeepSeek-OCR 2Â é‡‡ç”¨äº†<strong>å¤šè£å‰ªç­–ç•¥</strong>ï¼šç”¨Â 1024Ã—1024Â çš„åˆ†è¾¨ç‡å¤„ç†å…¨å±€è§†å›¾ï¼Œå¯¹åº” 256 ä¸ªæŸ¥è¯¢åµŒå…¥ï¼›ç”¨Â 768Ã—768Â çš„åˆ†è¾¨ç‡åˆ†æå±€éƒ¨ç»†èŠ‚ï¼Œå…±äº« 144 ä¸ªæŸ¥è¯¢åµŒå…¥ã€‚è¿™æ˜¾ç„¶æ˜¯åœ¨è®¡ç®—æ•ˆç‡å’Œç»†ç²’åº¦æ„ŸçŸ¥ä¹‹é—´åšçš„ç²¾æ˜æƒè¡¡ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a27247236c384609822dfa4626a033ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770170079&amp;x-signature=VKgKjBZFGbBvHZxQTnNqC7B14ik%3D" alt="screenshot_2026-01-27_16-13-38.png" loading="lazy"/></p>
<p>ä½œè€…ä»¬ä¹Ÿå¦è¯šï¼Œè‹¥è¦å®Œå…¨å®ç°äººç±»é‚£ç§å¤šæ¬¡å¤æŸ¥ã€å¤šè·³å¼çš„é‡æ’åºèƒ½åŠ›ï¼Œå¯èƒ½éœ€è¦æ¯”åŸå§‹è§†è§‰æ ‡è®°é•¿å¾—å¤šçš„å› æœæµæ ‡è®°åºåˆ—ã€‚è¿™æ— ç–‘æ„å‘³ç€ï¼Œç›®å‰çš„æ¶æ„ä¾ç„¶<strong>ç•™ç™½äº†å·¨å¤§çš„ä¼˜åŒ–ä¸æ¢ç´¢ç©ºé—´ã€‚</strong></p>
<h2 data-id="heading-6"><strong>ç»“è¯­</strong></h2>
<p>ä»æœºæ¢°çš„å›ºå®šæ‰«æï¼Œåˆ°çµæ´»çš„è¯­ä¹‰æ¨ç†ï¼ŒDeepSeek-OCR 2Â å¸¦æ¥çš„ä¸ä»…ä»…æ˜¯å‡ ä¸ªç™¾åˆ†ç‚¹çš„æ€§èƒ½æå‡ã€‚å®ƒæ›´åƒæ˜¯ä¸€æ¬¡è§†è§‰ç¼–ç èŒƒå¼ä¸Šçš„â€œæ¾åŠ¨â€ã€‚å½“ AI å¼€å§‹å°è¯•â€œæœ‰é€»è¾‘åœ°çœ‹â€ä¸–ç•Œæ—¶ï¼Œæˆ‘ä»¬è·ç¦»é‚£ç§çœŸæ­£ç†è§£çœ¼å‰ä¸€åˆ‡çš„è§†è§‰æ™ºèƒ½ï¼Œä¼¼ä¹åˆè¿‘äº†ä¸€å°æ­¥â€”â€”è€Œè¿™ä¸€å°æ­¥ï¼Œå¾€å¾€ä¹Ÿæ˜¯æœ€éš¾çš„é‚£ä¸€æ­¥ã€‚</p>
<blockquote>
<p><strong>é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdeepseek-ai%2FDeepSeek-OCR-2" target="_blank" title="https://github.com/deepseek-ai/DeepSeek-OCR-2" ref="nofollow noopener noreferrer">github.com/deepseek-aiâ€¦</a></strong></p>
<p><strong>è®ºæ–‡åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdeepseek-ai%2FDeepSeek-OCR-2%2Fblob%2Fmain%2FDeepSeek_OCR2_paper.pdf" target="_blank" title="https://github.com/deepseek-ai/DeepSeek-OCR-2/blob/main/DeepSeek_OCR2_paper.pdf" ref="nofollow noopener noreferrer">github.com/deepseek-aiâ€¦</a></strong></p>
<p><strong>æ¨¡å‹åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co%2Fdeepseek-ai%2FDeepSeek-OCR-2" target="_blank" title="https://huggingface.co/deepseek-ai/DeepSeek-OCR-2" ref="nofollow noopener noreferrer">huggingface.co/deepseek-aiâ€¦</a></strong></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Unity3Dä¸­æå‡AssetBundleåŠ è½½é€Ÿåº¦çš„è¯¦ç»†æŒ‡å—]]></title>    <link>https://juejin.cn/post/7599917711793618954</link>    <guid>https://juejin.cn/post/7599917711793618954</guid>    <pubDate>2026-01-28T01:57:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599917711793618954" data-draft-id="7599920572841181193" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Unity3Dä¸­æå‡AssetBundleåŠ è½½é€Ÿåº¦çš„è¯¦ç»†æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-28T01:57:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Thomasæ¸¸æˆå¼€å‘"/> <meta itemprop="url" content="https://juejin.cn/user/3758599706256028"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Unity3Dä¸­æå‡AssetBundleåŠ è½½é€Ÿåº¦çš„è¯¦ç»†æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3758599706256028/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Thomasæ¸¸æˆå¼€å‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T01:57:58.000Z" title="Wed Jan 28 2026 01:57:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<h2 data-id="heading-1">ä¸€ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269581835%26content_type%3DArticle%26match_order%3D1%26q%3DAssetBundle%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269581835&amp;content_type=Article&amp;match_order=1&amp;q=AssetBundle&amp;zhida_source=entity" ref="nofollow noopener noreferrer">AssetBundle</a>ä¼˜åŒ–ç­–ç•¥æ¦‚è§ˆ</h2>
<h3 data-id="heading-2">1.Â <strong>æ‰“åŒ…é˜¶æ®µä¼˜åŒ–</strong></h3>
<pre><code class="hljs language-ini" lang="ini">// 1. ä½¿ç”¨åˆé€‚çš„å‹ç¼©æ–¹å¼
// LZ4å‹ç¼© - åŠ è½½é€Ÿåº¦å¿«ï¼Œæ”¯æŒéšæœºè®¿é—®
BuildAssetBundleOptions <span class="hljs-attr">options</span> = BuildAssetBundleOptions.ChunkBasedCompression<span class="hljs-comment">;</span>

// LZMA - å‹ç¼©ç‡é«˜ï¼Œä½†åŠ è½½æ—¶éœ€è¦å®Œæ•´è§£å‹
BuildAssetBundleOptions <span class="hljs-attr">options</span> = BuildAssetBundleOptions.None<span class="hljs-comment">;</span>

// ä¸å‹ç¼© - åŠ è½½æœ€å¿«ï¼Œä½†åŒ…ä½“ç§¯æœ€å¤§
BuildAssetBundleOptions <span class="hljs-attr">options</span> = BuildAssetBundleOptions.UncompressedAssetBundle<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-3">2.Â <strong>èµ„æºåˆ†ç±»æ‰“åŒ…ç­–ç•¥</strong></h3>
<ul>
<li><strong>æŒ‰åœºæ™¯æ‰“åŒ…</strong>ï¼šæ¯ä¸ªåœºæ™¯ç‹¬ç«‹æ‰“åŒ…</li>
<li><strong>æŒ‰åŠŸèƒ½æ¨¡å—æ‰“åŒ…</strong>ï¼šUIã€è§’è‰²ã€ç‰¹æ•ˆç­‰åˆ†å¼€</li>
<li><strong>æŒ‰ä½¿ç”¨é¢‘ç‡æ‰“åŒ…</strong>ï¼šå¸¸ç”¨èµ„æºå•ç‹¬æ‰“åŒ…</li>
<li><strong>æŒ‰æ›´æ–°é¢‘ç‡æ‰“åŒ…</strong>ï¼šç»å¸¸æ›´æ–°çš„èµ„æºç‹¬ç«‹æ‰“åŒ…</li>
</ul>
<h2 data-id="heading-4">äºŒã€åŠ è½½æµç¨‹ä¼˜åŒ–</h2>
<h3 data-id="heading-5">1.Â <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269581835%26content_type%3DArticle%26match_order%3D1%26q%3D%25E5%25BC%2582%25E6%25AD%25A5%25E5%258A%25A0%25E8%25BD%25BD%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269581835&amp;content_type=Article&amp;match_order=1&amp;q=%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD&amp;zhida_source=entity" ref="nofollow noopener noreferrer">å¼‚æ­¥åŠ è½½</a>ä»£æ›¿åŒæ­¥åŠ è½½</strong></h3>
<pre><code class="hljs language-ini" lang="ini">// å¼‚æ­¥åŠ è½½AssetBundle
IEnumerator LoadAssetBundleAsync(string path)
{
    var <span class="hljs-attr">bundleLoadRequest</span> = AssetBundle.LoadFromFileAsync(path)<span class="hljs-comment">;</span>
    yield return bundleLoadRequest<span class="hljs-comment">;</span>
    
    AssetBundle <span class="hljs-attr">bundle</span> = bundleLoadRequest.assetBundle<span class="hljs-comment">;</span>
    
    // å¼‚æ­¥åŠ è½½èµ„æº
    var <span class="hljs-attr">assetLoadRequest</span> = bundle.LoadAssetAsync&lt;GameObject&gt;(<span class="hljs-string">"PrefabName"</span>)<span class="hljs-comment">;</span>
    yield return assetLoadRequest<span class="hljs-comment">;</span>
    
    GameObject <span class="hljs-attr">prefab</span> = assetLoadRequest.asset as GameObject<span class="hljs-comment">;</span>
    Instantiate(prefab)<span class="hljs-comment">;</span>
}
</code></pre>
<p><strong>2. é¢„åŠ è½½ç­–ç•¥</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AssetBundlePreloader</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-keyword">private</span> Dictionary&lt;<span class="hljs-built_in">string</span>, AssetBundle&gt; loadedBundles = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-built_in">string</span>, AssetBundle&gt;();
    
    <span class="hljs-comment">// é¢„åŠ è½½å¸¸ç”¨AssetBundle</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> IEnumerator <span class="hljs-title">PreloadBundles</span>(<span class="hljs-params">List&lt;<span class="hljs-built_in">string</span>&gt; bundlePaths</span>)</span>
    {
        <span class="hljs-keyword">foreach</span>(<span class="hljs-keyword">var</span> path <span class="hljs-keyword">in</span> bundlePaths)
        {
            <span class="hljs-function"><span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-title">LoadAndCacheBundle</span>(<span class="hljs-params">path</span>)</span>;
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> IEnumerator <span class="hljs-title">LoadAndCacheBundle</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>
    {
        <span class="hljs-keyword">if</span>(loadedBundles.ContainsKey(path)) <span class="hljs-keyword">yield</span> <span class="hljs-keyword">break</span>;
        
        <span class="hljs-keyword">var</span> request = AssetBundle.LoadFromFileAsync(path);
        <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> request;
        
        loadedBundles[path] = request.assetBundle;
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> AssetBundle <span class="hljs-title">GetCachedBundle</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>
    {
        <span class="hljs-keyword">return</span> loadedBundles.ContainsKey(path) ? loadedBundles[path] : <span class="hljs-literal">null</span>;
    }
}
</code></pre>
<h2 data-id="heading-6">ä¸‰ã€å†…å­˜ä¸ç¼“å­˜ä¼˜åŒ–</h2>
<h3 data-id="heading-7">1.Â <strong>ä½¿ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269581835%26content_type%3DArticle%26match_order%3D1%26q%3DUnityWebRequest%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269581835&amp;content_type=Article&amp;match_order=1&amp;q=UnityWebRequest&amp;zhida_source=entity" ref="nofollow noopener noreferrer">UnityWebRequest</a>Â AssetBundleç¼“å­˜</strong></h3>
<pre><code class="hljs language-ini" lang="ini">IEnumerator LoadWithCache(string url)
{
    using (UnityWebRequest <span class="hljs-attr">request</span> = UnityWebRequestAssetBundle.GetAssetBundle(url))
    {
        // å¯ç”¨ç¼“å­˜ç‰ˆæœ¬æ§åˆ¶
        <span class="hljs-attr">request.downloadHandler</span> = new DownloadHandlerAssetBundle(url, <span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
        
        yield return request.SendWebRequest()<span class="hljs-comment">;</span>
        
        if (<span class="hljs-attr">request.result</span> == UnityWebRequest.Result.Success)
        {
            AssetBundle <span class="hljs-attr">bundle</span> = DownloadHandlerAssetBundle.GetContent(request)<span class="hljs-comment">;</span>
            // ä½¿ç”¨bundle...
        }
    }
}
</code></pre>
<p><strong>2. æ™ºèƒ½ç¼“å­˜ç®¡ç†</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SmartAssetBundleCache</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CacheEntry</span>
    {
        <span class="hljs-keyword">public</span> AssetBundle bundle;
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">float</span> lastUsedTime;
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> referenceCount;
    }
    
    <span class="hljs-keyword">private</span> Dictionary&lt;<span class="hljs-built_in">string</span>, CacheEntry&gt; cache = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-built_in">string</span>, CacheEntry&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">float</span> maxCacheTime = <span class="hljs-number">300f</span>; <span class="hljs-comment">// 5åˆ†é’Ÿ</span>
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> AssetBundle <span class="hljs-title">GetOrLoad</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path</span>)</span>
    {
        <span class="hljs-comment">// æ¸…ç†è¿‡æœŸç¼“å­˜</span>
        CleanupExpiredCache();
        
        <span class="hljs-keyword">if</span> (cache.TryGetValue(path, <span class="hljs-keyword">out</span> CacheEntry entry))
        {
            entry.lastUsedTime = Time.time;
            entry.referenceCount++;
            <span class="hljs-keyword">return</span> entry.bundle;
        }
        
        <span class="hljs-comment">// åŠ è½½æ–°Bundle</span>
        AssetBundle bundle = AssetBundle.LoadFromFile(path);
        cache[path] = <span class="hljs-keyword">new</span> CacheEntry
        {
            bundle = bundle,
            lastUsedTime = Time.time,
            referenceCount = <span class="hljs-number">1</span>
        };
        
        <span class="hljs-keyword">return</span> bundle;
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">CleanupExpiredCache</span>()</span>
    {
        List&lt;<span class="hljs-built_in">string</span>&gt; toRemove = <span class="hljs-keyword">new</span> List&lt;<span class="hljs-built_in">string</span>&gt;();
        
        <span class="hljs-keyword">foreach</span>(<span class="hljs-keyword">var</span> kvp <span class="hljs-keyword">in</span> cache)
        {
            <span class="hljs-keyword">if</span> (kvp.Value.referenceCount == <span class="hljs-number">0</span> &amp;&amp; 
                Time.time - kvp.Value.lastUsedTime &gt; maxCacheTime)
            {
                kvp.Value.bundle.Unload(<span class="hljs-literal">false</span>);
                toRemove.Add(kvp.Key);
            }
        }
        
        <span class="hljs-keyword">foreach</span>(<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> toRemove) cache.Remove(key);
    }
}
</code></pre>
<h2 data-id="heading-8">å››ã€ä¾èµ–å…³ç³»ä¼˜åŒ–</h2>
<h3 data-id="heading-9">1.Â <strong>å…±äº«ä¾èµ–åŒ…ç®¡ç†</strong></h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">DependencyManager</span>
{
    <span class="hljs-keyword">private</span> AssetBundleManifest manifest;
    <span class="hljs-keyword">private</span> Dictionary&lt;<span class="hljs-built_in">string</span>, AssetBundle&gt; loadedDependencies = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-built_in">string</span>, AssetBundle&gt;();
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> IEnumerator <span class="hljs-title">LoadWithDependencies</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> bundleName</span>)</span>
    {
        <span class="hljs-comment">// 1. åŠ è½½ä¸»AssetBundleçš„ä¾èµ–</span>
        <span class="hljs-built_in">string</span>[] dependencies = manifest.GetAllDependencies(bundleName);
        
        <span class="hljs-keyword">foreach</span>(<span class="hljs-built_in">string</span> dep <span class="hljs-keyword">in</span> dependencies)
        {
            <span class="hljs-keyword">if</span>(!loadedDependencies.ContainsKey(dep))
            {
                <span class="hljs-function"><span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-title">LoadDependencyAsync</span>(<span class="hljs-params">dep</span>)</span>;
            }
        }
        
        <span class="hljs-comment">// 2. åŠ è½½ä¸»AssetBundle</span>
        <span class="hljs-function"><span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-title">LoadMainBundleAsync</span>(<span class="hljs-params">bundleName</span>)</span>;
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> IEnumerator <span class="hljs-title">LoadDependencyAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> depName</span>)</span>
    {
        <span class="hljs-keyword">var</span> request = AssetBundle.LoadFromFileAsync(GetBundlePath(depName));
        <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> request;
        loadedDependencies[depName] = request.assetBundle;
    }
}
</code></pre>
<h2 data-id="heading-10">äº”ã€å¤šçº¿ç¨‹ä¸åˆ†å¸§åŠ è½½</h2>
<h3 data-id="heading-11">1.Â <strong>åˆ†å¸§åŠ è½½å¤§èµ„æº</strong></h3>
<pre><code class="hljs language-ini" lang="ini">public class FrameDistributedLoader : MonoBehaviour
{
    private Queue&lt;LoadTask&gt; <span class="hljs-attr">loadQueue</span> = new Queue&lt;LoadTask&gt;()<span class="hljs-comment">;</span>
    private bool <span class="hljs-attr">isLoading</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
    
    public void EnqueueLoadTask(string bundlePath, string assetName, Action&lt;GameObject&gt; callback)
    {
        loadQueue.Enqueue(new LoadTask
        {
            <span class="hljs-attr">bundlePath</span> = bundlePath,
            <span class="hljs-attr">assetName</span> = assetName,
            <span class="hljs-attr">callback</span> = callback
        })<span class="hljs-comment">;</span>
        
        if(!isLoading) StartCoroutine(ProcessLoadQueue())<span class="hljs-comment">;</span>
    }
    
    IEnumerator ProcessLoadQueue()
    {
        <span class="hljs-attr">isLoading</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
        
        while(loadQueue.Count &gt; 0)
        {
            LoadTask <span class="hljs-attr">task</span> = loadQueue.Dequeue()<span class="hljs-comment">;</span>
            
            // æ¯å¸§åªåŠ è½½ä¸€ä¸ªèµ„æºï¼Œé¿å…å¡é¡¿
            yield return LoadSingleAsset(task)<span class="hljs-comment">;</span>
            
            // å¦‚æœé˜Ÿåˆ—è¿˜å¾ˆé•¿ï¼Œå¯ä»¥æ¯å¸§å¤„ç†å¤šä¸ª
            if(loadQueue.Count &gt; 10)
            {
                // å¯æ ¹æ®å¸§ç‡åŠ¨æ€è°ƒæ•´åŠ è½½æ•°é‡
                int <span class="hljs-attr">itemsThisFrame</span> = Mathf.Min(loadQueue.Count, <span class="hljs-number">3</span>)<span class="hljs-comment">;</span>
                for(int <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; itemsThisFrame; i++)</span>
                {
                    <span class="hljs-attr">task</span> = loadQueue.Dequeue()<span class="hljs-comment">;</span>
                    yield return LoadSingleAsset(task)<span class="hljs-comment">;</span>
                }
            }
        }
        
        <span class="hljs-attr">isLoading</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
    }
}
</code></pre>
<h2 data-id="heading-12">å…­ã€å‹ç¼©ä¸è§£å‹ä¼˜åŒ–</h2>
<h3 data-id="heading-13">1.Â <strong>åå°è§£å‹æŠ€æœ¯</strong></h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> System.Threading.Tasks;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">BackgroundDecompressor</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;AssetBundle&gt; <span class="hljs-title">LoadBundleAsync</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> path, <span class="hljs-built_in">bool</span> decompressInBackground = <span class="hljs-literal">true</span></span>)</span>
    {
        <span class="hljs-keyword">if</span> (decompressInBackground)
        {
            <span class="hljs-comment">// åœ¨åå°çº¿ç¨‹åŠ è½½å’Œè§£å‹</span>
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> Task.Run(() =&gt; 
            {
                <span class="hljs-keyword">return</span> AssetBundle.LoadFromFile(path);
            });
        }
        <span class="hljs-keyword">else</span>
        {
            <span class="hljs-comment">// åœ¨ä¸»çº¿ç¨‹åŒæ­¥åŠ è½½</span>
            <span class="hljs-keyword">return</span> AssetBundle.LoadFromFile(path);
        }
    }
}
</code></pre>
<h2 data-id="heading-14">ä¸ƒã€æ€§èƒ½ç›‘æ§å·¥å…·</h2>
<h3 data-id="heading-15">1.Â <strong>è‡ªå®šä¹‰<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269581835%26content_type%3DArticle%26match_order%3D1%26q%3D%25E6%2580%25A7%25E8%2583%25BD%25E5%2588%2586%25E6%259E%2590%25E5%2599%25A8%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269581835&amp;content_type=Article&amp;match_order=1&amp;q=%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E5%99%A8&amp;zhida_source=entity" ref="nofollow noopener noreferrer">æ€§èƒ½åˆ†æå™¨</a></strong></h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AssetBundleProfiler</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-keyword">private</span> Dictionary&lt;<span class="hljs-built_in">string</span>, LoadRecord&gt; loadRecords = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-built_in">string</span>, LoadRecord&gt;();
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">RecordLoadStart</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> bundleName</span>)</span>
    {
        loadRecords[bundleName] = <span class="hljs-keyword">new</span> LoadRecord
        {
            startTime = Time.realtimeSinceStartup,
            bundleName = bundleName
        };
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">RecordLoadEnd</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> bundleName</span>)</span>
    {
        <span class="hljs-keyword">if</span>(loadRecords.TryGetValue(bundleName, <span class="hljs-keyword">out</span> LoadRecord <span class="hljs-keyword">record</span>))
        {
            <span class="hljs-keyword">record</span>.endTime = Time.realtimeSinceStartup;
            <span class="hljs-keyword">record</span>.duration = <span class="hljs-keyword">record</span>.endTime - <span class="hljs-keyword">record</span>.startTime;
            
            Debug.Log(<span class="hljs-string">$"AssetBundle <span class="hljs-subst">{bundleName}</span> loaded in <span class="hljs-subst">{<span class="hljs-keyword">record</span>.duration:F3}</span>s"</span>);
            
            <span class="hljs-comment">// å¯ä»¥è®°å½•åˆ°æ–‡ä»¶æˆ–å‘é€åˆ°åˆ†ææœåŠ¡å™¨</span>
            LogToAnalytics(<span class="hljs-keyword">record</span>);
        }
    }
    
    <span class="hljs-keyword">class</span> <span class="hljs-title">LoadRecord</span>
    {
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> bundleName;
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">float</span> startTime;
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">float</span> endTime;
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">float</span> duration;
    }
}
</code></pre>
<h2 data-id="heading-16">å…«ã€å®æˆ˜å»ºè®®</h2>
<h3 data-id="heading-17">1.Â <strong>ç»¼åˆä¼˜åŒ–æ–¹æ¡ˆ</strong></h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">OptimizedAssetBundleLoader</span> : <span class="hljs-title">MonoBehaviour</span>
{
    <span class="hljs-comment">// 1. ä½¿ç”¨å¯¹è±¡æ± å‡å°‘å®ä¾‹åŒ–å¼€é”€</span>
    <span class="hljs-keyword">private</span> ObjectPool objectPool;
    
    <span class="hljs-comment">// 2. ä½¿ç”¨å¼•ç”¨è®¡æ•°ç®¡ç†èµ„æºç”Ÿå‘½å‘¨æœŸ</span>
    <span class="hljs-keyword">private</span> ReferenceCounter refCounter;
    
    <span class="hljs-comment">// 3. å®ç°ä¼˜å…ˆçº§åŠ è½½é˜Ÿåˆ—</span>
    <span class="hljs-keyword">private</span> PriorityLoadQueue priorityQueue;
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> IEnumerator <span class="hljs-title">LoadWithOptimizations</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> bundlePath, <span class="hljs-built_in">string</span> assetName, <span class="hljs-built_in">int</span> priority = <span class="hljs-number">0</span></span>)</span>
    {
        <span class="hljs-comment">// æ ¹æ®ä¼˜å…ˆçº§å®‰æ’åŠ è½½</span>
        <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> priorityQueue.Enqueue(priority, () =&gt; 
        {
            <span class="hljs-keyword">return</span> LoadAssetBundleWithDependencies(bundlePath, assetName);
        });
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> IEnumerator <span class="hljs-title">LoadAssetBundleWithDependencies</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> bundlePath, <span class="hljs-built_in">string</span> assetName</span>)</span>
    {
        <span class="hljs-comment">// æ£€æŸ¥ç¼“å­˜</span>
        <span class="hljs-keyword">if</span>(TryGetFromCache(bundlePath, <span class="hljs-keyword">out</span> AssetBundle bundle))
        {
            <span class="hljs-function"><span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-title">LoadAssetFromBundle</span>(<span class="hljs-params">bundle, assetName</span>)</span>;
            <span class="hljs-keyword">yield</span> <span class="hljs-keyword">break</span>;
        }
        
        <span class="hljs-comment">// å¼‚æ­¥åŠ è½½</span>
        <span class="hljs-keyword">var</span> loadRequest = AssetBundle.LoadFromFileAsync(bundlePath);
        <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> loadRequest;
        
        <span class="hljs-comment">// è®°å½•æ€§èƒ½</span>
        AssetBundleProfiler.Instance.RecordLoad(bundlePath, loadRequest);
        
        <span class="hljs-comment">// ç¼“å­˜ç»“æœ</span>
        CacheBundle(bundlePath, loadRequest.assetBundle);
        
        <span class="hljs-comment">// å¼‚æ­¥åŠ è½½èµ„æº</span>
        <span class="hljs-function"><span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-title">LoadAssetFromBundle</span>(<span class="hljs-params">loadRequest.assetBundle, assetName</span>)</span>;
    }
}
</code></pre>
<h2 data-id="heading-18">ä¹ã€å¹³å°ç‰¹å®šä¼˜åŒ–</h2>
<h3 data-id="heading-19">1.Â <strong>ä¸åŒ<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269581835%26content_type%3DArticle%26match_order%3D1%26q%3D%25E5%25B9%25B3%25E5%258F%25B0%25E7%25AD%2596%25E7%2595%25A5%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269581835&amp;content_type=Article&amp;match_order=1&amp;q=%E5%B9%B3%E5%8F%B0%E7%AD%96%E7%95%A5&amp;zhida_source=entity" ref="nofollow noopener noreferrer">å¹³å°ç­–ç•¥</a></strong></h3>
<ul>
<li><strong>iOS/Android</strong>ï¼šä¼˜å…ˆä½¿ç”¨LZ4å‹ç¼©</li>
<li><strong>PC/ä¸»æœº</strong>ï¼šå¯è€ƒè™‘ä¸å‹ç¼©æˆ–LZMA</li>
<li><strong>WebGL</strong>ï¼šæ³¨æ„åŒ…å¤§å°é™åˆ¶ï¼Œä½¿ç”¨åˆé€‚çš„å‹ç¼©</li>
</ul>
<h3 data-id="heading-20">2.Â <strong>å¢é‡æ›´æ–°ç­–ç•¥</strong></h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// ä½¿ç”¨HashéªŒè¯ï¼Œåªä¸‹è½½å˜åŒ–çš„éƒ¨åˆ†</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">IncrementalUpdater</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> IEnumerator <span class="hljs-title">CheckAndUpdate</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> remoteUrl, <span class="hljs-built_in">string</span> localPath</span>)</span>
    {
        <span class="hljs-comment">// 1. è·å–è¿œç¨‹ç‰ˆæœ¬ä¿¡æ¯</span>
        <span class="hljs-function"><span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-title">GetRemoteVersion</span>(<span class="hljs-params">remoteUrl</span>)</span>;
        
        <span class="hljs-comment">// 2. æ¯”è¾ƒæœ¬åœ°ç‰ˆæœ¬</span>
        <span class="hljs-keyword">if</span>(NeedUpdate(localVersion, remoteVersion))
        {
            <span class="hljs-comment">// 3. åªä¸‹è½½å·®å¼‚æ–‡ä»¶</span>
            <span class="hljs-function"><span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> <span class="hljs-title">DownloadDeltaFiles</span>(<span class="hljs-params">deltaList</span>)</span>;
        }
    }
}
</code></pre>
<p>æ€»ç»“è¦ç‚¹</p>
<ol>
<li><strong>æ‰“åŒ…ç­–ç•¥</strong>ï¼šåˆç†åˆ†å‰²AssetBundleï¼Œä½¿ç”¨LZ4å‹ç¼©</li>
<li><strong>åŠ è½½æ–¹å¼</strong>ï¼šå§‹ç»ˆä½¿ç”¨å¼‚æ­¥åŠ è½½ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹</li>
<li><strong>ç¼“å­˜ç®¡ç†</strong>ï¼šå®ç°æ™ºèƒ½ç¼“å­˜ï¼ŒåŠæ—¶æ¸…ç†æ— ç”¨èµ„æº</li>
<li><strong>ä¾èµ–å¤„ç†</strong>ï¼šé¢„åŠ è½½å…±äº«ä¾èµ–ï¼Œå‡å°‘é‡å¤åŠ è½½</li>
<li><strong>æ€§èƒ½ç›‘æ§</strong>ï¼šæŒç»­ç›‘æ§åŠ è½½æ€§èƒ½ï¼Œä¼˜åŒ–ç“¶é¢ˆ</li>
<li><strong>å¹³å°é€‚é…</strong>ï¼šé’ˆå¯¹ä¸åŒå¹³å°é‡‡ç”¨ä¸åŒç­–ç•¥</li>
<li><strong>å†…å­˜ç®¡ç†</strong>ï¼šåˆç†ä½¿ç”¨Unloadï¼Œé¿å…<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269581835%26content_type%3DArticle%26match_order%3D1%26q%3D%25E5%2586%2585%25E5%25AD%2598%25E6%25B3%2584%25E6%25BC%258F%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269581835&amp;content_type=Article&amp;match_order=1&amp;q=%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F&amp;zhida_source=entity" ref="nofollow noopener noreferrer">å†…å­˜æ³„æ¼</a></li>
</ol>
<p>é€šè¿‡ä»¥ä¸Šä¼˜åŒ–ç­–ç•¥ï¼Œå¯ä»¥æ˜¾è‘—æå‡AssetBundleçš„åŠ è½½é€Ÿåº¦ï¼Œæ”¹å–„æ¸¸æˆä½“éªŒã€‚å»ºè®®æ ¹æ®é¡¹ç›®å®é™…æƒ…å†µé€‰æ‹©é€‚ç”¨çš„ä¼˜åŒ–æ–¹æ¡ˆï¼Œå¹¶åœ¨å¼€å‘è¿‡ç¨‹ä¸­æŒç»­è¿›è¡Œæ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Function Call å’Œ MCP çš„åŒºåˆ«ï¼ˆä¸¾ä¾‹å­ï¼Œä¸€æ–‡è¯´æ˜ç™½ï¼‰]]></title>    <link>https://juejin.cn/post/7599917711793635338</link>    <guid>https://juejin.cn/post/7599917711793635338</guid>    <pubDate>2026-01-28T01:59:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599917711793635338" data-draft-id="7599459943918305318" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Function Call å’Œ MCP çš„åŒºåˆ«ï¼ˆä¸¾ä¾‹å­ï¼Œä¸€æ–‡è¯´æ˜ç™½ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,Agent,LangChain"/> <meta itemprop="datePublished" content="2026-01-28T01:59:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Lsx_"/> <meta itemprop="url" content="https://juejin.cn/user/1442981392682829"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Function Call å’Œ MCP çš„åŒºåˆ«ï¼ˆä¸¾ä¾‹å­ï¼Œä¸€æ–‡è¯´æ˜ç™½ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1442981392682829/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Lsx_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T01:59:20.000Z" title="Wed Jan 28 2026 01:59:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å‰è¨€</h2>
<p>è¿‡å»ä¸€å¹´é‡Œï¼ŒFunction Call æˆä¸ºæœ€å¸¸ç”¨çš„â€œè®© AI è°ƒç”¨ä»£ç â€çš„æ–¹å¼ã€‚<br/>
ä½†æ˜¯å½“ä½ çš„ä¸šåŠ¡å˜å¤æ‚ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>è®¿é—®æ•°æ®åº“</li>
<li>æ“ä½œæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</li>
<li>ç®¡ç†å¤šä¸ªå·¥å…·</li>
<li>è°ƒç”¨å…¬å¸å†…éƒ¨ API</li>
<li>å¤šä¸ªæ¨¡å‹å¤ç”¨åŒä¸€å¥—å·¥å…·</li>
</ul>
<p>Function Call å°±å¼€å§‹åƒåŠ›äº†ã€‚</p>
<p>äºæ˜¯ï¼Œ<strong>MCP</strong>å‡ºç°äº†ï¼Œå®ƒè§£å†³äº† Function Call çš„æ‰€æœ‰å±€é™ï¼Œæˆä¸ºä¸‹ä¸€ä»£ AI å·¥å…·è°ƒç”¨æ ‡å‡†ã€‚</p>
<p>æœ¬æ–‡å°†é€šè¿‡Â <strong>Node.js å®ä¾‹</strong>ï¼Œè®©ä½ ç›´è§‚ç†è§£ä¸¤è€…åŒºåˆ«ã€‚</p>
<h2 data-id="heading-1">äºŒã€æ¦‚å¿µæ€»ç»“ï¼šä¸€å¥è¯è¯´æ¸…ä¸¤è€…åŒºåˆ«</h2>
<p><strong>Function Call</strong>ï¼š<br/>
æ¨¡å‹æç¤ºä½ ï¼šâ€œæˆ‘è¦è°ƒç”¨è¿™ä¸ªå‡½æ•°â€ï¼Œç„¶åä½ è´Ÿè´£æ‰§è¡Œã€‚</p>
<p><strong>MCP</strong>ï¼š<br/>
æ¨¡å‹è‡ªåŠ¨å‘ç°å’Œè°ƒç”¨å·²æ³¨å†Œçš„â€œå·¥å…·â€ï¼Œå¼€å‘è€…åªè´Ÿè´£å®šä¹‰å·¥å…·ï¼Œä¸è´Ÿè´£æ‰§è¡Œã€‚</p>
<p>ä¸€å¥è¯ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">Function</span> <span class="hljs-keyword">Call</span>ï¼šæ¨¡å‹è¯´â€œæˆ‘éœ€è¦å·¥å…·â€ï¼Œä½ æ¥æ‰§è¡Œã€‚
MCPï¼šæ¨¡å‹è‡ªå·±æ‰§è¡Œå·¥å…·ï¼Œä½ åªè´Ÿè´£æä¾›å·¥å…·ã€‚
</code></pre>
<h2 data-id="heading-2">ä¸‰ã€ç”¨ä¾‹å¯¹æ¯”ï¼šæŸ¥è¯¢æŸä¸ªåŸå¸‚çš„å¤©æ°”</h2>
<p>æˆ‘ä»¬ä»¥â€œæŸ¥è¯¢åŒ—äº¬å¤©æ°”â€ä¸ºä¾‹è¿›è¡Œå¯¹æ¯”ã€‚</p>
<p>ç›®æ ‡ï¼š<br/>
è®©ç”¨æˆ·é—®ï¼šâ€œåŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿâ€<br/>
æ¨¡å‹è‡ªåŠ¨è·å–å¤©æ°”æ•°æ®ï¼Œå¹¶è¿”å›ç»“æœã€‚</p>
<h3 data-id="heading-3">3.1 Function Call ç¤ºä¾‹ï¼ˆNode.jsï¼‰</h3>
<h4 data-id="heading-4">ä»£ç ç»“æ„</h4>
<pre><code class="hljs language-ts" lang="ts">function_call/
  â”œâ”€â”€ app.<span class="hljs-property">js</span>
  â””â”€â”€ weather.<span class="hljs-property">js</span>
</code></pre>
<h4 data-id="heading-5">æ­¥éª¤1ï¼šä½ éœ€è¦æ‰‹å†™å·¥å…·å‡½æ•°ï¼ˆæ ¸å¿ƒï¼‰</h4>
<p>weather.jsï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">"axios"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getWeather</span>(<span class="hljs-params">city</span>) {
  <span class="hljs-keyword">const</span> apiKey = <span class="hljs-string">"your_api_key_here"</span>;
  <span class="hljs-keyword">const</span> url = <span class="hljs-string">`https://api.open-meteo.com/v1/forecast?latitude=39.9&amp;longitude=116.4&amp;hourly=temperature_2m`</span>;

  <span class="hljs-keyword">const</span> resp = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(url);
  <span class="hljs-keyword">return</span> <span class="hljs-string">`å½“å‰æ¸©åº¦ï¼š<span class="hljs-subst">${resp.data.hourly.temperature_2m[<span class="hljs-number">0</span>]}</span>Â°C`</span>;
}
</code></pre>
<h4 data-id="heading-6">æ­¥éª¤2ï¼šæŠŠå·¥å…·ç»‘å®šç»™æ¨¡å‹ï¼ˆä½ è¦å†™ï¼‰</h4>
<p>app.jsï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatOpenAI</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/openai"</span>;
<span class="hljs-keyword">import</span> { getWeather } <span class="hljs-keyword">from</span> <span class="hljs-string">"./weather.js"</span>;

<span class="hljs-keyword">const</span> tools = [
  {
    <span class="hljs-attr">type</span>: <span class="hljs-string">"function"</span>,
    <span class="hljs-attr">function</span>: {
      <span class="hljs-attr">name</span>: <span class="hljs-string">"get_weather"</span>,
      <span class="hljs-attr">description</span>: <span class="hljs-string">"è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯"</span>,
      <span class="hljs-attr">parameters</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-string">"object"</span>,
        <span class="hljs-attr">properties</span>: {
          <span class="hljs-attr">city</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span> }
        },
        <span class="hljs-attr">required</span>: [<span class="hljs-string">"city"</span>]
      }
    }
  }
];

<span class="hljs-keyword">const</span> llm = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatOpenAI</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-string">"gpt-4o-mini"</span>
}).<span class="hljs-title function_">bind</span>({ tools });

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">run</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> llm.<span class="hljs-title function_">invoke</span>(<span class="hljs-string">"åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·"</span>);

  <span class="hljs-keyword">if</span> (res.<span class="hljs-property">tool_calls</span>?.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">const</span> { city } = res.<span class="hljs-property">tool_calls</span>[<span class="hljs-number">0</span>].<span class="hljs-property">args</span>;

    <span class="hljs-comment">// ä½ è´Ÿè´£æ‰§è¡Œå·¥å…·</span>
    <span class="hljs-keyword">const</span> weather = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getWeather</span>(city);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"è¿”å›å¤©æ°”ï¼š"</span>, weather);
  }
}

<span class="hljs-title function_">run</span>();
</code></pre>
<h4 data-id="heading-7">Function Call çš„ç‰¹ç‚¹</h4>
<p>ä½ å¿…é¡»ï¼š</p>
<ul>
<li>â—æ‰‹å†™ getWeather</li>
<li>â—æ‰‹åŠ¨æ‰§è¡Œå·¥å…·</li>
<li>â—æ‰‹åŠ¨æŠŠç»“æœåé¦ˆç»™æ¨¡å‹</li>
<li>â—æ¯ä¸ªæ¨¡å‹éƒ½éœ€è¦ç»‘ä¸€é tools</li>
</ul>
<p>å½“ä½ çš„å·¥å…·è¶Šæ¥è¶Šå¤šæ—¶ï¼Œç»´æŠ¤æˆæœ¬è¶Šæ¥è¶Šé«˜ã€‚</p>
<h3 data-id="heading-8">3.2 MCP ç¤ºä¾‹ï¼ˆNode.jsï¼‰</h3>
<p>åœ¨ MCP ä¸­ï¼Œä½ åªéœ€è¦å®šä¹‰å·¥å…·ï¼Œæ¨¡å‹ä¼šï¼š</p>
<p>âœ” è‡ªåŠ¨å‘ç°å·¥å…·<br/>
âœ” è‡ªåŠ¨å†³å®šä»€ä¹ˆæ—¶å€™è°ƒç”¨<br/>
âœ” MCPClient è‡ªåŠ¨æ‰§è¡Œ<br/>
âœ” ä½ ä¸éœ€è¦ä»»ä½•å…¶å®ƒä»£ç </p>
<h4 data-id="heading-9">æ­¥éª¤1ï¼šå®šä¹‰ä¸€ä¸ª MCP å¤©æ°”æœåŠ¡</h4>
<p>æ–°å»ºï¼š<code>mcp-weather-server.js</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Server</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/server"</span>;
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">"axios"</span>;

<span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">"weather-service"</span>,
  <span class="hljs-attr">version</span>: <span class="hljs-string">"1.0"</span>,
});

<span class="hljs-comment">// æ³¨å†Œè‡ªå®šä¹‰å·¥å…·</span>
server.<span class="hljs-title function_">tool</span>(
  <span class="hljs-string">"get_weather"</span>,
  <span class="hljs-string">"è·å–å¤©æ°”"</span>,
  {
    <span class="hljs-attr">type</span>: <span class="hljs-string">"object"</span>,
    <span class="hljs-attr">properties</span>: {
      <span class="hljs-attr">city</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span> }
    },
    <span class="hljs-attr">required</span>: [<span class="hljs-string">"city"</span>]
  },
  <span class="hljs-keyword">async</span> ({ city }) =&gt; {
    <span class="hljs-comment">// ä½ å¯ä»¥æ¥æ•°æ®åº“/å…¬å¸å†…ç½‘ API éƒ½è¡Œ</span>
    <span class="hljs-keyword">const</span> url = <span class="hljs-string">`https://api.open-meteo.com/v1/forecast?latitude=39.9&amp;longitude=116.4&amp;hourly=temperature_2m`</span>;
    <span class="hljs-keyword">const</span> resp = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(url);
    <span class="hljs-keyword">const</span> temp = resp.<span class="hljs-property">data</span>.<span class="hljs-property">hourly</span>.<span class="hljs-property">temperature_2m</span>[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">weather</span>: <span class="hljs-string">`<span class="hljs-subst">${city}</span>å½“å‰æ¸©åº¦ï¼š<span class="hljs-subst">${temp}</span>Â°C`</span> };
  }
);

server.<span class="hljs-title function_">start</span>();
</code></pre>
<h4 data-id="heading-10">æ­¥éª¤2ï¼šæ¨¡å‹è‡ªåŠ¨è°ƒç”¨ MCP å·¥å…·</h4>
<p>app.jsï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatOpenAI</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/openai"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">MCPClient</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/langgraph/mcp"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatPromptTemplate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/core/prompts"</span>;

<span class="hljs-comment">// è¿æ¥ MCP server</span>
<span class="hljs-keyword">const</span> mcp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MCPClient</span>(<span class="hljs-string">"stdio"</span>, {
  <span class="hljs-attr">command</span>: <span class="hljs-string">"node"</span>,
  <span class="hljs-attr">args</span>: [<span class="hljs-string">"./mcp-weather-server.js"</span>]
});

<span class="hljs-comment">// ç»‘å®šåˆ°æ¨¡å‹ï¼ˆè®©æ¨¡å‹è‡ªåŠ¨è°ƒç”¨ MCP å·¥å…·ï¼‰</span>
<span class="hljs-keyword">const</span> llm = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatOpenAI</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-string">"gpt-4o-mini"</span>,
}).<span class="hljs-title function_">bind</span>({ mcp });

<span class="hljs-keyword">const</span> prompt = <span class="hljs-title class_">ChatPromptTemplate</span>.<span class="hljs-title function_">fromMessages</span>([
  [<span class="hljs-string">"system"</span>, <span class="hljs-string">"ä½ å¯ä»¥ä½¿ç”¨ MCP å·¥å…·è·å–å¤©æ°”ä¿¡æ¯ã€‚"</span>],
  [<span class="hljs-string">"human"</span>, <span class="hljs-string">"{q}"</span>]
]);

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ask</span>(<span class="hljs-params">q</span>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> prompt.<span class="hljs-title function_">pipe</span>(llm).<span class="hljs-title function_">invoke</span>({ q });
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ¨¡å‹å›ç­”ï¼š\n"</span>, res.<span class="hljs-property">content</span>);
}

<span class="hljs-title function_">ask</span>(<span class="hljs-string">"åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·"</span>);
</code></pre>
<p>è¿è¡Œåè¾“å‡ºç±»ä¼¼ï¼š</p>
<pre><code class="hljs">æ¨¡å‹å›ç­”ï¼š
åŒ—äº¬å½“å‰æ¸©åº¦ï¼š1Â°C
</code></pre>
<h4 data-id="heading-11">MCP çš„ç‰¹ç‚¹</h4>
<ul>
<li>æ¨¡å‹è‡ªåŠ¨è¯†åˆ«å¹¶è°ƒå– get_weather</li>
<li>MCPClient è´Ÿè´£æ‰§è¡Œå·¥å…·å¹¶è¿”å›ç»“æœ</li>
<li>å¼€å‘è€…ä¸ç”¨å†™å…¶å®ƒcodeï¼ˆå¦‚ res.tool_callsï¼‰</li>
<li>æ‰€æœ‰ MCP æ”¯æŒçš„æ¨¡å‹éƒ½èƒ½ç›´æ¥å¤ç”¨è¿™ä¸ªå·¥å…·</li>
</ul>
<h2 data-id="heading-12">å››ã€æ ¸å¿ƒåŒºåˆ«ï¼ˆé€šè¿‡ä¾‹å­ç›´æ¥çœ‹å‡ºæ¥ï¼‰</h2>








































<table><thead><tr><th>èƒ½åŠ›</th><th>Function Call</th><th>MCP</th></tr></thead><tbody><tr><td>å·¥å…·åœ¨å“ªé‡Œå®šä¹‰ï¼Ÿ</td><td>ä»£ç é‡Œ</td><td>MCP Server é‡Œ</td></tr><tr><td>å·¥å…·ç”±è°è°ƒç”¨ï¼Ÿ</td><td><strong>å¼€å‘è€…æ‰‹åŠ¨è°ƒç”¨</strong></td><td><strong>æ¨¡å‹è‡ªåŠ¨è°ƒç”¨</strong></td></tr><tr><td>å·¥å…·èƒ½å¦è‡ªåŠ¨å‘ç°ï¼Ÿ</td><td>âŒ ä¸è¡Œ</td><td>âœ”ï¸ è‡ªåŠ¨å‘ç°</td></tr><tr><td>æ˜¯å¦æ”¯æŒæ–‡ä»¶ç³»ç»Ÿ / DB / æœ¬åœ°è„šæœ¬ï¼Ÿ</td><td>ä½ å¾—è‡ªå·±å†™</td><td>MCP å·¥å…·åº“ç›´æ¥æ”¯æŒ</td></tr><tr><td>èƒ½å¦è¢«å¤šä¸ªæ¨¡å‹å…±äº«ï¼Ÿ</td><td>âŒ æ¯ä¸ªæ¨¡å‹éƒ½è¦é‡æ–°å†™</td><td>âœ”ï¸ MCP å·¥å…·å¯å¤ç”¨</td></tr><tr><td>å®‰å…¨æ€§å’Œæƒé™ï¼Ÿ</td><td>æ‰‹åŠ¨å¤„ç†</td><td>MCP å†…ç½®æƒé™ç®¡ç†</td></tr></tbody></table>
<p>ä¸€å¥è¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Function <span class="hljs-attr">Call</span> = æ¨¡å‹è¯·æ±‚ä½ ï¼Œä½ å†å¸®å®ƒè°ƒå·¥å…·  
<span class="hljs-attr">MCP</span> = æ¨¡å‹è‡ªå·±è°ƒå·¥å…·ï¼Œä½ åªæä¾›å·¥å…·
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScriptå¼€å‘è€…å¿…å¤‡çš„5ä¸ªé«˜æ•ˆè°ƒè¯•æŠ€å·§ï¼Œ90%çš„äººéƒ½ä¸çŸ¥é“ï¼]]></title>    <link>https://juejin.cn/post/7599873006258618402</link>    <guid>https://juejin.cn/post/7599873006258618402</guid>    <pubDate>2026-01-28T00:19:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599873006258618402" data-draft-id="7599893063863910415" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScriptå¼€å‘è€…å¿…å¤‡çš„5ä¸ªé«˜æ•ˆè°ƒè¯•æŠ€å·§ï¼Œ90%çš„äººéƒ½ä¸çŸ¥é“ï¼"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T00:19:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScriptå¼€å‘è€…å¿…å¤‡çš„5ä¸ªé«˜æ•ˆè°ƒè¯•æŠ€å·§ï¼Œ90%çš„äººéƒ½ä¸çŸ¥é“ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T00:19:28.000Z" title="Wed Jan 28 2026 00:19:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>JavaScriptå¼€å‘è€…å¿…å¤‡çš„5ä¸ªé«˜æ•ˆè°ƒè¯•æŠ€å·§ï¼Œ90%çš„äººéƒ½ä¸çŸ¥é“ï¼</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>ä½œä¸ºJavaScriptå¼€å‘è€…ï¼Œè°ƒè¯•æ˜¯æ—¥å¸¸å·¥ä½œä¸­ä¸å¯é¿å…çš„ä¸€éƒ¨åˆ†ã€‚æ— è®ºæ˜¯æ’æŸ¥è¿è¡Œæ—¶é”™è¯¯ã€ä¼˜åŒ–æ€§èƒ½ï¼Œè¿˜æ˜¯ç†è§£å¤æ‚çš„ä»£ç é€»è¾‘ï¼Œé«˜æ•ˆçš„è°ƒè¯•æŠ€å·§èƒ½æ˜¾è‘—æå‡å¼€å‘æ•ˆç‡ã€‚ç„¶è€Œï¼Œè®¸å¤šå¼€å‘è€…ä»ç„¶åœç•™åœ¨<code>console.log</code>çš„åˆçº§é˜¶æ®µï¼Œæˆ–è€…å¯¹æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ä½¿ç”¨ä»…é™äºæŸ¥çœ‹é”™è¯¯ä¿¡æ¯ã€‚äº‹å®ä¸Šï¼ŒJavaScriptç”Ÿæ€ç³»ç»Ÿæä¾›äº†å¤§é‡å¼ºå¤§çš„è°ƒè¯•å·¥å…·å’ŒæŠ€æœ¯ï¼Œä½†å¤§å¤šæ•°å¼€å‘è€…å¹¶æœªå……åˆ†åˆ©ç”¨å®ƒä»¬ã€‚</p>
<p>æœ¬æ–‡å°†åˆ†äº«5ä¸ªé«˜æ•ˆä¸”é²œä¸ºäººçŸ¥çš„JavaScriptè°ƒè¯•æŠ€å·§ï¼Œå¸®åŠ©ä½ æ›´å¿«åœ°å®šä½é—®é¢˜ã€ç†è§£ä»£ç è¡Œä¸ºå¹¶æå‡å¼€å‘ä½“éªŒã€‚è¿™äº›æŠ€å·§æ¶µç›–äº†æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„é«˜çº§åŠŸèƒ½ã€Node.jsè°ƒè¯•ä»¥åŠä¸€äº›å®ç”¨çš„ç¬¬ä¸‰æ–¹å·¥å…·ã€‚æ— è®ºä½ æ˜¯åˆå­¦è€…è¿˜æ˜¯ç»éªŒä¸°å¯Œçš„å¼€å‘è€…ï¼Œè¿™äº›æŠ€å·§éƒ½èƒ½è®©ä½ åœ¨è°ƒè¯•æ—¶äº‹åŠåŠŸå€ã€‚</p>
<hr/>
<h2 data-id="heading-2">ä¸»ä½“</h2>
<h3 data-id="heading-3">1. ä½¿ç”¨<code>console</code>çš„è¿›é˜¶æ–¹æ³•</h3>
<p>å¤§å¤šæ•°å¼€å‘è€…éƒ½çŸ¥é“<code>console.log</code>ï¼Œä½†å¾ˆå°‘æœ‰äººå……åˆ†åˆ©ç”¨<code>console</code>å¯¹è±¡çš„å…¶ä»–å¼ºå¤§æ–¹æ³•ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›é²œä¸ºäººçŸ¥ä½†æå…¶æœ‰ç”¨çš„<code>console</code>æ–¹æ³•ï¼š</p>
<h4 data-id="heading-4"><code>console.table()</code></h4>
<p>å½“ä½ éœ€è¦æ‰“å°æ•°ç»„æˆ–å¯¹è±¡æ—¶ï¼Œ<code>console.table()</code>èƒ½ä»¥è¡¨æ ¼å½¢å¼å±•ç¤ºæ•°æ®ï¼Œä½¿å¤æ‚ç»“æ„ä¸€ç›®äº†ç„¶ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> users = [
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> }
];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">table</span>(users);
</code></pre>
<p>è¿™ä¼šç”Ÿæˆä¸€ä¸ªæ¸…æ™°çš„è¡¨æ ¼è§†å›¾ï¼Œéå¸¸é€‚åˆè°ƒè¯•æ•°æ®ç»“æ„ã€‚</p>
<h4 data-id="heading-5"><code>console.time()</code>å’Œ<code>console.timeEnd()</code></h4>
<p>è¿™å¯¹æ–¹æ³•ç”¨äºæµ‹é‡ä»£ç å—çš„æ‰§è¡Œæ—¶é—´ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'fetchData'</span>);
<span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchData</span>(); <span class="hljs-comment">// å‡è®¾è¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'fetchData'</span>);
</code></pre>
<p>è¾“å‡ºå°†æ˜¾ç¤º<code>fetchData</code>çš„æ‰§è¡Œæ—¶é—´ï¼Œéå¸¸é€‚ç”¨äºæ€§èƒ½åˆ†æã€‚</p>
<h4 data-id="heading-6"><code>console.trace()</code></h4>
<p>å¦‚æœä½ æƒ³è¿½è¸ªå‡½æ•°çš„è°ƒç”¨æ ˆï¼ˆæ¯”å¦‚æŸä¸ªå‡½æ•°æ˜¯å¦‚ä½•è¢«è°ƒç”¨çš„ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨<code>console.trace()</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">trace</span>(<span class="hljs-string">'Trace foo'</span>);
}
<span class="hljs-title function_">foo</span>();
</code></pre>
<p>è¿™å°†æ‰“å°å‡ºä»è°ƒç”¨åˆ°å½“å‰å‡½æ•°çš„å®Œæ•´è°ƒç”¨é“¾ã€‚</p>
<h3 data-id="heading-7">2. Chrome DevToolsä¸­çš„æ¡ä»¶æ–­ç‚¹</h3>
<p>æ–­ç‚¹æ˜¯è°ƒè¯•çš„æ ¸å¿ƒå·¥å…·ä¹‹ä¸€ï¼Œä½†æ™®é€šæ–­ç‚¹åœ¨æ¯æ¬¡æ‰§è¡Œæ—¶éƒ½ä¼šæš‚åœä»£ç è¿è¡Œã€‚å¦‚æœä½ åªæƒ³åœ¨ç‰¹å®šæ¡ä»¶ä¸‹æš‚åœï¼ˆä¾‹å¦‚å½“å¾ªç¯å˜é‡ç­‰äºæŸä¸ªå€¼æˆ–å±æ€§æ»¡è¶³æŸäº›æ¡ä»¶æ—¶ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨æ¡ä»¶æ–­ç‚¹ï¼ˆConditional Breakpointï¼‰ã€‚</p>
<p>è®¾ç½®æ–¹æ³•ï¼š</p>
<ol>
<li>åœ¨Chrome DevToolsä¸­æ‰“å¼€Sourcesé¢æ¿ã€‚</li>
<li>æ‰¾åˆ°ç›®æ ‡ä»£ç è¡Œå¹¶å³é”®ç‚¹å‡»è¡Œå·å·¦ä¾§çš„åŒºåŸŸã€‚</li>
<li>é€‰æ‹©â€œAdd conditional breakpointâ€å¹¶è¾“å…¥æ¡ä»¶è¡¨è¾¾å¼ï¼ˆä¾‹å¦‚ï¼š<code>i === 5</code>ï¼‰ã€‚</li>
</ol>
<p>è¿™æ ·åªæœ‰å½“æ¡ä»¶æ»¡è¶³æ—¶æ‰ä¼šæš‚åœæ‰§è¡Œï¼Œé¿å…æ‰‹åŠ¨è·³è¿‡æ— å…³è¿­ä»£çš„éº»çƒ¦ã€‚</p>
<h3 data-id="heading-8">3. Node.jsçš„Inspectorå’ŒChrome DevToolsé›†æˆ</h3>
<p>Node.jsæä¾›äº†å¼ºå¤§çš„å†…ç½®è°ƒè¯•æ”¯æŒï¼Œå¯ä»¥é€šè¿‡Chrome DevToolsè¿›è¡Œå¯è§†åŒ–è°ƒè¯•ï¼š</p>
<ol>
<li>å¯åŠ¨Node.jsåº”ç”¨æ—¶åŠ ä¸Š<code>--inspect</code>æ ‡å¿—ï¼š
<pre><code class="hljs language-bash" lang="bash">node --inspect app.js
</code></pre>
</li>
<li>Chromeæµè§ˆå™¨ä¸­è¾“å…¥ï¼š<code>chrome://inspect/</code>,ç„¶åç‚¹å‡»â€œOpen dedicated DevTools for Nodeâ€ã€‚</li>
</ol>
<p>ç°åœ¨ä½ å¯ä»¥åƒè°ƒè¯•å‰ç«¯ä»£ç ä¸€æ ·è®¾ç½®æ–­ç‚¹ã€æ£€æŸ¥å˜é‡å’Œæ‰§è¡Œæ­¥éª¤åŒ–æ“ä½œï¼ˆStep Over, Step Intoç­‰ï¼‰ã€‚æ­¤å¤–è¿˜å¯ä»¥ä½¿ç”¨CPUå’Œå†…å­˜åˆ†æå™¨æ¥ä¼˜åŒ–æ€§èƒ½é—®é¢˜ï¼</p>
<p>###4 .ä½¿ç”¨VS Codeçš„å†…ç½®JavaScript Debugger</p>
<p>VS Codeä¸ä»…æ˜¯ç¼–è¾‘å™¨è¿˜è‡ªå¸¦å¼ºå¤§JS debuggeråŠŸèƒ½æ— éœ€ç¦»å¼€ç¼–è¾‘å™¨å³å¯å®Œæˆæ‰€æœ‰debugä»»åŠ¡ï¼š</p>
<ul>
<li><strong>Launch Configuration</strong>:é€šè¿‡<code>.vscode/launch.json</code>,é…ç½®ä¸åŒç±»å‹(å¦‚å¯åŠ¨æ–‡ä»¶/é™„åŠ åˆ°è¿›ç¨‹)</li>
<li><strong>Logpoints</strong>:ç±»ä¼¼logä½†ä¸ä¼šæš‚åœç¨‹åºæ‰§è¡Œé€‚åˆç”Ÿäº§ç¯å¢ƒæ’é”™</li>
<li><strong>Inline Variable Values</strong>:ç›´æ¥æ˜¾ç¤ºå˜é‡å€¼æ— éœ€æ‚¬åœé¼ æ ‡</li>
</ul>
<p>ç¤ºä¾‹é…ç½®ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
 <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0"</span><span class="hljs-punctuation">,</span>
 <span class="hljs-attr">"configurations"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
       <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node"</span><span class="hljs-punctuation">,</span>
       <span class="hljs-attr">"request"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"launch"</span><span class="hljs-punctuation">,</span>
       <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"Debug Current File"</span><span class="hljs-punctuation">,</span>
       <span class="hljs-attr">"program"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"${file}"</span> 
    <span class="hljs-punctuation">}</span>
 <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>###5 .åˆ©ç”¨Error Stack Traceså’ŒSource Maps</p>
<p>å½“é”™è¯¯å‘ç”Ÿæ—¶å †æ ˆè·Ÿè¸ª(stack trace)è‡³å…³é‡è¦ä½†å¦‚æœä»£ç ç»è¿‡è½¬è¯‘(å¦‚Babel/TypeScript),åˆ™åŸå§‹ä½ç½®å¯èƒ½ä¸¢å¤±æ­¤æ—¶source mapå°±æ´¾ä¸Šç”¨åœºç¡®ä¿æ„å»ºæµç¨‹ç”Ÿæˆæ­£ç¡®source mapæ–‡ä»¶å¹¶åœ¨éƒ¨ç½²æ—¶ä¿ç•™å®ƒä»¬.</p>
<p>åŒæ—¶å¯åˆ©ç”¨Errorå¯¹è±¡è‡ªå®šä¹‰ä¿¡æ¯:</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">try</span> {
 <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Custom error message'</span>); 
} <span class="hljs-keyword">catch</span> (error) {
 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error.<span class="hljs-property">stack</span>); 
 <span class="hljs-comment">// Custom handling here...  </span>
} 
</code></pre>
<p>å¯¹äºPromise rejectionå»ºè®®ç›‘å¬å…¨å±€äº‹ä»¶:</p>
<pre><code class="hljs language-js" lang="js">process.<span class="hljs-title function_">on</span>(<span class="hljs-string">'unhandledRejection'</span>,<span class="hljs-function">(<span class="hljs-params">reason,promise</span>)=&gt;</span>{
   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Unhandled Rejection at:'</span>,promise,<span class="hljs-string">'reason:'</span>,reason);    
}); 

<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'unhandledrejection'</span>,<span class="hljs-function"><span class="hljs-params">event</span>=&gt;</span>{
   event.<span class="hljs-title function_">preventDefault</span>();     
   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`UNHANDLED PROMISE REJECTION: <span class="hljs-subst">${event.reason}</span>`</span>);    
});   
</code></pre>
<hr/>
<p>##æ€»ç»“</p>
<p>æœ¬æ–‡ä»‹ç»äº†äº”ä¸ªé«˜æ•ˆå´å¸¸è¢«å¿½è§†JS debugæŠ€å·§åŒ…æ‹¬Consoleé«˜çº§æ–¹æ³•Conditional BreakpointsNodeä¸Chromeé›†æˆVS Code Debuggerä»¥åŠSource Mapsåº”ç”¨æŒæ¡è¿™äº›æŠ€æœ¯åä½ èƒ½å¤Ÿæ›´å¿«é€Ÿå‡†ç¡®å®šä½é—®é¢˜å‡å°‘æ— è°“æ—¶é—´æ¶ˆè€—ä»è€Œä¸“æ³¨äºæ„å»ºæ›´å¥½åº”ç”¨è®°ä½ä¼˜ç§€å¼€å‘è€…ä¸ä»…æ“…é•¿ç¼–å†™ä»£ç æ›´è¦ç²¾é€šå¦‚ä½•ä¿®å¤å®ƒå¸Œæœ›æœ¬æŒ‡å—èƒ½æˆä¸ºä½ å·¥å…·ç®±ä¸­å®è´µèµ„æº!</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰‘æŒ‡offer-69ã€æ•°å­—åºåˆ—ä¸­æŸâ¼€ä½çš„æ•°å­—]]></title>    <link>https://juejin.cn/post/7599920572840673289</link>    <guid>https://juejin.cn/post/7599920572840673289</guid>    <pubDate>2026-01-28T00:26:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599920572840673289" data-draft-id="7598459769238519842" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰‘æŒ‡offer-69ã€æ•°å­—åºåˆ—ä¸­æŸâ¼€ä½çš„æ•°å­—"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-28T00:26:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SevenCoding"/> <meta itemprop="url" content="https://juejin.cn/user/3261615728242467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰‘æŒ‡offer-69ã€æ•°å­—åºåˆ—ä¸­æŸâ¼€ä½çš„æ•°å­—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3261615728242467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SevenCoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T00:26:44.000Z" title="Wed Jan 28 2026 00:26:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é¢˜â½¬æè¿°</h2>
<p>æ•°å­—ä»¥ 0123456789101112131415... çš„æ ¼å¼ä½œä¸ºâ¼€ä¸ªå­—ç¬¦åºåˆ—ï¼Œåœ¨è¿™ä¸ªåºåˆ—ä¸­ç¬¬ 2 ä½ï¼ˆä»ä¸‹æ ‡ 0 å¼€å§‹è®¡ç®—ï¼‰æ˜¯ 2 ï¼Œç¬¬ 10 ä½æ˜¯ 1 ï¼Œç¬¬ 13 ä½æ˜¯ 1 ï¼Œä»¥æ­¤ç±»é¢˜ï¼Œè¯·ä½ è¾“å‡ºç¬¬ n ä½å¯¹åº”çš„æ•°å­—ã€‚</p>
<p>ç¤ºä¾‹1</p>
<p>è¾“â¼Šï¼š0
è¿”å›å€¼ï¼š0</p>
<p>ç¤ºä¾‹2
è¾“â¼Šï¼š2
è¿”å›å€¼ï¼š2</p>
<p>ç¤ºä¾‹3
è¾“â¼Šï¼š13
è¿”å›å€¼ï¼š1</p>
<h2 data-id="heading-1">æ€è·¯åŠè§£ç­”</h2>
<h3 data-id="heading-2">æš´åŠ›æ³•</h3>
<p>é€šè¿‡é€æ­¥æ„é€ æ•°å­—åºåˆ—æ¥æ‰¾åˆ°ç¬¬nä½æ•°å­—</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">findNthDigit</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> {
        <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// ç¤ºä¾‹1ç‰¹æ®Šæƒ…å†µå¤„ç†[2](@ref)</span>
        
        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sequence</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();
        <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        
        <span class="hljs-comment">// é€æ­¥æ„å»ºåºåˆ—ï¼Œç›´åˆ°é•¿åº¦è¶…è¿‡n</span>
        <span class="hljs-keyword">while</span> (sequence.length() &lt;= n) {
            sequence.append(num);
            num++;
        }
        
        <span class="hljs-comment">// è¿”å›ç¬¬nä½å­—ç¬¦å¯¹åº”çš„æ•°å­—å€¼</span>
        <span class="hljs-keyword">return</span> sequence.charAt(n) - <span class="hljs-string">'0'</span>;
    }
}
</code></pre>
<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(n)ï¼Œéœ€è¦æ„é€ é•¿åº¦è‡³å°‘ä¸ºnçš„å­—ç¬¦ä¸²</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(n)ï¼Œéœ€è¦å­˜å‚¨æ„é€ çš„å­—ç¬¦ä¸²åºåˆ—</li>
</ul>
<h3 data-id="heading-3">æ•°å­¦è§„å¾‹</h3>
<p>åˆ©ç”¨æ•°å­—ä½æ•°åˆ†å¸ƒçš„æ•°å­¦è§„å¾‹ï¼Œç›´æ¥å®šä½ç¬¬nä½æ‰€åœ¨çš„æ•°å­—å’Œå…·ä½“ä½ç½®</p>
<p><strong>æ•°å­—ä½æ•°åˆ†å¸ƒè§„å¾‹ï¼š</strong></p>
<ul>
<li><strong>1ä½æ•°</strong>ï¼š0-9 â†’ 10ä¸ªæ•°å­— Ã— 1ä½ = 10ä½</li>
<li><strong>2ä½æ•°</strong>ï¼š10-99 â†’ 90ä¸ªæ•°å­— Ã— 2ä½ = 180ä½</li>
<li><strong>3ä½æ•°</strong>ï¼š100-999 â†’ 900ä¸ªæ•°å­— Ã— 3ä½ = 2700ä½</li>
<li><strong>kä½æ•°</strong>ï¼š9Ã—10áµâ»Â¹ä¸ªæ•°å­— Ã— kä½</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">findNthDigit</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> {
        <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        
        <span class="hljs-type">int</span> <span class="hljs-variable">digit</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;              <span class="hljs-comment">// æ•°å­—ä½æ•°ï¼ˆ1ä½ã€2ä½ã€3ä½...ï¼‰</span>
        <span class="hljs-type">long</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;             <span class="hljs-comment">// å½“å‰ä½æ•°èŒƒå›´çš„èµ·å§‹æ•°å­—</span>
        <span class="hljs-type">long</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">9</span>;             <span class="hljs-comment">// å½“å‰ä½æ•°èŒƒå›´å†…çš„æ•°å­—æ€»ä½æ•°</span>
        
        <span class="hljs-comment">// æ­¥éª¤1ï¼šç¡®å®šnæ‰€åœ¨çš„æ•°å­—ä½æ•°</span>
        <span class="hljs-keyword">while</span> (n &gt; count) {
            n -= count;             <span class="hljs-comment">// å‡å»å‰ä¸€ä¸ªä½æ•°èŒƒå›´çš„æ•°å­—æ€»ä½æ•°</span>
            digit++;                <span class="hljs-comment">// ä½æ•°å¢åŠ </span>
            start *= <span class="hljs-number">10</span>;            <span class="hljs-comment">// èµ·å§‹æ•°å­—æ‰©å¤§10å€</span>
            count = <span class="hljs-number">9L</span> * digit * start; <span class="hljs-comment">// è®¡ç®—æ–°çš„ä½æ•°èŒƒå›´å†…çš„æ€»ä½æ•°</span>
        }
        
        <span class="hljs-comment">// æ­¥éª¤2ï¼šç¡®å®šnæ‰€åœ¨çš„å…·ä½“æ•°å­—</span>
        <span class="hljs-type">long</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> start + (n - <span class="hljs-number">1</span>) / digit; <span class="hljs-comment">// è®¡ç®—ç›®æ ‡æ•°å­—</span>
        
        <span class="hljs-comment">// æ­¥éª¤3ï¼šç¡®å®šnåœ¨æ•°å­—ä¸­çš„å…·ä½“ä½ç½®å¹¶è¿”å›</span>
        <span class="hljs-keyword">return</span> Long.toString(num).charAt((n - <span class="hljs-number">1</span>) % digit) - <span class="hljs-string">'0'</span>;
    }
}
</code></pre>
<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(logâ‚â‚€n)ï¼Œå¾ªç¯æ¬¡æ•°ä¸nçš„ä½æ•°æˆæ­£æ¯”</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(1)ï¼Œåªä½¿ç”¨å¸¸æ•°çº§åˆ«å˜é‡</li>
</ul>
<h3 data-id="heading-4">æ·»0è¡¥é½</h3>
<p>å‡è®¾æ‰€æœ‰æ•°å­—éƒ½æ˜¯iä½æ•°ï¼Œé€šè¿‡ç»™è¾ƒçŸ­æ•°å­—å‰é¢æ·»0ï¼Œä½¿æ‰€æœ‰æ•°å­—ä½æ•°ç›¸åŒï¼Œç®€åŒ–å®šä½é€»è¾‘</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">findNthDigit</span><span class="hljs-params">(<span class="hljs-type">int</span> n)</span> {
        <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        
        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; <span class="hljs-comment">// æ•°å­—ä½æ•°</span>
        
        <span class="hljs-comment">// é€šè¿‡æ·»0è¡¥é½ï¼Œä½¿æ‰€æœ‰æ•°å­—éƒ½è§†ä¸ºiä½æ•°</span>
        <span class="hljs-keyword">while</span> (i * Math.pow(<span class="hljs-number">10</span>, i) &lt; n) {
            n += Math.pow(<span class="hljs-number">10</span>, i); <span class="hljs-comment">// æ·»0å¢åŠ çš„ä½æ•°</span>
            i++;
        }
        
        <span class="hljs-comment">// å®šä½ç›®æ ‡æ•°å­—å’Œå…·ä½“ä½ç½®</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> String.valueOf(n / i);
        <span class="hljs-keyword">return</span> num.charAt(n % i) - <span class="hljs-string">'0'</span>;
    }
}
</code></pre>
<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(logâ‚â‚€n)ï¼Œä¸æ•°å­¦è§„å¾‹æ³•ç›¸åŒ</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(1)ï¼Œå¸¸æ•°ç©ºé—´å¤æ‚åº¦</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[type-challengesï¼ˆtsç±»å‹ä½“æ“ï¼‰: 4 - å®ç° Pick]]></title>    <link>https://juejin.cn/post/7599852042530570250</link>    <guid>https://juejin.cn/post/7599852042530570250</guid>    <pubDate>2026-01-28T00:28:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599852042530570250" data-draft-id="7599922362997932078" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="type-challengesï¼ˆtsç±»å‹ä½“æ“ï¼‰: 4 - å®ç° Pick"/> <meta itemprop="keywords" content="TypeScript"/> <meta itemprop="datePublished" content="2026-01-28T00:28:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="fxss"/> <meta itemprop="url" content="https://juejin.cn/user/3702810892856808"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            type-challengesï¼ˆtsç±»å‹ä½“æ“ï¼‰: 4 - å®ç° Pick
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3702810892856808/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    fxss
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T00:28:05.000Z" title="Wed Jan 28 2026 00:28:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">4 - å®ç° Pick</h2>
<p>by Anthony Fu (@antfu) #ç®€å• #union #built-in</p>
<h3 data-id="heading-1">é¢˜ç›®</h3>
<p>ä¸ä½¿ç”¨ <code>Pick&lt;T, K&gt;</code> ï¼Œå®ç° TS å†…ç½®çš„ <code>Pick&lt;T, K&gt;</code> çš„åŠŸèƒ½ã€‚</p>
<p><strong>ä»ç±»å‹ <code>T</code> ä¸­é€‰å‡ºç¬¦åˆ <code>K</code> çš„å±æ€§ï¼Œæ„é€ ä¸€ä¸ªæ–°çš„ç±»å‹</strong>ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Todo</span> {
  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">description</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">completed</span>: <span class="hljs-built_in">boolean</span>
}

<span class="hljs-keyword">type</span> <span class="hljs-title class_">TodoPreview</span> = <span class="hljs-title class_">MyPick</span>&lt;<span class="hljs-title class_">Todo</span>, <span class="hljs-string">'title'</span> | <span class="hljs-string">'completed'</span>&gt;

<span class="hljs-keyword">const</span> <span class="hljs-attr">todo</span>: <span class="hljs-title class_">TodoPreview</span> = {
    <span class="hljs-attr">title</span>: <span class="hljs-string">'Clean room'</span>,
    <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>,
}
</code></pre>
<blockquote>
<p>åœ¨ Github ä¸ŠæŸ¥çœ‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftsch.js.org%2F4%2Fzh-CN" target="_blank" title="https://tsch.js.org/4/zh-CN" ref="nofollow noopener noreferrer">tsch.js.org/4/zh-CN</a></p>
</blockquote>
<h3 data-id="heading-2">ä»£ç </h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/* _____________ ä½ çš„ä»£ç  _____________ */</span>

<span class="hljs-keyword">type</span> <span class="hljs-title class_">MyPick</span>&lt;T, K <span class="hljs-keyword">extends</span> keyof T&gt; = {
  [P <span class="hljs-keyword">in</span> K]: T[P]
}

</code></pre>
<p>å…³é”®è§£é‡Šï¼š</p>
<ul>
<li><code>T</code>ï¼šæ³›å‹å‚æ•°ï¼Œä»£è¡¨ä»»æ„å¯¹è±¡ç±»å‹ï¼›</li>
<li><code>K extends keyof T</code>ï¼šçº¦æŸ <code>K</code> å¿…é¡»æ˜¯ <code>T</code> çš„å±æ€§åä¹‹ä¸€ï¼›</li>
<li><code>[P in K]: T[P]</code>ï¼šæ˜ å°„ç±»å‹ï¼Œéå† <code>K</code> ä¸­çš„æ¯ä¸ªå±æ€§å <code>P</code>ï¼Œå¹¶å°† <code>T[P]</code> ä½œä¸º <code>P</code> çš„ç±»å‹ã€‚
<ul>
<li><code>P in K</code>ï¼šéå† <code>K</code> ä¸­çš„æ¯ä¸ªå±æ€§å <code>P</code>ï¼›</li>
<li><code>T[P]</code>ï¼šè·å– <code>T</code> ä¸­å±æ€§ <code>P</code> çš„ç±»å‹ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-3">ç›¸å…³çŸ¥è¯†ç‚¹</h3>
<h4 data-id="heading-4"><code>keyof</code></h4>
<p><code>keyof</code> æ“ä½œç¬¦ç”¨äºè·å–å¯¹è±¡ç±»å‹çš„æ‰€æœ‰å±æ€§åï¼ˆåŒ…æ‹¬ç´¢å¼•ç­¾åï¼‰ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºè”åˆç±»å‹ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Todo</span> {
  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">description</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">completed</span>: <span class="hljs-built_in">boolean</span>
}

<span class="hljs-keyword">type</span> <span class="hljs-title class_">TodoKeys</span> = keyof <span class="hljs-title class_">Todo</span> <span class="hljs-comment">// "title" | "description" | "completed"</span>
</code></pre>
<h4 data-id="heading-5"><code>extends</code></h4>
<p><code>extends</code> æ“ä½œç¬¦ç”¨äºçº¦æŸæ³›å‹å‚æ•°çš„ç±»å‹èŒƒå›´ã€‚</p>
<h4 data-id="heading-6"><code>in</code></h4>
<p><code>in</code> æ“ä½œç¬¦ç”¨äºéå†è”åˆç±»å‹ä¸­çš„æ¯ä¸ªæˆå‘˜ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Todo</span> {
  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">description</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">completed</span>: <span class="hljs-built_in">boolean</span>
}

<span class="hljs-keyword">type</span> <span class="hljs-title class_">TodoKeys</span> = <span class="hljs-string">'title'</span> | <span class="hljs-string">'description'</span> | <span class="hljs-string">'completed'</span>

<span class="hljs-keyword">type</span> <span class="hljs-title class_">TodoPreview</span> = {
  [P <span class="hljs-keyword">in</span> <span class="hljs-title class_">TodoKeys</span>]: <span class="hljs-title class_">Todo</span>[P]
}
<span class="hljs-comment">// TodoPreview ç±»å‹ä¸ºï¼š</span>
<span class="hljs-comment">// {</span>
<span class="hljs-comment">//   title: string</span>
<span class="hljs-comment">//   description: string</span>
<span class="hljs-comment">//   completed: boolean</span>
<span class="hljs-comment">// }</span>
</code></pre>
<h3 data-id="heading-7">æµ‹è¯•ç”¨ä¾‹</h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/* _____________ æµ‹è¯•ç”¨ä¾‹ _____________ */</span>
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">Equal</span>, <span class="hljs-title class_">Expect</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@type-challenges/utils'</span>

<span class="hljs-keyword">type</span> cases = [
  <span class="hljs-title class_">Expect</span>&lt;<span class="hljs-title class_">Equal</span>&lt;<span class="hljs-title class_">Expected1</span>, <span class="hljs-title class_">MyPick</span>&lt;<span class="hljs-title class_">Todo</span>, <span class="hljs-string">'title'</span>&gt;&gt;&gt;,
  <span class="hljs-title class_">Expect</span>&lt;<span class="hljs-title class_">Equal</span>&lt;<span class="hljs-title class_">Expected2</span>, <span class="hljs-title class_">MyPick</span>&lt;<span class="hljs-title class_">Todo</span>, <span class="hljs-string">'title'</span> | <span class="hljs-string">'completed'</span>&gt;&gt;&gt;,
  <span class="hljs-comment">// @ts-expect-error</span>
  <span class="hljs-title class_">MyPick</span>&lt;<span class="hljs-title class_">Todo</span>, <span class="hljs-string">'title'</span> | <span class="hljs-string">'completed'</span> | <span class="hljs-string">'invalid'</span>&gt;,
]

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Todo</span> {
  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">description</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">completed</span>: <span class="hljs-built_in">boolean</span>
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Expected1</span> {
  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Expected2</span> {
  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">completed</span>: <span class="hljs-built_in">boolean</span>
}

</code></pre>
<h3 data-id="heading-8">ç›¸å…³é“¾æ¥</h3>
<blockquote>
<p>åˆ†äº«ä½ çš„è§£ç­”ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftsch.js.org%2F4%2Fanswer%2Fzh-CN" target="_blank" title="https://tsch.js.org/4/answer/zh-CN" ref="nofollow noopener noreferrer">tsch.js.org/4/answer/zhâ€¦</a>
æŸ¥çœ‹è§£ç­”ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftsch.js.org%2F4%2Fsolutions" target="_blank" title="https://tsch.js.org/4/solutions" ref="nofollow noopener noreferrer">tsch.js.org/4/solutions</a>
æ›´å¤šé¢˜ç›®ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftsch.js.org%2Fzh-CN" target="_blank" title="https://tsch.js.org/zh-CN" ref="nofollow noopener noreferrer">tsch.js.org/zh-CN</a></p>
</blockquote>
<p>ä¸‹é¢æ˜¯æˆ‘çš„å…¬ä¼—å·ï¼Œæ¬¢è¿å…³æ³¨ã€‚å…³æ³¨åæœ‰æ–°çš„åŠŸèƒ½ç‚¹ä¼šåŠæ—¶æ”¶åˆ°æ¨é€ã€‚</p>
<blockquote>
<p>å®æˆ˜ä¸ºç‹ï¼ä¸“æ³¨äºæ±‡æ€»å„ç§åŠŸèƒ½ç‚¹ï¼Œè‡´åŠ›äºæ‰“é€ ä¸€ç³»åˆ—èƒ½å¤Ÿå¸®åŠ©å·¥ç¨‹å¸ˆå®ç°å„ç§åŠŸèƒ½çš„æƒ³æ³•æ€è·¯çš„ä¼˜è´¨æ–‡ç« ã€‚</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4bdeec99a0154e7aa73c1c6765f3dcf0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZnhzcw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770164884&amp;x-signature=70Iyq95gOTR5H2mpi%2FZVvT8B%2Fic%3D" alt="å‰ç«¯åŠŸèƒ½ç‚¹" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¬¬8ç« ã€æŒ‡é’ˆä¸å†…å­˜ç®¡ç†â€”â€”ç†è§£Goçš„åº•å±‚æœºåˆ¶]]></title>    <link>https://juejin.cn/post/7599868109085851690</link>    <guid>https://juejin.cn/post/7599868109085851690</guid>    <pubDate>2026-01-28T00:35:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599868109085851690" data-draft-id="7599929684020887571" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¬¬8ç« ã€æŒ‡é’ˆä¸å†…å­˜ç®¡ç†â€”â€”ç†è§£Goçš„åº•å±‚æœºåˆ¶"/> <meta itemprop="keywords" content="åç«¯,Go"/> <meta itemprop="datePublished" content="2026-01-28T00:35:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ€•æµªçŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/2832784963939438"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¬¬8ç« ã€æŒ‡é’ˆä¸å†…å­˜ç®¡ç†â€”â€”ç†è§£Goçš„åº•å±‚æœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2832784963939438/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ€•æµªçŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T00:35:04.000Z" title="Wed Jan 28 2026 00:35:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï½ å‰é¢æˆ‘ä»¬å­¦ä¹ äº†Goçš„åŸºç¡€ç±»å‹ã€å‡½æ•°å’Œå¤åˆç±»å‹ï¼Œä»Šå¤©ç»ˆäºè¦æ·±å…¥Goçš„â€œåº•å±‚æ ¸å¿ƒâ€â€”â€”æŒ‡é’ˆä¸å†…å­˜ç®¡ç†ã€‚æŒ‡é’ˆæ˜¯è¿æ¥ä»£ç ä¸å†…å­˜çš„æ¡¥æ¢ï¼Œç†è§£æŒ‡é’ˆå°±èƒ½çœ‹æ‡‚æ•°æ®åœ¨å†…å­˜ä¸­çš„å­˜å‚¨ä¸ä¼ é€’é€»è¾‘ï¼›è€Œå†…å­˜ç®¡ç†ï¼ˆå°¤å…¶æ˜¯é€ƒé€¸åˆ†æå’Œåƒåœ¾å›æ”¶ï¼‰æ˜¯Goå®ç°â€œé«˜æ•ˆå¹¶å‘â€å’Œâ€œè‡ªåŠ¨å†…å­˜ç®¡ç†â€çš„å…³é”®ï¼Œç›´æ¥å†³å®šäº†ä»£ç çš„æ€§èƒ½ã€‚</p>
<p>å¾ˆå¤šæ–°æ‰‹ä¼šè§‰å¾—æŒ‡é’ˆå’Œå†…å­˜ç®¡ç†â€œé«˜æ·±éš¾æ‡‚â€ï¼Œå…¶å®åªè¦æŠ“ä½â€œå†…å­˜åœ°å€â€å’Œâ€œæ•°æ®å­˜å‚¨â€ä¸¤ä¸ªæ ¸å¿ƒï¼Œå°±èƒ½è½»æ¾å…¥é—¨ã€‚æœ¬æ–‡ä¼šä»â€œæŒ‡é’ˆåŸºç¡€è¯­æ³•â€å¼€å§‹ï¼Œé€æ­¥æ‹†è§£å†…å­˜åˆ†é…ã€é€ƒé€¸åˆ†æã€åƒåœ¾å›æ”¶ç­‰åº•å±‚æœºåˆ¶ï¼Œå…¨ç¨‹æ­é…ä»£ç ç¤ºä¾‹ï¼Œå¸®ä½ å½»åº•ææ‡‚Goçš„å†…å­˜é€»è¾‘ï¼Œé¿å¼€å®é™…å¼€å‘ä¸­çš„æ€§èƒ½é™·é˜±ã€‚</p>
<h2 data-id="heading-0">1. æŒ‡é’ˆçš„åŸºæœ¬è¯­æ³•ä¸ä½¿ç”¨åœºæ™¯</h2>
<p>æŒ‡é’ˆçš„æ ¸å¿ƒä½œç”¨æ˜¯â€œæŒ‡å‘å˜é‡çš„å†…å­˜åœ°å€â€ï¼Œé€šè¿‡æŒ‡é’ˆå¯ä»¥é—´æ¥æ“ä½œå˜é‡çš„å€¼ã€‚ç®€å•æ¥è¯´ï¼Œ<strong>å˜é‡å­˜å‚¨çš„æ˜¯â€œæ•°æ®æœ¬èº«â€ï¼ŒæŒ‡é’ˆå­˜å‚¨çš„æ˜¯â€œæ•°æ®çš„å†…å­˜åœ°å€â€</strong>ã€‚Goçš„æŒ‡é’ˆè®¾è®¡æ¯”C/C++ç®€å•ï¼ˆä¸æ”¯æŒæŒ‡é’ˆè¿ç®—ï¼‰ï¼Œå®‰å…¨æ€§æ›´é«˜ï¼ŒåŒæ—¶ä¿ç•™äº†æŒ‡é’ˆçš„æ ¸å¿ƒä»·å€¼ã€‚</p>
<h3 data-id="heading-1">1.1 æŒ‡é’ˆçš„åŸºæœ¬è¯­æ³•</h3>
<p>Goä¸­æŒ‡é’ˆçš„æ ¸å¿ƒè¯­æ³•æœ‰ä¸‰ä¸ªï¼šå®šä¹‰æŒ‡é’ˆã€å–åœ°å€ã€è§£å¼•ç”¨ï¼š</p>
<ul>
<li>
<p><strong>å®šä¹‰æŒ‡é’ˆ</strong>ï¼š<code>*T</code> è¡¨ç¤ºâ€œæŒ‡å‘Tç±»å‹å˜é‡çš„æŒ‡é’ˆç±»å‹â€ï¼ˆå¦‚<code>*int</code>æ˜¯æŒ‡å‘intå˜é‡çš„æŒ‡é’ˆï¼‰ï¼›</p>
</li>
<li>
<p><strong>å–åœ°å€</strong>ï¼š<code>&amp;å˜é‡å</code> è¡¨ç¤ºâ€œè·å–å˜é‡çš„å†…å­˜åœ°å€â€ï¼Œè¿”å›å€¼æ˜¯æŒ‡é’ˆç±»å‹ï¼›</p>
</li>
<li>
<p><strong>è§£å¼•ç”¨</strong>ï¼š<code>*æŒ‡é’ˆå˜é‡</code> è¡¨ç¤ºâ€œé€šè¿‡æŒ‡é’ˆåœ°å€è®¿é—®å¯¹åº”çš„å˜é‡â€ï¼Œå¯ä»¥è¯»å–æˆ–ä¿®æ”¹å˜é‡çš„å€¼ã€‚</p>
</li>
</ul>
<p>ä»£ç ç¤ºä¾‹ï¼šæŒ‡é’ˆçš„åŸºæœ¬æ“ä½œ</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 1. å®šä¹‰æ™®é€šå˜é‡</span>
    a := <span class="hljs-number">10</span>
    fmt.Printf(<span class="hljs-string">"å˜é‡açš„å€¼ï¼š%d\n"</span>, a)          <span class="hljs-comment">// è¾“å‡ºï¼šå˜é‡açš„å€¼ï¼š10</span>
    fmt.Printf(<span class="hljs-string">"å˜é‡açš„å†…å­˜åœ°å€ï¼š%p\n"</span>, &amp;a)   <span class="hljs-comment">// è¾“å‡ºï¼šå˜é‡açš„å†…å­˜åœ°å€ï¼š0xc00001a0a8ï¼ˆåœ°å€å€¼å› ç¯å¢ƒè€Œå¼‚ï¼‰</span>

    <span class="hljs-comment">// 2. å®šä¹‰æŒ‡é’ˆå˜é‡ï¼ŒæŒ‡å‘açš„åœ°å€</span>
    <span class="hljs-keyword">var</span> p *<span class="hljs-type">int</span> = &amp;a
    fmt.Printf(<span class="hljs-string">"æŒ‡é’ˆpçš„å€¼ï¼ˆå³açš„åœ°å€ï¼‰ï¼š%p\n"</span>, p) <span class="hljs-comment">// è¾“å‡ºï¼šæŒ‡é’ˆpçš„å€¼ï¼ˆå³açš„åœ°å€ï¼‰ï¼š0xc00001a0a8</span>
    fmt.Printf(<span class="hljs-string">"æŒ‡é’ˆpçš„ç±»å‹ï¼š%T\n"</span>, p)          <span class="hljs-comment">// è¾“å‡ºï¼šæŒ‡é’ˆpçš„ç±»å‹ï¼š*int</span>

    <span class="hljs-comment">// 3. è§£å¼•ç”¨ï¼šé€šè¿‡æŒ‡é’ˆè®¿é—®å˜é‡açš„å€¼</span>
    fmt.Printf(<span class="hljs-string">"é€šè¿‡æŒ‡é’ˆpè®¿é—®açš„å€¼ï¼š%d\n"</span>, *p)  <span class="hljs-comment">// è¾“å‡ºï¼šé€šè¿‡æŒ‡é’ˆpè®¿é—®açš„å€¼ï¼š10</span>

    <span class="hljs-comment">// 4. è§£å¼•ç”¨ï¼šé€šè¿‡æŒ‡é’ˆä¿®æ”¹å˜é‡açš„å€¼</span>
    *p = <span class="hljs-number">20</span>
    fmt.Printf(<span class="hljs-string">"ä¿®æ”¹åaçš„å€¼ï¼š%d\n"</span>, a)          <span class="hljs-comment">// è¾“å‡ºï¼šä¿®æ”¹åaçš„å€¼ï¼š20</span>
    fmt.Printf(<span class="hljs-string">"é€šè¿‡æŒ‡é’ˆpè®¿é—®ä¿®æ”¹åaçš„å€¼ï¼š%d\n"</span>, *p) <span class="hljs-comment">// è¾“å‡ºï¼šé€šè¿‡æŒ‡é’ˆpè®¿é—®ä¿®æ”¹åaçš„å€¼ï¼š20</span>
}

</code></pre>
<h3 data-id="heading-2">1.2 æŒ‡é’ˆçš„æ ¸å¿ƒä½¿ç”¨åœºæ™¯</h3>
<p>æŒ‡é’ˆçš„æ ¸å¿ƒä»·å€¼æ˜¯â€œé—´æ¥æ“ä½œå˜é‡â€å’Œâ€œå‡å°‘æ•°æ®æ‹·è´â€ï¼Œä¸»è¦åº”ç”¨åœ¨ä»¥ä¸‹åœºæ™¯ï¼š</p>
<h4 data-id="heading-3">1.2.1 åœºæ™¯1ï¼šä¿®æ”¹å‡½æ•°å¤–éƒ¨å˜é‡çš„å€¼</h4>
<p>Goçš„å‡½æ•°å‚æ•°æ˜¯â€œå€¼ä¼ é€’â€ï¼Œå¦‚æœç›´æ¥ä¼ é€’å˜é‡ï¼Œå‡½æ•°å†…éƒ¨ä¿®æ”¹çš„æ˜¯å‰¯æœ¬ï¼Œæ— æ³•å½±å“å¤–éƒ¨å˜é‡ã€‚é€šè¿‡ä¼ é€’æŒ‡é’ˆï¼Œå¯ä»¥è®©å‡½æ•°é—´æ¥ä¿®æ”¹å¤–éƒ¨å˜é‡ï¼š</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-comment">// ä¼ é€’æŒ‡é’ˆï¼šå¯ä»¥ä¿®æ”¹å¤–éƒ¨å˜é‡</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">modifyByPointer</span><span class="hljs-params">(x *<span class="hljs-type">int</span>)</span></span> {
    *x = <span class="hljs-number">100</span> <span class="hljs-comment">// è§£å¼•ç”¨ï¼Œä¿®æ”¹æŒ‡é’ˆæŒ‡å‘çš„å¤–éƒ¨å˜é‡</span>
}

<span class="hljs-comment">// ä¼ é€’å€¼ï¼šæ— æ³•ä¿®æ”¹å¤–éƒ¨å˜é‡ï¼ˆä¿®æ”¹çš„æ˜¯å‰¯æœ¬ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">modifyByValue</span><span class="hljs-params">(x <span class="hljs-type">int</span>)</span></span> {
    x = <span class="hljs-number">200</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    a := <span class="hljs-number">10</span>
    modifyByPointer(&amp;a) <span class="hljs-comment">// ä¼ é€’açš„åœ°å€</span>
    fmt.Println(<span class="hljs-string">"aï¼ˆæŒ‡é’ˆä¿®æ”¹åï¼‰ï¼š"</span>, a) <span class="hljs-comment">// è¾“å‡ºï¼šaï¼ˆæŒ‡é’ˆä¿®æ”¹åï¼‰ï¼š 100</span>

    modifyByValue(a) <span class="hljs-comment">// ä¼ é€’açš„å€¼ï¼ˆå‰¯æœ¬ï¼‰</span>
    fmt.Println(<span class="hljs-string">"aï¼ˆå€¼ä¿®æ”¹åï¼‰ï¼š"</span>, a) <span class="hljs-comment">// è¾“å‡ºï¼šaï¼ˆå€¼ä¿®æ”¹åï¼‰ï¼š 100ï¼ˆæ— å˜åŒ–ï¼‰</span>
}

</code></pre>
<h4 data-id="heading-4">1.2.2 åœºæ™¯2ï¼šä¼ é€’å¤§ç»“æ„ä½“ï¼Œå‡å°‘æ‹·è´å¼€é”€</h4>
<p>ç»“æ„ä½“æ˜¯å€¼ç±»å‹ï¼Œä¼ é€’å¤§ç»“æ„ä½“æ—¶ï¼Œä¼šæ‹·è´æ•´ä¸ªç»“æ„ä½“æ•°æ®ï¼Œæ•ˆç‡æä½ã€‚ä¼ é€’ç»“æ„ä½“æŒ‡é’ˆï¼Œåªéœ€æ‹·è´8å­—èŠ‚ï¼ˆ64ä½ç³»ç»Ÿï¼‰çš„åœ°å€ï¼Œå¤§å¹…æå‡æ€§èƒ½ï¼š</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"time"</span>
)

<span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªå¤§ç»“æ„ä½“ï¼ˆ100ä¸ªintå­—æ®µï¼‰</span>
<span class="hljs-keyword">type</span> BigStruct <span class="hljs-keyword">struct</span> {
    data [<span class="hljs-number">100</span>]<span class="hljs-type">int</span>
}

<span class="hljs-comment">// ä¼ é€’ç»“æ„ä½“æŒ‡é’ˆ</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">processByPointer</span><span class="hljs-params">(bs *BigStruct)</span></span> {
    bs.data[<span class="hljs-number">0</span>] = <span class="hljs-number">100</span> <span class="hljs-comment">// æ“ä½œæŒ‡é’ˆæŒ‡å‘çš„ç»“æ„ä½“</span>
}

<span class="hljs-comment">// ä¼ é€’ç»“æ„ä½“å€¼</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">processByValue</span><span class="hljs-params">(bs BigStruct)</span></span> {
    bs.data[<span class="hljs-number">0</span>] = <span class="hljs-number">200</span> <span class="hljs-comment">// æ“ä½œå‰¯æœ¬</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    bs := BigStruct{}

    <span class="hljs-comment">// æµ‹è¯•ä¼ é€’æŒ‡é’ˆçš„è€—æ—¶</span>
    start1 := time.Now()
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++ {
        processByPointer(&amp;bs)
    }
    fmt.Printf(<span class="hljs-string">"ä¼ é€’æŒ‡é’ˆè€—æ—¶ï¼š%v\n"</span>, time.Since(start1)) <span class="hljs-comment">// çº¦0.5msï¼ˆå› ç¯å¢ƒè€Œå¼‚ï¼‰</span>

    <span class="hljs-comment">// æµ‹è¯•ä¼ é€’å€¼çš„è€—æ—¶</span>
    start2 := time.Now()
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++ {
        processByValue(bs)
    }
    fmt.Printf(<span class="hljs-string">"ä¼ é€’å€¼è€—æ—¶ï¼š%v\n"</span>, time.Since(start2)) <span class="hljs-comment">// çº¦50msï¼ˆå› ç¯å¢ƒè€Œå¼‚ï¼‰</span>
}

</code></pre>
<p>ç»“è®ºï¼šä¼ é€’å¤§ç»“æ„ä½“æ—¶ï¼ŒæŒ‡é’ˆæ¯”å€¼ä¼ é€’æ•ˆç‡é«˜100å€ä»¥ä¸Šï¼ˆå…·ä½“æ¯”ä¾‹å› ç»“æ„ä½“å¤§å°è€Œå¼‚ï¼‰ã€‚</p>
<h4 data-id="heading-5">1.2.3 åœºæ™¯3ï¼šå®ç°å¤šè¿”å›å€¼çš„â€œä¿®æ”¹å‹â€é€»è¾‘</h4>
<p>è™½ç„¶Goæ”¯æŒå¤šè¿”å›å€¼ï¼Œä½†å¯¹äºâ€œéœ€è¦ä¿®æ”¹å¤šä¸ªå¤–éƒ¨å˜é‡â€çš„åœºæ™¯ï¼Œç”¨æŒ‡é’ˆä¼ é€’æ›´ç®€æ´ï¼ˆé¿å…è¿”å›å¤šä¸ªå€¼åé‡æ–°èµ‹å€¼ï¼‰ï¼š</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-comment">// é€šè¿‡æŒ‡é’ˆåŒæ—¶ä¿®æ”¹ä¸¤ä¸ªå¤–éƒ¨å˜é‡</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">updateValues</span><span class="hljs-params">(x, y *<span class="hljs-type">int</span>)</span></span> {
    *x += <span class="hljs-number">10</span>
    *y *= <span class="hljs-number">2</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    a, b := <span class="hljs-number">5</span>, <span class="hljs-number">3</span>
    updateValues(&amp;a, &amp;b)
    fmt.Println(<span class="hljs-string">"a:"</span>, a, <span class="hljs-string">"b:"</span>, b) <span class="hljs-comment">// è¾“å‡ºï¼ša: 15 b: 6</span>
}

</code></pre>
<h2 data-id="heading-6">2. æŒ‡é’ˆçš„é›¶å€¼ä¸ç©ºæŒ‡é’ˆé£é™©</h2>
<p>Goä¸­æ‰€æœ‰å˜é‡éƒ½æœ‰é›¶å€¼ï¼ˆé»˜è®¤å€¼ï¼‰ï¼ŒæŒ‡é’ˆçš„é›¶å€¼æ˜¯<code>nil</code>ï¼ˆç©ºæŒ‡é’ˆï¼‰ï¼Œè¡¨ç¤ºâ€œæŒ‡é’ˆæœªæŒ‡å‘ä»»ä½•å†…å­˜åœ°å€â€ã€‚ç©ºæŒ‡é’ˆçš„æ ¸å¿ƒé£é™©æ˜¯â€œè§£å¼•ç”¨ç©ºæŒ‡é’ˆä¼šè§¦å‘è¿è¡Œæ—¶é”™è¯¯â€ï¼Œè¿™æ˜¯Goä¸­æœ€å¸¸è§çš„è¿è¡Œæ—¶é”™è¯¯ä¹‹ä¸€ã€‚</p>
<h3 data-id="heading-7">2.1 æŒ‡é’ˆçš„é›¶å€¼ç¤ºä¾‹</h3>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">var</span> p *<span class="hljs-type">int</span> <span class="hljs-comment">// æœªåˆå§‹åŒ–çš„æŒ‡é’ˆï¼Œé›¶å€¼ä¸ºnil</span>
    fmt.Printf(<span class="hljs-string">"æŒ‡é’ˆpçš„å€¼ï¼š%p\n"</span>, p) <span class="hljs-comment">// è¾“å‡ºï¼šæŒ‡é’ˆpçš„å€¼ï¼š0x0ï¼ˆnilæŒ‡é’ˆçš„åœ°å€æ˜¯0ï¼‰</span>
    fmt.Printf(<span class="hljs-string">"p == nilï¼š%t\n"</span>, p == <span class="hljs-literal">nil</span>) <span class="hljs-comment">// è¾“å‡ºï¼šp == nilï¼štrue</span>

    <span class="hljs-comment">// é”™è¯¯ï¼šè§£å¼•ç”¨ç©ºæŒ‡é’ˆï¼ˆè¿è¡Œæ—¶é”™è¯¯ï¼‰</span>
    <span class="hljs-comment">// *p = 10 // fatal error: nil pointer dereference</span>
}

</code></pre>
<h3 data-id="heading-8">2.2 ç©ºæŒ‡é’ˆé£é™©çš„è§„é¿æ–¹æ¡ˆ</h3>
<p>è§„é¿ç©ºæŒ‡é’ˆé”™è¯¯çš„æ ¸å¿ƒåŸåˆ™æ˜¯ï¼š<strong>è§£å¼•ç”¨æŒ‡é’ˆå‰ï¼Œå¿…é¡»å…ˆåˆ¤æ–­æŒ‡é’ˆæ˜¯å¦ä¸ºnil</strong>ã€‚</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-comment">// å®‰å…¨çš„æŒ‡é’ˆæ“ä½œå‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">safeModify</span><span class="hljs-params">(p *<span class="hljs-type">int</span>, value <span class="hljs-type">int</span>)</span></span> {
    <span class="hljs-comment">// å…ˆåˆ¤æ–­æŒ‡é’ˆæ˜¯å¦ä¸ºnil</span>
    <span class="hljs-keyword">if</span> p == <span class="hljs-literal">nil</span> {
        fmt.Println(<span class="hljs-string">"é”™è¯¯ï¼šæŒ‡é’ˆä¸ºnilï¼Œæ— æ³•ä¿®æ”¹"</span>)
        <span class="hljs-keyword">return</span>
    }
    *p = value <span class="hljs-comment">// å®‰å…¨è§£å¼•ç”¨</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">var</span> p *<span class="hljs-type">int</span>
    safeModify(p, <span class="hljs-number">10</span>) <span class="hljs-comment">// è¾“å‡ºï¼šé”™è¯¯ï¼šæŒ‡é’ˆä¸ºnilï¼Œæ— æ³•ä¿®æ”¹</span>

    a := <span class="hljs-number">5</span>
    safeModify(&amp;a, <span class="hljs-number">10</span>)
    fmt.Println(<span class="hljs-string">"a:"</span>, a) <span class="hljs-comment">// è¾“å‡ºï¼ša: 10</span>
}

</code></pre>
<h3 data-id="heading-9">2.3 å¸¸è§ç©ºæŒ‡é’ˆåœºæ™¯ä¸é¢„é˜²</h3>
<p>å®é™…å¼€å‘ä¸­ï¼Œç©ºæŒ‡é’ˆé”™è¯¯å¤šå‡ºç°ä»¥ä¸‹åœºæ™¯ï¼Œéœ€é‡ç‚¹é¢„é˜²ï¼š</p>
<h4 data-id="heading-10">2.3.1 åœºæ™¯1ï¼šå‡½æ•°è¿”å›nilæŒ‡é’ˆï¼Œå¤–éƒ¨ç›´æ¥è§£å¼•ç”¨</h4>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-comment">// å¯èƒ½è¿”å›nilæŒ‡é’ˆçš„å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">getPointer</span><span class="hljs-params">(flag <span class="hljs-type">bool</span>)</span></span> *<span class="hljs-type">int</span> {
    <span class="hljs-keyword">if</span> flag {
        a := <span class="hljs-number">10</span>
        <span class="hljs-keyword">return</span> &amp;a
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span> <span class="hljs-comment">// æ¡ä»¶ä¸æ»¡è¶³æ—¶è¿”å›nil</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    p := getPointer(<span class="hljs-literal">false</span>)
    <span class="hljs-comment">// é”™è¯¯ï¼šæœªåˆ¤æ–­nilç›´æ¥è§£å¼•ç”¨</span>
    <span class="hljs-comment">// fmt.Println(*p) // fatal error: nil pointer dereference</span>

    <span class="hljs-comment">// æ­£ç¡®ï¼šå…ˆåˆ¤æ–­nil</span>
    <span class="hljs-keyword">if</span> p != <span class="hljs-literal">nil</span> {
        fmt.Println(*p)
    } <span class="hljs-keyword">else</span> {
        fmt.Println(<span class="hljs-string">"æŒ‡é’ˆä¸ºnil"</span>)
    }
}

</code></pre>
<h4 data-id="heading-11">2.3.2 åœºæ™¯2ï¼šç»“æ„ä½“æŒ‡é’ˆå­—æ®µæœªåˆå§‹åŒ–</h4>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> {
    Name *<span class="hljs-type">string</span> <span class="hljs-comment">// æŒ‡é’ˆå­—æ®µ</span>
    Age  <span class="hljs-type">int</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">var</span> u User <span class="hljs-comment">// ç»“æ„ä½“é›¶å€¼åˆå§‹åŒ–ï¼ŒNameå­—æ®µä¸ºnil</span>
    <span class="hljs-comment">// é”™è¯¯ï¼šè§£å¼•ç”¨nilçš„Nameå­—æ®µ</span>
    <span class="hljs-comment">// fmt.Println(*u.Name) // fatal error: nil pointer dereference</span>

    <span class="hljs-comment">// æ­£ç¡®ï¼šå…ˆåˆå§‹åŒ–æŒ‡é’ˆå­—æ®µ</span>
    name := <span class="hljs-string">"Alice"</span>
    u.Name = &amp;name
    fmt.Println(*u.Name) <span class="hljs-comment">// è¾“å‡ºï¼šAlice</span>
}

</code></pre>
<h2 data-id="heading-12">3. newå‡½æ•°ä¸å†…å­˜åˆ†é…</h2>
<p>Goæä¾›<code>new(T)</code>å‡½æ•°ç”¨äºâ€œåˆ†é…å†…å­˜â€ï¼šå®ƒä¼šä¸ºTç±»å‹çš„å˜é‡åˆ†é…ä¸€å—é›¶å€¼åˆå§‹åŒ–çš„å†…å­˜ï¼Œç„¶åè¿”å›æŒ‡å‘è¿™å—å†…å­˜çš„æŒ‡é’ˆï¼ˆç±»å‹ä¸º<code>*T</code>ï¼‰ã€‚newå‡½æ•°æ˜¯Goä¸­æœ€åŸºç¡€çš„å†…å­˜åˆ†é…æ–¹å¼ä¹‹ä¸€ï¼Œæ ¸å¿ƒä½œç”¨æ˜¯â€œå¿«é€Ÿåˆ›å»ºä¸€ä¸ªé›¶å€¼çš„æŒ‡é’ˆå˜é‡â€ã€‚</p>
<h3 data-id="heading-13">3.1 newå‡½æ•°çš„åŸºæœ¬ç”¨æ³•</h3>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 1. ç”¨newåˆ›å»ºintæŒ‡é’ˆï¼ˆåˆ†é…å†…å­˜ï¼Œé›¶å€¼åˆå§‹åŒ–ï¼‰</span>
    p1 := <span class="hljs-built_in">new</span>(<span class="hljs-type">int</span>)
    fmt.Printf(<span class="hljs-string">"p1çš„ç±»å‹ï¼š%T\n"</span>, p1) <span class="hljs-comment">// è¾“å‡ºï¼šp1çš„ç±»å‹ï¼š*int</span>
    fmt.Printf(<span class="hljs-string">"p1çš„å€¼ï¼ˆå†…å­˜åœ°å€ï¼‰ï¼š%p\n"</span>, p1) <span class="hljs-comment">// è¾“å‡ºï¼šp1çš„å€¼ï¼ˆå†…å­˜åœ°å€ï¼‰ï¼š0xc00001a0a8</span>
    fmt.Printf(<span class="hljs-string">"p1æŒ‡å‘çš„å€¼ï¼ˆé›¶å€¼ï¼‰ï¼š%d\n"</span>, *p1) <span class="hljs-comment">// è¾“å‡ºï¼šp1æŒ‡å‘çš„å€¼ï¼ˆé›¶å€¼ï¼‰ï¼š0</span>

    <span class="hljs-comment">// 2. ä¿®æ”¹newåˆ›å»ºçš„å˜é‡çš„å€¼</span>
    *p1 = <span class="hljs-number">100</span>
    fmt.Printf(<span class="hljs-string">"ä¿®æ”¹åp1æŒ‡å‘çš„å€¼ï¼š%d\n"</span>, *p1) <span class="hljs-comment">// è¾“å‡ºï¼šä¿®æ”¹åp1æŒ‡å‘çš„å€¼ï¼š100</span>

    <span class="hljs-comment">// 3. ç”¨newåˆ›å»ºç»“æ„ä½“æŒ‡é’ˆ</span>
    <span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> {
        Name <span class="hljs-type">string</span>
        Age  <span class="hljs-type">int</span>
    }
    p2 := <span class="hljs-built_in">new</span>(User)
    fmt.Printf(<span class="hljs-string">"p2çš„ç±»å‹ï¼š%T\n"</span>, p2) <span class="hljs-comment">// è¾“å‡ºï¼šp2çš„ç±»å‹ï¼š*main.User</span>
    fmt.Printf(<span class="hljs-string">"p2æŒ‡å‘çš„ç»“æ„ä½“ï¼ˆé›¶å€¼ï¼‰ï¼š%+v\n"</span>, *p2) <span class="hljs-comment">// è¾“å‡ºï¼šp2æŒ‡å‘çš„ç»“æ„ä½“ï¼ˆé›¶å€¼ï¼‰ï¼š{Name: Age:0}</span>

    <span class="hljs-comment">// ä¿®æ”¹ç»“æ„ä½“å­—æ®µ</span>
    p2.Name = <span class="hljs-string">"Bob"</span>
    p2.Age = <span class="hljs-number">25</span>
    fmt.Printf(<span class="hljs-string">"ä¿®æ”¹åp2æŒ‡å‘çš„ç»“æ„ä½“ï¼š%+v\n"</span>, *p2) <span class="hljs-comment">// è¾“å‡ºï¼šä¿®æ”¹åp2æŒ‡å‘çš„ç»“æ„ä½“ï¼š{Name:Bob Age:25}</span>
}

</code></pre>
<h3 data-id="heading-14">3.2 newå‡½æ•°çš„æ ¸å¿ƒç‰¹æ€§</h3>
<ul>
<li>
<p>è¿”å›å€¼æ˜¯æŒ‡é’ˆï¼šnew(T)è¿”å›çš„æ˜¯<code>*T</code>ç±»å‹ï¼Œç›´æ¥æŒ‡å‘åˆ†é…çš„å†…å­˜ï¼›</p>
</li>
<li>
<p>å†…å­˜é›¶å€¼åˆå§‹åŒ–ï¼šåˆ†é…çš„å†…å­˜ä¼šè¢«åˆå§‹åŒ–ä¸ºTç±»å‹çš„é›¶å€¼ï¼ˆå¦‚inté›¶å€¼0ï¼Œstringé›¶å€¼""ï¼‰ï¼›</p>
</li>
<li>
<p>é€‚ç”¨äºæ‰€æœ‰ç±»å‹ï¼šå¯ä»¥ä¸ºåŸºæœ¬ç±»å‹ã€ç»“æ„ä½“ã€æ•°ç»„ç­‰ä»»æ„ç±»å‹åˆ†é…å†…å­˜ï¼›</p>
</li>
<li>
<p>ç®€æ´é«˜æ•ˆï¼šæ¯”â€œå…ˆå®šä¹‰å˜é‡å†å–åœ°å€â€æ›´ç®€æ´ï¼ˆå¦‚<code>p := new(int)</code> ç­‰ä»·äº <code>var a int; p := </code>&amp;aï¼‰ã€‚</p>
</li>
</ul>
<h3 data-id="heading-15">3.3 newå‡½æ•°çš„ä½¿ç”¨åœºæ™¯</h3>
<p>newå‡½æ•°é€‚åˆâ€œå¿«é€Ÿåˆ›å»ºä¸€ä¸ªé›¶å€¼çš„æŒ‡é’ˆå˜é‡â€ï¼Œå°¤å…¶æ˜¯ä»¥ä¸‹åœºæ™¯ï¼š</p>
<ul>
<li>
<p>åˆ›å»ºåŸºæœ¬ç±»å‹çš„æŒ‡é’ˆï¼ˆå¦‚<code>*int</code>ã€<code>*string</code>ï¼‰ï¼Œé¿å…æ‰‹åŠ¨å®šä¹‰å˜é‡å†å–åœ°å€ï¼›</p>
</li>
<li>
<p>åˆ›å»ºç»“æ„ä½“æŒ‡é’ˆï¼Œå¿«é€Ÿåˆå§‹åŒ–ä¸€ä¸ªé›¶å€¼ç»“æ„ä½“ï¼ˆåç»­å†ä¿®æ”¹å­—æ®µï¼‰ï¼›</p>
</li>
<li>
<p>åœ¨å‡½æ•°å†…éƒ¨åˆ›å»ºä¸´æ—¶å˜é‡çš„æŒ‡é’ˆï¼Œè¿”å›ç»™å¤–éƒ¨ä½¿ç”¨ï¼ˆç¡®ä¿å˜é‡åˆ†é…åœ¨å †ä¸Šï¼Œé¿å…æ ˆé€ƒé€¸é—®é¢˜ï¼Œåç»­ç« èŠ‚è®²è§£ï¼‰ã€‚</p>
</li>
</ul>
<h2 data-id="heading-16">4. makeä¸newçš„åŒºåˆ«å¯¹æ¯”</h2>
<p>Goä¸­çš„<code>make</code>å’Œ<code>new</code>éƒ½æ˜¯å†…å­˜åˆ†é…ç›¸å…³çš„å‡½æ•°ï¼Œä½†å®ƒä»¬çš„ä½œç”¨ã€é€‚ç”¨ç±»å‹å’Œè¿”å›å€¼å®Œå…¨ä¸åŒï¼Œæ–°æ‰‹å¾ˆå®¹æ˜“æ··æ·†ã€‚æœ¬èŠ‚å°†ä»å¤šä¸ªç»´åº¦å¯¹æ¯”ä¸¤è€…çš„åŒºåˆ«ï¼Œå¹¶ç»™å‡ºä½¿ç”¨åœºæ™¯å»ºè®®ã€‚</p>
<h3 data-id="heading-17">4.1 æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”è¡¨</h3>



































<table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>newå‡½æ•°</th><th>makeå‡½æ•°</th></tr></thead><tbody><tr><td>æ ¸å¿ƒä½œç”¨</td><td>ä¸ºä»»æ„ç±»å‹åˆ†é…é›¶å€¼å†…å­˜ï¼Œè¿”å›æŒ‡é’ˆ</td><td>ä¸ºåˆ‡ç‰‡ã€mapã€chanåˆ†é…å†…å­˜å¹¶åˆå§‹åŒ–ï¼ˆéé›¶å€¼ï¼‰ï¼Œè¿”å›åŸç±»å‹</td></tr><tr><td>é€‚ç”¨ç±»å‹</td><td>æ‰€æœ‰ç±»å‹ï¼ˆåŸºæœ¬ç±»å‹ã€ç»“æ„ä½“ã€æ•°ç»„ç­‰ï¼‰</td><td>ä»…åˆ‡ç‰‡ï¼ˆsliceï¼‰ã€æ˜ å°„ï¼ˆmapï¼‰ã€é€šé“ï¼ˆchanï¼‰</td></tr><tr><td>è¿”å›å€¼ç±»å‹</td><td>æŒ‡é’ˆç±»å‹ï¼ˆ*Tï¼‰</td><td>åŸç±»å‹ï¼ˆTï¼Œå¦‚[]intã€map[string]intï¼‰</td></tr><tr><td>å†…å­˜åˆå§‹åŒ–</td><td>é›¶å€¼åˆå§‹åŒ–ï¼ˆå¦‚intä¸º0ï¼Œstringä¸º""ï¼‰</td><td>éé›¶å€¼åˆå§‹åŒ–ï¼ˆå¦‚åˆ‡ç‰‡åˆå§‹åŒ–lenå’Œcapï¼Œmapåˆå§‹åŒ–å“ˆå¸Œè¡¨ï¼‰</td></tr><tr><td>ä½¿ç”¨åœºæ™¯</td><td>å¿«é€Ÿåˆ›å»ºåŸºæœ¬ç±»å‹/ç»“æ„ä½“çš„æŒ‡é’ˆ</td><td>åˆ›å»ºå¯ç›´æ¥ä½¿ç”¨çš„åˆ‡ç‰‡ã€mapã€chanï¼ˆé¿å…nilçŠ¶æ€ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-18">4.2 ä»£ç ç¤ºä¾‹ï¼šmakeä¸newçš„å®é™…åŒºåˆ«</h3>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 1. newå‡½æ•°çš„ä½¿ç”¨ï¼šè¿”å›æŒ‡é’ˆï¼Œé›¶å€¼åˆå§‹åŒ–</span>
    p1 := <span class="hljs-built_in">new</span>([]<span class="hljs-type">int</span>) <span class="hljs-comment">// è¿”å›*[]intç±»å‹ï¼ˆåˆ‡ç‰‡æŒ‡é’ˆï¼‰</span>
    fmt.Printf(<span class="hljs-string">"new([]int)è¿”å›ç±»å‹ï¼š%T\n"</span>, p1) <span class="hljs-comment">// è¾“å‡ºï¼šnew([]int)è¿”å›ç±»å‹ï¼š*[]int</span>
    fmt.Printf(<span class="hljs-string">"p1æŒ‡å‘çš„åˆ‡ç‰‡ï¼ˆé›¶å€¼ï¼‰ï¼š%+v\n"</span>, *p1) <span class="hljs-comment">// è¾“å‡ºï¼šp1æŒ‡å‘çš„åˆ‡ç‰‡ï¼ˆé›¶å€¼ï¼‰ï¼š[]ï¼ˆnilåˆ‡ç‰‡ï¼‰</span>
    <span class="hljs-comment">// *p1 = append(*p1, 10) // å¯ä»¥ä½¿ç”¨ï¼Œä½†éœ€è¦è§£å¼•ç”¨ï¼Œéº»çƒ¦</span>

    <span class="hljs-comment">// 2. makeå‡½æ•°çš„ä½¿ç”¨ï¼šè¿”å›åˆ‡ç‰‡ç±»å‹ï¼Œéé›¶å€¼åˆå§‹åŒ–</span>
    s1 := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>) <span class="hljs-comment">// è¿”å›[]intç±»å‹ï¼Œlen=0ï¼Œcap=5</span>
    fmt.Printf(<span class="hljs-string">"make([]int,0,5)è¿”å›ç±»å‹ï¼š%T\n"</span>, s1) <span class="hljs-comment">// è¾“å‡ºï¼šmake([]int,0,5)è¿”å›ç±»å‹ï¼š[]int</span>
    fmt.Printf(<span class="hljs-string">"s1çš„lenå’Œcapï¼š%d, %d\n"</span>, <span class="hljs-built_in">len</span>(s1), <span class="hljs-built_in">cap</span>(s1)) <span class="hljs-comment">// è¾“å‡ºï¼šs1çš„lenå’Œcapï¼š0, 5</span>
    s1 = <span class="hljs-built_in">append</span>(s1, <span class="hljs-number">10</span>) <span class="hljs-comment">// å¯ç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€è§£å¼•ç”¨</span>
    fmt.Println(<span class="hljs-string">"s1:"</span>, s1) <span class="hljs-comment">// è¾“å‡ºï¼šs1: [10]</span>

    <span class="hljs-comment">// 3. newåˆ›å»ºmapï¼ˆè¿”å›æŒ‡é’ˆï¼Œé›¶å€¼ä¸ºnilï¼‰</span>
    p2 := <span class="hljs-built_in">new</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>)
    fmt.Printf(<span class="hljs-string">"new(map[string]int)è¿”å›ç±»å‹ï¼š%T\n"</span>, p2) <span class="hljs-comment">// è¾“å‡ºï¼šnew(map[string]int)è¿”å›ç±»å‹ï¼š*map[string]int</span>
    <span class="hljs-comment">// (*p2)["a"] = 1 // è¿è¡Œæ—¶é”™è¯¯ï¼šassignment to entry in nil mapï¼ˆæŒ‡é’ˆæŒ‡å‘çš„mapæ˜¯nilï¼‰</span>

    <span class="hljs-comment">// 4. makeåˆ›å»ºmapï¼ˆè¿”å›mapç±»å‹ï¼Œå·²åˆå§‹åŒ–ï¼‰</span>
    m1 := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>, <span class="hljs-number">5</span>)
    fmt.Printf(<span class="hljs-string">"make(map[string]int,5)è¿”å›ç±»å‹ï¼š%T\n"</span>, m1) <span class="hljs-comment">// è¾“å‡ºï¼šmake(map[string]int,5)è¿”å›ç±»å‹ï¼šmap[string]int</span>
    m1[<span class="hljs-string">"a"</span>] = <span class="hljs-number">1</span> <span class="hljs-comment">// å¯ç›´æ¥ä½¿ç”¨</span>
    fmt.Println(<span class="hljs-string">"m1:"</span>, m1) <span class="hljs-comment">// è¾“å‡ºï¼šm1: map[a:1]</span>
}

</code></pre>
<h3 data-id="heading-19">4.3 ä½¿ç”¨åœºæ™¯å»ºè®®</h3>
<ul>
<li>
<p>åˆ›å»ºåˆ‡ç‰‡ã€mapã€chanï¼š<strong>ä¼˜å…ˆç”¨make</strong>ï¼Œç›´æ¥è¿”å›å¯ä½¿ç”¨çš„ç±»å‹ï¼Œé¿å…nilçŠ¶æ€ï¼›</p>
</li>
<li>
<p>åˆ›å»ºåŸºæœ¬ç±»å‹ï¼ˆintã€stringç­‰ï¼‰æˆ–ç»“æ„ä½“çš„æŒ‡é’ˆï¼š<strong>ç”¨new</strong>ï¼Œç®€æ´é«˜æ•ˆï¼›</p>
</li>
<li>
<p>é¿å…ç”¨newåˆ›å»ºåˆ‡ç‰‡ã€mapã€chanï¼šè¿”å›çš„æŒ‡é’ˆæŒ‡å‘nilçš„åˆ‡ç‰‡/map/chanï¼Œä½¿ç”¨å‰è¿˜éœ€æ‰‹åŠ¨åˆå§‹åŒ–ï¼Œç¹çä¸”æ˜“å‡ºé”™ã€‚</p>
</li>
</ul>
<h2 data-id="heading-20">5. æ ˆå†…å­˜ä¸å †å†…å­˜çš„åˆ†é…æœºåˆ¶</h2>
<p>Goçš„å†…å­˜åˆ†ä¸ºâ€œæ ˆå†…å­˜â€å’Œâ€œå †å†…å­˜â€ï¼Œä¸¤è€…çš„åˆ†é…æœºåˆ¶ã€è®¿é—®æ•ˆç‡å’Œç”Ÿå‘½å‘¨æœŸå®Œå…¨ä¸åŒã€‚ç†è§£æ ˆå’Œå †çš„åŒºåˆ«ï¼Œæ˜¯ç†è§£Goå†…å­˜ç®¡ç†å’Œæ€§èƒ½ä¼˜åŒ–çš„åŸºç¡€ã€‚</p>
<h3 data-id="heading-21">5.1 æ ˆå†…å­˜çš„æ ¸å¿ƒç‰¹æ€§</h3>
<p>æ ˆå†…å­˜æ˜¯â€œçº¿ç¨‹ç§æœ‰çš„â€ï¼Œéµå¾ªâ€œå…ˆè¿›åå‡ºâ€ï¼ˆLIFOï¼‰çš„åˆ†é…è§„åˆ™ï¼Œä¸»è¦ç”¨äºå­˜å‚¨å‡½æ•°çš„å±€éƒ¨å˜é‡å’Œå‚æ•°ã€‚</p>
<ul>
<li>
<p><strong>åˆ†é…ä¸é‡Šæ”¾</strong>ï¼šç”±ç¼–è¯‘å™¨è‡ªåŠ¨ç®¡ç†ï¼Œæ— éœ€å¼€å‘è€…å¹²é¢„ã€‚å‡½æ•°è°ƒç”¨æ—¶ï¼Œå±€éƒ¨å˜é‡å’Œå‚æ•°è¢«å‹å…¥æ ˆï¼›å‡½æ•°è¿”å›æ—¶ï¼Œæ ˆç©ºé—´è‡ªåŠ¨é‡Šæ”¾ï¼ˆå¼¹å‡ºï¼‰ï¼Œæ•ˆç‡æé«˜ï¼ˆO(1)æ—¶é—´å¤æ‚åº¦ï¼‰ï¼›</p>
</li>
<li>
<p><strong>è®¿é—®æ•ˆç‡</strong>ï¼šæ ˆå†…å­˜æ˜¯è¿ç»­çš„ï¼ŒCPUç¼“å­˜å‘½ä¸­ç‡é«˜ï¼Œè®¿é—®é€Ÿåº¦å¿«ï¼›</p>
</li>
<li>
<p><strong>å†…å­˜å¤§å°</strong>ï¼šæ ˆå†…å­˜å¤§å°å›ºå®šï¼ˆé»˜è®¤å‡ MBï¼‰ï¼Œè¶…å‡ºä¼šè§¦å‘â€œæ ˆæº¢å‡ºâ€ï¼ˆstack overflowï¼‰é”™è¯¯ï¼›</p>
</li>
<li>
<p><strong>å­˜å‚¨å†…å®¹</strong>ï¼šå‡½æ•°å±€éƒ¨å˜é‡ã€å‚æ•°ã€è¿”å›å€¼ç­‰çŸ­æœŸå­˜åœ¨çš„å˜é‡ã€‚</p>
</li>
</ul>
<h3 data-id="heading-22">5.2 å †å†…å­˜çš„æ ¸å¿ƒç‰¹æ€§</h3>
<p>å †å†…å­˜æ˜¯â€œè¿›ç¨‹å…±äº«çš„â€ï¼Œæ²¡æœ‰å›ºå®šçš„åˆ†é…è§„åˆ™ï¼Œä¸»è¦ç”¨äºå­˜å‚¨éœ€è¦é•¿æœŸå­˜åœ¨ï¼ˆè·¨å‡½æ•°è°ƒç”¨ï¼‰çš„å˜é‡ã€‚</p>
<ul>
<li>
<p><strong>åˆ†é…ä¸é‡Šæ”¾</strong>ï¼šç”±Goçš„åƒåœ¾å›æ”¶ï¼ˆGCï¼‰æœºåˆ¶ç®¡ç†ã€‚å¼€å‘è€…åªéœ€ç”³è¯·å†…å­˜ï¼ŒGCä¼šè‡ªåŠ¨è¯†åˆ«å¹¶å›æ”¶â€œä¸å†è¢«å¼•ç”¨â€çš„å †å†…å­˜ï¼Œæ•ˆç‡ä½äºæ ˆï¼›</p>
</li>
<li>
<p><strong>è®¿é—®æ•ˆç‡</strong>ï¼šå †å†…å­˜æ˜¯ä¸è¿ç»­çš„ï¼ŒCPUç¼“å­˜å‘½ä¸­ç‡ä½ï¼Œè®¿é—®é€Ÿåº¦æ¯”æ ˆæ…¢ï¼›</p>
</li>
<li>
<p><strong>å†…å­˜å¤§å°</strong>ï¼šå †å†…å­˜å¤§å°ä¸å›ºå®šï¼ˆå¯åŠ¨æ€æ‰©å±•ï¼Œå—é™äºç‰©ç†å†…å­˜ï¼‰ï¼Œé€‚åˆå­˜å‚¨å¤§æ•°æ®ï¼›</p>
</li>
<li>
<p><strong>å­˜å‚¨å†…å®¹</strong>ï¼šè·¨å‡½æ•°è°ƒç”¨çš„å˜é‡ã€å¤§ç»“æ„ä½“ã€åˆ‡ç‰‡/mapçš„åº•å±‚æ•°ç»„ç­‰ã€‚</p>
</li>
</ul>
<h3 data-id="heading-23">5.3 å˜é‡åˆ†é…åœ¨æ ˆè¿˜æ˜¯å †ï¼Ÿæ ¸å¿ƒè§„åˆ™</h3>
<p>Goçš„ç¼–è¯‘å™¨ä¼šé€šè¿‡â€œé€ƒé€¸åˆ†æâ€ï¼ˆåç»­ç« èŠ‚è®²è§£ï¼‰è‡ªåŠ¨å†³å®šå˜é‡åˆ†é…åœ¨æ ˆè¿˜æ˜¯å †ä¸Šï¼Œæ ¸å¿ƒè§„åˆ™å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p><strong>é»˜è®¤åˆ†é…åœ¨æ ˆä¸Š</strong>ï¼šå‡½æ•°çš„å±€éƒ¨å˜é‡å’Œå‚æ•°ï¼Œé»˜è®¤åˆ†é…åœ¨æ ˆä¸Šï¼›</p>
</li>
<li>
<p><strong>é€ƒé€¸åˆ°å †ä¸Šçš„æƒ…å†µ</strong>ï¼š</p>
<ul>
<li>
<p>å˜é‡è¢«å‡½æ•°è¿”å›ï¼ˆè·¨å‡½æ•°è°ƒç”¨ï¼Œæ ˆç©ºé—´é‡Šæ”¾åä»éœ€ä½¿ç”¨ï¼‰ï¼›</p>
</li>
<li>
<p>å˜é‡è¢«æŒ‡é’ˆå¼•ç”¨å¹¶ä¼ é€’åˆ°å‡½æ•°å¤–éƒ¨ï¼ˆå¤–éƒ¨å¯èƒ½ä¿®æ”¹æˆ–è®¿é—®ï¼‰ï¼›</p>
</li>
<li>
<p>å˜é‡å¤§å°è¶…è¿‡æ ˆçš„é™åˆ¶ï¼ˆå¦‚å¤§ç»“æ„ä½“ã€å¤§æ•°ç»„ï¼‰ï¼›</p>
</li>
<li>
<p>åˆ‡ç‰‡ã€mapã€chançš„åº•å±‚æ•°ç»„ï¼ˆå› åŠ¨æ€æ‰©å®¹ï¼Œéœ€è¦çµæ´»çš„å†…å­˜ç©ºé—´ï¼‰ã€‚</p>
</li>
</ul>
</li>
</ol>
<h3 data-id="heading-24">5.4 ä»£ç ç¤ºä¾‹ï¼šæ ˆä¸å †çš„åˆ†é…æ¼”ç¤º</h3>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-comment">// å˜é‡è¢«è¿”å›ï¼Œé€ƒé€¸åˆ°å †ä¸Š</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">createInt</span><span class="hljs-params">()</span></span> *<span class="hljs-type">int</span> {
    a := <span class="hljs-number">10</span> <span class="hljs-comment">// å› è¢«è¿”å›ï¼Œåˆ†é…åœ¨å †ä¸Š</span>
    <span class="hljs-keyword">return</span> &amp;a
}

<span class="hljs-comment">// å˜é‡æœªè¢«è¿”å›ï¼Œåˆ†é…åœ¨æ ˆä¸Š</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">useInt</span><span class="hljs-params">()</span></span> {
    b := <span class="hljs-number">20</span> <span class="hljs-comment">// åˆ†é…åœ¨æ ˆä¸Šï¼Œå‡½æ•°è¿”å›åé‡Šæ”¾</span>
    fmt.Println(b)
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    p := createInt() <span class="hljs-comment">// pæŒ‡å‘å †ä¸Šçš„å˜é‡</span>
    fmt.Println(*p)  <span class="hljs-comment">// å‡½æ•°è¿”å›åä»å¯è®¿é—®</span>

    useInt() <span class="hljs-comment">// å‡½æ•°è¿”å›åï¼Œbçš„æ ˆç©ºé—´é‡Šæ”¾</span>
}

</code></pre>
<p>éªŒè¯æ–¹æ³•ï¼šé€šè¿‡Goç¼–è¯‘å™¨çš„<code>-gcflags="-m"</code>å‚æ•°æŸ¥çœ‹é€ƒé€¸åˆ†æç»“æœï¼ˆåç»­ç« èŠ‚è¯¦ç»†è®²è§£ï¼‰ï¼š</p>
<pre><code class="hljs language-Plain" lang="Plain">
go run -gcflags="-m" main.go
# command-line-arguments
./main.go:6:2: moved to heap: a // æç¤ºï¼šaå˜é‡è¢«ç§»åŠ¨åˆ°å †ä¸Š
./main.go:12:2: b does not escape // æç¤ºï¼šbå˜é‡æœªé€ƒé€¸ï¼ˆåˆ†é…åœ¨æ ˆä¸Šï¼‰
10
20

</code></pre>
<h2 data-id="heading-25">6. é€ƒé€¸åˆ†æï¼šå˜é‡ä½•æ—¶åˆ†é…åœ¨å †ä¸Š</h2>
<p>é€ƒé€¸åˆ†æï¼ˆEscape Analysisï¼‰æ˜¯Goç¼–è¯‘å™¨çš„æ ¸å¿ƒä¼˜åŒ–æŠ€æœ¯ï¼Œå®ƒçš„ä½œç”¨æ˜¯â€œåˆ†æå˜é‡çš„ç”Ÿå‘½å‘¨æœŸå’Œå¼•ç”¨èŒƒå›´â€ï¼Œä»è€Œå†³å®šå˜é‡åˆ†é…åœ¨æ ˆä¸Šè¿˜æ˜¯å †ä¸Šã€‚é€ƒé€¸åˆ†æçš„ç›®æ ‡æ˜¯â€œå°½å¯èƒ½å°†å˜é‡åˆ†é…åœ¨æ ˆä¸Šâ€ï¼ˆæå‡æ•ˆç‡ï¼Œå‡å°‘GCå‹åŠ›ï¼‰ï¼Œåªæœ‰åœ¨å¿…è¦æ—¶æ‰åˆ†é…åœ¨å †ä¸Šã€‚</p>
<h3 data-id="heading-26">6.1 é€ƒé€¸åˆ†æçš„æ ¸å¿ƒåŸç†</h3>
<p>Goç¼–è¯‘å™¨åœ¨ç¼–è¯‘é˜¶æ®µè¿›è¡Œé€ƒé€¸åˆ†æï¼Œä¸»è¦é€šè¿‡ä»¥ä¸‹è§„åˆ™åˆ¤æ–­å˜é‡æ˜¯å¦é€ƒé€¸ï¼š</p>
<ol>
<li>
<p><strong>è§„åˆ™1ï¼šå˜é‡è¢«è¿”å›ç»™å¤–éƒ¨</strong>ï¼šå¦‚æœå˜é‡çš„æŒ‡é’ˆè¢«å‡½æ•°è¿”å›ï¼Œä¸”å¤–éƒ¨ä¼šä½¿ç”¨è¯¥æŒ‡é’ˆï¼Œå˜é‡ä¼šé€ƒé€¸åˆ°å †ä¸Šï¼ˆæ ˆç©ºé—´é‡Šæ”¾åå˜é‡ä»éœ€å­˜åœ¨ï¼‰ï¼›</p>
</li>
<li>
<p><strong>è§„åˆ™2ï¼šå˜é‡è¢«å¤–éƒ¨æŒ‡é’ˆå¼•ç”¨</strong>ï¼šå¦‚æœå˜é‡è¢«å­˜å‚¨åˆ°å¤–éƒ¨çš„æŒ‡é’ˆå˜é‡ï¼ˆå¦‚å…¨å±€æŒ‡é’ˆã€ç»“æ„ä½“æŒ‡é’ˆå­—æ®µï¼‰ä¸­ï¼Œå˜é‡ä¼šé€ƒé€¸åˆ°å †ä¸Šï¼›</p>
</li>
<li>
<p><strong>è§„åˆ™3ï¼šå˜é‡å¤§å°è¶…è¿‡æ ˆé™åˆ¶</strong>ï¼šå¦‚æœå˜é‡æ˜¯å¤§ç»“æ„ä½“ã€å¤§æ•°ç»„ï¼ˆå¤§å°è¶…è¿‡æ ˆçš„é»˜è®¤é™åˆ¶ï¼Œé€šå¸¸æ˜¯å‡ KBï¼‰ï¼Œä¼šé€ƒé€¸åˆ°å †ä¸Šï¼›</p>
</li>
<li>
<p><strong>è§„åˆ™4ï¼šåŠ¨æ€ç±»å‹å˜é‡</strong>ï¼šå¦‚interface{}ç±»å‹çš„å˜é‡ï¼ˆéœ€è¦åŠ¨æ€åˆ¤æ–­ç±»å‹ï¼‰ï¼Œå¯èƒ½é€ƒé€¸åˆ°å †ä¸Šï¼›</p>
</li>
<li>
<p><strong>è§„åˆ™5ï¼šåˆ‡ç‰‡ã€mapã€chançš„åº•å±‚æ•°æ®</strong>ï¼šåˆ‡ç‰‡ã€mapã€chançš„åº•å±‚æ•°ç»„/å“ˆå¸Œè¡¨ï¼Œå› å¯èƒ½åŠ¨æ€æ‰©å®¹ï¼Œé»˜è®¤é€ƒé€¸åˆ°å †ä¸Šã€‚</p>
</li>
</ol>
<h3 data-id="heading-27">6.2 å¦‚ä½•æŸ¥çœ‹é€ƒé€¸åˆ†æç»“æœ</h3>
<p>Goæä¾›<code>-gcflags="-m"</code>å‚æ•°ï¼Œåœ¨ç¼–è¯‘æ—¶è¾“å‡ºé€ƒé€¸åˆ†æç»“æœã€‚<code>-m</code>å¯ä»¥é‡å¤å¤šæ¬¡ï¼ˆå¦‚<code>-m -m</code>ï¼‰ï¼Œè¾“å‡ºæ›´è¯¦ç»†çš„åˆ†æè¿‡ç¨‹ã€‚</p>
<p>ç¤ºä¾‹ï¼šæŸ¥çœ‹é€ƒé€¸åˆ†æç»“æœ</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-comment">// main.go</span>
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> {
    Name <span class="hljs-type">string</span>
    Age  <span class="hljs-type">int</span>
}

<span class="hljs-comment">// è§„åˆ™1ï¼šè¿”å›å˜é‡æŒ‡é’ˆï¼Œé€ƒé€¸åˆ°å †</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">returnPointer</span><span class="hljs-params">()</span></span> *User {
    u := User{Name: <span class="hljs-string">"Alice"</span>, Age: <span class="hljs-number">25</span>}
    <span class="hljs-keyword">return</span> &amp;u
}

<span class="hljs-comment">// è§„åˆ™2ï¼šå˜é‡å­˜å‚¨åˆ°å¤–éƒ¨æŒ‡é’ˆï¼Œé€ƒé€¸åˆ°å †</span>
<span class="hljs-keyword">var</span> globalPtr *<span class="hljs-type">int</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">storeToGlobal</span><span class="hljs-params">()</span></span> {
    a := <span class="hljs-number">10</span>
    globalPtr = &amp;a
}

<span class="hljs-comment">// è§„åˆ™3ï¼šå¤§æ•°ç»„ï¼Œé€ƒé€¸åˆ°å †</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">bigArray</span><span class="hljs-params">()</span></span> {
    arr := [<span class="hljs-number">10000</span>]<span class="hljs-type">int</span>{} <span class="hljs-comment">// å¤§æ•°ç»„ï¼Œè¶…è¿‡æ ˆé™åˆ¶</span>
    arr[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>
}

<span class="hljs-comment">// è§„åˆ™4ï¼šinterface{}ç±»å‹å˜é‡ï¼Œé€ƒé€¸åˆ°å †</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">interfaceVar</span><span class="hljs-params">()</span></span> {
    a := <span class="hljs-number">20</span>
    <span class="hljs-keyword">var</span> i <span class="hljs-keyword">interface</span>{} = a <span class="hljs-comment">// åŠ¨æ€ç±»å‹ï¼Œé€ƒé€¸</span>
    fmt.Println(i)
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    p := returnPointer()
    fmt.Println(p)

    storeToGlobal()
    fmt.Println(*globalPtr)

    bigArray()

    interfaceVar()
}

</code></pre>
<p>è¿è¡Œå‘½ä»¤æŸ¥çœ‹ç»“æœï¼š</p>
<pre><code class="hljs language-Plain" lang="Plain">
go run -gcflags="-m" main.go
# command-line-arguments
./main.go:11:2: moved to heap: u // è§„åˆ™1ï¼šué€ƒé€¸åˆ°å †
./main.go:18:2: moved to heap: a // è§„åˆ™2ï¼šaé€ƒé€¸åˆ°å †
./main.go:24:2: moved to heap: arr // è§„åˆ™3ï¼šarré€ƒé€¸åˆ°å †
./main.go:30:2: a escapes to heap // è§„åˆ™4ï¼šaé€ƒé€¸åˆ°å †
./main.go:31:13: i escapes to heap
./main.go:37:13: p escapes to heap
./main.go:40:13: *globalPtr escapes to heap
./main.go:31:14: fmt.Println(i) escapes to heap
./main.go:37:14: fmt.Println(p) escapes to heap
./main.go:40:14: fmt.Println(*globalPtr) escapes to heap
&amp;{Alice 25}
10
20

</code></pre>
<h3 data-id="heading-28">6.3 é€ƒé€¸åˆ†æçš„å®é™…æ„ä¹‰</h3>
<p>é€ƒé€¸åˆ†æå¯¹ä»£ç æ€§èƒ½è‡³å…³é‡è¦ï¼Œç†è§£å®ƒèƒ½å¸®åŠ©æˆ‘ä»¬å†™å‡ºæ›´é«˜æ•ˆçš„ä»£ç ï¼š</p>
<ul>
<li>
<p><strong>å‡å°‘GCå‹åŠ›</strong>ï¼šå˜é‡åˆ†é…åœ¨æ ˆä¸Šï¼Œå‡½æ•°è¿”å›åè‡ªåŠ¨é‡Šæ”¾ï¼Œæ— éœ€GCå›æ”¶ï¼›è‹¥é€ƒé€¸åˆ°å †ä¸Šï¼Œä¼šå¢åŠ GCçš„æ‰«æå’Œå›æ”¶å¼€é”€ï¼›</p>
</li>
<li>
<p><strong>æå‡è®¿é—®æ•ˆç‡</strong>ï¼šæ ˆå†…å­˜çš„è®¿é—®é€Ÿåº¦æ¯”å †å¿«ï¼Œå‡å°‘é€ƒé€¸èƒ½æå‡ä»£ç è¿è¡Œé€Ÿåº¦ï¼›</p>
</li>
<li>
<p><strong>é¿å…æ ˆæº¢å‡º</strong>ï¼šå¤§å˜é‡é€ƒé€¸åˆ°å †ä¸Šï¼Œé¿å…å› æ ˆç©ºé—´ä¸è¶³å¯¼è‡´çš„æ ˆæº¢å‡ºé”™è¯¯ã€‚</p>
</li>
</ul>
<h3 data-id="heading-29">6.4 å‡å°‘é€ƒé€¸çš„ä¼˜åŒ–æŠ€å·§</h3>
<ul>
<li>
<p><strong>é¿å…è¿”å›å±€éƒ¨å˜é‡çš„æŒ‡é’ˆ</strong>ï¼šå¦‚æœå˜é‡æ— éœ€è·¨å‡½æ•°ä½¿ç”¨ï¼Œå°½é‡è¿”å›å€¼è€ŒéæŒ‡é’ˆï¼›</p>
</li>
<li>
<p><strong>ç”¨å€¼ä¼ é€’ä»£æ›¿æŒ‡é’ˆä¼ é€’ï¼ˆå°ç»“æ„ä½“ï¼‰</strong>ï¼šå°ç»“æ„ä½“ï¼ˆå¦‚å°äº64å­—èŠ‚ï¼‰çš„å€¼ä¼ é€’å¼€é”€å¾ˆå°ï¼Œæ¯”æŒ‡é’ˆä¼ é€’æ›´é«˜æ•ˆï¼ˆé¿å…é€ƒé€¸ï¼‰ï¼›</p>
</li>
<li>
<p><strong>é¢„åˆ†é…åˆ‡ç‰‡/mapçš„å®¹é‡</strong>ï¼šè™½ç„¶åº•å±‚æ•°æ®ä»ä¼šé€ƒé€¸ï¼Œä½†é¢„åˆ†é…å®¹é‡èƒ½å‡å°‘æ‰©å®¹æ¬¡æ•°ï¼Œé™ä½GCå‹åŠ›ï¼›</p>
</li>
<li>
<p><strong>é¿å…å¤§å˜é‡åœ¨æ ˆä¸Šåˆ†é…</strong>ï¼šå¤§æ•°ç»„ã€å¤§ç»“æ„ä½“å°½é‡ç”¨åˆ‡ç‰‡æˆ–æŒ‡é’ˆï¼Œè®©å…¶é€ƒé€¸åˆ°å †ä¸Šï¼Œé¿å…æ ˆæº¢å‡ºã€‚</p>
</li>
</ul>
<h2 data-id="heading-30">7. æŒ‡é’ˆä½œä¸ºæ–¹æ³•æ¥æ”¶è€…çš„æ„ä¹‰</h2>
<p>åœ¨Goä¸­ï¼Œæ–¹æ³•çš„æ¥æ”¶è€…å¯ä»¥æ˜¯â€œå€¼ç±»å‹â€æˆ–â€œæŒ‡é’ˆç±»å‹â€ã€‚æŒ‡é’ˆä½œä¸ºæ–¹æ³•æ¥æ”¶è€…çš„æ ¸å¿ƒæ„ä¹‰æ˜¯â€œä¿®æ”¹æ¥æ”¶è€…çš„å€¼â€å’Œâ€œé¿å…å€¼æ‹·è´çš„å¼€é”€â€ï¼Œè¿™æ˜¯Goä¸­é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ã€‚</p>
<h3 data-id="heading-31">7.1 æŒ‡é’ˆæ¥æ”¶è€…vså€¼æ¥æ”¶è€…</h3>
<p>ä¸¤è€…çš„æ ¸å¿ƒåŒºåˆ«åœ¨äºâ€œæ˜¯å¦èƒ½ä¿®æ”¹æ¥æ”¶è€…çš„å€¼â€å’Œâ€œè°ƒç”¨æ—¶æ˜¯å¦æ‹·è´æ¥æ”¶è€…â€ï¼š</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> {
    Name <span class="hljs-type">string</span>
    Age  <span class="hljs-type">int</span>
}

<span class="hljs-comment">// å€¼æ¥æ”¶è€…ï¼šæ–¹æ³•å†…éƒ¨æ“ä½œçš„æ˜¯æ¥æ”¶è€…çš„å‰¯æœ¬</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(u User)</span></span> UpdateAgeByValue(newAge <span class="hljs-type">int</span>) {
    u.Age = newAge <span class="hljs-comment">// ä¿®æ”¹çš„æ˜¯å‰¯æœ¬ï¼Œä¸å½±å“åŸå¯¹è±¡</span>
}

<span class="hljs-comment">// æŒ‡é’ˆæ¥æ”¶è€…ï¼šæ–¹æ³•å†…éƒ¨æ“ä½œçš„æ˜¯æ¥æ”¶è€…çš„æŒ‡é’ˆï¼ˆæŒ‡å‘åŸå¯¹è±¡ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(u *User)</span></span> UpdateAgeByPointer(newAge <span class="hljs-type">int</span>) {
    u.Age = newAge <span class="hljs-comment">// ä¿®æ”¹çš„æ˜¯åŸå¯¹è±¡</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    u := User{Name: <span class="hljs-string">"Alice"</span>, Age: <span class="hljs-number">25</span>}

    <span class="hljs-comment">// è°ƒç”¨å€¼æ¥æ”¶è€…æ–¹æ³•</span>
    u.UpdateAgeByValue(<span class="hljs-number">30</span>)
    fmt.Println(<span class="hljs-string">"å€¼æ¥æ”¶è€…ä¿®æ”¹åï¼š"</span>, u.Age) <span class="hljs-comment">// è¾“å‡ºï¼šå€¼æ¥æ”¶è€…ä¿®æ”¹åï¼š 25ï¼ˆæ— å˜åŒ–ï¼‰</span>

    <span class="hljs-comment">// è°ƒç”¨æŒ‡é’ˆæ¥æ”¶è€…æ–¹æ³•</span>
    u.UpdateAgeByPointer(<span class="hljs-number">30</span>)
    fmt.Println(<span class="hljs-string">"æŒ‡é’ˆæ¥æ”¶è€…ä¿®æ”¹åï¼š"</span>, u.Age) <span class="hljs-comment">// è¾“å‡ºï¼šæŒ‡é’ˆæ¥æ”¶è€…ä¿®æ”¹åï¼š 30ï¼ˆå·²ä¿®æ”¹ï¼‰</span>

    <span class="hljs-comment">// æ³¨æ„ï¼šGoä¼šè‡ªåŠ¨è½¬æ¢æ¥æ”¶è€…ç±»å‹</span>
    pu := &amp;u <span class="hljs-comment">// æŒ‡é’ˆç±»å‹</span>
    pu.UpdateAgeByValue(<span class="hljs-number">35</span>) <span class="hljs-comment">// è‡ªåŠ¨å°†æŒ‡é’ˆè½¬æ¢ä¸ºå€¼ï¼ˆæ‹·è´ï¼‰</span>
    fmt.Println(<span class="hljs-string">"æŒ‡é’ˆè°ƒç”¨å€¼æ¥æ”¶è€…ï¼š"</span>, u.Age) <span class="hljs-comment">// è¾“å‡ºï¼šæŒ‡é’ˆè°ƒç”¨å€¼æ¥æ”¶è€…ï¼š 30ï¼ˆæ— å˜åŒ–ï¼‰</span>

    pu.UpdateAgeByPointer(<span class="hljs-number">35</span>) <span class="hljs-comment">// ç›´æ¥è°ƒç”¨æŒ‡é’ˆæ¥æ”¶è€…</span>
    fmt.Println(<span class="hljs-string">"æŒ‡é’ˆè°ƒç”¨æŒ‡é’ˆæ¥æ”¶è€…ï¼š"</span>, u.Age) <span class="hljs-comment">// è¾“å‡ºï¼šæŒ‡é’ˆè°ƒç”¨æŒ‡é’ˆæ¥æ”¶è€…ï¼š 35ï¼ˆå·²ä¿®æ”¹ï¼‰</span>
}

</code></pre>
<h3 data-id="heading-32">7.2 æŒ‡é’ˆæ¥æ”¶è€…çš„ä½¿ç”¨åœºæ™¯</h3>
<p>æŒ‡é’ˆæ¥æ”¶è€…é€‚åˆä»¥ä¸‹åœºæ™¯ï¼š</p>
<h4 data-id="heading-33">7.2.1 åœºæ™¯1ï¼šéœ€è¦ä¿®æ”¹æ¥æ”¶è€…çš„å­—æ®µå€¼</h4>
<p>å¦‚æœæ–¹æ³•çš„æ ¸å¿ƒé€»è¾‘æ˜¯â€œä¿®æ”¹å¯¹è±¡çš„çŠ¶æ€â€ï¼ˆå¦‚æ›´æ–°å­—æ®µå€¼ï¼‰ï¼Œå¿…é¡»ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶è€…ï¼š</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-keyword">type</span> Counter <span class="hljs-keyword">struct</span> {
    Count <span class="hljs-type">int</span>
}

<span class="hljs-comment">// æŒ‡é’ˆæ¥æ”¶è€…ï¼šä¿®æ”¹Countçš„å€¼</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *Counter)</span></span> Increment() {
    c.Count++
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    c := Counter{Count: <span class="hljs-number">0</span>}
    c.Increment()
    c.Increment()
    fmt.Println(<span class="hljs-string">"Count:"</span>, c.Count) <span class="hljs-comment">// è¾“å‡ºï¼šCount: 2</span>
}

</code></pre>
<h4 data-id="heading-34">7.2.2 åœºæ™¯2ï¼šæ¥æ”¶è€…æ˜¯å¤§ç»“æ„ä½“ï¼Œé¿å…æ‹·è´å¼€é”€</h4>
<p>å¤§ç»“æ„ä½“çš„å€¼æ¥æ”¶è€…ä¼šå¯¼è‡´æ–¹æ³•è°ƒç”¨æ—¶æ‹·è´æ•´ä¸ªç»“æ„ä½“ï¼Œæ•ˆç‡æä½ã€‚æŒ‡é’ˆæ¥æ”¶è€…åªéœ€æ‹·è´8å­—èŠ‚çš„åœ°å€ï¼Œå¤§å¹…æå‡æ€§èƒ½ï¼š</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"time"</span>
)

<span class="hljs-keyword">type</span> BigStruct <span class="hljs-keyword">struct</span> {
    data [<span class="hljs-number">10000</span>]<span class="hljs-type">int</span>
}

<span class="hljs-comment">// æŒ‡é’ˆæ¥æ”¶è€…ï¼šæ— æ‹·è´å¼€é”€</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(bs *BigStruct)</span></span> Process() {
    bs.data[<span class="hljs-number">0</span>] = <span class="hljs-number">100</span>
}

<span class="hljs-comment">// å€¼æ¥æ”¶è€…ï¼šæ¯æ¬¡è°ƒç”¨æ‹·è´æ•´ä¸ªç»“æ„ä½“</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(bs BigStruct)</span></span> ProcessByValue() {
    bs.data[<span class="hljs-number">0</span>] = <span class="hljs-number">200</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    bs := BigStruct{}

    <span class="hljs-comment">// æµ‹è¯•æŒ‡é’ˆæ¥æ”¶è€…è€—æ—¶</span>
    start1 := time.Now()
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++ {
        bs.Process()
    }
    fmt.Printf(<span class="hljs-string">"æŒ‡é’ˆæ¥æ”¶è€…è€—æ—¶ï¼š%v\n"</span>, time.Since(start1)) <span class="hljs-comment">// çº¦0.6ms</span>

    <span class="hljs-comment">// æµ‹è¯•å€¼æ¥æ”¶è€…è€—æ—¶</span>
    start2 := time.Now()
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++ {
        bs.ProcessByValue()
    }
    fmt.Printf(<span class="hljs-string">"å€¼æ¥æ”¶è€…è€—æ—¶ï¼š%v\n"</span>, time.Since(start2)) <span class="hljs-comment">// çº¦60ms</span>
}

</code></pre>
<h4 data-id="heading-35">7.2.3 åœºæ™¯3ï¼šæ¥æ”¶è€…æ˜¯æ¥å£ç±»å‹ï¼Œç¡®ä¿å¤šæ€ä¸€è‡´æ€§</h4>
<p>å¦‚æœç»“æ„ä½“éœ€è¦å®ç°æŸä¸ªæ¥å£ï¼Œä¸”æ¥å£æ–¹æ³•çš„æ¥æ”¶è€…æ˜¯æŒ‡é’ˆç±»å‹ï¼Œé‚£ä¹ˆåªæœ‰ç»“æ„ä½“æŒ‡é’ˆèƒ½å®ç°è¯¥æ¥å£ï¼ˆå€¼ç±»å‹æ— æ³•å®ç°ï¼‰ã€‚ä¸ºäº†ä¿è¯å¤šæ€çš„ä¸€è‡´æ€§ï¼Œå»ºè®®ç»Ÿä¸€ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶è€…ï¼š</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-comment">// å®šä¹‰æ¥å£</span>
<span class="hljs-keyword">type</span> Updater <span class="hljs-keyword">interface</span> {
    Update()
}

<span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> {
    Name <span class="hljs-type">string</span>
}

<span class="hljs-comment">// æŒ‡é’ˆæ¥æ”¶è€…å®ç°æ¥å£</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(u *User)</span></span> Update() {
    u.Name = <span class="hljs-string">"Updated"</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">var</span> updater Updater

    <span class="hljs-comment">// ç»“æ„ä½“æŒ‡é’ˆå®ç°æ¥å£</span>
    u := &amp;User{Name: <span class="hljs-string">"Alice"</span>}
    updater = u
    updater.Update()
    fmt.Println(u.Name) <span class="hljs-comment">// è¾“å‡ºï¼šUpdated</span>

    <span class="hljs-comment">// ç»“æ„ä½“å€¼æ— æ³•å®ç°æ¥å£ï¼ˆç¼–è¯‘é”™è¯¯ï¼‰</span>
    <span class="hljs-comment">// u2 := User{Name: "Bob"}</span>
    <span class="hljs-comment">// updater = u2 // cannot use u2 (type User) as type Updater in assignment: User does not implement Updater (Update method has pointer receiver)</span>
}

</code></pre>
<h2 data-id="heading-36">8. å†…å­˜ç®¡ç†ä¸åƒåœ¾å›æ”¶æœºåˆ¶ç®€ä»‹</h2>
<p>Goçš„å†…å­˜ç®¡ç†æ ¸å¿ƒæ˜¯â€œè‡ªåŠ¨å†…å­˜åˆ†é…â€å’Œâ€œè‡ªåŠ¨åƒåœ¾å›æ”¶ï¼ˆGCï¼‰â€ï¼Œå¼€å‘è€…æ— éœ€æ‰‹åŠ¨åˆ†é…å’Œé‡Šæ”¾å†…å­˜ï¼ˆä¸åƒC/C++éœ€è¦è°ƒç”¨mallocå’Œfreeï¼‰ï¼Œå¤§å¹…é™ä½äº†å†…å­˜æ³„æ¼çš„é£é™©ã€‚æœ¬èŠ‚ç®€è¦ä»‹ç»Goçš„å†…å­˜ç®¡ç†å’ŒGCæœºåˆ¶ï¼Œå¸®åŠ©ç†è§£åº•å±‚å·¥ä½œåŸç†ã€‚</p>
<h3 data-id="heading-37">8.1 Goçš„å†…å­˜åˆ†é…æœºåˆ¶</h3>
<p>Goçš„å†…å­˜åˆ†é…é‡‡ç”¨â€œå†…å­˜æ± â€æœºåˆ¶ï¼Œç”±è¿è¡Œæ—¶ï¼ˆruntimeï¼‰ç®¡ç†ï¼Œæ ¸å¿ƒç»„ä»¶åŒ…æ‹¬ï¼š</p>
<ul>
<li>
<p><strong>mspan</strong>ï¼šå†…å­˜åˆ†é…çš„åŸºæœ¬å•å…ƒï¼Œå°†å†…å­˜åˆ’åˆ†ä¸ºä¸åŒå¤§å°çš„å—ï¼ˆå¦‚8å­—èŠ‚ã€16å­—èŠ‚ã€32å­—èŠ‚ç­‰ï¼‰ï¼Œç”¨äºå­˜å‚¨ä¸åŒå¤§å°çš„å˜é‡ï¼›</p>
</li>
<li>
<p><strong>mcache</strong>ï¼šæ¯ä¸ªgoroutineç§æœ‰çš„ç¼“å­˜ï¼Œå­˜å‚¨å°å¯¹è±¡ï¼ˆâ‰¤32KBï¼‰çš„mspanï¼Œå‡å°‘å¹¶å‘ç«äº‰ï¼Œæå‡åˆ†é…æ•ˆç‡ï¼›</p>
</li>
<li>
<p><strong>mcentral</strong>ï¼šå…¨å±€å…±äº«çš„ç¼“å­˜ï¼Œç®¡ç†å¤šä¸ªmspanï¼Œå½“mcacheæ²¡æœ‰å¯ç”¨mspanæ—¶ï¼Œä»mcentralè·å–ï¼›</p>
</li>
<li>
<p><strong>mheap</strong>ï¼šæœ€é¡¶å±‚çš„å†…å­˜ç®¡ç†å™¨ï¼Œç®¡ç†å¤§å¯¹è±¡ï¼ˆ&gt;32KBï¼‰çš„åˆ†é…ï¼ŒåŒæ—¶è´Ÿè´£å‘æ“ä½œç³»ç»Ÿç”³è¯·å†…å­˜å’Œé‡Šæ”¾å†…å­˜ã€‚</p>
</li>
</ul>
<p>åˆ†é…æµç¨‹ç®€è¦ï¼š</p>
<ol>
<li>
<p>å°å¯¹è±¡ï¼ˆâ‰¤32KBï¼‰ï¼šä¼˜å…ˆä»å½“å‰goroutineçš„mcacheåˆ†é…ï¼›</p>
</li>
<li>
<p>ä¸­å¯¹è±¡ï¼ˆ32KB &lt; å¤§å° â‰¤ 1MBï¼‰ï¼šä»mcentralåˆ†é…ï¼›</p>
</li>
<li>
<p>å¤§å¯¹è±¡ï¼ˆ&gt;1MBï¼‰ï¼šä»mheapåˆ†é…ï¼Œç›´æ¥å‘æ“ä½œç³»ç»Ÿç”³è¯·è¿ç»­å†…å­˜ã€‚</p>
</li>
</ol>
<h3 data-id="heading-38">8.2 åƒåœ¾å›æ”¶ï¼ˆGCï¼‰çš„æ ¸å¿ƒåŸç†</h3>
<p>Goçš„GCæ ¸å¿ƒç›®æ ‡æ˜¯â€œå›æ”¶å †ä¸Šä¸å†è¢«å¼•ç”¨çš„å†…å­˜â€ï¼Œå½“å‰ï¼ˆGo 1.19+ï¼‰é‡‡ç”¨çš„æ˜¯â€œå¹¶å‘æ ‡è®°æ¸…é™¤ï¼ˆConcurrent Mark and Sweep, CMSï¼‰â€ç®—æ³•ï¼Œæ ¸å¿ƒæµç¨‹åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p>
<h4 data-id="heading-39">8.2.1 é˜¶æ®µ1ï¼šæ ‡è®°å‡†å¤‡ï¼ˆSTWï¼‰</h4>
<p>STWï¼ˆStop The Worldï¼‰è¡¨ç¤ºâ€œæš‚åœæ‰€æœ‰goroutineâ€ï¼Œç¡®ä¿å†…å­˜çŠ¶æ€ç¨³å®šã€‚æ­¤é˜¶æ®µä¼šï¼š</p>
<ul>
<li>
<p>æš‚åœæ‰€æœ‰ç”¨æˆ·goroutineï¼›</p>
</li>
<li>
<p>åˆå§‹åŒ–æ ‡è®°ç›¸å…³çš„æ•°æ®ç»“æ„ï¼›</p>
</li>
<li>
<p>æ‰«ææ ¹å¯¹è±¡ï¼ˆå¦‚å…¨å±€å˜é‡ã€goroutineçš„æ ˆå˜é‡ã€å¯„å­˜å™¨ä¸­çš„æŒ‡é’ˆç­‰ï¼‰ï¼Œæ ‡è®°ä¸ºâ€œå¯è¾¾â€ã€‚</p>
</li>
</ul>
<p>æ­¤é˜¶æ®µè€—æ—¶æçŸ­ï¼ˆå¾®ç§’çº§ï¼‰ï¼Œå¯¹ç¨‹åºå½±å“å¾ˆå°ã€‚</p>
<h4 data-id="heading-40">8.2.2 é˜¶æ®µ2ï¼šå¹¶å‘æ ‡è®°</h4>
<p>æ¢å¤ç”¨æˆ·goroutineï¼ŒåŒæ—¶åå°GCçº¿ç¨‹å¹¶å‘æ‰«æå †å†…å­˜ï¼š</p>
<ul>
<li>
<p>ä»æ ¹å¯¹è±¡å‡ºå‘ï¼Œé€’å½’æ‰«ææ‰€æœ‰å¯è¾¾çš„å¯¹è±¡ï¼Œæ ‡è®°ä¸ºâ€œå¯è¾¾â€ï¼›</p>
</li>
<li>
<p>ç”¨æˆ·goroutineè¿è¡Œæ—¶ï¼Œè‹¥ä¿®æ”¹æŒ‡é’ˆå¼•ç”¨ï¼ˆå¦‚åˆ é™¤æŒ‡é’ˆã€ä¿®æ”¹æŒ‡é’ˆæŒ‡å‘ï¼‰ï¼Œä¼šé€šè¿‡â€œå†™å±éšœâ€æœºåˆ¶è®°å½•å˜åŒ–ï¼Œç¡®ä¿æ ‡è®°å‡†ç¡®æ€§ï¼›</p>
</li>
<li>
<p>æ­¤é˜¶æ®µç”¨æˆ·goroutineå’ŒGCçº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼Œå‡ ä¹ä¸å½±å“ç¨‹åºè¿è¡Œã€‚</p>
</li>
</ul>
<h4 data-id="heading-41">8.2.3 é˜¶æ®µ3ï¼šæ ‡è®°ç»ˆæ­¢ï¼ˆSTWï¼‰+ å¹¶å‘æ¸…é™¤</h4>
<p>å†æ¬¡æš‚åœæ‰€æœ‰ç”¨æˆ·goroutineï¼Œå®Œæˆæ ‡è®°æ”¶å°¾å·¥ä½œï¼š</p>
<ul>
<li>
<p>å¤„ç†å†™å±éšœè®°å½•çš„æŒ‡é’ˆå˜åŒ–ï¼Œç¡®ä¿æ‰€æœ‰å¯è¾¾å¯¹è±¡éƒ½è¢«æ ‡è®°ï¼›</p>
</li>
<li>
<p>æ¢å¤ç”¨æˆ·goroutineï¼ŒåŒæ—¶åå°GCçº¿ç¨‹å¹¶å‘æ¸…é™¤â€œæœªè¢«æ ‡è®°â€çš„å¯¹è±¡ï¼ˆé‡Šæ”¾å†…å­˜ï¼‰ï¼›</p>
</li>
<li>
<p>æ¸…é™¤åçš„å†…å­˜ä¼šè¢«æ”¾å›å†…å­˜æ± ï¼Œä¾›åç»­åˆ†é…ä½¿ç”¨ã€‚</p>
</li>
</ul>
<h3 data-id="heading-42">8.3 GCçš„ä¼˜åŒ–æ–¹å‘</h3>
<p>è™½ç„¶Goçš„GCå·²ç»å¾ˆé«˜æ•ˆï¼Œä½†ä¸åˆç†çš„ä»£ç ä»å¯èƒ½å¯¼è‡´GCå‹åŠ›è¿‡å¤§ï¼ˆå¦‚é¢‘ç¹åˆ›å»ºå¤§å¯¹è±¡ã€å†…å­˜æ³„æ¼ï¼‰ã€‚å®é™…å¼€å‘ä¸­ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¼˜åŒ–GCï¼š</p>
<ul>
<li>
<p><strong>å‡å°‘å †å†…å­˜åˆ†é…</strong>ï¼šå°½é‡è®©å˜é‡åˆ†é…åœ¨æ ˆä¸Šï¼ˆé¿å…é€ƒé€¸ï¼‰ï¼Œå‡å°‘å †å†…å­˜çš„ä½¿ç”¨ï¼›</p>
</li>
<li>
<p><strong>å¤ç”¨å¯¹è±¡</strong>ï¼šé€šè¿‡å¯¹è±¡æ± ï¼ˆå¦‚sync.Poolï¼‰å¤ç”¨é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çš„å¯¹è±¡ï¼Œå‡å°‘GCæ¬¡æ•°ï¼›</p>
</li>
<li>
<p><strong>é¿å…å†…å­˜æ³„æ¼</strong>ï¼šåŠæ—¶é‡Šæ”¾ä¸å†ä½¿ç”¨çš„æŒ‡é’ˆå¼•ç”¨ï¼ˆå¦‚å°†åˆ‡ç‰‡è®¾ä¸ºnilã€åˆ é™¤mapä¸­çš„æ— ç”¨é”®å€¼å¯¹ï¼‰ï¼›</p>
</li>
<li>
<p><strong>æ§åˆ¶å¤§å¯¹è±¡çš„åˆ›å»º</strong>ï¼šé¢‘ç¹åˆ›å»ºå¤§å¯¹è±¡ä¼šå¯¼è‡´GCæ‰«æå’Œæ¸…é™¤å¼€é”€å¢å¤§ï¼Œå°½é‡åˆå¹¶æˆ–å¤ç”¨å¤§å¯¹è±¡ã€‚</p>
</li>
</ul>
<h2 data-id="heading-43">æ€»ç»“</h2>
<p>æœ¬ç« æˆ‘ä»¬æ·±å…¥è®²è§£äº†Goçš„æŒ‡é’ˆä¸å†…å­˜ç®¡ç†åº•å±‚æœºåˆ¶ï¼Œæ ¸å¿ƒè¦ç‚¹æ€»ç»“å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>æŒ‡é’ˆï¼šå­˜å‚¨å˜é‡çš„å†…å­˜åœ°å€ï¼Œæ”¯æŒå–åœ°å€ï¼ˆ&amp;ï¼‰å’Œè§£å¼•ç”¨ï¼ˆ*ï¼‰æ“ä½œï¼Œæ ¸å¿ƒä½œç”¨æ˜¯ä¿®æ”¹å¤–éƒ¨å˜é‡å’Œå‡å°‘æ•°æ®æ‹·è´ï¼›</p>
</li>
<li>
<p>ç©ºæŒ‡é’ˆé£é™©ï¼šæŒ‡é’ˆé›¶å€¼ä¸ºnilï¼Œè§£å¼•ç”¨nilä¼šè§¦å‘è¿è¡Œæ—¶é”™è¯¯ï¼Œéœ€æå‰åˆ¤æ–­æŒ‡é’ˆæ˜¯å¦ä¸ºnilï¼›</p>
</li>
<li>
<p>newä¸makeï¼šnewä¸ºä»»æ„ç±»å‹åˆ†é…é›¶å€¼å†…å­˜ï¼Œè¿”å›æŒ‡é’ˆï¼›makeä»…ç”¨äºåˆ‡ç‰‡ã€mapã€chanï¼Œè¿”å›åŸç±»å‹å¹¶åˆå§‹åŒ–ï¼›</p>
</li>
<li>
<p>æ ˆä¸å †ï¼šæ ˆå†…å­˜è‡ªåŠ¨åˆ†é…é‡Šæ”¾ï¼Œæ•ˆç‡é«˜ï¼›å †å†…å­˜ç”±GCç®¡ç†ï¼Œé€‚åˆè·¨å‡½æ•°å˜é‡ï¼›</p>
</li>
<li>
<p>é€ƒé€¸åˆ†æï¼šç¼–è¯‘å™¨è‡ªåŠ¨åˆ¤æ–­å˜é‡åˆ†é…åœ¨æ ˆè¿˜æ˜¯å †ï¼Œå‡å°‘é€ƒé€¸èƒ½æå‡æ€§èƒ½ã€é™ä½GCå‹åŠ›ï¼›</p>
</li>
<li>
<p>æŒ‡é’ˆæ¥æ”¶è€…ï¼šç”¨äºä¿®æ”¹ç»“æ„ä½“å­—æ®µæˆ–å‡å°‘å¤§ç»“æ„ä½“æ‹·è´å¼€é”€ï¼Œæ˜¯Goé¢å‘å¯¹è±¡çš„æ ¸å¿ƒç‰¹æ€§ï¼›</p>
</li>
<li>
<p>å†…å­˜ç®¡ç†ä¸GCï¼šGoé€šè¿‡å†…å­˜æ± åˆ†é…å†…å­˜ï¼ŒGCé‡‡ç”¨å¹¶å‘æ ‡è®°æ¸…é™¤ç®—æ³•ï¼Œè‡ªåŠ¨å›æ”¶å †ä¸Šæ— ç”¨å†…å­˜ã€‚</p>
</li>
</ol>
<p>æŒ‡é’ˆä¸å†…å­˜ç®¡ç†æ˜¯Goçš„æ ¸å¿ƒéš¾ç‚¹ï¼Œä¹Ÿæ˜¯å†™å‡ºé«˜æ•ˆä»£ç çš„åŸºç¡€ã€‚å»ºè®®å¤šé€šè¿‡<code>-gcflags="-m"</code>æŸ¥çœ‹é€ƒé€¸åˆ†æç»“æœï¼Œç»“åˆå®é™…ä»£ç ç†è§£å†…å­˜åˆ†é…é€»è¾‘ã€‚åŒæ—¶ï¼Œæ³¨æ„é¿å…å¸¸è§çš„å†…å­˜é—®é¢˜ï¼ˆå¦‚ç©ºæŒ‡é’ˆã€å†…å­˜æ³„æ¼ï¼‰ï¼Œè®©ä»£ç æ—¢å®‰å…¨åˆé«˜æ•ˆã€‚å¦‚æœæœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµï½</p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<ul>
<li>
<p>Goå®˜æ–¹æ–‡æ¡£ - æŒ‡é’ˆï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgo.dev%2Fref%2Fspec%23Pointer_types" target="_blank" title="https://go.dev/ref/spec#Pointer_types" ref="nofollow noopener noreferrer">go.dev/ref/spec#Poâ€¦</a></p>
</li>
<li>
<p>Goå®˜æ–¹æ–‡æ¡£ - newä¸makeï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgo.dev%2Fdoc%2Feffective_go%23allocation_make" target="_blank" title="https://go.dev/doc/effective_go#allocation_make" ref="nofollow noopener noreferrer">go.dev/doc/effectiâ€¦</a></p>
</li>
<li>
<p>Goå®˜æ–¹åšå®¢ - é€ƒé€¸åˆ†æï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgo.dev%2Fblog%2Fescape-analysis" target="_blank" title="https://go.dev/blog/escape-analysis" ref="nofollow noopener noreferrer">go.dev/blog/escapeâ€¦</a></p>
</li>
<li>
<p>Goå®˜æ–¹åšå®¢ - åƒåœ¾å›æ”¶ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgo.dev%2Fblog%2Fismmkeynote" target="_blank" title="https://go.dev/blog/ismmkeynote" ref="nofollow noopener noreferrer">go.dev/blog/ismmkeâ€¦</a></p>
</li>
<li>
<p>Goè¿è¡Œæ—¶æºç  - å†…å­˜ç®¡ç†ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Ftree%2Fmaster%2Fsrc%2Fruntime" target="_blank" title="https://github.com/golang/go/tree/master/src/runtime" ref="nofollow noopener noreferrer">github.com/golang/go/tâ€¦</a></p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI è¯­éŸ³å¼€å‘ï¼ŒVue çš„æ–°é€‰æ‹©]]></title>    <link>https://juejin.cn/post/7599843186203459626</link>    <guid>https://juejin.cn/post/7599843186203459626</guid>    <pubDate>2026-01-28T00:43:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599843186203459626" data-draft-id="7599532624194650164" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI è¯­éŸ³å¼€å‘ï¼ŒVue çš„æ–°é€‰æ‹©Â "/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-28T00:43:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å­¦ä»€ä¹ˆå‰ç«¯"/> <meta itemprop="url" content="https://juejin.cn/user/3825956194889880"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI è¯­éŸ³å¼€å‘ï¼ŒVue çš„æ–°é€‰æ‹©Â 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3825956194889880/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å­¦ä»€ä¹ˆå‰ç«¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T00:43:37.000Z" title="Wed Jan 28 2026 00:43:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸Šå‘¨ï¼Œå°¤é›¨æºªéšæ‰‹è½¬å‘äº†ä¸€ç¯‡æ¨æ–‡ï¼Œä½†æ¨æ–‡çš„å†…å®¹å´æ˜¯å†…æœ‰ä¹¾å¤ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a6c5289fabd4b9ab26cd72170e8d973~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770165817&amp;x-signature=RXSJndkNPCDpbgjYXAImFZpZ%2BHM%3D" alt="image.png" width="70%" loading="lazy"/></p>
<p><strong>ElevenLabs</strong> æ˜¯å¤§åé¼é¼çš„ AI éŸ³é¢‘æ ¸å¿ƒå¹³å°ï¼Œä¸“æ³¨äºè¶…é€¼çœŸ AI è¯­éŸ³åˆæˆï¼ˆTTSï¼‰çš„æŠ€æœ¯å…¬å¸ã€‚</p>
<p>ElevenLabsï¼šæ ¸å¿ƒèƒ½åŠ›ä¸ä»·å€¼</p>
<ul>
<li><code>è¯­éŸ³åˆæˆ</code>ï¼šæ”¯æŒ 70 + è¯­è¨€ï¼Œv3 æ¨¡å‹ä¸»æ‰“é«˜æƒ…æ„Ÿä¸è¡¨ç°åŠ›ï¼ŒMultilingual ç³»åˆ—ä¾§é‡å¤šè¯­è¨€ä¸€è‡´æ€§ã€‚</li>
<li><code>å£°éŸ³å…‹éš†</code>ï¼šå¯å°†éŸ³é¢‘ç”Ÿæˆä¸“å±éŸ³è‰²ï¼Œé€‚ç”¨äºå“ç‰Œå®šåˆ¶ã€è§’è‰²é…éŸ³ç­‰åœºæ™¯ã€‚</li>
<li><code>è¯­éŸ³ä»£ç†</code>ï¼šé€šè¿‡ SDK æ„å»ºå¯å¤„ç†å®¢æœã€é¢„çº¦ç­‰ä»»åŠ¡çš„è¯­éŸ³äº¤äº’ç³»ç»Ÿï¼Œæ”¯æŒå¤šæ¸ é“é›†æˆã€‚</li>
<li><code>å¼€å‘è€…ç”Ÿæ€</code>ï¼šæä¾› <code>REST API</code> ä¸ <code>SDK</code>ï¼Œæ”¯æŒ<code>å‰ç«¯</code> / <code>åç«¯</code>çµæ´»è°ƒç”¨ï¼Œå¿«é€Ÿé›†æˆåˆ°åº”ç”¨ä¸­ã€‚</li>
</ul>
<p>å…¶ç”Ÿæˆçš„è¯­éŸ³ï¼Œè‡ªç„¶åº¦é«˜ï¼Œæƒ…æ„Ÿè¡¨ç°åŠ›å¼ºï¼Œç”¨äº<code>æœ‰å£°ä¹¦</code>ã€<code>æ’­å®¢</code>ã€<code>å®¢æœè¯­éŸ³</code>ã€<code>å†…å®¹é…éŸ³</code>ç­‰æ–¹é¢ï¼Œä¼˜åŠ¿éå¸¸æ˜æ˜¾ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6be7a6599d34c9f80708f073cf6ac3d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770165817&amp;x-signature=pouulvZc%2BKI0oPJD636nX2QlG8w%3D" alt="ElevenLabs" loading="lazy"/></p>
<p>ElevenLabs</p>
<h2 data-id="heading-0">ElevenLabs UI</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2e89ab1af3340fa8e1663f054ca9a19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770165817&amp;x-signature=pW7WFyfqQoqZ%2BhTEmhbqaoMOrXg%3D" alt="" loading="lazy"/></p>
<p>ElevenLabs 2025 å¹´æ¨å‡ºçš„å¼€æºå‰ç«¯ç»„ä»¶åº“ï¼Œé¢å‘ AI éŸ³é¢‘å’Œè¯­éŸ³ä»£ç†çš„å¼€æºç»„ä»¶ã€‚</p>
<ul>
<li><code>æŠ€æœ¯èƒŒæ™¯</code>ï¼š åŸºäº <code>shadcn/ui</code> æ„å»ºï¼Œæ”¯æŒ <code>React</code>ã€‚</li>
<li><code>æ ¸å¿ƒåŠŸèƒ½</code>ï¼š <code>20+</code> ç°æˆçš„ UI ç»„ä»¶ï¼ˆå¦‚ï¼šæ’­æ”¾å™¨ã€èŠå¤©ç•Œé¢ç­‰ï¼‰ï¼Œè®©å¼€å‘è€…å¿«é€Ÿæ„å»ºè‡ªå·±çš„éŸ³é¢‘ç½‘ç«™å’Œç›¸å…³åŠŸèƒ½ã€‚</li>
<li><code>å¼€æºæ€§è´¨</code>ï¼š <code>MIT</code> è®¸å¯ï¼Œå¯è‡ªç”±ä½¿ç”¨ã€‚</li>
</ul>
<h2 data-id="heading-1">ElevenLabs UI Vue</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b54ac81000c94d4f9ce877e5a53d39b4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770165817&amp;x-signature=i1y4NBTGeFQAlhmjYr0kjFU33OY%3D" alt="" loading="lazy"/></p>
<p>è€Œ <code>ElevenLabs UI Vue</code>ï¼Œåˆ™æ˜¯ 1æœˆ22æ—¥éš†é‡æ¨å‡ºé¢å‘ <code>Vue/Nuxt</code> å¼€å‘è€…çš„ ElevenLabs UI ç»„ä»¶çš„ Vue ç‰ˆæœ¬ğŸ”¥</p>
<ul>
<li>åŸºäº <code>shadcn/ui</code>ï¼Œé«˜åº¦å®šåˆ¶åŒ–ï¼Œå¯ä»¥è‡ªç”±ä¿®æ”¹ã€‚</li>
<li>å®Œå…¨æ”¯æŒ <code>Vue3</code> å’Œ <code>Nuxtjs</code>ã€‚</li>
<li>è¶…è¿‡ <code>20</code> ä¸ªç»„ä»¶å’Œç¤ºä¾‹ï¼Œæ¶µç›–èŠå¤©ç•Œé¢ã€è½¬å½•ã€éŸ³ä¹ç­‰é¢†åŸŸã€‚</li>
<li>ä¸ ElevenLabs API æ— ç¼é›†æˆ</li>
<li>å…¼å®¹ <code>Vite/Webpack</code> æ„å»ºå·¥å…·ï¼Œæ”¯æŒ <code>TypeScript</code> ç±»å‹æç¤º</li>
</ul>
<p><code>ElevenLabs UI Vue</code> çš„æ¨å‡ºï¼Œå¼¥è¡¥äº† Vue ç”Ÿæ€è¿™è¿™ä¸€å—çš„ç¼ºå¤±ã€‚</p>
<h2 data-id="heading-2">å¦‚ä½•ä½¿ç”¨ï¼Ÿ</h2>
<ol>
<li>å°†ç»„ä»¶æºç ä¸‹è½½åˆ°é¡¹ç›®</li>
</ol>

<pre><code class="hljs language-sql" lang="sql">pnpmÂ dlxÂ elevenlabs<span class="hljs-operator">-</span>ui<span class="hljs-operator">-</span>vue<span class="hljs-variable">@latest</span>Â <span class="hljs-keyword">add</span>Â orb
</code></pre>
<p>ä½¿ç”¨ Nuxt çš„è¯ï¼Œåˆ™éœ€è¦é…ç½® <code>Shadcn-Nuxt</code> æ¨¡å—</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">exportÂ defaultÂ defineNuxtConfig</span>({
Â Â //Â ...
<span class="hljs-attr">Â Â modules</span>:Â [<span class="hljs-string">'shadcn-nuxt'</span>],
<span class="hljs-attr">Â Â shadcn</span>:Â {
<span class="hljs-attr">Â Â Â Â prefix</span>:Â <span class="hljs-string">''</span>,
<span class="hljs-attr">Â Â Â Â componentDir</span>:Â [
Â Â Â Â Â Â <span class="hljs-string">'@/components/ui'</span>,
Â Â Â Â Â Â //Â ElevenlabsÂ UI
Â Â Â Â Â Â {
<span class="hljs-attr">Â Â Â Â Â Â Â Â path</span>:Â <span class="hljs-string">'@/components/elevenlabs-ui'</span>,
<span class="hljs-attr">Â Â Â Â Â Â Â Â prefix</span>:Â <span class="hljs-string">''</span>,
Â Â Â Â Â Â },
Â Â Â Â ],
Â Â }
})
</code></pre>
<p>2.  ä½¿ç”¨</p>
<p>ç°åœ¨å¯ä»¥åƒä½¿ç”¨å…¶ä»– Vue ç»„ä»¶ä¸€æ ·å°†å…¶å¯¼å…¥åˆ°ä½ çš„åº”ç”¨ä¸­ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>Â <span class="hljs-attr">setup</span>Â <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span>Â {Â <span class="hljs-title class_">Card</span>Â }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">"@/components/ui/card"</span>
<span class="hljs-keyword">import</span>Â {Â <span class="hljs-title class_">Orb</span>Â }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">"@/components/elevenlabs-ui/orb"</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">Card</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"flexÂ items-centerÂ justify-centerÂ p-8"</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">Orb</span>Â /&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">Card</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p>ElevenLabs UI Vue çš„ç»„ä»¶é£æ ¼éå¸¸ç®€çº¦ï¼Œæœ‰ç‚¹è‹¹æœUIçš„é£æ ¼ï¼Œæ¥çœ‹å‡ ä¸ªå…·æœ‰<code>ä»£è¡¨æ€§</code>çš„ç»„ä»¶ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e470416d64014114a39eb176e274334f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770165817&amp;x-signature=qsyPGfN2rpfkWoYuiurDnGCgv5Q%3D" alt="éŸ³é¢‘æ’­æ”¾å™¨" loading="lazy"/></p>
<p><code>éŸ³é¢‘æ’­æ”¾å™¨</code>ï¼šå¯è‡ªå®šä¹‰çš„éŸ³é¢‘æ’­æ”¾å™¨ï¼Œå¸¦æœ‰è¿›åº¦æ§åˆ¶å’Œæ’­æ”¾ç®¡ç†åŠŸèƒ½ï¼Œé€‚ç”¨äºéŸ³ä¹ã€æ’­å®¢å’Œè¯­éŸ³å†…å®¹ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/59a749c752b046869ae3aaf5b8ae4afe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770165817&amp;x-signature=5Mo7T4a0KiHmQKm%2FWV4c84gHVTg%3D" alt="éŸ³é¢‘æ–‡æœ¬åŒæ­¥" loading="lazy"/></p>
<p><code>éŸ³é¢‘æ–‡æœ¬åŒæ­¥ç»„ä»¶</code>ï¼šç”¨äºæ˜¾ç¤ºéŸ³é¢‘è½¬å½•æ–‡æœ¬çš„ç»„ä»¶ï¼Œå¯ä¸éŸ³é¢‘æ’­æ”¾åŒæ­¥è¿›è¡Œé€å­—é«˜äº®æ˜¾ç¤º</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/612e83014622497686b6cbc6bb9e6271~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770165817&amp;x-signature=VOxkLun9Xqcu5ZTR3rG5AFZvgi0%3D" alt="é—ªçƒæ–‡å­—" loading="lazy"/></p>
<p><code>é—ªçƒæ–‡å­—</code>ï¼šä½¿ç”¨ Motion å®ç°å¸¦æœ‰æ¸å˜é—ªçƒæ•ˆæœå’Œè§†å£è§¦å‘åŠ¨ç”»çš„åŠ¨ç”»æ–‡æœ¬ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97aceec3861347c38aed75a6a0624c24~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770165817&amp;x-signature=1G2b3qeswZTJfkoBOFjlZ2C3R0o%3D" alt="å›å¤" loading="lazy"/></p>
<p><code>å›å¤</code>ï¼šä½¿ç”¨ Streamdown å®ç°<code>æµå¼ Markdown</code> æ¸²æŸ“å™¨ï¼Œä¸º AI å“åº”æä¾›æµç•…çš„é€å­—ç¬¦åŠ¨ç”»ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab003776758f47298572d3d03aa90d41~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770165817&amp;x-signature=kIFwF1vAOsENADFtZChHDMqqKfw%3D" alt="éŸ³é¢‘å¯è§†åŒ–å·¥å…·" loading="lazy"/></p>
<p><code>éŸ³é¢‘å¯è§†åŒ–å·¥å…·</code>ï¼šé€‚ç”¨äºè¯­éŸ³ä»£ç†å’ŒéŸ³é¢‘ç•Œé¢çš„å®æ—¶éŸ³é¢‘é¢‘ç‡å¯è§†åŒ–å·¥å…·ï¼Œå¸¦æœ‰åŸºäºçŠ¶æ€çš„åŠ¨ç”»æ•ˆæœã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c3c3b9a2c6a45d2acaec83bd5fde2ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770165817&amp;x-signature=9BtulEcI2lpYd00kYQUooTAch3I%3D" alt="å®æ—¶æ³¢å½¢" loading="lazy"/></p>
<p><code>å®æ—¶æ³¢å½¢</code>ï¼šåŸºäºç”»å¸ƒçš„å®æ—¶éŸ³é¢‘æ³¢å½¢å¯è§†åŒ–å·¥å…·ï¼Œå¸¦æœ‰éº¦å…‹é£è¾“å…¥å’Œå¯è‡ªå®šä¹‰çš„æ¸²æŸ“æ¨¡å¼ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bfb6155a4d674cd7a8e522238f790c11~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770165817&amp;x-signature=g%2BoG17xnYfjonTLAwcuZwLI7IYU%3D" alt="éŸ³é¢‘çƒä½“" loading="lazy"/></p>
<p><code>éŸ³é¢‘çƒä½“</code>ï¼šä½¿ç”¨ <code>Three.js</code> æ„å»ºçš„å…·æœ‰éŸ³é¢‘å“åº”ã€è‡ªå®šä¹‰é¢œè‰²å’Œä»£ç†çŠ¶æ€å¯è§†åŒ–çš„ 3D åŠ¨ç”»çƒä½“ã€‚</p>
<p>å¦‚æœä½ ä¸€ç›´æƒ³ç”¨ Vue/Nuxt æ„å»ºéŸ³é¢‘æˆ–è¯­éŸ³ç›¸å…³çš„äº§å“ï¼Œå´æ²¡æ‰¾åˆ°åˆé€‚çš„ç»„ä»¶åº“ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„é€‰æ‹©ã€‚</p>
<p>é™„ä¸Šåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Felevenlabs-ui-vue.com%2F" target="_blank" title="https://elevenlabs-ui-vue.com/" ref="nofollow noopener noreferrer">elevenlabs-ui-vue.com/</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¨èä¸¤ä¸ªå‰ç«¯å¼€å‘ AI Chatbot çš„å¼€æºä»£ç åº“]]></title>    <link>https://juejin.cn/post/7600068631327162409</link>    <guid>https://juejin.cn/post/7600068631327162409</guid>    <pubDate>2026-01-28T00:47:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600068631327162409" data-draft-id="7582232291620618278" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¨èä¸¤ä¸ªå‰ç«¯å¼€å‘ AI Chatbot çš„å¼€æºä»£ç åº“"/> <meta itemprop="keywords" content="Node.js,å…¨æ ˆ,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-28T00:47:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯åŒè¶Šè€å¸ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/1714893868765373"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¨èä¸¤ä¸ªå‰ç«¯å¼€å‘ AI Chatbot çš„å¼€æºä»£ç åº“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1714893868765373/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯åŒè¶Šè€å¸ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T00:47:09.000Z" title="Wed Jan 28 2026 00:47:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯åŒè¶Šã€‚å‰ç™¾åº¦ æ»´æ»´ èµ„æ·±å‰ç«¯å·¥ç¨‹å¸ˆï¼Œæ…•è¯¾ç½‘é‡‘ç‰Œè®²å¸ˆï¼ŒPMPã€‚æˆ‘çš„ä»£è¡¨ä½œæœ‰ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.wangeditor.com%2F" target="_blank" title="https://www.wangeditor.com/" ref="nofollow noopener noreferrer">wangEditor</a> å¼€æº web å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼ŒGitHub 18k starï¼Œnpm å‘¨ä¸‹è½½é‡ 20k</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.huashuiai.com%2F" target="_blank" title="https://www.huashuiai.com/" ref="nofollow noopener noreferrer">åˆ’æ°´AI</a> Node å…¨æ ˆ AIGC çŸ¥è¯†åº“ï¼ŒåŒ…æ‹¬ AI å†™ä½œã€å¤šäººååŒç¼–è¾‘ã€‚å¤æ‚ä¸šåŠ¡ï¼ŒçœŸå®ä¸Šçº¿ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.mianshipai.com%2F" target="_blank" title="https://www.mianshipai.com/" ref="nofollow noopener noreferrer">å‰ç«¯é¢è¯•æ´¾</a> ç³»ç»Ÿä¸“ä¸šçš„é¢è¯•å¯¼èˆªï¼Œåˆ·é¢˜ï¼Œå†™ç®€å†ï¼Œçœ‹é¢è¯•æŠ€å·§ï¼Œå†…æ¨å·¥ä½œã€‚å¼€æºå…è´¹ã€‚</li>
</ul>
<blockquote>
<p>æˆ‘åœ¨æ­£åœ¨å¼€å‘ä¸€ä¸ª AI Agent æ™ºèƒ½ä½“é¡¹ç›®ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhitalk.chat%2F" target="_blank" title="https://zhitalk.chat/" ref="nofollow noopener noreferrer">æ™ºè¯­</a>ã€‘ä¸€ä¸ªæ™ºèƒ½é¢è¯•å®˜ï¼Œå¯ä»¥ä¼˜åŒ–ç®€å†ã€æ¨¡æ‹Ÿé¢è¯•ã€è§£ç­”é¢˜ç›®ç­‰ã€‚æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å›´è§‚ã€å­¦ä¹ ã€‚</p>
</blockquote>
<h2 data-id="heading-0">å¼€å§‹</h2>
<p>AI ç¼–ç¨‹çš„å…´èµ·æ­£åœ¨å¤§é‡å†²å‡»ç€ç¼–ç¨‹è¡Œä¸šï¼ŒåŒæ—¶ä¹Ÿäº§ç”Ÿäº†å¾ˆå¤š AI å¼€å‘çš„å²—ä½ï¼Œéœ€æ±‚è¶Šæ¥è¶Šå¤šã€‚</p>
<p>å‰ç«¯äººå‘˜å¯ä»¥ä½¿ç”¨ Nodejs åšå…¨æ ˆå¼€å‘ï¼Œä¹Ÿå°±å¯ä»¥ç”¨ Nodejs åš AI å¼€å‘ã€‚çœ‹æ‰€æœ‰ AI å¤§æ¨¡å‹æ¥å£çš„æ–‡æ¡£ï¼Œpython æ˜¯ç¬¬ä¸€è¯­è¨€ï¼Œnodejs æ˜¯ç¬¬äºŒè¯­è¨€ã€‚</p>
<p>ä½œ AI å¼€å‘ï¼Œæœ€åŸºç¡€çš„åŠŸèƒ½å°±æ˜¯ chatbot èŠå¤©æœºå™¨äººã€‚åŸºäº chatbot æˆ‘ä»¬å¯ä»¥æ‰©å±•æ›´å¤šæ¨¡å—ï¼ˆå¦‚ memory RAG tools MCP system-prompt ç­‰ï¼‰è®©å®ƒæˆä¸ºä¸€ä¸ª agent ï¼Œæˆ–è€…åšå…¶ä»–å®šåˆ¶å¼€å‘ã€‚</p>
<p>Chatbot æ—¢ç„¶æ˜¯ä¸€ä¸ªåŸºç¡€ï¼Œé‚£å°±æ²¡å¿…è¦ä» 0 å¼€å‘ï¼Œå¦åˆ™å…‰è¿™ä¸€éƒ¨åˆ†ä½ å°±ä¼šæµªè´¹æ‰å¤§é‡çš„ç²¾åŠ›ã€‚å°¤å…¶æ˜¯å‰ç«¯éƒ¨åˆ†ï¼Œè‡ªå·±ä» 0 å¼€å‘ä¸çŸ¥é“ä¼šè¶Šåˆ°å¤šå°‘ bug ï¼Ÿä¸çŸ¥é“æµ‹è¯•å¤šä¹…æ‰èƒ½ç¨³å®šï¼Ÿ</p>
<p>æœ¬æ–‡å°±ä»‹ç»ä¸¤ä¸ªå¸¸ç”¨çš„ chabot å¼€æºä»£ç åº“ï¼Œå¯¹åº”ä¸¤ä¸ªæœ€çƒ­é—¨çš„ AI å¼€å‘æ¡†æ¶ã€‚ä½ å¯ä»¥åŸºç¡€è¿™ä¸ª chatbot æ¥äºŒæ¬¡å¼€å‘å‡ºä½ è‡ªå·±çš„ AI äº§å“ã€‚</p>
<h2 data-id="heading-1">langGraph-cli é¡¹ç›®</h2>
<p>å¦‚æœä½ ä½¿ç”¨ langChain æŠ€æœ¯æ ˆï¼Œå¯ä»¥è€ƒè™‘è¿™ä¸ªé¡¹ç›®ã€‚</p>
<p>ä½¿ç”¨ langChain è‡ªç ”çš„è„šæ‰‹æ¶ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fcreate-agent-chat-app" target="_blank" title="https://www.npmjs.com/package/create-agent-chat-app" ref="nofollow noopener noreferrer">www.npmjs.com/package/creâ€¦</a></p>
<p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯åˆ›å»ºä¸€ä¸ªæœåŠ¡ç«¯</p>
<pre><code class="hljs language-sql" lang="sql">npx <span class="hljs-keyword">create</span><span class="hljs-operator">-</span>agent<span class="hljs-operator">-</span>chat<span class="hljs-operator">-</span>app<span class="hljs-variable">@latest</span>
</code></pre>
<p>å®‰è£…å®Œæˆä»¥åä¼šå‘ç°å®ƒæœ‰ 4 ä¸ª agent åˆ†åˆ«å±•ç¤ºä¸åŒçš„ä½¿ç”¨åœºæ™¯ï¼Œæœ€åŸºç¡€çš„å°±æ˜¯å½“å‰è¿™ä¸ª react-agent</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e0836ca246c748f18dcd82fa332a6e66~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5Y-M6LaK6ICB5biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166032&amp;x-signature=H5Rf1n3FV6IKziP5DBS9sHOciLo%3D" alt="image.png" loading="lazy"/></p>
<p>ä½†æ˜¯ç°åœ¨è¿˜ä¸èƒ½ç›´æ¥ç”¨ï¼Œå®ƒé»˜è®¤çš„å¤§æ¨¡å‹åœ¨å›½å†…è®¿é—®ä¸äº†ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸ºå…¶ä»–å¤§æ¨¡å‹ï¼Œå¦‚ deepseek</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3fa2c5e4c35f47d28bcf12cd0a2458c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5Y-M6LaK6ICB5biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166032&amp;x-signature=1HPNgfD77WebvzqeCWEXY1qgOxs%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨æ§åˆ¶å°æ‰§è¡Œ <code>npm run dev</code> å³å¯å¯åŠ¨é¡¹ç›®</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f4cb05c8e43d4dc08ed283b95eee2299~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5Y-M6LaK6ICB5biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166032&amp;x-signature=J8O1pLwWVLOdrpORzQQhYvZlAqc%3D" alt="image.png" loading="lazy"/></p>
<p>ç„¶åè·Ÿå®ƒèŠå¤©ï¼Œç‚¹å‡»å·¦ä¸Šè§’æŒ‰é’®ä¼šå±•ç¤ºèŠå¤©è®°å½•</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d517a22a20ad49e9a95a4bbc4d63a98f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5Y-M6LaK6ICB5biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166032&amp;x-signature=yCJb2zzVxoM%2FLNyHqPXJFi2taJU%3D" alt="image.png" loading="lazy"/></p>
<p>å…¶å®è¿™ä¸ªå‰ç«¯éƒ¨åˆ†ä¹Ÿæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„é¡¹ç›®ï¼Œæ˜¯ langChain å®˜æ–¹å¼€å‘çš„ chat UI <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flangchain-ai%2Fagent-chat-ui" target="_blank" title="https://github.com/langchain-ai/agent-chat-ui" ref="nofollow noopener noreferrer">github.com/langchain-aâ€¦</a></p>
<p>æ­¤æ—¶ï¼Œä½ å¯ä»¥åœ¨æœåŠ¡ç«¯ä»£ç ä¸­ï¼Œä½¿ç”¨ä»»ä½• langChain å’Œ langGraph çš„æŠ€æœ¯æ¥è‡ªå®šä¹‰å¼€å‘</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de4b9fa1a3ab4da28f20d98139423804~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5Y-M6LaK6ICB5biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166032&amp;x-signature=mWmZBkHSuiYz91cX1Op9r%2Bkp99Y%3D" alt="image.png" loading="lazy"/></p>
<p>ã€æ³¨æ„ã€‘langChain ç‰ˆæœ¬æ—©å°±å‘å¸ƒåˆ°äº† v1 ï¼Œä½†è¿™ä¸ªè„šæ‰‹æ¶åˆ›å»ºå‡ºæ¥çš„ä»£ç ï¼Œåœ¨å†™æœ¬æ–‡æ—¶ä¾ç„¶æ˜¯ v0.3 ç‰ˆæœ¬ï¼Œæ›´æ–°å¤ªæ»åäº†...</p>
<h2 data-id="heading-2">Vercel AI Chatbot</h2>
<p>é™¤äº† langChain ä»¥å¤–ï¼ŒVercel AI-SDK ä¹Ÿæ˜¯ä½¿ç”¨ Nodejs å¼€å‘ AI åº”ç”¨çš„çƒ­é—¨æ¡†æ¶ï¼ŒåŠŸèƒ½å·²ç»å¾ˆå®Œå–„ã€‚</p>
<p>Vercel ä¸ºæ­¤å¼€å‘äº†ä¸€ä¸ª chatbot template <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvercel%2Fai-chatbot" target="_blank" title="https://github.com/vercel/ai-chatbot" ref="nofollow noopener noreferrer">github.com/vercel/ai-câ€¦</a></p>
<p>å¹¶ä¸”å·²ç»æŠŠå®ƒéƒ¨ç½²åˆ°è¿™ä¸ªç½‘å€ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdemo.chat-sdk.dev%2F" target="_blank" title="https://demo.chat-sdk.dev/" ref="nofollow noopener noreferrer">demo.chat-sdk.dev/</a> ï¼ˆå¯èƒ½éœ€è¦ç§‘å­¦ä¸Šç½‘ï¼‰</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d58aabd83434eb291fec7c1b90ef420~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5Y-M6LaK6ICB5biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166032&amp;x-signature=q7d7%2FNp3GUVw1od8eO9aZ6wmsOA%3D" alt="image.png" loading="lazy"/></p>
<p>ä½ å¯ä»¥æŠŠè¿™ä¸ªä»£ç åº“ä¸‹è½½åˆ°æœ¬åœ°ï¼Œåœ¨æœ¬åœ°è¿è¡Œã€‚ä½†ä½ è¿˜æ˜¯éœ€è¦æŠŠ AI å¤§æ¨¡å‹æ”¹ä¸ºå›½å†…èƒ½è®¿é—®çš„</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2703e7069834476b4c6aea77f67cbca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5Y-M6LaK6ICB5biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166032&amp;x-signature=3ZjQtIWJY3n1VP7vB5oUfiYOJng%3D" alt="image.png" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥ä½ å°±å¯ä»¥åœ¨è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼ŒåŸºäº AI-SDK çš„è¯­æ³•åšä»»ä½•å…ˆåšçš„åŠŸèƒ½ï¼Œä¾‹å¦‚æˆ‘è¿™äº†åšçš„ AI è¯·æ±‚ rate limit é™åˆ¶ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a9d83238640464ba252259d410af2fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5Y-M6LaK6ICB5biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166032&amp;x-signature=QfniZe7JI4%2BrRRJxw%2BfOr4TX4fQ%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-3">æœ€å</h2>
<p>æ AI å¼€å‘é‡ç‚¹å°±åº”è¯¥æ”¾åœ¨ AI çš„æµç¨‹å’Œä¸šåŠ¡ä¸Šï¼Œè€Œä¸æ˜¯å‰ç«¯ UI éƒ¨åˆ†ï¼Œæ‰€ä»¥å°½é‡ä½¿ç”¨ç°æˆçš„ã€ç¨³å®šçš„ chatbot åŠŸèƒ½ï¼Œåœ¨æ­¤åŸºç¡€ä¹‹ä¸Šå†äºŒæ¬¡å¼€å‘ã€‚</p>
<p>è¿™ä¸¤ä¸ª chatbot è™½ç„¶ä½¿ç”¨äº†ä¸åŒçš„ AI æ¡†æ¶ï¼Œä½†ä»–ä»¬éƒ½æ˜¯åŸºäº Nodejs è¯­è¨€å’Œ Nextjs æ¡†æ¶ï¼Œæ‰€ä»¥å‰ç«¯æƒ³åš AI å¼€å‘ï¼Œä¸€å®šè¦å…ˆå…·å¤‡ Nodejs å…¨æ ˆèƒ½åŠ›ã€‚</p>
<p>å¦‚æœä½ æœ‰å…´è¶£ï¼Œä¸å¦¨å…ˆé€‰æ‹©ä¸€ä¸ªï¼Œåœ¨æœ¬åœ°è¿è¡Œè¯•ä¸€ä¸‹ã€‚æœ‰é—®é¢˜å¯åœ¨è¯„è®ºåŒºäº¤æµã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[3dæ‹¼å›¾æˆ‘ä¸ä¼šï¼Œè€æ¿ï¼šç”¨Cocosåšä¸ªä¼šåŠ¨çš„æ‹¼å›¾æ€»å¯ä»¥äº†å§ï¼]]></title>    <link>https://juejin.cn/post/7599910677578973184</link>    <guid>https://juejin.cn/post/7599910677578973184</guid>    <pubDate>2026-01-28T00:50:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599910677578973184" data-draft-id="7599873006258831394" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="3dæ‹¼å›¾æˆ‘ä¸ä¼šï¼Œè€æ¿ï¼šç”¨Cocosåšä¸ªä¼šåŠ¨çš„æ‹¼å›¾æ€»å¯ä»¥äº†å§ï¼"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-28T00:50:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¿å…ƒç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/1972988307323236"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            3dæ‹¼å›¾æˆ‘ä¸ä¼šï¼Œè€æ¿ï¼šç”¨Cocosåšä¸ªä¼šåŠ¨çš„æ‹¼å›¾æ€»å¯ä»¥äº†å§ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972988307323236/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¿å…ƒç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T00:50:27.000Z" title="Wed Jan 28 2026 00:50:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cace3d14b8194b2bb9d818a6c2315b68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=tg%2Fk8SnxYY%2FgEJ4PdU2GWsSoxM4%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">å¼•è¨€</h2>
<p><strong>å“ˆå–½å¤§å®¶å¥½</strong>ï¼Œæˆ‘æ˜¯äº¿å…ƒç¨‹åºå‘˜ï¼Œä¸Šæ¬¡è€æ¿è®©åš<code>3d</code>æ‹¼å›¾çš„é‚£ä¸ªå°ä¼™ä¼´åˆåŒå’å•æ¥äº†ï¼š</p>
<blockquote>
<p><strong>äº¿å“¥</strong>ï¼Œæˆ‘åˆåŒå’å•æ¥äº†ï¼Œ<code>3d</code>æ‹¼å›¾å¤ªéš¾äº†ï¼Œæˆ‘è¿™æ²¡æœ‰ç»éªŒå®åœ¨åšä¸å‡ºæ¥ï¼ˆæ‚è„¸ï¼‰ã€‚</p>
<p><strong>å¹¸å¥½</strong>è€æ¿æ²¡æœ‰ä¸€æ„å­¤è¡Œï¼Œä½†æ˜¯æ— è®ºå¦‚ä½•éƒ½è®©æˆ‘åšä¸ªå˜ç§çš„æ‹¼å›¾å‡ºæ¥ï¼šåšä¸ªä¼šåŠ¨çš„<code>spine</code>æ‹¼å›¾æ€»å¯ä»¥äº†å§ï¼</p>
<p><strong>å¤§ä½¬</strong>ç»™æˆ‘æ”¯æ”¯æ‹›ï¼Œ<code>spine</code>å¯ä»¥åŠ¨æ€åˆ†å‰²å—ï¼Ÿ</p>
</blockquote>
<p><strong>spineéª¨éª¼åŠ¨ç”»ï¼Ÿ</strong>ï¼Œæœç„¶äººçš„æ€ç»´èƒ½åŠ›æ˜¯æ— ç©·æ— å°½çš„ï¼Œä¸€ä¸ªæ‹¼å›¾æ¸¸æˆéƒ½ç©å‡ºèŠ±äº†ã€‚</p>
<p><strong>spine</strong>åŠ¨æ€åˆ†å‰²çš„æ–¹æ³•åº”è¯¥æœ‰å¾ˆå¤šï¼Œç¬”è€…æƒ³åˆ°äº†é€šè¿‡<code>RTT</code>çš„æ–¹æ³•ã€‚</p>
<p><strong>è¨€å½’æ­£ä¼ </strong>ï¼Œæœ¬æœŸå¸¦å¤§å®¶ä¸€èµ·æ¥çœ‹çœ‹ï¼Œåœ¨<code>Cocos</code>æ¸¸æˆå¼€å‘ä¸­ï¼Œ<strong>å¦‚ä½•é€šè¿‡RTTåŠ¨æ€åˆ†å‰²spineéª¨éª¼åŠ¨ç”»</strong>ã€‚</p>
<p><strong>æœ¬æ–‡æºå·¥ç¨‹å¯åœ¨æ–‡æœ«è·å–ï¼Œå°ä¼™ä¼´ä»¬è‡ªè¡Œå‰å¾€ã€‚</strong></p>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯RTTï¼Ÿ</h2>
<blockquote>
<p><strong>RenderToTexture</strong>æ˜¯å°†åœºæ™¯ / èŠ‚ç‚¹çš„æ¸²æŸ“ç»“æœè¾“å‡ºåˆ°ä¸€å¼ çº¹ç†ï¼ˆTextureï¼‰ è€Œéç›´æ¥æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚</p>
<p><strong>ä½ å¯ä»¥</strong>æŠŠå®ƒç†è§£æˆâ€œç»™æŒ‡å®šçš„æ¸¸æˆå†…å®¹æ‹ä¸€å¼ â€˜æ•°å­—ç…§ç‰‡â€™ï¼Œå¹¶æŠŠè¿™å¼ ç…§ç‰‡ä¿å­˜æˆå¯å¤ç”¨çš„çº¹ç†èµ„æºâ€ã€‚</p>
</blockquote>
<p><strong>æˆ‘ä»¬</strong>å¯ä»¥é€šè¿‡<code>RTT</code>åŠ¨æ€å°†<code>spineåŠ¨ç”»</code>æ¸²æŸ“åˆ°çº¹ç†ä¸Šï¼Œç„¶åé€šè¿‡<code>Sprite</code>æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p><strong>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬å¦‚ä½•åœ¨æ¸¸æˆå¼€å‘ä¸­ä½¿ç”¨RTTï¼Ÿ</strong></p>
<h2 data-id="heading-2">RTTçš„ä½¿ç”¨</h2>
<p><strong>1.èµ„æºå‡†å¤‡</strong></p>
<p><strong>æ—¢ç„¶æ˜¯</strong>åŠ¨æ€åˆ†å‰²<code>spine</code>åŠ¨ç”»ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€ä¸ª<code>spine</code>åŠ¨ç”»ï¼Œå¤§å®¶ç†Ÿæ‚‰çš„ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6721399d1ae45a4ae8755a9807ffb88~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=1fVL%2F%2FAW0qYtoHpoH%2BNqHXgpTMk%3D" alt="" loading="lazy"/></p>
<p><strong>ç›´æ¥è¿è¡Œ</strong>å°±èƒ½çœ‹åˆ°æ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce26c11173184e94b397cb1d666a423c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=6uFRT745MwTTZKoE2x8Inlz7Fow%3D" alt="" loading="lazy"/></p>
<p><strong>2.åˆ›å»ºæ¸²æŸ“çº¹ç†</strong></p>
<p><strong>æˆ‘ä»¬</strong>å¯ä»¥é€šè¿‡èµ„æºç®¡ç†å™¨<code>assets</code>ç›®å½•å³é”®åˆ›å»ºä¸€ä¸ªæ¸²æŸ“çº¹ç†(<code>RenderTexture</code>)ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4ea3d153014d43baad593962b40c3e08~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=lIBFe9I6UFSuEI4S8XVXzZLMpiw%3D" alt="" loading="lazy"/></p>
<p><strong>è°ƒæ•´</strong>åˆé€‚çš„å¤§å°ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cee1053818b549148a04316ee5e9eef0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=C2aFjr6Koq9hZsGV4ngZ6y1UsZw%3D" alt="" loading="lazy"/></p>
<p><strong>3.åˆ›å»ºç›¸æœº</strong></p>
<p><strong>æˆ‘ä»¬</strong>éœ€è¦å€ŸåŠ©ç›¸æœºï¼ŒæŠŠç›¸æœºçš„ç”»é¢æ¸²æŸ“åˆ°æ¸²æŸ“çº¹ç†ï¼Œäºæ˜¯æˆ‘ä»¬åœ¨<code>spine</code>èŠ‚ç‚¹ä¸‹åˆ›å»ºä¸€ä¸ªï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9519e516785b441f93253d11fec6d625~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=mHw8zF1AbD5unOIiAkI8e1wxwRU%3D" alt="" loading="lazy"/></p>
<p><strong>ä¿®æ”¹</strong>ç›¸æœºçš„<code>Visibility</code>å±æ€§å»æ‰<code>DEFAULT</code>ï¼Œå¦è€…ä¼šæœ‰è­¦å‘Šã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/210722ff9ee84c3495be3eb6c03fd214~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=qN6LX1L03H6WJXZvADCX%2BIcHLlw%3D" alt="" loading="lazy"/></p>
<p><strong>ç„¶å</strong>åœ¨å±æ€§é¢æ¿è°ƒæ•´ä½ç½®ã€æ­£äº¤å¤§å°ç­‰å‚æ•°ï¼Œè®©ç›¸æœºå®Œå…¨æ‹åˆ°<code>spine</code>åŠ¨ç”»ï¼ŒæŠŠèƒŒæ™¯é¢œè‰²è®¾ç½®æˆç™½è‰²ä¾¿äºè§‚çœ‹åŒºåˆ†ã€‚</p>
<p><strong>è®¾ç½®</strong><code>Target Texture</code>ä¸ºæˆ‘ä»¬åˆšåˆ›å»ºçš„<code>RenderTexture</code>ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8e2fe59c2c84513aa4823336d681ff9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=5JFwK3%2BrnsibB%2FgJOx14%2FhmyEag%3D" alt="" loading="lazy"/></p>
<p><strong>ä¸ºäº†</strong>é¿å…<code>spine</code>åŠ¨ç”»è¢«åŸç›¸æœºæ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒæ•´ä½ç½®ï¼Œå°†å®ƒç§»å‡ºåˆ°ç”»é¢å¤–ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b49815b14ef24d34bca62688469d9b31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=56pL4Pzts7QhkEK3H%2BBvcIfCy1k%3D" alt="" loading="lazy"/></p>
<p><strong>4.åˆ›å»ºSprite</strong></p>
<p><strong>æˆ‘ä»¬</strong>å¯ä»¥ç›´æ¥æŠŠ<code>RenderTexture</code>æ‹–åˆ°åœºæ™¯ä¸­ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª<code>Sprite</code>ç»„ä»¶ï¼Œå¹¶ä¸”è‡ªåŠ¨å°†<code>RenderTexture</code>ä½œä¸ºå›¾ç‰‡èµ„æºã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b22a28832efc4827bb169e63c3399fa3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=lradT3TzRVPFDntaw0y9OB%2FhFm8%3D" alt="" loading="lazy"/></p>
<p><strong>å±æ€§</strong>å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/48ba13a42c274b09a1bd31d38469d410~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=JeM58aozWuVUOWupE8XXBtVOcDQ%3D" alt="" loading="lazy"/></p>
<p><strong>5.æŸ¥çœ‹æ•ˆæœ</strong></p>
<p><strong>ç›´æ¥è¿è¡Œ</strong>å°±èƒ½çœ‹åˆ°æ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c7b0c49c5ccc468baaa29aa5e9177df0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=HeXQob%2B8E5FrdNewfR3RSSea8lk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">åŠ¨æ€åˆ†å‰²</h2>
<p><strong>æœ‰äº†</strong><code>SpriteFrame</code>ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æŒ‰ç…§ä¹‹å‰åŠ¨æ€åˆ†å‰²å›¾ç‰‡çš„é€»è¾‘è¿›è¡Œåˆ†å‰²äº†ã€‚</p>
<p><strong>é¦–å…ˆ</strong>åˆ›å»ºä¸€ä¸ªè„šæœ¬ï¼Œæ‹¿åˆ°<code>Sprite</code>å¼•ç”¨ï¼Œå®šä¹‰è¡Œåˆ—æ•°å’Œé—´éš™ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f856e95a54d14692a059e756d7447c7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=WL79%2BW3Az1Dm8B4m74yxRCID9pU%3D" alt="" loading="lazy"/></p>
<p><strong>ç„¶å</strong>æŒ‰ç…§ä¹‹å‰åŠ¨æ€åˆ†å‰²æ‹¼å›¾çš„åŸç†åˆ†å‰²å³å¯ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5a87a8eae0f4f2092aeb66a0dd8db91~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=g2JvVa%2BEEodMcBXfdV4JE7oRobk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">æ•ˆæœæ¼”ç¤º</h2>
<p><strong>æœ€ç»ˆæ•ˆæœ</strong>å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°<code>spine</code>å·²ç»è¢«æˆåŠŸåˆ†å‰²ï¼Œå‰©ä¸‹æ¸¸æˆé€»è¾‘å› ä¸ºå’Œä¹‹å‰ä¸€æ ·ï¼Œæˆ‘ä»¬å°±ä¸é‡å¤äº†ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c02508c92c894562a2e7f7cc30a0bc9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=lElBjnENmddCSsbF63rAwRk1JOA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">ç»“è¯­</h2>
<p><strong>è¿™æ ·çš„åŠ¨æ€æ‹¼å›¾</strong>å¸‚é¢ä¸Šå¥½åƒè¿˜æ²¡æœ‰ï¼Œä¼šæˆä¸ºä¸‹ä¸€ä¸ªå˜ç§çš„æ¨¡ä»¿å¯¹è±¡å—ï¼Ÿ</p>
<p><strong>å°ä¼™ä¼´ä»¬</strong>ï¼Œä½ ä»¬éƒ½å­¦ä¼šäº†å—ï¼Ÿ</p>
<p><strong>æœ¬æ–‡å®Œæ•´æºç </strong>å¯ä»¥ç‚¹èµåé€šè¿‡ç§ä¿¡<code>puzzlespine</code>è·å–ã€‚</p>
<p><strong>æ›´å¤šå®ç”¨æºç </strong>å¯ä»¥é€šè¿‡<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FFOi5gCiGzF3LnT03DpPMXA" target="_blank" title="https://mp.weixin.qq.com/s/FOi5gCiGzF3LnT03DpPMXA" ref="nofollow noopener noreferrer">äº¿å…ƒCocoså°æ¸¸æˆå®æˆ˜åˆé›†</a>è·å–ï¼Œæ„Ÿè°¢æ”¯æŒã€‚</p>
<hr/>
<p><strong>æˆ‘æ˜¯"äº¿å…ƒç¨‹åºå‘˜"ï¼Œä¸€ä½æœ‰ç€8å¹´æ¸¸æˆè¡Œä¸šç»éªŒçš„ä¸»ç¨‹ã€‚åœ¨æ¸¸æˆå¼€å‘ä¸­ï¼Œå¸Œæœ›èƒ½ç»™åˆ°æ‚¨å¸®åŠ©, ä¹Ÿå¸Œæœ›é€šè¿‡æ‚¨èƒ½å¸®åŠ©åˆ°å¤§å®¶ã€‚</strong></p>
<p>AD:ç¬”è€…çº¿ä¸Šçš„å°æ¸¸æˆã€Šæ‰“èºä¸é—¯å…³ã€‹ã€Šè´ªåƒè›‡æŒæœºç»å…¸ã€‹ã€Šé‡åŠ›è¿·å®«çƒã€‹ã€Šå¡«è‰²ä¹‹æ—…ã€‹ã€Šæ–¹å—æŒæœºç»å…¸ã€‹å¤§å®¶å¯ä»¥è‡ªè¡Œç‚¹å‡»æœç´¢ä½“éªŒã€‚</p>
<p>å®ä¸ç›¸ç’ï¼Œæƒ³è¦ä¸ª<strong>èµ</strong>å’Œ<strong>çˆ±å¿ƒ</strong>ï¼è¯·æŠŠè¯¥æ–‡ç« <strong>åˆ†äº«</strong>ç»™ä½ è§‰å¾—æœ‰éœ€è¦çš„å…¶ä»–å°ä¼™ä¼´ã€‚è°¢è°¢ï¼</p>
<p>æ¨èæ–‡ç« ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FFOi5gCiGzF3LnT03DpPMXA" target="_blank" title="https://mp.weixin.qq.com/s/FOi5gCiGzF3LnT03DpPMXA" ref="nofollow noopener noreferrer">äº¿å…ƒCocoså°æ¸¸æˆå®æˆ˜åˆé›†</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FXLCknL3fJDubec2GW6KLFA" target="_blank" title="https://mp.weixin.qq.com/s/XLCknL3fJDubec2GW6KLFA" ref="nofollow noopener noreferrer">Cocosæ¸¸æˆå¦‚ä½•æ¥å…¥å®‰å“ç©¿å±±ç”²å¹¿å‘Šå˜ç°ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F3_VrSld4KnDKY_7hxjSoKg" target="_blank" title="https://mp.weixin.qq.com/s/3_VrSld4KnDKY_7hxjSoKg" ref="nofollow noopener noreferrer">ä½ çŸ¥é“å’Œä¸çŸ¥é“çš„å¾®ä¿¡å°æ¸¸æˆå¸¸ç”¨APIæ•´ç†ï¼Œèµ¶ç´§æ”¶è—ç”¨èµ·æ¥~</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F0Lj24VHJ-pL8z82hHqQLiA" target="_blank" title="https://mp.weixin.qq.com/s/0Lj24VHJ-pL8z82hHqQLiA" ref="nofollow noopener noreferrer">Cocosæ¸¸æˆå¦‚ä½•å¿«é€Ÿæ¥å…¥æŠ–éŸ³å°æ¸¸æˆå¹¿å‘Šå˜ç°ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FZ7DusUJA2v1IFZDFtBsueg" target="_blank" title="https://mp.weixin.qq.com/s/Z7DusUJA2v1IFZDFtBsueg" ref="nofollow noopener noreferrer">å¦‚ä½•åœ¨CocosCreator3.8ä¸­å®ç°å‰²ç»³å­æ¸¸æˆæ•ˆæœ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F3BzzFBzeVAO-a6LPTeFTrA" target="_blank" title="https://mp.weixin.qq.com/s/3BzzFBzeVAO-a6LPTeFTrA" ref="nofollow noopener noreferrer">å¦‚ä½•åœ¨CocosCreator3.8ä¸­å®ç°åŠ¨æ€åˆ‡å‰²æ¨¡å‹ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FZIph332u_r24OTY4r6_jow" target="_blank" title="https://mp.weixin.qq.com/s/ZIph332u_r24OTY4r6_jow" ref="nofollow noopener noreferrer">Cocosæ¸¸æˆå¼€å‘ä¸­çš„è´´èŠ±æ•ˆæœ</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI å†™çš„é¡µé¢å·¨ä¸‘ï¼Ÿè¯•è¯•ç¦ç”¨ Tailwind]]></title>    <link>https://juejin.cn/post/7599868109085949994</link>    <guid>https://juejin.cn/post/7599868109085949994</guid>    <pubDate>2026-01-28T00:59:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599868109085949994" data-draft-id="7600068631327227945" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI å†™çš„é¡µé¢å·¨ä¸‘ï¼Ÿè¯•è¯•ç¦ç”¨ Tailwind"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-28T00:59:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£å“¥æ•°æ™ºè°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/3825956195409223"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI å†™çš„é¡µé¢å·¨ä¸‘ï¼Ÿè¯•è¯•ç¦ç”¨ Tailwind
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3825956195409223/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£å“¥æ•°æ™ºè°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T00:59:46.000Z" title="Wed Jan 28 2026 00:59:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‰å‡ å¤©æˆ‘åœ¨å®ç°ä¸€ä¸ªå‰ç«¯é¡µé¢æ—¶ï¼Œç¢°åˆ° <code>AI</code> ç”Ÿæˆé¡µé¢å·¨ä¸‘ï¼Œå¹¶ä¸”èŠ±è´¹åŠå¤©ã€å¯¹è¯nè½®ï¼Œå´æ€ä¹ˆéƒ½ä¼˜åŒ–ä¸è¿‡æ¥çš„æƒ…å†µã€‚</p>
<p>ä»Šå¤©å°±åˆ†äº«ç»™å¤§å®¶ï¼Œå¸Œæœ›å¯ä»¥ç»™ä½ ä¸€äº›çµæ„Ÿã€‚</p>
<p>ä¸‹é¢æ˜¯ä¼˜åŒ–nè½®ï¼Œä¸ç†æƒ³çš„ç•Œé¢æ•ˆæœï¼Œä¸‹é¢ä»¥ç­¾åˆ°å±•ç¤ºä¸ºä¾‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d910e8f800434d7f8eab371e2a8ae0f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166789&amp;x-signature=OvYzbZSZmUpakPjhLWjNGXtjYVo%3D" alt="æŠ½å¥–ï¼ˆæ—§ï¼‰" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6125b0820d4d437da7435d28288a7f68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166789&amp;x-signature=BGpoYPGnGVX5z2XYWLNf70kGJTA%3D" alt="DemoæŠ•ç¥¨ï¼ˆæ—§ï¼‰" loading="lazy"/></p>
<p>æ–°å»ºå¯¹è¯ï¼Œåˆ‡æ¢IDE/SOLOæ¨¡å¼ï¼Œæ›´æ¢æ¨¡å‹éƒ½å°è¯•äº†ï¼Œä½†éƒ½æ˜¯ä¸€äº›è¾¹è§’çš„ä¼˜åŒ–ï¼Œæ•´ä½“å¸ƒå±€ä¸€ç›´å¦‚æ­¤ã€‚</p>
<p>æˆ‘ç”šè‡³å·²ç»æ€€ç–‘å½“æ—¶çš„å¤§æ¨¡å‹æ˜¯ä¸æ˜¯æŠ½é£äº†ã€‚</p>
<p>ä½†ä½œä¸ºä¸€ä¸ªå¤©å¤©ç»™å°ä¼™ä¼´åˆ†äº«â€œ<strong>å¦‚æœ AI æ•ˆæœä¸ä½³ï¼Œè¯·ä»”ç»†è€ƒè™‘æ˜¯å¦æ­£ç¡®ä½¿ç”¨</strong>â€çš„äººï¼Œæˆ‘èƒ½æ€ª <code>AI</code> å—ï¼Ÿ</p>
<p>é‚£å¿…ç„¶ä¸è¡Œï¼Œäºæ˜¯ï¼Œæˆ‘äººè‚‰çœ‹ä»£ç å»äº†ã€‚</p>
<p>è¿˜çœŸè®©æˆ‘å‘ç°äº†ä¸€ä¸ªä¹‹å‰æ²¡æœ‰æ³¨æ„çš„ç‚¹ã€‚</p>
<p>ç”±äºè¿™ä¸ªé¡¹ç›®ç•Œé¢é£æ ¼æ¯”è¾ƒè‡ªç”±ï¼Œå› æ­¤åˆç‰ˆæç¤ºè¯å¹¶<strong>æœªé™å®šæŠ€æœ¯æ ˆ</strong>ï¼Œè€Œ <code>AI</code> ä¹Ÿä¸å‡ºæ„å¤–åœ°é€‰æ‹©äº†è‡ªå·±æœ€å–œæ¬¢çš„ <code>Tailwind</code>ï¼Œæˆ‘å¹³æ—¶æ²¡æœ‰ç”¨è¿‡ <code>Tailwind</code>ã€‚</p>
<p>ä¸ºä»€ä¹ˆæ³¨æ„åˆ°å®ƒå‘¢ï¼Œå› ä¸ºåšè¿™ä¸ªç•Œé¢çš„å‰ä¸¤å¤©ï¼Œåˆšçœ‹äº† <code>Tailwind</code> è£å‘˜ <code>75%</code> çš„äº‹æƒ…ï¼Œå°è±¡å¾ˆæ·±ã€‚</p>
<p>åŸºäºå¤šå¹´çš„ç¼–ç¨‹ç›´è§‰ï¼Œæˆ‘æ„Ÿè§‰å®ƒæ˜¯ä¸ªå˜æ•°ï¼Œå°±è¯•äº†è¯•ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7aa01a34d81b4c2795aeb640b0cb5c83~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166789&amp;x-signature=3t%2FTSZjg9nfzt%2BENOO0I4rvpwEU%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs">CheckInDisplay.vue æœ€è¿‘å‡ æ¬¡ä¼˜åŒ–éƒ½æ˜¯åŸºäº
tailwindä¼˜åŒ–çš„ï¼Œæ•ˆæœå¾ˆå·®ã€‚
è¯·å¿˜è®°tailwindç›´æ¥å‘æŒ¥ä½ çš„å…¨åŠ›ï¼Œé€šè¿‡è‡ªå®š
ä¹‰cssæ•ˆæœè¿›è¡Œç¾åŒ–ï¼Œä½†éœ€è¦ä¸
HomePage.vue é£æ ¼ä¸€è‡´ã€‚
</code></pre>
<p>ç»“æœï¼Œç«Ÿç„¶çœŸçš„æ‘†è„±äº†å‰é¢ä¸€ç›´ç»•ä¸å‡ºå»çš„ä¸‘é™‹é£æ ¼ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bcc39100763d405697751f820f976988~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166789&amp;x-signature=GE%2FTvIA2QoyikSmDhWAI3HoxSBI%3D" alt="æŠ½å¥–ï¼ˆæ–°ï¼‰" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c559b281e1494c16af9b67d0c6d85b24~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166789&amp;x-signature=cjGW3DhfXdPZy5r%2FkEwE5O72Xl4%3D" alt="DemoæŠ•ç¥¨ï¼ˆæ–°ï¼‰" loading="lazy"/></p>
<p>åæ¥æˆ‘æƒ³äº†æƒ³ï¼Œå¥½åƒä¹Ÿè¯´çš„é€šã€‚</p>
<p><code>Tailwind</code> çš„åŸå­åŒ–è®¾è®¡å“²å­¦æ“…é•¿å¿«é€Ÿæ­å»º<strong>ä¸€è‡´æ€§</strong>çš„ç³»ç»Ÿ <code>UI</code>ï¼Œä½†åœ¨éœ€è¦æ‰“ç ´ç½‘æ ¼ã€è‡ªå®šä¹‰åŠ¨æ•ˆæˆ–å¾®å¦™ç•™ç™½çš„<strong>é«˜è®¾è®¡æ„Ÿåœºæ™¯</strong>ä¸­ï¼Œè¿™äº›åè€Œæˆäº† <code>AI</code> çš„<strong>æŸç¼š</strong>ã€‚</p>
<p>å› æ­¤ï¼Œå¦‚æœä½ æƒ³è¦<strong>ç•Œé¢æ›´å…·è®¾è®¡æ„Ÿï¼Œæ›´åŠ æ¼‚äº®ï¼Œå¯ä»¥è€ƒè™‘è®© <code>AI</code> é‡‡ç”¨åŸç”Ÿ <code>CSS</code> å»å‘æŒ¥</strong>ï¼Œä¹Ÿè®¸ä¼šæœ‰æ„å¤–æ•ˆæœå‘¢~</p>
<p>å½“æ—¶æ²¡æœ‰æˆªå›¾ï¼Œä¸ºäº†æ›´å¥½çš„é˜…è¯»æ•ˆæœï¼Œæˆ‘é‡æ–°æ‹‰å–äº†å¥½å¤šç‰ˆä»£ç æ‰æ‰¾å›é”™è¯¯çš„ç•Œé¢ï¼Œæ”¯æŒä¸€ä¸‹ä¸è¿‡åˆ†å§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AIäº§å“ä¸­å…³äºã€æ€è€ƒã€‘èƒ½åŠ›çš„å‘å±•å’Œåº”ç”¨æ–¹å¼]]></title>    <link>https://juejin.cn/post/7599843186203410474</link>    <guid>https://juejin.cn/post/7599843186203410474</guid>    <pubDate>2026-01-27T23:49:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599843186203410474" data-draft-id="7599826983887880235" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AIäº§å“ä¸­å…³äºã€æ€è€ƒã€‘èƒ½åŠ›çš„å‘å±•å’Œåº”ç”¨æ–¹å¼"/> <meta itemprop="keywords" content="äº§å“,äº§å“ç»ç†,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-27T23:49:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åæ´›"/> <meta itemprop="url" content="https://juejin.cn/user/4230576474430190"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AIäº§å“ä¸­å…³äºã€æ€è€ƒã€‘èƒ½åŠ›çš„å‘å±•å’Œåº”ç”¨æ–¹å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4230576474430190/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åæ´›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T23:49:23.000Z" title="Tue Jan 27 2026 23:49:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>å½“â€æ€è€ƒâ€œä¸æ˜¯ä¸€ä¸ªèƒ½åŠ›ï¼Œè€Œæ˜¯ä¸€ä¸ªå·¥å…·æ—¶ï¼Œæˆ‘ä»¬çš„Agentä¼šäº§ç”Ÿä»€ä¹ˆå˜åŒ–ï¼Ÿ</strong></p>
<p>æœ€è¿‘åœ¨äº§å“è®¾è®¡ä¸­å¼•å…¥äº†AIçš„ã€æ€è€ƒã€‘å·¥å…·ï¼Œ è¿™é‡Œâ€œæ€è€ƒâ€ä¸æ˜¯ä½œä¸ºä¸€ä¸ªèƒ½åŠ›è¢«ä½¿ç”¨ï¼Œè€Œæ˜¯ä½œä¸ºä¸€ä¸ªå·¥å…·è¢«ä½¿ç”¨ã€‚ã€ä¸€ä¸ªæ€è€ƒå·¥å…·ã€‘ä¸å¯æ€è®®å§ï¼Ÿ</p>
<p>è¿™æ˜¯ä»Šå¹´ 3 æœˆï¼ŒAnthropicæå‡ºçš„æ¦‚å¿µï¼Œèƒ½å¤Ÿå°†æ€è€ƒä»â€œé¢„è®¾æ€è€ƒâ€è½¬å‘â€œåŠ¨æ€æ€è€ƒâ€ï¼Œ å¹¶ä¸”å®ç°å¤æ‚åº¦æä½ã€‚</p>
<p>æœ¬æ–‡æˆ‘å¸Œæœ›æŠŠå¤§æ¨¡å‹çš„â€œæ€è€ƒâ€å‘å±•å²ä»å®è§‚ä¸Šè®²è¿°ä¸€ä¸‹æ¨¡å‹ä»<code>æ— æ€è€ƒçš„å¯¹è¯æ¨¡å‹</code>åˆ°<code>Cotæ€ç»´é“¾çš„åº”ç”¨</code>å†åˆ°<code>æ·±åº¦æ€è€ƒæ¨¡å‹çš„è¯ç”Ÿ</code>æœ€ååˆ°<code>æ€è€ƒå·¥å…·çš„åº”ç”¨</code>ã€‚</p>
<p>æˆ‘ä»¬é‡ç‚¹è®²ä¸€ä¸‹å¯¹ã€æ€è€ƒã€‘å·¥å…·çš„ä½¿ç”¨ï¼Œå½“â€œæ€è€ƒâ€ä¸å†æ˜¯ä¸€ä¸ªèƒ½åŠ›ï¼Œè€Œå˜æˆä¸€ä¸ªå·¥å…·æ—¶ï¼Œä¼šç»™æˆ‘ä»¬çš„Agentå¸¦æ¥ä»€ä¹ˆå˜åŒ–ï¼Ÿ</p>
<p>è®©æˆ‘ä»¬å›åˆ°ä¸€å¼€å§‹ï¼ŒchatGPTæ‰åˆšåˆšå¼€å§‹çˆ†ç«ã€‚</p>
<h2 data-id="heading-0">å¯¹è¯æ¨¡å‹</h2>
<p>æ­¤æ—¶ï¼ŒAIæ˜¯æ²¡æœ‰æˆ‘ä»¬ç°åœ¨æ‰€å®šä¹‰çš„â€œæ€è€ƒâ€èƒ½åŠ›çš„ï¼Œåœ¨ AI å‘å±•çš„æ—©æœŸé˜¶æ®µï¼Œå¤§è¯­è¨€æ¨¡å‹ä¸»è¦ä¾èµ–é¢„è®­ç»ƒæ—¶å­¦åˆ°çš„æ¨¡å¼è¿›è¡Œç›´æ¥è¾“å‡ºã€‚è¿™äº›æ¨¡å‹è™½ç„¶èƒ½å¤Ÿç”Ÿæˆæµç•…çš„æ–‡æœ¬ï¼Œä½†åœ¨é¢å¯¹éœ€è¦é€»è¾‘æ¨ç†ã€å¤šæ­¥éª¤åˆ†ææˆ–å¤æ‚å†³ç­–çš„é—®é¢˜æ—¶ï¼Œå¾€å¾€æ˜¾å¾—åŠ›ä¸ä»å¿ƒï¼Œæˆ‘ä»¬ä¹Ÿé‡åˆ°äº†ä¸€äº›ä»¤äººå¤´ç–¼çš„é—®é¢˜ï¼š</p>
<ul>
<li>
<p>é€»è¾‘æ¼æ´é¢‘å‘ï¼šåœ¨éœ€è¦å¤šæ­¥éª¤æ¨ç†çš„æ•°å­¦é—®é¢˜æˆ–é€»è¾‘é¢˜ä¸­ï¼Œå®¹æ˜“å‡ºç°å‰åçŸ›ç›¾çš„å›ç­”</p>
</li>
<li>
<p>ç›´æ¥è·³è·ƒåˆ°ç­”æ¡ˆï¼šé¢å¯¹å¤æ‚é—®é¢˜æ—¶ï¼Œæ¨¡å‹å€¾å‘äºç›´æ¥ç»™å‡ºç»“è®ºï¼Œç¼ºå°‘ä¸­é—´çš„æ¨ç†æ­¥éª¤</p>
</li>
<li>
<p>é€æ˜åº¦ä¸è¶³ï¼šæˆ‘æ— æ³•äº†è§£æ¨¡å‹çš„æ€è€ƒè¿‡ç¨‹ï¼Œåªèƒ½çœ‹åˆ°æœ€ç»ˆç»“æœã€‚</p>
</li>
</ul>
<p>è¿™äº›é—®é¢˜ï¼Œç›´è§‚çš„å±•ç¤ºå°±æ˜¯ï¼š<strong>åœ¨å¤æ‚é—®é¢˜ä¸Šçš„æç¤ºè¯è°ƒä¼˜éå¸¸å›°éš¾ã€‚</strong></p>
<p>æˆ‘ä»¬ä¸çŸ¥é“AIæ˜¯å¦‚ä½•æƒ³çš„ï¼Œä»–ä¸ºä»€ä¹ˆä¸æŒ‰ç…§æˆ‘çš„è¦æ±‚æ‰§è¡Œï¼Œåˆä¸ºä»€ä¹ˆä¼šå¾—åˆ°å½“å‰çš„è¿™ä¸ªç­”æ¡ˆã€‚</p>
<p>ä¸€ä¸ªç»å…¸é—®é¢˜å°±æ˜¯æ•°å­¦é¢˜çš„è®¡ç®—ï¼Œæ‰€æœ‰æ¨¡å‹éƒ½æ— æ³•æ­£ç¡®çš„è®¡ç®—ç¨å¾®å¤æ‚ä¸€äº›çš„è®¡ç®—é¢˜ã€‚</p>
<p>æ€ç»´é“¾ï¼ˆChain of Thought, CoTï¼‰å°±è¯ç”Ÿåœ¨è¿™æ ·çš„ä¸€ä¸ªåœºæ™¯ä¸‹ã€‚</p>
<h2 data-id="heading-1">COT</h2>
<p>2022 å¹´ï¼ŒGoogle Brain å›¢é˜Ÿæå‡ºäº†é©å‘½æ€§çš„æ€ç»´é“¾æç¤ºæŠ€æœ¯ï¼ˆChain of Thought Prompting, CoTï¼‰ã€‚è¿™é¡¹æŠ€æœ¯çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>é¼“åŠ± AI æ¨¡å‹åƒäººç±»ä¸€æ ·ï¼Œå°†å¤æ‚çš„æ¨ç†è¿‡ç¨‹åˆ†è§£ä¸ºå¤šä¸ªä¸­é—´æ­¥éª¤ï¼Œè€Œä¸æ˜¯ç›´æ¥è·³åˆ°æœ€ç»ˆç­”æ¡ˆã€‚</strong></p>
<p>æ€ç»´é“¾ï¼ˆCoTï¼‰æç¤ºè¯æ˜¯ä¸€ç§å¼•å¯¼å¤§å‹è¯­è¨€æ¨¡å‹åœ¨å¤„ç†å›°éš¾é—®é¢˜æ—¶éµå¾ªæ¨ç†è¿‡ç¨‹çš„æŠ€æœ¯ã€‚</p>
<p>é€šå¸¸æ˜¯<strong>é€šè¿‡å‘æ¨¡å‹å±•ç¤ºå‡ ä¸ªæ¸…æ™°çš„æ­¥éª¤æ¨ç†ç¤ºä¾‹æ¥å®ç°</strong>ã€‚æˆ‘ä»¬æœŸæœ›æ¨¡å‹èƒ½å¤Ÿéµå¾ªè¿™ç§â€œæ€è·¯é“¾â€æ¨ç†ï¼Œæœ€ç»ˆå¾—å‡ºæ­£ç¡®ç­”æ¡ˆã€‚</p>
<p>å°¤å…¶æ˜¯å½“ä»»åŠ¡æ¶‰åŠå¤æ‚çš„æ¨ç†ï¼Œéœ€è¦ç®—æœ¯ã€å¸¸è¯†å’Œç¬¦å·æ¨ç†æ—¶ï¼Œ<code>CoT</code> æ˜¯ç†æƒ³çš„é€‰æ‹©;</p>
<p>ç®€å•è¯´ï¼šå½“æ¨¡å‹éœ€è¦ç†è§£å¹¶éµå¾ªä¸­é—´æ­¥éª¤ä»¥å¾—å‡ºæ­£ç¡®ç­”æ¡ˆã€‚æˆ‘ä»¬å°±è¦ä½¿ç”¨ <code>CoT</code>ã€‚</p>
<p>ä½¿ç”¨CoTæ—¶ï¼Œéœ€è¦ä¸»è¦ <code>CoT</code> å’Œ <code>few-shot</code> çš„åŒºåˆ«ï¼š</p>
<ol>
<li>few-shotåœ¨æç¤ºè¯ä¸­å‘æ¨¡å‹å±•ç¤ºçš„æ˜¯ç­”æ¡ˆã€‚</li>
<li>COTåœ¨æç¤ºè¯ä¸­å‘æ¨¡å‹å±•ç¤ºçš„æ˜¯è¿‡ç¨‹ã€‚</li>
</ol>
<p>è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬åœ¨ç¼–å†™ <code>CoT</code> æç¤ºè¯æ—¶ï¼Œæ›´é‡è¦æ˜¯<strong>æ¸…æ™°çš„è¡¨è¿°ä»»åŠ¡è¿‡ç¨‹</strong>ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>CoT</code> ä¸ä¸€å®šä¼š100%æˆåŠŸçš„ï¼Œæˆ‘ä»¬å¤§è‡´ä¼šé‡åˆ°è¿™ä¸‰ç§åœºæ™¯ï¼š</p>
<ol>
<li><code>CoT</code> å®Œç¾çš„æ‰§è¡Œäº†ï¼Œå¹¶ä¸”å¾—åˆ°äº†é¢„æœŸçš„ç­”æ¡ˆ</li>
<li><code>CoT</code> å®Œç¾çš„æ‰§è¡Œäº†ï¼Œä½†æ˜¯å¾—åˆ°çš„ç­”æ¡ˆæ˜¯éé¢„æœŸçš„</li>
<li><code>CoT</code> æ‰§è¡Œè·¯å¾„é”™è¯¯ï¼Œï¼ˆç»“æœæ— æ‰€è°“ï¼Œæ¨¡å‹å·²ç»ä¸éµå®ˆæˆ‘ä»¬çš„æŒ‡ä»¤äº†ï¼‰ã€‚</li>
</ol>
<p>è€Œæˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼šå…¶å®æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«å®Œç¾çš„è§£å†³æ–¹æ¡ˆğŸ˜‚ï¼Œç°è¡Œçš„è§£å†³æ–¹æ¡ˆæ ¸å¿ƒåŸåˆ™æ˜¯ï¼š<strong>ä»å•çº¯çš„Cotå‘ç»“æ„åŒ–çš„ã€é’ˆå¯¹æ€§çš„ç­–ç•¥è½¬ç§»</strong>ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>ToTï¼ˆTree of Thought æ€ç»´æ ‘ï¼‰</li>
<li>åˆ†å±‚Cotï¼ˆæ‹†åˆ†ä»»åŠ¡ï¼‰</li>
<li>ä¸€è‡´æ€§æ£€æŸ¥ï¼ˆé¢å¤–åˆ†ææ˜¯å¦æŒ‰ç…§è¦æ±‚è¿›è¡Œä»»åŠ¡æ‰§è¡Œï¼‰</li>
</ul>
<p>ä½†æ— ä¸€ä¾‹å¤–ï¼Œè¿™éƒ½å¢åŠ äº†tokensæˆæœ¬ä¸æ—¶é—´æˆæœ¬ã€‚</p>
<h2 data-id="heading-2">æ·±åº¦æ€è€ƒ</h2>
<p>æ·±åº¦æ€è€ƒçš„å‡ºç°ï¼Œå¯¹äºæˆ‘ä»¬æ¥è¯´æ›´é‡è¦çš„æ˜¯å¸¦æ¥çš„ï¼š<strong>ç†å¿µå‡çº§</strong>ã€‚</p>
<p>åœ¨ <code>CoT</code> æŠ€æœ¯åŸºç¡€ä¸Šï¼ŒAI æ€è€ƒèƒ½åŠ›è¿›å…¥äº†â€œæ·±åº¦æ€è€ƒâ€é˜¶æ®µã€‚è¿™ä¸€é˜¶æ®µçš„æ ‡å¿—æ˜¯ AI ä¸ä»…èƒ½å¤Ÿå±•ç¤ºæ¨ç†è¿‡ç¨‹ï¼Œè¿˜èƒ½å¤Ÿè¿›è¡Œæ›´æ·±å…¥ã€æ›´é•¿æ—¶é—´çš„å†…éƒ¨æ€è€ƒï¼Œç±»ä¼¼äºäººç±»çš„æ·±åº¦æ€è€ƒè¿‡ç¨‹ã€‚</p>
<p>ç®€å•è¯´å°±æ˜¯ï¼š<strong>CoTåƒæ˜¯"ç”¨æˆ·æ•™æ¨¡å‹å¦‚ä½•æ€è€ƒ"çš„è¯´æ˜ä¹¦ï¼Œè€Œæ·±åº¦æ€è€ƒæ¨¡å‹æ˜¯"æ¨¡å‹è‡ªå·±å­¦ä¼šå¦‚ä½•æ€è€ƒ"çš„èƒ½åŠ›ã€‚å‰è€…ä¾èµ–æç¤ºå·¥ç¨‹ï¼Œåè€…æ˜¯æ¨¡å‹å†…åœ¨èƒ½åŠ›çš„ä½“ç°ã€‚</strong></p>
<p>æ·±åº¦æ€è€ƒé˜¶æ®µï¼Œæœ‰ä¸¤ä¸ªå¾ˆé‡è¦çš„é‡Œç¨‹ç¢‘ï¼š</p>
<p>ä¸€ã€OpenAI-o1é¦–æ¬¡å°†æ¨ç†èƒ½åŠ›å¤§è§„æ¨¡åº”ç”¨åˆ°é€šç”¨ä»»åŠ¡ï¼Œåœ¨å·¥ç¨‹ä¸ŠéªŒè¯äº†æ·±åº¦æ€è€ƒçš„å¯è¡Œæ€§ï¼š</p>
<p>o1ï¼ˆ2024å¹´9æœˆå‘å¸ƒï¼‰ï¼šOpenAIé¦–ä¸ªå…¬å¼€çš„æ¨ç†ä¼˜åŒ–æ¨¡å‹ï¼Œé¦–æ¬¡å¤§è§„æ¨¡éªŒè¯äº†å¼ºåŒ–å­¦ä¹ åœ¨å¤æ‚æ¨ç†ä»»åŠ¡ä¸­çš„æœ‰æ•ˆæ€§ï¼Œåœ¨æ•°å­¦ã€ç¼–ç¨‹ç­‰åŸºå‡†æµ‹è¯•ä¸­æ˜¾è‘—è¶…è¶Šå‰ä»£æ¨¡å‹ï¼Œç¡®ç«‹äº†"æ¨ç†æ¨¡å‹"è¿™ä¸€æ–°èŒƒå¼ã€‚</p>
<p>äºŒã€deepseek-R1é‡‡ç”¨çº¯RLè·¯å¾„çš„å¼€åˆ›æ€§æ¢ç´¢ï¼Œä»¥åŠå®Œæ•´çš„å¼€æºç”Ÿæ€å»ºè®¾ï¼š</p>
<p>R1ï¼ˆ2025å¹´1æœˆå‘å¸ƒï¼‰ï¼šDeepSeekçš„å¼€æºæ¨ç†æ¨¡å‹ï¼Œå…¶çªç ´åœ¨äºè¯æ˜äº†çº¯å¼ºåŒ–å­¦ä¹ è·¯å¾„ï¼ˆæ— éœ€ç›‘ç£å¾®è°ƒï¼‰ä¹Ÿèƒ½è¾¾åˆ°å¼ºå¤§æ¨ç†èƒ½åŠ›ï¼Œå¹¶é¦–æ¬¡å®Œæ•´å¼€æºäº†æŠ€æœ¯ç»†èŠ‚å’Œè®­ç»ƒæ–¹æ³•ï¼Œæ¨åŠ¨äº†æ¨ç†æ¨¡å‹çš„å¯å¤ç°ç ”ç©¶</p>
<p>åˆ°ä»Šå¤©ï¼ˆ26/1ï¼‰ï¼Œæ·±åº¦æ€è€ƒæ¨¡å‹å·²ç»ä¸å†æ˜¯å•ç‹¬çš„æ¨¡å‹ï¼Œè€Œæ˜¯å¯ä»¥é€šè¿‡å‚æ•°æ¥æ§åˆ¶åŒä¸€ä¸ªæ¨¡å‹æ˜¯å¦å¯ç”¨æ·±åº¦æ€è€ƒã€‚</p>
<blockquote>
<p>ps: deepseek-R1ï¼Œä¹Ÿæ—©å°±è¢«å®˜æ–¹æ”¾å¼ƒï¼Œç›®å‰deepseekçš„æ·±åº¦æ€è€ƒæ¨¡å¼ï¼Œä½¿ç”¨çš„æ˜¯deepseek-v3.2çš„æ·±åº¦æ€è€ƒèƒ½åŠ›ã€‚</p>
</blockquote>
<p>æ­¤æ—¶çš„æ·±åº¦æ€è€ƒèƒ½åŠ›ï¼Œä¾ç„¶æœ‰ç€è®©æˆ‘ä»¬å¾ˆå¤´ç–¼çš„åœ°æ–¹ï¼šè€—æ—¶å¤ªé•¿ã€tokensæ¶ˆè€—å¤ªå¤šã€‚</p>
<h2 data-id="heading-3">æ€è€ƒå·¥å…·</h2>
<p>2025 å¹´ 3 æœˆï¼ŒAnthropic å…¬å¸æ¨å‡ºäº†é©å‘½æ€§çš„<code>æ€è€ƒå·¥å…·ï¼ˆThink Toolï¼‰</code>ï¼Œè¿™æ˜¯ AI æ€è€ƒèƒ½åŠ›å‘å±•çš„æœ€æ–°é˜¶æ®µã€‚</p>
<p>è¿™ä¸€å·¥å…·çš„æ¨å‡ºæ ‡å¿—ç€ AI æ€è€ƒä»<code>é¢„è®¾æ€è€ƒ</code>è½¬å‘<code>åŠ¨æ€æ€è€ƒ</code>ï¼Œå°¤å…¶æ˜¯åœ¨å¤æ‚é¢†åŸŸçš„ä»»åŠ¡å–ä¼šæœ‰æ›´å¥½çš„æ•ˆæœã€‚</p>
<p>æ€è€ƒå·¥å…·çš„å®ç°å¤æ‚åº¦æä½ï¼Œå°±æ˜¯<code>function call</code>æŠ€æœ¯çš„åº”ç”¨ã€‚ä½†æ˜¯ä¸ä¹‹å‰çš„<code>æ·±åº¦æ€è€ƒ</code>ä¸åŒï¼Œæ€è€ƒå·¥å…·å…·æœ‰ä»¥ä¸‹ç‹¬ç‰¹ç‰¹å¾ï¼š</p>
<ul>
<li>è¿‡ç¨‹ä¸­çš„åœé¡¿ï¼šAI å¯ä»¥åœ¨ç”Ÿæˆç­”æ¡ˆçš„è¿‡ç¨‹ä¸­éšæ—¶åœä¸‹æ¥æ€è€ƒ</li>
<li>ä¸“ç”¨æ€è€ƒç©ºé—´ï¼šä¸ºç»“æ„åŒ–æ€è€ƒåˆ›é€ ç‹¬ç«‹çš„æ€è€ƒç¯å¢ƒ</li>
<li>å®æ—¶ç­–ç•¥è°ƒæ•´ï¼šæ ¹æ®æ–°ä¿¡æ¯åŠ¨æ€è°ƒæ•´æ€è€ƒæ–¹å‘</li>
<li>ç›¸æ¯”äºæ·±åº¦æ€è€ƒï¼Œæ²¡æœ‰è¶…çº§é•¿çš„æ—¶é—´æŸè€—ã€‚</li>
</ul>
<p><strong>æ€è€ƒå·¥å…·æç¤ºè¯å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="hljs language-js" lang="js">{
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"think"</span>,
  <span class="hljs-string">"description"</span>: <span class="hljs-string">"ä½¿ç”¨æ­¤å·¥å…·è¿›è¡Œæ€è€ƒã€‚å®ƒä¸ä¼šè·å–æ–°ä¿¡æ¯æˆ–å¯¹ä»£ç åº“è¿›è¡Œä»»ä½•æ›´æ”¹ï¼Œä»…ä¼šè®°å½•æƒ³æ³•ã€‚å½“éœ€è¦è¿›è¡Œå¤æ‚æ¨ç†æˆ–å¤´è„‘é£æš´æ—¶ä½¿ç”¨å®ƒã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æ¢ç´¢ä»£ç åº“å¹¶å‘ç°äº†æŸä¸ªé”™è¯¯çš„æ ¹æºï¼Œå¯è°ƒç”¨æ­¤å·¥å…·æ¥å¤´è„‘é£æš´å‡ ç§ç‹¬ç‰¹çš„ä¿®å¤æ–¹æ³•ï¼Œå¹¶è¯„ä¼°å“ªäº›æ›´æ”¹å¯èƒ½æœ€ç®€å•ä¸”æœ€æœ‰æ•ˆã€‚æˆ–è€…ï¼Œå¦‚æœæ‚¨æ”¶åˆ°ä¸€äº›æµ‹è¯•ç»“æœï¼Œå¯è°ƒç”¨æ­¤å·¥å…·æ¥å¤´è„‘é£æš´ä¿®å¤å¤±è´¥æµ‹è¯•çš„æ–¹æ³•ã€‚"</span>,
  
  <span class="hljs-string">"input_schema"</span>: {
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,
    <span class="hljs-string">"properties"</span>: {
      <span class="hljs-string">"thought"</span>: {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
        <span class="hljs-string">"description"</span>: <span class="hljs-string">"æ‚¨çš„æƒ³æ³•å†…å®¹"</span>
      }
    },
    <span class="hljs-string">"required"</span>: [<span class="hljs-string">"thought"</span>]
  }
}
</code></pre>
<p>è¿™é‡Œå’Œæˆ‘ä»¬å¸¸è§çš„å·¥å…·æœ‰ä¸ªéå¸¸ä¸ä¸€æ ·çš„ç‚¹ï¼Œæˆ‘ä»¬å¸¸è§çš„å·¥å…·ä¸­<code>properties</code>å­—æ®µä¸‹é¢æ˜¯éœ€è¦è®©AIç»™æˆ‘ä»¬æå–å‡ºæ¥çš„å·¥å…·çš„å‚æ•°ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-js" lang="js">{
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"add"</span>,
  <span class="hljs-string">"description"</span>: <span class="hljs-string">"ä¸€ä¸ªè®¡ç®—ä¸¤æ•°ç›¸åŠ çš„åŠ æ³•å·¥å…·"</span>,
  <span class="hljs-string">"input_schema"</span>: {
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,
    <span class="hljs-string">"properties"</span>: {
      <span class="hljs-string">"a"</span>: {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
        <span class="hljs-string">"description"</span>: <span class="hljs-string">"ç¬¬ä¸€ä¸ªæ•°å­—"</span>
      }
      <span class="hljs-string">"b"</span>: {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
        <span class="hljs-string">"description"</span>: <span class="hljs-string">"ç¬¬äºŒä¸ªæ•°å­—"</span>
      }
    },
    <span class="hljs-string">"required"</span>: [<span class="hljs-string">"thought"</span>]
  }
}
</code></pre>
<p>åœ¨è¿™ä¸ªåŠ æ³•å·¥å…·ä¸­ï¼Œ<code>a</code>å’Œ<code>b</code>æ˜¯ä¸¤ä¸ªæ•°å­—ï¼Œè¿™ä¿©æ•°å­—æ˜¯AIä»ç”¨æˆ·çš„queryæˆ–è€…ä¸Šä¸‹æ–‡ä¸­æå–å‡ºæ¥çš„ï¼Œä¸€ä¸ªæ˜ç¡®çš„ä¿¡æ¯ã€‚</p>
<p>è€Œåœ¨æˆ‘ä»¬çš„æ€è€ƒå·¥å…·ä¸­ï¼Œ<code>thought</code>è¿™ä¸ªå­—æ®µï¼Œæ˜¯AIé€šè¿‡å·¥å…·æè¿°ï¼Œç»“åˆé˜…è¯»ä¸Šä¸‹æ–‡ï¼Œæ€è€ƒå‡ºæ¥çš„å†…å®¹ï¼Œå¦‚å›¾ï¼š</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11b234294723457fad1362164e5d24eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2O5rSb:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770162562&amp;x-signature=EnY%2FhoZvMQ%2BRmm09XTnFRk6p%2FtA%3D" alt="fc.png" width="100%" loading="lazy"/>
<p>æ­¤æ—¶<code>thought</code>çš„å†…å®¹ï¼Œå°±æ˜¯æ·±åº¦æ€è€ƒçš„ç»“æœã€‚</p>
<p>è€Œæ€è€ƒä½œä¸ºä¸€ä¸ªå·¥å…·æ¥ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥éšæ—¶éšåœ°çš„åœ¨æˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„AgentèŠ‚ç‚¹ä¸­ä½¿ç”¨ã€‚</p>
<p>æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å†ç³»ç»Ÿæç¤ºè¯ä¸­æ·»åŠ å¯¹åº”çš„CoTæç¤ºè¯ï¼Œæ¥å¢åŠ æ€è€ƒå·¥å…·çš„æ‰§è¡Œæ•ˆæœã€‚</p>
<p>å½“æˆ‘ä»¬çš„ä»»åŠ¡è¾ƒé•¿å’Œ/æˆ–å¤æ‚æ—¶ï¼Œå°†â€œæ€è€ƒâ€å·¥å…·ä¸ä¼˜åŒ–æç¤ºè¯ç»“åˆï¼Œåœ¨ç³»ç»Ÿæç¤ºä¸­åŒ…å«å…³äºâ€œæ€è€ƒâ€å·¥å…·çš„è¯´æ˜ï¼Œæ¯”ç›´æ¥æ”¾åœ¨å·¥å…·æè¿°ä¸­æ›´æœ‰æ•ˆã€‚</p>
<p>è¿™ç§æ–¹æ³•æä¾›äº†æ›´å¹¿æ³›çš„èƒŒæ™¯ï¼Œå¸®åŠ©æ¨¡å‹æ›´å¥½åœ°å°†æ€ç»´è¿‡ç¨‹èå…¥æ•´ä½“è¡Œä¸ºä¸­ã€‚æç¤ºè¯ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-md" lang="md">ä½¿ç”¨æ€è€ƒå·¥å…·
åœ¨é‡‡å–ä»»ä½•è¡ŒåŠ¨æˆ–æ ¹æ®å·¥å…·ç»“æœå›å¤ç”¨æˆ·ä¹‹å‰ï¼Œè¯·å°†æ€è€ƒå·¥å…·ä½œä¸ºè‰ç¨¿çº¸æ¥ï¼š

åˆ—å‡ºé€‚ç”¨äºå½“å‰è¯·æ±‚çš„å…·ä½“è§„åˆ™

æ£€æŸ¥æ˜¯å¦å·²æ”¶é›†æ‰€æœ‰å¿…éœ€ä¿¡æ¯

éªŒè¯è®¡åˆ’ä¸­çš„è¡ŒåŠ¨æ˜¯å¦ç¬¦åˆæ‰€æœ‰æ”¿ç­–

å¯¹å·¥å…·ç»“æœè¿›è¡Œåå¤æ¨æ•²ä»¥ç¡®ä¿å…¶æ­£ç¡®æ€§

ä»¥ä¸‹æ˜¯åœ¨æ€è€ƒå·¥å…·å†…éœ€è¦åå¤æ¨æ•²çš„ä¸€äº›ç¤ºä¾‹ï¼š

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">think_tool_example_1</span>&gt;</span></span>
ç”¨æˆ·å¸Œæœ›å–æ¶ˆèˆªç­ABC123

éœ€è¦æ ¸å®ï¼šç”¨æˆ·IDã€é¢„è®¢IDã€åŸå› 

æ£€æŸ¥å–æ¶ˆè§„åˆ™ï¼š

æ˜¯å¦åœ¨é¢„è®¢å24å°æ—¶å†…ï¼Ÿ

å¦‚æœä¸æ˜¯ï¼Œåˆ™æ£€æŸ¥æœºç¥¨èˆ±ä½å’Œä¿é™©

ç¡®è®¤æ— èˆªæ®µå·²ä½¿ç”¨æˆ–å±äºè¿‡å»æ—¶æ®µ

è®¡åˆ’ï¼šæ”¶é›†ç¼ºå¤±ä¿¡æ¯ï¼Œæ ¸å®è§„åˆ™ï¼Œè·å–ç¡®è®¤
<span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">think_tool_example_1</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">think_tool_example_2</span>&gt;</span></span>
ç”¨æˆ·æƒ³é¢„è®¢3å¼ å‰å¾€çº½çº¦çš„æœºç¥¨ï¼Œæ¯äºº2ä»¶æ‰˜è¿è¡Œæ

éœ€è¦ç”¨æˆ·IDæ¥æ£€æŸ¥ï¼š

ä¼šå‘˜ç­‰çº§å¯¹åº”çš„è¡Œæé¢åº¦

ä¸ªäººèµ„æ–™ä¸­å­˜åœ¨çš„ä»˜æ¬¾æ–¹å¼

è¡Œæè®¡ç®—ï¼š

ç»æµèˆ± Ã— 3åä¹˜å®¢

å¦‚æœæ˜¯æ™®é€šä¼šå‘˜ï¼šæ¯äºº1ä»¶å…è´¹è¡Œæ â†’ é¢å¤–3ä»¶è¡Œæ = $150

å¦‚æœæ˜¯é“¶å¡ä¼šå‘˜ï¼šæ¯äºº2ä»¶å…è´¹è¡Œæ â†’ æ— é¢å¤–è¡Œæ = $0

å¦‚æœæ˜¯é‡‘å¡ä¼šå‘˜ï¼šæ¯äºº3ä»¶å…è´¹è¡Œæ â†’ æ— é¢å¤–è¡Œæ = $0

éœ€è¦éªŒè¯çš„æ”¯ä»˜è§„åˆ™ï¼š

æœ€å¤š1å¼ æ—…è¡Œåˆ¸ã€1å¼ ä¿¡ç”¨å¡ã€3å¼ ç¤¼å“å¡

æ‰€æœ‰æ”¯ä»˜æ–¹å¼å¿…é¡»å­˜åœ¨äºä¸ªäººèµ„æ–™ä¸­

æ—…è¡Œåˆ¸çš„ä½™é¢å°†ä½œåºŸ

è®¡åˆ’ï¼š

è·å–ç”¨æˆ·ID

æ ¹æ®ä¼šå‘˜ç­‰çº§æ ¸å®è¡Œæè´¹ç”¨

æ£€æŸ¥ä¸ªäººèµ„æ–™ä¸­æœ‰å“ªäº›æ”¯ä»˜æ–¹å¼åŠå…¶ç»„åˆæ˜¯å¦è¢«å…è®¸

è®¡ç®—æ€»ä»·ï¼šæœºç¥¨ä»·æ ¼ + ä»»ä½•è¡Œæè´¹ç”¨

è·å–æ˜ç¡®çš„é¢„è®¢ç¡®è®¤
<span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">think_tool_example_2</span>&gt;</span></span>
</code></pre>
<h2 data-id="heading-4">ç»“è¯­</h2>
<p>æœ¬æ–‡æ˜¯å¯ä»¥æ‹†æˆå››ç¯‡æ–‡ç« åˆ†å¼€å†™çš„ï¼Œä½†æ˜¯æ‹†å¼€ä¹‹åä¸åˆ©äºè¯»è€…åœ¨å®è§‚è§†è§’ä¸Šçš„è®¤çŸ¥æå‡ï¼Œæœ€ç»ˆè¿˜æ˜¯å†³å®šæ”¾åˆ°ä¸€ç¯‡æ–‡ç« ä¸­ã€‚</p>
<p>æœ€åæ€»ç»“ä¸€ä¸‹å››ä¸ªæ–¹æ¡ˆåœ¨æˆ‘ä»¬çš„AIäº§å“ä¸­çš„é€‰æ‹©ï¼Œè¦æ ¹æ®æˆ‘ä»¬çš„éœ€æ±‚ï¼ŒåŠ¨æ€çš„è°ƒæ•´åº”ç”¨æ–¹æ¡ˆï¼š</p>
<p><strong>å¯¹è¯æ¨¡å‹</strong>ï¼šç›´æ¥æ¨¡å¼åŒ¹é…å’Œè¾“å‡ºã€æˆæœ¬æœ€ä½ï¼Œå“åº”æœ€å¿«, å½“æˆ‘ä»¬å¯¹å“åº”æ—¶é—´æœ‰è¦æ±‚æ—¶ï¼Œé¦–é€‰å¯¹è¯æ¨¡å‹</p>
<p><strong>CoT</strong>ï¼šå¼•å¯¼çš„é€æ­¥æ¨ç†ã€ä¸­ç­‰æˆæœ¬ï¼Œéœ€è¦ç¼–å†™Cotæç¤ºè¯ï¼Œæ•´ä½“æ•ˆæœä¸å¦‚æ·±åº¦æ€è€ƒï¼Œå½“æˆ‘ä»¬éœ€è¦ä¸€äº›ç®€å•çš„æ€è€ƒè¾“å‡ºï¼Œåˆä¸æƒ³æ‰¿æ‹…å¤ªå¤šçš„æ—¶é—´æˆæœ¬å’Œæ¨ç†æˆæœ¬æ—¶ï¼Œå¯ä»¥é€‰æ‹©CoT</p>
<p><strong>æ·±åº¦æ€è€ƒ</strong>ï¼šå†…ç½®çš„å¤æ‚æ¨ç†èƒ½åŠ›ã€é«˜æˆæœ¬ã€é•¿æ—¶é—´æ¨ç†ï¼Œå½“æˆ‘ä»¬è¦åšä¸€äº›ä»»åŠ¡ç±»å‹çš„Agentè®¾è®¡æ—¶ï¼Œæˆ‘ä»¬å¯¹å“åº”æ—¶é—´è¦æ±‚ä¸æ˜¯ç‰¹åˆ«é«˜ï¼Œä½†æ˜¯å¯¹ç»“æœè¦æ±‚å¾ˆé«˜æ—¶ï¼Œå¯ä»¥é€‰æ‹©æ·±åº¦æ€è€ƒ</p>
<p><strong>æ€è€ƒå·¥å…·</strong>ï¼šå®æ—¶çš„ç­–ç•¥è°ƒæ•´å’Œåæ€ã€æˆæœ¬å¯æ§ï¼Œéœ€è¦ä½¿ç”¨è€…å¯¹Agentæµç¨‹æœ‰æŠŠæ§èƒ½åŠ›ï¼Œåœ¨æ­£ç¡®çš„èŠ‚ç‚¹ä½¿ç”¨æ€è€ƒå·¥å…·ï¼Œå¯ä»¥æé«˜æ•ˆæœï¼Œå¹¶æ›´å°‘çš„æ‰¿æ‹…æ·±åº¦æ€è€ƒæ‰€å¸¦æ¥çš„ç¼ºé™·ã€‚</p>
<p>æˆ‘æ˜¯åæ´›ï¼Œå…³æ³¨æˆ‘ï¼Œå­¦ä¹ æ›´å¤šAIè½åœ°çš„å®æˆ˜ç»éªŒä¸æŠ€å·§ã€‚</p>
<p>åŠ æ²¹ï¼Œå…±å‹‰ã€‚</p>
<blockquote>
<p>â˜ºï¸ä½ å¥½ï¼Œæˆ‘æ˜¯<strong>åæ´›</strong>ï¼ŒAll in AIå¤šå¹´ï¼Œä¸“æ³¨äºAIåœ¨äº§å“ä¾§çš„åº”ç”¨ä»¥åŠä¼ä¸šAIå‘˜å·¥çš„è®¾è®¡ã€‚</p>
</blockquote>
<h2 data-id="heading-5">ä¸“æ æ–‡ç« </h2>
<p><a href="https://juejin.cn/post/7583507286317465600" target="_blank" title="https://juejin.cn/post/7583507286317465600"># ä¸ºå•¥ä½ å­¦AIå­¦æ¥å­¦å»å­¦ä¸æ˜ç™½ï¼</a></p>
<p><a href="https://juejin.cn/post/7547051639740743721" target="_blank" title="https://juejin.cn/post/7547051639740743721"># SEOè¿˜æ²¡æ­»ï¼ŒGEOä¹‹æˆ˜å·²ç»å¼€å§‹</a></p>
<p><a href="https://juejin.cn/post/7497890801348821055" title="https://juejin.cn/post/7497890801348821055" target="_blank"># ä»0åˆ°1æ‰“é€ ä¼ä¸šçº§AIå”®å‰æœºå™¨äººâ€”â€”å®æˆ˜æŒ‡å—äºŒï¼šRAGå·¥ç¨‹è½åœ°ä¹‹æ•°æ®å¤„ç†ç¯‡ğŸ§</a></p>
<p><a href="https://juejin.cn/post/7496397558358900790" title="https://juejin.cn/post/7496397558358900790" target="_blank"># ä»0åˆ°1æ‰“é€ ä¼ä¸šçº§AIå”®å‰æœºå™¨äººâ€”â€”å®æˆ˜æŒ‡å—ä¸€ï¼šæ ¹æ®äº§å“éœ€æ±‚å’Œå®šä½è¿›è¡Œagentæµç¨‹è®¾è®¡ğŸ§</a></p>
<p><a href="https://juejin.cn/post/7492271537010671635" title="https://juejin.cn/post/7492271537010671635" target="_blank"># èŠä¸€ä¸‹MCPï¼Œå¸Œæœ›èƒ½è®©å„ä½æ¸…é†’ä¸€ç‚¹å§ğŸ§</a></p>
<p><a href="https://juejin.cn/post/7485727472999579659" title="https://juejin.cn/post/7485727472999579659" target="_blank"># å®æˆ˜æ´¾ï¼ç™¾ä¸‡PVçš„AIäº§å“å¦‚ä½•æ­å»ºRAGç³»ç»Ÿï¼Ÿ</a></p>
<p><a href="https://juejin.cn/post/7482695183477047315" title="https://juejin.cn/post/7482695183477047315" target="_blank"># å›¢é˜Ÿè½åœ°AIäº§å“çš„å…¨æµç¨‹</a></p>
<p><a href="https://juejin.cn/post/7474925725662969883" title="https://juejin.cn/post/7474925725662969883" target="_blank"># 5000å­—é•¿æ–‡ï¼ŒAIæ—¶ä»£ä¸‹ç¨‹åºå‘˜çš„å·¨å¤§ä¼˜åŠ¿ï¼</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>