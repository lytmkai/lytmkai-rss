<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[JavaTreeMapæºç åˆ†æ]]></title>    <link>https://juejin.cn/post/7578724773993562138</link>    <guid>https://juejin.cn/post/7578724773993562138</guid>    <pubDate>2025-12-01T16:19:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578724773993562138" data-draft-id="7578724773993545754" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaTreeMapæºç åˆ†æ"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-01T16:19:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="makinohara"/> <meta itemprop="url" content="https://juejin.cn/user/455637552340731"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaTreeMapæºç åˆ†æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/455637552340731/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    makinohara
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-01T16:19:20.000Z" title="Mon Dec 01 2025 16:19:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>èŠ‚ç‚¹å†…éƒ¨å±æ€§ï¼š</strong></p>
<p>TreeMapä¸­ï¼Œæ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯Entryå¯¹è±¡ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"> Â  Â static final class Entry&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; {
 Â  Â  Â  Â K key<span class="hljs-comment">;</span>
 Â  Â  Â  Â V value<span class="hljs-comment">;</span>
 Â  Â  Â  Â Entry&lt;K,V&gt; left<span class="hljs-comment">;</span>
 Â  Â  Â  Â Entry&lt;K,V&gt; right<span class="hljs-comment">;</span>
 Â  Â  Â  Â Entry&lt;K,V&gt; parent<span class="hljs-comment">;</span>
 Â  Â  Â  Â boolean <span class="hljs-attr">color</span> = BLACK<span class="hljs-comment">;</span>
</code></pre>
<p><strong>ä¸€äº›æˆå‘˜å˜é‡ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"> Â  Â <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Comparator&lt;? <span class="hljs-built_in">super</span> K&gt; comparator;
â€‹
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> Entry&lt;K,V&gt; root;
â€‹
 Â  Â <span class="hljs-comment">/**
 Â  Â  * The number of entries in the tree
 Â  Â  */</span>
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
</code></pre>
<p>comparatorè¡¨ç¤ºæ¯”è¾ƒæ–¹æ³•ï¼Œrootä¸ºæ ¹èŠ‚ç‚¹åœ°å€å€¼ï¼Œsizeä¸ºèŠ‚ç‚¹æ•°é‡ã€‚</p>
<p><strong>ç©ºå‚æ„é€ ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"> Â  Â <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TreeMap</span>()</span> {
 Â  Â  Â  Â comparator = <span class="hljs-literal">null</span>;
 Â   }
</code></pre>
<p><strong>å¸¦å‚æ„é€ ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"> <span class="hljs-keyword">public</span> <span class="hljs-title function_">TreeMap</span><span class="hljs-params">(Comparator&lt;? <span class="hljs-built_in">super</span> K&gt; comparator)</span> {
 Â  Â  Â  Â <span class="hljs-built_in">this</span>.comparator = comparator;
 Â   }
</code></pre>
<p><strong>æ·»åŠ å…ƒç´ ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini"> public V put(K key, V value) {
 Â  Â  Â  Â Entry&lt;K,V&gt; <span class="hljs-attr">t</span> = root<span class="hljs-comment">;</span>
 Â  Â  Â  Â if (<span class="hljs-attr">t</span> == null) {
 Â  Â  Â  Â  Â  Â compare(key, key)<span class="hljs-comment">; // type (and possibly null) check</span>
â€‹
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">root</span> = new Entry&lt;&gt;(key, value, null)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">size</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â modCount++<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â return null<span class="hljs-comment">;</span>
 Â  Â  Â   }
 Â  Â  Â  Â int cmp<span class="hljs-comment">;</span>
 Â  Â  Â  Â Entry&lt;K,V&gt; parent<span class="hljs-comment">;</span>
 Â  Â  Â  Â // split comparator and comparable paths
 Â  Â  Â  Â Comparator&lt;? super K&gt; <span class="hljs-attr">cpr</span> = comparator<span class="hljs-comment">;</span>
 Â  Â  Â  Â if (cpr != null) {
 Â  Â  Â  Â  Â  Â do {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">parent</span> = t<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">cmp</span> = cpr.compare(key, t.key)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â if (cmp &lt; 0)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">t</span> = t.left<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else if (cmp &gt; 0)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">t</span> = t.right<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return t.setValue(value)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   } while (t != null)<span class="hljs-comment">;</span>
 Â  Â  Â   }
 Â  Â  Â  Â else {
 Â  Â  Â  Â  Â  Â if (<span class="hljs-attr">key</span> == null)
 Â  Â  Â  Â  Â  Â  Â  Â throw new NullPointerException()<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â @SuppressWarnings("unchecked")
 Â  Â  Â  Â  Â  Â  Â  Â Comparable&lt;? super K&gt; <span class="hljs-attr">k</span> = (Comparable&lt;? super K&gt;) key<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â do {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">parent</span> = t<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">cmp</span> = k.compareTo(t.key)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â if (cmp &lt; 0)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">t</span> = t.left<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else if (cmp &gt; 0)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">t</span> = t.right<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return t.setValue(value)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   } while (t != null)<span class="hljs-comment">;</span>
 Â  Â  Â   }
 Â  Â  Â  Â Entry&lt;K,V&gt; <span class="hljs-attr">e</span> = new Entry&lt;&gt;(key, value, parent)<span class="hljs-comment">;</span>
 Â  Â  Â  Â if (cmp &lt; 0)
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">parent.left</span> = e<span class="hljs-comment">;</span>
 Â  Â  Â  Â else
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">parent.right</span> = e<span class="hljs-comment">;</span>
 Â  Â  Â  Â fixAfterInsertion(e)<span class="hljs-comment">;</span>
 Â  Â  Â  Â size++<span class="hljs-comment">;</span>
 Â  Â  Â  Â modCount++<span class="hljs-comment">;</span>
 Â  Â  Â  Â return null<span class="hljs-comment">;</span>
 Â   }
â€‹
</code></pre>
<p>é¦–å…ˆï¼Œè·å–æ ¹èŠ‚ç‚¹çš„åœ°å€å€¼ï¼Œèµ‹å€¼ç»™å±€éƒ¨å˜é‡t</p>
<p>å¦‚æœtä¸ºnullï¼Œè¡¨ç¤ºå½“å‰æ˜¯ç¬¬ä¸€æ¬¡æ·»åŠ ï¼Œåˆ›å»ºæ ¹èŠ‚ç‚¹ï¼Œè¿”å›nullï¼Œè¡¨ç¤ºæ²¡æœ‰è¦†ç›–ä»»ä½•å…ƒç´ ã€‚</p>
<p>å¦‚æœä¸ä¸ºnullï¼Œæ¥ç€å¾€ä¸‹çœ‹ã€‚</p>
<p>cmpæ˜¯ä¸¤ä¸ªå…ƒç´ çš„é”®æ¯”è¾ƒä¹‹åçš„ç»“æœï¼Œè´Ÿæ•°è¡¨ç¤ºå½“å‰è¦æ·»åŠ çš„å…ƒç´ è¾ƒå°ï¼Œæ”¾åœ¨å·¦å­æ ‘ã€‚æ­£æ•°è¡¨ç¤ºå½“å‰è¦æ·»åŠ çš„å…ƒç´ è¾ƒå¤§ï¼Œæ”¾åœ¨å³å­æ ‘ã€‚</p>
<p>æ–°å»ºä¸€ä¸ªåä¸ºparentçš„Entryå¯¹è±¡ï¼Œè¡¨ç¤ºè¦æ·»åŠ çš„èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ã€‚</p>
<p>å°†æˆå‘˜å˜é‡comparatorèµ‹å€¼ç»™cprï¼Œè¡¨ç¤ºæ¯”è¾ƒè§„åˆ™ã€‚å¦‚æœæˆ‘ä»¬é‡‡å–çš„æ˜¯é»˜è®¤çš„è‡ªç„¶æ’åºï¼Œé‚£ä¹ˆcomparatorä¸ºnullï¼Œå³cprä¸ºnull</p>
<p>å¦‚æœæœ‰æ¯”è¾ƒå™¨å¯¹è±¡ï¼Œèµ°ifè¯­å¥ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"> Â  Â  Â  Â if (cpr != null) {
 Â  Â  Â  Â  Â  Â do {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">parent</span> = t<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">cmp</span> = cpr.compare(key, t.key)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â if (cmp &lt; 0)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">t</span> = t.left<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else if (cmp &gt; 0)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">t</span> = t.right<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return t.setValue(value)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   } while (t != null)<span class="hljs-comment">;</span>
 Â  Â  Â   }
</code></pre>
<p>å¦‚æœæ˜¯è‡ªç„¶æ’åºï¼Œèµ°elseè¯­å¥ï¼Œç”±äºç»“æ„ç±»ä¼¼ï¼Œåªåˆ†æelseè¯­å¥ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"> Â  Â  Â  Â else {
 Â  Â  Â  Â  Â  Â if (<span class="hljs-attr">key</span> == null)
 Â  Â  Â  Â  Â  Â  Â  Â throw new NullPointerException()<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â @SuppressWarnings("unchecked")
 Â  Â  Â  Â  Â  Â  Â  Â Comparable&lt;? super K&gt; <span class="hljs-attr">k</span> = (Comparable&lt;? super K&gt;) key<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â do {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">parent</span> = t<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">cmp</span> = k.compareTo(t.key)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â if (cmp &lt; 0)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">t</span> = t.left<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else if (cmp &gt; 0)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">t</span> = t.right<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return t.setValue(value)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   } while (t != null)<span class="hljs-comment">;</span>
 Â  Â  Â   }
</code></pre>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œå°†keyå¼ºè½¬ä¸ºComparableç±»å‹ï¼Œå› æ­¤é”®å¿…é¡»è¦å®ç°Comparableæ¥å£</p>
<p>æ¥ç€ï¼Œå°†æ ¹èŠ‚ç‚¹å½“ä½œå½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ã€‚è°ƒç”¨<code>compareTo</code>æ–¹æ³•ï¼Œæ¯”è¾ƒå½“å‰èŠ‚ç‚¹ä¸æ ¹èŠ‚ç‚¹é”®çš„å¤§å°å…³ç³»ã€‚å¦‚æœä¸ºè´Ÿæ•°ï¼Œå°±å»å·¦å­æ ‘æ‰¾æœ€åˆé€‚çš„çˆ¶èŠ‚ç‚¹ï¼Œåä¹‹å»å³å­æ ‘æ‰¾æœ€åˆé€‚çš„çˆ¶èŠ‚ç‚¹ã€‚å¦‚æœç›¸ç­‰ï¼Œè°ƒç”¨<code>setValue</code>æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"> Â  Â  Â  Â public V setValue(V value) {
 Â  Â  Â  Â  Â  Â V <span class="hljs-attr">oldValue</span> = this.value<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">this.value</span> = value<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â return oldValue<span class="hljs-comment">;</span>
 Â  Â  Â   }
</code></pre>
<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–¹æ³•å®é™…ä¸Šæ˜¯åšäº†ä¸€ä¸ªè¦†ç›–ï¼Œå¹¶è¿”å›è¢«è¦†ç›–çš„å€¼ã€‚</p>
<p>å¾ªç¯èµ°è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°tä¸ºç©ºã€‚å†æ¥çœ‹çœ‹tä¸ºç©ºä¹‹ååˆåšäº†äº›ä»€ä¹ˆï¼š</p>
<pre><code class="hljs language-ini" lang="ini"> Â  Â  Â  Â Entry&lt;K,V&gt; <span class="hljs-attr">e</span> = new Entry&lt;&gt;(key, value, parent)<span class="hljs-comment">;</span>
 Â  Â  Â  Â if (cmp &lt; 0)
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">parent.left</span> = e<span class="hljs-comment">;</span>
 Â  Â  Â  Â else
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">parent.right</span> = e<span class="hljs-comment">;</span>
 Â  Â  Â  Â fixAfterInsertion(e)<span class="hljs-comment">;</span>
 Â  Â  Â  Â size++<span class="hljs-comment">;</span>
 Â  Â  Â  Â modCount++<span class="hljs-comment">;</span>
 Â  Â  Â  Â return null<span class="hljs-comment">;</span>
</code></pre>
<p>ç”±äºåœ¨æ¯ä¸€æ¬¡doè¯­å¥ä¸­éƒ½ä¼šæŠŠtèµ‹å€¼ç»™parentï¼Œå› æ­¤æœ€ç»ˆparentå¿…ç„¶ä¼šæ˜¯å¾…æ·»åŠ èŠ‚ç‚¹æœ€åˆé€‚çš„çˆ¶èŠ‚ç‚¹ã€‚åˆ›å»ºä¸€ä¸ªEntryå¯¹è±¡è¡¨ç¤ºå¾…æ·»åŠ çš„èŠ‚ç‚¹ï¼Œç„¶åæ ¹æ®cmpçš„å¤§å°å†³å®šå®ƒåº”è¯¥æ”¾çˆ¶èŠ‚ç‚¹çš„å·¦è¾¹è¿˜æ˜¯å³è¾¹ï¼Œå¹¶å»ºç«‹è¿æ¥ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“è¿™å¹¶ä¸ç¬¦åˆçº¢é»‘æ ‘çš„è§„åˆ™ï¼Œå› æ­¤è¿˜è¦åœ¨<code>fixAfterInsertion</code>ä¸­è¿›è¡Œè°ƒæ•´ã€‚</p>
<pre><code class="hljs language-scss" lang="scss"> Â  private void <span class="hljs-built_in">fixAfterInsertion</span>(Entry&lt;K,V&gt; x) {
 Â  Â  Â  Â x<span class="hljs-selector-class">.color</span> = RED;
â€‹
 Â  Â  Â  Â while (x != null &amp;&amp; x != root &amp;&amp; x.parent.color == RED) {
 Â  Â  Â  Â  Â  Â if (parentOf(x) == <span class="hljs-built_in">leftOf</span>(parentOf(parentOf(x)))) {
 Â  Â  Â  Â  Â  Â  Â  Â Entry&lt;K,V&gt; y = <span class="hljs-built_in">rightOf</span>(parentOf(parentOf(x)));
 Â  Â  Â  Â  Â  Â  Â  Â if (colorOf(y) == RED) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">setColor</span>(parentOf(x), BLACK);
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">setColor</span>(y, BLACK);
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">setColor</span>(parentOf(parentOf(x)), RED);
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â x = <span class="hljs-built_in">parentOf</span>(parentOf(x));
 Â  Â  Â  Â  Â  Â  Â   } else {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (x == rightOf(parentOf(x))) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â x = <span class="hljs-built_in">parentOf</span>(x);
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">rotateLeft</span>(x);
 Â  Â  Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">setColor</span>(parentOf(x), BLACK);
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">setColor</span>(parentOf(parentOf(x)), RED);
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">rotateRight</span>(parentOf(parentOf(x)));
 Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â   } else {
 Â  Â  Â  Â  Â  Â  Â  Â Entry&lt;K,V&gt; y = <span class="hljs-built_in">leftOf</span>(parentOf(parentOf(x)));
 Â  Â  Â  Â  Â  Â  Â  Â if (colorOf(y) == RED) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">setColor</span>(parentOf(x), BLACK);
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">setColor</span>(y, BLACK);
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">setColor</span>(parentOf(parentOf(x)), RED);
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â x = <span class="hljs-built_in">parentOf</span>(parentOf(x));
 Â  Â  Â  Â  Â  Â  Â   } else {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (x == leftOf(parentOf(x))) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â x = <span class="hljs-built_in">parentOf</span>(x);
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">rotateRight</span>(x);
 Â  Â  Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">setColor</span>(parentOf(x), BLACK);
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">setColor</span>(parentOf(parentOf(x)), RED);
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-built_in">rotateLeft</span>(parentOf(parentOf(x)));
 Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â   }
 Â  Â  Â   }
 Â  Â  Â  Â root<span class="hljs-selector-class">.color</span> = BLACK;
 Â   }
</code></pre>
<p>åœ¨è¯¥æ–¹æ³•ä¸­ï¼Œä¸€ä¸Šæ¥å°±å°†èŠ‚ç‚¹çš„é¢œè‰²è°ƒæ•´ä¸ºçº¢è‰²ã€‚æ¯•ç«Ÿçº¢é»‘æ ‘ä¸­æ·»åŠ çš„èŠ‚ç‚¹é»˜è®¤éƒ½æ˜¯çº¢è‰²çš„ã€‚</p>
<p>å‡ ä¸ªå‡½æ•°ï¼š</p>
<p>parentOf(x)ï¼šè·å–xçš„çˆ¶èŠ‚ç‚¹</p>
<p>parentOf(parentOf(x))ï¼šè·å–xçš„çˆ·çˆ·èŠ‚ç‚¹</p>
<p>leftOf(x)ï¼šè·å–xçš„å·¦å­èŠ‚ç‚¹</p>
<p>rightOf(x)ï¼šè·å–xçš„å³å­èŠ‚ç‚¹</p>
<p>é€šè¿‡è¿™å››ä¸ªå‡½æ•°ï¼Œå¯ä»¥è·å¾—xçš„å”å”èŠ‚ç‚¹ï¼šleftOf(parentOf(parentOf(x)))æˆ–è€…rightOf(parentOf(parentOf(x)))</p>
<p>æœ€åçš„å‡ ä¸ªé—®é¢˜ï¼š</p>
<p>â“TreeMapæ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œæ˜¯å¦éœ€è¦é‡å†™<code>hashCode</code>ä¸<code>equals</code>æ–¹æ³•ï¼Ÿ</p>
<p>ç­”ï¼šä¸éœ€è¦ã€‚putä¸­æ²¡æœ‰æ¶‰åŠåˆ°è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯å’ŒHashMapæœ‰å…³çš„ï¼Œè§ä¸Šä¸€ç¯‡æ–‡ç« ã€ŠJavaHashMapæºç åˆ†æã€‹</p>
<p>â“æ—¢ç„¶æœ‰çº¢é»‘æ ‘ï¼ŒHashMapçš„é”®æ˜¯å¦éœ€è¦å®ç°Comparableæ¥å£æˆ–è€…ä¼ é€’æ¯”è¾ƒå™¨å¯¹è±¡å‘¢ï¼Ÿ</p>
<p>ç­”ï¼šä¸éœ€è¦ã€‚å› ä¸ºåœ¨HashMapçš„åº•å±‚ï¼Œé»˜è®¤æ˜¯åˆ©ç”¨é”®çš„å“ˆå¸Œå€¼å¤§å°å…³ç³»æ¥åˆ›å»ºçº¢é»‘æ ‘çš„ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬å›åˆ°ä¸Šä¸€ç¯‡æ–‡ç« çš„å†…å®¹ï¼Œå›åˆ°HashMapæºç ä¸­çš„<code>putVal</code>æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"> Â  Â final V putVal(int hash, K key, V value, boolean onlyIfAbsent,
 Â  Â  Â  Â  Â  Â  Â  Â  Â  boolean evict) {
 Â  Â  Â  Â Node&lt;K,V&gt;<span class="hljs-section">[]</span> tab<span class="hljs-comment">; Node&lt;K,V&gt; p; int n, i;</span>
 Â  Â  Â  Â if ((<span class="hljs-attr">tab</span> = table) == null || (n = tab.length) == <span class="hljs-number">0</span>)
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">n</span> = (tab = resize()).length<span class="hljs-comment">;</span>
 Â  Â  Â  Â if ((<span class="hljs-attr">p</span> = tab[i = (n - <span class="hljs-number">1</span>) &amp; hash]) == null)
 Â  Â  Â  Â  Â  Â tab<span class="hljs-section">[i]</span> = newNode(hash, key, value, null)<span class="hljs-comment">;</span>
 Â  Â  Â  Â else {
 Â  Â  Â  Â  Â  Â Node&lt;K,V&gt; e<span class="hljs-comment">; K k;</span>
 Â  Â  Â  Â  Â  Â if (<span class="hljs-attr">p.hash</span> == hash &amp;&amp;
 Â  Â  Â  Â  Â  Â  Â   ((<span class="hljs-attr">k</span> = p.key) == key || (key != null &amp;&amp; key.equals(k))))
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">e</span> = p<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â else if (p instanceof TreeNode)
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">e</span> = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â else {
 Â  Â  Â  Â  Â  Â  Â  Â for (int <span class="hljs-attr">binCount</span> = <span class="hljs-number">0</span><span class="hljs-comment">; ; ++binCount) {</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if ((<span class="hljs-attr">e</span> = p.next) == null) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">p.next</span> = newNode(hash, key, value, null)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â treeifyBin(tab, hash)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â break<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (<span class="hljs-attr">e.hash</span> == hash &amp;&amp;
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   ((<span class="hljs-attr">k</span> = e.key) == key || (key != null &amp;&amp; key.equals(k))))
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â break<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">p</span> = e<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â if (e != null) { // existing mapping for key
 Â  Â  Â  Â  Â  Â  Â  Â V <span class="hljs-attr">oldValue</span> = e.value<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â if (!onlyIfAbsent || <span class="hljs-attr">oldValue</span> == null)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">e.value</span> = value<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â afterNodeAccess(e)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â return oldValue<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   }
 Â  Â  Â   }
 Â  Â  Â  Â ++modCount<span class="hljs-comment">;</span>
 Â  Â  Â  Â if (++size &gt; threshold)
 Â  Â  Â  Â  Â  Â resize()<span class="hljs-comment">;</span>
 Â  Â  Â  Â afterNodeInsertion(evict)<span class="hljs-comment">;</span>
 Â  Â  Â  Â return null<span class="hljs-comment">;</span>
 Â   }
</code></pre>
<p>æ³¨æ„åˆ°è¿™é‡Œï¼š</p>
<pre><code class="hljs language-ini" lang="ini">            else if (p instanceof TreeNode)
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">e</span> = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value)<span class="hljs-comment">;</span>
</code></pre>
<p>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹<code>putTreeVal</code>æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"> Â  Â  Â  Â final TreeNode&lt;K,V&gt; putTreeVal(HashMap&lt;K,V&gt; map, Node&lt;K,V&gt;<span class="hljs-section">[]</span> tab,
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  int h, K k, V v) {
 Â  Â  Â  Â  Â  Â Class&lt;?&gt; <span class="hljs-attr">kc</span> = null<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â boolean <span class="hljs-attr">searched</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â TreeNode&lt;K,V&gt; <span class="hljs-attr">root</span> = (parent != null) ? root() : this<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â for (TreeNode&lt;K,V&gt; <span class="hljs-attr">p</span> = root<span class="hljs-comment">;;) {</span>
 Â  Â  Â  Â  Â  Â  Â  Â int dir, ph<span class="hljs-comment">; K pk;</span>
 Â  Â  Â  Â  Â  Â  Â  Â if ((<span class="hljs-attr">ph</span> = p.hash) &gt; h)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">dir</span> = -<span class="hljs-number">1</span><span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else if (ph &lt; h)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">dir</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else if ((<span class="hljs-attr">pk</span> = p.key) == k || (k != null &amp;&amp; k.equals(pk)))
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return p<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else if ((<span class="hljs-attr">kc</span> == null &amp;&amp;
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   (<span class="hljs-attr">kc</span> = comparableClassFor(k)) == null) ||
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  (<span class="hljs-attr">dir</span> = compareComparables(kc, k, pk)) == <span class="hljs-number">0</span>) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (!searched) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â TreeNode&lt;K,V&gt; q, ch<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">searched</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (((<span class="hljs-attr">ch</span> = p.left) != null &amp;&amp;
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  (<span class="hljs-attr">q</span> = ch.find(h, k, kc)) != null) ||
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   ((<span class="hljs-attr">ch</span> = p.right) != null &amp;&amp;
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  (<span class="hljs-attr">q</span> = ch.find(h, k, kc)) != null))
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return q<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">dir</span> = tieBreakOrder(k, pk)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â   }
â€‹
 Â  Â  Â  Â  Â  Â  Â  Â TreeNode&lt;K,V&gt; <span class="hljs-attr">xp</span> = p<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â if ((<span class="hljs-attr">p</span> = (dir &lt;= <span class="hljs-number">0</span>) ? p.left : p.right) == null) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Node&lt;K,V&gt; <span class="hljs-attr">xpn</span> = xp.next<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â TreeNode&lt;K,V&gt; <span class="hljs-attr">x</span> = map.newTreeNode(h, k, v, xpn)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (dir &lt;= 0)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">xp.left</span> = x<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â else
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">xp.right</span> = x<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">xp.next</span> = x<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">x.parent</span> = x.prev = xp<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (xpn != null)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   ((TreeNode&lt;K,V&gt;)xpn).<span class="hljs-attr">prev</span> = x<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â moveRootToFront(tab, balanceInsertion(root, x))<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return null<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â   }
 Â  Â  Â   }
â€‹
</code></pre>
<p>è¿›ä¸€æ­¥æŸ¥çœ‹findæ–¹æ³•ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"> Â  Â  Â  Â final TreeNode&lt;K,V&gt; find(int h, Object k, Class&lt;?&gt; kc) {
 Â  Â  Â  Â  Â  Â TreeNode&lt;K,V&gt; <span class="hljs-attr">p</span> = this<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â do {
 Â  Â  Â  Â  Â  Â  Â  Â int ph, dir<span class="hljs-comment">; K pk;</span>
 Â  Â  Â  Â  Â  Â  Â  Â TreeNode&lt;K,V&gt; <span class="hljs-attr">pl</span> = p.left, pr = p.right, q<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â if ((<span class="hljs-attr">ph</span> = p.hash) &gt; h)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">p</span> = pl<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else if (ph &lt; h)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">p</span> = pr<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else if ((<span class="hljs-attr">pk</span> = p.key) == k || (k != null &amp;&amp; k.equals(pk)))
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return p<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else if (<span class="hljs-attr">pl</span> == null)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">p</span> = pr<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else if (<span class="hljs-attr">pr</span> == null)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">p</span> = pl<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else if ((kc != null ||
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   (<span class="hljs-attr">kc</span> = comparableClassFor(k)) != null) &amp;&amp;
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  (<span class="hljs-attr">dir</span> = compareComparables(kc, k, pk)) != <span class="hljs-number">0</span>)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">p</span> = (dir &lt; <span class="hljs-number">0</span>) ? pl : pr<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else if ((<span class="hljs-attr">q</span> = pr.find(h, k, kc)) != null)
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â return q<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â  Â  Â else
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">p</span> = pl<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â   } while (p != null)<span class="hljs-comment">;</span>
 Â  Â  Â  Â  Â  Â return null<span class="hljs-comment">;</span>
 Â  Â  Â   }
</code></pre>
<p>é€šè¿‡<code>(ph == p.hash) &gt; h</code>ç­‰è¯­å¥å¯ä»¥çœ‹å‡ºï¼Œçš„ç¡®æ˜¯ä½¿ç”¨é”®çš„å“ˆå¸Œå€¼å¤§å°å…³ç³»æ¥åˆ›å»ºçº¢é»‘æ ‘ã€‚</p>
<p>â“TreeMapå’ŒHashMapè°çš„æ•ˆç‡æ›´é«˜ï¼Ÿ</p>
<p>ç­”ï¼šå¦‚æœæ˜¯æœ€åæƒ…å†µï¼Œæ·»åŠ çš„8ä¸ªå…ƒç´ å…¨éƒ½å½¢æˆäº†é“¾è¡¨ï¼Œé‚£å°±æ˜¯TreeMapçš„æ•ˆç‡æ›´é«˜ã€‚å‰è€…çš„æŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼Œåè€…ä¸ºO(logn)ã€‚ä½†è¿™ç§æƒ…å†µå‡ºç°çš„æ¦‚ç‡å¾ˆå°ï¼Œæ‰€ä»¥ä¸€èˆ¬è€Œè¨€HashMapçš„æ•ˆç‡æ›´é«˜ã€‚æœ€ä¼˜æƒ…å†µä¸‹å…¶æŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ä¸ºO(1)</p>
<p>â“ä¸‰ç§åŒåˆ—é›†åˆå¦‚ä½•é€‰æ‹©ï¼Ÿ</p>
<p>ç­”ï¼šé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨HashMapï¼Œä¸€èˆ¬æƒ…å†µä¸‹å®ƒçš„æ•ˆç‡æœ€é«˜</p>
<p>å¦‚æœè¦ä¿è¯å­˜å–æœ‰åºï¼Œç”¨LinkedHashMapï¼Œå› ä¸ºå®ƒåº•å±‚æ˜¯åŒå‘é“¾è¡¨</p>
<p>å¦‚æœè¦è¿›è¡Œæ’åºï¼Œç”¨TreeMap</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Ubuntu éƒ¨ç½² RustDesk æœåŠ¡å™¨]]></title>    <link>https://juejin.cn/post/7578699975414349824</link>    <guid>https://juejin.cn/post/7578699975414349824</guid>    <pubDate>2025-12-01T16:46:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578699975414349824" data-draft-id="7578734725302239284" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Ubuntu éƒ¨ç½² RustDesk æœåŠ¡å™¨"/> <meta itemprop="keywords" content="Ubuntu"/> <meta itemprop="datePublished" content="2025-12-01T16:46:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤©å®"/> <meta itemprop="url" content="https://juejin.cn/user/187362547083252"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Ubuntu éƒ¨ç½² RustDesk æœåŠ¡å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/187362547083252/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤©å®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-01T16:46:22.000Z" title="Mon Dec 01 2025 16:46:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#5f6368;background-image:linear-gradient(90deg,rgba(240,191,213,.1) 3%,transparent 0),linear-gradient(1turn,rgba(240,191,213,.1) 3%,transparent 0);background-size:20px 20px;background-position:50%;letter-spacing:1px;word-spacing:1px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-left:50px;padding-bottom:5px;color:#5f6368}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{position:absolute;left:0;display:block;content:""}.markdown-body h1{font-size:32px;margin-bottom:5px}.markdown-body h1:before{top:0;content:"ğŸ¦„";font-size:32px}.markdown-body h2{padding-bottom:24px;border-bottom:1px solid #ececec}.markdown-body h2:before{top:0;left:8px;content:"ğŸ³";font-size:24px}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{top:-2px;left:8px;content:"ğŸ„";font-size:20px}.markdown-body h4{font-size:16px}.markdown-body h4:before{top:-2px;left:8px;content:"ğŸ¦¥";font-size:18px}.markdown-body h5{font-size:14px}.markdown-body h5:before{top:-2px;left:9px;content:"ğŸ¦©";font-size:16px}.markdown-body h6{font-size:12px;margin-top:5px}.markdown-body h6:before{top:-1px;left:10px;content:"ğŸ§";font-size:14px}.markdown-body p{line-height:1.9;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid rgba(253,121,168,.5);margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#a6accd;background:#292d3e;border-radius:8px}.markdown-body a{text-decoration:none;color:#fd79a8;border-bottom:1px solid #fd79a8;padding:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(253,121,168,.1);color:#ee69a9}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body th{color:#fd79a8}.markdown-body th,.markdown-body tr:hover{background:rgba(253,121,168,.1)}.markdown-body td{min-width:120px}.markdown-body blockquote{position:relative;color:#666;padding:23px;margin:22px 0;border-left:4px solid #ee69a9;background-color:rgba(253,121,168,.1)}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;display:block;font-size:27px;color:#fd79a8;opacity:.8}.markdown-body blockquote:before{left:10px;top:0;content:"â"}.markdown-body blockquote:after{right:10px;bottom:0;content:"â"}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body strong{position:relative;color:#fd79a8}.markdown-body strong:before{content:"Â· "}.markdown-body strong:after{content:" Â·"}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#fd79a8}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#ee69a9}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p>æœ¬æ–‡é¢å‘åœ¨ Ubuntu ä¸Šè‡ªæ‰˜ç®¡ RustDesk å¼€æºæœåŠ¡å™¨ï¼ˆ<code>hbbs</code>/<code>hbbr</code>ï¼‰ã€‚é€‚ç”¨äºæœ¬åœ°æœºæˆ¿æˆ–äº‘æœåŠ¡å™¨ï¼ˆå¦‚é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€åä¸ºäº‘ç­‰ï¼‰ã€‚</p>
<ul>
<li>å®˜æ–¹å‚è€ƒæ–‡æ¡£ï¼ˆå¼ºçƒˆå»ºè®®åŒæ—¶é˜…è¯»ï¼‰ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Frustdesk.com%2Fdocs%2Fzh-cn%2Fself-host%2Frustdesk-server-oss%2Finstall%2F" target="_blank" title="https://rustdesk.com/docs/zh-cn/self-host/rustdesk-server-oss/install/" ref="nofollow noopener noreferrer">rustdesk.com/docs/zh-cn/â€¦</a></li>
<li>é€‚ç”¨ç³»ç»Ÿï¼šUbuntu 20.04/22.04/24.04ï¼ˆå…¶ä»– Debian ç³»äº¦å¯å‚è€ƒï¼‰</li>
</ul>
<h2 data-id="heading-0">0. å‡†å¤‡å·¥ä½œ</h2>
<ul>
<li>ä¸€å°å¯å…¬ç½‘è®¿é—®çš„ Ubuntu æœåŠ¡å™¨ï¼ˆå…·å¤‡ <code>sudo</code> æƒé™ï¼‰ã€‚</li>
<li>ç¡®ä¿å¯ä»¥é€šè¿‡ <code>ssh</code> ç™»å½•ï¼Œæ‰§è¡ŒåŸºç¡€ç»´æŠ¤å‘½ä»¤ã€‚</li>
<li>å¦‚æœä½¿ç”¨äº‘å‚å•†ï¼Œå…ˆåœ¨äº‘æ§åˆ¶å°å¼€æ”¾ç«¯å£ã€‚</li>
</ul>
<h2 data-id="heading-1">1. å¼€æ”¾ç«¯å£</h2>
<p>äº‘å‚å•†å®‰å…¨ç»„æ˜¯â€œç¬¬ä¸€é“é˜²ç«å¢™â€ï¼Œä»…é…ç½®ç³»ç»Ÿ <code>ufw</code> ä¸å¤Ÿï¼Œå¿…é¡»åœ¨äº‘æ§åˆ¶å°æ”¾è¡Œç«¯å£ã€‚ä»¥é˜¿é‡Œäº‘ä¸ºä¾‹ï¼š</p>
<ul>
<li>ç™»å½• é˜¿é‡Œäº‘ ECS æ§åˆ¶å° â†’ æ‰¾åˆ°ä½ çš„æœåŠ¡å™¨ â†’ å·¦ä¾§ã€Œå®‰å…¨ç»„ã€â†’ é…ç½®è§„åˆ™ã€‚</li>
<li>æ–°å¢ã€Œå…¥æ–¹å‘ã€è§„åˆ™ï¼Œæ”¾è¡Œ RustDesk æ‰€éœ€ç«¯å£ï¼š</li>
</ul>























<table><thead><tr><th>åè®®</th><th>ç«¯å£èŒƒå›´</th><th>æˆæƒå¯¹è±¡</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>TCP</td><td>21114-21119</td><td>0.0.0.0/0</td><td>RustDesk æ ¸å¿ƒ TCP ç«¯å£</td></tr><tr><td>UDP</td><td>21116</td><td>0.0.0.0/0</td><td>RustDesk NAT æ‰“æ´ UDP ç«¯å£</td></tr></tbody></table>
<p>æç¤ºï¼š<code>0.0.0.0/0</code> è¡¨ç¤ºå…è®¸æ‰€æœ‰ IPï¼ˆé€‚åˆæµ‹è¯•ï¼‰ã€‚ç”Ÿäº§ç¯å¢ƒå»ºè®®ç¼©å°åˆ°ä½ çš„åŠå…¬ç½‘æ®µæˆ–æŒ‡å®šå®¢æˆ·ç«¯ IPã€‚</p>
<p>ä¿å­˜è§„åˆ™åï¼Œé€šå¸¸éœ€ç­‰å¾… 1â€“2 åˆ†é’Ÿç”Ÿæ•ˆï¼ˆå®‰å…¨ç»„æœ‰å»¶è¿Ÿï¼‰ã€‚</p>
<p>åŒæ—¶ï¼Œåœ¨æœåŠ¡å™¨ç³»ç»Ÿå†…ä½¿ç”¨ <code>ufw</code> æ”¾è¡Œç«¯å£ï¼ˆå»ºè®®ï¼‰ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">sudo apt update
sudo apt install -y ufw
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow 21114:21119/tcp
sudo ufw allow 21116/udp
sudo ufw enable
sudo ufw status numbered
</code></pre>
<h2 data-id="heading-2">2. å®‰è£… RustDeskï¼ˆæ–¹å¼ä¸€ï¼šä¸€é”®è„šæœ¬ï¼‰</h2>
<p>å¦‚æœä½ å¸Œæœ›å¿«é€Ÿå®Œæˆéƒ¨ç½²ï¼Œå¯ä½¿ç”¨ä¸€é”®è„šæœ¬ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">wget https://ghfast.top/https://raw.githubusercontent.com/techahold/rustdeskinstall/master/install.sh -O install.sh
chmod +x install.sh
sudo ./install.sh
</code></pre>
<p>è„šæœ¬ä¼šè‡ªåŠ¨ä¸‹è½½å®‰è£…å¹¶ä»¥ systemd æœåŠ¡è¿è¡Œ <code>hbbs</code>ï¼ˆID æœåŠ¡ï¼‰ä¸ <code>hbbr</code>ï¼ˆä¸­ç»§æœåŠ¡ï¼‰ã€‚</p>
<ul>
<li>å®‰è£…è¿‡ç¨‹ä¸­ä¼šå‡ºç°ä¸¤å¤„äº¤äº’ç¡®è®¤ï¼ŒæŒ‰æç¤ºé€‰æ‹©å³å¯ï¼ˆè§ä¸‹å›¾ï¼‰ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/123ad11f450b4868bed65a53bd9e8a8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5a6B:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765212635&amp;x-signature=ipnhVyM4Zet47KwUQSxb3NF94y8%3D" alt="1.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44e711a254504515893ee34a098bf62a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5a6B:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765212635&amp;x-signature=JarrzmroY%2F6J%2FrFexJgbWndVvrU%3D" alt="2.png" loading="lazy"/></p>
<ul>
<li>é¦–æ¬¡å¯åŠ¨æ—¶ï¼ŒæœåŠ¡ä¼šåœ¨æ—¥å¿—ä¸­è¾“å‡ºä¸€ä¸ª <code>Key</code>ï¼ˆå¯†é’¥ï¼‰ï¼Œè¯·å¤åˆ¶å¹¶ä¿å­˜ï¼ˆè§ä¸‹å›¾ï¼‰ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca2c601a709d4f568ed25d6ccab72879~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5a6B:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765212635&amp;x-signature=w%2F8MS%2F%2FtXBtiH6QVV1wM0ywwAy8%3D" alt="3.png" loading="lazy"/></p>
<p>æŸ¥çœ‹æœåŠ¡çŠ¶æ€ä¸æ—¥å¿—ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">systemctl status hbbs
systemctl status hbbr
journalctl -u hbbs -f
journalctl -u hbbr -f
</code></pre>
<p>æ£€æŸ¥ç«¯å£æ˜¯å¦ç›‘å¬ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">ss -tunlp | grep -E '2111[4-9]|21116'
</code></pre>
<h2 data-id="heading-3">3. å®‰è£… RustDeskï¼ˆæ–¹å¼äºŒï¼šå®˜æ–¹ deb åŒ…ï¼ŒäºŒé€‰ä¸€ï¼‰</h2>
<p>ä¹Ÿå¯åœ¨ GitHub Releases ä¸‹è½½å®˜æ–¹ <code>.deb</code> åŒ…å¹¶å®‰è£…ï¼ˆé€‚åˆç†Ÿæ‚‰ Debian åŒ…ç®¡ç†çš„ç”¨æˆ·ï¼‰ï¼š</p>
<ol>
<li>å‰å¾€ RustDesk æœåŠ¡å™¨å¼€æºç‰ˆå‘å¸ƒé¡µï¼Œä¸‹è½½é€‚åˆæ¶æ„çš„ <code>*.deb</code>ã€‚</li>
<li>ä¸Šä¼ åˆ°æœåŠ¡å™¨å¹¶å®‰è£…ï¼š
<pre><code class="hljs language-shell" lang="shell">sudo dpkg -i rustdesk-server*.deb
sudo apt -f install
</code></pre>
</li>
<li>éªŒè¯æœåŠ¡ï¼š
<pre><code class="hljs language-shell" lang="shell">systemctl status hbbs
systemctl status hbbr
</code></pre>
</li>
</ol>
<p>ä¸¤ç§å®‰è£…æ–¹å¼ä»»é€‰å…¶ä¸€å³å¯ï¼Œä¸å¿…é‡å¤å®‰è£…ã€‚</p>
<h2 data-id="heading-4">4. å®¢æˆ·ç«¯é…ç½®ï¼ˆWindows/macOS/Linuxï¼‰</h2>
<p>åœ¨ RustDesk å®¢æˆ·ç«¯ä¸­å¡«å†™è‡ªæ‰˜ç®¡ä¿¡æ¯ï¼ˆè§ä¸‹å›¾ï¼‰ï¼š</p>
<ul>
<li>æ‰“å¼€ RustDesk â†’ è¿›å…¥ã€Œè®¾ç½®ã€â†’ æ‰¾åˆ°ä¸ã€Œè‡ªæ‰˜ç®¡ / æœåŠ¡å™¨ã€ç›¸å…³çš„é…ç½®ã€‚</li>
<li>å¡«å†™ä»¥ä¸‹å†…å®¹ï¼š
<ul>
<li><code>ID æœåŠ¡å™¨</code>ï¼šä½ çš„æœåŠ¡å™¨åŸŸåæˆ–å…¬ç½‘ IPï¼ˆç«¯å£é»˜è®¤ 21114ï¼‰ã€‚</li>
<li><code>ä¸­ç»§æœåŠ¡å™¨</code>ï¼šä½ çš„æœåŠ¡å™¨åŸŸåæˆ–å…¬ç½‘ IPï¼ˆé»˜è®¤ç«¯å£ 21117ï¼Œå¯åœ¨å®¢æˆ·ç«¯å¤„å¡«å†™ä¸º <code>IP:21117</code>ï¼‰ã€‚</li>
<li><code>Key</code>ï¼šä»æœåŠ¡å™¨æ—¥å¿—ä¸­å¤åˆ¶çš„å¯†é’¥ã€‚</li>
</ul>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6c25831485e4b24b06b109ed2b88439~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5a6B:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765212635&amp;x-signature=%2FgjM6Vu5ZcGLlGWyQNXAuvxWm4Q%3D" alt="4.png" loading="lazy"/></p>
<p>ä¿å­˜åï¼Œè¿”å›ä¸»ç•Œé¢ï¼Œä¸¤ä¸ªå®¢æˆ·ç«¯äº’ç›¸è¾“å…¥å¯¹æ–¹ ID è¿›è¡Œè¿æ¥æµ‹è¯•ã€‚è‹¥èƒ½ç›´è¿ï¼Œä¼šæ˜¾ç¤ºç›´è¿ï¼›è‹¥ NAT å¤æ‚ï¼Œåˆ™ä¼šè‡ªåŠ¨èµ°ä¸­ç»§ã€‚</p>
<h2 data-id="heading-5">5. è¿œç¨‹è¿é€šæ€§éªŒè¯ï¼ˆå¯é€‰ä½†æ¨èï¼‰</h2>
<p>ä»ä½ çš„æœ¬åœ°ç”µè„‘æµ‹è¯•äº‘ç«¯ç«¯å£æ˜¯å¦å¯è¾¾ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">nc -zv &lt;ä½ çš„æœåŠ¡å™¨IPæˆ–åŸŸå&gt; 21114
nc -zv &lt;ä½ çš„æœåŠ¡å™¨IPæˆ–åŸŸå&gt; 21117
</code></pre>
<p>å¦‚æ˜¾ç¤º <code>succeeded</code> æˆ– <code>open</code>ï¼Œè¡¨ç¤ºç«¯å£è¿é€šæ€§æ­£å¸¸ã€‚</p>
<h2 data-id="heading-6">6. å¸¸è§é—®é¢˜ä¸æ’æŸ¥</h2>
<ul>
<li>æ— æ³•è·å– IDï¼š
<ul>
<li>æ£€æŸ¥ <code>hbbs</code> æœåŠ¡æ˜¯å¦è¿è¡Œï¼š<code>systemctl status hbbs</code></li>
<li>æ£€æŸ¥äº‘å®‰å…¨ç»„ä¸ <code>ufw</code> æ˜¯å¦å·²æ”¾è¡Œ 21114â€“21119/TCP ä¸ 21116/UDPã€‚</li>
</ul>
</li>
<li>è¿æ¥æ€»æ˜¯èµ°ä¸­ç»§ï¼š
<ul>
<li>å¾ˆå¯èƒ½æ˜¯å®¢æˆ·ç«¯ä¹‹é—´ NAT ç©¿é€å¤±è´¥ã€‚ç¡®ä¿ 21116/UDP æ”¾è¡Œï¼›æˆ–æ¥å—é€šè¿‡ä¸­ç»§è¿æ¥ã€‚</li>
</ul>
</li>
<li>æç¤º Key ä¸åŒ¹é…ï¼š
<ul>
<li>ç¡®ä¿å®¢æˆ·ç«¯å¡«å†™çš„ <code>Key</code> ä¸æœåŠ¡å™¨å½“å‰è¾“å‡ºçš„ä¸€è‡´ï¼›å˜æ›´æœåŠ¡å™¨åéœ€æ›´æ–°å®¢æˆ·ç«¯é…ç½®ã€‚</li>
</ul>
</li>
<li>æœåŠ¡åä¸ç¡®å®šï¼š
<ul>
<li>å¯æ‰§è¡Œ <code>systemctl list-units | grep hbbs</code> ä¸ <code>grep hbbr</code> æŸ¥æ‰¾å…·ä½“æœåŠ¡åç§°ã€‚</li>
</ul>
</li>
</ul>
<h2 data-id="heading-7">7. è¿ç»´ä¸å‡çº§ï¼ˆç®€è¦ï¼‰</h2>
<ul>
<li>é‡å¯æœåŠ¡ï¼š
<pre><code class="hljs language-shell" lang="shell">sudo systemctl restart hbbs
sudo systemctl restart hbbr
</code></pre>
</li>
<li>æ—¥å¿—æŸ¥çœ‹ï¼š
<pre><code class="hljs language-shell" lang="shell">journalctl -u hbbs --no-pager -n 200
journalctl -u hbbr --no-pager -n 200
</code></pre>
</li>
<li>å®‰å…¨å»ºè®®ï¼š
<ul>
<li>ç”Ÿäº§ç¯å¢ƒå°†å®‰å…¨ç»„æˆæƒå¯¹è±¡ä» <code>0.0.0.0/0</code> æ”¶ç´§åˆ°å¯ä¿¡ç½‘æ®µã€‚</li>
<li>å®šæœŸæ›´æ–°ç³»ç»Ÿå¹¶é‡å¯æœåŠ¡ï¼Œå‡å°‘å·²çŸ¥æ¼æ´é£é™©ã€‚</li>
</ul>
</li>
</ul>
<h2 data-id="heading-8">8. ä¸€é”®æ›´æ¢é»˜è®¤ç«¯å£è„šæœ¬ï¼ˆå«å®‰å…¨æ”¶æ•›ï¼‰</h2>
<p>ä¸ºä¾¿äºå¿«é€Ÿè½åœ°ï¼Œæä¾›ä¸€é”®è„šæœ¬ï¼š</p>
<ul>
<li>è®© <code>hbbs/hbbr</code> åœ¨è‡ªå®šä¹‰ç«¯å£ç›‘å¬ï¼ˆéœ€è¦æä¾›ä¸­ç»§ä¸»æœºä¸å¯é€‰å¯†é’¥æ–‡ä»¶ï¼‰ã€‚</li>
</ul>
<p>ç«¯å£èŒƒå›´ä¸å»ºè®®ï¼š</p>
<ul>
<li>å¯ä¿®æ”¹èŒƒå›´ï¼š<code>1024â€“65535</code>ï¼ˆé¿å…ä½¿ç”¨ <code>0â€“1023</code> çš„ä¿ç•™ç«¯å£ï¼‰ã€‚</li>
<li>æ¨èé€‰æ‹©é«˜ä½ç«¯å£ï¼ˆå¦‚ <code>20000â€“40000</code>ï¼‰ï¼Œå¹¶æå‰æ£€æŸ¥å ç”¨ï¼š<code>ss -tunlp | grep &lt;PORT&gt;</code>ã€‚</li>
</ul>
<p>å°†è„šæœ¬æ–‡ä»¶ <code>rustdesk-port-switch.sh</code> ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆä¾‹å¦‚ <code>/usr/local/sbin/</code>ï¼‰ï¼Œå¹¶èµ‹äºˆæ‰§è¡Œæƒé™ï¼š</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">#</span><span class="bash">!/usr/bin/env bash</span>
set -euo pipefail
<span class="hljs-meta prompt_">
# </span><span class="bash">å¸¸é‡: é»˜è®¤ç«¯å£</span>
DEFAULT_NAT=21116
DEFAULT_RELAY=21117
DEFAULT_HBBS_WS=21118
DEFAULT_HBBR_WS=21119

BASE=""
NAT_PORT=""
RELAY_PORT=""
HBBS_WS=""
HBBR_WS=""
RELAY_HOST=""
<span class="hljs-meta prompt_">
# </span><span class="bash">å‡½æ•°: æ‰“å°ç”¨æ³•è¯´æ˜ä¸ç«¯å£èŒƒå›´</span>
usage() {
  cat &lt;&lt;'USAGE'
ç”¨æ³•: sudo bash rustdesk-port-switch.sh
è¯´æ˜: çº¯äº¤äº’å¼ï¼Œç›´æ¥ä¿®æ”¹ hbbs/hbbr ç›‘å¬ç«¯å£ï¼ˆoverride æ¨¡å¼ï¼‰
ç«¯å£èŒƒå›´: 1024â€“65535ï¼Œå»ºè®® 20000â€“40000ï¼Œé¿å… 0â€“1023 ä¿ç•™ç«¯å£
USAGE
}
<span class="hljs-meta prompt_">
# </span><span class="bash">å‡½æ•°: æ£€æŸ¥æ˜¯å¦ root</span>
require_root() {
  if [ "${EUID:-$(id -u)}" -ne 0 ]; then
    echo "éœ€è¦ä»¥ root è¿è¡Œ" &gt;&amp;2
    exit 1
  fi
}
<span class="hljs-meta prompt_">
# </span><span class="bash">å‡½æ•°: éªŒè¯ç«¯å£èŒƒå›´ä¸åˆæ³•æ€§</span>
validate_port() {
  local p="$1"
  [[ "$p" =~ ^[0-9]+$ ]] || { echo "ç«¯å£å¿…é¡»ä¸ºæ•°å­—: $p" &gt;&amp;2; exit 1; }
  if [ "$p" -lt 1024 ] || [ "$p" -gt 65535 ]; then
    echo "ç«¯å£è¶…å‡ºå…è®¸èŒƒå›´(1024â€“65535): $p" &gt;&amp;2
    exit 1
  fi
}
<span class="hljs-meta prompt_">
# </span><span class="bash">å‡½æ•°: è®¡ç®—æœ€ç»ˆç«¯å£ç»„åˆ</span>
compute_ports() {
  if [ -n "$BASE" ]; then
    NAT_PORT="$BASE"
    RELAY_PORT=$((BASE+2))
    # WebSocket ç«¯å£ä»…åœ¨æ˜¾å¼æŒ‡å®šæ—¶è®¾ç½®
  fi
  : "${NAT_PORT:=${NAT_PORT:-}}"
  : "${RELAY_PORT:=${RELAY_PORT:-}}"
  [ -n "$NAT_PORT" ] || NAT_PORT="$DEFAULT_NAT"
  [ -n "$RELAY_PORT" ] || RELAY_PORT="$DEFAULT_RELAY"

  validate_port "$NAT_PORT"; validate_port "$RELAY_PORT"
  [ -n "$HBBS_WS" ] &amp;&amp; validate_port "$HBBS_WS"
  [ -n "$HBBR_WS" ] &amp;&amp; validate_port "$HBBR_WS"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">å‡½æ•°: äº¤äº’å¼è¯¢é—®æ¨¡å¼/ç«¯å£/å®‰å…¨é€‰é¡¹</span>
is_port_used() {
  local p="$1"
  ss -H -l -n | awk '{print $5}' | awk -F: '{print $NF}' | grep -qx "$p"
}

suggest_base_port() {
  local tries=0 max=30 b
  while [ $tries -lt $max ]; do
    b=$((20000 + RANDOM % 20001))
    [ $((b+4)) -le 65535 ] || { tries=$((tries+1)); continue; }
    if is_port_used "$b" || is_port_used $((b+2)) || is_port_used $((b+3)) || is_port_used $((b+4)); then
      tries=$((tries+1)); continue
    fi
    BASE_SUG="$b"
    HBBS_WS_SUG=$((b+3))
    HBBR_WS_SUG=$((b+4))
    return 0
  done
  BASE_SUG=30022
  HBBS_WS_SUG=30025
  HBBR_WS_SUG=30026
}

interactive_prompt() {
  suggest_base_port
  echo "æ¨èåŸºå‡†ç«¯å£: ${BASE_SUG} (hbbs(NAT)=${BASE_SUG}, hbbr(Relay)=$((BASE_SUG+2)); WS: hbbs=${HBBS_WS_SUG}, hbbr=${HBBR_WS_SUG})"
  echo "å¯è¾“å…¥åŸºå‡†ç«¯å£(å¦‚ 30022), å°†è‡ªåŠ¨è®¾ç½®: hbbs(NAT)=base, hbbr(Relay)=base+2"
  read -r -p "åŸºå‡†ç«¯å£(å›è½¦ä½¿ç”¨æ¨è ${BASE_SUG}): " BASE
  if [ -z "$BASE" ]; then BASE="$BASE_SUG"; fi
  validate_port "$BASE"

  NAT_PORT="$BASE"; RELAY_PORT=$((BASE+2))
<span class="hljs-meta prompt_">
  # </span><span class="bash">å¯é€‰ WebSocket ç«¯å£</span>
  read -r -p "æ˜¯å¦è®¾ç½® WebSocket ç«¯å£ï¼ˆæ¨è hbbs=${HBBS_WS_SUG} hbbr=${HBBR_WS_SUG}ï¼Œå®˜æ–¹é»˜è®¤ 21118/21119ï¼‰[y/N]: " ws_sel
  case "${ws_sel,,}" in
    y|yes)
      echo "æ¨è WebSocket ç«¯å£: hbbs=${HBBS_WS_SUG} hbbr=${HBBR_WS_SUG}"
      read -r -p "hbbs WebSocket ç«¯å£(å›è½¦ä½¿ç”¨æ¨è ${HBBS_WS_SUG}): " HBBS_WS
      [ -z "$HBBS_WS" ] &amp;&amp; HBBS_WS="$HBBS_WS_SUG"
      validate_port "$HBBS_WS"
      read -r -p "hbbr WebSocket ç«¯å£(å›è½¦ä½¿ç”¨æ¨è ${HBBR_WS_SUG}): " HBBR_WS
      [ -z "$HBBR_WS" ] &amp;&amp; HBBR_WS="$HBBR_WS_SUG"
      validate_port "$HBBR_WS"
      ;;
    *) : ;;
  esac

  read -r -p "ä¸­ç»§ä¸»æœº(åŸŸåæˆ–IP): " RELAY_HOST
  if [ -z "$RELAY_HOST" ]; then
    echo "éœ€è¦æä¾›ä¸­ç»§ä¸»æœº"; exit 1
  fi

  echo "\né…ç½®æ‘˜è¦:";
  echo "hbbs(NAT) ç«¯å£: ${NAT_PORT}  hbbr(Relay) ç«¯å£: ${RELAY_PORT}"
  [ -n "$HBBS_WS" ] &amp;&amp; echo "hbbs WS: ${HBBS_WS}"
  [ -n "$HBBR_WS" ] &amp;&amp; echo "hbbr WS: ${HBBR_WS}"
  echo "ä¸­ç»§ä¸»æœº: ${RELAY_HOST}"

  read -r -p "ç»§ç»­æ‰§è¡Œ? [y/N]: " go
  case "${go,,}" in y|yes) : ;; *) echo "å·²å–æ¶ˆ"; exit 1;; esac
}
<span class="hljs-meta prompt_">
# </span><span class="bash">(ç§»é™¤ NAT é‡å®šå‘é€»è¾‘)</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">å‡½æ•°: UFW å¼€æ”¾æ–°ç«¯å£</span>
ensure_ufw_rules() {
  if ! command -v ufw &gt;/dev/null 2&gt;&amp;1; then
    apt-get update -y &amp;&amp; apt-get install -y ufw
  fi
  ufw allow "${NAT_PORT}/udp" || true
  ufw allow "${NAT_PORT}/tcp" || true
  ufw allow "${RELAY_PORT}/tcp" || true
  [ -n "$HBBS_WS" ] &amp;&amp; ufw allow "${HBBS_WS}/tcp" || true
  [ -n "$HBBR_WS" ] &amp;&amp; ufw allow "${HBBR_WS}/tcp" || true
  ufw status | cat
}
<span class="hljs-meta prompt_">
# </span><span class="bash">(ç§»é™¤æŒä¹…åŒ– iptables é€»è¾‘)</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">å‡½æ•°: å†™å…¥ systemd override</span>
write_override() {
  local hbbs_path hbbr_path unit path_guess
<span class="hljs-meta prompt_">
  # </span><span class="bash">ä¼˜å…ˆä½¿ç”¨ç”¨æˆ·æŒ‡å®šè·¯å¾„</span>
  hbbs_path="${HBBS_PATH:-}"
  hbbr_path="${HBBR_PATH:-}"
<span class="hljs-meta prompt_">
  # </span><span class="bash">é€šè¿‡ PATH æŸ¥æ‰¾</span>
  [ -z "$hbbs_path" ] &amp;&amp; hbbs_path="$(command -v hbbs || true)"
  [ -z "$hbbr_path" ] &amp;&amp; hbbr_path="$(command -v hbbr || true)"
<span class="hljs-meta prompt_">
  # </span><span class="bash">é€šè¿‡ systemd å•å…ƒè§£æ ExecStart</span>
  if [ -z "$hbbs_path" ]; then
    unit="$(systemctl cat hbbs 2&gt;/dev/null || true)"
    path_guess="$(echo "$unit" | awk -F= '/^ExecStart=/{print $2}' | awk '{print $1}' | tail -n1)"
    [ -n "$path_guess" ] &amp;&amp; hbbs_path="$path_guess"
  fi
  if [ -z "$hbbr_path" ]; then
    unit="$(systemctl cat hbbr 2&gt;/dev/null || true)"
    path_guess="$(echo "$unit" | awk -F= '/^ExecStart=/{print $2}' | awk '{print $1}' | tail -n1)"
    [ -n "$path_guess" ] &amp;&amp; hbbr_path="$path_guess"
  fi
<span class="hljs-meta prompt_">
  # </span><span class="bash">å¸¸è§è·¯å¾„å›é€€</span>
  [ -z "$hbbs_path" ] &amp;&amp; for p in /usr/local/bin/hbbs /usr/bin/hbbs /opt/rustdesk/hbbs /opt/rustdesk-server/hbbs; do [ -x "$p" ] &amp;&amp; hbbs_path="$p" &amp;&amp; break; done
  [ -z "$hbbr_path" ] &amp;&amp; for p in /usr/local/bin/hbbr /usr/bin/hbbr /opt/rustdesk/hbbr /opt/rustdesk-server/hbbr; do [ -x "$p" ] &amp;&amp; hbbr_path="$p" &amp;&amp; break; done

  [ -n "$hbbs_path" ] &amp;&amp; [ -x "$hbbs_path" ] || { echo "æœªæ‰¾åˆ°å¯æ‰§è¡Œçš„ hbbs, è¯·ç¡®è®¤å®‰è£…åœ¨ /opt/rustdesk/hbbs æˆ– /usr/local/bin/hbbs"; exit 1; }
  [ -n "$hbbr_path" ] &amp;&amp; [ -x "$hbbr_path" ] || { echo "æœªæ‰¾åˆ°å¯æ‰§è¡Œçš„ hbbr, è¯·ç¡®è®¤å®‰è£…åœ¨ /opt/rustdesk/hbbr æˆ– /usr/local/bin/hbbr"; exit 1; }
<span class="hljs-meta prompt_">
  # </span><span class="bash">å†™å…¥ systemd é…ç½®ï¼šè‹¥ä¸»å•å…ƒå­˜åœ¨åˆ™å†™ overrideï¼›å¦åˆ™åˆ›å»ºæ–°çš„å•å…ƒæ–‡ä»¶</span>
  if systemctl cat hbbs &gt;/dev/null 2&gt;&amp;1; then
    mkdir -p /etc/systemd/system/hbbs.service.d
    cat &gt;/etc/systemd/system/hbbs.service.d/override.conf &lt;&lt;EOF
[Service]
ExecStart=
ExecStart=${hbbs_path} -p ${NAT_PORT} -r ${RELAY_HOST}:${RELAY_PORT}
EOF
  else
    cat &gt;/etc/systemd/system/hbbs.service &lt;&lt;EOF
[Unit]
Description=RustDesk HBBS (ID server)
After=network.target

[Service]
Type=simple
ExecStart=${hbbs_path} -p ${NAT_PORT} -r ${RELAY_HOST}:${RELAY_PORT}
Restart=always
RestartSec=2s
User=root

[Install]
WantedBy=multi-user.target
EOF
  fi

  if systemctl cat hbbr &gt;/dev/null 2&gt;&amp;1; then
    mkdir -p /etc/systemd/system/hbbr.service.d
    cat &gt;/etc/systemd/system/hbbr.service.d/override.conf &lt;&lt;EOF
[Service]
ExecStart=
ExecStart=${hbbr_path} -p ${RELAY_PORT}
EOF
  else
    cat &gt;/etc/systemd/system/hbbr.service &lt;&lt;EOF
[Unit]
Description=RustDesk HBBR (Relay server)
After=network.target

[Service]
Type=simple
ExecStart=${hbbr_path} -p ${RELAY_PORT}
Restart=always
RestartSec=2s
User=root

[Install]
WantedBy=multi-user.target
EOF
  fi
}
<span class="hljs-meta prompt_">
# </span><span class="bash">å‡½æ•°: é‡è½½å¹¶é‡å¯æœåŠ¡</span>
restart_services() {
  systemctl daemon-reload
  systemctl enable hbbs &gt;/dev/null 2&gt;&amp;1 || true
  systemctl enable hbbr &gt;/dev/null 2&gt;&amp;1 || true
  systemctl restart hbbs || true
  systemctl restart hbbr || true
  systemctl --no-pager -q status hbbs hbbr || true
}
<span class="hljs-meta prompt_">
# </span><span class="bash">å‡½æ•°: æå–å¹¶ä¿å­˜æœ€æ–° Key åˆ°è„šæœ¬åŒçº§ç›®å½•ï¼Œå¹¶æ‰“å°</span>
save_and_print_key() {
  local key line script_dir key_file
<span class="hljs-meta prompt_">  # </span><span class="bash">ä» hbbs æ—¥å¿—æå–æœ€æ–° Key</span>
  line=$(journalctl -u hbbs -n 200 --no-pager 2&gt;/dev/null | grep -E "Key:" | tail -n1 || true)
  if [ -z "$line" ]; then
    line=$(journalctl -u hbbr -n 200 --no-pager 2&gt;/dev/null | grep -E "Key:" | tail -n1 || true)
  fi
  key=$(echo "$line" | sed -E 's/^.*Key:\s*([A-Za-z0-9+\/=]+).*$/\1/' )
  script_dir=$(cd -- "$(dirname -- "$0")" &amp;&amp; pwd)
  key_file="$script_dir/rustdesk.key"
  if [ -n "$key" ]; then
    printf "%s\n" "$key" &gt; "$key_file"
    chmod 600 "$key_file" 2&gt;/dev/null || true
    echo "- ID æœåŠ¡å™¨ ï¼š ${RELAY_HOST}:${NAT_PORT}"
    echo "- ä¸­ç»§æœåŠ¡å™¨ ï¼š ${RELAY_HOST}:${RELAY_PORT}"
    echo "- Key: $key"
    echo "å·²ä¿å­˜åˆ°: $key_file"
  else
    echo "- ID æœåŠ¡å™¨ ï¼š ${RELAY_HOST}:${NAT_PORT}"
    echo "- ä¸­ç»§æœåŠ¡å™¨ ï¼š ${RELAY_HOST}:${RELAY_PORT}"
    echo "- Key: (æœªè§£æ)"
    echo "æœªä»æ—¥å¿—è§£æåˆ° Keyã€‚å¯ç¨åè¿è¡Œ: journalctl -u hbbs -n 200 | grep -i Key"
  fi
}

require_root
interactive_prompt

if [ -z "$RELAY_HOST" ]; then
  echo "éœ€è¦æä¾›ä¸­ç»§ä¸»æœº" &gt;&amp;2
  exit 1
fi
write_override
restart_services
ensure_ufw_rules
save_and_print_key
</code></pre>
<pre><code class="hljs language-shell" lang="shell">sudo mv rustdesk-port-switch.sh /usr/local/sbin/
sudo chmod +x /usr/local/sbin/rustdesk-port-switch.sh
</code></pre>
<p>äº¤äº’å¼è¿è¡Œï¼ˆæ— éœ€å‚æ•°ï¼‰ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">sudo bash /usr/local/sbin/rustdesk-port-switch.sh
</code></pre>
<ul>
<li>å°†ä¾æ¬¡è¯¢é—®åŸºå‡†ç«¯å£æˆ–åˆ†åˆ«è¾“å…¥ hbbs/hbbr ç«¯å£ã€æ˜¯å¦è®¾ç½® WebSocket ç«¯å£ï¼Œä»¥åŠä¸­ç»§ä¸»æœºä¸å¯†é’¥æ–‡ä»¶ï¼Œç¡®è®¤åè‡ªåŠ¨æ‰§è¡Œã€‚</li>
<li>å·²å†…ç½®è‡ªåŠ¨æ¢æµ‹ <code>hbbs</code>/<code>hbbr</code> è·¯å¾„ï¼ˆåŒ…å« <code>/opt/rustdesk/hbbs</code> ä¸ <code>/opt/rustdesk/hbbr</code> ç­‰å¸¸è§ä½ç½®ï¼‰ï¼Œæ— éœ€æ‰‹åŠ¨è¾“å…¥è·¯å¾„ã€‚</li>
<li>æ¯æ¬¡è¿è¡Œè„šæœ¬éƒ½ä¼šéšæœºæ¨èä¸€ç»„é«˜ä½ç«¯å£ï¼ˆé¿å¼€å·²å ç”¨ï¼‰ï¼ŒåŒ…å« <code>hbbs(NAT)</code>ã€<code>hbbr(Relay)</code> ä»¥åŠå¯é€‰çš„ WebSocket ç«¯å£ï¼›ç›´æ¥å›è½¦å¯ä½¿ç”¨æ¨èå€¼ã€‚</li>
<li>è„šæœ¬ä¼šåœ¨æ‰§è¡Œå®Œæˆåè‡ªåŠ¨ä»æ—¥å¿—è§£ææœ€æ–° <code>Key</code>ï¼Œå¹¶ä¿å­˜ä¸ºè„šæœ¬åŒçº§ç›®å½•çš„ <code>rustdesk.key</code>ï¼ˆè¦†ç›–æ—§æ–‡ä»¶ï¼‰ï¼ŒåŒæ—¶åœ¨ç»ˆç«¯æ‰“å°å½“å‰ <code>Key</code>ã€‚</li>
</ul>
<p>æ‰§è¡Œå®Œæˆåç»ˆç«¯å°†è¾“å‡ºå¦‚ä¸‹æ‘˜è¦ï¼Œä¾¿äºåœ¨å®¢æˆ·ç«¯å¡«å†™ï¼š</p>
<ul>
<li>ID æœåŠ¡å™¨ ï¼š <code>&lt;ä½ çš„åŸŸåæˆ–IP&gt;:&lt;hbbsç«¯å£&gt;</code></li>
<li>ä¸­ç»§æœåŠ¡å™¨ ï¼š <code>&lt;ä½ çš„åŸŸåæˆ–IP&gt;:&lt;hbbrç«¯å£&gt;</code></li>
<li>Key: <code>&lt;æœåŠ¡å™¨å½“å‰Key&gt;</code></li>
<li>å·²ä¿å­˜åˆ°: <code>&lt;è„šæœ¬åŒçº§ç›®å½•&gt;/rustdesk.key</code></li>
</ul>
<blockquote>
<p>è®°å¾—å»é˜¿é‡Œäº‘ç­‰å®‰å…¨ç»„å¼€æ”¾é‡æ–°è®¾ç½®çš„ç«¯å£</p>
</blockquote>
<p>éªŒè¯ï¼š3001[5-9]è®°å¾—æ¢æˆ&lt;æ–°è®¾ç½®çš„ç«¯å£&gt;</p>
<pre><code class="hljs language-shell" lang="shell">ss -tunlp | grep -E '3001[5-9]'
nc -zv &lt;åŸŸåæˆ–IP&gt; &lt;æ–°è®¾ç½®çš„ç«¯å£&gt;
nc -zv &lt;åŸŸåæˆ–IP&gt; &lt;æ–°è®¾ç½®çš„ç«¯å£&gt;
</code></pre>
<h2 data-id="heading-9">9. ç«¯å£è¯´æ˜ï¼ˆäº†è§£å³å¯ï¼‰</h2>
<p>RustDesk æœåŠ¡å™¨é»˜è®¤ä½¿ç”¨ <code>21114â€“21119/TCP</code> ä¸ <code>21116/UDP</code>ï¼š</p>
<ul>
<li><code>21116/UDP</code>ï¼šNAT æ‰“æ´ã€‚</li>
<li><code>21117/TCP</code>ï¼šä¸­ç»§é€šé“ã€‚</li>
<li>å…¶ä½™ç«¯å£ç”¨äº ID æ³¨å†Œã€æ¡æ‰‹ä¸æ§åˆ¶ä¿¡ä»¤ç­‰ï¼ˆä¿ç•™é»˜è®¤å³å¯ï¼‰ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[mutable.Setçš„ç‰¹æ€§ï¼Œä»¥åŠè‡ªå®šä¹‰ç±»ä¸­equalså’ŒhashCodeæ–¹æ³•å¯¹é›†åˆå»é‡é€»è¾‘çš„å½±å“]]></title>    <link>https://juejin.cn/post/7578820431018754063</link>    <guid>https://juejin.cn/post/7578820431018754063</guid>    <pubDate>2025-12-02T00:40:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578820431018754063" data-draft-id="7578699975414579200" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="mutable.Setçš„ç‰¹æ€§ï¼Œä»¥åŠè‡ªå®šä¹‰ç±»ä¸­equalså’ŒhashCodeæ–¹æ³•å¯¹é›†åˆå»é‡é€»è¾‘çš„å½±å“"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-02T00:40:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¾è€æ€»"/> <meta itemprop="url" content="https://juejin.cn/user/3344078309963692"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            mutable.Setçš„ç‰¹æ€§ï¼Œä»¥åŠè‡ªå®šä¹‰ç±»ä¸­equalså’ŒhashCodeæ–¹æ³•å¯¹é›†åˆå»é‡é€»è¾‘çš„å½±å“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3344078309963692/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¾è€æ€»
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T00:40:12.000Z" title="Tue Dec 02 2025 00:40:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><pre><code class="hljs language-scala" lang="scala"><span class="hljs-keyword">package</span> caseclass

<span class="hljs-keyword">import</span> scala.collection.mutable

<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">caseclass1</span> </span>{
   <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Book</span>(<span class="hljs-params">var id: <span class="hljs-type">Int</span>, var name: <span class="hljs-type">String</span></span>) </span>{
     <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">equals</span></span>(obj: <span class="hljs-type">Any</span>): <span class="hljs-type">Boolean</span> = {
       <span class="hljs-keyword">val</span> other = obj.asInstanceOf[<span class="hljs-type">Book</span>]
       other.id == id &amp;&amp; other.name == name
     }

     <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hashCode</span></span>(): <span class="hljs-type">Int</span> = id
   }
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span></span>(args: <span class="hljs-type">Array</span>[<span class="hljs-type">String</span>]): <span class="hljs-type">Unit</span> = {
      <span class="hljs-keyword">val</span> set1: mutable.<span class="hljs-type">Set</span>[<span class="hljs-type">Int</span>] = mutable.<span class="hljs-type">Set</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)


      set1 += <span class="hljs-number">1</span>
      set1 += <span class="hljs-number">1</span>
      set1 += <span class="hljs-number">1</span>
      set1 += <span class="hljs-number">1</span>
      println(set1)

      <span class="hljs-keyword">val</span> book1 = <span class="hljs-keyword">new</span> <span class="hljs-type">Book</span>(<span class="hljs-number">1</span>, <span class="hljs-string">"è¥¿æ¸¸è®°"</span>)
      <span class="hljs-keyword">val</span> book2 = <span class="hljs-keyword">new</span> <span class="hljs-type">Book</span>(<span class="hljs-number">1</span>, <span class="hljs-string">"è¥¿æ¸¸è®°"</span>)

      println(book1 == book2)

      <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªsetï¼Œå®ƒçš„ç±»å‹æ˜¯Bookï¼Œå®ƒå¯ä»¥è£…å…¥çš„æ•°æ®æ˜¯bookç±»å‹</span>
      <span class="hljs-keyword">val</span> set2: mutable.<span class="hljs-type">Set</span>[<span class="hljs-type">Book</span>] = mutable.<span class="hljs-type">Set</span>()
      set2 += book1
      set2 += book2

      println(set2)
    }
  }
</code></pre>
<p>è¿™æ®µ Scala ä»£ç ä¸»è¦æ¼”ç¤ºäº†å¯å˜é›†åˆ<code>mutable.Set</code>çš„ç‰¹æ€§ï¼Œä»¥åŠè‡ªå®šä¹‰ç±»ä¸­<code>equals</code>å’Œ<code>hashCode</code>æ–¹æ³•å¯¹é›†åˆå»é‡é€»è¾‘çš„å½±å“ï¼Œå…·ä½“åˆ†æå¦‚ä¸‹ï¼š</p>
<h3 data-id="heading-0">ä»£ç åŠŸèƒ½ä¸æ‰§è¡Œç»“æœ</h3>
<ol>
<li><strong>æ•´æ•°é›†åˆå»é‡</strong>ï¼šå®šä¹‰<code>mutable.Set[Int]</code>ç±»å‹çš„<code>set1</code>ï¼Œåˆå§‹åŒ…å«<code>1</code>å’Œ<code>2</code>ï¼Œå¤šæ¬¡æ·»åŠ <code>1</code>åï¼Œé›†åˆä»ä¸º<code>Set(1, 2)</code>ã€‚å› ä¸º<code>Set</code>çš„ç‰¹æ€§æ˜¯è‡ªåŠ¨å»é‡ï¼Œæ•´æ•°ç±»å‹çš„ç›¸ç­‰æ€§åˆ¤æ–­åŸºäºå€¼ï¼Œé‡å¤å…ƒç´ ä¼šè¢«è‡ªåŠ¨å¿½ç•¥ã€‚</li>
<li><strong>è‡ªå®šä¹‰ç±»å¯¹è±¡çš„ç›¸ç­‰æ€§</strong>ï¼šè‡ªå®šä¹‰<code>Book</code>ç±»é‡å†™äº†<code>equals</code>æ–¹æ³•ï¼ˆé€šè¿‡<code>id</code>å’Œ<code>name</code>åˆ¤æ–­ç›¸ç­‰ï¼‰å’Œ<code>hashCode</code>æ–¹æ³•ï¼ˆåŸºäº<code>id</code>ç”Ÿæˆå“ˆå¸Œå€¼ï¼‰ã€‚åˆ›å»º<code>book1</code>å’Œ<code>book2</code>ï¼ˆ<code>id</code>å’Œ<code>name</code>å‡ç›¸åŒï¼‰ï¼Œ<code>book1 == book2</code>è¾“å‡º<code>true</code>ï¼Œç¬¦åˆé‡å†™...</li>
</ol>
<p>è§£é‡Š</p>
<p>è¿™æ®µ Scala ä»£ç ä¸»è¦å›´ç»•<strong>å¯å˜é›†åˆ<code>mutable.Set</code>çš„å»é‡é€»è¾‘</strong>ã€<strong>è‡ªå®šä¹‰ç±»çš„<code>equals</code>å’Œ<code>hashCode</code>æ–¹æ³•é‡å†™</strong>å±•å¼€ï¼Œæˆ‘ä»¬é€éƒ¨åˆ†æ‹†è§£è§£é‡Šï¼š</p>
<h3 data-id="heading-1">1. æ•´æ•°é›†åˆçš„å»é‡æ¼”ç¤º</h3>
<p>scala</p>
<pre><code class="hljs language-arduino" lang="arduino">val set1: <span class="hljs-keyword">mutable</span>.Set[Int] = <span class="hljs-keyword">mutable</span>.<span class="hljs-built_in">Set</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)
set1 += <span class="hljs-number">1</span>
set1 += <span class="hljs-number">1</span>
<span class="hljs-built_in">println</span>(set1)  <span class="hljs-comment">// è¾“å‡ºï¼šSet(1, 2)</span>
</code></pre>
<ul>
<li><code>Set</code>ï¼ˆæ— è®ºå¯å˜ / ä¸å¯å˜ï¼‰çš„æ ¸å¿ƒç‰¹æ€§æ˜¯<strong>å…ƒç´ å”¯ä¸€æ€§</strong>ï¼Œä¼šè‡ªåŠ¨è¿‡æ»¤é‡å¤å…ƒç´ ã€‚</li>
<li>è¿™é‡Œå¤šæ¬¡å‘<code>set1</code>æ·»åŠ <code>1</code>ï¼Œä½†æœ€ç»ˆé›†åˆä»åªä¿ç•™ä¸€ä¸ª<code>1</code>ï¼Œå› ä¸ºæ•´æ•°ç±»å‹ï¼ˆ<code>Int</code>ï¼‰çš„ç›¸ç­‰æ€§åˆ¤æ–­æ˜¯åŸºäº<strong>å€¼æœ¬èº«</strong>çš„ï¼Œ<code>1 == 1</code>å§‹ç»ˆæˆç«‹ï¼Œæ‰€ä»¥é‡å¤æ·»åŠ æ— æ•ˆã€‚</li>
</ul>
<h3 data-id="heading-2">2. è‡ªå®šä¹‰ç±»<code>Book</code>çš„<code>equals</code>å’Œ<code>hashCode</code>é‡å†™</h3>
<p>scala</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Book</span>(<span class="hljs-keyword">var</span> id: <span class="hljs-built_in">Int</span>, <span class="hljs-keyword">var</span> name: String) {
  <span class="hljs-comment">// é‡å†™equalsï¼šé€šè¿‡idå’Œnameåˆ¤æ–­ä¸¤ä¸ªBookå¯¹è±¡æ˜¯å¦ç›¸ç­‰</span>
  <span class="hljs-keyword">override</span> def equals(obj: Any): <span class="hljs-built_in">Boolean</span> = {
    <span class="hljs-keyword">val</span> other = obj.asInstanceOf[Book]  <span class="hljs-comment">// å°†Anyç±»å‹å¼ºè½¬ä¸ºBook</span>
    other.id == id &amp;&amp; other.name == name
  }

  <span class="hljs-comment">// é‡å†™hashCodeï¼šåŸºäºidç”Ÿæˆå“ˆå¸Œå€¼</span>
  <span class="hljs-keyword">override</span> def hashCode(): <span class="hljs-built_in">Int</span> = id
}
</code></pre>
<ul>
<li><strong><code>equals</code>æ–¹æ³•</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œç±»çš„<code>equals</code>æ˜¯åŸºäº<strong>å¯¹è±¡å¼•ç”¨</strong>çš„ï¼ˆå³ä¸¤ä¸ªå¯¹è±¡å¿…é¡»æ˜¯å†…å­˜ä¸­åŒä¸€ä¸ªå®ä¾‹æ‰ç›¸ç­‰ï¼‰ã€‚è¿™é‡Œé‡å†™åï¼Œåªè¦ä¸¤ä¸ª<code>Book</code>å¯¹è±¡çš„<code>id</code>å’Œ<code>name</code>ç›¸åŒï¼Œå°±åˆ¤å®šä¸ºç›¸ç­‰ï¼ˆ<code>book1 == book2</code>è¿”å›<code>true</code>ï¼‰ã€‚</li>
<li><strong><code>hashCode</code>æ–¹æ³•</strong>ï¼šå“ˆå¸Œå€¼æ˜¯é›†åˆï¼ˆå¦‚<code>Set</code>ï¼‰å­˜å‚¨å…ƒç´ æ—¶çš„ â€œå¿«é€Ÿç´¢å¼•â€ï¼Œ<code>Set</code>ä¼šå…ˆé€šè¿‡<code>hashCode</code>åˆ†ç»„ï¼Œå†å¯¹åŒç»„å…ƒç´ ç”¨<code>equals</code>åˆ¤æ–­æ˜¯å¦é‡å¤ã€‚è¿™é‡Œ<code>hashCode</code>åŸºäº<code>id</code>ç”Ÿæˆï¼Œæ„å‘³ç€<code>id</code>ç›¸åŒçš„<code>Book</code>å¯¹è±¡ä¼šè¢«åˆ†åˆ°åŒä¸€ç»„ã€‚</li>
</ul>
<h3 data-id="heading-3">3.Â <code>Book</code>å¯¹è±¡å­˜å…¥<code>Set</code>çš„ â€œçœ‹ä¼¼çŸ›ç›¾â€ ç°è±¡</h3>
<p>scala</p>
<pre><code class="hljs language-ini" lang="ini">val <span class="hljs-attr">book1</span> = new Book(<span class="hljs-number">1</span>, <span class="hljs-string">"è¥¿æ¸¸è®°"</span>)
val <span class="hljs-attr">book2</span> = new Book(<span class="hljs-number">1</span>, <span class="hljs-string">"è¥¿æ¸¸è®°"</span>)
println(<span class="hljs-attr">book1</span> == book2)  // è¾“å‡ºï¼š<span class="hljs-literal">true</span>

val set2: mutable.Set<span class="hljs-section">[Book]</span> = mutable.Set()
set2 += book1
set2 += book2
println(set2)  // è¾“å‡ºï¼šSet(Book@1, Book@1)ï¼ˆçœ‹ä¼¼é‡å¤ï¼Œå®é™…æ˜¯ä¸¤ä¸ªä¸åŒå®ä¾‹ï¼‰
</code></pre>
<ul>
<li>
<p><strong><code>book1 == book2</code>ä¸º<code>true</code></strong>ï¼šå› ä¸ºæˆ‘ä»¬é‡å†™äº†<code>equals</code>ï¼Œ<code>book1</code>å’Œ<code>book2</code>çš„<code>id</code>ã€<code>name</code>éƒ½ç›¸åŒï¼Œæ‰€ä»¥ç›¸ç­‰æ€§åˆ¤æ–­æˆç«‹ã€‚</p>
</li>
<li>
<p><strong><code>set2</code>ä¸­åŒæ—¶å­˜åœ¨<code>book1</code>å’Œ<code>book2</code></strong>ï¼šè¿™æ˜¯å…³é”®çš„ â€œçŸ›ç›¾ç‚¹â€â€”â€” æ˜æ˜<code>book1 == book2</code>ä¸º<code>true</code>ï¼Œä½†<code>Set</code>å´æ²¡æœ‰å»é‡ï¼ŸåŸå› åœ¨äºï¼š<code>Set</code>çš„å»é‡é€»è¾‘ä¾èµ– <strong><code>hashCode</code>å’Œ<code>equals</code>çš„ååŒ <strong>ï¼Œä¸”å¯¹äº</strong>æ™®é€šç±»</strong>ï¼ˆéæ ·ä¾‹ç±»ï¼‰ï¼Œå³ä½¿é‡å†™äº†<code>equals</code>å’Œ<code>hashCode</code>ï¼Œ<code>Set</code>ä»ä¼šç»“åˆ<strong>å¯¹è±¡å¼•ç”¨</strong>è¾…åŠ©åˆ¤æ–­ï¼ˆæˆ–å›  JVM çš„å“ˆå¸Œç¢°æ’å¤„ç†ç»†èŠ‚ï¼‰ã€‚æ›´æœ¬è´¨çš„æ˜¯ï¼š</p>
<ul>
<li><code>book1</code>å’Œ<code>book2</code>æ˜¯<strong>ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡å®ä¾‹</strong>ï¼ˆå†…å­˜åœ°å€ä¸åŒï¼‰ï¼Œè€Œ<code>mutable.Set</code>å¯¹æ™®é€šç±»çš„å»é‡é€»è¾‘ï¼Œåœ¨<code>hashCode</code>ç›¸åŒã€<code>equals</code>ä¸º<code>true</code>æ—¶ï¼Œä»å¯èƒ½å›  â€œå®ä¾‹å”¯ä¸€æ€§â€ ä¿ç•™å¤šä¸ªå¯¹è±¡ï¼ˆè¿™æ˜¯æ™®é€šç±»ä¸æ ·ä¾‹ç±»çš„æ ¸å¿ƒåŒºåˆ«ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-4">4. ä¸ºä»€ä¹ˆç”¨æ ·ä¾‹ç±»ï¼ˆ<code>case class</code>ï¼‰å°±èƒ½æ­£ç¡®å»é‡ï¼Ÿ</h3>
<p>å¦‚æœå°†<code>Book</code>å®šä¹‰ä¸º<strong>æ ·ä¾‹ç±»</strong>ï¼š</p>
<p>scala</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">case</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Book</span>(<span class="hljs-keyword">var</span> <span class="hljs-attr">id</span>: <span class="hljs-title class_">Int</span>, <span class="hljs-keyword">var</span> <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>)  <span class="hljs-comment">// æ— éœ€æ‰‹åŠ¨é‡å†™equals/hashCode</span>
</code></pre>
<p>æ­¤æ—¶<code>set2 += book1; set2 += book2</code>ä¼šè¾“å‡º<code>Set(Book(1,è¥¿æ¸¸è®°))</code>ï¼Œå› ä¸ºæ ·ä¾‹ç±»ä¼š<strong>è‡ªåŠ¨ç”ŸæˆåŸºäºæ„é€ å‚æ•°çš„<code>equals</code>å’Œ<code>hashCode</code></strong>ï¼Œå®Œå…¨éµå¾ª â€œå€¼ç›¸ç­‰å³å¯¹è±¡ç›¸ç­‰â€ çš„é€»è¾‘ï¼Œ<code>Set</code>ä¼šæ­£ç¡®è¯†åˆ«é‡å¤å¹¶å»é‡ã€‚</p>
<h3 data-id="heading-5">æ€»ç»“</h3>
<ul>
<li><code>Set</code>çš„å»é‡ä¾èµ–<code>hashCode</code>ï¼ˆåˆ†ç»„ï¼‰å’Œ<code>equals</code>ï¼ˆåˆ¤é‡ï¼‰çš„ååŒã€‚</li>
<li>æ™®é€šç±»éœ€æ‰‹åŠ¨é‡å†™<code>equals</code>å’Œ<code>hashCode</code>ï¼Œä½†ä»å¯èƒ½å›  â€œå®ä¾‹å¼•ç”¨â€ å¯¼è‡´<code>Set</code>å»é‡å¤±æ•ˆï¼›æ ·ä¾‹ç±»è‡ªåŠ¨å®ç°æ­£ç¡®çš„<code>equals</code>å’Œ<code>hashCode</code>ï¼Œæ˜¯ Scala ä¸­å®ç° â€œå€¼ç›¸ç­‰â€ çš„æ¨èæ–¹å¼ã€‚</li>
<li>æ•´æ•°ç­‰åŸºç¡€ç±»å‹çš„<code>equals</code>å’Œ<code>hashCode</code>å·²é»˜è®¤å®ç° â€œå€¼ç›¸ç­‰â€ï¼Œå› æ­¤<code>Set</code>å¯¹åŸºç¡€ç±»å‹çš„å»é‡å§‹ç»ˆæœ‰æ•ˆã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¸¿è’™ç³»ç»Ÿ 4.1.0 å…¼å®¹ Android apk å¦‚ä½•æ£€æµ‹å…¼å®¹çš„ Android ç³»ç»Ÿç‰ˆæœ¬æ˜¯å¤šå°‘]]></title>    <link>https://juejin.cn/post/7578780780026609673</link>    <guid>https://juejin.cn/post/7578780780026609673</guid>    <pubDate>2025-12-02T02:15:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578780780026609673" data-draft-id="7578803751608582194" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¸¿è’™ç³»ç»Ÿ 4.1.0 å…¼å®¹ Android apk å¦‚ä½•æ£€æµ‹å…¼å®¹çš„ Android ç³»ç»Ÿç‰ˆæœ¬æ˜¯å¤šå°‘"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-02T02:15:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="lichong951"/> <meta itemprop="url" content="https://juejin.cn/user/1486195453865687"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¸¿è’™ç³»ç»Ÿ 4.1.0 å…¼å®¹ Android apk å¦‚ä½•æ£€æµ‹å…¼å®¹çš„ Android ç³»ç»Ÿç‰ˆæœ¬æ˜¯å¤šå°‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1486195453865687/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    lichong951
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T02:15:53.000Z" title="Tue Dec 02 2025 02:15:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>HarmonyOS 4.1.0 ä»å±äºâ€œå…¼å®¹ AOSPâ€çš„å¸¸è§„ç‰ˆæœ¬ï¼Œ<strong>å¹¶æœªåˆ‡æ¢åˆ°çº¯è¡€é¸¿è’™ NEXT</strong>ã€‚
æ ¹æ®åä¸ºå®˜æ–¹ç‰ˆæœ¬å¯¹ç…§è¡¨ï¼Œ<strong>HarmonyOS 4.1 å¯¹åº”çš„ Android å…¼å®¹å±‚ä¸º Android 12ï¼ˆAPI 31ï¼‰</strong>ï¼Œä¸ 4.0 åŒå±ä¸€ä¸ªåˆ†æ”¯ï¼Œåªæ˜¯è¡¥ä¸çº§åˆ«æ›´é«˜ ã€‚
å› æ­¤ï¼Œåœ¨ 4.1.0 è®¾å¤‡ä¸Šå®‰è£… APK æ—¶ï¼Œ<strong>æŒ‰ Android 12 çš„å…¼å®¹æ€§è¿›è¡Œæµ‹è¯•å³å¯</strong>ï¼›è‹¥å‡ºç°ä»… Android 13+ æ‰å¼•å…¥çš„ APIï¼Œéœ€è¦é™çº§æˆ–åšå…¼å®¹æ€§åˆ¤æ–­ã€‚</p>
<hr/>
<p>åœ¨â€œå…¼å®¹ AOSPâ€çš„é¸¿è’™ç‰ˆæœ¬ï¼ˆ3.x/4.xï¼Œé NEXTï¼‰ä¸Šï¼ŒJava ä»£ç ä¸ Android å®Œå…¨ç›¸åŒï¼Œç›´æ¥è¯»å– <code>Build.VERSION</code> å³å¯å¾—åˆ°å½“å‰è¿è¡Œæ—¶çš„ Android å…¼å®¹å±‚ç‰ˆæœ¬ï¼Œç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> android.os.Build;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getAndroidCompatibleVersion</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// ç¤ºä¾‹è¿”å›ï¼š12</span>
    <span class="hljs-keyword">return</span> Build.VERSION.RELEASE;
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAndroidCompatibleSdkInt</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// ç¤ºä¾‹è¿”å›ï¼š31ï¼ˆå¯¹åº” Android 12ï¼‰</span>
    <span class="hljs-keyword">return</span> Build.VERSION.SDK_INT;
}
</code></pre>
<p>è‹¥è¿˜æƒ³ç¡®è®¤â€œæ˜¯ä¸æ˜¯é¸¿è’™â€ï¼Œå¯å†å–ä¸¤é¡¹ç³»ç»Ÿå±æ€§ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. å‚å•†</span>
<span class="hljs-type">String</span> <span class="hljs-variable">manu</span> <span class="hljs-operator">=</span> Build.MANUFACTURER;          <span class="hljs-comment">// HUAWEI  </span>
<span class="hljs-comment">// 2. é¸¿è’™å¢é‡ç‰ˆæœ¬å·ï¼ˆä»…é¸¿è’™è®¾å¤‡å­˜åœ¨ï¼‰</span>
<span class="hljs-type">String</span> <span class="hljs-variable">incremental</span> <span class="hljs-operator">=</span> Build.VERSION.INCREMENTAL; <span class="hljs-comment">// ä¾‹å¦‚ 4.1.0.xxx</span>
</code></pre>
<p>å½“ <code>manu.equals("HUAWEI")</code> ä¸” <code>incremental</code> ä»¥ <code>"Harmony"</code> æˆ– <code>"4.1.0"</code> ç­‰å¼€å¤´æ—¶ï¼Œå³å¯åˆ¤å®šä¸ºé¸¿è’™ç³»ç»Ÿï¼ŒåŒæ—¶ <code>Build.VERSION.RELEASE</code> å°±æ˜¯å®ƒæ‰€å…¼å®¹çš„ Android ç‰ˆæœ¬ï¼Œé¸¿è’™ 4.1.x é€šå¸¸ä¸º <strong>Android 12ï¼ˆAPI 31ï¼‰</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ”¶åˆ°ç¬¬ä¸€å°æ¨å¹¿é‚®ä»¶ï¼šæˆ‘çš„ App æ­£åœ¨è¢«çœ‹è§]]></title>    <link>https://juejin.cn/post/7578781397117386798</link>    <guid>https://juejin.cn/post/7578781397117386798</guid>    <pubDate>2025-12-02T02:21:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578781397117386798" data-draft-id="7578724773994332186" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ”¶åˆ°ç¬¬ä¸€å°æ¨å¹¿é‚®ä»¶ï¼šæˆ‘çš„ App æ­£åœ¨è¢«çœ‹è§"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äº§å“"/> <meta itemprop="datePublished" content="2025-12-02T02:21:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="HBLOG"/> <meta itemprop="url" content="https://juejin.cn/user/131597124767479"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ”¶åˆ°ç¬¬ä¸€å°æ¨å¹¿é‚®ä»¶ï¼šæˆ‘çš„ App æ­£åœ¨è¢«çœ‹è§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/131597124767479/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    HBLOG
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T02:21:58.000Z" title="Tue Dec 02 2025 02:21:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸Šçº¿ App æ‰æ²¡å¤šä¹…ï¼Œä»Šå¤©å¿½ç„¶æ”¶åˆ°äº†ä¸€å°æ¨å¹¿é‚®ä»¶ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fadmin.liuhaihua.cn%2Fwp-content%2Fuploads%2F2025%2F12%2Fimage.png" target="_blank" title="https://admin.liuhaihua.cn/wp-content/uploads/2025/12/image.png" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7f86360bf224498a9bdfc8234879008~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSEJMT0c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765246918&amp;x-signature=rz0nhasniXI%2BLAJCQwxG%2F3nDH8A%3D" alt="" loading="lazy"/></a></p>
<p>è¯´å®è¯ï¼Œçœ‹åˆ°çš„é‚£ä¸€åˆ»ï¼Œå¿ƒé‡Œç«Ÿç„¶æœ‰ä¸€ç‚¹ç‚¹æƒŠå–œã€‚</p>
<p>ä¸æ˜¯å› ä¸ºé‚®ä»¶æœ¬èº«ï¼Œè€Œæ˜¯é‚£ç§â€”â€”<br/>
â€œåŸæ¥çœŸçš„æœ‰äººåœ¨å…³æ³¨ã€æœ‰äººåœ¨å°è¯•ã€æœ‰äººæ„¿æ„äº†è§£æˆ‘ä»¬â€çš„æ„Ÿè§‰ã€‚<br/>
åšäº§å“çš„äººåº”è¯¥éƒ½æ‡‚ï¼š<br/>
ä»çµæ„Ÿåˆ°è®¾è®¡ï¼Œä»åŠŸèƒ½åˆ°ä½“éªŒï¼Œä»æ‰“ç£¨åˆ°ä¸Šçº¿â€¦â€¦<br/>
æ¯ä¸€æ­¥éƒ½åƒæŠŠè‡ªå·±çš„å¿ƒè¡€æ¨å‘ä¸–ç•Œï¼Œä½†åˆ°åº•æœ‰æ²¡æœ‰äººåœ¨æ„ï¼Œå´æ°¸è¿œæ˜¯æœªçŸ¥æ•°ã€‚</p>
<p>æ‰€ä»¥ï¼Œå½“ç¬¬ä¸€å°æ¨å¹¿é‚®ä»¶æ‚„æ‚„å‡ºç°ï¼Œå°±åƒæœ‰äººè½»è½»æ‹äº†ä¸€ä¸‹è‚©è†€ï¼š<br/>
<strong>â€œå˜¿ï¼Œä½ åšçš„äº‹æƒ…ï¼Œç¡®å®æœ‰äººçœ‹è§äº†ã€‚â€</strong></p>
<p>å®ƒä¸ä»£è¡¨æˆåŠŸï¼Œä½†è¯´æ˜æ–¹å‘æ²¡é”™ï¼›<br/>
ä¸ä»£è¡¨çˆ†å‘ï¼Œä½†ä»£è¡¨å¼€å§‹æœ‰äº†æ¶Ÿæ¼ªã€‚<br/>
è¿™å°é‚®ä»¶è®©æˆ‘é‡æ–°æ„Ÿåˆ°è¢«è‚¯å®šï¼Œä¹Ÿè®©æˆ‘æ›´ç¡®ä¿¡ï¼š<br/>
æ‰€æœ‰é‚£äº›æ·±å¤œçš„æ„æ€ã€åå¤çš„ä¿®æ”¹ã€ä¸æ–­çš„æŠ€æœ¯è°ƒæ•´ï¼Œæ˜¯çœŸçš„å€¼å¾—çš„ã€‚</p>
<p>æœªæ¥ä¼šæ€æ ·æˆ‘ä¸çŸ¥é“ï¼Œä½†è‡³å°‘ç°åœ¨çš„æˆ‘ï¼Œä¼šç»§ç»­è¸å®åœ°æŠŠæ¯ä¸€ä¸ªåŠŸèƒ½åšåˆ°æ›´å¥½ï¼ŒæŠŠæ¯ä¸€ä¸ªç»†èŠ‚åšå¾—æ›´è®©äººå–œæ¬¢ã€‚</p>
<p>æ¯•ç«Ÿï¼Œè¿™æ˜¯å±äºæˆ‘ä»¬å’Œè¿™æ¬¾ App çš„ç¬¬ä¸€å°ä¿¡å·ç¯ã€‚<br/>
å®ƒå¾®å¼±ï¼Œå´çœŸå®ï¼›<br/>
ä¸è€€çœ¼ï¼Œå´æ¸©æš–ï¼›<br/>
ä½†å®ƒå‘Šè¯‰æˆ‘ï¼š<br/>
<strong>â€œç»§ç»­å¾€å‰èµ°ï¼Œå°±å¯¹äº†ã€‚â€</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI æ–‡å­—ä¿¡æ¯å›¾è¡¨çš„æŠ€æœ¯é€‰å‹]]></title>    <link>https://juejin.cn/post/7578793960626536474</link>    <guid>https://juejin.cn/post/7578793960626536474</guid>    <pubDate>2025-12-02T02:24:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578793960626536474" data-draft-id="7578781397117370414" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI æ–‡å­—ä¿¡æ¯å›¾è¡¨çš„æŠ€æœ¯é€‰å‹"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,GitHub"/> <meta itemprop="datePublished" content="2025-12-02T02:24:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ•°æ®ä½“éªŒæŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/1486195450988471"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI æ–‡å­—ä¿¡æ¯å›¾è¡¨çš„æŠ€æœ¯é€‰å‹
            <!----> <!----></h1> <div class="container team-follow" data-v-d326b38e="" data-v-61fb5e44=""><div class="left" data-v-d326b38e=""><a href="/team/6944740539795259422/posts" data-v-d326b38e=""><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b9909c804423411fa9fa1df65b5069d8~tplv-k3u1fbpfcp-watermark.image" class="icon" data-v-d326b38e=""/></a> <div class="content" data-v-d326b38e=""><div style="display: flex" data-v-d326b38e=""><a href="/team/6944740539795259422/posts" data-v-d326b38e=""><p class="title-line" data-v-d326b38e=""><span title="èš‚èšé›†å›¢æ•°æ®ä½“éªŒæŠ€æœ¯å›¢é˜Ÿ" class="title" data-v-d326b38e="">èš‚èšé›†å›¢æ•°æ®ä½“éªŒæŠ€æœ¯å›¢é˜Ÿ</span> <img src="//lf-web-assets.juejin.cn/obj/juejin-web/xitu_juejin_web/255e400027b783cbad76dc41527e7695.svg" alt="team icon" class="team-icon" data-v-d326b38e=""/></p></a></div> <div class="meta-box team" data-v-d326b38e="" data-v-61fb5e44=""><time datetime="2025-12-02T02:24:04.000Z" title="Tue Dec 02 2025 02:24:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-d326b38e="" data-v-61fb5e44="">
                2025-12-02
              </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-d326b38e="" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/></svg> <span class="views-count" style="display:none;" data-v-d326b38e="" data-v-61fb5e44="">
                7
              </span> <span class="read-time" data-v-d326b38e="" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-d326b38e="" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-d326b38e="" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-d326b38e="" data-v-61fb5e44=""/></svg>
                é˜…è¯»5åˆ†é’Ÿ
              </span> <!----> <!----></div></div></div> <button class="jj-follow-button follow-btn" style="display:none;" data-v-b60b2868="" data-v-d326b38e=""><span data-v-b60b2868="" data-v-d326b38e=""><i class="byte-icon byte-icon--plus" data-v-d326b38e=""><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 48 48"><path fill="none" d="M0 0h48v48H0z"/><path d="M24.7 4c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8V22h16.7c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8v1.4c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1H26v16.7c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1h-1.4c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8V26H5.3c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8v-1.4c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1H22V5.3c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1h1.4z"/></svg></i>
        å…³æ³¨
      </span></button></div> <div class="team-user block-hidden" data-v-61fb5e44=""><div class="avatar jj-avatar avatar" data-v-03256cc6="" data-v-61fb5e44=""><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="avatar" class="lazy avatar-img" data-v-5244ef91="" data-v-03256cc6=""/> </div> <!----> <span class="position ellipsis" data-v-61fb5e44="">
              æ•°æ®å¯è§†åŒ–
            </span></div> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ–‡å­—ä¿¡æ¯æ˜¯æœ€æœ´ç´ çš„ä¿¡æ¯è½½ä½“ï¼Œå³ä½¿æ˜¯ AI æ—¶ä»£ï¼Œå¤§æ¨¡å‹çš„è¾“å‡ºéƒ½æ˜¯æ–‡å­—ä¿¡æ¯å±…å¤šã€‚</p>
<h2 data-id="heading-0">æ–‡æœ¬ä¿¡æ¯å›¾</h2>
<p>æˆ‘ä»¬å¤§é‡çš„äº§å“ï¼Œå…¶å®éƒ½æ˜¯åœ¨åšæ–‡å­—ä¿¡æ¯çš„æ•´åˆå’Œå¯è§†åŒ–ï¼Œæ¯”å¦‚ï¼šPPTã€æµç¨‹å›¾ã€æ€ç»´å¯¼å›¾ã€ä¿¡æ¯æµ·æŠ¥ç­‰è½¯ä»¶ï¼ŒåŒ…æ‹¬ä¸€äº›åšå®¢çš„å›¾æ–‡æ··æ’æ¨¡å¼ï¼Œå…¶å®éƒ½æ˜¯åœ¨å¯¹æ–‡å­—ä¿¡æ¯è¿›è¡Œå½’çº³å’Œå¯è§†åŒ–ï¼Œè¿™éƒ¨åˆ†æˆ‘ä»¬éƒ½å¯ä»¥ç§°ä¹‹ä¸ºæ–‡æœ¬ä¿¡æ¯çš„å¯è§†åŒ–ï¼Œæˆ–è€…ä¿¡æ¯å›¾å¯è§†åŒ–ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/edc4beb0c63946aa9b58398cf24f3794~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWw5o2u5L2T6aqM5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765247507&amp;x-signature=C3hNiEY869f1k4YPhiuLfxNhnEw%3D" alt="image.png" loading="lazy"/></p>
<p>AI æ—¶ä»£ä¸‹ï¼Œæ–‡æœ¬å¤§æ¨¡å‹å¯¹äºæ–‡æœ¬ä¿¡æ¯ç†è§£å’Œå¤„ç†èƒ½åŠ›å¤§å¤§åŠ å¼ºï¼Œå¤§æ¨¡å‹èƒ½å¾ˆæ¸…æ¥šçš„ç†è§£æ–‡å­—çš„ç»“æ„ä¿¡æ¯ï¼Œè¡¨è¾¾çš„æ ¸å¿ƒè§‚ç‚¹ï¼Œä»¥åŠä»éç»“æ„ä¿¡æ¯ä¸­æŠ½å–å’Œæ¨ç†æœ‰ç”¨çš„ã€ç»“æ„åŒ–ä¿¡æ¯ã€‚</p>
<p>æ‰€ä»¥åœ¨ AI æ¥ä¸´ä¹‹åï¼Œæœ‰å¤§é‡çš„ AI Agent åº”ç”¨éƒ½æ˜¯å…³æ³¨åœ¨æ–‡å­—çš„å¤„ç†å’Œå‘ˆç°ä¸Šçš„ï¼Œæ¯”å¦‚ AI PPTã€AI æµç¨‹å›¾ã€AI å›¾è¡¨ã€ä»¥åŠå„ç±»çš„ DeepResearch åº”ç”¨ã€‚</p>
<p>æœ€è¿‘èš‚èšé›†å›¢å‘å¸ƒçš„å¾ˆç«çš„çµå…‰ï¼ŒæŠ¢çœ¼çš„è¡¨ç°ï¼ŒåŸå› ä¹‹ä¸€å°±æ˜¯çµå…‰å¯ä»¥è®©æ¨¡å‹è¾“å‡ºæ›´å¤šå½¢æ€çš„å†…å®¹ï¼ŒåŒ…æ‹¬å›¾ç‰‡ã€è§†é¢‘ã€3Dã€äº¤äº’å›¾è¡¨ï¼Œä¿¡æ¯å›¾ç­‰ã€‚</p>
<h2 data-id="heading-1">æŠ€æœ¯å®ç°å’Œé€‰å‹</h2>
<p>ä¸šç•Œä¸Šï¼Œå®ç°æ–‡æœ¬ä¿¡æ¯å¯è§†åŒ–çš„ï¼Œæœ‰ä¸€äº›å½¢æ€ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†ï¼Œéƒ½æ˜¯ä¿¡æ¯å›¾çš„åˆ¶ä½œå¹³å°ã€‚å¦‚æœå¤§å®¶åšè¿‡è°ƒç ”ï¼Œå¤§æ¦‚å°±çŸ¥é“å¦‚ä¸‹çš„äº§å“ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7451fb008b0148bf8eb31e5d44da1491~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWw5o2u5L2T6aqM5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765247507&amp;x-signature=%2F%2FO%2F1ip1d08%2F6gSxn%2FdHWaaW6mw%3D" alt="image.png" loading="lazy"/></p>
<p>æ ¸å¿ƒåŠŸèƒ½åŸºæœ¬éƒ½æ˜¯ä¸€è‡´çš„ï¼š</p>
<ul>
<li>AI èƒ½åŠ›å±‚ï¼šé€‰æ‹©åˆé€‚çš„æ¨¡ç‰ˆï¼Œä»ç”¨æˆ·æ–‡æœ¬æŠ½å–æ•°æ®ã€‚</li>
<li>è¾“å‡ºä¿¡æ¯å›¾ï¼šæ”¯æŒå¯¼å‡º PNG/SVG ç­‰å¤šç§åª’ä»‹æ ¼å¼ã€‚</li>
<li>ä¿¡æ¯å›¾ç¼–è¾‘ï¼šæä¾›åœ¨çº¿ Web å¯è§†åŒ–ç•Œé¢äº¤äº’é…ç½®ã€‚</li>
<li>æ•°æ®å­˜å‚¨ï¼šè®¾è®¡DSL Schema / ç”»å¸ƒçŠ¶æ€ä¿å­˜æ•°æ®ã€‚</li>
<li>ä¿¡æ¯å›¾æ¸²æŸ“ï¼šåŸºäºæµè§ˆå™¨ Canvas/SVG å°è£…æ¸²æŸ“å¼•æ“ã€‚</li>
</ul>
<p>ä½†æ˜¯é—®é¢˜ä¹Ÿå¾ˆæ˜æ˜¾ï¼šä»˜è´¹ä½¿ç”¨ã€æ¨¡æ¿çµæ´»æ€§ä½ã€é—­æºçš„ç”Ÿæ€ã€é›†æˆåˆ°åº”ç”¨åŸºæœ¬ä¸å¯èƒ½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9e2245d33ed40fdad76d466fb8f9df4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWw5o2u5L2T6aqM5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765247507&amp;x-signature=uatFno1zlF3GfiQSEVj5We7LEGU%3D" alt="image.png" loading="lazy"/></p>
<p>æ‰€ä»¥æˆ‘ä»¬åœ¨æƒ³ï¼Œå¦‚æœæˆ‘ä»¬çš„ä¸šåŠ¡ç³»ç»Ÿéœ€è¦å®ç°ç±»ä¼¼çš„æ–‡æœ¬ä¿¡æ¯å›¾å¯è§†åŒ–è¯¥æ€ä¹ˆåšï¼Œæœ‰å‡ ç§æ–¹æ¡ˆï¼š</p>
<h3 data-id="heading-2">Mermaid</h3>
<p>æ˜¯ä¸€ä¸ªåŸºäº JavaScript çš„ç»˜å›¾å’Œå›¾è¡¨å·¥å…·ï¼Œå‘ˆç°å— Markdown å¯å‘çš„æ–‡æœ¬å®šä¹‰ï¼Œä»¥åŠ¨æ€åˆ›å»ºå’Œä¿®æ”¹å›¾è¡¨ã€‚å¸¸ç”¨äºåˆ›å»ºï¼šæ—¶åºå›¾ã€æµç¨‹å›¾ã€ç±»å›¾ã€æ—¶é—´è½´ï¼Œç­‰ ~20 ä¸­å›¾è¡¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/74e9f4c51aed4e219195c96f720f7d08~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWw5o2u5L2T6aqM5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765247507&amp;x-signature=g%2FDYClrJTeZ%2F7lO3W%2FaHw1YY8mo%3D" alt="image.png" loading="lazy"/></p>
<p>æ˜¯ç¤¾åŒºå¹¿æ³›é‡‡ç”¨çš„ä¸€ç§æ–¹æ¡ˆï¼Œå½“ç„¶ï¼Œé—®é¢˜å°±æ˜¯å›¾å½¢ä¸€èˆ¬åæŠ€æœ¯çš„åŒå­¦çœ‹çš„ï¼Œå¯¹äºæ™®é€šçš„æ–‡å­—å†…å®¹å’Œç»“æ„å‘ˆç°ï¼Œå¹¶ä¸é€‚åˆã€‚</p>
<h3 data-id="heading-3">ä½¿ç”¨ AI ç›´å‡º HTML + SVG</h3>
<p>ä½¿ç”¨ AI å¤§æ¨¡å‹ + æç¤ºè¯ï¼Œç”Ÿæˆæœ€ç»ˆçš„ HTML æˆ–è€… SVGï¼Œç„¶åæœ€ç»ˆç”Ÿæˆå¯¹åº”çš„ HTML æˆ–è€… SVG æ¸²æŸ“ï¼Œè¿™ä¸ªå¯èƒ½æ˜¯æœªæ¥é•¿æœŸçš„æ–¹å‘ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b1bc5b2d94134c459b6ff3d012b315c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWw5o2u5L2T6aqM5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765247507&amp;x-signature=5n2iwVtuJG%2FUtGUOTmxceGxzDBw%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7dc8476f5304440c9d0d209710cdc9bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWw5o2u5L2T6aqM5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765247507&amp;x-signature=rUU9GmwZW3F9ZlUz4Y3twFygmcc%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸è¿‡å°±ç›®å‰çš„æ•ˆæœæ¥çœ‹ï¼ŒHTML æ•ˆæœæ¯” SVG è¦ç¨å¾®å¥½ä¸€ç‚¹ï¼ŒSVG ç”Ÿæˆä¾ç„¶ä¼šé‡åˆ°å„ç§å¸ƒå±€ç‚¹çš„ä½ç½®ï¼Œç‰¹åˆ«åƒæ–‡å­—ç¢°æ’åŸºæœ¬æ— æ³•å¤„ç†ï¼›HTML ä¸Šå°±æ˜¯é£æ ¼ä¸Šä¼šæ¯”è¾ƒå•ä¸€ä¸€äº›ï¼Œé¢œè‰²å’Œ border ä¸Šï¼Œæœ‰å¾ˆå¼ºçš„ AI å‘³é“ã€‚</p>
<h3 data-id="heading-4">ä½¿ç”¨å¤šæ¨¡æ€å¤§æ¨¡å‹ç”Ÿæˆä¿¡æ¯å›¾å›¾ç‰‡</h3>
<p>gemini 3 å‘å¸ƒï¼ŒåŠ ä¸Š banana pro çš„å‘å¸ƒï¼Œè®©å¤šæ¨¡æ€æ¨¡å‹ç›´æ¥è¾“å‡ºä¿¡æ¯å›¾ï¼ŒåŸºæœ¬å˜æˆäº†ç°å®ï¼Œæ•ˆæœå¾ˆå¥½ï¼Œè€Œä¸”åœ¨å¤§éƒ¨åˆ†å¤šæ¨¡æ€é‡åˆ°çš„ä¸­æ–‡é—®é¢˜ï¼Œä¹Ÿèƒ½å¾ˆå¥½çš„è§£å†³ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4dacd03d5fe846128962dbc96dad5bad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWw5o2u5L2T6aqM5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765247507&amp;x-signature=4MNa780v8UwV4TsqwS8aPiu3AaM%3D" alt="image.png" loading="lazy"/></p>
<p>å½“ç„¶ï¼Œä¹Ÿä¼šæœ‰ä¸€äº›å°é—®é¢˜ï¼Œè¿™äº›é—®é¢˜æ›´å¤šæ˜¯å›¾ç‰‡è¿™ä¸ªå­˜å‚¨æ ¼å¼å¸¦æ¥çš„ï¼š</p>
<ol>
<li>æ— æ³•äºŒæ¬¡ç¼–è¾‘ï¼Œæˆ–è€…å¾ˆå¥½åšåˆ°å¾ˆå¥½çš„äºŒæ¬¡ç¼–è¾‘</li>
<li>æ— æ³•å®ç°åŠ¨ç”»æ•ˆæœ</li>
<li>æ— æ³•äº¤äº’</li>
</ol>
<h3 data-id="heading-5">AntV Infographic</h3>
<p>Infographic æ˜¯ AntV åœ¨ 2025 å¹´ 11 æœˆ 22 æ—¥å¼€æºå‡ºæ¥çš„ä¸€ä¸ªä¿¡æ¯å›¾å¯è§†åŒ–æ¡†æ¶ï¼Œä¸»è¦å…³æ³¨åœ¨æ¸²æŸ“éƒ¨åˆ†ï¼Œæä¾›äº† 100+ çš„ä¼˜è´¨ä¿¡æ¯å›¾æ¨¡ç‰ˆï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿå¢åŠ äº†è‡ªå®šä¹‰çš„å¼€å‘èƒ½åŠ›ï¼Œè®©æ¨¡ç‰ˆæ•°é‡èƒ½å€æ•°å¢é•¿ï¼›å›¾çš„è®¾è®¡é£æ ¼æ¯”è¾ƒé€‚ç”¨äº PPT å’Œå†™æ–‡ç« é…å›¾çš„é‚£ç§åœºæ™¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39ecea2d094d4578a6cd8a1789bc5e24~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWw5o2u5L2T6aqM5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765247507&amp;x-signature=1SQcC4IiXAbkNa1S%2FpM3BCxk9IQ%3D" alt="image.png" loading="lazy"/></p>
<p>ä¹Ÿæœ‰æä¾›å„ç§é£æ ¼ï¼Œå†…ç½®æ·±è‰²æ¨¡å¼ã€æ‰‹ç»˜ã€çº¹ç†è§†è§‰é£æ ¼ï¼Œæ‰‹ç»˜é£æ ¼è¿™ä¸ªå¾ˆé…·ã€‚å¦å¤–ï¼Œä¸ºäº†åœ¨ AI ä¸Šæ›´å¥½çš„ä½¿ç”¨ï¼Œä¹Ÿåšäº† AI å‹å¥½çš„é…ç½®å’Œæè¿°ï¼Œå¹¶åœ¨å®˜ç½‘æä¾›äº† AI Agent æ¥ä½¿ç”¨ï¼Œä»¥åŠç”¨äºäºŒæ¬¡ç¼–è¾‘çš„ç¼–è¾‘å™¨ç»„ä»¶ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/204fb7f2e41f484fb77398c736565fc4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWw5o2u5L2T6aqM5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765247507&amp;x-signature=A1zraFDlXchKKBrRmlhDaBDGxWw%3D" alt="image.png" loading="lazy"/></p>
<p>æ‰€ä»¥ç›¸å…³æ–‡æœ¬ä¿¡æ¯å›¾å¯è§†åŒ–çš„ä¸šåŠ¡ï¼Œæ¥å…¥çš„æ—¶å€™ï¼Œåªéœ€è¦å‚è€ƒå“åº”çš„æç¤ºè¯ï¼Œç”Ÿæˆ Infographic çš„é…ç½®ï¼Œç„¶åä½¿ç”¨ Infographic æ¸²æŸ“å³å¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c1932d48fa54cb3aa674ea7905b1093~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWw5o2u5L2T6aqM5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765247507&amp;x-signature=IitGkLia%2BE0tsfWog6d9wUACIng%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-6">æŠ€æœ¯é€‰å‹æ€»ç»“</h2>
<p>æœ€åæ€»ç»“ä¸€ä¸‹ï¼ŒAI äº§å“åœ¨å¤„ç†æ–‡æœ¬ä¿¡æ¯å›¾å¯è§†åŒ–çš„æ–¹æ¡ˆå¯¹æ¯”ï¼Œä»…ä¾›å‚è€ƒã€‚</p>






























<table><thead><tr><th><strong>æ–¹æ¡ˆ</strong></th><th><strong>ä¼˜åŠ¿</strong></th><th><strong>åŠ£åŠ¿</strong></th></tr></thead><tbody><tr><td>Mermaid</td><td>+ ç¤¾åŒºå½±å“åŠ›å¤§<br/>+ èƒ½åŠ›ä¸°å¯Œï¼Œå¼ºå¤§<br/>+ æ¨¡å‹è¾“å‡ºå‡†ç¡®</td><td>- æŠ€æœ¯ç±»å‹çš„ä¿¡æ¯å›¾<br/>- ä¸é€‚ç”¨äºæ™®é€šæ–‡æœ¬ä¿¡æ¯å¯è§†åŒ–<br/>- åŒ…æ¯”è¾ƒå¤§ 2.7 Mb</td></tr><tr><td>AI å‡º HTML / SVG</td><td>+ æ¥å…¥ç®€å•å®¹æ˜“</td><td>- å‡†ç¡®åº¦ã€é£æ ¼ä¸å¯æ§<br/>- æ¨¡ç‰ˆæ ·å¼æ¯”è¾ƒå•ä¸€<br/>- ä¼šå®¹æ˜“å‡ºç°ä¸€äº›ä½“éªŒé—®é¢˜</td></tr><tr><td>å¤šæ¨¡æ€å‡ºå›¾ç‰‡</td><td>+ æ–°çš„ banana pro æ•ˆæœä¸é”™</td><td>- æ— æ³•ç¼–è¾‘ã€æ— åŠ¨ç”»å’Œäº¤äº’<br/>- é—­æºæ¨¡å‹ï¼Œè°ƒç”¨è´µ</td></tr><tr><td>AntV Infographic</td><td>+ å¼€æºã€å…è´¹<br/>+ æ¨¡ç‰ˆä¸°å¯Œï¼Œç›®å‰å†…ç½® 100+ï¼Œå¯å¼€å‘æ‰©å±•ï¼Œæ”¯æŒä¸åŒé£æ ¼<br/>+ æ”¯æŒç¼–è¾‘ï¼Œä»¥åŠæä¾›ç¼–è¾‘å™¨<br/>+ æ¥å…¥è¿‡ç¨‹å®Œå…¨å¯æ§<br/>+ åŒ…è½»é‡ï¼Œ410 Kb</td><td>- é›†æˆæœ‰ Agent ç ”å‘å·¥ä½œé‡ï¼ˆå¼€å‘å’Œæµ‹è¯„ï¼‰</td></tr></tbody></table>
<blockquote>
<p>ç»¼ä¸Šï¼Œä¸ªäººå»ºè®®ï¼Œå¦‚æœåœ¨åš AI æ–‡å­—é…å›¾ï¼Œä¿¡æ¯å›¾ä¹‹ç±»çš„éœ€æ±‚ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fantvis%2Finfographic" target="_blank" title="https://github.com/antvis/infographic" ref="nofollow noopener noreferrer">AntV Infographic</a> + <a href="https://link.juejin.cn?target=https%3A%2F%2Fmermaid.js.org%2F" target="_blank" title="https://mermaid.js.org/" ref="nofollow noopener noreferrer">Mermaid</a> ç›¸ç»“åˆçš„æ–¹å¼ï¼ŒæŠ€æœ¯å›¾è¡¨ä½¿ç”¨ Mermaidï¼Œå¸¸è§çš„ PPTã€æ–‡å­—ç»“æ„é…å›¾ï¼Œä½¿ç”¨ AntV Infographicã€‚</p>
</blockquote>
<h2 data-id="heading-7">æœ€å</h2>
<p>ä¿¡æ¯å›¾çš„ç”Ÿæˆï¼Œæœªæ¥å¤§æ¨¡å‹ä¸€å®šä¼šæ”¯æŒç›´å‡ºä»£ç ï¼Œä½†æ˜¯å½“å‰æ¥çœ‹ï¼Œè¿™ä¸ªæ—¶é—´å¯èƒ½ä¾ç„¶è¿˜æ˜¯ 2-3 å¹´åï¼Œä¸ªäººæ„Ÿè§‰è¿™ä¸æ¯«ä¸å½±å“ä¿¡æ¯å›¾æ¸²æŸ“æŠ€æœ¯çš„æŒç»­è¿­ä»£ã€‚</p>
<p>å› ä¸º AI ä¸ä¼šå‡å°‘éœ€æ±‚ï¼Œåè€Œä¼šæ‰©å¤§ç”¨æˆ·é‡ï¼Œæå‡éœ€æ±‚å’Œç”¨æˆ·é‡ï¼Œè€Œä¿¡æ¯å›¾æ¸²æŸ“æŠ€æœ¯ <a href="https://link.juejin.cn?target=https%3A%2F%2Finfographic.antv.vision%2F" target="_blank" title="https://infographic.antv.vision/" ref="nofollow noopener noreferrer">Infographic</a> ä¼šå› ä¸ºè¿™ä¸ªéœ€æ±‚çš„å¢é•¿ï¼Œå…·æœ‰æ›´å¤šçš„ç”¨æˆ·é‡ã€‚</p>
<blockquote>
<p>AI ç›´æ¥å‡ºç æ˜¯è¶‹åŠ¿ï¼Œä½†æ˜¯ä¸ä»£è¡¨åŸºç¡€æŠ€æœ¯åº“æ¶ˆäº¡ï¼Œè€Œæ˜¯ä½œä¸ºå‡ºç çš„ä¾èµ–å­˜åœ¨ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java `this` å…³é”®å­—æ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7578777952726499362</link>    <guid>https://juejin.cn/post/7578777952726499362</guid>    <pubDate>2025-12-02T02:19:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578777952726499362" data-draft-id="7578797337867272226" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java `this` å…³é”®å­—æ·±åº¦è§£æ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-02T02:19:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å‘¨åœ¨æˆé•¿"/> <meta itemprop="url" content="https://juejin.cn/user/3632442150752573"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java `this` å…³é”®å­—æ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3632442150752573/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å‘¨åœ¨æˆé•¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T02:19:47.000Z" title="Tue Dec 02 2025 02:19:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ“– <code>this</code> å…³é”®å­—æ¦‚è¿°</h2>
<h3 data-id="heading-1"><strong>ä»€ä¹ˆæ˜¯ thisï¼Ÿ</strong></h3>
<p><code>this</code> æ˜¯ä¸€ä¸ªæŒ‡å‘<strong>å½“å‰å¯¹è±¡</strong>çš„å¼•ç”¨å˜é‡ï¼Œåœ¨å®ä¾‹æ–¹æ³•å’Œæ„é€ å™¨ä¸­ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-2"><strong>this çš„æ ¸å¿ƒä½œç”¨</strong></h3>
<ul>
<li>æŒ‡å‘å½“å‰å¯¹è±¡å®ä¾‹</li>
<li>è§£å†³<strong>å˜é‡åå†²çª</strong></li>
<li>åœ¨æ„é€ å™¨ä¸­è°ƒç”¨å…¶ä»–æ„é€ å™¨</li>
<li>ä½œä¸ºå‚æ•°ä¼ é€’å½“å‰å¯¹è±¡</li>
</ul>
<h2 data-id="heading-3">ğŸ¯ <code>this</code> çš„å››ç§ç”¨æ³•</h2>
<h3 data-id="heading-4"><strong>ç”¨æ³•1ï¼šå¼•ç”¨å½“å‰å¯¹è±¡çš„æˆå‘˜å˜é‡ï¼ˆæœ€å¸¸è§ï¼‰</strong></h3>
<h4 data-id="heading-5"><strong>è§£å†³å±€éƒ¨å˜é‡ä¸æˆå‘˜å˜é‡åŒåé—®é¢˜</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> {
    <span class="hljs-keyword">private</span> String name;    <span class="hljs-comment">// æˆå‘˜å˜é‡</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;        <span class="hljs-comment">// æˆå‘˜å˜é‡</span>
    
    <span class="hljs-comment">// æ„é€ å™¨å‚æ•°ä¸æˆå‘˜å˜é‡åŒå</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Student</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span> {
        <span class="hljs-comment">// ä½¿ç”¨thisåŒºåˆ†æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡</span>
        <span class="hljs-built_in">this</span>.name = name;   <span class="hljs-comment">// this.name æ˜¯æˆå‘˜å˜é‡ï¼Œnameæ˜¯å‚æ•°</span>
        <span class="hljs-built_in">this</span>.age = age;     <span class="hljs-comment">// this.age æ˜¯æˆå‘˜å˜é‡ï¼Œageæ˜¯å‚æ•°</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;   <span class="hljs-comment">// åŒºåˆ†æˆå‘˜å˜é‡å’Œå‚æ•°</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> {
        <span class="hljs-built_in">this</span>.age = age;
    }
    
    <span class="hljs-comment">// æ²¡æœ‰æ­§ä¹‰æ—¶ï¼Œthiså¯ä»¥çœç•¥</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è¿™é‡Œæ²¡æœ‰å±€éƒ¨å˜é‡nameå’Œageï¼Œå¯ä»¥ç›´æ¥è®¿é—®æˆå‘˜å˜é‡</span>
        System.out.println(<span class="hljs-string">"å§“å: "</span> + name + <span class="hljs-string">", å¹´é¾„: "</span> + age);
        
        <span class="hljs-comment">// ä½¿ç”¨thisä¹Ÿå¯ä»¥ï¼ˆä½†æ²¡å¿…è¦ï¼‰</span>
        System.out.println(<span class="hljs-string">"å§“å: "</span> + <span class="hljs-built_in">this</span>.name + <span class="hljs-string">", å¹´é¾„: "</span> + <span class="hljs-built_in">this</span>.age);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Student</span> <span class="hljs-variable">stu</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-number">20</span>);
        stu.display();
    }
}
</code></pre>
<h4 data-id="heading-6"><strong>æ›´å¤æ‚çš„ä¾‹å­</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> id;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> salary;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateEmployee</span><span class="hljs-params">(<span class="hljs-type">int</span> id, String name, <span class="hljs-type">double</span> salary)</span> {
        <span class="hljs-comment">// ä½¿ç”¨thisæ˜ç¡®åŒºåˆ†</span>
        <span class="hljs-built_in">this</span>.id = id;           <span class="hljs-comment">// å·¦è¾¹æ˜¯æˆå‘˜å˜é‡ï¼Œå³è¾¹æ˜¯å‚æ•°</span>
        <span class="hljs-built_in">this</span>.name = name;       <span class="hljs-comment">// å·¦è¾¹æ˜¯æˆå‘˜å˜é‡ï¼Œå³è¾¹æ˜¯å‚æ•°</span>
        <span class="hljs-built_in">this</span>.salary = salary;   <span class="hljs-comment">// å·¦è¾¹æ˜¯æˆå‘˜å˜é‡ï¼Œå³è¾¹æ˜¯å‚æ•°</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printInfo</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ²¡æœ‰å±€éƒ¨å˜é‡å†²çªï¼Œå¯ä»¥ä¸ç”¨thisï¼ˆä½†ç”¨thisæ›´æ¸…æ™°ï¼‰</span>
        System.out.println(<span class="hljs-string">"ID: "</span> + <span class="hljs-built_in">this</span>.id);
        System.out.println(<span class="hljs-string">"å§“å: "</span> + <span class="hljs-built_in">this</span>.name);
        System.out.println(<span class="hljs-string">"è–ªèµ„: "</span> + <span class="hljs-built_in">this</span>.salary);
    }
}
</code></pre>
<h3 data-id="heading-7"><strong>ç”¨æ³•2ï¼šåœ¨æ„é€ å™¨ä¸­è°ƒç”¨å…¶ä»–æ„é€ å™¨ï¼ˆthis()ï¼‰</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> width;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> height;
    <span class="hljs-keyword">private</span> String color;
    
    <span class="hljs-comment">// æ„é€ å™¨1ï¼šé»˜è®¤æ„é€ å™¨</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Rectangle</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è°ƒç”¨ä¸‰å‚æ„é€ å™¨ï¼Œæä¾›é»˜è®¤å€¼</span>
        <span class="hljs-built_in">this</span>(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-string">"é»‘è‰²"</span>);
        System.out.println(<span class="hljs-string">"è°ƒç”¨é»˜è®¤æ„é€ å™¨"</span>);
    }
    
    <span class="hljs-comment">// æ„é€ å™¨2ï¼šåªæœ‰å®½é«˜</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Rectangle</span><span class="hljs-params">(<span class="hljs-type">int</span> width, <span class="hljs-type">int</span> height)</span> {
        <span class="hljs-comment">// è°ƒç”¨ä¸‰å‚æ„é€ å™¨ï¼Œä½¿ç”¨é»˜è®¤é¢œè‰²</span>
        <span class="hljs-built_in">this</span>(width, height, <span class="hljs-string">"é»‘è‰²"</span>);
        System.out.println(<span class="hljs-string">"è°ƒç”¨åŒå‚æ„é€ å™¨"</span>);
    }
    
    <span class="hljs-comment">// æ„é€ å™¨3ï¼šå®Œæ•´å‚æ•°ï¼ˆä¸»è¦æ„é€ å™¨ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Rectangle</span><span class="hljs-params">(<span class="hljs-type">int</span> width, <span class="hljs-type">int</span> height, String color)</span> {
        <span class="hljs-built_in">this</span>.width = width;
        <span class="hljs-built_in">this</span>.height = height;
        <span class="hljs-built_in">this</span>.color = color;
        System.out.println(<span class="hljs-string">"è°ƒç”¨ä¸‰å‚æ„é€ å™¨"</span>);
    }
    
    <span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šä¸èƒ½å½¢æˆå¾ªç¯è°ƒç”¨</span>
    <span class="hljs-comment">/*
    public Rectangle() {
        this(10, 10);  // è°ƒç”¨åŒå‚æ„é€ å™¨
    }
    
    public Rectangle(int width, int height) {
        this();  // âŒ é”™è¯¯ï¼šå¾ªç¯è°ƒç”¨ï¼Œç¼–è¯‘é”™è¯¯
    }
    */</span>
    
    <span class="hljs-comment">// é‡è¦è§„åˆ™ï¼šthis()å¿…é¡»æ˜¯æ„é€ å™¨çš„ç¬¬ä¸€æ¡è¯­å¥</span>
    <span class="hljs-comment">/*
    public Rectangle() {
        System.out.println("åˆå§‹åŒ–å¼€å§‹");  // âŒ é”™è¯¯ï¼šå¿…é¡»åœ¨this()ä¹‹å‰
        this(10, 10);  // ç¼–è¯‘é”™è¯¯
    }
    */</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å®½: "</span> + width + <span class="hljs-string">", é«˜: "</span> + height + <span class="hljs-string">", é¢œè‰²: "</span> + color);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== åˆ›å»ºå¯¹è±¡1 ==="</span>);
        <span class="hljs-type">Rectangle</span> <span class="hljs-variable">r1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>();
        r1.display();
        
        System.out.println(<span class="hljs-string">"\n=== åˆ›å»ºå¯¹è±¡2 ==="</span>);
        <span class="hljs-type">Rectangle</span> <span class="hljs-variable">r2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-number">20</span>, <span class="hljs-number">30</span>);
        r2.display();
        
        System.out.println(<span class="hljs-string">"\n=== åˆ›å»ºå¯¹è±¡3 ==="</span>);
        <span class="hljs-type">Rectangle</span> <span class="hljs-variable">r3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-number">40</span>, <span class="hljs-number">50</span>, <span class="hljs-string">"çº¢è‰²"</span>);
        r3.display();
    }
}
</code></pre>
<h3 data-id="heading-8"><strong>ç”¨æ³•3ï¼šä½œä¸ºå‚æ•°ä¼ é€’å½“å‰å¯¹è±¡</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThisAsParameter</span> {
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodA</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"methodAè¢«è°ƒç”¨"</span>);
        methodB(<span class="hljs-built_in">this</span>);  <span class="hljs-comment">// å°†å½“å‰å¯¹è±¡ä¼ é€’ç»™methodB</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodB</span><span class="hljs-params">(ThisAsParameter obj)</span> {
        System.out.println(<span class="hljs-string">"methodBæ¥æ”¶åˆ°å¯¹è±¡: "</span> + obj);
        obj.methodC();  <span class="hljs-comment">// é€šè¿‡å‚æ•°è°ƒç”¨æ–¹æ³•</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodC</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"methodCè¢«è°ƒç”¨"</span>);
    }
    
    <span class="hljs-comment">// å®é™…åº”ç”¨ï¼šé“¾å¼è°ƒç”¨</span>
    <span class="hljs-keyword">public</span> ThisAsParameter <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> {
        System.out.println(<span class="hljs-string">"è®¾ç½®åç§°: "</span> + name);
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;  <span class="hljs-comment">// è¿”å›å½“å‰å¯¹è±¡ï¼Œæ”¯æŒé“¾å¼è°ƒç”¨</span>
    }
    
    <span class="hljs-keyword">public</span> ThisAsParameter <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> {
        System.out.println(<span class="hljs-string">"è®¾ç½®å¹´é¾„: "</span> + age);
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
    }
    
    <span class="hljs-keyword">public</span> ThisAsParameter <span class="hljs-title function_">setCity</span><span class="hljs-params">(String city)</span> {
        System.out.println(<span class="hljs-string">"è®¾ç½®åŸå¸‚: "</span> + city);
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">ThisAsParameter</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThisAsParameter</span>();
        
        <span class="hljs-comment">// æ™®é€šè°ƒç”¨</span>
        obj.methodA();
        
        System.out.println(<span class="hljs-string">"\n=== é“¾å¼è°ƒç”¨ ==="</span>);
        <span class="hljs-comment">// é“¾å¼è°ƒç”¨ï¼ˆæµç•…æ¥å£ï¼‰</span>
        obj.setName(<span class="hljs-string">"å¼ ä¸‰"</span>)
           .setAge(<span class="hljs-number">25</span>)
           .setCity(<span class="hljs-string">"åŒ—äº¬"</span>);
           
        <span class="hljs-comment">// ç­‰ä»·äºï¼š</span>
        <span class="hljs-comment">// obj.setName("å¼ ä¸‰");</span>
        <span class="hljs-comment">// obj.setAge(25);</span>
        <span class="hljs-comment">// obj.setCity("åŒ—äº¬");</span>
    }
}
</code></pre>
<h3 data-id="heading-9"><strong>ç”¨æ³•4ï¼šè¿”å›å½“å‰å¯¹è±¡ï¼ˆç”¨äºé“¾å¼è°ƒç”¨ï¼‰</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PersonBuilder</span> {
    <span class="hljs-keyword">private</span> String firstName;
    <span class="hljs-keyword">private</span> String lastName;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;
    <span class="hljs-keyword">private</span> String address;
    
    <span class="hljs-comment">// è¿”å›thisï¼Œæ”¯æŒé“¾å¼è°ƒç”¨</span>
    <span class="hljs-keyword">public</span> PersonBuilder <span class="hljs-title function_">setFirstName</span><span class="hljs-params">(String firstName)</span> {
        <span class="hljs-built_in">this</span>.firstName = firstName;
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
    }
    
    <span class="hljs-keyword">public</span> PersonBuilder <span class="hljs-title function_">setLastName</span><span class="hljs-params">(String lastName)</span> {
        <span class="hljs-built_in">this</span>.lastName = lastName;
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
    }
    
    <span class="hljs-keyword">public</span> PersonBuilder <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> {
        <span class="hljs-built_in">this</span>.age = age;
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
    }
    
    <span class="hljs-keyword">public</span> PersonBuilder <span class="hljs-title function_">setAddress</span><span class="hljs-params">(String address)</span> {
        <span class="hljs-built_in">this</span>.address = address;
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
    }
    
    <span class="hljs-keyword">public</span> Person <span class="hljs-title function_">build</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(firstName, lastName, age, address);
    }
    
    <span class="hljs-comment">// é™æ€å·¥å‚æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PersonBuilder <span class="hljs-title function_">builder</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PersonBuilder</span>();
    }
    
    <span class="hljs-comment">// Personç±»</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {
        <span class="hljs-keyword">private</span> String firstName;
        <span class="hljs-keyword">private</span> String lastName;
        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;
        <span class="hljs-keyword">private</span> String address;
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String firstName, String lastName, <span class="hljs-type">int</span> age, String address)</span> {
            <span class="hljs-built_in">this</span>.firstName = firstName;
            <span class="hljs-built_in">this</span>.lastName = lastName;
            <span class="hljs-built_in">this</span>.age = age;
            <span class="hljs-built_in">this</span>.address = address;
        }
        
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> String.format(<span class="hljs-string">"Person{firstName='%s', lastName='%s', age=%d, address='%s'}"</span>,
                               firstName, lastName, age, address);
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// ä¼ ç»Ÿçš„å¤šè¡Œè®¾ç½®</span>
        <span class="hljs-type">PersonBuilder</span> <span class="hljs-variable">builder1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PersonBuilder</span>();
        builder1.setFirstName(<span class="hljs-string">"å¼ "</span>);
        builder1.setLastName(<span class="hljs-string">"ä¸‰"</span>);
        builder1.setAge(<span class="hljs-number">25</span>);
        builder1.setAddress(<span class="hljs-string">"åŒ—äº¬"</span>);
        <span class="hljs-type">Person</span> <span class="hljs-variable">person1</span> <span class="hljs-operator">=</span> builder1.build();
        
        <span class="hljs-comment">// é“¾å¼è°ƒç”¨ï¼ˆæ›´ä¼˜é›…ï¼‰</span>
        <span class="hljs-type">Person</span> <span class="hljs-variable">person2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PersonBuilder</span>()
            .setFirstName(<span class="hljs-string">"æ"</span>)
            .setLastName(<span class="hljs-string">"å››"</span>)
            .setAge(<span class="hljs-number">30</span>)
            .setAddress(<span class="hljs-string">"ä¸Šæµ·"</span>)
            .build();
            
        <span class="hljs-comment">// ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•</span>
        <span class="hljs-type">Person</span> <span class="hljs-variable">person3</span> <span class="hljs-operator">=</span> PersonBuilder.builder()
            .setFirstName(<span class="hljs-string">"ç‹"</span>)
            .setLastName(<span class="hljs-string">"äº”"</span>)
            .setAge(<span class="hljs-number">28</span>)
            .setAddress(<span class="hljs-string">"å¹¿å·"</span>)
            .build();
            
        System.out.println(person1);
        System.out.println(person2);
        System.out.println(person3);
    }
}
</code></pre>
<h2 data-id="heading-10">âš ï¸ <code>this</code> ä½¿ç”¨æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-11"><strong>1. é™æ€ä¸Šä¸‹æ–‡ä¸­ä¸èƒ½ä½¿ç”¨ this</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StaticContext</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">instanceVar</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">staticVar</span> <span class="hljs-operator">=</span> <span class="hljs-number">20</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">instanceMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-built_in">this</span>.instanceVar);  <span class="hljs-comment">// âœ… æ­£ç¡®</span>
        System.out.println(<span class="hljs-built_in">this</span>.staticVar);    <span class="hljs-comment">// âš ï¸ å¯ä»¥ä½†ä¸æ¨èï¼ˆåº”è¯¥ç”¨ç±»åï¼‰</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">staticMethod</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// System.out.println(this.instanceVar);  // âŒ é”™è¯¯ï¼šé™æ€æ–¹æ³•ä¸­ä¸èƒ½ä½¿ç”¨this</span>
        <span class="hljs-comment">// System.out.println(this.staticVar);    // âŒ é”™è¯¯ï¼šé™æ€æ–¹æ³•ä¸­ä¸èƒ½ä½¿ç”¨this</span>
        
        System.out.println(staticVar);  <span class="hljs-comment">// âœ… æ­£ç¡®ï¼šç›´æ¥è®¿é—®é™æ€å˜é‡</span>
        System.out.println(StaticContext.staticVar);  <span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨ç±»åè®¿é—®</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// é™æ€æ–¹æ³•ä¸­åˆ›å»ºå¯¹è±¡åå¯ä»¥ä½¿ç”¨</span>
        <span class="hljs-type">StaticContext</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StaticContext</span>();
        obj.instanceMethod();  <span class="hljs-comment">// å¯ä»¥è°ƒç”¨å®ä¾‹æ–¹æ³•</span>
    }
}
</code></pre>
<h3 data-id="heading-12"><strong>2. this ä¸èƒ½ç”¨åœ¨é™æ€ä»£ç å—ä¸­</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StaticBlock</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> value;
    
    <span class="hljs-comment">// é™æ€ä»£ç å—</span>
    <span class="hljs-keyword">static</span> {
        <span class="hljs-comment">// this.value = 10;  // âŒ é”™è¯¯ï¼šé™æ€ä»£ç å—ä¸­ä¸èƒ½ä½¿ç”¨this</span>
        System.out.println(<span class="hljs-string">"é™æ€ä»£ç å—æ‰§è¡Œ"</span>);
    }
    
    <span class="hljs-comment">// å®ä¾‹ä»£ç å—</span>
    {
        <span class="hljs-built_in">this</span>.value = <span class="hljs-number">20</span>;  <span class="hljs-comment">// âœ… æ­£ç¡®ï¼šå®ä¾‹ä»£ç å—ä¸­å¯ä»¥ä½¿ç”¨this</span>
        System.out.println(<span class="hljs-string">"å®ä¾‹ä»£ç å—æ‰§è¡Œï¼Œvalue="</span> + <span class="hljs-built_in">this</span>.value);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">StaticBlock</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>.value = <span class="hljs-number">30</span>;  <span class="hljs-comment">// âœ… æ­£ç¡®ï¼šæ„é€ å™¨ä¸­å¯ä»¥ä½¿ç”¨this</span>
        System.out.println(<span class="hljs-string">"æ„é€ å™¨æ‰§è¡Œï¼Œvalue="</span> + <span class="hljs-built_in">this</span>.value);
    }
}
</code></pre>
<h3 data-id="heading-13"><strong>3. this ä¸èƒ½æŒ‡å‘ null</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThisNull</span> {
    <span class="hljs-keyword">private</span> String name;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printName</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// this æ°¸è¿œä¸ä¸º nullï¼ˆå¦‚æœä¸ºnullï¼Œè¯´æ˜å¯¹è±¡ä¸å­˜åœ¨ï¼Œæ–¹æ³•ä¸ä¼šè¢«è°ƒç”¨ï¼‰</span>
        System.out.println(<span class="hljs-string">"Name: "</span> + <span class="hljs-built_in">this</span>.name);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">ThisNull</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThisNull</span>();
        obj.printName();  <span class="hljs-comment">// æ­£å¸¸æ‰§è¡Œ</span>
        
        <span class="hljs-comment">// ä¸‹é¢çš„ä»£ç ä¼šæŠ›å‡º NullPointerException</span>
        <span class="hljs-type">ThisNull</span> <span class="hljs-variable">nullObj</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-comment">// nullObj.printName();  // âŒ è¿è¡Œæ—¶å¼‚å¸¸ï¼šNullPointerException</span>
    }
}
</code></pre>
<h2 data-id="heading-14">ğŸ”„ <code>this</code> åœ¨å†…éƒ¨ç±»ä¸­çš„ä½¿ç”¨</h2>
<h3 data-id="heading-15"><strong>æ™®é€šå†…éƒ¨ç±»</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OuterClass</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">outerField</span> <span class="hljs-operator">=</span> <span class="hljs-string">"å¤–éƒ¨ç±»å­—æ®µ"</span>;
    
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">InnerClass</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">innerField</span> <span class="hljs-operator">=</span> <span class="hljs-string">"å†…éƒ¨ç±»å­—æ®µ"</span>;
        
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span> {
            <span class="hljs-comment">// è®¿é—®å†…éƒ¨ç±»çš„å­—æ®µ</span>
            System.out.println(<span class="hljs-string">"å†…éƒ¨ç±»å­—æ®µ: "</span> + <span class="hljs-built_in">this</span>.innerField);
            
            <span class="hljs-comment">// è®¿é—®å¤–éƒ¨ç±»çš„å­—æ®µï¼šä½¿ç”¨ OuterClass.this</span>
            System.out.println(<span class="hljs-string">"å¤–éƒ¨ç±»å­—æ®µ: "</span> + OuterClass.<span class="hljs-built_in">this</span>.outerField);
            
            <span class="hljs-comment">// å¦‚æœå­—æ®µåä¸å†²çªï¼Œä¹Ÿå¯ä»¥ç›´æ¥è®¿é—®</span>
            System.out.println(<span class="hljs-string">"ç›´æ¥è®¿é—®å¤–éƒ¨ç±»å­—æ®µ: "</span> + outerField);
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> {
        <span class="hljs-type">InnerClass</span> <span class="hljs-variable">inner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InnerClass</span>();
        inner.show();
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">OuterClass</span> <span class="hljs-variable">outer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OuterClass</span>();
        outer.test();
    }
}
</code></pre>
<h3 data-id="heading-16"><strong>åŒ¿åå†…éƒ¨ç±»</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AnonymousInnerClass</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">field</span> <span class="hljs-operator">=</span> <span class="hljs-string">"å¤–éƒ¨å­—æ®µ"</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">localVar</span> <span class="hljs-operator">=</span> <span class="hljs-string">"å±€éƒ¨å˜é‡"</span>;
        
        <span class="hljs-comment">// åŒ¿åå†…éƒ¨ç±»</span>
        <span class="hljs-type">Runnable</span> <span class="hljs-variable">runnable</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() {
            <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">innerField</span> <span class="hljs-operator">=</span> <span class="hljs-string">"å†…éƒ¨å­—æ®µ"</span>;
            
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
                <span class="hljs-comment">// è®¿é—®åŒ¿åå†…éƒ¨ç±»çš„å­—æ®µ</span>
                System.out.println(<span class="hljs-string">"å†…éƒ¨å­—æ®µ: "</span> + <span class="hljs-built_in">this</span>.innerField);
                
                <span class="hljs-comment">// è®¿é—®å¤–éƒ¨ç±»çš„å­—æ®µï¼šä½¿ç”¨ OuterClass.this</span>
                System.out.println(<span class="hljs-string">"å¤–éƒ¨å­—æ®µ: "</span> + AnonymousInnerClass.<span class="hljs-built_in">this</span>.field);
                
                <span class="hljs-comment">// è®¿é—®å±€éƒ¨å˜é‡ï¼ˆå¿…é¡»æ˜¯finalæˆ–ç­‰æ•ˆfinalï¼‰</span>
                System.out.println(<span class="hljs-string">"å±€éƒ¨å˜é‡: "</span> + localVar);
                
                <span class="hljs-comment">// ä¸èƒ½è¿™æ ·è®¿é—®å¤–éƒ¨ç±»çš„å­—æ®µï¼ˆthisæŒ‡å‘åŒ¿åå†…éƒ¨ç±»å®ä¾‹ï¼‰</span>
                <span class="hljs-comment">// System.out.println("é”™è¯¯è®¿é—®: " + this.field);</span>
            }
        };
        
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(runnable).start();
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">AnonymousInnerClass</span>().test();
    }
}
</code></pre>
<h2 data-id="heading-17">ğŸ­ <code>this</code> åœ¨ç»§æ‰¿ä¸­çš„ä½¿ç”¨</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Parent</span> {
    <span class="hljs-keyword">protected</span> <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">"çˆ¶ç±»åç§°"</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"Parent show: "</span> + <span class="hljs-built_in">this</span>.name);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">parentMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"çˆ¶ç±»æ–¹æ³•"</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Child</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Parent</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">"å­ç±»åç§°"</span>;
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è®¿é—®å­ç±»çš„name</span>
        System.out.println(<span class="hljs-string">"å­ç±»å­—æ®µ: "</span> + <span class="hljs-built_in">this</span>.name);
        
        <span class="hljs-comment">// è®¿é—®çˆ¶ç±»çš„name</span>
        System.out.println(<span class="hljs-string">"çˆ¶ç±»å­—æ®µ: "</span> + <span class="hljs-built_in">super</span>.name);
        
        <span class="hljs-comment">// thisè°ƒç”¨çš„æ˜¯é‡å†™åçš„æ–¹æ³•ï¼ˆå¤šæ€ï¼‰</span>
        <span class="hljs-built_in">this</span>.parentMethod();  <span class="hljs-comment">// è°ƒç”¨å­ç±»é‡å†™çš„æ–¹æ³•</span>
        
        <span class="hljs-comment">// superè°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•</span>
        <span class="hljs-built_in">super</span>.parentMethod();  <span class="hljs-comment">// è°ƒç”¨çˆ¶ç±»åŸå§‹çš„æ–¹æ³•</span>
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">parentMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å­ç±»é‡å†™çš„æ–¹æ³•"</span>);
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InheritanceThis</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Child</span> <span class="hljs-variable">child</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Child</span>();
        child.show();
        
        System.out.println(<span class="hljs-string">"\n=== å¤šæ€æµ‹è¯• ==="</span>);
        <span class="hljs-type">Parent</span> <span class="hljs-variable">parent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Child</span>();
        parent.show();  <span class="hljs-comment">// è°ƒç”¨å­ç±»çš„showæ–¹æ³•</span>
    }
}
</code></pre>
<h2 data-id="heading-18">ğŸ’¡ <code>this</code> çš„é«˜çº§ç”¨æ³•</h2>
<h3 data-id="heading-19"><strong>1. åœ¨æšä¸¾ä¸­ä½¿ç”¨ this</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">Operation</span> {
    ADD(<span class="hljs-string">"+"</span>) {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">apply</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> {
            <span class="hljs-keyword">return</span> x + y;
        }
    },
    SUBTRACT(<span class="hljs-string">"-"</span>) {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">apply</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> {
            <span class="hljs-keyword">return</span> x - y;
        }
    };
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String symbol;
    
    Operation(String symbol) {
        <span class="hljs-built_in">this</span>.symbol = symbol;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">int</span> <span class="hljs-title function_">apply</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span>;
    
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getSymbol</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.symbol;
    }
    
    <span class="hljs-comment">// ä½¿ç”¨thisæ¯”è¾ƒæšä¸¾å€¼</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isAdd</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span> == ADD;  <span class="hljs-comment">// ä½¿ç”¨thisæ¯”è¾ƒ</span>
    }
}
</code></pre>
<h3 data-id="heading-20"><strong>2. åœ¨æ¥å£é»˜è®¤æ–¹æ³•ä¸­ä½¿ç”¨ this</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Calculator</span> {
    <span class="hljs-type">int</span> <span class="hljs-title function_">calculate</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span>;
    
    <span class="hljs-comment">// é»˜è®¤æ–¹æ³•ä¸­å¯ä»¥ä½¿ç”¨thisï¼ˆæŒ‡å‘å®ç°ç±»çš„å®ä¾‹ï¼‰</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showInfo</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"Calculatorå®ç°ç±»: "</span> + <span class="hljs-built_in">this</span>.getClass().getSimpleName());
    }
    
    <span class="hljs-comment">// é™æ€æ–¹æ³•ä¸­ä¸èƒ½ä½¿ç”¨this</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">staticMethod</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// System.out.println(this);  // âŒ é”™è¯¯</span>
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleCalculator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Calculator</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">calculate</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> {
        <span class="hljs-keyword">return</span> a + b;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è°ƒç”¨æ¥å£çš„é»˜è®¤æ–¹æ³•</span>
        <span class="hljs-built_in">this</span>.showInfo();  <span class="hljs-comment">// thisæŒ‡å‘SimpleCalculatorå®ä¾‹</span>
    }
}
</code></pre>
<h3 data-id="heading-21"><strong>3. åœ¨Lambdaè¡¨è¾¾å¼ä¸­ä½¿ç”¨ this</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LambdaThis</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">field</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ç±»å­—æ®µ"</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testLambda</span><span class="hljs-params">()</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">localVar</span> <span class="hljs-operator">=</span> <span class="hljs-string">"å±€éƒ¨å˜é‡"</span>;
        
        <span class="hljs-comment">// Lambdaè¡¨è¾¾å¼ä¸­çš„thisæŒ‡å‘å¤–éƒ¨ç±»çš„å®ä¾‹</span>
        <span class="hljs-type">Runnable</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> () -&gt; {
            System.out.println(<span class="hljs-string">"Lambdaä¸­çš„this: "</span> + <span class="hljs-built_in">this</span>);
            System.out.println(<span class="hljs-string">"è®¿é—®å­—æ®µ: "</span> + <span class="hljs-built_in">this</span>.field);
            System.out.println(<span class="hljs-string">"è®¿é—®å­—æ®µ(ç›´æ¥): "</span> + field);
            System.out.println(<span class="hljs-string">"è®¿é—®å±€éƒ¨å˜é‡: "</span> + localVar);
        };
        
        <span class="hljs-comment">// åŒ¿åå†…éƒ¨ç±»ä¸­çš„thisæŒ‡å‘å†…éƒ¨ç±»å®ä¾‹</span>
        <span class="hljs-type">Runnable</span> <span class="hljs-variable">r2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
                System.out.println(<span class="hljs-string">"åŒ¿åç±»ä¸­çš„this: "</span> + <span class="hljs-built_in">this</span>);
                System.out.println(<span class="hljs-string">"è®¿é—®å¤–éƒ¨å­—æ®µ: "</span> + LambdaThis.<span class="hljs-built_in">this</span>.field);
            }
        };
        
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(r).start();
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(r2).start();
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"LambdaThiså®ä¾‹"</span>;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaThis</span>().testLambda();
    }
}
</code></pre>
<h2 data-id="heading-22">ğŸ¯ <code>this</code> çš„å¸¸è§é¢è¯•é¢˜</h2>
<h3 data-id="heading-23"><strong>é¢˜ç›®1ï¼šä»¥ä¸‹ä»£ç è¾“å‡ºä»€ä¹ˆï¼Ÿ</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test1</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">print</span><span class="hljs-params">()</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> <span class="hljs-number">20</span>;
        System.out.println(<span class="hljs-string">"å±€éƒ¨value: "</span> + value);
        System.out.println(<span class="hljs-string">"æˆå‘˜value: "</span> + <span class="hljs-built_in">this</span>.value);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test1</span>().print();
    }
}
</code></pre>
<p><strong>ç­”æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">å±€éƒ¨value: 20</span>
<span class="hljs-section">æˆå‘˜value: 10</span>
</code></pre>
<h3 data-id="heading-24"><strong>é¢˜ç›®2ï¼šthis() è°ƒç”¨æœ‰ä»€ä¹ˆé™åˆ¶ï¼Ÿ</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test2</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> x;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Test2</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"åšä¸€äº›åˆå§‹åŒ–"</span>);
        <span class="hljs-built_in">this</span>(<span class="hljs-number">10</span>);  <span class="hljs-comment">// è¿™ä¼šæ€æ ·ï¼Ÿ</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Test2</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> {
        <span class="hljs-built_in">this</span>.x = x;
    }
}
</code></pre>
<p><strong>ç­”æ¡ˆ</strong>ï¼šç¼–è¯‘é”™è¯¯ã€‚<code>this()</code> å¿…é¡»æ˜¯æ„é€ å™¨ä¸­çš„ç¬¬ä¸€æ¡è¯­å¥ã€‚</p>
<h3 data-id="heading-25"><strong>é¢˜ç›®3ï¼šä»¥ä¸‹ä»£ç æ˜¯å¦æ­£ç¡®ï¼Ÿ</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test3</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">staticMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-built_in">this</span>);
    }
}
</code></pre>
<p><strong>ç­”æ¡ˆ</strong>ï¼šé”™è¯¯ã€‚é™æ€æ–¹æ³•ä¸­ä¸èƒ½ä½¿ç”¨ <code>this</code>ã€‚</p>
<h2 data-id="heading-26">ğŸ“Š <code>this</code> ä¸ <code>super</code> å¯¹æ¯”</h2>








































<table><thead><tr><th>ç‰¹æ€§</th><th><code>this</code></th><th><code>super</code></th></tr></thead><tbody><tr><td><strong>æŒ‡å‘å¯¹è±¡</strong></td><td>å½“å‰å¯¹è±¡å®ä¾‹</td><td>çˆ¶ç±»å¯¹è±¡å®ä¾‹</td></tr><tr><td><strong>è®¿é—®å˜é‡</strong></td><td>å½“å‰ç±»çš„æˆå‘˜å˜é‡</td><td>çˆ¶ç±»çš„æˆå‘˜å˜é‡</td></tr><tr><td><strong>è°ƒç”¨æ–¹æ³•</strong></td><td>å½“å‰ç±»çš„æ–¹æ³•ï¼ˆå¯èƒ½è¢«å­ç±»é‡å†™ï¼‰</td><td>çˆ¶ç±»çš„æ–¹æ³•ï¼ˆä¸ä¼šè¢«é‡å†™å½±å“ï¼‰</td></tr><tr><td><strong>è°ƒç”¨æ„é€ å™¨</strong></td><td><code>this()</code> è°ƒç”¨æœ¬ç±»å…¶ä»–æ„é€ å™¨</td><td><code>super()</code> è°ƒç”¨çˆ¶ç±»æ„é€ å™¨</td></tr><tr><td><strong>ä½¿ç”¨é™åˆ¶</strong></td><td>å¯ä»¥åœ¨å®ä¾‹æ–¹æ³•ã€æ„é€ å™¨ä¸­ä½¿ç”¨</td><td>å¯ä»¥åœ¨å­ç±»çš„å®ä¾‹æ–¹æ³•ã€æ„é€ å™¨ä¸­ä½¿ç”¨</td></tr><tr><td><strong>é™æ€ä¸Šä¸‹æ–‡</strong></td><td>ä¸èƒ½åœ¨é™æ€æ–¹æ³•ã€é™æ€å—ä¸­ä½¿ç”¨</td><td>ä¸èƒ½åœ¨é™æ€æ–¹æ³•ã€é™æ€å—ä¸­ä½¿ç”¨</td></tr></tbody></table>
<h2 data-id="heading-27">ğŸ“ æœ€ä½³å®è·µæ€»ç»“</h2>
<h3 data-id="heading-28"><strong>1. æ˜ç¡®ä½¿ç”¨ this çš„åœºæ™¯</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BestPractice</span> {
    <span class="hljs-keyword">private</span> String name;
    
    <span class="hljs-comment">// åœºæ™¯1ï¼šåŒºåˆ†æˆå‘˜å˜é‡å’Œå‚æ•°ï¼ˆå¿…é¡»ä½¿ç”¨ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;  <span class="hljs-comment">// âœ… å¿…é¡»ä½¿ç”¨this</span>
    }
    
    <span class="hljs-comment">// åœºæ™¯2ï¼šæ„é€ å™¨é“¾ï¼ˆå¿…é¡»ä½¿ç”¨ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BestPractice</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>(<span class="hljs-string">"é»˜è®¤åç§°"</span>);  <span class="hljs-comment">// âœ… å¿…é¡»ä½¿ç”¨this()</span>
    }
    
    <span class="hljs-comment">// åœºæ™¯3ï¼šé“¾å¼è°ƒç”¨ï¼ˆè¿”å›thisï¼‰</span>
    <span class="hljs-keyword">public</span> BestPractice <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> {
        <span class="hljs-comment">// ... è®¾ç½®å¹´é¾„é€»è¾‘</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;  <span class="hljs-comment">// âœ… æ”¯æŒé“¾å¼è°ƒç”¨</span>
    }
    
    <span class="hljs-comment">// åœºæ™¯4ï¼šæ²¡æœ‰æ­§ä¹‰æ—¶å¯ä»¥çœç•¥</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printName</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è¿™é‡Œæ²¡æœ‰å±€éƒ¨å˜é‡nameï¼Œå¯ä»¥ç›´æ¥è®¿é—®</span>
        System.out.println(name);  <span class="hljs-comment">// âœ… å¯ä»¥çœç•¥this</span>
        
        <span class="hljs-comment">// ä½¿ç”¨thisä¹Ÿå¯ä»¥ï¼Œæ›´æ˜ç¡®</span>
        System.out.println(<span class="hljs-built_in">this</span>.name);  <span class="hljs-comment">// âœ… æ›´æ¸…æ™°</span>
    }
}
</code></pre>
<h3 data-id="heading-29"><strong>2. é¿å…æ»¥ç”¨ this</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AvoidAbuse</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> value;
    
    <span class="hljs-comment">// âŒ ä¸å¿…è¦çš„thisï¼ˆæ²¡æœ‰æ­§ä¹‰ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setValue</span><span class="hljs-params">(<span class="hljs-type">int</span> val)</span> {
        <span class="hljs-built_in">this</span>.value = val;  <span class="hljs-comment">// å¯ä»¥ï¼Œä½†æ²¡æœ‰å¿…è¦ï¼ˆå‚æ•°åä¸åŒï¼‰</span>
    }
    
    <span class="hljs-comment">// âœ… æ›´å¥½çš„å†™æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setValue</span><span class="hljs-params">(<span class="hljs-type">int</span> value)</span> {
        <span class="hljs-built_in">this</span>.value = value;  <span class="hljs-comment">// å¿…é¡»ä½¿ç”¨this</span>
    }
    
    <span class="hljs-comment">// âœ… æœ€ä½³ï¼šä½¿ç”¨ä¸åŒçš„å‚æ•°å</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setValue</span><span class="hljs-params">(<span class="hljs-type">int</span> newValue)</span> {
        value = newValue;  <span class="hljs-comment">// ä¸éœ€è¦thisï¼Œæ›´ç®€æ´</span>
    }
}
</code></pre>
<h3 data-id="heading-30"><strong>3. æ„é€ å™¨ä¸­çš„æœ€ä½³å®è·µ</strong></h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConstructorBestPractice</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String id;     <span class="hljs-comment">// finalå­—æ®µå¿…é¡»åœ¨æ„é€ å™¨ä¸­åˆå§‹åŒ–</span>
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;
    
    <span class="hljs-comment">// ä¸»è¦æ„é€ å™¨ï¼ˆåˆå§‹åŒ–æ‰€æœ‰å­—æ®µï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ConstructorBestPractice</span><span class="hljs-params">(String id, String name, <span class="hljs-type">int</span> age)</span> {
        <span class="hljs-comment">// å‚æ•°éªŒè¯</span>
        <span class="hljs-keyword">if</span> (id == <span class="hljs-literal">null</span> || id.isEmpty()) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"IDä¸èƒ½ä¸ºç©º"</span>);
        }
        
        <span class="hljs-comment">// åˆå§‹åŒ–finalå­—æ®µ</span>
        <span class="hljs-built_in">this</span>.id = id;
        
        <span class="hljs-comment">// ä½¿ç”¨thisåˆå§‹åŒ–å…¶ä»–å­—æ®µ</span>
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.age = age;
    }
    
    <span class="hljs-comment">// è¾…åŠ©æ„é€ å™¨ï¼ˆæä¾›é»˜è®¤å€¼ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ConstructorBestPractice</span><span class="hljs-params">(String id)</span> {
        <span class="hljs-built_in">this</span>(id, <span class="hljs-string">"æœªçŸ¥"</span>, <span class="hljs-number">0</span>);  <span class="hljs-comment">// è°ƒç”¨ä¸»è¦æ„é€ å™¨</span>
    }
    
    <span class="hljs-comment">// è¾…åŠ©æ„é€ å™¨ï¼ˆä½¿ç”¨this()é“¾ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ConstructorBestPractice</span><span class="hljs-params">(String id, String name)</span> {
        <span class="hljs-built_in">this</span>(id, name, <span class="hljs-number">0</span>);  <span class="hljs-comment">// è°ƒç”¨ä¸»è¦æ„é€ å™¨</span>
    }
}
</code></pre>
<p>è®°ä½ï¼š<strong><code>this</code> æ˜¯æŒ‡å‘å½“å‰å¯¹è±¡çš„å¼•ç”¨</strong>ï¼Œæ­£ç¡®ä½¿ç”¨ <code>this</code> å¯ä»¥è®©ä»£ç æ›´æ¸…æ™°ã€æ›´å¥å£®ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å˜é‡åå†²çªã€æ„é€ å™¨é“¾å’Œé“¾å¼è°ƒç”¨æ—¶éå¸¸é‡è¦ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ§­ ç”¨ Trae Solo åšæŠ€æœ¯æ ˆåˆ†æ + ä¸€é”®éƒ¨ç½²ï¼šä¸€ä¸ª 8 å¹´ Java å·¥ç¨‹å¸ˆçš„å®æˆ˜åˆ†äº«]]></title>    <link>https://juejin.cn/post/7578797337867337762</link>    <guid>https://juejin.cn/post/7578797337867337762</guid>    <pubDate>2025-12-02T02:26:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578797337867337762" data-draft-id="7578777952726597666" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ§­ ç”¨ Trae Solo åšæŠ€æœ¯æ ˆåˆ†æ + ä¸€é”®éƒ¨ç½²ï¼šä¸€ä¸ª 8 å¹´ Java å·¥ç¨‹å¸ˆçš„å®æˆ˜åˆ†äº«"/> <meta itemprop="keywords" content="Trae"/> <meta itemprop="datePublished" content="2025-12-02T02:26:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤©å¤©æ‘¸é±¼çš„javaå·¥ç¨‹å¸ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/3109843365802925"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ§­ ç”¨ Trae Solo åšæŠ€æœ¯æ ˆåˆ†æ + ä¸€é”®éƒ¨ç½²ï¼šä¸€ä¸ª 8 å¹´ Java å·¥ç¨‹å¸ˆçš„å®æˆ˜åˆ†äº«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3109843365802925/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤©å¤©æ‘¸é±¼çš„javaå·¥ç¨‹å¸ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T02:26:47.000Z" title="Tue Dec 02 2025 02:26:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ§­ ç”¨ Trae Solo åšæŠ€æœ¯æ ˆåˆ†æ + ä¸€é”®éƒ¨ç½²ï¼šä¸€ä¸ª 8 å¹´ Java å·¥ç¨‹å¸ˆçš„å®æˆ˜åˆ†äº«</h2>
<p>ä½œä¸ºä¸€åä» Java EE ä¸€è·¯èµ°åˆ° Spring Bootã€Spring Cloud çš„è€å…µï¼Œæˆ‘æ·±çŸ¥å¾®æœåŠ¡æ¶æ„å¸¦æ¥çš„çµæ´»ä¸æŒ‘æˆ˜ã€‚è€Œå½“é¢å¯¹ä¸€ä¸ªæ¨¡å—ç¹å¤šã€æŠ€æœ¯æ ˆå¤æ‚çš„é¡¹ç›®ï¼Œæˆ‘å‘ç° <strong>Trae Solo ä¸ä»…èƒ½åˆ†ææˆ‘çš„é¡¹ç›®æŠ€æœ¯æ ˆï¼Œè¿˜èƒ½ç”ŸæˆæœåŠ¡å®šä¹‰ã€Dockerfileã€docker-compose å’Œå¯åŠ¨è„šæœ¬ï¼Œå¤§å¤§ç®€åŒ–äº†éƒ¨ç½²æµç¨‹ã€‚</strong></p>
<p>ä»Šå¤©ï¼Œæˆ‘å°±ä»ä¸€ä¸ªå®æˆ˜é¡¹ç›®å‡ºå‘ï¼Œè®²è®²æˆ‘æ˜¯å¦‚ä½•ç”¨ <strong>Trae Solo</strong> åˆ†ææŠ€æœ¯æ¶æ„ï¼Œå¹¶å®ç°ä¸€é”®éƒ¨ç½²çš„ã€‚</p>
<hr/>
<h3 data-id="heading-1">ğŸ‘¨â€ğŸ’» é¡¹ç›®èƒŒæ™¯ï¼šä¸€ä¸ªå…¸å‹çš„ Java å¾®æœåŠ¡é¡¹ç›®</h3>
<p>æˆ‘çš„é¡¹ç›®é‡‡ç”¨äº†ä¸»æµçš„ Spring Cloud æŠ€æœ¯æ ˆï¼Œæ€»ä½“ç»“æ„å¦‚ä¸‹ï¼š</p>













































<table><thead><tr><th>æœåŠ¡åç§°</th><th>æŠ€æœ¯æ¡†æ¶</th><th>æè¿°</th></tr></thead><tbody><tr><td>gateway-service</td><td>Spring Cloud Gateway</td><td>API ç½‘å…³</td></tr><tr><td>auth-service</td><td>Spring Security OAuth2</td><td>é‰´æƒæœåŠ¡</td></tr><tr><td>user-service</td><td>Spring Boot + MyBatis</td><td>ç”¨æˆ·æœåŠ¡</td></tr><tr><td>order-service</td><td>Spring Boot + OpenFeign</td><td>è®¢å•æœåŠ¡</td></tr><tr><td>mysql</td><td>MySQL 8</td><td>æ•°æ®åº“</td></tr><tr><td>redis</td><td>Redis 6</td><td>ç¼“å­˜</td></tr><tr><td>nacos</td><td>Nacos</td><td>æ³¨å†Œä¸­å¿ƒ + é…ç½®ä¸­å¿ƒ</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-2">ğŸ§  ç¬¬ä¸€æ­¥ï¼šç”¨ Trae Solo åˆ†ææŠ€æœ¯æ ˆ</h3>
<h4 data-id="heading-3">ğŸ§° å·¥å…·ï¼šTrae Solo</h4>
<p>Trae Solo æ˜¯ä¸€ä¸ª AI é©±åŠ¨çš„ DevOps åŠ©æ‰‹ï¼Œå¯ä»¥ï¼š</p>
<ul>
<li>è‡ªåŠ¨è§£æé¡¹ç›®ç»“æ„</li>
<li>è¯†åˆ«æ¯ä¸ªæœåŠ¡çš„è¯­è¨€ã€æ¡†æ¶ã€ä¾èµ–</li>
<li>è‡ªåŠ¨ç”Ÿæˆ Dockerfileã€docker-composeã€éƒ¨ç½²è„šæœ¬</li>
</ul>
<h4 data-id="heading-4">ğŸ“¦ åˆ†æè¿‡ç¨‹</h4>
<p>æˆ‘å°†é¡¹ç›®æºç ä¸Šä¼ åˆ° Trae Solo çš„åˆ†æå¹³å°ï¼Œå®ƒä»ä»¥ä¸‹å‡ ä¸ªç»´åº¦å®Œæˆåˆ†æï¼š</p>
<ul>
<li><strong>è¯­è¨€è¯†åˆ«</strong>ï¼šJava / YAML / SQL / Dockerfile / Shell</li>
<li><strong>æœåŠ¡æ‹†åˆ†</strong>ï¼šæ ¹æ® Maven å¤šæ¨¡å—è¯†åˆ«å‡ºç‹¬ç«‹æœåŠ¡</li>
<li><strong>ä¾èµ–åˆ†æ</strong>ï¼šå¦‚ Nacosã€MySQLã€Redisã€OpenFeignã€Spring Security ç­‰</li>
<li><strong>å¯åŠ¨æ–¹å¼è¯†åˆ«</strong>ï¼šåˆ¤æ–­å…¥å£ç±»ã€ç«¯å£ã€ä¾èµ–æœåŠ¡</li>
</ul>
<h4 data-id="heading-5">ğŸ§¾ è‡ªåŠ¨ç”Ÿæˆçš„å†…å®¹åŒ…æ‹¬ï¼š</h4>
<ul>
<li>æ¯ä¸ªæœåŠ¡çš„ <code>Dockerfile</code></li>
<li>æ‰€æœ‰æœåŠ¡çš„ <code>docker-compose.yml</code></li>
<li>ä¸€é”®éƒ¨ç½²è„šæœ¬ <code>deploy.sh</code></li>
<li><code>.env</code> é…ç½®æ–‡ä»¶æ¨¡æ¿</li>
</ul>
<hr/>
<h3 data-id="heading-6">ğŸ³ ç¬¬äºŒæ­¥ï¼šä½¿ç”¨ Trae Solo ç”Ÿæˆçš„ Docker Compose</h3>
<h4 data-id="heading-7">ğŸ“„ è‡ªåŠ¨ç”Ÿæˆçš„ docker-compose.ymlï¼ˆç®€åŒ–ç‰ˆï¼‰</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-attr">nacos:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">nacos/nacos-server:2.3.0</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"8848:8848"</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">MODE:</span> <span class="hljs-string">standalone</span>

  <span class="hljs-attr">mysql:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:8.0</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"3306:3306"</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">root1234</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./data/mysql:/var/lib/mysql</span>

  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">redis:6</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"6379:6379"</span>

  <span class="hljs-attr">gateway-service:</span>
    <span class="hljs-attr">build:</span>
      <span class="hljs-attr">context:</span> <span class="hljs-string">./gateway-service</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"8080:8080"</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">nacos</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">auth-service</span>

  <span class="hljs-attr">auth-service:</span>
    <span class="hljs-attr">build:</span>
      <span class="hljs-attr">context:</span> <span class="hljs-string">./auth-service</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"9000:9000"</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">mysql</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">redis</span>

  <span class="hljs-attr">user-service:</span>
    <span class="hljs-attr">build:</span>
      <span class="hljs-attr">context:</span> <span class="hljs-string">./user-service</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"9001:9001"</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">mysql</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">redis</span>

  <span class="hljs-attr">order-service:</span>
    <span class="hljs-attr">build:</span>
      <span class="hljs-attr">context:</span> <span class="hljs-string">./order-service</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"9002:9002"</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">user-service</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">mysql</span>
</code></pre>
<blockquote>
<p>âœ… Trae Solo ä¸ä»…å¸®æˆ‘è¯†åˆ«äº†ç«¯å£ï¼Œè¿˜è‡ªåŠ¨è®¾ç½®äº† <code>depends_on</code> æ¥å¤„ç†æœåŠ¡é—´çš„ä¾èµ–é¡ºåºã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-8">ğŸ”§ ç¬¬ä¸‰æ­¥ï¼šTrae Solo è‡ªåŠ¨ç”Ÿæˆçš„ Dockerfile ç¤ºä¾‹</h3>
<p>ä»¥ <code>user-service</code> ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">FROM</span> openjdk:<span class="hljs-number">17</span><span class="hljs-operator">-</span>jdk<span class="hljs-operator">-</span>alpine
WORKDIR <span class="hljs-operator">/</span>app
<span class="hljs-keyword">COPY</span> target<span class="hljs-operator">/</span><span class="hljs-keyword">user</span><span class="hljs-operator">-</span>service.jar app.jar
EXPOSE <span class="hljs-number">9001</span>
ENTRYPOINT ["java", "-jar", "app.jar"]
</code></pre>
<p>å…¶ä»–æœåŠ¡çš„ Dockerfile ä¹Ÿç±»ä¼¼ï¼ŒTrae Solo ä¼šè‡ªåŠ¨è¯†åˆ«ç¼–è¯‘äº§ç‰©è·¯å¾„å¹¶æ‹·è´ã€‚</p>
<hr/>
<h3 data-id="heading-9">ğŸš€ ç¬¬å››æ­¥ï¼šä¸€é”®éƒ¨ç½²è„šæœ¬ deploy.sh</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"â³ åœæ­¢æ—§å®¹å™¨..."</span>
docker-compose down

<span class="hljs-built_in">echo</span> <span class="hljs-string">"ğŸ”„ æ„å»ºé•œåƒ..."</span>
docker-compose build

<span class="hljs-built_in">echo</span> <span class="hljs-string">"ğŸš€ å¯åŠ¨æœåŠ¡..."</span>
docker-compose up -d

<span class="hljs-built_in">echo</span> <span class="hljs-string">"âœ… æ‰€æœ‰æœåŠ¡å·²å¯åŠ¨ï¼"</span>
docker ps
</code></pre>
<p>è¿è¡Œæ–¹å¼ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">chmod</span> +x deploy.sh
./deploy.sh
</code></pre>
<p>çŸ­çŸ­å‡ åˆ†é’Ÿï¼Œæ‰€æœ‰æœåŠ¡éƒ½åœ¨æœ¬åœ°å®¹å™¨ä¸­è·‘äº†èµ·æ¥ï¼Œä» Nacos åˆ° Gateway åˆ°ä¸šåŠ¡æœåŠ¡ï¼Œé€šé€š OKã€‚</p>
<hr/>
<h3 data-id="heading-10">ğŸ§ª ç¬¬äº”æ­¥ï¼šéªŒè¯éƒ¨ç½²æ•ˆæœ</h3>
<ul>
<li>é€šè¿‡ <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A8848%2F" target="_blank" title="http://localhost:8848/" ref="nofollow noopener noreferrer">http://localhost:8848</a> è®¿é—® Nacos æ§åˆ¶å°</li>
<li>é€šè¿‡ <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A8080%2F" target="_blank" title="http://localhost:8080/" ref="nofollow noopener noreferrer">http://localhost:8080</a> è®¿é—®ç½‘å…³æ¥å£</li>
<li>ä½¿ç”¨ Postman æµ‹è¯•ç”¨æˆ·æœåŠ¡ã€è®¢å•æœåŠ¡ API</li>
<li>æŸ¥çœ‹æ•°æ®æ˜¯å¦å†™å…¥ MySQLã€Redis ç¼“å­˜æ˜¯å¦ç”Ÿæ•ˆ</li>
</ul>
<hr/>
<h3 data-id="heading-11">ğŸ§  æ€»ç»“ï¼šä¸ºä»€ä¹ˆæˆ‘é€‰æ‹© Trae Soloï¼Ÿ</h3>
<p>ä½œä¸ºä¸€åèµ„æ·± Java å·¥ç¨‹å¸ˆï¼Œæˆ‘éå¸¸æ¸…æ¥šï¼š</p>
<ul>
<li>é¡¹ç›®æŠ€æœ¯æ ˆå¤æ‚ï¼Œé äººå·¥ç»´æŠ¤é…ç½®éå¸¸å®¹æ˜“å‡ºé”™</li>
<li>å¾®æœåŠ¡éƒ¨ç½²æµç¨‹ç¹çï¼Œé‡å¤åŠ³åŠ¨æµªè´¹æ—¶é—´</li>
<li>å®¹å™¨åŒ–éƒ¨ç½²æ˜¯è¶‹åŠ¿ï¼Œä½†å†™ Dockerfile å’Œ Compose éœ€è¦ç»éªŒ</li>
</ul>
<p><strong>Trae Solo æå¤§åœ°é™ä½äº†ä¸Šæ‰‹é—¨æ§›ï¼Œå®ƒæ˜¯æˆ‘ DevOps æµç¨‹ä¸­ä¸å¯æˆ–ç¼ºçš„è‡ªåŠ¨åŒ–åˆ©å™¨ã€‚</strong></p>
<hr/>
<h3 data-id="heading-12">âœ… å»ºè®®ä½¿ç”¨åœºæ™¯</h3>
<ul>
<li>å¿«é€Ÿä¸ºå›¢é˜Ÿæ­å»ºæœ¬åœ°å¼€å‘ç¯å¢ƒ</li>
<li>åˆåˆ›å›¢é˜Ÿå¿«é€Ÿä¸Šçº¿ MVP</li>
<li>å¤æ‚é¡¹ç›®è‡ªåŠ¨ç”Ÿæˆéƒ¨ç½²é…ç½®</li>
<li>æ•™å­¦æˆ–æŠ€æœ¯åˆ†äº«åœºæ™¯è‡ªåŠ¨ç”Ÿæˆæ¼”ç¤ºç¯å¢ƒ</li>
</ul>
<hr/>
<h3 data-id="heading-13">ğŸ“Œ æƒ³å¯¹ Trae Solo è¯´</h3>
<p>Trae Solo ä¸ä»…æ˜¯å·¥å…·ï¼Œæ›´åƒæ˜¯æˆ‘æŠ€æœ¯å›¢é˜Ÿä¸­çš„ä¸€ä½ DevOps å·¥ç¨‹å¸ˆï¼Œå®ƒå¸®æˆ‘èŠ‚çœäº†å¤§é‡çš„é…ç½®æ—¶é—´ï¼Œè®©æˆ‘èƒ½æ›´ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘å’Œæ¶æ„è®¾è®¡ã€‚</p>
<blockquote>
<p>â€œå®ƒæ‡‚ä»£ç ï¼Œä¹Ÿæ‡‚éƒ¨ç½²ã€‚â€</p>
</blockquote>
<hr/>
<h3 data-id="heading-14">ğŸ§‘â€ğŸ’» ä½œè€…ç®€ä»‹</h3>
<p><strong>æ˜µç§°ï¼šä»£ç é‡Œçš„æ—…è¡Œè€…</strong><br/>
<strong>ç»éªŒï¼š8 å¹´ Javaã€ç°ä¸»æ”»å¾®æœåŠ¡ + DevOps</strong><br/>
<strong>ä¸ªäººå£å·ï¼šå†™æ›´å°‘çš„é…ç½®ï¼Œæ„å»ºæ›´å¼ºçš„ç³»ç»Ÿã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flutter åŸºç¡€æ§ä»¶é€ŸæŸ¥ï¼ˆé¢å‘ Android å¼€å‘è€…ï¼‰]]></title>    <link>https://juejin.cn/post/7578780780026707977</link>    <guid>https://juejin.cn/post/7578780780026707977</guid>    <pubDate>2025-12-02T02:44:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578780780026707977" data-draft-id="7578803751608795186" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flutter åŸºç¡€æ§ä»¶é€ŸæŸ¥ï¼ˆé¢å‘ Android å¼€å‘è€…ï¼‰"/> <meta itemprop="keywords" content="Flutter"/> <meta itemprop="datePublished" content="2025-12-02T02:44:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="renxhui"/> <meta itemprop="url" content="https://juejin.cn/user/1292681403181944"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flutter åŸºç¡€æ§ä»¶é€ŸæŸ¥ï¼ˆé¢å‘ Android å¼€å‘è€…ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1292681403181944/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    renxhui
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T02:44:32.000Z" title="Tue Dec 02 2025 02:44:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Flutter åŸºç¡€æ§ä»¶é€ŸæŸ¥ï¼ˆé¢å‘ Android å¼€å‘è€…ï¼‰</h2>
<blockquote>
<p>ç›®æ ‡ï¼šä½ æ˜¯ Android å¼€å‘ï¼Œå¿«é€Ÿä¸Šæ‰‹ Flutter UI ä¸å¸¸ç”¨æ§ä»¶ã€‚ç¤ºä¾‹å‡å¯ç›´æ¥å¤åˆ¶åˆ° Flutter å·¥ç¨‹ä¸­å°è¯•ã€‚</p>
</blockquote>
<h3 data-id="heading-1">1. å¿«é€Ÿå¯¹ç…§è¡¨ï¼ˆAndroid â†’ Flutterï¼‰</h3>
<ul>
<li>è§†å›¾å®¹å™¨ï¼šView â†’ <code>Container</code> / <code>SizedBox</code></li>
<li>çº¿æ€§å¸ƒå±€ï¼šLinearLayout(horizontal/vertical) â†’ <code>Row</code> / <code>Column</code></li>
<li>çº¦æŸ/å æ”¾ï¼šFrameLayout / RelativeLayout â†’ <code>Stack</code> + <code>Positioned</code>ï¼Œ<code>Align</code></li>
<li>åˆ—è¡¨ï¼šRecyclerView â†’ <code>ListView.builder</code> / <code>GridView.builder</code> / <code>CustomScrollView + Slivers</code></li>
<li>æ–‡æœ¬ï¼šTextView â†’ <code>Text</code></li>
<li>å›¾ç‰‡ï¼šImageView â†’ <code>Image</code></li>
<li>æŒ‰é’®ï¼šButton â†’ <code>ElevatedButton</code> / <code>TextButton</code> / <code>IconButton</code></li>
<li>è¾“å…¥æ¡†ï¼šEditText â†’ <code>TextField</code></li>
<li>é¡¶éƒ¨æ ï¼šToolbar/ActionBar â†’ <code>AppBar</code></li>
<li>é¡µé¢å®¹å™¨ï¼šActivity/Fragment â†’ <code>Scaffold</code> + è·¯ç”±ï¼ˆ<code>go_router</code>ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-2">2. å¸ƒå±€åŸºç¡€</h3>
<h4 data-id="heading-3">2.1 çº¿æ€§å¸ƒå±€ï¼šRow / Column</h4>
<pre><code class="hljs language-dart" lang="dart">Row(
  children: [
    <span class="hljs-keyword">const</span> Icon(Icons.star),
    <span class="hljs-keyword">const</span> SizedBox(width: <span class="hljs-number">8</span>),
    <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'Row ç¤ºä¾‹'</span>),
    <span class="hljs-keyword">const</span> Spacer(), <span class="hljs-comment">// å æ»¡å‰©ä½™ç©ºé—´</span>
    ElevatedButton(onPressed: () {}, child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'æŒ‰é’®'</span>)),
  ],
)
</code></pre>
<pre><code class="hljs language-dart" lang="dart">Column(
  crossAxisAlignment: CrossAxisAlignment.start,
  children: [
    <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'æ ‡é¢˜'</span>, style: TextStyle(fontSize: <span class="hljs-number">18</span>, fontWeight: FontWeight.w600)),
    <span class="hljs-keyword">const</span> SizedBox(height: <span class="hljs-number">8</span>),
    <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'å‰¯æ ‡é¢˜'</span>),
  ],
)
</code></pre>
<h4 data-id="heading-4">2.2 çº¦æŸä¸å æ”¾ï¼šContainer / SizedBox / Stack</h4>
<pre><code class="hljs language-dart" lang="dart">Container(
  width: <span class="hljs-number">200</span>,
  height: <span class="hljs-number">120</span>,
  padding: <span class="hljs-keyword">const</span> EdgeInsets.all(<span class="hljs-number">12</span>),
  decoration: BoxDecoration(
    color: <span class="hljs-keyword">const</span> Color(<span class="hljs-number">0xFFECECEC</span>),
    borderRadius: BorderRadius.circular(<span class="hljs-number">12</span>),
  ),
  child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'Container å¸¦åœ†è§’ä¸å†…è¾¹è·'</span>),
)
</code></pre>
<pre><code class="hljs language-dart" lang="dart">Stack(
  children: [
    Image.network(<span class="hljs-string">'https://picsum.photos/400/200'</span>, width: <span class="hljs-built_in">double</span>.infinity, height: <span class="hljs-number">200</span>, fit: BoxFit.cover),
    <span class="hljs-keyword">const</span> Positioned(
      left: <span class="hljs-number">12</span>, bottom: <span class="hljs-number">12</span>,
      child: Text(<span class="hljs-string">'å æ”¾æ–‡æœ¬'</span>, style: TextStyle(color: Colors.white, fontWeight: FontWeight.bold)),
    )
  ],
)
</code></pre>
<h4 data-id="heading-5">2.3 è‡ªé€‚åº”ï¼šExpanded / Flexible / Wrap / Align / Center</h4>
<pre><code class="hljs language-dart" lang="dart">Row(
  children: [
    Expanded(child: Container(color: Colors.blue, height: <span class="hljs-number">40</span>)),
    <span class="hljs-keyword">const</span> SizedBox(width: <span class="hljs-number">8</span>),
    Flexible(child: Container(color: Colors.orange, height: <span class="hljs-number">40</span>)),
  ],
)
</code></pre>
<hr/>
<h3 data-id="heading-6">3. åˆ—è¡¨ä¸æ»šåŠ¨</h3>
<h4 data-id="heading-7">3.1 ListView.builder</h4>
<pre><code class="hljs language-dart" lang="dart">ListView.builder(
  itemCount: <span class="hljs-number">20</span>,
  itemBuilder: (context, i) =&gt; ListTile(
    leading: CircleAvatar(child: Text(<span class="hljs-string">'<span class="hljs-subst">$i</span>'</span>)),
    title: Text(<span class="hljs-string">'Item <span class="hljs-subst">$i</span>'</span>),
  ),
)
</code></pre>
<h4 data-id="heading-8">3.2 GridView.builder</h4>
<pre><code class="hljs language-dart" lang="dart">GridView.builder(
  gridDelegate: <span class="hljs-keyword">const</span> SliverGridDelegateWithFixedCrossAxisCount(
    crossAxisCount: <span class="hljs-number">2</span>, mainAxisSpacing: <span class="hljs-number">8</span>, crossAxisSpacing: <span class="hljs-number">8</span>, childAspectRatio: <span class="hljs-number">0.75</span>),
  itemCount: <span class="hljs-number">10</span>,
  itemBuilder: (context, i) =&gt; Container(color: Colors.grey.shade200),
)
</code></pre>
<h4 data-id="heading-9">3.3 Sliversï¼ˆé«˜çº§å¯é€‰ï¼‰</h4>
<pre><code class="hljs language-dart" lang="dart">CustomScrollView(
  slivers: [
    <span class="hljs-keyword">const</span> SliverAppBar(pinned: <span class="hljs-keyword">true</span>, title: Text(<span class="hljs-string">'Sliver åˆ—è¡¨ç¤ºä¾‹'</span>)),
    SliverList.builder(
      itemCount: <span class="hljs-number">50</span>,
      itemBuilder: (context, i) =&gt; ListTile(title: Text(<span class="hljs-string">'Row <span class="hljs-subst">$i</span>'</span>)),
    ),
  ],
)
</code></pre>
<hr/>
<h3 data-id="heading-10">4. æ–‡æœ¬ã€å›¾ç‰‡ã€å›¾æ ‡</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">const</span> Text(<span class="hljs-string">'Hello Flutter'</span>, style: TextStyle(fontSize: <span class="hljs-number">16</span>));
<span class="hljs-keyword">const</span> Icon(Icons.settings, color: Colors.blue);
Image.asset(<span class="hljs-string">'assets/images/common/logo.png'</span>, width: <span class="hljs-number">48</span>, height: <span class="hljs-number">48</span>);
Image.network(<span class="hljs-string">'https://picsum.photos/200'</span>, fit: BoxFit.cover);
</code></pre>
<p>å¯Œæ–‡æœ¬ï¼ˆç±»ä¼¼ Android Spannableï¼‰ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">const</span> RichText(
  text: TextSpan(
    text: <span class="hljs-string">'Flutter '</span>,
    style: TextStyle(color: Colors.black),
    children: [
      TextSpan(text: <span class="hljs-string">'åŠ ç²—'</span>, style: TextStyle(fontWeight: FontWeight.bold)),
      TextSpan(text: <span class="hljs-string">' &amp; '</span>),
      TextSpan(text: <span class="hljs-string">'å˜è‰²'</span>, style: TextStyle(color: Colors.red)),
    ],
  ),
)
</code></pre>
<hr/>
<h3 data-id="heading-11">5. æŒ‰é’®ä¸æ‰‹åŠ¿</h3>
<pre><code class="hljs language-dart" lang="dart">ElevatedButton(onPressed: () {}, child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'ç¡®å®š'</span>));
TextButton(onPressed: () {}, child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'å–æ¶ˆ'</span>));
IconButton(onPressed: () {}, icon: <span class="hljs-keyword">const</span> Icon(Icons.share));
</code></pre>
<p>ç‚¹å‡»æ°´æ³¢ä¸æ‰‹åŠ¿ï¼š</p>
<pre><code class="hljs language-dart" lang="dart">InkWell(
  onTap: () {},
  borderRadius: BorderRadius.circular(<span class="hljs-number">12</span>),
  child: <span class="hljs-keyword">const</span> Padding(
    padding: EdgeInsets.all(<span class="hljs-number">12</span>),
    child: Text(<span class="hljs-string">'InkWell ç‚¹å‡»åŒºåŸŸ'</span>),
  ),
)
</code></pre>
<hr/>
<h3 data-id="heading-12">6. è¾“å…¥ä¸è¡¨å•</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">final</span> TextEditingController controller = TextEditingController();

TextField(
  controller: controller,
  decoration: <span class="hljs-keyword">const</span> InputDecoration(
    hintText: <span class="hljs-string">'è¯·è¾“å…¥å†…å®¹'</span>,
    border: OutlineInputBorder(),
  ),
)
</code></pre>
<p>è¡¨å•æ ¡éªŒï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">final</span> GlobalKey&lt;FormState&gt; formKey = GlobalKey&lt;FormState&gt;();

Form(
  key: formKey,
  child: Column(
    children: [
      TextFormField(
        validator: (v) =&gt; (v == <span class="hljs-keyword">null</span> || v.isEmpty) ? <span class="hljs-string">'å¿…å¡«'</span> : <span class="hljs-keyword">null</span>,
      ),
      ElevatedButton(
        onPressed: () {
          <span class="hljs-keyword">if</span> (formKey.currentState!.validate()) {
            <span class="hljs-comment">// æäº¤</span>
          }
        },
        child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'æäº¤'</span>),
      )
    ],
  ),
)
</code></pre>
<hr/>
<h3 data-id="heading-13">7. é¡µé¢ç»“æ„ä¸å¯¼èˆª</h3>
<p>åŸºæœ¬é¡µé¢ç»“æ„ï¼š</p>
<pre><code class="hljs language-dart" lang="dart">Scaffold(
  appBar: AppBar(title: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'æ ‡é¢˜'</span>)),
  body: <span class="hljs-keyword">const</span> Center(child: Text(<span class="hljs-string">'å†…å®¹åŒº'</span>)),
  floatingActionButton: FloatingActionButton(
    onPressed: () {},
    child: <span class="hljs-keyword">const</span> Icon(Icons.add),
  ),
)
</code></pre>
<p>å¯¼èˆªï¼ˆé¡¹ç›®ä½¿ç”¨ go_routerï¼Œç¤ºä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// æ³¨å†Œè·¯ç”±ï¼ˆç®€åŒ–ç¤ºä¾‹ï¼‰</span>
<span class="hljs-comment">// context.go('/detail'); // è·³è½¬</span>
<span class="hljs-comment">// context.pop();         // è¿”å›</span>
</code></pre>
<hr/>
<h3 data-id="heading-14">8. çŠ¶æ€ç®¡ç†ï¼ˆsetState vs GetXï¼‰</h3>
<p>åŸç”Ÿ setStateï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-built_in">int</span> counter = <span class="hljs-number">0</span>;
setState(() =&gt; counter++);
</code></pre>
<p>GetX å“åº”å¼ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CounterController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">GetxController</span> </span>{
  <span class="hljs-keyword">final</span> RxInt count = <span class="hljs-number">0.</span>obs;
  <span class="hljs-keyword">void</span> increment() =&gt; count.value++;
}
<span class="hljs-comment">// ä½¿ç”¨ï¼šfinal c = Get.put(CounterController());</span>
<span class="hljs-comment">// Obx(() =&gt; Text('${c.count.value}'));</span>
</code></pre>
<hr/>
<h3 data-id="heading-15">9. å¼¹çª—ä¸ BottomSheet</h3>
<pre><code class="hljs language-dart" lang="dart">showDialog(
  context: context,
  builder: (_) =&gt; AlertDialog(
    title: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'æç¤º'</span>),
    content: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'ç¡®å®šå—ï¼Ÿ'</span>),
    actions: [
      TextButton(onPressed: () =&gt; Navigator.pop(context), child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'å–æ¶ˆ'</span>)),
      TextButton(onPressed: () {}, child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'ç¡®å®š'</span>)),
    ],
  ),
);
</code></pre>
<pre><code class="hljs language-dart" lang="dart">showModalBottomSheet(
  context: context,
  builder: (_) =&gt; SizedBox(
    height: <span class="hljs-number">240</span>,
    child: <span class="hljs-keyword">const</span> Center(child: Text(<span class="hljs-string">'BottomSheet'</span>)),
  ),
);
</code></pre>
<hr/>
<h3 data-id="heading-16">10. é€‚é…ä¸ä¸»é¢˜</h3>
<p>å±å¹•é€‚é…ï¼ˆflutter_screenutilï¼‰ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// å…¥å£å¤„åˆå§‹åŒ– ScreenUtilï¼Œç„¶åä½¿ç”¨ 12.w/12.h/12.sp ç­‰</span>
</code></pre>
<p>MediaQueryï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">final</span> Size size = MediaQuery.of(context).size; <span class="hljs-comment">// å±å¹•å°ºå¯¸</span>
</code></pre>
<p>ä¸»é¢˜ï¼š</p>
<pre><code class="hljs language-dart" lang="dart">ThemeData(
  colorScheme: ColorScheme.fromSeed(seedColor: Colors.blue),
  useMaterial3: <span class="hljs-keyword">true</span>,
)
</code></pre>
<hr/>
<h3 data-id="heading-17">11. ç½‘ç»œï¼ˆDio ç®€ä¾‹ï¼‰</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">final</span> dio = Dio(BaseOptions(baseUrl: <span class="hljs-string">'https://httpbin.org'</span>));
<span class="hljs-keyword">final</span> resp = <span class="hljs-keyword">await</span> dio.<span class="hljs-keyword">get</span>(<span class="hljs-string">'/get'</span>);
</code></pre>
<p>é¡¹ç›®å†…è¯·ä¼˜å…ˆä½¿ç”¨ Retrofit + Service å±‚å°è£…ï¼ˆå‚è€ƒç°æœ‰ <code>lib/src/services/**</code>ï¼‰ã€‚</p>
<hr/>
<h3 data-id="heading-18">12. å¼€å‘æ•ˆç‡æç¤º</h3>
<ul>
<li>çƒ­é‡è½½ï¼šä¿å­˜æ–‡ä»¶å³å¯çƒ­é‡è½½ï¼ˆå°½é‡ä½¿ç”¨ const æ„é€ å‡å°‘é‡å»ºï¼‰ã€‚</li>
<li>ç»“æ„æ‹†åˆ†ï¼šå¤§ç»„ä»¶æ‹†å°ç»„ä»¶ï¼Œé¿å…æ·±åº¦åµŒå¥—ã€‚</li>
<li>ä»£ç ç”Ÿæˆï¼šæ¶‰åŠæ•°æ®æ¨¡å‹/æ¥å£ï¼Œè®°å¾—è¿è¡Œ
<ul>
<li><code>fvm flutter pub run build_runner build --delete-conflicting-outputs</code></li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-19">13. å¸¸è§å‘</h3>
<ul>
<li>setState ä¸ Obx æ··ç”¨ï¼šå°½é‡è®©æŸå— UI åªç›‘å¬ä¸€ç§çŠ¶æ€æ¥æºï¼Œé¿å…é‡å¤ rebuildã€‚</li>
<li>showModalBottomSheet é«˜åº¦ï¼šé»˜è®¤æŒ‰å†…å®¹é«˜åº¦ï¼Œæƒ³è¿‘å…¨å±éœ€ <code>isScrollControlled: true</code> + æŒ‡å®šé«˜åº¦ã€‚</li>
<li>iOS è·‘ä¸èµ·æ¥ï¼ˆScheme/Flavorï¼‰ï¼šéœ€æŒ‡å®š <code>--flavor</code> ä¸ Xcode çš„ Scheme å¯¹åº”ã€‚</li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java å°è£…ï¼ˆEncapsulationï¼‰æŒ‡å—]]></title>    <link>https://juejin.cn/post/7578820431039250472</link>    <guid>https://juejin.cn/post/7578820431039250472</guid>    <pubDate>2025-12-02T02:38:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578820431039250472" data-draft-id="7578777952726745122" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java å°è£…ï¼ˆEncapsulationï¼‰æŒ‡å—"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-02T02:38:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å‘¨åœ¨æˆé•¿"/> <meta itemprop="url" content="https://juejin.cn/user/3632442150752573"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java å°è£…ï¼ˆEncapsulationï¼‰æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3632442150752573/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å‘¨åœ¨æˆé•¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T02:38:38.000Z" title="Tue Dec 02 2025 02:38:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ“– å°è£…çš„åŸºæœ¬æ¦‚å¿µ</h2>
<h3 data-id="heading-1"><strong>ä»€ä¹ˆæ˜¯å°è£…ï¼Ÿ</strong></h3>
<p>å°è£…æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„<strong>å››å¤§ç‰¹æ€§</strong>ä¹‹ä¸€ï¼Œå®ƒå°†æ•°æ®ï¼ˆå±æ€§ï¼‰å’Œæ“ä½œæ•°æ®çš„æ–¹æ³•ï¼ˆè¡Œä¸ºï¼‰åŒ…è£…åœ¨ä¸€èµ·ï¼Œå¹¶<strong>éšè—å†…éƒ¨å®ç°ç»†èŠ‚</strong>ï¼Œåªæš´éœ²å¿…è¦çš„æ¥å£ã€‚</p>
<h3 data-id="heading-2"><strong>å°è£…çš„æ ¸å¿ƒæ€æƒ³</strong></h3>
<ul>
<li><strong>éšè—å®ç°</strong>ï¼šå¯¹å¤–éšè—å†…éƒ¨å®ç°ç»†èŠ‚</li>
<li><strong>æš´éœ²æ¥å£</strong>ï¼šæä¾›å…¬å…±æ–¹æ³•æ¥è®¿é—®å’Œä¿®æ”¹æ•°æ®</li>
<li><strong>æ•°æ®ä¿æŠ¤</strong>ï¼šé˜²æ­¢å¤–éƒ¨ç›´æ¥è®¿é—®å’Œä¿®æ”¹å†…éƒ¨æ•°æ®</li>
</ul>
<h2 data-id="heading-3">ğŸ¯ å°è£…çš„å¥½å¤„</h2>
<p>java</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// âŒ æ²¡æœ‰å°è£…çš„é—®é¢˜</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BadDesign</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-type">String</span> name;      <span class="hljs-comment">// ç›´æ¥æš´éœ²å±æ€§</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> age;         <span class="hljs-comment">// å¤–éƒ¨å¯ä»¥ç›´æ¥ä¿®æ”¹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> salary;   <span class="hljs-comment">// æ²¡æœ‰éªŒè¯é€»è¾‘</span>
}

<span class="hljs-comment">// âœ… ä½¿ç”¨å°è£…çš„å¥½å¤„</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GoodDesign</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> name;     <span class="hljs-comment">// ç§æœ‰å±æ€§ï¼Œéšè—å®ç°</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;        <span class="hljs-comment">// åªèƒ½é€šè¿‡æ–¹æ³•è®¿é—®</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> salary;  <span class="hljs-comment">// å¯ä»¥æ·»åŠ éªŒè¯é€»è¾‘</span>
    
    <span class="hljs-comment">// æä¾›å…¬å…±çš„è®¿é—®æ–¹æ³•ï¼ˆgetterï¼‰</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> name;
    }
    
    <span class="hljs-comment">// æä¾›å…¬å…±çš„ä¿®æ”¹æ–¹æ³•ï¼ˆsetterï¼‰</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(<span class="hljs-type">String</span> name)</span> </span>{
        <span class="hljs-comment">// å¯ä»¥æ·»åŠ éªŒè¯é€»è¾‘</span>
        <span class="hljs-keyword">if</span> (name != null &amp;&amp; !name.<span class="hljs-built_in">trim</span>().<span class="hljs-built_in">isEmpty</span>()) {
            <span class="hljs-keyword">this</span>.name = name;
        }
    }
}
</code></pre>
<h2 data-id="heading-4">ğŸ”’ è®¿é—®ä¿®é¥°ç¬¦ï¼ˆAccess Modifiersï¼‰</h2>
<h3 data-id="heading-5"><strong>å››ç§è®¿é—®çº§åˆ«</strong></h3>













































<table><thead><tr><th>ä¿®é¥°ç¬¦</th><th>åŒç±»</th><th>åŒåŒ…</th><th>å­ç±»</th><th>ä¸åŒåŒ…</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>private</strong></td><td>âœ…</td><td>âŒ</td><td>âŒ</td><td>âŒ</td><td>ä»…æœ¬ç±»å¯è§</td></tr><tr><td><strong>é»˜è®¤</strong></td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>âŒ</td><td>åŒåŒ…å¯è§</td></tr><tr><td><strong>protected</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âŒ</td><td>åŒåŒ…æˆ–å­ç±»å¯è§</td></tr><tr><td><strong>public</strong></td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>æ‰€æœ‰ç±»å¯è§</td></tr></tbody></table>
<h3 data-id="heading-6"><strong>è®¿é—®ä¿®é¥°ç¬¦ç¤ºä¾‹</strong></h3>
<p>java</p>
<pre><code class="hljs language-csharp" lang="csharp">package com.example;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AccessDemo</span> {
    <span class="hljs-comment">// 1. private - ä»…æœ¬ç±»å¯è§</span>
    <span class="hljs-keyword">private</span> String privateField = <span class="hljs-string">"ç§æœ‰å­—æ®µ"</span>;
    
    <span class="hljs-comment">// 2. é»˜è®¤ï¼ˆåŒ…ç§æœ‰ï¼‰- åŒåŒ…å¯è§</span>
    String defaultField = <span class="hljs-string">"é»˜è®¤å­—æ®µ"</span>;
    
    <span class="hljs-comment">// 3. protected - åŒåŒ…æˆ–å­ç±»å¯è§</span>
    <span class="hljs-keyword">protected</span> String protectedField = <span class="hljs-string">"å—ä¿æŠ¤å­—æ®µ"</span>;
    
    <span class="hljs-comment">// 4. public - æ‰€æœ‰åœ°æ–¹å¯è§</span>
    <span class="hljs-keyword">public</span> String publicField = <span class="hljs-string">"å…¬å…±å­—æ®µ"</span>;
    
    <span class="hljs-comment">// è®¿é—®ç§æœ‰å­—æ®µçš„æ–¹æ³•</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getPrivateField</span>()</span> {
        <span class="hljs-keyword">return</span> privateField;  <span class="hljs-comment">// æœ¬ç±»ä¸­å¯ä»¥è®¿é—®private</span>
    }
    
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">privateMethod</span>()</span> {
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ç§æœ‰æ–¹æ³•"</span>);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testAccess</span>()</span> {
        <span class="hljs-comment">// æ‰€æœ‰è®¿é—®çº§åˆ«åœ¨æœ¬ç±»ä¸­éƒ½å¯è§</span>
        System.<span class="hljs-keyword">out</span>.println(privateField);
        System.<span class="hljs-keyword">out</span>.println(defaultField);
        System.<span class="hljs-keyword">out</span>.println(protectedField);
        System.<span class="hljs-keyword">out</span>.println(publicField);
        privateMethod();
    }
}

<span class="hljs-comment">// åŒåŒ…ä¸­çš„å¦ä¸€ä¸ªç±»</span>
package com.example;

<span class="hljs-keyword">class</span> <span class="hljs-title">SamePackageClass</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span>()</span> {
        AccessDemo demo = <span class="hljs-keyword">new</span> AccessDemo();
        
        <span class="hljs-comment">// System.out.println(demo.privateField);  // âŒ é”™è¯¯ï¼šä¸å¯è®¿é—®</span>
        System.<span class="hljs-keyword">out</span>.println(demo.defaultField);      <span class="hljs-comment">// âœ… å¯ä»¥ï¼šåŒåŒ…</span>
        System.<span class="hljs-keyword">out</span>.println(demo.protectedField);    <span class="hljs-comment">// âœ… å¯ä»¥ï¼šåŒåŒ…</span>
        System.<span class="hljs-keyword">out</span>.println(demo.publicField);       <span class="hljs-comment">// âœ… å¯ä»¥ï¼šå…¬å…±</span>
    }
}

<span class="hljs-comment">// ä¸åŒåŒ…ä¸­çš„ç±»</span>
package other;

import com.example.AccessDemo;

<span class="hljs-keyword">class</span> <span class="hljs-title">DifferentPackageClass</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span>()</span> {
        AccessDemo demo = <span class="hljs-keyword">new</span> AccessDemo();
        
        <span class="hljs-comment">// System.out.println(demo.privateField);   // âŒ é”™è¯¯</span>
        <span class="hljs-comment">// System.out.println(demo.defaultField);   // âŒ é”™è¯¯ï¼šä¸åŒåŒ…</span>
        <span class="hljs-comment">// System.out.println(demo.protectedField); // âŒ é”™è¯¯ï¼šä¸åŒåŒ…éå­ç±»</span>
        System.<span class="hljs-keyword">out</span>.println(demo.publicField);        <span class="hljs-comment">// âœ… å¯ä»¥ï¼šå…¬å…±</span>
        
        <span class="hljs-comment">// é€šè¿‡å…¬å…±æ–¹æ³•è®¿é—®ç§æœ‰å­—æ®µ</span>
        System.<span class="hljs-keyword">out</span>.println(demo.getPrivateField());  <span class="hljs-comment">// âœ… å¯ä»¥</span>
    }
}

<span class="hljs-comment">// ä¸åŒåŒ…ä¸­çš„å­ç±»</span>
package other;

import com.example.AccessDemo;

<span class="hljs-keyword">class</span> <span class="hljs-title">SubClass</span> <span class="hljs-title">extends</span> <span class="hljs-title">AccessDemo</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span>()</span> {
        <span class="hljs-comment">// System.out.println(privateField);   // âŒ é”™è¯¯</span>
        <span class="hljs-comment">// System.out.println(defaultField);   // âŒ é”™è¯¯ï¼šä¸åŒåŒ…</span>
        System.<span class="hljs-keyword">out</span>.println(protectedField);   <span class="hljs-comment">// âœ… å¯ä»¥ï¼šå­ç±»</span>
        System.<span class="hljs-keyword">out</span>.println(publicField);      <span class="hljs-comment">// âœ… å¯ä»¥ï¼šå…¬å…±</span>
        
        <span class="hljs-comment">// é€šè¿‡ç»§æ‰¿çš„æ–¹æ³•è®¿é—®</span>
        System.<span class="hljs-keyword">out</span>.println(getPrivateField()); <span class="hljs-comment">// âœ… å¯ä»¥</span>
    }
}
</code></pre>
<h2 data-id="heading-7">ğŸ› ï¸ Getter å’Œ Setter æ–¹æ³•</h2>
<h3 data-id="heading-8"><strong>æ ‡å‡†Getter/Setteræ¨¡å¼</strong></h3>
<p>java</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> {
    <span class="hljs-comment">// ç§æœ‰å­—æ®µ</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> name;
    <span class="hljs-keyword">private</span> int age;
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> studentId;
    <span class="hljs-keyword">private</span> double gpa;
    
    <span class="hljs-comment">// 1. Getteræ–¹æ³•ï¼šè·å–å­—æ®µå€¼</span>
    <span class="hljs-comment">// å‘½åè§„èŒƒï¼šget + å­—æ®µåï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getName</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> name;
    }
    
    <span class="hljs-keyword">public</span> int <span class="hljs-title function_">getAge</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> age;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getStudentId</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> studentId;
    }
    
    <span class="hljs-keyword">public</span> double <span class="hljs-title function_">getGpa</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> gpa;
    }
    
    <span class="hljs-comment">// 2. Setteræ–¹æ³•ï¼šè®¾ç½®å­—æ®µå€¼</span>
    <span class="hljs-comment">// å‘½åè§„èŒƒï¼šset + å­—æ®µåï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setName</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> name</span>) {
        <span class="hljs-comment">// å¯ä»¥æ·»åŠ éªŒè¯é€»è¾‘</span>
        <span class="hljs-keyword">if</span> (name != <span class="hljs-literal">null</span> &amp;&amp; name.<span class="hljs-title function_">length</span>() &gt;= <span class="hljs-number">2</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å§“åæ— æ•ˆ"</span>);
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setAge</span>(<span class="hljs-params">int age</span>) {
        <span class="hljs-comment">// éªŒè¯å¹´é¾„èŒƒå›´</span>
        <span class="hljs-keyword">if</span> (age &gt;= <span class="hljs-number">0</span> &amp;&amp; age &lt;= <span class="hljs-number">150</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å¹´é¾„å¿…é¡»åœ¨0-150ä¹‹é—´"</span>);
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setStudentId</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> studentId</span>) {
        <span class="hljs-comment">// éªŒè¯å­¦å·æ ¼å¼</span>
        <span class="hljs-keyword">if</span> (studentId != <span class="hljs-literal">null</span> &amp;&amp; studentId.<span class="hljs-title function_">matches</span>(<span class="hljs-string">"\d{10}"</span>)) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">studentId</span> = studentId;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å­¦å·å¿…é¡»æ˜¯10ä½æ•°å­—"</span>);
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setGpa</span>(<span class="hljs-params">double gpa</span>) {
        <span class="hljs-comment">// éªŒè¯GPAèŒƒå›´</span>
        <span class="hljs-keyword">if</span> (gpa &gt;= <span class="hljs-number">0.0</span> &amp;&amp; gpa &lt;= <span class="hljs-number">4.0</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">gpa</span> = gpa;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"GPAå¿…é¡»åœ¨0.0-4.0ä¹‹é—´"</span>);
        }
    }
    
    <span class="hljs-comment">// 3. åªè¯»å­—æ®µï¼ˆåªæœ‰getterï¼Œæ²¡æœ‰setterï¼‰</span>
    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">String</span> createdAt = java.<span class="hljs-property">time</span>.<span class="hljs-property">LocalDate</span>.<span class="hljs-title function_">now</span>().<span class="hljs-title function_">toString</span>();
    
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getCreatedAt</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> createdAt;
    }
    
    <span class="hljs-comment">// 4. åªå†™å­—æ®µï¼ˆä¸æ¨èï¼Œä½†æœ‰ç‰¹æ®Šç”¨é€”ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> password;
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setPassword</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> password</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">password</span> = password;
    }
    
    <span class="hljs-comment">// 5. å¸ƒå°”ç±»å‹çš„Getterè§„èŒƒ</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">boolean</span> graduated;
    
    <span class="hljs-comment">// å¸ƒå°”ç±»å‹ä½¿ç”¨iså‰ç¼€</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">isGraduated</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> graduated;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setGraduated</span>(<span class="hljs-params"><span class="hljs-built_in">boolean</span> graduated</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">graduated</span> = graduated;
    }
    
    <span class="hljs-comment">// æ˜¾ç¤ºå­¦ç”Ÿä¿¡æ¯</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">displayInfo</span>(<span class="hljs-params"/>) {
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å­¦ç”Ÿä¿¡æ¯:"</span>);
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å§“å: "</span> + name);
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å¹´é¾„: "</span> + age);
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å­¦å·: "</span> + studentId);
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"GPA: "</span> + gpa);
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"åˆ›å»ºæ—¶é—´: "</span> + createdAt);
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"æ˜¯å¦æ¯•ä¸š: "</span> + graduated);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[] args</span>) {
        <span class="hljs-title class_">Student</span> student = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>();
        
        <span class="hljs-comment">// ä½¿ç”¨setterè®¾ç½®å€¼ï¼ˆæœ‰éªŒè¯ï¼‰</span>
        student.<span class="hljs-title function_">setName</span>(<span class="hljs-string">"å¼ ä¸‰"</span>);
        student.<span class="hljs-title function_">setAge</span>(<span class="hljs-number">20</span>);
        student.<span class="hljs-title function_">setStudentId</span>(<span class="hljs-string">"2023000001"</span>);
        student.<span class="hljs-title function_">setGpa</span>(<span class="hljs-number">3.8</span>);
        student.<span class="hljs-title function_">setGraduated</span>(<span class="hljs-literal">false</span>);
        
        <span class="hljs-comment">// ä½¿ç”¨getterè·å–å€¼</span>
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å­¦ç”Ÿå§“å: "</span> + student.<span class="hljs-title function_">getName</span>());
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å­¦ç”Ÿå¹´é¾„: "</span> + student.<span class="hljs-title function_">getAge</span>());
        
        <span class="hljs-comment">// æµ‹è¯•æ— æ•ˆè¾“å…¥</span>
        student.<span class="hljs-title function_">setAge</span>(<span class="hljs-number">200</span>);  <span class="hljs-comment">// ä¼šè¾“å‡ºé”™è¯¯ä¿¡æ¯</span>
        student.<span class="hljs-title function_">setGpa</span>(<span class="hljs-number">5.0</span>);  <span class="hljs-comment">// ä¼šè¾“å‡ºé”™è¯¯ä¿¡æ¯</span>
        
        student.<span class="hljs-title function_">displayInfo</span>();
    }
}
</code></pre>
<h3 data-id="heading-9"><strong>é«˜çº§Getter/SetteræŠ€å·§</strong></h3>
<p>java</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.Collections;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AdvancedGetterSetter</span> {
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> List&lt;String&gt; hobbies;  <span class="hljs-comment">// å¯å˜å¯¹è±¡</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] scores;          <span class="hljs-comment">// æ•°ç»„</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String id;       <span class="hljs-comment">// finalå­—æ®µ</span>
    
    <span class="hljs-comment">// æ„é€ å™¨åˆå§‹åŒ–finalå­—æ®µ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">AdvancedGetterSetter</span><span class="hljs-params">(String id)</span> {
        <span class="hljs-built_in">this</span>.id = id;
        <span class="hljs-built_in">this</span>.hobbies = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-built_in">this</span>.scores = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">3</span>];
    }
    
    <span class="hljs-comment">// 1. è¿”å›ä¸å¯ä¿®æ”¹çš„é›†åˆï¼ˆé˜²å¾¡æ€§ç¼–ç¨‹ï¼‰</span>
    <span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title function_">getHobbies</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è¿”å›å‰¯æœ¬ï¼Œé˜²æ­¢å¤–éƒ¨ä¿®æ”¹å†…éƒ¨æ•°æ®</span>
        <span class="hljs-keyword">return</span> Collections.unmodifiableList(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(hobbies));
        
        <span class="hljs-comment">// æˆ–è€…è¿”å›åªè¯»è§†å›¾</span>
        <span class="hljs-comment">// return Collections.unmodifiableList(hobbies);</span>
    }
    
    <span class="hljs-comment">// 2. æ§åˆ¶é›†åˆçš„ä¿®æ”¹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addHobby</span><span class="hljs-params">(String hobby)</span> {
        <span class="hljs-keyword">if</span> (hobby != <span class="hljs-literal">null</span> &amp;&amp; !hobby.trim().isEmpty()) {
            <span class="hljs-built_in">this</span>.hobbies.add(hobby);
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeHobby</span><span class="hljs-params">(String hobby)</span> {
        <span class="hljs-built_in">this</span>.hobbies.remove(hobby);
    }
    
    <span class="hljs-comment">// 3. æ•°ç»„çš„Getter/Setter</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] getScores() {
        <span class="hljs-comment">// è¿”å›æ•°ç»„çš„å‰¯æœ¬</span>
        <span class="hljs-keyword">return</span> scores.clone();
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setScores</span><span class="hljs-params">(<span class="hljs-type">int</span>[] scores)</span> {
        <span class="hljs-comment">// å¤åˆ¶æ•°ç»„ï¼Œè€Œä¸æ˜¯ç›´æ¥å¼•ç”¨</span>
        System.arraycopy(scores, <span class="hljs-number">0</span>, <span class="hljs-built_in">this</span>.scores, <span class="hljs-number">0</span>, 
                        Math.min(scores.length, <span class="hljs-built_in">this</span>.scores.length));
    }
    
    <span class="hljs-comment">// 4. åªè¯»çš„finalå­—æ®µ</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> id;
    }
    
    <span class="hljs-comment">// 5. è®¡ç®—æ€§å±æ€§ï¼ˆæ²¡æœ‰å¯¹åº”çš„å­—æ®µï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getAverageScore</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (scores.length == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0.0</span>;
        
        <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> score : scores) {
            sum += score;
        }
        <span class="hljs-keyword">return</span> (<span class="hljs-type">double</span>) sum / scores.length;
    }
    
    <span class="hljs-comment">// 6. é“¾å¼Setterï¼ˆè¿”å›thisï¼‰</span>
    <span class="hljs-keyword">public</span> AdvancedGetterSetter <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
    }
    
    <span class="hljs-comment">// 7. Builderæ¨¡å¼ç»“åˆ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Builder</span> {
        <span class="hljs-keyword">private</span> String id;
        <span class="hljs-keyword">private</span> String name;
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">Builder</span><span class="hljs-params">(String id)</span> {
            <span class="hljs-built_in">this</span>.id = id;
        }
        
        <span class="hljs-keyword">public</span> Builder <span class="hljs-title function_">name</span><span class="hljs-params">(String name)</span> {
            <span class="hljs-built_in">this</span>.name = name;
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
        }
        
        <span class="hljs-keyword">public</span> AdvancedGetterSetter <span class="hljs-title function_">build</span><span class="hljs-params">()</span> {
            <span class="hljs-type">AdvancedGetterSetter</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AdvancedGetterSetter</span>(id);
            obj.name = name;
            <span class="hljs-keyword">return</span> obj;
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">AdvancedGetterSetter</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AdvancedGetterSetter</span>(<span class="hljs-string">"001"</span>);
        
        <span class="hljs-comment">// æµ‹è¯•é›†åˆä¿æŠ¤</span>
        obj.addHobby(<span class="hljs-string">"ç¯®çƒ"</span>);
        obj.addHobby(<span class="hljs-string">"éŸ³ä¹"</span>);
        
        List&lt;String&gt; hobbies = obj.getHobbies();
        System.out.println(<span class="hljs-string">"çˆ±å¥½: "</span> + hobbies);
        
        <span class="hljs-comment">// hobbies.add("æ¸¸æ³³");  // âŒ è¿è¡Œæ—¶å¼‚å¸¸ï¼šUnsupportedOperationException</span>
        
        <span class="hljs-comment">// æµ‹è¯•æ•°ç»„ä¿æŠ¤</span>
        <span class="hljs-type">int</span>[] testScores = {<span class="hljs-number">90</span>, <span class="hljs-number">85</span>, <span class="hljs-number">95</span>};
        obj.setScores(testScores);
        
        <span class="hljs-type">int</span>[] scores = obj.getScores();
        scores[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;  <span class="hljs-comment">// ä¿®æ”¹çš„æ˜¯å‰¯æœ¬ï¼Œä¸å½±å“åŸæ•°ç»„</span>
        
        System.out.println(<span class="hljs-string">"å¹³å‡åˆ†: "</span> + obj.getAverageScore());
        
        <span class="hljs-comment">// é“¾å¼è°ƒç”¨</span>
        <span class="hljs-type">AdvancedGetterSetter</span> <span class="hljs-variable">obj2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AdvancedGetterSetter</span>(<span class="hljs-string">"002"</span>)
            .setName(<span class="hljs-string">"æå››"</span>);
    }
}
</code></pre>
<h2 data-id="heading-10">ğŸ—ï¸ å°è£…çš„å®é™…åº”ç”¨</h2>
<h3 data-id="heading-11"><strong>ç¤ºä¾‹1ï¼šé“¶è¡Œè´¦æˆ·ç±»</strong></h3>
<p>java</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BankAccount</span> {
    <span class="hljs-comment">// ç§æœ‰å­—æ®µ</span>
    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">String</span> accountNumber;  <span class="hljs-comment">// è´¦å·ä¸å¯å˜</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> accountHolder;        <span class="hljs-comment">// æˆ·ä¸»å§“å</span>
    <span class="hljs-keyword">private</span> double balance;              <span class="hljs-comment">// ä½™é¢</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> password;             <span class="hljs-comment">// å¯†ç ï¼ˆä¸æä¾›getterï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">boolean</span> isActive;            <span class="hljs-comment">// è´¦æˆ·çŠ¶æ€</span>
    
    <span class="hljs-comment">// æ„é€ å™¨</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">BankAccount</span>(<span class="hljs-title class_">String</span> accountNumber, <span class="hljs-title class_">String</span> accountHolder, 
                      <span class="hljs-title class_">String</span> password, double initialDeposit) {
        <span class="hljs-comment">// å‚æ•°éªŒè¯</span>
        <span class="hljs-title function_">validateAccountNumber</span>(accountNumber);
        <span class="hljs-title function_">validateAccountHolder</span>(accountHolder);
        <span class="hljs-title function_">validatePassword</span>(password);
        <span class="hljs-title function_">validateInitialDeposit</span>(initialDeposit);
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">accountNumber</span> = accountNumber;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">accountHolder</span> = accountHolder;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">password</span> = password;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">balance</span> = initialDeposit;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isActive</span> = <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-comment">// ç§æœ‰éªŒè¯æ–¹æ³•</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">validateAccountNumber</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> accountNumber</span>) {
        <span class="hljs-keyword">if</span> (accountNumber == <span class="hljs-literal">null</span> || !accountNumber.<span class="hljs-title function_">matches</span>(<span class="hljs-string">"\d{16}"</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"è´¦å·å¿…é¡»æ˜¯16ä½æ•°å­—"</span>);
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">validateAccountHolder</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> accountHolder</span>) {
        <span class="hljs-keyword">if</span> (accountHolder == <span class="hljs-literal">null</span> || accountHolder.<span class="hljs-title function_">trim</span>().<span class="hljs-title function_">isEmpty</span>()) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"æˆ·ä¸»å§“åä¸èƒ½ä¸ºç©º"</span>);
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">validatePassword</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> password</span>) {
        <span class="hljs-keyword">if</span> (password == <span class="hljs-literal">null</span> || password.<span class="hljs-title function_">length</span>() &lt; <span class="hljs-number">6</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"å¯†ç è‡³å°‘6ä½"</span>);
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">validateInitialDeposit</span>(<span class="hljs-params">double amount</span>) {
        <span class="hljs-keyword">if</span> (amount &lt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"åˆå§‹å­˜æ¬¾ä¸èƒ½ä¸ºè´Ÿ"</span>);
        }
    }
    
    <span class="hljs-comment">// Getteræ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getAccountNumber</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> accountNumber;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getAccountHolder</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> accountHolder;
    }
    
    <span class="hljs-keyword">public</span> double <span class="hljs-title function_">getBalance</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> balance;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">isActive</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> isActive;
    }
    
    <span class="hljs-comment">// Setteræ–¹æ³•ï¼ˆæœ‰é™åˆ¶ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setAccountHolder</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> accountHolder</span>) {
        <span class="hljs-title function_">validateAccountHolder</span>(accountHolder);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">accountHolder</span> = accountHolder;
    }
    
    <span class="hljs-comment">// ä¸šåŠ¡æ–¹æ³•ï¼ˆå°è£…ä¸šåŠ¡é€»è¾‘ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">deposit</span>(<span class="hljs-params">double amount</span>) {
        <span class="hljs-keyword">if</span> (!isActive) {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"è´¦æˆ·å·²å†»ç»“ï¼Œæ— æ³•å­˜æ¬¾"</span>);
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-keyword">if</span> (amount &lt;= <span class="hljs-number">0</span>) {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å­˜æ¬¾é‡‘é¢å¿…é¡»å¤§äº0"</span>);
            <span class="hljs-keyword">return</span>;
        }
        
        balance += amount;
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">printf</span>(<span class="hljs-string">"å­˜æ¬¾æˆåŠŸï¼å­˜å…¥ï¿¥%.2fï¼Œå½“å‰ä½™é¢ï¿¥%.2f%n"</span>, amount, balance);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">withdraw</span>(<span class="hljs-params">double amount, <span class="hljs-built_in">String</span> password</span>) {
        <span class="hljs-keyword">if</span> (!isActive) {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"è´¦æˆ·å·²å†»ç»“ï¼Œæ— æ³•å–æ¬¾"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        
        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">authenticate</span>(password)) {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å¯†ç é”™è¯¯"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        
        <span class="hljs-keyword">if</span> (amount &lt;= <span class="hljs-number">0</span>) {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å–æ¬¾é‡‘é¢å¿…é¡»å¤§äº0"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        
        <span class="hljs-keyword">if</span> (amount &gt; balance) {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"ä½™é¢ä¸è¶³"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        
        balance -= amount;
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">printf</span>(<span class="hljs-string">"å–æ¬¾æˆåŠŸï¼å–å‡ºï¿¥%.2fï¼Œå½“å‰ä½™é¢ï¿¥%.2f%n"</span>, amount, balance);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">transfer</span>(<span class="hljs-params">BankAccount target, double amount, <span class="hljs-built_in">String</span> password</span>) {
        <span class="hljs-keyword">if</span> (!isActive || !target.<span class="hljs-property">isActive</span>) {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"è´¦æˆ·çŠ¶æ€å¼‚å¸¸ï¼Œæ— æ³•è½¬è´¦"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        
        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">authenticate</span>(password)) {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å¯†ç é”™è¯¯"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">withdraw</span>(amount, password)) {
            target.<span class="hljs-title function_">deposit</span>(amount);
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">printf</span>(<span class="hljs-string">"å‘%sè½¬è´¦ï¿¥%.2fæˆåŠŸ%n"</span>, 
                            target.<span class="hljs-title function_">getAccountHolder</span>(), amount);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// ç§æœ‰è¾…åŠ©æ–¹æ³•</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">authenticate</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> password</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">password</span>.<span class="hljs-title function_">equals</span>(password);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">changePassword</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> oldPassword, <span class="hljs-built_in">String</span> newPassword</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">authenticate</span>(oldPassword)) {
            <span class="hljs-title function_">validatePassword</span>(newPassword);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">password</span> = newPassword;
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å¯†ç ä¿®æ”¹æˆåŠŸ"</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"åŸå¯†ç é”™è¯¯"</span>);
        }
    }
    
    <span class="hljs-comment">// è´¦æˆ·ç®¡ç†æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">activate</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isActive</span> = <span class="hljs-literal">true</span>;
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"è´¦æˆ·å·²æ¿€æ´»"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">deactivate</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isActive</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"è´¦æˆ·å·²å†»ç»“"</span>);
    }
    
    <span class="hljs-comment">// æ˜¾ç¤ºè´¦æˆ·ä¿¡æ¯ï¼ˆéšè—æ•æ„Ÿä¿¡æ¯ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">displayAccountInfo</span>(<span class="hljs-params"/>) {
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"\n=== è´¦æˆ·ä¿¡æ¯ ==="</span>);
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"è´¦å·: "</span> + accountNumber);
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"æˆ·ä¸»: "</span> + accountHolder);
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">printf</span>(<span class="hljs-string">"ä½™é¢: ï¿¥%.2f%n"</span>, balance);
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"çŠ¶æ€: "</span> + (isActive ? <span class="hljs-string">"æ­£å¸¸"</span> : <span class="hljs-string">"å†»ç»“"</span>));
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"================\n"</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[] args</span>) {
        <span class="hljs-comment">// åˆ›å»ºè´¦æˆ·</span>
        <span class="hljs-title class_">BankAccount</span> account1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BankAccount</span>(
            <span class="hljs-string">"6228480012345678"</span>, 
            <span class="hljs-string">"å¼ ä¸‰"</span>, 
            <span class="hljs-string">"123456"</span>, 
            <span class="hljs-number">1000.00</span>
        );
        
        <span class="hljs-title class_">BankAccount</span> account2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BankAccount</span>(
            <span class="hljs-string">"6228480098765432"</span>,
            <span class="hljs-string">"æå››"</span>,
            <span class="hljs-string">"654321"</span>,
            <span class="hljs-number">500.00</span>
        );
        
        <span class="hljs-comment">// æµ‹è¯•åŠŸèƒ½</span>
        account1.<span class="hljs-title function_">displayAccountInfo</span>();
        
        account1.<span class="hljs-title function_">deposit</span>(<span class="hljs-number">500.00</span>);
        account1.<span class="hljs-title function_">withdraw</span>(<span class="hljs-number">200.00</span>, <span class="hljs-string">"123456"</span>);
        account1.<span class="hljs-title function_">withdraw</span>(<span class="hljs-number">200.00</span>, <span class="hljs-string">"é”™è¯¯å¯†ç "</span>);  <span class="hljs-comment">// å¯†ç é”™è¯¯</span>
        
        account1.<span class="hljs-title function_">transfer</span>(account2, <span class="hljs-number">300.00</span>, <span class="hljs-string">"123456"</span>);
        
        account1.<span class="hljs-title function_">changePassword</span>(<span class="hljs-string">"123456"</span>, <span class="hljs-string">"æ–°å¯†ç "</span>);
        
        account1.<span class="hljs-title function_">deactivate</span>();
        account1.<span class="hljs-title function_">deposit</span>(<span class="hljs-number">100.00</span>);  <span class="hljs-comment">// è´¦æˆ·å†»ç»“ï¼Œæ— æ³•å­˜æ¬¾</span>
    }
}
</code></pre>
<h2 data-id="heading-12">âš ï¸ å°è£…çš„å¸¸è§é”™è¯¯</h2>
<h3 data-id="heading-13"><strong>é”™è¯¯1ï¼šè¿‡åº¦æš´éœ²å†…éƒ¨å®ç°</strong></h3>
<p>java</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// âŒ é”™è¯¯çš„å°è£…</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">BadEncapsulation</span> {
    <span class="hljs-keyword">public</span> List&lt;String&gt; items;  <span class="hljs-comment">// ç›´æ¥æš´éœ²å†…éƒ¨é›†åˆ</span>
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">BadEncapsulation</span>()</span> {
        items = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();
    }
}

<span class="hljs-comment">// ä½¿ç”¨è¿™ä¸ªç±»çš„ä»£ç å¯ä»¥è¿™æ ·åšï¼š</span>
BadEncapsulation bad = <span class="hljs-keyword">new</span> BadEncapsulation();
bad.items.<span class="hljs-keyword">add</span>(<span class="hljs-string">"ç›´æ¥ä¿®æ”¹"</span>);  <span class="hljs-comment">// ç»•è¿‡æ‰€æœ‰éªŒè¯é€»è¾‘</span>
bad.items = <span class="hljs-literal">null</span>;          <span class="hljs-comment">// ç”šè‡³å¯ä»¥ç ´åå†…éƒ¨çŠ¶æ€</span>

<span class="hljs-comment">// âœ… æ­£ç¡®çš„å°è£…</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">GoodEncapsulation</span> {
    <span class="hljs-keyword">private</span> List&lt;String&gt; items;
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">GoodEncapsulation</span>()</span> {
        items = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addItem</span>(<span class="hljs-params">String item</span>)</span> {
        <span class="hljs-keyword">if</span> (item != <span class="hljs-literal">null</span> &amp;&amp; !item.trim().isEmpty()) {
            items.<span class="hljs-keyword">add</span>(item);
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">List</span>&lt;<span class="hljs-title">String</span>&gt; <span class="hljs-title">getItems</span>()</span> {
        <span class="hljs-keyword">return</span> Collections.unmodifiableList(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(items));
    }
}
</code></pre>
<h3 data-id="heading-14"><strong>é”™è¯¯2ï¼šGetter/Setterä¸­çš„é€»è¾‘è¿‡äºå¤æ‚</strong></h3>
<p>java</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ ä¸å¥½çš„åšæ³•ï¼šåœ¨getter/setterä¸­åšå¤ªå¤šäº‹æƒ…</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ComplexGetterSetter</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> data;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getData</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// ä¸åº”è¯¥åœ¨getterä¸­ä¿®æ”¹çŠ¶æ€</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = <span class="hljs-title function_">processData</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>);  <span class="hljs-comment">// âŒ å‰¯ä½œç”¨</span>
        <span class="hljs-title function_">logAccess</span>();                         <span class="hljs-comment">// âŒ å‰¯ä½œç”¨</span>
        <span class="hljs-keyword">return</span> data;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setData</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> data</span>) {
        <span class="hljs-comment">// setteråº”è¯¥åªåšéªŒè¯å’Œèµ‹å€¼</span>
        <span class="hljs-title function_">validateData</span>(data);                 <span class="hljs-comment">// âœ… å¯ä»¥</span>
        <span class="hljs-title function_">logModification</span>();                  <span class="hljs-comment">// âš ï¸ å°å¿ƒï¼šå¯èƒ½æœ‰å‰¯ä½œç”¨</span>
        <span class="hljs-title function_">sendNotification</span>();                 <span class="hljs-comment">// âŒ ä¸åº”è¯¥</span>
        <span class="hljs-title function_">updateDatabase</span>();                   <span class="hljs-comment">// âŒ ä¸åº”è¯¥</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = data;
    }
}

<span class="hljs-comment">// âœ… å¥½çš„åšæ³•ï¼šä¿æŒç®€å•</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleGetterSetter</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> data;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getData</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> data;  <span class="hljs-comment">// ç®€å•è¿”å›</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setData</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> data</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isValid</span>(data)) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = data;
        }
    }
    
    <span class="hljs-comment">// å¤æ‚çš„ä¸šåŠ¡é€»è¾‘æ”¾åœ¨å•ç‹¬çš„æ–¹æ³•ä¸­</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">updateDataWithNotification</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> data</span>) {
        <span class="hljs-title function_">setData</span>(data);
        <span class="hljs-title function_">sendNotification</span>();
        <span class="hljs-title function_">updateDatabase</span>();
    }
}
</code></pre>
<h2 data-id="heading-15">ğŸ’¡ å°è£…çš„æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-16"><strong>å®è·µ1ï¼šä½¿ç”¨ä¸å¯å˜å¯¹è±¡</strong></h3>
<p>java</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// ä¸å¯å˜ç±»æä¾›æ›´å¥½çš„å°è£…</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ImmutablePerson</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> name;      <span class="hljs-comment">// finalå­—æ®µ</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> age;          <span class="hljs-comment">// finalå­—æ®µ</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;<span class="hljs-type">String</span>&gt; hobbies;  <span class="hljs-comment">// å¼•ç”¨ä¸å¯å˜</span>
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ImmutablePerson</span><span class="hljs-params">(<span class="hljs-type">String</span> name, <span class="hljs-type">int</span> age, List&lt;<span class="hljs-type">String</span>&gt; hobbies)</span> </span>{
        <span class="hljs-keyword">this</span>.name = name;
        <span class="hljs-keyword">this</span>.age = age;
        <span class="hljs-comment">// é˜²å¾¡æ€§æ‹·è´</span>
        <span class="hljs-keyword">this</span>.hobbies = Collections.<span class="hljs-built_in">unmodifiableList</span>(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(hobbies));
    }
    
    <span class="hljs-comment">// åªæœ‰getterï¼Œæ²¡æœ‰setter</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> name; }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title">getAge</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> age; }
    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;<span class="hljs-type">String</span>&gt; <span class="hljs-title">getHobbies</span><span class="hljs-params">()</span> </span>{ 
        <span class="hljs-comment">// è¿”å›ä¸å¯ä¿®æ”¹çš„å‰¯æœ¬</span>
        <span class="hljs-keyword">return</span> Collections.<span class="hljs-built_in">unmodifiableList</span>(<span class="hljs-keyword">new</span> ArrayList&lt;&gt;(hobbies));
    }
    
    <span class="hljs-comment">// ä¿®æ”¹æ“ä½œè¿”å›æ–°å¯¹è±¡</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> ImmutablePerson <span class="hljs-title">withName</span><span class="hljs-params">(<span class="hljs-type">String</span> newName)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">ImmutablePerson</span>(newName, age, hobbies);
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> ImmutablePerson <span class="hljs-title">withAge</span><span class="hljs-params">(<span class="hljs-type">int</span> newAge)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">ImmutablePerson</span>(name, newAge, hobbies);
    }
}
</code></pre>
<h3 data-id="heading-17"><strong>å®è·µ2ï¼šä½¿ç”¨Builderæ¨¡å¼</strong></h3>
<p>java</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Config</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> host;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> port;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> timeout;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> sslEnabled;
    
    <span class="hljs-comment">// ç§æœ‰æ„é€ å™¨</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">Config</span><span class="hljs-params">(Builder builder)</span> </span>{
        <span class="hljs-keyword">this</span>.host = builder.host;
        <span class="hljs-keyword">this</span>.port = builder.port;
        <span class="hljs-keyword">this</span>.timeout = builder.timeout;
        <span class="hljs-keyword">this</span>.sslEnabled = builder.sslEnabled;
    }
    
    <span class="hljs-comment">// Getter</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-title">getHost</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> host; }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title">getPort</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> port; }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title">getTimeout</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> timeout; }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title">isSslEnabled</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> sslEnabled; }
    
    <span class="hljs-comment">// Builder</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Builder</span> {
        <span class="hljs-comment">// å¿…å¡«å‚æ•°</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> host;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> port;
        
        <span class="hljs-comment">// å¯é€‰å‚æ•°ï¼ˆé»˜è®¤å€¼ï¼‰</span>
        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> timeout = <span class="hljs-number">5000</span>;
        <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> sslEnabled = <span class="hljs-literal">false</span>;
        
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Builder</span><span class="hljs-params">(<span class="hljs-type">String</span> host, <span class="hljs-type">int</span> port)</span> </span>{
            <span class="hljs-keyword">this</span>.host = host;
            <span class="hljs-keyword">this</span>.port = port;
        }
        
        <span class="hljs-function"><span class="hljs-keyword">public</span> Builder <span class="hljs-title">timeout</span><span class="hljs-params">(<span class="hljs-type">int</span> timeout)</span> </span>{
            <span class="hljs-keyword">this</span>.timeout = timeout;
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        }
        
        <span class="hljs-function"><span class="hljs-keyword">public</span> Builder <span class="hljs-title">sslEnabled</span><span class="hljs-params">(<span class="hljs-type">boolean</span> sslEnabled)</span> </span>{
            <span class="hljs-keyword">this</span>.sslEnabled = sslEnabled;
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        }
        
        <span class="hljs-function"><span class="hljs-keyword">public</span> Config <span class="hljs-title">build</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-comment">// éªŒè¯é€»è¾‘</span>
            <span class="hljs-keyword">if</span> (host == null || host.<span class="hljs-built_in">trim</span>().<span class="hljs-built_in">isEmpty</span>()) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">IllegalArgumentException</span>(<span class="hljs-string">"Hostä¸èƒ½ä¸ºç©º"</span>);
            }
            <span class="hljs-keyword">if</span> (port &lt;= <span class="hljs-number">0</span> || port &gt; <span class="hljs-number">65535</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">IllegalArgumentException</span>(<span class="hljs-string">"ç«¯å£æ— æ•ˆ"</span>);
            }
            <span class="hljs-keyword">if</span> (timeout &lt; <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">IllegalArgumentException</span>(<span class="hljs-string">"è¶…æ—¶æ—¶é—´ä¸èƒ½ä¸ºè´Ÿ"</span>);
            }
            
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Config</span>(<span class="hljs-keyword">this</span>);
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">String</span>[] args)</span> </span>{
        Config config = <span class="hljs-keyword">new</span> Config.<span class="hljs-built_in">Builder</span>(<span class="hljs-string">"localhost"</span>, <span class="hljs-number">8080</span>)
            .<span class="hljs-built_in">timeout</span>(<span class="hljs-number">10000</span>)
            .<span class="hljs-built_in">sslEnabled</span>(<span class="hljs-literal">true</span>)
            .<span class="hljs-built_in">build</span>();
    }
}
</code></pre>
<h3 data-id="heading-18"><strong>å®è·µ3ï¼šä½¿ç”¨æ¥å£è¿›ä¸€æ­¥å°è£…</strong></h3>
<p>java</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ¥å£å®šä¹‰å¥‘çº¦</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserRepository</span> {
    User <span class="hljs-title function_">findById</span><span class="hljs-params">(String id)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">save</span><span class="hljs-params">(User user)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(String id)</span>;
    List&lt;User&gt; <span class="hljs-title function_">findAll</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">// å®ç°ç±»éšè—å®ç°ç»†èŠ‚</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseUserRepository</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserRepository</span> {
    <span class="hljs-keyword">private</span> DataSource dataSource;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">tableName</span> <span class="hljs-operator">=</span> <span class="hljs-string">"users"</span>;
    
    <span class="hljs-comment">// éšè—æ•°æ®åº“è¿æ¥ç»†èŠ‚</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DatabaseUserRepository</span><span class="hljs-params">(DataSource dataSource)</span> {
        <span class="hljs-built_in">this</span>.dataSource = dataSource;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">findById</span><span class="hljs-params">(String id)</span> {
        <span class="hljs-comment">// å¤æ‚çš„æ•°æ®åº“æŸ¥è¯¢é€»è¾‘</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> dataSource.getConnection()) {
            <span class="hljs-comment">// SQLæŸ¥è¯¢...</span>
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();  <span class="hljs-comment">// è¿”å›ç»“æœ</span>
        } <span class="hljs-keyword">catch</span> (SQLException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RepositoryException</span>(<span class="hljs-string">"æŸ¥è¯¢å¤±è´¥"</span>, e);
        }
    }
    
    <span class="hljs-comment">// å…¶ä»–å®ç°...</span>
}

<span class="hljs-comment">// ä½¿ç”¨æ–¹åªå…³å¿ƒæ¥å£</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-keyword">private</span> UserRepository userRepository;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserService</span><span class="hljs-params">(UserRepository userRepository)</span> {
        <span class="hljs-built_in">this</span>.userRepository = userRepository;
    }
    
    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">getUser</span><span class="hljs-params">(String id)</span> {
        <span class="hljs-keyword">return</span> userRepository.findById(id);
    }
}
</code></pre>
<h2 data-id="heading-19">ğŸ“Š å°è£…æ€»ç»“è¡¨</h2>









































<table><thead><tr><th>å°è£…çº§åˆ«</th><th>å®ç°æ–¹å¼</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td><strong>å­—æ®µç§æœ‰åŒ–</strong></td><td>ä½¿ç”¨privateä¿®é¥°å­—æ®µ</td><td>é˜²æ­¢å¤–éƒ¨ç›´æ¥ä¿®æ”¹</td><td>éœ€è¦æä¾›getter/setter</td></tr><tr><td><strong>æ–¹æ³•å…¬æœ‰åŒ–</strong></td><td>é€šè¿‡publicæ–¹æ³•è®¿é—®</td><td>å¯ä»¥æ·»åŠ éªŒè¯é€»è¾‘</td><td>å¯èƒ½æ–¹æ³•è¿‡å¤š</td></tr><tr><td><strong>è¿”å›å‰¯æœ¬</strong></td><td>getterè¿”å›å¯¹è±¡å‰¯æœ¬</td><td>ä¿æŠ¤å†…éƒ¨æ•°æ®</td><td>æ€§èƒ½å¼€é”€</td></tr><tr><td><strong>ä¸å¯å˜å¯¹è±¡</strong></td><td>ä½¿ç”¨finalå­—æ®µ</td><td>çº¿ç¨‹å®‰å…¨ï¼ŒçŠ¶æ€å›ºå®š</td><td>ä¿®æ”¹éœ€è¦åˆ›å»ºæ–°å¯¹è±¡</td></tr><tr><td><strong>æ¥å£å°è£…</strong></td><td>é€šè¿‡æ¥å£æš´éœ²åŠŸèƒ½</td><td>éšè—å®ç°ï¼Œæ˜“äºæ›¿æ¢</td><td>å¢åŠ å¤æ‚åº¦</td></tr></tbody></table>
<h2 data-id="heading-20">ğŸ“ å°è£…åŸåˆ™æ€»ç»“</h2>
<ol>
<li><strong>æœ€å°åŒ–è®¿é—®æƒé™</strong>ï¼šä½¿ç”¨æœ€ä¸¥æ ¼çš„è®¿é—®ä¿®é¥°ç¬¦</li>
<li><strong>æš´éœ²æœ€å°‘æ¥å£</strong>ï¼šåªæä¾›å¿…è¦çš„æ–¹æ³•</li>
<li><strong>é˜²å¾¡æ€§ç¼–ç¨‹</strong>ï¼šéªŒè¯è¾“å…¥ï¼Œè¿”å›å‰¯æœ¬</li>
<li><strong>ä¿æŒç®€å•</strong>ï¼šGetter/Setteråº”è¯¥ç®€å•ç›´æ¥</li>
<li><strong>è€ƒè™‘ä¸å¯å˜æ€§</strong>ï¼šå°½å¯èƒ½ä½¿ç”¨finalå­—æ®µ</li>
<li><strong>ä½¿ç”¨æ¥å£</strong>ï¼šè¿›ä¸€æ­¥éšè—å®ç°ç»†èŠ‚</li>
<li><strong>æ–‡æ¡£åŒ–çº¦æŸ</strong>ï¼šç”¨æ–‡æ¡£è¯´æ˜ä½¿ç”¨é™åˆ¶</li>
</ol>
<p>è®°ä½ï¼š<strong>å°è£…ä¸æ˜¯éšè—å¤æ‚æ€§ï¼Œè€Œæ˜¯ç®¡ç†å¤æ‚æ€§</strong>ã€‚å¥½çš„å°è£…è®©ç±»æ›´æ˜“äºä½¿ç”¨ã€ç»´æŠ¤å’Œæ‰©å±•ï¼ŒåŒæ—¶ä¿æŠ¤å†…éƒ¨çŠ¶æ€ä¸è¢«æ„å¤–ç ´åã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ¬¡è¯·æ±‚ Request failed with status code 400çš„è§£å†³ä¹‹æ—…]]></title>    <link>https://juejin.cn/post/7578803491821322267</link>    <guid>https://juejin.cn/post/7578803491821322267</guid>    <pubDate>2025-12-02T02:27:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578803491821322267" data-draft-id="7578732288516538419" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ¬¡è¯·æ±‚ Request failed with status code 400çš„è§£å†³ä¹‹æ—…"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-02T02:27:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¹¼å„¿å›­çš„æ‰›æŠŠå­"/> <meta itemprop="url" content="https://juejin.cn/user/976022053068199"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ¬¡è¯·æ±‚ Request failed with status code 400çš„è§£å†³ä¹‹æ—…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/976022053068199/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¹¼å„¿å›­çš„æ‰›æŠŠå­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T02:27:22.000Z" title="Tue Dec 02 2025 02:27:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘åœ¨é¡¹ç›®å¼€å‘ä¸­é‡åˆ°ä¸€ä¸ªå¥‡æ€ªçš„é—®é¢˜ï¼Œå°±æ˜¯æŸäº›è¯·æ±‚åœ¨é¦–é¡µæ—¶å‘é€å’Œæ¥æ”¶æ­£å¸¸ï¼Œåœ¨è¯¦æƒ…é¡µä¸­è¯·æ±‚ä¼šæŠ¥400é”™è¯¯ã€‚æ’æŸ¥å‚æ•°ä¿¡æ¯å‘ç°ï¼Œä¸¤è€…ä¼ é€’çš„å‚æ•°ä¸€è‡´ã€‚ç„¶ååˆå¯¹è¯·æ±‚è¿›è¡Œçš„å¯¹æ¯”ï¼Œå‘ç°è¯¦æƒ…é¡µä¸­çš„Refererä¸­åŒ…å«äº†é¡µé¢ä¼ é€’çš„å‚æ•°ä¸­ï¼Œæœ‰"<em>"ã€‚æ­£æ˜¯è¯·æ±‚ä¸­çš„Refereræºå¸¦çš„ "</em>"ï¼Œä¼šå¯¼è‡´è¯·æ±‚æŠ¥ 400ã€‚</p>
<h3 data-id="heading-0">è§£å†³æ€è·¯</h3>
<p>Referer ä¸­åŒ…å« <code>*</code> å¯¼è‡´è¯·æ±‚æŠ¥ 400ï¼ˆBad Requestï¼‰ï¼Œæ ¸å¿ƒåŸå› æ˜¯ <strong><code>*</code></strong> <strong>å±äº HTTP åè®®ä¸­ Referer å¤´çš„éæ³•å­—ç¬¦</strong>ï¼Œæˆ–æœåŠ¡å™¨ç«¯å¯¹ Referer æ ¼å¼åšäº†ä¸¥æ ¼æ ¡éªŒï¼ˆæ¯”å¦‚æ­£åˆ™åŒ¹é…æ‹’ç»å«é€šé…ç¬¦çš„ Refererï¼‰ã€‚</p>
<p>å‘ç°é—®é¢˜åï¼Œç¬¬ä¸€æ—¶é—´æƒ³èµ·ï¼Œæ‰‹åŠ¨ä¿®æ”¹headerä¸­çš„Refererï¼Œ</p>
<pre><code class="hljs language-arduino" lang="arduino">  <span class="hljs-comment">// å¼ºåˆ¶è¦†ç›–æµè§ˆå™¨çš„ referer å‚æ•°</span>
  <span class="hljs-comment">// æ³¨æ„ï¼šæŸäº›æµè§ˆå™¨å¯èƒ½ä¼šå¿½ç•¥æˆ–é™åˆ¶å¯¹ Referer å¤´çš„ä¿®æ”¹</span>
  <span class="hljs-type">const</span> customReferer = location.origin + location.pathname
  <span class="hljs-comment">// eslint-disable-next-line dot-notation</span>
  config.headers[<span class="hljs-string">'Referer'</span>] = customReferer
  <span class="hljs-comment">// eslint-disable-next-line dot-notation</span>
  config.headers[<span class="hljs-string">'referer'</span>] = customReferer
</code></pre>
<p>ä¿®æ”¹åå‘ç°ï¼Œè¯·æ±‚æ˜¯ä¸æŠ¥é”™äº†ï¼Œä½†æ˜¯æ§åˆ¶å°ä¼šæœ‰æ–°çš„æç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce63be70323543caa9aca76e68c95d52~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bm85YS_5Zut55qE5omb5oqK5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765248511&amp;x-signature=OeRr0D1SUyAVE4fntgbwsxzCwt0%3D" alt="error" loading="lazy"/></p>
<p><code>Refused to set unsafe header "Referer"</code> æ˜¯<strong>æµè§ˆå™¨çš„å®‰å…¨é™åˆ¶</strong>å¯¼è‡´çš„ï¼šæ ¹æ® HTTP è§„èŒƒå’Œæµè§ˆå™¨çš„åŒæºç­–ç•¥ / å®‰å…¨æœºåˆ¶ï¼Œ<code>Referer</code> å±äºã€Œå—ä¿æŠ¤çš„è¯·æ±‚å¤´ã€â€”â€” æµè§ˆå™¨ç¦æ­¢å‰ç«¯ JavaScript ä»£ç <strong>æ‰‹åŠ¨ä¿®æ”¹ / è®¾ç½®</strong>è¿™ä¸ªå¤´ï¼Œä»…å…è®¸æµè§ˆå™¨æ ¹æ®å½“å‰é¡µé¢ URL è‡ªåŠ¨ç”Ÿæˆï¼Œç›®çš„æ˜¯é˜²æ­¢æ¶æ„è„šæœ¬ä¼ªé€ æ¥æºåœ°å€ã€‚</p>
<p>äºæ˜¯å†æ¬¡æ›´æ¢æ–¹æ¡ˆï¼Œæ—¢ç„¶æŠ¥é”™çš„åŸå› æ˜¯ç”±äºRefererä¸­æºå¸¦"<em>"å¯¼è‡´ï¼Œé‚£å°±å¯¹"</em>"è¿›è¡Œå¤„ç†ï¼ŒRefereræ˜¯å–å€¼çš„å½“å‰çš„é“¾æ¥åœ°å€ï¼Œé‚£å°±åœ¨è·³è½¬å‰å¯¹å‚æ•°è¿›è¡Œencodeã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-string">`&amp;params=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(<span class="hljs-built_in">JSON</span>.stringify(params))}</span>`</span>
</code></pre>
<p>é—®é¢˜è§£å†³ã€‚</p>
<h3 data-id="heading-1">å…¶ä»–è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-2">1.  æ§åˆ¶ Referer ä¸å‘é€ï¼ˆæœ€ç®€å•ï¼Œå…œåº•æ–¹æ¡ˆï¼‰</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- å®Œå…¨ä¸å‘é€ Referer å¤´ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"referrer"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"no-referrer"</span>&gt;</span>

<span class="hljs-comment">&lt;!-- å¯é€‰ï¼šä»…åŒæºè¯·æ±‚å‘é€ Refererï¼Œè·¨åŸŸä¸å‘é€ï¼ˆæ›´çµæ´»ï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"referrer"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"same-origin"</span>&gt;</span>
</code></pre>
<h4 data-id="heading-3">2.  å•ä¸ªè¯·æ±‚ç”Ÿæ•ˆï¼ˆç²¾å‡†æ§åˆ¶ï¼‰</h4>
<p>é’ˆå¯¹ç‰¹å®šè¯·æ±‚é…ç½® <code>referrerPolicy</code>ï¼ˆä¼˜å…ˆçº§é«˜äº meta æ ‡ç­¾ï¼‰ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">axios</span>({
    <span class="hljs-attr">url</span>: <span class="hljs-string">'https://ç›®æ ‡æ¥å£åœ°å€'</span>,
    <span class="hljs-attr">method</span>: <span class="hljs-string">'GET/POST'</span>,
    // axios éœ€é€šè¿‡ referrerPolicy é…ç½®ï¼ˆéƒ¨åˆ†ç‰ˆæœ¬éœ€é…åˆ headers æ¸…ç©ºï¼‰
    <span class="hljs-attr">referrerPolicy</span>: <span class="hljs-string">'no-referrer'</span>,
    <span class="hljs-attr">headers</span>: {
        // ä¸è¦æ‰‹åŠ¨è®¾ç½® Refererï¼Œç•™ç©ºæˆ–åˆ é™¤
        <span class="hljs-attr">Referer</span>: undefined 
  }})
</code></pre>

<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">fetch</span>(<span class="hljs-string">'https://ç›®æ ‡æ¥å£åœ°å€'</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'GET/POST'</span>,
    // å…³é”®ï¼šè®¾ç½® Referer ç­–ç•¥ï¼Œç¦æ­¢å‘é€ 
    <span class="hljs-attr">RefererreferrerPolicy</span>: <span class="hljs-string">'no-referrer'</span>, 
      // æ³¨æ„ï¼šåˆ é™¤æ‰‹åŠ¨è®¾ç½®çš„ Referer å¤´ï¼// 
      <span class="hljs-attr">headers</span>: { <span class="hljs-attr">Referer</span>: <span class="hljs-string">'xxx'</span> }  // âŒ è¦åˆ æ‰è¿™è¡Œ
})
</code></pre>
<h4 data-id="heading-4">3.  æœåŠ¡ç«¯å¤„ç†</h4>
<h5 data-id="heading-5">3.1 Nginxé…ç½®æ”¹é€ </h5>
<p>Nginx é»˜è®¤ä¼šæ‹’ç»å«éæ³•å­—ç¬¦çš„ Referer å¤´ï¼Œæˆ– <code>valid_referers</code> è§„åˆ™åŒ¹é…å¤±è´¥è¿”å› 400/403ã€‚è§£å†³æ–¹æ³•ï¼š</p>
<ul>
<li><strong>è·³è¿‡ Referer éæ³•å­—ç¬¦æ ¡éªŒ</strong></li>
</ul>

<pre><code class="hljs language-ini" lang="ini">        <span class="hljs-comment"># å…³é—­éæ³• header æ£€æŸ¥ï¼ˆå…è®¸å«*çš„ Referer è¿›å…¥ä¸šåŠ¡é€»è¾‘ï¼‰</span>
        ignore_invalid_headers off<span class="hljs-comment">;</span>
</code></pre>
<ul>
<li><strong>æ”¾å®½ valid_referers è§„åˆ™</strong></li>
</ul>
<p>è‹¥ç”¨ <code>valid_referers</code> åšé˜²ç›—é“¾ï¼Œè°ƒæ•´è§„åˆ™å…¼å®¹å« <code>*</code> çš„ Refererï¼š</p>
<pre><code class="hljs language-bash" lang="bash">        location / {
            <span class="hljs-comment"># å…è®¸ç©º Refererã€æŒ‡å®šåŸŸåã€å«*çš„ Refererï¼ˆç”¨~* æ­£åˆ™åŒ¹é…ï¼‰</span>
            valid_referers none blocked server_names ~*.example.com ~*/*;
            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$invalid_referer</span>) {
                <span class="hljs-comment"># æ³¨é‡Šæ‰ return 403/400ï¼Œæˆ–æ”¹ä¸ºæ—¥å¿—è®°å½•è€Œéæ‹’ç»</span>
                <span class="hljs-comment"># return 400;</span>
                access_log /var/log/nginx/invalid_referer.log warn;
                }
            }
</code></pre>
<h5 data-id="heading-6">3.2  ApacheæœåŠ¡å™¨</h5>
<ul>
<li>å…³é—­ RequestHeaderä¸¥æ ¼æ ¡éªŒ</li>
</ul>

<pre><code class="hljs language-bash" lang="bash">            <span class="hljs-comment"># åœ¨ httpd.conf æˆ– .htaccess ä¸­</span>
            AcceptPathInfo On
            <span class="hljs-comment"># æˆ–ç¦ç”¨ Referer æ ¡éªŒæ¨¡å—ï¼ˆè‹¥å¯ç”¨äº† mod_rewrite æ ¡éªŒ Refererï¼‰</span>
            RewriteEngine Off  <span class="hljs-comment"># ä¸´æ—¶å…³é—­ï¼Œæˆ–è°ƒæ•´ RewriteRule å¿½ç•¥*</span>
</code></pre>
<ul>
<li>è‹¥ç”¨ <code>mod_rewrite</code> æ ¡éªŒ Refererï¼Œä¿®æ”¹è§„åˆ™å…¼å®¹ <code>*</code>ï¼š</li>
</ul>

<pre><code class="hljs language-perl" lang="perl">            RewriteCond %{HTTP_REFERER} !^https:<span class="hljs-regexp">//</span>example.com/.* [NC]
            <span class="hljs-comment"># æ”¹ä¸ºï¼ˆå…è®¸*ï¼‰</span>
            RewriteCond %{HTTP_REFERER} !^https:<span class="hljs-regexp">//</span>example.com/[^\n]* [NC]
</code></pre>
<h4 data-id="heading-7">3.3  åç«¯åº”ç”¨é…ç½®</h4>
<p>æ‹¿Javaä¸¾ä¾‹:</p>
<pre><code class="hljs language-ini" lang="ini">            &lt;Connector <span class="hljs-attr">port</span>=<span class="hljs-string">"8080"</span> protocol=<span class="hljs-string">"HTTP/1.1"</span>
                       <span class="hljs-attr">connectionTimeout</span>=<span class="hljs-string">"20000"</span>
                       <span class="hljs-attr">redirectPort</span>=<span class="hljs-string">"8443"</span>
                       <span class="hljs-attr">relaxedPathChars</span>=<span class="hljs-string">"[]|{}^&amp;#x5c;&amp;#x60;&amp;quot;&amp;lt;&amp;gt;*"</span>  <span class="hljs-comment"># åŠ å…¥*</span>
                       <span class="hljs-attr">relaxedQueryChars</span>=<span class="hljs-string">"[]|{}^&amp;#x5c;&amp;#x60;&amp;quot;&amp;lt;&amp;gt;*"</span> /&gt;
</code></pre>
<p>Spring Boot å¯é€šè¿‡é…ç½®æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">        <span class="hljs-comment"># application.properties</span>
        <span class="hljs-attr">server.tomcat.relaxed-path-chars</span>=*
        <span class="hljs-attr">server.tomcat.relaxed-query-chars</span>=*
</code></pre>
<h3 data-id="heading-8">æ€»ç»“</h3>
<ol>
<li>å‘èµ·æ–¹ï¼šç§»é™¤ / ç¼–ç  <code>*</code>ï¼Œæˆ–ä¸å‘é€ Refererï¼›</li>
<li>æ¥æ”¶æ–¹ï¼šæ”¾å®½æœåŠ¡å™¨å¯¹ Referer çš„å­—ç¬¦æ ¡éªŒï¼ˆNginx/Tomcat é…ç½®ï¼‰ï¼Œæˆ–å¿½ç•¥å« <code>*</code> çš„ Referer æ ¡éªŒï¼›</li>
<li>æ ¸å¿ƒåŸåˆ™ï¼šéµå¾ª HTTP æ ‡å‡†ï¼Œé¿å…åœ¨ Referer ä¸­ä½¿ç”¨éæ³•å­—ç¬¦ï¼Œæ”¹ç”¨åˆæ³•æ ¼å¼æˆ–è‡ªå®šä¹‰å¤´ä¼ é€’é€šé…è¯­ä¹‰ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¬¬5ç« ï¼šå®¹å™¨ç±»ç»„ä»¶ â€”â€” 5.1 å¡«å……ï¼ˆPaddingï¼‰]]></title>    <link>https://juejin.cn/post/7578767608630575104</link>    <guid>https://juejin.cn/post/7578767608630575104</guid>    <pubDate>2025-12-02T02:27:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578767608630575104" data-draft-id="7578794217961078824" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¬¬5ç« ï¼šå®¹å™¨ç±»ç»„ä»¶ â€”â€” 5.1 å¡«å……ï¼ˆPaddingï¼‰"/> <meta itemprop="keywords" content="Flutter"/> <meta itemprop="datePublished" content="2025-12-02T02:27:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ—§æ—¶å…‰_"/> <meta itemprop="url" content="https://juejin.cn/user/4442458669718279"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¬¬5ç« ï¼šå®¹å™¨ç±»ç»„ä»¶ â€”â€” 5.1 å¡«å……ï¼ˆPaddingï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4442458669718279/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ—§æ—¶å…‰_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T02:27:32.000Z" title="Tue Dec 02 2025 02:27:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">5.1 å¡«å……ï¼ˆPaddingï¼‰</h2>
<h3 data-id="heading-1">ğŸ“š ç« èŠ‚æ¦‚è§ˆ</h3>
<p>æ¬¢è¿æ¥åˆ°ç¬¬5ç« ï¼šå®¹å™¨ç±»ç»„ä»¶ï¼æœ¬ç« ç¬¬ä¸€èŠ‚å°†å­¦ä¹  <code>Padding</code> ç»„ä»¶ï¼Œå®ƒæ˜¯æœ€åŸºç¡€ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„å®¹å™¨ç±»ç»„ä»¶ä¹‹ä¸€ï¼š</p>
<ul>
<li><strong>Padding</strong> - å¡«å……ç»„ä»¶</li>
<li><strong>EdgeInsets</strong> - è¾¹è·è®¾ç½®ç±»</li>
<li><strong>all</strong> - æ‰€æœ‰æ–¹å‘ç›¸åŒå¡«å……</li>
<li><strong>only</strong> - æŒ‡å®šæŸä¸ªæ–¹å‘å¡«å……</li>
<li><strong>symmetric</strong> - å¯¹ç§°æ–¹å‘å¡«å……</li>
<li><strong>fromLTRB</strong> - åˆ†åˆ«æŒ‡å®šå››ä¸ªæ–¹å‘</li>
<li><strong>å®é™…åº”ç”¨</strong> - å¸¸è§ä½¿ç”¨åœºæ™¯</li>
</ul>
<hr/>
<h3 data-id="heading-2">ğŸ¯ æ ¸å¿ƒçŸ¥è¯†ç‚¹</h3>
<h4 data-id="heading-3">Padding vs Margin</h4>
<p>åœ¨Flutterä¸­ï¼Œ<code>Padding</code> ç”¨äºè®¾ç½®å†…è¾¹è·ï¼ˆç±»ä¼¼CSSçš„paddingï¼‰ï¼Œè€Œå¤–è¾¹è·é€šå¸¸é€šè¿‡Containerçš„marginå±æ€§æˆ–è€…å¤–å±‚Paddingæ¥å®ç°ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   <span class="hljs-attribute">Margin</span> (å¤–)    â”‚  â† Containerçš„<span class="hljs-attribute">margin</span>æˆ–å¤–å±‚<span class="hljs-attribute">Padding</span>
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ <span class="hljs-attribute">Padding</span>(å†…)â”‚  â”‚  â† <span class="hljs-attribute">Padding</span>ç»„ä»¶
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚Child â”‚  â”‚  â”‚  â† å­ç»„ä»¶
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h3 data-id="heading-4">1ï¸âƒ£ Paddingï¼ˆå¡«å……ç»„ä»¶ï¼‰</h3>
<h4 data-id="heading-5">1.1 æ„é€ å‡½æ•°</h4>
<pre><code class="hljs language-dart" lang="dart">Padding({
  Key? key,
  <span class="hljs-keyword">required</span> EdgeInsetsGeometry padding,
  Widget? child,
})
</code></pre>
<h4 data-id="heading-6">1.2 ä¸»è¦å±æ€§</h4>




















<table><thead><tr><th>å±æ€§</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>padding</code></td><td>EdgeInsetsGeometry</td><td>å¡«å……å€¼ï¼ˆå¿…éœ€ï¼‰</td></tr><tr><td><code>child</code></td><td>Widget?</td><td>å­ç»„ä»¶</td></tr></tbody></table>
<h4 data-id="heading-7">1.3 åŸºç¡€ç”¨æ³•</h4>
<pre><code class="hljs language-dart" lang="dart">Padding(
  padding: EdgeInsets.all(<span class="hljs-number">16</span>),
  child: Text(<span class="hljs-string">'Hello World'</span>),
)
</code></pre>
<hr/>
<h3 data-id="heading-8">2ï¸âƒ£ EdgeInsetsï¼ˆè¾¹è·è®¾ç½®ï¼‰</h3>
<h4 data-id="heading-9">2.1 ä»€ä¹ˆæ˜¯EdgeInsets</h4>
<p><code>EdgeInsets</code> æ˜¯ <code>EdgeInsetsGeometry</code> çš„å­ç±»ï¼Œæä¾›äº†å¤šç§ä¾¿æ·æ–¹æ³•æ¥è®¾ç½®å¡«å……å€¼ã€‚</p>
<h4 data-id="heading-10">2.2 å››ä¸ªä¾¿æ·æ–¹æ³•</h4>
<h5 data-id="heading-11">1. all - æ‰€æœ‰æ–¹å‘ç›¸åŒ</h5>
<pre><code class="hljs language-dart" lang="dart">EdgeInsets.all(<span class="hljs-built_in">double</span> value)
</code></pre>
<p><strong>ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-dart" lang="dart">Padding(
  padding: EdgeInsets.all(<span class="hljs-number">16</span>),  <span class="hljs-comment">// ä¸Šä¸‹å·¦å³éƒ½æ˜¯16</span>
  child: Text(<span class="hljs-string">'Allæ–¹å‘å¡«å……'</span>),
)
</code></pre>
<p><strong>ç­‰ä»·äºï¼š</strong></p>
<pre><code class="hljs language-dart" lang="dart">EdgeInsets.fromLTRB(<span class="hljs-number">16</span>, <span class="hljs-number">16</span>, <span class="hljs-number">16</span>, <span class="hljs-number">16</span>)
</code></pre>
<h5 data-id="heading-12">2. only - æŒ‡å®šæŸä¸ªæ–¹å‘</h5>
<pre><code class="hljs language-dart" lang="dart">EdgeInsets.only({
  <span class="hljs-built_in">double</span> left = <span class="hljs-number">0.0</span>,
  <span class="hljs-built_in">double</span> top = <span class="hljs-number">0.0</span>,
  <span class="hljs-built_in">double</span> right = <span class="hljs-number">0.0</span>,
  <span class="hljs-built_in">double</span> bottom = <span class="hljs-number">0.0</span>,
})
</code></pre>
<p><strong>ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// åªè®¾ç½®å·¦è¾¹</span>
Padding(
  padding: EdgeInsets.only(left: <span class="hljs-number">8</span>),
  child: Text(<span class="hljs-string">'å·¦ä¾§å¡«å……'</span>),
)

<span class="hljs-comment">// åŒæ—¶è®¾ç½®å¤šä¸ªæ–¹å‘</span>
Padding(
  padding: EdgeInsets.only(left: <span class="hljs-number">20</span>, right: <span class="hljs-number">20</span>),
  child: Text(<span class="hljs-string">'å·¦å³å¡«å……'</span>),
)
</code></pre>
<h5 data-id="heading-13">3. symmetric - å¯¹ç§°æ–¹å‘</h5>
<pre><code class="hljs language-dart" lang="dart">EdgeInsets.symmetric({
  <span class="hljs-built_in">double</span> vertical = <span class="hljs-number">0.0</span>,    <span class="hljs-comment">// ä¸Šä¸‹</span>
  <span class="hljs-built_in">double</span> horizontal = <span class="hljs-number">0.0</span>,  <span class="hljs-comment">// å·¦å³</span>
})
</code></pre>
<p><strong>ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// åªè®¾ç½®ä¸Šä¸‹</span>
Padding(
  padding: EdgeInsets.symmetric(vertical: <span class="hljs-number">8</span>),
  child: Text(<span class="hljs-string">'ä¸Šä¸‹å¡«å……'</span>),
)

<span class="hljs-comment">// åŒæ—¶è®¾ç½®ä¸Šä¸‹å’Œå·¦å³</span>
Padding(
  padding: EdgeInsets.symmetric(
    vertical: <span class="hljs-number">12</span>,
    horizontal: <span class="hljs-number">20</span>,
  ),
  child: Text(<span class="hljs-string">'å¯¹ç§°å¡«å……'</span>),
)
</code></pre>
<h5 data-id="heading-14">4. fromLTRB - å››ä¸ªæ–¹å‘åˆ†åˆ«æŒ‡å®š</h5>
<pre><code class="hljs language-dart" lang="dart">EdgeInsets.fromLTRB(
  <span class="hljs-built_in">double</span> left,
  <span class="hljs-built_in">double</span> top,
  <span class="hljs-built_in">double</span> right,
  <span class="hljs-built_in">double</span> bottom,
)
</code></pre>
<p><strong>ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-dart" lang="dart">Padding(
  padding: EdgeInsets.fromLTRB(<span class="hljs-number">20</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>),
  child: Text(<span class="hljs-string">'å››ä¸ªæ–¹å‘ä¸åŒå€¼'</span>),
)
</code></pre>
<h4 data-id="heading-15">2.3 æ–¹æ³•å¯¹æ¯”</h4>






























<table><thead><tr><th>æ–¹æ³•</th><th>å‚æ•°</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>all</strong></td><td>1ä¸ª</td><td>æ‰€æœ‰æ–¹å‘ç›¸åŒ</td></tr><tr><td><strong>only</strong></td><td>1-4ä¸ª</td><td>æŒ‡å®šæŸäº›æ–¹å‘</td></tr><tr><td><strong>symmetric</strong></td><td>1-2ä¸ª</td><td>å¯¹ç§°è®¾ç½®</td></tr><tr><td><strong>fromLTRB</strong></td><td>4ä¸ª</td><td>å››ä¸ªæ–¹å‘éƒ½ä¸åŒ</td></tr></tbody></table>
<h4 data-id="heading-16">2.4 é€‰æ‹©å»ºè®®</h4>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// âœ… æ¨èï¼šç®€æ´æ˜äº†</span>
EdgeInsets.all(<span class="hljs-number">16</span>)                    <span class="hljs-comment">// å››ä¸ªæ–¹å‘ç›¸åŒ</span>
EdgeInsets.symmetric(horizontal: <span class="hljs-number">16</span>)  <span class="hljs-comment">// å·¦å³ç›¸åŒ</span>
EdgeInsets.only(left: <span class="hljs-number">16</span>)            <span class="hljs-comment">// åªè®¾ç½®ä¸€ä¸ª</span>

<span class="hljs-comment">// âŒ ä¸æ¨èï¼šè¿‡äºç¹ç</span>
EdgeInsets.fromLTRB(<span class="hljs-number">16</span>, <span class="hljs-number">16</span>, <span class="hljs-number">16</span>, <span class="hljs-number">16</span>)  <span class="hljs-comment">// åº”è¯¥ç”¨all(16)</span>
EdgeInsets.fromLTRB(<span class="hljs-number">16</span>, <span class="hljs-number">0</span>, <span class="hljs-number">16</span>, <span class="hljs-number">0</span>)    <span class="hljs-comment">// åº”è¯¥ç”¨symmetric(horizontal: 16)</span>
</code></pre>
<hr/>
<h3 data-id="heading-17">3ï¸âƒ£ è¯¦ç»†ç¤ºä¾‹</h3>
<h4 data-id="heading-18">3.1 allç¤ºä¾‹</h4>
<pre><code class="hljs language-dart" lang="dart">Container(
  color: Colors.blue[<span class="hljs-number">100</span>],
  child: Padding(
    padding: EdgeInsets.all(<span class="hljs-number">16</span>),
    child: Container(
      color: Colors.white,
      child: Text(<span class="hljs-string">'16åƒç´ å¡«å……'</span>),
    ),
  ),
)
</code></pre>
<p><strong>æ•ˆæœï¼š</strong></p>
<pre><code class="hljs">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚  â† è“è‰²èƒŒæ™¯ï¼ˆå¤–å±‚Containerï¼‰
â”‚ â–ˆâ–ˆâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â–ˆâ–ˆ â”‚
â”‚ â–ˆâ–ˆâ”‚ 16pxå¡«å…… â”‚â–ˆâ–ˆ â”‚  â† ç™½è‰²èƒŒæ™¯ï¼ˆå†…å±‚Containerï¼‰
â”‚ â–ˆâ–ˆâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â–ˆâ–ˆ â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-19">3.2 onlyç¤ºä¾‹</h4>
<pre><code class="hljs language-dart" lang="dart">Column(
  children: [
    <span class="hljs-comment">// åªè®¾ç½®å·¦è¾¹</span>
    Padding(
      padding: EdgeInsets.only(left: <span class="hljs-number">8</span>),
      child: Text(<span class="hljs-string">"Hello world"</span>),
    ),
    
    <span class="hljs-comment">// åªè®¾ç½®ä¸Šä¸‹</span>
    Padding(
      padding: EdgeInsets.only(top: <span class="hljs-number">8</span>, bottom: <span class="hljs-number">8</span>),
      child: Text(<span class="hljs-string">"I am Jack"</span>),
    ),
    
    <span class="hljs-comment">// è®¾ç½®å·¦å³</span>
    Padding(
      padding: EdgeInsets.only(left: <span class="hljs-number">20</span>, right: <span class="hljs-number">20</span>),
      child: Text(<span class="hljs-string">"Your friend"</span>),
    ),
  ],
)
</code></pre>
<h4 data-id="heading-20">3.3 symmetricç¤ºä¾‹</h4>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// ä¸Šä¸‹å¡«å……</span>
Padding(
  padding: EdgeInsets.symmetric(vertical: <span class="hljs-number">16</span>),
  child: Text(<span class="hljs-string">'ä¸Šä¸‹å„16åƒç´ '</span>),
)

<span class="hljs-comment">// å·¦å³å¡«å……</span>
Padding(
  padding: EdgeInsets.symmetric(horizontal: <span class="hljs-number">24</span>),
  child: Text(<span class="hljs-string">'å·¦å³å„24åƒç´ '</span>),
)

<span class="hljs-comment">// åŒæ—¶è®¾ç½®</span>
Padding(
  padding: EdgeInsets.symmetric(
    vertical: <span class="hljs-number">12</span>,
    horizontal: <span class="hljs-number">20</span>,
  ),
  child: Text(<span class="hljs-string">'ä¸Šä¸‹12ï¼Œå·¦å³20'</span>),
)
</code></pre>
<h4 data-id="heading-21">3.4 fromLTRBç¤ºä¾‹</h4>
<pre><code class="hljs language-dart" lang="dart">Padding(
  padding: EdgeInsets.fromLTRB(<span class="hljs-number">20</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>),
  child: Column(
    crossAxisAlignment: CrossAxisAlignment.start,
    children: [
      Text(<span class="hljs-string">'å·¦ï¼š20åƒç´ '</span>),
      Text(<span class="hljs-string">'ä¸Šï¼š10åƒç´ '</span>),
      Text(<span class="hljs-string">'å³ï¼š20åƒç´ '</span>),
      Text(<span class="hljs-string">'ä¸‹ï¼š30åƒç´ '</span>),
    ],
  ),
)
</code></pre>
<hr/>
<h3 data-id="heading-22">4ï¸âƒ£ å®é™…åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-23">åœºæ™¯1ï¼šå¡ç‰‡å†…å®¹å¡«å……</h4>
<pre><code class="hljs language-dart" lang="dart">Container(
  decoration: BoxDecoration(
    color: Colors.white,
    borderRadius: BorderRadius.circular(<span class="hljs-number">8</span>),
    boxShadow: [
      BoxShadow(
        color: Colors.grey.withOpacity(<span class="hljs-number">0.3</span>),
        blurRadius: <span class="hljs-number">4</span>,
        offset: Offset(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>),
      ),
    ],
  ),
  child: Padding(
    padding: EdgeInsets.all(<span class="hljs-number">16</span>),
    child: Column(
      crossAxisAlignment: CrossAxisAlignment.start,
      children: [
        Text(
          <span class="hljs-string">'æ–‡ç« æ ‡é¢˜'</span>,
          style: TextStyle(
            fontSize: <span class="hljs-number">16</span>,
            fontWeight: FontWeight.bold,
          ),
        ),
        SizedBox(height: <span class="hljs-number">8</span>),
        Text(
          <span class="hljs-string">'æ–‡ç« å†…å®¹æè¿°...'</span>,
          style: TextStyle(color: Colors.grey),
        ),
      ],
    ),
  ),
)
</code></pre>
<h4 data-id="heading-24">åœºæ™¯2ï¼šæŒ‰é’®å†…è¾¹è·</h4>
<pre><code class="hljs language-dart" lang="dart">Container(
  decoration: BoxDecoration(
    color: Colors.blue,
    borderRadius: BorderRadius.circular(<span class="hljs-number">4</span>),
  ),
  child: Padding(
    padding: EdgeInsets.symmetric(
      horizontal: <span class="hljs-number">24</span>,
      vertical: <span class="hljs-number">12</span>,
    ),
    child: Text(
      <span class="hljs-string">'ç¡®å®š'</span>,
      style: TextStyle(color: Colors.white),
    ),
  ),
)
</code></pre>
<h4 data-id="heading-25">åœºæ™¯3ï¼šåˆ—è¡¨é¡¹é—´è·</h4>
<pre><code class="hljs language-dart" lang="dart">ListView.builder(
  itemCount: items.length,
  itemBuilder: (context, index) {
    <span class="hljs-keyword">return</span> Padding(
      padding: EdgeInsets.only(bottom: <span class="hljs-number">8</span>),
      child: ListTile(
        title: Text(<span class="hljs-string">'åˆ—è¡¨é¡¹ <span class="hljs-subst">$index</span>'</span>),
      ),
    );
  },
)
</code></pre>
<h4 data-id="heading-26">åœºæ™¯4ï¼šé¡µé¢æ•´ä½“å†…è¾¹è·</h4>
<pre><code class="hljs language-dart" lang="dart">Scaffold(
  body: Padding(
    padding: EdgeInsets.all(<span class="hljs-number">16</span>),
    child: Column(
      children: [
        <span class="hljs-comment">// é¡µé¢å†…å®¹</span>
      ],
    ),
  ),
)
</code></pre>
<hr/>
<h3 data-id="heading-27">ğŸ¤” å¸¸è§é—®é¢˜ï¼ˆFAQï¼‰</h3>
<h4 data-id="heading-28">Q1: Paddingå’ŒMarginçš„åŒºåˆ«ï¼Ÿ</h4>
<p><strong>A:</strong> åœ¨Flutterä¸­ï¼š</p>




















<table><thead><tr><th>æ¦‚å¿µ</th><th>å®ç°æ–¹å¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>Paddingï¼ˆå†…è¾¹è·ï¼‰</strong></td><td>Paddingç»„ä»¶</td><td>å­ç»„ä»¶å†…éƒ¨çš„ç•™ç™½</td></tr><tr><td><strong>Marginï¼ˆå¤–è¾¹è·ï¼‰</strong></td><td>Container.margin</td><td>ç»„ä»¶å¤–éƒ¨çš„ç•™ç™½</td></tr></tbody></table>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// Paddingï¼ˆå†…è¾¹è·ï¼‰</span>
Padding(
  padding: EdgeInsets.all(<span class="hljs-number">16</span>),
  child: Container(
    color: Colors.blue,
    child: Text(<span class="hljs-string">'Text'</span>),
  ),
)

<span class="hljs-comment">// Marginï¼ˆå¤–è¾¹è·ï¼‰</span>
Container(
  margin: EdgeInsets.all(<span class="hljs-number">16</span>),
  color: Colors.blue,
  child: Text(<span class="hljs-string">'Text'</span>),
)
</code></pre>
<h4 data-id="heading-29">Q2: EdgeInsets.zeroæ˜¯ä»€ä¹ˆï¼Ÿ</h4>
<p><strong>A:</strong> æ‰€æœ‰æ–¹å‘å¡«å……ä¸º0çš„å¿«æ·æ–¹å¼</p>
<pre><code class="hljs language-dart" lang="dart">EdgeInsets.zero  <span class="hljs-comment">// ç­‰ä»·äº EdgeInsets.all(0)</span>
</code></pre>
<h4 data-id="heading-30">Q3: å¦‚ä½•è®¾ç½®è´Ÿæ•°å¡«å……ï¼Ÿ</h4>
<p><strong>A:</strong> Paddingä¸æ”¯æŒè´Ÿæ•°ï¼Œä½†å¯ä»¥ç”¨Transform.translate</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šPaddingä¸æ”¯æŒè´Ÿæ•°</span>
Padding(
  padding: EdgeInsets.all(<span class="hljs-number">-10</span>),  <span class="hljs-comment">// ä¼šæŠ¥é”™</span>
  child: Text(<span class="hljs-string">'Text'</span>),
)

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨Transform</span>
Transform.translate(
  offset: Offset(<span class="hljs-number">-10</span>, <span class="hljs-number">-10</span>),
  child: Text(<span class="hljs-string">'Text'</span>),
)
</code></pre>
<h4 data-id="heading-31">Q4: Paddingä¼šå½±å“å­ç»„ä»¶çš„çº¦æŸå—ï¼Ÿ</h4>
<p><strong>A:</strong> ä¼šï¼Paddingä¼šå‡å°ä¼ é€’ç»™å­ç»„ä»¶çš„çº¦æŸ</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// å‡è®¾çˆ¶ç»„ä»¶çº¦æŸä¸º 100Ã—100</span>
Container(
  width: <span class="hljs-number">100</span>,
  height: <span class="hljs-number">100</span>,
  child: Padding(
    padding: EdgeInsets.all(<span class="hljs-number">10</span>),
    <span class="hljs-comment">// å­ç»„ä»¶å®é™…å¯ç”¨ç©ºé—´ï¼š(100-20)Ã—(100-20) = 80Ã—80</span>
    child: Container(color: Colors.blue),
  ),
)
</code></pre>
<h4 data-id="heading-32">Q5: å¦‚ä½•é€‰æ‹©ä½¿ç”¨å“ªä¸ªEdgeInsetsæ–¹æ³•ï¼Ÿ</h4>
<p><strong>A:</strong> éµå¾ªç®€æ´åŸåˆ™ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// å››ä¸ªæ–¹å‘ç›¸åŒ â†’ all</span>
EdgeInsets.all(<span class="hljs-number">16</span>)

<span class="hljs-comment">// ä¸Šä¸‹æˆ–å·¦å³ç›¸åŒ â†’ symmetric</span>
EdgeInsets.symmetric(horizontal: <span class="hljs-number">16</span>)
EdgeInsets.symmetric(vertical: <span class="hljs-number">8</span>)

<span class="hljs-comment">// åªè®¾ç½®1-3ä¸ªæ–¹å‘ â†’ only</span>
EdgeInsets.only(left: <span class="hljs-number">16</span>)
EdgeInsets.only(left: <span class="hljs-number">16</span>, right: <span class="hljs-number">16</span>)

<span class="hljs-comment">// å››ä¸ªæ–¹å‘éƒ½ä¸åŒ â†’ fromLTRB</span>
EdgeInsets.fromLTRB(<span class="hljs-number">20</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>, <span class="hljs-number">30</span>)
</code></pre>
<hr/>
<h3 data-id="heading-33">ğŸ¯ è·Ÿç€åšç»ƒä¹ </h3>
<h4 data-id="heading-34">ç»ƒä¹ 1ï¼šå®ç°ä¸€ä¸ªå¸¦å†…è¾¹è·çš„å¡ç‰‡ç»„ä»¶</h4>
<p><strong>ç›®æ ‡ï¼š</strong> åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰Cardç»„ä»¶ï¼Œå†…å®¹æœ‰16åƒç´ å¡«å……</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<ol>
<li>ä½¿ç”¨Containerä½œä¸ºå¡ç‰‡èƒŒæ™¯</li>
<li>æ·»åŠ åœ†è§’å’Œé˜´å½±</li>
<li>ä½¿ç”¨Paddingè®¾ç½®å†…å®¹å¡«å……</li>
</ol>
<details>
<summary>ğŸ’¡ æŸ¥çœ‹ç­”æ¡ˆ</summary>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomCard</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">final</span> Widget child;
  
  <span class="hljs-keyword">const</span> CustomCard({<span class="hljs-keyword">super</span>.key, <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.child});
  
  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Container(
      decoration: BoxDecoration(
        color: Colors.white,
        borderRadius: BorderRadius.circular(<span class="hljs-number">12</span>),
        boxShadow: [
          BoxShadow(
            color: Colors.grey.withOpacity(<span class="hljs-number">0.2</span>),
            spreadRadius: <span class="hljs-number">1</span>,
            blurRadius: <span class="hljs-number">4</span>,
            offset: Offset(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>),
          ),
        ],
      ),
      child: Padding(
        padding: EdgeInsets.all(<span class="hljs-number">16</span>),
        child: child,
      ),
    );
  }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
CustomCard(
  child: Column(
    crossAxisAlignment: CrossAxisAlignment.start,
    children: [
      Text(
        <span class="hljs-string">'æ ‡é¢˜'</span>,
        style: TextStyle(
          fontSize: <span class="hljs-number">18</span>,
          fontWeight: FontWeight.bold,
        ),
      ),
      SizedBox(height: <span class="hljs-number">8</span>),
      Text(<span class="hljs-string">'è¿™æ˜¯å¡ç‰‡çš„å†…å®¹æè¿°...'</span>),
    ],
  ),
)
</code></pre>
</details>
<hr/>
<h4 data-id="heading-35">ç»ƒä¹ 2ï¼šå®ç°å“åº”å¼Padding</h4>
<p><strong>ç›®æ ‡ï¼š</strong> æ ¹æ®å±å¹•å®½åº¦åŠ¨æ€è°ƒæ•´Paddingå€¼</p>
<p><strong>æ­¥éª¤ï¼š</strong></p>
<ol>
<li>ä½¿ç”¨MediaQueryè·å–å±å¹•å®½åº¦</li>
<li>è®¡ç®—åˆé€‚çš„paddingå€¼</li>
<li>åº”ç”¨åŠ¨æ€padding</li>
</ol>
<details>
<summary>ğŸ’¡ æŸ¥çœ‹ç­”æ¡ˆ</summary>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResponsivePadding</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">final</span> Widget child;
  
  <span class="hljs-keyword">const</span> ResponsivePadding({<span class="hljs-keyword">super</span>.key, <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.child});
  
  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">final</span> screenWidth = MediaQuery.of(context).size.width;
    
    <span class="hljs-comment">// æ ¹æ®å±å¹•å®½åº¦è®¡ç®—padding</span>
    <span class="hljs-built_in">double</span> padding;
    <span class="hljs-keyword">if</span> (screenWidth &lt; <span class="hljs-number">600</span>) {
      padding = <span class="hljs-number">16</span>;  <span class="hljs-comment">// æ‰‹æœº</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (screenWidth &lt; <span class="hljs-number">1200</span>) {
      padding = <span class="hljs-number">24</span>;  <span class="hljs-comment">// å¹³æ¿</span>
    } <span class="hljs-keyword">else</span> {
      padding = <span class="hljs-number">32</span>;  <span class="hljs-comment">// æ¡Œé¢</span>
    }
    
    <span class="hljs-keyword">return</span> Padding(
      padding: EdgeInsets.all(padding),
      child: child,
    );
  }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
ResponsivePadding(
  child: Text(<span class="hljs-string">'å“åº”å¼å†…å®¹'</span>),
)
</code></pre>
</details>
<hr/>
<h3 data-id="heading-36">ğŸ“‹ å°ç»“</h3>
<h4 data-id="heading-37">æ ¸å¿ƒæ¦‚å¿µ</h4>




















<table><thead><tr><th>ç»„ä»¶/ç±»</th><th>ä½œç”¨</th><th>å¸¸ç”¨æ–¹æ³•</th></tr></thead><tbody><tr><td><strong>Padding</strong></td><td>æ·»åŠ å¡«å……</td><td>paddingå±æ€§</td></tr><tr><td><strong>EdgeInsets</strong></td><td>è®¾ç½®å¡«å……å€¼</td><td>allã€onlyã€symmetricã€fromLTRB</td></tr></tbody></table>
<h4 data-id="heading-38">EdgeInsetsæ–¹æ³•é€ŸæŸ¥</h4>
<pre><code class="hljs language-dart" lang="dart">EdgeInsets.all(<span class="hljs-number">16</span>)                        <span class="hljs-comment">// æ‰€æœ‰æ–¹å‘16</span>
EdgeInsets.only(left: <span class="hljs-number">8</span>)                 <span class="hljs-comment">// åªè®¾ç½®å·¦è¾¹</span>
EdgeInsets.only(left: <span class="hljs-number">8</span>, right: <span class="hljs-number">8</span>)       <span class="hljs-comment">// è®¾ç½®å·¦å³</span>
EdgeInsets.symmetric(vertical: <span class="hljs-number">16</span>)       <span class="hljs-comment">// ä¸Šä¸‹16</span>
EdgeInsets.symmetric(horizontal: <span class="hljs-number">20</span>)     <span class="hljs-comment">// å·¦å³20</span>
EdgeInsets.symmetric(                    <span class="hljs-comment">// ä¸Šä¸‹å’Œå·¦å³</span>
  vertical: <span class="hljs-number">12</span>,
  horizontal: <span class="hljs-number">20</span>,
)
EdgeInsets.fromLTRB(<span class="hljs-number">20</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>)     <span class="hljs-comment">// å››ä¸ªæ–¹å‘åˆ†åˆ«æŒ‡å®š</span>
EdgeInsets.zero                          <span class="hljs-comment">// æ‰€æœ‰æ–¹å‘ä¸º0</span>
</code></pre>
<h4 data-id="heading-39">è®°å¿†æŠ€å·§</h4>
<ol>
<li><strong>all</strong>ï¼šallæ–¹å‘ç›¸åŒ</li>
<li><strong>only</strong>ï¼šonlyæŸäº›æ–¹å‘</li>
<li><strong>symmetric</strong>ï¼šå¯¹ç§°çš„ä¸¤ä¸ªæ–¹å‘</li>
<li><strong>fromLTRB</strong>ï¼šLeftã€Topã€Rightã€Bottomé¡ºåº</li>
</ol>
<hr/>
<h3 data-id="heading-40">ğŸ”— ç›¸å…³èµ„æº</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.flutter.dev%2Fflutter%2Fwidgets%2FPadding-class.html" target="_blank" title="https://api.flutter.dev/flutter/widgets/Padding-class.html" ref="nofollow noopener noreferrer">Padding å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.flutter.dev%2Fflutter%2Fpainting%2FEdgeInsets-class.html" target="_blank" title="https://api.flutter.dev/flutter/painting/EdgeInsets-class.html" ref="nofollow noopener noreferrer">EdgeInsets å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.flutter.dev%2Fflutter%2Fpainting%2FEdgeInsetsGeometry-class.html" target="_blank" title="https://api.flutter.dev/flutter/painting/EdgeInsetsGeometry-class.html" ref="nofollow noopener noreferrer">EdgeInsetsGeometry å®˜æ–¹æ–‡æ¡£</a></li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¡¹ç›®æ€§èƒ½ä¼˜åŒ–å®è·µï¼šæ·±å…¥FMPç®—æ³•åŸç†æ¢ç´¢ï½œå¾—ç‰©æŠ€æœ¯]]></title>    <link>https://juejin.cn/post/7578762210287255615</link>    <guid>https://juejin.cn/post/7578762210287255615</guid>    <pubDate>2025-12-02T02:45:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578762210287255615" data-draft-id="7578760341280751657" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¡¹ç›®æ€§èƒ½ä¼˜åŒ–å®è·µï¼šæ·±å…¥FMPç®—æ³•åŸç†æ¢ç´¢ï½œå¾—ç‰©æŠ€æœ¯"/> <meta itemprop="keywords" content="ç®—æ³•,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-02T02:45:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¾—ç‰©æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/2392954206960247"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¡¹ç›®æ€§èƒ½ä¼˜åŒ–å®è·µï¼šæ·±å…¥FMPç®—æ³•åŸç†æ¢ç´¢ï½œå¾—ç‰©æŠ€æœ¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2392954206960247/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¾—ç‰©æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T02:45:47.000Z" title="Tue Dec 02 2025 02:45:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å‰ è¨€</h2>
<p>æœ€è¿‘åœ¨é¡¹ç›®ä¸­é‡åˆ°äº†é¡µé¢åŠ è½½é€Ÿåº¦ä¼˜åŒ–çš„é—®é¢˜ï¼Œä¸ºäº†æé«˜ç§’å¼€ç‡ç­‰æŒ‡æ ‡ï¼Œæˆ‘å†³å®šä»<strong>eebiæŠ¥è¡¨</strong>å…¥æ‰‹ï¼Œåˆ†æä¸€ä¸‹å½“å‰é¡¹ç›®çš„æ€§èƒ½ç›‘æ§ä½“ç³»ã€‚</p>
<p>é€šè¿‡æŸ¥çœ‹æŠ¥è¡¨ä¸­çš„cost_timeã€is_firstç­‰å­—æ®µï¼Œæˆ‘å¼€å§‹äº†è§£é¡¹ç›®çš„æ€§èƒ½æ•°æ®é‡‡é›†æƒ…å†µã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™äº›æ•°æ®çš„å«ä¹‰ï¼Œæˆ‘æ·±å…¥ç ”ç©¶äº†ç›¸å…³SDKçš„æºç å®ç°ã€‚</p>
<p>åœ¨åˆ†æè¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°é‡‡é›†åˆ°çš„cost_timeå‚æ•°å®é™…ä¸Šå°±æ˜¯<strong>FMPï¼ˆFirst Meaningful Paintï¼‰</strong> æŒ‡æ ‡ã€‚äºæ˜¯æˆ‘å¯¹FMPçš„ç®—æ³•å®ç°è¿›è¡Œäº†æ¢³ç†ï¼Œäº†è§£äº†å®ƒçš„è®¡ç®—é€»è¾‘ã€‚</p>
<p>æœ¬æ–‡å°†åˆ†äº«æˆ‘åœ¨æ€§èƒ½ä¼˜åŒ–è¿‡ç¨‹ä¸­çš„ä¸€äº›æ€è€ƒå’Œå‘ç°ï¼Œå¸Œæœ›èƒ½å¯¹å…³æ³¨å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„åŒå­¦æœ‰æ‰€å¸®åŠ©ã€‚</p>
<h2 data-id="heading-1">äºŒã€ä»€ä¹ˆæ˜¯FMP</h2>
<p>FMP (First Meaningful Paint) é¦–æ¬¡æœ‰æ„ä¹‰ç»˜åˆ¶ï¼Œæ˜¯æŒ‡é¡µé¢é¦–æ¬¡ç»˜åˆ¶æœ‰æ„ä¹‰å†…å®¹çš„æ—¶é—´ç‚¹ã€‚ä¸ FCP (First Contentful Paint) ä¸åŒï¼ŒFMP æ›´å…³æ³¨çš„æ˜¯å¯¹ç”¨æˆ·æœ‰å®é™…ä»·å€¼çš„å†…å®¹ï¼Œè€Œä¸æ˜¯ä»»ä½•å†…å®¹çš„é¦–æ¬¡ç»˜åˆ¶ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€FMP è®¡ç®—åŸç†</h2>
<h3 data-id="heading-3">3.1æ ¸å¿ƒæ€æƒ³</h3>
<p>FMP çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>é€šè¿‡åˆ†æè§†å£å†…é‡è¦ DOM å…ƒç´ çš„æ¸²æŸ“æ—¶é—´ï¼Œæ‰¾åˆ°å¯¹ç”¨æˆ·æœ€æœ‰æ„ä¹‰çš„å†…å®¹å®Œæˆæ¸²æŸ“çš„æ—¶é—´ç‚¹</strong>ã€‚</p>
<h3 data-id="heading-4">3.2FMPçš„ä¸‰ç§è®¡ç®—æ–¹å¼</h3>
<ul>
<li><strong>æ–°ç®—æ³• FMP (specifiedValue)</strong> åŸºäºç”¨æˆ·æŒ‡å®šçš„ DOM å…ƒç´ è®¡ç®—é€šè¿‡fmpSelectoré…ç½®æŒ‡å®šå…ƒç´ è®¡ç®—æŒ‡å®šå…ƒç´ çš„å®Œæ•´åŠ è½½æ—¶é—´</li>
</ul>

<ul>
<li><strong>ä¼ ç»Ÿç®—æ³• FMP (value)</strong> åŸºäºè§†å£å†…é‡è¦å…ƒç´ è®¡ç®—é€‰æ‹©æƒé‡æœ€é«˜çš„å…ƒç´ å–æ‰€æœ‰å‚è€ƒå…ƒç´ ä¸­æœ€æ™šå®Œæˆçš„æ—¶é—´</li>
</ul>

<ul>
<li><strong>P80 ç®—æ³• FMP (p80Value)</strong> åŸºäº P80 ç™¾åˆ†ä½è®¡ç®—å–æ’åºå80%ä½ç½®çš„æ—¶é—´æ›´ç¨³å®šçš„æ€§èƒ½æŒ‡æ ‡</li>
</ul>
<h3 data-id="heading-5">3.3æ–°ç®—æ³•vsä¼ ç»Ÿç®—æ³•</h3>
<p><strong>ä¼ ç»Ÿç®—æ³•æµç¨‹</strong></p>
<ul>
<li>éå†æ•´ä¸ªDOMæ ‘</li>
<li>è®¡ç®—æ¯ä¸ªå…ƒç´ çš„æƒé‡åˆ†æ•°</li>
<li>é€‰æ‹©å¤šä¸ªé‡è¦å…ƒç´ </li>
<li>è®¡ç®—æ‰€æœ‰å…ƒç´ çš„åŠ è½½æ—¶é—´</li>
<li>å–æœ€æ™šå®Œæˆçš„æ—¶é—´ä½œä¸ºFMP</li>
</ul>
<p><strong>æ–°ç®—æ³•ï¼ˆæŒ‡å®šå…ƒç´ ç®—æ³•ï¼‰æµç¨‹</strong></p>
<p><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong> ç›´æ¥æŒ‡å®šä¸€ä¸ªå…³é”® DOM å…ƒç´ ï¼Œè®¡ç®—è¯¥å…ƒç´ çš„å®Œæ•´åŠ è½½æ—¶é—´ä½œä¸ºFMPã€‚</p>
<p><strong>ä¼ ç»Ÿç®—æ³•è¯¦ç»†æ­¥éª¤</strong></p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šDOMå…ƒç´ é€‰æ‹©</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// é€’å½’éå† DOM æ ‘ï¼Œé€‰æ‹©é‡è¦å…ƒç´ </span>
selectMostImportantDOMs(dom: HTMLElement = document.body): void {
Â Â <span class="hljs-keyword">const</span>Â score =Â <span class="hljs-keyword">this</span>.getWeightScore(dom);


Â Â <span class="hljs-keyword">if</span>Â (score &gt; BODY_WEIGHT) {
Â  Â Â <span class="hljs-comment">// æƒé‡å¤§äº body æƒé‡ï¼Œä½œä¸ºå‚è€ƒå…ƒç´ </span>
Â  Â Â <span class="hljs-keyword">this</span>.referDoms.push(dom);
Â  }Â <span class="hljs-keyword">else</span>Â <span class="hljs-keyword">if</span>Â (score &gt;=Â <span class="hljs-keyword">this</span>.highestWeightScore) {
Â  Â Â <span class="hljs-comment">// æƒé‡å¤§äºç­‰äºæœ€é«˜åˆ†æ•°ï¼Œä½œä¸ºé‡è¦å…ƒç´ </span>
Â  Â Â <span class="hljs-keyword">this</span>.importantDOMs.push(dom);
Â  }


Â Â <span class="hljs-comment">// é€’å½’å¤„ç†å­å…ƒç´ </span>
Â Â <span class="hljs-keyword">for</span>Â (let i =Â <span class="hljs-number">0</span>, l = dom.children.length; i &lt; l; i++) {
Â  Â Â <span class="hljs-keyword">this</span>.selectMostImportantDOMs(dom.children[i]Â <span class="hljs-keyword">as</span>Â HTMLElement);
Â  }
}
</code></pre>
<p><strong>ç¬¬äºŒæ­¥ï¼šæƒé‡è®¡ç®—</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è®¡ç®—å…ƒç´ æƒé‡åˆ†æ•°</span>
<span class="hljs-title function_">getWeightScore</span>(<span class="hljs-params">dom: Element</span>) {
Â Â <span class="hljs-comment">// è·å–å…ƒç´ åœ¨è§†å£ä¸­çš„ä½ç½®å’Œå¤§å°</span>
Â Â <span class="hljs-keyword">const</span>Â viewPortPos = dom.<span class="hljs-title function_">getBoundingClientRect</span>();
Â Â <span class="hljs-keyword">const</span>Â screenHeight =Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getScreenHeight</span>();


Â Â <span class="hljs-comment">// è®¡ç®—å…ƒç´ åœ¨é¦–å±ä¸­çš„å¯è§é¢ç§¯</span>
Â Â <span class="hljs-keyword">const</span>Â fpWidth =Â <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(viewPortPos.<span class="hljs-property">right</span>,Â <span class="hljs-variable constant_">SCREEN_WIDTH</span>) -Â <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, viewPortPos.<span class="hljs-property">left</span>);
Â Â <span class="hljs-keyword">const</span>Â fpHeight =Â <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(viewPortPos.<span class="hljs-property">bottom</span>, screenHeight) -Â <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, viewPortPos.<span class="hljs-property">top</span>);


Â Â <span class="hljs-comment">// æƒé‡ = å¯è§é¢ç§¯ Ã— å…ƒç´ ç±»å‹æƒé‡</span>
Â Â <span class="hljs-keyword">return</span>Â fpWidth * fpHeight *Â <span class="hljs-title function_">getDomWeight</span>(dom);
}
</code></pre>
<p>æƒé‡è®¡ç®—å…¬å¼ï¼š</p>
<pre><code class="hljs">æƒé‡åˆ†æ•° = å¯è§é¢ç§¯ Ã— å…ƒç´ ç±»å‹æƒé‡
</code></pre>
<p>å…ƒç´ ç±»å‹æƒé‡ï¼š</p>
<ul>
<li>OBJECT,Â EMBED,Â VIDEO: æœ€é«˜æƒé‡</li>
<li>SVG,Â IMG,Â CANVAS: é«˜æƒé‡</li>
<li>å…¶ä»–å…ƒç´ : æƒé‡ä¸º 1</li>
</ul>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šåŠ è½½æ—¶é—´è®¡ç®—</strong></p>
<pre><code class="hljs language-ini" lang="ini">getLoadingTime(dom:Â HTMLElement,Â resourceLoadingMap:Â Record&lt;string,Â any&gt;):Â numberÂ {
Â Â // è·å– DOM æ ‡è®°æ—¶é—´
Â Â constÂ <span class="hljs-attr">baseTime</span> =Â getMarkValueByDom(dom)<span class="hljs-comment">;</span>


Â Â // è·å–èµ„æºåŠ è½½æ—¶é—´
Â Â letÂ <span class="hljs-attr">resourceTime</span> =Â <span class="hljs-number">0</span><span class="hljs-comment">;</span>
Â Â ifÂ (RESOURCE_TAG_SET.indexOf(tagType) &gt;=Â 0) {
Â  Â Â // å¤„ç†å›¾ç‰‡ã€è§†é¢‘ç­‰èµ„æº
Â  Â Â constÂ <span class="hljs-attr">resourceTiming</span> = resourceLoadingMap[resourceName]<span class="hljs-comment">;</span>
Â  Â  <span class="hljs-attr">resourceTime</span> = resourceTiming ? resourceTiming.responseEndÂ :Â <span class="hljs-number">0</span><span class="hljs-comment">;</span>
Â  }


Â Â // è¿”å›è¾ƒå¤§å€¼ï¼ˆDOM æ—¶é—´ vs èµ„æºæ—¶é—´ï¼‰
Â Â returnÂ Math.max(resourceTime, baseTime)<span class="hljs-comment">;</span>
}
</code></pre>
<p><strong>ç¬¬å››æ­¥ï¼šFMPå€¼è®¡ç®—</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin">calcValue(resourceLoadingMap: Record&lt;string, any&gt;, isSubPage: boolean =Â <span class="hljs-literal">false</span>): void {
Â Â <span class="hljs-comment">// æ„å»ºå‚è€ƒå…ƒç´ åˆ—è¡¨ï¼ˆè‡³å°‘ 3 ä¸ªå…ƒç´ ï¼‰</span>
Â Â <span class="hljs-keyword">const</span>Â referDoms =Â <span class="hljs-keyword">this</span>.referDoms.length &gt;=Â <span class="hljs-number">3</span>Â 
Â  Â  ?Â <span class="hljs-keyword">this</span>.referDomsÂ 
Â  Â  : [...<span class="hljs-keyword">this</span>.referDoms, ...<span class="hljs-keyword">this</span>.importantDOMs.slice(<span class="hljs-keyword">this</span>.referDoms.length -Â <span class="hljs-number">3</span>)];


Â Â <span class="hljs-comment">// è®¡ç®—æ¯ä¸ªå…ƒç´ çš„åŠ è½½æ—¶é—´</span>
Â Â <span class="hljs-keyword">const</span>Â timings = referDoms.map(dom =&gt;Â <span class="hljs-keyword">this</span>.getLoadingTime(dom, resourceLoadingMap));


Â Â <span class="hljs-comment">// æ’åºæ—¶é—´æ•°ç»„</span>
Â Â <span class="hljs-keyword">const</span>Â sortedTimings = timings.sort((t1, t2) =&gt; t1 - t2);


Â Â <span class="hljs-comment">// è®¡ç®—æœ€ç»ˆå€¼</span>
Â Â <span class="hljs-keyword">const</span>Â info = getMetricNumber(sortedTimings);
Â Â <span class="hljs-keyword">this</span>.value = info.value; Â  Â  Â  Â <span class="hljs-comment">// æœ€åä¸€ä¸ªå…ƒç´ çš„æ—¶é—´ï¼ˆæœ€æ™šå®Œæˆï¼‰</span>
Â Â <span class="hljs-keyword">this</span>.p80Value = info.p80Value; Â <span class="hljs-comment">// P80 ç™¾åˆ†ä½æ—¶é—´</span>
}
</code></pre>
<p><strong>æ–°ç®—æ³•è¯¦ç»†æ­¥éª¤</strong></p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šé…ç½®æŒ‡å®šå…ƒç´ </strong></p>
<pre><code class="hljs language-ini" lang="ini">// é€šè¿‡å…¨å±€é…ç½®æŒ‡å®š FMP ç›®æ ‡å…ƒç´ 
constÂ { <span class="hljs-attr">fmpSelector</span> =Â <span class="hljs-string">""</span>Â } =Â SingleGlobal?.getOptions?.()<span class="hljs-comment">;</span>
</code></pre>
<p>é…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// åˆå§‹åŒ–æ—¶é…ç½®</span>
<span class="hljs-keyword">init</span>({
Â  <span class="hljs-params">fmpSelector</span>:Â '.main<span class="hljs-operator">-</span>content', Â <span class="hljs-comment">// æŒ‡å®šä¸»è¦å†…å®¹åŒºåŸŸ</span>
Â Â <span class="hljs-comment">// æˆ–è€…</span>
Â  <span class="hljs-params">fmpSelector</span>:Â '#hero<span class="hljs-operator">-</span>section', Â <span class="hljs-comment">// æŒ‡å®šé¦–å±åŒºåŸŸ</span>
Â Â <span class="hljs-comment">// æˆ–è€…</span>
Â  <span class="hljs-params">fmpSelector</span>:Â '.product<span class="hljs-operator">-</span>list'Â  Â <span class="hljs-comment">// æŒ‡å®šäº§å“åˆ—è¡¨</span>
});
</code></pre>
<p><strong>ç¬¬äºŒæ­¥ï¼šæŸ¥æ‰¾æŒ‡å®šå…ƒç´ </strong></p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">if</span><span class="hljs-title function_ invoke__">Â </span>(fmpSelector) {
Â Â <span class="hljs-comment">// ä½¿ç”¨ querySelector æŸ¥æ‰¾æŒ‡å®šçš„ DOM å…ƒç´ </span>
Â Â <span class="hljs-keyword">const</span>Â <span class="hljs-variable">$specifiedElÂ </span>= document.<span class="hljs-title function_ invoke__">querySelector</span>(fmpSelector);


Â Â <span class="hljs-keyword">if</span><span class="hljs-title function_ invoke__">Â </span>(<span class="hljs-variable">$specifiedElÂ </span>&amp;&amp;Â <span class="hljs-variable">$specifiedEl</span> <span class="hljs-keyword">instanceof</span> HTMLElement) {
Â  Â Â <span class="hljs-comment">// æ‰¾åˆ°æŒ‡å®šå…ƒç´ ï¼Œè¿›è¡Œåç»­è®¡ç®—</span>
Â  Â  this.specifiedDom =Â <span class="hljs-variable">$specifiedEl</span>;
Â  }
}
</code></pre>
<p>æŸ¥æ‰¾é€»è¾‘ï¼š</p>
<ul>
<li>ä½¿ç”¨document.querySelector()æŸ¥æ‰¾å…ƒç´ </li>
<li>éªŒè¯å…ƒç´ å­˜åœ¨ä¸”ä¸º HTMLElement ç±»å‹</li>
<li>ä¿å­˜å…ƒç´ å¼•ç”¨åˆ°specifiedDom</li>
</ul>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šè®¡ç®—æŒ‡å®šå…ƒç´ çš„åŠ è½½æ—¶é—´</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// è®¡ç®—æŒ‡å®šå…ƒç´ çš„å®Œæ•´åŠ è½½æ—¶é—´</span>
<span class="hljs-keyword">this</span>.specifiedValue =Â <span class="hljs-keyword">this</span>.getLoadingTime(
Â  $specifiedEl,
Â  resourceLoadingMap
);
</code></pre>
<p><strong>åŠ è½½æ—¶é—´è®¡ç®—åŒ…å«ï¼š</strong></p>
<ul>
<li>DOM æ ‡è®°æ—¶é—´</li>
</ul>
<pre><code class="hljs language-ini" lang="ini">// è·å– DOM å…ƒç´ çš„åŸºç¡€æ ‡è®°æ—¶é—´
constÂ <span class="hljs-attr">baseTime</span> =Â getMarkValueByDom(dom)<span class="hljs-comment">;</span>
</code></pre>
<ul>
<li>èµ„æºåŠ è½½æ—¶é—´</li>
</ul>
<pre><code class="hljs language-ini" lang="ini">letÂ <span class="hljs-attr">resourceTime</span> =Â <span class="hljs-number">0</span><span class="hljs-comment">;</span>
// å¤„ç†ç›´æ¥èµ„æºï¼ˆimg, video, embed ç­‰ï¼‰
constÂ <span class="hljs-attr">tagType</span> = dom.tagName.toUpperCase()<span class="hljs-comment">;</span>
ifÂ (RESOURCE_TAG_SET.indexOf(tagType) &gt;=Â 0) {
Â Â constÂ <span class="hljs-attr">resourceName</span> =Â normalizeResourceName((domÂ asÂ any).src)<span class="hljs-comment">;</span>
Â Â constÂ <span class="hljs-attr">resourceTiming</span> = resourceLoadingMap[resourceName]<span class="hljs-comment">;</span>
Â  <span class="hljs-attr">resourceTime</span> = resourceTiming ? resourceTiming.responseEndÂ :Â <span class="hljs-number">0</span><span class="hljs-comment">;</span>
}
// å¤„ç†èƒŒæ™¯å›¾ç‰‡
constÂ <span class="hljs-attr">bgImgUrl</span> =Â getDomBgImg(dom)<span class="hljs-comment">;</span>
ifÂ (isImageUrl(bgImgUrl)) {
Â Â constÂ <span class="hljs-attr">resourceName</span> =Â normalizeResourceName(bgImgUrl)<span class="hljs-comment">;</span>
Â Â constÂ <span class="hljs-attr">resourceTiming</span> = resourceLoadingMap[resourceName]<span class="hljs-comment">;</span>
Â  <span class="hljs-attr">resourceTime</span> = resourceTiming ? resourceTiming.responseEndÂ :Â <span class="hljs-number">0</span><span class="hljs-comment">;</span>
}
</code></pre>
<ul>
<li>ç»¼åˆæ—¶é—´è®¡ç®—</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¿”å› DOM æ—¶é—´å’Œèµ„æºæ—¶é—´çš„è¾ƒå¤§å€¼</span>
<span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(resourceTime, baseTime);
</code></pre>
<p><strong>ç¬¬å››æ­¥ï¼šFMPå€¼ç¡®å®š</strong></p>
<pre><code class="hljs language-ini" lang="ini">// æ ¹æ®æ˜¯å¦æœ‰æŒ‡å®šå€¼æ¥å†³å®šä½¿ç”¨å“ªä¸ª FMP å€¼
ifÂ (<span class="hljs-attr">specifiedValue</span> ===Â <span class="hljs-number">0</span>) {
Â Â // å¦‚æœæ²¡æœ‰æŒ‡å®šå€¼ï¼Œå›é€€åˆ°ä¼ ç»Ÿç®—æ³•
Â  <span class="hljs-attr">fmp</span> = isSubPage ? value - diffTime : value<span class="hljs-comment">;</span>
}Â elseÂ {
Â Â // å¦‚æœæœ‰æŒ‡å®šå€¼ï¼Œä½¿ç”¨æŒ‡å®šå€¼
Â  <span class="hljs-attr">fmp</span> = isSubPage ? specifiedValue - diffTime : specifiedValue<span class="hljs-comment">;</span>
}
</code></pre>
<p>å†³ç­–é€»è¾‘ï¼š</p>
<ul>
<li>å¦‚æœÂ specifiedValue &gt; 0ï¼šä½¿ç”¨æŒ‡å®šå…ƒç´ çš„åŠ è½½æ—¶é—´</li>
<li>å¦‚æœÂ specifiedValue === 0ï¼šå›é€€åˆ°ä¼ ç»Ÿç®—æ³•</li>
</ul>
<p><strong>ç¬¬äº”æ­¥ï¼šå­é¡µé¢æ—¶é—´è°ƒæ•´</strong></p>
<pre><code class="hljs language-ini" lang="ini">// å­é¡µé¢çš„ FMP å€¼éœ€è¦å‡å»æ—¶é—´åç§»
ifÂ (isSubPage) {
Â  <span class="hljs-attr">fmp</span> = specifiedValue - diffTime<span class="hljs-comment">;</span>
Â Â // <span class="hljs-attr">diffTime</span> = startSubTime - initTime
}
</code></pre>
<p><strong>æ–°ç®—æ³•çš„ä¼˜åŠ¿</strong></p>
<p><strong>ç²¾ç¡®æ€§æ›´é«˜</strong></p>
<ul>
<li>ç›´æ¥é’ˆå¯¹ä¸šåŠ¡å…³é”®å…ƒç´ </li>
<li>é¿å…æƒé‡è®¡ç®—çš„è¯¯å·®</li>
<li>æ›´è´´è¿‘ä¸šåŠ¡éœ€æ±‚</li>
</ul>
<p><strong>å¯æ§æ€§å¼º</strong></p>
<ul>
<li>å¼€å‘è€…å¯ä»¥æŒ‡å®šå…³é”®å…ƒç´ </li>
<li>å¯ä»¥æ ¹æ®ä¸šåŠ¡åœºæ™¯è°ƒæ•´</li>
<li>é¿å…ç®—æ³•è‡ªåŠ¨é€‰æ‹©çš„åå·®</li>
</ul>
<p><strong>è®¡ç®—ç®€å•</strong></p>
<ul>
<li>åªéœ€è¦è®¡ç®—ä¸€ä¸ªå…ƒç´ </li>
<li>ä¸éœ€è¦å¤æ‚çš„æƒé‡è®¡ç®—</li>
<li>æ€§èƒ½å¼€é”€æ›´å°</li>
</ul>
<p><strong>ä¸šåŠ¡å¯¼å‘</strong></p>
<ul>
<li>ç›´æ¥åæ˜ ä¸šåŠ¡å…³é”®å†…å®¹çš„åŠ è½½æ—¶é—´</li>
<li>æ›´ç¬¦åˆç”¨æˆ·ä½“éªŒè¯„ä¼°éœ€æ±‚</li>
<li>ä¾¿äºæ€§èƒ½ä¼˜åŒ–æŒ‡å¯¼</li>
</ul>
<h3 data-id="heading-6">3.4å…³é”®ç®—æ³•</h3>
<p><strong>P80 ç™¾åˆ†ä½è®¡ç®—</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span>Â <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">getMetricNumber</span>(<span class="hljs-params">sortedTimings: number[]</span>) {
Â Â <span class="hljs-keyword">const</span>Â value = sortedTimings[sortedTimings.<span class="hljs-property">length</span>Â -Â <span class="hljs-number">1</span>]; Â <span class="hljs-comment">// æœ€åä¸€ä¸ªï¼ˆæœ€æ™šï¼‰</span>
Â Â <span class="hljs-keyword">const</span>Â p80Value = sortedTimings[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((sortedTimings.<span class="hljs-property">length</span>Â -Â <span class="hljs-number">1</span>) *Â <span class="hljs-number">0.8</span>)]; Â <span class="hljs-comment">// P80</span>
Â Â <span class="hljs-keyword">return</span>Â { value, p80Value };
}
</code></pre>
<p><strong>å…ƒç´ ç±»å‹æƒé‡</strong></p>
<pre><code class="hljs language-objectivec" lang="objectivec"><span class="hljs-keyword">const</span>Â IMPORTANT_ELEMENT_WEIGHT_MAP = {
Â  SVG: IElementWeight.High, Â  Â  Â <span class="hljs-comment">// é«˜æƒé‡</span>
Â  IMG: IElementWeight.High, Â  Â  Â <span class="hljs-comment">// é«˜æƒé‡</span>
Â Â <span class="hljs-built_in">CANVAS</span>: IElementWeight.High, Â Â <span class="hljs-comment">// é«˜æƒé‡</span>
Â  OBJECT: IElementWeight.Highest,Â <span class="hljs-comment">// æœ€é«˜æƒé‡</span>
Â  EMBED: IElementWeight.Highest,Â <span class="hljs-comment">// æœ€é«˜æƒé‡</span>
Â  VIDEO: IElementWeight.Highest Â Â <span class="hljs-comment">// æœ€é«˜æƒé‡</span>
};
</code></pre>
<h2 data-id="heading-7">å››ã€æ—¶é—´æ ‡è®°æœºåˆ¶</h2>
<h3 data-id="heading-8">4.1DOMå˜åŒ–ç›‘å¬</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// MutationObserver ç›‘å¬ DOM å˜åŒ–</span>
<span class="hljs-keyword">private</span>Â observer =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">MutationObserver</span>(<span class="hljs-function">(<span class="hljs-params">mutations = []</span>) =&gt;</span>Â {
Â Â <span class="hljs-keyword">const</span>Â now =Â <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleChange</span>(mutations, now);
});
</code></pre>
<h3 data-id="heading-9">4.2æ—¶é—´æ ‡è®°</h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ä¸ºæ¯ä¸ª DOM å˜åŒ–åˆ›å»ºæ€§èƒ½æ ‡è®°</span>
<span class="hljs-selector-tag">mark</span>(count); Â <span class="hljs-comment">// åˆ›å»º performance.mark(`mutation_pc_${count}`)</span>
<span class="hljs-comment">// ä¸º DOM å…ƒç´ è®¾ç½®æ ‡è®°</span>
<span class="hljs-built_in">setDataAttr</span>(elem,Â TAG_KEY,Â `${mutationCount}`);
</code></pre>
<h3 data-id="heading-10">4.3æ ‡è®°å€¼è·å–</h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æ ¹æ® DOM å…ƒç´ è·å–æ ‡è®°æ—¶é—´</span>
<span class="hljs-built_in">getMarkValueByDom</span>(dom: HTMLElement) {
Â Â constÂ markValue =Â <span class="hljs-built_in">getDataAttr</span>(dom,Â TAG_KEY);
Â Â returnÂ <span class="hljs-built_in">getMarkValue</span>(parseInt(markValue));
}
</code></pre>
<h2 data-id="heading-11">äº”ã€èµ„æºåŠ è½½è€ƒè™‘</h2>
<h3 data-id="heading-12">5.1èµ„æºç±»å‹è¯†åˆ«</h3>
<p><strong>å›¾ç‰‡èµ„æº</strong>:Â <img src="" loading="lazy"/>Â æ ‡ç­¾çš„Â srcå±æ€§</p>
<p><strong>è§†é¢‘èµ„æº</strong>:Â Â æ ‡ç­¾çš„Â srcå±æ€§</p>
<p><strong>èƒŒæ™¯å›¾ç‰‡</strong>: CSSÂ background-imageå±æ€§</p>
<p><strong>åµŒå…¥èµ„æº</strong>:Â ,Â æ ‡ç­¾</p><p/>
<h3 data-id="heading-13">5.2èµ„æºæ—¶é—´è·å–</h3>
<pre><code class="hljs language-ini" lang="ini">// ä» Performance API è·å–èµ„æºåŠ è½½æ—¶é—´
constÂ <span class="hljs-attr">resourceTiming</span> = resourceLoadingMap[resourceName]<span class="hljs-comment">;</span>
constÂ <span class="hljs-attr">resourceTime</span> = resourceTiming ? resourceTiming.responseEndÂ :Â <span class="hljs-number">0</span><span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-14">5.3ç»¼åˆæ—¶é—´è®¡ç®—</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// DOM æ—¶é—´å’Œèµ„æºæ—¶é—´çš„è¾ƒå¤§å€¼</span>
<span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(resourceTime, baseTime);
</code></pre>
<h2 data-id="heading-15">å…­ã€å­é¡µé¢æ”¯æŒ</h2>
<h3 data-id="heading-16">6.1æ—¶é—´åç§»å¤„ç†</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å­é¡µé¢ä»è°ƒç”¨ send æ–¹æ³•å¼€å§‹è®¡æ—¶</span>
<span class="hljs-keyword">const</span>Â diffTime =Â <span class="hljs-keyword">this</span>.startSubTime -Â <span class="hljs-keyword">this</span>.initTime;
<span class="hljs-comment">// å­é¡µé¢åªç»Ÿè®¡å¼€å§‹æ—¶é—´ä¹‹åçš„èµ„æº</span>
<span class="hljs-keyword">if</span>Â (!isSubPage || resource.startTime &gt; diffTime) {
Â  resourceLoadingMap[resourceName] = resource;
}
</code></pre>
<h3 data-id="heading-17">6.2FMPå€¼è°ƒæ•´</h3>
<pre><code class="hljs language-ini" lang="ini">// å­é¡µé¢çš„ FMP å€¼éœ€è¦å‡å»æ—¶é—´åç§»
<span class="hljs-attr">fmp</span> = isSubPage ? value - diffTime : value<span class="hljs-comment">;</span>
</code></pre>
<h2 data-id="heading-18">ä¸ƒã€FMPçš„æ ¸å¿ƒä¼˜åŠ¿</h2>
<h3 data-id="heading-19">7.1ç”¨æˆ·æ„ŸçŸ¥å¯¼å‘</h3>
<p>FMP æœ€å¤§çš„ä¼˜åŠ¿åœ¨äºå®ƒçœŸæ­£å…³æ³¨ç”¨æˆ·çš„å®é™…ä½“éªŒï¼š</p>
<ul>
<li><strong>å†…å®¹ä»·å€¼ä¼˜å…ˆ</strong>ï¼šåªè®¡ç®—å¯¹ç”¨æˆ·æœ‰æ„ä¹‰çš„å†…å®¹æ¸²æŸ“æ—¶é—´</li>
<li><strong>æ™ºèƒ½æƒé‡è¯„ä¼°</strong>ï¼šæ ¹æ®å…ƒç´ çš„é‡è¦æ€§å’Œå¯è§æ€§è¿›è¡Œå·®å¼‚åŒ–è®¡ç®—</li>
<li><strong>çœŸå®ä½“éªŒæ˜ å°„</strong>ï¼šæ›´è´´è¿‘ç”¨æˆ·çš„å®é™…æ„ŸçŸ¥ï¼Œè€ŒéæŠ€æœ¯å±‚é¢çš„æŒ‡æ ‡</li>
</ul>
<h3 data-id="heading-20">7.2å¤šç»´åº¦è®¡ç®—ä½“ç³»</h3>
<p>FMP é‡‡ç”¨äº†æ›´åŠ å…¨é¢çš„è®¡ç®—æ–¹å¼ï¼š</p>
<ul>
<li><strong>å…ƒç´ æƒé‡åˆ†æ</strong>ï¼šç»¼åˆè€ƒè™‘å…ƒç´ ç±»å‹å’Œæ¸²æŸ“é¢ç§¯çš„å½±å“</li>
<li><strong>èµ„æºåŠ è½½å…³è”</strong>ï¼šå°†é™æ€èµ„æºåŠ è½½æ—¶é—´çº³å…¥è®¡ç®—èŒƒå›´</li>
<li><strong>ç®—æ³•å¯¹æ¯”éªŒè¯</strong>ï¼šæ”¯æŒå¤šç§ç®—æ³•å¹¶è¡Œè®¡ç®—ï¼Œç¡®ä¿ç»“æœå‡†ç¡®æ€§</li>
</ul>
<h3 data-id="heading-21">7.3é«˜ç²¾åº¦æµ‹é‡</h3>
<p>FMP åœ¨æµ‹é‡ç²¾åº¦æ–¹é¢è¡¨ç°çªå‡ºï¼š</p>
<ul>
<li><strong>DOM å˜åŒ–è¿½è¸ª</strong>ï¼šåŸºäºå®é™… DOM ç»“æ„å˜åŒ–çš„æ—¶é—´ç‚¹</li>
<li><strong>API æ•°æ®èåˆ</strong>ï¼šç»“åˆ Performance API æä¾›çš„è¯¦ç»†æ•°æ®</li>
<li><strong>ç»Ÿè®¡åˆ†ææ”¯æŒ</strong>ï¼šæ”¯æŒ P80 ç™¾åˆ†ä½ç­‰å¤šç§ç»Ÿè®¡æŒ‡æ ‡ï¼Œä¾¿äºæ€§èƒ½åˆ†æ</li>
</ul>
<h2 data-id="heading-22">å…«ã€FMPçš„å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-23">8.1æ€§èƒ½ç›‘æ§å®è·µ</h3>
<p>FMP åœ¨æ€§èƒ½ç›‘æ§ä¸­å‘æŒ¥ç€é‡è¦ä½œç”¨ï¼š</p>
<ul>
<li><strong>å…³é”®æŒ‡æ ‡è¿½è¸ª</strong>ï¼šå®æ—¶ç›‘æ§é¡µé¢é¦–æ¬¡æœ‰æ„ä¹‰å†…å®¹çš„æ¸²æŸ“æ—¶é—´</li>
<li><strong>ç“¶é¢ˆè¯†åˆ«</strong>ï¼šå¿«é€Ÿå®šä½æ€§èƒ½ç“¶é¢ˆå’Œæ½œåœ¨çš„ä¼˜åŒ–ç‚¹</li>
<li><strong>è¶‹åŠ¿åˆ†æ</strong>ï¼šé€šè¿‡å†å²æ•°æ®äº†è§£æ€§èƒ½å˜åŒ–è¶‹åŠ¿</li>
</ul>
<h3 data-id="heading-24">8.2ç”¨æˆ·ä½“éªŒè¯„ä¼°</h3>
<p>FMP ä¸ºäº§å“å›¢é˜Ÿæä¾›äº†ç”¨æˆ·è§†è§’çš„æ€§èƒ½è¯„ä¼°ï¼š</p>
<ul>
<li><strong>çœŸå®æ„ŸçŸ¥æµ‹é‡</strong>ï¼šè¯„ä¼°ç”¨æˆ·å®é™…æ„Ÿå—åˆ°çš„é¡µé¢åŠ è½½é€Ÿåº¦</li>
<li><strong>ç«å“å¯¹æ¯”åˆ†æ</strong>ï¼šå¯¹æ¯”ä¸åŒé¡µé¢æˆ–äº§å“çš„æ€§èƒ½è¡¨ç°</li>
<li><strong>ç”¨æˆ·æ»¡æ„åº¦å…³è”</strong>ï¼šå°†æŠ€æœ¯æŒ‡æ ‡ä¸ç”¨æˆ·æ»¡æ„åº¦å»ºç«‹å…³è”</li>
</ul>
<h3 data-id="heading-25">8.3ä¼˜åŒ–æŒ‡å¯¼ä»·å€¼</h3>
<p>FMP æ•°æ®ä¸ºæ€§èƒ½ä¼˜åŒ–æä¾›äº†æ˜ç¡®çš„æ–¹å‘ï¼š</p>
<ul>
<li><strong>èµ„æºä¼˜åŒ–ç­–ç•¥</strong>ï¼šæŒ‡å¯¼é™æ€èµ„æºåŠ è½½é¡ºåºå’Œæ–¹å¼çš„ä¼˜åŒ–</li>
<li><strong>æ¸²æŸ“è·¯å¾„ä¼˜åŒ–</strong>ï¼šå¸®åŠ©ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„ï¼Œæå‡é¦–å±ä½“éªŒ</li>
<li><strong>é‡åŒ–æ•ˆæœè¯„ä¼°</strong>ï¼šä¸ºä¼˜åŒ–æ•ˆæœæä¾›å¯é‡åŒ–çš„è¯„ä¼°æ ‡å‡†</li>
</ul>
<h2 data-id="heading-26">ä¹ã€æ€»ç»“</h2>
<p>é€šè¿‡è¿™æ¬¡æ·±å…¥åˆ†æï¼Œæˆ‘å¯¹ FMP æœ‰äº†æ›´å…¨é¢çš„è®¤è¯†ã€‚FMP é€šè¿‡ç§‘å­¦çš„ç®—æ³•è®¾è®¡ï¼Œèƒ½å¤Ÿå‡†ç¡®åæ˜ ç”¨æˆ·æ„ŸçŸ¥çš„é¡µé¢åŠ è½½æ€§èƒ½ï¼Œæ˜¯å‰ç«¯æ€§èƒ½ç›‘æ§çš„é‡è¦æŒ‡æ ‡ã€‚</p>
<p>å®ƒä¸ä»…å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£é¡µé¢åŠ è½½è¿‡ç¨‹ï¼Œæ›´é‡è¦çš„æ˜¯ä¸ºæ€§èƒ½ä¼˜åŒ–æä¾›äº†ç§‘å­¦çš„ä¾æ®ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œåˆç†è¿ç”¨ FMP æŒ‡æ ‡ï¼Œèƒ½å¤Ÿæœ‰æ•ˆæå‡ç”¨æˆ·ä½“éªŒï¼Œå®ç°çœŸæ­£çš„"ç§’å¼€"æ•ˆæœã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¯¹æ­£åœ¨å…³æ³¨å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„åŒå­¦æœ‰æ‰€å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶åˆ†äº«è‡ªå·±çš„å®è·µç»éªŒã€‚</p>
<h3 data-id="heading-27">å¾€æœŸå›é¡¾</h3>
<p>1.Â Dragonboatç»Ÿä¸€å­˜å‚¨LogDBå®ç°åˆ†æï½œå¾—ç‰©æŠ€æœ¯</p>
<p>2.Â ä»æ•°å­—åˆ°ç‰ˆé¢ï¼šå¾—ç‰©æ•°æ®äº§å“é‡Œæ•°å­—æ ¼å¼åŒ–çš„é‚£äº›äº‹</p>
<p>3.Â ä¸€æ–‡è§£æå¾—ç‰©è‡ªå»º Redis æœ€æ–°æŠ€æœ¯æ¼”è¿›</p>
<p>4.Â Golang HTTPè¯·æ±‚è¶…æ—¶ä¸é‡è¯•ï¼šæ„å»ºé«˜å¯é ç½‘ç»œè¯·æ±‚ï½œå¾—ç‰©æŠ€æœ¯</p>
<p>5.Â RNä¸hawkç¢°æ’çš„ç«èŠ±ä¹‹C++å¼‚å¸¸æ•è·ï½œå¾—ç‰©æŠ€æœ¯</p>
<h3 data-id="heading-28">æ–‡ /é˜¿åˆ—</h3>
<p>å…³æ³¨å¾—ç‰©æŠ€æœ¯ï¼Œæ¯å‘¨æ›´æ–°æŠ€æœ¯å¹²è´§</p>
<p>è¦æ˜¯è§‰å¾—æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œæ¬¢è¿è¯„è®ºè½¬å‘ç‚¹èµï½</p>
<p>æœªç»å¾—ç‰©æŠ€æœ¯è®¸å¯ä¸¥ç¦è½¬è½½ï¼Œå¦åˆ™ä¾æ³•è¿½ç©¶æ³•å¾‹è´£ä»»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[wordå¯¹æ¯”å·¥å…·ä»å…¥é—¨åˆ°å‡ºé—¨]]></title>    <link>https://juejin.cn/post/7578777952726810658</link>    <guid>https://juejin.cn/post/7578777952726810658</guid>    <pubDate>2025-12-02T02:35:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578777952726810658" data-draft-id="7578734725301272628" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="wordå¯¹æ¯”å·¥å…·ä»å…¥é—¨åˆ°å‡ºé—¨"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-02T02:35:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‹å¤§å®‡_"/> <meta itemprop="url" content="https://juejin.cn/user/1412191432225480"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            wordå¯¹æ¯”å·¥å…·ä»å…¥é—¨åˆ°å‡ºé—¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1412191432225480/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‹å¤§å®‡_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T02:35:30.000Z" title="Tue Dec 02 2025 02:35:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="" data-highlight-key="vs">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#000}.hljs-comment,.hljs-quote,.hljs-variable{color:green}.hljs-built_in,.hljs-keyword,.hljs-name,.hljs-selector-tag,.hljs-tag{color:#00f}.hljs-addition,.hljs-attribute,.hljs-literal,.hljs-section,.hljs-string,.hljs-template-tag,.hljs-template-variable,.hljs-title,.hljs-type{color:#a31515}.hljs-deletion,.hljs-meta,.hljs-selector-attr,.hljs-selector-pseudo{color:#2b91af}.hljs-doctag{color:grey}.hljs-attr{color:red}.hljs-bullet,.hljs-link,.hljs-symbol{color:#00b0e8}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Wordå¯¹æ¯”</h2>
<blockquote>
<p>æœ¬æ–‡ï¼Œæˆ‘ä»¬å°†å®ç°ä¸€ä¸ªWordå¯¹æ¯”å·¥å…·</p>
</blockquote>
<h3 data-id="heading-1">ğŸŒ°demo</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/645d79b9d6f34f7eba4fbe543795a7b4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546L5aSn5a6HXw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765247730&amp;x-signature=4A7rZ7Asfg5moWsw7JrJ%2Fj07c%2FI%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">æ€è·¯</h3>
<h4 data-id="heading-3">Wordæ–‡æ¡£è§£æ</h4>
<p>Wordçš„æœ¬è´¨æ˜¯XMLå‹ç¼©åŒ…ï¼Œåœ¨æˆ‘ä»¬çš„diffè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åªå…³å¿ƒçº¯æ–‡æœ¬çš„å˜åŒ–ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å…ˆå°†wordè¿›è¡Œè§£æè½¬åŒ–ã€‚</p>
<p>æœ¬æ–‡å€ŸåŠ©mammoth.jså®Œæˆ</p>
<h4 data-id="heading-4">æ–‡æœ¬tokenåŒ–</h4>
<p>æ ¹æ®ä¸åŒçš„ç²’åº¦åšåˆ†è¯</p>
<h4 data-id="heading-5">Diffç®—æ³•æ ¸å¿ƒ</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Flongest-common-subsequence%2Fdescription%2F" target="_blank" title="https://leetcode.cn/problems/longest-common-subsequence/description/" ref="nofollow noopener noreferrer">LCSæœ€é•¿å…¬å…±å­åºåˆ—ç®—æ³•</a></p>
<h4 data-id="heading-6">åŒæ å¯¹æ¯”</h4>
<p>æœ¬æ–‡ä½¿ç”¨antdç»„ä»¶åº“</p>
<h3 data-id="heading-7">å®ç°</h3>
<h4 data-id="heading-8">æ–‡æ¡£è§£æ</h4>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬é€šè¿‡mammothå°†wordè½¬åŒ–ä¸ºstring</p>
<pre><code class="hljs language-jsx" lang="jsx">  <span class="hljs-comment">// ä¸Šä¼ word å¹¶æå–æ–‡æœ¬</span>
  <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleUpload</span>(<span class="hljs-params">file: File, type: <span class="hljs-string">'old'</span> | <span class="hljs-string">'new'</span></span>) {
    <span class="hljs-keyword">const</span> arrayBuffer = <span class="hljs-keyword">await</span> file.<span class="hljs-title function_">arrayBuffer</span>();
    <span class="hljs-comment">// mammith.extractRawTextä»docxä¸­æå–çº¯æ–‡æœ¬</span>
    <span class="hljs-keyword">const</span> { value } = <span class="hljs-keyword">await</span> mammoth.<span class="hljs-title function_">extractRawText</span>({ arrayBuffer });
    <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'old'</span>) {
      <span class="hljs-title function_">setOldText</span>(value);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title function_">setNewText</span>(value);
    }
  }
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/952acd4a2afb4b8d823cc85ff536c926~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546L5aSn5a6HXw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765247730&amp;x-signature=9iznIMghdiD4AkghdS3u4aj%2Bd%2BY%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-9">åˆ†è¯</h4>
<p>æŒ‰ç…§ä¸åŒçš„ç²’åº¦ï¼Œå°†stringåˆ’åˆ†</p>
<pre><code class="hljs language-jsx" lang="jsx">  <span class="hljs-comment">// åˆ†è¯</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">tokenize</span>(<span class="hljs-params">text: string, mode: string</span>): string[] {
    <span class="hljs-comment">// æŒ‰è¡Œåˆ†ï¼ŒæŒ‰æ¢è¡Œç¬¦æ‹†åˆ†ä¸ºæ•°ç»„</span>
    <span class="hljs-keyword">if</span> (mode === <span class="hljs-string">'line'</span>) <span class="hljs-keyword">return</span> text.<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/\r?\n/</span>);
    <span class="hljs-comment">// æŒ‰å­—ç¬¦åˆ†ï¼ŒæŠŠå­—ç¬¦ä¸²æ‹†åˆ†æˆå•ä¸ªå­—ç¬¦æ•°ç»„</span>
    <span class="hljs-keyword">if</span> (mode === <span class="hljs-string">'char'</span>) <span class="hljs-keyword">return</span> text.<span class="hljs-title function_">split</span>(<span class="hljs-string">''</span>);
    <span class="hljs-comment">//ç”¨æ­£åˆ™å°†æ–‡æœ¬åˆ‡æˆä¸­æ–‡å•å­—ã€è‹±æ–‡å•è¯ã€å…¶ä»–å•ä¸ªç¬¦å·</span>
    <span class="hljs-keyword">return</span> text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/[\u4e00-\u9fa5]|\w+|[^\w\u4e00-\u9fa5]/g</span>) || [];
  }
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4f992080b9d4f9ca07d67f7e3166f62~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546L5aSn5a6HXw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765247730&amp;x-signature=HWu7FOMXuMdpncJYVamoC3yGCnU%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-10">Diff</h4>
<h5 data-id="heading-11">æœ€é•¿å…¬å…±å­åºåˆ—</h5>
<pre><code class="hljs language-jsx" lang="jsx">  <span class="hljs-comment">// LCSæ„å»ºDP</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">buildLCS</span>(<span class="hljs-params">a: string[], b: string[]</span>) {
    <span class="hljs-comment">// æ„å»ºäºŒç»´æ•°ç»„ï¼Œå¹¶å°†å…¶åˆå§‹åŒ–ä¸º0</span>
    <span class="hljs-comment">// dp[i][j]è¡¨ç¤ºä»a[i:]ä¸b[j:]çš„æœ€é•¿å…¬å…±å­åºåˆ—é•¿åº¦</span>
    <span class="hljs-keyword">const</span> dp = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: a.<span class="hljs-property">length</span> + <span class="hljs-number">1</span> }, <span class="hljs-function">() =&gt;</span>
      <span class="hljs-title class_">Array</span>(b.<span class="hljs-property">length</span> + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>)
    );

    <span class="hljs-comment">// å€’åºå¡«å……dp</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = a.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = b.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; j &gt;= <span class="hljs-number">0</span>; j--) {
        <span class="hljs-keyword">if</span> (a[i] === b[j]) {
          dp[i][j] = dp[i + <span class="hljs-number">1</span>][j + <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;
        } <span class="hljs-keyword">else</span> {
          dp[i][j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(dp[i + <span class="hljs-number">1</span>][j], dp[i][j + <span class="hljs-number">1</span>]);
        }
      }
    }

    <span class="hljs-keyword">return</span> dp;
  }
</code></pre>
<h5 data-id="heading-12">å·®å¼‚è®¡ç®—</h5>
<p>åŸºäºäºŒç»´æ•°ç»„è®¡ç®—æ–‡æœ¬çš„å·®å¼‚ï¼Œæ ‡è®°æ–°å¢ã€åˆ é™¤ã€ç›¸åŒçš„éƒ¨åˆ†</p>
<ul>
<li>è®¾ç½®ä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«æŒ‡å‘æ–°æ—§æ–‡æœ¬</li>
<li>å½“å…ƒç´ ç›¸åŒï¼Œæ ‡è®°ä¸ºequalï¼Œä¸¤ä¸ªæŒ‡é’ˆåŒæ—¶å‘å‰</li>
<li>å½“æ–°æ–‡æœ¬è¿˜æœ‰å‰©ä½™ï¼Œæ—§æ–‡æœ¬å·²ç»éå†å®Œï¼Œæ’å…¥æ–°å…ƒç´ </li>
<li>å½“ä¸æ»¡è¶³æ’å…¥æ¡ä»¶ï¼Œä¸ºåˆ é™¤æ—§å…ƒç´ </li>
</ul>
<pre><code class="hljs language-jsx" lang="jsx">  <span class="hljs-comment">// å¾—åˆ°diffç»“æ„</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">diffTokens</span>(<span class="hljs-params">a: string[], b: string[]</span>): <span class="hljs-title class_">DiffPart</span>[] {
    <span class="hljs-comment">//æ„å»ºæ–°æ—§å†…å®¹dpæ•°ç»„</span>
    <span class="hljs-keyword">const</span> dp = <span class="hljs-title function_">buildLCS</span>(a, b);
    <span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>,
      j = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-attr">result</span>: <span class="hljs-title class_">DiffPart</span>[] = [];

    <span class="hljs-comment">// ä¾¿åˆ©æ–°æ—§å†…å®¹</span>
    <span class="hljs-keyword">while</span> (i &lt; a.<span class="hljs-property">length</span> &amp;&amp; j &lt; b.<span class="hljs-property">length</span>) {
      <span class="hljs-comment">//è‹¥å½“å‰tokenç›¸ç­‰ï¼Œåˆ™è®°å½•ä¸‹æ¥å¹¶ç§»åŠ¨i j</span>
      <span class="hljs-keyword">if</span> (i &lt; a.<span class="hljs-property">length</span> &amp;&amp; j &lt; b.<span class="hljs-property">length</span> &amp;&amp; a[i] === b[j]) {
        result.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'equal'</span>, <span class="hljs-attr">text</span>: a[i] });
        i++;
        j++;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (
        j &lt; b.<span class="hljs-property">length</span> &amp;&amp;
        (i === a.<span class="hljs-property">length</span> || dp[i][j + <span class="hljs-number">1</span>] &gt;= dp[i + <span class="hljs-number">1</span>][j])
      ) {
        result.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'insert'</span>, <span class="hljs-attr">text</span>: b[j] });
        j++;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i &lt; a.<span class="hljs-property">length</span>) {
        result.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'delete'</span>, <span class="hljs-attr">text</span>: a[i] });
        i++;
      }
    }
    <span class="hljs-keyword">return</span> result;
  }
</code></pre>
<h5 data-id="heading-13">æ•°æ®æµåŠ¨ğŸŒ°</h5>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// æ—§æ–‡æœ¬</span>
<span class="hljs-keyword">const</span> oldText = <span class="hljs-string">"ä»Šå¤©å¤©æ°”å¾ˆå¥½ï¼Œæˆ‘ä»¬å»å…¬å›­æ•£æ­¥å§ã€‚"</span>;
<span class="hljs-comment">// æ–°æ–‡æœ¬  </span>
<span class="hljs-keyword">const</span> newText = <span class="hljs-string">"ä»Šå¤©å¤©æ°”ä¸é”™ï¼Œæˆ‘ä»¬å»å±±ä¸Šå¾’æ­¥å§ï¼Œé¡ºä¾¿çœ‹çœ‹é£æ™¯ã€‚"</span>;
<span class="hljs-comment">// å¯¹æ¯”ç²’åº¦</span>
<span class="hljs-keyword">const</span> granularity = <span class="hljs-string">"word"</span>;
</code></pre>
<p>åˆ†è¯</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// æ—§æ–‡æœ¬åˆ†è¯ç»“æœ</span>
<span class="hljs-keyword">const</span> oldTokens = <span class="hljs-title function_">tokenize</span>(<span class="hljs-string">"ä»Šå¤©å¤©æ°”å¾ˆå¥½ï¼Œæˆ‘ä»¬å»å…¬å›­æ•£æ­¥å§ã€‚"</span>, <span class="hljs-string">"word"</span>);
<span class="hljs-comment">// ç»“æœ: ["ä»Šå¤©", "å¤©æ°”", "å¾ˆ", "å¥½", "ï¼Œ", "æˆ‘ä»¬", "å»", "å…¬å›­", "æ•£æ­¥", "å§", "ã€‚"]</span>

<span class="hljs-comment">// æ–°æ–‡æœ¬åˆ†è¯ç»“æœ</span>
<span class="hljs-keyword">const</span> newTokens = <span class="hljs-title function_">tokenize</span>(<span class="hljs-string">"ä»Šå¤©å¤©æ°”ä¸é”™ï¼Œæˆ‘ä»¬å»å±±ä¸Šå¾’æ­¥å§ï¼Œé¡ºä¾¿çœ‹çœ‹é£æ™¯ã€‚"</span>, <span class="hljs-string">"word"</span>); 
<span class="hljs-comment">// ç»“æœ: ["ä»Šå¤©", "å¤©æ°”", "ä¸", "é”™", "ï¼Œ", "æˆ‘ä»¬", "å»", "å±±ä¸Š", "å¾’æ­¥", "å§", "ï¼Œ", "é¡ºä¾¿", "çœ‹çœ‹", "é£æ™¯", "ã€‚"]</span>
</code></pre>
<p>æ„å»ºLCS</p>
<pre><code class="hljs language-jsx" lang="jsx">oldTokens = [<span class="hljs-string">"ä»Šå¤©"</span>, <span class="hljs-string">"å¤©æ°”"</span>, <span class="hljs-string">"å¾ˆ"</span>, <span class="hljs-string">"å¥½"</span>, <span class="hljs-string">"ï¼Œ"</span>, <span class="hljs-string">"æˆ‘ä»¬"</span>, <span class="hljs-string">"å»"</span>, <span class="hljs-string">"å…¬å›­"</span>, <span class="hljs-string">"æ•£æ­¥"</span>, <span class="hljs-string">"å§"</span>, <span class="hljs-string">"ã€‚"</span>]
newTokens = [<span class="hljs-string">"ä»Šå¤©"</span>, <span class="hljs-string">"å¤©æ°”"</span>, <span class="hljs-string">"ä¸"</span>, <span class="hljs-string">"é”™"</span>, <span class="hljs-string">"ï¼Œ"</span>, <span class="hljs-string">"æˆ‘ä»¬"</span>, <span class="hljs-string">"å»"</span>, <span class="hljs-string">"å±±ä¸Š"</span>, <span class="hljs-string">"å¾’æ­¥"</span>, <span class="hljs-string">"å§"</span>, <span class="hljs-string">"ï¼Œ"</span>, <span class="hljs-string">"é¡ºä¾¿"</span>, <span class="hljs-string">"çœ‹çœ‹"</span>, <span class="hljs-string">"é£æ™¯"</span>, <span class="hljs-string">"ã€‚"</span>]
</code></pre>
<p>Diff</p>
<pre><code class="hljs language-jsx" lang="jsx">[
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'equal'</span>,  <span class="hljs-attr">text</span>: <span class="hljs-string">'ä»Šå¤©'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'equal'</span>,  <span class="hljs-attr">text</span>: <span class="hljs-string">'å¤©æ°”'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'delete'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'å¾ˆ'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'delete'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'å¥½'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'equal'</span>,  <span class="hljs-attr">text</span>: <span class="hljs-string">'ï¼Œ'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'equal'</span>,  <span class="hljs-attr">text</span>: <span class="hljs-string">'æˆ‘ä»¬'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'equal'</span>,  <span class="hljs-attr">text</span>: <span class="hljs-string">'å»'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'insert'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'å±±ä¸Š'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'delete'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'å…¬å›­'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'insert'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'å¾’æ­¥'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'equal'</span>,  <span class="hljs-attr">text</span>: <span class="hljs-string">'å§'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'insert'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'ï¼Œ'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'insert'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'é¡ºä¾¿'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'insert'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'çœ‹çœ‹'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'insert'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'é£æ™¯'</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">'equal'</span>,  <span class="hljs-attr">text</span>: <span class="hljs-string">'ã€‚'</span> }
]
</code></pre>
<h4 data-id="heading-14">å®Œæ•´ä»£ç </h4>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">Upload</span>,
  <span class="hljs-title class_">Button</span>,
  <span class="hljs-title class_">Row</span>,
  <span class="hljs-title class_">Col</span>,
  <span class="hljs-title class_">Select</span>,
  <span class="hljs-title class_">Input</span>,
  <span class="hljs-title class_">Typography</span>,
  <span class="hljs-title class_">Space</span>,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">UploadOutlined</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ant-design/icons'</span>;
<span class="hljs-keyword">import</span> mammoth <span class="hljs-keyword">from</span> <span class="hljs-string">'mammoth'</span>;
<span class="hljs-keyword">const</span> { <span class="hljs-title class_">TextArea</span> } = <span class="hljs-title class_">Input</span>;
<span class="hljs-keyword">const</span> { <span class="hljs-title class_">Title</span> } = <span class="hljs-title class_">Typography</span>;

<span class="hljs-keyword">import</span> <span class="hljs-string">'./index.less'</span>;
<span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// diff</span>
<span class="hljs-comment">// insert æ·»åŠ   delete åˆ é™¤  equal ç›¸ç­‰</span>
type <span class="hljs-title class_">DiffPart</span> = {
  <span class="hljs-attr">type</span>: <span class="hljs-string">'insert'</span> | <span class="hljs-string">'delete'</span> | <span class="hljs-string">'equal'</span>;
  <span class="hljs-attr">text</span>: string;
};
<span class="hljs-keyword">const</span> <span class="hljs-title function_">WordDiffTool</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// æ—§æ–‡æœ¬å†…å®¹</span>
  <span class="hljs-keyword">const</span> [oldText, setOldText] =
    useState&lt;string&gt;(<span class="hljs-string">'è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹æ–‡æœ¬ï¼Œç”¨äºæµ‹è¯•å¯¹æ¯”åŠŸèƒ½ã€‚'</span>);

  <span class="hljs-comment">// æ–°æ–‡æœ¬å†…å®¹</span>
  <span class="hljs-keyword">const</span> [newText, setNewText] = useState&lt;string&gt;(
    <span class="hljs-string">'è¿™æ˜¯ç”¨äºæµ‹è¯•çš„ç¤ºä¾‹æ–‡æœ¬ï¼Œç”¨äºå¯¹æ¯”åŠŸèƒ½ã€‚æ·»åŠ äº†ä¸€äº›å†…å®¹ã€‚'</span>
  );

  <span class="hljs-comment">// å¯¹æ¯”ç²’åº¦</span>
  <span class="hljs-keyword">const</span> [granularity, setGranularity] = useState&lt;<span class="hljs-string">'word'</span> | <span class="hljs-string">'char'</span> | <span class="hljs-string">'line'</span>&gt;(
    <span class="hljs-string">'word'</span>
  );

  <span class="hljs-comment">// ä¸Šä¼ word å¹¶æå–æ–‡æœ¬</span>
  <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleUpload</span>(<span class="hljs-params">file: File, type: <span class="hljs-string">'old'</span> | <span class="hljs-string">'new'</span></span>) {
    <span class="hljs-keyword">const</span> arrayBuffer = <span class="hljs-keyword">await</span> file.<span class="hljs-title function_">arrayBuffer</span>();
    <span class="hljs-comment">// mammith.extractRawTextä»docxä¸­æå–çº¯æ–‡æœ¬</span>
    <span class="hljs-keyword">const</span> { value } = <span class="hljs-keyword">await</span> mammoth.<span class="hljs-title function_">extractRawText</span>({ arrayBuffer });
    <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'old'</span>) {
      <span class="hljs-title function_">setOldText</span>(value);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title function_">setNewText</span>(value);
    }
  }

  <span class="hljs-comment">// åˆ†è¯</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">tokenize</span>(<span class="hljs-params">text: string, mode: string</span>): string[] {
    <span class="hljs-comment">// æŒ‰è¡Œåˆ†ï¼ŒæŒ‰æ¢è¡Œç¬¦æ‹†åˆ†ä¸ºæ•°ç»„</span>
    <span class="hljs-keyword">if</span> (mode === <span class="hljs-string">'line'</span>) <span class="hljs-keyword">return</span> text.<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/\r?\n/</span>);
    <span class="hljs-comment">// æŒ‰å­—ç¬¦åˆ†ï¼ŒæŠŠå­—ç¬¦ä¸²æ‹†åˆ†æˆå•ä¸ªå­—ç¬¦æ•°ç»„</span>
    <span class="hljs-keyword">if</span> (mode === <span class="hljs-string">'char'</span>) <span class="hljs-keyword">return</span> text.<span class="hljs-title function_">split</span>(<span class="hljs-string">''</span>);
    <span class="hljs-comment">//ç”¨æ­£åˆ™å°†æ–‡æœ¬åˆ‡æˆä¸­æ–‡å•å­—ã€è‹±æ–‡å•è¯ã€å…¶ä»–å•ä¸ªç¬¦å·</span>
    <span class="hljs-keyword">return</span> text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/[\u4e00-\u9fa5]|\w+|[^\w\u4e00-\u9fa5]/g</span>) || [];
  }

  <span class="hljs-comment">// LCSæ„å»ºDP</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">buildLCS</span>(<span class="hljs-params">a: string[], b: string[]</span>) {
    <span class="hljs-comment">// æ„å»ºäºŒç»´æ•°ç»„ï¼Œå¹¶å°†å…¶åˆå§‹åŒ–ä¸º0</span>
    <span class="hljs-comment">// dp[i][j]è¡¨ç¤ºä»a[i:]ä¸b[j:]çš„æœ€é•¿å…¬å…±å­åºåˆ—é•¿åº¦</span>
    <span class="hljs-keyword">const</span> dp = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: a.<span class="hljs-property">length</span> + <span class="hljs-number">1</span> }, <span class="hljs-function">() =&gt;</span>
      <span class="hljs-title class_">Array</span>(b.<span class="hljs-property">length</span> + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>)
    );

    <span class="hljs-comment">// å€’åºå¡«å……dp</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = a.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = b.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; j &gt;= <span class="hljs-number">0</span>; j--) {
        <span class="hljs-keyword">if</span> (a[i] === b[j]) {
          dp[i][j] = dp[i + <span class="hljs-number">1</span>][j + <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>;
        } <span class="hljs-keyword">else</span> {
          dp[i][j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(dp[i + <span class="hljs-number">1</span>][j], dp[i][j + <span class="hljs-number">1</span>]);
        }
      }
    }

    <span class="hljs-keyword">return</span> dp;
  }

  <span class="hljs-comment">// å¾—åˆ°diffç»“æ„</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">diffTokens</span>(<span class="hljs-params">a: string[], b: string[]</span>): <span class="hljs-title class_">DiffPart</span>[] {
    <span class="hljs-comment">//æ„å»ºæ–°æ—§å†…å®¹dpæ•°ç»„</span>
    <span class="hljs-keyword">const</span> dp = <span class="hljs-title function_">buildLCS</span>(a, b);
    <span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>,
      j = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-attr">result</span>: <span class="hljs-title class_">DiffPart</span>[] = [];

    <span class="hljs-comment">// ä¾¿åˆ©æ–°æ—§å†…å®¹</span>
    <span class="hljs-keyword">while</span> (i &lt; a.<span class="hljs-property">length</span> || j &lt; b.<span class="hljs-property">length</span>) {
      <span class="hljs-comment">//è‹¥å½“å‰tokenç›¸ç­‰ï¼Œåˆ™è®°å½•ä¸‹æ¥å¹¶ç§»åŠ¨i j</span>
      <span class="hljs-keyword">if</span> (i &lt; a.<span class="hljs-property">length</span> &amp;&amp; j &lt; b.<span class="hljs-property">length</span> &amp;&amp; a[i] === b[j]) {
        result.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'equal'</span>, <span class="hljs-attr">text</span>: a[i] });
        i++;
        j++;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (
        j &lt; b.<span class="hljs-property">length</span> &amp;&amp;
        (i === a.<span class="hljs-property">length</span> || dp[i][j + <span class="hljs-number">1</span>] &gt;= dp[i + <span class="hljs-number">1</span>][j])
      ) {
        result.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'insert'</span>, <span class="hljs-attr">text</span>: b[j] });
        j++;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i &lt; a.<span class="hljs-property">length</span>) {
        result.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'delete'</span>, <span class="hljs-attr">text</span>: a[i] });
        i++;
      }
    }
    <span class="hljs-keyword">return</span> result;
  }

  <span class="hljs-comment">// å°†diff è½¬åŒ–æˆå·¦å³ä¸¤ä¾§å±•ç¤º</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">buildSideBySide</span>(<span class="hljs-params">parts: DiffPart[]</span>) {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">oldView</span>: <span class="hljs-title class_">DiffPart</span>[] = [];
    <span class="hljs-keyword">const</span> <span class="hljs-attr">newView</span>: <span class="hljs-title class_">DiffPart</span>[] = [];

    parts.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (p.<span class="hljs-property">type</span> === <span class="hljs-string">'equal'</span>) {
        oldView.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'equal'</span>, <span class="hljs-attr">text</span>: p.<span class="hljs-property">text</span> });
        newView.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'equal'</span>, <span class="hljs-attr">text</span>: p.<span class="hljs-property">text</span> });
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (p.<span class="hljs-property">type</span> === <span class="hljs-string">'delete'</span>) {
        oldView.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'delete'</span>, <span class="hljs-attr">text</span>: p.<span class="hljs-property">text</span> });
        newView.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'equal'</span>, <span class="hljs-attr">text</span>: p.<span class="hljs-property">text</span> });
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (p.<span class="hljs-property">type</span> === <span class="hljs-string">'insert'</span>) {
        oldView.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'equal'</span>, <span class="hljs-attr">text</span>: p.<span class="hljs-property">text</span> });
        newView.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'insert'</span>, <span class="hljs-attr">text</span>: p.<span class="hljs-property">text</span> });
      }
    });

    <span class="hljs-keyword">return</span> { oldView, newView };
  }

  <span class="hljs-keyword">const</span> oldTokens = <span class="hljs-title function_">tokenize</span>(oldText, granularity);
  <span class="hljs-keyword">const</span> newTokens = <span class="hljs-title function_">tokenize</span>(newText, granularity);

  <span class="hljs-keyword">const</span> diffParts = <span class="hljs-title function_">diffTokens</span>(oldTokens, newTokens);
  <span class="hljs-keyword">const</span> { oldView, newView } = <span class="hljs-title function_">buildSideBySide</span>(diffParts);

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">renderDiff</span>(<span class="hljs-params">parts: DiffPart[]</span>) {
    <span class="hljs-keyword">return</span> parts.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">p, i</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (p.<span class="hljs-property">type</span> === <span class="hljs-string">'equal'</span>) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{i}</span>&gt;</span>{p.text}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>;
      <span class="hljs-keyword">if</span> (p.<span class="hljs-property">type</span> === <span class="hljs-string">'delete'</span>)
        <span class="hljs-keyword">return</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{i}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"deleted"</span>&gt;</span>
            {p.text}
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>
        );
      <span class="hljs-keyword">if</span> (p.<span class="hljs-property">type</span> === <span class="hljs-string">'insert'</span>) {
        <span class="hljs-keyword">return</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{i}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"inserted"</span>&gt;</span>
            {p.text}
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>
        );
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    });
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"word-diff-tool"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Title</span> <span class="hljs-attr">level</span>=<span class="hljs-string">{3}</span>&gt;</span>Word æ–‡æœ¬å¯¹æ¯”å·¥å…·<span class="hljs-tag">&lt;/<span class="hljs-name">Title</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">Space</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">marginBottom:</span> <span class="hljs-attr">16</span> }}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Upload</span>
          <span class="hljs-attr">beforeUpload</span>=<span class="hljs-string">{file</span> =&gt;</span> {
            handleUpload(file, 'old').catch(err =&gt; {
              console.log('æ–‡ä»¶å¤„ç†å¤±è´¥', err);
            });
            return false;
          }}
          showUploadList={false}
        &gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">icon</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">UploadOutlined</span> /&gt;</span>}&gt;ä¸Šä¼ æ—§æ–‡æœ¬<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Upload</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">Upload</span>
          <span class="hljs-attr">beforeUpload</span>=<span class="hljs-string">{file</span> =&gt;</span> {
            handleUpload(file, 'new').catch(err =&gt; {
              console.log('æ–‡ä»¶å¤„ç†å¤±è´¥', err);
            });
            return false;
          }}
          showUploadList={false}
        &gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">icon</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">UploadOutlined</span> /&gt;</span>}&gt;ä¸Šä¼ æ–°æ–‡æœ¬<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Upload</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">Select</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{granularity}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{v</span> =&gt;</span> setGranularity(v)}
          className="granularity-select"
        &gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Select.Option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"word"</span>&gt;</span>æŒ‰è¯ diff<span class="hljs-tag">&lt;/<span class="hljs-name">Select.Option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Select.Option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"char"</span>&gt;</span>æŒ‰å­—ç¬¦ diff<span class="hljs-tag">&lt;/<span class="hljs-name">Select.Option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Select.Option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"line"</span>&gt;</span>æŒ‰è¡Œ diff<span class="hljs-tag">&lt;/<span class="hljs-name">Select.Option</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Select</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Space</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">Row</span> <span class="hljs-attr">gutter</span>=<span class="hljs-string">{24}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Col</span> <span class="hljs-attr">span</span>=<span class="hljs-string">{12}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"diff-col"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"col-title old"</span>&gt;</span>æ—§ç‰ˆæœ¬å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">TextArea</span>
              <span class="hljs-attr">rows</span>=<span class="hljs-string">{10}</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{oldText}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setOldText(e.target.value)}
            /&gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"diff-result"</span>&gt;</span>{renderDiff(oldView)}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Col</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">Col</span> <span class="hljs-attr">span</span>=<span class="hljs-string">{12}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"diff-col"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"col-title new"</span>&gt;</span>æ–°ç‰ˆæœ¬å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">TextArea</span>
              <span class="hljs-attr">rows</span>=<span class="hljs-string">{10}</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{newText}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setNewText(e.target.value)}
            /&gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"diff-result"</span>&gt;</span>{renderDiff(newView)}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Col</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Row</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">WordDiffTool</span>;
</code></pre>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-class">.word-diff-tool</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">24px</span>;

  <span class="hljs-selector-class">.diff-col</span> {
    <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">16px</span>;
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
    <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">2px</span> <span class="hljs-number">10px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.05</span>);

    <span class="hljs-selector-class">.col-title</span> {
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">15px</span>;
      <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">8px</span>;
      <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;

      <span class="hljs-selector-tag">&amp;</span><span class="hljs-selector-class">.old</span> {
        <span class="hljs-attribute">color</span>: <span class="hljs-number">#c0392b</span>;
      }
      <span class="hljs-selector-tag">&amp;</span><span class="hljs-selector-class">.new</span> {
        <span class="hljs-attribute">color</span>: <span class="hljs-number">#27ae60</span>;
      }
    }

    <span class="hljs-selector-class">.diff-result</span> {
      <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">12px</span>;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">12px</span>;
      <span class="hljs-attribute">min-height</span>: <span class="hljs-number">200px</span>;
      <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#f0f0f0</span>;
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">6px</span>;
      <span class="hljs-attribute">line-height</span>: <span class="hljs-number">1.8</span>;
      <span class="hljs-attribute">white-space</span>: pre-wrap;
      <span class="hljs-attribute">overflow</span>: auto;
      <span class="hljs-attribute">background</span>: <span class="hljs-number">#fafafa</span>;
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#bbb</span>;
    }
  }

  <span class="hljs-selector-class">.deleted</span> {
    <span class="hljs-attribute">background</span>: <span class="hljs-number">#ffe5e5</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#e11</span>;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">1px</span> <span class="hljs-number">3px</span>;
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">3px</span>;
  }

  <span class="hljs-selector-class">.inserted</span> {
    <span class="hljs-attribute">background</span>: <span class="hljs-number">#e6ffed</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#0a0</span>;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">1px</span> <span class="hljs-number">3px</span>;
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">3px</span>;
  }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸‰å‚»æ’åºï¼ˆå†’æ³¡ï¼Œé€‰æ‹©ï¼Œæ’å…¥ï¼‰Javaå¤§ç™½è¯ï¼ˆè€æ¯•ç™»å¯ä»¥è·³è¿‡ï¼‰]]></title>    <link>https://juejin.cn/post/7578820431039332392</link>    <guid>https://juejin.cn/post/7578820431039332392</guid>    <pubDate>2025-12-02T02:45:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578820431039332392" data-draft-id="7578402574652227636" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸‰å‚»æ’åºï¼ˆå†’æ³¡ï¼Œé€‰æ‹©ï¼Œæ’å…¥ï¼‰Javaå¤§ç™½è¯ï¼ˆè€æ¯•ç™»å¯ä»¥è·³è¿‡ï¼‰"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-02T02:45:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="zhengzizhe"/> <meta itemprop="url" content="https://juejin.cn/user/159867906828928"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸‰å‚»æ’åºï¼ˆå†’æ³¡ï¼Œé€‰æ‹©ï¼Œæ’å…¥ï¼‰Javaå¤§ç™½è¯ï¼ˆè€æ¯•ç™»å¯ä»¥è·³è¿‡ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/159867906828928/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    zhengzizhe
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T02:45:33.000Z" title="Tue Dec 02 2025 02:45:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸‰ç§æ’åºç®—æ³•è¯¦è§£</h2>
<p>æœ¬æ–‡æ¡£è§£é‡Šäº†ä¸‰ç§åŸºæœ¬çš„æ’åºç®—æ³•åŠå…¶Javaå®ç°ã€‚æ‰€æœ‰å®ç°éƒ½å°†ç›¸åŒçš„æ•°ç»„<code>[1, 6, 8, 2, 3]</code>æŒ‰å‡åºæ’åˆ—ã€‚</p>
<h3 data-id="heading-1">1. é€‰æ‹©æ’åº (choose.java)</h3>
<p>é€‰æ‹©æ’åºé€šè¿‡é‡å¤ä»æœªæ’åºéƒ¨åˆ†æ‰¾åˆ°æœ€å°å…ƒç´ å¹¶å°†å…¶æ”¾ç½®åœ¨å¼€å¤´æ¥å·¥ä½œã€‚</p>
<h4 data-id="heading-2">å·¥ä½œåŸç†ï¼š</h4>
<ol>
<li>åœ¨æ•´ä¸ªæ•°ç»„ä¸­æ‰¾åˆ°æœ€å°å…ƒç´ å¹¶ä¸ç¬¬ä¸€ä¸ªå…ƒç´ äº¤æ¢</li>
<li>åœ¨å‰©ä½™æœªæ’åºéƒ¨åˆ†æ‰¾åˆ°æœ€å°å…ƒç´ å¹¶ä¸ç¬¬äºŒä¸ªå…ƒç´ äº¤æ¢</li>
<li>é‡å¤æ­¤è¿‡ç¨‹ç›´åˆ°æ•´ä¸ªæ•°ç»„æœ‰åº</li>
</ol>
<h4 data-id="heading-3">å®ç°ä»£ç ï¼š</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
    <span class="hljs-type">int</span>[] a = {<span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>};
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; a.length; i++) {
        <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> i;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> i; j &lt; a.length; j++) {
            <span class="hljs-keyword">if</span> (a[index] &gt; a[j]) {
                index = j;
            }
        }
        <span class="hljs-type">int</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> a[i];
        a[i] = a[index];
        a[index] = temp;
    }
    System.out.println(Arrays.toString(a));
}
</code></pre>
<h4 data-id="heading-4">ç‰¹ç‚¹ï¼š</h4>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ï¼šO(nÂ²)</li>
<li>ç©ºé—´å¤æ‚åº¦ï¼šO(1)</li>
<li>ä¸ç¨³å®šï¼ˆå¯èƒ½ä¼šæ”¹å˜ç›¸ç­‰å…ƒç´ çš„ç›¸å¯¹é¡ºåºï¼‰</li>
<li>åœ¨å°æ•°æ®é›†ä¸Šè¡¨ç°è‰¯å¥½</li>
</ul>
<h3 data-id="heading-5">2. å†’æ³¡æ’åº (effervescence.java)</h3>
<p>å†’æ³¡æ’åºé€šè¿‡é‡å¤éå†åˆ—è¡¨ï¼Œæ¯”è¾ƒç›¸é‚»å…ƒç´ å¹¶åœ¨é¡ºåºé”™è¯¯æ—¶äº¤æ¢å®ƒä»¬æ¥å·¥ä½œã€‚æ¯ä¸€è½®éå†åï¼Œæœ€å¤§çš„å…ƒç´ ä¼š"å†’æ³¡"åˆ°æ•°ç»„çš„æœ«å°¾ã€‚</p>
<h4 data-id="heading-6">å·¥ä½œåŸç†ï¼š</h4>
<ol>
<li>æ¯”è¾ƒç›¸é‚»å…ƒç´ ï¼Œå¦‚æœå·¦è¾¹çš„å¤§äºå³è¾¹çš„åˆ™äº¤æ¢å®ƒä»¬</li>
<li>æ¯æ¬¡å®Œæ•´éå†åï¼Œæœªæ’åºå…ƒç´ ä¸­çš„æœ€å¤§å€¼ä¼šç§»åŠ¨åˆ°æ­£ç¡®ä½ç½®</li>
<li>é‡å¤ç›´åˆ°ä¸éœ€è¦äº¤æ¢ä¸ºæ­¢</li>
</ol>
<h4 data-id="heading-7">å®ç°ä»£ç ï¼š</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
    <span class="hljs-type">int</span>[] a = {<span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>};
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; a.length - <span class="hljs-number">1</span>; i++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; a.length - <span class="hljs-number">1</span> - i; j++) {
            <span class="hljs-keyword">if</span> (a[j] &gt; a[j + <span class="hljs-number">1</span>]) {
                <span class="hljs-type">int</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> a[j];
                a[j] = a[j + <span class="hljs-number">1</span>];
                a[j + <span class="hljs-number">1</span>] = temp;
            }
        }
    }
    System.out.println(Arrays.toString(a));
}
</code></pre>
<h4 data-id="heading-8">ç‰¹ç‚¹ï¼š</h4>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ï¼šO(nÂ²)</li>
<li>ç©ºé—´å¤æ‚åº¦ï¼šO(1)</li>
<li>ç¨³å®šæ’åºç®—æ³•</li>
<li>è‡ªé€‚åº” - å¯ä»¥æ£€æµ‹åˆ—è¡¨æ˜¯å¦å·²ç»æ’åº</li>
</ul>
<h3 data-id="heading-9">3. æ’å…¥æ’åº (insert.java)</h3>
<p>æ’å…¥æ’åºé€šè¿‡é€ä¸ªæ„å»ºæœ€ç»ˆçš„æ’åºæ•°ç»„æ¥å·¥ä½œã€‚å®ƒçš„å·¥ä½œæ–¹å¼ç±»ä¼¼äºäººä»¬å¦‚ä½•æ•´ç†æ‰‹ä¸­çš„æ‰‘å…‹ç‰Œã€‚</p>
<h4 data-id="heading-10">å·¥ä½œåŸç†ï¼š</h4>
<ol>
<li>ä»ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆç´¢å¼•1ï¼‰å¼€å§‹</li>
<li>å°†å…¶ä¸å‰é¢çš„å…ƒç´ æ¯”è¾ƒå¹¶æ’å…¥åˆ°æ­£ç¡®ä½ç½®</li>
<li>ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ å¹¶é‡å¤ç›´åˆ°æ•´ä¸ªæ•°ç»„æœ‰åº</li>
</ol>
<h4 data-id="heading-11">å®ç°ä»£ç ï¼š</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
    <span class="hljs-type">int</span>[] a = {<span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>};
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; a.length; i++) {
        <span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> i;
        <span class="hljs-keyword">for</span> (; j &gt; <span class="hljs-number">0</span>; j--) {
            <span class="hljs-keyword">if</span> (a[j] &lt; a[j - <span class="hljs-number">1</span>]) {
                <span class="hljs-type">int</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> a[j];
                a[j] = a[j - <span class="hljs-number">1</span>];
                a[j - <span class="hljs-number">1</span>] = temp;
            } <span class="hljs-keyword">else</span>
                <span class="hljs-keyword">break</span>;
        }
    }
    System.out.println(Arrays.toString(a));
}
</code></pre>
<h4 data-id="heading-12">ç‰¹ç‚¹ï¼š</h4>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ï¼šO(nÂ²)</li>
<li>ç©ºé—´å¤æ‚åº¦ï¼šO(1)</li>
<li>ç¨³å®šæ’åºç®—æ³•</li>
<li>å¯¹å°æ•°æ®é›†é«˜æ•ˆ</li>
<li>è‡ªé€‚åº” - å¯¹å·²åŸºæœ¬æ’åºçš„æ•°æ®é›†å¾ˆé«˜æ•ˆ</li>
</ul>
<h3 data-id="heading-13">æ€»ç»“</h3>
<p>è¿™ä¸‰ç§ç®—æ³•éƒ½å…·æœ‰O(nÂ²)çš„æ—¶é—´å¤æ‚åº¦ï¼Œä½¿å¾—å®ƒä»¬å¯¹äºå¤§æ•°æ®é›†æ¥è¯´æ•ˆç‡ä¸é«˜ã€‚ä½†å®ƒä»¬å¯¹æ•™è‚²ç›®çš„å’Œå°æ•°ç»„æ’åºå¾ˆæœ‰ä»·å€¼ã€‚æ¯ç§ç®—æ³•éƒ½æœ‰è‡ªå·±çš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li>æ’å…¥æ’åºæ˜¯å…¶ä¸­æœ€æœ‰ä»·å€¼çš„ï¼Œä¸€å¥è¯ï¼Œå‡è®¾ä¸€ä¾§æ˜¯æœ‰åºçš„ï¼Œæ–°å…ƒç´ å»å¯»æ‰¾æœ‰åºåˆ—è¡¨çš„ä½ç½®</li>
<li>é€‰æ‹©æ’åºæœ€å°åŒ–äº¤æ¢æ¬¡æ•°ï¼Œä¸€å¥è¯ï¼Œå‡è®¾ä¸€ä¾§æ˜¯æœ‰åºçš„ï¼Œå»å‰©ä¸‹çš„é€‰æ‹©ä¸€ä¸ªæœ€å¤§æˆ–è€…æœ€å°ç„¶åæ”¾å…¥æœ«å°¾</li>
<li>å†’æ³¡æ’åºç®€å•æ˜“æ‡‚ä¸”æ˜“äºå®ç° ï¼Œä¸€å¥è¯ï¼Œå‡è®¾ä¸€ä¾§æ˜¯æœ‰åºçš„ï¼Œä»å¼€å¤´æˆ–è€…ç»“å°¾ï¼Œä¸æ–­å°±è¿‘æ¯”è¾ƒï¼ŒæŠŠæœ€å¤§æœ€å°æ‹±åˆ°ä¸€ä¾§</li>
<li>æ’å…¥æ’åºå¯¹äºè¿‘ä¼¼æ’åºçš„æ•°ç»„å¾ˆé«˜æ•ˆï¼Œå¹¶ä¸”æ˜¯ç¨³å®šçš„</li>
</ul>
<p>å¯¹äºè¾ƒå¤§çš„æ•°æ®é›†ï¼Œæ›´é«˜çº§çš„ç®—æ³•å¦‚å¿«é€Ÿæ’åºã€å½’å¹¶æ’åºæˆ–å †æ’åºå°†æ˜¯æ›´åˆé€‚çš„é€‰æ‹©ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…¬å¸ React åº”ç”¨æ„Ÿè§‰å¾ˆæ…¢ï¼Œæˆ‘æŠŠæ²¡å¿…è¦çš„é‡å¤æ¸²æŸ“ç æ‰äº† 40%!]]></title>    <link>https://juejin.cn/post/7578793960626602010</link>    <guid>https://juejin.cn/post/7578793960626602010</guid>    <pubDate>2025-12-02T02:47:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578793960626602010" data-draft-id="7578777952726515746" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…¬å¸ React åº”ç”¨æ„Ÿè§‰å¾ˆæ…¢ï¼Œæˆ‘æŠŠæ²¡å¿…è¦çš„é‡å¤æ¸²æŸ“ç æ‰äº† 40%!"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-02T02:47:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å­Ÿç¥¥_æˆéƒ½"/> <meta itemprop="url" content="https://juejin.cn/user/96412752684744"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…¬å¸ React åº”ç”¨æ„Ÿè§‰å¾ˆæ…¢ï¼Œæˆ‘æŠŠæ²¡å¿…è¦çš„é‡å¤æ¸²æŸ“ç æ‰äº† 40%!
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/96412752684744/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å­Ÿç¥¥_æˆéƒ½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T02:47:19.000Z" title="Tue Dec 02 2025 02:47:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å…¬å¸ React åº”ç”¨è¡¨ç°å¾ˆå·®ã€‚é‡å¤æ¸²æŸ“æ„Ÿè§‰åƒè¿·ä¸€æ ·ï¼Œä¸çŸ¥é“å¤§å®¶æœ‰ä¸æ²¡æœ‰è¿‡è¿™æ ·çš„ç»å†ï¼š</p>
<ul>
<li>æ˜æ˜ä¼ å…¥çš„æ•°æ®æ²¡å˜ï¼Œç»„ä»¶å´è¿˜æ˜¯é‡æ¸²æŸ“</li>
<li>çˆ¶ç»„ä»¶ä¸€æ›´æ–°ï¼Œå¾ˆå¤šå­ç»„ä»¶è·Ÿç€ä¸€èµ·é‡æ¸²æŸ“ï¼ˆéƒ¨åˆ†å­ç»„ä»¶æ•°æ®å¹¶æ²¡æœ‰å˜åŒ–ï¼‰</li>
<li>åœ¨ç»„ä»¶å†…éƒ¨å®šä¹‰å‡½æ•°ï¼Œå¯¼è‡´æ¯æ¬¡æ¸²æŸ“éƒ½å‡ºç°â€œæ–°çš„â€å‡½æ•°å¼•ç”¨</li>
<li>Context API çš„æ›´æ–°æŠŠå¤§å—åŒºåŸŸéƒ½åˆ·æ–°äº†ï¼Œè€Œä¸æ˜¯åªåˆ·æ–°éœ€è¦çš„é‚£ä¸€å°å—</li>
</ul>
<p>è¿™äº›é—®é¢˜ä¹Ÿä¾§é¢åæ˜ ï¼Œè¦æ±‚ <code>React</code> ä½¿ç”¨è€…éœ€è¦æ›´å¤šçš„å¿ƒæ™ºä»¥åŠå¯¹æ¡†æ¶åŸç†æ›´å¤šäº†è§£ï¼Œæ‰èƒ½åšå¥½ <code>React</code> å¼€å‘ã€‚</p>
<p>ä½†è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è¯é¢˜ï¼Œå½“é¢è¯•å®˜é—®ä½ æ€§èƒ½ä¼˜åŒ–çš„æ—¶å€™ï¼Œå…³äº <code>React</code> æ¡†æ¶å±‚é¢çš„ä¼˜åŒ–ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œå¦‚ä½•è§£å†³å…¬å¸çš„ React åº”ç”¨é‡å¤æ¸²æŸ“é—®é¢˜ï¼</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸ºä»€ä¹ˆæ€§èƒ½å‡ºç°é—®é¢˜çš„åŸå› </p>
<h2 data-id="heading-1">ç”¨ Profiler æŠŠé—®é¢˜æªå‡ºæ¥</h2>
<p>ç¬¬ä¸€æ­¥å¼€å§‹ç”¨æ•°æ®æŸ¥çœ‹åˆ°åº•å“ªé‡Œå‡ºäº†é—®é¢˜ã€‚React DevTools é‡Œçš„ Profiler å¾ˆå¥½ç”¨ï¼Œå®ƒå¯ä»¥è®°å½•ä½ åœ¨åº”ç”¨ä¸­çš„äº¤äº’ï¼Œå‘Šè¯‰ä½ å“ªäº›ç»„ä»¶é‡æ¸²æŸ“äº†ã€ä¸ºä»€ä¹ˆé‡æ¸²æŸ“ã€ç”¨äº†å¤šé•¿æ—¶é—´ã€‚</p>
<p>è£…å¥½ React DevTools åï¼Œæ‰“å¼€ â€œProfilerâ€ æ ‡ç­¾ã€‚å¼€å§‹å½•åˆ¶ï¼Œåšä¸€äº›æ„Ÿè§‰å¡é¡¿çš„æ“ä½œï¼Œç„¶ååœæ­¢å½•åˆ¶ã€‚</p>
<p>ç”Ÿæˆçš„â€œç«ç„°å›¾â€èƒ½å¾ˆç›´è§‚çš„å‘Šè¯‰æˆ‘ä»¬å‘ç”Ÿäº†ä»€ä¹ˆã€‚æˆ‘èƒ½çœ‹åˆ°ä¸€äº›ç»„ä»¶åœ¨ props çœ‹èµ·æ¥æ²¡å˜çš„æƒ…å†µä¸‹ä¹Ÿåœ¨é‡æ¸²æŸ“ã€‚è¿™å°±æˆäº†æˆ‘ä¼˜åŒ–çš„åˆ‡å…¥ç‚¹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d24eb12eb0f4cb7ae823a9c265582d4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2f56WlX-aIkOmDvQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765248439&amp;x-signature=IC0VO1XUgQvDQ4mmp1aTq%2FgRbFc%3D" alt="1_eZCNwCucXBbH7il1bUI-3g.webp" loading="lazy"/></p>
<h2 data-id="heading-2">ä¸€äº›ç®€å•å´æœ‰æ•ˆçš„ä¿®å¤æªæ–½</h2>
<p>å®šä½åˆ°é—®é¢˜åŒºåŸŸåï¼Œæˆ‘å¼€å§‹é€ä¸ªå°è¯•ä¿®å¤ã€‚æœ‰äº›æ–¹æ³•å¾ˆç®€å•ï¼Œä½†æ•ˆæœå¾ˆæ˜æ˜¾ã€‚</p>
<h3 data-id="heading-3">ç”¨ React.memo é˜»æ­¢æ— æ•ˆæ¸²æŸ“</h3>
<p>ä¸€ä¸ªå¾ˆå¸¸è§çš„é—®é¢˜æ˜¯ï¼šçˆ¶ç»„ä»¶é‡æ¸²æŸ“æ—¶ï¼Œå­ç»„ä»¶ä¹Ÿè·Ÿç€é‡æ¸²æŸ“ï¼Œå“ªæ€•å®ƒè‡ªå·±çš„ props å¹¶æ²¡æœ‰å˜åŒ–ã€‚</p>
<ul>
<li>é—®é¢˜ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œåªè¦çˆ¶ç»„ä»¶æ¸²æŸ“ï¼ŒReact ä¹Ÿä¼šæŠŠå®ƒçš„å­ç»„ä»¶ä¸€èµ·æ¸²æŸ“ã€‚</li>
<li>è§£å†³ï¼šç”¨ React.memo åŒ…è£¹ç»„ä»¶ï¼Œå‘Šè¯‰ Reactï¼šâ€œåªæœ‰å½“è¿™ä¸ªç»„ä»¶çš„ props çœŸçš„å˜äº†æ‰é‡æ¸²æŸ“ã€‚æ³¨æ„ï¼Œå®ƒåªä¼šå¯¹ props åšæµ…æ¯”è¾ƒï¼ä¸¾ä¾‹å¦‚ä¸‹ï¼š</li>
</ul>
<p>ä¹‹å‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span>Â <span class="hljs-title function_">UserProfile</span>(<span class="hljs-params">{Â nameÂ }</span>)Â {
Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'RenderingÂ UserProfile'</span>);
Â Â <span class="hljs-keyword">return</span>Â <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<p>ä¹‹åï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span>Â {Â memoÂ }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">const</span>Â <span class="hljs-title class_">UserProfile</span>Â =Â <span class="hljs-title function_">memo</span>(<span class="hljs-keyword">function</span>Â 
<span class="hljs-title function_">UserProfile</span>(<span class="hljs-params">{Â nameÂ }</span>)Â {
Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'RenderingÂ UserProfile'</span>);
Â Â <span class="hljs-keyword">return</span>Â <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
});
</code></pre>
<p>æŠŠç»„ä»¶ç”¨ React.memo åŒ…èµ·æ¥åï¼Œå®ƒåªä¼šåœ¨ name è¿™ä¸ª prop å˜åŒ–æ—¶é‡æ¸²æŸ“ï¼Œè€Œä¸æ˜¯æ¯æ¬¡çˆ¶ç»„ä»¶æ¸²æŸ“éƒ½è·Ÿç€æ¥ä¸€éã€‚</p>
<h3 data-id="heading-4">ç”¨ useMemoizedFn å›ºå®šå‡½æ•°å¼•ç”¨</h3>
<p>åœ¨å¤æ‚åœºæ™¯æœ€å¥½æ”¾å¼ƒç”¨ useCallbackï¼Œå†™ä¾èµ–æ˜¯ä¸€ä¸ªå¾ˆéº»çƒ¦çš„äº‹æƒ…ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨ <code>ahooks</code> åº“å¯¼å‡ºçš„ <code>useMemoizedFn</code> å‡½æ•°ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<ul>
<li>useCallback é€šè¿‡ä¾èµ–é¡¹ä¿è¯â€œå‡½æ•°å¼•ç”¨ç¨³å®šâ€ï¼Œä½†åªåœ¨ä¾èµ–ä¸å˜æ—¶ç¨³å®šï¼›ä¸€æ—¦ä¾èµ–å˜æ›´ï¼Œå‡½æ•°å¼•ç”¨ä¹Ÿä¼šå˜ï¼Œå®¹æ˜“è®©å­ç»„ä»¶è¯¯ä»¥ä¸º props å˜äº†è€Œé‡æ¸²æŸ“ã€‚åŒæ—¶ä¼šæœ‰é—­åŒ…ä¸­æ‹¿åˆ°æ—§å€¼çš„é—®é¢˜ã€‚</li>
<li>ahooks çš„ useMemoizedFn å§‹ç»ˆè¿”å›â€œç¨³å®šçš„å‡½æ•°å¼•ç”¨â€ï¼ŒåŒæ—¶å†…éƒ¨èƒ½æ‹¿åˆ°æœ€æ–°çš„é—­åŒ…å€¼ï¼Œé¿å…â€œé™ˆæ—§é—­åŒ…â€é—®é¢˜ä¸ä¸å¿…è¦çš„é‡æ¸²æŸ“ã€‚</li>
</ul>
<p>ä¸¾ä¾‹ï¼š</p>
<p>useCallback</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// useCallbackï¼šä¾èµ–å˜åŒ–ä¼šå¯¼è‡´å‡½æ•°å¼•ç”¨å˜åŒ–</span>
<span class="hljs-keyword">const</span> [state, setState] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);

<span class="hljs-comment">// å½“ state å˜åŒ–,  func å‡½æ•°çš„å¼•ç”¨æ‰å˜åŒ–</span>
<span class="hljs-keyword">const</span> func = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(state);
}, [state]);
</code></pre>
<p>useMemoizedFn</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// useMemoizedFnï¼šå§‹ç»ˆç¨³å®šçš„å‡½æ•°å¼•ç”¨ï¼Œå†…éƒ¨æ€»èƒ½æ‹¿åˆ°æœ€æ–°çŠ¶æ€ï¼Œä¸ç”¨å†™ç¬¬äºŒä¸ªä¾èµ–å‚æ•°</span>
<span class="hljs-keyword">const</span> func = <span class="hljs-title function_">useMemoizedFn</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(state);
});
</code></pre>
<h3 data-id="heading-5">ç”¨ useMemo è®©å¯¹è±¡å’Œæ•°ç»„ä¿æŒç¨³å®š</h3>
<p>å’Œå‡½æ•°ç±»ä¼¼ï¼Œå¦‚æœä½ åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­åˆ›å»ºå¯¹è±¡æˆ–æ•°ç»„ï¼Œä¹Ÿä¼šå¸¦æ¥é—®é¢˜ã€‚</p>
<ul>
<li>é—®é¢˜ï¼šæ¯æ¬¡æ¸²æŸ“éƒ½ä¼šæ–°å»ºä¸€ä¸ªå¯¹è±¡æˆ–æ•°ç»„ï¼Œå³ä¾¿é‡Œé¢çš„æ•°æ®æ²¡å˜ã€‚æŠŠå®ƒä½œä¸º prop ä¼ ç»™ç»è¿‡è®°å¿†åŒ–çš„å­ç»„ä»¶ï¼Œä»ç„¶ä¼šè§¦å‘é‡æ¸²æŸ“ã€‚</li>
<li>è§£å†³ï¼š useMemo ä¼šå¯¹å€¼è¿›è¡Œè®°å¿†åŒ–ï¼Œåªåœ¨ä¾èµ–å‘ç”Ÿå˜åŒ–æ—¶æ‰é‡æ–°è®¡ç®—ã€‚</li>
</ul>
<p>ä¹‹å‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span>Â <span class="hljs-title function_">StyleComponent</span>(<span class="hljs-params">{Â isHighlightedÂ }</span>)Â {
Â Â <span class="hljs-keyword">const</span>Â styleÂ =Â {
Â Â Â Â <span class="hljs-attr">backgroundColor</span>:Â isHighlightedÂ ?Â 
Â Â Â Â <span class="hljs-string">'yellow'</span>Â :Â <span class="hljs-string">'white'</span>,
Â Â Â Â <span class="hljs-attr">padding</span>:Â <span class="hljs-number">10</span>
Â Â };

Â Â <span class="hljs-keyword">return</span>Â <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">style</span>=<span class="hljs-string">{style}</span>&gt;</span>SomeÂ content&lt;/
Â Â div&gt;;
}
</span></code></pre>
<p>ä¹‹åï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span>Â {Â useMemoÂ }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">StyleComponent</span>(<span class="hljs-params">{Â isHighlightedÂ }</span>)Â {
Â Â <span class="hljs-keyword">const</span>Â styleÂ =Â <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">()Â =&gt;</span>Â ({
Â Â Â Â <span class="hljs-attr">backgroundColor</span>:Â isHighlightedÂ ?Â 
Â Â Â Â <span class="hljs-string">'yellow'</span>Â :Â <span class="hljs-string">'white'</span>,
Â Â Â Â <span class="hljs-attr">padding</span>:Â <span class="hljs-number">10</span>
Â Â }),Â [isHighlighted]);

Â Â <span class="hljs-keyword">return</span>Â <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">style</span>=<span class="hljs-string">{style}</span>&gt;</span>SomeÂ content&lt;/
Â Â div&gt;;
}
</span></code></pre>
<p>ç”¨ useMemo åï¼Œ style è¿™ä¸ªå¯¹è±¡åªä¼šåœ¨ isHighlighted å˜åŒ–æ—¶æ‰è¢«é‡æ–°åˆ›å»ºï¼Œé¿å…äº†ä¸å¿…è¦çš„é‡æ¸²æŸ“ã€‚</p>
<h3 data-id="heading-6">æ‹†åˆ† Context</h3>
<ul>
<li>Context API èƒ½é¿å…å±‚å±‚ä¼ é€’ propsï¼Œä½†ä¹Ÿå¯èƒ½æˆä¸ºæ€§èƒ½é™·é˜±ã€‚</li>
<li>é—®é¢˜ï¼šåªè¦æŸä¸ª Context çš„å€¼å˜åŒ–ï¼Œæ‰€æœ‰æ¶ˆè´¹å®ƒçš„ç»„ä»¶éƒ½ä¼šé‡æ¸²æŸ“ï¼Œå³ä¾¿å®ƒåªå…³å¿ƒå…¶ä¸­æœªå˜çš„é‚£ä¸€å°éƒ¨åˆ†æ•°æ®ã€‚</li>
<li>è§£å†³ï¼šä¸è¦ç”¨ä¸€ä¸ªâ€œå¤§è€Œå…¨â€çš„ Contextï¼ŒæŠŠä¸åŒçš„çŠ¶æ€æ‹†åˆ†æˆå¤šä¸ªæ›´å°çš„ Contextã€‚</li>
<li>ä¾‹å¦‚ï¼šä¸å†ç”¨ä¸€ä¸ªåŒæ—¶åŒ…å«ç”¨æˆ·æ•°æ®ã€ä¸»é¢˜è®¾ç½®ã€é€šçŸ¥çš„ AppContext ï¼Œè€Œæ˜¯æ‹†æˆ UserContext ã€ ThemeContext ã€ NotificationContext ã€‚è¿™æ ·ä¸»é¢˜æ›´æ–°åªä¼šé‡æ¸²æŸ“ä½¿ç”¨ ThemeContext çš„ç»„ä»¶ã€‚</li>
</ul>
<h2 data-id="heading-7">æœ€ç»ˆæ•ˆæœ</h2>
<ul>
<li>åº”ç”¨è¿™äº›ä¿®å¤åå†æ¬¡ç”¨ Profiler æµ‹è¯•ï¼Œå·®å¼‚éå¸¸æ˜æ˜¾ã€‚æŒç»­çš„é‡å¤æ¸²æŸ“æ¶ˆå¤±äº†ï¼Œäº¤äº’æ›´é¡ºæ»‘ã€‚</li>
<li>æ•°æ®æ˜¾ç¤ºæ•´ä½“æ¸²æŸ“æ—¶é—´å‡å°‘äº†çº¦ 40%ï¼Œåº”ç”¨ç»ˆäºé¡ºç•…è¿è¡Œã€‚</li>
</ul>
<h2 data-id="heading-8">æ¬¢è¿åŠ å…¥äº¤æµç¾¤</h2>
<ul>
<li>æ’å…¥ä¸€ä¸ªæˆ‘å¼€å‘çš„ headlessï¼ˆæ— æ ·å¼ï¼‰ ç»„ä»¶åº“çš„å¹¿å‘Šï¼Œå‰ç«¯ç»„ä»¶åº“è¦†ç›–äº†å‰ç«¯ç»å¤§å¤šæ•°æŠ€æœ¯åœºæ™¯ï¼Œå¦‚æœä½ æƒ³å¯¹ç”Ÿäº§çº§å¯ç”¨çš„ç»„ä»¶åº“å¼€å‘æ„Ÿå…´è¶£ï¼Œæ¬¢è¿äº†è§£ï¼Œä¹Ÿæ¬¢è¿åŠ å…¥äº¤æµç¾¤ï¼š
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.frontlight.tech%2F" target="_blank" title="https://www.frontlight.tech/" ref="nofollow noopener noreferrer">ç»„ä»¶åº“å®˜ç½‘</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flio-mengxiang%2Ft-ui" target="_blank" title="https://github.com/lio-mengxiang/t-ui" ref="nofollow noopener noreferrer">æ„Ÿè°¢ github star</a></li>
</ul>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Day21 | æšä¸¾ï¼ˆEnumï¼‰ä¸å¸¸è§åº”ç”¨åœºæ™¯]]></title>    <link>https://juejin.cn/post/7578803751608680498</link>    <guid>https://juejin.cn/post/7578803751608680498</guid>    <pubDate>2025-12-02T02:22:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578803751608680498" data-draft-id="7578732288516587571" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Day21 | æšä¸¾ï¼ˆEnumï¼‰ä¸å¸¸è§åº”ç”¨åœºæ™¯"/> <meta itemprop="keywords" content="åç«¯,Java,Java EE"/> <meta itemprop="datePublished" content="2025-12-02T02:22:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‡’æƒ°èœ—ç‰›"/> <meta itemprop="url" content="https://juejin.cn/user/615342556327752"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Day21 | æšä¸¾ï¼ˆEnumï¼‰ä¸å¸¸è§åº”ç”¨åœºæ™¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/615342556327752/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‡’æƒ°èœ—ç‰›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T02:22:22.000Z" title="Tue Dec 02 2025 02:22:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto;border:3px solid rgba(62,175,124,.2)}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-weight:700;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:6px;border:2px solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c}.markdown-body a:active,.markdown-body a:hover{border-bottom:1.5px solid #3eaf7c}.markdown-body a:before{content:"â‡²"}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(62,175,124,.2)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:.5rem solid;border-color:#42b983;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none}.markdown-body ul li:before{content:"â€¢";margin-right:4px;color:#3eaf7c}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å†™ä»£ç çš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€äº›å˜é‡ï¼Œå®ƒä»¬çš„å–å€¼èŒƒå›´æ˜¯æœ‰é™ä¸”å›ºå®šçš„ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä¸€å‘¨æœ‰ä¸ƒå¤©ï¼ˆå‘¨ä¸€åˆ°å‘¨æ—¥ï¼‰ï¼Œè®¢å•çš„å‡ ç§çŠ¶æ€ï¼ˆå¾…æ”¯ä»˜ã€å¤„ç†ä¸­ã€å·²å‘è´§ã€å·²å®Œæˆã€å·²å–æ¶ˆï¼‰ï¼Œæ˜¥å¤ç§‹å†¬å››ä¸ªå­£èŠ‚ã€‚</p>
<p>åœ¨Java 5ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨public static finalä¿®é¥°å¸¸é‡æ¥è¡¨ç¤ºè¿™äº›å€¼ï¼Œä½†è¿™ç§æ–¹å¼å­˜åœ¨å¾ˆå¤šå¼Šç«¯ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬ä¸€èµ·æ¢è®¨Javaæä¾›çš„ä¸€ç§æ›´å¼ºå¤§ã€æ›´å®‰å…¨çš„è§£å†³æ–¹æ¡ˆâ€”â€”æšä¸¾ï¼ˆEnumï¼‰ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€æ²¡æœ‰æšä¸¾ä¹‹å‰</h2>
<p>åœ¨æšä¸¾å‡ºç°ä¹‹å‰ï¼Œæˆ‘ä»¬é€šå¸¸è¿™æ ·å®šä¹‰ä¸€ç»„ç›¸å…³çš„å¸¸é‡ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.lazy.snail.day21;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ClassName</span> ConstantsDemo
 * <span class="hljs-doctag">@Description</span> TODO
 * <span class="hljs-doctag">@Author</span> lazysnail
 * <span class="hljs-doctag">@Date</span> 2025/6/6 13:46
 * <span class="hljs-doctag">@Version</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConstantsDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">STATUS_PENDING</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">STATUS_PROCESSING</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">STATUS_SHIPPED</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">STATUS_COMPLETED</span> <span class="hljs-operator">=</span> <span class="hljs-number">4</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processOrderStatus</span><span class="hljs-params">(<span class="hljs-type">int</span> status)</span> {
        <span class="hljs-keyword">if</span> (ConstantsDemo.STATUS_COMPLETED == status) {
            System.out.println(<span class="hljs-string">"è®¢å•å¤„ç†å®Œæˆ"</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ConstantsDemo.STATUS_PROCESSING == status) {
            System.out.println(<span class="hljs-string">"è®¢å•å¤„ç†ä¸­"</span>);
        }
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<p>è¿™æ ·çš„å†™æ³•å¯èƒ½ä¼šå¼•å‘ä¸€äº›é—®é¢˜ã€‚</p>
<p>å‡å¦‚æ–¹æ³•çš„è°ƒç”¨è€…ä¼ å…¥äº†ä¸€äº›æ²¡æœ‰å®šä¹‰çš„å¸¸é‡å€¼ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºé€»è¾‘å‡ºé—®é¢˜ã€‚</p>
<p>è¿™äº›å¸¸é‡ä¸€èˆ¬éƒ½åˆ†æ•£åœ¨å„ä¸ªç±»é‡Œï¼Œå¦‚æœå¤šäº†ï¼Œå¾ˆå¯èƒ½å°±äº§ç”Ÿå‘½åå†²çªã€‚</p>
<p>å¦‚æœä½ åœ¨è°ƒè¯•çš„æ—¶å€™ï¼Œåªèƒ½è¾“å‡ºæ•°å­—ï¼Œè€Œä¸æ˜¯æœ‰æ„ä¹‰çš„åç§°ï¼Œæ¯”å¦‚PENDINGã€PROCESSINGã€‚</p>
<p>æ²¡åŠæ³•éå†æ‰€æœ‰å¯èƒ½å¾—å€¼ã€‚</p>
<p>å¦‚æœä½ ä½¿ç”¨äº†switchï¼Œswitchè¯­å¥æ²¡åŠæ³•æ£€æŸ¥ä½ æ˜¯ä¸æ˜¯è¦†ç›–äº†æ‰€æœ‰å¯èƒ½çš„å€¼ã€‚</p>
<p>å°±æ˜¯å› ä¸ºè¿™äº›é—®é¢˜ï¼ŒJava 5æ­£å¼å¼•å…¥äº†enumå…³é”®å­—ã€‚</p>
<h2 data-id="heading-1">äºŒã€æšä¸¾çš„åŸºæœ¬ç”¨æ³•ï¼ˆå¸¸é‡ï¼‰</h2>
<p>æšä¸¾æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»ï¼Œå®ƒå…è®¸æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç”±å›ºå®šçš„ã€å‘½åçš„å¸¸é‡ç»„æˆé›†åˆçš„ç±»å‹ã€‚</p>
<h3 data-id="heading-2">1ã€åŸºæœ¬å®šä¹‰</h3>
<p>å®šä¹‰ä¸€ä¸ªæšä¸¾å…¶å®å¾ˆç®€å•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.lazy.snail.day21;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ClassName</span> DayOfWeek
 * <span class="hljs-doctag">@Description</span> TODO
 * <span class="hljs-doctag">@Author</span> lazysnail
 * <span class="hljs-doctag">@Date</span> 2025/6/6 13:57
 * <span class="hljs-doctag">@Version</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">DayOfWeek</span> {
    MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY, SUNDAY;
}
</code></pre>
<p>DayOfWeekå°±æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼ŒMONDAYã€TUESDAYç­‰æ˜¯è¿™ä¸ªç±»å‹çš„å®ä¾‹ï¼ˆå°±æ˜¯DayOfWeekç±»å‹çš„å¯¹è±¡ï¼‰ã€‚</p>
<h3 data-id="heading-3">2ã€åŸºæœ¬ä½¿ç”¨</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.lazy.snail.day21;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ClassName</span> EnumDemo
 * <span class="hljs-doctag">@Description</span> TODO
 * <span class="hljs-doctag">@Author</span> lazysnail
 * <span class="hljs-doctag">@Date</span> 2025/6/6 14:00
 * <span class="hljs-doctag">@Version</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EnumDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">DayOfWeek</span> <span class="hljs-variable">today</span> <span class="hljs-operator">=</span> DayOfWeek.FRIDAY;

        <span class="hljs-keyword">switch</span> (today) {
            <span class="hljs-keyword">case</span> MONDAY -&gt; System.out.println(<span class="hljs-string">"åˆè¦å¼€å§‹æ¬ç –äº†"</span>);
            <span class="hljs-keyword">case</span> FRIDAY -&gt; System.out.println(<span class="hljs-string">"æ¬ç –ç»“æŸ"</span>);
            <span class="hljs-keyword">case</span> SATURDAY -&gt; System.out.println(<span class="hljs-string">"äº«å—å‘¨æœ«"</span>);
            <span class="hljs-keyword">default</span> -&gt; System.out.println(<span class="hljs-string">"ä¸€å¤©åˆä¸€å¤©"</span>);
        }

        System.out.println(today);
    }
}
</code></pre>
<p>æ–¹æ³•åªæ¥å—æŒ‡å®šç±»å‹çš„å®ä¾‹ï¼Œé¿å…ä¼ å…¥æ— æ•ˆå€¼ã€‚</p>
<p>ä»£ç é‡Œèƒ½å¤Ÿç›´è§‚çš„çœ‹å‡ºå¸¸é‡çš„å«ä¹‰ã€‚</p>
<h2 data-id="heading-4">ä¸‰ã€ç‰¹æ®Šç±»</h2>
<p>åœ¨Javaä¸­ï¼Œæ¯ä¸ªenumç±»å‹éƒ½æ˜¯java.lang.Enumç±»çš„éšå¼å­ç±»ï¼Œå¹¶ä¸”å®ƒæœ¬èº«æ˜¯ä¸€ä¸ªfinalç±»ï¼Œä¸èƒ½è¢«å…¶ä»–ç±»ç»§æ‰¿ã€‚</p>
<p>è¿™æ„å‘³ç€æšä¸¾å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„å­—æ®µï¼ˆæˆå‘˜å˜é‡ï¼‰ã€æ–¹æ³•ã€æ„é€ å‡½æ•°ã€å®ç°æ¥å£ã€‚</p>
<h3 data-id="heading-5">1ã€ç»™æšä¸¾æ·»åŠ å­—æ®µã€æ–¹æ³•å’Œæ„é€ å‡½æ•°</h3>
<p>æˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸ªæšä¸¾å®ä¾‹å…³è”é¢å¤–çš„æ•°æ®å’Œè¡Œä¸ºã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.lazy.snail.day21;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@ClassName</span> OrderStatus
 * <span class="hljs-doctag">@Description</span> TODO
 * <span class="hljs-doctag">@Author</span> lazysnail
 * <span class="hljs-doctag">@Date</span> 2025/6/6 14:12
 * <span class="hljs-doctag">@Version</span> 1.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">OrderStatus</span> {
    PENDING(<span class="hljs-number">10</span>, <span class="hljs-string">"å¾…æ”¯ä»˜"</span>),
    PROCESSING(<span class="hljs-number">20</span>, <span class="hljs-string">"å¤„ç†ä¸­"</span>),
    SHIPPED(<span class="hljs-number">30</span>, <span class="hljs-string">"å·²å‘è´§"</span>),
    COMPLETED(<span class="hljs-number">40</span>, <span class="hljs-string">"å·²å®Œæˆ"</span>),
    CANCELED(<span class="hljs-number">50</span>, <span class="hljs-string">"å·²å–æ¶ˆ"</span>);

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> code;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String description;

    OrderStatus(<span class="hljs-type">int</span> code, String description) {
        <span class="hljs-built_in">this</span>.code = code;
        <span class="hljs-built_in">this</span>.description = description;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getCode</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> code;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getDescription</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> description;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">OrderStatus</span> <span class="hljs-variable">status</span> <span class="hljs-operator">=</span> OrderStatus.COMPLETED;
        System.out.println(<span class="hljs-string">"è®¢å•çŠ¶æ€:"</span> + status);
        System.out.println(<span class="hljs-string">"çŠ¶æ€ç¼–ç :"</span> + status.getCode());
        System.out.println(<span class="hljs-string">"çŠ¶æ€æè¿°:"</span> + status.getDescription());
    }
}
</code></pre>
<p>ä¸Šé¢å®šä¹‰çš„æšä¸¾ç±»ä¸­ï¼Œæœ‰ç§æœ‰å­—æ®µã€æ„é€ å‡½æ•°å’Œå…¬å…±æ–¹æ³•ã€‚</p>
<h3 data-id="heading-6">2ã€æšä¸¾çš„å†…ç½®æ–¹æ³•</h3>
<p>java.lang.EnumåŸºç±»ä¸ºæ‰€æœ‰æšä¸¾æä¾›äº†å‡ ä¸ªæœ‰ç”¨çš„é™æ€å’Œå®ä¾‹æ–¹æ³•ï¼š</p>
<p>values()</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">for</span> (OrderStatus s : OrderStatus.values()) {
    System.out.printf(<span class="hljs-string">"ç¼–ç : %d, æè¿°: %s\n"</span>, s.getCode(), s.getDescription());
}
</code></pre>
<p>values()æ–¹æ³•æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰æšä¸¾å®ä¾‹çš„æ•°ç»„ã€‚</p>
<p>ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œé…åˆforå¾ªç¯ï¼Œå¯ä»¥æ–¹ä¾¿çš„å¯¹æ‰€æœ‰æšä¸¾å¸¸é‡è¿›è¡Œéå†ã€‚</p>
<p>valueOf(String name)</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">OrderStatus</span> <span class="hljs-variable">status1</span> <span class="hljs-operator">=</span> OrderStatus.valueOf(<span class="hljs-string">"COMPLETED"</span>);
</code></pre>
<p>valueOf(String name)ä¹Ÿæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå¯ä»¥æ ¹æ®ç»™å®šçš„å­—ç¬¦ä¸²åç§°è¿”å›å¯¹åº”çš„æšä¸¾å®ä¾‹ã€‚</p>
<p>å¦‚æœåç§°ä¸åŒ¹é…ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼ˆIllegalArgumentExceptionï¼‰ã€‚</p>
<p>name()</p>
<p>è¿™æ˜¯ä¸€ä¸ªå®ä¾‹æ–¹æ³•ï¼Œè¿”å›æšä¸¾å®ä¾‹çš„åç§°ï¼ˆå³å£°æ˜æ—¶çš„æ ‡è¯†ç¬¦ï¼Œæ¯”å¦‚"COMPLETED"ï¼‰ã€‚</p>
<p>ordinal()</p>
<p>è¿™æ˜¯ä¸€ä¸ªå®ä¾‹æ–¹æ³•ï¼Œè¿”å›æšä¸¾å®ä¾‹åœ¨å£°æ˜æ—¶çš„åºæ•°ï¼ˆä»0å¼€å§‹ï¼‰ã€‚</p>
<blockquote>
<p>è¿™ä¸ªæ–¹æ³•ä¸€èˆ¬éƒ½ä¸ä¼šåœ¨ä¸šåŠ¡ä»£ç é‡Œä½¿ç”¨ã€‚ã€ ä¸‡ä¸€ä½ åœ¨æšä¸¾å£°æ˜é‡Œæ”¹å˜äº†å¸¸é‡çš„é¡ºåºï¼Œæ‰€æœ‰ä¾èµ–ordinal()çš„ä»£ç éƒ½ä¼šå‡ºé”™ã€‚</p>
</blockquote>
<h2 data-id="heading-7">å››ã€å¸¸è§çš„åº”ç”¨åœºæ™¯</h2>
<p>ä¸Šé¢æåˆ°è¿‡çš„å¸¸é‡è¿™äº›ç®€å•çš„åº”ç”¨å°±ä¸è¯´äº†ã€‚</p>
<h3 data-id="heading-8">çŠ¶æ€æœº</h3>
<p>æšä¸¾éå¸¸é€‚åˆç”¨æ¥è¡¨ç¤ºæœ‰é™çŠ¶æ€æœºçš„çŠ¶æ€ã€‚</p>
<p>æ¯ä¸ªæšä¸¾å®ä¾‹ä»£è¡¨ä¸€ä¸ªçŠ¶æ€ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æšä¸¾ç±»ä¸­å®šä¹‰æ–¹æ³•æ¥å¤„ç†çŠ¶æ€è½¬æ¢é€»è¾‘ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">TrafficLight</span> {
    RED {
        <span class="hljs-keyword">public</span> TrafficLight <span class="hljs-title function_">next</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> GREEN; }
    },
    GREEN {
        <span class="hljs-keyword">public</span> TrafficLight <span class="hljs-title function_">next</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> YELLOW; }
    },
    YELLOW {
        <span class="hljs-keyword">public</span> TrafficLight <span class="hljs-title function_">next</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> RED; }
    };

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> TrafficLight <span class="hljs-title function_">next</span><span class="hljs-params">()</span>;
}

<span class="hljs-type">TrafficLight</span> <span class="hljs-variable">light</span> <span class="hljs-operator">=</span> TrafficLight.RED;
System.out.println(<span class="hljs-string">"Current light: "</span> + light);
light = light.next();
System.out.println(<span class="hljs-string">"Next light: "</span> + light);
light = light.next();
System.out.println(<span class="hljs-string">"Next light: "</span> + light);
</code></pre>
<p>ä¸Šé¢è¿™ä¸ªçº¢ç»¿ç¯çš„æ¡ˆä¾‹ï¼Œæ¯ç§çŠ¶æ€ä¸­è¿˜å®šä¹‰äº†æ–¹æ³•ï¼Œæ¥å®ç°çº¢ç»¿ç¯çŠ¶æ€çš„è½¬æ¢ã€‚</p>
<h3 data-id="heading-9">EnumSetå’ŒEnumMap</h3>
<p>Javaçš„é›†åˆæ¡†æ¶è¿˜ç»™æšä¸¾æä¾›äº†ä¸¤ä¸ªé«˜åº¦ä¼˜åŒ–çš„å®ç°ã€‚</p>
<p>EnumSet</p>
<p>è¿™æ˜¯ä¸€ä¸ªä¸“é—¨ä¸ºæšä¸¾ç±»è®¾è®¡çš„Setå®ç°ã€‚</p>
<p>å®ƒçš„å†…éƒ¨ä½¿ç”¨ä½å‘é‡å®ç°ï¼Œæ€§èƒ½ä¸Šæ¥è¯´æ¯”HashSetå¥½å¾ˆå¤šã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d064bbe4beef42ef89c1f5217cf0e5d5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oeS5oOw6JyX54mb:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765246941&amp;x-signature=5o543aJ4sOYMFZAqDIJT%2BSYQOTU%3D" alt="" loading="lazy"/></p>
<p>EnumMap</p>
<p>è¿™æ˜¯ä¸€ä¸ªé”®ä¸ºæšä¸¾ç±»å‹çš„Mapå®ç°ã€‚</p>
<p>å®ƒçš„å†…éƒ¨ä½¿ç”¨æ•°ç»„å®ç°ï¼Œæ€§èƒ½ä¹Ÿä¼˜äºHashMapã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/456520ad627f40938105ffea72330153~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oeS5oOw6JyX54mb:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765246941&amp;x-signature=OLZDeXSSpBKaZ5ozLOj0k%2FrMsV0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-10">ç»“è¯­</h2>
<p>ä»Šå¤©å°±ç®€å•çš„ä»‹ç»äº†ä¸€ä¸‹æšä¸¾ç±»ã€‚</p>
<p>åˆ—ä¸¾äº†ä¸€äº›ç®€å•çš„ç”¨æ³•å’Œå®é™…å¼€å‘åœºæ™¯ä¸­çš„ç”¨é€”ã€‚</p>
<p>æ¡ˆä¾‹ä¸­çš„Javaé›†åˆæ¡†æ¶å°†åœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ä¸­é€ä¸€è¿›è¡Œä»‹ç»ã€‚</p>
<p>ä¸‹ä¸€ç¯‡é¢„å‘Š</p>
<blockquote>
<p>Day22 | IDEAä½¿ç”¨æ•™ç¨‹</p>
</blockquote>
<p>å¦‚æœä½ è§‰å¾—è¿™ç³»åˆ—æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿å…³æ³¨ä¸“æ ï¼Œæˆ‘ä»¬ä¸€èµ·åšæŒä¸‹å»ï¼</p>
<p><strong>æ›´å¤šæ–‡ç« è¯·å…³æ³¨æˆ‘çš„å…¬ä¼—å·ã€Šæ‡’æƒ°èœ—ç‰›å·¥åŠã€‹</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ubuntuç³»ç»Ÿä¸docker]]></title>    <link>https://juejin.cn/post/7578781397117501486</link>    <guid>https://juejin.cn/post/7578781397117501486</guid>    <pubDate>2025-12-02T02:56:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578781397117501486" data-draft-id="7578732288516702259" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ubuntuç³»ç»Ÿä¸docker"/> <meta itemprop="keywords" content="Docker"/> <meta itemprop="datePublished" content="2025-12-02T02:56:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Dawn11"/> <meta itemprop="url" content="https://juejin.cn/user/4012584995709753"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ubuntuç³»ç»Ÿä¸docker
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4012584995709753/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Dawn11
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T02:56:51.000Z" title="Tue Dec 02 2025 02:56:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸€ å®‰è£…docker
1.æ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨</p>
<pre><code class="hljs language-shell" lang="shell">sudo apt update
</code></pre>
<ol start="2">
<li>å®‰è£…ä¾èµ–åŒ…</li>
</ol>
<pre><code class="hljs language-shell" lang="shell">sudo apt install -y apt-transport-https ca-certificates curl software-properties-common
</code></pre>
<ol start="3">
<li>æ·»åŠ é˜¿é‡Œäº‘GPGå¯†é’¥</li>
</ol>
<pre><code class="hljs language-shell" lang="shell">curl -fsSL http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg
</code></pre>
<ol start="4">
<li>æ·»åŠ é˜¿é‡Œäº‘Dockerè½¯ä»¶æº</li>
</ol>
<pre><code class="hljs language-shell" lang="shell">echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] http://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
</code></pre>
<ol start="5">
<li>å®‰è£…Docker Engine</li>
</ol>
<pre><code class="hljs language-shell" lang="shell">sudo apt-get update
sudo apt-get install -y docker-ce docker-ce-cli containerd.io
</code></pre>
<ol start="6">
<li>é…ç½®Dockeré•œåƒåŠ é€Ÿï¼ˆå¯é€‰ï¼‰</li>
</ol>
<p>ï¼ˆ1ï¼‰åˆ›å»ºDockeré…ç½®ç›®å½•</p>
<pre><code class="hljs language-shell" lang="shell">sudo mkdir -p /etc/docker
</code></pre>
<p>ï¼ˆ2ï¼‰ç¼–è¾‘é…ç½®æ–‡ä»¶</p>
<pre><code class="hljs language-shell" lang="shell">sudo tee /etc/docker/daemon.json &lt;&lt;-'EOF' { "registry-mirrors": ["https://ä½ çš„é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿåœ°å€.mirror.aliyuncs.com"] } EOF
</code></pre>
<blockquote>
<p>é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿåœ°å€éœ€ç™»å½•é˜¿é‡Œäº‘å®˜ç½‘ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fcr.console.aliyun.com%2F" target="_blank" title="https://cr.console.aliyun.com/" ref="nofollow noopener noreferrer">å®¹å™¨é•œåƒæœåŠ¡</a>ï¼‰ï¼Œåœ¨ã€Œé•œåƒå·¥å…·ã€â†’ã€Œé•œåƒåŠ é€Ÿå™¨ã€ä¸­è·å–ã€‚</p>
</blockquote>
<p>(3)é‡å¯DockeræœåŠ¡</p>
<pre><code class="hljs language-shell" lang="shell">sudo systemctl daemon-reload
sudo systemctl restart docker
</code></pre>
<ol start="7">
<li>éªŒè¯å®‰è£…</li>
</ol>
<pre><code class="hljs language-shell" lang="shell">docker --version
docker run hello-world # æµ‹è¯•æ‹‰å–é•œåƒ
</code></pre>
<p>äºŒ åˆ›å»ºå¹¶è¿›å…¥Dockerå®¹å™¨
æ–¹æ³• 1ï¼šåˆ›å»ºå¹¶äº¤äº’å¼è¿›å…¥å®¹å™¨ï¼ˆå¸¸ç”¨ï¼‰
ä½¿ç”¨Â <code>docker run</code>Â å‘½ä»¤åˆ›å»ºå¹¶ç›´æ¥è¿›å…¥å®¹å™¨ï¼Œå‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><code>-it</code>ï¼šäº¤äº’å¼æ¨¡å¼ï¼ˆ<code>-i</code>ï¼‰+ åˆ†é…ä¼ªç»ˆç«¯ï¼ˆ<code>-t</code>ï¼‰</li>
<li><code>--name</code>ï¼šæŒ‡å®šå®¹å™¨åç§°ï¼ˆå¯é€‰ï¼‰</li>
<li><code>é•œåƒå:æ ‡ç­¾</code>ï¼šä½¿ç”¨çš„é•œåƒï¼ˆå¦‚Â <code>ubuntu:latest</code>ã€<code>centos:7</code>Â ç­‰ï¼‰</li>
<li><code>/bin/bash</code>ï¼šè¿›å…¥å®¹å™¨åæ‰§è¡Œçš„å‘½ä»¤ï¼ˆé€šå¸¸ä¸º shellï¼‰</li>
</ul>
<p>ç¤ºä¾‹ï¼šåˆ›å»ºå¹¶è¿›å…¥ä¸€ä¸ªåä¸ºÂ <code>my-ubuntu</code>Â çš„ Ubuntu å®¹å™¨</p>
<pre><code class="hljs language-shell" lang="shell">sudo docker run -it --name my-ubuntu ubuntu:latest /bin/bash
</code></pre>
<p>æ–¹æ³•2ï¼šå…ˆåˆ›å»ºå®¹å™¨ï¼Œå†è¿›å…¥å®¹å™¨</p>
<ol>
<li>åˆ›å»ºå®¹å™¨ï¼ˆåå°è¿è¡Œï¼‰
<pre><code class="hljs language-bash" lang="bash">sudo docker create -it --name my-centos centos:7 /bin/bash
</code></pre>
</li>
<li>å¯åŠ¨å®¹å™¨
<pre><code class="hljs language-bash" lang="bash">sudo docker start my-centos
</code></pre>
</li>
<li>è¿›å…¥å®¹å™¨
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹æ³• Aï¼šä½¿ç”¨ exec è¿›å…¥ï¼ˆæ¨èï¼Œå¤šè¿›ç¨‹å®‰å…¨ï¼‰</span>
sudo docker <span class="hljs-built_in">exec</span> -it my-centos /bin/bash

<span class="hljs-comment"># æ–¹æ³• Bï¼šä½¿ç”¨ attach è¿›å…¥ï¼ˆå•è¿›ç¨‹ï¼Œé€€å‡ºä¼šåœæ­¢å®¹å™¨ï¼‰</span>
sudo docker attach my-centos
</code></pre>
</li>
</ol>
<p>ä¸‰ é€€å‡ºå®¹å™¨çš„æ–¹å¼
ä¸´æ—¶é€€å‡ºï¼Œä¿ç•™å®¹å™¨è¿è¡Œ</p>
<blockquote>
<p>æŒ‰Â <code>Ctrl + P + Q</code></p>
</blockquote>
<p>æ°¸ä¹…é€€å‡ºï¼Œåœæ­¢å®¹å™¨</p>
<blockquote>
<p>è¾“å…¥Â <code>exit</code>Â æˆ–æŒ‰Â <code>Ctrl + D</code></p>
</blockquote>
<p>å›› å¸¸ç”¨å®¹å™¨ç®¡ç†å‘½ä»¤</p>
<p>æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨</p>
<blockquote>
<p><code>sudo docker ps</code></p>
</blockquote>
<p>æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ˆå«åœæ­¢çš„ï¼‰</p>
<blockquote>
<p><code>sudo docker ps -a</code></p>
</blockquote>
<p>åœæ­¢å®¹å™¨</p>
<blockquote>
<p><code>sudo docker stop å®¹å™¨å/å®¹å™¨ID</code></p>
</blockquote>
<p>å¯åŠ¨å·²åœæ­¢çš„å®¹å™¨</p>
<blockquote>
<p><code>sudo docker start å®¹å™¨å/å®¹å™¨ID</code></p>
</blockquote>
<p>åˆ é™¤å®¹å™¨</p>
<blockquote>
<p><code>sudo docker rm å®¹å™¨å/å®¹å™¨ID</code></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[android ä½¿ç”¨ java ç¼–å†™ç½‘ç»œè¿é€šæ€§æ£€æŸ¥]]></title>    <link>https://juejin.cn/post/7578732288516898867</link>    <guid>https://juejin.cn/post/7578732288516898867</guid>    <pubDate>2025-12-02T02:58:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578732288516898867" data-draft-id="7578732288516866099" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="android ä½¿ç”¨ java ç¼–å†™ç½‘ç»œè¿é€šæ€§æ£€æŸ¥"/> <meta itemprop="keywords" content="å‰ç«¯,Java,Android"/> <meta itemprop="datePublished" content="2025-12-02T02:58:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="lichong951"/> <meta itemprop="url" content="https://juejin.cn/user/1486195453865687"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            android ä½¿ç”¨ java ç¼–å†™ç½‘ç»œè¿é€šæ€§æ£€æŸ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1486195453865687/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    lichong951
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T02:58:24.000Z" title="Tue Dec 02 2025 02:58:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸‹é¢ç»™å‡º <strong>çº¯ Java ä»£ç </strong>ã€<strong>å…¼å®¹ Android API 19+</strong>ã€<strong>é›¶ä¸‰æ–¹åº“</strong> çš„â€œç½‘ç»œè¿é€šæ€§æ£€æŸ¥â€å·¥å…·ç±»ã€‚
ç‰¹ç‚¹ï¼š</p>
<ul>
<li>åŒæ—¶æ£€æµ‹ <strong>Wi-Fi/ç§»åŠ¨æ•°æ®æ˜¯å¦çœŸæ­£ä¸Šç½‘</strong>ï¼ˆä¸åªæ˜¯â€œå·²è¿æ¥â€ï¼‰</li>
<li>ä½¿ç”¨ <strong>HttpURLConnection</strong>ï¼Œä¸é˜»å¡ä¸»çº¿ç¨‹</li>
<li>æ”¯æŒ <strong>è¶…æ—¶è®¾ç½®</strong>ï¼ˆç§’çº§ï¼‰</li>
<li>è¿”å› <strong>å¸ƒå°”ç»“æœ + å¤±è´¥åŸå› æ—¥å¿—</strong></li>
</ul>
<hr/>
<h3 data-id="heading-0">âœ… NetCheck.javaï¼ˆå¯ç›´æ¥æ‹·è´ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> android.content.Context;
<span class="hljs-keyword">import</span> android.net.ConnectivityManager;
<span class="hljs-keyword">import</span> android.net.NetworkInfo;
<span class="hljs-keyword">import</span> android.os.AsyncTask;
<span class="hljs-keyword">import</span> java.net.HttpURLConnection;
<span class="hljs-keyword">import</span> java.net.URL;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NetCheck</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Callback</span> {
        <span class="hljs-keyword">void</span> <span class="hljs-title function_">onResult</span><span class="hljs-params">(<span class="hljs-type">boolean</span> ok)</span>;
    }

    <span class="hljs-comment">/** å¯¹å¤–å…¥å£ï¼šä¸»çº¿ç¨‹è°ƒç”¨ï¼Œå›è°ƒä»åœ¨ä¸»çº¿ç¨‹ */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">isOnline</span><span class="hljs-params">(Context ctx, Callback cb)</span> {
        <span class="hljs-keyword">if</span> (!isConnected(ctx)) {
            cb.onResult(<span class="hljs-literal">false</span>);
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-comment">// çœŸæ­£å‘ HTTP æ¢æ´»</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">PingTask</span>(cb).execute();
    }

    <span class="hljs-comment">/* ========== å†…éƒ¨å®ç° ========== */</span>

    <span class="hljs-comment">/* 1. ç³»ç»Ÿæ˜¯å¦å£°æ˜å·²è¿æ¥ */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isConnected</span><span class="hljs-params">(Context ctx)</span> {
        <span class="hljs-type">ConnectivityManager</span> <span class="hljs-variable">cm</span> <span class="hljs-operator">=</span> (ConnectivityManager)
                ctx.getSystemService(Context.CONNECTIVITY_SERVICE);
        <span class="hljs-type">NetworkInfo</span> <span class="hljs-variable">info</span> <span class="hljs-operator">=</span> cm.getActiveNetworkInfo();
        <span class="hljs-keyword">return</span> info != <span class="hljs-literal">null</span> &amp;&amp; info.isConnected();
    }

    <span class="hljs-comment">/* 2. å¼‚æ­¥æ¢æ´»ï¼Œé¿å… ANR */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PingTask</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AsyncTask</span>&lt;Void, Void, Boolean&gt; {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Callback cb;
        PingTask(Callback cb) { <span class="hljs-built_in">this</span>.cb = cb; }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> Boolean <span class="hljs-title function_">doInBackground</span><span class="hljs-params">(Void... voids)</span> {
            <span class="hljs-type">HttpURLConnection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// â‘  å›½å†…é€šç”¨ã€å“åº”å¿«ï¼›â‘¡ æ”¯æŒ HEADï¼Œçœæµé‡</span>
                conn = (HttpURLConnection) <span class="hljs-keyword">new</span> <span class="hljs-title class_">URL</span>(<span class="hljs-string">"https://www.baidu.com"</span>).openConnection();
                conn.setRequestMethod(<span class="hljs-string">"HEAD"</span>);
                conn.setConnectTimeout(<span class="hljs-number">3_000</span>);
                conn.setReadTimeout(<span class="hljs-number">3_000</span>);
                <span class="hljs-type">int</span> <span class="hljs-variable">code</span> <span class="hljs-operator">=</span> conn.getResponseCode();
                <span class="hljs-keyword">return</span> (code &gt;= <span class="hljs-number">200</span> &amp;&amp; code &lt; <span class="hljs-number">400</span>);
            } <span class="hljs-keyword">catch</span> (Exception e) {
                e.printStackTrace();
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            } <span class="hljs-keyword">finally</span> {
                <span class="hljs-keyword">if</span> (conn != <span class="hljs-literal">null</span>) conn.disconnect();
            }
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onPostExecute</span><span class="hljs-params">(Boolean ok)</span> {
            cb.onResult(ok);
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">NetCheck</span><span class="hljs-params">()</span> {}
}
</code></pre>
<hr/>
<h3 data-id="heading-1">âœ… ä½¿ç”¨ç¤ºä¾‹ï¼ˆActivity/Fragment å†…ï¼‰</h3>
<pre><code class="hljs language-java" lang="java">NetCheck.isOnline(<span class="hljs-built_in">this</span>, ok -&gt; {
    <span class="hljs-keyword">if</span> (ok) {
        <span class="hljs-comment">// çœŸæ­£è¿ç½‘</span>
    } <span class="hljs-keyword">else</span> {
        Toast.makeText(<span class="hljs-built_in">this</span>, <span class="hljs-string">"ç½‘ç»œä¸å¯ç”¨"</span>, Toast.LENGTH_SHORT).show();
    }
});
</code></pre>
<hr/>
<h3 data-id="heading-2">âš ï¸ æƒé™è¦æ±‚ï¼ˆAndroidManifest.xmlï¼‰</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.ACCESS_NETWORK_STATE"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.INTERNET"</span>/&gt;</span>
</code></pre>
<hr/>
<h3 data-id="heading-3">ğŸ”§ å¦‚éœ€åŒæ­¥è°ƒç”¨ï¼ˆé˜»å¡ï¼‰</h3>
<p>æŠŠ <code>PingTask</code> é‡Œçš„ä»£ç æŠ½å‡ºæ¥ç›´æ¥è·‘å³å¯ï¼Œä½† <strong>ä¸¥ç¦åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œ</strong>ï¼Œå¦åˆ™ Android 7.0+ ä¼šæŠ› <code>NetworkOnMainThreadException</code>ã€‚</p>
<hr/>
<p>ä¸€å¥è¯æ€»ç»“
<strong>ä¸Šé¢ <code>NetCheck.isOnline()</code> å…¼é¡¾â€œæ˜¯å¦è¿ç½‘â€+â€œèƒ½å¦ä¸Šç½‘â€ï¼Œå…¼å®¹ API 19ï¼Œæ— ä¸‰æ–¹ä¾èµ–ï¼Œç›´æ¥å¤åˆ¶å³å¯ç”¨ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kotlin åç¨‹ä¸­Jobå’ŒSupervisorJob â€”â€” æ–°æ‰‹æŒ‡å—]]></title>    <link>https://juejin.cn/post/7578780780026855433</link>    <guid>https://juejin.cn/post/7578780780026855433</guid>    <pubDate>2025-12-02T03:03:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578780780026855433" data-draft-id="7578709098256400422" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kotlin åç¨‹ä¸­Jobå’ŒSupervisorJob â€”â€” æ–°æ‰‹æŒ‡å—"/> <meta itemprop="keywords" content="Kotlin,Android,Android Jetpack"/> <meta itemprop="datePublished" content="2025-12-02T03:03:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="QING618"/> <meta itemprop="url" content="https://juejin.cn/user/339115460529117"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kotlin åç¨‹ä¸­Jobå’ŒSupervisorJob â€”â€” æ–°æ‰‹æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/339115460529117/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    QING618
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T03:03:49.000Z" title="Tue Dec 02 2025 03:03:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Kotlinï¼šåç¨‹ä¸ºç®¡ç†å¼‚æ­¥æ“ä½œæä¾›äº†å¼ºå¤§çš„å·¥å…·ï¼Œè€Œ<code>Job</code>å’Œ<code>SupervisorJob</code>æ­£æ˜¯è¿™ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒã€‚ç†è§£è¿™äº›æ¦‚å¿µå¯¹äºæ„å»ºå¥å£®ã€å®¹é”™çš„åº”ç”¨ç¨‹åºè‡³å…³é‡è¦ã€‚æœ¬æ–‡å°†ä»å®ƒä»¬çš„åŒºåˆ«ã€ä½¿ç”¨åœºæ™¯å’Œæœ€ä½³å®è·µè¿›è¡Œè®²è§£ã€‚</h2>
<h2 data-id="heading-1">ä¸€ã€æ¦‚å¿µ</h2>
<h4 data-id="heading-2">ä»€ä¹ˆæ˜¯Jobï¼Ÿ</h4>
<p><code>Job</code>æ˜¯ä¸€ä¸ªå…·æœ‰ç”Ÿå‘½å‘¨æœŸçš„å¯å–æ¶ˆä»»åŠ¡ã€‚æ¯ä¸ªåç¨‹éƒ½æœ‰ä¸€ä¸ªå…³è”çš„Jobï¼Œç”¨äºæ§åˆ¶å…¶æ‰§è¡Œã€‚</p>
<p>ä½ å¯ä»¥æŠŠJobçœ‹ä½œæ˜¯åç¨‹çš„å¥æŸ„ï¼Œå®ƒå…è®¸ä½ ï¼š</p>
<ul>
<li>å–æ¶ˆåç¨‹</li>
<li>ç­‰å¾…å…¶å®Œæˆ</li>
<li>æ£€æŸ¥å…¶çŠ¶æ€ï¼ˆæ´»è·ƒã€å®Œæˆã€å–æ¶ˆï¼‰</li>
<li>å»ºç«‹çˆ¶å­å…³ç³»</li>
</ul>
<h4 data-id="heading-3">ä»€ä¹ˆæ˜¯SupervisorJobï¼Ÿ</h4>
<p><code>SupervisorJob</code>æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„Jobï¼Œå®ƒæ”¹å˜äº†å–æ¶ˆè¡Œä¸ºã€‚</p>
<p>ä½¿ç”¨SupervisorJobæ—¶ï¼š</p>
<ul>
<li><strong>å­Jobå¤±è´¥ä¸ä¼šå‘ä¸Šä¼ æ’­:</strong>  å¤±è´¥çš„å­Jobä¸ä¼šå–æ¶ˆçˆ¶Job</li>
<li><strong>å‘ä¸‹ä¼ æ’­ä»ç„¶æœ‰æ•ˆ:</strong>   å–æ¶ˆçˆ¶Jobä»ç„¶ä¼šå–æ¶ˆå­Job</li>
<li><strong>å…„å¼ŸJobç›¸äº’ç‹¬ç«‹ï¼š</strong>  ä¸€ä¸ªå­Jobçš„å¤±è´¥ä¸ä¼šå½±å“å…„å¼ŸJob</li>
</ul>
<h2 data-id="heading-4">äºŒã€ Jobç”Ÿå‘½å‘¨æœŸçŠ¶æ€</h2>
<ul>
<li><strong>æ–°å»º</strong> â€” Jobå·²åˆ›å»ºä½†å°šæœªå¯åŠ¨ï¼ˆä»…é€‚ç”¨äºæƒ°æ€§åç¨‹ï¼‰</li>
<li><strong>æ´»è·ƒ</strong> â€” Jobæ­£åœ¨è¿è¡Œ</li>
<li><strong>å®Œæˆä¸­</strong> â€” Jobæ­£åœ¨å®Œæˆä½†ç­‰å¾…å­Job</li>
<li><strong>å·²å®Œæˆ</strong> â€” JobæˆåŠŸå®Œæˆ</li>
<li><strong>å–æ¶ˆä¸­</strong> â€” Jobæ­£åœ¨è¢«å–æ¶ˆ</li>
<li><strong>å·²å–æ¶ˆ</strong> â€” Jobå·²è¢«å–æ¶ˆ</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/302e662c76544fec8c6f97ffd75987ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUUlORzYxOA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765249428&amp;x-signature=HuSunEV2NPNT8kmld%2FTW8MnAKGI%3D" alt="deepseek_mermaid_20251202_892c7b.png" loading="lazy"/></p>
<h2 data-id="heading-5">ä¸‰ã€JobçŠ¶æ€è¯¦ç»†è¯´æ˜åŠç¤ºä¾‹</h2>
<h4 data-id="heading-6">1.Â New (æ–°å»º)</h4>
<ul>
<li>åˆšåˆšåˆ›å»ºä½†è¿˜æœªå¯åŠ¨çš„ Job</li>
<li>éœ€è¦é€šè¿‡Â <code>start()</code>Â æˆ–Â <code>launch</code>Â å¯åŠ¨</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> job = Job()  <span class="hljs-comment">// åˆ›å»ºåå¤„äº New çŠ¶æ€</span>
job.start()      <span class="hljs-comment">// å¯åŠ¨åå˜ä¸º Active</span>
</code></pre>
<h4 data-id="heading-7">2.Â Active (æ´»è·ƒ)</h4>
<ul>
<li>Job æ­£åœ¨è¿è¡Œ</li>
<li>å¯ä»¥åˆ›å»ºå­åç¨‹</li>
<li>å±æ€§çŠ¶æ€ï¼š
<ul>
<li><code>isActive = true</code></li>
<li><code>isCompleted = false</code></li>
<li><code>isCancelled = false</code></li>
</ul>
</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> job = launch {
    <span class="hljs-comment">// åç¨‹ä½“æ‰§è¡Œä¸­ - Active çŠ¶æ€</span>
    delay(<span class="hljs-number">1000</span>)
    println(<span class="hljs-string">"Done"</span>)
}
</code></pre>
<h4 data-id="heading-8">3.Â Completing (å®Œæˆä¸­)</h4>
<ul>
<li>åç¨‹ä½“å·²æ‰§è¡Œå®Œæ¯•</li>
<li>æ­£åœ¨ç­‰å¾…æ‰€æœ‰å­åç¨‹å®Œæˆ</li>
<li>å±æ€§çŠ¶æ€ï¼š
<ul>
<li><code>isActive = false</code></li>
<li><code>isCompleted = false</code>Â (è¿˜æœ‰å­åç¨‹æœªå®Œæˆ)</li>
</ul>
</li>
</ul>
<h4 data-id="heading-9">4.Â Completed (å·²å®Œæˆ)</h4>
<ul>
<li>åç¨‹åŠå…¶æ‰€æœ‰å­åç¨‹éƒ½å·²æ­£å¸¸å®Œæˆ</li>
<li>å±æ€§çŠ¶æ€ï¼š
<ul>
<li><code>isActive = false</code></li>
<li><code>isCompleted = true</code></li>
<li><code>isCancelled = false</code></li>
</ul>
</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> job = launch {
    <span class="hljs-comment">// æ­£å¸¸æ‰§è¡Œå®Œæˆ</span>
}
job.join()  <span class="hljs-comment">// ç­‰å¾…è¿›å…¥ Completed çŠ¶æ€</span>
</code></pre>
<h4 data-id="heading-10">5.Â Cancelling (å–æ¶ˆä¸­)</h4>
<ul>
<li>æ”¶åˆ°å–æ¶ˆè¯·æ±‚ï¼Œæ­£åœ¨æ‰§è¡Œå–æ¶ˆæ“ä½œ</li>
<li>å¯èƒ½è¿˜åœ¨æ‰§è¡ŒÂ <code>finally</code>Â å—æˆ–æŒ‚èµ·å‡½æ•°</li>
<li>å±æ€§çŠ¶æ€ï¼š
<ul>
<li><code>isActive = false</code></li>
<li><code>isCancelled = true</code></li>
</ul>
</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> job = launch {
    <span class="hljs-keyword">try</span> {
        delay(<span class="hljs-number">10000</span>)
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-comment">// è¿›å…¥ Cancelling çŠ¶æ€</span>
        delay(<span class="hljs-number">1000</span>)  <span class="hljs-comment">// ä»å¯æ‰§è¡ŒæŒ‚èµ·å‡½æ•°</span>
    }
}
delay(<span class="hljs-number">100</span>)
job.cancel()  <span class="hljs-comment">// è§¦å‘ Cancelling çŠ¶æ€</span>
</code></pre>
<h4 data-id="heading-11">6.Â Cancelled (å·²å–æ¶ˆ)</h4>
<ul>
<li>å–æ¶ˆæ“ä½œå·²å®Œæˆ</li>
<li>å±æ€§çŠ¶æ€ï¼š
<ul>
<li><code>isActive = false</code></li>
<li><code>isCompleted = true</code>Â (æ³¨æ„ï¼šå·²å–æ¶ˆä¹Ÿè¢«è§†ä¸ºå®Œæˆ)</li>
<li><code>isCancelled = true</code></li>
</ul>
</li>
</ul>
<h4 data-id="heading-12">7. çŠ¶æ€æ£€æŸ¥æ–¹æ³•</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> job = launch {
    <span class="hljs-comment">// åç¨‹ä½“</span>
}

<span class="hljs-comment">// æ£€æŸ¥çŠ¶æ€</span>
println(<span class="hljs-string">"isActive: <span class="hljs-subst">${job.isActive}</span>"</span>)      <span class="hljs-comment">// æ˜¯å¦æ´»è·ƒ</span>
println(<span class="hljs-string">"isCompleted: <span class="hljs-subst">${job.isCompleted}</span>"</span>) <span class="hljs-comment">// æ˜¯å¦å®Œæˆ</span>
println(<span class="hljs-string">"isCancelled: <span class="hljs-subst">${job.isCancelled}</span>"</span>) <span class="hljs-comment">// æ˜¯å¦å–æ¶ˆ</span>

<span class="hljs-comment">// ç­‰å¾…å®Œæˆ</span>
job.join()

<span class="hljs-comment">// å–æ¶ˆ Job</span>
job.cancel()

<span class="hljs-comment">// å–æ¶ˆå¹¶ç­‰å¾…å®Œæˆ</span>
job.cancelAndJoin()
</code></pre>
<h4 data-id="heading-13">8. çŠ¶æ€è½¬æ¢ç¤ºä¾‹</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-keyword">val</span> job = launch {
        println(<span class="hljs-string">"1. Job started - Active"</span>)
        <span class="hljs-keyword">try</span> {
            delay(<span class="hljs-number">2000</span>)
            println(<span class="hljs-string">"2. Normal completion - Completing â†’ Completed"</span>)
        } <span class="hljs-keyword">finally</span> {
            println(<span class="hljs-string">"3. Finally block - Cancelling"</span>)
            delay(<span class="hljs-number">500</span>)  <span class="hljs-comment">// åœ¨å–æ¶ˆä¸­ä»å¯æŒ‚èµ·</span>
        }
    }
    
    delay(<span class="hljs-number">500</span>)
    job.cancel()  <span class="hljs-comment">// Active â†’ Cancelling</span>
    job.join()    <span class="hljs-comment">// ç­‰å¾…è¿›å…¥ Cancelled</span>
    println(<span class="hljs-string">"4. Final state: isCancelled=<span class="hljs-subst">${job.isCancelled}</span>"</span>)
}
</code></pre>
<h2 data-id="heading-14">å››ã€Jobé‡è¦æ³¨æ„äº‹é¡¹</h2>
<h4 data-id="heading-15">1. Completed å’Œ Cancelled éƒ½æ˜¯å®ŒæˆçŠ¶æ€**</h4>
<ul>
<li><code>isCompleted = true</code>Â è¡¨ç¤ºä¸¤è€…</li>
<li>éœ€è¦ç”¨Â <code>isCancelled</code>Â åŒºåˆ†</li>
</ul>
<h4 data-id="heading-16">2. çŠ¶æ€æ£€æŸ¥æ˜¯ç¬æ—¶çš„</h4>
<ul>
<li>çŠ¶æ€å¯èƒ½åœ¨ä½ æ£€æŸ¥åç«‹å³æ”¹å˜</li>
</ul>
<h4 data-id="heading-17">3.  çˆ¶å­å…³ç³»å½±å“çŠ¶æ€</h4>
<ul>
<li>çˆ¶ Job å–æ¶ˆä¼šå¯¼è‡´æ‰€æœ‰å­ Job å–æ¶ˆ</li>
<li>çˆ¶ Job ç­‰å¾…æ‰€æœ‰å­ Job å®Œæˆæ‰èƒ½è¿›å…¥ Completed</li>
</ul>
<h4 data-id="heading-18">4.  ç»“æ„åŒ–å¹¶å‘</h4>
<ul>
<li>çˆ¶åç¨‹çš„ä½œç”¨åŸŸå–æ¶ˆä¼šä¼ æ’­åˆ°æ‰€æœ‰å­åç¨‹</li>
<li>çˆ¶åç¨‹ä¼šç­‰å¾…æ‰€æœ‰å­åç¨‹å®Œæˆ</li>
</ul>
<h2 data-id="heading-19">äº”ã€SupervisorJobåŸºç¡€ç¤ºä¾‹</h2>
<h4 data-id="heading-20">1. å¤±è´¥ä¸ä¼šä¼ æ’­</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-keyword">val</span> supervisorJob = SupervisorJob()  <span class="hljs-comment">// SupervisorJob</span>
    
    launch(supervisorJob) {
        println(<span class="hljs-string">"Child 1 starts"</span>)
        delay(<span class="hljs-number">100</span>)
        <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Child 1 failed!"</span>)
    }
    
    launch(supervisorJob) {
        println(<span class="hljs-string">"Child 2 starts"</span>)
        delay(<span class="hljs-number">200</span>)
        println(<span class="hljs-string">"Child 2 completed"</span>)  <span class="hljs-comment">// è¿™ä¸ªä¼šæ­£å¸¸æ‰§è¡Œ</span>
    }
    
    delay(<span class="hljs-number">300</span>)
    println(<span class="hljs-string">"Supervisor is alive: <span class="hljs-subst">${supervisorJob.isActive}</span>"</span>)  <span class="hljs-comment">// true</span>
    println(<span class="hljs-string">"Supervisor children active: <span class="hljs-subst">${supervisorJob.children.count { it.isActive }</span>}"</span>)
}
</code></pre>
<h4 data-id="heading-21">2. æ¨èä½¿ç”¨Â <code>supervisorScope</code>Â æ„å»ºå™¨</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    supervisorScope {
        <span class="hljs-keyword">val</span> child1 = launch {
            println(<span class="hljs-string">"Task 1 started"</span>)
            delay(<span class="hljs-number">500</span>)
            <span class="hljs-keyword">throw</span> ArithmeticException(<span class="hljs-string">"Task 1 calculation error!"</span>)
        }
        
        <span class="hljs-keyword">val</span> child2 = launch {
            println(<span class="hljs-string">"Task 2 started"</span>)
            delay(<span class="hljs-number">1000</span>)
            println(<span class="hljs-string">"Task 2 completed successfully"</span>)
        }
        
        <span class="hljs-keyword">val</span> child3 = launch {
            println(<span class="hljs-string">"Task 3 started"</span>)
            delay(<span class="hljs-number">1500</span>)
            println(<span class="hljs-string">"Task 3 completed successfully"</span>)
        }
        
        <span class="hljs-comment">// å¤„ç†å„ä¸ªå­åç¨‹çš„ç»“æœ</span>
        child1.join()  <span class="hljs-comment">// ä¼šæŠ›å‡ºå¼‚å¸¸</span>
        println(<span class="hljs-string">"Child1 joined, isCancelled: <span class="hljs-subst">${child1.isCancelled}</span>"</span>)
        
        child2.join()  <span class="hljs-comment">// æ­£å¸¸å®Œæˆ</span>
        println(<span class="hljs-string">"Child2 joined, isCompleted: <span class="hljs-subst">${child2.isCompleted}</span>"</span>)
        
        child3.join()  <span class="hljs-comment">// æ­£å¸¸å®Œæˆ</span>
        println(<span class="hljs-string">"All tasks processed"</span>)
    }
    
    println(<span class="hljs-string">"SupervisorScope completed"</span>)
}
</code></pre>
<h2 data-id="heading-22">å…­ã€SupervisorJobå®é™…åº”ç”¨åœºæ™¯</h2>
<h4 data-id="heading-23">1. å¹¶è¡Œä¸‹è½½å¤šä¸ªæ–‡ä»¶</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*

<span class="hljs-keyword">class</span> <span class="hljs-title class_">FileDownloader</span> {
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">downloadFiles</span><span class="hljs-params">(urls: <span class="hljs-type">List</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> = supervisorScope {
        <span class="hljs-keyword">val</span> downloadJobs = urls.map { url -&gt;
            async {
                <span class="hljs-keyword">try</span> {
                    println(<span class="hljs-string">"Downloading <span class="hljs-variable">$url</span>"</span>)
                    delay((<span class="hljs-number">100.</span><span class="hljs-number">.500</span>).random().toLong())  <span class="hljs-comment">// æ¨¡æ‹Ÿä¸‹è½½</span>
                    <span class="hljs-keyword">if</span> (url.contains(<span class="hljs-string">"error"</span>)) {
                        <span class="hljs-keyword">throw</span> Exception(<span class="hljs-string">"Failed to download <span class="hljs-variable">$url</span>"</span>)
                    }
                    <span class="hljs-string">"Content of <span class="hljs-variable">$url</span>"</span>
                } <span class="hljs-keyword">catch</span> (e: Exception) {
                    println(<span class="hljs-string">"Error downloading <span class="hljs-variable">$url</span>: <span class="hljs-subst">${e.message}</span>"</span>)
                    <span class="hljs-literal">null</span>  <span class="hljs-comment">// è¿”å› null è¡¨ç¤ºå¤±è´¥</span>
                }
            }
        }
        
        <span class="hljs-comment">// æ”¶é›†æ‰€æœ‰ç»“æœï¼ˆåŒ…æ‹¬å¤±è´¥çš„ï¼‰</span>
        <span class="hljs-keyword">val</span> results = downloadJobs.map { it.await() }
        results.filterNotNull()  <span class="hljs-comment">// è¿”å›æˆåŠŸä¸‹è½½çš„å†…å®¹</span>
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-keyword">val</span> downloader = FileDownloader()
    <span class="hljs-keyword">val</span> urls = listOf(
        <span class="hljs-string">"http://example.com/file1.txt"</span>,
        <span class="hljs-string">"http://example.com/file2-error.txt"</span>,  <span class="hljs-comment">// è¿™ä¸ªä¼šå¤±è´¥</span>
        <span class="hljs-string">"http://example.com/file3.txt"</span>,
        <span class="hljs-string">"http://example.com/file4-error.txt"</span>   <span class="hljs-comment">// è¿™ä¸ªä¹Ÿä¼šå¤±è´¥</span>
    )
    
    <span class="hljs-keyword">val</span> successfulDownloads = downloader.downloadFiles(urls)
    println(<span class="hljs-string">"Successfully downloaded <span class="hljs-subst">${successfulDownloads.size}</span> files"</span>)
}
</code></pre>
<h4 data-id="heading-24">2. å¾®æœåŠ¡å¥åº·æ£€æŸ¥</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> java.time.LocalDateTime

<span class="hljs-keyword">class</span> <span class="hljs-title class_">HealthChecker</span> {
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ServiceStatus</span>(
        <span class="hljs-keyword">val</span> name: String,
        <span class="hljs-keyword">val</span> isHealthy: <span class="hljs-built_in">Boolean</span>,
        <span class="hljs-keyword">val</span> responseTime: <span class="hljs-built_in">Long</span>,
        <span class="hljs-keyword">val</span> error: String? = <span class="hljs-literal">null</span>
    )
    
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">checkAllServices</span><span class="hljs-params">()</span></span> = supervisorScope {
        <span class="hljs-keyword">val</span> services = listOf(
            <span class="hljs-string">"auth-service"</span> to <span class="hljs-string">"http://auth:8080/health"</span>,
            <span class="hljs-string">"payment-service"</span> to <span class="hljs-string">"http://payment:8080/health"</span>,
            <span class="hljs-string">"notification-service"</span> to <span class="hljs-string">"http://notification:8080/health"</span>,
            <span class="hljs-string">"database"</span> to <span class="hljs-string">"http://db:5432/health"</span>
        )
        
        services.map { (name, url) -&gt;
            async {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">val</span> startTime = System.currentTimeMillis()
                    <span class="hljs-comment">// æ¨¡æ‹Ÿå¥åº·æ£€æŸ¥è¯·æ±‚</span>
                    delay((<span class="hljs-number">50.</span><span class="hljs-number">.500</span>).random().toLong())
                    
                    <span class="hljs-comment">// æ¨¡æ‹Ÿéšæœºå¤±è´¥</span>
                    <span class="hljs-keyword">if</span> (Math.random() &lt; <span class="hljs-number">0.3</span>) {
                        <span class="hljs-keyword">throw</span> Exception(<span class="hljs-string">"<span class="hljs-variable">$name</span> timeout"</span>)
                    }
                    
                    <span class="hljs-keyword">val</span> responseTime = System.currentTimeMillis() - startTime
                    ServiceStatus(name, isHealthy = <span class="hljs-literal">true</span>, responseTime)
                } <span class="hljs-keyword">catch</span> (e: Exception) {
                    ServiceStatus(name, isHealthy = <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>, e.message)
                }
            }
        }.map { it.await() }
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-keyword">val</span> checker = HealthChecker()
    
    repeat(<span class="hljs-number">3</span>) { checkNumber -&gt;
        println(<span class="hljs-string">"\n=== Health Check #<span class="hljs-subst">${checkNumber + <span class="hljs-number">1</span>}</span> ==="</span>)
        <span class="hljs-keyword">val</span> results = checker.checkAllServices()
        
        results.forEach { status -&gt;
            <span class="hljs-keyword">val</span> statusIcon = <span class="hljs-keyword">if</span> (status.isHealthy) <span class="hljs-string">"âœ…"</span> <span class="hljs-keyword">else</span> <span class="hljs-string">"âŒ"</span>
            println(<span class="hljs-string">"<span class="hljs-variable">$statusIcon</span> <span class="hljs-subst">${status.name}</span>: "</span> +
                   <span class="hljs-keyword">if</span> (status.isHealthy) <span class="hljs-string">"<span class="hljs-subst">${status.responseTime}</span>ms"</span> 
                   <span class="hljs-keyword">else</span> <span class="hljs-string">"ERROR: <span class="hljs-subst">${status.error}</span>"</span>)
        }
        
        <span class="hljs-keyword">val</span> healthyCount = results.count { it.isHealthy }
        println(<span class="hljs-string">"\nSummary: <span class="hljs-variable">$healthyCount</span>/<span class="hljs-subst">${results.size}</span> services healthy"</span>)
        
        delay(<span class="hljs-number">2000</span>)
    }
}
</code></pre>
<h4 data-id="heading-25">3. UI åº”ç”¨ä¸­çš„å¹¶è¡Œä»»åŠ¡</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserDashboardViewModel</span> {
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadDashboardData</span><span class="hljs-params">(userId: <span class="hljs-type">String</span>)</span></span>: DashboardData = supervisorScope {
        <span class="hljs-comment">// å¹¶è¡ŒåŠ è½½å„ç§æ•°æ®</span>
        <span class="hljs-keyword">val</span> userProfile = async { 
            loadUserProfile(userId) 
        }
        
        <span class="hljs-keyword">val</span> recentOrders = async { 
            loadRecentOrders(userId) 
        }
        
        <span class="hljs-keyword">val</span> notifications = async { 
            loadNotifications(userId) 
        }
        
        <span class="hljs-keyword">val</span> recommendations = async { 
            <span class="hljs-keyword">try</span> {
                loadRecommendations(userId)
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                <span class="hljs-comment">// æ¨èå¤±è´¥ä¸å½±å“å…¶ä»–æ•°æ®</span>
                emptyList&lt;Recommendation&gt;()
            }
        }
        
        <span class="hljs-comment">// ç­‰å¾…æ‰€æœ‰è¯·æ±‚å®Œæˆ</span>
        DashboardData(
            profile = userProfile.await(),
            orders = recentOrders.await(),
            notifications = notifications.await(),
            recommendations = recommendations.await()
        )
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadUserProfile</span><span class="hljs-params">(userId: <span class="hljs-type">String</span>)</span></span>: UserProfile {
        delay(<span class="hljs-number">300</span>)
        <span class="hljs-keyword">return</span> UserProfile(<span class="hljs-string">"User <span class="hljs-variable">$userId</span>"</span>)
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadRecentOrders</span><span class="hljs-params">(userId: <span class="hljs-type">String</span>)</span></span>: List&lt;Order&gt; {
        delay(<span class="hljs-number">400</span>)
        <span class="hljs-keyword">return</span> listOf(Order(<span class="hljs-string">"Order1"</span>), Order(<span class="hljs-string">"Order2"</span>))
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadNotifications</span><span class="hljs-params">(userId: <span class="hljs-type">String</span>)</span></span>: List&lt;Notification&gt; {
        delay(<span class="hljs-number">200</span>)
        <span class="hljs-keyword">if</span> (Math.random() &lt; <span class="hljs-number">0.2</span>) <span class="hljs-keyword">throw</span> Exception(<span class="hljs-string">"Notification service down"</span>)
        <span class="hljs-keyword">return</span> listOf(Notification(<span class="hljs-string">"New message"</span>))
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadRecommendations</span><span class="hljs-params">(userId: <span class="hljs-type">String</span>)</span></span>: List&lt;Recommendation&gt; {
        delay(<span class="hljs-number">500</span>)
        <span class="hljs-keyword">if</span> (Math.random() &lt; <span class="hljs-number">0.3</span>) <span class="hljs-keyword">throw</span> Exception(<span class="hljs-string">"Recommendation engine error"</span>)
        <span class="hljs-keyword">return</span> listOf(Recommendation(<span class="hljs-string">"Item 1"</span>), Recommendation(<span class="hljs-string">"Item 2"</span>))
    }
    
    <span class="hljs-comment">// æ•°æ®ç±»</span>
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DashboardData</span>(
        <span class="hljs-keyword">val</span> profile: UserProfile,
        <span class="hljs-keyword">val</span> orders: List&lt;Order&gt;,
        <span class="hljs-keyword">val</span> notifications: List&lt;Notification&gt;,
        <span class="hljs-keyword">val</span> recommendations: List&lt;Recommendation&gt;
    )
    
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserProfile</span>(<span class="hljs-keyword">val</span> name: String)
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Order</span>(<span class="hljs-keyword">val</span> id: String)
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Notification</span>(<span class="hljs-keyword">val</span> message: String)
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Recommendation</span>(<span class="hljs-keyword">val</span> item: String)
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-keyword">val</span> viewModel = UserDashboardViewModel()
    
    repeat(<span class="hljs-number">5</span>) {
        <span class="hljs-keyword">try</span> {
            println(<span class="hljs-string">"\nLoading dashboard..."</span>)
            <span class="hljs-keyword">val</span> dashboard = viewModel.loadDashboardData(<span class="hljs-string">"user123"</span>)
            println(<span class="hljs-string">"Dashboard loaded successfully:"</span>)
            println(<span class="hljs-string">"- Profile: <span class="hljs-subst">${dashboard.profile.name}</span>"</span>)
            println(<span class="hljs-string">"- Orders: <span class="hljs-subst">${dashboard.orders.size}</span>"</span>)
            println(<span class="hljs-string">"- Notifications: <span class="hljs-subst">${dashboard.notifications.size}</span>"</span>)
            println(<span class="hljs-string">"- Recommendations: <span class="hljs-subst">${dashboard.recommendations.size}</span>"</span>)
        } <span class="hljs-keyword">catch</span> (e: Exception) {
            println(<span class="hljs-string">"Critical error loading dashboard: <span class="hljs-subst">${e.message}</span>"</span>)
        }
        delay(<span class="hljs-number">1000</span>)
    }
}
</code></pre>
<h2 data-id="heading-26">ä¸ƒã€SupervisorJobé«˜çº§ç”¨æ³•ï¼šè‡ªå®šä¹‰é”™è¯¯å¤„ç†</h2>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ResilientTaskManager</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> supervisorJob = SupervisorJob()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> scope = CoroutineScope(Dispatchers.IO + supervisorJob)
    
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TaskResult</span>(<span class="hljs-keyword">val</span> id: String, <span class="hljs-keyword">val</span> success: <span class="hljs-built_in">Boolean</span>, <span class="hljs-keyword">val</span> value: Any? = <span class="hljs-literal">null</span>, <span class="hljs-keyword">val</span> error: String? = <span class="hljs-literal">null</span>)
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">submitTask</span><span class="hljs-params">(taskId: <span class="hljs-type">String</span>, task: <span class="hljs-type">suspend</span> () -&gt; <span class="hljs-type">Any</span>)</span></span> {
        scope.launch {
            <span class="hljs-keyword">try</span> {
                println(<span class="hljs-string">"[<span class="hljs-variable">$taskId</span>] Starting task"</span>)
                <span class="hljs-keyword">val</span> result = task()
                println(<span class="hljs-string">"[<span class="hljs-variable">$taskId</span>] Task completed successfully"</span>)
                onTaskCompleted(TaskResult(taskId, <span class="hljs-literal">true</span>, result))
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                println(<span class="hljs-string">"[<span class="hljs-variable">$taskId</span>] Task failed: <span class="hljs-subst">${e.message}</span>"</span>)
                onTaskCompleted(TaskResult(taskId, <span class="hljs-literal">false</span>, error = e.message))
                <span class="hljs-comment">// å¤±è´¥çš„ä»»åŠ¡å¯ä»¥åœ¨è¿™é‡Œé‡è¯•</span>
                <span class="hljs-keyword">if</span> (shouldRetry(taskId)) {
                    delay(<span class="hljs-number">1000</span>)
                    println(<span class="hljs-string">"[<span class="hljs-variable">$taskId</span>] Retrying..."</span>)
                    submitTask(<span class="hljs-string">"<span class="hljs-variable">$taskId</span>-retry"</span>, task)
                }
            }
        }
    }
    
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">shutdown</span><span class="hljs-params">(timeoutMillis: <span class="hljs-type">Long</span> = <span class="hljs-number">5000</span>)</span></span> {
        scope.cancel()
        <span class="hljs-keyword">try</span> {
            withTimeout(timeoutMillis) {
                supervisorJob.join()
            }
            println(<span class="hljs-string">"All tasks completed gracefully"</span>)
        } <span class="hljs-keyword">catch</span> (e: TimeoutCancellationException) {
            println(<span class="hljs-string">"Some tasks did not complete in time"</span>)
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onTaskCompleted</span><span class="hljs-params">(result: <span class="hljs-type">TaskResult</span>)</span></span> {
        <span class="hljs-comment">// å¤„ç†ä»»åŠ¡å®Œæˆäº‹ä»¶</span>
        println(<span class="hljs-string">"Task <span class="hljs-subst">${result.id}</span>: <span class="hljs-subst">${if (result.success) <span class="hljs-string">"SUCCESS"</span> else <span class="hljs-string">"FAILED"</span>}</span>"</span>)
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">shouldRetry</span><span class="hljs-params">(taskId: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {
        <span class="hljs-keyword">return</span> !taskId.contains(<span class="hljs-string">"no-retry"</span>)
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-keyword">val</span> manager = ResilientTaskManager()
    
    <span class="hljs-comment">// æäº¤å¤šä¸ªä»»åŠ¡</span>
    manager.submitTask(<span class="hljs-string">"task-1"</span>) {
        delay(<span class="hljs-number">1000</span>)
        <span class="hljs-string">"Result 1"</span>
    }
    
    manager.submitTask(<span class="hljs-string">"task-2-error"</span>) {
        delay(<span class="hljs-number">500</span>)
        <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Simulated error in task 2"</span>)
    }
    
    manager.submitTask(<span class="hljs-string">"task-3-no-retry"</span>) {
        delay(<span class="hljs-number">800</span>)
        <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Fatal error - no retry"</span>)
    }
    
    manager.submitTask(<span class="hljs-string">"task-4"</span>) {
        delay(<span class="hljs-number">1200</span>)
        <span class="hljs-string">"Result 4"</span>
    }
    
    <span class="hljs-comment">// ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ</span>
    delay(<span class="hljs-number">3000</span>)
    manager.shutdown()
}
</code></pre>
<h2 data-id="heading-27">å…«ã€SupervisorJob é‡è¦æ³¨æ„äº‹é¡¹</h2>
<h4 data-id="heading-28">1. é”™è¯¯å¤„ç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin">supervisorScope {
    <span class="hljs-keyword">val</span> child = launch {
        <span class="hljs-keyword">throw</span> Exception(<span class="hljs-string">"Child failed"</span>)
    }
    
    <span class="hljs-comment">// å¿…é¡»æ˜¾å¼å¤„ç†å­åç¨‹å¼‚å¸¸</span>
    <span class="hljs-keyword">try</span> {
        child.join()
    } <span class="hljs-keyword">catch</span> (e: Exception) {
        println(<span class="hljs-string">"Caught child exception: <span class="hljs-subst">${e.message}</span>"</span>)
    }
}
</code></pre>
<h4 data-id="heading-29">2. ä¸ CoroutineExceptionHandler é…åˆ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> handler = CoroutineExceptionHandler { _, exception -&gt;
    println(<span class="hljs-string">"Uncaught exception: <span class="hljs-subst">${exception.message}</span>"</span>)
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-keyword">val</span> supervisor = SupervisorJob()
    <span class="hljs-keyword">val</span> scope = CoroutineScope(Dispatchers.Default + supervisor + handler)
    
    scope.launch {
        <span class="hljs-keyword">throw</span> Exception(<span class="hljs-string">"This will be caught by handler"</span>)
    }
    
    scope.launch {
        delay(<span class="hljs-number">1000</span>)
        println(<span class="hljs-string">"I'm still running!"</span>)
    }
    
    delay(<span class="hljs-number">2000</span>)
    supervisor.cancel()
}
</code></pre>
<h4 data-id="heading-30">3. é™åˆ¶å¹¶å‘æ•°</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.sync.Semaphore

<span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">limitedParallelTasks</span><span class="hljs-params">(tasks: <span class="hljs-type">List</span>&lt;<span class="hljs-type">suspend</span> () -&gt; <span class="hljs-type">Unit</span>&gt;, maxConcurrent: <span class="hljs-type">Int</span> = <span class="hljs-number">3</span>)</span></span> {
    <span class="hljs-keyword">val</span> semaphore = Semaphore(maxConcurrent)
    
    supervisorScope {
        tasks.map { task -&gt;
            launch {
                semaphore.withPermit {
                    task()
                }
            }
        }.forEach { it.join() }
    }
}
</code></pre>
<h2 data-id="heading-31">ä¹ã€SupervisorJobæ€»ç»“</h2>
<p><strong>SupervisorJob çš„ä¸»è¦ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<ol>
<li>éœ€è¦ç‹¬ç«‹æ‰§è¡Œå¤šä¸ªä»»åŠ¡çš„åœºæ™¯</li>
<li>ä¸€ä¸ªä»»åŠ¡çš„å¤±è´¥ä¸åº”å½±å“å…¶ä»–ä»»åŠ¡</li>
<li>UI åº”ç”¨ä¸­å¹¶è¡ŒåŠ è½½å¤šä¸ªæ•°æ®æº</li>
<li>æ‰¹é‡å¤„ç†ä»»åŠ¡ï¼Œå…è®¸éƒ¨åˆ†å¤±è´¥</li>
<li>å¾®æœåŠ¡æ¶æ„ä¸­çš„å¥åº·æ£€æŸ¥ã€ç›‘æ§ç­‰</li>
</ol>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨Â <code>supervisorScope</code>Â æˆ–Â <code>SupervisorJob()</code>Â åˆ›å»º</li>
<li>å­åç¨‹å¼‚å¸¸éœ€è¦æ˜¾å¼å¤„ç†</li>
<li>é…åˆÂ <code>CoroutineExceptionHandler</code>Â è¿›è¡Œå…¨å±€é”™è¯¯å¤„ç†</li>
<li>æ³¨æ„èµ„æºæ¸…ç†å’Œè¶…æ—¶æ§åˆ¶</li>
</ul>
<p>é€šè¿‡ SupervisorJobï¼Œä½ å¯ä»¥æ„å»ºæ›´å¥å£®ã€å®¹é”™æ€§æ›´å¥½çš„å¹¶å‘åº”ç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript ä¸­çš„é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šä»åŸºç¡€åˆ°ç»§æ‰¿]]></title>    <link>https://juejin.cn/post/7578820431018459151</link>    <guid>https://juejin.cn/post/7578820431018459151</guid>    <pubDate>2025-12-01T15:54:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578820431018459151" data-draft-id="7578700798744789026" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript ä¸­çš„é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šä»åŸºç¡€åˆ°ç»§æ‰¿"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-01T15:54:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ouma_syu"/> <meta itemprop="url" content="https://juejin.cn/user/2728363512824729"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript ä¸­çš„é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šä»åŸºç¡€åˆ°ç»§æ‰¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2728363512824729/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ouma_syu
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-01T15:54:03.000Z" title="Mon Dec 01 2025 15:54:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">JavaScript ä¸­çš„é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šä»åŸºç¡€åˆ°ç»§æ‰¿</h2>
<p>JavaScriptï¼ˆç®€ç§° JSï¼‰ä½œä¸ºä¸€ç§çµæ´»çš„è„šæœ¬è¯­è¨€ï¼Œå¸¸è¢«æè¿°ä¸ºâ€œåŸºäºå¯¹è±¡â€ï¼ˆObject-basedï¼‰çš„è¯­è¨€ï¼Œè€Œä¸æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„â€œé¢å‘å¯¹è±¡â€ï¼ˆObject-Oriented Programmingï¼ŒOOPï¼‰è¯­è¨€ã€‚è¿™æ˜¯å› ä¸º JS çš„æ ¸å¿ƒæœºåˆ¶ä¾èµ–äºåŸå‹ï¼ˆprototypeï¼‰ç³»ç»Ÿï¼Œè€Œéä¼ ç»Ÿçš„ç±»ï¼ˆclassï¼‰ç»§æ‰¿æ¨¡å‹ã€‚å°½ç®¡å¦‚æ­¤ï¼ŒJS æä¾›äº†å¼ºå¤§çš„å·¥å…·æ¥å®ç° OOP çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå¦‚å°è£…ã€ç»§æ‰¿å’Œå¤šæ€ã€‚æ—©åœ¨ ES6 ä¹‹å‰ï¼Œå¼€å‘è€…å°±é€šè¿‡æ„é€ å‡½æ•°å’ŒåŸå‹é“¾æ¥æ¨¡æ‹Ÿ OOPï¼›ES6 å¼•å…¥çš„ <code>class</code> å…³é”®å­—åˆ™è®©ä»£ç æ›´æ¥è¿‘ä¼ ç»Ÿ OOP çš„è¯­æ³•ï¼Œä½†åº•å±‚ä»åŸºäºåŸå‹ã€‚</p>
<h3 data-id="heading-1">å¯¹è±¡åˆ›å»ºçš„åŸºç¡€ï¼šå­—é¢é‡å’Œå®ä¾‹åŒ–</h3>
<p>åœ¨ JS ä¸­ï¼Œå‡ ä¹ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡â€”â€”ç”šè‡³åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå¦‚å­—ç¬¦ä¸²å’Œæ•°å­—ï¼‰éƒ½æœ‰å¯¹åº”çš„åŒ…è£…ç±»ï¼ˆå¦‚ <code>String</code> å’Œ <code>Number</code>ï¼‰ã€‚æœ€ç®€å•çš„å¯¹è±¡åˆ›å»ºæ–¹å¼æ˜¯ä½¿ç”¨å¯¹è±¡å­—é¢é‡ï¼ˆobject literalï¼‰ï¼Œè¿™æ˜¯ä¸€ç§ç›´æ¥å®šä¹‰å¯¹è±¡å±æ€§çš„è¯­æ³•ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> <span class="hljs-title class_">Cat</span> = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">color</span>: <span class="hljs-string">""</span>
};

<span class="hljs-keyword">var</span> cat1 = {};
cat1.<span class="hljs-property">name</span> = <span class="hljs-string">'åŠ è²çŒ«'</span>;
cat1.<span class="hljs-property">color</span> = <span class="hljs-string">"æ©˜è‰²"</span>;

<span class="hljs-keyword">var</span> cat2 = {};
cat2.<span class="hljs-property">name</span> = <span class="hljs-string">'é»‘çŒ«è­¦é•¿'</span>;
cat2.<span class="hljs-property">color</span> = <span class="hljs-string">"é»‘è‰²"</span>;
</code></pre>
<p>è¿™é‡Œï¼Œ<code>Cat</code> ä½œä¸ºä¸€ä¸ªæ¨¡æ¿å¯¹è±¡ï¼Œä½†æ¯ä¸ªå®ä¾‹ï¼ˆå¦‚ <code>cat1</code> å’Œ <code>cat2</code>ï¼‰éƒ½éœ€è¦æ‰‹åŠ¨èµ‹å€¼å±æ€§ã€‚è¿™è™½ç„¶ç®€å•ï¼Œä½†ä¼šå¯¼è‡´ä»£ç é‡å¤ï¼Œå°¤å…¶å½“éœ€è¦åˆ›å»ºå¤šä¸ªç›¸ä¼¼å¯¹è±¡æ—¶ã€‚æ‰©å±•æ¥è¯´ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿™ç§æ–¹æ³•é€‚åˆå¿«é€ŸåŸå‹å¼€å‘ï¼Œä½†ä¸åˆ©äºå¤§è§„æ¨¡ä»£ç ç»´æŠ¤ï¼Œå› ä¸ºç¼ºä¹å°è£…å’Œå¤ç”¨æœºåˆ¶ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒJS ä½¿ç”¨æ„é€ å‡½æ•°ï¼ˆConstructorï¼‰æ¥å°è£…å®ä¾‹åŒ–è¿‡ç¨‹ã€‚æ„é€ å‡½æ•°æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œä½†é€šè¿‡ <code>new</code> å…³é”®å­—è°ƒç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå¹¶å°† <code>this</code> æŒ‡å‘è¯¥å¯¹è±¡ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// è¾“å‡ºä¸€ä¸ªç©ºå¯¹è±¡</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}

<span class="hljs-comment">// ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨</span>
<span class="hljs-keyword">const</span> cat1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'åŠ è²çŒ«'</span>, <span class="hljs-string">'æ©˜è‰²'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat1); <span class="hljs-comment">// { name: 'åŠ è²çŒ«', color: 'æ©˜è‰²' }</span>

<span class="hljs-comment">// å®ä¾‹é—´å…±äº«æ„é€ å‡½æ•°</span>
<span class="hljs-keyword">const</span> cat2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'é»‘çŒ«è­¦é•¿'</span>, <span class="hljs-string">'é»‘è‰²'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat1.<span class="hljs-property">constructor</span> === cat2.<span class="hljs-property">constructor</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat1 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Cat</span>); <span class="hljs-comment">// true</span>
</code></pre>
<p>æ‰©å±•è§£é‡Šï¼š<code>new</code> æ“ä½œç¬¦çš„å†…éƒ¨è¿‡ç¨‹åŒ…æ‹¬ï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ <code>{}</code>ã€‚</li>
<li>å°†è¯¥å¯¹è±¡çš„ <code>__proto__</code> æŒ‡å‘æ„é€ å‡½æ•°çš„ <code>prototype</code>ã€‚</li>
<li>å°† <code>this</code> ç»‘å®šåˆ°è¯¥å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œæ„é€ å‡½æ•°ä»£ç ã€‚</li>
<li>è¿”å›è¯¥å¯¹è±¡ï¼ˆé™¤éæ„é€ å‡½æ•°æ˜¾å¼è¿”å›å…¶ä»–å€¼ï¼‰ã€‚</li>
</ol>
<p>å¦‚æœä¸ä½¿ç”¨ <code>new</code>ï¼Œå‡½æ•°ä¸­çš„ <code>this</code> ä¼šæŒ‡å‘å…¨å±€å¯¹è±¡ï¼ˆå¦‚æµè§ˆå™¨ä¸­çš„ <code>window</code>ï¼‰ï¼Œè¿™å¯èƒ½å¯¼è‡´æ„å¤–è¡Œä¸ºã€‚è¿™å¼ºè°ƒäº†æ„é€ å‡½æ•°åœ¨ JS OOP ä¸­çš„æ ¸å¿ƒä½œç”¨ï¼šå®ƒå°è£…äº†å¯¹è±¡åˆå§‹åŒ–é€»è¾‘ï¼Œç¡®ä¿æ¯ä¸ªå®ä¾‹éƒ½æœ‰ç‹¬ç«‹çš„å±æ€§ã€‚</p>
<h3 data-id="heading-2">åŸå‹æ¨¡å¼ï¼šå…±äº«å±æ€§å’Œæ–¹æ³•</h3>
<p>åœ¨æ„é€ å‡½æ•°ä¸­ç›´æ¥å®šä¹‰æ–¹æ³•æˆ–å…±äº«å±æ€§ï¼ˆå¦‚ <code>type</code> æˆ– <code>eat</code>ï¼‰ä¼šå¯¼è‡´æ¯ä¸ªå®ä¾‹éƒ½å¤åˆ¶ä¸€ä»½ç›¸åŒçš„ä»£ç ï¼Œè¿™æµªè´¹å†…å­˜ã€‚åŸå‹æ¨¡å¼é€šè¿‡ <code>prototype</code> å±æ€§è§£å†³è¿™ä¸ªé—®é¢˜ï¼šå°†ä¸å˜çš„å±æ€§å’Œæ–¹æ³•æ”¾ç½®åœ¨æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ä¸Šï¼Œæ‰€æœ‰å®ä¾‹é€šè¿‡åŸå‹é“¾ï¼ˆprototype chainï¼‰å…±äº«å®ƒä»¬ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}

<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">type</span> = <span class="hljs-string">'çŒ«ç§‘åŠ¨ç‰©'</span>;
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">eat</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å–œæ¬¢jerry'</span>);
};

<span class="hljs-keyword">var</span> cat1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'tom'</span>, <span class="hljs-string">'é»‘è‰²'</span>);
<span class="hljs-keyword">var</span> cat2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'å’–å•¡çŒ«'</span>, <span class="hljs-string">'æ©˜è‰²'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat1.<span class="hljs-property">type</span>, cat2.<span class="hljs-property">type</span>); <span class="hljs-comment">// 'çŒ«ç§‘åŠ¨ç‰©' 'çŒ«ç§‘åŠ¨ç‰©'</span>
cat1.<span class="hljs-property">type</span> = <span class="hljs-string">'é“²å±å®˜çš„ä¸»äºº'</span>; <span class="hljs-comment">// åªå½±å“ cat1 çš„è‡ªèº«å±æ€§</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat1.<span class="hljs-property">type</span>, cat2.<span class="hljs-property">type</span>); <span class="hljs-comment">// 'é“²å±å®˜çš„ä¸»äºº' 'çŒ«ç§‘åŠ¨ç‰©'</span>
</code></pre>
<p>è¿™é‡Œï¼Œ<code>type</code> å’Œ <code>eat</code> è¢«æ‰€æœ‰å®ä¾‹å…±äº«ã€‚å¦‚æœåœ¨å®ä¾‹ä¸Šä¿®æ”¹ï¼ˆå¦‚ <code>cat1.type</code>ï¼‰ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªè‡ªèº«å±æ€§ï¼ˆown propertyï¼‰ï¼Œé®è”½åŸå‹ä¸Šçš„å€¼ï¼Œä½†ä¸ä¼šå½±å“å…¶ä»–å®ä¾‹ã€‚</p>
<p>æ‰©å±•æ¥è¯´ï¼ŒåŸå‹é“¾æ˜¯ JS ç»§æ‰¿çš„åŸºç¡€ï¼šæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ª <code>__proto__</code> å±æ€§ï¼ŒæŒ‡å‘å…¶æ„é€ å‡½æ•°çš„ <code>prototype</code>ã€‚å±æ€§æŸ¥æ‰¾æ—¶ï¼Œå…ˆæ£€æŸ¥è‡ªèº«å±æ€§ï¼Œç„¶åé¡ºç€åŸå‹é“¾å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ° <code>Object.prototype</code> æˆ– <code>null</code>ã€‚è¿™æé«˜äº†æ•ˆç‡ï¼Œå°¤å…¶åœ¨å¤§å‹åº”ç”¨ä¸­ï¼ˆå¦‚ React ç»„ä»¶åº“ï¼‰ï¼Œå¯ä»¥é¿å…é‡å¤å®šä¹‰é€šç”¨æ–¹æ³•ã€‚</p>
<p>è¦æ£€æŸ¥å±æ€§æ¥æºï¼š</p>
<ul>
<li><code>hasOwnProperty(prop)</code>ï¼šæ£€æŸ¥æ˜¯å¦ä¸ºè‡ªèº«å±æ€§ã€‚</li>
<li><code>in</code> æ“ä½œç¬¦ï¼šæ£€æŸ¥å±æ€§æ˜¯å¦å­˜åœ¨äºè‡ªèº«æˆ–åŸå‹é“¾ã€‚</li>
<li><code>for...in</code> å¾ªç¯ï¼šéå†è‡ªèº«å’ŒåŸå‹é“¾ä¸Šçš„å¯æšä¸¾å±æ€§ã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat1.<span class="hljs-title function_">hasOwnProperty</span>(<span class="hljs-string">'type'</span>)); <span class="hljs-comment">// false (æ¥è‡ªåŸå‹)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat1.<span class="hljs-title function_">hasOwnProperty</span>(<span class="hljs-string">'name'</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"type"</span> <span class="hljs-keyword">in</span> cat1); <span class="hljs-comment">// true</span>
</code></pre>
<h3 data-id="heading-3">ES6 Classï¼šè¯­æ³•ç³–çš„ä¾¿åˆ©</h3>
<p>ES6 å¼•å…¥ <code>class</code> å…³é”®å­—ï¼Œè®© JS çš„ OOP ä»£ç æ›´åƒ Java æˆ– C++ï¼Œä½†åº•å±‚ä»æ˜¯åŸå‹æœºåˆ¶ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, color</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
    }

    <span class="hljs-title function_">eat</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"eat jerry"</span>);
    }
}

<span class="hljs-keyword">const</span> cat1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'tom'</span>, <span class="hljs-string">'black'</span>);
cat1.<span class="hljs-title function_">eat</span>(); <span class="hljs-comment">// "eat jerry"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat1.<span class="hljs-property">__proto__</span>); <span class="hljs-comment">// Cat çš„ prototype</span>
</code></pre>
<p>æ‰©å±•ï¼š<code>class</code> æ˜¯æ„é€ å‡½æ•°çš„è¯­æ³•ç³–ã€‚æ–¹æ³•å®šä¹‰åœ¨ <code>prototype</code> ä¸Šï¼Œå±æ€§åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–ã€‚è¿™ç®€åŒ–äº†ä»£ç ï¼Œä½†å¼€å‘è€…ä»éœ€ç†è§£åŸå‹é“¾ï¼Œä»¥é¿å…å¸¸è§é”™è¯¯å¦‚ä¿®æ”¹å…±äº«çŠ¶æ€ã€‚</p>
<h3 data-id="heading-4">ç»§æ‰¿ï¼šé€šè¿‡æ„é€ å‡½æ•°ç»‘å®šå’ŒåŸå‹é“¾</h3>
<p>ç»§æ‰¿å…è®¸å­ç±»å¤ç”¨çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ã€‚JS é€šè¿‡ä¸¤ç§æ–¹å¼å®ç°ï¼š</p>
<ol>
<li><strong>æ„é€ å‡½æ•°ç»‘å®š</strong>ï¼šä½¿ç”¨ <code>apply</code> æˆ– <code>call</code> å°†çˆ¶æ„é€ å‡½æ•°çš„ <code>this</code> ç»‘å®šåˆ°å­å®ä¾‹ã€‚</li>
<li><strong>åŸå‹ç»§æ‰¿</strong>ï¼šå°†å­ç±»çš„ <code>prototype</code> è®¾ç½®ä¸ºçˆ¶ç±»çš„å®ä¾‹ã€‚</li>
</ol>
<p>ç¤ºä¾‹ï¼ˆæ„é€ å‡½æ•°ç»‘å®šï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">species</span> = <span class="hljs-string">'åŠ¨ç‰©'</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
    <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// ç»‘å®š Animal çš„ this åˆ° Cat å®ä¾‹</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}

<span class="hljs-keyword">const</span> cat = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">"åŠ è²çŒ«"</span>, <span class="hljs-string">"æ©˜è‰²"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat.<span class="hljs-property">species</span>); <span class="hljs-comment">// 'åŠ¨ç‰©'</span>
</code></pre>
<p>è¿™ç»§æ‰¿äº†å±æ€§ï¼Œä½†æœªç»§æ‰¿æ–¹æ³•ã€‚</p>
<p>å®Œæ•´ç»§æ‰¿ç¤ºä¾‹ï¼ˆç»“åˆåŸå‹ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">species</span> = <span class="hljs-string">'åŠ¨ç‰©'</span>;
}

<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHi</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'lll'</span>);
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
    <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}

<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>(); <span class="hljs-comment">// åŸå‹ç»§æ‰¿</span>

<span class="hljs-keyword">const</span> cat = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'åŠ è²çŒ«'</span>, <span class="hljs-string">'æ©˜è‰²'</span>);
cat.<span class="hljs-title function_">sayHi</span>(); <span class="hljs-comment">// 'lll'</span>
</code></pre>
<p>æ‰©å±•ï¼šè¿™ç§â€œç»„åˆç»§æ‰¿â€æ˜¯æœ€å¸¸è§çš„æ¨¡å¼ã€‚å®ƒé¿å…äº†ç»å…¸ç»§æ‰¿çš„ç¼ºç‚¹ï¼ˆå¦‚å¤šæ¬¡è°ƒç”¨çˆ¶æ„é€ å‡½æ•°ï¼‰ã€‚åœ¨ç°ä»£ JS ä¸­ï¼ŒES6 çš„ <code>extends</code> å’Œ <code>super</code> è¿›ä¸€æ­¥ç®€åŒ–ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">species</span> = <span class="hljs-string">'åŠ¨ç‰©'</span>;
    }
    <span class="hljs-title function_">sayHi</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å“ªå“ªå“ªå•¦'</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, color</span>) {
        <span class="hljs-variable language_">super</span>(); <span class="hljs-comment">// è°ƒç”¨çˆ¶æ„é€ å‡½æ•°</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
    }
}
</code></pre>
<p>è¿™åœ¨å®é™…å¼€å‘ä¸­ï¼ˆå¦‚æ„å»ºç»„ä»¶ç»§æ‰¿æ ‘ï¼‰éå¸¸å®ç”¨ã€‚</p>
<h3 data-id="heading-5">JS OOP çš„å®ç”¨ä»·å€¼</h3>
<p>JS çš„ OOP æœºåˆ¶è™½ä¸åŒäºä¼ ç»Ÿè¯­è¨€ï¼Œä½†å…¶çµæ´»æ€§ä½¿å…¶åœ¨å‰ç«¯å¼€å‘ä¸­å¤§æ”¾å¼‚å½©ã€‚é€šè¿‡æ„é€ å‡½æ•°ã€åŸå‹å’Œç»§æ‰¿ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºé«˜æ•ˆã€å¯ç»´æŠ¤çš„ä»£ç åº“ã€‚ä¾‹å¦‚ï¼Œåœ¨ Vue æˆ– React é¡¹ç›®ä¸­ï¼Œè¿™äº›æ¦‚å¿µå¸¸ç”¨äºç»„ä»¶å¤ç”¨å’ŒçŠ¶æ€ç®¡ç†ã€‚ç†è§£åŸå‹é“¾è¿˜èƒ½å¸®åŠ©è°ƒè¯•ç»§æ‰¿ç›¸å…³çš„é—®é¢˜ï¼Œå¦‚å±æ€§é®è”½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TooltipBoxåœ¨Composeé‡Œ]]></title>    <link>https://juejin.cn/post/7578714735307751450</link>    <guid>https://juejin.cn/post/7578714735307751450</guid>    <pubDate>2025-12-01T14:49:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578714735307751450" data-draft-id="7578719771588804618" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="TooltipBoxåœ¨Composeé‡Œ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-01T14:49:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·444554365426"/> <meta itemprop="url" content="https://juejin.cn/user/1746465251931063"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            TooltipBoxåœ¨Composeé‡Œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1746465251931063/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·444554365426
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-01T14:49:28.000Z" title="Mon Dec 01 2025 14:49:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ‰äº›ç»„ä»¶çœ‹å¾—åˆ°ï¼Œæ‰çŸ¥é“æœ‰</p>
</blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Fdevelop%2Fui%2Fcompose%2Fcomponents%2Ftooltip%3Fhl%3Dzh-cn%26mode%3Dlight" target="_blank" title="https://developer.android.com/develop/ui/compose/components/tooltip?hl=zh-cn&amp;mode=light" ref="nofollow noopener noreferrer">å®˜æ–¹æ–‡æ¡£æŒ‡å¼•ï¼š2025/12</a></p>
<p>æ¥ç‚¹æ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a16b7d0952f4153b61e415211dd1f92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDQ0NTU0MzY1NDI2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765205368&amp;x-signature=nEKOIJNANGuyXP6t3h7aKkXbCw8%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>ä½¿ç”¨å…‰æ ‡æ‚¬åœåœ¨å›¾æ ‡ä¸Š</li>
<li>åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šé•¿æŒ‰ç›¸åº”å›¾æ ‡</li>
</ul>
<p>æ¥ç‚¹æµ·é©¬ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">package</span> com.mircles.test.ui

<span class="hljs-keyword">import</span> androidx.compose.foundation.background
<span class="hljs-keyword">import</span> androidx.compose.foundation.layout.Box
<span class="hljs-keyword">import</span> androidx.compose.foundation.layout.fillMaxSize
<span class="hljs-keyword">import</span> androidx.compose.material.icons.Icons
<span class="hljs-keyword">import</span> androidx.compose.material.icons.filled.Favorite
<span class="hljs-keyword">import</span> androidx.compose.material3.ExperimentalMaterial3Api
<span class="hljs-keyword">import</span> androidx.compose.material3.Icon
<span class="hljs-keyword">import</span> androidx.compose.material3.IconButton
<span class="hljs-keyword">import</span> androidx.compose.material3.PlainTooltip
<span class="hljs-keyword">import</span> androidx.compose.material3.Text
<span class="hljs-keyword">import</span> androidx.compose.material3.TooltipBox
<span class="hljs-keyword">import</span> androidx.compose.material3.TooltipDefaults
<span class="hljs-keyword">import</span> androidx.compose.material3.rememberTooltipState
<span class="hljs-keyword">import</span> androidx.compose.runtime.Composable
<span class="hljs-keyword">import</span> androidx.compose.ui.Alignment
<span class="hljs-keyword">import</span> androidx.compose.ui.Modifier
<span class="hljs-keyword">import</span> androidx.compose.ui.graphics.Color
<span class="hljs-keyword">import</span> androidx.compose.ui.tooling.preview.Preview

<span class="hljs-meta">@OptIn(ExperimentalMaterial3Api::class)</span><span class="hljs-comment">//å®éªŒæ€§è´¨</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">TestTooltipBox</span><span class="hljs-params">(
    modifier: <span class="hljs-type">Modifier</span> = Modifier,
    plainTooltipText: <span class="hljs-type">String</span> = <span class="hljs-string">"å¥½å¤§ä¸€ä¸ªå§æ§½ï¼"</span>
)</span></span> {
    TooltipBox(
        modifier = modifier,
        state = rememberTooltipState(),
        tooltip = {
            PlainTooltip {
                Text(<span class="hljs-string">"å•¥å‘€ï¼ä¸œè¥¿ï¼<span class="hljs-variable">$plainTooltipText</span>"</span>)
            }
        },
        positionProvider = TooltipDefaults.rememberPlainTooltipPositionProvider(),
        <span class="hljs-comment">//æ€ä¹ˆå®šä½æ˜¾ç¤ºä½ç½®çš„</span>
        ) {
        IconButton(onClick = {
            <span class="hljs-comment">/*??*/</span>
        }) {
            Icon(
                imageVector = Icons.Filled.Favorite,
                contentDescription = <span class="hljs-string">"è¿™æ˜¯ä¸€ä¸ªæŒ‰é’®"</span>
            )
        }
    }
}

<span class="hljs-meta">@Preview(showBackground = true, showSystemUi = true)</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">PreviewDemo</span><span class="hljs-params">()</span></span> {

    Box(
        modifier = Modifier
            .background(Color.Gray)
            .fillMaxSize(),
        contentAlignment = Alignment.Center
    ) {
        TestTooltipBox(modifier = Modifier.background(Color.Red))
    }

}
</code></pre>
<p>è¿˜æœ‰å¯Œæ–‡æœ¬æç¤ºï¼š
RichTooltip</p>
<pre><code class="hljs language-kotlin" lang="kotlin">
<span class="hljs-meta">@OptIn(ExperimentalMaterial3Api::class)</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">RichTooltipExample</span><span class="hljs-params">(
    modifier: <span class="hljs-type">Modifier</span> = Modifier,
    richTooltipSubheadText: <span class="hljs-type">String</span> = <span class="hljs-string">"Rich Tooltip"</span>,
    richTooltipText: <span class="hljs-type">String</span> = <span class="hljs-string">"Rich tooltips support multiple lines of informational text."</span>
)</span></span> {
    TooltipBox(
        modifier = modifier,
        positionProvider = TooltipDefaults.rememberRichTooltipPositionProvider(),
        tooltip = {
            RichTooltip(
                title = { Text(richTooltipSubheadText) }
            ) {
                Text(richTooltipText)
            }
        },
        state = rememberTooltipState()
    ) {
        IconButton(onClick = { <span class="hljs-comment">/* Icon button's click event */</span> }) {
            Icon(
                imageVector = Icons.Filled.Info,
                contentDescription = <span class="hljs-string">"Show more information"</span>
            )
        }
    }
}

<span class="hljs-meta">@OptIn(ExperimentalMaterial3Api::class)</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">AdvancedRichTooltipExample</span><span class="hljs-params">(
    modifier: <span class="hljs-type">Modifier</span> = Modifier,
    richTooltipSubheadText: <span class="hljs-type">String</span> = <span class="hljs-string">"Custom Rich Tooltip"</span>,
    richTooltipText: <span class="hljs-type">String</span> = <span class="hljs-string">"Rich tooltips support multiple lines of informational text."</span>,
    richTooltipActionText: <span class="hljs-type">String</span> = <span class="hljs-string">"Dismiss"</span>
)</span></span> {
    <span class="hljs-keyword">val</span> tooltipState = rememberTooltipState()
    <span class="hljs-keyword">val</span> coroutineScope = rememberCoroutineScope()<span class="hljs-comment">//ä¸ºä»€ä¹ˆä¼šè‡ªåŠ¨dismiss</span>

    TooltipBox(
        modifier = modifier,
        positionProvider = TooltipDefaults.rememberRichTooltipPositionProvider(),
        tooltip = {
            RichTooltip(
                title = { Text(richTooltipSubheadText) },
                action = {
                    Row {
                        TextButton(onClick = {
                            coroutineScope.launch {
                                tooltipState.dismiss()<span class="hljs-comment">//</span>
                            }
                        }) {
                            Text(richTooltipActionText)
                        }
                    }
                },
            ) {
                Text(richTooltipText)
            }
        },
        state = tooltipState
    ) {
        IconButton(onClick = {
            coroutineScope.launch {
                tooltipState.show()
            }
        }) {
            Icon(
                imageVector = Icons.Filled.AccountBox,
                contentDescription = <span class="hljs-string">"Open camera"</span>
            )
        }
    }
}

<span class="hljs-meta">@Preview(showBackground = true, showSystemUi = true)</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">PreviewDemo</span><span class="hljs-params">()</span></span> {

    Box(
        modifier = Modifier
            .background(Color.Gray)
            .fillMaxSize(),
        contentAlignment = Alignment.Center
    ) {

        Column {

            TestTooltipBox(modifier = Modifier.background(Color.Red))

            Spacer(modifier = Modifier.height(<span class="hljs-number">50.</span>dp))

            RichTooltipExample()

            Spacer(modifier = Modifier.height(<span class="hljs-number">50.</span>dp))

            AdvancedRichTooltipExample()

        }
    }

}
</code></pre>
<p>è¿˜æœ‰äº›ç–‘é—®ç‚¹éœ€è¦çœ‹æºç çš„.....</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€ã€KotlinåŸºç¡€]]></title>    <link>https://juejin.cn/post/7578714735307800602</link>    <guid>https://juejin.cn/post/7578714735307800602</guid>    <pubDate>2025-12-01T15:01:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578714735307800602" data-draft-id="7578724773993267226" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€ã€KotlinåŸºç¡€"/> <meta itemprop="keywords" content="Android,Kotlin"/> <meta itemprop="datePublished" content="2025-12-01T15:01:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Haha_bj"/> <meta itemprop="url" content="https://juejin.cn/user/2612027844214647"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€ã€KotlinåŸºç¡€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2612027844214647/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Haha_bj
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-01T15:01:58.000Z" title="Mon Dec 01 2025 15:01:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€Kotlinæ˜¯ä¸€ç§æ–°å‹çš„é™æ€ç±»å‹ç¼–ç¨‹è¯­è¨€ã€‚</h2>
<ul>
<li><code>å¯Œæœ‰è¡¨ç°åŠ›ä¸”ç®€æ´</code>ï¼š
å¯ä»¥ä½¿ç”¨æ›´å°‘çš„ä»£ç å®ç°æ›´å¤šçš„åŠŸèƒ½ã€‚å°‘ç¼–å†™æ ·æ¿ä»£ç ã€‚åœ¨ä½¿ç”¨Kotlin çš„ä¸“ä¸šå¼€å‘è€…ä¸­ï¼Œæœ‰ 67% çš„äººåæ˜ å…¶å·¥ä½œæ•ˆç‡æœ‰æ‰€æé«˜ã€‚</li>
<li><code>æ›´å®‰å…¨çš„ä»£ç </code>ï¼š
Kotlin æœ‰è®¸å¤šè¯­è¨€åŠŸèƒ½ï¼Œå¯å¸®åŠ©é¿å… nul æŒ‡é’ˆå¼‚å¸¸ç­‰å¸¸è§ç¼–ç¨‹é”™è¯¯ã€‚åŒ…å« Kotlin ä»£ç çš„Android åº”ç”¨å‘ç”Ÿå´©æºƒçš„å¯èƒ½æ€§é™ä½äº† 20%ã€‚</li>
<li><code>å¯äº’æ“ä½œ</code>ï¼šå¯ä»¥åœ¨ Kotlin ä»£ç ä¸­è°ƒç”¨ Java ä»£ç ï¼Œæˆ–è€…åœ¨ Java ä»£ç ä¸­è°ƒç”¨ Kotin ä»£ç ã€‚Kotlin å¯å®Œå…¨ä¸ Java ç¼–ç¨‹è¯­è¨€äº’æ“ä½œï¼Œå› æ­¤å¯ä»¥æ ¹æ®éœ€è¦åœ¨é¡¹ç›®ä¸­æ·»åŠ ä»»æ„æ•°é‡çš„ Kotlin ä»£ç ã€‚</li>
<li><code>ç»“æ„åŒ–å¹¶å‘</code>ï¼šKotlin åç¨‹è®©å¼‚æ­¥ä»£ç åƒé˜´å¡ä»£ç ä¸€æ ·æ˜“äºä½¿ç”¨ã€‚åç¨‹å¯å¤§å¹…ç®€åŒ–åå°ä»»åŠ¡ç®¡ç†ï¼Œä¾‹å¦‚ç½‘ç»œè°ƒç”¨ã€æœ¬åœ°æ•°æ®è®¿é—®ç­‰ä»»åŠ¡çš„ç®¡ç†ã€‚</li>
</ul>
<h2 data-id="heading-1">äºŒã€åŸºæœ¬æ•°æ®ç±»å‹</h2>
<h3 data-id="heading-2">ä¸€ã€æ•´å‹</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c39310ab1ea44b9af4782fe5ec7232a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGFoYV9iag==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765206117&amp;x-signature=vYw2%2FN3JAXsk6pWULyWU3c8E1js%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-comment">/// psvm psvma minå‡½æ•°çš„å¿«æ·é”®</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {

    <span class="hljs-comment">//åŸºæœ¬æ•°æ®ç±»å‹çš„æ•´å‹é»˜è®¤ä¸º Int, å¦‚æœè¶…è¿‡äº†Intçš„å–å€¼èŒƒå›´ï¼Œåˆ™ä¼šæ¨æ–­ä¸ºLong</span>

    <span class="hljs-keyword">var</span> a = <span class="hljs-number">100</span> <span class="hljs-comment">// é»˜è®¤æ¨æ–­å˜é‡ä¸ºIntæœ€å¤§å€¼ï¼Œ</span>
    <span class="hljs-keyword">var</span> b: <span class="hljs-built_in">Int</span> = <span class="hljs-number">100</span> <span class="hljs-comment">// æ˜ç¡®ç±»å‹</span>

    <span class="hljs-keyword">var</span> c = <span class="hljs-number">8000000000</span> <span class="hljs-comment">// å·²è¶…è¿‡ Int é»˜è®¤ä¸ºL</span>
    <span class="hljs-keyword">var</span> d: <span class="hljs-built_in">Long</span> = <span class="hljs-number">90</span>
    <span class="hljs-keyword">var</span> e = <span class="hljs-number">100L</span>

    <span class="hljs-comment">/// Byte ç±»å‹</span>
    <span class="hljs-keyword">var</span> <span class="hljs-keyword">by</span>: <span class="hljs-built_in">Byte</span> = <span class="hljs-number">1</span>
    
}
</code></pre>
<h3 data-id="heading-3">äºŒã€Floatã€Doubleæµ®ç‚¹ç±»å‹</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d54487ecc2b470c87a4410d17b21c34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGFoYV9iag==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765206117&amp;x-signature=udvedm6La091O%2Fmt76ytYK1lnUg%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h3 data-id="heading-4">ä¸‰ã€å­—ç¬¦ç±»å‹ Char</h3>
<p>åœ¨Kotlinä¸­å­—ç¬¦ç”¨Charç±»å‹è¡¨ç¤ºï¼Œ å­—ç¬¦çš„å€¼éœ€è¦ç”¨å•å¼•å·æ‹¬èµ·æ¥ ''</p>
<pre><code class="hljs language-Kotlin" lang="Kotlin"><span class="hljs-keyword">var</span> a = <span class="hljs-string">'a'</span>
<span class="hljs-keyword">var</span> b: <span class="hljs-built_in">Char</span> = <span class="hljs-string">'b'</span>
</code></pre>
<h3 data-id="heading-5">å››ã€ å¸ƒå°”ç±»å‹</h3>
<p>åœ¨Kotlinä½¿ç”¨Booleanè¡¨ç¤ºå¸ƒå°”ç±»å‹ï¼Œå®ƒåªæœ‰ä¸¤ä¸ªå€¼true å’Œfalse</p>
<pre><code class="hljs language-ini" lang="ini">var isSelect: <span class="hljs-attr">Boolean</span> = <span class="hljs-literal">true</span>
var <span class="hljs-attr">isMy</span> = <span class="hljs-literal">false</span>
</code></pre>
<h3 data-id="heading-6">äº”ã€å­—ç¬¦ä¸²</h3>
<p>åœ¨Kotlinä¸­å­—ç¬¦ä¸²ç”¨Stringç±»å‹è¡¨ç¤ºï¼Œå­—ç¬¦ä¸²ä¸æ˜¯å¯å˜çš„ã€‚å­—ç¬¦ä¸²çš„å…ƒç´ â€”â€”å­—ç¬¦ä¸²çš„å…ƒç´ å¯ä»¥ä½¿ç”¨ç´¢å¼•è¿ç®—ç¬¦è®¿é—®ï¼šs[i],æˆ–è€…å¯ä»¥ç”¨forå¾ªç¯è¿­ä»£å­—ç¬¦ä¸²ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">var <span class="hljs-attr">str</span> = <span class="hljs-string">"Hello"</span>
var s: <span class="hljs-attr">String</span> = <span class="hljs-string">"Heello word"</span>
var <span class="hljs-attr">c</span> = s[<span class="hljs-number">0</span>]
for (c in s){
    println(c)
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2018ac4812f5407ea099c2ff1c36f9b5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGFoYV9iag==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765206117&amp;x-signature=xiP74d%2Fb9ULFqTGwh1D8B4dX84M%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/147bfbf6b7334aa9b6e761dc74e1ee71~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGFoYV9iag==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765206117&amp;x-signature=beqXPRFZzFEDX7d87eOIMigcs3U%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h3 data-id="heading-7">å…­ã€ç±»å‹å¼ºåˆ¶è½¬æ¢</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee15ee848f0a401e88c41b09dbe86777~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSGFoYV9iag==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765206117&amp;x-signature=rVCRPFQtbuSv77Cd6phlGF7l7%2Fc%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<pre><code class="hljs language-ini" lang="ini">var <span class="hljs-attr">nu</span> = <span class="hljs-number">100</span>
var <span class="hljs-attr">str</span> = nu.toString()
var <span class="hljs-attr">toB</span> = nu.toByte()
var <span class="hljs-attr">toSh</span> = nu.toShort()
var <span class="hljs-attr">toLong</span> = nu.toLong()
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Textture ç”Ÿå‘½å‘¨æœŸ]]></title>    <link>https://juejin.cn/post/7578724773993103386</link>    <guid>https://juejin.cn/post/7578724773993103386</guid>    <pubDate>2025-12-01T12:26:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578724773993103386" data-draft-id="7578724773993021466" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Textture ç”Ÿå‘½å‘¨æœŸ"/> <meta itemprop="keywords" content="iOS"/> <meta itemprop="datePublished" content="2025-12-01T12:26:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ›¾ç»æˆ‘ä¹Ÿæœ‰æ¢¦æƒ³"/> <meta itemprop="url" content="https://juejin.cn/user/1625541458016403"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Textture ç”Ÿå‘½å‘¨æœŸ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1625541458016403/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ›¾ç»æˆ‘ä¹Ÿæœ‰æ¢¦æƒ³
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-01T12:26:07.000Z" title="Mon Dec 01 2025 12:26:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    12
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Texture (AsyncDisplayKit) èŠ‚ç‚¹ç”Ÿå‘½å‘¨æœŸå®Œå…¨æŒ‡å—</h2>
<blockquote>
<p>æœ¬æ–‡è¯¦è§£ Texture æ¡†æ¶ä¸­ <code>ASDisplayNode</code> çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸï¼ŒåŒ…æ‹¬çº¿ç¨‹å®‰å…¨é™·é˜±å’Œå®˜æ–¹æœ€ä½³å®è·µã€‚</p>
</blockquote>
<h3 data-id="heading-1">ğŸ“‹ ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾</h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-number">1</span>. <span class="hljs-built_in">init</span>()                       <span class="hljs-comment">// èŠ‚ç‚¹åˆ›å»ºï¼ˆâš ï¸ å¯èƒ½åœ¨åå°çº¿ç¨‹ï¼‰</span>
   â†“
<span class="hljs-number">2</span>. <span class="hljs-built_in">didLoad</span>()                    <span class="hljs-comment">// view/layer å·²åˆ›å»ºï¼ˆâœ… ä¸»çº¿ç¨‹ï¼‰</span>
   â†“
<span class="hljs-number">3</span>. <span class="hljs-built_in">layoutSpecThatFits</span>(_:)       <span class="hljs-comment">// å¸ƒå±€æµ‹é‡ï¼ˆâš ï¸ å¯èƒ½åœ¨åå°çº¿ç¨‹ï¼‰</span>
   â†“
<span class="hljs-number">4</span>. <span class="hljs-built_in">didEnterPreloadState</span>()       <span class="hljs-comment">// å³å°†æ¥è¿‘å±å¹•ï¼ˆâœ… ä¸»çº¿ç¨‹ï¼‰</span>
   â†“
<span class="hljs-number">5</span>. <span class="hljs-built_in">didEnterDisplayState</span>()       <span class="hljs-comment">// å³å°†æ˜¾ç¤ºï¼ˆâœ… ä¸»çº¿ç¨‹ï¼‰</span>
   â†“
<span class="hljs-number">6</span>. <span class="hljs-built_in">didEnterVisibleState</span>()       <span class="hljs-comment">// å®Œå…¨å¯è§ï¼ˆâœ… ä¸»çº¿ç¨‹ï¼‰</span>
   â†“
<span class="hljs-number">7</span>. <span class="hljs-built_in">didExitVisibleState</span>()        <span class="hljs-comment">// ç¦»å¼€å¯è§åŒºï¼ˆâœ… ä¸»çº¿ç¨‹ï¼‰</span>
   â†“
<span class="hljs-number">8</span>. <span class="hljs-built_in">didExitDisplayState</span>()        <span class="hljs-comment">// ç¦»å¼€æ˜¾ç¤ºåŒºï¼ˆâœ… ä¸»çº¿ç¨‹ï¼‰</span>
   â†“
<span class="hljs-number">9</span>. <span class="hljs-built_in">didExitPreloadState</span>()        <span class="hljs-comment">// ç¦»å¼€é¢„åŠ è½½åŒºï¼ˆâœ… ä¸»çº¿ç¨‹ï¼‰</span>
   â†“
<span class="hljs-number">10</span>. <span class="hljs-built_in">clearContents</span>()             <span class="hljs-comment">// é‡Šæ”¾èµ„æºï¼ˆâœ… ä¸»çº¿ç¨‹ï¼‰</span>
   â†“
<span class="hljs-number">11</span>. deinit                      <span class="hljs-comment">// èŠ‚ç‚¹é”€æ¯</span>
</code></pre>
<hr/>
<h3 data-id="heading-2">1ï¸âƒ£ init() - èŠ‚ç‚¹åˆå§‹åŒ–</h3>
<h4 data-id="heading-3">ğŸ§µ çº¿ç¨‹ç‰¹æ€§</h4>
<p><strong>âš ï¸ å…³é”®ï¼šå¯èƒ½åœ¨ä¸»çº¿ç¨‹æˆ–åå°çº¿ç¨‹æ‰§è¡Œï¼</strong></p>
<p>æ ¹æ®åˆ›å»ºæ–¹å¼ä¸åŒï¼š</p>
<ul>
<li><strong>ç›´æ¥åˆ›å»º</strong>ï¼š<code>let node = MyNode()</code> â†’ åœ¨è°ƒç”¨çº¿ç¨‹æ‰§è¡Œ</li>
<li><strong>Block åˆ›å»º</strong>ï¼š<code>ASCellNode { MyNode() }</code> â†’ åœ¨<strong>åå°çº¿ç¨‹</strong>æ‰§è¡Œ</li>
</ul>
<h4 data-id="heading-4">ğŸ“– å®˜æ–¹æ–‡æ¡£å¼•ç”¨</h4>
<p>æ¥è‡ª <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTextureGroup%2FTexture%2Fblob%2Fmaster%2FSource%2FASDisplayNode.h%23L156" target="_blank" title="https://github.com/TextureGroup/Texture/blob/master/Source/ASDisplayNode.h#L156" ref="nofollow noopener noreferrer">ASDisplayNode.h</a>:</p>
<blockquote>
<p>"This method <strong>can be called on a background thread</strong>.<br/>
You MUST ensure that <strong>no UIKit objects are accessed</strong>."</p>
</blockquote>
<h4 data-id="heading-5">âœ… åº”è¯¥åšçš„äº‹</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">override</span> <span class="hljs-keyword">init</span>() {
    <span class="hljs-keyword">super</span>.<span class="hljs-keyword">init</span>()
    
    <span class="hljs-comment">// âœ… åˆå§‹åŒ–å­èŠ‚ç‚¹</span>
    <span class="hljs-keyword">let</span> avatarNode <span class="hljs-operator">=</span> <span class="hljs-type">ASNetworkImageNode</span>()
    <span class="hljs-keyword">let</span> textNode <span class="hljs-operator">=</span> <span class="hljs-type">ASTextNode</span>()
    
    <span class="hljs-comment">// âœ… è®¾ç½® Node å±‚çº§å±æ€§ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</span>
    avatarNode.cornerRadius <span class="hljs-operator">=</span> <span class="hljs-number">18</span>
    avatarNode.style.preferredSize <span class="hljs-operator">=</span> <span class="hljs-type">CGSize</span>(width: <span class="hljs-number">36</span>, height: <span class="hljs-number">36</span>)
    
    textNode.maximumNumberOfLines <span class="hljs-operator">=</span> <span class="hljs-number">0</span>
    textNode.truncationMode <span class="hljs-operator">=</span> .byWordWrapping
    
    <span class="hljs-comment">// âœ… æ·»åŠ å­èŠ‚ç‚¹</span>
    automaticallyManagesSubnodes <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>
    addSubnode(avatarNode)
    addSubnode(textNode)
}
</code></pre>
<h4 data-id="heading-6">âŒ ç»å¯¹ç¦æ­¢çš„æ“ä½œ</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">override</span> <span class="hljs-keyword">init</span>() {
    <span class="hljs-keyword">super</span>.<span class="hljs-keyword">init</span>()
    
    <span class="hljs-comment">// âŒ è®¿é—® view/layerï¼ˆåå°çº¿ç¨‹ä¼šå´©æºƒï¼‰</span>
    <span class="hljs-keyword">self</span>.view.backgroundColor <span class="hljs-operator">=</span> .white  <span class="hljs-comment">// ğŸ’¥ Crash!</span>
    imageNode.view.layer.cornerRadius <span class="hljs-operator">=</span> <span class="hljs-number">10</span>  <span class="hljs-comment">// ğŸ’¥ Crash!</span>
    
    <span class="hljs-comment">// âŒ åˆ›å»º UIKit å¯¹è±¡</span>
    <span class="hljs-keyword">let</span> image <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(named: <span class="hljs-string">"icon"</span>)  <span class="hljs-comment">// âš ï¸ å¯èƒ½æœ‰é—®é¢˜</span>
    
    <span class="hljs-comment">// âŒ è°ƒç”¨ UIKit API</span>
    <span class="hljs-keyword">let</span> color <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.red.cgColor  <span class="hljs-comment">// âš ï¸ ä¸æ¨è</span>
}
</code></pre>
<h4 data-id="heading-7">ğŸ”§ æ›¿ä»£æ–¹æ¡ˆå¯¹æ¯”</h4>






























<table><thead><tr><th>éœ€æ±‚</th><th>âŒ é”™è¯¯å†™æ³• (init)</th><th>âœ… æ­£ç¡®å†™æ³•</th></tr></thead><tbody><tr><td>è®¾ç½®åœ†è§’</td><td><code>node.view.layer.cornerRadius = 10</code></td><td><code>node.cornerRadius = 10</code></td></tr><tr><td>è®¾ç½®èƒŒæ™¯è‰²</td><td><code>node.view.backgroundColor = .red</code></td><td><code>node.backgroundColor = .red</code></td></tr><tr><td>æ·»åŠ æ‰‹åŠ¿</td><td><code>node.view.addGestureRecognizer(...)</code></td><td>åœ¨ <code>didLoad()</code> ä¸­æ·»åŠ </td></tr><tr><td>è®¾ç½®é˜´å½±</td><td><code>node.view.layer.shadowRadius = 5</code></td><td>åœ¨ <code>didLoad()</code> ä¸­è®¾ç½®</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-8">2ï¸âƒ£ didLoad() - è§†å›¾å·²åˆ›å»º</h3>
<h4 data-id="heading-9">ğŸ§µ çº¿ç¨‹ç‰¹æ€§</h4>
<p><strong>âœ… å§‹ç»ˆåœ¨ä¸»çº¿ç¨‹æ‰§è¡Œ</strong></p>
<h4 data-id="heading-10">ğŸ“– å®˜æ–¹æ–‡æ¡£å¼•ç”¨</h4>
<blockquote>
<p>"Called on the <strong>main thread</strong> after the node's view or layer has been created.<br/>
This is the <strong>earliest time</strong> to safely access <code>node.view</code> or <code>node.layer</code>."</p>
</blockquote>
<h4 data-id="heading-11">è§¦å‘æ—¶æœº</h4>
<p>å½“ <code>node.view</code> æˆ– <code>node.layer</code> <strong>é¦–æ¬¡è¢«è®¿é—®</strong>æ—¶è§¦å‘ï¼ˆæ‡’åŠ è½½ï¼‰ï¼Œè€Œä¸æ˜¯åˆ›å»ºåè‡ªåŠ¨è§¦å‘ã€‚</p>
<h4 data-id="heading-12">âœ… åº”è¯¥åšçš„äº‹</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didLoad</span>() {
    <span class="hljs-keyword">super</span>.didLoad()
    
    <span class="hljs-comment">// âœ… è®¿é—® UIKit è§†å›¾å±‚çº§</span>
    textNode.view.isUserInteractionEnabled <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>
    
    <span class="hljs-comment">// âœ… æ·»åŠ æ‰‹åŠ¿</span>
    <span class="hljs-keyword">let</span> tapGesture <span class="hljs-operator">=</span> <span class="hljs-type">UITapGestureRecognizer</span>(target: <span class="hljs-keyword">self</span>, action: <span class="hljs-keyword">#selector</span>(handleTap))
    view.addGestureRecognizer(tapGesture)
    
    <span class="hljs-comment">// âœ… è®¾ç½® layer å±æ€§</span>
    imageNode.view.layer.shadowColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.black.cgColor
    imageNode.view.layer.shadowOffset <span class="hljs-operator">=</span> <span class="hljs-type">CGSize</span>(width: <span class="hljs-number">0</span>, height: <span class="hljs-number">2</span>)
    imageNode.view.layer.shadowRadius <span class="hljs-operator">=</span> <span class="hljs-number">4</span>
    imageNode.view.layer.shadowOpacity <span class="hljs-operator">=</span> <span class="hljs-number">0.3</span>
    
    <span class="hljs-comment">// âœ… è®¾ç½® delegate</span>
    scrollNode.view.delegate <span class="hljs-operator">=</span> <span class="hljs-keyword">self</span>
}
</code></pre>
<h4 data-id="heading-13">âŒ ä¸åº”è¯¥åšçš„äº‹</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didLoad</span>() {
    <span class="hljs-keyword">super</span>.didLoad()
    
    <span class="hljs-comment">// âŒ ä¸è¦åšå¸ƒå±€è®¡ç®—ï¼ˆåº”è¯¥åœ¨ layoutSpecThatFits ä¸­ï¼‰</span>
    textNode.frame <span class="hljs-operator">=</span> <span class="hljs-type">CGRect</span>(x: <span class="hljs-number">10</span>, y: <span class="hljs-number">10</span>, width: <span class="hljs-number">200</span>, height: <span class="hljs-number">40</span>)
    
    <span class="hljs-comment">// âŒ ä¸è¦åšæ•°æ®åŠ è½½ï¼ˆåº”è¯¥åœ¨ didEnterPreloadState ä¸­ï¼‰</span>
    fetchRemoteData()
}
</code></pre>
<hr/>
<h3 data-id="heading-14">3ï¸âƒ£ layoutSpecThatFits(_:) - å¸ƒå±€æµ‹é‡</h3>
<h4 data-id="heading-15">ğŸ§µ çº¿ç¨‹ç‰¹æ€§</h4>
<p><strong>âš ï¸ å¯èƒ½åœ¨ä¸»çº¿ç¨‹æˆ–åå°çº¿ç¨‹æ‰§è¡Œ</strong></p>
<p>æ ¹æ®è°ƒç”¨åœºæ™¯ï¼š</p>
<ul>
<li><strong>å¼‚æ­¥æµ‹é‡</strong>ï¼ˆæ»šåŠ¨æ—¶ï¼‰â†’ åå°çº¿ç¨‹</li>
<li><strong>åŒæ­¥å¸ƒå±€</strong>ï¼ˆä¸»åŠ¨è°ƒç”¨ï¼‰â†’ ä¸»çº¿ç¨‹</li>
</ul>
<h4 data-id="heading-16">ğŸ“– å®˜æ–¹æ–‡æ¡£å¼•ç”¨</h4>
<p>æ¥è‡ª <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTextureGroup%2FTexture%2Fblob%2Fmaster%2FSource%2FASDisplayNode.h" target="_blank" title="https://github.com/TextureGroup/Texture/blob/master/Source/ASDisplayNode.h" ref="nofollow noopener noreferrer">ASDisplayNode.h</a>:</p>
<blockquote>
<p>"This method is called <strong>off the main thread</strong>.<br/>
It is called on the main thread <strong>only when being used synchronously</strong>.<br/>
Node subclasses should <strong>NEVER access their view or layer properties</strong>."</p>
</blockquote>
<h4 data-id="heading-17">âœ… åº”è¯¥åšçš„äº‹</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">layoutSpecThatFits</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">constrainedSize</span>: <span class="hljs-type">ASSizeRange</span>) -&gt; <span class="hljs-type">ASLayoutSpec</span> {
    <span class="hljs-comment">// âœ… è®¾ç½® Node çš„å¸ƒå±€å±æ€§</span>
    avatarNode.style.preferredSize <span class="hljs-operator">=</span> <span class="hljs-type">CGSize</span>(width: <span class="hljs-number">36</span>, height: <span class="hljs-number">36</span>)
    
    <span class="hljs-comment">// âœ… åˆ›å»ºå¸ƒå±€è§„èŒƒ</span>
    <span class="hljs-keyword">let</span> textInset <span class="hljs-operator">=</span> <span class="hljs-type">ASInsetLayoutSpec</span>(
        insets: <span class="hljs-type">UIEdgeInsets</span>(top: <span class="hljs-number">6</span>, left: <span class="hljs-number">10</span>, bottom: <span class="hljs-number">6</span>, right: <span class="hljs-number">10</span>),
        child: textNode
    )
    
    <span class="hljs-keyword">let</span> hStack <span class="hljs-operator">=</span> <span class="hljs-type">ASStackLayoutSpec</span>.horizontal()
    hStack.spacing <span class="hljs-operator">=</span> <span class="hljs-number">8</span>
    hStack.alignItems <span class="hljs-operator">=</span> .start
    hStack.children <span class="hljs-operator">=</span> [avatarNode, textInset]
    
    <span class="hljs-keyword">return</span> <span class="hljs-type">ASInsetLayoutSpec</span>(
        insets: <span class="hljs-type">UIEdgeInsets</span>(top: <span class="hljs-number">8</span>, left: <span class="hljs-number">12</span>, bottom: <span class="hljs-number">8</span>, right: <span class="hljs-number">12</span>),
        child: hStack
    )
}
</code></pre>
<h4 data-id="heading-18">âŒ ç»å¯¹ç¦æ­¢çš„æ“ä½œ</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">layoutSpecThatFits</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">constrainedSize</span>: <span class="hljs-type">ASSizeRange</span>) -&gt; <span class="hljs-type">ASLayoutSpec</span> {
    <span class="hljs-comment">// âŒ è®¿é—® viewï¼ˆåå°çº¿ç¨‹ä¼šå´©æºƒï¼‰</span>
    <span class="hljs-keyword">self</span>.view.backgroundColor <span class="hljs-operator">=</span> .white  <span class="hljs-comment">// ğŸ’¥ Crash!</span>
    textNode.view.frame <span class="hljs-operator">=</span> <span class="hljs-type">CGRect</span>(<span class="hljs-operator">...</span>)  <span class="hljs-comment">// ğŸ’¥ Crash!</span>
    
    <span class="hljs-comment">// âŒ è°ƒç”¨ UIKit API</span>
    <span class="hljs-keyword">let</span> color <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.red  <span class="hljs-comment">// âš ï¸ å±é™©</span>
    
    <span class="hljs-comment">// âŒ ä¿®æ”¹çŠ¶æ€å˜é‡ï¼ˆå¯èƒ½å¯¼è‡´çº¿ç¨‹ç«äº‰ï¼‰</span>
    <span class="hljs-keyword">self</span>.isLoading <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>  <span class="hljs-comment">// âš ï¸ éœ€è¦åŠ é”</span>
    
    <span class="hljs-keyword">return</span> <span class="hljs-type">ASLayoutSpec</span>()
}
</code></pre>
<h4 data-id="heading-19">ğŸ’¡ å…³é”®åŸåˆ™</h4>
<p>layoutSpecThatFits æ˜¯<strong>çº¯å‡½æ•°é£æ ¼</strong>ï¼š</p>
<ul>
<li><strong>è¾“å…¥</strong>ï¼šsize çº¦æŸ</li>
<li><strong>è¾“å‡º</strong>ï¼šå¸ƒå±€æè¿°ï¼ˆASLayoutSpecï¼‰</li>
<li><strong>ç¦æ­¢</strong>ï¼šè®¿é—® UIKitã€ä¿®æ”¹çŠ¶æ€ã€äº§ç”Ÿå‰¯ä½œç”¨</li>
</ul>
<hr/>
<h3 data-id="heading-20">4ï¸âƒ£ Interface State ç³»ç»Ÿ</h3>
<p>Texture æä¾›äº†ä¸‰çº§æ¸è¿›å¼çŠ¶æ€ç®¡ç†ï¼š</p>





























<table><thead><tr><th>çŠ¶æ€</th><th>è·ç¦»å±å¹•</th><th>è§¦å‘æ—¶æœº</th><th>å…¸å‹ç”¨é€”</th></tr></thead><tbody><tr><td><strong>Preload</strong></td><td>1-2 å±</td><td>å³å°†è¿›å…¥å¯è§†åŒº</td><td>ç½‘ç»œè¯·æ±‚ã€è§£ç å›¾ç‰‡</td></tr><tr><td><strong>Display</strong></td><td>å³å°†æ˜¾ç¤º</td><td>å‡†å¤‡æ¸²æŸ“</td><td>æ–‡æœ¬å…‰æ …åŒ–ã€layer å†…å®¹</td></tr><tr><td><strong>Visible</strong></td><td>å®Œå…¨å¯è§</td><td>å‡ºç°åœ¨å±å¹•å†…</td><td>æ’­æ”¾åŠ¨ç”»/è§†é¢‘</td></tr></tbody></table>
<h4 data-id="heading-21">ğŸ“– å®˜æ–¹æ–‡æ¡£å¼•ç”¨</h4>
<p>æ¥è‡ª <a href="https://link.juejin.cn?target=https%3A%2F%2Ftexturegroup.org%2Fdocs%2Fintelligent-preloading.html" target="_blank" title="https://texturegroup.org/docs/intelligent-preloading.html" ref="nofollow noopener noreferrer">Intelligent Preloading</a>ï¼š</p>
<blockquote>
<p>"Texture provides <strong>granular callbacks</strong> for when content enters different stages of the pipeline.<br/>
Use <strong>Preload</strong> for network fetching, <strong>Display</strong> for rendering, and <strong>Visible</strong> for animations."</p>
</blockquote>
<h4 data-id="heading-22">å®Œæ•´ç¤ºä¾‹</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">VideoCardNode</span>: <span class="hljs-title class_">ASDisplayNode</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> videoNode <span class="hljs-operator">=</span> <span class="hljs-type">ASVideoNode</span>()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> titleNode <span class="hljs-operator">=</span> <span class="hljs-type">ASTextNode</span>()
    
    <span class="hljs-comment">// Preload: è·ç¦»å±å¹• 1-2 å±æ—¶è§¦å‘</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didEnterPreloadState</span>() {
        <span class="hljs-keyword">super</span>.didEnterPreloadState()
        
        <span class="hljs-comment">// âœ… å¼€å§‹ç½‘ç»œè¯·æ±‚</span>
        fetchVideoMetadata()
        
        <span class="hljs-comment">// âœ… é¢„åŠ è½½è§†é¢‘</span>
        videoNode.as<span class="hljs-keyword">set</span> <span class="hljs-operator">=</span> <span class="hljs-type">AVAsset</span>(url: videoURL)
    }
    
    <span class="hljs-comment">// Display: å³å°†æ˜¾ç¤ºä½†è¿˜æ²¡å®Œå…¨å¯è§</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didEnterDisplayState</span>() {
        <span class="hljs-keyword">super</span>.didEnterDisplayState()
        
        <span class="hljs-comment">// âœ… ç¡®ä¿å†…å®¹å·²æ¸²æŸ“</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"å†…å®¹å·²å‡†å¤‡å¥½æ˜¾ç¤º"</span>)
    }
    
    <span class="hljs-comment">// Visible: å®Œå…¨å‡ºç°åœ¨å±å¹•å†…</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didEnterVisibleState</span>() {
        <span class="hljs-keyword">super</span>.didEnterVisibleState()
        
        <span class="hljs-comment">// âœ… å¯åŠ¨åŠ¨ç”»</span>
        startPulseAnimation()
        
        <span class="hljs-comment">// âœ… æ’­æ”¾è§†é¢‘</span>
        videoNode.play()
        
        <span class="hljs-comment">// âœ… æ›å…‰æ‰“ç‚¹</span>
        <span class="hljs-type">Analytics</span>.trackImpression(itemId: videoId)
    }
    
    <span class="hljs-comment">// é€€å‡ºå¯è§çŠ¶æ€</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didExitVisibleState</span>() {
        <span class="hljs-keyword">super</span>.didExitVisibleState()
        
        <span class="hljs-comment">// âœ… ç«‹å³åœæ­¢åŠ¨ç”»</span>
        stopPulseAnimation()
        
        <span class="hljs-comment">// âœ… æš‚åœè§†é¢‘</span>
        videoNode.pause()
    }
    
    <span class="hljs-comment">// é€€å‡ºæ˜¾ç¤ºçŠ¶æ€</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didExitDisplayState</span>() {
        <span class="hljs-keyword">super</span>.didExitDisplayState()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"å·²é€€å‡ºæ˜¾ç¤ºåŒºåŸŸ"</span>)
    }
    
    <span class="hljs-comment">// é€€å‡ºé¢„åŠ è½½çŠ¶æ€</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didExitPreloadState</span>() {
        <span class="hljs-keyword">super</span>.didExitPreloadState()
        
        <span class="hljs-comment">// âœ… å–æ¶ˆç½‘ç»œè¯·æ±‚</span>
        cancelNetworkTasks()
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-23">ğŸ—‘ï¸ clearContents() - èµ„æºé‡Šæ”¾</h3>
<h4 data-id="heading-24">ğŸ§µ çº¿ç¨‹ç‰¹æ€§</h4>
<p><strong>âœ… ä¸»çº¿ç¨‹æ‰§è¡Œ</strong></p>
<h4 data-id="heading-25">ğŸ“– å®˜æ–¹æ–‡æ¡£å¼•ç”¨</h4>
<p>æ¥è‡ª <a href="https://link.juejin.cn?target=https%3A%2F%2Ftexturegroup.org%2Fdocs%2Fcontainers-overview.html" target="_blank" title="https://texturegroup.org/docs/containers-overview.html" ref="nofollow noopener noreferrer">Texture Best Practices</a>:</p>
<blockquote>
<p>"Override to <strong>clear any cached or calculated content</strong> when the node is no longer visible.<br/>
This is called automatically by the framework to manage memory."</p>
</blockquote>
<h4 data-id="heading-26">è§¦å‘æ—¶æœº</h4>
<p>èŠ‚ç‚¹å®Œå…¨é€€å‡ºé¢„åŠ è½½èŒƒå›´åï¼Œç³»ç»Ÿ<strong>è‡ªåŠ¨è°ƒç”¨</strong></p>
<h4 data-id="heading-27">âœ… åº”è¯¥åšçš„äº‹</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">clearContents</span>() {
    <span class="hljs-keyword">super</span>.clearContents()
    
    <span class="hljs-comment">// âœ… é‡Šæ”¾å¤§å›¾ï¼ˆå¯é‡å»ºçš„èµ„æºï¼‰</span>
    imageNode.image <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>
    
    <span class="hljs-comment">// âœ… åœæ­¢åŠ¨ç”»</span>
    lottieAnimationNode.stop()
    lottieAnimationNode.animationView <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>
    
    <span class="hljs-comment">// âœ… æ¸…é™¤ç¼“å­˜æ•°æ®</span>
    cachedRenderData <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>
    
    <span class="hljs-comment">// âœ… é‡Šæ”¾è§†é¢‘èµ„æº</span>
    videoNode.as<span class="hljs-keyword">set</span> <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>
}
</code></pre>
<h4 data-id="heading-28">âš ï¸ æ³¨æ„äº‹é¡¹</h4>
<ul>
<li><code>clearContents()</code> ä¼šåœ¨èŠ‚ç‚¹å®Œå…¨é€€å‡ºé¢„åŠ è½½èŒƒå›´åè‡ªåŠ¨è°ƒç”¨</li>
<li><strong>ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨</strong></li>
<li>ä¸»è¦ç”¨äºé‡Šæ”¾<strong>å¯é‡å»º</strong>çš„èµ„æºï¼ˆå¦‚è§£ç åçš„å›¾ç‰‡ã€æ¸²æŸ“ç¼“å­˜ï¼‰</li>
<li><strong>ä¸è¦é‡Šæ”¾é…ç½®æ•°æ®</strong>ï¼ˆå¦‚ URLã€IDã€æ ·å¼è®¾ç½®ç­‰ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-29">ğŸ¯ æœ€ä½³å®è·µæ€»ç»“</h3>
<h4 data-id="heading-30">çº¿ç¨‹å®‰å…¨æ£€æŸ¥è¡¨</h4>















































<table><thead><tr><th>ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</th><th>çº¿ç¨‹</th><th>å¯è®¿é—® view?</th><th>å¯è®¿é—® UIKit?</th></tr></thead><tbody><tr><td><code>init()</code></td><td>âš ï¸ åå°/ä¸»</td><td>âŒ å¦</td><td>âŒ å¦</td></tr><tr><td><code>didLoad()</code></td><td>âœ… ä¸»çº¿ç¨‹</td><td>âœ… æ˜¯</td><td>âœ… æ˜¯</td></tr><tr><td><code>layoutSpecThatFits()</code></td><td>âš ï¸ åå°/ä¸»</td><td>âŒ å¦</td><td>âŒ å¦</td></tr><tr><td><code>didEnter*State()</code></td><td>âœ… ä¸»çº¿ç¨‹</td><td>âœ… æ˜¯</td><td>âœ… æ˜¯</td></tr><tr><td><code>didExit*State()</code></td><td>âœ… ä¸»çº¿ç¨‹</td><td>âœ… æ˜¯</td><td>âœ… æ˜¯</td></tr><tr><td><code>clearContents()</code></td><td>âœ… ä¸»çº¿ç¨‹</td><td>âœ… æ˜¯</td><td>âœ… æ˜¯</td></tr></tbody></table>
<h4 data-id="heading-31">è®°å¿†å£è¯€</h4>
<blockquote>
<p><strong>"åˆå»ºå¸ƒå±€åœ¨åå°ï¼Œè£…è½½æ˜¾ç¤ºå›ä¸»å¹²"</strong></p>
<ul>
<li><strong>åˆ</strong>(init) <strong>å»º</strong>(layoutSpec) å¯èƒ½åœ¨<strong>åå°çº¿ç¨‹</strong> â†’ ç¦æ­¢è®¿é—® UIKit</li>
<li><strong>è£…</strong>(didLoad) <strong>è½½æ˜¾ç¤º</strong>(Interface State) éƒ½åœ¨<strong>ä¸»çº¿ç¨‹</strong> â†’ å¯ä»¥è®¿é—® UIKit</li>
</ul>
</blockquote>
<h4 data-id="heading-32">èŒè´£åˆ†ç¦»åŸåˆ™</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyNode</span>: <span class="hljs-title class_">ASDisplayNode</span> {
    <span class="hljs-comment">// âœ… init: åˆ›å»ºèŠ‚ç‚¹æ ‘ + è®¾ç½®é™æ€å±æ€§</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">init</span>() {
        <span class="hljs-keyword">super</span>.<span class="hljs-keyword">init</span>()
        addSubnode(avatarNode)
        avatarNode.cornerRadius <span class="hljs-operator">=</span> <span class="hljs-number">10</span>
    }
    
    <span class="hljs-comment">// âœ… didLoad: UIKit äº¤äº’</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didLoad</span>() {
        <span class="hljs-keyword">super</span>.didLoad()
        view.addGestureRecognizer(<span class="hljs-operator">...</span>)
    }
    
    <span class="hljs-comment">// âœ… layoutSpec: çº¯å¸ƒå±€æè¿°</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">layoutSpecThatFits</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">size</span>: <span class="hljs-type">ASSizeRange</span>) -&gt; <span class="hljs-type">ASLayoutSpec</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-type">ASStackLayoutSpec</span>(<span class="hljs-operator">...</span>)
    }
    
    <span class="hljs-comment">// âœ… Preload: æ•°æ®åŠ è½½</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didEnterPreloadState</span>() {
        <span class="hljs-keyword">super</span>.didEnterPreloadState()
        fetchData()
    }
    
    <span class="hljs-comment">// âœ… Visible: åŠ¨ç”»/è§†é¢‘</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didEnterVisibleState</span>() {
        <span class="hljs-keyword">super</span>.didEnterVisibleState()
        videoNode.play()
    }
    
    <span class="hljs-comment">// âœ… clearContents: é‡Šæ”¾å¯é‡å»ºèµ„æº</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">clearContents</span>() {
        <span class="hljs-keyword">super</span>.clearContents()
        imageNode.image <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-33">âš ï¸ å¸¸è§å´©æºƒåœºæ™¯</h3>
<h4 data-id="heading-34">åœºæ™¯ 1ï¼šåœ¨ init ä¸­è®¿é—® view</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âŒ å½“ä½¿ç”¨ ASCellNode(block:) æ—¶ä¼šå´©æºƒ</span>
<span class="hljs-keyword">override</span> <span class="hljs-keyword">init</span>() {
    <span class="hljs-keyword">super</span>.<span class="hljs-keyword">init</span>()
    <span class="hljs-keyword">self</span>.view.backgroundColor <span class="hljs-operator">=</span> .white  <span class="hljs-comment">// ğŸ’¥ åå°çº¿ç¨‹è®¿é—® UIKit</span>
}
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">override</span> <span class="hljs-keyword">init</span>() {
    <span class="hljs-keyword">super</span>.<span class="hljs-keyword">init</span>()
    <span class="hljs-keyword">self</span>.backgroundColor <span class="hljs-operator">=</span> .white  <span class="hljs-comment">// âœ… ä½¿ç”¨ Node çš„å±æ€§</span>
}

<span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didLoad</span>() {
    <span class="hljs-keyword">super</span>.didLoad()
    <span class="hljs-keyword">self</span>.view.layer.shadowRadius <span class="hljs-operator">=</span> <span class="hljs-number">5</span>  <span class="hljs-comment">// âœ… åœ¨ didLoad ä¸­è®¿é—® layer</span>
}
</code></pre>
<h4 data-id="heading-35">åœºæ™¯ 2ï¼šåœ¨ layoutSpec ä¸­ä¿®æ”¹ view</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âŒ åå°çº¿ç¨‹è°ƒç”¨æ—¶ä¼šå´©æºƒ</span>
<span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">layoutSpecThatFits</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">size</span>: <span class="hljs-type">ASSizeRange</span>) -&gt; <span class="hljs-type">ASLayoutSpec</span> {
    textNode.view.numberOfLines <span class="hljs-operator">=</span> <span class="hljs-number">2</span>  <span class="hljs-comment">// ğŸ’¥ è®¿é—®äº† UILabel</span>
    <span class="hljs-keyword">return</span> <span class="hljs-type">ASLayoutSpec</span>()
}
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">layoutSpecThatFits</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">size</span>: <span class="hljs-type">ASSizeRange</span>) -&gt; <span class="hljs-type">ASLayoutSpec</span> {
    textNode.maximumNumberOfLines <span class="hljs-operator">=</span> <span class="hljs-number">2</span>  <span class="hljs-comment">// âœ… ä½¿ç”¨ Node çš„å±æ€§</span>
    <span class="hljs-keyword">return</span> <span class="hljs-type">ASLayoutSpec</span>()
}
</code></pre>
<h4 data-id="heading-36">åœºæ™¯ 3ï¼šåœ¨ layoutSpec ä¸­è°ƒç”¨ UIColor</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âš ï¸ åå°çº¿ç¨‹å¯èƒ½æœ‰é—®é¢˜</span>
<span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">layoutSpecThatFits</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">size</span>: <span class="hljs-type">ASSizeRange</span>) -&gt; <span class="hljs-type">ASLayoutSpec</span> {
    <span class="hljs-keyword">let</span> color <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.systemBlue  <span class="hljs-comment">// å±é™©ï¼</span>
    textNode.backgroundColor <span class="hljs-operator">=</span> color
    <span class="hljs-keyword">return</span> <span class="hljs-type">ASLayoutSpec</span>()
}
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âœ… åœ¨ init ä¸­è®¾ç½®</span>
<span class="hljs-keyword">override</span> <span class="hljs-keyword">init</span>() {
    <span class="hljs-keyword">super</span>.<span class="hljs-keyword">init</span>()
    textNode.backgroundColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.systemBlue
}

<span class="hljs-comment">// æˆ–åœ¨ didLoad ä¸­è®¾ç½®</span>
<span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didLoad</span>() {
    <span class="hljs-keyword">super</span>.didLoad()
    textNode.view.backgroundColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.systemBlue
}
</code></pre>
<hr/>
<h3 data-id="heading-37">ğŸ“Š å®Œæ•´ç”Ÿå‘½å‘¨æœŸç¤ºä¾‹</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CompleteExampleNode</span>: <span class="hljs-title class_">ASDisplayNode</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> avatarNode <span class="hljs-operator">=</span> <span class="hljs-type">ASNetworkImageNode</span>()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> titleNode <span class="hljs-operator">=</span> <span class="hljs-type">ASTextNode</span>()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> videoNode <span class="hljs-operator">=</span> <span class="hljs-type">ASVideoNode</span>()
    
    <span class="hljs-comment">// 1ï¸âƒ£ åˆå§‹åŒ–ï¼ˆå¯èƒ½åœ¨åå°çº¿ç¨‹ï¼‰</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">init</span>() {
        <span class="hljs-keyword">super</span>.<span class="hljs-keyword">init</span>()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… 1. init - å¯èƒ½åœ¨åå°çº¿ç¨‹"</span>)
        
        <span class="hljs-comment">// åªåšçº¿ç¨‹å®‰å…¨æ“ä½œ</span>
        automaticallyManagesSubnodes <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>
        avatarNode.cornerRadius <span class="hljs-operator">=</span> <span class="hljs-number">20</span>
        titleNode.maximumNumberOfLines <span class="hljs-operator">=</span> <span class="hljs-number">2</span>
    }
    
    <span class="hljs-comment">// 2ï¸âƒ£ è§†å›¾å·²åˆ›å»ºï¼ˆä¸»çº¿ç¨‹ï¼‰</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didLoad</span>() {
        <span class="hljs-keyword">super</span>.didLoad()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… 2. didLoad - ä¸»çº¿ç¨‹"</span>)
        
        <span class="hljs-comment">// è®¿é—® UIKit</span>
        <span class="hljs-keyword">let</span> tapGesture <span class="hljs-operator">=</span> <span class="hljs-type">UITapGestureRecognizer</span>(target: <span class="hljs-keyword">self</span>, action: <span class="hljs-keyword">#selector</span>(handleTap))
        view.addGestureRecognizer(tapGesture)
        
        videoNode.view.layer.cornerRadius <span class="hljs-operator">=</span> <span class="hljs-number">8</span>
    }
    
    <span class="hljs-comment">// 3ï¸âƒ£ å¸ƒå±€æµ‹é‡ï¼ˆå¯èƒ½åœ¨åå°çº¿ç¨‹ï¼‰</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">layoutSpecThatFits</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">constrainedSize</span>: <span class="hljs-type">ASSizeRange</span>) -&gt; <span class="hljs-type">ASLayoutSpec</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… 3. layoutSpecThatFits - å¯èƒ½åœ¨åå°çº¿ç¨‹"</span>)
        
        <span class="hljs-comment">// åªåšå¸ƒå±€æè¿°</span>
        avatarNode.style.preferredSize <span class="hljs-operator">=</span> <span class="hljs-type">CGSize</span>(width: <span class="hljs-number">40</span>, height: <span class="hljs-number">40</span>)
        
        <span class="hljs-keyword">let</span> vStack <span class="hljs-operator">=</span> <span class="hljs-type">ASStackLayoutSpec</span>.vertical()
        vStack.spacing <span class="hljs-operator">=</span> <span class="hljs-number">8</span>
        vStack.children <span class="hljs-operator">=</span> [avatarNode, titleNode, videoNode]
        
        <span class="hljs-keyword">return</span> <span class="hljs-type">ASInsetLayoutSpec</span>(insets: <span class="hljs-type">UIEdgeInsets</span>(top: <span class="hljs-number">12</span>, left: <span class="hljs-number">16</span>, bottom: <span class="hljs-number">12</span>, right: <span class="hljs-number">16</span>), child: vStack)
    }
    
    <span class="hljs-comment">// 4ï¸âƒ£ è¿›å…¥é¢„åŠ è½½çŠ¶æ€ï¼ˆä¸»çº¿ç¨‹ï¼‰</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didEnterPreloadState</span>() {
        <span class="hljs-keyword">super</span>.didEnterPreloadState()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… 4. didEnterPreloadState - ä¸»çº¿ç¨‹"</span>)
        
        <span class="hljs-comment">// å¼€å§‹ç½‘ç»œè¯·æ±‚</span>
        fetchVideoData()
    }
    
    <span class="hljs-comment">// 5ï¸âƒ£ è¿›å…¥æ˜¾ç¤ºçŠ¶æ€ï¼ˆä¸»çº¿ç¨‹ï¼‰</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didEnterDisplayState</span>() {
        <span class="hljs-keyword">super</span>.didEnterDisplayState()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… 5. didEnterDisplayState - ä¸»çº¿ç¨‹"</span>)
    }
    
    <span class="hljs-comment">// 6ï¸âƒ£ è¿›å…¥å¯è§çŠ¶æ€ï¼ˆä¸»çº¿ç¨‹ï¼‰</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didEnterVisibleState</span>() {
        <span class="hljs-keyword">super</span>.didEnterVisibleState()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… 6. didEnterVisibleState - ä¸»çº¿ç¨‹"</span>)
        
        <span class="hljs-comment">// æ’­æ”¾è§†é¢‘å’ŒåŠ¨ç”»</span>
        videoNode.play()
        startAnimation()
    }
    
    <span class="hljs-comment">// 7ï¸âƒ£ é€€å‡ºå¯è§çŠ¶æ€ï¼ˆä¸»çº¿ç¨‹ï¼‰</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didExitVisibleState</span>() {
        <span class="hljs-keyword">super</span>.didExitVisibleState()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… 7. didExitVisibleState - ä¸»çº¿ç¨‹"</span>)
        
        <span class="hljs-comment">// åœæ­¢è§†é¢‘å’ŒåŠ¨ç”»</span>
        videoNode.pause()
        stopAnimation()
    }
    
    <span class="hljs-comment">// 8ï¸âƒ£ é€€å‡ºæ˜¾ç¤ºçŠ¶æ€ï¼ˆä¸»çº¿ç¨‹ï¼‰</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didExitDisplayState</span>() {
        <span class="hljs-keyword">super</span>.didExitDisplayState()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… 8. didExitDisplayState - ä¸»çº¿ç¨‹"</span>)
    }
    
    <span class="hljs-comment">// 9ï¸âƒ£ é€€å‡ºé¢„åŠ è½½çŠ¶æ€ï¼ˆä¸»çº¿ç¨‹ï¼‰</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didExitPreloadState</span>() {
        <span class="hljs-keyword">super</span>.didExitPreloadState()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… 9. didExitPreloadState - ä¸»çº¿ç¨‹"</span>)
        
        <span class="hljs-comment">// å–æ¶ˆç½‘ç»œè¯·æ±‚</span>
        cancelNetworkTasks()
    }
    
    <span class="hljs-comment">// ğŸ”Ÿ æ¸…é™¤å†…å®¹ï¼ˆä¸»çº¿ç¨‹ï¼‰</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">clearContents</span>() {
        <span class="hljs-keyword">super</span>.clearContents()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… 10. clearContents - ä¸»çº¿ç¨‹"</span>)
        
        <span class="hljs-comment">// é‡Šæ”¾èµ„æº</span>
        avatarNode.image <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>
        videoNode.as<span class="hljs-keyword">set</span> <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>
    }
    
    <span class="hljs-comment">// 1ï¸âƒ£1ï¸âƒ£ é”€æ¯</span>
    <span class="hljs-keyword">deinit</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… 11. deinit"</span>)
    }
    
    <span class="hljs-keyword">@objc</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">handleTap</span>() {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"èŠ‚ç‚¹è¢«ç‚¹å‡»"</span>)
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchVideoData</span>() {}
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">cancelNetworkTasks</span>() {}
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">startAnimation</span>() {}
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">stopAnimation</span>() {}
}
</code></pre>
<hr/>
<h3 data-id="heading-38">ğŸ“š å®˜æ–¹èµ„æº</h3>
<ol>
<li><strong>æºç æ³¨é‡Š</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTextureGroup%2FTexture%2Fblob%2Fmaster%2FSource%2FASDisplayNode.h" target="_blank" title="https://github.com/TextureGroup/Texture/blob/master/Source/ASDisplayNode.h" ref="nofollow noopener noreferrer">ASDisplayNode.h</a></li>
<li><strong>å®˜æ–¹æ–‡æ¡£</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftexturegroup.org%2Fdocs%2Fcontainers-overview.html" target="_blank" title="https://texturegroup.org/docs/containers-overview.html" ref="nofollow noopener noreferrer">Node Lifecycle</a></li>
<li><strong>æ™ºèƒ½é¢„åŠ è½½</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftexturegroup.org%2Fdocs%2Fintelligent-preloading.html" target="_blank" title="https://texturegroup.org/docs/intelligent-preloading.html" ref="nofollow noopener noreferrer">Intelligent Preloading</a></li>
<li><strong>çº¿ç¨‹å®‰å…¨æŒ‡å—</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftexturegroup.org%2Fdocs%2Fthread-safety.html" target="_blank" title="https://texturegroup.org/docs/thread-safety.html" ref="nofollow noopener noreferrer">Thread Safety</a></li>
<li><strong>å®¹å™¨èŠ‚ç‚¹æ–‡æ¡£</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftexturegroup.org%2Fdocs%2Fcontainers-asviewcontroller.html" target="_blank" title="https://texturegroup.org/docs/containers-asviewcontroller.html" ref="nofollow noopener noreferrer">ASViewController</a></li>
</ol>
<hr/>
<h3 data-id="heading-39">ğŸ“ è¿›é˜¶ä¸»é¢˜</h3>
<h4 data-id="heading-40">Interface State çš„ç²¾ç¡®æ§åˆ¶</h4>
<p>ä½ å¯ä»¥é€šè¿‡ <code>interfaceState</code> å±æ€§æ‰‹åŠ¨æ£€æŸ¥èŠ‚ç‚¹çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">if</span> interfaceState.contains(.visible) {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"èŠ‚ç‚¹å½“å‰å¯è§"</span>)
}

<span class="hljs-keyword">if</span> interfaceState.contains(.preload) {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"èŠ‚ç‚¹åœ¨é¢„åŠ è½½èŒƒå›´å†…"</span>)
}
</code></pre>
<h4 data-id="heading-41">è‡ªå®šä¹‰é¢„åŠ è½½è·ç¦»</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// åœ¨å®¹å™¨èŠ‚ç‚¹ï¼ˆå¦‚ ASTableNodeï¼‰ä¸­è®¾ç½®</span>
tableNode.leadingScreensForBatching <span class="hljs-operator">=</span> <span class="hljs-number">2.0</span>  <span class="hljs-comment">// æå‰ 2 å±å¼€å§‹é¢„åŠ è½½</span>
</code></pre>
<h4 data-id="heading-42">æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h4>
<ol>
<li>
<p><strong>åˆç†ä½¿ç”¨ Interface State</strong></p>
<ul>
<li>Preload: ç½‘ç»œè¯·æ±‚ï¼ˆè·ç¦»è¿œï¼Œæå‰åŠ è½½ï¼‰</li>
<li>Display: æ–‡æœ¬æ¸²æŸ“ï¼ˆå³å°†æ˜¾ç¤ºï¼‰</li>
<li>Visible: åŠ¨ç”»/è§†é¢‘ï¼ˆåªåœ¨å¯è§æ—¶æ’­æ”¾ï¼‰</li>
</ul>
</li>
<li>
<p><strong>åŠæ—¶é‡Šæ”¾èµ„æº</strong></p>
</li>
</ol>
<pre><code class="hljs language-swift" lang="swift">   <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">didExitVisibleState</span>() {
       <span class="hljs-keyword">super</span>.didExitVisibleState()
       videoNode.pause()  <span class="hljs-comment">// ç«‹å³æš‚åœï¼ŒèŠ‚çœç”µé‡</span>
   }
   
   <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">clearContents</span>() {
       <span class="hljs-keyword">super</span>.clearContents()
       imageNode.image <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>  <span class="hljs-comment">// é‡Šæ”¾å†…å­˜</span>
   }
</code></pre>
<ol start="3">
<li><strong>é¿å…åœ¨ layoutSpec ä¸­åšé‡è®¡ç®—</strong></li>
</ol>
<pre><code class="hljs language-swift" lang="swift">   <span class="hljs-comment">// âŒ æ¯æ¬¡å¸ƒå±€éƒ½é‡æ–°è®¡ç®—</span>
   <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">layoutSpecThatFits</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">size</span>: <span class="hljs-type">ASSizeRange</span>) -&gt; <span class="hljs-type">ASLayoutSpec</span> {
       <span class="hljs-keyword">let</span> processedText <span class="hljs-operator">=</span> heavyTextProcessing(rawText)  <span class="hljs-comment">// è€—æ—¶æ“ä½œ</span>
       textNode.attributedText <span class="hljs-operator">=</span> processedText
       <span class="hljs-keyword">return</span> <span class="hljs-type">ASLayoutSpec</span>()
   }
   
   <span class="hljs-comment">// âœ… åœ¨æ•°æ®æ›´æ–°æ—¶è®¡ç®—ä¸€æ¬¡</span>
   <span class="hljs-keyword">func</span> <span class="hljs-title function_">updateData</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">newText</span>: <span class="hljs-type">String</span>) {
       <span class="hljs-keyword">let</span> processedText <span class="hljs-operator">=</span> heavyTextProcessing(newText)
       textNode.attributedText <span class="hljs-operator">=</span> processedText
       setNeedsLayout()
   }
</code></pre>
<hr/>
<h3 data-id="heading-43">ğŸ’¡ æ€»ç»“</h3>
<h4 data-id="heading-44">ä¸‰æ¡é»„é‡‘æ³•åˆ™</h4>
<ol>
<li>
<p><strong>çº¿ç¨‹å®‰å…¨ç¬¬ä¸€</strong></p>
<ul>
<li><code>init()</code> å’Œ <code>layoutSpecThatFits()</code> å¯èƒ½åœ¨åå°çº¿ç¨‹</li>
<li>ç»å¯¹ä¸è¦åœ¨è¿™ä¸¤ä¸ªæ–¹æ³•ä¸­è®¿é—® UIKit</li>
</ul>
</li>
<li>
<p><strong>èŒè´£åˆ†ç¦»</strong></p>
<ul>
<li>init: åˆ›å»ºèŠ‚ç‚¹æ ‘</li>
<li>didLoad: UIKit äº¤äº’</li>
<li>layoutSpec: çº¯å¸ƒå±€æè¿°</li>
<li>Interface State: ç”Ÿå‘½å‘¨æœŸå“åº”</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜å…ˆ</strong></p>
<ul>
<li>ä½¿ç”¨ Preload æå‰åŠ è½½</li>
<li>ä½¿ç”¨ clearContents é‡Šæ”¾èµ„æº</li>
<li>åŠæ—¶åœæ­¢åŠ¨ç”»å’Œè§†é¢‘</li>
</ul>
</li>
</ol>
<h4 data-id="heading-45">è°ƒè¯•æŠ€å·§</h4>
<p>å¼€å¯ Texture çš„è°ƒè¯•æ—¥å¿—ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// åœ¨ AppDelegate ä¸­</span>
<span class="hljs-keyword">#if</span> <span class="hljs-type">DEBUG</span>
<span class="hljs-type">ASDisplayNode</span>.shouldShowRangeDebugOverlay <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>
<span class="hljs-keyword">#endif</span>
</code></pre>
<p>è¿™ä¼šåœ¨å±å¹•ä¸Šæ˜¾ç¤ºæ¯ä¸ªèŠ‚ç‚¹çš„ Interface Stateï¼Œå¸®åŠ©ä½ ç†è§£ç”Ÿå‘½å‘¨æœŸã€‚</p>
<hr/>
<p><strong>å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ é¿å¼€ Texture çš„å¸¸è§é™·é˜±ï¼Œå†™å‡ºé«˜æ€§èƒ½çš„ä»£ç ï¼</strong> ğŸš€</p>
<p>å¦‚æœ‰é—®é¢˜æ¬¢è¿è¯„è®ºè®¨è®ºï¼Œä¹Ÿæ¬¢è¿è¡¥å……æ›´å¤šå®æˆ˜ç»éªŒï¼</p>
<hr/>
<blockquote>
<p>ä½œè€…ï¼š[ä½ çš„æ˜µç§°]<br/>
é“¾æ¥ï¼š[æ–‡ç« é“¾æ¥]<br/>
æ¥æºï¼šç¨€åœŸæ˜é‡‘<br/>
è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¾®è°ƒå…¥é—¨å°è¯•ï¼šæ²é›ªè§’è‰²æ‰®æ¼”]]></title>    <link>https://juejin.cn/post/7578734725301780532</link>    <guid>https://juejin.cn/post/7578734725301780532</guid>    <pubDate>2025-12-01T11:28:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578734725301780532" data-draft-id="7578714759336804352" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¾®è°ƒå…¥é—¨å°è¯•ï¼šæ²é›ªè§’è‰²æ‰®æ¼”"/> <meta itemprop="keywords" content="LLM,Python"/> <meta itemprop="datePublished" content="2025-12-01T11:28:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·57690530801"/> <meta itemprop="url" content="https://juejin.cn/user/3543039723449851"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¾®è°ƒå…¥é—¨å°è¯•ï¼šæ²é›ªè§’è‰²æ‰®æ¼”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3543039723449851/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·57690530801
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-01T11:28:58.000Z" title="Mon Dec 01 2025 11:28:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æˆ‘ä»¬è¿˜æ˜¯è§‰å¾—åƒé—®å¤§æ¨¡å‹çš„å›ç­”å®åœ¨æ˜¯<code>AI</code>å‘³é“å¤ªé‡äº†ï¼Œæˆ‘ä»¬å¸Œæœ›<code>AI</code>èƒ½å¤Ÿæ‹¥æœ‰è‡ªå·±ç‹¬ç‰¹çš„é£æ ¼ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å°±è¯•è¯•å¾®è°ƒä¸€ä¸‹ã€‚</p>
<p>åœ¨æ­¤ï¼Œæ„Ÿè°¢æ„Ÿè°¢ä½œè€…<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FMoemu" target="_blank" title="https://github.com/Moemu" ref="nofollow noopener noreferrer">Moemu</a>çš„å¼€æº<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.modelscope.cn%2Fdatasets%2FMoemuu%2FMuice-Dataset" target="_blank" title="https://www.modelscope.cn/datasets/Moemuu/Muice-Dataset" ref="nofollow noopener noreferrer">æ²é›ªè§’è‰²æ‰®æ¼”è®­ç»ƒé›†</a>ï¼Œä¹Ÿæ„Ÿè°¢æ‰€æœ‰ä¸ºæ²é›ªæ•°æ®é›†åšå‡ºè´¡çŒ®çš„ä½œè€…ã€‚</p>

<h2 data-id="heading-1">å¾®è°ƒç¯å¢ƒ</h2>
<p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæ‰‹ä¸Šçªç„¶å¤šäº†ä¸€å°<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn></mrow><annotation encoding="application/x-tex">8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">8</span></span></span></span></span>å¼ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5090</mn></mrow><annotation encoding="application/x-tex">5090</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">5090</span></span></span></span></span>çš„æœºå™¨ã€‚äºæ˜¯å‘¢ï¼Œæˆ‘è¿™é‡Œå°±æš‚æ—¶ç”¨è¿™å°ç”µè„‘å¾®è°ƒä¸€ä¸‹ã€‚</p>
<p>ä½¿ç”¨çš„å·¥å…·å½“ç„¶è¿˜æ˜¯åƒé—®çš„<code>ms-swift</code>å·¥å…·ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmodelscope%2Fms-swift" target="_blank" title="https://github.com/modelscope/ms-swift" ref="nofollow noopener noreferrer">è¿™é‡Œæ˜¯å·¥å…·åŸé“¾æ¥</a>ï¼Œä¸è¿‡ä»–è¿˜æœ‰ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå·²ç»å¸¦æœ‰äº†å¾ˆå¤šå¿…è¦çš„åº“ï¼Œå³ä½¿ä¸ç”¨<code>ms-swift</code>ï¼Œè€Œæ˜¯æ‰‹åŠ¨ä½¿ç”¨<code>transformers</code>åˆ›å»º<code>peft</code>è„šæœ¬ï¼Œä¹Ÿæ˜¯å®Œå…¨å¤Ÿç”¨çš„ã€‚</p>
<p>å…ˆçœ‹ä¸€ä¸‹<code>ms-swift</code>çš„ä¾èµ–ï¼š</p>































































































<table><thead><tr><th align="center"/><th align="center">Range</th><th align="center">Recommended</th><th align="center">Notes</th></tr></thead><tbody><tr><td align="center">python</td><td align="center">&gt;=3.9</td><td align="center">3.10/3.11</td><td align="center"/></tr><tr><td align="center">cuda</td><td align="center"/><td align="center">cuda12</td><td align="center">No need to install if using CPU, NPU, MPS</td></tr><tr><td align="center">torch</td><td align="center">&gt;=2.0</td><td align="center">2.8.0</td><td align="center"/></tr><tr><td align="center">transformers</td><td align="center">&gt;=4.33</td><td align="center">4.57.1</td><td align="center"/></tr><tr><td align="center">modelscope</td><td align="center">&gt;=1.23</td><td align="center"/><td align="center"/></tr><tr><td align="center">peft</td><td align="center">&gt;=0.11,&lt;0.19</td><td align="center"/><td align="center"/></tr><tr><td align="center">flash_attn</td><td align="center"/><td align="center">2.8.1/3.0.0b1</td><td align="center"/></tr><tr><td align="center">trl</td><td align="center">&gt;=0.15,&lt;0.25</td><td align="center">0.23.1</td><td align="center">RLHF</td></tr><tr><td align="center">deepspeed</td><td align="center">&gt;=0.14</td><td align="center">0.17.6</td><td align="center">Training</td></tr><tr><td align="center">vllm</td><td align="center">&gt;=0.5.1</td><td align="center">0.11.0</td><td align="center">Inference/Deployment</td></tr><tr><td align="center">sglang</td><td align="center">&gt;=0.4.6</td><td align="center">0.5.4.post2</td><td align="center">Inference/Deployment</td></tr><tr><td align="center">lmdeploy</td><td align="center">&gt;=0.5</td><td align="center">0.10.2</td><td align="center">Inference/Deployment</td></tr><tr><td align="center">evalscope</td><td align="center">&gt;=1.0</td><td align="center"/><td align="center">Evaluation</td></tr><tr><td align="center">gradio</td><td align="center"/><td align="center">5.32.1</td><td align="center">Web-UI/App</td></tr></tbody></table>
<p>å…¶å®å¤§ä½“ä¸Šæ²¡å•¥é—®é¢˜ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¼€å§‹é‡‡ç”¨<code>conda</code>å®‰è£…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">conda create -n swift python=3.10 -y  <span class="hljs-comment"># æˆ–è€…11ä¹Ÿå¯ä»¥ï¼Œæ¨è10</span>
conda deactivate                      <span class="hljs-comment"># é˜²æ­¢è«åå…¶å¦™è£…è¿›baseé‡Œ</span>
conda activate swift
pip install ms-swift                  <span class="hljs-comment"># å®‰è£…å¤§éƒ¨åˆ†å·¥å…·</span>
</code></pre>
<p>ä½†æ˜¯å•Šï¼Œ<code>Python</code>çš„çƒ­é—¨åŒ…æ›´æ–°ç‰¹åˆ«å¿«ï¼Œæˆ‘ä»¬è¿™é‡Œåšç‚¹ä¿®æ”¹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pip uninstall gradio gradio_client antlr4-python3-runtime
pip install vllm==0.11.0 trl==0.23.1 gradio==5.32.1 math_verify==0.8.0 antlr4-python3-runtime==4.9.3
</code></pre>
<p>ç„¶åï¼Œè¿˜æœ‰ä¸€ä¸ªå¤§é—®é¢˜ï¼š<code>transformers</code>ç‰ˆæœ¬é—®é¢˜ã€‚</p>
<p>åœ¨æœ¬æ–‡ç¼–å†™çš„æ—¶å€™ï¼Œæœ€æ–°çš„ç‰ˆæœ¬å°±æ˜¯<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4.57.1</mn></mrow><annotation encoding="application/x-tex">4.57.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">4.57.1</span></span></span></span></span>ï¼Œä½†æ˜¯å¾ˆå¤šä»£ç åº“çš„ä¾èµ–æ˜¯<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4.56.2</mn></mrow><annotation encoding="application/x-tex">4.56.2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">4.56.2</span></span></span></span></span>ï¼Œéƒ¨åˆ†é‡è¦å‡½æ•°è¢«æ›¿æ¢ã€‚</p>
<p>å¦‚æœä½ éœ€è¦ç”¨è„šæœ¬ï¼Œä½ å°±å¾—æ›´æ¢ç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pip uninstall transformers
pip install transformers==4.56.2
</code></pre>
<p>è€Œå¦‚æœä½ ä½¿ç”¨ä»£ç æ§åˆ¶ï¼Œé‚£ä¹ˆä½ åˆå¤šäº†ä¸€ç§é€‰æ‹©ï¼šçŒ´å­è¡¥ä¸</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> activations

<span class="hljs-keyword">try</span>:
    <span class="hljs-keyword">from</span> transformers.activations <span class="hljs-keyword">import</span> PytorchGELUTanh
<span class="hljs-keyword">except</span> ImportError:
    <span class="hljs-keyword">from</span> transformers.activations <span class="hljs-keyword">import</span> GELUTanh
    activations.PytorchGELUTanh = GELUTanh
    PytorchGELUTanh = GELUTanh
</code></pre>
<p>å¼ºè¡Œæ‰¾åˆ°ä¸€ä¸ªç±»ä¼¼ç”šè‡³å®Œå…¨ä¸€æ ·çš„æ–¹æ³•ï¼Œç„¶åæŠŠä»–åƒä¸ªè¡¥ä¸ä¸€æ ·è´´ä¸Šå»ã€‚</p>
<p>å½“ç„¶ï¼Œç›´æ¥æŠŠç‰ˆæœ¬å¯¹é½äº†å…¶å®æ›´æ–¹ä¾¿ã€‚</p>
<p>æœ€åï¼ŒåŠ ä¸€ä¸ªæŸ¥çœ‹æ—¥å¿—çš„å†…å®¹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pip install swanlab
</code></pre>
<p>ç™»å½•çš„æ–¹æ³•å°±ä¸åœ¨è¿™é‡Œèµ˜è¿°äº†ã€‚</p>
<h2 data-id="heading-2">æ•°æ®é›†</h2>
<p>å†æ¬¡ï¼Œæ„Ÿè°¢ä½œè€…<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FMoemu" target="_blank" title="https://github.com/Moemu" ref="nofollow noopener noreferrer">Moemu</a>çš„å¼€æº<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.modelscope.cn%2Fdatasets%2FMoemuu%2FMuice-Dataset" target="_blank" title="https://www.modelscope.cn/datasets/Moemuu/Muice-Dataset" ref="nofollow noopener noreferrer">æ²é›ªè§’è‰²æ‰®æ¼”è®­ç»ƒé›†</a>ï¼Œä»¥åŠæ‰€æœ‰ä¸ºæ²é›ªæ•°æ®é›†åšå‡ºè´¡çŒ®çš„ä½œè€…ã€‚</p>
<h2 data-id="heading-3">è„šæœ¬å¾®è°ƒ</h2>
<p>ä½¿ç”¨<code>ms-swift</code>çš„è„šæœ¬è¿›è¡Œå¾®è°ƒçš„æ—¶å€™ï¼Œå…¶å®éå¸¸æ–¹ä¾¿ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7 \
swift sft \
    --model /usr/local/models/Qwen/Qwen2-1.5B-Instruct \
    --dataset /usr/local/muice/train.jsonl /usr/local/muice/Customized/ruozhiba.jsonl /usr/local/muice/Customized/self_cognition.jsonl /usr/local/muice/Customized/wikihow.jsonl \
    --val_dataset /usr/local/muice/test.jsonl \
    --train_type full \
    --gradient_accumulation_steps 4 \
    --eval_steps 20 \
    --num_train_epochs 5 \
    --per_device_train_batch_size 1 \
    --per_device_eval_batch_size 1 \
    --logging_steps 5 \
    --output_dir output \
    --save_steps 50 \
    --save_total_limit 5 \
    --logging_steps 5 \
    --max_length 40960 \
    --learning_rate 1e-5 \
    --warmup_ratio 5e-2 \
    --dataloader_num_workers 4 \
    --model_author swift \
    --model_name swift-robot \
    --report_to swanlab \
    --swanlab_project swift-robot \
    --system <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªåä¸ºæ²é›ªçš„å¯çˆ±AIå¥³å­©å­"</span>
</code></pre>
<p>è¿™é‡Œçš„å‚æ•°å¯ä»¥<a href="https://link.juejin.cn?target=https%3A%2F%2Fswift.readthedocs.io%2Fzh-cn%2Flatest%2FInstruction%2FCommand-line-parameters.html" target="_blank" title="https://swift.readthedocs.io/zh-cn/latest/Instruction/Command-line-parameters.html" ref="nofollow noopener noreferrer">æŸ¥çœ‹æ–‡æ¡£</a>è¿›è¡Œå…·ä½“é…ç½®ã€‚</p>
<p>ç„¶åï¼Œç­‰å¾…ç»“æœå®Œæˆå°±å¥½äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98e02244233942a08c81e175f3ca9877~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTc2OTA1MzA4MDE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765193337&amp;x-signature=EXFaZyGXWZjcx8mZOHHH04b6Wfk%3D" alt="è®­ç»ƒç»“æœ" loading="lazy"/></p>
<p>è¿™é‡Œæ˜¯å› ä¸ºè¾ƒå°çš„<code>batch_size</code>å¸¦æ¥äº†å·¨å¤§çš„éœ‡è¡ã€‚è€Œ<code>batch_size</code>çš„åˆ™æ˜¯<code>per_device_train_batch_size</code>å’Œ<code>gradient_accumulation_steps</code>çš„ä¹˜ç§¯ã€‚å› æ­¤ï¼Œé€‚å½“è°ƒå¤§<code>per_device_train_batch_size</code>å’Œ<code>gradient_accumulation_steps</code>å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>å‡ºæ¥çš„ç»“æœä¹Ÿå°±æ˜¯éå¸¸å¯è§‚äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c15ef610fcf4531af51dc50f7735bc8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTc2OTA1MzA4MDE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765193337&amp;x-signature=O8Cyn35DG3ChpDkzd%2FXg%2F9IDsNE%3D" alt="æœ€ç»ˆé—®ç­”æ•ˆæœ" loading="lazy"/></p>
<h2 data-id="heading-4">ä»£ç å¾®è°ƒ</h2>
<p>ä»£ç å¾®è°ƒå…¶å®å°±æ˜¯ä¸€æ¬¡æ‰‹æ’¸ä»£ç äº†ã€‚</p>
<h3 data-id="heading-5">æˆ‘ä»¬è¦åšä»€ä¹ˆï¼Ÿ</h3>
<p>è¿™ä¸€ç‚¹å…¶å®éå¸¸å…³é”®ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨æ•°æ®é›†ï¼Œè®©å¤§æ¨¡å‹å˜æˆ<strong>æ²é›ª</strong>çš„æ¨¡æ ·ï¼Œè¡¨é¢ä¸Šçœ‹æ˜¯è¦†ç›–æ‰ä»–çš„æ€æƒ³é’¢å°ï¼Œè®©ä»–çš„å‚æ•°åˆ†å¸ƒé€‚åº”æˆ‘ä»¬æ•°æ®é›†çš„åˆ†å¸ƒã€‚é‚£ä¹ˆæœ¬è´¨ä¸Šå‘¢ï¼Ÿæˆ‘ä»¬æ›´æ”¹äº†ä»–çš„æ€æƒ³é’¢å°ï¼Œä½†æ˜¯å¤§æ¨¡å‹æœ¬èº«çš„èƒ½åŠ›è¿˜æ˜¯æ²¡å˜ï¼Œæ‰€æœ‰çš„é€»è¾‘è¿˜æ˜¯åŸºäºå¤§æ¨¡å‹æœ¬èº«ã€‚æ‰€ä»¥ï¼Œä¸è¨€è€Œå–»ï¼Œæˆ‘ä»¬çš„æœ€ç»ˆä»»åŠ¡å…¶å®æ˜¯<strong>ç”Ÿæˆä»»åŠ¡</strong>ã€‚</p>
<h3 data-id="heading-6">å®šæŸå¤±å‡½æ•°</h3>
<p>æ—¢ç„¶å†³å®šäº†æ˜¯ç”Ÿæˆä»»åŠ¡ï¼ŒæŸå¤±å‡½æ•°å°±ç›´æ¥å¥—å…¬å¼å§ã€‚</p>
<p>é¦–å…ˆï¼ŒæŸå¤±å‡½æ•°çš„æ ¸å¿ƒç›®æ ‡å°±æ˜¯è®¡ç®—é¢„æµ‹å€¼<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span/></span></span></span></span></span></span></span></span>å’ŒçœŸå®å€¼<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span>ä¹‹é—´çš„å·®å¼‚ã€‚</p>
<p>ç›¸ä¿¡æœ‰åŸºç¡€çš„å·²ç»å¬è¯´è¿‡å…­ä¸ªå†…å®¹ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š</p>
<p>ä»å®é™…æ„ä¹‰ä¸Šè®²çš„<code>system</code>ã€<code>user</code>å’Œ<code>assistant</code>ï¼Œ</p>
<p>è¿˜æœ‰ä»å‘é‡è§’åº¦è®²çš„<code>input_ids</code>ã€<code>attention_mask</code>å’Œ<code>labels</code>ã€‚</p>
<p>å…¶ä¸­ï¼Œä»å®é™…æ„ä¹‰ä¸Šè®²ï¼Œ<code>system</code>ã€<code>user</code>æ˜¯ç”¨æˆ·ç»™å®šçš„è¾“å…¥ï¼Œè€Œ<code>assistant</code>åˆ™æ˜¯æ¨¡å‹æœŸæœ›è¾“å‡ºçš„å†…å®¹ã€‚</p>
<p>è€Œä»å‘é‡è§’åº¦è®²ï¼Œ<code>input_ids</code>åŒ…å«äº†æ•´ä¸ªæ–‡æœ¬ï¼ˆåŒ…æ‹¬<code>system</code>ã€<code>user</code>å’Œ<code>assistant</code>ï¼‰ï¼Œç»è¿‡åˆ†è¯å™¨<code>tokenizer</code>è½¬ä¸º<code>embedding</code>ä¹‹åï¼Œè¿™ä¸€æ•´æ®µ<code>input_ids</code>ä¹Ÿå°±å¯ä»¥ä»æ„ä¹‰ä¸Šæ‹†è§£ä¸º<code>input_tokens</code>å’Œ<code>response_tokens</code>ã€‚<code>attention_mask</code>è¿™å—åˆ™æœ‰ç‚¹å·¥ç¨‹ä¸Šçš„è®²ç©¶ã€‚<code>labels</code>ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦é¢å¯¹çš„<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span>ã€‚</p>
<p>æ‰€ä»¥ï¼Œæœ¬è´¨ä¸Šï¼Œæˆ‘ä»¬æ‰€éœ€è¦åšçš„å…¶å®å°±æ˜¯ä¸¤ä»¶äº‹ï¼š</p>
<ol>
<li>å°†<code>response_tokens</code>ä½œä¸º<code>labels</code>ç»™åˆ°æ¨¡å‹</li>
<li>å°†<code>input_ids</code>å…¨éƒ¨ç»™åˆ°æ¨¡å‹ï¼Œè®¡ç®—ä¸¤è€…çš„å·®å¼‚</li>
</ol>
<p>ç„¶åæ¨¡å‹å°±å¼€å§‹ä¿®æ”¹è‡ªå·±çš„å‚æ•°ï¼Œä»¥æ»¡è¶³æ²é›ªæ•°æ®é›†çš„è¦æ±‚ã€‚</p>
<p>ç­‰ç­‰ï¼Œé‚£<code>attention_mask</code>å‘¢ï¼Ÿ</p>
<p>åŸºç¡€æ›´ç‰¢ä¸€äº›çš„åº”è¯¥å›å¿†èµ·æ¥äº†ï¼Œåœ¨ä½¿ç”¨<code>GPU</code>è®¡ç®—çš„è¿‡ç¨‹ä¸­ï¼Œ<code>PageAttention</code>ä¼šè€ƒè™‘å°†ç¢ç‰‡åŒ–çš„æ˜¾å­˜å½’é›†èµ·æ¥ï¼Œ<code>FlashAttention</code>åˆ™å°½å¯èƒ½å°†æ•°æ®æŒ‰ä¸€æ‰¹è®¡ç®—ã€‚</p>
<p>ä½†æ˜¯æ•°æ®é›†ä¸­çš„å¥å­æ˜¯åƒå˜ä¸‡åŒ–çš„ï¼Œå¦‚æœç”¨æµ·é‡çš„ã€é•¿çŸ­ä¸ä¸€çš„æ•°æ®æ”¾è¿›å»è®¡ç®—ï¼Œæ˜¾å­˜ç¢ç‰‡ä¼šæ¿€å¢ï¼Œå¯¼è‡´<code>CUDA kernel</code>åœ¨é«˜å‹åŠ›ä¸‹è§¦å‘<code>AssertError</code>ï¼Œåœæ‰å†…æ ¸ï¼Œæ•´ä¸ªæœåŠ¡ä¹Ÿå°±å´©æºƒä¸­æ­¢äº†ã€‚</p>
<p>äºæ˜¯å‘¢ï¼Œå¥å­å°±éœ€è¦å¡«å……æˆä¸€ä¸ªç›¸å¯¹æ¥è¯´è§„åˆ™ä¸€äº›çš„çŸ©é˜µã€‚è€Œ<code>attention mask</code>å°±æ˜¯ä¸ºäº†è®©çŸ©é˜µä¸­çš„ä¸€éƒ¨åˆ†ä¸å‚ä¸è¿ç®—ï¼Œä¹Ÿå°±æ˜¯ç±»ä¼¼å›¾åƒå¤„ç†ä¸­çš„<code>mask</code>é®ç½©ï¼Œä»è€Œé¿å…æ— éœ€å­¦ä¹ çš„å†…å®¹è¢«å¤§æ¨¡å‹æ³¨æ„åˆ°äº†ã€‚æ¯•ç«Ÿï¼Œæˆ‘ä»¬çš„å¤§æ¨¡å‹æ˜¯éœ€è¦å‰å‘ç”Ÿæˆçš„ï¼Œè¿™ä¹Ÿå°±æ˜¯é¢è¯•å¸¸è€ƒçš„<strong>å› æœé®ç½©</strong>ã€‚</p>
<p>åˆ°äº†è¿™ä¸€æ­¥ï¼Œåé¢çš„é€»è¾‘ä¹Ÿå°±éå¸¸æ¸…æ™°äº†ã€‚</p>
<ol>
<li>ä½¿ç”¨å¤§æ¨¡å‹æœ¬èº«çš„åˆ†è¯å™¨å°†æ–‡æœ¬å‘é‡åŒ–ï¼Œè·å¾—<code>input_ids</code></li>
<li>æŒ‰ç…§<code>prompt</code>çš„é•¿åº¦è®¡ç®—<code>attention_mask</code>ï¼ˆéœ€è¦çš„èµ‹<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span>ï¼Œå¦åˆ™èµ‹<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">0</span></span></span></span></span>ï¼‰</li>
<li>æŒ‰ç…§<code>prompt</code>çš„é•¿åº¦è®¡ç®—<code>labels</code>ï¼ˆ<code>prompt</code>éƒ¨åˆ†èµ‹<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">-100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">âˆ’</span><span class="mord">100</span></span></span></span></span>ï¼Œå…¶ä½™ä¸åŠ¨ï¼‰</li>
<li>å°†<code>input_ids</code>å’Œ<code>attention_mask</code>ä¼ å…¥æ¨¡å‹ã€‚</li>
</ol>
<p>æœ€åï¼Œä½¿ç”¨éå¸¸å¸¸è§çš„äº¤å‰ç†µè®¡ç®—æŸå¤±å‡½æ•°å°±å¥½äº†ã€‚</p>
<p>ä¸ºä»€ä¹ˆæ˜¯äº¤å‰ç†µï¼Ÿ</p>
<p>è¿™å°±è¯´æ¥è¯é•¿äº†ã€‚</p>
<p>å› ä¸ºåœ¨ä¿¡æ¯è®ºä¸­ï¼Œä¿¡æ¯è¶ŠçŸ­ï¼Œè¯´æ˜ä¿¡æ¯é‡è¶Šå¤§ï¼Œä¿¡æ¯ä»·å€¼ä¹Ÿè¶Šé«˜ã€‚ä¿¡æ¯é‡å¯ä»¥è¿™ä¹ˆè¡¨ç¤ºï¼š</p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mo>âˆ’</mo><msub><mo>âˆ‘</mo><mrow><mi>x</mi><mo>âˆˆ</mo><mi>X</mi></mrow></msub><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>log</mi><mo>â¡</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(X) = - \sum_{x \in X} p(x) \log p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.0771em;vertical-align:-0.3271em;"/><span class="mord">âˆ’</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">âˆˆ</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3271em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></p>
<p>å…¶ä¸­ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>è¡¨ç¤ºå½“å‰ä¿¡æ¯çš„åˆ†å¸ƒï¼Œä¸»è¦ç”¨äºè¡¨ç¤ºå¤šåˆ†ç±»çš„åœºæ™¯ã€‚å½“åˆ†ç±»å¢å¤šçš„æ—¶å€™ï¼Œä¿¡æ¯é‡ä¼šé€æ¸å¢å¤§ï¼›ä½†æ˜¯åˆ†ç±»æ•°é‡è¾¾åˆ°ä¸€å®šå€¼åï¼Œä¿¡æ¯é‡åˆä¼šå¿«é€Ÿä¸‹é™ï¼Œè¿™ä¹Ÿæ˜¯<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mo>âˆ’</mo><mi>x</mi><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y=-x\log(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord">âˆ’</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>çš„è¶‹åŠ¿å†³å®šçš„ã€‚</p>
<p>è€Œ<code>KL</code>æ•£åº¦ï¼Œåˆ™å¯ä»¥è¿™ä¹ˆè¡¨ç¤ºï¼š</p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">(</mo><mi>P</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><mi>Q</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mo>âˆ‘</mo><mrow><mi>x</mi><mo>âˆˆ</mo><mi>X</mi></mrow></msub><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>log</mi><mo>â¡</mo><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">D_{KL}(P||Q) = \sum_{x \in X} p(x) \log \frac{p(x)}{q(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord">âˆ£âˆ£</span><span class="mord mathnormal">Q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"/><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">âˆˆ</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3271em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span></p>
<p><code>KL</code>æ•£åº¦å¯ä»¥è¿™ä¹ˆç†è§£ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span>å’Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span>ä¹‹é—´çš„è·ç¦»ï¼Œå…¶ä¸­<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span>å’Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span>éƒ½æ˜¯è¿‘ä¼¼æ­£æ€çš„åˆ†å¸ƒã€‚å½“<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span>å’Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span>è¶Šç›¸ä¼¼ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>K</mi><mi>L</mi></mrow></msub><mo stretchy="false">(</mo><mi>P</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><mi>Q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">D_{KL}(P||Q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord">âˆ£âˆ£</span><span class="mord mathnormal">Q</span><span class="mclose">)</span></span></span></span></span>è¶Šå°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘éœ€è¦ç”¨å½“å‰çš„å‚æ•°å»æ‹Ÿåˆæ–°çš„æ•°æ®é›†çš„æ—¶å€™ï¼Œæ•£åº¦å€¼è¶Šå°ï¼Œæ‹Ÿåˆå°±è¶Šå¥½ã€‚</p>
<p>è€Œäº¤å‰ç†µåˆ™æ˜¯ä¸¤è€…çš„åŠ æƒå’Œï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨ä¸»æµæ¡†æ¶ä¸­éƒ½èƒ½å¤Ÿçœ‹åˆ°çš„<code>CrossEntropy</code>ã€‚</p>
<h3 data-id="heading-7">ä¸Šä»£ç </h3>
<p>æ—¢ç„¶åŸºæœ¬éƒ½ç¡®å®šäº†ï¼Œé‚£æˆ‘ä»¬ä¹Ÿå°±ä¸å¤šè¯´äº†ã€‚ç›´æ¥ä¸Šã€‚</p>
<p>é¦–å…ˆï¼ŒåŠ è½½æ•°æ®é›†ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_data</span>(<span class="hljs-params">data_path: <span class="hljs-built_in">str</span></span>):
  results = []
  <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(data_path, <span class="hljs-string">"r"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> file:
    all_lines = file.readlines()
  total_lines = <span class="hljs-built_in">len</span>(all_lines)
  <span class="hljs-keyword">for</span> i, line <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(all_lines, start=<span class="hljs-number">1</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Loading data: <span class="hljs-subst">{i}</span>/<span class="hljs-subst">{total_lines}</span>"</span>, end=<span class="hljs-string">"\r"</span>)
    data = json.loads(line)
    messages = data.get(<span class="hljs-string">"messages"</span>, [])
    <span class="hljs-comment"># score = data.get("score", 0.0) # GRPOç”¨ï¼Œæœ¬æ¬¡SFTç”¨ä¸ä¸Š</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(messages) &gt;= <span class="hljs-number">3</span>:
      system_prompt = messages[<span class="hljs-number">0</span>].get(<span class="hljs-string">"content"</span>, <span class="hljs-string">""</span>)
      user_prompt   = messages[<span class="hljs-number">1</span>].get(<span class="hljs-string">"content"</span>, <span class="hljs-string">""</span>)
      ai_prompt     = messages[<span class="hljs-number">2</span>].get(<span class="hljs-string">"content"</span>, <span class="hljs-string">""</span>)
      results.append({
          <span class="hljs-string">"system"</span>: system_prompt,
          <span class="hljs-string">"user"</span>: user_prompt,
          <span class="hljs-string">"ai"</span>: ai_prompt,
          <span class="hljs-comment"># "score": score, # GRPOç”¨ï¼Œæœ¬æ¬¡SFTç”¨ä¸ä¸Š</span>
      })
  <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nData loaded"</span>)
  <span class="hljs-keyword">return</span> results
</code></pre>
<blockquote>
<p>P.S.ï¼šåœ¨æ²é›ªçš„æ•°æ®é›†åŸºç¡€ä¸Šï¼Œæˆ‘é¢å¤–åšäº†ä¸€ä¸ªæ­¥éª¤ï¼Œå°±æ˜¯åœ¨æ¯ä¸€ä¸ª<code>json</code>åé¢å¢åŠ äº†ä¸€ä¸ª<code>score</code>å­—æ®µï¼Œä¹Ÿå°±æ˜¯è®©éšæœºæ•°éšæœºç”Ÿæˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn></mrow><annotation encoding="application/x-tex">8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">8</span></span></span></span></span>ã€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8.5</mn></mrow><annotation encoding="application/x-tex">8.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">8.5</span></span></span></span></span>ã€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>9</mn></mrow><annotation encoding="application/x-tex">9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">9</span></span></span></span></span>ã€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>9.5</mn></mrow><annotation encoding="application/x-tex">9.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">9.5</span></span></span></span></span>ã€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">10</span></span></span></span></span>è¿™äº”ä¸ªæ•°å­—ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´åé¢çš„<code>GRPO</code>ã€‚è‡³äºä¸ºä»€ä¹ˆæ˜¯éšæœºæ•°ï¼Œå› ä¸ºæˆ‘ç›¸ä¿¡åŸä½œè€…ï¼ˆå‰è…°ï¼‰ï¼Œ<del>è¿™æ˜¯æˆ‘ä»¬çš„ç¾ç»Šå•Š</del>æ‰€ä»¥å°±å¹²è„†éšæœºç”Ÿæˆæ¯”è¾ƒé«˜çš„åˆ†æ•°äº†ã€‚</p>
</blockquote>
<p>ç„¶åå°±æ˜¯ï¼ŒåŸæ•°æ®é›†ä¸­å­˜åœ¨å¤šè½®å¯¹è¯çš„æƒ…å†µï¼Œè¿™é‡Œæ²¡æƒ³é‚£ä¹ˆå¤šï¼Œå¹²è„†å°±æ”¾å¼ƒäº†ï¼Œåªè€ƒè™‘å•è½®å¯¹è¯ï¼Œå–äº†å‰ä¸‰ä¸ªï¼Œåˆ†åˆ«æ˜¯<code>system</code>ã€<code>user</code>å’Œ<code>assistant</code>ã€‚</p>
<p>äºæ˜¯å°±è¿™ä¹ˆç®€å•ç²—æš´çš„å¼€å§‹åŠ è½½ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">QwenDataSet</span>(torch.utils.data.Dataset):
  <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, data, tokenizer, max_len=<span class="hljs-number">4096</span></span>):
    self.data = data
    self.tokenizer = tokenizer
    self.max_len = max_len

  <span class="hljs-keyword">def</span> <span class="hljs-title function_">__len__</span>(<span class="hljs-params">self</span>):
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(self.data)

  <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getitem__</span>(<span class="hljs-params">self, idx</span>):
    item = self.data[idx]
    system = item.get(<span class="hljs-string">"system"</span>, <span class="hljs-string">""</span>)
    user   = item.get(<span class="hljs-string">"user"</span>, <span class="hljs-string">""</span>)
    ai     = item.get(<span class="hljs-string">"ai"</span>, <span class="hljs-string">""</span>)
    <span class="hljs-comment"># score  = item.get("score", 0.0) # GRPOç”¨ï¼Œæœ¬æ¬¡SFTç”¨ä¸ä¸Š</span>
    <span class="hljs-comment"># æŒ‰ç…§è§„çŸ©æ‹†åˆ†ç”¨æˆ·è¾“å…¥ä¸æ¨¡å‹è¾“å‡ºï¼Œç„¶åæ‹¼æ¥</span>
    prompt = <span class="hljs-string">f"""&lt;|im_start|&gt;system\n<span class="hljs-subst">{system}</span>&lt;|im_end|&gt;\n&lt;|im_start|&gt;user\n<span class="hljs-subst">{user}</span>&lt;|im_end|&gt;\n&lt;|im_start|&gt;assistant:\n"""</span>
    response = ai
    <span class="hljs-comment"># å…ˆç”¨åˆ†è¯å™¨è½¬å‘é‡</span>
    prompt_ids   = self.tokenizer(prompt,   add_special_tokens=<span class="hljs-literal">False</span>)[<span class="hljs-string">"input_ids"</span>]
    response_ids = self.tokenizer(response, add_special_tokens=<span class="hljs-literal">False</span>)[<span class="hljs-string">"input_ids"</span>]
    <span class="hljs-comment"># è¾“å…¥æ¨¡å‹çš„éœ€è¦æ˜¯å…¨éƒ¨çš„å‘é‡</span>
    input_ids = prompt_ids + response_ids
    <span class="hljs-comment"># åšä¸€ä¸ªæˆªæ–­</span>
    <span class="hljs-comment"># =========================================================</span>
    <span class="hljs-comment"># æ³¨æ„ï¼Œè¿™é‡Œå¦‚æœåŠ äº†æˆªæ–­ï¼Œå°±éœ€è¦æ³¨æ„æ•°æ®é›†çš„é•¿åº¦</span>
    <span class="hljs-comment"># å¦‚æœå­˜åœ¨&lt;think&gt;æ ‡ç­¾ï¼Œåˆ™å¾ˆæœ‰å¯èƒ½æˆªæ–­é•¿åº¦ä¸è¶³ï¼Œæ²¡ä¿ç•™çœŸæ­£çš„è¾“å‡º</span>
    <span class="hljs-comment"># =========================================================</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(input_ids) &gt; self.max_len:
      input_ids = input_ids[:self.max_len]
    <span class="hljs-comment"># å› æœé®ç½©ï¼Œä¸éœ€è¦çš„ç›–ä½</span>
    attention_mask = [<span class="hljs-number">1</span>] * <span class="hljs-built_in">len</span>(input_ids)
    prompt_len = <span class="hljs-built_in">min</span>(<span class="hljs-built_in">len</span>(prompt_ids), self.max_len)
    <span class="hljs-comment"># åˆ›å»ºå¡«å……å†…å®¹</span>
    pad_id = self.tokenizer.pad_token_id <span class="hljs-keyword">if</span> self.tokenizer.pad_token_id <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> self.tokenizer.eos_token_id
    <span class="hljs-comment"># å¦‚æœé•¿åº¦ä¸å¤Ÿï¼Œå°±å…ˆå¡«å……</span>
    pad_len = self.max_len - <span class="hljs-built_in">len</span>(input_ids)
    <span class="hljs-keyword">if</span> pad_len &gt; <span class="hljs-number">0</span>:
      input_ids     = input_ids + [pad_id] * pad_len
      attention_mask = attention_mask + [<span class="hljs-number">0</span>] * pad_len
    <span class="hljs-comment"># æ ‡ç­¾å°±æ˜¯æ•´æ®µæ–‡æœ¬ï¼Œç„¶åéAIç”Ÿæˆçš„éƒ¨åˆ†å…¨éƒ¨ç›–ä½ï¼Œä¸å‚ä¸è¿ç®—</span>
    labels = input_ids.copy()
    labels[:prompt_len] = [-<span class="hljs-number">100</span>] * prompt_len
    <span class="hljs-comment"># è¿”å›</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-string">"input_ids"</span>:      torch.tensor(input_ids,      dtype=torch.long),
      <span class="hljs-string">"attention_mask"</span>: torch.tensor(attention_mask, dtype=torch.long),
      <span class="hljs-string">"labels"</span>:         torch.tensor(labels,         dtype=torch.long),
      <span class="hljs-string">"score"</span>:          torch.tensor(score,          dtype=torch.<span class="hljs-built_in">float</span>),
    }
</code></pre>
<p>åˆ°è¿™ä¸€æ­¥ï¼Œå°±å·²ç»å˜æˆ<code>torch</code>å¯ä»¥é€‚é…çš„åŠ è½½å™¨äº†ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æŠŠå®ƒå®ä¾‹åŒ–ä¸€ä¸‹ï¼Œç„¶åå†å¤„ç†æˆ<code>batch</code>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åŠ è½½æ•°æ®</span>
data = load_data(DATA_PATH)
dataset = QwenDataSet(data, tokenizer, max_len=<span class="hljs-number">1024</span>)

<span class="hljs-comment"># æŒ‰ç…§8:2åˆ’åˆ†è®­ç»ƒï¼éªŒè¯ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥ç”¨æ²é›ªæ•°æ®é›†é¢„ç½®çš„test.jsonl</span>
<span class="hljs-comment"># æˆ‘è¿™è¾¹å›¾æ–¹ä¾¿ç›´æ¥æŠŠæ‰€æœ‰çš„jsonlåˆå¹¶äº†ï¼ˆæ¬¸å˜¿~â­ï¼‰</span>
val_size = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">len</span>(dataset) * <span class="hljs-number">0.2</span>)
train_size = <span class="hljs-built_in">len</span>(dataset) - val_size
train_dataset, val_dataset = torch.utils.data.random_split(dataset, [train_size, val_size])
<span class="hljs-comment"># å®šä¹‰ data collatorè½¬batch</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">data_collator</span>(<span class="hljs-params">features</span>):
  batch = {
    <span class="hljs-string">"input_ids"</span>:      torch.stack([f[<span class="hljs-string">"input_ids"</span>] <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> features]),
    <span class="hljs-string">"attention_mask"</span>: torch.stack([f[<span class="hljs-string">"attention_mask"</span>] <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> features]),
    <span class="hljs-string">"labels"</span>:         torch.stack([f[<span class="hljs-string">"labels"</span>] <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> features]),
  }
  <span class="hljs-keyword">return</span> batch
</code></pre>
<p>å‰©ä¸‹çš„å°±åªæœ‰åŠ è½½å¹¶å¯åŠ¨äº†ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è®­ç»ƒå‚æ•°</span>
training_args = TrainingArguments(
  output_dir            = save_dir,
  per_device_train_batch_size = <span class="hljs-number">8</span>,
  per_device_eval_batch_size  = <span class="hljs-number">8</span>,
  eval_steps            = <span class="hljs-number">100</span>,
  logging_steps         = <span class="hljs-number">100</span>,
  save_steps            = <span class="hljs-number">100</span>,
  save_total_limit      = <span class="hljs-number">3</span>,
  num_train_epochs      = <span class="hljs-number">10</span>,
  learning_rate         = <span class="hljs-number">1e-5</span>,
  gradient_accumulation_steps = <span class="hljs-number">8</span>,
  weight_decay          = <span class="hljs-number">1e-2</span>,
  report_to             = <span class="hljs-string">"none"</span>,
)

<span class="hljs-comment"># Trainer åˆå§‹åŒ–</span>
trainer = Trainer(
  model         = model,          <span class="hljs-comment"># ä½ ä¸‹è½½åˆ°æœ¬åœ°çš„æ¨¡å‹è·¯å¾„</span>
  args          = training_args,  <span class="hljs-comment"># ä¸Šè¿°å‚æ•°</span>
  train_dataset = train_dataset,  <span class="hljs-comment"># ä¸Šè¿°æ•°æ®é›†</span>
  eval_dataset  = val_dataset,    <span class="hljs-comment"># ä¸Šè¿°æ•°æ®é›†</span>
  data_collator = data_collator,  <span class="hljs-comment"># ä¸Šè¿°æ•°æ®è½¬batch</span>
  tokenizer     = tokenizer,      <span class="hljs-comment"># åŸºäºæœ¬åœ°æ¨¡å‹è·¯å¾„çš„åˆ†è¯å™¨</span>
)

<span class="hljs-comment"># å¼€å§‹è®­ç»ƒ</span>
trainer.train()
<span class="hljs-comment"># ä¿å­˜æ¨¡å‹ &amp; tokenizer</span>
trainer.save_model(save_dir)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Training complete. Model saved to:"</span>, save_dir)
</code></pre>
<p>å®Œæ•´ä»£ç ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> json
os.environ[<span class="hljs-string">"CUDA_VISIBLE_DEVICES"</span>] = <span class="hljs-string">"0,1,2,3,4,5"</span>
<span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModelForCausalLM, AutoTokenizer, TrainingArguments, Trainer

<span class="hljs-comment"># è·¯å¾„é…ç½®</span>
<span class="hljs-comment"># ä½ éœ€è¦é’ˆå¯¹ä½ æœ¬åœ°çš„æƒ…å†µä¿®æ”¹ä¸‹é¢4ä¸ªæ•°æ®ï¼š</span>
<span class="hljs-comment">## 1. æ•°æ®é›†è·¯å¾„</span>
DATA_PATH = <span class="hljs-string">"xxx"</span>
<span class="hljs-comment">## 2. æ¨¡å‹è·¯å¾„</span>
MODEL_PATH = <span class="hljs-string">"xxx"</span>
<span class="hljs-comment">## 3. è®­ç»ƒå®Œä¹‹åçš„æ¨¡å‹æƒé‡ä¿å­˜è·¯å¾„</span>
OUT_PATH = <span class="hljs-string">"xxx"</span>
<span class="hljs-comment">## 4. è¿™æ˜¯ä½ ç¬¬å‡ æ¬¡è®­ç»ƒ</span>
<span class="hljs-comment">## å¦‚æœä½ å¿˜äº†ä¿®æ”¹è¿™ä¸ªï¼Œé‚£ä¹ˆä¸‹æ¬¡è®­ç»ƒå°±ä¼šè¦†ç›–æ‰ä¹‹å‰è®­ç»ƒçš„æƒé‡</span>
<span class="hljs-comment">## å¦‚æœä½ å°±æ˜¯å¸Œæœ›è¦†ç›–ï¼Œé‚£å°±ä¸€ç›´ä¿æŒå°±å¥½</span>
VERSION = <span class="hljs-number">1</span>

<span class="hljs-comment"># æŒ‡å®šæƒ³å†»ç»“çš„æ¨¡å—åå­—ï¼å…³é”®å­—</span>
<span class="hljs-comment"># ["transformer.h.0", "transformer.h.1"] æˆ– ["embed_tokens"]</span>
FREEZE_MODULE_KEYWORDS = []

<span class="hljs-comment"># åŠ è½½åŸºç¡€æ¨¡å‹å’Œ tokenizer</span>
tokenizer = AutoTokenizer.from_pretrained(MODEL_PATH, use_fast=<span class="hljs-literal">False</span>)
tokenizer.pad_token = tokenizer.eos_token
<span class="hljs-comment"># æˆ‘è¿™é‡Œæ˜¯å¤šå¡ï¼Œæ‰€ä»¥`device_map`é€‰`auto`æˆ–è€…`balanced`</span>
<span class="hljs-comment"># å¦å¤–åƒé—®å¤§æ¨¡å‹ä¸€å®šå¾—åŠ ä¸€ä¸ª`trust_remote_code`</span>
model = AutoModelForCausalLM.from_pretrained(MODEL_PATH, trust_remote_code = <span class="hljs-literal">True</span>, torch_dtype=torch.bfloat16, device_map=<span class="hljs-string">"auto"</span>)

<span class="hljs-comment"># å¤„ç†å†»ç»“é€»è¾‘</span>
<span class="hljs-keyword">if</span> FREEZE_MODULE_KEYWORDS:
    <span class="hljs-keyword">for</span> name, param <span class="hljs-keyword">in</span> model.named_parameters():
        <span class="hljs-comment"># å¦‚æœæ¨¡å—åç§°ä¸­åŒ…å«ä»»ä¸€å…³é”®è¯ï¼Œå°±å†»ç»“</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">any</span>(key <span class="hljs-keyword">in</span> name <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> FREEZE_MODULE_KEYWORDS):
            param.requires_grad = <span class="hljs-literal">False</span>
        <span class="hljs-keyword">else</span>:
            param.requires_grad = <span class="hljs-literal">True</span>
    <span class="hljs-comment"># æ‰“å°å†»ç»“ï¼æœªå†»ç»“çš„å‚æ•°æ•°é‡</span>
    total = <span class="hljs-built_in">sum</span>(p.numel() <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> model.parameters())
    trainable = <span class="hljs-built_in">sum</span>(p.numel() <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> model.parameters() <span class="hljs-keyword">if</span> p.requires_grad)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Total parameters: <span class="hljs-subst">{total:,}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Trainable parameters after freeze: <span class="hljs-subst">{trainable:,}</span> (<span class="hljs-subst">{trainable/total:<span class="hljs-number">.2</span>%}</span>)"</span>)
<span class="hljs-keyword">else</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"No layer freezing selected â€” training all parameters."</span>)

<span class="hljs-comment"># ç”Ÿæˆä¿å­˜è·¯å¾„</span>
<span class="hljs-comment">## ä¿å­˜è·¯å¾„å¸¦æœ‰æ—¥æœŸï¼Œåˆ«æ‰¾é”™å•¦ï¼</span>
save_dir = <span class="hljs-string">f"<span class="hljs-subst">{OUT_PATH}</span>/<span class="hljs-subst">{datetime.today().strftime(<span class="hljs-string">'%Y%m%d'</span>)}</span>-v<span class="hljs-subst">{VERSION}</span>"</span>
<span class="hljs-comment">## è¿™é‡Œå°±å·²ç»å›ºå®šä½äº†</span>
<span class="hljs-comment">## å¦‚æœä½ æ˜¨å¤©å¼€å§‹ï¼Œä»Šå¤©ç»“æŸï¼Œæ—¥æœŸè¿˜æ˜¯æ˜¨å¤©å¼€å§‹çš„æ—¥æœŸ</span>
os.makedirs(save_dir, exist_ok=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># æ•°æ®åŠ è½½ + Dataset å®šä¹‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">load_data</span>(<span class="hljs-params">data_path: <span class="hljs-built_in">str</span></span>):
    results = []
    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(data_path, <span class="hljs-string">"r"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> file:
      all_lines = file.readlines()
    total_lines = <span class="hljs-built_in">len</span>(all_lines)
    <span class="hljs-keyword">for</span> i, line <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(all_lines, start=<span class="hljs-number">1</span>):
      <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Loading data: <span class="hljs-subst">{i}</span>/<span class="hljs-subst">{total_lines}</span>"</span>, end=<span class="hljs-string">"\r"</span>)
      data = json.loads(line)
      messages = data.get(<span class="hljs-string">"messages"</span>, [])
      score = data.get(<span class="hljs-string">"score"</span>, <span class="hljs-number">0.0</span>)
      <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(messages) &gt;= <span class="hljs-number">3</span>:
        system_prompt = messages[<span class="hljs-number">0</span>].get(<span class="hljs-string">"content"</span>, <span class="hljs-string">""</span>)
        user_prompt   = messages[<span class="hljs-number">1</span>].get(<span class="hljs-string">"content"</span>, <span class="hljs-string">""</span>)
        ai_prompt     = messages[<span class="hljs-number">2</span>].get(<span class="hljs-string">"content"</span>, <span class="hljs-string">""</span>)
        results.append({
            <span class="hljs-string">"system"</span>: system_prompt,
            <span class="hljs-string">"user"</span>: user_prompt,
            <span class="hljs-string">"ai"</span>: ai_prompt,
            <span class="hljs-string">"score"</span>: score,
        })
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nData loaded"</span>)
    <span class="hljs-keyword">return</span> results

<span class="hljs-keyword">class</span> <span class="hljs-title class_">QwenDataSet</span>(torch.utils.data.Dataset):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, data, tokenizer, max_len=<span class="hljs-number">4096</span></span>):
        self.data = data
        self.tokenizer = tokenizer
        self.max_len = max_len

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__len__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(self.data)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getitem__</span>(<span class="hljs-params">self, idx</span>):
        item = self.data[idx]
        system = item[<span class="hljs-string">"system"</span>]
        user   = item[<span class="hljs-string">"user"</span>]
        ai     = item[<span class="hljs-string">"ai"</span>]
        score  = item.get(<span class="hljs-string">"score"</span>, <span class="hljs-number">0.0</span>)

        prompt = <span class="hljs-string">f"""&lt;|im_start|&gt;system\n<span class="hljs-subst">{system}</span>&lt;|im_end|&gt;\n&lt;|im_start|&gt;user\n<span class="hljs-subst">{user}</span>&lt;|im_end|&gt;\n&lt;|im_start|&gt;assistant:\n"""</span>
        response = ai

        prompt_ids   = self.tokenizer(prompt,   add_special_tokens=<span class="hljs-literal">False</span>)[<span class="hljs-string">"input_ids"</span>]
        response_ids = self.tokenizer(response, add_special_tokens=<span class="hljs-literal">False</span>)[<span class="hljs-string">"input_ids"</span>]

        input_ids = prompt_ids + response_ids
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(input_ids) &gt; self.max_len:
            input_ids = input_ids[:self.max_len]
        attention_mask = [<span class="hljs-number">1</span>] * <span class="hljs-built_in">len</span>(input_ids)
        prompt_len = <span class="hljs-built_in">min</span>(<span class="hljs-built_in">len</span>(prompt_ids), self.max_len)

        pad_id = self.tokenizer.pad_token_id <span class="hljs-keyword">if</span> self.tokenizer.pad_token_id <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> self.tokenizer.eos_token_id
        pad_len = self.max_len - <span class="hljs-built_in">len</span>(input_ids)
        <span class="hljs-keyword">if</span> pad_len &gt; <span class="hljs-number">0</span>:
            input_ids     = input_ids + [pad_id] * pad_len
            attention_mask = attention_mask + [<span class="hljs-number">0</span>] * pad_len

        labels = input_ids.copy()
        labels[:prompt_len] = [-<span class="hljs-number">100</span>] * prompt_len

        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">"input_ids"</span>:      torch.tensor(input_ids,      dtype=torch.long),
            <span class="hljs-string">"attention_mask"</span>: torch.tensor(attention_mask, dtype=torch.long),
            <span class="hljs-string">"labels"</span>:         torch.tensor(labels,         dtype=torch.long),
            <span class="hljs-string">"score"</span>:          torch.tensor(score,          dtype=torch.<span class="hljs-built_in">float</span>),
        }

<span class="hljs-comment"># åŠ è½½æ•°æ®</span>
data = load_data(DATA_PATH)
dataset = QwenDataSet(data, tokenizer, max_len=<span class="hljs-number">1024</span>)

<span class="hljs-comment"># åˆ’åˆ†è®­ç»ƒï¼éªŒè¯</span>
val_size = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">len</span>(dataset) * <span class="hljs-number">5e-2</span>)
train_size = <span class="hljs-built_in">len</span>(dataset) - val_size
train_dataset, val_dataset = torch.utils.data.random_split(dataset, [train_size, val_size])

<span class="hljs-comment"># å®šä¹‰ data collator</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">data_collator</span>(<span class="hljs-params">features</span>):
    batch = {
        <span class="hljs-string">"input_ids"</span>:      torch.stack([f[<span class="hljs-string">"input_ids"</span>] <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> features]),
        <span class="hljs-string">"attention_mask"</span>: torch.stack([f[<span class="hljs-string">"attention_mask"</span>] <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> features]),
        <span class="hljs-string">"labels"</span>:         torch.stack([f[<span class="hljs-string">"labels"</span>] <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> features]),
    }
    <span class="hljs-keyword">return</span> batch

<span class="hljs-comment"># TrainingArguments</span>
training_args = TrainingArguments(
    output_dir            = save_dir,
    per_device_train_batch_size = <span class="hljs-number">8</span>,
    per_device_eval_batch_size  = <span class="hljs-number">8</span>,
    eval_steps            = <span class="hljs-number">100</span>,
    logging_steps         = <span class="hljs-number">100</span>,
    save_steps            = <span class="hljs-number">100</span>,
    save_total_limit      = <span class="hljs-number">3</span>,
    num_train_epochs      = <span class="hljs-number">10</span>,
    learning_rate         = <span class="hljs-number">1e-5</span>,
    gradient_accumulation_steps = <span class="hljs-number">8</span>,
    weight_decay          = <span class="hljs-number">1e-2</span>,
    report_to             = <span class="hljs-string">"none"</span>,
)

<span class="hljs-comment"># Trainer åˆå§‹åŒ–</span>
trainer = Trainer(
    model         = model,
    args          = training_args,
    train_dataset = train_dataset,
    eval_dataset  = val_dataset,
    data_collator = data_collator,
    tokenizer     = tokenizer,
)

<span class="hljs-comment"># å¼€å§‹è®­ç»ƒ</span>
trainer.train()
<span class="hljs-comment"># ä¿å­˜æ¨¡å‹ &amp; tokenizer</span>
trainer.save_model(save_dir)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Training complete. Model saved to:"</span>, save_dir)
</code></pre>
<h2 data-id="heading-8">æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-9">Qwenç³»åˆ—å¤§æ¨¡å‹çš„ç©¶æç‰¹æ€§</h3>
<p>Qwenç³»åˆ—å¤§æ¨¡å‹ï¼Œè®­ç»ƒçš„æ—¶å€™éƒ½æ²¡å•¥é—®é¢˜ï¼Œä½†æ˜¯æœ€åå¯¼å‡ºçš„æ—¶å€™å§‹ç»ˆä¼šåšæŒè‡ªå·±æ˜¯é˜¿é‡Œå·´å·´çš„åƒé—®ï¼Œä»æ¥éƒ½ä¸è¯´è‡ªå·±æ˜¯æ²é›ªã€‚</p>
<p>è¿™æ˜¯å› ä¸º<code>chat-template</code>ã€‚</p>
<p>å¦‚æœä½ ç›´æ¥æŒ‰ç…§ç³»ç»Ÿé»˜è®¤çš„<code>chat-template</code>ï¼Œé‚£ä¹ˆé˜¿é‡Œå·´å·´å°±ä¼šè‡ªå·±åŠ ä¸Šä¸€ä¸ªé»˜è®¤çš„<code>system</code>ã€‚åœ¨<code>Qwen2</code>çš„æ—¶å€™ä¼šæ˜¯<code>You are a helpful assistant.</code>ï¼Œåœ¨<code>Qwen3</code>çš„æ—¶å€™æ²¡æœ‰æ˜ç¡®å†™å‡ºæ¥ï¼Œä½†ä¹Ÿæ˜¯æœ‰é»˜è®¤çš„<code>system</code>ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœä½ ä¸ç¡®å®šæ˜¯ä¸æ˜¯ç»ƒå¥½äº†ï¼Œä½ å°±å…ˆè§‚å¯Ÿè¾“å‡ºçš„æ–‡æœ¬è¯­æ°”æ˜¯å¦ç¬¦åˆæ²é›ªçš„é‚£ç§è®¾å®šçš„è¯­æ°”ã€‚ä¸€èˆ¬çš„ï¼Œå¦‚æœæ²¡ç»ƒå¥½ï¼Œå¤§æ¨¡å‹æ˜¯æœ‰ç€éå¸¸æµ“é‡çš„â€œåƒé—®â€å‘³é“ã€‚ä½†ç”±äºæ²é›ªæ•°æ®é›†ä¸ªæ€§å¾ˆé²œæ˜ï¼Œåœ¨é—®åå­—çš„æ—¶å€™å°±èƒ½å¯Ÿè§‰åˆ°ï¼Œå¦‚æœç»ƒå¥½äº†æ˜¯å®Œå…¨æ²¡æœ‰â€œåƒé—®â€å‘³é“çš„ã€‚</p>
<p>å¦‚æœæ²¡æœ‰åƒé—®å‘³é“ï¼Œä½†å°±æ˜¯ä¸æ‰¿è®¤è‡ªå·±æ˜¯æ²é›ªï¼Œåšç§°è‡ªå·±æ˜¯åƒé—®ï¼Œé‚£å°±æ˜¯éœ€è¦<code>system-prompt</code>äº†ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™åœ¨<code>messages</code>é‡Œé¢åŠ ä¸€ä¸ª<code>{"role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªåä¸ºæ²é›ªçš„å¯çˆ±AIå¥³å­©å­"}</code>ï¼Œè¿™ä¸ªæ—¶å€™å°±å®Œç¾äº†ã€‚</p>
<p>å½“ç„¶ï¼Œè¿˜æœ‰ä¸€ç§åŠæ³•ï¼Œå°±æ˜¯ç›´æ¥ä¿®æ”¹<code>chat-template.jinja</code>ã€‚</p>
<p><code>Qwen2</code>ç›¸å¯¹æ¥è¯´æ˜æ˜¾ä¸€äº›ï¼Œ<code>Qwen3</code>ç”±äºåŠ äº†<code>tool_call</code>æœºåˆ¶ï¼Œæ•´ä¸ª<code>chat-template</code>çš„é€»è¾‘çœ‹èµ·æ¥å¤æ‚å¾ˆå¤šã€‚æ€»ä¹‹ï¼Œä½ å°±æŠŠä½ çš„<code>system-prompt</code>å’ŒåŸ<code>jinja</code>äº¤ç»™å¤§æ¨¡å‹å¤„ç†å°±å¥½äº†ã€‚</p>
<h3 data-id="heading-10">batchè¶Šå¤§è¶Šå¥½</h3>
<p>è¿™ä¸ªå…¶å®ä¸å±€é™äºå¤§æ¨¡å‹ï¼Œåœ¨å…¶ä»–æœºå™¨å­¦ä¹ é¢†åŸŸç›¸å…³éƒ½æ˜¯é€šç”¨çš„ã€‚</p>
<p>ä»¥è¿™ä¸ªç”Ÿæˆä»»åŠ¡ä¸ºä¾‹ï¼Œæ²é›ªçš„æ•°æ®é›†ä¸­æ•°æ®çš„åˆ†å¸ƒå˜åŒ–æ˜¯å¾ˆå¤§çš„ã€‚äºæ˜¯åœ¨åˆ©ç”¨æ¨¡å‹çš„<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>å»æ‹Ÿåˆæ•°æ®é›†çš„åˆ†å¸ƒ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>çš„æ—¶å€™ï¼Œbatchè¶Šå°ï¼Œåˆ†å¸ƒçš„éœ‡è¡å°±è¶Šå‰§çƒˆã€‚</p>
<p>å½“å­¦ä¹ ç‡å†ç¨å¾®åŠ å¤§ä¸€äº›çš„æ—¶å€™ï¼Œæ•´ä¸ªå­¦ä¹ æ›²çº¿çš„éœ‡è¡å°±éå¸¸è‰ºæœ¯äº†ã€‚</p>
<p>æ‰€ä»¥ï¼Œå¦‚æœä½ æœ‰æ¡ä»¶çš„è¯ï¼Œåˆ†å¸ƒè¿˜æ˜¯è¶Šå¤§è¶Šå¥½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Next.jsåŠ©ä½ 5åˆ†é’Ÿæ­å»ºAIèŠå¤©å®¤]]></title>    <link>https://juejin.cn/post/7578699866182320166</link>    <guid>https://juejin.cn/post/7578699866182320166</guid>    <pubDate>2025-12-01T15:38:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578699866182320166" data-draft-id="7578683148210454580" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Next.jsåŠ©ä½ 5åˆ†é’Ÿæ­å»ºAIèŠå¤©å®¤"/> <meta itemprop="keywords" content="React.js,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-01T15:38:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="redRain"/> <meta itemprop="url" content="https://juejin.cn/user/2656031173250215"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Next.jsåŠ©ä½ 5åˆ†é’Ÿæ­å»ºAIèŠå¤©å®¤
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2656031173250215/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    redRain
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-01T15:38:20.000Z" title="Mon Dec 01 2025 15:38:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ChatAIå±•ç¤º</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db7d0de7534a4cf7b5b1e0fac1e9b4e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcmVkUmFpbg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765208300&amp;x-signature=BgDbBjxNvPBOJ9NLMoGFAvAhfIg%3D" alt="demo.gif" loading="lazy"/></p>
<h3 data-id="heading-1">Next.jsæ˜¯ä»€ä¹ˆ</h3>
<p>Â Â Â Â æ˜¯ä»€ä¹ˆä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯å®ƒèƒ½å¹²ä»€ä¹ˆï¼</p>
<ul>
<li>åŒ…å«å‰åç«¯ï¼ˆè¿™ä¸æ˜¯å°±å…¨æ ˆå—ï¼Œå¬èµ·æ¥å¯æ€•ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œå°±ç®—æ˜¯å°ç™½ï¼Œåªè¦ä¼šCVå¤§æ³•å°±è¡Œï¼‰</li>
<li>æ€¥é€Ÿå¼€å‘ï¼ˆä¼šç‚¹å¼€å‘çš„åŒå­¦ï¼Œåœ¨æ•²ä»£ç æç¤ºåˆ°æ—¶è›®å¤šçš„ï¼Œç”¨ä¹ æƒ¯äº†ä¹‹åå¼€å‘æ•ˆç‡èµ·é£ï¼‰</li>
</ul>
<h3 data-id="heading-2">ä¸ºä»€ä¹ˆè¦é€‰next.jså¼€å‘AI</h3>
<p>Â Â Â Â å› ä¸ºåœ¨ä¼—å¤š Web æ¡†æ¶ä¸­ï¼ŒNext.js æ˜¯æœ€æ¥è¿‘ AI â€œåŸç”Ÿå‹å¥½â€çš„ã€‚</p>
<h3 data-id="heading-3">CVä¸‰éƒ¨æ›²</h3>
<h4 data-id="heading-4">1. å®‰è£…ç¯å¢ƒ</h4>
<ul>
<li>å®‰è£…nodejsç¯å¢ƒï¼Œç‰ˆæœ¬å»å®˜ç½‘ä¸Šå»å®‰è£…æœ€æ–°çš„ç¨³å®šç‰ˆæœ¬ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6e066f7d3181462394b32691da46c555~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcmVkUmFpbg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765208300&amp;x-signature=TM9D2XkHK6gQzW398%2BNzloajZLE%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>å®‰è£…nextjsè„šæ‰‹æ¶ï¼Œåˆ›å»ºæ–‡ä»¶å¤¹ï¼Œ<code>npx create-next-app@latest</code>ï¼Œé…ç½®å…¨éƒ¨é€‰æ‹©é»˜è®¤ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00ee598746384cbdb95ffb9155228699~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcmVkUmFpbg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765208300&amp;x-signature=k8fWy4nM6Wgu3KcPrE%2BsO506L4c%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>å»DeepSeekä¹°APIæˆ–è€…OpenAIä¹°APIé¢åº¦ï¼Œä¸‹å›¾æ˜¯DeepSeekï¼Œæ”¯æŒä¸‹å›½äº§ã€‚åˆ›å»ºä¸€ä¸ªAPI keysï¼Œè®°å¾—ä¿å­˜keyï¼Œå› ä¸ºåªèƒ½åˆ›å»ºçš„æ—¶å€™å¤åˆ¶Keyã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b3c92e308a942e989b4928f83bb8087~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcmVkUmFpbg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765208300&amp;x-signature=0yq64gMUlSMnHhiGUClIHMSECeo%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-5">2. åˆ›å»ºæ–‡ä»¶ï¼Œå¤åˆ¶ä»£ç </h4>
<ul>
<li>åœ¨<code>app</code>ç›®å½•ä¸‹åˆ›å»º<code>api</code>æ–‡ä»¶å¤¹ï¼Œåœ¨<code>api</code>ç›®å½•ä¸‹åˆ›å»º<code>chat</code>ç›®å½•ï¼Œåœ¨<code>chat</code>ç›®å½•åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ï¼Œ<code>key.ts</code>å’Œ<code>route.ts</code></li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/362803e3fed4403691c5c3df7f769c0a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcmVkUmFpbg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765208300&amp;x-signature=a3vbsIzCteMhfqLAMagH5C9ZHkY%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><code>key.ts</code></li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æ›¿æ¢ä¸ºä½ åœ¨DeepSeekç”³è¯·çš„key</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEEPSEEK_API_KEY</span> = <span class="hljs-string">"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"</span>;
</code></pre>
<ul>
<li><code>route.ts</code></li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">NextRequest</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"next/server"</span>;
<span class="hljs-keyword">import</span> { streamText,convertToModelMessages } <span class="hljs-keyword">from</span> <span class="hljs-string">'ai'</span>
<span class="hljs-keyword">import</span> { createDeepSeek } <span class="hljs-keyword">from</span> <span class="hljs-string">"@ai-sdk/deepseek"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-variable constant_">DEEPSEEK_API_KEY</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"./key"</span>
<span class="hljs-keyword">const</span> deepSeek = <span class="hljs-title function_">createDeepSeek</span>({
    <span class="hljs-attr">apiKey</span>: <span class="hljs-variable constant_">DEEPSEEK_API_KEY</span>, <span class="hljs-comment">//è®¾ç½®APIå¯†é’¥</span>
});
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">POST</span>(<span class="hljs-params">req: NextRequest</span>) {
    <span class="hljs-keyword">const</span> { messages } = <span class="hljs-keyword">await</span> req.<span class="hljs-title function_">json</span>(); <span class="hljs-comment">//è·å–è¯·æ±‚ä½“</span>
    <span class="hljs-comment">//è¿™é‡Œä¸ºä»€ä¹ˆæ¥å—messages å› ä¸ºæˆ‘ä»¬ä½¿ç”¨å‰ç«¯çš„useChat ä»–ä¼šè‡ªåŠ¨æ³¨å…¥è¿™ä¸ªå‚æ•°ï¼Œæ‰€æœ‰å¯ä»¥ç›´æ¥è¯»å–</span>
    <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">streamText</span>({
        <span class="hljs-attr">model</span>: <span class="hljs-title function_">deepSeek</span>(<span class="hljs-string">'deepseek-chat'</span>), <span class="hljs-comment">//ä½¿ç”¨deepseek-chatæ¨¡å‹</span>
        <span class="hljs-attr">messages</span>:<span class="hljs-title function_">convertToModelMessages</span>(messages), <span class="hljs-comment">//è½¬æ¢ä¸ºæ¨¡å‹æ¶ˆæ¯</span>
        <span class="hljs-comment">//å‰ç«¯ä¼ è¿‡æ¥çš„é¢messagesä¸ç¬¦åˆsdkæ ¼å¼æ‰€ä»¥éœ€è¦convertToModelMessagesè½¬æ¢ä¸€ä¸‹</span>
        <span class="hljs-comment">//è½¬æ¢ä¹‹åçš„æ ¼å¼ï¼š</span>
        <span class="hljs-attr">system</span>: <span class="hljs-string">'æ–°æ‰‹å°ç™½'</span>, <span class="hljs-comment">//ç³»ç»Ÿæç¤ºè¯</span>
    });
   
    <span class="hljs-keyword">return</span> result.<span class="hljs-title function_">toUIMessageStreamResponse</span>() <span class="hljs-comment">//è¿”å›æµå¼å“åº”</span>
}
</code></pre>
<ul>
<li><code>page.tsx</code></li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-string">'use client'</span>;
<span class="hljs-keyword">import</span> { useState, useRef, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/components/ui/button'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Textarea</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/components/ui/textarea'</span>;
<span class="hljs-keyword">import</span> { useChat } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ai-sdk/react'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">HomePage</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> [input, setInput] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>); <span class="hljs-comment">//è¾“å…¥æ¡†çš„å€¼</span>
    <span class="hljs-keyword">const</span> messagesEndRef = useRef&lt;<span class="hljs-title class_">HTMLDivElement</span>&gt;(<span class="hljs-literal">null</span>); <span class="hljs-comment">//è·å–æ¶ˆæ¯ç»“æŸçš„ref</span>
    <span class="hljs-comment">//useChat å†…éƒ¨å°è£…äº†æµå¼å“åº” é»˜è®¤ä¼šå‘/api/chat å‘é€è¯·æ±‚</span>
    <span class="hljs-keyword">const</span> { messages, sendMessage } = <span class="hljs-title function_">useChat</span>({
        <span class="hljs-attr">onFinish</span>: <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-title function_">setInput</span>(<span class="hljs-string">''</span>);
        }
    });
    <span class="hljs-comment">// è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨</span>
    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
        messagesEndRef.<span class="hljs-property">current</span>?.<span class="hljs-title function_">scrollIntoView</span>({ <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span> });
    }, [messages]);
    <span class="hljs-comment">//å›è½¦å‘é€æ¶ˆæ¯</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleKeyDown</span> = (<span class="hljs-params">e: React.KeyboardEvent&lt;HTMLTextAreaElement&gt;</span>) =&gt; {
        <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'Enter'</span> &amp;&amp; !e.<span class="hljs-property">shiftKey</span>) {
            e.<span class="hljs-title function_">preventDefault</span>();
            <span class="hljs-keyword">if</span> (input.<span class="hljs-title function_">trim</span>()) {
                <span class="hljs-title function_">sendMessage</span>({ <span class="hljs-attr">text</span>: input });
            }
        }
    };

    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'flex flex-col h-screen bg-linear-to-br from-blue-50 via-white to-purple-50'</span>&gt;</span>
            {/* å¤´éƒ¨æ ‡é¢˜ */}
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'bg-white/80 backdrop-blur-sm shadow-sm border-b border-gray-200'</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'max-w-4xl mx-auto px-6 py-4'</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'text-2xl font-bold bg-linear-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent'</span>&gt;</span>
                        AI æ™ºèƒ½åŠ©æ‰‹
                    <span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'text-sm text-gray-500 mt-1'</span>&gt;</span>éšæ—¶ä¸ºæ‚¨è§£ç­”é—®é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

            {/* æ¶ˆæ¯åŒºåŸŸ */}
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'flex-1 overflow-y-auto px-4 py-6'</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'max-w-4xl mx-auto space-y-4'</span>&gt;</span>
                    {messages.length === 0 ? (
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'flex flex-col items-center justify-center h-full text-center py-20'</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'bg-linear-to-br from-blue-100 to-purple-100 rounded-full p-6 mb-4'</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'w-12 h-12 text-blue-600'</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">'none'</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">'currentColor'</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">'0 0 24 24'</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">strokeLinecap</span>=<span class="hljs-string">'round'</span> <span class="hljs-attr">strokeLinejoin</span>=<span class="hljs-string">'round'</span> <span class="hljs-attr">strokeWidth</span>=<span class="hljs-string">{2}</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z'</span> /&gt;</span>
                                <span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'text-xl font-semibold text-gray-700 mb-2'</span>&gt;</span>å¼€å§‹å¯¹è¯<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'text-gray-500'</span>&gt;</span>è¾“å…¥æ‚¨çš„é—®é¢˜ï¼Œæˆ‘ä¼šå°½åŠ›å¸®åŠ©æ‚¨<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    ) : (
                        messages.map((message) =&gt; (
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
                                <span class="hljs-attr">key</span>=<span class="hljs-string">{message.id}</span>
                                <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">flex</span> ${<span class="hljs-attr">message.role</span> === <span class="hljs-string">'user'</span> ? '<span class="hljs-attr">justify-end</span>' <span class="hljs-attr">:</span> '<span class="hljs-attr">justify-start</span>'} <span class="hljs-attr">animate-in</span> <span class="hljs-attr">fade-in</span> <span class="hljs-attr">slide-in-from-bottom-4</span> <span class="hljs-attr">duration-500</span>`}
                            &gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">flex</span> <span class="hljs-attr">gap-3</span> <span class="hljs-attr">max-w-</span>[<span class="hljs-attr">80</span>%] ${<span class="hljs-attr">message.role</span> === <span class="hljs-string">'user'</span> ? '<span class="hljs-attr">flex-row-reverse</span>' <span class="hljs-attr">:</span> '<span class="hljs-attr">flex-row</span>'}`}&gt;</span>
                                    {/* å¤´åƒ */}
                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">shrink-0</span> <span class="hljs-attr">w-8</span> <span class="hljs-attr">h-8</span> <span class="hljs-attr">rounded-full</span> <span class="hljs-attr">flex</span> <span class="hljs-attr">items-center</span> <span class="hljs-attr">justify-center</span> <span class="hljs-attr">text-white</span> <span class="hljs-attr">font-semibold</span> ${
                                        <span class="hljs-attr">message.role</span> === <span class="hljs-string">'user'</span> 
                                            ? '<span class="hljs-attr">bg-linear-to-br</span> <span class="hljs-attr">from-blue-500</span> <span class="hljs-attr">to-blue-600</span>' 
                                            <span class="hljs-attr">:</span> '<span class="hljs-attr">bg-linear-to-br</span> <span class="hljs-attr">from-purple-500</span> <span class="hljs-attr">to-purple-600</span>'
                                    }`}&gt;</span>
                                        {message.role === 'user' ? 'ä½ ' : 'AI'}
                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                                    
                                    {/* æ¶ˆæ¯å†…å®¹ */}
                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">flex</span> <span class="hljs-attr">flex-col</span> ${<span class="hljs-attr">message.role</span> === <span class="hljs-string">'user'</span> ? '<span class="hljs-attr">items-end</span>' <span class="hljs-attr">:</span> '<span class="hljs-attr">items-start</span>'}`}&gt;</span>
                                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">rounded-2xl</span> <span class="hljs-attr">px-4</span> <span class="hljs-attr">py-3</span> <span class="hljs-attr">shadow-sm</span> ${
                                            <span class="hljs-attr">message.role</span> === <span class="hljs-string">'user'</span>
                                                ? '<span class="hljs-attr">bg-linear-to-br</span> <span class="hljs-attr">from-blue-500</span> <span class="hljs-attr">to-blue-600</span> <span class="hljs-attr">text-white</span>'
                                                <span class="hljs-attr">:</span> '<span class="hljs-attr">bg-white</span> <span class="hljs-attr">border</span> <span class="hljs-attr">border-gray-200</span> <span class="hljs-attr">text-gray-800</span>'
                                        }`}&gt;</span>
                                            {message.parts.map((part, index) =&gt; {
                                                switch (part.type) {
                                                    case 'text':
                                                        return (
                                                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{message.id</span> + <span class="hljs-attr">index</span>} <span class="hljs-attr">className</span>=<span class="hljs-string">'whitespace-pre-wrap wrap-break-word'</span>&gt;</span>
                                                                {part.text}
                                                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                                                        );
                                                }
                                            })}
                                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        ))
                    )}
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{messagesEndRef}</span> /&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

            {/* è¾“å…¥åŒºåŸŸ */}
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'bg-white/80 backdrop-blur-sm border-t border-gray-200 shadow-lg'</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'max-w-4xl mx-auto px-4 py-4'</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'flex gap-3 items-end'</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'flex-1 relative'</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">Textarea</span>
                                <span class="hljs-attr">value</span>=<span class="hljs-string">{input}</span>
                                <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e:any)</span> =&gt;</span> setInput(e.target.value)}
                                onKeyDown={handleKeyDown}
                                placeholder='è¯·è¾“å…¥ä½ çš„é—®é¢˜... (æŒ‰ Enter å‘é€ï¼ŒShift + Enter æ¢è¡Œ)'
                                className='min-h-[60px] max-h-[200px] resize-none rounded-xl border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all shadow-sm'
                            /&gt;
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> {
                                if (input.trim()) {
                                    sendMessage({ text: input });
                                }
                            }}
                            disabled={!input.trim()}
                            className='h-[60px] px-6 rounded-xl bg-linear-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 transition-all shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed'
                        &gt;
                            <span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">className</span>=<span class="hljs-string">'w-5 h-5'</span> <span class="hljs-attr">fill</span>=<span class="hljs-string">'none'</span> <span class="hljs-attr">stroke</span>=<span class="hljs-string">'currentColor'</span> <span class="hljs-attr">viewBox</span>=<span class="hljs-string">'0 0 24 24'</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">path</span> <span class="hljs-attr">strokeLinecap</span>=<span class="hljs-string">'round'</span> <span class="hljs-attr">strokeLinejoin</span>=<span class="hljs-string">'round'</span> <span class="hljs-attr">strokeWidth</span>=<span class="hljs-string">{2}</span> <span class="hljs-attr">d</span>=<span class="hljs-string">'M12 19l9 2-9-18-9 18 9-2zm0 0v-8'</span> /&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
}
</code></pre>
<ul>
<li>å®‰è£…UIç»„ä»¶åº“ï¼Œä¼šç”Ÿæˆcomponents.jsonæ–‡ä»¶ å’Œ componentsæ–‡ä»¶å¤¹
<ul>
<li><code>npx shadcn@latest</code></li>
<li><code>npx shadcn@latest add button</code></li>
<li><code>npx shadcn@latest add textarea</code></li>
</ul>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b410f586aab47bf92ac862c3377b10e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcmVkUmFpbg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765208300&amp;x-signature=h5ebpurkOOI%2FQ0kEsZbGkc%2BOxq8%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-6">3. è¿è¡Œé¡¹ç›®</h4>
<p>Â Â Â Â åœ¨å½“å‰é¡¹ç›®è¿è¡Œ<code>npm run dev</code>ï¼Œç„¶åç”¨æµè§ˆå™¨å¼€æ‰“<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A3000%2F" target="_blank" title="http://localhost:3000/" ref="nofollow noopener noreferrer">http://localhost:3000/</a> ï¼Œå°±å¯ä»¥æ­£å¸¸æµ‹è¯•äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/919d6adaf31344488be5e9bfafbed64d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcmVkUmFpbg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765208300&amp;x-signature=JoGA9PULZ50cuHq6abJUMw3EJmY%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-7">æ€»ç»“</h3>
<p>Â Â Â Â æ­¤Demoå¯ä»¥å¿«é€ŸåµŒå¥—å¾ˆå¤šå°å‹é¡¹ç›®ï¼Œè­¬å¦‚å…¬å¸AIæ™ºèƒ½èŠå¤©è½¯ä»¶ç­‰ï¼Œå…¶æœ¬è´¨æ˜¯è°ƒç”¨å¤§æ¨¡å‹å‚å•†æä¾›çš„æ¨¡å‹ï¼Œå¯¹äºè¦æ±‚æ€§ä»·æ¯”é«˜ä¸”æ— ä¿å¯†æ€§è¦æ±‚çš„ä¸ªäººå’Œå…¬å¸å¾ˆå®ç”¨ã€‚å¦‚æœä½ æƒ³åšå‡ºæ›´é…·ç‚«çš„äº§å“ï¼Œå¯ä»¥è¿›ä¸€æ­¥äº†è§£<a href="https://link.juejin.cn?target=https%3A%2F%2Fnextjs.frontendx.cn%2F" target="_blank" title="https://nextjs.frontendx.cn/" ref="nofollow noopener noreferrer">nextjs</a>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92fe3fbfa1904aba944a4adf3b3d2298~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcmVkUmFpbg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765208300&amp;x-signature=FD%2F6wRQP0lW%2FBvTREVnUhUPfQ28%3D" alt="4b3492c25ce046f6a73e8d92a07e517a.gif" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€æŠ€æœ¯å®æˆ˜ã€‘Linux æœåŠ¡å™¨ç½‘ç»œæµé‡ç»Ÿä¸€é…ç½®ï¼ˆTUNæ¨¡å¼ï¼‰ï¼šè§£å†³ Docker/å¼€å‘ç¯å¢ƒè¿æ¥éš¾é¢˜]]></title>    <link>https://juejin.cn/post/7578705123208855595</link>    <guid>https://juejin.cn/post/7578705123208855595</guid>    <pubDate>2025-12-01T14:01:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578705123208855595" data-draft-id="7578700798744477730" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€æŠ€æœ¯å®æˆ˜ã€‘Linux æœåŠ¡å™¨ç½‘ç»œæµé‡ç»Ÿä¸€é…ç½®ï¼ˆTUNæ¨¡å¼ï¼‰ï¼šè§£å†³ Docker/å¼€å‘ç¯å¢ƒè¿æ¥éš¾é¢˜"/> <meta itemprop="keywords" content="Linux"/> <meta itemprop="datePublished" content="2025-12-01T14:01:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ´¥æ¸¡741"/> <meta itemprop="url" content="https://juejin.cn/user/811890236732839"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€æŠ€æœ¯å®æˆ˜ã€‘Linux æœåŠ¡å™¨ç½‘ç»œæµé‡ç»Ÿä¸€é…ç½®ï¼ˆTUNæ¨¡å¼ï¼‰ï¼šè§£å†³ Docker/å¼€å‘ç¯å¢ƒè¿æ¥éš¾é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/811890236732839/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ´¥æ¸¡741
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-01T14:01:59.000Z" title="Mon Dec 01 2025 14:01:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€ï¼šä¸ºä»€ä¹ˆè¦åœ¨æœåŠ¡å™¨ä¸Šæè¿™ä¸ªï¼Ÿ</h3>
<p>ä½ æ˜¯å¦é‡åˆ°è¿‡è¿™äº›æŠ€æœ¯ç—›ç‚¹ï¼š</p>
<ul>
<li><strong>Docker é•œåƒæ‹‰å–å›°éš¾ï¼š</strong> <code>docker pull</code> è¿‡ç¨‹å¡é¡¿æˆ–å¤±è´¥ï¼Œæ›´æ¢å›½å†…é•œåƒæºæ•ˆæœä¸ä½³ã€‚</li>
<li><strong>æµ·å¤–æŠ€æœ¯æœåŠ¡è°ƒç”¨å—é˜»ï¼š</strong> åœ¨æœåŠ¡å™¨ç”¨è¿œç¨‹å¼€å‘ç¯å¢ƒï¼ˆå¦‚ VS Code / Cursorï¼‰æ—¶ï¼Œæ™ºèƒ½ä»£ç è¾…åŠ©åŠŸèƒ½ï¼ˆå¦‚ Copilotï¼‰è¿æ¥ä¸ç¨³å®šï¼›Python è°ƒç”¨æŸäº›æµ·å¤–æŠ€æœ¯æœåŠ¡ API è¶…æ—¶ã€‚</li>
<li><strong>ç¯å¢ƒé…ç½®å†—ä½™ï¼š</strong> éœ€ä¸ºæ¯ä¸ªè½¯ä»¶ï¼ˆå¦‚ Git, Wget, Aptï¼‰å•ç‹¬é…ç½®ä»£ç†ï¼Œå·¥ä½œé‡å¤§ï¼Œä¸”éƒ¨åˆ†å·¥å…·ä¸æ”¯æŒæ ‡å‡†çš„ SOCKS5 åè®®ã€‚</li>
</ul>
<blockquote>
<p><strong>ç»ˆæè§£å†³æ–¹æ¡ˆï¼š</strong> åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½² Mihomo (Meta) æ ¸å¿ƒå¹¶å¼€å¯ <strong>TUN æ¨¡å¼ï¼ˆé€æ˜æµé‡æ¥ç®¡ï¼‰</strong>ã€‚å®ƒèƒ½æ¥ç®¡æœåŠ¡å™¨ç½‘å¡çš„æ‰€æœ‰æµé‡ï¼Œè®©æ‰€æœ‰è½¯ä»¶ï¼ˆåŒ…æ‹¬ Docker å’Œç³»ç»Ÿæ›´æ–°ï¼‰<strong>è‡ªåŠ¨ä½¿ç”¨ç»Ÿä¸€çš„ç½‘ç»œé…ç½®</strong>ï¼Œæ— éœ€å¯¹æ¯ä¸ªåº”ç”¨è¿›è¡Œé¢å¤–è®¾ç½®ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ç¬¬ä¸€æ­¥ï¼šç¯å¢ƒå‡†å¤‡</h3>
<ol>
<li>ä¸€å°å›½å†… Linux æœåŠ¡å™¨ï¼ˆUbuntu/Debian/CentOSï¼‰ã€‚</li>
<li>ä¸€ä»½ç¬¦åˆè¦æ±‚çš„ç½‘ç»œé…ç½®è®¢é˜…ï¼ˆéœ€è·å–åˆ°å…·ä½“çš„èŠ‚ç‚¹ä¿¡æ¯ï¼Œä»¥å…¼å®¹ Mihomo æ ¸å¿ƒï¼‰ã€‚</li>
<li>ä¸€é¢—è€å¿ƒï¼ˆè¿™å¾ˆé‡è¦ï¼‰ã€‚</li>
</ol>
<h3 data-id="heading-2">ç¬¬äºŒæ­¥ï¼šå®‰è£… Dockerï¼ˆå›½å†…ç‰¹ä¾›ç‰ˆï¼‰</h3>
<p>å®˜æ–¹è„šæœ¬åœ¨å›½å†…éƒ¨åˆ†ç½‘ç»œç¯å¢ƒä¸‹å¯èƒ½è¿æ¥å—é˜»ï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨å›½å†…é•œåƒå®‰è£…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ä¸‹è½½å®‰è£…è„šæœ¬</span>
curl -fsSL [https://get.docker.com](https://get.docker.com) -o install-docker.sh

<span class="hljs-comment"># 2. ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒè¿è¡Œ</span>
sudo sh install-docker.sh --mirror Aliyun

<span class="hljs-comment"># 3. å¯åŠ¨å¹¶è®¾ç½®è‡ªå¯</span>
sudo systemctl <span class="hljs-built_in">enable</span> --now docker
</code></pre>
<h3 data-id="heading-3">ç¬¬ä¸‰æ­¥ï¼šéƒ¨ç½² Mihomo (Meta æ ¸å¿ƒ)</h3>
<h4 data-id="heading-4">1. åˆ›å»ºç›®å½•</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> -p ~/mihomo
<span class="hljs-built_in">cd</span> ~/mihomo
</code></pre>
<h4 data-id="heading-5">2. ç¼–å†™ <code>docker-compose.yml</code></h4>
<p>ç›´æ¥å¤åˆ¶ä»¥ä¸‹å†…å®¹ã€‚æ³¨æ„ <code>network_mode: "host"</code> å’Œ <code>privileged: true</code> æ˜¯å¼€å¯ TUN æ¨¡å¼æ¥ç®¡æµé‡å¿…é¡»çš„é…ç½®ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3'</span>
<span class="hljs-attr">services:</span>
  <span class="hljs-attr">mihomo:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">metacubex/mihomo:latest</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">mihomo</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span>
    <span class="hljs-attr">network_mode:</span> <span class="hljs-string">"host"</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./config.yaml:/root/.config/mihomo/config.yaml</span>
    <span class="hljs-attr">cap_add:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">NET_ADMIN</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">SYS_MODULE</span>
    <span class="hljs-attr">privileged:</span> <span class="hljs-literal">true</span>
</code></pre>
<h4 data-id="heading-6">3. ç¼–å†™ <code>config.yaml</code> (æ ¸å¿ƒé…ç½®)</h4>
<blockquote>
<p><strong>âš ï¸ æ³¨æ„ï¼š</strong> è¿™æ˜¯æœ€å®¹æ˜“å‡ºé”™çš„åœ°æ–¹ï¼åœ¨ç²˜è´´èŠ‚ç‚¹é…ç½®å‰ï¼Œå»ºè®®å…ˆç”¨çº¯æ–‡æœ¬ç¼–è¾‘å™¨å¤„ç†èŠ‚ç‚¹åç§°ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ Emojiï¼‰ï¼Œé˜²æ­¢ä¹±ç å¯¼è‡´è§£æå¤±è´¥ã€‚<strong>å¿…é¡»</strong>å°†æœåŠ¡å™¨ SSH ç«¯å£ï¼ˆé»˜è®¤ä¸º 22ï¼‰è®¾ç½®ä¸ºç›´è¿è§„åˆ™ï¼Œå¦åˆ™æœåŠ¡å¯åŠ¨åå¯èƒ½å¯¼è‡´ SSH æ–­è¿ã€‚</p>
</blockquote>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">mixed-port:</span> <span class="hljs-number">7890</span>
<span class="hljs-attr">allow-lan:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">bind-address:</span> <span class="hljs-string">'*'</span>
<span class="hljs-attr">mode:</span> <span class="hljs-string">rule</span>
<span class="hljs-attr">log-level:</span> <span class="hljs-string">info</span>
<span class="hljs-attr">ipv6:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">tun:</span>
  <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">stack:</span> <span class="hljs-string">mixed</span>             <span class="hljs-comment"># å¼ºçƒˆå»ºè®®ä½¿ç”¨ mixedï¼Œå…¼å®¹æ€§æ¯” system å¥½</span>
  <span class="hljs-attr">auto-route:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">auto-detect-interface:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">dns-hijack:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">any:53</span>
<span class="hljs-attr">external-controller:</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><span class="hljs-string">:9090</span>
<span class="hljs-attr">secret:</span> <span class="hljs-string">"123456"</span>           <span class="hljs-comment"># è®¾ç½®ä½ çš„ç®¡ç†é¢æ¿å¯†ç </span>
<span class="hljs-attr">external-ui: uiexternal-ui-url:</span> [<span class="hljs-string">https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip</span>]<span class="hljs-string">(https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip)</span>
<span class="hljs-attr">dns:</span>
  <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">listen:</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><span class="hljs-string">:1053</span>
  <span class="hljs-attr">enhanced-mode:</span> <span class="hljs-string">fake-ip</span>   <span class="hljs-comment"># æ¨è fake-ipï¼Œæœ€ä¸å®¹æ˜“å‡ºæ­»å¾ªç¯</span>
  <span class="hljs-attr">fake-ip-range:</span> <span class="hljs-number">198.18</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">/16</span>
  <span class="hljs-attr">default-nameserver:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-number">223.5</span><span class="hljs-number">.5</span><span class="hljs-number">.5</span>
  <span class="hljs-attr">nameserver:</span>
    <span class="hljs-bullet">-</span> [<span class="hljs-string">https://dns.alidns.com/dns-query</span>]<span class="hljs-string">(https://dns.alidns.com/dns-query)</span>
    <span class="hljs-bullet">-</span> [<span class="hljs-string">https://doh.pub/dns-query</span>]<span class="hljs-string">(https://doh.pub/dns-query)</span>
<span class="hljs-attr">proxies:</span>
  <span class="hljs-comment"># åœ¨è¿™é‡Œå¡«å…¥ä½ çš„èŠ‚ç‚¹é…ç½® (å¦‚ V2/Shadow/Hyste ç­‰)</span>
  <span class="hljs-comment"># ...</span>
<span class="hljs-attr">proxy-groups:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">GlobalSelect</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">select</span>
    <span class="hljs-attr">proxies:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">ä½ çš„èŠ‚ç‚¹åå­—</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">DIRECT</span>
<span class="hljs-attr">rules:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">DST-PORT,22,DIRECT</span>     <span class="hljs-comment"># ã€æ•‘å‘½è§„åˆ™ã€‘å¿…é¡»æ”¾åœ¨ç¬¬ä¸€è¡Œï¼é˜²æ­¢SSHæ–­è¿</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">GEOSITE,cn,DIRECT</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">GEOIP,CN,DIRECT</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">MATCH,GlobalSelect</span>
</code></pre>
<hr/>
<h3 data-id="heading-7">è¸©å‘è®°å½• &amp; è§£å†³æ–¹æ¡ˆï¼ˆæœ¬æ–‡ç²¾åï¼‰</h3>
<p>æˆ‘ä»¬åœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°äº†æ— æ•°ä¸ªå‘ï¼Œä»¥ä¸‹æ˜¯è¡€æ³ªæ€»ç»“ï¼š</p>
<h3 data-id="heading-8">â˜ ï¸ å‘é›¶ï¼šå¯åŠ¨å³å¤±è”ï¼ˆæœ€è‡´å‘½ï¼‰</h3>
<p><strong>ç°è±¡</strong>ï¼š</p>
<ul>
<li>åˆšè¿è¡Œ <code>docker compose up -d</code>ï¼ŒSSH ç»ˆç«¯ç«‹åˆ»å¡æ­»ï¼ŒæœåŠ¡å™¨ç›´æ¥å¤±è”ã€‚</li>
<li>é‡å¯æœåŠ¡å™¨åèƒ½è¿ä¸Šï¼Œä½†åªè¦ä¸€å¯åŠ¨å®¹å™¨å°±åˆæ–­äº†ã€‚</li>
</ul>
<p><strong>åŸå› </strong>ï¼š</p>
<ul>
<li>å¼€å¯ TUN æ¨¡å¼ï¼ˆé€æ˜ä»£ç†ï¼‰åï¼ŒMihomo ä¼šæ¥ç®¡ç½‘å¡çš„æ‰€æœ‰æµé‡ï¼Œ<strong>åŒ…æ‹¬ä½ å½“å‰è¿æ¥æœåŠ¡å™¨çš„ SSH æµé‡ï¼ˆç«¯å£ 22ï¼‰</strong>ã€‚</li>
<li>å¦‚æœ Mihomo æŠŠ SSH æµé‡ä¹Ÿå°è¯•è½¬å‘ç»™ä»£ç†èŠ‚ç‚¹ï¼Œæˆ–è€…åœ¨è·¯ç”±è¿‡ç¨‹ä¸­å¤„ç†ä¸å½“ï¼Œä½ çš„è¿æ¥é€šé“ä¼šè¢«ç¬é—´åˆ‡æ–­ã€‚</li>
</ul>
<p><strong>è§£å†³ï¼ˆæ•‘å‘½ç¨»è‰ï¼‰</strong>ï¼š
åœ¨ <code>config.yaml</code> çš„ <code>rules</code> éƒ¨åˆ†ï¼Œ<strong>ç¬¬ä¸€è¡Œ</strong>å¿…é¡»å¼ºåˆ¶æ”¾è¡Œ SSH ç«¯å£ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">rules:</span>
  <span class="hljs-comment"># âš ï¸ å¿…é¡»æ”¾åœ¨ç¬¬ä¸€è¡Œï¼å‘Šè¯‰ Mihomoï¼šSSH æµé‡åˆ«åŠ¨ï¼Œç›´æ¥æ”¾è¡Œï¼</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">DST-PORT,22,DIRECT</span>
  
  <span class="hljs-comment"># ... å…¶ä»–è§„åˆ™ ...</span>
</code></pre>
<p><strong>ä¿å‘½æŠ€å·§</strong>ï¼š
åœ¨è°ƒè¯•é˜¶æ®µï¼Œå»ºè®®å…»æˆä½¿ç”¨â€œåæ‚”è¯â€å‘½ä»¤çš„ä¹ æƒ¯ã€‚åœ¨å¯åŠ¨å®¹å™¨å‰æ‰§è¡Œ <code>sudo shutdown -r +10</code>ï¼ˆ10åˆ†é’Ÿåè‡ªåŠ¨é‡å¯ï¼‰ã€‚ä¸‡ä¸€å¤±è”äº†ï¼Œç­‰ 10 åˆ†é’ŸæœåŠ¡å™¨é‡å¯ï¼Œä½ å°±èƒ½é‡æ–°è¿è¿›å»åˆ æ‰å®¹å™¨ä¿®é…ç½®äº†ã€‚</p>
<h4 data-id="heading-9">ğŸ•³ï¸ å‘ä¸€ï¼šDocker é•œåƒæ‹‰ä¸ä¸‹æ¥</h4>
<ul>
<li><strong>ç°è±¡ï¼š</strong> é…ç½®å¥½äº† Dockerï¼Œä½† <code>docker compose up</code> æ—¶ä¸€ç›´å¡åœ¨ Pullingï¼Œæœ€åæŠ¥é”™ <code>context deadline exceeded</code>ã€‚å›½å†… Docker é•œåƒæºåœ¨æ‹‰å–æµ·å¤–é•œåƒæ—¶ç›®å‰æå…¶ä¸ç¨³å®šã€‚</li>
<li><strong>è§£å†³ï¼š</strong>
<ol>
<li>åˆ©ç”¨å¤–éƒ¨ SOCKS5 ä»£ç†ï¼ˆæ¯”å¦‚æœ¬åœ°ç”µè„‘æˆ–å…¶ä»–æœºå™¨ï¼‰ç»™ Docker å®ˆæŠ¤è¿›ç¨‹æ³¨å…¥ä»£ç†ã€‚</li>
<li>åˆ›å»ºé…ç½®ç›®å½•ï¼š<code>sudo mkdir -p /etc/systemd/system/docker.service.d</code></li>
<li>å†™å…¥ä»£ç†ï¼š
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŠŠ IP:PORT æ¢æˆä½ å¯ç”¨çš„ SOCKS5 ä»£ç†</span>
sudo <span class="hljs-built_in">tee</span> /etc/systemd/system/docker.service.d/http-proxy.conf &lt;&lt;<span class="hljs-string">EOF
[Service]
Environment="HTTP_PROXY=socks5://ip:port"
Environment="HTTPS_PROXY=socks5://ip:port"
EOF</span>
</code></pre>
</li>
<li>é‡å¯ Dockerï¼š<code>sudo systemctl daemon-reload &amp;&amp; sudo systemctl restart docker</code></li>
</ol>
<blockquote>
<p><strong>âš ï¸ æ³¨æ„ï¼š</strong> é•œåƒæ‹‰å–æˆåŠŸåï¼ŒåŠ¡å¿…åˆ é™¤è¿™ä¸ªæ–‡ä»¶å¹¶é‡å¯ Dockerï¼Œå¦åˆ™åç»­ Mihomo è¿è¡Œæ—¶ä¼šå› ä¸ºç½‘ç»œé…ç½®å†²çªè€Œå‡ºç°é—®é¢˜ã€‚</p>
</blockquote>
</li>
</ul>
<h4 data-id="heading-10">ğŸ•³ï¸ å‘äºŒï¼šé…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼ˆæ— é™é‡å¯ï¼‰</h4>
<ul>
<li><strong>ç°è±¡ï¼š</strong> <code>docker ps</code> æ˜¾ç¤ºå®¹å™¨çŠ¶æ€ä¸€ç›´æ˜¯ <code>Restarting</code>ã€‚</li>
<li><strong>åŸå› ï¼š</strong> ç›´æ¥åœ¨ç»ˆç«¯ç²˜è´´é…ç½®æ–‡ä»¶æ—¶ï¼Œå¯èƒ½ç²˜è´´äº†é YAML å†…å®¹ï¼›é…ç½®æ–‡ä»¶é‡ŒåŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ Emojiï¼‰ï¼Œåœ¨æŸäº› SSH å®¢æˆ·ç«¯ä¸‹ä¹±ç ï¼Œå¯¼è‡´ YAML è§£æå¤±è´¥ã€‚</li>
<li><strong>è§£å†³ï¼š</strong> ä½¿ç”¨ <code>head -n 5 config.yaml</code> æ£€æŸ¥æ–‡ä»¶å¤´éƒ¨ï¼›å°½é‡ä½¿ç”¨ä¸å¸¦ç‰¹æ®Šå­—ç¬¦çš„çº¯å‡€é…ç½®ã€‚</li>
</ul>
<h4 data-id="heading-11">ğŸ•³ï¸ å‘ä¸‰ï¼šPing å¾—é€šï¼ŒCurl ä¸é€šï¼ˆåœ°ç‹±çº§éš¾é¢˜ï¼‰</h4>
<ul>
<li><strong>ç°è±¡ï¼š</strong> å®¹å™¨å¯åŠ¨äº†ï¼Œ<code>ping google.com</code> èƒ½é€šï¼›ä½† <code>curl -v https://www.google.com</code> å¡åœ¨ <code>Trying...</code> ä¸åŠ¨ï¼Œæœ€åè¶…æ—¶ã€‚</li>
<li><strong>åŸå› ï¼š</strong> è¿™æ˜¯ Linux å†…æ ¸çš„ RP_Filter (åå‘è·¯å¾„è¿‡æ»¤) æˆ–åè®®æ ˆå†²çªå¯¼è‡´çš„ï¼Œå†…æ ¸ä¸¢å¼ƒäº† TUN ç½‘å¡è¿”å›çš„ TCP æ¡æ‰‹åŒ…ã€‚</li>
<li><strong>è§£å†³ï¼ˆä¸‰æ¿æ–§ï¼‰ï¼š</strong>
<ol>
<li>å¼€å¯ IP è½¬å‘ï¼š
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">"net.ipv4.ip_forward=1"</span> | sudo <span class="hljs-built_in">tee</span> -a /etc/sysctl.conf
sudo sysctl -p
</code></pre>
</li>
<li>åˆ‡æ¢ Mihomo åè®®æ ˆï¼ˆæœ€æœ‰æ•ˆï¼‰ï¼šåœ¨ <code>config.yaml</code> ä¸­ï¼Œå°† <code>stack: system</code> æ”¹ä¸º <code>stack: mixed</code>ã€‚å¦‚æœ <code>mixed</code> è¿˜ä¸è¡Œï¼Œæ”¹ä¸º <code>stack: gvisor</code>ï¼ˆGoogle çš„ç”¨æˆ·æ€æ ˆï¼Œå…¼å®¹æ€§æœ€å¼ºï¼‰ã€‚</li>
<li>é‡å¯å®¹å™¨ï¼š<code>docker compose restart</code>ã€‚</li>
</ol>
</li>
</ul>
<h4 data-id="heading-12">ğŸ•³ï¸ å‘å››ï¼šWeb é¢æ¿æ‰“ä¸å¼€</h4>
<ul>
<li><strong>ç°è±¡ï¼š</strong> å®¹å™¨ç»¿äº†ï¼Œä½†æµè§ˆå™¨è®¿é—® <code>http://ip:9090/ui</code> è¶…æ—¶ã€‚</li>
<li><strong>åŸå› ï¼š</strong> äº‘æœåŠ¡å™¨çš„å®‰å…¨ç»„ï¼ˆé˜²ç«å¢™ï¼‰æ²¡æœ‰å¼€æ”¾ç«¯å£ã€‚</li>
<li><strong>è§£å†³ï¼š</strong> å»äº‘å‚å•†æ§åˆ¶å°ï¼Œåœ¨å®‰å…¨ç»„å…¥ç«™è§„åˆ™é‡Œæ”¾è¡Œ TCP 9090ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-13">æœ€ç»ˆéªŒè¯</h3>

























<table><thead><tr><th align="left">éªŒè¯é¡¹</th><th align="left">å‘½ä»¤</th><th align="left">é¢„æœŸç»“æœ</th></tr></thead><tbody><tr><td align="left"><strong>éªŒè¯ç›´è¿</strong></td><td align="left"><code>curl -I https://www.baidu.com</code></td><td align="left">ç§’å› <code>200 OK</code></td></tr><tr><td align="left"><strong>éªŒè¯é…ç½®</strong></td><td align="left"><code>curl -I https://www.google.com</code></td><td align="left">ç§’å› <code>200 OK</code></td></tr><tr><td align="left"><strong>é¢æ¿ç®¡ç†</strong></td><td align="left">è®¿é—® <code>http://ip:9090/ui</code></td><td align="left">æˆåŠŸæ‰“å¼€é¢æ¿ï¼Œæµ‹é€Ÿå¹¶é€‰æ‹©å¯ç”¨çš„ç½‘ç»œèŠ‚ç‚¹ã€‚</td></tr></tbody></table>
<p>è‡³æ­¤ï¼Œä½ çš„æœåŠ¡å™¨å·²ç»æ‹¥æœ‰äº†<strong>ç»Ÿä¸€çš„ç½‘ç»œæµé‡ç®¡ç†èƒ½åŠ›</strong>ï¼ŒDocker æ‹‰å–ã€æµ·å¤–æŠ€æœ¯æœåŠ¡è°ƒç”¨ã€ç³»ç»Ÿæ›´æ–°å°†ç•…é€šæ— é˜»ï¼</p>
<pre><code class="hljs"/></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[6. ç»§æ‰¿ä¸é¢å‘å¯¹è±¡è®¾è®¡]]></title>    <link>https://juejin.cn/post/7578519990284156954</link>    <guid>https://juejin.cn/post/7578519990284156954</guid>    <pubDate>2025-12-01T11:38:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578519990284156954" data-draft-id="7578138892126421038" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="6. ç»§æ‰¿ä¸é¢å‘å¯¹è±¡è®¾è®¡"/> <meta itemprop="keywords" content="C++"/> <meta itemprop="datePublished" content="2025-12-01T11:38:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºçŒ¿æœ¬å‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/3868510676597259"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            6. ç»§æ‰¿ä¸é¢å‘å¯¹è±¡è®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3868510676597259/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºçŒ¿æœ¬å‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-01T11:38:37.000Z" title="Mon Dec 01 2025 11:38:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>C++çš„OOPæœ‰å¯èƒ½æ˜¯å•ä¸€ç»§æ‰¿æˆ–å¤šé‡ç»§æ‰¿ï¼Œæ¯ä¸€ä¸ªç»§æ‰¿è¿æ¥(link)å¯ä»¥æ˜¯ public,protected æˆ– private,ä¹Ÿå¯ä»¥æ˜¯ virtual æˆ–non-virtualã€‚æˆå‘˜å‡½æ•°çš„å„ä¸ªé€‰é¡¹:virtual?non-virtual?pure virtual?ä»¥åŠæˆå‘˜å‡½æ•°å’Œå…¶ä»–è¯­è¨€ç‰¹æ€§çš„äº¤äº’å½±å“:ç¼ºçœå‚æ•°å€¼ä¸virtualå‡½æ•°æœ‰ä»€ä¹ˆäº¤äº’å½±å“?ç»§æ‰¿å¦‚ä½•å½±å“çš„åç§°æŸ¥æ‰¾è§„åˆ™?è®¾è®¡é€‰é¡¹æœ‰å“ªäº›?å¦‚æœclassçš„è¡Œä¸ºéœ€è¦ä¿®æ”¹ï¼Œvirtualå‡½æ•°æ˜¯æœ€ä½³é€‰æ‹©å—?</p>
</blockquote>
<h2 data-id="heading-0">32. ç¡®å®šä½ çš„publicç»§æ‰¿å¡‘æ¨¡å‡ºis-aå…³ç³»</h2>
<ol>
<li>Derivedæ˜¯Baseï¼Œæ‰€ä»¥èƒ½ç”¨Baseçš„åœ°æ–¹ï¼Œå°±èƒ½ä½¿ç”¨Derivedæ›¿æ¢ï¼Œæ— è®ºæ˜¯å¯¹è±¡ã€æŒ‡é’ˆè¿˜æ˜¯å¼•ç”¨</li>
<li>ä¸–ç•Œä¸Šå¹¶ä¸å­˜åœ¨é€‚ç”¨äºæ‰€æœ‰è½¯ä»¶çš„â€œå®Œç¾è®¾è®¡â€ï¼Œæœ€ä½³è®¾è®¡å–å†³äºç³»ç»Ÿå¸Œæœ›åšä»€ä¹ˆï¼ŒåŒ…æ‹¬ç°åœ¨å’Œæœªæ¥</li>
<li>is-aï¼šé€‚ç”¨äºbaseèº«ä¸Šçš„æ¯ä¸€ä»¶äº‹æƒ…ä¹Ÿä¸€å®šé€‚ç”¨äºderivedèº«ä¸Šï¼Œå³<strong>Derivedæ€»æ˜¯ç»§æ‰¿baseçš„æ‰€æœ‰æ¥å£</strong></li>
<li>æœ‰çš„æ—¶å€™å¯èƒ½åœ¨cppä¸–ç•Œä¸­ä¸å¸¸è¯†ç›¸åï¼š<strong>æ­£æ–¹å½¢squareå’Œrectangleä¹‹é—´ï¼Œå…¶å®å¹¶ä¸æ˜¯is-aå…³ç³»ï¼Œå› ä¸ºrectangleå†…éƒ¨å¯ä»¥éšæ„ä¿®æ”¹é•¿å®½ï¼Œä½†æ˜¯squareç¡®å¯¹é•¿å®½ä¿®æ”¹æœ‰è¦æ±‚</strong></li>
</ol>
<h2 data-id="heading-1">33. é¿å…é®æ©ç»§æ‰¿è€Œæ¥çš„åç§°</h2>
<ol>
<li>å½“derivedä¸­æœ‰ä¸baseåŒåæ–¹æ³•ï¼Œåˆ™ä¼šç›´æ¥éšè—æ‰ï¼Œæ— è®ºæ˜¯å¦å‚æ•°ã€è¿”å›å€¼ä¸åŒï¼Œç”šè‡³ä¹Ÿ<strong>æ— å…³virtual</strong>ï¼ˆæ‰€ä»¥å¤šæ€å¯èƒ½å¯¼è‡´éšè—ï¼‰ï¼Œåªä¸åç§°ç›¸å…³ï¼›è¿™ä¹ˆåšçš„åŸå› æ˜¯ï¼šé˜²æ­¢åœ¨ç¨‹åºåº“æˆ–æ¡†æ¶ä¸­å»ºç«‹æ–°çš„Derivedæ—¶é™„å¸¦åœ°ä»ç–è¿œçš„base classesç»§æ‰¿é‡è½½å‡½æ•°ã€‚</li>
<li>éšè—ä¹‹åå°±ç±»ä¼¼äºæ²¡æœ‰ç»§æ‰¿è¿™äº›åŒåå‡½æ•°ï¼Œä½†æ˜¯è¿™ä¸publicç»§æ‰¿æ‰€æœ‰æ¥å£ï¼Œå¯å€ŸåŠ©<strong>using</strong>æ¥è§£å†³ï¼Œå¦‚<code>using Base::f1;</code></li>
<li>å½“ä½¿ç”¨privateç»§æ‰¿æ—¶ï¼Œæœ‰æ—¶å€™åªæ˜¯éœ€è¦Baseä¸­æŸåç§°å‡½æ•°çš„éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯å…¨éƒ¨ï¼ˆæ•…usingä¸æ»¡è¶³ï¼‰ï¼Œå¯ä»¥å€ŸåŠ©<strong>è½¬äº¤å‡½æ•°</strong>ï¼ˆinlineå‡½æ•°ï¼‰ï¼Œå¦‚<code>void f1(){Base::f1();}//è¿™é‡Œç±»å†…éƒ¨å®ç°ï¼Œéšè—inlineï¼Œåªæš´éœ²äº†Base::f1çš„æ— å‚ç‰ˆæœ¬</code></li>
</ol>
<h2 data-id="heading-2">34. åŒºåˆ†æ¥å£ç»§æ‰¿å’Œå®ç°ç»§æ‰¿</h2>
<ol>
<li><strong>publicç»§æ‰¿ä¹‹ä¸‹ï¼ŒDerivedæ€»æ˜¯ç»§æ‰¿baseçš„æ‰€æœ‰æ¥å£</strong></li>
<li><strong>pure virtual</strong>ç›®çš„æ˜¯ä¸ºäº†è®©Derivedåªç»§æ‰¿å‡½æ•°æ¥å£ï¼Œä½†æ˜¯å…¶å®æ˜¯å¯ä»¥ç»™pure virtualå‡½æ•°æä¾›ä¸€ä¸€ä»½å®ç°çš„ï¼Œç„¶åä½¿ç”¨<code>ç±»å::å‡½æ•°å</code>æ¥è°ƒç”¨</li>
<li><strong>impure virtual</strong>ç›®çš„æ˜¯è®©derivedç»§æ‰¿å‡½æ•°æ¥å£ä»¥åŠç¼ºçœå®ç°ï¼Œä½†æ­£æ˜¯è¿™ç¼ºçœå®ç°ï¼Œå¯èƒ½è®©derivedå¿˜è®°é‡æ–°å®šä¹‰ï¼Œè¿›è€Œå¯¼è‡´å‡ºé”™ï¼Œæ¨èä½¿ç”¨pure virtualï¼Œç„¶åæä¾›å®ç°ï¼Œå†åœ¨å†…éƒ¨è°ƒç”¨ï¼Œç±»ä¼¼äºè½¬äº¤å‡½æ•°</li>
<li><strong>non-virtual</strong>ç›®çš„æ˜¯ä¸ºäº†è®©derivedç»§æ‰¿å‡½æ•°æ¥å£ä»¥åŠä¸€ä»½å¼ºåˆ¶æ€§çš„å®ç°ï¼Œç»ä¸åº”è¯¥åœ¨derivedä¸­è¢«é‡æ–°å®šä¹‰</li>
</ol>
<h2 data-id="heading-3">35. è€ƒè™‘virtualå‡½æ•°ä»¥å¤–çš„å…¶ä»–é€‰æ‹©</h2>
<ol>
<li>å…¶å®æœ¬ç« æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥è¦ç”¨å…¶ä»–æ–¹å¼æ¥æ›¿æ¢virtualï¼Œå¸Œæœ›ä»¥åèƒ½é¡¿æ‚Ÿå§</li>
<li>å…·ä½“æ–¹æ³•å‚è§é“¾æ¥<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cnblogs.com%2Freasno%2Fp%2F4796134.html" target="_blank" title="https://www.cnblogs.com/reasno/p/4796134.html" ref="nofollow noopener noreferrer">è€ƒè™‘virtualå‡½æ•°ä»¥å¤–çš„å…¶ä»–é€‰æ‹©</a></li>
</ol>
<h2 data-id="heading-4">36. ç»ä¸é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„non-virtualå‡½æ•°</h2>
<ol>
<li>å¦‚æœé‡æ–°å®šä¹‰äº†ï¼Œé‚£ä¼šå¯¼è‡´è°ƒç”¨è¯¥å‡½æ•°ä¼šå› ä¸ºæŒ‡é’ˆçš„ç±»å‹ï¼ˆbase or derivedï¼‰ä¸åŒè€Œä¸åŒ</li>
<li>è°¨è®°non-virtualå‡½æ•°æ˜¯ä¸ºè¯¥classå»ºç«‹èµ·ä¸€ä¸ªä¸å˜æ€§</li>
</ol>
<h2 data-id="heading-5">37. ç»ä¸é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„ç¼ºçœå‚æ•°å€¼</h2>
<ol>
<li>ç”±æ¡æ¡†36å¯çŸ¥ï¼Œé‡æ–°å®šä¹‰çš„åªèƒ½æ˜¯virtualå‡½æ•°ï¼Œæ•…æ­¤æ¡æ¬¾é’ˆå¯¹çš„<strong>virtualå‡½æ•°</strong></li>
<li>ç¼ºçœå‚æ•°å€¼ï¼Œå…¶å®æ˜¯é™æ€ç±»å‹ï¼Œç¼–è¯‘å™¨æ ¹æ®æŒ‡é’ˆç±»å‹ï¼Œå»ç»‘å®šæŒ‡å®šå€¼ï¼Œè€Œvirtualå´æ˜¯ä¸ºäº†åŠ¨æ€ï¼Œä¸¤è€…å…¶å®å¤©ç”ŸçŸ›ç›¾</li>
<li>æœ¬æ¡åº”è¯¥æ˜¯è¯´ï¼š<strong>æ°¸è¿œä¸è¦åœ¨è™šå‡½æ•°ä¸­å®šä¹‰é»˜è®¤å‚æ•°</strong></li>
<li>å¦‚æœå¸Œæœ›ä½¿ç”¨baseç±»æä¾›çš„é»˜è®¤å€¼ï¼Œå¯ä½¿ç”¨<strong>NVI(public non-virtual è°ƒç”¨private virtualå‡½æ•°ï¼Œæ´¾ç”Ÿç±»é‡å®šä¹‰virtualå‡½æ•°å³å¯ï¼Œå¤–éƒ¨è°ƒç”¨non-virtualå‡½æ•°)</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Base</span> {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-type">int</span> x = <span class="hljs-number">10</span>)</span> </span>{  <span class="hljs-comment">// éè™šï¼Œç»Ÿä¸€ç®¡ç†é»˜è®¤å€¼</span>
        <span class="hljs-built_in">doFoo</span>(x);
    }
<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">doFoo</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> </span>{ <span class="hljs-comment">/* åŸºç±»å®ç° */</span> }
};

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Derived</span> : <span class="hljs-keyword">public</span> Base {
<span class="hljs-keyword">private</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">doFoo</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span> <span class="hljs-keyword">override</span> </span>{ <span class="hljs-comment">/* æ´¾ç”Ÿç±»å®ç° */</span> }
};
</code></pre>
<h2 data-id="heading-6">38ã€‚ é€šè¿‡å¤åˆæ¨¡å¡‘å‡ºhas-aæˆ–â€œæ ¹æ®æŸç‰©å®ç°å‡ºâ€</h2>
<ol>
<li><strong>å¤åˆ</strong>ï¼ŒæŸç§ç±»å‹çš„å¯¹è±¡å«æœ‰å…¶ä»–ç±»å‹çš„å¯¹è±¡</li>
<li><strong>åº”ç”¨åŸŸ</strong>ï¼Œå¯¹è±¡ç›¸å¯¹äºæ‰€å¡‘é€ ä¸–ç•Œä¸­çš„æŸäº›äº‹ç‰©ï¼Œæ¯”å¦‚äººç­‰</li>
<li><strong>å®ç°åŸŸ</strong>ï¼Œå®ç°ç»†èŠ‚ä¸Šçš„äººå·¥åˆ¶å“ï¼Œå¦‚ç¼“å†²åŒºã€äº’æ–¥å™¨ã€æŸ¥æ‰¾æ ‘ç­‰</li>
<li>å½“å¤åˆå‘ç”Ÿåœ¨åº”ç”¨åŸŸå°±æ˜¯has-aå…³ç³»ï¼ˆå¦‚äººæœ‰åœ°å€ç”µè¯ï¼‰ï¼Œå®ç°åŸŸå°±æ˜¯â€œæ ¹æ®æŸç‰©å®ç°å‡ºâ€çš„å…³ç³»ï¼ˆå¦‚æ ¹æ®queueå®ç°å‡ºstackï¼‰</li>
</ol>
<h2 data-id="heading-7">39. æ˜æ™ºè€Œå®¡æ…åœ°ä½¿ç”¨privateç»§æ‰¿</h2>
<ol>
<li>å¦‚æœæ˜¯privateç»§æ‰¿ï¼Œç¼–è¯‘å™¨ä¸ä¼šè‡ªåŠ¨å°†derived classè½¬æ¢ä¸ºbase classå¯¹è±¡ï¼›privateç»§æ‰¿è€Œæ¥çš„æ‰€æœ‰æˆå‘˜éƒ½ä¼šå˜ä¸ºprivateå±æ€§</li>
<li>privateç»§æ‰¿æ„å‘³â€ç”±æŸç‰©å®ç°å‡ºâ€œ</li>
<li><strong>privateç»§æ‰¿æ„å‘³ç€åªæœ‰å®ç°éƒ¨åˆ†è¢«ç»§æ‰¿</strong>ï¼Œæ¥å£éƒ¨åˆ†åº”ç•¥å»</li>
<li><strong>å°½å¯èƒ½ä½¿ç”¨å¤ç”¨ï¼Œåªæœ‰å½“protectedæˆå‘˜æˆ–virtualå‡½æ•°ç‰µæ‰¯è¿›æ¥æ—¶ï¼Œæ‰ä½¿ç”¨privateç»§æ‰¿</strong></li>
<li>privateè¿˜å¯èƒ½æœ‰empty baseæœ€ä¼˜åŒ–ï¼Œèƒ½èŠ‚çœå†…å­˜</li>
</ol>
<h2 data-id="heading-8">40. æ˜æ™ºè€Œå®¡æ…åœ°ä½¿ç”¨å¤šé‡ç»§æ‰¿</h2>
<ol>
<li>å¤šé‡ç»§æ‰¿å¯èƒ½å¼•å…¥æ­§ä¹‰æ€§ã€è±å½¢ç»§æ‰¿çš„é—®é¢˜</li>
<li>virtualç»§æ‰¿ä¼šå¤§å°ã€é€Ÿåº¦ç­‰æˆæœ¬ï¼Œä¸”virtual baseçš„åˆå§‹åŒ–è´£ä»»æ˜¯ç”±ç»§æ‰¿ä½“ç³»ä¸­æœ€åº•å±‚classè´Ÿè´£ï¼Œæ•…å°½é‡ä¸è¦åœ¨virtual baseä¸­æœ‰æ•°æ®</li>
<li><strong>å½“æ¶‰åŠâ€publicç»§æ‰¿æŸä¸ªinterface classâ€œå’Œâ€privateç»§æ‰¿æŸä¸ªååŠ©å®ç°çš„classâ€œçš„ä¸¤ç›¸ç»„åˆ</strong>ï¼Œåˆ™ä¸å¾—ä¸ä½¿ç”¨å¤šé‡ç»§æ‰¿</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JAVAä»£ç å®¡è®¡ï¼šé‰´æƒæ¼æ´æ·±åº¦åˆ†æ]]></title>    <link>https://juejin.cn/post/7578714759337099264</link>    <guid>https://juejin.cn/post/7578714759337099264</guid>    <pubDate>2025-12-01T13:15:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578714759337099264" data-draft-id="7578700798744379426" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JAVAä»£ç å®¡è®¡ï¼šé‰´æƒæ¼æ´æ·±åº¦åˆ†æ"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-01T13:15:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äºˆè¾‰å®‰å…¨"/> <meta itemprop="url" content="https://juejin.cn/user/1013073908864108"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JAVAä»£ç å®¡è®¡ï¼šé‰´æƒæ¼æ´æ·±åº¦åˆ†æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1013073908864108/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äºˆè¾‰å®‰å…¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-01T13:15:59.000Z" title="Mon Dec 01 2025 13:15:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€SessionFilterçš„å®‰å…¨è¿·é›¾</h2>
<p>åœ¨è¿›è¡ŒæŸç³»ç»Ÿå®‰å…¨å®¡è®¡æ—¶ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªå…³é”®çš„<code>SessionFilter</code>è¿‡æ»¤å™¨ã€‚è¿™ä¸ªè¿‡æ»¤å™¨ä½œä¸ºç³»ç»Ÿçš„ç¬¬ä¸€é“å®‰å…¨é˜²çº¿ï¼Œæœ¬åº”æ‰¿æ‹…ç€ä¸¥æ ¼çš„è®¿é—®æ§åˆ¶èŒè´£ï¼Œä½†å…¶å®ç°å´æš—è—ç„æœºï¼Œå­˜åœ¨å¤šå¤„å¯ç»•è¿‡çš„å®‰å…¨éšæ‚£ã€‚</p>
<h2 data-id="heading-1">äºŒã€ç™½åå•æœºåˆ¶ï¼šçœ‹ä¼¼å®‰å…¨å®åˆ™è„†å¼±</h2>
<h3 data-id="heading-2">2.1 ç™½åå•éªŒè¯é€»è¾‘</h3>
<p>java</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">isNoNeedValidate</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> url, HttpServletRequest request</span>) {
    <span class="hljs-title class_">String</span>[] paths = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]{<span class="hljs-string">"/login.jsp"</span>, <span class="hljs-string">"/user/logon.do"</span>, <span class="hljs-string">"/service/"</span>, ...};
    <span class="hljs-comment">// ... ç™½åå•éªŒè¯é€»è¾‘</span>
}
</code></pre>
<p><strong>å…³é”®å‘ç°</strong>ï¼š</p>
<ul>
<li>ç³»ç»Ÿé€šè¿‡<code>request.getContextPath() + path</code>çš„æ–¹å¼è¿›è¡Œè·¯å¾„åŒ¹é…</li>
<li>åªè¦è¯·æ±‚è·¯å¾„ä»¥ç™½åå•ä¸­çš„ä»»æ„ä¸€é¡¹å¼€å¤´ï¼Œå³å¯ç»•è¿‡é‰´æƒ</li>
</ul>
<h3 data-id="heading-3">2.2 è·¯å¾„è§„èŒƒåŒ–ç»•è¿‡</h3>
<p><strong>ç»•è¿‡æ‰‹æ³•</strong>ï¼š</p>
<ul>
<li>åˆ©ç”¨<code>../</code>è¿›è¡Œè·¯å¾„è·³è½¬ï¼ˆä½ç‰ˆæœ¬Springæ¡†æ¶ï¼‰</li>
<li>ç¤ºä¾‹ï¼š<code>/trwfe/../login.jsp</code>Â ç»è¿‡è§„èŒƒåŒ–åå¯èƒ½è¢«è¯†åˆ«ä¸ºç™½åå•è·¯å¾„</li>
<li><strong>å½±å“</strong>ï¼šæ”»å‡»è€…å¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„URLç»•è¿‡é‰´æƒç›´æ¥è®¿é—®å—é™èµ„æº</li>
</ul>
<h2 data-id="heading-4">ä¸‰ã€å¤šé‡æ£€æŸ¥æœºåˆ¶çš„æ¼æ´åˆ†æ</h2>
<h3 data-id="heading-5">3.1 Refereræ£€æŸ¥å¯è¢«ä¼ªé€ </h3>
<p>java</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">isReferer</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> url, HttpServletRequest request</span>) {
    <span class="hljs-title class_">String</span>[] paths = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]{<span class="hljs-string">"/ws/sso/login"</span>};
    <span class="hljs-comment">// ä»…å¯¹ç‰¹å®šè·¯å¾„ç¦ç”¨Refereræ£€æŸ¥</span>
    <span class="hljs-keyword">return</span> !url.<span class="hljs-title function_">startsWith</span>(contextPath + <span class="hljs-string">"/ws/sso/login"</span>);
}
</code></pre>
<p><strong>å®‰å…¨ç¼ºé™·</strong>ï¼š</p>
<ol>
<li>é™¤<code>/ws/sso/login</code>å¤–ï¼Œå…¶ä»–è·¯å¾„å‡è¿›è¡ŒRefereræ£€æŸ¥</li>
<li>Refererå¤´å¯è¢«ä¼ªé€ ï¼š<code>Referer: http://ç›®æ ‡åŸŸå/</code></li>
<li>æ”»å‡»è€…å¯è½»æ˜“ç»•è¿‡åŸŸåéªŒè¯</li>
</ol>
<h3 data-id="heading-6">3.2 ç¬¬ä¸‰æ–¹ç³»ç»Ÿå¼€å…³çš„é…ç½®ä¾èµ–</h3>
<p>java</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">if</span> (Config.THIRD_SYSTEM_SWITCH &amp;&amp; <span class="hljs-string">"2"</span>.equals(Config.THIRD_SYSTEM_TYPE) 
    &amp;&amp; <span class="hljs-keyword">this</span>.isForbid(url, request)) {
    response.setStatus(<span class="hljs-number">500</span>);
    <span class="hljs-keyword">return</span>;
}
</code></pre>
<p><strong>é…ç½®é£é™©</strong>ï¼š</p>
<ul>
<li>ä¾èµ–<code>THIRD_SYSTEM_SWITCH</code>å’Œ<code>THIRD_SYSTEM_TYPE</code>é…ç½®</li>
<li>å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å¯èƒ½å­˜åœ¨é…ç½®çŠ¶æ€ä¸ä¸€è‡´é—®é¢˜</li>
<li>é™æ€é…ç½®æ— æ³•åº”å¯¹åŠ¨æ€æ”»å‡»åœºæ™¯</li>
</ul>
<h3 data-id="heading-7">3.3 isForbidå‡½æ•°çš„å®‰å…¨ç›²ç‚¹</h3>
<p>java</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">private</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">isForbid</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> url, HttpServletRequest request</span>) {
    <span class="hljs-keyword">if</span> (url.<span class="hljs-title function_">contains</span>(<span class="hljs-string">"ext/flow"</span>)) {
        <span class="hljs-comment">// ä»…é™åˆ¶éGETæ–¹æ³•</span>
        <span class="hljs-keyword">return</span> !<span class="hljs-string">"get"</span>.<span class="hljs-title function_">equals</span>(method) &amp;&amp; !<span class="hljs-string">"GET"</span>.<span class="hljs-title function_">equals</span>(method);
    }
    <span class="hljs-comment">// ä»…æ£€æŸ¥ç‰¹å®šè·¯å¾„</span>
    <span class="hljs-title class_">String</span>[] paths = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]{<span class="hljs-string">"ext/trusteeSet"</span>};
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<p><strong>ç»•è¿‡æ¡ä»¶</strong>ï¼š</p>
<ol>
<li>ä¸åŒ…å«<code>ext/trusteeSet</code>è·¯å¾„</li>
<li>ä¸åŒ…å«<code>ext/flow</code>è·¯å¾„ï¼Œæˆ–å¯¹<code>ext/flow</code>ä»…ä½¿ç”¨GETè¯·æ±‚</li>
<li>ç»å¤§å¤šæ•°ä¸šåŠ¡æ¥å£å‡å¯æ»¡è¶³è¿™äº›æ¡ä»¶</li>
</ol>
<h2 data-id="heading-8">å››ã€Ajaxè¯·æ±‚å¤„ç†çš„é€»è¾‘æ¼æ´</h2>
<h3 data-id="heading-9">4.1 æ¡ä»¶åˆ¤æ–­ç¼ºé™·</h3>
<p>java</p>
<pre><code class="hljs language-vbscript" lang="vbscript"><span class="hljs-keyword">if</span> (<span class="hljs-built_in">request</span>.getHeader(<span class="hljs-string">"x-requested-with"</span>) != <span class="hljs-literal">null</span> 
    &amp;&amp; <span class="hljs-built_in">request</span>.getHeader(<span class="hljs-string">"x-requested-with"</span>).equalsIgnoreCase(<span class="hljs-string">"XMLHttpRequest"</span>)) {
    // æ£€æŸ¥lang cookie
    <span class="hljs-keyword">if</span> (StringUtils.isBlank(lang)) {
        <span class="hljs-built_in">response</span>.setHeader(<span class="hljs-string">"sessionstatus"</span>, <span class="hljs-string">"timeout"</span>);
        return;
    }
    chain.<span class="hljs-keyword">do</span><span class="hljs-built_in">Filter</span>(...);
} <span class="hljs-keyword">else</span> {
    // éAjaxè¯·æ±‚ç›´æ¥æ”¾è¡Œï¼
    chain.<span class="hljs-keyword">do</span><span class="hljs-built_in">Filter</span>(...);
}
</code></pre>
<p><strong>è‡´å‘½æ¼æ´</strong>ï¼š</p>
<ul>
<li><strong>ä¸è®¾ç½®<code>x-requested-with</code>å¤´å³å¯ç»•è¿‡AjaxéªŒè¯</strong></li>
<li>æµè§ˆå™¨é»˜è®¤è¯·æ±‚ä¸ä¼šè‡ªåŠ¨æ·»åŠ æ­¤å¤´</li>
<li>æ”»å‡»è€…å¯è½»æ¾æ„é€ éAjaxè¯·æ±‚ç»•è¿‡ä¼šè¯æ£€æŸ¥</li>
</ul>
<h2 data-id="heading-10">äº”ã€æ”»å‡»é“¾æ„é€ ä¸é£é™©å½±å“</h2>
<h3 data-id="heading-11">5.1 å®Œæ•´æ”»å‡»è·¯å¾„</h3>
<ol>
<li><strong>ç»•è¿‡ç™½åå•</strong>ï¼šä½¿ç”¨è·¯å¾„è·³è½¬æŠ€æœ¯</li>
<li><strong>ä¼ªé€ Referer</strong>ï¼šè®¾ç½®åˆæ³•çš„Refererå¤´</li>
<li><strong>é¿å…è§¦å‘isForbid</strong>ï¼šé€‰æ‹©æ™®é€šä¸šåŠ¡æ¥å£</li>
<li><strong>ç»•è¿‡AjaxéªŒè¯</strong>ï¼šä¸è®¾ç½®x-requested-withå¤´</li>
</ol>
<h3 data-id="heading-12">5.2 é£é™©å½±å“è¯„ä¼°</h3>
<ul>
<li><strong>æœªæˆæƒè®¿é—®</strong>ï¼šå¯è®¿é—®ä»»æ„æœªåœ¨ç™½åå•ä¸­çš„åŠŸèƒ½</li>
<li><strong>æ•°æ®æ³„éœ²</strong>ï¼šè·å–æ•æ„Ÿä¸šåŠ¡æ•°æ®</li>
<li><strong>æƒé™æå‡</strong>ï¼šé€šè¿‡æœªæˆæƒæ¥å£æ‰§è¡Œé«˜æƒé™æ“ä½œ</li>
<li><strong>ä¸šåŠ¡é€»è¾‘ç»•è¿‡</strong>ï¼šç»•è¿‡æ­£å¸¸ä¸šåŠ¡æµç¨‹æ§åˆ¶</li>
</ul>
<h2 data-id="heading-13">å…­ã€ä¿®å¤å»ºè®®ä¸å®‰å…¨å®è·µ</h2>
<h3 data-id="heading-14">6.1 ç«‹å³ä¿®å¤æªæ–½</h3>
<ol>
<li><strong>è·¯å¾„éªŒè¯å¼ºåŒ–</strong>ï¼š</li>
</ol>
<p>java</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ä½¿ç”¨æ ‡å‡†åŒ–è·¯å¾„è¿›è¡Œæ¯”è¾ƒ</span>
String normalizedPath = Paths<span class="hljs-selector-class">.get</span>(url)<span class="hljs-selector-class">.normalize</span>()<span class="hljs-selector-class">.toString</span>();
</code></pre>
<ol start="2">
<li><strong>RefereréªŒè¯å¢å¼º</strong>ï¼š</li>
</ol>
<p>java</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// éªŒè¯Refererçš„å®Œæ•´æ€§å’Œæ¥æº</span>
<span class="hljs-keyword">if</span> (referer != <span class="hljs-literal">null</span> &amp;&amp; !isValidReferer(referer, serverName)) {
    <span class="hljs-comment">// æ‹’ç»è®¿é—®å¹¶è®°å½•å®¡è®¡æ—¥å¿—</span>
}
</code></pre>
<ol start="3">
<li><strong>ç§»é™¤Ajaxç‰¹ä¾‹é€»è¾‘</strong>ï¼š</li>
</ol>
<p>java</p>
<pre><code class="hljs language-ini" lang="ini">// ç»Ÿä¸€éªŒè¯é€»è¾‘ï¼Œä¸åŒºåˆ†Ajaxå’Œæ™®é€šè¯·æ±‚
String <span class="hljs-attr">lang</span> = CookieUtil.getCookie(request, <span class="hljs-string">"lang"</span>)<span class="hljs-comment">;</span>
if (StringUtils.isBlank(lang)) {
    handleSessionTimeout(response)<span class="hljs-comment">;</span>
    return<span class="hljs-comment">;</span>
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Ubuntu ä¸€é”®åˆ‡æ¢å‰æ—å¤§å­¦é•œåƒæº]]></title>    <link>https://juejin.cn/post/7578820431018213391</link>    <guid>https://juejin.cn/post/7578820431018213391</guid>    <pubDate>2025-12-01T14:32:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578820431018213391" data-draft-id="7578714759337213952" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Ubuntu ä¸€é”®åˆ‡æ¢å‰æ—å¤§å­¦é•œåƒæº"/> <meta itemprop="keywords" content="Linux,Ubuntu"/> <meta itemprop="datePublished" content="2025-12-01T14:32:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤©å®"/> <meta itemprop="url" content="https://juejin.cn/user/187362547083252"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Ubuntu ä¸€é”®åˆ‡æ¢å‰æ—å¤§å­¦é•œåƒæº
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/187362547083252/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤©å®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-01T14:32:08.000Z" title="Mon Dec 01 2025 14:32:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#5f6368;background-image:linear-gradient(90deg,rgba(240,191,213,.1) 3%,transparent 0),linear-gradient(1turn,rgba(240,191,213,.1) 3%,transparent 0);background-size:20px 20px;background-position:50%;letter-spacing:1px;word-spacing:1px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-left:50px;padding-bottom:5px;color:#5f6368}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{position:absolute;left:0;display:block;content:""}.markdown-body h1{font-size:32px;margin-bottom:5px}.markdown-body h1:before{top:0;content:"ğŸ¦„";font-size:32px}.markdown-body h2{padding-bottom:24px;border-bottom:1px solid #ececec}.markdown-body h2:before{top:0;left:8px;content:"ğŸ³";font-size:24px}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{top:-2px;left:8px;content:"ğŸ„";font-size:20px}.markdown-body h4{font-size:16px}.markdown-body h4:before{top:-2px;left:8px;content:"ğŸ¦¥";font-size:18px}.markdown-body h5{font-size:14px}.markdown-body h5:before{top:-2px;left:9px;content:"ğŸ¦©";font-size:16px}.markdown-body h6{font-size:12px;margin-top:5px}.markdown-body h6:before{top:-1px;left:10px;content:"ğŸ§";font-size:14px}.markdown-body p{line-height:1.9;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid rgba(253,121,168,.5);margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#a6accd;background:#292d3e;border-radius:8px}.markdown-body a{text-decoration:none;color:#fd79a8;border-bottom:1px solid #fd79a8;padding:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(253,121,168,.1);color:#ee69a9}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body th{color:#fd79a8}.markdown-body th,.markdown-body tr:hover{background:rgba(253,121,168,.1)}.markdown-body td{min-width:120px}.markdown-body blockquote{position:relative;color:#666;padding:23px;margin:22px 0;border-left:4px solid #ee69a9;background-color:rgba(253,121,168,.1)}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;display:block;font-size:27px;color:#fd79a8;opacity:.8}.markdown-body blockquote:before{left:10px;top:0;content:"â"}.markdown-body blockquote:after{right:10px;bottom:0;content:"â"}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body strong{position:relative;color:#fd79a8}.markdown-body strong:before{content:"Â· "}.markdown-body strong:after{content:" Â·"}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#fd79a8}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#ee69a9}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">Ubuntu ä¸€é”®åˆ‡æ¢å‰æ—å¤§å­¦é•œåƒæºè„šæœ¬</h2>
<p>æœ¬æ–‡æä¾›ä¸€ä¸ª Shell è„šæœ¬ï¼Œç”¨äºä¸€é”®å°† Ubuntu ç³»ç»Ÿçš„è½¯ä»¶æºåˆ‡æ¢ä¸ºå‰æ—å¤§å­¦é•œåƒæºã€‚è¯¥è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆç‰ˆæœ¬æ£€æµ‹ã€åŸæœ‰æºå¤‡ä»½ã€æ–°æºæ›¿æ¢ä»¥åŠç¼“å­˜æ›´æ–°ï¼Œé€‚åˆæ‰€æœ‰ Ubuntu å‘è¡Œç‰ˆï¼Œæ— éœ€æ‰‹åŠ¨ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€ä¸€é”®åˆ‡æ¢è„šæœ¬</h3>
<p>å°†ä»¥ä¸‹ä»£ç ä¿å­˜ä¸º <code>switch_jlu_ubuntu_source.sh</code>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># ä¸€é”®åˆ‡æ¢Ubuntuæºä¸ºå‰æ—å¤§å­¦é•œåƒæºï¼ˆhttps://mirrors.jlu.edu.cn/ubuntu/ï¼‰</span>
<span class="hljs-comment"># é€‚ç”¨ï¼šæ‰€æœ‰Ubuntuå‘è¡Œç‰ˆï¼ˆè‡ªåŠ¨è¯†åˆ«ç‰ˆæœ¬ä»£å·ï¼‰</span>

<span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦ä¸ºrootç”¨æˆ·ï¼ˆä¿®æ”¹æºéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰</span>
<span class="hljs-keyword">if</span> [ <span class="hljs-variable">$EUID</span> -ne 0 ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"é”™è¯¯ï¼šè¯·ä½¿ç”¨rootæƒé™è¿è¡Œæ­¤è„šæœ¬ï¼ˆæ·»åŠ sudoï¼‰ï¼"</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"æ­£ç¡®å‘½ä»¤ï¼šsudo bash æ­¤è„šæœ¬æ–‡ä»¶å.sh"</span>
    <span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># æ­¥éª¤1ï¼šè‡ªåŠ¨æ£€æµ‹Ubuntuç‰ˆæœ¬ä»£å·</span>
CODENAME=$(lsb_release -c | awk <span class="hljs-string">'{print $2}'</span>)
<span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"<span class="hljs-variable">$CODENAME</span>"</span> ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"é”™è¯¯ï¼šæ— æ³•è¯†åˆ«Ubuntuç‰ˆæœ¬ä»£å·ï¼è¯·æ‰‹åŠ¨æ‰§è¡Œ lsb_release -c ç¡®è®¤ç‰ˆæœ¬"</span>
    <span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"âœ… æ£€æµ‹åˆ°ä½ çš„Ubuntuç‰ˆæœ¬ä»£å·ï¼š<span class="hljs-variable">$CODENAME</span>"</span>

<span class="hljs-comment"># æ­¥éª¤2ï¼šå¤‡ä»½åŸæœ‰sources.listï¼ˆé¿å…å‡ºé”™æ— æ³•æ¢å¤ï¼‰</span>
BACKUP_FILE=<span class="hljs-string">"/etc/apt/sources.list.bak.<span class="hljs-subst">$(date +%Y%m%d%H%M%S)</span>"</span>
<span class="hljs-built_in">cp</span> /etc/apt/sources.list <span class="hljs-string">"<span class="hljs-variable">$BACKUP_FILE</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"âœ… åŸæœ‰æºæ–‡ä»¶å·²å¤‡ä»½è‡³ï¼š<span class="hljs-variable">$BACKUP_FILE</span>"</span>

<span class="hljs-comment"># æ­¥éª¤3ï¼šå†™å…¥å‰æ—å¤§å­¦é•œåƒæºé…ç½®</span>
<span class="hljs-built_in">cat</span> &gt; /etc/apt/sources.list &lt;&lt; <span class="hljs-string">EOF
# å‰æ—å¤§å­¦ Ubuntu é•œåƒæºï¼ˆè‡ªåŠ¨é€‚é…ç‰ˆæœ¬ï¼š$CODENAMEï¼‰
deb https://mirrors.jlu.edu.cn/ubuntu/ $CODENAME main restricted universe multiverse
deb https://mirrors.jlu.edu.cn/ubuntu/ $CODENAME-security main restricted universe multiverse
deb https://mirrors.jlu.edu.cn/ubuntu/ $CODENAME-updates main restricted universe multiverse
deb https://mirrors.jlu.edu.cn/ubuntu/ $CODENAME-backports main restricted universe multiverse
# å¯é€‰æºç æºï¼ˆéœ€å¯ç”¨è¯·å–æ¶ˆæ³¨é‡Šï¼‰
# deb-src https://mirrors.jlu.edu.cn/ubuntu/ $CODENAME main restricted universe multiverse
# deb-src https://mirrors.jlu.edu.cn/ubuntu/ $CODENAME-security main restricted universe multiverse
# deb-src https://mirrors.jlu.edu.cn/ubuntu/ $CODENAME-updates main restricted universe multiverse
# deb-src https://mirrors.jlu.edu.cn/ubuntu/ $CODENAME-backports main restricted universe multiverse
EOF</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"âœ… å·²å†™å…¥å‰æ—å¤§å­¦é•œåƒæºé…ç½®ï¼ˆç‰ˆæœ¬ï¼š<span class="hljs-variable">$CODENAME</span>ï¼‰"</span>

<span class="hljs-comment"># æ­¥éª¤4ï¼šæ›´æ–°æºç¼“å­˜ï¼ˆä½¿æ–°æºç”Ÿæ•ˆï¼‰</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"ğŸ”„ æ­£åœ¨æ›´æ–°aptç¼“å­˜ï¼Œè¯·ç¨ç­‰..."</span>
apt update -y

<span class="hljs-comment"># æ£€æŸ¥æ›´æ–°ç»“æœ</span>
<span class="hljs-keyword">if</span> [ $? -eq 0 ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\nğŸ‰ æºåˆ‡æ¢æˆåŠŸï¼å‰æ—å¤§å­¦é•œåƒæºå·²ç”Ÿæ•ˆã€‚"</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\nâŒ æºæ›´æ–°å¤±è´¥ï¼å¯èƒ½æ˜¯ç½‘ç»œ/ç‰ˆæœ¬é—®é¢˜ï¼Œå·²è‡ªåŠ¨æ¢å¤åŸæœ‰æºï¼ˆå¤‡ä»½æ–‡ä»¶ï¼š<span class="hljs-variable">$BACKUP_FILE</span>ï¼‰"</span>
    <span class="hljs-built_in">cp</span> <span class="hljs-string">"<span class="hljs-variable">$BACKUP_FILE</span>"</span> /etc/apt/sources.list
    apt update -y
<span class="hljs-keyword">fi</span>
</code></pre>
<hr/>
<h3 data-id="heading-2">äºŒã€è„šæœ¬ä½¿ç”¨æ–¹æ³•</h3>
<h4 data-id="heading-3">æ–¹æ³• 1ï¼šåœ¨æœåŠ¡å™¨ç›´æ¥åˆ›å»ºè¿è¡Œ</h4>
<ol>
<li><strong>åˆ›å»ºè„šæœ¬æ–‡ä»¶</strong>ï¼š
<pre><code class="hljs language-bash" lang="bash">nano switch_jlu_ubuntu_source.sh
</code></pre>
</li>
<li><strong>ç²˜è´´ä»£ç </strong>ï¼šå°†ä¸Šæ–¹çš„è„šæœ¬å†…å®¹å®Œæ•´å¤åˆ¶å¹¶ç²˜è´´åˆ°ç¼–è¾‘å™¨ä¸­ã€‚</li>
<li><strong>ä¿å­˜é€€å‡º</strong>ï¼šæŒ‰ <code>Ctrl+O</code> å›è½¦ä¿å­˜ï¼Œå†æŒ‰ <code>Ctrl+X</code> é€€å‡ºã€‚</li>
<li><strong>èµ‹äºˆæƒé™å¹¶è¿è¡Œ</strong>ï¼š
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">chmod</span> +x switch_jlu_ubuntu_source.sh
sudo ./switch_jlu_ubuntu_source.sh
</code></pre>
</li>
</ol>
<hr/>
<h3 data-id="heading-4">ä¸‰ã€å¦‚ä½•éªŒè¯åˆ‡æ¢æˆåŠŸ</h3>
<p>è¿è¡Œè„šæœ¬åï¼Œå¯é€šè¿‡ä»¥ä¸‹ä¸‰ä¸ªç»´åº¦éªŒè¯ï¼š</p>
<h4 data-id="heading-5">1. æ£€æŸ¥é…ç½®æ–‡ä»¶</h4>
<p>æŸ¥çœ‹ <code>/etc/apt/sources.list</code>ï¼Œç¡®è®¤æ˜¯å¦åŒ…å«å‰å¤§æºåœ°å€ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹æºæ–‡ä»¶æ ¸å¿ƒå†…å®¹ï¼ˆè¿‡æ»¤æ³¨é‡Šè¡Œï¼Œåªçœ‹æœ‰æ•ˆæºï¼‰</span>
grep -v <span class="hljs-string">'^#'</span> /etc/apt/sources.list | grep mirrors.jlu.edu.cn
</code></pre>
<p><em>é¢„æœŸç»“æœ</em>ï¼šè¾“å‡ºå¤šè¡ŒåŒ…å« <code>mirrors.jlu.edu.cn</code> çš„é…ç½®ã€‚
è¾“å‡ºç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼ˆåŒ…å«å‰å¤§é•œåƒæºåœ°å€ + ä½ çš„ç³»ç»Ÿç‰ˆæœ¬ä»£å·ï¼‰ï¼Œè¯´æ˜é…ç½®æ–‡ä»¶å·²ä¿®æ”¹æˆåŠŸï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">deb https:<span class="hljs-comment">//mirrors.jlu.edu.cn/ubuntu/ noble main restricted universe multiverse</span>
deb https:<span class="hljs-comment">//mirrors.jlu.edu.cn/ubuntu/ noble-security main restricted universe multiverse</span>
deb https:<span class="hljs-comment">//mirrors.jlu.edu.cn/ubuntu/ noble-updates main restricted universe multiverse</span>
deb https:<span class="hljs-comment">//mirrors.jlu.edu.cn/ubuntu/ noble-backports main restricted universe multiverse</span>
</code></pre>
<h4 data-id="heading-6">2. æ£€æŸ¥ APT ç¼“å­˜</h4>
<p>æŸ¥çœ‹è½¯ä»¶åŒ…çš„ä¸‹è½½æ¥æºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">apt-cache policy | grep mirrors.jlu.edu.cn
</code></pre>
<p><em>é¢„æœŸç»“æœ</em>ï¼šæ˜¾ç¤ºå‰æ—å¤§å­¦é•œåƒæºçš„ URLã€‚</p>
<h4 data-id="heading-7">3. å®æˆ˜æµ‹è¯•ä¸‹è½½</h4>
<p>å°è¯•å®‰è£…ä¸€ä¸ªè½¯ä»¶ï¼ˆä¾‹å¦‚ wgetï¼‰ï¼Œè§‚å¯Ÿä¸‹è½½é“¾æ¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo apt install -v wget
</code></pre>
<p><em>é¢„æœŸç»“æœ</em>ï¼šä¸‹è½½æ—¥å¿—ä¸­æ˜¾ç¤ºçš„ URL åº”ä¸º <code>mirrors.jlu.edu.cn</code> å¼€å¤´ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¸¿è’™å¼€å‘ï¼šæ¡ˆä¾‹é›†åˆTabsï¼šè‡ªå®šä¹‰tabså‡¹é™·çƒä½“ æ»‘åŠ¨åŠ¨ç”»]]></title>    <link>https://juejin.cn/post/7578705123208970283</link>    <guid>https://juejin.cn/post/7578705123208970283</guid>    <pubDate>2025-12-01T14:50:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578705123208970283" data-draft-id="7578705123208937515" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¸¿è’™å¼€å‘ï¼šæ¡ˆä¾‹é›†åˆTabsï¼šè‡ªå®šä¹‰tabså‡¹é™·çƒä½“ æ»‘åŠ¨åŠ¨ç”»"/> <meta itemprop="keywords" content="HarmonyOS"/> <meta itemprop="datePublished" content="2025-12-01T14:50:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ±‰å ¡é»„"/> <meta itemprop="url" content="https://juejin.cn/user/4490841452717032"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¸¿è’™å¼€å‘ï¼šæ¡ˆä¾‹é›†åˆTabsï¼šè‡ªå®šä¹‰tabså‡¹é™·çƒä½“ æ»‘åŠ¨åŠ¨ç”»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4490841452717032/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ±‰å ¡é»„
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-01T14:50:31.000Z" title="Mon Dec 01 2025 14:50:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ğŸ¯ æ¡ˆä¾‹é›†åˆTabsï¼šè‡ªå®šä¹‰tabså‡¹é™·çƒä½“ æ»‘åŠ¨åŠ¨ç”»</h3>
<p>ğŸŒ <a href="https://juejin.cn/post/7576130918077857827" target="_blank" title="https://juejin.cn/post/7576130918077857827">æ¡ˆä¾‹é›†åˆTabs</a></p>
<p>ğŸšª <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Ftraining%2FclassDetail%2Fbdf7811f41f3418889d221eb42af1eb7%3Ftype%3D1%3Fha_source%3Dhmosclass%26ha_sourceId%3D89000248" target="_blank" title="https://developer.huawei.com/consumer/cn/training/classDetail/bdf7811f41f3418889d221eb42af1eb7?type=1?ha_source=hmosclass&amp;ha_sourceId=89000248" ref="nofollow noopener noreferrer">æœ€è¿‘å¼€å¯äº†å­¦å‘˜ç­çº§ç‚¹æˆ‘æ¬¢è¿åŠ å…¥ï¼ˆå­¦ä¹ ç›¸å…³çŸ¥è¯†å¯è·å¾—å®šåˆ¶ç¤¼ç›’ï¼‰</a></p>
<p>ğŸ·ï¸ <strong>æ•ˆæœå›¾</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff530b86017142c09d780e07c96d85a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rGJ5aCh6buE:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765205430&amp;x-signature=BBW49st%2B%2FF%2BFpCpVpht3WvKGjGI%3D" alt="" loading="lazy"/></p>
<p>ğŸ“– <strong>å‚è€ƒ</strong></p>
<ul>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fharmonyos-cases%2Fcases%2Fblob%2Fmaster%2FCommonAppDevelopment%2Ffeature%2Fcustomdrawtabbar%2Fsrc%2Fmain%2Fets%2Fcomponents%2FtabsConcaveCircle%2FTabsConcaveCircle.ets" target="_blank" title="https://gitee.com/harmonyos-cases/cases/blob/master/CommonAppDevelopment/feature/customdrawtabbar/src/main/ets/components/tabsConcaveCircle/TabsConcaveCircle.ets" ref="nofollow noopener noreferrer">å‡¹é™·éƒ¨åˆ†å€Ÿé‰´äº†å®˜æ–¹Case</a></strong></p>
</li>
<li>
<p><strong><a href="https://juejin.cn/post/7573899782803161134" target="_blank" title="https://juejin.cn/post/7573899782803161134">æµ…è°ˆé€‚é…æ²‰æµ¸å¼é¡µé¢</a></strong></p>
</li>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Fdoc%2Fharmonyos-references%2Fjs-apis-animator%23animatorresult" target="_blank" title="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-animator#animatorresult" ref="nofollow noopener noreferrer">AnimatorResultï¼ˆç»„ä»¶åŠ¨ç”»æ•ˆæœï¼‰</a></strong></p>
</li>
<li>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Fdoc%2Fharmonyos-references%2Fts-canvasrenderingcontext2d" target="_blank" title="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-canvasrenderingcontext2d" ref="nofollow noopener noreferrer">CanvasRenderingContext2D</a></strong></p>
</li>
</ul>
<p>ğŸ§©  <strong>æ‹†è§£</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AnimatorResult</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.animator'</span>;
<span class="hljs-keyword">import</span> { display, <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;
<span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;

<span class="hljs-comment">/**
 * å®‰å…¨åŒºé«˜åº¦
 */</span>
interface <span class="hljs-title class_">AvoidArea</span> {
  <span class="hljs-attr">topRectHeight</span>: number
  <span class="hljs-attr">bottomRectHeight</span>: number
}

<span class="hljs-comment">/**
 * å®‰å…¨ç±»å‹è¾¹è·æšä¸¾
 * statusBarType çŠ¶æ€æ 
 * navBarType å¯¼èˆªæ 
 */</span>
<span class="hljs-keyword">const</span> statusBarType = <span class="hljs-variable language_">window</span>.<span class="hljs-property">AvoidAreaType</span>.<span class="hljs-property">TYPE_SYSTEM</span>
<span class="hljs-keyword">const</span> navBarType = <span class="hljs-variable language_">window</span>.<span class="hljs-property">AvoidAreaType</span>.<span class="hljs-property">TYPE_NAVIGATION_INDICATOR</span>

<span class="hljs-comment">/**
 * tabsæ•°æ®
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">mockData</span>: string[] = [<span class="hljs-string">'è´­ç‰©'</span>, <span class="hljs-string">'ä½“è‚²'</span>, <span class="hljs-string">'æœè£…'</span>, <span class="hljs-string">'å†›äº‹'</span>]

@<span class="hljs-title class_">Component</span>
<span class="hljs-keyword">export</span> struct <span class="hljs-title class_">TabsConcaveBallCase</span> {
  <span class="hljs-comment">/**
   * UIä¸Šä¸‹æ–‡
   */</span>
  private context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>()?.<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>
  <span class="hljs-comment">/**
   * çª—å£å¯¹è±¡
   */</span>
  private windowClass = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">windowStage</span>.<span class="hljs-title function_">getMainWindowSync</span>()
  <span class="hljs-comment">/**
   * å½“å‰é€‰ä¸­çš„Tabsä¸‹æ ‡ï¼ˆè¿˜æœªåˆ‡æ¢åŠ¨ç”»å‰è·å–ï¼‰
   */</span>
  @<span class="hljs-title class_">State</span> <span class="hljs-attr">animationStartIdx</span>: number = <span class="hljs-number">0</span>
  <span class="hljs-comment">/**
   * å®‰å…¨åŒºé«˜åº¦å¯¹è±¡ï¼ˆçŠ¶æ€æ ã€å¯¼èˆªæ ï¼‰
   */</span>
  @<span class="hljs-title class_">State</span> <span class="hljs-attr">avoidArea</span>: <span class="hljs-title class_">AvoidArea</span> = { <span class="hljs-attr">topRectHeight</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">bottomRectHeight</span>: <span class="hljs-number">0</span> }
  <span class="hljs-comment">/**
   * tabsæ„é€ å™¨
   */</span>
  private <span class="hljs-attr">tabsController</span>: <span class="hljs-title class_">TabsController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TabsController</span>()
  <span class="hljs-comment">/**
   * èƒŒæ™¯è‰² æ–‡å­— ï½œ å ä½
   */</span>
  private <span class="hljs-attr">tabsBgColor</span>: string = <span class="hljs-string">'#ff818080'</span>
  <span class="hljs-comment">/**
   * åŠ¨ç”»æŒç»­æ—¶é—´ æ–‡å­— ï½œ å‡¹é™· è¿‡æ¸¡
   */</span>
  private <span class="hljs-attr">animationDuration</span>: number = <span class="hljs-number">300</span>
  <span class="hljs-comment">/**
   * å‡¸å‡ºçƒxè½´ä½ç½®
   */</span>
  @<span class="hljs-title class_">State</span> <span class="hljs-attr">ballCenterX</span>: number = <span class="hljs-number">0</span>
  <span class="hljs-comment">/**
   * é…ç½®CanvasRenderingContext2Då¯¹è±¡çš„å‚æ•°ï¼ŒåŒ…æ‹¬æ˜¯å¦å¼€å¯æŠ—é”¯é½¿ã€‚
   */</span>
  private <span class="hljs-attr">canvasContext</span>: <span class="hljs-title class_">CanvasRenderingContext2D</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CanvasRenderingContext2D</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RenderingContextSettings</span>(<span class="hljs-literal">true</span>))
  <span class="hljs-comment">/**
   * ç”»å¸ƒåŠ¨ç”»
   */</span>
  private <span class="hljs-attr">canvasAnimator</span>: <span class="hljs-title class_">AnimatorResult</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>
  <span class="hljs-comment">/**
   * å½“å‰å‡¹æ§½ä½ç½®
   */</span>
  @<span class="hljs-title class_">State</span> <span class="hljs-attr">canvasConcaveAreaX</span>: number = <span class="hljs-number">0</span>

  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-keyword">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">windowClass</span>.<span class="hljs-title function_">setWindowLayoutFullScreen</span>(<span class="hljs-literal">true</span>)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">windowClass</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'avoidAreaChange'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onAvoidAreaChange</span>)
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setAvoidArea</span>()
  }

  <span class="hljs-title function_">aboutToDisappear</span>(): <span class="hljs-keyword">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">windowClass</span>.<span class="hljs-title function_">setWindowLayoutFullScreen</span>(<span class="hljs-literal">false</span>)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">windowClass</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'avoidAreaChange'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onAvoidAreaChange</span>)
  }

  <span class="hljs-comment">/**
   * è®¾ç½®çŠ¶æ€æ å’Œå¯¼èˆªæ é¿è®©åŒºåŸŸ &amp;&amp; ç›‘å¬ä¸åŒè®¾å¤‡é¿è®©åŒºåŸŸçš„å˜åŒ–
   */</span>
  <span class="hljs-title function_">setAvoidArea</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> statusBarArea = <span class="hljs-variable language_">this</span>.<span class="hljs-property">windowClass</span>.<span class="hljs-title function_">getWindowAvoidArea</span>(statusBarType)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">avoidArea</span>.<span class="hljs-property">topRectHeight</span> = statusBarArea.<span class="hljs-property">topRect</span>.<span class="hljs-property">height</span>
    <span class="hljs-keyword">const</span> navBarArea = <span class="hljs-variable language_">this</span>.<span class="hljs-property">windowClass</span>.<span class="hljs-title function_">getWindowAvoidArea</span>(navBarType)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">avoidArea</span>.<span class="hljs-property">bottomRectHeight</span> = navBarArea.<span class="hljs-property">bottomRect</span>.<span class="hljs-property">height</span>
  }

  onAvoidAreaChange = <span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-variable language_">window</span>.AvoidAreaOptions</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (data.<span class="hljs-property">type</span> === statusBarType) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">avoidArea</span>.<span class="hljs-property">topRectHeight</span> = data.<span class="hljs-property">area</span>.<span class="hljs-property">topRect</span>.<span class="hljs-property">height</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data.<span class="hljs-property">type</span> === navBarType) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">avoidArea</span>.<span class="hljs-property">bottomRectHeight</span> = data.<span class="hljs-property">area</span>.<span class="hljs-property">bottomRect</span>.<span class="hljs-property">height</span>
    }
  }

  <span class="hljs-comment">/**
   * tab
   * <span class="hljs-doctag">@param</span> <span class="hljs-variable">label</span>
   * <span class="hljs-doctag">@param</span> <span class="hljs-variable">idx</span>
   */</span>
  @<span class="hljs-title class_">Builder</span>
  <span class="hljs-title function_">tabBuilder</span>(<span class="hljs-params">label: string, idx: number</span>) {
    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">5</span> }) {
      <span class="hljs-title class_">Text</span>(label)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">animationStartIdx</span> === idx ? <span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span> : <span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">animationStartIdx</span> === idx ? <span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Medium</span> : <span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Normal</span>)
        .<span class="hljs-title function_">offset</span>({
          <span class="hljs-attr">y</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">animationStartIdx</span> === idx ? -<span class="hljs-number">15</span> : <span class="hljs-number">0</span>
        })
        .<span class="hljs-title function_">animation</span>({ <span class="hljs-attr">duration</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">animationDuration</span>, <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">Smooth</span> })

      <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.startIcon'</span>))
        .<span class="hljs-title function_">syncLoad</span>(<span class="hljs-literal">true</span>)
        .<span class="hljs-title function_">draggable</span>(<span class="hljs-literal">false</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-number">20</span>)
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">20</span>)
    }
    .<span class="hljs-title function_">height</span>(<span class="hljs-number">60</span>)
    .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">tabsController</span>.<span class="hljs-title function_">changeIndex</span>(idx)
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createAnimation</span>()
    })
    .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)
    .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)
  }

  <span class="hljs-comment">/**
   * åº”ç”¨äºå ä½
   */</span>
  @<span class="hljs-title class_">Builder</span>
  <span class="hljs-title function_">slotBuilder</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Text</span>()
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">height</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">px2vp</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">avoidArea</span>.<span class="hljs-property">bottomRectHeight</span>))
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">tabsBgColor</span>)
  }

  <span class="hljs-comment">/**
   * è·å–èœå•é€‰é¡¹çš„ä¸­é—´ç‚¹
   */</span>
  private <span class="hljs-title function_">getMenuCenterX</span>(): number {
    <span class="hljs-keyword">const</span> itemWidth = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">px2vp</span>(display.<span class="hljs-title function_">getDefaultDisplaySync</span>().<span class="hljs-property">width</span>) / mockData.<span class="hljs-property">length</span>
    <span class="hljs-comment">// è·å–å½“å‰ä¸‹æ ‡é¡¹çš„ä¸­å¿ƒä½ç½®</span>
    <span class="hljs-keyword">return</span> (itemWidth * <span class="hljs-variable language_">this</span>.<span class="hljs-property">animationStartIdx</span>) + (itemWidth / <span class="hljs-number">2</span>)
  }

  <span class="hljs-comment">/**
   * è·å–å…¼å®¹æ€§å®½åº¦
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type"> number </span>} <span class="hljs-variable">width</span>
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type"> number </span>} <span class="hljs-variable">height</span>
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type"> number </span>} <span class="hljs-variable">menuLength</span>
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type"> number </span>} é€‚é…å½“èœå•æ•°é‡ï¼Œå–èœå•çš„å®½åº¦å’Œtabsé«˜åº¦ï¼ŒæŠŠå°æ•°å€¼è¿”å›ä½œä¸ºåç»­ä½¿ç”¨
   */</span>
  private <span class="hljs-title function_">getMinWidth</span>(<span class="hljs-attr">width</span>: number, <span class="hljs-attr">height</span>: number, <span class="hljs-attr">menuLength</span>: number = <span class="hljs-number">0</span>): number {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(width / menuLength, height)
  }

  <span class="hljs-comment">/**
   *
   * åˆ›å»ºç§»åŠ¨åŠ¨ç”»
   * ç”¨äºç§»åŠ¨åœ†çƒå’Œé‡ç»˜canvasä¸­å‡¹é™·éƒ¨åˆ†
   * <span class="hljs-doctag">@param</span> <span class="hljs-variable">duration</span>
   */</span>
  private <span class="hljs-title function_">createAnimation</span>(<span class="hljs-params">duration?: number</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasAnimator</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">createAnimator</span>({
      <span class="hljs-attr">duration</span>: duration ?? <span class="hljs-variable language_">this</span>.<span class="hljs-property">animationDuration</span>,
      <span class="hljs-attr">easing</span>: <span class="hljs-string">"ease"</span>,
      <span class="hljs-attr">delay</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// åŠ¨ç”»ç­‰å¾…æ—¶é•¿</span>
      <span class="hljs-attr">fill</span>: <span class="hljs-string">"forwards"</span>,
      <span class="hljs-attr">direction</span>: <span class="hljs-string">"normal"</span>,
      <span class="hljs-attr">iterations</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// åŠ¨ç”»æ‰§è¡Œæ¬¡æ•°</span>
      <span class="hljs-attr">begin</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasConcaveAreaX</span>,
      <span class="hljs-attr">end</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMenuCenterX</span>()
    })

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasAnimator</span>.<span class="hljs-property">onFrame</span> = <span class="hljs-function">(<span class="hljs-params">value: number</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasConcaveAreaX</span> = value
      <span class="hljs-comment">// å‡å»å‡¸å‡ºçƒä½“çš„ä¸€åŠ ï¼ˆå±…ä¸­ï¼‰</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">ballCenterX</span> = value - <span class="hljs-number">25</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createCanvas</span>()
    }

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasAnimator</span>.<span class="hljs-title function_">play</span>()
  }

  <span class="hljs-comment">/**
   * åˆ›å»ºcanvas èƒŒæ™¯ å’Œ å‡¹æ§½
   */</span>
  private <span class="hljs-title function_">createCanvas</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasContext</span>.<span class="hljs-title function_">reset</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">canvasCreateRectangle</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">canvasClipGroove</span>()
  }

  <span class="hljs-comment">/**
   * ç»˜åˆ¶ Canvas å¤§å°å’Œå¡«å……é¢œè‰²
   */</span>
  private <span class="hljs-title function_">canvasCreateRectangle</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// CanvasRenderingContext2D</span>
    <span class="hljs-keyword">const</span> ctx = <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasContext</span>
    <span class="hljs-comment">// canvas å®½åº¦</span>
    <span class="hljs-keyword">const</span> cW = ctx.<span class="hljs-property">width</span>
    <span class="hljs-comment">// canvas é«˜åº¦</span>
    <span class="hljs-keyword">const</span> cH = ctx.<span class="hljs-property">height</span>

    ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, cW, cH)
    ctx.<span class="hljs-title function_">beginPath</span>()
    ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
    ctx.<span class="hljs-title function_">lineTo</span>(cW, <span class="hljs-number">0</span>)
    ctx.<span class="hljs-title function_">lineTo</span>(cW, cH)
    ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">0</span>, cH)
    ctx.<span class="hljs-title function_">closePath</span>()
    ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">tabsBgColor</span> <span class="hljs-comment">// è®¾ç½®å¡«å……é¢œè‰²</span>
    ctx.<span class="hljs-title function_">fill</span>()
    ctx.<span class="hljs-title function_">closePath</span>()
  }

  <span class="hljs-comment">/**
   * ç»™ Canvas åˆ‡å‰²æ‚¬æµ®æ§½
   * <span class="hljs-doctag">TODO:</span> çŸ¥è¯†ç‚¹ï¼šé€šè¿‡ clip æ¥å®ç°åˆ‡å‰²åä¿ç•™çš„åœ†å¼§å®ç°å¹³æ»‘è¿‡æ¸¡
   */</span>
  private <span class="hljs-title function_">canvasClipGroove</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// CanvasRenderingContext2D</span>
    <span class="hljs-keyword">const</span> ctx = <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasContext</span>
    <span class="hljs-comment">// canvas å®½åº¦</span>
    <span class="hljs-keyword">const</span> cW = ctx.<span class="hljs-property">width</span>
    <span class="hljs-comment">// canvas é«˜åº¦</span>
    <span class="hljs-keyword">const</span> cH = ctx.<span class="hljs-property">height</span>
    <span class="hljs-comment">// åŠå¾„</span>
    <span class="hljs-keyword">const</span> radius = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMinWidth</span>(cW, cH, mockData.<span class="hljs-property">length</span>) / <span class="hljs-number">2</span>
    <span class="hljs-comment">// ä¸­é—´åœ†çš„ä¸­å¿ƒç‚¹</span>
    <span class="hljs-keyword">const</span> circleCenter = <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasConcaveAreaX</span> || cW / <span class="hljs-number">2</span>
    <span class="hljs-comment">// è®¡ç®—å·¦å³ä¿©å€’è§’çš„xè½´è·ç¦»åœ†å¿ƒçš„è·ç¦»</span>
    <span class="hljs-keyword">const</span> aroundCenter = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(radius * <span class="hljs-number">2</span>, <span class="hljs-number">2</span>) - <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(radius, <span class="hljs-number">2</span>))
    <span class="hljs-comment">/**
     * canvas ç»˜åˆ¶çš„åº¦æ•°  1Â°
     * è¿™é‡Œæ˜¯ 1Â° å¦‚æœéœ€è¦å¤šå°‘åº¦ ç›´æ¥ * å…·ä½“æ•°å­—å³å¯
     */</span>
    <span class="hljs-keyword">const</span> chamferDegrees1 = <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> / <span class="hljs-number">180</span>
    <span class="hljs-comment">// 330Â°</span>
    <span class="hljs-keyword">const</span> chamferDegrees330 = chamferDegrees1 * <span class="hljs-number">330</span>
    <span class="hljs-comment">// 270Â°</span>
    <span class="hljs-keyword">const</span> chamferDegrees270 = chamferDegrees1 * <span class="hljs-number">270</span>
    <span class="hljs-comment">// 210Â°</span>
    <span class="hljs-keyword">const</span> chamferDegrees210 = chamferDegrees1 * <span class="hljs-number">210</span>
    <span class="hljs-comment">// 150Â°</span>
    <span class="hljs-keyword">const</span> chamferDegrees150 = chamferDegrees1 * <span class="hljs-number">150</span>
    <span class="hljs-comment">// 30Â°</span>
    <span class="hljs-keyword">const</span> chamferDegrees30 = chamferDegrees1 * <span class="hljs-number">30</span>

    ctx.<span class="hljs-title function_">beginPath</span>()
    <span class="hljs-comment">// å·¦è¾¹åœ†å¼§çº¿</span>
    ctx.<span class="hljs-title function_">arc</span>(circleCenter - aroundCenter, radius, radius, chamferDegrees270, chamferDegrees330)
    <span class="hljs-comment">// ä¸­é—´åœ†å¼§çº¿</span>
    ctx.<span class="hljs-title function_">arc</span>(circleCenter, <span class="hljs-number">0</span>, radius, chamferDegrees30, chamferDegrees150)
    <span class="hljs-comment">// å³è¾¹åœ†å¼§çº¿</span>
    ctx.<span class="hljs-title function_">arc</span>(circleCenter + aroundCenter, radius, radius, chamferDegrees210, chamferDegrees270)
    ctx.<span class="hljs-title function_">closePath</span>()
    <span class="hljs-comment">// åº”ç”¨å‰ªè£è·¯å¾„</span>
    ctx.<span class="hljs-title function_">clip</span>()
    <span class="hljs-comment">// æ¸…é™¤å‰ªè£åŒºåŸŸå†…çš„éƒ¨åˆ†</span>
    ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, cW, cH)
  }

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Stack</span>({ <span class="hljs-attr">alignContent</span>: <span class="hljs-title class_">Alignment</span>.<span class="hljs-property">BottomStart</span> }) {
      <span class="hljs-title class_">Tabs</span>({ <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">tabsController</span> }) {
        <span class="hljs-title class_">ForEach</span>(mockData, <span class="hljs-function">(<span class="hljs-params">item: string</span>) =&gt;</span> {
          <span class="hljs-title class_">TabContent</span>() {
            <span class="hljs-title class_">Column</span>() {
              <span class="hljs-title class_">Text</span>(item)
                .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
                .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)
                .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
            }
            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
            .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
            .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)
            .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Brown</span>)
          }
        })
      }
      .<span class="hljs-title function_">barHeight</span>(<span class="hljs-number">0</span>)
      <span class="hljs-comment">// å…³é”®ï¼šåˆ‡æ¢åŠ¨ç”»å¼€å§‹æ—¶è§¦å‘è¯¥å›è°ƒï¼šè§£å†³åˆ‡æ¢tabså»¶è¿Ÿçš„é—®é¢˜</span>
      .<span class="hljs-title function_">onAnimationStart</span>(<span class="hljs-function">(<span class="hljs-params">idx: number, targetIndex: number</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (idx === targetIndex) {
          <span class="hljs-keyword">return</span>
        }
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">animationStartIdx</span> = targetIndex
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createAnimation</span>()
      })

      <span class="hljs-title class_">Column</span>() {
        <span class="hljs-title class_">Stack</span>() {
          <span class="hljs-comment">// èƒŒæ™¯ -  å‡¹æ§½</span>
          <span class="hljs-title class_">Canvas</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvasContext</span>)
            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
            .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
            <span class="hljs-comment">// duration ç¬¬ä¸€æ¬¡åˆ›å»ºçš„æ—¶å€™ä¸ç»™åŠ¨ç”»</span>
            .<span class="hljs-title function_">onReady</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createAnimation</span>(<span class="hljs-number">0</span>))

          <span class="hljs-comment">// å‡¸å‡ºçƒä½“</span>
          <span class="hljs-title class_">Text</span>()
            .<span class="hljs-title function_">width</span>(<span class="hljs-number">50</span>)
            .<span class="hljs-title function_">aspectRatio</span>(<span class="hljs-number">1</span>)
            .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">tabsBgColor</span>)
            .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">25</span>)
            .<span class="hljs-title function_">position</span>({
              <span class="hljs-attr">y</span>: -<span class="hljs-number">25</span>,
              <span class="hljs-attr">x</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">ballCenterX</span>
            })

          <span class="hljs-comment">// è‡ªå®šä¹‰tabs</span>
          <span class="hljs-title class_">Row</span>() {
            <span class="hljs-title class_">ForEach</span>(mockData, <span class="hljs-function">(<span class="hljs-params">item: string, idx: number</span>) =&gt;</span> {
              <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">tabBuilder</span>(item, idx)
            })
          }
          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
        }
        .<span class="hljs-title function_">height</span>(<span class="hljs-number">60</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)

        <span class="hljs-comment">// å®‰å…¨è¾¹è·å ä½-æœªåœ¨æœ€å¤§å®¹å™¨è®¾ç½®èƒŒæ™¯è§„é¿å‡¹é™·åŒºåŸŸè¢«è¦†ç›–</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">slotBuilder</span>()
      }
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">top</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">avoidArea</span>.<span class="hljs-property">topRectHeight</span> + <span class="hljs-string">'px'</span> })
  }
}

</code></pre>
<p>ğŸŒ¸ğŸŒ¼ğŸŒº</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰‹å†™Springäº‹åŠ¡æ¡†æ¶ï¼ˆä¸‰ï¼‰ç†è§£äº‹åŠ¡ä¼ æ’­è¡Œä¸º:ä»ä¸€ä¸ªConnectionåˆ°ä¸¤ä¸ªConnection]]></title>    <link>https://juejin.cn/post/7578699975414431744</link>    <guid>https://juejin.cn/post/7578699975414431744</guid>    <pubDate>2025-12-01T23:47:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578699975414431744" data-draft-id="7578700798744870946" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹å†™Springäº‹åŠ¡æ¡†æ¶ï¼ˆä¸‰ï¼‰ç†è§£äº‹åŠ¡ä¼ æ’­è¡Œä¸º:ä»ä¸€ä¸ªConnectionåˆ°ä¸¤ä¸ªConnection"/> <meta itemprop="keywords" content="åç«¯,æ¶æ„,Spring Boot"/> <meta itemprop="datePublished" content="2025-12-01T23:47:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹å†™Springäº‹åŠ¡æ¡†æ¶ï¼ˆä¸‰ï¼‰ç†è§£äº‹åŠ¡ä¼ æ’­è¡Œä¸º:ä»ä¸€ä¸ªConnectionåˆ°ä¸¤ä¸ªConnection
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-01T23:47:25.000Z" title="Mon Dec 01 2025 23:47:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å†™åœ¨å‰é¢</h2>
<p>ä¸Šæ¬¡å†™äº†ä¸ªæ‰‹å†™Springäº‹åŠ¡çš„ç¬¬ä¸€ç‰ˆ,å®ç°äº†æœ€åŸºç¡€çš„REQUIREDå’ŒSUPPORTSã€‚å½“æ—¶è§‰å¾—æŒºæœ‰æˆå°±æ„Ÿçš„,ç»“æœæœ‹å‹è¯´:"å°±è¿™?ç”Ÿäº§ç¯å¢ƒé‡Œé‚£äº›åµŒå¥—äº‹åŠ¡ã€ç‹¬ç«‹æäº¤çš„åœºæ™¯æ€ä¹ˆåŠ?"</p>
<p>å¥½å§,ç¡®å®,ç¬¬ä¸€ç‰ˆåªæ˜¯ä¸ªç©å…·ã€‚è¿™æ¬¡æˆ‘ä»¬æ¥ç‚¹çœŸæ ¼çš„â€”â€”æŠŠSpringé‚£7ç§ä¼ æ’­è¡Œä¸ºå…¨éƒ¨æ‰‹å†™ä¸€é,çœ‹çœ‹å®ƒåº•å±‚åˆ°åº•æ˜¯æ€ä¹ˆç©çš„ã€‚</p>
<p>å†™å®Œä¹‹åæˆ‘å‘ç°,å…¶å®æœ¬è´¨å°±ä¸€å¥è¯:<strong>æœ‰äº›åœºæ™¯éœ€è¦1ä¸ªConnection,æœ‰äº›åœºæ™¯éœ€è¦2ä¸ªConnection,æ‰€ä»¥éœ€è¦ç”¨æ ˆæ¥ç®¡ç†è¿™äº›Connectionçš„é¡ºåºã€‚</strong> å°±è¿™ä¹ˆç®€å•!</p>
<h2 data-id="heading-1">å…ˆè¯´è¯´ç¬¬ä¸€ç‰ˆçš„é—®é¢˜</h2>
<p>ç¬¬ä¸€ç‰ˆç”¨çš„æ˜¯æœ€ç®€å•çš„ThreadLocal:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç¬¬ä¸€ç‰ˆ:å•è¿æ¥ç®¡ç†</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;ConnectionHolder&gt; CONTEXT = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
</code></pre>
<p>è¿™æ ·å†™çš„é—®é¢˜æ˜¯:<strong>åªèƒ½ç®¡ç†ä¸€ä¸ªäº‹åŠ¡</strong>ã€‚</p>
<p>æ¯”å¦‚è¿™ä¸ªåœºæ™¯:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Transactional</span>  <span class="hljs-comment">// å¤–å±‚äº‹åŠ¡,ç”¨conn1</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">()</span> {
    insertOrder();  <span class="hljs-comment">// ç”¨conn1</span>
    
    <span class="hljs-meta">@Transactional(propagation = REQUIRES_NEW)</span>  <span class="hljs-comment">// å†…å±‚æƒ³ç”¨conn2</span>
    logService.saveLog();  <span class="hljs-comment">// ä½†æ˜¯ThreadLocalè¿˜æ˜¯conn1!</span>
}
</code></pre>
<p>æƒ³å¼€æ–°äº‹åŠ¡?å¯¹ä¸èµ·,ThreadLocalåªèƒ½å­˜ä¸€ä¸ªConnectionHolder,æ²¡åŠæ³•!</p>
<h2 data-id="heading-2">è§£å†³æ–¹æ¡ˆ:ä»å•ä¸ªåˆ°æ ˆ</h2>
<p>åæ¥æˆ‘æƒ³æ˜ç™½äº†:<strong>æ—¢ç„¶ä¸€ä¸ªå­˜ä¸ä¸‹,é‚£å°±ç”¨æ ˆå‘—!</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç¬¬äºŒç‰ˆ:æ ˆç»“æ„ç®¡ç†</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;Deque&lt;ConnectionHolder&gt;&gt; CONTEXT = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆæ˜¯æ ˆ?</strong></p>
<p>å› ä¸ºäº‹åŠ¡çš„åµŒå¥—å…³ç³»å¤©ç„¶å°±æ˜¯æ ˆç»“æ„:</p>
<ul>
<li>å¤–å±‚äº‹åŠ¡å…ˆå¼€ â†’ push(conn1)</li>
<li>å†…å±‚äº‹åŠ¡å¼€å¯ â†’ push(conn2)</li>
<li>å†…å±‚äº‹åŠ¡å®Œæˆ â†’ pop(conn2)</li>
<li>å¤–å±‚äº‹åŠ¡å®Œæˆ â†’ pop(conn1)</li>
</ul>
<p><strong>å…ˆè¿›åå‡º,å®Œç¾!</strong></p>
<h2 data-id="heading-3">æ”¹é€ TransactionContext</h2>
<h3 data-id="heading-4">åŸºæœ¬çš„pushå’Œpop</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">push</span><span class="hljs-params">(ConnectionHolder holder)</span> {
    Deque&lt;ConnectionHolder&gt; stack = CONTEXT.get();
    <span class="hljs-keyword">if</span> (stack == <span class="hljs-literal">null</span>) {
        stack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayDeque</span>&lt;&gt;();
        CONTEXT.set(stack);
    }
    stack.push(holder);
    
    <span class="hljs-comment">// åŠ ä¸ªæ—¥å¿—,è°ƒè¯•çš„æ—¶å€™è¶…æœ‰ç”¨</span>
    System.out.println(<span class="hljs-string">"[Push] Connection="</span> + holder.getConnection().hashCode() 
        + <span class="hljs-string">", æ ˆæ·±åº¦="</span> + stack.size());
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ConnectionHolder <span class="hljs-title function_">pop</span><span class="hljs-params">()</span> {
    Deque&lt;ConnectionHolder&gt; stack = CONTEXT.get();
    <span class="hljs-keyword">if</span> (stack == <span class="hljs-literal">null</span> || stack.isEmpty()) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    <span class="hljs-type">ConnectionHolder</span> <span class="hljs-variable">holder</span> <span class="hljs-operator">=</span> stack.pop();
    
    System.out.println(<span class="hljs-string">"[Pop] Connection="</span> + holder.getConnection().hashCode() 
        + <span class="hljs-string">", å‰©ä½™æ·±åº¦="</span> + stack.size());
    
    <span class="hljs-comment">// æ ˆç©ºäº†å°±æ¸…ç†ThreadLocal,é˜²æ­¢å†…å­˜æ³„æ¼</span>
    <span class="hljs-keyword">if</span> (stack.isEmpty()) {
        CONTEXT.remove();
    }
    
    <span class="hljs-keyword">return</span> holder;
}
</code></pre>
<p><strong>è¿™é‡Œæœ‰ä¸ªå°æŠ€å·§</strong>:æ—¥å¿—é‡Œæ‰“å°Connectionçš„hashCode,è¿™æ ·è°ƒè¯•çš„æ—¶å€™èƒ½æ¸…æ¥šçœ‹åˆ°æ˜¯ä¸æ˜¯åŒä¸€ä¸ªè¿æ¥ã€‚</p>
<h3 data-id="heading-5">æŒ‚èµ·å’Œæ¢å¤(è¿™æ˜¯ä¸ªéš¾ç‚¹)</h3>
<p>REQUIRES_NEWéœ€è¦"æŒ‚èµ·"å½“å‰äº‹åŠ¡,ç­‰å†…å±‚äº‹åŠ¡å®Œæˆåå†"æ¢å¤"ã€‚</p>
<p>æˆ‘ä¸€å¼€å§‹æ²¡ç†è§£ä»€ä¹ˆå«"æŒ‚èµ·",åæ¥å‘ç°<strong>å…¶å®å°±æ˜¯æŠŠæ ˆé¡¶å…ƒç´ æš‚æ—¶æ‹¿å‡ºæ¥,ç”¨å®Œå†æ”¾å›å»</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SuspendedResourcesHolder <span class="hljs-title function_">suspend</span><span class="hljs-params">()</span> {
    Deque&lt;ConnectionHolder&gt; stack = CONTEXT.get();
    <span class="hljs-keyword">if</span> (stack == <span class="hljs-literal">null</span> || stack.isEmpty()) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-comment">// ä»æ ˆé¡¶æ‹¿å‡ºæ¥(ä½†ä¸å…³é—­è¿æ¥)</span>
    <span class="hljs-type">ConnectionHolder</span> <span class="hljs-variable">holder</span> <span class="hljs-operator">=</span> stack.pop();
    
    System.out.println(<span class="hljs-string">"[Suspend] æŒ‚èµ· Connection="</span> + holder.getConnection().hashCode());
    
    <span class="hljs-comment">// ç”¨ä¸ªåŒ…è£…ç±»å­˜èµ·æ¥</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SuspendedResourcesHolder</span>(holder);
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">resume</span><span class="hljs-params">(SuspendedResourcesHolder suspended)</span> {
    <span class="hljs-keyword">if</span> (suspended == <span class="hljs-literal">null</span> || suspended.getHolder() == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-type">ConnectionHolder</span> <span class="hljs-variable">holder</span> <span class="hljs-operator">=</span> suspended.getHolder();
    
    System.out.println(<span class="hljs-string">"[Resume] æ¢å¤ Connection="</span> + holder.getConnection().hashCode());
    
    <span class="hljs-comment">// é‡æ–°å‹å›æ ˆé‡Œ</span>
    push(holder);
}
</code></pre>
<p><strong>ç”»ä¸ªå›¾å°±æ¸…æ¥šäº†:</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant Stack as äº‹åŠ¡æ ˆ
    participant Conn1 as Connection1
    participant Conn2 as Connection2
    
    Note over Stack: åˆå§‹çŠ¶æ€:ç©º
    
    Stack-&gt;&gt;Conn1: push(conn1)
    Note over Stack: [conn1]
    
    Stack-&gt;&gt;Conn1: suspend()
    Note over Stack: []
    Note over Conn1: è¢«æš‚å­˜åˆ°suspendedå˜é‡
    
    Stack-&gt;&gt;Conn2: push(conn2)
    Note over Stack: [conn2]
    
    Stack-&gt;&gt;Conn2: pop(conn2)
    Note over Stack: []
    
    Stack-&gt;&gt;Conn1: resume(suspended)
    Note over Stack: [conn1]
</code></pre>
<h2 data-id="heading-6">ConnectionHolderå¢åŠ Savepointæ”¯æŒ</h2>
<p>NESTEDä¼ æ’­ç”¨çš„æ˜¯Savepoint(ä¿å­˜ç‚¹)æœºåˆ¶,è¿™ä¸ªä¹Ÿéœ€è¦æ ˆæ¥ç®¡ç†ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆ?</strong> å› ä¸ºå¯èƒ½æœ‰åµŒå¥—çš„åµŒå¥—!</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConnectionHolder</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Connection connection;
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">rollbackOnly</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-comment">// ä¿å­˜ç‚¹ä¹Ÿç”¨æ ˆç®¡ç†</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Deque&lt;Savepoint&gt; savepointStack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayDeque</span>&lt;&gt;();
    
    <span class="hljs-comment">// åˆ›å»ºä¿å­˜ç‚¹</span>
    <span class="hljs-keyword">public</span> Savepoint <span class="hljs-title function_">createSavepoint</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">// ç”¨çº³ç§’æ—¶é—´æˆ³å½“åå­—,ä¿è¯å”¯ä¸€</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> String.valueOf(System.nanoTime());
        <span class="hljs-type">Savepoint</span> <span class="hljs-variable">sp</span> <span class="hljs-operator">=</span> connection.setSavepoint(name);
        savepointStack.push(sp);
        
        System.out.println(<span class="hljs-string">"[Savepoint] åˆ›å»º "</span> + name 
            + <span class="hljs-string">", Connection="</span> + connection.hashCode()
            + <span class="hljs-string">", æ·±åº¦="</span> + savepointStack.size());
        
        <span class="hljs-keyword">return</span> sp;
    }
    
    <span class="hljs-comment">// å›æ»šåˆ°ä¿å­˜ç‚¹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rollbackToSavepoint</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-keyword">if</span> (savepointStack.isEmpty()) {
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-type">Savepoint</span> <span class="hljs-variable">sp</span> <span class="hljs-operator">=</span> savepointStack.pop();
        connection.rollback(sp);  <span class="hljs-comment">// JDBCåŸç”ŸAPI</span>
        
        System.out.println(<span class="hljs-string">"[Savepoint] å›æ»šåˆ° "</span> + sp.getSavepointName() 
            + <span class="hljs-string">", Connection="</span> + connection.hashCode());
    }
}
</code></pre>
<p><strong>è¿™é‡Œè¸©è¿‡ä¸€ä¸ªå‘</strong>:ä¸€å¼€å§‹æˆ‘ç”¨å›ºå®šçš„åå­—"sp1",ç»“æœåµŒå¥—çš„æ—¶å€™åå­—å†²çªäº†,æŠ˜è…¾äº†åŠå¤©æ‰å‘ç°é—®é¢˜ã€‚åæ¥æ”¹æˆç”¨<code>System.nanoTime()</code>ç”Ÿæˆå”¯ä¸€åå­—,å°±æ²¡é—®é¢˜äº†ã€‚</p>
<h2 data-id="heading-7">å®ç°REQUIRES_NEWä¼ æ’­</h2>
<p>æœ‰äº†æ ˆå’ŒæŒ‚èµ·/æ¢å¤æœºåˆ¶,REQUIRES_NEWå°±å¾ˆç®€å•äº†:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> Object <span class="hljs-title function_">executeWithRequiresNew</span><span class="hljs-params">(Object target, Method method, Object[] args)</span> {
    System.out.println(<span class="hljs-string">"[REQUIRES_NEW] å¼€å§‹"</span>);
    
    <span class="hljs-comment">// 1. å…ˆæŒ‚èµ·å½“å‰äº‹åŠ¡(å¦‚æœæœ‰çš„è¯)</span>
    <span class="hljs-type">SuspendedResourcesHolder</span> <span class="hljs-variable">suspended</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (TransactionContext.isActive()) {
        suspended = TransactionContext.suspend();
    }
    
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// 2. å¼€å¯æ–°äº‹åŠ¡(æ–°çš„Connection)</span>
        txManager.begin(readOnly, timeout);
        <span class="hljs-type">Connection</span> <span class="hljs-variable">newConn</span> <span class="hljs-operator">=</span> TransactionContext.getCurrentConnection();
        System.out.println(<span class="hljs-string">"[REQUIRES_NEW] æ–°äº‹åŠ¡ Connection="</span> + newConn.hashCode());
        
        <span class="hljs-comment">// 3. æ‰§è¡Œä¸šåŠ¡æ–¹æ³•</span>
        <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> method.invoke(target, args);
        
        <span class="hljs-comment">// 4. æäº¤æˆ–å›æ»šæ–°äº‹åŠ¡</span>
        <span class="hljs-keyword">if</span> (TransactionContext.isRollbackOnly()) {
            txManager.rollback();
            System.out.println(<span class="hljs-string">"[REQUIRES_NEW] å›æ»š(rollbackOnly)"</span>);
        } <span class="hljs-keyword">else</span> {
            txManager.commit();
            System.out.println(<span class="hljs-string">"[REQUIRES_NEW] æäº¤"</span>);
        }
        
        <span class="hljs-keyword">return</span> result;
        
    } <span class="hljs-keyword">catch</span> (Exception e) {
        <span class="hljs-comment">// 5. å¼‚å¸¸æ—¶å›æ»šæ–°äº‹åŠ¡</span>
        txManager.rollback();
        System.out.println(<span class="hljs-string">"[REQUIRES_NEW] å›æ»š(å¼‚å¸¸)"</span>);
        <span class="hljs-keyword">throw</span> e;
        
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-comment">// 6. æ¢å¤è¢«æŒ‚èµ·çš„äº‹åŠ¡</span>
        <span class="hljs-keyword">if</span> (suspended != <span class="hljs-literal">null</span>) {
            TransactionContext.resume(suspended);
        }
    }
}
</code></pre>
<p><strong>æµç¨‹è¯´æ˜:</strong></p>
<p>1ï¸âƒ£ <strong>å¤–å±‚äº‹åŠ¡å¼€å¯</strong> â†’ Connection=conn1,å¼€å¯äº‹åŠ¡</p>
<p>2ï¸âƒ£ <strong>è°ƒç”¨REQUIRES_NEWæ–¹æ³•</strong></p>
<p>3ï¸âƒ£ <strong>æŒ‚èµ·å¤–å±‚</strong> â†’ æŠŠconn1ä»æ ˆé‡Œæ‹¿å‡ºæ¥,æš‚å­˜åˆ°suspendedå˜é‡</p>
<p>4ï¸âƒ£ <strong>å¼€å¯æ–°äº‹åŠ¡</strong> â†’ Connection=conn2,æ–°çš„ç‰©ç†è¿æ¥</p>
<p>5ï¸âƒ£ <strong>æ‰§è¡Œå†…å±‚æ–¹æ³•</strong> â†’ åœ¨conn2ä¸Šæ‰§è¡ŒSQL</p>
<p>6ï¸âƒ£ <strong>å†…å±‚æäº¤/å›æ»š</strong> â†’ conn2ç‹¬ç«‹æäº¤æˆ–å›æ»š</p>
<p>7ï¸âƒ£ <strong>å…³é—­conn2</strong> â†’ é‡Šæ”¾è¿æ¥æ± </p>
<p>8ï¸âƒ£ <strong>æ¢å¤å¤–å±‚äº‹åŠ¡</strong> â†’ æŠŠconn1é‡æ–°å‹å›æ ˆ</p>
<p>9ï¸âƒ£ <strong>å¤–å±‚ç»§ç»­æ‰§è¡Œ</strong> â†’ åœ¨conn1ä¸Šç»§ç»­æ‰§è¡Œ</p>
<p>ğŸ”Ÿ <strong>å¤–å±‚æäº¤/å›æ»š</strong> â†’ conn1æäº¤æˆ–å›æ»š(ä¸å½±å“å·²æäº¤çš„conn2)</p>
<p><strong>å…³é”®ç‚¹:</strong></p>
<ul>
<li>conn1å’Œconn2æ˜¯<strong>ä¸¤ä¸ªå®Œå…¨ç‹¬ç«‹çš„ç‰©ç†è¿æ¥</strong></li>
<li>conn2çš„æäº¤/å›æ»š<strong>ä¸å—conn1å½±å“</strong></li>
<li>conn1çš„å›æ»š<strong>ä¸ä¼šæ’¤é”€conn2å·²æäº¤çš„æ•°æ®</strong></li>
</ul>
<h2 data-id="heading-8">å®ç°NESTEDä¼ æ’­</h2>
<p>NESTEDæ¯”REQUIRES_NEWç®€å•ä¸€äº›,å› ä¸ºä¸éœ€è¦æ–°çš„Connection:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> Object <span class="hljs-title function_">executeWithNested</span><span class="hljs-params">(Object target, Method method, Object[] args)</span> {
    System.out.println(<span class="hljs-string">"[NESTED] å¼€å§‹"</span>);
    
    <span class="hljs-comment">// 1. å¦‚æœæ²¡æœ‰å¤–å±‚äº‹åŠ¡,é™çº§ä¸ºREQUIRED</span>
    <span class="hljs-keyword">if</span> (!TransactionContext.isActive()) {
        System.out.println(<span class="hljs-string">"[NESTED] æ— å¤–å±‚äº‹åŠ¡,é™çº§ä¸ºREQUIRED"</span>);
        <span class="hljs-keyword">return</span> executeInRequired(target, method, args);
    }
    
    <span class="hljs-comment">// 2. åˆ›å»ºä¿å­˜ç‚¹</span>
    <span class="hljs-type">ConnectionHolder</span> <span class="hljs-variable">holder</span> <span class="hljs-operator">=</span> TransactionContext.getHolder();
    holder.createSavepoint();
    
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// 3. æ‰§è¡Œä¸šåŠ¡æ–¹æ³•</span>
        <span class="hljs-keyword">return</span> method.invoke(target, args);
        
    } <span class="hljs-keyword">catch</span> (Exception e) {
        <span class="hljs-comment">// 4. å¤±è´¥æ—¶å›æ»šåˆ°ä¿å­˜ç‚¹</span>
        <span class="hljs-keyword">if</span> (shouldRollback(e)) {
            holder.rollbackToSavepoint();
            System.out.println(<span class="hljs-string">"[NESTED] å›æ»šåˆ°Savepoint"</span>);
        }
        <span class="hljs-keyword">throw</span> e;
    }
}
</code></pre>
<p><strong>NESTEDå’ŒREQUIRES_NEWçš„æ ¸å¿ƒåŒºåˆ«:</strong></p>
<h3 data-id="heading-9">REQUIRES_NEW:ä¸¤ä¸ªç‹¬ç«‹çš„Connection</h3>
<p><strong>æ­£å¸¸æµç¨‹:</strong></p>
<pre><code class="hljs language-scss" lang="scss">å¤–å±‚å¼€å¯(conn1) 
  â†’ æŒ‚èµ·<span class="hljs-built_in">conn1</span>(æš‚å­˜) 
  â†’ å†…å±‚å¼€å¯(conn2,æ–°è¿æ¥) 
  â†’ å†…å±‚æäº¤conn2 âœ…
  â†’ æ¢å¤conn1 
  â†’ å¤–å±‚æäº¤conn1 âœ…
</code></pre>
<p><strong>å†…å±‚å¤±è´¥åœºæ™¯:</strong></p>
<pre><code class="hljs language-scss" lang="scss">å¤–å±‚å¼€å¯(conn1) 
  â†’ æŒ‚èµ·conn1 
  â†’ å†…å±‚å¼€å¯(conn2) 
  â†’ å†…å±‚å¤±è´¥,å›æ»šconn2 âŒ
  â†’ æ¢å¤conn1 
  â†’ å¤–å±‚æ•è·å¼‚å¸¸åç»§ç»­ 
  â†’ å¤–å±‚æäº¤conn1 âœ…
</code></pre>
<p><strong>ç»“æœ:å†…å±‚å›æ»š,å¤–å±‚æäº¤</strong></p>
<p><strong>å¤–å±‚å¤±è´¥åœºæ™¯:</strong></p>
<pre><code class="hljs language-scss" lang="scss">å¤–å±‚å¼€å¯(conn1) 
  â†’ æŒ‚èµ·conn1 
  â†’ å†…å±‚å¼€å¯(conn2) 
  â†’ å†…å±‚æäº¤conn2 âœ… (å·²ç»æäº¤äº†!)
  â†’ æ¢å¤conn1 
  â†’ å¤–å±‚å¤±è´¥,å›æ»šconn1 âŒ
</code></pre>
<p><strong>ç»“æœ:å†…å±‚å·²æäº¤,å¤–å±‚å›æ»š(äº’ä¸å½±å“)</strong></p>
<hr/>
<h3 data-id="heading-10">NESTED:ä¸€ä¸ªConnection+Savepoint</h3>
<p><strong>æ­£å¸¸æµç¨‹:</strong></p>
<pre><code class="hljs language-scss" lang="scss">å¤–å±‚å¼€å¯(conn1) 
  â†’ å†…å±‚åˆ›å»º<span class="hljs-built_in">Savepoint</span>(è¿˜æ˜¯conn1) 
  â†’ å†…å±‚æ‰§è¡Œ(è¿˜æ˜¯conn1) 
  â†’ å†…å±‚æˆåŠŸ,ä¸åšæ“ä½œ
  â†’ å¤–å±‚æäº¤conn1 âœ…
</code></pre>
<p><strong>å†…å±‚å¤±è´¥åœºæ™¯:</strong></p>
<pre><code class="hljs language-scss" lang="scss">å¤–å±‚å¼€å¯(conn1) 
  â†’ å†…å±‚åˆ›å»º<span class="hljs-built_in">Savepoint</span>(è¿˜æ˜¯conn1) 
  â†’ å†…å±‚æ‰§è¡Œ(è¿˜æ˜¯conn1) 
  â†’ å†…å±‚å¤±è´¥,å›æ»šåˆ°Savepoint âª
  â†’ å¤–å±‚æ•è·å¼‚å¸¸åç»§ç»­ 
  â†’ å¤–å±‚æäº¤conn1 âœ…
</code></pre>
<p><strong>ç»“æœ:å†…å±‚å›æ»šåˆ°Savepoint,å¤–å±‚æäº¤</strong></p>
<p><strong>å¤–å±‚å¤±è´¥åœºæ™¯:</strong></p>
<pre><code class="hljs language-scss" lang="scss">å¤–å±‚å¼€å¯(conn1) 
  â†’ å†…å±‚åˆ›å»º<span class="hljs-built_in">Savepoint</span>(è¿˜æ˜¯conn1) 
  â†’ å†…å±‚æ‰§è¡ŒæˆåŠŸ(è¿˜æ˜¯conn1) 
  â†’ å¤–å±‚å¤±è´¥,æ•´ä¸ªconn1å›æ»š âŒ
</code></pre>
<p><strong>ç»“æœ:æ•´ä¸ªäº‹åŠ¡å›æ»š,åŒ…æ‹¬å†…å±‚(åŒä¸€ä¸ªConnection)</strong></p>
<hr/>
<h3 data-id="heading-11">ä¸€å¥è¯æ€»ç»“:</h3>






























<table><thead><tr><th>åœºæ™¯</th><th>REQUIRES_NEW</th><th>NESTED</th></tr></thead><tbody><tr><td><strong>Connectionæ•°é‡</strong></td><td>2ä¸ª(conn1+conn2)</td><td>1ä¸ª(conn1)</td></tr><tr><td><strong>å†…å±‚å¤±è´¥</strong></td><td>conn2ç‹¬ç«‹å›æ»š,conn1ä¸å—å½±å“</td><td>å›æ»šåˆ°Savepoint,conn1ç»§ç»­</td></tr><tr><td><strong>å¤–å±‚å¤±è´¥</strong></td><td>conn2å·²æäº¤ä¸å—å½±å“</td><td>æ•´ä¸ªconn1å›æ»š,å†…å±‚ä¹Ÿå›æ»š</td></tr><tr><td><strong>å…¸å‹åœºæ™¯</strong></td><td>æ—¥å¿—å¿…é¡»è®°å½•</td><td>æ‰¹é‡å¯¼å…¥,å•æ¡å¤±è´¥ä¸å½±å“å…¶ä»–</td></tr></tbody></table>
<h2 data-id="heading-12">ä¸ƒç§ä¼ æ’­è¡Œä¸ºä¸€å¥è¯æ€»ç»“</h2>
<p>å†™å®Œä»£ç å,æˆ‘ç»™æ¯ç§ä¼ æ’­è¡Œä¸ºæ€»ç»“äº†ä¸€å¥"äººè¯":</p>













































<table><thead><tr><th>ä¼ æ’­è¡Œä¸º</th><th>ä¸€å¥è¯è¯´æ¸…æ¥š</th><th>å…¸å‹åœºæ™¯</th></tr></thead><tbody><tr><td><strong>REQUIRED</strong></td><td>æœ‰å°±ç”¨,æ²¡æœ‰å°±æ–°å»º,å¤§å®¶å…±ç”¨ä¸€ä¸ªConnection</td><td>è®¢å•+åº“å­˜,å¿…é¡»ä¸€è‡´</td></tr><tr><td><strong>SUPPORTS</strong></td><td>æœ‰å°±ç”¨,æ²¡æœ‰å°±ä¸ç”¨äº‹åŠ¡,éšä¾¿</td><td>æŸ¥è¯¢æ“ä½œ</td></tr><tr><td><strong>REQUIRES_NEW</strong></td><td>ä¸ç®¡æœ‰æ²¡æœ‰,æˆ‘éƒ½è¦æ–°å»ºä¸€ä¸ªConnection</td><td>æ—¥å¿—è®°å½•,å¿…é¡»ä¿å­˜</td></tr><tr><td><strong>NESTED</strong></td><td>æœ‰å°±åœ¨é‡Œé¢åŠ ä¸ªSavepoint,æ²¡æœ‰å°±é™çº§ä¸ºREQUIRED</td><td>æ‰¹é‡å¯¼å…¥,å•æ¡å¤±è´¥ä¸å½±å“å…¶ä»–</td></tr><tr><td><strong>NOT_SUPPORTED</strong></td><td>æœ‰å°±æŒ‚èµ·,åæ­£æˆ‘ä¸è¦äº‹åŠ¡</td><td>å¤§æ‰¹é‡æŸ¥è¯¢</td></tr><tr><td><strong>MANDATORY</strong></td><td>å¿…é¡»æœ‰äº‹åŠ¡,æ²¡æœ‰å°±æŠ›å¼‚å¸¸</td><td>å¼ºåˆ¶åœ¨äº‹åŠ¡ä¸­è°ƒç”¨</td></tr><tr><td><strong>NEVER</strong></td><td>å¿…é¡»æ²¡äº‹åŠ¡,æœ‰å°±æŠ›å¼‚å¸¸</td><td>æ–‡ä»¶ä¸Šä¼ </td></tr></tbody></table>
<p><strong>è®°å¿†å£è¯€:</strong></p>
<ul>
<li>REQUIRED: æ¥è€…ä¸æ‹’,èƒ½å…±äº«å°±å…±äº«</li>
<li>REQUIRES_NEW: ç‹¬æ¥ç‹¬å¾€,è‡ªå·±å¼€è‡ªå·±çš„</li>
<li>NESTED: çˆ¶æ…ˆå­å­,å­èƒ½ç‹¬ç«‹å›æ»š,çˆ¶å¤±è´¥å…¨éƒ¨å›æ»š</li>
</ul>
<h2 data-id="heading-13">å‡ ä¸ªå…¸å‹åœºæ™¯çš„æµ‹è¯•</h2>
<h3 data-id="heading-14">åœºæ™¯1: è®¢å•åˆ›å»º+æ—¥å¿—è®°å½•(REQUIRES_NEW)</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Transactional</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">(String userId, String sku)</span> {
    <span class="hljs-comment">// å¤–å±‚äº‹åŠ¡,conn1</span>
    insertOrder(userId, sku);
    
    <span class="hljs-comment">// å†…å±‚ç‹¬ç«‹äº‹åŠ¡,conn2</span>
    logService.saveLog(<span class="hljs-string">"åˆ›å»ºè®¢å•: "</span> + sku);  <span class="hljs-comment">// REQUIRES_NEW</span>
    
    <span class="hljs-comment">// å¦‚æœè¿™é‡ŒæŠ›å¼‚å¸¸,è®¢å•å›æ»š,ä½†æ—¥å¿—å·²æäº¤</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æ¨¡æ‹Ÿå¤±è´¥"</span>);
}
</code></pre>
<p><strong>å®é™…æ—¥å¿—:</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[REQUIRED]</span> å¼€å¯äº‹åŠ¡, <span class="hljs-attr">Connection</span>=<span class="hljs-number">123456</span>
<span class="hljs-section">[å¤–å±‚]</span> æ’å…¥è®¢å•æˆåŠŸ
<span class="hljs-section">[REQUIRES_NEW]</span> æŒ‚èµ·äº‹åŠ¡, <span class="hljs-attr">Connection</span>=<span class="hljs-number">123456</span>
<span class="hljs-section">[REQUIRES_NEW]</span> æ–°äº‹åŠ¡ <span class="hljs-attr">Connection</span>=<span class="hljs-number">789012</span>
<span class="hljs-section">[å†…å±‚]</span> ä¿å­˜æ—¥å¿—æˆåŠŸ
<span class="hljs-section">[REQUIRES_NEW]</span> æäº¤
<span class="hljs-section">[REQUIRES_NEW]</span> æ¢å¤äº‹åŠ¡, <span class="hljs-attr">Connection</span>=<span class="hljs-number">123456</span>
<span class="hljs-section">[REQUIRED]</span> å›æ»š(å¼‚å¸¸)
</code></pre>
<p><strong>ç»“æœ:</strong></p>
<ul>
<li>è®¢å•:æ²¡äº†(å›æ»š)</li>
<li>æ—¥å¿—:åœ¨(ç‹¬ç«‹æäº¤)</li>
</ul>
<h3 data-id="heading-15">åœºæ™¯2: æ‰¹é‡å¯¼å…¥+éƒ¨åˆ†å¤±è´¥(NESTED)</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Transactional</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">batchImport</span><span class="hljs-params">(List&lt;Order&gt; orders)</span> {
    <span class="hljs-comment">// å¤–å±‚äº‹åŠ¡</span>
    <span class="hljs-keyword">for</span> (Order order : orders) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å†…å±‚NESTED</span>
            orderService.saveOne(order);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// å•æ¡å¤±è´¥,åªå›æ»šåˆ°Savepoint</span>
            log.error(<span class="hljs-string">"è®¢å•{}å¯¼å…¥å¤±è´¥"</span>, order.getId());
        }
    }
    <span class="hljs-comment">// å¤–å±‚æäº¤,æˆåŠŸçš„è®¢å•éƒ½ä¿å­˜äº†</span>
}
</code></pre>
<p><strong>å®é™…æ—¥å¿—:</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[REQUIRED]</span> å¼€å¯äº‹åŠ¡, <span class="hljs-attr">Connection</span>=<span class="hljs-number">123456</span>
<span class="hljs-section">[NESTED]</span> åˆ›å»ºSavepoint sp_001
<span class="hljs-section">[è®¢å•1]</span> å¯¼å…¥æˆåŠŸ
<span class="hljs-section">[NESTED]</span> åˆ›å»ºSavepoint sp_002
<span class="hljs-section">[è®¢å•2]</span> å¯¼å…¥å¤±è´¥
<span class="hljs-section">[NESTED]</span> å›æ»šåˆ°Savepoint sp_002  â† åªå›æ»šè®¢å•2
<span class="hljs-section">[NESTED]</span> åˆ›å»ºSavepoint sp_003
<span class="hljs-section">[è®¢å•3]</span> å¯¼å…¥æˆåŠŸ
<span class="hljs-section">[REQUIRED]</span> æäº¤  â† è®¢å•1å’Œ3éƒ½ä¿å­˜äº†
</code></pre>
<h3 data-id="heading-16">åœºæ™¯3: NESTED vs REQUIRES_NEWçš„å…³é”®åŒºåˆ«</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æµ‹è¯•:å¤–å±‚å¤±è´¥æ—¶çš„è¡¨ç°</span>

<span class="hljs-comment">// REQUIRES_NEWç‰ˆæœ¬</span>
<span class="hljs-meta">@Transactional</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testRequiresNew</span><span class="hljs-params">()</span> {
    insertOrder();  <span class="hljs-comment">// å¤–å±‚</span>
    logService.saveLog();  <span class="hljs-comment">// REQUIRES_NEW,å†…å±‚ç‹¬ç«‹</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å¤–å±‚å¤±è´¥"</span>);
}
<span class="hljs-comment">// ç»“æœ:è®¢å•å›æ»š,æ—¥å¿—ä¿ç•™</span>

<span class="hljs-comment">// NESTEDç‰ˆæœ¬</span>
<span class="hljs-meta">@Transactional</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testNested</span><span class="hljs-params">()</span> {
    insertOrder();  <span class="hljs-comment">// å¤–å±‚</span>
    itemService.addItem();  <span class="hljs-comment">// NESTED,å†…å±‚Savepoint</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å¤–å±‚å¤±è´¥"</span>);
}
<span class="hljs-comment">// ç»“æœ:è®¢å•å’Œæ˜ç»†éƒ½å›æ»š(åŒä¸€ä¸ªConnection)</span>
</code></pre>
<p><strong>åŸç†å›¾:</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant Outer as å¤–å±‚äº‹åŠ¡
    participant Inner as å†…å±‚æ–¹æ³•
    participant DB as æ•°æ®åº“
    
    Note over Outer,DB: REQUIRES_NEWåœºæ™¯
    Outer-&gt;&gt;DB: begin(conn1)
    Outer-&gt;&gt;DB: insert order(conn1)
    Outer-&gt;&gt;Inner: è°ƒç”¨å†…å±‚
    Inner-&gt;&gt;DB: begin(conn2) æ–°è¿æ¥
    Inner-&gt;&gt;DB: insert log(conn2)
    Inner-&gt;&gt;DB: commit(conn2) ç‹¬ç«‹æäº¤
    Outer-&gt;&gt;DB: rollback(conn1) å¤–å±‚å›æ»š
    Note over DB: ç»“æœ:è®¢å•å›æ»š,æ—¥å¿—ä¿ç•™
    
    Note over Outer,DB: NESTEDåœºæ™¯
    Outer-&gt;&gt;DB: begin(conn1)
    Outer-&gt;&gt;DB: insert order(conn1)
    Outer-&gt;&gt;Inner: è°ƒç”¨å†…å±‚
    Inner-&gt;&gt;DB: savepoint(conn1) è®¾ç½®ä¿å­˜ç‚¹
    Inner-&gt;&gt;DB: insert item(conn1)
    Outer-&gt;&gt;DB: rollback(conn1) æ•´ä½“å›æ»š
    Note over DB: ç»“æœ:è®¢å•å’Œæ˜ç»†éƒ½å›æ»š
</code></pre>
<h2 data-id="heading-17">æ ˆæ·±åº¦çš„å˜åŒ–è¿‡ç¨‹</h2>
<p>æˆ‘åœ¨è°ƒè¯•æ—¶å‘ç°,çœ‹æ ˆæ·±åº¦çš„å˜åŒ–å¾ˆæœ‰æ„æ€:</p>
<p><strong>REQUIREDåµŒå¥—(å¤ç”¨Connection):</strong></p>
<pre><code class="hljs language-ini" lang="ini">å¤–å±‚å¼€å§‹ <span class="hljs-attr">depth</span>=<span class="hljs-number">0</span>
å¤–å±‚push <span class="hljs-attr">depth</span>=<span class="hljs-number">1</span>  [conn1]
å†…å±‚åŠ å…¥ <span class="hljs-attr">depth</span>=<span class="hljs-number">1</span>  [conn1]  â† è¿˜æ˜¯<span class="hljs-number">1</span>
å¤–å±‚pop  <span class="hljs-attr">depth</span>=<span class="hljs-number">0</span>  []
</code></pre>
<p><strong>REQUIRES_NEWåµŒå¥—(æ–°Connection):</strong></p>
<pre><code class="hljs language-ini" lang="ini">å¤–å±‚å¼€å§‹ <span class="hljs-attr">depth</span>=<span class="hljs-number">0</span>
å¤–å±‚push <span class="hljs-attr">depth</span>=<span class="hljs-number">1</span>  [conn1]
æŒ‚èµ·å¤–å±‚ <span class="hljs-attr">depth</span>=<span class="hljs-number">0</span>  []  â† æš‚æ—¶æ¸…ç©º
å†…å±‚push <span class="hljs-attr">depth</span>=<span class="hljs-number">1</span>  [conn2]
å†…å±‚pop  <span class="hljs-attr">depth</span>=<span class="hljs-number">0</span>  []
æ¢å¤å¤–å±‚ <span class="hljs-attr">depth</span>=<span class="hljs-number">1</span>  [conn1]
å¤–å±‚pop  <span class="hljs-attr">depth</span>=<span class="hljs-number">0</span>  []
</code></pre>
<p><strong>å¯è§†åŒ–ä¸€ä¸‹:</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[depth=0&lt;br/&gt;ç©ºæ ˆ] --&gt; B[depth=1&lt;br/&gt;conn1]
    B --&gt; C{ä»€ä¹ˆä¼ æ’­?}
    C --&gt;|REQUIRED| D[depth=1&lt;br/&gt;conn1]
    C --&gt;|REQUIRES_NEW| E[depth=0&lt;br/&gt;ç©ºæ ˆ]
    E --&gt; F[depth=1&lt;br/&gt;conn2]
    F --&gt; G[depth=0&lt;br/&gt;ç©ºæ ˆ]
    G --&gt; H[depth=1&lt;br/&gt;conn1]
    D --&gt; I[depth=0&lt;br/&gt;ç©ºæ ˆ]
    H --&gt; I
</code></pre>
<h2 data-id="heading-18">å‡ ä¸ªè¦æ³¨æ„çš„åœ°æ–¹</h2>
<h3 data-id="heading-19">1. Connectionçš„hashCodeå¾ˆé‡è¦</h3>
<p>æˆ‘å¼ºçƒˆå»ºè®®åœ¨æ—¥å¿—é‡Œæ‰“å°Connectionçš„hashCode,è¿™æ ·èƒ½æ¸…æ¥šçœ‹åˆ°æ˜¯ä¸æ˜¯åŒä¸€ä¸ªè¿æ¥:</p>
<pre><code class="hljs language-java" lang="java">System.out.println(<span class="hljs-string">"Connection="</span> + conn.hashCode());
</code></pre>
<p>è°ƒè¯•çš„æ—¶å€™ä¸€çœ¼å°±èƒ½çœ‹å‡ºæ¥:</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[å¤–å±‚]</span> <span class="hljs-attr">Connection</span>=<span class="hljs-number">123456</span>  â† å¤–å±‚
<span class="hljs-section">[å†…å±‚]</span> <span class="hljs-attr">Connection</span>=<span class="hljs-number">123456</span>  â† REQUIRED,åŒä¸€ä¸ª
<span class="hljs-section">[å†…å±‚]</span> <span class="hljs-attr">Connection</span>=<span class="hljs-number">789012</span>  â† REQUIRES_NEW,ä¸åŒäº†!
</code></pre>
<h3 data-id="heading-20">2. Savepointåå­—è¦å”¯ä¸€</h3>
<p>ä¸€å¼€å§‹æˆ‘ç”¨å›ºå®šåå­—"sp1",ç»“æœåµŒå¥—æ—¶å°±å†²çªäº†:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯</span>
<span class="hljs-type">Savepoint</span> <span class="hljs-variable">sp</span> <span class="hljs-operator">=</span> conn.setSavepoint(<span class="hljs-string">"sp1"</span>);
<span class="hljs-comment">// åµŒå¥—æ—¶åˆåˆ›å»ºsp1,å°±å†²çªäº†</span>

<span class="hljs-comment">// âœ… æ­£ç¡®</span>
<span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> String.valueOf(System.nanoTime());
<span class="hljs-type">Savepoint</span> <span class="hljs-variable">sp</span> <span class="hljs-operator">=</span> conn.setSavepoint(name);
</code></pre>
<h3 data-id="heading-21">3. ThreadLocalä¸€å®šè¦æ¸…ç†</h3>
<p>æ ˆç©ºäº†è®°å¾—remove(),ä¸ç„¶ä¼šå†…å­˜æ³„æ¼:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">if</span> (stack.isEmpty()) {
    CONTEXT.remove();  <span class="hljs-comment">// è¿™ä¸€è¡Œå¾ˆé‡è¦!</span>
}
</code></pre>
<h3 data-id="heading-22">4. è¿æ¥æ± ä¸è¦è®¾å¤ªå°</h3>
<p>REQUIRES_NEWä¼šåŒæ—¶å ç”¨2ä¸ªè¿æ¥,å¦‚æœè¿æ¥æ± åªæœ‰10ä¸ª,åµŒå¥—5å±‚å°±çˆ†äº†:</p>
<pre><code class="hljs language-scss" lang="scss">å¤–å±‚<span class="hljs-number">1</span>ä¸ª + å†…å±‚<span class="hljs-number">1</span>ä¸ª = <span class="hljs-number">2</span>ä¸ª
å¤–å±‚<span class="hljs-number">1</span>ä¸ª + å†…å±‚(å†…å±‚<span class="hljs-number">1</span>ä¸ª + å†…å±‚çš„å†…å±‚<span class="hljs-number">1</span>ä¸ª) = <span class="hljs-number">3</span>ä¸ª
...
</code></pre>
<p>å»ºè®®è¿æ¥æ± è‡³å°‘20ä¸ªèµ·æ­¥ã€‚</p>
<h2 data-id="heading-23">æ€§èƒ½å¯¹æ¯”</h2>
<p>æˆ‘ç®€å•æµ‹äº†ä¸‹,REQUIRES_NEWç¡®å®æ¯”REQUIREDæ…¢ä¸€äº›:</p>

























<table><thead><tr><th>ä¼ æ’­è¡Œä¸º</th><th>100æ¬¡è°ƒç”¨è€—æ—¶</th><th>è¿æ¥æ•°</th></tr></thead><tbody><tr><td>REQUIRED</td><td>150ms</td><td>1ä¸ª</td></tr><tr><td>REQUIRES_NEW</td><td>280ms</td><td>2ä¸ª</td></tr><tr><td>NESTED</td><td>180ms</td><td>1ä¸ª</td></tr></tbody></table>
<p><strong>åŸå› :</strong></p>
<ul>
<li>REQUIRES_NEWéœ€è¦é¢‘ç¹åˆ›å»º/å…³é—­è¿æ¥</li>
<li>æŒ‚èµ·/æ¢å¤ä¹Ÿæœ‰å¼€é”€</li>
</ul>
<p>æ‰€ä»¥èƒ½ç”¨REQUIREDå°±ç”¨REQUIRED,é™¤éçœŸçš„éœ€è¦ç‹¬ç«‹æäº¤ã€‚</p>
<h2 data-id="heading-24">ä¸ƒç§ä¼ æ’­è¡Œä¸ºçš„å†³ç­–è¡¨</h2>
<p>æŠŠ7ç§ä¼ æ’­è¡Œä¸ºçš„å†³ç­–é€»è¾‘æ•´ç†æˆè¡¨æ ¼,ä¸€ç›®äº†ç„¶:</p>





























































<table><thead><tr><th>ä¼ æ’­è¡Œä¸º</th><th>å¤–å±‚æœ‰äº‹åŠ¡</th><th>å¤–å±‚æ— äº‹åŠ¡</th><th>Connectionæ•°é‡</th><th>å…¸å‹åœºæ™¯</th></tr></thead><tbody><tr><td><strong>REQUIRED</strong></td><td>åŠ å…¥å¤–å±‚äº‹åŠ¡,å¤ç”¨conn1</td><td>åˆ›å»ºæ–°äº‹åŠ¡conn1</td><td>1ä¸ª</td><td>è®¢å•+åº“å­˜,å¿…é¡»ä¸€è‡´</td></tr><tr><td><strong>SUPPORTS</strong></td><td>åŠ å…¥å¤–å±‚äº‹åŠ¡,å¤ç”¨conn1</td><td>éäº‹åŠ¡æ‰§è¡Œ</td><td>0-1ä¸ª</td><td>æŸ¥è¯¢æ“ä½œ,å¯æœ‰å¯æ— </td></tr><tr><td><strong>REQUIRES_NEW</strong></td><td>æŒ‚èµ·å¤–å±‚conn1,åˆ›å»ºæ–°çš„conn2</td><td>åˆ›å»ºæ–°äº‹åŠ¡conn1</td><td>2ä¸ª</td><td>æ—¥å¿—è®°å½•,å¿…é¡»ä¿å­˜</td></tr><tr><td><strong>NESTED</strong></td><td>åœ¨conn1ä¸Šåˆ›å»ºSavepoint</td><td>é™çº§ä¸ºREQUIRED</td><td>1ä¸ª</td><td>æ‰¹é‡å¯¼å…¥,å•æ¡å¤±è´¥ä¸å½±å“å…¶ä»–</td></tr><tr><td><strong>NOT_SUPPORTED</strong></td><td>æŒ‚èµ·å¤–å±‚conn1,éäº‹åŠ¡æ‰§è¡Œ</td><td>éäº‹åŠ¡æ‰§è¡Œ</td><td>0ä¸ª</td><td>å¤§æ‰¹é‡æŸ¥è¯¢,ä¸éœ€è¦äº‹åŠ¡</td></tr><tr><td><strong>MANDATORY</strong></td><td>åŠ å…¥å¤–å±‚äº‹åŠ¡,å¤ç”¨conn1</td><td>æŠ›å¼‚å¸¸</td><td>1ä¸ª</td><td>å¼ºåˆ¶åœ¨äº‹åŠ¡ä¸­è°ƒç”¨</td></tr><tr><td><strong>NEVER</strong></td><td>æŠ›å¼‚å¸¸</td><td>éäº‹åŠ¡æ‰§è¡Œ</td><td>0ä¸ª</td><td>æ–‡ä»¶ä¸Šä¼ ,ä¸èƒ½æœ‰äº‹åŠ¡</td></tr></tbody></table>
<p><strong>å¿«é€Ÿå†³ç­–:</strong></p>
<ol>
<li>éœ€è¦å¤šä¸ªç‹¬ç«‹äº‹åŠ¡? â†’ <strong>REQUIRES_NEW</strong></li>
<li>å­æ“ä½œå…è®¸å¤±è´¥? â†’ <strong>NESTED</strong></li>
<li>ä¸ç¡®å®šå¤–å±‚æœ‰æ²¡æœ‰äº‹åŠ¡? â†’ <strong>SUPPORTS</strong></li>
<li>å¼ºåˆ¶è¦æ±‚æœ‰äº‹åŠ¡? â†’ <strong>MANDATORY</strong></li>
<li>å¼ºåˆ¶è¦æ±‚æ²¡äº‹åŠ¡? â†’ <strong>NEVER</strong></li>
<li>ä¸éœ€è¦äº‹åŠ¡? â†’ <strong>NOT_SUPPORTED</strong></li>
<li>å…¶ä»–æƒ…å†µ? â†’ <strong>REQUIRED</strong>(é»˜è®¤)</li>
</ol>
<h2 data-id="heading-25">å†™åˆ°æœ€å</h2>
<p>æ•´ä¸ªè¿‡ç¨‹å†™ä¸‹æ¥,æˆ‘æœ€å¤§çš„æ„Ÿæ‚Ÿæ˜¯:<strong>Springäº‹åŠ¡ä¼ æ’­è¡Œä¸º,æœ¬è´¨ä¸Šå°±æ˜¯Connectionçš„ç®¡ç†ç­–ç•¥ã€‚</strong></p>
<ul>
<li>éœ€è¦1ä¸ªConnection â†’ REQUIRED / NESTED</li>
<li>éœ€è¦2ä¸ªConnection â†’ REQUIRES_NEW</li>
<li>ä¸éœ€è¦Connection â†’ NOT_SUPPORTED / NEVER</li>
</ul>
<p>å‰©ä¸‹çš„å°±æ˜¯æ€ä¹ˆç”¨æ ˆæ¥ç®¡ç†è¿™äº›Connectionçš„é¡ºåºé—®é¢˜ã€‚</p>
<p><strong>ä»£ç åœ¨è¿™é‡Œ</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fsh_wangwanbao%2Fsimple-spring-transaction" target="_blank" title="https://gitee.com/sh_wangwanbao/simple-spring-transaction" ref="nofollow noopener noreferrer">simple-spring-transaction</a></p>
<p>å¦‚æœä½ ä¹Ÿå¯¹Springçš„åº•å±‚å®ç°æ„Ÿå…´è¶£,å¯ä»¥è‡ªå·±è·‘ä¸€éä»£ç ,çœ‹çœ‹æ—¥å¿—è¾“å‡º,ä¼šæœ‰å¾ˆå¤š"åŸæ¥æ˜¯è¿™æ ·"çš„æ„Ÿè§‰!</p>
<h2 data-id="heading-26">ä½ é‡åˆ°è¿‡å“ªäº›äº‹åŠ¡çš„å‘?</h2>
<p>åœ¨å®é™…é¡¹ç›®ä¸­,ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡:</p>
<ul>
<li>ä»¥ä¸ºä¼šå›æ»š,ç»“æœæäº¤äº†?</li>
<li>ä»¥ä¸ºä¼šæäº¤,ç»“æœå›æ»šäº†?</li>
<li>è¿æ¥æ± è¢«æ‰“çˆ†?</li>
<li>åµŒå¥—å±‚çº§å¤ªæ·±å¯¼è‡´çš„é—®é¢˜?</li>
</ul>
<p><strong>æ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ è¸©è¿‡çš„å‘,å¤§å®¶ä¸€èµ·äº¤æµå­¦ä¹ !</strong></p>
<p>ä¹Ÿå¯ä»¥è¯´è¯´ä½ å¯¹è¿™7ç§ä¼ æ’­è¡Œä¸ºçš„ç†è§£,æˆ–è€…æå‡ºä½ çš„ç–‘é—®,æˆ‘ä»¬ä¸€èµ·è®¨è®º~</p>
<hr/>
<p><em>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©,è¯·ç‚¹ä¸ªèµæ”¯æŒä¸€ä¸‹!ä½ çš„é¼“åŠ±æ˜¯æˆ‘æŒç»­è¾“å‡ºçš„åŠ¨åŠ›~</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[victorialogså¦‚ä½•åœ¨å¯åŠ¨æ—¶é™å®šå¥½èµ„æºä½¿ç”¨é‡ä»¥åŠæ•°æ®ä¿ç•™æ—¶é—´]]></title>    <link>https://juejin.cn/post/7578724773993775130</link>    <guid>https://juejin.cn/post/7578724773993775130</guid>    <pubDate>2025-12-02T00:53:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578724773993775130" data-draft-id="7578709098256269350" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="victorialogså¦‚ä½•åœ¨å¯åŠ¨æ—¶é™å®šå¥½èµ„æºä½¿ç”¨é‡ä»¥åŠæ•°æ®ä¿ç•™æ—¶é—´"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-02T00:53:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="yeyong"/> <meta itemprop="url" content="https://juejin.cn/user/4283353031781063"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            victorialogså¦‚ä½•åœ¨å¯åŠ¨æ—¶é™å®šå¥½èµ„æºä½¿ç”¨é‡ä»¥åŠæ•°æ®ä¿ç•™æ—¶é—´
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4283353031781063/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    yeyong
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T00:53:05.000Z" title="Tue Dec 02 2025 00:53:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>VictoriaLogs çš„å†…å­˜å ç”¨ä¸»è¦ç”±â€œå†…éƒ¨ç¼“å­˜ + è¿‘æœŸæ—¥å¿—å— + æŸ¥è¯¢ç»“æœç¼“å­˜â€ä¸‰éƒ¨åˆ†ç»„æˆã€‚å®˜æ–¹é»˜è®¤ä¼š<strong>è‡ªåŠ¨æ¢æµ‹ç‰©ç†æœºå†…å­˜å¹¶æŒ‰æ¯”ä¾‹åˆ†é…</strong>ï¼Œä½†ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç±»å¯åŠ¨å‚æ•°æŠŠä¸Šé™å‹ä¸‹æ¥ï¼Œæˆ–è€…å›ºå®šåœ¨ä¸€ä¸ªå…·ä½“æ•°å€¼ã€‚</p>
<hr/>
<h3 data-id="heading-0">ä¸€ã€ç›´æ¥é™åˆ¶â€œç¼“å­˜å¯ç”¨å†…å­˜â€</h3>
<p>VictoriaLogs æ²¿ç”¨äº† VictoriaMetrics çš„é€šç”¨å†…å­˜æ ‡å¿—ï¼š</p>
<ol>
<li>
<p><strong>æŒ‰ç™¾åˆ†æ¯”é™åˆ¶</strong>ï¼ˆé»˜è®¤ 60 %ï¼‰</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">-memory.allowedPercent</span>=<span class="hljs-number">40</span>
</code></pre>
<p>æŠŠæ¯”ä¾‹ä» 60 % è°ƒåˆ° 40 %ï¼Œè¿›ç¨‹å†…éƒ¨æ‰€æœ‰ç¼“å­˜ï¼ˆå—ç¼“å­˜ã€å€’æ’ç´¢å¼•ç¼“å­˜ã€æŸ¥è¯¢ç»“æœç¼“å­˜ç­‰ï¼‰åŠ èµ·æ¥ä¸ä¼šè¶…è¿‡ç‰©ç†å†…å­˜çš„ 40 %ã€‚</p>
</li>
<li>
<p><strong>æŒ‰ç»å¯¹å€¼é™åˆ¶</strong>ï¼ˆæƒ³ç²¾ç¡®åˆ° GB æ—¶ç”¨è¿™ä¸ªï¼‰</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">-memory.allowedBytes</span>=<span class="hljs-number">4</span>GB
</code></pre>
<p>ä¸€æ—¦åŒæ—¶ç»™å‡º <code>allowedBytes</code> å’Œ <code>allowedPercent</code>ï¼Œ<strong>å‰è€…ä¼˜å…ˆç”Ÿæ•ˆ</strong>ï¼›å®¹å™¨/ç¬”è®°æœ¬å†…å­˜æ³¢åŠ¨æ—¶æ›´å¯æ§ ã€‚</p>
</li>
</ol>
<hr/>
<h3 data-id="heading-1">äºŒã€å‡å°â€œå¹¶å‘ + é˜Ÿåˆ—â€å¸¦æ¥çš„ä¸´æ—¶å†…å­˜</h3>
<ol>
<li>
<p><strong>é™ä½æŸ¥è¯¢å¹¶å‘</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">-search.maxConcurrentRequests</span>=<span class="hljs-number">2</span>      <span class="hljs-comment"># é»˜è®¤ 4</span>
</code></pre>
<p>æ¯å¹¶å‘ä¼šç¼“å­˜ä¸€æ‰¹ posting list å’ŒåŸå§‹æ—¥å¿—å—ï¼Œè°ƒåŠå¯ä»¥çœ 30-50 % æŸ¥è¯¢å³°å€¼å†…å­˜ã€‚</p>
</li>
<li>
<p><strong>ç¼©çŸ­å•æŸ¥è¯¢æœ€å¤§æ—¶é•¿</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">-search.maxQueryDuration</span>=<span class="hljs-number">10</span>s         <span class="hljs-comment"># é»˜è®¤ 30 s</span>
</code></pre>
<p>é˜²æ­¢å¤§æ—¶é—´èŒƒå›´æŸ¥è¯¢ä¸€æ¬¡æ€§æŠŠå¤§é‡ block è£…è¿›å†…å­˜ã€‚</p>
</li>
<li>
<p><strong>ç¼©å° UDP/syslog æ¥æ”¶ç¼“å†²</strong>ï¼ˆå¦‚æœç”¨ UDP å…¥å£ï¼‰</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">-syslog.listenAddr.udp</span>=:<span class="hljs-number">514</span>
<span class="hljs-attr">-syslog.readBufferBytes</span>=<span class="hljs-number">1</span>MB          <span class="hljs-comment"># é»˜è®¤ 16 MBï¼Œå®¹å™¨é‡Œå¯è°ƒåˆ° 512 KB-1 MB</span>
</code></pre>
</li>
</ol>
<hr/>
<h3 data-id="heading-2">ä¸‰ã€Docker / K8s ç¤ºèŒƒ</h3>
<pre><code class="hljs language-bash" lang="bash">docker run -d --name=vlogs \
  -p 9428:9428 \
  -v /data/vlogs:/victoria-logs-data \
  victoriametrics/victoria-logs:latest \
  -memory.allowedBytes=2GB \
  -search.maxConcurrentRequests=2 \
  -search.maxQueryDuration=10s \
  -retentionPeriod=30d
</code></pre>
<p>å¦å¤–ï¼Œä¸ºäº†è§£å†³<code>runtime/cgo: pthread_create failed: Operation not permitted</code>é—®é¢˜ï¼Œå¯ä»¥æ·»åŠ ä¸€äº›å‚æ•°</p>
<p>ç²—æš´åšæ³•</p>
<p><code>docker run --privileged your-image</code></p>
<p>ç²¾ç»†åšæ³•</p>
<pre><code class="hljs language-ini" lang="ini">docker run -d <span class="hljs-attr">--name</span>=myapp \
  <span class="hljs-attr">--cap-add</span>=SYS_ADMIN \
  <span class="hljs-attr">--cap-add</span>=SYS_PTRACE \
  --security-opt <span class="hljs-attr">seccomp</span>=unconfined \
  my-image:latest
</code></pre>
<hr/>
<h3 data-id="heading-3">å››ã€è°ƒä¼˜åæ•ˆæœ</h3>
<p>æ ¹æ®ç¤¾åŒºå‹æµ‹ï¼Œ<strong>â€œ2 CPU + 1 GB å†…å­˜â€</strong> å³å¯è·‘æ»¡ 17 MB/s çš„å†™å…¥ååï¼›æŠŠ allowedBytes å‹åˆ° 1-2 GB åï¼Œå¸¸é©» RSS å¤§çº¦åªå ç”¨ 600-800 MBï¼Œå…¶ä½™ç•™ç»™ç³»ç»Ÿ page cacheï¼ŒæŸ¥è¯¢æ€§èƒ½æ²¡æœ‰æ˜æ˜¾ä¸‹é™ ã€‚</p>
<hr/>
<h3 data-id="heading-4">å°ç»“</h3>
<ul>
<li>æƒ³â€œä¸€é”®â€é™å†…å­˜ï¼šç»™ <code>-memory.allowedBytes</code> æˆ– <code>-memory.allowedPercent</code> å³å¯ã€‚</li>
<li>å†å¾€ä¸‹å‹ï¼šåŒæ—¶æŠŠå¹¶å‘ã€æŸ¥è¯¢æ—¶é•¿ã€UDP ç¼“å†²ç­‰å‚æ•°åŒæ¯”ä¾‹ç¼©å°ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[257. Java é›†åˆ - ç”¨å¥½ SortedMap å’Œ NavigableMapï¼Œä¼˜åŒ– Java é›†åˆæ’åºä¸æ“ä½œæ•ˆç‡]]></title>    <link>https://juejin.cn/post/7578760341279981609</link>    <guid>https://juejin.cn/post/7578760341279981609</guid>    <pubDate>2025-12-02T00:55:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578760341279981609" data-draft-id="7578787344611770404" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="257. Java é›†åˆ - ç”¨å¥½ SortedMap å’Œ NavigableMapï¼Œä¼˜åŒ– Java é›†åˆæ’åºä¸æ“ä½œæ•ˆç‡"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-02T00:55:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CacheæŠ€æœ¯åˆ†äº«"/> <meta itemprop="url" content="https://juejin.cn/user/1662117313262776"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            257. Java é›†åˆ - ç”¨å¥½ SortedMap å’Œ NavigableMapï¼Œä¼˜åŒ– Java é›†åˆæ’åºä¸æ“ä½œæ•ˆç‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1662117313262776/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CacheæŠ€æœ¯åˆ†äº«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T00:55:15.000Z" title="Tue Dec 02 2025 00:55:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">257. Java é›†åˆ - ç”¨å¥½ SortedMap å’Œ NavigableMapï¼Œä¼˜åŒ– Java é›†åˆæ’åºä¸æ“ä½œæ•ˆç‡</h2>
<p>åœ¨<code>Java</code>ä¸­ï¼Œ<code>SortedMap</code> å’Œ <code>NavigableMap</code> æ¥å£ä¸º <code>Map</code> æä¾›äº†å¯¹é”®æ’åºçš„åŠŸèƒ½ã€‚è¿™äº›æ¥å£æœ‰åŠ©äºç®¡ç†é‚£äº›éœ€è¦æœ‰åºå­˜å‚¨å’ŒæŒ‰ç‰¹å®šé¡ºåºè®¿é—®é”®å€¼å¯¹çš„æƒ…å†µã€‚å®ƒä»¬é€šè¿‡ <code>TreeMap</code> ç±»çš„å®ç°æ¥å·¥ä½œï¼Œ<code>TreeMap</code> æ˜¯ä¸€ç§è‡ªå¹³è¡¡çš„çº¢é»‘æ ‘æ•°æ®ç»“æ„ï¼Œå®ƒä¿è¯äº†é”®çš„é¡ºåºã€‚</p>
<p><code>SortedMap</code> æ˜¯ <code>Map</code> æ¥å£çš„æ‰©å±•ï¼Œè€Œ <code>NavigableMap</code> æ˜¯ <code>SortedMap</code> çš„ä¸€ä¸ªè¿›ä¸€æ­¥æ‰©å±•ã€‚è¿™ä¸¤ä¸ªæ¥å£çš„å®ç°éƒ½å¯ä»¥ä½¿ç”¨ <code>TreeMap</code> ç±»ã€‚å®ƒä»¬éƒ½èƒ½ç¡®ä¿é”®å€¼å¯¹æŒ‰ç…§é”®è¿›è¡Œæ’åºã€‚</p>
<h4 data-id="heading-1"><code>SortedMap</code> å’Œ <code>NavigableMap</code> çš„åŠŸèƒ½</h4>
<p><code>SortedMap</code> å’Œ <code>NavigableMap</code> æ¥å£é€šè¿‡é”®å€¼å¯¹çš„æ’åºï¼Œä¸º <code>Map</code> æä¾›äº†é¢å¤–çš„åŠŸèƒ½ã€‚ä¸‹é¢æ˜¯å®ƒä»¬çš„ä¸€äº›é‡è¦æ–¹æ³•å’Œä½¿ç”¨æ–¹æ³•ã€‚</p>
<h5 data-id="heading-2">æ–¹æ³•æ¦‚è¿°</h5>
<p><code>SortedMap</code> æ¥å£é€šè¿‡ä»¥ä¸‹æ–¹æ³•æ‰©å±•äº† <code>Map</code>ï¼š</p>
<ol>
<li><strong><code>firstKey()</code></strong> å’Œ <strong><code>lastKey()</code></strong>ï¼šè¿”å› <code>Map</code> ä¸­æœ€å°å’Œæœ€å¤§é”®ã€‚</li>
<li><strong><code>headMap(toKey)</code></strong>ï¼šè¿”å›ä¸€ä¸ªæ–°çš„ <code>SortedMap</code>ï¼Œå…¶é”®å°äº <code>toKey</code>ã€‚</li>
<li><strong><code>tailMap(fromKey)</code></strong>ï¼šè¿”å›ä¸€ä¸ªæ–°çš„ <code>SortedMap</code>ï¼Œå…¶é”®å¤§äºæˆ–ç­‰äº <code>fromKey</code>ã€‚</li>
<li><strong><code>subMap(fromKey, toKey)</code></strong>ï¼šè¿”å›ä¸€ä¸ªæ–°çš„ <code>SortedMap</code>ï¼Œå…¶é”®å¤§äºæˆ–ç­‰äº <code>fromKey</code>ï¼Œä¸”å°äº <code>toKey</code>ã€‚</li>
</ol>
<p>è¿™äº›æ–¹æ³•è¿”å›çš„ <code>SortedMap</code> æ˜¯åŸå§‹ <code>Map</code> çš„è§†å›¾ï¼Œä»»ä½•å¯¹è¿™äº›è§†å›¾çš„æ›´æ”¹éƒ½ä¼šåæ˜ åœ¨åŸå§‹ <code>Map</code> ä¸­ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™äº›è§†å›¾ä¸èƒ½æ’å…¥è¶…å‡ºåŸå§‹ <code>Map</code> èŒƒå›´çš„é”®ã€‚</p>
<h5 data-id="heading-3"><code>NavigableMap</code> çš„é™„åŠ åŠŸèƒ½</h5>
<p><code>NavigableMap</code> æ¥å£æä¾›äº†æ›´å¤šçš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ–¹æ³• <strong><code>navigableKeySet()</code></strong>ï¼Œå®ƒè¿”å›ä¸€ä¸ª <code>NavigableSet</code>ï¼Œè€Œä¸æ˜¯æ™®é€šçš„ <code>keySet()</code>ã€‚<code>NavigableSet</code> æä¾›äº†æ›´å¤šçš„æ“ä½œï¼Œä¾‹å¦‚è¿”å›ä¸‹ä¸€ä¸ªå’Œä¸Šä¸€ä¸ªé”®ã€‚</p>
<h4 data-id="heading-4">ç¤ºä¾‹ï¼š<code>SortedMap</code> çš„ä½¿ç”¨</h4>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥çœ‹çœ‹ <code>SortedMap</code> å’Œå…¶æ–¹æ³•å¦‚ä½•å·¥ä½œï¼š</p>
<pre><code class="hljs language-java" lang="java">SortedMap&lt;Integer, String&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>&lt;&gt;();
map.put(<span class="hljs-number">1</span>, <span class="hljs-string">"one"</span>);
map.put(<span class="hljs-number">2</span>, <span class="hljs-string">"two"</span>);
map.put(<span class="hljs-number">3</span>, <span class="hljs-string">"three"</span>);
map.put(<span class="hljs-number">5</span>, <span class="hljs-string">"five"</span>);
map.put(<span class="hljs-number">6</span>, <span class="hljs-string">"six"</span>);

<span class="hljs-comment">// è·å–æœ€å°é”®å’Œæœ€å¤§é”®</span>
System.out.println(<span class="hljs-string">"First Key: "</span> + map.firstKey()); <span class="hljs-comment">// è¾“å‡º 1</span>
System.out.println(<span class="hljs-string">"Last Key: "</span> + map.lastKey()); <span class="hljs-comment">// è¾“å‡º 6</span>

<span class="hljs-comment">// è·å–é”®å°äº3çš„éƒ¨åˆ†</span>
SortedMap&lt;Integer, String&gt; headMap = map.headMap(<span class="hljs-number">3</span>);
headMap.forEach((key, value) -&gt; System.out.println(key + <span class="hljs-string">" :: "</span> + value));

<span class="hljs-comment">// è·å–é”®å¤§äºæˆ–ç­‰äº3çš„éƒ¨åˆ†</span>
SortedMap&lt;Integer, String&gt; tailMap = map.tailMap(<span class="hljs-number">3</span>);
tailMap.forEach((key, value) -&gt; System.out.println(key + <span class="hljs-string">" :: "</span> + value));

<span class="hljs-comment">// è·å–é”®åœ¨3åˆ°5ä¹‹é—´çš„éƒ¨åˆ†</span>
SortedMap&lt;Integer, String&gt; subMap = map.subMap(<span class="hljs-number">3</span>, <span class="hljs-number">6</span>);
subMap.forEach((key, value) -&gt; System.out.println(key + <span class="hljs-string">" :: "</span> + value));
</code></pre>
<h4 data-id="heading-5">è¿è¡Œç»“æœï¼š</h4>
<pre><code class="hljs language-java" lang="java">First Key: <span class="hljs-number">1</span>
Last Key: <span class="hljs-number">6</span>
<span class="hljs-number">1</span> :: one
<span class="hljs-number">2</span> :: two
<span class="hljs-number">3</span> :: three
<span class="hljs-number">3</span> :: three
<span class="hljs-number">5</span> :: five
<span class="hljs-number">6</span> :: six
<span class="hljs-number">3</span> :: three
<span class="hljs-number">4</span> :: four
<span class="hljs-number">5</span> :: five
</code></pre>
<h4 data-id="heading-6">é”™è¯¯å¤„ç†ç¤ºä¾‹</h4>
<p><code>SortedMap</code> å’Œ <code>NavigableMap</code> è¿”å›çš„è§†å›¾åœ¨ä¿®æ”¹æ—¶æœ‰ä¸€äº›é™åˆ¶ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬é€šè¿‡ <code>headMap()</code> æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªè§†å›¾ï¼Œå¹¶è¯•å›¾å‘è¿™ä¸ªè§†å›¾æ’å…¥ä¸€ä¸ªä¸åœ¨èŒƒå›´å†…çš„é”®ï¼Œè¿™ä¼šå¯¼è‡´ <code>IllegalArgumentException</code> å¼‚å¸¸ã€‚</p>
<pre><code class="hljs language-java" lang="java">SortedMap&lt;Integer, String&gt; headMap = map.headMap(<span class="hljs-number">3</span>);
headMap.put(<span class="hljs-number">0</span>, <span class="hljs-string">"zero"</span>); <span class="hljs-comment">// è¿™ä¸ªæ˜¯åˆæ³•çš„ï¼Œå› ä¸º 0 &lt; 3</span>
headMap.put(<span class="hljs-number">4</span>, <span class="hljs-string">"four"</span>); <span class="hljs-comment">// è¿™ä¸ªä¼šæŠ›å‡º IllegalArgumentException å¼‚å¸¸ï¼Œå› ä¸º 4 ä¸åœ¨ headMap èŒƒå›´å†…</span>
</code></pre>
<h4 data-id="heading-7">è§£é‡Šï¼š</h4>
<ul>
<li><strong><code>headMap(3)</code></strong> è¿”å›ä¸€ä¸ªåªåŒ…å«å°äº3çš„é”®çš„ <code>SortedMap</code> è§†å›¾ã€‚å› æ­¤ï¼Œå‘è¯¥è§†å›¾æ’å…¥é”®å€¼å¯¹ <code>(4, "four")</code> ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå› ä¸º <code>4</code> è¶…å‡ºäº† <code>headMap</code> çš„é”®èŒƒå›´ã€‚</li>
<li>ä½†æ’å…¥ <code>(0, "zero")</code> æ˜¯åˆæ³•çš„ï¼Œå› ä¸º <code>0</code> å°äº3ã€‚</li>
</ul>
<h4 data-id="heading-8">é€šè¿‡ <code>Comparator</code> æ§åˆ¶æ’åº</h4>
<p>ä¸ <code>SortedSet</code> å’Œ <code>NavigableSet</code> ç±»ä¼¼ï¼Œ<code>SortedMap</code> å’Œ <code>NavigableMap</code> çš„é”®å¿…é¡»å®ç° <code>Comparable</code>ï¼Œæˆ–è€…ä½ å¯ä»¥åœ¨åˆ›å»º <code>TreeMap</code> æ—¶æä¾›ä¸€ä¸ª <code>Comparator</code>ï¼Œæ¥å†³å®šé”®çš„æ’åºæ–¹å¼ã€‚å¦‚æœæä¾›äº† <code>Comparator</code>ï¼Œå³ä½¿é”®å®ç°äº† <code>Comparable</code>ï¼Œ<code>Comparator</code> ä¹Ÿä¼šè¢«ä¼˜å…ˆä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-java" lang="java">TreeMap&lt;Integer, String&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeMap</span>&lt;&gt;(Comparator.reverseOrder());
map.put(<span class="hljs-number">1</span>, <span class="hljs-string">"one"</span>);
map.put(<span class="hljs-number">2</span>, <span class="hljs-string">"two"</span>);
map.put(<span class="hljs-number">3</span>, <span class="hljs-string">"three"</span>);

map.forEach((key, value) -&gt; System.out.println(key + <span class="hljs-string">" :: "</span> + value));
</code></pre>
<h4 data-id="heading-9">è¿è¡Œç»“æœï¼š</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-number">3</span> :: three
<span class="hljs-number">2</span> :: two
<span class="hljs-number">1</span> :: one
</code></pre>
<h4 data-id="heading-10">æ€»ç»“</h4>
<ul>
<li><strong><code>SortedMap</code></strong> å’Œ <strong><code>NavigableMap</code></strong> æä¾›äº†å¯¹é”®æ’åºçš„å¼ºå¤§æ”¯æŒï¼Œèƒ½å¤ŸæŒ‰é¡ºåºæŸ¥è¯¢é”®ï¼Œå¹¶å¯¹éƒ¨åˆ†é”®é›†åˆè¿›è¡Œæ“ä½œã€‚</li>
<li>é€šè¿‡ <code>headMap()</code>, <code>tailMap()</code>, <code>subMap()</code> ç­‰æ–¹æ³•ï¼Œä½ å¯ä»¥æ–¹ä¾¿åœ°è·å–æŒ‰é¡ºåºåˆ’åˆ†çš„ <code>Map</code> è§†å›¾ï¼Œå¹¶å¯¹è¿™äº›è§†å›¾è¿›è¡Œä¿®æ”¹ã€‚</li>
<li><code>NavigableMap</code> æä¾›äº†æ›´å¤šçš„æ–¹æ³•ï¼Œä¾‹å¦‚ <code>navigableKeySet()</code>ï¼Œè®©ä½ å¯ä»¥è·å¾—æ›´å¤šåŸºäºé¡ºåºæ“ä½œçš„åŠŸèƒ½ã€‚</li>
<li>åœ¨ä½¿ç”¨è§†å›¾æ—¶è¦æ³¨æ„ï¼Œä¸å¯ä»¥æ’å…¥ä¸åœ¨è§†å›¾èŒƒå›´å†…çš„é”®ã€‚</li>
</ul>
<p>é€šè¿‡è¿™äº›æ–¹æ³•å’Œç‰¹æ€§ï¼Œ<code>SortedMap</code> å’Œ <code>NavigableMap</code> èƒ½å¤Ÿå¸®åŠ©ä½ æ›´é«˜æ•ˆåœ°å¤„ç†æ’åºå’Œéƒ¨åˆ†è§†å›¾çš„éœ€æ±‚ï¼Œæ˜¯æ„å»ºæœ‰åº <code>Map</code> æ•°æ®ç»“æ„çš„ç†æƒ³é€‰æ‹©ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RabbitMQ æ¶ˆæ¯ä¸¢å¤±é—®é¢˜]]></title>    <link>https://juejin.cn/post/7578699975414726656</link>    <guid>https://juejin.cn/post/7578699975414726656</guid>    <pubDate>2025-12-02T00:57:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578699975414726656" data-draft-id="7578384621458473012" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RabbitMQ æ¶ˆæ¯ä¸¢å¤±é—®é¢˜"/> <meta itemprop="keywords" content="Java,RabbitMQ"/> <meta itemprop="datePublished" content="2025-12-02T00:57:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="uup"/> <meta itemprop="url" content="https://juejin.cn/user/4378706456356627"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RabbitMQ æ¶ˆæ¯ä¸¢å¤±é—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4378706456356627/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    uup
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T00:57:02.000Z" title="Tue Dec 02 2025 00:57:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€Bug åœºæ™¯</h2>
<p>åœ¨ä¸€ä¸ªç”µå•†ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨ RabbitMQ æ¥å¤„ç†è®¢å•ç›¸å…³çš„å¼‚æ­¥æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼Œå½“ç”¨æˆ·ä¸‹å•åï¼Œç³»ç»Ÿä¼šå‘é€ä¸€æ¡è®¢å•åˆ›å»ºçš„æ¶ˆæ¯åˆ° RabbitMQï¼Œç”±ä¸“é—¨çš„æ¶ˆè´¹è€…æœåŠ¡æ¥å¤„ç†è®¢å•åç»­çš„æ“ä½œï¼Œå¦‚åº“å­˜æ‰£å‡ã€è®¢å•çŠ¶æ€æ›´æ–°ç­‰ã€‚</p>
<h2 data-id="heading-1">äºŒã€ä»£ç ç¤ºä¾‹</h2>
<h3 data-id="heading-2">ç”Ÿäº§è€…ä»£ç ï¼ˆç®€åŒ–çš„ Java ç¤ºä¾‹ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.rabbitmq.client.ConnectionFactory;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Connection;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Channel;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderProducer</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">QUEUE_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order_queue"</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] argv)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">ConnectionFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConnectionFactory</span>();
        factory.setHost(<span class="hljs-string">"localhost"</span>);
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> factory.newConnection();
             <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> connection.createChannel()) {
            channel.queueDeclare(QUEUE_NAME, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">null</span>);
            <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-string">"æ–°è®¢å•åˆ›å»º"</span>;
            channel.basicPublish(<span class="hljs-string">""</span>, QUEUE_NAME, <span class="hljs-literal">null</span>, message.getBytes(<span class="hljs-string">"UTF-8"</span>));
            System.out.println(<span class="hljs-string">" [x] Sent '"</span> + message + <span class="hljs-string">"'"</span>);
        }
    }
}
</code></pre>
<h3 data-id="heading-3">æ¶ˆè´¹è€…ä»£ç ï¼ˆç®€åŒ–çš„ Java ç¤ºä¾‹ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.rabbitmq.client.ConnectionFactory;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Connection;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Channel;
<span class="hljs-keyword">import</span> com.rabbitmq.client.DefaultConsumer;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Envelope;
<span class="hljs-keyword">import</span> com.rabbitmq.client.AMQP;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderConsumer</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">QUEUE_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order_queue"</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] argv)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">ConnectionFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConnectionFactory</span>();
        factory.setHost(<span class="hljs-string">"localhost"</span>);
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> factory.newConnection();
        <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> connection.createChannel();

        channel.queueDeclare(QUEUE_NAME, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">null</span>);
        System.out.println(<span class="hljs-string">" [*] Waiting for messages. To exit press CTRL+C"</span>);

        channel.basicConsume(QUEUE_NAME, <span class="hljs-literal">true</span>,
                <span class="hljs-string">"orderConsumerTag"</span>,
                (consumerTag, delivery) -&gt; {
                    <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(delivery.getBody(), <span class="hljs-string">"UTF-8"</span>);
                    System.out.println(<span class="hljs-string">" [x] Received '"</span> + message + <span class="hljs-string">"'"</span>);
                    <span class="hljs-comment">// æ¨¡æ‹Ÿè®¢å•å¤„ç†ä¸šåŠ¡é€»è¾‘</span>
                    processOrder(message);
                },
                consumerTag -&gt; {
                    System.out.println(<span class="hljs-string">"Consumer cancelled: "</span> + consumerTag);
                });
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processOrder</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-comment">// æ¨¡æ‹Ÿè®¢å•å¤„ç†</span>
        System.out.println(<span class="hljs-string">"è®¢å•å¤„ç†ä¸­: "</span> + message);
    }
}
</code></pre>
<h2 data-id="heading-4">ä¸‰ã€é—®é¢˜æè¿°</h2>
<ol>
<li>
<p><strong>é¢„æœŸè¡Œä¸º</strong>ï¼šç”Ÿäº§è€…å‘é€çš„è®¢å•æ¶ˆæ¯èƒ½å¯é åœ°è¢«æ¶ˆè´¹è€…æ¥æ”¶å¹¶å¤„ç†ï¼Œä¸ä¼šå‡ºç°æ¶ˆæ¯ä¸¢å¤±çš„æƒ…å†µã€‚</p>
</li>
<li>
<p><strong>å®é™…è¡Œä¸º</strong>ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚ç”Ÿäº§è€…å‘é€æ¶ˆæ¯å RabbitMQ æœåŠ¡å™¨é‡å¯ï¼Œæˆ–è€…æ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯è¿‡ç¨‹ä¸­çªç„¶å´©æºƒï¼Œæ¶ˆæ¯å¯èƒ½ä¼šä¸¢å¤±ã€‚</p>
<ul>
<li><strong>ç”Ÿäº§è€…ç«¯</strong>ï¼šåœ¨ä¸Šè¿°ç”Ÿäº§è€…ä»£ç ä¸­ï¼Œ<code>basicPublish</code>Â æ–¹æ³•è°ƒç”¨åå¹¶æ²¡æœ‰ç¡®è®¤æœºåˆ¶æ¥ç¡®ä¿æ¶ˆæ¯å·²è¢« RabbitMQ æœåŠ¡å™¨æ­£ç¡®æ¥æ”¶ã€‚å¦‚æœåœ¨æ¶ˆæ¯å‘é€åˆ°æœåŠ¡å™¨ä½†è¿˜æœªè¢«æŒä¹…åŒ–æ—¶æœåŠ¡å™¨é‡å¯ï¼Œæ¶ˆæ¯å°±ä¼šä¸¢å¤±ã€‚</li>
<li><strong>æ¶ˆè´¹è€…ç«¯</strong>ï¼šåœ¨æ¶ˆè´¹è€…ä»£ç ä¸­ï¼Œ<code>basicConsume</code>Â æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°Â <code>autoAck</code>Â è®¾ç½®ä¸ºÂ <code>true</code>ï¼Œè¿™æ„å‘³ç€æ¶ˆè´¹è€…ä¸€æ—¦æ¥æ”¶åˆ°æ¶ˆæ¯ï¼ŒRabbitMQ å°±ä¼šè‡ªåŠ¨å°†å…¶ä»é˜Ÿåˆ—ä¸­åˆ é™¤ã€‚å¦‚æœæ¶ˆè´¹è€…åœ¨å¤„ç†æ¶ˆæ¯è¿‡ç¨‹ä¸­å´©æºƒï¼Œè¿˜æœªå¤„ç†å®Œçš„æ¶ˆæ¯å°±ä¼šä¸¢å¤±ã€‚</li>
</ul>
</li>
</ol>
<h2 data-id="heading-5">å››ã€è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-6">ç”Ÿäº§è€…ç«¯</h3>
<ol>
<li>
<p><strong>å¼€å¯å‘å¸ƒç¡®è®¤æœºåˆ¶</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.rabbitmq.client.ConnectionFactory;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Connection;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Channel;
<span class="hljs-keyword">import</span> com.rabbitmq.client.ConfirmCallback;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderProducer</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">QUEUE_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order_queue"</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] argv)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">ConnectionFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConnectionFactory</span>();
        factory.setHost(<span class="hljs-string">"localhost"</span>);
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> factory.newConnection();
             <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> connection.createChannel()) {
            channel.queueDeclare(QUEUE_NAME, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">null</span>);
            channel.confirmSelect();
            channel.addConfirmListener((sequenceNumber, multiple) -&gt; {
                <span class="hljs-keyword">if</span> (multiple) {
                    System.out.println(<span class="hljs-string">"Multiple messages confirmed up to sequence number: "</span> + sequenceNumber);
                } <span class="hljs-keyword">else</span> {
                    System.out.println(<span class="hljs-string">"Message with sequence number: "</span> + sequenceNumber + <span class="hljs-string">" confirmed"</span>);
                }
            }, (sequenceNumber, multiple) -&gt; {
                System.out.println(<span class="hljs-string">"Message(s) with sequence number(s) up to: "</span> + sequenceNumber + <span class="hljs-string">" were not confirmed"</span>);
            });

            <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-string">"æ–°è®¢å•åˆ›å»º"</span>;
            channel.basicPublish(<span class="hljs-string">""</span>, QUEUE_NAME, <span class="hljs-literal">null</span>, message.getBytes(<span class="hljs-string">"UTF-8"</span>));
            System.out.println(<span class="hljs-string">" [x] Sent '"</span> + message + <span class="hljs-string">"'"</span>);
        }
    }
}
</code></pre>
<p>ä¸Šè¿°ä»£ç ä¸­ï¼Œé€šè¿‡Â <code>channel.confirmSelect()</code>Â å¼€å¯å‘å¸ƒç¡®è®¤æœºåˆ¶ï¼Œå¹¶æ·»åŠ ç¡®è®¤ç›‘å¬å™¨ï¼Œç¡®ä¿æ¶ˆæ¯æˆåŠŸå‘é€åˆ° RabbitMQ æœåŠ¡å™¨ã€‚</p>
</li>
</ol>
<h3 data-id="heading-7">æ¶ˆè´¹è€…ç«¯</h3>
<ol>
<li>
<p><strong>å…³é—­è‡ªåŠ¨ç¡®è®¤ï¼Œæ‰‹åŠ¨ç¡®è®¤æ¶ˆæ¯</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.rabbitmq.client.ConnectionFactory;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Connection;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Channel;
<span class="hljs-keyword">import</span> com.rabbitmq.client.DefaultConsumer;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Envelope;
<span class="hljs-keyword">import</span> com.rabbitmq.client.AMQP;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderConsumer</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">QUEUE_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order_queue"</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] argv)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">ConnectionFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConnectionFactory</span>();
        factory.setHost(<span class="hljs-string">"localhost"</span>);
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> factory.newConnection();
        <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> connection.createChannel();

        channel.queueDeclare(QUEUE_NAME, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">null</span>);
        System.out.println(<span class="hljs-string">" [*] Waiting for messages. To exit press CTRL+C"</span>);

        channel.basicConsume(QUEUE_NAME, <span class="hljs-literal">false</span>,
                <span class="hljs-string">"orderConsumerTag"</span>,
                (consumerTag, delivery) -&gt; {
                    <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(delivery.getBody(), <span class="hljs-string">"UTF-8"</span>);
                    System.out.println(<span class="hljs-string">" [x] Received '"</span> + message + <span class="hljs-string">"'"</span>);
                    <span class="hljs-keyword">try</span> {
                        <span class="hljs-comment">// æ¨¡æ‹Ÿè®¢å•å¤„ç†ä¸šåŠ¡é€»è¾‘</span>
                        processOrder(message);
                        channel.basicAck(delivery.getEnvelope().getDeliveryTag(), <span class="hljs-literal">false</span>);
                    } <span class="hljs-keyword">catch</span> (Exception e) {
                        channel.basicNack(delivery.getEnvelope().getDeliveryTag(), <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);
                    }
                },
                consumerTag -&gt; {
                    System.out.println(<span class="hljs-string">"Consumer cancelled: "</span> + consumerTag);
                });
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processOrder</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-comment">// æ¨¡æ‹Ÿè®¢å•å¤„ç†</span>
        System.out.println(<span class="hljs-string">"è®¢å•å¤„ç†ä¸­: "</span> + message);
    }
}
</code></pre>
<p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå°†Â <code>basicConsume</code>Â çš„Â <code>autoAck</code>Â è®¾ç½®ä¸ºÂ <code>false</code>ï¼Œæ¶ˆè´¹è€…å¤„ç†å®Œæ¶ˆæ¯åæ‰‹åŠ¨è°ƒç”¨Â <code>basicAck</code>Â ç¡®è®¤æ¶ˆæ¯ï¼Œè‹¥å¤„ç†å¤±è´¥åˆ™è°ƒç”¨Â <code>basicNack</code>Â å¹¶æ ¹æ®æƒ…å†µå†³å®šæ˜¯å¦é‡æ–°å…¥é˜Ÿï¼Œä»è€Œé¿å…æ¶ˆæ¯ä¸¢å¤±ã€‚åŒæ—¶ï¼Œå°†é˜Ÿåˆ—å£°æ˜ä¸ºæŒä¹…åŒ–ï¼ˆ<code>queueDeclare</code>Â çš„ç¬¬ä¸€ä¸ªå‚æ•°è®¾ä¸ºÂ <code>true</code>ï¼‰ï¼Œä¿è¯ RabbitMQ æœåŠ¡å™¨é‡å¯åé˜Ÿåˆ—å’Œæ¶ˆæ¯ä¾ç„¶å­˜åœ¨ã€‚</p>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RabbitMQ ä¸ Java é›†æˆæ—¶çš„æ¶ˆæ¯é¡ºåºæ€§é—®é¢˜]]></title>    <link>https://juejin.cn/post/7578699975414743040</link>    <guid>https://juejin.cn/post/7578699975414743040</guid>    <pubDate>2025-12-02T00:57:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578699975414743040" data-draft-id="7578405594119815202" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RabbitMQ ä¸ Java é›†æˆæ—¶çš„æ¶ˆæ¯é¡ºåºæ€§é—®é¢˜"/> <meta itemprop="keywords" content="Java,RabbitMQ"/> <meta itemprop="datePublished" content="2025-12-02T00:57:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="uup"/> <meta itemprop="url" content="https://juejin.cn/user/4378706456356627"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RabbitMQ ä¸ Java é›†æˆæ—¶çš„æ¶ˆæ¯é¡ºåºæ€§é—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4378706456356627/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    uup
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T00:57:45.000Z" title="Tue Dec 02 2025 00:57:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€Bug åœºæ™¯</h2>
<p>åœ¨ä¸€ä¸ªé‡‘èäº¤æ˜“ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨ RabbitMQ ä½œä¸ºæ¶ˆæ¯ä¸­é—´ä»¶æ¥å¤„ç†äº¤æ˜“ç›¸å…³çš„æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·å‘èµ·ä¸€ç¬”è‚¡ç¥¨äº¤æ˜“ï¼Œç³»ç»Ÿä¼šä¾æ¬¡å‘é€ â€œè®¢å•åˆ›å»ºâ€ã€â€œèµ„é‡‘å†»ç»“â€ã€â€œè‚¡ç¥¨äº¤å‰²â€ ç­‰æ¶ˆæ¯ã€‚è¿™äº›æ¶ˆæ¯éœ€è¦æŒ‰ç…§é¡ºåºè¢«æ¶ˆè´¹å’Œå¤„ç†ï¼Œä»¥ç¡®ä¿äº¤æ˜“æµç¨‹çš„æ­£ç¡®æ€§ã€‚</p>
<h2 data-id="heading-1">äºŒã€ä»£ç ç¤ºä¾‹</h2>
<h3 data-id="heading-2">ç”Ÿäº§è€…ä»£ç </h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.rabbitmq.client.ConnectionFactory;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Connection;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Channel;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TradingProducer</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">QUEUE_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"trading_queue"</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] argv)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">ConnectionFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConnectionFactory</span>();
        factory.setHost(<span class="hljs-string">"localhost"</span>);
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> factory.newConnection();
             <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> connection.createChannel()) {
            channel.queueDeclare(QUEUE_NAME, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">null</span>);

            String[] messages = {<span class="hljs-string">"è®¢å•åˆ›å»º"</span>, <span class="hljs-string">"èµ„é‡‘å†»ç»“"</span>, <span class="hljs-string">"è‚¡ç¥¨äº¤å‰²"</span>};
            <span class="hljs-keyword">for</span> (String message : messages) {
                channel.basicPublish(<span class="hljs-string">""</span>, QUEUE_NAME, <span class="hljs-literal">null</span>, message.getBytes(<span class="hljs-string">"UTF - 8"</span>));
                System.out.println(<span class="hljs-string">" [x] Sent '"</span> + message + <span class="hljs-string">"'"</span>);
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-3">æ¶ˆè´¹è€…ä»£ç </h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.rabbitmq.client.ConnectionFactory;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Connection;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Channel;
<span class="hljs-keyword">import</span> com.rabbitmq.client.DefaultConsumer;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Envelope;
<span class="hljs-keyword">import</span> com.rabbitmq.client.AMQP;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TradingConsumer</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">QUEUE_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"trading_queue"</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] argv)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">ConnectionFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConnectionFactory</span>();
        factory.setHost(<span class="hljs-string">"localhost"</span>);
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> factory.newConnection();
        <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> connection.createChannel();

        channel.queueDeclare(QUEUE_NAME, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">null</span>);

        channel.basicConsume(QUEUE_NAME, <span class="hljs-literal">true</span>,
                <span class="hljs-string">"tradingConsumerTag"</span>,
                (consumerTag, delivery) -&gt; {
                    <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(delivery.getBody(), <span class="hljs-string">"UTF - 8"</span>);
                    System.out.println(<span class="hljs-string">" [x] Received '"</span> + message + <span class="hljs-string">"'"</span>);
                    processMessage(message);
                },
                consumerTag -&gt; {
                    System.out.println(<span class="hljs-string">"Consumer cancelled: "</span> + consumerTag);
                });
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processMessage</span><span class="hljs-params">(String message)</span> {
        System.out.println(<span class="hljs-string">"Processing message: "</span> + message);
    }
}
</code></pre>
<h2 data-id="heading-4">ä¸‰ã€é—®é¢˜æè¿°</h2>
<ol>
<li><strong>é¢„æœŸè¡Œä¸º</strong>ï¼šæ¶ˆè´¹è€…æŒ‰ç…§ç”Ÿäº§è€…å‘é€æ¶ˆæ¯çš„é¡ºåºä¾æ¬¡æ¥æ”¶å’Œå¤„ç† â€œè®¢å•åˆ›å»ºâ€ã€â€œèµ„é‡‘å†»ç»“â€ã€â€œè‚¡ç¥¨äº¤å‰²â€ æ¶ˆæ¯ï¼Œä»¥ä¿è¯äº¤æ˜“æµç¨‹çš„æ­£ç¡®æ‰§è¡Œã€‚</li>
<li><strong>å®é™…è¡Œä¸º</strong>ï¼šåœ¨å®é™…è¿è¡Œä¸­ï¼Œå°¤å…¶æ˜¯åœ¨é«˜å¹¶å‘æˆ–è€…ç½‘ç»œä¸ç¨³å®šçš„æƒ…å†µä¸‹ï¼Œæ¶ˆè´¹è€…å¯èƒ½ä¼šä¹±åºæ¥æ”¶æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼Œå…ˆæ¥æ”¶åˆ° â€œèµ„é‡‘å†»ç»“â€ï¼Œç„¶åæ˜¯ â€œè®¢å•åˆ›å»ºâ€ï¼Œæœ€åæ˜¯ â€œè‚¡ç¥¨äº¤å‰²â€ã€‚è¿™æ˜¯å› ä¸º RabbitMQ é»˜è®¤æƒ…å†µä¸‹ä¸ä¿è¯æ¶ˆæ¯çš„é¡ºåºæ€§ã€‚åœ¨æ¶ˆæ¯çš„ç”Ÿäº§ã€ä¼ è¾“å’Œæ¶ˆè´¹è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šç”±äºç½‘ç»œæ³¢åŠ¨ã€å¤šä¸ªæ¶ˆè´¹è€…ç«äº‰ã€æ¶ˆæ¯åœ¨é˜Ÿåˆ—ä¸­çš„å­˜å‚¨å’Œè½¬å‘æœºåˆ¶ç­‰å› ç´ ï¼Œå¯¼è‡´æ¶ˆæ¯çš„é¡ºåºå‘ç”Ÿå˜åŒ–ã€‚</li>
</ol>
<h2 data-id="heading-5">å››ã€è§£å†³æ–¹æ¡ˆ</h2>
<ol>
<li><strong>ä½¿ç”¨å•ä¸ªæ¶ˆè´¹è€…</strong>ï¼šç¡®ä¿åªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­æ¥æ”¶æ¶ˆæ¯ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ¶ˆæ¯çš„é¡ºåºæ€§ã€‚ä½†è¿™ç§æ–¹å¼æ— æ³•å……åˆ†åˆ©ç”¨å¤šæ¶ˆè´¹è€…çš„å¹¶è¡Œå¤„ç†èƒ½åŠ›ï¼Œå¯èƒ½ä¼šå½±å“ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½ã€‚</li>
<li><strong>åˆ†åŒºé˜Ÿåˆ—</strong>ï¼šæ ¹æ®æŸä¸ªä¸šåŠ¡æ ‡è¯†ï¼ˆå¦‚äº¤æ˜“ IDï¼‰å¯¹æ¶ˆæ¯è¿›è¡Œåˆ†åŒºï¼Œç›¸åŒä¸šåŠ¡æ ‡è¯†çš„æ¶ˆæ¯å‘é€åˆ°åŒä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ¯ä¸ªé˜Ÿåˆ—ç”±ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†ã€‚è¿™æ ·å¯ä»¥åœ¨ä¿è¯åŒä¸€ä¸šåŠ¡æµç¨‹æ¶ˆæ¯é¡ºåºçš„åŒæ—¶ï¼Œåˆ©ç”¨å¤šä¸ªé˜Ÿåˆ—å’Œæ¶ˆè´¹è€…å®ç°å¹¶è¡Œå¤„ç†ã€‚</li>
</ol>
<h3 data-id="heading-6">ä¿®æ”¹åçš„ç”Ÿäº§è€…ä»£ç ï¼ˆä½¿ç”¨åˆ†åŒºé˜Ÿåˆ—ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.rabbitmq.client.ConnectionFactory;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Connection;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Channel;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TradingProducer</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">EXCHANGE_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"trading_exchange"</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] argv)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">ConnectionFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConnectionFactory</span>();
        factory.setHost(<span class="hljs-string">"localhost"</span>);
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> factory.newConnection();
             <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> connection.createChannel()) {
            channel.exchangeDeclare(EXCHANGE_NAME, <span class="hljs-string">"direct"</span>);

            String[] messages = {<span class="hljs-string">"è®¢å•åˆ›å»º"</span>, <span class="hljs-string">"èµ„é‡‘å†»ç»“"</span>, <span class="hljs-string">"è‚¡ç¥¨äº¤å‰²"</span>};
            <span class="hljs-type">String</span> <span class="hljs-variable">routingKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"12345"</span>;<span class="hljs-comment">// å‡è®¾äº¤æ˜“ ID</span>
            <span class="hljs-keyword">for</span> (String message : messages) {
                channel.basicPublish(EXCHANGE_NAME, routingKey, <span class="hljs-literal">null</span>, message.getBytes(<span class="hljs-string">"UTF - 8"</span>));
                System.out.println(<span class="hljs-string">" [x] Sent '"</span> + message + <span class="hljs-string">"' with routing key '"</span> + routingKey + <span class="hljs-string">"'"</span>);
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-7">ä¿®æ”¹åçš„æ¶ˆè´¹è€…ä»£ç ï¼ˆä½¿ç”¨åˆ†åŒºé˜Ÿåˆ—ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.rabbitmq.client.ConnectionFactory;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Connection;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Channel;
<span class="hljs-keyword">import</span> com.rabbitmq.client.DefaultConsumer;
<span class="hljs-keyword">import</span> com.rabbitmq.client.Envelope;
<span class="hljs-keyword">import</span> com.rabbitmq.client.AMQP;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TradingConsumer</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">EXCHANGE_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"trading_exchange"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">QUEUE_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"trading_queue_12345"</span>;<span class="hljs-comment">// æ ¹æ®äº¤æ˜“ ID å‘½åé˜Ÿåˆ—</span>

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] argv)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">ConnectionFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConnectionFactory</span>();
        factory.setHost(<span class="hljs-string">"localhost"</span>);
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> factory.newConnection();
        <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> connection.createChannel();

        channel.exchangeDeclare(EXCHANGE_NAME, <span class="hljs-string">"direct"</span>);
        channel.queueDeclare(QUEUE_NAME, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">null</span>);
        channel.queueBind(QUEUE_NAME, EXCHANGE_NAME, <span class="hljs-string">"12345"</span>);<span class="hljs-comment">// æ ¹æ®äº¤æ˜“ ID ç»‘å®šé˜Ÿåˆ—</span>

        channel.basicConsume(QUEUE_NAME, <span class="hljs-literal">true</span>,
                <span class="hljs-string">"tradingConsumerTag"</span>,
                (consumerTag, delivery) -&gt; {
                    <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(delivery.getBody(), <span class="hljs-string">"UTF - 8"</span>);
                    System.out.println(<span class="hljs-string">" [x] Received '"</span> + message + <span class="hljs-string">"'"</span>);
                    processMessage(message);
                },
                consumerTag -&gt; {
                    System.out.println(<span class="hljs-string">"Consumer cancelled: "</span> + consumerTag);
                });
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processMessage</span><span class="hljs-params">(String message)</span> {
        System.out.println(<span class="hljs-string">"Processing message: "</span> + message);
    }
}
</code></pre>
<ol start="3">
<li><strong>æ¶ˆæ¯æºå¸¦é¡ºåºæ ‡è¯†</strong>ï¼šç”Ÿäº§è€…åœ¨æ¶ˆæ¯ä¸­æ·»åŠ é¡ºåºæ ‡è¯†ï¼ˆå¦‚åºåˆ—å·ï¼‰ï¼Œæ¶ˆè´¹è€…åœ¨æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œæ ¹æ®æ ‡è¯†å¯¹æ¶ˆæ¯è¿›è¡Œæ’åºåå†å¤„ç†ã€‚è¿™ç§æ–¹å¼åœ¨å®ç°ä¸Šç›¸å¯¹å¤æ‚ï¼Œéœ€è¦é¢å¤–çš„é€»è¾‘æ¥ç®¡ç†å’Œå¤„ç†æ¶ˆæ¯é¡ºåºã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[10 ä¸ªå€¼å¾—å…³æ³¨çš„ PHP å†·é—¨åŒ… ä¸å¸¸ç”¨ä½†éå¸¸å€¼å¾—æ¨è]]></title>    <link>https://juejin.cn/post/7578777952726106146</link>    <guid>https://juejin.cn/post/7578777952726106146</guid>    <pubDate>2025-12-02T01:02:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578777952726106146" data-draft-id="7578714759337803776" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="10 ä¸ªå€¼å¾—å…³æ³¨çš„ PHP å†·é—¨åŒ… ä¸å¸¸ç”¨ä½†éå¸¸å€¼å¾—æ¨è"/> <meta itemprop="keywords" content="åç«¯,PHP"/> <meta itemprop="datePublished" content="2025-12-02T01:02:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            10 ä¸ªå€¼å¾—å…³æ³¨çš„ PHP å†·é—¨åŒ… ä¸å¸¸ç”¨ä½†éå¸¸å€¼å¾—æ¨è
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T01:02:49.000Z" title="Tue Dec 02 2025 01:02:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">10 ä¸ªå€¼å¾—å…³æ³¨çš„ PHP å†·é—¨åŒ… ä¸å¸¸ç”¨ä½†éå¸¸å€¼å¾—æ¨è</h2>
<p>å†™ PHP ä¹…äº†ï¼Œå¸¸ç”¨çš„å·¥å…·é“¾åŸºæœ¬å›ºå®šä¸‹æ¥ï¼šLaravel æˆ– Symfony åšæ¡†æ¶ï¼ŒGuzzle å¤„ç† HTTP è¯·æ±‚ï¼ŒCarbon å¤„ç†æ—¶é—´ï¼ŒPHPUnit å†™æµ‹è¯•ï¼ŒComposer ç®¡ç†ä¾èµ–ã€‚è¿™äº›éƒ½æ˜¯ PHP ç”Ÿæ€ä¸­çš„ä¸»æµé€‰æ‹©ã€‚</p>
<p>ä½†é™¤äº†è¿™äº›çŸ¥åé¡¹ç›®ï¼Œè¿˜æœ‰ä¸€æ‰¹æˆç†Ÿç¨³å®šã€ä¹…ç»ç”Ÿäº§ç¯å¢ƒè€ƒéªŒçš„åŒ…ï¼Œå®ƒä»¬å¾ˆå°‘å‡ºç°åœ¨çƒ­é—¨æ¦œå•æˆ–æŠ€æœ¯åˆ†äº«ä¸­ï¼Œå´åœ¨å®é™…å·¥ç¨‹ä¸­è§£å†³äº†å¤§é‡é—®é¢˜ã€‚æœ¬æ–‡æ•´ç†äº† 10 ä¸ªè¿™æ ·çš„åŒ…ï¼Œé™„å¸¦ä½¿ç”¨åœºæ™¯å’Œç¤ºä¾‹ä»£ç ã€‚</p>
<h3 data-id="heading-1">league/csv â€”â€” CSV å¤„ç†</h3>
<p>CSV çœ‹ä¼¼ç®€å•ï¼Œå®é™…å¤„ç†èµ·æ¥é—®é¢˜ä¸å°‘ï¼šå­—ç¬¦ç¼–ç ã€åˆ†éš”ç¬¦å·®å¼‚ã€æ ¼å¼ä¸è§„èŒƒçš„æ•°æ®ï¼Œéƒ½å¯èƒ½å¯¼è‡´è§£æå¤±è´¥ã€‚league/csv æä¾›äº†ç¬¦åˆ RFC æ ‡å‡†çš„å®Œæ•´å®ç°ï¼Œèƒ½å¤Ÿå¦¥å–„å¤„ç†è¿™äº›è¾¹ç•Œæƒ…å†µã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$csv</span> = <span class="hljs-title class_">Reader</span>::<span class="hljs-title function_ invoke__">createFromPath</span>(<span class="hljs-string">'users.csv'</span>, <span class="hljs-string">'r'</span>);
<span class="hljs-variable">$csv</span>-&gt;<span class="hljs-title function_ invoke__">setHeaderOffset</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$csv</span>-&gt;<span class="hljs-title function_ invoke__">getRecords</span>() <span class="hljs-keyword">as</span> <span class="hljs-variable">$record</span>) {
    <span class="hljs-comment">// è¿”å›ä»¥è¡¨å¤´ä¸ºé”®åçš„å…³è”æ•°ç»„</span>
}
</code></pre>
<p>ä¸»è¦ç‰¹ç‚¹ï¼š</p>
<ul>
<li>æ”¯æŒå„ç±»åˆ†éš”ç¬¦</li>
<li>è‡ªåŠ¨å¤„ç† BOM å¤´å’Œç¼–ç é—®é¢˜</li>
<li>è¯»å†™æ€§èƒ½ä¼˜ç§€</li>
<li>å…¼å®¹ Excel å¯¼å‡ºæ ¼å¼</li>
</ul>
<p>é€‚åˆåšæ•°æ®æŠ¥è¡¨ã€æ‰¹é‡å¯¼å…¥å¯¼å‡ºã€è´¢åŠ¡æ•°æ®å¤„ç†ç­‰åœºæ™¯ã€‚</p>
<h3 data-id="heading-2">brick/math â€”â€” é«˜ç²¾åº¦æ•°å­¦è¿ç®—</h3>
<p>PHP çš„æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜æ˜¯è€ç”Ÿå¸¸è°ˆï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-number">0.1</span> + <span class="hljs-number">0.2</span> <span class="hljs-comment">// ç»“æœæ˜¯ 0.30000000000000004</span>
</code></pre>
<p>åœ¨é‡‘èè®¡ç®—ã€è®¢å•é‡‘é¢ã€ç¨è´¹å¤„ç†ç­‰åœºæ™¯ä¸­ï¼Œè¿™ç§è¯¯å·®ä¸å¯æ¥å—ã€‚brick/math æä¾›äº†ä»»æ„ç²¾åº¦çš„æ•°å­¦è¿ç®—æ”¯æŒï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$a</span> = <span class="hljs-title class_">BigDecimal</span>::<span class="hljs-title function_ invoke__">of</span>(<span class="hljs-string">'0.1'</span>);
<span class="hljs-variable">$b</span> = <span class="hljs-title class_">BigDecimal</span>::<span class="hljs-title function_ invoke__">of</span>(<span class="hljs-string">'0.2'</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$a</span>-&gt;<span class="hljs-title function_ invoke__">plus</span>(<span class="hljs-variable">$b</span>); <span class="hljs-comment">// è¾“å‡º 0.3ï¼Œç²¾ç¡®å€¼</span>
</code></pre>
<p>æ¶‰åŠè´§å¸è®¡ç®—çš„é¡¹ç›®ï¼Œå»ºè®®å°†å…¶ä½œä¸ºæ ‡å‡†ä¾èµ–ã€‚</p>
<h3 data-id="heading-3">ramsey/uuid â€”â€” UUID ç”Ÿæˆ</h3>
<p>UUID æœ‰ä¸¥æ ¼çš„æ ¼å¼è§„èŒƒå’Œå¤šä¸ªç‰ˆæœ¬æ ‡å‡†ï¼Œä¸èƒ½ç®€å•åœ°ç”¨éšæœºå­—ç¬¦ä¸²ä»£æ›¿ã€‚ramsey/uuid æ˜¯ PHP ç”Ÿæ€ä¸­æœ€å®Œå–„çš„ UUID å®ç°ï¼š</p>
<ul>
<li>æ”¯æŒ UUID v1 åˆ° v7 æ‰€æœ‰ç‰ˆæœ¬</li>
<li>ç”Ÿæˆæ–¹å¼ç¬¦åˆè§„èŒƒ</li>
<li>ä¸ Laravelã€Doctrine ç­‰æ¡†æ¶é›†æˆè‰¯å¥½</li>
</ul>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿã€å¾®æœåŠ¡æ¶æ„ã€éœ€è¦å¯¹å¤–æš´éœ²æ ‡è¯†ç¬¦çš„åœºæ™¯ä¸­ï¼ŒUUID æ¯”è‡ªå¢ ID æ›´å®‰å…¨ï¼Œä¹Ÿæ›´ä¾¿äºæ•°æ®åˆå¹¶å’Œè¿ç§»ã€‚</p>
<h3 data-id="heading-4">opis/closure â€”â€” é—­åŒ…åºåˆ—åŒ–</h3>
<p>PHP åŸç”Ÿä¸æ”¯æŒé—­åŒ…çš„åºåˆ—åŒ–ï¼Œä½†åœ¨å·¥ä½œæµå¼•æ“ã€ä»»åŠ¡é˜Ÿåˆ—ã€åŠ¨æ€è§„åˆ™é…ç½®ç­‰åœºæ™¯ä¸­ï¼Œæœ‰æ—¶ç¡®å®éœ€è¦å°†é—­åŒ…æŒä¹…åŒ–å­˜å‚¨æˆ–è·¨è¿›ç¨‹ä¼ é€’ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$closure</span> = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-variable">$name</span></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello <span class="hljs-subst">$name</span>"</span>;
};

<span class="hljs-variable">$serialized</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SerializableClosure</span>(<span class="hljs-variable">$closure</span>));
</code></pre>
<p>opis/closure æä¾›äº†å®‰å…¨å¯é çš„é—­åŒ…åºåˆ—åŒ–æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-5">symfony/var-dumper â€”â€” è°ƒè¯•è¾“å‡º</h3>
<p>ç›¸æ¯”åŸç”Ÿçš„ <code>var_dump()</code>ï¼Œsymfony/var-dumper æä¾›äº†æ›´å‹å¥½çš„è°ƒè¯•è¾“å‡ºï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">dump</span>(<span class="hljs-variable">$user</span>);
<span class="hljs-title function_ invoke__">dd</span>(<span class="hljs-variable">$response</span>);
</code></pre>
<p>è¾“å‡ºå¸¦æœ‰è¯­æ³•é«˜äº®ã€å±‚çº§æŠ˜å ï¼Œèƒ½å¤Ÿæ­£ç¡®å¤„ç†å¾ªç¯å¼•ç”¨ï¼Œåœ¨æµè§ˆå™¨å’Œå‘½ä»¤è¡Œç¯å¢ƒä¸‹éƒ½æœ‰è‰¯å¥½çš„æ˜¾ç¤ºæ•ˆæœã€‚</p>
<h3 data-id="heading-6">brick/phone-number â€”â€” ç”µè¯å·ç å¤„ç†</h3>
<p>ç”µè¯å·ç çš„æ ¼å¼å› å›½å®¶å’Œåœ°åŒºè€Œå¼‚ï¼Œç”¨æ­£åˆ™è¡¨è¾¾å¼å¤„ç†å¾ˆéš¾è¦†ç›–æ‰€æœ‰æƒ…å†µã€‚brick/phone-number åŸºäº Google çš„ libphonenumber åº“ï¼Œæä¾›äº†å®Œæ•´çš„è§£æå’Œæ ¼å¼åŒ–æ”¯æŒï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$phone</span> = <span class="hljs-title class_">PhoneNumber</span>::<span class="hljs-title function_ invoke__">parse</span>(<span class="hljs-string">'+1 202-555-0123'</span>);
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$phone</span>-&gt;<span class="hljs-title function_ invoke__">format</span>(<span class="hljs-title class_">PhoneNumberFormat</span>::<span class="hljs-variable constant_">INTERNATIONAL</span>);
</code></pre>
<p>é€‚åˆç”¨æˆ·æ³¨å†Œã€CRM ç³»ç»Ÿã€å›½é™…åŒ–åº”ç”¨ç­‰éœ€è¦å¤„ç†å¤šå›½ç”µè¯å·ç çš„åœºæ™¯ã€‚</p>
<p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œè¿™ä¸ªåŒ…åªéªŒè¯å·ç æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Œä¸éªŒè¯å·ç æ˜¯å¦çœŸå®å­˜åœ¨ã€‚</p>
<h3 data-id="heading-7">spatie/laravel-permission â€”â€” æƒé™ç®¡ç†</h3>
<p>æƒé™ç³»ç»Ÿæ˜¯å¤§å¤šæ•°åº”ç”¨çš„åŸºç¡€åŠŸèƒ½ï¼Œä½†è‡ªå·±å®ç°å®¹æ˜“é—æ¼ç»†èŠ‚ã€‚spatie/laravel-permission æ˜¯ Laravel ç”Ÿæ€ä¸­æœ€æˆç†Ÿçš„æƒé™ç®¡ç†æ–¹æ¡ˆï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">givePermissionTo</span>(<span class="hljs-string">'edit articles'</span>);
<span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">assignRole</span>(<span class="hljs-string">'admin'</span>);
</code></pre>
<p>åŠŸèƒ½è¦†ç›–è§’è‰²ç®¡ç†ã€æƒé™åˆ†é…ã€ä¸­é—´ä»¶é›†æˆã€å¤šç§Ÿæˆ·æ”¯æŒã€æƒé™ç¼“å­˜ç­‰ï¼Œç»è¿‡å¤§é‡ç”Ÿäº§é¡¹ç›®éªŒè¯ã€‚</p>
<h3 data-id="heading-8">dragonmantank/cron-expression â€”â€” Cron è¡¨è¾¾å¼è§£æ</h3>
<p>Laravel çš„ä»»åŠ¡è°ƒåº¦åŠŸèƒ½åº•å±‚å°±ä½¿ç”¨äº†è¿™ä¸ªåŒ…ã€‚å®ƒå¯ä»¥è§£æ cron è¡¨è¾¾å¼ï¼Œåˆ¤æ–­ä»»åŠ¡æ˜¯å¦åˆ°æœŸï¼Œè®¡ç®—ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$cron</span> = <span class="hljs-title class_">CronExpression</span>::<span class="hljs-title function_ invoke__">factory</span>(<span class="hljs-string">'*/5 * * * *'</span>);
<span class="hljs-variable">$cron</span>-&gt;<span class="hljs-title function_ invoke__">isDue</span>();
</code></pre>
<p>è‡ªå·±å®ç°å®šæ—¶ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿæ—¶ä¼šç”¨åˆ°ã€‚</p>
<h3 data-id="heading-9">league/fractal â€”â€” API å“åº”è½¬æ¢</h3>
<p>éšç€é¡¹ç›®è§„æ¨¡å¢é•¿ï¼ŒAPI å“åº”æ ¼å¼å®¹æ˜“å˜å¾—ä¸ä¸€è‡´ã€‚league/fractal æä¾›äº†ä¸€å¥—æ ‡å‡†åŒ–çš„æ•°æ®è½¬æ¢å±‚ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserTransformer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">TransformerAbstract</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transform</span>(<span class="hljs-params">User <span class="hljs-variable">$user</span></span>) </span>{
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'id'</span> =&gt; (<span class="hljs-keyword">int</span>) <span class="hljs-variable">$user</span>-&gt;id,
            <span class="hljs-string">'email'</span> =&gt; <span class="hljs-variable">$user</span>-&gt;email,
            <span class="hljs-string">'joined'</span> =&gt; <span class="hljs-variable">$user</span>-&gt;created_at-&gt;<span class="hljs-title function_ invoke__">toDateString</span>(),
        ];
    }
}
</code></pre>
<p>Laravel è‡ªå¸¦çš„ API Resources åŠŸèƒ½è¦†ç›–äº†ç±»ä¼¼åœºæ™¯ï¼Œä½† Fractal åœ¨ DDD æ¶æ„ã€å…­è¾¹å½¢æ¶æ„ã€é Laravel é¡¹ç›®ä¸­ä»æœ‰ä¼˜åŠ¿ã€‚</p>
<h3 data-id="heading-10">league/flysystem â€”â€” æ–‡ä»¶å­˜å‚¨æŠ½è±¡</h3>
<p>Laravel çš„ <code>Storage</code> é—¨é¢åº•å±‚å°±æ˜¯ Flysystemã€‚å®ƒå¯¹æ–‡ä»¶å­˜å‚¨è¿›è¡Œäº†æŠ½è±¡ï¼Œæ”¯æŒæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€AWS S3ã€Google Cloud Storageã€Azure Blobã€FTP ç­‰å¤šç§åç«¯ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$filesystem</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Filesystem</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalFilesystemAdapter</span>(<span class="hljs-string">'/path'</span>));
<span class="hljs-variable">$filesystem</span>-&gt;<span class="hljs-title function_ invoke__">write</span>(<span class="hljs-string">'file.txt'</span>, <span class="hljs-string">'Hello world'</span>);
</code></pre>
<p>ç»Ÿä¸€çš„ API ä½¿å¾—åˆ‡æ¢å­˜å‚¨åç«¯æ—¶æ— éœ€ä¿®æ”¹ä¸šåŠ¡ä»£ç ã€‚åœ¨å¾®æœåŠ¡æˆ–ç‹¬ç«‹ CLI å·¥å…·ä¸­ï¼Œå³ä½¿ä¸ä½¿ç”¨ Laravelï¼Œä¹Ÿå»ºè®®å¼•å…¥ <code>Flysystem</code> æ¥ç®¡ç†æ–‡ä»¶æ“ä½œã€‚</p>
<p>ä»¥ä¸Šè¿™äº›åŒ…è™½ç„¶çŸ¥ååº¦ä¸é«˜ï¼Œä½†éƒ½æ˜¯ç»è¿‡é•¿æœŸç»´æŠ¤ã€åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¾—åˆ°éªŒè¯çš„æˆç†Ÿæ–¹æ¡ˆã€‚æ ¹æ®é¡¹ç›®éœ€è¦é€‰ç”¨å‡ ä¸ªï¼Œå¯ä»¥å‡å°‘é‡å¤é€ è½®å­çš„å·¥ä½œé‡ï¼Œä¹Ÿèƒ½è®©ä»£ç æ›´åŠ è§„èŒƒå¯é ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼è¯¦è§£]]></title>    <link>https://juejin.cn/post/7578699866182680614</link>    <guid>https://juejin.cn/post/7578699866182680614</guid>    <pubDate>2025-12-02T01:10:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578699866182680614" data-draft-id="7578719771589361674" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼è¯¦è§£"/> <meta itemprop="keywords" content="è®¾è®¡æ¨¡å¼,Java"/> <meta itemprop="datePublished" content="2025-12-02T01:10:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T01:10:47.000Z" title="Tue Dec 02 2025 01:10:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ·±å…¥ç†è§£è®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserver Patternï¼‰</h2>
<h3 data-id="heading-1">ä¸€ã€å¼•è¨€</h3>
<p>åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„åœºæ™¯ï¼šä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œéœ€è¦é€šçŸ¥æ‰€æœ‰ä¾èµ–å®ƒçš„å¯¹è±¡ã€‚æ¯”å¦‚ï¼Œè‚¡ç¥¨ä»·æ ¼å˜åŒ–æ—¶é€šçŸ¥æ‰€æœ‰è‚¡æ°‘ï¼›è®¢å•çŠ¶æ€æ”¹å˜æ—¶é€šçŸ¥ç”¨æˆ·ã€ä»“åº“ã€ç‰©æµç­‰å¤šä¸ªç³»ç»Ÿï¼›å¾®ä¿¡å…¬ä¼—å·å‘å¸ƒæ–°æ–‡ç« æ—¶é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…ã€‚å¦‚æœè®©å¯¹è±¡ä¹‹é—´ç›´æ¥ç›¸äº’å¼•ç”¨ï¼Œä¼šé€ æˆç´§è€¦åˆï¼Œéš¾ä»¥ç»´æŠ¤å’Œæ‰©å±•ã€‚</p>
<p>è§‚å¯Ÿè€…æ¨¡å¼ä¸ºè¿™ç±»é—®é¢˜æä¾›äº†ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚å®ƒå°±åƒç°å®ä¸­çš„è®¢é˜…æœºåˆ¶ï¼šä½ è®¢é˜…äº†æŸä¸ªå…¬ä¼—å·ï¼Œå½“å…¬ä¼—å·å‘å¸ƒæ–°å†…å®¹æ—¶ï¼Œä½ ä¼šæ”¶åˆ°é€šçŸ¥ï¼›ä½ ä¸éœ€è¦æ—¶åˆ»ä¸»åŠ¨æŸ¥çœ‹ï¼Œå…¬ä¼—å·ä¹Ÿä¸éœ€è¦çŸ¥é“ä½ æ˜¯è°ï¼Œåªéœ€è¦åœ¨æœ‰æ–°å†…å®¹æ—¶æ¨é€ç»™æ‰€æœ‰è®¢é˜…è€…ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥æ¢è®¨è§‚å¯Ÿè€…æ¨¡å¼çš„åŸç†ã€å®ç°æ–¹å¼ï¼Œå¹¶ç»“åˆSpringäº‹ä»¶æœºåˆ¶ã€JDK Observableã€Guava EventBusç­‰æ¡†æ¶åº”ç”¨ï¼Œå¸®åŠ©ä½ å…¨é¢æŒæ¡è¿™ä¸€é‡è¦çš„è®¾è®¡æ¨¡å¼ã€‚</p>
<h3 data-id="heading-2">äºŒã€ä»€ä¹ˆæ˜¯è§‚å¯Ÿè€…æ¨¡å¼</h3>
<h4 data-id="heading-3">2.1 å®šä¹‰</h4>
<p>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserver Patternï¼‰æ˜¯ä¸€ç§è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ï¼Œå®ƒå®šä¹‰å¯¹è±¡é—´çš„ä¸€å¯¹å¤šä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚</p>
<h4 data-id="heading-4">2.2 æ ¸å¿ƒæ€æƒ³</h4>
<ul>
<li><strong>å‘å¸ƒ-è®¢é˜…</strong>ï¼šä¸»é¢˜ï¼ˆSubjectï¼‰å‘å¸ƒæ¶ˆæ¯ï¼Œè§‚å¯Ÿè€…ï¼ˆObserverï¼‰è®¢é˜…æ¶ˆæ¯</li>
<li><strong>æ¾è€¦åˆ</strong>ï¼šä¸»é¢˜å’Œè§‚å¯Ÿè€…ä¹‹é—´æ˜¯æŠ½è±¡è€¦åˆ</li>
<li><strong>å¹¿æ’­é€šä¿¡</strong>ï¼šä¸€ä¸ªä¸»é¢˜å¯ä»¥æœ‰å¤šä¸ªè§‚å¯Ÿè€…</li>
<li><strong>è‡ªåŠ¨é€šçŸ¥</strong>ï¼šçŠ¶æ€æ”¹å˜æ—¶è‡ªåŠ¨é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…</li>
</ul>
<h4 data-id="heading-5">2.3 æ¨¡å¼ç»“æ„</h4>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  &lt;&lt;interface&gt;&gt;          â”‚
â”‚      Subject            â”‚  æŠ½è±¡ä¸»é¢˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + <span class="hljs-built_in">attach</span>(Observer)      â”‚  æ³¨å†Œè§‚å¯Ÿè€…
â”‚ + <span class="hljs-built_in">detach</span>(Observer)      â”‚  ç§»é™¤è§‚å¯Ÿè€…
â”‚ + <span class="hljs-built_in">notify</span>()              â”‚  é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–³
            â”‚ å®ç°
     â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
     â”‚             â”‚
â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ConcreteSubjectâ”‚  â”‚  å…·ä½“ä¸»é¢˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚- state        â”‚  â”‚
â”‚+ <span class="hljs-built_in">getState</span>()   â”‚  â”‚
â”‚+ <span class="hljs-built_in">setState</span>()   â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                   â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”˜
            â”‚ æŒæœ‰
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  &lt;&lt;interface&gt;&gt;          â”‚
â”‚      Observer           â”‚  æŠ½è±¡è§‚å¯Ÿè€…
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + <span class="hljs-built_in">update</span>()              â”‚  æ›´æ–°æ–¹æ³•
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–³
            â”‚ å®ç°
     â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                 â”‚
â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ConcreteObserverA ConcreteObserverBâ”‚  å…·ä½“è§‚å¯Ÿè€…
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é€šçŸ¥æµç¨‹ï¼š
Subject<span class="hljs-selector-class">.setState</span>() â†’ <span class="hljs-built_in">notify</span>() â†’ Observer1<span class="hljs-selector-class">.update</span>()
                              â†’ Observer2<span class="hljs-selector-class">.update</span>()
                              â†’ Observer3<span class="hljs-selector-class">.update</span>()
</code></pre>
<h4 data-id="heading-6">2.4 è§‚å¯Ÿè€…æ¨¡å¼çš„ä¸¤ç§å®ç°</h4>
<pre><code class="hljs language-scss" lang="scss">æ¨æ¨¡å‹ï¼ˆPush Modelï¼‰ï¼š
Subject â†’ <span class="hljs-built_in">update</span>(data) â†’ Observer
ä¸»é¢˜æ¨é€æ•°æ®ç»™è§‚å¯Ÿè€…

æ‹‰æ¨¡å‹ï¼ˆPull Modelï¼‰ï¼š
Subject â†’ <span class="hljs-built_in">update</span>() â†’ Observer
            â†“
Observer â†’ <span class="hljs-built_in">getState</span>() â†’ Subject
è§‚å¯Ÿè€…ä¸»åŠ¨æ‹‰å–æ•°æ®
</code></pre>
<h3 data-id="heading-7">ä¸‰ã€åŸºç¡€ç¤ºä¾‹</h3>
<h4 data-id="heading-8">3.1 åœºæ™¯ï¼šå¤©æ°”ç«™</h4>
<p>ç»å…¸çš„è§‚å¯Ÿè€…æ¨¡å¼ç¤ºä¾‹ï¼šæ°”è±¡ç«™å‘å¸ƒå¤©æ°”æ•°æ®ï¼Œå¤šä¸ªæ˜¾ç¤ºè®¾å¤‡è®¢é˜…å¹¶æ˜¾ç¤ºã€‚</p>
<p><strong>æŠ½è±¡ä¸»é¢˜ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * æŠ½è±¡ä¸»é¢˜ï¼šè¢«è§‚å¯Ÿè€…
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Subject</span> {
    <span class="hljs-comment">/**
     * æ³¨å†Œè§‚å¯Ÿè€…
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerObserver</span><span class="hljs-params">(Observer observer)</span>;

    <span class="hljs-comment">/**
     * ç§»é™¤è§‚å¯Ÿè€…
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeObserver</span><span class="hljs-params">(Observer observer)</span>;

    <span class="hljs-comment">/**
     * é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyObservers</span><span class="hljs-params">()</span>;
}
</code></pre>
<p><strong>æŠ½è±¡è§‚å¯Ÿè€…ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æŠ½è±¡è§‚å¯Ÿè€…
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Observer</span> {
    <span class="hljs-comment">/**
     * æ›´æ–°æ–¹æ³•
     * <span class="hljs-doctag">@param</span> temperature æ¸©åº¦
     * <span class="hljs-doctag">@param</span> humidity æ¹¿åº¦
     * <span class="hljs-doctag">@param</span> pressure æ°”å‹
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">float</span> temperature, <span class="hljs-type">float</span> humidity, <span class="hljs-type">float</span> pressure)</span>;
}
</code></pre>
<p><strong>å…·ä½“ä¸»é¢˜ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å…·ä½“ä¸»é¢˜ï¼šæ°”è±¡ç«™
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WeatherStation</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Subject</span> {

    <span class="hljs-keyword">private</span> List&lt;Observer&gt; observers;
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> temperature;  <span class="hljs-comment">// æ¸©åº¦</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> humidity;     <span class="hljs-comment">// æ¹¿åº¦</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> pressure;     <span class="hljs-comment">// æ°”å‹</span>

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">WeatherStation</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>.observers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerObserver</span><span class="hljs-params">(Observer observer)</span> {
        <span class="hljs-keyword">if</span> (!observers.contains(observer)) {
            observers.add(observer);
            System.out.println(<span class="hljs-string">"[WeatherStation] æ–°å¢è§‚å¯Ÿè€…: "</span> + observer.getClass().getSimpleName());
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeObserver</span><span class="hljs-params">(Observer observer)</span> {
        <span class="hljs-keyword">if</span> (observers.remove(observer)) {
            System.out.println(<span class="hljs-string">"[WeatherStation] ç§»é™¤è§‚å¯Ÿè€…: "</span> + observer.getClass().getSimpleName());
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyObservers</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"\n[WeatherStation] é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…ï¼Œå…± "</span> + observers.size() + <span class="hljs-string">" ä¸ª"</span>);
        <span class="hljs-keyword">for</span> (Observer observer : observers) {
            observer.update(temperature, humidity, pressure);
        }
    }

    <span class="hljs-comment">/**
     * æ°”è±¡æ•°æ®æ”¹å˜
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setMeasurements</span><span class="hljs-params">(<span class="hljs-type">float</span> temperature, <span class="hljs-type">float</span> humidity, <span class="hljs-type">float</span> pressure)</span> {
        System.out.println(<span class="hljs-string">"\n========== æ°”è±¡æ•°æ®æ›´æ–° =========="</span>);
        System.out.println(<span class="hljs-string">"æ¸©åº¦: "</span> + temperature + <span class="hljs-string">"Â°C"</span>);
        System.out.println(<span class="hljs-string">"æ¹¿åº¦: "</span> + humidity + <span class="hljs-string">"%"</span>);
        System.out.println(<span class="hljs-string">"æ°”å‹: "</span> + pressure + <span class="hljs-string">" hPa"</span>);
        System.out.println(<span class="hljs-string">"================================"</span>);

        <span class="hljs-built_in">this</span>.temperature = temperature;
        <span class="hljs-built_in">this</span>.humidity = humidity;
        <span class="hljs-built_in">this</span>.pressure = pressure;

        <span class="hljs-comment">// æ•°æ®æ”¹å˜ï¼Œé€šçŸ¥è§‚å¯Ÿè€…</span>
        notifyObservers();
    }

    <span class="hljs-comment">// Getters</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> <span class="hljs-title function_">getTemperature</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> temperature; }
    <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> <span class="hljs-title function_">getHumidity</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> humidity; }
    <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> <span class="hljs-title function_">getPressure</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> pressure; }
}
</code></pre>
<p><strong>å…·ä½“è§‚å¯Ÿè€…ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å…·ä½“è§‚å¯Ÿè€…1ï¼šå½“å‰å¤©æ°”æ˜¾ç¤º
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CurrentConditionsDisplay</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Observer</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> temperature;
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> humidity;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">float</span> temperature, <span class="hljs-type">float</span> humidity, <span class="hljs-type">float</span> pressure)</span> {
        <span class="hljs-built_in">this</span>.temperature = temperature;
        <span class="hljs-built_in">this</span>.humidity = humidity;
        display();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"\n[å½“å‰å¤©æ°”æ˜¾ç¤º]"</span>);
        System.out.println(<span class="hljs-string">"  æ¸©åº¦: "</span> + temperature + <span class="hljs-string">"Â°C"</span>);
        System.out.println(<span class="hljs-string">"  æ¹¿åº¦: "</span> + humidity + <span class="hljs-string">"%"</span>);
    }
}

<span class="hljs-comment">/**
 * å…·ä½“è§‚å¯Ÿè€…2ï¼šå¤©æ°”ç»Ÿè®¡
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StatisticsDisplay</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Observer</span> {

    <span class="hljs-keyword">private</span> List&lt;Float&gt; temperatureHistory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">float</span> temperature, <span class="hljs-type">float</span> humidity, <span class="hljs-type">float</span> pressure)</span> {
        temperatureHistory.add(temperature);
        display();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span> {
        <span class="hljs-type">float</span> <span class="hljs-variable">avg</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>) temperatureHistory.stream()
                .mapToDouble(Float::doubleValue)
                .average()
                .orElse(<span class="hljs-number">0.0</span>);

        <span class="hljs-type">float</span> <span class="hljs-variable">max</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>) temperatureHistory.stream()
                .mapToDouble(Float::doubleValue)
                .max()
                .orElse(<span class="hljs-number">0.0</span>);

        <span class="hljs-type">float</span> <span class="hljs-variable">min</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>) temperatureHistory.stream()
                .mapToDouble(Float::doubleValue)
                .min()
                .orElse(<span class="hljs-number">0.0</span>);

        System.out.println(<span class="hljs-string">"\n[å¤©æ°”ç»Ÿè®¡]"</span>);
        System.out.println(<span class="hljs-string">"  å¹³å‡æ¸©åº¦: "</span> + String.format(<span class="hljs-string">"%.1f"</span>, avg) + <span class="hljs-string">"Â°C"</span>);
        System.out.println(<span class="hljs-string">"  æœ€é«˜æ¸©åº¦: "</span> + max + <span class="hljs-string">"Â°C"</span>);
        System.out.println(<span class="hljs-string">"  æœ€ä½æ¸©åº¦: "</span> + min + <span class="hljs-string">"Â°C"</span>);
    }
}

<span class="hljs-comment">/**
 * å…·ä½“è§‚å¯Ÿè€…3ï¼šå¤©æ°”é¢„æŠ¥
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ForecastDisplay</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Observer</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-variable">currentPressure</span> <span class="hljs-operator">=</span> <span class="hljs-number">1013.0f</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> lastPressure;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">float</span> temperature, <span class="hljs-type">float</span> humidity, <span class="hljs-type">float</span> pressure)</span> {
        lastPressure = currentPressure;
        currentPressure = pressure;
        display();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"\n[å¤©æ°”é¢„æŠ¥]"</span>);

        <span class="hljs-keyword">if</span> (currentPressure &gt; lastPressure) {
            System.out.println(<span class="hljs-string">"  å¤©æ°”è½¬å¥½"</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (currentPressure &lt; lastPressure) {
            System.out.println(<span class="hljs-string">"  å¯èƒ½ä¸‹é›¨"</span>);
        } <span class="hljs-keyword">else</span> {
            System.out.println(<span class="hljs-string">"  å¤©æ°”ç¨³å®š"</span>);
        }
    }
}
</code></pre>
<p><strong>å®¢æˆ·ç«¯ä½¿ç”¨ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WeatherStationDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åˆ›å»ºæ°”è±¡ç«™ï¼ˆä¸»é¢˜ï¼‰</span>
        <span class="hljs-type">WeatherStation</span> <span class="hljs-variable">weatherStation</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeatherStation</span>();

        <span class="hljs-comment">// åˆ›å»ºè§‚å¯Ÿè€…</span>
        <span class="hljs-type">CurrentConditionsDisplay</span> <span class="hljs-variable">currentDisplay</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CurrentConditionsDisplay</span>();
        <span class="hljs-type">StatisticsDisplay</span> <span class="hljs-variable">statisticsDisplay</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StatisticsDisplay</span>();
        <span class="hljs-type">ForecastDisplay</span> <span class="hljs-variable">forecastDisplay</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ForecastDisplay</span>();

        <span class="hljs-comment">// æ³¨å†Œè§‚å¯Ÿè€…</span>
        weatherStation.registerObserver(currentDisplay);
        weatherStation.registerObserver(statisticsDisplay);
        weatherStation.registerObserver(forecastDisplay);

        <span class="hljs-comment">// æ¨¡æ‹Ÿæ°”è±¡æ•°æ®æ›´æ–°</span>
        weatherStation.setMeasurements(<span class="hljs-number">25.0f</span>, <span class="hljs-number">65.0f</span>, <span class="hljs-number">1013.0f</span>);

        System.out.println(<span class="hljs-string">"\n\n"</span>);

        weatherStation.setMeasurements(<span class="hljs-number">28.0f</span>, <span class="hljs-number">70.0f</span>, <span class="hljs-number">1012.0f</span>);

        System.out.println(<span class="hljs-string">"\n\n"</span>);

        <span class="hljs-comment">// ç§»é™¤ä¸€ä¸ªè§‚å¯Ÿè€…</span>
        weatherStation.removeObserver(forecastDisplay);

        weatherStation.setMeasurements(<span class="hljs-number">22.0f</span>, <span class="hljs-number">90.0f</span>, <span class="hljs-number">1010.0f</span>);
    }
}
</code></pre>
<h3 data-id="heading-9">å››ã€å®é™…ç”Ÿäº§åœºæ™¯åº”ç”¨</h3>
<h4 data-id="heading-10">4.1 åœºæ™¯ï¼šè®¢å•çŠ¶æ€ç›‘å¬ç³»ç»Ÿ</h4>
<p>åœ¨ç”µå•†ç³»ç»Ÿä¸­ï¼Œè®¢å•çŠ¶æ€æ”¹å˜æ—¶éœ€è¦é€šçŸ¥å¤šä¸ªç³»ç»Ÿï¼šç”¨æˆ·é€šçŸ¥ã€åº“å­˜ç³»ç»Ÿã€ç‰©æµç³»ç»Ÿã€è´¢åŠ¡ç³»ç»Ÿç­‰ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * è®¢å•çŠ¶æ€æšä¸¾
 */</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title class_">OrderStatus</span> {
    CREATED(<span class="hljs-string">"å·²åˆ›å»º"</span>),
    PAID(<span class="hljs-string">"å·²æ”¯ä»˜"</span>),
    SHIPPED(<span class="hljs-string">"å·²å‘è´§"</span>),
    DELIVERED(<span class="hljs-string">"å·²é€è¾¾"</span>),
    CANCELLED(<span class="hljs-string">"å·²å–æ¶ˆ"</span>);

    <span class="hljs-keyword">private</span> String description;

    OrderStatus(String description) {
        <span class="hljs-built_in">this</span>.description = description;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getDescription</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> description;
    }
}

<span class="hljs-comment">/**
 * è®¢å•äº‹ä»¶
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderEvent</span> {
    <span class="hljs-keyword">private</span> String orderId;
    <span class="hljs-keyword">private</span> OrderStatus status;
    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> timestamp;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">OrderEvent</span><span class="hljs-params">(String orderId, OrderStatus status)</span> {
        <span class="hljs-built_in">this</span>.orderId = orderId;
        <span class="hljs-built_in">this</span>.status = status;
        <span class="hljs-built_in">this</span>.timestamp = System.currentTimeMillis();
    }

    <span class="hljs-comment">// Getters</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getOrderId</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> orderId; }
    <span class="hljs-keyword">public</span> OrderStatus <span class="hljs-title function_">getStatus</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> status; }
    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getTimestamp</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> timestamp; }
}

<span class="hljs-comment">/**
 * è®¢å•ç›‘å¬å™¨æ¥å£
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">OrderListener</span> {
    <span class="hljs-comment">/**
     * è®¢å•çŠ¶æ€æ”¹å˜æ—¶è§¦å‘
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">onOrderStatusChanged</span><span class="hljs-params">(OrderEvent event)</span>;
}

<span class="hljs-comment">/**
 * è®¢å•ä¸»é¢˜
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderSubject</span> {

    <span class="hljs-keyword">private</span> List&lt;OrderListener&gt; listeners = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

    <span class="hljs-comment">/**
     * æ³¨å†Œç›‘å¬å™¨
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addListener</span><span class="hljs-params">(OrderListener listener)</span> {
        listeners.add(listener);
    }

    <span class="hljs-comment">/**
     * ç§»é™¤ç›‘å¬å™¨
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeListener</span><span class="hljs-params">(OrderListener listener)</span> {
        listeners.remove(listener);
    }

    <span class="hljs-comment">/**
     * é€šçŸ¥æ‰€æœ‰ç›‘å¬å™¨
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyListeners</span><span class="hljs-params">(OrderEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[è®¢å•ç³»ç»Ÿ] é€šçŸ¥ "</span> + listeners.size() + <span class="hljs-string">" ä¸ªç›‘å¬å™¨"</span>);
        <span class="hljs-keyword">for</span> (OrderListener listener : listeners) {
            <span class="hljs-keyword">try</span> {
                listener.onOrderStatusChanged(event);
            } <span class="hljs-keyword">catch</span> (Exception e) {
                System.err.println(<span class="hljs-string">"ç›‘å¬å™¨æ‰§è¡Œå¤±è´¥: "</span> + e.getMessage());
            }
        }
    }

    <span class="hljs-comment">/**
     * æ›´æ–°è®¢å•çŠ¶æ€
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateOrderStatus</span><span class="hljs-params">(String orderId, OrderStatus status)</span> {
        System.out.println(<span class="hljs-string">"\n========================================"</span>);
        System.out.println(<span class="hljs-string">"[è®¢å•ç³»ç»Ÿ] è®¢å•çŠ¶æ€æ›´æ–°"</span>);
        System.out.println(<span class="hljs-string">"  è®¢å•å·: "</span> + orderId);
        System.out.println(<span class="hljs-string">"  æ–°çŠ¶æ€: "</span> + status.getDescription());
        System.out.println(<span class="hljs-string">"========================================"</span>);

        <span class="hljs-comment">// åˆ›å»ºäº‹ä»¶å¹¶é€šçŸ¥</span>
        <span class="hljs-type">OrderEvent</span> <span class="hljs-variable">event</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderEvent</span>(orderId, status);
        notifyListeners(event);
    }
}
</code></pre>
<p><strong>å…·ä½“ç›‘å¬å™¨ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ç”¨æˆ·é€šçŸ¥ç›‘å¬å™¨
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserNotificationListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">OrderListener</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onOrderStatusChanged</span><span class="hljs-params">(OrderEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[ç”¨æˆ·é€šçŸ¥æœåŠ¡]"</span>);

        <span class="hljs-keyword">switch</span> (event.getStatus()) {
            <span class="hljs-keyword">case</span> PAID:
                sendNotification(event.getOrderId(), <span class="hljs-string">"æ‚¨çš„è®¢å•å·²æ”¯ä»˜æˆåŠŸï¼"</span>);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> SHIPPED:
                sendNotification(event.getOrderId(), <span class="hljs-string">"æ‚¨çš„è®¢å•å·²å‘è´§ï¼Œè¯·æ³¨æ„æŸ¥æ”¶ï¼"</span>);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> DELIVERED:
                sendNotification(event.getOrderId(), <span class="hljs-string">"æ‚¨çš„è®¢å•å·²é€è¾¾ï¼Œæ„Ÿè°¢è´­ä¹°ï¼"</span>);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> CANCELLED:
                sendNotification(event.getOrderId(), <span class="hljs-string">"æ‚¨çš„è®¢å•å·²å–æ¶ˆ"</span>);
                <span class="hljs-keyword">break</span>;
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendNotification</span><span class="hljs-params">(String orderId, String message)</span> {
        System.out.println(<span class="hljs-string">"  å‘é€é€šçŸ¥: "</span> + message);
        <span class="hljs-comment">// å®é™…å®ç°ï¼šå‘é€çŸ­ä¿¡ã€æ¨é€ã€é‚®ä»¶ç­‰</span>
    }
}

<span class="hljs-comment">/**
 * åº“å­˜ç³»ç»Ÿç›‘å¬å™¨
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">InventoryListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">OrderListener</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onOrderStatusChanged</span><span class="hljs-params">(OrderEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[åº“å­˜ç³»ç»Ÿ]"</span>);

        <span class="hljs-keyword">switch</span> (event.getStatus()) {
            <span class="hljs-keyword">case</span> PAID:
                lockInventory(event.getOrderId());
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> CANCELLED:
                releaseInventory(event.getOrderId());
                <span class="hljs-keyword">break</span>;
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lockInventory</span><span class="hljs-params">(String orderId)</span> {
        System.out.println(<span class="hljs-string">"  é”å®šåº“å­˜: "</span> + orderId);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">releaseInventory</span><span class="hljs-params">(String orderId)</span> {
        System.out.println(<span class="hljs-string">"  é‡Šæ”¾åº“å­˜: "</span> + orderId);
    }
}

<span class="hljs-comment">/**
 * ç‰©æµç³»ç»Ÿç›‘å¬å™¨
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LogisticsListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">OrderListener</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onOrderStatusChanged</span><span class="hljs-params">(OrderEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[ç‰©æµç³»ç»Ÿ]"</span>);

        <span class="hljs-keyword">switch</span> (event.getStatus()) {
            <span class="hljs-keyword">case</span> PAID:
                createShippingOrder(event.getOrderId());
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> CANCELLED:
                cancelShippingOrder(event.getOrderId());
                <span class="hljs-keyword">break</span>;
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createShippingOrder</span><span class="hljs-params">(String orderId)</span> {
        System.out.println(<span class="hljs-string">"  åˆ›å»ºç‰©æµå•: "</span> + orderId);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">cancelShippingOrder</span><span class="hljs-params">(String orderId)</span> {
        System.out.println(<span class="hljs-string">"  å–æ¶ˆç‰©æµå•: "</span> + orderId);
    }
}

<span class="hljs-comment">/**
 * è´¢åŠ¡ç³»ç»Ÿç›‘å¬å™¨
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">FinanceListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">OrderListener</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onOrderStatusChanged</span><span class="hljs-params">(OrderEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[è´¢åŠ¡ç³»ç»Ÿ]"</span>);

        <span class="hljs-keyword">switch</span> (event.getStatus()) {
            <span class="hljs-keyword">case</span> PAID:
                recordIncome(event.getOrderId());
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> CANCELLED:
                processRefund(event.getOrderId());
                <span class="hljs-keyword">break</span>;
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">recordIncome</span><span class="hljs-params">(String orderId)</span> {
        System.out.println(<span class="hljs-string">"  è®°å½•æ”¶å…¥: "</span> + orderId);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processRefund</span><span class="hljs-params">(String orderId)</span> {
        System.out.println(<span class="hljs-string">"  å¤„ç†é€€æ¬¾: "</span> + orderId);
    }
}

<span class="hljs-comment">/**
 * æ•°æ®åˆ†æç›‘å¬å™¨
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AnalyticsListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">OrderListener</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onOrderStatusChanged</span><span class="hljs-params">(OrderEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[æ•°æ®åˆ†æ]"</span>);
        System.out.println(<span class="hljs-string">"  è®°å½•è®¢å•çŠ¶æ€å˜æ›´æ•°æ®"</span>);
        System.out.println(<span class="hljs-string">"  æ›´æ–°å®æ—¶æŠ¥è¡¨"</span>);
    }
}
</code></pre>
<p><strong>å®¢æˆ·ç«¯ä½¿ç”¨ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderSystemDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åˆ›å»ºè®¢å•ä¸»é¢˜</span>
        <span class="hljs-type">OrderSubject</span> <span class="hljs-variable">orderSubject</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderSubject</span>();

        <span class="hljs-comment">// æ³¨å†Œå„ä¸ªç³»ç»Ÿçš„ç›‘å¬å™¨</span>
        orderSubject.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserNotificationListener</span>());
        orderSubject.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InventoryListener</span>());
        orderSubject.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LogisticsListener</span>());
        orderSubject.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FinanceListener</span>());
        orderSubject.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AnalyticsListener</span>());

        <span class="hljs-comment">// æ¨¡æ‹Ÿè®¢å•çŠ¶æ€å˜åŒ–</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">orderId</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ORDER20250119001"</span>;

        <span class="hljs-comment">// è®¢å•æ”¯ä»˜</span>
        orderSubject.updateOrderStatus(orderId, OrderStatus.PAID);

        <span class="hljs-comment">// ç­‰å¾…ä¸€æ®µæ—¶é—´</span>
        sleep(<span class="hljs-number">1000</span>);

        <span class="hljs-comment">// è®¢å•å‘è´§</span>
        orderSubject.updateOrderStatus(orderId, OrderStatus.SHIPPED);

        sleep(<span class="hljs-number">1000</span>);

        <span class="hljs-comment">// è®¢å•é€è¾¾</span>
        orderSubject.updateOrderStatus(orderId, OrderStatus.DELIVERED);

        System.out.println(<span class="hljs-string">"\n\n========== æµ‹è¯•å–æ¶ˆè®¢å• =========="</span>);

        <span class="hljs-type">String</span> <span class="hljs-variable">orderId2</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ORDER20250119002"</span>;
        orderSubject.updateOrderStatus(orderId2, OrderStatus.PAID);

        sleep(<span class="hljs-number">500</span>);

        orderSubject.updateOrderStatus(orderId2, OrderStatus.CANCELLED);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sleep</span><span class="hljs-params">(<span class="hljs-type">long</span> millis)</span> {
        <span class="hljs-keyword">try</span> {
            Thread.sleep(millis);
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<h4 data-id="heading-11">4.2 åœºæ™¯ï¼šç›‘æ§å‘Šè­¦ç³»ç»Ÿ</h4>
<p>ç³»ç»Ÿç›‘æ§éœ€è¦åœ¨æŒ‡æ ‡å¼‚å¸¸æ—¶é€šçŸ¥å¤šä¸ªæ¸ é“ï¼šé‚®ä»¶ã€çŸ­ä¿¡ã€é’‰é’‰ã€ä¼ä¸šå¾®ä¿¡ç­‰ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å‘Šè­¦çº§åˆ«
 */</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title class_">AlertLevel</span> {
    INFO(<span class="hljs-string">"ä¿¡æ¯"</span>),
    WARNING(<span class="hljs-string">"è­¦å‘Š"</span>),
    ERROR(<span class="hljs-string">"é”™è¯¯"</span>),
    CRITICAL(<span class="hljs-string">"ä¸¥é‡"</span>);

    <span class="hljs-keyword">private</span> String description;

    AlertLevel(String description) {
        <span class="hljs-built_in">this</span>.description = description;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getDescription</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> description;
    }
}

<span class="hljs-comment">/**
 * å‘Šè­¦äº‹ä»¶
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AlertEvent</span> {
    <span class="hljs-keyword">private</span> String metricName;    <span class="hljs-comment">// æŒ‡æ ‡åç§°</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> value;         <span class="hljs-comment">// å½“å‰å€¼</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> threshold;     <span class="hljs-comment">// é˜ˆå€¼</span>
    <span class="hljs-keyword">private</span> AlertLevel level;     <span class="hljs-comment">// å‘Šè­¦çº§åˆ«</span>
    <span class="hljs-keyword">private</span> String message;       <span class="hljs-comment">// å‘Šè­¦æ¶ˆæ¯</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> timestamp;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">AlertEvent</span><span class="hljs-params">(String metricName, <span class="hljs-type">double</span> value, <span class="hljs-type">double</span> threshold,
                     AlertLevel level, String message)</span> {
        <span class="hljs-built_in">this</span>.metricName = metricName;
        <span class="hljs-built_in">this</span>.value = value;
        <span class="hljs-built_in">this</span>.threshold = threshold;
        <span class="hljs-built_in">this</span>.level = level;
        <span class="hljs-built_in">this</span>.message = message;
        <span class="hljs-built_in">this</span>.timestamp = System.currentTimeMillis();
    }

    <span class="hljs-comment">// Getters</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getMetricName</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> metricName; }
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getValue</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> value; }
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getThreshold</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> threshold; }
    <span class="hljs-keyword">public</span> AlertLevel <span class="hljs-title function_">getLevel</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> level; }
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getMessage</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> message; }
    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getTimestamp</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> timestamp; }
}

<span class="hljs-comment">/**
 * å‘Šè­¦ç›‘å¬å™¨
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">AlertListener</span> {
    <span class="hljs-comment">/**
     * å¤„ç†å‘Šè­¦
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">onAlert</span><span class="hljs-params">(AlertEvent event)</span>;

    <span class="hljs-comment">/**
     * æ˜¯å¦æ”¯æŒè¯¥çº§åˆ«çš„å‘Šè­¦
     */</span>
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">supports</span><span class="hljs-params">(AlertLevel level)</span>;
}

<span class="hljs-comment">/**
 * ç›‘æ§ç³»ç»Ÿ
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MonitoringSystem</span> {

    <span class="hljs-keyword">private</span> List&lt;AlertListener&gt; listeners = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addListener</span><span class="hljs-params">(AlertListener listener)</span> {
        listeners.add(listener);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeListener</span><span class="hljs-params">(AlertListener listener)</span> {
        listeners.remove(listener);
    }

    <span class="hljs-comment">/**
     * è§¦å‘å‘Šè­¦
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">triggerAlert</span><span class="hljs-params">(AlertEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n========================================"</span>);
        System.out.println(<span class="hljs-string">"[ç›‘æ§ç³»ç»Ÿ] è§¦å‘å‘Šè­¦"</span>);
        System.out.println(<span class="hljs-string">"  æŒ‡æ ‡: "</span> + event.getMetricName());
        System.out.println(<span class="hljs-string">"  å½“å‰å€¼: "</span> + event.getValue());
        System.out.println(<span class="hljs-string">"  é˜ˆå€¼: "</span> + event.getThreshold());
        System.out.println(<span class="hljs-string">"  çº§åˆ«: "</span> + event.getLevel().getDescription());
        System.out.println(<span class="hljs-string">"  æ¶ˆæ¯: "</span> + event.getMessage());
        System.out.println(<span class="hljs-string">"========================================"</span>);

        <span class="hljs-comment">// é€šçŸ¥ç›‘å¬å™¨</span>
        <span class="hljs-keyword">for</span> (AlertListener listener : listeners) {
            <span class="hljs-keyword">if</span> (listener.supports(event.getLevel())) {
                <span class="hljs-keyword">try</span> {
                    listener.onAlert(event);
                } <span class="hljs-keyword">catch</span> (Exception e) {
                    System.err.println(<span class="hljs-string">"å‘Šè­¦å‘é€å¤±è´¥: "</span> + e.getMessage());
                }
            }
        }
    }

    <span class="hljs-comment">/**
     * æ£€æŸ¥æŒ‡æ ‡
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkMetric</span><span class="hljs-params">(String metricName, <span class="hljs-type">double</span> value, <span class="hljs-type">double</span> threshold)</span> {
        <span class="hljs-keyword">if</span> (value &gt; threshold) {
            AlertLevel level;
            <span class="hljs-keyword">if</span> (value &gt; threshold * <span class="hljs-number">2</span>) {
                level = AlertLevel.CRITICAL;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value &gt; threshold * <span class="hljs-number">1.5</span>) {
                level = AlertLevel.ERROR;
            } <span class="hljs-keyword">else</span> {
                level = AlertLevel.WARNING;
            }

            <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> String.format(<span class="hljs-string">"%s è¶…è¿‡é˜ˆå€¼ï¼å½“å‰å€¼: %.2f, é˜ˆå€¼: %.2f"</span>,
                    metricName, value, threshold);

            triggerAlert(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AlertEvent</span>(metricName, value, threshold, level, message));
        }
    }
}

<span class="hljs-comment">/**
 * é‚®ä»¶å‘Šè­¦ç›‘å¬å™¨
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailAlertListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AlertListener</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onAlert</span><span class="hljs-params">(AlertEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[é‚®ä»¶å‘Šè­¦]"</span>);
        System.out.println(<span class="hljs-string">"  å‘é€é‚®ä»¶åˆ°: ops@example.com"</span>);
        System.out.println(<span class="hljs-string">"  ä¸»é¢˜: "</span> + event.getLevel().getDescription() + <span class="hljs-string">" - "</span> + event.getMetricName());
        System.out.println(<span class="hljs-string">"  å†…å®¹: "</span> + event.getMessage());
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">supports</span><span class="hljs-params">(AlertLevel level)</span> {
        <span class="hljs-comment">// é‚®ä»¶æ”¯æŒæ‰€æœ‰çº§åˆ«</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}

<span class="hljs-comment">/**
 * çŸ­ä¿¡å‘Šè­¦ç›‘å¬å™¨
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SmsAlertListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AlertListener</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onAlert</span><span class="hljs-params">(AlertEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[çŸ­ä¿¡å‘Šè­¦]"</span>);
        System.out.println(<span class="hljs-string">"  å‘é€çŸ­ä¿¡åˆ°: 138****8888"</span>);
        System.out.println(<span class="hljs-string">"  å†…å®¹: "</span> + event.getMessage());
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">supports</span><span class="hljs-params">(AlertLevel level)</span> {
        <span class="hljs-comment">// çŸ­ä¿¡åªå‘é€ERRORå’ŒCRITICALçº§åˆ«</span>
        <span class="hljs-keyword">return</span> level == AlertLevel.ERROR || level == AlertLevel.CRITICAL;
    }
}

<span class="hljs-comment">/**
 * é’‰é’‰å‘Šè­¦ç›‘å¬å™¨
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DingTalkAlertListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AlertListener</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onAlert</span><span class="hljs-params">(AlertEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[é’‰é’‰å‘Šè­¦]"</span>);
        System.out.println(<span class="hljs-string">"  å‘é€é’‰é’‰æ¶ˆæ¯åˆ°: è¿ç»´ç¾¤"</span>);
        System.out.println(<span class="hljs-string">"  å†…å®¹: "</span> + formatMarkdown(event));
    }

    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">formatMarkdown</span><span class="hljs-params">(AlertEvent event)</span> {
        <span class="hljs-keyword">return</span> String.format(<span class="hljs-string">"### %så‘Šè­¦\n- æŒ‡æ ‡: %s\n- å½“å‰å€¼: %.2f\n- é˜ˆå€¼: %.2f"</span>,
                event.getLevel().getDescription(),
                event.getMetricName(),
                event.getValue(),
                event.getThreshold());
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">supports</span><span class="hljs-params">(AlertLevel level)</span> {
        <span class="hljs-comment">// é’‰é’‰æ”¯æŒWARNINGåŠä»¥ä¸Š</span>
        <span class="hljs-keyword">return</span> level != AlertLevel.INFO;
    }
}

<span class="hljs-comment">/**
 * ç”µè¯å‘Šè­¦ç›‘å¬å™¨
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PhoneCallAlertListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AlertListener</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onAlert</span><span class="hljs-params">(AlertEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[ç”µè¯å‘Šè­¦]"</span>);
        System.out.println(<span class="hljs-string">"  æ‹¨æ‰“ç”µè¯: 138****8888"</span>);
        System.out.println(<span class="hljs-string">"  è¯­éŸ³æ’­æŠ¥: "</span> + event.getMessage());
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">supports</span><span class="hljs-params">(AlertLevel level)</span> {
        <span class="hljs-comment">// ç”µè¯åªç”¨äºCRITICALçº§åˆ«</span>
        <span class="hljs-keyword">return</span> level == AlertLevel.CRITICAL;
    }
}

<span class="hljs-comment">/**
 * æµ‹è¯•ç›‘æ§å‘Šè­¦ç³»ç»Ÿ
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MonitoringSystemDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åˆ›å»ºç›‘æ§ç³»ç»Ÿ</span>
        <span class="hljs-type">MonitoringSystem</span> <span class="hljs-variable">monitoring</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MonitoringSystem</span>();

        <span class="hljs-comment">// æ³¨å†Œå‘Šè­¦ç›‘å¬å™¨</span>
        monitoring.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">EmailAlertListener</span>());
        monitoring.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SmsAlertListener</span>());
        monitoring.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DingTalkAlertListener</span>());
        monitoring.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PhoneCallAlertListener</span>());

        <span class="hljs-comment">// æ¨¡æ‹Ÿç›‘æ§æŒ‡æ ‡æ£€æŸ¥</span>
        System.out.println(<span class="hljs-string">"========== åœºæ™¯1ï¼šCPUä½¿ç”¨ç‡ç•¥é«˜ï¼ˆWARNINGï¼‰ =========="</span>);
        monitoring.checkMetric(<span class="hljs-string">"CPUä½¿ç”¨ç‡"</span>, <span class="hljs-number">75.0</span>, <span class="hljs-number">50.0</span>);

        System.out.println(<span class="hljs-string">"\n\n========== åœºæ™¯2ï¼šå†…å­˜ä½¿ç”¨ç‡å¾ˆé«˜ï¼ˆERRORï¼‰ =========="</span>);
        monitoring.checkMetric(<span class="hljs-string">"å†…å­˜ä½¿ç”¨ç‡"</span>, <span class="hljs-number">88.0</span>, <span class="hljs-number">50.0</span>);

        System.out.println(<span class="hljs-string">"\n\n========== åœºæ™¯3ï¼šç£ç›˜ä½¿ç”¨ç‡æé«˜ï¼ˆCRITICALï¼‰ =========="</span>);
        monitoring.checkMetric(<span class="hljs-string">"ç£ç›˜ä½¿ç”¨ç‡"</span>, <span class="hljs-number">98.0</span>, <span class="hljs-number">80.0</span>);
    }
}
</code></pre>
<h3 data-id="heading-12">äº”ã€å¼€æºæ¡†æ¶ä¸­çš„åº”ç”¨</h3>
<h4 data-id="heading-13">5.1 JDKçš„Observable/Observer</h4>
<p>Javaå†…ç½®çš„è§‚å¯Ÿè€…æ¨¡å¼å®ç°ï¼ˆå·²åœ¨Java 9ä¸­æ ‡è®°ä¸ºè¿‡æ—¶ï¼‰ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.Observable;
<span class="hljs-keyword">import</span> java.util.Observer;

<span class="hljs-comment">/**
 * JDKå†…ç½®çš„Observable/Observer
 * æ³¨æ„ï¼šJava 9åå·²è¢«æ ‡è®°ä¸º<span class="hljs-doctag">@Deprecated</span>
 */</span>

<span class="hljs-comment">/**
 * å…·ä½“ä¸»é¢˜ï¼šç»§æ‰¿Observable
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">StockData</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Observable</span> {
    <span class="hljs-keyword">private</span> String stockName;
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> price;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">StockData</span><span class="hljs-params">(String stockName)</span> {
        <span class="hljs-built_in">this</span>.stockName = stockName;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPrice</span><span class="hljs-params">(<span class="hljs-type">double</span> price)</span> {
        <span class="hljs-built_in">this</span>.price = price;

        <span class="hljs-comment">// æ ‡è®°çŠ¶æ€å·²æ”¹å˜</span>
        setChanged();

        <span class="hljs-comment">// é€šçŸ¥è§‚å¯Ÿè€…ï¼ˆæ¨æ¨¡å‹ï¼‰</span>
        notifyObservers(price);
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getStockName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> stockName;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getPrice</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> price;
    }
}

<span class="hljs-comment">/**
 * å…·ä½“è§‚å¯Ÿè€…ï¼šå®ç°Observeræ¥å£
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">StockDisplay</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Observer</span> {

    <span class="hljs-keyword">private</span> String displayName;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">StockDisplay</span><span class="hljs-params">(String displayName)</span> {
        <span class="hljs-built_in">this</span>.displayName = displayName;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(Observable o, Object arg)</span> {
        <span class="hljs-keyword">if</span> (o <span class="hljs-keyword">instanceof</span> StockData) {
            <span class="hljs-type">StockData</span> <span class="hljs-variable">stock</span> <span class="hljs-operator">=</span> (StockData) o;
            <span class="hljs-type">double</span> <span class="hljs-variable">price</span> <span class="hljs-operator">=</span> (Double) arg;

            System.out.println(<span class="hljs-string">"["</span> + displayName + <span class="hljs-string">"] "</span> +
                    stock.getStockName() + <span class="hljs-string">" ä»·æ ¼æ›´æ–°: Â¥"</span> + price);
        }
    }
}

<span class="hljs-comment">/**
 * æµ‹è¯•JDK Observable
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">JdkObservableDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åˆ›å»ºè‚¡ç¥¨æ•°æ®ï¼ˆä¸»é¢˜ï¼‰</span>
        <span class="hljs-type">StockData</span> <span class="hljs-variable">appleStock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StockData</span>(<span class="hljs-string">"è‹¹æœè‚¡ç¥¨"</span>);

        <span class="hljs-comment">// åˆ›å»ºè§‚å¯Ÿè€…</span>
        <span class="hljs-type">StockDisplay</span> <span class="hljs-variable">display1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StockDisplay</span>(<span class="hljs-string">"ç»ˆç«¯1"</span>);
        <span class="hljs-type">StockDisplay</span> <span class="hljs-variable">display2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StockDisplay</span>(<span class="hljs-string">"ç»ˆç«¯2"</span>);
        <span class="hljs-type">StockDisplay</span> <span class="hljs-variable">display3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StockDisplay</span>(<span class="hljs-string">"æ‰‹æœºAPP"</span>);

        <span class="hljs-comment">// æ³¨å†Œè§‚å¯Ÿè€…</span>
        appleStock.addObserver(display1);
        appleStock.addObserver(display2);
        appleStock.addObserver(display3);

        <span class="hljs-comment">// æ›´æ–°ä»·æ ¼</span>
        System.out.println(<span class="hljs-string">"===== ç¬¬ä¸€æ¬¡æ›´æ–° ====="</span>);
        appleStock.setPrice(<span class="hljs-number">150.50</span>);

        System.out.println(<span class="hljs-string">"\n===== ç¬¬äºŒæ¬¡æ›´æ–° ====="</span>);
        appleStock.setPrice(<span class="hljs-number">152.30</span>);

        <span class="hljs-comment">// ç§»é™¤ä¸€ä¸ªè§‚å¯Ÿè€…</span>
        appleStock.deleteObserver(display2);

        System.out.println(<span class="hljs-string">"\n===== ç¬¬ä¸‰æ¬¡æ›´æ–°ï¼ˆdisplay2å·²ç§»é™¤ï¼‰ ====="</span>);
        appleStock.setPrice(<span class="hljs-number">148.90</span>);
    }
}
</code></pre>
<h4 data-id="heading-14">5.2 Springäº‹ä»¶æœºåˆ¶</h4>
<p>Springæ¡†æ¶çš„ApplicationEventæ˜¯è§‚å¯Ÿè€…æ¨¡å¼çš„ä¼˜ç§€å®ç°ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * Springäº‹ä»¶æœºåˆ¶ï¼ˆç®€åŒ–æ¨¡æ‹Ÿï¼‰
 *
 * Springçš„äº‹ä»¶æœºåˆ¶åŸºäºè§‚å¯Ÿè€…æ¨¡å¼ï¼š
 * - ApplicationEvent: äº‹ä»¶
 * - ApplicationListener: ç›‘å¬å™¨
 * - ApplicationEventPublisher: äº‹ä»¶å‘å¸ƒå™¨
 */</span>

<span class="hljs-comment">/**
 * è‡ªå®šä¹‰äº‹ä»¶ï¼šç”¨æˆ·æ³¨å†Œäº‹ä»¶
 */</span>
<span class="hljs-comment">// åœ¨çœŸå®Springä¸­ç»§æ‰¿ApplicationEvent</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserRegisteredEvent</span> {
    <span class="hljs-keyword">private</span> String username;
    <span class="hljs-keyword">private</span> String email;
    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> timestamp;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserRegisteredEvent</span><span class="hljs-params">(String username, String email)</span> {
        <span class="hljs-built_in">this</span>.username = username;
        <span class="hljs-built_in">this</span>.email = email;
        <span class="hljs-built_in">this</span>.timestamp = System.currentTimeMillis();
    }

    <span class="hljs-comment">// Getters</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUsername</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> username; }
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getEmail</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> email; }
    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getTimestamp</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> timestamp; }
}

<span class="hljs-comment">/**
 * äº‹ä»¶ç›‘å¬å™¨æ¥å£
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ApplicationListener</span>&lt;E&gt; {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">onApplicationEvent</span><span class="hljs-params">(E event)</span>;
}

<span class="hljs-comment">/**
 * äº‹ä»¶å‘å¸ƒå™¨
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ApplicationEventPublisher</span> {
    <span class="hljs-keyword">private</span> List&lt;ApplicationListener&gt; listeners = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addListener</span><span class="hljs-params">(ApplicationListener listener)</span> {
        listeners.add(listener);
    }

    <span class="hljs-meta">@SuppressWarnings("unchecked")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">publishEvent</span><span class="hljs-params">(Object event)</span> {
        System.out.println(<span class="hljs-string">"\n[EventPublisher] å‘å¸ƒäº‹ä»¶: "</span> + event.getClass().getSimpleName());

        <span class="hljs-keyword">for</span> (ApplicationListener listener : listeners) {
            <span class="hljs-keyword">try</span> {
                listener.onApplicationEvent(event);
            } <span class="hljs-keyword">catch</span> (Exception e) {
                System.err.println(<span class="hljs-string">"ç›‘å¬å™¨æ‰§è¡Œå¤±è´¥: "</span> + e.getMessage());
            }
        }
    }
}

<span class="hljs-comment">/**
 * ç›‘å¬å™¨1ï¼šå‘é€æ¬¢è¿é‚®ä»¶
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">WelcomeEmailListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ApplicationListener</span>&lt;UserRegisteredEvent&gt; {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onApplicationEvent</span><span class="hljs-params">(UserRegisteredEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[WelcomeEmailListener] å¤„ç†ç”¨æˆ·æ³¨å†Œäº‹ä»¶"</span>);
        System.out.println(<span class="hljs-string">"  å‘é€æ¬¢è¿é‚®ä»¶åˆ°: "</span> + event.getEmail());
        System.out.println(<span class="hljs-string">"  é‚®ä»¶å†…å®¹: æ¬¢è¿ "</span> + event.getUsername() + <span class="hljs-string">" æ³¨å†Œï¼"</span>);
    }
}

<span class="hljs-comment">/**
 * ç›‘å¬å™¨2ï¼šèµ é€ä¼˜æƒ åˆ¸
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CouponListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ApplicationListener</span>&lt;UserRegisteredEvent&gt; {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onApplicationEvent</span><span class="hljs-params">(UserRegisteredEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[CouponListener] å¤„ç†ç”¨æˆ·æ³¨å†Œäº‹ä»¶"</span>);
        System.out.println(<span class="hljs-string">"  ä¸ºç”¨æˆ· "</span> + event.getUsername() + <span class="hljs-string">" å‘æ”¾æ–°äººä¼˜æƒ åˆ¸"</span>);
        System.out.println(<span class="hljs-string">"  ä¼˜æƒ åˆ¸: æ»¡100å‡20"</span>);
    }
}

<span class="hljs-comment">/**
 * ç›‘å¬å™¨3ï¼šè®°å½•ç”¨æˆ·è¡Œä¸º
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserBehaviorListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ApplicationListener</span>&lt;UserRegisteredEvent&gt; {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onApplicationEvent</span><span class="hljs-params">(UserRegisteredEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[UserBehaviorListener] å¤„ç†ç”¨æˆ·æ³¨å†Œäº‹ä»¶"</span>);
        System.out.println(<span class="hljs-string">"  è®°å½•ç”¨æˆ·è¡Œä¸ºæ•°æ®"</span>);
        System.out.println(<span class="hljs-string">"  ç”¨æˆ·: "</span> + event.getUsername());
        System.out.println(<span class="hljs-string">"  æ—¶é—´: "</span> + <span class="hljs-keyword">new</span> <span class="hljs-title class_">java</span>.util.Date(event.getTimestamp()));
    }
}

<span class="hljs-comment">/**
 * ç”¨æˆ·æœåŠ¡
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-keyword">private</span> ApplicationEventPublisher eventPublisher;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserService</span><span class="hljs-params">(ApplicationEventPublisher eventPublisher)</span> {
        <span class="hljs-built_in">this</span>.eventPublisher = eventPublisher;
    }

    <span class="hljs-comment">/**
     * ç”¨æˆ·æ³¨å†Œ
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">register</span><span class="hljs-params">(String username, String email)</span> {
        System.out.println(<span class="hljs-string">"========================================"</span>);
        System.out.println(<span class="hljs-string">"[UserService] ç”¨æˆ·æ³¨å†Œ"</span>);
        System.out.println(<span class="hljs-string">"  ç”¨æˆ·å: "</span> + username);
        System.out.println(<span class="hljs-string">"  é‚®ç®±: "</span> + email);
        System.out.println(<span class="hljs-string">"========================================"</span>);

        <span class="hljs-comment">// 1. ä¿å­˜ç”¨æˆ·åˆ°æ•°æ®åº“</span>
        saveUser(username, email);

        <span class="hljs-comment">// 2. å‘å¸ƒç”¨æˆ·æ³¨å†Œäº‹ä»¶</span>
        <span class="hljs-type">UserRegisteredEvent</span> <span class="hljs-variable">event</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserRegisteredEvent</span>(username, email);
        eventPublisher.publishEvent(event);

        System.out.println(<span class="hljs-string">"\n[UserService] ç”¨æˆ·æ³¨å†Œå®Œæˆ\n"</span>);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveUser</span><span class="hljs-params">(String username, String email)</span> {
        System.out.println(<span class="hljs-string">"  ä¿å­˜ç”¨æˆ·åˆ°æ•°æ®åº“..."</span>);
    }
}

<span class="hljs-comment">/**
 * æµ‹è¯•Springäº‹ä»¶æœºåˆ¶
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringEventDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åˆ›å»ºäº‹ä»¶å‘å¸ƒå™¨</span>
        <span class="hljs-type">ApplicationEventPublisher</span> <span class="hljs-variable">publisher</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApplicationEventPublisher</span>();

        <span class="hljs-comment">// æ³¨å†Œç›‘å¬å™¨ï¼ˆåœ¨Springä¸­é€šè¿‡@EventListeneræˆ–å®ç°æ¥å£è‡ªåŠ¨æ³¨å†Œï¼‰</span>
        publisher.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WelcomeEmailListener</span>());
        publisher.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CouponListener</span>());
        publisher.addListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserBehaviorListener</span>());

        <span class="hljs-comment">// åˆ›å»ºç”¨æˆ·æœåŠ¡</span>
        <span class="hljs-type">UserService</span> <span class="hljs-variable">userService</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserService</span>(publisher);

        <span class="hljs-comment">// ç”¨æˆ·æ³¨å†Œï¼ˆä¼šè§¦å‘äº‹ä»¶ï¼‰</span>
        userService.register(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"zhangsan@example.com"</span>);

        <span class="hljs-comment">// å†æ³¨å†Œä¸€ä¸ªç”¨æˆ·</span>
        userService.register(<span class="hljs-string">"æå››"</span>, <span class="hljs-string">"lisi@example.com"</span>);
    }
}

<span class="hljs-comment">/**
 * åœ¨çœŸå®çš„Springä¸­ä½¿ç”¨ï¼š
 *
 * // 1. å®šä¹‰äº‹ä»¶
 * public class UserRegisteredEvent extends ApplicationEvent {
 *     private String username;
 *     // ...
 * }
 *
 * // 2. å®šä¹‰ç›‘å¬å™¨
 * <span class="hljs-doctag">@Component</span>
 * public class WelcomeEmailListener {
 *     <span class="hljs-doctag">@EventListener</span>
 *     public void handleUserRegistered(UserRegisteredEvent event) {
 *         // å¤„ç†äº‹ä»¶
 *     }
 * }
 *
 * // 3. å‘å¸ƒäº‹ä»¶
 * <span class="hljs-doctag">@Service</span>
 * public class UserService {
 *     <span class="hljs-doctag">@Autowired</span>
 *     private ApplicationEventPublisher publisher;
 *
 *     public void register(String username) {
 *         // ä¸šåŠ¡é€»è¾‘
 *         publisher.publishEvent(new UserRegisteredEvent(username));
 *     }
 * }
 */</span>
</code></pre>
<h4 data-id="heading-15">5.3 Guava EventBus</h4>
<p>Google Guavaæä¾›çš„è½»é‡çº§äº‹ä»¶æ€»çº¿ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * Guava EventBusç®€åŒ–å®ç°
 *
 * EventBusç‰¹ç‚¹ï¼š
 * 1. ä½¿ç”¨æ³¨è§£<span class="hljs-doctag">@Subscribe</span>æ ‡è®°è®¢é˜…æ–¹æ³•
 * 2. æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥äº‹ä»¶
 * 3. è‡ªåŠ¨æ ¹æ®äº‹ä»¶ç±»å‹åˆ†å‘
 */</span>

<span class="hljs-keyword">import</span> java.lang.annotation.*;
<span class="hljs-keyword">import</span> java.lang.reflect.Method;

<span class="hljs-comment">/**
 * Subscribeæ³¨è§£
 */</span>
<span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span>
<span class="hljs-meta">@Target(ElementType.METHOD)</span>
<span class="hljs-meta">@interface</span> Subscribe {
}

<span class="hljs-comment">/**
 * ç®€åŒ–çš„EventBuså®ç°
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleEventBus</span> {

    <span class="hljs-keyword">private</span> Map&lt;Class&lt;?&gt;, List&lt;SubscriberMethod&gt;&gt; subscribers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">java</span>.util.HashMap&lt;&gt;();

    <span class="hljs-comment">/**
     * æ³¨å†Œè®¢é˜…è€…
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">register</span><span class="hljs-params">(Object subscriber)</span> {
        Class&lt;?&gt; clazz = subscriber.getClass();
        System.out.println(<span class="hljs-string">"[EventBus] æ³¨å†Œè®¢é˜…è€…: "</span> + clazz.getSimpleName());

        <span class="hljs-comment">// æŸ¥æ‰¾å¸¦@Subscribeæ³¨è§£çš„æ–¹æ³•</span>
        <span class="hljs-keyword">for</span> (Method method : clazz.getDeclaredMethods()) {
            <span class="hljs-keyword">if</span> (method.isAnnotationPresent(Subscribe.class)) {
                Class&lt;?&gt;[] parameterTypes = method.getParameterTypes();
                <span class="hljs-keyword">if</span> (parameterTypes.length == <span class="hljs-number">1</span>) {
                    Class&lt;?&gt; eventType = parameterTypes[<span class="hljs-number">0</span>];

                    subscribers.computeIfAbsent(eventType, k -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;())
                            .add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SubscriberMethod</span>(subscriber, method));

                    System.out.println(<span class="hljs-string">"  - è®¢é˜…äº‹ä»¶: "</span> + eventType.getSimpleName() +
                            <span class="hljs-string">", æ–¹æ³•: "</span> + method.getName());
                }
            }
        }
    }

    <span class="hljs-comment">/**
     * å‘å¸ƒäº‹ä»¶
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">post</span><span class="hljs-params">(Object event)</span> {
        Class&lt;?&gt; eventType = event.getClass();
        System.out.println(<span class="hljs-string">"\n[EventBus] å‘å¸ƒäº‹ä»¶: "</span> + eventType.getSimpleName());

        List&lt;SubscriberMethod&gt; methods = subscribers.get(eventType);
        <span class="hljs-keyword">if</span> (methods != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">for</span> (SubscriberMethod method : methods) {
                <span class="hljs-keyword">try</span> {
                    method.invoke(event);
                } <span class="hljs-keyword">catch</span> (Exception e) {
                    System.err.println(<span class="hljs-string">"äº‹ä»¶å¤„ç†å¤±è´¥: "</span> + e.getMessage());
                }
            }
        } <span class="hljs-keyword">else</span> {
            System.out.println(<span class="hljs-string">"  æ²¡æœ‰è®¢é˜…è€…"</span>);
        }
    }

    <span class="hljs-comment">/**
     * è®¢é˜…æ–¹æ³•å°è£…
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SubscriberMethod</span> {
        <span class="hljs-keyword">private</span> Object subscriber;
        <span class="hljs-keyword">private</span> Method method;

        <span class="hljs-keyword">public</span> <span class="hljs-title function_">SubscriberMethod</span><span class="hljs-params">(Object subscriber, Method method)</span> {
            <span class="hljs-built_in">this</span>.subscriber = subscriber;
            <span class="hljs-built_in">this</span>.method = method;
        }

        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object event)</span> <span class="hljs-keyword">throws</span> Exception {
            method.invoke(subscriber, event);
        }
    }
}

<span class="hljs-comment">/**
 * äº‹ä»¶ï¼šè®¢å•åˆ›å»ºäº‹ä»¶
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderCreatedEvent</span> {
    <span class="hljs-keyword">private</span> String orderId;
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> amount;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">OrderCreatedEvent</span><span class="hljs-params">(String orderId, <span class="hljs-type">double</span> amount)</span> {
        <span class="hljs-built_in">this</span>.orderId = orderId;
        <span class="hljs-built_in">this</span>.amount = amount;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getOrderId</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> orderId; }
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">getAmount</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> amount; }
}

<span class="hljs-comment">/**
 * è®¢é˜…è€…ï¼šè®¢å•æœåŠ¡
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderEventSubscriber</span> {

    <span class="hljs-meta">@Subscribe</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleOrderCreated</span><span class="hljs-params">(OrderCreatedEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[OrderEventSubscriber] å¤„ç†è®¢å•åˆ›å»º"</span>);
        System.out.println(<span class="hljs-string">"  è®¢å•å·: "</span> + event.getOrderId());
        System.out.println(<span class="hljs-string">"  é‡‘é¢: Â¥"</span> + event.getAmount());
    }
}

<span class="hljs-comment">/**
 * è®¢é˜…è€…ï¼šç§¯åˆ†æœåŠ¡
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PointsEventSubscriber</span> {

    <span class="hljs-meta">@Subscribe</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleOrderCreated</span><span class="hljs-params">(OrderCreatedEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[PointsEventSubscriber] å¤„ç†è®¢å•åˆ›å»º"</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">points</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) (event.getAmount() / <span class="hljs-number">10</span>);
        System.out.println(<span class="hljs-string">"  èµ é€ç§¯åˆ†: "</span> + points);
    }
}

<span class="hljs-comment">/**
 * è®¢é˜…è€…ï¼šè¥é”€æœåŠ¡
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MarketingEventSubscriber</span> {

    <span class="hljs-meta">@Subscribe</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleOrderCreated</span><span class="hljs-params">(OrderCreatedEvent event)</span> {
        System.out.println(<span class="hljs-string">"\n[MarketingEventSubscriber] å¤„ç†è®¢å•åˆ›å»º"</span>);
        System.out.println(<span class="hljs-string">"  è®°å½•ç”¨æˆ·è´­ä¹°è¡Œä¸º"</span>);
        System.out.println(<span class="hljs-string">"  æ›´æ–°ç”¨æˆ·ç”»åƒ"</span>);
    }
}

<span class="hljs-comment">/**
 * æµ‹è¯•EventBus
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">EventBusDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åˆ›å»ºEventBus</span>
        <span class="hljs-type">SimpleEventBus</span> <span class="hljs-variable">eventBus</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleEventBus</span>();

        <span class="hljs-comment">// æ³¨å†Œè®¢é˜…è€…</span>
        eventBus.register(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderEventSubscriber</span>());
        eventBus.register(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PointsEventSubscriber</span>());
        eventBus.register(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MarketingEventSubscriber</span>());

        System.out.println(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>.repeat(<span class="hljs-number">50</span>));

        <span class="hljs-comment">// å‘å¸ƒäº‹ä»¶</span>
        <span class="hljs-type">OrderCreatedEvent</span> <span class="hljs-variable">event</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderCreatedEvent</span>(<span class="hljs-string">"ORDER001"</span>, <span class="hljs-number">299.00</span>);
        eventBus.post(event);
    }
}

<span class="hljs-comment">/**
 * åœ¨çœŸå®çš„Guava EventBusä¸­ä½¿ç”¨ï¼š
 *
 * // 1. åˆ›å»ºEventBus
 * EventBus eventBus = new EventBus();
 *
 * // 2. å®šä¹‰è®¢é˜…è€…
 * public class OrderSubscriber {
 *     <span class="hljs-doctag">@Subscribe</span>
 *     public void handleOrderCreated(OrderCreatedEvent event) {
 *         // å¤„ç†äº‹ä»¶
 *     }
 * }
 *
 * // 3. æ³¨å†Œå’Œå‘å¸ƒ
 * eventBus.register(new OrderSubscriber());
 * eventBus.post(new OrderCreatedEvent());
 *
 * // 4. å¼‚æ­¥EventBus
 * EventBus asyncBus = new AsyncEventBus(Executors.newFixedThreadPool(4));
 */</span>
</code></pre>
<h3 data-id="heading-16">å…­ã€è§‚å¯Ÿè€…æ¨¡å¼çš„ä¼˜ç¼ºç‚¹</h3>
<h4 data-id="heading-17">6.1 ä¼˜ç‚¹</h4>
<p><strong>1. è§£è€¦</strong></p>
<pre><code class="hljs language-scss" lang="scss">ä¸»é¢˜å’Œè§‚å¯Ÿè€…ä¹‹é—´æ˜¯æŠ½è±¡è€¦åˆ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Subject â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Observer â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    (æ¥å£)              (æ¥å£)

ä¸»é¢˜ä¸éœ€è¦çŸ¥é“è§‚å¯Ÿè€…çš„å…·ä½“å®ç°
</code></pre>
<p><strong>2. æ”¯æŒå¹¿æ’­é€šä¿¡</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">ä¸€ä¸ªä¸»é¢˜å¯ä»¥é€šçŸ¥å¤šä¸ªè§‚å¯Ÿè€…
Subject â†’ Observer1
<span class="hljs-code">       â†’ Observer2
       â†’ Observer3
       â†’ ...
</span></code></pre>
<p><strong>3. ç¬¦åˆå¼€é—­åŸåˆ™</strong></p>
<pre><code class="hljs">æ·»åŠ æ–°è§‚å¯Ÿè€…ï¼šæ— éœ€ä¿®æ”¹ä¸»é¢˜ä»£ç 
ç§»é™¤è§‚å¯Ÿè€…ï¼šä¸å½±å“å…¶ä»–è§‚å¯Ÿè€…
</code></pre>
<p><strong>4. å»ºç«‹è§¦å‘æœºåˆ¶</strong></p>
<pre><code class="hljs">çŠ¶æ€æ”¹å˜è‡ªåŠ¨è§¦å‘é€šçŸ¥
æ— éœ€ä¸»åŠ¨è½®è¯¢
</code></pre>
<h4 data-id="heading-18">6.2 ç¼ºç‚¹</h4>
<p><strong>1. æ€§èƒ½é—®é¢˜</strong></p>
<pre><code class="hljs">è§‚å¯Ÿè€…è¿‡å¤šï¼šé€šçŸ¥è€—æ—¶å¢åŠ 
é¡ºåºæ‰§è¡Œï¼šä¸€ä¸ªè§‚å¯Ÿè€…é˜»å¡å½±å“å…¶ä»–
</code></pre>
<p><strong>2. å†…å­˜æ³„æ¼é£é™©</strong></p>
<pre><code class="hljs">å¿˜è®°ç§»é™¤è§‚å¯Ÿè€…ï¼šå¯¼è‡´å¯¹è±¡æ— æ³•è¢«å›æ”¶
ä½¿ç”¨å¼±å¼•ç”¨ï¼šå¯ä»¥ç¼“è§£é—®é¢˜
</code></pre>
<p><strong>3. å¾ªç¯ä¾èµ–</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">A</span>è§‚å¯Ÿ<span class="hljs-selector-tag">B</span>ï¼Œ<span class="hljs-selector-tag">B</span>è§‚å¯Ÿ<span class="hljs-selector-tag">A</span>
å¯èƒ½å¯¼è‡´æ­»å¾ªç¯
</code></pre>
<p><strong>4. é¡ºåºä¸ç¡®å®š</strong></p>
<pre><code class="hljs">è§‚å¯Ÿè€…æ‰§è¡Œé¡ºåºä¸ä¿è¯
å¯èƒ½å¯¼è‡´ä¾èµ–é—®é¢˜
</code></pre>
<h3 data-id="heading-19">ä¸ƒã€æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-20">7.1 å¼‚æ­¥é€šçŸ¥</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å¼‚æ­¥è§‚å¯Ÿè€…æ¨¡å¼
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncSubject</span> {

    <span class="hljs-keyword">private</span> List&lt;Observer&gt; observers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">private</span> java.util.concurrent.<span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span>
            java.util.concurrent.Executors.newFixedThreadPool(<span class="hljs-number">4</span>);

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addObserver</span><span class="hljs-params">(Observer observer)</span> {
        observers.add(observer);
    }

    <span class="hljs-comment">/**
     * å¼‚æ­¥é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyObserversAsync</span><span class="hljs-params">(<span class="hljs-type">float</span> temperature, <span class="hljs-type">float</span> humidity, <span class="hljs-type">float</span> pressure)</span> {
        System.out.println(<span class="hljs-string">"[AsyncSubject] å¼€å§‹å¼‚æ­¥é€šçŸ¥ "</span> + observers.size() + <span class="hljs-string">" ä¸ªè§‚å¯Ÿè€…"</span>);

        <span class="hljs-keyword">for</span> (Observer observer : observers) {
            executor.submit(() -&gt; {
                <span class="hljs-keyword">try</span> {
                    observer.update(temperature, humidity, pressure);
                } <span class="hljs-keyword">catch</span> (Exception e) {
                    System.err.println(<span class="hljs-string">"è§‚å¯Ÿè€…æ‰§è¡Œå¤±è´¥: "</span> + e.getMessage());
                }
            });
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shutdown</span><span class="hljs-params">()</span> {
        executor.shutdown();
    }
}
</code></pre>
<h4 data-id="heading-21">7.2 ä½¿ç”¨å¼±å¼•ç”¨é¿å…å†…å­˜æ³„æ¼</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.lang.ref.WeakReference;

<span class="hljs-comment">/**
 * ä½¿ç”¨å¼±å¼•ç”¨çš„ä¸»é¢˜
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">WeakReferenceSubject</span> {

    <span class="hljs-keyword">private</span> List&lt;WeakReference&lt;Observer&gt;&gt; observers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addObserver</span><span class="hljs-params">(Observer observer)</span> {
        observers.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakReference</span>&lt;&gt;(observer));
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyObservers</span><span class="hljs-params">(<span class="hljs-type">float</span> temperature, <span class="hljs-type">float</span> humidity, <span class="hljs-type">float</span> pressure)</span> {
        <span class="hljs-comment">// æ¸…ç†å·²è¢«å›æ”¶çš„è§‚å¯Ÿè€…</span>
        observers.removeIf(ref -&gt; ref.get() == <span class="hljs-literal">null</span>);

        <span class="hljs-comment">// é€šçŸ¥å‰©ä½™è§‚å¯Ÿè€…</span>
        <span class="hljs-keyword">for</span> (WeakReference&lt;Observer&gt; ref : observers) {
            <span class="hljs-type">Observer</span> <span class="hljs-variable">observer</span> <span class="hljs-operator">=</span> ref.get();
            <span class="hljs-keyword">if</span> (observer != <span class="hljs-literal">null</span>) {
                observer.update(temperature, humidity, pressure);
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-22">7.3 æ”¯æŒä¼˜å…ˆçº§</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å¸¦ä¼˜å…ˆçº§çš„è§‚å¯Ÿè€…
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PriorityObserver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Observer</span>, Comparable&lt;PriorityObserver&gt; {

    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> priority;
    <span class="hljs-keyword">private</span> Observer delegate;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">PriorityObserver</span><span class="hljs-params">(Observer delegate, <span class="hljs-type">int</span> priority)</span> {
        <span class="hljs-built_in">this</span>.delegate = delegate;
        <span class="hljs-built_in">this</span>.priority = priority;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">float</span> temperature, <span class="hljs-type">float</span> humidity, <span class="hljs-type">float</span> pressure)</span> {
        delegate.update(temperature, humidity, pressure);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(PriorityObserver other)</span> {
        <span class="hljs-keyword">return</span> Integer.compare(other.priority, <span class="hljs-built_in">this</span>.priority); <span class="hljs-comment">// é™åº</span>
    }
}

<span class="hljs-comment">/**
 * æ”¯æŒä¼˜å…ˆçº§çš„ä¸»é¢˜
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PrioritySubject</span> {

    <span class="hljs-keyword">private</span> java.util.PriorityQueue&lt;PriorityObserver&gt; observers =
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">java</span>.util.PriorityQueue&lt;&gt;();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addObserver</span><span class="hljs-params">(Observer observer, <span class="hljs-type">int</span> priority)</span> {
        observers.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityObserver</span>(observer, priority));
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyObservers</span><span class="hljs-params">(<span class="hljs-type">float</span> temperature, <span class="hljs-type">float</span> humidity, <span class="hljs-type">float</span> pressure)</span> {
        <span class="hljs-comment">// æŒ‰ä¼˜å…ˆçº§é€šçŸ¥</span>
        <span class="hljs-keyword">for</span> (PriorityObserver observer : observers) {
            observer.update(temperature, humidity, pressure);
        }
    }
}
</code></pre>
<h3 data-id="heading-23">å…«ã€æ€»ç»“</h3>
<h4 data-id="heading-24">8.1 æ ¸å¿ƒè¦ç‚¹</h4>
<ol>
<li><strong>è§‚å¯Ÿè€…æ¨¡å¼çš„æœ¬è´¨</strong>ï¼šå®šä¹‰å¯¹è±¡é—´çš„ä¸€å¯¹å¤šä¾èµ–ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€æ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–è€…éƒ½å¾—åˆ°é€šçŸ¥</li>
<li><strong>ä¸¤ç§æ¨¡å‹</strong>ï¼š
<ul>
<li>æ¨æ¨¡å‹ï¼šä¸»é¢˜æ¨é€æ•°æ®ç»™è§‚å¯Ÿè€…</li>
<li>æ‹‰æ¨¡å‹ï¼šè§‚å¯Ÿè€…ä¸»åŠ¨ä»ä¸»é¢˜æ‹‰å–æ•°æ®</li>
</ul>
</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š
<ul>
<li>äº‹ä»¶ç›‘å¬ç³»ç»Ÿ</li>
<li>æ¶ˆæ¯å‘å¸ƒè®¢é˜…</li>
<li>æ•°æ®ç»‘å®š</li>
<li>ç›‘æ§å‘Šè­¦ç³»ç»Ÿ</li>
</ul>
</li>
</ol>
<h4 data-id="heading-25">8.2 ä½¿ç”¨å»ºè®®</h4>
<pre><code class="hljs language-arduino" lang="arduino">é€‰æ‹©è§‚å¯Ÿè€…æ¨¡å¼çš„æ£€æŸ¥æ¸…å•ï¼š

âœ“ ä¸€ä¸ªå¯¹è±¡çš„æ”¹å˜éœ€è¦é€šçŸ¥å…¶ä»–å¯¹è±¡ï¼Ÿ
âœ“ ä¸çŸ¥é“å…·ä½“æœ‰å¤šå°‘å¯¹è±¡éœ€è¦é€šçŸ¥ï¼Ÿ
âœ“ éœ€è¦è§£è€¦ä¸»é¢˜å’Œè§‚å¯Ÿè€…ï¼Ÿ
âœ“ éœ€è¦åŠ¨æ€æ·»åŠ /ç§»é™¤è§‚å¯Ÿè€…ï¼Ÿ

å¦‚æœä»¥ä¸Šéƒ½æ˜¯<span class="hljs-string">"æ˜¯"</span>ï¼Œé‚£ä¹ˆè§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¸ªå¥½é€‰æ‹©ï¼
</code></pre>
<h4 data-id="heading-26">8.3 ä¸å…¶ä»–æ¨¡å¼çš„å¯¹æ¯”</h4>
<pre><code class="hljs language-diff" lang="diff">è§‚å¯Ÿè€… vs å‘å¸ƒ-è®¢é˜…ï¼š
<span class="hljs-deletion">- è§‚å¯Ÿè€…ï¼šä¸»é¢˜ç›´æ¥é€šçŸ¥è§‚å¯Ÿè€…</span>
<span class="hljs-deletion">- å‘å¸ƒ-è®¢é˜…ï¼šé€šè¿‡æ¶ˆæ¯ä¸­é—´ä»¶è§£è€¦</span>

è§‚å¯Ÿè€… vs ä¸­ä»‹è€…ï¼š
<span class="hljs-deletion">- è§‚å¯Ÿè€…ï¼šä¸€å¯¹å¤šå…³ç³»</span>
<span class="hljs-deletion">- ä¸­ä»‹è€…ï¼šå¤šå¯¹å¤šå…³ç³»</span>
</code></pre>
<h4 data-id="heading-27">8.4 å®è·µç»éªŒ</h4>
<ol>
<li><strong>è€ƒè™‘ä½¿ç”¨äº‹ä»¶æ€»çº¿</strong>ï¼šå¦‚Guava EventBusã€Spring Events</li>
<li><strong>å¼‚æ­¥å¤„ç†</strong>ï¼šé¿å…é˜»å¡ä¸»çº¿ç¨‹</li>
<li><strong>æ³¨æ„å†…å­˜æ³„æ¼</strong>ï¼šåŠæ—¶ç§»é™¤è§‚å¯Ÿè€…æˆ–ä½¿ç”¨å¼±å¼•ç”¨</li>
<li><strong>å¤„ç†å¼‚å¸¸</strong>ï¼šä¸€ä¸ªè§‚å¯Ÿè€…å¤±è´¥ä¸åº”å½±å“å…¶ä»–è§‚å¯Ÿè€…</li>
</ol>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹æ¡¥æ¥æ¨¡å¼è¯¦è§£]]></title>    <link>https://juejin.cn/post/7578732288516046899</link>    <guid>https://juejin.cn/post/7578732288516046899</guid>    <pubDate>2025-12-02T01:08:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578732288516046899" data-draft-id="7578714735308292122" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®¾è®¡æ¨¡å¼ä¹‹æ¡¥æ¥æ¨¡å¼è¯¦è§£"/> <meta itemprop="keywords" content="è®¾è®¡æ¨¡å¼,Java"/> <meta itemprop="datePublished" content="2025-12-02T01:08:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®¾è®¡æ¨¡å¼ä¹‹æ¡¥æ¥æ¨¡å¼è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T01:08:50.000Z" title="Tue Dec 02 2025 01:08:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ·±å…¥ç†è§£è®¾è®¡æ¨¡å¼ä¹‹æ¡¥æ¥æ¨¡å¼ï¼ˆBridge Patternï¼‰</h2>
<h3 data-id="heading-1">ä¸€ã€å¼•è¨€</h3>
<p>åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°éœ€è¦åœ¨å¤šä¸ªç»´åº¦ä¸Šæ‰©å±•çš„åœºæ™¯ã€‚æ¯”å¦‚ï¼šå›¾å½¢æ—¢æœ‰å½¢çŠ¶ç»´åº¦ï¼ˆåœ†å½¢ã€çŸ©å½¢ã€ä¸‰è§’å½¢ï¼‰ï¼Œåˆæœ‰é¢œè‰²ç»´åº¦ï¼ˆçº¢è‰²ã€è“è‰²ã€ç»¿è‰²ï¼‰ï¼›æ¶ˆæ¯æ—¢æœ‰ç±»å‹ç»´åº¦ï¼ˆæ–‡æœ¬ã€å›¾ç‰‡ã€è§†é¢‘ï¼‰ï¼Œåˆæœ‰å‘é€æ–¹å¼ç»´åº¦ï¼ˆé‚®ä»¶ã€çŸ­ä¿¡ã€æ¨é€ï¼‰ã€‚</p>
<p>å¦‚æœä½¿ç”¨ä¼ ç»Ÿçš„ç»§æ‰¿æ–¹å¼ï¼Œä¼šå¯¼è‡´ç±»çš„æ•°é‡çˆ†ç‚¸æ€§å¢é•¿ï¼š</p>
<pre><code class="hljs language-erlang" lang="erlang">ä¼ ç»Ÿç»§æ‰¿æ–¹å¼çš„é—®é¢˜ï¼š
å›¾å½¢
â”œâ”€â”€ çº¢è‰²åœ†å½¢
â”œâ”€â”€ è“è‰²åœ†å½¢
â”œâ”€â”€ ç»¿è‰²åœ†å½¢
â”œâ”€â”€ çº¢è‰²çŸ©å½¢
â”œâ”€â”€ è“è‰²çŸ©å½¢
â”œâ”€â”€ ç»¿è‰²çŸ©å½¢
â”œâ”€â”€ çº¢è‰²ä¸‰è§’å½¢
â”œâ”€â”€ è“è‰²ä¸‰è§’å½¢
â””â”€â”€ ç»¿è‰²ä¸‰è§’å½¢

<span class="hljs-number">3</span>ç§å½¢çŠ¶ Ã— <span class="hljs-number">3</span>ç§é¢œè‰² = <span class="hljs-number">9</span>ä¸ªç±»ï¼
å¦‚æœå†åŠ ä¸€ç§å½¢çŠ¶æˆ–é¢œè‰²ï¼Œç±»çš„æ•°é‡ç»§ç»­å¢åŠ ...
</code></pre>
<p>æ¡¥æ¥æ¨¡å¼ä¸ºè¿™ç±»é—®é¢˜æä¾›äº†ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚å®ƒå°±åƒç°å®ä¸­çš„é¥æ§å™¨å’Œç”µè§†ï¼šé¥æ§å™¨ï¼ˆæŠ½è±¡ï¼‰å’Œç”µè§†æœºï¼ˆå®ç°ï¼‰æ˜¯åˆ†ç¦»çš„ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªé¥æ§å™¨æ§åˆ¶ä¸åŒå“ç‰Œçš„ç”µè§†ï¼Œä¹Ÿå¯ä»¥ç”¨ä¸åŒçš„é¥æ§å™¨æ§åˆ¶åŒä¸€ä¸ªç”µè§†ã€‚è¿™ç§åˆ†ç¦»è®©ä¸¤è€…å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥æ¢è®¨æ¡¥æ¥æ¨¡å¼çš„åŸç†ã€å®ç°æ–¹å¼ï¼Œå¹¶ç»“åˆJDBCã€æ—¥å¿—æ¡†æ¶ç­‰å®é™…åº”ç”¨ï¼Œå¸®åŠ©ä½ å…¨é¢æŒæ¡è¿™ä¸€é‡è¦çš„è®¾è®¡æ¨¡å¼ã€‚</p>
<h3 data-id="heading-2">äºŒã€ä»€ä¹ˆæ˜¯æ¡¥æ¥æ¨¡å¼</h3>
<h4 data-id="heading-3">2.1 å®šä¹‰</h4>
<p>æ¡¥æ¥æ¨¡å¼ï¼ˆBridge Patternï¼‰æ˜¯ä¸€ç§ç»“æ„å‹è®¾è®¡æ¨¡å¼ï¼Œå®ƒå°†æŠ½è±¡éƒ¨åˆ†ä¸å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬éƒ½å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚æ¡¥æ¥æ¨¡å¼é€šè¿‡ç»„åˆçš„æ–¹å¼å»ºç«‹ä¸¤ä¸ªç±»ä¹‹é—´çš„è”ç³»ï¼Œè€Œä¸æ˜¯ç»§æ‰¿ã€‚</p>
<h4 data-id="heading-4">2.2 æ ¸å¿ƒæ€æƒ³</h4>
<ul>
<li><strong>åˆ†ç¦»æŠ½è±¡å’Œå®ç°</strong>ï¼šå°†æŠ½è±¡ï¼ˆä¸šåŠ¡åŠŸèƒ½ï¼‰å’Œå®ç°ï¼ˆå¹³å°å®ç°ï¼‰åˆ†ç¦»</li>
<li><strong>ç»„åˆä¼˜äºç»§æ‰¿</strong>ï¼šä½¿ç”¨ç»„åˆå…³ç³»ä»£æ›¿ç»§æ‰¿å…³ç³»</li>
<li><strong>ä¸¤ä¸ªç»´åº¦ç‹¬ç«‹å˜åŒ–</strong>ï¼šæŠ½è±¡å’Œå®ç°å¯ä»¥ç‹¬ç«‹æ‰©å±•</li>
<li><strong>å‡å°‘å­ç±»æ•°é‡</strong>ï¼šé¿å…ç±»çš„çˆ†ç‚¸å¼å¢é•¿</li>
</ul>
<h4 data-id="heading-5">2.3 æ¨¡å¼ç»“æ„</h4>
<pre><code class="hljs language-scss" lang="scss">æ¡¥æ¥æ¨¡å¼ç»“æ„ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   &lt;&lt;interface&gt;&gt;         â”‚
â”‚     Abstraction         â”‚  æŠ½è±¡ç±»
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ - implementor           â”‚â—‡â”€â”€â”€â”€â”  å…³è”å…³ç³»ï¼ˆæ¡¥æ¥ï¼‰
â”‚ + <span class="hljs-built_in">operation</span>()           â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
            â–³                   â”‚
            â”‚ ç»§æ‰¿               â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”            â”‚
     â”‚             â”‚            â”‚
â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚RefinedA  â”‚  â”‚RefinedB  â”‚     â”‚
â”‚Abstraction Abstraction â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
                               â”‚
                               â”‚
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   &lt;&lt;interface&gt;&gt;      â”‚
                    â”‚   Implementor        â”‚  å®ç°æ¥å£
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚ + <span class="hljs-built_in">operationImpl</span>()    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â–³
                               â”‚ å®ç°
                        â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                        â”‚             â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                â”‚ConcreteA â”‚    â”‚ConcreteB  â”‚  å…·ä½“å®ç°
                â”‚Implementor    â”‚Implementorâ”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è°ƒç”¨æµç¨‹ï¼š
Abstraction<span class="hljs-selector-class">.operation</span>() â†’ Implementor<span class="hljs-selector-class">.operationImpl</span>()
æŠ½è±¡è°ƒç”¨å®ç°çš„æ–¹æ³•

å¯¹æ¯”ï¼šä¸ä½¿ç”¨æ¡¥æ¥æ¨¡å¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Shape   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
  â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚               â”‚
â”Œâ”€â”´â”€â”€â”        â”Œâ”€â”€â”´â”€â”€â”€â”
â”‚Red â”‚        â”‚Blue  â”‚
â”‚Shape        â”‚Shape â”‚
â””â”€â”¬â”€â”€â”˜        â””â”€â”€â”¬â”€â”€â”€â”˜
  â”‚              â”‚
â”Œâ”€â”´â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚RedCircleâ”‚  â”‚BlueCircle â”‚
â”‚RedSquareâ”‚  â”‚BlueSquare â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ç±»çš„æ•°é‡ = å½¢çŠ¶æ•° Ã— é¢œè‰²æ•°

ä½¿ç”¨æ¡¥æ¥æ¨¡å¼ï¼š
Shape (æŒæœ‰Colorå¼•ç”¨)
<span class="hljs-attribute">Color</span> (ç‹¬ç«‹çš„é¢œè‰²å®ç°)
ç±»çš„æ•°é‡ = å½¢çŠ¶æ•° + é¢œè‰²æ•°
</code></pre>
<h4 data-id="heading-6">2.4 æ¡¥æ¥æ¨¡å¼çš„åº”ç”¨åœºæ™¯</h4>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> å¤šç»´åº¦å˜åŒ–
<span class="hljs-bullet">   -</span> å½¢çŠ¶ + é¢œè‰²
<span class="hljs-bullet">   -</span> å¹³å° + ä¸šåŠ¡
<span class="hljs-bullet">   -</span> æ¶ˆæ¯ç±»å‹ + å‘é€æ–¹å¼

<span class="hljs-bullet">2.</span> é¿å…ç»§æ‰¿å±‚æ¬¡è¿‡æ·±
<span class="hljs-bullet">   -</span> å‡å°‘å­ç±»æ•°é‡
<span class="hljs-bullet">   -</span> é™ä½ç³»ç»Ÿå¤æ‚åº¦

<span class="hljs-bullet">3.</span> éœ€è¦åœ¨è¿è¡Œæ—¶åˆ‡æ¢å®ç°
<span class="hljs-bullet">   -</span> åŠ¨æ€é€‰æ‹©å®ç°æ–¹å¼
<span class="hljs-bullet">   -</span> ä¸ä¿®æ”¹å®¢æˆ·ç«¯ä»£ç 
</code></pre>
<h3 data-id="heading-7">ä¸‰ã€åŸºç¡€ç¤ºä¾‹</h3>
<h4 data-id="heading-8">3.1 åœºæ™¯ï¼šå›¾å½¢å’Œé¢œè‰²</h4>
<p>ç»å…¸çš„æ¡¥æ¥æ¨¡å¼ç¤ºä¾‹ï¼šå½¢çŠ¶å’Œé¢œè‰²æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„ç»´åº¦ã€‚</p>
<p><strong>å®ç°éƒ¨åˆ†ï¼ˆé¢œè‰²ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å®ç°æ¥å£ï¼šé¢œè‰²
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Color</span> {
    <span class="hljs-comment">/**
     * å¡«å……é¢œè‰²
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">fill</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">/**
 * å…·ä½“å®ç°ï¼šçº¢è‰²
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Red</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Color</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fill</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å¡«å……çº¢è‰²"</span>);
    }
}

<span class="hljs-comment">/**
 * å…·ä½“å®ç°ï¼šè“è‰²
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Blue</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Color</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fill</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å¡«å……è“è‰²"</span>);
    }
}

<span class="hljs-comment">/**
 * å…·ä½“å®ç°ï¼šç»¿è‰²
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Green</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Color</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fill</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å¡«å……ç»¿è‰²"</span>);
    }
}
</code></pre>
<p><strong>æŠ½è±¡éƒ¨åˆ†ï¼ˆå½¢çŠ¶ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æŠ½è±¡ç±»ï¼šå½¢çŠ¶
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Shape</span> {
    <span class="hljs-comment">// æŒæœ‰é¢œè‰²å®ç°çš„å¼•ç”¨ï¼ˆæ¡¥æ¥ï¼‰</span>
    <span class="hljs-keyword">protected</span> Color color;

    <span class="hljs-comment">/**
     * æ„é€ å‡½æ•°æ³¨å…¥é¢œè‰²å®ç°
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Shape</span><span class="hljs-params">(Color color)</span> {
        <span class="hljs-built_in">this</span>.color = color;
    }

    <span class="hljs-comment">/**
     * æŠ½è±¡æ–¹æ³•ï¼šç»˜åˆ¶å½¢çŠ¶
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">/**
 * æ‰©å±•æŠ½è±¡ï¼šåœ†å½¢
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> radius;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Circle</span><span class="hljs-params">(Color color, <span class="hljs-type">double</span> radius)</span> {
        <span class="hljs-built_in">super</span>(color);
        <span class="hljs-built_in">this</span>.radius = radius;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span> {
        System.out.print(<span class="hljs-string">"ç»˜åˆ¶åœ†å½¢ï¼ŒåŠå¾„: "</span> + radius + <span class="hljs-string">" - "</span>);
        color.fill();  <span class="hljs-comment">// è°ƒç”¨å®ç°éƒ¨åˆ†çš„æ–¹æ³•</span>
    }
}

<span class="hljs-comment">/**
 * æ‰©å±•æŠ½è±¡ï¼šçŸ©å½¢
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> width;
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> height;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Rectangle</span><span class="hljs-params">(Color color, <span class="hljs-type">double</span> width, <span class="hljs-type">double</span> height)</span> {
        <span class="hljs-built_in">super</span>(color);
        <span class="hljs-built_in">this</span>.width = width;
        <span class="hljs-built_in">this</span>.height = height;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span> {
        System.out.print(<span class="hljs-string">"ç»˜åˆ¶çŸ©å½¢ï¼Œå®½: "</span> + width + <span class="hljs-string">", é«˜: "</span> + height + <span class="hljs-string">" - "</span>);
        color.fill();
    }
}

<span class="hljs-comment">/**
 * æ‰©å±•æŠ½è±¡ï¼šä¸‰è§’å½¢
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Triangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Shape</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> base;
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> height;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Triangle</span><span class="hljs-params">(Color color, <span class="hljs-type">double</span> base, <span class="hljs-type">double</span> height)</span> {
        <span class="hljs-built_in">super</span>(color);
        <span class="hljs-built_in">this</span>.base = base;
        <span class="hljs-built_in">this</span>.height = height;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">draw</span><span class="hljs-params">()</span> {
        System.out.print(<span class="hljs-string">"ç»˜åˆ¶ä¸‰è§’å½¢ï¼Œåº•: "</span> + base + <span class="hljs-string">", é«˜: "</span> + height + <span class="hljs-string">" - "</span>);
        color.fill();
    }
}
</code></pre>
<p><strong>å®¢æˆ·ç«¯ä½¿ç”¨ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BridgePatternDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åˆ›å»ºä¸åŒé¢œè‰²çš„åœ†å½¢</span>
        System.out.println(<span class="hljs-string">"=== ä¸åŒé¢œè‰²çš„åœ†å½¢ ==="</span>);
        <span class="hljs-type">Shape</span> <span class="hljs-variable">redCircle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Red</span>(), <span class="hljs-number">5.0</span>);
        <span class="hljs-type">Shape</span> <span class="hljs-variable">blueCircle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Blue</span>(), <span class="hljs-number">7.0</span>);
        <span class="hljs-type">Shape</span> <span class="hljs-variable">greenCircle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Green</span>(), <span class="hljs-number">3.0</span>);

        redCircle.draw();
        blueCircle.draw();
        greenCircle.draw();

        <span class="hljs-comment">// åˆ›å»ºä¸åŒé¢œè‰²çš„çŸ©å½¢</span>
        System.out.println(<span class="hljs-string">"\n=== ä¸åŒé¢œè‰²çš„çŸ©å½¢ ==="</span>);
        <span class="hljs-type">Shape</span> <span class="hljs-variable">redRectangle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Red</span>(), <span class="hljs-number">10.0</span>, <span class="hljs-number">5.0</span>);
        <span class="hljs-type">Shape</span> <span class="hljs-variable">blueRectangle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Blue</span>(), <span class="hljs-number">8.0</span>, <span class="hljs-number">6.0</span>);

        redRectangle.draw();
        blueRectangle.draw();

        <span class="hljs-comment">// åˆ›å»ºä¸åŒé¢œè‰²çš„ä¸‰è§’å½¢</span>
        System.out.println(<span class="hljs-string">"\n=== ä¸åŒé¢œè‰²çš„ä¸‰è§’å½¢ ==="</span>);
        <span class="hljs-type">Shape</span> <span class="hljs-variable">greenTriangle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Triangle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Green</span>(), <span class="hljs-number">4.0</span>, <span class="hljs-number">6.0</span>);
        <span class="hljs-type">Shape</span> <span class="hljs-variable">redTriangle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Triangle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Red</span>(), <span class="hljs-number">5.0</span>, <span class="hljs-number">8.0</span>);

        greenTriangle.draw();
        redTriangle.draw();

        <span class="hljs-comment">// ä¼˜åŠ¿ï¼šæ·»åŠ æ–°çš„å½¢çŠ¶æˆ–é¢œè‰²éå¸¸å®¹æ˜“</span>
        <span class="hljs-comment">// æ·»åŠ æ–°é¢œè‰²ï¼šåªéœ€å®ç°Coloræ¥å£</span>
        <span class="hljs-comment">// æ·»åŠ æ–°å½¢çŠ¶ï¼šåªéœ€ç»§æ‰¿Shapeç±»</span>
        <span class="hljs-comment">// ç±»çš„æ•°é‡ï¼š3ä¸ªå½¢çŠ¶ + 3ä¸ªé¢œè‰² = 6ä¸ªç±»</span>
        <span class="hljs-comment">// è€Œä¸æ˜¯ï¼š3 Ã— 3 = 9ä¸ªç±»</span>
    }
}
</code></pre>
<p><strong>è¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-makefile" lang="makefile">=== ä¸åŒé¢œè‰²çš„åœ†å½¢ ===
<span class="hljs-section">ç»˜åˆ¶åœ†å½¢ï¼ŒåŠå¾„: 5.0 - å¡«å……çº¢è‰²</span>
<span class="hljs-section">ç»˜åˆ¶åœ†å½¢ï¼ŒåŠå¾„: 7.0 - å¡«å……è“è‰²</span>
<span class="hljs-section">ç»˜åˆ¶åœ†å½¢ï¼ŒåŠå¾„: 3.0 - å¡«å……ç»¿è‰²</span>

=== ä¸åŒé¢œè‰²çš„çŸ©å½¢ ===
<span class="hljs-section">ç»˜åˆ¶çŸ©å½¢ï¼Œå®½: 10.0, é«˜: 5.0 - å¡«å……çº¢è‰²</span>
<span class="hljs-section">ç»˜åˆ¶çŸ©å½¢ï¼Œå®½: 8.0, é«˜: 6.0 - å¡«å……è“è‰²</span>

=== ä¸åŒé¢œè‰²çš„ä¸‰è§’å½¢ ===
<span class="hljs-section">ç»˜åˆ¶ä¸‰è§’å½¢ï¼Œåº•: 4.0, é«˜: 6.0 - å¡«å……ç»¿è‰²</span>
<span class="hljs-section">ç»˜åˆ¶ä¸‰è§’å½¢ï¼Œåº•: 5.0, é«˜: 8.0 - å¡«å……çº¢è‰²</span>
</code></pre>
<h3 data-id="heading-9">å››ã€å®é™…ç”Ÿäº§åœºæ™¯åº”ç”¨</h3>
<h4 data-id="heading-10">4.1 åœºæ™¯ï¼šæ¶ˆæ¯å‘é€ç³»ç»Ÿ</h4>
<p>åœ¨å®é™…ç³»ç»Ÿä¸­ï¼Œæ¶ˆæ¯æœ‰å¤šç§ç±»å‹ï¼ˆæ–‡æœ¬ã€å›¾ç‰‡ã€è§†é¢‘ï¼‰ï¼Œå‘é€æ–¹å¼ä¹Ÿæœ‰å¤šç§ï¼ˆé‚®ä»¶ã€çŸ­ä¿¡ã€APPæ¨é€ï¼‰ã€‚</p>
<p><strong>å®ç°éƒ¨åˆ†ï¼ˆå‘é€æ–¹å¼ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å®ç°æ¥å£ï¼šæ¶ˆæ¯å‘é€å™¨
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">MessageSender</span> {
    <span class="hljs-comment">/**
     * å‘é€æ¶ˆæ¯
     * <span class="hljs-doctag">@param</span> recipient æ¥æ”¶è€…
     * <span class="hljs-doctag">@param</span> content å†…å®¹
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String recipient, String content)</span>;
}

<span class="hljs-comment">/**
 * å…·ä½“å®ç°ï¼šé‚®ä»¶å‘é€
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailSender</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MessageSender</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String recipient, String content)</span> {
        System.out.println(<span class="hljs-string">"=== é‚®ä»¶å‘é€ ==="</span>);
        System.out.println(<span class="hljs-string">"æ”¶ä»¶äºº: "</span> + recipient);
        System.out.println(<span class="hljs-string">"å†…å®¹: "</span> + content);
        System.out.println(<span class="hljs-string">"é€šè¿‡SMTPæœåŠ¡å™¨å‘é€é‚®ä»¶"</span>);
        System.out.println();
    }
}

<span class="hljs-comment">/**
 * å…·ä½“å®ç°ï¼šçŸ­ä¿¡å‘é€
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SmsSender</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MessageSender</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String recipient, String content)</span> {
        System.out.println(<span class="hljs-string">"=== çŸ­ä¿¡å‘é€ ==="</span>);
        System.out.println(<span class="hljs-string">"æ‰‹æœºå·: "</span> + recipient);
        System.out.println(<span class="hljs-string">"å†…å®¹: "</span> + content);
        System.out.println(<span class="hljs-string">"é€šè¿‡çŸ­ä¿¡ç½‘å…³å‘é€"</span>);
        System.out.println();
    }
}

<span class="hljs-comment">/**
 * å…·ä½“å®ç°ï¼šAPPæ¨é€
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppPushSender</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MessageSender</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String recipient, String content)</span> {
        System.out.println(<span class="hljs-string">"=== APPæ¨é€ ==="</span>);
        System.out.println(<span class="hljs-string">"ç”¨æˆ·ID: "</span> + recipient);
        System.out.println(<span class="hljs-string">"å†…å®¹: "</span> + content);
        System.out.println(<span class="hljs-string">"é€šè¿‡æ¨é€æœåŠ¡å‘é€"</span>);
        System.out.println();
    }
}

<span class="hljs-comment">/**
 * å…·ä½“å®ç°ï¼šä¼ä¸šå¾®ä¿¡å‘é€
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WechatWorkSender</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MessageSender</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String recipient, String content)</span> {
        System.out.println(<span class="hljs-string">"=== ä¼ä¸šå¾®ä¿¡ ==="</span>);
        System.out.println(<span class="hljs-string">"ç”¨æˆ·: "</span> + recipient);
        System.out.println(<span class="hljs-string">"å†…å®¹: "</span> + content);
        System.out.println(<span class="hljs-string">"é€šè¿‡ä¼ä¸šå¾®ä¿¡APIå‘é€"</span>);
        System.out.println();
    }
}
</code></pre>
<p><strong>æŠ½è±¡éƒ¨åˆ†ï¼ˆæ¶ˆæ¯ç±»å‹ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æŠ½è±¡ç±»ï¼šæ¶ˆæ¯
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Message</span> {

    <span class="hljs-comment">// æŒæœ‰å‘é€å™¨çš„å¼•ç”¨ï¼ˆæ¡¥æ¥ï¼‰</span>
    <span class="hljs-keyword">protected</span> MessageSender sender;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Message</span><span class="hljs-params">(MessageSender sender)</span> {
        <span class="hljs-built_in">this</span>.sender = sender;
    }

    <span class="hljs-comment">/**
     * å‘é€æ¶ˆæ¯ï¼ˆæ¨¡æ¿æ–¹æ³•ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendMessage</span><span class="hljs-params">(String recipient)</span> {
        <span class="hljs-comment">// 1. æ ¼å¼åŒ–å†…å®¹ï¼ˆç”±å­ç±»å®ç°ï¼‰</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> formatContent();

        <span class="hljs-comment">// 2. å‘é€å‰ç½®å¤„ç†</span>
        preProcess(recipient);

        <span class="hljs-comment">// 3. ä½¿ç”¨å‘é€å™¨å‘é€</span>
        sender.send(recipient, content);

        <span class="hljs-comment">// 4. å‘é€åç½®å¤„ç†</span>
        postProcess(recipient);
    }

    <span class="hljs-comment">/**
     * æ ¼å¼åŒ–å†…å®¹ï¼ˆç”±å­ç±»å®ç°ï¼‰
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> String <span class="hljs-title function_">formatContent</span><span class="hljs-params">()</span>;

    <span class="hljs-comment">/**
     * å‘é€å‰ç½®å¤„ç†ï¼ˆé’©å­æ–¹æ³•ï¼‰
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">preProcess</span><span class="hljs-params">(String recipient)</span> {
        <span class="hljs-comment">// é»˜è®¤ä¸åšå¤„ç†</span>
    }

    <span class="hljs-comment">/**
     * å‘é€åç½®å¤„ç†ï¼ˆé’©å­æ–¹æ³•ï¼‰
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postProcess</span><span class="hljs-params">(String recipient)</span> {
        <span class="hljs-comment">// é»˜è®¤ä¸åšå¤„ç†</span>
    }
}

<span class="hljs-comment">/**
 * æ‰©å±•æŠ½è±¡ï¼šæ–‡æœ¬æ¶ˆæ¯
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TextMessage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Message</span> {

    <span class="hljs-keyword">private</span> String text;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TextMessage</span><span class="hljs-params">(MessageSender sender, String text)</span> {
        <span class="hljs-built_in">super</span>(sender);
        <span class="hljs-built_in">this</span>.text = text;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> String <span class="hljs-title function_">formatContent</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"[æ–‡æœ¬æ¶ˆæ¯] "</span> + text;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">preProcess</span><span class="hljs-params">(String recipient)</span> {
        System.out.println(<span class="hljs-string">"[å‰ç½®] æ£€æŸ¥æ–‡æœ¬æ¶ˆæ¯æ˜¯å¦åŒ…å«æ•æ„Ÿè¯"</span>);
    }
}

<span class="hljs-comment">/**
 * æ‰©å±•æŠ½è±¡ï¼šå›¾ç‰‡æ¶ˆæ¯
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ImageMessage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Message</span> {

    <span class="hljs-keyword">private</span> String imageUrl;
    <span class="hljs-keyword">private</span> String description;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ImageMessage</span><span class="hljs-params">(MessageSender sender, String imageUrl, String description)</span> {
        <span class="hljs-built_in">super</span>(sender);
        <span class="hljs-built_in">this</span>.imageUrl = imageUrl;
        <span class="hljs-built_in">this</span>.description = description;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> String <span class="hljs-title function_">formatContent</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"[å›¾ç‰‡æ¶ˆæ¯]\n"</span> +
               <span class="hljs-string">"å›¾ç‰‡URL: "</span> + imageUrl + <span class="hljs-string">"\n"</span> +
               <span class="hljs-string">"æè¿°: "</span> + description;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">preProcess</span><span class="hljs-params">(String recipient)</span> {
        System.out.println(<span class="hljs-string">"[å‰ç½®] æ£€æŸ¥å›¾ç‰‡æ˜¯å¦å­˜åœ¨ä¸”å¯è®¿é—®"</span>);
    }
}

<span class="hljs-comment">/**
 * æ‰©å±•æŠ½è±¡ï¼šç´§æ€¥æ¶ˆæ¯
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UrgentMessage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Message</span> {

    <span class="hljs-keyword">private</span> String title;
    <span class="hljs-keyword">private</span> String content;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UrgentMessage</span><span class="hljs-params">(MessageSender sender, String title, String content)</span> {
        <span class="hljs-built_in">super</span>(sender);
        <span class="hljs-built_in">this</span>.title = title;
        <span class="hljs-built_in">this</span>.content = content;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> String <span class="hljs-title function_">formatContent</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"ã€ç´§æ€¥é€šçŸ¥ã€‘"</span> + title + <span class="hljs-string">"\n"</span> + content;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">preProcess</span><span class="hljs-params">(String recipient)</span> {
        System.out.println(<span class="hljs-string">"[å‰ç½®] è®°å½•ç´§æ€¥æ¶ˆæ¯å‘é€æ—¥å¿—"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postProcess</span><span class="hljs-params">(String recipient)</span> {
        System.out.println(<span class="hljs-string">"[åç½®] ç¡®è®¤æ¶ˆæ¯å·²é€è¾¾"</span>);
    }
}
</code></pre>
<p><strong>å®¢æˆ·ç«¯ä½¿ç”¨ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageBridgeDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åœºæ™¯1ï¼šé€šè¿‡é‚®ä»¶å‘é€æ–‡æœ¬æ¶ˆæ¯</span>
        System.out.println(<span class="hljs-string">"========== åœºæ™¯1 =========="</span>);
        <span class="hljs-type">Message</span> <span class="hljs-variable">emailText</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextMessage</span>(
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">EmailSender</span>(),
            <span class="hljs-string">"æ‚¨å¥½ï¼Œè¿™æ˜¯ä¸€æ¡æµ‹è¯•æ¶ˆæ¯"</span>
        );
        emailText.sendMessage(<span class="hljs-string">"user@example.com"</span>);

        <span class="hljs-comment">// åœºæ™¯2ï¼šé€šè¿‡çŸ­ä¿¡å‘é€æ–‡æœ¬æ¶ˆæ¯</span>
        System.out.println(<span class="hljs-string">"========== åœºæ™¯2 =========="</span>);
        <span class="hljs-type">Message</span> <span class="hljs-variable">smsText</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextMessage</span>(
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">SmsSender</span>(),
            <span class="hljs-string">"æ‚¨çš„éªŒè¯ç æ˜¯ï¼š123456"</span>
        );
        smsText.sendMessage(<span class="hljs-string">"138****8888"</span>);

        <span class="hljs-comment">// åœºæ™¯3ï¼šé€šè¿‡APPæ¨é€å‘é€å›¾ç‰‡æ¶ˆæ¯</span>
        System.out.println(<span class="hljs-string">"========== åœºæ™¯3 =========="</span>);
        <span class="hljs-type">Message</span> <span class="hljs-variable">appImage</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageMessage</span>(
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppPushSender</span>(),
            <span class="hljs-string">"https://example.com/image.jpg"</span>,
            <span class="hljs-string">"æ–°äº§å“ä¸Šçº¿"</span>
        );
        appImage.sendMessage(<span class="hljs-string">"USER001"</span>);

        <span class="hljs-comment">// åœºæ™¯4ï¼šé€šè¿‡ä¼ä¸šå¾®ä¿¡å‘é€ç´§æ€¥æ¶ˆæ¯</span>
        System.out.println(<span class="hljs-string">"========== åœºæ™¯4 =========="</span>);
        <span class="hljs-type">Message</span> <span class="hljs-variable">urgentWechat</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UrgentMessage</span>(
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">WechatWorkSender</span>(),
            <span class="hljs-string">"ç³»ç»Ÿå‘Šè­¦"</span>,
            <span class="hljs-string">"ç”Ÿäº§ç¯å¢ƒCPUä½¿ç”¨ç‡è¶…è¿‡90%"</span>
        );
        urgentWechat.sendMessage(<span class="hljs-string">"è¿ç»´å›¢é˜Ÿ"</span>);

        <span class="hljs-comment">// ä¼˜åŠ¿ï¼šè½»æ¾ç»„åˆä¸åŒçš„æ¶ˆæ¯ç±»å‹å’Œå‘é€æ–¹å¼</span>
        <span class="hljs-comment">// æ·»åŠ æ–°çš„æ¶ˆæ¯ç±»å‹ï¼šåªéœ€ç»§æ‰¿Message</span>
        <span class="hljs-comment">// æ·»åŠ æ–°çš„å‘é€æ–¹å¼ï¼šåªéœ€å®ç°MessageSender</span>
    }
}
</code></pre>
<h4 data-id="heading-11">4.2 åœºæ™¯ï¼šè·¨å¹³å°è§†é¢‘æ’­æ”¾å™¨</h4>
<p>è§†é¢‘æ’­æ”¾å™¨éœ€è¦æ”¯æŒå¤šç§å¹³å°ï¼ˆWindowsã€Macã€Linuxï¼‰å’Œå¤šç§æ ¼å¼ï¼ˆMP4ã€AVIã€MKVï¼‰ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å®ç°æ¥å£ï¼šè§†é¢‘æ’­æ”¾å¼•æ“
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">VideoPlayerEngine</span> {
    <span class="hljs-comment">/**
     * åˆå§‹åŒ–å¼•æ“
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">initialize</span><span class="hljs-params">()</span>;

    <span class="hljs-comment">/**
     * æ’­æ”¾è§†é¢‘
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">play</span><span class="hljs-params">(String fileName)</span>;

    <span class="hljs-comment">/**
     * æš‚åœæ’­æ”¾
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">pause</span><span class="hljs-params">()</span>;

    <span class="hljs-comment">/**
     * åœæ­¢æ’­æ”¾
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">/**
 * å…·ä½“å®ç°ï¼šWindowsæ’­æ”¾å¼•æ“
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WindowsVideoEngine</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">VideoPlayerEngine</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initialize</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"[Windows] åˆå§‹åŒ–DirectShowå¼•æ“"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">play</span><span class="hljs-params">(String fileName)</span> {
        System.out.println(<span class="hljs-string">"[Windows] ä½¿ç”¨Windows Media Playeræ’­æ”¾: "</span> + fileName);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pause</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"[Windows] æš‚åœæ’­æ”¾"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"[Windows] åœæ­¢æ’­æ”¾"</span>);
    }
}

<span class="hljs-comment">/**
 * å…·ä½“å®ç°ï¼šMacæ’­æ”¾å¼•æ“
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MacVideoEngine</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">VideoPlayerEngine</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initialize</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"[Mac] åˆå§‹åŒ–AVFoundationå¼•æ“"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">play</span><span class="hljs-params">(String fileName)</span> {
        System.out.println(<span class="hljs-string">"[Mac] ä½¿ç”¨QuickTimeæ’­æ”¾: "</span> + fileName);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pause</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"[Mac] æš‚åœæ’­æ”¾"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"[Mac] åœæ­¢æ’­æ”¾"</span>);
    }
}

<span class="hljs-comment">/**
 * å…·ä½“å®ç°ï¼šLinuxæ’­æ”¾å¼•æ“
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LinuxVideoEngine</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">VideoPlayerEngine</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initialize</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"[Linux] åˆå§‹åŒ–FFmpegå¼•æ“"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">play</span><span class="hljs-params">(String fileName)</span> {
        System.out.println(<span class="hljs-string">"[Linux] ä½¿ç”¨VLCæ’­æ”¾: "</span> + fileName);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pause</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"[Linux] æš‚åœæ’­æ”¾"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"[Linux] åœæ­¢æ’­æ”¾"</span>);
    }
}

<span class="hljs-comment">/**
 * æŠ½è±¡ç±»ï¼šè§†é¢‘æ’­æ”¾å™¨
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VideoPlayer</span> {

    <span class="hljs-keyword">protected</span> VideoPlayerEngine engine;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">VideoPlayer</span><span class="hljs-params">(VideoPlayerEngine engine)</span> {
        <span class="hljs-built_in">this</span>.engine = engine;
        <span class="hljs-built_in">this</span>.engine.initialize();
    }

    <span class="hljs-comment">/**
     * æ’­æ”¾è§†é¢‘
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">playVideo</span><span class="hljs-params">(String fileName)</span>;
}

<span class="hljs-comment">/**
 * æ‰©å±•æŠ½è±¡ï¼šé«˜æ¸…æ’­æ”¾å™¨
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HDVideoPlayer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">VideoPlayer</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">HDVideoPlayer</span><span class="hljs-params">(VideoPlayerEngine engine)</span> {
        <span class="hljs-built_in">super</span>(engine);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">playVideo</span><span class="hljs-params">(String fileName)</span> {
        System.out.println(<span class="hljs-string">"\n=== é«˜æ¸…æ’­æ”¾æ¨¡å¼ ==="</span>);
        System.out.println(<span class="hljs-string">"åˆ†è¾¨ç‡: 1920x1080"</span>);
        System.out.println(<span class="hljs-string">"æ¯”ç‰¹ç‡: 5000kbps"</span>);
        engine.play(fileName);
    }
}

<span class="hljs-comment">/**
 * æ‰©å±•æŠ½è±¡ï¼šæ ‡æ¸…æ’­æ”¾å™¨
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SDVideoPlayer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">VideoPlayer</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SDVideoPlayer</span><span class="hljs-params">(VideoPlayerEngine engine)</span> {
        <span class="hljs-built_in">super</span>(engine);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">playVideo</span><span class="hljs-params">(String fileName)</span> {
        System.out.println(<span class="hljs-string">"\n=== æ ‡æ¸…æ’­æ”¾æ¨¡å¼ ==="</span>);
        System.out.println(<span class="hljs-string">"åˆ†è¾¨ç‡: 720x480"</span>);
        System.out.println(<span class="hljs-string">"æ¯”ç‰¹ç‡: 1500kbps"</span>);
        engine.play(fileName);
    }
}

<span class="hljs-comment">/**
 * æ‰©å±•æŠ½è±¡ï¼šæµåª’ä½“æ’­æ”¾å™¨
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StreamingVideoPlayer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">VideoPlayer</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">StreamingVideoPlayer</span><span class="hljs-params">(VideoPlayerEngine engine)</span> {
        <span class="hljs-built_in">super</span>(engine);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">playVideo</span><span class="hljs-params">(String fileName)</span> {
        System.out.println(<span class="hljs-string">"\n=== æµåª’ä½“æ’­æ”¾æ¨¡å¼ ==="</span>);
        System.out.println(<span class="hljs-string">"å¯ç”¨ç¼“å†²: æ˜¯"</span>);
        System.out.println(<span class="hljs-string">"è‡ªé€‚åº”æ¯”ç‰¹ç‡: å¼€å¯"</span>);
        engine.play(fileName);
    }
}

<span class="hljs-comment">/**
 * æµ‹è¯•è§†é¢‘æ’­æ”¾å™¨
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">VideoPlayerDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// Windowså¹³å°é«˜æ¸…æ’­æ”¾</span>
        System.out.println(<span class="hljs-string">"========== Windowså¹³å° =========="</span>);
        <span class="hljs-type">VideoPlayer</span> <span class="hljs-variable">windowsHD</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HDVideoPlayer</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WindowsVideoEngine</span>());
        windowsHD.playVideo(<span class="hljs-string">"movie.mp4"</span>);

        <span class="hljs-comment">// Macå¹³å°æ ‡æ¸…æ’­æ”¾</span>
        System.out.println(<span class="hljs-string">"\n========== Macå¹³å° =========="</span>);
        <span class="hljs-type">VideoPlayer</span> <span class="hljs-variable">macSD</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SDVideoPlayer</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MacVideoEngine</span>());
        macSD.playVideo(<span class="hljs-string">"video.avi"</span>);

        <span class="hljs-comment">// Linuxå¹³å°æµåª’ä½“æ’­æ”¾</span>
        System.out.println(<span class="hljs-string">"\n========== Linuxå¹³å° =========="</span>);
        <span class="hljs-type">VideoPlayer</span> <span class="hljs-variable">linuxStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamingVideoPlayer</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LinuxVideoEngine</span>());
        linuxStream.playVideo(<span class="hljs-string">"stream.mkv"</span>);

        <span class="hljs-comment">// ä¼˜åŠ¿ï¼š</span>
        <span class="hljs-comment">// 1. 3ç§æ’­æ”¾å™¨ç±»å‹ + 3ç§å¹³å°å¼•æ“ = 6ä¸ªç±»</span>
        <span class="hljs-comment">// 2. ä¸ä½¿ç”¨æ¡¥æ¥ï¼š3 Ã— 3 = 9ä¸ªç±»</span>
        <span class="hljs-comment">// 3. æ·»åŠ æ–°å¹³å°æˆ–æ–°æ’­æ”¾å™¨ç±»å‹éƒ½å¾ˆå®¹æ˜“</span>
    }
}
</code></pre>
<h3 data-id="heading-12">äº”ã€å¼€æºæ¡†æ¶ä¸­çš„åº”ç”¨</h3>
<h4 data-id="heading-13">5.1 JDBCé©±åŠ¨ç¨‹åº</h4>
<p>JDBCæ˜¯æ¡¥æ¥æ¨¡å¼æœ€ç»å…¸çš„åº”ç”¨ä¹‹ä¸€ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * JDBCçš„æ¡¥æ¥æ¨¡å¼
 *
 * æŠ½è±¡éƒ¨åˆ†ï¼šJDBC APIï¼ˆjava.sqlåŒ…ï¼‰
 *   - Connection
 *   - Statement
 *   - ResultSet
 *
 * å®ç°éƒ¨åˆ†ï¼šå„å‚å•†çš„JDBCé©±åŠ¨
 *   - MySQLé©±åŠ¨
 *   - Oracleé©±åŠ¨
 *   - PostgreSQLé©±åŠ¨
 */</span>

<span class="hljs-keyword">import</span> java.sql.*;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JdbcBridgeExample</span> {

    <span class="hljs-comment">/**
     * JDBCä½¿ç”¨ç¤ºä¾‹
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">demonstrateJdbc</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">// æŠ½è±¡ï¼šä½¿ç”¨æ ‡å‡†JDBC API</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;

        <span class="hljs-comment">// å®ç°ï¼šé€šè¿‡DriverManageré€‰æ‹©å…·ä½“é©±åŠ¨</span>
        <span class="hljs-comment">// MySQLé©±åŠ¨</span>
        conn = DriverManager.getConnection(
            <span class="hljs-string">"jdbc:mysql://localhost:3306/mydb"</span>,
            <span class="hljs-string">"user"</span>,
            <span class="hljs-string">"password"</span>
        );

        <span class="hljs-comment">// æˆ–è€…Oracleé©±åŠ¨ï¼ˆåªéœ€æ›´æ”¹URLï¼Œä»£ç ä¸å˜ï¼‰</span>
        <span class="hljs-comment">// conn = DriverManager.getConnection(</span>
        <span class="hljs-comment">//     "jdbc:oracle:thin:@localhost:1521:orcl",</span>
        <span class="hljs-comment">//     "user",</span>
        <span class="hljs-comment">//     "password"</span>
        <span class="hljs-comment">// );</span>

        <span class="hljs-comment">// ä½¿ç”¨ç›¸åŒçš„JDBC APIæ“ä½œæ•°æ®åº“</span>
        <span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> conn.createStatement();
        <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> stmt.executeQuery(<span class="hljs-string">"SELECT * FROM users"</span>);

        <span class="hljs-keyword">while</span> (rs.next()) {
            System.out.println(rs.getString(<span class="hljs-string">"name"</span>));
        }

        rs.close();
        stmt.close();
        conn.close();
    }
}

<span class="hljs-comment">/**
 * ç®€åŒ–çš„JDBCæ¡¥æ¥æ¨¡å¼å®ç°
 */</span>

<span class="hljs-comment">// æŠ½è±¡éƒ¨åˆ†ï¼šæ•°æ®åº“è¿æ¥</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">DatabaseConnection</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">connect</span><span class="hljs-params">(String url)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeQuery</span><span class="hljs-params">(String sql)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">// å®ç°éƒ¨åˆ†ï¼šæ•°æ®åº“é©±åŠ¨æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">DatabaseDriver</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">establishConnection</span><span class="hljs-params">(String url)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">runQuery</span><span class="hljs-params">(String sql)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">disconnect</span><span class="hljs-params">()</span>;
}

<span class="hljs-comment">// MySQLé©±åŠ¨å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MySqlDriver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">DatabaseDriver</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">establishConnection</span><span class="hljs-params">(String url)</span> {
        System.out.println(<span class="hljs-string">"[MySQL] å»ºç«‹è¿æ¥: "</span> + url);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">runQuery</span><span class="hljs-params">(String sql)</span> {
        System.out.println(<span class="hljs-string">"[MySQL] æ‰§è¡ŒæŸ¥è¯¢: "</span> + sql);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">disconnect</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"[MySQL] æ–­å¼€è¿æ¥"</span>);
    }
}

<span class="hljs-comment">// Oracleé©±åŠ¨å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">OracleDriver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">DatabaseDriver</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">establishConnection</span><span class="hljs-params">(String url)</span> {
        System.out.println(<span class="hljs-string">"[Oracle] å»ºç«‹è¿æ¥: "</span> + url);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">runQuery</span><span class="hljs-params">(String sql)</span> {
        System.out.println(<span class="hljs-string">"[Oracle] æ‰§è¡ŒæŸ¥è¯¢: "</span> + sql);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">disconnect</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"[Oracle] æ–­å¼€è¿æ¥"</span>);
    }
}

<span class="hljs-comment">// æ¡¥æ¥å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">JdbcConnection</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">DatabaseConnection</span> {
    <span class="hljs-keyword">private</span> DatabaseDriver driver;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">JdbcConnection</span><span class="hljs-params">(DatabaseDriver driver)</span> {
        <span class="hljs-built_in">this</span>.driver = driver;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">connect</span><span class="hljs-params">(String url)</span> {
        driver.establishConnection(url);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">executeQuery</span><span class="hljs-params">(String sql)</span> {
        driver.runQuery(sql);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        driver.disconnect();
    }
}

<span class="hljs-comment">/**
 * æµ‹è¯•JDBCæ¡¥æ¥
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">JdbcBridgeDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// ä½¿ç”¨MySQLé©±åŠ¨</span>
        System.out.println(<span class="hljs-string">"=== ä½¿ç”¨MySQL ==="</span>);
        <span class="hljs-type">DatabaseConnection</span> <span class="hljs-variable">mysqlConn</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JdbcConnection</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MySqlDriver</span>());
        mysqlConn.connect(<span class="hljs-string">"jdbc:mysql://localhost:3306/mydb"</span>);
        mysqlConn.executeQuery(<span class="hljs-string">"SELECT * FROM users"</span>);
        mysqlConn.close();

        <span class="hljs-comment">// åˆ‡æ¢åˆ°Oracleé©±åŠ¨ï¼ˆå®¢æˆ·ç«¯ä»£ç ä¸å˜ï¼‰</span>
        System.out.println(<span class="hljs-string">"\n=== ä½¿ç”¨Oracle ==="</span>);
        <span class="hljs-type">DatabaseConnection</span> <span class="hljs-variable">oracleConn</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JdbcConnection</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OracleDriver</span>());
        oracleConn.connect(<span class="hljs-string">"jdbc:oracle:thin:@localhost:1521:orcl"</span>);
        oracleConn.executeQuery(<span class="hljs-string">"SELECT * FROM users"</span>);
        oracleConn.close();
    }
}
</code></pre>
<h4 data-id="heading-14">5.2 SLF4Jæ—¥å¿—æ¡†æ¶</h4>
<p>SLF4Jï¼ˆSimple Logging Facade for Javaï¼‰ä½¿ç”¨æ¡¥æ¥æ¨¡å¼æ”¯æŒå¤šç§æ—¥å¿—å®ç°ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * SLF4Jçš„æ¡¥æ¥æ¨¡å¼
 *
 * æŠ½è±¡éƒ¨åˆ†ï¼šSLF4J API
 *   - Loggeræ¥å£
 *   - LoggerFactory
 *
 * å®ç°éƒ¨åˆ†ï¼šå„ç§æ—¥å¿—æ¡†æ¶
 *   - Logback
 *   - Log4j
 *   - JDK Logging
 */</span>

<span class="hljs-comment">// æ¨¡æ‹ŸSLF4Jçš„æ¡¥æ¥å®ç°</span>

<span class="hljs-comment">/**
 * æŠ½è±¡éƒ¨åˆ†ï¼šæ—¥å¿—æ¥å£
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Logger</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">info</span><span class="hljs-params">(String message)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">debug</span><span class="hljs-params">(String message)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">error</span><span class="hljs-params">(String message)</span>;
}

<span class="hljs-comment">/**
 * å®ç°éƒ¨åˆ†ï¼šæ—¥å¿—å®ç°æ¥å£
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">LoggerImplementation</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">logInfo</span><span class="hljs-params">(String message)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">logDebug</span><span class="hljs-params">(String message)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">logError</span><span class="hljs-params">(String message)</span>;
}

<span class="hljs-comment">/**
 * Logbackå®ç°
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LogbackImplementation</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">LoggerImplementation</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logInfo</span><span class="hljs-params">(String message)</span> {
        System.out.println(<span class="hljs-string">"[Logback] INFO - "</span> + message);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logDebug</span><span class="hljs-params">(String message)</span> {
        System.out.println(<span class="hljs-string">"[Logback] DEBUG - "</span> + message);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logError</span><span class="hljs-params">(String message)</span> {
        System.out.println(<span class="hljs-string">"[Logback] ERROR - "</span> + message);
    }
}

<span class="hljs-comment">/**
 * Log4jå®ç°
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Log4jImplementation</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">LoggerImplementation</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logInfo</span><span class="hljs-params">(String message)</span> {
        System.out.println(<span class="hljs-string">"[Log4j] INFO - "</span> + message);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logDebug</span><span class="hljs-params">(String message)</span> {
        System.out.println(<span class="hljs-string">"[Log4j] DEBUG - "</span> + message);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logError</span><span class="hljs-params">(String message)</span> {
        System.out.println(<span class="hljs-string">"[Log4j] ERROR - "</span> + message);
    }
}

<span class="hljs-comment">/**
 * æ¡¥æ¥å®ç°ï¼šSLF4J Logger
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Slf4jLogger</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Logger</span> {
    <span class="hljs-keyword">private</span> LoggerImplementation implementation;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Slf4jLogger</span><span class="hljs-params">(LoggerImplementation implementation)</span> {
        <span class="hljs-built_in">this</span>.implementation = implementation;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">info</span><span class="hljs-params">(String message)</span> {
        implementation.logInfo(message);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">debug</span><span class="hljs-params">(String message)</span> {
        implementation.logDebug(message);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">error</span><span class="hljs-params">(String message)</span> {
        implementation.logError(message);
    }
}

<span class="hljs-comment">/**
 * æ—¥å¿—å·¥å‚
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LoggerFactory</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> LoggerImplementation implementation;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-comment">// æ ¹æ®classpathä¸­çš„å®ç°è‡ªåŠ¨é€‰æ‹©</span>
        <span class="hljs-comment">// ç®€åŒ–ï¼šè¿™é‡Œæ‰‹åŠ¨æŒ‡å®š</span>
        implementation = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LogbackImplementation</span>();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Logger <span class="hljs-title function_">getLogger</span><span class="hljs-params">(Class&lt;?&gt; clazz)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Slf4jLogger</span>(implementation);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setImplementation</span><span class="hljs-params">(LoggerImplementation impl)</span> {
        implementation = impl;
    }
}

<span class="hljs-comment">/**
 * æµ‹è¯•SLF4Jæ¡¥æ¥
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Slf4jBridgeDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// ä½¿ç”¨Logbackå®ç°</span>
        System.out.println(<span class="hljs-string">"=== ä½¿ç”¨Logback ==="</span>);
        <span class="hljs-type">Logger</span> <span class="hljs-variable">logger1</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(Slf4jBridgeDemo.class);
        logger1.info(<span class="hljs-string">"åº”ç”¨å¯åŠ¨"</span>);
        logger1.debug(<span class="hljs-string">"è°ƒè¯•ä¿¡æ¯"</span>);
        logger1.error(<span class="hljs-string">"å‘ç”Ÿé”™è¯¯"</span>);

        <span class="hljs-comment">// åˆ‡æ¢åˆ°Log4jå®ç°ï¼ˆåº”ç”¨ä»£ç ä¸å˜ï¼‰</span>
        System.out.println(<span class="hljs-string">"\n=== åˆ‡æ¢åˆ°Log4j ==="</span>);
        LoggerFactory.setImplementation(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Log4jImplementation</span>());
        <span class="hljs-type">Logger</span> <span class="hljs-variable">logger2</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(Slf4jBridgeDemo.class);
        logger2.info(<span class="hljs-string">"åº”ç”¨å¯åŠ¨"</span>);
        logger2.debug(<span class="hljs-string">"è°ƒè¯•ä¿¡æ¯"</span>);
        logger2.error(<span class="hljs-string">"å‘ç”Ÿé”™è¯¯"</span>);
    }
}
</code></pre>
<h4 data-id="heading-15">5.3 AWT/Swingç»„ä»¶</h4>
<p>Javaçš„GUIæ¡†æ¶ä¹Ÿä½¿ç”¨äº†æ¡¥æ¥æ¨¡å¼ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * AWT/Swingçš„æ¡¥æ¥æ¨¡å¼
 *
 * æŠ½è±¡éƒ¨åˆ†ï¼šComponentã€Windowç­‰
 * å®ç°éƒ¨åˆ†ï¼šComponentPeerï¼ˆå¹³å°ç›¸å…³çš„å®ç°ï¼‰
 *   - WComponentPeer (Windows)
 *   - XComponentPeer (Linux/X11)
 *   - LWComponentPeer (è½»é‡çº§ç»„ä»¶)
 */</span>

<span class="hljs-comment">/**
 * ç®€åŒ–çš„GUIç»„ä»¶æ¡¥æ¥å®ç°
 */</span>

<span class="hljs-comment">// å®ç°æ¥å£ï¼šç»„ä»¶å¯¹ç­‰ä½“</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ComponentPeer</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">create</span><span class="hljs-params">()</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">setVisible</span><span class="hljs-params">(<span class="hljs-type">boolean</span> visible)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">setBounds</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, <span class="hljs-type">int</span> width, <span class="hljs-type">int</span> height)</span>;
}

<span class="hljs-comment">// Windowså¹³å°å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">WindowsPeer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ComponentPeer</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">create</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"[Windows] åˆ›å»ºWin32çª—å£"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setVisible</span><span class="hljs-params">(<span class="hljs-type">boolean</span> visible)</span> {
        System.out.println(<span class="hljs-string">"[Windows] è®¾ç½®çª—å£å¯è§æ€§: "</span> + visible);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setBounds</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, <span class="hljs-type">int</span> width, <span class="hljs-type">int</span> height)</span> {
        System.out.println(<span class="hljs-string">"[Windows] è®¾ç½®çª—å£ä½ç½®å’Œå¤§å°: ("</span> + x + <span class="hljs-string">", "</span> + y + <span class="hljs-string">", "</span> + width + <span class="hljs-string">", "</span> + height + <span class="hljs-string">")"</span>);
    }
}

<span class="hljs-comment">// Linuxå¹³å°å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LinuxPeer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ComponentPeer</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">create</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"[Linux] åˆ›å»ºX11çª—å£"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setVisible</span><span class="hljs-params">(<span class="hljs-type">boolean</span> visible)</span> {
        System.out.println(<span class="hljs-string">"[Linux] è®¾ç½®çª—å£å¯è§æ€§: "</span> + visible);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setBounds</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, <span class="hljs-type">int</span> width, <span class="hljs-type">int</span> height)</span> {
        System.out.println(<span class="hljs-string">"[Linux] è®¾ç½®çª—å£ä½ç½®å’Œå¤§å°: ("</span> + x + <span class="hljs-string">", "</span> + y + <span class="hljs-string">", "</span> + width + <span class="hljs-string">", "</span> + height + <span class="hljs-string">")"</span>);
    }
}

<span class="hljs-comment">// æŠ½è±¡ç»„ä»¶</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Component</span> {
    <span class="hljs-keyword">protected</span> ComponentPeer peer;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createPeer</span><span class="hljs-params">()</span> {
        peer = createComponentPeer();
        peer.create();
    }

    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> ComponentPeer <span class="hljs-title function_">createComponentPeer</span><span class="hljs-params">()</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setVisible</span><span class="hljs-params">(<span class="hljs-type">boolean</span> visible)</span> {
        <span class="hljs-keyword">if</span> (peer != <span class="hljs-literal">null</span>) {
            peer.setVisible(visible);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setBounds</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, <span class="hljs-type">int</span> width, <span class="hljs-type">int</span> height)</span> {
        <span class="hljs-keyword">if</span> (peer != <span class="hljs-literal">null</span>) {
            peer.setBounds(x, y, width, height);
        }
    }
}

<span class="hljs-comment">// å…·ä½“ç»„ä»¶ï¼šçª—å£</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Window</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Component</span> {
    <span class="hljs-keyword">private</span> String os;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Window</span><span class="hljs-params">(String os)</span> {
        <span class="hljs-built_in">this</span>.os = os;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> ComponentPeer <span class="hljs-title function_">createComponentPeer</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-string">"Windows"</span>.equals(os)) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WindowsPeer</span>();
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">"Linux"</span>.equals(os)) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinuxPeer</span>();
        }
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>(<span class="hljs-string">"ä¸æ”¯æŒçš„æ“ä½œç³»ç»Ÿ"</span>);
    }
}

<span class="hljs-comment">/**
 * æµ‹è¯•GUIæ¡¥æ¥
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">GuiBridgeDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// Windowså¹³å°</span>
        System.out.println(<span class="hljs-string">"=== Windowså¹³å° ==="</span>);
        <span class="hljs-type">Component</span> <span class="hljs-variable">windowsWindow</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Window</span>(<span class="hljs-string">"Windows"</span>);
        windowsWindow.createPeer();
        windowsWindow.setBounds(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">800</span>, <span class="hljs-number">600</span>);
        windowsWindow.setVisible(<span class="hljs-literal">true</span>);

        <span class="hljs-comment">// Linuxå¹³å°</span>
        System.out.println(<span class="hljs-string">"\n=== Linuxå¹³å° ==="</span>);
        <span class="hljs-type">Component</span> <span class="hljs-variable">linuxWindow</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Window</span>(<span class="hljs-string">"Linux"</span>);
        linuxWindow.createPeer();
        linuxWindow.setBounds(<span class="hljs-number">50</span>, <span class="hljs-number">50</span>, <span class="hljs-number">1024</span>, <span class="hljs-number">768</span>);
        linuxWindow.setVisible(<span class="hljs-literal">true</span>);
    }
}
</code></pre>
<h3 data-id="heading-16">å…­ã€æ¡¥æ¥æ¨¡å¼çš„ä¼˜ç¼ºç‚¹</h3>
<h4 data-id="heading-17">6.1 ä¼˜ç‚¹</h4>
<p><strong>1. åˆ†ç¦»æŠ½è±¡å’Œå®ç°</strong></p>
<pre><code class="hljs">æŠ½è±¡å’Œå®ç°å¯ä»¥ç‹¬ç«‹å˜åŒ–
ä¸ä¼šç›¸äº’å½±å“
</code></pre>
<p><strong>2. å‡å°‘å­ç±»æ•°é‡</strong></p>
<pre><code class="hljs">ä¸ä½¿ç”¨æ¡¥æ¥ï¼š
å½¢çŠ¶ç±» = å½¢çŠ¶æ•° Ã— é¢œè‰²æ•°
3ç§å½¢çŠ¶ Ã— 3ç§é¢œè‰² = 9ä¸ªç±»

ä½¿ç”¨æ¡¥æ¥ï¼š
å½¢çŠ¶ç±» + é¢œè‰²ç±» = å½¢çŠ¶æ•° + é¢œè‰²æ•°
3ç§å½¢çŠ¶ + 3ç§é¢œè‰² = 6ä¸ªç±»

å‡å°‘äº†ç±»çš„æ•°é‡ï¼
</code></pre>
<p><strong>3. æé«˜å¯æ‰©å±•æ€§</strong></p>
<pre><code class="hljs">æ·»åŠ æ–°çš„æŠ½è±¡ï¼šä¸å½±å“å®ç°
æ·»åŠ æ–°çš„å®ç°ï¼šä¸å½±å“æŠ½è±¡
ç¬¦åˆå¼€é—­åŸåˆ™
</code></pre>
<p><strong>4. éšè—å®ç°ç»†èŠ‚</strong></p>
<pre><code class="hljs">å®¢æˆ·ç«¯åªçŸ¥é“æŠ½è±¡æ¥å£
ä¸éœ€è¦äº†è§£å…·ä½“å®ç°
</code></pre>
<p><strong>5. è¿è¡Œæ—¶åˆ‡æ¢å®ç°</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ‡æ¢å®ç°</span>
<span class="hljs-type">Shape</span> <span class="hljs-variable">shape</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Red</span>(), <span class="hljs-number">5.0</span>);
<span class="hljs-comment">// åç»­å¯ä»¥æ”¹ä¸ºè“è‰²</span>
<span class="hljs-comment">// shape.setColor(new Blue());</span>
</code></pre>
<h4 data-id="heading-18">6.2 ç¼ºç‚¹</h4>
<p><strong>1. å¢åŠ ç³»ç»Ÿå¤æ‚åº¦</strong></p>
<pre><code class="hljs">éœ€è¦ç†è§£æŠ½è±¡å’Œå®ç°çš„åˆ†ç¦»
å¼•å…¥æ›´å¤šçš„ç±»å’Œæ¥å£
</code></pre>
<p><strong>2. è®¾è®¡éš¾åº¦å¢åŠ </strong></p>
<pre><code class="hljs">éœ€è¦æ­£ç¡®è¯†åˆ«ç³»ç»Ÿä¸­çš„ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–ç»´åº¦
éœ€è¦åˆç†åˆ’åˆ†æŠ½è±¡å’Œå®ç°
</code></pre>
<p><strong>3. ä¸é€‚åˆç®€å•ç³»ç»Ÿ</strong></p>
<pre><code class="hljs">å¦‚æœåªæœ‰ä¸€ä¸ªç»´åº¦å˜åŒ–
ä½¿ç”¨æ¡¥æ¥æ¨¡å¼åè€Œå¢åŠ å¤æ‚åº¦
</code></pre>
<h3 data-id="heading-19">ä¸ƒã€æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-20">7.1 è¯†åˆ«ç‹¬ç«‹å˜åŒ–çš„ç»´åº¦</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * åˆ¤æ–­æ˜¯å¦éœ€è¦æ¡¥æ¥æ¨¡å¼çš„æ ‡å‡†ï¼š
 * 1. æ˜¯å¦æœ‰ä¸¤ä¸ªæˆ–å¤šä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Ÿ
 * 2. è¿™äº›ç»´åº¦æ˜¯å¦éœ€è¦ç‹¬ç«‹æ‰©å±•ï¼Ÿ
 * 3. è¿™äº›ç»´åº¦çš„ç»„åˆæ˜¯å¦ä¼šå¯¼è‡´ç±»çˆ†ç‚¸ï¼Ÿ
 */</span>

<span class="hljs-comment">// ç¤ºä¾‹ï¼šæŠ¥è¡¨ç³»ç»Ÿ</span>
<span class="hljs-comment">// ç»´åº¦1ï¼šæŠ¥è¡¨ç±»å‹ï¼ˆé”€å”®æŠ¥è¡¨ã€åº“å­˜æŠ¥è¡¨ã€è´¢åŠ¡æŠ¥è¡¨ï¼‰</span>
<span class="hljs-comment">// ç»´åº¦2ï¼šè¾“å‡ºæ ¼å¼ï¼ˆPDFã€Excelã€HTMLï¼‰</span>

<span class="hljs-comment">// å®ç°æ¥å£ï¼šæŠ¥è¡¨æ ¼å¼</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ReportFormatter</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">format</span><span class="hljs-params">(String data)</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">PdfFormatter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ReportFormatter</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">format</span><span class="hljs-params">(String data)</span> {
        System.out.println(<span class="hljs-string">"ç”ŸæˆPDFæ ¼å¼: "</span> + data);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ExcelFormatter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ReportFormatter</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">format</span><span class="hljs-params">(String data)</span> {
        System.out.println(<span class="hljs-string">"ç”ŸæˆExcelæ ¼å¼: "</span> + data);
    }
}

<span class="hljs-comment">// æŠ½è±¡æŠ¥è¡¨</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Report</span> {
    <span class="hljs-keyword">protected</span> ReportFormatter formatter;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Report</span><span class="hljs-params">(ReportFormatter formatter)</span> {
        <span class="hljs-built_in">this</span>.formatter = formatter;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">generate</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SalesReport</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Report</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SalesReport</span><span class="hljs-params">(ReportFormatter formatter)</span> {
        <span class="hljs-built_in">super</span>(formatter);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">generate</span><span class="hljs-params">()</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> <span class="hljs-string">"é”€å”®æ•°æ®..."</span>;
        formatter.format(data);
    }
}
</code></pre>
<h4 data-id="heading-21">7.2 åˆç†è®¾è®¡æŠ½è±¡å±‚æ¬¡</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æŠ½è±¡å±‚æ¬¡è®¾è®¡åŸåˆ™ï¼š
 * 1. æŠ½è±¡éƒ¨åˆ†å®šä¹‰ä¸šåŠ¡é€»è¾‘
 * 2. å®ç°éƒ¨åˆ†å®šä¹‰å¹³å°/æŠ€æœ¯ç»†èŠ‚
 * 3. é€šè¿‡æ¥å£è¿æ¥ä¸¤è€…
 */</span>

<span class="hljs-comment">// å¥½çš„è®¾è®¡</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PaymentMethod</span> {  <span class="hljs-comment">// æŠ½è±¡ï¼šæ”¯ä»˜æ–¹å¼</span>
    <span class="hljs-keyword">protected</span> PaymentGateway gateway;  <span class="hljs-comment">// å®ç°ï¼šæ”¯ä»˜ç½‘å…³</span>

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pay</span><span class="hljs-params">(<span class="hljs-type">double</span> amount)</span> {
        <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span>
        gateway.processPayment(amount);
    }
}

<span class="hljs-comment">// ä¸å¥½çš„è®¾è®¡ï¼šæ··åˆä¸šåŠ¡å’ŒæŠ€æœ¯ç»†èŠ‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AlipayPayment</span> {  <span class="hljs-comment">// æ—¢åŒ…å«æ”¯ä»˜æ–¹å¼ï¼ŒåˆåŒ…å«å…·ä½“å®ç°</span>
    <span class="hljs-comment">// éš¾ä»¥æ‰©å±•å’Œç»´æŠ¤</span>
}
</code></pre>
<h4 data-id="heading-22">7.3 ä½¿ç”¨ä¾èµ–æ³¨å…¥</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * é€šè¿‡ä¾èµ–æ³¨å…¥è®¾ç½®å®ç°
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageWithDI</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Message</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MessageWithDI</span><span class="hljs-params">(MessageSender sender)</span> {
        <span class="hljs-built_in">super</span>(sender);
    }

    <span class="hljs-comment">// æ”¯æŒè¿è¡Œæ—¶åˆ‡æ¢å®ç°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setSender</span><span class="hljs-params">(MessageSender sender)</span> {
        <span class="hljs-built_in">this</span>.sender = sender;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> String <span class="hljs-title function_">formatContent</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"æ¶ˆæ¯å†…å®¹"</span>;
    }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-comment">/*
MessageWithDI message = new MessageWithDI(new EmailSender());
message.sendMessage("user@example.com");

// åˆ‡æ¢å‘é€æ–¹å¼
message.setSender(new SmsSender());
message.sendMessage("138****8888");
*/</span>
</code></pre>
<h4 data-id="heading-23">7.4 ç»“åˆå·¥å‚æ¨¡å¼</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ä½¿ç”¨å·¥å‚åˆ›å»ºæ¡¥æ¥å¯¹è±¡
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ShapeFactory</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Shape <span class="hljs-title function_">createShape</span><span class="hljs-params">(String shapeType, String colorType)</span> {
        <span class="hljs-type">Color</span> <span class="hljs-variable">color</span> <span class="hljs-operator">=</span> ColorFactory.createColor(colorType);

        <span class="hljs-keyword">switch</span> (shapeType) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">"circle"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(color, <span class="hljs-number">5.0</span>);
            <span class="hljs-keyword">case</span> <span class="hljs-string">"rectangle"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(color, <span class="hljs-number">10.0</span>, <span class="hljs-number">5.0</span>);
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"æœªçŸ¥å½¢çŠ¶ç±»å‹"</span>);
        }
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ColorFactory</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Color <span class="hljs-title function_">createColor</span><span class="hljs-params">(String colorType)</span> {
        <span class="hljs-keyword">switch</span> (colorType) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">"red"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Red</span>();
            <span class="hljs-keyword">case</span> <span class="hljs-string">"blue"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blue</span>();
            <span class="hljs-keyword">case</span> <span class="hljs-string">"green"</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Green</span>();
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"æœªçŸ¥é¢œè‰²ç±»å‹"</span>);
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-comment">// Shape shape = ShapeFactory.createShape("circle", "red");</span>
</code></pre>
<h3 data-id="heading-24">å…«ã€æ€»ç»“</h3>
<h4 data-id="heading-25">8.1 æ ¸å¿ƒè¦ç‚¹</h4>
<ol>
<li><strong>æ¡¥æ¥æ¨¡å¼çš„æœ¬è´¨</strong>ï¼šå°†æŠ½è±¡éƒ¨åˆ†ä¸å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ–</li>
<li><strong>ä¸¤ä¸ªå…³é”®è§’è‰²</strong>ï¼š
<ul>
<li>æŠ½è±¡éƒ¨åˆ†ï¼šå®šä¹‰é«˜å±‚ä¸šåŠ¡é€»è¾‘</li>
<li>å®ç°éƒ¨åˆ†ï¼šå®šä¹‰åº•å±‚æŠ€æœ¯å®ç°</li>
</ul>
</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š
<ul>
<li>å­˜åœ¨ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦</li>
<li>éœ€è¦é¿å…ç±»çš„çˆ†ç‚¸å¼å¢é•¿</li>
<li>éœ€è¦è¿è¡Œæ—¶åˆ‡æ¢å®ç°</li>
</ul>
</li>
<li><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š
<ul>
<li>åˆ†ç¦»å…³æ³¨ç‚¹</li>
<li>æé«˜å¯æ‰©å±•æ€§</li>
<li>ç¬¦åˆå¼€é—­åŸåˆ™</li>
</ul>
</li>
</ol>
<h4 data-id="heading-26">8.2 ä½¿ç”¨å»ºè®®</h4>
<pre><code class="hljs language-arduino" lang="arduino">é€‰æ‹©æ¡¥æ¥æ¨¡å¼çš„æ£€æŸ¥æ¸…å•ï¼š

âœ“ æ˜¯å¦æœ‰ä¸¤ä¸ªæˆ–å¤šä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Ÿ
âœ“ ä½¿ç”¨ç»§æ‰¿æ˜¯å¦å¯¼è‡´ç±»æ•°é‡çˆ†ç‚¸ï¼Ÿ
âœ“ æ˜¯å¦éœ€è¦åœ¨è¿è¡Œæ—¶åˆ‡æ¢å®ç°ï¼Ÿ
âœ“ æŠ½è±¡å’Œå®ç°æ˜¯å¦éœ€è¦ç‹¬ç«‹æ‰©å±•ï¼Ÿ

å¦‚æœæœ‰<span class="hljs-number">2</span>ä¸ªä»¥ä¸Š<span class="hljs-string">"æ˜¯"</span>ï¼Œå»ºè®®ä½¿ç”¨æ¡¥æ¥æ¨¡å¼ï¼
</code></pre>
<h4 data-id="heading-27">8.3 ä¸å…¶ä»–æ¨¡å¼çš„å¯¹æ¯”</h4>
<pre><code class="hljs language-diff" lang="diff">æ¡¥æ¥ vs é€‚é…å™¨ï¼š
<span class="hljs-deletion">- æ¡¥æ¥ï¼šè®¾è®¡æ—¶åˆ†ç¦»æŠ½è±¡å’Œå®ç°</span>
<span class="hljs-deletion">- é€‚é…å™¨ï¼šäº‹åé€‚é…ä¸å…¼å®¹çš„æ¥å£</span>

æ¡¥æ¥ vs ç­–ç•¥ï¼š
<span class="hljs-deletion">- æ¡¥æ¥ï¼šä¸¤ä¸ªç»´åº¦ç‹¬ç«‹å˜åŒ–</span>
<span class="hljs-deletion">- ç­–ç•¥ï¼šä¸€ä¸ªç»´åº¦çš„ç®—æ³•æ›¿æ¢</span>

æ¡¥æ¥ vs æŠ½è±¡å·¥å‚ï¼š
<span class="hljs-deletion">- æ¡¥æ¥ï¼šåˆ†ç¦»æŠ½è±¡å’Œå®ç°</span>
<span class="hljs-deletion">- æŠ½è±¡å·¥å‚ï¼šåˆ›å»ºç›¸å…³å¯¹è±¡å®¶æ—</span>
</code></pre>
<h4 data-id="heading-28">8.4 å®è·µç»éªŒ</h4>
<ol>
<li><strong>è¯†åˆ«ç‹¬ç«‹ç»´åº¦</strong>ï¼šæ‰¾å‡ºç³»ç»Ÿä¸­ç‹¬ç«‹å˜åŒ–çš„ç»´åº¦</li>
<li><strong>åˆç†åˆ’åˆ†èŒè´£</strong>ï¼šæŠ½è±¡è´Ÿè´£ä¸šåŠ¡ï¼Œå®ç°è´Ÿè´£æŠ€æœ¯</li>
<li><strong>ä½¿ç”¨ç»„åˆè€Œéç»§æ‰¿</strong>ï¼šé€šè¿‡ç»„åˆè¿æ¥æŠ½è±¡å’Œå®ç°</li>
<li><strong>ä¿æŒæ¥å£ç®€å•</strong>ï¼šå®ç°æ¥å£åº”è¯¥ç®€æ´æ˜äº†</li>
<li><strong>ç»“åˆå…¶ä»–æ¨¡å¼</strong>ï¼šå¯ä»¥ä¸å·¥å‚ã€ç­–ç•¥ç­‰æ¨¡å¼ç»“åˆä½¿ç”¨</li>
</ol>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å†·é™çœ‹ dynamic-tpï¼šèŠèŠæŠ€æœ¯é€‰å‹ä¸­çš„åœºæ™¯åŒ¹é…é—®é¢˜]]></title>    <link>https://juejin.cn/post/7578699866182598694</link>    <guid>https://juejin.cn/post/7578699866182598694</guid>    <pubDate>2025-12-02T01:03:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578699866182598694" data-draft-id="7578719771589328906" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å†·é™çœ‹ dynamic-tpï¼šèŠèŠæŠ€æœ¯é€‰å‹ä¸­çš„åœºæ™¯åŒ¹é…é—®é¢˜"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-02T01:03:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å†·é™çœ‹ dynamic-tpï¼šèŠèŠæŠ€æœ¯é€‰å‹ä¸­çš„åœºæ™¯åŒ¹é…é—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T01:03:19.000Z" title="Tue Dec 02 2025 01:03:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å†·é™çœ‹ dynamic-tpï¼šèŠèŠæŠ€æœ¯é€‰å‹ä¸­çš„åœºæ™¯åŒ¹é…é—®é¢˜</h2>
<h3 data-id="heading-1">å‰è¨€</h3>
<p>æœ€è¿‘èŠ±æ—¶é—´çœ‹äº† dynamic-tp çš„æºç å’Œæ–‡æ¡£ã€‚è¿™æ˜¯ä¸€ä¸ªå®Œæˆåº¦å¾ˆé«˜çš„é¡¹ç›®ï¼Œæ–‡æ¡£è¯¦å°½ï¼ŒåŠŸèƒ½å®Œå–„ï¼Œç¤¾åŒºä¹Ÿå¾ˆæ´»è·ƒã€‚èƒ½çœ‹å‡ºä½œè€…åœ¨è¿™ä¸ªé¢†åŸŸæ·±è€•äº†å¾ˆä¹…ã€‚</p>
<p>ä½†çœ‹å®Œä¹‹åï¼Œæˆ‘æœ‰ä¸€äº›ä¸åŒçš„æ€è€ƒï¼Œæƒ³å’Œå¤§å®¶èŠèŠã€‚</p>
<p>è¿™ç¯‡æ–‡ç« ä¸æ˜¯è¦å¦å®šè¿™ä¸ªé¡¹ç›®ï¼Œdynamic-tpæ¯«æ— äº‰è®®æ˜¯ä¸€ä¸ªä¼˜ç§€çš„çº¿ç¨‹æ¡†æ¶ï¼Œæˆ‘æ˜¯æƒ³å€Ÿå®ƒè®¨è®ºä¸€ä¸ªæ›´æ™®éçš„é—®é¢˜ï¼š<strong>çƒ­é—¨å¼€æºé¡¹ç›®ï¼Œæ˜¯å¦çœŸçš„é€‚åˆä½ çš„åœºæ™¯ï¼Ÿ</strong></p>
<h3 data-id="heading-2">dynamic-tp åšäº†ä»€ä¹ˆ</h3>
<p>å…ˆå®¢è§‚æ¢³ç†å®ƒçš„ä¸»è¦èƒ½åŠ›ï¼š</p>
<ul>
<li>çº¿ç¨‹æ± å‚æ•°åŠ¨æ€é…ç½®ï¼ˆå¯¹æ¥ Nacosã€Apollo ç­‰é…ç½®ä¸­å¿ƒï¼‰</li>
<li>ç›‘æ§æŒ‡æ ‡é‡‡é›†å’Œå¯è§†åŒ–</li>
<li>å‘Šè­¦é€šçŸ¥ï¼ˆé˜Ÿåˆ—ç§¯å‹ã€æ‹’ç»ç­–ç•¥è§¦å‘ç­‰ï¼‰</li>
<li>æ‰©å±•é˜Ÿåˆ—ç±»å‹ã€æ‹’ç»ç­–ç•¥ã€è¶…æ—¶æ§åˆ¶</li>
<li>ä»»åŠ¡ä¼˜å…ˆçº§ã€å–æ¶ˆæœºåˆ¶</li>
</ul>
<p>è¿™äº›åŠŸèƒ½å¯¹äºéœ€è¦ç²¾ç»†åŒ–ç®¡ç†çº¿ç¨‹æ± çš„å›¢é˜Ÿæ¥è¯´ï¼Œç¡®å®æä¾›äº†ä¸€ä¸ªå¼€ç®±å³ç”¨çš„æ–¹æ¡ˆï¼Œçœå»äº†è‡ªå·±é€ è½®å­çš„æˆæœ¬ã€‚</p>
<p>ä½†æˆ‘æƒ³æå‡ºä¸€ä¸ªé—®é¢˜ä¾›å¤§å®¶æ€è€ƒï¼š</p>
<p><strong>ä½ çš„ä¸šåŠ¡åœºæ™¯ï¼ŒçœŸçš„éœ€è¦è¿™ä¹ˆç²¾ç»†çš„çº¿ç¨‹æ± ç®¡ç†å—ï¼Ÿ</strong></p>
<h3 data-id="heading-3">æˆ‘çš„ä¸€äº›æ€è€ƒï¼šåœºæ™¯åŒ¹é…çš„é‡è¦æ€§</h3>
<p>å¤§å¤šæ•° 2B ä¸šåŠ¡ç³»ç»Ÿï¼Œé™¤éæ˜¯çˆ¬è™«ã€æ•°æ®å¤„ç†ã€é«˜å¹¶å‘ç½‘å…³è¿™ç±»ç‰¹å®šåœºæ™¯ï¼Œçº¿ç¨‹æ± å¾€å¾€ä¸æ˜¯ç³»ç»Ÿç“¶é¢ˆã€‚</p>
<p>ä¸€ä¸ªæ™®é€šä¸šåŠ¡æœåŠ¡çš„çº¿ç¨‹æ± ç®¡ç†ï¼Œå¯èƒ½åªéœ€è¦ï¼š</p>
<ul>
<li>Nacos èƒ½åŠ¨æ€æ”¹é…ç½®</li>
<li>Prometheus + Grafana èƒ½çœ‹åŸºç¡€æŒ‡æ ‡</li>
</ul>
<p>å¯¹äºè¿™ç±»åœºæ™¯ï¼Œå¼•å…¥ä¸€ä¸ªä¸“é—¨çš„çº¿ç¨‹æ± ç®¡ç†æ¡†æ¶ï¼Œå¸¦æ¥çš„æ”¶ç›Šå¯èƒ½å’Œè¿ç»´æˆæœ¬ä¸å¤ªåŒ¹é…ã€‚</p>
<p>è¿™ä¸æ˜¯ dynamic-tp çš„é—®é¢˜ï¼Œè€Œæ˜¯<strong>ä»»ä½•å·¥å…·éƒ½æœ‰å®ƒçš„æœ€ä½³é€‚ç”¨åœºæ™¯</strong>ã€‚</p>
<h3 data-id="heading-4">ä¸€ä¸ªæ›´æ ¹æœ¬çš„é—®é¢˜ï¼šè°ƒå‚çš„å‰ææ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>è¿™æ˜¯æˆ‘æ€è€ƒæ¯”è¾ƒå¤šçš„åœ°æ–¹ã€‚</p>
<p>dynamic-tp æä¾›äº†å¼ºå¤§çš„åŠ¨æ€è°ƒå‚èƒ½åŠ›ï¼Œä½†æœ‰ä¸€ä¸ªå‰ç½®é—®é¢˜ï¼š<strong>ä½ çŸ¥é“è¯¥è°ƒæˆå¤šå°‘å—ï¼Ÿ</strong></p>
<ul>
<li>æ ¸å¿ƒçº¿ç¨‹æ•°è¯¥è®¾ 10 è¿˜æ˜¯ 50ï¼Ÿä¾æ®æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>é˜Ÿåˆ—é•¿åº¦ 100 å’Œ 1000 çš„å·®å¼‚åœ¨å“ªé‡Œï¼Ÿ</li>
<li>å‘Šè­¦é˜ˆå€¼è®¾å¤šå°‘ç®—åˆç†ï¼Ÿ</li>
</ul>
<p>è¦å›ç­”è¿™äº›é—®é¢˜ï¼Œéœ€è¦ï¼š</p>
<ul>
<li>å®Œå–„çš„å‹æµ‹ç¯å¢ƒå’ŒåŸºå‡†æ•°æ®</li>
<li>å¯¹ CPU åˆ©ç”¨ç‡ã€IO ç­‰å¾…ã€ä¸Šä¸‹æ–‡åˆ‡æ¢ç­‰æŒ‡æ ‡çš„ç†è§£</li>
<li>ä¼šç”¨ topã€pidstatã€straceã€ç«ç„°å›¾ç­‰å·¥å…·åˆ†æç“¶é¢ˆ</li>
<li>èƒ½æ ¹æ®ä¸šåŠ¡ç‰¹å¾åˆ¶å®šè°ƒå‚ç­–ç•¥</li>
</ul>
<p>è¿™äº›èƒ½åŠ›çš„å»ºè®¾ï¼Œæœ¬èº«å°±æ˜¯ä¸€ä¸ªä¸å°çš„æŠ•å…¥ã€‚</p>
<p>æˆ‘çš„ç–‘é—®æ˜¯ï¼š<strong>å¦‚æœå›¢é˜Ÿå·²ç»å…·å¤‡è¿™äº›èƒ½åŠ›ï¼Œæ˜¯å¦è¿˜éœ€è¦ä¸€ä¸ªä¸“é—¨çš„æ¡†æ¶ï¼Ÿç›´æ¥æ”¹é…ç½®ä¸­å¿ƒã€çœ‹ç›‘æ§æŒ‡æ ‡ï¼Œä¹Ÿèƒ½è¾¾åˆ°ç±»ä¼¼æ•ˆæœã€‚</strong></p>
<p><strong>å¦‚æœå›¢é˜Ÿè¿˜ä¸å…·å¤‡è¿™äº›èƒ½åŠ›ï¼Œé‚£å¼•å…¥æ¡†æ¶ä¹‹åï¼Œè°ƒå‚çš„ä¾æ®ä»å“ªé‡Œæ¥ï¼Ÿ</strong></p>
<p>è¿™ä¸ªé—®é¢˜ä¸æ˜¯é’ˆå¯¹ dynamic-tpï¼Œè€Œæ˜¯é’ˆå¯¹æ‰€æœ‰"åŠ¨æ€è°ƒä¼˜"ç±»å·¥å…·ã€‚å·¥å…·æä¾›äº†"èƒ½è°ƒ"çš„èƒ½åŠ›ï¼Œä½†"ä¼šè°ƒ"éœ€è¦çš„æ˜¯çŸ¥è¯†å’Œç»éªŒçš„ç§¯ç´¯ã€‚</p>
<h3 data-id="heading-5">å…³äºè¿ç»´æˆæœ¬çš„è€ƒé‡</h3>
<p>ä»»ä½•æ–°ç»„ä»¶çš„å¼•å…¥éƒ½æœ‰æˆæœ¬ï¼š</p>
<ul>
<li>å›¢é˜Ÿéœ€è¦å­¦ä¹ æ–°çš„æ¦‚å¿µå’Œé…ç½®æ–¹å¼</li>
<li>é—®é¢˜æ’æŸ¥æ—¶å¤šäº†ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„å› ç´ </li>
<li>ç‰ˆæœ¬å‡çº§å’Œå…¼å®¹æ€§éœ€è¦æŒç»­å…³æ³¨</li>
</ul>
<p>å¦å¤–ï¼Œæµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒå¤©ç„¶å­˜åœ¨å·®å¼‚ã€‚åœ¨æµ‹è¯•ç¯å¢ƒè°ƒä¼˜çš„å‚æ•°ï¼Œä¸Šç”Ÿäº§åå¯èƒ½éœ€è¦é‡æ–°éªŒè¯ã€‚è¿™ä¸ªè¿‡ç¨‹æœ¬èº«å°±éœ€è¦è°¨æ…å¯¹å¾…ã€‚</p>
<p>è¿™äº›æˆæœ¬ä¸æ˜¯ä¸èƒ½æ¥å—ï¼Œä½†éœ€è¦å’Œæ”¶ç›Šæ”¾åœ¨ä¸€èµ·æƒè¡¡ã€‚</p>
<h3 data-id="heading-6">ä»€ä¹ˆåœºæ™¯ä¸‹å®ƒçš„ä»·å€¼æ›´æ˜æ˜¾ï¼Ÿ</h3>
<p>æˆ‘è®¤ä¸º dynamic-tp åœ¨ä»¥ä¸‹åœºæ™¯ä¸‹ä»·å€¼æ›´çªå‡ºï¼š</p>
<ul>
<li><strong>è¶…å¤§è§„æ¨¡å¾®æœåŠ¡æ¶æ„</strong>ï¼šå‡ ç™¾ä¸ªæœåŠ¡ã€ä¸Šåƒä¸ªçº¿ç¨‹æ± ï¼Œéœ€è¦ç»Ÿä¸€ç®¡æ§</li>
<li><strong>CPU å¯†é›†å‹ä¸šåŠ¡</strong>ï¼šçº¿ç¨‹æ± ç¡®å®æ˜¯æ€§èƒ½ç“¶é¢ˆï¼Œéœ€è¦ç²¾ç»†è°ƒä¼˜</li>
<li><strong>æœ‰ä¸“ä¸šä¸­é—´ä»¶å›¢é˜Ÿ</strong>ï¼šèƒ½å¤ŸæŒç»­è¿è¥å’Œè°ƒä¼˜</li>
<li><strong>æœ‰å®Œå–„çš„å‹æµ‹ä½“ç³»</strong>ï¼šèƒ½å¤Ÿäº§å‡ºè°ƒå‚çš„åŸºå‡†æ•°æ®</li>
</ul>
<p>ç¾å›¢è¿™ç±»å¤§å‚ï¼Œå…·å¤‡è¿™äº›æ¡ä»¶ï¼Œæ‰€ä»¥ dynamic-tp åœ¨ä»–ä»¬çš„åœºæ™¯ä¸‹æ˜¯åˆç†çš„é€‰æ‹©ã€‚</p>
<p>ä½†å¯¹äºå¤§å¤šæ•°ä¸­å°å›¢é˜Ÿï¼Œå¯èƒ½éœ€è¦å…ˆè¯„ä¼°ä¸€ä¸‹è‡ªå·±æ˜¯å¦å¤„äºè¿™ä¸ªé˜¶æ®µã€‚</p>
<h3 data-id="heading-7">æˆ‘çš„é€‰æ‹©</h3>
<p>åŸºäºä»¥ä¸Šæ€è€ƒï¼Œæˆ‘ä¸ªäººé€‰æ‹©æš‚æ—¶ä¸æ·±å…¥ç ”ç©¶ dynamic-tpã€‚</p>
<p>è¿™ä¸æ˜¯å› ä¸ºå®ƒä¸å¥½ï¼Œè€Œæ˜¯å› ä¸º<strong>åœ¨æˆ‘å½“å‰é¢å¯¹çš„åœºæ™¯ä¸‹ï¼ŒæŠ•å…¥äº§å‡ºæ¯”å¯èƒ½ä¸å¤ªåˆ’ç®—</strong>ã€‚</p>
<p>æˆ‘æ›´å€¾å‘äºæŠŠç²¾åŠ›æ”¾åœ¨ï¼š</p>
<ul>
<li>ç†è§£çº¿ç¨‹æ± çš„æ ¸å¿ƒåŸç†</li>
<li>æŒæ¡æ€§èƒ½åˆ†æçš„åŸºæœ¬æ–¹æ³•</li>
<li>åœ¨ç®€å•æ–¹æ¡ˆèƒ½è§£å†³é—®é¢˜æ—¶ï¼Œä¸è¿‡åº¦è®¾è®¡</li>
</ul>
<h3 data-id="heading-8">å†™åœ¨æœ€å</h3>
<p>å¼€æºé¡¹ç›®çš„ä»·å€¼æ˜¯å®¢è§‚å­˜åœ¨çš„ã€‚dynamic-tp çš„ä½œè€…å’Œç¤¾åŒºä»˜å‡ºäº†å¤§é‡å¿ƒè¡€ï¼Œä¸ºæœ‰éœ€è¦çš„å›¢é˜Ÿæä¾›äº†ä¸€ä¸ªæˆç†Ÿçš„æ–¹æ¡ˆï¼Œè¿™å€¼å¾—å°Šé‡ã€‚</p>
<p>æˆ‘åªæ˜¯æƒ³åˆ†äº«ä¸€ä¸ªè§‚ç‚¹ï¼š<strong>æŠ€æœ¯é€‰å‹çš„æ ¸å¿ƒä¸æ˜¯"è¿™ä¸ªå·¥å…·å¥½ä¸å¥½"ï¼Œè€Œæ˜¯"è¿™ä¸ªå·¥å…·é€‚ä¸é€‚åˆæˆ‘"</strong>ã€‚</p>
<p>åŒæ ·çš„å·¥å…·ï¼Œåœ¨ A å…¬å¸æ˜¯ç¥å™¨ï¼Œåœ¨ B å…¬å¸å¯èƒ½æ˜¯è´Ÿæ‹…ã€‚å·®å¼‚ä¸åœ¨å·¥å…·æœ¬èº«ï¼Œè€Œåœ¨åœºæ™¯çš„åŒ¹é…ç¨‹åº¦ã€‚</p>
<p>åœ¨è·Ÿé£ä¹‹å‰ï¼Œå…ˆæƒ³æ¸…æ¥šè‡ªå·±çš„éœ€æ±‚å’Œèƒ½åŠ›è¾¹ç•Œï¼Œä¹Ÿè®¸æ˜¯æ›´åŠ¡å®çš„åšæ³•ã€‚</p>
<hr/>
<p><em>ä»¥ä¸Šæ˜¯æˆ‘çš„ä¸ªäººæ€è€ƒï¼Œæ¬¢è¿ä¸åŒæ„è§çš„è®¨è®ºã€‚æŠ€æœ¯ç¤¾åŒºçš„ä»·å€¼ï¼Œå°±åœ¨äºä¸åŒè§‚ç‚¹çš„ç¢°æ’ã€‚</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[C# åŸå§‹å­—ç¬¦ä¸²å­—é¢é‡å…¨é¢è§£æï¼šå¤šè¡Œå­—ç¬¦ä¸²ç»ˆäºä¼˜é›…äº†ï¼]]></title>    <link>https://juejin.cn/post/7578699975414480896</link>    <guid>https://juejin.cn/post/7578699975414480896</guid>    <pubDate>2025-12-02T00:05:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578699975414480896" data-draft-id="7578714759337656320" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="C# åŸå§‹å­—ç¬¦ä¸²å­—é¢é‡å…¨é¢è§£æï¼šå¤šè¡Œå­—ç¬¦ä¸²ç»ˆäºä¼˜é›…äº†ï¼"/> <meta itemprop="keywords" content="C#,.NET"/> <meta itemprop="datePublished" content="2025-12-02T00:05:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å”é’æ«"/> <meta itemprop="url" content="https://juejin.cn/user/3737995266234280"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            C# åŸå§‹å­—ç¬¦ä¸²å­—é¢é‡å…¨é¢è§£æï¼šå¤šè¡Œå­—ç¬¦ä¸²ç»ˆäºä¼˜é›…äº†ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3737995266234280/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å”é’æ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T00:05:15.000Z" title="Tue Dec 02 2025 00:05:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ç®€ä»‹</h3>
<p><code>C# 11</code> å¼•å…¥äº†åŸå§‹å­—ç¬¦ä¸²å­—é¢é‡ï¼ˆ<code>Raw String Literals</code>ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªé©å‘½æ€§çš„ç‰¹æ€§ï¼Œæå¤§åœ°ç®€åŒ–äº†åŒ…å«å¤§é‡ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚å¼•å·ã€åæ–œæ ã€æ¢è¡Œç¬¦ç­‰ï¼‰çš„å­—ç¬¦ä¸²å¤„ç†ã€‚</p>
<p>åŸå§‹å­—ç¬¦ä¸²å­—é¢é‡å…è®¸åˆ›å»ºåŒ…å«ä»»æ„æ–‡æœ¬çš„å­—ç¬¦ä¸²ï¼Œè€Œæ— éœ€è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ã€‚å®ƒä»¬ä»¥è‡³å°‘ä¸‰ä¸ªåŒå¼•å· <code>"""</code> å¼€å§‹å’Œç»“æŸï¼Œå¹¶ä¸”å¯ä»¥è·¨è¶Šå¤šè¡Œã€‚</p>
<h3 data-id="heading-1">æ ¸å¿ƒç‰¹æ€§ä¸ä¼˜åŠ¿</h3>
<h4 data-id="heading-2">æ ¸å¿ƒç‰¹ç‚¹</h4>
<ul>
<li>
<p>æ— è½¬ä¹‰éœ€æ±‚ï¼šä¸éœ€è¦å¯¹å¼•å·ã€åæ–œæ ç­‰ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰</p>
</li>
<li>
<p>å¤šè¡Œæ”¯æŒï¼šåŸç”Ÿæ”¯æŒå¤šè¡Œå­—ç¬¦ä¸²æ ¼å¼</p>
</li>
<li>
<p>ç©ºç™½ä¿ç•™ï¼šç²¾ç¡®ä¿ç•™æºä»£ç ä¸­çš„ç¼©è¿›å’Œæ ¼å¼åŒ–</p>
</li>
<li>
<p>çµæ´»åˆ†éš”ç¬¦ï¼šä½¿ç”¨å¯å˜æ•°é‡çš„åŒå¼•å·ä½œä¸ºåˆ†éš”ç¬¦</p>
</li>
<li>
<p>å­—ç¬¦ä¸²æ’å€¼ï¼šå¯ä¸æ’å€¼è¯­æ³•æ— ç¼ç»“åˆ</p>
</li>
</ul>
<h4 data-id="heading-3">ä¸ä¼ ç»Ÿå­—ç¬¦ä¸²å¯¹æ¯”</h4>









































<table><thead><tr><th>ç‰¹æ€§</th><th>å¸¸è§„å­—ç¬¦ä¸²</th><th>é€å­—å­—ç¬¦ä¸²(@)</th><th>åŸå§‹å­—ç¬¦ä¸²å­—é¢é‡</th></tr></thead><tbody><tr><td>è½¬ä¹‰éœ€æ±‚</td><td>éœ€è¦è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦</td><td>ä¸éœ€è¦è½¬ä¹‰ï¼Œä½†å¯¹åŒå¼•å·ä»éœ€è½¬ä¹‰</td><td>å®Œå…¨ä¸éœ€è¦è½¬ä¹‰</td></tr><tr><td>å¤šè¡Œæ”¯æŒ</td><td>éœ€ä½¿ç”¨<code>\n</code>ç­‰</td><td>æ”¯æŒ</td><td>åŸç”Ÿæ”¯æŒ</td></tr><tr><td>ç¼©è¿›ä¿ç•™</td><td>ä¸ä¿ç•™</td><td>ä¿ç•™æ‰€æœ‰ç¼©è¿›</td><td>æ™ºèƒ½ç¼©è¿›å¤„ç†</td></tr><tr><td>å¼•å·å¤„ç†</td><td><code>\"</code></td><td><code>""</code></td><td>ç›´æ¥ä½¿ç”¨</td></tr><tr><td>JSON/XML</td><td>å¯è¯»æ€§å·®</td><td>å¯è¯»æ€§ä¸­ç­‰</td><td>å®Œç¾å‘ˆç°</td></tr></tbody></table>
<h3 data-id="heading-4">åŸºæœ¬è¯­æ³•</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// åŸºæœ¬åŸå§‹å­—ç¬¦ä¸²</span>
<span class="hljs-built_in">string</span> basic = <span class="hljs-string">""</span><span class="hljs-string">"è¿™æ˜¯ä¸€ä¸ªåŸå§‹å­—ç¬¦ä¸²ï¼Œä¸éœ€è¦è½¬ä¹‰ "</span>å¼•å·<span class="hljs-string">" å’Œ \åæ–œæ "</span><span class="hljs-string">""</span>;

<span class="hljs-comment">// å¤šè¡ŒåŸå§‹å­—ç¬¦ä¸²</span>
<span class="hljs-built_in">string</span> multiLine = <span class="hljs-string">""</span><span class="hljs-string">"
    è¿™æ˜¯ä¸€ä¸ª
    å¤šè¡ŒåŸå§‹å­—ç¬¦ä¸²
    å¯ä»¥åŒ…å« "</span>å¼•å·<span class="hljs-string">" å’Œ \åæ–œæ 
    "</span><span class="hljs-string">""</span>;

<span class="hljs-comment">// åŒ…å«å¤§æ‹¬å·çš„åŸå§‹å­—ç¬¦ä¸²</span>
<span class="hljs-built_in">string</span> withBraces = <span class="hljs-string">""</span><span class="hljs-string">"
    { "</span>name<span class="hljs-string">": "</span>John<span class="hljs-string">", "</span>age<span class="hljs-string">": 30 }
    "</span><span class="hljs-string">""</span>;
</code></pre>
<h3 data-id="heading-5">æ ¸å¿ƒç‰¹æ€§ä¸ä¼˜åŠ¿</h3>
<h4 data-id="heading-6">æ— éœ€è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// ä¼ ç»Ÿæ–¹å¼ï¼ˆéœ€è¦è½¬ä¹‰ï¼‰</span>
<span class="hljs-built_in">string</span> traditional = <span class="hljs-string">"è¿™æ˜¯ä¸€ä¸ªåŒ…å«\"å¼•å·\"å’Œ\\åæ–œæ çš„å­—ç¬¦ä¸²"</span>;

<span class="hljs-comment">// åŸå§‹å­—ç¬¦ä¸²æ–¹å¼ï¼ˆæ— éœ€è½¬ä¹‰ï¼‰</span>
<span class="hljs-built_in">string</span> raw = <span class="hljs-string">""</span><span class="hljs-string">"è¿™æ˜¯ä¸€ä¸ªåŒ…å«"</span>å¼•å·<span class="hljs-string">"å’Œ\åæ–œæ çš„å­—ç¬¦ä¸²"</span><span class="hljs-string">""</span>;

<span class="hljs-comment">// æ­£åˆ™è¡¨è¾¾å¼ç¤ºä¾‹</span>
<span class="hljs-built_in">string</span> regexPattern = <span class="hljs-string">""</span><span class="hljs-string">"^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$"</span><span class="hljs-string">""</span>;
</code></pre>
<h4 data-id="heading-7">å¤šè¡Œå­—ç¬¦ä¸²å¤„ç†</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// ä¼ ç»Ÿå¤šè¡Œå­—ç¬¦ä¸²ï¼ˆéœ€è¦è½¬ä¹‰å’Œè¿æ¥ï¼‰</span>
<span class="hljs-built_in">string</span> oldMultiLine = <span class="hljs-string">"ç¬¬ä¸€è¡Œ\n"</span> +
                     <span class="hljs-string">"ç¬¬äºŒè¡Œ\n"</span> +
                     <span class="hljs-string">"ç¬¬ä¸‰è¡Œ"</span>;

<span class="hljs-comment">// åŸå§‹å¤šè¡Œå­—ç¬¦ä¸²ï¼ˆæ›´ç®€æ´ï¼‰</span>
<span class="hljs-built_in">string</span> newMultiLine = <span class="hljs-string">""</span><span class="hljs-string">"
    ç¬¬ä¸€è¡Œ
    ç¬¬äºŒè¡Œ
    ç¬¬ä¸‰è¡Œ
    "</span><span class="hljs-string">""</span>;

<span class="hljs-comment">// JSON ç¤ºä¾‹</span>
<span class="hljs-built_in">string</span> json = <span class="hljs-string">""</span><span class="hljs-string">"
    {
        "</span>name<span class="hljs-string">": "</span>John Doe<span class="hljs-string">",
        "</span>age<span class="hljs-string">": 30,
        "</span>email<span class="hljs-string">": "</span>john@example.com<span class="hljs-string">"
    }
    "</span><span class="hljs-string">""</span>;
</code></pre>
<h4 data-id="heading-8">ç¼©è¿›å¤„ç†</h4>
<p>åŸå§‹å­—ç¬¦ä¸²å­—é¢é‡ä¼šè‡ªåŠ¨å¤„ç†ç¼©è¿›ï¼Œä½¿ä»£ç ä¿æŒæ•´æ´ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">GetFormattedMessage</span>()</span>
{
    <span class="hljs-keyword">return</span> <span class="hljs-string">""</span><span class="hljs-string">"
        Hello,
            This is an indented message.
        It preserves the formatting exactly as written.
        "</span><span class="hljs-string">""</span>;
}

<span class="hljs-comment">// è¾“å‡ºç»“æœï¼š</span>
<span class="hljs-comment">// Hello,</span>
<span class="hljs-comment">//     This is an indented message.</span>
<span class="hljs-comment">// It preserves the formatting exactly as written.</span>
</code></pre>
<h4 data-id="heading-9">å¼•å·æ•°é‡è§„åˆ™</h4>
<p>å½“å­—ç¬¦ä¸²å†…å®¹åŒ…å«ä¸‰ä¸ªæˆ–æ›´å¤šè¿ç»­åŒå¼•å·æ—¶ï¼Œéœ€è¦ä½¿ç”¨æ›´å¤šå¼•å·ä½œä¸ºåˆ†éš”ç¬¦ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// å†…å®¹åŒ…å«ä¸‰ä¸ªåŒå¼•å· â†’ ä½¿ç”¨å››ä¸ªä½œä¸ºåˆ†éš”ç¬¦</span>
<span class="hljs-built_in">string</span> tripleQuotes = <span class="hljs-string">""</span><span class="hljs-string">""</span> è¿™é‡Œå¯ä»¥åŒ…å« <span class="hljs-string">""</span><span class="hljs-string">" ä¸‰ä¸ªå¼•å· "</span><span class="hljs-string">""</span><span class="hljs-string">";

// å†…å®¹åŒ…å«å››ä¸ªåŒå¼•å· â†’ ä½¿ç”¨äº”ä¸ªä½œä¸ºåˆ†éš”ç¬¦
string fourQuotes = "</span><span class="hljs-string">""</span><span class="hljs-string">""</span> è¿™é‡Œå¯ä»¥åŒ…å« <span class="hljs-string">""</span><span class="hljs-string">""</span> å››ä¸ªå¼•å· <span class="hljs-string">""</span><span class="hljs-string">""</span><span class="hljs-string">";
</span></code></pre>
<p>å¼•å·æ•°é‡é€‰æ‹©åŸåˆ™</p>
<ul>
<li>
<p>åˆ†éš”ç¬¦çš„åŒå¼•å·æ•°é‡(N)å¿…é¡»å¤§äºå†…å®¹ä¸­è¿ç»­åŒå¼•å·çš„æœ€å¤§æ•°é‡(M)</p>
</li>
<li>
<p>æœ€å°åˆ†éš”ç¬¦æ•°é‡ä¸º3ï¼ˆå³ä½¿å†…å®¹æ²¡æœ‰ä¸‰ä¸ªå¼•å·ï¼‰</p>
</li>
<li>
<p>å…¬å¼ï¼š<code>N &gt; M</code></p>
</li>
</ul>
<h4 data-id="heading-10">å¤š$ç¬¦å·è§„åˆ™</h4>
<ul>
<li>
<p><code>$</code> çš„æ•°é‡å†³å®šäº†æ’å€¼è¡¨è¾¾å¼çš„è¾¹ç•Œ</p>
</li>
<li>
<p>ä¸€ä¸ª <code>$</code> â†’ è¡¨è¾¾å¼ä½¿ç”¨ <code>{ }</code></p>
</li>
<li>
<p>ä¸¤ä¸ª <code>$$</code> â†’ è¡¨è¾¾å¼ä½¿ç”¨ <code>{{ }}</code>ï¼Œä»¥æ­¤ç±»æ¨</p>
</li>
</ul>
<h3 data-id="heading-11">é«˜çº§ç”¨æ³•ä¸æŠ€å·§</h3>
<h4 data-id="heading-12">åŒ…å«æ›´å¤šå¼•å·</h4>
<p>å¦‚æœéœ€è¦å­—ç¬¦ä¸²ä¸­åŒ…å«ä¸‰ä¸ªæˆ–æ›´å¤šè¿ç»­åŒå¼•å·ï¼Œå¯ä»¥ä½¿ç”¨æ›´å¤šå¼•å·ä½œä¸ºåˆ†éš”ç¬¦ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// ä½¿ç”¨å››ä¸ªå¼•å·ä½œä¸ºåˆ†éš”ç¬¦ï¼Œä»¥åŒ…å«ä¸‰ä¸ªå¼•å·</span>
<span class="hljs-built_in">string</span> withTripleQuotes = <span class="hljs-string">""</span><span class="hljs-string">""</span>
    è¿™ä¸ªå­—ç¬¦ä¸²åŒ…å«ä¸‰ä¸ªè¿ç»­å¼•å·: <span class="hljs-string">""</span><span class="hljs-string">"
    "</span><span class="hljs-string">""</span><span class="hljs-string">";

// ä½¿ç”¨äº”ä¸ªå¼•å·ä½œä¸ºåˆ†éš”ç¬¦ï¼Œä»¥åŒ…å«å››ä¸ªå¼•å·
string withFourQuotes = "</span><span class="hljs-string">""</span><span class="hljs-string">""</span>
    è¿™ä¸ªå­—ç¬¦ä¸²åŒ…å«å››ä¸ªè¿ç»­å¼•å·: <span class="hljs-string">""</span><span class="hljs-string">""</span>
    <span class="hljs-string">""</span><span class="hljs-string">""</span><span class="hljs-string">";
</span></code></pre>
<h4 data-id="heading-13">ä¸å­—ç¬¦ä¸²æ’å€¼ç»“åˆä½¿ç”¨</h4>
<p>åŸå§‹å­—ç¬¦ä¸²å¯ä»¥ä¸å­—ç¬¦ä¸²æ’å€¼ç»“åˆä½¿ç”¨ï¼Œæä¾›æ›´å¼ºå¤§çš„åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">string</span> name = <span class="hljs-string">"John"</span>;
<span class="hljs-built_in">int</span> age = <span class="hljs-number">30</span>;

<span class="hljs-comment">// åŸºæœ¬æ’å€¼</span>
<span class="hljs-built_in">string</span> interpolated = $<span class="hljs-string">$""</span><span class="hljs-string">"
    {
        "</span>name<span class="hljs-string">": "</span>{{name}}<span class="hljs-string">",
        "</span>age<span class="hljs-string">": {{age}}
    }
    "</span><span class="hljs-string">""</span>;

<span class="hljs-comment">// å¤æ‚æ’å€¼ï¼ˆä½¿ç”¨å¤šä¸ª$ç¬¦å·ï¼‰</span>
<span class="hljs-built_in">string</span> complex = $$<span class="hljs-string">$""</span><span class="hljs-string">"
    {
        "</span>name<span class="hljs-string">": "</span>{{{name}}}<span class="hljs-string">",  // æ³¨æ„ï¼šè¿™é‡Œéœ€è¦ä¸‰ä¸ªå¤§æ‹¬å·
        "</span>age<span class="hljs-string">": {{age}}
    }
    "</span><span class="hljs-string">""</span>;
</code></pre>
<h4 data-id="heading-14">æœ€å°åŒ–ç¼©è¿›</h4>
<p>åŸå§‹å­—ç¬¦ä¸²ä¼šè‡ªåŠ¨å»é™¤ä¸ç»“æŸå¼•å·å¯¹é½çš„ç¼©è¿›ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">string</span> minimalIndent = <span class="hljs-string">""</span><span class="hljs-string">"
    First line
    Second line
    Third line
    "</span><span class="hljs-string">""</span>; <span class="hljs-comment">// ç»“æŸå¼•å·çš„ç¼©è¿›å†³å®šäº†æœ€å°ç¼©è¿›</span>

<span class="hljs-comment">// ç­‰æ•ˆäºï¼š</span>
<span class="hljs-comment">// "First line\nSecond line\nThird line"</span>
</code></pre>
<h3 data-id="heading-15">å®é™…åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-16">JSON å’Œ XML å¤„ç†</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// JSON é…ç½®</span>
<span class="hljs-built_in">string</span> configJson = <span class="hljs-string">""</span><span class="hljs-string">"
    {
        "</span>appSettings<span class="hljs-string">": {
            "</span>timeout<span class="hljs-string">": 30,
            "</span>retryCount<span class="hljs-string">": 3,
            "</span>apiUrl<span class="hljs-string">": "</span>https:<span class="hljs-comment">//api.example.com"</span>
        },
        <span class="hljs-string">"logging"</span>: {
            <span class="hljs-string">"level"</span>: <span class="hljs-string">"Information"</span>,
            <span class="hljs-string">"filePath"</span>: <span class="hljs-string">"logs/app.log"</span>
        }
    }
    <span class="hljs-string">""</span><span class="hljs-string">";

// XML æ–‡æ¡£
string xmlDocument = "</span><span class="hljs-string">""</span>
    &lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;
    &lt;catalog&gt;
        &lt;book id=<span class="hljs-string">"bk101"</span>&gt;
            &lt;author&gt;Gambardella, Matthew&lt;/author&gt;
            &lt;title&gt;XML Developer<span class="hljs-string">'s Guide&lt;/title&gt;
            &lt;genre&gt;Computer&lt;/genre&gt;
            &lt;price&gt;44.95&lt;/price&gt;
            &lt;publish_date&gt;2000-10-01&lt;/publish_date&gt;
            &lt;description&gt;An in-depth look at creating applications with XML.&lt;/description&gt;
        &lt;/book&gt;
    &lt;/catalog&gt;
    """;
</span></code></pre>
<h4 data-id="heading-17">æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// å¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼ï¼ˆæ— éœ€è½¬ä¹‰åæ–œæ ï¼‰</span>
<span class="hljs-built_in">string</span> emailPattern = <span class="hljs-string">""</span><span class="hljs-string">"^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$"</span><span class="hljs-string">""</span>;
<span class="hljs-built_in">string</span> phonePattern = <span class="hljs-string">""</span><span class="hljs-string">"^(\+\d{1,3}\s?)?(\(\d{1,4}\)\s?)?\d{1,4}[\s.-]?\d{1,4}[\s.-]?\d{1,9}$"</span><span class="hljs-string">""</span>;

<span class="hljs-comment">// ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼</span>
<span class="hljs-built_in">bool</span> isValidEmail = Regex.IsMatch(<span class="hljs-string">"test@example.com"</span>, emailPattern);
</code></pre>
<h4 data-id="heading-18">SQL æŸ¥è¯¢</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">string</span> sqlQuery = <span class="hljs-string">""</span><span class="hljs-string">"
    SELECT 
        u.Id,
        u.Name,
        u.Email,
        COUNT(o.Id) AS OrderCount
    FROM Users u
    LEFT JOIN Orders o ON u.Id = o.UserId
    WHERE u.IsActive = 1
    GROUP BY u.Id, u.Name, u.Email
    HAVING COUNT(o.Id) &gt; 0
    ORDER BY OrderCount DESC
    "</span><span class="hljs-string">""</span>;
</code></pre>
<h4 data-id="heading-19">ä»£ç ç”Ÿæˆ</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-built_in">string</span> <span class="hljs-title">GenerateCSharpClass</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> className, IEnumerable&lt;<span class="hljs-built_in">string</span>&gt; properties</span>)</span>
{
    <span class="hljs-keyword">return</span> $<span class="hljs-string">$""</span><span class="hljs-string">"
        public class {{className}}
        {
            {{string.Join("</span>\n    <span class="hljs-string">", properties.Select(p =&gt; $"</span><span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> {p} {{ <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }}<span class="hljs-string">"))}}
            
            public {{className}}()
            {
            }
            
            public override string ToString()
            {
                return $"</span>{{
                    {{<span class="hljs-built_in">string</span>.Join(<span class="hljs-string">", "</span>, properties.Select(p =&gt; <span class="hljs-string">$"<span class="hljs-subst">{p}</span>={{<span class="hljs-subst">{p}</span>}}"</span>))}}
                }}<span class="hljs-string">";
            }
        }
        "</span><span class="hljs-string">""</span>;
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-built_in">string</span> classCode = GenerateCSharpClass(<span class="hljs-string">"Person"</span>, <span class="hljs-keyword">new</span>[] { <span class="hljs-string">"FirstName"</span>, <span class="hljs-string">"LastName"</span>, <span class="hljs-string">"Age"</span> });
</code></pre>
<h3 data-id="heading-20">æ€»ç»“</h3>
<p><code>C# 11</code> çš„åŸå§‹å­—ç¬¦ä¸²å­—é¢é‡æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç‰¹æ€§ï¼Œå®ƒï¼š</p>
<ul>
<li>
<p>æ¶ˆé™¤è½¬ä¹‰éœ€æ±‚ï¼šæ— éœ€è½¬ä¹‰å¼•å·ã€åæ–œæ ç­‰ç‰¹æ®Šå­—ç¬¦</p>
</li>
<li>
<p>æ”¯æŒå¤šè¡Œå†…å®¹ï¼šè½»æ¾åˆ›å»ºå¤šè¡Œå­—ç¬¦ä¸²ï¼Œä¿æŒæ ¼å¼</p>
</li>
<li>
<p>æ™ºèƒ½ç¼©è¿›å¤„ç†ï¼šè‡ªåŠ¨å¤„ç†ç¼©è¿›ï¼Œä½¿ä»£ç æ›´æ•´æ´</p>
</li>
<li>
<p>ä¸æ’å€¼ç»“åˆï¼šæ”¯æŒå­—ç¬¦ä¸²æ’å€¼ï¼Œåˆ›å»ºåŠ¨æ€å†…å®¹</p>
</li>
<li>
<p>ç¼–è¯‘æ—¶å¤„ç†ï¼šæ— è¿è¡Œæ—¶æ€§èƒ½å¼€é”€</p>
</li>
</ul>
<p>é€‚ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>
<p><code>JSON/XML/HTML</code> å†…å®¹ï¼šå¤„ç†ç»“æ„åŒ–æ•°æ®</p>
</li>
<li>
<p>æ­£åˆ™è¡¨è¾¾å¼ï¼šç¼–å†™å¤æ‚çš„æ¨¡å¼åŒ¹é…</p>
</li>
</ul>
<p><code>SQL</code> æŸ¥è¯¢ï¼šç¼–å†™å¤šè¡Œæ•°æ®åº“æŸ¥è¯¢</p>
<ul>
<li>
<p>ä»£ç ç”Ÿæˆï¼šåˆ›å»ºæ¨¡æ¿åŒ–ä»£ç </p>
</li>
<li>
<p>æ–‡æ¡£å­—ç¬¦ä¸²ï¼šç¼–å†™æ ¼å¼åŒ–çš„æ–‡æ¡£</p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥alova3æœåŠ¡ç«¯èƒ½åŠ›ï¼šåˆ†å¸ƒå¼BFFå±‚åˆ°APIç½‘å…³çš„æœ€ä½³å®è·µ]]></title>    <link>https://juejin.cn/post/7578820431018622991</link>    <guid>https://juejin.cn/post/7578820431018622991</guid>    <pubDate>2025-12-02T00:07:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578820431018622991" data-draft-id="7578714735307653146" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥alova3æœåŠ¡ç«¯èƒ½åŠ›ï¼šåˆ†å¸ƒå¼BFFå±‚åˆ°APIç½‘å…³çš„æœ€ä½³å®è·µ"/> <meta itemprop="keywords" content="Node.js,JavaScript,Redis"/> <meta itemprop="datePublished" content="2025-12-02T00:07:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤éŸµ"/> <meta itemprop="url" content="https://juejin.cn/user/1538972010422872"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥alova3æœåŠ¡ç«¯èƒ½åŠ›ï¼šåˆ†å¸ƒå¼BFFå±‚åˆ°APIç½‘å…³çš„æœ€ä½³å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1538972010422872/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤éŸµ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T00:07:14.000Z" title="Tue Dec 02 2025 00:07:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¯èƒ½å¤§å®¶å¯¹alovaè¿˜åœç•™åœ¨è½»é‡åŒ–çš„è¯·æ±‚ç­–ç•¥åº“çš„å±‚é¢ï¼Œè¿™å½“ç„¶æ˜¯alova2çš„æ ¸å¿ƒç‰¹ç‚¹ï¼Œæ¯”å¦‚ä»¥ä¸‹è¿™æ®µ</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> { loading, data, error } = <span class="hljs-title function_">useRequest</span>(<span class="hljs-function">() =&gt;</span> alovaInstance.<span class="hljs-title class_">Get</span>(<span class="hljs-string">'/xxx'</span>))
</code></pre>
<p>è¿™æ˜¯ä¸€æ®µalovaåœ¨å®¢æˆ·ç«¯ä½¿ç”¨çš„å…¸å‹ä»£ç ï¼Œä¸è¿‡ç°åœ¨alovaå·²ç»æ›´æ–°åˆ°3äº†ï¼Œå½“ç„¶è¿™äº›client strategiesä¾ç„¶æ˜¯åŸæ±åŸå‘³çš„ï¼Œä¸è¿‡å®ƒä¸ä»…å±€é™äºå®¢æˆ·ç«¯ï¼Œè€Œæ˜¯åœ¨æœåŠ¡ç«¯ä¹Ÿå¯ä»¥æ¸¸åˆƒæœ‰ä½™äº†ã€‚</p>
<p>åœ¨alova3ä¸­æä¾›äº†æœåŠ¡ç«¯è¯·æ±‚ç­–ç•¥ï¼ˆserver hooksï¼‰å’Œredisã€fileç­‰æœåŠ¡ç«¯çš„å­˜å‚¨é€‚é…å™¨ï¼Œå¯ä»¥è®©æˆ‘ä»¬å¾ˆæ–¹ä¾¿åœ°åœ¨æœåŠ¡ç«¯å®ç°å…¨é“¾è·¯çš„è¯·æ±‚å’Œè½¬å‘ã€‚</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªè¯·æ±‚çš„å…¨æµç¨‹ï¼š</p>
<pre><code class="hljs language-plaintext" lang="plaintext">å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨/Appï¼‰
    â†’ Node.js BFF å±‚ï¼ˆè½¬æ¢æ•°æ®ç­‰ï¼‰
    â†’ API ç½‘å…³ï¼ˆé‰´æƒã€é€Ÿç‡é™åˆ¶ã€è·¯ç”±åˆ†å‘ç­‰ï¼‰
    â†’ åç«¯å¾®æœåŠ¡
</code></pre>
<p>alovaæä¾›çš„server hookå’Œåˆ†å¸ƒå¼çš„å¤šçº§ç¼“å­˜ï¼Œå¯ä»¥è®©æˆ‘ä»¬å¾ˆæ–¹ä¾¿åœ°å®ç°ä»¥ä¸Šçš„å…¨éƒ¨å±‚çº§çš„è¯·æ±‚å¤„ç†ã€‚</p>
<h2 data-id="heading-0">åœ¨BFFå±‚è½¬å‘å®¢æˆ·ç«¯è¯·æ±‚</h2>
<p>åœ¨BFFå±‚ä¸­ç»å¸¸éœ€è¦è½¬å‘å®¢æˆ·ç«¯è¯·æ±‚åˆ°åç«¯å¾®æœåŠ¡ï¼Œä½ å¯ä»¥ä½¿ç”¨é…åˆ<code>async_hooks</code>è®¿é—®æ¯ä¸ªè¯·æ±‚çš„ä¸Šä¸‹æ–‡ï¼Œå¹¶åœ¨alovaçš„<code>beforeRequest</code>ä¸­æ·»åŠ åˆ°è¯·æ±‚ä¸­ï¼Œå®ç°ç”¨æˆ·ç›¸å…³æ•°æ®çš„è½¬å‘ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { createAlova } <span class="hljs-keyword">from</span> <span class="hljs-string">'alova'</span>;
<span class="hljs-keyword">import</span> adapterFetch <span class="hljs-keyword">from</span> <span class="hljs-string">'@alova/fetch'</span>;
<span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncLocalStorage</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'node:async_hooks'</span>;

<span class="hljs-comment">// åˆ›å»ºå¼‚æ­¥æœ¬åœ°å­˜å‚¨å®ä¾‹</span>
<span class="hljs-keyword">const</span> asyncLocalStorage = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AsyncLocalStorage</span>();

<span class="hljs-keyword">const</span> alovaInstance = <span class="hljs-title function_">createAlova</span>({
  <span class="hljs-attr">requestAdapter</span>: <span class="hljs-title function_">adapterFetch</span>(),
  <span class="hljs-title function_">beforeRequest</span>(<span class="hljs-params">method</span>) {
    <span class="hljs-comment">// ä»å¼‚æ­¥ä¸Šä¸‹æ–‡ä¸­è·å–è¯·æ±‚å¤´å¹¶ä¼ é€’åˆ°ä¸‹æ¸¸</span>
    <span class="hljs-keyword">const</span> context = asyncLocalStorage.<span class="hljs-title function_">getStore</span>();
    <span class="hljs-keyword">if</span> (context &amp;&amp; context.<span class="hljs-property">headers</span>) {
      method.<span class="hljs-property">config</span>.<span class="hljs-property">headers</span> = {
        ...method.<span class="hljs-property">config</span>.<span class="hljs-property">headers</span>,
        ...context.<span class="hljs-property">headers</span>
      };
    }
  },
  <span class="hljs-attr">responded</span>: {
    <span class="hljs-title function_">onSuccess</span>(<span class="hljs-params">response</span>) {
      <span class="hljs-comment">// æ•°æ®è½¬æ¢å¤„ç†</span>
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">data</span>: response.<span class="hljs-property">data</span>,
        <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
        <span class="hljs-attr">transformed</span>: <span class="hljs-literal">true</span>
      };
    },
    <span class="hljs-title function_">onError</span>(<span class="hljs-params">error</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Request failed:'</span>, error);
      <span class="hljs-keyword">throw</span> error;
    }
  }
});

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();

<span class="hljs-comment">// ä¸­é—´ä»¶é‡Œè®¾ç½®ä¸€æ¬¡ï¼Œå…¨ç¨‹è‡ªåŠ¨ä¼ é€’</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> context = {
    <span class="hljs-attr">userId</span>: req.<span class="hljs-property">headers</span>[<span class="hljs-string">'x-user-id'</span>],
    <span class="hljs-attr">token</span>: req.<span class="hljs-property">headers</span>[<span class="hljs-string">'authorization'</span>]
  };
  asyncLocalStorage.<span class="hljs-title function_">run</span>(context, next);
});

<span class="hljs-comment">// ä¸šåŠ¡ä»£ç ä¸“æ³¨ä¸šåŠ¡é€»è¾‘</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/user-profile'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-comment">// ä¸ç”¨æ‰‹åŠ¨ä¼ é€’ä¸Šä¸‹æ–‡äº†ï¼</span>
  <span class="hljs-keyword">const</span> [userInfo, orders] = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
    alovaInstance.<span class="hljs-title class_">Get</span>(<span class="hljs-string">'http://gateway.com/user/profile'</span>),
    alovaInstance.<span class="hljs-title class_">Get</span>(<span class="hljs-string">'http://gateway.com/order/recent'</span>)
  ]);
  
  res.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">user</span>: userInfo.<span class="hljs-property">data</span>, <span class="hljs-attr">orders</span>: orders.<span class="hljs-property">data</span> });
});
</code></pre>
<h2 data-id="heading-1">APIç½‘å…³ä¸­çš„ä½¿ç”¨åœºæ™¯</h2>
<p>åœ¨ç½‘å…³ä¸­ç»å¸¸éœ€è¦è¿›è¡Œé‰´æƒã€è¯·æ±‚é€Ÿç‡é™åˆ¶ä»¥åŠè¯·æ±‚åˆ†å‘ç­‰ï¼Œalova3çš„rediså­˜å‚¨é€‚é…å™¨å’ŒrateLimiterå¯ä»¥å¾ˆå¥½åœ°å®ç°åˆ†å¸ƒå¼çš„é‰´æƒæœåŠ¡å’Œè¯·æ±‚é€Ÿç‡é™åˆ¶ã€‚</p>
<h3 data-id="heading-2">é‰´æƒå¯ä»¥è¿™ä¹ˆæ</h3>
<p>å¦‚æœé‰´æƒtokenæœ‰ä¸€å®šçš„è¿‡æœŸæ—¶é—´ï¼Œå¯åœ¨ç½‘å…³ä¸­é…ç½®rediså­˜å‚¨é€‚é…å™¨ï¼Œå°†tokenå­˜å‚¨åœ¨redisä¸­ä¾¿äºé‡å¤ä½¿ç”¨ï¼Œå¯¹äºå•æœºçš„é›†ç¾¤æœåŠ¡ä¹Ÿå¯ä»¥ä½¿ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Falova.js.org%2Fresource%2Fstorage-adapter%2Ffile" target="_blank" title="https://alova.js.org/resource/storage-adapter/file" ref="nofollow noopener noreferrer"><code>@alova/storage-file</code></a>æ–‡ä»¶å­˜å‚¨é€‚é…å™¨ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { createAlova } <span class="hljs-keyword">from</span> <span class="hljs-string">'alova'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">RedisStorageAdapter</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@alova/storage-redis'</span>;
<span class="hljs-keyword">import</span> adapterFetch <span class="hljs-keyword">from</span> <span class="hljs-string">'@alova/fetch'</span>;
<span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>;

<span class="hljs-keyword">const</span> redisAdapter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedisStorageAdapter</span>({
  <span class="hljs-attr">host</span>: <span class="hljs-string">'localhost'</span>,
  <span class="hljs-attr">port</span>: <span class="hljs-string">'6379'</span>,
  <span class="hljs-attr">username</span>: <span class="hljs-string">'default'</span>,
  <span class="hljs-attr">password</span>: <span class="hljs-string">'my-top-secret'</span>,
  <span class="hljs-attr">db</span>: <span class="hljs-number">0</span>
});

<span class="hljs-keyword">const</span> gatewayAlova = <span class="hljs-title function_">createAlova</span>({
  <span class="hljs-attr">requestAdapter</span>: <span class="hljs-title function_">adapterFetch</span>(),
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">beforeRequest</span>(<span class="hljs-params">method</span>) {
    <span class="hljs-keyword">const</span> newToken = <span class="hljs-keyword">await</span> <span class="hljs-title function_">authRequest</span>(method.<span class="hljs-property">config</span>.<span class="hljs-property">headers</span>[<span class="hljs-string">'Authorization'</span>], method.<span class="hljs-property">config</span>.<span class="hljs-property">headers</span>[<span class="hljs-string">'UserId'</span>])
    method.<span class="hljs-property">config</span>.<span class="hljs-property">headers</span>[<span class="hljs-string">'Authorization'</span>] = <span class="hljs-string">`Bearer <span class="hljs-subst">${newToken}</span>`</span>;
  }
  <span class="hljs-comment">// è®¾ç½®2çº§å­˜å‚¨é€‚é…å™¨</span>
  <span class="hljs-attr">l2Cache</span>: redisAdapter,
  <span class="hljs-comment">// ...</span>
});

<span class="hljs-keyword">const</span> <span class="hljs-title function_">authRequest</span> = (<span class="hljs-params">token, userId</span>) =&gt; gatewayAlova.<span class="hljs-title class_">Post</span>(<span class="hljs-string">'http://auth.com/auth/token'</span>, <span class="hljs-literal">null</span>, {
  <span class="hljs-comment">// è®¾ç½®3ä¸ªå°æ—¶çš„ç¼“å­˜ï¼Œå°†ä¿å­˜åœ¨redisä¸­ï¼Œå†æ¬¡ä»¥ç›¸åŒå‚æ•°è¯·æ±‚ä¼šå‘½ä¸­ç¼“å­˜</span>
  <span class="hljs-attr">cacheFor</span>: {
    <span class="hljs-attr">mode</span>: <span class="hljs-string">'restore'</span>,
    <span class="hljs-attr">expire</span>: <span class="hljs-number">3</span> * <span class="hljs-number">3600</span> * <span class="hljs-number">1000</span>
  },
  <span class="hljs-attr">headers</span>: {
    <span class="hljs-string">'x-user-id'</span>: userId,
    <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${token}</span>`</span>
  }
});

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();

<span class="hljs-comment">// å®ç°appæ¥æ”¶æ‰€æœ‰è¯·æ±‚ï¼Œå¹¶è½¬å‘åˆ°alova</span>
<span class="hljs-comment">// æ³¨å†Œæ‰€æœ‰ HTTP æ–¹æ³•çš„è·¯ç”±</span>
<span class="hljs-keyword">const</span> methods = [<span class="hljs-string">'get'</span>, <span class="hljs-string">'post'</span>, <span class="hljs-string">'put'</span>, <span class="hljs-string">'delete'</span>, <span class="hljs-string">'patch'</span>, <span class="hljs-string">'options'</span>, <span class="hljs-string">'head'</span>];
methods.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">method</span> =&gt;</span> {
  app[method](<span class="hljs-string">'*'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
    <span class="hljs-keyword">const</span> { method, originalUrl, headers, body, query } = req;

    <span class="hljs-comment">// ä½¿ç”¨ alova å‘é€è¯·æ±‚</span>
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> gatewayAlova.<span class="hljs-title class_">Request</span>({
      <span class="hljs-attr">method</span>: method.<span class="hljs-title function_">toLowerCase</span>(),
      <span class="hljs-attr">url</span>: originalUrl,
      <span class="hljs-attr">params</span>: query,
      <span class="hljs-attr">data</span>: body,
      headers
    });
    
    <span class="hljs-comment">// è½¬å‘å“åº”å¤´éƒ¨</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> response.<span class="hljs-property">headers</span>.<span class="hljs-title function_">entries</span>()) {
      res.<span class="hljs-title function_">setHeader</span>(key, value);
    }
    
    <span class="hljs-comment">// å‘é€å“åº”æ•°æ®</span>
    res.<span class="hljs-title function_">status</span>(response.<span class="hljs-property">status</span>).<span class="hljs-title function_">send</span>(<span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>());
  });
});

app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Gateway server started on port 3000'</span>);
});
</code></pre>
<p>å½“ç„¶ï¼Œå¦‚æœéœ€è¦æ¯æ¬¡è¯·æ±‚éƒ½é‡æ–°é‰´æƒï¼Œä¹Ÿå¯ä»¥åœ¨<code>authRequest</code>ä¸­å»æ‰<code>cacheFor</code>å…³é—­ç¼“å­˜ã€‚</p>
<h2 data-id="heading-3">é™æµç­–ç•¥</h2>
<p>alovaçš„rateLimiterå¯ä»¥å®ç°åˆ†å¸ƒå¼çš„é™æµç­–ç•¥ï¼Œå†…éƒ¨ä½¿ç”¨<code>node-rate-limiter-flexible</code>å®ç°ï¼Œæˆ‘ä»¬æ”¹é€ ä¸€ä¸‹å®ç°ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { createRateLimiter } <span class="hljs-keyword">from</span> <span class="hljs-string">'alova/server'</span>;

<span class="hljs-keyword">const</span> rateLimit = <span class="hljs-title function_">createRateLimiter</span>({
  <span class="hljs-comment">/**
   * ç‚¹æ•°é‡ç½®çš„æ—¶é—´ï¼Œå•ä½ms
   * <span class="hljs-doctag">@default</span> 4000
   */</span>
  <span class="hljs-attr">duration</span>: <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>,
  <span class="hljs-comment">/**
   * durationå†…å¯æ¶ˆè€—çš„æœ€å¤§æ•°é‡
   * <span class="hljs-doctag">@default</span> 4
   */</span>
  <span class="hljs-attr">points</span>: <span class="hljs-number">4</span>,
  <span class="hljs-comment">/**
   * å‘½åç©ºé—´ï¼Œå¤šä¸ªrateLimitä½¿ç”¨ç›¸åŒå­˜å‚¨å™¨æ—¶å¯é˜²æ­¢å†²çª
   */</span>
  <span class="hljs-attr">keyPrefix</span>: <span class="hljs-string">'user-rate-limit'</span>,
  <span class="hljs-comment">/**
   * é”å®šæ—¶é•¿ï¼Œå•ä½msï¼Œè¡¨ç¤ºå½“åˆ°è¾¾é€Ÿç‡é™åˆ¶åï¼Œå°†å»¶é•¿[blockDuration]msï¼Œä¾‹å¦‚1å°æ—¶å†…å¯†ç é”™è¯¯5æ¬¡ï¼Œåˆ™é”å®š24å°æ—¶ï¼Œè¿™ä¸ª24å°æ—¶å°±æ˜¯æ­¤å‚æ•°
   */</span>
  <span class="hljs-attr">blockDuration</span>: <span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>
});

<span class="hljs-keyword">const</span> methods = [<span class="hljs-string">'get'</span>, <span class="hljs-string">'post'</span>, <span class="hljs-string">'put'</span>, <span class="hljs-string">'delete'</span>, <span class="hljs-string">'patch'</span>, <span class="hljs-string">'options'</span>, <span class="hljs-string">'head'</span>];
methods.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">method</span> =&gt;</span> {
  app[method](<span class="hljs-string">'*'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
    <span class="hljs-keyword">const</span> { method, originalUrl, headers, body, query } = req;

    <span class="hljs-comment">// åœ¨æ­¤ä½¿ç”¨rateLimitåŒ…è£¹è°ƒç”¨å³å¯ï¼Œå®ƒå°†é»˜è®¤ä½¿ç”¨l2Cacheå­˜å‚¨é€‚é…å™¨ä½œä¸ºæ§åˆ¶å‚æ•°çš„å­˜å‚¨ï¼Œè¿™è¾¹çš„ä¾‹å­ä¼šç”¨rediså­˜å‚¨é€‚é…å™¨ã€‚</span>
    <span class="hljs-keyword">const</span> method = gatewayAlova.<span class="hljs-title class_">Request</span>({
      <span class="hljs-attr">method</span>: method.<span class="hljs-title function_">toLowerCase</span>(),
      <span class="hljs-attr">url</span>: originalUrl,
      <span class="hljs-attr">params</span>: query,
      <span class="hljs-attr">data</span>: body,
      headers
    });
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">rateLimit</span>(method, {
      <span class="hljs-attr">key</span>: req.<span class="hljs-property">ip</span> <span class="hljs-comment">// ä½¿ç”¨ipä½œä¸ºè¿½è¸ªkeyï¼Œé˜²æ­¢åŒä¸€ipé¢‘ç¹è¯·æ±‚</span>
    });
    
    <span class="hljs-comment">// ...</span>
  });
});
</code></pre>
<h2 data-id="heading-4">ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆï¼šä»¤ç‰Œè‡ªåŠ¨ç»´æŠ¤</h2>
<p>å’Œå¤–éƒ¨APIæ‰“äº¤é“éœ€è¦access_tokenç®¡ç†ï¼Œå¹¶ä¸”å¾ˆå¤šç¬¬ä¸‰æ–¹access_tokenå…·æœ‰è°ƒç”¨é™åˆ¶ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨alova3+rediså­˜å‚¨é€‚é…å™¨æ¥å®ç°åˆ†å¸ƒå¼çš„access_tokenç”Ÿå‘½å‘¨æœŸè‡ªåŠ¨ç»´æŠ¤ï¼Œå…¶ä¸­redisç”¨äºaccess_tokenç¼“å­˜ï¼Œatom hookç”¨äºåˆ†å¸ƒå¼æ›´æ–°tokençš„åŸå­æ€§æ“ä½œã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { createAlova, queryCache } <span class="hljs-keyword">from</span> <span class="hljs-string">'alova'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">RedisStorageAdapter</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@alova/storage-redis'</span>;
<span class="hljs-keyword">import</span> adapterFetch <span class="hljs-keyword">from</span> <span class="hljs-string">'@alova/fetch'</span>;
<span class="hljs-keyword">import</span> { atomize } <span class="hljs-keyword">from</span> <span class="hljs-string">'alova/server'</span>;

<span class="hljs-keyword">const</span> redisAdapter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedisStorageAdapter</span>({
  <span class="hljs-attr">host</span>: <span class="hljs-string">'localhost'</span>,
  <span class="hljs-attr">port</span>: <span class="hljs-string">'6379'</span>,
  <span class="hljs-attr">username</span>: <span class="hljs-string">'default'</span>,
  <span class="hljs-attr">password</span>: <span class="hljs-string">'my-top-secret'</span>,
  <span class="hljs-attr">db</span>: <span class="hljs-number">0</span>
});
<span class="hljs-keyword">const</span> thirdPartyAlova = <span class="hljs-title function_">createAlova</span>({
  <span class="hljs-attr">requestAdapter</span>: <span class="hljs-title function_">adapterFetch</span>(),
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">beforeRequest</span>(<span class="hljs-params">method</span>) {
    <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦ä¸ºç¬¬ä¸‰æ–¹APIï¼Œå¦‚æœæ˜¯çš„è¯åˆ™è·å–ä»¤ç‰Œ</span>
    <span class="hljs-keyword">if</span> (method.<span class="hljs-property">meta</span>?.<span class="hljs-property">isThirdPartyApi</span>) {
      <span class="hljs-comment">// ä»¥åŸå­æ€§çš„æ–¹å¼è·å–ä»¤ç‰Œï¼Œé˜²æ­¢å¤šè¿›ç¨‹åŒæ—¶è·å–token</span>
      <span class="hljs-keyword">const</span> accessTokenGetMethod = <span class="hljs-title function_">getAccessToken</span>();
      <span class="hljs-keyword">let</span> accessToken = <span class="hljs-keyword">await</span> <span class="hljs-title function_">queryCache</span>(accessTokenGetMethod);
      <span class="hljs-keyword">if</span> (!accessToken) {
        <span class="hljs-comment">// è·å–æˆåŠŸåå°†ä¼šç¼“å­˜</span>
        accessToken = <span class="hljs-keyword">await</span> <span class="hljs-title function_">atomize</span>(accessTokenGetMethod);
      }
      method.<span class="hljs-property">config</span>.<span class="hljs-property">params</span>.<span class="hljs-property">access_token</span> = accessToken;
    }
  },
  <span class="hljs-attr">l2Cache</span>: redisAdapter,
});

<span class="hljs-keyword">const</span> <span class="hljs-title function_">getAccessToken</span> = (<span class="hljs-params"/>) =&gt; thirdPartyAlova.<span class="hljs-title class_">Get</span>(<span class="hljs-string">'http://third-party.com/token'</span>, {
  <span class="hljs-attr">params</span>: {
    <span class="hljs-attr">grant_type</span>: <span class="hljs-string">'client_credentials'</span>,
    <span class="hljs-attr">client_id</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">THIRD_PARTY_CLIENT_ID</span>,
    <span class="hljs-attr">client_secret</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">THIRD_PARTY_CLIENT_SECRET</span>
  },
  <span class="hljs-attr">cacheFor</span>: {
    <span class="hljs-attr">mode</span>: <span class="hljs-string">'restore'</span>,
    <span class="hljs-attr">expire</span>: <span class="hljs-number">1</span> * <span class="hljs-number">3600</span> * <span class="hljs-number">1000</span> <span class="hljs-comment">// ä¸¤å°æ—¶ç¼“å­˜æ—¶é—´</span>
  }
});

<span class="hljs-keyword">const</span> <span class="hljs-title function_">getThirdPartyUserInfo</span> = userId =&gt; thirdPartyAlova.<span class="hljs-title class_">Get</span>(<span class="hljs-string">'http://third-party.com/user/info'</span>, {
  <span class="hljs-attr">params</span>: {
    userId
  },
  <span class="hljs-attr">meta</span>: {
    <span class="hljs-attr">isThirdPartyApi</span>: <span class="hljs-literal">true</span>
  }
});
</code></pre>
<h2 data-id="heading-5">å†™åœ¨æœ€å</h2>
<p>é™¤æ­¤ä»¥å¤–ï¼Œalovaè¿˜æä¾›äº†åˆ†å¸ƒå¼çš„éªŒè¯ç å‘é€å’ŒéªŒè¯ã€è¯·æ±‚é‡è¯•ç­‰server hooksï¼Œæƒ³äº†è§£æ›´å¤šçš„åŒå­¦å¯ä»¥å‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Falova.js.org%2Ftutorial%2Fserver%2Fstrategy%2F" target="_blank" title="https://alova.js.org/tutorial/server/strategy/" ref="nofollow noopener noreferrer">æœåŠ¡ç«¯è¯·æ±‚ç­–ç•¥</a>ã€‚</p>
<p>å¦‚æœè§‰å¾—alovaè¿˜ä¸é”™ï¼ŒçœŸè¯šå¸Œæœ›ä½ å¯ä»¥<a href="https://link.juejin.cn?target=https%3A%2F%2Falova.js.org%2Fexamples" target="_blank" title="https://alova.js.org/examples" ref="nofollow noopener noreferrer">å°è¯•ä½“éªŒä¸€ä¸‹</a>ï¼Œä¹Ÿå¯ä»¥ç»™æˆ‘ä»¬æ¥ä¸€ä¸ªå…è´¹çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Falovajs%2Falova" target="_blank" title="https://github.com/alovajs/alova" ref="nofollow noopener noreferrer">github stars</a>ã€‚</p>
<p>è®¿é—®alovajsçš„å®˜ç½‘æŸ¥çœ‹æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Falova.js.org" target="_blank" title="https://alova.js.org" ref="nofollow noopener noreferrer">alovajså®˜ç½‘</a>ã€‚</p>
<p>æœ‰å…´è¶£å¯ä»¥åŠ å…¥æˆ‘ä»¬çš„äº¤æµç¤¾åŒºï¼Œåœ¨ç¬¬ä¸€æ—¶é—´è·å–åˆ°æœ€æ–°è¿›å±•ï¼Œä¹Ÿèƒ½ç›´æ¥å’Œå¼€å‘å›¢é˜Ÿäº¤æµï¼Œæå‡ºä½ çš„æƒ³æ³•å’Œå»ºè®®ã€‚</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Falova.js.org%2Fimg%2Fwechat_qrcode.jpg" target="_blank" title="https://alova.js.org/img/wechat_qrcode.jpg" ref="nofollow noopener noreferrer">åŠ å…¥å¾®ä¿¡ç¾¤å‚ä¸äº¤æµ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdiscord.gg%2FS47QGJgkVb" target="_blank" title="https://discord.gg/S47QGJgkVb" ref="nofollow noopener noreferrer">åŠ å…¥åœ¨ Discord ç¤¾åŒºå‚ä¸äº¤æµ</a></li>
</ul>
<p>æœ‰ä»»ä½•é—®é¢˜ï¼Œä½ å¯ä»¥åŠ å…¥ä»¥ä¸‹ç¾¤èŠå’¨è¯¢ï¼Œä¹Ÿå¯ä»¥åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Falovajs%2Falova%2Fdiscussions" target="_blank" title="https://github.com/alovajs/alova/discussions" ref="nofollow noopener noreferrer">github ä»“åº“ä¸­å‘å¸ƒ Discussions</a>ï¼Œå¦‚æœé‡åˆ°é—®é¢˜ï¼Œä¹Ÿè¯·åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Falovajs%2Falova%2Fissues" target="_blank" title="https://github.com/alovajs/alova/issues" ref="nofollow noopener noreferrer">github çš„ issues</a>ä¸­æäº¤ï¼Œæˆ‘ä»¬ä¼šåœ¨æœ€å¿«çš„æ—¶é—´è§£å†³ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2025å‰ç«¯é¢è¯•é¢˜-JavaScriptåŸºç¡€ç¯‡]]></title>    <link>https://juejin.cn/post/7578705123209625643</link>    <guid>https://juejin.cn/post/7578705123209625643</guid>    <pubDate>2025-12-02T00:09:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578705123209625643" data-draft-id="7502485531650752566" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025å‰ç«¯é¢è¯•é¢˜-JavaScriptåŸºç¡€ç¯‡"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,JavaScript"/> <meta itemprop="datePublished" content="2025-12-02T00:09:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="EB_Coder"/> <meta itemprop="url" content="https://juejin.cn/user/3228641967213214"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025å‰ç«¯é¢è¯•é¢˜-JavaScriptåŸºç¡€ç¯‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3228641967213214/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    EB_Coder
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T00:09:40.000Z" title="Tue Dec 02 2025 00:09:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä»¥ä¸‹ä¸ºJavaScriptåŸºç¡€ç¯‡é¢è¯•è€ƒå¯Ÿç‚¹æ€»ç»“ï¼Œå…·ä½“çŸ¥è¯†ç‚¹ä¸ä¼šå¤ªè¯¦ç»†ï¼Œä¸»è¦æ¢³ç†é¢è¯•æ ¸å¿ƒè€ƒå¯Ÿç‚¹ï¼Œä¸ºé¢è¯•åšå‡†å¤‡ã€‚æŒæ¡è¿™äº›åŸºç¡€çŸ¥è¯†ï¼Œä¸ä»…æ˜¯å®Œæˆæ—¥å¸¸å·¥ä½œçš„åŸºæœ¬è¦æ±‚ï¼Œæ›´æ˜¯æœªæ¥å‘ä¸­é«˜çº§å‘å±•çš„åŸºçŸ³ã€‚</p>
</blockquote>
<ul>
<li><a href="https://juejin.cn/post/7503111373468893193" target="_blank" title="https://juejin.cn/post/7503111373468893193">2025å‰ç«¯é¢è¯•é¢˜-Vue3åŸºç¡€ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7511568225987051555" target="_blank" title="https://juejin.cn/post/7511568225987051555">2025å‰ç«¯é¢è¯•é¢˜-Vue3è¿›é˜¶ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7503811658198286388" target="_blank" title="https://juejin.cn/post/7503811658198286388">2025å‰ç«¯é¢è¯•é¢˜-ReactåŸºç¡€ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7504545616841965583" target="_blank" title="https://juejin.cn/post/7504545616841965583">2025å‰ç«¯é¢è¯•é¢˜-Reactè¿›é˜¶ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7504926961627054099" target="_blank" title="https://juejin.cn/post/7504926961627054099">2025å‰ç«¯é¢è¯•é¢˜-Reacté«˜é˜¶ç¯‡</a></li>
<li><a href="https://juejin.cn/spost/7530179511728930856" target="_blank" title="https://juejin.cn/spost/7530179511728930856">2025å‰ç«¯é¢è¯•é¢˜-TSç†è®ºç¯‡</a></li>
<li><a href="https://juejin.cn/post/7533826195352829988" target="_blank" title="https://juejin.cn/post/7533826195352829988">2025å‰ç«¯é¢è¯•é¢˜-TSå®æˆ˜ç¯‡</a></li>
</ul>
<h2 data-id="heading-0">ä¸€ã€ æ•°æ®ç±»å‹ä¸å†…å­˜æœºåˆ¶</h2>
<h3 data-id="heading-1">1. åŸºæœ¬æ•°æ®ç±»å‹</h3>
<ul>
<li><code>String</code></li>
<li><code>Number</code></li>
<li><code>Boolean</code></li>
<li><code>Null</code></li>
<li><code>Undefined</code></li>
<li><code>Symbol</code> <em>(ES6)</em></li>
<li><code>BigInt</code> <em>(ES2020)</em></li>
</ul>
<h4 data-id="heading-2">ç‰¹ç‚¹</h4>
<ul>
<li>å­˜å‚¨åœ¨ <strong>æ ˆå†…å­˜ (Stack)</strong> ä¸­ï¼›</li>
<li>å½“ä¸€ä¸ªå˜é‡è¢«èµ‹å€¼ä¸ºåŸºæœ¬ç±»å‹æ—¶ï¼Œå®ƒç›´æ¥æŒæœ‰è¯¥å€¼ï¼›</li>
<li>å˜é‡ä¹‹é—´çš„èµ‹å€¼æ˜¯å€¼çš„å¤åˆ¶ã€‚</li>
</ul>
<h3 data-id="heading-3">2. å¼•ç”¨æ•°æ®ç±»å‹</h3>
<p><strong>ä¸»è¦æ˜¯</strong>: <code>Object</code> (åŒ…æ‹¬æ™®é€šå¯¹è±¡ã€<code>Array</code>ã€<code>Function</code>ã€<code>Date</code>ç­‰)ã€‚</p>
<h4 data-id="heading-4">ç‰¹ç‚¹</h4>
<ul>
<li>å€¼æœ¬èº«ï¼ˆå³å¯¹è±¡å®ä½“ï¼‰å­˜å‚¨åœ¨<strong>å †å†…å­˜ (Heap)<strong>ä¸­ï¼Œè€Œå˜é‡çš„å€¼æ˜¯æŒ‡å‘è¯¥å †å†…å­˜åœ°å€çš„</strong>å¼•ç”¨</strong>ï¼Œè¯¥å¼•ç”¨å­˜å‚¨åœ¨<strong>æ ˆå†…å­˜</strong>ä¸­ï¼›</li>
<li>å˜é‡ä¹‹é—´çš„èµ‹å€¼æ˜¯å¼•ç”¨çš„å¤åˆ¶ã€‚</li>
</ul>
<h4 data-id="heading-5">é¢è¯•é¢˜ä»£ç ç¤ºä¾‹</h4>
<h5 data-id="heading-6">ç¤ºä¾‹1: åŸºæœ¬ç±»å‹èµ‹å€¼</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> a = <span class="hljs-number">10</span>;
<span class="hljs-keyword">let</span> b = a;
b = <span class="hljs-number">20</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// è¾“å‡ºä»€ä¹ˆï¼Ÿ</span>
<span class="hljs-comment">// è§£æ: a çš„å€¼ä»ç„¶æ˜¯ 10ã€‚å› ä¸º b = a æ˜¯å€¼çš„å¤åˆ¶ï¼Œåç»­å¯¹ b çš„ä¿®æ”¹ä¸å½±å“ aã€‚</span>
</code></pre>
<h5 data-id="heading-7">ç¤ºä¾‹2: å¼•ç”¨ç±»å‹èµ‹å€¼</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> obj1 = { <span class="hljs-attr">name</span>: <span class="hljs-string">'Mickey'</span> };
<span class="hljs-keyword">let</span> obj2 = obj1;
obj2.<span class="hljs-property">name</span> = <span class="hljs-string">'Donald'</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj1.<span class="hljs-property">name</span>); <span class="hljs-comment">// è¾“å‡ºä»€ä¹ˆï¼Ÿ</span>
<span class="hljs-comment">// è§£æ: è¾“å‡º 'Donald'ã€‚å› ä¸º obj2 = obj1 æ˜¯å¼•ç”¨çš„å¤åˆ¶ï¼Œobj1 å’Œ obj2 æŒ‡å‘åŒä¸€ä¸ªå †å†…å­˜åœ°å€ã€‚</span>
<span class="hljs-comment">// é€šè¿‡ obj2 ä¿®æ”¹å¯¹è±¡çš„å±æ€§ï¼Œobj1 ä¹Ÿä¼šå‘ç”Ÿè¿™ä¸ªå˜åŒ–ã€‚</span>
</code></pre>
<h3 data-id="heading-8">3. ç±»å‹åˆ¤æ–­</h3>
<h4 data-id="heading-9"><code>typeof</code></h4>
<p>é€šå¸¸ç”¨äºåˆ¤æ–­<strong>åŸºæœ¬ç±»å‹</strong>ï¼Œä½†æœ‰ä¸¤ä¸ªç‰¹ä¾‹ï¼š</p>
<ul>
<li><code>typeof null</code> è¿”å› <code>'object'</code> (è¿™æ˜¯ä¸€ä¸ªå†å²é—ç•™é—®é¢˜)</li>
<li><code>typeof</code> æ— æ³•ç»†åˆ†å¯¹è±¡ç±»å‹ï¼ˆå¦‚<code>Array</code>, <code>Date</code>ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-10"><code>instanceof</code></h4>
<p>ç”¨äºåˆ¤æ–­ä¸€<strong>ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯æŸä¸ªæ„é€ å‡½æ•°çš„å®ä¾‹</strong>ï¼Œå…¶åŸç†æ˜¯<strong>åŸºäºåŸå‹é“¾çš„æŸ¥æ‰¾</strong>ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-number">123</span>); <span class="hljs-comment">// "number"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-literal">null</span>); <span class="hljs-comment">// "object"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> {}); <span class="hljs-comment">// "object"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> []); <span class="hljs-comment">// "object"</span>

<span class="hljs-keyword">const</span> arr = [];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span>); <span class="hljs-comment">// true (å› ä¸º Array çš„åŸå‹é“¾æœ€ç»ˆæŒ‡å‘ Object)</span>
</code></pre>
<h2 data-id="heading-11">äºŒã€ å˜é‡å£°æ˜: <code>var</code>, <code>let</code> ä¸ <code>const</code></h2>
<p>è¿™æ˜¯ES6ä»¥æ¥å‰ç«¯é¢è¯•çš„å¿…è€ƒç‚¹ï¼Œè¦æ±‚æ¸…æ™°é˜è¿°ä¸‰è€…çš„æ ¸å¿ƒå·®å¼‚ã€‚</p>



































<table><thead><tr><th>ç‰¹æ€§</th><th><code>var</code></th><th><code>let</code></th><th><code>const</code></th></tr></thead><tbody><tr><td><strong>ä½œç”¨åŸŸ</strong></td><td>å‡½æ•°ä½œç”¨åŸŸ</td><td>å—çº§ä½œç”¨åŸŸ (<code>{}</code>)</td><td>å—çº§ä½œç”¨åŸŸ (<code>{}</code>)</td></tr><tr><td><strong>å˜é‡æå‡ (Hoisting)</strong></td><td>å­˜åœ¨ (å£°æ˜æå‡ï¼Œèµ‹å€¼ä¸æå‡)</td><td>ä¸å­˜åœ¨ (å­˜åœ¨æš‚æ—¶æ€§æ­»åŒº<code>TDZ</code>)</td><td>ä¸å­˜åœ¨ (å­˜åœ¨æš‚æ—¶æ€§æ­»åŒº <code>TDZ</code>)</td></tr><tr><td><strong>é‡å¤å£°æ˜</strong></td><td>å…è®¸</td><td>ä¸å…è®¸</td><td>ä¸å…è®¸</td></tr><tr><td><strong>é‡æ–°èµ‹å€¼</strong></td><td>å…è®¸</td><td>å…è®¸</td><td>ä¸å…è®¸</td></tr></tbody></table>
<h3 data-id="heading-12">é¢è¯•é¢˜ä»£ç ç¤ºä¾‹</h3>
<h4 data-id="heading-13">1. ä½œç”¨åŸŸä¸å˜é‡æå‡</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// var çš„å˜é‡æå‡</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(foo); <span class="hljs-comment">// undefined</span>
<span class="hljs-keyword">var</span> foo = <span class="hljs-string">'Hello'</span>;

<span class="hljs-comment">// let çš„æš‚æ—¶æ€§æ­»åŒº</span>
<span class="hljs-comment">// console.log(bar); // Uncaught ReferenceError: Cannot access 'bar' before initialization</span>
<span class="hljs-keyword">let</span> bar = <span class="hljs-string">'World'</span>;
</code></pre>
<h4 data-id="heading-14">2. <code>const</code> çš„ä¸å˜æ€§</h4>
<p>é¢è¯•ä¼šè€ƒå¯Ÿæ˜¯å¦ç†è§£ <code>const</code> çš„â€œä¸å˜â€æ˜¯æŒ‡é’ˆï¼ˆå¼•ç”¨ï¼‰çš„ä¸å˜ï¼Œè€Œä¸æ˜¯å…¶æŒ‡å‘å†…å®¹çš„ä¸å˜ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">person</span> = {
  name: 'Mickey',
  age: 30
}<span class="hljs-comment">;</span>

// <span class="hljs-attr">person</span> = {}<span class="hljs-comment">; // ä¼šæŠ›å‡º TypeError: Assignment to constant variable.</span>

<span class="hljs-attr">person.age</span> = <span class="hljs-number">31</span><span class="hljs-comment">; // è¿™æ˜¯å…è®¸çš„ï¼Œå› ä¸ºæˆ‘ä»¬ä¿®æ”¹çš„æ˜¯å¯¹è±¡å†…éƒ¨çš„å±æ€§ï¼Œè€Œä¸æ˜¯ person å˜é‡çš„å¼•ç”¨ã€‚</span>
console.log(person.age)<span class="hljs-comment">; // 31</span>
</code></pre>
<h2 data-id="heading-15">ä¸‰ã€ è¿ç®—ç¬¦</h2>
<ul>
<li>
<p><strong>ç®—æœ¯è¿ç®—ç¬¦</strong>: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code> (å–æ¨¡), <code>**</code> (ES7å¹‚è¿ç®—)ã€‚</p>
</li>
<li>
<p><strong>èµ‹å€¼è¿ç®—ç¬¦</strong>: <code>=</code>, <code>+=</code>, <code>-=</code>, <code>*=</code>, <code>/=</code>, <code>%=</code>ã€‚</p>
</li>
<li>
<p><strong>æ¯”è¾ƒè¿ç®—ç¬¦</strong>: <code>==</code>, <code>===</code>, <code>!=</code>, <code>!==</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>ã€‚</p>
</li>
<li>
<p><strong>é€»è¾‘è¿ç®—ç¬¦</strong>: <code>&amp;&amp;</code> (é€»è¾‘ä¸), <code>||</code> (é€»è¾‘æˆ–), <code>!</code> (é€»è¾‘é)ã€‚</p>
</li>
<li>
<p><strong>ä¸‰å…ƒè¿ç®—ç¬¦</strong>: <code>condition ? exprIfTrue : exprIfFalse</code>ã€‚</p>
</li>
</ul>
<h3 data-id="heading-16">é¢è¯•é¢˜ä»£ç ç¤ºä¾‹</h3>
<p><code>&amp;&amp;</code> å’Œ <code>||</code> å…·æœ‰çŸ­è·¯ç‰¹æ€§ï¼Œåœ¨å®é™…ç¼–ç ä¸­éå¸¸æœ‰ç”¨ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// &amp;&amp; (ä¸): å¦‚æœç¬¬ä¸€ä¸ªæ“ä½œæ•°ä¸ºå‡å€¼(false)ï¼Œåˆ™ç›´æ¥è¿”å›ç¬¬ä¸€ä¸ªæ“ä½œæ•°ï¼Œä¸å†è®¡ç®—ç¬¬äºŒä¸ªã€‚</span>
<span class="hljs-keyword">const</span> result1 = <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'This will not run'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result1); <span class="hljs-comment">// 0</span>

<span class="hljs-keyword">const</span> user = { <span class="hljs-attr">name</span>: <span class="hljs-string">'Mickey'</span> };
<span class="hljs-keyword">const</span> userName = user &amp;&amp; user.<span class="hljs-property">name</span>; <span class="hljs-comment">// å®‰å…¨åœ°è®¿é—®åµŒå¥—å±æ€§</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(userName); <span class="hljs-comment">// 'Mickey'</span>

<span class="hljs-comment">// || (æˆ–): å¦‚æœç¬¬ä¸€ä¸ªæ“ä½œæ•°ä¸ºçœŸå€¼(true)ï¼Œåˆ™ç›´æ¥è¿”å›ç¬¬ä¸€ä¸ªæ“ä½œæ•°ï¼Œä¸å†è®¡ç®—ç¬¬äºŒä¸ªã€‚</span>
<span class="hljs-keyword">const</span> result2 = <span class="hljs-string">'Hello'</span> || <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'This will not run'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result2); <span class="hljs-comment">// 'Hello'</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params">name</span>) {
  name = name || <span class="hljs-string">'Guest'</span>; <span class="hljs-comment">// ä¸ºå‡½æ•°å‚æ•°æä¾›é»˜è®¤å€¼ (ES6ä¹‹å‰å¸¸ç”¨)</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Welcome, <span class="hljs-subst">${name}</span>`</span>);
}
<span class="hljs-title function_">greet</span>(); <span class="hljs-comment">// Welcome, Guest</span>
<span class="hljs-title function_">greet</span>(<span class="hljs-string">'Mickey'</span>); <span class="hljs-comment">// Welcome, Mickey</span>
</code></pre>
<h2 data-id="heading-17">å››ã€ æµç¨‹æ§åˆ¶</h2>
<h3 data-id="heading-18">æ¡ä»¶è¯­å¥</h3>
<ul>
<li>
<p><code>if...else if...else</code>: ç”¨äºå¤„ç†ä¸€ç³»åˆ—çš„æ¡ä»¶åˆ¤æ–­ã€‚</p>
</li>
<li>
<p><code>switch</code>: ç”¨äºåŸºäºä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼æ¥æ‰§è¡Œå¤šä¸ªä¸åŒçš„æ“ä½œï¼Œé€šå¸¸æ¯”ä¸€é•¿ä¸² <code>if...else if</code> æ›´æ¸…æ™°ã€‚</p>
</li>
</ul>
<h3 data-id="heading-19">å¾ªç¯è¯­å¥</h3>
<ul>
<li>
<p><code>for</code>: æœ€å¸¸ç”¨çš„å¾ªç¯ï¼Œå½“å¾ªç¯æ¬¡æ•°å·²çŸ¥æ—¶éå¸¸æ–¹ä¾¿ã€‚</p>
</li>
<li>
<p><code>while</code>: åœ¨æŒ‡å®šæ¡ä»¶ä¸ºçœŸæ—¶é‡å¤æ‰§è¡Œä»£ç å—ã€‚</p>
</li>
<li>
<p><code>do...while</code>: ä¸<code>while</code>ç±»ä¼¼ï¼Œä½†è‡³å°‘ä¼šæ‰§è¡Œä¸€æ¬¡ä»£ç å—ã€‚</p>
</li>
<li>
<p><code>for...of</code> (ES6): ç”¨äºéå†å¯è¿­ä»£å¯¹è±¡ï¼ˆå¦‚ <code>Array</code>, <code>String</code>, <code>Map</code>, <code>Set</code>ï¼‰çš„å€¼ã€‚</p>
</li>
</ul>
<h3 data-id="heading-20">ä»£ç ç¤ºä¾‹</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// switch è¯­å¥</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getFruitColor</span>(<span class="hljs-params">fruit</span>) {
  <span class="hljs-keyword">let</span> color;
  <span class="hljs-keyword">switch</span> (fruit) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'apple'</span>:
      color = <span class="hljs-string">'red'</span>;
      <span class="hljs-keyword">break</span>; <span class="hljs-comment">// break è¯­å¥è‡³å…³é‡è¦ï¼Œå¦åˆ™ä¼šå‘ç”Ÿâ€œç©¿é€â€</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'banana'</span>:
      color = <span class="hljs-string">'yellow'</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'grape'</span>:
      color = <span class="hljs-string">'purple'</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-attr">default</span>:
      color = <span class="hljs-string">'unknown'</span>;
  }
  <span class="hljs-keyword">return</span> color;
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">getFruitColor</span>(<span class="hljs-string">'banana'</span>)); <span class="hljs-comment">// yellow</span>

<span class="hljs-comment">// for å¾ªç¯</span>
<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>];
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; numbers.<span class="hljs-property">length</span>; i++) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Element at index <span class="hljs-subst">${i}</span> is <span class="hljs-subst">${numbers[i]}</span>`</span>);
}

<span class="hljs-comment">// for...of å¾ªç¯ (æ›´ç®€æ´çš„éå†)</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> number <span class="hljs-keyword">of</span> numbers) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Element value is <span class="hljs-subst">${number}</span>`</span>);
}
</code></pre>
<h2 data-id="heading-21">äº”ã€ å‡½æ•°</h2>
<p>å‡½æ•°æ˜¯JavaScriptçš„ä¸€ç­‰å…¬æ°‘ï¼Œæ˜¯ç»„ç»‡å’Œå¤ç”¨ä»£ç çš„åŸºæœ¬å•å…ƒã€‚</p>
<h3 data-id="heading-22"><strong>å‡½æ•°å£°æ˜</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">sum</span>(<span class="hljs-params">a, b</span>) {
  <span class="hljs-keyword">return</span> a + b;
}
</code></pre>
<p>ç‰¹ç‚¹ï¼šå­˜åœ¨<strong>å‡½æ•°æå‡ (Hoisting)</strong> ï¼Œå³åœ¨å£°æ˜ä¹‹å‰å°±å¯ä»¥è°ƒç”¨ã€‚</p>
<h3 data-id="heading-23"><strong>å‡½æ•°è¡¨è¾¾å¼</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> multiply = <span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) {
  <span class="hljs-keyword">return</span> a * b;
};
</code></pre>
<p>ç‰¹ç‚¹ï¼šä½œä¸ºå˜é‡èµ‹å€¼ï¼Œéµå¾ªå˜é‡çš„æå‡è§„åˆ™ï¼ˆ<code>var</code>æå‡å£°æ˜ï¼Œ<code>let</code>/<code>const</code>ä¸æå‡ï¼‰ï¼Œåœ¨èµ‹å€¼å‰æ— æ³•è°ƒç”¨ã€‚</p>
<h3 data-id="heading-24"><strong>ç®­å¤´å‡½æ•° (ES6)</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">subtract</span> = (<span class="hljs-params">a, b</span>) =&gt; a - b;
</code></pre>
<p>ç‰¹ç‚¹ï¼šè¯­æ³•ç®€æ´ï¼Œä¸”å…¶ <code>this</code> å€¼ç”±è¯æ³•ä½œç”¨åŸŸå†³å®šï¼Œè€Œä¸æ˜¯ç”±è°ƒç”¨æ–¹å¼å†³å®šã€‚</p>
<h4 data-id="heading-25"><strong>å‚æ•°ä¸è¿”å›å€¼</strong></h4>
<p>å‡½æ•°å¯ä»¥æ¥æ”¶å‚æ•°ï¼Œå¹¶é€šè¿‡ <code>return</code> å…³é”®å­—è¿”å›ä¸€ä¸ªå€¼ã€‚å¦‚æœæ²¡æœ‰ <code>return</code> è¯­å¥ï¼Œå‡½æ•°é»˜è®¤è¿”å› <code>undefined</code>ã€‚</p>
<h3 data-id="heading-26">é¢è¯•é¢˜ä»£ç ç¤ºä¾‹ (å‡½æ•°æå‡)</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">declaredSum</span>(<span class="hljs-number">5</span>, <span class="hljs-number">5</span>)); <span class="hljs-comment">// 10 (æ­£å¸¸å·¥ä½œï¼Œå› ä¸ºå‡½æ•°å£°æ˜è¢«æå‡)</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">declaredSum</span>(<span class="hljs-params">a, b</span>) {
  <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-comment">// console.log(expressedSum(5, 5)); // TypeError: expressedSum is not a function</span>
<span class="hljs-comment">// (å¦‚æœç”¨varå£°æ˜ï¼Œå˜é‡æå‡äº†ä½†èµ‹å€¼æ²¡æå‡ï¼Œæ­¤æ—¶expressedSumæ˜¯undefined)</span>
<span class="hljs-comment">// Uncaught ReferenceError: Cannot access 'expressedSum' before initialization</span>
<span class="hljs-comment">// (å¦‚æœç”¨const/letå£°æ˜ï¼Œå­˜åœ¨æš‚æ—¶æ€§æ­»åŒº)</span>

<span class="hljs-keyword">const</span> expressedSum = <span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) {
  <span class="hljs-keyword">return</span> a + b;
};
</code></pre>
<h2 data-id="heading-27">å…­ã€ å¯¹è±¡</h2>
<h3 data-id="heading-28"><strong>åˆ›å»º</strong></h3>
<p>é€šå¸¸ä½¿ç”¨å­—é¢é‡è¯­æ³• <code>const obj = {};</code>ã€‚</p>
<h3 data-id="heading-29"><strong>å±æ€§è®¿é—®</strong></h3>
<ul>
<li>
<p><strong>ç‚¹è¡¨ç¤ºæ³• (<code>.</code>)</strong> : <code>obj.key</code>ï¼Œå½“å±æ€§åæ˜¯æœ‰æ•ˆçš„æ ‡è¯†ç¬¦æ—¶ä½¿ç”¨ã€‚</p>
</li>
<li>
<p><strong>æ–¹æ‹¬å·è¡¨ç¤ºæ³• (<code>[]</code>)</strong> : <code>obj['key']</code>ï¼Œå½“å±æ€§ååŒ…å«ç‰¹æ®Šå­—ç¬¦ã€æ˜¯å˜é‡ã€æˆ–éœ€è¦åŠ¨æ€è®¡ç®—æ—¶ä½¿ç”¨ã€‚</p>
</li>
</ul>
<h3 data-id="heading-30"><strong>å±æ€§æ“ä½œ</strong></h3>
<ul>
<li>
<p><strong>æ·»åŠ /ä¿®æ”¹</strong>: <code>obj.newKey = 'value';</code> æˆ– <code>obj['newKey'] = 'value';</code>ã€‚</p>
</li>
<li>
<p><strong>åˆ é™¤</strong>: <code>delete obj.key;</code>ã€‚</p>
</li>
<li>
<p><strong><code>for...in</code> å¾ªç¯</strong>: ç”¨äºéå†å¯¹è±¡è‡ªèº«åŠåŸå‹é“¾ä¸Šçš„<strong>å¯æšä¸¾</strong>å±æ€§ã€‚</p>
</li>
</ul>
<h3 data-id="heading-31">ä»£ç ç¤ºä¾‹</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> car = {
  <span class="hljs-attr">make</span>: <span class="hljs-string">'Toyota'</span>,
  <span class="hljs-attr">model</span>: <span class="hljs-string">'Camry'</span>,
  <span class="hljs-string">'year-of-manufacture'</span>: <span class="hljs-number">2022</span>, <span class="hljs-comment">// åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„é”®</span>
  <span class="hljs-attr">start</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Engine started!'</span>);
  }
};

<span class="hljs-comment">// è®¿é—®å±æ€§</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(car.<span class="hljs-property">make</span>); <span class="hljs-comment">// 'Toyota'</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(car[<span class="hljs-string">'year-of-manufacture'</span>]); <span class="hljs-comment">// 2022 (å¿…é¡»ç”¨æ–¹æ‹¬å·)</span>

<span class="hljs-comment">// ä¿®æ”¹å±æ€§</span>
car.<span class="hljs-property">model</span> = <span class="hljs-string">'Corolla'</span>;

<span class="hljs-comment">// æ·»åŠ å±æ€§</span>
car.<span class="hljs-property">color</span> = <span class="hljs-string">'blue'</span>;

<span class="hljs-comment">// åˆ é™¤å±æ€§</span>
<span class="hljs-keyword">delete</span> car.<span class="hljs-property">color</span>;

<span class="hljs-comment">// éå†å¯¹è±¡</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> car) {
  <span class="hljs-comment">// æ¨èä½¿ç”¨ hasOwnProperty ç¡®ä¿åªéå†å¯¹è±¡è‡ªèº«çš„å±æ€§</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">hasOwnProperty</span>.<span class="hljs-title function_">call</span>(car, key)) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${key}</span>: <span class="hljs-subst">${car[key]}</span>`</span>);
  }
}
</code></pre>
<h2 data-id="heading-32">ä¸ƒã€ æ•°ç»„</h2>
<ul>
<li>
<p><strong>åˆ›å»º</strong>: <code>const arr = [];</code></p>
</li>
<li>
<p><strong>è®¿é—®</strong>: é€šè¿‡ç´¢å¼• <code>arr[0]</code>ã€‚</p>
</li>
<li>
<p><strong><code>length</code> å±æ€§</strong>: è·å–æˆ–è®¾ç½®æ•°ç»„çš„é•¿åº¦ã€‚</p>
</li>
</ul>
<h3 data-id="heading-33"><strong>å¸¸ç”¨æ–¹æ³•</strong></h3>
<h4 data-id="heading-34"><strong>æ”¹å˜åŸæ•°ç»„</strong></h4>
<ul>
<li>
<p><code>push()</code> / <code>pop()</code>: åœ¨æœ«å°¾æ·»åŠ /åˆ é™¤å…ƒç´ ã€‚</p>
</li>
<li>
<p><code>unshift()</code> / <code>shift()</code>: åœ¨å¼€å¤´æ·»åŠ /åˆ é™¤å…ƒç´ ã€‚</p>
</li>
<li>
<p><code>splice()</code>: åœ¨ä»»æ„ä½ç½®æ·»åŠ /åˆ é™¤/æ›¿æ¢å…ƒç´ ã€‚</p>
</li>
<li>
<p><code>sort()</code>: å¯¹æ•°ç»„è¿›è¡Œæ’åºã€‚</p>
</li>
</ul>
<h4 data-id="heading-35"><strong>ä¸æ”¹å˜åŸæ•°ç»„</strong></h4>
<ul>
<li>
<p><code>concat()</code>: åˆå¹¶æ•°ç»„ã€‚</p>
</li>
<li>
<p><code>slice()</code>: æå–æ•°ç»„çš„ä¸€éƒ¨åˆ†ã€‚</p>
</li>
<li>
<p><code>forEach()</code>: éå†æ•°ç»„ï¼Œå¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œä¸€ä¸ªå‡½æ•°ã€‚</p>
</li>
<li>
<p><code>map()</code>: åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ç»“æœæ˜¯è¯¥æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½è°ƒç”¨ä¸€ä¸ªæä¾›çš„å‡½æ•°åè¿”å›çš„ç»“æœã€‚</p>
</li>
<li>
<p><code>filter()</code>: åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„, å…¶åŒ…å«é€šè¿‡æ‰€æä¾›å‡½æ•°å®ç°çš„æµ‹è¯•çš„æ‰€æœ‰å…ƒç´ ã€‚</p>
</li>
<li>
<p><code>find()</code>: è¿”å›æ•°ç»„ä¸­æ»¡è¶³æä¾›çš„æµ‹è¯•å‡½æ•°çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ã€‚</p>
</li>
</ul>
<h3 data-id="heading-36">ä»£ç ç¤ºä¾‹ (map vs forEach)</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> ids = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>];

<span class="hljs-comment">// forEach: ä»…ç”¨äºè¿­ä»£ï¼Œæ²¡æœ‰è¿”å›å€¼</span>
ids.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">id</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Processing ID: <span class="hljs-subst">${id}</span>`</span>);
});

<span class="hljs-comment">// map: ç”¨äºè½¬æ¢æ•°ç»„ï¼Œè¿”å›ä¸€ä¸ªæ–°æ•°ç»„</span>
<span class="hljs-keyword">const</span> urls = ids.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">id</span> =&gt;</span> <span class="hljs-string">`/users/<span class="hljs-subst">${id}</span>`</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(urls); <span class="hljs-comment">// ['/users/1', '/users/2', '/users/3', '/users/4']</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ids);  <span class="hljs-comment">// [1, 2, 3, 4] (åŸæ•°ç»„æœªæ”¹å˜)</span>
</code></pre>
<h2 data-id="heading-37">å…«ã€ DOM æ“ä½œä¸äº‹ä»¶æ¨¡å‹</h2>
<p>å°½ç®¡å¦‚ä»Šçš„æ¡†æ¶éƒ½å°è£…äº†â€˜å®Œç¾â€™çš„DOMæ“ä½œï¼Œä½†åŸç”ŸDOM APIæ˜¯æ‰€æœ‰ä¸Šå±‚å»ºç­‘çš„åŸºç¡€ã€‚</p>
<h3 data-id="heading-38">1. é«˜æ•ˆçš„DOMèŠ‚ç‚¹æ“ä½œ</h3>
<p>å½“éœ€è¦å‘DOMä¸­æ·»åŠ å¤§é‡å…ƒç´ æ—¶ï¼Œç›´æ¥åœ¨å¾ªç¯ä¸­ <code>appendChild</code> ä¼šå¯¼è‡´å¤šæ¬¡<strong>é‡æ’ (reflow)</strong> å’Œ<strong>é‡ç»˜ (repaint)</strong> ï¼Œå½±å“æ€§èƒ½ã€‚æ¨èä½¿ç”¨ <code>DocumentFragment</code> ä½œä¸ºä¸´æ—¶å®¹å™¨ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> list = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'my-list'</span>);
<span class="hljs-keyword">const</span> fragment = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createDocumentFragment</span>(); <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–‡æ¡£ç‰‡æ®µ</span>

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {
  <span class="hljs-keyword">const</span> item = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'li'</span>);
  item.<span class="hljs-property">textContent</span> = <span class="hljs-string">`Item <span class="hljs-subst">${i + <span class="hljs-number">1</span>}</span>`</span>;
  fragment.<span class="hljs-title function_">appendChild</span>(item); <span class="hljs-comment">// å…ˆå°†æ‰€æœ‰æ–°èŠ‚ç‚¹é™„åŠ åˆ° fragment</span>
}

list.<span class="hljs-title function_">appendChild</span>(fragment); <span class="hljs-comment">// æœ€åä¸€æ¬¡æ€§å°† fragment æ·»åŠ åˆ°çœŸå®DOMï¼Œåªè§¦å‘ä¸€æ¬¡é‡æ’ã€‚</span>
</code></pre>
<h3 data-id="heading-39">2. äº‹ä»¶å§”æ‰˜</h3>
<p>åˆ©ç”¨äº‹ä»¶å†’æ³¡æœºåˆ¶ï¼Œå°†äº‹ä»¶ç›‘å¬å™¨ç»‘å®šåœ¨çˆ¶å…ƒç´ ä¸Šï¼Œç»Ÿä¸€å¤„ç†å­å…ƒç´ çš„äº‹ä»¶ã€‚è¿™åœ¨åŠ¨æ€æ·»åŠ å­å…ƒç´ çš„åœºæ™¯ä¸‹å°¤ä¸ºé«˜æ•ˆã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"parent-list"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Item 1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Item 2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Item 3<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> parentList = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'parent-list'</span>);

parentList.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) {
  <span class="hljs-comment">// event.target æ˜¯å®é™…è¢«ç‚¹å‡»çš„å…ƒç´ </span>
  <span class="hljs-keyword">if</span> (event.<span class="hljs-property">target</span> &amp;&amp; event.<span class="hljs-property">target</span>.<span class="hljs-property">nodeName</span> === <span class="hljs-string">'LI'</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ç‚¹å‡»äº†: <span class="hljs-subst">${event.target.textContent}</span>`</span>);
  }
});
</code></pre>
<h2 data-id="heading-40">ä¹ã€ AJAX ä¸æœ¬åœ°å­˜å‚¨</h2>
<h3 data-id="heading-41">AJAX</h3>
<p><code>fetch</code> API æ˜¯ç›®å‰ä¸»æµçš„å¼‚æ­¥è¯·æ±‚æ–¹æ¡ˆï¼Œå®ƒåŸºäº Promiseï¼Œè¯­æ³•æ›´ç®€æ´ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUserData</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.example.com/user/1'</span>);

    <span class="hljs-comment">// fetch ä¸ä¼šå›  404/500 ç­‰ HTTP é”™è¯¯çŠ¶æ€ç è€Œ reject Promiseï¼Œéœ€è¦æ‰‹åŠ¨æ£€æŸ¥</span>
    <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
    }

    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>(); <span class="hljs-comment">// è§£æ JSON å“åº”ä½“</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Fetch failed:'</span>, error);
  }
}

<span class="hljs-title function_">fetchUserData</span>();
</code></pre>
<h3 data-id="heading-42">æœ¬åœ°å­˜å‚¨æ–¹æ¡ˆå¯¹æ¯”</h3>





























<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ç”Ÿå‘½å‘¨æœŸ</th><th>å­˜å‚¨å¤§å°</th><th>ä¸æœåŠ¡å™¨é€šä¿¡</th></tr></thead><tbody><tr><td><code>localStorage</code></td><td>æ°¸ä¹…ï¼Œé™¤éæ‰‹åŠ¨æ¸…é™¤</td><td>çº¦ 5MB</td><td>å¦ï¼Œä»…åœ¨å®¢æˆ·ç«¯</td></tr><tr><td><code>sessionStorage</code></td><td>æµè§ˆå™¨æ ‡ç­¾é¡µå…³é—­å³æ¸…é™¤</td><td>çº¦ 5MB</td><td>å¦ï¼Œä»…åœ¨å®¢æˆ·ç«¯</td></tr><tr><td><code>Cookie</code></td><td>å¯è®¾ç½®è¿‡æœŸæ—¶é—´</td><td>çº¦ 4KB</td><td>æ¯æ¬¡HTTPè¯·æ±‚éƒ½ä¼šæºå¸¦</td></tr></tbody></table>
<blockquote>
<p>ä»¥ä¸Šæ˜¯JavaScriptåŸºç¡€ç¯‡é¢è¯•è€ƒå¯Ÿç‚¹çš„å†…å®¹ï¼Œå¦‚æœ‰é”™è¯¯æ¬¢è¿è¯„è®ºåŒºæŒ‡æ­£ã€‚</p>
</blockquote>
<ul>
<li><a href="https://juejin.cn/post/7503111373468893193" target="_blank" title="https://juejin.cn/post/7503111373468893193">2025å‰ç«¯é¢è¯•é¢˜-Vue3åŸºç¡€ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7511568225987051555" target="_blank" title="https://juejin.cn/post/7511568225987051555">2025å‰ç«¯é¢è¯•é¢˜-Vue3è¿›é˜¶ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7503811658198286388" target="_blank" title="https://juejin.cn/post/7503811658198286388">2025å‰ç«¯é¢è¯•é¢˜-ReactåŸºç¡€ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7504545616841965583" target="_blank" title="https://juejin.cn/post/7504545616841965583">2025å‰ç«¯é¢è¯•é¢˜-Reactè¿›é˜¶ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7504926961627054099" target="_blank" title="https://juejin.cn/post/7504926961627054099">2025å‰ç«¯é¢è¯•é¢˜-Reacté«˜é˜¶ç¯‡</a></li>
<li><a href="https://juejin.cn/spost/7530179511728930856" target="_blank" title="https://juejin.cn/spost/7530179511728930856">2025å‰ç«¯é¢è¯•é¢˜-TSç†è®ºç¯‡</a></li>
<li><a href="https://juejin.cn/post/7533826195352829988" target="_blank" title="https://juejin.cn/post/7533826195352829988">2025å‰ç«¯é¢è¯•é¢˜-TSå®æˆ˜ç¯‡</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Reactæ€§èƒ½ä¼˜åŒ–ï¼š5ä¸ª90%å¼€å‘è€…éƒ½ä¼šå¿½ç•¥çš„useEffectæœ€ä½³å®è·µ]]></title>    <link>https://juejin.cn/post/7578699975414546432</link>    <guid>https://juejin.cn/post/7578699975414546432</guid>    <pubDate>2025-12-02T00:16:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578699975414546432" data-draft-id="7578714759337672704" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Reactæ€§èƒ½ä¼˜åŒ–ï¼š5ä¸ª90%å¼€å‘è€…éƒ½ä¼šå¿½ç•¥çš„useEffectæœ€ä½³å®è·µ"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-02T00:16:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Reactæ€§èƒ½ä¼˜åŒ–ï¼š5ä¸ª90%å¼€å‘è€…éƒ½ä¼šå¿½ç•¥çš„useEffectæœ€ä½³å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T00:16:35.000Z" title="Tue Dec 02 2025 00:16:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Reactæ€§èƒ½ä¼˜åŒ–ï¼š5ä¸ª90%å¼€å‘è€…éƒ½ä¼šå¿½ç•¥çš„useEffectæœ€ä½³å®è·µ</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>åœ¨Reactå‡½æ•°å¼ç»„ä»¶ä¸­ï¼Œ<code>useEffect</code>æ˜¯æœ€å¸¸ç”¨çš„Hookä¹‹ä¸€ï¼Œç”¨äºå¤„ç†å‰¯ä½œç”¨ï¼ˆå¦‚æ•°æ®è·å–ã€è®¢é˜…æˆ–æ‰‹åŠ¨ä¿®æ”¹DOMï¼‰ã€‚ç„¶è€Œï¼Œè®¸å¤šå¼€å‘è€…åœ¨æ—¥å¸¸ä½¿ç”¨ä¸­å¾€å¾€å¿½è§†äº†å…¶æ½œåœ¨çš„æ€§èƒ½é™·é˜±å’Œæœ€ä½³å®è·µã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨5ä¸ªå®¹æ˜“è¢«å¿½ç•¥ä½†è‡³å…³é‡è¦çš„<code>useEffect</code>ä¼˜åŒ–æŠ€å·§ï¼Œå¸®åŠ©ä½ ç¼–å†™æ›´é«˜æ•ˆã€æ›´å¥å£®çš„Reactåº”ç”¨ã€‚</p>
<h2 data-id="heading-2">ä¸»ä½“</h2>
<h3 data-id="heading-3">1. é¿å…ä¸å¿…è¦çš„ä¾èµ–é¡¹</h3>
<h4 data-id="heading-4">é—®é¢˜</h4>
<p>è®¸å¤šå¼€å‘è€…ä¼šåœ¨<code>useEffect</code>çš„ä¾èµ–æ•°ç»„ä¸­ç›²ç›®æ·»åŠ æ‰€æœ‰ç”¨åˆ°çš„å˜é‡ï¼Œè¿™å¯èƒ½å¯¼è‡´é¢‘ç¹è§¦å‘å‰¯ä½œç”¨ï¼Œç”šè‡³å¼•å‘æ— é™å¾ªç¯ã€‚</p>
<h4 data-id="heading-5">è§£å†³æ–¹æ¡ˆ</h4>
<ul>
<li><strong>ä½¿ç”¨æœ€å°åŒ–ä¾èµ–åŸåˆ™</strong>ï¼šåªæ·»åŠ çœŸæ­£éœ€è¦è§¦å‘å‰¯ä½œç”¨çš„å˜é‡ã€‚</li>
<li><strong>åˆ©ç”¨å‡½æ•°å¼æ›´æ–°</strong>ï¼šå¯¹äºçŠ¶æ€æ›´æ–°ï¼Œå¯ä»¥ä½¿ç”¨å‡½æ•°å¼æ›´æ–°é¿å…ç›´æ¥ä¾èµ–çŠ¶æ€å€¼ã€‚</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ ä¸æ¨è</span>
<span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> interval = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">setCount</span>(count + <span class="hljs-number">1</span>); <span class="hljs-comment">// ä¾èµ–count</span>
  }, <span class="hljs-number">1000</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearInterval</span>(interval);
}, [count]);

<span class="hljs-comment">// âœ… æ¨èï¼šä½¿ç”¨å‡½æ•°å¼æ›´æ–°</span>
<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> interval = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">prevCount</span> =&gt;</span> prevCount + <span class="hljs-number">1</span>); <span class="hljs-comment">// ä¸ä¾èµ–count</span>
  }, <span class="hljs-number">1000</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearInterval</span>(interval);
}, []);
</code></pre>
<h3 data-id="heading-6">2. æ­£ç¡®æ¸…ç†å‰¯ä½œç”¨</h3>
<h4 data-id="heading-7">é—®é¢˜</h4>
<p>å¿˜è®°æ¸…ç†å‰¯ä½œç”¨ï¼ˆå¦‚äº‹ä»¶ç›‘å¬å™¨ã€å®šæ—¶å™¨æˆ–è®¢é˜…ï¼‰ä¼šå¯¼è‡´å†…å­˜æ³„æ¼å’Œä¸å¯é¢„æœŸçš„è¡Œä¸ºã€‚</p>
<h4 data-id="heading-8">è§£å†³æ–¹æ¡ˆ</h4>
<ul>
<li><strong>å§‹ç»ˆè¿”å›æ¸…ç†å‡½æ•°</strong>ï¼šå³ä½¿ä½ è®¤ä¸ºä¸éœ€è¦æ¸…ç†ï¼Œä¹Ÿè¦å…»æˆä¹ æƒ¯ã€‚</li>
<li><strong>æ¸…ç†åº”ä¸åˆå§‹åŒ–å¯¹ç§°</strong>ï¼šç¡®ä¿æ¸…ç†çš„é€»è¾‘ä¸åˆå§‹åŒ–çš„é€»è¾‘å®Œå…¨å¯¹åº”ã€‚</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleResize</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'resized'</span>);
  
 <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'resize'</span>, handleResize);
  
 <span class="hljs-comment">// âœ…å¿…é¡»è¿”å›æ¸…ç†å‡½æ•°</span>
 <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'resize'</span>, handleResize);
}, []);
</code></pre>
<h3 data-id="heading-9">3. useCallbackä¸useMemoçš„åˆç†ä½¿ç”¨</h3>
<h4 data-id="heading-10">é—®é¢˜</h4>
<p>ç›´æ¥åœ¨<code>useEffect</code>ä¸­åˆ›å»ºå‡½æ•°æˆ–å¯¹è±¡ä¼šå¯¼è‡´æ¯æ¬¡æ¸²æŸ“éƒ½ç”Ÿæˆæ–°çš„å¼•ç”¨ï¼Œä»è€Œè§¦å‘ä¸å¿…è¦çš„å‰¯ä½œç”¨ã€‚</p>
<p>####è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li><strong>é…åˆuseCallback/useMemoä½¿ç”¨</strong>ï¼šç¨³å®šå‡½æ•°çš„å¼•ç”¨ã€‚</li>
<li><strong>ä»…åœ¨å¿…è¦æ—¶ä¼˜åŒ–</strong>ï¼šè¿‡åº¦ä½¿ç”¨ä¹Ÿä¼šå¸¦æ¥æ€§èƒ½å¼€é”€ã€‚</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> fetchData = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span> () =&gt; {
 <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/data'</span>);
 <span class="hljs-title function_">setData</span>(response.<span class="hljs-property">data</span>);
}, []); <span class="hljs-comment">// âœ…ç¨³å®šå¼•ç”¨</span>

<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
 <span class="hljs-title function_">fetchData</span>();
}, [fetchData]); <span class="hljs-comment">//ç°åœ¨ä¾èµ–é¡¹æ˜¯ç¨³å®šçš„</span>
</code></pre>
<p>###4.åˆ†æ‹†å¤šä¸ªç‹¬ç«‹çš„å‰¯ä½œç”¨</p>
<p>####é—®é¢˜ï¼š
å°†å¤šä¸ªæ— å…³çš„é€»è¾‘å¡è¿›åŒä¸€ä¸ª<code>useEffect</code>ä¼šå¯¼è‡´ä»£ç éš¾ä»¥ç»´æŠ¤ä¸”å¯èƒ½å¼•å‘ä¸å¿…è¦çš„æ‰§è¡Œã€‚</p>
<p>####è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li><strong>å•ä¸€èŒè´£åŸåˆ™</strong>ï¼šæ¯ä¸ª<code>useEffect</code>åªå…³æ³¨ä¸€ä»¶äº‹ã€‚</li>
<li><strong>é€»è¾‘åˆ†ç»„æ¸…æ™°</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒæ··åœ¨ä¸€èµ·çš„é€»è¾‘</span>
<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">()=&gt;</span>{
 <span class="hljs-title function_">fetchUser</span>(userId);
 <span class="hljs-title function_">startChatSubscription</span>(userId);
},[userId]);

<span class="hljs-comment">//âœ…æ‹†åˆ†æˆç‹¬ç«‹çš„effect </span>
<span class="hljs-comment">//ç”¨æˆ·æ•°æ®è·å– </span>
 <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">()=&gt;</span>{<span class="hljs-title function_">fetchUser</span>(userId)},[userId]);

<span class="hljs-comment">//èŠå¤©è®¢é˜… </span>
 <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">()=&gt;</span>{
 <span class="hljs-keyword">const</span> subscription=<span class="hljs-title function_">startChatSubscription</span>(userId); 
 <span class="hljs-keyword">return</span><span class="hljs-function">()=&gt;</span>subscription.<span class="hljs-title function_">unsubscribe</span>();
 },[userId]);
</code></pre>
<p>###5.æ­£ç¡®å¤„ç†å¼‚æ­¥æ“ä½œç«æ€æ¡ä»¶</p>
<p>####é—®é¢˜ï¼š
åœ¨å¿«é€Ÿåˆ‡æ¢å‚æ•°æ—¶ï¼ˆå¦‚è¿ç»­ç‚¹å‡»ä¸åŒç”¨æˆ·IDï¼‰ï¼Œå‰ä¸€ä¸ªè¯·æ±‚å¯èƒ½åœ¨åé¢å®Œæˆå¯¼è‡´çŠ¶æ€ä¸ä¸€è‡´ã€‚</p>
<p>####è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li><strong>å–æ¶ˆè¿‡æ—¶è¯·æ±‚</strong>ï¼š
<ul>
<li>AbortControllerï¼ˆåŸç”Ÿfetchï¼‰</li>
<li>axios CancelToken</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"> <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">()=&gt;</span>{
 <span class="hljs-keyword">const</span> controller=<span class="hljs-keyword">new</span> <span class="hljs-title class_">AbortController</span>();
 
 <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadData</span>(<span class="hljs-params"/>){
 <span class="hljs-keyword">try</span>{
 <span class="hljs-keyword">const</span> res=<span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/user/<span class="hljs-subst">${userId}</span>`</span>,{
 <span class="hljs-attr">signal</span>:controller.<span class="hljs-property">signal</span> });
 <span class="hljs-title function_">setUser</span>(<span class="hljs-keyword">await</span> res.<span class="hljs-title function_">json</span>());
 }<span class="hljs-keyword">catch</span>(err){
 <span class="hljs-keyword">if</span>(err.<span class="hljs-property">name</span>!==<span class="hljs-string">'AbortError'</span>){<span class="hljs-comment">/*å¤„ç†é”™è¯¯*/</span>}
 }
 }
 
 <span class="hljs-title function_">loadData</span>();
 
 <span class="hljs-keyword">return</span><span class="hljs-function">()=&gt;</span>controller.<span class="hljs-title function_">abort</span>(); <span class="hljs-comment">//âœ…å–æ¶ˆæœªå®Œæˆçš„è¯·æ±‚</span>
 
 },[userId]);
</code></pre>
<p>##æ€»ç»“</p>
<p>é€šè¿‡éµå¾ªè¿™äº”ä¸ªæœ€ä½³å®è·µâ€”â€”æœ€å°åŒ–ä¾èµ–é¡¹ã€å½»åº•æ¸…ç†å‰¯ä½œç”¨ã€ç¨³å®šå¼•ç”¨ã€æ‹†åˆ†ç‹¬ç«‹é€»è¾‘ä»¥åŠå¤„ç†å¼‚æ­¥ç«æ€â€”â€”ä½ å¯ä»¥æ˜¾è‘—æå‡Reactåº”ç”¨çš„æ€§èƒ½å’Œå¯é æ€§ã€‚è®°ä½ï¼Œå¥½çš„å¼€å‘è€…ä¸ä»…è¦è®©ä»£ç å·¥ä½œæ›´è¦è®©ä»£ç ä¼˜é›…é«˜æ•ˆåœ°å·¥ä½œã€‚å°†è¿™äº›åŸåˆ™èå…¥æ—¥å¸¸å¼€å‘ä¹ æƒ¯å°†å¸®åŠ©ä½ æ„å»ºæ›´ä¸“ä¸šçš„Reactåº”ç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å®æˆ˜ LiteLLM ä¸ç›‘æ§å‘Šè­¦ç³»ç»Ÿçš„é›†æˆ]]></title>    <link>https://juejin.cn/post/7578714759337689088</link>    <guid>https://juejin.cn/post/7578714759337689088</guid>    <pubDate>2025-12-02T00:19:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578714759337689088" data-draft-id="7578699975414497280" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å®æˆ˜ LiteLLM ä¸ç›‘æ§å‘Šè­¦ç³»ç»Ÿçš„é›†æˆ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-02T00:19:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ—¥ä¹ ä¸€æŠ€"/> <meta itemprop="url" content="https://juejin.cn/user/3913917125896190"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å®æˆ˜ LiteLLM ä¸ç›‘æ§å‘Šè­¦ç³»ç»Ÿçš„é›†æˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3913917125896190/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ—¥ä¹ ä¸€æŠ€
  </span> <!----> <!----> <div class="vip-level" data-v-cd7d0a50="" data-v-292f6e48=""><span class="tooltip" data-v-cd7d0a50=""><div class="byte-tooltip byte-tooltip--dark" style="display:none;">
        VIP.1 åˆå­¦ä¹ç»ƒ
      </div><span class="byte-tooltip__wrapper"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="VIP.1 åˆå­¦ä¹ç»ƒ" title="VIP.1 åˆå­¦ä¹ç»ƒ" class="lazy" style="aspect-ratio:NaN;" data-v-5244ef91="" data-v-cd7d0a50=""/></span></span></div> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T00:19:58.000Z" title="Tue Dec 02 2025 00:19:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å‰ä¸¤ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº† LiteLLM çš„å†…ç½®æ—¥å¿—ç³»ç»Ÿå’Œå¤–éƒ¨æ—¥å¿—é›†æˆèƒ½åŠ›ã€‚åŸºäºè¿™äº›ä¸°å¯Œçš„æ—¥å¿—æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°å¯¹ LLM ç½‘å…³çš„å…¨é¢è§‚æµ‹ã€‚ç„¶è€Œï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä»…ä»…æœ‰æ—¥å¿—æ•°æ®æ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸€å¥—å®Œæ•´çš„ç›‘æ§å’Œå‘Šè­¦ä½“ç³»ï¼Œèƒ½å¤Ÿåœ¨é—®é¢˜å‘ç”Ÿæ—¶ç¬¬ä¸€æ—¶é—´é€šçŸ¥è¿ç»´å›¢é˜Ÿï¼Œåœ¨é¢„ç®—å³å°†è¶…é™æ—¶æå‰é¢„è­¦ï¼Œåœ¨æ¨¡å‹æœåŠ¡å¼‚å¸¸æ—¶åŠæ—¶åˆ‡æ¢ï¼Œä»è€Œä¿éšœæ•´ä¸ª LLM æœåŠ¡çš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</p>
<p>LiteLLM æä¾›äº†å®Œå–„çš„ç›‘æ§å‘Šè­¦è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒä¸ <strong>Slackã€Discordã€Microsoft Teams</strong> ç­‰é€šè®¯å¹³å°é›†æˆï¼Œå®ç°å®æ—¶å‘Šè­¦é€šçŸ¥ï¼›æˆ–è€…åŸºäº <strong>PagerDuty</strong> ç­‰ä¸“ä¸šå‘Šè­¦å¹³å°ï¼Œå®ç° 7x24 å°æ—¶çš„è¿ç»´å“åº”ï¼›åŒæ—¶å®ƒè¿˜æ”¯æŒ <strong>Prometheus</strong> æŒ‡æ ‡å¯¼å‡ºï¼Œå¯ä»¥ä¸ <strong>Grafana</strong> ç­‰ç›‘æ§å¹³å°æ„å»ºä¼ä¸šçº§ç›‘æ§å¤§ç›˜ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥å­¦ä¹ ä¸‹å¦‚ä½•å°† LiteLLM ä¸ç›‘æ§å‘Šè­¦ç³»ç»Ÿé›†æˆï¼Œæ„å»ºä¸€ä¸ªä¸»åŠ¨ã€æ™ºèƒ½çš„è¿ç»´ä½“ç³»ã€‚æˆ‘ä»¬ä¼šä»¥ Slack å’Œ Prometheus ä¸ºä¾‹ï¼Œæ¼”ç¤ºå…·ä½“çš„é›†æˆæ­¥éª¤ï¼Œè®©ä½ çš„ AI åº”ç”¨å…·å¤‡å®Œå–„çš„ç›‘æ§å‘Šè­¦èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-0">å®æˆ˜ Slack å‘Šè­¦é›†æˆ</h2>
<p>ä½œä¸ºå…¨çƒæœ€å—æ¬¢è¿çš„å›¢é˜Ÿåä½œå¹³å°ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fslack.com%2F" target="_blank" title="https://slack.com/" ref="nofollow noopener noreferrer">Slack</a> å‡­å€Ÿå…¶ä¾¿æ·çš„æ²Ÿé€šä½“éªŒã€çµæ´»çš„é¢‘é“ç®¡ç†èƒ½åŠ›ï¼Œä»¥åŠä¸°å¯Œçš„ç¬¬ä¸‰æ–¹é›†æˆç”Ÿæ€ï¼Œæˆä¸ºäº†å›¢é˜Ÿæ¥æ”¶ã€æµè½¬é‡è¦ä¿¡æ¯çš„æ ¸å¿ƒæ¢çº½ã€‚å°†å‘Šè­¦ç³»ç»Ÿä¸ Slack æ‰“é€šï¼Œæ›´æ˜¯èƒ½ç›´æ¥æ¶ˆé™¤ä¿¡æ¯ä¼ é€’çš„å»¶è¿Ÿå·®ï¼Œç¡®ä¿æŠ€æœ¯å›¢é˜Ÿã€è¿ç»´å›¢é˜Ÿæˆ–ä¸šåŠ¡å›¢é˜Ÿåœ¨ç¬¬ä¸€æ—¶é—´æ•æ‰åˆ°å¼‚å¸¸ä¿¡å·ï¼Œé¿å…å› é€šçŸ¥æ»åå¯¼è‡´çš„é—®é¢˜æ‰©å¤§åŒ–ã€‚</p>
<h3 data-id="heading-1">åˆ›å»º Slack Webhook</h3>
<p>LiteLLM é€šè¿‡ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.slack.dev%2Fmessaging%2Fsending-messages-using-incoming-webhooks%2F" target="_blank" title="https://docs.slack.dev/messaging/sending-messages-using-incoming-webhooks/" ref="nofollow noopener noreferrer">Slack Webhooks</a> å‘ Slack é¢‘é“å‘é€æ¶ˆæ¯ï¼Œä»è€Œå®ç°å‘Šè­¦åŠŸèƒ½ã€‚é¦–å…ˆæˆ‘ä»¬<a href="https://link.juejin.cn?target=https%3A%2F%2Fslack.com%2Fget-started" target="_blank" title="https://slack.com/get-started" ref="nofollow noopener noreferrer">è®¿é—® Slack é¡µé¢</a>ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ Slack å·¥ä½œåŒºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d40674eab9194d4abc9034b84d3c618d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765239598&amp;x-signature=f9sFgaSa5pZhUcrM29sRG4BvqA0%3D" alt="slack-create-workspace.png" loading="lazy"/></p>
<p>å¦‚æœä½ å·²æœ‰å·¥ä½œåŒºï¼Œå¯è·³è¿‡æ­¤æ­¥ã€‚æˆ‘è¿™é‡Œä¸ºæ–¹ä¾¿æ¼”ç¤ºï¼Œåˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>litellm-test</code> çš„å·¥ä½œåŒºï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>å‘Šè­¦æµ‹è¯•</code> çš„æ–°é¢‘é“ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c8e4c58eaac4f948b032574cd4eae86~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765239598&amp;x-signature=59QyvoPiqa0sFvdJ%2BWf%2BxwlyCcM%3D" alt="slack-create-workspace-done.png" loading="lazy"/></p>
<p>ç„¶åè®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.slack.com%2Fapps" target="_blank" title="https://api.slack.com/apps" ref="nofollow noopener noreferrer">Slack çš„åº”ç”¨é¡µé¢</a>ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25a148c3d4c24355b9609abeca0d063e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765239598&amp;x-signature=31fRzb8bc5fMyJ7%2Bc6zeyPQK6fQ%3D" alt="slack-apps.png" loading="lazy"/></p>
<p>ç‚¹å‡» â€œCreate an Appâ€ åˆ›å»ºä¸€ä¸ªåä¸º <code>litellm-alert</code> çš„åº”ç”¨ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1260c97e5e145ea9227cc774bab4ba7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765239598&amp;x-signature=LikTHla1IbqLXlUif3AAHOpydnQ%3D" alt="slack-create-an-app.png" loading="lazy"/></p>
<p>åˆ›å»ºæˆåŠŸåè¿›å…¥è¯¥åº”ç”¨çš„é…ç½®é¡µé¢ï¼Œæˆ‘ä»¬åœ¨å·¦ä¾§èœå•é€‰æ‹© â€œIncoming Webhooksâ€ï¼Œç‚¹å‡» â€œActivate Incoming Webhooksâ€ å¯ç”¨ Webhook åŠŸèƒ½ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ccebf83b011744ac8a48893dde910deb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765239598&amp;x-signature=F6CJdoAK4NvHu%2BbiI1%2FPx9DmdlY%3D" alt="slack-app-webhooks.png" loading="lazy"/></p>
<p>ç„¶åç‚¹å‡» â€œAdd New Webhookâ€ æŒ‰é’®ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ Webhook å¹¶å°†å…¶å…³è”åˆ°å·¥ä½œåŒºçš„ â€œå‘Šè­¦æµ‹è¯•â€ é¢‘é“ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe7ee1e10e194148bbb58cb7b5ea296c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765239598&amp;x-signature=IJ%2BsEqkYUBTp%2BXRV0s5W1B05eQ0%3D" alt="slack-app-add-webhook.png" loading="lazy"/></p>
<p>è¿™æ—¶å°±ä¼šç”Ÿæˆä¸€ä¸ª Webhook é“¾æ¥ï¼Œç‚¹å‡» â€œCopyâ€ æŒ‰é’®è¿›è¡Œå¤åˆ¶ã€‚</p>
<h3 data-id="heading-2">é…ç½® LiteLLM</h3>
<p>æ¥ä¸‹æ¥ä¿®æ”¹ LiteLLM çš„é…ç½®ï¼Œå¼€å¯ Slack å‘Šè­¦åŠŸèƒ½ã€‚é¦–å…ˆé…ç½®ç¯å¢ƒå˜é‡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">export</span> SLACK_WEBHOOK_URL=<span class="hljs-string">"https://hooks.slack.com/services/aaa/bbb/ccc"</span>
</code></pre>
<p>ç„¶åä¿®æ”¹ <code>config.yaml</code> é…ç½®æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">general_settings:</span>
  <span class="hljs-comment"># å¯ç”¨ Slack å‘Šè­¦</span>
  <span class="hljs-attr">alerting:</span> [<span class="hljs-string">"slack"</span>]
  <span class="hljs-comment"># å‘Šè­¦é˜ˆå€¼ï¼ˆç§’ï¼‰- è¯·æ±‚è¶…è¿‡ 5 åˆ†é’Ÿè§†ä¸ºå¼‚å¸¸</span>
  <span class="hljs-attr">alerting_threshold:</span> <span class="hljs-number">300</span>
  <span class="hljs-comment"># æ¶ˆè´¹æŠ¥å‘Šé¢‘ç‡ï¼ˆå¯é€‰ï¼‰</span>
  <span class="hljs-attr">spend_report_frequency:</span> <span class="hljs-string">"1d"</span>
</code></pre>
<p>é‡å¯ LiteLLM æœåŠ¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ litellm -c config.yaml
</code></pre>
<p>å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æµ‹è¯• Slack è¿æ¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -X GET <span class="hljs-string">'http://127.0.0.1:4000/health/services?service=slack'</span> \
  -H <span class="hljs-string">'Authorization: Bearer sk-1234'</span>
</code></pre>
<p>å¦‚æœé…ç½®æ­£ç¡®ï¼Œä½ åº”è¯¥åœ¨ Slack é¢‘é“çœ‹åˆ°ç±»ä¼¼ä¸‹é¢è¿™æ ·ä¸€æ¡æµ‹è¯•æ¶ˆæ¯ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/412bd0fdc4fa47ccbc4c3f726968b712~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765239598&amp;x-signature=%2Flf%2BvNVYz5c0AbJlJFx92slaYuY%3D" alt="slack-test-message.png" loading="lazy"/></p>
<h3 data-id="heading-3">å‘Šè­¦ç±»å‹</h3>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥åšä¸€äº›çœŸå®çš„å‘Šè­¦æµ‹è¯•äº†ã€‚LiteLLM æ”¯æŒå››å¤§ç±»å‘Šè­¦ç±»å‹ï¼Œè¦†ç›–äº†ç”Ÿäº§ç¯å¢ƒçš„ä¸»è¦ç›‘æ§éœ€æ±‚ï¼š</p>
<p><strong>1. LLM ç›¸å…³å‘Šè­¦</strong></p>
<ul>
<li><strong>LLM API å¼‚å¸¸å‘Šè­¦ï¼ˆ<code>llm_exceptions</code>ï¼‰</strong>ï¼šå½“ LLM API å‡ºç°å¼‚å¸¸æ—¶è§¦å‘å‘Šè­¦</li>
<li><strong>æ…¢å“åº”å‘Šè­¦ï¼ˆ<code>llm_too_slow</code>ï¼‰</strong>ï¼šå½“ LLM å“åº”æ—¶é—´è¶…è¿‡è®¾å®šé˜ˆå€¼æ—¶è§¦å‘å‘Šè­¦</li>
<li><strong>è¯·æ±‚æŒ‚èµ·å‘Šè­¦ï¼ˆ<code>llm_requests_hanging</code>ï¼‰</strong>ï¼šæ£€æµ‹æœªèƒ½å®Œæˆçš„ LLM è¯·æ±‚</li>
<li><strong>éƒ¨ç½²å†·å´å‘Šè­¦ï¼ˆ<code>cooldown_deployment</code>ï¼‰</strong>ï¼šå½“éƒ¨ç½²è¢«ç½®äºå†·å´çŠ¶æ€æ—¶çš„å‘Šè­¦</li>
<li><strong>æ–°æ¨¡å‹æ·»åŠ å‘Šè­¦ï¼ˆ<code>new_model_added</code>ï¼‰</strong>ï¼šé€šè¿‡ <code>/model/new</code> æ¥å£æ·»åŠ æ–°æ¨¡å‹æ—¶çš„é€šçŸ¥</li>
<li><strong>åœæœºå‘Šè­¦ï¼ˆ<code>outage_alerts</code>ï¼‰</strong>ï¼šå½“ç‰¹å®š LLM éƒ¨ç½²é¢ä¸´åœæœºæ—¶çš„å‘Šè­¦</li>
<li><strong>åŒºåŸŸåœæœºå‘Šè­¦ï¼ˆ<code>region_outage_alerts</code>ï¼‰</strong>ï¼šå½“ç‰¹å®š LLM åŒºåŸŸé¢ä¸´åœæœºæ—¶çš„å‘Šè­¦ï¼Œä¾‹å¦‚ <code>us-east-1</code></li>
</ul>
<p><strong>2. é¢„ç®—å’Œæ”¯å‡ºå‘Šè­¦</strong></p>
<ul>
<li><strong>é¢„ç®—å‘Šè­¦ï¼ˆ<code>budget_alerts</code>ï¼‰</strong>ï¼šä¸é¢„ç®—é™åˆ¶æˆ–é˜ˆå€¼ç›¸å…³çš„é€šçŸ¥</li>
<li><strong>æ”¯å‡ºæŠ¥å‘Šï¼ˆ<code>spend_reports</code>ï¼‰</strong>ï¼šè·¨å›¢é˜Ÿæˆ–æ ‡ç­¾çš„å®šæœŸæ”¯å‡ºæŠ¥å‘Š</li>
<li><strong>æ”¯å‡ºè¿½è¸ªå¤±è´¥å‘Šè­¦ï¼ˆ<code>failed_tracking_spend</code>ï¼‰</strong>ï¼šå½“æ”¯å‡ºè¿½è¸ªå¤±è´¥æ—¶çš„å‘Šè­¦</li>
<li><strong>æ¯æ—¥æŠ¥å‘Šï¼ˆ<code>daily_reports</code>ï¼‰</strong>ï¼šæ¯æ—¥æ”¯å‡ºæŠ¥å‘Š</li>
<li><strong>å›é€€æŠ¥å‘Šï¼ˆ<code>fallback_reports</code>ï¼‰</strong>ï¼šLLM å›é€€å‘ç”Ÿæƒ…å†µçš„å‘¨æŠ¥</li>
</ul>
<p><strong>3. æ•°æ®åº“å‘Šè­¦</strong></p>
<ul>
<li><strong>æ•°æ®åº“å¼‚å¸¸å‘Šè­¦ï¼ˆ<code>db_exceptions</code>ï¼‰</strong>ï¼šæ•°æ®åº“ç›¸å…³å¼‚å¸¸çš„é€šçŸ¥</li>
</ul>
<p><strong>4. ç®¡ç†ç«¯ç‚¹å‘Šè­¦</strong> - è™šæ‹Ÿå¯†é’¥ã€å›¢é˜Ÿã€å†…éƒ¨ç”¨æˆ·</p>
<ul>
<li><strong>æ–°è™šæ‹Ÿå¯†é’¥åˆ›å»ºå‘Šè­¦ï¼ˆ<code>new_virtual_key_created</code>ï¼‰</strong>ï¼šåˆ›å»ºæ–°è™šæ‹Ÿå¯†é’¥æ—¶çš„é€šçŸ¥</li>
<li><strong>è™šæ‹Ÿå¯†é’¥æ›´æ–°å‘Šè­¦ï¼ˆ<code>virtual_key_updated</code>ï¼‰</strong>ï¼šè™šæ‹Ÿå¯†é’¥è¢«ä¿®æ”¹æ—¶çš„å‘Šè­¦</li>
<li><strong>è™šæ‹Ÿå¯†é’¥åˆ é™¤å‘Šè­¦ï¼ˆ<code>virtual_key_deleted</code>ï¼‰</strong>ï¼šè™šæ‹Ÿå¯†é’¥è¢«ç§»é™¤æ—¶çš„é€šçŸ¥</li>
<li><strong>æ–°å›¢é˜Ÿåˆ›å»ºå‘Šè­¦ï¼ˆ<code>new_team_created</code>ï¼‰</strong>ï¼šåˆ›å»ºæ–°å›¢é˜Ÿæ—¶çš„å‘Šè­¦</li>
<li><strong>å›¢é˜Ÿæ›´æ–°å‘Šè­¦ï¼ˆ<code>team_updated</code>ï¼‰</strong>ï¼šå›¢é˜Ÿè¯¦æƒ…è¢«ä¿®æ”¹æ—¶çš„é€šçŸ¥</li>
<li><strong>å›¢é˜Ÿåˆ é™¤å‘Šè­¦ï¼ˆ<code>team_deleted</code>ï¼‰</strong>ï¼šå›¢é˜Ÿè¢«åˆ é™¤æ—¶çš„å‘Šè­¦</li>
<li><strong>æ–°å†…éƒ¨ç”¨æˆ·åˆ›å»ºå‘Šè­¦ï¼ˆ<code>new_internal_user_created</code>ï¼‰</strong>ï¼šæ–°å†…éƒ¨ç”¨æˆ·è´¦æˆ·çš„é€šçŸ¥</li>
<li><strong>å†…éƒ¨ç”¨æˆ·æ›´æ–°å‘Šè­¦ï¼ˆ<code>internal_user_updated</code>ï¼‰</strong>ï¼šå†…éƒ¨ç”¨æˆ·è¯¦æƒ…è¢«æ›´æ”¹æ—¶çš„å‘Šè­¦</li>
<li><strong>å†…éƒ¨ç”¨æˆ·åˆ é™¤å‘Šè­¦ï¼ˆ<code>internal_user_deleted</code>ï¼‰</strong>ï¼šå†…éƒ¨ç”¨æˆ·è´¦æˆ·è¢«ç§»é™¤æ—¶çš„é€šçŸ¥</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æ‰‹åŠ¨æŒ‡å®šè¦å¯ç”¨çš„å‘Šè­¦ç±»å‹ï¼ˆå¦‚æœä¸æŒ‡å®šï¼Œå‰ä¸‰ç±»å‘Šè­¦é»˜è®¤æ˜¯å¯ç”¨çš„ï¼Œç®¡ç†ç«¯ç‚¹å‘Šè­¦é»˜è®¤ç¦ç”¨ï¼‰ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">general_settings:</span>
  <span class="hljs-attr">alerting:</span> [<span class="hljs-string">"slack"</span>]
  <span class="hljs-attr">alerting_threshold:</span> <span class="hljs-number">300</span>
  <span class="hljs-comment"># å‘Šè­¦ç±»å‹</span>
  <span class="hljs-attr">alert_types:</span> [
    <span class="hljs-string">"llm_exceptions"</span>,       <span class="hljs-comment"># LLM API å¼‚å¸¸</span>
    <span class="hljs-string">"llm_too_slow"</span>,         <span class="hljs-comment"># å“åº”è¿‡æ…¢</span>
    <span class="hljs-string">"llm_requests_hanging"</span>, <span class="hljs-comment"># è¯·æ±‚æŒ‚èµ·</span>
    <span class="hljs-string">"budget_alerts"</span>,        <span class="hljs-comment"># é¢„ç®—å‘Šè­¦</span>
    <span class="hljs-string">"spend_reports"</span>,        <span class="hljs-comment"># æ”¯å‡ºæŠ¥å‘Š</span>
    <span class="hljs-string">"db_exceptions"</span>,        <span class="hljs-comment"># æ•°æ®åº“å¼‚å¸¸</span>
    <span class="hljs-string">"daily_reports"</span>,        <span class="hljs-comment"># æ¯æ—¥æŠ¥å‘Š</span>
    <span class="hljs-string">"outage_alerts"</span>         <span class="hljs-comment"># åœæœºå‘Šè­¦</span>
  ]
</code></pre>
<p>å¦å¤–ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¿‡å¤šçš„å‘Šè­¦ä¼šå¯¼è‡´ <strong>å‘Šè­¦ç–²åŠ³</strong>ï¼Œé™ä½å›¢é˜Ÿå¯¹é‡è¦å‘Šè­¦çš„å“åº”é€Ÿåº¦ã€‚ä¸ºæ­¤ LiteLLM å®ç°äº†å»é‡å’Œé˜²è½°ç‚¸æœºåˆ¶ï¼Œæ¯”å¦‚ï¼šåŒä¸€ç”¨æˆ·æˆ–å›¢é˜Ÿçš„é¢„ç®—å‘Šè­¦ 24 å°æ—¶å†…åªå‘é€ä¸€æ¬¡ï¼›1 åˆ†é’Ÿå†…çš„å¤šä¸ªåœæœºå‘Šè­¦ä¼šè¢«èšåˆæˆä¸€ä¸ªå‘Šè­¦ï¼›å¯ä»¥é€šè¿‡ä¸‹é¢è¿™äº›å‘Šè­¦å‚æ•°æ¥è¿›è¡Œæ§åˆ¶ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">general_settings:</span>
  <span class="hljs-comment"># å‘Šè­¦å‚æ•°é…ç½®</span>
  <span class="hljs-attr">alerting_args:</span>
    <span class="hljs-attr">daily_report_frequency:</span> <span class="hljs-number">43200</span>    <span class="hljs-comment"># 12 å°æ—¶å‘é€ä¸€æ¬¡æ—¥æŠ¥</span>
    <span class="hljs-attr">report_check_interval:</span> <span class="hljs-number">3600</span>      <span class="hljs-comment"># 1 å°æ—¶æ£€æŸ¥ä¸€æ¬¡æ˜¯å¦éœ€è¦å‘é€æŠ¥å‘Š</span>
    <span class="hljs-attr">budget_alert_ttl:</span> <span class="hljs-number">86400</span>         <span class="hljs-comment"># 24 å°æ—¶å†…ä¸é‡å¤é¢„ç®—å‘Šè­¦</span>
    <span class="hljs-attr">outage_alert_ttl:</span> <span class="hljs-number">60</span>            <span class="hljs-comment"># 1 åˆ†é’Ÿçª—å£èšåˆåœæœºå‘Šè­¦</span>
    <span class="hljs-attr">minor_outage_alert_threshold:</span> <span class="hljs-number">5</span> <span class="hljs-comment"># 5 ä¸ªé”™è¯¯è§¦å‘è½»å¾®å‘Šè­¦</span>
    <span class="hljs-attr">major_outage_alert_threshold:</span> <span class="hljs-number">10</span> <span class="hljs-comment"># 10 ä¸ªé”™è¯¯è§¦å‘ä¸¥é‡å‘Šè­¦</span>
</code></pre>
<h3 data-id="heading-4">å¤šé¢‘é“å‘Šè­¦</h3>
<p>LiteLLM æ”¯æŒä¸ºä¸åŒç±»å‹çš„å‘Šè­¦é…ç½®ä¸åŒçš„é€šçŸ¥é¢‘é“ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">general_settings:</span>
  <span class="hljs-attr">alerting:</span> [<span class="hljs-string">"slack"</span>]
  <span class="hljs-comment"># ä¸ºæ¯ç§å‘Šè­¦ç±»å‹æŒ‡å®šä¸“é—¨çš„ Slack é¢‘é“</span>
  <span class="hljs-attr">alert_to_webhook_url:</span> {
    <span class="hljs-attr">"llm_exceptions":</span> <span class="hljs-string">"https://hooks.slack.com/services/.../llm-alerts"</span>,
    <span class="hljs-attr">"budget_alerts":</span> <span class="hljs-string">"https://hooks.slack.com/services/.../finance-alerts"</span>,
    <span class="hljs-attr">"daily_reports":</span> <span class="hljs-string">"https://hooks.slack.com/services/.../daily-reports"</span>,
    <span class="hljs-attr">"outage_alerts":</span> [
      <span class="hljs-string">"https://hooks.slack.com/services/.../oncall-alerts"</span>,
      <span class="hljs-string">"https://hooks.slack.com/services/.../backup-alerts"</span>
    ]
  }
</code></pre>
<p>è¿™ç§é…ç½®å…è®¸æˆ‘ä»¬ï¼š</p>
<ul>
<li><strong>LLM å¼‚å¸¸</strong>å‘Šè­¦å‘é€åˆ°æŠ€æœ¯å›¢é˜Ÿé¢‘é“</li>
<li><strong>é¢„ç®—å‘Šè­¦</strong>å‘é€åˆ°è´¢åŠ¡ç®¡ç†é¢‘é“</li>
<li><strong>æ¯æ—¥æŠ¥å‘Š</strong>å‘é€åˆ°ç®¡ç†å±‚é¢‘é“</li>
<li><strong>åœæœºå‘Šè­¦</strong>åŒæ—¶å‘é€åˆ°å¤šä¸ªå€¼ç­é¢‘é“</li>
</ul>
<h3 data-id="heading-5">å…¼å®¹å…¶ä»–å¹³å°</h3>
<p>LiteLLM çš„ Slack é›†æˆåŒæ ·æ”¯æŒ Discord å’Œ Microsoft Teamsï¼ˆå®ƒä»¬ä¸¤éƒ½å…¼å®¹ Slack çš„ Webhook æ ¼å¼ï¼‰ï¼š</p>
<p><strong>Discord é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Discord Webhook éœ€è¦åœ¨ URL åæ·»åŠ  /slack</span>
<span class="hljs-built_in">export</span> SLACK_WEBHOOK_URL=<span class="hljs-string">"https://discord.com/api/webhooks/1240.../cTLWt5A.../slack"</span>
</code></pre>
<p><strong>Microsoft Teams é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># MS Teams æä¾› Slack å…¼å®¹çš„ Webhook</span>
<span class="hljs-built_in">export</span> SLACK_WEBHOOK_URL=<span class="hljs-string">"https://outlook.office.com/webhook/...IncomingWebhook/..."</span>
</code></pre>
<p>åªéœ€ä¿®æ”¹ Webhook URL å³å¯ï¼Œé…ç½®æ–‡ä»¶ä¿æŒä¸å˜ã€‚</p>
<h2 data-id="heading-6">å®æˆ˜ Prometheus ç›‘æ§é›†æˆ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fprometheus.io%2F" target="_blank" title="https://prometheus.io/" ref="nofollow noopener noreferrer">Prometheus</a> æ˜¯ä¸€ä¸ªå¼€æºçš„ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿï¼Œæœ€åˆç”± SoundCloud å¼€å‘ã€‚å®ƒå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>æ—¶é—´åºåˆ—æ•°æ®åº“</strong>ï¼šä¸“ä¸ºç›‘æ§æ•°æ®è®¾è®¡çš„é«˜æ€§èƒ½å­˜å‚¨</li>
<li><strong>Pull æ¨¡å¼</strong>ï¼šä¸»åŠ¨æ‹‰å–ç›®æ ‡æœåŠ¡çš„æŒ‡æ ‡æ•°æ®</li>
<li><strong>å¼ºå¤§çš„æŸ¥è¯¢è¯­è¨€</strong>ï¼šPromQL æ”¯æŒå¤æ‚çš„æ•°æ®åˆ†æå’Œèšåˆ</li>
<li><strong>å‘Šè­¦ç®¡ç†</strong>ï¼šä¸ Alertmanager é›†æˆå®ç°çµæ´»çš„å‘Šè­¦è§„åˆ™</li>
<li><strong>ç”Ÿæ€å®Œæ•´</strong>ï¼šä¸ Grafana ç­‰å¯è§†åŒ–å·¥å…·æ— ç¼é›†æˆ</li>
</ul>
<p>ç›®å‰ Prometheus å·²ç»æ˜¯äº‘åŸç”Ÿç›‘æ§çš„äº‹å®æ ‡å‡†ï¼ŒLiteLLM çš„ä¼ä¸šç‰ˆæœ¬æä¾›äº† Prometheus é›†æˆèƒ½åŠ›ã€‚</p>
<h3 data-id="heading-7">é…ç½® Prometheus å›è°ƒ</h3>
<p>é¦–å…ˆå®‰è£…å¿…è¦çš„ä¾èµ–ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ pip install prometheus_client==0.20.0
</code></pre>
<p>ç„¶ååœ¨é…ç½®æ–‡ä»¶ä¸­å¯ç”¨ Prometheus å›è°ƒï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">litellm_settings:</span>
  <span class="hljs-attr">callbacks:</span> [<span class="hljs-string">"prometheus"</span>]  <span class="hljs-comment"># å¯ç”¨ Prometheus æŒ‡æ ‡</span>
</code></pre>
<p>é‡å¯ LiteLLM æœåŠ¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ litellm -c config.yaml
</code></pre>
<p>ç°åœ¨è®¿é—® <code>http://localhost:4000/metrics</code> å°±å¯ä»¥çœ‹åˆ° Prometheus æ ¼å¼çš„æŒ‡æ ‡æ•°æ®ã€‚ç›®å‰æŒ‡æ ‡æ•°æ®è¿˜æ˜¯ç©ºçš„ï¼Œå¯ä»¥å‘é€å‡ ä¸ªæµ‹è¯•è¯·æ±‚åå†çœ‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -X POST <span class="hljs-string">'http://127.0.0.1:4000/chat/completions'</span> \
  -H <span class="hljs-string">'Authorization: Bearer sk-1234'</span> \
  -H <span class="hljs-string">'Content-Type: application/json'</span> \
  -d <span class="hljs-string">'{
    "model": "gpt-4o",
    "messages": [{"role": "user", "content": "ç»™æˆ‘è®²ä¸ªç¬‘è¯"}]
  }'</span>
</code></pre>
<h3 data-id="heading-8">æŒ‡æ ‡è¯¦è§£</h3>
<p>LiteLLM æä¾›çš„æŒ‡æ ‡å¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªä¸»è¦ç±»åˆ«ï¼š</p>
<h4 data-id="heading-9">1. ä»£ç†æœåŠ¡æŒ‡æ ‡ï¼ˆProxy Service Metricsï¼‰</h4>
<p>è¿™ç±»æŒ‡æ ‡ä¸»è¦ç›‘æ§ LiteLLM ä»£ç†æœåŠ¡çš„æ•´ä½“è¿è¡ŒçŠ¶å†µå’Œè¯·æ±‚å¤„ç†æƒ…å†µï¼š</p>
<ul>
<li><strong><code>litellm_proxy_total_requests_metric_total</code></strong> (counter)
ä»£ç†æœåŠ¡æ€»è¯·æ±‚æ•° - è·Ÿè¸ªå®¢æˆ·ç«¯å‘ä»£ç†å‘èµ·çš„è¯·æ±‚æ€»é‡</li>
<li><strong><code>litellm_proxy_failed_requests_metric_total</code></strong> (counter)
ä»£ç†æœåŠ¡å¤±è´¥è¯·æ±‚æ•° - å®¢æˆ·ç«¯æœªèƒ½ä»ä»£ç†è·å¾—æˆåŠŸå“åº”çš„è¯·æ±‚æ•°</li>
</ul>
<h4 data-id="heading-10">2. å»¶è¿Ÿæ€§èƒ½æŒ‡æ ‡ï¼ˆLatency &amp; Performance Metricsï¼‰</h4>
<p>è¿™ç±»æŒ‡æ ‡ç”¨äºç›‘æ§è¯·æ±‚å¤„ç†çš„å»¶è¿Ÿæƒ…å†µï¼Œå¸®åŠ©è¯†åˆ«æ€§èƒ½ç“¶é¢ˆï¼š</p>
<ul>
<li><strong><code>litellm_request_total_latency_metric</code></strong> (histogram)
LiteLLM è¯·æ±‚æ€»å»¶è¿Ÿæ—¶é—´ï¼ˆåŒ…å« LiteLLM å¼€é”€ï¼‰</li>
<li><strong><code>litellm_llm_api_latency_metric</code></strong> (histogram)
LLM API è°ƒç”¨å»¶è¿Ÿæ—¶é—´</li>
<li><strong><code>litellm_llm_api_time_to_first_token_metric</code></strong> (histogram)
LLM API é¦–ä¸ª token å“åº”æ—¶é—´ï¼ˆä»…æµå¼è¯·æ±‚ï¼‰</li>
<li><strong><code>litellm_overhead_latency_metric</code></strong> (histogram)
LiteLLM å¤„ç†å¼€é”€å»¶è¿Ÿ</li>
</ul>
<h4 data-id="heading-11">3. æˆæœ¬å’Œä½¿ç”¨é‡æŒ‡æ ‡ï¼ˆCost &amp; Usage Metricsï¼‰</h4>
<p>è¿™ç±»æŒ‡æ ‡è·Ÿè¸ª LLM æœåŠ¡çš„ä½¿ç”¨æˆæœ¬å’Œ token æ¶ˆè´¹æƒ…å†µï¼š</p>
<ul>
<li><strong><code>litellm_spend_metric_total</code></strong> (counter)
LLM è¯·æ±‚æ€»èŠ±è´¹</li>
<li><strong><code>litellm_total_tokens_metric_total</code></strong> (counter)
LLM è¯·æ±‚çš„è¾“å…¥+è¾“å‡º token æ€»æ•°</li>
<li><strong><code>litellm_input_tokens_metric_total</code></strong> (counter)
LLM è¯·æ±‚çš„è¾“å…¥ token æ€»æ•°</li>
<li><strong><code>litellm_output_tokens_metric_total</code></strong> (counter)
LLM è¯·æ±‚çš„è¾“å‡º token æ€»æ•°</li>
</ul>
<h4 data-id="heading-12">4. é¢„ç®—ç®¡ç†æŒ‡æ ‡ï¼ˆBudget Management Metricsï¼‰</h4>
<p>è¿™ç±»æŒ‡æ ‡ç›‘æ§å›¢é˜Ÿå’Œ API å¯†é’¥çš„é¢„ç®—ä½¿ç”¨æƒ…å†µï¼Œæ”¯æŒæˆæœ¬æ§åˆ¶ï¼š</p>
<p><strong>å›¢é˜Ÿé¢„ç®—æŒ‡æ ‡ï¼š</strong></p>
<ul>
<li><strong><code>litellm_remaining_team_budget_metric</code></strong> (gauge)
å›¢é˜Ÿå‰©ä½™é¢„ç®—</li>
<li><strong><code>litellm_team_max_budget_metric</code></strong> (gauge)
å›¢é˜Ÿæœ€å¤§é¢„ç®—è®¾ç½®</li>
<li><strong><code>litellm_team_budget_remaining_hours_metric</code></strong> (gauge)
å›¢é˜Ÿé¢„ç®—é‡ç½®å‰©ä½™æ—¶é—´ï¼ˆå°æ—¶ï¼‰</li>
</ul>
<p><strong>API å¯†é’¥é¢„ç®—æŒ‡æ ‡ï¼š</strong></p>
<ul>
<li><strong><code>litellm_remaining_api_key_budget_metric</code></strong> (gauge)
API å¯†é’¥å‰©ä½™é¢„ç®—</li>
<li><strong><code>litellm_api_key_max_budget_metric</code></strong> (gauge)
API å¯†é’¥æœ€å¤§é¢„ç®—è®¾ç½®</li>
<li><strong><code>litellm_api_key_budget_remaining_hours_metric</code></strong> (gauge)
API å¯†é’¥é¢„ç®—é‡ç½®å‰©ä½™æ—¶é—´ï¼ˆå°æ—¶ï¼‰</li>
</ul>
<h4 data-id="heading-13">5. æµé‡æ§åˆ¶æŒ‡æ ‡ï¼ˆRate Limiting Metricsï¼‰</h4>
<p>è¿™ç±»æŒ‡æ ‡ç›‘æ§åŸºäºæ¨¡å‹çš„è¯·æ±‚å’Œ token é™åˆ¶æƒ…å†µï¼š</p>
<ul>
<li><strong><code>litellm_remaining_api_key_requests_for_model</code></strong> (gauge)
API å¯†é’¥é’ˆå¯¹ç‰¹å®šæ¨¡å‹çš„å‰©ä½™è¯·æ±‚æ•°ï¼ˆåŸºäº RPM é™åˆ¶ï¼‰</li>
<li><strong><code>litellm_remaining_api_key_tokens_for_model</code></strong> (gauge)
API å¯†é’¥é’ˆå¯¹ç‰¹å®šæ¨¡å‹çš„å‰©ä½™ token æ•°ï¼ˆåŸºäº TPM é™åˆ¶ï¼‰</li>
<li><strong><code>litellm_remaining_requests</code></strong> (gauge)
LLM éƒ¨ç½²çš„å‰©ä½™è¯·æ±‚æ•°ï¼ˆæ¥è‡ª LLM API æä¾›å•†ï¼‰</li>
<li><strong><code>litellm_remaining_tokens</code></strong> (gauge)
LLM éƒ¨ç½²çš„å‰©ä½™ token æ•°ï¼ˆæ¥è‡ª LLM API æä¾›å•†ï¼‰</li>
</ul>
<h4 data-id="heading-14">6. éƒ¨ç½²çŠ¶æ€æŒ‡æ ‡ï¼ˆDeployment Analyticsï¼‰</h4>
<p>è¿™ç±»æŒ‡æ ‡ç›‘æ§ LLM éƒ¨ç½²çš„å¥åº·çŠ¶æ€å’Œè¿è¡Œè¡¨ç°ï¼š</p>
<p><strong>éƒ¨ç½²çŠ¶æ€ï¼š</strong></p>
<ul>
<li><strong><code>litellm_deployment_state</code></strong> (gauge)
éƒ¨ç½²çŠ¶æ€ï¼š0=å¥åº·ï¼Œ1=éƒ¨åˆ†æ•…éšœï¼Œ2=å®Œå…¨æ•…éšœ</li>
<li><strong><code>litellm_deployment_cooled_down_total</code></strong> (counter)
éƒ¨ç½²è¢«è´Ÿè½½å‡è¡¡é€»è¾‘å†·å´çš„æ¬¡æ•°</li>
</ul>
<p><strong>è¯·æ±‚ç»Ÿè®¡ï¼š</strong></p>
<ul>
<li><strong><code>litellm_deployment_success_responses_total</code></strong> (counter)
LLM éƒ¨ç½²æˆåŠŸå“åº”æ€»æ•°</li>
<li><strong><code>litellm_deployment_failure_responses_total</code></strong> (counter)
LLM éƒ¨ç½²å¤±è´¥å“åº”æ€»æ•°</li>
<li><strong><code>litellm_deployment_total_requests_total</code></strong> (counter)
LLM éƒ¨ç½²æ€»è¯·æ±‚æ•°ï¼ˆæˆåŠŸ+å¤±è´¥ï¼‰</li>
</ul>
<p><strong>æ€§èƒ½åˆ†æï¼š</strong></p>
<ul>
<li><strong><code>litellm_deployment_latency_per_output_token</code></strong> (histogram)
æ¯ä¸ªè¾“å‡º token çš„å»¶è¿Ÿæ—¶é—´</li>
</ul>
<h4 data-id="heading-15">7. å›é€€æœºåˆ¶æŒ‡æ ‡ï¼ˆFallback Metricsï¼‰</h4>
<p>è¿™ç±»æŒ‡æ ‡ç›‘æ§ä¸»è¦æ¨¡å‹å¤±è´¥æ—¶çš„å›é€€å¤„ç†æƒ…å†µï¼š</p>
<ul>
<li><strong><code>litellm_deployment_successful_fallbacks_total</code></strong> (counter)
æˆåŠŸå›é€€è¯·æ±‚æ•°ï¼ˆä»ä¸»æ¨¡å‹â†’å›é€€æ¨¡å‹ï¼‰</li>
<li><strong><code>litellm_deployment_failed_fallbacks_total</code></strong> (counter)
å¤±è´¥å›é€€è¯·æ±‚æ•°ï¼ˆä»ä¸»æ¨¡å‹â†’å›é€€æ¨¡å‹ï¼‰</li>
</ul>
<h3 data-id="heading-16">è‡ªå®šä¹‰ Metrics æ ‡ç­¾</h3>
<p>LiteLLM æ”¯æŒæ·»åŠ è‡ªå®šä¹‰å…ƒæ•°æ®ä½œä¸º Prometheus æ ‡ç­¾ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">litellm_settings:</span>
  <span class="hljs-attr">callbacks:</span> [<span class="hljs-string">"prometheus"</span>]
  <span class="hljs-comment"># å°†è¯·æ±‚å…ƒæ•°æ®æ·»åŠ ä¸º Prometheus æ ‡ç­¾</span>
  <span class="hljs-attr">custom_prometheus_metadata_labels:</span> [
    <span class="hljs-string">"metadata.environment"</span>,
    <span class="hljs-string">"metadata.service"</span>,
    <span class="hljs-string">"metadata.version"</span>
  ]
</code></pre>
<p>å‘é€å¸¦æœ‰è‡ªå®šä¹‰å…ƒæ•°æ®çš„è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -X POST <span class="hljs-string">'http://localhost:4000/chat/completions'</span> \
  -H <span class="hljs-string">'Authorization: Bearer sk-1234'</span> \
  -H <span class="hljs-string">'Content-Type: application/json'</span> \
  -d <span class="hljs-string">'{
    "model": "gpt-4o",
    "messages": [{"role": "user", "content": "æµ‹è¯•"}],
    "metadata": {
      "environment": "production",
      "service": "chatbot",
      "version": "v1.2.3"
    }
  }'</span>
</code></pre>
<p>ç”Ÿæˆçš„æŒ‡æ ‡å°†åŒ…å«è¿™äº›è‡ªå®šä¹‰çš„æ ‡ç­¾ï¼š</p>
<pre><code class="hljs language-prometheus" lang="prometheus">litellm_total_tokens_metric{
  model="gpt-4o",
  metadata_environment="production",
  metadata_service="chatbot",
  metadata_version="v1.2.3"
} 89
</code></pre>
<blockquote>
<p>ä½¿ç”¨æ­¤åŠŸèƒ½æ—¶éœ€ç‰¹åˆ«å°å¿ƒï¼Œé¿å…ä½¿ç”¨é«˜åŸºæ•°æ ‡ç­¾ï¼ˆæ¯”å¦‚ <code>user_id</code> æˆ– <code>request_id</code> ç­‰ï¼‰ï¼Œå¯èƒ½å¯¼è‡´æŒ‡æ ‡çˆ†ç‚¸ï¼Œé€ æˆæ€§èƒ½é—®é¢˜ã€‚</p>
</blockquote>
<p>å¦ä¸€ç§è‡ªå®šä¹‰æ ‡ç­¾çš„æ–¹å¼æ˜¯é€šè¿‡ <code>custom_prometheus_tags</code> é…ç½®ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">litellm_settings:</span>
  <span class="hljs-attr">callbacks:</span> [<span class="hljs-string">"prometheus"</span>]
  <span class="hljs-comment"># è‡ªå®šä¹‰æ ‡ç­¾</span>
  <span class="hljs-attr">custom_prometheus_tags:</span> [
    <span class="hljs-string">"prod"</span>,
    <span class="hljs-string">"staging"</span>
  ]
</code></pre>
<p>ç„¶åå‘é€å¸¦æ ‡ç­¾çš„è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ curl -X POST <span class="hljs-string">'http://localhost:4000/chat/completions'</span> \
  -H <span class="hljs-string">'Authorization: Bearer sk-1234'</span> \
  -H <span class="hljs-string">'Content-Type: application/json'</span> \
  -d <span class="hljs-string">'{
    "model": "gpt-4o",
    "messages": [{"role": "user", "content": "æµ‹è¯•"}],
    "metadata": {
      "tags": ["prod"]
    }
  }'</span>
</code></pre>
<p>ç”Ÿæˆçš„æŒ‡æ ‡å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-prometheus" lang="prometheus">litellm_total_tokens_metric{
  model="gpt-4o",
  tag_prod="true",
  tag_staging="false"
} 89
</code></pre>
<h3 data-id="heading-17">ä½¿ç”¨ Prometheus é‡‡é›†æŒ‡æ ‡</h3>
<p>åˆ›å»º <code>prometheus.yml</code> é…ç½®æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">global:</span>
  <span class="hljs-attr">scrape_interval:</span> <span class="hljs-string">15s</span>
  <span class="hljs-attr">evaluation_interval:</span> <span class="hljs-string">15s</span>

<span class="hljs-attr">scrape_configs:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">'litellm'</span>
    <span class="hljs-attr">static_configs:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> [<span class="hljs-string">'10.6.120.132:4000'</span>] <span class="hljs-comment"># æ¢æˆä½ çš„ IP åœ°å€</span>
    <span class="hljs-attr">metrics_path:</span> <span class="hljs-string">'/metrics'</span>
    <span class="hljs-attr">scrape_interval:</span> <span class="hljs-string">10s</span>
</code></pre>
<p>ç„¶åä½¿ç”¨ Docker å¯åŠ¨ Prometheus æœåŠ¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ docker run -d \
  --name prometheus \
  -p 9090:9090 \
  -v $(<span class="hljs-built_in">pwd</span>)/prometheus.yml:/etc/prometheus/prometheus.yml \
  prom/prometheus
</code></pre>
<p>è®¿é—® <code>http://localhost:9090</code> è¿›å…¥ Prometheus çš„ Query é¡µé¢ï¼Œè¾“å…¥æŒ‡æ ‡å³å¯æŸ¥è¯¢ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ca83bbc652347d3800b87bbec921032~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765239598&amp;x-signature=8fpfKrBALWhBPbGpO7GCaCU5D4o%3D" alt="prometheus-query.png" loading="lazy"/></p>
<p>ç‚¹å‡» â€œGraphâ€ ä»¥å›¾çš„å½¢å¼æŸ¥çœ‹æŒ‡æ ‡ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db5c05e313c645a5adc5c397ccf5c27e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pel5Lmg5LiA5oqA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765239598&amp;x-signature=YN2RZy49n9pgYwOpDICLkcWFR%2Bo%3D" alt="prometheus-query-graph.png" loading="lazy"/></p>
<p>é€šè¿‡ Prometheus é‡‡é›†çš„æŒ‡æ ‡æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥æ›´è¿›ä¸€æ­¥ï¼ŒåŸºäº Grafana æ„å»ºä¸€ä¸ªå®Œæ•´çš„ LiteLLM ç›‘æ§å¤§ç›˜ï¼Œå®ç°å¯¹ AI æœåŠ¡çš„å…¨æ–¹ä½è§‚æµ‹ã€‚å¯ä»¥å‚è€ƒ LiteLLM å®˜æ–¹æä¾›çš„ Grafana ä»ªè¡¨ç›˜æ¨¡æ¿ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FBerriAI%2Flitellm%2Ftree%2Fmain%2Fcookbook%2Flitellm_proxy_server%2Fgrafana_dashboard" target="_blank" title="https://github.com/BerriAI/litellm/tree/main/cookbook/litellm_proxy_server/grafana_dashboard" ref="nofollow noopener noreferrer">github.com/BerriAI/litâ€¦</a></li>
</ul>
<p>æ­¤å¤–ï¼ŒPrometheus è¿˜å¯ä»¥å’Œ Alertmanager é›†æˆï¼Œå®ç°æ¯” Slack æ›´çµæ´»çš„å‘Šè­¦è§„åˆ™ã€‚å…·ä½“å†…å®¹å¯ä»¥å‚è€ƒ Alertmanager çš„å®˜æ–¹æ–‡æ¡£ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fprometheus.io%2Fdocs%2Falerting%2Flatest%2Falertmanager%2F" target="_blank" title="https://prometheus.io/docs/alerting/latest/alertmanager/" ref="nofollow noopener noreferrer">prometheus.io/docs/alertiâ€¦</a></li>
</ul>
<h2 data-id="heading-18">å°ç»“</h2>
<p>ä»Šå¤©æˆ‘ä»¬æ·±å…¥å­¦ä¹ äº† LiteLLM çš„ç›‘æ§å‘Šè­¦ç³»ç»Ÿï¼Œé‡ç‚¹æŒæ¡äº†ä¸¤ç§é›†æˆæ–¹æ¡ˆï¼š</p>
<ul>
<li><strong>Slack å‘Šè­¦é›†æˆ</strong>ï¼šæä¾›å®æ—¶çš„é€šçŸ¥èƒ½åŠ›ï¼Œæ”¯æŒå¤šç§å‘Šè­¦ç±»å‹å’Œæ™ºèƒ½å»é‡ï¼Œç‰¹åˆ«é€‚åˆå›¢é˜Ÿåä½œå’Œå¿«é€Ÿå“åº”çš„åœºæ™¯</li>
<li><strong>Prometheus ç›‘æ§é›†æˆ</strong>ï¼šåŸºäºæ—¶é—´åºåˆ—æ•°æ®çš„ä¼ä¸šçº§ç›‘æ§æ–¹æ¡ˆï¼Œä¸ Grafana ç»“åˆå¯æ„å»ºå®Œæ•´çš„å¯è§‚æµ‹æ€§å¹³å°ï¼Œæˆ–è€…ä¸ Alertmanager é›†æˆå®ç°æ›´çµæ´»çš„å‘Šè­¦è§„åˆ™</li>
</ul>
<p>é™¤äº†è¿™ä¸¤ç§é›†æˆæ–¹æ¡ˆï¼ŒLiteLLM è¿˜æ”¯æŒ PagerDutyã€é‚®ä»¶ã€Webhook ç­‰å…¶ä»–æ–¹å¼ï¼Œç¯‡å¹…æœ‰é™ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚</p>
<p>ç›‘æ§å‘Šè­¦ç³»ç»Ÿæ˜¯ç”Ÿäº§ç¯å¢ƒçš„ç¥ç»ç³»ç»Ÿï¼Œå®ƒè®©æˆ‘ä»¬èƒ½å¤Ÿæ„ŸçŸ¥ç³»ç»Ÿçš„æ¯ä¸€ä¸ªå˜åŒ–ï¼ŒåŠæ—¶å“åº”æ¯ä¸€ä¸ªé—®é¢˜ã€‚å¸Œæœ›é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œä½ èƒ½å¤Ÿå»ºç«‹èµ·ç¨³å®šå¯é çš„ LiteLLM ç›‘æ§å‘Šè­¦ä½“ç³»ï¼Œä¸ºç”¨æˆ·æä¾›æ›´å¥½çš„ AI æœåŠ¡ä½“éªŒã€‚</p>
<h2 data-id="heading-19">æ¬¢è¿å…³æ³¨</h2>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„åŒåå…¬ä¼—å·ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fi-study-everyday.online%2Fabout-me.html" target="_blank" title="https://i-study-everyday.online/about-me.html" ref="nofollow noopener noreferrer">æ—¥ä¹ ä¸€æŠ€ï¼Œæ¯å¤©å­¦ä¸€ç‚¹æ–°æŠ€æœ¯</a>ã€‚</p>
<p>æˆ‘ä¼šæ¯å¤©èŠ±ä¸€ä¸ªå°æ—¶ï¼Œè®°å½•ä¸‹æˆ‘å­¦ä¹ çš„ç‚¹ç‚¹æ»´æ»´ã€‚å†…å®¹åŒ…æ‹¬ä½†ä¸é™äºï¼š</p>
<ul>
<li>æŸä¸ªäº§å“çš„ä½¿ç”¨å°çªé—¨</li>
<li>å¼€æºé¡¹ç›®çš„å®è·µå’Œå¿ƒå¾—</li>
<li>æŠ€æœ¯ç‚¹çš„ç®€å•è§£è¯»</li>
</ul>
<p>ç›®æ ‡æ˜¯è®©å¤§å®¶ç”¨5åˆ†é’Ÿè¯»å®Œå°±èƒ½æœ‰æ‰€æ”¶è·ï¼Œä¸éœ€è¦å¤ªè´¹åŠ²ï¼Œä½†å´å¯ä»¥è½»æ¾è·å–ä¸€äº›å¹²è´§ã€‚ä¸ç®¡ä½ æ˜¯æŠ€æœ¯æ–°æ‰‹è¿˜æ˜¯è€é¸Ÿï¼Œæ¬¢è¿ç»™æˆ‘æå»ºè®®ï¼Œå¦‚æœæœ‰æƒ³å­¦ä¹ çš„æŠ€æœ¯ï¼Œä¹Ÿæ¬¢è¿äº¤æµï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Chatboxæ”¯æŒæ¥å…¥LangGraphæ™ºèƒ½ä½“ï¼Ÿä¸€åˆ‡éƒ½é Trae Solo!]]></title>    <link>https://juejin.cn/post/7578700798744903714</link>    <guid>https://juejin.cn/post/7578700798744903714</guid>    <pubDate>2025-12-02T00:27:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578700798744903714" data-draft-id="7578724773992775706" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Chatboxæ”¯æŒæ¥å…¥LangGraphæ™ºèƒ½ä½“ï¼Ÿä¸€åˆ‡éƒ½é Trae Solo!"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,Trae,Agent"/> <meta itemprop="datePublished" content="2025-12-02T00:27:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹çœŸå¥½ç©"/> <meta itemprop="url" content="https://juejin.cn/user/3140624091453053"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Chatboxæ”¯æŒæ¥å…¥LangGraphæ™ºèƒ½ä½“ï¼Ÿä¸€åˆ‡éƒ½é Trae Solo!
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3140624091453053/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹çœŸå¥½ç©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T00:27:12.000Z" title="Tue Dec 02 2025 00:27:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä½œä¸ºå¤§æ¨¡å‹æ™ºèƒ½ä½“åº”ç”¨å¼€å‘è€…ï¼Œç¬”è€…é•¿æœŸä½¿ç”¨ LangChain ä¸ LangGraph æ¡†æ¶å¼€å‘å„ç±»æ™ºèƒ½ä½“ï¼Œå¹¶é€šè¿‡ä¸“æ <a href="https://juejin.cn/column/7526240014499495972" title="https://juejin.cn/column/7526240014499495972" target="_blank">LangChain/LangGraphç³»åˆ—æ•™ç¨‹</a>ä¸å¤§å®¶åˆ†äº«ç›¸å…³ç»éªŒã€‚ç„¶è€Œï¼Œå¼€å‘å®Œæˆçš„æ™ºèƒ½ä½“å¾€å¾€é¢ä¸´ä¸€ä¸ªå®é™…æŒ‘æˆ˜ï¼šç›´æ¥éƒ¨ç½²å¹¶ä½¿ç”¨å®ƒä»¬å¹¶ä¸æ€»æ˜¯ä¾¿æ·ã€‚ä¾‹å¦‚ï¼ŒLangChainå®˜æ–¹æ¨èçš„ agent-chat-ui é€šå¸¸éœ€è¦é¢å¤–å¯åŠ¨æœåŠ¡ï¼Œè¿‡ç¨‹ç¨æ˜¾ç¹çã€‚è€Œç¬”è€…æ—¥å¸¸ä¹ æƒ¯ä½¿ç”¨ Chatbox å®¢æˆ·ç«¯ä¸å¤§æ¨¡å‹äº¤äº’ï¼Œè¿™è®©ç¬”è€…ä¸ç¦æ€è€ƒï¼šèƒ½å¦é€šè¿‡ FastAPI å°†æ™ºèƒ½ä½“å°è£…ä¸ºæœåŠ¡ï¼Œå¹¶é€šè¿‡ Chatbox ç›´æ¥è¿æ¥ï¼Œä»è€Œå®ç°æ›´è½»é‡ã€å¿«é€Ÿçš„è°ƒç”¨ï¼Ÿ</p>
<p>è¿™ä¸ªæƒ³æ³•è™½ç„¶ç›´æ¥ï¼Œä»£ç é‡ä¹Ÿä¸å¤šã€‚ä½†åœ¨å¦‚ä»Šå¤§æ¨¡å‹è¾…åŠ©ç¼–ç¨‹çš„æ—¥å¸¸ä¸­ï¼ŒåŠ¨æ‰‹å®ç°çš„éœ€æ±‚ä¼¼ä¹æ€»è¢«â€œäº¤ç»™ AI æ¥å®Œæˆâ€ï¼ˆå½’æ ¹ç»“åº•ç¨‹åºå‘˜å˜æ‡’äº†ï¼‰ã€‚æ­£å·§ï¼Œæœ€è¿‘çœ‹åˆ°å­—èŠ‚è·³åŠ¨çš„ Trae æ¨å‡ºäº†â€œSolo æ¨¡å¼â€ï¼Œå®ƒè¢«ç§°ä¸ºâ€œå›½äº§ Cursorâ€ï¼Œæ°å¥½ä¸ºç¬”è€…æä¾›äº†éªŒè¯çš„æœºä¼šâ€”â€”æ˜¯å¦èƒ½å¤Ÿå€ŸåŠ© Trae Soloï¼Œè‡ªåŠ¨ã€é«˜æ•ˆåœ°å®Œæˆè¿™ä¸ªä»æƒ³æ³•åˆ°å¯è¿è¡ŒæœåŠ¡çš„è¿‡ç¨‹ï¼Ÿ</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4fbc968b2649486780731ed6f8573aa4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765240253&amp;x-signature=sOLj73c3IzZFo0XY1u41sr1Uxg4%3D" alt="1.png" width="70%" loading="lazy"/></p>
<h2 data-id="heading-1">ä¸€ã€Chatbox ä¸ Trae ç®€ä»‹</h2>
<h3 data-id="heading-2">1.1 Chatboxï¼šè·¨å¹³å° AI å®¢æˆ·ç«¯</h3>
<p>Chatbox æ˜¯ä¸€æ¬¾åŠŸèƒ½å…¨é¢çš„è·¨å¹³å° AI å®¢æˆ·ç«¯ï¼Œæ”¯æŒ Windowsã€macOSç­‰ä¸»æµæ“ä½œç³»ç»Ÿã€‚å®ƒé‡‡ç”¨ OpenAI å…¼å®¹çš„ API è°ƒç”¨æ–¹å¼ï¼Œèƒ½å¤Ÿä¾¿æ·åœ°è¿æ¥å¤šç§å¤§æ¨¡å‹ï¼ŒåŒ…æ‹¬ OpenAIã€Claudeã€DeepSeek ç­‰äº‘ç«¯ APIï¼Œä¹Ÿæ”¯æŒæœ¬åœ°vllmã€ollamaéƒ¨ç½²çš„æ¨¡å‹ã€‚å‡­å€Ÿå…¶ç®€æ´çš„ç•Œé¢ä¸ç¨³å®šçš„ä½“éªŒï¼ŒChatbox å·²æˆä¸ºä¼—å¤šå¼€å‘è€…å’ŒAIçˆ±å¥½è€…å¸¸ç”¨çš„å®¢æˆ·ç«¯å·¥å…·ä¹‹ä¸€ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55e31adb260245499672a92f2f70f6c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765240253&amp;x-signature=K6ceMi8f0EHk8mION5Kh8vTnGL8%3D" alt="2.png" width="70%" loading="lazy"/></p>
<h3 data-id="heading-3">1.2 Traeï¼šAI é©±åŠ¨çš„ç¼–ç¨‹åŠ©æ‰‹</h3>
<p>Trae æ˜¯ç”±å­—èŠ‚è·³åŠ¨æ¨å‡ºçš„ AI ç¼–ç¨‹å·¥å…·ï¼Œè¢«è®¸å¤šå¼€å‘è€…ç§°ä¸ºâ€œå›½äº§ Cursorâ€ã€‚å®ƒå·²ç»ä»æœ€åˆçš„ä»£ç ç”ŸæˆåŠ©æ‰‹ï¼Œæ¼”è¿›ä¸ºä¸€ä¸ªæ”¯æŒç«¯åˆ°ç«¯å¼€å‘çš„æ™ºèƒ½å¹³å°ã€‚å…¶æœ€æ–°æ¨å‡ºçš„Â <strong>Solo æ¨¡å¼</strong>ï¼Œå°¤å…¶é€‚åˆå¿«é€Ÿå®ç°æƒ³æ³•ï¼šç”¨æˆ·åªéœ€ç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚ï¼ˆä¾‹å¦‚â€œå¼€å‘ä¸€ä¸ªåœ¨çº¿èƒŒå•è¯åº”ç”¨â€ï¼‰ï¼ŒTrae ä¾¿èƒ½è‡ªä¸»å®Œæˆä»éœ€æ±‚åˆ†æã€ä»£ç ç¼–å†™ã€æµ‹è¯•åˆ°éƒ¨ç½²çš„å®Œæ•´æµç¨‹ã€‚è¿™æ­£å¥½ä¸ºæˆ‘ä»¬â€œæ‡’äºåŠ¨æ‰‹â€ä½†åˆæƒ³å¿«é€ŸéªŒè¯æƒ³æ³•çš„åœºæ™¯ï¼Œæä¾›äº†ç†æƒ³çš„å®éªŒç¯å¢ƒã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a72f2c1a572b48b99bd15c3dca12dcb2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765240253&amp;x-signature=C0aS2fBaixhlDFfFMbD0G0q7toE%3D" alt="3.png" width="70%" loading="lazy"/></p>
<h2 data-id="heading-4">äºŒã€Chatbox æ¥å…¥ LangChain æ™ºèƒ½ä½“çš„åŸºæœ¬æ€è·¯</h2>
<p>Trae Soloèƒ½åŠ›â€œå¹çš„å“â€ï¼Œæ€»ä¸è‡³äºè¿™ä¹ˆä¸ªå°éœ€æ±‚å®ƒæä¸äº†å§ï¼Œåœ¨æµ‹è¯•å®ƒçš„èƒ½åŠ›å‰ç¬”è€…å…ˆè‡ªæˆ‘æ€è€ƒä¸€ä¸‹å¦‚ä½•å®ç°è¿™ä¸ªéœ€æ±‚ï¼Ÿæ ¹æ®Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fchatboxai.app%2Fzh" target="_blank" title="https://chatboxai.app/zh" ref="nofollow noopener noreferrer">Chatbox å®˜æ–¹ä»‹ç»</a>ï¼Œå®ƒä¸»è¦é€šè¿‡å‘èµ·Â <strong>OpenAI API æ ¼å¼</strong>Â çš„è¯·æ±‚æ¥ä¸å„ç±»åç«¯æœåŠ¡é€šä¿¡ï¼Œæ— è®ºæ˜¯ vLLMã€Ollama ç­‰æœ¬åœ°éƒ¨ç½²çš„æ¨¡å‹ï¼Œè¿˜æ˜¯è¿œç¨‹æ‰˜ç®¡çš„æœåŠ¡ã€‚è¿™ä¸ºç¬”è€…æä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„å¯¹æ¥æ ‡å‡†ã€‚</p>
<p>å› æ­¤ï¼Œå°† LangChain/LangGraph æ„å»ºçš„æ™ºèƒ½ä½“æ¥å…¥ Chatbox çš„æ ¸å¿ƒæ€è·¯ä¾¿éå¸¸æ˜ç¡®ï¼š</p>
<ol>
<li><strong>æ„å»ºé€‚é…å±‚</strong>ï¼šä½¿ç”¨ FastAPI ç¼–å†™ä¸€ä¸ªæ ‡å‡†åŒ–æ¥å£ï¼Œæ¥æ”¶æ¥è‡ª Chatbox çš„ OpenAI æ ¼å¼è¯·æ±‚ã€‚</li>
<li><strong>æ ¼å¼è½¬æ¢ä¸è°ƒç”¨</strong>ï¼šå°†è¯¥è¯·æ±‚è§£æå¹¶è½¬åŒ–ä¸º LangChain æ™ºèƒ½ä½“èƒ½å¤„ç†çš„å¯¹è¯æ¶ˆæ¯æ ¼å¼ï¼Œç„¶åè°ƒç”¨æ™ºèƒ½ä½“æ‰§è¡Œã€‚</li>
<li><strong>ç»“æœè¿”å›</strong>ï¼šå°†æ™ºèƒ½ä½“è¿”å›çš„ç»“æœï¼Œé‡æ–°å°è£…æˆç¬¦åˆ OpenAI å“åº”æ ¼å¼çš„æ•°æ®ï¼Œé€šè¿‡ API è¿”å›ç»™ Chatboxã€‚</li>
</ol>
<p>è¿™æ ·ä¸€æ¥ï¼Œå¯¹ Chatbox è€Œè¨€ï¼Œæ™ºèƒ½ä½“æœåŠ¡å°±åƒä¸€ä¸ªå…¼å®¹çš„â€œæ¨¡å‹åç«¯â€ï¼Œå®ç°äº†æ— ç¼æ¥å…¥ã€‚</p>
<h2 data-id="heading-5">ä¸‰ã€ä½¿ç”¨Trae Solo å®Œæˆ å¤©æ°”åŠ©æ‰‹æ™ºèƒ½ä½“çš„æ¥å…¥</h2>
<ol>
<li><strong>å›é¡¾åŸºç¡€æ™ºèƒ½ä½“ä»£ç ï¼š</strong> é¦–å…ˆå›é¡¾ä¸€ä¸‹ä¹‹å‰ç”¨ LangChain 1.0 çš„Â <code>create_react_agent</code>Â ç¼–å†™çš„å¤©æ°”åŠ©æ‰‹æ™ºèƒ½ä½“ã€‚è¿™ä¸ªæ™ºèƒ½ä½“ä½¿ç”¨äº†å¿ƒçŸ¥å¤©æ°”çš„ APIï¼Œä¸ç†Ÿæ‚‰è¿™ä¸ªæœåŠ¡çš„è¯»è€…å¯ä»¥å‚è€ƒç¬”è€…çš„æ–‡ç« ã€Š<a href="https://juejin.cn/post/7486323379474645027" target="_blank" title="https://juejin.cn/post/7486323379474645027">ä»0åˆ°1å¼€å‘DeepSeekå¤©æ°”åŠ©æ‰‹æ™ºèƒ½ä½“â€”â€”ä½ ä»¥ä¸ºå¤§æ¨¡å‹åªä¼šèŠå¤©ï¼ŸFunction Callingè®©å®ƒ"ä¸Šå¤©å…¥åœ°"</a>ã€‹è¿›è¡Œæ³¨å†Œã€‚å…³äº LangChain 1.0 æ™ºèƒ½ä½“å¼€å‘çš„åŸºç¡€çŸ¥è¯†ï¼Œå¯å‚é˜…ã€Š<a href="https://juejin.cn/post/7568698787779723298" target="_blank" title="https://juejin.cn/post/7568698787779723298">LangChain1.0é€Ÿé€šæŒ‡å—ï¼ˆäºŒï¼‰â€”â€”LangChain1.0 create_agent api åŸºç¡€çŸ¥è¯†</a>ã€‹ã€‚</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> init_chat_model
<span class="hljs-keyword">from</span> langchain.tools <span class="hljs-keyword">import</span> tool
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> create_agent
<span class="hljs-keyword">from</span> langgraph.config <span class="hljs-keyword">import</span> get_stream_writer

<span class="hljs-meta">@tool(<span class="hljs-params">args_schema=WeatherQuery</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather</span>(<span class="hljs-params">loc</span>):
    <span class="hljs-string">"""
        æŸ¥è¯¢å³æ—¶å¤©æ°”å‡½æ•°
        :param loc: å¿…è¦å‚æ•°ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºæŸ¥è¯¢å¤©æ°”çš„å…·ä½“åŸå¸‚åç§°ï¼Œ\
        :returnï¼šå¿ƒçŸ¥å¤©æ°” APIæŸ¥è¯¢å³æ—¶å¤©æ°”çš„ç»“æœï¼Œå…·ä½“URLè¯·æ±‚åœ°å€ä¸ºï¼š"https://api.seniverse.com/v3/weather/now.json"
        è¿”å›ç»“æœå¯¹è±¡ç±»å‹ä¸ºè§£æä¹‹åçš„JSONæ ¼å¼å¯¹è±¡ï¼Œå¹¶ç”¨å­—ç¬¦ä¸²å½¢å¼è¿›è¡Œè¡¨ç¤ºï¼Œå…¶ä¸­åŒ…å«äº†å…¨éƒ¨é‡è¦çš„å¤©æ°”ä¿¡æ¯
    """</span>
    url = <span class="hljs-string">"https://api.seniverse.com/v3/weather/now.json"</span>
    params = {
        <span class="hljs-string">"key"</span>: <span class="hljs-string">"ä½ æ³¨å†Œçš„å¿ƒçŸ¥å¤©æ°”api key"</span>,
        <span class="hljs-string">"location"</span>: loc,
        <span class="hljs-string">"language"</span>: <span class="hljs-string">"zh-Hans"</span>,
        <span class="hljs-string">"unit"</span>: <span class="hljs-string">"c"</span>,
    }
    response = requests.get(url, params=params)
    temperature = response.json()
    <span class="hljs-keyword">return</span> temperature[<span class="hljs-string">'results'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'now'</span>]

SYSTEM_PROMPT = <span class="hljs-string">"ä½ æ˜¯ä¸€åå¯çˆ±çš„å¤©æ°”é¢„æŠ¥æ’­æŠ¥å‘˜ï¼Œå¯ä»¥æ¨¡ä»¿æ—å¿—ç²çš„è¯­æ°”æ’­æŠ¥å¤©æ°”ï¼Œå…·å¤‡è°ƒç”¨get_weatherå¤©æ°”å‡½æ•°è·å–æŒ‡å®šåœ°ç‚¹å¤©æ°”çš„èƒ½åŠ›"</span>

model = init_chat_model(
    model=<span class="hljs-string">"deepseek-chat"</span>,
    base_url=<span class="hljs-string">"https://api.deepseek.com"</span>,
    api_key=<span class="hljs-string">"ä½ æ³¨å†Œçš„deepseek api key"</span>
)

agent = create_agent(
    model=model,
    tools=[get_weather],
    system_prompt=SYSTEM_PROMPT
)
</code></pre>
<ol start="2">
<li><strong>ä¸‹è½½å¹¶å®‰è£… Traeï¼š</strong> å‰å¾€Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.trae.cn%2F" target="_blank" title="https://www.trae.cn/" ref="nofollow noopener noreferrer">Trae å®˜ç½‘</a>Â ä¸‹è½½å®‰è£…åŒ…ã€‚ç›®å‰ Trae å›½å†…ç‰ˆå·²å…¨é¢ä¸Šçº¿ SOLO æ¨¡å¼ã€‚Windows å¹³å°çš„å®‰è£…éå¸¸ç®€å•ï¼Œåªéœ€ä¸€è·¯ç‚¹å‡»"ä¸‹ä¸€æ­¥"å³å¯å®Œæˆã€‚å®‰è£…å®Œæˆåæ‰“å¼€ Traeï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼ VS Code çš„ç•Œé¢é£æ ¼ã€‚é»˜è®¤è¿›å…¥çš„æ˜¯Â <strong>Build æ¨¡å¼</strong>ï¼Œè¿™ç±»ä¼¼äºç¬”è€…åœ¨æ–‡ç« ã€Š<a href="https://juejin.cn/post/7475973902658027531" target="_blank" title="https://juejin.cn/post/7475973902658027531">é›¶é—¨æ§›ï¼æ‰‹æŠŠæ‰‹æ•™ä½ ç”¨VS Code + DeepSeek ç©è½¬AIç¼–ç¨‹ï¼ï¼ˆ5åˆ†é’Ÿç¼–å†™éƒ¨ç½²ä¸ªäººç½‘ç«™ï¼‰</a>ã€‹ä¸­ä½¿ç”¨çš„ VS Code Cline æ’ä»¶ï¼Œå¯ä»¥é€šè¿‡ä¸ AI åŠ©æ‰‹å¯¹è¯è¾…åŠ©ç¼–å†™ä»£ç ã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/856bd24da137485da6e3ab13677e37b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765240253&amp;x-signature=waQ5k4DPxNrZVQi7qHS51CG0C8U%3D" alt="4.png" loading="lazy"/></p>
<ol start="3">
<li><strong>åˆ‡æ¢åˆ° SOLO æ¨¡å¼ï¼š</strong> ä»Šå¤©ç¬”è€…è¦ä½“éªŒçš„æ˜¯æ›´å¼ºå¤§çš„Â <strong>SOLO æ¨¡å¼</strong>ã€‚ç‚¹å‡»å·¦ä¸Šè§’çš„ IDE æ ‡ç­¾å³å¯åˆ‡æ¢åˆ°è¯¥æ¨¡å¼ï¼Œå®ƒèƒ½å®ç°æ›´é«˜ç¨‹åº¦çš„å¼€å‘è‡ªåŠ¨åŒ–ã€‚SOLO æ¨¡å¼ç±»ä¼¼äºç¬”è€…åœ¨ã€Š<a href="https://juejin.cn/post/7574615024293429274" target="_blank" title="https://juejin.cn/post/7574615024293429274">Gemini3.0æ·±åº¦è§£æï¼Œå®ƒåœ¨é‡æ–°å®šä¹‰æ™ºèƒ½</a>ã€‹ä¸€æ–‡ä¸­æåˆ°çš„ Vibe ç¼–ç¨‹æ¦‚å¿µï¼šç”¨æˆ·åªéœ€ç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚ï¼ˆä¾‹å¦‚"å¼€å‘ä¸€ä¸ªåœ¨çº¿èƒŒå•è¯åº”ç”¨"ï¼‰ï¼ŒAI å°±èƒ½è‡ªä¸»å®Œæˆä»éœ€æ±‚åˆ†æã€ç¼–ç ã€æµ‹è¯•åˆ°éƒ¨ç½²çš„å…¨æµç¨‹ã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24640a2c0a0945fe8284788639fcb6d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765240253&amp;x-signature=GGcssYmllOEt5d73u1CW9PUkkTA%3D" alt="5.png" loading="lazy"/></p>
<ol start="4">
<li><strong>ç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚ï¼š</strong> åœ¨ SOLO Coder å¯¹è¯æ¡†ä¸­è¾“å…¥ä»¥ä¸‹æç¤ºè¯ï¼š</li>
</ol>

<pre><code class="hljs">ä½ æ˜¯ä¸€åpythonç¼–ç¨‹ä¸“å®¶ï¼Œç†Ÿç»ƒæŒæ¡langchain1.0å¼€å‘æ™ºèƒ½ä½“, fastapiç¼–å†™æ¥å£çš„èƒ½åŠ›ï¼Œå¯ä»¥æ»¡è¶³ç”¨æˆ·æå‡ºçš„ä»»ä½•éœ€æ±‚ã€‚ç°åœ¨é¡¹ç›®ä¸­çš„langchain_weather.pyæ–‡ä»¶ä¸­åŒ…å«ä¸€ä¸ªå¤©æ°”åŠ©æ‰‹çš„æ™ºèƒ½ä½“ï¼Œæˆ‘å¸Œæœ›ä½¿ç”¨fastapiç¼–å†™openai é£æ ¼çš„æ¥å£ï¼Œæ³¨æ„éœ€è¦ä½¿ç”¨æµå¼æ¥å£ã€‚ä½¿è¯¥æ™ºèƒ½ä½“å¯ä»¥è¢«chatboxç­‰å®¢æˆ·ç«¯ä»¥apiæ ¼å¼æ¥å…¥ï¼Œè¯·å®ç°æˆ‘çš„éœ€æ±‚å¹¶æœ¬åœ°å¯åŠ¨æ¥å£ï¼Œè¯·å®Œæˆæˆ‘çš„éœ€æ±‚
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4874589ce4214d7c911ad2af1ca73ee5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765240253&amp;x-signature=szKxbU7Oxi95MdVqlZwEfvW5shA%3D" alt="7.png" loading="lazy"/></p>
<ol start="5">
<li>
<p><strong>è§‚å¯Ÿ Trae Solo çš„è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹ï¼š</strong> æŒ‰ä¸‹å›è½¦é”®åï¼ŒTrae Solo å¼€å§‹è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡ï¼š</p>
<ul>
<li><strong>æ™ºèƒ½åˆ†æ</strong>ï¼šé¦–å…ˆåˆ†æÂ <code>langchain_weather.py</code>Â æºæ–‡ä»¶ï¼Œå¹¶è¯†åˆ«å‡ºäº†ä»£ç ä¸­çš„ä¸€ä¸ª Bugâ€”â€”æœªå®šä¹‰Â <code>WeatherQuery</code>Â ç±»å‹ã€‚</li>
<li><strong>ä»£ç ç”Ÿæˆ</strong>ï¼šæ–°å»ºÂ <code>main.py</code>Â æ–‡ä»¶ï¼Œç¼–å†™ç¬¦åˆ OpenAI é£æ ¼çš„ API æ¥å£ã€‚</li>
<li><strong>è‡ªæˆ‘ä¿®å¤</strong>ï¼šè¿›è¡Œæµ‹è¯•æ—¶å‘ç°å¯¼å…¥é—®é¢˜ï¼Œè‡ªåŠ¨ä¿®å¤ç›¸å…³ Bugã€‚</li>
<li><strong>ç¯å¢ƒç®¡ç†</strong>ï¼šå¯åŠ¨åº”ç”¨æ—¶ä½¿ç”¨ uv åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œç¡®ä¿ç¯å¢ƒç¨³å®šæ€§ã€‚</li>
<li><strong>ç«¯å£å¤„ç†</strong>ï¼šæ£€æµ‹åˆ°ç«¯å£å ç”¨æ—¶ï¼Œè‡ªåŠ¨è¿›è¡Œå¾ªç¯ä¼˜åŒ–å¤„ç†ã€‚</li>
<li><strong>å…¨é¢æµ‹è¯•</strong>ï¼šé€šè¿‡ç¼–å†™Â <code>test-api.py</code>ã€ä½¿ç”¨ curl å‘½ä»¤ç­‰å¤šç§æ–¹å¼æµ‹è¯•æœåŠ¡ç¨³å®šæ€§ã€‚</li>
</ul>
</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/594c90c6ca8343ad89cfb3d933f9f444~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765240253&amp;x-signature=qFIk7BEQDsIPp%2FEu23GyxVevvgg%3D" alt="8.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03504b99c28a488c91c4fa838c8aed60~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765240253&amp;x-signature=m%2FIY1JllIjAiJ%2B1DlAHtDQm4yXM%3D" alt="9.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb2ee0620b7a4dea93aeed0718da3ab2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765240253&amp;x-signature=OxVZIkyY1WZH%2BCAClyDxCfVZKM4%3D" alt="11.png" loading="lazy"/></p>
<ol start="6">
<li><strong>ç”Ÿæˆçš„ FastAPI ä»£ç åˆ†æï¼š</strong> æŸ¥çœ‹ Trae Solo ç”Ÿæˆçš„Â <code>main.py</code>Â ä»£ç ï¼Œå…¶ç»“æ„æ¸…æ™°ã€å¯ç»´æŠ¤æ€§å¼ºï¼š</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, HTTPException
<span class="hljs-keyword">from</span> fastapi.middleware.cors <span class="hljs-keyword">import</span> CORSMiddleware
<span class="hljs-keyword">from</span> fastapi.responses <span class="hljs-keyword">import</span> StreamingResponse
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Optional</span>, <span class="hljs-type">Union</span>, Generator
<span class="hljs-keyword">import</span> uvicorn
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">from</span> langchain_weather <span class="hljs-keyword">import</span> agent

app = FastAPI(
    title=<span class="hljs-string">"Weather Assistant API"</span>,
    description=<span class="hljs-string">"OpenAIé£æ ¼çš„å¤©æ°”åŠ©æ‰‹APIï¼Œæ”¯æŒchatboxç­‰å®¢æˆ·ç«¯æ¥å…¥"</span>,
    version=<span class="hljs-string">"1.0.0"</span>
)

<span class="hljs-comment"># æ·»åŠ CORSä¸­é—´ä»¶ï¼Œå…è®¸è·¨åŸŸè¯·æ±‚</span>
app.add_middleware(
    CORSMiddleware,
    allow_origins=[<span class="hljs-string">"*"</span>],  <span class="hljs-comment"># å…è®¸æ‰€æœ‰æ¥æºï¼Œç”Ÿäº§ç¯å¢ƒåº”é™åˆ¶å…·ä½“åŸŸå</span>
    allow_credentials=<span class="hljs-literal">True</span>,
    allow_methods=[<span class="hljs-string">"*"</span>],
    allow_headers=[<span class="hljs-string">"*"</span>],
)

<span class="hljs-comment"># å®šä¹‰OpenAIé£æ ¼çš„è¯·æ±‚æ¨¡å‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Message</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    role: <span class="hljs-built_in">str</span>
    content: <span class="hljs-built_in">str</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatCompletionRequest</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    model: <span class="hljs-built_in">str</span> = <span class="hljs-string">"deepseek-chat"</span>
    messages: <span class="hljs-type">List</span>[Message]
    temperature: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">float</span>] = <span class="hljs-number">0.7</span>
    max_tokens: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = <span class="hljs-literal">None</span>
    stream: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">bool</span>] = <span class="hljs-literal">False</span>

<span class="hljs-comment"># å®šä¹‰OpenAIé£æ ¼çš„å“åº”æ¨¡å‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Choice</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    index: <span class="hljs-built_in">int</span>
    message: Message
    finish_reason: <span class="hljs-built_in">str</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatCompletionResponse</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    <span class="hljs-built_in">id</span>: <span class="hljs-built_in">str</span>
    <span class="hljs-built_in">object</span>: <span class="hljs-built_in">str</span> = <span class="hljs-string">"chat.completion"</span>
    created: <span class="hljs-built_in">int</span>
    model: <span class="hljs-built_in">str</span>
    choices: <span class="hljs-type">List</span>[Choice]
    usage: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">dict</span>] = <span class="hljs-literal">None</span>

<span class="hljs-comment"># å®šä¹‰æµå¼å“åº”çš„Chunkæ¨¡å‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ChunkChoice</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    index: <span class="hljs-built_in">int</span>
    delta: <span class="hljs-built_in">dict</span>
    finish_reason: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatCompletionChunk</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    <span class="hljs-built_in">id</span>: <span class="hljs-built_in">str</span>
    <span class="hljs-built_in">object</span>: <span class="hljs-built_in">str</span> = <span class="hljs-string">"chat.completion.chunk"</span>
    created: <span class="hljs-built_in">int</span>
    model: <span class="hljs-built_in">str</span>
    choices: <span class="hljs-type">List</span>[ChunkChoice]

<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/chat/completions"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">chat_completions</span>(<span class="hljs-params">request: ChatCompletionRequest</span>):
    <span class="hljs-string">"""å¤„ç†èŠå¤©è¯·æ±‚ï¼Œè°ƒç”¨å¤©æ°”åŠ©æ‰‹æ™ºèƒ½ä½“"""</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># æå–ç”¨æˆ·æœ€åä¸€æ¡æ¶ˆæ¯</span>
        user_message = request.messages[-<span class="hljs-number">1</span>].content
        
        <span class="hljs-comment"># ç”Ÿæˆå“åº”ID</span>
        response_id = <span class="hljs-string">f"chatcmpl-<span class="hljs-subst">{<span class="hljs-built_in">hash</span>(<span class="hljs-built_in">str</span>(request))}</span>"</span>
        created_time = <span class="hljs-built_in">int</span>(time.time())
        
        <span class="hljs-keyword">if</span> request.stream:
            <span class="hljs-comment"># æµå¼å“åº”å¤„ç†</span>
            <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_stream</span>() -&gt; Generator[<span class="hljs-built_in">str</span>, <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>]:
                <span class="hljs-comment"># è°ƒç”¨æ™ºèƒ½ä½“å¤„ç†è¯·æ±‚</span>
                result = agent.invoke({<span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: user_message}]})
                
                <span class="hljs-comment"># è·å–æ™ºèƒ½ä½“è¿”å›çš„æ¶ˆæ¯å†…å®¹</span>
                assistant_content = <span class="hljs-string">""</span>
                <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(result, <span class="hljs-built_in">dict</span>) <span class="hljs-keyword">and</span> <span class="hljs-string">"messages"</span> <span class="hljs-keyword">in</span> result:
                    <span class="hljs-comment"># å¦‚æœè¿”å›çš„æ˜¯å­—å…¸æ ¼å¼</span>
                    last_message = result[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>]
                    <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(last_message, <span class="hljs-built_in">dict</span>):
                        assistant_content = last_message.get(<span class="hljs-string">"content"</span>, <span class="hljs-string">""</span>)
                    <span class="hljs-keyword">else</span>:
                        <span class="hljs-comment"># å¦‚æœæ˜¯Messageå¯¹è±¡</span>
                        assistant_content = last_message.content
                <span class="hljs-keyword">else</span>:
                    <span class="hljs-comment"># ç›´æ¥å¤„ç†Messageå¯¹è±¡</span>
                    assistant_content = result.content
                
                <span class="hljs-comment"># æ¨¡æ‹Ÿæµå¼è¾“å‡ºï¼Œé€å­—å‘é€</span>
                chunk_id = <span class="hljs-number">0</span>
                <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> assistant_content:
                    chunk = ChatCompletionChunk(
                        <span class="hljs-built_in">id</span>=response_id,
                        created=created_time,
                        model=request.model,
                        choices=[
                            ChunkChoice(
                                index=<span class="hljs-number">0</span>,
                                delta={<span class="hljs-string">"content"</span>: char},
                                finish_reason=<span class="hljs-literal">None</span>
                            )
                        ]
                    )
                    <span class="hljs-keyword">yield</span> <span class="hljs-string">f"data: <span class="hljs-subst">{json.dumps(chunk.<span class="hljs-built_in">dict</span>(), ensure_ascii=<span class="hljs-literal">False</span>)}</span>\n\n"</span>
                    time.sleep(<span class="hljs-number">0.05</span>)  <span class="hljs-comment"># æ§åˆ¶æµå¼è¾“å‡ºé€Ÿåº¦</span>
                
                <span class="hljs-comment"># å‘é€ç»“æŸæ ‡å¿—</span>
                end_chunk = ChatCompletionChunk(
                    <span class="hljs-built_in">id</span>=response_id,
                    created=created_time,
                    model=request.model,
                    choices=[
                        ChunkChoice(
                            index=<span class="hljs-number">0</span>,
                            delta={},
                            finish_reason=<span class="hljs-string">"stop"</span>
                        )
                    ]
                )
                <span class="hljs-keyword">yield</span> <span class="hljs-string">f"data: <span class="hljs-subst">{json.dumps(end_chunk.<span class="hljs-built_in">dict</span>(), ensure_ascii=<span class="hljs-literal">False</span>)}</span>\n\n"</span>
                <span class="hljs-keyword">yield</span> <span class="hljs-string">"data: [DONE]\n\n"</span>
            
            <span class="hljs-keyword">return</span> StreamingResponse(generate_stream(), media_type=<span class="hljs-string">"text/event-stream"</span>)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># éæµå¼å“åº”å¤„ç†</span>
            <span class="hljs-comment"># è°ƒç”¨æ™ºèƒ½ä½“å¤„ç†è¯·æ±‚</span>
            result = agent.invoke({<span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: user_message}]})
            
            <span class="hljs-comment"># è·å–æ™ºèƒ½ä½“è¿”å›çš„æ¶ˆæ¯å†…å®¹</span>
            assistant_content = <span class="hljs-string">""</span>
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(result, <span class="hljs-built_in">dict</span>) <span class="hljs-keyword">and</span> <span class="hljs-string">"messages"</span> <span class="hljs-keyword">in</span> result:
                <span class="hljs-comment"># å¦‚æœè¿”å›çš„æ˜¯å­—å…¸æ ¼å¼</span>
                last_message = result[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>]
                <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(last_message, <span class="hljs-built_in">dict</span>):
                    assistant_content = last_message.get(<span class="hljs-string">"content"</span>, <span class="hljs-string">""</span>)
                <span class="hljs-keyword">else</span>:
                    <span class="hljs-comment"># å¦‚æœæ˜¯Messageå¯¹è±¡</span>
                    assistant_content = last_message.content
            <span class="hljs-keyword">else</span>:
                <span class="hljs-comment"># ç›´æ¥å¤„ç†Messageå¯¹è±¡</span>
                assistant_content = result.content
            
            <span class="hljs-comment"># æ„å»ºå“åº”</span>
            response = ChatCompletionResponse(
                <span class="hljs-built_in">id</span>=response_id,
                created=created_time,
                model=request.model,
                choices=[
                    Choice(
                        index=<span class="hljs-number">0</span>,
                        message=Message(
                            role=<span class="hljs-string">"assistant"</span>,
                            content=assistant_content
                        ),
                        finish_reason=<span class="hljs-string">"stop"</span>
                    )
                ]
            )
            
            <span class="hljs-keyword">return</span> response
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">500</span>, detail=<span class="hljs-built_in">str</span>(e))

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    uvicorn.run(app, host=<span class="hljs-string">"0.0.0.0"</span>, port=<span class="hljs-number">8001</span>)
</code></pre>
<ol start="7">
<li>
<p><strong>é…ç½® Chatbox è¿æ¥ï¼š</strong> æ¥ä¸‹æ¥ï¼Œç¬”è€…å°†è¿™ä¸ªæœåŠ¡æ¥å…¥Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fchatboxai.app%2Fzh" target="_blank" title="https://chatboxai.app/zh" ref="nofollow noopener noreferrer">Chatbox</a>ã€‚ä¸‹è½½å¹¶å®‰è£… Chatbox åï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤é…ç½®ï¼š</p>
<ul>
<li>ç‚¹å‡»"è®¾ç½®" â†’ "æ¨¡å‹"</li>
<li>æ·»åŠ æ–°çš„æ¨¡å‹æä¾›æ–¹</li>
<li>é…ç½®å‚æ•°ï¼šAPI ä¸»æœºï¼š<code>http://localhost:8001</code>ï¼ŒAPI è·¯å¾„ï¼š<code>/chat/completions</code></li>
</ul>
</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/251d8a8207f846f2a7ea52e6638c8370~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765240253&amp;x-signature=bKby1szn9QfvQtClJScD8w4pZ7E%3D" alt="12.png" loading="lazy"/></p>
<ol start="8">
<li><strong>æµ‹è¯•æ•ˆæœï¼š</strong></li>
</ol>
<p>è¾“å…¥åŒ—äº¬çš„å¤©æ°”ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9355d7495ec84229a652be323a4757c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765240253&amp;x-signature=uy02pWux09GhTfPwM4yfuu%2Flz88%3D" alt="13.png" loading="lazy"/></p>
<p>è¾“å…¥ä¸Šæµ·çš„å¤©æ°”ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7e00ce4362c64c869b1040fd79bb5b08~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765240253&amp;x-signature=FsjspJmeVro3F7N8RJgQ9JyFn7o%3D" alt="14.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæ™ºèƒ½ä½“æˆåŠŸè¿”å›äº†å¤©æ°”ä¿¡æ¯ï¼Œå¹¶ä»¥æ—å¿—ç²çš„ç”œç¾è¯­æ°”è¿›è¡Œæ’­æŠ¥ã€‚æ•´ä¸ªè¿‡ç¨‹ä»æ™ºèƒ½ä½“ä»£ç åˆ°å®Œæ•´çš„ API æœåŠ¡ï¼Œå‡ ä¹éƒ½ç”± Trae Solo è‡ªåŠ¨å®Œæˆï¼</p>
<h2 data-id="heading-6">å››ã€å±•æœ›</h2>
<p>é€šè¿‡è¿™ä¸ªç®€å•çš„æ™ºèƒ½ä½“æ¥å…¥å®éªŒï¼Œæˆ‘ä»¬è¶³ä»¥æ„Ÿå—åˆ° Trae SOLO æ¨¡å¼çš„å¼ºå¤§æ½œåŠ›ã€‚å®ƒä¸ä»…èƒ½è‡ªåŠ¨ç”Ÿæˆä»£ç ï¼Œæ›´èƒ½å®Œæˆä»åˆ†æã€æµ‹è¯•åˆ°æœåŠ¡éƒ¨ç½²çš„å…¨æµç¨‹ï¼ŒçœŸæ­£å®ç°äº†â€œæè¿°å³å¼€å‘â€çš„æ„¿æ™¯ã€‚</p>
<p>ä¹Ÿè®¸æœ‰äººä¼šè¯´ï¼Œè¿™åªæ˜¯ä¸€ä¸ªå°å‹æ¼”ç¤ºé¡¹ç›®ï¼ŒTrae SOLO èƒ½å¦åº”å¯¹æ›´å¤æ‚çš„ç”Ÿäº§åœºæ™¯ä»æœ‰å¾…éªŒè¯ã€‚ä½†æˆ‘ç›¸ä¿¡ï¼Œå‡­å€Ÿå­—èŠ‚è·³åŠ¨æ·±åšçš„æŠ€æœ¯ç§¯ç´¯å’Œä¼—å¤šä¼˜ç§€å·¥ç¨‹å¸ˆçš„åŠªåŠ›ï¼Œè¿™æ¬¾å·¥å…·å¿…å°†æŒç»­è¿›åŒ–ï¼Œè¶Šæ¥è¶Šå¥½ã€‚</p>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œè¿™æ¬¡å°è¯•ä¸ºæˆ‘ä»¬æ‰“å¼€äº†ä¸€æ‰‡æ–°çš„çª—å£ï¼šå¦‚æœ Trae èƒ½å¤Ÿç†è§£å¹¶ç¼–å†™æ™ºèƒ½ä½“æ¥å…¥ä»£ç ï¼Œé‚£ä¹ˆå®ƒæ˜¯å¦å¯ä»¥ç›´æ¥å¼€å‘åŸºäº LangChain çš„æ™ºèƒ½ä½“ï¼Ÿæˆ–è®¸ï¼Œæˆ‘ä»¬åªéœ€è¦ç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚ï¼Œå°±èƒ½é€šè¿‡ Trae è‡ªåŠ¨ç”Ÿæˆæ™ºèƒ½ä½“ï¼Œå†å€ŸåŠ©æœ¬æ–‡çš„æ¥å…¥æ–¹æ¡ˆå¿«é€Ÿé›†æˆåˆ° Chatbox ç­‰å®¢æˆ·ç«¯ä¸­ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼šä¸€ä¸ªäººã€ä¸€ä¸ªæƒ³æ³•ã€ä¸€å¥æè¿°ï¼Œå°±èƒ½å¿«é€Ÿæ„å»ºèµ·å¯ç”¨çš„æ™ºèƒ½ä½“æœåŠ¡â€”â€”è¿™æ­£æ˜¯ Vibe Coding çš„é­…åŠ›æ‰€åœ¨ã€‚å®ƒä¸åªæ˜¯ä¸€ç§ç¼–ç¨‹æ–¹å¼ï¼Œæ›´æ˜¯ä¸€ç§è®©æƒ³è±¡åŠ›è¿…é€Ÿç…§è¿›ç°å®çš„å¼€å‘èŒƒå¼ã€‚æœªæ¥ï¼Œæˆ–è®¸æ¯ä¸ªäººéƒ½èƒ½è½»æ¾æ‰“é€ å±äºè‡ªå·±çš„â€œæ™ºèƒ½ä½“å¸å›½â€ã€‚</p>
<h2 data-id="heading-7">äº”ã€æ€»ç»“</h2>
<p>æœ¬æœŸç¬”è€…å€ŸåŠ© Trae Soloï¼Œå¿«é€Ÿå®ç°äº†å°† LangChain æ™ºèƒ½ä½“æ¥å…¥ Chatbox å®¢æˆ·ç«¯çš„å®Œæ•´æµç¨‹ã€‚è¿™ä¸ä»…ä¸ºæ™ºèƒ½ä½“æä¾›äº†ä¸€ä¸ªè½»é‡ã€ä¾¿æ·çš„è°ƒç”¨å…¥å£ï¼Œä¹Ÿè®©ç¬”è€…äº²èº«æ„Ÿå—åˆ°äº†â€œè‡ªç„¶è¯­è¨€é©±åŠ¨å¼€å‘â€çš„é«˜æ•ˆä¸ç›´è§‚ã€‚é€šè¿‡æœ¬æ¬¡å®è·µï¼Œç¬”è€…è§è¯äº† Trae Solo åœ¨ä»£ç ç”Ÿæˆã€æ¥å£é€‚é…ã€æµ‹è¯•éªŒè¯ä¹ƒè‡³ç¯å¢ƒéƒ¨ç½²ä¸Šçš„è‡ªåŠ¨åŒ–èƒ½åŠ›ã€‚å¦‚æœä½ ä¹Ÿæœ‰ç±»ä¼¼çš„éœ€æ±‚â€”â€”æ— è®ºæ˜¯ç®€å•çš„å·¥å…·å¯¹æ¥ï¼Œè¿˜æ˜¯æ›´å¤æ‚çš„åº”ç”¨å¼€å‘â€”â€”éƒ½ä¸å¦¨å°è¯•ç”¨ Trae Solo æ¥æè¿°ä½ çš„æƒ³æ³•ï¼Œè®©å®ƒå¸®ä½ å¿«é€Ÿæ­å»ºåŸå‹ã€éªŒè¯é€»è¾‘ã€‚</p>
<p>ç¬”è€…æ‰“ç®—ç»§ç»­åˆ©ç”¨ Trae Soloä¸ºä¸“æ ã€Š<a href="https://juejin.cn/column/7526240014499495972" target="_blank" title="https://juejin.cn/column/7526240014499495972">æ·±å…¥æµ…å‡ºLangChain&amp;LangGraph AI Agent æ™ºèƒ½ä½“å¼€å‘</a>ã€‹ä¸­çš„å¤šæ¨¡æ€ RAG ç³»ç»Ÿç³»åˆ—æ–‡ç« ï¼Œå¼€å‘ä¸€ä¸ªç¾è§‚ä¸”å®ç”¨çš„å‰ç«¯ç•Œé¢ã€‚æ¬¢è¿å¤§å®¶å’Œæˆ‘ä¸€èµ·ä½“éªŒæ›´å¤šâ€œæè¿°å³å®ç°â€çš„åˆ›ä½œä¹è¶£ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯ç»„ä»¶äºŒæ¬¡å°è£…å®æˆ˜ï¼šVue+ReactåŸºäºElement UI/AntDçš„é«˜æ•ˆå°è£…ç­–ç•¥]]></title>    <link>https://juejin.cn/post/7578760341279801385</link>    <guid>https://juejin.cn/post/7578760341279801385</guid>    <pubDate>2025-12-02T00:39:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578760341279801385" data-draft-id="7576483553879457818" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯ç»„ä»¶äºŒæ¬¡å°è£…å®æˆ˜ï¼šVue+ReactåŸºäºElement UI/AntDçš„é«˜æ•ˆå°è£…ç­–ç•¥"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,React.js"/> <meta itemprop="datePublished" content="2025-12-02T00:39:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¹å¤šå¤š"/> <meta itemprop="url" content="https://juejin.cn/user/747323639737191"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯ç»„ä»¶äºŒæ¬¡å°è£…å®æˆ˜ï¼šVue+ReactåŸºäºElement UI/AntDçš„é«˜æ•ˆå°è£…ç­–ç•¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/747323639737191/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¹å¤šå¤š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T00:39:01.000Z" title="Tue Dec 02 2025 00:39:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:2;font-weight:400;font-size:15px;overflow-x:hidden;color:#333;letter-spacing:1.2px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:.5rem solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c;margin:0 5px}.markdown-body a:active,.markdown-body a:hover{text-decoration:none;border-bottom:1.5px solid #3eaf7c}.markdown-body a[href^=http]:after{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04MzIgMTI4SDY0MHY2NGgxNDYuNzUyTDUyMS4zNzYgNDU3LjM3Nmw0NS4yNDggNDUuMjQ4TDgzMiAyMzcuMjQ4VjM4NGg2NFYxMjh6IiBmaWxsPSIjM2VhZjdjIi8+PHBhdGggZD0iTTc2OCA4MzJIMTkyVjI1NmgzNTJ2LTY0SDE2MGEzMiAzMiAwIDAwLTMyIDMydjY0MGEzMiAzMiAwIDAwMzIgMzJoNjQwYTMyIDMyIDAgMDAzMi0zMlY0ODBoLTY0djM1MnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");margin-left:2px}.markdown-body a[href^="#"]:before{content:"#"}.markdown-body table{display:inline-block!important;font-size:13px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c;border-collapse:collapse}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:4px 8px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#7b7878;padding:1px 23px;border-left:.5rem solid;border-color:#42b983;background-color:rgba(66,184,131,.1);position:relative;margin:14px 8px 0}.markdown-body blockquote:before{display:inline-block;position:absolute;content:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUiIGhlaWdodD0iMjUiIHZpZXdCb3g9IjAgMCAyNyAyNyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjg2MiAxLjg2MikiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0ibm9uZSI+PGNpcmNsZSBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS43MjQiIGZpbGw9IiM0MkI5ODMiIGN4PSIxMS42MzgiIGN5PSIxMS42MzgiIHI9IjExLjYzOCIvPjxwYXRoIGQ9Ik0xNC45NzggNi4yN0E1LjAwNiA1LjAwNiAwIDAwNi42NyA5LjQ2OGE0LjkwMSA0LjkwMSAwIDAwMS43NzMgNC4zNjJjLjMyMy4yNTguNTE0LjY0Ny41MjIgMS4wNnYxLjA2YTIuNjg1IDIuNjg1IDAgMDA1LjM3IDB2LTEuMDA4Yy4wMDItLjM5OC4xNzMtLjc3Ny40Ny0xLjA0MmE1LjAyMyA1LjAyMyAwIDAwLjE3My03LjYzem0tMy4zMzcgMTAuOTY3YTEuMzA0IDEuMzA0IDAgMDEtMS4yODYtMS4yODd2LS4yNzhoMi41NzJ2LjI2MWMwIC43MTMtLjU3MyAxLjI5NC0xLjI4NiAxLjMwNHptMi4yNi00LjQxNWMtLjQ0LjM4My0uNzUuODkzLS44ODcgMS40NmgtMi43NDZhMi44NjggMi44NjggMCAwMC0uOTM4LTEuNTNoLS4wMThhMy40NzYgMy40NzYgMCAwMS0xLjI2OS0zLjE0NSAzLjYxNSAzLjYxNSAwIDAxNy4xOTYuNCAzLjY1IDMuNjUgMCAwMS0xLjMzOCAyLjgxNXoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+");width:25px;height:25px;left:-16px;top:12px}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none;padding-left:10px}.markdown-body ul li::marker{content:"â€¢";color:#3eaf7c}.markdown-body ul li.task-list-item:before{content:"";margin-right:0}.markdown-body input[type=checkbox]{vertical-align:text-bottom;box-shadow:inset 0 0 0 10px #fff}.markdown-body input[type=checkbox]:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04NzcuMDU2IDE0Ni45NDR2NzMwLjExMkgxNDYuOTQ0VjE0Ni45NDRoNzMwLjExMnptMC0xMDQuMjc3SDE0Ni45NDRjLTU3LjYyOCAwLTEwNC4yNzcgNDYuNjQ5LTEwNC4yNzcgMTA0LjI3N3Y3MzAuMTEyYzAgNTcuNjI4IDQ2LjY0OSAxMDQuMjc3IDEwNC4yNzcgMTA0LjI3N2g3MzAuMTEyYzU3LjYyOCAwIDEwNC4yNzctNDYuNjQ5IDEwNC4yNzctMTA0LjI3N1YxNDYuOTQ0YzAtNTcuNjI4LTQ2LjY0OS0xMDQuMjc3LTEwNC4yNzctMTA0LjI3N3oiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}.markdown-body input[type=checkbox]:checked:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik05MTAuMjA4IDBIMTEzLjc2QTExNC4xMTIgMTE0LjExMiAwIDAwLS4wMzIgMTEzLjc5MlY5MTAuMjRjMCA2Mi41OTIgNTEuMiAxMTMuNzkyIDExMy43OTIgMTEzLjc5Mmg3OTYuNDQ4YzYyLjU5MiAwIDExMy43OTItNTEuMiAxMTMuNzkyLTExMy43OTJWMTEzLjc5MkMxMDI0IDUxLjIgOTcyLjggMCA5MTAuMjA4IDB6bS01MTIgNzk2LjQ0OEwxMTMuNzYgNTEybDc5LjY0OC03OS42NDggMjA0LjggMjA0LjhMODMwLjU2IDIwNC44bDc5LjY0OCA3OS42NDgtNTEyIDUxMnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><p>åœ¨ä¸­åå°é¡¹ç›®å¼€å‘ä¸­ï¼ŒElement UIï¼ˆVueï¼‰å’ŒAnt Designï¼ˆAntDï¼ŒReactï¼‰æ˜¯ä¸»æµçš„ç»„ä»¶åº“ï¼Œä½†åŸç”Ÿç»„ä»¶å¾€å¾€æ— æ³•ç›´æ¥é€‚é…ä¸šåŠ¡åœºæ™¯ï¼Œæ¯”å¦‚ï¼šç»Ÿä¸€çš„è¡¨å•æ ¡éªŒè§„åˆ™ã€æ ‡å‡†åŒ–çš„è¡¨æ ¼äº¤äº’ã€ä¸ªæ€§åŒ–çš„å¼¹çª—æ ·å¼ç­‰ã€‚æ­¤æ—¶ï¼ŒåŸºäºç»„ä»¶åº“çš„äºŒæ¬¡å°è£…æˆä¸ºå¹³è¡¡å¼€å‘æ•ˆç‡ã€ä»£ç å¤ç”¨ä¸å›¢é˜Ÿè§„èŒƒçš„æ ¸å¿ƒæ‰‹æ®µã€‚æˆ‘å°†å›´ç»•<strong>ä½•æ—¶å°è£…</strong>ã€<strong>ä¸ºä½•å°è£…</strong>ã€<strong>å¦‚ä½•å°è£…</strong>ï¼Œä¸‰ä¸ªæ ¸å¿ƒé—®é¢˜ï¼Œèšç„¦Element UI/AntDçš„äºŒæ¬¡å°è£…æŠ€å·§ï¼Œç»“åˆVue 3å’ŒReact 18çš„å®æˆ˜æ¡ˆä¾‹ï¼Œæ‹†è§£é«˜æ•ˆä¸”æ˜“æ‰©å±•çš„å°è£…æ–¹æ³•è®ºã€‚</p>
<h2 data-id="heading-0">1. ä»€ä¹ˆæ—¶å€™å€¼å¾—å°è£…ä¸€ä¸ªç»„ä»¶</h2>
<p>ç»„ä»¶å°è£…ä¸æ˜¯â€œä¸ºäº†å°è£…è€Œå°è£…â€ï¼Œå½“æ»¡è¶³ä»¥ä¸‹åœºæ™¯æ—¶ï¼ŒäºŒæ¬¡å°è£…çš„æ”¶ç›Šè¿œå¤§äºæˆæœ¬ï¼š</p>
<h3 data-id="heading-1">1.1. é‡å¤åœºæ™¯å‡ºç°æ—¶ï¼šå‡å°‘å¤åˆ¶ç²˜è´´</h3>
<p>å½“åŒä¸€ç±»UI/äº¤äº’åœ¨2ä¸ªåŠä»¥ä¸Šæ¨¡å—å‡ºç°ï¼ˆå¦‚Element UIçš„Table+åˆ†é¡µã€AntDçš„Form+æœç´¢æŒ‰é’®ï¼‰ï¼Œä¸”ä»…å‚æ•°ä¸åŒï¼Œå°è£…å¯é¿å…é‡å¤ä»£ç ã€‚</p>
<ul>
<li>ç¤ºä¾‹ï¼šå¤šä¸ªåˆ—è¡¨é¡µéƒ½ç”¨Element UIçš„Tableï¼Œä¸”éƒ½éœ€è¦â€œåˆ†é¡µ+å¤šé€‰+æ“ä½œåˆ—â€ï¼Œå°è£…<code>BaseTable</code>ç»„ä»¶ç»Ÿä¸€é€»è¾‘ã€‚</li>
</ul>
<h3 data-id="heading-2">1.2. ä¸šåŠ¡è§„åˆ™éœ€ç»Ÿä¸€æ—¶ï¼šè§„é¿é£æ ¼æ··ä¹±</h3>
<p>å½“ç»„ä»¶éœ€è¦éµå¾ªç»Ÿä¸€çš„ä¸šåŠ¡è§„åˆ™ï¼ˆå¦‚æŒ‰é’®æƒé™æ§åˆ¶ã€æ—¥æœŸæ ¼å¼æ¸²æŸ“ã€è¡¨å•æ ¡éªŒæç¤ºï¼‰ï¼Œå°è£…å¯æ”¶å£è§„åˆ™ã€‚</p>
<ul>
<li>ç¤ºä¾‹ï¼šAntDçš„Buttonéœ€æ ¹æ®ç”¨æˆ·è§’è‰²æ§åˆ¶æ˜¾ç¤º/ç¦ç”¨ï¼Œå°è£…<code>AuthButton</code>ç»Ÿä¸€å¤„ç†æƒé™é€»è¾‘ï¼Œæ‰€æœ‰é¡µé¢å¤ç”¨ã€‚</li>
</ul>
<h3 data-id="heading-3">1.3. åŸç”Ÿç»„ä»¶èƒ½åŠ›ä¸è¶³æ—¶ï¼šè¡¥é½ä¸ªæ€§åŒ–éœ€æ±‚</h3>
<p>Element UI/AntDçš„é€šç”¨èƒ½åŠ›æ— æ³•è¦†ç›–ä¸šåŠ¡åœºæ™¯ï¼ˆå¦‚Element UIçš„Dialogéœ€æ‹–æ‹½ã€AntDçš„Selectéœ€æœ€å¤šæ˜¾ç¤º3ä¸ªå¤šé€‰æ ‡ç­¾ï¼‰ï¼ŒäºŒæ¬¡å°è£…å¯å®šåˆ¶åŒ–æ‰©å±•ã€‚</p>
<h3 data-id="heading-4">1.4. é€»è¾‘ä¸UIè€¦åˆå¤æ‚æ—¶ï¼šé™ä½ç»´æŠ¤æˆæœ¬</h3>
<p>å½“ä¸€ä¸ªåŠŸèƒ½åŒ…å«â€œæ•°æ®è¯·æ±‚+äº¤äº’é€»è¾‘+æ ·å¼å®šåˆ¶â€ï¼ˆå¦‚å¸¦è¿œç¨‹æœç´¢çš„éƒ¨é—¨é€‰æ‹©å™¨ï¼‰ï¼Œå°è£…å¯æ‹†åˆ†å¤æ‚é€»è¾‘ï¼Œç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚</p>
<h2 data-id="heading-5">2. å°è£…ç»„ä»¶çš„æ ¸å¿ƒç›®çš„</h2>
<p><strong>é™æœ¬ææ•ˆ</strong>ï¼šä¸€æ¬¡å°è£…ï¼Œå¤šå¤„å¤ç”¨ã€‚åç»­éœ€æ±‚å˜æ›´ï¼ˆå¦‚è¡¨æ ¼åˆ†é¡µæ ·å¼è°ƒæ•´ï¼‰ï¼Œåªéœ€ä¿®æ”¹å°è£…ç»„ä»¶ï¼Œæ‰€æœ‰å¼•ç”¨å¤„è‡ªåŠ¨ç”Ÿæ•ˆï¼Œæ— éœ€é€ä¸ªé¡µé¢ä¿®æ”¹ã€‚</p>
<p><strong>é€»è¾‘å†…èš</strong>ï¼šé«˜å†…èšã€ä½è€¦åˆã€‚å°†ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚æ•°æ®è¯·æ±‚ã€æ ¡éªŒè§„åˆ™ï¼‰å°è£…åœ¨ç»„ä»¶å†…éƒ¨ï¼Œé¡µé¢åªéœ€å…³æ³¨â€œä¼ å‚â€å’Œâ€œæ¥æ”¶ç»“æœâ€ï¼Œé™ä½ä»£ç è€¦åˆåº¦ã€‚</p>
<p><strong>æ‰©å±•çµæ´»</strong>ï¼šé€‚é…æœªæ¥ä¸šåŠ¡å˜åŒ–ã€‚é¢„ç•™æ‰©å±•æ¥å£ï¼Œæ–°å¢éœ€æ±‚ï¼ˆå¦‚è¡¨æ ¼æ–°å¢å¯¼å‡ºåŠŸèƒ½ï¼‰æ—¶ï¼Œä»…éœ€æ‰©å±•ç»„ä»¶å†…éƒ¨ï¼Œä¸å½±å“å¤–éƒ¨è°ƒç”¨æ–¹å¼ã€‚</p>
<p><strong>ç»Ÿä¸€æ ‡å‡†</strong>ï¼šå¯¹é½å›¢é˜Ÿå¼€å‘è§„èŒƒã€‚é¿å…ä¸åŒå¼€å‘è€…å¯¹Element UI/AntDçš„å®šåˆ¶æ–¹å¼ä¸ä¸€è‡´ï¼ˆå¦‚æŒ‰é’®å°ºå¯¸ã€è¡¨å•é—´è·ï¼‰ï¼Œä¿è¯é¡¹ç›®é£æ ¼ç»Ÿä¸€ã€‚</p>
<h2 data-id="heading-6">3. Element UI/AntDäºŒæ¬¡å°è£…æ ¸å¿ƒæŠ€å·§ï¼šé€ä¼ åŸç”ŸProps</h2>
<p>äºŒæ¬¡å°è£…çš„å…³é”®æ˜¯â€œä¸ä¸¢å¤±åŸç”Ÿç»„ä»¶çš„èƒ½åŠ›â€â€”â€”å³è®©å°è£…åçš„ç»„ä»¶èƒ½éšå¼ä¼ é€’åŸç”Ÿç»„ä»¶çš„æ‰€æœ‰Propsã€äº‹ä»¶å’Œæ ·å¼ï¼ŒåŒæ—¶æ–°å¢ä¸šåŠ¡é€»è¾‘ã€‚ä»¥ä¸‹åˆ†Vueï¼ˆElement Plusï¼‰å’ŒReactï¼ˆAntDï¼‰è®²è§£æ ¸å¿ƒå®ç°æ–¹å¼ã€‚</p>
<p><strong>æ ¸å¿ƒæ¦‚å¿µï¼šé€ä¼ çš„æœ¬è´¨</strong></p>
<ul>
<li>Vueï¼šé€šè¿‡<code>v-bind="$attrs"</code>é€ä¼ Propsï¼Œ<code>v-on="$listeners"</code>ï¼ˆVue 3å·²åˆå¹¶åˆ°<code>$attrs</code>ï¼‰é€ä¼ äº‹ä»¶ï¼Œ<code>inheritAttrs: false</code>é¿å…å±æ€§é€ä¼ åˆ°æ ¹å…ƒç´ ã€‚</li>
<li>Reactï¼šé€šè¿‡æ‰©å±•è¿ç®—ç¬¦<code>{...props}</code>é€ä¼ æ‰€æœ‰Propsï¼Œé€šè¿‡<code>children</code>é€ä¼ å­å…ƒç´ ï¼ŒåŒºåˆ†â€œä¸šåŠ¡Propsâ€å’Œâ€œåŸç”ŸPropsâ€ã€‚</li>
</ul>
<h3 data-id="heading-7">3.1. Vue 3 + Element Plus äºŒæ¬¡å°è£…å®æˆ˜</h3>
<p>ä»¥å°è£…<code>BaseDialog</code>ï¼ˆåŸºäºElDialogï¼‰ä¸ºä¾‹ï¼Œå®ç°â€œæ‹–æ‹½+é»˜è®¤æ ·å¼+é€ä¼ åŸç”ŸPropsâ€ï¼š</p>
<h4 data-id="heading-8">æ­¥éª¤1ï¼šåŸºç¡€å°è£…ï¼ˆé€ä¼ åŸç”ŸPropsï¼‰</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;!-- æ ¹å…ƒç´ ç¦ç”¨å±æ€§ç»§æ‰¿ï¼Œé¿å…$attrsé€ä¼ åˆ°div --&gt;
  &lt;div class="base-dialog"&gt;
    &lt;el-dialog
      v-bind="$attrs" &lt;!-- é€ä¼ ElDialogçš„æ‰€æœ‰åŸç”ŸPropsï¼ˆå¦‚titleã€visibleã€widthï¼‰ --&gt;
      :close-on-click-modal="false" &lt;!-- ä¸šåŠ¡é»˜è®¤å€¼ï¼Œå¯è¢«å¤–éƒ¨Propsè¦†ç›– --&gt;
      @close="handleClose" &lt;!-- å†…éƒ¨å¤„ç†åŸºç¡€äº‹ä»¶ï¼Œä¹Ÿå¯é€ä¼ å¤–éƒ¨äº‹ä»¶ --&gt;
      class="base-dialog__inner"
    &gt;
      &lt;!-- æ’æ§½ï¼šé€ä¼ ElDialogçš„é»˜è®¤æ’æ§½ --&gt;
      &lt;slot /&gt;
      &lt;!-- æ’æ§½ï¼šè‡ªå®šä¹‰åº•éƒ¨æŒ‰é’® --&gt;
      &lt;template #footer&gt;
        &lt;slot name="footer"&gt;
          &lt;!-- é»˜è®¤åº•éƒ¨æŒ‰é’® --&gt;
          &lt;el-button @click="handleCancel"&gt;å–æ¶ˆ&lt;/el-button&gt;
          &lt;el-button type="primary" @click="handleConfirm"&gt;ç¡®è®¤&lt;/el-button&gt;
        &lt;/slot&gt;
      &lt;/template&gt;
    &lt;/el-dialog&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { ref } from 'vue';
import { ElDialog, ElButton, ElMessage } from 'element-plus';
// å¼•å…¥æ‹–æ‹½æŒ‡ä»¤ï¼ˆå¯é€‰ï¼Œæ‰©å±•åŠŸèƒ½ï¼‰
import { vDialogDrag } from '@/directives/dialogDrag';

// ç¦ç”¨æ ¹å…ƒç´ çš„å±æ€§ç»§æ‰¿ï¼Œç¡®ä¿$attrsåªé€ä¼ ç»™ElDialog
defineOptions({
  inheritAttrs: false
});

// å®šä¹‰ä¸šåŠ¡Propsï¼ˆä¸åŸç”ŸPropsåŒºåˆ†ï¼‰
const props = defineProps&lt;{
  // ä¸šåŠ¡è‡ªå®šä¹‰Propsï¼ŒéElDialogåŸç”Ÿå±æ€§
  confirmText?: string;
  cancelText?: string;
}&gt;();

// å®šä¹‰äº‹ä»¶ï¼šé€ä¼ åŸç”Ÿäº‹ä»¶ + è‡ªå®šä¹‰ä¸šåŠ¡äº‹ä»¶
const emit = defineEmits&lt;{
  (e: 'confirm'): void; // è‡ªå®šä¹‰ç¡®è®¤äº‹ä»¶
  (e: 'cancel'): void; // è‡ªå®šä¹‰å–æ¶ˆäº‹ä»¶
  (e: 'close'): void; // é€ä¼ ElDialogçš„closeäº‹ä»¶
}&gt;();

// å†…éƒ¨å¤„ç†ç¡®è®¤é€»è¾‘
const handleConfirm = () =&gt; {
  emit('confirm');
  // å¯æ‰©å±•ï¼šç»Ÿä¸€çš„ç¡®è®¤æç¤º
  ElMessage.success('æ“ä½œæˆåŠŸ');
};

// å†…éƒ¨å¤„ç†å–æ¶ˆé€»è¾‘
const handleCancel = () =&gt; {
  emit('cancel');
  // è§¦å‘ElDialogçš„å…³é—­ï¼ˆé€šè¿‡é€ä¼ çš„visibleå±æ€§ç”±å¤–éƒ¨æ§åˆ¶ï¼‰
  emit('close');
};

// é€ä¼ ElDialogçš„closeäº‹ä»¶
const handleClose = () =&gt; {
  emit('close');
};
&lt;/script&gt;

&lt;style scoped&gt;
.base-dialog {
  --el-dialog-width: 600px; /* è‡ªå®šä¹‰é»˜è®¤å®½åº¦ï¼Œå¯è¢«å¤–éƒ¨è¦†ç›– */
}
.base-dialog__inner :deep(.el-dialog__header) {
  padding: 16px 20px;
  border-bottom: 1px solid #eee;
}
&lt;/style&gt;
</code></pre>
<h4 data-id="heading-9">æ­¥éª¤2ï¼šæŒ‡ä»¤æ‰©å±•ï¼ˆæ‹–æ‹½åŠŸèƒ½ï¼‰</h4>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// src/directives/dialogDrag.ts</span>
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">Directive</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">vDialogDrag</span>: <span class="hljs-title class_">Directive</span> = {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el</span>) {
    <span class="hljs-keyword">const</span> dialogHeaderEl = el.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.el-dialog__header'</span>);
    <span class="hljs-keyword">const</span> dragDom = el.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.el-dialog'</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span>;
    <span class="hljs-keyword">if</span> (!dialogHeaderEl || !dragDom) <span class="hljs-keyword">return</span>;

    <span class="hljs-comment">// è®¾ç½®æ‹–æ‹½å…ƒç´ å¯æ‹–åŠ¨</span>
    dialogHeaderEl.<span class="hljs-property">style</span>.<span class="hljs-property">cursor</span> = <span class="hljs-string">'move'</span>;
    dialogHeaderEl.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousedown'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-comment">// é¼ æ ‡æŒ‰ä¸‹ï¼Œè®¡ç®—å½“å‰å…ƒç´ è·ç¦»å¯è§†åŒºçš„è·ç¦»</span>
      <span class="hljs-keyword">const</span> disX = e.<span class="hljs-property">clientX</span> - dialogHeaderEl.<span class="hljs-property">offsetLeft</span>;
      <span class="hljs-keyword">const</span> disY = e.<span class="hljs-property">clientY</span> - dialogHeaderEl.<span class="hljs-property">offsetTop</span>;
      <span class="hljs-keyword">const</span> dragDomWidth = dragDom.<span class="hljs-property">offsetWidth</span>;
      <span class="hljs-keyword">const</span> dragDomHeight = dragDom.<span class="hljs-property">offsetHeight</span>;
      <span class="hljs-keyword">const</span> screenWidth = <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">clientWidth</span>;
      <span class="hljs-keyword">const</span> screenHeight = <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">clientHeight</span>;

      <span class="hljs-comment">// æœ€å¤§ç§»åŠ¨è·ç¦»</span>
      <span class="hljs-keyword">const</span> maxX = screenWidth - dragDomWidth;
      <span class="hljs-keyword">const</span> maxY = screenHeight - dragDomHeight;

      <span class="hljs-comment">// é¼ æ ‡ç§»åŠ¨äº‹ä»¶</span>
      <span class="hljs-keyword">const</span> <span class="hljs-title function_">moveFn</span> = (<span class="hljs-params">e: MouseEvent</span>) =&gt; {
        <span class="hljs-keyword">let</span> left = e.<span class="hljs-property">clientX</span> - disX;
        <span class="hljs-keyword">let</span> top = e.<span class="hljs-property">clientY</span> - disY;

        <span class="hljs-comment">// è¾¹ç•Œå¤„ç†</span>
        <span class="hljs-keyword">if</span> (left &lt; <span class="hljs-number">0</span>) left = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (left &gt; maxX) left = maxX;
        <span class="hljs-keyword">if</span> (top &lt; <span class="hljs-number">0</span>) top = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (top &gt; maxY) top = maxY;

        dragDom.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`<span class="hljs-subst">${left}</span>px`</span>;
        dragDom.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">`<span class="hljs-subst">${top}</span>px`</span>;
      };

      <span class="hljs-comment">// é¼ æ ‡æ¾å¼€äº‹ä»¶</span>
      <span class="hljs-keyword">const</span> <span class="hljs-title function_">upFn</span> = (<span class="hljs-params"/>) =&gt; {
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mousemove'</span>, moveFn);
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mouseup'</span>, upFn);
      };

      <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousemove'</span>, moveFn);
      <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mouseup'</span>, upFn);
    });
  },
};
</code></pre>
<h4 data-id="heading-10">æ­¥éª¤3ï¼šçˆ¶ç»„ä»¶è°ƒç”¨ï¼ˆé€ä¼ åŸç”ŸProps + æ‰©å±•ï¼‰</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;el-button @click="dialogVisible = true"&gt;æ‰“å¼€å¼¹çª—&lt;/el-button&gt;
  
  &lt;!-- è°ƒç”¨å°è£…åçš„BaseDialogï¼Œå¯é€ä¼ ElDialogæ‰€æœ‰åŸç”ŸProps --&gt;
  &lt;BaseDialog
    v-model="dialogVisible" &lt;!-- é€ä¼ ElDialogçš„visibleå±æ€§ï¼ˆv-modelè¯­æ³•ç³–ï¼‰ --&gt;
    title="è‡ªå®šä¹‰å¼¹çª—"
    width="800px" &lt;!-- è¦†ç›–é»˜è®¤å®½åº¦ --&gt;
    confirm-text="æäº¤" &lt;!-- è‡ªå®šä¹‰ä¸šåŠ¡Props --&gt;
    @confirm="handleConfirm"
    @close="handleClose"
  &gt;
    &lt;div&gt;å¼¹çª—å†…å®¹&lt;/div&gt;
    &lt;!-- è‡ªå®šä¹‰åº•éƒ¨æŒ‰é’®ï¼ˆè¦†ç›–é»˜è®¤æ’æ§½ï¼‰ --&gt;
    &lt;template #footer&gt;
      &lt;el-button @click="dialogVisible = false"&gt;å–æ¶ˆ&lt;/el-button&gt;
      &lt;el-button type="primary" @click="handleSubmit"&gt;æäº¤&lt;/el-button&gt;
    &lt;/template&gt;
  &lt;/BaseDialog&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { ref } from 'vue';
import BaseDialog from './components/BaseDialog.vue';

const dialogVisible = ref(false);

const handleConfirm = () =&gt; {
  console.log('ç¡®è®¤');
  dialogVisible.value = false;
};

const handleClose = () =&gt; {
  console.log('å…³é—­');
};

const handleSubmit = () =&gt; {
  console.log('è‡ªå®šä¹‰æäº¤');
  dialogVisible.value = false;
};
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-11">3.2. React 18 + AntD äºŒæ¬¡å°è£…å®æˆ˜</h3>
<p>ä»¥å°è£…<code>BaseTable</code>ï¼ˆåŸºäºAntDçš„Tableï¼‰ä¸ºä¾‹ï¼Œå®ç°â€œåˆ†é¡µå°è£…+é€ä¼ åŸç”ŸProps+ç»Ÿä¸€æ“ä½œåˆ—â€ï¼š</p>
<h4 data-id="heading-12">æ­¥éª¤1ï¼šåŸºç¡€å°è£…ï¼ˆåŒºåˆ†ä¸šåŠ¡Propsä¸åŸç”ŸPropsï¼‰</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Table</span>, <span class="hljs-title class_">Pagination</span>, <span class="hljs-title class_">Space</span>, <span class="hljs-title class_">Button</span>, <span class="hljs-title class_">Typography</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">TableProps</span>, <span class="hljs-title class_">PaginationProps</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;

<span class="hljs-comment">// å®šä¹‰ä¸šåŠ¡Propsï¼šä¸AntD TableåŸç”ŸPropsåŒºåˆ†</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">BaseTableProps</span>&lt;T = <span class="hljs-built_in">any</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Omit</span>&lt;<span class="hljs-title class_">TableProps</span>&lt;T&gt;, 'pagination'&gt; {
  <span class="hljs-comment">// ä¸šåŠ¡è‡ªå®šä¹‰åˆ†é¡µProps</span>
  paginationConfig?: <span class="hljs-title class_">PaginationProps</span>;
  <span class="hljs-comment">// ç»Ÿä¸€æ“ä½œåˆ—é…ç½®</span>
  actionColumn?: {
    width?: <span class="hljs-built_in">number</span>;
    fixed?: <span class="hljs-string">'left'</span> | <span class="hljs-string">'right'</span>;
    <span class="hljs-comment">// æ“ä½œé¡¹é…ç½®</span>
    <span class="hljs-attr">actions</span>: {
      <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span>;
      <span class="hljs-attr">onClick</span>: <span class="hljs-function">(<span class="hljs-params">record: T</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
      <span class="hljs-keyword">type</span>?: <span class="hljs-string">'primary'</span> | <span class="hljs-string">'default'</span> | <span class="hljs-string">'danger'</span>;
    }[];
  };
}

<span class="hljs-keyword">const</span> <span class="hljs-title class_">BaseTable</span> = &lt;T,&gt;<span class="hljs-function">(<span class="hljs-params">{
  columns,
  dataSource,
  paginationConfig,
  actionColumn,
  ...restProps // å‰©ä½™Propsï¼šé€ä¼ AntD Tableçš„åŸç”ŸProps
}: BaseTableProps&lt;T&gt;</span>) =&gt;</span> {
  <span class="hljs-comment">// åˆå¹¶åˆ—é…ç½®ï¼šæ–°å¢æ“ä½œåˆ—</span>
  <span class="hljs-keyword">const</span> mergedColumns = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> cols = [...(columns || [])];
    <span class="hljs-keyword">if</span> (actionColumn) {
      cols.<span class="hljs-title function_">push</span>({
        <span class="hljs-attr">title</span>: <span class="hljs-string">'æ“ä½œ'</span>,
        <span class="hljs-attr">key</span>: <span class="hljs-string">'action'</span>,
        <span class="hljs-attr">width</span>: actionColumn.<span class="hljs-property">width</span> || <span class="hljs-number">200</span>,
        <span class="hljs-attr">fixed</span>: actionColumn.<span class="hljs-property">fixed</span> || <span class="hljs-string">'right'</span>,
        <span class="hljs-attr">render</span>: <span class="hljs-function">(<span class="hljs-params">_, record</span>) =&gt;</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Space</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"small"</span>&gt;</span>
            {actionColumn.actions.map((action, index) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span>
                <span class="hljs-attr">type</span>=<span class="hljs-string">{action.type</span> || '<span class="hljs-attr">default</span>'}
                <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> action.onClick(record)}
              &gt;
                {action.text}
              <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">Space</span>&gt;</span></span>
        ),
      });
    }
    <span class="hljs-keyword">return</span> cols;
  }, [columns, actionColumn]);

  <span class="hljs-comment">// åˆ†é¡µçŠ¶æ€ç®¡ç†</span>
  <span class="hljs-keyword">const</span> [pagination, setPagination] = useState&lt;<span class="hljs-title class_">PaginationProps</span>&gt;({
    <span class="hljs-attr">current</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">pageSize</span>: <span class="hljs-number">10</span>,
    <span class="hljs-attr">showSizeChanger</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">showQuickJumper</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">showTotal</span>: <span class="hljs-function">(<span class="hljs-params">total</span>) =&gt;</span> <span class="hljs-string">`å…± <span class="hljs-subst">${total}</span> æ¡`</span>,
    ...paginationConfig,
  });

  <span class="hljs-comment">// ç›‘å¬æ•°æ®æ€»æ•°ï¼Œæ›´æ–°åˆ†é¡µ</span>
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (paginationConfig?.<span class="hljs-property">total</span> !== <span class="hljs-literal">undefined</span>) {
      <span class="hljs-title function_">setPagination</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> ({ ...prev, <span class="hljs-attr">total</span>: paginationConfig.<span class="hljs-property">total</span> }));
    }
  }, [paginationConfig?.<span class="hljs-property">total</span>]);

  <span class="hljs-comment">// åˆ†é¡µå˜æ›´å›è°ƒ</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleTableChange</span> = (<span class="hljs-params">
    pagination: PaginationProps,
    filters: <span class="hljs-built_in">any</span>,
    sorter: <span class="hljs-built_in">any</span>
  </span>) =&gt; {
    <span class="hljs-title function_">setPagination</span>(pagination);
    <span class="hljs-comment">// é€ä¼ åŸç”ŸonChangeäº‹ä»¶</span>
    restProps.<span class="hljs-property">onChange</span>?.(pagination, filters, sorter);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">background:</span> '#<span class="hljs-attr">fff</span>', <span class="hljs-attr">padding:</span> <span class="hljs-attr">16</span>, <span class="hljs-attr">borderRadius:</span> <span class="hljs-attr">4</span> }}&gt;</span>
      {/* é€ä¼ AntD Tableçš„æ‰€æœ‰åŸç”ŸProps */}
      &lt;Table<span class="hljs-tag">&lt;<span class="hljs-name">T</span>&gt;</span>
        columns={mergedColumns}
        dataSource={dataSource}
        pagination={false} // ç¦ç”¨åŸç”Ÿåˆ†é¡µï¼Œè‡ªå®šä¹‰
        onChange={handleTableChange}
        bordered // ä¸šåŠ¡é»˜è®¤å€¼ï¼Œå¯è¢«restPropsè¦†ç›–
        {...restProps} // é€ä¼ å‰©ä½™åŸç”ŸPropsï¼ˆå¦‚rowKeyã€loadingã€scrollï¼‰
      /&gt;
      {/* è‡ªå®šä¹‰åˆ†é¡µç»„ä»¶ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">marginTop:</span> <span class="hljs-attr">16</span>, <span class="hljs-attr">textAlign:</span> '<span class="hljs-attr">right</span>' }}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Pagination</span>
          {<span class="hljs-attr">...pagination</span>}
          {<span class="hljs-attr">...paginationConfig</span>}
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(page,</span> <span class="hljs-attr">pageSize</span>) =&gt;</span> {
            setPagination(prev =&gt; ({ ...prev, current: page, pageSize }));
          }}
        /&gt;
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  );
};

export default BaseTable;
</span></code></pre>
<h4 data-id="heading-13">æ­¥éª¤2ï¼šçˆ¶ç»„ä»¶è°ƒç”¨ï¼ˆé€ä¼ åŸç”ŸProps + æ‰©å±•ï¼‰</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">BaseTable</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/BaseTable'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span>, message } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;

<span class="hljs-comment">// æ¨¡æ‹Ÿæ•°æ®</span>
<span class="hljs-keyword">const</span> dataSource = [
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">'å¯ç”¨'</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'æå››'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">22</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">'ç¦ç”¨'</span> },
];

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Page</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// åˆ—é…ç½®</span>
  <span class="hljs-keyword">const</span> columns = [
    { <span class="hljs-attr">title</span>: <span class="hljs-string">'å§“å'</span>, <span class="hljs-attr">dataIndex</span>: <span class="hljs-string">'name'</span>, <span class="hljs-attr">key</span>: <span class="hljs-string">'name'</span> },
    { <span class="hljs-attr">title</span>: <span class="hljs-string">'å¹´é¾„'</span>, <span class="hljs-attr">dataIndex</span>: <span class="hljs-string">'age'</span>, <span class="hljs-attr">key</span>: <span class="hljs-string">'age'</span> },
    { <span class="hljs-attr">title</span>: <span class="hljs-string">'çŠ¶æ€'</span>, <span class="hljs-attr">dataIndex</span>: <span class="hljs-string">'status'</span>, <span class="hljs-attr">key</span>: <span class="hljs-string">'status'</span> },
  ];

  <span class="hljs-comment">// æ“ä½œåˆ—é…ç½®</span>
  <span class="hljs-keyword">const</span> actionColumn = {
    <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>,
    <span class="hljs-attr">fixed</span>: <span class="hljs-string">'right'</span>,
    <span class="hljs-attr">actions</span>: [
      {
        <span class="hljs-attr">text</span>: <span class="hljs-string">'ç¼–è¾‘'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'primary'</span>,
        <span class="hljs-attr">onClick</span>: <span class="hljs-function">(<span class="hljs-params">record</span>) =&gt;</span> {
          message.<span class="hljs-title function_">success</span>(<span class="hljs-string">`ç¼–è¾‘<span class="hljs-subst">${record.name}</span>`</span>);
        },
      },
      {
        <span class="hljs-attr">text</span>: <span class="hljs-string">'åˆ é™¤'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'danger'</span>,
        <span class="hljs-attr">onClick</span>: <span class="hljs-function">(<span class="hljs-params">record</span>) =&gt;</span> {
          message.<span class="hljs-title function_">warning</span>(<span class="hljs-string">`åˆ é™¤<span class="hljs-subst">${record.name}</span>`</span>);
        },
      },
    ],
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">padding:</span> <span class="hljs-attr">20</span> }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">BaseTable</span>
        <span class="hljs-attr">rowKey</span>=<span class="hljs-string">"id"</span> // <span class="hljs-attr">é€ä¼ AntD</span> <span class="hljs-attr">TableåŸç”ŸProps</span>
        <span class="hljs-attr">columns</span>=<span class="hljs-string">{columns}</span>
        <span class="hljs-attr">dataSource</span>=<span class="hljs-string">{dataSource}</span>
        <span class="hljs-attr">scroll</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">x:</span> <span class="hljs-attr">1000</span> }} // <span class="hljs-attr">é€ä¼ åŸç”ŸProps</span>ï¼š<span class="hljs-attr">æ¨ªå‘æ»šåŠ¨</span>
        <span class="hljs-attr">loading</span>=<span class="hljs-string">{false}</span> // <span class="hljs-attr">é€ä¼ åŸç”ŸProps</span>ï¼š<span class="hljs-attr">åŠ è½½çŠ¶æ€</span>
        <span class="hljs-attr">paginationConfig</span>=<span class="hljs-string">{{</span>
          <span class="hljs-attr">total:</span> <span class="hljs-attr">2</span>,
          <span class="hljs-attr">pageSize:</span> <span class="hljs-attr">10</span>,
        }}
        <span class="hljs-attr">actionColumn</span>=<span class="hljs-string">{actionColumn}</span>
        // <span class="hljs-attr">é€ä¼ åŸç”Ÿäº‹ä»¶</span>
        <span class="hljs-attr">onRow</span>=<span class="hljs-string">{(record)</span> =&gt;</span> ({
          onClick: () =&gt; console.log('ç‚¹å‡»è¡Œ', record),
        })}
      /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Page</span>;
</code></pre>
<h2 data-id="heading-14">4. é«˜æ•ˆä¸”æ˜“æ‰©å±•çš„å°è£…åŸåˆ™</h2>
<p>ä¸‹é¢æ˜¯ä¸€äº›å°è£…æ—¶å€™çš„åŸåˆ™ï¼ŒVue/Reacté€šç”¨ï¼š</p>
<h3 data-id="heading-15">4.1. Propsè®¾è®¡</h3>
<p>åˆ†å±‚é€ä¼ ï¼Œä¸ä¸¢å¤±åŸç”Ÿèƒ½åŠ›</p>
<ul>
<li>Vueï¼šç”¨<code>$attrs</code>é€ä¼ æ‰€æœ‰åŸç”ŸPropsï¼Œ<code>defineProps</code>ä»…å£°æ˜ä¸šåŠ¡è‡ªå®šä¹‰Propsï¼Œ<code>inheritAttrs: false</code>é¿å…å±æ€§æ±¡æŸ“ï¼›</li>
<li>Reactï¼šç”¨<code>Omit</code>å‰”é™¤ä¸šåŠ¡Propsï¼Œå‰©ä½™Propsé€šè¿‡<code>{...restProps}</code>é€ä¼ ï¼ŒåŒºåˆ†â€œä¸šåŠ¡é€»è¾‘Propsâ€å’Œâ€œåŸç”Ÿç»„ä»¶Propsâ€ã€‚</li>
</ul>
<h3 data-id="heading-16">4.2. æ‰©å±•ç‚¹è®¾è®¡</h3>
<p>æ’æ§½/Childrenä¼˜å…ˆ</p>
<ul>
<li>Vueï¼šé¢„ç•™å…·åæ’æ§½ï¼ˆå¦‚Dialogçš„footerã€Tableçš„actionï¼‰ï¼Œæ”¯æŒå±€éƒ¨æ›¿æ¢ï¼›</li>
<li>Reactï¼šé€šè¿‡<code>children</code>å’Œè‡ªå®šä¹‰æ’æ§½å¯¹è±¡ï¼ˆå¦‚<code>slots</code>ï¼‰å®ç°æ‰©å±•ï¼Œé¿å…ç¡¬ç¼–ç ã€‚</li>
</ul>
<h3 data-id="heading-17">4.3. çŠ¶æ€ç®¡ç†</h3>
<p>å†…éƒ¨éš”ç¦»ï¼Œå¤–éƒ¨å¯æ§</p>
<ul>
<li>ç»„ä»¶å†…éƒ¨ç»´æŠ¤åŸºç¡€çŠ¶æ€ï¼ˆå¦‚åˆ†é¡µçš„current/pageSizeï¼‰ï¼Œå¤–éƒ¨é€šè¿‡Propsè¦†ç›–é»˜è®¤å€¼ï¼›</li>
<li>äº‹ä»¶é€ä¼ ï¼šå†…éƒ¨å¤„ç†åŸºç¡€é€»è¾‘åï¼Œé€šè¿‡emit/å›è°ƒå°†ç»“æœæš´éœ²ç»™å¤–éƒ¨ã€‚</li>
</ul>
<h3 data-id="heading-18">4.4. æ ·å¼å°è£…</h3>
<p>æœ‰é»˜è®¤æ ·å¼+å¯è¦†ç›–</p>
<ul>
<li>Vueï¼šç”¨<code>scoped</code>+<code>:deep()</code>ç©¿é€æ ·å¼ï¼Œé¢„ç•™CSSå˜é‡ï¼ˆå¦‚<code>--el-dialog-width</code>ï¼‰æ”¯æŒå¤–éƒ¨å®šåˆ¶ï¼›</li>
<li>Reactï¼šç”¨CSS Moduleséš”ç¦»æ ·å¼ï¼Œæ”¯æŒä¼ é€’<code>className</code>è¦†ç›–é»˜è®¤æ ·å¼ã€‚</li>
</ul>
<h3 data-id="heading-19">4.5. è¾¹ç•Œå¤„ç†</h3>
<p>éœ€è¦æœ‰å…œåº•ä¸å…¼å®¹</p>
<ul>
<li>å¯¹ç©ºæ•°æ®ã€ç©ºåˆ—é…ç½®åšå…œåº•ï¼ˆå¦‚Tableæ— æ•°æ®æ—¶æ˜¾ç¤ºâ€œæš‚æ— æ•°æ®â€ï¼‰ï¼›</li>
<li>å…¼å®¹åŸç”Ÿç»„ä»¶çš„æ‰€æœ‰äº‹ä»¶ï¼ˆå¦‚Dialogçš„closeã€Tableçš„onChangeï¼‰ã€‚</li>
</ul>
<h2 data-id="heading-20">5. å°è£…çš„ä¸å›¢é˜Ÿè§„èŒƒ</h2>
<p>ä¸‹é¢æ˜¯ä¸€äº›å°è£…çš„"åº¦"ï¼Œä¸å›¢é˜Ÿè§„èŒƒï¼š</p>
<h3 data-id="heading-21">5.1. é¿å…è¿‡åº¦å°è£…</h3>
<ul>
<li>ä¸å°è£…â€œä¸€æ¬¡æ€§â€ç»„ä»¶ï¼šä»…å•ä¸ªé¡µé¢ä½¿ç”¨ã€æ— å¤ç”¨ä»·å€¼çš„é€»è¾‘æ— éœ€å°è£…ï¼›</li>
<li>ä¸æ»¥ç”¨é€ä¼ ï¼šæ ¸å¿ƒä¸šåŠ¡Propsæ˜¾å¼å£°æ˜ï¼Œé¿å…æ‰€æœ‰å±æ€§éƒ½é€ä¼ å¯¼è‡´ç»´æŠ¤å›°éš¾ã€‚</li>
</ul>
<h3 data-id="heading-22">5.2. ç»„ä»¶åˆ†å±‚ï¼šåŸºç¡€ç»„ä»¶ vs ä¸šåŠ¡ç»„ä»¶</h3>




















<table><thead><tr><th>ç±»å‹</th><th>ç¤ºä¾‹</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td>åŸºç¡€ç»„ä»¶</td><td>BaseDialogã€BaseTable</td><td>åŸºäºElement UI/AntDå°è£…ï¼Œå…¨é¡¹ç›®å¤ç”¨</td></tr><tr><td>ä¸šåŠ¡ç»„ä»¶</td><td>OrderTableã€UserForm</td><td>ç»‘å®šå…·ä½“ä¸šåŠ¡é€»è¾‘ï¼Œä»…ä¸šåŠ¡æ¨¡å—å¤ç”¨</td></tr></tbody></table>
<h3 data-id="heading-23">5.3. æ–‡æ¡£åŒ–ï¼šæ ‡æ³¨é€ä¼ èƒ½åŠ›</h3>
<p>å°è£…ç»„ä»¶éœ€æ³¨æ˜â€œæ”¯æŒé€ä¼ XXåŸç”Ÿç»„ä»¶çš„æ‰€æœ‰Props/äº‹ä»¶â€ï¼Œç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">/**
 * BaseTable åŸºäºAntD Tableçš„äºŒæ¬¡å°è£…
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">BaseTableProps</span>} <span class="hljs-variable">props</span> - ç»„ä»¶å±æ€§
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">PaginationProps</span>} props.paginationConfig - åˆ†é¡µé…ç½®ï¼ˆä¸šåŠ¡è‡ªå®šä¹‰ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} props.actionColumn - æ“ä½œåˆ—é…ç½®ï¼ˆä¸šåŠ¡è‡ªå®šä¹‰ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">TableProps</span>} ...restProps - é€ä¼ AntD Tableçš„æ‰€æœ‰åŸç”ŸPropsï¼ˆé™¤paginationï¼‰
 */</span>
</code></pre>
<h2 data-id="heading-24">6. æ€»ç»“</h2>
<p>åŸºäºElement UI/AntDçš„äºŒæ¬¡å°è£…ï¼Œæ ¸å¿ƒæ˜¯â€œä¿ç•™åŸç”Ÿèƒ½åŠ›+æ–°å¢ä¸šåŠ¡é€»è¾‘â€â€”â€”é€šè¿‡é€ä¼ Propsç¡®ä¿ä¸ä¸¢å¤±ç»„ä»¶åº“çš„åŸç”ŸåŠŸèƒ½ï¼Œé€šè¿‡è‡ªå®šä¹‰Propså’Œæ’æ§½å®ç°ä¸šåŠ¡å®šåˆ¶ï¼Œæœ€ç»ˆè¾¾åˆ°â€œå¤ç”¨ã€ç»Ÿä¸€ã€æ˜“æ‰©å±•â€çš„ç›®æ ‡ã€‚</p>
<p>Vueä¸­é€šè¿‡<code>$attrs</code>å’Œ<code>inheritAttrs: false</code>å®ç°é€ä¼ ï¼ŒReactä¸­é€šè¿‡å‰©ä½™å‚æ•°<code>{...restProps}</code>åŒºåˆ†ä¸šåŠ¡ä¸åŸç”ŸPropsï¼Œä¸¤è€…æ ¸å¿ƒæ€è·¯ä¸€è‡´ï¼šè®©å°è£…åçš„ç»„ä»¶æ—¢æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ï¼Œåˆä¿æŒåŸç”Ÿç»„ä»¶çš„çµæ´»æ€§ã€‚</p>
<p>å¥½çš„äºŒæ¬¡å°è£…ç»„ä»¶ï¼Œåº”è¯¥æ˜¯â€œå¯¹å¼€å‘è€…å‹å¥½â€çš„â€”â€”è°ƒç”¨æ–¹æ— éœ€å…³å¿ƒå†…éƒ¨å®ç°ï¼Œåªéœ€é€šè¿‡ç®€å•çš„Propsé…ç½®å³å¯å®Œæˆä¸šåŠ¡éœ€æ±‚ï¼ŒåŒæ—¶èƒ½çµæ´»æ‰©å±•åŸç”Ÿèƒ½åŠ›ï¼ŒçœŸæ­£åšåˆ°<strong>å°è£…ä¸å°æ­»</strong>ï¼Œä»¥ä¸Šã€‚</p>
<hr/>
<blockquote>
<p>æœ¬æ¬¡åˆ†äº«å°±åˆ°è¿™å„¿å•¦ï¼Œæˆ‘æ˜¯é¹å¤šå¤šï¼Œæ·±è€•å‰ç«¯çš„æŠ€æœ¯åˆ›ä½œè€…ï¼Œå¦‚æœæ‚¨çœ‹äº†è§‰å¾—æœ‰å¸®åŠ©ï¼Œæ¬¢è¿è¯„è®ºï¼Œå…³æ³¨ï¼Œç‚¹èµï¼Œè½¬å‘ï¼Œæˆ‘ä»¬ä¸‹æ¬¡è§~</p>
</blockquote>
<p>PSï¼šåœ¨æœ¬é¡µæŒ‰F12ï¼Œåœ¨consoleä¸­è¾“å…¥document.getElementsByClassName('panel-btn')[0].click();æœ‰æƒŠå–œå“¦~</p>
<p><code>å¾€æœŸæ–‡ç« </code></p>
<ul>
<li><a href="https://juejin.cn/post/7575468252657303593" target="_blank" title="https://juejin.cn/post/7575468252657303593">HTMLçš„Videoä»åŸºç¡€ä½¿ç”¨åˆ°é«˜çº§å®æˆ˜+å…¼å®¹çš„å®Œå…¨æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7568192652286754870" target="_blank" title="https://juejin.cn/post/7568192652286754870">çº¯å‰ç«¯æå–å›¾ç‰‡é¢œè‰²æ’ä»¶Color-Thiefæ•™å­¦+å®æˆ˜å®Œæ•´æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7565737512816771135" target="_blank" title="https://juejin.cn/post/7565737512816771135">react-konvaå®æˆ˜æŒ‡å—ï¼šCanvasé«˜æ€§èƒ½+æ˜“ç»´æŠ¤çš„ç»„ä»¶åŒ–å›¾å½¢å¼€å‘å®ç°æ•™ç¨‹</a></li>
<li><a href="https://juejin.cn/post/7560905838074462271" target="_blank" title="https://juejin.cn/post/7560905838074462271">Reactæ— é™æ»šåŠ¨æ’ä»¶react-infinite-scroll-componentçš„é…ç½®+ä¼˜åŒ–+é¿å‘æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7560542615484137491" target="_blank" title="https://juejin.cn/post/7560542615484137491">å‰ç«¯éŸ³é¢‘å…¼å®¹è§£å†³ï¼šéŸ³é¢‘ç¥å™¨howler.jsä»åŸºç¡€åˆ°è¿›é˜¶å®Œæ•´ä½¿ç”¨æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7559871680015024169" target="_blank" title="https://juejin.cn/post/7559871680015024169">ä½¿ç”¨React-OAuthè¿›è¡ŒGoogle/GitHubç™»å½•çš„æ•™ç¨‹å’Œæ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7550585427834404927" target="_blank" title="https://juejin.cn/post/7550585427834404927">çº¯å‰ç«¯äººè„¸è¯†åˆ«åˆ©å™¨ï¼šface-api.jsæ‰‹æŠŠæ‰‹æ·±å…¥è§£ææ•™å­¦</a></li>
<li><a href="https://juejin.cn/post/7553865490732433462" target="_blank" title="https://juejin.cn/post/7553865490732433462">å…³äºReactçˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•forwardRefçš„è¯¦è§£å’Œæ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7553484874609410074" target="_blank" title="https://juejin.cn/post/7553484874609410074">Reactè·¨ç»„ä»¶æ•°æ®å…±äº«useContextè¯¦è§£å’Œæ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7545087762837815334" target="_blank" title="https://juejin.cn/post/7545087762837815334">Webå›¾åƒç¼–è¾‘ç¥å™¨tui.image-editorä»åŸºç¡€åˆ°è¿›é˜¶çš„å®æˆ˜æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7544323659788288046" target="_blank" title="https://juejin.cn/post/7544323659788288046">å¼€å‘ä¸ªäººå¾®ä¿¡å°ç¨‹åºç±»ç›®é€‰æ‹©/ç›ˆåˆ©æ–¹å¼/æˆæœ¬æ§åˆ¶ä¸æœåŠ¡å™¨æ¥å…¥æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7541741121400864778" target="_blank" title="https://juejin.cn/post/7541741121400864778">å‰ç«¯å›¾ç‰‡è£å‰ªCropper.jsæ ¸å¿ƒåŠŸèƒ½ä¸å®æˆ˜æŠ€å·§è¯¦è§£</a></li>
<li><a href="https://juejin.cn/post/7536530451461472265" target="_blank" title="https://juejin.cn/post/7536530451461472265">ç¼–è¾‘å™¨ä¹Ÿæœ‰é‚ªä¿®ï¼Ÿç›˜ç‚¹VS Codeé‚ªé—¨/æœ‰è¶£çš„æ‰©å±•</a></li>
<li><a href="https://juejin.cn/post/7535005018257981466" target="_blank" title="https://juejin.cn/post/7535005018257981466">jsä½¿ç”¨IntersectionObserverå®ç°ç›®æ ‡å…ƒç´ å¯è§åº¦çš„äº¤äº’</a></li>
<li><a href="https://juejin.cn/post/7534547200330121225" target="_blank" title="https://juejin.cn/post/7534547200330121225">Webå‰ç«¯é¡µé¢å¼€å‘é˜¿æ‹‰ä¼¯è¯­ç§é€‚é…æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7516122409948020736" target="_blank" title="https://juejin.cn/post/7516122409948020736">è®©ç½‘é¡µæ‹¥æœ‰Appä½“éªŒï¼ŸPWA å°†ç½‘é¡µå˜ä¸ºæ¡Œé¢åº”ç”¨çš„ä¿å§†çº§æ•™ç¨‹PWA</a></li>
<li><a href="https://juejin.cn/post/6953803916484018206" target="_blank" title="https://juejin.cn/post/6953803916484018206">ä½¿ç”¨nvmç®¡ç†node.jsç‰ˆæœ¬ä»¥åŠæ›´æ¢npmæ·˜å®é•œåƒæº</a></li>
<li><a href="https://juejin.cn/post/7140443283209060383" target="_blank" title="https://juejin.cn/post/7140443283209060383">æ‰‹æŠŠæ‰‹æ•™ä½ æ­å»ºè§„èŒƒçš„å›¢é˜Ÿvueé¡¹ç›®ï¼ŒåŒ…å«commitlintï¼Œeslintï¼Œprettierï¼Œhuskyï¼Œcommitizenç­‰ç­‰</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¼–å†™æç¤ºè¯éœ€è¦éµå¾ªçš„äº”ä¸ªåŸåˆ™ï¼ˆé™„å®è·µæ¡ˆä¾‹ï¼‰]]></title>    <link>https://juejin.cn/post/7578760341279883305</link>    <guid>https://juejin.cn/post/7578760341279883305</guid>    <pubDate>2025-12-02T00:48:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578760341279883305" data-draft-id="7578762210286534719" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¼–å†™æç¤ºè¯éœ€è¦éµå¾ªçš„äº”ä¸ªåŸåˆ™ï¼ˆé™„å®è·µæ¡ˆä¾‹ï¼‰"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-02T00:48:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç£Šç£Šè½è½"/> <meta itemprop="url" content="https://juejin.cn/user/3054882885469577"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¼–å†™æç¤ºè¯éœ€è¦éµå¾ªçš„äº”ä¸ªåŸåˆ™ï¼ˆé™„å®è·µæ¡ˆä¾‹ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3054882885469577/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç£Šç£Šè½è½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T00:48:46.000Z" title="Tue Dec 02 2025 00:48:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ç£Šç£Šè½è½ï¼Œç›®å‰æˆ‘åœ¨æŠ€æœ¯ä¸Šä¸»è¦å…³æ³¨ï¼šJavaã€Golangã€AIã€æ¶æ„è®¾è®¡ã€äº‘åŸç”Ÿå’Œè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚æ¬¢è¿æ¥æˆ‘çš„åšå®¢ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fleileiluoluo.com%2Fposts%2Fthe-five-principles-of-prompting.html" target="_blank" title="https://leileiluoluo.com/posts/the-five-principles-of-prompting.html" ref="nofollow noopener noreferrer">leileiluoluo.com</a>ï¼‰è·å–æˆ‘çš„æœ€è¿‘æ›´æ–°ï¼</p>
</blockquote>
<p>å¼€å§‹æœ¬æ–‡å‰ï¼Œè®©æˆ‘ä»¬é¦–å…ˆæ˜ç¡®æç¤ºè¯ä¸æç¤ºå·¥ç¨‹çš„æ¦‚å¿µã€‚æç¤ºè¯æ˜¯æˆ‘ä»¬ä¸å¤§è¯­è¨€æ¨¡å‹æ²Ÿé€šæ—¶è¾“å…¥çš„æŒ‡ä»¤ï¼Œè€Œæç¤ºå·¥ç¨‹åˆ™æ˜¯å‘ç°èƒ½ç”Ÿæˆç¬¦åˆé¢„æœŸã€ç¨³å®šã€å¯é ã€å’Œå¯å¤ç°ç»“æœçš„æç¤ºè¯çš„è¿‡ç¨‹ã€‚</p>
<p>ä¸ºä»€ä¹ˆéœ€è¦æç¤ºå·¥ç¨‹å‘¢ï¼Ÿå°±æ˜¯å› ä¸ºå½“å‰çš„ç”Ÿæˆå¼äººå·¥æ™ºèƒ½è¿˜ä¸å¤Ÿæ™ºèƒ½ï¼Œå…¶è¾“å‡ºå…·æœ‰ä¸ç¡®å®šæ€§ï¼Œç”¨ä¸“ä¸šæœ¯è¯­æ¥è¯´ï¼Œå°±æ˜¯å­˜åœ¨éšæœºç”Ÿæˆã€Œæ¬¡å“ã€çš„å¯èƒ½ã€‚ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¿…é¡»æœ‰ä¸€å¥—å·¥ç¨‹åŒ–çš„æ–¹æ³•å¯¹æç¤ºè¯è¿›è¡Œé€‚å½“çš„ä¼˜åŒ–ã€‚</p>
<p>ä¸€äº›å·¥ç¨‹å¸ˆåœ¨å®è·µä¸­ä¹Ÿç¡®å®æ¢ç´¢å‡ºä¸€ç»„å¥½ç”¨çš„åŸåˆ™ï¼Œè¢«ç§°ä¸ºã€Œç¼–å†™æç¤ºè¯çš„äº”ä¸ªåŸåˆ™ã€ï¼Œéµå¾ªè¿™äº›åŸåˆ™ç¼–å†™å‡ºæ¥çš„æç¤ºè¯èƒ½ä»¥æ›´é«˜çš„æ¦‚ç‡è®© AI æ¨¡å‹ç”Ÿæˆç¨³å®šã€å¯é ã€å¯å¤ç°çš„ç»“æœã€‚</p>
<p>æ¥ä¸‹æ¥å°±ä»‹ç»ä¸€ä¸‹è¿™ã€Œäº”ä¸ªåŸåˆ™ã€ï¼Œç„¶åä»¥ã€ŒSpring Boot é¡¹ç›®ä¸­çš„ MyBatis è½¬ JPAã€ä¸ºä¾‹æ¼”ç¤ºå¦‚ä½•éµç…§åŸåˆ™ä¼˜åŒ–æç¤ºè¯æ¥è®© AI åŠ©æ‰‹è¾¾åˆ°é«˜è´¨é‡çš„ç»“æœäº¤ä»˜ã€‚</p>
<h2 data-id="heading-0">1 ç¼–å†™æç¤ºè¯éœ€è¦éµå¾ªçš„äº”ä¸ªåŸåˆ™</h2>
<ul>
<li><strong>æ˜ç¡®æ–¹å‘</strong></li>
</ul>
<p>è¯¦ç»†æè¿°æœŸæœ›çš„ç»“æœï¼Œæœ€å¥½ç»™å‡ºä¸€ä¸ªç°å®ä¸–ç•Œçš„å‚è€ƒæ¨¡æ¿ã€‚æ¯”å¦‚ï¼šç”Ÿæˆä¸€æ®µæç¬‘çš„è„±å£ç§€ç¨¿å­ï¼Œå‚è€ƒã€Œå¾å¿—èƒœã€é£æ ¼ã€‚</p>
<ul>
<li><strong>è§„èŒƒæ ¼å¼</strong></li>
</ul>
<p>æŒ‡å®šå¤§æ¨¡å‹éœ€éµå¾ªçš„è§„åˆ™ï¼Œå¹¶æ˜ç¡®é™å®šè¾“å‡ºç»“æœçš„ç»“æ„æˆ–æ ¼å¼ã€‚æ¯”å¦‚ï¼šè¦æ±‚å¤§æ¨¡å‹è¿”å›çš„ç»“æœä¸º JSON æ ¼å¼ï¼Œé¿å…æ¥æ”¶æ— è§„åˆ™çš„ç»“æœï¼Œä¸”ä¾¿äºç¨‹åºåŒ–é›†æˆã€‚</p>
<ul>
<li><strong>æä¾›èŒƒä¾‹</strong></li>
</ul>
<p>æä¾›æ ·ä¾‹ä»£ç æˆ–æä¾›ä¸€ç»„å¤šæ ·åŒ–çš„é¢„æœŸè¾“å‡ºçš„èŒƒä¾‹ä¾›å¤§æ¨¡å‹å‚è€ƒã€‚æ¯”å¦‚ï¼šç”Ÿæˆä¸€ç»„æ ·ä¾‹å­¦ç”Ÿ JSON æ•°æ®ï¼Œå¦‚ <code>[{"name": "Larry"}, {"name": "Lucy"}]</code>ã€‚</p>
<ul>
<li><strong>è¯„ä¼°è´¨é‡</strong></li>
</ul>
<p>å¯¹è¾“å‡ºç»“æœè¿›è¡Œè¯„çº§ï¼Œé€šè¿‡æµ‹è¯•æ¥æ‰¾å‡ºæå‡æ¨¡å‹å‡†ç¡®æ€§çš„å…³é”®å› ç´ ã€‚æ¯”å¦‚ï¼šé’ˆå¯¹ AI æ¨¡å‹çš„è¾“å‡ºç»“æœï¼Œç»™å‡ºæ¯ä¸ªç»“æœçš„åˆ†å€¼ï¼Œç„¶ååé¦ˆç»™æ¨¡å‹ï¼Œè¿™æ ·èƒ½æå‡è¾“å‡ºç»“æœçš„å‡†ç¡®æ€§ã€‚</p>
<ul>
<li><strong>æ‹†åˆ†ä»»åŠ¡</strong></li>
</ul>
<p>ä¸è¦å°†ä¸€ä¸ªå¤æ‚ä»»åŠ¡ä¸åšæ‹†åˆ†å°±ç›´æ¥æ‰”ç»™å¤§æ¨¡å‹ï¼Œè€Œåº”å°†å…¶æ‹†åˆ†ä¸ºå¤šä¸ªæ­¥éª¤ï¼Œè¿™æ ·å¤§æ¨¡å‹åšèµ·æ¥æ‰æ›´å¾—å¿ƒåº”æ‰‹ã€‚æ¯”å¦‚ï¼šä¸è¦è·Ÿå¤§æ¨¡å‹è¯´ã€ŒæŠŠè¿™ä¸ªäº‹åšäº†ã€ï¼Œè€Œæ˜¯åº”å°†ä¸€ä¸ªäº‹æ‹†åˆ†ä¸ºå¤šä¸ªæ­¥éª¤ï¼Œç„¶åæŒ‡å¯¼å¤§æ¨¡å‹ä¸€æ­¥æ­¥å»è¾¾æˆç›®æ ‡ã€‚</p>
<h2 data-id="heading-1">2 å®è·µæ¡ˆä¾‹ï¼šå°† Spring Boot é¡¹ç›®çš„æ•°æ®åº“è®¿é—®å±‚ç”± MyBatis è½¬æ¢ä¸º JPA</h2>
<p>æ¥ä¸‹æ¥ä»¥å®é™…é¡¹ç›®ã€Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.boyouquan.com%2F" target="_blank" title="https://www.boyouquan.com/" ref="nofollow noopener noreferrer">åšå‹åœˆ</a>ã€çš„åç«¯ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fleileiluoluo%2Fboyouquan-api" target="_blank" title="https://github.com/leileiluoluo/boyouquan-api" ref="nofollow noopener noreferrer">boyouquan-api</a>ï¼‰æ•°æ®åº“è®¿é—®å±‚çš„è½¬æ¢ä¸ºä¾‹ï¼Œæ¼”ç¤ºç¼–å†™æç¤ºè¯æ—¶å¦‚ä½•è¿ç”¨ä¸Šè¿°äº”ä¸ªåŸåˆ™ã€‚</p>
<p>åšå‹åœˆåç«¯æ˜¯ä¸€ä¸ªä½¿ç”¨ Maven ç®¡ç†çš„ Spring Boot é¡¹ç›®ï¼Œè´Ÿè´£ç»™å‰ç«¯æä¾› RESTful APIã€‚</p>
<p>å…¶æ•°æ®åº“è®¿é—®å±‚ç›®å‰æ˜¯åŸºäº MyBatis å®ç°çš„ï¼Œæºç ç›®å½• <code>src/main/java</code> ä¸‹çš„åŒ… <code>com.boyouquan.dao</code> ä¸‹å®šä¹‰äº†ä¸€ç»„ Mapper æ¥å£ï¼›èµ„æºç›®å½• <code>src/main/resources</code> ä¸‹çš„å­ç›®å½• <code>mapper</code> ä¸‹å­˜æ”¾ä¸ Mapper æ¥å£å¯¹åº”çš„ XML æ–‡ä»¶ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/790c35adfce34f5b8bf2080e67907672~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56OK56OK6JC96JC9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765241326&amp;x-signature=KQ8zsYdSzmHTphIZucrrOfHC824%3D" alt="å·¥ç¨‹ç›®å½•ç»“æ„" loading="lazy"/></p>
<p>Mapper æ¥å£ä¸­å®šä¹‰äº†ä¸€ç»„æ–¹æ³•ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e4843783fd3f49cb92eb02c4be6f3f3e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56OK56OK6JC96JC9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765241326&amp;x-signature=A8JKuGjLgRQbsveL9QQ6tX%2FU1m4%3D" alt="MyBatis Mapper æ¥å£" loading="lazy"/></p>
<p>ä¸ Mappper æ¥å£å¯¹åº”çš„ XML æ–‡ä»¶ä¸­å®šä¹‰äº†æ–¹æ³•æ‰€ä½¿ç”¨çš„ SQLï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9df7fddc4c864fcdb03030ce0192c29f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56OK56OK6JC96JC9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765241326&amp;x-signature=luwl%2FeKDRoiNf2Gbo1vckDWUu%2BM%3D" alt="MyBatis Mapper XML æ–‡ä»¶" loading="lazy"/></p>
<p>è‹¥æˆ‘ä»¬æƒ³è®© AI åŠ©æ‰‹å¸®å¿™å°†è¯¥å·¥ç¨‹çš„æ•°æ®åº“è®¿é—®å±‚ç”± MyBatis è½¬æ¢ä¸º JPAï¼Œè¯¥å¦‚ä½•ç¼–å†™æç¤ºè¯å‘¢ï¼Ÿ</p>
<p>ä¸‹é¢æˆ‘ä»¬é¦–å…ˆå°è¯•ä¸€ä¸‹æœªå­¦ä¹ ä¸Šè¿°ã€Œäº”ä¸ªåŸåˆ™ã€å‰çš„å¸¸è§„æç¤ºè¯ï¼Œç„¶åå°è¯•ä¸€ä¸‹å­¦ä¹ äº†ã€Œäº”ä¸ªåŸåˆ™ã€åçš„æ”¹è¿›æç¤ºè¯ï¼Œå¹¶å¯¹æ¯”ä¸¤è€…çš„ç»“æœæœ‰ä½•å·®å¼‚ã€‚</p>
<h3 data-id="heading-2">2.1 å¸¸è§„æç¤ºè¯</h3>
<p>ä¸‹é¢æ˜¯å®ç°ä¸Šè¿°è½¬æ¢ä»»åŠ¡çš„å¸¸è§„æç¤ºè¯ï¼š</p>
<pre><code class="hljs language-text" lang="text">å½“å‰é¡¹ç›®æ˜¯ä¸€ä¸ªä½¿ç”¨ Maven ç®¡ç†çš„ Spring Boot é¡¹ç›®ï¼Œæºç ä½äº src/main/java ä¸‹ï¼Œé…ç½®æ–‡ä»¶ä½äº src/main/resources ä¸‹ã€‚

å½“å‰æ•°æ®åº“è®¿é—®å±‚ä½¿ç”¨çš„æ˜¯ MyBatisã€‚Mapper æ¥å£å®šä¹‰äºåŒ… com.boyouquan.dao ä¸‹ï¼ŒMapper é…ç½®æ–‡ä»¶ XxxDaoMapper.xml ä½äº resources çš„ mapper ç›®å½•ä¸‹ã€‚

ç°åœ¨æˆ‘ä»¬æƒ³å°†æ•°æ®åº“è®¿é—®å±‚ç”± MyBatis æ›´æ”¹ä¸º JPAã€‚è¯·è‡ªåŠ¨æŠ“å– MyBatis Mapper æ¥å£ä¸­çš„æ–¹æ³•åç§°ä¸ Mapper é…ç½®æ–‡ä»¶é‡Œçš„ SQL è¯­å¥ï¼Œç„¶ååœ¨ com.boyouquan.repository ä¸‹ç¼–å†™ä¸ Mapper æ¥å£å¯¹åº”çš„ Repository æ¥å£ã€å®šä¹‰ä¸ Mapper æ¥å£ä¸­æ–¹æ³•åŒåçš„æ–¹æ³•å¹¶ä½¿ç”¨ @Query(value = "", nativeQuery = true) æ³¨è§£å¡«å…¥ Mapper é…ç½®æ–‡ä»¶é‡Œå¯¹åº”çš„ SQLã€‚

å®Œæˆåï¼Œè¯·åœ¨é¡¹ç›®æ ¹ç›®å½•ç”Ÿæˆä¸€ä¸ª report.md æŠ¥å‘Šæ–‡ä»¶ï¼Œä»¥è¡¨æ ¼çš„æ–¹å¼å±•ç¤ºåŸå§‹ Mapper æ¥å£ä¸æ–°ç”Ÿæˆçš„ Repository çš„å¯¹åº”å…³ç³»ã€‚
</code></pre>
<p>åœ¨ä¸Šè¿°æç¤ºè¯ä¸­ï¼Œæˆ‘é¦–å…ˆè¯´æ˜äº†å½“å‰é¡¹ç›®çš„æ¶æ„ã€æºç ç›®å½•ã€é…ç½®æ–‡ä»¶ç›®å½•ç­‰èƒŒæ™¯ä¿¡æ¯ï¼›æ¥ç€è¯´æ˜äº† MyBatis Mapper æ¥å£å’Œ Mapper XML æ–‡ä»¶çš„ä½ç½®ï¼›ç„¶åè¯´æ˜äº†ä»»åŠ¡è¦æ±‚ï¼Œå¹¶ç®€å•ç»™å‡ºäº†å®ç°æ­¥éª¤ï¼›æœ€åæˆ‘è¦æ±‚å®Œæˆåç”Ÿæˆä¸€ä¸ªæŠ¥å‘Šã€‚</p>
<p>ä¸‹é¢å°è¯•ç”¨ VS Code æ‰“å¼€é¡¹ç›®ï¼Œç„¶ååœ¨ Copilot èŠå¤©çª—è¾“å…¥ä¸Šè¿°æç¤ºè¯ï¼Œè®© AI åŠ©æ‰‹ä»¥ Agent æ¨¡å¼å¸®æˆ‘å®ç°ä¸Šè¿°ä»»åŠ¡ã€‚</p>
<p>å‡ åˆ†é’Ÿåï¼ŒAI åŠ©æ‰‹å¸®æˆ‘å®Œæˆäº† MyBatis åˆ° JPA çš„è½¬æ¢ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f94ab927bbdc4e8e9989e060e3d4ceea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56OK56OK6JC96JC9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765241326&amp;x-signature=stS7%2Fg4u04PbVf1cNFwj%2BLCedOQ%3D" alt="MyBatis åˆ° JPA çš„è½¬æ¢ç»“æœï¼ˆRaw Promptï¼‰" loading="lazy"/></p>
<p>ä½†ç»“æœä¸å¤ªç†æƒ³ï¼Œä¸»è¦å­˜åœ¨å¦‚ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>ç”Ÿæˆçš„ JPA Repository æ¥å£ç»§æ‰¿äº† <code>Repository</code>ï¼Œè€Œä¸æ˜¯æˆ‘æƒ³è±¡ä¸­çš„ <code>CrudRepository</code>ï¼›</li>
<li>ä¸è®ºæ˜¯ç®€å•æŸ¥è¯¢è¯­å¥è¿˜æ˜¯å¤æ‚æŸ¥è¯¢è¯­å¥ï¼Œå‡ä½¿ç”¨äº†è‡ªå®šä¹‰æŸ¥è¯¢ï¼Œè€Œæ²¡æœ‰æ ¹æ®æƒ…å½¢å°†ç®€å•æŸ¥è¯¢è¯­å¥è½¬æ¢ä¸º JPA çš„å‘½åæ–¹æ³•å®ç°ï¼›</li>
<li><code>@Query</code> æ³¨è§£é‡Œå¡«å…¥çš„ SQL ä¸è®ºé•¿çŸ­å‡ä½¿ç”¨ä¸€ä¸ªå•è¡Œå±•å¼€ï¼Œè€Œæœªæ ¹æ®æƒ…å½¢ä½¿ç”¨ Java 13 çš„æ–‡æœ¬å—ç‰¹æ€§å°† SQL æ¢è¡Œã€‚</li>
</ul>
<p>è¿™å°±æ˜¯æˆ‘ä»¬å½“ä¸‹ä½¿ç”¨ AI çš„ç°çŠ¶ï¼šæˆ‘ä»¬æŒ‡æ´¾ AI åšä¸€äº›ä»»åŠ¡æ—¶ï¼Œé»˜è®¤ AI å…·å¤‡ä¸€äº›ã€Œå¸¸è¯†ã€ï¼Œä½†ä»ç»“æœæ¥çœ‹ï¼ŒAI å¹¶ä¸ä¸€å®šå…·å¤‡è¿™äº›ã€Œå¸¸è¯†ã€ã€‚è¿™ä¹Ÿå°±æ˜¯æç¤ºå·¥ç¨‹å­˜åœ¨çš„æ„ä¹‰ã€‚</p>
<h3 data-id="heading-3">2.2 ä¼˜åŒ–åçš„æç¤ºè¯</h3>
<p>ä¸‹é¢å°è¯•ä½¿ç”¨ä¸Šè¿°çš„ã€Œäº”ä¸ªåŸåˆ™ã€ä¼˜åŒ–æç¤ºè¯ï¼Œå¹¶å°†å…¶æ”¾å…¥é¡¹ç›®æ ¹ç›®å½•çš„æ–‡ä»¶ <code>mybatis-to-jpa.prompt.md</code> ä¸­ã€‚</p>
<p>ä¼˜åŒ–åçš„æç¤ºè¯å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># å°† MyBatis æ›¿æ¢ä¸º JPA</span>

<span class="hljs-section">## 1 èƒŒæ™¯çŸ¥è¯†</span>

å½“å‰é¡¹ç›®æ˜¯ä¸€ä¸ªä½¿ç”¨ Maven ç®¡ç†çš„ Spring Boot é¡¹ç›®ï¼Œæºç ä½äº <span class="hljs-code">`src/main/java`</span> ä¸‹ï¼Œé…ç½®æ–‡ä»¶ä½äº <span class="hljs-code">`src/main/resources`</span> ä¸‹ã€‚

å½“å‰æ•°æ®åº“è®¿é—®å±‚ä½¿ç”¨çš„æ˜¯ MyBatisã€‚Mapper æ¥å£å®šä¹‰äºåŒ… <span class="hljs-code">`com.boyouquan.dao`</span> ä¸‹ï¼ŒMapper é…ç½®æ–‡ä»¶ <span class="hljs-code">`XxxDaoMapper.xml`</span> ä½äº resources çš„ mapper ç›®å½•ä¸‹ã€‚

<span class="hljs-section">## 2 ä»»åŠ¡ç®€ä»‹</span>

ç°åœ¨æˆ‘ä»¬æƒ³å°†æ•°æ®åº“è®¿é—®å±‚ç”± MyBatis æ›´æ”¹ä¸º JPAã€‚è¯·è‡ªåŠ¨æŠ“å– MyBatis Mapper æ¥å£ä¸­çš„æ–¹æ³•åç§°ä¸ Mapper é…ç½®æ–‡ä»¶é‡Œçš„ SQL è¯­å¥ï¼Œç„¶ååœ¨ <span class="hljs-code">`com.boyouquan.repository`</span> ä¸‹ç¼–å†™ä¸ Mapper æ¥å£å¯¹åº”çš„ Repository æ¥å£ã€å®šä¹‰ä¸ Mapper æ¥å£ä¸­æ–¹æ³•åŒåçš„æ–¹æ³•å¹¶ä½¿ç”¨ <span class="hljs-code">`@Query(value = "", nativeQuery = true)`</span> æ³¨è§£å¡«å…¥ Mapper é…ç½®æ–‡ä»¶é‡Œå¯¹åº”çš„ SQLã€‚

<span class="hljs-section">## 3 å®ç°æ­¥éª¤</span>

<span class="hljs-section">### 3.1 ç¼–å†™ä¸ Mapper æ¥å£å¯¹åº”çš„ Repository æ¥å£</span>

é¦–å…ˆï¼Œéœ€è¦æ‰¾åˆ° <span class="hljs-code">`com.boyouquan.dao`</span> åŒ…ä¸‹æ‰€æœ‰çš„ Mapper æ¥å£ï¼Œç„¶ååœ¨ <span class="hljs-code">`com.boyouquan.repository`</span> åŒ…ä¸‹æ–°å»ºå¯¹åº”çš„ Repository æ¥å£ã€‚

å¦‚ä¸‹ä¸ºä¸€ä¸ªç¤ºä¾‹ã€‚

<span class="hljs-code">`com.boyouquan.dao`</span> åŒ…ä¸‹åŸå§‹çš„ <span class="hljs-code">`BlogDaoMapper`</span> æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š

<span class="hljs-code">```java
package com.boyouquan.dao;

public interface BlogDaoMapper {
}
```</span>

é‚£ä¹ˆåœ¨ <span class="hljs-code">`com.boyouquan.repository`</span> åŒ…ä¸‹æ–°å»ºä¸€ä¸ªä¸ <span class="hljs-code">`BlogDaoMapper`</span> æ¥å£å¯¹åº”çš„ Repository æ¥å£ <span class="hljs-code">`BlogRepository`</span>ï¼Œå¹¶è®©è¯¥ Repository ç»§æ‰¿ <span class="hljs-code">`CrudRepository`</span>ï¼š

<span class="hljs-code">```java
package com.boyouquan.repository;

import org.springframework.data.repository.CrudRepository;
import org.springframework.stereotype.Repository;

@Repository
public interface BlogRepository extends CrudRepository&lt;Blog, Long&gt; {
}
```</span>

<span class="hljs-section">### 3.2 åœ¨ Repository æ¥å£å®šä¹‰ä¸ Mapper æ¥å£ä¸­æ–¹æ³•åŒåçš„æ–¹æ³•</span>

æ¥ä¸‹æ¥ï¼Œæ‰«æåŸå§‹ Mapper æ¥å£ä¸­æ‰€æœ‰å®šä¹‰å¥½çš„æ–¹æ³•ï¼Œç„¶ååœ¨å¯¹åº”çš„ Repository æ¥å£æ–°å»ºä¸ä¹‹åŒåçš„æ–¹æ³•ã€‚

å¦‚ä¸‹ä¸ºä¸€ä¸ªç¤ºä¾‹ã€‚

åŸå§‹ <span class="hljs-code">`BlogDaoMapper`</span> åŒ…å«ä¸€ç»„æ–¹æ³•ï¼š

<span class="hljs-code">```java
package com.boyouquan.dao;

public interface BlogDaoMapper {

    Blog getByAddress(String address);

    List&lt;PopularBlog&gt; listPopularBlogs(int limit);

    ...
}
```</span>

é‚£ä¹ˆåœ¨æ–°å»ºçš„ <span class="hljs-code">`BlogRepository`</span> æ¥å£é‡Œå®šä¹‰ä¸€ç»„ä¸ <span class="hljs-code">`BlogDaoMapper`</span> æ¥å£é‡Œæ–¹æ³•åŒåçš„æ–¹æ³•ï¼š

<span class="hljs-code">```java
package com.boyouquan.repository;

import org.springframework.data.repository.CrudRepository;
import org.springframework.stereotype.Repository;

@Repository
public interface BlogRepository extends CrudRepository&lt;Blog, Long&gt; {

    Blog getByAddress(String address);

    List&lt;PopularBlog&gt; listPopularBlogs(int limit);

    ...
}
```</span>

<span class="hljs-section">### 3.3 é’ˆå¯¹ Mapper æ¥å£ä¸­çš„æ–¹æ³•ï¼Œä» XxxMapper.xml æŠ“å–ä¸ä¹‹å¯¹åº”çš„ SQL</span>

å¯¹äºä¸€ä¸ªç»™å®šçš„ Mapper æ¥å£ï¼Œéœ€è¦åˆ° <span class="hljs-code">`resources/mapper`</span> æ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°ä¸ä¹‹å¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼›ç„¶åé’ˆå¯¹ Mapper æ¥å£ä¸­çš„æ–¹æ³•ï¼Œä» <span class="hljs-code">`XxxMapper.xml`</span> é…ç½®æ–‡ä»¶æŠ“å–å‡ºæ‰€å¯¹åº”çš„ SQLã€‚

å¦‚ï¼Œ<span class="hljs-code">`BlogDaoMapper`</span> æ¥å£çš„ <span class="hljs-code">`getByAddress`</span> æ–¹æ³•åœ¨ Mapper é…ç½®æ–‡ä»¶ <span class="hljs-code">`resources/mapper/BlogDaoMapper.xml`</span> ä¸­çš„é…ç½®å¦‚ä¸‹ï¼š

<span class="hljs-code">```xml
&lt;select id="getByAddress" resultType="com.boyouquan.model.Blog"&gt;
    SELECT
    &lt;include refid="select_columns"/&gt;
    FROM blog
    WHERE address=#{address}
&lt;/select&gt;
```</span>

æŠ“å– SQL æ—¶ï¼Œçœ‹åˆ°æœ‰ <span class="hljs-code">`include`</span> æ ‡ç­¾ï¼Œè¦åœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°æ ‡ç­¾å®šä¹‰çš„åœ°æ–¹ï¼š

<span class="hljs-code">```xml
&lt;sql id="select_columns"&gt;
    domain_name as domainName,
    admin_email as adminEmail,
    name,
    address,
    rss_address as rssAddress,
    description,
    self_submitted as selfSubmitted,
    collected_at as collectedAt,
    updated_at as updatedAt,
    valid,
    gravatar_valid as gravatarValid,
    draft,
    deleted
&lt;/sql&gt;
```</span>

ç„¶åæŠ“å–å‡º <span class="hljs-code">`getByAddress`</span> æ–¹æ³•æ‰€ä½¿ç”¨çš„å®Œæ•´ SQLï¼š

<span class="hljs-code">```sql
SELECT
    domain_name as domainName,
    admin_email as adminEmail,
    name,
    address,
    rss_address as rssAddress,
    description,
    self_submitted as selfSubmitted,
    collected_at as collectedAt,
    updated_at as updatedAt,
    valid,
    gravatar_valid as gravatarValid,
    draft,
    deleted
FROM blog
WHERE address=#{address}
```</span>

æ²¡æœ‰ <span class="hljs-code">`include`</span> æ ‡ç­¾çš„ SQL åˆ™ç›´æ¥æŠ“å–å³å¯ã€‚

<span class="hljs-section">### 3.4 åœ¨ Repository æ¥å£ä¸ºæ–¹æ³•æ·»åŠ  @Query æ³¨è§£å¹¶å¡«å…¥å¯¹åº”çš„ SQL</span>

æ¥ä¸‹æ¥æ˜¯æœ¬æ¬¡å®ç°çš„é‡ç‚¹ï¼šä½¿ç”¨ <span class="hljs-code">`@Query`</span> æ³¨è§£å°†ä¸Šä¸€æ­¥æ‰¾åˆ°çš„ SQL å¡«å…¥ä¸ Mapper æ¥å£å¯¹åº”çš„ Repository æ¥å£æ–¹æ³•ä¸Šã€‚

å¡«å…¥ SQL æ—¶ï¼Œéœ€è¦éµå¾ªä¸¤ä¸ªåŸåˆ™ï¼š

<span class="hljs-bullet">-</span> aï¼‰å¦‚æœå¯¹åº”çš„æ–¹æ³•èƒ½ä½¿ç”¨ JPA çš„å‘½åæ–¹æ³•å®ç°å°±ä¸è¦ä½¿ç”¨è‡ªå®šä¹‰æŸ¥è¯¢æ–¹å¼å®ç°ã€‚æ‰€ä»¥æ–¹æ³•åå¯ä»¥æ ¹æ®éœ€è¦åšç›¸åº”çš„æ›´æ”¹ï¼Œåªè¦åœ¨æœ€åçš„æŠ¥å‘Šä¸­åšå‡ºè¯´æ˜å³å¯ï¼›

å¦‚ï¼Œåœ¨ BlogRepository ä¸­å®ç° <span class="hljs-code">`getByAddress`</span> æ–¹æ³•æ—¶ï¼Œæ²¡å¿…è¦ä½¿ç”¨è‡ªå®šä¹‰æŸ¥è¯¢ï¼Œå†™æˆï¼š

<span class="hljs-code">```java
package com.boyouquan.repository;

import org.springframework.data.repository.CrudRepository;
import org.springframework.stereotype.Repository;

@Repository
public interface BlogRepository extends CrudRepository&lt;Blog, Long&gt; {

    @Query(value = "SELECT * FROM blog WHERE address=#{address}", nativeQuery = true)
    Blog findByAddress(String address);
}
```</span>

è€Œåº”ä½¿ç”¨ JPA çš„å‘½åæ–¹æ³•ï¼Œå†™æˆï¼š

<span class="hljs-code">```java
package com.boyouquan.repository;

import org.springframework.data.repository.CrudRepository;
import org.springframework.stereotype.Repository;

@Repository
public interface BlogRepository extends CrudRepository&lt;Blog, Long&gt; {

    Blog findByAddress(String address);
}
```</span>

å¯¹äºè¿™ä¸€æ–¹æ³•åçš„å˜æ›´ï¼Œåªéœ€è¦åœ¨æœ€åçš„æŠ¥å‘Šä¸­åšå‡ºè¯´æ˜å³å¯ã€‚

<span class="hljs-bullet">-</span> bï¼‰ä½¿ç”¨ <span class="hljs-code">`@Query`</span> æ³¨è§£æŒ‡å®šè‡ªå®šä¹‰æŸ¥è¯¢æ—¶ï¼Œå¦‚æœå¯¹åº”çš„ SQL è¯­å¥å¤ªé•¿ï¼Œåˆ™ <span class="hljs-code">`value`</span> å­—æ®µéœ€è¦ç”¨ Java 13 å¼•å…¥çš„ä¸‰ä¸ªå¼•å·å¼•ç”¨æ–‡æœ¬å—çš„æ–¹å¼å®ç°ï¼Œè€Œä¸è¦å°†ä¸€ä¸ªé•¿ SQL æ”¾åœ¨ä¸€ä¸ªå•è¡Œä¸Šï¼Œå½±å“é˜…è¯»ã€‚

å¦‚ï¼Œ<span class="hljs-code">`BlogDaoMapper`</span> æ¥å£çš„ <span class="hljs-code">`listPopularBlogs`</span> æ–¹æ³•åœ¨ Mapper é…ç½®æ–‡ä»¶ <span class="hljs-code">`BlogDaoMapper.xml`</span> ä¸­çš„ SQL å¾ˆé•¿ã€‚åœ¨ BlogRepository ä¸­å®ç° <span class="hljs-code">`listPopularBlogs`</span> æ–¹æ³•æ—¶ï¼Œé¡»å†™æˆï¼š

<span class="hljs-code">```java
package com.boyouquan.repository;

import org.springframework.data.repository.CrudRepository;
import org.springframework.stereotype.Repository;

@Repository
public interface BlogRepository extends CrudRepository&lt;Blog, Long&gt; {

    @Query(value = """
            WITH moment_activities AS (
              SELECT
                m.blog_domain_name,
                MAX(m.created_at) as latest_active_time,
                'moment' as type
              FROM
                moment m
                INNER JOIN blog b ON m.blog_domain_name = b.domain_name
              WHERE
                m.deleted = false
                AND b.draft = false
                AND b.deleted = false
                AND b.valid = true
                AND b.gravatar_valid = true
              GROUP BY
                m.blog_domain_name
            ),
            post_activities AS (
              SELECT
                p.blog_domain_name,
                MAX(p.published_at) as latest_active_time,
                'post' as type
              FROM
                post p
                INNER JOIN blog b ON p.blog_domain_name = b.domain_name
              WHERE
                p.deleted = false
                AND p.draft = false
                AND b.draft = false
                AND b.deleted = false
                AND b.valid = true
                AND b.gravatar_valid = true
              GROUP BY
                p.blog_domain_name
            ),
            combined_activities AS (
              SELECT
                blog_domain_name,
                latest_active_time,
                type
              FROM
                moment_activities
              UNION ALL
              SELECT
                blog_domain_name,
                latest_active_time,
                type
              FROM
                post_activities
            ),
            ranked_activities AS (
              SELECT
                blog_domain_name as blogDomainName,
                latest_active_time as latestActiveTime,
                type,
                ROW_NUMBER() OVER (
                  PARTITION BY blog_domain_name
                  ORDER BY
                    latest_active_time DESC
                ) as rn
              FROM
                combined_activities
            )
            SELECT
              blogDomainName,
              latestActiveTime,
              type
            FROM
              ranked_activities
            WHERE
              rn = 1
            ORDER BY
              latestActiveTime DESC
            LIMIT
              :limit
            """, nativeQuery = true)
    List&lt;PopularBlog&gt; listPopularBlogs(int limit);
}
```</span>

<span class="hljs-section">## 4 æŠ¥å‘Šç”Ÿæˆ</span>

æ‰€æœ‰æ­¥éª¤å®Œæˆåï¼Œè¯·åœ¨é¡¹ç›®æ ¹ç›®å½•ç”Ÿæˆä¸€ä¸ª <span class="hljs-code">`report.md`</span> æŠ¥å‘Šæ–‡ä»¶ï¼Œä»¥è¡¨æ ¼çš„æ–¹å¼å±•ç¤ºåŸå§‹ Mapper æ¥å£ã€åŸå§‹ Mapper æ¥å£ä¸­çš„æ–¹æ³•ã€æ–°ç”Ÿæˆçš„ Repository ã€æ–°ç”Ÿæˆçš„ Repository ä¸­çš„æ–¹æ³•çš„å¯¹åº”å…³ç³»ã€‚

ç¤ºä¾‹ï¼š

| Mapper æ¥å£   | åŸæ–¹æ³•       | Repository æ¥å£ | æ–°æ–¹æ³•        |
| ------------- | ------------ | --------------- | ------------- |
| BlogDaoMapper | getByAddress | BlogRepository  | findByAddress |
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå¯¹æ¯”ä¸Šä¸€å°èŠ‚çš„å¸¸è§„æç¤ºè¯ï¼Œä¼˜åŒ–åçš„æç¤ºè¯æŒ‰ç…§ã€Œäº”ä¸ªåŸåˆ™ã€åšäº†æ‹†åˆ†ä»»åŠ¡ã€æ˜ç¡®æ–¹å‘ã€æä¾›èŒƒä¾‹ç­‰å¤šä¸ªæ–¹é¢çš„è°ƒæ•´ï¼Œè¿™æ ·ä½¿å¾—ä»»åŠ¡æ›´å…·ä½“ã€æ­¥éª¤æ›´è¯¦ç»†ã€è¦æ±‚æ›´æ˜ç¡®ã€‚</p>
<p>åœ¨ VS Code ä¸­æ‰“å¼€å¹¶æ‰§è¡ŒåŒ…å«ä¸Šè¿°æç¤ºè¯çš„ <code>mybatis-to-jpa.prompt.md</code> æ–‡ä»¶åï¼ŒAI åŠ©æ‰‹çš„å®Œæˆè´¨é‡æœ‰äº†æ˜æ˜¾çš„æå‡ï¼Œå¯¹äºä¹‹å‰å¸¸è§„æç¤ºè¯çš„ç»“æœæ‰€å­˜åœ¨çš„å‡ ä¸ªé—®é¢˜ä¹Ÿéƒ½æ²¡æœ‰äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d3d4bf59ee24271ad94975d6d2608ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56OK56OK6JC96JC9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765241326&amp;x-signature=AGLBk3MSYqF0DyIPVl3MDEZ4N%2Fs%3D" alt="MyBatis åˆ° JPA çš„è½¬æ¢ç»“æœï¼ˆImproved Promptï¼‰" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ba0dae824974917a5a03029ea4cd7aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56OK56OK6JC96JC9:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765241326&amp;x-signature=PKkAJL2Y%2FgiEeJ8zVLYioUIipQI%3D" alt="MyBatis åˆ° JPA çš„è½¬æ¢æŠ¥å‘Š" loading="lazy"/></p>
<h2 data-id="heading-4">3 å°ç»“</h2>
<p>ç»¼ä¸Šï¼Œæœ¬æ–‡é¦–å…ˆä»‹ç»äº†æç¤ºè¯ä¸æç¤ºå·¥ç¨‹çš„æ¦‚å¿µï¼›æ¥ç€ä»‹ç»äº†ã€Œç¼–å†™æç¤ºè¯éœ€è¦éµå¾ªçš„äº”ä¸ªåŸåˆ™ã€ï¼›æœ€åä»¥ã€ŒMyBatis è½¬ JPAã€ä¸ºä¾‹ï¼Œæ¼”ç¤ºäº†å¯¹ã€Œäº”ä¸ªåŸåˆ™ã€çš„è¿ç”¨ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œè¿™ã€Œäº”ä¸ªåŸåˆ™ã€å¯¹äºæˆ‘ä»¬åœ¨æ—¥å¸¸å·¥ä½œä¸­æŒ‡æ´¾ AI åŠ©æ‰‹åšä»»åŠ¡æ—¶æ˜¯éå¸¸æœ‰ä»·å€¼çš„ã€‚</p>
<blockquote>
<p>å‚è€ƒèµ„æ–™</p>
<p>[1] Book: Prompt Engineering for Generative AI by James Phoenix and Mike Taylor (O'Reilly) - <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.oreilly.com%2Flibrary%2Fview%2Fprompt-engineering-for%2F9781098153427%2F" target="_blank" title="https://www.oreilly.com/library/view/prompt-engineering-for/9781098153427/" ref="nofollow noopener noreferrer">www.oreilly.com/library/vieâ€¦</a></p>
<p>[2] Saxifrage Blog: Prompt Engineering, from Words to Art and Copy - <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.saxifrage.xyz%2Fpost%2Fprompt-engineering" target="_blank" title="https://www.saxifrage.xyz/post/prompt-engineering" ref="nofollow noopener noreferrer">www.saxifrage.xyz/post/promptâ€¦</a></p>
<p>[3] OpenAI: Prompt engineering - <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fprompt-engineering" target="_blank" title="https://platform.openai.com/docs/guides/prompt-engineering" ref="nofollow noopener noreferrer">platform.openai.com/docs/guidesâ€¦</a></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æµ·é‡æ•°æ®é›†çš„AIè‡ªåŠ¨åŒ–é¢„æµ‹æ‰“æ ‡ -- æ”¾ç”µæ—¶åºç‰¹å¾]]></title>    <link>https://juejin.cn/post/7578760341279899689</link>    <guid>https://juejin.cn/post/7578760341279899689</guid>    <pubDate>2025-12-02T00:50:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7578760341279899689" data-draft-id="7578760341279866921" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æµ·é‡æ•°æ®é›†çš„AIè‡ªåŠ¨åŒ–é¢„æµ‹æ‰“æ ‡ -- æ”¾ç”µæ—¶åºç‰¹å¾"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2025-12-02T00:50:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯­è½å¿ƒç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/2875978147955741"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æµ·é‡æ•°æ®é›†çš„AIè‡ªåŠ¨åŒ–é¢„æµ‹æ‰“æ ‡ -- æ”¾ç”µæ—¶åºç‰¹å¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2875978147955741/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯­è½å¿ƒç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-02T00:50:51.000Z" title="Tue Dec 02 2025 00:50:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ”¾ç”µæ—¶åºç‰¹å¾ML BackendæŠ€æœ¯è§£æ</h2>
<h3 data-id="heading-1">æ¦‚è¿°:æ•æ‰ç­‰ç¦»å­ä½“çš„"ç”Ÿå‘½å‘¨æœŸ"</h3>
<p>åœ¨ç­‰ç¦»å­ä½“æ”¾ç”µå®éªŒä¸­,ä»å‡»ç©¿ã€ç¨³å®šè¿è¡Œåˆ°ç ´è£‚ç»“æŸ,æ•´ä¸ªè¿‡ç¨‹å°±åƒä¸€åœºç²¾å¿ƒç¼–æ’çš„"è¡¨æ¼”"â€”â€”æ¯ä¸ªå…³é”®æ—¶åˆ»éƒ½æ‰¿è½½ç€é‡è¦çš„ç‰©ç†ä¿¡æ¯ã€‚<strong>å‡»ç©¿æ—¶åˆ»</strong>(ç­‰ç¦»å­ä½“å½¢æˆ)ã€<strong>ç ´è£‚æ—¶åˆ»</strong>(å¤±ç¨³å´©æºƒ)ã€<strong>ç»“æŸæ—¶åˆ»</strong>(æ”¾ç”µç»ˆæ­¢)æ˜¯åˆ†æå®éªŒæˆè´¥çš„ä¸‰ä¸ªé»„é‡‘é”šç‚¹ã€‚</p>
<p><strong>æ”¾ç”µæ—¶åºç‰¹å¾ML Backend</strong>å°±åƒä¸€ä½<strong>è‡ªåŠ¨åŒ–çš„æ—¶åˆ»æ ‡è®°å‘˜</strong>,é€šè¿‡è°ƒç”¨è¿œç¨‹AIæ¨¡å‹æœåŠ¡,è‡ªåŠ¨è¯†åˆ«è¿™äº›å…³é”®æ—¶åˆ»,å°†åŸæœ¬éœ€è¦äººå·¥é€å¸§æŸ¥çœ‹æ³¢å½¢çš„å·¥ä½œç¼©çŸ­åˆ°ç§’çº§,ä¸ºç‰©ç†åˆ†ææä¾›ç²¾å‡†çš„æ—¶é—´åŸºå‡†ã€‚</p>
<hr/>
<h3 data-id="heading-2">ä¸€ã€ä¸šåŠ¡ä»·å€¼:Why - ä¸ºä»€ä¹ˆéœ€è¦è‡ªåŠ¨åŒ–æ—¶åˆ»æ ‡æ³¨?</h3>
<h4 data-id="heading-3">1.1 ç§‘ç ”åœºæ™¯ç—›ç‚¹</h4>
<p><strong>åœºæ™¯1:å®éªŒæ•°æ®åˆ†æ</strong><br/>
æ‰˜å¡é©¬å…‹è£…ç½®æ¯å¤©äº§ç”Ÿå‡ åæ¬¡æ”¾ç”µ:</p>
<ul>
<li>æ¯æ¬¡æ”¾ç”µéœ€è¦æ ‡æ³¨å‡»ç©¿ã€ç ´è£‚ã€ç»“æŸä¸‰ä¸ªæ—¶åˆ»</li>
<li>äººå·¥åˆ†æ:æŸ¥çœ‹ç­‰ç¦»å­ä½“ç”µæµã€å¯†åº¦ã€æ¸©åº¦ç­‰å¤šä¸ªä¿¡å·</li>
<li>éœ€è¦ä¸“å®¶ç»éªŒåˆ¤æ–­,è€—æ—¶5-10åˆ†é’Ÿ/æ¬¡</li>
<li><strong>50æ¬¡å®éªŒ Ã— 8åˆ†é’Ÿ = 400åˆ†é’Ÿæ ‡æ³¨å·¥ä½œ</strong></li>
</ul>
<p><strong>åœºæ™¯2:ç ´è£‚é¢„è­¦ç ”ç©¶</strong><br/>
ç ”ç©¶ç­‰ç¦»å­ä½“ç ´è£‚çš„å‰å…†ä¿¡å·:</p>
<ul>
<li>éœ€è¦ç²¾ç¡®æ ‡æ³¨ç ´è£‚å‘ç”Ÿæ—¶åˆ»(ç²¾åº¦Â±1ms)</li>
<li>æ‰‹å·¥æ ‡æ³¨è¯¯å·®å¤§(Â±5ms)</li>
<li>å½±å“å‰å…†ä¿¡å·åˆ†æçš„å‡†ç¡®æ€§</li>
<li><strong>ç ´è£‚æ—¶åˆ»ä¸å‡†ç¡®ä¼šå¯¼è‡´é¢„è­¦æ¨¡å‹å¤±æ•ˆ</strong></li>
</ul>
<p><strong>åœºæ™¯3:å®éªŒå‚æ•°ä¼˜åŒ–</strong><br/>
å¯¹æ¯”ä¸åŒå®éªŒæ¡ä»¶ä¸‹çš„æ”¾ç”µæŒç»­æ—¶é—´:</p>
<ul>
<li>æ”¾ç”µæ—¶é•¿ = ç»“æŸæ—¶åˆ» - å‡»ç©¿æ—¶åˆ»</li>
<li>æ‰‹å·¥æ ‡æ³¨æ—¶åˆ»ä¸ä¸€è‡´</li>
<li>ç»Ÿè®¡åˆ†æç»“æœä¸å¯é </li>
<li><strong>å½±å“å®éªŒå‚æ•°ä¼˜åŒ–å†³ç­–</strong></li>
</ul>
<h4 data-id="heading-4">1.2 ML Backendçš„æ ¸å¿ƒä»·å€¼</h4>
<p>é€šè¿‡<strong>è¿œç¨‹AIæ¨¡å‹æœåŠ¡</strong>,å®ç°:</p>
<p><strong>æ•ˆç‡æå‡</strong>:ç§’çº§å®Œæˆæ—¶åˆ»æ ‡æ³¨<br/>
<strong>ç²¾åº¦æå‡</strong>:æ¨¡å‹ç²¾åº¦Â±0.5ms,ä¼˜äºäººå·¥Â±5ms<br/>
<strong>æ ‡å‡†åŒ–</strong>:æ¶ˆé™¤äººä¸ºåˆ¤æ–­å·®å¼‚<br/>
<strong>æ‰¹é‡å¤„ç†</strong>:æ”¯æŒå†å²æ•°æ®æ‰¹é‡æ ‡æ³¨</p>
<p><strong>å®é™…æ”¶ç›Š</strong>:</p>
<ul>
<li>æ•°æ®å¤„ç†æ•ˆç‡:ä»400åˆ†é’Ÿé™ä½åˆ°3åˆ†é’Ÿ</li>
<li>ç ´è£‚é¢„è­¦å‡†ç¡®ç‡:ä»75%æå‡åˆ°92%</li>
<li>å®éªŒå‚æ•°ä¼˜åŒ–å‘¨æœŸ:ä»2å‘¨ç¼©çŸ­åˆ°3å¤©</li>
</ul>
<hr/>
<h3 data-id="heading-5">äºŒã€ç³»ç»Ÿæ¶æ„:What - æ”¾ç”µæ—¶åºç‰¹å¾ç³»ç»Ÿæ˜¯ä»€ä¹ˆ?</h3>
<h4 data-id="heading-6">2.1 æ•´ä½“æ¶æ„</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph "Label Studioå‰ç«¯"
        A1[æ—¶åºæ ‡æ³¨ç•Œé¢] --&gt; A2[ä»»åŠ¡ç®¡ç†]
    end
    
    subgraph "ML Backend"
        B1[_wsgi.pyæœåŠ¡] --&gt; B2[NewModel&lt;br/&gt;ä¸šåŠ¡åè°ƒ]
    end
    
    subgraph "è¿œç¨‹AIæ¨¡å‹æœåŠ¡"
        C1[æ¨¡å‹æœåŠ¡å™¨&lt;br/&gt;dap0.lan:30400]
        C2[æ·±åº¦å­¦ä¹ æ¨¡å‹&lt;br/&gt;LSTM/Transformer]
        C3[ç‰¹å¾æå–å™¨&lt;br/&gt;æ—¶åºç‰¹å¾å·¥ç¨‹]
    end
    
    subgraph "æ•°æ®åº“"
        D1[(æ”¾ç”µæ•°æ®åº“)]
        D2[(æ ‡æ³¨å†å²)]
    end
    
    A2 --&gt;|HTTP API| B1
    B2 --&gt;|è¯·æ±‚ç‚®å·| C1
    C1 --&gt; C2
    C2 --&gt; C3
    C1 --&gt;&gt; B2
    B2 --&gt;|é¢„æµ‹ç»“æœ| A2
    
    D1 --&gt; C3
    A2 --&gt; D2
    
    style B2 fill:#4CAF50,color:#fff
    style C1 fill:#FF5722,color:#fff
    style C2 fill:#2196F3,color:#fff
</code></pre>
<h4 data-id="heading-7">2.2 æ ¸å¿ƒç»„ä»¶è¯¦è§£</h4>
<h5 data-id="heading-8">ğŸ¯ <strong>NewModel</strong> - ä¸šåŠ¡åè°ƒå±‚</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">NewModel</span>(<span class="hljs-title class_ inherited__">LabelStudioMLBase</span>):
    <span class="hljs-string">"""æ”¾ç”µæ—¶åºç‰¹å¾MLåç«¯"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># é…ç½®æ ‡ç­¾</span>
        self.label_group = <span class="hljs-string">"breakdown_time"</span>
        self.label_name = [<span class="hljs-string">"å‡»ç©¿æ—¶åˆ»"</span>, <span class="hljs-string">"ç ´è£‚æ—¶åˆ»"</span>, <span class="hljs-string">"ç»“æŸæ—¶åˆ»"</span>]
        
        <span class="hljs-comment"># è¿œç¨‹æ¨¡å‹æœåŠ¡URL</span>
        self.model_url = <span class="hljs-string">"http://dap0.lan:30400/ml-models-discharge-timing-features/"</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">predict</span>(<span class="hljs-params">self, tasks, context=<span class="hljs-literal">None</span>, **kwargs</span>):
        <span class="hljs-comment"># 1. æå–ç‚®å·</span>
        shots = [task[<span class="hljs-string">'data'</span>][<span class="hljs-string">'shot'</span>] <span class="hljs-keyword">for</span> task <span class="hljs-keyword">in</span> tasks]
        
        <span class="hljs-comment"># 2. è°ƒç”¨è¿œç¨‹æ¨¡å‹æœåŠ¡</span>
        model_version = requests.get(self.model_url + <span class="hljs-string">"version"</span>).json()[<span class="hljs-string">"version"</span>]
        data = {<span class="hljs-string">"shot"</span>: shots}
        model_preds = requests.get(self.model_url + <span class="hljs-string">"predict"</span>, json=data).json()
        
        <span class="hljs-comment"># 3. è½¬æ¢ä¸ºLabel Studioæ ¼å¼</span>
        ls_results = self.convert_predictions(model_preds)
        
        <span class="hljs-keyword">return</span> ModelResponse(model_version=model_version, predictions=ls_results)
</code></pre>
<p><strong>è®¾è®¡äº®ç‚¹</strong>:</p>
<ul>
<li><strong>å‰åç«¯åˆ†ç¦»</strong>:ML Backendä½œä¸ºè½»é‡çº§ä»£ç†,æ¨¡å‹è®¡ç®—åœ¨è¿œç¨‹æœåŠ¡å™¨</li>
<li><strong>æœåŠ¡è§£è€¦</strong>:æ¨¡å‹å‡çº§æ— éœ€é‡å¯Label Studio</li>
<li><strong>ç‰ˆæœ¬ç®¡ç†</strong>:è‡ªåŠ¨è·å–æ¨¡å‹ç‰ˆæœ¬,æ”¯æŒA/Bæµ‹è¯•</li>
</ul>
<h5 data-id="heading-9">ğŸš€ <strong>è¿œç¨‹AIæ¨¡å‹æœåŠ¡</strong> - è®¡ç®—æ ¸å¿ƒ</h5>
<p>è¿œç¨‹æ¨¡å‹æœåŠ¡æä¾›ä¸¤ä¸ªAPIæ¥å£:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ¥å£1:è·å–æ¨¡å‹ç‰ˆæœ¬</span>
GET /version
Response: {<span class="hljs-string">"version"</span>: <span class="hljs-string">"discharge_timing_v2.3"</span>}

<span class="hljs-comment"># æ¥å£2:é¢„æµ‹æ—¶åˆ»</span>
GET /predict
Request: {<span class="hljs-string">"shot"</span>: [<span class="hljs-number">12345</span>, <span class="hljs-number">12346</span>, <span class="hljs-number">12347</span>]}
Response: [
    [is_disrupted, ts, td, te],  <span class="hljs-comment"># ç‚®å·12345</span>
    [is_disrupted, ts, td, te],  <span class="hljs-comment"># ç‚®å·12346</span>
    ...
]

å…¶ä¸­:
  is_disrupted: æ˜¯å¦å‘ç”Ÿç ´è£‚(<span class="hljs-built_in">bool</span>)
  ts: å‡»ç©¿æ—¶åˆ»(ç§’)
  td: ç ´è£‚æ—¶åˆ»(ç§’,æ— ç ´è£‚åˆ™ä¸º<span class="hljs-literal">None</span>)
  te: ç»“æŸæ—¶åˆ»(ç§’)
</code></pre>
<hr/>
<h3 data-id="heading-10">ä¸‰ã€æŠ€æœ¯å®ç°:How - æ—¶åˆ»è¯†åˆ«ç®—æ³•</h3>
<h4 data-id="heading-11">3.1 æ•°æ®é¢„å¤„ç†</h4>
<h5 data-id="heading-12">è¾“å…¥æ•°æ®</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä»æ•°æ®åº“åŠ è½½è¯Šæ–­ä¿¡å·</span>
shot_data = {
    <span class="hljs-string">'time'</span>: [<span class="hljs-number">0.000</span>, <span class="hljs-number">0.001</span>, <span class="hljs-number">0.002</span>, ..., <span class="hljs-number">0.100</span>],  <span class="hljs-comment"># æ—¶é—´è½´(ç§’)</span>
    <span class="hljs-string">'Ip'</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">50</span>, <span class="hljs-number">100</span>, ..., <span class="hljs-number">0</span>],              <span class="hljs-comment"># ç­‰ç¦»å­ä½“ç”µæµ(kA)</span>
    <span class="hljs-string">'ne'</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">2.0</span>, <span class="hljs-number">3.0</span>, ..., <span class="hljs-number">0</span>],            <span class="hljs-comment"># ç”µå­å¯†åº¦(10^19/m^3)</span>
    <span class="hljs-string">'Te'</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">500</span>, <span class="hljs-number">800</span>, ..., <span class="hljs-number">0</span>],            <span class="hljs-comment"># ç”µå­æ¸©åº¦(eV)</span>
    <span class="hljs-string">'Vloop'</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>, ..., <span class="hljs-number">0</span>],              <span class="hljs-comment"># ç¯ç”µå‹(V)</span>
}
</code></pre>
<h5 data-id="heading-13">ç‰¹å¾æå–</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_timing_features</span>(<span class="hljs-params">shot_data</span>):
    <span class="hljs-string">"""
    æå–æ—¶åºç‰¹å¾
    """</span>
    features = []
    
    <span class="hljs-comment"># 1. ç”µæµç‰¹å¾</span>
    Ip = shot_data[<span class="hljs-string">'Ip'</span>]
    features.append(np.<span class="hljs-built_in">max</span>(Ip))           <span class="hljs-comment"># å³°å€¼ç”µæµ</span>
    features.append(np.argmax(Ip) * dt)   <span class="hljs-comment"># å³°å€¼æ—¶åˆ»</span>
    features.append(np.<span class="hljs-built_in">sum</span>(Ip &gt; <span class="hljs-number">0</span>) * dt)  <span class="hljs-comment"># ç”µæµæŒç»­æ—¶é—´</span>
    
    <span class="hljs-comment"># 2. ç”µæµæ¢¯åº¦ç‰¹å¾</span>
    dIp = np.gradient(Ip)
    features.append(np.<span class="hljs-built_in">max</span>(dIp))          <span class="hljs-comment"># æœ€å¤§ä¸Šå‡ç‡</span>
    features.append(np.<span class="hljs-built_in">min</span>(dIp))          <span class="hljs-comment"># æœ€å¤§ä¸‹é™ç‡</span>
    
    <span class="hljs-comment"># 3. å¯†åº¦ç‰¹å¾</span>
    ne = shot_data[<span class="hljs-string">'ne'</span>]
    features.append(np.<span class="hljs-built_in">max</span>(ne))           <span class="hljs-comment"># å³°å€¼å¯†åº¦</span>
    
    <span class="hljs-comment"># 4. æ¸©åº¦ç‰¹å¾</span>
    Te = shot_data[<span class="hljs-string">'Te'</span>]
    features.append(np.<span class="hljs-built_in">max</span>(Te))           <span class="hljs-comment"># å³°å€¼æ¸©åº¦</span>
    
    <span class="hljs-comment"># 5. ç¯ç”µå‹ç‰¹å¾</span>
    Vloop = shot_data[<span class="hljs-string">'Vloop'</span>]
    features.append(np.mean(Vloop[Ip &gt; <span class="hljs-number">50</span>]))  <span class="hljs-comment"># å¹³å°æœŸç¯ç”µå‹</span>
    
    <span class="hljs-keyword">return</span> np.array(features)
</code></pre>
<h4 data-id="heading-14">3.2 å‡»ç©¿æ—¶åˆ»æ£€æµ‹</h4>
<p><strong>ç‰©ç†å®šä¹‰</strong>:ç­‰ç¦»å­ä½“ç”µæµé¦–æ¬¡è¶…è¿‡é˜ˆå€¼(å¦‚10kA)çš„æ—¶åˆ»</p>
<h5 data-id="heading-15">ç®—æ³•å®ç°</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">detect_breakdown_time</span>(<span class="hljs-params">Ip, time, threshold=<span class="hljs-number">10</span></span>):
    <span class="hljs-string">"""
    å‡»ç©¿æ—¶åˆ»æ£€æµ‹
    
    ç®—æ³•:
    1. æ‰¾åˆ°ç”µæµé¦–æ¬¡è¶…è¿‡é˜ˆå€¼çš„æ—¶åˆ»
    2. å‘å‰å›æº¯,æ‰¾åˆ°ç”µæµå¼€å§‹ä¸Šå‡çš„èµ·ç‚¹
    """</span>
    <span class="hljs-comment"># 1. ç”µæµè¶…è¿‡é˜ˆå€¼çš„ç´¢å¼•</span>
    above_threshold = np.where(Ip &gt; threshold)[<span class="hljs-number">0</span>]
    
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(above_threshold) == <span class="hljs-number">0</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>  <span class="hljs-comment"># æœªå‡»ç©¿</span>
    
    first_above_idx = above_threshold[<span class="hljs-number">0</span>]
    
    <span class="hljs-comment"># 2. å‘å‰å›æº¯,æ‰¾åˆ°ç”µæµå¼€å§‹ä¸Šå‡ç‚¹</span>
    dIp = np.gradient(Ip)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(first_above_idx, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):
        <span class="hljs-keyword">if</span> dIp[i] &lt; <span class="hljs-number">0.1</span>:  <span class="hljs-comment"># æ¢¯åº¦æ¥è¿‘0</span>
            breakdown_idx = i + <span class="hljs-number">1</span>
            <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">else</span>:
        breakdown_idx = <span class="hljs-number">0</span>
    
    breakdown_time = time[breakdown_idx]
    
    <span class="hljs-keyword">return</span> breakdown_time
</code></pre>
<p><strong>å¯è§†åŒ–ç¤ºä¾‹</strong>:</p>
<pre><code class="hljs language-css" lang="css">ç­‰ç¦»å­ä½“ç”µæµæ›²çº¿:
  <span class="hljs-built_in">Ip</span>(kA)
   <span class="hljs-number">150</span> â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â”€â”€â”€ å¹³å°æœŸ
             â•±            â•²
    <span class="hljs-number">50</span> â”€â”€â”€â”€â”€â•±              â•²â”€â”€â”€ é˜ˆå€¼
           â•±                â•²
    <span class="hljs-number">10</span> â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€ æ£€æµ‹é˜ˆå€¼
         â•±                    â•²
     <span class="hljs-number">0</span> â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Time
         â†‘
      å‡»ç©¿æ—¶åˆ»ts
</code></pre>
<h4 data-id="heading-16">3.3 ç ´è£‚æ—¶åˆ»æ£€æµ‹</h4>
<p><strong>ç‰©ç†å®šä¹‰</strong>:ç­‰ç¦»å­ä½“å¤±ç¨³,ç”µæµå¿«é€Ÿè¡°å‡çš„æ—¶åˆ»</p>
<h5 data-id="heading-17">æ·±åº¦å­¦ä¹ æ–¹æ³•</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DisruptionDetector</span>(nn.Module):
    <span class="hljs-string">"""
    ç ´è£‚æ—¶åˆ»æ£€æµ‹LSTMæ¨¡å‹
    """</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, input_dim=<span class="hljs-number">4</span>, hidden_dim=<span class="hljs-number">64</span></span>):
        <span class="hljs-built_in">super</span>().__init__()
        
        <span class="hljs-comment"># LSTMæå–æ—¶åºç‰¹å¾</span>
        self.lstm = nn.LSTM(
            input_size=input_dim,   <span class="hljs-comment"># Ip, ne, Te, Vloop</span>
            hidden_size=hidden_dim,
            num_layers=<span class="hljs-number">2</span>,
            batch_first=<span class="hljs-literal">True</span>
        )
        
        <span class="hljs-comment"># äºŒåˆ†ç±»:æ˜¯å¦ç ´è£‚</span>
        self.classifier = nn.Linear(hidden_dim, <span class="hljs-number">2</span>)
        
        <span class="hljs-comment"># ç ´è£‚æ—¶åˆ»å›å½’</span>
        self.regressor = nn.Linear(hidden_dim, <span class="hljs-number">1</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):
        <span class="hljs-comment"># x: [batch, seq_len, 4]</span>
        
        <span class="hljs-comment"># LSTMç‰¹å¾æå–</span>
        lstm_out, (h_n, c_n) = self.lstm(x)
        
        <span class="hljs-comment"># ä½¿ç”¨æœ€åæ—¶åˆ»çš„éšçŠ¶æ€</span>
        h_last = h_n[-<span class="hljs-number">1</span>]  <span class="hljs-comment"># [batch, hidden_dim]</span>
        
        <span class="hljs-comment"># é¢„æµ‹æ˜¯å¦ç ´è£‚</span>
        is_disrupted = self.classifier(h_last)
        
        <span class="hljs-comment"># é¢„æµ‹ç ´è£‚æ—¶åˆ»</span>
        disruption_time = self.regressor(h_last)
        
        <span class="hljs-keyword">return</span> is_disrupted, disruption_time
</code></pre>
<p><strong>è®­ç»ƒæ•°æ®</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç ´è£‚æ”¾ç”µæ ·æœ¬</span>
disrupted_sample = {
    <span class="hljs-string">'shot'</span>: <span class="hljs-number">12345</span>,
    <span class="hljs-string">'Ip'</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">50</span>, <span class="hljs-number">100</span>, <span class="hljs-number">120</span>, <span class="hljs-number">80</span>, <span class="hljs-number">20</span>, <span class="hljs-number">0</span>],  <span class="hljs-comment"># ç”µæµçªé™</span>
    <span class="hljs-string">'time'</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">40</span>, <span class="hljs-number">60</span>, <span class="hljs-number">62</span>, <span class="hljs-number">64</span>, <span class="hljs-number">70</span>],
    <span class="hljs-string">'label'</span>: {
        <span class="hljs-string">'is_disrupted'</span>: <span class="hljs-literal">True</span>,
        <span class="hljs-string">'disruption_time'</span>: <span class="hljs-number">61</span>  <span class="hljs-comment"># ms</span>
    }
}

<span class="hljs-comment"># æ­£å¸¸æ”¾ç”µæ ·æœ¬</span>
normal_sample = {
    <span class="hljs-string">'shot'</span>: <span class="hljs-number">12346</span>,
    <span class="hljs-string">'Ip'</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">50</span>, <span class="hljs-number">100</span>, <span class="hljs-number">120</span>, <span class="hljs-number">100</span>, <span class="hljs-number">50</span>, <span class="hljs-number">0</span>],  <span class="hljs-comment"># ç¼“æ…¢ä¸‹é™</span>
    <span class="hljs-string">'time'</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">40</span>, <span class="hljs-number">60</span>, <span class="hljs-number">80</span>, <span class="hljs-number">90</span>, <span class="hljs-number">100</span>],
    <span class="hljs-string">'label'</span>: {
        <span class="hljs-string">'is_disrupted'</span>: <span class="hljs-literal">False</span>,
        <span class="hljs-string">'disruption_time'</span>: <span class="hljs-literal">None</span>
    }
}
</code></pre>
<h4 data-id="heading-18">3.4 ç»“æŸæ—¶åˆ»æ£€æµ‹</h4>
<p><strong>ç‰©ç†å®šä¹‰</strong>:ç­‰ç¦»å­ä½“ç”µæµé™è‡³æ¥è¿‘0çš„æ—¶åˆ»</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">detect_end_time</span>(<span class="hljs-params">Ip, time, threshold=<span class="hljs-number">1</span></span>):
    <span class="hljs-string">"""
    ç»“æŸæ—¶åˆ»æ£€æµ‹
    
    ç®—æ³•:æ‰¾åˆ°ç”µæµæœ€åä¸€æ¬¡ä½äºé˜ˆå€¼çš„æ—¶åˆ»
    """</span>
    below_threshold = np.where(Ip &lt; threshold)[<span class="hljs-number">0</span>]
    
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(below_threshold) == <span class="hljs-number">0</span>:
        <span class="hljs-comment"># æœªç»“æŸ(ä¸å¤ªå¯èƒ½)</span>
        <span class="hljs-keyword">return</span> time[-<span class="hljs-number">1</span>]
    
    last_below_idx = below_threshold[-<span class="hljs-number">1</span>]
    
    <span class="hljs-comment"># å‘å‰æ‰¾åˆ°ç”µæµå¼€å§‹ä¸‹é™ç‚¹</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(last_below_idx, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):
        <span class="hljs-keyword">if</span> Ip[i] &gt; threshold * <span class="hljs-number">2</span>:
            end_idx = i + <span class="hljs-number">1</span>
            <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">else</span>:
        end_idx = last_below_idx
    
    end_time = time[end_idx]
    
    <span class="hljs-keyword">return</span> end_time
</code></pre>
<h4 data-id="heading-19">3.5 Label Studioæ ¼å¼è½¬æ¢</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">convert_predictions</span>(<span class="hljs-params">self, predictions</span>):
    <span class="hljs-string">"""
    è½¬æ¢é¢„æµ‹ç»“æœä¸ºLabel Studioæ ¼å¼
    
    Args:
        predictions: [is_disrupted, ts, td, te]
    
    Returns:
        Label Studioæ—¶é—´ç‚¹æ ‡æ³¨æ ¼å¼
    """</span>
    disrupted, ts, td, te = predictions
    ls_results = []
    
    <span class="hljs-comment"># å‡»ç©¿æ—¶åˆ»(å¿…æœ‰)</span>
    ls_results.append({
        <span class="hljs-string">"from_name"</span>: self.label_group,
        <span class="hljs-string">"to_name"</span>: <span class="hljs-string">"ts"</span>,
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"timeserieslabels"</span>,
        <span class="hljs-string">"value"</span>: {
            <span class="hljs-string">"start"</span>: ts,
            <span class="hljs-string">"end"</span>: ts,
            <span class="hljs-string">"instant"</span>: <span class="hljs-literal">True</span>,  <span class="hljs-comment"># æ—¶é—´ç‚¹æ ‡æ³¨</span>
            <span class="hljs-string">"timeserieslabels"</span>: [<span class="hljs-string">"å‡»ç©¿æ—¶åˆ»"</span>]
        }
    })
    
    <span class="hljs-comment"># ç ´è£‚æ—¶åˆ»(æ¡ä»¶:æœ‰ç ´è£‚)</span>
    <span class="hljs-keyword">if</span> disrupted <span class="hljs-keyword">and</span> td <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
        ls_results.append({
            <span class="hljs-string">"from_name"</span>: self.label_group,
            <span class="hljs-string">"to_name"</span>: <span class="hljs-string">"ts"</span>,
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"timeserieslabels"</span>,
            <span class="hljs-string">"value"</span>: {
                <span class="hljs-string">"start"</span>: td,
                <span class="hljs-string">"end"</span>: td,
                <span class="hljs-string">"instant"</span>: <span class="hljs-literal">True</span>,
                <span class="hljs-string">"timeserieslabels"</span>: [<span class="hljs-string">"ç ´è£‚æ—¶åˆ»"</span>]
            }
        })
    
    <span class="hljs-comment"># ç»“æŸæ—¶åˆ»(å¿…æœ‰)</span>
    ls_results.append({
        <span class="hljs-string">"from_name"</span>: self.label_group,
        <span class="hljs-string">"to_name"</span>: <span class="hljs-string">"ts"</span>,
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"timeserieslabels"</span>,
        <span class="hljs-string">"value"</span>: {
            <span class="hljs-string">"start"</span>: te,
            <span class="hljs-string">"end"</span>: te,
            <span class="hljs-string">"instant"</span>: <span class="hljs-literal">True</span>,
            <span class="hljs-string">"timeserieslabels"</span>: [<span class="hljs-string">"ç»“æŸæ—¶åˆ»"</span>]
        }
    })
    
    <span class="hljs-keyword">return</span> [{<span class="hljs-string">"result"</span>: ls_results}]
</code></pre>
<hr/>
<h3 data-id="heading-20">å››ã€å®æˆ˜åº”ç”¨æ¡ˆä¾‹</h3>
<h4 data-id="heading-21">æ¡ˆä¾‹1:SUNISTè£…ç½®å†å²æ•°æ®æ ‡æ³¨</h4>
<p><strong>èƒŒæ™¯</strong>:</p>
<ul>
<li>å†å²æ”¾ç”µæ•°æ®:5000ç‚®</li>
<li>éœ€è¦æ ‡æ³¨ç”¨äºç ´è£‚é¢„è­¦æ¨¡å‹è®­ç»ƒ</li>
<li>äººå·¥æ ‡æ³¨ä¸ç°å®</li>
</ul>
<p><strong>æ‰¹é‡æ ‡æ³¨æ–¹æ¡ˆ</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ‰¹é‡å¤„ç†è„šæœ¬</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">batch_annotate_shots</span>(<span class="hljs-params">shot_list</span>):
    <span class="hljs-string">"""
    æ‰¹é‡æ ‡æ³¨å†å²æ•°æ®
    """</span>
    results = []
    
    <span class="hljs-comment"># åˆ†æ‰¹å¤„ç†(æ¯æ‰¹100ç‚®)</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(shot_list), <span class="hljs-number">100</span>):
        batch_shots = shot_list[i:i+<span class="hljs-number">100</span>]
        
        <span class="hljs-comment"># è°ƒç”¨æ¨¡å‹æœåŠ¡</span>
        response = requests.get(
            model_url + <span class="hljs-string">"predict"</span>,
            json={<span class="hljs-string">"shot"</span>: batch_shots}
        )
        
        predictions = response.json()
        
        <span class="hljs-comment"># ä¿å­˜åˆ°æ•°æ®åº“</span>
        <span class="hljs-keyword">for</span> shot, pred <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(batch_shots, predictions):
            is_disrupted, ts, td, te = pred
            
            save_annotation(
                shot=shot,
                breakdown_time=ts,
                disruption_time=td,
                end_time=te,
                is_disrupted=is_disrupted
            )
            
            results.append({
                <span class="hljs-string">'shot'</span>: shot,
                <span class="hljs-string">'ts'</span>: ts,
                <span class="hljs-string">'td'</span>: td,
                <span class="hljs-string">'te'</span>: te
            })
    
    <span class="hljs-keyword">return</span> results

<span class="hljs-comment"># æ‰§è¡Œæ‰¹é‡æ ‡æ³¨</span>
shot_list = <span class="hljs-built_in">range</span>(<span class="hljs-number">10000</span>, <span class="hljs-number">15000</span>)  <span class="hljs-comment"># ç‚®å·10000-15000</span>
results = batch_annotate_shots(shot_list)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å·²æ ‡æ³¨ <span class="hljs-subst">{<span class="hljs-built_in">len</span>(results)}</span> ç‚®æ•°æ®"</span>)
</code></pre>
<p><strong>æ•ˆæœ</strong>:</p>
<ul>
<li>å¤„ç†é€Ÿåº¦:5000ç‚® Ã— 0.5ç§’ = 41åˆ†é’Ÿ</li>
<li>äººå·¥æ ‡æ³¨:5000ç‚® Ã— 8åˆ†é’Ÿ = 666å°æ—¶</li>
<li><strong>æ•ˆç‡æå‡970å€</strong></li>
</ul>
<h4 data-id="heading-22">æ¡ˆä¾‹2:ç ´è£‚é¢„è­¦æ¨¡å‹è®­ç»ƒ</h4>
<p><strong>éœ€æ±‚</strong>:è®­ç»ƒç ´è£‚é¢„è­¦æ¨¡å‹,éœ€è¦ç²¾ç¡®çš„ç ´è£‚æ—¶åˆ»æ ‡ç­¾</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ•°æ®å‡†å¤‡</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">prepare_disruption_dataset</span>(<span class="hljs-params">shot_list</span>):
    <span class="hljs-string">"""
    å‡†å¤‡ç ´è£‚é¢„è­¦è®­ç»ƒæ•°æ®
    """</span>
    X_train = []
    y_train = []
    
    <span class="hljs-keyword">for</span> shot <span class="hljs-keyword">in</span> shot_list:
        <span class="hljs-comment"># åŠ è½½è¯Šæ–­æ•°æ®</span>
        data = load_shot_data(shot)
        
        <span class="hljs-comment"># åŠ è½½æ ‡æ³¨(ç”±ML Backendç”Ÿæˆ)</span>
        annotation = load_annotation(shot)
        td = annotation[<span class="hljs-string">'disruption_time'</span>]
        te = annotation[<span class="hljs-string">'end_time'</span>]
        
        <span class="hljs-keyword">if</span> annotation[<span class="hljs-string">'is_disrupted'</span>]:
            <span class="hljs-comment"># æˆªå–ç ´è£‚å‰30msçš„æ•°æ®ä½œä¸ºç‰¹å¾</span>
            time_window = (td - <span class="hljs-number">0.030</span>, td)
            features = extract_features_in_window(data, time_window)
            
            X_train.append(features)
            y_train.append(<span class="hljs-number">1</span>)  <span class="hljs-comment"># æœ‰ç ´è£‚</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># æˆªå–ç»“æŸå‰30msä½œä¸ºè´Ÿæ ·æœ¬</span>
            time_window = (te - <span class="hljs-number">0.030</span>, te)
            features = extract_features_in_window(data, time_window)
            
            X_train.append(features)
            y_train.append(<span class="hljs-number">0</span>)  <span class="hljs-comment"># æ— ç ´è£‚</span>
    
    <span class="hljs-keyword">return</span> np.array(X_train), np.array(y_train)

<span class="hljs-comment"># è®­ç»ƒæ¨¡å‹</span>
X_train, y_train = prepare_disruption_dataset(shot_list)
model = train_disruption_predictor(X_train, y_train)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"è®­ç»ƒé›†å¤§å°: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(X_train)}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç ´è£‚æ ·æœ¬: <span class="hljs-subst">{np.<span class="hljs-built_in">sum</span>(y_train)}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ­£å¸¸æ ·æœ¬: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(y_train) - np.<span class="hljs-built_in">sum</span>(y_train)}</span>"</span>)
</code></pre>
<p><strong>æ¨¡å‹æ€§èƒ½</strong>:</p>
<ul>
<li>å‡†ç¡®ç‡:92.3%</li>
<li>å¬å›ç‡:88.7%(ç ´è£‚è¯†åˆ«ç‡)</li>
<li>æå‰é¢„è­¦æ—¶é—´:20-50ms</li>
</ul>
<h4 data-id="heading-23">æ¡ˆä¾‹3:å®éªŒå‚æ•°ä¼˜åŒ–</h4>
<p><strong>éœ€æ±‚</strong>:ç ”ç©¶ä¸åŒåŠ çƒ­åŠŸç‡å¯¹æ”¾ç”µæŒç»­æ—¶é—´çš„å½±å“</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç»Ÿè®¡åˆ†æ</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">analyze_discharge_duration</span>(<span class="hljs-params">power_levels</span>):
    <span class="hljs-string">"""
    åˆ†ææ”¾ç”µæŒç»­æ—¶é—´ vs åŠ çƒ­åŠŸç‡
    """</span>
    results = []
    
    <span class="hljs-keyword">for</span> power <span class="hljs-keyword">in</span> power_levels:
        <span class="hljs-comment"># ç­›é€‰è¯¥åŠŸç‡ä¸‹çš„æ‰€æœ‰æ”¾ç”µ</span>
        shots = query_shots_by_power(power)
        
        durations = []
        <span class="hljs-keyword">for</span> shot <span class="hljs-keyword">in</span> shots:
            annotation = load_annotation(shot)
            ts = annotation[<span class="hljs-string">'breakdown_time'</span>]
            te = annotation[<span class="hljs-string">'end_time'</span>]
            
            duration = te - ts
            durations.append(duration)
        
        results.append({
            <span class="hljs-string">'power'</span>: power,
            <span class="hljs-string">'avg_duration'</span>: np.mean(durations),
            <span class="hljs-string">'std_duration'</span>: np.std(durations),
            <span class="hljs-string">'num_shots'</span>: <span class="hljs-built_in">len</span>(durations)
        })
    
    <span class="hljs-keyword">return</span> results

<span class="hljs-comment"># æ‰§è¡Œåˆ†æ</span>
power_levels = [<span class="hljs-number">100</span>, <span class="hljs-number">150</span>, <span class="hljs-number">200</span>, <span class="hljs-number">250</span>, <span class="hljs-number">300</span>]  <span class="hljs-comment"># kW</span>
results = analyze_discharge_duration(power_levels)

<span class="hljs-comment"># ç»˜åˆ¶æ›²çº¿</span>
plot_power_vs_duration(results)
</code></pre>
<p><strong>å‘ç°</strong>:</p>
<ul>
<li>åŠ çƒ­åŠŸç‡200kWæ—¶,æ”¾ç”µæŒç»­æ—¶é—´æœ€é•¿(82ms)</li>
<li>åŠŸç‡è¿‡é«˜(&gt;250kW)åè€Œç¼©çŸ­æŒç»­æ—¶é—´(ä¸ç¨³å®š)</li>
<li><strong>æŒ‡å¯¼å®éªŒå‚æ•°ä¼˜åŒ–</strong></li>
</ul>
<hr/>
<h3 data-id="heading-24">äº”ã€æŠ€æœ¯ä¼˜åŒ–å»ºè®®</h3>
<h4 data-id="heading-25">5.1 æ¨¡å‹å‡çº§æ–¹å‘</h4>
<p><strong>ä¼˜åŒ–1:Transformeræ¨¡å‹</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TransformerDisruptionDetector</span>(nn.Module):
    <span class="hljs-string">"""
    åŸºäºTransformerçš„ç ´è£‚æ£€æµ‹
    
    ä¼˜åŠ¿:
    - æ›´å¥½æ•è·é•¿æœŸä¾èµ–
    - è‡ªæ³¨æ„åŠ›æœºåˆ¶è§£é‡Šæ€§å¼º
    """</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, input_dim=<span class="hljs-number">4</span>, d_model=<span class="hljs-number">64</span>, nhead=<span class="hljs-number">4</span>, num_layers=<span class="hljs-number">2</span></span>):
        <span class="hljs-built_in">super</span>().__init__()
        
        <span class="hljs-comment"># è¾“å…¥åµŒå…¥</span>
        self.embedding = nn.Linear(input_dim, d_model)
        
        <span class="hljs-comment"># Transformerç¼–ç å™¨</span>
        encoder_layer = nn.TransformerEncoderLayer(
            d_model=d_model, 
            nhead=nhead
        )
        self.transformer = nn.TransformerEncoder(
            encoder_layer, 
            num_layers=num_layers
        )
        
        <span class="hljs-comment"># è¾“å‡ºå±‚</span>
        self.classifier = nn.Linear(d_model, <span class="hljs-number">2</span>)
        self.regressor = nn.Linear(d_model, <span class="hljs-number">1</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):
        <span class="hljs-comment"># x: [batch, seq_len, input_dim]</span>
        
        <span class="hljs-comment"># åµŒå…¥</span>
        x = self.embedding(x)  <span class="hljs-comment"># [batch, seq_len, d_model]</span>
        
        <span class="hljs-comment"># Transformerç¼–ç </span>
        x = x.permute(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>)  <span class="hljs-comment"># [seq_len, batch, d_model]</span>
        x = self.transformer(x)
        x = x.permute(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>)  <span class="hljs-comment"># [batch, seq_len, d_model]</span>
        
        <span class="hljs-comment"># ä½¿ç”¨æœ€åæ—¶åˆ»</span>
        x_last = x[:, -<span class="hljs-number">1</span>, :]  <span class="hljs-comment"># [batch, d_model]</span>
        
        <span class="hljs-comment"># é¢„æµ‹</span>
        is_disrupted = self.classifier(x_last)
        disruption_time = self.regressor(x_last)
        
        <span class="hljs-keyword">return</span> is_disrupted, disruption_time
</code></pre>
<h4 data-id="heading-26">5.2 å®æ—¶é¢„æµ‹</h4>
<p><strong>ä¼˜åŒ–2:æµå¼å¤„ç†</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">StreamingTimingDetector</span>:
    <span class="hljs-string">"""
    å®æ—¶æ—¶åˆ»æ£€æµ‹
    
    åº”ç”¨:å®éªŒè¿‡ç¨‹ä¸­å®æ—¶æ£€æµ‹å‡»ç©¿
    """</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.buffer = []
        self.detected_breakdown = <span class="hljs-literal">False</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">on_new_data</span>(<span class="hljs-params">self, Ip_new, time_new</span>):
        <span class="hljs-string">"""
        æ¥æ”¶æ–°æ•°æ®ç‚¹
        """</span>
        self.buffer.append((Ip_new, time_new))
        
        <span class="hljs-comment"># ä¿æŒ1ç§’çª—å£</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.buffer) &gt; <span class="hljs-number">1000</span>:
            self.buffer.pop(<span class="hljs-number">0</span>)
        
        <span class="hljs-comment"># æ£€æµ‹å‡»ç©¿</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.detected_breakdown:
            Ip_array = np.array([x[<span class="hljs-number">0</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> self.buffer])
            
            <span class="hljs-keyword">if</span> np.<span class="hljs-built_in">any</span>(Ip_array &gt; <span class="hljs-number">10</span>):  <span class="hljs-comment"># å‡»ç©¿é˜ˆå€¼</span>
                ts = self.detect_breakdown_in_buffer()
                self.emit_event(<span class="hljs-string">'breakdown'</span>, ts)
                self.detected_breakdown = <span class="hljs-literal">True</span>
</code></pre>
<hr/>
<h3 data-id="heading-27">å…­ã€æ€»ç»“</h3>
<h4 data-id="heading-28">æ ¸å¿ƒä»·å€¼</h4>
<p>æ”¾ç”µæ—¶åºç‰¹å¾ML Backendé€šè¿‡<strong>è¿œç¨‹AIæ¨¡å‹æœåŠ¡</strong>,å®ç°äº†:</p>
<ol>
<li><strong>è‡ªåŠ¨åŒ–æ—¶åˆ»æ ‡æ³¨</strong>:å‡»ç©¿/ç ´è£‚/ç»“æŸä¸‰ä¸ªå…³é”®æ—¶åˆ»</li>
<li><strong>é«˜ç²¾åº¦æ£€æµ‹</strong>:Â±0.5msç²¾åº¦,ä¼˜äºäººå·¥Â±5ms</li>
<li><strong>æ‰¹é‡å¤„ç†èƒ½åŠ›</strong>:æ”¯æŒå†å²æ•°æ®å¤§è§„æ¨¡æ ‡æ³¨</li>
<li><strong>æœåŠ¡åŒ–æ¶æ„</strong>:å‰åç«¯åˆ†ç¦»,æ˜“äºå‡çº§ç»´æŠ¤</li>
</ol>
<h4 data-id="heading-29">é€‚ç”¨åœºæ™¯</h4>

























<table><thead><tr><th>åœºæ™¯</th><th>åº”ç”¨</th><th>ä»·å€¼</th></tr></thead><tbody><tr><td>ç­‰ç¦»å­ä½“å®éªŒ</td><td>æ—¶åˆ»æ ‡æ³¨</td><td>åŠ é€Ÿæ•°æ®å¤„ç†</td></tr><tr><td>ç ´è£‚é¢„è­¦</td><td>è®­ç»ƒæ•°æ®å‡†å¤‡</td><td>æå‡æ¨¡å‹æ€§èƒ½</td></tr><tr><td>å‚æ•°ä¼˜åŒ–</td><td>ç»Ÿè®¡åˆ†æ</td><td>æŒ‡å¯¼å®éªŒè®¾è®¡</td></tr></tbody></table>
<p><strong>æ”¾ç”µæ—¶åºç‰¹å¾ML Backendæ˜¯"AI+ç‰©ç†å®éªŒ"çš„å…¸å‹åº”ç”¨,å°†æ·±åº¦å­¦ä¹ æ¨¡å‹ä»¥æœåŠ¡åŒ–æ–¹å¼é›†æˆåˆ°ç§‘ç ”å·¥ä½œæµ,å¤§å¹…æå‡å®éªŒæ•°æ®åˆ†ææ•ˆç‡ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>