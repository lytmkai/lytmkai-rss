<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[CSS å…¨å±€æ ·å¼æ±¡æŸ“é—®é¢˜å¤ç›˜]]></title>    <link>https://juejin.cn/post/7587284708947771407</link>    <guid>https://juejin.cn/post/7587284708947771407</guid>    <pubDate>2025-12-25T02:22:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587284708947771407" data-draft-id="7587261253912969231" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CSS å…¨å±€æ ·å¼æ±¡æŸ“é—®é¢˜å¤ç›˜"/> <meta itemprop="keywords" content="CSS"/> <meta itemprop="datePublished" content="2025-12-25T02:22:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§è±¡çš„é¼»å­é‚£ä¹ˆé•¿"/> <meta itemprop="url" content="https://juejin.cn/user/2277843821926871"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CSS å…¨å±€æ ·å¼æ±¡æŸ“é—®é¢˜å¤ç›˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2277843821926871/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§è±¡çš„é¼»å­é‚£ä¹ˆé•¿
  </span> <!----> <!----> <div class="vip-level" data-v-cd7d0a50="" data-v-292f6e48=""><span class="tooltip" data-v-cd7d0a50=""><div class="byte-tooltip byte-tooltip--dark" style="display:none;">
        VIP.4 èä¼šè´¯é€š
      </div><span class="byte-tooltip__wrapper"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="VIP.4 èä¼šè´¯é€š" title="VIP.4 èä¼šè´¯é€š" class="lazy" style="aspect-ratio:NaN;" data-v-5244ef91="" data-v-cd7d0a50=""/></span></span></div> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T02:22:34.000Z" title="Thu Dec 25 2025 02:22:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€é—®é¢˜ç°è±¡</h2>
<h3 data-id="heading-1">1.1 é—®é¢˜æè¿°</h3>
<p>VGM ç¼–è¾‘å¼¹çª—ï¼ˆä½¿ç”¨ <code>CmcDialog</code> ç»„ä»¶ï¼‰å‡ºç°å¼‚å¸¸çš„å†…è¾¹è·ï¼Œå¯¼è‡´å¼¹çª—å†…å®¹å¸ƒå±€é”™ä¹±ï¼Œè¡¨å•å…ƒç´ é—´è·è¿‡å¤§ã€‚</p>
<h3 data-id="heading-2">1.2 é—®é¢˜æˆªå›¾</h3>
<p>å¼¹çª—å†…å®¹åŒºåŸŸå‡ºç°äº†ä¸åº”æœ‰çš„ <code>padding: 52px 50px</code> æ ·å¼ï¼Œå¯¼è‡´ï¼š</p>
<ul>
<li>è¡¨å•å†…å®¹è¢«å‹ç¼©</li>
<li>å¸ƒå±€ä¸è®¾è®¡ç¨¿ä¸ç¬¦</li>
<li>è§†è§‰æ•ˆæœå¼‚å¸¸</li>
</ul>
<h3 data-id="heading-3">1.3 å½±å“èŒƒå›´</h3>
<p>æ‰€æœ‰ä½¿ç”¨ <code>el-dialog</code> æˆ–åŸºäº <code>el-dialog</code> å°è£…çš„ç»„ä»¶ï¼ˆå¦‚ <code>CmcDialog</code>ï¼‰éƒ½å—åˆ°å½±å“ã€‚</p>
<hr/>
<h2 data-id="heading-4">äºŒã€é—®é¢˜å®šä½</h2>
<h3 data-id="heading-5">2.1 æ’æŸ¥è¿‡ç¨‹</h3>
<ol>
<li><strong>æ£€æŸ¥ç»„ä»¶è‡ªèº«æ ·å¼</strong> - <code>CmcDialog</code> ç»„ä»¶æ ·å¼æ­£å¸¸</li>
<li><strong>æ£€æŸ¥çˆ¶ç»„ä»¶æ ·å¼</strong> - ä½¿ç”¨ <code>CmcDialog</code> çš„é¡µé¢æ— å¼‚å¸¸æ ·å¼</li>
<li><strong>ä½¿ç”¨ DevTools æ£€æŸ¥</strong> - å‘ç° <code>.el-dialog</code> è¢«æ³¨å…¥äº†å…¨å±€æ ·å¼</li>
<li><strong>å…¨å±€æœç´¢æ±¡æŸ“æº</strong> - æœç´¢ <code>padding: 52px 50px</code> å®šä½åˆ°é—®é¢˜æ–‡ä»¶</li>
</ol>
<h3 data-id="heading-6">2.2 é—®é¢˜æ ¹æº</h3>
<p>åœ¨ <code>src/views/search_service/ship-schedules/components/Subscribe.vue</code> ä¸­å‘ç°ä»¥ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;style scoped lang="scss"&gt;
.subscriber-dialog {
  :global(.el-dialog) {
    padding: 52px 50px;
  }
}
&lt;/style&gt;
</code></pre>
<h3 data-id="heading-7">2.3 ä¸ºä»€ä¹ˆä¼šé€ æˆå…¨å±€æ±¡æŸ“ï¼Ÿ</h3>
<p>è¿™é‡Œæ¶‰åŠåˆ° Vue Scoped CSS å’Œ <code>:global()</code> çš„å·¥ä½œåŸç†ï¼š</p>
<h4 data-id="heading-8">Vue Scoped CSS åŸç†</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- ç¼–è¯‘å‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
  <span class="hljs-selector-class">.subscriber-dialog</span> {
    <span class="hljs-attribute">color</span>: red;
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>

<span class="hljs-comment">&lt;!-- ç¼–è¯‘å --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
  <span class="hljs-selector-class">.subscriber-dialog</span><span class="hljs-selector-attr">[data-v-xxxxx]</span> {
    <span class="hljs-attribute">color</span>: red;
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>

</code></pre>
<p>Vue ä¼šä¸º scoped æ ·å¼æ·»åŠ å”¯ä¸€çš„ <code>data-v-xxxxx</code> å±æ€§é€‰æ‹©å™¨ï¼Œç¡®ä¿æ ·å¼åªä½œç”¨äºå½“å‰ç»„ä»¶ã€‚</p>
<h4 data-id="heading-9">:global() çš„ä½œç”¨</h4>
<p><code>:global()</code> æ˜¯ CSS Modules å’Œ Vue çš„ä¸€ä¸ªç‰¹æ€§ï¼Œç”¨äº<strong>è·³è¿‡ scoped é™åˆ¶</strong>ï¼Œç”Ÿæˆå…¨å±€æ ·å¼ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ç¼–è¯‘å‰</span>
<span class="hljs-selector-class">.subscriber-dialog</span> {
  :<span class="hljs-built_in">global</span>(.el-dialog) {
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">52px</span> <span class="hljs-number">50px</span>;
  }
}

<span class="hljs-comment">// ç¼–è¯‘åï¼ˆæ³¨æ„ï¼š.el-dialog æ²¡æœ‰ data-v å±æ€§ï¼ï¼‰</span>
<span class="hljs-selector-class">.subscriber-dialog</span><span class="hljs-selector-attr">[data-v-xxxxx]</span> <span class="hljs-selector-class">.el-dialog</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">52px</span> <span class="hljs-number">50px</span>;
}

</code></pre>
<h4 data-id="heading-10">å…³é”®é—®é¢˜ï¼šel-dialog çš„ DOM ç»“æ„</h4>
<p>Element Plus çš„ <code>el-dialog</code> é»˜è®¤ä¼šé€šè¿‡ <code>append-to-body</code> å°† DOM æŒ‚è½½åˆ° <code>&lt;body&gt;</code> ä¸‹ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- é¡µé¢å†…å®¹ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"subscriber-dialog"</span> <span class="hljs-attr">data-v-xxxxx</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- è§¦å‘æŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- Dialog è¢« teleport åˆ° body ä¸‹ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"el-overlay subscriber-dialog"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- modal-class åº”ç”¨åœ¨è¿™é‡Œ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"el-dialog"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- å®é™…çš„ dialog --&gt;</span>
      ...
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

</code></pre>
<p>ç”±äº <code>modal-class="subscriber-dialog"</code> åº”ç”¨åˆ°äº† <code>el-overlay</code> ä¸Šï¼Œè€Œ <code>.el-dialog</code> æ˜¯å…¶å­å…ƒç´ ï¼Œæ‰€ä»¥é€‰æ‹©å™¨ <code>.subscriber-dialog .el-dialog</code> èƒ½å¤ŸåŒ¹é…åˆ°ï¼</p>
<p><strong>ä½†é—®é¢˜åœ¨äº</strong>ï¼š<code>:global(.el-dialog)</code> ç”Ÿæˆçš„æ ·å¼<strong>æ²¡æœ‰è¶³å¤Ÿçš„ç‰¹å¼‚æ€§é™åˆ¶</strong>ï¼Œå½“å…¶ä»–é¡µé¢çš„ dialog ä¹Ÿè¢«æŒ‚è½½åˆ° body æ—¶ï¼Œå¦‚æœ CSS åŠ è½½é¡ºåºå¯¼è‡´è¿™ä¸ªæ ·å¼ååŠ è½½ï¼Œå°±ä¼šè¦†ç›–å…¶ä»– dialog çš„æ ·å¼ã€‚</p>
<hr/>
<h2 data-id="heading-11">ä¸‰ã€æ·±åº¦åŸç†å‰–æ</h2>
<h3 data-id="heading-12">3.1 CSS ç‰¹å¼‚æ€§ï¼ˆSpecificityï¼‰</h3>
<p>CSS ç‰¹å¼‚æ€§å†³å®šäº†å½“å¤šä¸ªè§„åˆ™åº”ç”¨äºåŒä¸€å…ƒç´ æ—¶ï¼Œå“ªä¸ªè§„åˆ™ä¼˜å…ˆï¼š</p>

























<table><thead><tr><th>é€‰æ‹©å™¨ç±»å‹</th><th>ç‰¹å¼‚æ€§å€¼</th></tr></thead><tbody><tr><td>å†…è”æ ·å¼</td><td>1000</td></tr><tr><td>ID é€‰æ‹©å™¨</td><td>100</td></tr><tr><td>ç±»/å±æ€§/ä¼ªç±»</td><td>10</td></tr><tr><td>å…ƒç´ /ä¼ªå…ƒç´ </td><td>1</td></tr></tbody></table>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ç‰¹å¼‚æ€§ï¼š20ï¼ˆä¸¤ä¸ªç±»é€‰æ‹©å™¨ï¼‰</span>
<span class="hljs-selector-class">.subscriber-dialog</span> <span class="hljs-selector-class">.el-dialog</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">52px</span> <span class="hljs-number">50px</span>;
}

<span class="hljs-comment">// ç‰¹å¼‚æ€§ï¼š20ï¼ˆä¸¤ä¸ªç±»é€‰æ‹©å™¨ï¼‰</span>
<span class="hljs-selector-class">.cmc-dialog</span><span class="hljs-selector-class">.el-dialog</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
}

</code></pre>
<p>å½“ç‰¹å¼‚æ€§ç›¸åŒæ—¶ï¼Œ<strong>ååŠ è½½çš„æ ·å¼ä¼šè¦†ç›–å…ˆåŠ è½½çš„æ ·å¼</strong>ã€‚</p>
<h3 data-id="heading-13">3.2 æ ·å¼åŠ è½½é¡ºåºé—®é¢˜</h3>
<p>åœ¨ SPA åº”ç”¨ä¸­ï¼Œç»„ä»¶æ ·å¼æ˜¯æŒ‰éœ€åŠ è½½çš„ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> ç”¨æˆ·è®¿é—®é¦–é¡µ â†’ åŠ è½½é¦–é¡µç»„ä»¶æ ·å¼
<span class="hljs-bullet">2.</span> ç”¨æˆ·è®¿é—®èˆ¹æœŸé¡µé¢ â†’ åŠ è½½ Subscribe.vue æ ·å¼ï¼ˆåŒ…å«å…¨å±€æ±¡æŸ“ï¼‰
<span class="hljs-bullet">3.</span> ç”¨æˆ·è®¿é—® VGM é¡µé¢ â†’ CmcDialog æ ·å¼è¢«æ±¡æŸ“æ ·å¼è¦†ç›–
</code></pre>
<h3 data-id="heading-14">3.3 Teleport/Portal çš„å½±å“</h3>
<p>Element Plus Dialog ä½¿ç”¨ Vue 3 çš„ Teleport ç‰¹æ€§ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;Teleport to="body"&gt;
  &lt;div class="el-overlay"&gt;
    &lt;div class="el-dialog"&gt;...&lt;/div&gt;
  &lt;/div&gt;
&lt;/Teleport&gt;
</code></pre>
<p>è¿™å¯¼è‡´ï¼š</p>
<ol>
<li>Dialog DOM è„±ç¦»äº†ç»„ä»¶çš„ DOM æ ‘</li>
<li>Scoped æ ·å¼çš„ <code>data-v-xxxxx</code> å±æ€§æ— æ³•æ­£ç¡®åº”ç”¨</li>
<li>å¿…é¡»ä½¿ç”¨ <code>:global()</code> æˆ– <code>:deep()</code> æ‰èƒ½æ ·å¼åŒ– dialog</li>
</ol>
<hr/>
<h2 data-id="heading-15">å››ã€ä¿®å¤æ–¹æ¡ˆ</h2>
<h3 data-id="heading-16">4.1 ä¿®å¤æ±¡æŸ“æºï¼ˆæ²»æœ¬ï¼‰</h3>
<p><strong>ä¿®æ”¹å‰ï¼ˆé”™è¯¯å†™æ³•ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-vue" lang="vue">&lt;el-dialog modal-class="subscriber-dialog"&gt;
  ...
&lt;/el-dialog&gt;

&lt;style scoped lang="scss"&gt;
.subscriber-dialog {
  :global(.el-dialog) {
    padding: 52px 50px;
  }
}
&lt;/style&gt;
</code></pre>
<p><strong>ä¿®æ”¹åï¼ˆæ­£ç¡®å†™æ³•ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-vue" lang="vue">&lt;el-dialog class="subscriber-dialog-box" modal-class="subscriber-dialog"&gt;
  ...
&lt;/el-dialog&gt;

&lt;style scoped lang="scss"&gt;
// ä½¿ç”¨ class å±æ€§ç›´æ¥åº”ç”¨åˆ° el-dialog ä¸Š
// ç»„åˆé€‰æ‹©å™¨ç¡®ä¿åªå½±å“ç‰¹å®šçš„ dialog
:global(.subscriber-dialog-box) {
  padding: 52px 50px;

  .el-dialog__header {
    display: none;
  }
}
&lt;/style&gt;
</code></pre>
<p><strong>å…³é”®æ”¹åŠ¨ï¼š</strong></p>
<ol>
<li>ä½¿ç”¨ <code>class</code> è€Œéä»…ä¾èµ– <code>modal-class</code></li>
<li>ä½¿ç”¨<strong>ç»„åˆé€‰æ‹©å™¨</strong> <code>.subscriber-dialog-box</code> ç¡®ä¿å”¯ä¸€æ€§</li>
<li>æ ·å¼åªä½œç”¨äºå¸¦æœ‰è¯¥ç‰¹å®šç±»åçš„ dialog</li>
</ol>
<h3 data-id="heading-17">4.2 åŠ å›ºç»„ä»¶åº“ï¼ˆæ²»æ ‡ + é˜²å¾¡ï¼‰</h3>
<p>åœ¨ <code>CmcDialog</code> ç»„ä»¶ä¸­æ·»åŠ é«˜ä¼˜å…ˆçº§æ ·å¼é‡ç½®ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-selector-class">.cmc-dialog</span> {
  &amp;<span class="hljs-selector-class">.el-dialog</span> {
    <span class="hljs-comment">// ä½¿ç”¨ !important ç¡®ä¿ä¸è¢«å¤–éƒ¨æ ·å¼è¦†ç›–</span>
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;
    <span class="hljs-attribute">padding-top</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;
    <span class="hljs-attribute">padding-bottom</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;
    <span class="hljs-attribute">padding-left</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;
    <span class="hljs-attribute">padding-right</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;
  }

  <span class="hljs-selector-class">.el-dialog__header</span> {
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;
  }

  <span class="hljs-selector-class">.el-dialog__body</span> {
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;
  }

  <span class="hljs-selector-class">.el-dialog__footer</span> {
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-meta">!important</span>;
  }
}

</code></pre>
<hr/>
<h2 data-id="heading-18">äº”ã€åŒç±»é—®é¢˜é¢„é˜²æŒ‡å—</h2>
<h3 data-id="heading-19">5.1 âŒ é”™è¯¯å†™æ³•ç¤ºä¾‹</h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// é”™è¯¯1ï¼šç›´æ¥ä½¿ç”¨ :global ä¿®æ”¹ Element Plus ç»„ä»¶</span>
:<span class="hljs-built_in">global</span>(.el-dialog) { ... }
:<span class="hljs-built_in">global</span>(.el-table) { ... }
:<span class="hljs-built_in">global</span>(.el-form) { ... }

<span class="hljs-comment">// é”™è¯¯2ï¼šåœ¨ scoped æ ·å¼ä¸­ä½¿ç”¨è¿‡äºå®½æ³›çš„é€‰æ‹©å™¨</span>
<span class="hljs-selector-class">.my-page</span> {
  :<span class="hljs-built_in">global</span>(.el-button) {
    <span class="hljs-attribute">background</span>: red;
  }
}

<span class="hljs-comment">// é”™è¯¯3ï¼šåœ¨å…¨å±€æ ·å¼æ–‡ä»¶ä¸­ç›´æ¥ä¿®æ”¹ç»„ä»¶æ ·å¼</span>
<span class="hljs-comment">// src/assets/styles/index.scss</span>
<span class="hljs-selector-class">.el-dialog</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">52px</span> <span class="hljs-number">50px</span>;
}
</code></pre>
<h3 data-id="heading-20">5.2 âœ… æ­£ç¡®å†™æ³•ç¤ºä¾‹</h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æ­£ç¡®1ï¼šä½¿ç”¨ç»„åˆé€‰æ‹©å™¨ï¼Œç¡®ä¿å”¯ä¸€æ€§</span>
:<span class="hljs-built_in">global</span>(.my-specific-dialog.el-dialog) {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">52px</span> <span class="hljs-number">50px</span>;
}

<span class="hljs-comment">// æ­£ç¡®2ï¼šä½¿ç”¨ BEM å‘½å + ç»„åˆé€‰æ‹©å™¨</span>
:<span class="hljs-built_in">global</span>(.page-name__dialog.el-dialog) {
  <span class="hljs-comment">// æ ·å¼</span>
}

<span class="hljs-comment">// æ­£ç¡®3ï¼šåœ¨ç»„ä»¶ä¸Šä½¿ç”¨ class å±æ€§</span>
&lt;el-dialog class="my-unique-dialog"&gt;

<span class="hljs-comment">// æ­£ç¡®4ï¼šä½¿ç”¨ CSS å˜é‡è¿›è¡Œå®šåˆ¶</span>
<span class="hljs-selector-class">.my-dialog</span> {
  <span class="hljs-attr">--el-dialog-padding-primary</span>: <span class="hljs-number">52px</span> <span class="hljs-number">50px</span>;
}

</code></pre>
<h3 data-id="heading-21">5.3 ä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•</h3>
<p>åœ¨ Code Review æ—¶ï¼Œæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š</p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦ä½¿ç”¨äº† <code>:global(.el-xxx)</code> ç›´æ¥ä¿®æ”¹ Element Plus ç»„ä»¶ï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å…¨å±€æ ·å¼æ–‡ä»¶ä¸­æ˜¯å¦æœ‰ç›´æ¥ä¿®æ”¹ç»„ä»¶åº“æ ·å¼çš„ä»£ç ï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ä½¿ç”¨ <code>:global()</code> æ—¶æ˜¯å¦æ·»åŠ äº†è¶³å¤Ÿç‰¹å¼‚æ€§çš„çˆ¶é€‰æ‹©å™¨ï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> Dialog/Drawer ç­‰ Teleport ç»„ä»¶æ˜¯å¦ä½¿ç”¨äº† <code>class</code> å±æ€§ï¼Ÿ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ ·å¼æ˜¯å¦å¯èƒ½å½±å“å…¶ä»–é¡µé¢çš„åŒç±»ç»„ä»¶ï¼Ÿ</li>
</ul>
<h3 data-id="heading-22">5.4 ESLint/Stylelint è§„åˆ™å»ºè®®</h3>
<p>å¯ä»¥é…ç½® Stylelint è§„åˆ™æ¥æ£€æµ‹æ½œåœ¨çš„å…¨å±€æ±¡æŸ“ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// stylelint.config.js</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">rules</span>: {
    <span class="hljs-comment">// ç¦æ­¢ç›´æ¥ä½¿ç”¨ Element Plus ç±»åä½œä¸ºé€‰æ‹©å™¨</span>
    <span class="hljs-string">'selector-disallowed-list'</span>: [
      <span class="hljs-string">'/^\\.el-(?!.*\\.)/'</span>, <span class="hljs-comment">// åŒ¹é…å•ç‹¬çš„ .el-xxx é€‰æ‹©å™¨</span>
      {
        <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·ä½¿ç”¨ç»„åˆé€‰æ‹©å™¨é¿å…å…¨å±€æ±¡æŸ“ï¼Œå¦‚ .my-class.el-dialog'</span>
      }
    ]
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-23">å…­ã€æ€»ç»“</h2>
<h3 data-id="heading-24">6.1 é—®é¢˜æœ¬è´¨</h3>
<p>è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„ <strong>CSS ä½œç”¨åŸŸæ³„æ¼</strong> é—®é¢˜ï¼Œç”±ä»¥ä¸‹å› ç´ å…±åŒå¯¼è‡´ï¼š</p>
<ol>
<li><strong>Teleport æœºåˆ¶</strong> - Dialog DOM è„±ç¦»ç»„ä»¶æ ‘</li>
<li><strong>:global() æ»¥ç”¨</strong> - è·³è¿‡ scoped é™åˆ¶</li>
<li><strong>é€‰æ‹©å™¨ç‰¹å¼‚æ€§ä¸è¶³</strong> - æ²¡æœ‰ä½¿ç”¨ç»„åˆé€‰æ‹©å™¨</li>
<li><strong>æ ·å¼åŠ è½½é¡ºåº</strong> - ååŠ è½½çš„æ ·å¼è¦†ç›–å…ˆåŠ è½½çš„</li>
</ol>
<h3 data-id="heading-25">6.2 æ ¸å¿ƒæ•™è®­</h3>
<ol>
<li><strong>æ°¸è¿œä¸è¦ç›´æ¥ <code>:global(.el-xxx)</code></strong> - å¿…é¡»æ·»åŠ ç‰¹å®šçš„çˆ¶é€‰æ‹©å™¨æˆ–ç»„åˆé€‰æ‹©å™¨</li>
<li><strong>ç»„ä»¶åº“å°è£…è¦æœ‰é˜²å¾¡æ€§</strong> - ä½¿ç”¨ <code>!important</code> é‡ç½®å…³é”®æ ·å¼</li>
<li><strong>ä½¿ç”¨ <code>class</code> è€Œéä»… <code>modal-class</code></strong> - ç¡®ä¿æ ·å¼èƒ½æ­£ç¡®åº”ç”¨</li>
<li><strong>å‘½åè¦æœ‰å”¯ä¸€æ€§</strong> - ä½¿ç”¨ BEM æˆ–é¡µé¢å‰ç¼€é¿å…å†²çª</li>
</ol>
<h3 data-id="heading-26">6.3 æ¨èçš„ Dialog æ ·å¼å®šåˆ¶æ¨¡å¼</h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;el-dialog
    class="feature-name__dialog"
    modal-class="feature-name__overlay"
  &gt;
    ...
  &lt;/el-dialog&gt;
&lt;/template&gt;

&lt;style scoped lang="scss"&gt;
// ä½¿ç”¨ç»„åˆé€‰æ‹©å™¨ï¼Œç¡®ä¿åªå½±å“å½“å‰ç»„ä»¶çš„ dialog
:global(.feature-name__dialog.el-dialog) {
  // è‡ªå®šä¹‰æ ·å¼
}
&lt;/style&gt;
</code></pre>
<hr/>
<h2 data-id="heading-27">ä¸ƒã€ç›¸å…³èµ„æº</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fapi%2Fsfc-css-features.html%23scoped-css" target="_blank" title="https://vuejs.org/api/sfc-css-features.html#scoped-css" ref="nofollow noopener noreferrer">Vue Scoped CSS å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FCSS%2FSpecificity" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/CSS/Specificity" ref="nofollow noopener noreferrer">CSS Specificity MDN</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Felement-plus.org%2Fzh-CN%2Fcomponent%2Fdialog.html" target="_blank" title="https://element-plus.org/zh-CN/component/dialog.html" ref="nofollow noopener noreferrer">Element Plus Dialog æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide%2Fbuilt-ins%2Fteleport.html" target="_blank" title="https://vuejs.org/guide/built-ins/teleport.html" ref="nofollow noopener noreferrer">Vue Teleport æ–‡æ¡£</a></li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3 è°ƒç”¨ Coze å·¥ä½œæµï¼šä»ä¸Šä¼ å® ç‰©ç…§åˆ°ç”Ÿæˆå†°çƒæ˜æ˜Ÿçš„å®Œæ•´æŠ€æœ¯è§£æ]]></title>    <link>https://juejin.cn/post/7587263750250086451</link>    <guid>https://juejin.cn/post/7587263750250086451</guid>    <pubDate>2025-12-25T03:00:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587263750250086451" data-draft-id="7587238733503545387" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3 è°ƒç”¨ Coze å·¥ä½œæµï¼šä»ä¸Šä¼ å® ç‰©ç…§åˆ°ç”Ÿæˆå†°çƒæ˜æ˜Ÿçš„å®Œæ•´æŠ€æœ¯è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,Coze"/> <meta itemprop="datePublished" content="2025-12-25T03:00:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AAAé˜¿giao"/> <meta itemprop="url" content="https://juejin.cn/user/473218785740627"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3 è°ƒç”¨ Coze å·¥ä½œæµï¼šä»ä¸Šä¼ å® ç‰©ç…§åˆ°ç”Ÿæˆå†°çƒæ˜æ˜Ÿçš„å®Œæ•´æŠ€æœ¯è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/473218785740627/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AAAé˜¿giao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T03:00:11.000Z" title="Thu Dec 25 2025 03:00:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Â å¼•è¨€</h2>
<blockquote>
<p><strong>â€œä½ å®¶çš„çŒ«ï¼Œä¹Ÿèƒ½æ‰“å†°çƒï¼Ÿâ€</strong><br/>
ä¸æ˜¯ç©ç¬‘â€”â€”è¿™æ˜¯ä¸€æ¬¡å‰ç«¯ä¸ AI å·¥ä½œæµçš„å®Œç¾é‚‚é€…ã€‚</p>
</blockquote>
<p>åœ¨å½“ä»Š AI åº”ç”¨çˆ†å‘çš„æ—¶ä»£ï¼Œå¼€å‘è€…ä¸å†æ»¡è¶³äºè°ƒç”¨å•ä¸€æ¨¡å‹ APIï¼Œè€Œæ˜¯é€šè¿‡ <strong>å·¥ä½œæµï¼ˆWorkflowï¼‰</strong> ç¼–æ’å¤šä¸ªèƒ½åŠ›èŠ‚ç‚¹ï¼Œå®ç°å¤æ‚ä¸šåŠ¡é€»è¾‘ã€‚è€Œå‰ç«¯ä½œä¸ºç”¨æˆ·äº¤äº’çš„ç¬¬ä¸€çº¿ï¼Œå¦‚ä½•ä¼˜é›…åœ°é›†æˆè¿™äº› AI èƒ½åŠ›ï¼Œæˆä¸ºç°ä»£ Web å¼€å‘çš„é‡è¦è¯¾é¢˜ã€‚</p>
<p>æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥å‰–æä¸€ä¸ªçœŸå®é¡¹ç›®ï¼š<strong>ä½¿ç”¨ Vue3 å‰ç«¯è°ƒç”¨ Coze å¹³å°çš„å·¥ä½œæµ APIï¼Œä¸Šä¼ ä¸€å¼ å® ç‰©ç…§ç‰‡ï¼Œç”Ÿæˆç©¿ç€å®šåˆ¶é˜Ÿæœã€æ‰‹æŒå†°çƒæ†çš„è¿åŠ¨å‘˜å½¢è±¡å›¾</strong>ã€‚æˆ‘ä»¬å°†é€è¡Œè§£è¯» <code>App.vue</code> æºç ï¼Œè§£é‡Šæ¯ä¸€ä¸ª API è°ƒç”¨ã€æ¯ä¸€æ®µé€»è¾‘è®¾è®¡ï¼Œå¹¶ç»“åˆå®Œæ•´çš„ Coze å·¥ä½œæµå›¾è§£ï¼Œè¿˜åŸæ•´ä¸ªæ•°æ®æµè½¬è¿‡ç¨‹ã€‚æ–‡ç« å†…å®¹ä¸¥æ ¼å¼•ç”¨åŸå§‹ä»£ç ï¼ˆä¸€å­—ä¸å˜ï¼‰ï¼Œç¡®ä¿æŠ€æœ¯ç»†èŠ‚ 100% å‡†ç¡®ã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€é¡¹ç›®èƒŒæ™¯ä¸ç›®æ ‡</h2>
<blockquote>
<p>AI åº”ç”¨ä¹‹å†°çƒå‰ç«¯åº”ç”¨ vue3ï¼šå†°çƒåä¼šï¼Œä¸Šä¼ å® ç‰©ç…§ç‰‡ï¼Œç”Ÿæˆè¿åŠ¨å‘˜çš„å½¢è±¡ç…§ç‰‡ã€‚</p>
</blockquote>
<p>è¿™ä¸ªåº”ç”¨çš„æ ¸å¿ƒåŠŸèƒ½éå¸¸æ˜ç¡®ï¼š</p>
<ul>
<li>ç”¨æˆ·ä¸Šä¼ ä¸€å¼ å® ç‰©ï¼ˆæˆ–äººç‰©ï¼‰ç…§ç‰‡ï¼›</li>
<li>é€‰æ‹©å†°çƒé˜Ÿæœç¼–å·ã€é¢œè‰²ã€åœºä¸Šä½ç½®ã€æŒæ†æ‰‹ã€è‰ºæœ¯é£æ ¼ç­‰å‚æ•°ï¼›</li>
<li>ç‚¹å‡»â€œç”Ÿæˆâ€ï¼Œç³»ç»Ÿè°ƒç”¨ AI å·¥ä½œæµï¼›</li>
<li>è¿”å›ä¸€å¼ åˆæˆåçš„â€œå†°çƒè¿åŠ¨å‘˜â€å›¾åƒã€‚</li>
</ul>
<p>è€Œè¿™ä¸€åˆ‡çš„å®ç°ï¼Œå®Œå…¨ä¾èµ–äº <strong>Coze å¹³å°æä¾›çš„å·¥ä½œæµ API</strong>ã€‚å‰ç«¯è´Ÿè´£æ”¶é›†è¾“å…¥ã€ä¸Šä¼ æ–‡ä»¶ã€å‘èµ·è¯·æ±‚ã€å±•ç¤ºç»“æœâ€”â€”å…¸å‹çš„â€œè½»å‰ç«¯ + é‡ AI åç«¯â€æ¶æ„ã€‚</p>
<hr/>
<h2 data-id="heading-2">äºŒã€App.vue æ•´ä½“ç»“æ„æ¦‚è§ˆ</h2>
<p><code>App.vue</code> æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Vue3 å•æ–‡ä»¶ç»„ä»¶ï¼ˆSFCï¼‰ï¼Œé‡‡ç”¨ <code>&lt;script setup&gt;</code> è¯­æ³•ç³–ï¼Œç»“åˆ Composition API å®ç°å“åº”å¼é€»è¾‘ã€‚æ•´ä½“åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š</p>
<ol>
<li><strong><code>&lt;template&gt;</code></strong> ï¼šç”¨æˆ·ç•Œé¢ï¼ˆUIï¼‰</li>
<li><strong><code>&lt;script setup&gt;</code></strong> ï¼šä¸šåŠ¡é€»è¾‘ï¼ˆJSï¼‰</li>
<li><strong><code>&lt;style scoped&gt;</code></strong> ï¼šæ ·å¼ï¼ˆCSSï¼‰</li>
</ol>
<p>æˆ‘ä»¬å…ˆä»æ¨¡æ¿å…¥æ‰‹ï¼Œç†è§£ç”¨æˆ·çœ‹åˆ°ä»€ä¹ˆã€èƒ½åšä»€ä¹ˆã€‚</p>
<hr/>
<h2 data-id="heading-3">ä¸‰ã€æ¨¡æ¿ï¼ˆTemplateï¼‰è¯¦è§£ï¼šç”¨æˆ·äº¤äº’å±‚</h2>
<h3 data-id="heading-4">3.1 æ–‡ä»¶ä¸Šä¼ ä¸é¢„è§ˆ</h3>
<pre><code class="hljs language-ini" lang="ini">&lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"file-input"</span>&gt;
  &lt;input 
    <span class="hljs-attr">type</span>=<span class="hljs-string">"file"</span> 
    <span class="hljs-attr">ref</span>=<span class="hljs-string">"uploadImage"</span> 
    <span class="hljs-attr">accept</span>=<span class="hljs-string">"image/*"</span> 
    @<span class="hljs-attr">change</span>=<span class="hljs-string">"updateImageData"</span> required /&gt;
&lt;/div&gt;
&lt;img :<span class="hljs-attr">src</span>=<span class="hljs-string">"imgPreview"</span> alt=<span class="hljs-string">""</span> v-if=<span class="hljs-string">"imgPreview"</span>/&gt;
</code></pre>
<ul>
<li><code>&lt;input type="file"&gt;</code>ï¼šåŸç”Ÿæ–‡ä»¶é€‰æ‹©å™¨ï¼Œé™åˆ¶åªæ¥å—å›¾ç‰‡ï¼ˆ<code>accept="image/*"</code>ï¼‰ã€‚</li>
<li><code>ref="uploadImage"</code>ï¼šé€šè¿‡ <code>ref</code> è·å–è¯¥ DOM å…ƒç´ ï¼Œä¾¿äº JS ä¸­è¯»å–æ–‡ä»¶ã€‚</li>
<li><code>@change="updateImageData"</code>ï¼šå½“ç”¨æˆ·é€‰æ‹©æ–‡ä»¶åï¼Œç«‹å³è§¦å‘ <code>updateImageData</code> æ–¹æ³•ï¼Œç”Ÿæˆæœ¬åœ°é¢„è§ˆã€‚</li>
<li><code>imgPreview</code> æ˜¯ä¸€ä¸ªå“åº”å¼å˜é‡ï¼Œç”¨äºæ˜¾ç¤º Data URL æ ¼å¼çš„é¢„è§ˆå›¾ï¼Œæ— éœ€ä¸Šä¼ å³å¯çœ‹åˆ°æ•ˆæœã€‚</li>
</ul>
<blockquote>
<p>âœ… <strong>ç”¨æˆ·ä½“éªŒäº®ç‚¹</strong>ï¼šå³ä½¿å›¾ç‰‡å¾ˆå¤§ã€ä¸Šä¼ å¾ˆæ…¢ï¼Œç”¨æˆ·ä¹Ÿèƒ½ç«‹åˆ»ç¡®è®¤è‡ªå·±é€‰å¯¹äº†å›¾ã€‚</p>
</blockquote>
<h3 data-id="heading-5">3.2 è¡¨å•å‚æ•°è®¾ç½®</h3>
<p>æ¥ä¸‹æ¥æ˜¯ä¸¤ç»„è®¾ç½®é¡¹ï¼Œå…¨éƒ¨ä½¿ç”¨ <code>v-model</code> åŒå‘ç»‘å®šï¼š</p>
<h4 data-id="heading-6">ç¬¬ä¸€ç»„ï¼šé˜Ÿæœä¿¡æ¯</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"settings"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"selection"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>é˜Ÿæœç¼–å·:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"uniform_number"</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"selection"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>é˜Ÿæœé¢œè‰²:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"uniform_color"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"çº¢"</span>&gt;</span>çº¢<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"è“"</span>&gt;</span>è“<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"ç»¿"</span>&gt;</span>ç»¿<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"ç™½"</span>&gt;</span>ç™½<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"é»‘"</span>&gt;</span>é»‘<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<ul>
<li><code>uniform_number</code>ï¼šé»˜è®¤å€¼ä¸º <code>10</code>ï¼ˆè§ script éƒ¨åˆ†ï¼‰ï¼Œæ”¯æŒä»»æ„æ•°å­—ã€‚</li>
<li><code>uniform_color</code>ï¼šé™å®šäº”ç§é¢œè‰²ï¼Œå€¼ä¸ºä¸­æ–‡å­—ç¬¦ä¸²ï¼ˆå¦‚ <code>"çº¢"</code>ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-7">ç¬¬äºŒç»„ï¼šè§’è‰²ä¸é£æ ¼</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"settings"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"selection"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>ä½ç½®ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"position"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"0"</span>&gt;</span>å®ˆé—¨å‘˜<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"1"</span>&gt;</span>å‰é”‹<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"2"</span>&gt;</span>åå«<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"selection"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>æŒæ†ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"shooting_hand"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"0"</span>&gt;</span>å·¦æ‰‹<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"1"</span>&gt;</span>å³æ‰‹<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"selection"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>é£æ ¼ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"style"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"å†™å®"</span>&gt;</span>å†™å®<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"ä¹é«˜"</span>&gt;</span>ä¹é«˜<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"å›½æ¼«"</span>&gt;</span>å›½æ¼«<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"æ—¥æ¼«"</span>&gt;</span>æ—¥æ¼«<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"æ²¹ç”»"</span>&gt;</span>æ²¹ç”»<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"æ¶‚é¸¦"</span>&gt;</span>æ¶‚é¸¦<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"ç´ æ"</span>&gt;</span>ç´ æ<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<ul>
<li><code>position</code> å’Œ <code>shooting_hand</code> çš„å€¼è™½ç„¶æ˜¯æ•°å­—å­—ç¬¦ä¸²ï¼ˆ<code>"0"</code>/<code>"1"</code>/<code>"2"</code>ï¼‰ï¼Œä½†å‰ç«¯æ˜¾ç¤ºä¸ºä¸­æ–‡ï¼Œå…¼é¡¾å¯è¯»æ€§ä¸åç«¯å…¼å®¹æ€§ã€‚</li>
<li><code>style</code> æä¾› 7 ç§è‰ºæœ¯é£æ ¼ï¼Œæå¤§å¢å¼ºè¶£å‘³æ€§å’Œåˆ†äº«æ¬²ã€‚</li>
</ul>
<h3 data-id="heading-8">3.3 ç”ŸæˆæŒ‰é’®ä¸è¾“å‡ºåŒºåŸŸ</h3>
<pre><code class="hljs language-ini" lang="ini">&lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"generate"</span>&gt;
  &lt;button @<span class="hljs-attr">click</span>=<span class="hljs-string">"generate"</span>&gt;ç”Ÿæˆ&lt;/button&gt;
&lt;/div&gt;
</code></pre>
<p>ç‚¹å‡»åè§¦å‘ <code>generate()</code> å‡½æ•°ï¼Œå¯åŠ¨æ•´ä¸ª AI ç”Ÿæˆæµç¨‹ã€‚</p>
<p>è¾“å‡ºåŒºåŸŸï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"output"</span>&gt;
  &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"generated"</span>&gt;
    &lt;img :<span class="hljs-attr">src</span>=<span class="hljs-string">"imgUrl"</span> alt=<span class="hljs-string">""</span> v-if=<span class="hljs-string">"imgUrl"</span>/&gt;
    &lt;div <span class="hljs-attr">v-if</span>=<span class="hljs-string">"status"</span>&gt;{{ status }}&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre>
<ul>
<li><code>imgUrl</code>ï¼šå­˜å‚¨ Coze è¿”å›çš„ç”Ÿæˆå›¾ URLã€‚</li>
<li><code>status</code>ï¼šåŠ¨æ€æ˜¾ç¤ºå½“å‰çŠ¶æ€ï¼ˆå¦‚â€œä¸Šä¼ ä¸­â€¦â€ã€â€œç”Ÿæˆå¤±è´¥â€ç­‰ï¼‰ï¼Œé¿å…ç”¨æˆ·ç„¦è™‘ã€‚</li>
</ul>
<blockquote>
<p>ğŸ’¡ <strong>è®¾è®¡å“²å­¦</strong>ï¼šçŠ¶æ€åé¦ˆæ˜¯è‰¯å¥½ UX çš„æ ¸å¿ƒã€‚æ²¡æœ‰åé¦ˆçš„â€œç”Ÿæˆâ€æŒ‰é’®ï¼Œç­‰äºé»‘ç›’ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-9">å››ã€è„šæœ¬é€»è¾‘ï¼ˆScript Setupï¼‰æ·±åº¦è§£æ</h2>
<p>ç°åœ¨è¿›å…¥æœ€æ ¸å¿ƒçš„éƒ¨åˆ†â€”â€”JavaScript é€»è¾‘ã€‚</p>
<h3 data-id="heading-10">4.1 ç¯å¢ƒé…ç½®ä¸å¸¸é‡å®šä¹‰</h3>
<pre><code class="hljs language-ini" lang="ini">import { ref, onMounted } from 'vue'

const <span class="hljs-attr">patToken</span> = import.meta.env.VITE_PAT_TOKEN<span class="hljs-comment">;</span>
const <span class="hljs-attr">uploadUrl</span> = <span class="hljs-string">'https://api.coze.cn/v1/files/upload'</span><span class="hljs-comment">;</span>
const <span class="hljs-attr">workflowUrl</span> = <span class="hljs-string">'https://api.coze.cn/v1/workflow/run'</span><span class="hljs-comment">;</span>
const <span class="hljs-attr">workflow_id</span> = <span class="hljs-string">'7584046136391630898'</span><span class="hljs-comment">;</span>
</code></pre>
<ul>
<li>
<p><code>import.meta.env.VITE_PAT_TOKEN</code>ï¼šVite æä¾›çš„ç¯å¢ƒå˜é‡æ³¨å…¥æœºåˆ¶ã€‚<code>.env</code> æ–‡ä»¶ä¸­åº”åŒ…å«ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">VITE_PAT_TOKEN</span>=cztei_lvNwngHgch9rxNlx4KiXuky3UjfW9iqCZRe17KDXjh22RLL8sPLsb8Vl10R3IHJsW
</code></pre>
</li>
<li>
<p><code>uploadUrl</code>ï¼šCoze å®˜æ–¹æ–‡ä»¶ä¸Šä¼ æ¥å£ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.coze.com%2Freference%2Fupload_file" title="https://docs.coze.com/reference/upload_file" target="_blank" ref="nofollow noopener noreferrer">æ–‡æ¡£</a>ï¼‰ã€‚</p>
</li>
<li>
<p><code>workflowUrl</code>ï¼šè§¦å‘å·¥ä½œæµçš„å…¥å£ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.coze.com%2Freference%2Frun_workflow" title="https://docs.coze.com/reference/run_workflow" target="_blank" ref="nofollow noopener noreferrer">æ–‡æ¡£</a>ï¼‰ã€‚</p>
</li>
<li>
<p><code>workflow_id</code>ï¼šåœ¨ Coze æ§åˆ¶å°åˆ›å»ºçš„å·¥ä½œæµå”¯ä¸€ IDï¼Œå†…éƒ¨å·²é…ç½®å¥½å›¾åƒç”Ÿæˆé€»è¾‘ï¼ˆå¦‚è°ƒç”¨æ–‡ç”Ÿå›¾æ¨¡å‹ã€å åŠ é˜Ÿæœç­‰ï¼‰ã€‚</p>
</li>
</ul>
<blockquote>
<p>âš ï¸ <strong>å®‰å…¨è­¦å‘Š</strong>ï¼šå°† PAT Token æ”¾åœ¨å‰ç«¯ä»…é€‚ç”¨äºæ¼”ç¤ºæˆ–å†…éƒ¨å·¥å…·ã€‚ç”Ÿäº§ç¯å¢ƒåº”é€šè¿‡åç«¯ä»£ç† APIï¼Œé¿å… Token æ³„éœ²ã€‚</p>
</blockquote>
<h3 data-id="heading-11">4.2 å“åº”å¼çŠ¶æ€å£°æ˜</h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">uniform_number</span> = ref(<span class="hljs-number">10</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">uniform_color</span> = ref(<span class="hljs-string">'çº¢'</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">position</span> = ref(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">shooting_hand</span> = ref(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">style</span> = ref(<span class="hljs-string">'å†™å®'</span>)<span class="hljs-comment">;</span>

const <span class="hljs-attr">status</span> = ref(<span class="hljs-string">''</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">imageUrl</span> = ref(<span class="hljs-string">''</span>)<span class="hljs-comment">;</span>
</code></pre>
<ul>
<li>æ‰€æœ‰è¡¨å•å­—æ®µå‡ä¸º <code>ref</code> å“åº”å¼å¯¹è±¡ï¼Œç¡®ä¿è§†å›¾è‡ªåŠ¨æ›´æ–°ã€‚</li>
<li><code>status</code> åˆå§‹ä¸ºç©ºï¼Œåç»­å°†æ˜¾ç¤ºï¼šâ€œå›¾ç‰‡ä¸Šä¼ ä¸­...â€ â†’ â€œå›¾ç‰‡ä¸Šä¼ æˆåŠŸ, æ­£åœ¨ç”Ÿæˆ...â€ â†’ æˆåŠŸæ¸…ç©º æˆ– é”™è¯¯ä¿¡æ¯ã€‚</li>
<li><code>imageUrl</code> åˆå§‹ä¸ºç©ºï¼Œç”ŸæˆæˆåŠŸåèµ‹å€¼ä¸ºå›¾ç‰‡ URLã€‚</li>
</ul>
<h3 data-id="heading-12">4.3 æ ¸å¿ƒå‡½æ•° 1ï¼šå›¾ç‰‡é¢„è§ˆï¼ˆupdateImageDataï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">uploadImage</span> = ref(null)<span class="hljs-comment">;</span>
const <span class="hljs-attr">imgPreview</span> = ref(<span class="hljs-string">''</span>)<span class="hljs-comment">;</span>

const <span class="hljs-attr">updateImageData</span> = () =&gt; {
  const <span class="hljs-attr">input</span> = uploadImage.value<span class="hljs-comment">;</span>
  if (!input.files || <span class="hljs-attr">input.files.length</span> === <span class="hljs-number">0</span>) {
    return<span class="hljs-comment">;</span>
  }
  const <span class="hljs-attr">file</span> = input.files[<span class="hljs-number">0</span>]<span class="hljs-comment">;</span>
  const <span class="hljs-attr">reader</span> = new FileReader()<span class="hljs-comment">;</span>
  reader.readAsDataURL(file)<span class="hljs-comment">;</span>
  <span class="hljs-attr">reader.onload</span> = (e) =&gt; {
    <span class="hljs-attr">imgPreview.value</span> = e.target.result<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
}
</code></pre>
<ul>
<li><code>uploadImage</code> æ˜¯å¯¹ <code>&lt;input&gt;</code> å…ƒç´ çš„å¼•ç”¨ã€‚</li>
<li>ä½¿ç”¨ <code>FileReader</code> çš„ <code>readAsDataURL</code> æ–¹æ³•ï¼Œå°†æ–‡ä»¶è½¬ä¸º Base64 ç¼–ç çš„ Data URLã€‚</li>
<li><code>onload</code> å›è°ƒä¸­ï¼Œå°†ç»“æœèµ‹ç»™ <code>imgPreview</code>ï¼Œè§¦å‘ <code>&lt;img&gt;</code> æ ‡ç­¾æ¸²æŸ“ã€‚</li>
</ul>
<blockquote>
<p>âœ… <strong>ä¼˜åŠ¿</strong>ï¼šçº¯å‰ç«¯å®ç°ï¼Œé›¶ç½‘ç»œè¯·æ±‚ï¼Œç§’çº§å“åº”ã€‚</p>
</blockquote>
<h3 data-id="heading-13">4.4 æ ¸å¿ƒå‡½æ•° 2ï¼šæ–‡ä»¶ä¸Šä¼ ï¼ˆuploadFileï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">uploadFile</span> = async () =&gt; {
  const <span class="hljs-attr">formData</span> = new FormData()<span class="hljs-comment">;</span>
  const <span class="hljs-attr">input</span> = uploadImage.value<span class="hljs-comment">;</span>
  if (!input.files || input.files.length &lt;= 0) return<span class="hljs-comment">;</span>
  formData.append('file', input.files<span class="hljs-section">[0]</span>)<span class="hljs-comment">;</span>

  const <span class="hljs-attr">res</span> = await fetch(uploadUrl, {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${patToken}`
    },
    body: formData
  })<span class="hljs-comment">;</span>

  const <span class="hljs-attr">ret</span> = await res.json()<span class="hljs-comment">;</span>
  console.log(ret)<span class="hljs-comment">;</span>
  if (ret.code !== 0) {
    <span class="hljs-attr">status.value</span> = ret.msg<span class="hljs-comment">;</span>
    return<span class="hljs-comment">;</span>
  }
  return ret.data.id<span class="hljs-comment">;</span>
}
</code></pre>
<h4 data-id="heading-14">é€è¡Œè§£æï¼š</h4>
<ol>
<li>
<p><strong>æ„é€  FormData</strong>ï¼š</p>
<ul>
<li><code>new FormData()</code> æ˜¯æµè§ˆå™¨åŸç”Ÿ APIï¼Œç”¨äºæ„å»º multipart/form-data è¯·æ±‚ä½“ï¼Œä¸“ä¸ºæ–‡ä»¶ä¸Šä¼ è®¾è®¡ã€‚</li>
<li><code>formData.append('file', file)</code>ï¼šCoze è¦æ±‚å­—æ®µåä¸º <code>file</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‘é€ POST è¯·æ±‚</strong>ï¼š</p>
<ul>
<li>
<p>URLï¼š<code>https://api.coze.cn/v1/files/upload</code></p>
</li>
<li>
<p>Headersï¼š</p>
<ul>
<li><code>Authorization: Bearer &lt;token&gt;</code>ï¼šCoze ä½¿ç”¨ Bearer Token è®¤è¯ã€‚</li>
</ul>
</li>
<li>
<p>Bodyï¼š<code>formData</code> è‡ªåŠ¨è®¾ç½®æ­£ç¡® Content-Typeï¼ˆå« boundaryï¼‰ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>å¤„ç†å“åº”</strong>ï¼š</p>
<ul>
<li>
<p>æˆåŠŸæ—¶è¿”å›ï¼š</p>
<pre><code class="hljs language-css" lang="css">{ "<span class="hljs-selector-tag">code</span>": <span class="hljs-number">0</span>, <span class="hljs-string">"msg"</span>: <span class="hljs-string">"success"</span>, <span class="hljs-string">"data"</span>: { "id": <span class="hljs-string">"file_xxx"</span>, ... } }
</code></pre>
</li>
<li>
<p>å¤±è´¥æ—¶ <code>code !== 0</code>ï¼Œ<code>msg</code> åŒ…å«é”™è¯¯åŸå› ï¼ˆå¦‚ Token æ— æ•ˆã€æ–‡ä»¶è¿‡å¤§ç­‰ï¼‰ã€‚</p>
</li>
<li>
<p>å‡½æ•°è¿”å› <code>file_id</code>ï¼ˆå¦‚ <code>"file_abc123"</code>ï¼‰ï¼Œä¾›ä¸‹ä¸€æ­¥ä½¿ç”¨ã€‚</p>
</li>
</ul>
</li>
</ol>
<blockquote>
<p><strong>å…³é”®ç‚¹</strong>ï¼šCoze çš„æ–‡ä»¶ä¸Šä¼ æ˜¯ç‹¬ç«‹æ­¥éª¤ï¼Œå¿…é¡»å…ˆä¸Šä¼ è·å– <code>file_id</code>ï¼Œæ‰èƒ½åœ¨å·¥ä½œæµä¸­å¼•ç”¨ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-15">äº”ã€æ ¸å¿ƒå‡½æ•° 3ï¼šè°ƒç”¨å·¥ä½œæµï¼ˆgenerateï¼‰</h2>
<p>è¿™æ˜¯æ•´ä¸ªåº”ç”¨çš„â€œå¤§è„‘â€ã€‚æˆ‘ä»¬ç»“åˆ Coze å·¥ä½œæµå›¾ï¼Œæ·±å…¥åˆ†æå…¶é€»è¾‘ä¸æ•°æ®æµã€‚</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">generate</span> = async () =&gt; {
  <span class="hljs-attr">status.value</span> = <span class="hljs-string">"å›¾ç‰‡ä¸Šä¼ ä¸­..."</span><span class="hljs-comment">;</span>
  const <span class="hljs-attr">file_id</span> = await uploadFile()<span class="hljs-comment">;</span>
  if (!file_id) return<span class="hljs-comment">;</span>

  <span class="hljs-attr">status.value</span> = <span class="hljs-string">"å›¾ç‰‡ä¸Šä¼ æˆåŠŸ, æ­£åœ¨ç”Ÿæˆ..."</span><span class="hljs-comment">;</span>

  const <span class="hljs-attr">parameters</span> = {
    picture: JSON.stringify({ file_id }),
    style: style.value,
    uniform_color: uniform_color.value,
    uniform_number: uniform_number.value,
    position: position.value,
    shooting_hand: shooting_hand.value,
  }<span class="hljs-comment">;</span>

  try {
    const <span class="hljs-attr">res</span> = await fetch(workflowUrl, {
      method: 'POST',
      headers: {
        Authorization: `Bearer ${patToken}`,
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ workflow_id, parameters })
    })<span class="hljs-comment">;</span>

    const <span class="hljs-attr">ret</span> = await res.json()<span class="hljs-comment">;</span>
    console.log("Workflow API response:", ret)<span class="hljs-comment">;</span>
    if (ret.code !== 0) {
      <span class="hljs-attr">status.value</span> = ret.msg<span class="hljs-comment">;</span>
      return<span class="hljs-comment">;</span>
    }

    // æ£€æŸ¥è¿”å›æ•°æ®ç»“æ„
    console.log("Return data:", ret.data)<span class="hljs-comment">;</span>
    console.log("Return data type:", typeof ret.data)<span class="hljs-comment">;</span>

    // å°è¯•è§£ææ•°æ®
    let data<span class="hljs-comment">;</span>
    if (typeof <span class="hljs-attr">ret.data</span> === <span class="hljs-string">'string'</span>) {
      try {
        <span class="hljs-attr">data</span> = JSON.parse(ret.data)<span class="hljs-comment">;</span>
        console.log("Parsed data:", data)<span class="hljs-comment">;</span>
      } catch (e) {
        console.error("JSON parse error:", e)<span class="hljs-comment">;</span>
        <span class="hljs-attr">status.value</span> = <span class="hljs-string">"æ•°æ®è§£æé”™è¯¯"</span><span class="hljs-comment">;</span>
        return<span class="hljs-comment">;</span>
      }
    } else {
      <span class="hljs-attr">data</span> = ret.data<span class="hljs-comment">;</span>
    }

    // æ£€æŸ¥data.dataæ˜¯å¦å­˜åœ¨
    if (data &amp;&amp; data.data) {
      console.log("Generated image URL:", data.data)<span class="hljs-comment">;</span>
      <span class="hljs-attr">status.value</span> = <span class="hljs-string">''</span><span class="hljs-comment">;</span>
      <span class="hljs-attr">imageUrl.value</span> = data.data<span class="hljs-comment">;</span>
    } else {
      console.error("Invalid data structure, missing 'data' field:", data)<span class="hljs-comment">;</span>
      <span class="hljs-attr">status.value</span> = <span class="hljs-string">"è¿”å›æ•°æ®ç»“æ„é”™è¯¯"</span><span class="hljs-comment">;</span>
    }
  } catch (error) {
    console.error("Generate error:", error)<span class="hljs-comment">;</span>
    <span class="hljs-attr">status.value</span> = <span class="hljs-string">"ç”Ÿæˆå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥"</span><span class="hljs-comment">;</span>
  }
}
</code></pre>
<h3 data-id="heading-16">é€»è¾‘æ‹†è§£ï¼ˆç»“åˆ Coze å·¥ä½œæµå›¾ï¼‰</h3>
<h4 data-id="heading-17">Coze å·¥ä½œæµç»“æ„ï¼ˆå›¾è§£è¯´æ˜ï¼‰</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df867d224be54ad6abb69d515547f3d5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUFB6Zi_Z2lhbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236411&amp;x-signature=w82B316O2BMsmkUpKIegCC%2BsVOY%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<blockquote>
<p><strong>å›¾æ³¨</strong>ï¼š</p>
<ol>
<li><strong>å¼€å§‹èŠ‚ç‚¹</strong>ï¼šæ¥æ”¶ <code>picture</code>, <code>style</code>, <code>uniform_number</code>, <code>position</code>, <code>shooting_hand</code>, <code>uniform_color</code> ç­‰å‚æ•°ã€‚</li>
<li><strong>åˆ†æ”¯ä¸€</strong>ï¼š<code>imgUnderstand_1</code>ï¼ˆå›¾åƒç†è§£ï¼‰â†’ åˆ†æä¸Šä¼ å›¾ç‰‡å†…å®¹ï¼ˆå¦‚åŠ¨ç‰©ç§ç±»ã€å§¿æ€ï¼‰ã€‚</li>
<li><strong>åˆ†æ”¯äºŒ</strong>ï¼š<code>ä»£ç </code> èŠ‚ç‚¹ â†’ æ ¹æ® <code>position</code>, <code>shooting_hand</code>, <code>style</code> ç­‰ç”Ÿæˆæè¿°æ–‡æœ¬ï¼ˆå¦‚â€œä¸€åªç‹—ï¼Œå³æ‰‹æŒæ†ï¼Œèº«ç©¿çº¢è‰²10å·é˜Ÿæœï¼Œç«™åœ¨å†°çƒåœºä¸Šâ€ï¼‰ã€‚</li>
<li><strong>å¤§æ¨¡å‹èŠ‚ç‚¹</strong>ï¼šå°†å›¾åƒç†è§£ç»“æœä¸æè¿°æ–‡æœ¬åˆå¹¶ï¼Œç”Ÿæˆæœ€ç»ˆæç¤ºè¯ï¼ˆpromptï¼‰ã€‚</li>
<li><strong>å›¾åƒç”ŸæˆèŠ‚ç‚¹</strong>ï¼šè°ƒç”¨æ–‡ç”Ÿå›¾æ¨¡å‹ï¼ˆå¦‚è±†åŒ…Â·1.5Â·ProÂ·32kï¼‰ï¼Œç”Ÿæˆæ–°å›¾åƒã€‚</li>
<li><strong>ç»“æŸèŠ‚ç‚¹</strong>ï¼šè¾“å‡ºç”Ÿæˆå›¾çš„ URLã€‚</li>
</ol>
</blockquote>
<hr/>
<h4 data-id="heading-18">å‰ç«¯ä»£ç çš„å¯¹åº”å…³ç³»</h4>








































<table><thead><tr><th>å‰ç«¯å‚æ•°</th><th>Coze è¾“å…¥å­—æ®µ</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td><code>picture</code></td><td><code>picture</code></td><td>å›¾ç‰‡æ–‡ä»¶ IDï¼Œä¼ å…¥ <code>imgUnderstand_1</code> å’Œ <code>å›¾åƒç”Ÿæˆ</code> èŠ‚ç‚¹</td></tr><tr><td><code>style</code></td><td><code>style</code></td><td>ä¼ é€’ç»™ <code>ä»£ç </code> èŠ‚ç‚¹ï¼Œå†³å®šè‰ºæœ¯é£æ ¼</td></tr><tr><td><code>uniform_number</code></td><td><code>uniform_number</code></td><td>ç”¨äºç”Ÿæˆæè¿°</td></tr><tr><td><code>position</code></td><td><code>position</code></td><td>å†³å®šè§’è‰²åŠ¨ä½œï¼ˆå¦‚å®ˆé—¨å‘˜è¹²å§¿ï¼‰</td></tr><tr><td><code>shooting_hand</code></td><td><code>shooting_hand</code></td><td>å†³å®šæŒæ†æ‰‹</td></tr><tr><td><code>uniform_color</code></td><td><code>uniform_color</code></td><td>ç”¨äºç”Ÿæˆé˜Ÿæœé¢œè‰²</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ <strong>å…³é”®ç‚¹</strong>ï¼šå‰ç«¯åªéœ€æä¾›åŸå§‹å‚æ•°ï¼ŒCoze å·¥ä½œæµå†…éƒ¨å®Œæˆæ‰€æœ‰é€»è¾‘ç¼–æ’ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-19">æ•°æ®æµå…¨è¿‡ç¨‹</h3>
<ol>
<li>
<p><strong>å‰ç«¯ä¸Šä¼ æ–‡ä»¶</strong> â†’ å¾—åˆ° <code>file_id</code></p>
</li>
<li>
<p><strong>å‰ç«¯ç»„è£…å‚æ•°</strong> â†’ å‘é€è‡³ <code>/workflow/run</code></p>
</li>
<li>
<p><strong>Coze å·¥ä½œæµæ‰§è¡Œ</strong>ï¼š</p>
<ul>
<li><code>imgUnderstand_1</code>ï¼šåˆ†æå›¾ç‰‡å†…å®¹ â†’ è¾“å‡º <code>text</code>, <code>url</code>, <code>content</code></li>
<li><code>ä»£ç </code> èŠ‚ç‚¹ï¼šæ ¹æ®å‚æ•°ç”Ÿæˆæè¿° â†’ å¦‚ <code>"ä¸€åªçŒ«ï¼Œèº«ç©¿è“è‰²10å·é˜Ÿæœï¼Œå³æ‰‹æŒæ†ï¼Œç«™åœ¨å†°çƒåœºä¸Šï¼Œé£æ ¼ä¸ºä¹é«˜"</code></li>
<li><code>å¤§æ¨¡å‹</code> èŠ‚ç‚¹ï¼šåˆå¹¶å›¾åƒç†è§£ç»“æœä¸æè¿° â†’ ç”Ÿæˆæœ€ç»ˆ prompt</li>
<li><code>å›¾åƒç”Ÿæˆ</code> èŠ‚ç‚¹ï¼šè°ƒç”¨æ¨¡å‹ç”Ÿæˆå›¾åƒ â†’ è¿”å› <code>data</code> å­—æ®µï¼ˆURLï¼‰</li>
</ul>
</li>
<li>
<p><strong>å‰ç«¯æ¥æ”¶å“åº”</strong>ï¼š</p>
<ul>
<li>è‹¥ <code>ret.data</code> æ˜¯å­—ç¬¦ä¸² â†’ å°è¯• <code>JSON.parse</code></li>
<li>è‹¥æ˜¯å¯¹è±¡ â†’ ç›´æ¥å– <code>data.data</code></li>
<li>æœ€ç»ˆèµ‹å€¼ç»™ <code>imageUrl</code></li>
</ul>
</li>
</ol>
<blockquote>
<p>âœ… <strong>ä¸ºä»€ä¹ˆéœ€è¦åŒé‡è§£æï¼Ÿ</strong><br/>
å› ä¸º Coze çš„â€œå›¾åƒç”Ÿæˆâ€èŠ‚ç‚¹å¯èƒ½ç›´æ¥è¿”å› URL å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯èƒ½è¿”å› <code>{ data: "url" }</code> ç»“æ„ã€‚å‰ç«¯å¿…é¡»å…¼å®¹ä¸¤ç§æƒ…å†µã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-20">å…­ã€æ ·å¼ï¼ˆStyleï¼‰ç®€æ</h2>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.container</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">flex-direction</span>: row;
  <span class="hljs-attribute">align-items</span>: start;
  <span class="hljs-attribute">justify-content</span>: start;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>;
  <span class="hljs-attribute">font-size</span>: .<span class="hljs-number">85rem</span>;
}
<span class="hljs-selector-class">.generated</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">400px</span>;
  <span class="hljs-attribute">border</span>: solid <span class="hljs-number">1px</span> black;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">justify-content</span>: center;
  <span class="hljs-attribute">align-items</span>: center;
}
<span class="hljs-selector-class">.output</span> <span class="hljs-selector-tag">img</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<ul>
<li>ä½¿ç”¨ Flex å¸ƒå±€ï¼Œå·¦å³åˆ†æ ï¼ˆè¾“å…¥åŒºå›ºå®šå®½åº¦ï¼Œè¾“å‡ºåŒºè‡ªé€‚åº”ï¼‰ã€‚</li>
<li><code>.generated</code> å®¹å™¨å›ºå®š 400x400ï¼Œå›¾ç‰‡å±…ä¸­æ˜¾ç¤ºï¼Œæ— è®ºåŸå§‹æ¯”ä¾‹å¦‚ä½•éƒ½ä¸å˜å½¢ã€‚</li>
<li><code>scoped</code> ç¡®ä¿æ ·å¼ä»…ä½œç”¨äºå½“å‰ç»„ä»¶ï¼Œé¿å…æ±¡æŸ“å…¨å±€ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-21">ä¸ƒã€é¡¹ç›®è¿è¡Œ</h2>
<p>åœ¨é¡¹ç›®ç»ˆç«¯è¿è¡Œå‘½ä»¤ ï¼šnpm run dev</p>
<p>è¿è¡Œç•Œé¢å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c0b4ffcc9074875ac79d19c6dd039b5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUFB6Zi_Z2lhbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236411&amp;x-signature=0TGAd4aYtt0gXusNweelNBbN%2BUM%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>é€‰æ‹©å›¾ç‰‡åŠé£æ ¼ç­‰å†…å®¹åï¼Œç‚¹å‡»å¼€å§‹ç”Ÿæˆï¼Œè¿è¡Œç»“æœå¦‚å›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ae9a4d82c5964599b8b4c648a2a02684~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUFB6Zi_Z2lhbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236411&amp;x-signature=kyiJS9z4Mjupkb9D9Ov3fs%2BNkj8%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-22">æ€»ç»“ï¼šä¸ºä»€ä¹ˆè¿™ä¸ªé¡¹ç›®å€¼å¾—å­¦ä¹ ï¼Ÿ</h2>
<ol>
<li>
<p><strong>çœŸå®åœºæ™¯</strong>ï¼šä¸æ˜¯ Hello Worldï¼Œè€Œæ˜¯å®Œæ•´äº§å“é€»è¾‘ã€‚</p>
</li>
<li>
<p><strong>æŠ€æœ¯å…¨é¢</strong>ï¼š</p>
<ul>
<li>Vue3 Composition API</li>
<li>æ–‡ä»¶ä¸Šä¼ ä¸é¢„è§ˆ</li>
<li>Fetch API ä¸é”™è¯¯å¤„ç†</li>
<li>ç¯å¢ƒå˜é‡ç®¡ç†</li>
<li>å“åº”å¼çŠ¶æ€é©±åŠ¨ UI</li>
</ul>
</li>
<li>
<p><strong>AI é›†æˆèŒƒå¼</strong>ï¼šå±•ç¤ºäº†å¦‚ä½•å°†å¤æ‚ AI èƒ½åŠ›å°è£…ä¸ºç®€å• APIï¼Œå‰ç«¯åªéœ€â€œå¡«å‚æ•° + æ‹¿ç»“æœâ€ã€‚</p>
</li>
<li>
<p><strong>ç”¨æˆ·ä½“éªŒä¼˜å…ˆ</strong>ï¼šçŠ¶æ€æç¤ºã€æœ¬åœ°é¢„è§ˆã€é”™è¯¯åé¦ˆä¸€åº”ä¿±å…¨ã€‚</p>
</li>
</ol>
<p><strong>å®‰å…¨ä¸éƒ¨ç½²å»ºè®®</strong>ï¼š</p>
<ul>
<li>
<p><strong>åç«¯ä»£ç†æ‰€æœ‰ Coze API è°ƒç”¨</strong>ï¼š</p>
<ul>
<li>å‰ç«¯ â†’ è‡ªå·±çš„åç«¯ï¼ˆ/api/generateï¼‰</li>
<li>åç«¯ â†’ Cozeï¼ˆæºå¸¦å®‰å…¨å­˜å‚¨çš„ Tokenï¼‰</li>
</ul>
</li>
<li>
<p><strong>é™åˆ¶å·¥ä½œæµæƒé™</strong>ï¼šCoze çš„ PAT Token åº”ä»…æˆäºˆå¿…è¦æƒé™ã€‚</p>
</li>
<li>
<p><strong>æ·»åŠ é€Ÿç‡é™åˆ¶</strong>ï¼šé˜²æ­¢æ»¥ç”¨ã€‚</p>
</li>
</ul>
<blockquote>
<p>æœ€ç»ˆï¼ŒæŠ€æœ¯çš„æ„ä¹‰åœ¨äºåˆ›é€ å¿«ä¹ã€‚<br/>
å½“ä½ ä¸Šä¼ ä¸€å¼ ç‹—å­çš„ç…§ç‰‡ï¼Œçœ‹åˆ°å®ƒç©¿ä¸Šçº¢è‰²10å·çƒè¡£ã€å³æ‰‹æŒæ†ã€ä»¥â€œä¹é«˜â€é£æ ¼ç«™åœ¨å†°åœºä¸Šâ€”â€”<br/>
ä½ ä¼šç¬‘ï¼Œä¼šåˆ†äº«ï¼Œä¼šè¯´ï¼šâ€œAI çœŸé…·ï¼â€</p>
</blockquote>
<p>è€Œè¿™ï¼Œæ­£æ˜¯æˆ‘ä»¬å†™ä»£ç çš„åˆå¿ƒã€‚</p>
<p>å®Œæ•´é¡¹ç›®æºç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FgiaoZou%2Flesson_zp%2Ftree%2Fmaster%2Fai%2Fapp%2Ficeball" title="https://gitee.com/giaoZou/lesson_zp/tree/master/ai/app/iceball" target="_blank" ref="nofollow noopener noreferrer">lesson_zp/ai/app/iceball: AI + å…¨æ ˆå­¦ä¹ ä»“åº“ - Gitee.com</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Linux pinctrl å­ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7587299670641737734</link>    <guid>https://juejin.cn/post/7587299670641737734</guid>    <pubDate>2025-12-24T16:53:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587299670641737734" data-draft-id="7587299443643924543" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Linux pinctrl å­ç³»ç»Ÿ"/> <meta itemprop="keywords" content="Linux"/> <meta itemprop="datePublished" content="2025-12-24T16:53:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Lolo_fi"/> <meta itemprop="url" content="https://juejin.cn/user/414934077803401"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Linux pinctrl å­ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/414934077803401/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Lolo_fi
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T16:53:24.000Z" title="Wed Dec 24 2025 16:53:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Linux pinctrl å­ç³»ç»Ÿ</h2>
<h3 data-id="heading-1">ä¸€ã€Pinctrlçš„ä½¿ç”¨</h3>
<p>å¤§å¤šæ•° SOC çš„ pin éƒ½æ˜¯æ”¯æŒå¤ç”¨çš„ï¼Œä¾‹å¦‚æŸä¸ªSOCçš„GPIO3_D4 æ—¢å¯ä»¥ä½œä¸ºæ™®é€šçš„ GPIO ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸º PWM1_M0 å¼•è„šã€GPU_AVS å¼•è„šã€UART0_RX å¼•è„šã€‚æ­¤å¤–æˆ‘ä»¬è¿˜éœ€è¦é…ç½® pin çš„ç”µæ°”ç‰¹æ€§ï¼Œæ¯”å¦‚ä¸Š/ä¸‹æ‹‰ã€é©±åŠ¨èƒ½åŠ›ç­‰ç­‰ã€‚ä¼ ç»Ÿçš„é…ç½® pin çš„æ–¹å¼å°±æ˜¯ç›´æ¥æ“ä½œç›¸åº”çš„å¯„å­˜å™¨ï¼Œä½†æ˜¯è¿™ç§é…ç½®æ–¹å¼æ¯”è¾ƒç¹çã€è€Œä¸”å®¹æ˜“å‡ºé—®é¢˜(æ¯”å¦‚ pin åŠŸèƒ½å†²çª)ã€‚pinctrl å­ç³»ç»Ÿå°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œå¼•å…¥çš„ï¼Œpinctrl å­ç³»ç»Ÿä¸»è¦å·¥ä½œå†…å®¹å¦‚ä¸‹ï¼š</p>
<ul>
<li>è·å–è®¾å¤‡æ ‘ä¸­ pin ä¿¡æ¯ã€‚</li>
<li>æ ¹æ®è·å–åˆ°çš„ pin ä¿¡æ¯æ¥è®¾ç½® pin çš„å¤ç”¨åŠŸèƒ½</li>
<li>æ ¹æ®è·å–åˆ°çš„ pin ä¿¡æ¯æ¥è®¾ç½® pin çš„ç”µæ°”ç‰¹æ€§ï¼Œå¦‚é©±åŠ¨èƒ½åŠ›ã€‚</li>
</ul>
<p>å¯¹äºæˆ‘ä»¬ä½¿ç”¨è€…æ¥è®²ï¼Œåªéœ€è¦åœ¨è®¾å¤‡æ ‘é‡Œé¢è®¾ç½®å¥½æŸä¸ª pin çš„ç›¸å…³å±æ€§å³å¯ï¼Œå…¶ä»–çš„åˆå§‹åŒ–å·¥ä½œå‡ç”± pinctrl å­ç³»ç»Ÿæ¥å®Œæˆï¼Œpinctrl å­ç³»ç»Ÿæºç ç›®å½•ä¸º drivers/pinctrlã€‚</p>
<h4 data-id="heading-2">1.PIN é…ç½®ä¿¡æ¯è¯¦è§£</h4>
<p>è¦ä½¿ç”¨ pinctrl å­ç³»ç»Ÿï¼Œæˆ‘ä»¬éœ€è¦åœ¨è®¾å¤‡æ ‘é‡Œé¢è®¾ç½® PIN çš„é…ç½®ä¿¡æ¯ï¼Œæ¯•ç«Ÿ pinctrl å­ç³»ç»Ÿè¦æ ¹æ®ä½ æä¾›çš„ä¿¡æ¯æ¥é…ç½® PIN åŠŸèƒ½ï¼Œä¸€èˆ¬ä¼šåœ¨è®¾å¤‡æ ‘é‡Œé¢åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹æ¥æè¿° PIN çš„é…ç½®ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-C" lang="C"><span class="hljs-comment">//imx6ull.dtsi</span>
iomuxc: iomuxc@<span class="hljs-number">020e0000</span> {
				compatible = <span class="hljs-string">"fsl,imx6ul-iomuxc"</span>;
				reg = &lt;<span class="hljs-number">0x020e0000</span> <span class="hljs-number">0x4000</span>&gt;;
			};
<span class="hljs-comment">//imx6ull-14x14-evk.dts</span>
&amp;iomuxc {
	pinctrl-names = <span class="hljs-string">"default"</span>;
	pinctrl<span class="hljs-number">-0</span> = &lt;&amp;pinctrl_hog_1&gt;; <span class="hljs-comment">//hog pinæ˜¯ç³»ç»Ÿé»˜è®¤çš„çŠ¶æ€ï¼Œåœ¨ pinctrl åˆå§‹åŒ–é˜¶æ®µç«‹å³ç”Ÿæ•ˆ</span>
	pinctrl_hog_1: hoggrp<span class="hljs-number">-1</span> {
		fsl,pins = &lt;
			MX6UL_PAD_UART1_RTS_B__GPIO1_IO19	<span class="hljs-number">0x17059</span> <span class="hljs-comment">/* SD1 CD */</span>
			MX6UL_PAD_GPIO1_IO05__USDHC1_VSELECT	<span class="hljs-number">0x17059</span> <span class="hljs-comment">/* SD1 VSELECT */</span>
			MX6UL_PAD_GPIO1_IO09__GPIO1_IO09        <span class="hljs-number">0x17059</span> <span class="hljs-comment">/* SD1 RESET */</span>
		&gt;;
	};

	pinctrl_csi1: csi1grp {
		fsl,pins = &lt;
			MX6UL_PAD_CSI_MCLK__CSI_MCLK		<span class="hljs-number">0x1b088</span>
			MX6UL_PAD_CSI_PIXCLK__CSI_PIXCLK	<span class="hljs-number">0x1b088</span>
			...
		&gt;;
	};
    ...
}
</code></pre>
<ul>
<li><code>iomuxc</code> æ˜¯ IOMUX æ§åˆ¶å™¨ï¼Œè´Ÿè´£ pin çš„å¤ç”¨å’Œ pad æ§åˆ¶</li>
<li><code>compatible</code> å†³å®šä½¿ç”¨å“ªä¸ª pinctrl é©±åŠ¨ï¼ˆ<code>drivers/pinctrl/freescale/</code>ï¼‰</li>
<li><code>reg</code> æŒ‡å‘ IOMUXC å¯„å­˜å™¨åŸºåœ°å€</li>
</ul>
<p>æ‰€æœ‰ pin çš„å¤ç”¨å’Œç”µæ°”é…ç½®ï¼Œæœ€ç»ˆéƒ½ä¼šé€šè¿‡è¯¥æ§åˆ¶å™¨å®Œæˆã€‚</p>
<p>è¿™é‡Œè¦è¯´æ˜ä¸€ä¸‹ï¼ŒPADã€Pinã€GPIOæ˜¯ä¸‰ä¸ªä¸œè¥¿ï¼š</p>
<ul>
<li>
<p>PAD  				SoC å†…éƒ¨  			è´Ÿè´£å¤ç”¨ã€ç”µæ°”ç‰¹æ€§ã€ä¿¡å·ç¼“å†²</p>
</li>
<li>
<p>Pin / Ball  		èŠ¯ç‰‡å°è£…  				ç„Šçƒ / å¼•è„šç¼–å·</p>
</li>
<li>
<p>GPIO  				é€»è¾‘åŠŸèƒ½  			æ•°å­—è¾“å…¥è¾“å‡ºæ§åˆ¶å™¨</p>
</li>
</ul>
<p><strong>PAD æ˜¯ pinctrl / IOMUX ç›´æ¥æ“ä½œçš„å¯¹è±¡ï¼Œå¤šä¸ªå†…éƒ¨ä¿¡å·å…±äº«åŒä¸€ä¸ª PADï¼Œé€šè¿‡å¤ç”¨é€‰æ‹©å…¶ä¸€ã€‚</strong></p>
<p>é€šå¸¸åœ¨ <code>&amp;iomuxc</code> èŠ‚ç‚¹ä¸‹å®šä¹‰å¤šä¸ª pinctrl å­èŠ‚ç‚¹ï¼Œæ¯ä¸ªå­èŠ‚ç‚¹æè¿°ä¸€ç»„åŠŸèƒ½ç›¸å…³çš„ pinï¼Œä¾‹å¦‚ä¸Šé¢çš„<code>pinctrl_hog_1</code>ã€<code>pinctrl_csi1</code>ã€‚</p>
<pre><code class="hljs language-c" lang="c">pinctrl_xxx: xxxgrp {
	fsl,pins = &lt;
		PAD_MUX_CONFIG  PAD_CTRL_CONFIG
		...
	&gt;;
};

</code></pre>
<p><code>pinctrl_xxx</code>ï¼šlabelï¼Œç”¨äºè¢«å…¶ä»–è®¾å¤‡èŠ‚ç‚¹å¼•ç”¨</p>
<p><code>xxxgrp</code>ï¼šèŠ‚ç‚¹åï¼Œæ— å®é™…åŠŸèƒ½æ„ä¹‰ï¼Œä»…ç”¨äºåŒºåˆ†</p>
<p><code>fsl,pins</code>ï¼šå¹³å°ç§æœ‰å±æ€§ï¼Œæè¿°å…·ä½“ pin é…ç½®</p>
<p><strong>fsl,pins å±æ€§æ ¼å¼è¯´æ˜</strong></p>
<p>è¯¥å±æ€§ç”± è‹¥å¹²ç»„ <code>&lt;PAD MUX + PAD CTRL&gt;</code> ç»„æˆï¼Œæ¯ä¸€ç»„ä»£è¡¨ä¸€ä¸ª pin çš„é…ç½®ã€‚ä¸¾ä¾‹ï¼š</p>
<pre><code class="hljs language-C" lang="C">fsl,pins = &lt;
	MX6UL_PAD_UART1_RTS_B__GPIO1_IO19   <span class="hljs-number">0x17059</span>
&gt;;

</code></pre>
<p><strong>PAD MUX</strong>ï¼šå®<code>MX6UL_PAD_UART1_RTS_B__GPIO1_IO19</code>åŒ…å«ä¸‰éƒ¨åˆ†ä¿¡æ¯ï¼Œ<code>MX6UL_PAD_UART1_RTS_B</code>è¡¨ç¤ºç‰©ç† PAD åç§°ï¼Œ<code>__</code>è¡¨ç¤ºåˆ†éš”ç¬¦ï¼Œ<code>GPIO1_IO19</code>è¡¨ç¤ºå¤ç”¨åçš„åŠŸèƒ½ï¼Œè¡¨ç¤ºå°† <code>UART1_RTS_B</code> è¿™ä¸ª PAD å¤ç”¨ä¸º <code>GPIO1_IO19</code> åŠŸèƒ½ã€‚è¿™äº›å®å®šä¹‰ä½äº<code>arch/arm/boot/dts/imx6ull-pinfunc.h</code>ã€‚</p>
<p><strong>PAD CTRL</strong>ï¼š<code>0x17059</code>ç”¨äºé…ç½® pin çš„ç”µæ°”ç‰¹æ€§ï¼Œå¯¹åº” <code>IOMUXC_PAD</code> æ§åˆ¶å¯„å­˜å™¨ã€‚å¸¸è§æ§åˆ¶é¡¹åŒ…æ‹¬ï¼šä¸Šæ‹‰ / ä¸‹æ‹‰ã€é©±åŠ¨èƒ½åŠ›ã€é€Ÿç‡ã€æ–½å¯†ç‰¹è§¦å‘ã€æ¨æŒ½å¼€æ¼ã€‚</p>
<h4 data-id="heading-3">2.è®¾å¤‡èŠ‚ç‚¹ä¸­å¼•ç”¨ pinctrl</h4>
<p>pinctrl é…ç½®å¹¶ä¸ä¼šè‡ªåŠ¨ç”Ÿæ•ˆï¼Œå¿…é¡»è¢«è®¾å¤‡èŠ‚ç‚¹å¼•ç”¨ã€‚</p>
<p><strong>åŸºæœ¬å¼•ç”¨æ–¹å¼</strong></p>
<pre><code class="hljs language-c" lang="c">uart1: serial@<span class="hljs-number">02020000</span> {
	compatible = <span class="hljs-string">"fsl,imx6ul-uart"</span>;
	reg = &lt;<span class="hljs-number">0x02020000</span> <span class="hljs-number">0x4000</span>&gt;;
	interrupts = &lt;GIC_SPI <span class="hljs-number">26</span> IRQ_TYPE_LEVEL_HIGH&gt;;

	pinctrl-names = <span class="hljs-string">"default"</span>;
	pinctrl<span class="hljs-number">-0</span> = &lt;&amp;pinctrl_uart1&gt;; <span class="hljs-comment">//å¼•ç”¨pinctrl_uart1</span>

	status = <span class="hljs-string">"okay"</span>;
};
<span class="hljs-comment">//å¯¹åº”çš„pinctrlå®šä¹‰</span>
pinctrl_uart1: uart1grp {
	fsl,pins = &lt;
		MX6UL_PAD_UART1_TX_DATA__UART1_DCE_TX  <span class="hljs-number">0x1b0b1</span>
		MX6UL_PAD_UART1_RX_DATA__UART1_DCE_RX  <span class="hljs-number">0x1b0b1</span>
	&gt;;
};
</code></pre>
<p><strong>å¤šçŠ¶æ€ pinctrl</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">pinctrl-names</span> = <span class="hljs-string">"default"</span>, <span class="hljs-string">"sleep"</span><span class="hljs-comment">;</span>
<span class="hljs-attr">pinctrl-0</span> = &lt;&amp;pinctrl_uart1_default&gt;<span class="hljs-comment">;</span>
<span class="hljs-attr">pinctrl-1</span> = &lt;&amp;pinctrl_uart1_sleep&gt;<span class="hljs-comment">;</span>
</code></pre>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ªçŠ¶æ€ï¼š</p>
<p><code>default</code>ï¼šå·¥ä½œçŠ¶æ€</p>
<p><code>sleep</code>ï¼šä½åŠŸè€—çŠ¶æ€ï¼ˆå…³é—­ä¸Šä¸‹æ‹‰ã€é™ä½é©±åŠ¨ï¼‰</p>
<p>æ˜¯å¦åˆ‡æ¢ç”±é©±åŠ¨è°ƒç”¨ï¼š<code>pinctrl_select_state();</code></p>
<h3 data-id="heading-4">äºŒã€å†…éƒ¨åŸç†</h3>
<p><strong>æ ¸å¿ƒæ€è·¯</strong> ï¼ˆæ–¹ä¾¿å›å¿†ï¼‰
pinctrl æ˜¯ Linux å†…æ ¸ä¸­è´Ÿè´£ç®¡ç†å¼•è„šå¤ç”¨ä¸å¼•è„šé…ç½®çš„å­ç³»ç»Ÿã€‚<br/>
å®ƒé€šè¿‡Pin Controller é©±åŠ¨å’Œ è®¾å¤‡é©±åŠ¨ä¸¤å±‚æ¨¡å‹ï¼Œå®ç°äº†ä»è®¾å¤‡æ ‘å¼•è„šå®šä¹‰åˆ°ç¡¬ä»¶å¯„å­˜å™¨é…ç½®çš„å®Œæ•´æ˜ å°„ã€‚</p>
<p>ç®€å•æµç¨‹ç‰ˆï¼š</p>
<ul>
<li>pinctrl å­ç³»ç»Ÿçš„å·¥ä½œæµç¨‹ä» Pin Controller é©±åŠ¨å¼€å§‹ã€‚é¦–å…ˆï¼Œå†…æ ¸é€šè¿‡è®¾å¤‡æ ‘ä¸­çš„ <strong>compatible</strong> å±æ€§åŒ¹é…åˆ°å¯¹åº”çš„ pinctrl é©±åŠ¨ï¼Œå½“åŒ¹é…æˆåŠŸåï¼Œä¼šè°ƒç”¨è¯¥é©±åŠ¨çš„ <strong>probe</strong> å‡½æ•°ã€‚åœ¨ probe é˜¶æ®µï¼Œé©±åŠ¨ä¼šæ ¹æ® SoC çš„ç‰¹æ€§å¡«å……ä¸€ä¸ª <strong>pinctrl_desc</strong> ç»“æ„ä½“ï¼Œå…¶ä¸­åŒ…å«å¼•è„šæè¿°ä¿¡æ¯ï¼ˆpins/npinsï¼‰ã€æ“ä½œå‡½æ•°ï¼ˆpctlopsã€pmxopsã€confopsï¼‰ç­‰å†…å®¹ï¼Œå¹¶é€šè¿‡ <strong>devm_pinctrl_register()</strong> å°†è¯¥ pin controller æ³¨å†Œåˆ°å†…æ ¸ä¸­ï¼Œå®Œæˆå¼•è„šæ§åˆ¶å™¨çš„åˆå§‹åŒ–ä¸åŠŸèƒ½æ³¨å†Œã€‚</li>
<li>å½“å…·ä½“ä½¿ç”¨pinctrlçš„è®¾å¤‡é©±åŠ¨åœ¨ probe é˜¶æ®µåŠ è½½æ—¶ï¼Œå†…æ ¸ä¼šæ ¹æ®è®¾å¤‡æ ‘ä¸­å®šä¹‰çš„å¼•è„šé…ç½®è°ƒç”¨ <strong>pinctrl_bind_pins()</strong> å‡½æ•°ï¼Œä¸ºè¯¥è®¾å¤‡å»ºç«‹å¼•è„šæ§åˆ¶ä¸Šä¸‹æ–‡ã€‚è¯¥å‡½æ•°é¦–å…ˆä¸ºè®¾å¤‡åˆ›å»ºä¸€ä¸ª <strong>dev_pin_info</strong> ç»“æ„ä½“ï¼Œç”¨äºä¿å­˜è®¾å¤‡çš„å¼•è„šæ§åˆ¶ä¿¡æ¯ã€‚å…¶ä¸­ï¼Œå‡½æ•°ä¼šè°ƒç”¨ <strong>devm_pinctrl_get()</strong> åˆ›å»ºä¸€ä¸ªæ–°çš„ <strong>pinctrl</strong> ç»“æ„ä½“ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™ <code>dev_pin_info</code> çš„ <code>p</code> æˆå‘˜ã€‚</li>
<li>éšåï¼Œå†…æ ¸é€šè¿‡ <strong>pinctrl_dt_to_map()</strong> ä»è®¾å¤‡æ ‘ä¸­è¯»å–è¯¥è®¾å¤‡çš„å¼•è„šé…ç½®ï¼Œå¹¶è°ƒç”¨ pinctrl é©±åŠ¨æä¾›çš„ <strong>imx_dt_node_to_map()</strong> ç­‰å‡½æ•°æ¥è§£æ <code>pinctrl-0</code>ã€<code>pinctrl-1</code> ç­‰èŠ‚ç‚¹ã€‚è§£æè¿‡ç¨‹ä¼šç”Ÿæˆä¸€ç³»åˆ— <strong>pinctrl_map</strong> ç»“æ„ä½“ï¼Œæ¯ä¸ª map å¯¹åº”ä¸€ç»„å¼•è„šåŠŸèƒ½æˆ–é…ç½®ã€‚è¿™äº› map ä¼šè¢«è¿›ä¸€æ­¥è½¬æ¢ä¸º <strong>pinctrl_setting</strong>ï¼Œå¹¶æŒ‚å…¥å¯¹åº”çŠ¶æ€çš„ <strong>pinctrl_state.settings</strong> é“¾è¡¨ä¸­ï¼ŒåŒæ—¶æ‰€æœ‰ map ä¿¡æ¯ä¹Ÿä¼šä¿å­˜åœ¨ <code>pinctrl</code> çš„ <code>dt_maps</code> é“¾è¡¨ä¸­ã€‚</li>
<li>åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå†…æ ¸æ ¹æ®ä¸åŒçš„ pinctrl èŠ‚ç‚¹ï¼ˆå¦‚ defaultã€sleep ç­‰ï¼‰åˆ›å»ºå¤šä¸ª <strong>pinctrl_state</strong>ï¼Œæ¯ä¸ªçŠ¶æ€å¯¹åº”è®¾å¤‡æ ‘ä¸­å®šä¹‰çš„ä¸€ä¸ªå¼•è„šçŠ¶æ€ã€‚è¿™äº›çŠ¶æ€è¢«æ·»åŠ åˆ° <code>pinctrl</code> çš„ <code>states</code> é“¾è¡¨ä¸­ï¼Œè€Œ <code>dev_pin_info</code> ç»“æ„ä¸­çš„ <code>default_state</code>ã€<code>sleep_state</code> ç­‰æŒ‡é’ˆåˆ™ä¼šè¢«è®¾ç½®ä¸ºæŒ‡å‘è¿™äº›çŠ¶æ€ç»“æ„ã€‚</li>
<li>å½“è®¾å¤‡è¿è¡Œè¿‡ç¨‹ä¸­éœ€è¦åˆ‡æ¢å¼•è„šé…ç½®ï¼ˆä¾‹å¦‚è¿›å…¥ç¡çœ æˆ–æ¢å¤é»˜è®¤çŠ¶æ€ï¼‰æ—¶ï¼Œé©±åŠ¨å¯è°ƒç”¨ <strong>pinctrl_select_state()</strong> å‡½æ•°æ¥åˆ‡æ¢åˆ°å¯¹åº”çš„çŠ¶æ€ã€‚è¯¥å‡½æ•°ä¼šéå†å½“å‰çŠ¶æ€ä¸‹çš„æ‰€æœ‰ <strong>pinctrl_setting</strong>ï¼Œå¹¶æ ¹æ®æ¯ä¸ª setting çš„ç±»å‹ï¼ˆå¤ç”¨æˆ–é…ç½®ï¼‰è°ƒç”¨ pin controller é©±åŠ¨æä¾›çš„æ“ä½œæ¥å£ï¼ˆopsï¼‰ï¼Œæœ€ç»ˆé€šè¿‡åº•å±‚å¯„å­˜å™¨é…ç½®å®Œæˆç¡¬ä»¶å¼•è„šåŠŸèƒ½ä¸ç”µæ°”å±æ€§çš„åˆ‡æ¢ã€‚</li>
</ul>
<p>è¿™ä¸€æ•´å¥—æœºåˆ¶å®ç°äº†ä»è®¾å¤‡æ ‘å®šä¹‰åˆ°ç¡¬ä»¶å¼•è„šé…ç½®çš„å®Œæ•´è‡ªåŠ¨åŒ–æ˜ å°„æµç¨‹ã€‚</p>
<hr/>
<h4 data-id="heading-5">1.Provider ç«¯</h4>
<p><strong>Pin Controller é©±åŠ¨æ³¨å†Œæµç¨‹</strong></p>
<h5 data-id="heading-6">(1)è®¾å¤‡æ ‘åŒ¹é…</h5>
<p>åœ¨è®¾å¤‡æ ‘ä¸­å®šä¹‰ä¸€ä¸ª pin controller èŠ‚ç‚¹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">iomuxc: iomuxc@020e0000 {
    <span class="hljs-attr">compatible</span> = <span class="hljs-string">"fsl,imx6ul-iomuxc"</span><span class="hljs-comment">;</span>
    <span class="hljs-attr">reg</span> = &lt;<span class="hljs-number">0</span>x020e0000 <span class="hljs-number">0</span>x4000&gt;<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<p>å¯¹åº”é©±åŠ¨ä¸­çš„åŒ¹é…è¡¨ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">of_device_id</span> imx6ul_pinctrl_of_match[] = {
    { .compatible = <span class="hljs-string">"fsl,imx6ul-iomuxc"</span>, .data = &amp;imx6ul_pinctrl_info },
    { <span class="hljs-comment">/* sentinel */</span> }
};
</code></pre>
<p>å½“ compatible åŒ¹é…æˆåŠŸåï¼Œè°ƒç”¨ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title">imx6ul_pinctrl_probe</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> platform_device *pdev)</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">imx_pinctrl_probe</span>(pdev, pinctrl_info);
}
</code></pre>
<hr/>
<h5 data-id="heading-7">(2)probe é˜¶æ®µ</h5>
<p><strong>æ„é€ å¹¶æ³¨å†Œ pinctrl_desc</strong></p>
<p>æ ¸å¿ƒå‡½æ•° <code>imx_pinctrl_probe()</code>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">int imx_pinctrl_probe(struct platform_device *pdev,
                      struct imx_pinctrl_soc_info *info)
{
    struct pinctrl_desc *desc<span class="hljs-comment">;</span>

    desc-&gt;<span class="hljs-attr">name</span> = dev_name(&amp;pdev-&gt;dev)<span class="hljs-comment">;</span>
    desc-&gt;<span class="hljs-attr">pins</span> = info-&gt;pins<span class="hljs-comment">;           // å¼•è„šæ•°ç»„</span>
    desc-&gt;<span class="hljs-attr">npins</span> = info-&gt;npins<span class="hljs-comment">;         // å¼•è„šæ•°é‡</span>
    desc-&gt;<span class="hljs-attr">pctlops</span> = &amp;imx_pctrl_ops<span class="hljs-comment">;    // åˆ†ç»„æ“ä½œ</span>
    desc-&gt;<span class="hljs-attr">pmxops</span> = &amp;imx_pmx_ops<span class="hljs-comment">;       // å¤ç”¨æ“ä½œ</span>
    desc-&gt;<span class="hljs-attr">confops</span> = &amp;imx_pinconf_ops<span class="hljs-comment">;  // å¼•è„šé…ç½®æ“ä½œ</span>
    desc-&gt;<span class="hljs-attr">owner</span> = THIS_MODULE<span class="hljs-comment">;</span>

    // æ³¨å†Œ pin controller
    ipctl-&gt;<span class="hljs-attr">pctl</span> = devm_pinctrl_register(&amp;pdev-&gt;dev, desc, ipctl)<span class="hljs-comment">;</span>
}
</code></pre>
<p><code>devm_pinctrl_register()</code> ä¼šåœ¨å†…æ ¸ä¸­æ³¨å†Œä¸€ä¸ª <code>pinctrl_dev</code> å®ä¾‹ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">pinctrl_dev</span> {
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">pinctrl_desc</span> *desc;
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">device</span> *dev;
    <span class="hljs-type">void</span> *driver_data;
};
</code></pre>
<hr/>
<h5 data-id="heading-8">(3)ä¸‰å¤§æ“ä½œå‡½æ•°</h5>
<p>pinctrl æ¡†æ¶é€šè¿‡ä»¥ä¸‹ä¸‰ç±» ops å®ŒæˆæŠ½è±¡ï¼š</p>

























<table><thead><tr><th>æ“ä½œé›†</th><th>åŠŸèƒ½</th><th>ç¤ºä¾‹å‡½æ•°</th></tr></thead><tbody><tr><td><strong>pinctrl_ops</strong></td><td>å¼•è„šç»„ç®¡ç†ä¸è®¾å¤‡æ ‘è§£æ</td><td><code>dt_node_to_map()</code></td></tr><tr><td><strong>pinmux_ops</strong></td><td>æ§åˆ¶å¼•è„šå¤ç”¨</td><td><code>set_mux()</code></td></tr><tr><td><strong>pinconf_ops</strong></td><td>æ§åˆ¶å¼•è„šç”µæ°”å±æ€§</td><td><code>pin_config_set()</code></td></tr></tbody></table>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">static const struct pinctrl_ops <span class="hljs-attr">imx_pctrl_ops</span> = {
    .<span class="hljs-attr">get_groups_count</span> = imx_get_groups_count,
    .<span class="hljs-attr">get_group_name</span> = imx_get_group_name,
    .<span class="hljs-attr">dt_node_to_map</span> = imx_dt_node_to_map, // å…³é”®ï¼šè®¾å¤‡æ ‘è½¬ pinctrl_map
}<span class="hljs-comment">;</span>
</code></pre>
<hr/>
<h3 data-id="heading-9">2.Consumer ç«¯</h3>
<p><strong>è®¾å¤‡é©±åŠ¨çš„å¼•è„šç»‘å®šä¸çŠ¶æ€åˆ›å»º</strong></p>
<h5 data-id="heading-10">(1)è®¾å¤‡æ ‘ä¸­å®šä¹‰å¼•è„šé…ç½®</h5>
<pre><code class="hljs language-ini" lang="ini">&amp;iomuxc {
    imx6ul-evk {
        pinctrl_i2c1: i2c1grp {
            fsl,<span class="hljs-attr">pins</span> = &lt;
                MX6UL_PAD_UART1_TX_DATA__I2C1_SCL 0x4001b8b0
                MX6UL_PAD_UART1_RX_DATA__I2C1_SDA 0x4001b8b0
            &gt;<span class="hljs-comment">;</span>
        }<span class="hljs-comment">;</span>
    }<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

i2c1: i2c@021a0000 {
    <span class="hljs-attr">compatible</span> = <span class="hljs-string">"fsl,imx6ul-i2c"</span><span class="hljs-comment">;</span>
    <span class="hljs-attr">pinctrl-names</span> = <span class="hljs-string">"default"</span>, <span class="hljs-string">"sleep"</span><span class="hljs-comment">;</span>
    <span class="hljs-attr">pinctrl-0</span> = &lt;&amp;pinctrl_i2c1&gt;<span class="hljs-comment">;</span>
    <span class="hljs-attr">pinctrl-1</span> = &lt;&amp;pinctrl_i2c1_sleep&gt;<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<p><code>pinctrl-names</code> ä¸ <code>pinctrl-0</code>, <code>pinctrl-1</code> ç­‰å±æ€§å®šä¹‰äº†è®¾å¤‡çš„å¤šç§å¼•è„šçŠ¶æ€ã€‚</p>
<hr/>
<h5 data-id="heading-11">(2)pinctrl_bind_pins()</h5>
<p><strong>è®¾å¤‡ probe æ—¶çš„å¼•è„šç»‘å®šå…¥å£ï¼š<code>pinctrl_bind_pins()</code></strong></p>
<p>å½“è®¾å¤‡é©±åŠ¨è¢«åŠ è½½æ—¶ï¼Œ<code>really_probe()</code> è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">pinctrl_bind_pins</span>(dev);
</code></pre>
<p>è¯¥å‡½æ•°è´Ÿè´£ä¸ºè®¾å¤‡åˆ›å»ºå¼•è„šæ§åˆ¶ä¿¡æ¯ï¼Œæ˜¯ Consumer ç«¯çš„æ ¸å¿ƒå…¥å£ã€‚</p>
<hr/>
<h5 data-id="heading-12">(3)<code>pinctrl_bind_pins</code></h5>
<p><strong><code>pinctrl_bind_pins</code> å†…éƒ¨å…³é”®æ­¥éª¤</strong></p>
<p><strong>step1.åˆ›å»º <code>dev_pin_info</code> ç»“æ„</strong></p>
<pre><code class="hljs language-ini" lang="ini">dev-&gt;<span class="hljs-attr">pins</span> = devm_kzalloc(dev, sizeof(*(dev-&gt;pins)), GFP_KERNEL)<span class="hljs-comment">;</span>
</code></pre>
<p><code>struct dev_pin_info</code> ç”¨äºæè¿°è®¾å¤‡ä¸ pinctrl å­ç³»ç»Ÿçš„ç»‘å®šå…³ç³»ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">dev_pin_info</span> {
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">pinctrl</span> *p;                    <span class="hljs-comment">// æŒ‡å‘è¯¥è®¾å¤‡çš„ pinctrl å¥æŸ„</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">pinctrl_state</span> *default_state;  <span class="hljs-comment">// é»˜è®¤çŠ¶æ€</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">pinctrl_state</span> *init_state;     <span class="hljs-comment">// åˆå§‹åŒ–çŠ¶æ€</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">pinctrl_state</span> *sleep_state;    <span class="hljs-comment">// ç¡çœ çŠ¶æ€</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">pinctrl_state</span> *idle_state;     <span class="hljs-comment">// ç©ºé—²çŠ¶æ€</span>
};
</code></pre>
<p><code>dev_pin_info</code> æ˜¯è®¾å¤‡å’Œ pinctrl æ¡†æ¶ä¹‹é—´çš„â€œæ¡¥æ¢â€ï¼š</p>
<ul>
<li><code>p</code>ï¼šæŒ‡å‘è®¾å¤‡å¯¹åº”çš„ <code>struct pinctrl</code></li>
<li>å…¶ä»–æˆå‘˜æŒ‡å‘ä¸åŒå‘½åçŠ¶æ€çš„ <code>pinctrl_state</code></li>
</ul>
<hr/>
<p><strong>step2.åˆ›å»º <code>pinctrl</code> ç»“æ„</strong></p>
<pre><code class="hljs language-ini" lang="ini">dev-&gt;pins-&gt;<span class="hljs-attr">p</span> = devm_pinctrl_get(dev)<span class="hljs-comment">;</span>
</code></pre>
<p><code>devm_pinctrl_get()</code> å†…éƒ¨æ‰§è¡Œï¼š</p>
<ol>
<li>åˆ›å»º <code>struct pinctrl</code>ï¼›</li>
<li>è°ƒç”¨ <code>pinctrl_dt_to_map()</code> è§£æè®¾å¤‡æ ‘ï¼›</li>
<li>å°†è§£æç»“æœä¿å­˜åˆ° <code>pinctrl-&gt;dt_maps</code>ï¼›</li>
<li>ä¸ºæ¯ä¸ªçŠ¶æ€åˆ›å»º <code>pinctrl_state</code> å¹¶åŠ å…¥ <code>pinctrl-&gt;states</code> é“¾è¡¨ã€‚</li>
</ol>
<hr/>
<p><strong>step3.è®¾å¤‡æ ‘è§£æ â†’ <code>pinctrl_map</code> æ„å»º</strong></p>
<p><code>pinctrl_dt_to_map()</code> é€šè¿‡ pinctrl é©±åŠ¨æä¾›çš„ <code>dt_node_to_map()</code> æ¥è§£æï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">imx_dt_node_to_map</span>(np_config, &amp;map, &amp;num_maps);
</code></pre>
<p>æ¯ä¸ªèŠ‚ç‚¹ï¼ˆå¦‚ <code>pinctrl-0</code>ï¼‰ä¼šç”Ÿæˆè‹¥å¹²ä¸ª <code>pinctrl_map</code>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">pinctrl_map</span> {
    <span class="hljs-type">const</span> <span class="hljs-type">char</span> *dev_name;
    <span class="hljs-type">const</span> <span class="hljs-type">char</span> *name;
    <span class="hljs-keyword">enum</span> <span class="hljs-title class_">pinctrl_map_type</span> type;
    <span class="hljs-keyword">union</span> {
        <span class="hljs-keyword">struct</span> { <span class="hljs-type">const</span> <span class="hljs-type">char</span> *group; <span class="hljs-type">const</span> <span class="hljs-type">char</span> *function; } mux;
        <span class="hljs-keyword">struct</span> { <span class="hljs-type">const</span> <span class="hljs-type">char</span> *group_or_pin; <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> *configs; <span class="hljs-type">unsigned</span> num_configs; } configs;
    } data;
};
</code></pre>
<p>è¿™äº› <code>pinctrl_map</code> æè¿°äº†è®¾å¤‡ã€ç»„ã€åŠŸèƒ½ä¸é…ç½®ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œå¹¶è¢«æŒ‚å…¥ï¼š</p>
<pre><code class="hljs language-rust" lang="rust">pinctrl<span class="hljs-punctuation">-&gt;</span>dt_maps
</code></pre>
<hr/>
<p><strong>step4.<code>pinctrl_map</code> â†’ <code>pinctrl_setting</code> â†’ <code>pinctrl_state</code></strong></p>
<p>æ¯ä¸ª <code>pinctrl_map</code> ä¼šè¢«è½¬æ¢ä¸º <code>pinctrl_setting</code>ï¼ŒæŒ‚å…¥å¯¹åº”çš„ <code>pinctrl_state.settings</code> é“¾è¡¨ã€‚</p>
<p>ç»“æ„å…³ç³»å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">dev_pin_info
   â””â”€â”€ pinctrl
        â”œâ”€â”€ states (é“¾è¡¨)
        â”‚     â”œâ”€â”€ <span class="hljs-built_in">pinctrl_state</span>("default")
        â”‚     â”‚       â””â”€â”€ settings â†’ <span class="hljs-built_in">pinctrl_setting</span>(å¤šä¸ª)
        â”‚     â””â”€â”€ <span class="hljs-built_in">pinctrl_state</span>("sleep")
        â””â”€â”€ dt_maps (æ˜ å°„é“¾è¡¨)
</code></pre>
<p>æ­¤æ—¶ï¼Œ<code>dev_pin_info</code> ä¸­çš„ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">default_state â†’ æŒ‡å‘ states ä¸­åä¸º â€œ<span class="hljs-keyword">default</span>â€ çš„çŠ¶æ€
sleep_state   â†’ æŒ‡å‘ states ä¸­åä¸º â€œsleepâ€ çš„çŠ¶æ€
</code></pre>
<hr/>
<h3 data-id="heading-13">3.çŠ¶æ€åˆ‡æ¢</h3>
<p>å½“é©±åŠ¨éœ€è¦åˆ‡æ¢å¼•è„šçŠ¶æ€æ—¶ï¼ˆå¦‚è¿›å…¥ä¼‘çœ ï¼‰ï¼Œä¼šè°ƒç”¨ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">pinctrl_select_state</span>(pinctrl, sleep_state);
</code></pre>
<p>æ‰§è¡Œè¿‡ç¨‹ï¼š</p>
<ol>
<li>éå†è¯¥çŠ¶æ€ä¸‹æ‰€æœ‰çš„ <code>pinctrl_setting</code></li>
<li>åˆ¤æ–­ setting ç±»å‹å¹¶è°ƒç”¨ç›¸åº” opsï¼š</li>
</ol>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">switch</span> (setting-&gt;<span class="hljs-keyword">type</span>) {
<span class="hljs-keyword">case</span> PIN_MAP_TYPE_MUX_GROUP:
    pinmux_enable_setting(setting);
    <span class="hljs-comment">// å®é™…è°ƒç”¨ -&gt; ops-&gt;set_mux()</span>
    <span class="hljs-keyword">break</span>;

<span class="hljs-keyword">case</span> PIN_MAP_TYPE_CONFIGS_GROUP:
<span class="hljs-keyword">case</span> PIN_MAP_TYPE_CONFIGS_PIN:
    pinconf_apply_setting(setting);
    <span class="hljs-comment">// å®é™…è°ƒç”¨ -&gt; ops-&gt;pin_config_group_set()</span>
    <span class="hljs-keyword">break</span>;
}
</code></pre>
<p>æœ€ç»ˆç”± pin controller é©±åŠ¨çš„åº•å±‚å‡½æ•°ï¼ˆ<code>imx_pmx_ops</code>ã€<code>imx_pinconf_ops</code>ï¼‰å°†é…ç½®å†™å…¥å¯„å­˜å™¨ï¼Œå®Œæˆç¡¬ä»¶å±‚è®¾ç½®ã€‚</p>
<hr/>
<h3 data-id="heading-14">4.è°ƒè¯•</h3>
<p>åœ¨ <code>/sys/kernel/debug/pinctrl/&lt;controller&gt;/</code> ä¸‹å¯ä»¥æŸ¥çœ‹ pinctrl çš„å†…éƒ¨çŠ¶æ€ï¼š</p>

































<table><thead><tr><th>æ–‡ä»¶å</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>pins</code></td><td>å·²æ³¨å†Œå¼•è„šä¿¡æ¯</td></tr><tr><td><code>pingroups</code></td><td>å¼•è„šç»„ä¿¡æ¯</td></tr><tr><td><code>pinmux-pins</code></td><td>æ¯ä¸ªå¼•è„šçš„å¤ç”¨çŠ¶æ€</td></tr><tr><td><code>pinmux-functions</code></td><td>åŠŸèƒ½ä¸ç»„çš„å¯¹åº”</td></tr><tr><td><code>pinconf-pins</code></td><td>å¼•è„šé…ç½®å‚æ•°</td></tr><tr><td><code>pinconf-config</code></td><td>å¯åŠ¨æ€ä¿®æ”¹é…ç½®</td></tr></tbody></table>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cat</span> /sys/kernel/debug/pinctrl/20e0000.iomuxc/pingroups
<span class="hljs-built_in">cat</span> /sys/kernel/debug/pinctrl/20e0000.iomuxc/pinmux-functions
</code></pre>
<hr/>
<h3 data-id="heading-15">5.æ‰§è¡Œé“¾æ€»ç»“</h3>





















































<table><thead><tr><th>é˜¶æ®µ</th><th>ä¸»ä½“</th><th>æ“ä½œ</th><th>æ ¸å¿ƒç»“æ„ / å‡½æ•°</th></tr></thead><tbody><tr><td><strong>1. åŒ¹é…é©±åŠ¨</strong></td><td>å†…æ ¸ â†’ pinctrl é©±åŠ¨</td><td>åŒ¹é… compatible</td><td><code>of_match_table</code></td></tr><tr><td><strong>2. æ§åˆ¶å™¨æ³¨å†Œ</strong></td><td>pinctrl é©±åŠ¨</td><td>æ³¨å†Œ pin controller</td><td><code>devm_pinctrl_register</code></td></tr><tr><td><strong>3. è®¾å¤‡æ ‘è§£æ</strong></td><td>å†…æ ¸æ¡†æ¶</td><td>è§£æ pinctrl-0 èŠ‚ç‚¹</td><td><code>pinctrl_dt_to_map</code> / <code>dt_node_to_map</code></td></tr><tr><td><strong>4. çŠ¶æ€å»ºç«‹</strong></td><td>å†…æ ¸æ¡†æ¶</td><td>åˆ›å»º map â†’ setting â†’ state</td><td><code>pinctrl_add_setting</code></td></tr><tr><td><strong>5. è®¾å¤‡ç»‘å®š</strong></td><td>å†…æ ¸æ¡†æ¶</td><td>åˆ›å»º <code>dev_pin_info</code> ä¸ <code>pinctrl</code></td><td><code>pinctrl_bind_pins</code></td></tr><tr><td><strong>6. çŠ¶æ€åˆ‡æ¢</strong></td><td>è®¾å¤‡é©±åŠ¨</td><td>åº”ç”¨çŠ¶æ€</td><td><code>pinctrl_select_state</code></td></tr><tr><td><strong>7. ç¡¬ä»¶é…ç½®</strong></td><td>pinctrl é©±åŠ¨</td><td>è°ƒç”¨ ops å†™å¯„å­˜å™¨</td><td><code>set_mux</code> / <code>pin_config_set</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-16">6.æ€»ç»“</h3>
<p>pinctrl é©±åŠ¨ï¼šæè¿°å¹¶æ³¨å†Œç¡¬ä»¶å¼•è„šèƒ½åŠ›ï¼›</p>
<p>pinctrl æ ¸å¿ƒï¼šæä¾›ç»Ÿä¸€çš„æ•°æ®ç»“æ„ä¸è°ƒç”¨æœºåˆ¶ï¼›</p>
<p>è®¾å¤‡é©±åŠ¨ï¼šå£°æ˜çŠ¶æ€ï¼ŒåŠ¨æ€åˆ‡æ¢å¼•è„šé…ç½®ï¼›</p>
<p>dev_pin_infoï¼šè¿æ¥è®¾å¤‡ä¸ pinctrl æ¡†æ¶çš„ä¸­æ¢ï¼Œç®¡ç†çŠ¶æ€åˆ‡æ¢ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Androidæš—é»‘æ¨¡å¼é€‚é…å…¨æ”»ç•¥ï¼šä»å…¥é—¨åˆ°ç²¾é€šï¼Œå‘Šåˆ«"é˜´é—´é…è‰²"]]></title>    <link>https://juejin.cn/post/7587264707285106698</link>    <guid>https://juejin.cn/post/7587264707285106698</guid>    <pubDate>2025-12-25T01:49:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587264707285106698" data-draft-id="7587264707285041162" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Androidæš—é»‘æ¨¡å¼é€‚é…å…¨æ”»ç•¥ï¼šä»å…¥é—¨åˆ°ç²¾é€šï¼Œå‘Šåˆ«&quot;é˜´é—´é…è‰²&quot;"/> <meta itemprop="keywords" content="é¢è¯•,Android,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2025-12-25T01:49:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¡¾æ—æµ·"/> <meta itemprop="url" content="https://juejin.cn/user/2365804752153911"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Androidæš—é»‘æ¨¡å¼é€‚é…å…¨æ”»ç•¥ï¼šä»å…¥é—¨åˆ°ç²¾é€šï¼Œå‘Šåˆ«"é˜´é—´é…è‰²"
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2365804752153911/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¡¾æ—æµ·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T01:49:19.000Z" title="Thu Dec 25 2025 01:49:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å¦‚ä»Šæ‰“å¼€æ‰‹æœºï¼Œä¸å°‘äººéƒ½ä¼šä¸‹æ„è¯†åˆ‡æ¢åˆ°æš—é»‘æ¨¡å¼â€”â€”æ¯•ç«Ÿåœ¨æ·±å¤œåˆ·æ‰‹æœºæ—¶ï¼Œæƒ¨ç™½çš„å±å¹•å ªæ¯”"ç”µå­å¼ºå…‰æ‰‹ç”µ"ï¼Œæ™ƒå¾—äººçœ¼ç›å‘é…¸ã€‚ä½œä¸ºAndroidå¼€å‘è€…ï¼Œç»™åº”ç”¨åšå¥½æš—é»‘æ¨¡å¼é€‚é…æ—©å·²ä¸æ˜¯"åŠ åˆ†é¡¹"ï¼Œè€Œæ˜¯å…³ä¹ç”¨æˆ·ä½“éªŒçš„"å¿…åšé¢˜"ã€‚</p>
<p>ä½†é€‚é…æš—é»‘æ¨¡å¼å¯ä¸æ˜¯ç®€å•åœ°æŠŠèƒŒæ™¯æ”¹æˆé»‘è‰²ã€æ–‡å­—æ”¹æˆç™½è‰²å°±å®Œäº‹äº†ã€‚ä¸å°‘æ–°æ‰‹è¸©å‘ååšå‡ºçš„æš—é»‘æ¨¡å¼ï¼Œè¦ä¹ˆæ–‡å­—å’ŒèƒŒæ™¯å¯¹æ¯”åº¦ä¸å¤Ÿçœ‹å¾—è´¹åŠ²ï¼Œè¦ä¹ˆæ§ä»¶é¢œè‰²æ··ä¹±åƒ"è°ƒè‰²ç›˜æ‰“ç¿»"ï¼Œè¦ä¹ˆåˆ‡æ¢æ—¶é—ªå±å¡é¡¿è®©ç”¨æˆ·æŠ“ç‹‚ã€‚ä»Šå¤©è¿™ç¯‡å…¨æ”»ç•¥ï¼Œå°±ä»åŸºç¡€åŸç†åˆ°è¿›é˜¶æŠ€å·§ï¼ŒæŠŠAndroidæš—é»‘æ¨¡å¼é€‚é…è®²å¾—æ˜æ˜ç™½ç™½ï¼Œè¿˜é™„ä¸Šå¯ç›´æ¥å¤ç”¨çš„ä»£ç ï¼Œè®©ä½ å°‘èµ°99%çš„å¼¯è·¯ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€å…ˆææ‡‚ï¼šæš—é»‘æ¨¡å¼é€‚é…çš„æ ¸å¿ƒé€»è¾‘</h2>
<p>åœ¨åŠ¨æ‰‹å†™ä»£ç å‰ï¼Œæˆ‘ä»¬å¾—å…ˆæ˜ç™½Androidç³»ç»Ÿæ˜¯æ€ä¹ˆç®¡ç†æš—é»‘æ¨¡å¼çš„ã€‚ç®€å•æ¥è¯´ï¼Œæ ¸å¿ƒé€»è¾‘å°±æ˜¯ <strong>"èµ„æºåŒ¹é…"</strong> â€”â€”ç³»ç»Ÿä¼šæ ¹æ®å½“å‰çš„ä¸»é¢˜æ¨¡å¼ï¼ˆæµ…è‰²/æš—é»‘ï¼‰ï¼Œè‡ªåŠ¨åŠ è½½å¯¹åº”çš„èµ„æºæ–‡ä»¶ã€‚</p>
<p>Android 10ï¼ˆAPI 29ï¼‰æ˜¯ä¸ªå…³é”®èŠ‚ç‚¹ï¼Œä»è¿™ä¸ªç‰ˆæœ¬å¼€å§‹ï¼Œç³»ç»Ÿæ­£å¼æ”¯æŒå…¨å±€æš—é»‘æ¨¡å¼ã€‚è€Œé€šè¿‡AndroidXçš„AppCompatåº“ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠé€‚é…èŒƒå›´å‘ä¸‹å…¼å®¹åˆ°API 14ï¼ŒåŸºæœ¬è¦†ç›–å¸‚é¢ä¸Šç»å¤§å¤šæ•°è®¾å¤‡ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸ªé‡è¦æ¦‚å¿µï¼š<strong>DayNightä¸»é¢˜</strong>ã€‚è¿™æ˜¯Androidæä¾›çš„"æ—¥å¤œåˆ‡æ¢"åŸºç¡€ä¸»é¢˜ï¼Œæˆ‘ä»¬çš„åº”ç”¨ä¸»é¢˜åªè¦ç»§æ‰¿å®ƒï¼Œå°±èƒ½è‡ªåŠ¨å“åº”ç³»ç»Ÿçš„ä¸»é¢˜åˆ‡æ¢æŒ‡ä»¤ã€‚åç»­çš„æ‰€æœ‰é€‚é…å·¥ä½œï¼Œéƒ½æ˜¯å›´ç»•è¿™ä¸ªä¸»é¢˜å±•å¼€çš„èµ„æºå®šåˆ¶ã€‚</p>
<p>å¦å¤–ï¼Œæš—é»‘æ¨¡å¼çš„å¼€å¯æ–¹å¼æœ‰ä¸‰ç§ï¼ˆç”¨æˆ·å¯è‡ªè¡Œåˆ‡æ¢ï¼‰ï¼š</p>
<ul>
<li>ç³»ç»Ÿè®¾ç½®ï¼šè®¾ç½® &gt; æ˜¾ç¤º &gt; ä¸»é¢˜ï¼Œæ‰‹åŠ¨åˆ‡æ¢æµ…è‰²/æš—é»‘ï¼›</li>
<li>å¿«æ·è®¾ç½®ï¼šä¸‹æ‹‰é€šçŸ¥æ ï¼Œç‚¹å‡»"æš—é»‘æ¨¡å¼"å¿«æ·å¼€å…³ï¼›</li>
<li>çœç”µæ¨¡å¼ï¼šéƒ¨åˆ†è®¾å¤‡ï¼ˆå¦‚Pixelï¼‰å¼€å¯çœç”µæ¨¡å¼åï¼Œä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°æš—é»‘æ¨¡å¼ã€‚</li>
</ul>
<p>æˆ‘ä»¬çš„é€‚é…ç›®æ ‡ï¼Œå°±æ˜¯è®©åº”ç”¨åœ¨è¿™ä¸‰ç§åœºæ™¯ä¸‹ï¼Œéƒ½èƒ½æµç•…ã€ç¾è§‚åœ°åˆ‡æ¢ä¸»é¢˜ï¼Œä¸”æ‰€æœ‰UIå…ƒç´ éƒ½ç¬¦åˆæš—é»‘æ¨¡å¼çš„è§†è§‰è§„èŒƒã€‚</p>
<h2 data-id="heading-2">äºŒã€åŸºç¡€æ“ä½œï¼š3æ­¥æå®šæš—é»‘æ¨¡å¼é€‚é…å…¥é—¨</h2>
<p>å…¥é—¨çº§çš„æš—é»‘æ¨¡å¼é€‚é…ï¼Œæ ¸å¿ƒå°±3ä¸ªæ­¥éª¤ï¼šç»§æ‰¿DayNightä¸»é¢˜ã€åˆ›å»ºæš—é»‘æ¨¡å¼èµ„æºç›®å½•ã€ä½¿ç”¨ä¸»é¢˜å±æ€§è€Œéç¡¬ç¼–ç é¢œè‰²ã€‚è·Ÿç€åšï¼Œå°±èƒ½å¿«é€Ÿå®ç°åŸºç¡€çš„æ˜æš—åˆ‡æ¢æ•ˆæœã€‚</p>
<h3 data-id="heading-3">æ­¥éª¤1ï¼šè®©åº”ç”¨ä¸»é¢˜ç»§æ‰¿DayNightä¸»é¢˜</h3>
<p>é¦–å…ˆæ‰¾åˆ°åº”ç”¨çš„ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸åœ¨res/values/styles.xmlï¼‰ï¼ŒæŠŠä¸»é¢˜çš„parentè®¾ç½®ä¸ºDayNightç›¸å…³ä¸»é¢˜ã€‚è¿™é‡Œæ¨èä½¿ç”¨Material Componentsåº“çš„ä¸»é¢˜ï¼Œå…¼å®¹æ€§æ›´å¥½ï¼Œè¿˜èƒ½ç›´æ¥å¤ç”¨Material Designçš„é…è‰²è§„èŒƒã€‚</p>
<p>å…ˆç¡®ä¿åœ¨build.gradleä¸­å¼•å…¥äº†Material Componentsä¾èµ–ï¼ˆå¦‚æœè¿˜æ²¡å¼•å…¥çš„è¯ï¼‰ï¼š</p>
<pre><code class="hljs language-groovy" lang="groovy">// Moduleçº§åˆ«çš„build.gradle
 dependencies {
     implementation 'com.google.android.material:material:1.12.0'
 }
 
</code></pre>
<p>ç„¶åä¿®æ”¹styles.xmlä¸­çš„ä¸»é¢˜é…ç½®ï¼š</p>
<pre><code class="hljs language-xml" lang="xml">// res/values/styles.xml

     <span class="hljs-comment">&lt;!-- åŸºç¡€ä¸»é¢˜ï¼šç»§æ‰¿Materialçš„DayNightä¸»é¢˜ --&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"AppTheme"</span> <span class="hljs-attr">parent</span>=<span class="hljs-string">"Theme.MaterialComponents.DayNight.NoActionBar"</span>&amp;<span class="hljs-attr">gt</span>;
         &lt;!<span class="hljs-attr">--</span> <span class="hljs-attr">ä¸»é¢˜å±æ€§é…ç½®</span>ï¼š<span class="hljs-attr">ä¸è¦ç¡¬ç¼–ç é¢œè‰²</span>ï¼ <span class="hljs-attr">--</span>&gt;</span><span class="xml">
         <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"colorPrimary"</span>&gt;</span>?attr/colorPrimary<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
         <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"colorPrimaryDark"</span>&gt;</span>?attr/colorPrimaryDark<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
         <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"colorAccent"</span>&gt;</span>?attr/colorAccent<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
         <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"android:windowBackground"</span>&gt;</span>?android:attr/colorBackground<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
     </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>

 
</code></pre>
<p>è¿™é‡Œè¦é‡ç‚¹æé†’ï¼š<strong>ç»å¯¹ä¸è¦åœ¨ä¸»é¢˜ä¸­ç¡¬ç¼–ç é¢œè‰²</strong>ï¼ˆæ¯”å¦‚ç›´æ¥å†™#FFFFFFã€#000000ï¼‰ã€‚ä¸Šé¢çš„?attr/xxxæ˜¯ä¸»é¢˜å±æ€§å¼•ç”¨ï¼Œç³»ç»Ÿä¼šæ ¹æ®å½“å‰æ¨¡å¼è‡ªåŠ¨åŒ¹é…å¯¹åº”çš„é¢œè‰²å€¼ï¼Œè¿™æ˜¯é€‚é…çš„æ ¸å¿ƒå‰æã€‚</p>
<h3 data-id="heading-4">æ­¥éª¤2ï¼šåˆ›å»ºæš—é»‘æ¨¡å¼ä¸“å±èµ„æºç›®å½•</h3>
<p>Androidé€šè¿‡"èµ„æºé™å®šç¬¦"æ¥åŒºåˆ†ä¸åŒæ¨¡å¼çš„èµ„æºã€‚å¯¹äºæš—é»‘æ¨¡å¼ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºå¸¦æœ‰**-night**åç¼€çš„èµ„æºç›®å½•ï¼ŒæŠŠæš—é»‘æ¨¡å¼ä¸‹çš„èµ„æºæ”¾åœ¨é‡Œé¢ã€‚</p>
<p>å¸¸è§çš„éœ€è¦é€‚é…çš„èµ„æºåŒ…æ‹¬ï¼šé¢œè‰²ï¼ˆcolors.xmlï¼‰ã€å›¾ç‰‡ï¼ˆdrawableï¼‰ã€å¸ƒå±€ï¼ˆlayoutï¼Œä¸€èˆ¬ä¸éœ€è¦ï¼Œé™¤éå¸ƒå±€ç»“æ„æœ‰å·®å¼‚ï¼‰ã€å­—ç¬¦ä¸²ï¼ˆstrings.xmlï¼Œæå°‘æ•°åœºæ™¯éœ€è¦ï¼‰ã€‚</p>
<p>åˆ›å»ºç›®å½•çš„è§„åˆ™å¾ˆç®€å•ï¼šåœ¨resç›®å½•ä¸‹ï¼Œå¤åˆ¶åŸæœ‰çš„èµ„æºç›®å½•ï¼Œæ·»åŠ -nightåç¼€ã€‚æ¯”å¦‚ï¼š</p>
<ul>
<li>æµ…è‰²æ¨¡å¼é¢œè‰²ï¼šres/values/colors.xml</li>
<li>æš—é»‘æ¨¡å¼é¢œè‰²ï¼šres/values-night/colors.xml</li>
<li>æµ…è‰²æ¨¡å¼å›¾ç‰‡ï¼šres/drawable/icon_home.xml</li>
<li>æš—é»‘æ¨¡å¼å›¾ç‰‡ï¼šres/drawable-night/icon_home.xml</li>
</ul>
<p>æ³¨æ„ï¼šä¸¤ä¸ªç›®å½•ä¸‹çš„èµ„æºæ–‡ä»¶åå¿…é¡»å®Œå…¨ä¸€è‡´ï¼Œç³»ç»Ÿæ‰èƒ½æ­£ç¡®åŒ¹é…ã€‚æ¯”å¦‚åœ¨values/colors.xmlä¸­å®šä¹‰äº†color_bg_mainï¼Œåœ¨values-night/colors.xmlä¸­ä¹Ÿå¿…é¡»å®šä¹‰åŒåçš„color_bg_mainï¼Œåªæ˜¯é¢œè‰²å€¼ä¸åŒã€‚</p>
<h3 data-id="heading-5">æ­¥éª¤3ï¼šåœ¨å¸ƒå±€ä¸­ä½¿ç”¨ä¸»é¢˜å±æ€§æˆ–èµ„æºå¼•ç”¨</h3>
<p>åˆ›å»ºå¥½èµ„æºåï¼Œåœ¨å¸ƒå±€æ–‡ä»¶ä¸­å¼•ç”¨è¿™äº›èµ„æºï¼Œè€Œä¸æ˜¯ç›´æ¥å†™æ­»é¢œè‰²ã€‚è¿™æ ·ç³»ç»Ÿåˆ‡æ¢æ¨¡å¼æ—¶ï¼Œä¼šè‡ªåŠ¨åŠ è½½å¯¹åº”ç›®å½•ä¸‹çš„èµ„æºã€‚</p>
<pre><code class="hljs language-xml" lang="xml">// æ­£ç¡®ç¤ºä¾‹ï¼šå¼•ç”¨èµ„æºæˆ–ä¸»é¢˜å±æ€§
 <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
     <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
     <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
     <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/color_bg_main"</span>  &lt;!<span class="hljs-attr">--</span> <span class="hljs-attr">å¼•ç”¨é¢œè‰²èµ„æº</span> <span class="hljs-attr">--</span>&gt;</span>
     android:orientation="vertical"&gt;
 
     <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
         <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
         <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span>
         <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/app_name"</span>
         <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"?attr/textColorPrimary"</span>  &lt;!<span class="hljs-attr">--</span> <span class="hljs-attr">å¼•ç”¨ä¸»é¢˜å±æ€§</span> <span class="hljs-attr">--</span>&gt;</span>
         android:textSize="20sp"/&gt;
 
 <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
 
</code></pre>
<p>å¯¹åº”çš„é¢œè‰²èµ„æºæ–‡ä»¶ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml">// res/values/colors.xmlï¼ˆæµ…è‰²æ¨¡å¼ï¼‰
 <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">color</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"color_bg_main"</span>&amp;<span class="hljs-attr">gt</span>;#<span class="hljs-attr">FFFFFF</span>&amp;<span class="hljs-attr">lt</span>;/<span class="hljs-attr">color</span>&amp;<span class="hljs-attr">gt</span>;  &lt;!<span class="hljs-attr">--</span> <span class="hljs-attr">ç™½è‰²èƒŒæ™¯</span> <span class="hljs-attr">--</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">color</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"color_text_main"</span>&amp;<span class="hljs-attr">gt</span>;#<span class="hljs-attr">333333</span>&amp;<span class="hljs-attr">lt</span>;/<span class="hljs-attr">color</span>&amp;<span class="hljs-attr">gt</span>;  &lt;!<span class="hljs-attr">--</span> <span class="hljs-attr">æ·±ç°è‰²æ–‡å­—</span> <span class="hljs-attr">--</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span>
 
 // res/values-night/colors.xmlï¼ˆæš—é»‘æ¨¡å¼ï¼‰
 <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">color</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"color_bg_main"</span>&gt;</span>#121212<span class="hljs-tag">&lt;/<span class="hljs-name">color</span>&gt;</span>  <span class="hljs-comment">&lt;!-- æ·±é»‘è‰²èƒŒæ™¯ --&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">color</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"color_text_main"</span>&gt;</span>#E0E0E0<span class="hljs-symbol">&amp;lt;</span>/color<span class="hljs-symbol">&amp;gt;</span>  <span class="hljs-comment">&lt;!-- æµ…ç°è‰²æ–‡å­— --&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span>
</code></pre>
<p>åˆ°è¿™é‡Œï¼ŒåŸºç¡€çš„æš—é»‘æ¨¡å¼é€‚é…å°±å®Œæˆäº†ã€‚è¿è¡Œåº”ç”¨ååˆ‡æ¢ç³»ç»Ÿä¸»é¢˜ï¼Œä½ ä¼šå‘ç°ç•Œé¢ä¼šè‡ªåŠ¨è·Ÿç€åˆ‡æ¢æ˜æš—é¢œè‰²ã€‚æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿä½†è¿™åªæ˜¯å…¥é—¨ï¼ŒçœŸæ­£çš„éš¾ç‚¹åœ¨åé¢çš„ç»†èŠ‚ä¼˜åŒ–ã€‚</p>
<h2 data-id="heading-6">ä¸‰ã€è¿›é˜¶ä¼˜åŒ–ï¼šä»"èƒ½ç”¨"åˆ°"å¥½ç”¨"çš„å…³é”®ç»†èŠ‚</h2>
<p>ä¸å°‘å¼€å‘è€…åšåˆ°ä¸Šé¢ä¸‰æ­¥å°±è§‰å¾—å®Œäº‹äº†ï¼Œä½†ç”¨æˆ·ç”¨èµ·æ¥è¿˜æ˜¯åæ§½ä¸æ–­ã€‚é—®é¢˜å°±å‡ºåœ¨ç»†èŠ‚ä¸Šã€‚ä¸‹é¢è¿™äº›è¿›é˜¶æŠ€å·§ï¼Œèƒ½è®©ä½ çš„æš—é»‘æ¨¡å¼ä½“éªŒé£™å‡ä¸€ä¸ªæ¡£æ¬¡ã€‚</p>
<h3 data-id="heading-7">1. é¢œè‰²é€‚é…ï¼šéµå¾ª"å¯¹æ¯”åº¦ä¼˜å…ˆ"åŸåˆ™</h3>
<p>æš—é»‘æ¨¡å¼ä¸æ˜¯"é»‘è‰²èƒŒæ™¯+ç™½è‰²æ–‡å­—"çš„ç®€å•ç»„åˆï¼Œå…³é”®æ˜¯è¦ä¿è¯æ–‡å­—å’ŒèƒŒæ™¯çš„<strong>å¯¹æ¯”åº¦è¶³å¤Ÿé«˜</strong>ï¼Œå¦åˆ™ç”¨æˆ·ä¼šçœ‹å¾—å¾ˆè´¹åŠ²ã€‚æ ¹æ®WCAGï¼ˆWebå†…å®¹æ— éšœç¢æŒ‡å—ï¼‰ï¼Œæ­£æ–‡æ–‡å­—ä¸èƒŒæ™¯çš„å¯¹æ¯”åº¦è‡³å°‘è¦è¾¾åˆ°4.5:1ï¼Œæ ‡é¢˜æ–‡å­—è‡³å°‘è¦è¾¾åˆ°3:1ã€‚</p>
<p>è¿™é‡Œæ¨èå‡ ä¸ªå®ç”¨çš„é¢œè‰²æ­é…æ–¹æ¡ˆï¼ˆäº²æµ‹ä¸ä¼šè¸©å‘ï¼‰ï¼š</p>
<ul>
<li>èƒŒæ™¯è‰²ï¼š#121212ï¼ˆæ·±é»‘ï¼‰ã€#1E1E1Eï¼ˆæµ…é»‘ï¼‰ï¼Œé¿å…ç”¨çº¯é»‘#000000ï¼Œä¼šè®©æ–‡å­—æ˜¾å¾—è¿‡äºåˆºçœ¼ï¼›</li>
<li>æ­£æ–‡æ–‡å­—ï¼š#E0E0E0ï¼ˆæµ…ç°ï¼‰ã€#FFFFFFï¼ˆç™½è‰²ï¼‰ï¼Œå¯¹æ¯”åº¦è¶³å¤Ÿä¸”ä¸åˆºçœ¼ï¼›</li>
<li>è¾…åŠ©æ–‡å­—ï¼š#9E9E9Eï¼ˆä¸­ç°ï¼‰ï¼Œç”¨äºæç¤ºæ€§æ–‡å­—ï¼Œå¯¹æ¯”åº¦é€‚ä¸­ï¼›</li>
<li>å¼ºè°ƒè‰²ï¼šä¿æŒå’Œæµ…è‰²æ¨¡å¼ä¸€è‡´çš„å¼ºè°ƒè‰²ï¼ˆå¦‚è“è‰²#2196F3ï¼‰ï¼Œæ—¢èƒ½çªå‡ºé‡ç‚¹ï¼Œåˆèƒ½ä¿è¯è§†è§‰ä¸€è‡´æ€§ã€‚</li>
</ul>
<p>å¦å¤–ï¼ŒMaterial Design 3æä¾›äº†ä¸€å¥—å®Œæ•´çš„æš—é»‘æ¨¡å¼é…è‰²ç³»ç»Ÿï¼Œæ¨èç›´æ¥å¤ç”¨ï¼šé€šè¿‡?attr/colorSurfaceï¼ˆè¡¨é¢è‰²ï¼‰ã€?attr/colorOnSurfaceï¼ˆè¡¨é¢æ–‡å­—è‰²ï¼‰ç­‰å±æ€§ï¼Œèƒ½å¿«é€Ÿå®ç°ç¬¦åˆè§„èŒƒçš„é…è‰²ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml">// åœ¨ä¸»é¢˜ä¸­è‡ªå®šä¹‰Material 3é…è‰²
 <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"AppTheme"</span> <span class="hljs-attr">parent</span>=<span class="hljs-string">"Theme.MaterialComponents.DayNight.NoActionBar"</span>&gt;</span><span class="xml">
     <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"colorSurface"</span>&gt;</span>@color/surface<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"colorOnSurface"</span>&gt;</span>@color/on_surface<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"colorPrimary"</span>&gt;</span>@color/primary<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"colorOnPrimary"</span>&gt;</span>@color/on_primary<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
 </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
 
 // res/values/colors.xml
 <span class="hljs-tag">&lt;<span class="hljs-name">color</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"surface"</span>&gt;</span>#FFFFFF<span class="hljs-tag">&lt;/<span class="hljs-name">color</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">color</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"on_surface"</span>&gt;</span>#121212<span class="hljs-tag">&lt;/<span class="hljs-name">color</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">color</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"primary"</span>&gt;</span>#2196F3<span class="hljs-tag">&lt;/<span class="hljs-name">color</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">color</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"on_primary"</span>&gt;</span>#FFFFFF<span class="hljs-tag">&lt;/<span class="hljs-name">color</span>&gt;</span>
 
 // res/values-night/colors.xml
 <span class="hljs-tag">&lt;<span class="hljs-name">color</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"surface"</span>&gt;</span>#121212<span class="hljs-tag">&lt;/<span class="hljs-name">color</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">color</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"on_surface"</span>&gt;</span>#E0E0E0<span class="hljs-tag">&lt;/<span class="hljs-name">color</span>&gt;</span>
 <span class="hljs-symbol">&amp;lt;</span>color name="primary"<span class="hljs-symbol">&amp;gt;</span>#64B5F6<span class="hljs-symbol">&amp;lt;</span>/color<span class="hljs-symbol">&amp;gt;</span>  <span class="hljs-comment">&lt;!-- æš—é»‘æ¨¡å¼ä¸‹å¯ç¨å¾®è°ƒäº®å¼ºè°ƒè‰² --&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">color</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"on_primary"</span>&gt;</span>#000000<span class="hljs-tag">&lt;/<span class="hljs-name">color</span>&gt;</span>
 
</code></pre>
<h3 data-id="heading-8">2. å›¾ç‰‡ä¸å›¾æ ‡é€‚é…ï¼šé¿å…"ç™½å›¾æ ‡å˜é»‘åº•"çš„å°´å°¬</h3>
<p>å¾ˆå¤šåº”ç”¨åœ¨æµ…è‰²æ¨¡å¼ä¸‹ç”¨çš„æ˜¯é»‘è‰²å›¾æ ‡ï¼Œåˆ‡æ¢åˆ°æš—é»‘æ¨¡å¼åï¼Œå›¾æ ‡å°±å’Œé»‘è‰²èƒŒæ™¯"èä¸ºä¸€ä½“"ï¼Œç”¨æˆ·æ ¹æœ¬çœ‹ä¸è§ã€‚è¿™æ—¶å€™å°±éœ€è¦ä¸ºæš—é»‘æ¨¡å¼å‡†å¤‡ä¸“å±çš„å›¾æ ‡èµ„æºã€‚</p>
<p>æ¨èä¸¤ç§é€‚é…æ–¹æ¡ˆï¼Œæ ¹æ®åœºæ™¯é€‰æ‹©ï¼š</p>
<h4 data-id="heading-9">æ–¹æ¡ˆ1ï¼šä½¿ç”¨çŸ¢é‡å›¾ï¼ˆSVGï¼‰+ tintç€è‰²</h4>
<p>è¿™æ˜¯æœ€æ¨èçš„æ–¹æ¡ˆï¼ŒçŸ¢é‡å›¾ä½“ç§¯å°ã€ä¸å¤±çœŸï¼Œè¿˜èƒ½é€šè¿‡tintå±æ€§åŠ¨æ€ç€è‰²ã€‚æˆ‘ä»¬åªéœ€è¦å‡†å¤‡ä¸€ä»½çŸ¢é‡å›¾ï¼Œç„¶ååœ¨å¸ƒå±€ä¸­é€šè¿‡?attr/colorControlNormalå±æ€§ç»™å›¾æ ‡ç€è‰²ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ ¹æ®ä¸»é¢˜åˆ‡æ¢é¢œè‰²ã€‚</p>
<pre><code class="hljs language-xml" lang="xml">// å¸ƒå±€ä¸­çš„ImageViewé…ç½®
 <span class="hljs-tag">&lt;<span class="hljs-name">ImageView</span>
     <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"24dp"</span>
     <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"24dp"</span>
     <span class="hljs-attr">android:src</span>=<span class="hljs-string">"@drawable/ic_home"</span>  &lt;!<span class="hljs-attr">--</span> <span class="hljs-attr">çŸ¢é‡å›¾èµ„æº</span> <span class="hljs-attr">--</span>&gt;</span>
     android:tint="?attr/colorControlNormal"/<span class="hljs-symbol">&amp;gt;</span>  <span class="hljs-comment">&lt;!-- ä¸»é¢˜è‰²ç€è‰² --&gt;</span>
 
</code></pre>
<p>è¿™æ ·ä¸€æ¥ï¼Œæµ…è‰²æ¨¡å¼ä¸‹å›¾æ ‡æ˜¯é»‘è‰²ï¼Œæš—é»‘æ¨¡å¼ä¸‹æ˜¯ç™½è‰²ï¼Œæ— éœ€å‡†å¤‡ä¸¤ä»½å›¾æ ‡èµ„æºï¼Œçœå¿ƒåˆé«˜æ•ˆã€‚</p>
<h4 data-id="heading-10">æ–¹æ¡ˆ2ï¼šåˆ›å»ºdrawable-nightç›®å½•å­˜æ”¾ä¸“å±å›¾æ ‡</h4>
<p>å¦‚æœæ˜¯ä½å›¾ï¼ˆPNG/JPGï¼‰ï¼Œå°±éœ€è¦åˆ›å»ºres/drawable-nightç›®å½•ï¼ŒæŠŠæš—é»‘æ¨¡å¼ä¸‹çš„å›¾æ ‡æ”¾è¿›å»ã€‚æ³¨æ„å›¾æ ‡æ–‡ä»¶åè¦å’Œdrawableç›®å½•ä¸‹çš„ä¸€è‡´ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åŒ¹é…ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<ul>
<li>æµ…è‰²æ¨¡å¼å›¾æ ‡ï¼šres/drawable/ic_setting.pngï¼ˆé»‘è‰²ï¼‰</li>
<li>æš—é»‘æ¨¡å¼å›¾æ ‡ï¼šres/drawable-night/ic_setting.pngï¼ˆç™½è‰²ï¼‰</li>
</ul>
<p>æç¤ºï¼šå°½é‡ä½¿ç”¨çŸ¢é‡å›¾ï¼Œå‡å°‘APKä½“ç§¯ï¼Œä¹Ÿé¿å…å¤šå¥—ä½å›¾èµ„æºçš„ç»´æŠ¤æˆæœ¬ã€‚</p>
<h3 data-id="heading-11">3. åº”ç”¨å†…ä¸»é¢˜åˆ‡æ¢ï¼šç»™ç”¨æˆ·è‡ªä¸»é€‰æ‹©çš„æƒåˆ©</h3>
<p>é™¤äº†è·Ÿéšç³»ç»Ÿä¸»é¢˜ï¼Œå¾ˆå¤šåº”ç”¨è¿˜ä¼šæä¾›"æµ…è‰²/æš—é»‘/è·Ÿéšç³»ç»Ÿ"çš„è‡ªä¸»åˆ‡æ¢é€‰é¡¹ï¼ˆæ¯”å¦‚å¾®ä¿¡ã€çŸ¥ä¹ï¼‰ã€‚è¿™éœ€è¦æˆ‘ä»¬åœ¨åº”ç”¨å†…å®ç°ä¸»é¢˜åˆ‡æ¢é€»è¾‘ï¼Œè¿˜å¾—æŠŠç”¨æˆ·çš„é€‰æ‹©æŒä¹…åŒ–å­˜å‚¨ï¼ˆæ¯”å¦‚SharedPreferencesï¼‰ï¼Œä¸‹æ¬¡å¯åŠ¨æ—¶æ¢å¤ç”¨æˆ·çš„è®¾ç½®ã€‚</p>
<p>å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<h4 data-id="heading-12">ç¬¬ä¸€æ­¥ï¼šå®šä¹‰ä¸»é¢˜åˆ‡æ¢é€‰é¡¹å¯¹åº”çš„æ¨¡å¼</h4>
<p>AppCompatæä¾›äº†å››ç§å¤œé—´æ¨¡å¼ï¼Œå¯¹åº”æˆ‘ä»¬çš„åˆ‡æ¢é€‰é¡¹ï¼š</p>
<ul>
<li>MODE_NIGHT_NOï¼šå¼ºåˆ¶æµ…è‰²æ¨¡å¼ï¼›</li>
<li>MODE_NIGHT_YESï¼šå¼ºåˆ¶æ·±è‰²æ¨¡å¼ï¼›</li>
<li>MODE_NIGHT_FOLLOW_SYSTEMï¼šè·Ÿéšç³»ç»Ÿï¼ˆé»˜è®¤ï¼‰ï¼›</li>
<li>MODE_NIGHT_AUTO_BATTERYï¼šä½ç”µé‡æ—¶è‡ªåŠ¨å¼€å¯æš—é»‘æ¨¡å¼ã€‚</li>
</ul>
<h4 data-id="heading-13">ç¬¬äºŒæ­¥ï¼šå®ç°åˆ‡æ¢é€»è¾‘ä¸æŒä¹…åŒ–å­˜å‚¨</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä¸»é¢˜å·¥å…·ç±»ï¼šå¤„ç†åˆ‡æ¢å’ŒæŒä¹…åŒ–</span>
 <span class="hljs-keyword">object</span> ThemeUtils {
     <span class="hljs-comment">// å­˜å‚¨ç”¨æˆ·é€‰æ‹©çš„ä¸»é¢˜æ¨¡å¼ï¼Œkeyä¸º"night_mode"</span>
     <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> KEY_NIGHT_MODE = <span class="hljs-string">"night_mode"</span>
     <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> sharedPreferences <span class="hljs-keyword">by</span> lazy {
         AppContext.context.getSharedPreferences(<span class="hljs-string">"app_settings"</span>, Context.MODE_PRIVATE)
     }
 
     <span class="hljs-comment">// åˆå§‹åŒ–ä¸»é¢˜ï¼šå¯åŠ¨åº”ç”¨æ—¶è°ƒç”¨</span>
     <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initTheme</span><span class="hljs-params">()</span></span> {
         <span class="hljs-keyword">val</span> mode = sharedPreferences.getInt(KEY_NIGHT_MODE, AppCompatDelegate.MODE_NIGHT_FOLLOW_SYSTEM)
         AppCompatDelegate.setDefaultNightMode(mode)
     }
 
     <span class="hljs-comment">// åˆ‡æ¢ä¸»é¢˜</span>
     <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">switchTheme</span><span class="hljs-params">(mode: <span class="hljs-type">Int</span>)</span></span> {
         <span class="hljs-comment">// ä¿å­˜ä¸»é¢˜æ¨¡å¼åˆ°SP</span>
         sharedPreferences.edit().putInt(KEY_NIGHT_MODE, mode).apply()
         <span class="hljs-comment">// è®¾ç½®ä¸»é¢˜æ¨¡å¼</span>
         AppCompatDelegate.setDefaultNightMode(mode)
         <span class="hljs-comment">// é‡å¯Activityä»¥åº”ç”¨ä¸»é¢˜ï¼ˆå¯é€‰ï¼Œæ ¹æ®éœ€æ±‚è°ƒæ•´ï¼‰</span>
         AppContext.context.startActivity(
             Intent(AppContext.context, MainActivity::<span class="hljs-keyword">class</span>.java).apply {
                 addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP or Intent.FLAG_ACTIVITY_NEW_TASK)
             }
         )
     }
 }
 
</code></pre>
<h4 data-id="heading-14">ç¬¬ä¸‰æ­¥ï¼šåœ¨Activityä¸­è°ƒç”¨åˆ‡æ¢æ–¹æ³•</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç¤ºä¾‹ï¼šè®¾ç½®é¡µé¢çš„åˆ‡æ¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶</span>
 btnLight.setOnClickListener {
     ThemeUtils.switchTheme(AppCompatDelegate.MODE_NIGHT_NO)
 }
 
 btnDark.setOnClickListener {
     ThemeUtils.switchTheme(AppCompatDelegate.MODE_NIGHT_YES)
 }
 
 btnFollowSystem.setOnClickListener {
     ThemeUtils.switchTheme(AppCompatDelegate.MODE_NIGHT_FOLLOW_SYSTEM)
 }
 
</code></pre>
<p>æ³¨æ„ï¼šä»AppCompat v1.1.0å¼€å§‹ï¼ŒsetDefaultNightMode()ä¼šè‡ªåŠ¨é‡å»ºå·²å¯åŠ¨çš„Activityï¼Œæ‰€ä»¥æœ‰æ—¶å€™ä¸éœ€è¦æ‰‹åŠ¨é‡å¯ã€‚ä½†å¦‚æœæœ‰ç‰¹æ®Šéœ€æ±‚ï¼ˆæ¯”å¦‚ä¿å­˜é¡µé¢çŠ¶æ€ï¼‰ï¼Œå¯ä»¥æ‰‹åŠ¨å¤„ç†é‡å¯é€»è¾‘ï¼Œå¹¶é€šè¿‡onSaveInstanceState()ä¿å­˜æ•°æ®ã€‚</p>
<h2 data-id="heading-15">å››ã€ç‰¹æ®Šåœºæ™¯é€‚é…ï¼šè¿™äº›å‘åƒä¸‡åˆ«è¸©</h2>
<p>é™¤äº†å¸¸è§„çš„ç•Œé¢é€‚é…ï¼Œè¿˜æœ‰å‡ ä¸ªç‰¹æ®Šåœºæ™¯å®¹æ˜“è¢«å¿½ç•¥ï¼Œä¸€æ—¦è¸©å‘å°±ä¼šä¸¥é‡å½±å“ç”¨æˆ·ä½“éªŒã€‚ä¸‹é¢é€ä¸ªè®²è§£è§£å†³æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-16">1. å¯åŠ¨é¡µï¼ˆSplashï¼‰é€‚é…ï¼šé¿å…"ç™½å±é—ªä¸€ä¸‹"</h3>
<p>å¾ˆå¤šåº”ç”¨çš„å¯åŠ¨é¡µæ˜¯é€šè¿‡WindowBackgroundè®¾ç½®çš„å›¾ç‰‡æˆ–é¢œè‰²ã€‚å¦‚æœå¯åŠ¨é¡µçš„é¢œè‰²æ˜¯ç¡¬ç¼–ç çš„ç™½è‰²ï¼Œé‚£ä¹ˆåœ¨æš—é»‘æ¨¡å¼ä¸‹å¯åŠ¨åº”ç”¨æ—¶ï¼Œä¼šå…ˆé—ªä¸€ä¸‹ç™½è‰²çš„å¯åŠ¨é¡µï¼Œå†åˆ‡æ¢åˆ°æš—é»‘æ¨¡å¼çš„ç•Œé¢ï¼Œéå¸¸çªå…€ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼šå¯åŠ¨é¡µçš„èƒŒæ™¯ä¸è¦ç¡¬ç¼–ç ï¼Œä½¿ç”¨ä¸»é¢˜å±æ€§?android:attr/colorBackgroundã€‚</p>
<pre><code class="hljs language-xml" lang="xml">// å¯åŠ¨é¡µçš„ä¸»é¢˜ï¼ˆåœ¨styles.xmlä¸­å®šä¹‰ï¼‰
 <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"SplashTheme"</span> <span class="hljs-attr">parent</span>=<span class="hljs-string">"Theme.MaterialComponents.DayNight.NoActionBar"</span>&gt;</span><span class="xml">
     <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"android:windowBackground"</span>&gt;</span>?android:attr/colorBackground<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>  <span class="hljs-comment">&lt;!-- ä½¿ç”¨ä¸»é¢˜èƒŒæ™¯è‰² --&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"android:windowFullscreen"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
 </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
 
 // åœ¨AndroidManifest.xmlä¸­ç»™å¯åŠ¨Activityè®¾ç½®ä¸»é¢˜
 <span class="hljs-tag">&lt;<span class="hljs-name">activity</span>
     <span class="hljs-attr">android:name</span>=<span class="hljs-string">".SplashActivity"</span>
     <span class="hljs-attr">android:theme</span>=<span class="hljs-string">"@style/SplashTheme"</span>&gt;</span>
     <span class="hljs-tag">&lt;<span class="hljs-name">intent-filter</span>&gt;</span>
         <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.action.MAIN"</span>/&gt;</span>
         <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.category.LAUNCHER"</span>/&gt;</span>
     <span class="hljs-tag">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span>
 <span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span>
 
</code></pre>
<p>å¦‚æœå¯åŠ¨é¡µç”¨çš„æ˜¯å›¾ç‰‡ï¼Œå°±éœ€è¦åˆ›å»ºdrawable-nightç›®å½•ï¼Œæ”¾ç½®æš—é»‘æ¨¡å¼ä¸‹çš„å¯åŠ¨é¡µå›¾ç‰‡ï¼Œç¡®ä¿å¯åŠ¨é¡µå’Œåº”ç”¨ä¸»é¢˜ä¿æŒä¸€è‡´ã€‚</p>
<h3 data-id="heading-17">2. WebViewé€‚é…ï¼šè®©ç½‘é¡µä¹Ÿèƒ½è·Ÿç€å˜æš—</h3>
<p>å¦‚æœåº”ç”¨ä¸­æœ‰WebViewåŠ è½½ç½‘é¡µï¼Œé»˜è®¤æƒ…å†µä¸‹ç½‘é¡µä¸ä¼šè·Ÿéšç³»ç»Ÿä¸»é¢˜å˜æš—ï¼Œä¼šå‡ºç°"åº”ç”¨æ˜¯æš—é»‘æ¨¡å¼ï¼Œç½‘é¡µæ˜¯æµ…è‰²æ¨¡å¼"çš„å‰²è£‚æ„Ÿã€‚è§£å†³æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼š</p>
<h4 data-id="heading-18">æ–¹æ¡ˆ1ï¼šä½¿ç”¨WebViewçš„forceDarkåŠŸèƒ½ï¼ˆAndroid 10+ï¼‰</h4>
<p>Android 10åŠä»¥ä¸Šç‰ˆæœ¬ï¼ŒWebViewæ”¯æŒforceDarkåŠŸèƒ½ï¼Œèƒ½è‡ªåŠ¨æŠŠæµ…è‰²ç½‘é¡µè½¬æ¢æˆæš—é»‘æ¨¡å¼ã€‚åªéœ€åœ¨ä»£ç ä¸­å¼€å¯å³å¯ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.Q) {
     webView.settings.forceDark = WebSettings.FORCE_DARK_ON
     <span class="hljs-comment">// å¯é€‰ï¼šè®¾ç½®æš—é»‘æ¨¡å¼çš„å¯¹æ¯”åº¦</span>
     webView.settings.forceDarkStrategy = WebSettings.DARK_STRATEGY_WEB_THEME_DARKEN
 }
 
</code></pre>
<h4 data-id="heading-19">æ–¹æ¡ˆ2ï¼šè‡ªå®šä¹‰æš—é»‘æ¨¡å¼CSS</h4>
<p>å¦‚æœéœ€è¦å…¼å®¹æ›´ä½ç‰ˆæœ¬ï¼Œæˆ–è€…æƒ³è®©ç½‘é¡µæš—é»‘æ¨¡å¼æ›´ç¾è§‚ï¼Œå¯ä»¥åœ¨ç½‘é¡µä¸­æ·»åŠ æš—é»‘æ¨¡å¼çš„CSSï¼Œç„¶åé€šè¿‡Androidä»£ç åˆ¤æ–­å½“å‰ä¸»é¢˜ï¼Œæ³¨å…¥å¯¹åº”çš„CSSæ ·å¼ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åˆ¤æ–­å½“å‰æ˜¯å¦ä¸ºæš—é»‘æ¨¡å¼</span>
 <span class="hljs-keyword">val</span> isDarkMode = resources.configuration.uiMode and Configuration.UI_MODE_NIGHT_MASK == Configuration.UI_MODE_NIGHT_YES
 
 <span class="hljs-comment">// åŠ è½½ç½‘é¡µæ—¶æ³¨å…¥CSS</span>
 webView.webViewClient = <span class="hljs-keyword">object</span> : WebViewClient() {
     <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onPageFinished</span><span class="hljs-params">(view: <span class="hljs-type">WebView</span>?, url: <span class="hljs-type">String</span>?)</span></span> {
         <span class="hljs-keyword">super</span>.onPageFinished(view, url)
         <span class="hljs-keyword">val</span> css = <span class="hljs-keyword">if</span> (isDarkMode) {
             <span class="hljs-comment">// æš—é»‘æ¨¡å¼CSSï¼šè®¾ç½®èƒŒæ™¯è‰²å’Œæ–‡å­—è‰²</span>
             <span class="hljs-string">"javascript:(function() { "</span> +
                     <span class="hljs-string">"document.body.style.backgroundColor = '#121212'; "</span> +
                     <span class="hljs-string">"document.body.style.color = '#E0E0E0'; "</span> +
                     <span class="hljs-string">"})()"</span>
         } <span class="hljs-keyword">else</span> {
             <span class="hljs-comment">// æµ…è‰²æ¨¡å¼CSS</span>
             <span class="hljs-string">"javascript:(function() { "</span> +
                     <span class="hljs-string">"document.body.style.backgroundColor = '#FFFFFF'; "</span> +
                     <span class="hljs-string">"document.body.style.color = '#333333'; "</span> +
                     <span class="hljs-string">"})()"</span>
         }
         webView.evaluateJavascript(css, <span class="hljs-literal">null</span>)
     }
 }
 
</code></pre>
<h3 data-id="heading-20">3. é€šçŸ¥ä¸Widgeté€‚é…ï¼šåˆ«è®©é€šçŸ¥æˆä¸º"è§†è§‰å¼‚ç±»"</h3>
<p>é€šçŸ¥å’Œæ¡Œé¢Widgetæ˜¯åœ¨åº”ç”¨å¤–éƒ¨æ˜¾ç¤ºçš„ï¼Œä¹Ÿéœ€è¦é€‚é…æš—é»‘æ¨¡å¼ï¼Œå¦åˆ™åœ¨æš—é»‘æ¨¡å¼ä¸‹ä¼šå‡ºç°"ç™½è‰²é€šçŸ¥æ¡†+é»‘è‰²æ–‡å­—"çš„åˆºçœ¼ç»„åˆã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>é€šçŸ¥ï¼šå°½é‡ä½¿ç”¨ç³»ç»Ÿæä¾›çš„é€šçŸ¥æ¨¡æ¿ï¼ˆå¦‚MessagingStyleã€BigTextStyleï¼‰ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨é€‚é…æš—é»‘æ¨¡å¼ã€‚é¿å…è‡ªå®šä¹‰é€šçŸ¥å¸ƒå±€ï¼Œå¦‚æœå¿…é¡»è‡ªå®šä¹‰ï¼Œè¦ä½¿ç”¨ä¸»é¢˜å±æ€§è®¾ç½®é¢œè‰²ï¼Œä¸è¦ç¡¬ç¼–ç ã€‚</li>
<li>Widgetï¼šåœ¨Widgetçš„å¸ƒå±€ä¸­ä½¿ç”¨ä¸»é¢˜å±æ€§ï¼ˆå¦‚?attr/textColorPrimaryã€?attr/colorBackgroundï¼‰ï¼Œç¡®ä¿æ–‡å­—å’ŒèƒŒæ™¯é¢œè‰²èƒ½è·Ÿéšä¸»é¢˜åˆ‡æ¢ã€‚</li>
</ul>
<pre><code class="hljs language-xml" lang="xml">// Widgetå¸ƒå±€ç¤ºä¾‹ï¼ˆä½¿ç”¨ä¸»é¢˜å±æ€§ï¼‰
 <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
     <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
     <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
     <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
     <span class="hljs-attr">android:background</span>=<span class="hljs-string">"?attr/colorBackground"</span>
     <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"vertical"</span>&gt;</span>
 
     <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
         <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/widget_title"</span>
         <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
         <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span>
         <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"?attr/textColorPrimary"</span>
         <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"16sp"</span>/&gt;</span>
 
 <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
 
</code></pre>
<h2 data-id="heading-21">äº”ã€å¸¸è§é—®é¢˜æ’æŸ¥ï¼šè§£å†³é€‚é…ä¸­çš„"ç–‘éš¾æ‚ç—‡"</h2>
<p>é€‚é…è¿‡ç¨‹ä¸­éš¾å…ä¼šé‡åˆ°å„ç§é—®é¢˜ï¼Œä¸‹é¢åˆ—ä¸¾å‡ ä¸ªæœ€å¸¸è§çš„å‘ï¼Œä»¥åŠå¯¹åº”çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-22">1. åˆ‡æ¢ä¸»é¢˜æ—¶é—ªé»‘/é—ªç™½</h3>
<p>é—®é¢˜åŸå› ï¼šåˆ‡æ¢ä¸»é¢˜æ—¶ç³»ç»Ÿä¼šé‡å»ºActivityï¼Œé‡å»ºè¿‡ç¨‹ä¸­ä¼šçŸ­æš‚æ˜¾ç¤ºWindowçš„èƒŒæ™¯è‰²ï¼Œå¦‚æœèƒŒæ™¯è‰²å’Œå½“å‰ä¸»é¢˜ä¸åŒ¹é…ï¼Œå°±ä¼šå‡ºç°é—ªå±ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>ç¡®ä¿æ‰€æœ‰Activityçš„ä¸»é¢˜éƒ½ç»§æ‰¿è‡ªDayNightä¸»é¢˜ï¼Œä¸”WindowBackgroundä½¿ç”¨ä¸»é¢˜å±æ€§ï¼›</li>
<li>åœ¨AndroidManifest.xmlä¸­ç»™Activityæ·»åŠ android:configChanges="uiMode"ï¼Œé¿å…ç³»ç»Ÿè‡ªåŠ¨é‡å»ºï¼Œç„¶ååœ¨Activityä¸­é‡å†™onConfigurationChanged()æ–¹æ³•ï¼Œæ‰‹åŠ¨æ›´æ–°UIï¼›</li>
</ul>
<h3 data-id="heading-23">2. éƒ¨åˆ†è§†å›¾æ²¡æœ‰è·Ÿéšä¸»é¢˜åˆ‡æ¢</h3>
<p>é—®é¢˜åŸå› ï¼šå¤§æ¦‚ç‡æ˜¯åœ¨ä»£ç ä¸­ç¡¬ç¼–ç äº†é¢œè‰²ï¼Œæˆ–è€…æ²¡æœ‰ä½¿ç”¨ä¸»é¢˜å±æ€§/èµ„æºå¼•ç”¨ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>å…¨å±€æœç´¢ä»£ç ä¸­çš„ç¡¬ç¼–ç é¢œè‰²ï¼ˆå¦‚#FFFFFFã€#000000ï¼‰ï¼Œå…¨éƒ¨æ›¿æ¢ä¸ºä¸»é¢˜å±æ€§æˆ–èµ„æºå¼•ç”¨ï¼›</li>
<li>æ£€æŸ¥æ˜¯å¦æ‰€æœ‰èµ„æºéƒ½åœ¨values-nightç›®å½•ä¸‹æœ‰å¯¹åº”çš„æš—é»‘æ¨¡å¼ç‰ˆæœ¬ï¼›</li>
<li>å¦‚æœæ˜¯åŠ¨æ€åˆ›å»ºçš„è§†å›¾ï¼Œç¡®ä¿åœ¨åˆ›å»ºæ—¶ä½¿ç”¨ä¸»é¢˜å±æ€§è·å–é¢œè‰²ï¼š</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ­£ç¡®ç¤ºä¾‹ï¼šä»ä¸»é¢˜ä¸­è·å–é¢œè‰²</span>
 <span class="hljs-keyword">val</span> textColor = ThemeUtils.getColor(context, android.R.attr.textColorPrimary)
 textView.setTextColor(textColor)
 
 <span class="hljs-comment">// å·¥å…·ç±»æ–¹æ³•</span>
 <span class="hljs-keyword">object</span> ThemeUtils {
     <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getColor</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>, attr: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> {
         <span class="hljs-keyword">val</span> typedValue = TypedValue()
         context.theme.resolveAttribute(attr, typedValue, <span class="hljs-literal">true</span>)
         <span class="hljs-keyword">return</span> typedValue.<span class="hljs-keyword">data</span>
     }
 }
 
</code></pre>
<h3 data-id="heading-24">3. Force DarkåŠŸèƒ½ä¸ç”Ÿæ•ˆ</h3>
<p>é—®é¢˜åŸå› ï¼šForce Darkæ˜¯Android 10æä¾›çš„"ä¸€é”®æš—é»‘"åŠŸèƒ½ï¼Œé€‚ç”¨äºæ²¡æœ‰é€‚é…DayNightä¸»é¢˜çš„åº”ç”¨ï¼Œä½†æœ‰å‡ ä¸ªå‰ææ¡ä»¶ï¼š</p>
<ul>
<li>åº”ç”¨ä¸»é¢˜å¿…é¡»æ˜¯æµ…è‰²ä¸»é¢˜ï¼ˆå¦‚Theme.Material.Lightï¼‰ï¼›</li>
<li>å¿…é¡»åœ¨ä¸»é¢˜ä¸­è®¾ç½®android:forceDarkAllowed="true"ï¼›</li>
<li>å¦‚æœåº”ç”¨å·²ç»ç»§æ‰¿äº†DayNightä¸»é¢˜ï¼ŒForce Darkä¼šè‡ªåŠ¨å¤±æ•ˆï¼ˆå› ä¸ºDayNightå·²ç»å®ç°äº†æš—é»‘æ¨¡å¼ï¼‰ã€‚</li>
</ul>
<p>è§£å†³æ–¹æ¡ˆï¼šå¦‚æœéœ€è¦ä½¿ç”¨Force Darkï¼Œç¡®ä¿ä¸»é¢˜æ˜¯æµ…è‰²ä¸”å¼€å¯äº†forceDarkAllowedï¼›å¦‚æœå·²ç»é€‚é…äº†DayNightä¸»é¢˜ï¼Œå°±ä¸éœ€è¦å†ä½¿ç”¨Force Darkäº†ã€‚</p>
<h2 data-id="heading-25">å…­ã€è¿›é˜¶ä¼˜åŒ–ï¼šè®©æš—é»‘æ¨¡å¼æ›´æè‡´çš„å°æŠ€å·§</h2>
<p>å¦‚æœæƒ³è®©ä½ çš„æš—é»‘æ¨¡å¼ä½“éªŒæ›´ä¸Šä¸€å±‚æ¥¼ï¼Œå¯ä»¥è¯•è¯•ä¸‹é¢è¿™äº›å°æŠ€å·§ï¼š</p>
<h3 data-id="heading-26">1. åŠ¨æ€è°ƒæ•´å›¾ç‰‡äº®åº¦</h3>
<p>å¯¹äºä¸€äº›æ²¡æœ‰é€‚é…æš—é»‘æ¨¡å¼çš„å›¾ç‰‡ï¼ˆæ¯”å¦‚ç”¨æˆ·å¤´åƒã€ç½‘ç»œå›¾ç‰‡ï¼‰ï¼Œå¯ä»¥åœ¨æš—é»‘æ¨¡å¼ä¸‹é€‚å½“é™ä½å›¾ç‰‡äº®åº¦ï¼Œé¿å…å›¾ç‰‡è¿‡äº®åˆºçœ¼ã€‚å¯ä»¥é€šè¿‡ColorMatrixè°ƒæ•´å›¾ç‰‡çš„äº®åº¦ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">adjustImageBrightness</span><span class="hljs-params">(imageView: <span class="hljs-type">ImageView</span>, isDarkMode: <span class="hljs-type">Boolean</span>)</span></span> {
     <span class="hljs-keyword">if</span> (isDarkMode) {
         <span class="hljs-keyword">val</span> matrix = ColorMatrix()
         matrix.setSaturation(<span class="hljs-number">0.8f</span>)  <span class="hljs-comment">// é™ä½é¥±å’Œåº¦</span>
         matrix.setScale(<span class="hljs-number">0.9f</span>, <span class="hljs-number">0.9f</span>, <span class="hljs-number">0.9f</span>, <span class="hljs-number">1f</span>)  <span class="hljs-comment">// é™ä½äº®åº¦</span>
         imageView.colorFilter = ColorMatrixColorFilter(matrix)
     } <span class="hljs-keyword">else</span> {
         imageView.colorFilter = <span class="hljs-literal">null</span>  <span class="hljs-comment">// æ¢å¤æ­£å¸¸</span>
     }
 }
 
</code></pre>
<h3 data-id="heading-27">2. é€‚é…æ·±è‰²æ¨¡å¼ä¸‹çš„çŠ¶æ€æ </h3>
<p>åœ¨æš—é»‘æ¨¡å¼ä¸‹ï¼ŒçŠ¶æ€æ çš„é¢œè‰²ä¹Ÿåº”è¯¥è·Ÿç€è°ƒæ•´ï¼Œé¿å…å‡ºç°"ç™½è‰²çŠ¶æ€æ +é»‘è‰²æ–‡å­—"çš„å‰²è£‚æ„Ÿã€‚å¯ä»¥é€šè¿‡ä»£ç åŠ¨æ€è®¾ç½®çŠ¶æ€æ é¢œè‰²å’Œæ–‡å­—é¢œè‰²ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setStatusBarTheme</span><span class="hljs-params">(activity: <span class="hljs-type">Activity</span>, isDarkMode: <span class="hljs-type">Boolean</span>)</span></span> {
     <span class="hljs-keyword">val</span> window = activity.window
     <span class="hljs-comment">// è®¾ç½®çŠ¶æ€æ èƒŒæ™¯è‰²</span>
     window.statusBarColor = ThemeUtils.getColor(activity, android.R.attr.colorBackground)
     <span class="hljs-comment">// è®¾ç½®çŠ¶æ€æ æ–‡å­—é¢œè‰²ï¼ˆtrueï¼šé»‘è‰²æ–‡å­—ï¼›falseï¼šç™½è‰²æ–‡å­—ï¼‰</span>
     ViewCompat.getWindowInsetsController(window.decorView)?.apply {
         isAppearanceLightStatusBars = !isDarkMode
     }
 }
 
</code></pre>
<h3 data-id="heading-28">3. æµ‹è¯•å·¥å…·æ¨è</h3>
<p>é€‚é…å®Œæˆåï¼Œä¸€å®šè¦åšå¥½æµ‹è¯•ã€‚æ¨èä¸¤ä¸ªå®ç”¨çš„æµ‹è¯•å·¥å…·ï¼š</p>
<ul>
<li>Android Studioçš„Layout Inspectorï¼šå¯ä»¥å®æ—¶æŸ¥çœ‹è§†å›¾çš„é¢œè‰²ã€èµ„æºå¼•ç”¨ï¼Œå¿«é€Ÿå®šä½ç¡¬ç¼–ç é—®é¢˜ï¼›</li>
<li>Accessibility Scannerï¼ˆæ— éšœç¢æ‰«æå™¨ï¼‰ï¼šå¯ä»¥æ£€æµ‹æ–‡å­—å¯¹æ¯”åº¦æ˜¯å¦è¾¾æ ‡ï¼Œå¸®åŠ©ä¼˜åŒ–æ— éšœç¢ä½“éªŒã€‚</li>
</ul>
<h2 data-id="heading-29">ä¸ƒã€æ€»ç»“ï¼šæš—é»‘æ¨¡å¼é€‚é…çš„æ ¸å¿ƒè¦ç‚¹</h2>
<p>å…¶å®æš—é»‘æ¨¡å¼é€‚é…çš„æ ¸å¿ƒå°±ä¸‰ä»¶äº‹ï¼š<strong>ä¸ç¡¬ç¼–ç é¢œè‰²ã€ç”¨å¯¹ä¸»é¢˜å±æ€§ã€åšå¥½èµ„æºåŒ¹é…</strong>ã€‚ä»åŸºç¡€çš„ç»§æ‰¿DayNightä¸»é¢˜ï¼Œåˆ°è¿›é˜¶çš„åº”ç”¨å†…åˆ‡æ¢å’Œç‰¹æ®Šåœºæ™¯é€‚é…ï¼Œåªè¦ä¸€æ­¥æ­¥è·Ÿç€åšï¼Œå°±èƒ½åšå‡ºä½“éªŒä¼˜ç§€çš„æš—é»‘æ¨¡å¼ã€‚</p>
<p>æœ€åå†å¼ºè°ƒå‡ ä¸ªå…³é”®ç‚¹ï¼š</p>
<ul>
<li>ä¼˜å…ˆä½¿ç”¨Material Designçš„ä¸»é¢˜å±æ€§ï¼Œå‡å°‘è‡ªå®šä¹‰é¢œè‰²çš„æˆæœ¬ï¼›</li>
<li>æ‰€æœ‰èµ„æºéƒ½è¦åšå¥½"æµ…è‰²/æš—é»‘"åŒç‰ˆæœ¬å‡†å¤‡ï¼Œå°¤å…¶æ˜¯é¢œè‰²å’Œå›¾æ ‡ï¼›</li>
<li>åˆ‡æ¢ä¸»é¢˜æ—¶è¦å¤„ç†å¥½Activityé‡å»ºå’ŒçŠ¶æ€ä¿å­˜ï¼Œé¿å…é—ªå±å’Œæ•°æ®ä¸¢å¤±ï¼›</li>
<li>ä¸€å®šè¦æµ‹è¯•ç‰¹æ®Šåœºæ™¯ï¼ˆå¯åŠ¨é¡µã€WebViewã€é€šçŸ¥ã€Widgetï¼‰ï¼Œé¿å…å‡ºç°"è§†è§‰å¼‚ç±»"ã€‚</li>
</ul>
<p>åšå¥½æš—é»‘æ¨¡å¼é€‚é…ï¼Œä¸ä»…èƒ½æå‡ç”¨æˆ·ä½“éªŒï¼Œè¿˜èƒ½ä½“ç°å¼€å‘è€…çš„ç»†èŠ‚æŠŠæ§èƒ½åŠ›ã€‚å¸Œæœ›è¿™ç¯‡å…¨æ”»ç•¥èƒ½å¸®ä½ é¡ºåˆ©æå®šé€‚é…å·¥ä½œï¼Œè®©ä½ çš„åº”ç”¨åœ¨æ·±å¤œä¹Ÿèƒ½ç»™ç”¨æˆ·å¸¦æ¥èˆ’é€‚çš„ä½¿ç”¨ä½“éªŒï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Swift æ–°å¹¶å‘æ¡†æ¶ä¹‹ async/await]]></title>    <link>https://juejin.cn/post/7587349016221810729</link>    <guid>https://juejin.cn/post/7587349016221810729</guid>    <pubDate>2025-12-25T02:26:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587349016221810729" data-draft-id="7587368168621834246" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Swift æ–°å¹¶å‘æ¡†æ¶ä¹‹ async/await"/> <meta itemprop="keywords" content="iOS"/> <meta itemprop="datePublished" content="2025-12-25T02:26:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çš‡ä¸Šo_O"/> <meta itemprop="url" content="https://juejin.cn/user/4177799913409303"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Swift æ–°å¹¶å‘æ¡†æ¶ä¹‹ async/await
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4177799913409303/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çš‡ä¸Šo_O
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T02:26:46.000Z" title="Thu Dec 25 2025 02:26:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. ä¸ºä»€ä¹ˆéœ€è¦ async/await</h2>
<p>åœ¨ç§»åŠ¨å¼€å‘é‡Œï¼Œâ€œå¹¶å‘/å¼‚æ­¥â€å‡ ä¹æ— å¤„ä¸åœ¨ï¼šç½‘ç»œè¯·æ±‚ã€å›¾ç‰‡ä¸‹è½½ã€æ–‡ä»¶è¯»å†™ã€æ•°æ®åº“æ“ä½œâ€¦â€¦å®ƒä»¬éƒ½æœ‰ä¸€ä¸ªå…±åŒç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>è€—æ—¶</strong>ï¼ˆå¦‚æœä½ åœ¨ä¸»çº¿ç¨‹é‡Œæ­»ç­‰ï¼Œä¼šå¡ UIï¼‰</li>
<li><strong>ç»“æœç¨åæ‰å›æ¥</strong>ï¼ˆä½ å¿…é¡»ç”¨æŸç§æ–¹å¼â€œæ‹¿åˆ°ç»“æœâ€ï¼‰</li>
</ul>
<p>ä¼ ç»Ÿçš„å¹¶å‘æ¨¡å‹å¤§å¤šæ˜¯â€œå›è°ƒå¼â€çš„ï¼šç”¨ <code>completion</code>ã€delegateã€é€šçŸ¥ç­‰åœ¨æœªæ¥æŸä¸ªæ—¶é—´ç‚¹æŠŠç»“æœäº¤è¿˜ç»™ä½ ã€‚
è¿™å¥—æ–¹æ¡ˆèƒ½è·‘ï¼Œä½†ä¼šå¸¦æ¥ä¸¤ä¸ªå…¸å‹æŒ‘æˆ˜ï¼ˆä½ å‚è€ƒèµ„æ–™é‡Œä¹Ÿç‚¹å‡ºæ¥äº†ï¼‰ï¼š</p>
<ol>
<li><strong>ä»£ç ç»´æŠ¤æ€§å·®</strong>ï¼šå¼‚æ­¥å›è°ƒè®©ä»£ç é˜…è¯»â€œè·³æ¥è·³å»â€ï¼Œä¸çº¿æ€§</li>
<li><strong>å®¹æ˜“å‡ºç°æ•°æ®ç«äº‰ï¼ˆData Racesï¼‰</strong>ï¼šå…±äº«å¯å˜çŠ¶æ€åœ¨å¹¶å‘ä¸‹å¾ˆå®¹æ˜“å‡º Bugï¼Œè€Œä¸”éš¾å¤ç°ã€éš¾æ’æŸ¥</li>
</ol>
<p>Swift ä» <strong>5.5</strong> å¼€å§‹å¼•å…¥æ–°å¹¶å‘æ¡†æ¶ï¼Œ<code>async/await</code> å…ˆè§£å†³ç¬¬ä¸€ä¸ªæ ¸å¿ƒç—›ç‚¹ï¼š<strong>è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç ä¸€æ ·é¡ºç•…</strong>ï¼Œå¹¶ä¸”æŠŠé”™è¯¯å¤„ç†å˜å¾—æ›´è‡ªç„¶ã€‚</p>
<hr/>
<h2 data-id="heading-1">2. å…ˆå¤ä¹  4 ä¸ªåŸºç¡€æ¦‚å¿µ</h2>
<h3 data-id="heading-2">2.1 åŒæ­¥ vs å¼‚æ­¥ï¼ˆæè¿°â€œå‡½æ•°æ€ä¹ˆè¿”å›â€ï¼‰</h3>
<ul>
<li><strong>åŒæ­¥ï¼ˆSynchronousï¼‰</strong>ï¼šå‡½æ•°æ‰§è¡Œå®Œæ‰è¿”å›
ä¾‹å­ï¼š<code>let x = add(1, 2)</code>ï¼Œæ‹¿åˆ°ç»“æœæ‰èƒ½å¾€ä¸‹èµ°</li>
<li><strong>å¼‚æ­¥ï¼ˆAsynchronousï¼‰</strong>ï¼šå‡½æ•°æŠŠä»»åŠ¡â€œä¸¢å‡ºå»â€ï¼Œ<strong>ç»“æœä»¥åå†ç»™ä½ </strong>
æ‰€ä»¥ä½ å¿…é¡»ç”¨ <code>completion</code> / delegate / async/await ç­‰æ–¹å¼æ‹¿ç»“æœ</li>
</ul>
<h3 data-id="heading-3">2.2 ä¸²è¡Œ vs å¹¶è¡Œ/å¹¶å‘ï¼ˆæè¿°â€œä¸€ç»„ä»»åŠ¡æ€ä¹ˆè·‘â€ï¼‰</h3>
<ul>
<li><strong>ä¸²è¡Œï¼ˆSerialï¼‰</strong>ï¼šä¸€æ¬¡åªæ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œå®Œæˆä¸€ä¸ªå†ä¸‹ä¸€ä¸ª</li>
<li><strong>å¹¶å‘/å¹¶è¡Œï¼ˆConcurrent/Parallelï¼‰</strong>ï¼šåŒä¸€æ®µæ—¶é—´å†…å¯èƒ½æ‰§è¡Œå¤šä¸ªä»»åŠ¡
ï¼ˆæœ¬æ–‡ä¸ä¸¥æ ¼åŒºåˆ†å¹¶å‘ä¸å¹¶è¡Œï¼›ä½ åªè¦çŸ¥é“ï¼šä¼šâ€œåŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡â€å°±è¡Œï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-4">3. å›è°ƒå¼å¼‚æ­¥çš„å…¸å‹ç—›ç‚¹ï¼šå›è°ƒåœ°ç‹± + é”™è¯¯å¤„ç†éš¾çœ‹</h2>
<p>ç”¨â€œå¤´åƒåŠ è½½â€æ¥è¯´æ˜ï¼š
æ­¥éª¤ï¼šæ‹¿ URL â†’ ä¸‹è½½æ•°æ®ï¼ˆåŠ å¯†ï¼‰â†’ è§£å¯† â†’ è§£ç æˆå›¾ç‰‡</p>
<h3 data-id="heading-5">3.1 å›è°ƒåœ°ç‹±ï¼ˆCallback Hellï¼‰</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AvatarLoader</span> {
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">loadAvatar</span>(<span class="hljs-params">token</span>: <span class="hljs-type">String</span>, <span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">UIImage</span>) -&gt; <span class="hljs-type">Void</span>) {
        fetchAvatarURL(token: token) { url <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">self</span>.fetchAvatar(url: url) { data <span class="hljs-keyword">in</span>
                <span class="hljs-keyword">self</span>.decryptAvatar(data: data) { data <span class="hljs-keyword">in</span>
                    <span class="hljs-keyword">self</span>.decodeImage(data: data) { image <span class="hljs-keyword">in</span>
                        completion(image)
                    }
                }
            }
        }
    }

    <span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchAvatarURL</span>(<span class="hljs-params">token</span>: <span class="hljs-type">String</span>, <span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">String</span>) -&gt; <span class="hljs-type">Void</span>) { <span class="hljs-comment">/* ... */</span> }
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchAvatar</span>(<span class="hljs-params">url</span>: <span class="hljs-type">String</span>, <span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">Data</span>) -&gt; <span class="hljs-type">Void</span>) { <span class="hljs-comment">/* ... */</span> }
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">decryptAvatar</span>(<span class="hljs-params">data</span>: <span class="hljs-type">Data</span>, <span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">Data</span>) -&gt; <span class="hljs-type">Void</span>) { <span class="hljs-comment">/* ... */</span> }
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">decodeImage</span>(<span class="hljs-params">data</span>: <span class="hljs-type">Data</span>, <span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">UIImage</span>) -&gt; <span class="hljs-type">Void</span>) { <span class="hljs-comment">/* ... */</span> }
}
</code></pre>
<p>é˜…è¯»ä½“éªŒåƒåœ¨â€œèµ°è¿·å®«â€ï¼šä½ è¦ä¸åœåœ°è¿›å›è°ƒã€å‡ºå›è°ƒï¼Œè„‘å­è¦åŒæ—¶è®°ä½å¾ˆå¤šä¸Šä¸‹æ–‡ã€‚</p>
<h3 data-id="heading-6">3.2 é”™è¯¯å¤„ç†ä¼šè®©ä»£ç æ›´ç³Ÿ</h3>
<p>å¼‚æ­¥å›è°ƒå¸¸è§çš„å†™æ³•æ˜¯ <code>completion(value, error)</code> æˆ–è€… <code>Result</code>ã€‚
ä½†åœ¨å¤šå±‚åµŒå¥—é‡Œï¼Œé”™è¯¯ä¼ é€’ä¼šè¶Šæ¥è¶Šå•°å—¦ï¼Œæ¼æ‰æŸä¸ªåˆ†æ”¯çš„ <code>completion</code> ä¹Ÿå¾ˆå¸¸è§ã€‚</p>
<hr/>
<h2 data-id="heading-7">4. async/await çš„æ ¸å¿ƒï¼šæŠŠâ€œå¼‚æ­¥ä»£ç â€å†™æˆâ€œçº¿æ€§ä»£ç â€</h2>
<h3 data-id="heading-8">4.1 å…ˆçœ‹æ•ˆæœï¼šä¸€çœ¼å°±èƒ½è¯»æ‡‚</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AvatarLoader</span> {
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">loadAvatar</span>(<span class="hljs-params">token</span>: <span class="hljs-type">String</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">UIImage</span> {
        <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> fetchAvatarURL(token: token)
        <span class="hljs-keyword">let</span> encryptedData <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> fetchAvatar(url: url)
        <span class="hljs-keyword">let</span> decryptedData <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> decryptAvatar(data: encryptedData)
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> decodeImage(data: decryptedData)
    }

    <span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchAvatarURL</span>(<span class="hljs-params">token</span>: <span class="hljs-type">String</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">String</span> { <span class="hljs-comment">/* ... */</span> }
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchAvatar</span>(<span class="hljs-params">url</span>: <span class="hljs-type">String</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">Data</span> { <span class="hljs-comment">/* ... */</span> }
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">decryptAvatar</span>(<span class="hljs-params">data</span>: <span class="hljs-type">Data</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">Data</span> { <span class="hljs-comment">/* ... */</span> }
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">decodeImage</span>(<span class="hljs-params">data</span>: <span class="hljs-type">Data</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">UIImage</span> { <span class="hljs-comment">/* ... */</span> }
}
</code></pre>
<p>ä½ ä¼šå‘ç°ï¼š</p>
<ul>
<li>ä»£ç åƒåŒæ­¥ä¸€æ ·ä»ä¸Šåˆ°ä¸‹æ‰§è¡Œï¼ˆâ€œç›´çº¿å¼â€ï¼‰</li>
<li>é”™è¯¯å¤„ç†å›åˆ°äº†ç†Ÿæ‚‰çš„ <code>throws + try + do/catch</code></li>
<li>é€»è¾‘æ¸…æ™°ã€å¯ç»´æŠ¤æ€§å¤§å¹…æå‡</li>
</ul>
<hr/>
<h2 data-id="heading-9">5. è¯­æ³•è§„åˆ™ï¼šä½ åªéœ€è¦æŒæ¡è¿™ 3 æ¡</h2>
<h3 data-id="heading-10">5.1 <code>async</code>ï¼šå£°æ˜â€œè¿™ä¸ªå‡½æ•°å¯èƒ½ä¼šæŒ‚èµ·â€</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">fetch</span>() <span class="hljs-keyword">async</span> -&gt; <span class="hljs-type">Int</span> { <span class="hljs-number">42</span> }
</code></pre>
<p>å«ä¹‰ï¼šå®ƒæ˜¯â€œå¼‚æ­¥å‡½æ•°â€ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­<strong>å¯èƒ½æš‚åœ</strong>ï¼ˆæŒ‚èµ·ï¼‰ï¼Œç­‰å¾…æŸäº›äº‹æƒ…å®Œæˆï¼ˆæ¯”å¦‚ç½‘ç»œè¿”å›ã€IO å®Œæˆï¼‰ã€‚</p>
<h3 data-id="heading-11">5.2 <code>await</code>ï¼šè°ƒç”¨ async å‡½æ•°æ—¶å¿…é¡»å†™</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">let</span> value <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> fetch()
</code></pre>
<p><code>await</code> è¡¨ç¤ºï¼šè¿™é‡Œæ˜¯ä¸€ä¸ª<strong>æ½œåœ¨æŒ‚èµ·ç‚¹</strong>ï¼ˆpotential suspension pointï¼‰ã€‚
æ„æ€æ˜¯ï¼šè¿è¡Œåˆ°è¿™é‡Œï¼Œå¯èƒ½ä¼šâ€œå…ˆåœä¸€ä¸‹â€ï¼Œç­‰ç»“æœå‡†å¤‡å¥½å†ç»§ç»­å¾€ä¸‹èµ°ã€‚</p>
<h3 data-id="heading-12">5.3 <code>await</code> åªèƒ½å‡ºç°åœ¨â€œå¼‚æ­¥ä¸Šä¸‹æ–‡â€é‡Œ</h3>
<p>å¼‚æ­¥ä¸Šä¸‹æ–‡ä¸»è¦æœ‰ä¸¤ç±»ï¼š</p>
<ol>
<li><strong>async å‡½æ•°ä½“å†…éƒ¨</strong></li>
<li><strong>Task é—­åŒ…å†…éƒ¨</strong></li>
</ol>
<hr/>
<h2 data-id="heading-13">6. ä¸€ä¸ªå…³é”®è®¤çŸ¥ï¼šæŒ‚èµ·çš„æ˜¯â€œå‡½æ•°â€ï¼Œä¸æ˜¯â€œçº¿ç¨‹â€</h2>
<p>è¿™æ˜¯å¾ˆå¤šæ–°æ‰‹æœ€å®¹æ˜“è¯¯è§£çš„åœ°æ–¹ï¼š</p>
<ul>
<li><code>await</code> <strong>ä¸æ˜¯</strong>â€œæŠŠå½“å‰çº¿ç¨‹å¡ä½ç­‰å¾…â€</li>
<li>å®ƒæ˜¯â€œæŠŠå½“å‰å‡½æ•°æŒ‚èµ·â€ï¼Œè®©å‡ºæ‰§è¡Œæƒ</li>
<li>ç­‰æ¡ä»¶æ»¡è¶³åï¼Œå†æ¢å¤æ‰§è¡Œï¼ˆæ¢å¤æ—¶<strong>å¯èƒ½æ¢äº†çº¿ç¨‹</strong>ï¼‰</li>
</ul>
<p>ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆï¼š</p>
<blockquote>
<p>ä½ åœ¨æ’é˜Ÿå–å·ï¼ˆawaitï¼‰ï¼Œä½ äººå¯ä»¥å…ˆç¦»å¼€å»åšåˆ«çš„ï¼ˆçº¿ç¨‹å»æ‰§è¡Œåˆ«çš„ä»»åŠ¡ï¼‰ï¼Œç­‰å«åˆ°ä½ å·äº†ä½ å†å›æ¥ç»§ç»­åŠç†ï¼ˆå‡½æ•°æ¢å¤æ‰§è¡Œï¼‰ã€‚</p>
</blockquote>
<p><strong>ç»“è®º</strong>ï¼šåœ¨ async/await çš„ä¸–ç•Œé‡Œï¼Œåˆ«å¼ºä¾èµ–â€œæˆ‘ç°åœ¨ä¸€å®šåœ¨æŸä¸ªçº¿ç¨‹ä¸Šâ€ã€‚</p>
<hr/>
<h2 data-id="heading-14">7. ä¸ºä»€ä¹ˆâ€œé” + awaitâ€å®¹æ˜“å‡ºäº‹ï¼šä¸€ä¸ªç»å…¸å‘</h2>
<p>ä¸€ä¸ªå¾ˆå…¸å‹çš„ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">let</span> lock <span class="hljs-operator">=</span> <span class="hljs-type">NSLock</span>()

<span class="hljs-keyword">func</span> <span class="hljs-title function_">test</span>() <span class="hljs-keyword">async</span> {
    lock.lock()
    <span class="hljs-keyword">try?</span> <span class="hljs-keyword">await</span> <span class="hljs-type">Task</span>.sleep(nanoseconds: <span class="hljs-number">1_000_000_000</span>)
    lock.unlock()
}

<span class="hljs-keyword">for</span> <span class="hljs-keyword">_</span> <span class="hljs-keyword">in</span> <span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span><span class="hljs-number">10</span> {
    <span class="hljs-type">Task</span> { <span class="hljs-keyword">await</span> test() }
}
</code></pre>
<p>é—®é¢˜åœ¨å“ªé‡Œï¼Ÿ</p>
<ul>
<li>åœ¨ <code>lock.lock()</code> åé‡åˆ°äº† <code>await</code></li>
<li>å‡½æ•°å¯èƒ½æŒ‚èµ·å¹¶å‘ç”Ÿçº¿ç¨‹åˆ‡æ¢</li>
<li>å…¶ä»–ä»»åŠ¡ä¹Ÿæƒ³æ‹¿é”ï¼Œä½†é”å¯èƒ½è¢«â€œæ‹¿ç€ä¸æ”¾â€</li>
<li>ç»“æœå°±æ˜¯ï¼šå¾ˆå®¹æ˜“å‡ºç°<strong>æ­»é”/é¥¥é¥¿</strong>ç­‰éš¾æ’æŸ¥é—®é¢˜</li>
</ul>
<p><strong>ç»éªŒæ³•åˆ™ï¼š</strong></p>
<blockquote>
<p>ä¸è¦åœ¨æŒæœ‰é”çš„æœŸé—´è·¨è¿‡ <code>await</code>ã€‚
å¦‚æœä½ éœ€è¦ä¿æŠ¤å…±äº«å¯å˜çŠ¶æ€ï¼Œä¼˜å…ˆè€ƒè™‘ <code>actor</code>æˆ–è®©çŠ¶æ€åªåœ¨å•ä¸€æ‰§è¡Œä¸Šä¸‹æ–‡é‡Œä¿®æ”¹ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-15">8. çœŸæ­£èƒ½ä¸Šæ‰‹çš„ä»£ç ï¼šç”¨ URLSession å†™ä¸€ä¸ª async ç½‘ç»œè¯·æ±‚</h2>
<p>iOS 15+ï¼ˆSwift 5.5+ï¼‰å¼€å§‹ï¼Œ<code>URLSession</code> å·²ç»æä¾›äº† async APIï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">let</span> (data, response) <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> <span class="hljs-type">URLSession</span>.shared.data(from: url)
</code></pre>
<p>æˆ‘ä»¬åšä¸€ä¸ªâ€œè·å–ç”¨æˆ·ä¿¡æ¯â€çš„ç¤ºä¾‹ï¼ˆåŒ…å«é”™è¯¯å¤„ç†ï¼‰ï¼š</p>
<h3 data-id="heading-16">8.1 å®šä¹‰æ¨¡å‹ä¸é”™è¯¯</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> Foundation

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">User</span>: <span class="hljs-title class_">Decodable</span> {
    <span class="hljs-keyword">let</span> id: <span class="hljs-type">Int</span>
    <span class="hljs-keyword">let</span> name: <span class="hljs-type">String</span>
}

<span class="hljs-keyword">enum</span> <span class="hljs-title class_">NetworkError</span>: <span class="hljs-title class_">Error</span> {
    <span class="hljs-keyword">case</span> invalidURL
    <span class="hljs-keyword">case</span> invalidResponse
    <span class="hljs-keyword">case</span> httpStatus(<span class="hljs-type">Int</span>)
}
</code></pre>
<h3 data-id="heading-17">8.2 å†™ä¸€ä¸ª async ç½‘ç»œå±‚</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">APIClient</span> {
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchUser</span>(<span class="hljs-params">id</span>: <span class="hljs-type">Int</span>) <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">User</span> {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: <span class="hljs-string">"https://example.com/users/<span class="hljs-subst">\(id)</span>"</span>) <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-type">NetworkError</span>.invalidURL
        }

        <span class="hljs-keyword">let</span> (data, response) <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> <span class="hljs-type">URLSession</span>.shared.data(from: url)

        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> http <span class="hljs-operator">=</span> response <span class="hljs-keyword">as?</span> <span class="hljs-type">HTTPURLResponse</span> <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-type">NetworkError</span>.invalidResponse
        }
        <span class="hljs-keyword">guard</span> (<span class="hljs-number">200</span><span class="hljs-operator">...</span><span class="hljs-number">299</span>).contains(http.statusCode) <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-type">NetworkError</span>.httpStatus(http.statusCode)
        }

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> <span class="hljs-type">JSONDecoder</span>().decode(<span class="hljs-type">User</span>.<span class="hljs-keyword">self</span>, from: data)
    }
}
</code></pre>
<p>è¿™ä¸€æ®µä»£ç çš„é˜…è¯»ä½“éªŒå°±æ˜¯â€œåŒæ­¥å¼â€çš„ï¼šæ„å»º URL â†’ await æ‹¿æ•°æ® â†’ æ ¡éªŒ â†’ decodeã€‚</p>
<hr/>
<h2 data-id="heading-18">9. åœ¨ UIViewController é‡Œæ€ä¹ˆè°ƒç”¨ async å¹¶æ›´æ–° UIï¼Ÿ</h2>
<p>è¿™æ˜¯ iOS å¼€å‘é‡Œæœ€å¸¸è§çš„è½åœ°é—®é¢˜ï¼š</p>
<blockquote>
<p>async æ–¹æ³•ä¸èƒ½ç›´æ¥åœ¨æ™®é€šå‡½æ•°é‡Œ <code>await</code>ï¼Œé‚£æˆ‘æ€ä¹ˆä»æŒ‰é’®ç‚¹å‡»é‡Œå‘è¯·æ±‚ï¼Ÿ</p>
</blockquote>
<p>ç­”æ¡ˆï¼šç”¨ <code>Task { }</code> æŠŠå®ƒæ”¾è¿›å¼‚æ­¥ä¸Šä¸‹æ–‡é‡Œã€‚</p>
<h3 data-id="heading-19">9.1 ç¤ºä¾‹ï¼šç‚¹å‡»æŒ‰é’®åŠ è½½ç”¨æˆ·å¹¶åˆ·æ–° label</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> UIKit

<span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserViewController</span>: <span class="hljs-title class_">UIViewController</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> api <span class="hljs-operator">=</span> <span class="hljs-type">APIClient</span>()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">let</span> label <span class="hljs-operator">=</span> <span class="hljs-type">UILabel</span>()

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {
        <span class="hljs-keyword">super</span>.viewDidLoad()
        view.backgroundColor <span class="hljs-operator">=</span> .white

        label.numberOfLines <span class="hljs-operator">=</span> <span class="hljs-number">0</span>
        label.frame <span class="hljs-operator">=</span> <span class="hljs-type">CGRect</span>(x: <span class="hljs-number">20</span>, y: <span class="hljs-number">100</span>, width: <span class="hljs-number">320</span>, height: <span class="hljs-number">200</span>)
        view.addSubview(label)

        loadUser()
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">loadUser</span>() {
        <span class="hljs-comment">// è¿›å…¥å¼‚æ­¥ä¸Šä¸‹æ–‡</span>
        <span class="hljs-type">Task</span> { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword">self</span> <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }

            <span class="hljs-keyword">do</span> {
                <span class="hljs-keyword">let</span> user <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> api.fetchUser(id: <span class="hljs-number">1</span>)

                <span class="hljs-comment">// æ›´æ–° UIï¼šå›åˆ°ä¸»çº¿ç¨‹ï¼ˆMainActorï¼‰</span>
                <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {
                    <span class="hljs-keyword">self</span>.label.text <span class="hljs-operator">=</span> <span class="hljs-string">"ç”¨æˆ·ï¼š<span class="hljs-subst">\(user.name)</span><span class="hljs-subst">\n</span>IDï¼š<span class="hljs-subst">\(user.id)</span>"</span>
                }

            } <span class="hljs-keyword">catch</span> {
                <span class="hljs-keyword">await</span> <span class="hljs-type">MainActor</span>.run {
                    <span class="hljs-keyword">self</span>.label.text <span class="hljs-operator">=</span> <span class="hljs-string">"åŠ è½½å¤±è´¥ï¼š<span class="hljs-subst">\(error)</span>"</span>
                }
            }
        }
    }
}
</code></pre>
<p>ä½ åªè¦è®°ä½ä¸€å¥è¯å°±å¤Ÿäº†ï¼š</p>
<ul>
<li><strong>è€—æ—¶å·¥ä½œ</strong>æ”¾åœ¨ <code>Task</code> é‡Œ <code>await</code></li>
<li><strong>UI æ›´æ–°</strong>æ”¾åœ¨ <code>MainActor</code>ï¼ˆä¸»çº¿ç¨‹è¯­ä¹‰ï¼‰é‡Œåš</li>
</ul>
<hr/>
<h2 data-id="heading-20">10. ä»æ—§ä»£ç è¿ç§»ï¼šæŠŠ completion å›è°ƒåŒ…è£…æˆ async</h2>
<p>å¾ˆå¤šé¡¹ç›®é‡Œå·²ç»æœ‰å¤§é‡å›è°ƒå¼ APIï¼Œä½ ä¸å¯èƒ½ä¸€å¤œä¹‹é—´å…¨æ”¹æ‰ã€‚Swift æä¾›äº†â€œç»­ä½“ï¼ˆContinuationï¼‰â€åšæ¡¥æ¥ã€‚</p>
<h3 data-id="heading-21">10.1 å‡è®¾ä½ æœ‰æ—§æ¥å£</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LegacyService</span> {
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchText</span>(<span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>, <span class="hljs-type">Error</span>&gt;) -&gt; <span class="hljs-type">Void</span>) {
        <span class="hljs-type">DispatchQueue</span>.global().asyncAfter(deadline: .now() <span class="hljs-operator">+</span> <span class="hljs-number">1</span>) {
            completion(.success(<span class="hljs-string">"hello async/await"</span>))
        }
    }
}
</code></pre>
<h3 data-id="heading-22">10.2 ç”¨ withCheckedThrowingContinuation åŒ…è£…</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">extension</span> <span class="hljs-title class_">LegacyService</span> {
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchText</span>() <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">String</span> {
        <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> withCheckedThrowingContinuation { continuation <span class="hljs-keyword">in</span>
            fetchText { result <span class="hljs-keyword">in</span>
                <span class="hljs-keyword">switch</span> result {
                <span class="hljs-keyword">case</span> .success(<span class="hljs-keyword">let</span> text):
                    continuation.resume(returning: text)
                <span class="hljs-keyword">case</span> .failure(<span class="hljs-keyword">let</span> error):
                    continuation.resume(throwing: error)
                }
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-23">10.3 ä½¿ç”¨æ–¹å¼</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-type">Task</span> {
    <span class="hljs-keyword">do</span> {
        <span class="hljs-keyword">let</span> text <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> <span class="hljs-type">LegacyService</span>().fetchText()
        <span class="hljs-built_in">print</span>(text)
    } <span class="hljs-keyword">catch</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"error:"</span>, error)
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-24">11. å…¥é—¨é˜¶æ®µçš„æœ€ä½³å®è·µæ¸…å•</h2>
<ol>
<li><strong>ä¸è¦åœ¨æŒé”æœŸé—´è·¨ <code>await</code></strong>ï¼ˆå®¹æ˜“æ­»é”/é€»è¾‘å¡ä½ï¼‰</li>
<li><strong>UI æ›´æ–°ç»Ÿä¸€å›åˆ° <code>MainActor</code></strong>ï¼ˆé¿å…ä¸»çº¿ç¨‹é—®é¢˜ï¼‰</li>
<li><strong>èƒ½ç”¨ <code>throws</code> å°±åˆ«ç”¨ Optional+error ä¹±ä¼ </strong>ï¼šé”™è¯¯è·¯å¾„æ›´æ¸…æ™°</li>
<li><strong>ä»å…¥å£å¤„å°±ç»“æ„åŒ–</strong>ï¼š<code>async</code> å‡½æ•°è°ƒç”¨ <code>async</code> å‡½æ•°ï¼Œåˆ«å±‚å±‚å›è°ƒ</li>
<li><strong>è¿ç§»æ—§ä»£ç ç”¨ Continuation</strong>ï¼šé€æ­¥æ”¹ï¼Œä¸è¦ä¸€æ¬¡æ€§é‡æ„åˆ°å´©</li>
</ol>
<hr/>
<h2 data-id="heading-25">12. å°ç»“</h2>
<p>åˆ°è¿™é‡Œï¼Œä½ å·²ç»å…·å¤‡äº† async/await çš„â€œå¯ç”¨çº§ç†è§£â€ï¼š</p>
<ul>
<li><code>async</code>ï¼šè¿™ä¸ªå‡½æ•°å¯èƒ½æŒ‚èµ·</li>
<li><code>await</code>ï¼šæ½œåœ¨æŒ‚èµ·ç‚¹ï¼Œåªèƒ½åœ¨å¼‚æ­¥ä¸Šä¸‹æ–‡ä½¿ç”¨</li>
<li>async/await è®©å¼‚æ­¥ä»£ç â€œçº¿æ€§å¯è¯»â€ï¼Œé”™è¯¯å¤„ç†å›åˆ° <code>throws</code></li>
<li>æŒ‚èµ·çš„æ˜¯å‡½æ•°ï¼Œä¸æ˜¯çº¿ç¨‹ï¼›<code>await</code> å‰åå¯èƒ½æ¢çº¿ç¨‹</li>
<li>iOS é‡Œç”¨ <code>Task {}</code> è¿›å…¥å¼‚æ­¥ä¸Šä¸‹æ–‡ï¼Œç”¨ <code>MainActor</code> æ›´æ–° UI</li>
<li>æ—§å›è°ƒæ¥å£å¯ä»¥ç”¨ <code>withCheckedThrowingContinuation</code> å¹³æ»‘è¿ç§»</li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Nextcloud Docker å®¹å™¨åŒ–éƒ¨ç½²æŒ‡å—]]></title>    <link>https://juejin.cn/post/7587299670642704390</link>    <guid>https://juejin.cn/post/7587299670642704390</guid>    <pubDate>2025-12-25T02:06:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587299670642704390" data-draft-id="7587329107303415871" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Nextcloud Docker å®¹å™¨åŒ–éƒ¨ç½²æŒ‡å—"/> <meta itemprop="keywords" content="Docker,æ•°æ®å¯è§†åŒ–,æ•°æ®åˆ†æ"/> <meta itemprop="datePublished" content="2025-12-25T02:06:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜è€èµµ"/> <meta itemprop="url" content="https://juejin.cn/user/3208848015890347"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Nextcloud Docker å®¹å™¨åŒ–éƒ¨ç½²æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3208848015890347/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜è€èµµ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T02:06:29.000Z" title="Thu Dec 25 2025 02:06:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">æ¦‚è¿°</h3>
<p>Nextcloud æ˜¯ä¸€æ¬¾å¼€æºçš„å®¹å™¨åŒ–åº”ç”¨ï¼Œä¸ºç”¨æˆ·æä¾›å®‰å…¨çš„æ•°æ®å­˜å‚¨ä¸ç®¡ç†è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒæ–‡ä»¶è®¿é—®ä¸å…±äº«ã€æ—¥å†ã€è”ç³»äººã€é‚®ä»¶ç­‰å¤šç§åŠŸèƒ½ï¼Œå¯ä»ä»»ä½•è®¾å¤‡è®¿é—®ï¼Œå®Œå…¨ç”±ç”¨æˆ·è‡ªä¸»æŒæ§ã€‚è¯¥Dockeré•œåƒç”±Nextcloudç¤¾åŒºå¼€å‘ç»´æŠ¤ï¼Œæ—¨åœ¨æä¾›è½»é‡çº§ã€å¯æ‰©å±•çš„éƒ¨ç½²æ–¹å¼ã€‚</p>
<p>æœ¬æ–‡æ¡£å°†è¯¦ç»†ä»‹ç»å¦‚ä½•é€šè¿‡Dockerå®¹å™¨åŒ–æ–¹å¼éƒ¨ç½² Nextcloud ï¼ŒåŒ…æ‹¬ç¯å¢ƒå‡†å¤‡ã€é•œåƒæ‹‰å–ã€å®¹å™¨é…ç½®ã€åŠŸèƒ½æµ‹è¯•åŠç”Ÿäº§ç¯å¢ƒä¼˜åŒ–å»ºè®®ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿæ­å»ºç¨³å®šå¯é çš„NEXTCLOUDæœåŠ¡ã€‚</p>
<h3 data-id="heading-1">ç¯å¢ƒå‡†å¤‡</h3>
<h4 data-id="heading-2">Dockerç¯å¢ƒå®‰è£…</h4>
<p>éƒ¨ç½² Nextcloud å®¹å™¨å‰ï¼Œéœ€å…ˆç¡®ä¿æœåŠ¡å™¨å·²å®‰è£…Dockerç¯å¢ƒã€‚æ¨èä½¿ç”¨ä»¥ä¸‹ä¸€é”®å®‰è£…è„šæœ¬ï¼Œé€‚ç”¨äºä¸»æµLinuxå‘è¡Œç‰ˆï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">bash</span> &lt;(wget -qO- <span class="hljs-attribute">https</span>:<span class="hljs-comment">//xuanyuan.cloud/docker.sh)</span>
</code></pre>
<p>è„šæœ¬æ‰§è¡Œè¿‡ç¨‹ä¸­éœ€æ ¹æ®æç¤ºå®Œæˆå¿…è¦é…ç½®ï¼Œå®‰è£…å®Œæˆåå¯é€šè¿‡<code>docker --version</code>å‘½ä»¤éªŒè¯Dockeræ˜¯å¦æ­£å¸¸å®‰è£…ã€‚</p>
<h3 data-id="heading-3">é•œåƒå‡†å¤‡</h3>
<h4 data-id="heading-4">æ‹‰å– Nextcloud é•œåƒ</h4>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é€šè¿‡è½©è¾•é•œåƒè®¿é—®æ”¯æŒåœ°å€æ‹‰å–æœ€æ–°ç‰ˆæœ¬çš„ Nextcloud é•œåƒï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">docker pull xxx.xuanyuan.run/library/nextcloud:latest
</code></pre>
<p>å¦‚éœ€æŸ¥çœ‹æ‰€æœ‰å¯ç”¨ç‰ˆæœ¬æ ‡ç­¾ï¼Œå¯è®¿é—® Nextcloud é•œåƒæ ‡ç­¾åˆ—è¡¨ <code>https://xuanyuan.cloud/r/library/nextcloud/tags</code>ã€‚</p>
<h3 data-id="heading-5">å®¹å™¨éƒ¨ç½²</h3>
<h4 data-id="heading-6">åŸºç¡€éƒ¨ç½²ï¼ˆé€‚ç”¨äºæµ‹è¯•ç¯å¢ƒï¼‰</h4>
<p>ä»¥ä¸‹å‘½ä»¤å°†åˆ›å»ºä¸€ä¸ªåŸºç¡€çš„ Nextcloud å®¹å™¨ï¼Œä½¿ç”¨é»˜è®¤é…ç½®å’ŒSQLiteæ•°æ®åº“ï¼Œé€‚åˆå¿«é€Ÿæµ‹è¯•ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">docker run -d \  --name nextcloud \  -p <span class="hljs-number">80</span>:<span class="hljs-number">80</span> \  -v nextcloud_data:/var/www/html \  xxx.xuanyuan.run/library/nextcloud:latest
</code></pre>
<p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p>
<ul>
<li>â€¢ <code>-d</code>ï¼šåå°è¿è¡Œå®¹å™¨</li>
<li>â€¢ <code>--name nextcloud</code>ï¼šæŒ‡å®šå®¹å™¨åç§°ä¸ºnextcloud</li>
<li>â€¢ <code>-p 80:80</code>ï¼šå°†å®¹å™¨80ç«¯å£æ˜ å°„åˆ°ä¸»æœº80ç«¯å£ï¼ˆç«¯å£é…ç½®è¯·å‚è€ƒ NEXTCLOUDé•œåƒæ–‡æ¡£ï¼ˆè½©è¾•ï¼‰ <code>https://xuanyuan.cloud/r/library/nextcloud</code>ï¼‰</li>
<li>â€¢ <code>-v nextcloud_data:/var/www/html</code>ï¼šåˆ›å»ºå‘½åå·<code>nextcloud_data</code>æŒ‚è½½åˆ°å®¹å™¨å†…<code>/var/www/html</code>ç›®å½•ï¼Œç”¨äºæŒä¹…åŒ–å­˜å‚¨æ•°æ®</li>
</ul>
<h4 data-id="heading-7">è‡ªå®šä¹‰é…ç½®éƒ¨ç½²ï¼ˆé€‚ç”¨äºå¼€å‘ç¯å¢ƒï¼‰</h4>
<p>å¦‚éœ€è‡ªå®šä¹‰ç®¡ç†å‘˜è´¦æˆ·ã€æ•°æ®åº“é…ç½®ç­‰ï¼Œå¯é€šè¿‡ç¯å¢ƒå˜é‡å®ç°è‡ªåŠ¨é…ç½®ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">docker run -d \  --name nextcloud \  -p <span class="hljs-number">80</span>:<span class="hljs-number">80</span> \  -v <span class="hljs-attr">nextcloud_data</span>:<span class="hljs-regexp">/var/</span>www/html \  -v <span class="hljs-attr">nextcloud_config</span>:<span class="hljs-regexp">/var/</span>www/html/config \  -v <span class="hljs-attr">nextcloud_apps</span>:<span class="hljs-regexp">/var/</span>www/html/custom_apps \  -e <span class="hljs-variable constant_">NEXTCLOUD_ADMIN_USER</span>=admin \  -e <span class="hljs-variable constant_">NEXTCLOUD_ADMIN_PASSWORD</span>=your_secure_password \  -e <span class="hljs-variable constant_">NEXTCLOUD_TRUSTED_DOMAINS</span>=<span class="hljs-string">"localhost 192.168.1.100"</span> \  xxx.<span class="hljs-property">xuanyuan</span>.<span class="hljs-property">run</span>/library/<span class="hljs-attr">nextcloud</span>:latest
</code></pre>
<p><strong>æ–°å¢å‚æ•°è¯´æ˜</strong>ï¼š</p>
<ul>
<li>â€¢ é¢å¤–æŒ‚è½½<code>nextcloud_config</code>å’Œ<code>nextcloud_apps</code>å·ï¼Œåˆ†åˆ«ç”¨äºæŒä¹…åŒ–é…ç½®æ–‡ä»¶å’Œè‡ªå®šä¹‰åº”ç”¨</li>
<li>â€¢ <code>NEXTCLOUD_ADMIN_USER</code>ï¼šè®¾ç½®ç®¡ç†å‘˜ç”¨æˆ·å</li>
<li>â€¢ <code>NEXTCLOUD_ADMIN_PASSWORD</code>ï¼šè®¾ç½®ç®¡ç†å‘˜å¯†ç ï¼ˆè¯·æ›¿æ¢ä¸ºå®‰å…¨å¯†ç ï¼‰</li>
<li>â€¢ <code>NEXTCLOUD_TRUSTED_DOMAINS</code>ï¼šè®¾ç½®å¯è®¿é—®NEXTCLOUDçš„å¯ä¿¡åŸŸåï¼Œå¤šä¸ªåŸŸåç”¨ç©ºæ ¼åˆ†éš”</li>
</ul>
<h4 data-id="heading-8">å¤–éƒ¨æ•°æ®åº“éƒ¨ç½²ï¼ˆæ¨èé…ç½®ï¼‰</h4>
<p>NEXTCLOUDé»˜è®¤ä½¿ç”¨SQLiteæ•°æ®åº“ï¼Œé€‚åˆæµ‹è¯•ç¯å¢ƒã€‚ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨MySQL/MariaDBæˆ–PostgreSQLæ•°æ®åº“ä»¥æå‡æ€§èƒ½å’Œå¯é æ€§ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨MariaDBçš„ç¤ºä¾‹ï¼š</p>
<ol>
<li>
<p>1. <strong>å¯åŠ¨MariaDBå®¹å™¨</strong>ï¼š</p>
<p>docker run -d \  --name nextcloud_db \  -v nextcloud_db:/var/lib/mysql \  -e MYSQL_ROOT_PASSWORD=root_password \  -e MYSQL_DATABASE=nextcloud \  -e MYSQL_USER=nextcloud_user \  -e MYSQL_PASSWORD=db_user_password \  mariadb:10.6</p>
</li>
<li>
<p>2. <strong>å¯åŠ¨NEXTCLOUDå®¹å™¨å¹¶è¿æ¥æ•°æ®åº“</strong>ï¼š</p>
<p>docker run -d \  --name nextcloud \  --link nextcloud_db:db \  -p 80:80 \  -v nextcloud_data:/var/www/html \  -e MYSQL_HOST=db \  -e MYSQL_DATABASE=nextcloud \  -e MYSQL_USER=nextcloud_user \  -e MYSQL_PASSWORD=db_user_password \  -e NEXTCLOUD_ADMIN_USER=admin \  -e NEXTCLOUD_ADMIN_PASSWORD=your_secure_password \  xxx.xuanyuan.run/library/nextcloud:latest</p>
</li>
</ol>
<p><strong>è¯´æ˜</strong>ï¼š<code>--link nextcloud_db:db</code>å‚æ•°å°†MariaDBå®¹å™¨é“¾æ¥åˆ°NEXTCLOUDå®¹å™¨ï¼Œä½¿NEXTCLOUDå¯é€šè¿‡<code>db</code>ä¸»æœºåè®¿é—®æ•°æ®åº“ã€‚</p>
<h3 data-id="heading-9">åŠŸèƒ½æµ‹è¯•</h3>
<h4 data-id="heading-10">æœåŠ¡è®¿é—®æµ‹è¯•</h4>
<p>å®¹å™¨å¯åŠ¨åï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼š</p>
<ol>
<li>
<p>1. <strong>æµè§ˆå™¨è®¿é—®</strong>ï¼šåœ¨æµè§ˆå™¨ä¸­è¾“å…¥<code>http://æœåŠ¡å™¨IP</code>ï¼Œé¦–æ¬¡è®¿é—®å°†æ˜¾ç¤ºNEXTCLOUDè®¾ç½®é¡µé¢ï¼ˆå¦‚æœªé€šè¿‡ç¯å¢ƒå˜é‡é¢„è®¾ç®¡ç†å‘˜è´¦æˆ·ï¼‰æˆ–ç›´æ¥è¿›å…¥ç™»å½•ç•Œé¢ã€‚</p>
</li>
<li>
<p>2. <strong>å‘½ä»¤è¡Œè®¿é—®</strong>ï¼šä½¿ç”¨<code>curl</code>å‘½ä»¤æµ‹è¯•ç«¯å£è¿é€šæ€§ï¼š</p>
<p>curl -I <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost" target="_blank" title="http://localhost" ref="nofollow noopener noreferrer">http://localhost</a></p>
</li>
</ol>
<p>è‹¥è¿”å›<code>HTTP/1.1 200 OK</code>æˆ–<code>HTTP/1.1 302 Found</code>ï¼Œè¡¨ç¤ºæœåŠ¡åŸºæœ¬æ­£å¸¸ã€‚</p>
<h4 data-id="heading-11">å®¹å™¨çŠ¶æ€æ£€æŸ¥</h4>
<p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å®¹å™¨è¿è¡ŒçŠ¶æ€ï¼š</p>
<pre><code class="hljs language-python" lang="python">docker ps --<span class="hljs-built_in">filter</span> <span class="hljs-string">"name=nextcloud"</span>
</code></pre>
<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œå®¹å™¨çŠ¶æ€åº”ä¸º<code>Up</code>ã€‚</p>
<h4 data-id="heading-12">æ—¥å¿—æŸ¥çœ‹</h4>
<p>æŸ¥çœ‹å®¹å™¨æ—¥å¿—ä»¥æ’æŸ¥æ½œåœ¨é—®é¢˜ï¼š</p>
<pre><code class="hljs">docker logs nextcloud
</code></pre>
<p>é¦–æ¬¡å¯åŠ¨æ—¶ï¼Œæ—¥å¿—å°†æ˜¾ç¤ºåˆå§‹åŒ–è¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®åº“è¿æ¥ã€æ–‡ä»¶æƒé™é…ç½®ç­‰ä¿¡æ¯ã€‚è‹¥å‡ºç°é”™è¯¯ï¼Œå¯æ ¹æ®æ—¥å¿—æç¤ºè¿›è¡Œæ’æŸ¥ã€‚</p>
<h4 data-id="heading-13">åŸºç¡€åŠŸèƒ½æµ‹è¯•</h4>
<ol>
<li>1. <strong>ç™»å½•æµ‹è¯•</strong>ï¼šä½¿ç”¨é¢„è®¾çš„ç®¡ç†å‘˜è´¦æˆ·ç™»å½•ç³»ç»Ÿï¼ŒéªŒè¯è®¤è¯åŠŸèƒ½ã€‚</li>
<li>2. <strong>æ–‡ä»¶ä¸Šä¼ æµ‹è¯•</strong>ï¼šä¸Šä¼ ä¸€ä¸ªå°å‹æµ‹è¯•æ–‡ä»¶ï¼ŒéªŒè¯å­˜å‚¨åŠŸèƒ½æ˜¯å¦æ­£å¸¸ã€‚</li>
<li>3. <strong>åº”ç”¨è®¿é—®æµ‹è¯•</strong>ï¼šè®¿é—®å†…ç½®åº”ç”¨ï¼ˆå¦‚â€œæ–‡ä»¶â€ã€â€œç›¸å†Œâ€ï¼‰ï¼Œç¡®è®¤åº”ç”¨åŠ è½½æ­£å¸¸ã€‚</li>
</ol>
<h3 data-id="heading-14">ç”Ÿäº§ç¯å¢ƒå»ºè®®</h3>
<h4 data-id="heading-15">æ•°æ®æŒä¹…åŒ–ä¼˜åŒ–</h4>
<p>ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®å¯¹NEXTCLOUDçš„æ•°æ®ç›®å½•è¿›è¡Œç²¾ç»†åŒ–æŒ‚è½½ï¼Œç¡®ä¿æ•°æ®å®‰å…¨å’Œå‡çº§å…¼å®¹æ€§ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">docker run -d \  --name nextcloud \  -p <span class="hljs-number">80</span>:<span class="hljs-number">80</span> \  -v <span class="hljs-attr">nextcloud_html</span>:<span class="hljs-regexp">/var/</span>www/html \  -v <span class="hljs-attr">nextcloud_data</span>:<span class="hljs-regexp">/var/</span>www/html/data \  -v <span class="hljs-attr">nextcloud_config</span>:<span class="hljs-regexp">/var/</span>www/html/config \  -v <span class="hljs-attr">nextcloud_apps</span>:<span class="hljs-regexp">/var/</span>www/html/custom_apps \  -v <span class="hljs-attr">nextcloud_themes</span>:<span class="hljs-regexp">/var/</span>www/html/themes \  xxx.<span class="hljs-property">xuanyuan</span>.<span class="hljs-property">run</span>/library/<span class="hljs-attr">nextcloud</span>:latest
</code></pre>
<p><strong>æŒ‚è½½è¯´æ˜</strong>ï¼š</p>
<ul>
<li>â€¢ <code>/var/www/html/data</code>ï¼šç”¨æˆ·ä¸Šä¼ æ–‡ä»¶å­˜å‚¨ç›®å½•</li>
<li>â€¢ <code>/var/www/html/config</code>ï¼šé…ç½®æ–‡ä»¶ç›®å½•</li>
<li>â€¢ <code>/var/www/html/custom_apps</code>ï¼šè‡ªå®šä¹‰åº”ç”¨ç›®å½•</li>
<li>â€¢ <code>/var/www/html/themes</code>ï¼šä¸»é¢˜æ–‡ä»¶ç›®å½•</li>
</ul>
<h4 data-id="heading-16">å®‰å…¨åŠ å›º</h4>
<ol>
<li>
<p>1. <strong>å¯ç”¨HTTPS</strong>ï¼šç”Ÿäº§ç¯å¢ƒå¿…é¡»é…ç½®HTTPSï¼Œå¯é€šè¿‡åå‘ä»£ç†ï¼ˆå¦‚Nginxã€Traefikï¼‰å®ç°ã€‚ç¤ºä¾‹Nginxé…ç½®å¯å‚è€ƒ NEXTCLOUDå®˜æ–¹æ–‡æ¡£ <code>https://docs.nextcloud.com/server/latest/admin_manual/installation/nginx.html</code>ã€‚</p>
</li>
<li>
<p>2. <strong>é™åˆ¶å®¹å™¨æƒé™</strong>ï¼šä½¿ç”¨érootç”¨æˆ·è¿è¡Œå®¹å™¨ï¼Œå‡å°‘å®‰å…¨é£é™©ï¼š</p>
<p>docker run -d \  --name nextcloud \  --user 33:33 \  # www-dataç”¨æˆ·IDå’Œç»„ID  -p 80:80 \  -v nextcloud_data:/var/www/html \  xxx.xuanyuan.run/library/nextcloud:latest</p>
</li>
<li>
<p>3. <strong>è®¾ç½®é˜²ç«å¢™</strong>ï¼šåªå¼€æ”¾å¿…è¦ç«¯å£ï¼ˆå¦‚80/443ï¼‰ï¼Œé™åˆ¶è®¿é—®æ¥æºã€‚</p>
</li>
</ol>
<h4 data-id="heading-17">æ€§èƒ½ä¼˜åŒ–</h4>
<ol>
<li>
<p>1. <strong>ä½¿ç”¨Redisç¼“å­˜</strong>ï¼šé…ç½®Redisç”¨äºæ–‡ä»¶é”å®šå’Œç¼“å­˜ï¼Œæå‡å¹¶å‘æ€§èƒ½ï¼š</p>
<h2 data-id="heading-18">å¯åŠ¨Rediså®¹å™¨docker run -d --name nextcloud_redis redis:alpine# å¯åŠ¨NEXTCLOUDå¹¶é…ç½®Redisdocker run -d \  --name nextcloud \  --link nextcloud_db:db \  --link nextcloud_redis:redis \  -p 80:80 \  -e REDIS_HOST=redis \  -e REDIS_HOST_PASSWORD=your_redis_password \  -v nextcloud_data:/var/www/html \  xxx.xuanyuan.run/library/nextcloud:latest</h2>
</li>
<li>
<p>2. <strong>è°ƒæ•´PHPå‚æ•°</strong>ï¼šæ ¹æ®æœåŠ¡å™¨é…ç½®è°ƒæ•´PHPå†…å­˜é™åˆ¶å’Œä¸Šä¼ é™åˆ¶ï¼š</p>
<p>docker run -d \  --name nextcloud \  -e PHP_MEMORY_LIMIT=1G \  # è°ƒæ•´PHPå†…å­˜é™åˆ¶ä¸º1GB  -e PHP_UPLOAD_LIMIT=10G \  # è°ƒæ•´ä¸Šä¼ é™åˆ¶ä¸º10GB  -v nextcloud_data:/var/www/html \  xxx.xuanyuan.run/library/nextcloud:latest</p>
</li>
<li>
<p>3. <strong>æ•°æ®åº“ä¼˜åŒ–</strong>ï¼šå¯¹MariaDB/MySQLè¿›è¡Œæ€§èƒ½è°ƒä¼˜ï¼Œå¦‚è°ƒæ•´è¿æ¥æ•°ã€ç¼“å­˜å¤§å°ç­‰ï¼Œå…·ä½“é…ç½®å¯å‚è€ƒæ•°æ®åº“å®˜æ–¹æ–‡æ¡£ã€‚</p>
</li>
</ol>
<h4 data-id="heading-19">å¤‡ä»½ç­–ç•¥</h4>
<p>å®šæœŸå¤‡ä»½NEXTCLOUDæ•°æ®å’Œæ•°æ®åº“ï¼Œå»ºè®®ä½¿ç”¨ä»¥ä¸‹ç­–ç•¥ï¼š</p>
<ol>
<li>
<p>1. <strong>æ•°æ®å·å¤‡ä»½</strong>ï¼šä½¿ç”¨<code>docker volume inspect</code>æ‰¾åˆ°å·çš„å®é™…è·¯å¾„ï¼Œç„¶åé€šè¿‡<code>rsync</code>æˆ–<code>tar</code>è¿›è¡Œå¤‡ä»½ã€‚</p>
</li>
<li>
<p>2. <strong>æ•°æ®åº“å¤‡ä»½</strong>ï¼šå¯¹MariaDBå®¹å™¨æ‰§è¡Œæ•°æ®åº“å¯¼å‡ºï¼š</p>
<p>docker exec nextcloud_db mysqldump -u root -p'root_password' nextcloud &gt; nextcloud_db_backup_$(date +%Y%m%d).sql</p>
</li>
<li>
<p>3. <strong>è‡ªåŠ¨åŒ–å¤‡ä»½</strong>ï¼šä½¿ç”¨crontabè®¾ç½®å®šæ—¶ä»»åŠ¡ï¼Œè‡ªåŠ¨æ‰§è¡Œå¤‡ä»½è„šæœ¬ï¼Œå¹¶å°†å¤‡ä»½æ–‡ä»¶å­˜å‚¨åˆ°å¤–éƒ¨å­˜å‚¨æˆ–äº‘å­˜å‚¨æœåŠ¡ã€‚</p>
</li>
</ol>
<h3 data-id="heading-20">æ•…éšœæ’æŸ¥</h3>
<h4 data-id="heading-21">å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ³•</h4>
<ol>
<li>1. <strong>æœåŠ¡æ— æ³•è®¿é—®</strong></li>
</ol>
<ul>
<li>â€¢ æ£€æŸ¥å®¹å™¨çŠ¶æ€ï¼š<code>docker ps --filter "name=nextcloud"</code>ï¼Œè‹¥æœªè¿è¡Œï¼Œä½¿ç”¨<code>docker start nextcloud</code>å¯åŠ¨</li>
<li>â€¢ æ£€æŸ¥ç«¯å£æ˜ å°„ï¼š<code>netstat -tulpn | grep 80</code>ï¼Œç¡®è®¤ç«¯å£æœªè¢«å ç”¨</li>
<li>â€¢ æ£€æŸ¥é˜²ç«å¢™è§„åˆ™ï¼šç¡®ä¿æœåŠ¡å™¨é˜²ç«å¢™å…è®¸80/443ç«¯å£è®¿é—®</li>
</ul>
<ol start="3">
<li>2. <strong>æ•°æ®åº“è¿æ¥å¤±è´¥</strong></li>
</ol>
<ul>
<li>â€¢ æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼š<code>docker logs nextcloud</code>ï¼Œæ£€æŸ¥æ•°æ®åº“è¿æ¥é”™è¯¯ä¿¡æ¯</li>
<li>â€¢ éªŒè¯æ•°æ®åº“å®¹å™¨çŠ¶æ€ï¼š<code>docker ps --filter "name=nextcloud_db"</code></li>
<li>â€¢ æ£€æŸ¥æ•°æ®åº“ç¯å¢ƒå˜é‡ï¼šç¡®è®¤<code>MYSQL_HOST</code>ã€<code>MYSQL_USER</code>ã€<code>MYSQL_PASSWORD</code>ç­‰å‚æ•°æ­£ç¡®</li>
</ul>
<ol start="5">
<li>3. <strong>æ–‡ä»¶ä¸Šä¼ å¤±è´¥</strong></li>
</ol>
<ul>
<li>â€¢ æ£€æŸ¥ç›®å½•æƒé™ï¼šå®¹å™¨å†…<code>/var/www/html/data</code>ç›®å½•æƒé™åº”ä¸ºwww-dataç”¨æˆ·ï¼ˆID 33ï¼‰æ‰€æœ‰</li>
<li>â€¢ æ£€æŸ¥PHPä¸Šä¼ é™åˆ¶ï¼šé€šè¿‡ç¯å¢ƒå˜é‡<code>PHP_UPLOAD_LIMIT</code>è°ƒæ•´ä¸Šä¼ å¤§å°é™åˆ¶</li>
<li>â€¢ æ£€æŸ¥ç£ç›˜ç©ºé—´ï¼šä½¿ç”¨<code>df -h</code>ç¡®è®¤ä¸»æœºç£ç›˜ç©ºé—´å……è¶³</li>
</ul>
<ol start="7">
<li>4. <strong>å‡çº§ååŠŸèƒ½å¼‚å¸¸</strong></li>
</ol>
<ul>
<li>
<p>â€¢ æŸ¥çœ‹å‡çº§æ—¥å¿—ï¼š<code>docker logs nextcloud</code>ï¼Œæ£€æŸ¥å‡çº§è¿‡ç¨‹ä¸­çš„é”™è¯¯</p>
</li>
<li>
<p>â€¢ ç¦ç”¨ç¬¬ä¸‰æ–¹åº”ç”¨ï¼šé€šè¿‡<code>occ</code>å‘½ä»¤ç¦ç”¨å¯èƒ½ä¸å…¼å®¹çš„è‡ªå®šä¹‰åº”ç”¨ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">docker <span class="hljs-keyword">exec</span> <span class="hljs-comment">--user www-data nextcloud php occ app:disable problematic_app</span>
</code></pre>
</li>
<li>
<p>â€¢ æ¢å¤å¤‡ä»½ï¼šè‹¥å‡çº§å¤±è´¥ï¼Œå¯ä½¿ç”¨ä¹‹å‰çš„å¤‡ä»½æ¢å¤æ•°æ®å’Œé…ç½®</p>
</li>
</ul>
<h4 data-id="heading-22">æ—¥å¿—æ’æŸ¥å·¥å…·</h4>
<ol>
<li>
<p>1. <strong>å®¹å™¨æ—¥å¿—</strong>ï¼š<code>docker logs -f nextcloud</code>ï¼ˆ<code>-f</code>å‚æ•°å¯å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼‰</p>
</li>
<li>
<p>2. <strong>åº”ç”¨æ—¥å¿—</strong>ï¼šNextcloud åº”ç”¨æ—¥å¿—ä½äº<code>/var/www/html/data/nextcloud.log</code>ï¼Œå¯é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">docker <span class="hljs-built_in">exec</span> nextcloud <span class="hljs-built_in">cat</span> /var/www/html/data/nextcloud.log
</code></pre>
</li>
<li>
<p>3. <strong>æ•°æ®åº“æ—¥å¿—</strong>ï¼šæŸ¥çœ‹MariaDBå®¹å™¨æ—¥å¿—ä»¥æ’æŸ¥æ•°æ®åº“é—®é¢˜ï¼š</p>
<pre><code class="hljs">docker logs nextcloud_db
</code></pre>
</li>
</ol>
<h3 data-id="heading-23">å‚è€ƒèµ„æº</h3>
<ol>
<li>1. Nextcloud é•œåƒæ–‡æ¡£ï¼ˆè½©è¾•ï¼‰ <code>https://xuanyuan.cloud/r/library/nextcloud</code> - è½©è¾•é•œåƒæä¾›çš„NEXTCLOUDé•œåƒè¯¦ç»†è¯´æ˜</li>
<li>2. Nextcloud é•œåƒæ ‡ç­¾åˆ—è¡¨ <code>https://xuanyuan.cloud/r/library/nextcloud/tags</code> - æ‰€æœ‰å¯ç”¨é•œåƒç‰ˆæœ¬æ ‡ç­¾</li>
<li>3. Nextcloudå®˜æ–¹æ–‡æ¡£ <code>https://docs.nextcloud.com</code> - Nextcloudé¡¹ç›®å®˜æ–¹æ–‡æ¡£ï¼ŒåŒ…å«è¯¦ç»†çš„é…ç½®å’Œç®¡ç†æŒ‡å—</li>
<li>4. Dockerå®˜æ–¹æ–‡æ¡£ <code>https://docs.docker.com</code> - Dockerå®¹å™¨æŠ€æœ¯å®˜æ–¹æ–‡æ¡£ï¼ŒåŒ…å«å®¹å™¨ç®¡ç†ã€ç½‘ç»œã€å­˜å‚¨ç­‰åŸºç¡€å†…å®¹</li>
<li>5. MariaDBå®˜æ–¹æ–‡æ¡£ <code>https://mariadb.com/kb/en</code> - MariaDBæ•°æ®åº“å®˜æ–¹æ–‡æ¡£ï¼ŒåŒ…å«æ€§èƒ½ä¼˜åŒ–ã€å¤‡ä»½æ¢å¤ç­‰å†…å®¹</li>
</ol>
<h3 data-id="heading-24">æ€»ç»“</h3>
<p>æœ¬æ–‡è¯¦ç»†ä»‹ç»äº† Nextcloud çš„Dockerå®¹å™¨åŒ–éƒ¨ç½²æ–¹æ¡ˆï¼Œä»ç¯å¢ƒå‡†å¤‡ã€é•œåƒæ‹‰å–ã€åŸºç¡€éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–ï¼Œæä¾›äº†ä¸€å¥—å®Œæ•´çš„éƒ¨ç½²æµç¨‹ã€‚é€šè¿‡å®¹å™¨åŒ–éƒ¨ç½²ï¼Œç”¨æˆ·å¯å¿«é€Ÿæ­å»º Nextcloud æœåŠ¡ï¼Œå¹¶æ ¹æ®å®é™…éœ€æ±‚è¿›è¡Œçµæ´»é…ç½®ã€‚</p>
<p><strong>å…³é”®è¦ç‚¹</strong>ï¼š</p>
<ul>
<li>â€¢ ä½¿ç”¨è½©è¾•é•œåƒè®¿é—®æ”¯æŒå¯æå‡ Nextcloud é•œåƒä¸‹è½½è®¿é—®è¡¨ç°ï¼Œç®€åŒ–éƒ¨ç½²æµç¨‹</li>
<li>â€¢ æµ‹è¯•ç¯å¢ƒå¯ä½¿ç”¨åŸºç¡€éƒ¨ç½²å‘½ä»¤å¿«é€Ÿå¯åŠ¨ï¼Œç”Ÿäº§ç¯å¢ƒéœ€é…ç½®å¤–éƒ¨æ•°æ®åº“å’ŒHTTPS</li>
<li>â€¢ æ•°æ®æŒä¹…åŒ–éœ€é€šè¿‡Dockerå·å®ç°ï¼Œå»ºè®®ç²¾ç»†åŒ–æŒ‚è½½å…³é”®ç›®å½•ä»¥ç¡®ä¿æ•°æ®å®‰å…¨</li>
<li>â€¢ å®šæœŸå¤‡ä»½æ•°æ®å’Œæ•°æ®åº“æ˜¯ç”Ÿäº§ç¯å¢ƒç¨³å®šè¿è¡Œçš„é‡è¦ä¿éšœ</li>
<li>â€¢ é‡åˆ°é—®é¢˜æ—¶ï¼Œå¯é€šè¿‡å®¹å™¨æ—¥å¿—ã€åº”ç”¨æ—¥å¿—å’Œæ•°æ®åº“æ—¥å¿—è¿›è¡Œæ’æŸ¥</li>
</ul>
<p><strong>åç»­å»ºè®®</strong>ï¼š</p>
<ul>
<li>â€¢ æ·±å…¥å­¦ä¹  Nextcloud çš„é«˜çº§ç‰¹æ€§ï¼Œå¦‚å¤–éƒ¨å­˜å‚¨é›†æˆã€LDAPè®¤è¯ã€è”é‚¦å…±äº«ç­‰ï¼Œæ‰©å±•æœåŠ¡åŠŸèƒ½</li>
<li>â€¢ æ ¹æ®ä¸šåŠ¡éœ€æ±‚è°ƒæ•´æ€§èƒ½å‚æ•°ï¼Œå¦‚PHPå†…å­˜é™åˆ¶ã€æ•°æ®åº“è¿æ¥æ•°ã€ç¼“å­˜ç­–ç•¥ç­‰ï¼Œä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½</li>
<li>â€¢ å…³æ³¨ Nextcloud é•œåƒæ ‡ç­¾åˆ—è¡¨ <code>https://xuanyuan.cloud/r/library/nextcloud/tags</code>ï¼ŒåŠæ—¶æ›´æ–°é•œåƒç‰ˆæœ¬ä»¥è·å–å®‰å…¨è¡¥ä¸å’Œæ–°åŠŸèƒ½</li>
<li>â€¢ å»ºç«‹å®Œå–„çš„ç›‘æ§ä½“ç³»ï¼Œå¯¹ Nextcloud æœåŠ¡çš„è¿è¡ŒçŠ¶æ€ã€èµ„æºä½¿ç”¨ç‡è¿›è¡Œå®æ—¶ç›‘æ§ï¼Œç¡®ä¿æœåŠ¡ç¨³å®šè¿è¡Œ</li>
</ul>
<p>é€šè¿‡æœ¬æ–‡æ¡£çš„æŒ‡å¯¼ï¼Œç”¨æˆ·å¯åœ¨å„ç§ç¯å¢ƒä¸­é«˜æ•ˆéƒ¨ç½²å’Œç®¡ç† Nextcloud æœåŠ¡ï¼Œå……åˆ†åˆ©ç”¨å…¶æ•°æ®ç®¡ç†å’Œåä½œåŠŸèƒ½ï¼Œæ»¡è¶³ä¸ªäººæˆ–ä¼ä¸šçš„éœ€æ±‚ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¾®å‰ç«¯ä»å…¥é—¨åˆ°ç²¾é€šï¼šVueå¼€å‘è€…çš„å¤§å‹åº”ç”¨æ¶æ„æ¼”è¿›æŒ‡å—]]></title>    <link>https://juejin.cn/post/7587412021709225990</link>    <guid>https://juejin.cn/post/7587412021709225990</guid>    <pubDate>2025-12-25T03:26:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587412021709225990" data-draft-id="7587349016222302249" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¾®å‰ç«¯ä»å…¥é—¨åˆ°ç²¾é€šï¼šVueå¼€å‘è€…çš„å¤§å‹åº”ç”¨æ¶æ„æ¼”è¿›æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯,æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-25T03:26:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Mr_chiu"/> <meta itemprop="url" content="https://juejin.cn/user/1644525124592974"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¾®å‰ç«¯ä»å…¥é—¨åˆ°ç²¾é€šï¼šVueå¼€å‘è€…çš„å¤§å‹åº”ç”¨æ¶æ„æ¼”è¿›æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1644525124592974/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Mr_chiu
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T03:26:07.000Z" title="Thu Dec 25 2025 03:26:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼€ç¯‡ï¼šå½“Vueåº”ç”¨ä»â€œå°åˆ«å¢…â€å˜æˆâ€œæ‘©å¤©å¤§æ¥¼â€</h2>
<p>ä½œä¸ºVueå¼€å‘è€…ï¼Œä½ æ˜¯å¦ç»å†è¿‡è¿™æ ·çš„æŠ€æœ¯ç„¦è™‘ï¼Ÿ</p>
<ul>
<li>é¡¹ç›®ä»£ç é‡çªç ´10ä¸‡è¡Œï¼Œ<code>npm run build</code> æ—¶é—´è¶…è¿‡5åˆ†é’Ÿ</li>
<li>15ä¸ªå›¢é˜Ÿåœ¨åŒä¸€ä¸ªä»£ç åº“ä¸­å¹¶è¡Œå¼€å‘ï¼Œæ¯å¤©äº§ç”Ÿæ•°åä¸ªåˆå¹¶å†²çª</li>
<li>æ¯æ¬¡åŠŸèƒ½ä¸Šçº¿éƒ½éœ€è¦å…¨é‡å›å½’æµ‹è¯•ï¼Œå‘å¸ƒçª—å£è¶Šæ¥è¶Šå°</li>
<li>æƒ³ç”¨Vue 3çš„Composition APIé‡æ„è€ä»£ç ï¼Œå´æ— ä»ä¸‹æ‰‹</li>
</ul>
<p>è¿™æ­£æ˜¯å¾®å‰ç«¯æ¶æ„è¦è§£å†³çš„æ ¸å¿ƒé—®é¢˜ã€‚æœ¬æ–‡å°†ä¸ºä½ å‘ˆç°ä¸€å¥—å®Œæ•´çš„Vueå¾®å‰ç«¯å®æˆ˜æŒ‡å—ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°ç”Ÿäº§çº§æ¶æ„è®¾è®¡ï¼ŒåŠ©ä½ æŒæ¡å¤§å‹Vueåº”ç”¨çš„æ‹†åˆ†è‰ºæœ¯ã€‚</p>
<h2 data-id="heading-1">ç¬¬ä¸€ç« ï¼šé‡æ–°è®¤è¯†å¾®å‰ç«¯â€”â€”ä¸åªæ˜¯ä»£ç æ‹†åˆ†</h2>
<h3 data-id="heading-2">1.1 å¾®å‰ç«¯çš„æœ¬è´¨ï¼šæŠ€æœ¯æ¶æ„ä¸ç»„ç»‡æ¶æ„çš„èåˆ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¾®å‰ç«¯è§£å†³çš„ä¸ä»…æ˜¯æŠ€æœ¯é—®é¢˜</span>
<span class="hljs-keyword">const</span> microFrontendBenefits = {
  <span class="hljs-attr">technical</span>: [
    <span class="hljs-string">'ç‹¬ç«‹å¼€å‘ã€éƒ¨ç½²'</span>,
    <span class="hljs-string">'æŠ€æœ¯æ ˆå¼‚æ„ï¼ˆVue 2/3ã€Reactå¹¶è¡Œï¼‰'</span>,
    <span class="hljs-string">'æ¸è¿›å¼å‡çº§'</span>,
    <span class="hljs-string">'å¢é‡æ›´æ–°'</span>
  ],
  <span class="hljs-attr">organizational</span>: [
    <span class="hljs-string">'å›¢é˜Ÿè‡ªæ²»'</span>,
    <span class="hljs-string">'å¹¶è¡Œå¼€å‘æµ'</span>,
    <span class="hljs-string">'æŒ‰ä¸šåŠ¡é¢†åŸŸåˆ’åˆ†èŒè´£'</span>,
    <span class="hljs-string">'é™ä½åä½œæˆæœ¬'</span>
  ]
};
</code></pre>
<h3 data-id="heading-3">1.2 Vueå¼€å‘è€…çš„å¾®å‰ç«¯æ€ç»´è½¬å˜</h3>
<p><strong>ä¼ ç»Ÿæ€ç»´ï¼š</strong></p>
<pre><code class="hljs">å•ä»“åº“ â†’ é›†ä¸­è·¯ç”± â†’ å…¨å±€çŠ¶æ€ â†’ ç»Ÿä¸€æ„å»º â†’ å…¨é‡éƒ¨ç½²
</code></pre>
<p><strong>å¾®å‰ç«¯æ€ç»´ï¼š</strong></p>
<pre><code class="hljs">å¤šä»“åº“ â†’ è·¯ç”±èšåˆ â†’ çŠ¶æ€éš”ç¦» â†’ ç‹¬ç«‹æ„å»º â†’ å¢é‡éƒ¨ç½²
</code></pre>
<h2 data-id="heading-4">ç¬¬äºŒç« ï¼šVueå¾®å‰ç«¯æ ¸å¿ƒæŠ€æœ¯é€‰å‹æ·±åº¦è§£æ</h2>
<h3 data-id="heading-5">2.1 ä¸»æµæ–¹æ¡ˆæ¨ªå‘å¯¹æ¯”</h3>








































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>æ ¸å¿ƒåŸç†</th><th>Vueæ”¯æŒåº¦</th><th>ç”Ÿäº§å°±ç»ªåº¦</th><th>å­¦ä¹ æˆæœ¬</th></tr></thead><tbody><tr><td><strong>qiankun</strong></td><td>è¿è¡Œæ—¶åŠ è½½ + JSæ²™ç®±</td><td>â­â­â­â­â­</td><td>â­â­â­â­â­</td><td>ä¸­</td></tr><tr><td><strong>Module Federation</strong></td><td>ç¼–è¯‘æ—¶ä¾èµ–å…±äº«</td><td>â­â­â­â­</td><td>â­â­â­â­</td><td>é«˜</td></tr><tr><td><strong>Single-SPA</strong></td><td>ç”Ÿå‘½å‘¨æœŸè°ƒåº¦</td><td>â­â­â­â­</td><td>â­â­â­â­</td><td>ä¸­</td></tr><tr><td><strong>æ— ç•Œ</strong></td><td>iframeæ²™ç®±</td><td>â­â­â­â­</td><td>â­â­â­</td><td>ä½</td></tr></tbody></table>
<h3 data-id="heading-6">2.2 æˆ‘ä»¬çš„é€‰æ‹©ï¼šqiankun + Vue 3ç”Ÿæ€ä½“ç³»</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æŠ€æœ¯æ ˆå…¨æ™¯å›¾</span>
<span class="hljs-keyword">const</span> techStack = {
  <span class="hljs-attr">baseFramework</span>: <span class="hljs-string">'Vue 3 + TypeScript + Vite'</span>,
  <span class="hljs-attr">microFramework</span>: {
    <span class="hljs-attr">host</span>: <span class="hljs-string">'Vue 3 + qiankun'</span>,
    <span class="hljs-attr">microApps</span>: [
      { <span class="hljs-attr">name</span>: <span class="hljs-string">'auth-center'</span>, <span class="hljs-attr">stack</span>: <span class="hljs-string">'Vue 3 + Pinia'</span> },
      { <span class="hljs-attr">name</span>: <span class="hljs-string">'dashboard'</span>, <span class="hljs-attr">stack</span>: <span class="hljs-string">'Vue 3 + Composition API'</span> },
      { <span class="hljs-attr">name</span>: <span class="hljs-string">'legacy-module'</span>, <span class="hljs-attr">stack</span>: <span class="hljs-string">'Vue 2 + Vuex'</span> },
      { <span class="hljs-attr">name</span>: <span class="hljs-string">'experimental'</span>, <span class="hljs-attr">stack</span>: <span class="hljs-string">'React 18'</span> } <span class="hljs-comment">// æŠ€æœ¯æ ˆè‡ªç”±ï¼</span>
    ]
  },
  <span class="hljs-attr">stateManagement</span>: <span class="hljs-string">'Pinia (ä¸»åº”ç”¨) + è‡ªå®šä¹‰é€šä¿¡åè®®'</span>,
  <span class="hljs-attr">buildSystem</span>: <span class="hljs-string">'Vite (å¾®åº”ç”¨) + Webpack (ä¸»åº”ç”¨)'</span>
};
</code></pre>
<h2 data-id="heading-7">ç¬¬ä¸‰ç« ï¼šå®æˆ˜æ¼”ç»ƒâ€”â€”ä»é›¶æ„å»ºç”Ÿäº§çº§Vueå¾®å‰ç«¯æ¶æ„</h2>
<h3 data-id="heading-8">3.1 ä¸»åº”ç”¨ï¼šå¾®å‰ç«¯çš„â€œèˆªç©ºæ¯èˆ°â€</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// main-app/src/micro/registry.ts - å¾®åº”ç”¨æ³¨å†Œä¸­å¿ƒ</span>
<span class="hljs-keyword">import</span> { registerMicroApps, start, initGlobalState } <span class="hljs-keyword">from</span> <span class="hljs-string">'qiankun'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">MicroApp</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/types/micro'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-attr">microApps</span>: <span class="hljs-title class_">MicroApp</span>[] = [
  {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'vue3-auth'</span>,
    <span class="hljs-attr">entry</span>: <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_AUTH_APP_URL</span>,
    <span class="hljs-attr">container</span>: <span class="hljs-string">'#micro-container'</span>,
    <span class="hljs-attr">activeRule</span>: <span class="hljs-string">'/auth'</span>,
    <span class="hljs-attr">props</span>: {
      <span class="hljs-attr">routerBase</span>: <span class="hljs-string">'/auth'</span>,
      <span class="hljs-attr">sharedStore</span>: <span class="hljs-title function_">initGlobalState</span>({ <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span> }),
      <span class="hljs-attr">onAuthSuccess</span>: <span class="hljs-function">(<span class="hljs-params">token: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
        <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'token'</span>, token);
      }
    }
  },
  {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'vue2-legacy'</span>,
    <span class="hljs-attr">entry</span>: <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_LEGACY_APP_URL</span>,
    <span class="hljs-attr">container</span>: <span class="hljs-string">'#micro-container'</span>,
    <span class="hljs-attr">activeRule</span>: <span class="hljs-string">'/legacy'</span>,
    <span class="hljs-attr">props</span>: {
      <span class="hljs-comment">// Vue 2å…¼å®¹æ€§é€‚é…å™¨</span>
      <span class="hljs-attr">vue2Adapter</span>: <span class="hljs-literal">true</span>
    }
  }
];

<span class="hljs-comment">// æ™ºèƒ½é¢„åŠ è½½ç­–ç•¥</span>
<span class="hljs-keyword">const</span> prefetchApps = microApps
  .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">app</span> =&gt;</span> app.<span class="hljs-property">priority</span> === <span class="hljs-string">'high'</span>)
  .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">app</span> =&gt;</span> app.<span class="hljs-property">name</span>);

<span class="hljs-title function_">registerMicroApps</span>(microApps, {
  <span class="hljs-attr">beforeLoad</span>: [<span class="hljs-function"><span class="hljs-params">app</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`åŠ è½½ <span class="hljs-subst">${app.name}</span>`</span>)],
  <span class="hljs-attr">beforeMount</span>: [<span class="hljs-function"><span class="hljs-params">app</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æŒ‚è½½ <span class="hljs-subst">${app.name}</span>`</span>)],
  <span class="hljs-attr">afterUnmount</span>: [<span class="hljs-function"><span class="hljs-params">app</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å¸è½½ <span class="hljs-subst">${app.name}</span>`</span>)]
});

<span class="hljs-title function_">start</span>({
  <span class="hljs-attr">prefetch</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">sandbox</span>: {
    <span class="hljs-attr">experimentalStyleIsolation</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// CSSéš”ç¦»</span>
  },
  <span class="hljs-attr">singular</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// å…è®¸åŒæ—¶è¿è¡Œå¤šä¸ªå¾®åº”ç”¨</span>
});
</code></pre>
<h3 data-id="heading-9">3.2 Vue 3å¾®åº”ç”¨ï¼šç°ä»£åŒ–é…ç½®</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// micro-auth/src/entry.ts - å¾®åº”ç”¨å…¥å£æ–‡ä»¶</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>;
<span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">'./router'</span>;
<span class="hljs-keyword">import</span> { createPinia } <span class="hljs-keyword">from</span> <span class="hljs-string">'pinia'</span>;

<span class="hljs-keyword">let</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-keyword">typeof</span> createApp&gt; | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params">props: <span class="hljs-built_in">any</span> = {}</span>) {
  <span class="hljs-keyword">const</span> { container, routerBase } = props;
  <span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>);
  
  <span class="hljs-comment">// ç‹¬ç«‹è¿è¡Œæ—¶ä¸åµŒå…¥è¿è¡Œæ—¶è·¯ç”±å·®å¼‚åŒ–</span>
  <span class="hljs-keyword">const</span> baseRouter = routerBase || <span class="hljs-string">'/'</span>;
  
  app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">router</span>(baseRouter));
  app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">createPinia</span>());
  
  <span class="hljs-comment">// æŒ‚è½½åˆ°æŒ‡å®šå®¹å™¨æˆ–é»˜è®¤#app</span>
  <span class="hljs-keyword">const</span> target = container 
    ? container.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#auth-app'</span>) 
    : <span class="hljs-string">'#auth-app'</span>;
  
  instance = app.<span class="hljs-title function_">mount</span>(target);
  <span class="hljs-keyword">return</span> instance;
}

<span class="hljs-comment">// ç‹¬ç«‹è¿è¡Œ</span>
<span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">window</span>.<span class="hljs-property">__POWERED_BY_QIANKUN__</span>) {
  <span class="hljs-title function_">render</span>();
}

<span class="hljs-comment">// qiankunç”Ÿå‘½å‘¨æœŸåè®®</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">bootstrap</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[Auth] å¾®åº”ç”¨å¯åŠ¨'</span>);
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">mount</span>(<span class="hljs-params">props: <span class="hljs-built_in">any</span></span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[Auth] æ¥æ”¶ä¸»åº”ç”¨å‚æ•°'</span>, props);
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">render</span>(props);
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">unmount</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (instance &amp;&amp; instance.<span class="hljs-property">$destroy</span>) {
    instance.$destroy();
  }
  instance = <span class="hljs-literal">null</span>;
}
</code></pre>
<h3 data-id="heading-10">3.3 Vue 2å¾®åº”ç”¨ï¼šå…¼å®¹æ€§é€‚é…æ–¹æ¡ˆ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// micro-legacy/src/public-path.js</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">__POWERED_BY_QIANKUN__</span>) {
  <span class="hljs-comment">// åŠ¨æ€è®¾ç½®webpack publicPath</span>
  __webpack_public_path__ = <span class="hljs-variable language_">window</span>.<span class="hljs-property">__INJECTED_PUBLIC_PATH_BY_QIANKUN__</span>;
}

<span class="hljs-comment">// micro-legacy/src/main.js</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>;
<span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">'./store'</span>;

<span class="hljs-keyword">let</span> vueInstance = <span class="hljs-literal">null</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params">{ container, routerBase } = {}</span>) {
  <span class="hljs-keyword">const</span> target = container 
    ? container.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#legacy-app'</span>) 
    : <span class="hljs-string">'#legacy-app'</span>;
  
  vueInstance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
    store,
    <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-params">h</span> =&gt;</span> <span class="hljs-title function_">h</span>(<span class="hljs-title class_">App</span>)
  }).$mount(target);
  
  <span class="hljs-keyword">return</span> vueInstance;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">bootstrap</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[Legacy] Vue 2åº”ç”¨å¯åŠ¨'</span>);
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">mount</span>(<span class="hljs-params">props</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[Legacy] æŒ‚è½½'</span>, props);
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">render</span>(props);
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">unmount</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (vueInstance) {
    vueInstance.$destroy();
    vueInstance.<span class="hljs-property">$el</span>.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">''</span>;
  }
  vueInstance = <span class="hljs-literal">null</span>;
}
</code></pre>
<h2 data-id="heading-11">ç¬¬å››ç« ï¼šé«˜çº§ç‰¹æ€§å®ç°â€”â€”çªç ´å¾®å‰ç«¯æ ¸å¿ƒéš¾é¢˜</h2>
<h3 data-id="heading-12">4.1 è·¨åº”ç”¨çŠ¶æ€ç®¡ç†ï¼šä¸åªæ˜¯Pinia/Vuex</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// shared/src/stores/global-store.ts - è·¨åº”ç”¨çŠ¶æ€æ€»çº¿</span>
<span class="hljs-keyword">import</span> { reactive, watch } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> { initGlobalState, <span class="hljs-title class_">MicroAppStateActions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'qiankun'</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalStore</span> {
  <span class="hljs-keyword">private</span> state = <span class="hljs-title function_">reactive</span>({
    <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">User</span> | <span class="hljs-literal">null</span>,
    <span class="hljs-attr">permissions</span>: [] <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>[],
    <span class="hljs-attr">theme</span>: <span class="hljs-string">'light'</span> <span class="hljs-keyword">as</span> <span class="hljs-string">'light'</span> | <span class="hljs-string">'dark'</span>
  });
  
  <span class="hljs-keyword">private</span> <span class="hljs-attr">actions</span>: <span class="hljs-title class_">MicroAppStateActions</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  
  <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">actions</span> = <span class="hljs-title function_">initGlobalState</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>);
    
    <span class="hljs-comment">// ç›‘å¬çŠ¶æ€å˜åŒ–</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">actions</span>.<span class="hljs-title function_">onGlobalStateChange</span>(<span class="hljs-function">(<span class="hljs-params">newState, prevState</span>) =&gt;</span> {
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>, newState);
    });
  }
  
  <span class="hljs-comment">// æ›´æ–°çŠ¶æ€å¹¶åŒæ­¥åˆ°æ‰€æœ‰å¾®åº”ç”¨</span>
  <span class="hljs-title function_">setUser</span>(<span class="hljs-params">user: User</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">user</span> = user;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">actions</span>?.<span class="hljs-title function_">setGlobalState</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>);
  }
  
  <span class="hljs-comment">// ä»…æœ¬åœ°æ›´æ–°ï¼Œä¸å¹¿æ’­</span>
  <span class="hljs-title function_">setThemeLocal</span>(<span class="hljs-params">theme: <span class="hljs-string">'light'</span> | <span class="hljs-string">'dark'</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">theme</span> = theme;
  }
  
  <span class="hljs-title function_">getState</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>;
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> globalStore = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GlobalStore</span>();

<span class="hljs-comment">// åœ¨Vueç»„ä»¶ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">import</span> { globalStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@shared/store'</span>;
<span class="hljs-keyword">import</span> { storeToRefs } <span class="hljs-keyword">from</span> <span class="hljs-string">'pinia'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> { user, theme } = <span class="hljs-title function_">storeToRefs</span>(globalStore.<span class="hljs-title function_">getState</span>());
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">updateUser</span> = (<span class="hljs-params"/>) =&gt; {
      globalStore.<span class="hljs-title function_">setUser</span>({ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'John'</span> });
    };
    
    <span class="hljs-keyword">return</span> { user, theme, updateUser };
  }
};
</code></pre>
<h3 data-id="heading-13">4.2 CSSéš”ç¦»çš„ç»ˆææ–¹æ¡ˆ</h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æ–¹æ¡ˆä¸€ï¼šCSS Modules + å‘½åç©ºé—´ï¼ˆæ¨èï¼‰</span>
<span class="hljs-selector-class">.auth-app</span> {
  <span class="hljs-comment">// æ‰€æœ‰æ ·å¼éƒ½åœ¨å‘½åç©ºé—´ä¸‹</span>
  :global {
    <span class="hljs-selector-class">.button</span> {
      <span class="hljs-comment">// è¦†ç›–å…¨å±€æ ·å¼</span>
    }
  }
}

<span class="hljs-comment">// æ–¹æ¡ˆäºŒï¼šåŠ¨æ€æ ·å¼è¡¨åŠ è½½/å¸è½½</span>
class ScopedCSSManager {
  private styleCache = new Map&lt;string, HTMLStyleElement&gt;();
  
  <span class="hljs-built_in">load</span>(appName: string, css: string) {
    const style = document<span class="hljs-selector-class">.createElement</span>('style');
    style<span class="hljs-selector-class">.setAttribute</span>('data-app', appName);
    style<span class="hljs-selector-class">.textContent</span> = this<span class="hljs-selector-class">.scopeCSS</span>(css, appName);
    document<span class="hljs-selector-class">.head</span><span class="hljs-selector-class">.appendChild</span>(style);
    this<span class="hljs-selector-class">.styleCache</span><span class="hljs-selector-class">.set</span>(appName, style);
  }
  
  <span class="hljs-built_in">unload</span>(appName: string) {
    const style = this<span class="hljs-selector-class">.styleCache</span><span class="hljs-selector-class">.get</span>(appName);
    if (style &amp;&amp; document.head.contains(style)) {
      document<span class="hljs-selector-class">.head</span><span class="hljs-selector-class">.removeChild</span>(style);
    }
    this<span class="hljs-selector-class">.styleCache</span><span class="hljs-selector-class">.delete</span>(appName);
  }
  
  private <span class="hljs-built_in">scopeCSS</span>(css: string, appName: string): string {
    <span class="hljs-comment">// å°†é€‰æ‹©å™¨è½¬æ¢ä¸º [data-app="auth"] .button å½¢å¼</span>
    return css<span class="hljs-selector-class">.replace</span>(/([^{]+)\{/g, `<span class="hljs-selector-attr">[data-app=<span class="hljs-string">"${appName}"</span>]</span> $<span class="hljs-number">1</span>{`);
  }
}
</code></pre>
<h3 data-id="heading-14">4.3 æ™ºèƒ½è·¯ç”±ä¸å¯¼èˆªå®ˆå«</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// main-app/src/router/micro-router.ts</span>
<span class="hljs-keyword">import</span> { createRouter, createWebHistory } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>;

<span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/layouts/MainLayout.vue'</span>),
    <span class="hljs-attr">children</span>: [
      <span class="hljs-comment">// ä¸»åº”ç”¨è·¯ç”±</span>
      { <span class="hljs-attr">path</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">component</span>: <span class="hljs-title class_">HomePage</span> },
      <span class="hljs-comment">// å¾®å‰ç«¯è·¯ç”± - åŠ¨æ€åŒ¹é…</span>
      { 
        <span class="hljs-attr">path</span>: <span class="hljs-string">'/auth/:pathMatch(.*)*'</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-title class_">MicroContainer</span>,
        <span class="hljs-attr">meta</span>: { <span class="hljs-attr">microApp</span>: <span class="hljs-string">'vue3-auth'</span> }
      },
      {
        <span class="hljs-attr">path</span>: <span class="hljs-string">'/legacy/:pathMatch(.*)*'</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-title class_">MicroContainer</span>,
        <span class="hljs-attr">meta</span>: { <span class="hljs-attr">microApp</span>: <span class="hljs-string">'vue2-legacy'</span> }
      }
    ]
  }
];

<span class="hljs-comment">// å¯¼èˆªå®ˆå« - å¾®åº”ç”¨æƒé™æ§åˆ¶</span>
router.<span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span>, next</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> microApp = to.<span class="hljs-property">meta</span>.<span class="hljs-property">microApp</span>;
  
  <span class="hljs-keyword">if</span> (microApp) {
    <span class="hljs-comment">// æ£€æŸ¥å¾®åº”ç”¨æ˜¯å¦å°±ç»ª</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isMicroAppLoaded</span>(microApp)) {
      <span class="hljs-title function_">loadMicroApp</span>(microApp).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">next</span>();
      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">next</span>(<span class="hljs-string">'/error/micro-app-unavailable'</span>);
      });
      <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-comment">// æ£€æŸ¥å¾®åº”ç”¨è®¿é—®æƒé™</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">hasPermissionForMicroApp</span>(microApp)) {
      <span class="hljs-title function_">next</span>(<span class="hljs-string">'/forbidden'</span>);
      <span class="hljs-keyword">return</span>;
    }
  }
  
  <span class="hljs-title function_">next</span>();
});
</code></pre>
<h2 data-id="heading-15">ç¬¬äº”ç« ï¼šæ€§èƒ½ä¼˜åŒ–å®æˆ˜æ‰‹å†Œ</h2>
<h3 data-id="heading-16">5.1 å¾®åº”ç”¨æ‡’åŠ è½½ä¸é¢„åŠ è½½ç­–ç•¥</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// main-app/src/utils/preload-strategy.ts</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MicroAppPreloader</span> {
  <span class="hljs-keyword">private</span> loadedApps = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>&lt;<span class="hljs-built_in">string</span>&gt;();
  <span class="hljs-keyword">private</span> <span class="hljs-attr">prefetchQueue</span>: <span class="hljs-built_in">string</span>[] = [];
  
  <span class="hljs-comment">// åŸºäºç”¨æˆ·è¡Œä¸ºé¢„æµ‹çš„é¢„åŠ è½½</span>
  <span class="hljs-title function_">setupUserBehaviorPrediction</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// 1. ç›‘å¬è·¯ç”±å˜åŒ–</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">router</span>.<span class="hljs-title function_">afterEach</span>(<span class="hljs-function"><span class="hljs-params">to</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> nextApps = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">predictNextApps</span>(to);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">prefetch</span>(nextApps);
    });
    
    <span class="hljs-comment">// 2. ç›‘å¬é¼ æ ‡æ‚¬åœ</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mouseover'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> link = e.<span class="hljs-property">target</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span>;
      <span class="hljs-keyword">if</span> (link.<span class="hljs-property">dataset</span>.<span class="hljs-property">microApp</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">prefetch</span>([link.<span class="hljs-property">dataset</span>.<span class="hljs-property">microApp</span>]);
      }
    }, { <span class="hljs-attr">capture</span>: <span class="hljs-literal">true</span> });
  }
  
  <span class="hljs-comment">// æ™ºèƒ½é¢„åŠ è½½ç®—æ³•</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">prefetch</span>(<span class="hljs-params">appNames: <span class="hljs-built_in">string</span>[]</span>) {
    <span class="hljs-keyword">const</span> toLoad = appNames.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">name</span> =&gt;</span> 
      !<span class="hljs-variable language_">this</span>.<span class="hljs-property">loadedApps</span>.<span class="hljs-title function_">has</span>(name) &amp;&amp; 
      !<span class="hljs-variable language_">this</span>.<span class="hljs-property">prefetchQueue</span>.<span class="hljs-title function_">includes</span>(name)
    );
    
    <span class="hljs-comment">// ç©ºé—²æ—¶åŠ è½½</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-string">'requestIdleCallback'</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">window</span>) {
      <span class="hljs-title function_">requestIdleCallback</span>(<span class="hljs-keyword">async</span> () =&gt; {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> app <span class="hljs-keyword">of</span> toLoad) {
          <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadAppResources</span>(app);
        }
      });
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// é™çº§æ–¹æ¡ˆï¼šå»¶è¿ŸåŠ è½½</span>
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        toLoad.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">app</span> =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadAppResources</span>(app));
      }, <span class="hljs-number">1000</span>);
    }
  }
  
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">predictNextApps</span>(currentRoute): <span class="hljs-built_in">string</span>[] {
    <span class="hljs-comment">// åŸºäºè·¯ç”±é…ç½®çš„ç®€å•é¢„æµ‹</span>
    <span class="hljs-keyword">const</span> routeMap = {
      <span class="hljs-string">'/dashboard'</span>: [<span class="hljs-string">'vue3-auth'</span>, <span class="hljs-string">'vue3-analytics'</span>],
      <span class="hljs-string">'/user/profile'</span>: [<span class="hljs-string">'vue3-auth'</span>],
      <span class="hljs-comment">// ...æ›´å¤šè·¯ç”±æ˜ å°„</span>
    };
    
    <span class="hljs-keyword">return</span> routeMap[currentRoute.<span class="hljs-property">path</span>] || [];
  }
}
</code></pre>
<h3 data-id="heading-17">5.2 æ„å»ºä¼˜åŒ–ï¼šVite + qiankunçš„æœ€ä½³å®è·µ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// micro-app/vite.config.js</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>;
<span class="hljs-keyword">import</span> vue <span class="hljs-keyword">from</span> <span class="hljs-string">'@vitejs/plugin-vue'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">vue</span>()],
  <span class="hljs-attr">build</span>: {
    <span class="hljs-attr">target</span>: <span class="hljs-string">'es2015'</span>,
    <span class="hljs-attr">lib</span>: {
      <span class="hljs-attr">entry</span>: <span class="hljs-string">'src/entry.ts'</span>,
      <span class="hljs-attr">formats</span>: [<span class="hljs-string">'umd'</span>],
      <span class="hljs-attr">name</span>: <span class="hljs-string">'vue3AuthApp'</span>
    },
    <span class="hljs-attr">rollupOptions</span>: {
      <span class="hljs-attr">external</span>: [<span class="hljs-string">'vue'</span>, <span class="hljs-string">'vue-router'</span>, <span class="hljs-string">'pinia'</span>],
      <span class="hljs-attr">output</span>: {
        <span class="hljs-attr">globals</span>: {
          <span class="hljs-attr">vue</span>: <span class="hljs-string">'Vue'</span>,
          <span class="hljs-string">'vue-router'</span>: <span class="hljs-string">'VueRouter'</span>,
          <span class="hljs-attr">pinia</span>: <span class="hljs-string">'Pinia'</span>
        },
        <span class="hljs-comment">// ç¡®ä¿qiankunèƒ½æ­£ç¡®åŠ è½½</span>
        <span class="hljs-attr">entryFileNames</span>: <span class="hljs-string">'[name].js'</span>,
        <span class="hljs-attr">chunkFileNames</span>: <span class="hljs-string">'[name].[hash].js'</span>
      }
    }
  },
  <span class="hljs-attr">server</span>: {
    <span class="hljs-attr">port</span>: <span class="hljs-number">3001</span>,
    <span class="hljs-attr">cors</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-string">'Access-Control-Allow-Origin'</span>: <span class="hljs-string">'*'</span>
    }
  }
});
</code></pre>
<h2 data-id="heading-18">ç¬¬å…­ç« ï¼šç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ä¸DevOpsæµæ°´çº¿</h2>
<h3 data-id="heading-19">6.1 å¾®å‰ç«¯CI/CDæ¶æ„</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># .github/workflows/deploy-micro-apps.yml</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">Micro</span> <span class="hljs-string">Frontends</span>

<span class="hljs-attr">on:</span>
  <span class="hljs-attr">push:</span>
    <span class="hljs-attr">paths:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">'micro-apps/**'</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">'main-app/**'</span>

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">deploy-micro-apps:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">strategy:</span>
      <span class="hljs-attr">matrix:</span>
        <span class="hljs-attr">app:</span> [<span class="hljs-string">auth</span>, <span class="hljs-string">dashboard</span>, <span class="hljs-string">legacy</span>]
    
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v3</span>
      
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Node.js</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v3</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">node-version:</span> <span class="hljs-string">'18'</span>
          
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">Dependencies</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          cd micro-apps/${{ matrix.app }}
          npm ci
</span>          
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">Micro</span> <span class="hljs-string">App</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          cd micro-apps/${{ matrix.app }}
          npm run build
</span>          
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">CDN</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">aws-actions/configure-aws-credentials@v1</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">aws-access-key-id:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.AWS_ACCESS_KEY</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">aws-secret-access-key:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.AWS_SECRET_KEY</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">aws-region:</span> <span class="hljs-string">us-east-1</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          aws s3 sync ./dist s3://my-cdn/micro-apps/${{ matrix.app }}/${{ github.sha }}/
</span>          
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Update</span> <span class="hljs-string">Version</span> <span class="hljs-string">Registry</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          # æ›´æ–°å¾®åº”ç”¨ç‰ˆæœ¬æ¸…å•
          curl -X POST https://api.myapp.com/versions \
            -H "Authorization: Bearer ${{ secrets.DEPLOY_TOKEN }}" \
            -d '{"app":"${{ matrix.app }}","version":"${{ github.sha }}"}'
</span></code></pre>
<h3 data-id="heading-20">6.2 ç‰ˆæœ¬ç®¡ç†ä¸ç°åº¦å‘å¸ƒ</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// version-manager.ts - å¾®åº”ç”¨ç‰ˆæœ¬æ§åˆ¶</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">VersionManager</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">versionManifest</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = {};
  
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">versionManifest</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fetchManifest</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupVersionPolling</span>();
  }
  
  <span class="hljs-comment">// è·å–æŒ‡å®šåº”ç”¨çš„æœ€ä½³ç‰ˆæœ¬</span>
  <span class="hljs-title function_">getAppVersion</span>(<span class="hljs-attr">appName</span>: <span class="hljs-built_in">string</span>, userId?: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">const</span> defaultVersion = <span class="hljs-variable language_">this</span>.<span class="hljs-property">versionManifest</span>[appName];
    
    <span class="hljs-comment">// ç°åº¦å‘å¸ƒé€»è¾‘</span>
    <span class="hljs-keyword">if</span> (userId &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isInGrayScale</span>(userId, appName)) {
      <span class="hljs-keyword">const</span> grayVersion = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getGrayVersion</span>(appName);
      <span class="hljs-keyword">return</span> grayVersion || defaultVersion;
    }
    
    <span class="hljs-keyword">return</span> defaultVersion;
  }
  
  <span class="hljs-comment">// è‡ªåŠ¨é™çº§æœºåˆ¶</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">loadWithFallback</span>(<span class="hljs-params">appName: <span class="hljs-built_in">string</span>, version: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadVersion</span>(appName, version);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`ç‰ˆæœ¬ <span class="hljs-subst">${version}</span> åŠ è½½å¤±è´¥ï¼Œå°è¯•å›é€€`</span>);
      
      <span class="hljs-comment">// å°è¯•ä¸Šä¸€ä¸ªç¨³å®šç‰ˆæœ¬</span>
      <span class="hljs-keyword">const</span> stableVersion = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getStableVersion</span>(appName);
      <span class="hljs-keyword">if</span> (stableVersion !== version) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadVersion</span>(appName, stableVersion);
      }
      
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`å¾®åº”ç”¨ <span class="hljs-subst">${appName}</span> åŠ è½½å¤±è´¥`</span>);
    }
  }
}
</code></pre>
<h2 data-id="heading-21">ç¬¬ä¸ƒç« ï¼šä»Monolithåˆ°å¾®å‰ç«¯â€”â€”çœŸå®è¿ç§»æ¡ˆä¾‹</h2>
<h3 data-id="heading-22">è¿ç§»å‰åçš„é‡åŒ–å¯¹æ¯”</h3>
<p><strong>æŸç”µå•†å¹³å°Vueé¡¹ç›®è¿ç§»æ•°æ®ï¼š</strong></p>









































<table><thead><tr><th>æŒ‡æ ‡</th><th>è¿ç§»å‰ï¼ˆå•ä½“ï¼‰</th><th>è¿ç§»åï¼ˆå¾®å‰ç«¯ï¼‰</th><th>æ”¹è¿›</th></tr></thead><tbody><tr><td>æ„å»ºæ—¶é—´</td><td>8åˆ†30ç§’</td><td>å¹³å‡1åˆ†20ç§’</td><td>â¬‡ï¸ 84%</td></tr><tr><td>é¦–å±åŠ è½½</td><td>3.2ç§’</td><td>1.8ç§’</td><td>â¬‡ï¸ 44%</td></tr><tr><td>å‘å¸ƒé¢‘ç‡</td><td>æ¯å‘¨1æ¬¡</td><td>æ¯æ—¥å¤šæ¬¡</td><td>â¬†ï¸ 500%+</td></tr><tr><td>å›¢é˜Ÿç‹¬ç«‹éƒ¨ç½²ç‡</td><td>0%</td><td>85%</td><td>â¬†ï¸ 85%</td></tr><tr><td>ç”Ÿäº§äº‹æ•…å½±å“èŒƒå›´</td><td>å…¨å±€</td><td>å•ä¸ªå¾®åº”ç”¨</td><td>â¬‡ï¸ 90%</td></tr></tbody></table>
<h3 data-id="heading-23">æ¸è¿›å¼è¿ç§»ç­–ç•¥ç¤ºä¾‹</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// è¿ç§»è·¯çº¿å›¾</span>
<span class="hljs-keyword">const</span> migrationRoadmap = [
  {
    <span class="hljs-attr">phase</span>: <span class="hljs-string">'å‡†å¤‡é˜¶æ®µ'</span>,
    <span class="hljs-attr">tasks</span>: [
      <span class="hljs-string">'æ­å»ºå¾®å‰ç«¯åŸºåº§'</span>,
      <span class="hljs-string">'é…ç½®æ„å»ºæµæ°´çº¿'</span>,
      <span class="hljs-string">'åˆ¶å®šé€šä¿¡åè®®'</span>,
      <span class="hljs-string">'åŸ¹è®­å¼€å‘å›¢é˜Ÿ'</span>
    ],
    <span class="hljs-attr">duration</span>: <span class="hljs-string">'2å‘¨'</span>
  },
  {
    <span class="hljs-attr">phase</span>: <span class="hljs-string">'ç¬¬ä¸€æœŸè¿ç§»'</span>,
    <span class="hljs-attr">tasks</span>: [
      <span class="hljs-string">'æŠ½ç¦»ç”¨æˆ·ä¸­å¿ƒï¼ˆä½é£é™©ï¼‰'</span>,
      <span class="hljs-string">'ç‹¬ç«‹éƒ¨ç½²è®¤è¯æ¨¡å—'</span>,
      <span class="hljs-string">'éªŒè¯æŠ€æœ¯æ–¹æ¡ˆå¯è¡Œæ€§'</span>
    ],
    <span class="hljs-attr">duration</span>: <span class="hljs-string">'3å‘¨'</span>
  },
  {
    <span class="hljs-attr">phase</span>: <span class="hljs-string">'æ ¸å¿ƒä¸šåŠ¡è¿ç§»'</span>,
    <span class="hljs-attr">tasks</span>: [
      <span class="hljs-string">'æ‹†è§£å•†å“è¯¦æƒ…é¡µ'</span>,
      <span class="hljs-string">'è¿ç§»è®¢å•æµç¨‹'</span>,
      <span class="hljs-string">'å®ç°è´­ç‰©è½¦å¾®åº”ç”¨'</span>
    ],
    <span class="hljs-attr">duration</span>: <span class="hljs-string">'6å‘¨'</span>
  },
  {
    <span class="hljs-attr">phase</span>: <span class="hljs-string">'æ”¶å°¾ä¸ä¼˜åŒ–'</span>,
    <span class="hljs-attr">tasks</span>: [
      <span class="hljs-string">'è¿ç§»å‰©ä½™æ¨¡å—'</span>,
      <span class="hljs-string">'æ€§èƒ½è°ƒä¼˜'</span>,
      <span class="hljs-string">'ç›‘æ§ä½“ç³»å®Œå–„'</span>,
      <span class="hljs-string">'æ–‡æ¡£æ•´ç†'</span>
    ],
    <span class="hljs-attr">duration</span>: <span class="hljs-string">'3å‘¨'</span>
  }
];
</code></pre>
<h2 data-id="heading-24">ç¬¬å…«ç« ï¼šé¿å‘æŒ‡å—ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-25">8.1 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h3>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">## ğŸ› é—®é¢˜1ï¼šå¾®åº”ç”¨æ ·å¼æ±¡æŸ“</span>
<span class="hljs-strong">**ç—‡çŠ¶**</span>ï¼šå¾®åº”ç”¨çš„CSSå½±å“äº†å…¶ä»–åº”ç”¨
<span class="hljs-strong">**è§£å†³æ–¹æ¡ˆ**</span>ï¼š
<span class="hljs-bullet">1.</span> å¯ç”¨qiankunçš„experimentalStyleIsolation
<span class="hljs-bullet">2.</span> ä½¿ç”¨CSS Modules + å‘½åç©ºé—´å‰ç¼€
<span class="hljs-bullet">3.</span> åŠ¨æ€æ ·å¼è¡¨åŠ è½½/å¸è½½

<span class="hljs-section">## ğŸ› é—®é¢˜2ï¼šå…¨å±€å˜é‡å†²çª</span>
<span class="hljs-strong">**ç—‡çŠ¶**</span>ï¼šå¤šä¸ªVueå®ä¾‹æˆ–Vuex storeå†²çª
<span class="hljs-strong">**è§£å†³æ–¹æ¡ˆ**</span>ï¼š
<span class="hljs-bullet">1.</span> ä½¿ç”¨æ²™ç®±æ¨¡å¼è¿è¡Œå¾®åº”ç”¨
<span class="hljs-bullet">2.</span> é¿å…ä¿®æ”¹windowå…¨å±€å¯¹è±¡
<span class="hljs-bullet">3.</span> é€šè¿‡propsä¼ é€’å…±äº«ä¾èµ–

<span class="hljs-section">## ğŸ› é—®é¢˜3ï¼šè·¯ç”±è·³è½¬å¼‚å¸¸</span>
<span class="hljs-strong">**ç—‡çŠ¶**</span>ï¼šå¾®åº”ç”¨å†…è·³è½¬å¯¼è‡´ä¸»åº”ç”¨è·¯ç”±æ··ä¹±
<span class="hljs-strong">**è§£å†³æ–¹æ¡ˆ**</span>ï¼š
<span class="hljs-bullet">1.</span> ç»Ÿä¸€ä½¿ç”¨ä¸»åº”ç”¨è·¯ç”±æ§åˆ¶
<span class="hljs-bullet">2.</span> å¾®åº”ç”¨ä½¿ç”¨ç›¸å¯¹è·¯å¾„
<span class="hljs-bullet">3.</span> å®ç°è·¯ç”±äº‹ä»¶ä»£ç†æœºåˆ¶

<span class="hljs-section">## ğŸ› é—®é¢˜4ï¼šé€šä¿¡å¤æ‚åº¦é«˜</span>
<span class="hljs-strong">**ç—‡çŠ¶**</span>ï¼šå¾®åº”ç”¨é—´é€šä¿¡ä»£ç æ··ä¹±
<span class="hljs-strong">**è§£å†³æ–¹æ¡ˆ**</span>ï¼š
<span class="hljs-bullet">1.</span> å®šä¹‰æ¸…æ™°çš„äº‹ä»¶é€šä¿¡åè®®
<span class="hljs-bullet">2.</span> ä½¿ç”¨çŠ¶æ€ç®¡ç†åº“ï¼ˆPiniaï¼‰ä½œä¸ºä¸­å¿ƒåŒ–store
<span class="hljs-bullet">3.</span> é™åˆ¶ç›´æ¥é€šä¿¡ï¼Œé€šè¿‡ä¸»åº”ç”¨ä¸­è½¬
</code></pre>
<h3 data-id="heading-26">8.2 Vueå¾®å‰ç«¯é»„é‡‘æ³•åˆ™</h3>
<ol>
<li><strong>å•ä¸€èŒè´£åŸåˆ™</strong>ï¼šæ¯ä¸ªå¾®åº”ç”¨åªè´Ÿè´£ä¸€ä¸ªä¸šåŠ¡é¢†åŸŸ</li>
<li><strong>æŠ€æœ¯æ ˆè‡ªç”±ä½†æœ‰é™åˆ¶</strong>ï¼šå…è®¸å¼‚æ„ï¼Œä½†è¦åˆ¶å®šæ ‡å‡†</li>
<li><strong>ç‹¬ç«‹å¯éƒ¨ç½²</strong>ï¼šæ¯ä¸ªå¾®åº”ç”¨éƒ½èƒ½ç‹¬ç«‹è¿è¡Œå’Œæµ‹è¯•</li>
<li><strong>å‘åå…¼å®¹</strong>ï¼šç¡®ä¿APIå’Œé€šä¿¡åè®®å‘åå…¼å®¹</li>
<li><strong>ç›‘æ§å…¨è¦†ç›–</strong>ï¼šæ¯ä¸ªå¾®åº”ç”¨éƒ½éœ€è¦ç‹¬ç«‹çš„ç›‘æ§å’Œæ—¥å¿—</li>
</ol>
<h2 data-id="heading-27">ç»“è¯­ï¼šå¾®å‰ç«¯ä¸æ˜¯é“¶å¼¹ï¼Œè€Œæ˜¯æ¶æ„æ¼”è¿›çš„å¿…ç»ä¹‹è·¯</h2>
<p>å¾®å‰ç«¯å¹¶ä¸æ˜¯è¦å–ä»£Vueçš„å•é¡µé¢åº”ç”¨æ¶æ„ï¼Œè€Œæ˜¯ä¸ºå…¶æä¾›ä¸€ç§å¯æ‰©å±•çš„è§£å†³æ–¹æ¡ˆã€‚å½“ä½ çš„Vueåº”ç”¨ä»â€œå°åˆ«å¢…â€æˆé•¿ä¸ºâ€œæ‘©å¤©å¤§æ¥¼â€æ—¶ï¼Œå¾®å‰ç«¯æä¾›äº†å¿…è¦çš„ç»“æ„æ”¯æ’‘ã€‚</p>
<p>è®°ä½ï¼ŒæŠ€æœ¯é€‰å‹çš„æ ¸å¿ƒä¸æ˜¯è¿½æ±‚æœ€æ–°æœ€é…·ï¼Œè€Œæ˜¯æ‰¾åˆ°æœ€é€‚åˆå›¢é˜Ÿå’Œä¸šåŠ¡åœºæ™¯çš„å¹³è¡¡ç‚¹ã€‚å¾®å‰ç«¯å¸¦æ¥çš„ä¸ä»…æ˜¯æŠ€æœ¯ä¸Šçš„è§£è€¦ï¼Œæ›´æ˜¯ç»„ç»‡æ¶æ„å’Œå¼€å‘æµç¨‹çš„ä¼˜åŒ–ã€‚</p>
<p><strong>Vue 3 + qiankunçš„å¾®å‰ç«¯æ–¹æ¡ˆï¼Œå·²ç»è¯æ˜æ˜¯ç”Ÿäº§å¯è¡Œçš„ã€‚ç°åœ¨ï¼Œæ˜¯æ—¶å€™å°†ä½ çš„å¤§å‹Vueåº”ç”¨å¸¦å…¥å¾®å‰ç«¯æ—¶ä»£äº†ã€‚</strong></p>
<hr/>
<p><strong>èµ„æºæ¨è</strong>ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fqiankun.umijs.org%2F" target="_blank" title="https://qiankun.umijs.org/" ref="nofollow noopener noreferrer">qiankunå®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvue-microfrontends" target="_blank" title="https://github.com/vue-microfrontends" ref="nofollow noopener noreferrer">Vue 3å¾®å‰ç«¯å®æˆ˜ä»£ç åº“</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodule-federation.io%2F" target="_blank" title="https://module-federation.io/" ref="nofollow noopener noreferrer">Module Federation with Vue</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmicro-frontends.org%2F" target="_blank" title="https://micro-frontends.org/" ref="nofollow noopener noreferrer">å¾®å‰ç«¯è®¾è®¡æ¨¡å¼</a></li>
</ul>
<p><em>æœ¬æ–‡é¦–å‘äºæ˜é‡‘æŠ€æœ¯ç¤¾åŒºï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚å¦‚æœä½ åœ¨Vueå¾®å‰ç«¯å®è·µä¸­é‡åˆ°é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµè®¨è®ºã€‚</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨äº†MySQLçš„INSERT ON DUPLICATE KEY UPDATEï¼Œæ€ä¹ˆè¿˜æŠ¥å”¯ä¸€ç´¢å¼•å†²çªé”™è¯¯]]></title>    <link>https://juejin.cn/post/7586901995429871625</link>    <guid>https://juejin.cn/post/7586901995429871625</guid>    <pubDate>2025-12-24T00:57:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586901995429871625" data-draft-id="7586703355646492699" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨äº†MySQLçš„INSERT ON DUPLICATE KEY UPDATEï¼Œæ€ä¹ˆè¿˜æŠ¥å”¯ä¸€ç´¢å¼•å†²çªé”™è¯¯"/> <meta itemprop="keywords" content="MySQL,åç«¯,SQL"/> <meta itemprop="datePublished" content="2025-12-24T00:57:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é’çŸ³è·¯"/> <meta itemprop="url" content="https://juejin.cn/user/1999357021005580"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨äº†MySQLçš„INSERT ON DUPLICATE KEY UPDATEï¼Œæ€ä¹ˆè¿˜æŠ¥å”¯ä¸€ç´¢å¼•å†²çªé”™è¯¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1999357021005580/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é’çŸ³è·¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T00:57:04.000Z" title="Wed Dec 24 2025 00:57:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼€å¿ƒä¸€åˆ»</h2>
<p>ä¸€å¤©ï¼Œè€å©†ç¬‘å®¹æ»¡é¢çš„å†²åˆ°æˆ‘é¢å‰<br/>
è€å©†ï¼šä½ å¨¶æˆ‘åˆ°åº•æ˜¯å›¾æˆ‘å•¥<br/>
æˆ‘ï¼šä¾¿å®œ<br/>
è€å©†ç¬‘å®¹ç¬é—´æ¶ˆå¤±ï¼Œæ°”å‘¼å‘¼çš„é“ï¼šä½ ä¼šä¸ä¼šè¯´è¯ï¼Ÿ<br/>
å¹¶ä¸”å¼ºè°ƒï¼šæˆ‘çˆ¸å½“å¹´é‚£æ˜¯å¯æ€œä½ ï¼Œæ²¡è·Ÿä½ å¤šè¦<br/>
æˆ‘ï¼šä¸æ˜¯ï¼Œä½ çˆ¸ä¸æ˜¯è¿™ä¹ˆè¯´çš„<br/>
è€å©†ï¼šé‚£æ€ä¹ˆè¯´çš„<br/>
æˆ‘å¼€å§‹å­¦ç€è€ä¸ˆäººçš„å£å»ï¼šä¸è®¸é€€ï¼Œç»™ä½ ä¾¿å®œç‚¹<br/></p>
<div align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/145c7b4e26194e5e81243a259cb88af9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S55-z6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767142624&amp;x-signature=XbcCvm3PTHFLzDz7MaVUbMmh9IY%3D" alt="å¼€å¿ƒä¸€åˆ»" loading="lazy"/></div>
<h2 data-id="heading-1">INSERT ON DUPLICATE KEY UPDATE</h2>
<p>å…³äº <code>INSERT ... ON DUPLICATE KEY UPDATE</code>ï¼Œç›¸ä¿¡å¤§å®¶éƒ½æœ‰æ‰€äº†è§£ï¼Œæ˜¯ <code>MySQL</code> é’ˆå¯¹</p>
<blockquote>
<p>ä¸å­˜åœ¨åˆ™æ’å…¥ï¼Œå­˜åœ¨åˆ™æ›´æ–°</p>
</blockquote>
<p>çš„ä¸€ç§æ–¹è¨€å®ç°ï¼›<code>å­˜ä¸å­˜åœ¨</code> è¯¥å¦‚ä½•åˆ¤å®šå‘¢ï¼ŒåŸºäºè¡¨çš„ <code>å”¯ä¸€ç´¢å¼•</code> æˆ– <code>ä¸»é”®</code></p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœåˆ— <code>a</code> è¢«å£°æ˜ä¸º <code>å”¯ä¸€</code> ä¸”è¡¨ä¸­å·²ç»å­˜åœ¨ <code>a=1</code> çš„è®°å½•ï¼Œåˆ™ä»¥ä¸‹ä¸¤æ¡è¯­å¥å…·æœ‰ç±»ä¼¼çš„æ•ˆæœ</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t1 (a,b,c) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>)
  <span class="hljs-keyword">ON</span> DUPLICATE KEY <span class="hljs-keyword">UPDATE</span> c<span class="hljs-operator">=</span>c<span class="hljs-operator">+</span><span class="hljs-number">1</span>;

<span class="hljs-keyword">UPDATE</span> t1 <span class="hljs-keyword">SET</span> c<span class="hljs-operator">=</span>c<span class="hljs-operator">+</span><span class="hljs-number">1</span> <span class="hljs-keyword">WHERE</span> a<span class="hljs-operator">=</span><span class="hljs-number">1</span>;
</code></pre>
<p>å‡è®¾æˆ‘ä»¬æœ‰è¡¨</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `tbl_insert_on_update` (
  `id` <span class="hljs-type">bigint</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  `name` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  `uk_column1` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  `uk_column2` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  `remark` text,
  <span class="hljs-keyword">PRIMARY</span> KEY (`id`),
  <span class="hljs-keyword">UNIQUE</span> KEY `name` (`name`)
) ENGINE<span class="hljs-operator">=</span>InnoDB
</code></pre>
<p>ä¸€å¼€å§‹è¡¨ä¸­æ²¡æœ‰æ•°æ®ï¼Œé‚£ä¹ˆ</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> tbl_insert_on_update(id, name, uk_column1, uk_column2, remark)
<span class="hljs-keyword">VALUES</span>(<span class="hljs-number">1</span>, <span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-string">'20050101001'</span>, <span class="hljs-string">'ç”·ä¸€å·'</span>, <span class="hljs-string">'é£ä¸€æ ·çš„ç”·å­'</span>)
<span class="hljs-keyword">ON</span> DUPLICATE KEY <span class="hljs-keyword">UPDATE</span> uk_column1<span class="hljs-operator">=</span><span class="hljs-string">'20050101002'</span>, uk_column2<span class="hljs-operator">=</span><span class="hljs-string">'ç”·äºŒå·'</span>, remark<span class="hljs-operator">=</span><span class="hljs-string">'ç‹‚é£ä¸€æ ·çš„ç”·å­'</span>;
</code></pre>
<p>çš„ä½œç”¨ï¼Œç›¸ä¿¡å¤§å®¶éƒ½çŸ¥é“ï¼Œä¸</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> tbl_insert_on_update(id, name, uk_column1, uk_column2, remark)
<span class="hljs-keyword">VALUES</span>(<span class="hljs-number">1</span>, <span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-string">'20050101001'</span>, <span class="hljs-string">'ç”·ä¸€å·'</span>, <span class="hljs-string">'é£ä¸€æ ·çš„ç”·å­'</span>);
</code></pre>
<p>ä½œç”¨ä¸€æ ·ï¼Œä¼šå¾€è¡¨ä¸­æ’å…¥ä¸€æ¡æ–°çš„è®°å½•ï¼›å¦‚æœå†æ‰§è¡Œä¸€æ¬¡</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> tbl_insert_on_update(id, name, uk_column1, uk_column2, remark)
<span class="hljs-keyword">VALUES</span>(<span class="hljs-number">1</span>, <span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-string">'20050101001'</span>, <span class="hljs-string">'ç”·ä¸€å·'</span>, <span class="hljs-string">'é£ä¸€æ ·çš„ç”·å­'</span>)
<span class="hljs-keyword">ON</span> DUPLICATE KEY <span class="hljs-keyword">UPDATE</span> uk_column1<span class="hljs-operator">=</span><span class="hljs-string">'20050101002'</span>, uk_column2<span class="hljs-operator">=</span><span class="hljs-string">'ç”·äºŒå·'</span>, remark<span class="hljs-operator">=</span><span class="hljs-string">'ç‹‚é£ä¸€æ ·çš„ç”·å­'</span>;
</code></pre>
<p>å‘¢ï¼Œä¼šæ˜¯æ€ä¹ˆæ ·çš„ç»“æœï¼Ÿç›¸ä¿¡å¤§å®¶éƒ½çŸ¥é“</p>
<div align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a67391724fdd49c49a4b8c777679d035~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S55-z6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767142624&amp;x-signature=und9tkxAabtRGe70a0t6Ow2CfWo%3D" alt="insert_on_update_å†æ‰§è¡Œä¸€æ¬¡" loading="lazy"/></div>
<p>ä¸</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">UPDATE</span> tbl_insert_on_update <span class="hljs-keyword">SET</span> uk_column1<span class="hljs-operator">=</span><span class="hljs-string">'20050101002'</span>, uk_column2<span class="hljs-operator">=</span><span class="hljs-string">'ç”·äºŒå·'</span>, remark<span class="hljs-operator">=</span><span class="hljs-string">'ç‹‚é£ä¸€æ ·çš„ç”·å­'</span> <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
</code></pre>
<p>çš„æ•ˆæœä¸€æ ·ã€‚æˆ‘ä»¬æ¥ç€åšä¸ªç®€å•è°ƒæ•´ï¼Œæ‹¿æ‰ <code>name</code></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> tbl_insert_on_update(id, uk_column1, uk_column2, remark)
<span class="hljs-keyword">VALUES</span>(<span class="hljs-number">1</span>, <span class="hljs-string">'20050101001'</span>, <span class="hljs-string">'ç”·ä¸€å·'</span>, <span class="hljs-string">'é£ä¸€æ ·çš„ç”·å­'</span>)
<span class="hljs-keyword">ON</span> DUPLICATE KEY <span class="hljs-keyword">UPDATE</span> uk_column1<span class="hljs-operator">=</span><span class="hljs-string">'20050101003'</span>, uk_column2<span class="hljs-operator">=</span><span class="hljs-string">'ç”·ä¸‰å·'</span>, remark<span class="hljs-operator">=</span><span class="hljs-string">'æš´é£ä¸€æ ·çš„ç”·å­'</span>;
</code></pre>
<p>æˆ–è€…æ‹¿æ‰ <code>id</code></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> tbl_insert_on_update(name, uk_column1, uk_column2, remark)
<span class="hljs-keyword">VALUES</span>(<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-string">'20050101001'</span>, <span class="hljs-string">'ç”·ä¸€å·'</span>, <span class="hljs-string">'é£ä¸€æ ·çš„ç”·å­'</span>)
<span class="hljs-keyword">ON</span> DUPLICATE KEY <span class="hljs-keyword">UPDATE</span> uk_column1<span class="hljs-operator">=</span><span class="hljs-string">'20050101003'</span>, uk_column2<span class="hljs-operator">=</span><span class="hljs-string">'ç”·ä¸‰å·'</span>, remark<span class="hljs-operator">=</span><span class="hljs-string">'æš´é£ä¸€æ ·çš„ç”·å­'</span>;
</code></pre>
<p>ä¼šæ˜¯æ€ä¹ˆæ ·çš„ä¸€ä¸ªç»“æœï¼Œä½ ä»¬å¯ä»¥å¤§èƒ†çŒœä¸€ä¸‹ã€‚è¿™ä¸¤ä¸ª SQL çš„æ‰§è¡Œç»“æœæ˜¯ä¸€æ ·çš„</p>
<div align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fcc56051e4c24b888d7ccb70fed7bba3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S55-z6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767142624&amp;x-signature=W%2BDJ5QTi1N%2BUfCrqrtRoX2vn0ik%3D" alt="ç”·ä¸‰æµ©" loading="lazy"/></div>
<p>æ­¤æ—¶ä½ ä»¬æ˜¯ä¸æ˜¯æœ‰ç–‘é—®å‘¢</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆæ‹¿æ‰ <code>name</code> å’Œæ‹¿æ‰ <code>id</code> çš„ INSERT ... ON DUPLICATE KEY UPDATE çš„æ‰§è¡Œç»“æœä¼šæ˜¯ä¸€æ ·çš„ï¼Ÿ</p>
</blockquote>
<p>è¿™ä¸ªé—®é¢˜å…ˆæ”¾ä¸€æ”¾ï¼Œæˆ‘ä»¬å…ˆå½•å…¥å¥³ä¸€å·çš„æ•°æ®</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> tbl_insert_on_update(id, name, uk_column1, uk_column2, remark)
<span class="hljs-keyword">VALUES</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'å©‰å„¿'</span>, <span class="hljs-string">'20050101001X'</span>, <span class="hljs-string">'å¥³ä¸€å·'</span>, <span class="hljs-string">'èŠ±ä¸€æ ·çš„å¥³å­'</span>);
</code></pre>
<p>å‡è®¾æˆ‘ä»¬è¦ä¿®æ”¹å¥³ä¸€å·çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ <code>å§“å</code>ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥è¿™ä¹ˆå®ç°</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> tbl_insert_on_update(id, name, uk_column1, uk_column2, remark)
<span class="hljs-keyword">VALUES</span>(<span class="hljs-number">2</span>, <span class="hljs-string">'å©‰å„¿'</span>, <span class="hljs-string">'20050101001X'</span>, <span class="hljs-string">'å¥³ä¸€å·'</span>, <span class="hljs-string">'èŠ±ä¸€æ ·çš„å¥³å­'</span>)
<span class="hljs-keyword">ON</span> DUPLICATE KEY <span class="hljs-keyword">UPDATE</span>, name<span class="hljs-operator">=</span><span class="hljs-string">'å¼ ä¸‰'</span>, uk_column1<span class="hljs-operator">=</span><span class="hljs-string">'20050101002X'</span>, uk_column2<span class="hljs-operator">=</span><span class="hljs-string">'å¥³äºŒå·'</span>, remark<span class="hljs-operator">=</span><span class="hljs-string">'ç‰µç‰›èŠ±ä¸€æ ·çš„å¥³å­'</span>;
</code></pre>
<p>æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Œæ‰§è¡Œä¸‹å°±çŸ¥é“äº†å˜›</p>
<div align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80d7289949da4d01b4e54029844f72f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S55-z6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767142624&amp;x-signature=%2BaD5b68%2Fb3%2FAFjXpF2yQROcxhfU%3D" alt="å”¯ä¸€ç´¢å¼•å†²çª" width="90%" loading="lazy"/></div>
<p>æ‰§è¡ŒæŠ¥é”™äº†ï¼Œæç¤º</p>
<blockquote>
<p>1062 - Duplicate entry 'å¼ ä¸‰' for key 'tbl_insert_on_update.name'</p>
</blockquote>
<p>è¿™ä¸ªé”™è¯¯ä¿¡æ¯æˆ‘ä»¬æ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Ÿä¸å°±æ˜¯å”¯ä¸€ç´¢å¼•å†²çªå—ï¼Ÿé‚£ä¹ˆé—®é¢˜åˆæ¥äº†</p>
<blockquote>
<p>ç”¨äº†MySQLçš„INSERT ON DUPLICATE KEY UPDATEï¼Œä¸ºä»€ä¹ˆè¿˜ä¼šå”¯ä¸€ç´¢å¼•å†²çªï¼Ÿ</p>
</blockquote>
<h2 data-id="heading-2">å¦‚ä½•åˆ¤æ–­æ˜¯å¦å­˜åœ¨</h2>
<p>æˆ‘ä»¬å†™ <code>INSERT ... ON DUPLICATE KEY UPDATE</code> è¯­å¥æ—¶ï¼Œå¹¶æœªæŒ‡å®šç”¨å“ªä¸ª <code>ä¸»é”®</code> æˆ–è€… <code>å”¯ä¸€ç´¢å¼•</code> æ¥åˆ¤å®šè®°å½•æ˜¯å¦å­˜åœ¨</p>
<blockquote>
<p>Oracleã€SQL Serverã€PostgreSQL çš„ <code>MERGE</code> æœ‰ç±»ä¼¼ä½œç”¨</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">MERGE</span> <span class="hljs-keyword">INTO</span> TBL_INSERT_ON_UPDATE t
<span class="hljs-keyword">USING</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">AS</span> ID, <span class="hljs-string">'å¼ ä¸‰'</span> <span class="hljs-keyword">AS</span> NAME, <span class="hljs-string">'20050101001'</span> <span class="hljs-keyword">AS</span> UK_COLUMN1, <span class="hljs-string">'ç”·ä¸€å·'</span> <span class="hljs-keyword">AS</span> UK_COLUMN2, <span class="hljs-string">'é£ä¸€æ ·çš„ç”·å­'</span> <span class="hljs-keyword">AS</span> REMARK <span class="hljs-keyword">FROM</span> dual
) s
<span class="hljs-keyword">ON</span> (t.NAME <span class="hljs-operator">=</span> s.NAME)  <span class="hljs-comment">-- åŸºäº NAME å­—æ®µåŒ¹é…</span>
<span class="hljs-keyword">WHEN</span> MATCHED <span class="hljs-keyword">THEN</span>
    <span class="hljs-keyword">UPDATE</span> <span class="hljs-keyword">SET</span>
        t.ID <span class="hljs-operator">=</span> s.ID,
        t.UK_COLUMN1 <span class="hljs-operator">=</span> s.UK_COLUMN1,
        t.UK_COLUMN2 <span class="hljs-operator">=</span> s.UK_COLUMN2,
        t.REMARK <span class="hljs-operator">=</span> s.REMARK
<span class="hljs-keyword">WHEN</span> <span class="hljs-keyword">NOT</span> MATCHED <span class="hljs-keyword">THEN</span>
    <span class="hljs-keyword">INSERT</span> (ID, NAME, UK_COLUMN1, UK_COLUMN2, REMARK)
    <span class="hljs-keyword">VALUES</span> (s.ID, s.NAME, s.UK_COLUMN1, s.UK_COLUMN2, s.REMARK);
</code></pre>
<p>å…¶ä¸­çš„ <code>ON</code>  æ˜ç¡®æŒ‡å®šåŒ¹é…å­—æ®µï¼ˆæ ¹æ®å“ªäº›å­—æ®µåˆ¤æ–­è®°å½•æ˜¯å¦å­˜åœ¨ï¼‰ï¼Œä¸€èˆ¬æ˜¯æŒ‡å®š <code>ä¸»é”®</code>å­—æ®µæˆ– <code>å”¯ä¸€ç´¢å¼•</code>å­—æ®µ</p>
</blockquote>
<p>é‚£ MySQL æ˜¯å¦‚ä½•åˆ¤å®šè®°å½•æ˜¯å¦å­˜åœ¨çš„å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç¿»é˜…ä¸‹å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.mysql.com%2Fdoc%2Frefman%2F8.0%2Fen%2Finsert-on-duplicate.html" target="_blank" title="https://dev.mysql.com/doc/refman/8.0/en/insert-on-duplicate.html" ref="nofollow noopener noreferrer">INSERT ... ON DUPLICATE KEY UPDATE Statement</a>ã€‚ä¸€å¼€å¤´æœ‰å¦‚ä¸‹ä¸€æ®µæè¿°</p>
<blockquote>
<p>If you specify an <code>ON DUPLICATE KEY UPDATE</code> clause and a row to be inserted would cause a duplicate value in a <code>UNIQUE</code> index or <code>PRIMARY KEY</code>, an <a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.mysql.com%2Fdoc%2Frefman%2F8.0%2Fen%2Fupdate.html" target="_blank" title="https://dev.mysql.com/doc/refman/8.0/en/update.html" ref="nofollow noopener noreferrer"><code>UPDATE</code></a> of the old row occurs</p>
<p>å½“æˆ‘ä»¬ä½¿ç”¨ <code>ON DUPLICATE KEY UPDATE</code>  å­å¥æ—¶ï¼Œæ’å…¥çš„è¡Œå¯¼è‡´ <code>å”¯ä¸€</code> ç´¢å¼•æˆ–è€… <code>ä¸»é”®</code> é‡å¤æ—¶ï¼Œä¼šæ›´æ–°æ—§çš„è¡Œ</p>
</blockquote>
<p>é€šè¿‡è¿™æ®µè¯ï¼Œæˆ‘ä»¬åªçŸ¥é“ MySQL æ˜¯æ ¹æ®å”¯ä¸€ç´¢å¼•æˆ–ä¸»é”®æ¥åˆ¤å®šè¡Œæ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸çŸ¥é“</p>
<ol>
<li>å…ˆæ ¹æ®ä¸»é”®åˆ¤å®šï¼Œä¸å†²çªä¹‹åå†æ ¹æ®å”¯ä¸€ç´¢å¼•åˆ¤å®šï¼Ÿ</li>
<li>æœ‰å¤šä¸ªå”¯ä¸€ç´¢å¼•æ—¶ï¼Œè¿™äº›å”¯ä¸€ç´¢å¼•çš„åˆ¤å®šä¼˜å…ˆçº§æ˜¯æ€æ ·çš„ï¼Ÿ</li>
</ol>
<p>å®˜æ–¹æ–‡æ¡£é‡Œé¢å¹¶æœªæ˜ç¡®è¯´æ˜è¿™äº›é—®é¢˜ï¼Œåªæ˜¯åœ¨ç»“å°¾è¿›è¡Œäº†å¦‚ä¸‹è¯´æ˜</p>
<blockquote>
<p>An <a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.mysql.com%2Fdoc%2Frefman%2F8.0%2Fen%2Finsert-on-duplicate.html" target="_blank" title="https://dev.mysql.com/doc/refman/8.0/en/insert-on-duplicate.html" ref="nofollow noopener noreferrer"><code>INSERT ... ON DUPLICATE KEY UPDATE</code></a> statement against a table having more than one unique or primary key is also marked as unsafe. (Bug #11765650, Bug #58637)</p>
<p>å½“è¡¨ä¸­æœ‰å¤šä¸ªå”¯ä¸€ç´¢å¼•æˆ–è€…ä¸»é”®æ—¶ï¼ŒINSERT ... ON DUPLICATE KEY UPDATE è¯­å¥ä¸å®‰å…¨</p>
</blockquote>
<p>ä¸å®‰å…¨ä»£è¡¨æ‰§è¡Œç»“æœä¸å›ºå®šï¼Œä¼šå‡ºç°æˆ‘ä»¬é¢„æœŸä¹‹å¤–çš„ç»“æœ</p>
<h2 data-id="heading-3">å·¥ä½œåŸç†</h2>
<p>å¦‚æœè®©ä½ ä»¬æ¥å®ç° <code>ä¸å­˜åœ¨åˆ™æ’å…¥ï¼Œå­˜åœ¨åˆ™æ›´æ–°</code>ï¼Œä½ ä»¬ä¼šæ€ä¹ˆå®ç°ï¼Ÿ</p>
<p>é€ä¸ªæŸ¥è¯¢ä¸»é”®ä»¥åŠæ‰€æœ‰å”¯ä¸€ç´¢å¼•ï¼Œåˆ¤æ–­è¯¥è¡Œæ•°æ®æ˜¯å¦å­˜åœ¨ï¼Œä¸€æ—¦å­˜åœ¨åˆ™æ ¹æ®é‡å¤çš„ä¸»é”®æˆ–è€…å”¯ä¸€ç´¢å¼•è¿›è¡Œ <code>UPDATE</code>ï¼Œéƒ½ä¸å­˜åœ¨åˆ™è¿›è¡Œ <code>INSERT</code>ï¼›è¿™ä¸ä»…æ˜¯ä½ ä»¬æœ€å®¹æ˜“æƒ³åˆ°çš„å®ç°æ–¹å¼ï¼Œä¹Ÿæ˜¯æˆ‘æœ€å®¹æ˜“æƒ³åˆ°çš„æ–¹å¼ã€‚</p>
<p>ä½† MySQL å¹¶æœªé‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œè€Œæ˜¯é‡‡ç”¨äº†å¦å¤–ä¸€ç§æ›´é«˜æ•ˆçš„æ–¹å¼ï¼Œå…ˆå°è¯•æ’å…¥ï¼Œå­˜å‚¨å¼•æ“ä¼šå‘<strong>æ‰€æœ‰ç›¸å…³çš„å”¯ä¸€ç´¢å¼•ï¼ˆåŒ…æ‹¬ä¸»é”®ï¼‰</strong> ä¸­æ’å…¥å¯¹åº”çš„ç´¢å¼•æ¡ç›®ï¼Œå¦‚æœéƒ½æ’å…¥æˆåŠŸï¼Œè¯´æ˜æ•°æ®è¡Œä¸å­˜åœ¨ï¼Œé‚£ä¹ˆ <code>INSERT</code> æ•°æ®è¡Œï¼›ä¸€æ—¦å­˜å‚¨å¼•æ“å°è¯•æ’å…¥æŸä¸ªå”¯ä¸€ç´¢å¼•æ—¶ï¼Œå‘ç°è¯¥æ•°æ®è¡Œå·²ç»å­˜åœ¨ï¼Œä¼šç«‹å³åœæ­¢æ’å…¥åŠ¨ä½œï¼Œå¹¶å‘MySQLæœåŠ¡å±‚æŠ›å‡º <code>é‡å¤é”®</code> é”™è¯¯ï¼ŒæœåŠ¡å±‚æ”¶åˆ°é‡å¤é”®é”™è¯¯åï¼Œå¹¶ä¸ä¼šè®©æ•´ä¸ªè¯­å¥å¤±è´¥ï¼ˆå› ä¸ºä½¿ç”¨äº† ON DUPLICATE KEY UPDATE å­å¥ï¼‰ï¼Œè€Œæ˜¯è½¬æ¢æ‰§è¡Œæ¨¡å¼ï¼Œä¼šå…ˆå›æ»šä¹‹å‰çš„æ’å…¥ï¼Œç„¶åæ ¹æ®é‡å¤çš„é‚£ä¸ªå”¯ä¸€ç´¢å¼•æ‰¾åˆ°æ•°æ®è¡Œå¯¹åº”çš„ <code>æ—§è¡Œ</code> æ•°æ®ï¼Œæœ€å <code>UPDATE</code> æ•°æ®è¡Œï¼›æ€»ç»“ä¸‹æ¥åˆ†ä¸‰æ­¥</p>
<ol>
<li>
<p>å°è¯•æ’å…¥</p>
<p>æ‰€æœ‰å”¯ä¸€ç´¢å¼•ï¼ˆåŒ…æ‹¬ä¸»é”®ï¼‰éƒ½æ’å…¥æˆåŠŸï¼Œåˆ™æ’å…¥æ•°æ®è¡Œï¼Œç›¸å½“äºå®Œæˆæ™®é€šçš„ <code>INSERT</code></p>
<p>ä¸€æ—¦æŸä¸ªå”¯ä¸€ç´¢å¼•æ’å…¥å¤±è´¥ï¼Œåˆ™ç«‹å³åœæ­¢æ’å…¥ï¼Œå­˜å‚¨å¼•æ“ä¼šå‘ä¸Šå±‚æŠ›å‡ºä¸€ä¸ª <code>é‡å¤é”®</code> é”™è¯¯</p>
</li>
<li>
<p>æ¨¡å¼è½¬æ¢</p>
<p>MySQLæœåŠ¡å™¨æ”¶åˆ°é‡å¤é”®åï¼Œå‘ç°æ‰§è¡Œè¯­å¥ä¸­æœ‰ <code>ON DUPLICATE KEY UPDATE</code> å­å¥ï¼Œä¸ä¼šç›´æ¥è®©æ•´ä¸ªè¯­å¥å¤±è´¥ï¼Œè€Œæ˜¯å…ˆå›æ»šä¹‹å‰çš„é‚£éƒ¨åˆ†å”¯ä¸€ç´¢å¼•çš„æ’å…¥ï¼Œç„¶åæ ¹æ®æ’å…¥å¤±è´¥çš„å”¯ä¸€ç´¢å¼•æ‰¾åˆ°å·²ç»å­˜åœ¨çš„ <code>æ—§è¡Œ</code></p>
</li>
<li>
<p>æ‰§è¡Œæ›´æ–°</p>
<p>æ ¹æ®æ’å…¥å¤±è´¥çš„å”¯ä¸€ç´¢å¼•ï¼Œå¯¹æ—§è¡Œæ‰§è¡Œæ›´æ–°æ“ä½œï¼Œç›¸å½“äºå®Œæˆæ™®é€šçš„ <code>UPDATE</code></p>
</li>
</ol>
<p>æ•´ä¸ª <code>å°è¯•-å¤±è´¥-è½¬æ¢-æ›´æ–°</code> è¿‡ç¨‹æ—¶ä¸€ä¸ªåŸå­æ“ä½œï¼Œé‚£ä¹ˆå®Œå…¨æˆåŠŸï¼Œè¦ä¹ˆå®Œå…¨å¤±è´¥ï¼›ç›¸æ¯”äº <code>å…ˆæŸ¥è¯¢ååˆ¤æ–­</code> çš„ä¼ ç»Ÿå®ç°ï¼Œè¿™ç§å®ç°æ–¹å¼æ•ˆç‡æ›´é«˜ã€‚</p>
<h2 data-id="heading-4">é—®é¢˜ç­”ç–‘</h2>
<p>å‰é¢æ¶‰åŠåˆ°ä¸¤ä¸ªé—®é¢˜ï¼Œç°åœ¨æˆ‘ä»¬æ¥è§£æƒ‘ä¸‹</p>
<ol>
<li>
<p>ä¸ºä»€ä¹ˆæ‹¿æ‰ <code>name</code> å’Œæ‹¿æ‰ <code>id</code> çš„ INSERT ... ON DUPLICATE KEY UPDATE çš„æ‰§è¡Œç»“æœä¼šæ˜¯ä¸€æ ·çš„ï¼Ÿ</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æ‹¿æ‰name</span>
<span class="hljs-keyword">INSERT</span> tbl_insert_on_update(id, uk_column1, uk_column2, remark)
<span class="hljs-keyword">VALUES</span>(<span class="hljs-number">1</span>, <span class="hljs-string">'20050101001'</span>, <span class="hljs-string">'ç”·ä¸€å·'</span>, <span class="hljs-string">'é£ä¸€æ ·çš„ç”·å­'</span>)
<span class="hljs-keyword">ON</span> DUPLICATE KEY <span class="hljs-keyword">UPDATE</span> uk_column1<span class="hljs-operator">=</span><span class="hljs-string">'20050101003'</span>, uk_column2<span class="hljs-operator">=</span><span class="hljs-string">'ç”·ä¸‰å·'</span>, remark<span class="hljs-operator">=</span><span class="hljs-string">'æš´é£ä¸€æ ·çš„ç”·å­'</span>;

<span class="hljs-comment">-- æ‹¿æ‰id</span>
<span class="hljs-keyword">INSERT</span> tbl_insert_on_update(name, uk_column1, uk_column2, remark)
<span class="hljs-keyword">VALUES</span>(<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-string">'20050101001'</span>, <span class="hljs-string">'ç”·ä¸€å·'</span>, <span class="hljs-string">'é£ä¸€æ ·çš„ç”·å­'</span>)
<span class="hljs-keyword">ON</span> DUPLICATE KEY <span class="hljs-keyword">UPDATE</span> uk_column1<span class="hljs-operator">=</span><span class="hljs-string">'20050101003'</span>, uk_column2<span class="hljs-operator">=</span><span class="hljs-string">'ç”·ä¸‰å·'</span>, remark<span class="hljs-operator">=</span><span class="hljs-string">'æš´é£ä¸€æ ·çš„ç”·å­'</span>;
</code></pre>
<p>è¿™ä¸ªé—®é¢˜æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥åˆ†æä¸‹</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> tbl_insert_on_update(id, uk_column1, uk_column2, remark)
<span class="hljs-keyword">VALUES</span>(<span class="hljs-number">1</span>, <span class="hljs-string">'20050101001'</span>, <span class="hljs-string">'ç”·ä¸€å·'</span>, <span class="hljs-string">'é£ä¸€æ ·çš„ç”·å­'</span>)
<span class="hljs-keyword">ON</span> DUPLICATE KEY <span class="hljs-keyword">UPDATE</span> uk_column1<span class="hljs-operator">=</span><span class="hljs-string">'20050101003'</span>, uk_column2<span class="hljs-operator">=</span><span class="hljs-string">'ç”·ä¸‰å·'</span>, remark<span class="hljs-operator">=</span><span class="hljs-string">'æš´é£ä¸€æ ·çš„ç”·å­'</span>;
</code></pre>
<p>INSERT çš„å­—æ®µä¸­æ²¡æœ‰ <code>name</code>ï¼Œä½†æœ‰ <code>id</code>ï¼Œå¯æƒ³è€ŒçŸ¥åˆ¤æ–­æ•°æ®è¡Œæ˜¯å¦å­˜åœ¨ï¼Œç”¨åˆ°çš„æ˜¯ <code>ä¸»é”®</code>ï¼Œå› ä¸º <code>id=1</code> çš„è®°å½•å·²ç»å­˜åœ¨ï¼Œæ‰€ä»¥æ ¹æ® id å»æ›´æ–°å…¶ä»–å­—æ®µå€¼ï¼›é‚£ä¹ˆæ‰§è¡Œç»“æœä¸å¦‚ä¸‹ SQL ä¸€è‡´</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">UPDATE</span> tbl_insert_on_update <span class="hljs-keyword">SET</span> uk_column1<span class="hljs-operator">=</span><span class="hljs-string">'20050101003'</span>, uk_column2<span class="hljs-operator">=</span><span class="hljs-string">'ç”·ä¸‰å·'</span>, remark<span class="hljs-operator">=</span><span class="hljs-string">'æš´é£ä¸€æ ·çš„ç”·å­'</span> <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
</code></pre>
<p>åŒç†</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> tbl_insert_on_update(name, uk_column1, uk_column2, remark)
<span class="hljs-keyword">VALUES</span>(<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-string">'20050101001'</span>, <span class="hljs-string">'ç”·ä¸€å·'</span>, <span class="hljs-string">'é£ä¸€æ ·çš„ç”·å­'</span>)
<span class="hljs-keyword">ON</span> DUPLICATE KEY <span class="hljs-keyword">UPDATE</span> uk_column1<span class="hljs-operator">=</span><span class="hljs-string">'20050101003'</span>, uk_column2<span class="hljs-operator">=</span><span class="hljs-string">'ç”·ä¸‰å·'</span>, remark<span class="hljs-operator">=</span><span class="hljs-string">'æš´é£ä¸€æ ·çš„ç”·å­'</span>;
</code></pre>
<p>INSERT çš„å­—æ®µä¸­æ²¡æœ‰ <code>id</code>ï¼Œä½†æœ‰ <code>name</code>ï¼Œå¯æƒ³è€ŒçŸ¥åˆ¤æ–­æ•°æ®è¡Œæ˜¯å¦å­˜åœ¨ï¼Œç”¨åˆ°çš„æ˜¯ <code>å”¯ä¸€ç´¢å¼•</code>ï¼Œå› ä¸º <code>name=å¼ ä¸‰</code> çš„è®°å½•å·²ç»å­˜åœ¨ï¼Œæ‰€ä»¥æ ¹æ® name å»æ›´æ–°å…¶ä»–å­—æ®µå€¼ï¼›é‚£ä¹ˆæ‰§è¡Œç»“æœä¸å¦‚ä¸‹ SQL ä¸€è‡´</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">UPDATE</span> tbl_insert_on_update <span class="hljs-keyword">SET</span> uk_column1<span class="hljs-operator">=</span><span class="hljs-string">'20050101003'</span>, uk_column2<span class="hljs-operator">=</span><span class="hljs-string">'ç”·ä¸‰å·'</span>, remark<span class="hljs-operator">=</span><span class="hljs-string">'æš´é£ä¸€æ ·çš„ç”·å­'</span> <span class="hljs-keyword">WHERE</span> name <span class="hljs-operator">=</span> <span class="hljs-string">'å¼ ä¸‰'</span>;
</code></pre>
<p><code>id = 1</code> ä¸ <code>name = 'å¼ ä¸‰'</code> æŒ‡å‘çš„æœ¬æ¥å°±æ˜¯åŒä¸€è¡Œæ•°æ®ï¼Œæ›´æ–°çš„åˆ—ä¸åˆ—å€¼éƒ½ä¸€è‡´ï¼Œé‚£ä¹ˆæ‰§è¡Œç»“æœè‡ªç„¶å°±ä¸€æ ·äº†</p>
</li>
<li>
<p>å­˜åœ¨å¤šä¸ªå”¯ä¸€ç´¢å¼•ï¼ˆåŒ…å«ä¸»é”®ï¼‰æ—¶ï¼Œåˆ¤æ–­æ•°æ®è¡Œæ˜¯å¦å­˜åœ¨ï¼Œè¿™äº›å”¯ä¸€ç´¢å¼•çš„ä¼˜å…ˆçº§é¡ºåºæ˜¯æ€æ ·çš„ï¼Ÿ</p>
<p>MySQL å®˜æ–¹æ–‡æ¡£å¹¶æœªæ˜ç¡®è¯´æ˜è¿™ä¸ªä¼˜å…ˆçº§é¡ºåºï¼Œä½†åœ¨ MySQL çš„å®ç°ä¸­è‚¯å®šæœ‰è¿™ä¸ªä¼˜å…ˆçº§é¡ºåºçš„å®ç°ç®—æ³•ï¼Œå¯èƒ½è·Ÿç‰ˆæœ¬ã€å­˜å‚¨å¼•æ“æœ‰å…³</p>
<p>åŸºäº <code>8.0.31</code> ç‰ˆæœ¬ï¼Œç®€å•æµ‹è¯•å‡ºä»¥ä¸‹ä¼˜å…ˆçº§</p>
<blockquote>
<p>ä¸»é”® &gt; å”¯ä¸€ç´¢å¼•</p>
<p>å”¯ä¸€ç´¢å¼•ä¹‹é—´æŒ‰åˆ›å»ºé¡ºåºï¼Œå…ˆåˆ›å»ºçš„ä¼˜å…ˆçº§é«˜</p>
</blockquote>
<p>å®˜æ–¹æ–‡æ¡£å·²ç»æ˜ç¡®è¯´æ˜ï¼šå½“è¡¨ä¸­æœ‰å¤šä¸ªå”¯ä¸€ç´¢å¼•æˆ–è€…ä¸»é”®æ—¶ï¼ŒINSERT ... ON DUPLICATE KEY UPDATE è¯­å¥ä¸å®‰å…¨ï¼Œæ‰€ä»¥å¦‚ä¸Šçš„æµ‹è¯•ç»“æœå¹¶ä¸å…·å¤‡ç¡®å®šæ€§ï¼Œä¸èƒ½ä½œä¸ºä½¿ç”¨å‡†åˆ™</p>
</li>
<li>
<p>ç”¨äº†MySQLçš„INSERT ON DUPLICATE KEY UPDATEï¼Œæ€ä¹ˆè¿˜æŠ¥å”¯ä¸€ç´¢å¼•å†²çªé”™è¯¯</p>
<p>MySQLæ˜¯åŸºäºå°è¯•æ’å…¥çš„ç¬¬ä¸€ä¸ªå†²çªçš„å”¯ä¸€ç´¢å¼•æ¥æ‰§è¡Œæ›´æ–°çš„ï¼Œæ›´æ–°çš„å­—æ®µå®Œå…¨æœ‰å¯èƒ½è§¦å‘å…¶ä»–å”¯ä¸€ç´¢å¼•ï¼ˆåŒ…æ‹¬ä¸»é”®ï¼‰å†²çª</p>
<p>è¿™ä¸ªé—®é¢˜æ ¹æœ¬ä¸æˆç«‹ï¼</p>
</li>
</ol>
<h2 data-id="heading-5">æ€»ç»“</h2>
<ol>
<li>
<p>ä¸ç®¡æ˜¯ MySQLï¼Œè¿˜æ˜¯ Oracleã€SQL Serverã€PostgreSQLï¼Œé’ˆå¯¹ <code>ä¸å­˜åœ¨åˆ™æ’å…¥ï¼Œå­˜åœ¨åˆ™æ›´æ–°</code> åˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨çš„é€»è¾‘éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ MySQL ä¸éœ€è¦æ˜¾ç¤ºæŒ‡å®š <code>åˆ¤å­˜</code> çš„å”¯ä¸€ç´¢å¼•ï¼ˆåŒ…æ‹¬ä¸»é”®ï¼‰ï¼Œç”± MySQL å¼•æ“å†…éƒ¨è‡ªåŠ¨å®ç°</p>
</li>
<li>
<p>å…³äºåˆ¤æ–­æ•°æ®è¡Œæ˜¯å¦å­˜åœ¨ï¼Œå¤šä¸ªå”¯ä¸€ç´¢å¼•çš„ä¼˜å…ˆçº§ï¼Œçœ‹ä¼¼èƒ½æµ‹å‡º MySQL ä¸­çš„ä¼˜å…ˆçº§ï¼Œä½†å¹¶ä¸å…·å¤‡ç¡®å®šæ€§ï¼Œä¸èƒ½ä½œä¸ºä½¿ç”¨å‡†åˆ™</p>
<p>ç±»ä¼¼ä¸ç¡®å®šçš„æ’åºé—®é¢˜è¿˜æœ‰ï¼š<a href="https://juejin.cn/post/7290017749715632168" target="_blank" title="https://juejin.cn/post/7290017749715632168">æˆ‘è¯•å›¾æ‰¯æ‰è¿™æ¡ SQL çš„åº•è£¤</a></p>
</li>
<li>
<p>INSERT ... ON DUPLICATE KEY UPDATE ä½¿ç”¨è¿‡ç¨‹ä¸­æœ‰ä¸€äº›éœ€è¦æ³¨æ„çš„ç‚¹ï¼Œéœ€è¦ç»“åˆè‡ªå·±çš„ä¸šåŠ¡æ¥åˆ†ææ˜¯å¦å¯ä»¥å¿½ç•¥è¿™äº›ç‚¹</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cnblogs.com%2Fyouzhibing%2Fp%2F15248758.html" target="_blank" title="https://www.cnblogs.com/youzhibing/p/15248758.html" ref="nofollow noopener noreferrer">è®°å½•ä¸å­˜åœ¨åˆ™æ’å…¥ï¼Œå­˜åœ¨åˆ™æ›´æ–° â†’ MySQL çš„å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</a></p>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç»™å‰ç«¯æ˜æ˜Ÿå¼€æºé¡¹ç›®Biomeæ PRï¼Œè¢« Snapshot æµ‹è¯•å‘äº†ä¸€æŠŠ]]></title>    <link>https://juejin.cn/post/7586983243925782566</link>    <guid>https://juejin.cn/post/7586983243925782566</guid>    <pubDate>2025-12-24T05:27:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586983243925782566" data-draft-id="7586983243925766182" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç»™å‰ç«¯æ˜æ˜Ÿå¼€æºé¡¹ç›®Biomeæ PRï¼Œè¢« Snapshot æµ‹è¯•å‘äº†ä¸€æŠŠ"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,æµ‹è¯•"/> <meta itemprop="datePublished" content="2025-12-24T05:27:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´"/> <meta itemprop="url" content="https://juejin.cn/user/2175258804632332"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç»™å‰ç«¯æ˜æ˜Ÿå¼€æºé¡¹ç›®Biomeæ PRï¼Œè¢« Snapshot æµ‹è¯•å‘äº†ä¸€æŠŠ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2175258804632332/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T05:27:55.000Z" title="Wed Dec 24 2025 05:27:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Snapshot æµ‹è¯•ï¼šä»ä¸€æ¬¡ CI å¤±è´¥è¯´èµ·</h2>
<p>æœ€è¿‘ç»™ Biome æäº†ä¸ª PRï¼Œæ”¹äº†å‡ ä¸ªæ–‡ä»¶ï¼Œæœ¬åœ°æµ‹è¯•è·‘è¿‡äº†ï¼Œpush ä¸Šå»ï¼ŒCI æŒ‚äº†ã€‚</p>
<p>æŠ¥é”™ä¿¡æ¯æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">---- specs::nursery::no_undeclared_env_vars::invalid_js stdout ----
thread <span class="hljs-string">'specs::nursery::no_undeclared_env_vars::invalid_js'</span> panicked at
crates/biome_js_analyze/tests/spec_tests.rs:<span class="hljs-number">19</span>:<span class="hljs-number">5</span>:

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Snapshot file: crates/biome_js_analyze/tests/specs/nursery/noUndeclaredEnvVars/invalid.js.snap
Snapshot: invalid_js
Source: crates/biome_js_analyze/tests/spec_tests.rs:<span class="hljs-number">19</span>

-old snapshot
+<span class="hljs-keyword">new</span> results
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</code></pre>
<p>ä¸€è„¸æ‡µã€‚æˆ‘æ”¹çš„æ˜¯ <code>--stdin-file-path</code> çš„é€»è¾‘ï¼Œè·Ÿ <code>noUndeclaredEnvVars</code> è¿™ä¸ª lint è§„åˆ™æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</p>
<p>åæ¥ææ˜ç™½äº†ï¼šæˆ‘çš„åˆ†æ”¯è½åäº mainï¼Œrebase ä¹‹åæŠŠä¸Šæ¸¸çš„æ”¹åŠ¨åˆè¿›æ¥äº†ã€‚ä¸Šæ¸¸ç»™è¿™ä¸ªè§„åˆ™åŠ äº†ä¸€è¡Œæç¤ºä¿¡æ¯ï¼Œä½†å¿«ç…§æ–‡ä»¶è¿˜æ˜¯æ—§çš„ï¼Œæ‰€ä»¥æµ‹è¯•å¤±è´¥ã€‚</p>
<p>è¿™å°±æ˜¯ snapshot æµ‹è¯•ã€‚</p>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯ snapshot æµ‹è¯•</h3>
<p>Snapshotï¼Œç›´è¯‘å°±æ˜¯"å¿«ç…§"ã€‚ç”Ÿæ´»ä¸­çš„å¿«ç…§æ˜¯æŸä¸ªæ—¶åˆ»çš„ç…§ç‰‡ï¼Œä»£ç é‡Œçš„ snapshot æ˜¯æŸä¸ªæ—¶åˆ»ç¨‹åºè¾“å‡ºçš„"ç…§ç‰‡"ã€‚</p>
<p>ä¼ ç»Ÿæµ‹è¯•æ˜¯è¿™æ ·å†™çš„ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// ä½ å¾—æ‰‹åŠ¨å†™å‡ºæœŸæœ›çš„è¾“å‡º</span>
<span class="hljs-built_in">assert_eq!</span>(<span class="hljs-title function_ invoke__">format</span>(<span class="hljs-string">"let x=1"</span>), <span class="hljs-string">"let x = 1;\n"</span>);
</code></pre>
<p>Snapshot æµ‹è¯•æ¢äº†ä¸ªæ€è·¯ï¼š<strong>ä½ ä¸ç”¨å†™æœŸæœ›å€¼ï¼Œè®©ç¨‹åºè‡ªå·±è®°å½•ã€‚</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">ç¬¬ä¸€æ¬¡è·‘æµ‹è¯•ï¼š
  è¾“å…¥ â†’ ç¨‹åº â†’ è¾“å‡º â†’ è‡ªåŠ¨ä¿å­˜æˆ .snap æ–‡ä»¶ï¼ˆè¿™å°±æ˜¯<span class="hljs-string">"å¿«ç…§"</span>ï¼‰

åç»­è·‘æµ‹è¯•ï¼š
  è¾“å…¥ â†’ ç¨‹åº â†’ è¾“å‡º â†’ è·Ÿ .snap æ–‡ä»¶æ¯”å¯¹
                         â”‚
                         â”œâ”€â”€ ä¸€æ · â†’ é€šè¿‡
                         â””â”€â”€ ä¸ä¸€æ · â†’ å¤±è´¥ï¼Œæ˜¾ç¤º diff
</code></pre>
<p>ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶ï¼Œæµ‹è¯•æ¡†æ¶ä¼šé—®ä½ ï¼š"è¿™ä¸ªè¾“å‡ºå¯¹å—ï¼Ÿ"ä½ ç¡®è®¤åï¼Œå®ƒå°±æŠŠè¾“å‡ºå­˜æˆ <code>.snap</code> æ–‡ä»¶ã€‚ä¹‹åæ¯æ¬¡è¿è¡Œï¼Œéƒ½æ‹¿æ–°è¾“å‡ºè·Ÿè¿™ä¸ªæ–‡ä»¶æ¯”ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆå«"å¿«ç…§"ï¼Ÿ</strong></p>
<p>å› ä¸ºå®ƒè®°å½•çš„æ˜¯æŸä¸ªæ—¶é—´ç‚¹çš„çŠ¶æ€ã€‚å°±åƒä½ ç»™ä»£ç çš„è¾“å‡ºæ‹äº†å¼ ç…§ç‰‡ï¼Œä»¥åæ¯æ¬¡éƒ½æ‹¿æ–°è¾“å‡ºè·Ÿç…§ç‰‡å¯¹æ¯”ï¼Œçœ‹æœ‰æ²¡æœ‰å˜åŒ–ã€‚</p>
<p><strong>Snapshot æ–‡ä»¶å­˜ä»€ä¹ˆï¼Ÿ</strong></p>
<p>å°±æ˜¯çº¯æ–‡æœ¬ï¼Œè®°å½•ç¨‹åºçš„è¾“å‡ºã€‚æ¯”å¦‚æ ¼å¼åŒ–å·¥å…·çš„ snapshot å­˜çš„æ˜¯æ ¼å¼åŒ–åçš„ä»£ç ï¼ŒCLI å·¥å…·çš„ snapshot å­˜çš„æ˜¯å‘½ä»¤è¡Œè¾“å‡ºï¼ŒReact ç»„ä»¶çš„ snapshot å­˜çš„æ˜¯æ¸²æŸ“å‡ºæ¥çš„ DOM ç»“æ„ã€‚</p>
<p>æˆ‘é‡åˆ°çš„æƒ…å†µå°±æ˜¯ï¼šä¸Šæ¸¸æ”¹äº†è§„åˆ™çš„è¾“å‡ºï¼ˆå¤šäº†ä¸€è¡Œ "This rule belongs to the nursery group"ï¼‰ï¼Œä½† <code>.snap</code> æ–‡ä»¶è¿˜æ˜¯æ—§çš„ï¼Œæ–°è¾“å‡ºè·Ÿæ—§å¿«ç…§ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æµ‹è¯•å¤±è´¥ã€‚</p>
<h3 data-id="heading-2">æ€ä¹ˆä¿®</h3>
<p>Biome ç”¨çš„æ˜¯ Rust ç”Ÿæ€çš„ <code>insta</code> åº“åš snapshot æµ‹è¯•ã€‚ä¿®èµ·æ¥å¾ˆç®€å•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…ˆæœ¬åœ°è·‘ä¸€éæµ‹è¯•ï¼Œç¡®è®¤æ˜¯ snapshot çš„é—®é¢˜</span>
cargo <span class="hljs-built_in">test</span>

<span class="hljs-comment"># æ¥å—æ–°çš„ snapshot</span>
cargo insta accept

<span class="hljs-comment"># æˆ–è€…ç”¨äº¤äº’æ¨¡å¼ï¼Œé€ä¸ªç¡®è®¤</span>
cargo insta review
</code></pre>
<p>è·‘å®Œ <code>cargo insta accept</code>ï¼Œå®ƒä¼šè‡ªåŠ¨æ›´æ–° <code>.snap</code> æ–‡ä»¶ã€‚commit è¿›å»ï¼Œpushï¼ŒCI å°±è¿‡äº†ã€‚</p>
<h3 data-id="heading-3">å¿«ç…§æ–‡ä»¶é•¿ä»€ä¹ˆæ ·</h3>
<p>çœ‹ä¸€çœ¼ Biome é‡Œçš„å¿«ç…§æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">source:</span> <span class="hljs-string">crates/biome_cli/tests/snap_test.rs</span>
<span class="hljs-attr">expression:</span> <span class="hljs-string">content</span>
<span class="hljs-meta">---</span>
<span class="hljs-comment">## `biome.json`</span>

<span class="hljs-string">```json</span>
{ <span class="hljs-attr">"files":</span> { <span class="hljs-attr">"includes":</span> [<span class="hljs-string">"apps/**"</span>] } }
</code></pre>
<h2 data-id="heading-4">Emitted Messages</h2>
<pre><code class="hljs language-block" lang="block">function f() {
	return {};
}
</code></pre>
<pre><code class="hljs language-csharp" lang="csharp">
å°±æ˜¯æŠŠæµ‹è¯•çš„è¾“å…¥ï¼ˆé…ç½®æ–‡ä»¶ï¼‰å’Œè¾“å‡ºï¼ˆæ ¼å¼åŒ–ç»“æœï¼‰éƒ½è®°ä¸‹æ¥ã€‚ä¸‹æ¬¡è·‘æµ‹è¯•ï¼Œè¾“å‡ºå˜äº†å°±èƒ½å‘ç°ã€‚

<span class="hljs-meta">## ä¸ºä»€ä¹ˆ Biome è¦ç”¨ snapshot æµ‹è¯•</span>

å…ˆæƒ³ä¸€ä¸ªé—®é¢˜ï¼šBiome æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ

ä»£ç æ ¼å¼åŒ–å’Œ lintã€‚è¾“å…¥ä¸€æ®µä»£ç ï¼Œè¾“å‡ºæ ¼å¼åŒ–åçš„ä»£ç ï¼Œæˆ–è€…è¾“å‡ºä¸€å † lint è­¦å‘Šã€‚

è¿™ç±»å·¥å…·æœ‰ä¸ªç‰¹ç‚¹ï¼š**è¾“å‡ºåˆé•¿åˆå¤æ‚ï¼Œè€Œä¸”ç»å¸¸å˜ã€‚**

æ¯”å¦‚æ ¼å¼åŒ– `<span class="hljs-function">function <span class="hljs-title">f</span>()</span>{<span class="hljs-keyword">return</span>{}}` è¿™æ®µä»£ç ï¼Œè¾“å‡ºæ˜¯ï¼š

```<span class="hljs-function">javascript
function <span class="hljs-title">f</span>()</span> {
	<span class="hljs-keyword">return</span> {};
}
</code></pre>
<p>å¦‚æœç”¨ä¼ ç»Ÿæµ‹è¯•ï¼Œä½ å¾—è¿™æ ·å†™ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-built_in">assert_eq!</span>(
    <span class="hljs-title function_ invoke__">format_code</span>(<span class="hljs-string">"function f(){return{}}"</span>),
    <span class="hljs-string">"function f() {\n\treturn {};\n}\n"</span>
);
</code></pre>
<p>é—®é¢˜æ¥äº†ï¼š</p>
<ol>
<li><strong>è¾“å‡ºå¤ªé•¿</strong>ï¼šè¿™è¿˜æ˜¯æœ€ç®€å•çš„ä¾‹å­ï¼ŒçœŸå®åœºæ™¯å¯èƒ½æ˜¯å‡ åä¸Šç™¾è¡Œä»£ç </li>
<li><strong>è½¬ä¹‰å­—ç¬¦åœ°ç‹±</strong>ï¼š<code>\n</code>ã€<code>\t</code> ä¸€å¤šï¼Œæ ¹æœ¬æ²¡æ³•è¯»</li>
<li><strong>æ”¹åŠ¨é¢‘ç¹</strong>ï¼šæ ¼å¼åŒ–è§„åˆ™ç»å¸¸è°ƒæ•´ï¼Œæ¯”å¦‚"å‡½æ•°å‰è¦ä¸è¦ç©ºè¡Œ"ï¼Œä¸€æ”¹å°±å¾—æ‰‹åŠ¨æ›´æ–°å‡ ç™¾ä¸ªæµ‹è¯•</li>
</ol>
<p>Biome æœ‰å‡ åƒä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œå¦‚æœæ¯ä¸ªéƒ½æ‰‹å†™æœŸæœ›å€¼ï¼Œç»´æŠ¤æˆæœ¬å¤ªé«˜äº†ã€‚</p>
<p>Snapshot æµ‹è¯•è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// ä¸ç”¨å†™æœŸæœ›å€¼ï¼Œæ¡†æ¶è‡ªåŠ¨å­˜</span>
assert_snapshot!(<span class="hljs-title function_ invoke__">format_code</span>(<span class="hljs-string">"function f(){return{}}"</span>));
</code></pre>
<p>è¾“å‡ºè‡ªåŠ¨å­˜åˆ° <code>.snap</code> æ–‡ä»¶é‡Œï¼Œä¸‹æ¬¡è¿è¡Œè‡ªåŠ¨æ¯”å¯¹ã€‚æ”¹äº†æ ¼å¼åŒ–è§„åˆ™ï¼Ÿè·‘ä¸€é <code>cargo insta accept</code>ï¼Œå‡ åƒä¸ªå¿«ç…§ä¸€èµ·æ›´æ–°ã€‚</p>
<h3 data-id="heading-5">å“ªäº›é¡¹ç›®åœ¨ç”¨</h3>
<p>ä¸åªæ˜¯ Biomeï¼Œå¾ˆå¤šçŸ¥åé¡¹ç›®éƒ½é‡åº¦ä¾èµ– snapshot æµ‹è¯•ï¼š</p>













































<table><thead><tr><th>é¡¹ç›®</th><th>ç±»å‹</th><th>ä¸ºä»€ä¹ˆç”¨ snapshot</th></tr></thead><tbody><tr><td><strong>Prettier</strong></td><td>ä»£ç æ ¼å¼åŒ–</td><td>è¾“å‡ºæ˜¯æ ¼å¼åŒ–åçš„ä»£ç ï¼Œæ‰‹å†™å¤ªç´¯</td></tr><tr><td><strong>Babel</strong></td><td>JS ç¼–è¯‘å™¨</td><td>è¾“å‡ºæ˜¯è½¬æ¢åçš„ä»£ç </td></tr><tr><td><strong>TypeScript</strong></td><td>ç±»å‹æ£€æŸ¥</td><td>é”™è¯¯ä¿¡æ¯ã€ç±»å‹æ¨æ–­ç»“æœ</td></tr><tr><td><strong>Rome/Biome</strong></td><td>æ ¼å¼åŒ–+Lint</td><td>æ ¼å¼åŒ–ç»“æœã€è¯Šæ–­ä¿¡æ¯</td></tr><tr><td><strong>Jest</strong></td><td>æµ‹è¯•æ¡†æ¶</td><td>React ç»„ä»¶æ¸²æŸ“ç»“æœ</td></tr><tr><td><strong>Rust Analyzer</strong></td><td>IDE æ”¯æŒ</td><td>ä»£ç è¡¥å…¨ã€æ‚¬åœæç¤º</td></tr><tr><td><strong>SWC</strong></td><td>JS/TS ç¼–è¯‘å™¨</td><td>ASTã€è½¬æ¢ç»“æœ</td></tr></tbody></table>
<p>è¿™äº›é¡¹ç›®æœ‰ä¸ªå…±åŒç‚¹ï¼š<strong>è¾“å‡ºæ˜¯ç»“æ„åŒ–çš„æ–‡æœ¬ï¼Œè€Œä¸”é‡å¤§</strong>ã€‚</p>
<p>ç”¨ snapshot æµ‹è¯•çš„å¥½å¤„ï¼š</p>
<ol>
<li><strong>é˜²æ­¢å›å½’</strong>ï¼šæ”¹äº†ä¸€è¡Œä»£ç ï¼Œæ‰€æœ‰ç›¸å…³è¾“å‡ºçš„å˜åŒ–éƒ½èƒ½çœ‹åˆ°</li>
<li><strong>ä»£ç å®¡æŸ¥å‹å¥½</strong>ï¼šPR é‡Œèƒ½ç›´æ¥çœ‹åˆ°è¾“å‡ºå˜åŒ–çš„ diff</li>
<li><strong>æ–‡æ¡£ä½œç”¨</strong>ï¼šå¿«ç…§æ–‡ä»¶æœ¬èº«å°±æ˜¯"è¿™ä¸ªè¾“å…¥åº”è¯¥äº§ç”Ÿä»€ä¹ˆè¾“å‡º"çš„æ–‡æ¡£</li>
<li><strong>ç»´æŠ¤æˆæœ¬ä½</strong>ï¼šè¾“å‡ºå˜äº†ï¼Œä¸€æ¡å‘½ä»¤æ›´æ–°ï¼Œä¸ç”¨æ‰‹åŠ¨æ”¹å‡ ç™¾ä¸ªæµ‹è¯•</li>
</ol>
<h3 data-id="heading-6">ä¸€ä¸ªçœŸå®çš„ä¾‹å­</h3>
<p>æˆ‘è¿™æ¬¡æ”¹çš„ PR åŠ äº†ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œæµ‹è¯• stdin è¾“å…¥èƒ½ä¸èƒ½æ­£å¸¸æ ¼å¼åŒ–ã€‚</p>
<p>æµ‹è¯•ä»£ç å¾ˆç®€å•ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-meta">#[test]</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">format_stdin_formats_virtual_path_outside_includes</span>() {
    <span class="hljs-comment">// å‡†å¤‡è¾“å…¥</span>
    console.in_buffer.<span class="hljs-title function_ invoke__">push</span>(<span class="hljs-string">"function f() {return{}}"</span>.<span class="hljs-title function_ invoke__">to_string</span>());

    <span class="hljs-comment">// è¿è¡Œæ ¼å¼åŒ–</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span> = <span class="hljs-title function_ invoke__">run_cli</span>(
        Args::<span class="hljs-title function_ invoke__">from</span>([<span class="hljs-string">"format"</span>, <span class="hljs-string">"--stdin-file-path"</span>, <span class="hljs-string">"mock.js"</span>]),
    );

    <span class="hljs-comment">// å¿«ç…§æµ‹è¯•</span>
    assert_cli_snapshot!(...);
}
</code></pre>
<p>ç”Ÿæˆçš„å¿«ç…§æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">source:</span> <span class="hljs-string">crates/biome_cli/tests/snap_test.rs</span>
<span class="hljs-attr">expression:</span> <span class="hljs-string">content</span>
<span class="hljs-meta">---</span>
<span class="hljs-comment">## `biome.json`</span>

{ <span class="hljs-attr">"files":</span> { <span class="hljs-attr">"includes":</span> [<span class="hljs-string">"apps/**"</span>] } }

<span class="hljs-comment"># Emitted Messages</span>

<span class="hljs-string">function</span> <span class="hljs-string">f()</span> {
	<span class="hljs-string">return</span> {}<span class="hljs-string">;</span>
}
</code></pre>
<p>ä»¥åå¦‚æœæœ‰äººæ”¹äº†æ ¼å¼åŒ–é€»è¾‘ï¼Œå¯¼è‡´è¾“å‡ºå˜äº†ï¼Œæµ‹è¯•å°±ä¼šå¤±è´¥ï¼Œæé†’ä½ æ£€æŸ¥è¿™ä¸ªå˜åŒ–æ˜¯ä¸æ˜¯é¢„æœŸçš„ã€‚</p>
<h3 data-id="heading-7">ä»€ä¹ˆæ—¶å€™ç”¨</h3>
<p>é€‚åˆçš„åœºæ™¯ï¼š</p>

























<table><thead><tr><th>åœºæ™¯</th><th>ä¾‹å­</th></tr></thead><tbody><tr><td>CLI å·¥å…·</td><td>å¸®åŠ©ä¿¡æ¯ã€é”™è¯¯æ¶ˆæ¯ã€æ ¼å¼åŒ–è¾“å‡º</td></tr><tr><td>ç¼–è¯‘å™¨/æ ¼å¼åŒ–å™¨</td><td>ä»£ç è½¬æ¢ç»“æœã€AST è¾“å‡º</td></tr><tr><td>UI ç»„ä»¶</td><td>React/Vue ç»„ä»¶çš„æ¸²æŸ“ç»“æœ</td></tr><tr><td>åºåˆ—åŒ–</td><td>JSONã€YAML çš„è¾“å‡º</td></tr></tbody></table>
<p>ä¸å¤ªé€‚åˆçš„åœºæ™¯ï¼š</p>
<ul>
<li>ç®€å•æ–­è¨€ï¼ˆ<code>1 + 1 == 2</code>ï¼‰</li>
<li>éšæœº/æ—¶é—´ç›¸å…³çš„è¾“å‡º</li>
<li>ä¸šåŠ¡é€»è¾‘éªŒè¯ï¼ˆsnapshot åªèƒ½å‘Šè¯‰ä½ "å˜äº†"ï¼Œä¸èƒ½å‘Šè¯‰ä½ "å¯¹ä¸å¯¹"ï¼‰</li>
</ul>
<h3 data-id="heading-8">å®¹æ˜“è¸©çš„å‘</h3>
<p><strong>1. æ— è„‘ accept</strong></p>
<p>æµ‹è¯•æŒ‚äº†ï¼Œçœ‹éƒ½ä¸çœ‹ç›´æ¥ <code>cargo insta accept</code>ã€‚è¿™æ · snapshot æµ‹è¯•å°±å¤±å»æ„ä¹‰äº†â€”â€”ä¸‡ä¸€æ˜¯çœŸçš„ bug å‘¢ï¼Ÿ</p>
<p>æˆ‘è¿™æ¬¡çš„æƒ…å†µæ¯”è¾ƒæ˜ç¡®ï¼Œæ˜¯ rebase å¸¦è¿›æ¥çš„æ”¹åŠ¨ï¼Œæ‰€ä»¥ç›´æ¥ accept æ²¡é—®é¢˜ã€‚ä½†å¹³æ—¶è¿˜æ˜¯è¦çœ‹ä¸€çœ¼ diffã€‚</p>
<p><strong>2. å¿˜äº†æäº¤å¿«ç…§æ–‡ä»¶</strong></p>
<p>æœ¬åœ°è·‘æµ‹è¯•æ²¡é—®é¢˜ï¼ŒCI æŒ‚äº†ã€‚å› ä¸º <code>.snap</code> æ–‡ä»¶æ²¡ commitã€‚</p>
<p><strong>3. å¿«ç…§å¤ªå¤§</strong></p>
<p>æœ‰äº›é¡¹ç›®å–œæ¬¢æŠŠæ•´ä¸ªé¡µé¢çš„æ¸²æŸ“ç»“æœå­˜æˆå¿«ç…§ï¼Œå‡ åƒè¡Œã€‚æ¯æ¬¡ review éƒ½æ˜¯æŠ˜ç£¨ï¼Œæœ€åå¤§å®¶éƒ½æ— è„‘ accept äº†ã€‚</p>
<p>å»ºè®®æ‹†å°ä¸€ç‚¹ï¼Œæ¯ä¸ªå¿«ç…§ä¿æŒåœ¨å‡ åè¡Œå†…ã€‚</p>
<h3 data-id="heading-9">JavaScript ç”Ÿæ€</h3>
<p>JS è¿™è¾¹å¸¸ç”¨çš„æ˜¯ Jest çš„ snapshot åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">test</span>(<span class="hljs-string">'Button æ¸²æŸ“æ­£ç¡®'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> tree = renderer.<span class="hljs-title function_">create</span>(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"ç‚¹å‡»"</span> /&gt;</span></span>).<span class="hljs-title function_">toJSON</span>();
  <span class="hljs-title function_">expect</span>(tree).<span class="hljs-title function_">toMatchSnapshot</span>();
});
</code></pre>
<p>æ›´æ–°å¿«ç…§ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">jest --updateSnapshot
<span class="hljs-comment"># æˆ–è€…</span>
jest -u
</code></pre>
<p>åŸç†ä¸€æ ·ï¼Œå°±æ˜¯ API ä¸åŒã€‚</p>
<h3 data-id="heading-10">å°ç»“</h3>
<p>Snapshot æµ‹è¯•æœ¬è´¨ä¸Šæ˜¯æŠŠ"å†™æœŸæœ›å€¼"è¿™ä»¶äº‹è‡ªåŠ¨åŒ–äº†ã€‚å¯¹äºè¾“å‡ºå¤æ‚çš„åœºæ™¯ï¼ˆCLIã€æ ¼å¼åŒ–å™¨ã€UI ç»„ä»¶ï¼‰ï¼Œèƒ½çœä¸å°‘äº‹ã€‚</p>
<p>ä½†è®°ä½ï¼šæ›´æ–°å¿«ç…§å‰è¦çœ‹ä¸€çœ¼ diffï¼Œç¡®è®¤å˜åŒ–æ˜¯ä½ æƒ³è¦çš„ã€‚ä¸ç„¶å°±è·Ÿæˆ‘ä¸€æ ·ï¼Œrebase å®Œæ— è„‘ pushï¼ŒCI ä¸€æ ·ä¼šæŒ‚ã€‚</p>
<hr/>
<p>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i" target="_blank" title="https://github.com/tt-a1i" ref="nofollow noopener noreferrer">GitHub</a>ï¼Œä¸‹é¢æ˜¯æˆ‘çš„ä¸€äº›å¼€æºé¡¹ç›®ï¼š</p>
<p><strong>Claude Code Skills</strong>ï¼ˆæŒ‰éœ€åŠ è½½ï¼Œæ„å›¾è‡ªåŠ¨è¯†åˆ«ï¼Œä¸æµªè´¹ tokenï¼Œ<a href="https://juejin.cn/post/7578714735307735066" target="_blank" title="https://juejin.cn/post/7578714735307735066">ä»‹ç»æ–‡ç« </a>ï¼‰ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fcode-review-skill" target="_blank" title="https://github.com/tt-a1i/code-review-skill" ref="nofollow noopener noreferrer">code-review-skill</a> - ä»£ç å®¡æŸ¥æŠ€èƒ½ï¼Œè¦†ç›– React 19ã€Vue 3ã€TypeScriptã€Rust ç­‰çº¦ 9000 è¡Œè§„åˆ™ï¼ˆ<a href="https://juejin.cn/post/7578709098255908902" target="_blank" title="https://juejin.cn/post/7578709098255908902">è¯¦ç»†ä»‹ç»</a>ï¼‰</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2F5-whys-skill" target="_blank" title="https://github.com/tt-a1i/5-whys-skill" ref="nofollow noopener noreferrer">5-whys-skill</a> - 5 Whys æ ¹å› åˆ†æï¼Œè¯´"æ‰¾æ ¹å› "è‡ªåŠ¨æ¿€æ´»</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Ffirst-principles-skill" target="_blank" title="https://github.com/tt-a1i/first-principles-skill" ref="nofollow noopener noreferrer">first-principles-skill</a> - ç¬¬ä¸€æ€§åŸç†æ€è€ƒï¼Œé€‚åˆæ¶æ„è®¾è®¡å’ŒæŠ€æœ¯é€‰å‹</li>
</ul>
<p><strong>å…¨æ ˆé¡¹ç›®</strong>ï¼ˆé€‚åˆå­¦ä¹ ç°ä»£æŠ€æœ¯æ ˆï¼‰ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fprompt-vault" target="_blank" title="https://github.com/tt-a1i/prompt-vault" ref="nofollow noopener noreferrer">prompt-vault</a> - Prompt ç®¡ç†å™¨ï¼Œç”¨çš„éƒ½æ˜¯æœ€æ–°çš„æŠ€æœ¯æ ˆï¼Œé€‚åˆç”¨æ¥å­¦ä¹ äº†è§£æœ€æ–°çš„å‰ç«¯å…¨æ ˆå¼€å‘èŒƒå¼ï¼šNext.js 15 + React 19 + tRPC 11 + Supabase å…¨æ ˆç¤ºä¾‹ï¼Œclone ä¸‹æ¥é…ä¸ªå…è´¹ Supabase å°±èƒ½è·‘</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fchat_edit" target="_blank" title="https://github.com/tt-a1i/chat_edit" ref="nofollow noopener noreferrer">chat_edit</a> - åŒæ¨¡å¼ AI åº”ç”¨ï¼ˆèŠå¤©+å¯Œæ–‡æœ¬ç¼–è¾‘ï¼‰ï¼ŒVue 3.5 + TypeScript + Vite 5 + Quill 2.0 + IndexedDB</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ¨¡å‹LLMå…¥é—¨ç¯‡ï¼šå°ç™½å…¥é—¨ä¸€æ–‡å¿«é€Ÿäº†è§£å¤§æ¨¡å‹ï¼ˆé™„æ•™ç¨‹ï¼‰]]></title>    <link>https://juejin.cn/post/7586957587077103666</link>    <guid>https://juejin.cn/post/7586957587077103666</guid>    <pubDate>2025-12-24T06:03:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7586957587077103666" data-draft-id="7586957587077038130" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ¨¡å‹LLMå…¥é—¨ç¯‡ï¼šå°ç™½å…¥é—¨ä¸€æ–‡å¿«é€Ÿäº†è§£å¤§æ¨¡å‹ï¼ˆé™„æ•™ç¨‹ï¼‰"/> <meta itemprop="keywords" content="LLM,Agent,LangChain"/> <meta itemprop="datePublished" content="2025-12-24T06:03:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹æ•™ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/1145012233707299"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ¨¡å‹LLMå…¥é—¨ç¯‡ï¼šå°ç™½å…¥é—¨ä¸€æ–‡å¿«é€Ÿäº†è§£å¤§æ¨¡å‹ï¼ˆé™„æ•™ç¨‹ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1145012233707299/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹æ•™ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T06:03:21.000Z" title="Wed Dec 24 2025 06:03:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote>
<p>å¤§æ¨¡å‹å¸­å·å…¨çƒï¼Œå½·ä½›å¾—æ¨¡å‹è€…å¾—å¤©ä¸‹ã€‚å¯¹äºITè¡Œä¸šæ¥è¯´ï¼Œä»¥åå¯èƒ½æ²¡æœ‰å„ç§è½¯ä»¶äº†ï¼Œåªæœ‰å„ç§å„æ ·çš„æ™ºä½“ï¼ˆAgentï¼‰è°ƒç”¨å„ç§å„æ ·çš„APIã€‚åœ¨è¿™ç§å¤§åŠ¿ä¸‹ï¼Œç¬”è€…ä¹Ÿé˜…è¯»äº†å¾ˆå¤šå¤§æ¨¡å‹ç›¸å…³çš„èµ„æ–™ï¼Œå’Œå¾ˆå¤šæ–°æ‰‹ä¸€æ ·ï¼Œå¼€å§‹è„‘å­é‡Œéƒ½æ˜¯ä¸€å›¢ä¹±éº»ï¼Œéšç€ç›¸å…³æ–‡ç« è¶Šè¯»è¶Šå¤šï¼Œå†è¿›è¡Œå†…å®¹æ¢³ç†ï¼Œç»ˆäºç†æ¸…äº†ä¸€æ¡æ¸…æ™°çš„è„‰ç»œã€‚</p>
<p>ç¬”è€…å¸Œæœ›é€šè¿‡ä¸‰ç¯‡æ–‡ç« æ€»ç»“ï¼ˆå…¥é—¨ç¯‡ã€åŸç†ç¯‡å’Œåº”ç”¨ç¯‡ï¼‰å°†æ€è·¯å†™ä¸‹æ¥ï¼Œä»¥ä¾¿è·Ÿæˆ‘ä¸€æ ·çš„æ–°æ‰‹è¯»è€…å¿«é€Ÿäº†è§£å¤§æ¨¡å‹çš„æ–¹æ–¹é¢é¢ã€‚åœ¨è¿™é‡Œï¼Œç¬”è€…å…ˆå¼ºè°ƒä¸€ä¸‹ï¼Œæœ¬ç³»åˆ—æ–‡ç« çš„æ·±åº¦æœ‰é™ï¼Œåªæ˜¯ä¸ªäººå¯¹å¤§æ¨¡å‹çŸ¥è¯†è„‰ç»œçš„æ¢³ç†ï¼ŒåŒæ—¶ä¹Ÿä¼šå€Ÿé‰´ä¸€ä¸‹åŒè¡Œçš„åšå®¢å†…å®¹å……å®æœ¬æ–‡ï¼Œæ–‡æœ«å°†ä¼šæ³¨æ˜å‚è€ƒæ¥æºã€‚</p>
<p>åœ¨å¼€å§‹é˜…è¯»æ–‡ç« ä¹‹å‰ï¼Œæœ‰å‡ ä¸ªé—®é¢˜è¯»è€…å¯ä»¥å…ˆæ€è€ƒä¸€ä¸‹ï¼š</p>
<ul>
<li>ä»€ä¹ˆæ˜¯å¤§æ¨¡å‹ï¼Ÿ</li>
<li>å¤§æ¨¡å‹æœ€ç»ˆè¦è§£å†³çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ul>
<h4 data-id="heading-0"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2FDEVELOPERAA%2Farticle%2Fdetails%2F146979848%3Fops_request_misc%3D%25257B%252522request%25255Fid%252522%25253A%252522b89c918c549e0aaad7cb340126a05c42%252522%25252C%252522scm%252522%25253A%25252220140713.130102334.pc%25255Fblog.%252522%25257D%26request_id%3Db89c918c549e0aaad7cb340126a05c42%26biz_id%3D0%26utm_medium%3Ddistribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-28-146979848-null-null.nonecase%26utm_term%3D%25E5%25A4%25A7%25E6%25A8%25A1%25E5%259E%258B%25E5%25AD%25A6%25E4%25B9%25A0%25E8%25B7%25AF%25E7%25BA%25BF%26spm%3D1018.2226.3001.4450" target="_blank" title="https://blog.csdn.net/DEVELOPERAA/article/details/146979848?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522b89c918c549e0aaad7cb340126a05c42%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=b89c918c549e0aaad7cb340126a05c42&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-28-146979848-null-null.nonecase&amp;utm_term=%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF&amp;spm=1018.2226.3001.4450" ref="nofollow noopener noreferrer"/>å¤§æ¨¡å‹LLMä¸äººå·¥æ™ºèƒ½AI</h4>
<p>æåˆ°å¤§æ¨¡å‹ï¼ˆå…¨åï¼Œå¤§è¯­è¨€æ¨¡å‹ï¼ŒLLMï¼ŒLarge Language Modelï¼‰ï¼Œç»•ä¸å¼€äººå·¥æ™ºèƒ½ï¼ˆAIï¼ŒArtificial Intelligenceï¼‰è¿™ä¸ªæ¦‚å¿µã€‚</p>
<p>ç›®å‰ä¸šç•Œå¯¹äºAIçš„å®šä¹‰æœ‰å¾ˆå¤šï¼Œä½†æœ‰ä¸€ä¸ªä»¤æˆ‘å°è±¡æ·±åˆ»çš„è¯´æ³•ï¼š<strong>è®©æœºå™¨åƒäººä¸€æ ·é˜…è¯»ã€å†™ä½œå’Œäº¤æµ</strong>ã€‚é€šè¿‡æœ€è¿‘å‡ å¹´AGIçš„é«˜é€Ÿå‘å±•ï¼ŒAIä¸ä»…ä»…èƒ½å†™ä½œäº†ï¼Œè¿˜èƒ½è¿›è¡Œå„ç§å„æ ·çš„åˆ›ä½œäº†ã€‚æ‰€ä»¥ï¼Œç¬”è€…è®¤ä¸ºè¿™ä¸ªè¯´æ˜å¯ä»¥è¿›ä¸€æ­¥å®Œå–„ï¼š<strong>äººå·¥æ™ºèƒ½å°±æ˜¯è¦è®©æœºå™¨åƒäººä¸€æ ·é˜…è¯»ã€åˆ›ä½œå’Œäº¤æµ</strong>ã€‚</p>
<ul>
<li>é˜…è¯»ï¼šæœºå™¨èƒ½å¤Ÿåƒäººä¸€æ ·æ¥æ”¶å„ç§å„æ ·çš„è¾“å…¥ï¼Œå¹¶èƒ½å¤Ÿç†è§£è¿™äº›è¾“å…¥ï¼›</li>
<li>åˆ›ä½œï¼šæœºå™¨èƒ½å¤Ÿåƒäººä¸€æ ·è¿›è¡Œåˆ›ä½œè¾“å‡ºï¼Œä¸ä»…ä»…åªæ˜¯å†™ä½œï¼Œè¿˜åŒ…æ‹¬ï¼šç»˜ç”»ã€è§†é¢‘åˆ›ä½œç­‰ç­‰ï¼›</li>
<li>äº¤æµï¼šåœ¨ä¸Šè¿°ç†è§£è¾“å…¥å’Œåˆ›ä½œè¾“å‡ºçš„åŸºç¡€ä¸Šï¼Œå°±è‡ªç„¶è€Œç„¶å¯ä»¥å®ç°æœºå™¨åƒäººä¸€æ ·äº¤æµï¼Œå¹¶ä¸”åœ¨åˆ›ä½œè¾“å‡ºèƒ½åŠ›ä¸Šï¼Œå¯èƒ½æ¯”è‡ªç„¶äººæ›´åŠ ä¼˜åŠ¿ã€‚</li>
</ul>
<p>è¦å®ç°ä¸Šè¿°æè¿°çš„äººå·¥æ™ºèƒ½ï¼Œé¦–å…ˆå°±éœ€è¦è®©æœºå™¨ç†è§£äººç±»çš„è¾“å…¥ï¼Œäººç±»çš„è¾“å…¥æ–¹å¼æ¯”è¾ƒå¤šï¼Œè¯­è¨€å’Œæ–‡å­—é¦–å½“å…¶å†²ã€‚è¦è®©æœºå™¨ç†è§£è¯­è¨€å’Œæ–‡å­—ï¼Œå°±éœ€è¦è¿›è¡Œè¯­è¨€å»ºæ¨¡ï¼Œè¯­è¨€å»ºæ¨¡çš„è¾“å‡ºå°±æ˜¯è¯­è¨€æ¨¡å‹LMï¼ˆLanguage Modelï¼‰ã€‚</p>
<p>æœºå™¨é€šè¿‡åˆ†æå­¦ä¹ å¤§é‡äººç±»è¯­è¨€å’Œæ–‡å­—ï¼Œæœ€ç»ˆè·å¾—ä¸€ä¸ªè¯­è¨€æ¨¡å‹ã€‚é€šè¿‡è¯¥æ¨¡å‹ï¼Œæœºå™¨å¥½åƒ<strong>å¬æ‡‚</strong>äº†ç”¨æˆ·è¾“å…¥ä¸€æ ·ï¼Œå¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œå¯¹åº”çš„è¾“å‡ºã€‚è€Œç”¨æˆ·é€šè¿‡å¾—åˆ°çš„æœºå™¨è¾“å‡ºï¼Œä¹Ÿæ„Ÿè§‰æœºå™¨<strong>ç†è§£</strong>äº†è‡ªå·±çš„æ„æ€ã€‚<strong>ä½†å®é™…è¿™é‡Œçš„å¬æ‡‚å’Œç†è§£éƒ½æ˜¯æœºå™¨çš„è¿ç®—ã€‚</strong></p>
<p>é‚£ä¹ˆï¼Œè¿™ä¹ˆå‰å®³çš„æ¨¡å‹æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿ</p>
<h4 data-id="heading-1"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2FDEVELOPERAA%2Farticle%2Fdetails%2F146979848%3Fops_request_misc%3D%25257B%252522request%25255Fid%252522%25253A%252522b89c918c549e0aaad7cb340126a05c42%252522%25252C%252522scm%252522%25253A%25252220140713.130102334.pc%25255Fblog.%252522%25257D%26request_id%3Db89c918c549e0aaad7cb340126a05c42%26biz_id%3D0%26utm_medium%3Ddistribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-28-146979848-null-null.nonecase%26utm_term%3D%25E5%25A4%25A7%25E6%25A8%25A1%25E5%259E%258B%25E5%25AD%25A6%25E4%25B9%25A0%25E8%25B7%25AF%25E7%25BA%25BF%26spm%3D1018.2226.3001.4450" target="_blank" title="https://blog.csdn.net/DEVELOPERAA/article/details/146979848?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522b89c918c549e0aaad7cb340126a05c42%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=b89c918c549e0aaad7cb340126a05c42&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-28-146979848-null-null.nonecase&amp;utm_term=%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF&amp;spm=1018.2226.3001.4450" ref="nofollow noopener noreferrer"/>å¤§æ¨¡å‹LLMçš„å‘å±•ä¸å®šä¹‰</h4>
<p>å’Œå¾ˆå¤šæœ‰æ•…äº‹çš„äººçš„åå­—ä¸€æ ·ï¼Œå¤§æ¨¡å‹ä¸€å¼€å§‹å¹¶ä¸å«å¤§æ¨¡å‹ã€‚</p>
<p>å¤§æ¨¡å‹çš„å‘å±•ç»å†äº†4ä¸ªé˜¶æ®µï¼š</p>
<ul>
<li>ç»Ÿè®¡è¯­è¨€æ¨¡å‹ SLMï¼ŒStatistical Language Modelï¼Œç»Ÿè®¡è¯­è¨€æ¨¡å‹ï¼ŒåŸºäºç»Ÿè®¡å­¦ä¹ æ–¹æ³•å¼€å‘ï¼Œå…¶åŸºæœ¬æ€æƒ³æ˜¯åŸºäºé©¬å°”å¯å¤«å‡è®¾å»ºç«‹è¯é¢„æµ‹æ¨¡å‹ã€‚è¿™ç§æ¨¡å‹å¸¸è§äºæˆ‘ä»¬çš„å…¨æ–‡æ£€ç´¢å’Œæ¨èç³»ç»Ÿä¸­ï¼Œé€šè¿‡ç»Ÿè®¡è¯é¢‘ç­‰ä¿¡æ¯æ¥åšç»Ÿè®¡é¢„æµ‹ï¼Œè¿™ç§æ¨¡å‹é€šå¸¸å—åˆ°ç»´æ•°ç¾éš¾çš„å›°æ‰°ã€‚</li>
<li>ç¥ç»è¯­è¨€æ¨¡å‹ NLMï¼ŒNeutral Language Modelï¼Œé€šè¿‡ç¥ç»ç½‘ç»œï¼Œå¦‚å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰ï¼Œæ¥æè¿°å•è¯åºåˆ—çš„æ¦‚ç‡ã€‚è¯¥æ¨¡å‹å¼•å…¥äº†è¯çš„åˆ†å¸ƒå¼è¡¨ç¤ºè¿™ä¸€æ¦‚å¿µï¼Œå¹¶åœ¨èšåˆä¸Šä¸‹æ–‡ç‰¹å¾ï¼ˆå³åˆ†å¸ƒå¼è¯å‘é‡ï¼‰çš„æ¡ä»¶ä¸‹æ„å»ºè¯é¢„æµ‹å‡½æ•°ã€‚word2vecæå‡ºäº†æ„å»ºç®€åŒ–çš„æµ…å±‚ç¥ç»ç½‘ç»œæ¥å­¦ä¹ åˆ†å¸ƒå¼å•è¯è¡¨ç¤ºçš„æ–¹æ³•ï¼Œè¿™äº›è¡¨ç¤ºåœ¨å„ç§NLPä»»åŠ¡ä¸­è¢«è¯æ˜éå¸¸æœ‰æ•ˆã€‚</li>
<li>é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ PLMï¼ŒPre-training Language Modelï¼ŒåŸºäºè‡ªæ³¨æ„åŠ›æœºåˆ¶çš„é«˜åº¦å¹¶è¡ŒåŒ–Transformeræ¶æ„ï¼Œåœ¨å¤§è§„æ¨¡æ— æ ‡ç­¾è¯­æ–™åº“ä¸Šä½¿ç”¨ä¸“é—¨è®¾è®¡çš„é¢„è®­ç»ƒä»»åŠ¡ã€‚è¯¥æ¨¡å‹ç¡®ç«‹äº†â€œé¢„è®­ç»ƒå’Œå¾®è°ƒâ€å­¦ä¹ èŒƒå¼ã€‚åœ¨è¿™ä¸ªèŒƒå¼ä¸‹ï¼Œé€šå¸¸éœ€è¦å¯¹PLMè¿›è¡Œå¾®è°ƒä»¥é€‚é…ä¸åŒçš„ä¸‹æ¸¸ä»»åŠ¡ã€‚</li>
<li>å¤§è¯­è¨€æ¨¡å‹ LLMï¼ŒLarge Language Modelã€‚ç ”ç©¶äººå‘˜å‘ç°ï¼Œæ‰©å±•PLMï¼ˆæ‰©å±•æ¨¡å‹å¤§å°æˆ–æ•°æ®å¤§å°ï¼‰é€šå¸¸ä¼šæé«˜ä¸‹æ¸¸ä»»åŠ¡çš„æ¨¡å‹æ€§èƒ½ï¼Œè®¸å¤šç ”ç©¶é€šè¿‡è®­ç»ƒè¶Šæ¥è¶Šå¤§çš„PLMæ¥æ¢ç´¢æ€§èƒ½æé™ã€‚éšåå‘ç°ï¼Œå½“æ¨¡å‹å‚æ•°è¾¾åˆ°æŸä¸€æé™ä¹‹åï¼Œæ¨¡å‹åœ¨è§£å†³ä¸€ç³»åˆ—å¤æ‚ä»»åŠ¡ä¸­å±•ç¤ºäº†æƒŠäººçš„èƒ½åŠ›ï¼Œè¿™ç§èƒ½åŠ›è¢«ç§°ä¸ºã€<strong>æ¶Œç°èƒ½åŠ›</strong>ã€‘ã€‚ å…³äºæ¶Œç°èƒ½åŠ›ï¼Œä¸šç•Œç›®å‰è¿˜æœ‰å¾ˆå¤šé—®é¢˜å¾…ç ”ç©¶è§£å†³ã€‚æ¯”å¦‚ï¼šæ¨¡å‹å‚æ•°å…·ä½“è¾¾åˆ°å¤šå°‘æ¶Œç°èƒ½åŠ›ä¼šå‡ºç°ï¼Ÿå¤§æ¨¡å‹ä¸ºä»€ä¹ˆä¼šçªç„¶å‡ºç°æ¶Œç°èƒ½åŠ›ç­‰ã€‚</li>
</ul>
<p>é€šè¿‡å¤§æ¨¡å‹çš„å‘å±•é˜¶æ®µæè¿°ï¼Œæœ¬èŠ‚æœ€åæ€»ç»“ä¸€ä¸‹å¤§æ¨¡å‹LLMçš„å®šä¹‰ã€‚Â <strong>å¤§æ¨¡å‹æ˜¯ä¸€ç§é‡‡ç”¨Transformeræ¶æ„ï¼Œæ¨¡å‹å‚æ•°è¾¾åˆ°ç™¾äº¿æˆ–åƒäº¿çº§çš„é¢„è®­ç»ƒæ¨¡å‹ã€‚</strong></p>
<h4 data-id="heading-2"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2FDEVELOPERAA%2Farticle%2Fdetails%2F146979848%3Fops_request_misc%3D%25257B%252522request%25255Fid%252522%25253A%252522b89c918c549e0aaad7cb340126a05c42%252522%25252C%252522scm%252522%25253A%25252220140713.130102334.pc%25255Fblog.%252522%25257D%26request_id%3Db89c918c549e0aaad7cb340126a05c42%26biz_id%3D0%26utm_medium%3Ddistribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-28-146979848-null-null.nonecase%26utm_term%3D%25E5%25A4%25A7%25E6%25A8%25A1%25E5%259E%258B%25E5%25AD%25A6%25E4%25B9%25A0%25E8%25B7%25AF%25E7%25BA%25BF%26spm%3D1018.2226.3001.4450" target="_blank" title="https://blog.csdn.net/DEVELOPERAA/article/details/146979848?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522b89c918c549e0aaad7cb340126a05c42%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=b89c918c549e0aaad7cb340126a05c42&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-28-146979848-null-null.nonecase&amp;utm_term=%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF&amp;spm=1018.2226.3001.4450" ref="nofollow noopener noreferrer"/>å¤§æ¨¡å‹LLMçš„åˆ†ç±»</h4>
<p>ç›®å‰ä¸šç•Œæ¶Œç°äº†éå¸¸å¤šçš„å¤§æ¨¡å‹ï¼Œä¹Ÿçœ‹äº†ç½‘ä¸Šä¸€äº›å…³äºå¯¹å¤§æ¨¡å‹åˆ†ç±»å½’çº³çš„æ–‡ç« ï¼Œéƒ½éå¸¸ä¸é”™ï¼Œæœ¬èŠ‚ä¸»è¦æ˜¯å¯¹ç½‘ä¸Šçš„åˆ†ç±»ä¿¡æ¯è¿›è¡Œæ€»ç»“ã€‚</p>
<p>æœ¬èŠ‚å°†ä»ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢æ¥å¯¹å¤§æ¨¡å‹è¿›è¡Œåˆ†ç±»ï¼š</p>
<h5 data-id="heading-3"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2FDEVELOPERAA%2Farticle%2Fdetails%2F146979848%3Fops_request_misc%3D%25257B%252522request%25255Fid%252522%25253A%252522b89c918c549e0aaad7cb340126a05c42%252522%25252C%252522scm%252522%25253A%25252220140713.130102334.pc%25255Fblog.%252522%25257D%26request_id%3Db89c918c549e0aaad7cb340126a05c42%26biz_id%3D0%26utm_medium%3Ddistribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-28-146979848-null-null.nonecase%26utm_term%3D%25E5%25A4%25A7%25E6%25A8%25A1%25E5%259E%258B%25E5%25AD%25A6%25E4%25B9%25A0%25E8%25B7%25AF%25E7%25BA%25BF%26spm%3D1018.2226.3001.4450" target="_blank" title="https://blog.csdn.net/DEVELOPERAA/article/details/146979848?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522b89c918c549e0aaad7cb340126a05c42%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=b89c918c549e0aaad7cb340126a05c42&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-28-146979848-null-null.nonecase&amp;utm_term=%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF&amp;spm=1018.2226.3001.4450" ref="nofollow noopener noreferrer"/>æ ¹æ®ç®—æ³•åŸç†åˆ†ç±»</h5>
<p>å¤§æ¨¡å‹çš„æ¶æ„åŸºæœ¬éƒ½æ˜¯Transformerï¼Œè€ŒTransformerè¯¦ç»†çš„ç»“æ„åœ¨googleå‘å¸ƒçš„è®ºæ–‡ã€ŠAttention Is All You Needã€‹ä¸­è¿›è¡Œäº†æè¿°ï¼ŒTransformerç»“æ„ä¸­æœ‰ä¸¤ä¸ªéå¸¸é‡è¦çš„éƒ¨ä»¶ï¼šEncoderå’ŒDecoderï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af58ee3a7a574c46b61eecce34429b8c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767161000&amp;x-signature=onWZHqmLkTo6OqMMs5oE5e8xBS8%3D" alt="transformeræ¶æ„.webp" loading="lazy"/></p>
<p>æ ¹æ®å¯¹Transformerç»“æ„çš„è£å‰ªï¼Œå¯ä»¥å°†ç›®å‰çš„å¤§æ¨¡å‹åˆ†ä¸ºä¸‰ç±»ï¼š</p>
<ul>
<li>Encoder-Onlyï¼šè£å‰ªäº†Decoderéƒ¨ä»¶ï¼Œä»£è¡¨æ¨¡å‹BERTï¼Œåˆ°äº†2020å¹´ä¹‹åï¼Œè¿™ç±»æŠ€æœ¯åŸºæœ¬å·²ç»ä¸å†å‘å±•ã€‚</li>
<li>Encoder-Decoderï¼šæ²¡æœ‰è£å‰ªä»»ä½•éƒ¨ä»¶ï¼Œä»£è¡¨æ¨¡å‹T5ã€‚</li>
<li>Decoder-Onlyï¼šè£å‰ªäº†Encoderéƒ¨ä»¶ï¼Œä»£è¡¨æ¨¡å‹GPTï¼Œç›®å‰ä¸»å¯¼LLMé¢†åŸŸçš„å‘å±•ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€å¼ ç»“åˆäº†å¤§æ¨¡å‹å‡ºç°æ—¶é—´ä»¥åŠæ‰€å±æ¶æ„åˆ†ç±»çš„å›¾ç‰‡ï¼Œåˆ†åˆ«è¯¦ç»†é˜è¿°äº†å„ä¸ªåˆ†ç±»æœ‰å“ªäº›ä»£è¡¨æ¨¡å‹ï¼Œä»¥åŠæ¨¡å‹å‡ºç°çš„æ—¶é—´ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/baa636f5d459496cae65718a99af5797~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L5pWZ56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767161000&amp;x-signature=yfsxTDv6Iw7Np4cWN1g5DpyyjDo%3D" alt="llm-evolutionary-tree.png" loading="lazy"/></p>
<h5 data-id="heading-4"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2FDEVELOPERAA%2Farticle%2Fdetails%2F146979848%3Fops_request_misc%3D%25257B%252522request%25255Fid%252522%25253A%252522b89c918c549e0aaad7cb340126a05c42%252522%25252C%252522scm%252522%25253A%25252220140713.130102334.pc%25255Fblog.%252522%25257D%26request_id%3Db89c918c549e0aaad7cb340126a05c42%26biz_id%3D0%26utm_medium%3Ddistribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-28-146979848-null-null.nonecase%26utm_term%3D%25E5%25A4%25A7%25E6%25A8%25A1%25E5%259E%258B%25E5%25AD%25A6%25E4%25B9%25A0%25E8%25B7%25AF%25E7%25BA%25BF%26spm%3D1018.2226.3001.4450" target="_blank" title="https://blog.csdn.net/DEVELOPERAA/article/details/146979848?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522b89c918c549e0aaad7cb340126a05c42%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=b89c918c549e0aaad7cb340126a05c42&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-28-146979848-null-null.nonecase&amp;utm_term=%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF&amp;spm=1018.2226.3001.4450" ref="nofollow noopener noreferrer"/>æ ¹æ®è¾“å…¥å†…å®¹åˆ†ç±»</h5>
<p>æ ¹æ®è¾“å…¥å†…å®¹ä¸åŒï¼Œå¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š</p>
<ul>
<li>è¯­è¨€å¤§æ¨¡å‹</li>
</ul>
<p>æŒ‡åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNatural Language Processingï¼ŒNLPï¼‰é¢†åŸŸä¸­çš„ä¸€ç±»å¤§æ¨¡å‹ï¼Œé€šå¸¸ç”¨äºå¤„ç†æ–‡æœ¬æ•°æ®å’Œç†è§£è‡ªç„¶è¯­è¨€ã€‚ è¿™ç±»å¤§æ¨¡å‹çš„ä¸»è¦ç‰¹ç‚¹æ˜¯å®ƒä»¬åœ¨å¤§è§„æ¨¡è¯­æ–™åº“ä¸Šè¿›è¡Œäº†è®­ç»ƒï¼Œä»¥å­¦ä¹ è‡ªç„¶è¯­è¨€çš„å„ç§è¯­æ³•ã€è¯­ä¹‰å’Œè¯­å¢ƒè§„åˆ™ã€‚ ä¾‹å¦‚ï¼šGPT ç³»åˆ—ï¼ˆOpenAIï¼‰ã€Bardï¼ˆGoogleï¼‰ã€æ–‡å¿ƒä¸€è¨€ï¼ˆç™¾åº¦ï¼‰ã€‚</p>
<ul>
<li>è§†è§‰å¤§æ¨¡å‹</li>
</ul>
<p>æŒ‡åœ¨è®¡ç®—æœºè§†è§‰ï¼ˆComputer Visionï¼ŒCVï¼‰é¢†åŸŸä¸­ä½¿ç”¨çš„å¤§æ¨¡å‹ï¼Œé€šå¸¸ç”¨äºå›¾åƒå¤„ç†å’Œåˆ†æã€‚ è¿™ç±»æ¨¡å‹é€šè¿‡åœ¨å¤§è§„æ¨¡å›¾åƒæ•°æ®ä¸Šè¿›è¡Œè®­ç»ƒï¼Œå¯ä»¥å®ç°å„ç§è§†è§‰ä»»åŠ¡ï¼Œå¦‚å›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹ã€å›¾åƒåˆ†å‰²ã€å§¿æ€ä¼°è®¡ã€äººè„¸è¯†åˆ«ç­‰ã€‚ ä¾‹å¦‚ï¼šVIT ç³»åˆ—ï¼ˆGoogleï¼‰ã€æ–‡å¿ƒUFOã€åä¸ºç›˜å¤ CVã€INTERNï¼ˆå•†æ±¤ï¼‰ã€‚</p>
<ul>
<li>å¤šæ¨¡æ€å¤§æ¨¡å‹</li>
</ul>
<p>æŒ‡èƒ½å¤Ÿå¤„ç†å¤šç§ä¸åŒç±»å‹æ•°æ®çš„å¤§æ¨¡å‹ï¼Œä¾‹å¦‚æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ç­‰å¤šæ¨¡æ€æ•°æ®ã€‚ è¿™ç±»æ¨¡å‹ç»“åˆäº† NLP å’Œ CV çš„èƒ½åŠ›ï¼Œä»¥å®ç°å¯¹å¤šæ¨¡æ€ä¿¡æ¯çš„ç»¼åˆç†è§£å’Œåˆ†æï¼Œä»è€Œèƒ½å¤Ÿæ›´å…¨é¢åœ°ç†è§£å’Œå¤„ç†å¤æ‚çš„æ•°æ®ã€‚ ä¾‹å¦‚ï¼šDingoDB å¤šæ¨¡å‘é‡æ•°æ®åº“ï¼ˆä¹ç« äº‘æ DataCanvasï¼‰ã€DALL-E(OpenAI)ã€æ‚Ÿç©ºç”»ç”»ï¼ˆåä¸ºï¼‰ã€midjourneyã€‚</p>
<h5 data-id="heading-5"><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2FDEVELOPERAA%2Farticle%2Fdetails%2F146979848%3Fops_request_misc%3D%25257B%252522request%25255Fid%252522%25253A%252522b89c918c549e0aaad7cb340126a05c42%252522%25252C%252522scm%252522%25253A%25252220140713.130102334.pc%25255Fblog.%252522%25257D%26request_id%3Db89c918c549e0aaad7cb340126a05c42%26biz_id%3D0%26utm_medium%3Ddistribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-28-146979848-null-null.nonecase%26utm_term%3D%25E5%25A4%25A7%25E6%25A8%25A1%25E5%259E%258B%25E5%25AD%25A6%25E4%25B9%25A0%25E8%25B7%25AF%25E7%25BA%25BF%26spm%3D1018.2226.3001.4450" target="_blank" title="https://blog.csdn.net/DEVELOPERAA/article/details/146979848?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522b89c918c549e0aaad7cb340126a05c42%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=b89c918c549e0aaad7cb340126a05c42&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-28-146979848-null-null.nonecase&amp;utm_term=%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF&amp;spm=1018.2226.3001.4450" ref="nofollow noopener noreferrer"/>æ ¹æ®åº”ç”¨é¢†åŸŸåˆ†ç±»</h5>
<p>æŒ‰ç…§åº”ç”¨é¢†åŸŸï¼Œå¤§æ¨¡å‹ä¸»è¦å¯ä»¥åˆ†ä¸º L0ã€L1ã€L2 ä¸‰ä¸ªå±‚çº§ï¼š</p>
<ul>
<li>é€šç”¨å¤§æ¨¡å‹ L0ï¼š æ˜¯æŒ‡å¯ä»¥åœ¨å¤šä¸ªé¢†åŸŸå’Œä»»åŠ¡ä¸Šé€šç”¨çš„å¤§æ¨¡å‹ã€‚ å®ƒä»¬åˆ©ç”¨å¤§ç®—åŠ›ã€ä½¿ç”¨æµ·é‡çš„å¼€æ”¾æ•°æ®ä¸å…·æœ‰å·¨é‡å‚æ•°çš„æ·±åº¦å­¦ä¹ ç®—æ³•ï¼Œåœ¨å¤§è§„æ¨¡æ— æ ‡æ³¨æ•°æ®ä¸Šè¿›è¡Œè®­ç»ƒï¼Œä»¥å¯»æ‰¾ç‰¹å¾å¹¶å‘ç°è§„å¾‹ï¼Œè¿›è€Œå½¢æˆå¯â€œä¸¾ä¸€åä¸‰â€çš„å¼ºå¤§æ³›åŒ–èƒ½åŠ›ï¼Œå¯åœ¨ä¸è¿›è¡Œå¾®è°ƒæˆ–å°‘é‡å¾®è°ƒçš„æƒ…å†µä¸‹å®Œæˆå¤šåœºæ™¯ä»»åŠ¡ï¼Œç›¸å½“äº AI å®Œæˆäº†â€œé€šè¯†æ•™è‚²â€ã€‚</li>
<li>è¡Œä¸šå¤§æ¨¡å‹ L1ï¼š æ˜¯æŒ‡é‚£äº›é’ˆå¯¹ç‰¹å®šè¡Œä¸šæˆ–é¢†åŸŸçš„å¤§æ¨¡å‹ã€‚ å®ƒä»¬é€šå¸¸ä½¿ç”¨è¡Œä¸šç›¸å…³çš„æ•°æ®è¿›è¡Œé¢„è®­ç»ƒæˆ–å¾®è°ƒï¼Œä»¥æé«˜åœ¨è¯¥é¢†åŸŸçš„æ€§èƒ½å’Œå‡†ç¡®åº¦ï¼Œç›¸å½“äº AI æˆä¸ºâ€œè¡Œä¸šä¸“å®¶â€ã€‚</li>
<li>å‚ç›´å¤§æ¨¡å‹ L2ï¼š æ˜¯æŒ‡é‚£äº›é’ˆå¯¹ç‰¹å®šä»»åŠ¡æˆ–åœºæ™¯çš„å¤§æ¨¡å‹ã€‚ å®ƒä»¬é€šå¸¸ä½¿ç”¨ä»»åŠ¡ç›¸å…³çš„æ•°æ®è¿›è¡Œé¢„è®­ç»ƒæˆ–å¾®è°ƒï¼Œä»¥æé«˜åœ¨è¯¥ä»»åŠ¡ä¸Šçš„æ€§èƒ½å’Œæ•ˆæœã€‚</li>
</ul>
<h2 data-id="heading-6">å­¦ä¹ èµ„æºæ¨è</h2>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TRAE 2025 å¹´åº¦æŠ¥å‘ŠğŸ¥³ï¼šéšè—äººæ ¼å¤§æ­ç§˜ï¼æ™’æŠ¥å‘Šèµ¢å®šåˆ¶å¹´ç»ˆå¥–]]></title>    <link>https://juejin.cn/post/7587349016222367785</link>    <guid>https://juejin.cn/post/7587349016222367785</guid>    <pubDate>2025-12-25T03:31:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587349016222367785" data-draft-id="7587062584164810790" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="TRAE 2025 å¹´åº¦æŠ¥å‘ŠğŸ¥³ï¼šéšè—äººæ ¼å¤§æ­ç§˜ï¼æ™’æŠ¥å‘Šèµ¢å®šåˆ¶å¹´ç»ˆå¥–"/> <meta itemprop="keywords" content="Trae,AIç¼–ç¨‹,VibeCoding"/> <meta itemprop="datePublished" content="2025-12-25T03:31:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜é‡‘é…±"/> <meta itemprop="url" content="https://juejin.cn/user/1556564194374926"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            TRAE 2025 å¹´åº¦æŠ¥å‘ŠğŸ¥³ï¼šéšè—äººæ ¼å¤§æ­ç§˜ï¼æ™’æŠ¥å‘Šèµ¢å®šåˆ¶å¹´ç»ˆå¥–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1556564194374926/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜é‡‘é…±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T03:31:02.000Z" title="Thu Dec 25 2025 03:31:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"ã€Œ"}.markdown-body b:after,.markdown-body strong:after{content:"ã€"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="github-gist">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#333}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#d73a49}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-symbol{color:#0086b3}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#6f42c1}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.hljs-number{color:#005cc5}.hljs-string{color:#032f62}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0cc3df41b00e4a0e8fef7414eb0d2af8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR6YWx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238262&amp;x-signature=qdeddRoXvXh%2FD0Ec2pxjZ8v%2FE6E%3D" alt="20251225-111403.png" loading="lazy"/></p>
<p><strong>å¹´æœ«æ”¶å®˜ï¼ŒTRAE å¹´åº¦æŠ¥å‘Šæ­£å¼ä¸Šçº¿å•¦</strong></p>
<p>è¿™ä¸€å¹´é‡Œï¼Œæ¯ä¸€æ¬¡å’Œ AI åä½œ Codingã€æ¯ä¸€æ®µè¢«ä¼˜åŒ–çš„ä»£ç ã€æ¯ä¸€ä¸ªæ”»å…‹çš„éœ€æ±‚ï¼Œéƒ½åœ¨ TRAE ç•™ä¸‹äº†ä½ çš„ä¸“å±å°è®°ã€‚é€šè¿‡è¿™ä»½æŠ¥å‘Šï¼Œè¿˜èƒ½è§£é”ä½ çš„éšè—ç¼–ç äººæ ¼ï½</p>
<p>COME ON ï¼æ™’å‡ºæŠ¥å‘Šåˆ†äº«çœŸå®æ„Ÿå—ï¼Œæ¥å†²ä¸€æ³¢ TRAE å‘¨è¾¹å¹´ç»ˆå¤§ç¤¼ï¼</p>
<p>ç”¨ä¸€æ¡æ²¸ç‚¹ï¼Œæ¥ç»™è¿™ä¸€å¹´çš„ Coding æ—¶å…‰å®Œç¾æ”¶å°¾å§ï½</p>
<h3 data-id="heading-0">æ´»åŠ¨æ—¶é—´</h3>
<p>12æœˆ25æ—¥12:00-12æœˆ30æ—¥23:59</p>
<h3 data-id="heading-1">æ´»åŠ¨æ–¹å¼</h3>
<ul>
<li><strong>ç”ŸæˆæŠ¥å‘Š</strong>ï¼šç‚¹å‡»é“¾æ¥<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.trae.cn%2Fevents%2Fannual-2025" target="_blank" title="https://www.trae.cn/events/annual-2025" ref="nofollow noopener noreferrer">www.trae.cn/events/annuâ€¦</a> æˆ–æ‰«æäºŒç»´ç ï¼Œç”Ÿæˆå¹¶ä¿å­˜ä½ çš„ 2025 å¹´åº¦æŠ¥å‘Šã€‚</li>
</ul>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da9dc97b2362442684f7a26ddecc7dd8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR6YWx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238262&amp;x-signature=80piVKiEsvvVoExfvD9fSpkkgOk%3D" alt="img_v3_02ta_eecdce34-bda4-4470-a0fe-86a5fbae943g.png" loading="lazy"/></p>
<ul>
<li>
<p><strong>å‘å¸ƒæ²¸ç‚¹</strong>ï¼šåœ¨æ˜é‡‘ç¤¾åŒºå†…å‘å¸ƒæ²¸ç‚¹ï¼Œ<strong>åˆ†äº«2025æœ€å…·æˆå°±æ„Ÿçš„ã€Œæ•°æ®é¢æ¿ã€æˆ–ã€Œè§’è‰²å½¢è±¡ã€</strong>ï¼Œæ–‡æ¡ˆå†…å®¹åŒ…æ‹¬ä½†ä¸é™äºï¼šä½“éªŒæ„Ÿæƒ³ã€ç©æ³•æ”»ç•¥ã€åé¦ˆå»ºè®®â€¦â€¦</p>
</li>
<li>
<p><strong>æ·»åŠ è¯é¢˜</strong>ï¼šå¸¦ä¸Š <strong>#<a href="https://juejin.cn/pin/topic/7587524867952476206" target="_blank" title="https://juejin.cn/pin/topic/7587524867952476206">TRAELAND</a></strong> è¯é¢˜æ ‡ç­¾ã€‚</p>
</li>
</ul>
<h3 data-id="heading-2">æ´»åŠ¨æ¿€åŠ±</h3>
<p>æ´»åŠ¨æœŸé—´ï¼Œç»¼åˆç»Ÿè®¡æ‰€æœ‰ç¬¦åˆè¦æ±‚çš„å‚èµ›æ²¸ç‚¹ï¼ŒæŒ‰ã€Œç‚¹èµæ•° + è¯„è®ºæ•°ã€æ€»å’Œæ’åï¼Œå‰ 100 åæ˜å‹å¯è·å¾—ä¸“å± TRAE å®šåˆ¶å‘¨è¾¹å¹´ç»ˆå¤§ç¤¼ï½</p>
<p>ğŸ’¡ 100 ä¸ªè·å¥–åé¢å…¨è¦†ç›–ï¼Œåªè¦è·»èº«å‰ 100ï¼Œå³å¯å°†å®šåˆ¶ç¦åˆ©æ”¶å…¥å›Šä¸­ï¼</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/325702089b7640c99f88fc5d580a2fc4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR6YWx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238262&amp;x-signature=sFxKgaNzADS92g2wZDcfOJnVAhs%3D" alt="img_v3_02ta_9413d7eb-e69d-4fd2-b7db-0d74589504dg.jpg" loading="lazy"/></p>
<h3 data-id="heading-3">æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>
<p><strong>è¯é¢˜æ­£ç¡®</strong>ï¼šå‚èµ›æ²¸ç‚¹å¿…é¡»æ·»åŠ  #<a href="https://juejin.cn/pin/topic/7587524867952476206" target="_blank" title="https://juejin.cn/pin/topic/7587524867952476206">TRAELAND</a> è¯é¢˜æ ‡ç­¾ï¼Œé”™åŠ ã€æ¼åŠ å‡è§†ä¸ºæ— æ•ˆå‚ä¸ï¼›</p>
</li>
<li>
<p><strong>å†…å®¹çœŸå®</strong>ï¼šåˆ†äº«çš„å¹´åº¦æŠ¥å‘Šæˆªå›¾ã€æ•°æ®ä¿¡æ¯éœ€çœŸå®æœ‰æ•ˆï¼Œä¸¥ç¦ä¼ªé€ ã€ç›—ç”¨ä»–äººå†…å®¹ï¼Œä¸€ç»å‘ç°å–æ¶ˆèµ„æ ¼ï¼›</p>
</li>
<li>
<p><strong>å½¢å¼åˆè§„</strong>ï¼šå‘å¸ƒå†…å®¹éœ€æ¸…æ™°å±•ç¤ºã€Œè§’è‰²å½¢è±¡ã€æˆ–ã€Œæ•°æ®é¢æ¿ã€ä¹‹ä¸€ï¼Œæ— é®æŒ¡ã€æ— æ¨¡ç³Šï¼Œç¡®ä¿å®¡æ ¸äººå‘˜å¯æ¸…æ™°è¾¨è¯†ï¼›</p>
</li>
<li>
<p><strong>å…¬å¼€å¯è§</strong>ï¼šå‚èµ›æ²¸ç‚¹éœ€è®¾ç½®ä¸ºã€Œå…¬å¼€ã€çŠ¶æ€ï¼Œç§å¯†æˆ–ä»…å¥½å‹å¯è§çš„å†…å®¹æ— æ³•å‚ä¸å®¡æ ¸ä¸æ’åï¼›</p>
</li>
<li>
<p><strong>åˆè§„åˆ›ä½œ</strong>ï¼šå†…å®¹éœ€ç§¯æå‘ä¸Šï¼Œä¸å¾—åŒ…å«è¿è§„ã€ä½ä¿—ã€æ”»å‡»æ€§è¨€è®ºï¼Œå¦åˆ™å–æ¶ˆå‚ä¸èµ„æ ¼ã€‚</p>
</li>
<li>
<p>æœ¬æ¬¡æ´»åŠ¨é¢å‘TRAEä¸­å›½ç‰ˆç”¨æˆ·ã€‚</p>
</li>
</ul>
<h3 data-id="heading-4">æ´»åŠ¨Q&amp;A</h3>
<p><strong>Q1: æœ‰æ•ˆæ²¸ç‚¹åˆ¤å®šæ ‡å‡†æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>A1: éœ€åŒæ—¶æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p>
<p>â‘  å†…å®¹ç§¯æå‘ä¸Šï¼Œå›´ç»• TRAELAND å¹´åº¦æŠ¥å‘Šå±•å¼€çœŸå®åˆ†äº«ï¼Œå¯å«ä½“éªŒæ„Ÿæƒ³ã€ç©æ³•æ”»ç•¥ã€åé¦ˆå»ºè®®ç­‰ï¼›</p>
<p>â‘¡ æ­£ç¡®æ·»åŠ  <strong>#<a href="https://juejin.cn/pin/topic/7587524867952476206" target="_blank" title="https://juejin.cn/pin/topic/7587524867952476206">TRAELAND</a></strong> è¯é¢˜æ ‡ç­¾ï¼›</p>
<p>â‘¢ æ²¸ç‚¹è®¾ç½®ä¸ºå…¬å¼€å¯è§çŠ¶æ€ï¼›</p>
<p>â‘£ æ¸…æ™°å±•ç¤ºä½ çš„ TRAE LAND è§’è‰²å½¢è±¡æˆ–æ•°æ®é¢æ¿æˆªå›¾ï¼›å†…å®¹çœŸå®ï¼Œæ— ä¼ªé€ ã€ç›—ç”¨è¡Œä¸ºã€‚</p>
<p><strong>Q2: æ’åå¦‚ä½•è®¡ç®—ä¸æˆªæ­¢æ—¶é—´ï¼Ÿ</strong></p>
<p>A2: å‚èµ›æ²¸ç‚¹æ’åæŒ‰ã€Œç‚¹èµæ•° + è¯„è®ºæ•°ã€æ€»å’Œæ ¸ç®—ï¼ŒåŒä¸€ç”¨æˆ·å‘å¸ƒå¤šæ¡å‚èµ›å†…å®¹ï¼Œä»…å–æ•°æ®æœ€ä¼˜ä¸€æ¡å‚ä¸æ’åï¼›æ— æ„ä¹‰æ°´è¯„è®ºä¸è®¡å…¥æœ‰æ•ˆè¯„è®ºæ•°ã€‚ï¼›</p>
<p>æ•°æ®ç»Ÿè®¡æˆªæ­¢æ—¶é—´ä¸º 2025 å¹´ 12 æœˆ 30 æ—¥ 23:59ï¼Œé€¾æœŸæ–°å¢çš„ç‚¹èµã€è¯„è®ºä¸å†è®¡å…¥ã€‚è·å¥–åå•å°†äºæ´»åŠ¨ç»“æŸå 7 ä¸ªå·¥ä½œæ—¥å†…ï¼Œåœ¨æ˜é‡‘æ²¸ç‚¹åœˆå­å…¬å¸ƒï¼Œæ•¬è¯·å…³æ³¨ã€‚</p>
<p><strong>Q3: åŒä¸€ç”¨æˆ·å¯ä»¥å‘å¸ƒå¤šæ¡æ²¸ç‚¹å‚èµ›å—ï¼Ÿ</strong></p>
<p>A3: å¯ä»¥ï¼Œä½†åŒä¸€ç”¨æˆ·ä»…èƒ½ä»¥æ•°æ®æœ€ä¼˜çš„ä¸€æ¡æ²¸ç‚¹å‚ä¸æ’åï¼Œä¸å¯é‡å¤è·å¥–ã€‚å»ºè®®å¤§å®¶ç²¾å¿ƒæ‰“ç£¨ä¸€æ¡å†…å®¹ï¼Œæå‡è·å¥–æ¦‚ç‡å“¦ï½</p>
<p><strong>Q4: æ˜¯å¦å¿…é¡»å‘å¸ƒæˆªå›¾ï¼Ÿ</strong></p>
<p>A4: æ˜¯çš„ï¼Œè¯·åˆ†äº« TRAE LAND å¹´åº¦æŠ¥å‘Šä¸­çš„â€œè§’è‰²å½¢è±¡â€æˆ–â€œæ•°æ®é¢æ¿â€æˆªå›¾ä¹‹ä¸€ï¼Œå¹¶ç¡®ä¿å†…å®¹æ¸…æ™°å¯è§ã€‚</p>
<p><strong>Q5: è¿è§„æˆ–æŠ„è¢­å¦‚ä½•å¤„ç†ï¼Ÿ</strong></p>
<p>A5: ä¸€ç»æ ¸å®å­˜åœ¨åˆ·é‡ã€æŠ„è¢­ã€ç›—ç”¨ç­‰è¿è§„è¡Œä¸ºï¼Œå°†å–æ¶ˆå‚ä¸èµ„æ ¼ã€‚</p>
<p><strong>Q6: å¥–å“å¦‚ä½•å‘æ”¾ï¼Ÿ</strong></p>
<p>A6: è·å¥–åå•å…¬å¸ƒåï¼Œå®˜æ–¹å°†é€šè¿‡æ˜é‡‘ç¤¾åŒºã€Œç§ä¿¡ã€åŠŸèƒ½è”ç³»è·å¥–ç”¨æˆ·ï¼Œæ ¸å®èº«ä»½ä¿¡æ¯ä¸æ”¶è´§åœ°å€ã€‚è¯·è·å¥–ç”¨æˆ·åœ¨æ”¶åˆ°ç§ä¿¡å 3 ä¸ªå·¥ä½œæ—¥å†…å›å¤ç¡®è®¤ï¼Œé€¾æœŸæœªå›å¤è§†ä¸ºè‡ªåŠ¨æ”¾å¼ƒç¦åˆ©ã€‚å®ç‰©å¥–å“å°†åœ¨ä¿¡æ¯ç¡®è®¤å 10 ä¸ªå·¥ä½œæ—¥å†…å®‰æ’å¯„é€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kotlin Flow çš„ emit å’Œ tryEmit æœ‰ä»€ä¹ˆåŒºåˆ« ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7587342120021999667</link>    <guid>https://juejin.cn/post/7587342120021999667</guid>    <pubDate>2025-12-25T03:45:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587342120021999667" data-draft-id="7580815599351595023" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kotlin Flow çš„ emit å’Œ tryEmit æœ‰ä»€ä¹ˆåŒºåˆ« ï¼Ÿ"/> <meta itemprop="keywords" content="Kotlin,Android,Android Jetpack"/> <meta itemprop="datePublished" content="2025-12-25T03:45:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="QING618"/> <meta itemprop="url" content="https://juejin.cn/user/339115460529117"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kotlin Flow çš„ emit å’Œ tryEmit æœ‰ä»€ä¹ˆåŒºåˆ« ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/339115460529117/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    QING618
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T03:45:45.000Z" title="Thu Dec 25 2025 03:45:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Kotlin Flow ä¸­ï¼Œ<code>emit()</code>Â å’ŒÂ <code>tryEmit()</code>Â éƒ½ç”¨äºå‘ Flow å‘é€å€¼ï¼Œä½†å®ƒä»¬çš„å…³é”®åŒºåˆ«åœ¨äº<strong>èƒŒå‹å¤„ç†</strong>å’Œ<strong>åç¨‹ä¸Šä¸‹æ–‡</strong>ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ä¸»è¦åŒºåˆ«</h2>
<h4 data-id="heading-1">1.Â emit()</h4>
<ul>
<li><strong>æŒ‚èµ·å‡½æ•°</strong>ï¼šä¼šæŒ‚èµ·ç›´åˆ°æœ‰ç©ºé—´æ¥æ”¶å€¼ï¼ˆå¤„ç†èƒŒå‹ï¼‰</li>
<li><strong>åç¨‹å®‰å…¨</strong>ï¼šåªèƒ½åœ¨åç¨‹ä½œç”¨åŸŸä¸­è°ƒç”¨</li>
<li><strong>æ¨èä½¿ç”¨</strong>ï¼šåœ¨Â <code>collect</code>Â æˆ–Â <code>callbackFlow</code>Â ä¸­ä¼˜å…ˆä½¿ç”¨</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin">flow {
    <span class="hljs-comment">// ä¼šæŒ‚èµ·ç›´åˆ°æ¥æ”¶æ–¹å‡†å¤‡å¥½</span>
    emit(<span class="hljs-number">1</span>)
    emit(<span class="hljs-number">2</span>)
}
</code></pre>
<h4 data-id="heading-2">2.Â tryEmit()</h4>
<ul>
<li><strong>éæŒ‚èµ·å‡½æ•°</strong>ï¼šå°è¯•ç«‹å³å‘å°„å€¼ï¼Œå¦‚æœæ¥æ”¶æ–¹æœªå‡†å¤‡å¥½åˆ™è¿”å›Â <code>false</code></li>
<li><strong>å¯èƒ½ä¸¢æ•°æ®</strong>ï¼šè¿”å›Â <code>false</code>Â æ—¶å€¼ä¼šè¢«ä¸¢å¼ƒ</li>
<li><strong>æœ‰é™åœºæ™¯</strong>ï¼šä¸»è¦åœ¨ MutableStateFlow å’Œ MutableSharedFlow ä¸­ä½¿ç”¨</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> _state = MutableStateFlow(<span class="hljs-number">0</span>)

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateValue</span><span class="hljs-params">(newValue: <span class="hljs-type">Int</span>)</span></span> {
    <span class="hljs-comment">// å°è¯•å‘å°„ï¼Œå¦‚æœå¤±è´¥åˆ™ä¸¢å¼ƒ</span>
    <span class="hljs-keyword">val</span> success = _state.tryEmit(newValue)
    <span class="hljs-keyword">if</span> (!success) {
        <span class="hljs-comment">// å¤„ç†å‘å°„å¤±è´¥çš„æƒ…å†µ</span>
    }
}
</code></pre>
<h2 data-id="heading-3">äºŒã€ä½¿ç”¨åœºæ™¯å¯¹æ¯”</h2>
<h4 data-id="heading-4">1. ä½¿ç”¨ emit() çš„åœºæ™¯</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. åœ¨ flow {} æ„å»ºå™¨ä¸­</span>
flow {
    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1.</span><span class="hljs-number">.10</span>) {
        delay(<span class="hljs-number">100</span>)
        emit(i)  <span class="hljs-comment">// âœ… æ­£ç¡®</span>
    }
}

<span class="hljs-comment">// 2. åœ¨ callbackFlow ä¸­</span>
callbackFlow {
    callback.setOnData { <span class="hljs-keyword">data</span> -&gt;
        trySend(<span class="hljs-keyword">data</span>)  <span class="hljs-comment">// callbackFlow ç‰¹æ®Šæ–¹æ³•</span>
    }
    awaitClose { callback.removeListener() }
}
</code></pre>
<h4 data-id="heading-5">2. ä½¿ç”¨ tryEmit() çš„åœºæ™¯</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä¸»è¦åœ¨ MutableStateFlow/MutableSharedFlow ä¸­</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewModel</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _uiState = MutableStateFlow&lt;UiState&gt;(Loading)
    <span class="hljs-keyword">val</span> uiState: StateFlow&lt;UiState&gt; = _uiState
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">update</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// éæŒ‚èµ·å‡½æ•°ä¸­å°è¯•æ›´æ–°çŠ¶æ€</span>
        <span class="hljs-keyword">if</span> (!_uiState.tryEmit(Success(<span class="hljs-keyword">data</span>))) {
            <span class="hljs-comment">// å¤„ç†èƒŒå‹ï¼ˆé€šå¸¸æ—¥å¿—è®°å½•ï¼‰</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-6">3. ä¸‹é¢æ˜¯ä¸€ä¸ªå°è¡¨æ ¼ï¼Œå¯ä»¥å¸®åŠ©å¿«é€Ÿäº†è§£ä½•æ—¶ä½¿ç”¨Â <code>emit</code>Â å’ŒÂ <code>tryEmit</code>ï¼š</h4>



































<table><thead><tr><th>åœºæ™¯</th><th>ä½¿ç”¨ emit</th><th>ä½¿ç”¨ tryEmit</th></tr></thead><tbody><tr><td>åœ¨æŒ‚èµ·å‡½æ•°å†…éƒ¨</td><td>æ˜¯</td><td>é¿å…ä½¿ç”¨ï¼ˆé™¤ééå¸¸ç´§æ€¥ï¼‰</td></tr><tr><td>UI ç‚¹å‡»æˆ–ç”Ÿå‘½å‘¨æœŸäº‹ä»¶</td><td>æ˜¯</td><td>å¯èƒ½ï¼ˆå¦‚æœéœ€è¦å¿«é€Ÿæ›´æ–°ï¼‰</td></tr><tr><td>å›è°ƒã€ç›‘å¬å™¨æˆ–åå°çº¿ç¨‹</td><td>é¿å…ä½¿ç”¨ï¼ˆä¸èƒ½æŒ‚èµ·ï¼‰</td><td>æ˜¯</td></tr><tr><td>éœ€è¦ä¿è¯æ•°æ®é€è¾¾</td><td>æ˜¯</td><td>å¦ï¼ˆéœ€è‡ªè¡Œå¤„ç†å¤±è´¥æƒ…å†µï¼‰</td></tr><tr><td>å‘é€å³å¿˜ï¼ˆfire-and-forgetï¼‰åœºæ™¯</td><td>å¦</td><td>æ˜¯</td></tr></tbody></table>
<p>ä¸¤å¥è¯æ¦‚æ‹¬å°±æ˜¯ï¼š</p>
<ul>
<li>å½“ä½ éœ€è¦å¯é çš„ã€å¯¹åç¨‹å‹å¥½çš„å‘é€æ–¹å¼æ—¶ï¼Œä½¿ç”¨Â <code>emit</code>ã€‚</li>
<li>å½“ä½ å¸Œæœ›å®ç°æ— é˜»å¡ã€å¿«é€Ÿè§¦å‘ä¸”ä¸æš‚åœçš„æ“ä½œæ—¶ï¼Œä½¿ç”¨Â <code>tryEmit</code>ã€‚</li>
</ul>
<h2 data-id="heading-7">ä¸‰ã€é‡è¦æ³¨æ„äº‹é¡¹</h2>
<ol>
<li>
<p><strong>callbackFlow çš„ç‰¹æ®Šæƒ…å†µ</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin">callbackFlow {
    callback { <span class="hljs-keyword">data</span> -&gt;
        <span class="hljs-comment">// è¿™é‡Œå¿…é¡»ç”¨ trySendï¼Œå› ä¸º callback ä¸æ˜¯æŒ‚èµ·ä¸Šä¸‹æ–‡</span>
        trySend(<span class="hljs-keyword">data</span>)
    }
}
</code></pre>
</li>
<li>
<p><strong>MutableSharedFlow çš„é…ç½®å½±å“</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> flow = MutableSharedFlow&lt;<span class="hljs-built_in">Int</span>&gt;(
    replay = <span class="hljs-number">0</span>,
    extraBufferCapacity = <span class="hljs-number">10</span>  <span class="hljs-comment">// ç¼“å†²åŒºå¤§å°å½±å“ tryEmit æˆåŠŸç‡</span>
)
</code></pre>
</li>
<li>
<p><strong>æ€§èƒ½è€ƒè™‘</strong></p>
<ul>
<li><code>emit()</code>ï¼šæ›´å®‰å…¨ï¼Œä¿è¯æ•°æ®ä¸ä¸¢å¤±</li>
<li><code>tryEmit()</code>ï¼šæ€§èƒ½æ›´å¥½ï¼Œä½†å¯èƒ½ä¸¢å¤±æ•°æ®</li>
</ul>
</li>
</ol>
<p>æ€»ç»“ä¸€ä¸‹äºŒè€…çš„åŒºåˆ«ï¼š</p>



































<table><thead><tr><th>ç‰¹æ€§</th><th>emit()</th><th>tryEmit()</th></tr></thead><tbody><tr><td>æŒ‚èµ·å‡½æ•°</td><td>æ˜¯</td><td>å¦</td></tr><tr><td>ç­‰å¾…æ”¶é›†è€…</td><td>æ˜¯ï¼ˆå¦‚æœç¼“å†²åŒºå·²æ»¡ï¼‰</td><td>å¦</td></tr><tr><td>è¿”å›ç±»å‹</td><td>Unit</td><td>Boolean</td></tr><tr><td>æ˜¯å¦ç«‹å³å‘å°„ï¼Ÿ</td><td>å¦ï¼ˆå¯èƒ½ä¼šæŒ‚èµ·ï¼‰</td><td>æ˜¯ï¼ˆå¦‚æœç¼“å†²åŒºå…è®¸ï¼‰</td></tr><tr><td>æ˜¯å¦å¯åœ¨åç¨‹ä¸­ä½¿ç”¨ï¼Ÿ</td><td>å¿…é¡»</td><td>ä¸éœ€è¦</td></tr></tbody></table>
<h2 data-id="heading-8">å››ã€æœ€ä½³å®è·µå»ºè®®</h2>
<ul>
<li><strong>ä¼˜å…ˆä½¿ç”¨Â <code>emit()</code></strong> ï¼Œé™¤éæœ‰ç‰¹æ®Šæ€§èƒ½éœ€æ±‚</li>
<li>åœ¨Â <code>flow {}</code>Â æ„å»ºå™¨ä¸­<strong>æ€»æ˜¯ä½¿ç”¨Â <code>emit()</code></strong></li>
<li>åœ¨å›è°ƒæ¥å£ä¸­ï¼ˆå¦‚ callbackFlowï¼‰ä½¿ç”¨Â <code>trySend()</code>/<code>tryEmit()</code></li>
<li>å¯¹äºçŠ¶æ€æ›´æ–°ï¼Œå¦‚æœæ— æ³•ç¡®ä¿åœ¨åç¨‹ä¸Šä¸‹æ–‡ä¸­ï¼Œä½¿ç”¨Â <code>tryEmit()</code>Â ä½†è¦æœ‰å¤±è´¥å¤„ç†</li>
<li>æ˜ç¡®å¤„ç†Â <code>tryEmit()</code>Â è¿”å›çš„Â <code>false</code>Â æƒ…å†µ</li>
</ul>
<p>ç®€å•æ€»ç»“ï¼š<strong><code>emit()</code>Â æ˜¯å®‰å…¨çš„é˜»å¡ç‰ˆæœ¬ï¼Œ<code>tryEmit()</code>Â æ˜¯éé˜»å¡çš„å°è¯•ç‰ˆæœ¬ï¼Œå¯èƒ½å¤±è´¥ä¸¢æ•°æ®ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¥³å‹æ€’éª‚å›½å†…ä¸èƒ½ç”¨Claude Codeï¼Œäºæ˜¯æˆ‘ç»™å¥¹åšäº†ä¸€ä¸ª]]></title>    <link>https://juejin.cn/post/7587336857538265097</link>    <guid>https://juejin.cn/post/7587336857538265097</guid>    <pubDate>2025-12-25T03:28:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587336857538265097" data-draft-id="7587325326046101513" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¥³å‹æ€’éª‚å›½å†…ä¸èƒ½ç”¨Claude Codeï¼Œäºæ˜¯æˆ‘ç»™å¥¹åšäº†ä¸€ä¸ª"/> <meta itemprop="keywords" content="AIç¼–ç¨‹,ç¨‹åºå‘˜,AIGC"/> <meta itemprop="datePublished" content="2025-12-25T03:28:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜é±¼çš®"/> <meta itemprop="url" content="https://juejin.cn/user/2444938365386621"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¥³å‹æ€’éª‚å›½å†…ä¸èƒ½ç”¨Claude Codeï¼Œäºæ˜¯æˆ‘ç»™å¥¹åšäº†ä¸€ä¸ª
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2444938365386621/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜é±¼çš®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T03:28:51.000Z" title="Thu Dec 25 2025 03:28:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ç¨‹åºå‘˜é±¼çš®ã€‚æœ€è¿‘å¥³å‹å¼€å§‹å­¦ä¹  AI ç¼–ç¨‹äº†ï¼ˆè¢«æˆ‘å¸¦çš„ï¼‰ï¼Œå¥¹å¬è¯´ Claude Code è¿™ä¸ª AI ç¼–ç¨‹å·¥å…·å¾ˆç‰›æ°ï¼Œç»“æœè¯•äº†ä¸‹å‘ç°å¾—è¦å›½å¤–çš„ Claude è´¦å·æ‰èƒ½ç™»é™†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/403e1821707e4762967e3d515d740be8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=142pPF4tMBCB37dNtQLUvGGqy78%3D" alt="" loading="lazy"/></p>
<p>ç„¶åå¥¹å°±éª‚éª‚å’§å’§åœ°è·Ÿæˆ‘åæ§½ã€‚</p>
<p>å±•ç°ç”·å‹åŠ›çš„æ—¶å€™åˆ°äº†ï¼Œäºæ˜¯æˆ‘å¼€ç©ç¬‘åœ°è¯´ï¼šåˆ«éš¾è¿‡äº†ï¼Œè¦ä¸æˆ‘ç»™ä½ åšä¸€ä¸ª Claude Code ç®—äº†ï¼Ÿ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/adf061f039274e61876a4ce4cdf86dd4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=i80pz0R2lyKiysoFzkkclox%2FUM4%3D" alt="" loading="lazy"/></p>
<p>ç»“æœï¼Œå¥¹å½“çœŸäº†ï¼</p>
<p>æˆ‘ â†“</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9529994248f845b199f00a498f1d5727~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=9KfDHzcrv8SE8KQts25xz53RkV8%3D" alt="" loading="lazy"/></p>
<p>æ²¡åŠæ³•ï¼Œåªèƒ½è¯•ä¸€è¯•äº†ï¼Œæ¯•ç«Ÿè°å¸Œæœ›åœ£è¯èŠ‚è¿™ä¸¤å¤©è®©è‡ªå®¶äººéš¾è¿‡å‘¢ï¼Ÿ</p>
<p>æ­£å¥½è¿™ä¸¤å¤©å›½äº§ AI å¤§æ¨¡å‹ GLM-4.7 å‘å¸ƒäº†ï¼Œæˆ‘çœ‹ç½‘ä¸Šå¾ˆå¤šåšä¸»éƒ½åœ¨å¹ä»€ä¹ˆ â€œå›½å†…æœ€å¼ºçš„ç¼–ç¨‹æ¨¡å‹â€ã€â€œæœ€å¼ºçš„å¼€æºæ¨¡å‹â€ã€â€œClaude çš„æœ€ä½³å¹³æ›¿â€ï¼Œç”šè‡³è¯´æ˜¯è¶…è¿‡äº† GPT-5.2 å’Œ Claude Sonnet 4.5ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8a2302900ee4a4fa02364e504f918ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=5mp3WwdA1IWIcL6Rq%2BTtR4NZnt0%3D" alt="" loading="lazy"/></p>
<p>ä½ è¯´å›½äº§æœ€å¼ºä¹Ÿå°±ç®—äº†ï¼Œè¶…è¿‡ Claude è¿™æˆ‘èƒ½ä¿¡ä¹ˆï¼Ÿ</p>
<p>é‚£æ­£å¥½ï¼Œæˆ‘å°±å°è¯•ç”¨ GLM-4.7 æ¥åšä¸ªè‡ªå·±çš„ AI ç¼–ç¨‹å·¥å…·å§ï¼Œå¯¹æ ‡ Claude Code é‚£ç§çš„ï¼Œçœ‹çœ‹ GLM-4.7 åˆ°åº•å‡ æ–¤å‡ ä¸¤ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f10f802e5a74d7a84c2353ba62fc969~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=wfTHRwJNN3DN0tfRa9C7DY9Ei%2B8%3D" alt="" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥ï¼Œå°±è®©æˆ‘ä»¬ä¸€èµ· <strong>ç”¨ GLM-4.7 + Claude Code</strong> å¼€å‘ä¸€ä¸ª <strong>åŸºäº GLM-4.7 çš„ä»¿ Claude Code</strong> çš„ AI ç¼–ç¨‹å·¥å…·ã€‚</p>
<p>é¡¹ç›®å¼€å§‹å‰ï¼Œå…ˆèµ·ä¸€ä¸ªå“å½“å½“çš„åå­—ï¼Œå°±å« <code>Yupi Code</code> å§ï¼</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†éµå¾ªè¿™å¥—ã€Šé±¼çš® AI Vibe Coding å¼€å‘ä»¿ Claude Code çš„ Yupi Codeã€‹æµç¨‹ï¼Œä¸å†™ä¸€è¡Œä»£ç ï¼Œä¸€æ­¥ä¸€æ­¥æŠŠ â€œClaude Codeâ€ åšå‡ºæ¥ï¼</p>
<ul>
<li>ç¯å¢ƒå‡†å¤‡ =&gt; å®‰è£…å·¥å…·å’Œé…ç½®ç¯å¢ƒï¼Œèƒ½å¤Ÿ Vibe Coding</li>
<li>æŠ€æœ¯è°ƒç ” =&gt; ç¡®è®¤æ»¡è¶³ç”Ÿæˆéœ€æ±‚</li>
<li>è®¾è®¡å¼€å‘ =&gt; åŒ…æ‹¬æ–¹æ¡ˆè®¾è®¡ã€ç”Ÿæˆä»£ç ã€ä¿®å¤ Bugï¼Œå¾—åˆ° MVP æœ€å°å¯è¡Œäº§å“</li>
<li>ç‰ˆæœ¬æ§åˆ¶ =&gt; é˜²æ­¢åç»­æ”¹åŠ¨å‡ºé—®é¢˜</li>
<li>ä¼˜åŒ–èƒ½åŠ› =&gt; æ”¯æŒæ›´å¤šå¯¹æ ‡ Claude Code çš„åŠŸèƒ½ï¼Œæ¯”å¦‚è”ç½‘æœç´¢ã€æµå¼è¾“å‡ºã€æ·±åº¦æ€è€ƒç­‰</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6a826d4ccfb407aad98f9405decbf85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=Ly9atXzS1TPpayL2tqYModXoNM0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">ç¯å¢ƒå‡†å¤‡</h2>
<p>æ™ºè°±çš„ GLM-4.7 å…¼å®¹å¤šæ¬¾ç¼–ç å·¥å…·ï¼Œé™¤ Claude Code å¤–ï¼Œè¿˜æ”¯æŒ Cursorã€Cline ç­‰ä¸»æµç¼–ç å·¥å…·ï¼Œçµæ´»é€‚é…å¤šç§å¼€å‘åœºæ™¯ã€‚</p>
<p>ç»™ Claude Code æ¥å…¥ GLM ä¹Ÿå¾ˆç®€å•ï¼Œ1 åˆ†é’Ÿæå®šã€‚</p>
<p>é¦–å…ˆæ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ä¸€è¡Œå‘½ä»¤å®‰è£… Claude Codeï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npmÂ installÂ -gÂ @anthropic-ai/claude-code
</code></pre>
<p>ç„¶åæ‰§è¡Œ <code>claude</code> å‘½ä»¤æ‰“å¼€ç¨‹åºï¼Œé»˜è®¤æ˜¯éœ€è¦ç™»å½• Claude è´¦å·çš„ï¼Œå¦åˆ™æ— æ³•ä½¿ç”¨ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d06c5da11e93450f84658eac4d31893f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=MCG8of9Fpaj0T6WUH%2FlTzFsATWg%3D" alt="" loading="lazy"/></p>
<p>ä¸è¿‡æ²¡å…³ç³»ï¼Œè®©æˆ‘ä»¬æŠŠå®ƒèƒŒåçš„ AI å¤§æ¨¡å‹æ¢æˆå›½å†…çš„ GLM-4.7ã€‚é¦–å…ˆè¿›å…¥ <code>{ç”¨æˆ·ç›®å½•}/.claude</code> ç›®å½•ï¼Œåˆ›å»ºä¸€ä¸ª <code>settings.json</code> é…ç½®æ–‡ä»¶ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/825961b0404b47c2bc0cd35a903ce335~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=psFY%2B6a46y6z9LIX8EsidwhWUKo%3D" alt="" loading="lazy"/></p>
<p>ç„¶åä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹å¦‚ä¸‹ï¼Œè®°å¾—æ›¿æ¢æˆä½ è‡ªå·±çš„ API Keyï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2627396010d6428a86ad42adf5991b38~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=wFKPnhz4mgQtmkGdxB0nwvSU9cw%3D" alt="" loading="lazy"/></p>
<p>API Key ç›´æ¥åˆ°æ™ºè°±å¼€å‘å¹³å°è·å–å³å¯ï¼š</p>
<p>æŒ‡è·¯ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fbigmodel.cn%2F" target="_blank" title="https://bigmodel.cn/" ref="nofollow noopener noreferrer">bigmodel.cn/</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a92e06b01e07470f96b417848e982268~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=hMM5G18HFhJwn55HmwTBaH1oVgs%3D" alt="" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥å°±å¯ä»¥æ„‰å¿«åœ°ä½¿ç”¨äº†~</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c7db86ed5fd7414f8bfb223bcbefc1d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=QJcDsb4g4y%2BzGHu4lvXHFyYqyFE%3D" alt="" loading="lazy"/></p>
<p>é™¤äº†è¿™ç§æ–¹å¼å¤–ï¼Œå®˜æ–¹æ–‡æ¡£è¿˜æä¾›äº†æ›´ç®€å•çš„æ–¹å¼ï¼Œç›´æ¥ä½¿ç”¨è‡ªåŠ¨åŒ–åŠ©æ‰‹ï¼ŒæŒ‰ç…§æŒ‡å¼•å°±èƒ½å®Œæˆç¯å¢ƒé…ç½®ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02eac37fcb40438e8020d6c53700aade~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=bHtgVZpPdSpjFhqk6GbxDP7gmKA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">æŠ€æœ¯è°ƒç ”</h2>
<p>å¦‚æœè¦å®Œå…¨åˆ©ç”¨ AI å¼€å‘é¡¹ç›®ï¼Œæœ‰å‡ ä¸ªéš¾ç‚¹ï¼š</p>
<ol start="0">
<li>é¡¹ç›®éœ€è¦åŒ…å«å®Œæ•´å‰åç«¯ï¼Œéœ€è¦å¤§æ¨¡å‹æœ‰è¾ƒå¼ºçš„ <strong>ç¼–ç èƒ½åŠ›</strong></li>
<li>éœ€è¦è®©åç«¯é¡¹ç›®å¯¹æ¥ AI å¤§æ¨¡å‹ï¼Œæ¯ä¸ªå¤§æ¨¡å‹çš„æ¥å…¥å’Œå¼€å‘æ–¹å¼ä¸åŒï¼Œéœ€è¦è®© AI <strong>è¯»å–æ–‡æ¡£</strong> ç†è§£æœ€æ–°çš„å¼€å‘æ–¹å¼</li>
<li>å¦‚æœæƒ³è¦ä¼˜åŒ–ç•Œé¢æ•ˆæœï¼Œè¿˜éœ€è¦ <strong>å›¾ç‰‡ç†è§£èƒ½åŠ›</strong>ï¼Œç»™ AI ä¸€å¼ å›¾ç‰‡å°±èƒ½è®©å®ƒè¿˜åŸ</li>
</ol>
<p>åœ¨æ­£å¼å¼€å‘å‰ï¼Œæˆ‘ä»¬è¦ç¡®è®¤ GLM-4.7 å’Œ Claude Code çš„é…åˆèƒ½å¤Ÿæ»¡è¶³è¿™äº›èƒ½åŠ›è¦æ±‚ã€‚</p>
<p>æ ¹æ®æ™ºè°±å®˜æ–¹ä»‹ç»ï¼ŒClaude Code ä¸­å†…ç½®äº†æ™ºè°±ä¸“å±çš„ MCP å·¥å…·ï¼Œä¸éœ€è¦å¼€å‘è€…è‡ªå·±å®‰è£…ã€‚åŒ…æ‹¬ <strong>æœç´¢å’Œç½‘é¡µè¯»å–</strong> èƒ½åŠ›ã€èƒ½å¤Ÿç›´æ¥è§£ææˆªå›¾/è®¾è®¡ç¨¿/æŠ¥é”™å›¾çš„ <strong>è§†è§‰ç†è§£èƒ½åŠ›</strong>ã€‚</p>
<p>è®©æˆ‘ä»¬ä¾æ¬¡æµ‹è¯•ä¸€ä¸‹ï¼Œé¦–å…ˆæ˜¯ç½‘é¡µæœç´¢èƒ½åŠ›ï¼Œç´§è·Ÿæ—¶äº‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe66c77d48954f97bb12fafc2d158935~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=CaoeWTfnhznaEvonN%2F6exCh4KqU%3D" alt="" loading="lazy"/></p>
<p>æµ‹è¯•ç½‘é¡µè¯»å–èƒ½åŠ›ï¼Œè®©å®ƒæ¥è¯»å–æˆ‘ä»¬ç¼–ç¨‹å¯¼èˆªç½‘ç«™çš„ä¿¡æ¯ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/28ca33e0dc8b40e9a083248ec3800ccd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=49oPG8yaroiE418rKFqVXYDkAyk%3D" alt="" loading="lazy"/></p>
<p>æµ‹è¯•å›¾ç‰‡ç†è§£èƒ½åŠ›ï¼Œæˆ‘ç»™ AI ä¼ äº†ä¸€å¼  â€œä»å¤¯åˆ°æ‹‰æ’è¡Œæ¦œçš„èƒŒæ™¯å›¾â€ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db773f9bc7cf486b88e0064c459903ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=U3UdvPDR2MdmNUdNu9izviDTXDw%3D" alt="" loading="lazy"/></p>
<p>AI çš„ç†è§£è¿˜æ˜¯å¾ˆå‡†ç¡®çš„ï¼Œå…·ä½“æ–‡å­—ä¹Ÿè¯»å–å‡ºæ¥äº†ã€‚</p>
<p>OKï¼Œå‡ ä¸ªèƒ½åŠ›éƒ½æ»¡è¶³è¦æ±‚ï¼Œä¸‹é¢è®©æˆ‘ä»¬è¿›å…¥æ–¹æ¡ˆè®¾è®¡å’Œå¼€å‘é˜¶æ®µã€‚</p>
<h2 data-id="heading-2">è®¾è®¡å¼€å‘</h2>
<p>å…ˆåˆ›å»ºä¸€ä¸ªå¹²å‡€çš„é¡¹ç›®ç›®å½• <code>yupi-code</code>ï¼Œæ‰“å¼€ç»ˆç«¯å¹¶è¿›å…¥è¯¥ç›®å½•ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f071d1bea8194b3caf2e0ce84dbb466e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=D6rBBQ5Hn%2Baskiiy9mUjuAbEas0%3D" alt="" loading="lazy"/></p>
<p>ç„¶åè¾“å…¥æç¤ºè¯ï¼š</p>
<pre><code class="hljs language-css" lang="css">å¸®æˆ‘å¼€å‘ä¸€ä¸ªç±»ä¼¼ Claude <span class="hljs-selector-tag">Code</span> çš„ç»ˆç«¯ AI ç¼–ç¨‹å·¥å…·ï¼Œèƒ½å¤Ÿä½¿ç”¨ GLM-<span class="hljs-number">4.7</span> æ¨¡å‹å¸®ç”¨æˆ·å›ç­”é—®é¢˜å’Œç”Ÿæˆä»£ç 
</code></pre>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œæ•´ä¸ªé¡¹ç›®çš„ç¬¬ä¸€å¥æç¤ºè¯æ˜¯æœ€é‡è¦çš„ï¼Œå¦‚æœæˆ‘è¦å¼€å‘ä¸€ä¸ªå¤æ‚çš„å•†ä¸šé¡¹ç›®ï¼Œè‚¯å®šä¼šå¥½å¥½æ‰“ç£¨ä¸€ä¸‹è¿™å¥æç¤ºè¯ï¼Œå°‘è¯´å†™ä¸ªå‡ ç™¾å­—ï¼ˆä¹‹å‰çœ‹è¿‡æˆ‘ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fcd7K9WQiOkP7AJglZ1b1Ng" target="_blank" title="https://mp.weixin.qq.com/s/cd7K9WQiOkP7AJglZ1b1Ng" ref="nofollow noopener noreferrer">AI ç¨‹åºå‘˜æŠ€æœ¯ç»ƒå…µåœºé¡¹ç›®</a> çš„åŒå­¦åº”è¯¥çŸ¥é“ï¼‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dfc0a92952c84b67ad80fe3dd9314865~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=jlCtPh7i0X1ztT6SXgwArnvlwPU%3D" alt="" loading="lazy"/></p>
<p>ä½†æµ‹è¯• AI æ¨¡å‹æ—¶ï¼Œæˆ‘å–œæ¬¢åå…¶é“è€Œè¡Œä¹‹ï¼Œç«™åœ¨å¤§å¤šæ•°ç”¨æˆ·çš„è§’åº¦ï¼Œæ•…æ„è¾“å…¥ä¸€å¥ç®€å•çš„æç¤ºè¯ï¼Œçœ‹çœ‹ AI èƒ½ä¸èƒ½å¼•å¯¼æˆ‘æ¥ç”Ÿæˆæ»¡è¶³éœ€æ±‚çš„é¡¹ç›®ã€‚</p>
<p>æœç„¶ï¼ŒAI åˆ¤æ–­è¿™æ˜¯ä¸€ä¸ªå¤æ‚çš„é¡¹ç›®ï¼Œæƒ³è¦è¿›å…¥ <strong>è®¡åˆ’æ¨¡å¼</strong> â€”â€” å…ˆæ˜ç¡®éœ€æ±‚ã€è®¾è®¡æ–¹æ¡ˆå†å¼€å‘ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2da1b2d39d284971a233f96b44acf68a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=%2BXyoQoUDsQ18%2BigLGMuNSZj4JZg%3D" alt="" loading="lazy"/></p>
<p>ç„¶åæˆ‘ä»¬éœ€è¦é€šè¿‡é€‰æ‹©æ¥æ˜ç¡®éœ€æ±‚ï¼Œå¹¶è®© AI ç”Ÿæˆæ–¹æ¡ˆã€‚</p>
<p>Claude Code çš„äº¤äº’åšçš„è¿˜æ˜¯ä¸é”™çš„ï¼Œå…ˆé€‰æ‹©ç¼–ç¨‹è¯­è¨€ï¼Œå»ºè®®è€è€å®å®é€‰ AI æ¨èçš„ç¬¬ä¸€ä¸ªï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ddd1677b3df64d878cccd4d89935d679~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=1U%2BHfya3WfkUJjkwG%2BLKCDaOkmU%3D" alt="" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥æ˜¯é€‰æ‹©é¡¹ç›®è¦å…·æœ‰çš„åŠŸèƒ½ã€‚å¦‚æœæ˜¯ä»¥å‰ï¼Œæˆ‘å¯èƒ½ä¼šå…ˆè®© AI åªå¼€å‘åŸºç¡€å¯¹è¯åŠŸèƒ½ï¼Œè·‘é€šæµç¨‹åå†æ·»åŠ å…¶ä»–åŠŸèƒ½ã€‚</p>
<p>ä½†ç°åœ¨æˆ‘å¯¹ AI æœ‰äº†æ›´å¤šçš„ä¿¡å¿ƒï¼Œ<strong>å’±å°±æŠŠæ‰€æœ‰åŠŸèƒ½å…¨éƒ½é€‰ä¸Šï¼Œå¹²å°±å®Œäº†ï¼</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e7b05807f9746a38dc3a53980af0cc5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=3OXjv7QT%2B5GB9OVldBcblxOBu7M%3D" alt="" loading="lazy"/></p>
<p>å…¶ä»–è®¾ç½®å°±ä¸å¤šè¯´äº†ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a3c3b32960d42ba9acc128d56e94b0a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=S%2FRT54Tjuojd88ChByegRiOjE%2Bk%3D" alt="" loading="lazy"/></p>
<p>é€‰æ‹©å®Œæˆåï¼ŒAI ç»™å‡ºäº†è¯¦ç»†çš„å®ç°è®¡åˆ’ï¼Œä¸€å®šè¦ä»”ç»†é˜…è¯»ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7b291fa1a434c97a85bf5b3c2d26345~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=hiuUw8T9Q8laCoRXe93t4ngNenw%3D" alt="" loading="lazy"/></p>
<p>ä½ å¯ä»¥ç›´æ¥æ‰§è¡Œï¼Œæˆ–è€…ç»™ AI è¿›ä¸€æ­¥çš„æŒ‡å¯¼ã€‚æ¯”å¦‚æˆ‘è®© AI ç”Ÿæˆçš„åº”ç”¨å»è°ƒç”¨æ™ºè°± Coding Plan å¥—é¤çš„ BASE URLï¼Œèƒ½èŠ‚çº¦ä¸€äº›æˆæœ¬ï¼Œå¹¶ä¸”ç»™ AI æä¾›äº†ä¸€ä¸ªå®˜æ–¹çš„ API æ–‡æ¡£ï¼Œä¾¿äº AI ç”Ÿæˆå‡†ç¡®çš„ä»£ç ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/247cdbdecdca405eb8571bc0e57d41b4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=PykJSYiGIdYGRAZfEwqDTIsSEok%3D" alt="" loading="lazy"/></p>
<p>ç¡®è®¤åå¼€å§‹æ‰§è¡Œï¼ŒAI ä¼šå…ˆè°ƒç”¨å†…ç½®çš„å·¥å…·æ¥æœç´¢å’Œè§£ææ–‡æ¡£ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb3066f442394b24b61c22b8cc4a15e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=z1KYOzo648KfGsa8YgB0jJk11po%3D" alt="" loading="lazy"/></p>
<p>ç„¶å AI åˆ—å‡ºäº†ä¸€ä¸ª Todo Listï¼Œå¹¶ä¸”ä¸€æ­¥æ­¥ç”Ÿæˆä»£ç å’Œæ–‡æ¡£ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce264a6c600f4f33ab4cb0f73d9b10d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=eiKA2Df03v1Tu2PkD%2FU2UhH2%2F8k%3D" alt="" loading="lazy"/></p>
<p>è¿™æœŸé—´å¦‚æœä½ å‘ç°æœ‰ä¸¥é‡çš„é—®é¢˜ï¼Œæ¯”å¦‚å‘ç° AI ç”Ÿæˆçš„ä»£ç å·²ç»å®Œå…¨åç¦»é¢„æœŸäº†ï¼Œé‚£ä¹ˆå°±å°½æ—©æš‚åœæˆ–è€…äººå·¥è¾“å…¥æç¤ºè¯æ¥å¼•å¯¼ AIã€‚å¦‚æœå‘ç° AI åªæ˜¯æœ‰ä¸€å°å—ä»£ç ç”Ÿæˆçš„ä¸å¯¹ï¼Œæˆ‘çš„å»ºè®®æ˜¯å…ˆå¿ç€ï¼Œåæ­£æœ€å AI å¤§æ¦‚ç‡ä¼šè‡ªå·±å‘ç°é—®é¢˜å¹¶ä¿®å¤ã€‚</p>
<p>è¿‡äº†å¤§æ¦‚åå‡ åˆ†é’Ÿåï¼ŒAI ç”Ÿæˆå®Œæˆï¼Œè¿˜å‘Šè¯‰äº†æˆ‘ä½¿ç”¨æ–¹æ³•ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a20a424d82e4a36be03dedd2ce0686f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=P8G0s6Wb88WyLOJ9J8a3UR0VMFM%3D" alt="" loading="lazy"/></p>
<p>å¯æƒœæˆ‘æ ¹æœ¬æ‡’å¾—çœ‹ï¼Œæˆ‘ç›´æ¥æŠŠ API Key äº¤ç»™ AI å¸®æˆ‘è¿è¡Œä¸å°±å¥½äº†ï¼Ÿ</p>
<p>Vibe Coding å¼€å‘æ¨¡å¼ä¸‹ï¼Œæˆ‘å¤šè‡ªå·±åšä¸€ä»¶äº‹ï¼Œéƒ½æ˜¯å¯¹ AI çš„ä¸å°Šé‡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94d4953816fe478ba863363c0623a784~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=U0UbiM8faK2xr%2F%2BFND%2FJTgbClWI%3D" alt="" loading="lazy"/></p>
<p>è¾“å…¥æç¤ºè¯ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">æˆ‘çš„ API <span class="hljs-keyword">key</span> æ˜¯ xxxxxxxï¼Œè¯·ä½ å¸®æˆ‘è¿è¡Œ
</code></pre>
<p>ç„¶åï¼Œç¿»è½¦äº†ã€‚ã€‚ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d58b4e956ff47d0b41931fb8a497d1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=8w7AXXzQVBcPGClgWGXsT%2Fm%2FLYA%3D" alt="" loading="lazy"/></p>
<p>ä¸æ…Œï¼Œç›´æ¥è®© AI è‡ªå·±æ£€æŸ¥å¹¶ä¿®å¤é”™è¯¯ã€‚è€Œä¸”ä¸ºäº†ä½¿ç”¨æ–¹ä¾¿ï¼Œåº”è¯¥æä¾›ä¸€ä¸ªå¿«é€Ÿå¯åŠ¨è„šæœ¬ï¼Œèƒ½å¤Ÿè®©æˆ‘åƒè¿è¡Œ Claude Code ä¸€æ ·ï¼Œä¸€è¡Œå‘½ä»¤å¯åŠ¨ AI ç¼–ç¨‹å·¥å…·ã€‚</p>
<p>æç¤ºè¯ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">å¸®æˆ‘æ£€æŸ¥å¹¶ä¿®å¤é¡¹ç›®ä¸­çš„é”™è¯¯ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªå¯ä»¥åƒ Claude ä¸€æ ·è®©ç”¨æˆ·åœ¨å‘½ä»¤è¡Œè¾“å…¥ <span class="hljs-string">"yupicode"</span> å°±èƒ½å¯åŠ¨ç¨‹åºçš„å¿«æ·è„šæœ¬
</code></pre>
<p>å‡ åˆ†é’Ÿåï¼ŒAI ä¿®å¤å®Œæˆï¼Œå¹¶ä¸”æä¾›äº†ä¸€ä¸ª <code>yupicode</code> è„šæœ¬ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/480880fba25d4b11b9d5bc9a9fca89a1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=PUC5MnBEvAhkfQa1L9gEhLQ89zI%3D" alt="" loading="lazy"/></p>
<p>æˆ‘æ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯ï¼Œç„¶åè¿è¡Œ <code>yupicode</code> è„šæœ¬ï¼Œå°è¯•å’Œ AI å¯¹è¯ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6734c65be73442bb8d25c4d0867fac7f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=BQ8Yoj8E%2F6nRemSiaBcVN5P4amg%3D" alt="" loading="lazy"/></p>
<p>ä½ åˆ«è¯´ï¼Œæ•ˆæœè¿˜ä¸é”™å•Šï¼</p>
<p>è¿˜åƒ Claude Code ä¸€æ ·æä¾›äº†ä¸€äº›å‘½ä»¤ï¼Œæ¯”å¦‚æ¸…ç©ºå¯¹è¯å†å²ã€æŸ¥çœ‹å¸®åŠ©ä¹‹ç±»çš„ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64b3f341f448478e9dcae2a69fe85bb1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=2aliH3bIwtDVaM7QGZN8d0MMjtc%3D" alt="" loading="lazy"/></p>
<p>çœ‹åˆ°è¿™é‡Œï¼Œæˆ‘æ„Ÿè§‰é¡¹ç›®å·²ç»åŸºæœ¬å¯ç”¨äº†ã€‚å»ºè®®ç»™é¡¹ç›®ä¸Šä¸ª Git æ¥ç‰ˆæœ¬æ§åˆ¶ï¼Œé˜²æ­¢åé¢çš„æ”¹åŠ¨å‡ºé—®é¢˜ã€‚</p>
<p>ä»€ä¹ˆï¼Ÿä½ ä¸çŸ¥é“ Git æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>æ²¡å…³ç³»ï¼Œç›´æ¥äº¤ç»™ AI å§ï¼š</p>
<pre><code class="hljs">ç°åœ¨é¡¹ç›®å·²ç»åŸºæœ¬å¯ç”¨äº†ï¼Œå¸®æˆ‘æäº¤ä¸€ä¸ª git ç‰ˆæœ¬ï¼Œé˜²æ­¢åç»­æ”¹åŠ¨å‡ºé—®é¢˜
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b742e95a06de4c049177651a571930d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=HxyrhXHiVxWtLYmThDFw5W%2B1uPE%3D" alt="" loading="lazy"/></p>
<p>æµ‹è¯•ä¸‹æ¥ï¼Œç›®å‰çš„ Yupi Code è¿˜æœ‰ä¸€äº›ä¸è¶³ä¹‹å¤„ï¼Œæ¯”å¦‚ä¸æ”¯æŒæœç´¢ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/607af21913214a658fd6f05a95226a5d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=tJi8xegWNomYSZZDIYJv0NLsIhg%3D" alt="" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬ä¼˜åŒ–é¡¹ç›®ï¼Œå¢åŠ æ›´å¤š Claude Code æ”¯æŒçš„èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-3">ä¼˜åŒ–èƒ½åŠ›</h2>
<p>1ï¼‰å…ˆæ¥æ·»åŠ ç½‘ç»œæœç´¢èƒ½åŠ›ï¼Œç›´æ¥æŠŠæ™ºè°±çš„å®˜æ–¹æ–‡æ¡£ç»™å®ƒä¸¢è¿›å»ã€‚æç¤ºè¯å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">ç°åœ¨å¥½åƒä¸æ”¯æŒç½‘ç»œæœç´¢ï¼Œè¯·å‚è€ƒ
https:<span class="hljs-regexp">//d</span>ocs.bigmodel.cn/api-reference/%E5%B7%A5%E5%85%B7-api/%E7%BD%91%E7%BB%<span class="hljs-number">9</span>C%E6%9<span class="hljs-number">0</span>%<span class="hljs-number">9</span>C%E7%B4%A2
æ–‡æ¡£ï¼Œå¢åŠ ç½‘ç»œæœç´¢å·¥å…·è°ƒç”¨èƒ½åŠ›
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/157b1318bf014959bb29eaedb0a49ec8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=aHEfQHHG1HVHbspyJvfG%2Bhoc1AI%3D" alt="" loading="lazy"/></p>
<p>å¾ˆå¿« AI å°±æ·»åŠ äº†æ–°åŠŸèƒ½ï¼Œé‡æ–°æ‰“å¼€ yupicode æ¥éªŒè¯ä¸‹ï¼Œæ­£å¸¸ç”Ÿæ•ˆäº†ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0365d092903c4922919a7d37ba32fea0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=yrBbqL84y0kPCz%2BFGZuIr%2F9fx60%3D" alt="" loading="lazy"/></p>
<p>2ï¼‰ä¸‹é¢å†ä¼˜åŒ–ä¸‹ AI å›å¤çš„æ•ˆæœï¼Œç›®å‰æ˜¯å¡ä¸€ä¼šå„¿ç„¶åç›´æ¥è¾“å‡ºå®Œæ•´å›ç­”ï¼Œéœ€è¦è°ƒæ•´ä¸ºæµå¼è¾“å‡ºçš„æ‰“å­—æœºæ•ˆæœã€‚</p>
<p>æç¤ºè¯ï¼š</p>
<pre><code class="hljs">æˆ‘å¸Œæœ›åœ¨ç­‰å¾… AI å›å¤æ—¶ï¼Œæœ‰ä¸€ä¸ªè½¬åœˆçš„å°å›¾æ ‡ï¼›å¹¶ä¸” AI çš„å›å¤å¯ä»¥å®æ—¶æµå¼è¾“å‡º
</code></pre>
<p>AI å¾ˆå¿«å°±æå®šäº†ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9a6a4a2946224f09a95fef4a631afe98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=2%2B3IadOTnv%2FzD5yyrh%2FEJ8KVCQE%3D" alt="" loading="lazy"/></p>
<p>3ï¼‰GLM-4.7 è¿›ä¸€æ­¥å¼ºåŒ–äº†äº¤é”™å¼æ€è€ƒèƒ½åŠ›ï¼Œå¼•å…¥ <strong>ä¿ç•™å¼æ€è€ƒ</strong> å’Œ <strong>è½®çº§æ€è€ƒ</strong>ï¼Œè®©å¤æ‚ä»»åŠ¡æ‰§è¡Œæ›´ç¨³ã€æ›´å¯æ§ã€‚æˆ‘ä»¬ä¹Ÿåº”è¯¥è®© Yupi Code è¾“å‡ºæ¨¡å‹çš„æ€è€ƒä¿¡æ¯ã€å·¥å…·è°ƒç”¨ä¿¡æ¯ç­‰ç­‰ï¼Œå¸®åŠ©ç”¨æˆ·äº†è§£æƒ…å†µã€‚</p>
<p>è¾“å…¥æç¤ºè¯ï¼š</p>
<pre><code class="hljs">å¸®æˆ‘è¾“å‡ºæ¨¡å‹æ€è€ƒçš„ä¿¡æ¯ã€ä»¥åŠå·¥å…·è°ƒç”¨ä¿¡æ¯ï¼Œä½ å¯ä»¥é€šè¿‡å®˜æ–¹æ–‡æ¡£æ¥äº†è§£å¦‚ä½•å¼€å‘
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/109d59f5f3c64055b095e35f9a80d9a3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=LZ2%2FdZoz08%2FM%2BpI1ItpRmTOra4U%3D" alt="" loading="lazy"/></p>
<p>æµ‹è¯•ä¸€ä¸‹ä¼˜åŒ–åçš„æ•ˆæœï¼Œæ¯”å¦‚ â€œä»‹ç»ä¸€ä¸‹é±¼çš®çš„ AI å¯¼èˆªç½‘ç«™â€ï¼Œèƒ½å¾ˆæ¸…æ™°åœ°çœ‹åˆ°æ€è€ƒè¿‡ç¨‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe75a74675804c92969459a845ca6d20~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=3PBybmOrnPkMvFfsGCdQjrnyvu0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">å¤§åŠŸå‘Šæˆ</h2>
<p>åˆ°è¿™é‡Œï¼Œä»¿ç…§ Claude Code å¼€å‘çš„ Yupi Code å°±å·²ç»å®Œæˆäº†ï¼Œè®©æˆ‘ä»¬ç”¨å®ƒæ¥å¼€å‘ä¸ªå°ç½‘ç«™è¯•è¯•ã€‚</p>
<p>æ¯”å¦‚æ¥ä¸ªåŠ¨ç”»å­¦ç®—æ³•çš„ Demoï¼Œæç¤ºè¯ï¼š</p>
<pre><code class="hljs language-css" lang="css">å¸®æˆ‘å¼€å‘ä¸€ä¸ªå­¦ä¹ å†’æ³¡æ’åºç®—æ³•çš„åŠ¨ç”»ç½‘ç«™ï¼Œä½¿ç”¨ <span class="hljs-selector-tag">Q</span> ç‰ˆåŠ¨æ¼«çš„é£æ ¼å’Œå‰ä¼Šå¡å“‡æ„Ÿè§‰çš„é…è‰²
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/437bbf742d6f41219e59bc0fb6a08367~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=53gcwbKEuwuzeJ%2BtSgCoO8tfKjw%3D" alt="" loading="lazy"/></p>
<p>æ•ˆæœå¦‚å›¾ï¼Œç”»é£è¿˜æ˜¯ä¸é”™çš„ï¼Œä½†è¦æ˜¯ä¹‹åå¤§æ¨¡å‹èƒ½è‡ªåŠ¨ç”Ÿæˆå›¾ç‰‡æ’ç”»å¹¶æ·»åŠ åˆ°ç½‘ç«™ä¸­ï¼Œå°±æ›´å¥½äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f900c67f69945ca8f6e735dfc46ce0d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=MRTDO1oSa8Jev58yaSsTAZG0X%2FI%3D" alt="" loading="lazy"/></p>
<p>å†æ¥å¼€å‘ä¸ªä»¿çœŸçš„ç”µå­é»‘æ¿ï¼Œæç¤ºè¯ï¼š</p>
<pre><code class="hljs">å¸®æˆ‘å¼€å‘ä¸€ä¸ªä»¿çœŸçš„ç”µå­é»‘æ¿ï¼Œç”¨æˆ·å¯ä»¥åœ¨ä¸Šé¢ç”»ç”»å¹¶å¯¼å‡ºä¸ºå›¾ç‰‡
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0cabbb5bd0144931bd80081cb1eca121~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=mBzflbJDACoMTUS794IWQJZYCHk%3D" alt="" loading="lazy"/></p>
<p>åœ£è¯èŠ‚äº†ï¼Œé±¼çš®ç»™å¤§å®¶ç”»é¢—åœ£è¯æ ‘ï¼Œè¿˜é™„èµ ä¸€ä¸ªå°ç¤¼ç‰©ï¼Œè¿™æ€ä¹ˆèƒ½ä¸ç®—æ˜¯ç¨‹åºå‘˜çš„æµªæ¼«å‘¢~</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d97835113ac64d2a8be69f36e3113826~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=QDbR3VcuDBPqBtHDgOygIVOyBwo%3D" alt="" loading="lazy"/></p>
<hr/>
<p>OKï¼Œè¿™å°±æ˜¯æˆ‘ <strong>åˆ©ç”¨å›½äº§çš„ AI å¤§æ¨¡å‹ GLM-4.7 + Claude Code</strong> å¼€å‘å‡ºä¸€ä¸ª <strong>åŸºäº GLM-4.7 çš„ Yupi Code</strong> çš„å…¨è¿‡ç¨‹äº†ã€‚</p>
<p>æˆ‘è‡ªå·±ä½“éªŒä¸‹æ¥ï¼ŒGLM-4.7 ç›¸æ¯”äºä¹‹å‰çš„å›½å†…å¤§æ¨¡å‹ï¼Œåœ¨å¤„ç†å¤æ‚ä»»åŠ¡çš„ç¨³å®šæ€§ä¸Šæœ‰è¿›æ­¥ï¼Œå³ä½¿é‡åˆ°é—®é¢˜ä¹Ÿä¼šè‡ªåŠ¨ä¿®å¤ï¼Œè®©æœ€ç»ˆç”Ÿæˆçš„ä»£ç å¯è¿è¡Œã€‚</p>
<p>è€Œä¸” GLM-4.7 è°ƒç”¨å·¥å…·çš„èƒ½åŠ›ä¹Ÿå¼ºåŒ–äº†ï¼Œå’Œ Claude Code ç­‰ AI ç¼–ç¨‹å·¥å…·æ‰“é…åˆï¼Œç›´æ¥å†…ç½®äº†è”ç½‘æœç´¢ã€ç½‘é¡µè¯»å–ã€è§£é‡Šå›¾ç‰‡ç­‰ AI ç¼–ç¨‹å¸¸ç”¨çš„èƒ½åŠ›ï¼Œä¸éœ€è¦è‡ªå·±å†å»æ‰¾ MCP æ¥å¢å¼ºäº†ã€‚</p>
<p>ä¸å¾—ä¸è¯´ï¼Œä½œä¸ºä¸€ç›´å…³æ³¨æ™ºè°± AI çš„å¿ å®å¼€å‘è€…ï¼ŒçœŸçš„å¾ˆèƒ½æ„Ÿå—åˆ°ä»–ä»¬è¿™å‡ ä¸ªæœˆæ¥åœ¨ AI ç¼–ç¨‹æ–¹å‘çš„åŠªåŠ›ï¼Œæˆ‘ç›¸ä¿¡å¤§å®¶ä¹Ÿæ˜¯æœ‰ç›®å…±ç¹ã€‚</p>
<p>ä¸è¿‡æ¯•ç«Ÿç°åœ¨çš„ Yupi Code æ˜¯ AI ä¸€æŠŠæ¢­çš„ï¼Œè¿˜æœ‰å¾ˆå¤šèƒ½ä¼˜åŒ–å®Œå–„çš„åœ°æ–¹ã€‚å¦‚æœåé¢æœ‰æ—¶é—´ï¼Œå¤§å®¶ä¹Ÿæ„Ÿå…´è¶£çš„è¯ï¼Œè¯´ä¸å®šæˆ‘ä¼šå¥½å¥½æ‰“ç£¨æ‰“ç£¨è¿™ä¸ªå·¥å…·æŠŠå®ƒå¼€æºå‡ºæ¥ã€‚æˆ‘çš„ç»ˆæç›®æ ‡æ˜¯ï¼Œè®©åŸºäº <strong>AI å¤§æ¨¡å‹ GLM-4.7 + Claude Code</strong> å¼€å‘çš„åŸºäº <strong>GLM-4.7 çš„ Yupi Code</strong> ç¼–ç¨‹å·¥å…·ï¼Œèƒ½å¤Ÿå¼€å‘å‡ºä¸€ä¸ªåŸºäº <strong>GLM-4.7 çš„</strong> ç¼–ç¨‹å·¥å…·ï¼Œæ¯”å¦‚ Yupi Son Codeã€‚æˆ‘è®¤ä¸ºå¥½çš„ AI å·¥å…·å°±æ˜¯è¦èƒ½åšåˆ°æ— é™å¥—å¨ƒï¼Œç–¯ç‹‚è‡ªä¸¾ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e176b292a14411e9c8943984cd0e455~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6bG855qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767238131&amp;x-signature=uciHH69IM8Olfil1Xzso0twtUsg%3D" alt="" loading="lazy"/></p>
<p>å¬æ‡‚æŒå£°~</p>
<h2 data-id="heading-5">æ›´å¤š</h2>
<p>ğŸ’» ç¼–ç¨‹å­¦ä¹ äº¤æµï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fliyupi%2Fcode-nav" target="_blank" title="https://github.com/liyupi/code-nav" ref="nofollow noopener noreferrer">ç¼–ç¨‹å¯¼èˆª</a> ğŸ“ƒ ç®€å†å¿«é€Ÿåˆ¶ä½œï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fliyupi%2Flaoyujianli" target="_blank" title="https://github.com/liyupi/laoyujianli" ref="nofollow noopener noreferrer">è€é±¼ç®€å†</a> âœï¸ é¢è¯•åˆ·é¢˜ç¥å™¨ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fliyupi%2Fmianshiya" target="_blank" title="https://github.com/liyupi/mianshiya" ref="nofollow noopener noreferrer">é¢è¯•é¸­</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ„å»º AI-Ready è½¯ä»¶ï¼šä¸‰å±‚æ¥å£æ¨¡å‹ä¸æ™ºèƒ½è°ƒåº¦æ¶æ„]]></title>    <link>https://juejin.cn/post/7587342120021917747</link>    <guid>https://juejin.cn/post/7587342120021917747</guid>    <pubDate>2025-12-25T03:31:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587342120021917747" data-draft-id="7587325326046232585" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ„å»º AI-Ready è½¯ä»¶ï¼šä¸‰å±‚æ¥å£æ¨¡å‹ä¸æ™ºèƒ½è°ƒåº¦æ¶æ„"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-25T03:31:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‡ªç”±ç”Ÿé•¿2024"/> <meta itemprop="url" content="https://juejin.cn/user/1591748569862670"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ„å»º AI-Ready è½¯ä»¶ï¼šä¸‰å±‚æ¥å£æ¨¡å‹ä¸æ™ºèƒ½è°ƒåº¦æ¶æ„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1591748569862670/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‡ªç”±ç”Ÿé•¿2024
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T03:31:48.000Z" title="Thu Dec 25 2025 03:31:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ‘˜è¦ï¼šæœ¬æ–‡æå‡ºäº†ä¸€ä¸ªAI-READYçš„æ§åˆ¶è½¯ä»¶çš„æ¨¡å‹ï¼ŒåŸºäºä¸‰å±‚æ¶æ„ï¼Œè¯­éŸ³æˆ–è€…æ–‡æœ¬æ¥å£ï¼ŒCoreAPIå’ŒGUIåŒæ­¥APIï¼Œä»¥ä½æˆæœ¬ç²¾å‡†çš„æ“ä½œæ–¹å¼å»æ„å»ºAIæ™ºèƒ½è½¯ä»¶ï¼Œè€Œéå…¨éƒ¨åŸºäºå›¾åƒè¯†åˆ«è¯†åˆ«å»ä»æ“ä½œè½¯ä»¶ã€‚</p>
<h2 data-id="heading-0"><strong>æ„å»º AI-Ready è½¯ä»¶ï¼šä¸‰ä½ä¸€ä½“æ¥å£æ¨¡å‹ä¸æ™ºèƒ½è°ƒåº¦æ¶æ„</strong></h2>
<h3 data-id="heading-1">å¼•è¨€ï¼šå½“è½¯ä»¶éœ€è¦â€œå¬æ‡‚äººè¯â€</h3>
<p>åœ¨å¤§æ¨¡å‹ï¼ˆLLMï¼‰èƒ½åŠ›æ—¥ç›Šæˆç†Ÿçš„ä»Šå¤©ï¼Œâ€œè®© AI æ“ä½œè½¯ä»¶â€å·²ä¸å†æ˜¯å®éªŒå®¤é‡Œçš„å¥‡æƒ³ï¼Œè€Œæˆä¸ºæå‡äººæœºååŒæ•ˆç‡çš„å…³é”®è·¯å¾„ã€‚ç„¶è€Œï¼Œè®¸å¤šå°è¯•ä»åœç•™åœ¨ä¸¤ä¸ªæç«¯ï¼šè¦ä¹ˆç”¨è®¡ç®—æœºè§†è§‰æ¨¡æ‹Ÿäººç±»ç‚¹å‡»ï¼ˆè„†å¼±ä¸”ä½æ•ˆï¼‰ï¼Œè¦ä¹ˆç›´æ¥æš´éœ²åº•å±‚å‘½ä»¤è¡Œï¼ˆé»‘ç›’ä¸”éš¾ç”¨ï¼‰ã€‚</p>
<p>çœŸæ­£å®ç”¨çš„æ–¹æ¡ˆï¼Œå¿…é¡»å›ç­”ä¸‰ä¸ªæ ¸å¿ƒé—®é¢˜ï¼š</p>
<ol>
<li><strong>å¦‚ä½•ç†è§£ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æŒ‡ä»¤ï¼Ÿ</strong></li>
<li><strong>å¦‚ä½•å¯é ã€é«˜æ•ˆåœ°æ‰§è¡Œæ“ä½œï¼Ÿ</strong></li>
<li><strong>å¦‚ä½•è®©ç”¨æˆ·â€œçœ‹å¾—è§ã€ä¿¡å¾—è¿‡â€ï¼Ÿ</strong></li>
</ol>
<p>æœ¬æ–‡æå‡ºä¸€ç§<strong>ä¸‰ä½ä¸€ä½“çš„æ™ºèƒ½è½¯ä»¶æ¥å£æ¨¡å‹</strong>ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šæ„å»º<strong>ä»¥è°ƒåº¦ä¸­æ¢ä¸ºæ ¸å¿ƒçš„ååŒæ¶æ„</strong>ï¼Œä¸ºå¼€å‘è€…æä¾›ä¸€æ¡æ¸…æ™°ã€å¯è½åœ°çš„â€œAI-Ready è½¯ä»¶â€æ”¹é€ è·¯å¾„ã€‚</p>
<p>ä½•è°“AI-Readyï¼Ÿ <strong>AI-Ready</strong>è¿™ä¸ªæœ¯è¯­ï¼Œæ˜¯è¿‘å¹´æ¥åœ¨è½¯ä»¶å·¥ç¨‹ã€äº§å“è®¾è®¡å’Œä¼ä¸šæ•°å­—åŒ–è½¬å‹ä¸­é€æ¸æµè¡Œèµ·æ¥çš„ä¸€ä¸ªå…³é”®æ¦‚å¿µã€‚å®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªéšæ„çš„è¥é”€è¯æ±‡ï¼Œè€Œæ˜¯å¯¹ä¸€ç±»<strong>å…·å¤‡ä¸äººå·¥æ™ºèƒ½ç³»ç»Ÿï¼ˆå°¤å…¶æ˜¯å¤§è¯­è¨€æ¨¡å‹å’Œæ™ºèƒ½ä½“ï¼‰é«˜æ•ˆã€å®‰å…¨ã€å¯é ååŒèƒ½åŠ›</strong>çš„è½¯ä»¶æˆ–ç³»ç»Ÿçš„ç²¾å‡†æè¿°ã€‚</p>
<p>æŠ€æœ¯å²ä¸Šï¼Œæˆ‘ä»¬æ—©å·²ä¹ æƒ¯ç”¨ â€œ-Readyâ€ æ¥æè¿°ç³»ç»Ÿæ˜¯å¦é€‚é…æ–°èŒƒå¼ï¼š</p>
<ul>
<li><strong>Mobile-Readyï¼ˆç§»åŠ¨å°±ç»ªï¼‰</strong> ï¼šæŒ‡ç½‘ç«™æˆ–åº”ç”¨èƒ½è‡ªé€‚åº”æ‰‹æœºå±å¹•ã€è§¦æ§æ“ä½œã€ä½å¸¦å®½ç­‰ç§»åŠ¨ç¯å¢ƒã€‚</li>
<li><strong>Cloud-Readyï¼ˆäº‘å°±ç»ªï¼‰</strong> ï¼šæŒ‡è½¯ä»¶èƒ½å¼¹æ€§ä¼¸ç¼©ã€æ— çŠ¶æ€éƒ¨ç½²ã€é€šè¿‡ API å¯¹æ¥äº‘æœåŠ¡ã€‚</li>
</ul>
<p>åŒç†ï¼Œ<strong>AI-Ready = è½¯ä»¶å·²åšå¥½ä¸ AI æ™ºèƒ½ä½“ååŒå·¥ä½œçš„å‡†å¤‡ã€‚</strong></p>
<p>å®ƒæ„å‘³ç€ï¼š<strong>è½¯ä»¶ä¸å†åªæ˜¯ä¸€ä¸ªå­¤ç«‹çš„å·¥å…·ï¼Œè€Œæ˜¯ä¸€ä¸ªå¯è¢« AI ç†è§£ã€è°ƒç”¨ã€ç»„åˆçš„â€œèƒ½åŠ›å•å…ƒâ€</strong> ã€‚ç±»ä¼¼äºMCPå·¥å…·ï¼Œä½†æ˜¯è¶…è¶ŠMCPä½œä¸ºè·å¾—ä¿¡æ¯çš„æ¥å£ï¼Œè€Œæ˜¯ç›´æ¥ä¸ŠAIæ§åˆ¶ä¼ ç»Ÿçš„è½¯ä»¶ã€‚</p>
<p>ä¸€ä¸ª AI-Ready çš„è½¯ä»¶ï¼Œå¿…é¡»æ»¡è¶³ä»¥ä¸‹è‡³å°‘ä¸‰é¡¹åŸºæœ¬æ¡ä»¶ï¼š</p>
<ul>
<li><strong>å¯ç¼–ç¨‹æ¥å£ï¼ˆProgrammableï¼‰</strong>ï¼Œæä¾›æ¸…æ™°ã€ç¨³å®šçš„ API æˆ–è„šæœ¬æ¥å£ï¼Œå…è®¸å¤–éƒ¨ç¨‹åºï¼ˆå¦‚ AI Agentï¼‰è°ƒç”¨å…¶åŠŸèƒ½ã€‚åä¾‹å¦‚åªæœ‰å›¾å½¢ç•Œé¢ï¼Œæ— ä»»ä½•å‘½ä»¤è¡Œæˆ– API æ”¯æŒã€‚</li>
<li><strong>è¯­ä¹‰å¯ç†è§£ï¼ˆSemantically Describableï¼‰</strong>ï¼ŒåŠŸèƒ½å¯é€šè¿‡è‡ªç„¶è¯­è¨€æè¿°ï¼ˆå¦‚â€œä¿å­˜æ–‡ä»¶â€â€œå¯¼å‡ºPDFâ€ï¼‰ï¼Œä¸”æœ‰å¯¹åº”çš„ç»“æ„åŒ–å…ƒæ•°æ®ï¼ˆå¦‚ OpenAPIï¼‰ã€‚åä¾‹å¦‚åŠŸèƒ½éšè—åœ¨å¤šå±‚èœå•ä¸­ï¼Œæ— æ³•ç”¨ä¸€å¥è¯è¯´æ¸…ã€‚</li>
<li><strong>çŠ¶æ€å¯è§‚æµ‹ï¼ˆObservableï¼‰</strong> æ“ä½œç»“æœå¯è¢«å¤–éƒ¨æ„ŸçŸ¥ï¼ˆå¦‚è¿”å›æˆåŠŸ/å¤±è´¥ã€è§¦å‘äº‹ä»¶ã€æ›´æ–°çŠ¶æ€ï¼‰ï¼Œä¾¿äº AI åˆ¤æ–­ä¸‹ä¸€æ­¥ã€‚</li>
<li><strong>å®‰å…¨å¯æ§ï¼ˆControllableï¼‰</strong> æ”¯æŒæƒé™æ§åˆ¶ã€æ“ä½œå®¡è®¡ã€ç”¨æˆ·æˆæƒï¼Œé˜²æ­¢ AI æ»¥ç”¨ã€‚è€Œè¿‡å¾€çš„è®¾è®¡ï¼Œä¸€æ—¦å¼€æ”¾æ¥å£ï¼Œå°±ç­‰äºå®Œå…¨æ”¾æƒï¼Œæ— ç»†ç²’åº¦æ§åˆ¶ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-2">ä¸€ã€ä¸‰ä½ä¸€ä½“æ¥å£æ¨¡å‹ï¼šè¯­éŸ³å…¥å£ + æ ¸å¿ƒæ“ä½œ API + GUI åŒæ­¥ API</h3>
<p>æˆ‘ä»¬ä¸»å¼ ï¼Œä»»ä½•ä¸€ä¸ªå¸Œæœ›æ”¯æŒ AI æ§åˆ¶çš„ç°ä»£è½¯ä»¶ï¼Œéƒ½åº”åŒæ—¶æä¾›ä»¥ä¸‹ä¸‰ç±»æ¥å£ï¼Œå½¢æˆé—­ç¯ï¼š</p>
<h4 data-id="heading-3">1. è¯­éŸ³/è‡ªç„¶è¯­è¨€å…¥å£ï¼ˆVoice/NL Gatewayï¼‰</h4>
<p>è¿™æ˜¯ç”¨æˆ·ä¸ AI çš„äº¤äº’èµ·ç‚¹ã€‚å®ƒä¸æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œåªè´Ÿè´£å°†æ¨¡ç³Šçš„äººç±»è¯­è¨€è½¬åŒ–ä¸ºç»“æ„åŒ–æŒ‡ä»¤ã€‚</p>
<ul>
<li><strong>è¾“å…¥</strong>ï¼šè¯­éŸ³æˆ–æ–‡æœ¬ï¼ˆå¦‚â€œæŠŠè¿™å¼ å›¾å‘ç»™æå·¥ï¼Œå¹¶åŠ ä¸ªæ°´å°â€ï¼‰ã€‚</li>
<li><strong>å¤„ç†</strong>ï¼šé€šè¿‡æœ¬åœ°æˆ–äº‘ç«¯å¤§æ¨¡å‹è¿›è¡Œæ„å›¾è¯†åˆ«ä¸å‚æ•°æŠ½å–ã€‚</li>
<li><strong>è¾“å‡º</strong>ï¼šæ ‡å‡†åŒ–çš„æ“ä½œè¯·æ±‚å¯¹è±¡ï¼Œä¾‹å¦‚ï¼š
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"send_with_watermark"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"li.gong@company.com"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"image_path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/tmp/photo.png"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
</ul>
<blockquote>
<p>âœ… å…³é”®åŸåˆ™ï¼š<strong>è§£è€¦ç†è§£ä¸æ‰§è¡Œ</strong>ã€‚NL å…¥å£åªåšâ€œç¿»è¯‘â€ï¼Œä¸åšâ€œå†³ç­–â€ã€‚</p>
</blockquote>
<h4 data-id="heading-4">2. æ ¸å¿ƒæ“ä½œ APIï¼ˆCore Action APIï¼‰</h4>
<p>è¿™æ˜¯è½¯ä»¶çœŸæ­£çš„â€œè‚Œè‚‰â€â€”â€”æ‰€æœ‰ä¸šåŠ¡é€»è¾‘çš„ç¨‹åºåŒ–å…¥å£ã€‚</p>
<ul>
<li>
<p><strong>è®¾è®¡è¦æ±‚</strong>ï¼š</p>
<ul>
<li><strong>åŸå­æ€§</strong>ï¼šæ¯ä¸ª API å¯¹åº”å•ä¸€ã€æ˜ç¡®çš„æ“ä½œï¼›</li>
<li><strong>æ—  GUI ä¾èµ–</strong>ï¼šå³ä½¿ç•Œé¢æœªå¯åŠ¨ï¼Œä¹Ÿèƒ½è¿è¡Œï¼ˆæ”¯æŒ headless æ¨¡å¼ï¼‰ï¼›</li>
<li><strong>å¹‚ç­‰æ€§ä¸é”™è¯¯åé¦ˆ</strong>ï¼šä¾¿äº AI è¿›è¡Œé‡è¯•æˆ–å›æ»šã€‚</li>
</ul>
</li>
<li>
<p><strong>æ¥å£å½¢å¼çµæ´»</strong>ï¼š</p>
<ul>
<li>å‡½æ•°è°ƒç”¨ï¼ˆ<code>save_project(path)</code>ï¼‰</li>
<li>REST/gRPCï¼ˆè·¨è¿›ç¨‹ï¼‰</li>
<li>CLIï¼ˆ<code>myapp --save --path=xxx</code>ï¼‰</li>
</ul>
</li>
</ul>
<blockquote>
<p>âœ… è¿™æ˜¯ç³»ç»Ÿ<strong>å¯é æ€§ä¸æ€§èƒ½çš„åŸºçŸ³</strong>ã€‚AI åº”ç›´æ¥è°ƒç”¨æ­¤å±‚ï¼Œè€Œéæ¨¡æ‹Ÿé¼ æ ‡ç‚¹å‡»ã€‚</p>
</blockquote>
<h4 data-id="heading-5">3. GUI åŒæ­¥ APIï¼ˆGUI Sync APIï¼‰</h4>
<p>è¿™æ˜¯é¢å‘äººç±»çš„â€œä¿¡ä»»å±‚â€ã€‚å®ƒåœ¨æ ¸å¿ƒæ“ä½œå®Œæˆåï¼Œä¸»åŠ¨è§¦å‘ç•Œé¢æ›´æ–°ï¼Œè®©ç”¨æˆ·æ„ŸçŸ¥åˆ° AI å·²å®Œæˆä»»åŠ¡ã€‚</p>
<ul>
<li><strong>å…¸å‹è¡Œä¸º</strong>ï¼š
<ul>
<li>ä»¿äººç±»çš„å¤šæ­¥éª¤ç‚¹å‡»å’Œé¡µé¢åˆ‡æ¢åŠ¨ç”»ï¼Œå‘ç”¨æˆ·æ¸…æ™°åŒæ­¥å±•ç¤ºæ ¸å¿ƒAPIæ“ä½œè¿‡ç¨‹</li>
<li>æ›´æ–°çŠ¶æ€æ ï¼šâ€œå·²ä¿å­˜è‡³ ~/Documentsâ€</li>
<li>é«˜äº®ç›¸å…³èœå•é¡¹</li>
<li>æ’­æ”¾å¾®åŠ¨æ•ˆï¼ˆå¦‚æˆåŠŸæ‰“é’©åŠ¨ç”»ï¼‰</li>
</ul>
</li>
<li><strong>å…³é”®ç‰¹æ€§</strong>ï¼š
<ul>
<li><strong>éé˜»å¡</strong>ï¼šä¸å½±å“æ ¸å¿ƒé€»è¾‘æ‰§è¡Œï¼›</li>
<li><strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šç”± Core API è§¦å‘å›è°ƒï¼Œè€Œéè½®è¯¢ï¼›</li>
<li><strong>å¯å…³é—­</strong>ï¼šæ”¯æŒæ— å¤´è¿è¡Œæ¨¡å¼ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>âœ… GUI åŒæ­¥ä¸æ˜¯ä¸ºäº† AI çœ‹ï¼Œè€Œæ˜¯ä¸ºäº†<strong>äººçœ‹</strong>â€”â€”è¿™æ˜¯äººæœºååŒä¸­ä¸å¯å¿½è§†çš„å¿ƒç†å¥‘çº¦ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-6">äºŒã€æ‰§è¡Œæµç¨‹ï¼šä»è¯­éŸ³åˆ°åé¦ˆçš„å®Œæ•´é—­ç¯</h3>
<p>æ•´ä¸ªäº¤äº’è¿‡ç¨‹å¯åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant User as ç”¨æˆ·ï¼ˆè¯­éŸ³ï¼‰
    participant NL_Gateway as è¯­éŸ³/NLå…¥å£
    participant Core_API as æ ¸å¿ƒæ“ä½œAPI
    participant GUI_Sync as GUIåŒæ­¥API
    participant Model as å¤§æ¨¡å‹

    User-&gt;&gt;NL_Gateway: â€œå¯¼å‡ºå½“å‰å›¾è¡¨ä¸ºPDFâ€
    NL_Gateway-&gt;&gt;Model: å‘é€æ–‡æœ¬
    Model--&gt;&gt;NL_Gateway: è¿”å› {action: &amp;#34;export_pdf&amp;#34;, format: &amp;#34;A4&amp;#34;}
    NL_Gateway-&gt;&gt;Core_API: è°ƒç”¨ export_pdf(&amp;#34;A4&amp;#34;)
    Core_API-&gt;&gt;Core_API: æ‰§è¡Œæ¸²æŸ“ä¸æ–‡ä»¶å†™å…¥
    Core_API-&gt;&gt;GUI_Sync: è§¦å‘ on_export_success(path)
    GUI_Sync-&gt;&gt;GUI: æ˜¾ç¤ºâ€œPDFå·²ç”Ÿæˆâ€é€šçŸ¥ + è‡ªåŠ¨æ‰“å¼€æ–‡ä»¶å¤¹
</code></pre>
<p>è¿™ä¸€æµç¨‹ç¡®ä¿äº†ï¼š</p>
<ul>
<li><strong>é«˜æ•ˆ</strong>ï¼šç»•è¿‡ GUI ç›´æ¥æ“ä½œæ•°æ®ï¼›</li>
<li><strong>å¯é </strong>ï¼šæ ¸å¿ƒé€»è¾‘å¯æµ‹è¯•ã€å¯å®¡è®¡ï¼›</li>
<li><strong>å¯ä¿¡</strong>ï¼šç”¨æˆ·è·å¾—å³æ—¶ã€ç›´è§‚çš„åé¦ˆã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-7">ä¸‰ã€è¿›é˜¶æ¶æ„ï¼šå¼•å…¥è°ƒåº¦ä¸­æ¢ï¼ˆOrchestratorï¼‰</h3>
<p>å½“å•åº”ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠä¸‰å±‚æ¶æ„å°è£…åœ¨åŒä¸€ä¸ªåº”ç”¨å†…ï¼Œè€Œå½“ç³»ç»Ÿæ¶‰åŠå¤šä¸ªåº”ç”¨ï¼ˆå¦‚å¯¼èˆª + é€šè®¯ + åŒ»ç–—å½±åƒï¼‰æ—¶ï¼Œéœ€å¼•å…¥<strong>æ ¸å¿ƒè°ƒåº¦è½¯ä»¶</strong>ä½œä¸ºç»Ÿä¸€åè°ƒè€…ã€‚</p>
<h4 data-id="heading-8">æ¶æ„ç»„æˆ</h4>
<ul>
<li>
<p><strong>è°ƒåº¦ä¸­æ¢ï¼ˆOrchestratorï¼‰</strong>ï¼š</p>
<ul>
<li>ç»Ÿä¸€æ¥æ”¶ç”¨æˆ·æŒ‡ä»¤ï¼›</li>
<li>åˆ©ç”¨å¤§æ¨¡å‹è¿›è¡Œä»»åŠ¡è§„åˆ’ï¼›</li>
<li>ç»´æŠ¤åº”ç”¨æ³¨å†Œè¡¨ï¼ŒåŠ¨æ€è·¯ç”± API è°ƒç”¨ï¼›</li>
<li>å®ç°æƒé™æ§åˆ¶ä¸æ“ä½œå®¡è®¡ã€‚</li>
</ul>
</li>
<li>
<p><strong>åº”ç”¨è½¯ä»¶ï¼ˆAgentsï¼‰</strong>ï¼š</p>
<ul>
<li>å‘è°ƒåº¦ä¸­æ¢æ³¨å†Œè‡ªèº«èƒ½åŠ›ï¼ˆç±»ä¼¼ OpenAPIï¼‰ï¼›</li>
<li>æä¾›æ ‡å‡†åŒ– Core API ä¸ GUI Sync æ¥å£ï¼›</li>
<li>å¯ç‹¬ç«‹å‡çº§ï¼Œä¸å½±å“æ•´ä½“ç³»ç»Ÿã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-9">æ¶æ„ä¼˜åŠ¿</h4>

























<table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>è§£è€¦</strong></td><td>æ–°å¢åº”ç”¨æ— éœ€ä¿®æ”¹è°ƒåº¦å™¨</td></tr><tr><td><strong>å®‰å…¨</strong></td><td>æ‰€æœ‰æ“ä½œç»ä¸­æ¢æˆæƒï¼Œé¿å…è¶Šæƒ</td></tr><tr><td><strong>è·¨å¹³å°</strong></td><td>å¯è°ƒåº¦æ¡Œé¢ã€Webã€IoT è®¾å¤‡</td></tr><tr><td><strong>å¯è§‚æµ‹</strong></td><td>å…¨é“¾è·¯æ—¥å¿—æ”¯æŒè°ƒè¯•ä¸å›æ”¾</td></tr></tbody></table>
<blockquote>
<p>è¿™ä¸€æ¶æ„ç±»ä¼¼äºæ“ä½œç³»ç»Ÿçš„å†…æ ¸ï¼ˆè°ƒåº¦ä¸­æ¢ï¼‰ä¸ç”¨æˆ·æ€ç¨‹åºï¼ˆåº”ç”¨è½¯ä»¶ï¼‰çš„å…³ç³»ï¼Œæ˜¯æ„å»º<strong>ä¸ªäººæ™ºèƒ½ä½“æ“ä½œç³»ç»Ÿ</strong>çš„é›å½¢ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-10">å››ã€å…¸å‹åº”ç”¨åœºæ™¯ï¼šå½“â€œæ‰‹â€ä¸å¯ç”¨æ—¶ï¼ŒAI æˆä¸ºå»¶ä¼¸</h3>
<p>è¯¥æ¨¡å‹çš„ä»·å€¼åœ¨ä»¥ä¸‹é«˜ä¸“æ³¨åº¦ã€é«˜é£é™©åœºæ™¯ä¸­å°¤ä¸ºçªå‡ºï¼š</p>
<ul>
<li><strong>æ™ºèƒ½é©¾é©¶</strong>ï¼šè¯­éŸ³æŒ‡ä»¤ â†’ è°ƒç”¨å¯¼èˆª API â†’ ä¸­æ§å±åŒæ­¥åˆ·æ–°è·¯çº¿ï¼›</li>
<li><strong>å¤–ç§‘æ‰‹æœ¯</strong>ï¼šåŒ»ç”Ÿè¯´â€œè°ƒå‡ºæ˜¨æ—¥ MRIâ€ â†’ AI è°ƒç”¨ PACS ç³»ç»Ÿ â†’ æ‰‹æœ¯å®¤å¤§å±å³æ—¶æ˜¾ç¤ºï¼›</li>
<li><strong>æ·±ç©ºæ¢ç´¢</strong>ï¼šå®‡èˆªå‘˜éª¨ä¼ å¯¼è¯­éŸ³ â†’ æ§åˆ¶æœºæ¢°è‡‚é‡‡æ · â†’ HUD æ˜¾ç¤ºæ“ä½œçŠ¶æ€ã€‚</li>
<li><strong>ä¼´éšç›‘æ§</strong>ï¼šè¯­éŸ³/åŠ¨ä½œæŒ‡ä»¤ â†’ è°ƒç”¨è®°å½• API â†’ å¢åŠ è®°å½•æ—¥å¿—ï¼›</li>
</ul>
<blockquote>
<p>åœ¨è¿™äº›åœºæ™¯ä¸­ï¼Œ<strong>æ‰‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œçœ¼éœ€ä¸“æ³¨ä¸»ä»»åŠ¡ï¼Œå˜´æˆä¸ºæœ€è‡ªç„¶çš„è¾“å…¥é€šé“</strong>ã€‚ä¸‰ä½ä¸€ä½“æ¨¡å‹å®Œç¾å¥‘åˆè¿™ä¸€éœ€æ±‚ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-11">äº”ã€å®è·µå»ºè®®</h3>
<ol>
<li>
<p><strong>å…ˆé‡æ„ Core API</strong><br/>
å°†ç°æœ‰åŠŸèƒ½å°è£…ä¸ºæ—  GUI ä¾èµ–çš„å‡½æ•°ï¼Œç¡®ä¿å¯è„šæœ¬åŒ–è°ƒç”¨ã€‚</p>
</li>
<li>
<p><strong>æ·»åŠ  GUI Sync é’©å­</strong><br/>
åœ¨å…³é”®æ“ä½œåè§¦å‘äº‹ä»¶ï¼ˆå¦‚ <code>on_save_complete</code>ï¼‰ï¼Œç”±ç•Œé¢å±‚ç›‘å¬å¹¶æ›´æ–°ã€‚</p>
</li>
<li>
<p><strong>æ¥å…¥ NL å…¥å£</strong><br/>
ä½¿ç”¨ LangChainã€Ollama æˆ–è‡ªç ” Agent æ¡†æ¶ï¼Œå°† Core API æ³¨å†Œä¸ºå·¥å…·ï¼ˆToolsï¼‰ã€‚</p>
</li>
<li>
<p><strong>æä¾›å¼€å…³ä¸æ—¥å¿—</strong><br/>
å…è®¸ç”¨æˆ·å…³é—­ AI æ§åˆ¶ï¼Œå¹¶è®°å½•æ‰€æœ‰æ“ä½œç”¨äºå®¡è®¡ã€‚</p>
</li>
</ol>
<hr/>
<h3 data-id="heading-12">ç»“è¯­ï¼šèµ°å‘äººæœºååŒçš„æ–°èŒƒå¼</h3>
<p>æœªæ¥çš„è½¯ä»¶ï¼Œä¸åº”åªæ˜¯è¢«åŠ¨å“åº”ç‚¹å‡»çš„å·¥å…·ï¼Œè€Œåº”æˆä¸ºèƒ½ç†è§£æ„å›¾ã€ä¸»åŠ¨åä½œçš„æ™ºèƒ½ä¼™ä¼´ã€‚</p>
<p>é€šè¿‡<strong>ä¸‰ä½ä¸€ä½“æ¥å£æ¨¡å‹</strong>ï¼ˆè¯­éŸ³å…¥å£ + æ ¸å¿ƒ API + GUI åŒæ­¥ï¼‰ä¸<strong>è°ƒåº¦ä¸­æ¢æ¶æ„</strong>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸ç‰ºç‰²ç¨³å®šæ€§ä¸å®‰å…¨æ€§çš„å‰æä¸‹ï¼Œèµ‹äºˆè½¯ä»¶çœŸæ­£çš„â€œå¯å¯¹è¯æ€§â€ä¸â€œå¯æ“ä½œæ€§â€ã€‚</p>
<p>è¿™ä¸ä»…æ˜¯æŠ€æœ¯å‡çº§ï¼Œæ›´æ˜¯ä¸€æ¬¡äº¤äº’èŒƒå¼çš„è·ƒè¿ï¼š</p>
<blockquote>
<p><strong>AI è´Ÿè´£å¹²æ´»ï¼ŒGUI è´Ÿè´£æ²Ÿé€šï¼Œäººè´Ÿè´£å†³ç­–ã€‚</strong></p>
</blockquote>
<p>åœ¨é©¾é©¶èˆ±ã€æ‰‹æœ¯å®¤ã€ç©ºé—´ç«™â€”â€”ä¹ƒè‡³æ¯ä¸ªäººçš„æ—¥å¸¸å·¥ä½œä¸­ï¼Œè¿™æ ·çš„ç³»ç»Ÿå°†æˆä¸ºäººæœºå…±ç”Ÿçš„æ–°åŸºç¡€è®¾æ–½ã€‚</p>
<hr/>
<p>å¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€æ¬¾æ¡Œé¢æˆ– Web åº”ç”¨ï¼Œå¹¶å¸Œæœ›æ”¯æŒ AI æ§åˆ¶ï¼Œä¸å¦¨ä¸ºä½ çš„è½¯ä»¶åŠ ä¸Šè¿™ä¸‰å±‚æ¥å£ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·¡æ³Šååˆ©ä¸ç”Ÿæ´»ç„¦è™‘ï¼šå†™ç»™ IT äººçš„ä¸€ç‚¹ä¸ªäººæ€è€ƒ]]></title>    <link>https://juejin.cn/post/7587334152870297640</link>    <guid>https://juejin.cn/post/7587334152870297640</guid>    <pubDate>2025-12-25T03:49:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587334152870297640" data-draft-id="7587342664077688847" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·¡æ³Šååˆ©ä¸ç”Ÿæ´»ç„¦è™‘ï¼šå†™ç»™ IT äººçš„ä¸€ç‚¹ä¸ªäººæ€è€ƒ"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-25T03:49:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¼–ç¨‹å¹²è´§é“º"/> <meta itemprop="url" content="https://juejin.cn/user/52383084474680"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·¡æ³Šååˆ©ä¸ç”Ÿæ´»ç„¦è™‘ï¼šå†™ç»™ IT äººçš„ä¸€ç‚¹ä¸ªäººæ€è€ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/52383084474680/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¼–ç¨‹å¹²è´§é“º
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T03:49:48.000Z" title="Thu Dec 25 2025 03:49:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62192a1cac294ea7b30f87a44c9c042c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg57yW56iL5bmy6LSn6ZO6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767239388&amp;x-signature=QfZeayrE22VO7nSVUNnOlb2Pyek%3D" alt="ChatGPT Image 2025å¹´12æœˆ25æ—¥ 11_38_42.png" loading="lazy"/></p>
<p>è¿™ä¸¤å¹´æˆ‘ç»å¸¸ä¼šå¬åˆ°ä¸¤å¥è¯ã€‚</p>
<p>ä¸€å¥æ˜¯â€œè¦æ·¡æ³Šååˆ©â€ï¼Œå¥½åƒåªè¦å¿ƒæ€ç¨³ä¸€ç‚¹ï¼Œç”Ÿæ´»å°±èƒ½è½»å¾ˆå¤šã€‚å¦ä¸€å¥æ˜¯â€œåˆ«çŸ«æƒ…ï¼Œå…ˆæŠŠé’±æŒ£äº†â€ï¼Œå¥½åƒåªè¦è¶³å¤ŸåŠªåŠ›ï¼Œç„¦è™‘è‡ªç„¶ä¼šæ¶ˆå¤±ã€‚</p>
<p>ä½†ä½œä¸ºä¸€ä¸ªé•¿æœŸå’Œ IT åœˆèŠ‚å¥æ‰“äº¤é“çš„äººï¼Œæˆ‘è¶Šæ¥è¶Šè§‰å¾—ï¼š<strong>å¾ˆå¤šç„¦è™‘ä¸æ˜¯ä½ æƒ³ä¸å¼€ï¼Œè€Œæ˜¯ä½ ä¸€ç›´å¤„åœ¨ä¸€ä¸ªâ€œéšæ—¶ä¼šè¢«æ·˜æ±°â€çš„å™äº‹é‡Œã€‚</strong><br/>
åœ¨è¿™ç§å™äº‹é‡Œè°ˆâ€œæ·¡æ³Šååˆ©â€ï¼Œå¾ˆå®¹æ˜“å˜æˆä¸€å¥ç«™ç€è¯´è¯ä¸è…°ç–¼çš„å®‰æ…°ã€‚</p>
<p>æ‰€ä»¥æˆ‘æƒ³æŠŠâ€œæ·¡æ³Šååˆ©â€æ¢ä¸€ç§æ›´æ¥åœ°æ°”çš„è¯´æ³•ï¼š<br/>
<strong>ä¸æ˜¯ä¸æƒ³è¦ï¼Œè€Œæ˜¯åˆ«æŠŠäººç”Ÿå…¨éƒ¨æŠ¼åœ¨ä¸€ä¸ªæŒ‡æ ‡ä¸Šã€‚</strong><br/>
è¿™ç¯‡æ–‡ç« å°±å½“æ˜¯æˆ‘è‡ªå·±çš„æ•´ç†ï¼Œå†™ç»™åŒæ ·åœ¨ IT è¡Œä¸šé‡ŒåŠªåŠ›çš„äººçœ‹ã€‚</p>
<hr/>
<h2 data-id="heading-0">1ï¼‰IT äººçš„ç„¦è™‘ï¼Œå¾ˆå¤šæ—¶å€™ä¸æ˜¯â€œè´ªâ€ï¼Œæ˜¯â€œæ€•â€</h2>
<p>æˆ‘è§è¿‡çš„å¤šæ•°å·¥ç¨‹å¸ˆå¹¶ä¸è´ªã€‚ä»–ä»¬è¦çš„å¾ˆæœ´ç´ ï¼š</p>
<ul>
<li>å·¥èµ„åˆ«å¤ªç¦»è°±åœ°ä½</li>
<li>å·¥ä½œåˆ«éšæ—¶è£å‘˜</li>
<li>æˆ¿è´·ã€å®¶åº­å¼€é”€èƒ½è¦†ç›–</li>
<li>æ‰‹é‡Œæœ‰ç‚¹ä½™é’±ï¼Œèƒ½é¢å¯¹çªå‘æƒ…å†µ</li>
<li>æœªæ¥ä¸¤ä¸‰å¹´ä¸è¦å®Œå…¨é»‘ç®±</li>
</ul>
<p>è¿™äº›éƒ½ç®—ä¸ä¸Šååˆ©å¿ƒé‡ï¼Œæ›´å¤šæ˜¯<strong>å®‰å…¨æ„Ÿéœ€æ±‚</strong>ã€‚</p>
<p>ä½† IT è¡Œä¸šæœ‰ä¸ªå¾ˆç‰¹åˆ«çš„åœ°æ–¹ï¼šå®ƒä¼šä¸æ–­æé†’ä½ â€œä½ éšæ—¶å¯èƒ½ä¸å€¼é’±â€ã€‚</p>
<ul>
<li>æŠ€æœ¯æ›´æ–°å¿«ï¼Œä½ çš„æ ˆå¯èƒ½çªç„¶è¿‡æ—¶</li>
<li>å…¬å¸ä¸šåŠ¡è¯´æ²¡å°±æ²¡ï¼Œç»„ç»‡è°ƒæ•´æ¯”ä½ åŠ ç­è¿˜å¿«</li>
<li>ä½ ç¨å¾®æ¾ä¸€ç‚¹ï¼Œèº«è¾¹çš„äººå°±å¼€å§‹â€œå·æ–°ä¸œè¥¿â€</li>
<li>å¹´é¾„ã€èŒçº§ã€ç»©æ•ˆï¼Œä¼šæŠŠä½ æ¨åˆ°æŸä¸ªä¸å¾—ä¸è¿½çš„è½¨é“ä¸Š</li>
</ul>
<p>æ‰€ä»¥å¾ˆå¤šäººçš„ç„¦è™‘å¹¶ä¸æ˜¯â€œæˆ‘æƒ³èµ¢â€ï¼Œè€Œæ˜¯â€œæˆ‘ä¸æ•¢è¾“â€ã€‚<br/>
ä½ ä¸æ˜¯æƒ³å½“äººä¸Šäººï¼Œä½ åªæ˜¯å®³æ€•è‡ªå·±çªç„¶å¤±å»é€‰æ‹©æƒã€‚</p>
<hr/>
<h2 data-id="heading-1">2ï¼‰â€œæ·¡æ³Šååˆ©â€å¯¹ IT äººæ¥è¯´ï¼Œæ›´åƒæ˜¯ä¸€ç§â€œé™æƒâ€</h2>
<p>æˆ‘ä»¥å‰ä¹Ÿä¼šå¯¹â€œæ·¡æ³Šååˆ©â€è¿™ä¸ªè¯æœ‰æŠµè§¦ã€‚å› ä¸ºå¬èµ·æ¥åƒæ˜¯ï¼š</p>
<ul>
<li>ä½ ä¸åº”è¯¥åœ¨ä¹å·¥èµ„</li>
<li>ä½ ä¸åº”è¯¥åœ¨ä¹æ™‹å‡</li>
<li>ä½ ä¸åº”è¯¥åœ¨ä¹æˆ¿å­</li>
<li>ä½ ä¸åº”è¯¥åœ¨ä¹æ¯”è¾ƒ</li>
</ul>
<p>ä½†ä½ çœŸåœ¨è¿™ä¸ªç¤¾ä¼šé‡Œç”Ÿæ´»ï¼Œæ€ä¹ˆå¯èƒ½ä¸åœ¨ä¹ï¼Ÿ</p>
<p>åæ¥æˆ‘æ…¢æ…¢ç†è§£ï¼Œâ€œæ·¡æ³Šâ€æœ€å¯è¡Œçš„ç‰ˆæœ¬ï¼Œå…¶å®ä¸æ˜¯â€œæ¸…é›¶â€ï¼Œè€Œæ˜¯<strong>é™æƒ</strong>ï¼š</p>
<ul>
<li>å·¥èµ„é‡è¦ï¼Œä½†ä¸æ˜¯å”¯ä¸€çš„è‡ªæˆ‘è¯æ˜</li>
<li>æ™‹å‡é‡è¦ï¼Œä½†ä¸ä»£è¡¨æˆ‘å¿…é¡»ç‰ºç‰²å¥åº·ã€å…³ç³»ã€äººæ ¼</li>
<li>ä¹°æˆ¿é‡è¦ï¼Œä½†ä¸æ„å‘³ç€æˆ‘ä¹‹ååªèƒ½å½“ä¸€ä¸ªâ€œè¿˜è´·æœºå™¨â€</li>
<li>å¤–ç•Œè¯„ä»·é‡è¦ï¼Œä½†ä¸èƒ½æˆä¸ºæˆ‘æ¯å¤©é†’æ¥çš„å”¯ä¸€é©±åŠ¨åŠ›</li>
</ul>
<p>æ›´åƒæ˜¯ä½ åœ¨åšç³»ç»Ÿè®¾è®¡ï¼š<br/>
ååˆ©æ˜¯ä¸€ä¸ªä¿¡å·ï¼Œä½†ä¸èƒ½è®©å®ƒå˜æˆâ€œå•ç‚¹æ•…éšœâ€ã€‚<br/>
å¦‚æœä½ çš„äººç”Ÿåªé ä¸€ä¸ªæŒ‡æ ‡é©±åŠ¨ï¼Œé‚£ä¸€æ—¦æŒ‡æ ‡å´©äº†ï¼Œä½ æ•´ä¸ªäººä¹Ÿä¼šå´©ã€‚</p>
<hr/>
<h2 data-id="heading-2">3ï¼‰IT è¡Œä¸šçš„â€œç”Ÿæ´»ç„¦è™‘â€ï¼Œæœ‰ä¸ªéšè”½çš„æ¥æºï¼šæ¯”è¾ƒæœºåˆ¶</h2>
<p>IT äººç‰¹åˆ«å®¹æ˜“æ‰è¿›ä¸€ç§å±€é¢ï¼š<br/>
<strong>ä½ æ°¸è¿œçŸ¥é“æœ‰äººæ¯”ä½ æ›´å¼ºã€æ›´å¿«ã€æ›´æœ‰é’±ã€‚</strong></p>
<p>ä»¥å‰æ¯”è¾ƒåªå‘ç”Ÿåœ¨å…¬å¸å†…éƒ¨ï¼Œç°åœ¨æ¯”è¾ƒå‘ç”Ÿåœ¨å…¨ç½‘ï¼š</p>
<ul>
<li>åˆ«äºº 30 å²ä¸Šæ¶æ„å¸ˆã€å¹´åŒ…ç¿»å€</li>
<li>åˆ«äººåšå‰¯ä¸šã€åšè¯¾ç¨‹ã€åšå¼€æºã€åšè‡ªåª’ä½“</li>
<li>åˆ«äººè·³æ§½æ¶¨è–ªã€æ‹¿æœŸæƒã€ç§»æ°‘ã€ä¹°æˆ¿</li>
<li>åˆ«äººç”¨ AI ç”Ÿäº§åŠ›èµ·é£ï¼Œä½ è¿˜åœ¨å†™é‡å¤ CRUD</li>
</ul>
<p>ä½ ä¼šå‘ç°æ¯”è¾ƒæ˜¯æ— ç©·æ— å°½çš„ï¼Œå®ƒä¸åƒä¸€ä¸ªé¡¹ç›®èƒ½éªŒæ”¶ã€‚<br/>
ä½ ä»Šå¤©èµ¢ä¸€æ¬¡ï¼Œæ˜å¤©ä¼šçœ‹åˆ°æ›´å¤¸å¼ çš„ä¾‹å­ã€‚<br/>
äºæ˜¯ç„¦è™‘å˜æˆä¸€ç§å¸¸æ€èƒŒæ™¯éŸ³ï¼šä¸æ˜¯å‘ç”Ÿäº†ä»€ä¹ˆï¼Œè€Œæ˜¯ä½ ä¸€ç›´è§‰å¾—â€œä¼šå‘ç”Ÿä»€ä¹ˆâ€ã€‚</p>
<p>è¿™å°±æ˜¯â€œç”Ÿæ´»ç„¦è™‘â€çš„æ ¸å¿ƒï¼š<strong>ä¸æ˜¯ä½ ç°åœ¨è¿‡å¾—å·®ï¼Œè€Œæ˜¯ä½ ä¸ç¡®å®šä½ èƒ½ä¸èƒ½ä¸€ç›´ç¨³ä¸‹å»ã€‚</strong></p>
<hr/>
<h2 data-id="heading-3">4ï¼‰æˆ‘è§‰å¾—æœ€éš¾çš„ç‚¹æ˜¯ï¼šæˆ‘ä»¬æŠŠâ€œè‡ªæˆ‘ä»·å€¼â€å¤–åŒ…ç»™äº†ç»“æœ</h2>
<p>å¾ˆå¤š IT äººçš„è‡ªæˆ‘ä»·å€¼æ„Ÿï¼Œæ¥è‡ªå¯é‡åŒ–çš„ä¸œè¥¿ï¼š</p>
<ul>
<li>ä»£ç å†™å¾—å¿«ã€bug å°‘</li>
<li>ç»©æ•ˆå¥½ã€æ™‹å‡å¿«</li>
<li>å·¥èµ„é«˜ã€title å¤§</li>
<li>é¡¹ç›®ä¸Šçº¿ã€æŒ‡æ ‡å¢é•¿</li>
</ul>
<p>è¿™äº›ä¸œè¥¿å½“ç„¶é‡è¦ã€‚ä½†å±é™©åœ¨äºï¼š<br/>
å½“ä½ æŠŠè‡ªæˆ‘ä»·å€¼å®Œå…¨ç»‘å®šåœ¨è¿™äº›ç»“æœä¸Šï¼Œä½ ä¼šå˜å¾—è¶Šæ¥è¶Šè„†ã€‚</p>
<p>å› ä¸ºç»“æœä¸å®Œå…¨ç”±ä½ æ§åˆ¶ï¼š</p>
<ul>
<li>é¡¹ç›®æˆè´¥æœ‰è¿æ°”å’Œç»„ç»‡å› ç´ </li>
<li>æ™‹å‡æœ‰åé¢ã€æœ‰æ”¿æ²»ã€æœ‰æ—¶æœº</li>
<li>è¡Œä¸šå‘¨æœŸæœ‰èµ·æœ‰è½</li>
<li>ä½ å†å¼ºä¹Ÿå¯èƒ½é‡åˆ°â€œä¸šåŠ¡ä¸è¡Œâ€</li>
</ul>
<p>ä¸€æ—¦ä½ æŠŠä»·å€¼äº¤ç»™å¤–ç•Œè£å†³ï¼Œä½ å°±ä¼šä¸€ç›´ç´§å¼ ï¼š<br/>
æˆ‘æ˜¯ä¸æ˜¯è¿˜å¤Ÿç”¨ï¼Ÿæˆ‘æ˜¯ä¸æ˜¯è¿˜å€¼é’±ï¼Ÿæˆ‘æ˜¯ä¸æ˜¯å¿«è¢«æ›¿ä»£ï¼Ÿ</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¾ˆå¤šäººâ€œèµšåˆ°äº†é’±â€ä¾æ—§ç„¦è™‘ã€‚<br/>
ç„¦è™‘ä¸æ˜¯é’±ä¸å¤Ÿï¼Œè€Œæ˜¯ä½ æ²¡æœ‰å»ºç«‹ä¸€ä¸ªæ›´ç¨³å®šçš„ä»·å€¼æ¥æºã€‚</p>
<hr/>
<h2 data-id="heading-4">5ï¼‰é‚£æ€ä¹ˆåšæ‰ä¸ç©ºæ´ï¼Ÿæˆ‘è§‰å¾—æ˜¯åšå‡ ä»¶â€œå°è€Œç¨³â€çš„äº‹</h2>
<p>æˆ‘ä¸å¤ªä¿¡é‚£ç§ä¸€æŠŠæ¢­å“ˆçš„â€œäººç”Ÿç¿»ç›˜â€ã€‚<br/>
IT è¡Œä¸šå·²ç»å¤Ÿé«˜æ³¢åŠ¨äº†ï¼Œå†æŠŠç”Ÿæ´»å˜æˆèµŒåšï¼Œåè€Œæ›´è€—ã€‚</p>
<p>æˆ‘æ›´è®¤å¯ä¸€ç§â€œå·¥ç¨‹åŒ–â€çš„æ€è·¯ï¼š<br/>
<strong>ä¸è¿½æ±‚ä¸€æ¬¡æ€§æ”¹å˜å‘½è¿ï¼Œè€Œæ˜¯æŒç»­ç»™ç³»ç»ŸåŠ ç¨³å®šæ€§ã€‚</strong></p>
<h3 data-id="heading-5">ï¼ˆ1ï¼‰æŠŠæˆåŠŸå®šä¹‰æˆå¤šæŒ‡æ ‡ï¼Œè€Œä¸æ˜¯å¹´åŒ…ä¸€ä¸ªæ•°å­—</h3>
<p>é™¤äº†è–ªèµ„ï¼Œä½ å¯ä»¥ç»™è‡ªå·±åŠ å‡ ä¸ªæŒ‡æ ‡ï¼š</p>
<ul>
<li>èº«ä½“çŠ¶æ€æ˜¯å¦å¯æŒç»­ï¼ˆç¡çœ ã€ä½“åŠ›ã€ç²¾ç¥ï¼‰</li>
<li>ç°é‡‘æµæ˜¯å¦æ›´ç¨³ï¼ˆå‚¨è“„ã€è´Ÿå€ºç»“æ„ï¼‰</li>
<li>æŠ€èƒ½æ˜¯å¦æ›´å¯è¿ç§»ï¼ˆæ¢å…¬å¸ä¹Ÿèƒ½ç”¨ï¼‰</li>
<li>æ—¶é—´æ˜¯å¦æœ‰å›æ”¶ï¼ˆä¸è¢«æ— æ„ä¹‰åŠ ç­åæ‰ï¼‰</li>
<li>å…³ç³»æ˜¯å¦ä¸å´©ï¼ˆå®¶åº­ã€æœ‹å‹ã€ä¼´ä¾£ï¼‰</li>
</ul>
<p>ä½ ä¼šå‘ç°ä¸€æ—¦æŒ‡æ ‡å˜å¤šï¼Œä½ çš„å¿ƒä¼šæ›´ç¨³ã€‚<br/>
å› ä¸ºä½ ä¸ä¼šè¢«â€œå•ç‚¹å¤±è´¥â€å‡»ç©¿ã€‚</p>
<h3 data-id="heading-6">ï¼ˆ2ï¼‰å»ºç«‹â€œæœ€å°å®‰å…¨å«â€ï¼Œå®ƒæ¯”å¿ƒç†å®‰æ…°æœ‰ç”¨</h3>
<p>å¾ˆå¤šç„¦è™‘æ¥è‡ªâ€œæ€•çªç„¶å‡ºäº‹â€ã€‚</p>
<ul>
<li>æ‰‹é‡Œæœ‰ 3â€“6 ä¸ªæœˆçš„ç”Ÿæ´»è´¹å‚¨å¤‡ï¼ˆå“ªæ€•æ…¢æ…¢æ”’ï¼‰</li>
<li>é¿å…é«˜æ¯è´Ÿå€ºå’Œå†²åŠ¨æ¶ˆè´¹</li>
<li>ç»™è‡ªå·±ç•™ä¸€ä¸ªéšæ—¶èƒ½å›åˆ°å¸‚åœºçš„â€œåŸºç¡€æŠ€èƒ½åŒ…â€</li>
</ul>
<p>å®‰å…¨å«ä¸æ˜¯ä¸ºäº†è®©ä½ èººå¹³ï¼Œæ˜¯ä¸ºäº†è®©ä½ åœ¨å…³é”®æ—¶åˆ»ä¸è¢«è¿«åšé€‰æ‹©ã€‚</p>
<h3 data-id="heading-7">ï¼ˆ3ï¼‰æŠ€èƒ½ä¸Šä¼˜å…ˆæŠ•â€œå¯è¿ç§»èƒ½åŠ›â€</h3>
<p>æˆ‘ä¸ªäººçš„æ’åºå¤§æ¦‚æ˜¯ï¼š</p>
<ul>
<li>è¡¨è¾¾ä¸å†™ä½œï¼šèƒ½æŠŠé—®é¢˜è®²æ¸…æ¥šã€æŠŠæ–¹æ¡ˆè¯´æ˜ç™½</li>
<li>ç»“æ„åŒ–æ€ç»´ï¼šèƒ½æ‹†è§£é—®é¢˜ã€å¤ç›˜ã€æ²‰æ·€</li>
<li>å·¥ç¨‹èƒ½åŠ›ï¼šèƒ½æŠŠä¸œè¥¿åšå‡ºæ¥ã€è·‘èµ·æ¥ã€ç¨³å®šèµ·æ¥</li>
<li>åä½œæ¨è¿›ï¼šèƒ½æŠŠäº‹æƒ…æ¨è¿‡å»ï¼Œè€Œä¸æ˜¯åªå†™ä»£ç </li>
</ul>
<p>è¿™äº›ä¸œè¥¿ä¸ä¼šå› ä¸ºæŸä¸ªæ¡†æ¶é€€æ½®è€Œå¤±æ•ˆã€‚</p>
<h3 data-id="heading-8">ï¼ˆ4ï¼‰å‡å°‘â€œæ¯”è¾ƒè¾“å…¥â€ï¼Œä¸æ˜¯è¿œç¦»ä¸–ç•Œï¼Œæ˜¯ç®¡ç†æ³¨æ„åŠ›</h3>
<p>æˆ‘è§è¿‡å¤ªå¤šäººä¸æ˜¯è¢«ç°å®æ‰“å®ï¼Œæ˜¯è¢«ä¿¡æ¯æ‰“å®ã€‚</p>
<p>ä½ å¯ä»¥è¯•è¯•ï¼š</p>
<ul>
<li>æŠŠç¤¾åª’å½“å·¥å…·ï¼Œä¸å½“ç”Ÿæ´»</li>
<li>è§„å®šè¾“å…¥æ—¶é—´ï¼Œåˆ«è®©ä¿¡æ¯éšæ—¶æ’é˜Ÿ</li>
<li>å°‘åˆ·æˆåŠŸå­¦ï¼Œå¤šçœ‹å¯å¤ç”¨æ–¹æ³•è®º</li>
</ul>
<p>æ³¨æ„åŠ›å°±æ˜¯ä½ çš„â€œèƒ½é‡é¢„ç®—â€ï¼ŒIT äººå°¤å…¶éœ€è¦æŠŠå®ƒå®ˆä½ã€‚</p>
<h3 data-id="heading-9">ï¼ˆ5ï¼‰æ¯å¤©ç•™ä¸€ç‚¹â€œæœ€å°è‡ªæˆ‘ç©ºé—´â€</h3>
<p>æˆ‘è§‰å¾—è¿™ä»¶äº‹ç‰¹åˆ«å…³é”®ã€‚</p>
<p>å“ªæ€•æ¯å¤© 15 åˆ†é’Ÿï¼š</p>
<ul>
<li>è¯»ä¸€ç‚¹</li>
<li>å†™å‡ å¥</li>
<li>è¿åŠ¨ä¸€ä¸‹</li>
<li>å­¦ä¸€ä¸ªå°ç‚¹</li>
<li>åšä¸€ä»¶çº¯ç²¹å±äºè‡ªå·±çš„äº‹</li>
</ul>
<p>å®ƒçš„æ„ä¹‰ä¸æ˜¯æå‡æ•ˆç‡ï¼Œè€Œæ˜¯å‘Šè¯‰è‡ªå·±ï¼š<br/>
<strong>æˆ‘ä¸æ˜¯ä¸€ä¸ªåªä¸ºç»©æ•ˆå’Œè´¦å•æ´»ç€çš„å·¥å…·ã€‚</strong></p>
<hr/>
<h2 data-id="heading-10">6ï¼‰æœ€åï¼šæ·¡æ³Šååˆ©ï¼Œä¸æ˜¯èººå¹³ï¼Œè€Œæ˜¯åˆ«è¢«ç‰µç€èµ°</h2>
<p>æˆ‘ç°åœ¨è¶Šæ¥è¶Šè§‰å¾—ï¼Œæ·¡æ³Šååˆ©å¯¹ IT äººæ¥è¯´ï¼Œä¸æ˜¯ä¸€ç§é“å¾·å§¿æ€ï¼Œè€Œæ˜¯ä¸€ç§ç”Ÿå­˜ç­–ç•¥ã€‚</p>
<p>ä½ å¯ä»¥åŠªåŠ›ã€å¯ä»¥ä¸Šè¿›ã€å¯ä»¥è¿½æ±‚æ›´å¥½ã€‚<br/>
ä½†ä½ ä¸å¿…æŠŠäººç”Ÿçš„å…¨éƒ¨æ„ä¹‰æŠ¼åœ¨â€œæ›´é«˜çš„å·¥èµ„ã€æ›´å¤§çš„ titleã€æ›´å¼ºçš„æ¯”è¾ƒâ€ä¸Šã€‚</p>
<p>è¡Œä¸šä¼šæ³¢åŠ¨ï¼ŒæŠ€æœ¯ä¼šæ›´æ–°ï¼Œç»„ç»‡ä¼šå˜åŠ¨ã€‚<br/>
çœŸæ­£èƒ½è®©ä½ ä¸é‚£ä¹ˆç„¦è™‘çš„ï¼Œå¾€å¾€ä¸æ˜¯æŸæ¬¡æˆåŠŸï¼Œè€Œæ˜¯ä½ ç»™è‡ªå·±æ­äº†ä¸€ä¸ªæ›´ç¨³å®šçš„ç³»ç»Ÿï¼š</p>
<ul>
<li>æœ‰ä¸€ç‚¹å®‰å…¨å«</li>
<li>æœ‰ä¸€ç‚¹å¯è¿ç§»èƒ½åŠ›</li>
<li>æœ‰ä¸€ç‚¹ç”Ÿæ´»çš„æŒæ§æ„Ÿ</li>
<li>æœ‰ä¸€ç‚¹å±äºè‡ªå·±çš„ç©ºé—´</li>
</ul>
<p>å¦‚æœä½ ä¹Ÿæ­£è¢«ç„¦è™‘è¿½ç€è·‘ï¼Œæˆ‘æƒ³è¯´ä¸€å¥æ›´ç°å®çš„è¯ï¼š<br/>
<strong>ä½ ä¸æ˜¯â€œçœ‹ä¸å¼€â€ï¼Œä½ åªæ˜¯èƒŒè´Ÿäº†å¤ªå¤šä¸ç¡®å®šã€‚</strong><br/>
è€Œä½ èƒ½åšçš„ï¼Œæ˜¯ä¸€ç‚¹ç‚¹æŠŠä¸ç¡®å®šå˜æˆå¯æ§ï¼ŒæŠŠååˆ©ä»â€œä¸»å®°â€å˜æˆâ€œå‚è€ƒâ€ã€‚</p>
<p>è¿™å°±å·²ç»å¾ˆä¸å®¹æ˜“äº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€ç§åŸºäº SQLite3 çš„åŠè‡ªåŠ¨ C++ ORM å®ç°]]></title>    <link>https://juejin.cn/post/7587299443644645439</link>    <guid>https://juejin.cn/post/7587299443644645439</guid>    <pubDate>2025-12-25T00:59:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587299443644645439" data-draft-id="7587299443644629055" data-original-type="2" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€ç§åŸºäº SQLite3 çš„åŠè‡ªåŠ¨ C++ ORM å®ç°"/> <meta itemprop="keywords" content="C++"/> <meta itemprop="datePublished" content="2025-12-25T00:59:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="charlee44"/> <meta itemprop="url" content="https://juejin.cn/user/1117549770846872"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€ç§åŸºäº SQLite3 çš„åŠè‡ªåŠ¨ C++ ORM å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1117549770846872/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    charlee44
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T00:59:29.000Z" title="Thu Dec 25 2025 00:59:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. å¼•è¨€</h2>
<p>åœ¨ç°ä»£è½¯ä»¶å¼€å‘ä¸­ï¼Œå°¤å…¶æ˜¯åœ¨åç«¯ç³»ç»Ÿä¸æ•°æ®åº“äº¤äº’çš„åœºæ™¯ä¸‹ï¼Œå¯¹è±¡å…³ç³»æ˜ å°„ï¼ˆObject-Relational Mapping, ORMï¼‰å·²æˆä¸ºä¸€ç§ä¸»æµçš„è®¾è®¡èŒƒå¼ã€‚ORM çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†ç¨‹åºä¸­çš„å¯¹è±¡æ¨¡å‹ä¸å…³ç³»å‹æ•°æ®åº“ä¸­çš„è¡¨ç»“æ„è¿›è¡Œæ˜ å°„ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿä»¥é¢å‘å¯¹è±¡çš„æ–¹å¼æ“ä½œæ•°æ®ï¼Œè€Œæ— éœ€ç›´æ¥ç¼–å†™ç¹çä¸”æ˜“é”™çš„ SQL è¯­å¥ã€‚è¿™ç§æŠ½è±¡ä¸ä»…æ˜¾è‘—æå‡äº†å¼€å‘æ•ˆç‡ï¼Œä¹Ÿå¢å¼ºäº†ä»£ç çš„å¯ç»´æŠ¤æ€§ä¸å¯ç§»æ¤æ€§ã€‚</p>
<p>å°½ç®¡åœ¨å¯¹æ€§èƒ½æˆ–æ§åˆ¶åŠ›è¦æ±‚æé«˜çš„åœºæ™¯ä¸­åŸç”Ÿ SQL ä»ä¸å¯æ›¿ä»£ï¼Œä½†åœ¨å¤§å¤šæ•°å¸¸è§„ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„ ORM å±‚èƒ½æœ‰æ•ˆç®€åŒ–æ•°æ®æŒä¹…åŒ–çš„å®ç°ã€‚</p>
<p>ç„¶è€Œï¼Œç”±äº C/C++ æ˜¯åº•å±‚ç³»ç»Ÿçº§è¯­è¨€ï¼Œç¼ºä¹è¿è¡Œæ—¶åå°„ã€æ³›å‹æ“¦é™¤ç­‰é«˜çº§ç‰¹æ€§ï¼Œè¦å®ç°ä¸€ä¸ªå…¨è‡ªåŠ¨ã€åŠŸèƒ½å®Œå¤‡çš„ ORM æ¡†æ¶ï¼ˆå¦‚ Java çš„ Hibernate æˆ– Python çš„ SQLAlchemyï¼‰æä¸ºå¤æ‚ï¼Œç”šè‡³å¾—ä¸å¿å¤±ã€‚å› æ­¤ï¼Œæœ¬æ–‡æå‡ºä¸€ç§åŠè‡ªåŠ¨çš„ ORM é£æ ¼å°è£…ï¼šå®ƒå€Ÿé‰´ä¸€äº›å…¸å‹ ORM çš„è®¾è®¡æ€æƒ³ï¼Œä½†ä¸è¿½æ±‚å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œè€Œæ˜¯é€šè¿‡åˆç†çš„æ¨¡æ¿ã€æšä¸¾å’Œå·¥å…·å‡½æ•°ï¼Œåœ¨ä¿æŒè½»é‡ä¸å¯æ§çš„å‰æä¸‹ï¼Œæä¾›æ¥è¿‘ ORM çš„å¼€å‘ä½“éªŒã€‚</p>
<h2 data-id="heading-1">2. å®ç°</h2>
<p>ä¸å¿…è¢« ORM ç­‰çœ‹ä¼¼å¤æ‚çš„æ¦‚å¿µæ‰€å“é€€ã€‚ä»åº•å±‚è§†è§’å‡ºå‘ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼šè®¸å¤šé«˜çº§è®¾è®¡èŒƒå¼æœ¬è´¨ä¸Šæ˜¯å¯¹åº•å±‚é‡å¤ã€åˆ†æ•£æˆ–å†—ä½™ä»£ç çš„å°è£…ä¸æŠ½è±¡â€”â€”æ¯”å¦‚ä¸ºäº†è§£å†³ SQL æ¨¡æ¿é‡å¤ã€æ•°æ®æ˜ å°„é€»è¾‘ä¸å†…èšç­‰é—®é¢˜ã€‚</p>
<p>ä»¥å¸¸è§çš„ä¸šåŠ¡å¼€å‘ä¸ºä¾‹ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¯¹æ•°æ®åº“æ‰§è¡Œ CRUD æ“ä½œï¼ˆå³ Create åˆ›å»ºã€Retrieve æŸ¥è¯¢ã€Update æ›´æ–°ã€Delete åˆ é™¤ï¼‰ã€‚è¿™äº›æ“ä½œåœ¨ä¸åŒæ•°æ®è¡¨ä¸Šåå¤å‡ºç°ï¼Œä»£ç ç»“æ„é«˜åº¦ç›¸ä¼¼ï¼Œå´å¾€å¾€è¢«ä¸€ééæ‰‹å†™ã€‚é‚£ä¹ˆï¼Œæ˜¯å¦æœ‰å¯èƒ½å°†è¿™äº›é‡å¤é€»è¾‘æç‚¼å‡ºæ¥ï¼Œä»…é€šè¿‡ç»Ÿä¸€çš„å››ä¸ªæ¥å£ï¼Œå°±èƒ½æ»¡è¶³æ‰€æœ‰å®ä½“çš„ CRUD éœ€æ±‚ï¼Ÿè¿™æ­£æ˜¯è½»é‡çº§ ORM å°è¯•å›ç­”çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-2">2.1 å­—æ®µå€¼</h3>
<p>å…ˆæ¥çœ‹çœ‹ä»¥ä¸‹ä»£ç å°è£…çš„å››ä¸ª CRUD æ¥å£ï¼š<code>InsertRow</code>ã€<code>DeleteRow</code>ã€<code>UpdateRow</code> ä»¥åŠ <code>QueryRows</code>ã€‚</p>
<p><strong>Sqlite3Crud.h</strong>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">pragma</span> once</span>&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span>&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;variant&gt;</span></span>&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span>&#13;
&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"TableName.h"</span></span>&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"Util/Statement.hpp"</span></span>&#13;
&#13;
<span class="hljs-keyword">namespace</span> Persistence {&#13;
&#13;
<span class="hljs-comment">/// @brief Sqlite3æ•°æ®åº“å°è£…ç±»</span>&#13;
<span class="hljs-keyword">namespace</span> Sqlite3Crud {&#13;
&#13;
<span class="hljs-keyword">using</span> TableValue = std::variant&lt;std::monostate, std::string, <span class="hljs-type">int64_t</span>&gt;;  <span class="hljs-comment">//è¡¨çš„å€¼</span>&#13;
&#13;
<span class="hljs-comment">//æ•°æ®åº“è¡¨æ’å…¥è®°å½•çš„æŠ½è±¡æ–¹æ³•</span>&#13;
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">InsertRow</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *sql, <span class="hljs-type">const</span> std::vector&lt;TableValue&gt; &amp;params)</span></span>;&#13;
&#13;
<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> Field&gt;&#13;
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">Insert</span><span class="hljs-params">(TableName tableName, <span class="hljs-type">const</span> std::vector&lt;Field&gt; &amp;fieldNames,&#13;
            <span class="hljs-type">const</span> std::vector&lt;Sqlite3Crud::TableValue&gt; &amp;fieldValues)</span> </span>{&#13;
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">InsertRow</span>(Util::Statement::<span class="hljs-built_in">Insert</span>(tableName, fieldNames).<span class="hljs-built_in">c_str</span>(),&#13;
                   fieldValues);&#13;
}&#13;
&#13;
<span class="hljs-comment">//æ•°æ®åº“è¡¨åˆ é™¤è®°å½•çš„æŠ½è±¡æ–¹æ³•</span>&#13;
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">DeleteRow</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *sql, <span class="hljs-type">const</span> TableValue &amp;bindParam)</span></span>;&#13;
&#13;
<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> Field&gt;&#13;
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">Delete</span><span class="hljs-params">(TableName tableName, <span class="hljs-type">const</span> Field &amp;fieldName,&#13;
            <span class="hljs-type">const</span> TableValue &amp;bindParam)</span> </span>{&#13;
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">DeleteRow</span>(Util::Statement::<span class="hljs-built_in">Delete</span>(tableName, fieldName).<span class="hljs-built_in">c_str</span>(),&#13;
                   bindParam);&#13;
}&#13;
&#13;
<span class="hljs-comment">//æ•°æ®åº“è¡¨æ›´æ–°è®°å½•çš„æŠ½è±¡æ–¹æ³•</span>&#13;
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">UpdateRow</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *sql, <span class="hljs-type">const</span> std::vector&lt;TableValue&gt; &amp;bindParams)</span></span>;&#13;
&#13;
<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> Field&gt;&#13;
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">Update</span><span class="hljs-params">(TableName tableName, <span class="hljs-type">const</span> std::vector&lt;Field&gt; &amp;fieldNames,&#13;
            <span class="hljs-type">const</span> std::vector&lt;Sqlite3Crud::TableValue&gt; &amp;fieldValues)</span> </span>{&#13;
  <span class="hljs-keyword">return</span> Sqlite3Crud::<span class="hljs-built_in">UpdateRow</span>(&#13;
      Util::Statement::<span class="hljs-built_in">Update</span>(tableName, fieldNames).<span class="hljs-built_in">c_str</span>(), fieldValues);&#13;
}&#13;
&#13;
<span class="hljs-comment">//æ•°æ®åº“è¡¨æŸ¥è¯¢è®°å½•çš„æŠ½è±¡æ–¹æ³•</span>&#13;
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">QueryRows</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *sql, std::vector&lt;TableValue&gt; &amp;result,&#13;
               <span class="hljs-type">const</span> std::vector&lt;TableValue&gt; &amp;bindParams = {})</span></span>;&#13;
&#13;
<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> Field&gt;&#13;
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">Query</span><span class="hljs-params">(&#13;
    TableName tableName, <span class="hljs-type">const</span> std::vector&lt;Field&gt; &amp;fieldNames,&#13;
    std::vector&lt;TableValue&gt; &amp;result, <span class="hljs-type">const</span> std::vector&lt;Field&gt; &amp;whereFields = {},&#13;
    <span class="hljs-type">const</span> std::vector&lt;TableValue&gt; &amp;whereBindParams = {},&#13;
    std::optional&lt;Field&gt; orderByField = std::<span class="hljs-literal">nullopt</span>,&#13;
    std::optional&lt;Util::Statement::OrderByValue&gt; orderByValue = std::<span class="hljs-literal">nullopt</span>)</span> </span>{&#13;
  <span class="hljs-keyword">if</span> (whereFields.<span class="hljs-built_in">size</span>() != whereBindParams.<span class="hljs-built_in">size</span>()) {&#13;
    <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">invalid_argument</span>(<span class="hljs-string">"whereFields å’Œ whereBindParams æ•°é‡ä¸åŒ¹é…ï¼"</span>);&#13;
  }&#13;
  <span class="hljs-type">const</span> std::string &amp;statement = Util::Statement::<span class="hljs-built_in">Query</span>(&#13;
      tableName, fieldNames, whereFields, orderByField, orderByValue);&#13;
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">QueryRows</span>(statement.<span class="hljs-built_in">c_str</span>(), result, whereBindParams);&#13;
}&#13;
&#13;
};  <span class="hljs-comment">// namespace Sqlite3Crud</span>&#13;
&#13;
}  <span class="hljs-comment">// namespace Persistence</span>
</code></pre>
<p><strong>Sqlite3Crud.cpp</strong>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"Sqlite3Crud.h"</span></span>&#13;
&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sqlite3.h&gt;</span></span>&#13;
&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>&#13;
&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"Bootstrap/App.h"</span></span>&#13;
&#13;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;&#13;
&#13;
<span class="hljs-keyword">namespace</span> Persistence {&#13;
&#13;
<span class="hljs-keyword">namespace</span> Sqlite3Crud {&#13;
&#13;
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">InsertRow</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *sql, <span class="hljs-type">const</span> std::vector&lt;TableValue&gt; &amp;params)</span> </span>{&#13;
  sqlite3 *db = App::<span class="hljs-built_in">GetInstance</span>().<span class="hljs-built_in">Db</span>();&#13;
&#13;
  <span class="hljs-comment">// å‡†å¤‡ SQL è¯­å¥</span>&#13;
  sqlite3_stmt *stmt;&#13;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_prepare_v2</span>(db, sql, <span class="hljs-number">-1</span>, &amp;stmt, <span class="hljs-literal">nullptr</span>) != SQLITE_OK) {&#13;
    std::cerr &lt;&lt; (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(<span class="hljs-string">u8"SQLå‡†å¤‡è¯­å¥å¤±è´¥ï¼š"</span>) &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db)&#13;
              &lt;&lt; std::endl;&#13;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
  }&#13;
&#13;
  <span class="hljs-comment">// ç»‘å®šå‚æ•°</span>&#13;
  <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> si = <span class="hljs-number">0</span>; si &lt; params.<span class="hljs-built_in">size</span>(); ++si) {&#13;
    <span class="hljs-type">int</span> bindId = (<span class="hljs-type">int</span>)(si + <span class="hljs-number">1</span>);&#13;
&#13;
    <span class="hljs-comment">// ä½¿ç”¨ std::holds_alternative æ£€æŸ¥å½“å‰æ˜¯å¦å­˜å‚¨äº†æŒ‡å®šç±»å‹çš„å€¼</span>&#13;
    <span class="hljs-keyword">if</span> (std::<span class="hljs-built_in">holds_alternative</span>&lt;std::string&gt;(params[si])) {&#13;
      <span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;param = std::<span class="hljs-built_in">get</span>&lt;std::string&gt;(params[si]);&#13;
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_bind_text</span>(stmt, bindId, param.<span class="hljs-built_in">c_str</span>(), <span class="hljs-number">-1</span>, SQLITE_STATIC) !=&#13;
          SQLITE_OK) {&#13;
        std::cerr &lt;&lt; (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(<span class="hljs-string">u8"ç»‘å®šé”™è¯¯: "</span>) &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db)&#13;
                  &lt;&lt; std::endl;&#13;
        <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
      }&#13;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (std::<span class="hljs-built_in">holds_alternative</span>&lt;<span class="hljs-type">int64_t</span>&gt;(params[si])) {&#13;
      <span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;param = std::<span class="hljs-built_in">get</span>&lt;<span class="hljs-type">int64_t</span>&gt;(params[si]);&#13;
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_bind_int64</span>(stmt, bindId, param) != SQLITE_OK) {&#13;
        std::cerr &lt;&lt; (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(<span class="hljs-string">u8"ç»‘å®šé”™è¯¯: "</span>) &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db)&#13;
                  &lt;&lt; std::endl;&#13;
        <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
      }&#13;
    } <span class="hljs-keyword">else</span> {&#13;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
    }&#13;
  }&#13;
&#13;
  <span class="hljs-comment">// æ‰§è¡Œæ’å…¥è¯­å¥</span>&#13;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_step</span>(stmt) != SQLITE_DONE) {&#13;
    std::cerr &lt;&lt; (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(<span class="hljs-string">u8"æ‰§è¡Œå¤±è´¥: "</span>) &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db)&#13;
              &lt;&lt; std::endl;&#13;
    <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
  }&#13;
&#13;
  <span class="hljs-built_in">sqlite3_finalize</span>(stmt);  <span class="hljs-comment">// é‡Šæ”¾SQLè¯­å¥å¯¹è±¡</span>&#13;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;&#13;
}&#13;
&#13;
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">DeleteRow</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *sql, <span class="hljs-type">const</span> TableValue &amp;bindParam)</span> </span>{&#13;
  sqlite3 *db = App::<span class="hljs-built_in">GetInstance</span>().<span class="hljs-built_in">Db</span>();&#13;
&#13;
  <span class="hljs-comment">// å‡†å¤‡ SQL è¯­å¥</span>&#13;
  sqlite3_stmt *stmt;&#13;
  <span class="hljs-type">int</span> exit = <span class="hljs-built_in">sqlite3_prepare_v2</span>(db, sql, <span class="hljs-number">-1</span>, &amp;stmt, <span class="hljs-literal">nullptr</span>);&#13;
  <span class="hljs-keyword">if</span> (exit != SQLITE_OK) {&#13;
    std::cerr &lt;&lt; (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(<span class="hljs-string">u8"SQLå‡†å¤‡è¯­å¥å¤±è´¥ï¼š"</span>) &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db)&#13;
              &lt;&lt; std::endl;&#13;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
  }&#13;
&#13;
  <span class="hljs-comment">// ç»‘å®šå‚æ•°</span>&#13;
  <span class="hljs-keyword">if</span> (std::<span class="hljs-built_in">holds_alternative</span>&lt;std::string&gt;(bindParam)) {&#13;
    <span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;param = std::<span class="hljs-built_in">get</span>&lt;std::string&gt;(bindParam);&#13;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_bind_text</span>(stmt, <span class="hljs-number">1</span>, param.<span class="hljs-built_in">c_str</span>(), <span class="hljs-number">-1</span>, SQLITE_STATIC) !=&#13;
        SQLITE_OK) {&#13;
      std::cerr &lt;&lt; (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(<span class="hljs-string">u8"ç»‘å®šé”™è¯¯: "</span>) &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db)&#13;
                &lt;&lt; std::endl;&#13;
      <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
    }&#13;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (std::<span class="hljs-built_in">holds_alternative</span>&lt;<span class="hljs-type">int64_t</span>&gt;(bindParam)) {&#13;
    <span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;param = std::<span class="hljs-built_in">get</span>&lt;<span class="hljs-type">int64_t</span>&gt;(bindParam);&#13;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_bind_int64</span>(stmt, <span class="hljs-number">1</span>, param) != SQLITE_OK) {&#13;
      std::cerr &lt;&lt; (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(<span class="hljs-string">u8"ç»‘å®šé”™è¯¯: "</span>) &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db)&#13;
                &lt;&lt; std::endl;&#13;
      <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
    }&#13;
  }&#13;
&#13;
  <span class="hljs-comment">// æ‰§è¡Œè¯­å¥</span>&#13;
  exit = <span class="hljs-built_in">sqlite3_step</span>(stmt);&#13;
  <span class="hljs-keyword">if</span> (exit != SQLITE_DONE) {&#13;
    std::cerr &lt;&lt; (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(<span class="hljs-string">u8"æ‰§è¡Œå¤±è´¥: "</span>) &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db)&#13;
              &lt;&lt; std::endl;&#13;
    <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
  }&#13;
&#13;
  <span class="hljs-built_in">sqlite3_finalize</span>(stmt);  <span class="hljs-comment">// é‡Šæ”¾SQLè¯­å¥å¯¹è±¡</span>&#13;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;&#13;
}&#13;
&#13;
<span class="hljs-comment">// ä» bindParams ç»‘å®šæ‰€æœ‰å‚æ•°</span>&#13;
<span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">bool</span> <span class="hljs-title">BindParams2Stmt</span><span class="hljs-params">(<span class="hljs-type">const</span> std::vector&lt;TableValue&gt; &amp;bindParams,&#13;
                            sqlite3_stmt *stmt, sqlite3 *db)</span> </span>{&#13;
  <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> si = <span class="hljs-number">0</span>; si &lt; bindParams.<span class="hljs-built_in">size</span>(); ++si) {&#13;
    <span class="hljs-type">int</span> bindIndex = <span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">int</span>&gt;(si + <span class="hljs-number">1</span>);  <span class="hljs-comment">// SQLite å‚æ•°ä» 1 å¼€å§‹</span>&#13;
    <span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;bindParam = bindParams[si];&#13;
&#13;
    <span class="hljs-comment">// ä½¿ç”¨ std::holds_alternative æ£€æŸ¥å½“å‰æ˜¯å¦å­˜å‚¨äº†æŒ‡å®šç±»å‹çš„å€¼</span>&#13;
    <span class="hljs-keyword">if</span> (std::<span class="hljs-built_in">holds_alternative</span>&lt;std::string&gt;(bindParam)) {&#13;
      <span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;param = std::<span class="hljs-built_in">get</span>&lt;std::string&gt;(bindParam);&#13;
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_bind_text</span>(stmt, bindIndex, param.<span class="hljs-built_in">c_str</span>(), <span class="hljs-number">-1</span>,&#13;
                            SQLITE_STATIC) != SQLITE_OK) {&#13;
        std::cerr &lt;&lt; <span class="hljs-string">"ç»‘å®šé”™è¯¯: "</span> &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db) &lt;&lt; std::endl;&#13;
        <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
      }&#13;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (std::<span class="hljs-built_in">holds_alternative</span>&lt;<span class="hljs-type">int64_t</span>&gt;(bindParam)) {&#13;
      <span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;param = std::<span class="hljs-built_in">get</span>&lt;<span class="hljs-type">int64_t</span>&gt;(bindParam);&#13;
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_bind_int64</span>(stmt, bindIndex, param) != SQLITE_OK) {&#13;
        std::cerr &lt;&lt; <span class="hljs-string">"ç»‘å®šé”™è¯¯: "</span> &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db) &lt;&lt; std::endl;&#13;
        <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
      }&#13;
    } <span class="hljs-keyword">else</span> {&#13;
      std::cerr &lt;&lt; <span class="hljs-string">"ä¸æ”¯æŒçš„ç»‘å®šå‚æ•°ç±»å‹"</span> &lt;&lt; std::endl;&#13;
      <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
    }&#13;
  }&#13;
&#13;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;&#13;
}&#13;
&#13;
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">UpdateRow</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *sql, <span class="hljs-type">const</span> std::vector&lt;TableValue&gt; &amp;bindParams)</span> </span>{&#13;
  sqlite3 *db = App::<span class="hljs-built_in">GetInstance</span>().<span class="hljs-built_in">Db</span>();&#13;
&#13;
  <span class="hljs-comment">// å‡†å¤‡SQLè¯­å¥</span>&#13;
  sqlite3_stmt *stmt;&#13;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_prepare_v2</span>(db, sql, <span class="hljs-number">-1</span>, &amp;stmt, <span class="hljs-literal">nullptr</span>) != SQLITE_OK) {&#13;
    std::cerr &lt;&lt; (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(<span class="hljs-string">u8"SQLå‡†å¤‡è¯­å¥å¤±è´¥: "</span>) &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db)&#13;
              &lt;&lt; std::endl;&#13;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
  }&#13;
&#13;
  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">BindParams2Stmt</span>(bindParams, stmt, db)) {&#13;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
  }&#13;
&#13;
  <span class="hljs-comment">// æ‰§è¡Œè¯­å¥</span>&#13;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_step</span>(stmt) != SQLITE_DONE) {&#13;
    std::cerr &lt;&lt; (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(<span class="hljs-string">u8"æ‰§è¡Œå¤±è´¥: "</span>) &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db)&#13;
              &lt;&lt; std::endl;&#13;
    <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
  }&#13;
&#13;
  <span class="hljs-comment">// æ¸…ç†</span>&#13;
  <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;&#13;
}&#13;
&#13;
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">QueryRows</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *sql, std::vector&lt;TableValue&gt; &amp;result,&#13;
               <span class="hljs-type">const</span> std::vector&lt;TableValue&gt; &amp;bindParams)</span> </span>{&#13;
  sqlite3 *db = App::<span class="hljs-built_in">GetInstance</span>().<span class="hljs-built_in">Db</span>();&#13;
&#13;
  <span class="hljs-comment">// å‡†å¤‡SQLè¯­å¥</span>&#13;
  sqlite3_stmt *stmt;&#13;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_prepare_v2</span>(db, sql, <span class="hljs-number">-1</span>, &amp;stmt, <span class="hljs-literal">nullptr</span>) != SQLITE_OK) {&#13;
    std::cerr &lt;&lt; (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(<span class="hljs-string">u8"SQLå‡†å¤‡è¯­å¥å¤±è´¥: "</span>) &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db)&#13;
              &lt;&lt; std::endl;&#13;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
  }&#13;
&#13;
  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">BindParams2Stmt</span>(bindParams, stmt, db)) {&#13;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
  }&#13;
&#13;
  <span class="hljs-comment">// æ‰§è¡ŒSQLè¯­å¥å¹¶å­˜å‚¨ç»“æœ</span>&#13;
  <span class="hljs-keyword">while</span> (<span class="hljs-built_in">sqlite3_step</span>(stmt) == SQLITE_ROW) {&#13;
    <span class="hljs-type">int</span> colCount = <span class="hljs-built_in">sqlite3_column_count</span>(stmt);&#13;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; colCount; ++i) {&#13;
      <span class="hljs-keyword">switch</span> (<span class="hljs-built_in">sqlite3_column_type</span>(stmt, i)) {&#13;
        <span class="hljs-keyword">case</span> SQLITE_TEXT: {&#13;
          result.<span class="hljs-built_in">emplace_back</span>(&#13;
              <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">const</span> <span class="hljs-type">char</span> *&gt;(<span class="hljs-built_in">sqlite3_column_text</span>(stmt, i)));&#13;
          <span class="hljs-keyword">break</span>;&#13;
        }&#13;
        <span class="hljs-keyword">case</span> SQLITE_INTEGER: {&#13;
          result.<span class="hljs-built_in">emplace_back</span>(<span class="hljs-built_in">sqlite3_column_int64</span>(stmt, i));&#13;
          <span class="hljs-keyword">break</span>;&#13;
        }&#13;
        <span class="hljs-keyword">case</span> SQLITE_NULL: {&#13;
          result.<span class="hljs-built_in">emplace_back</span>(std::monostate{});&#13;
          <span class="hljs-keyword">break</span>;&#13;
        }&#13;
        <span class="hljs-keyword">case</span> SQLITE_FLOAT:&#13;
        <span class="hljs-keyword">case</span> SQLITE_BLOB:&#13;
        <span class="hljs-keyword">default</span>: {&#13;
          std::cerr &lt;&lt; (<span class="hljs-type">const</span> <span class="hljs-type">char</span> *)(<span class="hljs-string">u8"æ‰§è¡Œå¤±è´¥: "</span>) &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db)&#13;
                    &lt;&lt; std::endl;&#13;
          <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
        }&#13;
      }&#13;
    }&#13;
  }&#13;
&#13;
  <span class="hljs-built_in">sqlite3_finalize</span>(stmt);  <span class="hljs-comment">// é‡Šæ”¾SQLè¯­å¥å¯¹è±¡</span>&#13;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;&#13;
}&#13;
&#13;
}  <span class="hljs-comment">// namespace Sqlite3Crud</span>&#13;
&#13;
}  <span class="hljs-comment">// namespace Persistence</span>
</code></pre>
<p>Sqlite3 çš„ CURD çš„æ“ä½œéƒ½å·®ä¸å¤šï¼Œéƒ½æ˜¯ç¼–è¯‘ statement ï¼Œç„¶åç»‘å®šå‚æ•°ï¼Œæœ€åæ‰§è¡Œã€‚ä½†æ˜¯è¦å®ç°ç»Ÿä¸€çš„ CURD æ¥å£çš„å°è£…ï¼Œä¸€ä¸ªå…³é”®çš„åœ°æ–¹å°±åœ¨äºä¼ å‚è¡¨æ ¼å­—æ®µå€¼ç±»å‹ã€‚å¦‚æœæ˜¯ JavaScriptã€Python è¿™æ ·çš„ç¼–ç¨‹è¯­è¨€å¥½åŠï¼Œå®ƒä»¬æ˜¯å¼±ç±»å‹è¯­è¨€ï¼Œå®Œå…¨å¯ä»¥æ”¯æŒã€‚ä½œä¸ºå¼ºç±»å‹è¯­è¨€ï¼ŒC++ä¹Ÿæœ‰åŠæ³•ï¼Œé‚£å°±æ˜¯ä½¿ç”¨ C++17 æä¾›çš„ <code>std::variant</code>:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">using</span> TableValue = std::variant&lt;std::monostate, std::string, <span class="hljs-type">int64_t</span>&gt;;  <span class="hljs-comment">//è¡¨çš„å€¼</span>
</code></pre>
<p>è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªç±»å‹åˆ«å <code>TableValue</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ª std::variant ç±»å‹ï¼Œå¯ä»¥æŒæœ‰ä»¥ä¸‹ä¸‰ç§ç±»å‹çš„å€¼ï¼š<code>std::monostate</code> ã€<code>std::string</code> å’Œ <code>int64_t</code> ã€‚å…¶ä¸­ <code>std::monostate</code> æ˜¯ä¸€ä¸ªç©ºç±»å‹ï¼ˆempty structï¼‰ï¼Œå¸¸ç”¨äº std::variant ä¸­è¡¨ç¤ºâ€œæ— å€¼â€æˆ–â€œç©ºçŠ¶æ€â€ã€‚å½“éœ€è¦ç»‘å®šå‚æ•°åˆ° SQL è¯­å¥æ—¶ï¼Œå†å°† <code>TableValue</code> æ‹†ç®±æˆå…·ä½“çš„å€¼ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ä» bindParams ç»‘å®šæ‰€æœ‰å‚æ•°</span>&#13;
<span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">bool</span> <span class="hljs-title">BindParams2Stmt</span><span class="hljs-params">(<span class="hljs-type">const</span> std::vector&lt;TableValue&gt; &amp;bindParams,&#13;
                            sqlite3_stmt *stmt, sqlite3 *db)</span> </span>{&#13;
  <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> si = <span class="hljs-number">0</span>; si &lt; bindParams.<span class="hljs-built_in">size</span>(); ++si) {&#13;
    <span class="hljs-type">int</span> bindIndex = <span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">int</span>&gt;(si + <span class="hljs-number">1</span>);  <span class="hljs-comment">// SQLite å‚æ•°ä» 1 å¼€å§‹</span>&#13;
    <span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;bindParam = bindParams[si];&#13;
&#13;
    <span class="hljs-comment">// ä½¿ç”¨ std::holds_alternative æ£€æŸ¥å½“å‰æ˜¯å¦å­˜å‚¨äº†æŒ‡å®šç±»å‹çš„å€¼</span>&#13;
    <span class="hljs-keyword">if</span> (std::<span class="hljs-built_in">holds_alternative</span>&lt;std::string&gt;(bindParam)) {&#13;
      <span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;param = std::<span class="hljs-built_in">get</span>&lt;std::string&gt;(bindParam);&#13;
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_bind_text</span>(stmt, bindIndex, param.<span class="hljs-built_in">c_str</span>(), <span class="hljs-number">-1</span>,&#13;
                            SQLITE_STATIC) != SQLITE_OK) {&#13;
        std::cerr &lt;&lt; <span class="hljs-string">"ç»‘å®šé”™è¯¯: "</span> &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db) &lt;&lt; std::endl;&#13;
        <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
      }&#13;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (std::<span class="hljs-built_in">holds_alternative</span>&lt;<span class="hljs-type">int64_t</span>&gt;(bindParam)) {&#13;
      <span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;param = std::<span class="hljs-built_in">get</span>&lt;<span class="hljs-type">int64_t</span>&gt;(bindParam);&#13;
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sqlite3_bind_int64</span>(stmt, bindIndex, param) != SQLITE_OK) {&#13;
        std::cerr &lt;&lt; <span class="hljs-string">"ç»‘å®šé”™è¯¯: "</span> &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db) &lt;&lt; std::endl;&#13;
        <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
      }&#13;
    } <span class="hljs-keyword">else</span> {&#13;
      std::cerr &lt;&lt; <span class="hljs-string">"ä¸æ”¯æŒçš„ç»‘å®šå‚æ•°ç±»å‹"</span> &lt;&lt; std::endl;&#13;
      <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
    }&#13;
  }&#13;
&#13;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;&#13;
}
</code></pre>
<h3 data-id="heading-3">2.2 å­—æ®µå</h3>
<p>ä»”ç»†è§‚å¯Ÿ <code>InsertRow</code>ã€<code>DeleteRow</code>ã€<code>UpdateRow</code> ä»¥åŠ <code>QueryRows</code> çš„å®ç°ï¼Œè™½ç„¶å®ƒä»¬é€šè¿‡ <code>TableValue</code> è§£å†³äº†å­—æ®µå€¼ç±»å‹å¤šæ ·çš„ä¼ å‚é—®é¢˜ï¼Œä½†ä»ç„¶è¦æ±‚è°ƒç”¨è€…ä¼ å…¥å®Œæ•´çš„ SQL å­—ç¬¦ä¸²ã€‚è¿™æ„å‘³ç€ä¸šåŠ¡ä»£ç ä»éœ€æ‰‹åŠ¨æ‹¼æ¥è¡¨åã€å­—æ®µåå’Œå ä½ç¬¦ï¼Œä¸ä»…é‡å¤ç¹çï¼Œè¿˜å®¹æ˜“å¼•å…¥è¯­æ³•é”™è¯¯æˆ– SQL æ³¨å…¥é£é™©ï¼ˆå°½ç®¡ä½¿ç”¨å‚æ•°ç»‘å®šå¯ç¼“è§£åè€…ï¼‰ã€‚</p>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œè¡¨ç»“æ„æœ¬èº«æ˜¯é™æ€çš„ã€å·²çŸ¥çš„ï¼šæ¯”å¦‚ä¸€ç¯‡åšå®¢æ–‡ç« å¯¹åº” posts è¡¨ï¼ŒåŒ…å« idã€titleã€content ç­‰å­—æ®µã€‚å¦‚æœæ¯æ¬¡æ’å…¥éƒ½è¦å†™ "INSERT INTO posts (title, content) VALUES (?, ?)"ï¼Œé‚£ä¹ˆå½“è¡¨ç»“æ„å˜æ›´æ—¶ï¼Œæ‰€æœ‰ç›¸å…³ SQL å­—ç¬¦ä¸²éƒ½éœ€åŒæ­¥ä¿®æ”¹ï¼Œè¿åäº†â€œä¸€å¤„ä¿®æ”¹ï¼Œå¤„å¤„ç”Ÿæ•ˆâ€çš„å·¥ç¨‹åŸåˆ™ã€‚</p>
<p>å› æ­¤ï¼Œç†æƒ³çš„åšæ³•æ˜¯ï¼šè®© CRUD æ¥å£æ¥å—é«˜å±‚è¯­ä¹‰ä¿¡æ¯ï¼ˆå¦‚è¡¨åã€å­—æ®µååˆ—è¡¨ï¼‰ï¼Œç”±åº•å±‚è‡ªåŠ¨æ„é€ å¯¹åº”çš„ SQL è¯­å¥ã€‚è¿™æ ·ï¼Œä¸šåŠ¡å±‚åªéœ€å…³æ³¨â€œæˆ‘è¦æ’å…¥å“ªäº›å­—æ®µâ€ï¼Œè€Œæ— éœ€å…³å¿ƒå…·ä½“çš„ SQL è¯­æ³•ç»†èŠ‚ã€‚è¿™ä¸ä»…æå‡äº†å¼€å‘æ•ˆç‡ï¼Œä¹Ÿå¢å¼ºäº†ç³»ç»Ÿçš„å†…èšæ€§ä¸å¯ç»´æŠ¤æ€§ã€‚</p>
<p>åŸºäº ORM çš„æ€æƒ³ï¼Œä¸€ä¸ªç®€å•çš„æƒ³æ³•æ˜¯å¯ä»¥å°†æ•°æ®åº“è¡¨æ˜ å°„æˆç±»/ç»“æ„ä½“å¯¹è±¡ï¼Œé€šè¿‡åå°„ç‰¹æ€§è·å–ç±»/ç»“æ„ä½“å¯¹è±¡çš„æˆå‘˜ä¿¡æ¯ï¼Œè¿›è€ŒçŸ¥é“æ•°æ®åº“è¡¨åå’Œå­—æ®µåï¼Œå®ç°è‡ªåŠ¨æ„é€ è¯­å¥ã€‚å¦‚æœæ˜¯ Java æˆ–è€… C# è¿™æ ·çš„é«˜çº§æ‰˜ç®¡è¯­è¨€å°±æ²¡æœ‰é—®é¢˜ï¼Œå› ä¸ºå®ƒä»¬æ”¯æŒåå°„ï¼ˆReflectionï¼‰ç‰¹æ€§ã€‚å¯¹äº C++ ï¼Œå¯ä»¥å¼•å…¥ magic_enum åº“ï¼Œå°†æšä¸¾å€¼ï¼ˆenumï¼‰è½¬æ¢ä¸ºå¯¹åº”çš„å­—ç¬¦ä¸²åç§°ã€‚å‚çœ‹å·¥å…·æ¥å£Util::Statement çš„å®ç°ï¼š</p>
<p><strong>Statement.hpp</strong>:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">pragma</span> once</span>&#13;
&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;format&gt;</span></span>&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;magic_enum/magic_enum.hpp&gt;</span></span>&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;optional&gt;</span></span>&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span>&#13;
&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"Persistence/TableName.h"</span></span>&#13;
&#13;
<span class="hljs-keyword">namespace</span> Util {&#13;
&#13;
<span class="hljs-keyword">namespace</span> Statement {&#13;
&#13;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> Persistence;&#13;
&#13;
<span class="hljs-keyword">enum class</span> <span class="hljs-title class_">OrderByValue</span> { ASC, DESC };&#13;
&#13;
<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> Field&gt;&#13;
<span class="hljs-function">std::string <span class="hljs-title">Insert</span><span class="hljs-params">(TableName tableName, <span class="hljs-type">const</span> std::vector&lt;Field&gt;&amp; fieldNames)</span> </span>{&#13;
  <span class="hljs-type">size_t</span> num = fieldNames.<span class="hljs-built_in">size</span>();&#13;
  <span class="hljs-keyword">if</span> (num == <span class="hljs-number">0</span>) {&#13;
    <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">invalid_argument</span>(<span class="hljs-string">"æ’å…¥æ•°æ®ç¼ºå°‘æ’å…¥é¡¹ï¼"</span>);&#13;
  }&#13;
&#13;
  std::string columnList = <span class="hljs-string">"("</span>;           <span class="hljs-comment">//åˆ—åˆ—è¡¨</span>&#13;
  std::string valuesClause = <span class="hljs-string">"VALUES ("</span>;  <span class="hljs-comment">// valueså­å¥</span>&#13;
  <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; num; ++i) {&#13;
    columnList += magic_enum::<span class="hljs-built_in">enum_name</span>(fieldNames.<span class="hljs-built_in">at</span>(i));&#13;
    valuesClause += <span class="hljs-string">"?"</span>;&#13;
    <span class="hljs-keyword">if</span> (i != num - <span class="hljs-number">1</span>) {&#13;
      columnList += <span class="hljs-string">", "</span>;&#13;
      valuesClause += <span class="hljs-string">", "</span>;&#13;
    }&#13;
  }&#13;
  columnList += <span class="hljs-string">")"</span>;&#13;
  valuesClause += <span class="hljs-string">")"</span>;&#13;
&#13;
  <span class="hljs-comment">//æ’å…¥å­å¥</span>&#13;
  std::string insertClause = std::format(&#13;
      <span class="hljs-string">"INSERT INTO {} {}"</span>, magic_enum::<span class="hljs-built_in">enum_name</span>(tableName), columnList);&#13;
&#13;
  <span class="hljs-keyword">return</span> std::format(<span class="hljs-string">"{} {};"</span>, insertClause, valuesClause);&#13;
}&#13;
&#13;
<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> Field&gt;&#13;
<span class="hljs-function">std::string <span class="hljs-title">Delete</span><span class="hljs-params">(TableName tableName, <span class="hljs-type">const</span> Field&amp; fieldName)</span> </span>{&#13;
  std::string deleteClause = <span class="hljs-string">"DELETE"</span>;&#13;
&#13;
  std::string fromClause =&#13;
      std::format(<span class="hljs-string">"FROM {}"</span>, magic_enum::<span class="hljs-built_in">enum_name</span>(tableName));&#13;
&#13;
  std::string whereClause =&#13;
      std::format(<span class="hljs-string">"WHERE {} = ?"</span>, magic_enum::<span class="hljs-built_in">enum_name</span>(fieldName));&#13;
&#13;
  <span class="hljs-keyword">return</span> std::format(<span class="hljs-string">"{} {} {};"</span>, deleteClause, fromClause, whereClause);&#13;
}&#13;
&#13;
<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> Field&gt;&#13;
<span class="hljs-function">std::string <span class="hljs-title">Update</span><span class="hljs-params">(TableName tableName, <span class="hljs-type">const</span> std::vector&lt;Field&gt;&amp; fieldNames)</span> </span>{&#13;
  <span class="hljs-type">size_t</span> num = fieldNames.<span class="hljs-built_in">size</span>();&#13;
  <span class="hljs-keyword">if</span> (num &lt;= <span class="hljs-number">1</span>) {&#13;
    <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">invalid_argument</span>(<span class="hljs-string">"æ›´æ–°æ•°æ®è‡³å°‘è¦ä¸¤åˆ—å€¼ï¼"</span>);&#13;
  }&#13;
&#13;
  std::string updateClause =&#13;
      std::format(<span class="hljs-string">"UPDATE {}"</span>, magic_enum::<span class="hljs-built_in">enum_name</span>(tableName));&#13;
&#13;
  std::string setClause = <span class="hljs-string">"SET "</span>;&#13;
  <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; num - <span class="hljs-number">1</span>; ++i) {&#13;
    setClause += magic_enum::<span class="hljs-built_in">enum_name</span>(fieldNames[i]);&#13;
    setClause += <span class="hljs-string">" = ?"</span>;&#13;
    <span class="hljs-keyword">if</span> (i != num - <span class="hljs-number">2</span>) {&#13;
      setClause += <span class="hljs-string">", "</span>;&#13;
    }&#13;
  }&#13;
&#13;
  std::string whereClause =&#13;
      std::format(<span class="hljs-string">"WHERE {} = ?"</span>, magic_enum::<span class="hljs-built_in">enum_name</span>(fieldNames[num - <span class="hljs-number">1</span>]));&#13;
&#13;
  <span class="hljs-keyword">return</span> std::format(<span class="hljs-string">"{} {} {};"</span>, updateClause, setClause, whereClause);&#13;
}&#13;
&#13;
<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> Field&gt;&#13;
<span class="hljs-function">std::string <span class="hljs-title">Query</span><span class="hljs-params">(TableName tableName, <span class="hljs-type">const</span> std::vector&lt;Field&gt;&amp; fieldNames,&#13;
                  <span class="hljs-type">const</span> std::vector&lt;Field&gt;&amp; whereFields = {},&#13;
                  std::optional&lt;Field&gt; orderByField = std::<span class="hljs-literal">nullopt</span>,&#13;
                  std::optional&lt;OrderByValue&gt; orderByValue = std::<span class="hljs-literal">nullopt</span>)</span> </span>{&#13;
  <span class="hljs-keyword">if</span> (fieldNames.<span class="hljs-built_in">empty</span>()) {&#13;
    <span class="hljs-keyword">throw</span> std::<span class="hljs-built_in">invalid_argument</span>(<span class="hljs-string">"query sql fieldNames must not be empty"</span>);&#13;
  }&#13;
&#13;
  <span class="hljs-type">size_t</span> num = fieldNames.<span class="hljs-built_in">size</span>();&#13;
&#13;
  <span class="hljs-comment">//</span>&#13;
  std::string columnList;  <span class="hljs-comment">//åˆ—åˆ—è¡¨</span>&#13;
  <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; num; ++i) {&#13;
    columnList += magic_enum::<span class="hljs-built_in">enum_name</span>(fieldNames.<span class="hljs-built_in">at</span>(i));&#13;
    <span class="hljs-keyword">if</span> (i != num - <span class="hljs-number">1</span>) {&#13;
      columnList += <span class="hljs-string">", "</span>;&#13;
    }&#13;
  }&#13;
  std::string selectClause = std::format(<span class="hljs-string">"SELECT {}"</span>, columnList);&#13;
&#13;
  std::string fromClause =&#13;
      std::format(<span class="hljs-string">"FROM {}"</span>, magic_enum::<span class="hljs-built_in">enum_name</span>(tableName));&#13;
  std::string statement = std::format(<span class="hljs-string">"{} {}"</span>, selectClause, fromClause);&#13;
&#13;
  <span class="hljs-comment">// æ·»åŠ  WHERE å­å¥ï¼ˆæ”¯æŒå¤šä¸ªæ¡ä»¶ï¼‰</span>&#13;
  <span class="hljs-keyword">if</span> (!whereFields.<span class="hljs-built_in">empty</span>()) {&#13;
    std::string whereClause = <span class="hljs-string">"WHERE "</span>;&#13;
&#13;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; whereFields.<span class="hljs-built_in">size</span>(); ++i) {&#13;
      whereClause += magic_enum::<span class="hljs-built_in">enum_name</span>(whereFields[i]);&#13;
      whereClause += <span class="hljs-string">" = ?"</span>;&#13;
      <span class="hljs-keyword">if</span> (i != whereFields.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>) {&#13;
        whereClause += <span class="hljs-string">" AND "</span>;&#13;
      }&#13;
    }&#13;
    statement = std::format(<span class="hljs-string">"{} {}"</span>, statement, whereClause);&#13;
  }&#13;
&#13;
  <span class="hljs-keyword">if</span> (orderByField.<span class="hljs-built_in">has_value</span>() &amp;&amp; orderByValue.<span class="hljs-built_in">has_value</span>()) {&#13;
    std::string orderByClause = std::format(&#13;
        <span class="hljs-string">"ORDER BY {} {}"</span>, magic_enum::<span class="hljs-built_in">enum_name</span>(orderByField.<span class="hljs-built_in">value</span>()),&#13;
        magic_enum::<span class="hljs-built_in">enum_name</span>(orderByValue.<span class="hljs-built_in">value</span>()));&#13;
    statement = std::format(<span class="hljs-string">"{} {}"</span>, statement, orderByClause);&#13;
  }&#13;
&#13;
  <span class="hljs-keyword">return</span> std::format(<span class="hljs-string">"{};"</span>, statement);&#13;
}&#13;
&#13;
}  <span class="hljs-comment">// namespace Statement</span>&#13;
&#13;
}  <span class="hljs-comment">// namespace Util</span>
</code></pre>
<p>åˆ©ç”¨æ¨¡æ¿ç‰¹æ€§ï¼Œæ¥å£<code>Insert</code>ã€<code>Delete</code>ã€<code>Update</code>ã€<code>Query</code>å¯ä»¥æ¥å—ä¸åŒçš„æ•°æ®åº“è¡¨çš„æšä¸¾ç±»æ˜ å°„å¯¹è±¡ã€‚ä¾‹å¦‚åšæ–‡è¡¨<code>TableBlogsField.h</code>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">pragma</span> once</span>&#13;
&#13;
<span class="hljs-keyword">namespace</span> Persistence {&#13;
&#13;
<span class="hljs-keyword">enum class</span> <span class="hljs-title class_">TableBlogsField</span> {&#13;
  id,&#13;
  title,&#13;
  content,&#13;
  summary,&#13;
  cover_image_url,&#13;
  created_at,&#13;
  updated_at,&#13;
  is_draft&#13;
};&#13;
&#13;
}
</code></pre>
<p>åˆ†ç±»ä¸“æ è¡¨<code>TableCategoriesField.h</code>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">pragma</span> once</span>&#13;
&#13;
<span class="hljs-keyword">namespace</span> Persistence {&#13;
&#13;
<span class="hljs-keyword">enum class</span> <span class="hljs-title class_">TableCategoriesField</span> {&#13;
  id,&#13;
  title,&#13;
  description,&#13;
  image_url,&#13;
  parent_id,&#13;
  created_at&#13;
};&#13;
&#13;
}
</code></pre>
<p><code>TableBlogsField</code> ã€<code>TableCategoriesField</code> ä¼šåœ¨ <code>Insert</code>ã€<code>Delete</code>ã€<code>Update</code>ã€<code>Query</code> çš„æ¨¡æ¿ <code>template &lt;typename Field&gt;</code> ä¸­å±•å¼€æˆå­—ç¬¦ä¸²ï¼Œå®ç° SQL å­—ç¬¦ä¸²çš„æ‹¼æ¥ï¼›å¹¶è¢« <code>Sqlite3Crud</code> çš„ <code>Insert</code>ã€<code>Delete</code>ã€<code>Update</code>ã€<code>Query</code> æ‰€è°ƒç”¨ï¼Œå½¢æˆæ›´åŠ é€šç”¨çš„æ¥å£ã€‚è¿™æ ·ï¼Œä¸šåŠ¡ä»£ç åªéœ€æ“ä½œè¯­ä¹‰æ¸…æ™°çš„æšä¸¾å­—æ®µï¼Œè€Œæ— éœ€ç¡¬ç¼–ç ä»»ä½• SQL å­—ç¬¦ä¸²ã€‚è¿™ç§åŸºäºæšä¸¾ä¸æ¨¡æ¿çš„â€œç¼–è¯‘æœŸåå°„â€æœºåˆ¶ï¼Œåœ¨ C++ ç¼ºä¹åŸç”Ÿåå°„èƒ½åŠ›çš„å‰æä¸‹ï¼Œæä¾›äº†ä¸€ç§è½»é‡ã€ç±»å‹å®‰å…¨ä¸”æ˜“äºç»´æŠ¤çš„ ORM é£æ ¼æ¥å£ã€‚</p>
<h3 data-id="heading-4">2.3 è°ƒç”¨</h3>
<p>å½“ç„¶ï¼Œåœ¨ <code>Sqlite3Crud</code> çš„ <code>Insert</code>ã€<code>Delete</code>ã€<code>Update</code>ã€<code>Query</code> æ¥å£ä¸­ï¼Œè¿˜éœ€è¦çŸ¥é“æ•°æ®åº“åï¼Œè¿™ä¹Ÿæ˜¯æšä¸¾ç±»<code>TableName.h</code>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">pragma</span> once</span>&#13;
&#13;
<span class="hljs-keyword">namespace</span> Persistence {&#13;
&#13;
<span class="hljs-keyword">enum class</span> <span class="hljs-title class_">TableName</span> {&#13;
  users,&#13;
  tags,&#13;
  blog_tags,&#13;
  categories,&#13;
  category_blog,&#13;
  blog_views,&#13;
  blog_likes,&#13;
  friend_links,&#13;
  blogs&#13;
};&#13;
&#13;
}
</code></pre>
<p>å¦‚æœæ˜¯ä»åšæ–‡è¡¨ä¸­æŸ¥è¯¢æ•°æ®ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp">vector&lt;Sqlite3Crud::TableValue&gt; result;&#13;
<span class="hljs-keyword">if</span> (!Sqlite3Crud::<span class="hljs-built_in">Query</span>&lt;TableBlogsField&gt;(&#13;
        TableName::blogs,&#13;
        {TableBlogsField::title, TableBlogsField::content,&#13;
        TableBlogsField::summary, TableBlogsField::created_at,&#13;
        TableBlogsField::updated_at},&#13;
        result, {TableBlogsField::is_draft, TableBlogsField::id},&#13;
        {isDraft, blogId})) {&#13;
<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
}&#13;
&#13;
<span class="hljs-keyword">auto</span> &amp;blogMeta = blogData.blogMeta;&#13;
blogMeta.id = blogId;&#13;
blogMeta.title = std::<span class="hljs-built_in">move</span>(std::<span class="hljs-built_in">get</span>&lt;std::string&gt;(result.<span class="hljs-built_in">at</span>(<span class="hljs-number">0</span>)));&#13;
blogData.content = std::<span class="hljs-built_in">move</span>(std::<span class="hljs-built_in">get</span>&lt;std::string&gt;(result.<span class="hljs-built_in">at</span>(<span class="hljs-number">1</span>)));&#13;
blogMeta.summary = std::<span class="hljs-built_in">move</span>(std::<span class="hljs-built_in">get</span>&lt;std::string&gt;(result.<span class="hljs-built_in">at</span>(<span class="hljs-number">2</span>)));&#13;
blogMeta.createdTime = std::<span class="hljs-built_in">move</span>(std::<span class="hljs-built_in">get</span>&lt;std::string&gt;(result.<span class="hljs-built_in">at</span>(<span class="hljs-number">3</span>)));&#13;
blogMeta.updatedTime = std::<span class="hljs-built_in">move</span>(std::<span class="hljs-built_in">get</span>&lt;std::string&gt;(result.<span class="hljs-built_in">at</span>(<span class="hljs-number">4</span>)));
</code></pre>
<p>åˆ›å»ºåšæ–‡æ’å…¥åˆ°åšæ–‡è¡¨ä¸­ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">auto</span> &amp;blogMeta = blogData.blogMeta;&#13;
blogMeta.updatedTime = blogMeta.createdTime;&#13;
&#13;
<span class="hljs-comment">// æ’å…¥åšæ–‡è¡¨</span>&#13;
Sqlite3Crud::<span class="hljs-built_in">Insert</span>&lt;TableBlogsField&gt;(&#13;
    TableName::blogs,&#13;
    {TableBlogsField::id, TableBlogsField::title, TableBlogsField::content,&#13;
    TableBlogsField::summary, TableBlogsField::created_at,&#13;
    TableBlogsField::updated_at, TableBlogsField::cover_image_url,&#13;
    TableBlogsField::is_draft},&#13;
    {blogId, std::<span class="hljs-built_in">move</span>(blogMeta.title), std::<span class="hljs-built_in">move</span>(blogData.content),&#13;
    std::<span class="hljs-built_in">move</span>(blogMeta.summary), std::<span class="hljs-built_in">move</span>(blogMeta.createdTime),&#13;
    std::<span class="hljs-built_in">move</span>(blogMeta.updatedTime), std::<span class="hljs-built_in">move</span>(blogMeta.coverAddress),&#13;
    std::<span class="hljs-built_in">move</span>(blogMeta.isDraft)});
</code></pre>
<p>æ›´æ–°æŸç¯‡åšæ–‡æ•°æ®ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> &amp;blogId = blogData.blogMeta.id;&#13;
<span class="hljs-keyword">auto</span> &amp;blogMeta = blogData.blogMeta;&#13;
&#13;
<span class="hljs-keyword">if</span> (!Sqlite3Crud::<span class="hljs-built_in">Update</span>&lt;TableBlogsField&gt;(&#13;
        TableName::blogs,&#13;
        {TableBlogsField::title, TableBlogsField::content,&#13;
        TableBlogsField::summary, TableBlogsField::created_at,&#13;
        TableBlogsField::updated_at, TableBlogsField::cover_image_url,&#13;
        TableBlogsField::is_draft, TableBlogsField::id},&#13;
        {std::<span class="hljs-built_in">move</span>(blogMeta.title), std::<span class="hljs-built_in">move</span>(blogData.content),&#13;
        std::<span class="hljs-built_in">move</span>(blogMeta.summary), std::<span class="hljs-built_in">move</span>(blogMeta.createdTime),&#13;
        std::<span class="hljs-built_in">move</span>(blogMeta.updatedTime), std::<span class="hljs-built_in">move</span>(blogMeta.coverAddress),&#13;
        std::<span class="hljs-built_in">move</span>(blogMeta.isDraft), blogId})) {&#13;
<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;&#13;
}
</code></pre>
<p>åˆ é™¤æŸç¯‡åšæ–‡ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp">Sqlite3Crud::<span class="hljs-built_in">Delete</span>&lt;TableBlogsField&gt;(&#13;
      TableName::blogs, TableBlogsField::id, {std::<span class="hljs-built_in">move</span>(blogId)});
</code></pre>
<p>è¿™ç§è°ƒç”¨æ–¹å¼å°†æ•°æ®åº“æ“ä½œå®Œå…¨è§£è€¦äºåŸå§‹ SQL å­—ç¬¦ä¸²ï¼Œä¸ä»…é¿å…äº†æ‰‹å†™ SQL å¸¦æ¥çš„æ‹¼å†™é”™è¯¯ä¸æ³¨å…¥é£é™©ï¼Œè¿˜ä½¿å¾—è¡¨ç»“æ„å˜æ›´åªéœ€ä¿®æ”¹å¯¹åº”çš„æšä¸¾å®šä¹‰å³å¯è‡ªåŠ¨åŒæ­¥åˆ°æ‰€æœ‰ç›¸å…³æ“ä½œä¸­ï¼Œæ˜¾è‘—æå‡äº†ä»£ç çš„å®‰å…¨æ€§ã€å¯è¯»æ€§ä¸å¯ç»´æŠ¤æ€§ã€‚</p>
<h2 data-id="heading-5">3. ä¼˜åŒ–</h2>
<h3 data-id="heading-6">3.1 ç¼–è¯‘æœŸç”Ÿæˆ</h3>
<p>è™½ç„¶è¿™æ ·åšå·²ç»éå¸¸è‡ªåŠ¨åŒ–äº†ï¼Œä½†æ˜¯æ•°æ®åº“è¡¨æ˜ å°„çš„æšä¸¾ç±»å¯¹è±¡å¯èƒ½å¹¶ä¸èƒ½è·Ÿ SQLite3 æ•°æ®åº“åŒæ­¥â€”â€”å› ä¸ºè¿™äº›æšä¸¾æ˜¯åœ¨ç¼–è¯‘æœŸé™æ€å®šä¹‰çš„ï¼Œè€Œæ•°æ®åº“è¡¨ç»“æ„å¯èƒ½åœ¨è¿è¡Œæ—¶è¢«å¤–éƒ¨å·¥å…·ï¼ˆå¦‚è¿ç§»è„šæœ¬ã€æ‰‹åŠ¨ ALTER TABLE æ“ä½œæˆ–ä¸åŒç‰ˆæœ¬çš„éƒ¨ç½²ï¼‰åŠ¨æ€ä¿®æ”¹ã€‚ä¸€æ—¦å®é™…æ•°æ®åº“ä¸­çš„å­—æ®µå¢åˆ æ”¹ä¸ C++ æšä¸¾ä¸­å®šä¹‰çš„å­—æ®µä¸ä¸€è‡´ï¼Œå°±ä¼šå¯¼è‡´ç”Ÿæˆçš„ SQL è¯­å¥å¼•ç”¨ä¸å­˜åœ¨çš„åˆ—ã€é—æ¼æ–°å¢åˆ—ï¼Œç”šè‡³å› ç±»å‹ä¸åŒ¹é…è€Œå¼•å‘è¿è¡Œæ—¶é”™è¯¯æˆ–æ•°æ®ä¸¢å¤±ã€‚</p>
<p>æ­¤å¤–ï¼Œè¿™ç§â€œä»£ç å³ Schemaâ€çš„æ–¹å¼ç¼ºä¹å¯¹æ•°æ®åº“çœŸå®çŠ¶æ€çš„éªŒè¯æœºåˆ¶ï¼Œæ— æ³•åœ¨ç¨‹åºå¯åŠ¨æ—¶è‡ªåŠ¨æ£€æµ‹è¡¨ç»“æ„æ˜¯å¦ä¸æšä¸¾å®šä¹‰ä¸€è‡´ï¼Œä»è€ŒåŸ‹ä¸‹æ½œåœ¨çš„å…¼å®¹æ€§éšæ‚£ã€‚å› æ­¤ï¼Œåœ¨è¿½æ±‚å¼€å‘æ•ˆç‡çš„åŒæ—¶ï¼Œä»éœ€è¾…ä»¥æ•°æ®åº“ç‰ˆæœ¬ç®¡ç†ï¼ˆå¦‚è¿ç§»è„šæœ¬ï¼‰ã€å¯åŠ¨æ—¶ç»“æ„æ ¡éªŒæˆ–æ„å»ºé˜¶æ®µçš„ä»£ç ç”Ÿæˆå·¥å…·ï¼ˆå¦‚ä»æ•°æ®åº“ schema è‡ªåŠ¨ç”Ÿæˆæšä¸¾ï¼‰ï¼Œæ‰èƒ½çœŸæ­£å®ç°ç±»å‹å®‰å…¨ä¸ç»“æ„ä¸€è‡´æ€§çš„åŒé‡ä¿éšœã€‚</p>
<p>å¯¹ C++ æ¥è¯´ï¼Œæ¯”è¾ƒå¥½çš„æ–¹æ³•å°±æ˜¯åœ¨æ„å»ºç¨‹åºçš„æ—¶å€™é€šè¿‡ä»£ç ç”Ÿæˆå·¥å…·ä»æ•°æ®åº“ schema è‡ªåŠ¨ç”Ÿæˆæšä¸¾ç±»ã€‚ç¬”è€…çš„å®ç°ä»£ç æ˜¯ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Script/DbSchemaGenerator.cpp</span>&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sqlite3.h&gt;</span></span>&#13;
&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;filesystem&gt;</span></span>&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fstream&gt;</span></span>&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span>&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span>&#13;
&#13;
<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> _WIN32</span>&#13;
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;Windows.h&gt;</span></span>&#13;
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>&#13;
&#13;
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;&#13;
&#13;
<span class="hljs-comment">//è½¬æ¢æˆå¸•æ–¯å¡å‘½å</span>&#13;
<span class="hljs-function">std::string <span class="hljs-title">ToPascalCase</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string&amp; input)</span> </span>{&#13;
  <span class="hljs-keyword">if</span> (input.<span class="hljs-built_in">empty</span>()) {&#13;
    <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;&#13;
  }&#13;
&#13;
  std::string result;&#13;
  <span class="hljs-type">bool</span> nextUpper = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// ä¸‹ä¸€ä¸ªæœ‰æ•ˆå­—ç¬¦åº”å¤§å†™</span>&#13;
&#13;
  <span class="hljs-keyword">for</span> (<span class="hljs-type">char</span> c : input) {&#13;
    <span class="hljs-keyword">if</span> (c == <span class="hljs-string">'_'</span>) {&#13;
      <span class="hljs-comment">// é‡åˆ°ä¸‹åˆ’çº¿ï¼Œä¸‹ä¸€ä¸ªéä¸‹åˆ’çº¿å­—æ¯è¦å¤§å†™</span>&#13;
      nextUpper = <span class="hljs-literal">true</span>;&#13;
    } <span class="hljs-keyword">else</span> {&#13;
      <span class="hljs-keyword">if</span> (nextUpper) {&#13;
        result +=&#13;
            <span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">char</span>&gt;(std::<span class="hljs-built_in">toupper</span>(<span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>&gt;(c)));&#13;
        nextUpper = <span class="hljs-literal">false</span>;&#13;
      } <span class="hljs-keyword">else</span> {&#13;
        result +=&#13;
            <span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">char</span>&gt;(std::<span class="hljs-built_in">tolower</span>(<span class="hljs-built_in">static_cast</span>&lt;<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>&gt;(c)));&#13;
      }&#13;
    }&#13;
  }&#13;
&#13;
  <span class="hljs-comment">// å¦‚æœç»“æœä¸ºç©ºï¼ˆæ¯”å¦‚è¾“å…¥å…¨æ˜¯ä¸‹åˆ’çº¿ï¼‰ï¼Œè¿”å›ç©ºä¸²</span>&#13;
  <span class="hljs-keyword">return</span> result;&#13;
}&#13;
&#13;
<span class="hljs-function">vector&lt;string&gt; <span class="hljs-title">QueryTableName</span><span class="hljs-params">(sqlite3* db)</span> </span>{&#13;
  vector&lt;string&gt; tableNames;&#13;
&#13;
  <span class="hljs-comment">// è·å–æ‰€æœ‰ç”¨æˆ·è¡¨</span>&#13;
  <span class="hljs-type">const</span> <span class="hljs-type">char</span>* sqlTables =&#13;
      <span class="hljs-string">"SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE "</span>&#13;
      <span class="hljs-string">"'sqlite_%';"</span>;&#13;
&#13;
  sqlite3_stmt* stmtTables;&#13;
  <span class="hljs-type">int</span> rc = <span class="hljs-built_in">sqlite3_prepare_v2</span>(db, sqlTables, <span class="hljs-number">-1</span>, &amp;stmtTables, <span class="hljs-literal">nullptr</span>);&#13;
&#13;
  <span class="hljs-keyword">if</span> (rc != SQLITE_OK) {&#13;
    std::cerr &lt;&lt; <span class="hljs-string">"Failed to fetch tables: "</span> &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db) &lt;&lt; <span class="hljs-string">"\n"</span>;&#13;
    <span class="hljs-keyword">return</span> tableNames;&#13;
  }&#13;
&#13;
  <span class="hljs-keyword">while</span> (<span class="hljs-built_in">sqlite3_step</span>(stmtTables) == SQLITE_ROW) {&#13;
    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* tableNameCstr =&#13;
        <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">const</span> <span class="hljs-type">char</span>*&gt;(<span class="hljs-built_in">sqlite3_column_text</span>(stmtTables, <span class="hljs-number">0</span>));&#13;
&#13;
    <span class="hljs-keyword">if</span> (!tableNameCstr) <span class="hljs-keyword">continue</span>;&#13;
&#13;
    tableNames.<span class="hljs-built_in">emplace_back</span>(tableNameCstr);&#13;
  }&#13;
  <span class="hljs-built_in">sqlite3_finalize</span>(stmtTables);&#13;
&#13;
  <span class="hljs-keyword">return</span> tableNames;&#13;
}&#13;
&#13;
<span class="hljs-function">string <span class="hljs-title">Read2String</span><span class="hljs-params">(filesystem::path&amp; filePath)</span> </span>{&#13;
  <span class="hljs-function">std::ifstream <span class="hljs-title">infile</span><span class="hljs-params">(filePath)</span></span>;&#13;
  <span class="hljs-keyword">if</span> (!infile) {&#13;
    <span class="hljs-keyword">return</span> {};&#13;
  }&#13;
  <span class="hljs-keyword">return</span> {(std::<span class="hljs-built_in">istreambuf_iterator</span>&lt;<span class="hljs-type">char</span>&gt;(infile)),&#13;
          std::<span class="hljs-built_in">istreambuf_iterator</span>&lt;<span class="hljs-type">char</span>&gt;()};&#13;
}&#13;
&#13;
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">WriteTableName</span><span class="hljs-params">(filesystem::path&amp; tableNameFile,&#13;
                    <span class="hljs-type">const</span> vector&lt;string&gt;&amp; tableNames)</span> </span>{&#13;
  std::ostringstream memStream;&#13;
&#13;
  memStream &lt;&lt; <span class="hljs-string">"#pragma once\n"</span>;&#13;
  memStream &lt;&lt; <span class="hljs-string">"\n"</span>;&#13;
  memStream &lt;&lt; <span class="hljs-string">"namespace Persistence {\n"</span>;&#13;
  memStream &lt;&lt; <span class="hljs-string">"\n"</span>;&#13;
  memStream &lt;&lt; <span class="hljs-string">"enum class TableName {\n"</span>;&#13;
&#13;
  <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; tableNames.<span class="hljs-built_in">size</span>(); ++i) {&#13;
    string line;&#13;
    <span class="hljs-keyword">if</span> (i == tableNames.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>) {&#13;
      line = std::format(<span class="hljs-string">"  {}\n"</span>, tableNames[i]);&#13;
    } <span class="hljs-keyword">else</span> {&#13;
      line = std::format(<span class="hljs-string">"  {},\n"</span>, tableNames[i]);&#13;
    }&#13;
    memStream &lt;&lt; line;&#13;
  }&#13;
  memStream &lt;&lt; <span class="hljs-string">"};\n"</span>;&#13;
  memStream &lt;&lt; <span class="hljs-string">"\n"</span>;&#13;
  memStream &lt;&lt; <span class="hljs-string">"}"</span>;&#13;
&#13;
  <span class="hljs-keyword">if</span> (memStream.<span class="hljs-built_in">str</span>() == <span class="hljs-built_in">Read2String</span>(tableNameFile)) {&#13;
    <span class="hljs-keyword">return</span>;&#13;
  }&#13;
&#13;
  <span class="hljs-function">ofstream <span class="hljs-title">file</span><span class="hljs-params">(tableNameFile)</span></span>;&#13;
  <span class="hljs-keyword">if</span> (!file) {&#13;
    std::cerr &lt;&lt; <span class="hljs-string">"Failed to open file '"</span> &lt;&lt; tableNameFile.<span class="hljs-built_in">generic_string</span>()&#13;
              &lt;&lt; <span class="hljs-string">"' for writing.\n"</span>;&#13;
    <span class="hljs-keyword">return</span>;&#13;
  }&#13;
&#13;
  file &lt;&lt; memStream.<span class="hljs-built_in">str</span>();&#13;
}&#13;
&#13;
<span class="hljs-function">vector&lt;string&gt; <span class="hljs-title">QueryFiledName</span><span class="hljs-params">(sqlite3* db, <span class="hljs-type">const</span> string&amp; tableName)</span> </span>{&#13;
  vector&lt;string&gt; filedNames;&#13;
&#13;
  <span class="hljs-type">const</span> string&amp; sql = <span class="hljs-string">"PRAGMA table_info("</span> + tableName + <span class="hljs-string">");"</span>;&#13;
  sqlite3_stmt* stmt;&#13;
  <span class="hljs-type">int</span> rc = <span class="hljs-built_in">sqlite3_prepare_v2</span>(db, sql.<span class="hljs-built_in">c_str</span>(), <span class="hljs-number">-1</span>, &amp;stmt, <span class="hljs-literal">nullptr</span>);&#13;
  <span class="hljs-keyword">if</span> (rc != SQLITE_OK) {&#13;
    std::cerr &lt;&lt; <span class="hljs-string">"Failed to get schema for table '"</span> &lt;&lt; tableName.<span class="hljs-built_in">c_str</span>()&#13;
              &lt;&lt; <span class="hljs-string">"': "</span> &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db) &lt;&lt; <span class="hljs-string">"\n"</span>;&#13;
    <span class="hljs-keyword">return</span> filedNames;&#13;
  }&#13;
&#13;
  <span class="hljs-keyword">while</span> (<span class="hljs-built_in">sqlite3_step</span>(stmt) == SQLITE_ROW) {&#13;
    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* col_name = <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">const</span> <span class="hljs-type">char</span>*&gt;(&#13;
        <span class="hljs-built_in">sqlite3_column_text</span>(stmt, <span class="hljs-number">1</span>));  <span class="hljs-comment">// ç¬¬1åˆ—æ˜¯name</span>&#13;
&#13;
    <span class="hljs-keyword">if</span> (col_name) {&#13;
      filedNames.<span class="hljs-built_in">emplace_back</span>(col_name);&#13;
    }&#13;
  }&#13;
&#13;
  <span class="hljs-built_in">sqlite3_finalize</span>(stmt);&#13;
&#13;
  <span class="hljs-keyword">return</span> filedNames;&#13;
}&#13;
&#13;
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">WriteFiledName</span><span class="hljs-params">(filesystem::path&amp; outSourceDir, <span class="hljs-type">const</span> string&amp; fileName,&#13;
                    <span class="hljs-type">const</span> vector&lt;string&gt;&amp; filedNames)</span> </span>{&#13;
  std::ostringstream memStream;&#13;
&#13;
  memStream &lt;&lt; <span class="hljs-string">"#pragma once\n"</span>;&#13;
  memStream &lt;&lt; <span class="hljs-string">"\n"</span>;&#13;
  memStream &lt;&lt; <span class="hljs-string">"namespace Persistence {\n"</span>;&#13;
  memStream &lt;&lt; <span class="hljs-string">"\n"</span>;&#13;
  memStream &lt;&lt; std::format(<span class="hljs-string">"enum class {} {{\n"</span>, fileName);&#13;
&#13;
  <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; filedNames.<span class="hljs-built_in">size</span>(); ++i) {&#13;
    string line;&#13;
    <span class="hljs-keyword">if</span> (i == filedNames.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>) {&#13;
      line = std::format(<span class="hljs-string">"  {}\n"</span>, filedNames[i]);&#13;
    } <span class="hljs-keyword">else</span> {&#13;
      line = std::format(<span class="hljs-string">"  {},\n"</span>, filedNames[i]);&#13;
    }&#13;
    memStream &lt;&lt; line;&#13;
  }&#13;
  memStream &lt;&lt; <span class="hljs-string">"};\n"</span>;&#13;
  memStream &lt;&lt; <span class="hljs-string">"\n"</span>;&#13;
  memStream &lt;&lt; <span class="hljs-string">"}"</span>;&#13;
&#13;
  filesystem::path filedNameFile = outSourceDir / (fileName + <span class="hljs-string">".h"</span>);&#13;
  <span class="hljs-keyword">if</span> (memStream.<span class="hljs-built_in">str</span>() == <span class="hljs-built_in">Read2String</span>(filedNameFile)) {&#13;
    <span class="hljs-keyword">return</span>;&#13;
  }&#13;
&#13;
  <span class="hljs-function">ofstream <span class="hljs-title">file</span><span class="hljs-params">(filedNameFile)</span></span>;&#13;
  <span class="hljs-keyword">if</span> (!file) {&#13;
    std::cerr &lt;&lt; <span class="hljs-string">"Failed to open file '"</span> &lt;&lt; filedNameFile.<span class="hljs-built_in">generic_string</span>()&#13;
              &lt;&lt; <span class="hljs-string">"' for writing.\n"</span>;&#13;
    <span class="hljs-keyword">return</span>;&#13;
  }&#13;
&#13;
  file &lt;&lt; memStream.<span class="hljs-built_in">str</span>();&#13;
}&#13;
&#13;
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span>* argv[])</span> </span>{&#13;
<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> _WIN32</span>&#13;
  <span class="hljs-built_in">SetConsoleOutputCP</span>(<span class="hljs-number">65001</span>);&#13;
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>&#13;
&#13;
  <span class="hljs-comment">//</span>&#13;
  <span class="hljs-keyword">if</span> (argc != <span class="hljs-number">3</span>) {&#13;
    std::cerr &lt;&lt; <span class="hljs-string">"Usage: "</span> &lt;&lt; argv[<span class="hljs-number">0</span>]&#13;
              &lt;&lt; <span class="hljs-string">" &lt;database_path&gt; &lt;output_directory&gt;\n"</span>;&#13;
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;&#13;
  }&#13;
&#13;
  <span class="hljs-comment">//</span>&#13;
  <span class="hljs-type">const</span> <span class="hljs-type">char</span>* dbPath = argv[<span class="hljs-number">1</span>];&#13;
  <span class="hljs-type">const</span> <span class="hljs-type">char</span>* outputDir = argv[<span class="hljs-number">2</span>];&#13;
  std::cout &lt;&lt; <span class="hljs-string">"Generating DB schema enums...\n"</span>;&#13;
  std::cout &lt;&lt; <span class="hljs-string">"  DB Path: "</span> &lt;&lt; dbPath &lt;&lt; <span class="hljs-string">"\n"</span>;&#13;
  std::cout &lt;&lt; <span class="hljs-string">"  Output : "</span> &lt;&lt; outputDir &lt;&lt; <span class="hljs-string">"\n"</span>;&#13;
  filesystem::path outSourceDir{outputDir};&#13;
&#13;
  sqlite3* db;&#13;
  <span class="hljs-type">int</span> rc = <span class="hljs-built_in">sqlite3_open</span>(dbPath, &amp;db);&#13;
&#13;
  <span class="hljs-keyword">if</span> (rc != SQLITE_OK) {&#13;
    std::cerr &lt;&lt; <span class="hljs-string">"Cannot open database: "</span> &lt;&lt; <span class="hljs-built_in">sqlite3_errmsg</span>(db) &lt;&lt; <span class="hljs-string">"\n"</span>;&#13;
    <span class="hljs-built_in">sqlite3_close</span>(db);&#13;
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;&#13;
  }&#13;
&#13;
  vector&lt;string&gt; tableNames = <span class="hljs-built_in">QueryTableName</span>(db);&#13;
  filesystem::path tableNameFile = outSourceDir / <span class="hljs-string">"TableName.h"</span>;&#13;
  <span class="hljs-built_in">WriteTableName</span>(tableNameFile, tableNames);&#13;
&#13;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> tableName : tableNames) {&#13;
    string fileName = <span class="hljs-string">"Table"</span> + <span class="hljs-built_in">ToPascalCase</span>(tableName) + <span class="hljs-string">"Field"</span>;&#13;
    <span class="hljs-built_in">WriteFiledName</span>(outSourceDir, fileName, <span class="hljs-built_in">QueryFiledName</span>(db, tableName));&#13;
  }&#13;
&#13;
  <span class="hljs-built_in">sqlite3_close</span>(db);&#13;
&#13;
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#13;
}
</code></pre>
<p>ä»£ç è™½ç„¶å¾ˆé•¿ï¼Œä½†æ˜¯å®ç°æ€è·¯å¾ˆç®€å•ï¼šæ—¢ç„¶è¦ä¿è¯ SQLite3 æ•°æ®åº“ä¸­çš„è¡¨æ ¼æ•°æ®ä¸æ˜ å°„çš„æšä¸¾ç±»ä¸€è‡´ï¼Œé‚£å°±è®©è¿™äº›æšä¸¾ç±»ä»£ç åœ¨æ„å»ºä¹‹å‰é€šè¿‡è¿™ä¸ª <code>Script/DbSchemaGenerator.cpp</code> å·¥å…·ç”Ÿæˆå°±å¯ä»¥äº†ï¼Œæ•°æ®åº“è¡¨çš„åç§°å’Œå­—æ®µåéƒ½å¯ä»¥é€šè¿‡è°ƒç”¨ç›¸åº”çš„ SQL è¯­å¥æ¥å®ç°ã€‚å½“ç„¶ï¼Œè¿™éœ€è¦å€ŸåŠ©äºæ„å»ºç³»ç»Ÿï¼Œå¯å‚ç…§<a href="https://link.juejin.cn?target=https%3A%2F%2Fcharlee44.com%2Fpost.html%3Fid%3D421b07cc6a3146b0852d6b7d42ffba6c" target="_blank" title="https://charlee44.com/post.html?id=421b07cc6a3146b0852d6b7d42ffba6c" ref="nofollow noopener noreferrer">ã€ŠCMake æ„å»ºå­¦ä¹ ç¬”è®° 31-æ„å»ºå‰æ‰§è¡Œå¯æ‰§è¡Œç¨‹åºã€‹</a>ã€‚</p>
<h3 data-id="heading-7">3.2 JOIN æŸ¥è¯¢</h3>
<p>å½“å‰ <code>Util::Statement::Query</code> åªæ”¯æŒ å•è¡¨æŸ¥è¯¢ï¼ˆFROM tableï¼‰ï¼Œé‚£ä¹ˆå¤æ‚çš„ JOIN æŸ¥è¯¢å¦‚ä½•å®ç°å‘¢ï¼Ÿä¸€èˆ¬æ¥è¯´ï¼Œ JOIN æ¶‰åŠå¤šè¡¨ã€åˆ«åã€å¤æ‚ SELECT åˆ—ç­‰ï¼Œæ— æ³•ç›´æ¥ç”¨â€œå­—æ®µæšä¸¾åˆ—è¡¨â€ç®€å•è¡¨è¾¾ï¼Œä¹Ÿå¾ˆéš¾ç”¨ä¸€ä¸ªå‡½æ•°ç”Ÿæˆæ‰€æœ‰ JOIN SQL ã€‚æœ€å¥½çš„åŠæ³•æ˜¯ä¸¤ç§æ–¹æ¡ˆå¹¶è¡Œï¼š</p>
<ol>
<li>ç®€å•å•è¡¨ CRUD : ç»§ç»­ç”¨ç°æœ‰çš„å®ç°ã€‚</li>
<li>å¤æ‚æŸ¥è¯¢ï¼ˆå« JOIN / å­æŸ¥è¯¢ / èšåˆï¼‰ï¼šå…è®¸æ‰‹å†™ SQL å­—ç¬¦ä¸²ï¼Œä½†å¤ç”¨ä½ å·²æœ‰çš„ QueryRows æ‰§è¡Œå¼•æ“ã€‚</li>
</ol>
<p>åœ¨ä¸»æµ Java åç«¯æ¡†æ¶ï¼ˆSpring Data JPAã€MyBatisï¼‰ä¸­ï¼Œè¿™ç§â€œç®€å•æ“ä½œç”¨ ORM è‡ªåŠ¨ç”Ÿæˆï¼Œå¤æ‚æŸ¥è¯¢å…è®¸æ‰‹å†™ SQLâ€çš„æ··åˆç­–ç•¥æ˜¯ä¸€ç§å¹¿æ³›é‡‡çº³çš„æœ€ä½³å®è·µã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šåœ¨å¼€å‘æ•ˆç‡ä¸æ§åˆ¶åŠ›ä¹‹é—´å–å¾—å¹³è¡¡â€”â€”æ—¢äº«å— ORM å¸¦æ¥çš„ç±»å‹å®‰å…¨ã€ä»£ç ç®€æ´å’Œå¿«é€Ÿå¼€å‘ä¼˜åŠ¿ï¼Œåˆä¸ç‰ºç‰²å¯¹å¤æ‚ SQL åœºæ™¯çš„å®Œå…¨æŒæ§èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-8">4. è¡¥å……</h2>
<p>ç¬”è€…çš„è¿™æ®µå®ç°åªèƒ½ç®—æ˜¯åŠè‡ªåŠ¨çš„ ORM é£æ ¼å°è£…ï¼Œæ²¡æœ‰å®ç°å…¨è‡ªåŠ¨çš„å¯¹è±¡ä¸æ•°æ®åº“è¡¨çš„æ˜ å°„ï¼ˆæ¯”å¦‚ä¸èƒ½ç›´æ¥ä¼ ä¸€ä¸ª <code>User</code> å¯¹è±¡å°±è‡ªåŠ¨æ’å…¥ï¼‰ï¼Œä½†å®ƒç¡®å®ä½“ç°äº†ä¸€äº› ORM çš„å…¸å‹è®¾è®¡æ€è·¯ï¼š</p>








































<table><thead><tr><th>ORM ç‰¹æ€§</th><th>æ˜¯å¦ä½“ç°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>âœ… <strong>éšè—åŸå§‹ SQL å­—ç¬¦ä¸²æ‹¼æ¥</strong></td><td>âœ”ï¸</td><td>ä½¿ç”¨ <code>Util::Statement</code> è‡ªåŠ¨ç”Ÿæˆå¸¦å ä½ç¬¦çš„ SQL</td></tr><tr><td>âœ… <strong>å‚æ•°ç»‘å®šé˜²æ³¨å…¥</strong></td><td>âœ”ï¸</td><td>å…¨éƒ¨ä½¿ç”¨ <code>sqlite3_bind_*</code>ï¼Œå®‰å…¨</td></tr><tr><td>âœ… <strong>å­—æ®µåç±»å‹å®‰å…¨</strong></td><td>âœ”ï¸</td><td>ç”¨æšä¸¾ + <code>magic_enum</code> ä»£æ›¿å­—ç¬¦ä¸² <code>"name"</code>ï¼Œé¿å…æ‹¼é”™</td></tr><tr><td>âœ… <strong>CRUD æŠ½è±¡ä¸ºå‡½æ•°</strong></td><td>âœ”ï¸</td><td><code>InsertRow</code>, <code>QueryRows</code> ç­‰æä¾›ç»Ÿä¸€æ¥å£</td></tr><tr><td>âŒ <strong>å¯¹è±¡è‡ªåŠ¨æ˜ å°„</strong></td><td>âœ–ï¸</td><td>ä»éœ€æ‰‹åŠ¨æ„é€  <code>vector</code>ï¼Œä¸èƒ½ç›´æ¥ä¼ å¯¹è±¡</td></tr><tr><td>âŒ <strong>è‡ªåŠ¨ç”Ÿæˆ SQLï¼ˆåŸºäºå¯¹è±¡ï¼‰</strong></td><td>âœ–ï¸</td><td>SQL ç”±å·¥å…·å‡½æ•°ç”Ÿæˆï¼Œä½†éœ€æ˜¾å¼æŒ‡å®šå­—æ®µåˆ—è¡¨</td></tr></tbody></table>
<p>ä¸åŒçš„ç¼–ç¨‹è¯­è¨€æœ‰ç€å„è‡ªé€‚ç”¨çš„ç¼–ç¨‹èŒƒå¼ï¼Œç›²ç›®ç…§æ¬å…¶ä»–ç”Ÿæ€çš„å…¨è‡ªåŠ¨ ORM æ¨¡å¼å¹¶ä¸å¯å–â€”â€”å®ƒä¸ä»…å¯èƒ½å¼•å…¥ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ï¼Œè¿˜å¯èƒ½ä¸è¯­è¨€ç‰¹æ€§æ ¼æ ¼ä¸å…¥ã€‚å½’æ ¹ç»“åº•ï¼Œåªè¦èƒ½ä»¥åˆç†ã€å®‰å…¨ä¸”å¯ç»´æŠ¤çš„æ–¹å¼è§£å†³é—®é¢˜ï¼Œå°±æ˜¯å¥½çš„è®¾è®¡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RxJavaï¼šå“åº”å¼ç¼–ç¨‹]]></title>    <link>https://juejin.cn/post/7587254134401810441</link>    <guid>https://juejin.cn/post/7587254134401810441</guid>    <pubDate>2025-12-25T00:58:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587254134401810441" data-draft-id="7587246055457357851" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RxJavaï¼šå“åº”å¼ç¼–ç¨‹"/> <meta itemprop="keywords" content="RxJava"/> <meta itemprop="datePublished" content="2025-12-25T00:58:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RxJavaï¼šå“åº”å¼ç¼–ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T00:58:36.000Z" title="Thu Dec 25 2025 00:58:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡æ·±å…¥è®²è§£ReactiveXæ——ä¸‹çš„RxJavaæ¡†æ¶ï¼Œä»æ ¸å¿ƒæ¦‚å¿µåˆ°å®æˆ˜åº”ç”¨ï¼Œå¸®åŠ©ä½ æŒæ¡å“åº”å¼ç¼–ç¨‹çš„ç²¾é«“ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€å¼•è¨€ï¼šä¸ºä»€ä¹ˆé€‰æ‹©RxJava</h2>
<p>åœ¨ç°ä»£è½¯ä»¶å¼€å‘ä¸­,å¼‚æ­¥ç¼–ç¨‹å·²æˆä¸ºå¿…ä¸å¯å°‘çš„æŠ€èƒ½ã€‚ä¼ ç»Ÿçš„å›è°ƒã€çº¿ç¨‹ç®¡ç†å¤æ‚ç­‰é—®é¢˜ä¸€ç›´å›°æ‰°ç€å¼€å‘è€…ã€‚<strong>RxJava</strong>(Reactive Extensions for Java)æä¾›äº†ä¸€ç§ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆ,è®©å¼‚æ­¥ç¼–ç¨‹å˜å¾—ç®€å•è€Œå¼ºå¤§ã€‚</p>
<h2 data-id="heading-1">RxJavaçš„æ ¸å¿ƒä¼˜åŠ¿</h2>
<pre><code class="hljs">å£°æ˜å¼ç¼–ç¨‹ - ä»¥æ•°æ®æµçš„æ–¹å¼æè¿°ä¸šåŠ¡é€»è¾‘
é“¾å¼è°ƒç”¨ - æ“ä½œç¬¦ç»„åˆ,ä»£ç ç®€æ´æ˜“è¯»
å¼ºå¤§çš„æ“ä½œç¬¦ - 100+æ“ä½œç¬¦æ»¡è¶³å„ç§åœºæ™¯
çº¿ç¨‹è°ƒåº¦çµæ´» - è½»æ¾åˆ‡æ¢æ‰§è¡Œçº¿ç¨‹
é”™è¯¯å¤„ç†ä¼˜é›… - ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†æœºåˆ¶
èƒŒå‹æ”¯æŒ - Flowableå¤„ç†æ•°æ®æµé€Ÿæ§åˆ¶
</code></pre>
<h2 data-id="heading-2">äºŒã€æ ¸å¿ƒæ¶æ„è§£æ</h2>
<p>RxJavaåŸºäºè§‚å¯Ÿè€…æ¨¡å¼,é‡‡ç”¨å“åº”å¼ç¼–ç¨‹æ€æƒ³,æ ¸å¿ƒç”±å››å¤§ç»„ä»¶æ„æˆã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41543a16fd8d41d89e952a4f3d5bbb60~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229115&amp;x-signature=BP9x7etaZ9DWyREWCQtxUXXoVZA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">æ ¸å¿ƒç»„ä»¶è¯¦è§£</h2>
<p><strong>Observable(è¢«è§‚å¯Ÿè€…)</strong></p>
<p>æ•°æ®æº,è´Ÿè´£å‘å°„æ•°æ®æµã€‚Observableæ˜¯æ•´ä¸ªå“åº”å¼æµçš„èµ·ç‚¹,å®ƒè´Ÿè´£äº§ç”Ÿæ•°æ®å¹¶å‘é€ç»™è®¢é˜…è€…ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">publicabstractclassObservable&lt;T&gt; 
    implementsObservableSource&lt;T&gt; {

    <span class="hljs-built_in">publicfinalvoidsubscribe</span>(
        Observer&lt;? super T&gt; observer) {
        <span class="hljs-built_in">subscribeActual</span>(observer);
    }
    <span class="hljs-built_in">protectedabstractvoidsubscribeActual</span>(
        Observer&lt;? super T&gt; observer);
}
</code></pre>
<p><strong>Observer(è§‚å¯Ÿè€…)</strong></p>
<p>æ•°æ®æ¶ˆè´¹è€…,æ¥æ”¶å¹¶å¤„ç†æ•°æ®ã€‚Observerå®šä¹‰äº†å››ä¸ªæ ¸å¿ƒæ–¹æ³•æ¥å¤„ç†æ•°æ®æµçš„ä¸åŒçŠ¶æ€ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">Observer</span>&lt;<span class="hljs-title">T</span>&gt; {
    <span class="hljs-comment">// è®¢é˜…å¼€å§‹</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">onSubscribe</span>(<span class="hljs-params">Disposable d</span>)</span>;

    <span class="hljs-comment">// æ¥æ”¶æ•°æ®</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">onNext</span>(<span class="hljs-params">T t</span>)</span>;

    <span class="hljs-comment">// å‘ç”Ÿé”™è¯¯</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">onError</span>(<span class="hljs-params">Throwable e</span>)</span>;

    <span class="hljs-comment">// å®Œæˆ</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">onComplete</span>()</span>;
}
</code></pre>
<p><strong>Operators(æ“ä½œç¬¦)</strong></p>
<p>ç”¨äºè½¬æ¢ã€è¿‡æ»¤ã€ç»„åˆæ•°æ®æµçš„ä¸­é—´æ“ä½œã€‚æ“ä½œç¬¦æ˜¯RxJavaçš„ç²¾é«“,æä¾›äº†ä¸°å¯Œçš„æ•°æ®å¤„ç†èƒ½åŠ›ã€‚</p>
<p><strong>Schedulers(è°ƒåº¦å™¨)</strong></p>
<p>æ§åˆ¶Observableå’ŒObserveråœ¨å“ªä¸ªçº¿ç¨‹æ‰§è¡Œ,å®ç°çµæ´»çš„çº¿ç¨‹è°ƒåº¦ã€‚</p>
<h2 data-id="heading-4">æ•°æ®æµç±»å‹</h2>
<p>RxJava 3æä¾›äº†5ç§ä¸»è¦çš„æ•°æ®æµç±»å‹,æ¯ç§ç±»å‹é€‚ç”¨äºä¸åŒçš„åœºæ™¯ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">Observable - å‘å°„<span class="hljs-number">0</span>åˆ°Nä¸ªæ•°æ®é¡¹,ä¸æ”¯æŒèƒŒå‹,é€‚ç”¨äºé€šç”¨åœºæ™¯
Flowable - å‘å°„<span class="hljs-number">0</span>åˆ°Nä¸ªæ•°æ®é¡¹,æ”¯æŒèƒŒå‹,é€‚ç”¨äºå¤§æ•°æ®é‡åœºæ™¯
<span class="hljs-type">Single</span> - åªå‘å°„<span class="hljs-number">1</span>ä¸ªæ•°æ®é¡¹,é€‚ç”¨äºå•ä¸€ç»“æœåœºæ™¯å¦‚ç½‘ç»œè¯·æ±‚
Maybe - å‘å°„<span class="hljs-number">0</span>æˆ–<span class="hljs-number">1</span>ä¸ªæ•°æ®é¡¹,é€‚ç”¨äºå¯èƒ½æœ‰ç»“æœçš„åœºæ™¯
Completable - ä¸å‘å°„æ•°æ®,åªå…³å¿ƒå®ŒæˆçŠ¶æ€
</code></pre>
<h2 data-id="heading-5">ä¸‰ã€å¿«é€Ÿä¸Šæ‰‹ï¼šåŸºç¡€ç”¨æ³•</h2>
<h2 data-id="heading-6">åˆ›å»ºObservableçš„å¤šç§æ–¹å¼</h2>
<p><strong>æ–¹å¼1ï¼šjust - å‘å°„å›ºå®šçš„æ•°æ®é¡¹</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">Observable&lt;<span class="hljs-type">String</span>&gt; observable1 = 
    Observable.<span class="hljs-built_in">just</span>(<span class="hljs-string">"Hello"</span>, <span class="hljs-string">"RxJava"</span>);
</code></pre>
<p><strong>æ–¹å¼2ï¼šfrom - ä»æ•°ç»„æˆ–é›†åˆåˆ›å»º</strong></p>
<pre><code class="hljs language-ini" lang="ini">List&lt;Integer&gt; <span class="hljs-attr">numbers</span> = Arrays.asList(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>)<span class="hljs-comment">;</span>
Observable&lt;Integer&gt; <span class="hljs-attr">observable2</span> = 
    Observable.fromIterable(numbers)<span class="hljs-comment">;</span>
</code></pre>
<p><strong>æ–¹å¼3ï¼šcreate - è‡ªå®šä¹‰å‘å°„é€»è¾‘</strong></p>
<pre><code class="hljs language-ini" lang="ini">Observable&lt;String&gt; <span class="hljs-attr">observable3</span> = 
    Observable.create(emitter -&gt; {
        emitter.onNext("Data 1")<span class="hljs-comment">;</span>
        emitter.onNext("Data 2")<span class="hljs-comment">;</span>
        emitter.onComplete()<span class="hljs-comment">;</span>
    })<span class="hljs-comment">;</span>
</code></pre>
<p><strong>æ–¹å¼4ï¼šinterval - å®šæ—¶å‘å°„</strong></p>
<pre><code class="hljs language-ini" lang="ini">Observable&lt;Long&gt; <span class="hljs-attr">observable4</span> = 
    Observable.interval(1, TimeUnit.SECONDS)<span class="hljs-comment">;</span>
</code></pre>
<p><strong>æ–¹å¼5ï¼šrange - å‘å°„ä¸€ç³»åˆ—æ•´æ•°</strong></p>
<pre><code class="hljs language-ini" lang="ini">Observable&lt;Integer&gt; <span class="hljs-attr">observable5</span> = 
    Observable.range(1, 10)<span class="hljs-comment">;</span>
</code></pre>
<h2 data-id="heading-7">è®¢é˜…Observable</h2>
<p>å®Œæ•´çš„è®¢é˜…ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title class_">Observable</span>.<span class="hljs-title function_">just</span>(<span class="hljs-string">"Apple"</span>, <span class="hljs-string">"Banana"</span>, <span class="hljs-string">"Orange"</span>)
    .<span class="hljs-title function_">subscribe</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>&lt;<span class="hljs-title class_">String</span>&gt;() {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onSubscribe</span>(<span class="hljs-params">Disposable d</span>) {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å¼€å§‹è®¢é˜…"</span>);
        }
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onNext</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> item</span>) {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"æ”¶åˆ°æ•°æ®: "</span> + item);
        }
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onError</span>(<span class="hljs-params">Throwable e</span>) {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">err</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å‘ç”Ÿé”™è¯¯: "</span> 
                + e.<span class="hljs-title function_">getMessage</span>());
        }
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onComplete</span>(<span class="hljs-params"/>) {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"å®Œæˆ"</span>);
        }
    });
</code></pre>
<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">å¼€å§‹è®¢é˜…æ”¶åˆ°æ•°æ®: Appleæ”¶åˆ°æ•°æ®: Bananaæ”¶åˆ°æ•°æ®: Orangeå®Œæˆ</span>
</code></pre>
<h2 data-id="heading-8">ç®€åŒ–çš„è®¢é˜…æ–¹å¼</h2>
<p>å®é™…å¼€å‘ä¸­,æˆ‘ä»¬ç»å¸¸ä½¿ç”¨Lambdaè¡¨è¾¾å¼ç®€åŒ–è®¢é˜…ä»£ç ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åªå¤„ç†onNext</span>
Observable.just(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
    .subscribe(item -&gt; System.out.<span class="hljs-built_in">println</span>(item));
<span class="hljs-comment">// å¤„ç†onNextå’ŒonError</span>
Observable.just(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
    .subscribe(
        item -&gt; System.out.<span class="hljs-built_in">println</span>(item),
        <span class="hljs-type">error</span> -&gt; System.err.<span class="hljs-built_in">println</span>(<span class="hljs-type">error</span>)
    );
<span class="hljs-comment">// å¤„ç†onNextã€onErrorå’ŒonComplete</span>
Observable.just(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
    .subscribe(
        item -&gt; System.out.<span class="hljs-built_in">println</span>(item),
        <span class="hljs-type">error</span> -&gt; System.err.<span class="hljs-built_in">println</span>(<span class="hljs-type">error</span>),
        () -&gt; System.out.<span class="hljs-built_in">println</span>(<span class="hljs-string">"å®Œæˆ"</span>)
    );
</code></pre>
<h2 data-id="heading-9">å››ã€æ“ä½œç¬¦è¯¦è§£ï¼šæ•°æ®å˜æ¢çš„è‰ºæœ¯</h2>
<p>æ“ä½œç¬¦æ˜¯RxJavaçš„æ ¸å¿ƒ,æŒæ¡å¸¸ç”¨æ“ä½œç¬¦æ˜¯ä½¿ç”¨RxJavaçš„å…³é”®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b1e3e59377d45e9b282f665f77832e2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229115&amp;x-signature=tI9WOEJpRy2LU%2FuLGhsutJhtTXM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-10">åˆ›å»ºæ“ä½œç¬¦</h2>
<p>åˆ›å»ºæ“ä½œç¬¦ç”¨äºç”ŸæˆObservableæ•°æ®æºï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// just - å‘å°„é¢„å®šä¹‰çš„æ•°æ®é¡¹</span>
Observable<span class="hljs-selector-class">.just</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);
<span class="hljs-comment">// fromArray - ä»æ•°ç»„åˆ›å»º</span>
Integer<span class="hljs-selector-attr">[]</span> array = {<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>};
Observable<span class="hljs-selector-class">.fromArray</span>(array);
<span class="hljs-comment">// fromCallable - å»¶è¿Ÿæ‰§è¡Œ</span>
Observable<span class="hljs-selector-class">.fromCallable</span>(() -&gt; {
    <span class="hljs-comment">// åªæœ‰è®¢é˜…æ—¶æ‰æ‰§è¡Œ</span>
    return <span class="hljs-built_in">expensiveOperation</span>();
});
<span class="hljs-comment">// defer - ä¸ºæ¯ä¸ªè®¢é˜…è€…åˆ›å»ºæ–°çš„Observable</span>
Observable<span class="hljs-selector-class">.defer</span>(() -&gt; 
    Observable<span class="hljs-selector-class">.just</span>(System.currentTimeMillis()));
</code></pre>
<h2 data-id="heading-11">è½¬æ¢æ“ä½œç¬¦</h2>
<p><strong>map - ä¸€å¯¹ä¸€è½¬æ¢</strong></p>
<p>æœ€å¸¸ç”¨çš„è½¬æ¢æ“ä½œç¬¦,å°†æ¯ä¸ªæ•°æ®é¡¹è½¬æ¢ä¸ºå¦ä¸€ç§å½¢å¼ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Observable<span class="hljs-selector-class">.just</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>)
    <span class="hljs-selector-class">.map</span>(number -&gt; number * <span class="hljs-number">2</span>)
    <span class="hljs-selector-class">.subscribe</span>(System.out::println);
<span class="hljs-comment">// è¾“å‡º: 2, 4, 6, 8, 10</span>
</code></pre>
<p><strong>flatMap - ä¸€å¯¹å¤šè½¬æ¢å¹¶åˆå¹¶</strong></p>
<p>é€‚ç”¨äºéœ€è¦ä¸ºæ¯ä¸ªæ•°æ®é¡¹å‘èµ·å¼‚æ­¥æ“ä½œçš„åœºæ™¯ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åœºæ™¯ï¼šæœç´¢ç”¨æˆ·å¹¶è·å–æ¯ä¸ªç”¨æˆ·çš„è®¢å•</span>
Observable.just(<span class="hljs-string">"user1"</span>, <span class="hljs-string">"user2"</span>, <span class="hljs-string">"user3"</span>)
    .flatMap(userId -&gt; {
        <span class="hljs-comment">// ä¸ºæ¯ä¸ªç”¨æˆ·å‘èµ·ç½‘ç»œè¯·æ±‚</span>
        <span class="hljs-keyword">return</span> getUserOrders(userId);
    })
    .subscribe(order -&gt; 
        System.<span class="hljs-keyword">out</span>.println(order));
</code></pre>
<p><strong>concatMap - é¡ºåºçš„flatMap</strong></p>
<p>å½“éœ€è¦ä¿è¯æ‰§è¡Œé¡ºåºæ—¶ä½¿ç”¨concatMapï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Observable<span class="hljs-selector-class">.just</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
    <span class="hljs-selector-class">.concatMap</span>(i -&gt; Observable.just(i * <span class="hljs-number">10</span>)
        <span class="hljs-selector-class">.delay</span>(<span class="hljs-number">100</span>, TimeUnit.MILLISECONDS))
    <span class="hljs-selector-class">.subscribe</span>(System.out::println);
<span class="hljs-comment">// è¾“å‡ºä¸¥æ ¼æŒ‰é¡ºåº: 10, 20, 30</span>
</code></pre>
<h2 data-id="heading-12">è¿‡æ»¤æ“ä½œç¬¦</h2>
<p>è¿‡æ»¤æ“ä½œç¬¦ç”¨äºç­›é€‰æ•°æ®æµä¸­çš„æ•°æ®ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// filter - è¿‡æ»¤æ•°æ®</span>
Observable<span class="hljs-selector-class">.range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>)
    <span class="hljs-selector-class">.filter</span>(number -&gt; number % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>)
    <span class="hljs-selector-class">.subscribe</span>(System.out::println);
<span class="hljs-comment">// è¾“å‡º: 2, 4, 6, 8, 10</span>
<span class="hljs-comment">// take - åªå–å‰Nä¸ª</span>
Observable<span class="hljs-selector-class">.range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>)
    <span class="hljs-selector-class">.take</span>(<span class="hljs-number">5</span>)
    <span class="hljs-selector-class">.subscribe</span>(System.out::println);
<span class="hljs-comment">// è¾“å‡º: 1, 2, 3, 4, 5</span>
<span class="hljs-comment">// skip - è·³è¿‡å‰Nä¸ª</span>
Observable<span class="hljs-selector-class">.range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>)
    <span class="hljs-selector-class">.skip</span>(<span class="hljs-number">5</span>)
    <span class="hljs-selector-class">.subscribe</span>(System.out::println);
<span class="hljs-comment">// è¾“å‡º: 6, 7, 8, 9, 10</span>
<span class="hljs-comment">// distinct - å»é‡</span>
Observable<span class="hljs-selector-class">.just</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>)
    <span class="hljs-selector-class">.distinct</span>()
    <span class="hljs-selector-class">.subscribe</span>(System.out::println);
<span class="hljs-comment">// è¾“å‡º: 1, 2, 3, 4</span>
</code></pre>
<p><strong>debounce - é˜²æŠ–(æœç´¢æ¡†å¸¸ç”¨)</strong></p>
<p>åœ¨ç”¨æˆ·åœæ­¢è¾“å…¥ä¸€æ®µæ—¶é—´åæ‰è§¦å‘æœç´¢,é¿å…é¢‘ç¹è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Observable<span class="hljs-selector-class">.create</span>(emitter -&gt; {
    emitter.onNext("a");
    Thread<span class="hljs-selector-class">.sleep</span>(<span class="hljs-number">100</span>);
    emitter<span class="hljs-selector-class">.onNext</span>("ab");
    Thread<span class="hljs-selector-class">.sleep</span>(<span class="hljs-number">100</span>);
    emitter<span class="hljs-selector-class">.onNext</span>("abc");
    Thread<span class="hljs-selector-class">.sleep</span>(<span class="hljs-number">500</span>); <span class="hljs-comment">// åœé¡¿è¶…è¿‡300ms</span>
    emitter<span class="hljs-selector-class">.onComplete</span>();
})
<span class="hljs-selector-class">.debounce</span>(<span class="hljs-number">300</span>, TimeUnit.MILLISECONDS)
<span class="hljs-selector-class">.subscribe</span>(System.out::println);
<span class="hljs-comment">// åªè¾“å‡º: abc</span>
</code></pre>
<h2 data-id="heading-13">ç»„åˆæ“ä½œç¬¦</h2>
<p>ç»„åˆæ“ä½œç¬¦ç”¨äºåˆå¹¶å¤šä¸ªæ•°æ®æºï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// merge - åˆå¹¶å¤šä¸ªObservable
Observable&lt;String&gt; <span class="hljs-attr">obs1</span> = Observable.just(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>)<span class="hljs-comment">;</span>
Observable&lt;String&gt; <span class="hljs-attr">obs2</span> = Observable.just(<span class="hljs-string">"C"</span>, <span class="hljs-string">"D"</span>)<span class="hljs-comment">;</span>
Observable.merge(obs1, obs2)
    .subscribe(System.out::println)<span class="hljs-comment">;</span>
// è¾“å‡º: A, B, C, D(é¡ºåºä¸ä¿è¯)
// zip - ç»„åˆå¯¹åº”ä½ç½®çš„æ•°æ®
Observable&lt;Integer&gt; <span class="hljs-attr">numbers</span> = 
    Observable.just(1, 2, 3)<span class="hljs-comment">;</span>
Observable&lt;String&gt; <span class="hljs-attr">letters</span> = 
    Observable.just("A", "B", "C")<span class="hljs-comment">;</span>
Observable.zip(numbers, letters,
    (number, letter) -&gt; number + letter)
    .subscribe(System.out::println)<span class="hljs-comment">;</span>
// è¾“å‡º: 1A, 2B, 3C
// combineLatest - ä»»ä¸€æ•°æ®æºå˜åŒ–æ—¶ç»„åˆæœ€æ–°å€¼
Observable&lt;Long&gt; <span class="hljs-attr">timer1</span> = 
    Observable.interval(1, TimeUnit.SECONDS)<span class="hljs-comment">;</span>
Observable&lt;Long&gt; <span class="hljs-attr">timer2</span> = 
    Observable.interval(2, TimeUnit.SECONDS)<span class="hljs-comment">;</span>
Observable.combineLatest(timer1, timer2,
    (t1, t2) -&gt; "T1:" + t1 + " T2:" + t2)
    .subscribe(System.out::println)<span class="hljs-comment">;</span>
</code></pre>
<h2 data-id="heading-14">é”™è¯¯å¤„ç†æ“ä½œç¬¦</h2>
<p>ä¼˜é›…çš„é”™è¯¯å¤„ç†æ˜¯RxJavaçš„ä¸€å¤§ä¼˜åŠ¿ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// onErrorReturn - é”™è¯¯æ—¶è¿”å›é»˜è®¤å€¼</span>
Observable.<span class="hljs-title function_ invoke__">create</span>(emitter -&gt; {
    emitter.<span class="hljs-title function_ invoke__">onNext</span>(<span class="hljs-number">1</span>);
    emitter.<span class="hljs-title function_ invoke__">onNext</span>(<span class="hljs-number">2</span>);
    emitter.<span class="hljs-title function_ invoke__">onError</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">"å‡ºé”™äº†"</span>));
})
.<span class="hljs-title function_ invoke__">onErrorReturn</span>(throwable -&gt; -<span class="hljs-number">1</span>)
.<span class="hljs-title function_ invoke__">subscribe</span>(System.out::<span class="hljs-variable constant_">println</span>);
<span class="hljs-comment">// è¾“å‡º: 1, 2, -1</span>
<span class="hljs-comment">// onErrorResumeNext - é”™è¯¯æ—¶åˆ‡æ¢åˆ°å¦ä¸€ä¸ªObservable</span>
Observable.<span class="hljs-title function_ invoke__">create</span>(emitter -&gt; {
    emitter.<span class="hljs-title function_ invoke__">onNext</span>(<span class="hljs-string">"A"</span>);
    emitter.<span class="hljs-title function_ invoke__">onError</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">"å‡ºé”™"</span>));
})
.<span class="hljs-title function_ invoke__">onErrorResumeNext</span>(Observable.<span class="hljs-title function_ invoke__">just</span>(<span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>))
.<span class="hljs-title function_ invoke__">subscribe</span>(System.out::<span class="hljs-variable constant_">println</span>);
<span class="hljs-comment">// è¾“å‡º: A, B, C</span>
<span class="hljs-comment">// retry - é‡è¯•</span>
AtomicInteger count = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);
Observable.<span class="hljs-title function_ invoke__">create</span>(emitter -&gt; {
    <span class="hljs-keyword">int</span> attempt = count.<span class="hljs-title function_ invoke__">incrementAndGet</span>();
    System.out.<span class="hljs-title function_ invoke__">println</span>(<span class="hljs-string">"å°è¯•æ¬¡æ•°: "</span> + attempt);
    <span class="hljs-keyword">if</span> (attempt &lt; <span class="hljs-number">3</span>) {
        emitter.<span class="hljs-title function_ invoke__">onError</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">"å¤±è´¥"</span>));
    } <span class="hljs-keyword">else</span> {
        emitter.<span class="hljs-title function_ invoke__">onNext</span>(<span class="hljs-string">"æˆåŠŸ"</span>);
        emitter.<span class="hljs-title function_ invoke__">onComplete</span>();
    }
})
.<span class="hljs-title function_ invoke__">retry</span>(<span class="hljs-number">3</span>)
.<span class="hljs-title function_ invoke__">subscribe</span>(System.out::<span class="hljs-variable constant_">println</span>);
</code></pre>
<h2 data-id="heading-15">äº”ã€çº¿ç¨‹è°ƒåº¦ï¼šæŒæ§å¼‚æ­¥æ‰§è¡Œ</h2>
<p>åˆç†çš„çº¿ç¨‹è°ƒåº¦æ˜¯ä¿è¯åº”ç”¨æ€§èƒ½çš„å…³é”®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb071d1ad42248888b67dd88baf8f96b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229115&amp;x-signature=sBUfoH7pYnz0CowPVfnDVTGCG3E%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-16">Schedulersç±»å‹</h2>
<p>RxJavaæä¾›äº†å¤šç§è°ƒåº¦å™¨,æ¯ç§é€‚ç”¨äºä¸åŒçš„åœºæ™¯ï¼š</p>
<p><strong>Schedulers.io() - IOå¯†é›†å‹ä»»åŠ¡</strong></p>
<p>é€‚ç”¨äºç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å†™ç­‰IOæ“ä½œï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Observable<span class="hljs-selector-class">.fromCallable</span>(() -&gt; {
    <span class="hljs-comment">// ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å†™</span>
    return <span class="hljs-built_in">downloadFile</span>();
})
<span class="hljs-selector-class">.subscribeOn</span>(Schedulers.io())
<span class="hljs-selector-class">.subscribe</span>(result -&gt; System.out.println(result));
</code></pre>
<p><strong>Schedulers.computation() - è®¡ç®—å¯†é›†å‹</strong></p>
<p>é€‚ç”¨äºCPUå¯†é›†å‹è®¡ç®—ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Observable<span class="hljs-selector-class">.range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1000000</span>)
    <span class="hljs-selector-class">.map</span>(i -&gt; i * i)
    <span class="hljs-selector-class">.subscribeOn</span>(Schedulers.computation())
    <span class="hljs-selector-class">.subscribe</span>();
</code></pre>
<p><strong>Schedulers.newThread() - æ¯æ¬¡åˆ›å»ºæ–°çº¿ç¨‹</strong></p>
<pre><code class="hljs language-scss" lang="scss">Observable<span class="hljs-selector-class">.just</span>(<span class="hljs-number">1</span>)
    <span class="hljs-selector-class">.subscribeOn</span>(Schedulers.newThread())
    <span class="hljs-selector-class">.subscribe</span>();
</code></pre>
<p><strong>Schedulers.single() - å•çº¿ç¨‹æ‰§è¡Œ</strong></p>
<pre><code class="hljs language-scss" lang="scss">Observable<span class="hljs-selector-class">.just</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
    <span class="hljs-selector-class">.subscribeOn</span>(Schedulers.single())
    <span class="hljs-selector-class">.subscribe</span>();
</code></pre>
<p><strong>AndroidSchedulers.mainThread() - Androidä¸»çº¿ç¨‹</strong></p>
<p>åœ¨Androidå¼€å‘ä¸­æ›´æ–°UIæ—¶ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">Observable.<span class="hljs-built_in">just</span>(<span class="hljs-string">"æ›´æ–°UI"</span>)
    .<span class="hljs-built_in">observeOn</span>(AndroidSchedulers.<span class="hljs-built_in">mainThread</span>())
    .<span class="hljs-built_in">subscribe</span>(text -&gt; textView.<span class="hljs-built_in">setText</span>(text));
</code></pre>
<h2 data-id="heading-17">subscribeOn vs observeOn</h2>
<p>ç†è§£è¿™ä¸¤ä¸ªæ–¹æ³•çš„åŒºåˆ«æ˜¯æŒæ¡çº¿ç¨‹è°ƒåº¦çš„å…³é”®ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">Observable</span><span class="hljs-selector-class">.just</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
    <span class="hljs-selector-class">.subscribeOn</span>(Schedulers.<span class="hljs-built_in">io</span>())        
    <span class="hljs-comment">// æŒ‡å®šæ•°æ®æºåœ¨IOçº¿ç¨‹</span>
    <span class="hljs-selector-class">.map</span>(number -&gt; {
        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"mapçº¿ç¨‹: "</span> +
            Thread.<span class="hljs-built_in">currentThread</span>().<span class="hljs-built_in">getName</span>());
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">number</span> * <span class="hljs-number">2</span>;
    })
    <span class="hljs-selector-class">.observeOn</span>(Schedulers.<span class="hljs-built_in">computation</span>()) 
    <span class="hljs-comment">// åˆ‡æ¢åˆ°è®¡ç®—çº¿ç¨‹</span>
    <span class="hljs-selector-class">.filter</span>(number -&gt; {
        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"filterçº¿ç¨‹: "</span> +
            Thread.<span class="hljs-built_in">currentThread</span>().<span class="hljs-built_in">getName</span>());
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">number</span> &gt; <span class="hljs-number">2</span>;
    })
    <span class="hljs-selector-class">.observeOn</span>(Schedulers.<span class="hljs-built_in">newThread</span>())   
    <span class="hljs-comment">// å†æ¬¡åˆ‡æ¢çº¿ç¨‹</span>
    <span class="hljs-selector-class">.subscribe</span>(number -&gt; {
        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"subscribeçº¿ç¨‹: "</span> +
            Thread.<span class="hljs-built_in">currentThread</span>().<span class="hljs-built_in">getName</span>());
        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"ç»“æœ: "</span> + number);
    });
</code></pre>
<p><strong>å…³é”®åŒºåˆ«ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss">subscribeOn - æŒ‡å®šObservableè‡ªèº«åœ¨å“ªä¸ªçº¿ç¨‹æ‰§è¡Œ(åªæœ‰ç¬¬ä¸€æ¬¡æœ‰æ•ˆ)
observeOn - æŒ‡å®šåç»­æ“ä½œåœ¨å“ªä¸ªçº¿ç¨‹æ‰§è¡Œ(å¯å¤šæ¬¡ä½¿ç”¨)
</code></pre>
<h2 data-id="heading-18">å…­ã€å®æˆ˜åº”ç”¨ï¼šç»“åˆRetrofit</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b4add11d9ab44a3eb8267a80702bf922~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229115&amp;x-signature=o8%2FzQhx%2BtYLJNOZXpZug75R063o%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-19">ç½‘ç»œè¯·æ±‚ - ç»“åˆRetrofit</h2>
<p><strong>APIæ¥å£å®šä¹‰ï¼š</strong></p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">interface</span> <span class="hljs-selector-tag">ApiService</span> {
    <span class="hljs-variable">@GET</span>(<span class="hljs-string">"users/{id}"</span>)
    Single&lt;User&gt; <span class="hljs-built_in">getUser</span>(<span class="hljs-variable">@Path</span>(<span class="hljs-string">"id"</span>) int userId);
    <span class="hljs-variable">@GET</span>(<span class="hljs-string">"users/{id}/posts"</span>)
    Observable&lt;List&lt;Post&gt;&gt; <span class="hljs-built_in">getUserPosts</span>(
        <span class="hljs-variable">@Path</span>(<span class="hljs-string">"id"</span>) int userId);
}
</code></pre>
<p><strong>Retrofité…ç½®ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">NetworkModule</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ApiService apiService;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ApiService <span class="hljs-title">getApiService</span>()</span> {
        <span class="hljs-keyword">if</span> (apiService == <span class="hljs-literal">null</span>) {
            Retrofit retrofit = <span class="hljs-keyword">new</span> Retrofit.Builder()
                .baseUrl(<span class="hljs-string">"https://api.example.com/"</span>)
                .addConverterFactory(
                    GsonConverterFactory.create())
                .addCallAdapterFactory(
                    RxJava3CallAdapterFactory.create())
                .build();
            apiService = retrofit.create(ApiService.<span class="hljs-keyword">class</span>);
        }
        <span class="hljs-keyword">return</span> apiService;
    }
}
</code></pre>
<p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserRepository</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ApiService apiService;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">CompositeDisposable</span> <span class="hljs-variable">disposables</span> <span class="hljs-operator">=</span> 
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">CompositeDisposable</span>();
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserRepository</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>.apiService = NetworkModule.getApiService();
    }
    <span class="hljs-comment">// è·å–ç”¨æˆ·ä¿¡æ¯</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadUser</span><span class="hljs-params">(<span class="hljs-type">int</span> userId, 
                         Consumer&lt;User&gt; onSuccess,
                         Consumer&lt;Throwable&gt; onError)</span> {
        <span class="hljs-type">Disposable</span> <span class="hljs-variable">disposable</span> <span class="hljs-operator">=</span> apiService.getUser(userId)
            .subscribeOn(Schedulers.io())
            .observeOn(AndroidSchedulers.mainThread())
            .subscribe(onSuccess, onError);
        disposables.add(disposable);
    }
    <span class="hljs-comment">// æ¸…ç†è®¢é˜…</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span> {
        disposables.clear();
    }
}
</code></pre>
<h2 data-id="heading-20">æœç´¢é˜²æŠ–</h2>
<p>å®ç°æ™ºèƒ½æœç´¢,é¿å…é¢‘ç¹è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">public class SearchActivity extends AppCompatActivity {
    private EditText searchEditText;
    private final CompositeDisposable disposables = 
        new <span class="hljs-built_in">CompositeDisposable</span>();
    <span class="hljs-keyword">@Override</span>
    protected void onCreate(Bundle savedInstanceState) {
        super<span class="hljs-selector-class">.onCreate</span>(savedInstanceState);
        <span class="hljs-built_in">setContentView</span>(R.layout.activity_search);
        searchEditText = 
            <span class="hljs-built_in">findViewById</span>(R.id.search_edit_text);
        <span class="hljs-comment">// ç›‘å¬æœç´¢æ¡†è¾“å…¥</span>
        Disposable disposable = 
            RxTextView<span class="hljs-selector-class">.textChanges</span>(searchEditText)
            <span class="hljs-selector-class">.debounce</span>(<span class="hljs-number">500</span>, TimeUnit.MILLISECONDS)  
            <span class="hljs-comment">// é˜²æŠ–500ms</span>
            <span class="hljs-selector-class">.filter</span>(text -&gt; text.length() &gt;= <span class="hljs-number">2</span>)     
            <span class="hljs-comment">// è‡³å°‘2ä¸ªå­—ç¬¦</span>
            <span class="hljs-selector-class">.distinctUntilChanged</span>()                 
            <span class="hljs-comment">// å†…å®¹å˜åŒ–æ‰è§¦å‘</span>
            <span class="hljs-selector-class">.subscribeOn</span>(Schedulers.io())
            <span class="hljs-selector-class">.observeOn</span>(AndroidSchedulers.mainThread())
            <span class="hljs-selector-class">.subscribe</span>(text -&gt; {
                // æ‰§è¡Œæœç´¢
                performSearch(text.toString());
            });
        disposables<span class="hljs-selector-class">.add</span>(disposable);
    }
    private void <span class="hljs-built_in">performSearch</span>(String keyword) {
        apiService<span class="hljs-selector-class">.search</span>(keyword)
            <span class="hljs-selector-class">.subscribeOn</span>(Schedulers.io())
            <span class="hljs-selector-class">.observeOn</span>(AndroidSchedulers.mainThread())
            <span class="hljs-selector-class">.subscribe</span>(
                results -&gt; updateSearchResults(results),
                error -&gt; <span class="hljs-built_in">showError</span>(error)
            );
    }
    <span class="hljs-keyword">@Override</span>
    protected void onDestroy() {
        super<span class="hljs-selector-class">.onDestroy</span>();
        disposables<span class="hljs-selector-class">.clear</span>();  <span class="hljs-comment">// é˜²æ­¢å†…å­˜æ³„æ¼</span>
    }
}
</code></pre>
<h2 data-id="heading-21">å¤šæ•°æ®æºåˆå¹¶</h2>
<p>åŒæ—¶åŠ è½½å¤šä¸ªæ•°æ®æº,ç­‰å¾…å…¨éƒ¨å®Œæˆåç»Ÿä¸€å¤„ç†ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">public class HomeRepository {
    <span class="hljs-comment">// åŒæ—¶åŠ è½½å¤šä¸ªæ•°æ®æº</span>
    public Single&lt;HomeData&gt; <span class="hljs-built_in">loadHomeData</span>() {
        Single&lt;User&gt; userSingle = 
            apiService<span class="hljs-selector-class">.getCurrentUser</span>();
        Single&lt;List&lt;Post&gt;&gt; postsSingle = 
            apiService<span class="hljs-selector-class">.getLatestPosts</span>();
        Single&lt;List&lt;Notification&gt;&gt; notificationsSingle =
            apiService<span class="hljs-selector-class">.getNotifications</span>();
        return Single<span class="hljs-selector-class">.zip</span>(userSingle, 
                         postsSingle, 
                         notificationsSingle,
            (user, posts, notifications) -&gt;
                new <span class="hljs-built_in">HomeData</span>(user, posts, notifications))
            <span class="hljs-selector-class">.subscribeOn</span>(Schedulers.io())
            <span class="hljs-selector-class">.observeOn</span>(AndroidSchedulers.mainThread());
    }
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a441ea846544883a9e57a4e46cbac8c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229115&amp;x-signature=BAyWDYAFKXqmoCPzq%2B%2FU2z6r8GM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-22">å®šæ—¶åˆ·æ–°</h2>
<p>å®ç°è‡ªåŠ¨åˆ·æ–°åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RefreshManager</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Disposable</span> refreshDisposable;
    <span class="hljs-comment">// æ¯30ç§’è‡ªåŠ¨åˆ·æ–°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">startAutoRefresh</span>(<span class="hljs-params">Runnable refreshAction</span>) {
        refreshDisposable = 
            <span class="hljs-title class_">Observable</span>.<span class="hljs-title function_">interval</span>(<span class="hljs-number">30</span>, <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">SECONDS</span>)
            .<span class="hljs-title function_">subscribeOn</span>(<span class="hljs-title class_">Schedulers</span>.<span class="hljs-title function_">io</span>())
            .<span class="hljs-title function_">observeOn</span>(<span class="hljs-title class_">AndroidSchedulers</span>.<span class="hljs-title function_">mainThread</span>())
            .<span class="hljs-title function_">subscribe</span>(tick -&gt; refreshAction.<span class="hljs-title function_">run</span>());
    }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">stopAutoRefresh</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">if</span> (refreshDisposable != <span class="hljs-literal">null</span> &amp;&amp; 
            !refreshDisposable.<span class="hljs-title function_">isDisposed</span>()) {
            refreshDisposable.<span class="hljs-title function_">dispose</span>();
        }
    }
}
</code></pre>
<h2 data-id="heading-23">ä¸ƒã€æœ€ä½³å®è·µï¼šé¿å‘æŒ‡å—</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/774cc09f9f5a4438bfdddd2c764f83d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229115&amp;x-signature=jwyY7IuxWFoR8erZqe9YfjMGdow%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-24">ç®¡ç†è®¢é˜… - ä½¿ç”¨CompositeDisposable</h2>
<p><strong>æ­£ç¡®åšæ³•ï¼š</strong></p>
<pre><code class="hljs language-scala" lang="scala">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AppCompatActivity</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">CompositeDisposable</span> disposables = 
        <span class="hljs-keyword">new</span> <span class="hljs-type">CompositeDisposable</span>();
    <span class="hljs-keyword">private</span> void loadData() {
        <span class="hljs-type">Disposable</span> disposable = observable
            .subscribe(data -&gt; process(data));
        disposables.add(disposable);
    }
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> void onDestroy() {
        <span class="hljs-keyword">super</span>.onDestroy();
        disposables.clear();  <span class="hljs-comment">// æ¸…ç†æ‰€æœ‰è®¢é˜…</span>
    }
}
</code></pre>
<h2 data-id="heading-25">ç»Ÿä¸€çš„é”™è¯¯å¤„ç†</h2>
<p>åˆ›å»ºä¸€ä¸ªç»Ÿä¸€çš„é”™è¯¯å¤„ç†å™¨ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RxErrorHandler</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Consumer&lt;Throwable&gt; <span class="hljs-title function_">handleError</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> throwable -&gt; {
            <span class="hljs-keyword">if</span> (throwable <span class="hljs-keyword">instanceof</span> IOException) {
                <span class="hljs-comment">// ç½‘ç»œé”™è¯¯</span>
                showToast(<span class="hljs-string">"ç½‘ç»œè¿æ¥å¤±è´¥"</span>);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (throwable <span class="hljs-keyword">instanceof</span> HttpException) {
                <span class="hljs-comment">// HTTPé”™è¯¯</span>
                <span class="hljs-type">int</span> <span class="hljs-variable">code</span> <span class="hljs-operator">=</span> 
                    ((HttpException) throwable).code();
                showToast(<span class="hljs-string">"æœåŠ¡å™¨é”™è¯¯: "</span> + code);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// å…¶ä»–é”™è¯¯</span>
                showToast(<span class="hljs-string">"å‘ç”ŸæœªçŸ¥é”™è¯¯"</span>);
            }
            <span class="hljs-comment">// è®°å½•æ—¥å¿—</span>
            Log.e(<span class="hljs-string">"RxError"</span>, <span class="hljs-string">"Error occurred"</span>, throwable);
        };
    }
}
<span class="hljs-comment">// ä½¿ç”¨</span>
observable.subscribe(
    data -&gt; process(data),
    RxErrorHandler.handleError()
);
</code></pre>
<h2 data-id="heading-26">æ“ä½œç¬¦é€‰æ‹©</h2>
<p>æ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„æ“ä½œç¬¦ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// flatMap - ä¸ä¿è¯é¡ºåº,é€‚åˆå¹¶å‘</span>
<span class="hljs-selector-tag">Observable</span><span class="hljs-selector-class">.just</span>(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>)
    <span class="hljs-selector-class">.flatMap</span>(item -&gt; <span class="hljs-built_in">processAsync</span>(item))
    <span class="hljs-selector-class">.subscribe</span>();
<span class="hljs-comment">// concatMap - ä¿è¯é¡ºåº,é€‚åˆé¡ºåºæ‰§è¡Œ</span>
<span class="hljs-selector-tag">Observable</span><span class="hljs-selector-class">.just</span>(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>)
    <span class="hljs-selector-class">.concatMap</span>(item -&gt; <span class="hljs-built_in">processAsync</span>(item))
    <span class="hljs-selector-class">.subscribe</span>();
<span class="hljs-comment">// switchMap - åªä¿ç•™æœ€æ–°çš„,é€‚åˆæœç´¢</span>
<span class="hljs-selector-tag">searchObservable</span>
    <span class="hljs-selector-class">.switchMap</span>(keyword -&gt; apiService.<span class="hljs-built_in">search</span>(keyword))
    <span class="hljs-selector-class">.subscribe</span>();
</code></pre>
<h2 data-id="heading-27">èƒŒå‹å¤„ç†</h2>
<p>å¤„ç†å¤§æ•°æ®é‡æ—¶ä½¿ç”¨Flowableï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Flowable<span class="hljs-selector-class">.range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1000000</span>)
    <span class="hljs-selector-class">.onBackpressureBuffer</span>(<span class="hljs-number">100</span>)  <span class="hljs-comment">// ç¼“å†²åŒº</span>
    <span class="hljs-selector-class">.observeOn</span>(Schedulers.computation(), false, <span class="hljs-number">10</span>)
    <span class="hljs-selector-class">.subscribe</span>(
        data -&gt; process(data),
        error -&gt; <span class="hljs-built_in">handleError</span>(error)
    );
<span class="hljs-comment">// èƒŒå‹ç­–ç•¥</span>
Flowable<span class="hljs-selector-class">.create</span>(emitter -&gt; {
    for (int i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
        emitter<span class="hljs-selector-class">.onNext</span>(i);
    }
    emitter<span class="hljs-selector-class">.onComplete</span>();
}, BackpressureStrategy<span class="hljs-selector-class">.DROP</span>)  <span class="hljs-comment">// ä¸¢å¼ƒç­–ç•¥</span>
<span class="hljs-selector-class">.subscribe</span>();
</code></pre>
<h2 data-id="heading-28">å…«ã€æ€»ç»“</h2>
<p>RxJavaæ ¸å¿ƒè¦ç‚¹</p>
<pre><code class="hljs">å“åº”å¼æ€ç»´ - ä»¥æ•°æ®æµçš„æ–¹å¼æ€è€ƒé—®é¢˜
æ“ä½œç¬¦é“¾ - çµæ´»ç»„åˆæ“ä½œç¬¦å®Œæˆå¤æ‚é€»è¾‘
çº¿ç¨‹è°ƒåº¦ - åˆç†ä½¿ç”¨subscribeOnå’ŒobserveOn
è®¢é˜…ç®¡ç† - åŠæ—¶disposeé¿å…å†…å­˜æ³„æ¼
é”™è¯¯å¤„ç† - ä½¿ç”¨ä¸“é—¨çš„é”™è¯¯å¤„ç†æ“ä½œç¬¦
èƒŒå‹æ§åˆ¶ - å¤§æ•°æ®é‡åœºæ™¯ä½¿ç”¨Flowable
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼‚å¸¸çš„ â€œéšè—ä¼ é€’â€ï¼šfinally ä¸­çš„ return ä¼šåå™¬å¼‚å¸¸ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7587245616755163187</link>    <guid>https://juejin.cn/post/7587245616755163187</guid>    <pubDate>2025-12-25T01:08:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587245616755163187" data-draft-id="7585206549305884735" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼‚å¸¸çš„ â€œéšè—ä¼ é€’â€ï¼šfinally ä¸­çš„ return ä¼šåå™¬å¼‚å¸¸ï¼Ÿ"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-25T01:08:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="uup"/> <meta itemprop="url" content="https://juejin.cn/user/4378706456356627"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼‚å¸¸çš„ â€œéšè—ä¼ é€’â€ï¼šfinally ä¸­çš„ return ä¼šåå™¬å¼‚å¸¸ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4378706456356627/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    uup
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T01:08:45.000Z" title="Thu Dec 25 2025 01:08:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€Bug åœºæ™¯</h2>
<p>åœ¨ä¸€ä¸ª Java ç¨‹åºä¸­ï¼Œå¼€å‘äººå‘˜åœ¨Â <code>try - catch - finally</code>Â å—ä¸­ç¼–å†™äº†ä¸šåŠ¡é€»è¾‘ã€‚åŸæœ¬æœŸæœ›Â <code>try</code>Â å—ä¸­æŠ›å‡ºçš„å¼‚å¸¸èƒ½å¤Ÿè¢«æ­£ç¡®æ•è·å¹¶å¤„ç†ï¼Œä½†åœ¨å®é™…è¿è¡Œæ—¶ï¼Œå‘ç°Â <code>finally</code>Â å—ä¸­çš„Â <code>return</code>Â è¯­å¥å¯¼è‡´å¼‚å¸¸ä¼¼ä¹è¢« â€œåå™¬â€ï¼Œç¨‹åºæ²¡æœ‰æŒ‰ç…§é¢„æœŸå¤„ç†å¼‚å¸¸ï¼Œè¿™ä½¿å¾—æ’æŸ¥å’Œè§£å†³é—®é¢˜å˜å¾—å›°éš¾ï¼Œä¹Ÿå½±å“äº†ç¨‹åºçš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</p>
<h2 data-id="heading-1">äºŒã€ä»£ç ç¤ºä¾‹</h2>
<h3 data-id="heading-2">å¼‚å¸¸å¤„ç†ç±»ï¼ˆæœ‰ç¼ºé™·ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExceptionHidingExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">divide</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> a / b;
        } <span class="hljs-keyword">catch</span> (ArithmeticException e) {
            System.out.println(<span class="hljs-string">"æ•è·åˆ°ç®—æœ¯å¼‚å¸¸: "</span> + e.getMessage());
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å¤„ç†ç®—æœ¯å¼‚å¸¸æ—¶æŠ›å‡ºæ–°å¼‚å¸¸"</span>, e);
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// è¿™é‡Œçš„returnè¯­å¥ä¼šéšè—tryæˆ–catchå—ä¸­æŠ›å‡ºçš„å¼‚å¸¸</span>
            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>; 
        }
    }
}
</code></pre>
<h3 data-id="heading-3">æµ‹è¯•ä»£ç </h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExceptionHidingBugExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> ExceptionHidingExample.divide(<span class="hljs-number">10</span>, <span class="hljs-number">0</span>);
            System.out.println(<span class="hljs-string">"ç»“æœ: "</span> + result);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            System.out.println(<span class="hljs-string">"å¤–éƒ¨æ•è·åˆ°å¼‚å¸¸: "</span> + e.getMessage());
        }
    }
}
</code></pre>
<h2 data-id="heading-4">ä¸‰ã€é—®é¢˜æè¿°</h2>
<ol>
<li><strong>é¢„æœŸè¡Œä¸º</strong>ï¼šå½“Â <code>divide</code>Â æ–¹æ³•æ‰§è¡ŒÂ <code>a / b</code>Â å‡ºç°Â <code>ArithmeticException</code>Â æ—¶ï¼Œ<code>catch</code>Â å—æ•è·å¹¶å¤„ç†è¯¥å¼‚å¸¸ï¼Œç„¶åæŠ›å‡ºä¸€ä¸ªæ–°çš„Â <code>RuntimeException</code>ï¼Œè¿™ä¸ªæ–°å¼‚å¸¸åº”è¯¥è¢«å¤–éƒ¨çš„Â <code>try - catch</code>Â å—æ•è·å¹¶å¤„ç†ï¼Œè¾“å‡ºç›¸åº”çš„é”™è¯¯ä¿¡æ¯ã€‚</li>
<li><strong>å®é™…è¡Œä¸º</strong>ï¼š<code>finally</code>Â å—ä¸­çš„Â <code>return</code>Â è¯­å¥ä½¿å¾—Â <code>try</code>Â æˆ–Â <code>catch</code>Â å—ä¸­æŠ›å‡ºçš„å¼‚å¸¸è¢« â€œéšè—â€ã€‚å°½ç®¡Â <code>catch</code>Â å—æ•è·äº†Â <code>ArithmeticException</code>Â å¹¶æŠ›å‡ºäº†æ–°çš„Â <code>RuntimeException</code>ï¼Œä½†ç”±äºÂ <code>finally</code>Â å—ä¸­çš„Â <code>return -1</code>Â è¯­å¥ï¼Œè¿™ä¸ªæ–°çš„Â <code>RuntimeException</code>Â æ²¡æœ‰è¢«ä¼ é€’åˆ°å¤–éƒ¨çš„Â <code>try - catch</code>Â å—ï¼Œå¯¼è‡´å¤–éƒ¨æ•è·ä¸åˆ°å¼‚å¸¸ï¼Œç¨‹åºè¾“å‡ºçš„ç»“æœæ˜¯Â <code>ç»“æœ: -1</code>ã€‚è¿™æ˜¯å› ä¸ºåœ¨æ‰§è¡ŒÂ <code>finally</code>Â å—ä¸­çš„Â <code>return</code>Â è¯­å¥æ—¶ï¼Œ<code>try</code>Â æˆ–Â <code>catch</code>Â å—ä¸­æŠ›å‡ºçš„å¼‚å¸¸ä¿¡æ¯ä¼šè¢«ä¸¢å¼ƒï¼Œæœ€ç»ˆè¿”å›çš„æ˜¯Â <code>finally</code>Â å—ä¸­çš„Â <code>return</code>Â å€¼ï¼Œä»è€Œéšè—äº†å¼‚å¸¸ã€‚</li>
</ol>
<h2 data-id="heading-5">å››ã€è§£å†³æ–¹æ¡ˆ</h2>
<ol>
<li><strong>é¿å…åœ¨Â <code>finally</code>Â ä¸­ä½¿ç”¨Â <code>return</code></strong>ï¼šå°†Â <code>return</code>Â è¯­å¥æ”¾åœ¨Â <code>try</code>Â æˆ–Â <code>catch</code>Â å—ä¸­åˆé€‚çš„ä½ç½®ï¼Œç¡®ä¿å¼‚å¸¸èƒ½å¤Ÿæ­£å¸¸ä¼ é€’ã€‚</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExceptionHidingExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">divide</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> a / b;
        } <span class="hljs-keyword">catch</span> (ArithmeticException e) {
            System.out.println(<span class="hljs-string">"æ•è·åˆ°ç®—æœ¯å¼‚å¸¸: "</span> + e.getMessage());
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å¤„ç†ç®—æœ¯å¼‚å¸¸æ—¶æŠ›å‡ºæ–°å¼‚å¸¸"</span>, e);
        }
    }
}
</code></pre>
<h3 data-id="heading-6">ä¿®æ”¹åçš„æµ‹è¯•ä»£ç </h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExceptionHidingBugExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> ExceptionHidingExample.divide(<span class="hljs-number">10</span>, <span class="hljs-number">0</span>);
            System.out.println(<span class="hljs-string">"ç»“æœ: "</span> + result);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            System.out.println(<span class="hljs-string">"å¤–éƒ¨æ•è·åˆ°å¼‚å¸¸: "</span> + e.getMessage());
        }
    }
}
</code></pre>
<ol start="2">
<li><strong>ä½¿ç”¨è¾…åŠ©å˜é‡</strong>ï¼šåœ¨Â <code>try</code>Â æˆ–Â <code>catch</code>Â å—ä¸­è®¾ç½®ä¸€ä¸ªè¾…åŠ©å˜é‡æ¥å­˜å‚¨ç»“æœï¼Œ<code>finally</code>Â å—ä¸­ä¸ä½¿ç”¨Â <code>return</code>ï¼Œè€Œæ˜¯å¯¹è¾…åŠ©å˜é‡è¿›è¡Œæ“ä½œï¼Œè¿™æ ·å¯ä»¥ä¿è¯å¼‚å¸¸çš„æ­£å¸¸ä¼ é€’ã€‚</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExceptionHidingExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">divide</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">try</span> {
            result = a / b;
        } <span class="hljs-keyword">catch</span> (ArithmeticException e) {
            System.out.println(<span class="hljs-string">"æ•è·åˆ°ç®—æœ¯å¼‚å¸¸: "</span> + e.getMessage());
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å¤„ç†ç®—æœ¯å¼‚å¸¸æ—¶æŠ›å‡ºæ–°å¼‚å¸¸"</span>, e);
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// è¿™é‡Œå¯ä»¥å¯¹resultè¿›è¡Œå…¶ä»–éreturnçš„æ“ä½œ</span>
        }
        <span class="hljs-keyword">return</span> result;
    }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¶…è¶Š SpringBoot 4.0äº†å—ï¼ŸOpenSolon v3.8, v3.7.4, v3.6.7 å‘å¸ƒ]]></title>    <link>https://juejin.cn/post/7587245616755294259</link>    <guid>https://juejin.cn/post/7587245616755294259</guid>    <pubDate>2025-12-25T01:24:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587245616755294259" data-draft-id="7587263750249316403" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¶…è¶Š SpringBoot 4.0äº†å—ï¼ŸOpenSolon v3.8, v3.7.4, v3.6.7 å‘å¸ƒ"/> <meta itemprop="keywords" content="Java,Spring Boot"/> <meta itemprop="datePublished" content="2025-12-25T01:24:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‰é±¼çš„çŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/409464125003639"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¶…è¶Š SpringBoot 4.0äº†å—ï¼ŸOpenSolon v3.8, v3.7.4, v3.6.7 å‘å¸ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/409464125003639/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‰é±¼çš„çŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T01:24:32.000Z" title="Thu Dec 25 2025 01:24:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¯¼å¼•</h2>
<p>ï¼ˆå¬è¯´éš”å£çš„ Spring 7 å’Œ SpringBoot 4 æœ€è¿‘å‡ºäº†å‡ ä¸ªå¤§ Bugäº†ï¼Ÿï¼ï¼‰å†æ—¶ 8 å¹´ç£¨ç ºï¼Œ1.7 ä¸‡æ¬¡ä»£ç æäº¤ï¼Œ9ä¸ªåˆ†ä»“åº“ï¼Œå‡ ç™¾ä¸ªæ¨¡å—ï¼Œ20å¤šä¸‡ä»£ç é‡ï¼Œ 1200 ä¸‡æ¬¡åŠå¹´ä¸‹è½½é‡ â€”â€” OpenSolonï¼ˆå³ Solonï¼‰æ­£åœ¨é‡æ–°å®šä¹‰ Java ä¼ä¸šçº§åº”ç”¨å¼€å‘çš„æ€§ä»·æ¯”ã€‚</p>
<p>ä»Šæ—¥ï¼Œæˆ‘ä»¬æ­£å¼å‘å¸ƒ OpenSolon v3.8 åŠå…¶ LTS ç»´æŠ¤ç‰ˆæœ¬ã€‚æ˜¯ä¸€æ¬¡æ¶æ„çº§çš„è·¨è¶Šï¼šä» AI é¢†åŸŸçš„ MCP æ— çŠ¶æ€é›†ç¾¤æ”¯æŒï¼Œåˆ° Flow æµç¨‹å¼•æ“çš„å›å½’é€šç”¨åŒ–ï¼Œå†åˆ°å¯¹ Java æ–°ç‰ˆæœ¬ï¼ˆv25ï¼‰çš„è¶…å‰å¸ƒå±€ï¼ŒOpenSolon æŒç»­è·µè¡Œâ€œå¿«é€Ÿã€å°å·§ã€ç®€æ´â€çš„å…‹åˆ¶ç¾å­¦ã€‚</p>
<p>æ— è®ºä½ æ˜¯è¿½æ±‚ç®—åŠ›æ€§ä»·æ¯”çš„æè‡´ä¸»ä¹‰è€…ï¼Œè¿˜æ˜¯æ­£åœ¨å¯»æ‰¾å®‰å…¨å¯é çš„å›½äº§åŸºåº§ï¼Œè¿™æ¬¡æ›´æ–°éƒ½å€¼å¾—ä½ å…³æ³¨ã€‚</p>
<ul>
<li>ã€è¶…å‰é€‚é…ã€‘ ç‡å…ˆé€‚é… Java 25ï¼Œæ–°å¢ ScopedValue é€‚é…æ”¯æŒ</li>
<li>ã€AI å¢å¼ºã€‘ solon-ai æ·±åº¦æ”¯æŒ MCP æ— çŠ¶æ€ä¼šè¯é›†ç¾¤ä¸å¼‚æ­¥å·¥å…·</li>
<li>ã€æ¶æ„é‡æ„ã€‘ solon-flow å›å½’é€šç”¨æµç¨‹å¼•æ“ï¼Œæ¨å‡ºå…¨æ–°çš„ WorkflowService å°è£…ï¼›</li>
<li>ã€æ€§èƒ½ä¼˜åŒ–ã€‘ å…¨é¢ä¼˜åŒ–è¡¨è¾¾å¼å¼•æ“ï¼ˆSnELï¼‰ä¸ç¼“å­˜æ€§èƒ½ï¼ŒæŒç»­ä¿æŒé«˜å¹¶å‘ã€çœå†…å­˜çš„é¢†å…ˆä¼˜åŠ¿ã€‚</li>
</ul>
<h2 data-id="heading-1">OpenSolon å¼€æºæ¡†æ¶ï¼ï¼ˆä¹Ÿç§°ï¼šSolonï¼‰</h2>
<p>OpenSolon æ˜¯æ–°ä¸€ä»£ï¼ŒJava ä¼ä¸šçº§åº”ç”¨å¼€å‘æ¡†æ¶ã€‚<strong>ä»é›¶å¼€å§‹æ„å»ºï¼ˆNo Java-EEï¼‰ï¼Œæœ‰çµæ´»çš„æ¥å£è§„èŒƒä¸å¼€æ”¾ç”Ÿæ€</strong>ã€‚é‡‡ç”¨å•†ç”¨å‹å¥½çš„ Apache  2.0 å¼€æºåè®®ï¼Œæ˜¯â€œæ­å·æ— è€³ç§‘æŠ€æœ‰é™å…¬å¸â€å¼€æºçš„æ ¹çº§é¡¹ç›®ï¼Œæ˜¯ Java åº”ç”¨å¼€å‘çš„ç”Ÿæ€åŸºåº§ï¼ˆå¯æ›¿æ¢ç¾å›½åšé€šå…¬å¸çš„ Spring ç”Ÿæ€ï¼‰ã€‚</p>
<ul>
<li>è¿½æ±‚ï¼š å¿«é€Ÿã€å°å·§ã€ç®€æ´</li>
<li>æå€¡ï¼š å…‹åˆ¶ã€é«˜æ•ˆã€å¼€æ”¾</li>
</ul>
<p>7å¹´å¼€æºæ—¶é—´ï¼Œç´¯è®¡ä»£ç æäº¤1.6ä¸‡æ¬¡ ï¼Œè¿‘åŠå¹´ä¸‹è½½é‡1200ä¸‡æ¬¡ã€‚</p>
<ul>
<li>æœ‰é€æ˜å¯é¢„æœŸçš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fsolon.noear.org%2Farticle%2F687" target="_blank" title="https://solon.noear.org/article/687" ref="nofollow noopener noreferrer">ã€Šç‰ˆæœ¬å‘å¸ƒä¸é•¿æœŸæ”¯æŒè®¡åˆ’ï¼ˆLTSï¼‰ã€‹</a></li>
<li>æœ‰â€œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fsolon.noear.org%2Farticle%2Fsupport" target="_blank" title="https://solon.noear.org/article/support" ref="nofollow noopener noreferrer">ã€ç¤¾åŒºäº¤æµã€‘</a>â€å’Œâ€œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fsolon.noear.org%2Farticle%2Fservices" target="_blank" title="https://solon.noear.org/article/services" ref="nofollow noopener noreferrer">ã€ä¼ä¸šæœåŠ¡ã€‘</a>â€åŒé‡æŠ€æœ¯æ”¯æŒ</li>
</ul>
<p>åŒæ—¶æ”¯æŒè¿è¡Œæ—¶ç¯å¢ƒï¼ˆä¸åŸºäº java-ee æ„å»ºï¼Œæ‰€ä»¥å¯ä»¥åŒæ—¶å…¼å®¹ï¼‰ï¼š</p>
<ul>
<li>java8, java11, java17, java21, java25</li>
</ul>
<p>ç›®å‰æœ‰å‡ ä¸ªä¸»è¦çš„é¡¹ç›®ä»“åº“ï¼š</p>





































































<table><thead><tr><th>ä»£ç ä»“åº“</th><th>æè¿°</th></tr></thead><tbody><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fopensolon%2Fsolon" target="_blank" title="https://gitee.com/opensolon/solon" ref="nofollow noopener noreferrer">/opensolon/solon</a></td><td>Solon ,ä¸»ä»£ç ä»“åº“</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fopensolon%2Fsolon-examples" target="_blank" title="https://gitee.com/opensolon/solon-examples" ref="nofollow noopener noreferrer">/opensolon/solon-examples</a></td><td>Solon ,å®˜ç½‘é…å¥—ç¤ºä¾‹ä»£ç ä»“åº“</td></tr><tr><td/><td/></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fopensolon%2Fsolon-expression" target="_blank" title="https://gitee.com/opensolon/solon-expression" ref="nofollow noopener noreferrer">/opensolon/solon-expression</a></td><td>Solon Expression ,ä»£ç ä»“åº“</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fopensolon%2Fsolon-flow" target="_blank" title="https://gitee.com/opensolon/solon-flow" ref="nofollow noopener noreferrer">/opensolon/solon-flow</a></td><td>Solon Flow ,ä»£ç ä»“åº“</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fopensolon%2Fsolon-ai" target="_blank" title="https://gitee.com/opensolon/solon-ai" ref="nofollow noopener noreferrer">/opensolon/solon-ai</a></td><td>Solon Ai ,ä»£ç ä»“åº“</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fopensolon%2Fsolon-cloud" target="_blank" title="https://gitee.com/opensolon/solon-cloud" ref="nofollow noopener noreferrer">/opensolon/solon-cloud</a></td><td>Solon Cloud ,ä»£ç ä»“åº“</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fopensolon%2Fsolon-admin" target="_blank" title="https://gitee.com/opensolon/solon-admin" ref="nofollow noopener noreferrer">/opensolon/solon-admin</a></td><td>Solon Admin ,ä»£ç ä»“åº“</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fopensolon%2Fsolon-integration" target="_blank" title="https://gitee.com/opensolon/solon-integration" ref="nofollow noopener noreferrer">/opensolon/solon-integration</a></td><td>Solon Integration ,ä»£ç ä»“åº“</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fopensolon%2Fsolon-java17" target="_blank" title="https://gitee.com/opensolon/solon-java17" ref="nofollow noopener noreferrer">/opensolon/solon-java17</a></td><td>Solon Java17 é€‚é…ä»“åº“ï¼ˆbase java17ï¼‰</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fopensolon%2Fsolon-java25" target="_blank" title="https://gitee.com/opensolon/solon-java25" ref="nofollow noopener noreferrer">/opensolon/solon-java25</a></td><td>Solon Java25 é€‚é…ä»“åº“ï¼ˆbase java25ï¼‰</td></tr><tr><td/><td/></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fopensolon%2Fsolon-gradle-plugin" target="_blank" title="https://gitee.com/opensolon/solon-gradle-plugin" ref="nofollow noopener noreferrer">/opensolon/solon-gradle-plugin</a></td><td>Solon Gradle ,æ’ä»¶ä»£ç ä»“åº“</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fopensolon%2Fsolon-idea-plugin" target="_blank" title="https://gitee.com/opensolon/solon-idea-plugin" ref="nofollow noopener noreferrer">/opensolon/solon-idea-plugin</a></td><td>Solon Idea ,æ’ä»¶ä»£ç ä»“åº“</td></tr><tr><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fopensolon%2Fsolon-vscode-plugin" target="_blank" title="https://gitee.com/opensolon/solon-vscode-plugin" ref="nofollow noopener noreferrer">/opensolon/solon-vscode-plugin</a></td><td>Solon VsCode ,æ’ä»¶ä»£ç ä»“åº“</td></tr></tbody></table>
<h2 data-id="heading-2">æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼ˆç›¸å¯¹ Java Spring æ–¹æ¡ˆï¼‰ï¼Ÿ</h2>
<p>OpenSolon å¯¹å›½äº§ç®—åŠ›éå¸¸å‹å¥½ï¼Œå¯¹ cpu å’Œ memory çš„éœ€æ±‚è¿œä½äºåŒç±»æ–¹æ¡ˆã€‚</p>

























<table><thead><tr><th>ç‰¹ç‚¹</th><th>æè¿°</th></tr></thead><tbody><tr><td>æ›´é«˜çš„è®¡ç®—æ€§ä»·æ¯”</td><td>å¹¶å‘é«˜ 700%ï¼›å†…å­˜çœ 50%</td></tr><tr><td>æ›´å¿«çš„å¼€å‘æ•ˆç‡</td><td>ä»£ç å°‘ï¼›å…¥é—¨ç®€å•ï¼›å¯åŠ¨ï¼ˆæˆ–è°ƒè¯•é‡å¯ï¼‰å¿« 10å€</td></tr><tr><td>æ›´å¥½çš„ç”Ÿäº§ä¸éƒ¨ç½²ä½“éªŒ</td><td>æ‰“åŒ…å° 90%</td></tr><tr><td>æ›´å¤§çš„å…¼å®¹èŒƒå›´</td><td>é java-ee æ¶æ„ï¼›åŒæ—¶æ”¯æŒ java8 ï½ java25ï¼Œgraalvm native image</td></tr></tbody></table>
<p>æœ€æ–°çš„ techempower ï¼ˆç¬¬ä¸‰æ–¹çŸ¥åæµ‹è¯•å¹³å°ï¼‰æµ‹è¯•æ•°æ®ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.techempower.com%2Fbenchmarks%2F%23hw%3Dph%26test%3Djson%25C2%25A7ion%3Ddata-r23" target="_blank" title="https://www.techempower.com/benchmarks/#hw=ph&amp;test=json%C2%A7ion=data-r23" ref="nofollow noopener noreferrer">www.techempower.com/benchmarks/â€¦</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.techempower.com%2Fbenchmarks%2F%23hw%3Dph%26test%3Dplaintext%25C2%25A7ion%3Ddata-r23" target="_blank" title="https://www.techempower.com/benchmarks/#hw=ph&amp;test=plaintext%C2%A7ion=data-r23" ref="nofollow noopener noreferrer">www.techempower.com/benchmarks/â€¦</a></li>
</ul>
<h2 data-id="heading-3">é¡¹ç›®æ¶æ„ç¤ºæ„å›¾ï¼ˆå…¨åœºæ™¯åº”ç”¨å¼€å‘æ”¯æŒï¼‰</h2>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ffec7fd062a4dcca42da8b415d223d2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6J6bG855qE54yr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767230729&amp;x-signature=l1uv4ZJiw5NatU48qCWqYKkCSGk%3D" width="700" loading="lazy"/>
<h2 data-id="heading-4">v3.8.0 æ›´æ–°è¯´æ˜</h2>
<ul>
<li>æ’ä»¶ <code>solon-flow</code> ç¬¬å…­æ¬¡é¢„è§ˆ</li>
<li>æ–°å¢ <code>solon-flow-workflow</code> æ’ä»¶ï¼ˆæ›¿ä»£ FlowStatefulServiceï¼‰</li>
<li>æ–°å¢ <code>solon-java25</code> ä»“åº“ï¼ˆæä¾› ScopedValue é€‚é…ï¼‰</li>
<li>æ·»åŠ  <code>solon</code> ScopeLocal æ¥å£ï¼ˆç”¨äº ThreadLocal åˆ° ScopedValue å…¼å®¹ï¼‰</li>
<li>æ·»åŠ  <code>solon</code> Solon.start(Class, MultiMap) æ–¹æ³•</li>
<li>æ·»åŠ  <code>solon</code> ThreadsUtil:newVirtualThreadFactory æ–¹æ³•</li>
<li>æ·»åŠ  <code>solon</code> ContextHolder:currentWith æ–¹æ³•ï¼Œæ›¿ä»£ currentSetï¼ˆæ ‡ä¸ºå¼ƒç”¨ï¼‰</li>
<li>æ·»åŠ  <code>solon</code> Controller:remoting å±æ€§ï¼ˆå¯æ›¿ä»£ @Remoting æ³¨è§£ï¼‰</li>
<li>æ·»åŠ  <code>solon</code> éä¾èµ–å…³ç³»çš„ bean å¼‚æ­¥åˆå§‹åŒ–ï¼ˆ<code>@Init(async=true)</code>ï¼‰</li>
<li>æ·»åŠ  <code>solon</code> Stringable æ¥å£</li>
<li>æ·»åŠ  <code>solon</code> 'env.use' é…ç½®æ”¯æŒï¼ˆç›¸å¯¹ 'env'ï¼Œå®ƒä¸ 'env.on' åä½œæ—¶ä¸ä¼šå†²çªï¼‰</li>
<li>æ·»åŠ  <code>solon</code> 'server.session.cookieHttpOnly' é…ç½®æ”¯æŒï¼ˆé»˜è®¤ä¸º trueï¼‰</li>
<li>æ·»åŠ  <code>solon</code> Context.cookieSet(...,httpOnly) æ–¹æ³•</li>
<li>æ·»åŠ  <code>solon-test</code> HttpTester protocol å‚æ•°æ”¯æŒï¼ˆæ–¹ä¾¿ https æˆ– http åˆ‡æ¢æµ‹è¯•ï¼‰</li>
<li>æ·»åŠ  <code>solon-serialization</code> JsonPropsUtil2.dateAsFormat æ·»åŠ  java.sql.Timestamp ç±»å‹æ”¯æŒ</li>
<li>æ·»åŠ  <code>solon-config-yaml</code> ä¾èµ– solon-config-snack4 é¿å…å•ä¸ªå¼•å…¥æ—¶å¿˜æ‰</li>
<li>æ·»åŠ  <code>solon-net-httputils</code> HttpSslSupplierAnyï¼ˆæ–¹ä¾¿æ— é™åˆ¶çš„ ssl ä½¿ç”¨ï¼Œä½†ä¸å»ºè®®ï¼‰</li>
<li>æ·»åŠ  <code>solon-web-rx</code> RxEntity ç±»ï¼ˆæ–¹ä¾¿å¯¹æ¥ mcp-sdkï¼‰</li>
<li>æ·»åŠ  <code>solon-server</code> ä¼šè¯çŠ¶æ€çš„ cookie httpOnly é…ç½®ï¼ˆé»˜è®¤ä¸º falseï¼‰</li>
<li>æ·»åŠ  <code>solon-server-tomcat</code> ssl é€‚é…æ”¯æŒ</li>
<li>æ·»åŠ  <code>solon-security-validation</code> ValidatorFailureHandlerI18n æ”¯æŒéªŒè¯æ³¨è§£çš„å›½é™…åŒ–å¤„ç†
æ·»åŠ  <code>solon-expression</code> SnelParser ç±»ï¼Œä¸º TemplateParser å’Œ EvaluateParser æä¾›å‡ºå…¥å£å’Œå ä½ç¬¦é…ç½®</li>
<li>æ·»åŠ  <code>solon-flow</code> FlowContext:lastNode() æ–¹æ³•ï¼ˆæœ€åä¸€ä¸ªè¿è¡Œçš„èŠ‚ç‚¹ï¼‰</li>
<li>æ·»åŠ  <code>solon-flow</code> FlowContext:lastNodeId() æ–¹æ³•ï¼ˆæœ€åä¸€ä¸ªè¿è¡Œçš„èŠ‚ç‚¹Idï¼‰</li>
<li>æ·»åŠ  <code>solon-flow</code> Node.getMetaAs, Link.getMetaAs æ–¹æ³•</li>
<li>æ·»åŠ  <code>solon-flow</code> NodeSpec:linkRemove æ–¹æ³•ï¼ˆå¢å¼ºä¿®æ”¹èƒ½åŠ›ï¼‰</li>
<li>æ·»åŠ  <code>solon-flow</code> Graph:create(id,title,consumer) æ–¹æ³•</li>
<li>æ·»åŠ  <code>solon-flow</code> Graph:copy(graph,consumer) æ–¹æ³•ï¼ˆæ–¹ä¾¿å¤åˆ¶åä¿®æ”¹ï¼‰</li>
<li>æ·»åŠ  <code>solon-flow</code> GraphSpec:getNode(id) æ–¹æ³•</li>
<li>æ·»åŠ  <code>solon-flow</code> GraphSpec:addLoop(id) æ–¹æ³•æ›¿ä»£ addLoopingï¼ˆåè€…æ ‡ä¸ºå¼ƒç”¨ï¼‰</li>
<li>æ·»åŠ  <code>solon-flow</code> FlowEngine:eval(Graph, ..) ç³»åˆ—æ–¹æ³•</li>
<li>æ·»åŠ  <code>solon-ai</code> FunctionPrompt:handleAsyncï¼ˆç”¨äº mcp-server å¼‚æ­¥æ”¯æŒï¼‰</li>
<li>æ·»åŠ  <code>solon-ai</code> FunctionResource:handleAsyncï¼ˆç”¨äº mcp-server å¼‚æ­¥æ”¯æŒï¼‰</li>
<li>æ·»åŠ  <code>solon-ai</code> FunctionTool:handleAsyncï¼ˆç”¨äº mcp-server å¼‚æ­¥æ”¯æŒï¼‰</li>
<li>æ·»åŠ  <code>solon-ai-core</code> ChatMessage:toNdjson,fromNdjson æ–¹æ³•ï¼ˆæ›¿ä»£ ChatSession:toNdjson, loadNdjsonï¼‰ï¼Œæ–°æ–¹æ³•æœºåˆ¶ä¸Šæ›´è‡ªç”±</li>
<li>æ·»åŠ  <code>solon-ai-core</code> ToolSchemaUtil.jsonSchema Publisher æ³›å‹æ”¯æŒ</li>
<li>æ·»åŠ  <code>solon-ai-mcp</code> mcp-java-sdk v0.17 é€‚é…ï¼ˆæ”¯æŒ 2025-06-18 ç‰ˆæœ¬åè®®ï¼‰</li>
<li>æ·»åŠ  <code>solon-ai-mcp</code> mcp-server å¼‚æ­¥æ”¯æŒ</li>
<li>æ·»åŠ  <code>solon-ai-mcp</code> mcp-server streamable_stateless æ”¯æŒ</li>
<li>æ·»åŠ  <code>solon-ai-mcp</code> Tool,Resource,Prompt å¯¹ org.reactivestreams.Publisher å¼‚æ­¥è¿”å›æ”¯æŒ</li>
<li>æ·»åŠ  <code>solon-ai-mcp</code> McpServerHost æœåŠ¡å®¿ä¸»æ¥å£ï¼Œç”¨äºéš”ç¦»æœ‰çŠ¶æ€ä¸æ— çŠ¶æ€æœåŠ¡</li>
<li>æ·»åŠ  <code>solon-ai-mcp</code> McpChannel.STREAMABLE_STATELESS ï¼ˆæœåŠ¡ç«¯ï¼‰æ— çŠ¶æ€ä¼šè¯</li>
<li>æ·»åŠ  <code>solon-ai-mcp</code> McpClientProvider:customize æ–¹æ³•ï¼ˆç”¨äºæ‰©å±• roots, sampling ç­‰ï¼‰</li>
<li>æ·»åŠ  <code>solon-ai-mcp</code> mcpServer McpAsyncServerExchange æ³¨å…¥æ”¯æŒï¼ˆç”¨äºæ‰©å±• roots, sampling ç­‰ï¼‰</li>
<li>ä¼˜åŒ– <code>solon</code> api-version ç‰ˆæœ¬åŒ¹é…</li>
<li>ä¼˜åŒ– <code>solon</code> SnelUtil snel è¡¨è¾¾å¼ç¼ºå‚æ•°æ—¶å¼‚å¸¸æç¤ºï¼ˆé¿å…é…é”™åå­—ï¼‰</li>
<li>ä¼˜åŒ– <code>solon</code> ParamWrap:getName æ”¹ç”¨ ParamSpec.getAliasã€‚åŠ  '@Param(name=xxx)' æ³¨è§£å¯ç”Ÿæ•ˆ</li>
<li>ä¼˜åŒ– <code>solon-cache</code> CacheService é€‚é…æ²¡æœ‰ _cacheKeyHead é…ç½®æ—¶ï¼Œåˆ™ä¸åŠ å‰ç¼€</li>
<li>ä¼˜åŒ– <code>solon-net-httputils</code> SslContextBuilder</li>
<li>ä¼˜åŒ– <code>solon-expression</code> EvaluateParser æ”¯æŒå®šä¹‰å ä½ç¬¦ï¼ˆå¯æ”¯æŒ <code>{xxx}</code> è¡¨è¾¾å¼ï¼‰</li>
<li>ä¼˜åŒ– <code>solon-expression</code> TemplateParser æ”¯æŒå®šä¹‰å ä½ç¬¦ï¼ˆå¯æ”¯æŒ <code>{xxx}</code> è¡¨è¾¾å¼ï¼‰</li>
<li>ä¼˜åŒ– <code>solon-expression</code> LRUCache æ€§èƒ½ï¼ˆæé«˜ç¼“å­˜æ€§èƒ½ï¼‰</li>
<li>ä¼˜åŒ– <code>solon-ai-dialect-openai</code> claude å…¼å®¹æ€§</li>
<li>ä¼˜åŒ– <code>solon-ai-mcp mcp</code> StreamableHttp æ¨¡å¼ä¸‹ æœåŠ¡ç«¯æ­£å¸¸è¿”å›æ—¶ å®¢æˆ·ç«¯å¼‚å¸¸æ—¥å¿—æ‰“å°çš„æƒ…å†µ* ä¼˜åŒ– <code>solon-flow</code> eval(Node startNode) å¤„ç†ï¼Œæ”¹ä¸ºä» root å¼€å§‹æ¢å¤åˆ° start å†å¼€å§‹æ‰§è¡Œï¼ˆæ¢å¤è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šæ‰§è¡Œä»»åŠ¡ï¼‰</li>
<li>ä¼˜åŒ– <code>solon-flow</code> FlowEngine:eval(Node startNode) å¤„ç†ï¼Œæ”¹ä¸ºä» root å¼€å§‹æ¢å¤åˆ° start å†å¼€å§‹æ‰§è¡Œï¼ˆæ¢å¤è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šæ‰§è¡Œä»»åŠ¡ï¼‰</li>
<li>è°ƒæ•´ <code>nami</code> NamiAttachment åˆ‡æ¢ä¸º ScopeLocal æ¥å£å®ç°</li>
<li>è°ƒæ•´ <code>solon</code> ContextHolder åˆ‡æ¢ä¸º ScopeLocal æ¥å£å®ç°</li>
<li>è°ƒæ•´ <code>solon</code> RunHolderï¼šparallelExecutor æ”¹ä¸º newFixedThreadPool</li>
<li>è°ƒæ•´ <code>solon-data</code> TranExecutorDefault åˆ‡æ¢ä¸º ScopeLocal æ¥å£å®ç°</li>
<li>è°ƒæ•´ <code>local-solon-cloud-plugin</code> çš„ config å’Œ i18n æœåŠ¡ï¼Œå¦‚æœæ²¡æœ‰ group é…ç½®ï¼Œåˆ™æ–‡ä»¶ä¸å¸¦ group å‰ç¼€ï¼ˆä¹‹å‰é»˜è®¤ç»™äº† DEFAULT_GROUP ç»„åï¼Œæ˜¾å¾—å¤æ‚ï¼‰</li>
<li>è°ƒæ•´ <code>rocketmq-solon-clouud-plugin</code> çš„é€‚é…ï¼Œäº‹ä»¶å±æ€§ä¸å†åŠ  '!' ï¼ˆå¹¶å…¼å®¹æ—§æ ¼å¼ï¼‰</li>
<li>è°ƒæ•´ <code>aliyun-ons-solon-clouud-plugin</code> çš„é€‚é…ï¼Œäº‹ä»¶å±æ€§ä¸å†åŠ  '!' ï¼ˆå¹¶å…¼å®¹æ—§æ ¼å¼ï¼‰</li>
<li>è°ƒæ•´ <code>rocketmq5-solon-clouud-plugin</code> çš„é€‚é…ï¼Œäº‹ä»¶å±æ€§ä¸å†åŠ  '!' ï¼ˆå¹¶å…¼å®¹æ—§æ ¼å¼ï¼‰ã€‚æ·»åŠ  sql92 è¿‡æ»¤æ”¯æŒ</li>
<li>è°ƒæ•´ <code>solon-flow</code> ç§»é™¤ Activity èŠ‚ç‚¹é¢„è§ˆå±æ€§ "<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi mathvariant="normal">"</mi><mtext>å’Œ</mtext><mi mathvariant="normal">"</mi></mrow><annotation encoding="application/x-tex">imode" å’Œ "</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">im</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord">"</span><span class="mord cjk_fallback">å’Œ</span><span class="mord">"</span></span></span></span></span>omode"</li>
<li>è°ƒæ•´ <code>solon-flow</code> Activity èŠ‚ç‚¹æµå‡ºæ”¹ä¸ºè‡ªç”±æ¨¡å¼ï¼ˆå¯ä»¥å¤šçº¿æµå‡ºï¼šæ— æ¡ä»¶ç›´æ¥æµå‡ºï¼Œæœ‰æ¡ä»¶æ£€æµ‹åæµå‡ºï¼‰</li>
<li>è°ƒæ•´ <code>solon-flow</code> Node.getMeta æ–¹æ³•è¿”å›æ”¹ä¸º Object ç±»å‹ï¼ˆå¹¶æ–°å¢ getMetaAsï¼‰</li>
<li>è°ƒæ•´ <code>solon-flow</code> Evaluation:runTest æ”¹ä¸º runCondition</li>
<li>è°ƒæ•´ <code>solon-flow</code> FlowContext:incrAdd,incrGet æ ‡ä¸ºå¼ƒç”¨ï¼ˆä¸Šä¸‹æ–‡æ•°æ®ä¸ºå‹åªèƒ½ç”±è¾“å…¥ä¾§å†³å®šï¼‰</li>
<li>è°ƒæ•´ <code>solon-flow</code> Condition æ›´åä¸º ConditionDesc</li>
<li>è°ƒæ•´ <code>solon-flow</code> Task æ›´åä¸º ConditionDesc</li>
<li>è°ƒæ•´ <code>solon-flow</code> XxxDecl å‘½åé£æ ¼æ”¹ä¸º XxxSpec</li>
<li>è°ƒæ•´ <code>solon-flow</code> GraphDecl.parseByXxx å‘½åé£æ ¼æ”¹ä¸º GraphSpec.fromXxx</li>
<li>è°ƒæ•´ <code>solon-flow</code> Graph.parseByXxx å‘½åé£æ ¼æ”¹ä¸º Graph.fromXxx</li>
<li>è°ƒæ•´ <code>solon-ai-mcp</code> getResourceTemplatesã€getResources ä¸å†å…±äº«æ³¨å†Œ</li>
<li>è°ƒæ•´ <code>solon-ai-mcp</code> McpServerManager å†…éƒ¨æ¥å£æ›´åä¸º McpPrimitivesRegistry ï¼ˆMCP åŸè¯­æ³¨å†Œå™¨ï¼‰</li>
<li>è°ƒæ•´ <code>solon-ai-mcp</code> McpClientProvider é»˜è®¤ä¸å¯ç”¨å¿ƒè·³æœºåˆ¶ï¼ˆéšç€ mcp-sdk çš„æˆç†Ÿï¼Œserver éƒ½æœ‰å¿ƒè·³æœºåˆ¶äº†ï¼‰</li>
<li>ä¿®å¤ <code>solon</code> IndexFiles è·¯å¾„è¡¨è¾¾å¼çš„å…¼å®¹é—®é¢˜ï¼ˆæ·»åŠ è½¬æ¢ <code>*-&gt;@</code>ã€<code>:-&gt;!</code>ï¼‰</li>
<li>ä¿®å¤ <code>solon</code> ParamWrap:getName åŠ  '@Param(name=xxx)' æ³¨è§£æ—¶æ²¡æœ‰ç”Ÿæ•ˆçš„é—®é¢˜ï¼ˆv3.7.0 å‡ºç°ï¼‰ã€‚å¯¹ solon-cache ä¼šæœ‰å½±å“</li>
<li>ä¿®å¤ <code>solon-web-vertx</code> VxWebContext._requestBody å¦‚æœä¸º null æ–‡ä»¶ä¸Šä¼ æ—¶ä¼šå‡ºé”™çš„é—®é¢˜</li>
<li>ä¿®å¤ <code>solon-docs-openapi2</code> è¿”å›ç±»å‹ä¸­æ³›å‹å¤±æ•ˆçš„é—®é¢˜ï¼ˆv3.7.0 å‡ºç°ï¼‰</li>
<li>snack4 å‡ä¸º 4.0.20</li>
<li>jackson å‡ä¸º 2.19.2</li>
<li>liquor å‡ä¸º 1.6.6</li>
<li>asm å‡ä¸º 9.9</li>
</ul>
<h4 data-id="heading-5">solon ä»“åº“è¡¥å……è¯´æ˜</h4>
<p>æ–°ç‰¹æ€§ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> {
   <span class="hljs-keyword">static</span> ScopeLocal&lt;String&gt; LOCAL = ScopeLocal.newInstance();

   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>{
       LOCAL.with(<span class="hljs-string">"test"</span>, ()-&gt;{
           System.out.println(LOCAL.get());
       });
   }
}
</code></pre>
<h4 data-id="heading-6">solon-ai ä»“åº“è¡¥å……è¯´æ˜</h4>
<p>æ–°ç‰¹æ€§å±•ç¤ºï¼š1.MCP æ— çŠ¶æ€ä¼šè¯ï¼ˆSTREAMABLE_STATELESSï¼‰å’Œ 2.CompletableFuture å¼‚æ­¥MCPå·¥å…·</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@McpServerEndpoint(channel = McpChannel.STREAMABLE_STATELESS, mcpEndpoint = "/mcp1")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">McpServerTool</span> {
    <span class="hljs-meta">@ToolMapping(description = "æŸ¥è¯¢å¤©æ°”é¢„æŠ¥", returnDirect = true)</span>
    <span class="hljs-keyword">public</span> CompletableFuture&lt;String&gt; <span class="hljs-title function_">getWeather</span><span class="hljs-params">(<span class="hljs-meta">@Param(description = "åŸå¸‚ä½ç½®")</span> String location)</span> {
        <span class="hljs-keyword">return</span> CompletableFuture.completedFuture(<span class="hljs-string">"æ™´ï¼Œ14åº¦"</span>);
    }
}
</code></pre>
<p>ä¼ è¾“æ–¹å¼å¯¹åº”è¡¨ï¼šï¼ˆæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ï¼Œé¡»ä½¿ç”¨å¯¹åº”çš„ä¼ è¾“æ–¹å¼æ‰å¯é€šè®¯ï¼‰</p>






























<table><thead><tr><th>æœåŠ¡ç«¯</th><th>å®¢æˆ·ç«¯</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>STDIO</td><td>STDIO</td><td/></tr><tr><td>SSE</td><td>SSE</td><td/></tr><tr><td>STREAMABLE</td><td>STREAMABLE</td><td/></tr><tr><td>STREAMABLE_STATELESS</td><td>STREAMABLE</td><td>å¯¹ server é›†ç¾¤å¾ˆå‹å¥½</td></tr></tbody></table>
<ul>
<li>STREAMABLE_STATELESS é›†ç¾¤ï¼Œä¸éœ€è¦ ip_hashï¼Œä½†â€œåŸè¯­â€å˜åŒ–åæ— æ³•é€šçŸ¥ client</li>
</ul>
<h4 data-id="heading-7">solon-flow ä»“åº“è¡¥å……è¯´æ˜</h4>
<p>é‡è¦å˜åŒ–ï¼š</p>
<ul>
<li>å–æ¶ˆâ€œæœ‰çŠ¶æ€â€ã€â€œæ— çŠ¶æ€â€æ¦‚å¿µã€‚</li>
<li>solon-flow å›å½’é€šç”¨æµç¨‹å¼•æ“ï¼ˆåˆ†ç¦»â€œæœ‰çŠ¶æ€â€çš„æ¦‚å¿µï¼‰ã€‚</li>
<li>æ–°å¢ solon-flow-workflow ä¸ºå·¥ä½œæµæ€§è´¨çš„å°è£…ï¼ˆæœªæ¥å¯èƒ½ä¼šæœ‰ dataflow ç­‰ï¼‰ã€‚</li>
</ul>
<p>å…¼å®¹å˜åŒ–å¯¹ç…§è¡¨ï¼š</p>






































































<table><thead><tr><th>æ—§åç§°</th><th>æ–°åç§°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>GraphDecl</code></td><td><code>GraphSpec</code></td><td>å›¾å®šä¹‰</td></tr><tr><td><code>GraphDecl.parseByXxx</code></td><td><code>GraphSpec.fromXxx</code></td><td>å›¾å®šä¹‰åŠ è½½</td></tr><tr><td><code>Graph.parseByXxx</code></td><td><code>Graph.fromXxx</code></td><td>å›¾åŠ è½½</td></tr><tr><td><code>LinkDecl</code></td><td><code>LinkSpec</code></td><td>è¿æ¥å®šä¹‰</td></tr><tr><td><code>NodeDecl</code></td><td><code>NodeSpec</code></td><td>èŠ‚ç‚¹å®šä¹‰</td></tr><tr><td><code>Condition</code></td><td><code>ConditionDesc</code></td><td>æ¡ä»¶æè¿°</td></tr><tr><td><code>Task</code></td><td><code>TaskDesc</code></td><td>ä»»åŠ¡æè¿°ï¼ˆé¿å…ä¸ workflow çš„æ¦‚å¿µå†²çªï¼‰</td></tr><tr><td/><td/><td/></tr><tr><td><code>FlowStatefulService</code></td><td><code>WorkflowService</code></td><td>å·¥ä½œæµæœåŠ¡</td></tr><tr><td><code>StatefulTask</code></td><td><code>Task</code></td><td>ä»»åŠ¡</td></tr><tr><td><code>Operation</code></td><td><code>TaskAction</code></td><td>ä»»åŠ¨å·¥ä½œ</td></tr><tr><td><code>TaskType</code></td><td><code>TaskState</code></td><td>ä»»åŠ¡çŠ¶æ€</td></tr></tbody></table>
<p>FlowStatefulService åˆ° WorkflowService çš„æ¥å£å˜åŒ–å¯¹ç…§è¡¨ï¼š</p>


















































<table><thead><tr><th>æ—§åç§°</th><th>æ–°åç§°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>postOperation(..)</code></td><td><code>postTask(..)</code></td><td>æäº¤ä»»åŠ¡</td></tr><tr><td><code>postOperationIfWaiting(..)</code></td><td><code>postTaskIfWaiting(..)</code></td><td>æäº¤ä»»åŠ¡</td></tr><tr><td/><td/><td/></tr><tr><td><code>evel(..)</code></td><td>/</td><td>æ‰§è¡Œ</td></tr><tr><td><code>stepForward(..)</code></td><td>/</td><td>å•æ­¥å‰è¿›</td></tr><tr><td><code>stepBack(..)</code></td><td>/</td><td>å•æ­¥åé€€</td></tr><tr><td/><td/><td/></tr><tr><td>/</td><td><code>getState(..)</code></td><td>è·å–çŠ¶æ€</td></tr></tbody></table>
<p>æ–°ç‰¹æ€§é¢„è§ˆï¼šGraph ç¡¬ç¼–ç æ–¹å¼ï¼ˆåŠä¿®æ”¹èƒ½åŠ›å¢å¼ºï¼‰</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//ç¡¬ç¼–ç </span>
<span class="hljs-type">Graph</span> <span class="hljs-variable">graph</span> <span class="hljs-operator">=</span> Graph.create(<span class="hljs-string">"demo1"</span>, <span class="hljs-string">"ç¤ºä¾‹"</span>, spec -&gt; {
    spec.addStart(<span class="hljs-string">"start"</span>).title(<span class="hljs-string">"å¼€å§‹"</span>).linkAdd(<span class="hljs-string">"01"</span>);
    spec.addActivity(<span class="hljs-string">"n1"</span>).task(<span class="hljs-string">"@AaMetaProcessCom"</span>).linkAdd(<span class="hljs-string">"end"</span>);
    spec.addEnd(<span class="hljs-string">"end"</span>).title(<span class="hljs-string">"ç»“æŸ"</span>);
});

<span class="hljs-comment">//ä¿®æ”¹</span>
<span class="hljs-type">Graph</span> <span class="hljs-variable">graphNew</span> <span class="hljs-operator">=</span> Graph.copy(graph, spec -&gt; {
    spec.getNode(<span class="hljs-string">"n1"</span>).linkRemove(<span class="hljs-string">"end"</span>).linkAdd(<span class="hljs-string">"n2"</span>); <span class="hljs-comment">//ç§»æ‰ n1 è¿æ¥ï¼›æ”¹ä¸º n2 è¿æ¥</span>
    spec.addActivity(<span class="hljs-string">"n2"</span>).linkAdd(<span class="hljs-string">"end"</span>);
});
</code></pre>
<p>æ–°ç‰¹æ€§é¢„è§ˆï¼šFlowContext:lastNodeId ï¼ˆè®¡ç®—çš„ä¸­æ–­ä¸æ¢å¤ï¼‰ã€‚å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fsolon.noear.org%2Farticle%2F1246" target="_blank" title="https://solon.noear.org/article/1246" ref="nofollow noopener noreferrer">solon.noear.org/article/124â€¦</a></p>
<pre><code class="hljs language-java" lang="java">flowEngine.eval(graph, context.lastNodeId(), context);
<span class="hljs-comment">//...ï¼ˆä»ä¸Šä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹æ‰§è¡Œï¼‰</span>
flowEngine.eval(graph, context.lastNodeId(), context);
</code></pre>
<p>æ–°ç‰¹æ€§é¢„è§ˆï¼šWorkflowServiceï¼ˆæ›¿ä»£ FlowStatefulServiceï¼‰</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">WorkflowService</span> <span class="hljs-variable">workflow</span> <span class="hljs-operator">=</span> WorkflowService.of(engine, WorkflowDriver.builder()
        .stateController(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ActorStateController</span>()) 
        .stateRepository(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryStateRepository</span>()) 
        .build());


<span class="hljs-comment">//1. å–å‡ºä»»åŠ¡</span>
<span class="hljs-type">Task</span> <span class="hljs-variable">task</span> <span class="hljs-operator">=</span> workflow.getTask(graph, context);

<span class="hljs-comment">//2. æäº¤ä»»åŠ¡</span>
workflow.postTask(task.getNode(), TaskAction.FORWARD, context);
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[çŸ¥è¯†åº“-å‘é‡åŒ–åŠŸèƒ½-æµå¼åˆ†ç‰‡]]></title>    <link>https://juejin.cn/post/7587264707285024778</link>    <guid>https://juejin.cn/post/7587264707285024778</guid>    <pubDate>2025-12-25T01:40:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587264707285024778" data-draft-id="7586614240531857434" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="çŸ¥è¯†åº“-å‘é‡åŒ–åŠŸèƒ½-æµå¼åˆ†ç‰‡"/> <meta itemprop="keywords" content="åç«¯,Elasticsearch"/> <meta itemprop="datePublished" content="2025-12-25T01:40:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é€ è½®å­çš„çŒª"/> <meta itemprop="url" content="https://juejin.cn/user/497453720940158"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            çŸ¥è¯†åº“-å‘é‡åŒ–åŠŸèƒ½-æµå¼åˆ†ç‰‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/497453720940158/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é€ è½®å­çš„çŒª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T01:40:14.000Z" title="Thu Dec 25 2025 01:40:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">çŸ¥è¯†åº“-å‘é‡åŒ–åŠŸèƒ½-æµå¼åˆ†ç‰‡</h2>
<h3 data-id="heading-1">ä¸€ã€è®¾è®¡èƒŒæ™¯</h3>
<p>é’ˆå¯¹è¶…å¤§æ–‡æœ¬ï¼ˆå¦‚100MBä»¥ä¸Šçº¯æ–‡æœ¬æ–‡ä»¶ï¼‰ï¼Œä¼ ç»Ÿâ€œä¸€æ¬¡æ€§åŠ è½½å…¨éƒ¨æ–‡æœ¬åˆ°å†…å­˜å†åˆ†ç‰‡â€çš„æ–¹å¼æ˜“å¯¼è‡´å†…å­˜æº¢å‡ºã€æ–¹æ³•å¡æ­»ç­‰é—®é¢˜ã€‚å› æ­¤é‡‡ç”¨<strong>æµå¼åˆ†ç‰‡ç­–ç•¥</strong>ï¼šé€æ‰¹æ¬¡è¯»å–æ–‡æœ¬åˆ°ç¼“å†²åŒºï¼ŒæŒ‰éœ€ç”Ÿæˆåˆ†ç‰‡ï¼Œå…¨ç¨‹ä¸åŠ è½½å®Œæ•´æ–‡æœ¬åˆ°å†…å­˜ï¼Œå¤§å¹…é™ä½å†…å­˜å ç”¨ã€‚</p>
<h3 data-id="heading-2">äºŒã€æ ¸å¿ƒé€»è¾‘</h3>
<ol>
<li><strong>æµå¼è¯»å–</strong>ï¼šé€šè¿‡<code>Reader</code>é€ç¼“å†²åŒºè¯»å–æ–‡æœ¬ï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½å…¨é‡å†…å®¹ï¼›</li>
<li><strong>æ‰¹æ¬¡åˆ†ç‰‡</strong>ï¼šå¯¹æ¯æ‰¹æ¬¡è¯»å–çš„æ–‡æœ¬æŒ‰å¥å­ç»“æŸç¬¦åˆ†å‰²ï¼Œä¿è¯åˆ†ç‰‡è¯­ä¹‰å®Œæ•´æ€§ï¼›</li>
<li><strong>å…œåº•æœºåˆ¶</strong>ï¼šè®¾ç½®æœ€å°é€’å¢æ­¥é•¿ã€æœ€å¤§å¾ªç¯æ¬¡æ•°ï¼Œé¿å…æ­»å¾ªç¯ï¼›</li>
<li><strong>é‡å å¤„ç†</strong>ï¼šåˆ†ç‰‡é—´ä¿ç•™é‡å å­—ç¬¦ï¼Œé˜²æ­¢è·¨æ‰¹æ¬¡å¥å­è¯­ä¹‰æ–­è£‚ï¼›</li>
<li><strong>å‰©ä½™æ–‡æœ¬å¤„ç†</strong>ï¼šåˆå¹¶æœªå¤„ç†å®Œçš„æ–‡æœ¬åˆ°ä¸‹ä¸€æ‰¹æ¬¡ï¼Œä¿è¯åˆ†ç‰‡å®Œæ•´æ€§ã€‚</li>
</ol>
<h3 data-id="heading-3">ä¸‰ã€æ ¸å¿ƒå®ç°ä»£ç </h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.io.Reader;
<span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.Iterator;
<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.regex.Pattern;

<span class="hljs-comment">/**
 * è¶…å¤§æ–‡æœ¬æµå¼åˆ†ç‰‡å·¥å…·ç±»
 * æ ¸å¿ƒï¼šæŒ‰éœ€è¯»å–ã€æŒ‰éœ€åˆ†ç‰‡ï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½å…¨é‡æ–‡æœ¬åˆ°å†…å­˜
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StreamTextSplitter</span> {
    <span class="hljs-comment">// å¥å­ç»“æŸç¬¦æ­£åˆ™ï¼ˆè¦†ç›–ä¸­è‹±æ–‡ç»“æŸç¬¦ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Pattern</span> <span class="hljs-variable">SENTENCE_END_PATTERN</span> <span class="hljs-operator">=</span> Pattern.compile(<span class="hljs-string">"[ã€‚ï¼ï¼Ÿï¼›\\n\\.!?;]"</span>);
    <span class="hljs-comment">// å•åˆ†ç‰‡æœ€å¤§å­—ç¬¦æ•°ï¼ˆå¯æ ¹æ®æ¨¡å‹ä¸Šä¸‹æ–‡è°ƒæ•´ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">MAX_CHUNK_LENGTH</span> <span class="hljs-operator">=</span> <span class="hljs-number">1000</span>;
    <span class="hljs-comment">// åˆ†ç‰‡é‡å å­—ç¬¦æ•°ï¼ˆé¿å…è·¨åˆ†ç‰‡è¯­ä¹‰æ–­è£‚ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CHUNK_OVERLAP</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;
    <span class="hljs-comment">// æœ€å°é€’å¢æ­¥é•¿ï¼ˆé˜²æ­¢æ­»å¾ªç¯ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">MIN_STEP</span> <span class="hljs-operator">=</span> MAX_CHUNK_LENGTH / <span class="hljs-number">2</span>;
    <span class="hljs-comment">// æœ€å¤§å¾ªç¯æ¬¡æ•°ï¼ˆå…œåº•ï¼Œé¿å…æ— é™å¾ªç¯ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">MAX_LOOP_COUNT</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;

    <span class="hljs-comment">/**
     * æµå¼åˆ†ç‰‡ï¼šæ ¸å¿ƒæ–¹æ³•ï¼ŒæŒ‰éœ€ç”Ÿæˆæ–‡æœ¬åˆ†ç‰‡
     * <span class="hljs-doctag">@param</span> textReader æ–‡æœ¬æµå¼è¯»å–å™¨ï¼ˆæ”¯æŒFileReader/InputStreamReaderç­‰ï¼‰
     * <span class="hljs-doctag">@param</span> bufferSize ç¼“å†²åŒºå¤§å°ï¼ˆå»ºè®®8192/16384å­—ç¬¦ï¼Œå¹³è¡¡IOæ¬¡æ•°ä¸å†…å­˜å ç”¨ï¼‰
     * <span class="hljs-doctag">@return</span> åˆ†ç‰‡è¿­ä»£å™¨ï¼ˆæŒ‰éœ€éå†ï¼Œä¸ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰åˆ†ç‰‡åˆ°å†…å­˜ï¼‰
     * <span class="hljs-doctag">@throws</span> IOException æ–‡æœ¬è¯»å–å¼‚å¸¸
     */</span>
    <span class="hljs-keyword">public</span> Iterator&lt;String&gt; <span class="hljs-title function_">streamSplitText</span><span class="hljs-params">(Reader textReader, <span class="hljs-type">int</span> bufferSize)</span> <span class="hljs-keyword">throws</span> IOException {
        List&lt;String&gt; results = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        List&lt;String&gt; currentBatchChunks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-type">char</span>[] buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[bufferSize];
        <span class="hljs-type">int</span> readLen;
        <span class="hljs-comment">// ä¸Šä¸€æ‰¹æ¬¡æœªå¤„ç†å®Œçš„æ–‡æœ¬ï¼ˆåˆå¹¶åˆ°ä¸‹ä¸€æ‰¹ï¼‰</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">remainingText</span> <span class="hljs-operator">=</span> <span class="hljs-string">""</span>;

        <span class="hljs-comment">// é€ç¼“å†²åŒºè¯»å–æ–‡æœ¬</span>
        <span class="hljs-keyword">while</span> ((readLen = textReader.read(buffer)) != -<span class="hljs-number">1</span>) {
            <span class="hljs-comment">// æ‹¼æ¥ï¼šå‰©ä½™æ–‡æœ¬ + æ–°è¯»å–çš„æ–‡æœ¬</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">batchText</span> <span class="hljs-operator">=</span> remainingText + <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(buffer, <span class="hljs-number">0</span>, readLen);
            <span class="hljs-comment">// å¯¹å½“å‰æ‰¹æ¬¡æ–‡æœ¬è¿›è¡Œåˆ†ç‰‡</span>
            List&lt;String&gt; batchChunks = splitBatchText(batchText);

            <span class="hljs-keyword">if</span> (!batchChunks.isEmpty()) {
                <span class="hljs-type">String</span> <span class="hljs-variable">lastChunk</span> <span class="hljs-operator">=</span> batchChunks.get(batchChunks.size() - <span class="hljs-number">1</span>);
                <span class="hljs-comment">// åˆ¤æ–­æœ€åä¸€ä¸ªåˆ†ç‰‡æ˜¯å¦ä¸ºâ€œä¸å®Œæ•´åˆ†ç‰‡â€ï¼ˆé•¿åº¦&lt;æœ€å¤§é•¿åº¦çš„1/2ï¼‰</span>
                <span class="hljs-keyword">if</span> (lastChunk.length() &lt; MAX_CHUNK_LENGTH / <span class="hljs-number">2</span>) {
                    <span class="hljs-comment">// ä¸å®Œæ•´åˆ†ç‰‡ï¼šä¿ç•™åˆ°ä¸‹ä¸€æ‰¹æ¬¡å¤„ç†</span>
                    remainingText = lastChunk;
                    <span class="hljs-comment">// å®Œæ•´åˆ†ç‰‡ï¼šåŠ å…¥ç»“æœé›†</span>
                    currentBatchChunks.addAll(batchChunks.subList(<span class="hljs-number">0</span>, batchChunks.size() - <span class="hljs-number">1</span>));
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-comment">// æœ€åä¸€ä¸ªåˆ†ç‰‡å®Œæ•´ï¼šæ¸…ç©ºå‰©ä½™æ–‡æœ¬ï¼Œå…¨éƒ¨åŠ å…¥</span>
                    remainingText = <span class="hljs-string">""</span>;
                    currentBatchChunks.addAll(batchChunks);
                }
            }

            <span class="hljs-comment">// æ‰¹é‡æ·»åŠ åˆ°ç»“æœé›†ï¼Œå‡å°‘å†…å­˜æ³¢åŠ¨</span>
            results.addAll(currentBatchChunks);
            currentBatchChunks.clear();
        }

        <span class="hljs-comment">// å¤„ç†æœ€åå‰©ä½™çš„æ–‡æœ¬ï¼ˆéç©ºåˆ™ä½œä¸ºæœ€åä¸€ä¸ªåˆ†ç‰‡ï¼‰</span>
        <span class="hljs-keyword">if</span> (!remainingText.isEmpty()) {
            <span class="hljs-type">String</span> <span class="hljs-variable">lastChunk</span> <span class="hljs-operator">=</span> remainingText.trim();
            <span class="hljs-keyword">if</span> (!lastChunk.isEmpty()) {
                results.add(lastChunk);
            }
        }

        <span class="hljs-comment">// è¿”å›è¿­ä»£å™¨ï¼Œæ”¯æŒæŒ‰éœ€éå†</span>
        <span class="hljs-keyword">return</span> results.iterator();
    }

    <span class="hljs-comment">/**
     * æ‰¹æ¬¡æ–‡æœ¬åˆ†ç‰‡ï¼šå¯¹å•æ‰¹æ¬¡æ–‡æœ¬æŒ‰å¥å­ç»“æŸç¬¦åˆ†å‰²ï¼Œä¿è¯è¯­ä¹‰å®Œæ•´
     * <span class="hljs-doctag">@param</span> text å•æ‰¹æ¬¡è¯»å–çš„æ–‡æœ¬
     * <span class="hljs-doctag">@return</span> è¯¥æ‰¹æ¬¡çš„æ–‡æœ¬åˆ†ç‰‡åˆ—è¡¨
     */</span>
    <span class="hljs-keyword">private</span> List&lt;String&gt; <span class="hljs-title function_">splitBatchText</span><span class="hljs-params">(String text)</span> {
        List&lt;String&gt; chunks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-type">int</span> <span class="hljs-variable">textLength</span> <span class="hljs-operator">=</span> text.length();
        <span class="hljs-keyword">if</span> (textLength == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> chunks;
        }

        <span class="hljs-type">int</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-type">int</span> <span class="hljs-variable">loopCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

        <span class="hljs-comment">// å¾ªç¯åˆ†ç‰‡ï¼Œç›´åˆ°å¤„ç†å®Œå½“å‰æ‰¹æ¬¡æ–‡æœ¬æˆ–è¾¾åˆ°æœ€å¤§å¾ªç¯æ¬¡æ•°</span>
        <span class="hljs-keyword">while</span> (start &lt; textLength &amp;&amp; loopCount &lt; MAX_LOOP_COUNT) {
            loopCount++;
            <span class="hljs-comment">// 1. åŸºç¡€ç»“æŸä½ç½®ï¼ˆä¸è¶…è¿‡æœ€å¤§åˆ†ç‰‡é•¿åº¦ï¼‰</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">end</span> <span class="hljs-operator">=</span> Math.min(start + MAX_CHUNK_LENGTH, textLength);
            <span class="hljs-comment">// 2. è°ƒæ•´ç»“æŸä½ç½®åˆ°æœ€è¿‘çš„å¥å­ç»“æŸç¬¦ï¼ˆä¿è¯è¯­ä¹‰å®Œæ•´ï¼‰</span>
            end = adjustToSentenceEnd(text, start, end);
            <span class="hljs-comment">// 3. æˆªå–åˆ†ç‰‡å¹¶å»ç©º</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">chunk</span> <span class="hljs-operator">=</span> text.substring(start, end).trim();
            <span class="hljs-keyword">if</span> (!chunk.isEmpty()) {
                chunks.add(chunk);
            }

            <span class="hljs-comment">// 4. è®¡ç®—ä¸‹ä¸€ä¸ªåˆ†ç‰‡çš„èµ·å§‹ä½ç½®ï¼ˆæ ¸å¿ƒï¼šé¿å…æ­»å¾ªç¯ï¼‰</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">nextStart</span> <span class="hljs-operator">=</span> end - CHUNK_OVERLAP;
            nextStart = Math.max(nextStart, start + MIN_STEP); <span class="hljs-comment">// è‡³å°‘é€’å¢æœ€å°æ­¥é•¿</span>
            nextStart = Math.min(nextStart, textLength);       <span class="hljs-comment">// ä¸è¶…è¿‡æ–‡æœ¬é•¿åº¦</span>

            <span class="hljs-comment">// 5. ç»ˆæ­¢æ¡ä»¶ï¼šèµ·å§‹ä½ç½®ä¸å†é€’å¢ï¼ˆé˜²æ­¢æ­»å¾ªç¯ï¼‰</span>
            <span class="hljs-keyword">if</span> (nextStart &lt;= start) {
                <span class="hljs-keyword">break</span>;
            }
            start = nextStart;
        }

        <span class="hljs-comment">// å…œåº•ï¼šå¤„ç†æœ€åå‰©ä½™çš„æ–‡æœ¬ï¼ˆå¾ªç¯ç»ˆæ­¢åä»æœ‰æœªå¤„ç†å†…å®¹ï¼‰</span>
        <span class="hljs-keyword">if</span> (start &lt; textLength) {
            <span class="hljs-type">String</span> <span class="hljs-variable">lastChunk</span> <span class="hljs-operator">=</span> text.substring(start).trim();
            <span class="hljs-keyword">if</span> (!lastChunk.isEmpty()) {
                chunks.add(lastChunk);
            }
        }

        <span class="hljs-comment">// æ—¥å¿—æç¤ºï¼šå¾ªç¯æ¬¡æ•°è¾¾ä¸Šé™ï¼ˆéœ€æ’æŸ¥æ–‡æœ¬æ ¼å¼é—®é¢˜ï¼‰</span>
        <span class="hljs-keyword">if</span> (loopCount &gt;= MAX_LOOP_COUNT) {
            System.err.printf(<span class="hljs-string">"æ‰¹æ¬¡æ–‡æœ¬åˆ†ç‰‡å¾ªç¯æ¬¡æ•°è¾¾ä¸Šé™ï¼ˆ%dæ¬¡ï¼‰ï¼Œå¯èƒ½å­˜åœ¨å¼‚å¸¸æ–‡æœ¬æ ¼å¼ï¼æ–‡æœ¬é•¿åº¦ï¼š%d%n"</span>, MAX_LOOP_COUNT, textLength);
        }

        <span class="hljs-keyword">return</span> chunks;
    }

    <span class="hljs-comment">/**
     * è°ƒæ•´åˆ†ç‰‡ç»“æŸä½ç½®åˆ°å¥å­æœ«å°¾ï¼ˆä¼˜åŒ–ï¼šé¿å…è¿‡åº¦å›æº¯ï¼‰
     * <span class="hljs-doctag">@param</span> text å¾…åˆ†ç‰‡æ–‡æœ¬
     * <span class="hljs-doctag">@param</span> start åˆ†ç‰‡èµ·å§‹ä½ç½®
     * <span class="hljs-doctag">@param</span> end åŸºç¡€ç»“æŸä½ç½®
     * <span class="hljs-doctag">@return</span> è°ƒæ•´åçš„ç»“æŸä½ç½®ï¼ˆä¿è¯è¯­ä¹‰å®Œæ•´ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">adjustToSentenceEnd</span><span class="hljs-params">(String text, <span class="hljs-type">int</span> start, <span class="hljs-type">int</span> end)</span> {
        <span class="hljs-comment">// å·²åˆ°æ–‡æœ¬æœ«å°¾ï¼Œç›´æ¥è¿”å›</span>
        <span class="hljs-keyword">if</span> (end &gt;= text.length()) {
            <span class="hljs-keyword">return</span> end;
        }

        <span class="hljs-comment">// æˆªå–å½“å‰åˆ†ç‰‡èŒƒå›´çš„æ–‡æœ¬</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">subText</span> <span class="hljs-operator">=</span> text.substring(start, end);
        <span class="hljs-comment">// æŸ¥æ‰¾æœ€åä¸€ä¸ªå¥å­ç»“æŸç¬¦çš„ä½ç½®</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">lastEndPos</span> <span class="hljs-operator">=</span> findLastSentenceEnd(subText);

        <span class="hljs-comment">// ä»…å½“å›æº¯ååˆ†ç‰‡é•¿åº¦â‰¥æœ€å°æœ‰æ•ˆé•¿åº¦æ—¶ï¼Œæ‰è°ƒæ•´ï¼ˆé¿å…è¿‡çŸ­åˆ†ç‰‡ï¼‰</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">minValidLength</span> <span class="hljs-operator">=</span> <span class="hljs-number">50</span>;
        <span class="hljs-keyword">if</span> (lastEndPos != -<span class="hljs-number">1</span>) {
            <span class="hljs-type">int</span> <span class="hljs-variable">adjustedEnd</span> <span class="hljs-operator">=</span> start + lastEndPos + <span class="hljs-number">1</span>;
            <span class="hljs-keyword">if</span> (adjustedEnd - start &gt;= minValidLength) {
                <span class="hljs-keyword">return</span> adjustedEnd;
            }
        }

        <span class="hljs-comment">// æ— æœ‰æ•ˆå¥å­ç»“æŸç¬¦ï¼Œè¿”å›åŸºç¡€ç»“æŸä½ç½®</span>
        <span class="hljs-keyword">return</span> end;
    }

    <span class="hljs-comment">/**
     * æŸ¥æ‰¾æ–‡æœ¬ä¸­æœ€åä¸€ä¸ªå¥å­ç»“æŸç¬¦çš„ä½ç½®
     * <span class="hljs-doctag">@param</span> text å¾…æŸ¥æ‰¾æ–‡æœ¬
     * <span class="hljs-doctag">@return</span> æœ€åä¸€ä¸ªç»“æŸç¬¦çš„ç´¢å¼•ï¼ˆæ— åˆ™è¿”å›-1ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">findLastSentenceEnd</span><span class="hljs-params">(String text)</span> {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> text.length() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
            <span class="hljs-keyword">if</span> (SENTENCE_END_PATTERN.matcher(String.valueOf(text.charAt(i))).matches()) {
                <span class="hljs-keyword">return</span> i;
            }
        }
        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    }
}
</code></pre>
<h3 data-id="heading-4">å››ã€ä½¿ç”¨æ–¹æ³•</h3>
<h4 data-id="heading-5">4.1 åŸºç¡€ä½¿ç”¨ï¼ˆè¯»å–æœ¬åœ°è¶…å¤§æ–‡æœ¬æ–‡ä»¶ï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.io.FileReader;
<span class="hljs-keyword">import</span> java.io.Reader;
<span class="hljs-keyword">import</span> java.util.Iterator;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StreamSplitterDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// 1. åˆå§‹åŒ–æµå¼åˆ†ç‰‡å·¥å…·</span>
        <span class="hljs-type">StreamTextSplitter</span> <span class="hljs-variable">splitter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamTextSplitter</span>();
        <span class="hljs-comment">// 2. å®šä¹‰æ–‡ä»¶è·¯å¾„å’Œç¼“å†²åŒºå¤§å°ï¼ˆå»ºè®®8192å­—ç¬¦ï¼‰</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">filePath</span> <span class="hljs-operator">=</span> <span class="hljs-string">"D:/large_text.txt"</span>;
        <span class="hljs-type">int</span> <span class="hljs-variable">bufferSize</span> <span class="hljs-operator">=</span> <span class="hljs-number">8192</span>;

        <span class="hljs-keyword">try</span> (<span class="hljs-type">Reader</span> <span class="hljs-variable">textReader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileReader</span>(filePath)) {
            <span class="hljs-comment">// 3. æ‰§è¡Œæµå¼åˆ†ç‰‡ï¼Œè·å–è¿­ä»£å™¨</span>
            Iterator&lt;String&gt; chunkIterator = splitter.streamSplitText(textReader, bufferSize);

            <span class="hljs-comment">// 4. æŒ‰éœ€éå†åˆ†ç‰‡ï¼ˆé€ä¸€åˆ†ç‰‡å¤„ç†ï¼Œä¸åŠ è½½å…¨é‡åˆ°å†…å­˜ï¼‰</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">chunkIndex</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-keyword">while</span> (chunkIterator.hasNext()) {
                <span class="hljs-type">String</span> <span class="hljs-variable">chunk</span> <span class="hljs-operator">=</span> chunkIterator.next();
                chunkIndex++;
                <span class="hljs-comment">// ä¸šåŠ¡å¤„ç†ï¼šå¦‚å‘é‡åŒ–ã€å­˜å‚¨åˆ°ESç­‰</span>
                System.out.printf(<span class="hljs-string">"åˆ†ç‰‡%dï¼šé•¿åº¦=%dï¼Œå†…å®¹é¢„è§ˆï¼š%s%n"</span>,
                        chunkIndex,
                        chunk.length(),
                        chunk.substring(<span class="hljs-number">0</span>, Math.min(chunk.length(), <span class="hljs-number">50</span>))); <span class="hljs-comment">// é¢„è§ˆå‰50å­—ç¬¦</span>
            }

            System.out.printf(<span class="hljs-string">"åˆ†ç‰‡å®Œæˆï¼Œå…±ç”Ÿæˆ%dä¸ªåˆ†ç‰‡%n"</span>, chunkIndex);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            System.err.println(<span class="hljs-string">"æµå¼åˆ†ç‰‡å¤±è´¥ï¼š"</span> + e.getMessage());
            e.printStackTrace();
        }
    }
}
</code></pre>
<h4 data-id="heading-6">4.2 ç»“åˆæ–‡ä»¶ä¸Šä¼ åœºæ™¯ï¼ˆInputStreamReaderï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.web.multipart.MultipartFile;
<span class="hljs-keyword">import</span> java.io.InputStreamReader;
<span class="hljs-keyword">import</span> java.io.Reader;
<span class="hljs-keyword">import</span> java.nio.charset.StandardCharsets;

<span class="hljs-comment">/**
 * å¤„ç†ä¸Šä¼ çš„è¶…å¤§æ–‡æœ¬æ–‡ä»¶ï¼ˆå¦‚TXT/CSVï¼‰
 * <span class="hljs-doctag">@param</span> file ä¸Šä¼ çš„æ–‡ä»¶
 * <span class="hljs-doctag">@throws</span> Exception å¤„ç†å¼‚å¸¸
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processUploadedLargeFile</span><span class="hljs-params">(MultipartFile file)</span> <span class="hljs-keyword">throws</span> Exception {
    <span class="hljs-type">StreamTextSplitter</span> <span class="hljs-variable">splitter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamTextSplitter</span>();
    <span class="hljs-type">int</span> <span class="hljs-variable">bufferSize</span> <span class="hljs-operator">=</span> <span class="hljs-number">16384</span>; <span class="hljs-comment">// å¤§æ–‡ä»¶å»ºè®®å¢å¤§ç¼“å†²åŒº</span>

    <span class="hljs-comment">// åŸºäºæ–‡ä»¶è¾“å…¥æµåˆ›å»ºReaderï¼ˆæŒ‡å®šUTF-8ç¼–ç é¿å…ä¹±ç ï¼‰</span>
    <span class="hljs-keyword">try</span> (<span class="hljs-type">Reader</span> <span class="hljs-variable">reader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(file.getInputStream(), StandardCharsets.UTF_8)) {
        Iterator&lt;String&gt; chunkIterator = splitter.streamSplitText(reader, bufferSize);

        <span class="hljs-comment">// éå†åˆ†ç‰‡ï¼Œé€ä¸ªå‘é‡åŒ–å¹¶å­˜å‚¨</span>
        <span class="hljs-keyword">while</span> (chunkIterator.hasNext()) {
            <span class="hljs-type">String</span> <span class="hljs-variable">chunk</span> <span class="hljs-operator">=</span> chunkIterator.next();
            <span class="hljs-comment">// è°ƒç”¨å‘é‡åŒ–æ–¹æ³•</span>
            <span class="hljs-comment">// float[] vector = embeddingModel.embed(chunk);</span>
            <span class="hljs-comment">// å­˜å‚¨åˆ°ES</span>
            <span class="hljs-comment">// esService.saveChunk(chunk, vector);</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-7">4.3 ç»“åˆPDF/Wordè§£æï¼ˆæµå¼å¤„ç†è§£æç»“æœï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æµå¼å¤„ç†PDFè§£æåçš„è¶…å¤§æ–‡æœ¬
 * <span class="hljs-doctag">@param</span> pdfFilePath PDFæ–‡ä»¶è·¯å¾„
 * <span class="hljs-doctag">@throws</span> Exception å¤„ç†å¼‚å¸¸
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">streamProcessPdf</span><span class="hljs-params">(String pdfFilePath)</span> <span class="hljs-keyword">throws</span> Exception {
    <span class="hljs-comment">// 1. è§£æPDFè·å–æ–‡æœ¬ï¼ˆå‚è€ƒPDFè§£ææ–‡æ¡£ï¼‰</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">pdfText</span> <span class="hljs-operator">=</span> PdfTextExtractor.getContent(pdfFilePath);
    <span class="hljs-comment">// 2. å°†å­—ç¬¦ä¸²è½¬ä¸ºReaderï¼ˆæ¨¡æ‹Ÿæµå¼è¯»å–ï¼‰</span>
    <span class="hljs-keyword">try</span> (<span class="hljs-type">Reader</span> <span class="hljs-variable">reader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">java</span>.io.StringReader(pdfText)) {
        <span class="hljs-type">StreamTextSplitter</span> <span class="hljs-variable">splitter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamTextSplitter</span>();
        Iterator&lt;String&gt; chunkIterator = splitter.streamSplitText(reader, <span class="hljs-number">8192</span>);

        <span class="hljs-comment">// 3. é€åˆ†ç‰‡å¤„ç†</span>
        <span class="hljs-keyword">while</span> (chunkIterator.hasNext()) {
            <span class="hljs-type">String</span> <span class="hljs-variable">chunk</span> <span class="hljs-operator">=</span> chunkIterator.next();
            <span class="hljs-comment">// å‘é‡åŒ–+å­˜å‚¨é€»è¾‘</span>
        }
    }
}
</code></pre>
<h3 data-id="heading-8">äº”ã€æ ¸å¿ƒè®¾è®¡è¯´æ˜</h3>
<h4 data-id="heading-9">5.1 å…³é”®å‚æ•°è¯´æ˜</h4>



































<table><thead><tr><th>å‚æ•°å</th><th>å–å€¼</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>MAX_CHUNK_LENGTH</td><td>1000</td><td>å•åˆ†ç‰‡æœ€å¤§å­—ç¬¦æ•°ï¼Œéœ€åŒ¹é…åµŒå…¥æ¨¡å‹ä¸Šä¸‹æ–‡çª—å£ï¼ˆå¦‚num_ctx=1024ï¼‰</td></tr><tr><td>CHUNK_OVERLAP</td><td>100</td><td>åˆ†ç‰‡é—´é‡å å­—ç¬¦æ•°ï¼Œé¿å…è·¨åˆ†ç‰‡å¥å­è¯­ä¹‰æ–­è£‚ï¼ˆå¦‚â€œæˆ‘æ˜¯ä¸€ä¸ªæµ‹è¯•æ–‡æœ¬â€è¢«æˆªæ–­ä¸ºâ€œæˆ‘æ˜¯ä¸€ä¸ªâ€å’Œâ€œæµ‹è¯•æ–‡æœ¬â€ï¼‰</td></tr><tr><td>MIN_STEP</td><td>500</td><td>æœ€å°é€’å¢æ­¥é•¿ï¼Œé˜²æ­¢å› é‡å å¯¼è‡´startä½ç½®ä¸é€’å¢ï¼Œè§¦å‘æ­»å¾ªç¯</td></tr><tr><td>MAX_LOOP_COUNT</td><td>100</td><td>æœ€å¤§å¾ªç¯æ¬¡æ•°ï¼Œå…œåº•å¤„ç†å¼‚å¸¸æ–‡æœ¬ï¼ˆå¦‚æ— å¥å­ç»“æŸç¬¦çš„è¶…é•¿æ–‡æœ¬ï¼‰</td></tr><tr><td>bufferSize</td><td>8192/16384</td><td>ç¼“å†²åŒºå¤§å°ï¼Œå»ºè®®ä¸º2çš„å¹‚æ¬¡ï¼Œå¹³è¡¡IOæ¬¡æ•°ä¸å†…å­˜å ç”¨</td></tr></tbody></table>
<h4 data-id="heading-10">5.2 æ ¸å¿ƒä¼˜åŠ¿</h4>





























<table><thead><tr><th>ä¼˜åŠ¿</th><th>è§£å†³çš„é—®é¢˜</th></tr></thead><tbody><tr><td>æµå¼è¯»å–</td><td>é¿å…ä¸€æ¬¡æ€§åŠ è½½è¶…å¤§æ–‡æœ¬åˆ°å†…å­˜ï¼Œé˜²æ­¢OOM/æ–¹æ³•å¡æ­»</td></tr><tr><td>å¥å­ç»“æŸç¬¦åˆ†å‰²</td><td>ä¿è¯åˆ†ç‰‡è¯­ä¹‰å®Œæ•´æ€§ï¼Œé¿å…ç”Ÿç¡¬æˆªæ–­å¯¼è‡´çš„å‘é‡åŒ–è¯¯å·®</td></tr><tr><td>å‰©ä½™æ–‡æœ¬åˆå¹¶</td><td>é˜²æ­¢è·¨æ‰¹æ¬¡æ–‡æœ¬ä¸¢å¤±ï¼Œä¿è¯åˆ†ç‰‡å®Œæ•´æ€§</td></tr><tr><td>å¤šé‡å…œåº•æœºåˆ¶</td><td>æœ€å°æ­¥é•¿+æœ€å¤§å¾ªç¯æ¬¡æ•°ï¼Œå½»åº•é¿å…æ­»å¾ªç¯</td></tr><tr><td>è¿­ä»£å™¨è¿”å›</td><td>æ”¯æŒæŒ‰éœ€éå†ï¼Œåˆ†ç‰‡å¤„ç†å®Œæˆåç«‹å³é‡Šæ”¾å†…å­˜</td></tr></tbody></table>
<h3 data-id="heading-11">å…­ã€æ³¨æ„äº‹é¡¹</h3>
<ol>
<li><strong>ç¼–ç ä¸€è‡´æ€§</strong>ï¼šåˆ›å»º<code>Reader</code>æ—¶éœ€æŒ‡å®šç¼–ç ï¼ˆå¦‚UTF-8ï¼‰ï¼Œé¿å…ä¸åŒç¼–ç å¯¼è‡´çš„å­—ç¬¦è§£æé”™è¯¯ï¼›</li>
<li><strong>ç¼“å†²åŒºå¤§å°è°ƒæ•´</strong>ï¼šå°æ–‡ä»¶ï¼ˆ&lt;1MBï¼‰å»ºè®®ç”¨8192ï¼Œè¶…å¤§æ–‡ä»¶ï¼ˆ&gt;100MBï¼‰å»ºè®®ç”¨16384/32768ï¼Œå‡å°‘IOæ¬¡æ•°ï¼›</li>
<li><strong>å¼‚å¸¸æ–‡æœ¬å¤„ç†</strong>ï¼šè‹¥æ–‡æœ¬æ— ä»»ä½•å¥å­ç»“æŸç¬¦ï¼ˆå¦‚çº¯æ•°å­—/ä¹±ç ï¼‰ï¼Œä¼šè§¦å‘å…œåº•æŒ‰æœ€å¤§é•¿åº¦åˆ†å‰²ï¼Œéœ€åœ¨æ—¥å¿—ä¸­ç›‘æ§æ­¤ç±»æƒ…å†µï¼›</li>
<li><strong>èµ„æºé‡Šæ”¾</strong>ï¼šå¿…é¡»é€šè¿‡<code>try-with-resources</code>å…³é—­<code>Reader</code>ï¼Œé¿å…æ–‡ä»¶å¥æŸ„æ³„æ¼ï¼›</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šåˆ†ç‰‡å¤„ç†ï¼ˆå‘é‡åŒ–/å­˜å‚¨ï¼‰å»ºè®®ç»“åˆçº¿ç¨‹æ± å¼‚æ­¥æ‰§è¡Œï¼Œæå‡æ•´ä½“æ•ˆç‡ï¼›</li>
<li><strong>å†…å­˜ç›‘æ§</strong>ï¼šå¤„ç†GBçº§æ–‡æœ¬æ—¶ï¼Œå»ºè®®ç›‘æ§JVMå †å†…å­˜ï¼Œé¿å…ç¼“å†²åŒº+åˆ†ç‰‡ç»“æœé›†å ç”¨è¿‡å¤šå†…å­˜ï¼›</li>
<li><strong>ç‰¹æ®Šå­—ç¬¦å¤„ç†</strong>ï¼šè‹¥æ–‡æœ¬åŒ…å«å¤§é‡ç‰¹æ®Šç¬¦å·ï¼ˆå¦‚\t/\rï¼‰ï¼Œéœ€åœ¨åˆ†ç‰‡å‰å…ˆæ ¼å¼åŒ–æ¸…ç†ã€‚</li>
</ol>
<h3 data-id="heading-12">ä¸ƒã€æ‰©å±•å»ºè®®</h3>
<ol>
<li><strong>è‡ªå®šä¹‰ç»“æŸç¬¦</strong>ï¼šå¼€æ”¾<code>SENTENCE_END_PATTERN</code>é…ç½®ï¼Œæ”¯æŒä¸šåŠ¡è‡ªå®šä¹‰å¥å­ç»“æŸç¬¦ï¼›</li>
<li><strong>åˆ†ç‰‡è¿‡æ»¤</strong>ï¼šå¢åŠ ç©ºåˆ†ç‰‡/çŸ­åˆ†ç‰‡è¿‡æ»¤é€»è¾‘ï¼ˆå¦‚è¿‡æ»¤é•¿åº¦&lt;50çš„åˆ†ç‰‡ï¼‰ï¼›</li>
<li><strong>è¿›åº¦å›è°ƒ</strong>ï¼šå¢åŠ åˆ†ç‰‡è¿›åº¦å›è°ƒå‡½æ•°ï¼Œä¾¿äºå‰ç«¯å±•ç¤ºå¤„ç†è¿›åº¦ï¼›</li>
<li><strong>æ‰¹é‡å†™å…¥</strong>ï¼šç»“åˆESçš„bulkå†™å…¥ï¼Œç§¯ç´¯ä¸€å®šæ•°é‡åˆ†ç‰‡åæ‰¹é‡å­˜å‚¨ï¼Œå‡å°‘ç½‘ç»œè¯·æ±‚ï¼›</li>
<li><strong>è¶…æ—¶æ§åˆ¶</strong>ï¼šä¸ºåˆ†ç‰‡å¤„ç†å¢åŠ è¶…æ—¶æœºåˆ¶ï¼Œé¿å…å•ä¸ªåˆ†ç‰‡å¤„ç†è€—æ—¶è¿‡é•¿ï¼›</li>
<li><strong>ç›‘æ§æŒ‡æ ‡</strong>ï¼šç»Ÿè®¡åˆ†ç‰‡æ€»æ•°ã€å¹³å‡åˆ†ç‰‡é•¿åº¦ã€å¤„ç†è€—æ—¶ï¼Œä¾¿äºæ€§èƒ½è°ƒä¼˜ï¼›</li>
<li><strong>è‡ªé€‚åº”ç¼“å†²åŒº</strong>ï¼šæ ¹æ®æ–‡æœ¬è¯»å–é€Ÿåº¦åŠ¨æ€è°ƒæ•´ç¼“å†²åŒºå¤§å°ï¼Œå¹³è¡¡æ€§èƒ½ä¸å†…å­˜ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PyTorch 2.0 æ ¸å¿ƒæŠ€æœ¯æ·±åº¦è§£ætorch.compile ä»åŸç†åˆ°å®è·µ]]></title>    <link>https://juejin.cn/post/7587325326045675529</link>    <guid>https://juejin.cn/post/7587325326045675529</guid>    <pubDate>2025-12-25T01:55:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587325326045675529" data-draft-id="7587336857537658889" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PyTorch 2.0 æ ¸å¿ƒæŠ€æœ¯æ·±åº¦è§£ætorch.compile ä»åŸç†åˆ°å®è·µ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-25T01:55:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ•…æ—§"/> <meta itemprop="url" content="https://juejin.cn/user/3006493596857081"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PyTorch 2.0 æ ¸å¿ƒæŠ€æœ¯æ·±åº¦è§£ætorch.compile ä»åŸç†åˆ°å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3006493596857081/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ•…æ—§
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T01:55:51.000Z" title="Thu Dec 25 2025 01:55:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>PyTorch 2.0 æ ¸å¿ƒæŠ€æœ¯æ·±åº¦è§£ætorch.compile ä»åŸç†åˆ°å®è·µ</strong></h2>
<h3 data-id="heading-1"><strong>å¼•è¨€</strong></h3>
<p>éšç€æ·±åº¦å­¦ä¹ æ¨¡å‹å¤æ‚åº¦çš„ä¸æ–­æå‡ï¼Œæ¨¡å‹æ¨ç†å’Œè®­ç»ƒçš„æ€§èƒ½ä¼˜åŒ–æˆä¸ºäº†ä¸šç•Œå…³æ³¨çš„ç„¦ç‚¹ã€‚PyTorch 2.0 å¼•å…¥çš„ torch.compile åŠŸèƒ½ï¼Œé€šè¿‡å³æ—¶ç¼–è¯‘ï¼ˆJITï¼‰æŠ€æœ¯å®ç°äº†æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚æœ¬æ–‡å°†ä»æŠ€æœ¯åŸç†ã€æ¶æ„è®¾è®¡åˆ°å®é™…åº”ç”¨ï¼Œå…¨é¢è§£æè¿™ä¸€é©å‘½æ€§ç‰¹æ€§ã€‚</p>
<h3 data-id="heading-2"><strong>1. æŠ€æœ¯èƒŒæ™¯ä¸å®šä½</strong></h3>
<h4 data-id="heading-3"><strong>1.1 ä» Eager åˆ° Graph æ¨¡å¼çš„æ¼”è¿›</strong></h4>
<p>ä¼ ç»Ÿçš„ PyTorch é‡‡ç”¨ <strong>Eager æ‰§è¡Œæ¨¡å¼</strong>ï¼Œæ¯ä¸ªæ“ä½œéƒ½ä¼šç«‹å³æ‰§è¡Œï¼Œè¿™ç§æ–¹å¼è™½ç„¶è°ƒè¯•å‹å¥½ï¼Œä½†å­˜åœ¨ä»¥ä¸‹æ€§èƒ½ç“¶é¢ˆï¼š</p>
<p>â— <strong>Python è§£é‡Šå™¨å¼€é”€</strong>ï¼šé¢‘ç¹çš„ Python å‡½æ•°è°ƒç”¨</p>
<p>â— <strong>å†…å­˜è®¿é—®æ•ˆç‡ä½</strong>ï¼šæ— æ³•è¿›è¡Œå…¨å±€å†…å­˜ä¼˜åŒ–</p>
<p>â— <strong>ç®—å­èåˆå›°éš¾</strong>ï¼šç¼ºä¹å…¨å±€è§†å›¾è¿›è¡Œä¼˜åŒ–</p>
<p>torch.compile ä½œä¸º <strong>Graph æ¨¡å¼</strong> çš„æ–°å®ç°ï¼Œä¸ TorchScript å’Œ FX Tracing å¹¶åˆ—ï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼è§£å†³æ€§èƒ½é—®é¢˜ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ä¼ ç»Ÿ Eager æ¨¡å¼</span>
def traditional_forward(x, y): Â  Â 
 Â   <span class="hljs-attr">a</span> = torch.sin(x) Â  Â  Â <span class="hljs-comment"># ç«‹å³æ‰§è¡Œ Â  Â </span>
 Â   <span class="hljs-attr">b</span> = torch.cos(y) Â  Â  Â <span class="hljs-comment"># ç«‹å³æ‰§è¡Œ Â  Â  Â </span>
 Â   return a + b Â  Â  Â  Â  Â <span class="hljs-comment"># ç«‹å³æ‰§è¡Œ</span>
<span class="hljs-comment"># torch.compile ä¼˜åŒ–å@</span>
torch.compiledef optimized_forward(x, y): Â  Â 
 Â   <span class="hljs-attr">a</span> = torch.sin(x) Â  Â  Â <span class="hljs-comment"># å›¾æ•è· Â  </span>
 Â   <span class="hljs-attr">b</span> = torch.cos(y) Â  Â  Â <span class="hljs-comment"># å›¾æ•è· Â  Â </span>
 Â   return a + b Â  Â  Â  Â  Â <span class="hljs-comment"># ç”Ÿæˆèåˆkernel</span>
</code></pre>
<h4 data-id="heading-4"><strong>1.2 æ ¸å¿ƒä¼˜åŠ¿</strong></h4>
<p>â— <strong>é›¶ä»£ç ä¿®æ”¹</strong>ï¼šä»…éœ€æ·»åŠ è£…é¥°å™¨æˆ–å‡½æ•°è°ƒç”¨</p>
<p>â— <strong>åŠ¨æ€å›¾æ”¯æŒ</strong>ï¼šä¿æŒ PyTorch çš„çµæ´»æ€§</p>
<p>â— <strong>æ˜¾è‘—æ€§èƒ½æå‡</strong>ï¼šå…¸å‹åœºæ™¯ä¸‹ 1.3-2x åŠ é€Ÿæ¯”</p>
<h3 data-id="heading-5"><strong>2. ä½¿ç”¨æ–¹å¼ä¸æœ€ä½³å®è·µ</strong></h3>
<h4 data-id="heading-6"><strong>2.1 åŸºç¡€ç”¨æ³•</strong></h4>
<pre><code class="hljs language-ini" lang="ini">import torch
<span class="hljs-comment"># æ–¹å¼1ï¼šå‡½æ•°è°ƒç”¨</span>
def model_forward(x, y): Â  Â 
    <span class="hljs-attr">a</span> = torch.sin(x) Â  Â 
    <span class="hljs-attr">b</span> = torch.cos(y) Â  Â 
    return a + <span class="hljs-attr">bcompiled_model</span> = torch.compile(model_forward)
    <span class="hljs-attr">result</span> = compiled_model(torch.randn(<span class="hljs-number">1000</span>, <span class="hljs-number">1000</span>), torch.randn(<span class="hljs-number">1000</span>, <span class="hljs-number">1000</span>))
<span class="hljs-comment"># æ–¹å¼2ï¼šè£…é¥°å™¨ï¼ˆæ¨èï¼‰</span>
@torch.compiledef optimized_model(x, y): Â  Â 
    <span class="hljs-attr">a</span> = torch.sin(x) Â  Â 
    <span class="hljs-attr">b</span> = torch.cos(y) Â  Â 
    return a + <span class="hljs-attr">bresult</span> = optimized_model(torch.randn(<span class="hljs-number">1000</span>, <span class="hljs-number">1000</span>), torch.randn(<span class="hljs-number">1000</span>, <span class="hljs-number">1000</span>))
</code></pre>
<h4 data-id="heading-7"><strong>2.2 é«˜çº§é…ç½®</strong></h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># è‡ªå®šä¹‰ç¼–è¯‘é€‰é¡¹</span>
@torch.compile( Â  Â 
    <span class="hljs-attr">mode</span>=<span class="hljs-string">"max-autotune"</span>, Â  Â <span class="hljs-comment"># æœ€å¤§ä¼˜åŒ–æ¨¡å¼ Â  Â </span>
    <span class="hljs-attr">backend</span>=<span class="hljs-string">"inductor"</span>, Â  Â  <span class="hljs-comment"># æŒ‡å®šåç«¯ Â  Â </span>
    <span class="hljs-attr">dynamic</span>=<span class="hljs-literal">True</span> Â  Â  Â  Â  Â  <span class="hljs-comment"># æ”¯æŒåŠ¨æ€shape</span>
)
def advanced_model(x): Â  Â 
    return torch.nn.functional.relu(x @ x.T)
</code></pre>
<h3 data-id="heading-8"><strong>3. æ ¸å¿ƒæ¶æ„æ·±åº¦è§£æ</strong></h3>
<h4 data-id="heading-9"><strong>3.1 æ•´ä½“æµç¨‹æ¦‚è§ˆ</strong></h4>
<p>torch.compile çš„å·¥ä½œæµç¨‹å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªæ ¸å¿ƒé˜¶æ®µï¼š</p>
<p>[MISSING IMAGE: , ]</p>
<p>null</p>
<ol>
<li><strong>å›¾æ•è·ï¼ˆTorchDynamoï¼‰</strong> ï¼šå°† Python ä»£ç è½¬æ¢ä¸º FX å›¾</li>
<li><strong>å›¾ä¼˜åŒ–ï¼ˆAOT Autogradï¼‰</strong> ï¼šè¿›è¡Œç®—å­èåˆå’Œå†…å­˜ä¼˜åŒ–</li>
<li><strong>ä»£ç ç”Ÿæˆï¼ˆTorchInductorï¼‰</strong> ï¼šç”Ÿæˆé«˜æ€§èƒ½çš„åº•å±‚ä»£ç </li>
</ol>
<h4 data-id="heading-10"><strong>3.2 TorchDynamoï¼šPython å­—èŠ‚ç çš„é­”æ³•å¸ˆ</strong></h4>
<p>TorchDynamo æ˜¯æ•´ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒï¼Œå®ƒé€šè¿‡ <strong>CPython Frame Evaluation Hook</strong> å®ç°äº†å¯¹ Python å­—èŠ‚ç çš„åŠ¨æ€é‡å†™ã€‚</p>
<p>[MISSING IMAGE: , ]</p>
<p>null</p>
<h5 data-id="heading-11"><strong>3.2.1 CPython Frame Evaluation Hook æœºåˆ¶</strong></h5>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç®€åŒ–çš„å·¥ä½œæµç¨‹</span>
def custom_eval_frame(frame, exc): Â  Â 
    <span class="hljs-comment"># 1. æ£€æŸ¥æ˜¯å¦éœ€è¦è·³è¿‡ç¼–è¯‘ Â  Â </span>
    if should_skip_frame(frame): Â  Â  Â  Â 
        return default_eval_frame(frame, exc) Â  Â  Â  Â 
    
    <span class="hljs-comment"># 2. æ£€æŸ¥ç¼“å­˜ Â  Â </span>
    <span class="hljs-attr">cached_code</span> = check_cache(frame.f_code) Â  Â 
 Â  Â if cached_code and guards_check_passed(): Â  Â  Â  Â 
 Â  Â  Â   return execute_compiled_code(cached_code) Â  Â  Â  Â 
    
    <span class="hljs-comment"># 3. ç¬¦å·æ‰§è¡Œå’Œå›¾æ•è· Â  Â </span>
    fx_graph, <span class="hljs-attr">guards</span> = symbolic_evaluation(frame.f_code) Â  Â  Â  Â 
    
    <span class="hljs-comment"># 4. åç«¯ç¼–è¯‘ Â  Â </span>
    <span class="hljs-attr">compiled_fn</span> = backend_compile(fx_graph) Â  Â  Â  Â 
    <span class="hljs-comment"># 5. ç”Ÿæˆæ–°å­—èŠ‚ç å¹¶ç¼“å­˜ Â  Â </span>
    <span class="hljs-attr">new_bytecode</span> = generate_wrapper_code(compiled_fn) Â  Â 
    cache_result(frame.f_code, new_bytecode, guards) Â  Â  Â  Â 
    return execute_compiled_code(new_bytecode)
</code></pre>
<h5 data-id="heading-12"><strong>3.2.2 Guards æœºåˆ¶ï¼šåŠ¨æ€å±æ€§çš„å®ˆæŠ¤è€…</strong></h5>
<p>Guards æ˜¯ TorchDynamo ç¡®ä¿ç¼–è¯‘ç»“æœæ­£ç¡®æ€§çš„å…³é”®æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç¤ºä¾‹ï¼štensor shape guard</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">shape_guard</span>(<span class="hljs-params">tensor, expected_shape</span>): Â  Â 
    <span class="hljs-keyword">return</span> tensor.shape == expected_shape
<span class="hljs-comment"># ç¤ºä¾‹ï¼šæ•°æ®ç±»å‹ guard Â </span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">dtype_guard</span>(<span class="hljs-params">tensor, expected_dtype</span>): Â  Â 
    <span class="hljs-keyword">return</span> tensor.dtype == expected_dtype
</code></pre>
<p>å½“ guards æ£€æŸ¥å¤±è´¥æ—¶ï¼Œä¼šè§¦å‘ï¼š</p>
<ul>
<li><strong>Graph Break</strong>ï¼šå›é€€åˆ° eager æ¨¡å¼</li>
<li><strong>Recompilation</strong>ï¼šé‡æ–°ç¼–è¯‘ç”Ÿæˆæ–°çš„ä¼˜åŒ–ä»£ç </li>
</ul>
<h4 data-id="heading-13"><strong>3.3 TorchInductorï¼šé«˜æ€§èƒ½ä»£ç çš„ç”Ÿæˆå™¨</strong></h4>
<p>TorchInductor ä½œä¸ºé»˜è®¤åç«¯ï¼Œè´Ÿè´£å°† FX å›¾è½¬æ¢ä¸ºé«˜æ•ˆçš„åº•å±‚ä»£ç ã€‚</p>
<p>[MISSING IMAGE: , ]</p>
<p>null</p>
<h5 data-id="heading-14"><strong>3.3.1 ç®—å­åˆ†è§£ï¼ˆOperator Decompositionï¼‰</strong></h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¤æ‚ç®—å­åˆ†è§£ä¸ºåŸºç¡€ç®—å­</span>
<span class="hljs-meta">@register_decomposition(<span class="hljs-params">torch.ops.aten.log2</span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">log2_decomposition</span>(<span class="hljs-params">x</span>): Â  Â 
    log2_scale = <span class="hljs-number">1</span> / math.log(<span class="hljs-number">2</span>) Â  Â 
    <span class="hljs-keyword">return</span> torch.log(x) * log2_scale
â€‹
<span class="hljs-meta">@register_decomposition(<span class="hljs-params">torch.ops.aten.gelu</span>) Â </span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">gelu_decomposition</span>(<span class="hljs-params">x</span>): Â  Â 
    <span class="hljs-keyword">return</span> x * <span class="hljs-number">0.5</span> * (<span class="hljs-number">1.0</span> + torch.erf(x / math.sqrt(<span class="hljs-number">2.0</span>)))
</code></pre>
<h5 data-id="heading-15"><strong>3.3.2 IR é™çº§ï¼šä» FX å›¾åˆ° Loop-level IR</strong></h5>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># TorchInductor çš„ define-by-run IR ç¤ºä¾‹</span>
def pointwise_kernel(index): Â  Â 
    i0, <span class="hljs-attr">i1</span> = index Â  Â 
    <span class="hljs-comment"># åŠ è½½è¾“å…¥æ•°æ® Â  Â </span>
    <span class="hljs-attr">tmp0</span> = ops.load(<span class="hljs-string">"input"</span>, i0 * stride0 + i1 * stride1) Â  Â 
    <span class="hljs-comment"># æ‰§è¡Œè®¡ç®— Â  Â </span>
    <span class="hljs-attr">tmp1</span> = ops.log(tmp0) Â  Â 
    <span class="hljs-attr">tmp2</span> = ops.mul(tmp1, <span class="hljs-number">1.4426950408889634</span>) Â <span class="hljs-comment"># log2 scale Â  Â </span>
    <span class="hljs-comment"># å­˜å‚¨ç»“æœ Â  Â </span>
    return tmp2
    
<span class="hljs-comment"># ç”Ÿæˆçš„ Triton kernel ç»“æ„</span>
<span class="hljs-attr">buf0</span> = TensorBox(StorageBox(ComputedBuffer( Â  Â 
    <span class="hljs-attr">name</span>=<span class="hljs-string">'buf0'</span>, Â  Â 
    <span class="hljs-attr">layout</span>=FixedLayout(<span class="hljs-string">'cuda'</span>, torch.float32, size=[M, N]), Â  Â 
    <span class="hljs-attr">data</span>=Pointwise(inner_fn=pointwise_kernel, ranges=[M, N])
)))
</code></pre>
<h5 data-id="heading-16"><strong>3.3.3 ä»£ç ç”Ÿæˆï¼šTriton ä¸ C++ åç«¯</strong></h5>
<p>æœ€ç»ˆç”Ÿæˆçš„ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç”Ÿæˆçš„ Triton kernel ä»£ç ç‰‡æ®µ</span>
@triton.jit
def triton_poi_fused_add_div_mul_0(in_ptr0, in_ptr1, in_ptr2, out_ptr0, xnumel, XBLOCK : tl.constexpr): Â  Â 
    <span class="hljs-attr">xnumel</span> = <span class="hljs-number">1000000</span> Â  Â 
    <span class="hljs-attr">xoffset</span> = tl.program_id(<span class="hljs-number">0</span>) * XBLOCK Â  Â 
    <span class="hljs-attr">xindex</span> = x<span class="hljs-literal">off</span>set + tl.arange(<span class="hljs-number">0</span>, XBLOCK)[:] Â  Â 
    <span class="hljs-attr">xmask</span> = xindex &lt; xnumel Â  Â 
    <span class="hljs-attr">x0</span> = xindex Â  Â 
    <span class="hljs-attr">tmp0</span> = tl.load(in_ptr0 + (x0), xmask) Â  Â 
    <span class="hljs-attr">tmp1</span> = tl.load(in_ptr1 + (x0), xmask) Â  Â 
    <span class="hljs-attr">tmp2</span> = tmp0 / tmp1 Â <span class="hljs-comment"># div operation Â  Â </span>
    <span class="hljs-attr">tmp3</span> = tmp2 * <span class="hljs-number">0.1</span> Â  <span class="hljs-comment"># mul operation Â  Â  Â </span>
    <span class="hljs-attr">tmp4</span> = tl.load(in_ptr2 + (x0), xmask) Â  Â 
    <span class="hljs-attr">tmp5</span> = tmp4 + tmp3 Â <span class="hljs-comment"># add operation Â   tl.store(out_ptr0 + (x0), tmp5, xmask)</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6c4447a39824e24a52a4ecc8fc93322~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWF5pen:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767232551&amp;x-signature=6sBaqjBayq%2BxAb%2BqJ%2BJYyQ3ojzs%3D" alt="image-20251225094250899" loading="lazy"/></p>
<p>ä»ä»£ç å¯ä»¥çœ‹åˆ°ï¼ŒTorchInductor ç”Ÿæˆäº†é«˜åº¦ä¼˜åŒ–çš„ Triton kernelï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>ç®—å­èåˆ</strong>ï¼šå°† divã€mulã€add æ“ä½œèåˆä¸ºå•ä¸ª kernel</li>
<li><strong>å†…å­˜ä¼˜åŒ–</strong>ï¼šå‡å°‘ä¸­é—´ç»“æœçš„å†…å­˜è¯»å†™</li>
<li><strong>å¹¶è¡ŒåŒ–</strong>ï¼šå……åˆ†åˆ©ç”¨ GPU çš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›</li>
</ul>
<h3 data-id="heading-17"><strong>4. æ€§èƒ½ä¼˜åŒ–ä¸è°ƒè¯•å®è·µ</strong></h3>
<h4 data-id="heading-18"><strong>4.1 æ€§èƒ½åˆ†æå·¥å…·</strong></h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¯ç”¨è¯¦ç»†æ—¥å¿—</span>
import os
os.environ<span class="hljs-section">['TORCH_COMPILE_DEBUG']</span> = '1'
<span class="hljs-comment"># æ€§èƒ½å¯¹æ¯”æµ‹è¯•</span>
def benchmark_model(): Â  Â 
    <span class="hljs-attr">model</span> = MyModel() Â  Â 
    <span class="hljs-attr">compiled_model</span> = torch.compile(model) Â  Â  Â  Â 
    
    <span class="hljs-comment"># é¢„çƒ­ Â  Â </span>
    for _ in range(10): Â  Â  Â  Â 
 Â       <span class="hljs-attr">_</span> = compiled_model(sample_input) Â  Â  Â  Â 
 Â  Â 
 Â  Â <span class="hljs-comment"># æ€§èƒ½æµ‹è¯• Â  </span>
 Â   <span class="hljs-attr">start_time</span> = time.time() Â  Â 
 Â  Â for _ in range(100): Â  Â  Â  Â 
 Â       <span class="hljs-attr">result</span> = compiled_model(sample_input) Â  Â 
 Â   <span class="hljs-attr">end_time</span> = time.time() Â  Â  Â  Â 
 Â  Â 
 Â   print(f"Average time: {(end_time - start_time) / 100:.4f}s")
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad7ac638151e473e8e39bac666f3e4af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWF5pen:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767232551&amp;x-signature=1ctSx%2BQIs79Lx1qKTaqtn7qc280%3D" alt="image-20251225093838985" loading="lazy"/></p>
<h4 data-id="heading-19"><strong>4.2 å¸¸è§é—®é¢˜æ’æŸ¥</strong></h4>
<h5 data-id="heading-20"><strong>4.2.1 ç¼–è¯‘å¤±è´¥è¯Šæ–­</strong></h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¼€å¯è°ƒè¯•æ¨¡å¼</span>
<span class="hljs-built_in">export</span> TORCH_COMPILE_DEBUG=1
<span class="hljs-built_in">export</span> TORCH_LOGS=<span class="hljs-string">"+dynamo,+inductor"</span>
â€‹
<span class="hljs-comment"># è¿è¡Œç¨‹åºåæ£€æŸ¥ç”Ÿæˆçš„è°ƒè¯•æ–‡ä»¶</span>
<span class="hljs-built_in">ls</span> /tmp/torchinductor_*/
<span class="hljs-comment"># - output_code.py Â  Â   # ç”Ÿæˆçš„ä»£ç </span>
<span class="hljs-comment"># - fx_graph_readable.py # å¯è¯»çš„FXå›¾</span>
<span class="hljs-comment"># - run_*_benchmark.py Â  # æ€§èƒ½æµ‹è¯•è„šæœ¬</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/767b63a752904e919036ddac1d46abbd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWF5pen:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767232551&amp;x-signature=n8y2Rn9NisyXCR%2BEVmcXUFBBYZM%3D" alt="image-20251225093725089" loading="lazy"/></p>
<h5 data-id="heading-21"><strong>4.2.2 æ€§èƒ½å›å½’åˆ†æ</strong></h5>
<p>é€šè¿‡è°ƒè¯•è¾“å‡ºå¯ä»¥çœ‹åˆ°å®Œæ•´çš„ç¼–è¯‘æ ˆä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>æ¨¡å—è°ƒç”¨é“¾</strong>ï¼šä»ç”¨æˆ·ä»£ç åˆ°åº•å±‚ç®—å­çš„å®Œæ•´è·¯å¾„</li>
<li><strong>å›¾æ•è·è¿‡ç¨‹</strong>ï¼šTorchDynamo çš„ç¬¦å·æ‰§è¡Œè¿‡ç¨‹</li>
<li><strong>ä»£ç ç”Ÿæˆç»“æœ</strong>ï¼šæœ€ç»ˆç”Ÿæˆçš„ä¼˜åŒ–ä»£ç </li>
</ul>
<h4 data-id="heading-22"><strong>4.3 æœ€ä½³å®è·µå»ºè®®</strong></h4>
<ol>
<li><strong>æ¨¡å‹é¢„çƒ­</strong>ï¼šé¦–æ¬¡ç¼–è¯‘æœ‰å¼€é”€ï¼Œå»ºè®®è¿›è¡Œé¢„çƒ­</li>
<li><strong>æ‰¹é‡å¤„ç†</strong>ï¼šç¼–è¯‘å¯¹å¤§batchæ›´å‹å¥½</li>
<li><strong>é¿å…åŠ¨æ€æ§åˆ¶æµ</strong>ï¼šå‡å°‘ graph break</li>
<li><strong>åˆç†ä½¿ç”¨ dynamic=True</strong>ï¼šå¹³è¡¡çµæ´»æ€§å’Œæ€§èƒ½</li>
</ol>
<h3 data-id="heading-23"><strong>5. å®é™…åº”ç”¨æ¡ˆä¾‹</strong></h3>
<h4 data-id="heading-24"><strong>5.1 Transformer æ¨¡å‹ä¼˜åŒ–</strong></h4>
<pre><code class="hljs language-ini" lang="ini">class OptimizedTransformer(nn.Module): Â  Â 
    def __init__(self, config): Â  Â  Â  Â 
        super().__init__() Â  Â  Â  Â 
        <span class="hljs-attr">self.attention</span> = MultiHeadAttention(config) Â  Â  Â  Â 
        <span class="hljs-attr">self.feed_forward</span> = FeedForward(config) Â  Â  Â  Â 
        <span class="hljs-attr">self.layer_norm1</span> = nn.LayerNorm(config.hidden_size) Â  Â  Â  Â 
        <span class="hljs-attr">self.layer_norm2</span> = nn.LayerNorm(config.hidden_size) Â  Â  Â  Â 
 Â   @torch.compile Â  Â 
 Â   def forward(self, x, <span class="hljs-attr">attention_mask</span>=None): Â  Â  Â  Â 
 Â  Â <span class="hljs-comment"># Self-attention Â  Â  Â  Â </span>
 Â   <span class="hljs-attr">attn_output</span> = self.attention(x, attention_mask) Â  Â  Â  Â 
 Â   <span class="hljs-attr">x</span> = self.layer_norm1(x + attn_output) Â  Â  Â  Â  Â  Â  Â  Â 
 Â  Â 
 Â  Â <span class="hljs-comment"># Feed-forward Â  Â  Â  Â </span>
 Â   <span class="hljs-attr">ff_output</span> = self.feed_forward(x) Â  Â  Â  Â 
 Â   <span class="hljs-attr">x</span> = self.layer_norm2(x + ff_output) Â  Â  Â  Â  Â  Â  Â  Â 
 Â  Â 
 Â   return x
<span class="hljs-comment"># æ€§èƒ½æå‡ï¼š1.5-2x åŠ é€Ÿæ¯”</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2cfbfdf870f94f88b6e98fea7125098f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWF5pen:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767232551&amp;x-signature=OO5%2FsFZkcoNLskao5eLVH03WWjc%3D" alt="image-20251225093546096" loading="lazy"/></p>
<h3 data-id="heading-25"><strong>ç»“è®º</strong></h3>
<p>torch.compile ä»£è¡¨äº† PyTorch åœ¨æ€§èƒ½ä¼˜åŒ–æ–¹é¢çš„é‡å¤§çªç ´ã€‚é€šè¿‡ TorchDynamo çš„å­—èŠ‚ç é‡å†™ã€AOT Autograd çš„å›¾ä¼˜åŒ–å’Œ TorchInductor çš„ä»£ç ç”Ÿæˆï¼Œå®ç°äº†åœ¨ä¿æŒ PyTorch çµæ´»æ€§çš„åŒæ—¶è·å¾—æ¥è¿‘é™æ€å›¾çš„æ€§èƒ½ã€‚</p>
<p>å¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œtorch.compile æä¾›äº†ä¸€ä¸ªå‡ ä¹é›¶æˆæœ¬çš„æ€§èƒ½æå‡æ–¹æ¡ˆã€‚åªéœ€è¦æ·»åŠ ä¸€ä¸ªè£…é¥°å™¨ï¼Œå°±èƒ½è·å¾—æ˜¾è‘—çš„åŠ é€Ÿæ•ˆæœã€‚éšç€æŠ€æœ¯çš„ä¸æ–­æˆç†Ÿï¼Œtorch.compile å¿…å°†æˆä¸º PyTorch ç”Ÿæ€ç³»ç»Ÿä¸­ä¸å¯æˆ–ç¼ºçš„æ ¸å¿ƒç»„ä»¶ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»Šå¤©ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ Cè¯­è¨€çš„ â€œå‡½æ•°â€]]></title>    <link>https://juejin.cn/post/7587261253912838159</link>    <guid>https://juejin.cn/post/7587261253912838159</guid>    <pubDate>2025-12-25T02:03:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587261253912838159" data-draft-id="7582077175002218539" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»Šå¤©ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ Cè¯­è¨€çš„ â€œå‡½æ•°â€"/> <meta itemprop="keywords" content="C"/> <meta itemprop="datePublished" content="2025-12-25T02:03:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å¼ å¿ƒç»ªçƒ‚å°¾"/> <meta itemprop="url" content="https://juejin.cn/user/4135731991953737"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»Šå¤©ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ Cè¯­è¨€çš„ â€œå‡½æ•°â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4135731991953737/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å¼ å¿ƒç»ªçƒ‚å°¾
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T02:03:10.000Z" title="Thu Dec 25 2025 02:03:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">**<strong>å‡½æ•°ï¼šå®ç°ç‰¹å®šåŠŸèƒ½çš„ä»£ç </strong></h2>
<p>é€šä¿—çš„è¯ï¼šæˆ‘ç»™å®ƒä»€ä¹ˆï¼Œå®ƒå°±ç»™æˆ‘åšä»€ä¹ˆäº‹ï¼Œè¿˜ç»™æˆ‘ä»€ä¹ˆ</p>
<p>ä¸¤ä¸ªæ­¥éª¤ï¼š
1.å…ˆå®šä¹‰å‡½æ•°ï¼š
æ ¼å¼</p>
<pre><code class="hljs">è¿”å›å€¼ç±»å‹ å‡½æ•°åï¼ˆå‚æ•°åˆ—è¡¨ï¼‰{

å‡½æ•°å…·ä½“çš„ä»£ç 
}
</code></pre>
<p>2.	è°ƒç”¨å‡½æ•°ï¼š</p>
<pre><code class="hljs">æ ¼å¼

è¿”å›å€¼ = å‡½æ•°åï¼ˆå‚æ•°ï¼‰   
</code></pre>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span></span>

<span class="hljs-comment">// å®ç°ç‰¹å®šåŠŸèƒ½çš„ä»£ç æ®µ</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">printAge</span><span class="hljs-params">()</span>{
	<span class="hljs-type">int</span> age = <span class="hljs-number">18</span>;
	<span class="hljs-built_in">printf</span>(&amp;#<span class="hljs-number">34</span>;------------------\n&amp;#<span class="hljs-number">34</span>;);
	<span class="hljs-built_in">printf</span>(&amp;#<span class="hljs-number">34</span>;å¹´é¾„æ˜¯:%d\n&amp;#<span class="hljs-number">34</span>;,age);
	<span class="hljs-built_in">printf</span>(&amp;#<span class="hljs-number">34</span>;-------------------\n&amp;#<span class="hljs-number">34</span>;);
} 
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>{
	<span class="hljs-comment">// å‡½æ•°</span>
	printAge();	<span class="hljs-comment">// è°ƒç”¨å‡½æ•° </span>
		
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
} 
</code></pre>
<p>è¿è¡Œç»“æœ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b2cf65f76314021a3337841a61993fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5byg5b-D57uq54OC5bC-:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767232990&amp;x-signature=2b%2Bm%2Bt5UCLM62uwm4hHBScy1xUg%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-1"><strong>è¿›é˜¶çŸ¥è¯†ç‚¹ï¼š</strong></h3>
<p>å¦‚ä½•è®©å®ƒåˆèƒ½è¾“å‡º18,19</p>
<p>å°±æ˜¯æŠŠint ageï¼Œç§»åˆ°printMyAge()çš„è¿™ä¸ªæ‹¬å·é‡Œé¢ï¼Œå†åœ¨ä¸‹é¢çš„"è°ƒç”¨å‡½æ•°"é‡Œé¢è¾“å…¥æƒ³è¦è¾“å‡ºçš„æ•°å­—ã€‚</p>
<p>å¦‚ä¸‹å±•ç¤ºï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">printMyAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span>{
	<span class="hljs-built_in">printf</span>(&amp;#<span class="hljs-number">34</span>;------------------\n&amp;#<span class="hljs-number">34</span>;);
	<span class="hljs-built_in">printf</span>(&amp;#<span class="hljs-number">34</span>;å¹´é¾„æ˜¯:%d\n&amp;#<span class="hljs-number">34</span>;,age);
	<span class="hljs-built_in">printf</span>(&amp;#<span class="hljs-number">34</span>;-------------------\n&amp;#<span class="hljs-number">34</span>;);
} 
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>{
	<span class="hljs-comment">// å‡½æ•°</span>
	printMyAge(<span class="hljs-number">18</span>);	<span class="hljs-comment">// è°ƒç”¨å‡½æ•° </span>
	printMyAge(<span class="hljs-number">19</span>);	<span class="hljs-comment">// è°ƒç”¨å‡½æ•° </span>

		
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
} 
</code></pre>
<p>è¿è¡Œç»“æœ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7f64e9f4d894ef788414852b2e6fa8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5byg5b-D57uq54OC5bC-:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767232990&amp;x-signature=sLeHP%2FLwCBqAHpER434Sdh7PSK8%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-2">å†è¿›é˜¶ä¸€ä¸‹</h4>
<p>æ·»åŠ ä¸€ä¸ªèº«é«˜åœ¨é‡Œé¢ï¼Œæˆ‘ä»¬åº”è¯¥æ€æ ·æ”¹å†™ä¸€ä¸‹ä»£ç ï¼š</p>
<p>å¾ˆç®€å•å°±æ˜¯åœ¨(int age),æ‹¬å·é‡Œé¢åŠ ä¸€ä¸ªå®šä¹‰ç¬¦"double"ï¼Œå°±æ˜¯è¿™æ ·(int age,double sg)ï¼Œä¸‹é¢"è°ƒç”¨å‡½æ•°åŠ ä¸ªèº«é«˜çš„æ•°å€¼å°±å®Œæˆäº†ã€‚</p>
<p>å±•ç¤ºå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span></span>

<span class="hljs-comment">// å®ç°ç‰¹å®šåŠŸèƒ½çš„ä»£ç æ®µ</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">printMyInfo</span><span class="hljs-params">(<span class="hljs-type">int</span> age,<span class="hljs-type">double</span> sg)</span>{
	<span class="hljs-built_in">printf</span>(&amp;#<span class="hljs-number">34</span>;------------------\n&amp;#<span class="hljs-number">34</span>;);
	<span class="hljs-built_in">printf</span>(&amp;#<span class="hljs-number">34</span>;å¹´é¾„æ˜¯:%d\n&amp;#<span class="hljs-number">34</span>;,age);
	<span class="hljs-built_in">printf</span>(&amp;#<span class="hljs-number">34</span>;èº«é«˜æ˜¯:%<span class="hljs-number">.2</span>f\n&amp;#<span class="hljs-number">34</span>;,sg);
	<span class="hljs-built_in">printf</span>(&amp;#<span class="hljs-number">34</span>;-------------------\n&amp;#<span class="hljs-number">34</span>;);
} 
<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>{
	<span class="hljs-comment">// å‡½æ•°</span>
	printMyInfo(<span class="hljs-number">18</span>, <span class="hljs-number">1.78</span>);	<span class="hljs-comment">// è°ƒç”¨å‡½æ•° </span>
	printMyInfo(<span class="hljs-number">19</span>, <span class="hljs-number">1.88</span>);	<span class="hljs-comment">// è°ƒç”¨å‡½æ•° </span>

		
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
} 
</code></pre>
<p>è¿è¡Œç»“æœ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3350ab9c92145ddbbca018d9d360fa8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5byg5b-D57uq54OC5bC-:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767232990&amp;x-signature=jOZrFhTCjKsZ%2BEyUJpEjgHBtKcw%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±åº¦å­¦ä¹ é©±åŠ¨çš„è§†é¢‘å¼‚å¸¸æ£€æµ‹ï¼ˆVADï¼‰ï¼ŒAIå¦‚ä½•è®©ç›‘æ§æ›´æ™ºèƒ½ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7587322796825444392</link>    <guid>https://juejin.cn/post/7587322796825444392</guid>    <pubDate>2025-12-25T02:51:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587322796825444392" data-draft-id="7587277503947554816" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±åº¦å­¦ä¹ é©±åŠ¨çš„è§†é¢‘å¼‚å¸¸æ£€æµ‹ï¼ˆVADï¼‰ï¼ŒAIå¦‚ä½•è®©ç›‘æ§æ›´æ™ºèƒ½ï¼Ÿ"/> <meta itemprop="keywords" content="ç®—æ³•,è®¡ç®—æœºè§†è§‰,æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2025-12-25T02:51:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CoovallyAIHub"/> <meta itemprop="url" content="https://juejin.cn/user/2461151071843739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±åº¦å­¦ä¹ é©±åŠ¨çš„è§†é¢‘å¼‚å¸¸æ£€æµ‹ï¼ˆVADï¼‰ï¼ŒAIå¦‚ä½•è®©ç›‘æ§æ›´æ™ºèƒ½ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2461151071843739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CoovallyAIHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T02:51:27.000Z" title="Thu Dec 25 2025 02:51:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ æ˜¯å¦æ›¾æƒ³è¿‡ï¼Œåœ¨æˆåƒä¸Šä¸‡çš„ç›‘æ§è§†é¢‘ä¸­ï¼Œå¦‚ä½•è®©è®¡ç®—æœºè‡ªåŠ¨è¯†åˆ«å‡ºæ‰“æ¶ã€é—¯å…¥ã€å¾˜å¾Šç­‰å¼‚å¸¸äº‹ä»¶ï¼Ÿè¿™æ­£æ˜¯è§†é¢‘å¼‚å¸¸æ£€æµ‹ï¼ˆVideo Anomaly Detection, VADï¼‰ æ‰€è¦è§£å†³çš„æ ¸å¿ƒé—®é¢˜ã€‚éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„é£é€Ÿå‘å±•ï¼ŒVAD å·²æˆä¸ºè®¡ç®—æœºè§†è§‰é¢†åŸŸçš„çƒ­ç‚¹ç ”ç©¶æ–¹å‘ï¼Œå¹¶åœ¨æ™ºèƒ½å®‰é˜²ã€è‡ªåŠ¨é©¾é©¶ã€å†…å®¹å®¡æ ¸ç­‰é¢†åŸŸå±•ç°å‡ºå·¨å¤§åº”ç”¨æ½œåŠ›ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±åŸºäºæ·±åº¦å­¦ä¹ çš„ VAD æ–¹æ³•è¿›è¡Œäº†å…¨é¢æ¢³ç†ä¸æ€»ç»“ï¼Œçœ‹çœ‹ AI å¦‚ä½•è®©è§†é¢‘ç›‘æ§å˜å¾—æ›´æ™ºèƒ½ã€‚</p>
<h2 data-id="heading-0"><strong>ä»€ä¹ˆæ˜¯è§†é¢‘å¼‚å¸¸æ£€æµ‹ï¼Ÿ</strong></h2>
<p>å¼‚å¸¸ï¼ŒæŒ‡çš„æ˜¯åç¦»æ­£å¸¸ã€æ ‡å‡†æˆ–é¢„æœŸçš„äº‹ç‰©ã€‚åœ¨è§†é¢‘ä¸­ï¼Œå¼‚å¸¸å¯èƒ½è¡¨ç°ä¸ºå¼‚å¸¸è¡Œä¸ºï¼ˆå¦‚çªç„¶å¥”è·‘ã€æ‰“æ¶ï¼‰æˆ–å¼‚å¸¸äº‹ä»¶ï¼ˆå¦‚è½¦è¾†é€†è¡Œã€ç‰©å“é—ç•™ï¼‰ã€‚VAD çš„ç›®æ ‡å°±æ˜¯è‡ªåŠ¨è¯†åˆ«å‡ºè¿™äº›â€œä¸å¯»å¸¸â€çš„ç”»é¢ã€‚</p>
<p>ä¼ ç»Ÿçš„ VAD æ–¹æ³•é€šå¸¸åˆ†ä¸ºä¸¤æ­¥ï¼šå…ˆæå–æ‰‹å·¥è®¾è®¡çš„ç‰¹å¾ï¼Œå†è®¾è®¡åˆ†ç±»å™¨è¿›è¡Œåˆ¤æ–­ã€‚ä½†è¿™ç§æ–¹å¼ä¾èµ–ä¸“å®¶ç»éªŒï¼Œéš¾ä»¥åº”å¯¹å¤æ‚å¤šå˜çš„çœŸå®åœºæ™¯ã€‚</p>
<p>éšç€æ·±åº¦å­¦ä¹ çš„å…´èµ·ï¼ŒVAD è¿›å…¥äº†æ–°çš„å‘å±•é˜¶æ®µã€‚å¦‚å›¾1æ‰€ç¤ºï¼Œè¿‘åå¹´æ¥ç›¸å…³è®ºæ–‡æ•°é‡æŒç»­å¿«é€Ÿå¢é•¿ï¼Œå°¤å…¶æ˜¯åœ¨ IEEE Xplore å’Œ Google Scholar ä¸­ï¼ŒVAD ç›¸å…³ç ”ç©¶å‘ˆç°å‡ºçˆ†å‘å¼å¢é•¿ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0397084242ec494ba4ba1ceea73482cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767235887&amp;x-signature=37V0crXT%2BOLCZzZqFr6C%2FCqHFW4%3D" alt="screenshot_2025-12-24_16-22-49.png" loading="lazy"/></p>
<p>åŒæ—¶ï¼Œæ£€æµ‹æ€§èƒ½ä¹Ÿåœ¨ä¸æ–­æå‡ã€‚å¦‚å›¾2æ‰€ç¤ºï¼Œåœ¨åŠç›‘ç£å’Œå¼±ç›‘ç£è®¾ç½®ä¸‹ï¼Œå„æ•°æ®é›†çš„æ£€æµ‹æ€§èƒ½ï¼ˆAUC æŒ‡æ ‡ï¼‰å‘ˆç¨³æ­¥ä¸Šå‡è¶‹åŠ¿ï¼Œè¡¨æ˜ç®—æ³•åœ¨ä¸æ–­è¿›æ­¥ã€‚</p>
<h2 data-id="heading-1"><strong>äº”ç§ç›‘ç£æ¨¡å¼ï¼šä½ çŸ¥é“å‡ ç§ï¼Ÿ</strong></h2>
<p>æ ¹æ®è®­ç»ƒæ—¶ä½¿ç”¨çš„æ ‡æ³¨ä¿¡æ¯ä¸åŒï¼ŒVAD å¯åˆ†ä¸ºä»¥ä¸‹äº”ç§æ¨¡å¼ï¼š</p>

<ul>
<li><strong>åŠç›‘ç£ VAD</strong></li>
</ul>
<p>ç‰¹ç‚¹ï¼šä»…ä½¿ç”¨æ­£å¸¸æ ·æœ¬è¿›è¡Œè®­ç»ƒã€‚</p>
<p>ä¼˜ç‚¹ï¼šæ— éœ€æ”¶é›†ç½•è§çš„å¼‚å¸¸æ ·æœ¬ã€‚</p>
<p>ç¼ºç‚¹ï¼šå®¹æ˜“å°†æœªè§è¿‡ä½†æ­£å¸¸çš„æ ·æœ¬è¯¯åˆ¤ä¸ºå¼‚å¸¸ã€‚</p>
<ul>
<li><strong>å¼±ç›‘ç£ VAD</strong></li>
</ul>
<p>ç‰¹ç‚¹ï¼šè®­ç»ƒè§†é¢‘åªæœ‰è§†é¢‘çº§æ ‡ç­¾ï¼ˆæ­£å¸¸/å¼‚å¸¸ï¼‰ï¼Œæ²¡æœ‰å…·ä½“å‘ç”Ÿæ—¶é—´ã€‚</p>
<p>ä¼˜ç‚¹ï¼šæ ‡æ³¨æˆæœ¬ä½ã€‚</p>
<p>ç¼ºç‚¹ï¼šç®—æ³•è®¾è®¡å¤æ‚ï¼Œå®¹æ˜“â€œç›²çŒœâ€ã€‚</p>
<ul>
<li><strong>å…¨ç›‘ç£ VAD</strong></li>
</ul>
<p>ç‰¹ç‚¹ï¼šæ¯ä¸ªå¼‚å¸¸éƒ½æœ‰ç²¾ç¡®çš„æ—¶é—´æ®µæ ‡æ³¨ã€‚</p>
<p>ä¼˜ç‚¹ï¼šæ£€æµ‹æ€§èƒ½é«˜ã€‚</p>
<p>ç¼ºç‚¹ï¼šæ ‡æ³¨æˆæœ¬æé«˜ï¼Œç°å®ä¸­éš¾ä»¥å¤§è§„æ¨¡åº”ç”¨ã€‚</p>
<ul>
<li><strong>æ— ç›‘ç£ VAD</strong></li>
</ul>
<p>ç‰¹ç‚¹ï¼šå®Œå…¨æ— éœ€æ ‡æ³¨ï¼Œç›´æ¥ä»æœªæ ‡æ³¨è§†é¢‘ä¸­æ£€æµ‹å¼‚å¸¸ã€‚</p>
<p>ä¼˜ç‚¹ï¼šæ— éœ€æ ‡æ³¨ï¼Œé€‚ç”¨æ€§å¹¿ã€‚</p>
<p>ç¼ºç‚¹ï¼šæ£€æµ‹å‡†ç¡®ç‡ç›¸å¯¹è¾ƒä½ã€‚</p>
<ul>
<li><strong>å¼€æ”¾é›†ç›‘ç£ VAD</strong></li>
</ul>
<p>ç‰¹ç‚¹ï¼šè®­ç»ƒæ—¶å·²çŸ¥éƒ¨åˆ†å¼‚å¸¸ç±»å‹ï¼Œä½†æµ‹è¯•æ—¶å¯èƒ½å‡ºç°ä»æœªè§è¿‡çš„å¼‚å¸¸ã€‚</p>
<p>ä¼˜ç‚¹ï¼šæ›´è´´è¿‘çœŸå®å¼€æ”¾ç¯å¢ƒã€‚</p>
<p>ç¼ºç‚¹ï¼šéœ€è¦è®¾è®¡ä¸“é—¨æœºåˆ¶æ¥è¯†åˆ«æœªçŸ¥å¼‚å¸¸ã€‚</p>
<p>å›¾3ç›´è§‚å¯¹æ¯”äº†è¿™äº”ç§ä»»åŠ¡çš„åŒºåˆ«ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca8cf3f061e544f3abc7090ad718b0eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767235887&amp;x-signature=tI%2BtW6Jk8iekwVVf%2BFqrdq0nobQ%3D" alt="screenshot_2025-12-24_16-24-26.png" loading="lazy"/></p>
<h2 data-id="heading-2"><strong>æ–¹æ³•ä½“ç³»ï¼šAI æ˜¯å¦‚ä½•â€œçœ‹â€è§†é¢‘çš„ï¼Ÿ</strong></h2>
<ul>
<li><strong>åŠç›‘ç£ VADï¼šå­¦ä¹ â€œæ­£å¸¸â€çš„æ ·å­</strong></li>
</ul>
<p>ç”±äºåªæœ‰æ­£å¸¸æ ·æœ¬ï¼Œæ¨¡å‹é€šå¸¸é€šè¿‡è‡ªç›‘ç£å­¦ä¹ æ¥æ„å»ºâ€œæ­£å¸¸æ¨¡å¼â€ã€‚å¸¸è§æ–¹æ³•åŒ…æ‹¬ï¼š</p>
<p>é‡å»ºï¼šè®­ç»ƒä¸€ä¸ªè‡ªç¼–ç å™¨ï¼Œè®©å…¶å­¦ä¼šé‡æ„æ­£å¸¸è§†é¢‘ã€‚å¼‚å¸¸è§†é¢‘é€šå¸¸éš¾ä»¥è¢«è‰¯å¥½é‡æ„ã€‚</p>
<p>é¢„æµ‹ï¼šè®©æ¨¡å‹é¢„æµ‹æœªæ¥å¸§ï¼Œæ­£å¸¸äº‹ä»¶é€šå¸¸å¯é¢„æµ‹ï¼Œå¼‚å¸¸äº‹ä»¶åˆ™éš¾ä»¥é¢„æµ‹ã€‚</p>
<p>è§†è§‰å®Œå½¢å¡«ç©ºï¼šéšæœºé®æŒ¡éƒ¨åˆ†å¸§ï¼Œè®©æ¨¡å‹è¡¥å…¨ï¼Œä»¥æ­¤å­¦ä¹ æ—¶ç©ºä¸Šä¸‹æ–‡ã€‚</p>
<p>å›¾4å±•ç¤ºäº†åŠç›‘ç£ VAD çš„ç³»ç»ŸåŒ–åˆ†ç±»ä½“ç³»ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b1c977e58b54e39935e5bf46eb142c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767235887&amp;x-signature=juWIGRj6deU747tsaqEvCU1xQ5M%3D" alt="screenshot_2025-12-24_16-24-50.png" loading="lazy"/></p>
<ul>
<li><strong>å¼±ç›‘ç£ VADï¼šä»â€œè§†é¢‘çº§æ ‡ç­¾â€ä¸­å®šä½å¼‚å¸¸</strong></li>
</ul>
<p>å¼±ç›‘ç£æ–¹æ³•é€šå¸¸å€ŸåŠ©å¤šç¤ºä¾‹å­¦ä¹ ï¼ˆMILï¼‰ æœºåˆ¶ï¼Œä»é•¿è§†é¢‘ä¸­æŒ–æ˜å‡ºæœ€å¯èƒ½æ˜¯å¼‚å¸¸çš„ç‰‡æ®µã€‚è¿‘å¹´æ¥ï¼Œä¸€äº›æ–¹æ³•è¿˜å¼•å…¥ä¸¤é˜¶æ®µè‡ªè®­ç»ƒã€æ—¶åºå»ºæ¨¡ã€æ—¶ç©ºå»ºæ¨¡ç­‰ç­–ç•¥æå‡æ€§èƒ½ã€‚</p>
<ul>
<li><strong>æ— ç›‘ç£ VADï¼šå®Œå…¨â€œè‡ªåŠ›æ›´ç”Ÿâ€</strong></li>
</ul>
<p>æ— ç›‘ç£æ–¹æ³•ä¸ä¾èµ–ä»»ä½•æ ‡æ³¨ï¼Œå¸¸è§æ€è·¯åŒ…æ‹¬ï¼š</p>
<p>ä¼ªæ ‡ç­¾æ³•ï¼šå…ˆé€šè¿‡æŸç§æ–¹å¼ç”Ÿæˆä¼ªæ ‡ç­¾ï¼Œå†è¿­ä»£ä¼˜åŒ–ã€‚</p>
<p>å˜åŒ–æ£€æµ‹ï¼šæ£€æµ‹è§†é¢‘ä¸­æ˜¯å¦å‡ºç°åˆ†å¸ƒå˜åŒ–ã€‚</p>
<p>å› æœæ¨æ–­ï¼šä»å› æœè§’åº¦å»ºæ¨¡æ­£å¸¸ä¸å¼‚å¸¸çš„å…³ç³»ã€‚</p>
<ul>
<li><strong>å¼€æ”¾é›†ä¸å°‘æ ·æœ¬ VADï¼šåº”å¯¹æœªçŸ¥å¼‚å¸¸</strong></li>
</ul>
<p>è¿™ç±»æ–¹æ³•æ—¨åœ¨è¯†åˆ«è®­ç»ƒä¸­æœªå‡ºç°çš„å¼‚å¸¸ã€‚å¸¸è§æŠ€æœ¯åŒ…æ‹¬ï¼š</p>
<p>è¾¹é™…å­¦ä¹ ï¼šåœ¨ç‰¹å¾ç©ºé—´ä¸­æ‹‰å¼€æ­£å¸¸ä¸å¼‚å¸¸çš„è·ç¦»ã€‚</p>
<p>åŸºäºå¤§æ¨¡å‹çš„æ–¹æ³•ï¼šåˆ©ç”¨è§†è§‰-è¯­è¨€æ¨¡å‹ï¼ˆå¦‚ CLIPï¼‰è¿›è¡Œé›¶æ ·æœ¬æˆ–å¼€æ”¾è¯æ±‡æ£€æµ‹ã€‚</p>
<p>å°‘æ ·æœ¬é€‚åº”ï¼šä»…ç”¨å°‘é‡æ ·æœ¬å¿«é€Ÿé€‚åº”æ–°åœºæ™¯ã€‚</p>
<p>å›¾10å±•ç¤ºäº†å…­ç§å…¸å‹çš„å¼€æ”¾é›†ç›‘ç£ VAD æ–¹æ³•æµç¨‹ã€‚</p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6043b8a1ca6408ba0d2019a900d5507~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767235887&amp;x-signature=vK%2FeuWta76JW8pjWfc%2B%2ByPy8VZg%3D" alt="screenshot_2025-12-24_16-25-23.png" loading="lazy"/></p>
<h2 data-id="heading-3"><strong>æœªæ¥æ–¹å‘ï¼šVAD å°†èµ°å‘ä½•æ–¹ï¼Ÿ</strong></h2>
<ul>
<li><strong>æ„å»ºæ›´å…¨é¢çš„åŸºå‡†æ•°æ®é›†</strong></li>
</ul>
<p>å½“å‰æ•°æ®é›†è§„æ¨¡å°ã€æ¨¡æ€å•ä¸€ã€‚æœªæ¥éœ€è¦ï¼š</p>
<ul>
<li><strong>å¤§è§„æ¨¡æ•°æ®ï¼š</strong> æ›´é•¿ã€æ›´ä¸°å¯Œçš„è§†é¢‘å†…å®¹ã€‚</li>
<li><strong>å¤šæ¨¡æ€èåˆï¼š</strong> ç»“åˆè§†è§‰ã€éŸ³é¢‘ã€çº¢å¤–ç­‰å¤šæ¨¡æ€ä¿¡æ¯ã€‚</li>
<li><strong>å¤šè§†è§’ä¸ç¬¬ä¸€è§†è§’ï¼š</strong> æ”¯æŒå¤šæ‘„åƒå¤´ã€ç¬¬ä¸€äººç§°è§†è§’ç­‰æ›´çœŸå®åœºæ™¯ã€‚</li>
</ul>

<ul>
<li><strong>è¿ˆå‘å¼€æ”¾ä¸–ç•Œ</strong></li>
</ul>
<p>ç°å®ä¸–ç•Œå¼‚å¸¸å±‚å‡ºä¸ç©·ï¼Œæ¨¡å‹éœ€å…·å¤‡ï¼š</p>
<ul>
<li><strong>å¼€æ”¾è¯æ±‡æ£€æµ‹ï¼š</strong> èƒ½ç†è§£å¹¶æ£€æµ‹æœªçŸ¥ç±»åˆ«çš„å¼‚å¸¸ã€‚</li>
<li><strong>å¢é‡å­¦ä¹ ï¼š</strong> æŒç»­å­¦ä¹ æ–°å¼‚å¸¸è€Œä¸é—å¿˜æ—§çŸ¥è¯†ã€‚</li>
</ul>

<ul>
<li><strong>æ‹¥æŠ±å¤§æ¨¡å‹</strong></li>
</ul>
<p>é¢„è®­ç»ƒå¤§æ¨¡å‹ï¼ˆå¦‚ CLIPã€LLMï¼‰ä¸º VAD å¸¦æ¥æ–°æœºé‡ï¼š</p>
<ul>
<li><strong>è¯­ä¹‰ç†è§£ï¼š</strong> ç»“åˆæ–‡æœ¬æè¿°æå‡å¼‚å¸¸è§£é‡Šèƒ½åŠ›ã€‚</li>
<li><strong>é›¶æ ·æœ¬æ£€æµ‹ï¼š</strong> æ— éœ€è®­ç»ƒå³å¯æ£€æµ‹æ–°å¼‚å¸¸ã€‚</li>
</ul>

<ul>
<li><strong>å¯è§£é‡Šæ€§ VAD</strong></li>
</ul>
<p>è®© AI ä¸ä»…æ£€æµ‹å¼‚å¸¸ï¼Œè¿˜èƒ½â€œè¯´â€å‡ºä¸ºä»€ä¹ˆï¼š</p>
<ul>
<li><strong>è§„åˆ™æ¨ç†ï¼š</strong> ç»“åˆçŸ¥è¯†å›¾è°±ã€å¤§è¯­è¨€æ¨¡å‹è¿›è¡Œé€»è¾‘æ¨ç†ã€‚</li>
<li><strong>å¯è§†åŒ–å®šä½ï¼š</strong> åœ¨åƒç´ çº§æ ‡æ³¨å¼‚å¸¸åŒºåŸŸï¼Œæå‡å¯è§£é‡Šæ€§ã€‚</li>
</ul>
<h2 data-id="heading-4"><strong>ç»“è¯­</strong></h2>
<p>è§†é¢‘å¼‚å¸¸æ£€æµ‹æ­£æœç€æ›´æ™ºèƒ½ã€æ›´å¼€æ”¾ã€æ›´å¯è§£é‡Šçš„æ–¹å‘å‘å±•ã€‚ä»ä»…ä½¿ç”¨æ­£å¸¸æ ·æœ¬çš„åŠç›‘ç£å­¦ä¹ ï¼Œåˆ°åº”å¯¹æœªçŸ¥å¼‚å¸¸çš„å¼€æ”¾é›†æ£€æµ‹ï¼Œå†åˆ°ç»“åˆå¤§æ¨¡å‹çš„å¤šæ¨¡æ€ç†è§£ï¼ŒVAD çš„æŠ€æœ¯æ¼”è¿›ä¸æ–­æ‹“å±•å…¶åº”ç”¨è¾¹ç•Œã€‚</p>
<p>æœªæ¥ï¼Œéšç€æ•°æ®è§„æ¨¡çš„æ‰©å¤§ã€ç®—æ³•èƒ½åŠ›çš„æå‡ä»¥åŠå¤šæ¨¡æ€èåˆçš„æ·±å…¥ï¼ŒVAD å°†åœ¨å®‰é˜²ã€äº¤é€šã€åŒ»ç–—ç­‰é¢†åŸŸå‘æŒ¥æ›´åŠ å…³é”®çš„ä½œç”¨ï¼ŒçœŸæ­£å®ç°â€œè®©ç›‘æ§æ›´æ™ºèƒ½â€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[vue3è¿™äº›å¸¸è§æŒ‡ä»¤ä½ å°è£…äº†å—]]></title>    <link>https://juejin.cn/post/7587349016222122025</link>    <guid>https://juejin.cn/post/7587349016222122025</guid>    <pubDate>2025-12-25T02:53:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587349016222122025" data-draft-id="7587329107303907391" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="vue3è¿™äº›å¸¸è§æŒ‡ä»¤ä½ å°è£…äº†å—"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-25T02:53:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ—å¤ªç™½"/> <meta itemprop="url" content="https://juejin.cn/user/1874034273300919"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            vue3è¿™äº›å¸¸è§æŒ‡ä»¤ä½ å°è£…äº†å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1874034273300919/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ—å¤ªç™½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T02:53:33.000Z" title="Thu Dec 25 2025 02:53:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">vue3è¿™äº›å¸¸è§æŒ‡ä»¤ä½ å°è£…äº†å—</h2>
<h3 data-id="heading-1">ğŸ‘‰æŒ‡ä»¤æ­å»º</h3>
<p>vue3ä¹‹ä¸­ä¼šæœ‰ä¸€äº›å¸¸è§çš„æŒ‡ä»¤æ“ä½œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å†™ä¸€ä¸‹,ä¹‹å‰æˆ‘ä»¬å†™äº†æƒé™æŒ‰é’®ï¼Œå…¶å®æ˜¯ç±»ä¼¼çš„</p>
<p>æŒ‡ä»¤çš„æœ€ä¸»è¦æ–‡ä»¶å¦‚ä¸‹ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯ä¸»æ¨¡å—ä¹‹ä¸­ä½¿ç”¨ï¼Œå…¶ä»–çš„æ¨¡å—ä¹‹ä¸­åˆ†å‰²å†™å¥½æ–¹æ³•å³å¯</p>
<h4 data-id="heading-2">æŒ‡ä»¤ä¸»è¦æ–‡ä»¶</h4>
<pre><code class="hljs language-javascript" lang="javascript">src\utils\directive\index.<span class="hljs-property">ts</span>

<span class="hljs-keyword">import</span> type { <span class="hljs-title class_">App</span>, <span class="hljs-title class_">Directive</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> directives={};
<span class="hljs-comment">// å¯¼å‡ºæ’ä»¶å¯¹è±¡</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> registerDirectives = {
  <span class="hljs-title function_">install</span>(<span class="hljs-params">app: App</span>) {
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(directives).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
      app.<span class="hljs-title function_">directive</span>(key, directives[key])
    })
  }
}
</code></pre>
<h4 data-id="heading-3">æŒ‡ä»¤ä½¿ç”¨</h4>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">// æŒ‡ä»¤ä½¿ç”¨</span>
<span class="hljs-keyword">import</span> {registerDirectives} <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/directive'</span><span class="hljs-comment">// å¯¼å…¥å…¨å±€æŒ‡ä»¤</span>
app.<span class="hljs-title function_">use</span>(registerDirectives);<span class="hljs-comment">//å…¨å±€æŒ‡ä»¤æ³¨å†Œ</span>
</code></pre>
<h3 data-id="heading-4">ğŸ‘‰æŒ‡ä»¤ç¼–å†™</h3>
<h4 data-id="heading-5">å¤åˆ¶æŒ‡ä»¤</h4>
<h5 data-id="heading-6">æŒ‡ä»¤ç¼–å†™</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> type { <span class="hljs-title class_">Directive</span>, <span class="hljs-title class_">App</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// æ‰©å±• HTMLElement æ¥å£</span>
declare <span class="hljs-variable language_">global</span> {
  interface <span class="hljs-title class_">HTMLElement</span> {
    copyData?: string
  }
}

<span class="hljs-comment">// å®šä¹‰æŒ‡ä»¤å€¼çš„ç±»å‹</span>
interface <span class="hljs-title class_">CopyBinding</span> {
  <span class="hljs-attr">value</span>: string
}

<span class="hljs-comment">// å¤åˆ¶æŒ‡ä»¤é…ç½®</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">copy</span>: <span class="hljs-title class_">Directive</span>&lt;<span class="hljs-title class_">HTMLElement</span>, string&gt; = {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el: HTMLElement, binding: CopyBinding</span>) {
    <span class="hljs-comment">// ä¿å­˜è¦å¤åˆ¶çš„å€¼</span>
    el.<span class="hljs-property">copyData</span> = binding.<span class="hljs-property">value</span>
    <span class="hljs-comment">// æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬</span>
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, handleClick)
  },
  <span class="hljs-title function_">updated</span>(<span class="hljs-params">el: HTMLElement, binding: CopyBinding</span>) {
    <span class="hljs-comment">// æ›´æ–°è¦å¤åˆ¶çš„å€¼</span>
    el.<span class="hljs-property">copyData</span> = binding.<span class="hljs-property">value</span>
  },
  <span class="hljs-title function_">beforeUnmount</span>(<span class="hljs-params">el: HTMLElement</span>) {
    <span class="hljs-comment">// ç§»é™¤äº‹ä»¶ç›‘å¬</span>
    el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, handleClick)
  }
}

<span class="hljs-comment">// å¤„ç†å¤åˆ¶åŠŸèƒ½</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">event: Event</span>) =&gt; {
  <span class="hljs-keyword">const</span> el = event.<span class="hljs-property">currentTarget</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span>
  <span class="hljs-keyword">if</span> (!el.<span class="hljs-property">copyData</span>) <span class="hljs-keyword">return</span>

  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// ä½¿ç”¨ç°ä»£çš„ Clipboard API</span>
    <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">clipboard</span>.<span class="hljs-title function_">writeText</span>(el.<span class="hljs-property">copyData</span>)
    <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æˆåŠŸæç¤º</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤åˆ¶æˆåŠŸ'</span>)
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-comment">// é™çº§æ–¹æ¡ˆï¼šä½¿ç”¨ä¼ ç»Ÿæ–¹æ³•</span>
    <span class="hljs-keyword">const</span> input = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'input'</span>)
    input.<span class="hljs-property">value</span> = el.<span class="hljs-property">copyData</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(input)
    input.<span class="hljs-title function_">select</span>()
    <span class="hljs-keyword">try</span> {
      <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">execCommand</span>(<span class="hljs-string">'Copy'</span>)
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤åˆ¶æˆåŠŸ'</span>)
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å¤åˆ¶å¤±è´¥:'</span>, err)
    }
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">removeChild</span>(input)
  }
}
<span class="hljs-comment">// å¯¼å‡ºæŒ‡ä»¤å¯¹è±¡</span>
<span class="hljs-keyword">export</span> { copy }

</code></pre>
<h5 data-id="heading-7">å¼•å…¥æŒ‡ä»¤</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¤åˆ¶æŒ‡ä»¤</span>
<span class="hljs-keyword">import</span> {copy} <span class="hljs-keyword">from</span> <span class="hljs-string">'./modules/copy'</span>

<span class="hljs-comment">// å®šä¹‰æ‰€æœ‰æŒ‡ä»¤</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">directives</span>: <span class="hljs-title class_">Record</span>&lt;string, <span class="hljs-title class_">Directive</span>&gt; = {

  <span class="hljs-comment">// å¤åˆ¶æŒ‡ä»¤</span>
  copy,
}
</code></pre>
<h5 data-id="heading-8">ä½¿ç”¨æŒ‡ä»¤</h5>
<p>æ¥ä¸‹æ¥æ¼”ç¤ºä¸€ä¸‹åœ¨é¡¹ç›®ä¹‹ä¸­è¿›è¡Œä½¿ç”¨æŒ‡ä»¤</p>
<pre><code class="hljs language-javascript" lang="javascript">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex gap-3"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
      <span class="hljs-attr">class</span>=<span class="hljs-string">"flex-1 px-4 py-2 bg-gray-50 border-0 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200"</span> 
      <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥è¦å¤åˆ¶çš„å†…å®¹"</span> 
      <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> 
      <span class="hljs-attr">v-model</span>=<span class="hljs-string">"data"</span>
    &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> 
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200"</span>
      <span class="hljs-attr">v-copy</span>=<span class="hljs-string">"data"</span>
    &gt;</span>
      å¤åˆ¶
    <span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> data = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'æˆ‘æ˜¯è¢«å¤åˆ¶çš„å†…å®¹ ğŸ’ ğŸ‰ ğŸŠ'</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

</code></pre>
<h4 data-id="heading-9">æ°´å°æŒ‡ä»¤</h4>
<p>æ¥ä¸‹æ¥å†™ä¸€ä¸ªæ°´å°æŒ‡ä»¤ï¼Œæˆ‘ä»¬è®¾ç½®çš„æ˜¯é‡‡å–canvaså®ç°çš„æ°´å°æ•ˆæœï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±ç¼–å†™ä¸€ä¸‹</p>
<h5 data-id="heading-10">å¼•å…¥æŒ‡ä»¤</h5>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±åœ¨è¿™é‡Œç¼–å†™æ°´å°</p>
<pre><code class="hljs language-javascript" lang="javascript">src\utils\directive\modules\watermark .<span class="hljs-property">ts</span>
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ°´å°æŒ‡ä»¤</span>
<span class="hljs-keyword">import</span> {watermark} <span class="hljs-keyword">from</span> <span class="hljs-string">'./modules/watermark'</span>

<span class="hljs-comment">// å®šä¹‰æ‰€æœ‰æŒ‡ä»¤</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">directives</span>: <span class="hljs-title class_">Record</span>&lt;string, <span class="hljs-title class_">Directive</span>&gt; = {
  <span class="hljs-comment">// æ°´å°æŒ‡ä»¤</span>
  watermark,
}
</code></pre>
<h5 data-id="heading-11">æŒ‡ä»¤ç¼–å†™</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// modules/watermark.ts</span>

<span class="hljs-keyword">export</span> interface <span class="hljs-title class_">WatermarkConfig</span> {
  text?: string
  color?: string
  fontSize?: number
  fontFamily?: string
  width?: number
  height?: number
  rotate?: number
  zIndex?: number
}

interface <span class="hljs-title class_">HTMLElementWithWatermark</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HTMLElement</span> {
  _watermarkElement?: <span class="hljs-title class_">HTMLDivElement</span>
}

<span class="hljs-keyword">const</span> <span class="hljs-attr">defaultConfig</span>: <span class="hljs-title class_">Required</span>&lt;<span class="hljs-title class_">WatermarkConfig</span>&gt; = {
  <span class="hljs-attr">text</span>: <span class="hljs-string">'Watermark'</span>,
  <span class="hljs-attr">color</span>: <span class="hljs-string">'rgba(0, 0, 0, 0.15)'</span>,
  <span class="hljs-attr">fontSize</span>: <span class="hljs-number">16</span>,
  <span class="hljs-attr">fontFamily</span>: <span class="hljs-string">'Arial'</span>,
  <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>,
  <span class="hljs-attr">height</span>: <span class="hljs-number">200</span>,
  <span class="hljs-attr">rotate</span>: -<span class="hljs-number">20</span>,
  <span class="hljs-attr">zIndex</span>: <span class="hljs-number">9999</span>
}

<span class="hljs-keyword">const</span> createWatermark = (<span class="hljs-attr">config</span>: <span class="hljs-title class_">WatermarkConfig</span>): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> finalConfig = { ...defaultConfig, ...config }
  
  <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'canvas'</span>)
  canvas.<span class="hljs-property">width</span> = finalConfig.<span class="hljs-property">width</span>
  canvas.<span class="hljs-property">height</span> = finalConfig.<span class="hljs-property">height</span>
  <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>)!

  <span class="hljs-comment">// è®¾ç½®ç”»å¸ƒæ ·å¼</span>
  ctx.<span class="hljs-title function_">rotate</span>((finalConfig.<span class="hljs-property">rotate</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>) / <span class="hljs-number">180</span>)
  ctx.<span class="hljs-property">font</span> = <span class="hljs-string">`<span class="hljs-subst">${finalConfig.fontSize}</span>px <span class="hljs-subst">${finalConfig.fontFamily}</span>`</span>
  ctx.<span class="hljs-property">fillStyle</span> = finalConfig.<span class="hljs-property">color</span>
  ctx.<span class="hljs-property">textAlign</span> = <span class="hljs-string">'center'</span>
  ctx.<span class="hljs-property">textBaseline</span> = <span class="hljs-string">'middle'</span>
  
  <span class="hljs-comment">// ç»˜åˆ¶æ°´å°æ–‡æœ¬</span>
  ctx.<span class="hljs-title function_">fillText</span>(finalConfig.<span class="hljs-property">text</span>, finalConfig.<span class="hljs-property">width</span> / <span class="hljs-number">2</span>, finalConfig.<span class="hljs-property">height</span> / <span class="hljs-number">2</span>)

  <span class="hljs-keyword">return</span> canvas.<span class="hljs-title function_">toDataURL</span>()
}

<span class="hljs-keyword">const</span> watermark = {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el: HTMLElementWithWatermark, binding: { value: WatermarkConfig }</span>) {
    <span class="hljs-keyword">const</span> config = binding.<span class="hljs-property">value</span> || {}
    <span class="hljs-keyword">const</span> dataURL = <span class="hljs-title function_">createWatermark</span>(config)

    <span class="hljs-comment">// åˆ›å»ºæ°´å°å±‚</span>
    <span class="hljs-keyword">const</span> watermarkDiv = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>)
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">'absolute'</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">'0'</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">'0'</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">'100%'</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">'100%'</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">pointerEvents</span> = <span class="hljs-string">'none'</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundImage</span> = <span class="hljs-string">`url(<span class="hljs-subst">${dataURL}</span>)`</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundRepeat</span> = <span class="hljs-string">'repeat'</span>
    watermarkDiv.<span class="hljs-property">style</span>.<span class="hljs-property">zIndex</span> = <span class="hljs-title class_">String</span>(config.<span class="hljs-property">zIndex</span> || defaultConfig.<span class="hljs-property">zIndex</span>)

    <span class="hljs-comment">// è®¾ç½®çˆ¶å…ƒç´ ä¸ºç›¸å¯¹å®šä½</span>
    el.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">'relative'</span>
    <span class="hljs-comment">// æ·»åŠ æ°´å°å±‚</span>
    el.<span class="hljs-title function_">appendChild</span>(watermarkDiv)

    <span class="hljs-comment">// ä¿å­˜æ°´å°å…ƒç´ å¼•ç”¨</span>
    el.<span class="hljs-property">_watermarkElement</span> = watermarkDiv
  },

  <span class="hljs-title function_">updated</span>(<span class="hljs-params">el: HTMLElementWithWatermark, binding: { value: WatermarkConfig; oldValue: WatermarkConfig }</span>) {
    <span class="hljs-comment">// å¦‚æœé…ç½®å‘ç”Ÿå˜åŒ–ï¼Œé‡æ–°æ¸²æŸ“æ°´å°</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(binding.<span class="hljs-property">value</span>) !== <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(binding.<span class="hljs-property">oldValue</span>)) {
      <span class="hljs-comment">// ç§»é™¤æ—§æ°´å°</span>
      <span class="hljs-keyword">if</span> (el.<span class="hljs-property">_watermarkElement</span>) {
        el.<span class="hljs-title function_">removeChild</span>(el.<span class="hljs-property">_watermarkElement</span>)
      }
      <span class="hljs-comment">// åˆ›å»ºæ–°æ°´å°</span>
      watermark.<span class="hljs-title function_">mounted</span>(el, binding)
    }
  },

  <span class="hljs-title function_">unmounted</span>(<span class="hljs-params">el: HTMLElementWithWatermark</span>) {
    <span class="hljs-comment">// ç»„ä»¶å¸è½½æ—¶ç§»é™¤æ°´å°</span>
    <span class="hljs-keyword">if</span> (el.<span class="hljs-property">_watermarkElement</span>) {
      el.<span class="hljs-title function_">removeChild</span>(el.<span class="hljs-property">_watermarkElement</span>)
      <span class="hljs-keyword">delete</span> el.<span class="hljs-property">_watermarkElement</span>
    }
  }
}
<span class="hljs-keyword">export</span> { watermark }
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> watermark;

</code></pre>
<h5 data-id="heading-12">æŒ‡ä»¤ä½¿ç”¨</h5>
<p>è¿™ä¸ªæ—¶å€™ä½¿ç”¨æˆ‘ä»¬çš„æŒ‡ä»¤ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ•ˆæœ</p>
<pre><code class="hljs language-javascript" lang="javascript">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex gap-3 content"</span> <span class="hljs-attr">v-watermark</span>=<span class="hljs-string">"watermarkConfig"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-lg font-semibold mb-4 text-gray-800"</span>&gt;</span>æ°´å°æŒ‡ä»¤<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
      <span class="hljs-attr">class</span>=<span class="hljs-string">"flex-1 px-4 py-2  border-0 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200"</span> 
      <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥è¦å¤åˆ¶çš„å†…å®¹"</span> 
      <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> 
      <span class="hljs-attr">v-model</span>=<span class="hljs-string">"data"</span>
    &gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref,computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-comment">// å°†åŸæ¥çš„ compute æ–¹æ³•æ”¹ä¸ºè®¡ç®—å±æ€§</span>
<span class="hljs-keyword">const</span> watermarkText = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> data.<span class="hljs-property">value</span>)

<span class="hljs-keyword">const</span> data = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'æ°´å°å†…å®¹ğŸ’ ğŸ‰ ğŸŠ'</span>)

<span class="hljs-comment">// ç„¶ååœ¨ watermarkConfig ä¸­ä½¿ç”¨è¿™ä¸ªè®¡ç®—å±æ€§</span>
<span class="hljs-keyword">const</span> watermarkConfig = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> ({
  <span class="hljs-attr">text</span>: watermarkText.<span class="hljs-property">value</span>,
  <span class="hljs-attr">color</span>: <span class="hljs-string">'rgba(0, 0, 0, 0.15)'</span>,
  <span class="hljs-attr">fontSize</span>: <span class="hljs-number">16</span>,
  <span class="hljs-attr">fontFamily</span>: <span class="hljs-string">'Arial'</span>,
  <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>,
  <span class="hljs-attr">height</span>: <span class="hljs-number">200</span>,
  <span class="hljs-attr">rotate</span>: -<span class="hljs-number">20</span>,
  <span class="hljs-attr">zIndex</span>: <span class="hljs-number">9999</span>,
}))
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.content</span> {
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-13">æ‹–æ‹½æŒ‡ä»¤</h4>
<h5 data-id="heading-14">æŒ‡ä»¤ç¼–å†™</h5>
<pre><code class="hljs language-javascript" lang="javascript">src\utils\directive\modules\draggable.<span class="hljs-property">ts</span>
</code></pre>
<p>æŒ‡ä»¤å†…å®¹,è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸ªéƒ¨åˆ†ï¼ŒæŒ‡ä»¤çš„ä½ç½®æ˜¯ç›¸å¯¹äºæˆ‘ä»¬çˆ¶å…ƒç´ ä½ç½®ï¼Œè€Œä¸æ˜¯ç›¸å¯¹äºæˆ‘ä»¬è§†å£çš„ä½ç½®</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è®°å½•åˆå§‹ä½ç½®</span>
<span class="hljs-keyword">const</span> rect = el.<span class="hljs-title function_">getBoundingClientRect</span>()
dragData.<span class="hljs-property">initialLeft</span> = rect.<span class="hljs-property">left</span>
dragData.<span class="hljs-property">initialTop</span> = rect.<span class="hljs-property">top</span>

=&gt;æ›´æ”¹ä¸º

<span class="hljs-comment">// è·å–å½“å‰ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®åˆ™é»˜è®¤ä¸º0</span>
dragData.<span class="hljs-property">initialLeft</span> = <span class="hljs-built_in">parseInt</span>(el.<span class="hljs-property">style</span>.<span class="hljs-property">left</span>) || <span class="hljs-number">0</span>
dragData.<span class="hljs-property">initialTop</span> = <span class="hljs-built_in">parseInt</span>(el.<span class="hljs-property">style</span>.<span class="hljs-property">top</span>) || <span class="hljs-number">0</span>
</code></pre>
<p>å®Œæ•´ä¿®æ”¹ä»¥åæˆ‘ä»¬çš„ç‰ˆæœ¬å¦‚ä¸‹</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> type { <span class="hljs-title class_">Directive</span>, <span class="hljs-title class_">DirectiveBinding</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

interface <span class="hljs-title class_">DraggableElement</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HTMLElement</span> {
  _dragData?: {
    <span class="hljs-attr">isDragging</span>: boolean
    <span class="hljs-attr">startX</span>: number
    <span class="hljs-attr">startY</span>: number
    <span class="hljs-attr">initialLeft</span>: number
    <span class="hljs-attr">initialTop</span>: number
    <span class="hljs-attr">initialPosition</span>: string
    <span class="hljs-attr">zIndex</span>: string
  }
  _cleanup?: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">void</span>  <span class="hljs-comment">// æ·»åŠ è¿™ä¸€è¡Œ</span>
}


<span class="hljs-keyword">const</span> <span class="hljs-attr">draggable</span>: <span class="hljs-title class_">Directive</span>&lt;<span class="hljs-title class_">DraggableElement</span>, boolean&gt; = {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el: DraggableElement, binding: DirectiveBinding&lt;boolean&gt;</span>) {
    <span class="hljs-keyword">if</span> (binding.<span class="hljs-property">value</span> === <span class="hljs-literal">false</span>) <span class="hljs-keyword">return</span>

    <span class="hljs-keyword">const</span> dragData = {
      <span class="hljs-attr">isDragging</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">startX</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">startY</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">initialLeft</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">initialTop</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">initialPosition</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">zIndex</span>: <span class="hljs-string">''</span>
    }
    el.<span class="hljs-property">_dragData</span> = dragData

    <span class="hljs-comment">// è®¾ç½®åˆå§‹æ ·å¼</span>
    el.<span class="hljs-property">style</span>.<span class="hljs-property">cursor</span> = <span class="hljs-string">'move'</span>
    el.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = el.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> || <span class="hljs-string">'absolute'</span>

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleMouseDown</span> = (<span class="hljs-params">e: MouseEvent</span>) =&gt; {
      dragData.<span class="hljs-property">isDragging</span> = <span class="hljs-literal">true</span>
      dragData.<span class="hljs-property">startX</span> = e.<span class="hljs-property">clientX</span>
      dragData.<span class="hljs-property">startY</span> = e.<span class="hljs-property">clientY</span>
      dragData.<span class="hljs-property">initialPosition</span> = el.<span class="hljs-property">style</span>.<span class="hljs-property">position</span>
      dragData.<span class="hljs-property">zIndex</span> = el.<span class="hljs-property">style</span>.<span class="hljs-property">zIndex</span>
      
      <span class="hljs-comment">// è·å–å½“å‰ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®åˆ™é»˜è®¤ä¸º0</span>
      dragData.<span class="hljs-property">initialLeft</span> = <span class="hljs-built_in">parseInt</span>(el.<span class="hljs-property">style</span>.<span class="hljs-property">left</span>) || <span class="hljs-number">0</span>
      dragData.<span class="hljs-property">initialTop</span> = <span class="hljs-built_in">parseInt</span>(el.<span class="hljs-property">style</span>.<span class="hljs-property">top</span>) || <span class="hljs-number">0</span>

      <span class="hljs-comment">// æé«˜å±‚çº§</span>
      el.<span class="hljs-property">style</span>.<span class="hljs-property">zIndex</span> = <span class="hljs-string">'9999'</span>
      
      <span class="hljs-comment">// æ·»åŠ ç§»åŠ¨æ—¶çš„æ ·å¼</span>
      el.<span class="hljs-property">style</span>.<span class="hljs-property">transition</span> = <span class="hljs-string">'none'</span>
      el.<span class="hljs-property">style</span>.<span class="hljs-property">userSelect</span> = <span class="hljs-string">'none'</span>
    }

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleMouseMove</span> = (<span class="hljs-params">e: MouseEvent</span>) =&gt; {
      <span class="hljs-keyword">if</span> (!dragData.<span class="hljs-property">isDragging</span>) <span class="hljs-keyword">return</span>

      <span class="hljs-keyword">const</span> deltaX = e.<span class="hljs-property">clientX</span> - dragData.<span class="hljs-property">startX</span>
      <span class="hljs-keyword">const</span> deltaY = e.<span class="hljs-property">clientY</span> - dragData.<span class="hljs-property">startY</span>

      el.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`<span class="hljs-subst">${dragData.initialLeft + deltaX}</span>px`</span>
      el.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">`<span class="hljs-subst">${dragData.initialTop + deltaY}</span>px`</span>
    }

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleMouseUp</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">if</span> (!dragData.<span class="hljs-property">isDragging</span>) <span class="hljs-keyword">return</span>
      
      dragData.<span class="hljs-property">isDragging</span> = <span class="hljs-literal">false</span>
      
      <span class="hljs-comment">// æ¢å¤æ ·å¼</span>
      el.<span class="hljs-property">style</span>.<span class="hljs-property">zIndex</span> = dragData.<span class="hljs-property">zIndex</span>
      el.<span class="hljs-property">style</span>.<span class="hljs-property">userSelect</span> = <span class="hljs-string">''</span>
      el.<span class="hljs-property">style</span>.<span class="hljs-property">transition</span> = <span class="hljs-string">''</span>
    }

    <span class="hljs-comment">// æ·»åŠ äº‹ä»¶ç›‘å¬</span>
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousedown'</span>, handleMouseDown)
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousemove'</span>, handleMouseMove)
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mouseup'</span>, handleMouseUp)

    <span class="hljs-comment">// ä¿å­˜æ¸…ç†å‡½æ•°</span>
    el.<span class="hljs-property">_cleanup</span> = <span class="hljs-function">() =&gt;</span> {
      el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mousedown'</span>, handleMouseDown)
      <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mousemove'</span>, handleMouseMove)
      <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mouseup'</span>, handleMouseUp)
    }
  },

  <span class="hljs-title function_">unmounted</span>(<span class="hljs-params">el: DraggableElement</span>) {
    <span class="hljs-comment">// æ¸…ç†äº‹ä»¶ç›‘å¬</span>
    <span class="hljs-keyword">if</span> (el.<span class="hljs-property">_cleanup</span>) {
      el.<span class="hljs-title function_">_cleanup</span>()
    }
    <span class="hljs-keyword">delete</span> el.<span class="hljs-property">_dragData</span>
  },

  <span class="hljs-title function_">updated</span>(<span class="hljs-params">el: DraggableElement, binding: DirectiveBinding&lt;boolean&gt;</span>) {
    <span class="hljs-comment">// å¦‚æœæŒ‡ä»¤å€¼æ”¹å˜ï¼Œæ›´æ–°çŠ¶æ€</span>
    <span class="hljs-keyword">if</span> (binding.<span class="hljs-property">value</span> === <span class="hljs-literal">false</span> &amp;&amp; el.<span class="hljs-property">_dragData</span>) {
      el.<span class="hljs-property">style</span>.<span class="hljs-property">cursor</span> = <span class="hljs-string">''</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (binding.<span class="hljs-property">value</span> === <span class="hljs-literal">true</span>) {
      el.<span class="hljs-property">style</span>.<span class="hljs-property">cursor</span> = <span class="hljs-string">'move'</span>
    }
  }
}

<span class="hljs-keyword">export</span> {draggable}

</code></pre>
<h5 data-id="heading-15">æŒ‡ä»¤ä½¿ç”¨</h5>
<p>æˆ‘ä»¬åœ¨æŒ‡ä»¤ä¹‹ä¸­è¿›è¡Œä½¿ç”¨ï¼Œæ•ˆæœok</p>
<pre><code class="hljs language-javascript" lang="javascript">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"relative"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-draggable</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"draggable-box"</span>&gt;</span>
      å¯æ‹–æ‹½çš„å†…å®¹
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- ä¹Ÿå¯ä»¥åŠ¨æ€æ§åˆ¶æ˜¯å¦å¯æ‹–æ‹½ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-draggable</span>=<span class="hljs-string">"isDraggable"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"draggable-box"</span>&gt;</span>
      æ¡ä»¶æ‹–æ‹½çš„å†…å®¹
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> isDraggable = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">true</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.draggable-box</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#409EFF</span>;
  <span class="hljs-attribute">color</span>: white;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">justify-content</span>: center;
  <span class="hljs-attribute">position</span>: absolute;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-16">é˜²æŠ–æŒ‡ä»¤</h4>
<h5 data-id="heading-17">æŒ‡ä»¤ç¼–å†™</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// modules/debounce.ts</span>
<span class="hljs-comment">/**
 * é˜²æŠ–å‡½æ•°
 * <span class="hljs-doctag">@param</span> fn éœ€è¦é˜²æŠ–çš„å‡½æ•°
 * <span class="hljs-doctag">@param</span> delay å»¶è¿Ÿæ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤300ms
 * <span class="hljs-doctag">@param</span> immediate æ˜¯å¦ç«‹å³æ‰§è¡Œï¼Œé»˜è®¤false
 * <span class="hljs-doctag">@returns</span> è¿”å›é˜²æŠ–å¤„ç†åçš„å‡½æ•°
 */</span>
interface <span class="hljs-title class_">DebounceBinding</span> {
  <span class="hljs-attr">value</span>: <span class="hljs-title class_">Function</span>;
  arg?: string; <span class="hljs-comment">// å»¶è¿Ÿæ—¶é—´å‚æ•°</span>
}

<span class="hljs-comment">// é˜²æŠ–å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">debounceFn</span>(<span class="hljs-params">func: <span class="hljs-built_in">Function</span>, wait: number</span>) {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">timeout</span>: <span class="hljs-title class_">NodeJS</span>.<span class="hljs-property">Timeout</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable language_">this</span>: any, ...args: any[]</span>) {
    <span class="hljs-built_in">clearTimeout</span>(timeout);
    timeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
    }, wait);
  };
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> debounce = {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el: HTMLElement, binding: DebounceBinding</span>) {
    <span class="hljs-comment">// è·å–å»¶è¿Ÿæ—¶é—´ï¼Œé»˜è®¤ä¸º 500ms</span>
    <span class="hljs-keyword">const</span> delay = <span class="hljs-title class_">Number</span>(binding.<span class="hljs-property">arg</span>) || <span class="hljs-number">500</span>;
    
    <span class="hljs-comment">// åˆ›å»ºé˜²æŠ–å‡½æ•°</span>
    <span class="hljs-keyword">const</span> debouncedFn = <span class="hljs-title function_">debounceFn</span>(binding.<span class="hljs-property">value</span>, delay);
    
    <span class="hljs-comment">// ä¿å­˜åŸå§‹å‡½æ•°å’Œé˜²æŠ–å‡½æ•°åˆ°å…ƒç´ çš„ dataset ä¸­</span>
    el.<span class="hljs-property">dataset</span>.<span class="hljs-property">debounceFn</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">original</span>: binding.<span class="hljs-property">value</span>.<span class="hljs-title function_">toString</span>(),
      <span class="hljs-attr">debounced</span>: debouncedFn.<span class="hljs-title function_">toString</span>()
    });
    
    <span class="hljs-comment">// æ·»åŠ äº‹ä»¶ç›‘å¬å™¨</span>
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, debouncedFn);
  },
  
  <span class="hljs-title function_">updated</span>(<span class="hljs-params">el: HTMLElement, binding: DebounceBinding</span>) {
    <span class="hljs-comment">// å¦‚æœå€¼å‘ç”Ÿå˜åŒ–ï¼Œæ›´æ–°é˜²æŠ–å‡½æ•°</span>
    <span class="hljs-keyword">const</span> delay = <span class="hljs-title class_">Number</span>(binding.<span class="hljs-property">arg</span>) || <span class="hljs-number">500</span>;
    <span class="hljs-keyword">const</span> debouncedFn = <span class="hljs-title function_">debounceFn</span>(binding.<span class="hljs-property">value</span>, delay);
    
    <span class="hljs-comment">// ç§»é™¤æ—§çš„äº‹ä»¶ç›‘å¬å™¨</span>
    <span class="hljs-keyword">const</span> oldFn = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(<span class="hljs-string">'return '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(el.<span class="hljs-property">dataset</span>.<span class="hljs-property">debounceFn</span> || <span class="hljs-string">'{}'</span>).<span class="hljs-property">debounced</span>)();
    el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, oldFn);
    
    <span class="hljs-comment">// æ›´æ–° dataset</span>
    el.<span class="hljs-property">dataset</span>.<span class="hljs-property">debounceFn</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">original</span>: binding.<span class="hljs-property">value</span>.<span class="hljs-title function_">toString</span>(),
      <span class="hljs-attr">debounced</span>: debouncedFn.<span class="hljs-title function_">toString</span>()
    });
    
    <span class="hljs-comment">// æ·»åŠ æ–°çš„äº‹ä»¶ç›‘å¬å™¨</span>
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, debouncedFn);
  },
  
  <span class="hljs-title function_">unmounted</span>(<span class="hljs-params">el: HTMLElement</span>) {
    <span class="hljs-comment">// ç»„ä»¶å¸è½½æ—¶ç§»é™¤äº‹ä»¶ç›‘å¬å™¨</span>
    <span class="hljs-keyword">const</span> fn = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(<span class="hljs-string">'return '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(el.<span class="hljs-property">dataset</span>.<span class="hljs-property">debounceFn</span> || <span class="hljs-string">'{}'</span>).<span class="hljs-property">debounced</span>)();
    el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, fn);
    <span class="hljs-keyword">delete</span> el.<span class="hljs-property">dataset</span>.<span class="hljs-property">debounceFn</span>;
  }
};

<span class="hljs-comment">// å¯¼å‡ºé˜²æŠ–å‡½æ•°ä¾›å…¶ä»–åœ°æ–¹ä½¿ç”¨</span>
<span class="hljs-keyword">export</span> { debounceFn };

</code></pre>
<h5 data-id="heading-18">æŒ‡ä»¤ä½¿ç”¨</h5>
<pre><code class="hljs language-javascript" lang="javascript">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex flex-wrap gap-4 p-6"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- åŸºç¡€é˜²æŠ–æŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-debounce</span>=<span class="hljs-string">"handleClick"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-6 py-2.5 bg-blue-600 text-white font-medium text-sm leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out"</span>
    &gt;</span>
      é˜²æŠ–æŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 500msé˜²æŠ–æŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-debounce:500</span>=<span class="hljs-string">"handleClick"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-6 py-2.5 bg-green-600 text-white font-medium text-sm leading-tight uppercase rounded shadow-md hover:bg-green-700 hover:shadow-lg focus:bg-green-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-green-800 active:shadow-lg transition duration-150 ease-in-out"</span>
    &gt;</span>
      500msé˜²æŠ–æŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ç«‹å³æ‰§è¡Œé˜²æŠ–æŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-debounce.immediate</span>=<span class="hljs-string">"handleClick"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-6 py-2.5 bg-purple-600 text-white font-medium text-sm leading-tight uppercase rounded shadow-md hover:bg-purple-700 hover:shadow-lg focus:bg-purple-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-purple-800 active:shadow-lg transition duration-150 ease-in-out"</span>
    &gt;</span>
      ç«‹å³æ‰§è¡Œé˜²æŠ–æŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é˜²æŠ–æŒ‰é’®ç‚¹å‡»'</span>);
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

</code></pre>
<h4 data-id="heading-19">èŠ‚æµæŒ‡ä»¤</h4>
<h5 data-id="heading-20">æŒ‡ä»¤ç¼–å†™</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * v-throttle æŒ‡ä»¤
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} fn éœ€è¦èŠ‚æµçš„å‡½æ•°
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Number</span>} delay å»¶è¿Ÿæ—¶é—´
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Boolean</span>} immediate æ˜¯å¦ç«‹å³æ‰§è¡Œ
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Function</span>} è¿”å›ä¸€ä¸ªèŠ‚æµåçš„å‡½æ•°
 */</span>

<span class="hljs-comment">// modules/throttle.ts</span>

interface <span class="hljs-title class_">ThrottleBinding</span> {
  <span class="hljs-attr">value</span>: <span class="hljs-title class_">Function</span>;
  arg?: string | number; <span class="hljs-comment">// å»¶è¿Ÿæ—¶é—´å‚æ•°</span>
  modifiers?: {
    immediate?: boolean;
  };
}

<span class="hljs-comment">// èŠ‚æµå‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">throttleFn</span>(<span class="hljs-params">
  func: <span class="hljs-built_in">Function</span>,
  wait: number,
  immediate: boolean = <span class="hljs-literal">false</span>
</span>) {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">timeout</span>: <span class="hljs-title class_">NodeJS</span>.<span class="hljs-property">Timeout</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">let</span> previous = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable language_">this</span>: any, ...args: any[]</span>) {
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> remaining = wait - (now - previous);

    <span class="hljs-keyword">if</span> (remaining &lt;= <span class="hljs-number">0</span> || remaining &gt; wait) {
      <span class="hljs-keyword">if</span> (timeout) {
        <span class="hljs-built_in">clearTimeout</span>(timeout);
        timeout = <span class="hljs-literal">null</span>;
      }
      previous = now;
      func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!timeout &amp;&amp; !immediate) {
      timeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        previous = immediate ? <span class="hljs-number">0</span> : <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
        timeout = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (!immediate) {
          func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
        }
      }, remaining);
    }

    <span class="hljs-keyword">if</span> (immediate &amp;&amp; !timeout) {
      func.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
      previous = now;
    }
  };
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> throttle = {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el: HTMLElement, binding: ThrottleBinding</span>) {
    <span class="hljs-keyword">const</span> delay = <span class="hljs-title class_">Number</span>(binding.<span class="hljs-property">arg</span>) || <span class="hljs-number">500</span>;
    <span class="hljs-keyword">const</span> immediate = binding.<span class="hljs-property">modifiers</span>?.<span class="hljs-property">immediate</span> || <span class="hljs-literal">false</span>;
    
    <span class="hljs-keyword">const</span> throttledFn = <span class="hljs-title function_">throttleFn</span>(binding.<span class="hljs-property">value</span>, delay, immediate);
    
    el.<span class="hljs-property">dataset</span>.<span class="hljs-property">throttleFn</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">original</span>: binding.<span class="hljs-property">value</span>.<span class="hljs-title function_">toString</span>(),
      <span class="hljs-attr">throttled</span>: throttledFn.<span class="hljs-title function_">toString</span>()
    });
    
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, throttledFn);
  },
  
  <span class="hljs-title function_">updated</span>(<span class="hljs-params">el: HTMLElement, binding: ThrottleBinding</span>) {
    <span class="hljs-keyword">const</span> delay = <span class="hljs-title class_">Number</span>(binding.<span class="hljs-property">arg</span>) || <span class="hljs-number">500</span>;
    <span class="hljs-keyword">const</span> immediate = binding.<span class="hljs-property">modifiers</span>?.<span class="hljs-property">immediate</span> || <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">const</span> throttledFn = <span class="hljs-title function_">throttleFn</span>(binding.<span class="hljs-property">value</span>, delay, immediate);
    
    <span class="hljs-keyword">const</span> oldFn = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(<span class="hljs-string">'return '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(el.<span class="hljs-property">dataset</span>.<span class="hljs-property">throttleFn</span> || <span class="hljs-string">'{}'</span>).<span class="hljs-property">throttled</span>)();
    el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, oldFn);
    
    el.<span class="hljs-property">dataset</span>.<span class="hljs-property">throttleFn</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">original</span>: binding.<span class="hljs-property">value</span>.<span class="hljs-title function_">toString</span>(),
      <span class="hljs-attr">throttled</span>: throttledFn.<span class="hljs-title function_">toString</span>()
    });
    
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, throttledFn);
  },
  
  <span class="hljs-title function_">unmounted</span>(<span class="hljs-params">el: HTMLElement</span>) {
    <span class="hljs-keyword">const</span> fn = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(<span class="hljs-string">'return '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(el.<span class="hljs-property">dataset</span>.<span class="hljs-property">throttleFn</span> || <span class="hljs-string">'{}'</span>).<span class="hljs-property">throttled</span>)();
    el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'click'</span>, fn);
    <span class="hljs-keyword">delete</span> el.<span class="hljs-property">dataset</span>.<span class="hljs-property">throttleFn</span>;
  }
};

<span class="hljs-keyword">export</span> { throttleFn };

</code></pre>
<h5 data-id="heading-21">æŒ‡ä»¤ä½¿ç”¨</h5>
<pre><code class="hljs language-javascript" lang="javascript">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"flex flex-wrap gap-4 p-6"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- åŸºç¡€èŠ‚æµæŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-throttle</span>=<span class="hljs-string">"handleClick"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-6 py-2.5 bg-blue-600 text-white font-medium text-sm leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out"</span>
    &gt;</span>
      èŠ‚æµæŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 500msèŠ‚æµæŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-throttle:500</span>=<span class="hljs-string">"handleClick"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-6 py-2.5 bg-green-600 text-white font-medium text-sm leading-tight uppercase rounded shadow-md hover:bg-green-700 hover:shadow-lg focus:bg-green-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-green-800 active:shadow-lg transition duration-150 ease-in-out"</span>
    &gt;</span>
      500msèŠ‚æµæŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ç«‹å³æ‰§è¡ŒèŠ‚æµæŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-throttle.immediate</span>=<span class="hljs-string">"handleClick"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-6 py-2.5 bg-purple-600 text-white font-medium text-sm leading-tight uppercase rounded shadow-md hover:bg-purple-700 hover:shadow-lg focus:bg-purple-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-purple-800 active:shadow-lg transition duration-150 ease-in-out"</span>
    &gt;</span>
      ç«‹å³æ‰§è¡ŒèŠ‚æµæŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æŒ‰é’®è¢«ç‚¹å‡»'</span>);
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-22">é•¿æŒ‰æŒ‡ä»¤</h4>
<h5 data-id="heading-23">æŒ‡ä»¤ç¼–å†™</h5>
<pre><code class="hljs language-javascript" lang="javascript">src\utils\directive\modules\longPress.<span class="hljs-property">ts</span>
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// modules/longPress.ts</span>

interface <span class="hljs-title class_">LongPressBinding</span> {
  <span class="hljs-attr">value</span>: <span class="hljs-title class_">Function</span>;
  arg?: number; <span class="hljs-comment">// é•¿æŒ‰æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤500ms</span>
  modifiers?: {
    stop?: boolean; <span class="hljs-comment">// æ˜¯å¦é˜»æ­¢äº‹ä»¶å†’æ³¡</span>
    prevent?: boolean; <span class="hljs-comment">// æ˜¯å¦é˜»æ­¢é»˜è®¤äº‹ä»¶</span>
  };
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> longPress = {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el: HTMLElement, binding: LongPressBinding</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> binding.<span class="hljs-property">value</span> !== <span class="hljs-string">'function'</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'v-longPress æŒ‡ä»¤éœ€è¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºå€¼'</span>);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">let</span> <span class="hljs-attr">pressTimer</span>: <span class="hljs-title class_">NodeJS</span>.<span class="hljs-property">Timeout</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-attr">startTime</span>: number = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> duration = <span class="hljs-title class_">Number</span>(binding.<span class="hljs-property">arg</span>) || <span class="hljs-number">500</span>;
    <span class="hljs-keyword">const</span> isStop = binding.<span class="hljs-property">modifiers</span>?.<span class="hljs-property">stop</span> || <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">const</span> isPrevent = binding.<span class="hljs-property">modifiers</span>?.<span class="hljs-property">prevent</span> || <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">start</span> = (<span class="hljs-params">e: MouseEvent | TouchEvent</span>) =&gt; {
      <span class="hljs-keyword">if</span> (isPrevent) {
        e.<span class="hljs-title function_">preventDefault</span>();
      }
      <span class="hljs-keyword">if</span> (isStop) {
        e.<span class="hljs-title function_">stopPropagation</span>();
      }

      startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      
      pressTimer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        binding.<span class="hljs-title function_">value</span>(e);
      }, duration);
    };

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">cancel</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">if</span> (pressTimer) {
        <span class="hljs-built_in">clearTimeout</span>(pressTimer);
        pressTimer = <span class="hljs-literal">null</span>;
      }
    };

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">end</span> = (<span class="hljs-params">e: MouseEvent | TouchEvent</span>) =&gt; {
      <span class="hljs-keyword">const</span> endTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      <span class="hljs-keyword">const</span> timeDiff = endTime - startTime;
      
      <span class="hljs-comment">// å¦‚æœæŒ‰ä½æ—¶é—´å°äºè®¾å®šæ—¶é—´ï¼Œåˆ™è§†ä¸ºæ™®é€šç‚¹å‡»</span>
      <span class="hljs-keyword">if</span> (timeDiff &lt; duration &amp;&amp; pressTimer) {
        <span class="hljs-title function_">cancel</span>();
        <span class="hljs-keyword">return</span>;
      }
      
      <span class="hljs-title function_">cancel</span>();
    };

    <span class="hljs-comment">// æ·»åŠ äº‹ä»¶ç›‘å¬å™¨</span>
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousedown'</span>, start);
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'touchstart'</span>, start);
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mouseup'</span>, end);
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'touchend'</span>, end);
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mouseleave'</span>, cancel);
    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'touchcancel'</span>, cancel);

    <span class="hljs-comment">// ä¿å­˜æ¸…ç†å‡½æ•°åˆ°å…ƒç´ ä¸Š</span>
    (el <span class="hljs-keyword">as</span> any).<span class="hljs-property">_longPressCleanup</span> = <span class="hljs-function">() =&gt;</span> {
      el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mousedown'</span>, start);
      el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'touchstart'</span>, start);
      el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mouseup'</span>, end);
      el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'touchend'</span>, end);
      el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mouseleave'</span>, cancel);
      el.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'touchcancel'</span>, cancel);
      <span class="hljs-title function_">cancel</span>();
    };
  },

  <span class="hljs-title function_">unmounted</span>(<span class="hljs-params">el: HTMLElement</span>) {
    <span class="hljs-comment">// æ¸…ç†äº‹ä»¶ç›‘å¬å™¨</span>
    <span class="hljs-keyword">if</span> ((el <span class="hljs-keyword">as</span> any).<span class="hljs-property">_longPressCleanup</span>) {
      (el <span class="hljs-keyword">as</span> any).<span class="hljs-title function_">_longPressCleanup</span>();
    }
  }
};

</code></pre>
<h5 data-id="heading-24">æŒ‡ä»¤ä½¿ç”¨</h5>
<p>æµ‹è¯•ä¸€ä¸‹æˆ‘ä»¬çš„æŒ‰é’®æŒ‡ä»¤ï¼Œæ•ˆæœok</p>
<pre><code class="hljs language-javascript" lang="javascript">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"p-6 space-y-4"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- åŸºç¡€ç”¨æ³•ï¼Œé»˜è®¤500ms --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-longPress</span>=<span class="hljs-string">"handleLongPress"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"</span>
    &gt;</span>
      é•¿æŒ‰æŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- è‡ªå®šä¹‰é•¿æŒ‰æ—¶é—´ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-longPress:1000</span>=<span class="hljs-string">"handleLongPress"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600"</span>
    &gt;</span>
      1ç§’é•¿æŒ‰æŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- é˜»æ­¢äº‹ä»¶å†’æ³¡ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-longPress.stop</span>=<span class="hljs-string">"handleLongPress"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600"</span>
    &gt;</span>
      é˜»æ­¢å†’æ³¡é•¿æŒ‰æŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- é˜»æ­¢é»˜è®¤äº‹ä»¶ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
      <span class="hljs-attr">v-longPress.prevent</span>=<span class="hljs-string">"handleLongPress"</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600"</span>
    &gt;</span>
      é˜»æ­¢é»˜è®¤äº‹ä»¶é•¿æŒ‰æŒ‰é’®
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleLongPress</span> = (<span class="hljs-params">event: MouseEvent | TouchEvent</span>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é•¿æŒ‰è§¦å‘'</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>());
  <span class="hljs-comment">// è¿™é‡Œå¯ä»¥æ·»åŠ ä½ çš„é•¿æŒ‰å¤„ç†é€»è¾‘</span>
  <span class="hljs-keyword">if</span> (event <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">MouseEvent</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é¼ æ ‡äº‹ä»¶'</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è§¦æ‘¸äº‹ä»¶'</span>);
  }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»äººåŠ›æ¨è½¦åˆ°æ™ºèƒ½å¼•æ“ï¼šQA æ™ºç»˜é¡¹ç›®çš„æµ‹è¯•ç”¨ä¾‹è‡ªåŠ¨ç”Ÿæˆæœ¯]]></title>    <link>https://juejin.cn/post/7587335187073024026</link>    <guid>https://juejin.cn/post/7587335187073024026</guid>    <pubDate>2025-12-25T02:54:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587335187073024026" data-draft-id="7587336857538002953" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»äººåŠ›æ¨è½¦åˆ°æ™ºèƒ½å¼•æ“ï¼šQA æ™ºç»˜é¡¹ç›®çš„æµ‹è¯•ç”¨ä¾‹è‡ªåŠ¨ç”Ÿæˆæœ¯"/> <meta itemprop="keywords" content="æµ‹è¯•,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-25T02:54:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›ªçƒå·¥ç¨‹å¸ˆå›¢é˜Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/2664871914644525"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»äººåŠ›æ¨è½¦åˆ°æ™ºèƒ½å¼•æ“ï¼šQA æ™ºç»˜é¡¹ç›®çš„æµ‹è¯•ç”¨ä¾‹è‡ªåŠ¨ç”Ÿæˆæœ¯
            <!----> <!----></h1> <div class="container team-follow" data-v-d326b38e="" data-v-61fb5e44=""><div class="left" data-v-d326b38e=""><a href="/team/6942370795716870178/posts" data-v-d326b38e=""><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/962ff7fb0a7e485e8a67c02675746756~tplv-k3u1fbpfcp-watermark.image" class="icon" data-v-d326b38e=""/></a> <div class="content" data-v-d326b38e=""><div style="display: flex" data-v-d326b38e=""><a href="/team/6942370795716870178/posts" data-v-d326b38e=""><p class="title-line" data-v-d326b38e=""><span title="é›ªçƒå·¥ç¨‹å¸ˆå›¢é˜Ÿ" class="title" data-v-d326b38e="">é›ªçƒå·¥ç¨‹å¸ˆå›¢é˜Ÿ</span> <img src="//lf-web-assets.juejin.cn/obj/juejin-web/xitu_juejin_web/255e400027b783cbad76dc41527e7695.svg" alt="team icon" class="team-icon" data-v-d326b38e=""/></p></a></div> <div class="meta-box team" data-v-d326b38e="" data-v-61fb5e44=""><time datetime="2025-12-25T02:54:44.000Z" title="Thu Dec 25 2025 02:54:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-d326b38e="" data-v-61fb5e44="">
                2025-12-25
              </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-d326b38e="" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/></svg> <span class="views-count" style="display:none;" data-v-d326b38e="" data-v-61fb5e44="">
                0
              </span> <span class="read-time" data-v-d326b38e="" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-d326b38e="" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-d326b38e="" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-d326b38e="" data-v-61fb5e44=""/></svg>
                é˜…è¯»14åˆ†é’Ÿ
              </span> <!----> <!----></div></div></div> <button class="jj-follow-button follow-btn" style="display:none;" data-v-b60b2868="" data-v-d326b38e=""><span data-v-b60b2868="" data-v-d326b38e=""><i class="byte-icon byte-icon--plus" data-v-d326b38e=""><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 48 48"><path fill="none" d="M0 0h48v48H0z"/><path d="M24.7 4c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8V22h16.7c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8v1.4c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1H26v16.7c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1h-1.4c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8V26H5.3c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8v-1.4c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1H22V5.3c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1h1.4z"/></svg></i>
        å…³æ³¨
      </span></button></div> <div class="team-user block-hidden" data-v-61fb5e44=""><div class="avatar jj-avatar avatar" data-v-03256cc6="" data-v-61fb5e44=""><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="avatar" class="lazy avatar-img" data-v-5244ef91="" data-v-03256cc6=""/> </div> <!----> <span class="position ellipsis" data-v-61fb5e44="">
              @é›ªçƒè´¢ç»
            </span></div> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ed90e7850674bf1aa57b637b17c36e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuq55CD5bel56iL5biI5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236084&amp;x-signature=Qbc%2B8feZFyze7wXII84hlJ%2BSHq8%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>å¯¼è¯»ï¼š</p>
<h4 data-id="heading-0">æ„å»ºä¸€å°â€œæµ‹è¯•ç”¨ä¾‹ç”Ÿæˆå¼•æ“â€â€”â€”é©±åŠ¨è´¨é‡å·¦ç§»çš„æ™ºèƒ½é£è½®</h4>
<p>è½¯ä»¶è´¨é‡ä¸æ˜¯ç»ˆç‚¹ï¼Œè€Œæ˜¯ä¸€ä¸ªæŒç»­åŠ é€Ÿçš„é£è½®ã€‚</p>
<p>ä¼ ç»Ÿæµ‹è¯•åƒé äººåŠ›æ¨è½¦ï¼Œç¼“æ…¢ä¸”è¿Ÿæ»ï¼›è€Œ AI è¾…åŠ©çš„ç”¨ä¾‹å¼€å‘ï¼Œåˆ™æ˜¯ä¸ºè¿™ä¸ªé£è½®è£…ä¸Šä¸€å°æ™ºèƒ½å¼•æ“ã€‚</p>
<p>è¿™å°å¼•æ“ç”±ä¸ƒå¤§æ ¸å¿ƒç»„ä»¶é©±åŠ¨ï¼šä¸“å±æ•°æ®è¾“å…¥ã€æ™ºèƒ½éœ€æ±‚è§£æã€æµ‹è¯•åœºæ™¯å»ºæ¨¡ã€ç”¨ä¾‹è¿­ä»£ç”Ÿæˆã€å˜æ›´åŠ¨æ€æ„ŸçŸ¥ã€æ ‡å‡†åŒ–è¾“å‡ºé€‚é…ã€è‡ªåŠ¨åŒ–æ‰§è¡Œé›†æˆã€‚</p>
<p>å½“ä¸ƒè€…ååŒè¿è½¬ï¼Œå¼•æ“è½°é¸£å¯åŠ¨â€”â€”ç”¨ä¾‹è‡ªåŠ¨ç”Ÿæˆã€é£é™©æå‰æš´éœ²ã€åé¦ˆé—­ç¯åŠ é€Ÿï¼ŒçœŸæ­£å®ç°â€œè´¨é‡å†…å»ºï¼Œå·¦ç§»è½åœ°â€ã€‚</p>
</blockquote>
<h2 data-id="heading-1">ä¸€ã€èƒŒæ™¯</h2>
<p>QAåŒå­¦ä¸€å®šæ‡‚è¿™ä¸ªç—›ç‚¹ï¼šé•¿æœŸä½¿ç”¨å›ºå®šæµ‹è¯•ç”¨ä¾‹é›†æˆ–åŒä¸€æµ‹è¯•æ–¹æ³•ï¼Œè½¯ä»¶ä¼šåƒç”Ÿç‰©æŠ—è¯æ€§ä¸€æ ·äº§ç”Ÿâ€œæµ‹è¯•å…ç–«åŠ›â€ï¼Œç¼ºé™·å‘ç°æ•ˆç‡è¶Šæ¥è¶Šä½â€”â€”è¿™å°±æ˜¯æµ‹è¯•é¢†åŸŸçš„â€œæ€è™«å‰‚æ‚–è®ºâ€ã€‚</p>
<p>ä¸ºäº†åº”å¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¸€ç›´é æŒç»­è¿­ä»£ç”¨ä¾‹ã€åŠ¨æ€æ‰©å……æ•°æ®ã€ç»„åˆäº¤å‰æµ‹è¯•ç­‰æ–¹æ³•ç»´æŒæœ‰æ•ˆæ€§ã€‚ä½†éšç€é¡¹ç›®å¿«é€Ÿè¿­ä»£ï¼Œä¸šåŠ¡åœºæ™¯å’ŒåŠŸèƒ½æ¨¡å—è¶Šæ¥è¶Šå¤šï¼Œæ–°çš„éš¾é¢˜åˆå†’äº†å‡ºæ¥ï¼š</p>
<ul>
<li>
<p>éœ€æ±‚åˆ†æã€ç”¨ä¾‹å¼€å‘ç»´æŠ¤å¤æ‚åº¦é£™å‡ï¼šæ—¢è¦ç²¾å‡†å¯¹é½æ–°å¢åŠŸèƒ½ç»†èŠ‚ï¼Œåˆè¦å…¼é¡¾å›å½’ç”¨ä¾‹å…¼å®¹æ€§ï¼Œæœ‰é™æ—¶é—´é‡Œå¾—åå¤æ¢³ç†æ–°æ—§åœºæ™¯å…³è”ï¼›</p>
</li>
<li>
<p>ç”¨ä¾‹åº“ç´¯ç§¯æˆè´Ÿæ‹…ï¼šæ—¥å¸¸ç»´æŠ¤è¦è€—è´¹å¤§é‡ç²¾åŠ›æ›´æ–°é€‚é…ï¼Œéœ€æ±‚ç´§æ€¥æ—¶è¿˜å®¹æ˜“é™·å…¥â€œæ—§ç”¨ä¾‹è¦†ç›–ä¸åˆ°æ–°åœºæ™¯ã€æ–°ç”¨ä¾‹å…¼é¡¾ä¸åˆ°è€é€»è¾‘â€çš„è¢«åŠ¨ï¼›</p>
</li>
<li>
<p>â€œæµ‹è¯•å…ç–«åŠ›â€é—®é¢˜æ”¾å¤§ï¼šé«˜é¢‘è¿­ä»£ä¸‹ï¼Œä¼ ç»Ÿæ–¹æ³•çš„å±€é™æ€§è¶Šæ¥è¶Šæ˜æ˜¾ï¼Œæ‹–æ…¢æµ‹è¯•èŠ‚å¥çš„åŒæ—¶ï¼Œç¼ºé™·æ¼æµ‹é£é™©ä¹Ÿåœ¨å¢åŠ ã€‚</p>
</li>
</ul>
<p>åœ¨AIæŠ€æœ¯çˆ†å‘çš„å½“ä¸‹ï¼Œæˆ‘ä»¬å†³å®šè·³å‡ºä¼ ç»Ÿæ¡†æ¶ï¼Œæ‰“é€ **ã€ŒQAæ™ºç»˜ã€**é¡¹ç›®ï¼Œç”¨æ™ºèƒ½ç ´è§£â€œæŠ—è¯æ€§â€ï¼Œä»æ ¹æœ¬ä¸Šæœç»â€œé›ªçƒæµ‹è¯•â€ä¸­çš„æ€è™«å‰‚æ•ˆåº”ã€‚</p>
<h2 data-id="heading-2">äºŒã€ã€ŒQAæ™ºç»˜ã€ä¹‹Featureæµ‹è¯•ç”¨ä¾‹ç”Ÿæˆï¼šä¸‰å±‚æ¶æ„æå®šè‡ªåŠ¨åŒ–</h2>
<p>ä¼ ç»Ÿæµ‹è¯•ç”¨ä¾‹å¼€å‘ï¼ŒQAè¦èµ°å®Œâ€œéœ€æ±‚åˆ†æâ†’ç”¨ä¾‹è®¾è®¡â†’è¯„å®¡ä¼˜åŒ–â†’ç®¡ç†ç»´æŠ¤â€å…¨æµç¨‹ã€‚è€ƒè™‘åˆ°ç”¨ä¾‹è¯„å®¡æ˜¯äº§ç ”æµ‹ä¸‰æ–¹å¯¹é½é€»è¾‘çš„å…³é”®èŠ‚ç‚¹ï¼Œå› æ­¤æˆ‘ä»¬ä¼˜å…ˆèšç„¦å¦å¤–ä¸‰ä¸ªç¯èŠ‚ï¼Œç»“åˆå¤§æ¨¡å‹èƒ½åŠ›æ­å»ºäº†â€œè¾“å…¥-ç”Ÿæˆ-è¾“å‡ºâ€ä¸‰å±‚AIè‡ªåŠ¨ç”Ÿæˆæ¶æ„ï¼Œå†ä¾æ‰˜DifyåŸºå»ºèƒ½åŠ›åšå…¨é“¾è·¯æ”¯æ’‘ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39a5676132024be7bfaedd1e790b5004~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuq55CD5bel56iL5biI5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236084&amp;x-signature=y7oy%2Bf2KW%2Fj7b9VzwJDfmRn8B9U%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p><strong>è¾“å…¥å±‚</strong>å®Œæˆå¯¹æ•°æ®æºçš„è‡ªåŠ¨é›†æˆä¸æ™ºèƒ½å…³è”ï¼Œä»æ ¹æºæ¶ˆå¼­éœ€æ±‚ä¼ é€’ä¸­çš„æ­§ä¹‰ï¼›</p>
</li>
<li>
<p><strong>ç”Ÿæˆå±‚</strong>ä»¥ Dify æä¾›çš„å·¥ä½œæµå¼•æ“ã€å¤šæ¨¡å‹è°ƒåº¦ã€Prompt+æ€ç»´é“¾æ¶æ„ä¸ºåº•åº§ï¼Œæ­é…æ¥å…¥çš„å·¥å…·é€‚é…èƒ½åŠ›ï¼Œé©±åŠ¨æ ¸å¿ƒæ¨¡å—å®Œæˆä»éœ€æ±‚åˆ†æã€éœ€æ±‚ç‚¹åˆ†è§£åˆ°ç”¨ä¾‹ç”Ÿæˆä¸ä¼˜åŒ–çš„å…¨æµç¨‹è‡ªåŠ¨åŒ–ï¼›</p>
</li>
<li>
<p><strong>è¾“å‡ºå±‚</strong>é€šè¿‡äººæœºååŒæœºåˆ¶ï¼Œå®ç°æµ‹è¯•ç”¨ä¾‹çš„æŒç»­è¿­ä»£ä¸æ ‡å‡†åŒ–é—­ç¯äº¤ä»˜ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/711e04cb11124b2a811a710d1566a2fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuq55CD5bel56iL5biI5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236084&amp;x-signature=U%2FFR%2FwXoJHqU9sGJZ4DfwSti5Es%3D" alt="" loading="lazy"/></p>
<div align="center">Featureç”¨ä¾‹ç”Ÿæˆçš„ä¸‰å±‚æ¶æ„</div>
<p>ç®€å•è¯´ï¼Œè¿™ä¸ªä½“ç³»çš„æ ¸å¿ƒå°±æ˜¯ä¸€å¥—æ™ºèƒ½å¢å¼ºå†³ç­–ç³»ç»Ÿï¼šæ¥æ”¶éœ€æ±‚åï¼Œä¼šæŒ‰ä¸¥å¯†çš„â€œæ€è€ƒé“¾â€åšä»»åŠ¡åˆ†è§£ã€é€»è¾‘æ¨ç†å’Œç»“æœéªŒè¯ï¼Œæœ€ç»ˆå®ç°ç”¨ä¾‹çš„è‡ªåŠ¨åŒ–ç”Ÿæˆä¸æ ‡å‡†åŒ–äº¤ä»˜ã€‚ä¸‹é¢æˆ‘ä»¬é€å±‚æ‹†è§£æ ¸å¿ƒé€»è¾‘ï¼š</p>
<h4 data-id="heading-3">1. è¾“å…¥å±‚ï¼šæ™ºèƒ½åŒ–çš„æ•°æ®æ•´åˆåˆ†æ</h4>
<p>é«˜è´¨é‡ç”¨ä¾‹çš„å‰ææ˜¯å®Œæ•´çš„éœ€æ±‚åˆ†æï¼Œä½†äººå·¥åˆ†æå¾ˆå®¹æ˜“å‡ºé—®é¢˜ï¼šå¯¹ä¸šåŠ¡é€»è¾‘ç†è§£ä¸åˆ°ä½ã€éœ€æ±‚å˜æ›´è·Ÿè¿›æ»åã€ä¸ªäººç»éªŒå±€é™å¯¼è‡´é£é™©åˆ¤æ–­ä¸è¶³â€¦â€¦ä¸ºäº†è§£å†³è¿™äº›ç—›ç‚¹ï¼Œæˆ‘ä»¬æ•´åˆäº†å››å¤§æ•°æ®æºï¼Œæ­é…Promptå·¥ç¨‹+æ€ç»´é“¾ï¼Œæ‰“é€ äº†ä¸€ä¸ªâ€œä¼šæ€è€ƒâ€çš„æµ‹è¯•æ•°æ®ä¸­æ¢ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/745e69d1a74f454ba609eff1fce2e378~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuq55CD5bel56iL5biI5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236084&amp;x-signature=f665%2BJWc3NEoV4V1%2FC%2BbYBJD6Jw%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸ªä¸­æ¢çš„æ ¸å¿ƒèƒ½åŠ›æœ‰4ä¸ªï¼š</p>
<ul>
<li>
<p><strong>è¯­ä¹‰æ·±åº¦æ¨ç†ä¸é£é™©é¢„åˆ¤</strong>ï¼šåˆ©ç”¨LLMï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰æ·±åº¦è§£æä¸šåŠ¡é€»è¾‘ã€ç”¨æˆ·æ—…ç¨‹ä¸å¤æ‚è§„åˆ™ï¼ˆå¦‚â€œæ”¯ä»˜æµç¨‹ä¸­æ‰‹ç»­è´¹è®¡ç®—è§„åˆ™â€ï¼‰ï¼›è‡ªåŠ¨æ ‡è¯†<strong>é«˜é£é™©åŠŸèƒ½ç‚¹</strong>ï¼ˆå¦‚èµ„æŸç›¸å…³æ“ä½œï¼‰ï¼›</p>
</li>
<li>
<p><strong>è§†è§‰åŒ–ä¸Šä¸‹æ–‡ç†è§£</strong>ï¼šé›†æˆ<strong>VLMï¼ˆè§†è§‰å¤§æ¨¡å‹ï¼‰ä¸OCRæŠ€æœ¯</strong>ï¼Œè®©AIâ€œçœ‹æ‡‚â€UIç•Œé¢ï¼Œè¯†åˆ«å…ƒç´ çŠ¶æ€ä¸è®¾è®¡å†²çªï¼Œä¸ºäº¤äº’æµ‹è¯•ä¸è§†è§‰å…¼å®¹æ€§æµ‹è¯•æ„å»ºåƒç´ çº§åˆ¤å®šåŸºçº¿ï¼›</p>
</li>
<li>
<p><strong>å†å²ç»éªŒçš„çŸ¥è¯†åŒ–å¤ç”¨</strong>ï¼šé€šè¿‡ç”¨<strong>RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æŠ€æœ¯</strong>æ£€ç´¢é›ªçƒçŸ¥è¯†åº“ä¸å†å²ç”¨ä¾‹ï¼Œè¡¥å…¨ä¸šåŠ¡èƒŒæ™¯ã€æ˜ å°„åŠŸèƒ½æ¨¡å—å…³è”ï¼Œä¸ºAIè£…é…ä¸Šâ€œèµ„æ·±æµ‹è¯•ä¸“å®¶çš„è®°å¿†åº“â€ï¼›</p>
</li>
<li>
<p>**Prompt +æ€ç»´é“¾ï¼š**ä»¥ â€œéœ€æ±‚åˆ†æâ†’ä¸šåŠ¡æ‹†è§£â†’ç”¨ä¾‹ç”Ÿæˆâ€ ä¸ºæ ¸å¿ƒæ¡†æ¶ï¼ŒæŒ‰ä¸šåŠ¡ç‰¹å¾å·®å¼‚åŒ–å®šåˆ¶å„æ¨¡å—çš„æ ¸å¿ƒä¾§é‡ç‚¹ã€è¾“å…¥è¾“å‡ºè§„èŒƒåŠ Prompt é€»è¾‘ã€‚é€šè¿‡æ¨¡å—åŒ–é™ä½æ¨¡å‹è®¤çŸ¥è´Ÿæ‹…ï¼Œç²¾å‡†é€‚é…ä¸šåŠ¡é£é™©ï¼Œé¿å…ç”¨ä¾‹è¦†ç›–ä¸å…¨æˆ–å†—ä½™ã€‚</p>
</li>
</ul>
<p>è¾“å…¥å±‚ä½œä¸ºä¸€ä¸ªæ™ºèƒ½åŒ–çš„**æ•°æ®æ•´åˆåˆ†æä¸­å¿ƒï¼Œ**å°†åŸæœ¬å­¤ç«‹ã€é™æ€çš„æ•°æ®èµ„äº§ï¼Œè½¬åŒ–ä¸ºåŠ¨æ€å¯æ¨ç†çš„â€œæ´»åŒ–çŸ¥è¯†å›¾è°±â€ï¼Œä½¿æµ‹è¯•è®¾è®¡ä»æºå¤´å°±ç«‹è¶³äºå…¨é¢ç²¾å‡†çš„æ•°æ®æ”¯æ’‘ï¼›å¹¶å°†åˆ†æ•£çš„éœ€æ±‚ä¿¡æ¯ã€æŠ€æœ¯èƒŒæ™¯ä¸å†å²ç»éªŒï¼Œè½¬åŒ–ä¸ºå¯è½åœ°ã€å¯é‡åŒ–çš„æµ‹è¯•ç­–ç•¥ï¼Œä»æ ¹æºä¸ŠåŒ–è§£éœ€æ±‚æ­§ä¹‰ã€æ‰“ç ´æ•°æ®å­¤å²›ã€å¡«è¡¥è¦†ç›–ç›²åŒºï¼Œä¸ºåç»­ç”¨ä¾‹ç”Ÿæˆç­‘ç‰¢åŸºç¡€ã€‚</p>
<h4 data-id="heading-4">2. ç”Ÿæˆå±‚ï¼šAIé©±åŠ¨çš„ç”¨ä¾‹æ™ºèƒ½ç”Ÿäº§é“¾</h4>
<p>å®Œæˆä¸Šæ¸¸å¤šæºä¿¡æ¯çš„æ™ºèƒ½èåˆåï¼Œæµç¨‹å³è¿›å…¥æ ¸å¿ƒçš„æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆé˜¶æ®µã€‚è¯¥é˜¶æ®µå°†ç³»ç»Ÿæ€§è½åœ° â€œéœ€æ±‚åˆ†æâ†’éœ€æ±‚ç‚¹åˆ†æä¸åˆ†ç»„â†’ç”¨ä¾‹åˆæ­¥ç”Ÿæˆâ†’ç”¨ä¾‹è¯„åˆ†â†’ç”¨ä¾‹ä¼˜åŒ–â€ å…¨æµç¨‹ï¼Œç¡®ä¿æ¯ä¸€æ­¥è¡”æ¥æœ‰åºã€é—­ç¯å¯æ§ã€‚</p>
<p>ä»¥å…¶ä¸­çš„ç”¨ä¾‹ç”Ÿæˆç¯èŠ‚ä¸ºä¾‹ï¼š
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18c0c70d26c14362ad43ab1ad6792a63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuq55CD5bel56iL5biI5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236084&amp;x-signature=4pnHPlJ8NrUZiFOIA3kLeqXnZww%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p><strong>éœ€æ±‚ç‚¹é¢„åˆ†ç»„ï¼Œè§„é¿è¾“å…¥è¿‡è½½ä¸è¾“å‡ºæˆªæ–­</strong>ï¼šç”¨DAGåˆ†ææŠŠå¤æ‚éœ€æ±‚æ‹†åˆ†æˆå¤šä¸ªé«˜å†…èšçš„â€œéœ€æ±‚ç‚¹åŒ…â€ï¼Œå†åºåˆ—åŒ–è¾“å…¥ï¼Œè§£å†³å¤§æ¨¡å‹ä¸Šä¸‹æ–‡è¿‡è½½é—®é¢˜ï¼Œé¿å…é€»è¾‘é—æ¼ä¸è¾“å‡ºæˆªæ–­ï¼›</p>
</li>
<li>
<p>**å¤šæ¨¡å‹ååŒï¼Œæå‡ç”¨ä¾‹æ€ç»´çš„æ·±åº¦ä¸å¹¿åº¦ï¼š**ç»“åˆä¸åŒæ¨¡å‹ä¼˜åŠ¿ï¼Œç”Ÿæˆè¦†ç›–æ­£å¸¸ã€å¼‚å¸¸ã€æ¢ç´¢æ€§åœºæ™¯çš„å¤šæ ·åŒ–ç”¨ä¾‹ï¼Œé¿å…å•ä¸€æ¨¡å‹é—æ¼æ·±å±‚éšåŒ¿çš„ç¼ºé™·ï¼›</p>
</li>
<li>
<p>**æ ‡æ³¨æ¨¡æ¿çº¦æŸï¼Œç¡®ä¿ç”¨ä¾‹äº§å‡ºçš„æ ‡å‡†åŒ–ï¼š**ä»¥JSON Schemaå®šä¹‰æ•°æ®æ¨¡å‹ï¼Œç¡®ä¿ç”¨ä¾‹åŒ…å«â€œå‰ç½®æ¡ä»¶â†’æ“ä½œæ­¥éª¤â†’é¢„æœŸç»“æœâ€ç­‰è¦ç´ ï¼Œå†å€ŸåŠ© Jinja æ¨¡æ¿è½¬æ¢ä¸ºæ ‡å‡†æ ¼å¼ï¼Œæå‡åç»­è¯„å®¡ã€æ‰§è¡Œã€ç»´æŠ¤æ•ˆç‡ï¼›</p>
</li>
<li>
<p>**åæ€(Reflection)æ¨¡å¼ï¼Œé©±åŠ¨ç”¨ä¾‹å¾ªç¯å¼ºåŒ–ï¼š**å†…ç½®å¤šç»´åº¦è´¨é‡é‡åŒ–è¯„åˆ†ç®—æ³•ï¼Œä»å®Œæ•´æ€§ã€å‡†ç¡®æ€§ã€å¯æ‰§è¡Œæ€§ã€è¦†ç›–åº¦ç­‰ç»´åº¦æ‰“åˆ†ï¼Œä½äºé˜ˆå€¼è‡ªåŠ¨æ‰“å›é‡ç”Ÿæˆï¼Œå½¢æˆâ€œè¯„ä¼°-åé¦ˆ-ä¼˜åŒ–â€é—­ç¯ï¼Œä¿éšœç”¨ä¾‹è´¨é‡ã€‚</p>
</li>
</ul>
<h4 data-id="heading-5">3. è¾“å‡ºå±‚ï¼šæ ‡å‡†åŒ–é—­ç¯äº¤ä»˜</h4>
<p>ç»è¿‡ç”Ÿæˆå±‚çš„æ‹†è§£ã€è¯„ä¼°ã€ä¼˜åŒ–ï¼Œç”¨ä¾‹æœ€ç»ˆåœ¨è¾“å‡ºå±‚å®Œæˆäº¤ä»˜ã€‚è¾“å‡ºå±‚çš„æ ¸å¿ƒç›®æ ‡æ˜¯ç¡®ä¿AIç”Ÿæˆçš„æµ‹è¯•ç”¨ä¾‹èƒ½å¤Ÿ<strong>å®‰å…¨ã€å¯é åœ°èå…¥ç°æœ‰å·¥å…·é“¾</strong>ï¼Œå®ç°ä»ç”Ÿæˆåˆ°å¯ç”¨çš„â€œæœ€åä¸€å…¬é‡Œâ€é—­ç¯ã€‚å…¶è¿ä½œä¾èµ–äºä¸¤å¤§å…³é”®æœºåˆ¶ï¼š</p>
<ul>
<li>
<p><strong>äººæœºååŒå®¡æ ¸</strong>ï¼šå»ºç«‹â€œAIåˆç­›-äººå·¥å¤æ ¸â€çš„åä½œæ¨¡å¼ã€‚äººå·¥é‡ç‚¹æ ¡éªŒä¸Šä¸‹æ–‡ä¸€è‡´æ€§ï¼ˆç¡®ä¿ç”¨ä¾‹å¯¹åº”éœ€æ±‚èŠ‚ç‚¹ï¼‰å’Œä¸šåŠ¡è§„åˆ™å‡†ç¡®æ€§ï¼Œè§„é¿AIâ€œå¹»è§‰â€é£é™©ï¼Œç»™ç”¨ä¾‹è´¨é‡å…œåº•ï¼›</p>
</li>
<li>
<p><strong>ç»“æ„åŒ–åˆ†å‘</strong>ï¼šå®¡æ ¸é€šè¿‡çš„ç”¨ä¾‹ä¼šè¢«è‡ªåŠ¨èµ‹äºˆä¸°å¯Œçš„<strong>ç»“æ„åŒ–æ ‡ç­¾</strong>ï¼ˆå¦‚å…³è”éœ€æ±‚IDã€æµ‹è¯•ç±»å‹ã€ä¼˜å…ˆçº§P0-P2ï¼‰ï¼Œå®Œæˆâ€œèµ„äº§åŒ–â€å°è£…ã€‚éšåï¼Œé€šè¿‡é¢„å®šä¹‰çš„APIæ¥å£ï¼Œå°†ç”¨ä¾‹åŒæ­¥åˆ°é£ä¹¦ã€MeterSphereã€é›ªå³°åå°ç­‰ç›®æ ‡å¹³å°ï¼Œå®ç°æµ‹è¯•èµ„äº§çš„<strong>æ— ç¼é›†æˆ</strong>ä¸<strong>ç«¯åˆ°ç«¯å¯è¿½æº¯ã€‚</strong></p>
</li>
</ul>
<p>è‡³æ­¤ï¼ŒFeatureæµ‹è¯•ç”¨ä¾‹è‡ªåŠ¨ç”Ÿæˆç³»ç»Ÿå·²æ­£å¼è½åœ°äº¤ä»˜ã€‚åœ¨ç¤¾åŒºå¹³å°ä¸šåŠ¡çš„å®é™…åº”ç”¨ä¸­ï¼Œè‡ªåŠ¨ç”Ÿæˆç”¨ä¾‹çš„æœ‰æ•ˆç‡è¾¾70%ä»¥ä¸Šï¼Œæ˜¾è‘—èŠ‚çœäº†äººå·¥æŠ•å…¥ã€æå‡äº†æµ‹è¯•æ•ˆç‡ã€‚åç»­æˆ‘ä»¬å°†æŒç»­ç²¾è¿›è¿™ä¸€èƒ½åŠ›ï¼Œå¹¶é€æ­¥æ‹“å±•è‡³æ›´å¤šä¸šåŠ¡åœºæ™¯ã€‚</p>
<blockquote>
<p>æå®šåŠŸèƒ½çº§ç”¨ä¾‹ç”Ÿæˆåï¼Œæˆ‘ä»¬æŠŠç›®å…‰æŠ•å‘äº†å‰åç«¯åä½œçš„æ ¸å¿ƒçº½å¸¦â€”â€”æ¥å£å±‚ã€‚æ¯•ç«Ÿæ¥å£çš„ç¨³å®šæ€§ç›´æ¥å…³ç³»ä¸šåŠ¡æµç¨‹å¯é æ€§ï¼Œã€ŒQAæ™ºç»˜ã€çš„æ™ºèƒ½ç”Ÿæˆèƒ½åŠ›ä¹Ÿéšä¹‹å»¶ä¼¸åˆ°äº†æ¥å£æµ‹è¯•é¢†åŸŸã€‚</p>
</blockquote>
<h2 data-id="heading-6">ä¸‰ã€ ã€ŒQAæ™ºç»˜ã€ä¹‹æ¥å£ç”¨ä¾‹è‡ªåŠ¨åŒ–ï¼šåŒæ ¸æ€è·¯ç ´è§£æµ‹è¯•ç—›ç‚¹</h2>
<p>åšæ¥å£æµ‹è¯•ï¼Œæœ€å¤´ç–¼çš„ä¸¤ä»¶äº‹ï¼šä¸€æ˜¯ç”¨ä¾‹å®¹æ˜“è¦†ç›–ä¸å…¨ã€åˆ†æ”¯æ¼æµ‹ï¼›äºŒæ˜¯ç”¨ä¾‹ç»´æŠ¤éš¾ï¼Œä»£ç è¿­ä»£ä¸€æ¬¡å°±è¦ç»´æŠ¤åŠå¤©ã€‚è¿™æ­£æ˜¯æˆ‘ä»¬è®¾è®¡ã€ŒQAæ™ºç»˜ã€ä¹‹æ¥å£ç”¨ä¾‹è‡ªåŠ¨åŒ–ç³»ç»Ÿçš„ç›´æ¥åŸå› ã€‚ä¸ºäº†å½»åº•è§£å†³è¿™äº›ç—›ç‚¹ï¼Œæˆ‘ä»¬å¸¦æ¥äº†ä¸€å¥—å¯è½åœ°çš„å®Œæ•´æ–¹æ¡ˆï¼šé€šè¿‡æ·±æŒ–è°ƒç”¨é“¾åƒé€æ¥å£ä»£ç ï¼Œå®ç°ç”¨ä¾‹çš„ä»£ç çº§å…¨è¦†ç›–ï¼›å†å€ŸåŠ©AIé—­ç¯è‡ªä¼˜åŒ–ï¼Œè®©ç”¨ä¾‹è¶Šç”¨è¶Šç²¾å‡†ï¼Œä»è€ŒçœŸæ­£æ‘†è„±é‡å¤ä½æ•ˆçš„æ‰‹åŠ¨æ“ä½œã€‚è¯¥è®¾è®¡å·²åœ¨ç³»ç»Ÿçš„å››å±‚æ¶æ„ä¸­å…¨é¢è½åœ°ï¼Œå½¢æˆä»é—®é¢˜è¯†åˆ«åˆ°è‡ªä¸»ä¼˜åŒ–çš„å®Œæ•´é—­ç¯ã€‚å¦‚å›¾æ‰€ç¤ºï¼š
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/242ab04b30744577a0aa8947d8b64daf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuq55CD5bel56iL5biI5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236084&amp;x-signature=ifl1fWbTSWdY1aZkThXdsbMkSlA%3D" alt="" loading="lazy"/></p>
<p>æ•´ä¸ªç³»ç»Ÿé‡‡ç”¨æ¸…æ™°çš„åˆ†å±‚è®¾è®¡ï¼Œå„å±‚å„å¸å…¶èŒåˆç´§å¯†ååŒï¼š</p>
<ul>
<li>
<p>**åŸºå»ºæ”¯æ’‘å±‚ï¼šæ‰“ä¸‹åšå®çš„â€œåœ°åŸºâ€ ï¼Œ**åŒ…å«è°ƒç”¨é“¾å·¥ç¨‹ã€AIæ¨¡å‹é…ç½®ä¸MCPæœåŠ¡ã€MySQLä¸ç³»ç»Ÿé…ç½®ï¼Œä¸ºä¸Šå±‚èƒ½åŠ›æä¾›æ ¸å¿ƒæ”¯æ’‘ï¼›</p>
</li>
<li>
<p>**æ ¸å¿ƒä¸šåŠ¡å±‚ï¼šæ‰¿è½½æ ¸å¿ƒè§£å†³æ–¹æ¡ˆï¼Œ**è¿™æ˜¯ç³»ç»Ÿçš„â€œå¤§è„‘â€å’Œâ€œä¸­æ¢â€ã€‚åŒ…å«AIç”¨ä¾‹ç”Ÿæˆæ¨¡å—ã€ç”¨ä¾‹æ‰§è¡Œæ¨¡å—ã€ç»“æœåˆ†ææ¨¡å—ã€ç”¨ä¾‹è´¨é‡è¯„ä¼°æ¨¡å—ï¼Œè®©ç”¨ä¾‹åº“â€œè¶Šç”¨è¶Šç²¾å‡†â€ï¼Œä»è€Œè§£å†³â€œç»´æŠ¤éš¾â€çš„æŒ‘æˆ˜ï¼›</p>
</li>
<li>
<p>**åº”ç”¨å±‚ï¼šç»Ÿä¸€æ²»ç†ä¸å¯è§†åŒ–å¹³å°ï¼Œ**é€šè¿‡é›ªå³°ç³»ç»Ÿï¼Œæˆ‘ä»¬å°†æ ¸å¿ƒèƒ½åŠ›è½¬åŒ–ä¸ºç”¨æˆ·å¯ä¾¿æ·æ“ä½œçš„äº§å“ç•Œé¢ï¼ŒåŒ…å«æ¥å£ç®¡ç†ã€ç”¨ä¾‹ç®¡ç†ã€ç»“æœå±•ç¤ºï¼Œè®©æŠ€æœ¯èƒ½åŠ›é€‚ç”¨æ‰€æœ‰QAå’Œç ”å‘åŒå­¦ï¼›</p>
</li>
<li>
<p>**æ¥å…¥å±‚ï¼šæ¥å…¥ç ”å‘ç”Ÿæ€ï¼Œ**é€šè¿‡å¯¹æ¥Gitã€YAPIã€é›ªå³°ç­‰ç°æœ‰ç ”å‘å·¥å…·é“¾ï¼Œç³»ç»Ÿèƒ½å¤Ÿè‡ªåŠ¨è·å–æ¥å£å®šä¹‰ã€ä»£ç å˜æ›´ç­‰å…³é”®ä¿¡æ¯ï¼Œå®ç°æµç¨‹çš„æ— ç¼é›†æˆï¼Œè®©æµ‹è¯•å·¦ç§»å’ŒæŒç»­æµ‹è¯•æˆä¸ºè‡ªç„¶æµç¨‹ã€‚</p>
</li>
</ul>
<p>åŸºäºä»¥ä¸Šå¯¹ç³»ç»Ÿæ¶æ„çš„åˆ†å±‚è§£æï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ•´ä¸ªç³»ç»Ÿå¹¶éç®€å•çš„åŠŸèƒ½å †ç Œï¼Œè€Œæ˜¯ä¸ºå½»åº•è§£å†³æ–‡ç« å¼€å¤´æå‡ºçš„ç—›ç‚¹ï¼Œæ‰€ç²¾å¿ƒæ„å»ºçš„ä¸€æ¡æŠ€æœ¯å®ç°è·¯å¾„ï¼Œè¿™æ¡è·¯å¾„åœ¨æ¶æ„ä¸­æ¸…æ™°å¯è§ï¼Œå¹¶æœ€ç»ˆå‡ç»“ä¸ºæ”¯æ’‘ã€ŒQAæ™ºç»˜ã€é«˜æ•ˆè¿è¡Œçš„ä¸‰ä¸ªæ ¸å¿ƒè®®é¢˜ã€‚</p>
<h4 data-id="heading-7">1. ç”¨ä¾‹å…¨è¦†ç›–ï¼šä»£ç +è°ƒç”¨é“¾åŒé©±åŠ¨</h4>
<p>å¾ˆå¤šæ—¶å€™éœ€æ±‚æ–‡æ¡£é‡Œåªæœ‰æ¥å£çš„è¡¨é¢è§„åˆ™ï¼Œé‚£äº›éšæ€§æ ¡éªŒã€å¼‚å¸¸åˆ†æ”¯ã€æ¨¡å—ä¾èµ–ï¼Œæ ¹æœ¬æ— ä»çŸ¥æ™“ã€‚è€Œâ€œä»£ç +è°ƒç”¨é“¾â€çš„åŒé©±åŠ¨æ¨¡å¼ï¼Œå°±èƒ½æŠŠè¿™äº›éšè—çš„é€»è¾‘å…¨æŒ–å‡ºæ¥ã€‚æ ¸å¿ƒç›®æ ‡å¾ˆç®€å•ï¼š<strong>è®©æ¯ä¸€è¡Œæ ¸å¿ƒä»£ç éƒ½æœ‰å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹ï¼Œæ¯ä¸€ä¸ªåˆ†æ”¯é€»è¾‘éƒ½è¢«è¦†ç›–</strong>ã€‚</p>
<p>ä¹‹å‰æˆ‘ä»¬åœ¨ã€Šä»£ç "è´è¶æ•ˆåº”"ç»ˆç»“è€…:Al Review+ASTè”å±•,æ„å»ºæ™ºèƒ½æµ‹è¯•é˜²å¾¡æ–°ä½“ç³»ã€‹ä¸€æ–‡ä¸­ï¼Œå·²ç»æ­å»ºå¥½äº†ä»£ç å¯¼èˆªç³»ç»Ÿï¼Œèƒ½æ¸…æ™°æ¢³ç†å‡ºæ¯ä¸ªæ–¹æ³•ä¹‹é—´çš„è°ƒç”¨å…³ç³»ã€‚åŸºäºè¿™ä¸ªç³»ç»Ÿï¼Œæˆ‘ä»¬å°±èƒ½è·å–æ¥å£ä»ä¸Šåˆ°ä¸‹çš„å®Œæ•´è°ƒç”¨é“¾ä»£ç ï¼Œå†è®©AIæŒ‰è§„åˆ™<strong>ä¸€é”®ç”Ÿæˆä»£ç å…¨è¦†ç›–ç”¨ä¾‹</strong>ã€‚å¦‚å›¾æ‰€ç¤ºï¼šã€ŒQAæ™ºç»˜ã€ä¹‹æ¥å£ç”¨ä¾‹è‡ªåŠ¨åŒ–é¡¹ç›®ç³»ç»Ÿæ€§åœ°é€šè¿‡ â€œå¤šæºæ•°æ®æ•´åˆâ†’ å¤šæ¨¡å‹ç‹¬ç«‹æ¢ç´¢ â†’ æ™ºèƒ½èåˆä»²è£â€ ä¸‰æ­¥æ³•ï¼Œæ¥æœ€å¤§åŒ–é€¼è¿‘æµ‹è¯•ç”¨ä¾‹çš„å…¨è¦†ç›–ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97abf730c9f845ac9978e14ef412b7ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuq55CD5bel56iL5biI5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236084&amp;x-signature=WfybljbBEIwQIUVW%2BhHR%2BR5Aa%2B4%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p><strong>å¤šæºæ•°æ®æ•´åˆï¼Œæ„å»ºå…¨æ™¯è®¤çŸ¥ï¼ˆæ•°æ®é©±åŠ¨ï¼‰</strong>ï¼šæµç¨‹å§‹äºå¯¹æ¥å£çš„360åº¦æ·±åº¦é€è§†ã€‚è‡ªåŠ¨åŒ–åœ°ä»å¤šä¸ªå…³é”®æ•°æ®æºåŒæ­¥è·å–ä¿¡æ¯ï¼Œå½¢æˆä¸€ä»½æ•´åˆçš„Promptï¼Œä»æºå¤´ç¡®ä¿ç”Ÿæˆç”¨ä¾‹çš„è¾“å…¥ä¿¡æ¯æ˜¯å…¨é¢ã€ç«‹ä½“ä¸”å‡†ç¡®çš„ï¼›</p>
</li>
<li>
<p><strong>å¤šæ¨¡å‹ç‹¬ç«‹æ¢ç´¢ï¼Œæ¿€å‘æ€ç»´å¤šæ ·æ€§ï¼ˆæ™ºèƒ½é©±åŠ¨ï¼‰</strong>ï¼šè¿™æ˜¯ç¡®ä¿è¦†ç›–èŒƒå›´ã€é¿å…å•ä¸€æ¨¡å‹æ€ç»´å±€é™çš„å…³é”®è®¾è®¡ã€‚ç³»ç»Ÿå¹¶è¡Œå‘èµ·ä¸‰æ¬¡å¼‚æ­¥è°ƒç”¨ï¼Œä»ä¸åŒè§†è§’ç‹¬ç«‹æ„æ€æµ‹è¯•æ–¹æ¡ˆï¼Œä»è€Œæ±‡é›†å¤šæ ·åŒ–çš„æµ‹è¯•æƒ³æ³•ï¼Œæœ‰æ•ˆé¿å…äº†å› å•ä¸€AIæ€è·¯å›ºåŒ–å¯¼è‡´çš„è¦†ç›–ç›²åŒºï¼›</p>
</li>
<li>
<p><strong>æ™ºèƒ½èåˆä»²è£ï¼Œç”Ÿæˆæœ€ä¼˜é›†ï¼ˆé—­ç¯ä¼˜åŒ–ï¼‰</strong>ï¼šå¹¶è¡Œæ¢ç´¢äº§å‡ºäº†ä¸‰ä»½å„æœ‰ä¾§é‡ã€å¯èƒ½å­˜åœ¨å†—ä½™æˆ–å†²çªçš„ç”¨ä¾‹è‰æ¡ˆã€‚ç³»ç»Ÿå¼•å…¥äº†å…³é”®çš„ç¬¬å››æ¬¡æ¨¡å‹è°ƒç”¨ï¼Œæ‰®æ¼”â€œé¦–å¸­æµ‹è¯•æ¶æ„å¸ˆâ€çš„è§’è‰²ï¼Œç¡®ä¿æœ€ç»ˆå…¥åº“çš„ç”¨ä¾‹é›†æ˜¯â€œ1+1+1 &gt; 3â€çš„é«˜è´¨é‡ã€é«˜å¯ä¿¡åº¦æˆæœã€‚</p>
</li>
</ul>
<h4 data-id="heading-8">2. è¦†ç›–ç‡å¯è§†åŒ–ï¼šä»£ç æŸ“è‰²ç›´è§‚éªŒè¯</h4>
<p>AIç”Ÿæˆç”¨ä¾‹åï¼Œæ€ä¹ˆç¡®è®¤æ˜¯ä¸æ˜¯çœŸçš„å…¨è¦†ç›–äº†ï¼Ÿç­”æ¡ˆæ˜¯ã€Œ<strong>ä»£ç æŸ“è‰²</strong>ã€ã€‚</p>
<p>é€šè¿‡å¯è§†åŒ–ç•Œé¢ï¼Œè¢«è¦†ç›–çš„ä»£ç ä¼šæ ‡æ³¨ä¸€ç§é¢œè‰²ï¼Œæœªè¦†ç›–çš„æ ‡æ³¨å¦ä¸€ç§é¢œè‰²ï¼Œå“ªäº›åœ°æ–¹æ²¡æµ‹åˆ°ã€å“ªäº›åœ°æ–¹å·²è¾¾æ ‡ï¼Œä¸€ç›®äº†ç„¶ã€‚ä¸ç”¨å†æ‰‹åŠ¨æ ¸å¯¹ï¼Œæ•ˆç‡ç›´æ¥æ‹‰æ»¡ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ae0dd53846d48ada8d1140a42d50cff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuq55CD5bel56iL5biI5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236084&amp;x-signature=V3AaDsMz98KkXvNjxqZwjsCQMAE%3D" alt="" loading="lazy"/></p>
<p>è¿™æ­£æ˜¯æˆ‘ä»¬â€œä»£ç +è°ƒç”¨é“¾â€åŒé©±åŠ¨æ¨¡å¼ä»·å€¼çš„ç›´è§‚ä½“ç°ã€‚é€šè¿‡è°ƒç”¨é“¾åˆ†æï¼ŒAIèƒ½å¤Ÿç²¾å‡†ç”Ÿæˆè§¦åŠæ·±å±‚é€»è¾‘çš„ç”¨ä¾‹ï¼›è€Œé€šè¿‡ä»£ç æŸ“è‰²çš„å¯è§†åŒ–éªŒè¯ï¼Œè¦†ç›–ç»“æœå˜å¾—ä¸€ç›®äº†ç„¶ã€‚è®©è´¨é‡ä¿éšœä»ç”Ÿæˆåˆ°éªŒè¯ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´ã€å¯ä¿¡çš„é—­ç¯ã€‚</p>
<h4 data-id="heading-9">3. AIç”¨ä¾‹è‡ªä¼˜åŒ–ï¼šé—­ç¯é©±åŠ¨ï¼Œå‘Šåˆ«æ‰‹åŠ¨ç»´æŠ¤</h4>
<p>è§£å†³äº†æ¼æµ‹é—®é¢˜ï¼Œå†æ¥çœ‹ç”¨ä¾‹ç»´æŠ¤éš¾çš„ç—›ç‚¹ã€‚æ ¸å¿ƒæ€è·¯æ˜¯æ­å»ºã€Œç”Ÿæˆâ†’æ‰§è¡Œâ†’åé¦ˆâ†’ä¼˜åŒ–ã€çš„é—­ç¯ï¼Œé MCPæ¨¡å‹åä½œã€äººå·¥å®¡æ ¸ã€è°ƒè¯•ç»“æœåå“ºï¼Œè®©ç”¨ä¾‹è¶Šç”¨è¶Šç²¾å‡†ï¼Œå½»åº•å‘Šåˆ«æ‰‹åŠ¨ä¿®æ”¹ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4417f7fe5c04c6db3c191d7075624f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuq55CD5bel56iL5biI5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236084&amp;x-signature=ngxyuJsQbU3Oh5yyPvcN41RJMKY%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p><strong>MCPæœåŠ¡ï¼šè´´åˆä¸šåŠ¡ï¼Œç”Ÿæˆé«˜è´¨é‡åˆå§‹ç”¨ä¾‹</strong>ã€‚åˆå§‹ç”¨ä¾‹çš„è´¨é‡å¾ˆå…³é”®ï¼Œç›´æ¥å½±å“åç»­ä¼˜åŒ–æ•ˆç‡ã€‚æˆ‘ä»¬ç»“åˆMCPæœåŠ¡ï¼Œè®©AIèƒ½ç²¾å‡†åŒ¹é…ä¸šåŠ¡åœºæ™¯ï¼Œç”Ÿæˆçš„åˆå§‹ç”¨ä¾‹ä¸ä»…è¦†ç›–å…¨é¢ï¼Œè¿˜èƒ½è´´åˆå®é™…ä¸šåŠ¡é€»è¾‘ï¼Œä¸ç”¨å†ä»é›¶å¼€å§‹æ‰“ç£¨ã€‚</p>
</li>
<li>
<p><strong>è°ƒè¯•ç»“æœåå“ºï¼šè‡ªåŠ¨ä¿®æ­£ï¼Œç”¨ä¾‹â€œè‡ªæˆ‘è¿­ä»£â€</strong>ã€‚ç”¨ä¾‹ç”Ÿæˆåä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œç³»ç»Ÿä¼šå¯¹æ¯”å®é™…æ‰§è¡Œç»“æœä¸é¢„æœŸç»“æœã€‚å¦‚æœå‡ºç°åå·®ï¼Œå°±ä¼šè‡ªåŠ¨åˆ†æåŸå› ï¼Œä¿®æ­£ç”¨ä¾‹ä¸­çš„å‚æ•°ã€æ–­è¨€ç­‰å†…å®¹â€”â€”ç›¸å½“äºç”¨ä¾‹åœ¨â€œè‡ªæˆ‘è¿­ä»£â€ï¼Œä¸ç”¨äººå·¥é€ä¸ªä¿®æ”¹ã€‚</p>
</li>
<li>
<p><strong>äººå·¥å®¡æ ¸è¿­ä»£ï¼šç²¾å‡†æ‰“ç£¨ï¼ŒæŸ¥æ¼è¡¥ç¼º</strong>ã€‚å½“ç„¶ï¼ŒAIä¼˜åŒ–ä¹Ÿéœ€è¦äººå·¥è¾…åŠ©æŠŠå…³ã€‚æˆ‘ä»¬å¯ä»¥å¯¹ç”¨ä¾‹è¿›è¡Œå®¡æ ¸æ‰“æ ‡ç­¾ï¼Œæ¯”å¦‚â€œæœ‰æ•ˆâ€â€œæ— æ•ˆâ€â€œé‡å¤â€ç­‰ã€‚è¿™äº›æ ‡ç­¾ä¼šåå“ºç»™AIï¼Œåç»­ç”Ÿæˆç”¨ä¾‹æ—¶ï¼Œå°±èƒ½é’ˆå¯¹æ€§åœ°æŸ¥æ¼è¡¥ç¼ºï¼Œè®©ç”¨ä¾‹è´¨é‡è¶Šæ¥è¶Šé«˜ã€‚</p>
</li>
</ul>
<h2 data-id="heading-10">å››ã€å°ç»“</h2>
<p>éšç€ã€ŒQAæ™ºç»˜ã€-AI Case Generation çš„æ­£å¼è½åœ°ï¼Œå åŠ æŒç»­å»ºè®¾çš„ AI TestExecã€AI Code Review èƒ½åŠ›ï¼Œå†ä¾æ‰˜é›ªå³°ç³»ç»Ÿå’Œå…¨åŸŸ AST ä»£ç è°ƒç”¨é“¾çš„åº•å±‚æŠ€æœ¯æ”¯æ’‘ï¼Œé›ªçƒ AI Quality é¡¹ç›®å·²åˆæ­¥æ­å»ºèµ·è´¨é‡åŸŸçš„æ™ºèƒ½é—­ç¯ä½“ç³»ã€‚</p>
<p>åœ¨æ ¸å¿ƒçš„æ™ºèƒ½è´¨é‡ç¯èŠ‚ï¼Œå®ç° â€œ<strong>ç”¨ä¾‹è‡ªåŠ¨ç”Ÿæˆ-æµ‹è¯•è‡ªåŠ¨æ‰§è¡Œ-ä»£ç è‡ªåŠ¨æ£€æµ‹</strong>â€ çš„å…¨æµç¨‹è‡ªåŠ¨åŒ–ï¼š</p>
<p>âœ… AI Case Generationï¼šå¯åŸºäºä¸šåŠ¡éœ€æ±‚æ™ºèƒ½æ‹†è§£æµ‹è¯•ç‚¹ï¼Œè‡ªåŠ¨ç”Ÿæˆ Feature ç”¨ä¾‹ä¸æ¥å£ç”¨ä¾‹å¹¶ç›´æ¥æ‰§è¡Œï¼›</p>
<p>âœ… AI TestExecï¼šæ‰¿æ¥ç”¨ä¾‹æ‰§è¡Œä»»åŠ¡ï¼Œå®Œæˆå›å½’æµ‹è¯•çš„è‡ªåŠ¨è°ƒåº¦ã€æ™ºèƒ½æ–­è¨€ä¸ç»“æœåˆ†æï¼›</p>
<p>âœ… AI Code Reviewï¼šä¾æ‰˜ AST è°ƒç”¨é“¾æ„ŸçŸ¥ä»£ç å˜æ›´ï¼Œè‡ªåŠ¨è¯„ä¼°å½±å“èŒƒå›´å¹¶å°†åˆ†æç»“æœç²¾å‡†æ¨é€è‡³å¯¹åº”è´Ÿè´£äººï¼›</p>
<p>è¿™ä¸€ç³»åˆ—èƒ½åŠ›çš„è”åŠ¨ï¼Œå·²æ¨åŠ¨é›ªçƒçš„è´¨é‡ä¿éšœæ¨¡å¼ä» â€œäººå·¥ä¸»å¯¼çš„é‡å¤åŠ³åŠ¨â€ å‘ â€œæ™ºèƒ½é©±åŠ¨çš„ç²¾å‡†ä¿éšœâ€ å®Œæˆäº†åˆæ­¥è½¬å‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ab5d987828a432e8f0a99a2de6c4d39~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuq55CD5bel56iL5biI5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236084&amp;x-signature=FXxiEPb7yhdwXYNdAv0MHZXzJbY%3D" alt="" loading="lazy"/></p>
<p>æœªæ¥ï¼Œé›ªçƒ AI Quality å°†å›´ç»• â€œèƒ½åŠ›æ·±åŒ–+æµç¨‹æ‰“é€š+ç”Ÿæ€ååŒâ€ ä¸‰ä¸ªæ–¹å‘æŒç»­è¿­ä»£ï¼š</p>
<p>ä¸€æ–¹é¢ï¼Œç»†åŒ–ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›çš„ç²¾åº¦ï¼Œå¤¯å®æ™ºèƒ½åŒ–åŸºç¡€ï¼›</p>
<p>å¦ä¸€æ–¹é¢ï¼Œæ‰“é€šå„æ¨¡å—æ•°æ®æµè½¬é“¾è·¯ï¼Œæ„å»º â€œä¸šåŠ¡éœ€æ±‚-æµ‹è¯•ç”¨ä¾‹-æ‰§è¡Œç»“æœ-ä»£ç é£é™©â€ çš„è”åŠ¨åé¦ˆæœºåˆ¶ â€”â€” ç”¨ä¾‹è¿­ä»£åå“ºéœ€æ±‚åˆ†æå®Œæ•´æ€§ï¼Œæ‰§è¡Œå¤±è´¥è‡ªåŠ¨å…³è”ä»£ç å˜æ›´ï¼Œä»£ç é£é™©åŒæ­¥æ›´æ–°ç”¨ä¾‹è¡¥å……æ¸…å•ï¼Œå®ç°åŒå‘é—­ç¯ï¼›</p>
<p>åŒæ—¶ï¼Œæ¨åŠ¨ä¸‰å¤§èƒ½åŠ›ä¸ç ”å‘åä½œå·¥å…·æ·±åº¦å¯¹æ¥ï¼Œèå…¥äº§ç ”å…¨æµç¨‹ï¼Œå½¢æˆ â€œæ™ºèƒ½è´¨é‡ä¿éšœ+ç ”å‘åä½œâ€ çš„ä¸€ä½“åŒ–ç”Ÿæ€ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a51df5c9281344db93c0cef9040e43dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuq55CD5bel56iL5biI5Zui6Zif:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236084&amp;x-signature=qAUTt0EMHf5xSCygaFCaXDjN%2Fac%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶åˆ°ä¸€æ­å»ºSpringCloudå¾®æœåŠ¡ï¼Œä¸€åœºä»£ç ä¸–ç•Œçš„â€œåˆ†å®¶â€å¤§æˆ]]></title>    <link>https://juejin.cn/post/7587284708947836943</link>    <guid>https://juejin.cn/post/7587284708947836943</guid>    <pubDate>2025-12-25T02:29:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587284708947836943" data-draft-id="7587277503947407360" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶åˆ°ä¸€æ­å»ºSpringCloudå¾®æœåŠ¡ï¼Œä¸€åœºä»£ç ä¸–ç•Œçš„â€œåˆ†å®¶â€å¤§æˆ"/> <meta itemprop="keywords" content="åç«¯,Java,Spring Cloud"/> <meta itemprop="datePublished" content="2025-12-25T02:29:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‚Ÿç©ºç å­—"/> <meta itemprop="url" content="https://juejin.cn/user/3139860942296830"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶åˆ°ä¸€æ­å»ºSpringCloudå¾®æœåŠ¡ï¼Œä¸€åœºä»£ç ä¸–ç•Œçš„â€œåˆ†å®¶â€å¤§æˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3139860942296830/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‚Ÿç©ºç å­—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T02:29:28.000Z" title="Thu Dec 25 2025 02:29:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å°æ‚Ÿã€‚</p>
<h2 data-id="heading-0">ç¬¬ä¸€éƒ¨åˆ†ï¼šå¾®æœåŠ¡æ˜¯ä»€ä¹ˆï¼Ÿä¸€åœºâ€œåˆ†å®¶è¿‡æ—¥å­â€çš„å“²å­¦</h2>
<p>ä½ å¼€äº†ä¸€å®¶è¶…çº§ç«çˆ†çš„â€œç¨‹åºçŒ¿é¤å…â€ï¼Œä¸€å¼€å§‹æ‰€æœ‰èœéƒ½åœ¨ä¸€ä¸ªå¤§å¨æˆ¿åšï¼š</p>
<ul>
<li><strong>å•ä½“æ¶æ„</strong>ï¼šä¸€ä¸ªå¨å­ï¼ˆæœåŠ¡å™¨ï¼‰åŒ…æ½æ‰€æœ‰èœï¼Œç‚¹å•ã€ç‚’èœã€ç…²æ±¤ã€æ´—ç¢—å…¨ç®¡</li>
<li>å®¢äººç‚¹ä¸ªè›‹ç‚’é¥­ï¼Œæ•´ä¸ªå¨æˆ¿éƒ½å¾—åŠ¨èµ·æ¥</li>
<li>æƒ³å‡çº§è›‹ç‚’é¥­é…æ–¹ï¼Ÿå¾—å…³åº—è£…ä¿®ï¼ˆåœæœºéƒ¨ç½²ï¼‰</li>
<li>å¨å­æ„Ÿå†’äº†ï¼Ÿå…¨åº—åœä¸šï¼ˆå•ç‚¹æ•…éšœï¼‰</li>
</ul>
<p><strong>å¾®æœåŠ¡å°±åƒæŠŠå¤§å¨æˆ¿æ‹†äº†</strong>ï¼š</p>
<ul>
<li>è›‹ç‚’é¥­éƒ¨ã€ç«é”…éƒ¨ã€å¥¶èŒ¶éƒ¨å„è‡ªç‹¬ç«‹</li>
<li>æ¯ä¸ªéƒ¨é—¨æœ‰è‡ªå·±çš„å°å¨æˆ¿ï¼ˆæœåŠ¡å®ä¾‹ï¼‰</li>
<li>é€šè¿‡ä¼ èœæœºå™¨äººï¼ˆæœåŠ¡é€šä¿¡ï¼‰åä½œ</li>
<li>å¥¶èŒ¶éƒ¨ç‚¸äº†ï¼Ÿæ²¡äº‹ï¼Œè›‹ç‚’é¥­ç…§å¸¸ä¾›åº”ï¼ˆæ•…éšœéš”ç¦»ï¼‰</li>
</ul>
<h2 data-id="heading-1">ç¬¬äºŒéƒ¨åˆ†ï¼šå¼€å¹²ï¼å…«æ­¥æ­å»ºSpringCloudå…¨å®¶æ¡¶</h2>
<h3 data-id="heading-2">å…ˆæ‹œç å¤´ï¼ˆç¯å¢ƒå‡†å¤‡ï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¿…å¤‡ä¸‰ä»¶å¥—</span>
Java 11+ï¼ˆåˆ«ç”¨Java 8äº†ï¼Œå®ƒéƒ½é€€ä¼‘äº†ï¼‰
Maven 3.6+ï¼ˆJavaç•Œçš„åŒ…å·¥å¤´ï¼‰
IDEï¼ˆIntelliJ IDEA - ç¨‹åºå‘˜çš„æ³•æ‹‰åˆ©ï¼‰
</code></pre>
<h3 data-id="heading-3">ç¬¬1æ­¥ï¼šåˆ›å»ºçˆ¶å·¥ç¨‹ - å®¶æ—çš„â€œæ—è°±â€</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- pom.xml - å®¶æ—æ€»ç« ç¨‹ --&gt;</span>
<span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.coder.micro<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>micro-family<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">packaging</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">packaging</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- å£°æ˜SpringCloudç‰ˆæœ¬ - å®¶æ—ç”¨çš„å®¶è§„ç‰ˆæœ¬ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">spring.cloud.version</span>&gt;</span>2021.0.3<span class="hljs-tag">&lt;/<span class="hljs-name">spring.cloud.version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">spring.boot.version</span>&gt;</span>2.7.14<span class="hljs-tag">&lt;/<span class="hljs-name">spring.boot.version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- ä¾èµ–ç®¡ç† - æ‰€æœ‰å­å­™è¯¥ç”¨ä»€ä¹ˆç‰ˆæœ¬ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${spring.cloud.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">modules</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span>eureka-server<span class="hljs-tag">&lt;/<span class="hljs-name">module</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span>gateway<span class="hljs-tag">&lt;/<span class="hljs-name">module</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span>order-service<span class="hljs-tag">&lt;/<span class="hljs-name">module</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">module</span>&gt;</span>user-service<span class="hljs-tag">&lt;/<span class="hljs-name">module</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">modules</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span>
</code></pre>
<h3 data-id="heading-4">ç¬¬2æ­¥ï¼šEurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒ - å®¶æ—çš„â€œæˆ·å£æœ¬â€</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æƒ³è±¡æˆå®¶æ—å¾®ä¿¡ç¾¤ï¼š</span>
<span class="hljs-comment"># è°åœ¨ï¼ˆæœåŠ¡ä¸Šçº¿ï¼‰@æ‰€æœ‰äºº</span>
<span class="hljs-comment"># è°ç¡äº†ï¼ˆæœåŠ¡ä¸‹çº¿ï¼‰æ”¹å¤‡æ³¨</span>
<span class="hljs-comment"># è°å¤±è”äº†ï¼ˆå¿ƒè·³æ£€æµ‹ï¼‰è¸¢å‡ºç¾¤</span>
</code></pre>

<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// EurekaServerApplication.java - æˆ·å£æœ¬ç®¡ç†å‘˜</span>
@SpringBootApplication
@EnableEurekaServer  <span class="hljs-comment">// å¼€å¯æˆ·å£æœ¬åŠŸèƒ½</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EurekaServerApplication</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> {
        SpringApplication.run(EurekaServerApplication.<span class="hljs-keyword">class</span>, args);
    }
}

<span class="hljs-comment">// application.yml - æˆ·å£æœ¬é…ç½®</span>
server:
  port: <span class="hljs-number">8761</span>  <span class="hljs-meta"># æˆ·å£æœ¬åŠå…¬å®¤é—¨ç‰Œå·</span>

eureka:
  client:
    register-<span class="hljs-keyword">with</span>-eureka: <span class="hljs-literal">false</span>  <span class="hljs-meta"># æˆ·å£æœ¬ä¸ç”¨è‡ªå·±ç™»è®°è‡ªå·±</span>
    fetch-registry: <span class="hljs-literal">false</span>  <span class="hljs-meta"># ä¸ç”¨æ‹‰å–åˆ«äººçš„ä¿¡æ¯</span>
  server:
    eviction-interval-timer-<span class="hljs-keyword">in</span>-ms: <span class="hljs-number">30000</span>  <span class="hljs-meta"># 30ç§’æ£€æŸ¥ä¸€æ¬¡è°å¤±è”äº†</span>
</code></pre>
<h3 data-id="heading-5">ç¬¬3æ­¥ï¼šAPIç½‘å…³ - å®¶æ—çš„â€œå‰å°å°å§å§â€</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">//</span> <span class="hljs-string">GatewayApplication.java</span>
<span class="hljs-string">@SpringBootApplication</span>
<span class="hljs-string">public</span> <span class="hljs-string">class</span> <span class="hljs-string">GatewayApplication</span> {
    <span class="hljs-string">public</span> <span class="hljs-string">static</span> <span class="hljs-string">void</span> <span class="hljs-string">main(String</span>[] <span class="hljs-string">args)</span> {
        <span class="hljs-string">SpringApplication.run(GatewayApplication.class</span>, <span class="hljs-string">args);</span>
    }
}

<span class="hljs-string">//</span> <span class="hljs-string">Gatewayé…ç½®</span> <span class="hljs-bullet">-</span> <span class="hljs-string">å‰å°è·¯ç”±è§„åˆ™</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">cloud:</span>
    <span class="hljs-attr">gateway:</span>
      <span class="hljs-attr">routes:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">order-service</span>  <span class="hljs-comment"># æ‰¾ç‚¹å•éƒ¨çš„è·¯</span>
          <span class="hljs-attr">uri:</span> <span class="hljs-string">lb://ORDER-SERVICE</span>  <span class="hljs-comment"># lb=è´Ÿè½½å‡è¡¡ï¼Œåƒç”µæ¢¯åˆ†æµå…¥æµ</span>
          <span class="hljs-attr">predicates:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/api/orders/**</span>  <span class="hljs-comment"># æ‰€æœ‰/orderså¼€å¤´çš„è¯·æ±‚</span>
            
        <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">user-service</span>  <span class="hljs-comment"># æ‰¾ä¼šå‘˜éƒ¨çš„è·¯</span>
          <span class="hljs-attr">uri:</span> <span class="hljs-string">lb://USER-SERVICE</span>
          <span class="hljs-attr">predicates:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/api/users/**</span>
            
        <span class="hljs-comment"># å…¨å±€è¿‡æ»¤å™¨ - å‰å°çš„å°æœ¬æœ¬</span>
      <span class="hljs-attr">default-filters:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">AddRequestHeader=X-Request-From,</span> <span class="hljs-string">gateway</span>  <span class="hljs-comment"># ç»™æ¯ä¸ªè¯·æ±‚ç›–ä¸ªç« </span>
</code></pre>
<h3 data-id="heading-6">ç¬¬4æ­¥ï¼šè®¢å•æœåŠ¡ - å®¶æ—çš„â€œç‚¹å•éƒ¨â€</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// OrderServiceApplication.java</span>
<span class="hljs-variable">@SpringBootApplication</span>
<span class="hljs-variable">@EnableEurekaClient</span>  <span class="hljs-comment">// å¤§å–Šä¸€å£°ï¼šæˆ‘ä¸Šçº¿äº†ï¼</span>
<span class="hljs-variable">@EnableFeignClients</span>  <span class="hljs-comment">// å¼€å¯â€œæ‰“ç”µè¯â€åŠŸèƒ½</span>
public class OrderServiceApplication {
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">static</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">main</span>(String[] args) {
        <span class="hljs-selector-tag">SpringApplication</span><span class="hljs-selector-class">.run</span>(OrderServiceApplication.class, args);
    }
}

<span class="hljs-comment">// OrderController.java - ç‚¹å•éƒ¨æ¥å¾…å¤„</span>
@<span class="hljs-selector-tag">RestController</span>
@<span class="hljs-selector-tag">RequestMapping</span>(<span class="hljs-string">"/orders"</span>)
@<span class="hljs-selector-tag">Slf4j</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">OrderController</span> {
    
    <span class="hljs-variable">@Autowired</span>
    private UserServiceClient userServiceClient;  <span class="hljs-comment">// ç”¨æˆ·éƒ¨çš„è”ç³»ç”µè¯</span>
    
    <span class="hljs-variable">@PostMapping</span>
    public OrderDTO <span class="hljs-built_in">createOrder</span>(<span class="hljs-variable">@RequestBody</span> OrderRequest request) {
        <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"æ¥åˆ°æ–°è®¢å•ï¼š{}"</span>, request);
        
        <span class="hljs-comment">// æ‰“ä¸ªç”µè¯é—®ç”¨æˆ·éƒ¨ï¼šè¿™äººæ˜¯ä¸æ˜¯VIPï¼Ÿ</span>
        <span class="hljs-selector-tag">UserDTO</span> <span class="hljs-selector-tag">user</span> = <span class="hljs-selector-tag">userServiceClient</span><span class="hljs-selector-class">.getUser</span>(request.<span class="hljs-built_in">getUserId</span>());
        
        <span class="hljs-selector-tag">if</span> (user.<span class="hljs-built_in">isVip</span>()) {
            <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"VIPç”¨æˆ·ï¼ŒåŠ æ€¥å¤„ç†ï¼"</span>);
            <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">processVipOrder</span>(request);
        }
        
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">processNormalOrder</span>(request);
    }
    
    <span class="hljs-comment">// å‡è£…è¿™é‡Œæœ‰å¾ˆå¤šä¸šåŠ¡é€»è¾‘...</span>
    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">OrderDTO</span> <span class="hljs-selector-tag">processVipOrder</span>(OrderRequest request) {
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">OrderDTO</span><span class="hljs-selector-class">.builder</span>()
                <span class="hljs-selector-class">.orderId</span>(UUID.<span class="hljs-built_in">randomUUID</span>().<span class="hljs-built_in">toString</span>())
                <span class="hljs-selector-class">.status</span>(<span class="hljs-string">"VIP_ä¼˜å…ˆå¤„ç†"</span>)
                <span class="hljs-selector-class">.message</span>(<span class="hljs-string">"è€æ¿ï¼Œæ‚¨çš„è®¢å•å·²æ’é˜Ÿï¼"</span>)
                <span class="hljs-selector-class">.build</span>();
    }
}
</code></pre>
<h3 data-id="heading-7">ç¬¬5æ­¥ï¼šç”¨æˆ·æœåŠ¡ - å®¶æ—çš„â€œä¼šå‘˜éƒ¨â€</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// UserController.java</span>
<span class="hljs-variable">@RestController</span>
<span class="hljs-variable">@RequestMapping</span>(<span class="hljs-string">"/users"</span>)
<span class="hljs-variable">@Slf4j</span>
public class UserController {
    
    <span class="hljs-comment">// ç”¨æˆ·éƒ¨çš„VIPåå•</span>
    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">Map</span>&lt;<span class="hljs-selector-tag">String</span>, <span class="hljs-selector-tag">UserDTO</span>&gt; <span class="hljs-selector-tag">userDatabase</span> = <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">HashMap</span>&lt;&gt;();
    
    @<span class="hljs-selector-tag">PostConstruct</span>
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">init</span>() {
        <span class="hljs-selector-tag">userDatabase</span><span class="hljs-selector-class">.put</span>(<span class="hljs-string">"1001"</span>, new <span class="hljs-built_in">UserDTO</span>(<span class="hljs-string">"1001"</span>, <span class="hljs-string">"å¼ å¤§æ¬¾"</span>, true));
        <span class="hljs-selector-tag">userDatabase</span><span class="hljs-selector-class">.put</span>(<span class="hljs-string">"1002"</span>, new <span class="hljs-built_in">UserDTO</span>(<span class="hljs-string">"1002"</span>, <span class="hljs-string">"æé“æŸ±"</span>, false));
    }
    
    @<span class="hljs-selector-tag">GetMapping</span>(<span class="hljs-string">"/{userId}"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">UserDTO</span> <span class="hljs-selector-tag">getUser</span>(<span class="hljs-variable">@PathVariable</span> String userId) {
        <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"æŸ¥è¯¢ç”¨æˆ·ï¼š{}"</span>, userId);
        
        <span class="hljs-comment">// æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ</span>
        <span class="hljs-selector-tag">try</span> {
            <span class="hljs-selector-tag">Thread</span><span class="hljs-selector-class">.sleep</span>(<span class="hljs-number">100</span>);
        } <span class="hljs-selector-tag">catch</span> (InterruptedException e) {
            <span class="hljs-selector-tag">Thread</span><span class="hljs-selector-class">.currentThread</span>()<span class="hljs-selector-class">.interrupt</span>();
        }
        
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">userDatabase</span><span class="hljs-selector-class">.getOrDefault</span>(userId, 
                new <span class="hljs-built_in">UserDTO</span>(userId, <span class="hljs-string">"æœªçŸ¥ç”¨æˆ·"</span>, false));
    }
}
</code></pre>
<h3 data-id="heading-8">ç¬¬6æ­¥ï¼šæœåŠ¡é—´é€šä¿¡ - å®¶æ—çš„â€œå†…éƒ¨ç”µè¯ç³»ç»Ÿâ€</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// UserServiceClient.java - è®¢å•éƒ¨ç”¨æ¥å‘¼å«ç”¨æˆ·éƒ¨çš„ç”µè¯</span>
<span class="hljs-variable">@FeignClient</span>(name = <span class="hljs-string">"USER-SERVICE"</span>)  <span class="hljs-comment">// å£°æ˜è¦å‘¼å«çš„æœåŠ¡å</span>
public interface UserServiceClient {
    
    <span class="hljs-variable">@GetMapping</span>(<span class="hljs-string">"/users/{userId}"</span>)  <span class="hljs-comment">// ç”µè¯å·ç å’Œæ‹¨å·æ–¹å¼</span>
    UserDTO <span class="hljs-built_in">getUser</span>(<span class="hljs-variable">@PathVariable</span> String userId);
    
    <span class="hljs-comment">// è¿™å°±æ˜¯SpringCloudçš„é­”æ³•ï¼š</span>
    <span class="hljs-comment">// çœ‹èµ·æ¥åƒæœ¬åœ°è°ƒç”¨ï¼Œå®é™…ä¸Šæ˜¯HTTPè¯·æ±‚</span>
    <span class="hljs-comment">// åƒæäº†å¾®ä¿¡è¯­éŸ³ï¼Œçœ‹ä¼¼åœ¨èº«è¾¹ï¼Œå®é™…å¯èƒ½éš”äº†ä¸ªå¤ªå¹³æ´‹</span>
}
</code></pre>
<h3 data-id="heading-9">ç¬¬7æ­¥ï¼šé…ç½®ä¸­å¿ƒ - å®¶æ—çš„â€œå…¬å‘Šæ â€</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">//</span> <span class="hljs-string">æ¯ä¸ªæœåŠ¡éƒ½è¦æœ‰è¿™ä¸ªé…ç½®</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">config:</span>
    <span class="hljs-attr">import:</span> <span class="hljs-string">optional:configserver:http://localhost:8888</span>  <span class="hljs-comment"># çœ‹å…¬å‘Šæ åœ°å€</span>
  <span class="hljs-attr">cloud:</span>
    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">fail-fast:</span> <span class="hljs-literal">false</span>  <span class="hljs-comment"># å…¬å‘Šæ åäº†ä¹Ÿä¸å½±å“è¥ä¸š</span>
      
<span class="hljs-comment"># å…¬å‘Šæ ä¸Šå†™ç€ï¼š</span>
<span class="hljs-comment"># order-service.yml:</span>
<span class="hljs-comment">#   ä¼˜æƒ æ´»åŠ¨ï¼šåŒåä¸€æ‰“äº”æŠ˜</span>
<span class="hljs-comment">#   è¶…æ—¶æ—¶é—´ï¼š30ç§’</span>
<span class="hljs-comment">#   </span>
<span class="hljs-comment"># user-service.yml:</span>
<span class="hljs-comment">#   VIPé—¨æ§›ï¼šæ¶ˆè´¹æ»¡10000</span>
<span class="hljs-comment">#   ç­¾åˆ°ç§¯åˆ†ï¼š10åˆ†/å¤©</span>
</code></pre>
<h3 data-id="heading-10">ç¬¬8æ­¥ï¼šç†”æ–­é™çº§ - å®¶æ—çš„â€œåº”æ€¥æ–¹æ¡ˆâ€</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// OrderServiceä¸­è°ƒç”¨ç”¨æˆ·æœåŠ¡æ—¶</span>
<span class="hljs-variable">@FeignClient</span>(name = <span class="hljs-string">"USER-SERVICE"</span>, 
             fallback = UserServiceFallback.class)  <span class="hljs-comment">// å¤‡èƒæ–¹æ¡ˆ</span>
public interface UserServiceClient {
    <span class="hljs-comment">// ...</span>
}

<span class="hljs-comment">// ç”¨æˆ·éƒ¨å¤±è”æ—¶çš„å¤‡èƒæ–¹æ¡ˆ</span>
<span class="hljs-variable">@Component</span>
<span class="hljs-variable">@Slf4j</span>
public class UserServiceFallback implements UserServiceClient {
    
    <span class="hljs-variable">@Override</span>
    public UserDTO <span class="hljs-built_in">getUser</span>(String userId) {
        <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.warn</span>(<span class="hljs-string">"ç”¨æˆ·æœåŠ¡å¤±è”ï¼Œå¯ç”¨é»˜è®¤ç”¨æˆ·ä¿¡æ¯"</span>);
        
        <span class="hljs-comment">// è¿”å›å…œåº•æ•°æ®ï¼Œä¿è¯è®¢å•æœåŠ¡ä¸å´©æºƒ</span>
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">UserDTO</span><span class="hljs-selector-class">.builder</span>()
                <span class="hljs-selector-class">.userId</span>(userId)
                <span class="hljs-selector-class">.username</span>(<span class="hljs-string">"é»˜è®¤ç”¨æˆ·"</span>)
                <span class="hljs-selector-class">.vip</span>(false)
                <span class="hljs-selector-class">.fromFallback</span>(true)  <span class="hljs-comment">// æ ‡è®°è¿™æ˜¯å¤‡èƒæ•°æ®</span>
                <span class="hljs-selector-class">.build</span>();
    }
}
</code></pre>
<h2 data-id="heading-11">ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¯åŠ¨å…¨å®¶æ¡¶çš„â€œå¼€æœºä»ªå¼â€</h2>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨é¡ºåºå¾ˆé‡è¦ï¼Œåƒç©å¤šç±³è¯ºéª¨ç‰Œï¼š</span>
1. å¯åŠ¨æˆ·å£æœ¬ï¼ˆEureka Serverï¼‰
   <span class="hljs-built_in">cd</span> eureka-server &amp;&amp; mvn spring-boot:run
   <span class="hljs-comment"># è®¿é—® http://localhost:8761 çœ‹è°åœ¨çº¿</span>

2. å¯åŠ¨ä¼šå‘˜éƒ¨ï¼ˆUser Serviceï¼‰
   <span class="hljs-built_in">cd</span> user-service &amp;&amp; mvn spring-boot:run
   <span class="hljs-comment"># åœ¨Eurekaé¡µé¢åº”è¯¥èƒ½çœ‹åˆ°USER-SERVICE</span>

3. å¯åŠ¨ç‚¹å•éƒ¨ï¼ˆOrder Serviceï¼‰
   <span class="hljs-built_in">cd</span> order-service &amp;&amp; mvn spring-boot:run

4. å¯åŠ¨å‰å°ï¼ˆGatewayï¼‰
   <span class="hljs-built_in">cd</span> gateway &amp;&amp; mvn spring-boot:run

<span class="hljs-comment"># æµ‹è¯•ä¸€ä¸‹ï¼š</span>
curl http://localhost:8080/api/orders \
  -X POST \
  -H <span class="hljs-string">"Content-Type: application/json"</span> \
  -d <span class="hljs-string">'{"userId": "1001", "productId": "P001"}'</span>
  
<span class="hljs-comment"># åº”è¯¥è¿”å›ï¼šVIPè®¢å•å·²æ’é˜Ÿï¼</span>
</code></pre>
<h2 data-id="heading-12">ç¬¬å››éƒ¨åˆ†ï¼šå¾®æœåŠ¡å¼€å‘çš„â€œç”Ÿå­˜æ³•åˆ™â€</h2>
<h3 data-id="heading-13">1. æœåŠ¡æ‹†åˆ†åŸåˆ™ - â€œåˆ†å®¶ä¸åˆ†å¿ƒâ€</h3>
<pre><code class="hljs language-diff" lang="diff">// å¥½çš„æ‹†åˆ†ï¼šæŒ‰ä¸šåŠ¡èƒ½åŠ›
<span class="hljs-deletion">- è®¢å•æœåŠ¡ï¼šç®¡ä¸‹å•ã€æ”¯ä»˜ã€é€€æ¬¾</span>
<span class="hljs-deletion">- åº“å­˜æœåŠ¡ï¼šç®¡å•†å“åº“å­˜</span>
<span class="hljs-deletion">- ç‰©æµæœåŠ¡ï¼šç®¡é…é€</span>

// åçš„æ‹†åˆ†ï¼šæŒ‰æŠ€æœ¯å±‚
<span class="hljs-deletion">- ControlleræœåŠ¡ï¼šåªæ”¾Controller  // åˆ«è¿™ä¹ˆå¹²ï¼</span>
<span class="hljs-deletion">- ServiceæœåŠ¡ï¼šåªæ”¾Service      // è¿™æ˜¯ç»™è‡ªå·±æŒ–å‘ï¼</span>
<span class="hljs-deletion">- DAOæœåŠ¡ï¼šåªæ”¾DAO            // ä½ ä¼šå“­çš„ï¼</span>
</code></pre>
<h3 data-id="heading-14">2. æ•°æ®åº“è®¾è®¡ - â€œå„ç®¡å„çš„è´¦â€</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- è®¢å•æœåŠ¡æœ‰è‡ªå·±çš„è®¢å•è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> orders (
    id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">PRIMARY</span> KEY,
    user_id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>),  <span class="hljs-comment">-- åªå­˜ç”¨æˆ·IDï¼Œä¸å­˜ç”¨æˆ·è¯¦æƒ…</span>
    amount <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>, <span class="hljs-number">2</span>)
    <span class="hljs-comment">-- ä¸åœ¨è¿™é‡Œåˆ›å»ºuserè¡¨çš„å¤–é”®ï¼è¿™æ˜¯å¾®æœåŠ¡å¤§å¿Œï¼</span>
);

<span class="hljs-comment">-- ç”¨æˆ·æœåŠ¡æœ‰è‡ªå·±çš„ç”¨æˆ·è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users (
    id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">PRIMARY</span> KEY,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>),
    vip_level <span class="hljs-type">INT</span>
    <span class="hljs-comment">-- ä¸çŸ¥é“è®¢å•è¡¨çš„å­˜åœ¨ï¼Œå„è¿‡å„çš„</span>
);
</code></pre>
<h3 data-id="heading-15">3. åˆ†å¸ƒå¼äº‹åŠ¡ - â€œå®¶æ—çš„ä¿¡ä»»å±æœºâ€</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä½¿ç”¨Seataå¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡</span>
<span class="hljs-meta">@GlobalTransactional</span>  <span class="hljs-comment">// åˆ†å¸ƒå¼äº‹åŠ¡æ³¨è§£</span>
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">placeOrder</span>(<span class="hljs-params">OrderRequest request</span>) {
    <span class="hljs-comment">// 1. æ‰£åº“å­˜ï¼ˆè°ƒç”¨åº“å­˜æœåŠ¡ï¼‰</span>
    inventoryService.<span class="hljs-title function_">reduceStock</span>(request.<span class="hljs-title function_">getProductId</span>());
    
    <span class="hljs-comment">// 2. åˆ›å»ºè®¢å•</span>
    orderService.<span class="hljs-title function_">createOrder</span>(request);
    
    <span class="hljs-comment">// 3. æ‰£æ¬¾ï¼ˆè°ƒç”¨æ”¯ä»˜æœåŠ¡ï¼‰</span>
    paymentService.<span class="hljs-title function_">deductBalance</span>(request.<span class="hljs-title function_">getUserId</span>());
    
    <span class="hljs-comment">// ä»»ä½•ä¸€æ­¥å¤±è´¥ï¼Œæ‰€æœ‰æ“ä½œéƒ½ä¼šå›æ»š</span>
    <span class="hljs-comment">// åƒæäº†"è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨æ’¤é”€"</span>
}
</code></pre>
<h2 data-id="heading-16">æ€»ç»“ï¼šå¾®æœåŠ¡ä¹‹è·¯çš„è‹¦ä¸ä¹</h2>
<h3 data-id="heading-17">ä½ å¾—åˆ°çš„â€œè¶…èƒ½åŠ›â€ï¼š</h3>
<ol>
<li><strong>ç‹¬ç«‹éƒ¨ç½²</strong>ï¼šæ”¹ä¸ªæŒ‰é’®é¢œè‰²ä¸ç”¨é‡å¯æ•´ä¸ªç³»ç»Ÿ</li>
<li><strong>æŠ€æœ¯å¼‚æ„</strong>ï¼šè®¢å•ç”¨Javaï¼Œæ¨èç”¨Pythonï¼Œæ•°æ®åˆ†æç”¨Go</li>
<li><strong>å¼¹æ€§ä¼¸ç¼©</strong>ï¼šåŒåä¸€ç»™è®¢å•æœåŠ¡å¤šåŠ 10å°æœºå™¨</li>
<li><strong>å®¹é”™æ€§</strong>ï¼šæ¨èæœåŠ¡æŒ‚äº†ï¼Ÿå•†å“è¯¦æƒ…é¡µç…§æ ·èƒ½æ‰“å¼€</li>
</ol>
<h3 data-id="heading-18">ä½ é¢ä¸´çš„â€œæŒ‘æˆ˜â€ï¼š</h3>
<ol>
<li><strong>åˆ†å¸ƒå¼debug</strong>ï¼šæ‰¾bugåƒä¾¦æ¢ç ´æ¡ˆï¼Œçº¿ç´¢åˆ†å¸ƒåœ¨5ä¸ªæœåŠ¡é‡Œ</li>
<li><strong>ç½‘ç»œå»¶è¿Ÿ</strong>ï¼šæœ¬åœ°æ–¹æ³•è°ƒç”¨1msï¼ŒæœåŠ¡é—´è°ƒç”¨å¯èƒ½100ms</li>
<li><strong>æ•°æ®ä¸€è‡´æ€§</strong>ï¼šç”¨æˆ·ä½™é¢å‡å°‘äº†ï¼Œè®¢å•å´æ²¡åˆ›å»ºæˆåŠŸï¼Ÿ</li>
<li><strong>è¿ç»´å¤æ‚åº¦</strong>ï¼šåŸæ¥ç®¡1ä¸ªåº”ç”¨ï¼Œç°åœ¨è¦ç®¡20ä¸ªæœåŠ¡</li>
</ol>
<h3 data-id="heading-19">æœ€åï¼š</h3>
<p><strong>å¾®æœåŠ¡ä¸æ˜¯é“¶å¼¹ï¼Œæ˜¯é“¶åˆ¶é¤å…·</strong>ï¼š</p>
<ul>
<li>é€‚åˆå¤§å‹å›¢é˜Ÿï¼ˆå„è‡ªåšé¥­ä¸æ‰“æ¶ï¼‰</li>
<li>é€‚åˆå¿«é€Ÿè¿­ä»£ï¼ˆå„éƒ¨åˆ†ç‹¬ç«‹å‡çº§ï¼‰</li>
<li>é€‚åˆå¤æ‚ç³»ç»Ÿï¼ˆåˆ†è€Œæ²»ä¹‹ï¼‰</li>
</ul>
<p><strong>ä½†å¦‚æœä½ åªæ˜¯å¼€ä¸ªç…é¥¼æ‘Š</strong>ï¼š</p>
<ul>
<li>ä¸€ä¸ªå¹³é”…ï¼ˆå•ä½“åº”ç”¨ï¼‰å¤Ÿäº†</li>
<li>éè¦æ5ä¸ªå°ç¶ï¼ˆå¾®æœåŠ¡ï¼‰ï¼Ÿ</li>
<li>å…‰åè°ƒå“ªä¸ªæ‘Šé¸¡è›‹å“ªä¸ªæ’’è‘±èŠ±å°±å¤Ÿä½ å—çš„</li>
</ul>
<p>å¾®æœåŠ¡è§£å†³çš„æ˜¯"äºº"çš„é—®é¢˜ï¼Œä¸æ˜¯"æŠ€æœ¯"çš„é—®é¢˜ã€‚å½“å›¢é˜Ÿå¤§åˆ°éœ€è¦åˆ†å±±å¤´ã€ä¸šåŠ¡å¤æ‚åˆ°éœ€è¦åˆ†é¢†åŸŸæ—¶ï¼Œæ‰æ˜¯å¾®æœåŠ¡ç™»åœºçš„æœ€ä½³æ—¶æœºã€‚å¦åˆ™ï¼Œä½ å°±æ˜¯ç”¨å¯¼å¼¹æ‰“èšŠå­â€”â€”æ•ˆæœéœ‡æ’¼ï¼Œä½†çœŸçš„æ²¡å¿…è¦ï¼</p>
<hr/>
<p><strong>ä»£ç ä¸–ç•Œçš„çœŸç†</strong>ï¼šæ²¡æœ‰æœ€å¥½çš„æ¶æ„ï¼Œåªæœ‰æœ€åˆé€‚çš„æ¶æ„ã€‚å¾®æœåŠ¡ä¸æ˜¯ç»ˆç‚¹ï¼Œè€Œæ˜¯ä½ æ¶æ„æ¼”åŒ–è·¯ä¸Šçš„ä¸€ä¸ªé‡Œç¨‹ç¢‘ã€‚åˆ›å»ºç¬¬ä¸€ä¸ªå¾®æœåŠ¡ï¼Œè®°å¾—å…ˆä»å°å¤„ç€æ‰‹ï¼Œæ¯•ç«Ÿï¼Œç½—é©¬ä¸æ˜¯ä¸€å¤©å»ºæˆçš„ï¼Œå¾®æœåŠ¡ä¹Ÿä¸æ˜¯ä¸€æ¬¡æ‹†å®Œçš„ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6065e0ef4a9e42c48fe5059493d93033~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf56m656CB5a2X:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767234567&amp;x-signature=zS2YVnvWQ9AiA4NqwqItPsqJD9Y%3D" alt="ä»é›¶åˆ°ä¸€æ­å»ºSpringCloudå¾®æœåŠ¡ï¼Œä¸€åœºä»£ç ä¸–ç•Œçš„â€œåˆ†å®¶â€å¤§æˆ.png" loading="lazy"/></p>
<p><strong>è°¢è°¢ä½ çœ‹æˆ‘çš„æ–‡ç« ï¼Œæ—¢ç„¶çœ‹åˆ°è¿™é‡Œäº†ï¼Œå¦‚æœè§‰å¾—ä¸é”™ï¼Œéšæ‰‹ç‚¹ä¸ªèµã€è½¬å‘ã€åœ¨çœ‹ä¸‰è¿å§ï¼Œæ„Ÿè°¢æ„Ÿè°¢ã€‚é‚£æˆ‘ä»¬ï¼Œä¸‹æ¬¡å†è§ã€‚</strong></p>
<p>æ‚¨çš„ä¸€é”®ä¸‰è¿ï¼Œæ˜¯æˆ‘æ›´æ–°çš„æœ€å¤§åŠ¨åŠ›ï¼Œè°¢è°¢</p>
<p>å±±æ°´æœ‰ç›¸é€¢ï¼Œæ¥æ—¥çš†å¯æœŸï¼Œè°¢è°¢é˜…è¯»ï¼Œæˆ‘ä»¬å†ä¼š</p>
<p>æˆ‘æ‰‹ä¸­çš„é‡‘ç®æ£’ï¼Œä¸Šèƒ½é€šå¤©ï¼Œä¸‹èƒ½æ¢æµ·</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä» 0 æ­å»º React å¾…åŠåº”ç”¨ï¼šçŠ¶æ€ç®¡ç†ã€å‰¯ä½œç”¨ä¸åŒå‘ç»‘å®šæ¨¡æ‹Ÿ]]></title>    <link>https://juejin.cn/post/7587265840066183174</link>    <guid>https://juejin.cn/post/7587265840066183174</guid>    <pubDate>2025-12-24T16:01:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587265840066183174" data-draft-id="7587265840066084870" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä» 0 æ­å»º React å¾…åŠåº”ç”¨ï¼šçŠ¶æ€ç®¡ç†ã€å‰¯ä½œç”¨ä¸åŒå‘ç»‘å®šæ¨¡æ‹Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,React.js,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-24T16:01:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="T___T"/> <meta itemprop="url" content="https://juejin.cn/user/1599155645973066"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä» 0 æ­å»º React å¾…åŠåº”ç”¨ï¼šçŠ¶æ€ç®¡ç†ã€å‰¯ä½œç”¨ä¸åŒå‘ç»‘å®šæ¨¡æ‹Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1599155645973066/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    T___T
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T16:01:02.000Z" title="Wed Dec 24 2025 16:01:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>React ä½œä¸ºå‰ç«¯ä¸»æµæ¡†æ¶ï¼Œå…¶<code>å•å‘æ•°æ®æµ</code> <code>ç»„ä»¶åŒ–</code> <code>çŠ¶æ€é©±åŠ¨è§†å›¾</code>çš„è®¾è®¡ç†å¿µï¼Œçœ‹ä¼¼æŠ½è±¡å´èƒ½é€šè¿‡ä¸€ä¸ªç®€å•çš„ TodoList æ¡ˆä¾‹å½»åº•åƒé€ã€‚æœ¬æ–‡ä¸åªæ˜¯ â€œè§£é‡Šä»£ç â€ï¼Œè€Œæ˜¯ä»<strong>è®¾è®¡åˆè¡·ã€åº•å±‚é€»è¾‘ã€å®é™…ä»·å€¼</strong>ä¸‰ä¸ªç»´åº¦ï¼Œæ‹†è§£Â <code>useState</code>Â <code>useEffect</code>ã€å—æ§ç»„ä»¶æ¨¡æ‹ŸåŒå‘ç»‘å®šã€çˆ¶å­é€šä¿¡ç­‰æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œè®©ä½ ä¸ä»… â€œä¼šç”¨â€ï¼Œæ›´ â€œæ‡‚ä¸ºä»€ä¹ˆè¿™ä¹ˆç”¨â€ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€æ¡ˆä¾‹æ•´ä½“æ¶æ„ï¼šå…ˆæ‡‚ â€œæ‹†åˆ†é€»è¾‘â€ï¼Œå†çœ‹ â€œä»£ç ç»†èŠ‚â€</h2>
<p>åœ¨åŠ¨æ‰‹å†™ä»£ç å‰ï¼ŒReact å¼€å‘çš„ç¬¬ä¸€æ­¥æ˜¯<code>ç»„ä»¶æ‹†åˆ†</code>â€”â€” éµå¾ªå•ä¸€èŒè´£åŸåˆ™ï¼ŒæŠŠå¤æ‚é¡µé¢æ‹†æˆç‹¬ç«‹ã€å¯å¤ç”¨çš„å°ç»„ä»¶ï¼Œè¿™æ˜¯ React ç»„ä»¶åŒ–æ€æƒ³çš„æ ¸å¿ƒã€‚</p>
<p>æœ¬æ¬¡ TodoList çš„ç»„ä»¶æ‹†åˆ†å¦‚ä¸‹ï¼š</p>






























<table><thead><tr><th>ç»„ä»¶å</th><th>æ ¸å¿ƒèŒè´£</th><th>æ ¸å¿ƒäº¤äº’</th></tr></thead><tbody><tr><td>Appï¼ˆæ ¹ç»„ä»¶ï¼‰</td><td>å…¨å±€çŠ¶æ€ç®¡ç† + æ ¸å¿ƒé€»è¾‘å°è£…</td><td>å®šä¹‰æ–°å¢ / åˆ é™¤ / åˆ‡æ¢å¾…åŠã€æ•°æ®æŒä¹…åŒ–ç­‰æ–¹æ³•</td></tr><tr><td>TodoInput</td><td>å¾…åŠè¾“å…¥ + æäº¤</td><td>æ”¶é›†ç”¨æˆ·è¾“å…¥ï¼Œè§¦å‘ â€œæ–°å¢å¾…åŠâ€ é€»è¾‘</td></tr><tr><td>TodoList</td><td>å¾…åŠåˆ—è¡¨æ¸²æŸ“</td><td>å±•ç¤ºå¾…åŠé¡¹ï¼Œè½¬å‘ â€œåˆ é™¤ / åˆ‡æ¢å®ŒæˆçŠ¶æ€â€ äº‹ä»¶</td></tr><tr><td>TodoStats</td><td>å¾…åŠæ•°æ®ç»Ÿè®¡</td><td>å±•ç¤ºæ€»æ•° / å·²å®Œæˆ / æœªå®Œæˆæ•°ï¼Œè§¦å‘ â€œæ¸…é™¤å·²å®Œæˆâ€ é€»è¾‘</td></tr></tbody></table>
<p>è¿™ç§æ‹†åˆ†çš„æ ¸å¿ƒä»·å€¼ï¼š<strong>æ¯ä¸ªç»„ä»¶åªåšä¸€ä»¶äº‹ï¼Œä¾¿äºç»´æŠ¤ã€å¤ç”¨å’Œè°ƒè¯•</strong>ï¼ˆæ¯”å¦‚åç»­æƒ³æ”¹è¾“å…¥æ¡†æ ·å¼ï¼ŒåªåŠ¨ TodoInput å³å¯ï¼Œä¸å½±å“åˆ—è¡¨å’Œç»Ÿè®¡é€»è¾‘ï¼‰ã€‚</p>
<h2 data-id="heading-1">äºŒã€æ ¸å¿ƒ API æ·±åº¦æ‹†è§£ï¼šä¸æ­¢ â€œä¼šç”¨â€ï¼Œæ›´æ‡‚ â€œä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡â€</h2>
<h3 data-id="heading-2">1. useStateï¼šReact çŠ¶æ€ç®¡ç†çš„ â€œçµé­‚â€</h3>
<p>React ä¸­æ‰€æœ‰<strong>å¯å˜æ•°æ®</strong>éƒ½å¿…é¡»é€šè¿‡**çŠ¶æ€ï¼ˆStateï¼‰**ç®¡ç†ï¼Œè€ŒÂ <code>useState</code>Â æ˜¯æœ€åŸºç¡€ã€æœ€æ ¸å¿ƒçš„çŠ¶æ€é’©å­ â€”â€” å®ƒè§£å†³äº† â€œå‡½æ•°ç»„ä»¶æ— æ³•æ‹¥æœ‰è‡ªèº«çŠ¶æ€â€ çš„é—®é¢˜ï¼Œä¹Ÿæ˜¯ â€œçŠ¶æ€é©±åŠ¨è§†å›¾â€ çš„æ ¸å¿ƒè½½ä½“ã€‚</p>
<h4 data-id="heading-3">ï¼ˆ1ï¼‰åŸºç¡€åŸç†ï¼šä¸ºä»€ä¹ˆéœ€è¦ useStateï¼Ÿ</h4>
<p>çº¯å‡½æ•°ç»„ä»¶æœ¬èº«æ˜¯ â€œæ— çŠ¶æ€â€ çš„ï¼ˆæ‰§è¡Œå®Œå°±é”€æ¯ï¼Œæ— æ³•ä¿å­˜æ•°æ®ï¼‰ï¼Œè€Œç”¨æˆ·äº¤äº’ï¼ˆæ¯”å¦‚è¾“å…¥å¾…åŠã€åˆ‡æ¢å®ŒæˆçŠ¶æ€ï¼‰å¿…ç„¶éœ€è¦ â€œä¿å­˜å¯å˜æ•°æ®â€ã€‚<code>useState</code>Â æœ¬è´¨æ˜¯ç»™å‡½æ•°ç»„ä»¶æä¾›äº†æŒä¹…åŒ–çš„çŠ¶æ€å­˜å‚¨ç©ºé—´ï¼Œä¸”è¿™ä¸ªå­˜å‚¨ç©ºé—´å’Œç»„ä»¶æ¸²æŸ“å‘¨æœŸç»‘å®šï¼š</p>
<ul>
<li>çŠ¶æ€æ›´æ–° â†’ ç»„ä»¶é‡æ–°æ¸²æŸ“ â†’ è§†å›¾åŒæ­¥æ›´æ–°ï¼›</li>
<li>çŠ¶æ€ä¸æ›´æ–° â†’ ç»„ä»¶ä¸ä¼šé‡å¤æ¸²æŸ“ï¼Œä¿è¯æ€§èƒ½ã€‚</li>
</ul>
<h4 data-id="heading-4">ï¼ˆ2ï¼‰ä¸¤ç§åˆå§‹åŒ–æ–¹å¼ï¼šæ™®é€šåˆå§‹åŒ– vs æƒ°æ€§åˆå§‹åŒ–</h4>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// æ–¹å¼1ï¼šæ™®é€šåˆå§‹åŒ–ï¼ˆé€‚åˆç®€å•ã€æ— è®¡ç®—çš„åˆå§‹å€¼ï¼‰</span>
<span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);

<span class="hljs-comment">// æ–¹å¼2ï¼šæƒ°æ€§åˆå§‹åŒ–ï¼ˆé‡ç‚¹ï¼ TodoList ä¸­ç”¨çš„å°±æ˜¯è¿™ç§ï¼‰</span>
<span class="hljs-keyword">const</span> [todos, setTodos] = <span class="hljs-title function_">useState</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> saved = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'todos'</span>);
  <span class="hljs-keyword">return</span> saved ? <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(saved) : [];
});
</code></pre>
<p><strong>å…³é”®åŒºåˆ«ä¸è®¾è®¡åˆè¡·</strong>ï¼š</p>
<ul>
<li>æ™®é€šåˆå§‹åŒ–ï¼š<code>useState(åˆå§‹å€¼)</code>Â ä¸­ï¼Œåˆå§‹å€¼è¡¨è¾¾å¼ä¼šåœ¨<strong>ç»„ä»¶æ¯æ¬¡æ¸²æŸ“</strong>æ—¶éƒ½æ‰§è¡Œï¼ˆå“ªæ€•çŠ¶æ€æ²¡å˜åŒ–ï¼‰ï¼›</li>
<li>æƒ°æ€§åˆå§‹åŒ–ï¼š<code>useState(() =&gt; { ... })</code>Â ä¸­ï¼Œä¼ å…¥çš„å‡½æ•°ä»…åœ¨**ç»„ä»¶é¦–æ¬¡æ¸²æŸ“*æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œåç»­æ¸²æŸ“ä¸ä¼šå†è·‘ã€‚</li>
</ul>
<p>TodoList ä¸­ç”¨æƒ°æ€§åˆå§‹åŒ–çš„æ ¸å¿ƒåŸå› ï¼š<code>localStorage.getItem('todos')</code>Â æ˜¯æµè§ˆå™¨æœ¬åœ°è¯»å–æ“ä½œï¼Œè™½ç„¶å¼€é”€å°ï¼Œä½†å¦‚æœæ”¾åœ¨æ™®é€šåˆå§‹åŒ–é‡Œï¼Œæ¯æ¬¡ç»„ä»¶æ¸²æŸ“ï¼ˆæ¯”å¦‚æ–°å¢ / åˆ é™¤å¾…åŠï¼‰éƒ½ä¼šé‡å¤è¯»å–æœ¬åœ°å­˜å‚¨ï¼Œå®Œå…¨æ²¡å¿…è¦ï¼›è€Œæƒ°æ€§åˆå§‹åŒ–åªæ‰§è¡Œä¸€æ¬¡ï¼Œæ—¢æ‹¿åˆ°äº†åˆå§‹æ•°æ®ï¼Œåˆé¿å…äº†æ€§èƒ½æµªè´¹ â€”â€” è¿™æ˜¯ React æ€§èƒ½ä¼˜åŒ–çš„ â€œå°ç»†èŠ‚â€ï¼Œä¹Ÿæ˜¯ç†è§£Â <code>useState</code>Â è®¾è®¡çš„å…³é”®ã€‚</p>
<h4 data-id="heading-5">ï¼ˆ3ï¼‰çŠ¶æ€æ›´æ–°çš„ â€œä¸å¯å˜åŸåˆ™â€ï¼šä¸ºä»€ä¹ˆå¿…é¡»è¿”å›æ–°å€¼ï¼Ÿ</h4>
<p>React è§„å®šï¼š<strong>çŠ¶æ€æ˜¯åªè¯»çš„ï¼Œä¿®æ”¹çŠ¶æ€å¿…é¡»è¿”å›æ–°å€¼ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹åŸçŠ¶æ€</strong>ã€‚æ¯”å¦‚è¿™é‡Œçš„ â€œæ–°å¢å¾…åŠâ€ é€»è¾‘ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title function_">addTodo</span> = (<span class="hljs-params">text</span>) =&gt; {
  <span class="hljs-comment">// é”™è¯¯å†™æ³•ï¼šç›´æ¥ä¿®æ”¹åŸæ•°ç»„ï¼ˆReact æ— æ³•æ£€æµ‹åˆ°çŠ¶æ€å˜åŒ–ï¼Œè§†å›¾ä¸æ›´æ–°ï¼‰</span>
  <span class="hljs-comment">// todos.push({ id: Date.now(), text, completed: false });</span>
  <span class="hljs-comment">// setTodos(todos);</span>

  <span class="hljs-comment">// æ­£ç¡®å†™æ³•ï¼šè§£æ„åŸæ•°ç»„ + æ–°å¢é¡¹ï¼Œè¿”å›æ–°æ•°ç»„</span>
  <span class="hljs-title function_">setTodos</span>([...todos, {
    <span class="hljs-attr">id</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
    text,
    <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>
  }]);
};
</code></pre>
<p><strong>åº•å±‚é€»è¾‘</strong>ï¼šReact åˆ¤æ–­çŠ¶æ€æ˜¯å¦å˜åŒ–çš„ä¾æ®æ˜¯<strong>å¼•ç”¨æ˜¯å¦æ”¹å˜</strong>ã€‚æ•°ç»„ / å¯¹è±¡æ˜¯å¼•ç”¨ç±»å‹ï¼Œç›´æ¥ä¿®æ”¹åŸæ•°ç»„ï¼ˆ<code>todos.push</code>ï¼‰ï¼Œæ•°ç»„çš„å¼•ç”¨æ²¡å˜åŒ–ï¼ŒReact ä¼šè®¤ä¸º â€œçŠ¶æ€æ²¡æ”¹â€ï¼Œå› æ­¤ä¸ä¼šè§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼›è€Œé€šè¿‡Â <code>[...todos]</code>Â è§£æ„ç”Ÿæˆæ–°æ•°ç»„ï¼Œå¼•ç”¨å˜äº†ï¼ŒReact æ‰èƒ½æ£€æµ‹åˆ°çŠ¶æ€å˜åŒ–ï¼Œè¿›è€Œæ›´æ–°è§†å›¾ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ React â€œå•å‘æ•°æ®æµâ€ çš„æ ¸å¿ƒä½“ç°ï¼šçŠ¶æ€æ›´æ–°æ˜¯ â€œä¸å¯å˜â€ çš„ï¼Œæ¯ä¸€æ¬¡çŠ¶æ€å˜åŒ–éƒ½ä¼šç”Ÿæˆæ–°å€¼ï¼Œä¾¿äºè¿½è¸ªæ•°æ®æµè½¬ï¼ˆæ¯”å¦‚è°ƒè¯•æ—¶èƒ½æ¸…æ™°çœ‹åˆ°æ¯æ¬¡çŠ¶æ€æ›´æ–°çš„å‰åå€¼ï¼‰ã€‚</p>
<h3 data-id="heading-6">2. useEffectï¼šå‰¯ä½œç”¨å¤„ç†çš„ â€œä¸“å±ç®¡å®¶â€</h3>
<p>React ç»„ä»¶çš„æ ¸å¿ƒèŒè´£æ˜¯<strong>æ ¹æ®çŠ¶æ€æ¸²æŸ“è§†å›¾</strong>ï¼Œè€Œåƒ â€œè¯»å–æœ¬åœ°å­˜å‚¨ã€å‘é€ç½‘ç»œè¯·æ±‚ã€ç»‘å®šäº‹ä»¶ç›‘å¬ã€ä¿®æ”¹ DOMâ€ è¿™ç±»ä¸ç›´æ¥å‚ä¸æ¸²æŸ“ï¼Œä½†åˆå¿…é¡»æ‰§è¡Œçš„æ“ä½œï¼Œç»Ÿç§°ä¸º â€œå‰¯ä½œç”¨ï¼ˆSide Effectï¼‰â€ã€‚<code>useEffect</code>Â æ˜¯ React ä¸“é—¨ä¸ºå¤„ç†å‰¯ä½œç”¨è®¾è®¡çš„é’©å­ï¼Œæ›¿ä»£äº†ç±»ç»„ä»¶ä¸­Â <code>componentDidMount</code>Â <code>componentDidUpdate</code>Â <code>componentWillUnmount</code>Â ç­‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œä¸”é€»è¾‘æ›´é›†ä¸­ã€‚</p>
<h4 data-id="heading-7">ï¼ˆ1ï¼‰æ ¸å¿ƒè¯­æ³•ä¸æ‰§è¡Œæœºåˆ¶</h4>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// å‰¯ä½œç”¨é€»è¾‘ï¼šæ¯”å¦‚ä¿å­˜æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨</span>
  <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'todos'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(todos));

  <span class="hljs-comment">// å¯é€‰çš„æ¸…ç†å‡½æ•°ï¼ˆæ¯”å¦‚å–æ¶ˆäº‹ä»¶ç›‘å¬ã€æ¸…é™¤å®šæ—¶å™¨ï¼‰</span>
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// ç»„ä»¶å¸è½½/ä¾èµ–å˜åŒ–å‰æ‰§è¡Œ</span>
  };
}, [todos]); <span class="hljs-comment">// ä¾èµ–æ•°ç»„ï¼šå†³å®šå‰¯ä½œç”¨çš„æ‰§è¡Œæ—¶æœº</span>
</code></pre>
<p><strong>æ‰§è¡Œæ—¶æœºçš„æ·±åº¦è§£æ</strong>ï¼š</p>
<ul>
<li>ä¾èµ–æ•°ç»„ä¸ºç©ºÂ <code>[]</code>ï¼šä»…åœ¨ç»„ä»¶<strong>é¦–æ¬¡æ¸²æŸ“å®Œæˆå</strong>æ‰§è¡Œä¸€æ¬¡ï¼ˆå¯¹åº”ç±»ç»„ä»¶Â <code>componentDidMount</code>ï¼‰ï¼›</li>
<li>ä¾èµ–æ•°ç»„æœ‰å€¼Â <code>[todos]</code>ï¼šç»„ä»¶é¦–æ¬¡æ¸²æŸ“æ‰§è¡Œ + æ¯æ¬¡ä¾èµ–é¡¹ï¼ˆtodosï¼‰å˜åŒ–åæ‰§è¡Œï¼ˆå¯¹åº”Â <code>componentDidMount + componentDidUpdate</code>ï¼‰ï¼›</li>
<li>æ— ä¾èµ–æ•°ç»„ï¼šç»„ä»¶<strong>æ¯æ¬¡æ¸²æŸ“å®Œæˆå</strong>éƒ½æ‰§è¡Œï¼ˆæå°‘ç”¨ï¼Œæ˜“å¯¼è‡´æ€§èƒ½é—®é¢˜ï¼‰ï¼›</li>
<li>æ¸…ç†å‡½æ•°ï¼šç»„ä»¶å¸è½½å‰ / ä¸‹ä¸€æ¬¡å‰¯ä½œç”¨æ‰§è¡Œå‰è§¦å‘ï¼ˆæ¯”å¦‚ç›‘å¬çª—å£å¤§å°å˜åŒ–åï¼Œå¸è½½ç»„ä»¶æ—¶è¦å–æ¶ˆç›‘å¬ï¼Œé¿å…å†…å­˜æ³„æ¼ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-8">ï¼ˆ2ï¼‰åœ¨ TodoList ä¸­çš„æ ¸å¿ƒåº”ç”¨ï¼šæ•°æ®æŒä¹…åŒ–</h4>
<p>ä»£ç ä¸­ï¼Œ<code>useEffect</code>Â ç”¨æ¥å°† todos åŒæ­¥åˆ° localStorageï¼Œè¿™æ˜¯å‰ç«¯ â€œæ•°æ®æŒä¹…åŒ–â€ çš„ç»å…¸åœºæ™¯ï¼Œæˆ‘ä»¬æ‹†è§£å…¶ä»·å€¼ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'todos'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(todos));
}, [todos]);
</code></pre>
<ul>
<li><strong>ä¸ºä»€ä¹ˆ localStorage åªèƒ½å­˜å­—ç¬¦ä¸²ï¼Ÿ</strong> localStorage æ˜¯æµè§ˆå™¨æä¾›çš„æœ¬åœ°å­˜å‚¨ APIï¼Œå…¶åº•å±‚è®¾è®¡åªæ”¯æŒ<strong>å­—ç¬¦ä¸²é”®å€¼å¯¹</strong>å­˜å‚¨ï¼Œå› æ­¤å­˜å‚¨æ•°ç»„ / å¯¹è±¡æ—¶ï¼Œå¿…é¡»ç”¨Â <code>JSON.stringify</code>Â è½¬ä¸ºå­—ç¬¦ä¸²ï¼›è¯»å–æ—¶ç”¨Â <code>JSON.parse</code>Â è½¬å›åŸæ•°æ®ç±»å‹ï¼Œè¿™æ˜¯å‰ç«¯æœ¬åœ°å­˜å‚¨çš„é€šç”¨è§„åˆ™ã€‚</li>
</ul>
<h4 data-id="heading-9">ï¼ˆ3ï¼‰useEffect åœ¨è¿™é‡Œçš„æ ¸å¿ƒä»·å€¼ï¼ˆä¸ºä»€ä¹ˆéå®ƒä¸å¯ï¼‰</h4>
<h5 data-id="heading-10">1. ç²¾å‡†è§¦å‘ï¼šåªåœ¨éœ€è¦æ—¶æ‰§è¡Œï¼Œä¿è¯æ€§èƒ½</h5>
<p><code>useEffect</code>Â çš„ç¬¬äºŒä¸ªå‚æ•°ï¼ˆä¾èµ–æ•°ç»„Â <code>[todos]</code>ï¼‰æ˜¯å…³é”®ï¼š</p>
<ul>
<li>ç»„ä»¶é¦–æ¬¡æ¸²æŸ“æ—¶ï¼Œæ‰§è¡Œä¸€æ¬¡ï¼ˆæŠŠåˆå§‹çš„Â <code>todos</code>Â ä¿å­˜åˆ°æœ¬åœ°ï¼‰ï¼›</li>
<li>åªæœ‰Â <code>todos</code>Â å‘ç”Ÿ<strong>å®é™…å˜åŒ–</strong>æ—¶ï¼Œæ‰ä¼šå†æ¬¡æ‰§è¡Œï¼ˆæ–°å¢ / åˆ é™¤ / åˆ‡æ¢çŠ¶æ€ / æ¸…é™¤å·²å®Œæˆï¼Œåªè¦Â <code>todos</code>Â å˜äº†ï¼Œå°±åŒæ­¥ä¿å­˜ï¼‰ï¼›</li>
<li><code>todos</code>Â æ²¡å˜åŒ–æ—¶ï¼ˆæ¯”å¦‚ç»„ä»¶å› å…¶ä»–çŠ¶æ€é‡æ–°æ¸²æŸ“ï¼‰ï¼Œå®Œå…¨ä¸æ‰§è¡Œï¼Œé¿å…æ— æ•ˆæ“ä½œã€‚</li>
</ul>
<p>å¯¹æ¯” â€œå†™åœ¨ç»„ä»¶é¡¶å±‚â€ çš„æ— å·®åˆ«æ‰§è¡Œï¼Œ<code>useEffect</code>Â å®ç°äº† â€œæŒ‰éœ€æ‰§è¡Œâ€ï¼Œæ—¢ä¿è¯æ•°æ®åŒæ­¥ï¼Œåˆä¸æµªè´¹æ€§èƒ½ã€‚</p>
<h5 data-id="heading-11">2. æ—¶æœºæ­£ç¡®ï¼šæ‹¿åˆ°æœ€æ–°çš„çŠ¶æ€ï¼Œé¿å…æ•°æ®ä¸ä¸€è‡´</h5>
<p><code>useEffect</code>Â çš„æ‰§è¡Œæ—¶æœºæ˜¯ã€Œç»„ä»¶æ¸²æŸ“å®Œæˆåã€â€”â€” ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“Â <code>useEffect</code>Â é‡Œçš„ä»£ç æ‰§è¡Œæ—¶ï¼Œ<code>setTodos</code>Â å·²ç»å®Œæˆäº†çŠ¶æ€æ›´æ–°ï¼Œ<code>todos</code>Â ä¸€å®šæ˜¯æœ€æ–°çš„ã€‚</p>
<p>æ¯”å¦‚æ–°å¢å¾…åŠæ—¶ï¼š</p>
<ol>
<li>è°ƒç”¨Â <code>addTodo</code>Â â†’ æ‰§è¡ŒÂ <code>setTodos</code>Â â†’ ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼ˆ<code>todos</code>Â å˜ä¸ºæ–°å€¼ï¼‰ï¼›</li>
<li>æ¸²æŸ“å®Œæˆåï¼Œ<code>useEffect</code>Â æ£€æµ‹åˆ°Â <code>todos</code>Â å˜åŒ– â†’ æ‰§è¡Œä¿å­˜é€»è¾‘ â†’ æ‹¿åˆ°çš„æ˜¯æœ€æ–°çš„Â <code>todos</code>ã€‚</li>
</ol>
<p>è¿™å°±é¿å…äº† â€œå¼‚æ­¥æ›´æ–°å¯¼è‡´ä¿å­˜æ—§å€¼â€ çš„é—®é¢˜ï¼Œä¿è¯æœ¬åœ°å­˜å‚¨çš„æ•°æ®å’Œç»„ä»¶çŠ¶æ€å®Œå…¨ä¸€è‡´ã€‚</p>
<h5 data-id="heading-12">3. é€»è¾‘èšåˆï¼šä¸€å¤„ç›‘å¬ï¼Œå…¨åœºæ™¯ç”Ÿæ•ˆ</h5>
<p>ä¸ç®¡æ˜¯æ–°å¢ã€åˆ é™¤ã€åˆ‡æ¢çŠ¶æ€ã€æ¸…é™¤å·²å®Œæˆï¼Œåªè¦æœ€ç»ˆå¯¼è‡´Â <code>todos</code>Â å˜åŒ–ï¼Œ<code>useEffect</code>Â éƒ½ä¼šè‡ªåŠ¨è§¦å‘ä¿å­˜ â€”â€” æ— éœ€åœ¨æ¯ä¸ªä¿®æ”¹Â <code>todos</code>Â çš„å‡½æ•°é‡Œé‡å¤å†™ä¿å­˜é€»è¾‘ï¼Œä»£ç ç®€æ´ã€æ˜“ç»´æŠ¤ï¼Œåç»­æ–°å¢ä¿®æ”¹Â <code>todos</code>Â çš„é€»è¾‘ï¼ˆæ¯”å¦‚æ‰¹é‡ä¿®æ”¹ï¼‰ï¼Œå®Œå…¨ä¸ç”¨åŠ¨ä¿å­˜ä»£ç ï¼Œå¤©ç„¶ç¬¦åˆ â€œå¼€é—­åŸåˆ™â€ã€‚</p>
<h4 data-id="heading-13">ï¼ˆ4ï¼‰useEffect çš„è®¾è®¡ä»·å€¼ï¼šåˆ†ç¦» â€œæ¸²æŸ“é€»è¾‘â€ ä¸ â€œå‰¯ä½œç”¨é€»è¾‘â€</h4>
<p>React è¿½æ±‚ â€œç»„ä»¶æ ¸å¿ƒé€»è¾‘çº¯å‡€â€â€”â€” ç»„ä»¶é¡¶å±‚åªå…³æ³¨ â€œæ ¹æ®çŠ¶æ€æ¸²æŸ“ä»€ä¹ˆâ€ï¼Œå‰¯ä½œç”¨å…¨éƒ¨äº¤ç»™Â <code>useEffect</code>Â å¤„ç†ï¼Œè¿™æ ·ï¼š</p>
<ul>
<li>ä»£ç ç»“æ„æ›´æ¸…æ™°ï¼šæ¸²æŸ“å’Œå‰¯ä½œç”¨åˆ†ç¦»ï¼Œä¸€çœ¼èƒ½åŒºåˆ† â€œè§†å›¾ç›¸å…³â€ å’Œ â€œéè§†å›¾ç›¸å…³â€ é€»è¾‘ï¼›</li>
<li>ä¾¿äºè°ƒè¯•ï¼šå‰¯ä½œç”¨çš„æ‰§è¡Œæ—¶æœºç”±ä¾èµ–æ•°ç»„æ˜ç¡®æ§åˆ¶ï¼Œèƒ½ç²¾å‡†å®šä½ â€œä»€ä¹ˆæ—¶å€™æ‰§è¡Œã€ä¸ºä»€ä¹ˆæ‰§è¡Œâ€ï¼›</li>
<li>é¿å…å†…å­˜æ³„æ¼ï¼šé€šè¿‡æ¸…ç†å‡½æ•°å¯ä¼˜é›…å¤„ç† â€œç»„ä»¶å¸è½½åä»æ‰§è¡Œå‰¯ä½œç”¨â€ çš„é—®é¢˜ï¼ˆæ¯”å¦‚è¯·æ±‚æ•°æ®æ—¶ç»„ä»¶å¸è½½äº†ï¼Œæ¸…ç†å‡½æ•°å¯å–æ¶ˆè¯·æ±‚ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-14">3. å—æ§ç»„ä»¶ï¼šæ¨¡æ‹ŸåŒå‘ç»‘å®šçš„åº•å±‚é€»è¾‘</h3>
<p>Vue ä¸­ç”¨Â <code>v-model</code>Â å°±èƒ½å®ç° â€œè¡¨å•å€¼ â†” æ•°æ®â€ çš„åŒå‘ç»‘å®šï¼Œä½† React æ²¡æœ‰å†…ç½®çš„åŒå‘ç»‘å®šè¯­æ³• â€”â€” ä¸æ˜¯ â€œåšä¸åˆ°â€ï¼Œè€Œæ˜¯ React åšæŒ<code>å•å‘æ•°æ®æµ</code>ï¼Œé€šè¿‡ â€œå—æ§ç»„ä»¶â€ æ‰‹åŠ¨æ¨¡æ‹ŸåŒå‘ç»‘å®šï¼Œè™½ç„¶ä»£ç å¤šäº†å‡ è¡Œï¼Œä½†èƒ½å®Œå…¨æŒæ§æ•°æ®æµè½¬ã€‚</p>
<h4 data-id="heading-15">ï¼ˆ1ï¼‰åŒå‘ç»‘å®šçš„æœ¬è´¨ï¼šè§†å›¾ â†” æ•°æ®åŒæ­¥</h4>
<p>ä¸ç®¡æ˜¯ Vue çš„Â <code>v-model</code>Â è¿˜æ˜¯ React çš„å—æ§ç»„ä»¶ï¼ŒåŒå‘ç»‘å®šçš„æ ¸å¿ƒæ˜¯ä¸¤ä»¶äº‹ï¼š</p>
<ol>
<li><strong>æ•°æ® â†’ è§†å›¾</strong>ï¼šæ•°æ®ï¼ˆçŠ¶æ€ï¼‰å˜åŒ–ï¼Œè§†å›¾ï¼ˆè¾“å…¥æ¡†ï¼‰è‡ªåŠ¨æ›´æ–°ï¼›</li>
<li><strong>è§†å›¾ â†’ æ•°æ®</strong>ï¼šè§†å›¾ï¼ˆç”¨æˆ·è¾“å…¥ï¼‰å˜åŒ–ï¼Œæ•°æ®ï¼ˆçŠ¶æ€ï¼‰è‡ªåŠ¨æ›´æ–°ã€‚</li>
</ol>
<h4 data-id="heading-16">ï¼ˆ2ï¼‰React å—æ§ç»„ä»¶çš„å®ç°ï¼šæ‹†è§£æ¯ä¸€æ­¥</h4>
<p>ä»¥ TodoInput ç»„ä»¶ä¸ºä¾‹ï¼Œé€è¡Œè§£æåŒå‘ç»‘å®šçš„å®ç°é€»è¾‘ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title function_">TodoInput</span> = (<span class="hljs-params">{ onAdd }</span>) =&gt; {
  <span class="hljs-comment">// æ­¥éª¤1ï¼šå®šä¹‰çŠ¶æ€å­˜å‚¨è¾“å…¥æ¡†å€¼ï¼ˆæ•°æ®å±‚ï¼‰</span>
  <span class="hljs-keyword">const</span> [inputValue, setInputValue] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);

  <span class="hljs-comment">// æ­¥éª¤2ï¼šå¤„ç†è¡¨å•æäº¤</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSubmit</span> = (<span class="hljs-params">e</span>) =&gt; {
    <span class="hljs-comment">// å…³é”®ï¼šé˜»æ­¢è¡¨å•é»˜è®¤æäº¤è¡Œä¸º</span>
    e.<span class="hljs-title function_">preventDefault</span>();
    <span class="hljs-comment">// è¾“å…¥å†…å®¹æ ¡éªŒï¼šå»é™¤é¦–å°¾ç©ºæ ¼ï¼Œé¿å…ç©ºæäº¤</span>
    <span class="hljs-keyword">const</span> text = inputValue.<span class="hljs-title function_">trim</span>();
    <span class="hljs-keyword">if</span> (!text) <span class="hljs-keyword">return</span>;
    <span class="hljs-comment">// æ­¥éª¤3ï¼šå°†è¾“å…¥å†…å®¹ä¼ ç»™çˆ¶ç»„ä»¶ï¼ˆçˆ¶å­é€šä¿¡ï¼‰</span>
    <span class="hljs-title function_">onAdd</span>(text);
    <span class="hljs-comment">// æ­¥éª¤4ï¼šæ¸…ç©ºè¾“å…¥æ¡†ï¼ˆä¿®æ”¹çŠ¶æ€ â†’ è§†å›¾æ¸…ç©ºï¼‰</span>
    <span class="hljs-title function_">setInputValue</span>(<span class="hljs-string">''</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
        // <span class="hljs-attr">æ ¸å¿ƒ1</span>ï¼š<span class="hljs-attr">æ•°æ®</span> â†’ <span class="hljs-attr">è§†å›¾</span>ï¼ˆ<span class="hljs-attr">çŠ¶æ€æ§åˆ¶è¾“å…¥æ¡†æ˜¾ç¤º</span>ï¼‰
        <span class="hljs-attr">value</span>=<span class="hljs-string">{inputValue}</span>
        // <span class="hljs-attr">æ ¸å¿ƒ2</span>ï¼š<span class="hljs-attr">è§†å›¾</span> â†’ <span class="hljs-attr">æ•°æ®</span>ï¼ˆ<span class="hljs-attr">è¾“å…¥å˜åŒ–åŒæ­¥æ›´æ–°çŠ¶æ€</span>ï¼‰
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setInputValue(e.target.value)}
        placeholder="è¯·è¾“å…¥å¾…åŠäº‹é¡¹..."
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>Add<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
};
</code></pre>
<p><strong>é€ç‚¹æ·±åº¦è§£æ</strong>ï¼š</p>
<ul>
<li><strong>æ•°æ® â†’ è§†å›¾</strong>ï¼š<code>value={inputValue}</code>Â æ˜¯ â€œå•å‘ç»‘å®šâ€ çš„æ ¸å¿ƒ â€”â€” è¾“å…¥æ¡†æ˜¾ç¤ºçš„å†…å®¹å®Œå…¨ç”±Â <code>inputValue</code>Â çŠ¶æ€å†³å®šï¼Œè€Œé DOM è‡ªèº«çš„ valueã€‚æ¯”å¦‚æ‰§è¡ŒÂ <code>setInputValue('')</code>ï¼Œ<code>inputValue</code>Â å˜ä¸ºç©ºï¼Œè¾“å…¥æ¡†å°±ä¼šç«‹åˆ»æ¸…ç©ºï¼Œè¿™æ˜¯ â€œçŠ¶æ€é©±åŠ¨è§†å›¾â€ çš„ä½“ç°ã€‚</li>
<li><strong>è§†å›¾ â†’ æ•°æ®</strong>ï¼š<code>onChange</code>Â äº‹ä»¶ç›‘å¬è¾“å…¥æ¡†çš„æ¯ä¸€æ¬¡å­—ç¬¦å˜åŒ–ï¼Œ<code>e.target.value</code>Â æ˜¯è¾“å…¥æ¡†å½“å‰çš„ DOM å–å€¼ï¼Œé€šè¿‡Â <code>setInputValue</code>Â å°†å…¶åŒæ­¥åˆ°Â <code>inputValue</code>Â çŠ¶æ€ â€”â€” è¿™ä¸€æ­¥æ˜¯ â€œæ‰‹åŠ¨è¡¥å…¨â€ åŒå‘ç»‘å®šçš„åå‘æµç¨‹ï¼Œä¹Ÿæ˜¯ React ä¸ Vue çš„æ ¸å¿ƒåŒºåˆ«ï¼ˆVue æŠŠè¿™ä¸€æ­¥å°è£…æˆäº†Â <code>v-model</code>ï¼ŒReact è®©å¼€å‘è€…æ‰‹åŠ¨æ§åˆ¶ï¼Œæ›´çµæ´»ï¼‰ã€‚</li>
<li><strong>e.preventDefault()</strong> ï¼šè¡¨å•çš„é»˜è®¤è¡Œä¸ºæ˜¯ â€œæäº¤å¹¶åˆ·æ–°é¡µé¢â€ï¼Œè€Œ React æ˜¯å•é¡µåº”ç”¨ï¼Œåˆ·æ–°é¡µé¢ä¼šå¯¼è‡´æ‰€æœ‰çŠ¶æ€ä¸¢å¤±ï¼Œå› æ­¤å¿…é¡»é˜»æ­¢è¿™ä¸ªé»˜è®¤è¡Œä¸º â€”â€” è¿™æ˜¯å‰ç«¯å¼€å‘çš„é€šç”¨çŸ¥è¯†ç‚¹ï¼Œä¹Ÿæ˜¯ React å¤„ç†è¡¨å•çš„ â€œå¿…åšæ­¥éª¤â€ã€‚</li>
<li><strong>ä¸ºä»€ä¹ˆç”¨ form + onSubmit è€Œé button + onClick</strong>é™¤äº†ç‚¹å‡»æŒ‰é’®æäº¤ï¼Œç”¨æˆ·åœ¨è¾“å…¥æ¡†æŒ‰<code>å›è½¦é”®</code>ä¹Ÿèƒ½è§¦å‘Â <code>onSubmit</code>ï¼Œè€Œå•çº¯çš„Â <code>onClick</code>Â æ— æ³•å“åº”å›è½¦æäº¤ï¼Œè¿™æ˜¯<strong>è¯­ä¹‰åŒ– + ç”¨æˆ·ä½“éªŒ</strong>çš„åŒé‡è€ƒé‡ã€‚</li>
</ul>
<h4 data-id="heading-17">ï¼ˆ3ï¼‰å—æ§ç»„ä»¶çš„æ ¸å¿ƒä¼˜åŠ¿ï¼šå®Œå…¨å¯æ§</h4>
<p>ç›¸æ¯” Vue çš„Â <code>v-model</code>Â é»‘ç›’å°è£…ï¼ŒReact å—æ§ç»„ä»¶çš„ â€œæ‰‹åŠ¨æ“ä½œâ€ å¸¦æ¥äº†ä¸¤ä¸ªæ ¸å¿ƒä»·å€¼ï¼š</p>
<ul>
<li><strong>å¯æ ¡éªŒæ€§</strong>ï¼šåœ¨Â <code>onChange</code>Â æˆ–Â <code>handleSubmit</code>Â ä¸­å¯éšæ—¶å¯¹è¾“å…¥å†…å®¹åšæ ¡éªŒï¼ˆæ¯”å¦‚ç¦æ­¢è¾“å…¥ç‰¹æ®Šå­—ç¬¦ã€é™åˆ¶é•¿åº¦ã€å»é™¤ç©ºæ ¼ï¼‰ï¼Œæ¯”å¦‚åœ¨ä»£ç ä¸­Â <code>inputValue.trim()</code>Â å°±æ˜¯ç®€å•çš„æ ¡éªŒï¼Œè‹¥éœ€è¦æ›´å¤æ‚çš„æ ¡éªŒï¼ˆæ¯”å¦‚æ‰‹æœºå·æ ¼å¼ï¼‰ï¼Œå¯ç›´æ¥åœ¨è¿™ä¸€æ­¥å¤„ç†ï¼›</li>
<li><strong>å¯è¿½æº¯æ€§</strong>ï¼šè¾“å…¥æ¡†çš„æ¯ä¸€æ¬¡å€¼å˜åŒ–éƒ½å¿…é¡»é€šè¿‡Â <code>setInputValue</code>Â è§¦å‘ï¼Œåœ¨è°ƒè¯•å·¥å…·ä¸­èƒ½æ¸…æ™°çœ‹åˆ°Â <code>inputValue</code>Â çš„æ¯ä¸€æ¬¡æ›´æ–°è®°å½•ï¼Œä¾¿äºå®šä½ â€œè¾“å…¥å¼‚å¸¸â€ é—®é¢˜ï¼ˆæ¯”å¦‚è¾“å…¥æ¡†å€¼ä¸å˜ï¼Œå¯ç›´æ¥æŸ¥Â <code>setInputValue</code>Â æ˜¯å¦æ‰§è¡Œï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-18">4. çˆ¶å­ç»„ä»¶é€šä¿¡ï¼šå•å‘æ•°æ®æµçš„æè‡´ä½“ç°</h3>
<p>React çš„ â€œå•å‘æ•°æ®æµâ€ ä¸æ˜¯ â€œé™åˆ¶â€ï¼Œè€Œæ˜¯ â€œä¿éšœâ€â€”â€” æ•°æ®åªèƒ½ä»çˆ¶ç»„ä»¶é€šè¿‡ props æµå‘å­ç»„ä»¶ï¼Œå­ç»„ä»¶ä¸èƒ½ç›´æ¥ä¿®æ”¹çˆ¶ç»„ä»¶çš„çŠ¶æ€ï¼Œåªèƒ½é€šè¿‡çˆ¶ç»„ä»¶ä¼ é€’çš„å›è°ƒå‡½æ•° â€œé€šçŸ¥â€ çˆ¶ç»„ä»¶ä¿®æ”¹çŠ¶æ€ã€‚è¿™ç§è®¾è®¡è®©æ•°æ®æµè½¬è·¯å¾„æ¸…æ™°ï¼Œé¿å…äº† â€œå¤šä¸ªç»„ä»¶éšæ„ä¿®æ”¹æ•°æ®å¯¼è‡´çš„æ··ä¹±â€ã€‚</p>
<h4 data-id="heading-19">ï¼ˆ1ï¼‰é€šä¿¡æµç¨‹ï¼šä»¥ â€œæ¸…é™¤å·²å®Œæˆä»»åŠ¡â€ ä¸ºä¾‹</h4>
<ol>
<li><strong>çˆ¶ç»„ä»¶ï¼ˆAppï¼‰</strong> ï¼šå®šä¹‰çŠ¶æ€ä¿®æ”¹é€»è¾‘ + ä¼ é€’å›è°ƒå‡½æ•°</li>
</ol>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// æ­¥éª¤1ï¼šçˆ¶ç»„ä»¶å®šä¹‰ä¿®æ”¹çŠ¶æ€çš„æ ¸å¿ƒé€»è¾‘</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">clearCompleted</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title function_">setTodos</span>(todos.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> !todo.<span class="hljs-property">completed</span>));
};

<span class="hljs-comment">// æ­¥éª¤2ï¼šé€šè¿‡ props å°†å›è°ƒå‡½æ•°ä¼ é€’ç»™å­ç»„ä»¶</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoStats</span> 
  <span class="hljs-attr">total</span>=<span class="hljs-string">{todos.length}</span>
  <span class="hljs-attr">completed</span>=<span class="hljs-string">{completedCount}</span>
  <span class="hljs-attr">active</span>=<span class="hljs-string">{activeCount}</span>
  <span class="hljs-attr">onClearCompleted</span>=<span class="hljs-string">{clearCompleted}</span> // <span class="hljs-attr">ä¼ é€’å›è°ƒ</span>
/&gt;</span></span>
</code></pre>
<ol start="2">
<li><strong>å­ç»„ä»¶ï¼ˆTodoStatsï¼‰</strong> ï¼šæ¥æ”¶å›è°ƒå‡½æ•° + è§¦å‘å›è°ƒ</li>
</ol>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title function_">TodoStats</span> = (<span class="hljs-params">{ total, completed, active, onClearCompleted }</span>) =&gt; {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Total: {total}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Completed: {completed}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Active: {active}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      {/* æ¡ä»¶æ¸²æŸ“ï¼šæœ‰å·²å®Œæˆä»»åŠ¡æ‰æ˜¾ç¤ºæŒ‰é’® */}
      {completed &gt; 0 &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClearCompleted}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"clear-btn"</span>&gt;</span>
          æ¸…é™¤å·²å®Œæˆä»»åŠ¡
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
};
</code></pre>
<p><strong>æ·±åº¦è§£æ</strong>ï¼š</p>
<ul>
<li>å­ç»„ä»¶ TodoStats åªè´Ÿè´£ â€œå±•ç¤ºæ•°æ® + è§¦å‘äº¤äº’â€ï¼Œä¸å…³å¿ƒ â€œæ¸…é™¤å·²å®Œæˆä»»åŠ¡â€ çš„å…·ä½“é€»è¾‘ â€”â€” å“ªæ€•åç»­ä¿®æ”¹æ¸…é™¤é€»è¾‘ï¼ˆæ¯”å¦‚åŠ ç¡®è®¤å¼¹çª—ï¼‰ï¼Œåªéœ€æ”¹çˆ¶ç»„ä»¶çš„Â <code>clearCompleted</code>ï¼Œå­ç»„ä»¶å®Œå…¨ä¸ç”¨åŠ¨ï¼Œç¬¦åˆ â€œå¼€é—­åŸåˆ™â€ã€‚</li>
<li>å›è°ƒå‡½æ•°æ˜¯ â€œå­ç»„ä»¶é€šçŸ¥çˆ¶ç»„ä»¶â€ çš„å”¯ä¸€æ–¹å¼ï¼šå­ç»„ä»¶æ— æ³•ç›´æ¥è®¿é—®çˆ¶ç»„ä»¶çš„Â <code>todos</code>Â çŠ¶æ€ï¼Œä¹Ÿä¸èƒ½ç›´æ¥è°ƒç”¨Â <code>setTodos</code>ï¼Œåªèƒ½é€šè¿‡çˆ¶ç»„ä»¶ä¼ é€’çš„Â <code>onClearCompleted</code>Â å›è°ƒï¼Œè§¦å‘çˆ¶ç»„ä»¶çš„çŠ¶æ€ä¿®æ”¹é€»è¾‘ â€”â€” è¿™å°±æ˜¯ â€œå•å‘æ•°æ®æµâ€ï¼šæ•°æ®å‘ä¸‹ä¼ ï¼ˆçˆ¶â†’å­ï¼‰ï¼Œäº‹ä»¶å‘ä¸Šä¼ ï¼ˆå­â†’çˆ¶ï¼‰ï¼Œæ‰€æœ‰çŠ¶æ€ä¿®æ”¹éƒ½é›†ä¸­åœ¨çˆ¶ç»„ä»¶ï¼Œä¾¿äºè¿½è¸ªå’Œè°ƒè¯•ã€‚</li>
</ul>
<h4 data-id="heading-20">ï¼ˆ2ï¼‰props çš„æœ¬è´¨ï¼šåªè¯»çš„ â€œæ•°æ®æ¡¥æ¢â€ (åé¢ä¼šå•ç‹¬æ¥è®²)</h4>
<p>props æ˜¯çˆ¶å­ç»„ä»¶é€šä¿¡çš„å”¯ä¸€æ¡¥æ¢ï¼Œä½†æœ‰ä¸€ä¸ªæ ¸å¿ƒè§„åˆ™ï¼š<strong>å­ç»„ä»¶ä¸èƒ½ä¿®æ”¹ props</strong>ã€‚æ¯”å¦‚ TodoStats æ¥æ”¶çš„Â <code>completed</code>Â <code>total</code>Â ç­‰ propsï¼Œå­ç»„ä»¶åªèƒ½è¯»å–ï¼Œä¸èƒ½ä¿®æ”¹ â€”â€” å› ä¸º props æ˜¯çˆ¶ç»„ä»¶çŠ¶æ€çš„ â€œå¿«ç…§â€ï¼Œä¿®æ”¹ props ä¼šå¯¼è‡´æ•°æ®æºå¤´æ··ä¹±ï¼ˆæ¯”å¦‚å­ç»„ä»¶æ”¹äº†Â <code>completed</code>ï¼Œçˆ¶ç»„ä»¶çš„Â <code>completedCount</code>Â å´æ²¡å˜åŒ–ï¼Œæ•°æ®ä¸ä¸€è‡´ï¼‰ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/013869adb5f94edcad2cc7302eb442b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVF9fX1Q=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767196862&amp;x-signature=PcjpbZS3MknSZBObnCXiTfAo50A%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-21">ä¸‰ã€æ ¸å¿ƒè®¾è®¡æ€æƒ³ï¼šä» TodoList çœ‹ React çš„åº•å±‚é€»è¾‘</h2>
<p>é€šè¿‡è¿™ä¸ª TodoList æ¡ˆä¾‹ï¼Œæˆ‘ä»¬èƒ½æç‚¼å‡º React æœ€æ ¸å¿ƒçš„ 4 ä¸ªè®¾è®¡æ€æƒ³ï¼Œè¿™ä¹Ÿæ˜¯ç†è§£ React çš„å…³é”®ï¼š</p>
<h3 data-id="heading-22">1. çŠ¶æ€é©±åŠ¨è§†å›¾</h3>
<p>React ä¸­ â€œè§†å›¾æ˜¯ä»€ä¹ˆæ ·â€ å®Œå…¨ç”± â€œçŠ¶æ€æ˜¯ä»€ä¹ˆæ ·â€ å†³å®šï¼Œæ²¡æœ‰ â€œæ‰‹åŠ¨æ“ä½œ DOMâ€ çš„åœºæ™¯ï¼ˆæ¯”å¦‚ä¸ç”¨Â <code>document.getElementById</code>Â æ”¹è¾“å…¥æ¡†å€¼ï¼Œä¸ç”¨Â <code>appendChild</code>Â åŠ å¾…åŠé¡¹ï¼‰ã€‚æ‰€æœ‰è§†å›¾å˜åŒ–ï¼Œéƒ½æ˜¯å…ˆä¿®æ”¹çŠ¶æ€ï¼Œå†ç”± React è‡ªåŠ¨æ›´æ–° DOMâ€”â€” è¿™é¿å…äº†æ‰‹åŠ¨æ“ä½œ DOM çš„ç¹çå’Œæ˜“å‡ºé”™ï¼Œä¹Ÿè®©ä»£ç æ›´æ˜“ç»´æŠ¤ï¼ˆåªéœ€å…³æ³¨çŠ¶æ€å˜åŒ–ï¼Œä¸ç”¨å…³æ³¨ DOM å˜åŒ–ï¼‰ã€‚</p>
<h3 data-id="heading-23">2. å•å‘æ•°æ®æµ</h3>
<p>æ•°æ®åªæœ‰ä¸€ä¸ªæµå‘ï¼šçˆ¶ç»„ä»¶ â†’ å­ç»„ä»¶ï¼ŒçŠ¶æ€åªæœ‰ä¸€ä¸ªä¿®æ”¹å…¥å£ï¼šå®šä¹‰çŠ¶æ€çš„ç»„ä»¶ï¼ˆæ¯”å¦‚ todos å®šä¹‰åœ¨ Appï¼Œåªæœ‰ App èƒ½æ”¹ï¼Œå­ç»„ä»¶åªèƒ½é€šè¿‡å›è°ƒé€šçŸ¥ App æ”¹ï¼‰ã€‚è¿™ç§è®¾è®¡è®©æ•°æ®æµè½¬ â€œå¯é¢„æµ‹â€â€”â€” ä¸ç®¡é¡¹ç›®å¤šå¤æ‚ï¼Œéƒ½èƒ½é¡ºç€ props æ‰¾åˆ°æ•°æ®çš„æºå¤´ï¼Œé¡ºç€å›è°ƒæ‰¾åˆ°çŠ¶æ€ä¿®æ”¹çš„åœ°æ–¹ã€‚</p>
<h3 data-id="heading-24">3. ç»„ä»¶åŒ–ä¸å•ä¸€èŒè´£</h3>
<p>æ¯ä¸ªç»„ä»¶åªåšä¸€ä»¶äº‹ï¼šTodoInput åªå¤„ç†è¾“å…¥ï¼ŒTodoList åªæ¸²æŸ“åˆ—è¡¨ï¼ŒTodoStats åªå±•ç¤ºç»Ÿè®¡ã€‚è¿™ç§æ‹†åˆ†è®©ç»„ä»¶ â€œé«˜å†…èšã€ä½è€¦åˆâ€ï¼š</p>
<ul>
<li>é«˜å†…èšï¼šç»„ä»¶å†…éƒ¨é€»è¾‘å›´ç»•æ ¸å¿ƒèŒè´£å±•å¼€ï¼Œä¸æºæ‚å…¶ä»–åŠŸèƒ½ï¼›</li>
<li>ä½è€¦åˆï¼šç»„ä»¶ä¹‹é—´é€šè¿‡ props é€šä¿¡ï¼Œä¿®æ”¹ä¸€ä¸ªç»„ä»¶ä¸ä¼šå½±å“å…¶ä»–ç»„ä»¶ã€‚</li>
</ul>
<h3 data-id="heading-25">4. å‰¯ä½œç”¨ä¸æ¸²æŸ“åˆ†ç¦»</h3>
<p><code>useEffect</code>Â å°† â€œå‰¯ä½œç”¨é€»è¾‘â€ï¼ˆæ¯”å¦‚æœ¬åœ°å­˜å‚¨ï¼‰ä¸ â€œæ¸²æŸ“é€»è¾‘â€ï¼ˆæ¯”å¦‚å±•ç¤ºå¾…åŠåˆ—è¡¨ï¼‰åˆ†ç¦»ï¼Œè®©ç»„ä»¶çš„æ ¸å¿ƒé€»è¾‘ï¼ˆæ ¹æ®çŠ¶æ€æ¸²æŸ“è§†å›¾ï¼‰ä¿æŒ â€œçº¯å‡€â€â€”â€” çº¯å‡€çš„ç»„ä»¶é€»è¾‘æ›´æ˜“æµ‹è¯•ã€æ›´æ˜“å¤ç”¨ï¼Œè¿™ä¹Ÿæ˜¯ React æ¨å´‡çš„ â€œå‡½æ•°å¼ç¼–ç¨‹â€ æ€æƒ³çš„ä½“ç°ã€‚</p>
<h2 data-id="heading-26">å››ã€æ€»ç»“ï¼šä» TodoList åˆ° React æ ¸å¿ƒèƒ½åŠ›</h2>
<p>è¿™ä¸ªçœ‹ä¼¼ç®€å•çš„ TodoListï¼Œå®åˆ™æ¶µç›–äº† React æ—¥å¸¸å¼€å‘çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼š</p>
<ul>
<li><code>useState</code>Â å®ç°çŠ¶æ€ç®¡ç†ï¼Œç†è§£ â€œä¸å¯å˜æ›´æ–°â€ å’Œ â€œæƒ°æ€§åˆå§‹åŒ–â€ï¼›</li>
<li><code>useEffect</code>Â å¤„ç†å‰¯ä½œç”¨ï¼Œç†è§£ â€œä¾èµ–æ•°ç»„â€ å’Œ â€œæ•°æ®æŒä¹…åŒ–â€ï¼›</li>
<li>å—æ§ç»„ä»¶æ¨¡æ‹ŸåŒå‘ç»‘å®šï¼Œç†è§£ â€œçŠ¶æ€é©±åŠ¨è§†å›¾â€ å’Œ â€œå•å‘æ•°æ®æµâ€ï¼›</li>
<li>çˆ¶å­ç»„ä»¶é€šä¿¡ï¼Œç†è§£ props çš„ â€œåªè¯»ç‰¹æ€§â€ å’Œå›è°ƒå‡½æ•°çš„ä½œç”¨ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è§‚æµ‹äº‘äº§å“æ›´æ–° | åº”ç”¨æ€§èƒ½ç›‘æµ‹ã€ç›‘æ§ã€åœºæ™¯ã€å¿«ç…§ç­‰]]></title>    <link>https://juejin.cn/post/7587261253913395215</link>    <guid>https://juejin.cn/post/7587261253913395215</guid>    <pubDate>2025-12-25T02:58:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587261253913395215" data-draft-id="7587322796825428008" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è§‚æµ‹äº‘äº§å“æ›´æ–° | åº”ç”¨æ€§èƒ½ç›‘æµ‹ã€ç›‘æ§ã€åœºæ™¯ã€å¿«ç…§ç­‰"/> <meta itemprop="keywords" content="äº§å“"/> <meta itemprop="datePublished" content="2025-12-25T02:58:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¯è§‚æµ‹æ€§ç”¨è§‚æµ‹äº‘"/> <meta itemprop="url" content="https://juejin.cn/user/2392958212523102"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è§‚æµ‹äº‘äº§å“æ›´æ–° | åº”ç”¨æ€§èƒ½ç›‘æµ‹ã€ç›‘æ§ã€åœºæ™¯ã€å¿«ç…§ç­‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2392958212523102/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¯è§‚æµ‹æ€§ç”¨è§‚æµ‹äº‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T02:58:27.000Z" title="Thu Dec 25 2025 02:58:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è§‚æµ‹äº‘æ›´æ–°</h2>
<h3 data-id="heading-1">è§’è‰²æƒé™</h3>
<p>1ã€ä»ªè¡¨æ¿æƒé™ç»†åŒ–ï¼šæ–°å¢ç‹¬ç«‹çš„â€œä»ªè¡¨æ¿æ–°å»ºâ€æƒé™ï¼ŒåŸæœ‰â€œä»ªè¡¨æ¿ç®¡ç†â€æƒé™ä»åŒ…å«æ‰€æœ‰æ“ä½œã€‚åˆ†é…â€œæ–°å»ºâ€æƒé™æ—¶ä¼šè‡ªåŠ¨å¼€å¯ä»ªè¡¨æ¿ã€è§†å›¾åŸºç¡€æŸ¥çœ‹æƒé™ã€‚</p>
<p>2ã€å¯¼èˆªæ æ ¹æ®ç”¨æˆ·çš„æƒé™åŠ¨æ€æ˜¾ç¤ºã€‚è‹¥æŸä¸€è§’è‰²åœ¨æŒ‡å®šæ¨¡å—ä¸­æœªè·å¾—ä»»ä½•æƒé™ï¼Œè¯¥æ¨¡å—å°†ä¸ä¼šåœ¨å…¶å·¦ä¾§å¯¼èˆªæ ä¸­æ˜¾ç¤ºã€‚æ­¤è§„åˆ™é€‚ç”¨äºä»¥ä¸‹æ¨¡å—ï¼šäº‘è´¦å•ã€ä»˜è´¹è®¡åˆ’ä¸è´¦å•ã€åœºæ™¯ã€äº‹ä»¶ä¸­å¿ƒã€åŸºç¡€è®¾æ–½ã€æ—¥å¿—ã€æŒ‡æ ‡ã€åº”ç”¨æ€§èƒ½ç›‘æµ‹ã€ç”¨æˆ·è®¿é—®ç›‘æµ‹ã€LLM ç›‘æµ‹ã€å¯ç”¨æ€§ç›‘æµ‹ã€ç›‘æ§ã€å¼‚å¸¸è¿½è¸ªã€å®‰å…¨ç›‘æµ‹ã€‚</p>
<h3 data-id="heading-2">ç›‘æ§</h3>
<p>1ã€å‘Šè­¦ç­–ç•¥ï¼š</p>
<ul>
<li>åŒæ—¶æ”¯æŒæœç´¢å’Œç­›é€‰å¯¹å‘Šè­¦ç­–ç•¥è¿›è¡Œè¿‡æ»¤ï¼›æ–°å¢æ”¯æŒå¯æŒ‰ç›‘æ§å™¨åç§°ï¼ˆ<code>checker_title</code>ï¼‰ã€æˆå‘˜ï¼ˆ<code>member</code>ï¼‰è¿›è¡Œç²¾å‡†ç­›é€‰ï¼›</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/994b2dadc15b474b90c908f2980f362d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236307&amp;x-signature=qjreMKtKSXeOOQ6hV%2F2MGx8Bveg%3D" alt="" loading="lazy"/></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fmonitoring%2Fcreate-alert-setting%2F%23repeat" target="_blank" title="https://docs.guance.com/monitoring/create-alert-setting/#repeat" ref="nofollow noopener noreferrer">é‡å¤å‘Šè­¦</a>ï¼šæ–°å¢æ”¯æŒé’ˆå¯¹ä¸åŒå‘Šè­¦ç­‰çº§ï¼ˆå¦‚ç´§æ€¥ã€ä¸¥é‡ã€è­¦å‘Šç­‰ï¼‰åˆ†åˆ«è®¾ç½®é‡å¤å‘Šè­¦çš„ä¸å‘é€æ—¶é—´é—´éš”ï¼›</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8740b87a4494d15a9f6b249d8b4867c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236307&amp;x-signature=notA%2B9Zg%2F7Ny%2B21isC8IYF%2BYPkk%3D" alt="" loading="lazy"/></p>
<ul>
<li>æ–°å¢é€šçŸ¥èšåˆè§„åˆ™ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fmonitoring%2Fcreate-alert-setting%2F%23custom-pattern" target="_blank" title="https://docs.guance.com/monitoring/create-alert-setting/#custom-pattern" ref="nofollow noopener noreferrer">â€œè‡ªå®šä¹‰â€</a>ã€‚æ”¯æŒæ ¹æ®ä¸šåŠ¡éœ€æ±‚è‡ªç”±æŒ‡å®šç”¨äºå‘Šè­¦èšåˆçš„å­—æ®µç»„åˆã€‚è¾“å…¥å­—æ®µåï¼ˆå¤šä¸ªå­—æ®µä»¥è‹±æ–‡é€—å·åˆ†éš”ï¼‰ï¼Œç³»ç»Ÿå°†ä¸¥æ ¼æŒ‰æ­¤ç»„åˆè¿›è¡Œèšåˆï¼šä»…å½“äº‹ä»¶æ•°æ®åŒ…å«æ‰€æœ‰æŒ‡å®šå­—æ®µä¸”å–å€¼å‡æœ‰æ•ˆæ—¶ï¼Œæ‰ä¼šè§¦å‘èšåˆå‘Šè­¦ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d00a84ffc9cf4689bafeb57a80ff49d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236307&amp;x-signature=eoYwtHmluoMM0Yppq%2B%2B21pqvucY%3D" alt="" loading="lazy"/></p>
<p>2ã€Arbiter å†…ç½®çš„ DQL å‡½æ•°æ”¯æŒé€šè¿‡ä¼ å…¥å·¥ä½œç©ºé—´å‚æ•°ï¼ŒæŸ¥è¯¢æŒ‡å®šç©ºé—´çš„æ•°æ®ã€‚é€‚ç”¨äº<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fmonitoring%2Fmonitor%2Fprogrammable-detection%2F" target="_blank" title="https://docs.guance.com/monitoring/monitor/programmable-detection/" ref="nofollow noopener noreferrer">å¯ç¼–ç¨‹ç›‘æ§å™¨</a>å’ŒÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fsecurity%2Fcreate-detection-rules%2F" target="_blank" title="https://docs.guance.com/security/create-detection-rules/" ref="nofollow noopener noreferrer">SIEM</a>Â æ£€æµ‹è§„åˆ™çš„åˆ›å»ºä¸ä¿®æ”¹åœºæ™¯ã€‚</p>
<h3 data-id="heading-3">åº”ç”¨æ€§èƒ½ç›‘æµ‹</h3>
<p>1ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fapplication-performance-monitoring%2Fservice-manag%2Fservice-performance%2F" target="_blank" title="https://docs.guance.com/application-performance-monitoring/service-manag/service-performance/" ref="nofollow noopener noreferrer">æ€§èƒ½æŒ‡æ ‡</a>ï¼š</p>
<ul>
<li>æ–°å¢ Apdex ç»Ÿè®¡ï¼Œé‡åŒ–ç”¨æˆ·å¯¹åº”ç”¨æ€§èƒ½çš„æ»¡æ„åº¦ï¼›</li>
<li>ç»Ÿè®¡æŒ‡æ ‡æ—¶åºå¯è§†åŒ–ï¼šå°†æœåŠ¡åˆ—è¡¨ä¸­çš„å¹³å‡è¯·æ±‚æ•°ã€å“åº”æ—¶é—´ã€é”™è¯¯æ•°ç­‰æ ¸å¿ƒç»Ÿè®¡æŒ‡æ ‡ï¼Œä»æ•°å€¼å±•ç¤ºå‡çº§ä¸ºæ—¶åºå›¾å½¢å¼ï¼Œç›´è§‚å‘ˆç°å˜åŒ–è¶‹åŠ¿ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/064f6a32fb8d4d5aaed61f38cf2f5d47~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236307&amp;x-signature=RJgPiJXbXKGHuEcyYlzQP%2Bl3A%2F8%3D" alt="" loading="lazy"/></p>
<p>2ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fapplication-performance-monitoring%2Fservice-manag%2Fservice-details%2F" target="_blank" title="https://docs.guance.com/application-performance-monitoring/service-manag/service-details/" ref="nofollow noopener noreferrer">æœåŠ¡è¯¦æƒ…</a>ï¼š</p>
<ul>
<li>æ”¯æŒ OpenTelemetry æœåŠ¡è¯­è¨€çš„æ˜¾ç¤ºï¼›</li>
<li>æ–°å¢ Tab é¡µï¼šæœåŠ¡æ‹“æ‰‘ã€Profileã€ä»ªè¡¨æ¿ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ddde2bc5985248919e5922240ed17efd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236307&amp;x-signature=7XoG7REo4wmZ%2BtK%2Fv%2FDc%2BHs6P4s%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">åœºæ™¯</h3>
<p>1ã€æ–°å¢å›¾è¡¨ç±»å‹â€œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fscene%2Fvisual-chart%2Fchange-comparison-chart%2F" target="_blank" title="https://docs.guance.com/scene/visual-chart/change-comparison-chart/" ref="nofollow noopener noreferrer">å˜åŒ–å¯¹æ¯”å›¾</a>â€ï¼šå°†æŒ‡å®šæŒ‡æ ‡åœ¨å½“å‰æ—¶æ®µä¸å†å²åŒæœŸï¼ˆå¦‚æ˜¨æ—¥åŒä¸€æ—¶åˆ»ã€ä¸Šå‘¨åŒæ—¥ï¼‰çš„æ•°å€¼æˆ–å…¶ä»–æŒ‡æ ‡è¿›è¡Œé‡åŒ–å¯¹æ¯”ï¼Œå¹¶ä»¥ç›´è§‚æ–¹å¼å±•ç°å˜åŒ–å¹…åº¦ï¼Œä»è€Œå¿«é€Ÿè¯†åˆ«å¼‚å¸¸æ³¢åŠ¨ï¼›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90ae9e72314541a1a5d3ac9d918450aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236307&amp;x-signature=6ixaki0dLugufNuaoS2r5cipyAc%3D" alt="" loading="lazy"/></p>
<p>2ã€æ–°å»º<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fscene%2Fvisual-chart%2Fpie-chart%2F" target="_blank" title="https://docs.guance.com/scene/visual-chart/pie-chart/" ref="nofollow noopener noreferrer">é¥¼å›¾ï¼ˆç¯å½¢å›¾ï¼‰</a>æ—¶ï¼Œå½“å›¾ä¾‹å¤„äºééšè—çŠ¶æ€ï¼Œå¯é€‰æ‹©æ˜¯å¦æ˜¾ç¤º Value å€¼å’Œ Value ç™¾åˆ†æ¯”ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5d27720fc24400ba3b2b353e531530d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236307&amp;x-signature=Eg1xb7vg3dR3wHJr5j34LLhIqZI%3D" alt="" loading="lazy"/></p>
<p>3ã€å›¾è¡¨Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fscene%2Fvisual-chart%2Fbar-chart%2F%23y" target="_blank" title="https://docs.guance.com/scene/visual-chart/bar-chart/#y" ref="nofollow noopener noreferrer">Y è½´</a>ï¼šä¼˜åŒ–åŸå§‹æ•°å€¼å±•ç¤ºã€‚</p>
<h3 data-id="heading-5">å¿«ç…§</h3>
<p>1ã€å¿«ç…§åˆ—è¡¨æ ·å¼æ•´ä½“ä¼˜åŒ–ï¼›</p>
<p>2ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fplatform-capabilities%2Fsave-snapshot%2F%23begin-save-snapshot" target="_blank" title="https://docs.guance.com/platform-capabilities/save-snapshot/#begin-save-snapshot" ref="nofollow noopener noreferrer">ä¿å­˜å¿«ç…§</a>ï¼šæ–°å¢â€œä¿å­˜ä¸ºé™æ€æ—¶é—´â€è®¾ç½®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d8bf61c7ff7425ea0bca2cc9e211544~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236307&amp;x-signature=1%2BMijVF%2FpJAQTzDpKNSfoWLOAS8%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">æŒ‡æ ‡</h3>
<p>æŒ‡æ ‡åˆ†æï¼šæŸ¥è¯¢ç»“æœä¸­çš„æ•°å€¼æ–°å¢æ”¯æŒçµæ´»çš„æ˜¾ç¤ºæ ¼å¼è®¾ç½®ï¼Œå¯è®¾ç½®å°æ•°ä½æ•°å’Œå…¨ç²¾åº¦ç»“æœå±•ç¤ºã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a5112673ba64cfaa8f1443fbf150c11~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236307&amp;x-signature=8pztva6HFuW5d%2FAaeaWZOdhgCz8%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">ç®¡ç†</h3>
<p>1ã€è·¨å·¥ä½œç©ºé—´æˆæƒï¼šå½“æ•°æ®èŒƒå›´é€‰æ‹©â€œæŒ‡æ ‡â€æ—¶ï¼Œå¯å¯¹æŒ‡æ ‡æˆæƒèŒƒå›´è¿›è¡Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fmanagement%2Fdata-authorization%2F%23scope" target="_blank" title="https://docs.guance.com/management/data-authorization/#scope" ref="nofollow noopener noreferrer">ç»†åŒ–é…ç½®</a>ï¼›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b957c0e453f43b4b0460c2b2849218d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236307&amp;x-signature=lQjDUB%2FuG0j5F55%2BSCFrs%2F8t%2FGw%3D" alt="" loading="lazy"/></p>
<p>2ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.guance.com%2Fmanagement%2Fshare-management%2F" target="_blank" title="https://docs.guance.com/management/share-management/" ref="nofollow noopener noreferrer">åˆ†äº«ç®¡ç†</a>ï¼šæ–°å¢ç±»å‹å¿«é€Ÿç­›é€‰ã€æœç´¢æ¡†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29099d7557784884b4a769805708765b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-v6KeC5rWL5oCn55So6KeC5rWL5LqR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767236307&amp;x-signature=O3n9WtPfylKyF4%2FqPIELCTzvcCw%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-8">Pipelines</h3>
<p>æ¯ä¸ªæ•°æ®ç±»å‹æ–°å¢æ”¯æŒè®¾ç½®ä¸¤ä¸ªé»˜è®¤ Pipelineï¼ˆåŒ…æ‹¬æœ¬åœ°å’Œä¸­å¿ƒ Pipelineï¼‰ã€‚</p>
<h3 data-id="heading-9">Open API</h3>
<p>ä»ªè¡¨æ¿è·¨ç©ºé—´æŸ¥è¯¢æ—¶æ”¯æŒæŒ‡å®šé»˜è®¤é€‰ä¸­ç©ºé—´ã€‚</p>
<h2 data-id="heading-10">é›†æˆæ›´æ–°</h2>
<ul>
<li>æ–°å¢ GCP Storage é›†æˆï¼›</li>
<li>æ–°å¢ GCP Cloud SQLï¼ˆMySQLï¼‰é›†æˆï¼›</li>
<li>æ–°å¢é˜¿é‡Œäº‘ VPC å¯¹ç­‰è¿æ¥é›†æˆï¼›</li>
<li>æ–°å¢ AWS Lambda Trace é›†æˆï¼›</li>
<li>æ–°å¢é˜¿é‡Œäº‘ WAF åº”ç”¨é˜²ç«å¢™é›†æˆï¼›</li>
<li>è¡¥å……è…¾è®¯äº‘ Tencent CVM / KeewiDB è§†å›¾ï¼›</li>
<li>ä¿®å¤ Ingress-nginx-prom é›†æˆæ–‡æ¡£ä¸­å¤§å°å†™é—®é¢˜ï¼›</li>
<li>ä¿®å¤é›†æˆæ–‡æ¡£é—®é¢˜ï¼ˆåŒ…æ‹¬ä¸­è‹±æ–‡å­—ç¬¦åŠæ ¼å¼é—®é¢˜ï¼‰ï¼›</li>
<li>ä¿®å¤ TencentCloud å…¬ç½‘ CLB é‡‡é›†å™¨ä»¥æ”¯æŒéå…¬ç½‘ IPï¼›</li>
<li>ä¿®å¤ GCP äº‘ç›‘æ§ä¸­çº¿æ€§æ¡¶ï¼ˆlinearBucketsï¼‰æŒ‡æ ‡ Bugï¼›</li>
<li>æ–°å¢ CSPM è§„åˆ™ï¼šS3 å­˜å‚¨æ¡¶ç­–ç•¥åº”é™åˆ¶æ¥è‡ªå…¶ä»– AWS è´¦æˆ·çš„è®¿é—®ï¼›</li>
<li>æ–°å¢äº‘é›†æˆæ¨¡æ¿ï¼šAliyun CPFSã€Aliyun NLBã€HuaweiCloud EVSã€Aliyun CNAPIGatewayã€HuaweiCloud ROMAï¼›</li>
<li>æ–°å¢äº‘è„šæœ¬ï¼šGCP APIs é‡‡é›†å™¨ï¼›</li>
<li>æ–°å¢äº‘è„šæœ¬ï¼šGCP RUN é‡‡é›†å™¨ã€‚</li>
</ul>
<h2 data-id="heading-11">DataKit æ›´æ–°</h2>
<h3 data-id="heading-12">æ–°åŠ åŠŸèƒ½</h3>
<ul>
<li>æ–°å¢ Flameshot ç”¨ä»¥æ”¯æŒåŠ¨æ€ Profile é‡‡é›†</li>
<li>Cloud meta åŒæ­¥æ–°å¢ Google Cloud äº‘ä¸»æœºæ”¯æŒ</li>
</ul>
<h3 data-id="heading-13">é—®é¢˜ä¿®å¤</h3>
<ul>
<li>ä¼˜åŒ– Pipeline å¯¹ null å­—ç¬¦çš„å¤„ç†</li>
<li>ä¿®å¤ Redis ä¸»ä»æ¨¡å¼ä¸­ slow log é‡‡é›†é—®é¢˜</li>
<li>ä¿®å¤ Pipeline Refer table å¯èƒ½å´©æºƒçš„é—®é¢˜</li>
<li>ä¿®å¤ä¸€å¤„ logfwd service/source å­—æ®µé”™è¯¯é—®é¢˜</li>
<li>ä¿®å¤ OpenTelemetry æŒ‡æ ‡é‡‡é›†å¯¹ count ç±»æŒ‡æ ‡çš„å¤„ç†ï¼Œå¢åŠ é¢å¤–çš„ tagÂ <code>__temporality</code>ï¼Œä¾¿äº GuanceDB å¤„ç†</li>
<li>ä¿®å¤ DDTrace é‡‡é›†å™¨è‡ªå®šä¹‰ tag æ— æ•ˆé—®é¢˜</li>
</ul>
<h3 data-id="heading-14">åŠŸèƒ½ä¼˜åŒ–</h3>
<ul>
<li>ä¼˜åŒ– service å¯åŠ¨è¡Œä¸ºï¼Œåœ¨å¯åŠ¨è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°æŠ¥é”™ï¼Œä¼šè¾“å‡ºè·Ÿ service å¯åŠ¨æœ‰å…³çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä¾¿äºé”™è¯¯æ’æŸ¥</li>
<li>ä¼˜åŒ–åŸºäº Jolokia çš„ JVM å’Œ Kafka æŒ‡æ ‡é‡‡é›†</li>
<li>HTTP API ç™½åå•åŠŸèƒ½ä¼˜åŒ–ï¼Œå¢åŠ åŸºäºæ­£åˆ™çš„ç™½åå•é…ç½®å’Œç¦ç”¨ç™½åå•çš„é€‰é¡¹</li>
<li>ä¼˜åŒ– MongoDB é‡‡é›†ä¸­é”™è¯¯æ—¥å¿—å¤„ç†</li>
<li>ä¼˜åŒ– Redis é‡‡é›†ä¸­å…³äºæƒé™çš„è¯´æ˜</li>
<li>ä¼˜åŒ– DataKit è‡ªèº«æŒ‡æ ‡é‡‡é›†é…ç½®ï¼Œæ–°å¢ interval é…ç½®å…¥å£ï¼ŒåŒæ—¶ï¼Œè‡ªèº«æŒ‡æ ‡ä¸­æ–°å¢ eBPF è¿›ç¨‹æœ‰å…³çš„ CPU/å†…å­˜æŒ‡æ ‡é‡‡é›†</li>
<li>DDTrace/OpenTelemetry trace é‡‡é›†ä¸­æ–°å¢ Trace SDK åç§°/ç‰ˆæœ¬å·/è¯­è¨€/å…¬å…±å­—æ®µæå–</li>
<li>ä¸»æœºå¯¹è±¡é‡‡é›†æ”¯æŒè™šæ‹Ÿæœº/ç‰©ç†æœºæ£€æµ‹ï¼Œå¯æ®æ­¤è®¾å®šä¸åŒçš„é‡‡é›† tag</li>
</ul>
<h3 data-id="heading-15">å…¼å®¹è°ƒæ•´</h3>
<ul>
<li>Kafka é‡‡é›†å™¨åšäº†è¾ƒå¤§è°ƒæ•´ï¼Œåœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­æ‰€æœ‰æŒ‡æ ‡éƒ½å½’åˆ° kafka è¿™ä¸ªæŒ‡æ ‡é›†ä¸‹ï¼Œä¸”æ‰€æœ‰çš„æŒ‡æ ‡éƒ½æ ¹æ®å¯¹åº”çš„ MBean åç§°è‡ªåŠ¨æ¨å¯¼ï¼Œä¸ç”¨äººå·¥é…ç½®é‡‡é›†çš„ MBean ä»¥åŠå…¶å¯¹åº”çš„æŒ‡æ ‡å‘½å</li>
<li>ç§»é™¤äº† OpenTelemetry æŒ‡æ ‡é‡‡é›†æ—¶çš„ global tag è¿½åŠ </li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Function.prototype.bindå®ç°]]></title>    <link>https://juejin.cn/post/7587256133792022568</link>    <guid>https://juejin.cn/post/7587256133792022568</guid>    <pubDate>2025-12-25T01:19:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587256133792022568" data-draft-id="7587245616754589747" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Function.prototype.bindå®ç°"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-25T01:19:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·4939409522935"/> <meta itemprop="url" content="https://juejin.cn/user/2661285222166046"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Function.prototype.bindå®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2661285222166046/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·4939409522935
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T01:19:01.000Z" title="Thu Dec 25 2025 01:19:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç›®æ ‡</h2>
<p>å®ç°å‡½æ•°<code>Function.prototype.mybind</code>ï¼Œæ•ˆæœç­‰åŒäº<code>Function.prototype.bind</code></p>
<p>bindæ¥å—å‚æ•°ä¸ºï¼š<code>(thisArg, ...args)</code></p>
<h2 data-id="heading-1">å®ç°</h2>
<p>åˆ©ç”¨<code>apply</code>å‡½æ•°å®ç°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">mybind</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">thisArg, ...args</span>) {
  <span class="hljs-keyword">const</span> fn = <span class="hljs-variable language_">this</span>;
  
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">bound</span>(<span class="hljs-params">...innerArgs</span>) {
    <span class="hljs-keyword">const</span> context = (<span class="hljs-variable language_">this</span> <span class="hljs-keyword">instanceof</span> bound) ? <span class="hljs-variable language_">this</span> : thisArg;
  
    <span class="hljs-keyword">return</span> fn.<span class="hljs-title function_">apply</span>(context, [...args, ...innerArgs]);
  }
  
  <span class="hljs-keyword">if</span> (fn.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>){
    bound.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(fn.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
    bound.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = bound;
  }

  <span class="hljs-keyword">return</span> bound;
}
</code></pre>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªç»†èŠ‚ï¼Œå½“å¾—åˆ°äº†<code>bound = fn.bind(obj1)</code>åï¼Œå†æ¬¡è°ƒç”¨<code>bound2 = bound.bind(obj2)</code>ï¼Œä¼šå¿½ç•¥è¿™ä¸ª<code>bind</code>è°ƒç”¨ï¼Œ<code>bound2</code>ä¸<code>bound</code>è¿è¡Œæ—¶çš„<code>this</code>éƒ½æŒ‡å‘<code>obj1</code>ã€‚è¯¥è¡Œä¸ºæ‰‹å†™<code>bind</code>ä¸åŸå§‹<code>bind</code>è¡¨ç°ä¸€è‡´ã€‚</p>
<h2 data-id="heading-2">é—®é¢˜</h2>
<p><code>bound.prototype</code>åº”è¯¥ä¸º<code>undefined</code></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯Tokenæ— æ„Ÿåˆ·æ–°ï¼šè®©ç”¨æˆ·åƒåœ¨æ¸¸ä¹å›­ç•…ç©ä¸€æ ·æµç•…]]></title>    <link>https://juejin.cn/post/7587336857537478665</link>    <guid>https://juejin.cn/post/7587336857537478665</guid>    <pubDate>2025-12-25T01:41:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587336857537478665" data-draft-id="7587335187072417818" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯Tokenæ— æ„Ÿåˆ·æ–°ï¼šè®©ç”¨æˆ·åƒåœ¨æ¸¸ä¹å›­ç•…ç©ä¸€æ ·æµç•…"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-25T01:41:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JS_Likers"/> <meta itemprop="url" content="https://juejin.cn/user/1377017277975032"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯Tokenæ— æ„Ÿåˆ·æ–°ï¼šè®©ç”¨æˆ·åƒåœ¨æ¸¸ä¹å›­ç•…ç©ä¸€æ ·æµç•…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1377017277975032/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JS_Likers
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T01:41:35.000Z" title="Thu Dec 25 2025 01:41:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â¤ å†™åœ¨å‰é¢<br/>
å¦‚æœè§‰å¾—å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œç‚¹ä¸ªå°â¤â¤ å§ï¼Œä½ çš„æ”¯æŒæ˜¯å¯¹æˆ‘æœ€å¤§çš„é¼“åŠ±~<br/>
ä¸ªäººç‹¬ç«‹å¼€å‘wxå°ç¨‹åºï¼Œæ„Ÿè°¢æ”¯æŒï¼
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d25c4001b1b4e6e902dc1f8863bcef2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSlNfTGlrZXJz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231695&amp;x-signature=zkL4bG6Y6uSKgGKRAU%2BLmf6hZGU%3D" alt="small.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-0">ğŸª ä»æ¸¸ä¹å›­é—¨ç¥¨è¯´èµ·</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ å»æ¸¸ä¹å›­ç©ï¼Œé—¨ç¥¨ï¼ˆTokenï¼‰æœ‰ä¸€å®šæœ‰æ•ˆæœŸã€‚ä¼ ç»Ÿæ–¹å¼ä¸­ï¼Œé—¨ç¥¨è¿‡æœŸæ—¶ï¼š</p>
<ul>
<li>ä¿å®‰æ‹¦ä¸‹ä½ ï¼šâ€œç¥¨è¿‡æœŸäº†ï¼Œå»å”®ç¥¨å¤„é‡æ–°ä¹°ï¼â€</li>
<li>ä½ ä¸å¾—ä¸ç¦»å¼€é¡¹ç›®ï¼Œæ’é˜Ÿé‡æ–°ä¹°ç¥¨ï¼Œå†å›æ¥ç»§ç»­ç©</li>
</ul>
<p>è€Œ<strong>æ— æ„Ÿåˆ·æ–°</strong>å°±åƒæœ‰ä¸ªè´´å¿ƒåŠ©æ‰‹ï¼š</p>
<ul>
<li>é—¨ç¥¨å¿«è¿‡æœŸæ—¶ï¼ŒåŠ©æ‰‹æ‚„æ‚„å¸®ä½ ç»­æœŸ</li>
<li>ä½ å®Œå…¨æ„ŸçŸ¥ä¸åˆ°ï¼Œç»§ç»­ç•…ç©å„ä¸ªé¡¹ç›®</li>
</ul>
<p>è¿™å°±æ˜¯æˆ‘ä»¬ä»Šå¤©è¦å®ç°çš„ç”¨æˆ·ä½“éªŒï¼</p>
<h2 data-id="heading-1">ğŸ” ä¸ºä»€ä¹ˆéœ€è¦Tokenåˆ·æ–°ï¼Ÿ</h2>
<h3 data-id="heading-2">Tokençš„ç”Ÿå‘½å‘¨æœŸ</h3>
<pre><code class="hljs language-markdown" lang="markdown">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç™»å½•è·å–   â”‚â”€â”€â”€â”€â–¶â”‚  ä½¿ç”¨Token  â”‚â”€â”€â”€â”€â–¶â”‚  Tokenè¿‡æœŸ  â”‚
â”‚ AccessToken â”‚     â”‚  è®¿é—®æ¥å£   â”‚     â”‚   401é”™è¯¯   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<span class="hljs-code">                                              â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ ä¼ ç»Ÿæ–¹å¼ï¼š   â”‚â”€â”€â”€â”€â–¶â”‚ ç”¨æˆ·éœ€é‡æ–°  â”‚
                 â”‚ è·³è½¬ç™»å½•é¡µ  â”‚     â”‚    ç™»å½•     â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre>
<p><strong>é—®é¢˜æ¥äº†</strong>ï¼šæ¯æ¬¡Tokenè¿‡æœŸéƒ½è®©ç”¨æˆ·é‡æ–°ç™»å½•ï¼Œä½“éªŒæå·®ï¼</p>
<h2 data-id="heading-3">ğŸ¯ æ— æ„Ÿåˆ·æ–°çš„æ ¸å¿ƒæ€è·¯</h2>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[ç”¨æˆ·å‘èµ·è¯·æ±‚] --&gt; B{Tokenæ˜¯å¦æœ‰æ•ˆ?}
    B -- æœ‰æ•ˆ --&gt; C[æ­£å¸¸è¯·æ±‚]
    B -- å·²è¿‡æœŸ --&gt; D[æ‹¦æˆªè¯·æ±‚]
    D --&gt; E{æ˜¯å¦æ­£åœ¨åˆ·æ–°?}
    E -- å¦ --&gt; F[å‘èµ·åˆ·æ–°è¯·æ±‚]
    F --&gt; G[è·å–æ–°Token]
    G --&gt; H[é‡è¯•åŸè¯·æ±‚]
    E -- æ˜¯ --&gt; I[åŠ å…¥ç­‰å¾…é˜Ÿåˆ—]
    I --&gt; J[åˆ·æ–°å®Œæˆåé‡è¯•]
    C --&gt; K[è¿”å›æ•°æ®]
    H --&gt; K
    J --&gt; K
</code></pre>
<h2 data-id="heading-4">ğŸ’» å®æˆ˜ä»£ç å®ç°ï¼ˆåŸºäºaxiosï¼‰</h2>
<h3 data-id="heading-5">ç¬¬ä¸€æ­¥ï¼šåŸºç¡€é…ç½®</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// tokenManager.js</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TokenManager</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">accessToken</span> = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'access_token'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshToken</span> = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'refresh_token'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isRefreshing</span> = <span class="hljs-literal">false</span>; <span class="hljs-comment">// æ˜¯å¦æ­£åœ¨åˆ·æ–°</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">requestsQueue</span> = []; <span class="hljs-comment">// è¯·æ±‚ç­‰å¾…é˜Ÿåˆ—</span>
  }
  
  <span class="hljs-comment">// ä¿å­˜token</span>
  <span class="hljs-title function_">setTokens</span>(<span class="hljs-params">accessToken, refreshToken</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">accessToken</span> = accessToken;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshToken</span> = refreshToken;
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'access_token'</span>, accessToken);
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'refresh_token'</span>, refreshToken);
  }
  
  <span class="hljs-comment">// æ¸…é™¤token</span>
  <span class="hljs-title function_">clearTokens</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">accessToken</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">refreshToken</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">'access_token'</span>);
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">'refresh_token'</span>);
  }
}
</code></pre>
<h3 data-id="heading-6">ç¬¬äºŒæ­¥ï¼šaxiosæ‹¦æˆªå™¨è®¾ç½®</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// http.js</span>
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">TokenManager</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./tokenManager'</span>;

<span class="hljs-keyword">const</span> tokenManager = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TokenManager</span>();
<span class="hljs-keyword">const</span> http = axios.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">baseURL</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">VUE_APP_BASE_API</span>,
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>
});

<span class="hljs-comment">// è¯·æ±‚æ‹¦æˆªå™¨</span>
http.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(
  <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (tokenManager.<span class="hljs-property">accessToken</span>) {
      config.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">${tokenManager.accessToken}</span>`</span>;
    }
    <span class="hljs-keyword">return</span> config;
  },
  <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
  }
);

<span class="hljs-comment">// å“åº”æ‹¦æˆªå™¨ - æ ¸å¿ƒé€»è¾‘åœ¨è¿™é‡Œï¼</span>
http.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(
  <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
    <span class="hljs-comment">// æ­£å¸¸å“åº”ç›´æ¥è¿”å›</span>
    <span class="hljs-keyword">return</span> response;
  },
  <span class="hljs-keyword">async</span> (error) =&gt; {
    <span class="hljs-keyword">const</span> originalRequest = error.<span class="hljs-property">config</span>;
    
    <span class="hljs-comment">// å¦‚æœä¸æ˜¯401é”™è¯¯ï¼Œç›´æ¥è¿”å›</span>
    <span class="hljs-keyword">if</span> (error.<span class="hljs-property">response</span>?.<span class="hljs-property">status</span> !== <span class="hljs-number">401</span> || originalRequest.<span class="hljs-property">_retry</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
    }
    
    <span class="hljs-comment">// æ ‡è®°è¿™ä¸ªè¯·æ±‚å·²ç»é‡è¯•è¿‡ï¼Œé¿å…æ— é™å¾ªç¯</span>
    originalRequest.<span class="hljs-property">_retry</span> = <span class="hljs-literal">true</span>;
    
    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰refreshTokenï¼Œè·³è½¬åˆ°ç™»å½•é¡µ</span>
    <span class="hljs-keyword">if</span> (!tokenManager.<span class="hljs-property">refreshToken</span>) {
      tokenManager.<span class="hljs-title function_">clearTokens</span>();
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">'/login'</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);
    }
    
    <span class="hljs-comment">// å¦‚æœæ­£åœ¨åˆ·æ–°tokenï¼Œå°†è¯·æ±‚åŠ å…¥é˜Ÿåˆ—</span>
    <span class="hljs-keyword">if</span> (tokenManager.<span class="hljs-property">isRefreshing</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
        tokenManager.<span class="hljs-property">requestsQueue</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> {
          originalRequest.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">${tokenManager.accessToken}</span>`</span>;
          <span class="hljs-title function_">resolve</span>(<span class="hljs-title function_">http</span>(originalRequest));
        });
      });
    }
    
    <span class="hljs-comment">// å¼€å§‹åˆ·æ–°token</span>
    tokenManager.<span class="hljs-property">isRefreshing</span> = <span class="hljs-literal">true</span>;
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è°ƒç”¨åˆ·æ–°æ¥å£</span>
      <span class="hljs-keyword">const</span> { data } = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/auth/refresh'</span>, {
        <span class="hljs-attr">refresh_token</span>: tokenManager.<span class="hljs-property">refreshToken</span>
      });
      
      <span class="hljs-comment">// ä¿å­˜æ–°token</span>
      tokenManager.<span class="hljs-title function_">setTokens</span>(data.<span class="hljs-property">access_token</span>, data.<span class="hljs-property">refresh_token</span>);
      
      <span class="hljs-comment">// æ‰§è¡Œç­‰å¾…é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰è¯·æ±‚</span>
      tokenManager.<span class="hljs-property">requestsQueue</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">callback</span> =&gt;</span> <span class="hljs-title function_">callback</span>());
      tokenManager.<span class="hljs-property">requestsQueue</span> = [];
      
      <span class="hljs-comment">// é‡è¯•åŸå§‹è¯·æ±‚</span>
      originalRequest.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">${data.access_token}</span>`</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">http</span>(originalRequest);
      
    } <span class="hljs-keyword">catch</span> (refreshError) {
      <span class="hljs-comment">// åˆ·æ–°å¤±è´¥ï¼Œæ¸…é™¤tokenå¹¶è·³è½¬ç™»å½•</span>
      tokenManager.<span class="hljs-title function_">clearTokens</span>();
      tokenManager.<span class="hljs-property">requestsQueue</span> = [];
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">'/login'</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(refreshError);
    } <span class="hljs-keyword">finally</span> {
      tokenManager.<span class="hljs-property">isRefreshing</span> = <span class="hljs-literal">false</span>;
    }
  }
);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> http;
</code></pre>
<h3 data-id="heading-7">ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨ç¤ºä¾‹</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// userService.js</span>
<span class="hljs-keyword">import</span> http <span class="hljs-keyword">from</span> <span class="hljs-string">'./http'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">getUserInfo</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> http.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/user/info'</span>);
    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:'</span>, error);
    <span class="hljs-keyword">throw</span> error;
  }
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">updateProfile</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">data</span>) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> http.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/user/profile'</span>, data);
    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ›´æ–°èµ„æ–™å¤±è´¥:'</span>, error);
    <span class="hljs-keyword">throw</span> error;
  }
};
</code></pre>
<h2 data-id="heading-8">ğŸ¨ å¢å¼ºä½“éªŒï¼šæ·»åŠ è§†è§‰æç¤º</h2>
<p>è™½ç„¶è¯´æ˜¯"æ— æ„Ÿ"ï¼Œä½†é€‚å½“çš„æç¤ºèƒ½è®©ä½“éªŒæ›´å¥½ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœ¨åˆ·æ–°tokenæ—¶æ˜¾ç¤ºåŠ è½½æç¤º</span>
<span class="hljs-keyword">let</span> refreshLoading = <span class="hljs-literal">null</span>;

<span class="hljs-comment">// ä¿®æ”¹å“åº”æ‹¦æˆªå™¨ä¸­çš„åˆ·æ–°éƒ¨åˆ†</span>
<span class="hljs-keyword">try</span> {
  <span class="hljs-comment">// æ˜¾ç¤ºè½»é‡çº§æç¤º</span>
  refreshLoading = <span class="hljs-title function_">showLoading</span>(<span class="hljs-string">'æ­£åœ¨æ›´æ–°ç™»å½•çŠ¶æ€...'</span>);
  
  <span class="hljs-keyword">const</span> { data } = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/auth/refresh'</span>, {
    <span class="hljs-attr">refresh_token</span>: tokenManager.<span class="hljs-property">refreshToken</span>
  });
  
  <span class="hljs-comment">// éšè—æç¤º</span>
  refreshLoading?.<span class="hljs-title function_">hide</span>();
  <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'ç™»å½•çŠ¶æ€å·²æ›´æ–°'</span>, <span class="hljs-string">'success'</span>, <span class="hljs-number">2000</span>);
  
  <span class="hljs-comment">// ... å…¶ä½™é€»è¾‘</span>
} <span class="hljs-keyword">catch</span> (error) {
  refreshLoading?.<span class="hljs-title function_">hide</span>();
  <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•'</span>, <span class="hljs-string">'error'</span>);
  <span class="hljs-comment">// ... å…¶ä½™é”™è¯¯å¤„ç†</span>
}
</code></pre>
<h2 data-id="heading-9">ğŸ›¡ï¸ å®‰å…¨æ³¨æ„äº‹é¡¹</h2>
<ol>
<li><strong>Refresh Tokenæœ‰æ•ˆæœŸ</strong>ï¼šé€šå¸¸æ¯”Access Tokené•¿ï¼Œä½†ä¹Ÿä¸æ˜¯æ°¸ä¹…çš„</li>
<li><strong>å•æ¬¡ä½¿ç”¨</strong>ï¼šæ¯æ¬¡ä½¿ç”¨Refresh Tokenåï¼ŒæœåŠ¡ç«¯åº”è¯¥é¢å‘æ–°çš„Refresh Token</li>
<li><strong>å®‰å…¨å­˜å‚¨</strong>ï¼š
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨æ›´å®‰å…¨çš„æ–¹å¼å­˜å‚¨</span>
<span class="hljs-keyword">const</span> secureStorage = {
  <span class="hljs-attr">setItem</span>: <span class="hljs-function">(<span class="hljs-params">key, value</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">crypto</span> &amp;&amp; <span class="hljs-variable language_">window</span>.<span class="hljs-property">crypto</span>.<span class="hljs-property">subtle</span>) {
      <span class="hljs-comment">// è€ƒè™‘ä½¿ç”¨åŠ å¯†å­˜å‚¨</span>
      <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(key, value);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// é™çº§æ–¹æ¡ˆ</span>
      <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(key, value);
    }
  },
  <span class="hljs-attr">getItem</span>: <span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(key)
};
</code></pre>
</li>
</ol>
<h2 data-id="heading-10">ğŸª å›åˆ°æ¸¸ä¹å›­æ¯”å–»</h2>
<p>ç°åœ¨æˆ‘ä»¬çš„ç³»ç»Ÿå°±åƒè¿™æ ·å·¥ä½œï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">æ¸¸ä¹å›­é¡¹ç›®ï¼ˆAPIè¯·æ±‚ï¼‰ â†’ æ£€ç¥¨å£ï¼ˆæ‹¦æˆªå™¨ï¼‰
<span class="hljs-code">    â”‚
    â”œâ”€â”€ ç¥¨æœ‰æ•ˆ â†’ ç›´æ¥è¿›å…¥
    â”‚
    â”œâ”€â”€ ç¥¨è¿‡æœŸï¼Œæœ‰ç»­ç¥¨èµ„æ ¼ â†’ åŠ©æ‰‹æ‚„æ‚„ç»­ç¥¨ â†’ ç»§ç»­æ¸¸ç©
    â”‚
    â””â”€â”€ ç¥¨è¿‡æœŸï¼Œæ— ç»­ç¥¨èµ„æ ¼ â†’ å¼•å¯¼é‡æ–°è´­ç¥¨ï¼ˆç™»å½•ï¼‰
</span></code></pre>
<h2 data-id="heading-11">ğŸ“Š æ€§èƒ½ä¼˜åŒ–å°è´´å£«</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. é¢„åˆ·æ–°ï¼šåœ¨tokenå³å°†è¿‡æœŸæ—¶æå‰åˆ·æ–°</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">shouldRefreshToken</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> tokenExpiry = <span class="hljs-title function_">getTokenExpiry</span>(tokenManager.<span class="hljs-property">accessToken</span>);
  <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
  <span class="hljs-comment">// åœ¨è¿‡æœŸå‰5åˆ†é’Ÿå¼€å§‹åˆ·æ–°</span>
  <span class="hljs-keyword">return</span> tokenExpiry - now &lt; <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>;
};

<span class="hljs-comment">// 2. å®šæ—¶æ£€æŸ¥</span>
<span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">shouldRefreshToken</span>() &amp;&amp; !tokenManager.<span class="hljs-property">isRefreshing</span>) {
    <span class="hljs-title function_">refreshTokenSilently</span>();
  }
}, <span class="hljs-number">60000</span>); <span class="hljs-comment">// æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡</span>

<span class="hljs-comment">// 3. å¹¶å‘æ§åˆ¶ä¼˜åŒ–</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MAX_QUEUE_SIZE</span> = <span class="hljs-number">50</span>;
<span class="hljs-keyword">if</span> (tokenManager.<span class="hljs-property">requestsQueue</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-variable constant_">MAX_QUEUE_SIZE</span>) {
  <span class="hljs-comment">// é˜Ÿåˆ—è¿‡é•¿ï¼Œå¯èƒ½æ˜¯å¼‚å¸¸æƒ…å†µ</span>
  tokenManager.<span class="hljs-property">requestsQueue</span> = [];
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-title function_">reload</span>(); <span class="hljs-comment">// æˆ–é‡‡å–å…¶ä»–æ¢å¤æªæ–½</span>
}
</code></pre>
<h2 data-id="heading-12">ğŸ‰ æ€»ç»“</h2>
<p>å®ç°Tokenæ— æ„Ÿåˆ·æ–°çš„å…³é”®åœ¨äºï¼š</p>
<ol>
<li><strong>æ‹¦æˆª401é”™è¯¯</strong>ï¼šåœ¨axioså“åº”æ‹¦æˆªå™¨ä¸­æ•è·</li>
<li><strong>é¿å…å¹¶å‘åˆ·æ–°</strong>ï¼šç”¨æ ‡å¿—ä½å’Œé˜Ÿåˆ—æ§åˆ¶</li>
<li><strong>ä¼˜é›…é™çº§</strong>ï¼šåˆ·æ–°å¤±è´¥æ—¶å‹å¥½å¼•å¯¼é‡æ–°ç™»å½•</li>
<li><strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼šé€‚å½“çš„æç¤ºï¼ˆä½†ä¸æ˜¯æ‰“æ–­ï¼‰</li>
</ol>
<p>ç°åœ¨ä½ çš„åº”ç”¨å°±åƒé‚£ä¸ªè´´å¿ƒçš„æ¸¸ä¹å›­åŠ©æ‰‹ï¼Œè®©ç”¨æˆ·åœ¨ä¸çŸ¥ä¸è§‰ä¸­ä¿æŒç™»å½•çŠ¶æ€ï¼Œäº«å—æµç•…çš„ä½“éªŒï¼</p>
<p>è¯•è¯•å®ç°å®ƒï¼Œè®©ä½ çš„åº”ç”¨å‘Šåˆ«çƒ¦äººçš„"ç™»å½•å·²è¿‡æœŸ"æç¤ºå§ï¼ğŸš€</p>
<hr/>
<p><strong>å°ä½œä¸š</strong>ï¼šä½ èƒ½æƒ³åˆ°åœ¨å“ªäº›åœºæ™¯ä¸‹ï¼Œå³ä½¿å®ç°äº†æ— æ„Ÿåˆ·æ–°ï¼Œä»ç„¶éœ€è¦ä¸»åŠ¨æç¤ºç”¨æˆ·é‡æ–°ç™»å½•å—ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„æƒ³æ³•ï¼ğŸ’­</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[oaæµç¨‹åˆ°è¾¾æŸä¸ªèŠ‚ç‚¹ä¹‹åè§¦å‘è‡ªå®šä¹‰åŠ¨ä½œ(å¤–éƒ¨æ¥å£)]]></title>    <link>https://juejin.cn/post/7587313610696425499</link>    <guid>https://juejin.cn/post/7587313610696425499</guid>    <pubDate>2025-12-25T02:59:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587313610696425499" data-draft-id="7587325326046150665" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="oaæµç¨‹åˆ°è¾¾æŸä¸ªèŠ‚ç‚¹ä¹‹åè§¦å‘è‡ªå®šä¹‰åŠ¨ä½œ(å¤–éƒ¨æ¥å£)"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-25T02:59:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hyinglin"/> <meta itemprop="url" content="https://juejin.cn/user/2362231708723822"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            oaæµç¨‹åˆ°è¾¾æŸä¸ªèŠ‚ç‚¹ä¹‹åè§¦å‘è‡ªå®šä¹‰åŠ¨ä½œ(å¤–éƒ¨æ¥å£)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2362231708723822/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Hyinglin
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T02:59:05.000Z" title="Thu Dec 25 2025 02:59:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ç¬¬ä¸€ç§æ–¹æ¡ˆï¼ˆæ¨èï¼‰<br/>
åœ¨å½’æ¡£èŠ‚ç‚¹å‰æ·»åŠ è‡ªå®šä¹‰é™„åŠ æ“ä½œå°±å¯ä»¥ï¼ˆoaå‰å°ç›´æ¥è°ƒç”¨å¤–éƒ¨æ¥å£å³å¯ï¼‰</p>
</blockquote>
<blockquote>
<p>ç¬¬äºŒç§æ–¹æ¡ˆï¼ˆä¸æ¨èï¼Œç”¨æ¥æ‰©å±•æ€è·¯ï¼‰<br/>
æ•°æ®åº“è½®è¯¢ç‰ˆ</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€æ•°æ®åº“è½®è¯¢ç‰ˆ-æ•´ä½“æ€è·¯</h2>
<h4 data-id="heading-1">æ ¸å¿ƒæ€æƒ³ï¼ˆéå¸¸é‡è¦ï¼‰</h4>
<blockquote>
<p><strong>ä¸è¦ç›´æ¥æ‰«â€œå·²ç»“æŸæµç¨‹â€</strong><br/>
è€Œæ˜¯ï¼š<br/>
ğŸ‘‰ <strong>â€œæ‰¾å‡ºã€åˆšåˆšç»“æŸã€ã€ä¸”ã€è¿˜æ²¡é€šçŸ¥è¿‡ã€çš„æµç¨‹å®ä¾‹â€</strong></p>
</blockquote>
<p>æ‰€ä»¥ä¸€å®šè¦æœ‰ <strong>å»é‡æ ‡è®°</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-2">æ€»ä½“æ¶æ„</h3>
<pre><code class="hljs language-markdown" lang="markdown">Spring Boot å®šæ—¶ä»»åŠ¡
<span class="hljs-code">        â†“
æŸ¥è¯¢ OA æ•°æ®åº“
        â†“
æ‰¾å‡ºã€å‚å¤–è°ƒæ‹¨æµç¨‹ã€‘ä¸­
ã€å®¡æ‰¹å®Œæˆ &amp; æœªé€šçŸ¥ã€‘çš„ requestId
        â†“
å‘é€é£ä¹¦ç¾¤é€šçŸ¥
        â†“
è®°å½•é€šçŸ¥æ—¥å¿—ï¼ˆé˜²é‡å¤ï¼‰
</span></code></pre>
<hr/>
<h2 data-id="heading-3">äºŒã€ä½ å¿…é¡»çŸ¥é“çš„ 3 å¼ å…³é”®è¡¨ï¼ˆe-cology 9ï¼‰</h2>
<blockquote>
<p>âš ï¸ è¡¨ååœ¨ä¸åŒå®¢æˆ·å¯èƒ½ç•¥æœ‰å·®å¼‚ï¼Œä½† <strong>ä¸‹é¢è¿™å‡ å¼  90% éƒ½å­˜åœ¨</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-4">1ï¸âƒ£ workflow_requestbaseï¼ˆæµç¨‹å®ä¾‹ä¸»è¡¨ï¼‰</h3>
<p>è¿™æ˜¯æœ€é‡è¦çš„ã€‚</p>
<p>å¸¸ç”¨å­—æ®µï¼š</p>





























<table><thead><tr><th>å­—æ®µ</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>requestid</td><td>æµç¨‹å®ä¾‹ ID</td></tr><tr><td>workflowid</td><td>æµç¨‹æ¨¡æ¿ ID</td></tr><tr><td>currentstatus</td><td>æµç¨‹çŠ¶æ€</td></tr><tr><td>lastoperatedate</td><td>æœ€åæ“ä½œæ—¥æœŸ</td></tr><tr><td>lastoperatetime</td><td>æœ€åæ“ä½œæ—¶é—´</td></tr></tbody></table>
<h4 data-id="heading-5">currentstatus å¸¸è§å€¼ï¼ˆç»éªŒï¼‰</h4>

























<table><thead><tr><th>å€¼</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>0</td><td>è¿è¡Œä¸­</td></tr><tr><td>1</td><td>æ­£å¸¸ç»“æŸï¼ˆå®¡æ‰¹é€šè¿‡ï¼‰</td></tr><tr><td>2</td><td>å¼ºåˆ¶ç»“æŸ</td></tr><tr><td>3</td><td>é€€å›</td></tr></tbody></table>
<p>ğŸ‘‰ <strong>ä½ åªè¦ <code>currentstatus = 1</code></strong></p>
<hr/>
<h3 data-id="heading-6">2ï¸âƒ£ workflow_baseï¼ˆæµç¨‹æ¨¡æ¿è¡¨ï¼‰</h3>
<p>ç”¨æ¥ç¡®è®¤æµç¨‹åï¼ˆå¯é€‰ï¼‰</p>

















<table><thead><tr><th>å­—æ®µ</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>id</td><td>workflowId</td></tr><tr><td>workflowname</td><td>æµç¨‹åç§°</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-7">3ï¸âƒ£ ä½ è‡ªå·±å»ºçš„è¡¨ï¼ˆå¼ºçƒˆæ¨èï¼‰</h3>
<h4 data-id="heading-8">oa_notify_logï¼ˆé˜²é‡å¤ï¼‰</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> oa_notify_log (
  request_id <span class="hljs-type">int</span> <span class="hljs-keyword">primary</span> key,
  workflow_id <span class="hljs-type">int</span>,
  notify_time datetime
);
</code></pre>
<blockquote>
<p>â— <strong>è¿™æ˜¯æ•´ä¸ªæ–¹æ¡ˆæ˜¯å¦â€œèƒ½é•¿æœŸç”¨â€çš„å…³é”®</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-9">ä¸‰ã€SQLï¼šæ‰¾å‡ºã€Œåˆšåˆšå®¡æ‰¹å®Œæˆã€çš„æµç¨‹</h2>
<h4 data-id="heading-10">æ ¸å¿ƒ SQLï¼ˆé‡ç‚¹çœ‹ï¼‰</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">select</span> r.requestid,
       r.workflowid,
       r.lastoperatedate,
       r.lastoperatetime
<span class="hljs-keyword">from</span> workflow_requestbase r
<span class="hljs-keyword">where</span> r.workflowid <span class="hljs-operator">=</span> <span class="hljs-number">456</span>            <span class="hljs-comment">-- å‚å¤–è°ƒæ‹¨æµç¨‹ID</span>
  <span class="hljs-keyword">and</span> r.currentstatus <span class="hljs-operator">=</span> <span class="hljs-string">'1'</span>         <span class="hljs-comment">-- å®¡æ‰¹é€šè¿‡</span>
  <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span> (
      <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>
      <span class="hljs-keyword">from</span> oa_notify_log n
      <span class="hljs-keyword">where</span> n.request_id <span class="hljs-operator">=</span> r.requestid
  )
</code></pre>
<p>ğŸ“Œ <strong>è§£é‡Š</strong>ï¼š</p>
<ul>
<li>åªæŸ¥ä½ å…³å¿ƒçš„æµç¨‹</li>
<li>åªè¦â€œå®¡æ‰¹é€šè¿‡â€çš„</li>
<li><strong>æ’é™¤å·²ç»é€šçŸ¥è¿‡çš„</strong></li>
</ul>
<hr/>
<h2 data-id="heading-11">å››ã€Spring Boot 3 å®ç°ï¼ˆå®Œæ•´å¯ç”¨ç¤ºä¾‹ï¼‰</h2>
<h3 data-id="heading-12">1ï¸âƒ£ å®šæ—¶ä»»åŠ¡é…ç½®</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@EnableScheduling</span>
<span class="hljs-variable">@Configuration</span>
public class ScheduleConfig {
}
</code></pre>
<hr/>
<h3 data-id="heading-13">2ï¸âƒ£ å®šæ—¶æ‰«æä»»åŠ¡</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OaWorkflowScanJob</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">JdbcTemplate</span> jdbcTemplate;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">FeishuService</span> feishuService;

    <span class="hljs-meta">@Scheduled</span>(cron = <span class="hljs-string">"0 */1 * * * ?"</span>) <span class="hljs-comment">// æ¯ 1 åˆ†é’Ÿæ‰«ä¸€æ¬¡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">scanFinishedWorkflow</span>(<span class="hljs-params"/>) {

        <span class="hljs-title class_">String</span> sql = <span class="hljs-string">""</span><span class="hljs-string">"
            select requestid
            from workflow_requestbase
            where workflowid = ?
              and currentstatus = '1'
              and not exists (
                select 1 from oa_notify_log
                where request_id = workflow_requestbase.requestid
              )
        "</span><span class="hljs-string">""</span>;

        <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">Integer</span>&gt; requestIds =
            jdbcTemplate.<span class="hljs-title function_">queryForList</span>(sql, <span class="hljs-title class_">Integer</span>.<span class="hljs-property">class</span>, <span class="hljs-number">456</span>);

        <span class="hljs-keyword">for</span> (<span class="hljs-title class_">Integer</span> requestId : requestIds) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// 1. å‘é€é£ä¹¦</span>
                feishuService.<span class="hljs-title function_">send</span>(<span class="hljs-title function_">buildMsg</span>(requestId));

                <span class="hljs-comment">// 2. è®°å½•å·²é€šçŸ¥</span>
                <span class="hljs-title function_">saveNotifyLog</span>(requestId);

            } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Exception</span> e) {
                <span class="hljs-comment">// å¤±è´¥ä¸å†™ logï¼Œä¸‹æ¬¡è¿˜ä¼šå†å‘</span>
                e.<span class="hljs-title function_">printStackTrace</span>();
            }
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">saveNotifyLog</span>(<span class="hljs-params">Integer requestId</span>) {
        jdbcTemplate.<span class="hljs-title function_">update</span>(
            <span class="hljs-string">"insert into oa_notify_log(request_id, workflow_id, notify_time) values (?, ?, getdate())"</span>,
            requestId, <span class="hljs-number">456</span>
        );
    }

    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">buildMsg</span>(<span class="hljs-params">Integer requestId</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"ã€å‚å¤–è°ƒæ‹¨æµç¨‹ã€‘å®¡æ‰¹å·²é€šè¿‡\næµç¨‹IDï¼š"</span> + requestId;
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-14">3ï¸âƒ£ é£ä¹¦å‘é€ï¼ˆç®€ç‰ˆï¼‰</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FeishuService</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> final <span class="hljs-title class_">String</span> <span class="hljs-variable constant_">WEBHOOK</span> =
        <span class="hljs-string">"https://open.feishu.cn/open-apis/bot/v2/hook/xxxx"</span>;

    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">RestTemplate</span> restTemplate = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RestTemplate</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">send</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> text</span>) {
        <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; body = <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
            <span class="hljs-string">"msg_type"</span>, <span class="hljs-string">"text"</span>,
            <span class="hljs-string">"content"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"text"</span>, text)
        );
        restTemplate.<span class="hljs-title function_">postForObject</span>(<span class="hljs-variable constant_">WEBHOOK</span>, body, <span class="hljs-title class_">String</span>.<span class="hljs-property">class</span>);
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-15">äº”ã€ä½ è¿™ä¸ªæ–¹æ¡ˆä¸€å®šè¦åŠ çš„ 4 ä¸ªâ€œä¿é™©â€</h2>
<h4 data-id="heading-16">âœ… 1ï¸âƒ£ å¿…é¡»ç”¨ <code>oa_notify_log</code></h4>
<p>å¦åˆ™ <strong>ä¸€å®šä¼šé‡å¤å‘</strong></p>
<hr/>
<h4 data-id="heading-17">âœ… 2ï¸âƒ£ å®šæ—¶é¢‘ç‡ä¸è¦å¤ªé«˜</h4>
<ul>
<li>æ¨èï¼š<strong>1ï½3 åˆ†é’Ÿ</strong></li>
<li>ä¸è¦ç§’çº§</li>
</ul>
<hr/>
<h4 data-id="heading-18">âœ… 3ï¸âƒ£ åªè®¤ <code>currentstatus = 1</code></h4>
<p>ä¸è¦è‡ªå·±çŒœå…¶ä»–çŠ¶æ€</p>
<hr/>
<h4 data-id="heading-19">âœ… 4ï¸âƒ£ é£ä¹¦å¤±è´¥ä¸è¦å†™ log</h4>
<p>è®©ä¸‹æ¬¡å®šæ—¶ä»»åŠ¡è¡¥å‘</p>
<hr/>
<h2 data-id="heading-20">å…­ã€è¿™ä¸ªæ–¹æ¡ˆçš„â€œå®¢è§‚ç¼ºç‚¹â€ï¼ˆæˆ‘å¿…é¡»å‘Šè¯‰ä½ ï¼‰</h2>

























<table><thead><tr><th>ç‚¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>å»¶è¿Ÿ</td><td>æœ€å¿« 1 åˆ†é’Ÿ</td></tr><tr><td>å¼ºåˆ¶ç»“æŸè¦é¢å¤–åˆ¤æ–­</td><td>currentstatus = 2</td></tr><tr><td>è¡¨ç»“æ„å‡çº§é£é™©</td><td>æœ‰</td></tr><tr><td>å¹¶å‘é«˜æ—¶å‹åŠ›å¤§</td><td>æœ‰</td></tr></tbody></table>
<p>ğŸ‘‰ <strong>ä½†åœ¨â€œä¸èƒ½ç”¨ Actionâ€çš„å‰æä¸‹ï¼Œè¿™æ˜¯æœ€ç¨³çš„ä¸€ç§</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[vue ç”˜ç‰¹å›¾ vxe-gantt ä»»åŠ¡é‡Œç¨‹ç¢‘å’Œä¾èµ–çº¿çš„ä½¿ç”¨]]></title>    <link>https://juejin.cn/post/7587277503947063296</link>    <guid>https://juejin.cn/post/7587277503947063296</guid>    <pubDate>2025-12-25T01:45:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587277503947063296" data-draft-id="7587277503947046912" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="vue ç”˜ç‰¹å›¾ vxe-gantt ä»»åŠ¡é‡Œç¨‹ç¢‘å’Œä¾èµ–çº¿çš„ä½¿ç”¨"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2025-12-25T01:45:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·84179481456"/> <meta itemprop="url" content="https://juejin.cn/user/3921272428567529"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            vue ç”˜ç‰¹å›¾ vxe-gantt ä»»åŠ¡é‡Œç¨‹ç¢‘å’Œä¾èµ–çº¿çš„ä½¿ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3921272428567529/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·84179481456
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T01:45:20.000Z" title="Thu Dec 25 2025 01:45:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>vue ç”˜ç‰¹å›¾ vxe-gantt ä»»åŠ¡é‡Œç¨‹ç¢‘å’Œä¾èµ–çº¿çš„ä½¿ç”¨</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgantt.vxeui.com%2F" target="_blank" title="https://gantt.vxeui.com/" ref="nofollow noopener noreferrer">gantt.vxeui.com/</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aaf0d885ac1d46f482bae83c00ab625c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODQxNzk0ODE0NTY=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231920&amp;x-signature=%2Bo16%2FpZrEIHWJ2l0lIaJ371OJpc%3D" alt="extend_gantt_chart_gantt_milestone_links" loading="lazy"/></p>
<p>é€šè¿‡è®¾ç½® task-bar-milestone-config å’Œ type=moveable å¯ç”¨é‡Œç¨‹ç¢‘ç±»å‹ï¼Œå½“è®¾ç½®ä¸ºé‡Œç¨‹ç¢‘ç±»å‹æ—¶ï¼Œåªéœ€è¦è®¾ç½® start å¼€å§‹æ—¥æœŸå°±å¯ä»¥ï¼Œæ— éœ€è®¾ç½® end ç»“æŸæ—¥æœŸï¼Œè®¾ç½® links å®šä¹‰è¿æ¥çº¿,from å¯¹åº”æºä»»åŠ¡çš„è¡Œä¸»é”®,tom å¯¹åº”ç›®æ ‡ä»»åŠ¡çš„è¡Œä¸»é”®</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">vxe-gantt</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"ganttOptions"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">vxe-gantt</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">VxeGanttDependencyType</span>, <span class="hljs-title class_">VxeGanttTaskType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vxe-gantt'</span>

<span class="hljs-keyword">const</span> ganttOptions = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">border</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">height</span>: <span class="hljs-number">500</span>,
  <span class="hljs-attr">rowConfig</span>: {
    <span class="hljs-attr">keyField</span>: <span class="hljs-string">'id'</span> <span class="hljs-comment">// è¡Œä¸»é”®</span>
  },
  <span class="hljs-attr">taskBarConfig</span>: {
    <span class="hljs-attr">showProgress</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ˜¯å¦æ˜¾ç¤ºè¿›åº¦æ¡</span>
    <span class="hljs-attr">showContent</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ˜¯å¦åœ¨ä»»åŠ¡æ¡æ˜¾ç¤ºå†…å®¹</span>
    <span class="hljs-attr">moveable</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ˜¯å¦å…è®¸æ‹–æ‹½ä»»åŠ¡ç§»åŠ¨æ—¥æœŸ</span>
    <span class="hljs-attr">resizable</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ˜¯å¦å…è®¸æ‹–æ‹½ä»»åŠ¡è°ƒæ•´æ—¥æœŸ</span>
    <span class="hljs-attr">barStyle</span>: {
      <span class="hljs-attr">round</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// åœ†è§’</span>
      <span class="hljs-attr">bgColor</span>: <span class="hljs-string">'#fca60b'</span>, <span class="hljs-comment">// ä»»åŠ¡æ¡çš„èƒŒæ™¯é¢œè‰²</span>
      <span class="hljs-attr">completedBgColor</span>: <span class="hljs-string">'#65c16f'</span> <span class="hljs-comment">// å·²å®Œæˆéƒ¨åˆ†ä»»åŠ¡æ¡çš„èƒŒæ™¯é¢œè‰²</span>
    }
  },
  <span class="hljs-attr">taskViewConfig</span>: {
    <span class="hljs-attr">tableStyle</span>: {
      <span class="hljs-attr">width</span>: <span class="hljs-number">280</span> <span class="hljs-comment">// è¡¨æ ¼å®½åº¦</span>
    },
    <span class="hljs-attr">gridding</span>: {
      <span class="hljs-attr">leftSpacing</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// å·¦ä¾§é—´è·å¤šå°‘åˆ—</span>
      <span class="hljs-attr">rightSpacing</span>: <span class="hljs-number">4</span> <span class="hljs-comment">// å³ä¾§é—´è·å¤šå°‘åˆ—</span>
    }
  },
  <span class="hljs-attr">taskBarMilestoneConfig</span>: {
    <span class="hljs-comment">// è‡ªå®šä¹‰é‡Œç¨‹ç¢‘å›¾æ ‡</span>
    icon ({ row }) {
      <span class="hljs-keyword">if</span> (row.<span class="hljs-property">id</span> === <span class="hljs-number">10001</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'vxe-icon-warning-triangle-fill'</span>
      }
      <span class="hljs-keyword">if</span> (row.<span class="hljs-property">id</span> === <span class="hljs-number">10007</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'vxe-icon-square-fill'</span>
      }
      <span class="hljs-keyword">if</span> (row.<span class="hljs-property">id</span> === <span class="hljs-number">10009</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'vxe-icon-warning-circle-fill'</span>
      }
      <span class="hljs-keyword">return</span> <span class="hljs-string">'vxe-icon-radio-unchecked-fill'</span>
    },
    <span class="hljs-comment">// è‡ªå®šä¹‰é‡Œç¨‹ç¢‘å›¾æ ‡æ ·å¼</span>
    iconStyle ({ row }) {
      <span class="hljs-keyword">if</span> (row.<span class="hljs-property">id</span> === <span class="hljs-number">10001</span>) {
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">color</span>: <span class="hljs-string">'#65c16f'</span>
        }
      }
      <span class="hljs-keyword">if</span> (row.<span class="hljs-property">id</span> === <span class="hljs-number">10007</span>) {
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">color</span>: <span class="hljs-string">'#dc3cc7'</span>
        }
      }
    }
  },
  <span class="hljs-attr">taskLinkConfig</span>: {
    <span class="hljs-attr">lineType</span>: <span class="hljs-string">'flowDashed'</span>
  },
  <span class="hljs-attr">links</span>: [
    { <span class="hljs-attr">from</span>: <span class="hljs-number">10001</span>, <span class="hljs-attr">to</span>: <span class="hljs-number">10002</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">VxeGanttDependencyType</span>.<span class="hljs-property">StartToFinish</span> },
    { <span class="hljs-attr">from</span>: <span class="hljs-number">10003</span>, <span class="hljs-attr">to</span>: <span class="hljs-number">10004</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">VxeGanttDependencyType</span>.<span class="hljs-property">StartToStart</span> },
    { <span class="hljs-attr">from</span>: <span class="hljs-number">10007</span>, <span class="hljs-attr">to</span>: <span class="hljs-number">10008</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">VxeGanttDependencyType</span>.<span class="hljs-property">StartToStart</span> },
    { <span class="hljs-attr">from</span>: <span class="hljs-number">10008</span>, <span class="hljs-attr">to</span>: <span class="hljs-number">10009</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">VxeGanttDependencyType</span>.<span class="hljs-property">FinishToFinish</span> },
    { <span class="hljs-attr">from</span>: <span class="hljs-number">10009</span>, <span class="hljs-attr">to</span>: <span class="hljs-number">10010</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">VxeGanttDependencyType</span>.<span class="hljs-property">FinishToStart</span> }
  ],
  <span class="hljs-attr">columns</span>: [
    { <span class="hljs-attr">type</span>: <span class="hljs-string">'seq'</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">70</span> },
    { <span class="hljs-attr">field</span>: <span class="hljs-string">'title'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'ä»»åŠ¡åç§°'</span> }
  ],
  <span class="hljs-attr">data</span>: [
    { <span class="hljs-attr">id</span>: <span class="hljs-number">10001</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'é¡¹ç›®å¯åŠ¨ä¼šè®®'</span>, <span class="hljs-attr">start</span>: <span class="hljs-string">'2024-03-01'</span>, <span class="hljs-attr">end</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">progress</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">VxeGanttTaskType</span>.<span class="hljs-property">Milestone</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">10002</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'é¡¹ç›®å¯åŠ¨ä¸è®¡åˆ’'</span>, <span class="hljs-attr">start</span>: <span class="hljs-string">'2024-03-03'</span>, <span class="hljs-attr">end</span>: <span class="hljs-string">'2024-03-08'</span>, <span class="hljs-attr">progress</span>: <span class="hljs-number">80</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">''</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">10003</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'éœ€æ±‚è¯„å®¡å®Œæˆ'</span>, <span class="hljs-attr">start</span>: <span class="hljs-string">'2024-03-03'</span>, <span class="hljs-attr">end</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">progress</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">VxeGanttTaskType</span>.<span class="hljs-property">Milestone</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">10004</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'æŠ€æœ¯åŠæ–¹æ¡ˆè®¾è®¡'</span>, <span class="hljs-attr">start</span>: <span class="hljs-string">'2024-03-05'</span>, <span class="hljs-attr">end</span>: <span class="hljs-string">'2024-03-11'</span>, <span class="hljs-attr">progress</span>: <span class="hljs-number">80</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">''</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">10005</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'åŠŸèƒ½å¼€å‘'</span>, <span class="hljs-attr">start</span>: <span class="hljs-string">'2024-03-08'</span>, <span class="hljs-attr">end</span>: <span class="hljs-string">'2024-03-15'</span>, <span class="hljs-attr">progress</span>: <span class="hljs-number">70</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">''</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">10007</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'æµ‹è¯•ç¯å¢ƒå‘å¸ƒ'</span>, <span class="hljs-attr">start</span>: <span class="hljs-string">'2024-03-11'</span>, <span class="hljs-attr">end</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">progress</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">VxeGanttTaskType</span>.<span class="hljs-property">Milestone</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">10008</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'ç³»ç»Ÿæµ‹è¯•'</span>, <span class="hljs-attr">start</span>: <span class="hljs-string">'2024-03-14'</span>, <span class="hljs-attr">end</span>: <span class="hljs-string">'2024-03-19'</span>, <span class="hljs-attr">progress</span>: <span class="hljs-number">80</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">''</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">10009</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'æµ‹è¯•å®Œæˆ'</span>, <span class="hljs-attr">start</span>: <span class="hljs-string">'2024-03-19'</span>, <span class="hljs-attr">end</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">progress</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">VxeGanttTaskType</span>.<span class="hljs-property">Milestone</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">10010</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'æ­£å¼å‘å¸ƒä¸Šçº¿'</span>, <span class="hljs-attr">start</span>: <span class="hljs-string">'2024-03-20'</span>, <span class="hljs-attr">end</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">progress</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">VxeGanttTaskType</span>.<span class="hljs-property">Milestone</span> }
  ]
})
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fx-extends%2Fvxe-gantt" target="_blank" title="https://gitee.com/x-extends/vxe-gantt" ref="nofollow noopener noreferrer">gitee.com/x-extends/vâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[localStorageä½¿ç”¨ä¸æ­¢äºgetItemã€setItemã€removeItem]]></title>    <link>https://juejin.cn/post/7587299670642556934</link>    <guid>https://juejin.cn/post/7587299670642556934</guid>    <pubDate>2025-12-25T01:49:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587299670642556934" data-draft-id="7587299670642491398" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="localStorageä½¿ç”¨ä¸æ­¢äºgetItemã€setItemã€removeItem"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-25T01:49:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¿½æ¢¦_life"/> <meta itemprop="url" content="https://juejin.cn/user/430664286745271"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            localStorageä½¿ç”¨ä¸æ­¢äºgetItemã€setItemã€removeItem
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/430664286745271/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¿½æ¢¦_life
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T01:49:19.000Z" title="Thu Dec 25 2025 01:49:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä»Šå¤©æˆ‘ä»¬æ¥èŠèŠjså†…ç½®å¯¹è±¡localStorageçš„ä½¿ç”¨ï¼Œæˆ‘ä»¬å¹³æ—¶ä¸€èˆ¬éƒ½æ˜¯<code>getItem</code>ã€<code>setItem</code>å’Œ<code>removeItem</code>ï¼Œå¾ˆå°‘æ¥è§¦å…¶ä»–çš„ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'info'</span>)
<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'info'</span>, <span class="hljs-string">'123'</span>)
<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">remoItem</span>(<span class="hljs-string">'info'</span>)
</code></pre>
<p>æŸå¤©ï¼Œçªç„¶æœ‰ä¸ªå°éœ€æ±‚ï¼Œéœ€è¦æˆ‘ä»¬æ¸…é™¤localä¸­æ‰€æœ‰ä»¥<code>user_</code>å¼€å¤´çš„æ•°æ®ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿæ˜¾ç„¶å…‰ç”¨<code>getItem</code>å’Œ<code>removeItem</code>æ˜¯æ— æ³•å®ç°çš„ã€‚</p>
<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å…ˆæ¥å­¦ä¹ å‡ ä¸ªè·å– localStorage ä¸­æ‰€æœ‰ç¼“å­˜çš„ keyçš„æ–¹æ³•ï¼š</p>
<h2 data-id="heading-0">æ–¹æ³•ä¸€ï¼šä½¿ç”¨ for å¾ªç¯</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getAllLocalStorageKeys</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> keys = []
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">localStorage</span>.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">key</span>(i)
    keys.<span class="hljs-title function_">push</span>(key)
  }
  <span class="hljs-keyword">return</span> keys
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> allKeys = <span class="hljs-title function_">getAllLocalStorageKeys</span>()
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(allKeys)
</code></pre>
<h2 data-id="heading-1">æ–¹æ³•äºŒï¼šä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦å’Œ map</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> keys = [...<span class="hljs-title class_">Array</span>(<span class="hljs-variable language_">localStorage</span>.<span class="hljs-property">length</span>)].<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">key</span>(i))
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(keys)
</code></pre>
<h2 data-id="heading-2">æ–¹æ³•ä¸‰ï¼šè·å–é”®å€¼å¯¹</h2>
<p>å¦‚æœä½ æƒ³åŒæ—¶è·å–é”®å’Œå¯¹åº”çš„å€¼ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getAllLocalStorageItems</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> items = {}
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">localStorage</span>.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">key</span>(i)
    <span class="hljs-keyword">const</span> value = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(key)
    items[key] = value
  }
  <span class="hljs-keyword">return</span> items
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> allItems = <span class="hljs-title function_">getAllLocalStorageItems</span>()
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(allItems)
</code></pre>
<h2 data-id="heading-3">æ–¹æ³•å››ï¼šä½¿ç”¨ Object.keys çš„æ›¿ä»£æ–¹æ³•</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">localStorage</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(keys)  <span class="hljs-comment">// è¿™ä¼šè¿”å›æ‰€æœ‰ localStorage çš„ key</span>
</code></pre>
<h2 data-id="heading-4">æ–¹æ³•äº”ï¼šå°è£…æˆå®ç”¨å‡½æ•°</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LocalStorageHelper</span> {
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getAllKeys</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">localStorage</span>)
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getAllItems</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">localStorage</span>).<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">obj, key</span>) =&gt;</span> {
      obj[key] = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(key)
      <span class="hljs-keyword">return</span> obj
    }, {})
  }
  
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getKeysByPrefix</span>(<span class="hljs-params">prefix</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">localStorage</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> key.<span class="hljs-title function_">startsWith</span>(prefix))
  }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> allKeys = <span class="hljs-title class_">LocalStorageHelper</span>.<span class="hljs-title function_">getAllKeys</span>()
<span class="hljs-keyword">const</span> allItems = <span class="hljs-title class_">LocalStorageHelper</span>.<span class="hljs-title function_">getAllItems</span>()
</code></pre>
<h2 data-id="heading-5">ç¤ºä¾‹ï¼šç»Ÿè®¡å­˜å‚¨æƒ…å†µ</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">analyzeLocalStorage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">localStorage</span>)
  <span class="hljs-keyword">const</span> totalSize = keys.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">total, key</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> total + (<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(key).<span class="hljs-property">length</span> || <span class="hljs-number">0</span>)
  }, <span class="hljs-number">0</span>)
  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ€»æ¡ç›®æ•°: <span class="hljs-subst">${keys.length}</span>`</span>)
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ€»å¤§å°: <span class="hljs-subst">${totalSize}</span> å­—ç¬¦`</span>)
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ‰€æœ‰é”®å:`</span>, keys)
  
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">count</span>: keys.<span class="hljs-property">length</span>,
    <span class="hljs-attr">totalSize</span>: totalSize,
    <span class="hljs-attr">keys</span>: keys
  }
}

<span class="hljs-title function_">analyzeLocalStorage</span>()
</code></pre>
<p>æ¨èä½¿ç”¨ <strong>æ–¹æ³•ä¸€</strong> æˆ– <strong>æ–¹æ³•å››</strong>ï¼Œå®ƒä»¬ç®€å•ç›´æ¥ä¸”å…¼å®¹æ€§å¥½ã€‚</p>
<p>çŸ¥é“äº†è¿™äº›æ–¹æ³•åï¼Œæ¸…é™¤localä¸­æ‰€æœ‰ä»¥<code>user_</code>å¼€å¤´çš„æ•°æ®è¿™ä¸ªéœ€æ±‚å°±å¾ˆç®€å•äº†ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript">	<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">localStorage</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {
		<span class="hljs-keyword">if</span> (key.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'user_'</span>)) {
       <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(key)
     }	
	})
</code></pre>
<h2 data-id="heading-6">æœ€åï¼ŒlocalStorageç›¸å…³é™åˆ¶ï¼Œæˆ‘ç›¸ä¿¡å¤§å®¶è‚¯å®šä¹Ÿæ˜¯äº†è§£çš„ï¼š</h2>
<ol>
<li><strong>åŒæºç­–ç•¥</strong>ï¼šlocalStorage å—åŒæºç­–ç•¥é™åˆ¶ï¼Œåªèƒ½è®¿é—®å½“å‰åŸŸåä¸‹çš„å­˜å‚¨</li>
<li><strong>æ•°æ®ç±»å‹</strong>ï¼šè·å–çš„ key éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹</li>
<li><strong>å­˜å‚¨é™åˆ¶</strong>ï¼šæ¯ä¸ªåŸŸåçš„ localStorage é€šå¸¸æœ‰ 5MB å·¦å³çš„å­˜å‚¨é™åˆ¶</li>
<li><strong>ç©ºå€¼å¤„ç†</strong>ï¼šå¦‚æœ localStorage ä¸ºç©ºï¼Œè¿™äº›æ–¹æ³•ä¼šè¿”å›ç©ºæ•°ç»„æˆ–ç©ºå¯¹è±¡</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Context API çš„è®¢é˜…æœºåˆ¶ä¸æ€§èƒ½ä¼˜åŒ–]]></title>    <link>https://juejin.cn/post/7587368168621703174</link>    <guid>https://juejin.cn/post/7587368168621703174</guid>    <pubDate>2025-12-25T02:08:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587368168621703174" data-draft-id="7587368168621686790" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Context API çš„è®¢é˜…æœºåˆ¶ä¸æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="keywords" content="å‰ç«¯,React.js"/> <meta itemprop="datePublished" content="2025-12-25T02:08:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="day1"/> <meta itemprop="url" content="https://juejin.cn/user/4310544201823182"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Context API çš„è®¢é˜…æœºåˆ¶ä¸æ€§èƒ½ä¼˜åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4310544201823182/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    day1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T02:08:48.000Z" title="Thu Dec 25 2025 02:08:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. å¼•è¨€ï¼šContext API çš„åŒé¢æ€§</h2>
<p>Context API è¯ç”Ÿçš„æ ¸å¿ƒç›®æ ‡æ˜¯è§£å†³ React ç»„ä»¶æ ‘ä¸­ â€œprops é’»å–â€ é—®é¢˜â€”â€” å½“æ·±å±‚å­ç»„ä»¶éœ€è¦ä½¿ç”¨é¡¶å±‚ç»„ä»¶çš„çŠ¶æ€æ—¶ï¼Œæ— éœ€é€šè¿‡ä¸­é—´ç»„ä»¶é€å±‚ä¼ é€’ propsã€‚</p>
<p>ç„¶è€Œï¼Œè¿™ç§ä¾¿åˆ©æ€§çš„èƒŒåä¹Ÿéšè—ç€æ€§èƒ½ä¸Šçš„æŒ‘æˆ˜ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä»»ä½•æ¶ˆè´¹äº† Context çš„ç»„ä»¶éƒ½ä¼šåœ¨ Context å€¼å‘ç”Ÿå˜åŒ–æ—¶è¢«å¼ºåˆ¶é‡æ–°æ¸²æŸ“ï¼Œå³ä½¿å®ƒåªå…³å¿ƒè¯¥å€¼çš„ä¸€å°éƒ¨åˆ†ã€‚è¿™å¯èƒ½å¯¼è‡´å¤§è§„æ¨¡ä¸”ä¸å¿…è¦çš„æ¸²æŸ“ï¼Œä»è€Œå½±å“åº”ç”¨æ€§èƒ½ã€‚</p>
<h2 data-id="heading-1">2. æ ¸å¿ƒæœºåˆ¶ï¼šè¢«åŠ¨çš„â€œæ‹‰å–å¼â€è®¢é˜…</h2>
<p>è¦ç†è§£ Context çš„å·¥ä½œåŸç†ï¼Œæˆ‘ä»¬å¿…é¡»å°†å…¶è§†ä¸ºä¸€ä¸ª<strong>è¢«åŠ¨çš„ã€åœ¨â€œè·³è¿‡æ›´æ–°â€æ—¶è¿›è¡Œæ£€æŸ¥çš„â€œæ‹‰å–å¼â€è®¢é˜…ç³»ç»Ÿ</strong>ï¼Œè€Œéä¸»åŠ¨çš„â€œå‘å¸ƒ-è®¢é˜…â€æ¨¡å‹ã€‚</p>
<ul>
<li>
<p><strong><code>React.createContext(defaultValue)</code></strong>: åˆ›å»ºä¸€ä¸ª Context å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡æœ¬èº«å°±åƒä¸€ä¸ªâ€œä¸»é¢˜â€æˆ–â€œäº‹ä»¶ä¸­å¿ƒâ€ã€‚</p>
</li>
<li>
<p><strong><code>&lt;Context.Provider value={...}&gt;</code></strong>: è¿™æ˜¯å€¼çš„<strong>æä¾›è€…</strong>ã€‚å½“å®ƒæ¸²æŸ“æ—¶ï¼Œå®ƒä¼šå°† <code>value</code> prop çš„å€¼æ¨å…¥ä¸€ä¸ªå…¨å±€çš„ Context æ ˆä¸­ï¼Œä½¿å…¶æˆä¸ºå½“å‰æ´»è·ƒçš„å€¼ã€‚å®ƒ<strong>ä¸ä¼šä¸»åŠ¨é€šçŸ¥</strong>ä»»ä½•ç»„ä»¶ã€‚</p>
<p>è¿™ä¸ªâ€œæ ˆâ€æ˜¯ React ç”¨æ¥ç®¡ç†åµŒå¥— <code>Provider</code> å€¼çš„å…³é”®ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€æ‘ç›˜å­ï¼šå½“é‡åˆ°ä¸€ä¸ªæ–°çš„ <code>Provider</code> æ—¶ï¼ŒReact ä¼šæŠŠæ–°å€¼ï¼ˆæ–°ç›˜å­ï¼‰æ”¾åˆ°æœ€ä¸Šé¢ï¼›å½“è¿™ä¸ª <code>Provider</code> çš„æ¸²æŸ“ç»“æŸåï¼ŒReact ä¼šæŠŠæœ€ä¸Šé¢çš„å€¼ï¼ˆç›˜å­ï¼‰æ‹¿èµ°ï¼Œä»è€Œæ¢å¤ä¸Šä¸€å±‚ <code>Provider</code> çš„å€¼ã€‚è¿™ä¸ªâ€œåè¿›å…ˆå‡ºâ€çš„æœºåˆ¶ç¡®ä¿äº†æ— è®ºåµŒå¥—å¤šæ·±ï¼Œç»„ä»¶æ€»èƒ½è¯»å–åˆ°ç¦»å®ƒæœ€è¿‘çš„ <code>Provider</code> çš„å€¼ã€‚</p>
<p>è¿™ä¸ªè¿‡ç¨‹ç”± <code>pushProvider</code> å‡½æ•°å®Œæˆï¼Œå®ƒå°†æ—§å€¼ä¿å­˜åˆ°æ ˆä¸Šï¼Œç„¶åæ›´æ–° Context å¯¹è±¡çš„å½“å‰å€¼ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> pushProvider&lt;T&gt;(
  <span class="hljs-attr">providerFiber</span>: <span class="hljs-title class_">Fiber</span>,
  <span class="hljs-attr">context</span>: <span class="hljs-title class_">ReactContext</span>&lt;T&gt;,
  <span class="hljs-attr">nextValue</span>: T
): <span class="hljs-keyword">void</span> {
  <span class="hljs-keyword">if</span> (isPrimaryRenderer) {
    <span class="hljs-comment">// å°†æ—§å€¼æ¨å…¥æ ˆä¸­</span>
    <span class="hljs-title function_">push</span>(valueCursor, context.<span class="hljs-property">_currentValue</span>, providerFiber);
    <span class="hljs-comment">// æ›´æ–° context çš„å½“å‰å€¼</span>
    context.<span class="hljs-property">_currentValue</span> = nextValue;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">push</span>(valueCursor, context.<span class="hljs-property">_currentValue2</span>, providerFiber);
    context.<span class="hljs-property">_currentValue2</span> = nextValue;
  }
}
</code></pre>
</li>
<li>
<p><strong><code>useContext(Context)</code></strong>: è¿™æ˜¯<strong>è®¢é˜…è€…</strong>ã€‚å½“ç»„ä»¶è°ƒç”¨ <code>useContext</code> æ—¶ï¼ŒReact ä¼šåšä¸¤ä»¶å…³é”®çš„äº‹ï¼š</p>
<ol>
<li><strong>è¯»å–å€¼</strong>ï¼šä» Context æ ˆä¸­è¯»å–å½“å‰çš„æ´»è·ƒå€¼ã€‚</li>
<li><strong>è®°å½•ä¾èµ–ï¼ˆè®¢é˜…ï¼‰</strong>ï¼šå°†è¯¥ Context å’Œæœ¬æ¬¡è¯»å–åˆ°çš„å€¼ï¼ˆä½œä¸º <code>memoizedValue</code>ï¼‰è®°å½•åˆ°å½“å‰ç»„ä»¶ Fiber çš„ <code>dependencies</code> åˆ—è¡¨ä¸­ã€‚è¿™ä¸€æ­¥å°±æ˜¯â€œè®¢é˜…â€ï¼Œå®ƒå‘Šè¯‰ Reactï¼šâ€œè¿™ä¸ªç»„ä»¶ä¾èµ–æ­¤ Contextï¼Œå¹¶ä¸”å®ƒä¸Šæ¬¡è¯»å–çš„å€¼æ˜¯ Xâ€ã€‚</li>
</ol>
<p><code>useContext</code> å†…éƒ¨è°ƒç”¨ <code>readContext</code>ï¼Œæœ€ç»ˆç”± <code>readContextForConsumer</code> å®Œæˆå·¥ä½œã€‚å®ƒè¯»å–å½“å‰å€¼ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªä¾èµ–é¡¹å¹¶é™„åŠ åˆ°å½“å‰ç»„ä»¶ Fiber çš„ <code>dependencies</code> é“¾è¡¨ä¸Šã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src/react/packages/react-reconciler/src/ReactFiberNewContext.js</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> readContext&lt;T&gt;(<span class="hljs-attr">context</span>: <span class="hljs-title class_">ReactContext</span>&lt;T&gt;): T {
  <span class="hljs-comment">// ...</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">readContextForConsumer</span>(currentlyRenderingFiber, context);
}

<span class="hljs-keyword">function</span> readContextForConsumer&lt;T&gt;(
  <span class="hljs-attr">consumer</span>: <span class="hljs-title class_">Fiber</span> | <span class="hljs-literal">null</span>,
  <span class="hljs-attr">context</span>: <span class="hljs-title class_">ReactContext</span>&lt;T&gt;
): T {
  <span class="hljs-comment">// è¯»å–å½“å‰ context çš„å€¼</span>
  <span class="hljs-keyword">const</span> value = isPrimaryRenderer
    ? context.<span class="hljs-property">_currentValue</span>
    : context.<span class="hljs-property">_currentValue2</span>;

  <span class="hljs-keyword">const</span> contextItem = {
    <span class="hljs-attr">context</span>: ((<span class="hljs-attr">context</span>: any): <span class="hljs-title class_">ReactContext</span>&lt;mixed&gt;),
    <span class="hljs-attr">memoizedValue</span>: value, <span class="hljs-comment">// è®°å½•è¯»å–åˆ°çš„å€¼</span>
    <span class="hljs-attr">next</span>: <span class="hljs-literal">null</span>,
  };

  <span class="hljs-keyword">if</span> (lastContextDependency === <span class="hljs-literal">null</span>) {
    <span class="hljs-comment">// ... åˆ›å»ºæ–°çš„ä¾èµ–åˆ—è¡¨</span>
    lastContextDependency = contextItem;
    consumer.<span class="hljs-property">dependencies</span> = {
      <span class="hljs-attr">lanes</span>: <span class="hljs-title class_">NoLanes</span>,
      <span class="hljs-attr">firstContext</span>: contextItem,
    };
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// è¿½åŠ åˆ°ä¾èµ–é“¾è¡¨æœ«å°¾</span>
    lastContextDependency = lastContextDependency.<span class="hljs-property">next</span> = contextItem;
  }
  <span class="hljs-keyword">return</span> value;
}
</code></pre>
</li>
</ul>
<h4 data-id="heading-2">å†…éƒ¨æ›´æ–°æ£€æŸ¥æµç¨‹</h4>
<p>Context çš„æ›´æ–°é€šçŸ¥å¹¶éç”± <code>Provider</code> ä¸»åŠ¨å‘èµ·ï¼Œè€Œæ˜¯åœ¨ <code>Consumer</code> ç«¯ï¼Œå½“ React è¯•å›¾ä¼˜åŒ–æ¸²æŸ“æ—¶è¢«åŠ¨è§¦å‘çš„ã€‚</p>
<ol>
<li>
<p><strong><code>Provider</code> å€¼å˜æ›´</strong>ï¼š<code>Provider</code> çš„ <code>value</code> prop è·å¾—äº†ä¸€ä¸ªæ–°çš„å¯¹è±¡å¼•ç”¨ã€‚<code>Provider</code> é‡æ–°æ¸²æŸ“ï¼Œå¹¶å°†è¿™ä¸ªæ–°å€¼æ¨å…¥ Context æ ˆã€‚</p>
</li>
<li>
<p><strong>å­ç»„ä»¶æ¸²æŸ“ä¸æ£€æŸ¥</strong>ï¼šReact å‘ä¸‹æ¸²æŸ“å­ç»„ä»¶ã€‚</p>
<ul>
<li><strong>å¯¹äºæ™®é€šç»„ä»¶</strong>ï¼šç”±äºçˆ¶èŠ‚ç‚¹ï¼ˆæˆ–æ›´ä¸Šå±‚çš„ç¥–å…ˆï¼‰åœ¨æ¸²æŸ“ï¼Œå®ƒä»¬ä¹Ÿä¼šé»˜è®¤é‡æ–°æ¸²æŸ“ã€‚åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œå®ƒä»¬è°ƒç”¨ <code>useContext</code>ï¼Œè‡ªç„¶ä¼šè¯»å–åˆ° Context æ ˆä¸­æœ€æ–°çš„å€¼ã€‚</li>
<li><strong>å¯¹äºå¸Œæœ›â€œè·³è¿‡æ›´æ–°â€çš„ç»„ä»¶</strong>ï¼ˆå¦‚è¢« <code>React.memo</code> åŒ…è£¹ä¸” props æœªå˜çš„ç»„ä»¶ï¼‰ï¼šReact åœ¨å‡†å¤‡è·³è¿‡å®ƒä¹‹å‰ï¼Œä¼šæ‰§è¡Œä¸€é“é¢å¤–çš„å®‰å…¨æ£€æŸ¥â€”â€”è°ƒç”¨å†…éƒ¨çš„ <code>checkIfContextChanged</code> å‡½æ•°ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>checkIfContextChanged</code> çš„å·¥ä½œ</strong>ï¼šæ­¤å‡½æ•°ä¼šéå†è¯¥ç»„ä»¶çš„ <code>dependencies</code> åˆ—è¡¨ï¼Œç”¨ <code>Object.is</code> æ¯”è¾ƒæ¯ä¸€ä¸ªä¾èµ–çš„â€œæ—§å€¼â€ (<code>memoizedValue</code>) å’Œ Context æ ˆä¸­çš„â€œå½“å‰å€¼â€ã€‚</p>
<ul>
<li>å¦‚æœå‘ç°ä»»ä½•ä¸€ä¸ªå€¼ä¸ä¸€è‡´ï¼Œå‡½æ•°è¿”å› <code>true</code>ã€‚è¿™ä¸ªä¿¡å·ä¼š<strong>é˜»æ­¢ React è·³è¿‡è¯¥ç»„ä»¶</strong>ï¼Œå¼ºåˆ¶å…¶é‡æ–°æ¸²æŸ“ã€‚</li>
<li>å¦‚æœæ‰€æœ‰å€¼éƒ½ä¸€è‡´ï¼Œå‡½æ•°è¿”å› <code>false</code>ï¼Œç»„ä»¶è¢«æˆåŠŸè·³è¿‡ï¼Œé¿å…äº†ä¸å¿…è¦çš„æ¸²æŸ“ã€‚</li>
</ul>
<p>æºç æ¸…æ™°åœ°å±•ç¤ºäº†è¿™ä¸ªè¿‡ç¨‹ï¼šéå† <code>dependencies</code> é“¾è¡¨ï¼Œä½¿ç”¨ <code>is</code> å‡½æ•°ï¼ˆ<code>Object.is</code> çš„å†…éƒ¨å®ç°ï¼‰æ¯”è¾ƒ <code>memoizedValue</code> å’Œ <code>_currentValue</code>ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src/react/packages/react-reconciler/src/ReactFiberNewContext.js</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">checkIfContextChanged</span>(<span class="hljs-params">
  currentDependencies: Dependencies
</span>): boolean {
  <span class="hljs-keyword">let</span> dependency = currentDependencies.<span class="hljs-property">firstContext</span>;
  <span class="hljs-keyword">while</span> (dependency !== <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">const</span> context = dependency.<span class="hljs-property">context</span>;
    <span class="hljs-keyword">const</span> newValue = isPrimaryRenderer
      ? context.<span class="hljs-property">_currentValue</span>
      : context.<span class="hljs-property">_currentValue2</span>;
    <span class="hljs-keyword">const</span> oldValue = dependency.<span class="hljs-property">memoizedValue</span>;
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">is</span>(newValue, oldValue)) {
      <span class="hljs-comment">// åªè¦æœ‰ä¸€ä¸ª context çš„å€¼å˜äº†ï¼Œå°±è¿”å› true</span>
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    dependency = dependency.<span class="hljs-property">next</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
</li>
</ol>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4cb8c63907d4f35a0f8010cc782d31e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF5MQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767233328&amp;x-signature=h5LbBJOHnC0EsViN6pwTbztYLUs%3D" alt="9-1.png" loading="lazy"/></p>
<h2 data-id="heading-3">3. æ€§èƒ½ç“¶é¢ˆï¼šå¿…è¦ vs. ä¸å¿…è¦çš„æ¸²æŸ“</h2>
<p>åœ¨ä¼˜åŒ–æ€§èƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åŒºåˆ†ä¸¤ç§æ¸²æŸ“ï¼š</p>
<ul>
<li><strong>å¿…è¦çš„æ¸²æŸ“ (Necessary re-render)</strong>ï¼šå½“ç»„ä»¶è‡ªèº«çš„çŠ¶æ€å˜æ›´ï¼Œæˆ–è€…å®ƒç›´æ¥ä½¿ç”¨çš„ä¿¡æ¯ï¼ˆå¦‚ props æˆ– context çš„ä¸€éƒ¨åˆ†ï¼‰å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒçš„é‡æ–°æ¸²æŸ“æ˜¯å¿…è¦çš„ã€‚ä¾‹å¦‚ï¼Œå½“ç”¨æˆ·åœ¨è¾“å…¥æ¡†æ‰“å­—æ—¶ï¼Œç®¡ç†è¯¥è¾“å…¥çš„ç»„ä»¶å¿…é¡»æ¸²æŸ“ã€‚</li>
<li><strong>ä¸å¿…è¦çš„æ¸²æŸ“ (Unnecessary re-render)</strong>ï¼šå› ä¸ºæ¶æ„é—®é¢˜æˆ– React çš„æ¸²æŸ“æœºåˆ¶ï¼Œä¸€ä¸ªç»„ä»¶åœ¨å®ƒä¾èµ–çš„æ•°æ®å®Œå…¨æ²¡æœ‰å˜åŒ–çš„æƒ…å†µä¸‹ä¹Ÿè¢«é‡æ–°æ¸²æŸ“äº†ã€‚</li>
</ul>
<p><strong>Context API çš„ä¸»è¦æ€§èƒ½ç“¶é¢ˆï¼Œå°±åœ¨äºå®ƒå¾ˆå®¹æ˜“å¯¼è‡´ä¸å¿…è¦çš„æ¸²æŸ“ã€‚</strong></p>
<p>æ ¹æœ¬åŸå› åœ¨äºå…¶<strong>æ£€æŸ¥çš„ç²’åº¦å¤ªå¤§</strong>ã€‚ä¸€ä¸ªç»„ä»¶ä¸€æ—¦é€šè¿‡ <code>useContext</code> è®¢é˜…äº†æŸä¸ª Contextï¼Œå®ƒå°±ä¾èµ–äº†<strong>æ•´ä¸ª <code>value</code> å¯¹è±¡</strong>ã€‚åªè¦ <code>value</code> å¯¹è±¡çš„å¼•ç”¨å‘ç”Ÿå˜åŒ–ï¼Œ<code>checkIfContextChanged</code> æ£€æŸ¥å°±ä¼šå¤±è´¥ï¼Œä»è€Œå¼ºåˆ¶è¯¥ç»„ä»¶é‡æ–°æ¸²æŸ“â€”â€”æ— è®ºç»„ä»¶å®é™…ä½¿ç”¨çš„æ˜¯ <code>value</code> ä¸­çš„å“ªä¸ªå±æ€§ã€‚</p>
<h4 data-id="heading-4">ç¤ºä¾‹ï¼šä¸€ä¸ªå…¸å‹çš„ä¸å¿…è¦æ¸²æŸ“åœºæ™¯</h4>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«ç”¨æˆ·è®¤è¯å’Œä¸»é¢˜è®¾ç½®çš„å…¨å±€ Contextï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">AppContext</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createContext</span>();

<span class="hljs-keyword">function</span> <span class="hljs-title function_">AppProvider</span>(<span class="hljs-params">{ children }</span>) {
  <span class="hljs-keyword">const</span> [user, setUser] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [theme, setTheme] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">"light"</span>);

  <span class="hljs-comment">// æ³¨æ„ï¼šæ¯æ¬¡ AppProvider æ¸²æŸ“ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ value å¯¹è±¡</span>
  <span class="hljs-keyword">const</span> value = { user, theme, setTheme };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AppContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">AppContext.Provider</span>&gt;</span></span>;
}
</code></pre>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªè¢« <code>React.memo</code> åŒ…è£¹çš„ç»„ä»¶ï¼Œä»¥å°è¯•ä¼˜åŒ–æ€§èƒ½ï¼š</p>
<ol>
<li><code>UserProfile</code> åªæ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯ã€‚</li>
<li><code>ThemeToggler</code> åªåˆ‡æ¢ä¸»é¢˜ã€‚</li>
</ol>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">UserProfile</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">memo</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserProfile</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { user } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">AppContext</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"UserProfile rendered (unnecessary)"</span>);
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{user ? user.name : "Guest"}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
});

<span class="hljs-keyword">const</span> <span class="hljs-title class_">ThemeToggler</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">memo</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">ThemeToggler</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { theme, setTheme } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">AppContext</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ThemeToggler rendered (necessary)"</span>);
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setTheme((t) =&gt; (t === "light" ? "dark" : "light"))}&gt;
      {theme}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
});
</code></pre>
<p><strong>é—®é¢˜åœ¨äº</strong>ï¼šå½“æˆ‘ä»¬ç‚¹å‡» <code>ThemeToggler</code> æŒ‰é’®æ—¶ï¼Œ<code>setTheme</code> ä¼šè§¦å‘ <code>AppProvider</code> çš„é‡æ–°æ¸²æŸ“ã€‚</p>
<ol>
<li><code>ThemeToggler</code> çš„æ¸²æŸ“æ˜¯<strong>å¿…è¦çš„</strong>ï¼Œå› ä¸ºå®ƒç›´æ¥ä½¿ç”¨äº† <code>theme</code> å’Œ <code>setTheme</code>ã€‚</li>
<li><code>AppProvider</code> é‡æ–°æ¸²æŸ“æ—¶ï¼Œåˆ›å»ºäº†ä¸€ä¸ª<strong>æ–°çš„ <code>value</code> å¯¹è±¡</strong>ã€‚</li>
<li>å½“ React å‡†å¤‡è·³è¿‡ <code>UserProfile</code> çš„æ¸²æŸ“æ—¶ï¼Œ<code>checkIfContextChanged</code> è¢«è§¦å‘ã€‚å®ƒæ¯”è¾ƒ <code>AppContext</code> çš„æ–°æ—§ <code>value</code>ï¼Œå‘ç°å¼•ç”¨ä¸åŒã€‚</li>
<li>å› æ­¤ï¼ŒReact <strong>å¼ºåˆ¶ <code>UserProfile</code> é‡æ–°æ¸²æŸ“</strong>ã€‚è¿™æ¬¡æ¸²æŸ“æ˜¯<strong>ä¸å¿…è¦çš„</strong>ï¼Œå› ä¸º <code>user</code> çš„å€¼æ ¹æœ¬æ²¡æœ‰æ”¹å˜ã€‚</li>
</ol>
<p>è¿™å°±æ˜¯ Context å¯¼è‡´ä¸å¿…è¦æ¸²æŸ“çš„å…¸å‹åœºæ™¯ã€‚<code>React.memo</code> åœ¨è¿™é‡Œå¤±æ•ˆäº†ï¼Œå› ä¸ºå®ƒæ— æ³•é˜»æ­¢ç”± Context å˜æ›´ä¿¡å·è§¦å‘çš„å¼ºåˆ¶æ›´æ–°ã€‚</p>
<h2 data-id="heading-5">4. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</h2>
<p>ä¸ºäº†è§£å†³ä¸å¿…è¦çš„æ¸²æŸ“ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä»¥ä¸‹å‡ ç§ç­–ç•¥ï¼Œä»æ˜“åˆ°éš¾ï¼Œå±‚å±‚é€’è¿›ã€‚</p>
<h3 data-id="heading-6">ç­–ç•¥ä¸€ï¼šä½¿ç”¨ <code>useMemo</code> ç¨³å®š <code>value</code> å¯¹è±¡</h3>
<p>è¿™æ˜¯æœ€åŸºç¡€çš„ä¼˜åŒ–ã€‚æˆ‘ä»¬åº”è¯¥ç¡®ä¿ <code>Provider</code> çš„ <code>value</code> ä¸ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">AppProvider</span>(<span class="hljs-params">{ children }</span>) {
  <span class="hljs-keyword">const</span> [user, setUser] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [theme, setTheme] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">"light"</span>);

  <span class="hljs-comment">// åªæœ‰å½“ user æˆ– theme å˜åŒ–æ—¶ï¼Œvalue çš„å¼•ç”¨æ‰ä¼šæ”¹å˜</span>
  <span class="hljs-keyword">const</span> value = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> ({ user, theme, setTheme }), [user, theme]);

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AppContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">AppContext.Provider</span>&gt;</span></span>;
}
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šæ­¤ä¸¾å¯ä»¥é˜²æ­¢å›  <code>AppProvider</code> çš„çˆ¶ç»„ä»¶æ¸²æŸ“è€Œå¯¼è‡´çš„ã€ä¸ç›¸å…³çš„é‡æ–°æ¸²æŸ“ã€‚ä½†å®ƒä»ç„¶æ²¡æœ‰è§£å†³æˆ‘ä»¬ä¸Šé¢çš„æ ¸å¿ƒé—®é¢˜ï¼š<code>UserProfile</code> ä¾ç„¶ä¼šå› ä¸º <code>theme</code> çš„å˜åŒ–è€Œæ¸²æŸ“ã€‚</p>
<h3 data-id="heading-7">ç­–ç•¥äºŒï¼šæ‹†åˆ† Context</h3>
<p>è¿™æ˜¯è§£å†³ Context æ€§èƒ½é—®é¢˜çš„æœ€æœ‰æ•ˆã€æœ€ç¬¦åˆ React ç†å¿µçš„æ–¹æ³•ï¼š<strong>ä¿æŒ Context çš„å•ä¸€èŒè´£</strong>ã€‚</p>
<p>ä¸è¦åˆ›å»ºä¸€ä¸ªåŒ…ç½—ä¸‡è±¡çš„â€œå·¨çŸ³â€Contextï¼Œè€Œåº”è¯¥æ ¹æ®çŠ¶æ€çš„å…³è”æ€§å’Œæ›´æ–°é¢‘ç‡ï¼Œå°†å…¶æ‹†åˆ†ä¸ºå¤šä¸ªæ›´å°çš„ã€ç‹¬ç«‹çš„ Contextã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. åˆ›å»ºç‹¬ç«‹çš„ Context</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">UserContext</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createContext</span>();
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ThemeContext</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createContext</span>();

<span class="hljs-comment">// 2. åˆ›å»ºç‹¬ç«‹çš„ Provider</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserProvider</span>(<span class="hljs-params">{ children }</span>) {
  <span class="hljs-keyword">const</span> [user, setUser] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> value = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> ({ user, setUser }), [user]);
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">UserContext.Provider</span>&gt;</span></span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">ThemeProvider</span>(<span class="hljs-params">{ children }</span>) {
  <span class="hljs-keyword">const</span> [theme, setTheme] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">"light"</span>);
  <span class="hljs-keyword">const</span> value = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> ({ theme, setTheme }), [theme]);
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">ThemeContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 3. ç»„åˆ Provider</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">AppProviders</span>(<span class="hljs-params">{ children }</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ThemeProvider</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">ThemeProvider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">UserProvider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 4. ç»„ä»¶æŒ‰éœ€æ¶ˆè´¹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserProfile</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { user } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">UserContext</span>); <span class="hljs-comment">// åªè®¢é˜… UserContext</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"UserProfile rendered"</span>);
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{user ? user.name : "Guest"}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">ThemeToggler</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { theme, setTheme } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ThemeContext</span>); <span class="hljs-comment">// åªè®¢é˜… ThemeContext</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ThemeToggler rendered"</span>);
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setTheme((t) =&gt; (t === "light" ? "dark" : "light"))}&gt;
      {theme}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
}
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šç°åœ¨ï¼Œå½“ <code>ThemeToggler</code> æ›´æ–° <code>ThemeContext</code> æ—¶ï¼Œåªæœ‰è®¢é˜…äº† <code>ThemeContext</code> çš„ç»„ä»¶ä¼šæ”¶åˆ°æ›´æ–°ä¿¡å·ã€‚<code>UserProfile</code> å› ä¸ºåªè®¢é˜…äº† <code>UserContext</code>ï¼Œæ‰€ä»¥å®Œå…¨ä¸å—å½±å“ï¼Œå…¶ä¸å¿…è¦çš„æ¸²æŸ“è¢«å½»åº•æ¶ˆé™¤ã€‚</p>
<h3 data-id="heading-8">ç­–ç•¥ä¸‰ï¼šç»„ä»¶ç»„åˆ</h3>
<p>æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>å°†é‚£äº›ä¸å…³å¿ƒ Context å˜åŒ–çš„ã€æ˜‚è´µçš„ç»„ä»¶ä½œä¸º <code>children</code> prop ä¼ é€’ç»™ä¸€ä¸ªæ¶ˆè´¹äº† Context çš„çˆ¶ç»„ä»¶ã€‚</strong></p>
<p>è¿™æ ·ï¼Œå½“ Context å˜åŒ–å¯¼è‡´çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼ŒReact ä¼šå‘ç° <code>children</code> prop çš„å¼•ç”¨æ²¡æœ‰æ”¹å˜ï¼ˆå®ƒæ˜¯åœ¨çˆ¶ç»„ä»¶çš„çˆ¶ç»„ä»¶ä¸­å®šä¹‰çš„ï¼‰ï¼Œå› æ­¤ä¼šè·³è¿‡å¯¹ <code>children</code> çš„é‡æ–°æ¸²æŸ“ã€‚</p>
<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªæ­£ç¡®åº”ç”¨çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// AppProvider åŒ…å« theme å’Œ setTheme</span>
<span class="hljs-comment">// ThemeToggler ç”¨äºæ”¹å˜ theme</span>

<span class="hljs-comment">// 1. çˆ¶ç»„ä»¶æ¶ˆè´¹ Contextï¼Œå¹¶æ¥å—ä¸€ä¸ª children prop</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">ThemeWrapper</span>(<span class="hljs-params">{ children }</span>) {
  <span class="hljs-keyword">const</span> { theme } = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">AppContext</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ThemeWrapper rendered, theme is: <span class="hljs-subst">${theme}</span>`</span>);

  <span class="hljs-comment">// è¿™ä¸ª div çš„èƒŒæ™¯è‰²ä¼šå˜ï¼Œä½†å®ƒçš„ children ä¸ä¼šé‡æ–°æ¸²æŸ“</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
        <span class="hljs-attr">backgroundColor:</span> <span class="hljs-attr">theme</span> === <span class="hljs-string">"light"</span> ? "#<span class="hljs-attr">fff</span>" <span class="hljs-attr">:</span> "#<span class="hljs-attr">333</span>",
        <span class="hljs-attr">padding:</span> "<span class="hljs-attr">10px</span>",
      }}
    &gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 2. æ˜‚è´µçš„ç»„ä»¶ï¼Œè‡ªèº«ä¸æ¶ˆè´¹ Context</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ExpensiveTree</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">memo</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">ExpensiveTree</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ExpensiveTree rendered (should not happen on theme change)"</span>);
  <span class="hljs-comment">// ... å‡è®¾è¿™é‡Œæœ‰éå¸¸å¤æ‚çš„ UI</span>
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>è¿™æ˜¯ä¸€ä¸ªéå¸¸æ˜‚è´µçš„ç»„ä»¶æ ‘ï¼Œå®ƒä¸åº”è¯¥å› ä¸ºä¸»é¢˜å˜åŒ–è€Œé‡ç»˜ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
});

<span class="hljs-comment">// 3. åœ¨åº”ç”¨ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AppProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ThemeToggler</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ThemeWrapper</span>&gt;</span>
        {/* ExpensiveTree åœ¨ App ä¸­å®šä¹‰ï¼Œä½œä¸º children ä¼ é€’ */}
        <span class="hljs-tag">&lt;<span class="hljs-name">ExpensiveTree</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeWrapper</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">AppProvider</span>&gt;</span></span>
  );
}
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šå½“ <code>theme</code> å˜åŒ–æ—¶ï¼Œåªæœ‰ <code>ThemeToggler</code> å’Œ <code>ThemeWrapper</code> ä¼šé‡æ–°æ¸²æŸ“ã€‚<code>ThemeWrapper</code> é‡æ–°æ¸²æŸ“æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºå®ƒéœ€è¦åº”ç”¨æ–°çš„èƒŒæ™¯è‰²ã€‚ä½†å…³é”®åœ¨äºï¼Œå®ƒæ¥æ”¶çš„ <code>children</code> (<code>&lt;ExpensiveTree /&gt;</code>) æ˜¯åœ¨ <code>App</code> ç»„ä»¶çš„ä½œç”¨åŸŸä¸­åˆ›å»ºçš„ã€‚å¯¹äº <code>ThemeWrapper</code> æ¥è¯´ï¼Œæ¯æ¬¡æ¸²æŸ“æ—¶ <code>props.children</code> çš„å¼•ç”¨éƒ½æ˜¯ç›¸åŒçš„ã€‚å› æ­¤ï¼ŒReact ä¼šæˆåŠŸè·³è¿‡å¯¹ <code>ExpensiveTree</code> çš„æ¸²æŸ“ï¼Œé¿å…äº†ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ã€‚</p>
<h2 data-id="heading-9">5. æ€»ç»“</h2>
<p>ç†è§£ Context API çš„è®¢é˜…æœºåˆ¶å’Œæ€§èƒ½æƒè¡¡ï¼Œæ˜¯æˆä¸ºä¸€åé«˜æ•ˆ React å¼€å‘è€…çš„å…³é”®ã€‚é€šè¿‡åˆç†åœ°ç»„ç»‡ Context å¹¶é‡‡ç”¨é€‚å½“çš„ä¼˜åŒ–ç­–ç•¥ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨äº«å—å…¶ä¾¿åˆ©æ€§çš„åŒæ—¶ï¼Œæ„å»ºå‡ºé«˜æ€§èƒ½ã€å¯æ‰©å±•çš„åº”ç”¨ç¨‹åºã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨ä¸‰è¡Œä»£ç å®ç°åœ£è¯æ ‘ï¼Ÿåˆ«é€—äº†ï¼è®©æˆ‘ä»¬æ¥çœŸçš„]]></title>    <link>https://juejin.cn/post/7587322796825542696</link>    <guid>https://juejin.cn/post/7587322796825542696</guid>    <pubDate>2025-12-25T03:03:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587322796825542696" data-draft-id="7587342664077410319" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨ä¸‰è¡Œä»£ç å®ç°åœ£è¯æ ‘ï¼Ÿåˆ«é€—äº†ï¼è®©æˆ‘ä»¬æ¥çœŸçš„"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-25T03:03:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ— é™å¤§6"/> <meta itemprop="url" content="https://juejin.cn/user/2865758605422890"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨ä¸‰è¡Œä»£ç å®ç°åœ£è¯æ ‘ï¼Ÿåˆ«é€—äº†ï¼è®©æˆ‘ä»¬æ¥çœŸçš„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2865758605422890/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ— é™å¤§6
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T03:03:25.000Z" title="Thu Dec 25 2025 03:03:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;font-weight:400;line-height:2;font-size:17px;overflow-x:hidden;color:#000}.markdown-body strong{padding:1px;color:#ee3f4d}.markdown-body em{padding:0 2px;color:#f33b1f}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:30px;margin-bottom:20px;line-height:1.5;font-weight:700}.markdown-body h1{text-align:center;padding-bottom:5px;font-size:32px;color:#ac1f18}.markdown-body h1:after{content:"";display:block;margin:4px auto 0;width:100px;height:2px;border-bottom:2px solid #f33b1f}.markdown-body h2{font-size:28px;border-bottom:1px solid #f33b1f}.markdown-body h2:before{content:"# "!important;color:#f33b1f}.markdown-body h3{font-size:24px;padding-left:9px;border-left:6px solid #f33b1f}.markdown-body h4{font-size:20px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #bbb;margin:16px 0}.markdown-body code{word-break:break-word;overflow-x:auto;background-color:#f9f1db;color:#ee2746;border-radius:2px;font-size:16px;padding:1px 2px}.markdown-body code,.markdown-body pre{font-family:-apple-system,-apple-system-body,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,PingFang SC,æ€æºé»‘ä½“ CN,æ€æºé»‘ä½“,JetBrains Mono,Fira Code,Menlo,Ubuntu Mono,Consolas,sans-serif}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{margin:12px 0!important;border-radius:3px;font-size:15px;padding:16px 12px;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f7f7f7}.markdown-body a{text-decoration:none;color:#1781b5;padding:0 2px;border-bottom:1px solid #1781b5}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #f33b1f;color:#ac1f18}.markdown-body blockquote{color:#3d3d3d;background-color:#fff9f9;padding:6px 16px;margin:16px 0;border-left:3px solid #f07c82}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:6px 0}.markdown-body ol,.markdown-body ul{padding-left:30px}.markdown-body ol li,.markdown-body ul li{margin-bottom:6px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:6px}.markdown-body ol li{padding-left:6px}.markdown-body ::marker{color:#f33b1f}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body .task-list-item input[type=checkbox]{position:relative}.markdown-body .task-list-item input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:#fff;border:1px solid #f07c82;border-radius:3px;box-sizing:border-box;z-index:1}.markdown-body .task-list-item input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-5px;left:0;right:0;bottom:0;width:0;height:0;color:#f33b1f;font-size:16px;font-weight:700;z-index:2}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border-spacing:0;border-collapse:collapse}.markdown-body table thead{background:#fff9f9;color:#000;text-align:left;font-size:15px}.markdown-body table tr:nth-child(2n){background-color:#fcfcfc}.markdown-body table tr:hover{background-color:#fff9f9}.markdown-body table td,.markdown-body table th{padding:12px 7px;line-height:24px;border:1px solid #f9f1db}.markdown-body table td{min-width:120px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="xcode">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#000}.xml .hljs-meta{color:silver}.hljs-comment,.hljs-quote{color:#007400}.hljs-attribute,.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-tag{color:#aa0d91}.hljs-template-variable,.hljs-variable{color:#3f6e74}.hljs-code,.hljs-meta-string,.hljs-string{color:#c41a16}.hljs-link,.hljs-regexp{color:#0e0eff}.hljs-bullet,.hljs-number,.hljs-symbol,.hljs-title{color:#1c00cf}.hljs-meta,.hljs-section{color:#643820}.hljs-built_in,.hljs-builtin-name,.hljs-class .hljs-title,.hljs-params,.hljs-type{color:#5c2699}.hljs-attr{color:#836c28}.hljs-subst{color:#000}.hljs-formula{background-color:#eee;font-style:italic}.hljs-addition{background-color:#baeeba}.hljs-deletion{background-color:#ffc8bd}.hljs-selector-class,.hljs-selector-id{color:#9b703f}.hljs-doctag,.hljs-strong{font-weight:700}.hljs-emphasis{font-style:italic}</style><h2 data-id="heading-0">ğŸ„ ç”¨ä¸‰è¡Œä»£ç å®ç°åœ£è¯æ ‘ï¼Ÿåˆ«é€—äº†ï¼è®©æˆ‘ä»¬æ¥çœŸçš„ï¼</h2>
<h3 data-id="heading-1">ğŸŒŸ åœ£è¯èŠ‚çš„æ­£ç¡®æ‰“å¼€æ–¹å¼</h3>
<p>åœ£è¯èŠ‚å¿«åˆ°äº†ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰å®¶é‡Œç¼ºäº†ç‚¹ä»€ä¹ˆï¼ŸğŸ… å¯¹ï¼Œå°±æ˜¯é‚£æ£µ bling bling çš„åœ£è¯æ ‘ï¼ä½†æ˜¯ä¹°çœŸæ ‘å¤ªéº»çƒ¦ï¼Œä¹°å‡æ ‘åˆæ²¡çµé­‚ï¼Ÿæ²¡å…³ç³»ï¼Œä»Šå¤©æˆ‘å°±æ•™ä½ ç”¨<strong>HTML+CSS+JS</strong>æ‰“é€ ä¸€æ£µå±äºä½ çš„ã€Œä»£ç åœ£è¯æ ‘ã€ï¼Œè®©ä½ çš„ç”µè„‘å±å¹•å……æ»¡èŠ‚æ—¥æ°”æ¯ï¼ğŸ</p>
<h3 data-id="heading-2">ğŸ› ï¸ å‡†å¤‡å·¥ä½œ</h3>
<p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ï¼š</p>
<ul>
<li>ä¸€é¢—æƒ³æäº‹æƒ…çš„å¿ƒ ğŸ’¡</li>
<li>ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆè®°äº‹æœ¬ä¹Ÿè¡Œï¼Œä½†æˆ‘åŠä½ ç”¨ VS Codeï¼‰</li>
<li>ä¸€ç‚¹ HTML+CSS+JS åŸºç¡€</li>
<li>è¿˜æœ‰æ»¡è„‘å­çš„åœ£è¯ç²¾ç¥ ğŸ„</li>
</ul>
<h3 data-id="heading-3">ğŸ¨ å¼€å§‹åˆ¶ä½œåœ£è¯æ ‘</h3>
<h4 data-id="heading-4">ç¬¬ä¸€æ­¥ï¼šæ­å»ºéª¨æ¶ï¼ˆHTMLï¼‰</h4>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç»™åœ£è¯æ ‘æ­ä¸ªéª¨æ¶ã€‚å°±åƒç›–æˆ¿å­ä¸€æ ·ï¼Œå…ˆæ‰“åœ°åŸºï¼</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æˆ‘çš„ä»£ç åœ£è¯æ ‘ ğŸ„<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"style.css"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ğŸ… Merry Christmas! ğŸ„<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tree"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- åœ£è¯æ ‘çš„æ ‘å¹² --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"trunk"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- åœ£è¯æ ‘çš„æ ‘å† ï¼Œç”¨ä¸‰ä¸ªä¸‰è§’å½¢ç»„æˆ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"leaves leaves-1"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"leaves leaves-2"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"leaves leaves-3"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- åœ£è¯æ ‘ä¸Šçš„è£…é¥°å“ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"decorations"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ ‘é¡¶æ˜Ÿæ˜Ÿ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"star"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- é›ªèŠ±æ•ˆæœ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"snow"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- ç¤¼ç‰©ç›’ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"gifts"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"script.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h4 data-id="heading-5">ç¬¬äºŒæ­¥ï¼šåŒ–å¦†æ‰“æ‰®ï¼ˆCSSï¼‰</h4>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ç»™åœ£è¯æ ‘ç©¿ä¸Šæ¼‚äº®çš„è¡£æœï¼è¿™ä¸€æ­¥å°±åƒå¥³æœ‹å‹åŒ–å¦†ï¼Œè¦ç»†å¿ƒï¼ğŸ’„</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* å…¨å±€æ ·å¼ */</span>
* {
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">box-sizing</span>: border-box;
}

<span class="hljs-selector-tag">body</span> {
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(to bottom, <span class="hljs-number">#1a1a2e</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#16213e</span> <span class="hljs-number">100%</span>);
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">justify-content</span>: center;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">overflow</span>: hidden;
  <span class="hljs-attribute">font-family</span>: <span class="hljs-string">"Arial"</span>, sans-serif;
}

<span class="hljs-selector-class">.container</span> {
  <span class="hljs-attribute">text-align</span>: center;
  <span class="hljs-attribute">position</span>: relative;
}

<span class="hljs-comment">/* æ ‡é¢˜æ ·å¼ */</span>
<span class="hljs-selector-tag">h1</span> {
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">30px</span>;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">2.5rem</span>;
  <span class="hljs-attribute">text-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> <span class="hljs-number">#ff0</span>;
  <span class="hljs-attribute">animation</span>: glow <span class="hljs-number">2s</span> ease-in-out infinite alternate;
}

<span class="hljs-comment">/* æ ‡é¢˜å‘å…‰åŠ¨ç”» */</span>
<span class="hljs-keyword">@keyframes</span> glow {
  <span class="hljs-selector-tag">from</span> {
    <span class="hljs-attribute">text-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> <span class="hljs-number">#ff0</span>;
  }
  <span class="hljs-selector-tag">to</span> {
    <span class="hljs-attribute">text-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">40px</span> <span class="hljs-number">#ff0</span>;
  }
}

<span class="hljs-comment">/* åœ£è¯æ ‘å®¹å™¨ */</span>
<span class="hljs-selector-class">.tree</span> {
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">display</span>: inline-block;
}

<span class="hljs-comment">/* æ ‘å¹²æ ·å¼ */</span>
<span class="hljs-selector-class">.trunk</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">40px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">60px</span>;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#8b4513</span>;
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">bottom</span>: -<span class="hljs-number">60px</span>;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">10px</span>;
}

<span class="hljs-comment">/* æ ‘å† æ ·å¼ - ä¸‰ä¸ªä¸‰è§’å½¢å åŠ  */</span>
<span class="hljs-selector-class">.leaves</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">border-left</span>: transparent solid;
  <span class="hljs-attribute">border-right</span>: transparent solid;
  <span class="hljs-attribute">border-bottom</span>: green solid;
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
}

<span class="hljs-comment">/* ç¬¬ä¸€å±‚æ ‘å†  */</span>
<span class="hljs-selector-class">.leaves-1</span> {
  <span class="hljs-attribute">border-left-width</span>: <span class="hljs-number">150px</span>;
  <span class="hljs-attribute">border-right-width</span>: <span class="hljs-number">150px</span>;
  <span class="hljs-attribute">border-bottom-width</span>: <span class="hljs-number">200px</span>;
  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(to bottom, <span class="hljs-number">#228b22</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#006400</span> <span class="hljs-number">100%</span>);
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span> <span class="hljs-number">50%</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>;
}

<span class="hljs-comment">/* ç¬¬äºŒå±‚æ ‘å†  */</span>
<span class="hljs-selector-class">.leaves-2</span> {
  <span class="hljs-attribute">border-left-width</span>: <span class="hljs-number">120px</span>;
  <span class="hljs-attribute">border-right-width</span>: <span class="hljs-number">120px</span>;
  <span class="hljs-attribute">border-bottom-width</span>: <span class="hljs-number">160px</span>;
  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">70px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(to bottom, <span class="hljs-number">#228b22</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#006400</span> <span class="hljs-number">100%</span>);
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span> <span class="hljs-number">50%</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>;
}

<span class="hljs-comment">/* ç¬¬ä¸‰å±‚æ ‘å†  */</span>
<span class="hljs-selector-class">.leaves-3</span> {
  <span class="hljs-attribute">border-left-width</span>: <span class="hljs-number">90px</span>;
  <span class="hljs-attribute">border-right-width</span>: <span class="hljs-number">90px</span>;
  <span class="hljs-attribute">border-bottom-width</span>: <span class="hljs-number">120px</span>;
  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">140px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(to bottom, <span class="hljs-number">#228b22</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#006400</span> <span class="hljs-number">100%</span>);
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span> <span class="hljs-number">50%</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>;
}

<span class="hljs-comment">/* æ ‘é¡¶æ˜Ÿæ˜Ÿ */</span>
<span class="hljs-selector-class">.star</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">border-left</span>: <span class="hljs-number">25px</span> solid transparent;
  <span class="hljs-attribute">border-right</span>: <span class="hljs-number">25px</span> solid transparent;
  <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">43px</span> solid <span class="hljs-number">#ffd700</span>;
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">250px</span>;
  <span class="hljs-attribute">animation</span>: twinkle <span class="hljs-number">1s</span> ease-in-out infinite alternate;
}

<span class="hljs-comment">/* æ˜Ÿæ˜Ÿé—ªçƒåŠ¨ç”» */</span>
<span class="hljs-keyword">@keyframes</span> twinkle {
  <span class="hljs-selector-tag">from</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>);
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
  }
  <span class="hljs-selector-tag">to</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.1</span>);
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
    <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ffd700</span>;
  }
}

<span class="hljs-comment">/* æ˜Ÿæ˜Ÿçš„äº”ä¸ªè§’ */</span>
<span class="hljs-selector-class">.star</span><span class="hljs-selector-pseudo">::before</span>,
<span class="hljs-selector-class">.star</span><span class="hljs-selector-pseudo">::after</span> {
  <span class="hljs-attribute">content</span>: <span class="hljs-string">""</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">border-left</span>: <span class="hljs-number">25px</span> solid transparent;
  <span class="hljs-attribute">border-right</span>: <span class="hljs-number">25px</span> solid transparent;
  <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">43px</span> solid <span class="hljs-number">#ffd700</span>;
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">left</span>: -<span class="hljs-number">25px</span>;
}

<span class="hljs-selector-class">.star</span><span class="hljs-selector-pseudo">::before</span> {
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotate</span>(<span class="hljs-number">72deg</span>);
}

<span class="hljs-selector-class">.star</span><span class="hljs-selector-pseudo">::after</span> {
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotate</span>(<span class="hljs-number">144deg</span>);
}

<span class="hljs-comment">/* è£…é¥°å“åŸºç¡€æ ·å¼ */</span>
<span class="hljs-selector-class">.decoration</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">animation</span>: blink <span class="hljs-number">1.5s</span> ease-in-out infinite alternate;
}

<span class="hljs-comment">/* è£…é¥°å“é—ªçƒåŠ¨ç”» */</span>
<span class="hljs-keyword">@keyframes</span> blink {
  <span class="hljs-selector-tag">from</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>);
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
  }
  <span class="hljs-selector-tag">to</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.2</span>);
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
    <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> currentColor;
  }
}

<span class="hljs-comment">/* ä¸åŒé¢œè‰²çš„è£…é¥°å“ */</span>
<span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.red</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ff0000</span>;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#ff0000</span>;
}

<span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.blue</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#0000ff</span>;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#0000ff</span>;
}

<span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.yellow</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ffff00</span>;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#ffff00</span>;
}

<span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.pink</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ff1493</span>;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#ff1493</span>;
}

<span class="hljs-comment">/* é›ªèŠ±æ ·å¼ */</span>
<span class="hljs-selector-class">.snowflake</span> {
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">animation</span>: fall linear infinite;
  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
}

<span class="hljs-comment">/* é›ªèŠ±ä¸‹è½åŠ¨ç”» */</span>
<span class="hljs-keyword">@keyframes</span> fall {
  <span class="hljs-selector-tag">from</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">100px</span>) <span class="hljs-built_in">rotate</span>(<span class="hljs-number">0deg</span>);
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
  }
  <span class="hljs-number">10%</span> {
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
  }
  <span class="hljs-selector-tag">to</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">100vh</span>) <span class="hljs-built_in">rotate</span>(<span class="hljs-number">360deg</span>);
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
  }
}

<span class="hljs-comment">/* ç¤¼ç‰©ç›’å®¹å™¨ */</span>
<span class="hljs-selector-class">.gifts</span> {
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">bottom</span>: -<span class="hljs-number">100px</span>;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">gap</span>: <span class="hljs-number">20px</span>;
}

<span class="hljs-comment">/* ç¤¼ç‰©ç›’æ ·å¼ */</span>
<span class="hljs-selector-class">.gift</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">60px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">60px</span>;
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">animation</span>: bounce <span class="hljs-number">2s</span> ease-in-out infinite;
}

<span class="hljs-comment">/* ç¤¼ç‰©ç›’å¼¹è·³åŠ¨ç”» */</span>
<span class="hljs-keyword">@keyframes</span> bounce {
  <span class="hljs-number">0%</span>,
  <span class="hljs-number">100%</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0</span>);
  }
  <span class="hljs-number">50%</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">10px</span>);
  }
}

<span class="hljs-comment">/* ä¸åŒé¢œè‰²çš„ç¤¼ç‰©ç›’ */</span>
<span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.red</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ff0000</span>;
}

<span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.green</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#008000</span>;
}

<span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.blue</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#0000ff</span>;
}

<span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.yellow</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ffff00</span>;
}

<span class="hljs-comment">/* ç¤¼ç‰©ç›’ä¸å¸¦ */</span>
<span class="hljs-selector-class">.gift</span><span class="hljs-selector-pseudo">::before</span>,
<span class="hljs-selector-class">.gift</span><span class="hljs-selector-pseudo">::after</span> {
  <span class="hljs-attribute">content</span>: <span class="hljs-string">""</span>;
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
}

<span class="hljs-selector-class">.gift</span><span class="hljs-selector-pseudo">::before</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">10px</span>;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">50%</span>);
}

<span class="hljs-selector-class">.gift</span><span class="hljs-selector-pseudo">::after</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">10px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
}
</code></pre>
<h4 data-id="heading-6">ç¬¬ä¸‰æ­¥ï¼šè®©å®ƒåŠ¨èµ·æ¥ï¼ˆJSï¼‰</h4>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬çš„åœ£è¯æ ‘è¿˜åªæ˜¯ä¸ªã€Œé™æ€ç¾äººã€ï¼Œè®©æˆ‘ä»¬ç”¨ JavaScript ç»™å®ƒæ³¨å…¥çµé­‚ï¼âœ¨</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœ£è¯æ ‘è£…é¥°å“ç”Ÿæˆ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createDecorations</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> decorationsContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".decorations"</span>);
  <span class="hljs-keyword">const</span> colors = [<span class="hljs-string">"red"</span>, <span class="hljs-string">"blue"</span>, <span class="hljs-string">"yellow"</span>, <span class="hljs-string">"pink"</span>];
  <span class="hljs-keyword">const</span> count = <span class="hljs-number">20</span>;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {
    <span class="hljs-keyword">const</span> decoration = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"div"</span>);
    decoration.<span class="hljs-property">className</span> = <span class="hljs-string">`decoration <span class="hljs-subst">${
      colors[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * colors.length)]
    }</span>`</span>;

    <span class="hljs-comment">// éšæœºä½ç½®ï¼ˆåœ¨æ ‘å† èŒƒå›´å†…ï¼‰</span>
    <span class="hljs-keyword">const</span> angle = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>;
    <span class="hljs-keyword">const</span> radius = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">120</span> + <span class="hljs-number">30</span>;
    <span class="hljs-keyword">const</span> x = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>(angle) * radius;
    <span class="hljs-keyword">const</span> y = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(angle) * radius - <span class="hljs-number">100</span>;

    decoration.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`calc(50% + <span class="hljs-subst">${x}</span>px)`</span>;
    decoration.<span class="hljs-property">style</span>.<span class="hljs-property">bottom</span> = <span class="hljs-string">`<span class="hljs-subst">${y}</span>px`</span>;
    decoration.<span class="hljs-property">style</span>.<span class="hljs-property">animationDelay</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">2</span>}</span>s`</span>;

    decorationsContainer.<span class="hljs-title function_">appendChild</span>(decoration);
  }
}

<span class="hljs-comment">// é›ªèŠ±ç”Ÿæˆå™¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createSnow</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> snowContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".snow"</span>);
  <span class="hljs-keyword">const</span> snowflakeCount = <span class="hljs-number">100</span>;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; snowflakeCount; i++) {
    <span class="hljs-keyword">const</span> snowflake = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"div"</span>);
    snowflake.<span class="hljs-property">className</span> = <span class="hljs-string">"snowflake"</span>;

    <span class="hljs-comment">// éšæœºå¤§å°</span>
    <span class="hljs-keyword">const</span> size = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">8</span> + <span class="hljs-number">2</span>;
    snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">`<span class="hljs-subst">${size}</span>px`</span>;
    snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">`<span class="hljs-subst">${size}</span>px`</span>;

    <span class="hljs-comment">// éšæœºä½ç½®</span>
    snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">100</span>}</span>vw`</span>;

    <span class="hljs-comment">// éšæœºä¸‹è½é€Ÿåº¦</span>
    <span class="hljs-keyword">const</span> duration = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span> + <span class="hljs-number">5</span>;
    snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">animationDuration</span> = <span class="hljs-string">`<span class="hljs-subst">${duration}</span>s`</span>;

    <span class="hljs-comment">// éšæœºå»¶è¿Ÿ</span>
    snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">animationDelay</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">5</span>}</span>s`</span>;

    snowContainer.<span class="hljs-title function_">appendChild</span>(snowflake);
  }
}

<span class="hljs-comment">// ç¤¼ç‰©ç›’ç”Ÿæˆ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createGifts</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> giftsContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".gifts"</span>);
  <span class="hljs-keyword">const</span> colors = [<span class="hljs-string">"red"</span>, <span class="hljs-string">"green"</span>, <span class="hljs-string">"blue"</span>, <span class="hljs-string">"yellow"</span>];
  <span class="hljs-keyword">const</span> count = <span class="hljs-number">4</span>;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {
    <span class="hljs-keyword">const</span> gift = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"div"</span>);
    gift.<span class="hljs-property">className</span> = <span class="hljs-string">`gift <span class="hljs-subst">${
      colors[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * colors.length)]
    }</span>`</span>;
    gift.<span class="hljs-property">style</span>.<span class="hljs-property">animationDelay</span> = <span class="hljs-string">`<span class="hljs-subst">${i * <span class="hljs-number">0.5</span>}</span>s`</span>;
    giftsContainer.<span class="hljs-title function_">appendChild</span>(gift);
  }
}

<span class="hljs-comment">// é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"DOMContentLoaded"</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">createDecorations</span>();
  <span class="hljs-title function_">createSnow</span>();
  <span class="hljs-title function_">createGifts</span>();
});
</code></pre>
<h3 data-id="heading-7">ğŸ‰ è®©åœ£è¯æ ‘è·‘èµ·æ¥</h3>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æŠŠæ‰€æœ‰ä»£ç åˆå¹¶åˆ°ä¸€ä¸ªå®Œæ•´çš„ HTML æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥ç›´æ¥å¤åˆ¶ä¸‹é¢çš„ä»£ç ä¿å­˜ä¸º <code>christmas-tree.html</code>ï¼Œç„¶åç”¨æµè§ˆå™¨æ‰“å¼€å®ƒï¼Œå°±èƒ½çœ‹åˆ°ä½ çš„åœ£è¯æ ‘äº†ï¼ğŸ„</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ğŸ„ æˆ‘çš„ä»£ç åœ£è¯æ ‘<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
      <span class="hljs-comment">/* å…¨å±€æ ·å¼ */</span>
      * {
        <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">box-sizing</span>: border-box;
      }

      <span class="hljs-selector-tag">body</span> {
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(to bottom, <span class="hljs-number">#1a1a2e</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#16213e</span> <span class="hljs-number">100%</span>);
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100vh</span>;
        <span class="hljs-attribute">display</span>: flex;
        <span class="hljs-attribute">justify-content</span>: center;
        <span class="hljs-attribute">align-items</span>: center;
        <span class="hljs-attribute">overflow</span>: hidden;
        <span class="hljs-attribute">font-family</span>: <span class="hljs-string">"Arial"</span>, sans-serif;
        <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
      }

      <span class="hljs-selector-class">.container</span> {
        <span class="hljs-attribute">text-align</span>: center;
        <span class="hljs-attribute">position</span>: relative;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">500px</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">600px</span>;
        <span class="hljs-attribute">display</span>: flex;
        <span class="hljs-attribute">flex-direction</span>: column;
        <span class="hljs-attribute">justify-content</span>: center;
        <span class="hljs-attribute">align-items</span>: center;
        <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;
      }

      <span class="hljs-comment">/* æ ‡é¢˜æ ·å¼ */</span>
      <span class="hljs-selector-tag">h1</span> {
        <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
        <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">100px</span>;
        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">2.5rem</span>;
        <span class="hljs-attribute">text-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> <span class="hljs-number">#ff0</span>;
        <span class="hljs-attribute">animation</span>: glow <span class="hljs-number">2s</span> ease-in-out infinite alternate;
        <span class="hljs-attribute">z-index</span>: <span class="hljs-number">20</span>;
        <span class="hljs-attribute">position</span>: relative;
      }

      <span class="hljs-comment">/* æ ‡é¢˜å‘å…‰åŠ¨ç”» */</span>
      <span class="hljs-keyword">@keyframes</span> glow {
        <span class="hljs-selector-tag">from</span> {
          <span class="hljs-attribute">text-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> <span class="hljs-number">#ff0</span>;
        }
        <span class="hljs-selector-tag">to</span> {
          <span class="hljs-attribute">text-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> <span class="hljs-number">#ff0</span>, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">40px</span> <span class="hljs-number">#ff0</span>;
        }
      }

      <span class="hljs-comment">/* åœ£è¯æ ‘å®¹å™¨ */</span>
      <span class="hljs-selector-class">.tree</span> {
        <span class="hljs-attribute">position</span>: relative;
        <span class="hljs-attribute">display</span>: inline-block;
      }

      <span class="hljs-comment">/* æ ‘å¹²æ ·å¼ */</span>
      <span class="hljs-selector-class">.trunk</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">40px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">60px</span>;
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#8b4513</span>;
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">bottom</span>: -<span class="hljs-number">60px</span>;
        <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">10px</span>;
      }

      <span class="hljs-comment">/* æ ‘å† æ ·å¼ - ä¸‰ä¸ªä¸‰è§’å½¢å åŠ  */</span>
      <span class="hljs-selector-class">.leaves</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
        <span class="hljs-attribute">filter</span>: <span class="hljs-built_in">drop-shadow</span>(<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>));
      }

      <span class="hljs-comment">/* ç¬¬ä¸€å±‚æ ‘å†  */</span>
      <span class="hljs-selector-class">.leaves-1</span> {
        <span class="hljs-attribute">border-left</span>: <span class="hljs-number">150px</span> solid transparent;
        <span class="hljs-attribute">border-right</span>: <span class="hljs-number">150px</span> solid transparent;
        <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">200px</span> solid <span class="hljs-number">#2e8b57</span>;
        <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">animation</span>: sway <span class="hljs-number">3s</span> ease-in-out infinite alternate;
      }

      <span class="hljs-comment">/* ç¬¬äºŒå±‚æ ‘å†  */</span>
      <span class="hljs-selector-class">.leaves-2</span> {
        <span class="hljs-attribute">border-left</span>: <span class="hljs-number">120px</span> solid transparent;
        <span class="hljs-attribute">border-right</span>: <span class="hljs-number">120px</span> solid transparent;
        <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">160px</span> solid <span class="hljs-number">#3cb371</span>;
        <span class="hljs-attribute">bottom</span>: <span class="hljs-number">70px</span>;
        <span class="hljs-attribute">animation</span>: sway <span class="hljs-number">3s</span> ease-in-out infinite alternate-reverse;
      }

      <span class="hljs-comment">/* ç¬¬ä¸‰å±‚æ ‘å†  */</span>
      <span class="hljs-selector-class">.leaves-3</span> {
        <span class="hljs-attribute">border-left</span>: <span class="hljs-number">90px</span> solid transparent;
        <span class="hljs-attribute">border-right</span>: <span class="hljs-number">90px</span> solid transparent;
        <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">120px</span> solid <span class="hljs-number">#228b22</span>;
        <span class="hljs-attribute">bottom</span>: <span class="hljs-number">140px</span>;
        <span class="hljs-attribute">animation</span>: sway <span class="hljs-number">3s</span> ease-in-out infinite alternate;
      }

      <span class="hljs-comment">/* æ ‘æ‘‡æ‘†åŠ¨ç”» */</span>
      <span class="hljs-keyword">@keyframes</span> sway {
        <span class="hljs-selector-tag">from</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>) <span class="hljs-built_in">rotate</span>(-<span class="hljs-number">1deg</span>);
        }
        <span class="hljs-selector-tag">to</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>) <span class="hljs-built_in">rotate</span>(<span class="hljs-number">1deg</span>);
        }
      }

      <span class="hljs-comment">/* æ ‘é¡¶æ˜Ÿæ˜Ÿ - ä½¿ç”¨æ›´ç®€å•çš„æ–¹å¼å®ç° */</span>
      <span class="hljs-selector-class">.star</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">50px</span>;
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ffd700</span>;
        <span class="hljs-attribute">clip-path</span>: <span class="hljs-built_in">polygon</span>(
          <span class="hljs-number">50%</span> <span class="hljs-number">0%</span>,
          <span class="hljs-number">61%</span> <span class="hljs-number">35%</span>,
          <span class="hljs-number">98%</span> <span class="hljs-number">35%</span>,
          <span class="hljs-number">68%</span> <span class="hljs-number">57%</span>,
          <span class="hljs-number">79%</span> <span class="hljs-number">91%</span>,
          <span class="hljs-number">50%</span> <span class="hljs-number">70%</span>,
          <span class="hljs-number">21%</span> <span class="hljs-number">91%</span>,
          <span class="hljs-number">32%</span> <span class="hljs-number">57%</span>,
          <span class="hljs-number">2%</span> <span class="hljs-number">35%</span>,
          <span class="hljs-number">39%</span> <span class="hljs-number">35%</span>
        );
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
        <span class="hljs-attribute">bottom</span>: <span class="hljs-number">250px</span>;
        <span class="hljs-attribute">animation</span>: twinkle <span class="hljs-number">1s</span> ease-in-out infinite alternate;
        <span class="hljs-attribute">z-index</span>: <span class="hljs-number">10</span>;
      }

      <span class="hljs-comment">/* æ˜Ÿæ˜Ÿé—ªçƒåŠ¨ç”» */</span>
      <span class="hljs-keyword">@keyframes</span> twinkle {
        <span class="hljs-selector-tag">from</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>);
          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
        }
        <span class="hljs-selector-tag">to</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.1</span>);
          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
          <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> <span class="hljs-number">#ffd700</span>;
        }
      }

      <span class="hljs-comment">/* è£…é¥°å“åŸºç¡€æ ·å¼ */</span>
      <span class="hljs-selector-class">.decoration</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">20px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">20px</span>;
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">animation</span>: blink <span class="hljs-number">1.5s</span> ease-in-out infinite alternate;
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span> currentColor;
      }

      <span class="hljs-comment">/* è£…é¥°å“é—ªçƒåŠ¨ç”» */</span>
      <span class="hljs-keyword">@keyframes</span> blink {
        <span class="hljs-selector-tag">from</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>) <span class="hljs-built_in">rotate</span>(<span class="hljs-number">0deg</span>);
          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
        }
        <span class="hljs-selector-tag">to</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.3</span>) <span class="hljs-built_in">rotate</span>(<span class="hljs-number">360deg</span>);
          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
          <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">20px</span> currentColor, <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">30px</span> currentColor;
        }
      }

      <span class="hljs-comment">/* ä¸åŒé¢œè‰²çš„è£…é¥°å“ï¼Œå¢åŠ å‘å…‰æ•ˆæœ */</span>
      <span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.red</span> {
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ff0000</span>;
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">15px</span> <span class="hljs-number">#ff0000</span>, inset <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.5</span>);
      }

      <span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.blue</span> {
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#0000ff</span>;
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">15px</span> <span class="hljs-number">#0000ff</span>, inset <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.5</span>);
      }

      <span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.yellow</span> {
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ffff00</span>;
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">15px</span> <span class="hljs-number">#ffff00</span>, inset <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.5</span>);
      }

      <span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.pink</span> {
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ff1493</span>;
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">15px</span> <span class="hljs-number">#ff1493</span>, inset <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.5</span>);
      }

      <span class="hljs-comment">/* æ·»åŠ ä¸€äº›ä¸åŒå¤§å°çš„è£…é¥°å“ */</span>
      <span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.large</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">25px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">25px</span>;
      }

      <span class="hljs-selector-class">.decoration</span><span class="hljs-selector-class">.small</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">15px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">15px</span>;
        <span class="hljs-attribute">animation-duration</span>: <span class="hljs-number">2s</span>;
      }

      <span class="hljs-comment">/* é›ªèŠ±æ ·å¼ */</span>
      <span class="hljs-selector-class">.snowflake</span> {
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">animation</span>: fall linear infinite;
        <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
      }

      <span class="hljs-comment">/* é›ªèŠ±ä¸‹è½åŠ¨ç”» */</span>
      <span class="hljs-keyword">@keyframes</span> fall {
        <span class="hljs-selector-tag">from</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">100px</span>) <span class="hljs-built_in">rotate</span>(<span class="hljs-number">0deg</span>);
          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
        }
        <span class="hljs-number">10%</span> {
          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
        }
        <span class="hljs-selector-tag">to</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">100vh</span>) <span class="hljs-built_in">rotate</span>(<span class="hljs-number">360deg</span>);
          <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
        }
      }

      <span class="hljs-comment">/* ç¤¼ç‰©ç›’å®¹å™¨ */</span>
      <span class="hljs-selector-class">.gifts</span> {
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">bottom</span>: -<span class="hljs-number">80px</span>;
        <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
        <span class="hljs-attribute">display</span>: flex;
        <span class="hljs-attribute">gap</span>: <span class="hljs-number">25px</span>;
        <span class="hljs-attribute">z-index</span>: <span class="hljs-number">5</span>;
      }

      <span class="hljs-comment">/* ç¤¼ç‰©ç›’æ ·å¼ - ç«‹ä½“æ•ˆæœ */</span>
      <span class="hljs-selector-class">.gift</span> {
        <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">40px</span>;
        <span class="hljs-attribute">position</span>: relative;
        <span class="hljs-attribute">animation</span>: bounce <span class="hljs-number">2s</span> ease-in-out infinite;
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">3px</span>;
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-number">10px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>);
      }

      <span class="hljs-comment">/* ç¤¼ç‰©ç›’å¼¹è·³åŠ¨ç”» - æ›´è‡ªç„¶çš„æ•ˆæœ */</span>
      <span class="hljs-keyword">@keyframes</span> bounce {
        <span class="hljs-number">0%</span>,
        <span class="hljs-number">100%</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>);
        }
        <span class="hljs-number">50%</span> {
          <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">15px</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.05</span>);
        }
      }

      <span class="hljs-comment">/* ä¸åŒé¢œè‰²çš„ç¤¼ç‰©ç›’ï¼Œæ·»åŠ æ¸å˜å’Œç«‹ä½“æ•ˆæœ */</span>
      <span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.red</span> {
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#ff0000</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#cc0000</span> <span class="hljs-number">100%</span>);
      }

      <span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.green</span> {
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#008000</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#006400</span> <span class="hljs-number">100%</span>);
      }

      <span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.blue</span> {
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#0000ff</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#0000cc</span> <span class="hljs-number">100%</span>);
      }

      <span class="hljs-selector-class">.gift</span><span class="hljs-selector-class">.yellow</span> {
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#ffff00</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#cccc00</span> <span class="hljs-number">100%</span>);
      }

      <span class="hljs-comment">/* ç¤¼ç‰©ç›’ç›–å­ - ç«‹ä½“æ•ˆæœ */</span>
      <span class="hljs-selector-class">.gift</span><span class="hljs-selector-pseudo">::before</span> {
        <span class="hljs-attribute">content</span>: <span class="hljs-string">""</span>;
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">top</span>: -<span class="hljs-number">8px</span>;
        <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">8px</span>;
        <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(
          <span class="hljs-number">135deg</span>,
          <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.3</span>) <span class="hljs-number">0%</span>,
          <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.1</span>) <span class="hljs-number">100%</span>
        );
        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">2px</span> <span class="hljs-number">2px</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>;
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> -<span class="hljs-number">2px</span> <span class="hljs-number">5px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.2</span>);
      }

      <span class="hljs-comment">/* ç¤¼ç‰©ç›’ä¸å¸¦ - æ›´ç¾è§‚çš„è®¾è®¡ */</span>
      <span class="hljs-selector-class">.gift</span><span class="hljs-selector-pseudo">::after</span> {
        <span class="hljs-attribute">content</span>: <span class="hljs-string">""</span>;
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">8px</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">50%</span>);
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">3px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>);
      }

      <span class="hljs-comment">/* ç¤¼ç‰©ç›’åº•éƒ¨ä¸å¸¦ */</span>
      <span class="hljs-selector-class">.gift</span> {
        <span class="hljs-attribute">position</span>: relative;
      }

      <span class="hljs-comment">/* ç¤¼ç‰©ç›’ä¸å¸¦è£…é¥° */</span>
      <span class="hljs-selector-class">.gift</span> <span class="hljs-selector-tag">span</span> {
        <span class="hljs-attribute">position</span>: absolute;
        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
        <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
        <span class="hljs-attribute">height</span>: <span class="hljs-number">8px</span>;
        <span class="hljs-attribute">top</span>: <span class="hljs-number">50%</span>;
        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">50%</span>);
        <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">3px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>);
      }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ğŸ… Merry Christmas! ğŸ„<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tree"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- åœ£è¯æ ‘çš„æ ‘å¹² --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"trunk"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- åœ£è¯æ ‘çš„æ ‘å† ï¼Œç”¨ä¸‰ä¸ªä¸‰è§’å½¢ç»„æˆ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"leaves leaves-1"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"leaves leaves-2"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"leaves leaves-3"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- åœ£è¯æ ‘ä¸Šçš„è£…é¥°å“ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"decorations"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ ‘é¡¶æ˜Ÿæ˜Ÿ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"star"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- é›ªèŠ±æ•ˆæœ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"snow"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- ç¤¼ç‰©ç›’ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"gifts"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
      <span class="hljs-comment">// åœ£è¯æ ‘è£…é¥°å“ç”Ÿæˆ</span>
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">createDecorations</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> decorationsContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".decorations"</span>);
        <span class="hljs-keyword">const</span> colors = [<span class="hljs-string">"red"</span>, <span class="hljs-string">"blue"</span>, <span class="hljs-string">"yellow"</span>, <span class="hljs-string">"pink"</span>];
        <span class="hljs-keyword">const</span> sizes = [<span class="hljs-string">""</span>, <span class="hljs-string">"large"</span>, <span class="hljs-string">"small"</span>];
        <span class="hljs-keyword">const</span> count = <span class="hljs-number">25</span>; <span class="hljs-comment">// å¢åŠ æ•°é‡ï¼Œè®©æ ‘æ›´ä¸°å¯Œ</span>

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {
          <span class="hljs-keyword">const</span> decoration = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"div"</span>);
          decoration.<span class="hljs-property">className</span> = <span class="hljs-string">`decoration <span class="hljs-subst">${
            colors[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * colors.length)]
          }</span> <span class="hljs-subst">${sizes[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * sizes.length)]}</span>`</span>;

          <span class="hljs-comment">// ç®€å•çš„éšæœºä½ç½®ï¼Œç¡®ä¿åœ¨æ ‘å†…éƒ¨</span>
          <span class="hljs-keyword">const</span> x = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">200</span> - <span class="hljs-number">100</span>; <span class="hljs-comment">// -100åˆ°100ä¹‹é—´</span>
          <span class="hljs-keyword">const</span> y = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">180</span>; <span class="hljs-comment">// 0åˆ°180ä¹‹é—´</span>

          <span class="hljs-comment">// ç¡®ä¿åœ¨ä¸‰è§’å½¢æ ‘å† èŒƒå›´å†…</span>
          <span class="hljs-keyword">const</span> distanceFromCenter = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(x);
          <span class="hljs-keyword">const</span> maxWidthAtHeight = <span class="hljs-number">150</span> - (y / <span class="hljs-number">180</span>) * <span class="hljs-number">100</span>;

          <span class="hljs-keyword">if</span> (distanceFromCenter &lt; maxWidthAtHeight) {
            decoration.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`calc(50% + <span class="hljs-subst">${x}</span>px)`</span>;
            decoration.<span class="hljs-property">style</span>.<span class="hljs-property">bottom</span> = <span class="hljs-string">`<span class="hljs-subst">${y}</span>px`</span>;
            decoration.<span class="hljs-property">style</span>.<span class="hljs-property">animationDelay</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">2</span>}</span>s`</span>;
            decoration.<span class="hljs-property">style</span>.<span class="hljs-property">zIndex</span> = <span class="hljs-number">2</span>;

            decorationsContainer.<span class="hljs-title function_">appendChild</span>(decoration);
          }
        }
      }

      <span class="hljs-comment">// é›ªèŠ±ç”Ÿæˆå™¨</span>
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">createSnow</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> snowContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".snow"</span>);
        <span class="hljs-keyword">const</span> snowflakeCount = <span class="hljs-number">100</span>;

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; snowflakeCount; i++) {
          <span class="hljs-keyword">const</span> snowflake = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"div"</span>);
          snowflake.<span class="hljs-property">className</span> = <span class="hljs-string">"snowflake"</span>;

          <span class="hljs-comment">// éšæœºå¤§å°</span>
          <span class="hljs-keyword">const</span> size = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">8</span> + <span class="hljs-number">2</span>;
          snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">`<span class="hljs-subst">${size}</span>px`</span>;
          snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">`<span class="hljs-subst">${size}</span>px`</span>;

          <span class="hljs-comment">// éšæœºä½ç½®</span>
          snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">100</span>}</span>vw`</span>;

          <span class="hljs-comment">// éšæœºä¸‹è½é€Ÿåº¦</span>
          <span class="hljs-keyword">const</span> duration = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span> + <span class="hljs-number">5</span>;
          snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">animationDuration</span> = <span class="hljs-string">`<span class="hljs-subst">${duration}</span>s`</span>;

          <span class="hljs-comment">// éšæœºå»¶è¿Ÿ</span>
          snowflake.<span class="hljs-property">style</span>.<span class="hljs-property">animationDelay</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">5</span>}</span>s`</span>;

          snowContainer.<span class="hljs-title function_">appendChild</span>(snowflake);
        }
      }

      <span class="hljs-comment">// ç¤¼ç‰©ç›’ç”Ÿæˆ</span>
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">createGifts</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> giftsContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".gifts"</span>);
        <span class="hljs-keyword">const</span> colors = [<span class="hljs-string">"red"</span>, <span class="hljs-string">"green"</span>, <span class="hljs-string">"blue"</span>, <span class="hljs-string">"yellow"</span>];
        <span class="hljs-keyword">const</span> count = <span class="hljs-number">5</span>; <span class="hljs-comment">// å¢åŠ ä¸€ä¸ªç¤¼ç‰©ç›’</span>

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {
          <span class="hljs-keyword">const</span> gift = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"div"</span>);
          gift.<span class="hljs-property">className</span> = <span class="hljs-string">`gift <span class="hljs-subst">${
            colors[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * colors.length)]
          }</span>`</span>;
          gift.<span class="hljs-property">style</span>.<span class="hljs-property">animationDelay</span> = <span class="hljs-string">`<span class="hljs-subst">${i * <span class="hljs-number">0.3</span>}</span>s`</span>;

          <span class="hljs-comment">// æ·»åŠ ä¸å¸¦è£…é¥°</span>
          <span class="hljs-keyword">const</span> ribbon = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"span"</span>);
          gift.<span class="hljs-title function_">appendChild</span>(ribbon);

          giftsContainer.<span class="hljs-title function_">appendChild</span>(gift);
        }
      }

      <span class="hljs-comment">// é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ</span>
      <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"DOMContentLoaded"</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">createDecorations</span>();
        <span class="hljs-title function_">createSnow</span>();
        <span class="hljs-title function_">createGifts</span>();
      });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h3 data-id="heading-8">ğŸ¨ ä»£ç è§£æ</h3>
<h4 data-id="heading-9">1. åœ£è¯æ ‘çš„ç»“æ„ ğŸ—ï¸</h4>
<p>åœ£è¯æ ‘çš„ç»“æ„å…¶å®å¾ˆç®€å•ï¼š</p>
<ul>
<li><strong>æ ‘å¹²</strong>ï¼šä¸€ä¸ªæ£•è‰²çš„é•¿æ–¹å½¢</li>
<li><strong>æ ‘å† </strong>ï¼šä¸‰ä¸ªå¤§å°ä¸ä¸€çš„ä¸‰è§’å½¢å åŠ åœ¨ä¸€èµ·</li>
<li><strong>æ ‘é¡¶æ˜Ÿæ˜Ÿ</strong>ï¼šä¸€ä¸ªé‡‘è‰²çš„äº”è§’æ˜Ÿï¼ˆç”¨ CSS è¾¹æ¡†å®ç°ï¼‰</li>
<li><strong>è£…é¥°å“</strong>ï¼šå½©è‰²çš„å°åœ†ç‚¹ï¼Œéšæœºåˆ†å¸ƒåœ¨æ ‘å† ä¸Š</li>
<li><strong>é›ªèŠ±</strong>ï¼šç™½è‰²çš„å°åœ†ç‚¹ï¼Œä»å¤©ä¸Šé£˜è½</li>
<li><strong>ç¤¼ç‰©ç›’</strong>ï¼šå½©è‰²çš„æ­£æ–¹å½¢ï¼Œå¸¦æœ‰ç™½è‰²ä¸å¸¦</li>
</ul>
<h4 data-id="heading-10">2. CSS çš„é­”æ³• âœ¨</h4>
<ul>
<li><strong>æ¸å˜èƒŒæ™¯</strong>ï¼šè®©æ ‘å¹²å’Œæ ‘å† çœ‹èµ·æ¥æ›´æœ‰å±‚æ¬¡æ„Ÿ</li>
<li><strong>åŠ¨ç”»æ•ˆæœ</strong>ï¼š
<ul>
<li>æ ‡é¢˜å‘å…‰åŠ¨ç”» <code>glow</code></li>
<li>æ˜Ÿæ˜Ÿé—ªçƒåŠ¨ç”» <code>twinkle</code></li>
<li>è£…é¥°å“é—ªçƒåŠ¨ç”» <code>blink</code></li>
<li>é›ªèŠ±ä¸‹è½åŠ¨ç”» <code>fall</code></li>
<li>ç¤¼ç‰©ç›’å¼¹è·³åŠ¨ç”» <code>bounce</code></li>
</ul>
</li>
<li><strong>å®šä½æŠ€å·§</strong>ï¼šä½¿ç”¨ <code>position: absolute</code> å’Œ <code>transform: translateX(-50%)</code> è®©å…ƒç´ å±…ä¸­</li>
</ul>
<h4 data-id="heading-11">3. JavaScript çš„çµé­‚ ğŸ§ </h4>
<ul>
<li><strong>åŠ¨æ€ç”Ÿæˆè£…é¥°å“</strong>ï¼šéšæœºä½ç½®ã€éšæœºé¢œè‰²ã€éšæœºé—ªçƒå»¶è¿Ÿ</li>
<li><strong>é›ªèŠ±ç”Ÿæˆå™¨</strong>ï¼š100 ç‰‡é›ªèŠ±ï¼Œéšæœºå¤§å°ã€éšæœºé€Ÿåº¦ã€éšæœºä½ç½®</li>
<li><strong>ç¤¼ç‰©ç›’ç”Ÿæˆ</strong>ï¼š4 ä¸ªä¸åŒé¢œè‰²çš„ç¤¼ç‰©ç›’ï¼Œå¸¦æœ‰å¼¹è·³æ•ˆæœ</li>
</ul>
<h3 data-id="heading-12">ğŸ æ‰©å±•åŠŸèƒ½</h3>
<p>å¦‚æœä½ è§‰å¾—è¿™ä¸ªåœ£è¯æ ‘è¿˜ä¸å¤Ÿç‚«é…·ï¼Œä½ å¯ä»¥å°è¯•ï¼š</p>
<ol>
<li><strong>æ·»åŠ éŸ³ä¹</strong>ï¼šç”¨ HTML5 çš„ <code>audio</code> æ ‡ç­¾æ·»åŠ åœ£è¯æ­Œæ›² ğŸµ</li>
<li><strong>äº¤äº’æ•ˆæœ</strong>ï¼šç‚¹å‡»åœ£è¯æ ‘ä¼šä¸‹é›ªæˆ–æ’­æ”¾éŸ³ä¹ ğŸ¶</li>
<li><strong>3D æ•ˆæœ</strong>ï¼šä½¿ç”¨ CSS 3D å˜æ¢è®©åœ£è¯æ ‘æ—‹è½¬ ğŸŒ€</li>
<li><strong>æ›´å¤šè£…é¥°å“</strong>ï¼šæ·»åŠ å½©ç¯ã€é“ƒé“›ã€è¢œå­ç­‰ ğŸ§¦</li>
</ol>
<h3 data-id="heading-13">ğŸ¤£ ç¨‹åºå‘˜çš„åœ£è¯èŠ‚</h3>
<p>ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œæˆ‘ä»¬çš„åœ£è¯èŠ‚æ˜¯è¿™æ ·çš„ï¼š</p>
<ul>
<li>åˆ«äººåœ¨è£…é¥°åœ£è¯æ ‘ï¼Œæˆ‘ä»¬åœ¨è£…é¥°ä»£ç </li>
<li>åˆ«äººåœ¨æ‹†ç¤¼ç‰©ï¼Œæˆ‘ä»¬åœ¨æ‹† bug</li>
<li>åˆ«äººåœ¨åƒç«é¸¡ï¼Œæˆ‘ä»¬åœ¨åƒå¤–å–</li>
<li>åˆ«äººåœ¨çœ‹æ˜¥æ™šï¼Œæˆ‘ä»¬åœ¨çœ‹æŠ€æœ¯æ–‡æ¡£</li>
</ul>
<p>ä½†æ˜¯æ²¡å…³ç³»ï¼Œæˆ‘ä»¬æœ‰å±äºè‡ªå·±çš„å¿«ä¹ï¼å½“çœ‹åˆ°è‡ªå·±å†™çš„åœ£è¯æ ‘åœ¨å±å¹•ä¸Šé—ªé—ªå‘å…‰æ—¶ï¼Œé‚£ç§æˆå°±æ„Ÿæ˜¯æ— æ³•è¨€å–»çš„ï¼ğŸŒŸ</p>
<h3 data-id="heading-14">ğŸ„ ç»“è¯­</h3>
<p>å¥½äº†ï¼Œä»Šå¤©çš„åœ£è¯æ ‘æ•™ç¨‹å°±åˆ°è¿™é‡Œäº†ï¼å¸Œæœ›ä½ èƒ½å–œæ¬¢è¿™ä¸ªä»£ç åœ£è¯æ ‘ï¼Œä¹Ÿå¸Œæœ›ä½ èƒ½åœ¨åœ£è¯èŠ‚æ”¶è·æ»¡æ»¡çš„å¿«ä¹å’Œå¹¸ç¦ï¼ğŸ…</p>
<p>è®°ä½ï¼Œç”Ÿæ´»å°±åƒåœ£è¯æ ‘ï¼Œéœ€è¦æˆ‘ä»¬ç”¨å¿ƒå»è£…é¥°ï¼Œæ‰èƒ½å˜å¾—æ›´åŠ ç¾å¥½ï¼âœ¨</p>
<p>æœ€åï¼Œç¥å¤§å®¶ï¼š</p>
<ul>
<li>åœ£è¯å¿«ä¹ï¼ğŸ„</li>
<li>ä»£ç æ—  bugï¼ğŸ›âŒ</li>
<li>å·¥èµ„æ¶¨ä¸åœï¼ğŸ’°</li>
<li>æ°¸è¿œä¸è„±å‘ï¼ğŸ‘¨â€ğŸ’»ğŸ‘©â€ğŸ’»</li>
</ul>
<p>Merry Christmas and Happy New Year! ğŸ‰</p>
<hr/>
<p>ğŸ’¡ <strong>å°è´´å£«</strong>ï¼šå¦‚æœä½ è§‰å¾—è¿™ä¸ªåœ£è¯æ ‘ä¸é”™ï¼Œåˆ«å¿˜äº†åˆ†äº«ç»™ä½ çš„æœ‹å‹ï¼Œè®©ä»–ä»¬ä¹Ÿæ„Ÿå—ä¸€ä¸‹ç¨‹åºå‘˜çš„åœ£è¯æµªæ¼«ï¼ğŸ˜‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å­¦é™¢æœ¬å¤§äºŒæ··å­ç»ˆäºæ‰¾åˆ°å®ä¹ äº†...]]></title>    <link>https://juejin.cn/post/7587246055458471963</link>    <guid>https://juejin.cn/post/7587246055458471963</guid>    <pubDate>2025-12-25T01:11:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587246055458471963" data-draft-id="7587313610695671835" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å­¦é™¢æœ¬å¤§äºŒæ··å­ç»ˆäºæ‰¾åˆ°å®ä¹ äº†..."/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2025-12-25T01:11:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å°å‡"/> <meta itemprop="url" content="https://juejin.cn/user/2285197690931932"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å­¦é™¢æœ¬å¤§äºŒæ··å­ç»ˆäºæ‰¾åˆ°å®ä¹ äº†...
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2285197690931932/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å°å‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T01:11:14.000Z" title="Thu Dec 25 2025 01:11:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™æ®µæ—¶é—´åœ¨æ‰¾å®ä¹ ï¼Œåˆ°ç°åœ¨æœ‰ 3 ä¸ªä¸­å°å‚çš„ offerï¼Œå…ˆè¿‡æ¸¡ä¸€ä¸‹å§ã€‚è·ç¦»ä¸Šæ¬¡å‘å¸–å·²ç»è¿‡å»å¤§åŠå¹´äº†ï¼Œè¿™æ®µæ—¶é—´é‡Œè‡ªå·±åŠªåŠ›è¿‡ï¼Œè¿·èŒ«è¿‡ï¼Œç„¦è™‘è¿‡ï¼Œä½†å¥½åœ¨æ²¡æœ‰åœæ­¢ç»§ç»­å‰è¿›ã€‚éå¸¸æ„Ÿè°¢å¸®åŠ©è¿‡æˆ‘çš„å‰è¾ˆå’Œæœ‹å‹ä»¬ï¼Œè‡³å°‘è®©æˆ‘çœ‹åˆ°äº†å¸Œæœ›ï¼Œä¸ç®¡åé¢èƒ½ä¸èƒ½è¿›å¤§å‚ï¼Œåœ¨å½“ä¸‹çš„è®¤çŸ¥é‡Œï¼Œå°½åŠ›å¾—å»åšè‡ªå·±è®¤ä¸ºå¯¹çš„äº‹æƒ…å°±å¤Ÿäº†ã€‚</p>
<h3 data-id="heading-0">å¤§ä¸€</h3>
<p>è¿˜è®°å¾—åˆšä¸Šå¤§ä¸€çš„æ—¶å€™å•¥éƒ½ä¸æ‡‚ï¼Œé‚£æ®µæ—¶é—´è‡ªå·±ä¹Ÿéå¸¸è¿·èŒ«å‘€ï¼Œä¸çŸ¥é“è¦é€‰ä»€ä¹ˆæ–¹å‘ï¼Œäºæ˜¯å°±åœ¨ç½‘ä¸Šç–¯ç‹‚åœ°çœ‹åˆ«äººçš„ç»éªŒè´´ï¼Œæœ‰ä¸æ‡‚çš„å°±é—®å‰è¾ˆä»¬ã€‚é‚£æ—¶å€™å¯¹è€ƒç ”çš„æ¬²æœ›éå¸¸å¼ºï¼Œæƒ³ç€ä¸€å®šè¦è€ƒç ”æ¥å¼¥è¡¥è‡ªå·±é«˜è€ƒå¤±åˆ©çš„é—æ†¾ï¼Œé«˜æ•° è‹±è¯­ æ”¿æ²» 408 è¦æ€ä¹ˆå­¦ï¼Œç»Ÿç»Ÿäº†è§£äº†ä¸ªéï¼Œå¹¶è®¡åˆ’ç€è¦åœ¨å¤§äºŒä¸‹å¼€å§‹è€ƒç ”ä¹‹è·¯(ç°åœ¨å°±å½“æ”¾å±)ï¼Œå‰ææ˜¯è‡ªå·±è¦åœ¨å¤§äºŒå‰æ‰¾åˆ°å®ä¹ ï¼Œè¿™æ ·æœ‰ä¿è¯ç‚¹ã€‚(éšç€è‡ªå·±å¯¹è€ƒç ”çš„ä¸æ–­äº†è§£ï¼Œç°åœ¨è‡ªå·±å®Œå…¨ä¸æƒ³è¯»ç ”äº†ï¼Œæ›´æƒ³è‡ªç”±ç‚¹)ã€‚ç„¶åå°±æ˜¯äº†è§£åˆ°ç®—æ³•å¥½åƒå¾ˆé‡è¦(å½“æ—¶çš„è®¤çŸ¥)ï¼Œå¾—å¤šå‚åŠ å‚åŠ æ¯”èµ›æ¬¡æ‰è¡Œï¼è“æ¡¥æ¯å•¥çš„ï¼Œæ‰€ä»¥å­¦å®Œä¸€ä¸ªæœˆçš„ C è¯­è¨€åå°±å¼€å§‹å­¦ç®—æ³•äº†ï¼Œæ¯å¤©éƒ½åœ¨çœ‹ç®—æ³•ä¹¦åšé¢˜ï¼Œçœ‹äº†å¥½å‡ æœ¬ç®—æ³•ä¹¦ï¼Œè§‰å¾—ç®—æ³•çœŸçš„æŒºæœ‰æ„æ€çš„ï¼Œè‡ªå·±ä¹ŸåŠ å…¥äº†è€å¸ˆçš„ç®—æ³•å›¢é˜Ÿï¼Œå°±è¿™æ ·å­¦äº†æœ‰3 4ä¸ªæœˆå§ï¼Œåšäº†å››äº”ç™¾é“é¢˜ã€‚ç»è¿‡æˆ‘ä¸å±‘åœ°åŠªåŠ›ï¼Œç»ˆäºåœ¨è“æ¡¥æ¯ä¸Šè·å¾—äº†çœä¸‰çš„å¥½æˆç»©...... é‚£æ—¶å€™æ‰å‘ç°æœ‰è¶£å½’æœ‰è¶£ï¼Œè‡ªå·±çœŸä¸æ˜¯é‚£å—æ–™[ç¬‘cry]</p>
<p>äºæ˜¯å¼€å§‹å°±å­¦ Java äº†(å½“æ—¶è¿˜é—®æˆ‘è€å¸ˆ Java æ˜¯ä¸æ˜¯è¿‡æ—¶äº†ï¼Œæˆ‘è€å¸ˆè¯´å¯ä»¥å­¦ goï¼Œå¥½åœ¨æˆ‘è¿˜æ˜¯å­¦ Java äº†)ï¼Œä¹Ÿæ…¢æ…¢äº†è§£äº† Java è¯¥å¦‚ä½•å­¦ä¹ ï¼Œä¸‹è½½äº†ç‰›å®¢ï¼Œç»“æœçœ‹åˆ°åŒå±Šå±…ç„¶æœ‰äººåœ¨æ”¹ç®€å†æ‰¾å®ä¹ äº†[æ‡µ] å½“æ—¶å°±è’™è”½äº†ï¼Œåæ‚”æ²¡æ—©ç‚¹å­¦ Javaã€‚ä¹Ÿæ…¢æ…¢äº†è§£åˆ°å­¦é™¢æœ¬å­¦ Java å°±æ˜¯æ­»è·¯ä¸€æ¡ï¼Œäºæ˜¯æˆ‘åˆé™·å…¥äº†æ·±æ·±åœ°è‡ªå·±æˆ‘æ€€ç–‘..... å¥½åœ¨ä¹Ÿæ…¢æ…¢è®¤è¯†åˆ°ä¸€äº›å­¦é™¢æœ¬å¤§ä½¬ï¼Œè‡³å°‘è®©æˆ‘çœ‹åˆ°äº†å¸Œæœ›ï¼Œäºæ˜¯æƒ³åŠæ³•å»è”ç³»åˆ°å­¦é•¿ä»¬ï¼Œé—®ä¹‹å‰å­¦é•¿ä»¬æ˜¯æ€ä¹ˆè¿›å¤§å‚çš„ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥å¼¥è¡¥ä¸€ä¸‹å­¦å†çš„å·®è·å‘¢[æ‰å°çç äº†] é—®äº†ä¸€åœˆå‘ç°æœ€é‡è¦çš„å°±æ˜¯å·å®ä¹ ï¼Œç„¶åæ˜¯åšå®¢å’Œå¼€æºï¼Œç«èµ›é™¤äº† ACM å¤–ï¼Œå…¶ä»–å«é‡‘é‡ä¸é«˜ã€‚äº†è§£åˆ°è¿™é‡Œï¼Œæˆ‘å°±å¼€å§‹å†™å†™åšå®¢ï¼Œå½“åšç¬”è®°å’Œæ€»ç»“ä¹Ÿæ˜¯éå¸¸ä¸é”™çš„ã€‚åˆ°ç°åœ¨åšå®¢ä¹Ÿæœ‰ç‚¹æˆç»©äº†(è™½ç„¶éƒ½æ˜¯æ°´æ–‡)ï¼Œæ€»è®¿é—®é‡ 60 ä¸‡+ï¼Œç²‰ä¸é‡ 4K+ï¼Œè·å¾—è¿‡ CSDN Java æ–°æ˜Ÿåˆ›ä½œè€…ï¼Œè…¾è®¯äº‘åˆ›ä½œä¹‹æ˜Ÿï¼Œé˜¿é‡Œäº‘ä¸“å®¶åšä¸»ï¼Œåä¸ºäº‘äº‘äº«ä¸“å®¶ç§°å·ï¼Œé¢è¯•çš„æ—¶å€™é¢è¯•å®˜ä¹Ÿéƒ½ä¼šé—®ä¸€é—®ï¼Œè‡³å°‘æœ‰ç‚¹åŠ åˆ†å§ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ceb6bfbe33e4625ac05bf7ef34f765c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5bCP5YGH:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229873&amp;x-signature=AWI%2B4uKiKrKWvkd1yAml2u%2FImHs%3D" alt="" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2018f1fefd824a8da807db4535f805f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5bCP5YGH:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229873&amp;x-signature=pM0zO5hlpJvIuijz1pVqDbpJRsg%3D" alt="" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b6f71d948b641e18e6ae95fca990899~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5bCP5YGH:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229873&amp;x-signature=AHqKYiyUH4ElekFqBpkdLcaKXpc%3D" alt="" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d9a07de43b44b0ca548ac892a3155d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5bCP5YGH:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767229873&amp;x-signature=XfbW9lUcxsCw3vpe0EmjSm6%2F3Es%3D" alt="" loading="lazy"/></p>
<p>å°±è¿™æ ·å­¦åˆ°äº†æš‘å‡ï¼Œæš‘å‡ä¸¤ä¸ªæœˆåœ¨å®¶å…¶å®å­¦å¾—ä¸å¤š(ç°åœ¨æƒ³æƒ³éƒ½å¤ªåæ‚”äº†ï¼Œå…„å¼Ÿä»¬ç¯å¢ƒå¾ˆé‡è¦å‘€ï¼Œä¸€å®šè¦é€‰ä¸€ä¸ªé€‚åˆè‡ªå·±çš„ç¯å¢ƒï¼Œä¸ç„¶æ•ˆç‡çœŸä¸é«˜[æ‰“è„¸äº†])ï¼Œé¡¹ç›®å‡†å¤‡äº†ä¸€ä¸ªå†™åœ¨ç®€å†ä¸Šäº†ï¼Œæƒ³ç€å¤§äºŒå¼€å­¦å°±è¦æ‰¾å®ä¹ äº†ï¼(æœäº†ï¼Œæƒ³æ˜¯è¿™ä¹ˆæƒ³çš„ï¼Œä½†æ˜¯å› ä¸ºè‡ªå·±å’Œå­¦æ ¡çš„ç§ç§åŸå› å°±æ‹–åˆ°äº†ç°åœ¨æ‰æ‰¾å®ä¹ [è€äººæ‰‹æœº])</p>
<h3 data-id="heading-1">å¤§äºŒ</h3>
<p>è½¬çœ¼é—´å°±æ¥åˆ°äº†å¤§äºŒï¼Œå› ä¸ºæœ‰ä¸ªæœ‹å‹(åŒé)åœ¨æš‘å‡è¿›äº†å¤§å‚(ç°åœ¨å·²ç»å¼€å§‹ç¬¬ä¸‰æ®µå¤§å‚å®ä¹ äº† æ˜¯æˆ‘çš„å¶åƒå“ˆå“ˆ å¤ªå¼ºäº†)ï¼Œå› æ­¤ä¹Ÿæé†’äº†è‡ªå·±ä¸€å®šè¦æ—©ç‚¹æ‰¾å®ä¹ æ‰è¡Œï¼Œå¼€å§‹å‡†å¤‡ç¬¬äºŒä¸ªé¡¹ç›®å†™åœ¨ç®€å†ä¸Šï¼Œå¹¶å¼€å§‹èƒŒå…«è‚¡ï¼ŒèŠ±äº†ä¸€ä¸¤ä¸ªæœˆè¿‡äº†å°æ—çš„å…«è‚¡ï¼Œç»“æœéƒ½å¿˜å…‰å…‰äº†[æƒŠè®¶] å®åœ¨æ˜¯å¤ªå¤šäº†ï¼Œé©¬ä¸Šæ”¹å˜ç­–ç•¥ï¼Œå¾—å¥½å¥½èƒŒé«˜é¢‘å…«è‚¡æ‰è¡Œï¼ŒèƒŒå…«è‚¡çš„è¯å…„å¼Ÿä»¬ä¸€å®šè¦ç»“åˆç†è§£æ¥èƒŒï¼Œä¸ç„¶å¤ªéš¾èƒŒäº†(è‡³å°‘æˆ‘æ˜¯è¿™æ ·çš„)ï¼Œè€Œä¸”è¦æ•´ç†å¾—åå£è¯­åŒ–ä¸€ç‚¹ï¼Œæ–¹ä¾¿è¯´å‡ºæ¥ï¼Œé¢è¯•åªéœ€è¦ä½ ç‚¹å‡ºé‡ç‚¹å°±å·®ä¸å¤šå•¦ã€‚æ‰¾ç¬¬ä¸€æ®µå®ä¹ çš„è¿‡ç¨‹æ˜¯éå¸¸éš¾çš„ï¼Œä½†é¢è¯•çš„å†…å®¹ä¸æ˜¯è¯´å¾ˆéš¾(è¿™é‡ŒæŒ‡å¾—æ˜¯ä¸­å°å‚)ï¼Œæˆ‘è¿˜è®°å¾—æˆ‘ç¬¬ä¸€æ¬¡é¢è¯•çš„ï¼Œæˆ‘è§‰å¾—æˆ‘ä»€ä¹ˆéƒ½æ²¡å‡†å¤‡å¥½ï¼Œé¡¹ç›®æ²¡å‡†å¤‡å¥½ã€é«˜é¢‘å…«è‚¡è¿˜èƒŒä¸ç†Ÿã€è‡ªæˆ‘ä»‹ç»æ€ä¹ˆæå•Šï¼Œæ€ä¹ˆä»‹ç»é¡¹ç›®å‘€ æˆ‘ä¸æ˜¯å†™åœ¨ç®€å†ä¸Šäº†å˜›[ç–‘æƒ‘]ç­‰ç­‰é—®é¢˜ï¼Œç»“æœç¬¬ä¸€æ¬¡é¢è¯•å…¨ç¨‹å°±é—®äº†åŸºç¡€å…«è‚¡[ç­‰offer] å“ˆå“ˆæˆ‘å›ç­”å¾—ç¨€çƒ‚ï¼Œäºæ˜¯æˆ‘å°±å¥½å¥½å‡†å¤‡é«˜é¢‘å…«è‚¡äº†ï¼Œç¬¬äºŒæ¬¡é¢è¯•å…¨ç¨‹å°±é—®äº†é¡¹ç›®ï¼Œæ²¡é—®å…«è‚¡ï¼Œæˆ‘ä¸€å¼€å§‹è¯´çš„æ—¶å€™å°±æ˜¯æŒ‰ç…§ç®€å†ä¸Šé¢çš„æ¥å¿µçš„ï¼Œé¢è¯•å®˜æ‰“æ–­äº†æˆ‘ï¼Œè¯´è¿™äº›ä½ ç®€å†ä¸Šéƒ½æœ‰å†™ï¼Œæˆ‘è¦é—®å¾—æ˜¯ä½ åœ¨åšè¿™ä¸ªé¡¹ç›®çš„è¿‡ç¨‹ä¸­é‡åˆ°äº†å“ªäº›å¤æ‚çš„é—®é¢˜ä»¥åŠå¦‚ä½•è§£å†³çš„ï¼Ÿå“ˆå“ˆæˆ‘ç­”å¾—ä¹Ÿæ˜¯ç¨€çƒ‚ï¼Œäºæ˜¯æˆ‘å°±å¥½å¥½å¤ç›˜å¤ç›˜ï¼Œé‡æ–°æ•´ç†äº†é¡¹ç›®ä»‹ç»ï¼Œè¿˜æœ‰ä¸€æ¬¡ä¸­å°å‚é¢è¯•ï¼Œä¸€ä¸Šæ¥å°±è®©æˆ‘å†™ä¸¤é“åŠ›æ‰£ä¸­ç­‰é¢˜ï¼Œå“ˆå“ˆæˆ‘ä¸ä¼š[åºŸäº†] åæ­£å•¥æƒ…å†µéƒ½æœ‰ï¼Œæ‰€ä»¥æ‰¾å®ä¹ è¿˜æ˜¯æŒºçœ‹è¿æ°”çš„ã€‚å…„å¼Ÿä»¬è¦æ‰¾å®ä¹ å°±å¤šé¢é¢ï¼Œè¾¹é¢è¾¹æ€»ç»“ï¼Œè¿™æ ·ä¼šè¿›æ­¥å¾—æ¯”è¾ƒå¿«ã€‚å°±è¿™æ ·ï¼Œè¾¹æŠ•è¾¹é¢ç›´åˆ°ç°åœ¨ã€‚</p>
<h3 data-id="heading-2">æ€»ç»“ä¸è§„åˆ’</h3>
<p>æ€»ç»“ï¼šè‡ªå·±è¿˜æœ‰å¾ˆå¤šçš„ä¸è¶³ï¼Œå¸Œæœ›èƒ½å’Œå¤§å®¶ä¸€èµ·è¿›æ­¥ï¼Œä¸ºäº†è‡ªå·±çš„ç›®æ ‡å»åŠªåŠ›ï¼Œçºµä½¿ç–¾é£èµ·ï¼Œäººç”Ÿä¸è¨€å¼ƒã€‚</p>
<p>è§„åˆ’ï¼šç»§ç»­åšåšå®¢ï¼Œå‘ç™¾ä¸‡è®¿é—®é‡é è¿‘ï¼Œç„¶ååé¢å¯èƒ½ä¼šå»ææå¼€æºï¼Œå¤šå·å·å®ä¹ ï¼Œå°è¯•åšä¸€ä¸‹è‡ªåª’ä½“ï¼Œå°½åŠ›å»è¯•è¯•çœ‹èƒ½ä¸èƒ½è¿›å¤§å‚ï¼Œè‡³å°‘ä¸ç»™è‡ªå·±ç•™ä¸‹å•¥é—æ†¾ï¼Œä¸å›å…±å‹‰ï¼Œæ„¿ä½ æˆ‘éƒ½èƒ½è¾¾åˆ°è‡ªå·±ç†æƒ³çš„ç›®æ ‡ï¼Œä½ è‹¥ç››å¼€ï¼Œè´è¶è‡ªæ¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AndroidåŸºäºå…±äº«å†…å­˜å®ç°è·¨è¿›ç¨‹å¤§æ–‡ä»¶ä¼ è¾“]]></title>    <link>https://juejin.cn/post/7587264707284877322</link>    <guid>https://juejin.cn/post/7587264707284877322</guid>    <pubDate>2025-12-25T01:15:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587264707284877322" data-draft-id="7587264707284844554" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AndroidåŸºäºå…±äº«å†…å­˜å®ç°è·¨è¿›ç¨‹å¤§æ–‡ä»¶ä¼ è¾“"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-12-25T01:15:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å®¹åè°¢å"/> <meta itemprop="url" content="https://juejin.cn/user/3755587450187432"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AndroidåŸºäºå…±äº«å†…å­˜å®ç°è·¨è¿›ç¨‹å¤§æ–‡ä»¶ä¼ è¾“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3755587450187432/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å®¹åè°¢å
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T01:15:08.000Z" title="Thu Dec 25 2025 01:15:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa94a1e880534348babcb1a5d0c755b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a655Y2O6LCi5ZCO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767230177&amp;x-signature=IqduMdMs6uETE6%2ByGRhAktSTTU0%3D" alt="å°é¢" loading="lazy"/></p>
<blockquote>
<p>è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼š<a href="https://juejin.cn/spost/7587264707284877322" target="_blank" title="https://juejin.cn/spost/7587264707284877322">juejin.cn/spost/75872â€¦</a></p>
<p>æœ¬æ–‡å‡ºè‡ª <a href="https://juejin.cn/user/3755587450187432/posts" target="_blank" title="https://juejin.cn/user/3755587450187432/posts">å®¹åè°¢åçš„åšå®¢</a></p>
</blockquote>
<h2 data-id="heading-0">0.å†™åœ¨å‰é¢</h2>
<p>åœ¨å®é™…çš„é¡¹ç›®å¼€å‘ä¸­ï¼Œä¸ºäº†æ›´å¥½çš„æ€§èƒ½å’Œç»“æ„ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæŠŠä¸€ä¸ªé¡¹ç›®åº”ç”¨åˆ†æˆå¤šä¸ªè¿›ç¨‹æˆ–è€…å¤šä¸ªç»„ä»¶ï¼Œå½“ä¸åŒè¿›ç¨‹çš„ä¸šåŠ¡ä¹‹é—´éœ€è¦é€šä¿¡æ—¶ï¼Œé€šå¸¸ä¼šé€‰æ‹©AIDLã€Bundleæˆ–è€…å¹¿æ’­çš„æ–¹å¼è¿›è¡Œé€šä¿¡ï¼Œè¿™äº›é€šä¿¡æ‰‹æ®µæœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹ï¼Œå°±æ˜¯åªæ”¯æŒç®€å•ã€å°å®¹é‡ã€ä¸é¢‘ç¹çš„æ•°æ®ä¼ è¾“ï¼Œå½“æˆ‘ä»¬çš„åº”ç”¨å­˜åœ¨è¿™æ ·çš„ä¸šåŠ¡åœºæ™¯ï¼Œæ¯”å¦‚è§†é¢‘æµè·¨è¿›ç¨‹ä¼ è¾“ã€å¤§æ–‡ä»¶è·¨è¿›ç¨‹ä¼ è¾“ç­‰éœ€è¦å¤æ‚æ•°æ®ã€é¢‘ç¹æ•°æ®äº¤æ¢çš„åŠŸèƒ½æ—¶ï¼Œå°±ä¸èƒ½ä½¿ç”¨ä¸Šè¿°çš„é€šä¿¡æ‰‹æ®µäº†ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥é€‰æ‹©å…±äº«å†…å­˜çš„æ–¹å¼è¿›è¡Œé€šä¿¡ï¼Œåœ¨è®¾å¤‡çš„å†…å­˜ä¸­å¼€è¾Ÿä¸€ä¸ªå›ºå®šå®¹é‡çš„ç©ºé—´ï¼Œä½¿ç”¨ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ï¼Œç”Ÿäº§è€…åœ¨å†…å­˜ä¸­å†™å…¥æ•°æ®ï¼Œé€šè¿‡PVæ“ä½œé€šçŸ¥æ¶ˆè´¹è€…è¿›è¡Œè¯»å–ï¼Œæ¶ˆè´¹è€…è¯»å–å®Œæˆåå†é€šçŸ¥ç”Ÿäº§è€…è¿›è¡Œå†™å…¥ã€‚</p>
<h2 data-id="heading-1">1.å®ç°</h2>
<h3 data-id="heading-2">1.1 æ•°æ®ç»“æ„</h3>
<p>é¦–å…ˆå®šä¹‰ä¸‹å…±äº«å†…å­˜ä¸­çš„æ•°æ®ç»“æ„ï¼Œé¦–å…ˆå®šä¹‰3ä¸ªä¿¡å·é‡ï¼š</p>
<ul>
<li>
<p>sem_empty: å®šä¹‰æ˜¯å¦å…è®¸å†™ï¼Œç”Ÿäº§è€…å†™å‰ P(empty)ï¼Œæ¶ˆè´¹è€…è¯»å V(empty)</p>
</li>
<li>
<p>sem_full: å®šä¹‰æ˜¯å¦å…è®¸è¯»ï¼Œæ¶ˆè´¹è€…è¯»å‰ P(full)ï¼Œç”Ÿäº§è€…å†™å V(full)</p>
</li>
<li>
<p>sem_mutex: å®šä¹‰è¯»å†™äº’æ–¥é”ï¼Œä¿æŠ¤ state/data_len/data çš„äº’æ–¥</p>
</li>
</ul>
<p>æ¥ä¸‹æ¥å®šä¹‰æ•°æ®ä¼ è¾“çš„çŠ¶æ€ï¼Œåˆ†åˆ«æ˜¯ IDLEï¼ˆç©ºé—²çŠ¶æ€ï¼‰ã€DATAï¼ˆä¼ è¾“æ•°æ®çŠ¶æ€ï¼‰ã€EOFï¼ˆæ–‡ä»¶ä¼ è¾“ç»“æŸçŠ¶æ€ï¼‰ï¼Œç„¶åå®šä¹‰æ¯æ¬¡ä¼ è¾“æ•°æ®çš„æœ‰æ•ˆé•¿åº¦ data_len å’Œæ•°æ®å— dataå±æ€§ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">/**
 * æ•°æ®ä¼ è¾“ç»“æ„
 */</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">SharedBlock</span> {
    <span class="hljs-comment">// æ˜¯å¦å…è®¸å†™ï¼ˆProducerï¼‰</span>
    <span class="hljs-type">sem_t</span> sem_empty;
    <span class="hljs-comment">// æ˜¯å¦å…è®¸è¯»ï¼ˆConsumerï¼‰</span>
    <span class="hljs-type">sem_t</span> sem_full;
    <span class="hljs-comment">// è¯»å†™äº’æ–¥é”</span>
    <span class="hljs-type">sem_t</span> sem_mutex;
    <span class="hljs-comment">// å½“å‰çŠ¶æ€</span>
    <span class="hljs-type">uint32_t</span> state;
    <span class="hljs-comment">// data ä¸­æœ‰æ•ˆæ•°æ®é•¿åº¦</span>
    <span class="hljs-type">uint32_t</span> data_len;
    <span class="hljs-comment">// æ•°æ®</span>
    <span class="hljs-type">uint8_t</span> data[SHM_DATA_SIZE];
};

<span class="hljs-comment">/**
 * å…±äº«å†…å­˜çŠ¶æ€æœº
 *
 * IDLE : ç©ºé—²çŠ¶æ€
 * DATA : æœ‰æœ‰æ•ˆæ•°æ®
 * EOF  : æ–‡ä»¶ä¼ è¾“ç»“æŸ
 */</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title class_">ShmState</span> : <span class="hljs-type">uint32_t</span> {
    SHM_STATE_IDLE = <span class="hljs-number">0</span>,
    SHM_STATE_DATA = <span class="hljs-number">1</span>,
    SHM_STATE_EOF = <span class="hljs-number">2</span>,
};
</code></pre>
<h3 data-id="heading-3">1.2 åˆ›å»ºå…±äº«å†…å­˜</h3>
<p>é€šè¿‡ open("/dev/ashmem", O_RDWR) æ–¹æ³•åˆ›å»ºå…±äº«å†…å­˜ï¼Œå¾—åˆ°æ–‡ä»¶æè¿°ç¬¦ï¼Œfd å¯é€šè¿‡ AIDL ä¼ é€’ç»™å…¶ä»–è¿›ç¨‹ï¼Œåœ¨å…¶ä»–è¿›ç¨‹é€šè¿‡ fd æ˜ å°„ç›¸åŒçš„å†…å­˜åŒºåŸŸè¿›è¡Œæ“ä½œã€‚åˆ›å»ºå®Œæˆåé€šè¿‡ ioctl æ–¹æ³•è®¾ç½®å…±äº«å†…å­˜çš„åç§°å’Œå¤§å°ï¼Œå†ä½¿ç”¨ mmap å¯¹å†…å­˜çš„åœ°å€ç©ºé—´è¿›è¡Œæ˜ å°„ï¼Œç„¶åé€šè¿‡ reinterpret_cast å¯¹å†…å­˜ç©ºé—´è¿›è¡Œç»“æ„åŒ–ã€‚</p>
<p>æ¥ä¸‹æ¥è¿›è¡Œä¿¡å·é‡åˆå§‹åŒ–ï¼Œåˆå§‹çŠ¶æ€ä¸ºå¯å†™ã€ä¸å¯è¯»ã€å¯è¿›å…¥ä¸´ç•ŒåŒºçŠ¶æ€ï¼Œæ•°æ®ä¼ è¾“çŠ¶æ€åˆå§‹ä¸ºç©ºé—²çŠ¶æ€ï¼Œåˆ°è¿™é‡Œå…±äº«å†…å­˜å°±åˆ›å»ºå®Œæˆäº†ï¼Œç»§ç»­å¾€ä¸‹çœ‹å…±äº«å†…å­˜çš„æ•°æ®æ˜¯å¦‚ä½•è¿›è¡Œè¯»å†™çš„ã€‚</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">/**
 * åˆ›å»ºå…±äº«å†…å­˜
 */</span>
extern "C"
JNIEXPORT jint JNICALL
<span class="hljs-built_in">Java_com_yangle_ashmem_NativeShm_createShm</span>(JNIEnv *, jobject) {
    <span class="hljs-comment">// åˆ›å»ºå…±äº«å†…å­˜åŒºåŸŸ</span>
    int fd = <span class="hljs-built_in">open</span>("/dev/ashmem", O_RDWR);
    if (fd &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-built_in">LOGE</span>("ashmem create region failed");
        return -<span class="hljs-number">1</span>;
    }
    if (ioctl(fd, ASHMEM_SET_NAME, "shared_memory") != <span class="hljs-number">0</span>) {
        <span class="hljs-built_in">LOGE</span>("ASHMEM_SET_NAME failed: %s", strerror(errno));
        <span class="hljs-built_in">close</span>(fd);
        return -<span class="hljs-number">1</span>;
    }
    if (ioctl(fd, ASHMEM_SET_SIZE, sizeof(SharedBlock)) != <span class="hljs-number">0</span>) {
        <span class="hljs-built_in">LOGE</span>("ASHMEM_SET_SIZE failed: %s", strerror(errno));
        <span class="hljs-built_in">close</span>(fd);
        return -<span class="hljs-number">1</span>;
    }

    <span class="hljs-comment">// æ˜ å°„åœ°å€ç©ºé—´</span>
    void *addr = <span class="hljs-built_in">mmap</span>(nullptr, sizeof(SharedBlock), PROT_READ | PROT_WRITE, MAP_SHARED, fd, <span class="hljs-number">0</span>);
    if (addr == MAP_FAILED) {
        <span class="hljs-built_in">LOGE</span>("mmap failed");
        <span class="hljs-built_in">close</span>(fd);
        return -<span class="hljs-number">1</span>;
    }

    <span class="hljs-comment">// å…±äº«å†…å­˜ç©ºé—´ç”¨SharedBlockç»“æ„åŒ–</span>
    g_block = reinterpret_cast&lt;SharedBlock *&gt;(addr);
    <span class="hljs-built_in">memset</span>(g_block, <span class="hljs-number">0</span>, sizeof(SharedBlock));

    <span class="hljs-comment">// åˆå§‹åŒ–è¿›ç¨‹é—´ä¿¡å·é‡</span>
    <span class="hljs-comment">// åˆå§‹å¯å†™</span>
    <span class="hljs-built_in">sem_init</span>(&amp;g_block-&gt;sem_empty, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
    <span class="hljs-comment">// åˆå§‹ä¸å¯è¯»</span>
    <span class="hljs-built_in">sem_init</span>(&amp;g_block-&gt;sem_full, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>);
    <span class="hljs-comment">// äº’æ–¥é”</span>
    <span class="hljs-built_in">sem_init</span>(&amp;g_block-&gt;sem_mutex, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);

    g_block-&gt;state = SHM_STATE_IDLE;
    <span class="hljs-built_in">LOGI</span>("createShm success, fd=%d", fd);
    return fd;
}
</code></pre>
<h3 data-id="heading-4">1.3 å†™å…¥æ•°æ®</h3>
<p>é¦–å…ˆé€šè¿‡ sem_waitï¼ˆP æ“ä½œï¼‰æ–¹æ³•åˆ¤æ–­æ˜¯å¦å¯å†™ï¼Œä»¥åŠä¸´ç•ŒåŒºæ˜¯å¦åŠ é”ï¼Œç„¶åå¤åˆ¶æ•°æ®åˆ°å…±äº«å†…å­˜ä¸­ï¼Œé€šè¿‡ sem_postï¼ˆV æ“ä½œï¼‰é‡Šæ”¾ä¸´ç•ŒåŒºé”ï¼Œé€šçŸ¥æ¶ˆè´¹è€…å¯ä»¥è¯»å–æ•°æ®ã€‚</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">/**
 * å†™å…¥æ•°æ®
 */</span>
extern "C"
JNIEXPORT jint JNICALL
<span class="hljs-built_in">Java_com_yangle_ashmem_NativeShm_write</span>(JNIEnv *env, jobject, jbyteArray data, jint len) {
    if (!g_block) {
        <span class="hljs-built_in">LOGE</span>("write: g_block is null");
        return -<span class="hljs-number">1</span>;
    }

    <span class="hljs-comment">// P(empty)ï¼Œå¦‚æœConsumerè¿˜æ²¡è¯»å®Œï¼Œä¸Šä¸€æ¬¡å†™ä¼šé˜»å¡åœ¨è¿™é‡Œ</span>
    <span class="hljs-built_in">sem_wait</span>(&amp;g_block-&gt;sem_empty);
    <span class="hljs-comment">// è¿›å…¥ä¸´ç•ŒåŒº, ä¿æŠ¤stateã€data_lenã€dataçš„ä¸€è‡´æ€§</span>
    <span class="hljs-built_in">sem_wait</span>(&amp;g_block-&gt;sem_mutex);

    jbyte *<span class="hljs-attribute">src</span> = env-&gt;<span class="hljs-built_in">GetByteArrayElements</span>(data, nullptr);
    <span class="hljs-built_in">memcpy</span>(g_block-&gt;data, src, len);
    g_block-&gt;data_len = len;
    g_block-&gt;state = SHM_STATE_DATA;
    env-&gt;<span class="hljs-built_in">ReleaseByteArrayElements</span>(data, src, <span class="hljs-number">0</span>);

    <span class="hljs-comment">// ç¦»å¼€ä¸´ç•ŒåŒº</span>
    <span class="hljs-built_in">sem_post</span>(&amp;g_block-&gt;sem_mutex);
    <span class="hljs-comment">// V(full)ï¼Œé€šçŸ¥ Consumer å¯ä»¥è¯»å–</span>
    <span class="hljs-built_in">sem_post</span>(&amp;g_block-&gt;sem_full);
    return len;
}
</code></pre>
<h3 data-id="heading-5">1.4 è¯»å–æ•°æ®</h3>
<p>è¯»å–æ•°æ®æ˜¯åœ¨å¦ä¸€è¿›ç¨‹è¿›è¡Œçš„ï¼Œé€šè¿‡ä½¿ç”¨ AIDL ä¼ é€’è¿‡æ¥çš„ fd å¯ä»¥æ˜ å°„ä¸ç”Ÿäº§è€…è¿›ç¨‹ç›¸åŒçš„å†…å­˜åŒºåŸŸï¼Œç„¶åå†å°†å†…å­˜åŒºåŸŸç»“æ„åŒ–æˆ SharedBlockï¼Œå¯ä»¥æ‹¿åˆ°å†…å­˜ä¸­çš„ä¿¡å·é‡æ ‡å¿—å’Œæ•°æ®ã€‚</p>
<p>é¦–å…ˆåˆ¤æ–­æ˜¯å¦è¯»å–ï¼Œå¦‚æœç”Ÿäº§è€…è¿˜åœ¨å†™å…¥ï¼Œä¼šåœåœ¨ sem_wait(&amp;g_block-&gt;sem_full) è¿›è¡Œç­‰å¾…ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦ä¼ è¾“å®Œæˆï¼Œå†è¿›è¡Œæ•°æ®è¯»å–ï¼Œæœ€åå†é‡Šæ”¾ä¸´ç•ŒåŒºé”ï¼Œé€šçŸ¥ç”Ÿäº§è€…å¯ä»¥å†™å…¥æ•°æ®ã€‚</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">/**
 * è¯»å–æ•°æ®
 */</span>
extern "C"
JNIEXPORT jint JNICALL
<span class="hljs-built_in">Java_com_yangle_ashmem_NativeShm_read</span>(JNIEnv* env, jobject, jint fd, jbyteArray out) {
    if (!g_block) {
        void *addr = <span class="hljs-built_in">mmap</span>(nullptr, sizeof(SharedBlock), PROT_READ | PROT_WRITE, MAP_SHARED, fd, <span class="hljs-number">0</span>);
        if (addr == MAP_FAILED) {
            <span class="hljs-built_in">LOGE</span>("client mmap failed, fd=%d", fd);
            return -<span class="hljs-number">1</span>;
        }
        g_block = reinterpret_cast&lt;SharedBlock *&gt;(addr);
    }

    <span class="hljs-comment">// P(full)ï¼Œç­‰å¾… Producer å†™å…¥</span>
    <span class="hljs-built_in">sem_wait</span>(&amp;g_block-&gt;sem_full);
    <span class="hljs-built_in">sem_wait</span>(&amp;g_block-&gt;sem_mutex);

    <span class="hljs-comment">// è¯†åˆ« EOF</span>
    if (g_block-&gt;state == SHM_STATE_EOF) {
        <span class="hljs-built_in">sem_post</span>(&amp;g_block-&gt;sem_mutex);
        <span class="hljs-built_in">sem_post</span>(&amp;g_block-&gt;sem_empty);
        <span class="hljs-built_in">LOGI</span>("receive EOF");
        return -<span class="hljs-number">1</span>;
    }

    int len = g_block-&gt;data_len;
    env-&gt;<span class="hljs-built_in">SetByteArrayRegion</span>(out, <span class="hljs-number">0</span>, len, reinterpret_cast&lt;jbyte*&gt;(g_block-&gt;data));

    <span class="hljs-comment">// ä¿¡å·é‡å¯å†™</span>
    <span class="hljs-built_in">sem_post</span>(&amp;g_block-&gt;sem_mutex);
    <span class="hljs-built_in">sem_post</span>(&amp;g_block-&gt;sem_empty);
    return len;
}
</code></pre>
<h3 data-id="heading-6">1.5 ä¼ è¾“ç»“æŸ</h3>
<p>æ•°æ®ä¼ è¾“å®Œæˆåï¼Œå‘é€ç»“æŸæ ‡å¿—ï¼Œå…ˆåˆ¤æ–­æ˜¯å¦è¯»å–å®Œæˆï¼Œç„¶åæŠŠä¼ è¾“çŠ¶æ€ä¿®æ”¹ä¸º SHM_STATE_EOF ç»“æŸï¼Œå†é‡Šæ”¾ä¸´ç•ŒåŒºé”ï¼Œé€šçŸ¥æ¶ˆè´¹è€…å¯ä»¥è¯»å–æ•°æ®ï¼Œæ¶ˆè´¹è€…è¯»å–ä¼ è¾“çŠ¶æ€ä¸ºç»“æŸï¼Œåˆ°æ­¤ä¸€è½®æ•°æ®ä¼ è¾“å®Œæˆã€‚</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">/**
 * æ•°æ®ä¼ è¾“ç»“æŸ
 */</span>
extern "C"
JNIEXPORT void JNICALL
<span class="hljs-built_in">Java_com_yangle_ashmem_NativeShm_sendEof</span>(JNIEnv*, jobject) {
    if (!g_block) return;
    <span class="hljs-built_in">sem_wait</span>(&amp;g_block-&gt;sem_empty);
    <span class="hljs-built_in">sem_wait</span>(&amp;g_block-&gt;sem_mutex);

    g_block-&gt;state = SHM_STATE_EOF;
    g_block-&gt;data_len = <span class="hljs-number">0</span>;

    <span class="hljs-built_in">sem_post</span>(&amp;g_block-&gt;sem_mutex);
    <span class="hljs-built_in">sem_post</span>(&amp;g_block-&gt;sem_full);
    <span class="hljs-built_in">LOGI</span>("send EOF");
}
</code></pre>
<h3 data-id="heading-7">1.6 é”€æ¯å…±äº«å†…å­˜</h3>
<p>å½“ä¸å†ä¼ è¾“æ•°æ®åï¼Œä¹Ÿå°±æ˜¯æ¶ˆè´¹è€…æ”¶åˆ° SHM_STATE_EOF çŠ¶æ€ä¹‹åï¼Œå¯ä»¥é€šè¿‡ AIDL é€šçŸ¥ç”Ÿäº§è€…å¯¹å…±äº«å†…å­˜è¿›è¡Œé”€æ¯ã€‚</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">/**
 * é”€æ¯å…±äº«å†…å­˜
 */</span>
extern "C"
JNIEXPORT void JNICALL
<span class="hljs-built_in">Java_com_yangle_ashmem_NativeShm_destroy</span>(JNIEnv*, jobject, jint fd) {
    if (g_block) {
        <span class="hljs-built_in">munmap</span>(g_block, sizeof(SharedBlock));
        g_block = nullptr;
    }
    <span class="hljs-built_in">close</span>(fd);
    <span class="hljs-built_in">LOGI</span>("destroy shm fd=%d", fd);
}
</code></pre>
<h2 data-id="heading-8">2.æµ‹è¯•</h2>
<p>åˆ°è¿™é‡Œå…±äº«å†…å­˜ä¼ è¾“çš„åŸºæœ¬åŠŸèƒ½å°±å®Œæˆäº†ï¼Œå†™ä¸ªä¾‹å­æ¥æµ‹è¯•ä¸‹ï¼Œå®šä¹‰ä¸€ä¸ª ShmServiceï¼ˆandroid:process=":shm" ï¼‰ è¿›ç¨‹ä½œä¸ºæ•°æ®å‘é€æ–¹ï¼ŒMainActivity ä½œä¸ºæ•°æ®æ¥æ”¶æ–¹ï¼Œå…ˆçœ‹ä¸‹é¡¹ç›®ç»“æ„ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/485bc177eced42ae83d6b1fcad083c15~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a655Y2O6LCi5ZCO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767230177&amp;x-signature=gw56ccUlRvjPWqVoKUIbaI5MR10%3D" alt="é¡¹ç›®ç»“æ„" loading="lazy"/></p>
<p>æµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p>1.MainActivity ä¸ ShmService è¿›è¡ŒæœåŠ¡ç»‘å®šï¼Œç»‘å®šæˆåŠŸåè°ƒç”¨ AIDL çš„ startTransfer æ–¹æ³•é€šçŸ¥ ShmService å¼€å§‹ä¼ è¾“</p>
</li>
<li>
<p>2.ShmService æ”¶åˆ°é€šçŸ¥åå¼€å§‹åˆ›å»ºå…±äº«å†…å­˜ï¼Œç„¶åå°† fd é€šè¿‡ AIDL çš„ onShmReady å›è°ƒæ–¹æ³•ä¼ é€’ç»™ MainActivity</p>
</li>
<li>
<p>3.ShmService å¼€å§‹å‘é€æ–‡ä»¶ï¼ŒMainActivity å¼€å§‹è¯»å–æ–‡ä»¶</p>
</li>
<li>
<p>4.ShmService å‘é€æ–‡ä»¶å®Œæˆåï¼Œé€šè¿‡å…±äº«å†…å­˜ä¿¡å·é‡é€šçŸ¥ MainActivity ç»“æŸ</p>
</li>
<li>
<p>5.MainActivity è¯»å–åˆ° SHM_STATE_EOF çŠ¶æ€åï¼Œé€šè¿‡ AIDL çš„ endTransfer æ–¹æ³•é€šçŸ¥ ShmService</p>
</li>
<li>
<p>6.ShmService æ”¶åˆ°ç»“æŸé€šçŸ¥åï¼Œé”€æ¯å·²åˆ›å»ºçš„å…±äº«å†…å­˜</p>
</li>
</ul>
<p><strong>MainActivity å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> native = NativeShm()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> service: IShmService

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
        bindService(Intent(<span class="hljs-keyword">this</span>, ShmService::<span class="hljs-keyword">class</span>.java), conn, BIND_AUTO_CREATE)
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> conn = <span class="hljs-keyword">object</span> : ServiceConnection {
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onServiceConnected</span><span class="hljs-params">(name: <span class="hljs-type">ComponentName</span>, binder: <span class="hljs-type">IBinder</span>)</span></span> {
            service = IShmService.Stub.asInterface(binder)
            <span class="hljs-comment">// é€šçŸ¥æœåŠ¡ç«¯å¼€å§‹å‘é€æ–‡ä»¶</span>
            service.startTransfer(<span class="hljs-keyword">object</span> : IShmCallback.Stub() {
                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onShmReady</span><span class="hljs-params">(pfd: <span class="hljs-type">ParcelFileDescriptor</span>)</span></span> {
                    startReceive(pfd.fd)
                }
            })
        }

        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onServiceDisconnected</span><span class="hljs-params">(name: <span class="hljs-type">ComponentName</span>)</span></span> {}
    }

    <span class="hljs-comment">/**
     * æ¥æ”¶æ–‡ä»¶
     *
     * <span class="hljs-doctag">@param</span> fd æ–‡ä»¶æè¿°ç¬¦
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">startReceive</span><span class="hljs-params">(fd: <span class="hljs-type">Int</span>)</span></span> {
        Thread {
            <span class="hljs-keyword">val</span> <span class="hljs-keyword">out</span> = File(getExternalFilesDir(<span class="hljs-string">""</span>), <span class="hljs-string">"test.jpg"</span>)
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">out</span>.exists()) {
                <span class="hljs-keyword">out</span>.delete()
            }
            <span class="hljs-keyword">val</span> buf = ByteArray(<span class="hljs-number">64</span> * <span class="hljs-number">1024</span>)

            FileOutputStream(<span class="hljs-keyword">out</span>).use { fos -&gt;
                <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
                    <span class="hljs-keyword">val</span> len = native.read(fd, buf)
                    <span class="hljs-keyword">if</span> (len &lt; <span class="hljs-number">0</span>) {
                        service.endTransfer()
                        <span class="hljs-keyword">break</span>
                    }
                    fos.write(buf, <span class="hljs-number">0</span>, len)
                }
            }
        }.start()
    }
}
</code></pre>
<p><strong>ShmService å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ShmService</span> : <span class="hljs-type">Service</span>() {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> native = NativeShm()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> client: IShmService? = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> mFd: <span class="hljs-built_in">Int</span>? = <span class="hljs-literal">null</span>

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onBind</span><span class="hljs-params">(p0: <span class="hljs-type">Intent</span>?)</span></span>: IBinder? {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">object</span> : IShmService.Stub() {
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">startTransfer</span><span class="hljs-params">(callback: <span class="hljs-type">IShmCallback</span>?)</span></span> {
                <span class="hljs-comment">// åˆ›å»ºå…±äº«å†…å­˜</span>
                mFd = native.createShm()
                <span class="hljs-comment">// å°†æ–‡ä»¶æè¿°ç¬¦å›è°ƒç»™æ¥æ”¶ç«¯</span>
                <span class="hljs-keyword">val</span> pfd = ParcelFileDescriptor.fromFd(mFd!!)
                callback?.onShmReady(pfd)
                <span class="hljs-comment">// å‘é€æ–‡ä»¶</span>
                sendFile(<span class="hljs-string">"test.jpg"</span>, mFd!!)
            }

            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">endTransfer</span><span class="hljs-params">()</span></span> {
                <span class="hljs-keyword">if</span> (mFd != <span class="hljs-literal">null</span>) {
                    native.destroy(mFd!!)
                }
            }
        }.also {
            client = it
        }
    }

    <span class="hljs-comment">/**
     * å‘é€æ–‡ä»¶
     *
     * <span class="hljs-doctag">@param</span> fileName æ–‡ä»¶å
     * <span class="hljs-doctag">@param</span> fd       æ–‡ä»¶æè¿°ç¬¦
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendFile</span><span class="hljs-params">(fileName: <span class="hljs-type">String</span>, fd: <span class="hljs-type">Int</span>)</span></span> {
        Thread {
            <span class="hljs-keyword">val</span> buffer = ByteArray(<span class="hljs-number">64</span> * <span class="hljs-number">1024</span>)
            <span class="hljs-keyword">try</span> {
                assets.<span class="hljs-keyword">open</span>(fileName).use { input -&gt;
                    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
                        <span class="hljs-keyword">val</span> len = input.read(buffer)
                        <span class="hljs-keyword">if</span> (len &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>
                        native.write(buffer, len)
                    }
                }
                native.sendEof()
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                e.printStackTrace()
            }
        }.start()
    }
}
</code></pre>
<p><strong>AIDL å¦‚ä¸‹ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">interface</span> <span class="hljs-title">IShmService</span> {
    <span class="hljs-comment">/**
     * å¼€å§‹ä¼ è¾“
     *
     * @params callback å›è°ƒ
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">startTransfer</span>(<span class="hljs-params"><span class="hljs-keyword">in</span> IShmCallback callback</span>)</span>;

    <span class="hljs-comment">/**
     * ç»“æŸä¼ è¾“
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">endTransfer</span>()</span>;
}

<span class="hljs-keyword">interface</span> <span class="hljs-title">IShmCallback</span> {
   <span class="hljs-comment">/**
     * å…±äº«å†…å­˜åˆå§‹åŒ–å®Œæˆ
     *
     * @params pfd æ–‡ä»¶æè¿°ç¬¦
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">onShmReady</span>(<span class="hljs-params"><span class="hljs-keyword">in</span> ParcelFileDescriptor pfd</span>)</span>;
}
</code></pre>
<p><strong>æ³¨æ„åœ¨ onShmReady æ–¹æ³•ä¸­éœ€è¦ä¼ é€’ ParcelFileDescriptor ç±»å‹ï¼Œä¸èƒ½ç›´æ¥ä¼ é€’ int ç±»å‹çš„ fdï¼ŒParcelFileDescriptor å†…éƒ¨ä¼šè‡ªåŠ¨å®ç° Binder çš„è‡ªåŠ¨æ˜ å°„ã€‚</strong></p>
<ul>
<li>
<p>Binder ä¼šæŠŠ fd å¤åˆ¶åˆ°ç›®æ ‡è¿›ç¨‹ï¼Œç›®æ ‡è¿›ç¨‹æ‹¿åˆ°çš„ ParcelFileDescriptor å¯¹è±¡é‡Œæœ‰ä¸€ä¸ªæ–°çš„ fdã€‚</p>
</li>
<li>
<p>ç³»ç»Ÿä¼šåœ¨åº•å±‚åš fd æ˜ å°„å’Œå¼•ç”¨è®¡æ•°ï¼Œä¿è¯ä¸¤ä¸ªè¿›ç¨‹éƒ½å¯ä»¥å®‰å…¨è®¿é—®åŒä¸€ä¸ªåº•å±‚èµ„æºã€‚</p>
</li>
<li>
<p>å®ƒä¸ä»…èƒ½å°è£… ashmem fdï¼Œä¹Ÿèƒ½å°è£…æ™®é€šæ–‡ä»¶ã€socketã€pipe ç­‰ã€‚</p>
</li>
</ul>
<h2 data-id="heading-9">3.PVæ“ä½œ</h2>
<p>åœ¨æ•°æ®ä¼ è¾“ä¸­ä½¿ç”¨PVä¿¡å·é‡æ¥æ§åˆ¶ç”Ÿäº§è€…-æ¶ˆè´¹è€…çš„è¯»å†™æ“ä½œï¼Œåœ¨è¿™é‡Œå†æ¢³ç†ä¸‹æµç¨‹ï¼š</p>
<p><strong>å†™æ•°æ®</strong></p>
<ul>
<li>
<p>1.sem_wait(sem_empty) â€” ç­‰å¾…ç¼“å†²åŒºå¯å†™</p>
</li>
<li>
<p>2.sem_wait(sem_mutex) â€” è¿›å…¥ä¸´ç•ŒåŒº</p>
</li>
<li>
<p>3.memcpy æ•°æ®åˆ°å…±äº«å†…å­˜ï¼Œè®¾ç½® data_lenã€state = DATA</p>
</li>
<li>
<p>4.sem_post(sem_mutex) â€” ç¦»å¼€ä¸´ç•ŒåŒº</p>
</li>
<li>
<p>5.sem_post(sem_full) â€” é€šçŸ¥æ¶ˆè´¹è€…æœ‰æ•°æ®å¯è¯»</p>
</li>
</ul>
<p><strong>è¯»æ•°æ®</strong></p>
<ul>
<li>
<p>6.sem_wait(sem_full) â€” ç­‰å¾…æ•°æ®åˆ°è¾¾</p>
</li>
<li>
<p>7.sem_wait(sem_mutex) â€” è¿›å…¥ä¸´ç•ŒåŒºï¼Œæ£€æŸ¥ state</p>
</li>
<li>
<p>8.è‹¥ state == EOF åˆ™ sem_post(sem_mutex) å¹¶ sem_post(sem_empty)ï¼Œè¿”å› EOFï¼Œå¦åˆ™æ‹·è´æ•°æ®åˆ°ç”¨æˆ·ç¼“å†²</p>
</li>
<li>
<p>9.sem_post(sem_mutex) â€” ç¦»å¼€ä¸´ç•ŒåŒº</p>
</li>
<li>
<p>10.sem_post(sem_empty) â€” é€šçŸ¥å†™æ•°æ®ç«¯å¯ä»¥å†™ä¸‹ä¸€ä¸ªåˆ†ç‰‡</p>
</li>
</ul>
<h2 data-id="heading-10">4.å†™åœ¨æœ€å</h2>
<p>GitHubåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Falidili%2FDemos%2Ftree%2Fmaster%2FAshmemDemo" target="_blank" title="https://github.com/alidili/Demos/tree/master/AshmemDemo" ref="nofollow noopener noreferrer">github.com/alidili/Demâ€¦</a></p>
<p>åˆ°è¿™é‡Œï¼ŒAndroidæ¶ˆæ¯æ¨é€SSEæ–¹æ¡ˆå°±ä»‹ç»å®Œäº†ï¼Œå¦‚æœ‰é—®é¢˜å¯ä»¥ç»™æˆ‘ç•™è¨€è¯„è®ºæˆ–è€…åœ¨GitHubä¸­æäº¤Issuesï¼Œè°¢è°¢ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java ç™»å½•ä¸“é¢˜]]></title>    <link>https://juejin.cn/post/7587277503947014144</link>    <guid>https://juejin.cn/post/7587277503947014144</guid>    <pubDate>2025-12-25T01:37:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587277503947014144" data-draft-id="7585382553289932836" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java ç™»å½•ä¸“é¢˜"/> <meta itemprop="keywords" content="Java,Spring Boot,åç«¯"/> <meta itemprop="datePublished" content="2025-12-25T01:37:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ªé‡Œçš„ç ´æ°´ç“¶"/> <meta itemprop="url" content="https://juejin.cn/user/4394111849466414"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java ç™»å½•ä¸“é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4394111849466414/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ªé‡Œçš„ç ´æ°´ç“¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T01:37:57.000Z" title="Thu Dec 25 2025 01:37:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#444;background-image:linear-gradient(90deg,rgba(59,59,59,.1) 3%,transparent 0),linear-gradient(1turn,rgba(122,120,121,.1) 3%,transparent 0);background-size:30px 30px;background-position:50%;letter-spacing:1px;word-spacing:1px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:34px;margin-bottom:16px;font-weight:700;line-height:1.3;cursor:text;color:#444;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body h1{font-size:41px;margin-bottom:34px;line-height:1.5}.markdown-body h1:before{content:""}.markdown-body h2{font-size:30px;padding-left:.4em;border-left:.4em solid #5e5e5e;border-bottom:1px solid #444}.markdown-body h2:after{content:"ğŸ•›";position:absolute;top:0;right:0;transition:all;animation:rotate 10s linear infinite}@keyframes rotate{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.markdown-body h3{border-left:.4em solid #8d8d8d;font-size:24px;padding-left:.4em}.markdown-body h4{font-size:20px}.markdown-body h5{font-size:16px}.markdown-body h6{font-size:14px}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body table,.markdown-body ul{margin:.8em 0}.markdown-body strong{font-weight:1000;position:relative;color:#444;padding:0 3px}.markdown-body em{font-weight:inherit}.markdown-body a{box-sizing:border-box;color:grey;position:relative}.markdown-body a:before{position:absolute;box-sizing:border-box;content:"Go -&gt;";left:0;width:100%;max-width:0;color:#fff;background-color:hsla(0,0%,50.2%,.8);white-space:nowrap;transition:.2s ease;pointer-events:none;overflow:hidden}.markdown-body a:after{content:"";position:absolute;bottom:0;left:0;width:100%;height:1px;background-color:grey}.markdown-body a:active:before,.markdown-body a:hover:before{max-width:100%;padding-left:8px;border-radius:5px}.markdown-body hr{position:relative;width:100%;height:1px;border:none;margin-top:36px;margin-bottom:36px;background:linear-gradient(90deg,grey,#f1f1f1,#444,#444,#f1f1f1,grey);overflow:visible}.markdown-body ol,.markdown-body ul{padding-left:32px}.markdown-body ol li,.markdown-body ul li{margin-bottom:6px;list-style:inherit}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol{counter-reset:my-counter}.markdown-body ol&gt;li{padding-left:6px;list-style:none;counter-increment:my-counter;position:relative}.markdown-body ol&gt;li:before{position:absolute;left:-1.5em;content:counter(my-counter);font-weight:700}.markdown-body ol&gt;li:first-child:before{content:"1ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(2):before{content:"2ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(3):before{content:"3ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(4):before{content:"4ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(5):before{content:"5ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(6):before{content:"6ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(7):before{content:"7ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(8):before{content:"8ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(9):before{content:"9ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(10):before{content:"ğŸ”Ÿ"}.markdown-body ul&gt;li{list-style:none;position:relative}.markdown-body ul&gt;li:before{z-index:10;position:absolute;left:-1.57em;content:"ğŸ”¹";margin-right:12px}.markdown-body ul&gt;li input{margin-left:8px!important}.markdown-body blockquote{position:relative;background-color:#d3d3d3;padding:5px 10px;border-left:.2em solid #000;border-radius:3px;transition:all .8s ease}.markdown-body blockquote:hover{opacity:.7}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(69,69,77,.8);color:#fff;font-size:.87em;padding:.07em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:7px;overflow:hidden}.markdown-body pre:before{z-index:10;position:absolute;top:14px;left:14px;width:12px;height:12px;border-radius:50%;background:#fc625d;-webkit-box-shadow:20px 0 #fdbc40,40px 0 #35cd4b;box-shadow:20px 0 #fdbc40,40px 0 #35cd4b;content:" "}.markdown-body pre:after{z-index:9;content:"";position:absolute;width:100%;height:40px;top:0;background-color:#1a1a1a}.markdown-body pre&gt;code{display:block;font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#171717;color:#bababa;font-size:14px;padding:40px 20px 20px}.markdown-body del{color:grey}.markdown-body table{margin-bottom:1.25rem;border-collapse:collapse}.markdown-body table td,.markdown-body table th{margin:0;padding:8px;line-height:20px;vertical-align:middle;border:1px solid #ddd}.markdown-body table thead,.markdown-body table tr:nth-child(2n){background-color:#fcfcfc}.markdown-body table thead th,.markdown-body table tr:nth-child(2n) th{font-weight:700;vertical-align:middle;color:#444}.markdown-body table tbody tr td{font-weight:400;color:#444}.markdown-body table tbody tr:hover{background-color:#d3d3d3}.markdown-body table tbody tr:hover td{color:#fff}.markdown-body img{max-width:100%;margin:0 12px}@media (max-width:720px){.markdown-body h1{font-size:32.8px}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:19.2px}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:12.8px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">Cookie</h2>
<p>æ ¸å¿ƒèƒŒæ™¯ï¼šHTTP æ˜¯æ— çŠ¶æ€çš„</p>
<p>æœåŠ¡å™¨é»˜è®¤ä¸è®°å¾—ä½ æ˜¯è°</p>
<ul>
<li>è¯·æ±‚1 â€”â€” å®Œäº†å°±å¿˜</li>
<li>è¯·æ±‚2 â€”â€” å½“æ–°è¯·æ±‚</li>
</ul>
<blockquote>
<p>åœ¨å®¢æˆ·ç«¯ä¿å­˜çŠ¶æ€æ ‡è¯†ï¼Œè§£å†³ HTTP æ— çŠ¶æ€é—®é¢˜</p>
</blockquote>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@GetMapping("/hello")</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">(HttpServletResponse response)</span> {
    <span class="hljs-type">Cookie</span> <span class="hljs-variable">cookie</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cookie</span>(<span class="hljs-string">"name"</span>, <span class="hljs-string">"value"</span>);
    <span class="hljs-comment">// 20ç§’åè¿‡æœŸ</span>
    cookie.setMaxAge(<span class="hljs-number">20</span>);
    response.addCookie(cookie);
    <span class="hljs-keyword">return</span> <span class="hljs-string">"OK"</span>;
}

<span class="hljs-meta">@GetMapping("/user")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">user</span><span class="hljs-params">(HttpServletRequest request)</span> {
    Cookie[] cookies = request.getCookies();
    <span class="hljs-keyword">for</span> (Cookie cookie : cookies) {
        <span class="hljs-keyword">if</span> (cookie.getName().equals(<span class="hljs-string">"name"</span>)) {
            System.out.println(cookie.getName() + <span class="hljs-string">":"</span> + cookie.getValue());
        }
    }
}
</code></pre>
<blockquote>
<p>åç«¯è®¾ç½® cookie æ—¶</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/965ecd33e1fc4443be12c98857005055~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOq6YeM55qE56C05rC055O2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231477&amp;x-signature=gqntX4QQQ5rhkFItcDkspEV4atE%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>å‰ç«¯å‘èµ·è¯·æ±‚æºå¸¦ cookie æ—¶</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c9f1ea3945a4d7bb7d2c57bc303fc0f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOq6YeM55qE56C05rC055O2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231477&amp;x-signature=XXOqNh5B%2FKaAdP9ul4nTenXt%2FhI%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>cookie ç®¡ç†ç•Œé¢</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cddd1732dccc409abc0d01ffe907292e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOq6YeM55qE56C05rC055O2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231477&amp;x-signature=NtyhaVEjIczCxU95ODkRAd3Smnk%3D" alt="image.png" loading="lazy"/></p>
<p><strong>ä¼˜ç¼ºç‚¹</strong></p>
<p>ä¼˜ç‚¹ï¼šHTTPåè®®ä¸­æ”¯æŒçš„æŠ€æœ¯</p>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>ç§»åŠ¨ç«¯APPæ— æ³•ä½¿ç”¨Cookie</li>
<li>ä¸å®‰å…¨ï¼Œç”¨æˆ·å¯ä»¥è‡ªå·±ç¦ç”¨Cookie</li>
<li>Cookieä¸èƒ½è·¨åŸŸ</li>
</ul>
<h2 data-id="heading-1">Session</h2>
<p>HttpSession æ˜¯æœåŠ¡å™¨ç«¯ä¿å­˜ç”¨æˆ·ä¼šè¯çŠ¶æ€çš„å¯¹è±¡</p>
<p>æ ¸å¿ƒç‰¹ç‚¹ï¼š</p>
<ul>
<li>å­˜åœ¨æœåŠ¡å™¨å†…å­˜ï¼ˆæˆ– Redisï¼‰</li>
<li>ä»¥ SessionId ä¸ºç´¢å¼•</li>
<li>è§£å†³ HTTP æ— çŠ¶æ€é—®é¢˜</li>
</ul>
<blockquote>
<p>Session æ˜¯æ€ä¹ˆè¿ç»­çš„ï¼Ÿï¼ˆæ ¸å¿ƒåŸç†ï¼‰</p>
</blockquote>
<p>ç¬¬ä¸€æ¬¡è®¿é—®ä¹‹åï¼Œä¼šäº§ç”Ÿä¸€ä¸ªCookieï¼Œå¾€åè®¿é—®éƒ½ä¼šå¸¦ç€å®ƒ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e9aa15fc4594aaa8d927e868e43bc26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOq6YeM55qE56C05rC055O2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231477&amp;x-signature=Og0AtRsXXuk%2Fa8%2FOKWcm%2FjP9UFg%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å­˜å€¼</span>
<span class="hljs-meta">@GetMapping("/hello")</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">(HttpSession session)</span> {
    log.info(<span class="hljs-string">"HttpSession-s1ï¼š{}"</span>, session.hashCode());
    session.setAttribute(<span class="hljs-string">"name"</span>, <span class="hljs-string">"hello"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">"OK"</span>;
}

    <span class="hljs-comment">// è·å–å€¼</span>
<span class="hljs-meta">@GetMapping("/user")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">user</span><span class="hljs-params">(HttpSession session)</span> {
    log.info(<span class="hljs-string">"HttpSession-s2ï¼š{}"</span>, session.hashCode());
    <span class="hljs-type">Object</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> session.getAttribute(<span class="hljs-string">"name"</span>);
    log.info(<span class="hljs-string">"name: {}"</span>, name);
}
</code></pre>
<blockquote>
<p>ç¼ºç‚¹ï¼Œåˆ†å¸ƒå¼é›†ç¾¤ä¸‹æ— æ³•ä½¿ç”¨ Session<br/>
ä¼˜ç‚¹ï¼šæ•°æ®å­˜æ”¾åˆ°æœåŠ¡ç«¯</p>
</blockquote>
<h2 data-id="heading-2">ä»¤ç‰ŒJWT</h2>
<p>ä»¤ç‰Œä¼šè¯è·Ÿè¸ªæ–¹æ¡ˆçš„ä¼˜ç¼ºç‚¹ ?</p>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>æ”¯æŒPCç«¯ã€ç§»åŠ¨ç«¯</li>
<li>è§£å†³é›†ç¾¤ç¯å¢ƒä¸‹çš„è®¤è¯é—®é¢˜</li>
<li>å‡è½»æœåŠ¡å™¨ç«¯å­˜å‚¨å‹åŠ›</li>
</ul>
<p>ç¼ºç‚¹ï¼šéœ€è¦è‡ªå·±å®ç°</p>
<blockquote>
<p>å…¨ç§°ï¼šJSON Web Token ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fjwt.io%2F%25EF%25BC%2589" target="_blank" title="https://jwt.io/%EF%BC%89" ref="nofollow noopener noreferrer">jwt.io/ï¼‰</a></p>
</blockquote>
<p>å®šä¹‰äº†ä¸€ç§ç®€æ´çš„ã€è‡ªåŒ…å«çš„æ ¼å¼ï¼Œç”¨äºåœ¨é€šä¿¡åŒæ–¹ä»¥jsonæ•°æ®æ ¼å¼å®‰å…¨çš„ä¼ è¾“ä¿¡æ¯ã€‚
ç»„æˆï¼š</p>
<ul>
<li>ç¬¬ä¸€éƒ¨åˆ†ï¼šHeader(å¤´ï¼‰ï¼Œè®°å½•ä»¤ç‰Œç±»å‹ã€ç­¾åç®—æ³•ç­‰ã€‚ ä¾‹å¦‚ï¼š{"alg":"HS256","type":"JWT"}</li>
<li>ç¬¬äºŒéƒ¨åˆ†ï¼šPayload(æœ‰æ•ˆè½½è·ï¼‰ï¼Œæºå¸¦ä¸€äº›è‡ªå®šä¹‰ä¿¡æ¯ã€é»˜è®¤ä¿¡æ¯ç­‰ã€‚ ä¾‹å¦‚ï¼š{"id":"1","username":"Tom"}</li>
<li>ç¬¬ä¸‰éƒ¨åˆ†ï¼šSignature(ç­¾åï¼‰ï¼Œé˜²æ­¢Tokenè¢«ç¯¡æ”¹ã€ç¡®ä¿å®‰å…¨æ€§ã€‚å°†headerã€payloadèå…¥ï¼Œå¹¶åŠ å…¥æŒ‡å®šå¯†é’¥ï¼Œé€šè¿‡æŒ‡å®šç­¾åç®—æ³•è®¡ç®—è€Œæ¥ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1637e190202d440f94dfbd84ac8366d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOq6YeM55qE56C05rC055O2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231477&amp;x-signature=HWXDKvsDv3v%2FO6yApV0X%2Bqm746U%3D" alt="image.png" loading="lazy"/></p>
<p>Base64ï¼šæ˜¯ä¸€ç§åŸºäº64ä¸ªå¯æ‰“å°å­—ç¬¦ï¼ˆA-Z a-z 0-9 + /ï¼‰æ¥è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®çš„ç¼–ç æ–¹å¼ã€‚</p>
<p>å¼•å…¥ maven</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.jsonwebtoken<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jjwt-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.12.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-java" lang="java">HashMap&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
map.put(<span class="hljs-string">"id"</span>, <span class="hljs-number">1</span>);
map.put(<span class="hljs-string">"name"</span>, <span class="hljs-string">"admin"</span>);

<span class="hljs-comment">// å­—ç¬¦ä¸²ä¸­åº”è¯¥ï¼Œbase64æœºå¯†çš„ï¼ŒåŠ å¯†å†…å®¹å¿…é¡»è¶³å¤Ÿé•¿</span>
<span class="hljs-type">String</span> <span class="hljs-variable">jwt</span> <span class="hljs-operator">=</span> Jwts.builder().signWith(SignatureAlgorithm.HS256,
                <span class="hljs-string">"abcdefghijklmn"</span>)
        <span class="hljs-comment">// è‡ªå®šä¹‰æ•°æ®</span>
        .addClaims(map)
        <span class="hljs-comment">// è¿‡æœŸæ—¶é—´, å•ä½æ¯«ç§’ + 1å°æ—¶</span>
        .setExpiration(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(System.currentTimeMillis() + <span class="hljs-number">3600</span> * <span class="hljs-number">1000</span>))
        .compact();

<span class="hljs-keyword">return</span> jwt;
</code></pre>
<p>æ‰“å° JWTï¼Œç”¨ä¸‰ä¸ª . åˆ†å‡ºæ¥ä¸‰ä¸ªéƒ¨åˆ†</p>
<p>eyJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoiYWRtaW4iLCJpZCI6MSwiZXhwIjoxNzY2MjI3Njk5fQ.ZBiknENQ1NoKxv4myhVF2uS-toijk90uXz9O70Mhg9s</p>
<ol>
<li>ç¬¬ä¸€ä¸ªéƒ¨åˆ†ï¼Œbase64 è§£å¯†æ˜¯ï¼š{"alg":"HS256"}</li>
<li>ç¬¬äºŒéƒ¨åˆ†ï¼Œå°±æ˜¯æˆ‘ä»¬å­˜å…¥çš„å¯¹è±¡</li>
<li>ç¬¬ä¸‰éƒ¨åˆ†ï¼Œå°±æ˜¯åŠ å¯†å­—ç¬¦ä¸²</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/59168c7f62104d4f8d78453232e375be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOq6YeM55qE56C05rC055O2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231477&amp;x-signature=St2jEaThql6wUKwK1Q06NVJPcn4%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/874484cedb7144a6af893612b26c144f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOq6YeM55qE56C05rC055O2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231477&amp;x-signature=mRPr1z2jBnH1HJvs96q%2FjGHX8Kg%3D" alt="image.png" loading="lazy"/></p>
<p><strong>ä»¤ç‰Œç”Ÿæˆ</strong></p>
<pre><code class="hljs language-java" lang="java">HashMap&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    map.put(<span class="hljs-string">"id"</span>, <span class="hljs-number">1</span>);
    map.put(<span class="hljs-string">"name"</span>, <span class="hljs-string">"admin"</span>);

    <span class="hljs-comment">// å­—ç¬¦ä¸²ä¸­åº”è¯¥ï¼Œbase64åŠ å¯†çš„ï¼ŒåŠ å¯†å†…å®¹å¿…é¡»è¶³å¤Ÿé•¿</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">jwt</span> <span class="hljs-operator">=</span> Jwts.builder().signWith(SignatureAlgorithm.HS256,
                    <span class="hljs-string">"abcdefghijklmn"</span>)
            <span class="hljs-comment">// è‡ªå®šä¹‰æ•°æ®</span>
            .addClaims(map)
            <span class="hljs-comment">// è¿‡æœŸæ—¶é—´, å•ä½æ¯«ç§’ + 1å°æ—¶</span>
            .setExpiration(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(System.currentTimeMillis() + <span class="hljs-number">3600</span> * <span class="hljs-number">1000</span>))
            .compact();
</code></pre>
<p><strong>ä»¤ç‰Œè§£æ</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> <span class="hljs-string">"eyJhbGciOiJIUzI1NiJ9..."</span>;
<span class="hljs-comment">// claims å®é™…å°±æ˜¯ map</span>
<span class="hljs-type">Claims</span> <span class="hljs-variable">claims</span> <span class="hljs-operator">=</span> Jwts.parser().setSigningKey(<span class="hljs-string">"abcdefghijklmn"</span>)
        .parseClaimsJws(token).getBody();
</code></pre>
<h2 data-id="heading-3">è¿‡æ»¤å™¨</h2>
<p>å¤šä¸ªè¿‡æ»¤å™¨æ˜¯æŒ‰ç…§å§“å</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¼€å¯SpringBoot å¯¹ Servlet ç»„ä»¶çš„æ‰«æ</span>
<span class="hljs-meta">@ServletComponentScan</span>
<span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoApplication</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        SpringApplication.run(DemoApplication.class, args);
    }

}
</code></pre>
<p>é…ç½®è¿‡æ»¤å™¨</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@WebFilter(urlPatterns = "/*")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Filter</span> {

    <span class="hljs-comment">// Web æœåŠ¡å™¨å¯åŠ¨æ—¶è°ƒç”¨</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(FilterConfig filterConfig)</span> <span class="hljs-keyword">throws</span> ServletException {
        Filter.<span class="hljs-built_in">super</span>.init(filterConfig);
    }

    <span class="hljs-comment">// æ‹¦æˆªè¯·æ±‚</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doFilter</span><span class="hljs-params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="hljs-keyword">throws</span> IOException, ServletException {

        <span class="hljs-comment">// æ”¾è¡Œï¼Œä¸å†™å°±ä¼šè¢«æ‹¦æˆª</span>
        chain.doFilter(request, response);

    }

    <span class="hljs-comment">// Web æœåŠ¡å™¨å…³é—­æ—¶è°ƒç”¨</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> {
        Filter.<span class="hljs-built_in">super</span>.destroy();
    }
}

</code></pre>
<h2 data-id="heading-4">æ‹¦æˆªå™¨</h2>
<blockquote>
<p>é…ç½®</p>
</blockquote>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> {
        registry.addInterceptor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DemoInterceptor</span>())
                <span class="hljs-comment">// æ‹¦æˆªæ‰€æœ‰è¯·æ±‚</span>
                .addPathPatterns(<span class="hljs-string">"/**"</span>)
                <span class="hljs-comment">// ä¸æ‹¦æˆªçš„è¯·æ±‚</span>
                .excludePathPatterns(<span class="hljs-string">"/login"</span>);
    }
}
</code></pre>
<blockquote>
<p>æ‹¦æˆªå™¨</p>
</blockquote>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerInterceptor</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception {
        System.out.println(<span class="hljs-string">"åœ¨è¯·æ±‚ä¹‹å‰åˆ°ï¼Œtrue è¿”å›ï¼Œfalse è¿”å›"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="hljs-keyword">throws</span> Exception {
        System.out.println(<span class="hljs-string">"ç›®æ ‡è¿è¡Œä¹‹åè¿è¡Œ"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="hljs-keyword">throws</span> Exception {
        System.out.println(<span class="hljs-string">"è¯·æ±‚å½»åº•ç»“æŸ"</span>);
    }
}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5da61f720b464e0c8d4257072bd04439~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOq6YeM55qE56C05rC055O2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231477&amp;x-signature=DhNGSpTU7n8hqliMqkg%2FhUUsShI%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥å‰–æarthasæŠ€æœ¯åŸç†]]></title>    <link>https://juejin.cn/post/7587335187072368666</link>    <guid>https://juejin.cn/post/7587335187072368666</guid>    <pubDate>2025-12-25T01:37:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587335187072368666" data-draft-id="7587263750249463859" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" æ·±å…¥å‰–æarthasæŠ€æœ¯åŸç†"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-25T01:37:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="shark_chili"/> <meta itemprop="url" content="https://juejin.cn/user/2858385964801672"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             æ·±å…¥å‰–æarthasæŠ€æœ¯åŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2858385964801672/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    shark_chili
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T01:37:44.000Z" title="Thu Dec 25 2025 01:37:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»31åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å†™åœ¨æ–‡ç« å¼€å¤´</h2>
<p>ç¬”è€…ä¸€ç›´å¼ºè°ƒï¼Œè®¡ç®—æœºæ˜¯ä¸€é—¨ç†æ€§çš„å­¦ç§‘ï¼Œä¸€åˆ‡éƒ½æ˜¯éœ€è¦å¯é‡åŒ–å’Œè½åœ°çš„ï¼Œè€Œæœ¬æ–‡çš„arthasæ˜¯ä¸€æ¬¾å¼ºå¤§çš„ç›‘æ§è¯Šæ–­å·¥å…·ï¼Œäº†è§£å…¶è®¾è®¡ç†å¿µå’Œå·¥ä½œæœºåˆ¶ï¼Œå¯ä»¥è¾…åŠ©æˆ‘ä»¬æ›´å¥½çš„ä½¿ç”¨è¿™æ¬¾å·¥å…·ã€‚è€Œæœ¬æ–‡å°†ä»<code>jdk8</code>ç‰ˆæœ¬å…¼å®¹çš„æ—§æœ‰ç‰ˆæœ¬ï¼Œå³arhtas 3.6.0çš„æºç è§’åº¦å‡ºå‘ï¼Œæ¥æ·±å…¥åˆ†æå’Œå­¦ä¹ <code>arthas</code>å‡ºè‰²çš„è®¾è®¡ç†å¿µï¼Œå¸Œæœ›å¯¹ä½ æ—¥å¸¸ä½¿ç”¨æœ‰æ‰€å¸®åŠ©ã€‚</p>
<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ <strong>SharkChili</strong> ï¼Œç¦…ä¸è®¡ç®—æœºç¨‹åºè®¾è®¡è‰ºæœ¯å¸ƒé“è€…ï¼Œå¸Œæœ›æˆ‘çš„ç†å¿µå¯¹æ‚¨æœ‰æ‰€å¯å‘ã€‚</p>
<p><strong>ğŸ“ æˆ‘çš„å…¬ä¼—å·ï¼šå†™ä»£ç çš„SharkChili</strong><br/>
åœ¨è¿™é‡Œï¼Œæˆ‘ä¼šåˆ†äº«æŠ€æœ¯å¹²è´§ã€ç¼–ç¨‹æ€è€ƒä¸å¼€æºé¡¹ç›®å®è·µã€‚</p>
<p><strong>ğŸš€ æˆ‘çš„å¼€æºé¡¹ç›®ï¼šmini-redis</strong><br/>
ä¸€ä¸ªç”¨äºæ•™å­¦ç†è§£çš„ Redis ç²¾ç®€å®ç°ï¼Œæ¬¢è¿ Star &amp; Contributeï¼š<br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fshark-ctrl%2Fmini-redis" target="_blank" title="https://github.com/shark-ctrl/mini-redis" ref="nofollow noopener noreferrer">github.com/shark-ctrl/â€¦</a></p>
<p><strong>ğŸ‘¥ æ¬¢è¿åŠ å…¥è¯»è€…ç¾¤</strong><br/>
å…³æ³¨å…¬ä¼—å·ï¼Œå›å¤ <strong>ã€åŠ ç¾¤ã€‘</strong> å³å¯è·å–è”ç³»æ–¹å¼ï¼ŒæœŸå¾…ä¸ä½ äº¤æµæŠ€æœ¯ã€å…±åŒæˆé•¿ï¼</p>
<h2 data-id="heading-1">å‰ç½®çŸ¥è¯†é“ºå«</h2>
<h2 data-id="heading-2">ç¯å¢ƒè¯´æ˜</h2>
<p>è€ƒè™‘åˆ°å¤§éƒ¨åˆ†è¯»è€…ä½¿ç”¨çš„jdkç‰ˆæœ¬ä¸ºjdk8ï¼Œæ‰€ä»¥ç¬”è€…é€‰æ‹©artahs 3.6.0çš„æºç æ¥å±•å¼€æ¼”ç¤ºæœ¬æ–‡çš„æ‰€æœ‰å†…å®¹ï¼Œæ— è®ºæ˜¯macOSè¿˜æ˜¯Windowsç”¨æˆ·ï¼Œè¯·ä¸¥æ ¼éµå¾ªå¦‚ä¸‹å‡ ä¸ªç¯å¢ƒè¯´æ˜ï¼š</p>
<ol>
<li>å…‹éš†æˆ–è€…ä¸‹è½½arhtas-3.6.0ç‰ˆæœ¬ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Falibaba%2Farthas%2Ftree%2Farthas-all-3.6.0" target="_blank" title="https://github.com/alibaba/arthas/tree/arthas-all-3.6.0" ref="nofollow noopener noreferrer">github.com/alibaba/artâ€¦</a></li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8671fc78391a499a80a4c2d62768a043~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=IuFO90htsMT9QizgRD0n9uPzSTA%3D" alt="" loading="lazy"/></p>
<ol start="2">
<li>è°ƒè¯•æ—¶ï¼Œç¨‹åºä¼šä»æœ¬åœ°æ‹‰å–arthas-coreå’Œagentæ–‡ä»¶ï¼Œè¯·è¯»è€…æå‰å®Œæˆarhtas-3.6.0 zipåŒ…çš„ä¸‹è½½ï¼š</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a203e29a0ba4a429fc2d58202183f0a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=gYwcz36iDgOPVdG25olXJyyYhgU%3D" alt="" loading="lazy"/></p>
<p>å¹¶è§£å‹åˆ°é»˜è®¤è¯»å–è·¯å¾„ï¼Œä»¥mac osä¸ºä¾‹åˆ™æ˜¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/Users/ç”¨æˆ·å/.arthas/lib/3.6.0/arthas/arthas-agent.jarå’ŒÂ arthas-core.jar
</code></pre>
<p>å¯¹åº”Windowsç”¨æˆ·åˆ™æ˜¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">C:/Users/ç”¨æˆ·å/.arthas/lib/3.6.0/arthas/arthas-agent.jarå’ŒÂ arthas-core.jar
</code></pre>
<h3 data-id="heading-3">jvmå¦‚ä½•å·¥ä½œçš„</h3>
<p>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦äº†è§£ä¸€ä¸‹<code>java</code>ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ï¼Œæ–¹ä¾¿å¯¹åæ–‡çš„ç†è§£ï¼ŒæŒ‰ç…§å‘¨å¿—æ˜è€å¸ˆã€Šæ·±å…¥ç†è§£jvmè™šæ‹Ÿæœºã€‹è¯´æ³•ï¼Œå¯¹åº”<code>java</code>ç¨‹åºåˆ†ä¸ºå‰ç«¯ç¼–è¯‘å’Œåç«¯ç¼–è¯‘ï¼Œè¿™é‡Œå‰ç«¯ç¼–è¯‘æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºç¨‹åºè¿è¡Œå‰çš„æ“ä½œï¼Œè¯¥é˜¶æ®µä¼šå°†å†™å¥½çš„<code>java</code>ä»£ç é€šè¿‡<code>javac</code>ç¼–è¯‘å™¨ç¼–è¯‘ä¸ºè™šæ‹Ÿæœºæ‰€èƒ½ç†è§£çš„å­—èŠ‚ç ã€‚</p>
<p>åŸºäºä¸Šè¿°çš„å¤„ç†æ„å»ºæˆå­—èŠ‚ç ä¹Ÿå°±æ˜¯ç¨‹åºè¯­è¨€çš„ä¸­é—´è¡¨ç¤ºå½¢å¼ï¼Œæˆ‘ä»¬é”®å…¥<code>java</code>æŒ‡ä»¤å¯åŠ¨ç¨‹åºï¼Œæ­¤æ—¶å°±ä¼šé€šè¿‡<code>C++</code>å¯åŠ¨ä¸€ä¸ªè™šæ‹Ÿæœºå®ä¾‹å¤„ç†ä¸Šè¿°å­—èŠ‚ç ï¼Œä¹Ÿå°±æ˜¯å°†å­—èŠ‚ç è½¬ä¸ºæœ¬åœ°åŸºç¡€è®¾æ–½ä¹Ÿå°±æ˜¯æ“ä½œç³»ç»Ÿæ‰€èƒ½è¯†åˆ«çš„æŒ‡ä»¤é›†å¹¶è¿è¡Œï¼Œè¿™ä¹Ÿå°±æ˜¯åç«¯ç¼–è¯‘ï¼Œå³ï¼š è§£é‡Šå™¨ä¸æ–­è§£é‡Šç”Ÿæˆæ“ä½œç³»ç»Ÿå¯ç†è§£çš„æœºå™¨ç è¿è¡Œ å¯¹äºä¸€äº›çƒ­ç‚¹ä»£ç ï¼Œè™šæ‹Ÿæœº<code>JIT</code>ä¼šå°†å…¶ä¼˜åŒ–å¹¶ç¼–è¯‘ä¸ºæœºå™¨ç ç¼“å­˜ï¼Œåç»­åˆ™ä»¥æœºå™¨ç ç‰ˆæœ¬è¿è¡Œã€‚åŸºäºä¸Šè¿°æ­¥éª¤è™šæ‹Ÿæœºä»¥æ–¹æ³•ä½œä¸ºåŸºæœ¬å•å…ƒï¼Œå³ä»¥æ ˆå¸§æ¥æ”¯æŒæ–¹æ³•çš„è°ƒç”¨å’Œè¿™äº›æŒ‡ä»¤æ–¹æ³•å¯¹åº”çš„æ•°æ®ç»“æ„çš„æ‰§è¡Œï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6558729ede604d0d89521882f23cb8cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=aJID9fs5aBDBRJuOz7R9E4k9b2Q%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">arhtaså¢å¼ºå·¥ä½œæœºåˆ¶</h3>
<p>å› ä¸ºjavaæ˜¯ä¸€é—¨åŠæˆªå¼åŠç¼–è¯‘çš„è¯­è¨€ï¼Œæ‰€ä»¥åœ¨è¿è¡Œæ—¶å°±æœ‰äº†å¾ˆå¤§çš„å¯æ“ä½œç©ºé—´ï¼Œä¾‹å¦‚æˆ‘ä»¬æ—¥å¸¸çš„<code>web</code>æ¥å£æœ‰å¤§é‡çš„ä¸šåŠ¡æŸ¥è¯¢é€»è¾‘ï¼Œå°±åƒä¸‹é¢è¿™æ®µä»£ç ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserService</span>Â {

Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">JSON</span><span class="hljs-built_in">Object</span>Â <span class="hljs-title function_">findById</span>(<span class="hljs-params">longÂ id</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//æ¨¡æ‹ŸæŸ¥è¯¢å’Œè¿”å›ç”¨æˆ·æ•°æ®</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">ThreadUtil</span>.<span class="hljs-title function_">sleep</span>(<span class="hljs-title class_">RandomUtil</span>.<span class="hljs-title function_">randomInt</span>(<span class="hljs-number">200</span>));
Â Â Â Â Â Â Â Â <span class="hljs-title class_">JSON</span><span class="hljs-built_in">Object</span>Â jsonObjectÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">JSON</span><span class="hljs-built_in">Object</span>().<span class="hljs-title function_">putOnce</span>(<span class="hljs-string">"id"</span>,Â id).<span class="hljs-title function_">putOnce</span>(<span class="hljs-string">"name"</span>,Â <span class="hljs-string">"å¼ ä¸‰"</span>);
Â Â Â Â Â Â Â Â <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"æŸ¥è¯¢ç»“æœ:"</span>+jsonObject);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â jsonObject;
Â Â Â Â }
}
</code></pre>
<p>æ­¤æ—¶æˆ‘ä»¬ä¸ºäº†ç»Ÿä¸€æ‰“å°è¾“å‡ºæ¥å£è€—æ—¶ï¼Œå¼ºè¡Œåœ¨æ—¢æœ‰ä»£ç ä¸­è¿›è¡Œå„ç§ç¡¬ç¼–ç ä¸ä»…éå¸¸ç¹çï¼Œè¿˜ä¼šè®©ç ”å‘äººå‘˜è¿‡åˆ†ä¾µå…¥åˆ°ä¸€äº›éä¸šåŠ¡å·¥ä½œä»¥å¤–çš„äº‹æƒ…ï¼Œå½±å“ç¼–ç çš„æ•ˆç‡ã€‚</p>
<p>æ‰€ä»¥è®¾è®¡è€…åŸºäºjavaç¨‹åºè¿è¡Œçš„ç‰¹æ€§åœ¨<code>jdk5</code>ä¸­å¼•å…¥äº†ä¸€ç§å­—èŠ‚ç å¢å¼ºçš„æŠ€æœ¯ï¼Œå…¶åº•å±‚ä¾èµ–äºJVMTIä¹Ÿå°±æ˜¯JVM Tool interfaceï¼Œå®ƒæ˜¯JVMæš´éœ²å‡ºæ¥æ¥ç”¨æˆ·æ‰©å±•çš„æ¥å£é›†åˆï¼ŒåŸºäºè¿™äº›æ¥å£ç¼–å†™æˆ‘ä»¬å°±å¯ä»¥æ‹“å±•å¼€å‘å±äºè‡ªå·±çš„å¢å¼ºé€»è¾‘ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19d6c48e9738449c933bf867da471121~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=xGQuBMMLCxRkQDgdnUkPOVq1xfc%3D" alt="" loading="lazy"/></p>
<p>è¯¥æŠ€æœ¯èŒƒå›´å¯åŠ¨å‰å¢å¼ºå’Œå¯åŠ¨æ—¶å¢å¼ºï¼Œå¯åŠ¨å‰å¢å¼ºé¡¾åæ€ä¹‰åˆ™æ˜¯<code>JVM</code>å¯åŠ¨æ—¶é’ˆå¯¹å­—èŠ‚ç åšçš„å¢å¼ºæ“ä½œï¼Œå¯¹åº”æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°å¦‚ä¸‹æ–¹æ³•ï¼ŒåŸºäºå…¥å‚<code>instrumentation</code>ç¼–å†™å¢å¼ºé€»è¾‘ï¼Œä¾‹å¦‚<code>arthas-agent</code>çš„<code>AgentBootstrap</code>å°±åŸºäºè¯¥å‡½æ•°å®ç°äº†å¯åŠ¨å‰å¢å¼ºé€»è¾‘ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript">Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">premain</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>Â args,Â InstrumentationÂ inst</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-title function_">main</span>(args,Â inst);<span class="hljs-comment">//å­—èŠ‚ç å¢å¼ºé€»è¾‘</span>
Â Â Â Â }
</code></pre>
<p>ç„¶ååœ¨æ‰“jaråŒ…æ—¶ï¼Œé€šè¿‡<code>Premain-Class</code>æŒ‡å®šå…¥å£ç±»å³å¯ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">&lt;Premain-<span class="hljs-keyword">Class</span>&gt;com.taobao.arthas.agent334.AgentBootstrap&lt;/Premain-<span class="hljs-keyword">Class</span>&gt;
</code></pre>
<p>å¯¹åº”æˆ‘ä»¬ä¹Ÿç»™å‡ºè¿è¡Œæµç¨‹å›¾ï¼Œå¦‚ä¸‹å›¾ï¼Œæˆ‘ä»¬é€šè¿‡-jar å‚æ•°å°†æ‰“åŒ…å¥½çš„jaråŒ…attachåˆ°ç›®æ ‡è™šæ‹Ÿæœºï¼Œåœ¨å¯åŠ¨å‰é€šè¿‡<code>addTransformer</code>å°†å­—èŠ‚ç è½¬æ¢å™¨æ·»åŠ åˆ°ç›®æ ‡<code>JVM</code>æ‹¦æˆªæ‰€æœ‰ç±»å®ç°å®šåˆ¶åŒ–å­—èŠ‚ç å¢å¼ºã€‚</p>
<p>æ­¤æ—¶ï¼Œå¯¹åº”JVMè¿›è¡Œç±»åŠ è½½æ—¶ï¼Œå°±ä¼šé€šè¿‡<code>ClassFileTransformer</code>å®Œæˆå­—èŠ‚ç ä¿®æ”¹å®ç°è¿è¡Œå‰å¢å¼ºï¼Œè¿™ç§åšæ³•æœ€å…¸å‹çš„è¿ç”¨åœºæ™¯ä¾¿æ˜¯æ—¥å¸¸çš„ideaç ´è§£å³é€šè¿‡<code>-javaagent:/xxxx.jar=param</code>æŒ‡å®š<code>jar</code>åŒ…å®Œæˆè¿è¡Œå‰å¢å¼ºä¿®æ”¹åŠ å¯†æ–‡ä»¶å’Œè¯ä¹¦ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d09fc10097774746ba367584c421f2af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=hoQKZj5IH8IADelBb5sVMRA2MCs%3D" alt="" loading="lazy"/></p>
<p>è€Œå¦å¤–ä¸€ç§åˆ™æ˜¯è¿è¡Œæ—¶å¢å¼ºï¼Œæœ€å…¸å‹çš„è¿ç”¨å°±æ˜¯<code>artahs</code>ï¼Œè¿è¡Œæ—¶å¢å¼ºçš„å®ç°åˆ™æ˜¯é€šè¿‡å®ç°<code>agentmain</code>å‡½æ•°ï¼Œå¯¹åº”æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨arthas-agentçœ‹åˆ°è¿™ä¸ªå‡½æ•°çš„å®ç°ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript">Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">agentmain</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>Â args,Â InstrumentationÂ inst</span>)Â {
Â Â Â Â Â Â Â Â Â <span class="hljs-title function_">main</span>(args,Â inst);
Â Â Â Â }
</code></pre>
<p>åœ¨<code>agentmain</code>å®Œæˆå¢å¼ºé€»è¾‘åï¼Œé’ˆå¯¹æ‰“åŒ…çš„jaré€šè¿‡Agent-ClassæŒ‡å®šå…¥å£ç±»ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">Â &lt;Agent-<span class="hljs-keyword">Class</span>&gt;com.taobao.arthas.agent334.AgentBootstrap&lt;/Agent-<span class="hljs-keyword">Class</span>&gt;
</code></pre>
<p>å¯¹åº”å…¶å·¥ä½œæµç¨‹å¦‚ä¸‹å›¾ï¼Œé€šè¿‡VirtualMachineéå†å®šä½åˆ°ç›®æ ‡è¿›ç¨‹åï¼Œå°†agent attachåˆ°ç›®æ ‡è¿›ç¨‹ï¼Œæ‰§è¡Œagentmainå®Œæˆjvmå®ä¾‹å¢å¼ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97b4bdee24114266a4e816dc3459bdc7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=z3dGr9TghnkQ%2B%2FACWLmsRajUbvY%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">arthaså¯¹äºå­—èŠ‚ç å¢å¼ºçš„åº”ç”¨</h3>
<p>arthaså°±æ˜¯åˆ©ç”¨è¿è¡Œæ—¶å¢å¼ºçš„å…¸å‹è¿ç”¨ï¼Œå…¶æœ¬è´¨ä¸Šå°±æ˜¯åœ¨è¿è¡Œæ—¶é€šè¿‡attachåˆ°ç›®æ ‡è™šæ‹Ÿæœºï¼Œé’ˆå¯¹åŒ¹é…çš„ç±»è¿›è¡Œé€šè¿‡é«˜æ•ˆç®€æ´å­—èŠ‚ç å·¥å…·<code>bytekit</code>å®Œæˆå­—èŠ‚ç å¢å¼ºï¼Œè€Œè¿™ä¹Ÿå°±æ˜¯arthasçš„monitorã€stackã€traceç­‰å‘½ä»¤å®ç°çš„æœ¬è´¨ã€‚</p>
<p>å¯¹æ­¤ç¬”è€…ä¹Ÿç»™å‡ºä¸€ä¸ªç®€å•çš„<code>bytekit</code>ç¤ºä¾‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä»¥ä¸Šé¢çš„<code>UserService</code>ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¸Œæœ›é’ˆå¯¹è¿™ä¸ªç±»è¿›è¡Œè€—æ—¶æ‰“å°åŒæ—¶è€—æ—¶çš„é€»è¾‘ä¸ä¾µå…¥åˆ°ä¸šåŠ¡ä»£ç ä¸­ï¼Œå¯¹æ­¤æˆ‘ä»¬å°±å¯ä»¥ç”¨åˆ°é˜¿é‡Œçš„bytekitè¿™æ¬¾ç®€å•æ˜“ä¸Šæ‰‹çš„å­—èŠ‚ç å¢å¼ºå·¥å…·å®Œæˆæ¥å£è€—æ—¶æ‰“å°çš„å­—èŠ‚ç å¢å¼ºã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬å¼•å…¥ç›¸å…³çš„ä¾èµ–ï¼Œå¯¹åº”ä¾èµ–å’Œç‰ˆæœ¬å¦‚ä¸‹</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>bytekit-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.1.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.benf<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>cfr<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.152<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>


Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>net.bytebuddy<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>byte-buddy-agent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.14.9<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥è½åœ°ä¸‹é¢è¿™æ ·ä¸€æ®µä»£ç ï¼Œå³åŸºäº<code>bytekit</code>æ³¨è§£å£°æ˜æ–¹æ³•æ‰§è¡Œå‰åçš„å¢å¼ºé€»è¾‘ï¼Œä»¥ç¬”è€…æœ¬æ¬¡çš„æ¡ˆä¾‹ä¸ºä¾‹ï¼Œæœ¬è´¨å°±æ˜¯ï¼š</p>
<ol>
<li>é€šè¿‡<code>atEnter</code>æ³¨è§£å£°æ˜æ‹¦æˆªé€»è¾‘æ‰§è¡Œå‰çš„é€»è¾‘ï¼Œå³è®°å½•å¼€å§‹æ—¶é—´ï¼Œå¹¶é€šè¿‡inlineæŒ‡æ˜é€»è¾‘ç›´æ¥æ”¾åœ¨æ–¹æ³•å†…éƒ¨ï¼Œè¿™ç§åšæ³•çš„å¥½å¤„æ˜¯åœ¨äºjitè¿›è¡Œé€ƒé€¸åˆ†ææ—¶å¯ä»¥åšä¸€äº›ç±»ä¼¼äºæ–¹æ³•å†…è”ç­‰ä¼˜åŒ–æ‰§è¡Œæ•ˆç‡çš„é€»è¾‘</li>
<li><code>atEit</code>å£°æ˜æ–¹æ³•æ‰§è¡Œçš„åç½®é€»è¾‘ï¼Œå³æ‰“å°è¾“å‡ºè€—æ—¶</li>
</ol>
<p>å¯¹åº”çš„æ‹¦æˆªå™¨çš„é€»è¾‘å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title">SampleInterceptor</span>Â Â {
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-built_in">long</span>Â start;

Â Â Â Â @AtEnter(inlineÂ =Â <span class="hljs-literal">true</span>)
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title">atEnter</span>()</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//è®°å½•å¼€å§‹æ—¶é—´</span>
Â Â Â Â Â Â Â Â startÂ =Â System.currentTimeMillis();
Â Â Â Â }

Â Â Â Â @AtExit(inlineÂ =Â <span class="hljs-literal">true</span>)
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title">atEit</span>()</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//è¾“å‡ºæ‰“å°è¢«å¢å¼ºçš„æ–¹æ³•æ€»è€—æ—¶</span>
Â Â Â Â Â Â Â Â System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"cost:"</span>Â +Â (System.currentTimeMillis()Â -Â start));
Â Â Â Â }
}
</code></pre>
<p>éšåæˆ‘ä»¬å†ç»™å‡ºå¯¹åº”çš„å¢å¼ºé€»è¾‘ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p>
<ol>
<li>è§£æä¸Šè¿°<code>SampleInterceptor</code>æ³¨è§£</li>
<li>è·å–<code>UserService</code>å­—èŠ‚ç </li>
<li>å®šä½åˆ°<code>findById</code>ï¼Œé€šè¿‡è§£æåå¾—åˆ°çš„<code>processors</code>å¯¹è¯¥å­—èŠ‚ç è¿›è¡Œå¢å¼º</li>
<li>æ‰“å°å­—èŠ‚ç å’Œå¢å¼ºåçš„é€»è¾‘</li>
</ol>

<pre><code class="hljs language-ini" lang="ini">publicÂ staticÂ voidÂ main(String<span class="hljs-section">[]</span>Â args)Â throwsÂ ExceptionÂ {
Â Â Â Â Â Â Â Â //Â è§£æå®šä¹‰çš„Â Interceptorç±»Â å’Œç›¸å…³çš„æ³¨è§£
Â Â Â Â Â Â Â Â DefaultInterceptorClassParserÂ <span class="hljs-attr">interceptorClassParser</span>Â =Â newÂ DefaultInterceptorClassParser()<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â List&lt;InterceptorProcessor&gt;Â <span class="hljs-attr">processors</span>Â =Â interceptorClassParser.parse(SampleInterceptor.class)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â //Â åŠ è½½å­—èŠ‚ç 
Â Â Â Â Â Â Â Â ClassNodeÂ <span class="hljs-attr">classNode</span>Â =Â AsmUtils.loadClass(UserService.class)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â //Â å¯¹åŠ è½½åˆ°çš„å­—èŠ‚ç åšå¢å¼ºå¤„ç†
Â Â Â Â Â Â Â Â forÂ (MethodNodeÂ methodNodeÂ :Â classNode.methods)Â {
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (!methodNode.name.equals("findById"))Â continue<span class="hljs-comment">;</span>

Â Â Â Â Â Â Â Â Â Â Â Â MethodProcessorÂ <span class="hljs-attr">methodProcessor</span>Â =Â newÂ MethodProcessor(classNode,Â methodNode)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â forÂ (InterceptorProcessorÂ interceptorÂ :Â processors)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â interceptor.process(methodProcessor)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â //Â è·å–å¢å¼ºåçš„å­—èŠ‚ç 
Â Â Â Â Â Â Â Â byte<span class="hljs-section">[]</span>Â <span class="hljs-attr">bytes</span>Â =Â AsmUtils.toBytes(classNode)<span class="hljs-comment">;</span>

Â Â Â Â Â Â Â Â //Â æŸ¥çœ‹åç¼–è¯‘ç»“æœ
Â Â Â Â Â Â Â Â System.out.println(Decompiler.decompile(bytes))<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â AgentUtils.reTransform(UserService.class,Â bytes)<span class="hljs-comment">;</span>

Â Â Â Â Â Â Â Â UserServiceÂ <span class="hljs-attr">sample</span>Â =Â newÂ UserService()<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â sample.findById(1)<span class="hljs-comment">;</span>


Â Â Â Â }
</code></pre>
<p>å¯¹åº”çš„å¢å¼ºåçš„å­—èŠ‚ç å’Œè€—æ—¶å¢å¼ºé€»è¾‘ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5205314f84ae4c6abed7a0917c4e9f79~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=mf%2BCxS%2BeJu9Ufgl85s%2BOs%2FFTK5c%3D" alt="" loading="lazy"/></p>
<p>ä¸ºäº†æ›´å¥½çš„ç†è§£arthasçš„è®¾è®¡ç†å¿µå’Œé€»è¾‘ï¼Œç¬”è€…ä¹ŸåŸºäºä¸Šè¿°çš„demoç¤ºä¾‹è¿›è¡Œè®¾è®¡å’Œå°è£…ä¸€ä¸ªå­—èŠ‚ç å¢å¼ºå·¥å…·ç±»Enhancerã€‚è¾…åŠ©æˆ‘ä»¬æ›´å¥½çš„ç†è§£arhtaså¤æ‚çš„æºç è®¾è®¡å’Œå®ç°ï¼Œå¯ä»¥çœ‹åˆ°é€šè¿‡<code>ByteKit</code>æœ¬è´¨ä¸Šå°±æ˜¯è¦æ±‚æˆ‘ä»¬åŸºäºæ³¨è§£å’Œæ–¹æ³•ç»™å‡ºéœ€è¦å£°æ˜çš„é€»è¾‘ï¼Œç„¶åAsmUtilsä¼šåŠ è½½ç›®æ ‡ç±»çš„å­—èŠ‚ç ä¿®æ”¹ç›®æ ‡æ–¹æ³•çš„é€»è¾‘ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬çš„<code>Enhancer</code>å¯¹äºå‚æ•°çš„å°è£…è¦åšåˆ°å¦‚ä¸‹å‡ ç‚¹ï¼š</p>
<ol>
<li>æ˜ç¡®è¦æ±‚ç”¨æˆ·ä¼ å…¥éœ€è¦å¢å¼ºçš„ç±»ç±»å‹</li>
<li>é€šè¿‡æŠ½è±¡ç±»åšå¥½æ³¨è§£å£°æ˜å¹¶è§„èŒƒç”¨æˆ·è¦å®ç°çš„æ–¹æ³•</li>
<li>æ˜ç¡®ç»™å‡ºseté›†åˆè®©ç”¨æˆ·æŒ‡æ˜éœ€è¦å¢å¼ºçš„æ–¹æ³•</li>
</ol>
<p>æœ‰äº†ä¸Šè¿°çš„å‚æ•°ï¼Œæˆ‘ä»¬çš„å¢å¼ºå·¥å…·ç±»å°±å¯ä»¥åšåˆ°ï¼š</p>
<ol>
<li>é€šè¿‡ä¼ å…¥çš„ç´¯åŠ å™¨çš„ç±»ç±»å‹è§£æå¾—å‡ºæ‹¦æˆªå¤„ç†å™¨</li>
<li>åŠ è½½ç›®æ ‡å­—èŠ‚ç æ–‡ä»¶</li>
<li>é€šè¿‡<code>set</code>è¿‡æ»¤å‡ºéœ€è¦å¢å¼ºçš„ç›®æ ‡æ–¹æ³•</li>
<li>ä¿®æ”¹ç›®æ ‡æ–¹æ³•çš„å­—èŠ‚ç </li>
<li>è¿”å›å­—èŠ‚ç æ–‡ä»¶</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eee780129f8e4416aa0f27b4c5131ec6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=JyuREt%2F3HJmhTdq%2BJZy0sOiWWs0%3D" alt="" loading="lazy"/></p>
<p>æ‰€ä»¥åŸºäºè¿™ä¸ªæ€è·¯æˆ‘ä»¬å°è£…å‡ºäº†æ‹¦æˆªå™¨çš„æŠ½è±¡ç±»ï¼Œå‘ŠçŸ¥ç”¨æˆ·å¯çµæ´»ç»§æ‰¿å®ç°çš„æ‰©å±•ç‚¹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">/**
Â *Â è§„èŒƒæ€§çº¦æŸ
Â */</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">abstract</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title">AbstractInterceptor</span>Â {
Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â å‡½æ•°å…¥å£å¢å¼ºç‚¹
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">static</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title">atEnter</span>()</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//nothingÂ toÂ do</span>
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â å‡½æ•°é€€å‡ºæ‰©å±•ç‚¹
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">static</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title">atExit</span>()</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//nothingÂ toÂ do</span>
Â Â Â Â }
}
</code></pre>
<p>å¯¹åº”çš„æˆ‘ä»¬çš„sampleç»§æ‰¿å…³ç³»å°±å˜ä¸ºè¿™æ ·ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title">SampleInterceptor</span>Â <span class="hljs-title">extends</span>Â <span class="hljs-title">AbstractInterceptor</span>Â {

Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-built_in">long</span>Â start;

Â Â Â Â @AtEnter(inlineÂ =Â <span class="hljs-literal">true</span>)
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title">atEnter</span>()</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//è®°å½•å¼€å§‹æ—¶é—´</span>
Â Â Â Â Â Â Â Â startÂ =Â System.currentTimeMillis();
Â Â Â Â }

Â Â Â Â @AtExit(inlineÂ =Â <span class="hljs-literal">true</span>)
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title">atEit</span>()</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//è¾“å‡ºæ‰“å°è¢«å¢å¼ºçš„æ–¹æ³•æ€»è€—æ—¶</span>
Â Â Â Â Â Â Â Â System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"cost:"</span>Â +Â (System.currentTimeMillis()Â -Â start));
Â Â Â Â }
}
</code></pre>
<p>åœ¨æ­¤åŸºç¡€ä¸Šæˆ‘ä»¬å°è£…ä¸€ä¸ªå­—èŠ‚ç å¢å¼ºçš„å·¥å…·ç±»ï¼Œå³ï¼š</p>
<ol>
<li>é€šè¿‡<code>interceptorClzz</code>ç”Ÿæˆå¤„ç†å™¨<code>processorList</code></li>
<li>é€šè¿‡<code>AsmUtils</code>åŠ è½½ç›®æ ‡ç±»çš„å­—èŠ‚ç </li>
<li>é€šè¿‡<code>matcherMethod</code>åŒ¹é…ç›®æ ‡æ–¹æ³•ï¼Œå¹¶é€šè¿‡<code>processorList</code>ä¿®æ”¹å­—èŠ‚ç å®Œæˆå¢å¼º</li>
</ol>

<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">/**
Â *Â å­—èŠ‚ç å¢å¼ºå·¥å…·ç±»
Â */</span>
publicÂ classÂ EnhancerÂ {
Â Â Â Â publicÂ byte<span class="hljs-selector-attr">[]</span>Â <span class="hljs-built_in">enhance</span>(ClassÂ target,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Set&lt;String&gt;Â matcherMethod,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Class&lt;?Â extendsÂ AbstractInterceptor&gt;Â clzz)Â throwsÂ ExceptionÂ {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è§£æå®šä¹‰çš„Â Interceptorç±»Â å’Œç›¸å…³çš„æ³¨è§£</span>
Â Â Â Â Â Â Â Â DefaultInterceptorClassParserÂ interceptorClassParserÂ =Â newÂ <span class="hljs-built_in">DefaultInterceptorClassParser</span>();
Â Â Â Â Â Â Â Â List&lt;InterceptorProcessor&gt;Â processorListÂ =Â interceptorClassParser<span class="hljs-selector-class">.parse</span>(clzz);
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åŠ è½½éœ€è¦å¢å¼ºçš„ç±»çš„å­—èŠ‚ç </span>
Â Â Â Â Â Â Â Â ClassNodeÂ classNodeÂ =Â AsmUtils<span class="hljs-selector-class">.loadClass</span>(target);
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¯¹åŠ è½½åˆ°çš„å­—èŠ‚ç åšå¢å¼ºå¤„ç†</span>
Â Â Â Â Â Â Â Â forÂ (MethodNodeÂ methodNodeÂ :Â classNode.methods)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦æ˜¯åŒ¹é…çš„æ–¹æ³•,å¦‚æœä¸æ˜¯ä¸åšå¢å¼º</span>
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (!matcherMethod.contains(methodNode.name))Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â continue;
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//åŸºäºè§£æåçš„processorListå¯¹ç›®æ ‡è¿›è¡Œå¢å¼º</span>
Â Â Â Â Â Â Â Â Â Â Â Â MethodProcessorÂ methodProcessorÂ =Â newÂ <span class="hljs-built_in">MethodProcessor</span>(classNode,Â methodNode);
Â Â Â Â Â Â Â Â Â Â Â Â forÂ (InterceptorProcessorÂ interceptorÂ :Â processorList)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â interceptor<span class="hljs-selector-class">.process</span>(methodProcessor);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è·å–å¢å¼ºåçš„å­—èŠ‚ç </span>
Â Â Â Â Â Â Â Â byte<span class="hljs-selector-attr">[]</span>Â bytesÂ =Â AsmUtils<span class="hljs-selector-class">.toBytes</span>(classNode);

Â Â Â Â Â Â Â Â returnÂ bytes;
Â Â Â Â }

Â Â Â Â 
}
</code></pre>
<p>æœ€åæˆ‘ä»¬å†ç»™å‡ºä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-type">static</span>Â <span class="hljs-type">void</span>Â <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">String</span>[]Â args)</span>Â throwsÂ ExceptionÂ </span>{
Â Â Â Â Â Â Â Â EnhancerÂ enhanceÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-built_in">Enhancer</span>();
Â Â Â Â Â Â Â Â <span class="hljs-type">byte</span>[]Â bytesÂ =Â enhance.<span class="hljs-built_in">enhance</span>(UserService.<span class="hljs-keyword">class</span>,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â CollUtil.<span class="hljs-built_in">newHashSet</span>(<span class="hljs-string">"findById"</span>),
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â SampleInterceptor.<span class="hljs-keyword">class</span>);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æŸ¥çœ‹åç¼–è¯‘ç»“æœ</span>
Â Â Â Â Â Â Â Â System.out.<span class="hljs-built_in">println</span>(Decompiler.<span class="hljs-built_in">decompile</span>(bytes));
Â Â Â Â Â Â Â Â AgentUtils.<span class="hljs-built_in">reTransform</span>(UserService.<span class="hljs-keyword">class</span>,Â bytes);
Â Â Â Â Â Â Â Â <span class="hljs-comment">//æµ‹è¯•ä¿®æ”¹åçš„ç»“æœæ˜¯å¦æ‰“å°è¾“å‡ºè€—æ—¶</span>
Â Â Â Â Â Â Â Â UserServiceÂ userServiceÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-built_in">UserService</span>();
Â Â Â Â Â Â Â Â userService.<span class="hljs-built_in">findById</span>(<span class="hljs-number">1</span>);
Â Â Â Â }
</code></pre>
<p>åŒæ—¶æˆ‘ä»¬ä¹Ÿç»™å‡ºå¯¹åº”çš„è¾“å‡ºç»“æœï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b64b8e1923b149298fd3758383780b2f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=FFLfq4KFu2uUhAinpHjIbQF1xI0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">è¯¦è§£arthaså·¥ä½œå…¨æµç¨‹</h2>
<h3 data-id="heading-7">arthas bootå¯åŠ¨</h3>
<h4 data-id="heading-8">å®è§‚æµç¨‹è¯´æ˜</h4>
<p>é€šè¿‡ä¸Šè¿°çš„é“ºå«ï¼Œæˆ‘ä»¬å·²ç»å¯¹<code>arthas</code>è¿ç”¨çš„æ ¸å¿ƒæŠ€æœ¯æœ‰äº†åˆæ­¥çš„äº†è§£ï¼Œæ¥ä¸‹æ¥ç¬”è€…å°†ä»æºç çš„æ±Ÿéƒ½æ·±å…¥åˆ†æè¿™ä¸€ç‚¹ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦ä»<code>arthas-boot</code>è¿™ä¸ªç¨‹åºè¯´èµ·ï¼Œæœ¬è´¨ä¸Šå½“æˆ‘ä»¬æ‰§è¡Œ<code>as.sh</code>åï¼Œæ‰§è¡Œè„šæœ¬å°±æ˜¯å¯åŠ¨ä¸€ä¸ª<code>arthas-boot</code>è¿›ç¨‹ï¼Œå¯¹åº”çš„æ‰§è¡Œæ ¸å¿ƒæµç¨‹ä¸ºï¼š</p>
<ol>
<li>è§£æç”¨æˆ·å‚æ•°</li>
<li>è·å–é<code>arthas</code>è¿›ç¨‹ä»¥å¤–çš„ç¨‹åºï¼Œå¹¶ç”Ÿæˆåˆ—è¡¨åœ¨æ§åˆ¶å°è¾“å‡º</li>
<li>ç­‰å¾…ç”¨æˆ·è¾“å…¥éœ€è¦æŒ‡å®šè¿›ç¨‹åºå·</li>
<li>å°†ç›®æ ‡è¿›ç¨‹å·ã€<code>arhtas-core</code>å’Œ<code>arthas-agent</code>è·¯å¾„ä½œä¸ºå‚æ•°ï¼Œå¯åŠ¨<code>arthas-core.jar</code>è®©å…¶å®Œæˆåç»­å·¥ä½œ</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c43d06b54db1446b8098a595b7483dbc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=zmUnwakg8gpxGnnkT5IliLV49YA%3D" alt="" loading="lazy"/></p>
<p>å¦‚ä¸‹å›¾ï¼Œç¬”è€…ä¼ å…¥<code>--telnet-port 9999</code>å¯åŠ¨<code>arthas-boot</code>ï¼Œ<code>arhtas-boot</code>å¯åŠ¨æ—¶å°±ä¼šè§£æå‚æ•°ï¼Œç„¶åé€šè¿‡æ‰§è¡ŒjpsæŒ‡ä»¤è·å–éæœ¬è¿›ç¨‹çš„ç¨‹åºpidï¼Œç„¶åç”Ÿæˆåˆ—è¡¨ï¼Œç­‰å¾…ç”¨æˆ·é€‰æ‹©ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9d67d41bb674f2f804e76a5ce7bef52~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=mz2nPZZJzlD215ij9C8gvU%2Fz4U8%3D" alt="" loading="lazy"/></p>
<p>æœ€åå°†pidå·å’Œarhtas-coreå’Œarthasä¸€å¹¶ä½œä¸ºå‚æ•°å¯åŠ¨arthas-coreï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">javaÂ -jarÂ /Users/sharkchili/.arthas/lib/4.1.3/arthas/arthas-core.jarÂ Â -pidÂ Â 61223Â Â -telnet-portÂ 9999,Â -coreÂ /Users/sharkchili/.arthas/lib/4.1.3/arthas/arthas-core.jarÂ Â -agentÂ Â /Users/sharkchili/.arthas/lib/4.1.3/arthas/arthas-agent.jarÂ 
</code></pre>
<h4 data-id="heading-9">å‚æ•°è§£æ</h4>
<p>å¯¹åº”çš„ç¬”è€…ä¹Ÿç»™å‡ºå¯¹åº”æºç æ¥å°è¯è¿™ä¸€ç‚¹ï¼Œä¸Šè¿°çš„ä¸»æµç¨‹éƒ½ä½äº<code>arthas-boot</code>çš„<code>Bootstrap</code>çš„<code>main</code>æ–¹æ³•ï¼Œå› ä¸ºé€»è¾‘æ¯”è¾ƒé•¿æ‰€ä»¥ç¬”è€…è¿™é‡Œé€æ­¥æ‹†è§£åˆ†æï¼Œé¦–å…ˆæ˜¯å‚æ•°è§£æï¼Œä¾‹å¦‚ç¬”è€…ä¸Šè¿°ä¼ å…¥çš„telnetå‚æ•°å°±ä¼šåœ¨è¿™é‡Œå®Œæˆè§£æå¹¶ç»‘å®šåˆ°<code>bootstrap</code>ï¼š</p>
<pre><code class="hljs language-swift" lang="swift">Â Â <span class="hljs-type">CLI</span>Â cliÂ <span class="hljs-operator">=</span>Â <span class="hljs-type">CLIConfigurator</span>.define(<span class="hljs-type">Bootstrap</span>.class);
Â Â Â Â Â Â Â Â <span class="hljs-comment">//--telnet-portÂ 9999</span>
Â Â Â Â Â Â Â Â <span class="hljs-type">CommandLine</span>Â commandLineÂ <span class="hljs-operator">=</span>Â cli.parse(<span class="hljs-type">Arrays</span>.asList(args));

Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//å°†å‚æ•°ç»‘å®šåˆ°bootstrapÂ æ­¤æ—¶bootstrapå±æ€§å°±ä¼šæ·»åŠ é…ç½®çš„å‚æ•°å€¼</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-type">CLIConfigurator</span>.inject(commandLine,Â bootstrap);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-type">Throwable</span>Â e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â }
</code></pre>
<h4 data-id="heading-10">è·å–ç›®æ ‡è¿›ç¨‹</h4>
<p>ç„¶åå°±æ˜¯æŸ¥çœ‹ç”¨æˆ·å¯åŠ¨å‚æ•°ä¸­æ˜¯å¦æŒ‡æ˜äº†pidï¼Œè‹¥æ²¡æœ‰åˆ™è°ƒç”¨<code>ProcessUtils</code>çš„<code>select</code>é€šè¿‡jpsæŒ‡ä»¤ç”Ÿæˆè¿›ç¨‹åˆ—è¡¨è®©ç”¨æˆ·é€‰æ‹©ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Â Â <span class="hljs-comment">//æŸ¥çœ‹å‚æ•°æ˜¯å¦æŒ‡æ˜äº†pid,è‹¥æ²¡æœ‰</span>
Â Â Â Â Â Â Â Â longÂ pidÂ =Â bootstrap<span class="hljs-selector-class">.getPid</span>();
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è‹¥æ²¡æœ‰æŒ‡æ˜pid,åˆ™è°ƒç”¨selectè¾“å‡ºæ‰€æœ‰è¿›ç¨‹è®©ç”¨æˆ·é€‰æ‹©</span>
Â Â Â Â Â Â Â Â ifÂ (pidÂ &lt;Â <span class="hljs-number">0</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//è°ƒç”¨jpsç”Ÿæˆè¿›ç¨‹åˆ—è¡¨ç­‰å¾…ç”¨æˆ·é€‰æ‹©</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â pidÂ =Â ProcessUtils<span class="hljs-selector-class">.select</span>(bootstrap.isVerbose(),Â telnetPortPid,Â bootstrap<span class="hljs-selector-class">.getSelect</span>());
Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (InputMismatchExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â }
</code></pre>
<p>å¯¹åº”çš„ç¬”è€…ä¹Ÿç»™å‡º<code>ProcessUtils</code>çš„<code>select</code>çš„å…·ä½“å®ç°å±•å¼€è¯´æ˜ï¼š</p>
<ol>
<li>é€šè¿‡jpsè·å–éæœ¬è¿›ç¨‹ä»¥å¤–çš„javaè¿›ç¨‹</li>
<li>ç”Ÿæˆpidä¸ºkeyï¼Œè¿›ç¨‹pid+å¯åŠ¨ç±»çš„å­—ç¬¦ä¸²valueä½œä¸ºå€¼å¦‚<code>57844 org.jetbrains.jps.cmdline.Launcher</code>çš„mapé›†åˆ</li>
<li>æŒ‰é¡ºåºå°†å…¶è¾“å‡º</li>
<li>åˆ©ç”¨Scannerå·¥å…·ç±»ç­‰å¾…ç”¨æˆ·ç»ˆç«¯è¾“å…¥åºå·</li>
<li>è¿”å›å¯¹åº”pidï¼Œæ‰§è¡Œåç»­æ­¥éª¤ï¼š</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c5f2165286fa4bffa006f49cab332a93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=zA76Ama8UZibMj0C7mtk%2B5NnnJo%3D" alt="" loading="lazy"/></p>
<p>å¯¹åº”æºç å¦‚ä¸‹ï¼Œå¤§ä½“é€»è¾‘å’Œä¸Šè¿°è¯´æ˜ä¸€è‡´å³é€šè¿‡jpsè·å–æ‰€æœ‰è¿›ç¨‹ï¼Œå¹¶ç”Ÿæˆmapæ˜ å°„æŒ‰åºè¾“å‡ºï¼ŒéšååŸºäºç”¨æˆ·é€‰æ‹©ç»“æœè¿”å›æŒ‡å®špidå·ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-type">static</span>Â <span class="hljs-type">long</span>Â <span class="hljs-title">select</span><span class="hljs-params">(<span class="hljs-type">boolean</span>Â v,Â <span class="hljs-type">long</span>Â telnetPortPid,Â <span class="hljs-type">String</span>Â select)</span>Â throwsÂ InputMismatchExceptionÂ </span>{
Â Â Â Â Â Â Â Â <span class="hljs-comment">//æ‰§è¡ŒjpsæŒ‡ä»¤ç”Ÿæˆpidä¸ºkeyÂ è¿›ç¨‹è¯¦æƒ…çš„valueçš„map</span>
Â Â Â Â Â Â Â Â Map&lt;Long,Â <span class="hljs-type">String</span>&gt;Â processMapÂ =Â <span class="hljs-built_in">listProcessByJps</span>(v);Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å°†è¿›ç¨‹æŒ‰åºæ‰“å°,ä»1å¼€å§‹,æ–¹ä¾¿ç”¨æˆ·ç›´è§‚é€‰æ‹©è¿›ç¨‹</span>
Â Â Â Â Â Â Â Â <span class="hljs-type">int</span>Â countÂ =Â <span class="hljs-number">1</span>;
Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-type">String</span>Â processÂ :Â processMap.<span class="hljs-built_in">values</span>())Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (countÂ ==Â <span class="hljs-number">1</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.<span class="hljs-built_in">println</span>(<span class="hljs-string">"*Â ["</span>Â +Â countÂ +Â <span class="hljs-string">"]:Â "</span>Â +Â process);
Â Â Â Â Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">else</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.<span class="hljs-built_in">println</span>(<span class="hljs-string">"Â Â ["</span>Â +Â countÂ +Â <span class="hljs-string">"]:Â "</span>Â +Â process);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â count++;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç­‰å¾…ç”¨æˆ·é€‰æ‹©</span>
Â Â Â Â Â Â Â Â <span class="hljs-type">String</span>Â lineÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-built_in">Scanner</span>(System.in).<span class="hljs-built_in">nextLine</span>();
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (line.<span class="hljs-built_in">trim</span>().<span class="hljs-built_in">isEmpty</span>())Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â getÂ theÂ firstÂ processÂ id</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â processMap.<span class="hljs-built_in">keySet</span>().<span class="hljs-built_in">iterator</span>().<span class="hljs-built_in">next</span>();
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-type">int</span>Â choiceÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-built_in">Scanner</span>(line).<span class="hljs-built_in">nextInt</span>();

Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//é€šè¿‡æ•°å­—å®šä½åˆ°å…·ä½“pidå·è¿”å›</span>
Â Â Â Â Â Â Â Â Iterator&lt;Long&gt;Â idIterÂ =Â processMap.<span class="hljs-built_in">keySet</span>().<span class="hljs-built_in">iterator</span>();
Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-type">int</span>Â iÂ =Â <span class="hljs-number">1</span>;Â iÂ &lt;=Â choice;Â ++i)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (iÂ ==Â choice)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â idIter.<span class="hljs-built_in">next</span>();
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â idIter.<span class="hljs-built_in">next</span>();
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-number">-1</span>;
Â Â Â Â }
</code></pre>
<h4 data-id="heading-11">æ•´åˆå‚æ•°å¯åŠ¨arthas-core</h4>
<p>æœ‰äº†ä¸Šè¿°è§£æçš„å‚æ•°å’Œpidè¿›ç¨‹å·ï¼Œ<code>arthas-boot</code>å°±ä¼šåŸºäºè¿™äº›ä¿¡æ¯å¯åŠ¨<code>arthas-core</code>ï¼Œè®©å…¶å®Œæˆåç»­çš„æ ¸å¿ƒå·¥ä½œ(å·¥ä½œå†…å®¹ç¬”è€…åæ–‡ä¼šå±•å¼€è¯´æ˜)ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆçœ‹çœ‹<code>artahs-core</code>çš„æœ€é‡è¦çš„ä¸€æ­¥<code>arthas-core</code>å¯åŠ¨çš„å®ç°ï¼Œä»æºç å¯ä»¥çœ‹åˆ°å…¶å†…éƒ¨ä¼šé€šè¿‡<code>attachArgs</code>é¡ºåºæ‹¼æ¥å„ç§å‚æ•°ï¼Œç„¶åç”Ÿæˆç±»ä¼¼äºå¦‚ä¸‹çš„å¯åŠ¨æŒ‡ä»¤å¯åŠ¨coreï¼š</p>
<pre><code class="hljs language-bash" lang="bash">javaÂ -jarÂ /Users/sharkchili/.arthas/lib/4.1.3/arthas/arthas-core.jarÂ Â -pidÂ Â 61223Â Â -telnet-portÂ 9999,Â -coreÂ /Users/sharkchili/.arthas/lib/4.1.3/arthas/arthas-core.jarÂ Â -agentÂ Â /Users/sharkchili/.arthas/lib/4.1.3/arthas/arthas-agent.jar
</code></pre>
<p>å¯¹åº”é€»è¾‘æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯æ‹¼æ¥å’Œè§£æå‚æ•°ç”Ÿæˆå¯åŠ¨æŒ‡ä»¤å¯åŠ¨<code>jar</code>çš„é€»è¾‘ï¼Œè¿™é‡Œç¬”è€…å°±ä¸å¤šåšèµ˜è¿°äº†ï¼š</p>
<pre><code class="hljs language-erlang" lang="erlang"><span class="hljs-function"><span class="hljs-title">if</span>Â <span class="hljs-params">(telnetPortPidÂ &gt;Â <span class="hljs-number">0</span>Â &amp;&amp;Â pidÂ ==Â telnetPortPid)</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â A<span class="hljs-title">nsiLog</span>.<span class="hljs-title">info</span><span class="hljs-params">(<span class="hljs-string">"TheÂ targetÂ processÂ alreadyÂ listenÂ portÂ {},Â skipÂ attach."</span>,Â bootstrap.getTelnetPortOrDefault())</span>;
Â Â Â Â Â Â Â Â }Â <span class="hljs-title">else</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â //<span class="hljs-title">double</span>Â <span class="hljs-title">check</span>Â <span class="hljs-title">telnet</span>Â <span class="hljs-title">port</span>Â <span class="hljs-title">and</span>Â <span class="hljs-title">pid</span>Â <span class="hljs-title">before</span>Â <span class="hljs-title">attach</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">telnetPortPid</span>Â =Â <span class="hljs-title">findProcessByTelnetClient</span><span class="hljs-params">(arthasHomeDir.getAbsolutePath(),Â bootstrap.getTelnetPortOrDefault())</span>;
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">checkTelnetPortPid</span><span class="hljs-params">(bootstrap,Â telnetPortPid,Â pid)</span>;

Â Â Â Â Â Â Â Â Â Â Â Â //Â <span class="hljs-title">start</span>Â <span class="hljs-title">arthas</span>-<span class="hljs-title">core</span>.<span class="hljs-title">jar</span>
Â Â Â Â Â Â Â Â Â Â Â Â //æ‹¼æ¥<span class="hljs-title">jar</span>å’Œ<span class="hljs-title">arhtas</span>-<span class="hljs-title">boot</span>è·¯å¾„
Â Â Â Â Â Â Â Â Â Â Â Â L<span class="hljs-title">ist</span>&lt;S<span class="hljs-title">tring</span>&gt;Â <span class="hljs-title">attachArgs</span>Â =Â <span class="hljs-title">new</span>Â A<span class="hljs-title">rrayList</span>&lt;S<span class="hljs-title">tring</span>&gt;<span class="hljs-params">()</span>;
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">attachArgs</span>.<span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-string">"-jar"</span>)</span>;
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">attachArgs</span>.<span class="hljs-title">add</span><span class="hljs-params">(newÂ File(arthasHomeDir,Â <span class="hljs-string">"arthas-core.jar"</span>)</span>.<span class="hljs-title">getAbsolutePath</span><span class="hljs-params">()</span>);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">attachArgs</span>.<span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-string">"-pid"</span>)</span>;
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">attachArgs</span>.<span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-string">""</span>Â +Â pid)</span>;
Â Â Â Â Â Â Â Â Â Â Â Â //......
Â Â Â Â Â Â Â Â Â Â Â Â //æ‹¼æ¥æˆ‘ä»¬æ·»åŠ çš„<span class="hljs-title">telnet</span>å‚æ•°
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">if</span>Â <span class="hljs-params">(bootstrap.getTelnetPort()Â !=Â null)</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">attachArgs</span>.<span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-string">"-telnet-port"</span>)</span>;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">attachArgs</span>.<span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-string">""</span>Â +Â bootstrap.getTelnetPort())</span>;
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">if</span>Â <span class="hljs-params">(bootstrap.getHttpPort()Â !=Â null)</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">attachArgs</span>.<span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-string">"-http-port"</span>)</span>;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">attachArgs</span>.<span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-string">""</span>Â +Â bootstrap.getHttpPort())</span>;
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â //æ‹¼æ¥<span class="hljs-title">core</span>å’Œ<span class="hljs-title">agent</span>çš„è·¯å¾„ç»å¯¹è·¯å¾„åœ°å€
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">attachArgs</span>.<span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-string">"-core"</span>)</span>;
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">attachArgs</span>.<span class="hljs-title">add</span><span class="hljs-params">(newÂ File(arthasHomeDir,Â <span class="hljs-string">"arthas-core.jar"</span>)</span>.<span class="hljs-title">getAbsolutePath</span><span class="hljs-params">()</span>);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">attachArgs</span>.<span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-string">"-agent"</span>)</span>;
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title">attachArgs</span>.<span class="hljs-title">add</span><span class="hljs-params">(newÂ File(arthasHomeDir,Â <span class="hljs-string">"arthas-agent.jar"</span>)</span>.<span class="hljs-title">getAbsolutePath</span><span class="hljs-params">()</span>);
Â Â Â Â Â Â Â Â Â Â Â Â //......

Â Â Â Â Â Â Â Â Â Â Â Â A<span class="hljs-title">nsiLog</span>.<span class="hljs-title">info</span><span class="hljs-params">(<span class="hljs-string">"TryÂ toÂ attachÂ processÂ "</span>Â +Â pid)</span>;
Â Â Â Â Â Â Â Â Â Â Â Â A<span class="hljs-title">nsiLog</span>.<span class="hljs-title">debug</span><span class="hljs-params">(<span class="hljs-string">"StartÂ arthas-core.jarÂ args:Â "</span>Â +Â attachArgs)</span>;
Â Â Â Â Â Â Â Â Â Â Â Â //åŸºäºä¸Šè¿°<span class="hljs-title">attachArgs</span>ç”Ÿæˆå¯åŠ¨å‘½ä»¤å¯åŠ¨<span class="hljs-title">arthas</span>-<span class="hljs-title">core</span>
Â Â Â Â Â Â Â Â Â Â Â Â P<span class="hljs-title">rocessUtils</span>.<span class="hljs-title">startArthasCore</span><span class="hljs-params">(pid,Â attachArgs)</span>;Â //<span class="hljs-title">java</span>Â -<span class="hljs-title">jar</span>Â /U<span class="hljs-title">sers</span>/<span class="hljs-title">sharkchili</span>/.<span class="hljs-title">arthas</span>/<span class="hljs-title">lib</span>/4.1.3/<span class="hljs-title">arthas</span>/<span class="hljs-title">arthas</span>-<span class="hljs-title">core</span>.<span class="hljs-title">jar</span>Â Â -<span class="hljs-title">pid</span>Â Â 61223Â Â -<span class="hljs-title">telnet</span>-<span class="hljs-title">port</span>Â 9999,Â -<span class="hljs-title">core</span>Â /U<span class="hljs-title">sers</span>/<span class="hljs-title">sharkchili</span>/.<span class="hljs-title">arthas</span>/<span class="hljs-title">lib</span>/4.1.3/<span class="hljs-title">arthas</span>/<span class="hljs-title">arthas</span>-<span class="hljs-title">core</span>.<span class="hljs-title">jar</span>Â Â -<span class="hljs-title">agent</span>Â Â /U<span class="hljs-title">sers</span>/<span class="hljs-title">sharkchili</span>/.<span class="hljs-title">arthas</span>/<span class="hljs-title">lib</span>/4.1.3/<span class="hljs-title">arthas</span>/<span class="hljs-title">arthas</span>-<span class="hljs-title">agent</span>.<span class="hljs-title">jar</span>

Â Â Â Â Â Â Â Â Â Â Â Â A<span class="hljs-title">nsiLog</span>.<span class="hljs-title">info</span><span class="hljs-params">(<span class="hljs-string">"AttachÂ processÂ {}Â success."</span>,Â pid)</span>;
Â Â Â Â Â Â Â Â }
</span></code></pre>
<p>è‡ªæ­¤æˆ‘ä»¬æ¥å°ç»“ä¸€ä¸‹ï¼Œ<code>arthas-boot</code>å¯åŠ¨æ­¥éª¤ï¼š</p>
<ol>
<li>è§£æå¯åŠ¨å‚æ•°</li>
<li>è·å–æ‰€æœ‰javaè¿›ç¨‹ç”Ÿæˆåˆ—è¡¨ç­‰å¾…ç”¨æˆ·é€‰æ‹©</li>
<li>åŸºäºé€‰æ‹©çš„pidå·å’Œagentå’Œcoreä¸¤ä¸ªæ ¸å¿ƒæ¨¡å—çš„ç»å¯¹è·¯å¾„ç”Ÿæˆarthas-coreæŒ‡ä»¤å¯åŠ¨arhtas-core</li>
</ol>
<h3 data-id="heading-12">arthas-core å¯åŠ¨</h3>
<h4 data-id="heading-13">æ‰§è¡Œæµç¨‹å’Œè°ƒè¯•ç¯å¢ƒè¯´æ˜</h4>
<p>æˆ‘ä»¬é‡ç‚¹è¿˜æ˜¯å…³æ³¨ä¸€ä¸‹arthas-coreçš„é€»è¾‘ï¼Œå®ƒæ˜¯åŠ¨æ€å¢å¼ºå¹¶å®ç°åŠ¨æ€æ’æ¡©å¢å¼ºçš„å…³é”®ï¼Œå…¶å†…éƒ¨æœ¬è´¨å·¥ä½œæœ¬è´¨å°±æ˜¯å°†arthas-agent attachåˆ°ä¸Šä¸€æ­¥é€‰å®šçš„è¿›ç¨‹è¿›è¡ŒåŠ¨æ€å¢å¼ºã€‚</p>
<p>ä¸ºäº†èƒ½å¤Ÿè°ƒæµ‹è¿™æ®µæºä»£ç ï¼Œç¬”è€…é’ˆå¯¹è¿™æ®µè°ƒæµ‹è¿‡ç¨‹è¿›è¡Œä¸€ä¸ªç®€è¦çš„è¯´æ˜ï¼Œæœ¬è´¨ä¸Šé€šè¿‡ä¸Šä¸€æ­¥çš„arthas-bootä¼šå¯åŠ¨artahs-coreè®©å…¶å°†<code>arthas-agent</code>èƒ½å¤Ÿattachåˆ°è¿è¡Œæ—¶çš„ç›®æ ‡è™šæ‹Ÿæœºä¸Šï¼Œæ‰€ä»¥ä¸ºäº†èƒ½å¤Ÿè°ƒæµ‹çš„attachçš„é€»è¾‘ï¼Œarthasçš„ä½œè€…ä¹Ÿåœ¨å¯åŠ¨è„šæœ¬ä¸Šåšäº†ä¸€äº›æ‰‹è„šã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦é€šè¿‡asè„šæœ¬æŒ‡å®š<code>--debug-attach</code>å°†<code>arthas-boot</code>å¯åŠ¨ï¼Œç„¶åæˆ‘ä»¬æŒ‰ç…§è¯´æ˜é€‰æ‹©ç›®æ ‡è¿›ç¨‹ï¼Œä»¥ç¬”è€…ä¸ºä¾‹å°±æ˜¯ä¸€ä¸ª<code>demo</code>è¿›ç¨‹ï¼Œæ­¤æ—¶è¿œç¨‹çš„<code>arhtas-core</code>å°±ä¼šå¼€å¯è°ƒè¯•æ¨¡å¼ç›‘å¬<code>8888</code>ç«¯å£ç­‰å¾…ideaè¿œç¨‹<code>attach</code>ï¼Œå¯¹åº”æˆ‘ä»¬ideaé€šè¿‡è¿œç¨‹è°ƒè¯•æ¨¡å¼è®¾ç½®8888ç«¯å£ç‚¹å‡»æ‰§è¡Œï¼Œæ­¤æ—¶æˆ‘ä»¬ideaå°±å¯ä»¥å¼€å§‹è°ƒæµ‹äº†è§£arhtas-coreå¦‚ä½•<code>attach</code>ä»£ç†å·¥å…·arthas-agentçš„é€»è¾‘äº†ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1e854f624594f97930be4170430a504~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=sBxvq5SZVe81rCyVWQrCObjFwX8%3D" alt="" loading="lazy"/></p>
<p>äº†è§£æ•´ä½“æ€è·¯ä¹‹åï¼Œæˆ‘ä»¬å°±å¼€å§‹æ­å»ºè°ƒæµ‹ç¯å¢ƒï¼Œé¦–å…ˆæˆ‘ä»¬ç¼–å†™ä¸€ä¸ªdemoç¨‹åºï¼Œå¹¶å°†å…¶é€šè¿‡javacç¼–è¯‘ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title">Demo</span>Â {
Â Â Â Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title">Counter</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â AtomicIntegerÂ countÂ =Â <span class="hljs-keyword">new</span>Â AtomicInteger(<span class="hljs-number">0</span>);
Â Â Â Â Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title">increment</span>()</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â count.incrementAndGet();
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-built_in">int</span>Â <span class="hljs-title">value</span>()</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â count.<span class="hljs-keyword">get</span>();
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title">main</span>(<span class="hljs-params">String[]Â args</span>)Â throwsÂ InterruptedException</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">while</span>Â (<span class="hljs-literal">true</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Counter.increment();
Â Â Â Â Â Â Â Â Â Â Â Â System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"counter:Â "</span>Â +Â Counter.<span class="hljs-keyword">value</span>());
Â Â Â Â Â Â Â Â Â Â Â Â TimeUnit.SECONDS.sleep(<span class="hljs-number">1</span>);
Â Â Â Â Â Â Â Â }
Â Â Â Â }
}
</code></pre>
<p>ç„¶åé€šè¿‡jdk8çš„javaæŒ‡ä»¤å¯åŠ¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/Users/sharkchili/dev-tool/jdk8/Contents/Home/bin/javaÂ Â Demo
</code></pre>
<p>éšåï¼Œæˆ‘ä»¬å†æ‰“å¼€<code>arthas</code>æºç åŒ…<code>bin</code>åœ¨ç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤ï¼Œå¹¶é€‰æ‹©<code>demo</code>è¿›ç¨‹çš„åºå·è¿æ¥ï¼š</p>
<pre><code class="hljs language-css" lang="css">./as<span class="hljs-selector-class">.sh</span>Â <span class="hljs-attr">--use-version</span>Â <span class="hljs-number">3.6</span>.<span class="hljs-number">0</span>Â <span class="hljs-attr">--debug-attach</span>
</code></pre>
<p>æœ€åideaé…ç½®è¿œç¨‹æ¨¡å¼<code>attach</code>åˆ°<code>8888</code>ç«¯å£ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da6db35983b44f4d8f54223f386f55dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=ufBYWw7XBWPLWY7YDxdolII0tvg%3D" alt="" loading="lazy"/></p>
<p>ç”±æ­¤æˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„è°ƒè¯•<code>arthas-core</code>äº†ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0584164fe26943f8ba4b629e09495e46~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=krpJIU8PKKG3dS8J3jtvAKLn0ZQ%3D" alt="" loading="lazy"/></p>
<p>å¯¹åº”è°ƒè¯•æ­¥éª¤ç¬”è€…ä¹Ÿæ˜¯å‚è€ƒè¿™ä¸ªissueï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥çœ‹çœ‹:<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Falibaba%2Farthas%2Fissues%2F222" target="_blank" title="https://github.com/alibaba/arthas/issues/222" ref="nofollow noopener noreferrer">github.com/alibaba/artâ€¦</a></p>
<h4 data-id="heading-14">å·¥ä½œæµç¨‹ä»‹ç»</h4>
<p>arthas-core(ä»¥ä¸‹ç®€ç§°ä¸ºcore)çš„é€»è¾‘æ¯”è¾ƒç®€å•ï¼Œé€šè¿‡ä¸Šæ–‡ä»‹ç»æˆ‘ä»¬çŸ¥é“arthas-bootåœ¨å¯åŠ¨coreçš„æ—¶å€™ç»™å®šäº†ä¸€äº›å‚æ•°ï¼Œå®šä½ç›®æ ‡è™šæ‹Ÿæœºpidå·ï¼Œé€šè¿‡agentå‚æ•°æŒ‡æ˜çš„arthas-agent.jar attachåˆ°è¯¥è™šæ‹Ÿæœºè¿›ç¨‹ä¸‹ã€‚</p>
<p>å¯¹åº”æºä»£ç å…¥å£ä½äºarhtas-coreåŒ…çš„Arthasçš„mainæ–¹æ³•ï¼Œå…¶å†…éƒ¨å°±æ˜¯åˆ›å»ºä¸€ä¸ªarthaså¯¹è±¡ï¼Œæœ¬è´¨å°±æ˜¯æ‰§è¡Œï¼š</p>
<ol>
<li>parseè§£æè·å–æ‰€æœ‰å¯åŠ¨coreçš„å‚æ•°</li>
<li>è°ƒç”¨attachå°†å‚æ•°ç»™å®šè·¯å¾„çš„agent attachåˆ°ç›®æ ‡è™šæ‹Ÿæœºè¿›ç¨‹(ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„demo)</li>
</ol>

<pre><code class="hljs language-typescript" lang="typescript">Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[]Â args</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Arthas</span>(args);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">Throwable</span>Â t)Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â }
Â Â Â Â }

<span class="hljs-keyword">private</span>Â <span class="hljs-title class_">Arthas</span>(<span class="hljs-title class_">String</span>[]Â args)Â throwsÂ <span class="hljs-title class_">Exception</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-title function_">attachAgent</span>(<span class="hljs-title function_">parse</span>(args));
Â Â Â Â }
</code></pre>
<p>æˆ‘ä»¬ç›´æ¥æŸ¥çœ‹<code>attachAgent</code>å¯ä»¥çœ‹åˆ°ç¬”è€…è¯´æ˜çš„3å—æ ¸å¿ƒé€»è¾‘ï¼š</p>
<ol>
<li>é€šè¿‡<code>VirtualMachine.list()</code>å®šä½æ‰€æœ‰javaè¿›ç¨‹ï¼Œéå†åŒ¹é…åˆ°ç›®æ ‡è¿›ç¨‹çš„è™šæ‹Ÿæœºæè¿°ç¬¦</li>
<li>é€šè¿‡<code>attach</code>è¿æ¥åˆ°ç›®æ ‡è™šæ‹Ÿæœºè¿›ç¨‹</li>
<li>åŸºäºé…ç½®å®šä½<code>arhtas-agent</code>æœ¬åœ°è·¯å¾„ï¼Œé€šè¿‡<code>loadAgent</code>å°†<code>arthas-agent</code>åŠ è½½åˆ°ç›®æ ‡è™šæ‹Ÿæœºä¸Š</li>
</ol>
<p>é€»è¾‘æ¯”è¾ƒç®€å•ï¼Œè¯»è€…å¯ä»¥ç»“åˆæ³¨é‡Šç†è§£ç¬”è€…ä¸Šé¢æ‰€è¯´çš„æ­¥éª¤ï¼Œæœ¬è´¨å°±æ˜¯åŸºäºå‚æ•°å°†agent attachåˆ°ç›®æ ‡è™šæ‹Ÿæœºè¿›ç¨‹ï¼Œå¼€å§‹åç»­æœ€æœ€æ ¸å¿ƒçš„å­—èŠ‚ç å¢å¼ºå®ç°å„ç§ç›‘æ§è¯Šæ–­æŒ‡ä»¤ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">privateÂ voidÂ attachAgent(ConfigureÂ configure)Â throwsÂ ExceptionÂ {
Â Â Â Â Â Â Â Â VirtualMachineDescriptorÂ <span class="hljs-attr">virtualMachineDescriptor</span>Â =Â null<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â //å®šä½åˆ°è¢«ä»£ç†çš„è™šæ‹Ÿæœºè¿›ç¨‹å·
Â Â Â Â Â Â Â Â forÂ (VirtualMachineDescriptorÂ descriptorÂ :Â VirtualMachine.list())Â {
Â Â Â Â Â Â Â Â Â Â Â Â StringÂ <span class="hljs-attr">pid</span>Â =Â descriptor.id()<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (pid.equals(Long.toString(configure.getJavaPid())))Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">virtualMachineDescriptor</span>Â =Â descriptor<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â break<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â //å°†
Â Â Â Â Â Â Â Â VirtualMachineÂ <span class="hljs-attr">virtualMachine</span>Â =Â null<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (<span class="hljs-attr">null</span>Â ==Â virtualMachineDescriptor)Â {Â //Â ä½¿ç”¨Â attach(StringÂ pid)Â è¿™ç§æ–¹å¼
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">virtualMachine</span>Â =Â VirtualMachine.attach(<span class="hljs-string">""</span>Â +Â configure.getJavaPid())<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">virtualMachine</span>Â =Â VirtualMachine.attach(virtualMachineDescriptor)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â //......
Â Â Â Â Â //å®šä½agentç»å¯¹è·¯å¾„
Â Â Â Â Â Â Â Â Â Â Â Â StringÂ <span class="hljs-attr">arthasAgentPath</span>Â =Â configure.getArthasAgent()<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â //convertÂ jarÂ pathÂ toÂ unicodeÂ string
Â Â Â Â Â Â Â Â Â Â Â Â configure.setArthasAgent(encodeArg(arthasAgentPath))<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â configure.setArthasCore(encodeArg(configure.getArthasCore()))<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {//åŠ è½½arthas-agent.jar,å¯¹å½“å‰è¿›ç¨‹è¿›è¡Œå¢å¼ºæ“ä½œ
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â virtualMachine.loadAgent(arthasAgentPath,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â configure.getArthasCore()Â +Â "<span class="hljs-comment">;"Â +Â configure.toString());</span>
Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (IOExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //......
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }Â finallyÂ {
Â Â Â Â Â Â Â Â Â Â Â Â //......
Â Â Â Â Â Â Â Â }
Â Â Â Â }
</code></pre>
<h3 data-id="heading-15">arthas agent å¢å¼º(é‡ç‚¹)</h3>
<h4 data-id="heading-16">å®è§‚æµç¨‹ä»‹ç»</h4>
<p>è‡ªæ­¤æˆ‘ä»¬å°±å¯ä»¥æ­£å¼çš„å¼€å§‹åˆ†æarthasæœ€æ ¸å¿ƒçš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œå³åŠ¨æ€å¢å¼ºäº†ï¼Œé€šè¿‡ä¸Šè¿°çš„æ­¥éª¤æˆ‘ä»¬å°†artahs-agent attachåˆ°æŒ‡å®špidçš„è™šæ‹Ÿæœºä¸­ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦é€šè¿‡æºç çš„åˆ†æçš„æ–¹å¼äº†è§£ï¼Œattachåçš„agentåšäº†é‚£äº›äº‹æƒ…ã€‚</p>
<p>å½“arthas-agent attachç›®æ ‡jvmä¹‹åï¼Œå°±éœ€è¦åšåˆ°æ‹¦æˆªæ‰€æœ‰ç±»ç¡®ä¿åœ¨å¿…è¦æ—¶åˆ»èƒ½å¤Ÿåšåˆ°è¿è¡Œæ—¶åŠ¨æ€å¢å¼ºï¼Œè¿™æ—¶å°±éœ€è¦ç”¨åˆ°<code>agentmain</code>æ–¹æ³•ï¼Œå³é€šè¿‡é…ç½®ä¸­æŒ‡å®š<code>Agent-Class</code>ï¼Œç¡®ä¿åŠ è½½åˆ°ç›®æ ‡è™šæ‹Ÿæœºçš„agentå¯ä»¥æ‰§è¡Œå¯¹åº”<code>agentmain</code>æ–¹æ³•ï¼Œæ‰§è¡Œå¿…è¦çš„åˆå§‹åŒ–æµç¨‹(åæ–‡ä¼šå±•å¼€è¯¦è§£)ï¼Œç”Ÿæˆä¸€ä¸ªarthasæœåŠ¡ç«¯ç›‘å¬3658ç«¯å£ï¼Œç­‰å¾…å®¢æˆ·ç«¯è¿æ¥ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/833b9b90adf0478b80f63908c4e5d992~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=9VNHfCH77svsSsxtOUbtX6E%2BUTU%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-17">è°ƒè¯•ç¯å¢ƒæ­å»º</h4>
<p>ä¸ºäº†æ›´å¥½çš„äº†è§£è¿™ä¸ªæµç¨‹ï¼Œç¬”è€…ä¹Ÿä»‹ç»ä¸€ä¸‹å…³äºarthas-agent attachçš„è¯¦ç»†æµç¨‹ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦å¯åŠ¨ä¸Šè¿°çš„demoå¹¶ä»¥ç›‘å¬æ¨¡å¼è¿è¡Œï¼Œå› ä¸ºç¬”è€…ç¯å¢ƒé»˜è®¤jdkä¸ºjdk11ï¼Œæ‰€ä»¥è¿™é‡Œæ‰‹åŠ¨çš„æŒ‡å®šäº†ä¸€ä¸‹jdkç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">Â /Users/sharkchili/dev-tool/jdk8/Contents/Home/bin/javaÂ -XdebugÂ -Xrunjdwp:transport=dt_socket,server=y,address=8000Â Demo
</code></pre>
<p>ç„¶åarhtasæºç é€šè¿‡è¿œç¨‹è¿æ¥çš„æ–¹å¼è¿æ¥8000ç«¯å£ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7ef504c922c94683b054412e83c98856~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=LEc0w4%2FTG9inQhDLQP4hMPKWUec%3D" alt="" loading="lazy"/></p>
<p>æœ€åæˆ‘ä»¬å¯åŠ¨asè„šæœ¬ï¼Œå¹¶é€‰æ‹©demoè¿›ç¨‹ï¼Œæ‰§è¡Œåˆ°arhtas attachç¯èŠ‚æ—¶ï¼Œä»£ç å°±ä¼šæ¥åˆ°arhtas agent åŒ…ä¸‹AgentBootstrapçš„agentMainæ–¹æ³•ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/abbd1eb71dac4e8da04eb7006a1fd2f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=cEyQn0s3MTxq984NPw4G4icNcjo%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-18">attachæµç¨‹è¯´æ˜</h4>
<p>ä»ä¸Šæ–‡çš„è°ƒè¯•æˆªå›¾å¯ä»¥çœ‹åˆ°ï¼Œå…¶å†…éƒ¨æœ¬è´¨å°±æ˜¯æ‹¿ç€<code>Instrumentation</code>å¼•å…¥åŠ¨æ€å¢å¼ºçš„é€»è¾‘ï¼Œæˆ‘ä»¬æ­¥å…¥<code>main</code>æ–¹æ³•å¯ä»¥çœ‹åˆ°ï¼Œå…¶å†…éƒ¨æ ¸å¿ƒé€»è¾‘ä¸ºï¼š</p>
<ol>
<li>æ‹‰å–<code>core</code>è·¯å¾„è·å–å¯¹åº”çš„ç±»åŠ è½½å™¨</li>
<li>è°ƒç”¨coreåŒ…çš„ç±»åŠ è½½ArthasBootstrap.class</li>
<li>åŸºäºArthasBootstrap.classåˆå§‹åŒ–å¯åŠ¨arhtasæœåŠ¡ç«¯ç›‘å¬3658ç«¯å£(é»˜è®¤æƒ…å†µä¸‹)</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a65c8b11a8934fc1b88536049d652f3c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=si9PwP%2BsG6hAoiQz3Nw02t9eA0s%3D" alt="" loading="lazy"/></p>
<p>å¯¹åº”<code>main</code>çš„æºç å¦‚ä¸‹ï¼Œä»–ä¼šä»<code>args</code>ä¸­è·å–agentå’Œcoreçš„è·¯å¾„ç„¶åæ‹‰å–åŠ è½½å™¨å¯åŠ¨ä¸€ä¸ª<code>bindingThread</code>å¯åŠ¨<code>shellServer</code>ä¹Ÿå°±æ˜¯<code>arthas</code>æœåŠ¡ç«¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">privateÂ staticÂ synchronizedÂ voidÂ main(StringÂ args,Â finalÂ InstrumentationÂ inst)Â {
Â Â Â Â Â Â Â Â //Â å°è¯•åˆ¤æ–­arthasæ˜¯å¦å·²åœ¨è¿è¡Œï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œç›´æ¥å°±é€€å‡º
Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â ps.println("ArthasÂ serverÂ agentÂ start...")<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â //Â ä¼ é€’çš„argså‚æ•°åˆ†ä¸¤ä¸ªéƒ¨åˆ†:arthasCoreJarè·¯å¾„å’ŒagentArgs,Â åˆ†åˆ«æ˜¯Agentçš„JARåŒ…è·¯å¾„å’ŒæœŸæœ›ä¼ é€’åˆ°æœåŠ¡ç«¯çš„å‚æ•°
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (<span class="hljs-attr">args</span>Â ==Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">args</span>Â =Â <span class="hljs-string">""</span><span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">args</span>Â =Â decodeArg(args)<span class="hljs-comment">;</span>
Â Â Â Â Â //è·å–coreåŒ…åˆagentåŒ…è·¯å¾„
Â Â Â Â Â Â Â Â Â Â Â Â StringÂ arthasCoreJar<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â finalÂ StringÂ agentArgs<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â intÂ <span class="hljs-attr">index</span>Â =Â args.indexOf(<span class="hljs-string">';'</span>)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (indexÂ !=Â -1)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â //ä»å‚æ•°ä¸­è·å–arhtasÂ coreÂ jarÂ è·¯å¾„
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">arthasCoreJar</span>Â =Â args.substring(<span class="hljs-number">0</span>,Â index)<span class="hljs-comment">;Â </span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //ä»å‚æ•°ä¸­è·å–arthasÂ agentÂ jarè·¯å¾„
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">agentArgs</span>Â =Â args.substring(index)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">arthasCoreJar</span>Â =Â <span class="hljs-string">""</span><span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">agentArgs</span>Â =Â args<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â }


Â Â Â Â Â Â Â Â Â Â Â Â Â */
Â Â Â Â Â Â Â Â Â Â Â Â Â //è·å–coreÂ jarçš„ç±»åŠ è½½å™¨
Â Â Â Â Â Â Â Â Â Â Â Â finalÂ ClassLoaderÂ <span class="hljs-attr">agentLoader</span>Â =Â getClassLoader(inst,Â arthasCoreJarFile)<span class="hljs-comment">;</span>

Â Â Â Â Â Â Â Â Â Â Â Â ThreadÂ <span class="hljs-attr">bindingThread</span>Â =Â newÂ Thread()Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â @Override
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â publicÂ voidÂ run()Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â bind(inst,Â agentLoader,Â agentArgs)<span class="hljs-comment">;//å¯åŠ¨arthasæœåŠ¡ç«¯</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ThrowableÂ throwable)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â throwable.printStackTrace(ps)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â }<span class="hljs-comment">;</span>

Â Â Â Â Â Â Â Â Â Â Â Â bindingThread.setName("arthas-binding-thread")<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â bindingThread.start()<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â bindingThread.join()<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â }Â catchÂ (ThrowableÂ t)Â {
Â Â Â Â Â Â Â Â Â Â //......
Â Â Â Â Â Â Â Â }
Â Â Â Â }
</code></pre>
<p>æ­¤æ—¶é€»è¾‘å°±åˆ°äº†<code>getInstance</code>çš„<code>getInstance</code>å•ä¾‹å®ç°ï¼Œå…¶å†…éƒ¨ä¼šè§£æå‚æ•°å®Œæˆå®Œæˆå¦‚ä¸‹å·¥ä½œï¼š</p>
<ol>
<li><code>initFastjson</code>ï¼šåˆå§‹åŒ–<code>json</code>å·¥å…·è§„åˆ™é…ç½®</li>
<li>initSpy(é‡ç‚¹)ï¼šå°†<code>SpyAPI</code>æ·»åŠ åˆ°å½“å‰<code>bootstrap</code>ç±»åŠ è½½å™¨ä¸­</li>
<li><code>initArthasEnvironment</code>ï¼šåˆå§‹åŒ–arthasç¯å¢ƒå˜é‡</li>
<li>åˆ›å»ºarthasæ—¥å¿—è¾“å‡ºæ–‡ä»¶å¤¹arthas-output</li>
<li><code>LogUtil</code>åˆå§‹åŒ–æ—¥å¿—å·¥å…·</li>
<li>å¢å¼º<code>ClassLoader</code>ï¼šè§£å†³è§£å†³ä¸€äº› ClassLoader åŠ è½½ä¸åˆ° SpyAPIçš„é—®é¢˜æ‰€ä»¥æ‰è¦å¢å¼º<code>ClassLoader</code></li>
<li>init beansï¼šåˆå§‹åŒ–ä¸€äº›è§†å›¾çª—å£æ¶ˆæ¯è¾“å…¥è¾“å‡ºè§£æå™¨å’Œ<code>history</code>æŒ‡ä»¤ç®¡ç†å™¨</li>
<li>bindï¼šé‡ç‚¹å¯åŠ¨arthas server</li>
<li>åˆå§‹åŒ–<code>executorService</code>çº¿ç¨‹æ± æ‰§è¡Œåç›‘å¬å¹¶å¤„ç†åç»­ç”¨æˆ·çš„ç›‘æ§è¯Šæ–­æŒ‡ä»¤çš„å¼‚æ­¥ä»»åŠ¡</li>
<li>åˆ›å»ºä¸€ä¸ªshutdownçº¿ç¨‹æ³¨å†Œè™šæ‹Ÿæœºé’©å­ç›‘å¬å…³é—­äº‹ä»¶ä»¥ä¾¿åŠæ—¶å…³é—­ArthasBootstrap</li>
</ol>

<pre><code class="hljs language-scss" lang="scss">privateÂ <span class="hljs-built_in">ArthasBootstrap</span>(InstrumentationÂ instrumentation,Â Map&lt;String,Â String&gt;Â args)Â throwsÂ ThrowableÂ {
Â Â Â Â Â Â Â Â this<span class="hljs-selector-class">.instrumentation</span>Â =Â instrumentation;
Â Â Â Â <span class="hljs-comment">//åˆå§‹åŒ–jsonå·¥å…·è§„åˆ™é…ç½®</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">initFastjson</span>();

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 2.Â å°†SpyAPIæ·»åŠ åˆ°å½“å‰bootstrapç±»åŠ è½½å™¨ä¸­</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">initSpy</span>();
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 3.Â åˆå§‹åŒ–arthasç¯å¢ƒå˜é‡</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">initArthasEnvironment</span>(args);
Â Â Â <span class="hljs-comment">//4.Â åˆ›å»ºarthasæ—¥å¿—è¾“å‡ºç›®å½•</span>
Â Â Â Â Â Â Â Â StringÂ outputPathStrÂ =Â configure<span class="hljs-selector-class">.getOutputPath</span>();
Â Â Â Â Â Â Â Â ifÂ (outputPathStrÂ ==Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â outputPathStrÂ =Â ArthasConstants<span class="hljs-selector-class">.ARTHAS_OUTPUT</span>;
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â outputPathÂ =Â newÂ <span class="hljs-built_in">File</span>(outputPathStr);
Â Â Â Â Â Â Â Â outputPath<span class="hljs-selector-class">.mkdirs</span>();

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 5.Â åˆå§‹åŒ–æ—¥å¿—å·¥å…·</span>
Â Â Â Â Â Â Â Â loggerContextÂ =Â LogUtil<span class="hljs-selector-class">.initLogger</span>(arthasEnvironment);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 4.Â å¢å¼ºClassLoader</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">enhanceClassLoader</span>();
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 5.Â åˆå§‹åŒ–ä¸€äº›è§†å›¾è§£æå™¨å’Œhistoryç®¡ç†bean</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">initBeans</span>();

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 6.Â å¯åŠ¨agentÂ server</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">bind</span>(configure);
Â Â Â Â <span class="hljs-comment">//åˆå§‹åŒ–å‘½ä»¤è§£æçš„çº¿ç¨‹æ± </span>
Â Â Â Â Â Â Â Â executorServiceÂ =Â Executors<span class="hljs-selector-class">.newScheduledThreadPool</span>(<span class="hljs-number">1</span>,Â newÂ ThreadFactory()Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">@Override</span>
Â Â Â Â Â Â Â Â Â Â Â Â publicÂ ThreadÂ newThread(RunnableÂ r)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â finalÂ ThreadÂ tÂ =Â newÂ <span class="hljs-built_in">Thread</span>(r,Â "arthas-command-execute");
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â t<span class="hljs-selector-class">.setDaemon</span>(true);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ t;
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â });
Â Â Â <span class="hljs-comment">//æ³¨å†Œè™šæ‹Ÿæœºé’©å­</span>
Â Â Â Â Â Â Â Â shutdownÂ =Â newÂ <span class="hljs-built_in">Thread</span>("as-shutdown-hooker")Â {

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">@Override</span>
Â Â Â Â Â Â Â Â Â Â Â Â publicÂ voidÂ run()Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ArthasBootstrap<span class="hljs-selector-class">.this</span><span class="hljs-selector-class">.destroy</span>();
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â };

Â Â Â Â Â Â Â Â transformerManagerÂ =Â newÂ <span class="hljs-built_in">TransformerManager</span>(instrumentation);
Â Â Â Â Â Â Â Â Runtime<span class="hljs-selector-class">.getRuntime</span>()<span class="hljs-selector-class">.addShutdownHook</span>(shutdown);
Â Â Â Â }
</code></pre>
<h2 data-id="heading-19">è¯¦è§£ArthasBootstrapå¯åŠ¨æ ¸å¿ƒæµç¨‹</h2>
<h3 data-id="heading-20">è¯¦è§£spyåˆå§‹åŒ–(é‡ç‚¹)</h3>
<p>ä¸Šæ–‡å®è§‚è¯´æ˜äº†<code>ArthasBootstrap</code>æ•´ä½“æµç¨‹ï¼Œå› ä¸ºæ•´ä½“æµç¨‹å®ç°ç»†èŠ‚è¾ƒå¤šï¼Œæ‰€ä»¥ç¬”è€…æ‰“ç®—æŠ½å–ä¸€ä¸ªç¯‡å¹…é€æ­¥æ‹†è§£è¿™å—æµç¨‹ï¼Œå…ˆæ¥è¯´è¯´<code>initSpy</code>ï¼Œè¯¥æµç¨‹æœ¬è´¨å°±æ˜¯é€šè¿‡æ ¹åŠ è½½å™¨å°†æœå¯»<code>SpyAPI</code>è¿™ä¸ª<code>class</code>æ˜¯å¦å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨åˆ™å®šä½åˆ°å¯¹åº”çš„jaråŒ…ç‰©ç†åœ°å€å°†å…¶æ·»åŠ åˆ°å½“å‰è™šæ‹Ÿæœº(ä¾‹å¦‚æˆ‘ä»¬éœ€è¦å¢å¼ºçš„Demo)ç¨‹åºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a122fe28f37447b89d3a4958ac4838bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=k8zaxgQDnrM1KQ0Dk1OEIyVRyJA%3D" alt="" loading="lazy"/></p>
<p>è¿™é‡Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>ä¸ºä»€ä¹ˆéœ€è¦åŠ è½½<code>SpyAPI</code></li>
<li>ä¸ºä»€ä¹ˆéœ€è¦é€šè¿‡æ ¹åŠ è½½å™¨è¿›è¡ŒåŠ è½½</li>
</ol>
<h4 data-id="heading-21">ä¸ºä»€ä¹ˆéœ€è¦åŠ è½½SpyAPI</h4>
<p>æˆ‘ä»¬æŸ¥çœ‹SpyAPIæ˜¯arthaså¢å¼ºçš„æ ¸å¿ƒæŠ½è±¡ç±»ï¼Œå®ƒæ˜¯å¢å¼ºæ“ä½œé€»è¾‘çš„å…·ä½“å®ç°è€…ï¼Œarhtasåœ¨è¿›è¡Œå¢å¼ºæ—¶æœ¬è´¨å°±æ˜¯é€šè¿‡SpyAPIçš„è°ƒç”¨å®ç°çš„ï¼ŒSpyAPIå†…ç½®äº†ä¸€ä¸ªspyInstanceï¼Œå½“æˆ‘ä»¬é’ˆå¯¹ç‰¹å®šå®ç°ç±»é€šè¿‡stackæˆ–è€…traceæŒ‡ä»¤é’ˆå¯¹ç±»è¿›è¡ŒåŠ¨æ€å¢å¼ºè§‚å¯Ÿå…¶å †æ ˆæˆ–è€…è€—æ—¶æ—¶ï¼Œæœ¬è´¨å°±æ˜¯é€šè¿‡SpyAPIå¯¹åº”atEnterçš„æ–¹æ³•å®šä½åˆ°æ¯ä¸ªæŒ‡ä»¤çš„ç›‘å¬å™¨æ‰§è¡Œå‡½æ•°å¢å¼ºã€‚</p>
<p>ä¾‹å¦‚æˆ‘ä»¬é’ˆå¯¹Demoç±»incrementæ‰§è¡ŒwatchæŒ‡ä»¤ï¼Œarhtasçš„å¢å¼ºæ“ä½œå°±æ˜¯é€šè¿‡å¢å¼ºå™¨åœ¨æ–¹æ³•å‰åæ’å…¥SpyAPIçš„è°ƒç”¨ï¼Œæ¯å½“ç¨‹åºæ‰§è¡Œincrementæ“ä½œæ—¶å°±ä¼šè°ƒç”¨SpyAPIçš„atEnterã€atExitç­‰æ–¹æ³•ï¼Œè€Œè¿™äº›æ–¹æ³•å°±ä¼šæœå¯»åˆ°watchæŒ‡ä»¤çš„ç›‘å¬å™¨å¹¶æ‰§è¡Œå¯¹åº”é€»è¾‘ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d543cbdd7b174077ae46cca926e65d84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=Gdc1yIGqRhj0LvYfDcdEjwsLCLw%3D" alt="" loading="lazy"/></p>
<p>å¯¹åº”æˆ‘ä»¬è¿™é‡Œä¹Ÿå…ˆç»™å‡º<code>SpyAPI</code>çš„æºä»£ç ï¼Œå¯ä»¥çœ‹åˆ°å…¶å†…éƒ¨æš´éœ²äº†<code>setSpy</code>åŠå…¶atEnterç­‰å¢å¼ºå‡½æ•°ï¼Œå…¶å†…éƒ¨æœ¬è´¨éƒ½æ˜¯è°ƒç”¨<code>spyInstance</code>é€šè¿‡<code>atEnter</code>è·å–å¯¹åº”æŒ‡ä»¤çš„ç›‘å¬å™¨æ‰§è¡Œå‰ç½®æˆ–è€…åç½®çš„å¢å¼ºé€»è¾‘ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">SpyAPI</span>Â {
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">final</span>Â <span class="hljs-type">AbstractSpy</span>Â <span class="hljs-variable">NOPSPY</span>Â <span class="hljs-operator">=</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">NopSpy</span>();
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">volatile</span>Â <span class="hljs-type">AbstractSpy</span>Â <span class="hljs-variable">spyInstance</span>Â <span class="hljs-operator">=</span>Â NOPSPY;

Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">volatile</span>Â <span class="hljs-type">boolean</span>Â INITED;

Â Â Â Â <span class="hljs-comment">//......</span>
Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">setSpy</span><span class="hljs-params">(AbstractSpyÂ spy)</span>Â {
Â Â Â Â Â Â Â Â spyInstanceÂ =Â spy;
Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">atEnter</span><span class="hljs-params">(Class&lt;?&gt;Â clazz,Â StringÂ methodInfo,Â ObjectÂ target,Â Object[]Â args)</span>Â {
Â Â Â Â Â Â Â Â spyInstance.atEnter(clazz,Â methodInfo,Â target,Â args);
Â Â Â Â }
}
</code></pre>
<h4 data-id="heading-22">ä¸ºä»€ä¹ˆéœ€è¦é€šè¿‡æ ¹åŠ è½½å™¨è¿›è¡ŒåŠ è½½</h4>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œjavaç±»åŠ è½½å™¨åˆ†ä¸ºå¦‚ä¸‹å‡ ç§ï¼š</p>
<ol>
<li>bootstrapç±»åŠ è½½å™¨ï¼šç”±c++å®ç°ï¼Œæ˜¯è™šæ‹Ÿæœºè‡ªèº«çš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦è´Ÿè´£åŠ è½½libç›®å½•ä¸‹å­˜æ”¾çš„ç±»</li>
<li>extensionç±»åŠ è½½å™¨ï¼š ä¸»è¦åŠ è½½libç›®å½•ä¸‹extç›®å½•ä¸­çš„ç±»</li>
<li>application åº”ç”¨åŠ è½½å™¨ï¼Œä¸»è¦åŠ è½½ç”¨æˆ·ç±»è·¯å¾„ä¸‹æ‰€æœ‰çš„ç±»åº“</li>
</ol>
<p>æŒ‰ç…§JVMåŒäº²å§”æ´¾æ¨¡å‹çš„è¯´æ³•ï¼Œå½“è¿›è¡Œç±»åŠ è½½æ—¶ï¼Œæ‰€æœ‰ç±»éƒ½ä¼šä¼˜å…ˆå°†è¯·æ±‚å§”æ‰˜ç»™çˆ¶ç±»ï¼Œæ˜ç¡®çˆ¶ç±»æœå¯»èŒƒå›´æ‰¾ä¸åˆ°å¯¹åº”ç±»è€Œæ— æ³•å®ŒæˆåŠ è½½åï¼Œæ‰ä¼šè‡ªå·±å°è¯•åŠ è½½ï¼Œç”±æ­¤ä¿è¯rt.jarç­‰åŸºç¡€æ ¸å¿ƒjaråŒ…ç±»åŠ è½½å®‰å…¨ï¼ŒåŒç†ï¼Œä¸ºäº†é¿å…åŠ è½½spyè¿™ä¸ªæ ¸å¿ƒå¢å¼ºçš„æ¥å£è¢«ç ´åï¼Œarthaså°±ä¼šå¼ºåˆ¶æŒ‡æ˜ç”¨æ ¹åŠ è½½å™¨å®ŒæˆåŠ è½½ï¼Œç¡®ä¿æ‰€æœ‰ç±»éƒ½èƒ½å¤Ÿå‡†ç¡®çš„åŠ è½½åˆ°è¿™ä¸ªç±»ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Â //Â å°†Spyæ·»åŠ åˆ°BootstrapClassLoader
Â Â Â Â Â Â Â Â ClassLoaderÂ <span class="hljs-attr">parent</span>Â =Â ClassLoader.getSystemClassLoader().getParent()<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Class&lt;?&gt;Â <span class="hljs-attr">spyClass</span>Â =Â null<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â ifÂ (parentÂ !=Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">spyClass</span>Â =parent.loadClass(<span class="hljs-string">"java.arthas.SpyAPI"</span>)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ThrowableÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ignore
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
</code></pre>
<h3 data-id="heading-23">å¯åŠ¨arthas server</h3>
<p>æˆ‘ä»¬é‡ç‚¹è¿˜æ˜¯å…³æ³¨ä¸€ä¸‹å¯åŠ¨<code>arthas server</code>è¿™ä¸€æ­¥ï¼Œè¯¥æ­¥éª¤ç”±bindæ–¹æ³•è´Ÿè´£ï¼Œå·¥ä½œçº¿ç¨‹åœ¨casæˆåŠŸåä¸Šé”åï¼Œé¡ºåºæ‰§è¡Œå¦‚ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>ä¼šé€šè¿‡è¯»å–å¯åŠ¨å‚æ•°ç¡®è®¤å¯åŠ¨æ–¹å¼(é»˜è®¤æ˜¯telnet serverå¯¹åº”3658ç«¯å£)çš„é…ç½®åˆ›å»º<code>shellServer</code></li>
<li>åˆå§‹åŒ–åˆ›å»ºå‘½ä»¤é›†åˆå¯¹è±¡<code>BuiltinCommandPack</code>ï¼Œå…¶å†…éƒ¨åŒ…å«ä¾‹å¦‚jadå³JadCommandã€stackå³StackCommandè¿™äº›å‘½ä»¤çš„æŠ½è±¡å®ç°ç±»</li>
<li>åŸºäºnettyåˆ›å»ºworkerGroupä½œä¸ºæœåŠ¡ç«¯çš„è¿æ¥å¤„ç†å·¥ä½œçº¿ç¨‹ç»„</li>
<li>åˆå§‹åŒ–serverå¯¹è±¡å¹¶æ·»åŠ åˆ°<code>termServers</code>å®¹å™¨ä¸­</li>
<li>å˜é‡<code>termServers</code>è°ƒç”¨listenå¼€å¯æœåŠ¡ç«¯ç›‘å¬</li>
</ol>
<p>å¯¹åº”å®Œæˆåçš„æœåŠ¡ç«¯æ¶æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°shellServerç”¨termServersç»´æŠ¤ä¸åŒçš„ç½‘ç»œæœåŠ¡ç«¯ï¼ŒåŒæ—¶ç”¨sessionsç»´æŠ¤ç”¨æˆ·ä¼šè¯ï¼Œè€Œå¸¸è§çš„å‘½ä»¤æŠ½è±¡ä¹Ÿéƒ½ä»¥ç±»ä¼¼äºBuiltinCommandPackè¿™æ ·çš„å°è£…é›†åˆå®¹å™¨ç»´æŠ¤åˆ°resolverså®¹å™¨ä¸­ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5fdf8f761aa642489d465b93aa9d4a7b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=bj64L2Whn7%2BOKyhjlO8BM7ZZQr0%3D" alt="" loading="lazy"/></p>
<p>å¯¹åº”æˆ‘ä»¬ä¹Ÿç»™å‡º<code>bind</code>å¯¹åº”å®ç°ï¼Œæ­£å¦‚ç¬”è€…æ‰€è¯´åœ¨<code>cas</code>ä¿®æ”¹çŠ¶æ€ä¿è¯çº¿ç¨‹äº’æ–¥åï¼Œåˆå§‹åŒ–<code>shellServer</code>å®Œæˆï¼š</p>
<ol>
<li>æœåŠ¡ç«¯åˆå§‹åŒ–</li>
<li>å‘½ä»¤åˆå§‹åŒ–</li>
<li>å¯åŠ¨æœåŠ¡ç«¯ç›‘å¬</li>
</ol>

<pre><code class="hljs language-scss" lang="scss">privateÂ voidÂ <span class="hljs-built_in">bind</span>(ConfigureÂ configure)Â throwsÂ ThrowableÂ {

Â Â Â Â Â Â Â Â longÂ startÂ =Â System<span class="hljs-selector-class">.currentTimeMillis</span>();

Â Â Â Â Â Â Â Â ifÂ (!isBindRef.compareAndSet(false,Â true))Â {<span class="hljs-comment">//casÂ æ”¹å˜çŠ¶æ€</span>
Â Â Â Â Â Â Â Â Â Â Â Â throwÂ newÂ <span class="hljs-built_in">IllegalStateException</span>("alreadyÂ bind");
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>

Â Â Â Â Â Â Â Â tryÂ {Â <span class="hljs-comment">//åˆå§‹åŒ–shellÂ serverÂ æ¬¢è¿è¾“å‡ºç­‰ä¿¡æ¯</span>
Â Â Â Â Â Â Â Â Â Â Â Â ShellServerOptionsÂ optionsÂ =Â newÂ <span class="hljs-built_in">ShellServerOptions</span>()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.setInstrumentation</span>(instrumentation)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.setPid</span>(PidUtils.currentLongPid())Â <span class="hljs-comment">//atacchÂ çš„pid</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.setWelcomeMessage</span>(ArthasBanner.welcome());
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (configure.getSessionTimeout()Â !=Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â options<span class="hljs-selector-class">.setSessionTimeout</span>(configure.getSessionTimeout()Â *Â <span class="hljs-number">1000</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â Â Â Â Â shellServerÂ =Â newÂ <span class="hljs-built_in">ShellServerImpl</span>(options);

Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//åˆå§‹åŒ–BuiltinCommandPackå†…éƒ¨åŒ…å«jadã€monitorç­‰æ‰§è¡Œçš„æŠ½è±¡</span>
Â Â Â Â Â Â Â Â Â Â Â Â BuiltinCommandPackÂ builtinCommandsÂ =Â newÂ <span class="hljs-built_in">BuiltinCommandPack</span>(disabledCommands);<span class="hljs-comment">//ç»‘å®šå‘½ä»¤</span>
Â Â Â Â Â Â Â Â Â Â Â Â List&lt;CommandResolver&gt;Â resolversÂ =Â newÂ ArrayList&lt;CommandResolver&gt;();
Â Â Â Â Â Â Â Â Â Â Â Â resolvers<span class="hljs-selector-class">.add</span>(builtinCommands);

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//workerÂ group</span>
Â Â Â Â Â Â Â Â Â Â Â Â workerGroupÂ =Â newÂ <span class="hljs-built_in">NioEventLoopGroup</span>(newÂ DefaultThreadFactory("arthas-TermServer",Â true));

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åŸºäºé…ç½®åˆ›å»ºå¹¶æ³¨å†ŒHttpTelnetTermServerã€HttpTermServerç­‰æœåŠ¡ç«¯</span>
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (configure.getTelnetPort()Â !=Â nullÂ &amp;&amp;Â configure<span class="hljs-selector-class">.getTelnetPort</span>()Â &gt;Â <span class="hljs-number">0</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">logger</span>()<span class="hljs-selector-class">.info</span>("tryÂ toÂ bindÂ telnetÂ server,Â host:Â {},Â port:Â {}.",Â configure.getIp(),Â configure<span class="hljs-selector-class">.getTelnetPort</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â shellServer<span class="hljs-selector-class">.registerTermServer</span>(newÂ HttpTelnetTermServer(configure.getIp(),Â configure<span class="hljs-selector-class">.getTelnetPort</span>(),
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â options<span class="hljs-selector-class">.getConnectionTimeout</span>(),Â workerGroup,Â httpSessionManager));
Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">logger</span>()<span class="hljs-selector-class">.info</span>("telnetÂ portÂ isÂ {},Â skipÂ bindÂ telnetÂ server.",Â configure.getTelnetPort());
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (configure.getHttpPort()Â !=Â nullÂ &amp;&amp;Â configure<span class="hljs-selector-class">.getHttpPort</span>()Â &gt;Â <span class="hljs-number">0</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">logger</span>()<span class="hljs-selector-class">.info</span>("tryÂ toÂ bindÂ httpÂ server,Â host:Â {},Â port:Â {}.",Â configure.getIp(),Â configure<span class="hljs-selector-class">.getHttpPort</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â shellServer<span class="hljs-selector-class">.registerTermServer</span>(newÂ HttpTermServer(configure.getIp(),Â configure<span class="hljs-selector-class">.getHttpPort</span>(),
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â options<span class="hljs-selector-class">.getConnectionTimeout</span>(),Â workerGroup,Â httpSessionManager));
Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â listenÂ localÂ addressÂ inÂ VMÂ communication</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (configure.getTunnelServer()Â !=Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â shellServer<span class="hljs-selector-class">.registerTermServer</span>(newÂ HttpTermServer(configure.getIp(),Â configure<span class="hljs-selector-class">.getHttpPort</span>(),
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â options<span class="hljs-selector-class">.getConnectionTimeout</span>(),Â workerGroup,Â httpSessionManager));
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">logger</span>()<span class="hljs-selector-class">.info</span>("httpÂ portÂ isÂ {},Â skipÂ bindÂ httpÂ server.",Â configure.getHttpPort());
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â <span class="hljs-comment">//éå†resolversé›†åˆä¸­çš„å‘½ä»¤åŒ…å°†å…¶æ·»åŠ åˆ°shellServerçš„å‘½ä»¤ç®¡ç†å®¹å™¨ä¸­</span>
Â Â Â Â Â Â Â Â Â Â Â Â forÂ (CommandResolverÂ resolverÂ :Â resolvers)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â shellServer<span class="hljs-selector-class">.registerCommandResolver</span>(resolver);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â <span class="hljs-comment">//å†…éƒ¨éå†åˆšåˆšæ³¨å†Œçš„æœåŠ¡ç«¯å¹¶å¯åŠ¨ç›‘å¬</span>
Â Â Â Â Â Â Â Â Â Â Â Â shellServer<span class="hljs-selector-class">.listen</span>(newÂ BindHandler(isBindRef));<span class="hljs-comment">//ç›‘å¬</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â }Â catchÂ (ThrowableÂ e)Â {
Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>

Â Â Â Â Â Â Â Â }
Â Â Â Â }
</code></pre>
<p>ç¬”è€…è¿™é‡Œä¹Ÿç»™å‡ºå¯¹åº”ç›‘å¬çš„å®ç°ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯éå†å„ä¸ª<code>server</code>å¹¶é…ç½®æ¶ˆæ¯å¤„ç†å™¨<code>TermServerTermHandler</code>æ‰§è¡Œ<code>listen</code>ç›‘å¬å¹¶é€šè¿‡<code>TermServerTermHandler</code>å¤„ç†è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Override</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â ShellServerÂ listen(<span class="hljs-keyword">final</span>Â Handler&lt;Future&lt;<span class="hljs-built_in">Void</span>&gt;&gt;Â listenHandler)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">final</span>Â List&lt;TermServer&gt;Â toStart;
Â Â Â Â Â Â Â Â synchronizedÂ (<span class="hljs-keyword">this</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â Â Â Â Â toStartÂ =Â termServers;
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (TermServerÂ termServerÂ :Â toStart)Â {<span class="hljs-comment">//éå†å¯åŠ¨åˆ›å»ºçš„å¯¹åº”ç½‘ç»œé€šä¿¡æ–¹å¼çš„server</span>
Â Â Â Â Â Â Â Â Â Â Â Â termServer.termHandler(newÂ TermServerTermHandler(<span class="hljs-keyword">this</span>));<span class="hljs-comment">//æœåŠ¡å™¨serverç»‘å®šÂ terminalÂ handler</span>
Â Â Â Â Â Â Â Â Â Â Â Â termServer.listen(handler);Â <span class="hljs-comment">//ç›‘å¬ç½‘ç»œè¯·æ±‚ï¼Œæ”¶åˆ°çš„è¯·æ±‚å°±ä¼šäº¤ç”±TermServerTermHandlerä¹Ÿå°±æ˜¯ä¸Šä¸€æ­¥åˆå§‹åŒ–çš„å¤„ç†å™¨å¤„ç†è¯·æ±‚</span>
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">this</span>;
Â Â Â Â }
</code></pre>
<h3 data-id="heading-24">å®¢æˆ·ç«¯å»ºç«‹è¿æ¥</h3>
<p>æ˜ç¡®ä¸Šè¿°æœåŠ¡ç«¯å»ºç«‹ä¹‹åï¼Œ<code>arthas</code>ä¼šä¸ºæˆ‘ä»¬åˆ†é…ä¸€ä¸ªå®¢æˆ·ç«¯ä¸å…¶å»ºç«‹è¿æ¥ï¼Œåˆ†åˆ«æ‰§è¡Œï¼š</p>
<ol>
<li>åˆ›å»ºä¼šè¯<code>session</code></li>
<li>ç»ˆç«¯è¾“å‡ºæ¬¢è¿ä¿¡æ¯</li>
<li>å°†ä¼šè¯ä¿å­˜åˆ°æœåŠ¡ç«¯ç¼“å­˜<code>sessions</code>ä¸­</li>
<li>ç›‘å¬å®¢æˆ·ç«¯è¾“å…¥ï¼Œå¹¶é€šè¿‡<code>ShellLineHandler</code>å¤„ç†è¯·æ±‚</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa11e2cb14dc4280a5b5b33f1a377425~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=G%2FovSYcjKUSXpGVqkZYRo%2BK31Jk%3D" alt="" loading="lazy"/></p>
<p>å¯¹åº”ç¬”è€…ç»™å‡º<code>HttpTelnetTermServer</code>å¤„ç†å®¢æˆ·ç«¯è¿æ¥å¤„ç†çš„å…¥å£ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Override</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">TermServer</span>Â <span class="hljs-title function_">listen</span>(<span class="hljs-params">Handler&lt;Future&lt;TermServer&gt;&gt;Â listenHandler</span>)Â {
Â Â Â Â Â Â Â <span class="hljs-comment">//åˆå§‹åŒ–bootstrap</span>
Â Â Â Â Â Â Â Â bootstrapÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">NettyHttpTelnetTtyBootstrap</span>(workerGroup,Â httpSessionManager).<span class="hljs-title function_">setHost</span>(hostIp).<span class="hljs-title function_">setPort</span>(port);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â bootstrap.<span class="hljs-title function_">start</span>(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Consumer</span>&lt;<span class="hljs-title class_">TtyConnection</span>&gt;()Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-meta">@Override</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">accept</span>(<span class="hljs-params">finalÂ TtyConnectionÂ conn</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//ç›‘å¬TermServerTermHandleræ”¶åˆ°çš„è¯·æ±‚å¹¶è°ƒç”¨handleæ–¹æ³•å¤„ç†</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â termHandler.<span class="hljs-title function_">handle</span>(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">TermImpl</span>(<span class="hljs-title class_">Helper</span>.<span class="hljs-title function_">loadKeymap</span>(),Â conn));
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â }).<span class="hljs-title function_">get</span>(connectionTimeout,Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MILLISECONDS</span>);
Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">Throwable</span>Â t)Â {
Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-variable language_">this</span>;
Â Â Â Â }
</code></pre>
<p><code>TermServerTermHandler</code>æœ€ç»ˆä¼šæ‰§è¡Œåˆ°<code>ShellServerImpl</code>çš„<code>handleTerm</code>å®Œæˆä¸Šæ–‡æ‰€è¯´çš„<code>session</code>åˆå§‹åŒ–å’Œ<code>readline</code>ç›‘å¬å‘½ä»¤è¯·æ±‚çš„æ ¸å¿ƒé€»è¾‘ï¼Œé€»è¾‘æ¯”è¾ƒç›´è§‚ï¼Œè¯»è€…å¯ä»¥ç»“åˆæ³¨é‡Šäº†è§£ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">publicÂ voidÂ <span class="hljs-built_in">handleTerm</span>(TermÂ term)Â {
Â Â Â Â Â Â Â Â synchronizedÂ (this)Â {<span class="hljs-comment">//ä¿è¯åœæ­¢åå¯ä»¥åŠæ—¶åœæ­¢è¿æ¥</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ThatÂ mightÂ happenÂ withÂ multipleÂ ser</span>
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (closed)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â term<span class="hljs-selector-class">.close</span>();
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â return;
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â <span class="hljs-comment">//Â åˆ›å»ºæœ¬åœ°ä¼šè¯sessionï¼Œä¸ºå…¶åˆ†é…å‘½ä»¤åˆ—è¡¨ã€instrumentation(å¼•å…¥spyçš„ä»£ç æ’æ¡©å®ä¾‹)</span>
Â Â Â Â Â Â Â Â ShellImplÂ sessionÂ =Â <span class="hljs-built_in">createShell</span>(term);
Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//ç»ˆç«¯è¾“å‡ºæ¬¢è¿ä¿¡æ¯</span>
Â Â Â Â Â Â Â Â session<span class="hljs-selector-class">.init</span>();
Â Â Â Â Â Â Â Â <span class="hljs-comment">//ç¼“å­˜sessionä¿¡æ¯</span>
Â Â Â Â Â Â Â Â sessions<span class="hljs-selector-class">.put</span>(session.id,Â session);Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//ç›‘å¬ç”¨æˆ·çš„è¾“å…¥å‘½ä»¤</span>
Â Â Â Â Â Â Â Â session<span class="hljs-selector-class">.readline</span>();Â 
Â Â Â Â }
</code></pre>
<h3 data-id="heading-25">åŸºäºstackäº†è§£arthasè®¾è®¡ç†å¿µä¸å·¥ä½œæœºåˆ¶</h3>
<p>åœ¨å»ºç«‹æœåŠ¡ç«¯ä¹‹åï¼Œå¯¹åº”ä¼šè¯session.readline();ç›‘å¬å®¢æˆ·ç«¯è¯·æ±‚ï¼Œä¾‹å¦‚ç¬”è€…å¸Œæœ›é€šè¿‡stackæŒ‡ä»¤äº†è§£incrementæ–¹æ³•çš„æ‰§è¡Œå †æ ˆä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">stackÂ Demo$CounterÂ incrementÂ Â -nÂ <span class="hljs-number">5</span>Â 
</code></pre>
<p>å…¶å®<code>session</code>æ”¶åˆ°è¯·æ±‚åä¼šé€šè¿‡<code>ShellLineHandler</code>å¤„ç†è¯¥è¯·æ±‚ï¼Œå¯¹åº”<code>ShellLineHandler</code>å†…éƒ¨æ‰§è¡Œæ ¸å¿ƒé€»è¾‘ä¸ºï¼š</p>
<ol>
<li>è§£ææŒ‡ä»¤<code>token</code>è·å–æŒ‡ä»¤å­—ç¬¦ä¸²ï¼Œå¯¹åº”æœ¬æ¬¡ç¤ºä¾‹å°±æ˜¯<code>stack</code>å­—ç¬¦ä¸²</li>
<li>åŸºäºæŒ‡ä»¤å­—ç¬¦ä¸²stackè·å–å¯¹åº”<code>command</code>å¯¹åº”æœ¬ä¾‹å°±æ˜¯<code>StackCommand</code>å¹¶å°è£…æˆ<code>ProcessImpl</code></li>
<li>åŸºäºä¸Šè¿°<code>ProcessImpl</code>å¤„ç†å™¨ã€<code>session</code>ä¼šè¯ç­‰ä¿¡æ¯æ„æˆ<code>JobImpl</code></li>
<li><code>JobImpl</code>æ‰§è¡Œ<code>run</code>æ–¹æ³•å°†ä¸Šæ–‡çš„<code>ProcessImpl</code>(åŒ…å«å‘½ä»¤ä»¥åŠå‘½ä»¤ä¸Šä¸‹æ–‡ä¿¡æ¯)å°è£…æˆ<code>CommandProcessTask</code>æäº¤åˆ°ä¸Šæ–‡åˆå§‹åŒ–å¥½çš„çº¿ç¨‹æ± <code>executorService</code>ä¸­</li>
<li>é‡ç‚¹æ¥äº†ï¼Œå¼‚æ­¥ä»»åŠ¡è¿è¡Œå<code>StackCommand</code>å¯¹åº”æŠ½è±¡çˆ¶ç±»<code>EnhancerCommand</code>å¯¹åº”<code>enhance</code>é€»è¾‘ä¼šé’ˆå¯¹å‘½ä»¤å¯¹åº”çš„ç±»æ‰§è¡Œæ’æ¡©æ“ä½œï¼Œå³é€šè¿‡ä¸Šæ–‡è¯´æ˜çš„<code>ByteKit</code>è¿™ä¸ªå·¥å…·å°è£…çš„è€Œæˆçš„<code>InterceptorProcessor</code>é’ˆå¯¹ç›®æ ‡ç±»åŒ¹é…æ–¹æ³•è¿›è¡Œå­—èŠ‚ç å¢å¼ºï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ç»“åˆå½“å‰æŒ‡ä»¤(ä¾‹å¦‚æœ¬ä¾‹çš„stack)è·å–å¯¹åº”ç›‘å¬å™¨ï¼Œä»¥å½“å‰ç±»ä½œä¸ºkeyï¼Œç›‘å¬å™¨åˆ—è¡¨ä½œä¸ºvalueç¼“å­˜åˆ°å…¨å±€mapä¸­ï¼Œåç»­å®Œæˆæ’æ¡©åçš„ç±»æ‰§è¡ŒatEnterè°ƒç”¨æ—¶å°±ä¼šé€šè¿‡å…¨å±€ç›‘å¬å™¨å®šä½åˆ°å½“å‰ç±»çš„ç›‘å¬å™¨å®Œæˆæ‰§è¡Œå¢å¼ºé€»è¾‘ï¼š</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/53fec23a916042fe96407c3b8000a7e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=rOptfiTbsgkoCHtdrY2uSGrgs8E%3D" alt="" loading="lazy"/></p>
<p>äº†è§£å®è§‚æµç¨‹åï¼Œæˆ‘ä»¬ç»™å‡º<code>ShellLineHandler</code>çš„<code>handle</code>æ–¹æ³•ï¼Œæœ¬è´¨å°±æ˜¯è§£æä¼ å…¥çš„å‘½ä»¤lineï¼Œç„¶åæŒ‰ç…§ä¸Šé¢è¯´çš„è§£æå‘½ä»¤ç­‰ä¿¡æ¯å°è£…æˆ<code>process</code>(åŒ…å«å‘½ä»¤æŠ½è±¡å’Œsession)ä»è€Œæ„å»ºå‡ºjobï¼Œç„¶åè°ƒç”¨runæ–¹æ³•ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@Override</span>
Â Â Â Â publicÂ voidÂ handle(StringÂ line)Â {<span class="hljs-comment">//stackÂ Demo$CounterÂ increment</span>
Â Â Â Â Â Â Â Â ifÂ (lineÂ ==Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â EOF</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">handleExit</span>();
Â Â Â Â Â Â Â Â Â Â Â Â return;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â List&lt;CliToken&gt;Â tokensÂ =Â CliTokens<span class="hljs-selector-class">.tokenize</span>(line);
Â Â Â Â Â Â Â Â CliTokenÂ firstÂ =Â TokenUtils<span class="hljs-selector-class">.findFirstTextToken</span>(tokens);<span class="hljs-comment">//æ‹¿åˆ°ä¸€ä¸ªÂ tokenå¾—åˆ°å¯¹åº”çš„æŒ‡ä»¤</span>
Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>

Â Â Â Â Â Â Â Â JobÂ jobÂ =Â <span class="hljs-built_in">createJob</span>(tokens);
Â Â Â Â Â Â Â Â ifÂ (jobÂ !=Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â job<span class="hljs-selector-class">.run</span>();<span class="hljs-comment">//æäº¤åˆ°çº¿ç¨‹æ± </span>
Â Â Â Â Â Â Â Â }
Â Â Â Â }
</code></pre>
<p>ç”±æ­¤æ¥åˆ°JobImplçš„runæ–¹æ³•ï¼Œç”±æ­¤çœ‹åˆ°æœ€æ ¸å¿ƒçš„é€»è¾‘ï¼Œå³å°†<code>process</code>å¤„ç†å™¨å°è£…åˆ°<code>CommandProcessTask</code>æäº¤åˆ°çº¿ç¨‹æ± ä¸­è¿è¡Œï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">@<span class="hljs-function">Override
Â Â Â Â <span class="hljs-keyword">public</span>Â JobÂ <span class="hljs-title">run</span><span class="hljs-params">(<span class="hljs-type">boolean</span>Â foreground)</span>Â </span>{
Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â process.<span class="hljs-built_in">setSession</span>(<span class="hljs-keyword">this</span>.session);
Â Â Â Â Â Â Â Â process.<span class="hljs-built_in">run</span>(foreground);

Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">this</span>;
Â Â Â Â }


@<span class="hljs-function">Override
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">synchronized</span>Â <span class="hljs-type">void</span>Â <span class="hljs-title">run</span><span class="hljs-params">(<span class="hljs-type">boolean</span>Â fg)</span>Â </span>{
Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â RunnableÂ taskÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-built_in">CommandProcessTask</span>(process);<span class="hljs-comment">//å°è£…æˆä»»åŠ¡</span>
Â Â Â Â Â Â Â Â ArthasBootstrap.<span class="hljs-built_in">getInstance</span>().<span class="hljs-built_in">execute</span>(task);Â <span class="hljs-comment">//ä¸¢åˆ°æ— ç•Œçº¿ç¨‹æ± ä¸­</span>
Â Â Â Â }
</code></pre>
<p>ç»è¿‡å±‚å±‚æŠ½è±¡è°ƒç”¨æ¥åˆ°æ‰§è¡Œ<code>stackCommand</code>çš„<code>process</code>ï¼Œå³æ‰§è¡ŒæŠ½è±¡çˆ¶ç±»çš„é€šç”¨å¢å¼ºé€»è¾‘ï¼š</p>
<ol>
<li>åŒ¹é…å®šä½è¦æ‹¦æˆªçš„æ–¹æ³•ï¼Œæ’å…¥<code>SpyAPI</code>çš„<code>atEnter</code>ç­‰æ–¹æ³•å®Œæˆå­—èŠ‚ç å¢å¼º</li>
<li>å®šä½å­ç±»å³<code>stackCommand</code>çš„ç›‘å¬å™¨ä»¥å½“å‰ç›®æ ‡ç±»ä¸ºkeyï¼Œç›‘å¬å™¨ä¸º<code>value</code>ç¼“å­˜åˆ°å…¨å±€ç›‘å¬å™¨</li>
<li>è¿”å›å¢å¼ºåçš„å­—èŠ‚ç </li>
</ol>

<pre><code class="hljs language-scss" lang="scss">Â <span class="hljs-keyword">@Override</span>
Â Â Â Â publicÂ byte[]Â transform(finalÂ ClassLoaderÂ inClassLoader,Â StringÂ className,Â Class&lt;?&gt;Â classBeingRedefined,
Â Â Â Â Â Â Â Â Â Â Â Â ProtectionDomainÂ protectionDomain,Â byte[]Â classfileBuffer)Â throwsÂ IllegalClassFormatExceptionÂ {
Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>

Â Â Â Â Â Â Â Â Â Â 

Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//æ‹¿åˆ°åŸæœ‰çš„ä»£ç çš„å­—èŠ‚ç </span>
Â Â Â Â Â Â Â Â Â Â Â Â ClassNodeÂ classNodeÂ =Â newÂ <span class="hljs-built_in">ClassNode</span>(Opcodes.ASM9);
Â Â Â Â Â Â Â Â Â Â Â Â ClassReaderÂ classReaderÂ =Â AsmUtils<span class="hljs-selector-class">.toClassNode</span>(classfileBuffer,Â classNode);
Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç”Ÿæˆå¢å¼ºå­—èŠ‚ç </span>
Â Â Â Â Â Â Â Â Â Â Â Â DefaultInterceptorClassParserÂ defaultInterceptorClassParserÂ =Â newÂ <span class="hljs-built_in">DefaultInterceptorClassParser</span>();

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>

Â Â Â Â Â <span class="hljs-comment">//è¿‡æ»¤åŒ¹é…éœ€è¦å¢å¼ºçš„ç›®æ ‡æ–¹æ³•</span>
Â Â Â Â Â Â Â Â Â Â Â Â List&lt;MethodNode&gt;Â matchedMethodsÂ =Â newÂ ArrayList&lt;MethodNode&gt;();
Â Â Â Â Â Â Â Â Â Â Â Â forÂ (MethodNodeÂ methodNodeÂ :Â classNode.methods)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (!isIgnore(methodNode,Â methodNameMatcher))Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â matchedMethods<span class="hljs-selector-class">.add</span>(methodNode);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>

Â Â Â Â Â Â Â Â Â Â Â 

Â Â Â Â Â Â Â Â Â Â Â Â forÂ (MethodNodeÂ methodNodeÂ :Â matchedMethods)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å…ˆæŸ¥æ‰¾æ˜¯å¦æœ‰Â atBeforeInvokeÂ å‡½æ•°ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è¯´æ˜å·²ç»æœ‰traceäº†ï¼Œåˆ™ç›´æ¥ä¸å†å°è¯•å¢å¼ºï¼Œç›´æ¥æ’å…¥Â listener</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">if</span>(AsmUtils.containsMethodInsnNode(methodNode,Â Type.getInternalName(SpyAPI.class),Â "atBeforeInvoke"))Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }elseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â MethodProcessorÂ methodProcessorÂ =Â newÂ <span class="hljs-built_in">MethodProcessor</span>(classNode,Â methodNode,Â groupLocationFilter);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//éå†æ‰€æœ‰interceptoré’ˆå¯¹åŒ¹é…çš„ç›®æ ‡æ–¹æ³•è¿›è¡Œå¢å¼ºæ“ä½œ</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â forÂ (InterceptorProcessorÂ interceptorÂ :Â interceptorProcessors)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â List&lt;Location&gt;Â locationsÂ =Â interceptor<span class="hljs-selector-class">.process</span>(methodProcessor);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â forÂ (LocationÂ locationÂ :Â locations)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (locationÂ instanceofÂ MethodInsnNodeWare)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â MethodInsnNodeWareÂ methodInsnNodeWareÂ =Â (MethodInsnNodeWare)Â location;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â MethodInsnNodeÂ methodInsnNodeÂ =Â methodInsnNodeWare<span class="hljs-selector-class">.methodInsnNode</span>();
<span class="hljs-comment">//é’ˆå¯¹å½“å‰ç±»æ³¨å†Œç›‘å¬å™¨ï¼Œå¯¹åº”è¯¥æ–¹æ³•åº•å±‚å°±ä¼šä»¥å½“å‰ç±»ä½œä¸ºkeyï¼Œæ·»åŠ ä¸€ä¸ªç›¸å…³æŒ‡ä»¤çš„ç›‘å¬å™¨(ä¾‹å¦‚stackå°±æ˜¯StackAdviceListener)ç­‰å¾…æ‰§è¡Œå¢å¼ºé€»è¾‘æ‰§è¡Œæ—¶æ‰§è¡Œæ ˆå¸§è°ƒç”¨è¿½è¸ª</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â AdviceListenerManager<span class="hljs-selector-class">.registerTraceAdviceListener</span>(inClassLoader,Â className,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â methodInsnNode.owner,Â methodInsnNode.name,Â methodInsnNode.desc,Â listener);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ThrowableÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }

Â <span class="hljs-comment">//é’ˆå¯¹å½“å‰ç±»æ³¨å†Œç›‘å¬å™¨ï¼Œä¾‹å¦‚æœ¬æ¬¡ç”¨stackæŒ‡ä»¤å¯¹Demoç±»çš„Counterå†…éƒ¨ç±»çš„incrementåšè°ƒç”¨è¿½è¸ªï¼Œå¯¹åº”è¯¥æ–¹æ³•åº•å±‚å°±ä¼šä»¥å½“å‰ç±»ä½œä¸ºkeyï¼Œæ·»åŠ ä¸€ä¸ªStackAdviceListenerç­‰å¾…æ‰§è¡Œå¢å¼ºé€»è¾‘æ‰§è¡Œæ—¶æ‰§è¡Œæ ˆå¸§è°ƒç”¨è¿½è¸ª</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â AdviceListenerManager<span class="hljs-selector-class">.registerAdviceListener</span>(inClassLoader,Â className,Â methodNode.name,Â methodNode.desc,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â listener);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â Â Â Â Â byte<span class="hljs-selector-attr">[]</span>Â enhanceClassByteArrayÂ =Â AsmUtils<span class="hljs-selector-class">.toBytes</span>(classNode,Â inClassLoader,Â classReader);

Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â <span class="hljs-comment">//è¿”å›å¢å¼ºåçš„å­—èŠ‚ç </span>

Â Â Â Â Â Â Â Â Â Â Â Â returnÂ enhanceClassByteArray;
Â Â Â Â Â Â Â Â }Â catchÂ (ThrowableÂ t)Â {
Â Â Â Â Â Â Â Â Â Â Â Â logger<span class="hljs-selector-class">.warn</span>("transformÂ loader[{}]:class[{}]Â failed.",Â inClassLoader,Â className,Â t);
Â Â Â Â Â Â Â Â Â Â Â Â affect<span class="hljs-selector-class">.setThrowable</span>(t);
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â returnÂ null;
Â Â Â Â }
</code></pre>
<h3 data-id="heading-26">è§£è€¦åŒ–æ‹¦æˆªç±»æ–¹æ³•æ‰§è¡Œå¢å¼ºé€»è¾‘</h3>
<p>åç»­å¯¹äºè¯¥ç±»å³<code>Demo.Counter</code>çš„è°ƒç”¨ï¼Œå°±ä¼šæ‰§è¡Œåˆ°<code>SpyAPI</code>çš„<code>atEnter</code>æ–¹æ³•ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯å¯¹åº”<code>spyInstance</code>(ä¹Ÿå°±æ˜¯<code>SpyImpl</code>)çš„è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">atEnter</span>(<span class="hljs-params">Class&lt;?&gt;Â clazz,Â <span class="hljs-built_in">String</span>Â methodInfo,Â <span class="hljs-built_in">Object</span>Â target,Â <span class="hljs-built_in">Object</span>[]Â args</span>)Â {
Â Â Â Â Â Â Â Â spyInstance.<span class="hljs-title function_">atEnter</span>(clazz,Â methodInfo,Â target,Â args);
Â Â Â Â }
</code></pre>
<p>æ­¥å…¥<code>SpyImpl</code>æºä»£ç å¯ä»¥çœ‹åˆ°ï¼Œå…¶åº•å±‚å°±ä¼šé€šè¿‡å…¨å±€ç›‘å¬å™¨å®šä½åˆ°è¿™ä¸ªç±»çš„ç›‘å¬å™¨å®Œæˆå…·ä½“çš„å¢å¼ºé€»è¾‘ï¼Œæ˜¾è§<code>arthas</code>ä½œè€…å¯¹äºè§£è€¦æ€æƒ³çš„è§è§£ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">@Override
Â Â Â Â publicÂ voidÂ atEnter(Class&lt;?&gt;Â clazz,Â StringÂ methodInfo,Â ObjectÂ target,Â Object<span class="hljs-section">[]</span>Â args)Â {
Â Â Â Â Â Â Â Â ClassLoaderÂ <span class="hljs-attr">classLoader</span>Â =Â clazz.getClassLoader()<span class="hljs-comment">;</span>

Â Â Â Â Â Â Â Â String<span class="hljs-section">[]</span>Â <span class="hljs-attr">info</span>Â =Â StringUtils.splitMethodInfo(methodInfo)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â StringÂ <span class="hljs-attr">methodName</span>Â =Â info[<span class="hljs-number">0</span>]<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â StringÂ <span class="hljs-attr">methodDesc</span>Â =Â info[<span class="hljs-number">1</span>]<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â //åŸºäºå½“å‰ç±»åˆ°å…¨å±€ç¼“å­˜è·å–æ‰€æœ‰ç›‘å¬å™¨
Â Â Â Â Â Â Â Â List&lt;AdviceListener&gt;Â <span class="hljs-attr">listeners</span>Â =Â AdviceListenerManager.queryAdviceListeners(classLoader,Â clazz.getName(),
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â methodName,Â methodDesc)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â ifÂ (listenersÂ !=Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â forÂ (AdviceListenerÂ adviceListenerÂ :Â listeners)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (skipAdviceListener(adviceListener))Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â continue<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //æ‰§è¡ŒåŒ¹é…çš„ç›‘å¬å™¨é€»è¾‘
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â adviceListener.before(clazz,Â methodName,Â methodDesc,Â target,Â args)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ThrowableÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â logger.error("class:Â {},Â methodInfo:Â {}",Â clazz.getName(),Â methodInfo,Â e)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }

Â Â Â Â }
</code></pre>
<p>ä»¥æœ¬æ¬¡çš„<code>stack</code>ä¸ºä¾‹ä¹Ÿå°±æ˜¯åœ¨è°ƒç”¨å‰åœ¨å½“å‰çº¿ç¨‹å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªå¼€å§‹æ—¶é—´ï¼Œè¿™é‡Œç¬”è€…è€ƒè™‘åˆ°<code>stack</code>æŒ‡ä»¤ä»‹ç»çš„å®Œæ•´æ€§ä¹Ÿå°†<code>atExit</code>æ³¨è§£å¯¹åº”æ‰§è¡Œçš„afterReturningæ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°stackæœ¬è´¨è¦åšçš„å°±æ˜¯ï¼š</p>
<ol>
<li>beforeè®°å½•å…¶å®æ—¶é—´</li>
<li>afterReturningé€šè¿‡finishingæå–çº¿ç¨‹ä¸­çš„è°ƒç”¨å †æ ˆä¿¡æ¯å’Œçº¿ç¨‹ä¿¡æ¯å°è£…æˆStackModelè¾“å‡º</li>
</ol>

<pre><code class="hljs language-java" lang="java">Â <span class="hljs-meta">@Override</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">before</span><span class="hljs-params">(ClassLoaderÂ loader,Â Class&lt;?&gt;Â clazz,Â ArthasMethodÂ method,Â ObjectÂ target,Â Object[]Â args)</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">throws</span>Â ThrowableÂ {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¼€å§‹è®¡ç®—æœ¬æ¬¡æ–¹æ³•è°ƒç”¨è€—æ—¶</span>
Â Â Â Â Â Â Â Â threadLocalWatch.start();
Â Â Â Â }

<span class="hljs-meta">@Override</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">afterReturning</span><span class="hljs-params">(ClassLoaderÂ loader,Â Class&lt;?&gt;Â clazz,Â ArthasMethodÂ method,Â ObjectÂ target,Â Object[]Â args,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ObjectÂ returnObject)</span>Â <span class="hljs-keyword">throws</span>Â ThrowableÂ {
Â Â Â Â Â Â Â Â <span class="hljs-type">Advice</span>Â <span class="hljs-variable">advice</span>Â <span class="hljs-operator">=</span>Â Advice.newForAfterRetuning(loader,Â clazz,Â method,Â target,Â args,Â returnObject);<span class="hljs-comment">//è·å–ç±»ä¿¡æ¯Â å…¥å‚Â å‡ºå‚ä¿¡æ¯</span>
Â Â Â Â Â Â Â Â finishing(advice);
Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">finishing</span><span class="hljs-params">(AdviceÂ advice)</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æœ¬æ¬¡è°ƒç”¨çš„è€—æ—¶</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-type">double</span>Â <span class="hljs-variable">cost</span>Â <span class="hljs-operator">=</span>Â threadLocalWatch.costInMillis();
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//åˆ¤æ–­æ¡ä»¶æ˜¯å¦æ»¡è¶³è¦è¾“å‡ºçš„ç»“æœ</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-type">boolean</span>Â <span class="hljs-variable">conditionResult</span>Â <span class="hljs-operator">=</span>Â isConditionMet(command.getConditionExpress(),Â advice,Â cost);
Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (conditionResult)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//æå–å½“å‰çº¿ç¨‹å†…éƒ¨ç»´æŠ¤çš„stacktraceæ„æˆè°ƒç”¨é“¾ä»¥åŠå„ç§çº¿ç¨‹ä¿¡æ¯æ„æˆStackModelè¿”å›</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-type">StackModel</span>Â <span class="hljs-variable">stackModel</span>Â <span class="hljs-operator">=</span>Â ThreadUtil.getThreadStackModel(advice.getLoader(),Â Thread.currentThread());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â stackModel.setTs(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Date</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â process.appendResult(stackModel);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ThrowableÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//......</span>
Â Â Â Â Â Â Â Â }
Â Â Â Â }
</code></pre>
<p>æœ€ç»ˆæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ç±»ä¼¼ä¸‹é¢è¿™æ ·çš„è¾“å‡ºç»“æœï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a1eca0bed63e4987817a755a793389be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgc2hhcmtfY2hpbGk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767231464&amp;x-signature=UBCuxgDSPvvZchoYIplabXiI5jM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-27">å…³äºarthasæ€§èƒ½é—®é¢˜çš„æ¢è®¨</h2>
<p>åœ¨ç¬”è€…äº†è§£arthasè¿™æœ¬æŠ€æœ¯çš„æ—¶å€™ï¼Œçœ‹åˆ°githubæœ‰è¿™æ ·ä¸€ä¸ªè¯é¢˜ï¼š</p>
<pre><code class="hljs">arthasè¿›è¡Œå¢å¼ºæ—¶ï¼Œå¯¹äºç¨‹åºæ‰§è¡Œæ€§èƒ½æ˜¯å¦æœ‰å½±å“
</code></pre>
<p>å‚è€ƒå¤§éƒ¨åˆ†ç­”æ¡ˆç»“åˆç¬”è€…çš„ç»éªŒï¼Œé’ˆå¯¹é‚£äº›è¢«JITä¼˜åŒ–ä¸”ç”Ÿæˆæœºå™¨ç çš„å­—èŠ‚ç è¿›è¡Œå¢å¼ºæ—¶ï¼Œè¿™å°±ä¼šä½¿å¾—åŸæœ‰çš„ç¼“å­˜å¤±æ•ˆï¼Œä½¿å¾—è¢«å¢å¼ºçš„ç±»ç»å†ï¼š</p>
<ol>
<li>å­—èŠ‚ç ä¿®æ”¹</li>
<li>åŸæœ‰JITä¼˜åŒ–åçš„ä»£ç å¤±æ•ˆ</li>
<li>é«˜å¹¶å‘çš„å‡½æ•°è°ƒç”¨ä¼šè°ƒèµ·æŠ–åŠ¨</li>
<li>å†æ¬¡ç»å†è§£é‡Šæ‰§è¡Œã€JITç¼–è¯‘å†ä¼˜åŒ–ä¸ºç¼–è¯‘ç‰ˆæœ¬çš„æœºå™¨ç æ‰§è¡Œ</li>
</ol>
<p>ä»ä½¿ç”¨çš„è¡¨ç°æ¥çœ‹ï¼Œattachå› ä¸ºå¢å¼ºæ‰€æœ‰çš„classloaderçš„é‚£ä¸€ç¬é—´CPUä½¿ç”¨ç‡ç¡®å®ä¼šçŸ­æš‚é£™å‡ï¼Œå‡ºç°æœåŠ¡æŠ–åŠ¨ï¼Œæ‰€ä»¥åœ¨é«˜å¹¶å‘çš„ç”Ÿäº§ç¯å¢ƒè¿˜æ˜¯æ…ç”¨ã€‚</p>
<p>æ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥ç§»æ­¥äº†è§£è¯¥é—®é¢˜:Arthas attach ä¹‹åå¯¹åŸè¿›ç¨‹æ€§èƒ½æœ‰å¤šå¤§çš„å½±å“:<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Falibaba%2Farthas%2Fissues%2F44" target="_blank" title="https://github.com/alibaba/arthas/issues/44" ref="nofollow noopener noreferrer">github.com/alibaba/artâ€¦</a></p>
<h2 data-id="heading-28">å°ç»“</h2>
<p>æœ¬æ–‡åŸºäºarthas 3.6.0æºç é’ˆå¯¹arthasè¿è¡Œæ—¶å¢å¼ºæŠ€æœ¯è¿›è¡Œæ·±å…¥åˆ†æï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªç›‘æ§è¯Šæ–­å·¥å…·åˆ©ç”¨äº†agentçš„attachè¿›è¡Œè¿è¡Œæ—¶é€šè¿‡å­—èŠ‚ç è¿›è¡Œé€šç”¨çš„å­—èŠ‚ç ä¿®æ”¹å¢å¼ºï¼Œç„¶åæ ¹æ®ç”¨æˆ·é”®å…¥çš„æŒ‡ä»¤è·å–å¯¹åº”ç›‘å¬å™¨ç¼“å­˜åˆ°å…¨å±€ï¼Œåœ¨æ‰§è¡Œé€šç”¨å­—èŠ‚ç å³SpyAPIè°ƒç”¨æ—¶å°±ä¼šå®šä½åˆ°æŒ‡å®šç›‘å¬å™¨å®Œæˆå“åº”çš„é€»è¾‘å¢å¼ºã€‚</p>
<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ <strong>SharkChili</strong> ï¼Œç¦…ä¸è®¡ç®—æœºç¨‹åºè®¾è®¡è‰ºæœ¯å¸ƒé“è€…ï¼Œå¸Œæœ›æˆ‘çš„ç†å¿µå¯¹æ‚¨æœ‰æ‰€å¯å‘ã€‚</p>
<p><strong>ğŸ“ æˆ‘çš„å…¬ä¼—å·ï¼šå†™ä»£ç çš„SharkChili</strong><br/>
åœ¨è¿™é‡Œï¼Œæˆ‘ä¼šåˆ†äº«æŠ€æœ¯å¹²è´§ã€ç¼–ç¨‹æ€è€ƒä¸å¼€æºé¡¹ç›®å®è·µã€‚</p>
<p><strong>ğŸš€ æˆ‘çš„å¼€æºé¡¹ç›®ï¼šmini-redis</strong><br/>
ä¸€ä¸ªç”¨äºæ•™å­¦ç†è§£çš„ Redis ç²¾ç®€å®ç°ï¼Œæ¬¢è¿ Star &amp; Contributeï¼š<br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fshark-ctrl%2Fmini-redis" target="_blank" title="https://github.com/shark-ctrl/mini-redis" ref="nofollow noopener noreferrer">github.com/shark-ctrl/â€¦</a></p>
<p><strong>ğŸ‘¥ æ¬¢è¿åŠ å…¥è¯»è€…ç¾¤</strong><br/>
å…³æ³¨å…¬ä¼—å·ï¼Œå›å¤ <strong>ã€åŠ ç¾¤ã€‘</strong> å³å¯è·å–è”ç³»æ–¹å¼ï¼ŒæœŸå¾…ä¸ä½ äº¤æµæŠ€æœ¯ã€å…±åŒæˆé•¿ï¼</p>
<h2 data-id="heading-29">å‚è€ƒ</h2>
<p>ArthasæŠ€æœ¯åŸç†-æºç è°ƒè¯•ç¯å¢ƒæ­å»º:<a href="https://link.juejin.cn?target=https%3A%2F%2Fwanglikang.github.io%2F2024%2F08%2F03%2FArthas%25E6%258A%2580%25E6%259C%25AF%25E5%258E%259F%25E7%2590%2586-%25E6%25BA%2590%25E7%25A0%2581%25E8%25B0%2583%25E8%25AF%2595%25E7%258E%25AF%25E5%25A2%2583%25E6%2590%25AD%25E5%25BB%25BA%2F" target="_blank" title="https://wanglikang.github.io/2024/08/03/Arthas%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86-%E6%BA%90%E7%A0%81%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" ref="nofollow noopener noreferrer">wanglikang.github.io/2024/08/03/â€¦</a></p>
<p>æ·±å…¥å‰–æArthasæºç :<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cnblogs.com%2Fbigcoder84%2Fp%2F18147350" target="_blank" title="https://www.cnblogs.com/bigcoder84/p/18147350" ref="nofollow noopener noreferrer">www.cnblogs.com/bigcoder84/â€¦</a></p>
<p>Debug Arthas In IDEA :<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Falibaba%2Farthas%2Fissues%2F222" target="_blank" title="https://github.com/alibaba/arthas/issues/222" ref="nofollow noopener noreferrer">github.com/alibaba/artâ€¦</a></p>
<p>æŒ‡å®šç‰ˆæœ¬å¯åŠ¨arthas:<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Falibaba%2Farthas%2Fblob%2Fmaster%2FCONTRIBUTING.md" target="_blank" title="https://github.com/alibaba/arthas/blob/master/CONTRIBUTING.md" ref="nofollow noopener noreferrer">github.com/alibaba/artâ€¦</a></p>
<p>å¼€æºè¯Šæ–­åˆ©å™¨Arthas ByteKit æ·±åº¦è§£è¯»(1)ï¼šåŸºæœ¬åŸç†ä»‹ç»:<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fhengyunabc%2Farticle%2Fdetails%2F107398983" target="_blank" title="https://blog.csdn.net/hengyunabc/article/details/107398983" ref="nofollow noopener noreferrer">blog.csdn.net/hengyunabc/â€¦</a></p>
<p>Java agent-05-Bytecode Kit-00-bytekit å…¥é—¨ä»‹ç»:<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F12979796066" target="_blank" title="https://zhuanlan.zhihu.com/p/12979796066" ref="nofollow noopener noreferrer">zhuanlan.zhihu.com/p/129797960â€¦</a></p>
<p>Java ç¨‹åºçš„è¿è¡ŒåŸç†:<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cnblogs.com%2Fluojw%2Fp%2F18112110" target="_blank" title="https://www.cnblogs.com/luojw/p/18112110" ref="nofollow noopener noreferrer">www.cnblogs.com/luojw/p/181â€¦</a></p>
<p>Class VirtualMachine APIå®˜æ–¹æ–‡æ¡£:<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.oracle.com%2Fjavase%2F8%2Fdocs%2Fjdk%2Fapi%2Fattach%2Fspec%2Fcom%2Fsun%2Ftools%2Fattach%2FVirtualMachine.html" target="_blank" title="https://docs.oracle.com/javase/8/docs/jdk/api/attach/spec/com/sun/tools/attach/VirtualMachine.html" ref="nofollow noopener noreferrer">docs.oracle.com/javase/8/doâ€¦</a></p>
<p>æœ¬æ–‡ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmarkdown.com.cn" target="_blank" title="https://markdown.com.cn" ref="nofollow noopener noreferrer">markdown.com.cn</a> æ’ç‰ˆ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¢è¯•é¢˜ï¼šArrayListæºç åˆ†æ]]></title>    <link>https://juejin.cn/post/7587245616754491443</link>    <guid>https://juejin.cn/post/7587245616754491443</guid>    <pubDate>2025-12-24T12:51:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587245616754491443" data-draft-id="7208380301025067066" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¢è¯•é¢˜ï¼šArrayListæºç åˆ†æ"/> <meta itemprop="keywords" content="é¢è¯•,åç«¯,Java"/> <meta itemprop="datePublished" content="2025-12-24T12:51:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å–å’–å•¡çš„å·¥åŒ "/> <meta itemprop="url" content="https://juejin.cn/user/4459274892488461"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¢è¯•é¢˜ï¼šArrayListæºç åˆ†æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4459274892488461/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å–å’–å•¡çš„å·¥åŒ 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T12:51:20.000Z" title="Wed Dec 24 2025 12:51:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1 æ¦‚è¿°</h2>
<p>â€ƒâ€ƒ<code>ArrayList</code>æ˜¯åŸºäºæ•°ç»„å®ç°çš„åŠ¨æ€æ•°ç»„ï¼Œå†…éƒ¨ä½¿ç”¨ä¸€ä¸ªObjectç±»å‹çš„æ•°ç»„elementDataæ¥å­˜å‚¨å…ƒç´ ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªæ•´å‹å˜é‡sizeè®°å½•<code>ArrayList</code>ä¸­å®é™…å­˜å‚¨çš„å…ƒç´ ä¸ªæ•°ã€‚åœ¨æ·»åŠ å…ƒç´ æ—¶ï¼Œå¦‚æœå…ƒç´ ä¸ªæ•°å·²ç»è¾¾åˆ°æ•°ç»„çš„å®¹é‡ä¸Šé™ï¼Œ<code>ArrayList</code>ä¼šè‡ªåŠ¨è¿›è¡Œæ‰©å®¹ï¼Œä»¥ä¿è¯æ•°ç»„å¯ä»¥å®¹çº³æ›´å¤šå…ƒç´ ã€‚</p>
<p>â€ƒâ€ƒæˆ‘ä»¬ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢å¯¹ArrayListçš„æºç è¿›è¡Œåˆ†æï¼š</p>
<ol>
<li>ArrayListçš„æ ¸å¿ƒå­—æ®µ</li>
<li>ArrayListçš„æ„é€ æ–¹æ³•</li>
<li>ArrayListçš„æ·»åŠ å…ƒç´ </li>
<li>ArrayListçš„è·å–å…ƒç´ </li>
<li>ArrayListçš„æ›¿æ¢å…ƒç´ </li>
<li>ArrayListçš„åˆ é™¤å…ƒç´ </li>
<li>ArrayListçš„åˆ¤æ–­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ </li>
<li>ArrayListçš„è·å–å…ƒç´ çš„ä¸‹æ ‡</li>
<li>ArrayListçš„æ‰©å®¹æœºåˆ¶</li>
<li>ArrayListçš„çº¿ç¨‹å®‰å…¨é—®é¢˜</li>
<li>ArrayListçš„åŸºæœ¬ä»‹ç»</li>
</ol>
<h2 data-id="heading-1">2 æºç è§£æ</h2>
<h3 data-id="heading-2">2.1 æ ¸å¿ƒå­—æ®µ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ArrayList</span>&lt;E&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractList</span>&lt;E&gt;
        <span class="hljs-keyword">implements</span> <span class="hljs-title class_">List</span>&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable {
    <span class="hljs-comment">// åºåˆ—åŒ–ç‰ˆæœ¬ ID</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">8683452581122892189L</span>;
    <span class="hljs-comment">// é»˜è®¤åˆå§‹å®¹é‡</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">DEFAULT_CAPACITY</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;
    <span class="hljs-comment">// ç©ºæ•°ç»„ï¼Œç”¨äºåˆå§‹åŒ–ç©ºçš„ ArrayList</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Object[] EMPTY_ELEMENTDATA = {};
    <span class="hljs-comment">// é»˜è®¤çš„ç©ºæ•°ç»„ï¼Œç”¨äºåˆå§‹åŒ–æ²¡æœ‰æŒ‡å®šåˆå§‹å®¹é‡çš„ ArrayList</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};
    <span class="hljs-comment">// å­˜å‚¨å…ƒç´ çš„æ•°ç»„ï¼Œtransient ä¿®é¥°è¡¨ç¤ºè¯¥å±æ€§ä¸ä¼šè¢«åºåˆ—åŒ–</span>
    <span class="hljs-keyword">transient</span> Object[] elementData;
    <span class="hljs-comment">// ArrayList ä¸­å…ƒç´ çš„æ•°é‡</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> size;

}
</code></pre>
<ul>
<li><code>DEFAULT_CAPACITY</code>ï¼šé»˜è®¤å®¹é‡ä¸º10ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡æ— æƒ¨æ„é€ å‡½æ•°åˆ›å»ºæ—¶çš„é»˜è®¤å®¹é‡ã€‚</li>
<li><code>EMPTY_ELEMENTDATA</code>ï¼šç©ºæ•°ç»„ï¼Œæ˜¯ç”¨äºç©ºå®ä¾‹çš„å…±äº«ç©ºæ•°ç»„å®ä¾‹ã€‚</li>
<li><code>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</code>ï¼šä¹Ÿæ˜¯ç©ºæ•°ç»„ï¼Œæ— æƒ¨æ„é€ å‡½æ•°å°±æ˜¯ç”¨è¿™ä¸ªæ¥åˆå§‹åŒ–<code>ArrayList</code>çš„æ•°ç»„ç¼“å†²åŒºï¼›</li>
<li><code>elementData</code>ï¼šçœŸæ­£å­˜æ”¾å…ƒç´ çš„åœ°æ–¹ï¼Œ<code>ArrayList</code>å…ƒç´ çš„æ•°ç»„ç¼“å†²åŒºã€‚</li>
<li><code>size</code>ï¼šçœŸæ­£å­˜å‚¨å…ƒç´ çš„ä¸ªæ•°ï¼Œè€Œä¸æ˜¯elementDataæ•°ç»„çš„é•¿åº¦</li>
</ul>
<h3 data-id="heading-3">2.2 æ„é€ å‡½æ•°</h3>
<p>â€ƒâ€ƒArrayListæä¾›äº†å¤šä¸ªæ„é€ æ–¹æ³•ï¼Œå…¶ä¸­åŒ…æ‹¬æ— å‚æ„é€ æ–¹æ³•å’Œå¸¦å‚æ•°çš„æ„é€ æ–¹æ³•ã€‚æ— å‚æ„é€ æ–¹æ³•å°†åˆ›å»ºä¸€ä¸ªåˆå§‹å®¹é‡ä¸º0çš„ç©ºæ•°ç»„ï¼Œè€Œå¸¦å‚æ•°çš„æ„é€ æ–¹æ³•åˆ™å¯ä»¥æŒ‡å®šåˆå§‹å®¹é‡.</p>
<p>â€ƒâ€ƒä¸‹é¢æ˜¯ArrayListçš„æ„é€ æ–¹æ³•çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-comment">// ä½¿ç”¨é»˜è®¤å®¹é‡æ„é€  ArrayList</span>
<span class="hljs-keyword">public</span> <span class="hljs-title function_">ArrayList</span><span class="hljs-params">()</span> {
    <span class="hljs-built_in">this</span>.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;
}

<span class="hljs-comment">// ä½¿ç”¨æŒ‡å®šå®¹é‡æ„é€  ArrayList</span>
<span class="hljs-keyword">public</span> <span class="hljs-title function_">ArrayList</span><span class="hljs-params">(<span class="hljs-type">int</span> initialCapacity)</span> {
    <span class="hljs-keyword">if</span> (initialCapacity &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-built_in">this</span>.elementData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[initialCapacity];
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (initialCapacity == <span class="hljs-number">0</span>) {
        <span class="hljs-built_in">this</span>.elementData = EMPTY_ELEMENTDATA;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"Illegal Capacity: "</span> +
                                           initialCapacity);
    }
}

<span class="hljs-comment">// ä½¿ç”¨å¦ä¸€ä¸ªé›†åˆæ„é€  ArrayList</span>
<span class="hljs-keyword">public</span> <span class="hljs-title function_">ArrayList</span><span class="hljs-params">(Collection&lt;? extends E&gt; c)</span> {
    elementData = c.toArray();
    <span class="hljs-keyword">if</span> ((size = elementData.length) != <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// éç©ºé›†åˆï¼Œå°† elementData è½¬ä¸º Object æ•°ç»„</span>
        <span class="hljs-keyword">if</span> (elementData.getClass() != Object[].class)
            elementData = Arrays.copyOf(elementData, size, Object[].class);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// ç©ºé›†åˆï¼Œä½¿ç”¨ç©ºæ•°ç»„</span>
        <span class="hljs-built_in">this</span>.elementData = EMPTY_ELEMENTDATA;
    }
}


</code></pre>
<ul>
<li>
<p>ArrayList()ï¼šé»˜è®¤æ„é€ æ–¹æ³•ï¼Œåˆ›å»ºä¸€ä¸ªç©ºçš„<code>ArrayLis</code>tå®ä¾‹ï¼Œ<code>elementData</code>åˆå§‹åŒ–ä¸º<code>DEFAULTCAPACITY_EMPTY_ELEMENTDATA</code>ã€‚</p>
</li>
<li>
<p>ArrayList(int initialCapacity)ï¼šå¸¦æœ‰åˆå§‹å®¹é‡å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œ</p>
<ul>
<li>å¦‚æœæŒ‡å®šçš„initialCapacityå¤§äº0ï¼Œåˆ™<code>elementDataä¼š</code>è¢«åˆå§‹åŒ–ä¸ºä¸€ä¸ªæŒ‡å®šå¤§å°çš„æ•°ç»„</li>
<li>å¦‚æœinitialCapacityç­‰äº0ï¼Œåˆ™<code>elementData</code>è¢«åˆå§‹åŒ–ä¸ºç©ºæ•°ç»„ï¼›å¦åˆ™ï¼ŒæŠ›å‡ºIllegalArgumentExceptionå¼‚å¸¸ã€‚</li>
</ul>
</li>
<li>
<p>ArrayList(Collection&lt;? extends E&gt; c)ï¼šç”¨å¦ä¸€ä¸ªé›†åˆæ„é€ æ—¶ï¼Œé¦–å…ˆå°†é›†åˆè½¬ä¸ºæ•°ç»„ï¼Œç„¶åå°†æ•°ç»„èµ‹å€¼ç»™ elementDataã€‚å¦‚æœé›†åˆéç©ºï¼Œé‚£ä¹ˆå°† elementData æ•°ç»„è½¬ä¸º Object æ•°ç»„ï¼›å¦‚æœé›†åˆä¸ºç©ºï¼Œé‚£ä¹ˆç›´æ¥ä½¿ç”¨ç©ºæ•°ç»„</p>
</li>
</ul>
<h3 data-id="heading-4">2.3 æ ¸å¿ƒæ–¹æ³•</h3>
<h4 data-id="heading-5">2.3.1 æ·»åŠ å…ƒç´ </h4>
<p>ArrayListæä¾›äº†å¤šä¸ªæ·»åŠ å…ƒç´ çš„æ–¹æ³•ï¼Œä¸»è¦åŒ…æ‹¬add(E e)å’Œadd(int index,Â E element)ã€‚åœ¨æœ«å°¾æ·»åŠ å…ƒç´ ï¼š</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">add</span><span class="hljs-params">(E e)</span> {
    modCount++;
    add(e, elementData, size);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(E e, Object[] elementData, <span class="hljs-type">int</span> s)</span> {
    <span class="hljs-keyword">if</span> (s == elementData.length)
        elementData = grow();
    elementData[s] = e;
    size = s + <span class="hljs-number">1</span>;
}
</code></pre>
<p>åœ¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´ ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> index, E element)</span> {
    rangeCheckForAdd(index);
    modCount++;
    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> s;
    Object[] elementData;
    <span class="hljs-keyword">if</span> ((s = size) == (elementData = <span class="hljs-built_in">this</span>.elementData).length)
        elementData = grow();
    System.arraycopy(elementData, index,
                     elementData, index + <span class="hljs-number">1</span>,
                     s - index);
    elementData[index] = element;
    size = s + <span class="hljs-number">1</span>;
}
</code></pre>
<ul>
<li><code>add(E e)</code>ï¼šåœ¨åˆ—è¡¨æœ«å°¾æ·»åŠ å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼ˆä¸è€ƒè™‘æ‰©å®¹ï¼‰</li>
<li><code>add(int index,Â E element)</code>ï¼šåœ¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´ ï¼Œéœ€è¦ç§»åŠ¨åç»­å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n)</li>
<li><code>modCount</code>ï¼šè®°å½•ç»“æ„æ€§ä¿®æ”¹æ¬¡æ•°ï¼Œç”¨äºè¿­ä»£å™¨çš„å¿«é€Ÿå¤±è´¥æœºåˆ¶</li>
<li>æ’å…¥å‰ä¼šæ£€æŸ¥å®¹é‡ï¼Œä¸è¶³æ—¶è§¦å‘æ‰©å®¹</li>
</ul>
<h4 data-id="heading-6">2.3.2 è·å–å…ƒç´ </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> E <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span> {
    Objects.checkIndex(index, size);
    <span class="hljs-keyword">return</span> elementData(index);
}

E <span class="hljs-title function_">elementData</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span> {
    <span class="hljs-keyword">return</span> (E) elementData[index];
}
</code></pre>
<p>è¦ç‚¹è¯´æ˜ï¼š</p>
<ul>
<li>
<p>é€šè¿‡ç´¢å¼•ç›´æ¥è®¿é—®æ•°ç»„å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦O(1)ã€‚</p>
</li>
<li>
<p><code>Objects.checkIndex(index, size)</code>æ£€æŸ¥ç´¢å¼•æ˜¯å¦è¶Šç•Œã€‚</p>
</li>
<li>
<p>æ”¯æŒéšæœºè®¿é—®ï¼Œå®ç°äº†<code>RandomAccess</code>æ¥å£ã€‚</p>
</li>
</ul>
<h4 data-id="heading-7">2.3.3 æ›¿æ¢å…ƒç´ </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span>Â EÂ <span class="hljs-title function_">set</span><span class="hljs-params">(<span class="hljs-type">int</span>Â index,Â EÂ element)</span>Â {

Â Â Â Â Objects.checkIndex(index,Â size);

Â Â Â Â <span class="hljs-type">E</span>Â <span class="hljs-variable">oldValue</span>Â <span class="hljs-operator">=</span>Â elementData(index);

Â Â Â Â elementData[index]Â =Â element;

Â Â Â Â <span class="hljs-keyword">return</span>Â oldValue;

}
</code></pre>
<p>è¦ç‚¹è¯´æ˜ï¼š</p>
<ul>
<li>æ›¿æ¢æŒ‡å®šä½ç½®çš„å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦O(1)ã€‚</li>
</ul>

<ul>
<li>è¿”å›è¢«æ›¿æ¢çš„æ—§å…ƒç´ ã€‚</li>
</ul>

<ul>
<li>ä¼šè¿›è¡Œç´¢å¼•è¶Šç•Œæ£€æŸ¥ã€‚</li>
</ul>
<h4 data-id="heading-8">2.3.4 åˆ é™¤å…ƒç´ </h4>
<p>ArrayListæä¾›äº†ä¸¤ç§åˆ é™¤æ–¹å¼ï¼šæŒ‰ç´¢å¼•åˆ é™¤å’ŒæŒ‰å…ƒç´ åˆ é™¤ã€‚æŒ‰ç´¢å¼•åˆ é™¤ï¼š</p>
<pre><code class="hljs language-Java" lang="Java"><span class="hljs-keyword">public</span>Â EÂ <span class="hljs-title function_">remove</span><span class="hljs-params">(<span class="hljs-type">int</span>Â index)</span>Â {

Â Â Â Â Objects.checkIndex(index,Â size);

Â Â Â Â <span class="hljs-keyword">final</span>Â Object[]Â esÂ =Â elementData;

Â Â Â Â 

Â Â Â Â <span class="hljs-meta">@SuppressWarnings("unchecked")</span>Â <span class="hljs-type">E</span>Â <span class="hljs-variable">oldValue</span>Â <span class="hljs-operator">=</span>Â (E)Â es[index];

Â Â Â Â fastRemove(es,Â index);

Â Â Â Â 

Â Â Â Â <span class="hljs-keyword">return</span>Â oldValue;

}

<span class="hljs-keyword">private</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">fastRemove</span><span class="hljs-params">(Object[]Â es,Â <span class="hljs-type">int</span>Â i)</span>Â {

Â Â Â Â modCount++;

Â Â Â Â <span class="hljs-keyword">final</span>Â <span class="hljs-type">int</span>Â newSize;

Â Â Â Â <span class="hljs-keyword">if</span>Â ((newSizeÂ =Â sizeÂ -Â <span class="hljs-number">1</span>)Â &gt;Â i)

Â Â Â Â Â Â Â Â System.arraycopy(es,Â iÂ +Â <span class="hljs-number">1</span>,Â es,Â i,Â newSizeÂ -Â i);

Â Â Â Â es[sizeÂ =Â newSize]Â =Â <span class="hljs-literal">null</span>;Â Â <span class="hljs-comment">//Â æ¸…é™¤å¼•ç”¨ï¼Œå¸®åŠ©GC</span>

}
</code></pre>
<p>æŒ‰å…ƒç´ åˆ é™¤ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span>Â <span class="hljs-type">boolean</span>Â <span class="hljs-title function_">remove</span><span class="hljs-params">(ObjectÂ o)</span>Â {

Â Â Â Â <span class="hljs-keyword">final</span>Â Object[]Â esÂ =Â elementData;

Â Â Â Â <span class="hljs-keyword">final</span>Â <span class="hljs-type">int</span>Â <span class="hljs-variable">size</span>Â <span class="hljs-operator">=</span>Â <span class="hljs-built_in">this</span>.size;

Â Â Â Â <span class="hljs-type">int</span>Â <span class="hljs-variable">i</span>Â <span class="hljs-operator">=</span>Â <span class="hljs-number">0</span>;

Â Â Â Â found:Â {

Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (oÂ ==Â <span class="hljs-literal">null</span>)Â {

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (;Â iÂ &lt;Â size;Â i++)

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (es[i]Â ==Â <span class="hljs-literal">null</span>)

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>Â found;

Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">else</span>Â {

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (;Â iÂ &lt;Â size;Â i++)

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (o.equals(es[i]))

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">break</span>Â found;

Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">false</span>;

Â Â Â Â }

Â Â Â Â fastRemove(es,Â i);

Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">true</span>;

}
</code></pre>
<p>è¦ç‚¹è¯´æ˜ï¼š</p>
<ul>
<li>æŒ‰ç´¢å¼•åˆ é™¤ï¼šæ—¶é—´å¤æ‚åº¦O(n)ï¼Œéœ€è¦ç§»åŠ¨åç»­å…ƒç´ ã€‚</li>
</ul>

<ul>
<li>æŒ‰å…ƒç´ åˆ é™¤ï¼šå…ˆæŸ¥æ‰¾å…ƒç´ ä½ç½®ï¼Œå†åˆ é™¤ï¼Œæ—¶é—´å¤æ‚åº¦O(n)ã€‚</li>
</ul>

<ul>
<li>åˆ é™¤åä¼šå°†æ•°ç»„æœ«å°¾å…ƒç´ ç½®ä¸ºnullï¼Œå¸®åŠ©åƒåœ¾å›æ”¶ã€‚</li>
</ul>

<ul>
<li>åªåˆ é™¤ç¬¬ä¸€ä¸ªåŒ¹é…çš„å…ƒç´ ã€‚</li>
</ul>
<h4 data-id="heading-9">2.3.5 åˆ¤æ–­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span>Â <span class="hljs-type">boolean</span>Â <span class="hljs-title function_">contains</span><span class="hljs-params">(ObjectÂ o)</span>Â {

Â Â Â Â <span class="hljs-keyword">return</span>Â indexOf(o)Â &gt;=Â <span class="hljs-number">0</span>;

}
</code></pre>
<p>è¦ç‚¹è¯´æ˜ï¼š</p>
<ul>
<li>é€šè¿‡indexOfæ–¹æ³•å®ç°ï¼Œå¦‚æœè¿”å›ç´¢å¼•&gt;=0ï¼Œè¯´æ˜åŒ…å«è¯¥å…ƒç´ ã€‚</li>
</ul>

<ul>
<li>æ—¶é—´å¤æ‚åº¦O(n)ï¼Œéœ€è¦éå†æ•°ç»„ã€‚</li>
</ul>
<h4 data-id="heading-10">2.3.6 è·å–å…ƒç´ çš„ä¸‹æ ‡</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span>Â <span class="hljs-type">int</span>Â <span class="hljs-title function_">indexOf</span><span class="hljs-params">(ObjectÂ o)</span>Â {

Â Â Â Â <span class="hljs-keyword">return</span>Â indexOfRange(o,Â <span class="hljs-number">0</span>,Â size);

}

<span class="hljs-type">int</span>Â <span class="hljs-title function_">indexOfRange</span><span class="hljs-params">(ObjectÂ o,Â <span class="hljs-type">int</span>Â start,Â <span class="hljs-type">int</span>Â end)</span>Â {

Â Â Â Â Object[]Â esÂ =Â elementData;

Â Â Â Â <span class="hljs-keyword">if</span>Â (oÂ ==Â <span class="hljs-literal">null</span>)Â {

Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-type">int</span>Â <span class="hljs-variable">i</span>Â <span class="hljs-operator">=</span>Â start;Â iÂ &lt;Â end;Â i++)Â {

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (es[i]Â ==Â <span class="hljs-literal">null</span>)Â {

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â i;

Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â }

Â Â Â Â }Â <span class="hljs-keyword">else</span>Â {

Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-type">int</span>Â <span class="hljs-variable">i</span>Â <span class="hljs-operator">=</span>Â start;Â iÂ &lt;Â end;Â i++)Â {

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (o.equals(es[i]))Â {

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â i;

Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â }

Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">return</span>Â -<span class="hljs-number">1</span>;

}

<span class="hljs-keyword">public</span>Â <span class="hljs-type">int</span>Â <span class="hljs-title function_">lastIndexOf</span><span class="hljs-params">(ObjectÂ o)</span>Â {

Â Â Â Â <span class="hljs-keyword">return</span>Â lastIndexOfRange(o,Â <span class="hljs-number">0</span>,Â size);

}
</code></pre>
<p>è¦ç‚¹è¯´æ˜ï¼š</p>
<ul>
<li>indexOfï¼šè¿”å›å…ƒç´ ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œæœªæ‰¾åˆ°è¿”å›-1ã€‚</li>
</ul>

<ul>
<li>lastIndexOfï¼šè¿”å›å…ƒç´ æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ã€‚</li>
</ul>

<ul>
<li>æ—¶é—´å¤æ‚åº¦O(n)ã€‚</li>
</ul>

<ul>
<li>å¯¹nullå€¼ä½¿ç”¨==æ¯”è¾ƒï¼Œénullå€¼ä½¿ç”¨equalsæ¯”è¾ƒã€‚</li>
</ul>
<h4 data-id="heading-11">2.3.7 æ‰©å®¹æœºåˆ¶</h4>
<p>æ‰©å®¹æ˜¯ArrayListçš„æ ¸å¿ƒæœºåˆ¶ï¼Œå½“æ•°ç»„å®¹é‡ä¸è¶³æ—¶è‡ªåŠ¨æ‰©å®¹ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span>Â Object[]Â grow()Â {

Â Â Â Â <span class="hljs-keyword">return</span>Â grow(sizeÂ +Â <span class="hljs-number">1</span>);

}

<span class="hljs-keyword">private</span>Â Object[]Â grow(<span class="hljs-type">int</span>Â minCapacity)Â {

Â Â Â Â <span class="hljs-type">int</span>Â <span class="hljs-variable">oldCapacity</span>Â <span class="hljs-operator">=</span>Â elementData.length;

Â Â Â Â <span class="hljs-type">int</span>Â <span class="hljs-variable">newCapacity</span>Â <span class="hljs-operator">=</span>Â ArraysSupport.newLength(oldCapacity,

Â Â Â Â Â Â Â Â Â Â Â Â minCapacityÂ -Â oldCapacity,Â <span class="hljs-comment">/*Â minimumÂ growthÂ */</span>

Â Â Â Â Â Â Â Â Â Â Â Â oldCapacityÂ &gt;&gt;Â <span class="hljs-number">1</span>Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">/*Â preferredÂ growthÂ */</span>);

Â Â Â Â <span class="hljs-type">return</span>Â <span class="hljs-variable">elementData</span>Â <span class="hljs-operator">=</span>Â Arrays.copyOf(elementData,Â newCapacity);

}
</code></pre>
<p>æ‰©å®¹ç­–ç•¥ï¼š</p>
<ul>
<li>
<p>é»˜è®¤æ‰©å®¹ä¸ºåŸå®¹é‡çš„1.5å€ï¼ˆoldCapacity +Â oldCapacity &gt;&gt; 1ï¼‰ã€‚</p>
</li>
<li>
<p>å¦‚æœ1.5å€ä»ä¸è¶³ï¼Œåˆ™æ‰©å®¹åˆ°æ‰€éœ€çš„æœ€å°å®¹é‡ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨<code>Arrays.copyOf</code>åˆ›å»ºæ–°æ•°ç»„å¹¶å¤åˆ¶å…ƒç´ ã€‚</p>
</li>
<li>
<p>æ‰©å®¹æ“ä½œæ—¶é—´å¤æ‚åº¦O(n)ã€‚</p>
</li>
</ul>
<p>é¦–æ¬¡æ‰©å®¹çš„ç‰¹æ®Šå¤„ç†ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span>Â <span class="hljs-type">int</span>Â <span class="hljs-title function_">calculateCapacity</span><span class="hljs-params">(Object[]Â elementData,Â <span class="hljs-type">int</span>Â minCapacity)</span>Â {

Â Â Â Â <span class="hljs-keyword">if</span>Â (elementDataÂ ==Â DEFAULTCAPACITY_EMPTY_ELEMENTDATA)Â {

Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Math.max(DEFAULT_CAPACITY,Â minCapacity);

Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">return</span>Â minCapacity;

}
</code></pre>
<ul>
<li>æ— å‚æ„é€ åˆ›å»ºçš„ArrayListï¼Œé¦–æ¬¡æ·»åŠ å…ƒç´ æ—¶ï¼Œå¦‚æœæ‰€éœ€å®¹é‡å°äº10ï¼Œä¼šæ‰©å®¹åˆ°10ã€‚</li>
</ul>
<h4 data-id="heading-12">2.3.8 çº¿ç¨‹å®‰å…¨é—®é¢˜</h4>
<p>ArrayListä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼š</p>
<ul>
<li>
<p>å¤šçº¿ç¨‹å¹¶å‘ä¿®æ”¹ï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶è°ƒç”¨addã€removeç­‰æ–¹æ³•å¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚</p>
</li>
<li>
<p>è¿­ä»£å™¨å¿«é€Ÿå¤±è´¥ï¼šä½¿ç”¨è¿­ä»£å™¨éå†æ—¶ï¼Œå¦‚æœå…¶ä»–çº¿ç¨‹ä¿®æ”¹äº†é›†åˆï¼Œä¼šæŠ›å‡º<code>ConcurrentModificationException</code>ã€‚</p>
</li>
</ul>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>
<p>ä½¿ç”¨Collections.synchronizedList()ï¼š
<code>List&lt;String&gt;Â listÂ =Â Collections.synchronizedList(newÂ ArrayList&lt;&gt;()); </code></p>
</li>
<li>
<p>ä½¿ç”¨CopyOnWriteArrayListï¼ˆé€‚åˆè¯»å¤šå†™å°‘åœºæ™¯ï¼‰ï¼š<code>List&lt;String&gt;Â listÂ =Â newÂ CopyOnWriteArrayList&lt;&gt;();</code></p>
</li>
<li>
<p>ä½¿ç”¨æ˜¾å¼åŒæ­¥ï¼š</p>
</li>
</ul>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-keyword">synchronized</span>Â (list)Â {

    Â Â Â Â list.add(element);

    }
</code></pre>
<h2 data-id="heading-13">3.æ€»ç»“</h2>
<ol>
<li>ArrayListä½œä¸ºJavaé›†åˆæ¡†æ¶ä¸­æœ€å¸¸ç”¨çš„åŠ¨æ€æ•°ç»„å®ç°ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</li>
<li>åŠ¨æ€æ‰©å®¹ï¼šArrayListå¯ä»¥æ ¹æ®éœ€è¦è‡ªåŠ¨æ‰©å¤§å…¶å®¹é‡ã€‚å½“å…ƒç´ æ•°é‡è¶…è¿‡å½“å‰å®¹é‡æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨åˆ†é…æ›´å¤šçš„å†…å­˜æ¥å­˜å‚¨æ›´å¤šçš„å…ƒç´ ã€‚è¿™æ ·å¯ä»¥é¿å…åœ¨æ·»åŠ å…ƒç´ æ—¶é¢‘ç¹è¿›è¡Œæ•°ç»„æ‹·è´ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚é»˜è®¤æ‰©å®¹ç­–ç•¥æ˜¯æ‰©å®¹ä¸ºåŸå®¹é‡çš„1.5å€ã€‚</li>
<li>éšæœºè®¿é—®ï¼šArrayListæ”¯æŒå¿«é€Ÿéšæœºè®¿é—®å…ƒç´ ã€‚ç”±äºArrayListåº•å±‚ä½¿ç”¨æ•°ç»„å®ç°ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ç´¢å¼•ç›´æ¥è®¿é—®æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(1)ã€‚</li>
<li>å…ƒç´ å…è®¸ä¸ºnullï¼šArrayListå…è®¸å…ƒç´ ä¸ºç©ºï¼ˆnullï¼‰ï¼Œè¿™æ„å‘³ç€å¯ä»¥åœ¨ArrayListä¸­æ·»åŠ nullå…ƒç´ ï¼Œå¹¶å°†å…¶è§†ä¸ºæœ‰æ•ˆå…ƒç´ ã€‚</li>
<li>æœ‰åºæ€§ï¼šArrayListä»¥æ’å…¥é¡ºåºæ¥å­˜å‚¨å…ƒç´ ã€‚è¿™æ„å‘³ç€å…ƒç´ å°†æŒ‰ç…§å®ƒä»¬æ·»åŠ åˆ°ArrayListä¸­çš„é¡ºåºè¿›è¡Œå­˜å‚¨ï¼Œå¹¶ä¸”å¯ä»¥æŒ‰ç…§æ’å…¥é¡ºåºè¿­ä»£è®¿é—®å®ƒä»¬ã€‚</li>
<li>å¯ä»¥å­˜å‚¨ä»»ä½•å¯¹è±¡ï¼šArrayListå¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„å¯¹è±¡ã€‚å› ä¸ºArrayListæ˜¯ä½¿ç”¨æ³›å‹å®ç°çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ArrayListä¸­å­˜å‚¨ä¸åŒç±»å‹çš„å…ƒç´ ï¼Œè€Œä¸éœ€è¦è¿›è¡Œç±»å‹è½¬æ¢ã€‚</li>
<li>éçº¿ç¨‹å®‰å…¨ï¼šArrayListä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹éœ€è¦é¢å¤–çš„åŒæ­¥æœºåˆ¶ã€‚å¯ä»¥ä½¿ç”¨Collections.synchronizedList()æˆ–CopyOnWriteArrayListæ¥å®ç°çº¿ç¨‹å®‰å…¨ã€‚</li>
<li>æ’å…¥å’Œåˆ é™¤æ•ˆç‡è¾ƒä½ï¼šåœ¨æŒ‡å®šä½ç½®æ’å…¥æˆ–åˆ é™¤å…ƒç´ æ—¶ï¼Œéœ€è¦ç§»åŠ¨åç»­å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n)ã€‚å› æ­¤ï¼Œå¦‚æœéœ€è¦é¢‘ç¹è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œå»ºè®®ä½¿ç”¨LinkedListã€‚</li>
<li>å†…å­˜è¿ç»­ï¼šç”±äºåº•å±‚ä½¿ç”¨æ•°ç»„å®ç°ï¼ŒArrayListåœ¨å†…å­˜ä¸­æ˜¯è¿ç»­å­˜å‚¨çš„ï¼Œè¿™æœ‰åˆ©äºCPUç¼“å­˜ï¼Œæé«˜è®¿é—®æ•ˆç‡ã€‚</li>
</ol>
<p>é€‚ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>éœ€è¦é¢‘ç¹éšæœºè®¿é—®å…ƒç´ </li>
<li>å…ƒç´ æ•°é‡ç›¸å¯¹ç¨³å®šï¼Œä¸éœ€è¦é¢‘ç¹æ’å…¥å’Œåˆ é™¤</li>
<li>å•çº¿ç¨‹ç¯å¢ƒæˆ–å·²åšå¥½åŒæ­¥æ§åˆ¶çš„å¤šçº¿ç¨‹ç¯å¢ƒ</li>
</ul>
<p>ä¸é€‚ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>éœ€è¦é¢‘ç¹åœ¨ä¸­é—´ä½ç½®æ’å…¥æˆ–åˆ é™¤å…ƒç´ </li>
<li>å¤šçº¿ç¨‹å¹¶å‘ä¿®æ”¹ä¸”æœªåšåŒæ­¥æ§åˆ¶</li>
<li>å¯¹å†…å­˜ä½¿ç”¨æœ‰ä¸¥æ ¼é™åˆ¶çš„åœºæ™¯</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æµç¨‹å¼•æ“ã€å·¥ä½œæµã€è§„åˆ™å¼•æ“ã€ç¼–æ’ç³»ç»Ÿã€è¡¨è¾¾å¼å¼•æ“â€¦â€¦å¤©å‘ï¼Œæˆ‘åˆ°åº•è¯¥ç”¨å“ªä¸ªï¼Ÿ]]></title>    <link>https://juejin.cn/post/7587299670642606086</link>    <guid>https://juejin.cn/post/7587299670642606086</guid>    <pubDate>2025-12-25T01:52:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587299670642606086" data-draft-id="7587349016221532201" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æµç¨‹å¼•æ“ã€å·¥ä½œæµã€è§„åˆ™å¼•æ“ã€ç¼–æ’ç³»ç»Ÿã€è¡¨è¾¾å¼å¼•æ“â€¦â€¦å¤©å‘ï¼Œæˆ‘åˆ°åº•è¯¥ç”¨å“ªä¸ªï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯,å·¥ä½œæµå¼•æ“"/> <meta itemprop="datePublished" content="2025-12-25T01:52:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æµç¨‹å¼•æ“ã€å·¥ä½œæµã€è§„åˆ™å¼•æ“ã€ç¼–æ’ç³»ç»Ÿã€è¡¨è¾¾å¼å¼•æ“â€¦â€¦å¤©å‘ï¼Œæˆ‘åˆ°åº•è¯¥ç”¨å“ªä¸ªï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-25T01:52:10.000Z" title="Thu Dec 25 2025 01:52:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-25
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä½ æ˜¯ä¸æ˜¯ä¹Ÿæœ‰è¿™äº›å›°æƒ‘</h2>
<p>çœ‹é¡¹ç›®æ–‡æ¡£ï¼Œå„ç§åè¯æ‰‘é¢è€Œæ¥ï¼š</p>
<ul>
<li>æµç¨‹å¼•æ“ï¼ˆFlowableã€Camundaï¼‰</li>
<li>å·¥ä½œæµï¼ˆActivitiï¼‰</li>
<li>è§„åˆ™å¼•æ“ï¼ˆDroolsï¼‰</li>
<li>ç¼–æ’ç³»ç»Ÿï¼ˆLiteFlowï¼‰</li>
<li>è¡¨è¾¾å¼å¼•æ“ï¼ˆQLExpressã€Aviatorï¼‰</li>
<li>DAGè°ƒåº¦ï¼ˆAirflowã€DolphinSchedulerï¼‰</li>
<li>ä»»åŠ¡ç¼–æ’ï¼ˆTemporalã€Conductorï¼‰</li>
<li>BPMNã€Sagaã€Event-Driven...</li>
</ul>
<p>æ¯ä¸ªæ¡†æ¶éƒ½è¯´è‡ªå·±èƒ½è§£å†³é—®é¢˜ï¼Œæ¯ä¸ªæ¦‚å¿µçœ‹èµ·æ¥éƒ½å·®ä¸å¤šã€‚</p>
<p>æ–°æ‰‹ä¸€è„¸æ‡µé€¼ï¼Œè€æ‰‹ä¹Ÿç»å¸¸ææ··ã€‚</p>
<p>å¹²äº†20å¹´ï¼Œæˆ‘ä¹Ÿè¢«è¿™äº›ä¸œè¥¿ææ™•è¿‡ã€‚ä»Šå¤©ä¸è®²é‚£äº›è™šçš„ï¼Œç›´æ¥å‘Šè¯‰ä½ æ€ä¹ˆé€‰ã€‚</p>
<p>ç­”æ¡ˆå¾ˆç®€å•ï¼šåˆ«ç®¡è¿™äº›åè¯ï¼Œé—®è‡ªå·±å››ä¸ªé—®é¢˜å°±å¤Ÿäº†ã€‚</p>
<h2 data-id="heading-1">å¿˜æ‰é‚£äº›åè¯ï¼Œåªé—®å››ä¸ªé—®é¢˜</h2>
<p>çœ‹äº†ä¸€å †æ¡†æ¶ä»‹ç»è¿˜æ˜¯ä¸çŸ¥é“é€‰å“ªä¸ªï¼Ÿæ­£å¸¸ï¼Œå› ä¸ºä½ åœ¨çº ç»“æ¦‚å¿µã€‚</p>
<p>åˆ«çº ç»“äº†ï¼Œæ¦‚å¿µéƒ½æ˜¯è™šçš„ã€‚é—®è‡ªå·±å››ä¸ªé—®é¢˜ï¼Œç«‹åˆ»å°±æ¸…æ¥šäº†ã€‚</p>
<h3 data-id="heading-2">é—®é¢˜1ï¼šä½ æ˜¯è¦å¹²æ´»ï¼Œè¿˜æ˜¯æ”¹çŠ¶æ€ï¼Ÿ</h3>
<p>è¿™æ˜¯æœ€å…³é”®çš„ä¸€ä¸ªé—®é¢˜ã€‚ææ¸…æ¥šè¿™ä¸ªï¼Œä¸€å¤§åŠæ¡†æ¶å°±æ’é™¤äº†ã€‚</p>
<p><strong>æ”¹çŠ¶æ€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</strong></p>
<pre><code class="hljs language-diff" lang="diff">è¯·å‡å®¡æ‰¹ï¼š
å‘˜å·¥æäº¤ â†’ ä¸»ç®¡çœ‹äº†è¯´"è¡Œ" â†’ HRçœ‹äº†è¯´"è¡Œ" â†’ å®Œæˆ

æ•´ä¸ªè¿‡ç¨‹ï¼š
<span class="hljs-deletion">- æ²¡æœ‰è®¡ç®—</span>
<span class="hljs-deletion">- æ²¡æœ‰æ•°æ®è½¬æ¢</span>
<span class="hljs-deletion">- æ²¡æœ‰è°ƒç”¨å¤–éƒ¨ç³»ç»Ÿ</span>
<span class="hljs-deletion">- å°±æ˜¯çŠ¶æ€ä» pending å˜æˆ approved</span>

è¿™å°±æ˜¯çº¯æ”¹çŠ¶æ€ã€‚
</code></pre>
<p><strong>å¹²æ´»æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</strong></p>
<pre><code class="hljs language-diff" lang="diff">è®¢å•å¤„ç†ï¼š
ä¸‹å• â†’ æ‰£åº“å­˜ â†’ è°ƒæ”¯ä»˜æ¥å£ â†’ è°ƒç‰©æµæ¥å£ â†’ å‘è´§

æ•´ä¸ªè¿‡ç¨‹ï¼š
<span class="hljs-deletion">- è¦è®¡ç®—é‡‘é¢</span>
<span class="hljs-deletion">- è¦è°ƒç”¨å¤–éƒ¨API</span>
<span class="hljs-deletion">- è¦å¤„ç†æ•°æ®</span>
<span class="hljs-deletion">- è¦æ‰§è¡Œä¸šåŠ¡é€»è¾‘</span>

è¿™å°±æ˜¯å¹²æ´»ã€‚
</code></pre>
<p><strong>åˆ¤æ–­æ ‡å‡†ï¼š</strong></p>
<ul>
<li>æ”¹çŠ¶æ€ï¼šå°±æ˜¯è®©äººç‚¹"åŒæ„"æˆ–"æ‹’ç»"ï¼Œé™¤äº†æ”¹ä¸ªå­—æ®µï¼Œå•¥ä¹Ÿæ²¡å¹²</li>
<li>å¹²æ´»ï¼šè¦è®¡ç®—ã€è¦è°ƒAPIã€è¦å¤„ç†æ•°æ®</li>
</ul>
<p><strong>å¯¹åº”æ¡†æ¶ï¼š</strong></p>
<ul>
<li>æ”¹çŠ¶æ€ â†’ BPMNç³»ï¼ˆFlowableã€Camundaï¼‰</li>
<li>å¹²æ´» â†’ ç»§ç»­å¾€ä¸‹åˆ¤æ–­</li>
</ul>
<h3 data-id="heading-3">é—®é¢˜2ï¼šä¸»è¦æ˜¯äººå¤„ç†ï¼Œè¿˜æ˜¯æœºå™¨æ‰§è¡Œï¼Ÿ</h3>
<p><strong>äººå¤„ç†ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">å®¡æ‰¹æµç¨‹ï¼š
<span class="hljs-deletion">- ä¸»ç®¡è¦çœ‹æ–‡æ¡£</span>
<span class="hljs-deletion">- ä¸»ç®¡è¦åšåˆ¤æ–­</span>
<span class="hljs-deletion">- ä¸»ç®¡è¦ç‚¹æŒ‰é’®</span>
<span class="hljs-deletion">- ç„¶åç­‰ä¸‹ä¸€ä¸ªäºº</span>

ç‰¹ç‚¹ï¼šå¤§éƒ¨åˆ†æ—¶é—´åœ¨ç­‰äºº
</code></pre>
<p><strong>æœºå™¨æ‰§è¡Œï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">æ•°æ®å¤„ç†ï¼š
<span class="hljs-deletion">- è¯»æ•°æ®åº“</span>
<span class="hljs-deletion">- æ¸…æ´—æ•°æ®</span>
<span class="hljs-deletion">- è½¬æ¢æ ¼å¼</span>
<span class="hljs-deletion">- å†™å…¥ç›®æ ‡è¡¨</span>

ç‰¹ç‚¹ï¼šæœºå™¨è‡ªå·±è·‘ï¼Œä¸ç”¨äººç®¡
</code></pre>
<p><strong>å¯¹åº”æ¡†æ¶ï¼š</strong></p>
<ul>
<li>äººä¸ºä¸» â†’ BPMNç³»ï¼ˆFlowableã€Camundaï¼‰</li>
<li>æœºå™¨ä¸ºä¸» â†’ ç»§ç»­å¾€ä¸‹åˆ¤æ–­</li>
</ul>
<h3 data-id="heading-4">é—®é¢˜3ï¼šæ˜¯æœ¬åœ°æ–¹æ³•ï¼Œè¿˜æ˜¯è·¨ç³»ç»Ÿè°ƒç”¨ï¼Ÿ</h3>
<p><strong>æœ¬åœ°æ–¹æ³•ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">è¥é”€è§„åˆ™ï¼š
<span class="hljs-deletion">- åˆ¤æ–­ç”¨æˆ·æ˜¯ä¸æ˜¯VIP</span>
<span class="hljs-deletion">- è®¡ç®—æŠ˜æ‰£</span>
<span class="hljs-deletion">- è¿”å›ç»“æœ</span>

éƒ½åœ¨ä¸€ä¸ªåº”ç”¨é‡Œï¼Œä¸ç”¨è°ƒå¤–éƒ¨æ¥å£
</code></pre>
<p><strong>è·¨ç³»ç»Ÿè°ƒç”¨ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">è®¢å•æµç¨‹ï¼š
<span class="hljs-deletion">- è°ƒåº“å­˜ç³»ç»Ÿï¼ˆHTTPï¼‰</span>
<span class="hljs-deletion">- è°ƒæ”¯ä»˜ç³»ç»Ÿï¼ˆHTTPï¼‰</span>
<span class="hljs-deletion">- è°ƒç‰©æµç³»ç»Ÿï¼ˆHTTPï¼‰</span>

è¦è·¨å¤šä¸ªæœåŠ¡
</code></pre>
<p><strong>å¯¹åº”æ¡†æ¶ï¼š</strong></p>
<ul>
<li>æœ¬åœ° â†’ è¡¨è¾¾å¼ç³»ã€è„šæœ¬ç³»ï¼ˆQLExpressã€LiteFlowï¼‰</li>
<li>è·¨ç³»ç»Ÿ â†’ DAGç³»ã€æœåŠ¡ç¼–æ’ç³»ï¼ˆAirflowã€Temporalï¼‰</li>
</ul>
<h3 data-id="heading-5">é—®é¢˜4ï¼šè‡ªå·±ç©ï¼Œè¿˜æ˜¯è¦æç”Ÿæ€ï¼Ÿ</h3>
<p><strong>è‡ªå·±ç©ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">ä½ çš„å›¢é˜Ÿè‡ªå·±ç»´æŠ¤ï¼š
<span class="hljs-deletion">- è§„åˆ™ä½ ä»¬è‡ªå·±å†™</span>
<span class="hljs-deletion">- ä»£ç ä½ ä»¬è‡ªå·±æ”¹</span>
<span class="hljs-deletion">- ä¸éœ€è¦å¤–éƒ¨å¼€å‘è€…</span>
</code></pre>
<p><strong>æç”Ÿæ€ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">åšå¹³å°ï¼Œè®©åˆ«äººæ‰©å±•ï¼š
<span class="hljs-deletion">- å®¢æˆ·å¯ä»¥ä¸Šä¼ æ’ä»¶</span>
<span class="hljs-deletion">- ç¬¬ä¸‰æ–¹å¯ä»¥å†™è„šæœ¬</span>
<span class="hljs-deletion">- éœ€è¦æ²™ç®±éš”ç¦»</span>
</code></pre>
<p><strong>å¯¹åº”æŠ€æœ¯ï¼š</strong></p>
<ul>
<li>è‡ªå·±ç© â†’ è¡¨è¾¾å¼ + ä»£ç ï¼ˆQLExpressã€Aviatorï¼‰</li>
<li>æç”Ÿæ€ â†’ Groovyè„šæœ¬ã€æ’ä»¶æœºåˆ¶</li>
</ul>
<h2 data-id="heading-6">é‚£äº›è®©äººå¤´ç–¼çš„æ¡†æ¶ï¼Œåˆ°åº•æ˜¯å¹²ä»€ä¹ˆçš„</h2>
<p>å››ä¸ªé—®é¢˜é—®å®Œï¼Œä½ å¤§æ¦‚çŸ¥é“æ–¹å‘äº†ã€‚ç°åœ¨çœ‹çœ‹å…·ä½“æ¡†æ¶éƒ½æ˜¯ä»€ä¹ˆæƒ…å†µã€‚</p>
<p>ä¸ç”¨å…¨çœ‹ï¼Œåªçœ‹å’Œä½ åŒ¹é…çš„é‚£ä¸€ç±»å°±è¡Œã€‚</p>
<h3 data-id="heading-7">BPMNç³»ï¼šFlowableã€Camundaã€Activiti</h3>
<p><strong>é€‚åˆåœºæ™¯ï¼š</strong></p>
<ul>
<li>çº¯äººå·¥å®¡æ‰¹æµç¨‹</li>
<li>éœ€è¦æµç¨‹å›¾å¯è§†åŒ–</li>
<li>éœ€è¦å†å²è®°å½•è¿½æº¯</li>
<li>å¤§å…¬å¸ã€å¼ºåˆè§„è¦æ±‚</li>
</ul>
<p><strong>å…¸å‹ä¾‹å­ï¼š</strong></p>
<ul>
<li>è¯·å‡å®¡æ‰¹</li>
<li>æŠ¥é”€å®¡æ‰¹</li>
<li>åˆåŒå®¡æ‰¹</li>
<li>é‡‡è´­æµç¨‹</li>
</ul>
<p><strong>æ ¸å¿ƒç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>æœ¬è´¨å°±æ˜¯æ”¹çŠ¶æ€</li>
<li>å¤§éƒ¨åˆ†æ—¶é—´åœ¨ç­‰äºº</li>
<li>ä¸šåŠ¡ä»·å€¼ä¸º0ï¼ˆåªæ˜¯æµç¨‹ç®¡ç†ï¼‰</li>
<li>æŠ€æœ¯éš¾åº¦ä¸é«˜ï¼ˆå°±æ˜¯çŠ¶æ€æœºï¼‰</li>
</ul>
<p><strong>ä»€ä¹ˆæ—¶å€™ç”¨ï¼š</strong></p>
<ul>
<li>å¤§å…¬å¸ï¼ˆ100+äººï¼‰ï¼Œæœ‰å‡ åä¸ªå®¡æ‰¹æµç¨‹è¦ç®¡ç†</li>
<li>é‡‘èã€æ”¿åºœç­‰å¼ºåˆè§„è¡Œä¸š</li>
<li>éœ€è¦æ ‡å‡†åŒ–æµç¨‹ç®¡ç†</li>
</ul>
<p><strong>ä»€ä¹ˆæ—¶å€™åˆ«ç”¨ï¼š</strong></p>
<ul>
<li>å°å…¬å¸ï¼ˆåˆ«ç”¨ï¼Œé’‰é’‰å®¡æ‰¹å°±å¤Ÿäº†ï¼‰</li>
<li>æ²¡æœ‰å¤æ‚å®¡æ‰¹éœ€æ±‚ï¼ˆè‡ªå·±å†™100è¡Œä»£ç æå®šï¼‰</li>
<li>ä¸ºäº†"ä¼ä¸šçº§"è€Œç”¨ï¼ˆè¿‡åº¦è®¾è®¡ï¼‰</li>
</ul>
<h3 data-id="heading-8">DAGç³»ï¼šAirflowã€DolphinSchedulerã€Prefect</h3>
<p><strong>é€‚åˆåœºæ™¯ï¼š</strong></p>
<ul>
<li>æ•°æ®å¤„ç†ä»»åŠ¡</li>
<li>ç¦»çº¿æ‰¹å¤„ç†</li>
<li>å®šæ—¶è°ƒåº¦</li>
<li>ä»»åŠ¡æœ‰ä¾èµ–å…³ç³»</li>
</ul>
<p><strong>å…¸å‹ä¾‹å­ï¼š</strong></p>
<ul>
<li>æ•°æ®ETL</li>
<li>æŠ¥è¡¨ç”Ÿæˆ</li>
<li>æ•°æ®æ¸…æ´—</li>
<li>æœºå™¨å­¦ä¹ Pipeline</li>
</ul>
<p><strong>æ ¸å¿ƒç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>çº¯æœºå™¨æ‰§è¡Œ</li>
<li>é•¿æ—¶é—´è¿è¡Œï¼ˆå°æ—¶ã€å¤©çº§ï¼‰</li>
<li>ä»»åŠ¡ä¹‹é—´æœ‰ä¾èµ–ï¼ˆAå®Œæˆæ‰èƒ½Bï¼‰</li>
<li>éœ€è¦è°ƒåº¦å’Œç›‘æ§</li>
</ul>
<p><strong>ä»€ä¹ˆæ—¶å€™ç”¨ï¼š</strong></p>
<ul>
<li>æ•°æ®å›¢é˜Ÿåšç¦»çº¿å¤„ç†</li>
<li>æœ‰å¤æ‚çš„ä»»åŠ¡ä¾èµ–å…³ç³»</li>
<li>éœ€è¦å®šæ—¶è°ƒåº¦ï¼ˆæ¯å¤©ã€æ¯å‘¨ï¼‰</li>
</ul>
<p><strong>ä»€ä¹ˆæ—¶å€™åˆ«ç”¨ï¼š</strong></p>
<ul>
<li>å®æ—¶æ€§è¦æ±‚é«˜çš„ï¼ˆç§’çº§å“åº”ï¼‰</li>
<li>ç®€å•çš„å®šæ—¶ä»»åŠ¡ï¼ˆç”¨Cronå°±å¤Ÿäº†ï¼‰</li>
<li>æ²¡æœ‰ä¾èµ–å…³ç³»çš„ä»»åŠ¡</li>
</ul>
<h3 data-id="heading-9">è¡¨è¾¾å¼/è„šæœ¬ç³»ï¼šQLExpressã€Aviatorã€LiteFlowã€Groovy</h3>
<p><strong>é€‚åˆåœºæ™¯ï¼š</strong></p>
<ul>
<li>è§„åˆ™è®¡ç®—</li>
<li>ä¸šåŠ¡æµç¨‹ç¼–æ’</li>
<li>æœ¬åœ°æ–¹æ³•è°ƒç”¨</li>
<li>éœ€è¦åŠ¨æ€é…ç½®</li>
</ul>
<p><strong>å…¸å‹ä¾‹å­ï¼š</strong></p>
<ul>
<li>è¥é”€æ´»åŠ¨è§„åˆ™ï¼ˆæ»¡å‡ã€æŠ˜æ‰£ï¼‰</li>
<li>é£æ§è§„åˆ™ï¼ˆé»‘åå•ã€è¯„åˆ†ï¼‰</li>
<li>è®¢å•æµç¨‹ï¼ˆæœ¬åœ°ç¼–æ’ï¼‰</li>
<li>ç§¯åˆ†è®¡ç®—</li>
</ul>
<p><strong>QLExpress / Aviatorï¼ˆè¡¨è¾¾å¼ï¼‰ï¼š</strong></p>
<ul>
<li>ä¼˜ç‚¹ï¼šæ€§èƒ½å¥½ã€ç±»Javaè¯­æ³•ã€å›¢é˜Ÿå®¹æ˜“ä¸Šæ‰‹</li>
<li>ç¼ºç‚¹ï¼šåŠŸèƒ½å—é™ã€åªèƒ½ç®€å•è®¡ç®—</li>
<li>é€‚åˆï¼šè‡ªå·±å›¢é˜Ÿç©ã€ç®€å•è§„åˆ™</li>
</ul>
<p><strong>Groovyï¼ˆè„šæœ¬ï¼‰ï¼š</strong></p>
<ul>
<li>ä¼˜ç‚¹ï¼šåŠŸèƒ½å®Œæ•´ã€å¯ä»¥è°ƒå¤æ‚API</li>
<li>ç¼ºç‚¹ï¼šæ€§èƒ½å·®ã€è°ƒè¯•éš¾ã€ç±»å‹ä¸å®‰å…¨</li>
<li>é€‚åˆï¼šè¦ææ’ä»¶ç”Ÿæ€ã€å®¢æˆ·è‡ªå®šä¹‰é€»è¾‘</li>
</ul>
<p><strong>LiteFlowï¼ˆç¼–æ’ï¼‰ï¼š</strong></p>
<ul>
<li>ä¼˜ç‚¹ï¼šå¯è§†åŒ–ç¼–æ’ã€ç»„ä»¶å¤ç”¨</li>
<li>ç¼ºç‚¹ï¼šå­¦ä¹ æˆæœ¬ã€ç»´æŠ¤æˆæœ¬</li>
<li>é€‚åˆï¼šæµç¨‹ç¡®å®å¤æ‚ã€ç»å¸¸å˜åŒ–</li>
</ul>
<p><strong>ä»€ä¹ˆæ—¶å€™ç”¨ï¼š</strong></p>
<ul>
<li>è§„åˆ™ç»å¸¸å˜ï¼ˆä¸æƒ³æ¯æ¬¡æ”¹ä»£ç å‘ç‰ˆï¼‰</li>
<li>æµç¨‹éœ€è¦é…ç½®åŒ–</li>
<li>æœ‰ä¸€å®šå¤æ‚åº¦ï¼ˆ10+ä¸ªåˆ†æ”¯ï¼‰</li>
</ul>
<p><strong>ä»€ä¹ˆæ—¶å€™åˆ«ç”¨ï¼š</strong></p>
<ul>
<li>ç®€å•çš„if-elseï¼ˆç›´æ¥å†™ä»£ç ï¼‰</li>
<li>æµç¨‹å›ºå®šä¸å˜ï¼ˆæ²¡å¿…è¦é…ç½®åŒ–ï¼‰</li>
<li>ä¸ºäº†"çµæ´»"è€Œç‰ºç‰²æ€§èƒ½</li>
</ul>
<h3 data-id="heading-10">æœåŠ¡ç¼–æ’ç³»ï¼šTemporalã€Cadenceã€Conductor</h3>
<p><strong>é€‚åˆåœºæ™¯ï¼š</strong></p>
<ul>
<li>å¾®æœåŠ¡ç¼–æ’</li>
<li>åˆ†å¸ƒå¼äº‹åŠ¡</li>
<li>é•¿æ—¶é—´è¿è¡Œçš„ä¸šåŠ¡æµç¨‹</li>
<li>éœ€è¦è¡¥å¿æœºåˆ¶</li>
</ul>
<p><strong>å…¸å‹ä¾‹å­ï¼š</strong></p>
<ul>
<li>è®¢å•æµç¨‹ï¼ˆæ”¯ä»˜ â†’ å‘è´§ â†’ ç­¾æ”¶ï¼‰</li>
<li>æ—…æ¸¸é¢„è®¢ï¼ˆæœºç¥¨ + é…’åº— + é—¨ç¥¨ï¼‰</li>
<li>è·¨ç³»ç»Ÿæµç¨‹</li>
<li>Sagaæ¨¡å¼</li>
</ul>
<p><strong>æ ¸å¿ƒç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>æ”¯æŒé•¿æ—¶é—´è¿è¡Œï¼ˆå¤©çº§ï¼‰</li>
<li>æ”¯æŒå¤±è´¥é‡è¯•</li>
<li>æ”¯æŒè¡¥å¿é€»è¾‘</li>
<li>çŠ¶æ€æŒä¹…åŒ–</li>
</ul>
<p><strong>ä»€ä¹ˆæ—¶å€™ç”¨ï¼š</strong></p>
<ul>
<li>å¾®æœåŠ¡æ¶æ„ï¼Œéœ€è¦ç¼–æ’å¤šä¸ªæœåŠ¡</li>
<li>éœ€è¦åˆ†å¸ƒå¼äº‹åŠ¡</li>
<li>æµç¨‹å¯èƒ½è¿è¡Œå¾ˆä¹…ï¼ˆå‡ å°æ—¶ã€å‡ å¤©ï¼‰</li>
</ul>
<p><strong>ä»€ä¹ˆæ—¶å€™åˆ«ç”¨ï¼š</strong></p>
<ul>
<li>å•ä½“åº”ç”¨ï¼ˆæ²¡æœ‰è·¨æœåŠ¡éœ€æ±‚ï¼‰</li>
<li>ç®€å•çš„APIè°ƒç”¨ï¼ˆç›´æ¥ç”¨HTTPå°±è¡Œï¼‰</li>
<li>å®æ—¶æ€§è¦æ±‚æé«˜çš„ï¼ˆæ¯«ç§’çº§ï¼‰</li>
</ul>
<h2 data-id="heading-11">æ‡’å¾—çœ‹ï¼Ÿç›´æ¥ç…§è¿™ä¸ªé€‰</h2>
<p>å¦‚æœä½ å«Œä¸Šé¢å†…å®¹å¤ªå¤šï¼Œç›´æ¥çœ‹è¿™ä¸ªå†³ç­–æ ‘ã€‚</p>
<p>è·Ÿç€é—®é¢˜ä¸€æ­¥æ­¥èµ°ï¼Œåˆ°åº•äº†å°±çŸ¥é“è¯¥ç”¨ä»€ä¹ˆã€‚</p>
<pre><code class="hljs">å¼€å§‹
  â†“
ä¸»è¦æ˜¯äººå®¡æ‰¹å—ï¼Ÿ
  â†“ æ˜¯
  ç”¨ Flowable/Camundaï¼ˆå¤§å…¬å¸ï¼‰æˆ–é’‰é’‰å®¡æ‰¹ï¼ˆå°å…¬å¸ï¼‰
  
  â†“ å¦
æ˜¯é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡å—ï¼ˆ&gt;10åˆ†é’Ÿï¼‰ï¼Ÿ
  â†“ æ˜¯
  ç”¨ Airflow/DolphinScheduler
  
  â†“ å¦
éœ€è¦è·¨ç³»ç»Ÿè°ƒç”¨å—ï¼Ÿ
  â†“ æ˜¯
  ç”¨ Temporal/Conductorï¼ˆå¾®æœåŠ¡ï¼‰æˆ– Airflowï¼ˆæ•°æ®å¤„ç†ï¼‰
  
  â†“ å¦
é€»è¾‘å¾ˆå¤æ‚å—ï¼ˆ&gt;10ä¸ªåˆ†æ”¯ï¼‰ï¼Ÿ
  â†“ æ˜¯
  ç”¨ LiteFlowï¼ˆç¼–æ’ï¼‰æˆ– QLExpressï¼ˆè§„åˆ™ï¼‰
  
  â†“ å¦
éœ€è¦é¢‘ç¹ä¿®æ”¹è§„åˆ™å—ï¼Ÿ
  â†“ æ˜¯
  ç”¨ QLExpress/Aviator
  
  â†“ å¦
ç›´æ¥å†™ä»£ç ï¼
</code></pre>
<h2 data-id="heading-12">å…·ä½“åœºæ™¯æ€ä¹ˆé€‰</h2>
<p>ç†è®ºè¯´å®Œäº†ï¼Œçœ‹å‡ ä¸ªå®é™…ä¾‹å­ã€‚çœ‹çœ‹ä½ çš„åœºæ™¯å’Œå“ªä¸ªåƒã€‚</p>
<h3 data-id="heading-13">åœºæ™¯1ï¼šè¯·å‡å®¡æ‰¹</h3>
<p><strong>ç‰¹å¾ï¼š</strong></p>
<ul>
<li>çº¯äººå·¥å®¡æ‰¹</li>
<li>çŠ¶æ€æµè½¬</li>
<li>éœ€è¦å†å²è®°å½•</li>
</ul>
<p><strong>é€‰å‹ï¼š</strong></p>
<ul>
<li>å°å…¬å¸ï¼šé’‰é’‰/ä¼ä¸šå¾®ä¿¡å®¡æ‰¹</li>
<li>å¤§å…¬å¸ï¼šFlowable/Camunda</li>
<li>è‡ªå·±å¼€å‘ï¼šçŠ¶æ€æœº + æ•°æ®åº“</li>
</ul>
<h3 data-id="heading-14">åœºæ™¯2ï¼šç”µå•†è®¢å•æµç¨‹</h3>
<p><strong>ç‰¹å¾ï¼š</strong></p>
<ul>
<li>è¦è°ƒæ”¯ä»˜ã€åº“å­˜ã€ç‰©æµæ¥å£</li>
<li>æœ‰å¤±è´¥é‡è¯•å’Œè¡¥å¿</li>
<li>çŸ­äº‹åŠ¡ï¼ˆåˆ†é’Ÿçº§ï¼‰</li>
</ul>
<p><strong>é€‰å‹ï¼š</strong></p>
<ul>
<li>å¤æ‚åœºæ™¯ï¼šTemporal/Cadence</li>
<li>ç®€å•åœºæ™¯ï¼šLiteFlow + æ¶ˆæ¯é˜Ÿåˆ—</li>
<li>æœ€ç®€å•ï¼šç›´æ¥å†™ä»£ç  + çŠ¶æ€æœº</li>
</ul>
<h3 data-id="heading-15">åœºæ™¯3ï¼šæ•°æ®ETL</h3>
<p><strong>ç‰¹å¾ï¼š</strong></p>
<ul>
<li>çº¯æœºå™¨æ‰§è¡Œ</li>
<li>é•¿æ—¶é—´è¿è¡Œ</li>
<li>ä»»åŠ¡æœ‰ä¾èµ–</li>
</ul>
<p><strong>é€‰å‹ï¼š</strong></p>
<ul>
<li>æ ‡å‡†æ–¹æ¡ˆï¼šAirflow/DolphinScheduler</li>
<li>ç®€å•åœºæ™¯ï¼šXXL-Job</li>
</ul>
<h3 data-id="heading-16">åœºæ™¯4ï¼šè¥é”€æ´»åŠ¨è§„åˆ™</h3>
<p><strong>ç‰¹å¾ï¼š</strong></p>
<ul>
<li>è§„åˆ™è®¡ç®—</li>
<li>ç»å¸¸å˜åŒ–</li>
<li>æœ¬åœ°æ–¹æ³•</li>
</ul>
<p><strong>é€‰å‹ï¼š</strong></p>
<ul>
<li>ç®€å•è§„åˆ™ï¼šQLExpress/Aviator</li>
<li>å¤æ‚è§„åˆ™ï¼šDrools</li>
<li>æœ‰ç¼–æ’éœ€æ±‚ï¼šLiteFlow</li>
</ul>
<h2 data-id="heading-17">å¾ˆå¤šäººè¸©è¿‡çš„å‘</h2>
<p>è¯´å‡ ä¸ªå¸¸è§çš„é”™è¯¯ï¼Œåˆ«é‡å¤è¸©å‘ã€‚</p>
<h3 data-id="heading-18">è¯¯åŒº1ï¼šè¿½æ±‚"ä¼ä¸šçº§æ¶æ„"</h3>
<pre><code class="hljs">é”™è¯¯åšæ³•ï¼š
20äººçš„åˆ›ä¸šå…¬å¸ï¼Œä¸Šäº†Flowableã€Camundaã€Airflowä¸€æ•´å¥—

æ­£ç¡®åšæ³•ï¼š
èƒ½ç”¨100è¡Œä»£ç è§£å†³å°±åˆ«ä¸Šæ¡†æ¶
</code></pre>
<h3 data-id="heading-19">è¯¯åŒº2ï¼šä¸ºäº†çµæ´»æ€§è€Œç‰ºç‰²æ€§èƒ½</h3>
<pre><code class="hljs">é”™è¯¯åšæ³•ï¼š
æ‰€æœ‰é€»è¾‘éƒ½ç”¨Groovyè„šæœ¬ï¼Œæ–¹ä¾¿ä¿®æ”¹

æ­£ç¡®åšæ³•ï¼š
æ ¸å¿ƒé€»è¾‘ç”¨Javaå†™ï¼ŒåªæŠŠç»å¸¸å˜çš„éƒ¨åˆ†é…ç½®åŒ–
</code></pre>
<h3 data-id="heading-20">è¯¯åŒº3ï¼šè¿‡åº¦æŠ½è±¡</h3>
<pre><code class="hljs language-arduino" lang="arduino">é”™è¯¯åšæ³•ï¼š
<span class="hljs-number">3</span>ä¸ªç®€å•æµç¨‹ï¼Œéè¦æä¸ª<span class="hljs-string">"æµç¨‹å¼•æ“"</span>

æ­£ç¡®åšæ³•ï¼š
<span class="hljs-number">3</span>ä¸ªæµç¨‹å°±<span class="hljs-number">3</span>ä¸ªæ–¹æ³•ï¼Œç›´æ¥å†™ä»£ç 
</code></pre>
<h3 data-id="heading-21">è¯¯åŒº4ï¼šæ··æ·†æ¦‚å¿µ</h3>
<pre><code class="hljs language-arduino" lang="arduino">é”™è¯¯ç†è§£ï¼š
<span class="hljs-string">"æˆ‘éœ€è¦æµç¨‹ç¼–æ’ï¼Œæ‰€ä»¥è¦ç”¨Flowable"</span>

æ­£ç¡®ç†è§£ï¼š
å…ˆææ¸…æ¥šä½ è¦å¹²æ´»è¿˜æ˜¯æ”¹çŠ¶æ€
æ˜¯äººå®¡æ‰¹è¿˜æ˜¯æœºå™¨æ‰§è¡Œ
</code></pre>
<h2 data-id="heading-22">å‡ å¥å¤§å®è¯</h2>
<p>æœ€åè¯´å‡ å¥æå¿ƒçªçš„è¯ã€‚</p>
<h3 data-id="heading-23">1. å…ˆç”¨æœ€ç®€å•çš„æ–¹æ¡ˆ</h3>
<pre><code class="hljs language-erlang" lang="erlang">é‡åˆ°é—®é¢˜ï¼š
ç¬¬ä¸€ååº”ä¸æ˜¯<span class="hljs-string">"ä¸Šæ¡†æ¶"</span>
è€Œæ˜¯<span class="hljs-string">"èƒ½ä¸èƒ½å†™100è¡Œä»£ç æå®š"</span>

<span class="hljs-number">90</span><span class="hljs-comment">%çš„æƒ…å†µï¼Œ100è¡Œä»£ç å°±å¤Ÿäº†</span>
</code></pre>
<h3 data-id="heading-24">2. é‡åˆ°ç“¶é¢ˆå†ä¼˜åŒ–</h3>
<pre><code class="hljs">æµç¨‹å¾ˆä¹±äº† â†’ é‡æ„ä»£ç 
æ”¹åŠ¨å¾ˆé¢‘ç¹ â†’ è€ƒè™‘é…ç½®åŒ–
ç®¡ç†ä¸è¿‡æ¥ â†’ è€ƒè™‘æ¡†æ¶

åˆ«æå‰ä¼˜åŒ–
</code></pre>
<h3 data-id="heading-25">3. æ ¹æ®å›¢é˜Ÿè§„æ¨¡é€‰æ‹©</h3>
<pre><code class="hljs language-diff" lang="diff">å°å›¢é˜Ÿï¼ˆ&lt;20äººï¼‰ï¼š
<span class="hljs-deletion">- èƒ½ä¸ç”¨æ¡†æ¶å°±ä¸ç”¨</span>
<span class="hljs-deletion">- é’‰é’‰å®¡æ‰¹ã€Cronã€ç›´æ¥å†™ä»£ç </span>

ä¸­ç­‰å›¢é˜Ÿï¼ˆ20-100äººï¼‰ï¼š
<span class="hljs-deletion">- æµç¨‹&lt;10ä¸ªï¼šè‡ªå·±å†™</span>
<span class="hljs-deletion">- æµç¨‹&gt;10ä¸ªï¼šè€ƒè™‘è½»é‡çº§æ¡†æ¶</span>

å¤§å›¢é˜Ÿï¼ˆ&gt;100äººï¼‰ï¼š
<span class="hljs-deletion">- éœ€è¦æ ‡å‡†åŒ–ç®¡ç†</span>
<span class="hljs-deletion">- å¯ä»¥è€ƒè™‘æˆç†Ÿæ¡†æ¶</span>
</code></pre>
<h3 data-id="heading-26">4. çœ‹ä¸šåŠ¡ç‰¹ç‚¹</h3>
<pre><code class="hljs language-diff" lang="diff">å¼ºåˆè§„ï¼ˆé‡‘èã€æ”¿åºœï¼‰ï¼š
<span class="hljs-deletion">- å¿…é¡»ç”¨æ ‡å‡†åŒ–å·¥å…·</span>
<span class="hljs-deletion">- Flowableæ˜¯é€‰æ‹©ä¹‹ä¸€</span>

æ•°æ®å¯†é›†ï¼š
<span class="hljs-deletion">- Airflowæ˜¯æ ‡å‡†æ–¹æ¡ˆ</span>

å¾®æœåŠ¡æ¶æ„ï¼š
<span class="hljs-deletion">- Temporalå€¼å¾—è€ƒè™‘</span>

ç®€å•CRUDï¼š
<span class="hljs-deletion">- åˆ«æŠ˜è…¾ï¼Œå†™ä»£ç </span>
</code></pre>
<h2 data-id="heading-27">è¯´åˆ°åº•ï¼Œå°±è¿™ä¹ˆç‚¹äº‹</h2>
<p>çœ‹å®Œè¿˜è§‰å¾—å¤æ‚ï¼Ÿé‚£å°±è®°ä½è¿™å››ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>å¹²æ´»è¿˜æ˜¯æ”¹çŠ¶æ€ï¼Ÿ</li>
<li>äººä¸ºä¸»è¿˜æ˜¯æœºå™¨ä¸ºä¸»ï¼Ÿ</li>
<li>æœ¬åœ°æ–¹æ³•è¿˜æ˜¯è·¨ç³»ç»Ÿï¼Ÿ</li>
<li>è‡ªå·±ç©è¿˜æ˜¯æç”Ÿæ€ï¼Ÿ</li>
</ol>
<p>å››ä¸ªé—®é¢˜é—®å®Œï¼ŒåŸºæœ¬å°±çŸ¥é“è¯¥ç”¨ä»€ä¹ˆäº†ã€‚</p>
<p>é‚£äº›"ä¼ä¸šçº§"ã€"å…ˆè¿›æ¶æ„"ã€"çµæ´»æ‰©å±•"çš„è¯ï¼Œéƒ½æ˜¯åŒ…è£…ã€‚</p>
<p>çœ‹é€æœ¬è´¨ï¼Œåˆ«è¢«å¿½æ‚ ã€‚</p>
<p>èƒ½ç”¨100è¡Œä»£ç è§£å†³çš„ï¼Œå°±åˆ«ä¸Šæ¡†æ¶ã€‚</p>
<p>æŠ€æœ¯æ˜¯ä¸ºä¸šåŠ¡æœåŠ¡çš„ï¼Œä¸æ˜¯ä¸ºäº†ç‚«æŠ€ã€‚</p>
<p>åŠ¡å®ç‚¹ï¼Œåˆ«æ•´é‚£äº›è™šçš„ã€‚</p>
<p>å°±è¿™æ ·ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Streamæ˜¯æ€ä¹ˆè¿è¡Œçš„ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7587239837973184563</link>    <guid>https://juejin.cn/post/7587239837973184563</guid>    <pubDate>2025-12-24T13:43:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587239837973184563" data-draft-id="7587254134401155081" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Streamæ˜¯æ€ä¹ˆè¿è¡Œçš„ï¼Ÿ"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-24T13:43:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†æ¥ä¸€æ ¹è¾£æ¡"/> <meta itemprop="url" content="https://juejin.cn/user/3625525962110588"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Streamæ˜¯æ€ä¹ˆè¿è¡Œçš„ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3625525962110588/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†æ¥ä¸€æ ¹è¾£æ¡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T13:43:15.000Z" title="Wed Dec 24 2025 13:43:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å…ˆçœ‹è¿™æ®µæ ·ä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java">        <span class="hljs-type">var</span> <span class="hljs-variable">al</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;String&gt;();
        al.add(<span class="hljs-string">"Hello"</span>);
        al.add(<span class="hljs-string">"world"</span>);
        al.stream().map(String::toUpperCase).forEach(System.out::println);
</code></pre>
<h2 data-id="heading-0">1 åˆ›å»ºæµ</h2>
<p>æ ·ä¾‹ä»£ç åˆ›å»ºä¸€ä¸ª <code>ArrayList</code>â€‹ å®ä¾‹ï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºæµè¿›è¡Œæ•°æ®å¤„ç†ã€‚<code>stream()</code>â€‹ æ–¹æ³•æºè‡ª <code>Collection</code> æ¥å£ã€‚è‡ª Java 8 èµ·ï¼Œè¯¥æ¥å£ä¸ºé€‚é… Stream æ–°å¢äº†å‡ ä¸ªè½¬æ¢æ–¹æ³•ã€‚</p>
<p>ä»£ç 1-1ï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-keyword">default</span> Stream&lt;E&gt; <span class="hljs-title function_">stream</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> StreamSupport.stream(spliterator(), <span class="hljs-literal">false</span>);
    }
    <span class="hljs-keyword">default</span> Stream&lt;E&gt; <span class="hljs-title function_">parallelStream</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> StreamSupport.stream(spliterator(), <span class="hljs-literal">true</span>);
    }
	<span class="hljs-comment">// è¿™æ˜¯ç»§æ‰¿è‡ª Iterable æ¥å£çš„æ–¹æ³•</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">default</span> Spliterator&lt;E&gt; <span class="hljs-title function_">spliterator</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> Spliterators.spliterator(<span class="hljs-built_in">this</span>, <span class="hljs-number">0</span>);
    }

</code></pre>
<p>ä¸ºä¿æŒå‘åå…¼å®¹ï¼Œè¿™äº›æ–°å¢æ–¹æ³•å‡æä¾›äº†é»˜è®¤å®ç°ã€‚<code>java.util.stream.StreamSupport</code>â€‹ æ˜¯æ“ä½œæµçš„å·¥å…·ç±»ï¼Œè¯¥ç±»åœ¨ Stream å†…éƒ¨ä»£ç ä¸­è¢«é¢‘ç¹ä½¿ç”¨ï¼Œä½†é€šå¸¸çš„ä¸šåŠ¡ä»£ç æ— éœ€ç›´æ¥è°ƒç”¨ã€‚è‡³äºå…¶ä¸­è°ƒç”¨çš„ <code>spliterator()</code> æ–¹æ³•ï¼Œåˆ™å¼•å…¥äº†ä¸€ä¸ªæ–°æ¦‚å¿µã€‚</p>
<h3 data-id="heading-1">1.1 Spliterator</h3>
<p>â€œæ‹†åˆ†å™¨â€ï¼ˆæœ¬æ–‡ä½¿ç”¨è¯‘åï¼‰ä»¥æ¥å£å½¢å¼å‡ºç°ï¼Œ<code>java.util.Spliterator</code>ã€‚å®˜æ–¹æ–‡æ¡£å¯¹æ­¤æ¥å£è¯´æ˜ä¸ºï¼š</p>
<blockquote>
<p>ç”¨äºéå†å’Œåˆ†å‰²æºå…ƒç´ çš„å¯¹è±¡ã€‚Spliterator æ‰€è¦†ç›–å…ƒç´ çš„æºå¯ä»¥æ˜¯æ•°ç»„ã€é›†åˆã€IO é€šé“æˆ–ç”Ÿæˆå‡½æ•°ã€‚</p>
<p>æ‹†åˆ†å™¨å¯é€ä¸ªéå†å…ƒç´ ï¼ˆ<code>tryAdvance()</code>â€‹ ï¼‰ï¼Œä¹Ÿå¯æ‰¹é‡é¡ºåºéå†ï¼ˆ<code>forEachRemaining()</code>ï¼‰ã€‚</p>
</blockquote>
<p>ä¸»è¦æ–¹æ³•æœ‰ï¼Œä»£ç 1-2ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Spliterator</span>&lt;T&gt; {
	<span class="hljs-comment">// æ¶ˆè´¹æ‹†åˆ†å™¨ä¸­ä¸€ä¸ªå…ƒç´ </span>
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAdvance</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> T&gt; action)</span>;

	<span class="hljs-comment">// æ¶ˆè´¹æ‹†åˆ†å™¨ä¸­å‰©ä½™æ‰€æœ‰å…ƒç´ </span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forEachRemaining</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> T&gt; action)</span> {
        <span class="hljs-keyword">do</span> { } <span class="hljs-keyword">while</span> (tryAdvance(action));
    }
	
	<span class="hljs-comment">// åˆ†å‡ºè‡ªèº«éƒ¨åˆ†å…ƒç´ åˆ°ä¸€ä¸ªæ–°å®ä¾‹</span>
    Spliterator&lt;T&gt; <span class="hljs-title function_">trySplit</span><span class="hljs-params">()</span>;

	<span class="hljs-comment">// å½“å‰æ‹†åˆ†å™¨ä¸­é¢„ä¼°å…ƒç´ æ•°é‡</span>
    <span class="hljs-type">long</span> <span class="hljs-title function_">estimateSize</span><span class="hljs-params">()</span>;

    <span class="hljs-keyword">default</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getExactSizeIfKnown</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> (characteristics() &amp; SIZED) == <span class="hljs-number">0</span> ? -<span class="hljs-number">1L</span> : estimateSize();
    }

	<span class="hljs-comment">// å½“å‰æ‹†åˆ†å™¨çš„ ç‰¹è´¨</span>
    <span class="hljs-type">int</span> <span class="hljs-title function_">characteristics</span><span class="hljs-params">()</span>;
}
</code></pre>
<p>ç‰¹åˆ«åœ°ï¼Œæ‹†åˆ†å™¨çš„ç‰¹è´¨æ˜¯é€šè¿‡ä¸€ç»„äºŒè¿›åˆ¶ä½ï¼ˆå¦‚ <code>ORDERED</code>â€‹ã€<code>DISTINCT</code>â€‹ã€<code>SORTED</code> ç­‰ï¼‰æ¥è¡¨ç¤ºå½“å‰æ•°æ®é›†çš„ä¸€äº›ç‰¹æ€§ï¼Œè¿™éƒ¨åˆ†è®¡ç®—è¾ƒä¸ºå¤æ‚ï¼Œæœ¬æ–‡ä¸ä½œæ·±å…¥æ¢è®¨ã€‚</p>
<p>â€‹<code>Iterable</code>â€‹ æ¥å£è‡ª Java 8 èµ·æ–°å¢äº† <code>spliterator()</code> æ–¹æ³•ï¼Œå®ç°äº†ä»â€œè¿­ä»£å™¨â€åˆ°â€œæ‹†åˆ†å™¨â€çš„è½¬æ¢ã€‚å…¶é»˜è®¤å®ç°å¦‚ä»£ç 1-3æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-keyword">default</span> Spliterator&lt;T&gt; <span class="hljs-title function_">spliterator</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> Spliterators.spliteratorUnknownSize(iterator(), <span class="hljs-number">0</span>);
    }
</code></pre>
<p>â€‹<code>Spliterators</code>â€‹ æ˜¯ä¸€ä¸ªç”¨äºæ“ä½œæˆ–åˆ›å»ºæ‹†åˆ†å™¨çš„å·¥å…·ç±»ï¼Œé€šå¸¸ä¸šåŠ¡ä»£ç ä¸­ä¸ä¼šç›´æ¥ä½¿ç”¨ã€‚å°½ç®¡æ¥å£æä¾›äº†é»˜è®¤å®ç°ï¼Œä½† JDK ä¸­æ¯ä¸ªå…·ä½“çš„é›†åˆç±»å‹éƒ½ä¼šæ ¹æ®è‡ªèº«ç‰¹ç‚¹é‡å†™æ­¤æ–¹æ³•ã€‚è¿™é‡Œä»¥æœ€ç†Ÿæ‚‰çš„ <code>ArrayList</code> ä¸ºä¾‹ï¼Œè§‚å¯Ÿå…¶æ‹†åˆ†å™¨çš„å·¥ä½œæ–¹å¼ï¼Œå¦‚ä»£ç 1-4æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-keyword">public</span> Spliterator&lt;E&gt; <span class="hljs-title function_">spliterator</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayListSpliterator</span>(<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);
    }

    <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ArrayListSpliterator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Spliterator</span>&lt;E&gt; {
        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> index; <span class="hljs-comment">// current index, modified on advance/split</span>
        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> fence; <span class="hljs-comment">// -1 until used; then one past last index</span>
        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> expectedModCount; <span class="hljs-comment">// initialized when fence set</span>

        ArrayListSpliterator(<span class="hljs-type">int</span> origin, <span class="hljs-type">int</span> fence, <span class="hljs-type">int</span> expectedModCount) {
            <span class="hljs-built_in">this</span>.index = origin;
            <span class="hljs-built_in">this</span>.fence = fence;
            <span class="hljs-built_in">this</span>.expectedModCount = expectedModCount;
        }
        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getFence</span><span class="hljs-params">()</span> { <span class="hljs-comment">// initialize fence to size on first use</span>
            <span class="hljs-type">int</span> hi; <span class="hljs-comment">// (a specialized variant appears in method forEach)</span>
            <span class="hljs-keyword">if</span> ((hi = fence) &lt; <span class="hljs-number">0</span>) {
                expectedModCount = modCount;
                hi = fence = size;
            }
            <span class="hljs-keyword">return</span> hi;
        }
        <span class="hljs-keyword">public</span> ArrayListSpliterator <span class="hljs-title function_">trySplit</span><span class="hljs-params">()</span> {
            <span class="hljs-type">int</span> <span class="hljs-variable">hi</span> <span class="hljs-operator">=</span> getFence(), lo = index, mid = (lo + hi) &gt;&gt;&gt; <span class="hljs-number">1</span>;
            <span class="hljs-keyword">return</span> (lo &gt;= mid) ? <span class="hljs-literal">null</span> : <span class="hljs-comment">// divide range in half unless too small</span>
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayListSpliterator</span>(lo, index = mid, expectedModCount);
        }
        <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAdvance</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> E&gt; action)</span> {
            <span class="hljs-keyword">if</span> (action == <span class="hljs-literal">null</span>)
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();
            <span class="hljs-type">int</span> <span class="hljs-variable">hi</span> <span class="hljs-operator">=</span> getFence(), i = index;
            <span class="hljs-keyword">if</span> (i &lt; hi) {
                index = i + <span class="hljs-number">1</span>;
                <span class="hljs-meta">@SuppressWarnings("unchecked")</span> <span class="hljs-type">E</span> <span class="hljs-variable">e</span> <span class="hljs-operator">=</span> (E)elementData[i];
                action.accept(e);
                <span class="hljs-keyword">if</span> (modCount != expectedModCount)
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
	}
</code></pre>
<p>â€‹<code>ArrayListSpliterator</code>â€‹ ç±»çš„å®ç°åŸºäºäºŒåˆ†æŸ¥æ‰¾çš„æ€æƒ³ã€‚<code>index</code>â€‹ å¯ç†è§£ä¸ºèµ·å§‹ä½ç½®ç´¢å¼•ï¼Œ<code>fence</code>â€‹ å¯ç†è§£ä¸ºç»“æŸä½ç½®ç´¢å¼•ï¼Œ<code>expectedModCount</code>â€‹ åˆ™è®°å½•äº† <code>ArrayList</code>â€‹ ä¸­ç”¨äºå¿«é€Ÿå¤±è´¥æ£€æµ‹çš„ <code>modCount</code>â€‹ å˜é‡çš„å€¼ã€‚<code>getFence</code>â€‹ æ–¹æ³•çš„ä½œç”¨æ˜¯åˆå§‹åŒ– <code>fence</code>â€‹ å’Œ <code>expectedModCount</code>ã€‚</p>
<p>â€‹<code>trySplit</code> æ–¹æ³•å¯¹æŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ è¿›è¡ŒäºŒåˆ†ã€‚å…·ä½“è¿‡ç¨‹å¯é€šè¿‡ä»¥ä¸‹ä»£ç æ¼”ç¤ºï¼š</p>
<pre><code class="hljs language-java" lang="java">        <span class="hljs-type">var</span> <span class="hljs-variable">al</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Integer&gt;(List.of(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>));
        <span class="hljs-type">var</span> <span class="hljs-variable">s0</span> <span class="hljs-operator">=</span> al.spliterator();  <span class="hljs-comment">// 3 4 5 </span>
        <span class="hljs-type">var</span> <span class="hljs-variable">s1</span> <span class="hljs-operator">=</span> s0.trySplit(); <span class="hljs-comment">// 2</span>
        <span class="hljs-type">var</span> <span class="hljs-variable">s2</span> <span class="hljs-operator">=</span> s1.trySplit(); <span class="hljs-comment">// 1</span>
</code></pre>
<p>â€‹<code>s0</code>â€‹ æœ€åˆä» <code>al</code>â€‹ ä¸­è·å–å…¨éƒ¨å…ƒç´ ï¼Œè°ƒç”¨ä¸€æ¬¡ <code>trySplit</code>â€‹ æ–¹æ³•åï¼Œå°†å…ƒç´  <code>1, 2</code>â€‹ åˆ†é…ç»™äº†å˜é‡ <code>s1</code>â€‹ã€‚å˜é‡ <code>s1</code>â€‹ å†æ¬¡è°ƒç”¨ <code>trySplit</code>â€‹ æ–¹æ³•ï¼Œå°†å…ƒç´  <code>1</code>â€‹ åˆ†é…ç»™äº†å˜é‡ <code>s2</code>â€‹ã€‚å¯¹äºå•å…ƒå¤§å°çš„æ‹†åˆ†å™¨ï¼ˆå¦‚ <code>s1</code>â€‹ã€<code>s2</code>â€‹ï¼‰ï¼Œå†æ¬¡è°ƒç”¨ <code>trySplit</code>â€‹ æ–¹æ³•å°†è¿”å› <code>null</code>ã€‚</p>
<p>â€‹<code>ArrayList</code>â€‹ çš„ <code>forEachRemaining</code> æ–¹æ³•åŸºäºæ•°ç»„ç´¢å¼•å®ç°ï¼Œå…¶æ•ˆæœä¸æ¥å£çš„é»˜è®¤å®ç°ä¸€è‡´ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚</p>
<blockquote>
<p>[!IMPORTANT] â— æ³¨æ„
æ‹†åˆ†å™¨åªèƒ½éå†ä¸€æ¬¡ï¼Œå³è¯»æŒ‡é’ˆåªèƒ½å‘å‰èµ°ï¼Œæ²¡é‡ç½®è¯»æŒ‡é’ˆä½ç½®çš„æ–¹æ³•ã€‚</p>
</blockquote>
<p>åç»­çœ‹åˆ°<code>Spliterator</code>â€‹ç›¸å…³çš„ä»£ç ï¼ŒåŸºæœ¬å¯ä»¥ç®€å•ç†è§£ä¸ºâ€œæ•°æ®æºâ€ï¼Œä¾‹å¦‚åœ¨æ ·ä¾‹ä»£ç ä¸­å®ƒå°±ä»£è¡¨<code>ArrayList</code>å®ä¾‹ã€‚</p>
<h2 data-id="heading-2">2 æ“ä½œæµæ°´çº¿</h2>
<p>åœ¨å¼€å¤´çš„æ ·ä¾‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>map(String::toUpperCase)</code>â€‹ æ¥æ“ä½œæ•°æ®ã€‚<code>String::toUpperCase</code>â€‹ æ˜¯ Java ä¸­çš„æ–¹æ³•å¼•ç”¨ï¼Œä½œç”¨æ˜¯å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™å½¢å¼ã€‚è€Œ <code>map</code> æ–¹æ³•åˆ™æ˜¯ Stream æ¥æ”¶æ•°æ®å¤„ç†é€»è¾‘çš„å…¥å£ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ¢ç©¶æ•°æ®çš„â€œæ“ä½œâ€æ˜¯å¦‚ä½•è¢«å¤„ç†çš„ã€‚</p>
<p>è‡³äºä¸ºä»€ä¹ˆé€‰æ‹©è¿™å››ä¸ªç±»å‹ï¼Œå®˜æ–¹çš„è§£é‡Šæ˜¯ï¼šJava ä¸­çš„å…¶ä»–ç±»å‹éƒ½å¯ä»¥è½¬åŒ–ä¸ºè¿™å››ä¸ªç±»å‹ï¼Œä»è€Œåœ¨æ•ˆç‡ä¸ä»£ç ä¼˜é›…ä¹‹é—´å–å¾—å¹³è¡¡ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœä¸€ä¸ªæ¥å£éœ€è¦ä¸ºæ‰€æœ‰ç±»å‹éƒ½ç¼–å†™ç‹¬ç«‹çš„å®ç°ï¼Œé‚£å¾—å†™9ä»½çœ‹èµ·æ¥æœ‰ç‚¹ğŸ¤ªã€‚</p>
<p>å¯¹äºæ ·ä¾‹ä»£ç æ¥è¯´ï¼Œ<code>java.util.stream.Stream#map</code>â€‹ æ–¹æ³•çš„å®ç°å¯ä»¥åœ¨<code>ReferencePipeline</code>ç±»ä¸­æ‰¾åˆ°ã€‚</p>
<h3 data-id="heading-3">2.1 ReferencePipeline ç‰¹åŒ–ç±»</h3>
<p>â€‹<code>ReferencePipeline</code>â€‹ ç±»å¯¹åº”å¼•ç”¨ç±»å‹çš„ç‰¹åŒ–å®ç°ï¼Œé€šå¸¸ä¸šåŠ¡ä»£ç ä¸­ä¹Ÿæ˜¯è¿™ä¸ªç±»è¿è¡Œå¾—æœ€å¤šã€‚å…¶ <code>map</code> æ–¹æ³•çš„å®ç°å¦‚ä»£ç 2-1æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> &lt;R&gt; Stream&lt;R&gt; <span class="hljs-title function_">map</span><span class="hljs-params">(Function&lt;? <span class="hljs-built_in">super</span> P_OUT, ? extends R&gt; mapper)</span> {
        Objects.requireNonNull(mapper);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StatelessOp</span>&lt;P_OUT, R&gt;(<span class="hljs-built_in">this</span>, StreamShape.REFERENCE,
                                     StreamOpFlag.NOT_SORTED | StreamOpFlag.NOT_DISTINCT) {
            <span class="hljs-meta">@Override</span>
            Sink&lt;P_OUT&gt; <span class="hljs-title function_">opWrapSink</span><span class="hljs-params">(<span class="hljs-type">int</span> flags, Sink&lt;R&gt; sink)</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sink</span>.ChainedReference&lt;P_OUT, R&gt;(sink) {
                    <span class="hljs-meta">@Override</span>
                    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(P_OUT u)</span> {
                        downstream.accept(mapper.apply(u));
                    }
                };
            }
        };
    }
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¼ å…¥çš„â€œæ“ä½œâ€é€»è¾‘è¢«åŒ…è£…è¿›ä¸€ä¸ª <code>StatelessOp</code> ç±»å®ä¾‹å¹¶è¿”å›ã€‚</p>
<h4 data-id="heading-4">2.1.1 StatelessOpç±»</h4>
<p>â€‹<code>StatelessOp</code>â€‹ ç±»ï¼Œé¡¾åæ€ä¹‰ï¼Œä»£è¡¨æ— çŠ¶æ€æ“ä½œï¼Œå®ƒæ˜¯ <code>ReferencePipeline</code>â€‹ çš„ä¸€ä¸ªå†…éƒ¨ç±»ã€‚å¾ˆå®¹æ˜“è”æƒ³åˆ°ï¼Œåº”è¯¥è¿˜æœ‰è¡¨ç¤ºæœ‰çŠ¶æ€æ“ä½œçš„ç±»ï¼š<code>StatefulOp</code>ã€‚æœ‰çŠ¶æ€è®¡ç®—è¾ƒä¸ºå¤æ‚ï¼Œæœ¬æ–‡ä¸ä¼šæ¶‰åŠï¼Œä¸»è¦å…³æ³¨æ— çŠ¶æ€è®¡ç®—çš„æƒ…å†µã€‚</p>
<blockquote>
<p>[!TIP]
æ— çŠ¶æ€ï¼šå…ƒç´ å¤„ç†äº’ä¸ä¾èµ–ï¼›æœ‰çŠ¶æ€ï¼šéœ€è¦çŸ¥é“å…¶ä»–å…ƒç´ çš„ä¿¡æ¯ï¼Œå¦‚<code>sorted</code>ã€‚</p>
</blockquote>
<p>â€‹<code>StatelessOp</code> ç±»çš„ç»§æ‰¿å…³ç³»ï¼Œå›¾2-1ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">classDiagram
    class PipelineHelper {
        &lt;&gt;
    }
    
    class BaseStream~T, S~ {
        &lt;&gt;
    }
    
    class AbstractPipeline~E_IN, E_OUT, S~ {
        &lt;&gt;
    }
    
    class ReferencePipeline~P_IN, P_OUT~ {
        &lt;&gt;
    }
    
    class StatelessOp~E_IN, E_OUT~ {
        &lt;&gt;
        &lt;&gt;
    }
    
    class Stream~T~ {
        &lt;&gt;
    }
    
    PipelineHelper &lt;|-- AbstractPipeline : ç»§æ‰¿
    BaseStream &lt;|.. AbstractPipeline : å®ç°
    BaseStream &lt;|.. Stream : ç»§æ‰¿
    Stream &lt;|.. ReferencePipeline : å®ç°
    AbstractPipeline &lt;|-- ReferencePipeline : ç»§æ‰¿
    ReferencePipeline &lt;|-- StatelessOp : ç»§æ‰¿
    
</code></pre>
<p>è¿™ä¸ªç»§æ‰¿å…³ç³»å¾ˆé‡è¦ï¼Œåé¢éœ€è¦ä¸æ—¶å›é¡¾ã€‚</p>
<p>â€‹<code>StatelessOp</code> ç±»çš„å£°æ˜ï¼Œä»£ç 2-2ï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StatelessOp</span>&lt;E_IN, E_OUT&gt;
            <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ReferencePipeline</span>&lt;E_IN, E_OUT&gt; {
        StatelessOp(AbstractPipeline&lt;?, E_IN, ?&gt; upstream,
                    StreamShape inputShape,
                    <span class="hljs-type">int</span> opFlags) {
            <span class="hljs-built_in">super</span>(upstream, opFlags);
            <span class="hljs-keyword">assert</span> upstream.getOutputShape() == inputShape;
        }
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">opIsStateful</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
</code></pre>
<p>â€‹<code>StreamShape</code>â€‹ æ˜¯ä¸€ä¸ªæšä¸¾ï¼Œåˆ—ä¸¾äº†å‰é¢æåˆ°çš„å››ç§æ•°æ®ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºå½“å‰æ•°æ®æµä¸­çš„å…ƒç´ ç±»å‹ã€‚<code>StreamOpFlag</code>â€‹ ä¹Ÿæ˜¯ä¸€ä¸ªæšä¸¾ï¼ˆå…¶æ³¨é‡Šè¿œæ¯”ä»£ç ä¸°å¯Œï¼‰ï¼Œç”¨äºè¡¨ç¤ºæ•°æ®æµçš„å„ç§ç‰¹è´¨ã€‚è‡³äºä»£ç 2-1ä¸­å®ç°çš„ <code>opWrapSink</code>â€‹ æ–¹æ³•ï¼Œåˆ™å®šä¹‰åœ¨å…¶çˆ¶ç±» <code>AbstractPipeline</code> ä¸­ï¼Œå¦‚ä»£ç 2-3æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-keyword">abstract</span> Sink&lt;E_IN&gt; <span class="hljs-title function_">opWrapSink</span><span class="hljs-params">(<span class="hljs-type">int</span> flags, Sink&lt;E_OUT&gt; sink)</span>;
</code></pre>
<p>æ­¤æ–¹æ³•çš„å…·ä½“ä½œç”¨æˆ‘ä»¬ç¨åå†è°ˆã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ <code>Sink.ChainedReference</code> ç±»ã€‚</p>
<h3 data-id="heading-5">2.2 Sink</h3>
<p>Sinkè¿™ä¸ªè¯æ•°æ®å¤„ç†ç›¸å…³çš„ç¨‹åºä¸­æ‹¿æ¥ä½œæœ¯è¯­ï¼ˆflinkä¸­ä¹Ÿæœ‰ï¼‰ï¼ŒåŠ¨è¯å½¢å¼æœ‰â€œä¸‹æ²‰; åä¸‹; å‡å¼±; æŒ–æ˜; ä½¿å—æŒ«; å‡»çƒå…¥æ´; çŒâ€ç­‰æ„æ€ï¼›åè¯å½¢å¼å¸¸ä¸ºâ€œæ´—æ¶¤æ± â€ä¹‹æ„ã€‚åœ¨æ•°æ®å¤„ç†ä¸­ï¼Œè¿™ä¸ªè¯ä»£è¡¨çš„æ¦‚å¿µå¸¸æ˜¯æ•°æ®å¤„ç†çš„æœ€åä¸€æ­¥ã€‚</p>
<p>â€‹<code>java.util.stream.Sink</code>â€‹æ¥å£æ˜¯å¢å¼ºç‰ˆçš„<code>Consumer</code>ï¼ˆæ¶ˆè´¹è€…ï¼‰ï¼Œè´Ÿè´£æµä¸­â€œæ¶ˆè´¹â€æˆ–â€œå¤„ç†â€æ•°æ®ï¼Œä»£ç 2-4ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Sink</span>&lt;T&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Consumer</span>&lt;T&gt; {
	<span class="hljs-comment">// åœ¨å¼€å§‹å¤„ç†æ•°æ®å…ƒç´ ä¹‹å‰è¢«è°ƒç”¨ã€‚ç”¨äºè¿›è¡Œä¸€äº›åˆå§‹åŒ–å·¥ä½œï¼ˆä¾‹å¦‚ï¼Œæå‰åˆ†é…ä¸€ä¸ªåˆé€‚å¤§å°çš„æ•°ç»„ï¼‰</span>
	<span class="hljs-comment">// -1 è¡¨ç¤ºæ— æ³•é¢„ä¼°å¤§å°</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">begin</span><span class="hljs-params">(<span class="hljs-type">long</span> size)</span> {}
	<span class="hljs-comment">// åœ¨æ‰€æœ‰æ•°æ®å…ƒç´ éƒ½è¢«å¤„ç†å®Œæ¯•ä¹‹åè¢«è°ƒç”¨ã€‚ç”¨äºæ‰§è¡Œæœ€ç»ˆçš„æ¸…ç†æˆ–è®¡ç®—å·¥ä½œã€‚</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">end</span><span class="hljs-params">()</span> {}
	<span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªçŸ­è·¯åˆ¤æ–­æœºåˆ¶ã€‚åœ¨å¤„ç†æ¯ä¸ªå…ƒç´ ä¹‹å‰ï¼Œæµæ¡†æ¶ä¼šè¯¢é—®è¿™ä¸ª Sinkï¼šâ€œæ˜¯å¦éœ€è¦å–æ¶ˆåç»­å¤„ç†ï¼Ÿâ€</span>
    <span class="hljs-keyword">default</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">cancellationRequested</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
	<span class="hljs-comment">// ...</span>
}
</code></pre>
<p>Java Streamä¸­æ‰€æœ‰å¯¹æ•°æ®çš„æ“ä½œå‡ ä¹éƒ½ä¸æ­¤æ¥å£ç›¸å…³ã€‚å®ƒå†…éƒ¨ä¹Ÿæœ‰å¯¹å››ä¸ªç±»å‹å®ç°çš„å†…éƒ¨ç±»ï¼Œä¸Šæ–‡ç”¨åˆ°çš„<code>Sink.ChainedReference</code>ç±»å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚</p>
<p>â€‹<code>Sink.ChainedReference</code>ç±»éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼Œä»£ç 2-5ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Sink</span>&lt;T&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Consumer</span>&lt;T&gt; {
	<span class="hljs-comment">// ... </span>
	
    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChainedReference</span>&lt;T, E_OUT&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Sink</span>&lt;T&gt; {
        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> Sink&lt;? <span class="hljs-built_in">super</span> E_OUT&gt; downstream;

        <span class="hljs-keyword">public</span> <span class="hljs-title function_">ChainedReference</span><span class="hljs-params">(Sink&lt;? <span class="hljs-built_in">super</span> E_OUT&gt; downstream)</span> {
            <span class="hljs-built_in">this</span>.downstream = Objects.requireNonNull(downstream);
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">begin</span><span class="hljs-params">(<span class="hljs-type">long</span> size)</span> {
            downstream.begin(size);
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">end</span><span class="hljs-params">()</span> {
            downstream.end();
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">cancellationRequested</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> downstream.cancellationRequested();
        }
    }
}
</code></pre>
<p>ç»“åˆä»£ç 2-1æ¥çœ‹ï¼Œæˆ‘ä»¬ä¼ å…¥çš„æ“ä½œé€»è¾‘ï¼ˆå³ <code>String::toUpperCase</code>â€‹ æ–¹æ³•ï¼‰è¢«æ”¾ç½®åœ¨äº† <code>Consumer#accept</code> æ–¹æ³•çš„å®ç°å†…éƒ¨ï¼Œå°†åœ¨åç»­çš„æŸä¸ªæ—¶åˆ»è¢«è§¦å‘è°ƒç”¨ã€‚</p>
<h3 data-id="heading-6">2.3 æµæ°´çº¿çš„æ„æˆ</h3>
<p>ç»“åˆä»£ç 2-1å’Œä»£ç 2-2ï¼Œå½“å‰ï¼ˆ<code>ReferencePipeline</code>â€‹ç±»ï¼‰å®ä¾‹ç”±æ„æ–¹æ³•ä¼ å…¥åˆ°çˆ¶æ„é€ å™¨ä¸­ï¼Œé€šè¿‡å±‚å±‚è°ƒç”¨æœ€åå›åˆ°<code>AbstractPipeline</code>ç±»ï¼ˆå›é¡¾å›¾2-1ï¼‰ã€‚æ¶‰åŠæ­¤ç±»çš„ä¸¤ä¸ªæ„é€ å™¨æ–¹æ³•ï¼Œä»£ç 2-5ï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-comment">// Constructor for the head of a stream pipeline.</span>
	AbstractPipeline(Spliterator&lt;?&gt; source,
                     <span class="hljs-type">int</span> sourceFlags, <span class="hljs-type">boolean</span> parallel) {
        <span class="hljs-built_in">this</span>.previousStage = <span class="hljs-literal">null</span>;
        <span class="hljs-built_in">this</span>.sourceSpliterator = source;
        <span class="hljs-built_in">this</span>.sourceStage = <span class="hljs-built_in">this</span>;
        <span class="hljs-built_in">this</span>.sourceOrOpFlags = sourceFlags &amp; StreamOpFlag.STREAM_MASK;
        <span class="hljs-comment">// The following is an optimization of:</span>
        <span class="hljs-comment">// StreamOpFlag.combineOpFlags(sourceOrOpFlags, StreamOpFlag.INITIAL_OPS_VALUE);</span>
        <span class="hljs-built_in">this</span>.combinedFlags = (~(sourceOrOpFlags &lt;&lt; <span class="hljs-number">1</span>)) &amp; StreamOpFlag.INITIAL_OPS_VALUE;
        <span class="hljs-built_in">this</span>.depth = <span class="hljs-number">0</span>;
        <span class="hljs-built_in">this</span>.parallel = parallel;
    }
	<span class="hljs-comment">// Constructor for appending an intermediate operation stage onto an existing pipeline.</span>
    AbstractPipeline(AbstractPipeline&lt;?, E_IN, ?&gt; previousStage, <span class="hljs-type">int</span> opFlags) {
        <span class="hljs-keyword">if</span> (previousStage.linkedOrConsumed)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(MSG_STREAM_LINKED);
        previousStage.linkedOrConsumed = <span class="hljs-literal">true</span>;
        previousStage.nextStage = <span class="hljs-built_in">this</span>;

        <span class="hljs-built_in">this</span>.previousStage = previousStage;
        <span class="hljs-built_in">this</span>.sourceOrOpFlags = opFlags &amp; StreamOpFlag.OP_MASK;
        <span class="hljs-built_in">this</span>.combinedFlags = StreamOpFlag.combineOpFlags(opFlags, previousStage.combinedFlags);
        <span class="hljs-built_in">this</span>.sourceStage = previousStage.sourceStage;
        <span class="hljs-keyword">if</span> (opIsStateful())
            sourceStage.sourceAnyStateful = <span class="hljs-literal">true</span>;
        <span class="hljs-built_in">this</span>.depth = previousStage.depth + <span class="hljs-number">1</span>;
    }

</code></pre>
<p>å¿½ç•¥å…¶ä»–æ“ä½œï¼Œå¯ä»¥çœ‹å‡ºè¿™æ˜¯åŒå‘é“¾è¡¨çš„æ„å»ºæ–¹æ³•ã€‚</p>
<ul>
<li>â€‹<code>depth</code>ï¼šé“¾è¡¨çš„â€œæ·±åº¦â€ï¼Œæˆ–è€…ä¸ºå½“å‰èŠ‚çš„åºå·ï¼Œä»0å¼€å§‹ï¼Œä¾æ¬¡åŠ 1ã€‚</li>
<li>â€‹<code>sourceStage</code>ï¼šå¤´èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚</li>
<li>â€‹<code>nextStage</code>ï¼šä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆã€‚</li>
<li>â€‹<code>previousStage</code>ï¼šä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆã€‚</li>
</ul>
<p>ä»ä»£ç 1-1ä¸­å¯ä»¥çŸ¥é“ï¼Œæµæ˜¯è°ƒç”¨<code>StreamSupport.stream(spliterator(), false)</code>æ–¹æ³•åˆ›å»ºçš„ã€‚å®ƒçš„å…·ä½“å®ç°æ˜¯è¿™æ ·çš„ï¼Œä»£ç 2-6ï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; Stream&lt;T&gt; <span class="hljs-title function_">stream</span><span class="hljs-params">(Spliterator&lt;T&gt; spliterator, <span class="hljs-type">boolean</span> parallel)</span> {
        Objects.requireNonNull(spliterator);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReferencePipeline</span>.Head&lt;&gt;(spliterator,
                                            StreamOpFlag.fromCharacteristics(spliterator),
                                            parallel);
    }
</code></pre>
<p>è¿™ä¸ª<code>ReferencePipeline.Head</code>ç±»æ„é€ å™¨æœ€åè°ƒç”¨çš„å°±æ˜¯ä»£ç 2-5ä¸­å¤´èŠ‚ç‚¹æ„é€ å™¨ã€‚</p>
<p>å¯¹äºæ ·ä¾‹ä»£ç ä¸­<code>Stream#map</code>â€‹æ–¹æ³•çš„å®ç°ï¼ˆä»£ç 2-1ï¼‰ï¼Œ<code>return new StatelessOp&lt;P_OUT, R&gt;(this, ...)</code>â€‹ è¿™è¡Œä»£ç ä¸­çš„<code>this</code>â€‹æ˜¯<code>ReferencePipeline.Head</code>â€‹å®ä¾‹ã€‚ä½†è¿™è¡Œ<code>StatelessOp</code>â€‹çš„æ„é€ æ–¹æ³•æœ€ç»ˆä¼šè°ƒç”¨åˆ°å®ƒçš„çˆ¶ç±»<code>AbstractPipeline</code>â€‹æ„é€ æ–¹æ³•ï¼ˆä»£ç 2-5ï¼‰ï¼Œå½“è¿è¡Œè‡³<code>previousStage.nextStage = this;</code>â€‹è¡Œæ—¶ï¼Œæ­¤æ—¶çš„<code>this</code>â€‹åˆ™æ˜¯å½“å‰<code>StatelessOp</code>â€‹ç±»å®ä¾‹ã€‚åç»­èŠ‚ç‚¹è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼Œè¿™ä¸¤ä¸ª<code>this</code>å°†ä¼šä¾æ¬¡åç§»ï¼Œé“¾è¡¨å°±è¿™æ ·æ„é€ å‡ºæ¥äº†ã€‚å½¢æˆç±»ä¼¼äºä¸‹å›¾çš„é€»è¾‘ç»“æ„ï¼Œå›¾2-2ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    A[Null] 
    B[ReferencePipelineå¤´èŠ‚ç‚¹]
    C[ReferencePipelineèŠ‚ç‚¹B]
    D[ReferencePipelineèŠ‚ç‚¹C]
    E[Null]

     
    B --&gt; |nextStage| C
    C --&gt; |nextStage| D
    D --&gt; |nextStage| E
    
    C -.-&gt; |sourceStage| B
    D -.-&gt; |sourceStage| B

    C -.-&gt; |previousStage| B
    D -.-&gt; |previousStage| C
    B -.-&gt; |previousStage| A
</code></pre>
<p>åœ¨çœ‹æºç æ—¶éœ€æ³¨æ„ä»£ç ä¸­<code>this</code>æŒ‡å‘çš„èŠ‚ç‚¹ã€‚</p>
<h2 data-id="heading-7">3 æµçš„è®¡ç®—</h2>
<p>å‰é¢åˆ†æäº†æ•°æ®å’Œæ“ä½œæµæ°´çº¿çš„æ„å»ºï¼Œæ¥ä¸‹æ¥å°±æ˜¯æµæœ€ç»ˆæ˜¯å¦‚ä½•è¿›è¡Œè¿ç®—çš„ã€‚</p>
<h3 data-id="heading-8">3.1 æµçš„æ‰§è¡Œ</h3>
<p>åœ¨æ ·ä¾‹ä»£ç ä¸­ï¼Œæœ€åè°ƒç”¨ä¸€ä¸ª<code>forEach</code>â€‹çš„ç»ˆæ­¢æ“ä½œæ¥ç»“æŸæµçš„å®šä¹‰ã€‚ç»ˆæ­¢æ“ä½œæ˜¯æµè®¡ç®—å’Œè·å–ç»“æœçš„æ–¹æ³•ï¼Œå®ƒä»¬éƒ½å®šä¹‰åœ¨<code>java.util.stream.Stream</code>â€‹æ¥å£ä¸­ï¼Œå®ç°åœ¨<code>ReferencePipeline</code>ç±»ä¸­ã€‚éƒ¨åˆ†ç»ˆæ­¢æ–¹æ³•å®ç°ï¼Œä»£ç 3-1ï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forEach</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> P_OUT&gt; action)</span> {
        evaluate(ForEachOps.makeRef(action, <span class="hljs-literal">false</span>));
    }
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">allMatch</span><span class="hljs-params">(Predicate&lt;? <span class="hljs-built_in">super</span> P_OUT&gt; predicate)</span> {
        <span class="hljs-keyword">return</span> evaluate(MatchOps.makeRef(predicate, MatchOps.MatchKind.ALL));
    }
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Optional&lt;P_OUT&gt; <span class="hljs-title function_">findAny</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> evaluate(FindOps.makeRef(<span class="hljs-literal">false</span>));
    }
</code></pre>
<p>è¿™å°±æ˜¯æµçš„ç»ˆæ­¢æ“ä½œçš„ç‰¹æ®Šæ€§ï¼Œæ¯ä¸ªç»ˆæ­¢æ“ä½œéƒ½ç”±ä¸€ä¸ªJDKå†…éƒ¨<code>XxxOps</code>ç±»åŒ…è£…åä½¿ç”¨ã€‚</p>
<p>â€‹<code>evaluate</code>â€‹æ–¹æ³•æ˜¯æ‰§è¡Œæµè®¡ç®—å¹¶è·å–ç»“æœçš„æ–¹æ³•ï¼Œä¸º <code>ReferencePipeline</code>â€‹ çš„çˆ¶ç±» <code>AbstractPipeline</code>â€‹ ä¸­çš„<code>final</code>æ–¹æ³•ï¼Œä»£ç 3-2ï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-keyword">final</span> &lt;R&gt; R <span class="hljs-title function_">evaluate</span><span class="hljs-params">(TerminalOp&lt;E_OUT, R&gt; terminalOp)</span> {
        <span class="hljs-keyword">assert</span> <span class="hljs-title function_">getOutputShape</span><span class="hljs-params">()</span> == terminalOp.inputShape();
        <span class="hljs-keyword">if</span> (linkedOrConsumed)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(MSG_STREAM_LINKED);
        linkedOrConsumed = <span class="hljs-literal">true</span>;

        <span class="hljs-keyword">return</span> isParallel()
               ? terminalOp.evaluateParallel(<span class="hljs-built_in">this</span>, sourceSpliterator(terminalOp.getOpFlags()))
               : terminalOp.evaluateSequential(<span class="hljs-built_in">this</span>, sourceSpliterator(terminalOp.getOpFlags()));
    }
</code></pre>
<p>æ­¤æ–¹æ³•çš„ä¸»è¦ä½œç”¨æ˜¯åˆ†æ´¾è®¡ç®—æ–¹æ³•ï¼šå¯¹äºä¸²è¡Œè®¡ç®—è°ƒç”¨ <code>evaluateSequential</code>â€‹ æ–¹æ³•ï¼Œå¯¹äºå¹¶å‘è®¡ç®—åˆ™è°ƒç”¨ <code>evaluateParallel</code>â€‹ æ–¹æ³•ã€‚å…·ä½“çš„è®¡ç®—æ–¹æ¡ˆç”± <code>terminalOp</code> è¿™ä¸ªç»ˆæ­¢æ“ä½œç±»æ¥å®ç°ã€‚å¹¶å‘è®¡ç®—æ¶‰åŠçš„å†…å®¹è¾ƒä¸ºå¤æ‚ï¼Œæœ¬æ–‡ä¸ä¼šæ¶‰åŠã€‚</p>
<p>æ³¨æ„ä»£ç ä¸­<code>this</code>â€‹çš„æŒ‡å‘ã€‚å°±æ ·ä¾‹ä»£ç è€Œè¨€ï¼Œå½“å‰<code>terminalOp.evaluateSequential</code>â€‹ æ–¹æ³•ä¸­çš„<code>this</code>â€‹æŒ‡å‘<code>Stream#map</code>â€‹æ–¹æ³•æ„å»ºå‡ºçš„<code>ReferencePipeline</code>å®ä¾‹ã€‚</p>
<p>â€‹<code>sourceSpliterator</code>æ–¹æ³•å¯ç®€å•ç†è§£ä¸ºâ€œå–å‡ºæ•°æ®â€æ“ä½œï¼Œä¸è¿‡ä¼šæœ‰ä¸€äº›æ ¡éªŒç­‰ï¼Œæ­¤å¤„ä¸å±•å¼€ã€‚</p>
<p>æ­¤æ—¶<code>terminalOp</code>â€‹å˜é‡ä¸º<code>java.util.stream.ForEachOps</code>å®ä¾‹ï¼Œå®ƒçš„éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼Œä»£ç 3-3ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ForEachOps</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">ForEachOps</span><span class="hljs-params">()</span> { }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; TerminalOp&lt;T, Void&gt; <span class="hljs-title function_">makeRef</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> T&gt; action,
                                                  <span class="hljs-type">boolean</span> ordered)</span> {
        Objects.requireNonNull(action);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ForEachOp</span>.OfRef&lt;&gt;(action, ordered);
    }
	<span class="hljs-comment">// ...</span>
	    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ForEachOp</span>&lt;T&gt;
            <span class="hljs-keyword">implements</span> <span class="hljs-title class_">TerminalOp</span>&lt;T, Void&gt;, TerminalSink&lt;T, Void&gt; {
			<span class="hljs-comment">// ... </span>
	        <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OfRef</span>&lt;T&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ForEachOp</span>&lt;T&gt; {
	            <span class="hljs-keyword">final</span> Consumer&lt;? <span class="hljs-built_in">super</span> T&gt; consumer;
	
	            OfRef(Consumer&lt;? <span class="hljs-built_in">super</span> T&gt; consumer, <span class="hljs-type">boolean</span> ordered) {
	                <span class="hljs-built_in">super</span>(ordered);
	                <span class="hljs-built_in">this</span>.consumer = consumer;
	            }
	
	            <span class="hljs-meta">@Override</span>
	            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(T t)</span> {
	                consumer.accept(t);
	            }
	        }
	        <span class="hljs-meta">@Override</span>
	        <span class="hljs-keyword">public</span> &lt;S&gt; Void <span class="hljs-title function_">evaluateSequential</span><span class="hljs-params">(PipelineHelper&lt;T&gt; helper,
	                                           Spliterator&lt;S&gt; spliterator)</span> {
	            <span class="hljs-keyword">return</span> helper.wrapAndCopyInto(<span class="hljs-built_in">this</span>, spliterator).get();
	        }
	        <span class="hljs-meta">@Override</span>
	        <span class="hljs-keyword">public</span> Void <span class="hljs-title function_">get</span><span class="hljs-params">()</span> {
	            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
	        }
		<span class="hljs-comment">// ...</span>
		}
	<span class="hljs-comment">// ...</span>
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°å®ƒçš„<code>evaluateSequential</code>â€‹æ–¹æ³•æ˜¯æ‰§è¡Œè®¡ç®—å¹¶è·å–ç»“æœçš„åœ°æ–¹ï¼Œä½†<code>forEach</code>â€‹çš„ç»ˆæ­¢æ“ä½œä¸äº§å‡ºæ•°æ®æ‰€ä»¥<code>get()</code>â€‹æ–¹æ³•ç›´æ¥è¿”ç©ºã€‚ä¸‹é¢æœ‰è¿”å›å€¼çš„ç»ˆæ­¢æ“ä½œä¾‹å­ï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆJava Streamæ¨¡å—å†…éƒ¨æ²¡æ€ä¹ˆç”¨<code>Optional</code>ç±»ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FindOps</span> {
		<span class="hljs-comment">// ...</span>
        <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OfInt</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">FindSink</span>&lt;Integer, OptionalInt&gt;
                <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Sink</span>.OfInt {
			<span class="hljs-comment">// ...</span>
            <span class="hljs-keyword">public</span> OptionalInt <span class="hljs-title function_">get</span><span class="hljs-params">()</span> {
                <span class="hljs-keyword">return</span> hasValue ? OptionalInt.of(value) : <span class="hljs-literal">null</span>;
            }
}
</code></pre>
<p>â€‹<code>PipelineHelper</code>â€‹ç±»çœ‹åå­—åƒä¸ªå·¥å…·ç±»ï¼Œä½†å®ƒæ˜¯<code>ReferencePipeline</code>â€‹ç±»çš„çˆ¶ç±»ï¼Œå›çœ‹å›¾2-1ï¼Œæ­¤å¤„<code>helper</code>â€‹å‚æ•°åº”å½“è§†ä¸º<code>AbstractPipeline</code>ç±»å®ä¾‹æˆ–è€…ç†è§£ä¸ºâ€œæµæ°´çº¿â€èŠ‚ç‚¹ã€‚</p>
<p>ç»“åˆä»£ç 3-2ï¼Œæ ·ä¾‹ä»£ç ä¼šè¿è¡Œåˆ°<code>helper.wrapAndCopyInto(this, spliterator).get()</code>â€‹è¡Œã€‚æ­¤æ—¶<code>this</code>â€‹æŒ‡å‘<code>ForEachOps</code>â€‹å®ä¾‹ï¼Œ<code>helper</code>â€‹å‚æ•°æ›´ç¡®åˆ‡ç‚¹è¯´ä¸º<code>Stream#map</code>â€‹æ–¹æ³•æ„å»ºå‡ºçš„<code>ReferencePipeline</code>â€‹å®ä¾‹ã€‚<code>wrapAndCopyInto</code>â€‹æ–¹æ³•å®šä¹‰åœ¨<code>PipelineHelper</code>â€‹ä¸­ï¼Œå®ç°åœ¨<code>AbstractPipeline</code>ç±»é‡Œï¼Œå¦‚ä¸‹ï¼Œä»£ç 3-4ï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">final</span> &lt;P_IN, S <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sink</span>&lt;E_OUT&gt;&gt; S <span class="hljs-title function_">wrapAndCopyInto</span><span class="hljs-params">(S sink, Spliterator&lt;P_IN&gt; spliterator)</span> {
        copyInto(wrapSink(Objects.requireNonNull(sink)), spliterator);
        <span class="hljs-keyword">return</span> sink;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">final</span> &lt;P_IN&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">copyInto</span><span class="hljs-params">(Sink&lt;P_IN&gt; wrappedSink, Spliterator&lt;P_IN&gt; spliterator)</span> {
        Objects.requireNonNull(wrappedSink);

        <span class="hljs-keyword">if</span> (!StreamOpFlag.SHORT_CIRCUIT.isKnown(getStreamAndOpFlags())) {
            wrappedSink.begin(spliterator.getExactSizeIfKnown());
            spliterator.forEachRemaining(wrappedSink);
            wrappedSink.end();
        }
        <span class="hljs-keyword">else</span> {
            copyIntoWithCancel(wrappedSink, spliterator);
        }
    }

</code></pre>
<p>â€‹<code>wrapAndCopyInto</code> æ–¹æ³•åè™½æœªæåŠè®¡ç®—ï¼Œä½†å¯¹äºä¸²è¡Œæµè€Œè¨€ï¼Œè®¡ç®—åŸºæœ¬ä¸Šå°±æ˜¯åœ¨æ­¤å¤„æ‰§è¡Œçš„ï¼Œç»ˆæ­¢æ“ä½œä¸»è¦è´Ÿè´£è·å–æœ€ç»ˆç»“æœã€‚</p>
<p>åœ¨å½“å‰æ ·ä¾‹ä»£ç çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œç”±äºæ²¡æœ‰ä½¿ç”¨ <code>filter</code> ç­‰å¯èƒ½å¼•å‘çŸ­è·¯è®¡ç®—çš„ä¸­é—´æ“ä½œï¼Œå› æ­¤ä¼šæ‰§è¡ŒéçŸ­è·¯åˆ†æ”¯å†…çš„ä»£ç ã€‚</p>
<pre><code class="hljs language-java" lang="java">            wrappedSink.begin(spliterator.getExactSizeIfKnown());
            spliterator.forEachRemaining(wrappedSink);
            wrappedSink.end();
</code></pre>
<p>åœ¨æ‰§è¡Œè®¡ç®—ä¹‹å‰ï¼Œè¿˜éœ€è¦è°ƒç”¨ <code>wrapSink(Sink&lt;E_OUT&gt; sink)</code> æ–¹æ³•ã€‚åœ¨äº†è§£æ­¤æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¡¥å……ä¸¤ä¸ªç›¸å…³çš„æ¥å£å®šä¹‰ï¼Œå¦‚ä»£ç 3-5æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">TerminalOp</span>&lt;E_IN, R&gt; {
	<span class="hljs-comment">// ...</span>
}
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">TerminalSink</span>&lt;T, R&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sink</span>&lt;T&gt;, Supplier&lt;R&gt; { }
</code></pre>
<p>ç¬¬ä¸€ä¸ªæ¥å£å®šä¹‰äº†ç»ˆæ­¢æ“ä½œçš„å…¬å…±è¡Œä¸ºï¼ˆä¸»è¦æ˜¯<code>evaluateParallel</code>â€‹å’Œ<code>evaluateSequential</code>â€‹æ–¹æ³•ï¼‰ï¼Œç¬¬äºŒæ¥å£åˆ™æ˜¯æ‹“å±•äº†<code>Sink</code>â€‹æ¥å£ã€‚ç»“åˆä»£ç 3-3æ¥çœ‹ï¼Œ<code>ForEachOp.OfRef</code>â€‹æ˜¯é’ˆå¯¹å¼•ç”¨ç±»æ•°æ®çš„å®ç°ï¼Œä¹Ÿé—´æ¥å®ç°äº†<code>Sink</code>â€‹æ¥å£ã€‚æ­¤æ—¶<code>wrapSink(Sink&lt;E_OUT&gt; sink)</code>â€‹æ–¹æ³•çš„å…¥å‚ä¸º<code>ForEachOp.OfRef</code>å®ä¾‹ã€‚</p>
<p>æ¥ä¸‹æ¥å†çœ‹<code>java.util.stream.AbstractPipeline#wrapSink</code>æ–¹æ³•ï¼Œä»£ç 3-6ï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-meta">@Override</span>
    <span class="hljs-meta">@SuppressWarnings("unchecked")</span>
    <span class="hljs-keyword">final</span> &lt;P_IN&gt; Sink&lt;P_IN&gt; <span class="hljs-title function_">wrapSink</span><span class="hljs-params">(Sink&lt;E_OUT&gt; sink)</span> {
        Objects.requireNonNull(sink);

        <span class="hljs-keyword">for</span> ( <span class="hljs-meta">@SuppressWarnings("rawtypes")</span> AbstractPipeline p=AbstractPipeline.<span class="hljs-built_in">this</span>; p.depth &gt; <span class="hljs-number">0</span>; p=p.previousStage) {
            sink = p.opWrapSink(p.previousStage.combinedFlags, sink);
        }
        <span class="hljs-keyword">return</span> (Sink&lt;P_IN&gt;) sink;
    }
</code></pre>
<p>è¿™é‡Œè¦æ³¨æ„ä»£ç ä¸­<code>this</code>â€‹çš„æŒ‡å‘ï¼Œå®ƒæ˜¯æŒ‡å‘ä¸Šä¸€çº§<code>AbstractPipeline</code>â€‹èŠ‚ç‚¹ã€‚å¯¹äºæ ·ä¾‹ä»£ç ï¼Œæ­¤å¤„ä¸º<code>Stream#map</code>â€‹æ–¹æ³•æ„å»ºå‡ºçš„<code>AbstractPipeline</code>â€‹èŠ‚ç‚¹ã€‚è€Œ<code>sink</code>â€‹å‚æ•°åˆ™ä¼ å…¥çš„<code>ForEachOp.OfRef</code>å®ä¾‹ã€‚</p>
<p>ä»¥æ ·ä¾‹ä»£ç æ¥è®²ï¼š</p>
<pre><code class="hljs language-java" lang="java">ForEachOp.OfRefå®ä¾‹ ä¼ å…¥ -&gt; wrapSink(Sink&lt;E_OUT&gt; sink) æ–¹æ³•
AbstractPipeline.<span class="hljs-built_in">this</span> æ‹¿å‡º Stream#map æ–¹æ³•æ„å»ºå‡ºçš„AbstractPipelineå®ä¾‹

p.opWrapSink(p.previousStage.combinedFlags, sink)çš„è°ƒç”¨å±•å¼€ä¸ºï¼š

            <span class="hljs-meta">@Override</span>
            Sink&lt;P_OUT&gt; <span class="hljs-title function_">opWrapSink</span><span class="hljs-params">(<span class="hljs-type">int</span> flags, Sink&lt;R&gt; sink)</span> {  <span class="hljs-comment">// ForEachOp.OfRefå®ä¾‹ -&gt; sink</span>
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sink</span>.ChainedReference&lt;P_OUT, R&gt;(sink) {
                    <span class="hljs-meta">@Override</span>
                    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(P_OUT u)</span> {
                        downstream.accept(mapper.apply(u));
                    }
                };
            }
        
è¿”å›Sink.ChainedReferenceå®ä¾‹

pæŒ‡é’ˆçš„å·²ç§»åŠ¨åˆ°å¤´èŠ‚ç‚¹ï¼Œdepth ä¸º <span class="hljs-number">0</span> ï¼Œé€€å‡ºå¾ªç¯
</code></pre>
<p>ç»“åˆä»£ç 2-5ä¸­çš„</p>
<pre><code class="hljs language-java" lang="java">        <span class="hljs-keyword">public</span> <span class="hljs-title function_">ChainedReference</span><span class="hljs-params">(Sink&lt;? <span class="hljs-built_in">super</span> E_OUT&gt; downstream)</span> {
            <span class="hljs-built_in">this</span>.downstream = Objects.requireNonNull(downstream);
        }
</code></pre>
<p>å„ä¸ª<code>Sink</code>â€‹ç±»ä¸­çš„<code>downstream</code>â€‹å˜é‡ç¡®å®æŒ‡å‘ä¸‹ä¸€çº§çš„<code>Sink</code>å®ä¾‹ã€‚</p>
<p>ç»¼ä¸Šï¼Œæµè®¡ç®—çš„å‰æœŸæ­¥éª¤å·²ç»å®Œæˆã€‚æ¥ä¸‹æ¥å°±çœ‹çœ‹æ•°æ®æ˜¯å¦‚ä½•è®¡ç®—çš„ã€‚</p>
<h3 data-id="heading-9">3.2 æ•°æ®çš„è¿ç®—</h3>
<p>ä¹‹å‰åˆ†æè¯´è¿‡ï¼Œä¸²è¡Œæµåœ¨<code>wrapAndCopyInto</code>æ–¹æ³•å°±æ‰§è¡Œäº†è®¡ç®—ã€‚å¯¹äºæˆ‘ä»¬çš„æ ·ä¾‹ä»£ç æ¥è¯´è®¡ç®—å°±å‘ç”Ÿè¿™ä¸‰è¡Œä»£ç ä¸­ï¼š</p>
<pre><code class="hljs language-java" lang="java">            wrappedSink.begin(spliterator.getExactSizeIfKnown());
            spliterator.forEachRemaining(wrappedSink);
            wrappedSink.end();
</code></pre>
<p>â€‹â€‹<code>wrappedSink</code>â€‹å˜é‡ä»£è¡¨ç€æµç¬¬ä¸€ä¸ªæ“ä½œï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º<code>map(String::toUpperCase)</code>ã€‚</p>
<p>â€‹â€‹<code>spliterator</code>â€‹ä»£è¡¨æ•°æ®æºï¼Œæœ¬ä¾‹ä¸­å®ƒä¸º<code>ArrayList</code>ã€‚</p>
<p>â€‹â€‹<code>wrappedSink.begin</code>â€‹æµè¿ç®—å¼€å§‹å‰çš„å‡†å¤‡å·¥ä½œã€‚å¤§éƒ¨åˆ†æ“ä½œå¹¶ä¸éœ€è¦åšä»€ä¹ˆå‡†å¤‡ï¼Œé€šå¸¸ä½¿ç”¨é»˜è®¤å®ç°<code>downstream.begin(size);</code>â€‹é€šçŸ¥ä¸‹æ¸¸æ“ä½œï¼›å¯¹äº<code>filter</code>â€‹ä¹‹ç±»çš„æ“ä½œï¼Œå¸¸å¸¸å®ç°ä¸º<code>downstream.begin(-1);</code>è¡¨ç¤ºæœªçŸ¥å¤§å°ã€‚</p>
<p>â€‹<code>spliterator.forEachRemaining</code>â€‹è¯­ä¹‰ä¸ºæŠŠæ•°æ®æºä¸­çš„æ‰€æœ‰å…ƒç´ é€ä¸€éå†ï¼Œ<code>ArrayList</code>â€‹å®ç°ä¸ºä½¿ç”¨ç´¢å¼•éå†å…·ä½“æ­¤å¤„ç•¥ã€‚è¿™é‡Œéœ€è¦æ³¨æ„æ•°æ®æµçš„å½¢æˆã€‚å…ˆçœ‹<code>forEachRemaining</code>æ–¹æ³•ç±»ä¼¼çš„å®ç°ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forEachRemaining</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> E&gt; action)</span> {  <span class="hljs-comment">// ä¼ å…¥çš„æ˜¯map(String::toUpperCase)æ–¹æ³•æ„æˆçš„Sinkå®ä¾‹</span>
    <span class="hljs-keyword">for</span> (i = lo; i &lt; hi; ++i) { 
        <span class="hljs-type">E</span> <span class="hljs-variable">e</span> <span class="hljs-operator">=</span> (E) a[i];
        action.accept(e);
    }
}
</code></pre>
<p>ç»“åˆä»£ç 2-1ä¸­çš„ç‰‡æ®µ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(P_OUT u)</span> {
    downstream.accept(mapper.apply(u)); <span class="hljs-comment">// mapperä¸ºmap(String::toUpperCase)æ–¹æ³•æ„æˆçš„Sinkå®ä¾‹</span>
}
</code></pre>
<p>â€‹<code>downstream</code>â€‹å˜é‡ç»“åˆä¹‹å‰æ‰€è®²å®ƒä¸º<code>ForEachOps</code>å®ä¾‹ï¼Œå³ä¸ºæ‰“å°å…ƒç´ çš„è¯­å¥ã€‚</p>
<p>è¿™é‡Œä¹Ÿè¡¨æ˜ä¸Šä¸€çº§æ“ä½œç»“æœå°±æ˜¯ä¸‹ä¸€çº§æ“ä½œçš„è¾“å…¥ï¼Œæ•°æ®æµåŠ¨èµ·æ¥äº†ã€‚</p>
<p>â€‹<code>wrappedSink.end</code>æ–¹æ³•é€šå¸¸ä¹Ÿåªæ˜¯é€šçŸ¥ä¸‹æ¸¸æ“ä½œã€‚</p>
<h2 data-id="heading-10">4 æ€»ç»“</h2>
<p>æœ¬æ–‡ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­å‡ºå‘ï¼Œå±•ç¤ºäº†Java Streamè¿è¡Œçš„åŸºæœ¬è€Œå®Œæ•´æµç¨‹ï¼Œå…¶ä¸­ä¹Ÿæ¶‰åŠåˆ°é‡è¦æ¦‚å¿µä¸ç±»è®¾è®¡ã€‚</p>
<p>é™äºç¯‡å¹…ä¸èƒ½åŠ›ï¼Œæœ¬æ–‡ç•¥è¿‡æœ‰çŠ¶æ€è®¡ç®—ã€å¹¶è¡Œè®¡ç®—ç­‰å¤æ‚éƒ¨åˆ†ï¼›å¦‚æœ‰é”™æ¼ï¼Œæ¬¢è¿æŒ‡å‡ºã€‚</p>
<p>â€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®°ä¸€æ¬¡â€œä¸æ»‘â€çš„æœåŠ¡å™¨è¿ç§»]]></title>    <link>https://juejin.cn/post/7587252766831837226</link>    <guid>https://juejin.cn/post/7587252766831837226</guid>    <pubDate>2025-12-24T13:28:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587252766831837226" data-draft-id="7587253759092588580" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®°ä¸€æ¬¡â€œä¸æ»‘â€çš„æœåŠ¡å™¨è¿ç§»"/> <meta itemprop="keywords" content="åç«¯,è¿ç»´"/> <meta itemprop="datePublished" content="2025-12-24T13:28:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="tonydf"/> <meta itemprop="url" content="https://juejin.cn/user/3809161241186638"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®°ä¸€æ¬¡â€œä¸æ»‘â€çš„æœåŠ¡å™¨è¿ç§»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3809161241186638/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    tonydf
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T13:28:05.000Z" title="Wed Dec 24 2025 13:28:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>è¿‘æœŸï¼Œç”±äºæ—§æœåŠ¡å™¨æ€§èƒ½æ— æ³•æ»¡è¶³æ—¥ç›Šå¢é•¿çš„æœåŠ¡éœ€æ±‚ï¼Œéœ€è¦å°†æ ¸å¿ƒä¸­é—´ä»¶å¹³æ»‘è¿ç§»è‡³ä¸€å°é«˜æ€§èƒ½çš„æ–°æœåŠ¡å™¨èŠ‚ç‚¹ã€‚æ¶‰åŠçš„æœåŠ¡åŒ…æ‹¬ Elasticsearchã€Kafka é›†ç¾¤ï¼Œä»¥åŠ PostgreSQL å’Œ RabbitMQ ç­‰å¼€å‘ç¯å¢ƒæœåŠ¡ï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯æœ‰å¿…è¦è®°å½•ä¸€ä¸‹çš„ï¼Œå°±ç®—å„ä½ä½¬å‹ç”¨ä¸åˆ°ï¼Œå¯¹æˆ‘è‡ªå·±æ¥è¯´ï¼Œä¹Ÿæ˜¯ä¸€æ¬¡è¿ç»´ç»éªŒçš„æ•´ç†ã€‚</p>
<p>æˆ‘æŠŠè¿™äº›å·¥ä½œåˆ†äº†ä¸‹é¢è¿™å‡ ä¸ªé˜¶æ®µã€‚</p>
<h2 data-id="heading-1">ç¬¬ä¸€é˜¶æ®µï¼šå‡†å¤‡è¿ç§»</h2>
<p>å¼€å§‹è¿ç§»ä¹‹å‰ï¼Œå‡†å¤‡ä¸€ä¸‹è¦è¿ç§»çš„æœåŠ¡ï¼Œä»¥åŠå¤§ä½“çš„è¿ç§»è·¯çº¿ã€‚</p>
<p>è¿™ä¸€é˜¶æ®µï¼Œæˆ‘è¿™è¾¹çš„åœºæ™¯æ˜¯åˆ†åˆ«å‡†å¤‡</p>
<ul>
<li>postgreSQL</li>
<li>RabbitMQ</li>
<li>ElasticSearch</li>
<li>Kafka</li>
</ul>
<p>ä»¥ä¸Š4ä¸ªè½¯ä»¶çš„å®‰è£…ç¯å¢ƒï¼Œæˆ‘è¿™é‡ŒRabbitMQå’ŒPGåªæ˜¯ä½œä¸ºå¼€å‘ç¯å¢ƒçš„æœåŠ¡ï¼Œä½œä¸ºä¸€ä¸ªå•èŠ‚ç‚¹æœåŠ¡è¿è¡Œï¼Œè¦æ±‚ä¸é«˜ï¼Œå› æ­¤å®‰è£…ç›¸å¯¹ç®€å•ï¼ŒåŸºæœ¬æŒ‰ç…§å®˜æ–¹æ–‡æ¡£æˆ–è€…æ“ä½œä¹ æƒ¯ï¼Œä»å¤´å®‰è£…å³å¯ã€‚</p>
<p>ä¸»è¦è¿˜æ˜¯ESå’ŒKafkaä¸¤ä¸ªé›†ç¾¤èŠ‚ç‚¹çš„è¿ç§»ï¼Œæˆ‘è¿™é‡Œæ˜¯æŠŠå®‰è£…æ–‡ä»¶å’Œç›¸å…³çš„é…ç½®æ–‡ä»¶ä»å³å°†ä¸‹çº¿çš„æœåŠ¡å™¨ç›´æ¥scpåˆ°äº†æ–°æœåŠ¡å™¨èŠ‚ç‚¹ï¼Œç„¶åä¿®æ”¹é…ç½®ï¼Œé‡å¯æœåŠ¡çš„è·¯çº¿ã€‚</p>
<h2 data-id="heading-2">ç¬¬äºŒé˜¶æ®µï¼šç³»ç»Ÿåº•å±‚ç¯å¢ƒæ ‡å‡†åŒ–</h2>
<p>åœ¨æ–°èŠ‚ç‚¹éƒ¨ç½²å‰ï¼Œéœ€è¦æ‰§è¡Œä»¥ä¸‹åˆå§‹åŒ–ï¼Œç¡®ä¿ç¯å¢ƒä¸å…¶ä»–æœåŠ¡å™¨èŠ‚ç‚¹å¯¹é½ã€‚</p>
<h3 data-id="heading-3">1. å†…æ ¸ä¸èµ„æºé™åˆ¶</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¿®æ”¹å†…æ ¸å‚æ•°</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"vm.max_map_count=262144"</span> &gt;&gt; /etc/sysctl.conf
sysctl -p

<span class="hljs-comment"># ä¿®æ”¹èµ„æºé™åˆ¶</span>
<span class="hljs-built_in">cat</span> &lt;&lt;<span class="hljs-string">EOF &gt;&gt; /etc/security/limits.conf
# ğŸ‘‡è¿™é‡Œå¯ä»¥ç›´æ¥é™åˆ¶å…·ä½“çš„èµ„æºå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥åƒè¿™æ ·ç›´æ¥æä¸ª*
* soft nofile 65536
* hard nofile 65536
EOF</span>
</code></pre>
<p>ä¿®æ”¹å®Œæˆåçš„è¾“å‡ºå¦‚ä¸‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8912806f6e4940d3abc75b3587f8a654~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdG9ueWRm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767187684&amp;x-signature=3ECJe4R1iDkDAArN3e9eLLjEnL8%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a33ca1e483b04c38a1e3b493b13c6643~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdG9ueWRm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767187684&amp;x-signature=Hclap9hZsoWmHrTxupshbM8f3QA%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸ªæŒ‰éœ€æ‰§è¡Œå³å¯ï¼Œå¦‚æœä½ è¦è·‘çš„æœåŠ¡ä¸éœ€è¦é™åˆ¶èµ„æºï¼Œé‚£ä¸ç”¨è€ƒè™‘</p>
<h3 data-id="heading-4">2. JDKç¯å¢ƒ</h3>
<p>æˆ‘è¿™é‡Œè¦å®‰è£…JDKæ˜¯å› ä¸ºæˆ‘çš„kafkaé›†ç¾¤æ˜¯åŸºäºKraftæ¨¡å¼ï¼Œä¾èµ–jdkã€‚</p>
<p>è€Œeså¯åŠ¨æ–‡ä»¶é‡Œè™½ç„¶å·²ç»åŒ…å«äº†ä¸€ä¸ªJDKï¼Œä½†ä»…é™esè‡ªèº«ä½¿ç”¨ï¼Œå› æ­¤å…¶ä»–åº”ç”¨ä¹Ÿä¾èµ–JDKçš„è¯è¿˜æ˜¯è¦å®‰è£…ä¸€ä¸‹ã€‚</p>
<pre><code class="hljs language-plain" lang="plain"># å®‰è£…ç³»ç»Ÿå…¨å±€ JDK
yum install -y java-17-openjdk-devel
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e67c6d4123a4e1d935b13ac15d529fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdG9ueWRm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767187684&amp;x-signature=UfcnoU3A0A1%2FoxPDXtCJk2HTB1Y%3D" alt="" loading="lazy"/></p>
<p>ç”±äºæˆ‘çš„JDKç¯å¢ƒè¦ç»™åˆ°Kafkaå¸æˆ·ä½¿ç”¨ï¼Œå› æ­¤è¦ç»™Kafkaä¹Ÿè¿›è¡Œæˆæƒ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»º kafka ç”¨æˆ·å¹¶æˆæƒå®‰è£…ç›®å½•</span>
useradd kafka
<span class="hljs-built_in">chown</span> -R kafka:kafka /home/tony/kafka
</code></pre>
<p>ç„¶ååˆ‡åˆ°kafkaç”¨æˆ·ä¸‹ï¼Œçœ‹ä¸€ä¸‹è¾“å‡ºä¹Ÿokå³å¯</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab168d09d79f48e6beca4db60850b312~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdG9ueWRm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767187684&amp;x-signature=nsgRu%2BLnQ%2BL3Y2xwIWc5a35e1Hg%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-5">ç¬¬äºŒé˜¶æ®µï¼šElasticsearch èŠ‚ç‚¹å¹³æ»‘å¹³ç§»</h2>
<p>æˆ‘è¿™é‡Œï¼Œesåšäº†å®‰å…¨é…ç½®ï¼Œå¢åŠ äº†X-Packå®‰å…¨éªŒè¯å’ŒSSLè¯ä¹¦ï¼Œå› æ­¤è¿ç§»çš„æ—¶å€™ï¼Œæ–°èŠ‚ç‚¹ä¸Šçš„é…ç½®å¿…é¡»â€œåƒç´ çº§â€å’ŒåŸæ¥çš„èŠ‚ç‚¹å¯¹é½ï¼Œå¦åˆ™æ— æ³•é€šè¿‡æ¡æ‰‹ï¼Œç”šè‡³ä¼šå¯¼è‡´é›†ç¾¤è„‘è£‚æˆ–æ‹’ç»è¿æ¥ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å…·ä½“æ­¥éª¤ï¼Œåœ¨è¿™ä¹‹å‰ï¼Œæˆ‘å·²ç»å®Œæˆäº†å®‰è£…æ–‡ä»¶å’Œ<strong>è¯ä¹¦æ–‡ä»¶</strong>çš„è¿ç§»ã€‚</p>
<h3 data-id="heading-6">ä¿®æ”¹é…ç½®</h3>
<p>esçš„é…ç½®å¤æ‚åº¦åŸºæœ¬éƒ½æ”¶æ‹¢åˆ°äº†elasticsearch.ymlæ–‡ä»¶é‡Œï¼Œå› æ­¤è¦ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥äº†.</p>
<p>å…³é”®çš„é…ç½®å¦‚ä¸‹ï¼Œæˆ‘å¯¹æ•æ„Ÿä¿¡æ¯åšäº†è„±æ•ï¼ˆå¯†ç å’Œipåœ°å€ï¼‰</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># ---------------------------------- Cluster -----------------------------------</span>
<span class="hljs-comment"># é›†ç¾¤åç§°</span>
<span class="hljs-attr">cluster.name:</span> <span class="hljs-string">magicloud-cluster</span>

<span class="hljs-comment"># ------------------------------------ Node ------------------------------------</span>
<span class="hljs-comment"># ä¿®æ”¹èŠ‚ç‚¹åä»¥åŒºåˆ†</span>
<span class="hljs-attr">node.name:</span> <span class="hljs-string">es-node214</span> 
<span class="hljs-attr">node.master:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">node.data:</span> <span class="hljs-literal">true</span>

<span class="hljs-comment"># ----------------------------------- Paths ------------------------------------</span>
<span class="hljs-comment"># ç¡®ä¿æ–°èŠ‚ç‚¹ä¸Šè¿™äº›ç›®å½•å­˜åœ¨ä¸”esç”¨æˆ·æœ‰æƒè¯»å†™</span>
<span class="hljs-attr">path.data:</span> <span class="hljs-string">/usr/local/elasticsearch/data</span>
<span class="hljs-attr">path.logs:</span> <span class="hljs-string">/usr/local/elasticsearch/logs</span>

<span class="hljs-comment"># ---------------------------------- Network -----------------------------------</span>
<span class="hljs-comment"># IPé…ç½®</span>
<span class="hljs-attr">network.host:</span> <span class="hljs-string">xx.xxx.xx.xxx</span>
<span class="hljs-attr">http.port:</span> <span class="hljs-number">9200</span>

<span class="hljs-comment"># --------------------------------- Discovery ----------------------------------</span>
<span class="hljs-comment"># ç§å­èŠ‚ç‚¹å†™ç°æœ‰çš„èŠ‚ç‚¹</span>
<span class="hljs-attr">discovery.seed_hosts:</span> [<span class="hljs-string">"xx.xxx.xx.xx1:9300"</span>, <span class="hljs-string">"xx.xxx.xx.xx2:9300"</span>, <span class="hljs-string">"xx.xxx.xx.xx3:9300"</span>]

<span class="hljs-comment"># ---------------------------------- Various -----------------------------------</span>
<span class="hljs-attr">action.destructive_requires_name:</span> <span class="hljs-literal">true</span>
<span class="hljs-comment"># å½“å‰èŠ‚ç‚¹çš„IPåœ°å€</span>
<span class="hljs-attr">transport.host:</span> <span class="hljs-string">xx</span>
<span class="hljs-attr">transport.tcp.port:</span> <span class="hljs-number">9300</span>

<span class="hljs-comment"># ------------------------ X-Pack Security Settings ------------------------</span>
<span class="hljs-comment"># ä»¥ä¸‹å’ŒåŸèŠ‚ç‚¹ä¿æŒä¸€è‡´ï¼Œæ³¨æ„è¯ä¹¦è·¯å¾„è¦æ”¾å¯¹</span>
<span class="hljs-attr">xpack.security.enabled:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">xpack.security.transport.ssl.enabled:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">xpack.security.transport.ssl.verification_mode:</span> <span class="hljs-string">certificate</span>
<span class="hljs-attr">xpack.security.transport.ssl.keystore.path:</span> <span class="hljs-string">certs/elastic-certificates.p12</span>
<span class="hljs-attr">xpack.security.transport.ssl.truststore.path:</span> <span class="hljs-string">certs/elastic-certificates.p12</span>

<span class="hljs-attr">xpack.security.http.ssl.enabled:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">xpack.security.http.ssl.keystore.path:</span> <span class="hljs-string">certs/elastic-certificates.p12</span>
<span class="hljs-attr">xpack.security.http.ssl.truststore.path:</span> <span class="hljs-string">certs/elastic-certificates.p12</span>

<span class="hljs-comment"># å¯†ç ä¿æŒä¸€è‡´</span>
<span class="hljs-attr">xpack.security.transport.ssl.keystore.password:</span> <span class="hljs-string">"xxx"</span>
<span class="hljs-attr">xpack.security.transport.ssl.truststore.password:</span> <span class="hljs-string">"xxx"</span>
<span class="hljs-attr">xpack.security.http.ssl.keystore.password:</span> <span class="hljs-string">"xxx"</span>
<span class="hljs-attr">xpack.security.http.ssl.truststore.password:</span> <span class="hljs-string">"xxx"</span>

<span class="hljs-attr">xpack.security.http.ssl.verification_mode:</span> <span class="hljs-string">certificate</span>
</code></pre>
<p>è¿™é‡Œæ¶‰åŠåˆ°é…ç½®ESå®‰å…¨å±æ€§çš„å†…å®¹ï¼Œæœ‰ä¸äº†è§£çš„å°ä¼™ä¼´å¯ä»¥å‚è€ƒElasticçš„å®˜ç½‘ï¼Œç¬”è€…ä¹‹å‰ä¹Ÿå†™è¿‡ç›¸å…³çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F5v4Q4fyRwD6QSsW96VELRQ" target="_blank" title="https://mp.weixin.qq.com/s/5v4Q4fyRwD6QSsW96VELRQ" ref="nofollow noopener noreferrer"><strong>åšå®¢</strong></a>**ï¼Œ**æ¬¢è¿æ„Ÿå…´è¶£çš„å°ä¼™ä¼´ç‚¹å‡»ç¿»é˜…ï¼Œä¼ é€é—¨ğŸ‘‰ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F5v4Q4fyRwD6QSsW96VELRQ" target="_blank" title="https://mp.weixin.qq.com/s/5v4Q4fyRwD6QSsW96VELRQ" ref="nofollow noopener noreferrer">mp.weixin.qq.com/s/5v4Q4fyRwâ€¦</a></p>
<h3 data-id="heading-7">ä¿®æ”¹æƒé™</h3>
<p>å› ä¸ºeså¤„äºå®‰å…¨è€ƒè™‘ï¼Œä¸¥ç¦rootç”¨æˆ·å¯åŠ¨æœåŠ¡ï¼Œå› æ­¤è¦åœ¨æ–°èŠ‚ç‚¹ä¸Šåˆ›å»ºç›¸å…³çš„ç”¨æˆ·ç»„å¹¶é…ç½®æƒé™ã€‚</p>
<ul>
<li><strong>åˆ›å»ºç”¨æˆ·ç»„</strong></li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºç”¨æˆ·ç»„</span>
groupadd elsearch
<span class="hljs-comment"># åˆ›å»ºç”¨æˆ·å¹¶åŠ å…¥ç»„</span>
useradd elsearch -g elsearch
<span class="hljs-comment"># è®¾ç½®å¯†ç ï¼ˆå¯é€‰ï¼Œå¦‚æœåªæ˜¯ su åˆ‡æ¢åˆ™ä¸ä¸€å®šéœ€è¦ï¼‰</span>
<span class="hljs-comment"># passwd elsearch</span>
</code></pre>
<ul>
<li><strong>æ“ä½œç›®å½•æˆæƒ</strong></li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. èµ‹äºˆå®‰è£…ç›®å½•æƒé™</span>
<span class="hljs-built_in">chown</span> -R elsearch:elsearch /opt/es/elasticsearch-7.14.1/

<span class="hljs-comment"># 2. èµ‹äºˆæ•°æ®å’Œæ—¥å¿—ç›®å½•æƒé™ï¼ˆæ ¹æ®ä½ ä¹‹å‰çš„é…ç½®è·¯å¾„ï¼‰</span>
<span class="hljs-built_in">chown</span> -R elsearch:elsearch /usr/local/elasticsearch/data
<span class="hljs-built_in">chown</span> -R elsearch:elsearch /usr/local/elasticsearch/logs
</code></pre>
<ul>
<li><strong>æ£€æŸ¥jvmå †å†…å­˜</strong></li>
</ul>
<p>ç¡®ä¿ç»™æ–°èŠ‚ç‚¹åˆ†é…çš„å†…å­˜ï¼ˆæ¯”å¦‚ -Xms4g -Xmx4gï¼‰ä¸è¦è¶…è¿‡ç³»ç»Ÿå¯ç”¨å†…å­˜çš„ä¸€åŠã€‚</p>
<h3 data-id="heading-8">å¯åŠ¨æ–°èŠ‚ç‚¹å¹¶éªŒè¯åŠ å…¥</h3>
<ul>
<li>å¯åŠ¨</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">su - elsearch -c <span class="hljs-string">"/opt/es/elasticsearch-7.14.1/bin/elasticsearch -d"</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03dfe1b174de4acb803446f1a1ca4037~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdG9ueWRm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767187684&amp;x-signature=dpaWVm7RV3el0FofFv6dNQcDPeQ%3D" alt="" loading="lazy"/></p>
<ul>
<li>å¯åŠ¨æ— è¯¯åï¼Œåˆ°åŸæ¥çš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ä¸ŠéªŒè¯ä¸€ä¸‹åŠ å…¥æƒ…å†µ</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">curl -X GET <span class="hljs-string">"http://10.185.3.176:9200/_cat/nodes?v"</span>
</code></pre>
<p>æ³¨æ„ï¼Œæ­¤æ—¶å³å°†å‡†å¤‡ä¸‹çº¿çš„é‚£ä¸ªèŠ‚ç‚¹è¿˜æ˜¯æ­£å¸¸è¿è¡Œçš„ï¼Œå› æ­¤æ­£å¸¸æƒ…å†µä¸‹ï¼Œåˆ—è¡¨æ•°é‡åº”è¯¥æ˜¯N+1ä¸ªè®°å½•ï¼Œæ¯”å¦‚æˆ‘è¿™é‡ŒåŸæ¥æ˜¯3ä¸ªèŠ‚ç‚¹ï¼Œæ­¤æ—¶å°±æ˜¯4ä¸ªã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3144f58fa7204f4287923a073fb3763d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdG9ueWRm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767187684&amp;x-signature=Zi7TEOjl%2BlTnnxOcomUQ6xgeVP0%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-9">è§¦å‘åˆ†ç‰‡é©±é€ ï¼ˆè¿ç§»æ•°æ®ï¼‰</h3>
<p>è¿™ä¸€æ­¥å°±æ˜¯è®©é›†ç¾¤ä¸»åŠ¨çš„â€œè¸¢æ‰â€å‡†å¤‡ä¸‹çº¿çš„é‚£ä¸ªèŠ‚ç‚¹ï¼Œå¹¶æŠŠé‚£ä¸ªèŠ‚ç‚¹ä¸Šçš„æ•°æ®åŒæ­¥åˆ°å…¶ä»–èŠ‚ç‚¹ï¼Œè¿™æ­£æ˜¯ElasticSearchä½œä¸ºä¸€ä¸ªåˆ†å¸ƒå¼æ—¥å¿—ç³»ç»Ÿçš„å¼ºå¤§ä¹‹å¤„ï¼</p>
<pre><code class="hljs language-bash" lang="bash">curl -X PUT <span class="hljs-string">"http://{xxx,è¿™é‡Œæ˜¯åœ¨ä¸€ä¸ªåŸæœ‰çš„èŠ‚ç‚¹ä¸Š}:9200/_cluster/settings"</span> -H <span class="hljs-string">'Content-Type: application/json'</span> -d<span class="hljs-string">'
{
  "transient": {
    "cluster.routing.allocation.exclude._ip": "{è¢«é©±é€çš„èŠ‚ç‚¹ip}"
  }
}'</span>
</code></pre>
<p>æ‰§è¡Œåçš„å“åº”å¦‚ä¸‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab514a2eccd549de9d0639807371af3f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdG9ueWRm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767187684&amp;x-signature=mZbuzEElY7Boi6ZVi1V5b9VTzqI%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-10">ç›‘æ§è¿ç§»è¿›åº¦</h3>
<p>å¯ä»¥é€šè¿‡ä¸€ä¸‹å‘½ä»¤è§‚å¯Ÿå¾…é©±é€çš„èŠ‚ç‚¹shardsæ•°é‡å˜åŒ–ï¼Œç›´åˆ°å®ƒå˜æˆ0ï¼Œè¿™ä¸€æ­¥éœ€è¦ä¸€å®šçš„æ‰§è¡Œæ—¶é—´ï¼Œæ—¶é—´é•¿çŸ­å’Œæ—¥å¿—æ–‡ä»¶çš„å¤§å°æœ‰å…³ï¼Œè€å¿ƒç­‰å¾…å³å¯ã€‚</p>
<pre><code class="hljs language-plain" lang="plain">curl -u elastic -k "https://xx.xxx.xx.xxx:9200/_cat/allocation?v"
</code></pre>
<p>ä¹Ÿå¯ä»¥å€ŸåŠ©ä¸€äº›å¯è§†åŒ–çš„ç›‘æ§å·¥å…·æŸ¥çœ‹è¿ç§»è¿›åº¦</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11980622041d41a98a54d05260e19d59~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdG9ueWRm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767187684&amp;x-signature=M2yzQfvb91lB62o0NdePNqPdbNE%3D" alt="" loading="lazy"/></p>
<p>è¿ç§»å®Œæˆå</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e98349de500e493da190f6c069bf5840~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdG9ueWRm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767187684&amp;x-signature=H%2FNl4UPcW3iEz5sCvVKXdscIFBE%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-11">æ”¶å°¾ä¸é…ç½®åˆ·æ–°</h3>
<p>ä¸Šä¸€æ­¥å®Œæˆæ”¶ï¼Œçº¿ä¸Šçš„ESé›†ç¾¤å®é™…ä¸Šå°±å·²ç»æ˜¯å…¨æ–°çš„é›†ç¾¤äº†ï¼Œä½†ç”±äºåŸæ¥çš„é›†ç¾¤èŠ‚ç‚¹æˆ‘ä»¬è¿˜æ²¡æœ‰ä¿®æ”¹ï¼Œå½“æœåŠ¡é‡å¯åï¼Œè¿˜æ˜¯ä¼šæœ‰é—®é¢˜ã€‚æ‰€ä»¥æˆ‘ä»¬è¿˜è¦é€ä¸€ä¿®æ”¹åŸæœ‰çš„èŠ‚ç‚¹é…ç½®ï¼Œè¿™é‡Œåªè¦é…ç½®æœåŠ¡å‘ç°çš„èŠ‚ç‚¹æ•°ç»„å¯¹è±¡å°±å¯ä»¥äº†</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä»¥ä¸‹xxxä»£è¡¨å®é™…çš„ipåœ°å€</span>
discovery.seed_hosts: [<span class="hljs-string">"xxx1:9300"</span>, <span class="hljs-string">"xxx2:9300"</span>, <span class="hljs-string">"xxx3:9300"</span>]
</code></pre>
<p>ä¿®æ”¹å®Œæˆåï¼Œè¿˜è¦æ¥è§¦å‰é¢è®¾ç½®çš„é©±é€é™åˆ¶,è¿™ä¸€æ­¥ä¹Ÿå¾ˆé‡è¦ï¼Œå¦åˆ™æ–°èŠ‚ç‚¹ä»¥åä¹Ÿä¼šå—é™</p>
<pre><code class="hljs language-bash" lang="bash">curl -u elastic -k -X PUT <span class="hljs-string">"https://xxx:9200/_cluster/settings?pretty"</span> -H <span class="hljs-string">'Content-Type: application/json'</span> -d<span class="hljs-string">'
{
  "transient": {
    "cluster.routing.allocation.exclude._ip": null
  }
}'</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e5bfdf208f74beda7407708a5687a82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdG9ueWRm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767187684&amp;x-signature=%2FFfNAGY7NGRkPtbyl8F9WXYCr0U%3D" alt="" loading="lazy"/></p>
<p>å…¨éƒ¨æ‰§è¡Œå®Œæˆåï¼Œéœ€è¦æŠŠé›†ç¾¤å†…æ‰€æœ‰çš„èŠ‚ç‚¹å†é‡å¯ä¸€éï¼Œè™½ç„¶æœ‰ç‚¹ç¹çï¼Œä½†è¿™æ˜¯å¿…é¡»çš„ï¼Œé‡å¯å®Œæˆåï¼Œçœ‹ä¸€ä¸‹é›†ç¾¤çŠ¶æ€</p>
<pre><code class="hljs language-bash" lang="bash">curl -u elastic -k https://xxx:9200/_cluster/health?pretty
</code></pre>
<p>æˆ–è€…é€šè¿‡ç®¡ç†é¢æ¿æŸ¥çœ‹ï¼Œå˜æˆâ€œGreenâ€å³å¯</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/931e471f9e8b43049f22b82fca852acf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdG9ueWRm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767187684&amp;x-signature=3PTSd7dfZ3n4SRuzVbvXorX19Fg%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eaec8a6826774191a94058c52ae87216~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdG9ueWRm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767187684&amp;x-signature=CQXdG63l%2F5d%2BQkOkR0yU6nTqDX8%3D" alt="" loading="lazy"/></p>
<p>å¥½äº†ï¼Œå€¼æ­¤ElasticSearchçš„è¿ç§»å·¥ä½œå®Œæˆï¼Œå¯ä»¥æŠŠå‡†å¤‡æ›¿æ¢çš„é‚£å°èŠ‚ç‚¹ä¸Šçš„esèŠ‚ç‚¹å¹²æ‰äº†ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">ps -ef | grep elasticsearch | grep -v grep | awk <span class="hljs-string">'{print $2}'</span> | xargs <span class="hljs-built_in">kill</span> -9
</code></pre>
<p>æ³¨æ„ï¼Œè¿™é‡Œåˆ«å¿˜äº†è¦æŠŠæ–°å¢èŠ‚ç‚¹ä¸Šçš„ç«¯å£æ”¾å¼€</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¼€æ”¾ 9200 å’Œ 9300 ç«¯å£</span>
firewall-cmd --permanent --add-port=9200/tcp
firewall-cmd --permanent --add-port=9300/tcp

<span class="hljs-comment"># é‡æ–°åŠ è½½é˜²ç«å¢™é…ç½®ä½¿ç”Ÿæ•ˆ</span>
firewall-cmd --reload

<span class="hljs-comment"># æŸ¥çœ‹æ˜¯å¦ç”Ÿæ•ˆ</span>
firewall-cmd --list-ports
</code></pre>
<h4 data-id="heading-12"/>
<h2 data-id="heading-13">ç¬¬ä¸‰é˜¶æ®µï¼šKafkaèŠ‚ç‚¹å¹³æ»‘è¿ç§»</h2>
<h3 data-id="heading-14">ä¿®æ”¹é…ç½®</h3>
<p>å’Œesçš„è¿ç§»ä¸€æ ·ï¼Œæˆ‘è¿™é‡Œä¹Ÿæ˜¯æå‰æŠŠå®‰è£…æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶ç­‰éƒ½æ‹·è´åˆ°äº†æ–°èŠ‚ç‚¹ï¼Œç„¶åä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œæˆ‘è¿™é‡Œçš„Kafkaé›†ç¾¤ä½¿ç”¨çš„æ–°çš„Kraftæ¨¡å¼ï¼Œè¿™é‡Œä¿®æ”¹çš„æ˜¯Kraftç›®å½•é‡Œçš„é…ç½®ï¼Œä¸»è¦ä¿®æ”¹voterså‚æ•°å’Œnode.idï¼Œæ³¨æ„node.idå¿…é¡»æ˜¯ä¸€ä¸ªé›†ç¾¤é‡Œæ²¡å‡ºç°è¿‡çš„id</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">############################# Server Basics #############################</span>
<span class="hljs-comment"># åŸºæœ¬é…ç½®</span>
process.roles=broker,controller
node.id=214
controller.quorum.voters=214@xxx:9093,178@xxx:9093,176@xxx:9093


<span class="hljs-comment"># =============================é»˜è®¤é…ç½®======================= #</span>
listeners=PLAINTEXT://xxx:9092,CONTROLLER://10.185.3.214:9093

inter.broker.listener.name=PLAINTEXT
advertised.listeners=PLAINTEXT://xxx:9092
listener.security.protocol.map=CONTROLLER:PLAINTEXT,PLAINTEXT:PLAINTEXT,SSL:SSL,SASL_PLAINTEXT:SASL_PLAINTEXT,SASL_SSL:SASL_SSL
<span class="hljs-comment"># ========================================é»˜è®¤é…ç½®ç»“æŸ=================================== #</span>

controller.listener.names=CONTROLLER
process.cluster.id=xxxx
num.network.threads=3
num.io.threads=8
socket.send.buffer.bytes=102400
socket.receive.buffer.bytes=102400
socket.request.max.bytes=104857600


<span class="hljs-comment">############################# Log Basics #############################</span>

log.dirs=/usr/kafka/kraft-combined-logs
num.partitions=3
default.replication.factor=3
num.recovery.threads.per.data.dir=1
offsets.topic.replication.factor=3
transaction.state.log.replication.factor=3
transaction.state.log.min.isr=2

log.retention.hours=168
log.segment.bytes=1073741824
log.retention.check.interval.ms=300000

</code></pre>
<h3 data-id="heading-15">èŠ‚ç‚¹ç¯å¢ƒå‡†å¤‡</h3>
<p>å’ŒElasticSearchçš„è¿ç§»ä¸€æ ·ï¼Œåˆ›å»ºç”¨æˆ·ç»„å’Œæˆæƒ</p>
<pre><code class="hljs language-bash" lang="bash">groupadd kafka &amp;&amp; useradd kafka -g kafka
<span class="hljs-built_in">mkdir</span> -p /usr/kafka/kraft-combined-logs
<span class="hljs-built_in">chown</span> -R kafka:kafka /usr/kafka/kraft-combined-logs
<span class="hljs-built_in">chown</span> -R kafka:kafka /home/tony/kafka/
</code></pre>
<h3 data-id="heading-16">æ•°æ®é‡åˆ†é… *</h3>
<blockquote>
<p>è¿™ä¸€æ­¥ï¼Œçœ‹ä½ çš„Kafkaå®é™…ä½œç”¨ï¼Œå¦‚æœåªæ˜¯ä¼ é€’å®æ—¶æ¶ˆæ¯ï¼Œé‚£è¿ç§»å®Œæˆåç›´æ¥é‡ç½®æ¶ˆæ¯æ—¥å¿—ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå‰ææ˜¯ä½ ç¡®å®ä¸éœ€è¦è¿ç§»çš„å“ˆ</p>
</blockquote>
<ul>
<li>æå–åŸæ¥çš„Topic</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…ˆæŠŠæ‰€æœ‰ topic åå­—æå‡ºæ¥ï¼Œå­˜åˆ° topics.txt</span>
bin/kafka-topics.sh --bootstrap-server xx.xxx:9092 --list | grep -v <span class="hljs-string">"__consumer_offsets"</span> &gt; topics.txt

<span class="hljs-comment"># å°†å…¶è½¬æ¢ä¸º Kafka è¯†åˆ«çš„jsonæ ¼å¼</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">'{"topics": ['</span> &gt; topics-to-move.json
sed <span class="hljs-string">'s/.*/  {"topic": "&amp;"},/'</span> topics.txt | sed <span class="hljs-string">'$s/,$//'</span> &gt;&gt; topics-to-move.json
<span class="hljs-built_in">echo</span> <span class="hljs-string">'], "version": 1}'</span> &gt;&gt; topics-to-move.json
</code></pre>
<p>è¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ªå®Œæ•´çš„ topics-to-move.jsonã€‚</p>
<ul>
<li>ç”Ÿæˆè¿ç§»æ–¹æ¡ˆ</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">bin/kafka-reassign-partitions.sh --bootstrap-server 10.185.3.176:9092 \
--topics-to-move-json-file topics-to-move.json \
--broker-list <span class="hljs-string">"176,178,214"</span> \
--generate
</code></pre>
<p>ä¸Šé¢çš„176è¿™äº›ï¼Œå°±æ˜¯node.idçš„åç§°ï¼Œè¿™ä¸ªè¦ç¡®ä¿é›†ç¾¤å†…å”¯ä¸€</p>
<p>æ‰§è¡Œåï¼Œå±å¹•ä¼šæ‰“å°å‡ºä¸¤æ®µé•¿é•¿çš„jsonä¸²ï¼Œæˆ‘ä»¬éœ€è¦æŠŠç¬¬äºŒæ®µï¼ˆproposed partition reassignment configurationï¼‰ä¸‹é¢çš„å…¨éƒ¨å†…å®¹æ‹·è´ä¸‹æ¥ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œæ¯”å¦‚execute-reassign.json</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/31e94ca5e06345dc9c8c4a4db3173176~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdG9ueWRm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767187684&amp;x-signature=V9wVTzBOLftYA1nSn3jhy%2BsGy3E%3D" alt="" loading="lazy"/></p>
<ul>
<li>æ¬å®¶</li>
</ul>
<p>ä¸Šé¢æ–‡ä»¶ä¿å­˜åï¼Œå°±å¯ä»¥æ¬å®¶äº†</p>
<pre><code class="hljs language-bash" lang="bash">./bin/kafka-reassign-partitions.sh --bootstrap-server 10.185.3.176:9092 \
--reassignment-json-file execute-reassign.json \
--execute
</code></pre>
<p>æ‰§è¡Œè¿™ä¸ªå‘½ä»¤æŸ¥çœ‹æ¬å®¶è¿›åº¦</p>
<pre><code class="hljs language-bash" lang="bash">./bin/kafka-reassign-partitions.sh --bootstrap-server xxx:9092 \
--reassignment-json-file execute-reassign.json \
--verify
</code></pre>
<p>å¦‚æœçœ‹åˆ° Reassignment of partition ... is in progressï¼Œå°±è¯´æ˜æ¬å®¶æ­£åœ¨è¿›è¡Œä¸­ã€‚ç›´åˆ°æ‰€æœ‰åˆ†åŒºéƒ½æ˜¾ç¤ºï¼š Status: completed successfullyã€‚æ­¤æ—¶ï¼Œä½ å¯ä»¥å»æ–°èŠ‚ç‚¹çš„å­˜å‚¨ç›®å½•çœ‹ä¸€çœ¼ï¼Œç¡®è®¤æ•°æ®é‡æ˜¯å¦å·²ç»ä¸Šæ¥ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02dc84c425874c6cad03b2e00794237d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdG9ueWRm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767187684&amp;x-signature=gonOvHsJNi5EYDx280QYkuGwKK8%3D" alt="" loading="lazy"/></p>
<p>ç­‰åŸèŠ‚ç‚¹è¢«æç©ºåï¼Œå°±å¯ä»¥ä¸‹çº¿æ‰å®ƒäº†ï¼Œè‡³æ­¤ï¼ŒKafkaé›†ç¾¤å·²ç»æ˜¯å…¨æ–°çš„é›†ç¾¤äº†</p>
<h3 data-id="heading-17">æ”¶å°¾ä¸é…ç½®åˆ·æ–°</h3>
<p>å’Œesçš„è¿ç§»ä¸€æ ·ï¼Œè¿™é‡Œé›†ç¾¤é‡ŒåŸæ¥çš„èŠ‚ç‚¹ä¹Ÿè¦è¿›è¡Œä¿®æ”¹ï¼Œä¸»è¦æ˜¯ä¿®æ”¹controller.quorum.votersï¼Œé›†ç¾¤é‡Œæ¯ä¸ªèŠ‚ç‚¹çš„é…ç½®è¦ä¿æŒä¸€è‡´ã€‚</p>
<p>ç„¶åæ»šåŠ¨é‡å¯å³å¯</p>
<h3 data-id="heading-18">å¯èƒ½å‡ºç°çš„é—®é¢˜ *</h3>
<p>è¿ç§»Kafkaçš„æ—¶å€™ï¼Œéå¸¸å®¹æ˜“å‡ºç°é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œå°±é‡åˆ°äº†ä¸‹é¢è¿™ä¸ªé—®é¢˜ï¼Œå®é™…ä¸Šè¿™ä¸ªé”™è¯¯å°±æ˜¯kafkaåœ¨è¿›è¡Œä¸‰æ–¹æ ¡éªŒçš„æ—¶å€™å‡ºé”™äº†ï¼Œå…ƒæ•°æ®æ—¥å¿—é‡Œè®°å½•äº†æ—§é›†ç¾¤çš„çŠ¶æ€ï¼Œå¯ä»¥é€šè¿‡ç¼–è¾‘æˆ–è€…æŸ¥çœ‹/usr/kafka/kafka-3.8-176/kraft-combined-logs/meta.propertiesè¿™ä¸ªæ–‡ä»¶æ¥ç¡®è®¤</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/baa65456a47741b5bbd031862f6c245d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdG9ueWRm:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767187684&amp;x-signature=VXhsB9QlMFjjDQ%2B0mfh9GS5R7iQ%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä¹Ÿè¯•è¿‡æ‰‹åŠ¨ä¿®æ”¹è¿™ä¸ªå…ƒæ•°æ®æ–‡ä»¶ï¼Œä½†ä¸èµ·ä½œç”¨ï¼Œå¦‚æœå‰é¢çš„æ•°æ®é‡æ–°åˆ†é…æ­¥éª¤å·²ç»å®Œæˆï¼Œæˆ–è€…è¯´ä½ ä¸éœ€è¦é‡æ´—åˆ†é…ï¼Œé‚£æœ€ç®€å•è›®ç²—æš´çš„æ–¹æ³•å°±æ˜¯é‡ç½®ä»–ä»¬ã€‚</p>
<ul>
<li>åœæ­¢æ‰€æœ‰kafkaçš„è¿›ç¨‹</li>
<li>æ¸…ç©ºå…ƒæ•°æ®ï¼ˆæ…é‡ï¼‰</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">rm</span> -rf /usr/kafka/kraft-combined-logs/*
</code></pre>
<ul>
<li>é‡æ–°æ ¼å¼åŒ–</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">su - kafka -c <span class="hljs-string">"/home/tony/kafka/kafka_2.12-3.8.0/bin/kafka-storage.sh format -t {é…ç½®æ–‡ä»¶é‡Œè®¾ç½®çš„é›†ç¾¤id} -c /home/tony/kafka/kafka_2.12-3.8.0/config/kraft/server-cluser.properties"</span>
</code></pre>
<ul>
<li>é‡å¯</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">su - kafka -c <span class="hljs-string">"/home/tony/kafka/kafka_2.12-3.8.0/bin/kafka-server-start.sh -daemon /home/tony/kafka/kafka_2.12-3.8.0/config/kraft/server-cluser.properties"</span>
</code></pre>
<h3 data-id="heading-19">ç¬¬å››é˜¶æ®µï¼šå®šæœŸæ‰“æ‰«</h3>
<h4 data-id="heading-20">ESæ—¥å¿—è‡ªåŠ¨æ¸…ç†</h4>
<p>æˆ‘ä»¬çš„åœºæ™¯é‡Œï¼ŒESæœé›†çš„æ˜¯æ‰€æœ‰ä¸šåŠ¡ç³»ç»Ÿçš„æ“ä½œæ—¥å¿—ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®šä½é—®é¢˜ã€‚ä½†é—®é¢˜å°±æ˜¯æ—¥å¿—é‡æ¯”è¾ƒåºå¤§ï¼Œæˆ‘è¿™é‡Œçš„ç­–ç•¥æ˜¯å†™äº†ä¸€ä¸ªç›‘æ§ç¨‹åºï¼Œè·‘åœ¨ä¸€å°ä¸šåŠ¡æœåŠ¡å™¨ï¼Œç„¶åæ»šåŠ¨åˆ é™¤æ—¥æœŸæ¯”è¾ƒæ—©çš„æ—¥å¿—ã€‚è¿™éƒ¨åˆ†æˆ‘æ˜¯ä½¿ç”¨C#æ¥å…¥ESçš„å®˜æ–¹SDKï¼ŒNESTæ¥åšçš„ï¼Œä»£ç æ¯”è¾ƒç®€å•ä¸åœ¨çŒå…¥ã€‚</p>
<blockquote>
<p>è¿™ä¸ªçœ‹å®é™…æƒ…å†µï¼Œæˆ‘ä»¬çš„æƒ…å†µæ˜¯æ¯”è¾ƒæ—©çš„æ—¥å¿—å°±ä¸ä¿ç•™äº†ï¼Œç›´æ¥åˆ é™¤é‡Šæ”¾ç©ºé—´ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ‰“åŒ…ä¸‹è½½ä¸‹æ¥åšå½’æ¡£ã€‚</p>
</blockquote>
<h4 data-id="heading-21">Kafkaæ—¥å¿—è‡ªåŠ¨æ¸…ç†ä»»åŠ¡</h4>
<p>Kafkaäº§ç”Ÿçš„æŒä¹…åŒ–æ•°æ®ä¸»è¦æœ‰æœ‰ä¸šåŠ¡æ•°æ®å’Œé›†ç¾¤å…ƒæ•°æ®ï¼Œå…¶ä¸­å­˜å‚¨åœ¨â€œ/kraft-combined-logs/â€è·¯å¾„ä¸‹çš„æ–‡ä»¶ç»å¯¹ä¸èƒ½æ‰‹åŠ¨åˆ é™¤ï¼ŒKafkaæœ¬èº«ä¼šè‡ªåŠ¨æ¸…ç†å®ƒã€‚è€Œåœ¨å®‰è£…æ–‡ä»¶çš„logsç›®å½•ä¸‹äº§ç”Ÿçš„ç›®å½•æ˜¯å¯ä»¥åˆ é™¤çš„ï¼Œè€Œä¸”ä»–ä¹Ÿæ˜¯æ— é™å¢é•¿çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æä¸ªè„šæœ¬ï¼Œç„¶åæŒ‚åˆ°è®¡åˆ’ä»»åŠ¡é‡Œï¼Œå®šæœŸåˆ æ‰ä»–ï¼›</p>
<pre><code class="hljs language-plain" lang="plain">#!/bin/bash

# 1. å®šä¹‰è·¯å¾„
LOG_DIR="/home/tony/kafka/kafka_2.12-3.8.0/logs"
CLEAN_LOG="/home/tony/shells/cleanlog.log"

# ç¡®ä¿å­˜æ”¾æ¸…ç†è®°å½•çš„ç›®å½•å­˜åœ¨
mkdir -p /home/tony/shells

echo "--- å¼€å§‹æ¸…ç†ä»»åŠ¡: $(date +'%Y-%m-%d %H:%M:%S') ---" &gt;&gt; "$CLEAN_LOG"

# 2. ç›´æ¥è·å–æ–‡ä»¶åˆ—è¡¨ï¼Œé¿å…å­ Shell å¯¼è‡´è®¡æ•°å™¨å¤±æ•ˆ
# ä½¿ç”¨ .log.* åŒ¹é…è¢«å‹ç¼©æˆ–åˆ‡åˆ†åçš„å†å²æ—¥å¿—ï¼ˆå¦‚ server.log.2025-12-24-1ï¼‰
files=$(find "$LOG_DIR" -type f -name "*.log.*" -mtime +30)

count=0
for file in $files; do
    if [ -f "$file" ]; then
        rm -f "$file"
        if [ $? -eq 0 ]; then
            echo "[SUCCESS] å·²åˆ é™¤: $file" &gt;&gt; "$CLEAN_LOG"
            ((count++))
        else
            echo "[ERROR] æ— æ³•åˆ é™¤: $file" &gt;&gt; "$CLEAN_LOG"
        fi
    fi
done

# 3. è®°å½•æ€»ç»“
echo "æœ¬æ¬¡ä»»åŠ¡å…±æ¸…ç† $count ä¸ªæ–‡ä»¶." &gt;&gt; "$CLEAN_LOG"
echo "------------------------------------------------" &gt;&gt; "$CLEAN_LOG"
</code></pre>
<hr/>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¾‘è®¡åˆ’ä»»åŠ¡</span>
crontab -e

<span class="hljs-comment"># æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼ˆæ¯å¤©å‡Œæ™¨ 02:00 æ‰§è¡Œä¸€æ¬¡ï¼‰</span>
00 02 * * * /bin/bash /home/tony/shells/clean_kafka_log.sh &gt; /dev/null 2&gt;&amp;1
</code></pre>
<h2 data-id="heading-22">ç¬¬äº”é˜¶æ®µï¼šæå®šrabbitmqå’Œpg</h2>
<p>è¿™ä¸¤ä¸ªåœ¨æˆ‘è¿™é‡Œå°±æ˜¯å¼€å‘æµ‹è¯•ç”¨ï¼Œæ‰€ä»¥æˆ‘å°±æ˜¯å‚ç…§å®˜æ–¹æ–‡æ¡£å’Œç½‘ä¸Šçš„ä¸€äº›æ•™ç¨‹è¿˜æœ‰AIçš„æ­é…ï¼Œé‡æ–°å®‰è£…çš„ï¼Œä½†æ˜¯pgå®‰è£…å®Œæˆåæœ‰ä¸€ä¸ªæ•°æ®æ¢å¤çš„è¿‡ç¨‹ï¼Œè¿™é‡Œç®€å•è¿‡ä¸€ä¸‹å§</p>
<h3 data-id="heading-23">PostgreSQL</h3>
<p>pgçš„å®‰è£…æˆ‘é‡‡ç”¨çš„æ˜¯æºç å®‰è£…æ–¹å¼ï¼Œå› ä¸ºæˆ‘è¿™é‡Œæ˜¯open Eulerç³»ç»Ÿï¼Œå®˜æ–¹çš„æä¾›rpmåŒ…æˆ‘è¯•ç€å®‰è£…å¤±è´¥ï¼Œæ‰€ä»¥æ”¹æˆäº†é€šè¿‡æºç çš„æ–¹å¼ã€‚å…·ä½“å¤§å®¶å‚è€ƒå®˜ç½‘å°±å¥½ã€‚</p>
<ul>
<li>å®‰è£…ä¾èµ–</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">sudo dnf check-update
sudo dnf install -y gcc gcc-c++ make readline-devel zlib-devel openssl-devel libicu-devel systemd-devel bison flex
</code></pre>
<ul>
<li>åˆ›å»ºç”¨æˆ·ä¸ç›®å½•</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»º postgres ç”¨æˆ·ç»„å’Œç”¨æˆ·</span>
sudo groupadd postgres
sudo useradd -g postgres postgres

<span class="hljs-comment"># åˆ›å»ºå®‰è£…ç›®å½•å’Œæ•°æ®ç›®å½•</span>
sudo <span class="hljs-built_in">mkdir</span> -p /opt/pgsql17
sudo <span class="hljs-built_in">mkdir</span> -p /var/lib/pgsql/17/data
sudo <span class="hljs-built_in">chown</span> -R postgres:postgres /opt/pgsql17 /var/lib/pgsql/17/data
</code></pre>
<ul>
<li>ä¸‹è½½å®‰è£…æºç </li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ‡æ¢åˆ°ä¸´æ—¶ç›®å½•</span>
<span class="hljs-built_in">cd</span> /usr/local/src

<span class="hljs-comment"># ä¸‹è½½ PG 17.6 æºç </span>
sudo wget https://ftp.postgresql.org/pub/source/v17.6/postgresql-17.6.tar.gz

<span class="hljs-comment"># è§£å‹</span>
sudo tar -zxvf postgresql-17.6.tar.gz
<span class="hljs-built_in">cd</span> postgresql-17.6
</code></pre>
<ul>
<li>é…ç½®ç¼–è¯‘</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é…ç½®ï¼ˆå¯ç”¨ OpenSSL å’Œ Systemd æ”¯æŒï¼‰</span>
./configure --prefix=/opt/pgsql17 \
            --with-openssl \
            --with-systemd \
            --with-icu

<span class="hljs-comment"># ç¼–è¯‘</span>
make

<span class="hljs-comment"># å®‰è£…</span>
sudo make install
</code></pre>
<p>makeçš„æ—¶å€™ä¼šæ¶ˆè€—ä¸€ç‚¹æ—¶é—´</p>
<ul>
<li>é…ç½®ç¯å¢ƒå˜é‡</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¾‘ /etc/profile.d/pgsql.sh</span>
sudo bash -c <span class="hljs-string">'cat &gt; /etc/profile.d/pgsql.sh &lt;&lt; EOF
export PGHOME=/opt/pgsql17
export PGDATA=/var/lib/pgsql/17/data
export PATH=\$PGHOME/bin:\$PATH
EOF'</span>

<span class="hljs-comment"># ä½¿é…ç½®ç”Ÿæ•ˆ</span>
<span class="hljs-built_in">source</span> /etc/profile.d/pgsql.sh
</code></pre>
<ul>
<li>åˆå§‹åŒ–æ•°æ®åº“</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ‡æ¢ç”¨æˆ·</span>
sudo -i -u postgres

<span class="hljs-comment"># æ‰§è¡Œåˆå§‹åŒ–</span>
/opt/pgsql17/bin/initdb -D /var/lib/pgsql/17/data --locale=en_US.UTF-8 --encoding=UTF8

<span class="hljs-comment"># é€€å‡ºç”¨æˆ·</span>
<span class="hljs-built_in">exit</span>
</code></pre>
<ul>
<li>é…ç½®å¼€æœºå¯åŠ¨</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">sudo vim /etc/systemd/system/postgresql-17.service
</code></pre>
<p>å†™å…¥ä¸‹é¢å†…å®¹ï¼ˆè¿™äº›æ•™ç¨‹ä¸Šéƒ½æœ‰ï¼Œæˆ‘ä¹Ÿæ˜¯copyçš„ï¼Œè¿™é‡Œç›´æ¥é•œåƒä¸€ä»½ï¼‰</p>
<pre><code class="hljs language-bash" lang="bash">[Unit]
Description=PostgreSQL 17 database server
After=network.target

[Service]
Type=notify
User=postgres
Group=postgres
ExecStart=/opt/pgsql17/bin/postmaster -D /var/lib/pgsql/17/data
ExecReload=/bin/kill -HUP <span class="hljs-variable">$MAINPID</span>
KillMode=mixed
KillSignal=SIGINT
TimeoutSec=0

[Install]
WantedBy=multi-user.target
</code></pre>
<ul>
<li>å¯åŠ¨å’ŒéªŒè¯</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é‡æ–°åŠ è½½ç³»ç»ŸæœåŠ¡</span>
sudo systemctl daemon-reload

<span class="hljs-comment"># å¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯</span>
sudo systemctl <span class="hljs-built_in">enable</span> --now postgresql-17

<span class="hljs-comment"># æ£€æŸ¥çŠ¶æ€</span>
sudo systemctl status postgresql-17
</code></pre>
<ul>
<li>æ¢å¤å¤‡ä»½</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ‡æ¢åˆ° postgres ç”¨æˆ·</span>
sudo -i -u postgres

<span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªæ–°æ•°æ®åº“ï¼ˆä¾‹å¦‚å« mydbï¼‰</span>
createdb mydb

<span class="hljs-comment"># -d æŒ‡å®šç›®æ ‡æ•°æ®åº“ï¼Œ-f æŒ‡å®šå¤‡ä»½æ–‡ä»¶è·¯å¾„</span>
psql -d mydb -f /root/pgbackup/pg14_full_backup.sql
</code></pre>
<ul>
<li>æˆ‘è¿™é‡Œæ˜¯å…¨é‡å¤‡ä»½çš„ï¼Œæ‰€ä»¥ç›´æ¥è¿™æ ·</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">psql -f /tmp/pg14_full_backup.sql postgres
</code></pre>
<blockquote>
<p>åŸèŠ‚ç‚¹çš„pgç‰ˆæœ¬æ˜¯14ï¼Œæ–°èŠ‚ç‚¹æ˜¯17</p>
</blockquote>
<ul>
<li>å¼‚å¸¸å¤„ç†</li>
</ul>
<p>æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒopenEulerå¼€å¯äº†ç”¨é‚£ä¸ªçš„æƒé™æ§åˆ¶ï¼Œæ‰€ä»¥å¯èƒ½è¦åªingä¸€ä¸‹æ“ä½œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¡®ä¿ postgres ç”¨æˆ·å¯¹äºŒè¿›åˆ¶æ–‡ä»¶å¤¹æœ‰è¿›å…¥æƒé™ã€‚</span>
sudo <span class="hljs-built_in">chmod</span> +x /opt/pgsql17/bin/postgres
sudo <span class="hljs-built_in">chown</span> -R postgres:postgres /opt/pgsql17
<span class="hljs-comment"># openEuler çš„ SELinux å¯èƒ½ä¼šé˜»æ­¢è‡ªå®šä¹‰è·¯å¾„ä¸‹çš„ç¨‹åºæ‰§è¡Œã€‚ä½ å¯ä»¥ä¸´æ—¶å…³é—­å®ƒæµ‹è¯•ä¸€ä¸‹</span>
sudo setenforce 0
<span class="hljs-comment"># ç„¶ååœ¨é‡å¯ä¸‹</span>
</code></pre>
<h3 data-id="heading-24">RabbitMQ</h3>
<p>ä¸Šé¢pgçš„å®‰è£…è¯´äº†å¤ªå¤šäº†ï¼Œrabbitmqå°±ç²¾ç®€ç‚¹å§ï¼Œå¤§å®¶è‡ªå·±æœä¸€ä¸‹ä¹Ÿè¡Œï¼Œè€Œä¸”ä»–è¿™ä¸ªæœ‰<a href="https://link.juejin.cn?target=https%3A%2F%2Frabbitmq.org.cn%2Fdocs" target="_blank" title="https://rabbitmq.org.cn/docs" ref="nofollow noopener noreferrer">ä¸­æ–‡æ–‡æ¡£</a>ï¼Œä¹Ÿå¾ˆè¯¦ç»†ã€‚æˆ‘è¿™é‡Œå°±ä¸å¤šè¯´äº†å“ˆ</p>
<p>ç›´æ¥è·³è¿‡äº†!</p>
<h2 data-id="heading-25">ç»“è¯­</h2>
<p>ä¸Šé¢è¿™ç‚¹äº‹å„¿ï¼Œç™½å¤©æŠ˜è…¾äº†ä¸€æ•´å¤©ï¼Œæ™šä¸Šè¶ç€çƒ­ä¹èµ¶ç´§æ•´ç†ï¼Œä¸»è¦è¿˜æ˜¯æ€•è‡ªå·±å¿˜äº†ï¼Œå› ä¸ºæœ‰äº›æ­¥éª¤æˆ‘åœ¨ä¹‹å‰éƒ¨ç½²é›†ç¾¤çš„æ—¶å€™ç¡®å®æ˜¯ä¸ç†Ÿç»ƒï¼Œæ‰€ä»¥æŠŠè¿™äº›è¿ç»´çŸ¥è¯†ç‚¹ä¹Ÿç®—æ˜¯å·©å›ºå¯¹é½äº†ä¸€ä¸‹ã€‚æ²¡æƒ³åˆ°ï¼Œä¸€æ•´ç†èµ·æ¥ï¼Œæ´‹æ´‹æ´’æ´’å†™äº†è¿™ä¹ˆå¤šã€‚</p>
<p>æœ€åï¼Œå¸Œæœ›å¤§å®¶çš„æœåŠ¡å™¨ï¼Œæ°¸ä¸å®•æœºï¼Œæ°¸ä¸é‡å¯ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Rustçš„å¤šæ‰€æœ‰æƒæœºåˆ¶]]></title>    <link>https://juejin.cn/post/7587245616754606131</link>    <guid>https://juejin.cn/post/7587245616754606131</guid>    <pubDate>2025-12-24T13:50:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587245616754606131" data-draft-id="7587245616754573363" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Rustçš„å¤šæ‰€æœ‰æƒæœºåˆ¶"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-24T13:50:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="GKunLi"/> <meta itemprop="url" content="https://juejin.cn/user/430664725579725"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Rustçš„å¤šæ‰€æœ‰æƒæœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/430664725579725/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    GKunLi
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T13:50:04.000Z" title="Wed Dec 24 2025 13:50:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Rust ä¸­ï¼Œé€šå¸¸æƒ…å†µä¸‹ä¸€ä¸ªå€¼åªèƒ½æœ‰ä¸€ä¸ªæ‰€æœ‰è€…ï¼ˆOwnerï¼‰ã€‚ä½†åœ¨å®é™…å¼€å‘ï¼ˆå°¤å…¶æ˜¯ Web å¼€å‘ï¼‰ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤šä¸ªåœ°æ–¹åŒæ—¶æŒæœ‰åŒä¸€ä¸ªæ•°æ®ã€‚</p>
<p>æ¯”å¦‚åœ¨ <strong>Actix-web</strong> ä¸­ï¼Œä½ çš„æ•°æ®åº“è¿æ¥æ± æˆ–å…¨å±€é…ç½®éœ€è¦è¢«æ¯ä¸€ä¸ªçº¿ç¨‹ã€æ¯ä¸€ä¸ªè¯·æ±‚å¤„ç†å™¨ï¼ˆHandlerï¼‰å…±äº«ã€‚è¿™æ—¶å€™ï¼Œå•ä¸€æ‰€æœ‰æƒå°±ä¸å¤Ÿç”¨äº†ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒRust æä¾›äº†<strong>å¤šæ‰€æœ‰æƒ</strong>æœºåˆ¶ï¼Œæ ¸å¿ƒå·¥å…·æ˜¯ <code>Rc</code> å’Œ <code>Arc</code>ã€‚</p>
<h2 data-id="heading-0">1. æ ¸å¿ƒå·¥å…·ï¼šå¼•ç”¨è®¡æ•°ï¼ˆReference Countingï¼‰</h2>
<p>å¤šæ‰€æœ‰æƒçš„æœ¬è´¨ä¸æ˜¯â€œå¤åˆ¶æ•°æ®â€ï¼Œè€Œæ˜¯ <strong>â€œå…±äº«æ•°æ®ï¼Œå¹¶è®°å½•æœ‰å¤šå°‘äººåœ¨ç”¨å®ƒâ€</strong>ã€‚</p>
<h3 data-id="heading-1"><code>Rc&lt;T&gt;</code> (Reference Counted)</h3>
<ul>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå•çº¿ç¨‹ç¯å¢ƒã€‚</li>
<li><strong>åŸç†</strong>ï¼šä½ åœ¨å †ä¸Šå­˜ä¸€ä»½æ•°æ®ï¼Œæ¯å½“æœ‰äººæƒ³è¦æ‰€æœ‰æƒï¼Œè®¡æ•°å™¨å°± <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">+</span><span class="mord">1</span></span></span></span></span>ï¼›æœ‰äººä¸ç”¨äº†ï¼Œè®¡æ•°å™¨å°± <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span></span>ã€‚å½“è®¡æ•°å™¨å½’é›¶æ—¶ï¼Œæ•°æ®è‡ªåŠ¨é”€æ¯ã€‚</li>
<li><strong>ç¼ºç‚¹</strong>ï¼šä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</li>
</ul>
<h3 data-id="heading-2"><code>Arc&lt;T&gt;</code> (Atomic Reference Counted)</h3>
<ul>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå¤šçº¿ç¨‹ç¯å¢ƒï¼ˆ<strong>Actix-web å¼€å‘ä¸­æœ€å¸¸ç”¨</strong>ï¼‰ã€‚</li>
<li><strong>åŸç†</strong>ï¼šä½¿ç”¨â€œåŸå­æ“ä½œâ€æ¥æ›´æ–°è®¡æ•°å™¨ï¼Œç¡®ä¿åœ¨å¤šçº¿ç¨‹åŒæ—¶ä¿®æ”¹è®¡æ•°æ—¶ä¸ä¼šå‡ºé”™ã€‚</li>
<li><strong>ä»£ä»·</strong>ï¼šæ¯” <code>Rc</code> ç¨å¾®é‡ä¸€ç‚¹ï¼Œä½†åœ¨ Web å¹¶å‘ç¯å¢ƒä¸‹æ˜¯å¿…é¡»çš„ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-3">2. å½¢è±¡çš„æ¯”å–»ï¼šåˆç§Ÿæˆ¿çš„é’¥åŒ™</h2>
<ul>
<li>
<p><strong>æ™®é€šæ‰€æœ‰æƒ</strong>ï¼šä¸€é—´æˆ¿åªæœ‰ä¸€æŠŠé’¥åŒ™ï¼Œä½ è¦è¿›å»ï¼Œå‰ä¸€ä¸ªäººå¿…é¡»æŠŠé’¥åŒ™å½»åº•ç»™ä½ ï¼ˆMoveï¼‰ã€‚ä»–ç»™ä½ åï¼Œä»–å°±è¿›ä¸å»äº†ã€‚</p>
</li>
<li>
<p><strong>å¤šæ‰€æœ‰æƒ (Arc)</strong> ï¼šæˆ¿é—´è¿˜æ˜¯é‚£é—´æˆ¿ï¼Œä½†æˆ‘ä»¬å¯ä»¥<strong>é…å¾ˆå¤šæŠŠé’¥åŒ™</strong>ã€‚</p>
<ul>
<li>æ¯é…ä¸€æŠŠï¼ˆ<code>.clone()</code>ï¼‰ï¼Œç™»è®°ç°¿ä¸Šçš„â€œäººæ•°â€å°± <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">+</span><span class="mord">1</span></span></span></span></span>ã€‚</li>
<li>æ¯ä¸ªäººç¦»å¼€æ—¶æŠŠé’¥åŒ™è¿˜å›å»ï¼Œäººæ•°å°± <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span></span>ã€‚</li>
<li><strong>æœ€åä¸€ä¸ªäºº</strong>è¿˜é’¥åŒ™å¹¶ç¦»å¼€æ—¶ï¼Œç¯æ‰ä¼šç­ï¼Œæˆ¿é—´ï¼ˆå†…å­˜ï¼‰æ‰ä¼šè¢«å›æ”¶ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-4">3. åœ¨ Actix-web ä¸­çš„å®æˆ˜ç”¨æ³•</h2>
<p>åœ¨ Actix-web ä¸­ï¼Œä½ å‡ ä¹æ¯å¤©éƒ½åœ¨éšå¼æˆ–æ˜¾å¼åœ°ä½¿ç”¨ <code>Arc</code>ã€‚æœ€å…¸å‹çš„ä¾‹å­å°±æ˜¯ <code>web::Data</code>ã€‚</p>
<p>Rust</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> actix_web::{web, App, HttpServer};
<span class="hljs-keyword">use</span> std::sync::Arc;

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">AppState</span> {
    app_name: <span class="hljs-type">String</span>,
}

<span class="hljs-meta">#[actix_web::main]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() <span class="hljs-punctuation">-&gt;</span> std::io::<span class="hljs-type">Result</span>&lt;()&gt; {
    <span class="hljs-comment">// 1. åˆ›å»ºå…±äº«çŠ¶æ€</span>
    <span class="hljs-comment">// web::Data å†…éƒ¨å…¶å®å°±å°è£…äº†ä¸€ä¸ª Arc</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">shared_data</span> = web::Data::<span class="hljs-title function_ invoke__">new</span>(AppState {
        app_name: <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"MyActixApp"</span>),
    });

    HttpServer::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-keyword">move</span> || {
        App::<span class="hljs-title function_ invoke__">new</span>()
            .<span class="hljs-title function_ invoke__">app_data</span>(shared_data.<span class="hljs-title function_ invoke__">clone</span>()) <span class="hljs-comment">// 2. è¿™é‡Œåœ¨ä¸ºæ¯ä¸ªçº¿ç¨‹â€œé…é’¥åŒ™â€</span>
            .<span class="hljs-title function_ invoke__">route</span>(<span class="hljs-string">"/"</span>, web::<span class="hljs-title function_ invoke__">get</span>().<span class="hljs-title function_ invoke__">to</span>(index))
    })
    .<span class="hljs-title function_ invoke__">bind</span>(<span class="hljs-string">"127.0.0.1:8080"</span>)?
    .<span class="hljs-title function_ invoke__">run</span>()
    .<span class="hljs-keyword">await</span>
}
</code></pre>
<hr/>
<h2 data-id="heading-5">4. å…³é”®ç‚¹ï¼šå¤šæ‰€æœ‰æƒä¸ä»£è¡¨â€œå¯å˜â€</h2>
<p>è¿™æ˜¯åˆå­¦è€…æœ€å®¹æ˜“æ··æ·†çš„åœ°æ–¹ï¼š<strong><code>Arc</code> æœ¬èº«åªè®©ä½ â€œçœ‹â€ï¼Œä¸è®©ä½ â€œæ”¹â€ã€‚</strong></p>
<ul>
<li>å¦‚æœä½ æœ‰å¤šæŠŠé’¥åŒ™è¿›å…¥æˆ¿é—´ï¼ˆ<code>Arc</code>ï¼‰ï¼Œä½ ä»¬é»˜è®¤åªèƒ½è¿›å»<strong>å‚è§‚</strong>ã€‚</li>
<li>å¦‚æœå…¶ä¸­ä¸€ä¸ªäººæƒ³è¿›å»<strong>è£…ä¿®ï¼ˆä¿®æ”¹æ•°æ®ï¼‰</strong> ï¼Œå¿…é¡»é…åˆ<strong>å†…éƒ¨å¯å˜æ€§</strong>å·¥å…·ï¼š<code>Mutex</code>ï¼ˆäº’æ–¥é”ï¼‰æˆ– <code>RwLock</code>ï¼ˆè¯»å†™é”ï¼‰ã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼Œåœ¨ Rust åç«¯å¼€å‘ä¸­ï¼Œä½ ç»å¸¸ä¼šçœ‹åˆ°è¿™ç§â€œå ç½—æ±‰â€çš„å†™æ³•ï¼š<code>Arc&lt;Mutex&lt;T&gt;&gt;</code></p>
<blockquote>
<p>æ„æ€æ˜¯ï¼šä¸€ä¸ªå¯ä»¥å¤šçº¿ç¨‹å…±äº«ï¼ˆArcï¼‰çš„ã€èƒ½é”ä½è¿›è¡Œä¿®æ”¹ï¼ˆMutexï¼‰çš„æ•°æ®ã€‚</p>
</blockquote>
<h2 data-id="heading-6">5. æ€»ç»“</h2>





























<table><thead><tr><th><strong>å·¥å…·</strong></th><th><strong>å¤šæ‰€æœ‰æƒï¼Ÿ</strong></th><th><strong>çº¿ç¨‹å®‰å…¨ï¼Ÿ</strong></th><th><strong>å¸¸ç”¨åœºæ™¯</strong></th></tr></thead><tbody><tr><td><code>Box&lt;T&gt;</code></td><td>âŒ å¦</td><td>âŒ å¦</td><td>å †ä¸Šåˆ†é…æ•°æ®ï¼Œå•ä¸€æ‰€æœ‰æƒ</td></tr><tr><td><code>Rc&lt;T&gt;</code></td><td>âœ… æ˜¯</td><td>âŒ å¦</td><td>å•çº¿ç¨‹å†…çš„å¤æ‚æ•°æ®å…±äº«</td></tr><tr><td><code>Arc&lt;T&gt;</code></td><td>âœ… æ˜¯</td><td>âœ… æ˜¯</td><td><strong>Web å¼€å‘ã€å¤šçº¿ç¨‹å…±äº«çŠ¶æ€ã€æ•°æ®åº“è¿æ¥æ± </strong></td></tr></tbody></table>
<h3 data-id="heading-7">1). <code>Box&lt;T&gt;</code>ï¼šåŸºç¡€çš„å †å†…å­˜åˆ†é…</h3>
<blockquote>
<p>åœºæ™¯ï¼šå½“ä½ æœ‰ä¸€ä¸ªéå¸¸å¤§çš„ç»“æ„ä½“ï¼Œä¸å¸Œæœ›åœ¨å‡½æ•°è°ƒç”¨æ—¶åœ¨æ ˆ <strong>ï¼ˆStackï¼‰</strong> ä¸Šé¢‘ç¹æ‹·è´ï¼›æˆ–è€…ä½ éœ€è¦å®šä¹‰é€’å½’ç±»å‹ã€‚</p>
</blockquote>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">BigData</span> {
    data: [<span class="hljs-type">u8</span>; <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>], <span class="hljs-comment">// 1MB çš„å¤§æ•°æ®</span>
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// å°†å¤§æ•°æ®æ”¾å…¥å †ï¼ˆHeapï¼‰ä¸­ï¼Œæ ˆä¸Šåªä¿ç•™ä¸€ä¸ªæŒ‡é’ˆ</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">boxed_data</span> = <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(BigData {
        data: [<span class="hljs-number">0</span>; <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>],
    });

    <span class="hljs-comment">// ä¼ é€’æ—¶éå¸¸å¿«ï¼Œåªç§»åŠ¨æŒ‡é’ˆ</span>
    <span class="hljs-title function_ invoke__">process_data</span>(boxed_data);
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">process_data</span>(data: <span class="hljs-type">Box</span>&lt;BigData&gt;) {
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å¤„ç†äº† {} å­—èŠ‚çš„æ•°æ®"</span>, data.data.<span class="hljs-title function_ invoke__">len</span>());
}
</code></pre>
<h3 data-id="heading-8">2). <code>Rc&lt;T&gt;</code>ï¼šå•çº¿ç¨‹å†…çš„å¤šå¤„å…±äº«</h3>
<blockquote>
<p>åœºæ™¯ï¼šåœ¨ GUI å¼€å‘æˆ–å•çº¿ç¨‹é€»è¾‘ä¸­ï¼Œæœ‰å¤šä¸ªå¯¹è±¡éœ€è¦å¼•ç”¨åŒä¸€ä¸ªé…ç½®ï¼Œä¸”æ²¡æœ‰çº¿ç¨‹å®‰å…¨å‹åŠ›ã€‚</p>
</blockquote>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::rc::Rc;

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Config</span> {
    theme: <span class="hljs-type">String</span>,
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">common_config</span> = Rc::<span class="hljs-title function_ invoke__">new</span>(Config {
        theme: <span class="hljs-string">"Dark"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),
    });

    <span class="hljs-comment">// å…‹éš† Rcï¼Œå¢åŠ è®¡æ•°ï¼Œä¸æ‹·è´æ•°æ®æœ¬èº«</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">component_a</span> = Rc::<span class="hljs-title function_ invoke__">clone</span>(&amp;common_config);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">component_b</span> = Rc::<span class="hljs-title function_ invoke__">clone</span>(&amp;common_config);

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"å½“å‰é…ç½®å¼•ç”¨æ•°: {}"</span>, Rc::<span class="hljs-title function_ invoke__">strong_count</span>(&amp;common_config)); <span class="hljs-comment">// è¾“å‡º 3</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ç»„ä»¶ A çš„ä¸»é¢˜: {}"</span>, component_a.theme);
}
</code></pre>
<h3 data-id="heading-9">3). <code>Arc&lt;T&gt;</code>ï¼šActix-web ä¸­çš„å¤šçº¿ç¨‹çŠ¶æ€å…±äº«</h3>
<blockquote>
<p>åœºæ™¯ï¼šè¿™æ˜¯ä½ åœ¨å­¦ä¹  Actix-web æ—¶æœ€å¸¸ç”¨çš„ã€‚å®ƒè®©å¤šä¸ª worker çº¿ç¨‹èƒ½å®‰å…¨åœ°è®¿é—®åŒä¸€ä¸ªå…¨å±€çŠ¶æ€ï¼ˆæ¯”å¦‚æ•°æ®åº“è¿æ¥ã€å…¨å±€è®¡æ•°å™¨ï¼‰ã€‚
æ³¨æ„ï¼šå¦‚æœè¦ä¿®æ”¹æ•°æ®ï¼Œé€šå¸¸é…åˆ Mutex ä½¿ç”¨ã€‚</p>
</blockquote>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> actix_web::{web, App, HttpServer, Responder};
<span class="hljs-keyword">use</span> std::sync::{Arc, Mutex};

<span class="hljs-comment">// å®šä¹‰å…¨å±€çŠ¶æ€</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">AppState</span> {
    <span class="hljs-comment">// Arc ä¿è¯å¤šä¸ªçº¿ç¨‹éƒ½èƒ½æŒæœ‰è¿™ä¸ªè®¡æ•°å™¨</span>
    <span class="hljs-comment">// Mutex ä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½ä¿®æ”¹å®ƒ</span>
    visitor_count: Arc&lt;Mutex&lt;<span class="hljs-type">u32</span>&gt;&gt;,
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">index</span>(data: web::Data&lt;AppState&gt;) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">impl</span> <span class="hljs-title class_">Responder</span> {
    <span class="hljs-comment">// 1. å…ˆé”ä½æ•°æ®</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">count</span> = data.visitor_count.<span class="hljs-title function_ invoke__">lock</span>().<span class="hljs-title function_ invoke__">unwrap</span>();
    <span class="hljs-comment">// 2. è§£å¼•ç”¨å¹¶ä¿®æ”¹</span>
    *count += <span class="hljs-number">1</span>;
    
    <span class="hljs-built_in">format!</span>(<span class="hljs-string">"ä½ æ˜¯ç¬¬ {} ä½è®¿å®¢"</span>, count)
}

<span class="hljs-meta">#[actix_web::main]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() <span class="hljs-punctuation">-&gt;</span> std::io::<span class="hljs-type">Result</span>&lt;()&gt; {
    <span class="hljs-comment">// åˆ›å»ºå…±äº«çŠ¶æ€</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">app_state</span> = AppState {
        visitor_count: Arc::<span class="hljs-title function_ invoke__">new</span>(Mutex::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-number">0</span>)),
    };
    
    <span class="hljs-comment">// åŒ…è£…æˆ Actix çš„ Data ç±»å‹ï¼ˆå®ƒå†…éƒ¨ä¹Ÿä¼šå¤„ç† Arcï¼‰</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">data</span> = web::Data::<span class="hljs-title function_ invoke__">new</span>(app_state);

    HttpServer::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-keyword">move</span> || {
        App::<span class="hljs-title function_ invoke__">new</span>()
            .<span class="hljs-title function_ invoke__">app_data</span>(data.<span class="hljs-title function_ invoke__">clone</span>()) <span class="hljs-comment">// æ¯ä¸ªçº¿ç¨‹éƒ½æ‹¿åˆ°ä¸€ä¸ª Arc çš„å‰¯æœ¬</span>
            .<span class="hljs-title function_ invoke__">route</span>(<span class="hljs-string">"/"</span>, web::<span class="hljs-title function_ invoke__">get</span>().<span class="hljs-title function_ invoke__">to</span>(index))
    })
    .<span class="hljs-title function_ invoke__">bind</span>(<span class="hljs-string">"127.0.0.1:8080"</span>)?
    .<span class="hljs-title function_ invoke__">run</span>()
    .<span class="hljs-keyword">await</span>
}
</code></pre>
<h3 data-id="heading-10">æ ¸å¿ƒåŒºåˆ«æ€»ç»“ï¼š</h3>
<ul>
<li>
<p>Boxï¼šç‹¬å æ‰€æœ‰æƒã€‚å°±åƒä½ ä¹°äº†ä¸€æœ¬ä¹¦æ”¾åœ¨å®¶é‡Œï¼Œåªæœ‰ä½ èƒ½çœ‹ã€‚</p>
</li>
<li>
<p>Rcï¼šå•çº¿ç¨‹å¤šæ‰€æœ‰æƒã€‚å°±åƒåœ¨å®¶é‡Œï¼ˆå•çº¿ç¨‹ï¼‰ï¼Œä½ å’Œçˆ¸å¦ˆå…±äº«ä¸€å°ç”µè§†æœºï¼Œçœ‹ç”µè§†çš„äººæ•°ä¸º 0 æ—¶ç”µè§†æ‰å…³æ‰ã€‚</p>
</li>
<li>
<p>Arcï¼šå¤šçº¿ç¨‹å¤šæ‰€æœ‰æƒã€‚å°±åƒåœ¨å…¬å¸ï¼ˆå¤šçº¿ç¨‹ï¼‰ï¼Œå¤§å®¶å…±ç”¨ä¸€å°é¥®æ°´æœºã€‚å› ä¸ºæœ‰å¤šä¸ªäººï¼ˆçº¿ç¨‹ï¼‰å¯èƒ½åŒæ—¶å»æ¥æ°´ï¼Œæ‰€ä»¥éœ€è¦ç‰¹æ®Šçš„â€œåŸå­æ“ä½œâ€æ¥è®°å½•äººæ•°ï¼Œç¡®ä¿å®‰å…¨ã€‚</p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è‹ç©¹å¤–å–â€”Knife4j çš„æ¥å£æ–‡æ¡£æ‰“ä¸å¼€çš„ä¸€ç§è§£å†³æ–¹æ³•]]></title>    <link>https://juejin.cn/post/7587245616754769971</link>    <guid>https://juejin.cn/post/7587245616754769971</guid>    <pubDate>2025-12-24T15:21:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587245616754769971" data-draft-id="7587263750248874035" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è‹ç©¹å¤–å–â€”Knife4j çš„æ¥å£æ–‡æ¡£æ‰“ä¸å¼€çš„ä¸€ç§è§£å†³æ–¹æ³•"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-24T15:21:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»Šå¤©å¥½å†·"/> <meta itemprop="url" content="https://juejin.cn/user/4381977769945513"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è‹ç©¹å¤–å–â€”Knife4j çš„æ¥å£æ–‡æ¡£æ‰“ä¸å¼€çš„ä¸€ç§è§£å†³æ–¹æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4381977769945513/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»Šå¤©å¥½å†·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T15:21:21.000Z" title="Wed Dec 24 2025 15:21:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">å‰å› </h4>
<p>å‰ä¸€å¤©è·Ÿç€é»‘é©¬æ•²å®Œäº†å‘˜å·¥åˆ†é¡µæŸ¥è¯¢çš„ä»£ç ï¼Œç¬¬äºŒå¤©è·Ÿç€æ•²äº†å¯ç”¨ç¦ç”¨çš„å†…å®¹ï¼Œæ•²å®Œè¦ç”¨Knife4jæ¥å£æ–‡æ¡£çš„æ—¶å€™ï¼Œçªç„¶å°±å¼¹bugäº†</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/99ac15f7840f48ff8a8f08fdd8ad25e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LuK5aSp5aW95Ya3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767194481&amp;x-signature=6hYMKvyPljIkV0TM0j%2BsSxQzuok%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c71e670e6fa64f918ba0e01820e1ffa6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LuK5aSp5aW95Ya3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767194481&amp;x-signature=rf4mkEcnhEJgnniUWcc8084sviY%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-1">æŸ¥åŸå› </h4>
<p>åé¢é—®aié—®äº†å¥½ä¹…ï¼Œåæ¥æŸ¥å‡ºé—®é¢˜æ˜¯å‡ºåœ¨é‚£ä¸ªè‡ªå®šä¹‰çš„è½¬æ¢å™¨ä¸Š(skyserver/src/main/java/com/sky/config/WebMvcConfiguration.java)</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªæ¶ˆæ¯è½¬æ¢å™¨å¯¹è±¡</span>
MappingJackson2HttpMessageConverter converter = new <span class="hljs-built_in">MappingJackson2HttpMessageConverter</span>();
<span class="hljs-comment">//ä¸ºæ¶ˆæ¯è½¬æ¢å™¨è®¾ç½®ä¸€ä¸ªå¯¹è±¡è½¬æ¢å™¨ï¼Œå¯¹è±¡è½¬æ¢å™¨å¯ä»¥å°†Javaå¯¹è±¡åºåˆ—åŒ–ä¸ºjsonæ•°æ®</span>
converter<span class="hljs-selector-class">.setObjectMapper</span>(new JacksonObjectMapper());
<span class="hljs-comment">//å°†è‡ªå·±çš„æ¶ˆæ¯è½¬æ¢å™¨åŠ å…¥å®¹å™¨</span>
converters<span class="hljs-selector-class">.add</span>(<span class="hljs-number">0</span>,converter);     
<span class="hljs-comment">/*æŠŠè‡ªå®šä¹‰çš„è½¬æ¢å™¨åŠ åˆ°äº†ç¬¬ä¸€ä½ï¼Œè¿™å¯¼è‡´ç³»ç»Ÿåœ¨ç”Ÿæˆæ¥å£æ–‡æ¡£(JSONæ•°æ®)æ—¶ï¼Œ
é”™è¯¯åœ°ä½¿ç”¨äº†è‡ªå®šä¹‰è½¬æ¢å™¨ï¼ŒæŠŠæ–‡æ¡£å¯¹è±¡å˜æˆäº†ä¸€ä¸² Base64 å­—ç¬¦ä¸²ï¼Œå‰ç«¯çœ‹ä¸æ‡‚å°±æŠ¥é”™äº†ã€‚*/</span> 
</code></pre>
<h4 data-id="heading-2">è§£å†³æ–¹æ³•</h4>
<p>è‡ªæµ‹äº†ä¸€ä¸‹ï¼Œèƒ½å¤Ÿæ­£å¸¸æ‰“å¼€Knife4jæ–‡æ¡£ï¼Œæ—¶é—´æ ¼å¼ç­‰çš„jsonè½¬æ¢ä¹Ÿæ­£å¸¸</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… æ¨èåšæ³•ï¼šéå†æ‰¾åˆ°ç³»ç»Ÿè‡ªå¸¦çš„é‚£ä¸ªè½¬æ¢å™¨ï¼Œåªæ›¿æ¢å®ƒçš„â€œç¿»è¯‘å­—å…¸â€ï¼ˆObjectMapperï¼‰</span>
<span class="hljs-comment">// è¿™æ ·æ—¢ä¿ç•™äº†ç³»ç»ŸåŸæœ‰çš„å…¼å®¹æ€§ï¼ˆæ–‡æ¡£èƒ½çœ‹ï¼‰ï¼ŒåˆåŠ ä¸Šäº†ä½ çš„ Long è½¬ String åŠŸèƒ½</span>
<span class="hljs-keyword">for</span> (HttpMessageConverter&lt;?&gt; converter : converters) {
    <span class="hljs-keyword">if</span> (converter <span class="hljs-keyword">instanceof</span> MappingJackson2HttpMessageConverter) {
    <span class="hljs-type">MappingJackson2HttpMessageConverter</span> <span class="hljs-variable">jacksonConverter</span> <span class="hljs-operator">=</span> (MappingJackson2HttpMessageConverter) converter;
    jacksonConverter.setObjectMapper(<span class="hljs-keyword">new</span> <span class="hljs-title class_">JacksonObjectMapper</span>());
    <span class="hljs-comment">// æ‰¾åˆ°ä¸€ä¸ªæ›¿æ¢äº†å°±è¡Œï¼Œä¸éœ€è¦å…¨éƒ¨æ›¿æ¢</span>
    <span class="hljs-keyword">break</span>;
   }
}
</code></pre>
<p>ä¸ªäººæ ¹æ®aiå¾—å‡ºçš„æ–¹æ³•ï¼Œå¦‚æœ‰é”™è¯·æŒ‡æ­£ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3 è‡ªå®šä¹‰æŒ‡ä»¤å®ç°å›¾ç‰‡æ‡’åŠ è½½ï¼šä»åŸç†åˆ°å®è·µ]]></title>    <link>https://juejin.cn/post/7587238733504397355</link>    <guid>https://juejin.cn/post/7587238733504397355</guid>    <pubDate>2025-12-24T12:03:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587238733504397355" data-draft-id="7587245616753901619" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3 è‡ªå®šä¹‰æŒ‡ä»¤å®ç°å›¾ç‰‡æ‡’åŠ è½½ï¼šä»åŸç†åˆ°å®è·µ"/> <meta itemprop="keywords" content="JavaScript,Vue.js"/> <meta itemprop="datePublished" content="2025-12-24T12:03:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="saberxyL"/> <meta itemprop="url" content="https://juejin.cn/user/3942228504379243"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3 è‡ªå®šä¹‰æŒ‡ä»¤å®ç°å›¾ç‰‡æ‡’åŠ è½½ï¼šä»åŸç†åˆ°å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3942228504379243/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    saberxyL
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T12:03:01.000Z" title="Wed Dec 24 2025 12:03:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. ä¸ºä»€ä¹ˆè¦å®ç°æ‡’åŠ è½½ï¼Ÿ</h2>
<p>åœ¨ç°ä»£ Web åº”ç”¨ä¸­ï¼Œå›¾ç‰‡æ˜¯æµé‡æ¶ˆè€—å¤§æˆ·ã€‚å¦‚æœé¡µé¢åŒ…å«å¤§é‡å›¾ç‰‡ï¼ˆå¦‚ç›¸å†Œã€å•†å“åˆ—è¡¨ï¼‰ï¼Œ<strong>é¦–å±åŠ è½½æ—¶é—´</strong>ä¼šæ˜¾è‘—å¢åŠ ã€‚æ‡’åŠ è½½çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š</p>
<ul>
<li><strong>å»¶è¿ŸåŠ è½½</strong>ï¼šå›¾ç‰‡è¿›å…¥å¯è§†åŒºåŸŸæ—¶æ‰å¼€å§‹åŠ è½½</li>
<li><strong>æå‡æ€§èƒ½</strong>ï¼šå‡å°‘é¦–å±è¯·æ±‚æ•°ï¼ŒèŠ‚çœç”¨æˆ·æµé‡</li>
<li><strong>ä¼˜åŒ–ä½“éªŒ</strong>ï¼šå¿«é€Ÿå“åº”ï¼Œé¿å…é¡µé¢å¡é¡¿</li>
</ul>
<hr/>
<h2 data-id="heading-1">2. æ ¸å¿ƒåŸç†</h2>
<h3 data-id="heading-2">2.1 æŠ€æœ¯æ ˆé€‰æ‹©</h3>
<ul>
<li><strong>Vue3 è‡ªå®šä¹‰æŒ‡ä»¤</strong>ï¼š<code>v-lazy</code>ï¼Œç›´æ¥æ“ä½œ DOM å…ƒç´ </li>
<li><strong>Intersection Observer API</strong>ï¼šç°ä»£æµè§ˆå™¨åŸç”Ÿ APIï¼Œç›‘å¬å…ƒç´ æ˜¯å¦è¿›å…¥è§†å£</li>
<li><strong>å›¾ç‰‡é¢„åŠ è½½</strong>ï¼šåˆ›å»º <code>Image</code> å¯¹è±¡æå‰åŠ è½½ï¼Œé¿å…ç›´æ¥ä¿®æ”¹ <code>src</code> å¯¼è‡´é—ªçƒ</li>
</ul>
<h3 data-id="heading-3">2.2 å·¥ä½œæµç¨‹</h3>
<pre><code class="hljs language-text" lang="text">1. å…ƒç´ åˆå§‹åŒ– â†’ è®¾ç½®é»˜è®¤ loading å›¾ç‰‡
2. å¼€å¯ IntersectionObserver ç›‘å¬
3. å…ƒç´ è¿›å…¥è§†å£ (isIntersecting = true) â†’ è§¦å‘åŠ è½½
4. é¢„åŠ è½½å›¾ç‰‡ â†’ onload â†’ è®¾ç½®çœŸå® src
5. é¢„åŠ è½½å¤±è´¥ â†’ onerror â†’ è®¾ç½®é”™è¯¯å›¾
6. å…³é—­ç›‘å¬ï¼Œé˜²æ­¢é‡å¤åŠ è½½
</code></pre>
<hr/>
<h2 data-id="heading-4">3. å®Œæ•´ä»£ç å®ç°</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/directives/lazy.js</span>

<span class="hljs-comment">// é»˜è®¤å›¾ç‰‡ï¼ˆå»ºè®®ä½¿ç”¨ Base64 æˆ–æœ¬åœ°è·¯å¾„ï¼‰</span>
<span class="hljs-keyword">const</span> defaultLoading = <span class="hljs-string">'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'</span>
<span class="hljs-keyword">const</span> defaultError = <span class="hljs-string">'https://cdn.example.com/images/error.png'</span>

<span class="hljs-keyword">const</span> imgLazy = {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el, binding</span>) {
    <span class="hljs-keyword">let</span> observer = <span class="hljs-literal">null</span>

    <span class="hljs-comment">// 1. è§£ææŒ‡ä»¤å‚æ•°ï¼ˆæ”¯æŒå¯¹è±¡å’Œå­—ç¬¦ä¸²ä¸¤ç§å½¢å¼ï¼‰</span>
    <span class="hljs-keyword">const</span> { src, loading, error } =
      <span class="hljs-keyword">typeof</span> binding.<span class="hljs-property">value</span> === <span class="hljs-string">'object'</span>
        ? binding.<span class="hljs-property">value</span>
        : { <span class="hljs-attr">src</span>: binding.<span class="hljs-property">value</span> }

    <span class="hljs-comment">// 2. åˆå§‹åŒ–ï¼šè®¾ç½®åŠ è½½ä¸­çš„å ä½å›¾</span>
    el.<span class="hljs-property">src</span> = loading || defaultLoading

    <span class="hljs-comment">// 3. å›¾ç‰‡é¢„åŠ è½½å‡½æ•°ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">imgLoad</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>() <span class="hljs-comment">// åˆ›å»ºè™šæ‹Ÿ Image å¯¹è±¡é¢„åŠ è½½</span>
      img.<span class="hljs-property">src</span> = src

      <span class="hljs-comment">// åŠ è½½æˆåŠŸ</span>
      img.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> {
        el.<span class="hljs-property">src</span> = src
        <span class="hljs-comment">// å¯é€‰ï¼šæ·»åŠ æ·¡å…¥åŠ¨ç”»</span>
        el.<span class="hljs-property">style</span>.<span class="hljs-property">transition</span> = <span class="hljs-string">'opacity 0.3s'</span>
        el.<span class="hljs-property">style</span>.<span class="hljs-property">opacity</span> = <span class="hljs-string">'1'</span>
      }

      <span class="hljs-comment">// åŠ è½½å¤±è´¥</span>
      img.<span class="hljs-property">onerror</span> = <span class="hljs-function">() =&gt;</span> {
        el.<span class="hljs-property">src</span> = error || defaultError
      }
    }

    <span class="hljs-comment">// 4. åˆ›å»º IntersectionObserver ç›‘å¬</span>
    observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntersectionObserver</span>(<span class="hljs-function">(<span class="hljs-params">entries</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> entry = entries[<span class="hljs-number">0</span>]

      <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">isIntersecting</span>) {
        <span class="hljs-title function_">imgLoad</span>() <span class="hljs-comment">// è¿›å…¥è§†å£ï¼Œå¼€å§‹åŠ è½½</span>
        observer.<span class="hljs-title function_">unobserve</span>(el) <span class="hljs-comment">// å…³é—­ç›‘å¬ï¼Œé¿å…é‡å¤åŠ è½½</span>
      }
    }, {
      <span class="hljs-attr">rootMargin</span>: <span class="hljs-string">'100px'</span>, <span class="hljs-comment">// æå‰ 100px å¼€å§‹åŠ è½½ï¼Œæå‡ä½“éªŒ</span>
      <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.01</span> <span class="hljs-comment">// åªè¦æœ‰ä¸€ç‚¹ç‚¹å¯è§å°±è§¦å‘</span>
    })

    <span class="hljs-comment">// 5. å¼€å¯ç›‘å¬ï¼Œå¹¶æŒ‚è½½åˆ°å…ƒç´ ä¸Šï¼ˆæ–¹ä¾¿å¸è½½æ—¶æ¸…ç†ï¼‰</span>
    observer.<span class="hljs-title function_">observe</span>(el)
    el.<span class="hljs-property">_imgObserver</span> = observer
  },

  <span class="hljs-title function_">unmounted</span>(<span class="hljs-params">el</span>) {
    <span class="hljs-comment">// 6. æ¸…ç†ç›‘å¬å™¨ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼</span>
    el.<span class="hljs-property">_imgObserver</span>?.<span class="hljs-title function_">unobserve</span>(el)
    el.<span class="hljs-property">_imgObserver</span> = <span class="hljs-literal">null</span>
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> imgLazy
</code></pre>
<hr/>
<h2 data-id="heading-5">4. åœ¨ Vue3 ä¸­ä½¿ç”¨</h2>
<h3 data-id="heading-6">4.1 å…¨å±€æ³¨å†Œ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>
<span class="hljs-keyword">import</span> imgLazy <span class="hljs-keyword">from</span> <span class="hljs-string">'./directives/lazy'</span>

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)
app.<span class="hljs-title function_">directive</span>(<span class="hljs-string">'lazy'</span>, imgLazy)
app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
</code></pre>
<h3 data-id="heading-7">4.2 ç»„ä»¶å†…ä½¿ç”¨</h3>
<pre><code class="hljs language-Vue" lang="Vue">&lt;template&gt;
  &lt;div class="gallery"&gt;
    &lt;!-- åŸºç¡€ç”¨æ³•ï¼šç›´æ¥ä¼  URL --&gt;
    &lt;img v-lazy="item.url" v-for="item in list" :key="item.id" /&gt;

    &lt;!-- è¿›é˜¶ç”¨æ³•ï¼šé…ç½® loading å’Œ error --&gt;
    &lt;img
      v-lazy="{
        src: item.url,
        loading: '/images/loading.gif',
        error: '/images/error.png'
      }"
      v-for="item in list"
      :key="item.id"
    /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  data() {
    return {
      list: [
        { id: 1, url: 'https://example.com/img1.jpg' },
        { id: 2, url: 'https://example.com/img2.jpg' },
        // ... æ›´å¤šå›¾ç‰‡
      ]
    }
  }
}
&lt;/script&gt;

&lt;style&gt;
/* å¯é€‰ï¼šæ·»åŠ åŠ è½½åŠ¨ç”» */
img {
  opacity: 0;
  transition: opacity 0.3s;
}
img[src] {
  opacity: 1;
}
&lt;/style&gt;
</code></pre>
<hr/>
<h2 data-id="heading-8">5. è¿›é˜¶ä¼˜åŒ–å»ºè®®</h2>
<h3 data-id="heading-9">5.1 æ€§èƒ½ä¼˜åŒ–</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼˜åŒ–çš„ observer é…ç½®</span>
<span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntersectionObserver</span>(callback, {
  <span class="hljs-attr">rootMargin</span>: <span class="hljs-string">'200px'</span>, <span class="hljs-comment">// æ›´å¤§çš„é¢„åŠ è½½åŒºåŸŸ</span>
  <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.1</span>,      <span class="hljs-comment">// 10% å¯è§æ—¶è§¦å‘</span>
  <span class="hljs-attr">root</span>: <span class="hljs-literal">null</span>           <span class="hljs-comment">// ç›¸å¯¹äºè§†å£</span>
})
</code></pre>
<h3 data-id="heading-10">5.2 æ”¯æŒ WebP å’Œæ‡’åŠ è½½é™çº§</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">imgLoad</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>()

  <span class="hljs-comment">// æ£€æµ‹æµè§ˆå™¨æ˜¯å¦æ”¯æŒ WebP</span>
  <span class="hljs-keyword">const</span> supportsWebP = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'canvas'</span>).<span class="hljs-title function_">toDataURL</span>(<span class="hljs-string">'image/webp'</span>).<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">'data:image/webp'</span>) === <span class="hljs-number">0</span>

  img.<span class="hljs-property">src</span> = supportsWebP ? src.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'.jpg'</span>, <span class="hljs-string">'.webp'</span>) : src

  img.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> { el.<span class="hljs-property">src</span> = img.<span class="hljs-property">src</span> }
  img.<span class="hljs-property">onerror</span> = <span class="hljs-function">() =&gt;</span> { el.<span class="hljs-property">src</span> = error || defaultError }
}
</code></pre>
<h3 data-id="heading-11">5.3 æ·»åŠ åŠ è½½å®Œæˆå›è°ƒ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ‰©å±•æŒ‡ä»¤æ”¯æŒå›è°ƒ</span>
<span class="hljs-title function_">mounted</span>(<span class="hljs-params">el, binding</span>) {
  <span class="hljs-keyword">const</span> { src, loading, error, onLoaded, onError } = binding.<span class="hljs-property">value</span>

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">imgLoad</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>()
    img.<span class="hljs-property">src</span> = src
    img.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> {
      el.<span class="hljs-property">src</span> = src
      onLoaded?.(el) <span class="hljs-comment">// åŠ è½½å®Œæˆå›è°ƒ</span>
    }
    img.<span class="hljs-property">onerror</span> = <span class="hljs-function">() =&gt;</span> {
      el.<span class="hljs-property">src</span> = error || defaultError
      onError?.(el) <span class="hljs-comment">// åŠ è½½å¤±è´¥å›è°ƒ</span>
    }
  }
  <span class="hljs-comment">// ... å…¶ä½™ä»£ç </span>
}
</code></pre>
<p>ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;img v-lazy="{
  src: item.url,
  onLoaded: (el) =&gt; console.log('å›¾ç‰‡åŠ è½½å®Œæˆ', el),
  onError: (el) =&gt; console.log('å›¾ç‰‡åŠ è½½å¤±è´¥', el)
}" /&gt;
</code></pre>
<hr/>
<h2 data-id="heading-12">6. æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-13">6.1 å†…å­˜æ³„æ¼é˜²èŒƒ</h3>
<ul>
<li>âœ… <strong>å¿…é¡»åœ¨ <code>unmounted</code> æ—¶è°ƒç”¨ <code>unobserve</code></strong></li>
<li>âœ… é¿å…åœ¨ç»„ä»¶å¸è½½åç»§ç»­æ“ä½œ DOM</li>
<li>âœ… ä½¿ç”¨ <code>?.</code> å¯é€‰é“¾æ“ä½œç¬¦é˜²æ­¢æŠ¥é”™</li>
</ul>
<h3 data-id="heading-14">6.2 å›¾ç‰‡æ ¼å¼å»ºè®®</h3>
<ul>
<li><strong>loading å›¾ç‰‡</strong>ï¼šä½¿ç”¨ 1x1 åƒç´ çš„é€æ˜ GIF æˆ– Base64ï¼Œé¿å…é¢å¤–è¯·æ±‚</li>
<li><strong>error å›¾ç‰‡</strong>ï¼šä½¿ç”¨ç¨³å®šçš„ CDN åœ°å€æˆ–æœ¬åœ°èµ„æº</li>
<li><strong>çœŸå®å›¾ç‰‡</strong>ï¼šä¼˜å…ˆä½¿ç”¨ WebP æ ¼å¼ï¼Œä½“ç§¯æ›´å°</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python å­—å…¸æ“ä½œï¼š â€œæ•ˆç‡ç¥å™¨â€ æŠ€å·§ï¼Œå‘Šåˆ«æŸ¥æ‰¾ç„¦è™‘]]></title>    <link>https://juejin.cn/post/7587254134401171465</link>    <guid>https://juejin.cn/post/7587254134401171465</guid>    <pubDate>2025-12-24T13:41:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587254134401171465" data-draft-id="7586540799220514857" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Python å­—å…¸æ“ä½œï¼š â€œæ•ˆç‡ç¥å™¨â€ æŠ€å·§ï¼Œå‘Šåˆ«æŸ¥æ‰¾ç„¦è™‘"/> <meta itemprop="keywords" content="å‰ç«¯,Python"/> <meta itemprop="datePublished" content="2025-12-24T13:41:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AAAç®€å•ç©è½¬ç¨‹åºè®¾è®¡"/> <meta itemprop="url" content="https://juejin.cn/user/4294056357689099"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Python å­—å…¸æ“ä½œï¼š â€œæ•ˆç‡ç¥å™¨â€ æŠ€å·§ï¼Œå‘Šåˆ«æŸ¥æ‰¾ç„¦è™‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4294056357689099/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AAAç®€å•ç©è½¬ç¨‹åºè®¾è®¡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T13:41:15.000Z" title="Wed Dec 24 2025 13:41:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å­—å…¸ï¼ˆdictï¼‰å ªç§° â€œæ•°æ®æ˜ å°„å¤©èŠ±æ¿â€â€”â€” å­˜é…ç½®ã€å­˜ç”¨æˆ·ä¿¡æ¯ã€åšç¼“å­˜ï¼Œå“ªå„¿éƒ½ç¦»ä¸å¼€å®ƒã€‚ä½†å¾ˆå¤šäººç”¨å­—å…¸è¿˜åœ¨é  â€œif key in dictâ€ åå¤åˆ¤æ–­ï¼ŒæŸ¥æ‰¾ä¸å­˜åœ¨çš„é”®ç›´æ¥æŠ¥é”™ï¼Œéå†é”®å€¼å¯¹å†™å¾—åˆå•°å—¦åˆå†—ä½™ã€‚ä»Šå¤©åˆ†äº« 3 ä¸ªæœ€å¸¸ç”¨çš„å­—å…¸æŠ€å·§ï¼Œä¸€è¡Œæå®šé«˜é¢‘éœ€æ±‚ï¼Œæ–°æ‰‹ä¹Ÿèƒ½ç§’ä¸Šæ‰‹ï½</p>
<h2 data-id="heading-0">1. å®‰å…¨å–å€¼ï¼šå‘Šåˆ« KeyError å´©æºƒï¼</h2>
<p>å­—å…¸ä¸­å–ä¸å­˜åœ¨çš„é”®ä¼šç›´æ¥æŠ› KeyErrorï¼Œç”¨<code>get()</code>æ–¹æ³•æˆ–<code>setdefault()</code>ï¼Œè½»æ¾æå®š â€œé”®ä¸å­˜åœ¨â€ çš„åœºæ™¯ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ¨¡æ‹Ÿç”¨æˆ·ä¿¡æ¯å­—å…¸</span>
user_info = {
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>,
    <span class="hljs-string">"age"</span>: <span class="hljs-number">25</span>,
    <span class="hljs-string">"city"</span>: <span class="hljs-string">"åŒ—äº¬"</span>
}

<span class="hljs-comment"># åé¢æ•™æï¼šç›´æ¥å–å€¼ï¼ˆé”®ä¸å­˜åœ¨æŠ¥é”™ï¼‰</span>
<span class="hljs-comment"># print(user_info["gender"])  # æŠ¥é”™ï¼šKeyError: 'gender'</span>

<span class="hljs-comment"># æŠ€å·§1ï¼šget()æ–¹æ³•ï¼ˆæŒ‡å®šé»˜è®¤å€¼ï¼‰</span>
gender = user_info.get(<span class="hljs-string">"gender"</span>, <span class="hljs-string">"æœªçŸ¥"</span>)  <span class="hljs-comment"># é”®ä¸å­˜åœ¨è¿”å›é»˜è®¤å€¼</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ€§åˆ«ï¼š"</span>, gender)  <span class="hljs-comment"># è¾“å‡ºï¼šæ€§åˆ«ï¼šæœªçŸ¥</span>

<span class="hljs-comment"># æŠ€å·§2ï¼šsetdefault()ï¼ˆé”®ä¸å­˜åœ¨æ—¶æ·»åŠ é»˜è®¤å€¼åˆ°å­—å…¸ï¼‰</span>
hobby = user_info.setdefault(<span class="hljs-string">"hobby"</span>, <span class="hljs-string">"ç¼–ç¨‹"</span>)  <span class="hljs-comment"># æ–°å¢hobbyé”®å€¼å¯¹</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"çˆ±å¥½ï¼š"</span>, hobby)  <span class="hljs-comment"># è¾“å‡ºï¼šçˆ±å¥½ï¼šç¼–ç¨‹</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ›´æ–°åçš„å­—å…¸ï¼š"</span>, user_info)  <span class="hljs-comment"># è¾“å‡ºåŒ…å«hobbyçš„å®Œæ•´å­—å…¸</span>
</code></pre>
<h4 data-id="heading-1">2. å­—å…¸éå†ï¼šé”®å€¼å¯¹ / é”® / å€¼å¿«é€Ÿè·å–</h4>
<p>ä¸ç”¨å†å†™<code>for key in dict: print(key, dict[key])</code>ï¼Œç”¨<code>items()</code>/<code>keys()</code>/<code>values()</code>ç²¾å‡†éå†ï¼Œä»£ç æ›´ä¼˜é›…ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æŠ€å·§3ï¼šé«˜æ•ˆéå†ï¼ˆæŒ‰éœ€é€‰æ‹©ï¼‰</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n=== éå†é”®å€¼å¯¹ ==="</span>)
<span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> user_info.items():  <span class="hljs-comment"># ç›´æ¥è·å–é”®å’Œå€¼</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{key}</span>ï¼š<span class="hljs-subst">{value}</span>"</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n=== åªéå†é”® ==="</span>)
<span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> user_info.keys():  <span class="hljs-comment"># ä»…è·å–é”®ï¼ˆå¯çœç•¥ï¼Œç›´æ¥for key in user_infoï¼‰</span>
    <span class="hljs-built_in">print</span>(key)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n=== åªéå†å€¼ ==="</span>)
<span class="hljs-keyword">for</span> value <span class="hljs-keyword">in</span> user_info.values():  <span class="hljs-comment"># ä»…è·å–å€¼</span>
    <span class="hljs-built_in">print</span>(value)
</code></pre>
<h4 data-id="heading-2">3. å­—å…¸åˆå¹¶ï¼š2 è¡Œæå®šå¤šå­—å…¸æ‹¼æ¥</h4>
<p>ä¸ç”¨æ‰‹åŠ¨å¾ªç¯æ·»åŠ é”®å€¼å¯¹ï¼Œç”¨<code>**|**</code>ï¼ˆPython 3.9+ï¼‰æˆ–<code>dict.update()</code>ï¼Œå¿«é€Ÿåˆå¹¶å¤šä¸ªå­—å…¸ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä¸¤ä¸ªå¾…åˆå¹¶çš„å­—å…¸</span>
dict1 = {<span class="hljs-string">"a"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"b"</span>: <span class="hljs-number">2</span>}
dict2 = {<span class="hljs-string">"b"</span>: <span class="hljs-number">3</span>, <span class="hljs-string">"c"</span>: <span class="hljs-number">4</span>}  <span class="hljs-comment"># dict2çš„bé”®ä¼šè¦†ç›–dict1çš„bé”®</span>

<span class="hljs-comment"># æŠ€å·§4ï¼šç”¨**åˆå¹¶ï¼ˆç®€æ´ï¼Œä¸ä¿®æ”¹åŸå­—å…¸ï¼‰</span>
merged_dict1 = {** dict1, **dict2}
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nåˆå¹¶åçš„å­—å…¸1ï¼š"</span>, merged_dict1)  <span class="hljs-comment"># è¾“å‡ºï¼š{'a': 1, 'b': 3, 'c': 4}</span>

<span class="hljs-comment"># æŠ€å·§5ï¼šupdate()åˆå¹¶ï¼ˆä¿®æ”¹åŸå­—å…¸ï¼‰</span>
dict1.update(dict2)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"åˆå¹¶åçš„å­—å…¸2ï¼š"</span>, dict1)  <span class="hljs-comment"># è¾“å‡ºï¼š{'a': 1, 'b': 3, 'c': 4}</span>
</code></pre>
<h3 data-id="heading-3">äºŒã€å…³é”®æ³¨æ„äº‹é¡¹</h3>
<ol>
<li>
<p>å­—å…¸çš„<code>key</code>å¿…é¡»æ˜¯ä¸å¯å˜ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€æ•°å­—ã€å…ƒç»„ï¼‰ï¼Œåˆ—è¡¨ä¸èƒ½å½“ keyï¼›</p>
</li>
<li>
<p><code>**|**</code>åˆå¹¶ä¼šè¦†ç›–é‡å¤é”®çš„å€¼ï¼Œåé¢çš„å­—å…¸ä¼˜å…ˆçº§æ›´é«˜ï¼›</p>
</li>
<li>
<p><code>setdefault()</code>ä¼šä¿®æ”¹åŸå­—å…¸ï¼Œè€Œ<code>get()</code>ä¸ä¼šï¼Œæ ¹æ®éœ€æ±‚é€‰æ‹©ã€‚</p>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€React æºç é˜…è¯»ã€‘useEffect å’Œ useLayoutEffect çš„åŒºåˆ«]]></title>    <link>https://juejin.cn/post/7587245616754622515</link>    <guid>https://juejin.cn/post/7587245616754622515</guid>    <pubDate>2025-12-24T14:03:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587245616754622515" data-draft-id="7579441333166555145" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€React æºç é˜…è¯»ã€‘useEffect å’Œ useLayoutEffect çš„åŒºåˆ«"/> <meta itemprop="keywords" content="å‰ç«¯,React.js,æºç é˜…è¯»"/> <meta itemprop="datePublished" content="2025-12-24T14:03:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Tonychen"/> <meta itemprop="url" content="https://juejin.cn/user/1503787637022109"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€React æºç é˜…è¯»ã€‘useEffect å’Œ useLayoutEffect çš„åŒºåˆ«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1503787637022109/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Tonychen
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T14:03:30.000Z" title="Wed Dec 24 2025 14:03:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body ::selection{color:#fff;background-color:#ed7373}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:.6em;margin-top:1.5em;padding-bottom:4px;color:#ed7373}.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px}.markdown-body h4{font-size:16px}.markdown-body h5,.markdown-body h6{font-size:14px}.markdown-body p{line-height:inherit;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border-top:1px solid #dfe1e6;margin:33px 0}.markdown-body code{word-break:break-word;overflow-x:auto;background-color:rgba(239,198,221,.2666666667);color:#7b164f;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==") 10px 10px no-repeat;background-size:40px;background-color:#fdf8f8}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#fdf8f8}.markdown-body a{position:relative;text-decoration:underline;text-decoration-color:#ffd4d4;color:#ed7373;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAAAXNSR0IArs4c6QAAD1lJREFUeF7tnV122zgShQHJG5gT9/OkV2J7JR3voI/U707eI5/eQeyVRFlJa56nc2YDFjkHEulWHP3g5xZYAK5eku6QYOFWfSwUAJLW8EcFqMBJBSy1oQJU4LQCBITRQQXOKEBAGB5UgIAwBqhAnALMIHG68axGFCAgjTia3YxTgIDE6cazGlGAgDTiaHYzTgECEqcbz2pEAQLSiKPZzTgFCEicbjyrEQUISCOOZjfjFCAgcbrxrEYUICCNOJrdjFOAgMTpxrMaUYCANOJodjNOAQISpxvPakQBAtKIo9nNOAUISJxuPKsRBQhII45GdfN/v//+/l9//rlBtae9HQKi3UOZ7ft7sfhgjfm3sfa9u3RvzHtrjPv77r8PfpvemB0o1v3Z95tuNvt29fKyqQkgApI5ADVebgeFtTfGmA8I+3pj1rbv17Ouey4dFgKCiIgC2/i+WDwYax0QbzMDtDcjLC67/PL58xraeIbGCEgGkTVd4vty+QWVKUL75WCZb7f3JWUVAhLq5UKPHzLGRyXmP822208lgEJAlESMlBlDfeGyhsafelAIiMawAdjkpmO38/kXa8wtoDnRJvq+v79+fHwSvUhk4wQkUjjNp/33jz9uZ33/VbONP9nW9x/fPT5+0mYzAdHmkUR7lNUaob1RN+QiIKEuVHz838vl1xKGVOck1DbTRUAUB7yvaSXVG5592sy22zsNs1wExNNjWg+rEI5XqWfb7a9TQ0JAtEa+h101wzF0f/JMQkA8AlHjIQ3AMco+KSQERGP0X7CpITj2Skw4BUxACgOkOThG/0wECQEpCJBm4Rh81Fl7l3tHMAEpBJCJ4Hjq+/7bvOt229THGSVny8vV1W6b/Kzrbnprb088VAVXN/fMFgGBuxDfYE443L4oB0TM9OqwxcVtjJR7xiTzUIuA4OMZ2mI2OICBN+wgfpACJWcWISDQcMY2lgMOt7XjerW6w1q+b03sqUUgzJf6TUAuKTTRv+eAI8f0qdSwK1cWISATAXDusjngyDkj5PrTzedu+z2uNsmURQiIMkBqg2OUVwKSHFmEgCgCpFY4xCDJkEUIiBJAaodjlBlZuEtOMIz2EhAFgLQCxxtIIG9YkR5mEZCJAWkNjldIlsu/EEW79AsfCMiEgLQKx8EaCSKLPL1bre6l3EhApJS90G7LcKCziOQwi4BMAAjh+GGlPTmLSK7pEJDMgBCOfwRHvb9Lsg4hIBkBIRw/i/0dUawLrocQkEyAEI7jQoPeNi9WqBOQDIAQjtMig16uTUAyxLHIJQjHeVkRdYjkijoziAgW+0YJx2VxEYAYYzbvVqtfL18t/AgCEq6Z1xmEw0um3U2km8/dqnrS791qJRLLIo0m9bSCkwmHvxNBgDCD+Es+7ZGEI0x/DrHC9Cr6aMIR7j7ELBaL9HDds59BOOIkB33wh9O8cfLnOYtwxOsM+egPV9LjHSB9JuFIU/j7ctmntSD7cmvOYiV6B3IHPGOD5E7VxK4nnw4q0A03Kya7QqYBwpGmK6j+MFJrIK53zCCRPgZtsjt59Zozh+s0aP3DNSW2BkJAIuFATE2eu3TtcLi+w24wggU6AYkABDVuPnXpFuAAZg8jrReHWAGQIB177LLSzg7oqtih4Dcsig6vmEECw0CyKG8BDic3VEPh4RUBCQAENePSaubY1R2LxYOxNvklDa8aEpCACBY+FLKgdcTGZjLHYvHBWuu+PoX6iQ+vmEE8XQW/8w3XJRyeDjhymOTi4OHlWKRf8JFUYU444uGQXvsgIAG+kcgesXAM6y83/fAhGtv36242+5b708i+8kmtF+XKHhxiTZA9YuDwCLSn2Xb7KebLtL7BHnqch82hTY7HZ6k9xotxiHXGTejsEQXHcvnVGnPrEU2b2XZ7pwESQTjEFwbf6kxAzgGCeOvf2H7ElGQMoDmHH8ekk4RD8snBU2FAQE4oAy7Og594S7p+BIweGeriIZJw5CzMWaRfdDV0UStqzByTPX7oVt9/nHXdc64hV41wsEjPMLyKqTucWZAtGZkyiTAc2esOZpBMs1cpY2bIW89dP4UhkYZj6pqKNcgRWFBb2lO+fAQDxBiTYse5e4k0HMaY4NrNY/QcdAgBOSJX8vjf3biNWV+vVndB3jg4GPZA0b5N+BSwNByp+sXqzmleD+UQgMTWHqN5AgEIg0TAtrdemTxzjAYxgxzLIMul23X6wYOlU4dEzVy9bQw5zNq1DahHpOGYuuZgBvGI+uQZJEAgOjOHWsjB+t7DbK9DUgIQkVnPGZmadb0ECDyIGeR4Bkl6mRnS0WhIYsf2LcLhQoOACACCfk8T+Dnu4BetJa3qe9yxkTcUj8sFHUJAjgPiPugSO6yB1B9vzUJCEppFBLPHprP2Xut2fWaQE/eSxOJYBJDR1ETbXnscUosk12THdVYPBwE5AUhiQIgCAswk3tO+As/ji2oUNIa6cDCHWOBp3tDhS4wzUZD4ZhEkIDn0idH01DkEBAyIaw5dpB9zHqgu8FqQgw3rEncXIAPft60qAXF32JRt3qnBJ7X36a1TUwPX926O2Pbiey3fwM11XBWADGsFv5n9o6m72SfnkJ2Iff98/fj4FCJo6mpxrmnLVJCdJj4wp+pRKhxVFOmeBXXwSw2S7s6glXQfqJPs3N0/+nufG0jCdbyGcT59neKYYjNIxKfPvGdtnCM8wTvpM587M8LhgOGPVwDHTAz4wofQQaqNIgGJgGOvX8CdPXVYEXKtFOcm2+k5zHI2hmx7yTXMTNHO59ziAEne9uAJCeChqaCM5eOsY8cA7PSqQw6vPWSt13rvjV1PnbXPmlfHQ7QuChBEMIQUjAnj7uCMFeI09GxW7N1+54+uuxkmRf4z77p1yuxhigZS5xYDCAKOUUTfdQrELFGOoVZqvRQLiFRQamq3CECQcPhObY5OSs4iATNFsYGRamMNxXSsdpfOUw8IGg4nSMgdE5JFhCEhIJfCPP7fVQOCmKE5Ik3wRrnUABxtkLpTJ9vnOXERH2blnqkWECE4ot42gsoiodnLN6wAmwm91kJ87anpOJWAABa/Tvso8m6ZfJf+xyLo9G/ytPduCqr/+O7x8VNNgY3qizpAROEwJnh4NQodskh20TnAgITUaEB7Lva9sANUAZI6XXlB++Q7N3KohdqKgrApZNKisPhONlcNIMJwBM1cnVMVEZDIWgShGwrW5GhU2IAKQBBOPqct+g4JqUcAwxpI/ZHpAS+Fse9l0qSARG869Ora/iA0HK7NmJ2tP5kMAASUzaLrsgA3FHvopICUljkOvZwKCQJcRCYL2ZtWbJQnGD4ZICXDMeo93MHdO3yD36Hlux/slG8hs1ec4r2IziSAgIYGJzuHuDtfVG44IGr6FzG8An1gNKdWvppqOi47ILA73wkVp3B4ICTJY37gDSbZFk3BLGFLVkBQsy6nhJgCjtEWn5oEMd6HagjIZBJBqanNbIBAHXtEwSnhODRn2EP2MPy/sTaBPWWHrN20aKYJiLe2ZANEcguJVkenvp/rrbOQcEz13XHNMByzLQsgktlDKxzoQADWHXvTOLzyclEWQMB3vteOtQKHxNZ/bi/x4kP+AzpS2YNw+Dn46FHMHt7iiWcQiexBOLz9e+xATu0GyCcKiMSaB+EI8O6xQ5k9ggQUBQSxV+iwN4QjyLfMHslyCX7EE157NHLnkyjIxziRemkEIA7VNiGWQcDTkk28VEAUjgI/XqOBGjFAgMV5E0WlJBxcFIxHTQQQ5PCqhbpDGo7ZdntX2ztz40M+7EwRQICzV9VnD2E4RJ6oDAuxso8WAQRVf9S+2isNB4vydDhlAFku+3TT4t9hBbi2eBPScBhjmpjYkHaUXkAqntaVhgPx3Il04JXSPhwQVIFe6/CKcJSCxt5OrYBUWZwTjrLgEAEEMYNV4xCBcJQHhwggoECoqsAEaXIywmq8oWjBCT7EgkzxVlSgEw4toR5nBwGJ083rLMLhJZPqg/CALJdfjDHubYPxvwoyCOGId7+mM+GAgAKj6BoEpAFrDgWkqASk5KKTcCiIaqAJcEBanuYlHMDIVNIUHJBWV9IJh5KIBpsBB8TZB/gssSlpJyrhAEelouakAPkr5psZb3QpolAnHIqiWcAUEUBQj9tq37BIOAQiUlmTMoAsFh+stW49JO2neD2EcKS5tpSzRQBBzGSNAmrMIoSjlPBOt1MEkKFQR9Qh6t5CTjjSg66kFiQBSd9yMiqpZKhFOEoKbYytYoAgh1muq1MPtQgHJuBKa0UMEOgwa6/qZqr3OxGO0sIaZ68sIIvFg7H2I87c/JBAnm85I0DJ+86AflXblCggAlkkayZBreec8j7hUMvFq2HygOCzyM54ya0obj/Zdj7/Yo25lXIh4ZBSFtuuOCBCWWQPiTHr+XZ7j3zvrHS9Mdp9vVrdYV3J1iQUyAOIUBY5EORptt1+SgFlAMN933z8trmE3juoCYeItCKNZgFEMoscquKCz/b9etZ1zz6wDFDcmP1QShQMZg6R+BVvNBsgw7qIWzwUD8RBtU1vzMb93Q5/DkH63u5tyGXH63CQmUM8nuEXyAbILovID7XgAiEa5LAKoeI0bWQFpEVICMc0gY26anZActUjKIFS2iEcKerpOHcSQIbn1r/mrgNySk44cqotd61JAHHdqRkSwiEXsLlbngwQ19EJZrbE9SUc4hJnvcCkgFQHiZLnVrJGUOUXmxyQUV/pjYHSfmzhc9XSGmpsXw0gBU8Bbzpr73/5/Hmt0cG0KU0BVYAcQOLeDp91pTtGRtYbMaqVdY46QMa6xPb9g+R282Q3sd5IlrCEBlQCMgqndJariDc+lhB8JdioGpDXAn7/IjrxregXHJa8pb6EgKCNPypQBCATg0IwGqamKEB+GHp13U1v7a3Q1vWnvu+/XT8+PjUcG+z6/lGJ8n+uVhmK+nHmK2QGzD0zsnZAzLtu7fOgVfmKsQe+ClQByLHOur1eL1dXO1Bs170C089mm6uXl92DVITBN0zaPa5aQNp1KXuOVICAINVkW9UpQECqcyk7hFSAgCDVZFvVKUBAqnMpO4RUgIAg1WRb1SlAQKpzKTuEVICAINVkW9UpQECqcyk7hFSAgCDVZFvVKUBAqnMpO4RUgIAg1WRb1SlAQKpzKTuEVICAINVkW9UpQECqcyk7hFSAgCDVZFvVKUBAqnMpO4RUgIAg1WRb1SlAQKpzKTuEVICAINVkW9UpQECqcyk7hFTg//8JNVC78ovQAAAAAElFTkSuQmCC");background-size:100%}.markdown-body a:active,.markdown-body a:hover{opacity:.66}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #ed7373;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#ed7373}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#fdf2f2}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #ed7373;background-color:#fdf2f2}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#ed7373}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]{appearance:none;-webkit-appearance:none;-moz-appearance:none;outline:none;width:16px;height:16px;border-radius:2px;background-color:transparent;box-shadow:inset 0 0 0 1px rgba(28,31,35,.3490196078);vertical-align:middle;margin:0;transform:translateY(-2px)}.markdown-body input[type=checkbox]:checked{background-color:#ed7373;background-image:url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjFlbSIgaGVpZ2h0PSIxZW0iIGFyaWEtaGlkZGVuPSJ0cnVlIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE3LjQxMSA3LjMwOGExLjUgMS41IDAgMDEuMjggMi4xMDNsLTYuNSA4LjVhMS41IDEuNSAwIDAxLTIuMzc1LjAxbC0zLjUtNC41YTEuNSAxLjUgMCAxMTIuMzY4LTEuODQybDIuMzA2IDIuOTY1IDUuMzE4LTYuOTU1YTEuNSAxLjUgMCAwMTIuMTAzLS4yOHoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=");box-shadow:inset 0 0 0 1px #ed7373}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">1ã€å‰è¨€</h2>
<p><code>useEffect</code> å’Œ <code>useLayoutEffect</code> åœ¨æ—¥å¸¸å¼€å‘ä¸­ç»å¸¸ä¼šç”¨åˆ°ï¼Œä½†æ˜¯ä½ ç¡®å®šèƒ½å¤Ÿåˆ†å¾—æ¸…æ¥šè¿™ä¸¤ä¸ª <code>hook</code> çš„å·®åˆ«å—ï¼Ÿè¿™ç¯‡æ–‡ç« ä¼šä»æºç å±‚é¢ï¼Œå¸¦ä½ å½»åº•ææ¸…æ¥š <code>useEffect</code> å’Œ <code>useLayoutEffect</code> çš„å·®åˆ«ã€‚</p>
<h2 data-id="heading-1">2ã€æºç é˜…è¯»</h2>
<p>é¦–å…ˆè®©æˆ‘ä»¬æ¥çœ‹ä¸€æ®µç»å…¸çš„ <code>React</code> ä»£ç ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { createRoot } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom/client'</span>;  

<span class="hljs-keyword">const</span> domNode = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'root'</span>);  
<span class="hljs-keyword">const</span> root = <span class="hljs-title function_">createRoot</span>(domNode);
root.<span class="hljs-title function_">render</span>(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>);
</code></pre>
<p>æ˜¾ç„¶ï¼Œ<code>React</code> åœ¨é¦–æ¬¡æ¸²æŸ“çš„æ—¶å€™ä¸»è¦ä¾èµ–è¿™ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li><code>createRoot</code></li>
<li><code>render</code></li>
</ul>
<h3 data-id="heading-2">2.1ã€createRoot</h3>
<p>ä»¥ä¸‹æ˜¯æ¢³ç†åçš„å‡½æ•°è°ƒç”¨å…³ç³»ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd7f7c60d5ec4268ae8e32a600de73d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=3nDBA0d8oMKlnOsL%2FxudaJ%2B3E74%3D" alt="image.png" loading="lazy"/></p>
<p>æœ€ç»ˆæ‹¿åˆ°çš„ <code>root</code> å¯¹è±¡æ˜¯è¿™æ ·çš„ç»“æ„ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9330e69241d2468fad6f4bfe44280e4f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=MtOyCRbJv7vVv2KIngb191Rnxq4%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">2.2ã€render</h3>
<p>ä»¥ä¸‹æ˜¯æ¢³ç†å‡ºæ¥çš„ render çš„å‡½æ•°è°ƒç”¨å…³ç³»ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4da0073b2ad64e2192083624860ae9a1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=gKmGcSCig43%2BmQHB93IbbZXmZXo%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-4">2.2.1ã€renderWithHooks</h4>
<p><code>renderWithHooks</code> æ˜¯åœ¨ <code>beginWork</code> é˜¶æ®µæ‰§è¡Œçš„ï¼Œä»¥ä¸‹æ˜¯æ¢³ç†å‡ºæ¥çš„ <code>renderWithHooks</code> çš„å‡½æ•°è°ƒç”¨é€»è¾‘ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3287f1947334440ae5dec322450812f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=PpU3s7UcVW0r90%2F1SA0K%2Brx0bEo%3D" alt="image.png" loading="lazy"/></p>
<p>æ³¨æ„è¿™é‡Œçš„ <code>ReactSharedInternals.H</code> å®é™…ä¸Šå°±æ˜¯ä¸åŒæ¨¡å¼ï¼ˆmount / updateï¼‰ä¸‹çš„ <code>hooks</code> å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">HooksDispatcherOnMount</span>: <span class="hljs-title class_">Dispatcher</span> = {
  readContext,

  use,
  <span class="hljs-attr">useCallback</span>: mountCallback,
  <span class="hljs-attr">useContext</span>: readContext,
  <span class="hljs-attr">useEffect</span>: mountEffect,
  <span class="hljs-attr">useImperativeHandle</span>: mountImperativeHandle,
  <span class="hljs-attr">useLayoutEffect</span>: mountLayoutEffect,
  <span class="hljs-attr">useInsertionEffect</span>: mountInsertionEffect,
  <span class="hljs-attr">useMemo</span>: mountMemo,
  <span class="hljs-attr">useReducer</span>: mountReducer,
  <span class="hljs-attr">useRef</span>: mountRef,
  <span class="hljs-attr">useState</span>: mountState,
  <span class="hljs-attr">useDebugValue</span>: mountDebugValue,
  <span class="hljs-attr">useDeferredValue</span>: mountDeferredValue,
  <span class="hljs-attr">useTransition</span>: mountTransition,
  <span class="hljs-attr">useSyncExternalStore</span>: mountSyncExternalStore,
  <span class="hljs-attr">useId</span>: mountId,
  <span class="hljs-attr">useHostTransitionStatus</span>: useHostTransitionStatus,
  <span class="hljs-attr">useFormState</span>: mountActionState,
  <span class="hljs-attr">useActionState</span>: mountActionState,
  <span class="hljs-attr">useOptimistic</span>: mountOptimistic,
  useMemoCache,
  <span class="hljs-attr">useCacheRefresh</span>: mountRefresh,
};

<span class="hljs-keyword">const</span> <span class="hljs-title class_">HooksDispatcherOnUpdate</span>: <span class="hljs-title class_">Dispatcher</span> = {
  readContext,

  use,
  <span class="hljs-attr">useCallback</span>: updateCallback,
  <span class="hljs-attr">useContext</span>: readContext,
  <span class="hljs-attr">useEffect</span>: updateEffect,
  <span class="hljs-attr">useImperativeHandle</span>: updateImperativeHandle,
  <span class="hljs-attr">useInsertionEffect</span>: updateInsertionEffect,
  <span class="hljs-attr">useLayoutEffect</span>: updateLayoutEffect,
  <span class="hljs-attr">useMemo</span>: updateMemo,
  <span class="hljs-attr">useReducer</span>: updateReducer,
  <span class="hljs-attr">useRef</span>: updateRef,
  <span class="hljs-attr">useState</span>: updateState,
  <span class="hljs-attr">useDebugValue</span>: updateDebugValue,
  <span class="hljs-attr">useDeferredValue</span>: updateDeferredValue,
  <span class="hljs-attr">useTransition</span>: updateTransition,
  <span class="hljs-attr">useSyncExternalStore</span>: updateSyncExternalStore,
  <span class="hljs-attr">useId</span>: updateId,
  <span class="hljs-attr">useHostTransitionStatus</span>: useHostTransitionStatus,
  <span class="hljs-attr">useFormState</span>: updateActionState,
  <span class="hljs-attr">useActionState</span>: updateActionState,
  <span class="hljs-attr">useOptimistic</span>: updateOptimistic,
  useMemoCache,
  <span class="hljs-attr">useCacheRefresh</span>: updateRefresh,
};
</code></pre>
<p>å¾ˆå®¹æ˜“ç†è§£çš„æ˜¯ï¼Œåœ¨ <code>mount</code> å’Œ <code>update</code> é˜¶æ®µï¼ŒReact å†…éƒ¨è°ƒç”¨çš„æ˜¯ä¸åŒæ¨¡å¼çš„ <code>hook</code>ã€‚<br/>
å…¶ä¸­ï¼Œ<code>useEffect</code> å’Œ <code>useLayoutEffect</code> çš„å‡½æ•°è°ƒç”¨å…³ç³»åˆ†åˆ«ä¸ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa70ec6d6c3c4fcbbeb884a54c5805ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=fOZV3bTBstlaUCFiwxtFXYZJIQ0%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a56995c7c6084fbebf8c3470fd719d4b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=3rsXnFMy83KuqT57AgbLoa9XTaQ%3D" alt="image.png" loading="lazy"/></p>
<p>åªçœ‹å›¾çš„è¯ä¼šå‘ç°ï¼Œ<code>useEffect</code> å’Œ <code>useLayoutEffect</code> åœ¨åº•å±‚å®ç°è¿™å—ï¼Œé™¤äº†å‰é¢å¦‚ <code>mountEffect</code> å’Œ <code>mountLayoutEffect</code> çš„å·®åˆ«å¤–ï¼Œå…¶ä»–ä¾èµ–çš„å‡½æ•°å…¶å®æ˜¯ä¸€æ ·çš„ã€‚<br/>
å…¶å®ï¼Œè¿™ä¸¤ä¸ª <code>hook</code> åœ¨ <code>renderWithHooks</code> é˜¶æ®µéƒ½æ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œé‚£ React å†…éƒ¨æ˜¯æ€ä¹ˆåŒºåˆ†å’Œå­˜å‚¨çš„å‘¢ï¼Ÿ</p>
<h4 data-id="heading-5">2.2.2ã€React å¦‚ä½•å­˜å‚¨ä»¥åŠåŒºåˆ†ä¸åŒçš„ hook</h4>
<p>é¦–å…ˆï¼Œå¯¹äºè¿™ä¸¤ä¸ª <code>hook</code> æ¥è¯´ï¼Œå®ƒä»¬åˆ†æˆäº† <code>mount</code> å’Œ <code>update</code> æ¨¡å¼ï¼Œä¸åŒæ¨¡å¼ä¸‹æ‰§è¡Œçš„é€»è¾‘ä¸åŒï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4403fa9fdd64d55ae13b2f166fc8d26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=pVj6cLDVSbD724TXlRRuS9QUr8M%3D" alt="image.png" loading="lazy"/></p>
<p>ä»ä¸Šé¢æ¢³ç†çš„è¡Œä¸ºæ¥çœ‹ï¼Œæ— è®ºæ˜¯ <code>mount</code> è¿˜æ˜¯ <code>update</code> æ¨¡å¼ï¼Œæˆ‘ä»¬å®šä¹‰çš„ <code>useEffect</code> å’Œ <code>useLayoutEffect</code> åœ¨å½“å‰çš„ <code>renderWithHooks</code> é˜¶æ®µéƒ½æ˜¯ä¸ä¼šæ‰§è¡Œçš„ã€‚</p>
<p>åœ¨è¿™é‡Œæˆ‘ä»¬ä¹Ÿèƒ½å¾—å‡ºä¸€äº›ç»“è®ºï¼š</p>
<p><code>React</code> å¦‚ä½•å­˜å‚¨ <code>hook</code>ï¼š</p>
<ul>
<li>å¯¹äº <code>mount</code> é˜¶æ®µçš„ <code>hook</code>ï¼Œå­˜åœ¨ <code>workInProgressHook</code> ä¸Š</li>
<li>å¯¹äº <code>update</code> é˜¶æ®µçš„ <code>hook</code>ï¼Œæ¯æ¬¡ <code>upadte</code> æ—¶ä¼šä» <code>workInProgressHook</code> ä¸ŠæŒ‰é¡ºåºå–å‡º <code>hook</code>ï¼Œå¯¹äºå‡ºç° <code>deps</code> å˜åŒ–æ—¶ï¼Œå°†ä¼šç»´æŠ¤ä¸€ä¸ª <code>effect</code> é“¾è¡¨ï¼ŒæŒ‡å‘ <code>fiber</code> ä¸Šçš„ <code>updateQueue</code> å¯¹è±¡ä¸Šã€‚</li>
</ul>
<p>æˆ‘ä»¬å°è¯•ç”¨å›¾æ¥è¡¨ç¤ºè¿™é‡Œä¸åŒèŠ‚ç‚¹ä¹‹é—´çš„æŒ‡å‘å…³ç³»ï¼Œåº”è¯¥ä¼šæ›´åŠ æ˜äº†ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2aa9662898064f66bb59c13dec9e0e8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=hNDWvm6eBK4cegoCwN29otiRS7g%3D" alt="image.png" loading="lazy"/></p>
<p>React å¦‚ä½•åŒºåˆ†ä¸åŒçš„ <code>hook</code> å‘¢ï¼Ÿ
ç­”æ¡ˆå°±æ˜¯ï¼ŒReact å†…éƒ¨å¯¹äºä¸åŒçš„ <code>hook</code> ä¼šä½¿ç”¨ä¸åŒçš„ <code>flag</code> æ¥è¿›è¡ŒåŒºåˆ†ã€‚æ¯”å¦‚ï¼Œ<code>useEffect</code> ä½¿ç”¨ <code>HookPassive</code> æ¥æ ‡è®°ï¼Œ<code>useLayoutEffect</code> åˆ™ä½¿ç”¨ <code>HookLayout</code> æ¥è¿›è¡Œæ ‡è®°</p>
<h4 data-id="heading-6">2.2.2ã€commitRoot</h4>
<p>ä»¥ä¸‹æ˜¯æ¢³ç†å‡ºæ¥çš„è°ƒç”¨å…³ç³»ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/499d9026a99d40c0a370cd5a3b6eeb94~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=sfsKtIrxWn4WjGvue%2FjzbAqhe7M%3D" alt="image.png" loading="lazy"/></p>
<h5 data-id="heading-7">2.2.2.1ã€flushPassiveEffects</h5>
<p>å‡½æ•°è°ƒç”¨å…³ç³»å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c5996df065af4aed96762b4bb9c86a52~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=rb2p3kWXD1a8xDiWnDHPBRubnk4%3D" alt="flushPassiveEffects.png" loading="lazy"/></p>
<p>æˆ‘ä»¬éœ€è¦å…³æ³¨çš„æ˜¯ <code>commitHookEffectListUnmount</code> å’Œ <code>commitHookEffectListMount</code> è¿™ä¸¤ä¸ªå‡½æ•°ã€‚</p>
<p>åœ¨ <code>commitHookEffectListUnmount</code> ä¸­ï¼Œæ‰§è¡Œçš„æ˜¯ <code>hook</code> ä¸­çš„ <code>destroy</code> å‡½æ•°ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39dbdbef1fd147bd8ffcf3a177ac7afa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=rSND%2BWWtRq3%2FdKuWbXNA2Xs0%2BEQ%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨ <code>commitHookEffectListMount</code> ä¸­ï¼Œä¸»è¦æ˜¯æ‰§è¡Œç”¨æˆ·ä¼ å…¥ <code>hook</code> çš„ <code>create</code> å‡½æ•°ï¼Œä»¥åŠæ‹¿åˆ° <code>create</code> å‡½æ•°çš„è¿”å›å€¼å¹¶èµ‹å€¼ç»™ <code>destroy</code> å˜é‡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f8c85d2998248ccb56eb77a469bc8d4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=vxQvbayLibRnphyjKI9Kwca%2B8Ek%3D" alt="image.png" loading="lazy"/></p>
<h5 data-id="heading-8">2.2.2.2ã€flushMutationEffects</h5>
<p>è¿™ä¸ªå‡½æ•°çš„è°ƒç”¨å…³ç³»ç›¸å¯¹æ¥è¯´è¦ç®€å•ä¸€äº›ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60273f227e1942df9bf290af7d23081f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=sNR4DnU9m3tTMVtLbVcgw8JHo14%3D" alt="image.png" loading="lazy"/></p>
<p>å…¶å®å’Œ <code>useLayoutEffect</code> ç›¸å…³çš„å¾ˆæ˜æ˜¾å°±æ˜¯ <code>commitHookEffectListUnmount</code> è¿™ä¸ªå‡½æ•°äº†ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/16d94c72c00c490b83072ce520351e0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=YyudZBjUTzcBekQ7PZKcj9bb%2F3Y%3D" alt="image.png" loading="lazy"/></p>
<p>æ˜¾è€Œæ˜“è§ï¼Œè¿™é‡Œæ˜¯åœ¨æ‰§è¡Œ <code>useLayoutEffect</code> çš„ <code>destroy</code> å‡½æ•°ã€‚</p>
<h5 data-id="heading-9">2.2.2.3ã€flushLayoutEffects</h5>
<p>è°ƒç”¨å…³ç³»å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/287ca8c6e7934aef8b91383c4dc126d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=%2BDJWZ9CaWGMZeuwA2J1nA1c25mg%3D" alt="flushLayoutEffects.png" loading="lazy"/></p>
<p>æˆ‘ä»¬é‡ç‚¹å…³æ³¨æœ€åä¸€ä¸ªå‡½æ•°ï¼š<code>commitHookEffectListMount</code>ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6ed0a8bd6b048568356b90218bcacd5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVG9ueWNoZW4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767189809&amp;x-signature=FzzCtHdP5izfuq6nKMCFSeyq%2FEU%3D" alt="image.png" loading="lazy"/></p>
<p>åŒæ ·çš„ï¼Œåœ¨è¿™é‡Œä¹Ÿä¼šæ‰§è¡Œ <code>create</code> å‡½æ•°ï¼Œå¹¶æŠŠå®ƒçš„è¿”å›å€¼èµ‹å€¼ç»™ <code>destroy</code> å‡½æ•°</p>
<h2 data-id="heading-10">3ã€æ€»ç»“</h2>
<h3 data-id="heading-11">3.1ã€ç›¸åŒç‚¹</h3>
<ol>
<li><code>useEffect</code> å’Œ <code>useLayoutEffect</code> çš„ç”¨æ³•ç›¸ä¼¼ï¼Œ<code>deps</code> å˜åŒ–åä¼šé‡æ–°æ‰§è¡Œï¼Œåœ¨ä¼ å…¥çš„ create å‡½æ•°å†…æ”¯æŒä½¿ç”¨è¿”å›å€¼ä½œä¸º <code>destroy</code> å‡½æ•°ã€‚</li>
<li><code>useEffect</code> å’Œ <code>useLayoutEffect</code> ä¸€æ ·éƒ½æ˜¯å­˜å‚¨åœ¨ <code>fiber</code> æŒ‡å‘çš„ <code>workInProgressHook</code>ï¼Œå‡ºç° deps å˜æ›´åï¼Œ<code>effect</code> å­˜å‚¨åœ¨ <code>fiber</code> æŒ‡å‘çš„ <code>updateQueue</code>ã€‚</li>
<li><code>useEffect</code> å’Œ <code>useLayoutEffect</code> éƒ½åœ¨ <code>commit</code> é˜¶æ®µæ‰§è¡Œ</li>
</ol>
<h3 data-id="heading-12">3.2ã€å·®å¼‚ç‚¹</h3>
<ol>
<li><code>useEffect</code> é€šè¿‡ <code>Scheduler</code> æ¥è¿›è¡Œè°ƒåº¦ï¼Œè€Œ <code>useLayoutEffect</code> åœ¨ <code>commit</code> é˜¶æ®µä¼šç›´æ¥æ‰§è¡Œã€‚æ¢å¥è¯è¯´ï¼Œ<code>useEffect</code> æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œè€Œ <code>useLayoutEffect</code> æ˜¯åŒæ­¥æ‰§è¡Œçš„ã€‚ä¹Ÿå¯ä»¥è¯´ï¼š<code>useLayoutEffect</code> æ˜¯åœ¨æ¸²æŸ“ä¹‹å‰æ‰§è¡Œçš„ï¼Œè€Œ <code>useEffect</code> æ˜¯åœ¨æ¸²æŸ“ä¹‹åæ‰§è¡Œçš„ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¸¿è’™åº”ç”¨å¼€å‘ä¹‹é€šè¿‡ListItemGroupã€nestedScrollå®ç°å•†åŸæ´»åŠ¨å¯æŠ˜å åˆ†ç»„æ»šåŠ¨æ•ˆæœ]]></title>    <link>https://juejin.cn/post/7587299443643449407</link>    <guid>https://juejin.cn/post/7587299443643449407</guid>    <pubDate>2025-12-24T14:29:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7587299443643449407" data-draft-id="7587312329173106742" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¸¿è’™åº”ç”¨å¼€å‘ä¹‹é€šè¿‡ListItemGroupã€nestedScrollå®ç°å•†åŸæ´»åŠ¨å¯æŠ˜å åˆ†ç»„æ»šåŠ¨æ•ˆæœ"/> <meta itemprop="keywords" content="HarmonyOS"/> <meta itemprop="datePublished" content="2025-12-24T14:29:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ITå……ç”µç«™"/> <meta itemprop="url" content="https://juejin.cn/user/125809758576431"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¸¿è’™åº”ç”¨å¼€å‘ä¹‹é€šè¿‡ListItemGroupã€nestedScrollå®ç°å•†åŸæ´»åŠ¨å¯æŠ˜å åˆ†ç»„æ»šåŠ¨æ•ˆæœ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/125809758576431/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ITå……ç”µç«™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-24T14:29:07.000Z" title="Wed Dec 24 2025 14:29:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<h2 data-id="heading-0">é€šè¿‡ListItemGroupã€nestedScrollå®ç°å•†åŸæ´»åŠ¨å¯æŠ˜å åˆ†ç»„æ»šåŠ¨æ•ˆæœ</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf96cb6dded8424092700520c65a17b5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSVTlhYXnlLXnq5k=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767191347&amp;x-signature=yCu1DZJJbC54DS%2Fb6P2cLhQ%2Bje0%3D" alt="" loading="lazy"/></p>
<p>é€šè¿‡ListItemGroupã€nestedScrollå®ç°å•†åŸæ´»åŠ¨å¯æŠ˜å åˆ†ç»„æ»šåŠ¨æ•ˆæœ</p>
<p>é»˜è®¤å®£ä¼ å°é¢</p>
<p>å½“ä¸Šæ‹‰æ—¶å€™å¤§å¯¼èˆªå¸é¡¶</p>
<p>ç»§ç»­ä¸Šæ‹‰å°å¯¼èˆªå¸ç¯å¹¶ä¸”ä¼šéšç€æ‹‰ä¸Šåˆ‡æ¢å°å¯¼èˆª</p>
<h2 data-id="heading-1">æ•ˆæœé¢„è§ˆï¼š</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84cb9b13a8d742298778d7d0921bff2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSVTlhYXnlLXnq5k=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1767191347&amp;x-signature=QBH3hAp5l7NXCqKcK%2FcWcMhPJ7Q%3D" alt="" loading="lazy"/>â€‹</p>
<p>â€‹</p>
<h2 data-id="heading-2">å®ç°æ€è·¯ï¼š</h2>
<p>1ã€æ ¹æ®æ•ˆæœå›¾é¢œè‰²Â  å…ˆå®ç°çº¢ã€è“ã€åˆ—è¡¨å¸ƒå±€</p>
<p>2ã€ç»™æœ€å¤–å±‚åŠ ä¸ŠScrollå®ç°åµŒå¥—æ»šåŠ¨ï¼Œæœ€åˆä¸Šæ‹‰çº¢è‰²æ…¢æ…¢éšè—ã€ç»¿è‰²å¸ç¯</p>
<p>3ã€ç»™Listå¢åŠ ListItemGroupåˆ†ç»„å®ç°å°å¯¼èˆªå¸é¡¶æ•ˆæœ</p>
<h2 data-id="heading-3">å®Œæ•´ä»£ç ï¼š</h2>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@Entry</span>
<span class="hljs-keyword">@Component</span>
struct Index {

  <span class="hljs-keyword">@Builder</span> GroupTitleBuilder(<span class="hljs-attribute">text</span>: string) {
    <span class="hljs-comment">// åˆ—è¡¨åˆ†ç»„çš„å¤´éƒ¨ç»„ä»¶ï¼Œå¯¹åº”è”ç³»äººåˆ†ç»„Aã€Bç­‰ä½ç½®çš„ç»„ä»¶</span>
    Text(text)
      <span class="hljs-selector-class">.fontSize</span>(<span class="hljs-number">20</span>)
      <span class="hljs-selector-class">.backgroundColor</span>('#fff1f3f5')
      <span class="hljs-selector-class">.width</span>('<span class="hljs-number">100%</span>')
      <span class="hljs-selector-class">.padding</span>(<span class="hljs-number">5</span>)
  }

  <span class="hljs-built_in">build</span>() {
    <span class="hljs-comment">// æ ¸å¿ƒ1â­ï¸ï¼šå¤šå±‚åµŒå¥—æ»šåŠ¨</span>
    Scroll() {
      <span class="hljs-built_in">Column</span>() {
        <span class="hljs-comment">// çº¢è‰²</span>
        Text()<span class="hljs-selector-class">.width</span>('<span class="hljs-number">100%</span>')<span class="hljs-selector-class">.height</span>(<span class="hljs-number">100</span>)<span class="hljs-selector-class">.backgroundColor</span>(Color.Red)
        <span class="hljs-comment">// è“è‰²</span>
        Text()<span class="hljs-selector-class">.width</span>('<span class="hljs-number">100%</span>')<span class="hljs-selector-class">.height</span>(<span class="hljs-number">50</span>)<span class="hljs-selector-class">.backgroundColor</span>(Color.Blue)
        <span class="hljs-comment">// åˆ—è¡¨</span>
        <span class="hljs-built_in">List</span>() {
          <span class="hljs-comment">// åˆ†ç»„</span>
          <span class="hljs-built_in">ForEach</span>('ABCDEF'.split(''), (title:string) =&gt; {
            <span class="hljs-built_in">ListItemGroup</span>({ header: this.GroupTitleBuilder(title) }) {
              <span class="hljs-comment">// æ¯ä¸ªåˆ†ç»„ä¸‹é¢çš„å†…å®¹ï¼ˆå’±ä»¬è¿™é‡Œæ¯ä¸ªåˆ†ç»„å†…å®¹ä¸€æ ·ï¼‰</span>
              <span class="hljs-built_in">ForEach</span>('<span class="hljs-number">123456</span>'.split(''), (item:string) =&gt; {
                <span class="hljs-built_in">ListItem</span>() {
                  Text(item)<span class="hljs-selector-class">.height</span>(<span class="hljs-number">50</span>)<span class="hljs-selector-class">.fontSize</span>(<span class="hljs-number">30</span>)
                }
              })
              <span class="hljs-comment">// æ¯ä¸ªåˆ†ç»„ä¸‹é¢çš„å†…å®¹ï¼ˆå’±ä»¬è¿™é‡Œæ¯ä¸ªåˆ†ç»„å†…å®¹ä¸€æ ·ï¼‰</span>
            }<span class="hljs-selector-class">.divider</span>({strokeWidth:<span class="hljs-number">2</span>,color:Color.Red})
          })
          <span class="hljs-comment">// åˆ†ç»„</span>

        }<span class="hljs-selector-class">.sticky</span>(StickyStyle.Header)
        <span class="hljs-comment">// æ ¸å¿ƒ2â­ï¼šä¸Šæ‹‰é»„è‰²æ…¢æ…¢æ¶ˆå¤±ã€è“è‰²ä¸€ç›´åœ¨  ä¹Ÿå°±æ˜¯å‡å»è“è‰²é«˜åº¦</span>
        <span class="hljs-selector-class">.height</span>('calc(<span class="hljs-number">100%</span> - <span class="hljs-number">50</span>vp)')
        <span class="hljs-comment">// æ ¸å¿ƒ3â­ï¸ï¼šå‘å‰å‘åæ»šåŠ¨æ¨¡å¼ -&gt; å®ç°ä¸çˆ¶ç»„ä»¶çš„æ»šåŠ¨è”åŠ¨</span>
        <span class="hljs-selector-class">.nestedScroll</span>({
          scrollForward: NestedScrollMode.PARENT_FIRST, // ä¸Šæ‹‰
          scrollBackward: NestedScrollMode.SELF_FIRST   // ä¸‹æ‹‰
          // ä¸ç®¡çˆ¶-SELF_ONLYã€SELF_FIRST-åˆ°è¾¹ç¼˜ç®¡çˆ¶ã€PARENT_FIRST-åˆ°è¾¹ç¼˜ç®¡å­ã€PARALLEL-çˆ¶å­åŒæ—¶
          // è¯¦ç»† https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V13/ts-appendix-enums-V13#nestedscrollmode10
        })
      }
    }
  }
}
</code></pre>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Ftraining%2FclassDetail%2F0a0a956faec348ddaa9b2676a3f19545%3Ftype%3D1%3Fha_source%3Dhmosclass%26ha_sourceId%3D89000248" title="https://developer.huawei.com/consumer/cn/training/classDetail/0a0a956faec348ddaa9b2676a3f19545?type=1?ha_source=hmosclass&amp;ha_sourceId=89000248" target="_blank" ref="nofollow noopener noreferrer">é¸¿è’™å¼€å‘è€…ç­çº§</a></p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>